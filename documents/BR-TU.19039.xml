<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19039</field>
		<field name="filename">2613_313170.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA
PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA MECÂNICA

Giovani Cerbato

ESQUEMAS NUMÉRICOS PARA A RECONSTRUÇÃO DO GRADIENTE EM
MALHAS POLIGONAIS

Florianopólis

2012





Giovani Cerbato

ESQUEMAS NUMÉRICOS PARA A RECONSTRUÇÃO DO GRADIENTE EM
MALHAS POLIGONAIS

Dissertação submetida ao Programa de
Pós-Graduação em Engenharia Mecânica
para a obtenção do grau de Mestre em
Engenharia Mecânica.

Orientador: António Fábio Carvalho da
Silva
Coorientador: Fernando Sandro Velasco
Hurtado

Florianopólis

2012



Ficha de identificação da obra elaborada pelo autor, através do

Programa de Geração Automática da Biblioteca Universitária da UFSC.
Ficha de identificação da obra elaborada pelo autor,

 através do Programa de Geração Automática da Biblioteca Universitária da UFSC.

Cerbato, Giovani
   Esquemas numéricos para a reconstrução do gradiente em
malhas poligonais [dissertação] / Giovani Cerbato ;
orientador, António Fábio Carvalho da Silva ; co-
orientador, Fernando Sandro Velasco Hurtado. -
Florianópolis, SC, 2012.
   152 p. ; 21cm

   Dissertação (mestrado) - Universidade Federal de Santa
Catarina, Centro Tecnológico. Programa de Pós-Graduação em
Engenharia Mecânica.

   Inclui referências 

   1. Engenharia Mecânica. 2. Reservatórios de Petróleo. 3.
Esquemas Numéricos. 4. Malhas Poligonais. I. Silva, António
Fábio Carvalho da. II. Hurtado, Fernando Sandro Velasco.
III. Universidade Federal de Santa Catarina. Programa de
Pós-Graduação em Engenharia Mecânica. IV. Título.



Giovani Cerbato

ESQUEMAS NUMÉRICOS PARA A RECONSTRUÇÃO DO GRADIENTE EM
MALHAS POLIGONAIS

Esta dissertação foi julgada adequada para a obtenção do título de
“Mestre em Engenharia Mecânica”, e aprovada em sua forma final pelo
Programa de Pós-Graduação em Engenharia Mecânica.

Florianopólis, 13 de Setembro 2012.

Júlio César Passos, Dr., Coordenador do Curso

António Fábio Carvalho da Silva, Dr. Eng., Orientador

Fernando Sandro Velasco Hurtado, Dr. Eng., Coorientador

BANCA EXAMINADORA

António Fábio Carvalho da Silva, Dr.Eng., Presidente

Clovis Raimundo Maliska, Ph.D.

Emilio Ernesto Paladino, Dr.Eng.





Mário César Zambaldi, Ph.D.





AG R A D E C I M E N TO S

Ao professor Clovis R. Maliska pelo total incentivo a iniciar o mestrado

e por ter aberto as portas do laboratório SINMEC de uma maneira tão

receptiva que nunca imaginava ter encontrado.

Ao professor António Fábio pela disponibilidade, orientação prestada

nas correções e discussões referentes aos tópicos abordados.

Ao Fernando Hurtado pela dedicação, orientação, comprometimento

e pelo constante compartilhamento de seus vastos conhecimentos.

Aos integrantes do SIGER 2, Ederson, Gustavo, Aymar e Fernando

Hurtado. A contribuição deste grupo foi de suma importância, todas as

reuniões e discussões ajudaram muito o desenvolvimento deste trabalho.

Aos integrantes do laboratório SINMEC por toda ajuda recebida por

meio de informações técnicas, apoio, amizade, e por terem tornado o

ambiente de trabalho o melhor possível. Em especial à Tatiane que sempre

esteve disposta a ajudar e pela sua preocupação com o bem estar de todos

e ao Leonardo pela ajuda com o LateX.

À Agência Nacional do Petróleo pelo apoio financeiro concedido

através da bolsa de estudos.

Ao POSMEC (Programa de Pós-Graduação em Engenharia Mecânica)

pela estrutura oferecida e a disponibilização de um curso de mestrado de

tão alto nível. Ao corpo docente do programa pela dedicação e transmissão

de seus conhecimentos nas disciplinas oferecidas.

Ao meu “irmão” Dalpi por toda ajuda, parceria, incentivo, amizade e

diversas discussões sobre os mais variados assuntos. Ao meu outro “irmão”

Chico pelo incentivo, parceria, alegria e preocupação com meu bem estar.

À Dona Rita e seu Francisco por terem me acolhido com carinho.

À toda minha família, pai, mãe, Rica, Eduarda, Milena, Tia Ana, Tia

Dirce, Tia Iva por terem acreditado em mim, por valorizarem as minhas

decisões e pelo incentivo incondicional. À minha namorada, amiga,

parceira Juciane por todo carinho, amor, compreensão e paciência.



À Deus por ter me dado saúde, força de vontade e por ter colocado

pessoas tão especiais na minha vida.

viii



S U M Á R I O

Lista de Figuras v

Lista de Tabelas xiii

Lista de Símbolos xv

Resumo xix

Abstract xxi

1 Introdução 1
1.1 Preliminares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

1.2 Motivação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

1.3 Objetivos e contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.4 Malhas poligonais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6

1.5 Problema físico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

1.6 Organização do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

2 Métodos de reconstrução explícita do gradiente 17
2.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.2 Fórmula de Green-Gauss . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

2.2.1 Abordagem cell-based . . . . . . . . . . . . . . . . . . . . . . . 22

2.2.1.1 Média aritmética . . . . . . . . . . . . . . . . . . . . 23

2.2.1.2 Média ponderada pela distância . . . . . . . . . 23

2.2.1.3 Procedimento com um passo . . . . . . . . . . . 26

2.2.1.4 Procedimento com dois passos . . . . . . . . . . 26

2.2.1.5 Faces de fronteira . . . . . . . . . . . . . . . . . . . . 27

2.2.2 Abordagem vertex-based . . . . . . . . . . . . . . . . . . . . . . 28

2.2.2.1 Ponderação pelo inverso da distância . . . . . 29

2.2.2.2 Procedimento do pseudolaplaciano . . . . . . 30

2.2.2.3 Vértices de fronteira . . . . . . . . . . . . . . . . . . 34

2.2.2.4 Obtenção dos valores de pressão nas faces . . 34

i



2.2.3 Comparação entre as abordagens cell-based e vertex-

based . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

2.3 Mínimos quadrados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

2.3.1 Equações normais . . . . . . . . . . . . . . . . . . . . . . . . . . 40

2.3.2 Fatoração QR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

2.3.3 Comentários . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

3 Análise comparativa dos métodos de reconstrução 45

3.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

3.1.1 Funções analisadas . . . . . . . . . . . . . . . . . . . . . . . . . 46

3.1.2 Malhas consideradas . . . . . . . . . . . . . . . . . . . . . . . . 49

3.1.3 Norma do erro analisada . . . . . . . . . . . . . . . . . . . . . 55

3.2 Convergência dos métodos . . . . . . . . . . . . . . . . . . . . . . . . . 57

3.2.1 Testes com diferentes funções . . . . . . . . . . . . . . . . . . 59

3.2.1.1 Testes com a função linear . . . . . . . . . . . . . 59

3.2.1.2 Testes com a função oscilatória . . . . . . . . . . 72

3.2.1.3 Testes com a função exponencial . . . . . . . . . 75

3.2.1.4 Testes com a função descontínua . . . . . . . . 76

3.2.1.5 Comentários . . . . . . . . . . . . . . . . . . . . . . . 79

3.2.2 Testes com diferentes malhas . . . . . . . . . . . . . . . . . . 79

3.2.2.1 Testes com as malhas não-conformes . . . . . 80

3.2.2.2 Testes com as malhas com razão de aspecto

alta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

3.2.2.3 Testes com as malhas com distorção aleatória 86

3.2.2.4 Testes com as malhas com distorção senoidal 88

3.2.2.5 Comentários . . . . . . . . . . . . . . . . . . . . . . . 92

3.3 Comparação dos tempos de computação . . . . . . . . . . . . . . . 95

4 Aplicação à discretização de um modelo de escoamento monofá-
sico 103

4.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

4.2 Discretização da equação da conservação de massa . . . . . . . 104

4.3 Aproximação dos fluxos . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

4.4 Volumes de controle de fronteira . . . . . . . . . . . . . . . . . . . . . 115

5 Resultados 119

5.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

5.2 Algoritmo de solução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

ii



5.3 Especificação do problema . . . . . . . . . . . . . . . . . . . . . . . . . 120

5.4 Resultados para o caso 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . 122

5.4.1 Análise da influência dos métodos de reconstrução . . 122

5.4.2 Análise da influência da geometria das malhas . . . . . 124

5.4.3 Análise da influência da razão de anisotropia . . . . . . 126

5.4.4 Comentários . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130

5.5 Resultados para o caso 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . 132

5.5.1 Análise da influência dos métodos de reconstrução . . 133

5.5.2 Análise da influência da geometria das malhas . . . . . 133

6 Conclusão 137
6.1 Principais conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

Referências 141

A Deduções relativas ao procedimento do pseudolaplaciano 145
A.1 Condição de pseudolaplaciano nulo . . . . . . . . . . . . . . . . . . 145

A.2 Obtenção dos fatores de ponderação . . . . . . . . . . . . . . . . . . 148

B Caso especial da regra do ponto médio 151

iii





L I S TA D E F I G U R A S

Figura 1.1 Exemplos de malhas corner-point extraídas de [26]. . . . . . . . 3

Figura 1.2 Ilustração em 3D da forma especial de discretização de

um reservatório. Modificada de [27]. . . . . . . . . . . . . . . . . . . . . . . 4

Figura 1.3 Ilustração em 2D da forma especial de discretização. Ma-

lha poligonal está apresentada na cor laranja. . . . . . . . . . . . . . 4

Figura 1.4 Entidades envolvidas nas malhas poligonais: (a) Volume

de controle, (b) Faces e (c) Vértices. . . . . . . . . . . . . . . . . . . . . . . . 8

Figura 1.5 Representação de uma malha poligonal com destaque para

volume de controle p e suas faces. . . . . . . . . . . . . . . . . . . . . . . . . 9

Figura 1.6 Representação de uma malha poligonal com ênfase nos

dois volumes de controle vizinhos que possuem a face f

em comum. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

Figura 1.7 Notação empregada para um vértice em uma malha poli-

gonal e dos volumes de controle que o cercam. . . . . . . . . . . . 10

Figura 1.8 Notação utilizada para os vizinhos de um volume de con-

trole p . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

Figura 2.1 Diagrama ilustrativo dos métodos de reconstrução do gra-

diente empregados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

Figura 2.2 Esquema ilustrativo da aplicação dos métodos de recons-

trução do gradiente. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

Figura 2.3 Representação de um volume no qual é possível utilizar o

teorema da divergência. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

Figura 2.4 Representação de um volume de controle poligonal enfa-

tizando os centroides das faces e os vetores área destas. . . 21

Figura 2.5 Volumes de controle e centroide da face. . . . . . . . . . . . . . . . . . . 22

v



Figura 2.6 Ilustração dos elementos geométricos utilizados na vari-

ante da média ponderada pela distância. . . . . . . . . . . . . . . . . . 24

Figura 2.7 Representação do ângulo ? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

Figura 2.8 Volume de controle e faces de fronteira. . . . . . . . . . . . . . . . . . . . 27

Figura 2.9 Volumes de controle que cooperam para a determinação

do valor da pressão no vértice. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

Figura 2.10 Volumes de controle que contribuem para a determina-

ção do gradiente de pressão associado ao volume de con-

trole p. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

Figura 2.11 Demonstração do vetor r p1 ,v. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

Figura 2.12 Vértice deslocado do triângulo que se forma conectando

os centroides dos volumes p1,p2 e p3. . . . . . . . . . . . . . . . . . . . . . 33

Figura 2.13 Entidades envolvidas na determinação do valor de pres-

são em um vértice de fronteira. . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

Figura 2.14 Volumes de controle envolvidos na aproximação da pres-

são na face f . À esquerda cell-based e à direita vertex-

based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

Figura 2.15 Volume de controle p e seus vizinhos. . . . . . . . . . . . . . . . . . . . . . 37

Figura 2.16 Ilustração de um sistema linear onde b não pertence ao
espaço coluna deA. Reproduzida de [36]. . . . . . . . . . . . . . . . . 40

Figura 3.1 Origem do sistema de coordenadas nas malhas analisadas. 47

Figura 3.2 Campo de pressão segundo a função linear. . . . . . . . . . . . . . . . 48

Figura 3.3 Campo de pressão segundo a função oscilatória. . . . . . . . . . . 49

Figura 3.4 Campo de pressão segundo a função exponencial. . . . . . . . . 49

Figura 3.5 Campo de pressão segundo a função descontínua. . . . . . . . . 50

Figura 3.6 Campo do gradiente de pressão referente à função linear. . 50

Figura 3.7 Campo do gradiente de pressão referente à função oscila-

tória. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

Figura 3.8 Campo do gradiente de pressão da função exponencial. . . 51

Figura 3.9 Campo do gradiente de pressão da função descontínua. . . 52

vi



Figura 3.10 Malhas:(a)regular, (b)não-conforme, (c)com razão de as-

pecto alta, (d)com distorção aleatória, (e)com distorção

senoidal. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

Figura 3.11 Malha regular mostrando os volumes de controle laterais

e centrais. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

Figura 3.12 Convergência do gradiente de pressão nas malhas regula-

res considerando a função linear. Métodos com aborda-

gem cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

Figura 3.13 Convergência do gradiente de pressão nas malhas regu-

lares considerando a função linear. Método com aborda-

gem vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

Figura 3.14 Volumes centrais nas malhas regulares. . . . . . . . . . . . . . . . . . . . 62

Figura 3.15 Volumes laterais nas malhas regulares. . . . . . . . . . . . . . . . . . . . . 63

Figura 3.16 Distribuição do erro na malha regular com 85 volumes de

controle utilizando GGCBA_1S. . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

Figura 3.17 Volume do canto inferior esquerdo da malha regular com

85 volumes de controle. Representação dos pontos for-

necidos pelo método GGCBA_1S e do vetor gradiente da

função linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

Figura 3.18 Volume do canto superior esquerdo da malha regular com

85 volumes de controle. Representação dos pontos for-

necidos pelo método GGCBA_1S e do vetor gradiente da

função linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

Figura 3.19 Distribuição do erro na malha regular mais grosseira uti-

lizando GGCBA_2S. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

Figura 3.20 Distribuição do erro na malha com 85 volumes utilizando

GGCBA_2S. Mesma faixa de valores empregada na figura

3.16. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

Figura 3.21 Volumes centrais nas malhas regulares analisando o mé-

todo GGCBW_1S. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

Figura 3.22 Volumes laterais nas malhas regulares analisando o mé-

todo GGCBW_1S. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

vii



Figura 3.23 Distribuição do erro na malha com 85 volumes de con-

trole utilizando GGCBW_1S. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

Figura 3.24 Distribuição do erro na malha regular com 85 volumes de

controle utilizando GGVBID. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72

Figura 3.25 Convergência do gradiente de pressão nas malhas regu-

lares com a função oscilatória. Métodos com abordagem

cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

Figura 3.26 Convergência do gradiente de pressão nas malhas regu-

lares com a função oscilatória. Métodos com abordagem

vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

Figura 3.27 Convergência do gradiente de pressão nas malhas regu-

lares com a função oscilatória. Métodos utilizando míni-

mos quadrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

Figura 3.28 Convergência do gradiente de pressão nas malhas regula-

res com a função exponencial. Métodos com abordagem

cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

Figura 3.29 Convergência do gradiente de pressão nas malhas regula-

res com a função exponencial. Métodos com abordagem

vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

Figura 3.30 Convergência do gradiente de pressão nas malhas regula-

res com a função exponencial. Métodos utilizando míni-

mos quadrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

Figura 3.31 Convergência do gradiente de pressão nas malhas regula-

res com a função descontínua. Métodos com abordagem

cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

Figura 3.32 Convergência do gradiente de pressão nas malhas regula-

res com a função descontínua. Métodos com abordagem

vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

Figura 3.33 Convergência do gradiente de pressão nas malhas regula-

res com a função descontínua. Métodos utilizando míni-

mos quadrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

Figura 3.34 Distribuição do erro na malha com 742 volumes de con-

trole utilizando LSSID. Função descontínua. . . . . . . . . . . . . . . 79

viii



Figura 3.35 Faces do volume de controle p localizado na interface. . . . . 81

Figura 3.36 Volumes de controle vizinhos a um volume de menor ta-

manho na interface. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

Figura 3.37 Volumes adjacentes aos vértices v1, v2 e v3. . . . . . . . . . . . . . . . . 82

Figura 3.38 Convergência do gradiente de pressão nas malhas não-

conformes. Métodos com abordagem cell-based. . . . . . . . . . 83

Figura 3.39 Convergência do gradiente de pressão nas malhas não-

conformes. Métodos com abordagem vertex-based. . . . . . . . 83

Figura 3.40 Convergência do gradiente de pressão nas malhas não-

conformes. Métodos utilizando mínimos quadrados. . . . . . 84

Figura 3.41 Convergência do gradiente de pressão nas malhas com

razão de aspecto alta. Métodos com abordagem cell-based. 84

Figura 3.42 Convergência do gradiente de pressão nas malhas com

razão de aspecto alta. Métodos com abordagem vertex-

based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

Figura 3.43 Convergência do gradiente de pressão nas malhas com

razão de aspecto alta. Métodos utilizando mínimos qua-

drados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

Figura 3.44 Convergência do gradiente de pressão nas malhas com

distorção aleatória. Métodos com abordagem cell-based. . 86

Figura 3.45 Convergência do gradiente de pressão nas malhas com

distorção aleatória. Métodos com abordagem vertex-based. 87

Figura 3.46 Convergência do gradiente de pressão nas malhas com

distorção aleatória. Métodos utilizando mínimos quadra-

dos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

Figura 3.47 Convergência do gradiente de pressão nas malhas com

distorção senoidal. Métodos com abordagem cell-based. . 88

Figura 3.48 Convergência do gradiente de pressão nas malhas com

distorção senoidal. Métodos com abordagem vertex-based. 89

Figura 3.49 Convergência do gradiente de pressão nas malhas com

distorção senoidal. Métodos utilizando mínimos quadra-

dos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89

ix



Figura 3.50 Distribuição do erro na malha regular com 232 volumes

de controle utilizando GGCBW_2S. . . . . . . . . . . . . . . . . . . . . . . . 91

Figura 3.51 Distribuição do erro na malha com distorção senoidal com

232 volumes de controle e utilizando GGCBW_2S. . . . . . . . . 91

Figura 3.52 Distribuição do erro na malha com distorção aleatória

com 232 volumes de controle utilizando GGCBW_2S. . . . . . 92

Figura 3.53 Convergência do gradiente de pressão nas diferentes ma-

lhas apresentadas, considerando o método GGCBW_1S. . . 93

Figura 3.54 Convergência do gradiente de pressão nas diferentes ma-

lhas apresentadas, considerando o método GGCBW_2S. . . 93

Figura 3.55 Convergência do gradiente de pressão nas diferentes ma-

lhas apresentadas, considerando o método GGVBPL. . . . . . 94

Figura 3.56 Convergência do gradiente de pressão nas diferentes ma-

lhas apresentadas, considerando o método LSSID. . . . . . . . . 94

Figura 3.57 Tempo de inicialização considerando os métodos com

abordagem cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

Figura 3.58 Tempo de reconstrução considerando os métodos com

abordagem cell-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

Figura 3.59 Tempo de inicialização considerando os métodos com

abordagem vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

Figura 3.60 Tempo de reconstrução considerando os métodos com

abordagem vertex-based. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

Figura 3.61 Tempo de inicialização considerando os métodos que uti-

lizam mínimos quadrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

Figura 3.62 Tempo de reconstrução considerando os métodos que uti-

lizam mínimos quadrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

Figura 4.1 Volumes de controle que participam da equação aproxi-

mada associada a p. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

Figura 4.2 Representação de um volume de controle e disposição do

novo sistema coordenado (?,?). . . . . . . . . . . . . . . . . . . . . . . . . . . 108

Figura 4.3 Decomposição do vetor e? no sistema cartesiano. . . . . . . . . . 109

x



Figura 4.4 Eixo coordenado ? e centroides p e f. . . . . . . . . . . . . . . . . . . . . . 110

Figura 4.5 Entidades envolvidas na determinação do fluxo em uma

face interna. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

Figura 4.6 Duas situações possíveis para transformação dos siste-

mas coordenados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

Figura 4.7 Transformação dos sistemas coordenados para o caso em

que as projeções verticais dos vetores rp,n e da área face
são maiores que as projeções horizontais. . . . . . . . . . . . . . . . . 115

Figura 4.8 Volume de controle adjacente a uma fronteira. . . . . . . . . . . . . 117

Figura 5.1 Domínio com as condições de contorno do caso 1. Malha

regular. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

Figura 5.2 Convergência da pressão nas malhas regulares. Caso 1. . . . 123

Figura 5.3 Convergência da pressão considerando LSSID. Caso 1. . . . . 125

Figura 5.4 Comparação entre a pressão obtida com as soluções ana-

lítica e numérica na malha RE com 2232 volumes de con-

trole. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125

Figura 5.5 Convergência do gradiente considerando LSSID. Caso 1. . . 126

Figura 5.6 Convergência da pressão considerando valores do parâ-

metro ? entre 1 e 10000. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127

Figura 5.7 Convergência da pressão considerando valores de ? uni-

tário e menor que a unidade. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128

Figura 5.8 Problema rotacionado. Domínio discretizado com a ma-

lha regular. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

Figura 5.9 Convergência da pressão considerando valores de ? entre

1 e 0.0001. Problema rotacionado. . . . . . . . . . . . . . . . . . . . . . . . . 129

Figura 5.10 Convergência da pressão considerando valores de ? entre

1 e 100. Problema rotacionado. . . . . . . . . . . . . . . . . . . . . . . . . . . . 130

Figura 5.11 Convergência da pressão considerando o esquema total-

mente implícito nas malhas DS e RA. . . . . . . . . . . . . . . . . . . . . . 131

Figura 5.12 Domínio físico com as condições de contorno do caso 2. . 132

Figura 5.13 Convergência da pressão nas malhas regulares. Caso 2. . . . 133

xi



Figura 5.14 Convergência da pressão nas malhas RE, NC e DA. Mé-

todo LSSID, caso 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

Figura 5.15 Convergência do gradiente de pressão nas malhas RE, NC

e DA. Método de reconstrução LSSID, caso 2. . . . . . . . . . . . . . 135

Figura A.1 Elementos geométricos envolvidos no procedimento de

pseudolaplaciano. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

Figura B.1 Superfície plana com representação das coordenadas de

seu centroide. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152

xii



L I S TA D E TA B E L A S

Tabela 3.1 Informações sobre as malhas regulares, com distorção

aleatória e com distorção senoidal. . . . . . . . . . . . . . . . . . . . . . . . 54

Tabela 3.2 Informações sobre as malhas não-conformes. . . . . . . . . . . . . 54

Tabela 3.3 Informações sobre as malhas com razão de aspecto alta. . . 55

Tabela 3.4 Significado das siglas referentes aos métodos de recons-

trução do gradiente. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

Tabela 3.5 Significado das siglas referentes às malhas. . . . . . . . . . . . . . . . 58

Tabela 3.6 Coordenadas e valores de pressão em alguns pontos asso-

ciados ao volume de controle no canto inferior esquerdo. . 65

Tabela 3.7 Coordenadas e valores de pressão em alguns pontos asso-

ciados ao volume de controle no canto superior esquerdo. 65

Tabela 3.8 Valores da constante a e da ordem de convergência b

obtidos nas malhas regulares, com distorção aleatória e

senoidal. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

Tabela 5.1 Especificação dos casos considerados. . . . . . . . . . . . . . . . . . . . . 121

xiii





L I S TA D E S Í M B O LO S

Símbolos latinos

P Pressão

K Tensor permeabilidade

S Superfície

A Coeficiente da equação discretizada

V Volume

q Fluxo de massa injetado ou produzido por unidade de

volume de reservatório

Q Fluxo de massa injetado ou produzido

v Vetor velocidade

x , y Coordenadas do sistema cartesiano ou global

h Comprimento característico dos volumes de controle da

malha

a Constante relacionada à determinação da norma do erro

do gradiente

b Ordem de convergência relacionada à determinação da

norma do erro do gradiente

Símbolos gregos

?S f Vetor área de uma face

? Variável genérica

?V Volume de um volume de controle

µ Viscosidade dinâmica

xv



? Massa específica

?,? Coordenadas do sistema local

? Porosidade

? Domínio de uma solução

? Constante relacionada à determinação do tempo

computacional

? Ordem relacionada à determinação do tempo

computacional

? Razão de anisotropia

Subscritos

p Volume de controle qualquer da malha

v Vértice da malha

f Centroide da face

Sobrescritos

num Numérico

a Analítico

n Nível iterativo atual

n ?1 Nível iterativo anterior ao analisado

Símbolos especiais

A Representação de uma matriz

? Operador nabla

f ? p Faces pertencentes ao volume de controle p

??,?? Derivada parcial de primeira ordem com relação às coor-

denadas locais

?x ,?y Derivada parcial de primeira ordem com relação às coor-

denadas cartesianas

Nc Número de volumes de controle da malha

xvi



Nvc Número de volumes de controle que cercam um dado

volume de controle

Nv Número de volumes de controle que cercam um dado

vértice

Nfi Número de faces internas de uma malha

Nff Número de faces de fronteira de uma malha

Nve Número de vértices de uma malha

?f Fator de ponderação referente aos métodos de reconstru-

ção do gradiente com abordagem cell-based

w k Fator de ponderação referente aos métodos de reconstru-

ção do gradiente com abordagem vertex-based

?k Fator de ponderação referente aos métodos de reconstru-

ção que empregam mínimos quadrados

"i Erro de aproximação do gradiente em um volume de

controle

"grad Norma do erro do gradiente em uma determinada malha

"p Norma do erro da pressão em uma determinada malha

?PI Norma da variação do campo de pressão entre duas itera-

ções consecutivas

xvii





R E S U M O

Uma estratégia especial para a discretização de reservatórios de petróleo
encontrada na literatura tem por princípio manter o uso das tradicionais
malhas corner-point nas regiões afastadas dos poços e empregar malhas
cilíndricas ao redor destes. A necessária conexão entre estes dois tipos de
malhas é sugerida ser feita através de malhas de transição, cuja caracterís-
tica principal é apresentar volumes de controle genéricos com um número
arbitrário de faces. Dando ênfase a este tipo de malhas, também denomi-
nadas na literatura por malhas poligonais, o presente trabalho tem como
foco o estudo, a implementação e a análise de métodos de reconstrução
explícita do gradiente nelas empregados. Os métodos de reconstrução têm
como tarefa fundamental determinar os vetores gradiente associados a
todos os volumes de controle de uma malha poligonal através de valores
discretos de pressão, associados aos centroides desses volumes. Tais
métodos podem ser divididos em dois grandes grupos: um deles se utiliza
da fórmula de Green-Gauss, derivada do teorema da divergência, e o outro
emprega os princípios do método dos mínimos quadrados. Testes em
diferentes tipos de malhas poligonais e considerando diferentes funções,
cada uma representando um campo de pressão ao longo do domínio, são
realizados com o intuito de determinar quais métodos de reconstrução
apresentam os melhores resultados numéricos e tempos computacionais
razoáveis para serem executados. Os resultados numéricos são analisados
de acordo com a ordem de convergência do gradiente de pressão e também
de acordo com a magnitude da norma do erro deste gradiente. A determi-
nação daqueles métodos que melhor desempenham a sua função e apre-
sentam uma boa relação custo/benefício é importante para os esquemas
numéricos que se utilizam do resultado do gradiente para aproximar os
fluxos através das faces dos volumes de controle poligonais. Um esquema
numérico que emprega o princípio anterior é também apresentado neste
trabalho. Dois casos são testados com o intuito de avaliar a metodologia
numérica proposta.

xix





A B S T R AC T

A special strategy for petroleum reservoir discretization found in the litera-
ture is based on the principle of maintain the use of the traditional corner-
point grids in the regions away from the wells and employ cylindrical
grids around them. The connection between these two types of grids is
suggested to be made using transitional grids whose main characteristic is
to be formed by control volumes with an arbitrary number of faces. This
kind of grids is mostly known in the literature as polygonal grids. This
work focuses on the study, the implementation, and the analysis of explicit
gradient reconstruction methods employed with those grids. The purpose
of these methods is to approximate the gradient vectors associated with all
the control volumes of a polygonal grid using discrete values of pressure,
localizated at control volume centroids. The methods belong to two
main groups: one of them uses the Green-Gauss formula, derived from
the divergence theorem, and the other one employs the least squares
method. Tests on different types of polygonal grids and considering
different functions, each one representing a pressure field in the domain,
are performed in order to determine the gradient reconstruction methods
that give more accurate numerical results in reasonable computational
times. The numerical results are analyzed according to the convergence
order of the pressure gradient and also according to the magnitude of the
gradient error norm. The determination of the methods that show a good
cost/benefit ratio is important for numerical schemes that need gradients
for approximating the mass-flow through the control volumes interfaces. A
numerical scheme applying gradient reconstruction methods to a single-
phase flow model is also presented in this work. Two cases are tested in
order to evaluate the numerical methodology proposed.

xxi





CAPÍTULO

1
I N T RO D U Ç ÃO

1.1 Preliminares

O petróleo a ser explotado através de poços é encontrado em uma

rocha denominada de rocha-reservatório, que possui a característica de

apresentar em seu interior espaços vazios interconectados denominados

de poros. Sendo o reservatório composto por uma rocha porosa, a modela-

gem física do escoamento de fluidos em seu interior é usualmente descrita

pela lei de Darcy, que para um primeiro momento pode ser entendida

como a relação entre a velocidade do fluido, o gradiente de pressão que

promove o escoamento e as propriedades da rocha e do fluido.

Devido à crescente necessidade de se fazer previsões realísticas de

diversos processos físicos e graças ao crescimento da tecnologia dos com-

putadores, as simulações numéricas têm se tornado cada vez mais impor-

tantes e comuns. No caso de um reservatório de petróleo, os simuladores

numéricos são capazes de fazer previsões da produção ao longo do tempo

e informar sobre o desempenho de acordo com o esquema de produção

adotado. Graças a isso, as condições ótimas de explotação do reservatório

podem ser determinadas. De uma maneira mais específica, através da

simulação numérica pode ser analisado o comportamento de um reser-

vatório sujeito à injeção de diferentes fluidos (água e gás, por exemplo) e a

diferentes vazões, bem como pode ser determinado o efeito da localização

de poços e do espaçamento entre eles na recuperação final de óleo e/ou
gás [34].

1



2 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Os simuladores numéricos são baseados em modelos matemáticos

que descrevem o fenômeno físico em análise, e utilizam diversos métodos

numéricos para resolver as equações diferenciais parciais que geralmente

encontram-se em tais modelos. Essas equações diferenciais são resolvidas

numericamente em um domínio discretizado substituindo-se as referidas

equações por um conjunto de equações algébricas que envolvem as variá-

veis em questão [25]. A discretização do domínio de solução é um processo
que consiste na divisão deste em um número finito de blocos menores aos

quais se associam valores discretos das variáveis. O conjunto destes blocos,

chamados de volumes de controle no caso do método dos volumes finitos
1, utilizado neste trabalho, forma a malha computacional [17].

Nos primórdios da simulação numérica de reservatórios, a geometria

de um reservatório era discretizada de maneira simplificada, utilizando

as malhas cartesianas. Contudo, com a necessidade de representar esta

geometria de uma maneira mais realística, malhas com uma maior flexi-

bilidade começaram a ser utilizadas. As malhas, denominadas de corner-

point, são atualmente as mais empregadas nos softwares comerciais de

simulação de reservatórios. Essas malhas são malhas estruturadas 2 for-

madas por blocos hexaédricos em que as coordenadas de cada um dos

vértices que os definem podem ser especificadas individualmente. O seu

uso está enraizado na comunidade técnica e científica envolvida na simu-

lação de reservatórios e por isso tentativas de utilização de outros tipos

de malhas esbarram em dificuldades adicionais, como por exemplo, o fato

de todas as ferramentas de pré-processamento estarem implementadas

considerando esse tipo de representação discreta para os reservatórios. Na

simulação de reservatórios, normalmente são utilizados métodos numéri-

cos cell-centered os quais se caracterizam por associar as variáveis discretas

ao centro geométrico dos blocos [28].
A desvantagem das malhas corner-point é que quando as estruturas

geológicas apresentam formas muito complicadas, elas só conseguem re-

alizar uma representação muito grosseira da geometria. Em [26] são apre-
sentadas as construções e características de oito tipos de malhas corner-

point. A figura 1.1 ilustra três tipos comuns destas malhas.

Buscando-se uma maior versatilidade na discretização de domínios

1 Todo método numérico que satisfaz a conservação de uma propriedade (massa, energia,
por exemplo) em nível de volumes de controle é um método de volumes finitos [25].

2 Malhas que necessitam obedecer uma estrutura preestabelecida.



CA PÍT ULO 1 – INT RO DUÇÃO 3

Figura 1.1 – Exemplos de malhas corner-point extraídas de [26].

complexos, as malhas não-estruturadas, muito utilizadas em diversos pro-

blemas de engenharia, passaram também a ser utilizadas em alguns pro-

blemas de simulação de reservatórios. A adaptação à geometria do reser-

vatório bem como o refinamento em regiões específicas podem ser alcan-

çados com maior facilidade empregando-se esse tipo de malhas [25]. A dis-
cretização as utilizando pode ser realizada através de triângulos (tetraedos

para o caso 3D), quadriláteros (hexaedros em 3D) ou ainda pode-se partir

para uma discretização mista onde tanto triângulos quanto quadriláteros

são empregados.

1.2 Motivação

O escoamento de fluidos nas proximidades dos poços apresenta um

comportamento diferente daquele encontrado no restante do reservató-

rio. Tratam-se de regiões muito importantes que merecem uma atenção.

Uma forma especial de discretização para essas regiões, proposta como

parte de um projeto de pesquisa e desenvolvimento (P&amp;amp;D) em execução no

SINMEC - Laboratório de Simulação Numérica em Mecânica dos Fluidos e

Transferência de Calor e inserido na Rede Temática de Simulação e Geren-

ciamento de Reservatórios, motivou a realização deste trabalho. A referida

discretização segue propostas encontradas em [7, 31] sendo que as figuras
1.2 e 1.3 ilustram a estratégia adotada para o caso 3D e 2D respectivamente.

De acordo com tal proposta, primeiramente discretiza-se o reserva-

tório com uma malha corner-point convencional, da mesma maneira feita

tradicionalmente. Definida a trajetória dos poços, eliminam-se da ma-

lha original os blocos interceptados por eles e também alguns vizinhos,

formando-se cavidades que necessitam ser preenchidas.

A fim de preencher tais espaços vazios, na região em torno dos poços

geram-se malhas cilíndricas. Este tipo de malhas é empregado devido



4 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Malha de transição

Malha corner-point

Malha cilíndrica

Figura 1.2 – Ilustração em 3D da forma especial de discretização de um
reservatório. Modificada de [27].

Figura 1.3 – Ilustração em 2D da forma especial de discretização. Malha
poligonal está apresentada na cor laranja.

ao comportamento radial do escoamento nas proximidades dos poços,

tornando mais preciso o cálculo do fluxo de massa através das faces dos

volumes de controle. Além disso, existe a possibilidade de refinamento

destas malhas de tal maneira que se pode captar os elevados gradientes

de pressão característicos de tal região. A utilização das malhas cilíndri-

cas não preenche por completo a cavidade gerada devido à eliminação

de alguns dos blocos da malha corner-point. Existe então a necessidade

de preencher os espaços entre os blocos da malha original e as malhas

cilíndricas.



CA PÍT ULO 1 – INT RO DUÇÃO 5

Os espaços restantes são completados com as chamadas malhas de

transição que apresentam volumes de controle capazes de se adaptar à

geometria dos referidos espaços, que em geral é intrincada. Tal adaptação

é possível já que tais malhas apresentam volumes de controle genéricos

cujo número de faces é arbitrário. Sendo assim, devido às características

das malhas de transição, elas serão designadas neste trabalho por malhas

poligonais, denominação convencional encontrada na literatura.

Deve ficar claro que apesar da motivação estar relacionada com uma

nova estratégia para a discretização de reservatórios de petróleo, o foco

deste trabalho está no estudo, na implementação e na análise de métodos

de reconstrução do gradiente de pressão empregados nas malhas poligo-

nais. Os resultados obtidos mediante tais métodos são utilizados em um

esquema numérico para aproximar os fluxos através das faces dos volu-

mes de controle das referidas malhas. Tal esquema é objeto de estudo no

projeto P&amp;amp;D comentado, sendo assim, o presente trabalho deve ser enca-

rado como o primeiro passo para que a discretização sugerida no referido

projeto seja realmente possível.

Vale destacar que para o desenvolvimento deste trabalho foram em-

pregadas as ferramentas disponíveis nas bibliotecas Orion criadas no pro-

jeto citado. Com estas bibliotecas é possível, por exemplo, obter toda a

representação computacional das malhas poligonais (geometria, topolo-

gia) e dados geométricos como áreas, centroides de faces e volume dos

volumes de controle.

1.3 Objetivos e contribuições

O presente trabalho tem como objetivo principal analisar métodos de

reconstrução explícita do gradiente de pressão a fim de determinar quais

deles são mais apropriados para se fazer a aproximação de fluxos nas ma-

lhas poligonais. Para isto é de suma importância:

• Apresentar os princípios dos referidos métodos de reconstrução do
gradiente e avaliar os seus desempenhos procurando identificar aque-

les que apresentam a melhor relação custo/benefício;
• Apresentar e avaliar o esquema numérico proposto para aproxima-

ção dos fluxos nas referidas malhas poligonais.

A ideia é contribuir para o avanço nos estudos do acoplamento poço-

reservatório, considerando uma discretização ainda pouco usual na área



6 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

de simulação de reservatórios. Tal discretização, conforme comentado

anteriormente, possibilita o refinamento da malha nas regiões próximas ao

poço objetivando captar os elevados gradientes de pressão ali presentes,

calcular os fluxos de forma mais precisa nas referidas regiões e por con-

sequência obter uma previsão mais precisa da produção dos poços.

1.4 Malhas poligonais

Uma seção especial para este tipo de malha é aqui apresentada por

serem estas as analisadas neste trabalho. Conforme seu próprio nome

indica, tais malhas são formadas por volumes de controle poligonais sendo

os métodos numéricos nelas empregados do tipo cell-centered.

As malhas tetraédricas e estruturadas hexagonais têm sido usadas por

décadas na maioria das simulações numéricas de engenharia, sendo as-

sim possuem um grande acervo de métodos numéricos possíveis de serem

empregados. Atualmente o uso de malhas não-estruturadas poligonais

(poliédricas para o caso 3D) para discretização de domínios físicos está se

tornando mais comum, surgindo-se a necessidade de métodos de discre-

tização gerais que não apresentam restrições com relação ao número de

faces dos volumes de controle [28].
Na simulação de reservatórios as malhas poligonais/poliédricas po-

dem se adaptar às complexas características geométricas que podem apre-

sentar os reservatórios [10]. Algumas vantagens destas malhas com relação
a outros tipos de malhas são aqui apresentadas de acordo com [21] e [14]:

• Os volumes de controle poligonais/poliédricos possuem uma maior
conectividade com seus vizinhos. Este fato geralmente melhora a

convergência da solução comparando-se com a observada em ma-

lhas não-estruturadas formadas por volumes simples, como triân-

gulos e tetraedros, por exemplo;

• Menor número global de volumes de controle em relação às malhas
não-estruturadas simples de triângulos ou tetraedros, para uma so-

lução com precisão equivalente;

• Facilidade de fazer o refino local adaptativo;

• Possibilidade de obtenção através da conversão de malhas
não-estruturadas de triângulos ou tetraedros;



CA PÍT ULO 1 – INT RO DUÇÃO 7

• Devido à sua generalidade, outros tipos de malhas, incluindo as
corner-point, podem ser consideradas casos particulares de malhas

poligonais ou poliédricas [27].

Como o objetivo deste trabalho não está focado na geração das ma-

lhas poligonais e sim em um esquema numérico para tratá-las, procurou-

se a alternativa mais acessível para obtê-las. Sua obtenção é possível atra-

vés de uma sequência de operações envolvendo diferentes softwares, de-

talhadamente apresentada em [28], porém, sendo aqui descrita de forma
sucinta. Primeiramente, através de uma determinada geometria gera-se

uma malha não-estruturada convencional utilizando-se o ICEM [5]. O
conjunto, malha e geometria, é exportado em um formato possível de ser

lido no Fluent [4] onde a malha não-estruturada é convertida em malha
poliédrica. Deve-se ressaltar que somente as malhas tridimensionais são

possíveis de serem convertidas no referido software comercial.

A malha poliédrica obtida é assim exportada no formato Ensight Gold,

podendo ser lida pela biblioteca especializada de entrada e saída de ma-

lhas que forma parte das bibliotecas Orion. O domínio discretizado pela

malha poliédrica é definido de tal forma que uma das fronteiras da malha,

formada por polígonos, possa ser extraída e utilizada como malha poligo-

nal. Esse processo de extração é realizado também utilizando uma rotina

implementada nas bibliotecas Orion.

A malha poligonal obtida pode também ser exportada no formato En-

sight Gold, que é o formato padrão utilizado pelo software de visualização

Ensight [11]. Nesse software tanto a malha como os campos escalares e
vetoriais a ela associados podem ser visualizados e analisados.

As malhas poligonais são compostas por diferentes entidades geomé-

tricas. Os volumes de controle, entidades de dimensão maior das malhas,

são polígonos planos limitados por um número arbitrário de faces. Em

duas dimensões, as faces são retas determinadas por dois vértices. Na

figura 1.4 estão ilustradas cada uma das entidades citadas.

Notação utilizada

Nesta seção descreve-se a notação utilizada neste trabalho a fim de

simbolizar as entidades geométricas associadas às malhas poligonais.

Um volume de controle qualquer será designado por p, sendo o seu

centroide também assim denominado. O centroide é um ponto impor-



8 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

(a) (b) (c1)

Figura 1.4 – Entidades envolvidas nas malhas poligonais: (a) Volume de
controle, (b) Faces e (c) Vértices.

tante já que o valor da variável pressão associado ao volume de controle

estará ali representado. Quando uma face isolada for analisada sua repre-

sentação será dada por f. Entretanto, quando todas as faces de um volume

de controle forem consideradas, na representação anterior adicionar-se-

á o subíndice k , cujo valor varia de 1 até o número de faces do volume

de controle em questão, como ilustrado na figura 1.5. Como mostra essa

figura, os índices associados a essas faces não precisam estar ordenados.

O valor de pressão associado a uma face será aquele avaliado no seu cen-

troide. O centroide de uma face será também designado por f.

Em alguns dos métodos a serem discutidos posteriormente o valor

da variável pressão na face é obtido considerando-se os dois volumes de

controle que a tem em comum. A fim de diferenciá-los, um dos volumes

será designado por p e o outro por n conforme pode ser visto na figura 1.6.

Um vértice de uma malha será representado por v. Em alguns dos

métodos a serem apresentados haverá a necessidade de associar o valor de

pressão em um vértice aos valores nos volumes de controle que o cercam.

Tais volumes de controle serão designados por pk com k = 1, 2, ..., Nv sendo
Nv o número de volumes de controle cercando o dado vértice. A figura 1.7

mostra um exemplo da configuração comentada. Como cada face de uma

malha poligonal contém apenas dois vértices, estes serão representados

simplesmente por v1 e v2.

Os volumes de controle vizinhos a um dado volume de controle p

serão denominados por nk com k = 1, 2, ..., Nvc sendo Nvc o número de
volumes de controle vizinhos a p. A numeração dos vizinhos é realizada

de acordo com a numeração das faces de p. Um volume de controle e seus

vizinhos são representados na figura 1.8.



CA PÍT ULO 1 – INT RO DUÇÃO 9

p 1f

2f
3f

4f

5f
6f

Figura 1.5 – Representação de uma malha poligonal com destaque para
volume de controle p e suas faces.

p

f

n

Figura 1.6 – Representação de uma malha poligonal com ênfase nos dois
volumes de controle vizinhos que possuem a face f em comum.

1.5 Problema físico

Nesta seção é apresentado o modelo matemático que descreve o des-

locamento monofásico de um fluido através de um meio poroso. Alguns

conceitos envolvidos nas equações são também expostos. Deve ser ressal-

tado que um problema bidimensional é considerado neste trabalho.



10 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1p
2p

v

3p

Figura 1.7 – Notação empregada para um vértice em uma malha poligonal
e dos volumes de controle que o cercam.

3n 2n

n

5n
6n

p
1n4

Figura 1.8 – Notação utilizada para os vizinhos de um volume de controle
p .

As hipóteses adotadas para o modelo monofásico bidimensional são:

1. Escoamento monofásico e isotérmico num plano horizontal;

2. Meio poroso consolidado 3, anisotrópico e homogêneo;

3. Fluido de massa específica e viscosidade constantes.

3 As propriedades de um meio poroso consolidado (como permeabilidade e porosidade
por exemplo) não variam com o tempo.



CA PÍT ULO 1 – INT RO DUÇÃO 11

Descrição macroscópica

A análise do escoamento em meios porosos pode ser realizada de

acordo com a descrição micro e macroscópica. O meio poroso pode ser

considerado um emaranhado de canais (poros), interconectados ou não,

por onde o fluido escoa. Utilizando a descrição microscópica, as equa-

ções diferenciais de conservação da massa e quantidade de movimento

são empregadas para descrever o movimento dos fluidos no interior desses

canais, sendo assim necessário conhecer os seus formatos bem como as

suas conectividades [2]. Devido à grande dificuldade de se obter estas
informações aliada com o grande número de poros presente no meio e

o elevado custo computacional para a solução das equações diferenciais,

torna-se impraticável o uso da descrição microscópica com o objetivo de

descrever o escoamento considerando uma escala cuja ordem de grandeza

for maior que a escala dos poros [17].
A descrição macroscópica é então utilizada na simulação de reserva-

tórios de petróleo. Um detalhamento dos poros do meio não é aqui neces-

sário sendo as grandezas físicas envolvidas no escoamento consideradas

como variáveis contínuas, definidas em todo espaço ocupado pelo meio.

Os valores destas variáveis representam na realidade uma média volumé-

trica dos valores microscópicos considerando-se uma certa quantidade de

poros [17].
Das propriedades envolvidas na descrição macroscópica, a porosi-

dade é classificada como uma grandeza volumétrica, sendo sua definição

proveniente da definição de média volumétrica. Já a permeabilidade ab-

soluta é classificada como grandeza relativa ao escoamento pois sua defi-

nição está estritamente relacionada com a passagem do fluido através do

meio poroso. Devido à importância, estas duas propriedades são definidas

a seguir.

Porosidade

Porosidade é a medida da capacidade de armazenamento de fluidos

em uma dada rocha [1]. Quantitativamente ela é definida como a razão
entre o volume vazio (ou volume poroso) e o volume total

?=
Vv
VT
=

Vv
Vv +Vs

(1.1)



12 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

onde Vv é o volume vazio e Vs o volume ocupado pela matriz sólida.

Conceitos estatísticos e matemáticos são aplicados para se obter a

distribuição da porosidade em um reservatório. Para isto são realizadas

medições em várias amostras do meio poroso retiradas de diversos poços

perfurados no reservatório.

Permeabilidade absoluta

Permeabilidade absoluta (ou simplesmente permeabilidade) é a pro-

priedade de um meio poroso que mede a sua capacidade de transmitir

fluidos, ou, ainda, é uma medida da condutividade de fluidos.

Essa propriedade é definida matematicamente pela lei de Darcy [1]

v =?
K

µ
?P (1.2)

sendo v a velocidade de Darcy, P a pressão, µ a viscosidade absoluta do
fluido e K o tensor permeabilidade [17]. Vale ressaltar que a lei de Darcy
é amplamente utilizada em simulações de reservatórios e o modelo apre-

sentado é destinado a descrever o escoamento monofásico num plano ho-

rizontal, por isso os efeitos gravitacionais estão sendo desconsiderados.

A lei de Darcy é aplicada somente nas regiões de escoamento lami-

nar, tendo o gradiente de pressão um comportamento diferente do apre-

sentado quando a velocidade do fluido é maior (escoamento turbulento).

Felizmente, para escoamentos em reservatórios a lei de Darcy é válida [12],
substituindo no nível macroscópico a equação da conservação de quanti-

dade de movimento.

Conforme já mencionado, a permeabilidade apresentada na equação

(1.2) é representada normalmente como um tensor simétrico de segunda

ordem. Considerando o sistema cartesiano e um caso bidimensional, essa

propriedade pode ser expressa por

K=

 

K x x K x y

K x y K y y

!

(1.3)

Se o meio poroso for isotrópico, o tensor permeabilidade torna-se

K=

 

K 0

0 K

!

(1.4)



CA PÍT ULO 1 – INT RO DUÇÃO 13

podendo assim a propriedade ser representada por uma grandeza escalar

(K ). No Sistema Internacional (SI), a unidade da permeabilidade é (m 2),

porém, na indústria petrolífera é comumente utilizado o Darcy 4 (D), ou,
ainda, o miliDarcy 5 (m D).

Equação fundamental do modelo

O escoamento de fluidos através de um meio poroso é governado

pelas equações de conservação da massa, quantidade de movimento e

energia da mesma maneira que o escoamento através de um duto ou uma

tubulação. Contudo, conforme comentado anteriormente, quando se uti-

liza a descrição macroscópica, a lei de Darcy é empregada substituindo a

equação de conservação de quantidade de movimento e sendo o escoa-

mento tratado como isotérmico, a equação de conservação de energia não

é utilizada. Assim, para descrever o tipo de escoamento considerado neste

trabalho, somente é necessário aplicar a equação da conservação da massa

em conjunto com a lei de Darcy.

A equação da conservação da massa na sua forma diferencial para o

caso de escoamento monofásico apresentando um termo fonte q pode ser

encontrada em [6]
?(??)
?t

=?? ·(?v)+q (1.5)

sendo ? a massa específica do fluido e q o fluxo de massa produzido ou

injetado por unidade de volume do reservatório (sinal positivo para injeção

e negativo para produção). As demais grandezas físicas que aparecem na

referida equação foram recém definidas.

Lembrando que, segundo as hipóteses realizadas no início desta se-

ção, o meio poroso analisado é consolidado e o fluido apresenta massa

específica constante. Tais considerações fazem com que o termo temporal

da equação (1.5) deixe de existir resumindo-se a equação da conservação

da massa a

? ·(?v)=q (1.6)

Como a viscosidade do fluido também é considerada constante, ao

substituir a lei de Darcy na equação anterior chega-se a

4 1D = 9, 86923x 10?13 m 2
5 1m D = 10?3 D



14 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

?? ·(K?P)=
qµ

?
(1.7)

A equação resultante é uma equação de segunda ordem na pressão

que em conjunto com as condições de contorno, a serem definidas de

acordo com o problema a ser modelado, define como ocorre o escoamento

do óleo através do reservatório. Deve-se resolver numericamente esta equa-

ção a fim de se obter os campos de pressão no domínio físico em questão.

O modelo monofásico bidimensional permanente utilizado neste tra-

balho é simplificado, contudo espera-se obter resultados coerentes com a

física envolvida no problema. Vale a pena destacar que a equação (1.7) é o

núcleo da maioria dos modelos empregados na simulação de reservatórios

pois o termo? · (K?P), ou uma variante dele, aparece em todos eles [27].
A discretização de um modelo de escoamento em meios porosos encontra

como grande desafio discretizar o referido termo.

Deve-se salientar também que as simplificações adotadas são válidas

já que o enfoque do trabalho é a análise dos métodos de reconstrução

do gradiente (a serem discutidos no próximo capítulo) a fim de realizar a

aproximação dos fluxos nas malhas poligonais.

1.6 Organização do trabalho

Este trabalho está dividido em 6 capítulos incluindo o presente intro-

dutório e a conclusão.

O capítulo 2 é dedicado aos métodos de reconstrução explícita do

gradiente de pressão considerados. Todas as expressões envolvidas são

demonstradas com o objetivo de deixar o mais clara possível a forma de

se aproximar o gradiente a partir dos valores discretos da pressão.

Com o intuito de avaliar os métodos apresentados, no capítulo 3,

testes são realizados em diferentes tipos de malhas poligonais e consi-

derando diferentes campos de pressão. Comparando os resultados dos

métodos de reconstrução do gradiente com expressões analíticas, procura-

se nesse capítulo determinar quais métodos apresentam maior precisão.

Além disso, são comparados também os tempos de computação, a fim de

determinar se existe algum método que combine boa precisão com tempos

de computação reduzidos.

O capítulo 4 descreve como é realizada a discretização da equação



CA PÍT ULO 1 – INT RO DUÇÃO 15

diferencial da pressão para escoamento monofásico, aplicando os gradi-

entes de pressão reconstruídos. O esquema numérico empregado para se

determinar os fluxos através das malhas poligonais é também evidenciado.

Finalmente, o capítulo 5 é dedicado a apresentar resultados referen-

tes a problemas-teste empregando as aproximações realizadas nos capítu-

los anteriores.





CAPÍTULO

2
M É TO D O S D E R E CO N S T RU Ç ÃO

E X P L Í C I TA D O G R A D I E N T E

2.1 Introdução

A fim de se calcular os fluxos de massa através das faces dos volu-

mes de controle poligonais empregando o esquema numérico proposto no

presente trabalho (a ser apresentado nos próximos capítulos), é necessário

determinar valores dos gradientes de pressão associados aos volumes de

controle. Assim, neste capítulo são descritos diferentes métodos propostos

na literatura para realizar essa tarefa. Vale a pena destacar que tais mé-

todos são denominados aqui de reconstrução explícita do gradiente por

empregar valores discretos de pressão já conhecidos de um nível iterativo

anterior ao corrente. O processo iterativo será também detalhado nos pró-

ximos capítulos.

Os métodos de reconstrução do gradiente podem ser divididos em

dois grandes grupos: um deles realiza a reconstrução do gradiente apli-

cando a fórmula de Green-Gauss , e o outro aplicando o método dos mí-

nimos quadrados. A classificação, vista de uma maneira geral, é demons-

trada na figura 2.1.

A tarefa fundamental destes métodos é fornecer os vetores gradiente

associados a todos os volumes de controle de uma malha a partir dos valo-

res discretos de uma variável escalar, a pressão no caso considerado. Uma

vez que o trabalho considera um método de discretização cell-centered, os

17



18 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Abordagem 
vertex-based

Método dos 
mínimos 

quadrados

Abordagem 
cell-based

Métodos de 
reconstrução do 

gradiente

Fórmula de 
Green-Gauss

Figura 2.1 – Diagrama ilustrativo dos métodos de reconstrução do gradi-
ente empregados.

valores discretos da pressão estão associados aos centroides dos volumes

de controle. A figura 2.2 ilustra a representação da aplicação dos métodos.

A seguir são apresentados os princípios dos métodos de reconstrução

explícita do gradiente que utilizam a fórmula de Green-Gauss.

Pressão Gradiente

Figura 2.2 – Esquema ilustrativo da aplicação dos métodos de reconstrução
do gradiente.



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 19

2.2 Fórmula de Green-Gauss

Considerando um volume de controle V como sendo uma região ar-

bitrária fechada e delimitada por uma superfície S, conforme ilustrado na

figura 2.3, é possível aplicar o teorema da divergência, também denomi-

nado de teorema de Gauss [9]

?

V

? ·A dV =
?

S

A · dS (2.1)

dS

V

S

z

y
x

Figura 2.3 – Representação de um volume no qual é possível utilizar o
teorema da divergência.

Na equação (2.1) A representa um determinado campo vetorial cujas
derivadas parciais de primeira ordem são contínuas, dS é o vetor diferen-
cial de área, normal à superfície S e que aponta para fora do volume de

controle e dV é o elemento diferencial de volume. O teorema da divergên-

cia afirma que a integral volumétrica do divergente do campo vetorial A ao
longo de um volume arbitrário V é igual ao fluxo desse campo através da

superfície S que o delimita [33].
Sendo ? um escalar e c um vetor constante não-nulo (c 6= 0), ao se

assumir que A =?c, a equação (2.1) pode ser escrita por

?

V

? ·(?c) dV =
?

S

?c · dS (2.2)

Aplicando identidades envolvendo o operador diferencial nabla [9], a



20 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

seguinte simplificação é possível

? ·(?c) = ?? ·c+?? ·c

= ?? ·c (2.3)

já que c é constante, e portanto, ? ·c = 0. Considerando tal simplificação
e de acordo com a propriedade comutativa do produto escalar, a equação

(2.2) toma a seguinte forma

c ·
?

V

?? dV = c ·
?

S

? dS (2.4)

Sendo c um vetor não-nulo, a condição a seguir deve ser satisfeita

?

V

?? dV =
?

S

? dS (2.5)

A equação anterior é uma forma particular do teorema de Gauss que

permite determinar o valor do gradiente de uma variável escalar em uma

certa região fechada. Para um volume de controle poligonal, a integral

de superfície nela aparente pode ser expressa através da propriedade de

aditividade das integrais [17] como o somatório de integrais sobre todas
faces que delimitam o volume de controle . Logo, a equação (2.5) pode ser

escrita
?

?V

??dV =
?

f

?

?Sf

? dS (2.6)

sendo ?Sf a área da face constituinte do referido volume de controle poli-
gonal e ?V o volume deste.

Considerando que o gradiente da variável seja uniforme ao longo de

um volume de controle genérico p e aproximando as integrais de super-

fície através da regra do ponto médio1, pode-se determinar o valor deste

gradiente por

(??)p ?
1

?Vp

?

f?p

?f?Sf (2.7)

Uma vez que para este trabalho a variável escalar em questão é a

1 A integral de superfície é aproximada como sendo o produto entre o integrando avaliado
no centroide f da face e o vetor área desta face [17].



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 21

pressão, a aproximação anterior torna-se

(?P)p ?
1

?Vp

?

f?p

Pf?Sf (2.8)

sendo o somatório realizado considerando-se todas as faces do volume de

controle p e o vetor área da face, bem como a pressão associados à face f.

A figura 2.4 apresenta um volume de controle arbitrário p onde é possível

aplicar a equação anterior.

p

fSD

VD

1

f1

fSD 2

f2

f3

f4f5

f6
fSD 3

fSD 4
fSD 5

fSD 6

p

Figura 2.4 – Representação de um volume de controle poligonal enfati-
zando os centroides das faces e os vetores área destas.

A partir da equação (2.8), denominada na literatura por fórmula de

Green-Gauss, é possível determinar aproximadamente o valor do gradi-

ente de pressão em um volume de controle arbitrário. Para isso, é necessá-

rio conhecer o valor da variável nos centroides das faces. Como o método

dos volumes finitos cell-centered é o aplicado neste trabalho, os valores dis-

cretos da variável estão associados aos centroides dos volumes de controle,

que coincidem com as células da malha. Por tal motivo, deve ficar claro

que algum esquema de interpolação é imprescindível para relacionar os

valores nas faces com os valores nos centroides dos volumes.

Duas opções de interpolação para se determinar os valores de pressão

nos centroides das faces são apresentadas na literatura. A primeira é a

denominada abordagem cell-based, que considera somente os valores da

variável nos centroides dos volumes de controle que compartilham uma

face em comum. A segunda, mais elaborada, é a abordagem vertex-based



22 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

cujo princípio é a obtenção dos valores da variável nos vértices da malha

para depois com eles determinar os valores nos centroides das faces. A

nomenclatura em inglês é utilizada por questões de clareza, conseguindo-

se expressar de maneira sucinta a ideia de cada abordagem. Nas próximas

subseções tais abordagens são apresentadas com mais detalhes.

Deve ser ressaltado que os subíndices referentes às entidades geo-

métricas que aparecem junto às variáveis, nas equações anteriores e que

venham a surgir, indicam o local onde estas são avaliadas.

2.2.1 Abordagem cell-based

Esta abordagem se utiliza dos valores de pressão localizados nos vo-

lumes de controle adjacentes a uma dada face para determinar o valor da

variável no centroide desta. Sendo assim, para uma face interna2 conforme

mostra a figura 2.5, o valor de pressão em f é determinado considerando os

valores de pressão nos volumes de controle adjacentes p e n.

p

f

n

Figura 2.5 – Volumes de controle p e n e centroide da face f.

De uma maneira geral, a determinação do valor de pressão em f utili-

zando a abordagem cell-based pode ser escrita por

Pf =(1??f) Pp +?fPn (2.9)

2 Face que não está localizada na fronteira do domínio.



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 23

onde Pf, Pp e Pn são os valores de pressão no centroide da face e nos vo-

lumes de controle p e n, respectivamente. O termo ?f é o fator de ponde-

ração, cuja determinação foi considerada de duas maneiras distintas. As

duas variantes, correspondentes a cada maneira de se obter tal fator, são

apresentadas com mais detalhes a seguir.

2.2.1.1 Média aritmética

Nesta variante, utilizada em [3, 23, 30], calcula-se o valor de pressão
em f considerando-se uma média aritmética dos valores de pressão asso-

ciados aos volumes de controle adjacentes à referida face. Assim, ?f possui

um valor fixo igual a 1/2 independentemente da geometria das entidades
envolvidas [27] e a pressão no centroide f da face passa a ser expressa por

Pf =
Pp +Pn

2
(2.10)

Com esta variante se faz uma aproximação grosseira a fim de deter-

minar o valor de pressão na face. Esta aproximação seria razoável se os

volumes de controle poligonais apresentassem características geométricas

tais que o centroide f da face em questão estivesse disposto exatamente no

(ou muito próximo do) ponto médio da linha que une os centroides dos

referidos volumes de controle.

2.2.1.2 Média ponderada pela distância

Como normalmente o centroide da face não se encontra disposto

sobre a linha que une os centroides dos volumes de controle vizinhos,

muito menos no ponto médio desta, uma outra forma de se determinar a

pressão em f é aqui apresentada. O intuito é obter um valor de pressão na

face mais preciso, levando em conta características geométricas associadas

às entidades envolvidas.

Esta nova variante tem como princípio projetar o centroide f da face

sobre a linha que une os centroides dos dois volumes de controle em ques-

tão. Da figura 2.6 tem-se os elementos geométricos envolvidos: o vetor

L p,f que une o centroide de p e f, o vetor r p,n que une os centroides dos dois
volumes de controle, e o vetor s que une o centroide p com o ponto f´, que é
a projeção do centroide f sobre a linha que une os centroides dos volumes.

Essa projeção é feita a fim de obter um ponto sobre a linha que une p e n



24 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

localizado o mais próximo possível de f. Vale a pena ressaltar que apesar de

f´ estar localizado sobre a face na referida figura, esta configuração é uma

situação particular.

p

n

f
p fL , f´

s

rp,n

Figura 2.6 – Ilustração dos elementos geométricos utilizados na variante da
média ponderada pela distância.

O fator de ponderação considerando a média ponderada pela distân-

cia é definido para uma situação geral por

?f =
|s|
|r p,n|

(2.11)

Considerando o ângulo ? conforme apresentado na figura 2.7, tem-

se, de acordo com a definição do produto escalar e utilizando as relações

trigonométricas, que

r p,n ·L p,f = |r p,n| |L p,f|cos? (2.12)

cos? =
|s|
|L p,f|

(2.13)

Agrupando as duas equações anteriores determina-se o módulo do

vetor s através de

|s|=
r p,n ·L p,f
|r p,n|

(2.14)



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 25

Finalmente, substituindo a última equação na equação (2.11) encontra-

se a expressão final para o fator de ponderação

?f =
r p,n · L p,f
|r p,n|2

(2.15)

Quanto mais distante o centroide de n estiver de f, maior será o vetor

r p,n e menor será o fator de ponderação. Sendo assim, menor também
será a influência do valor de pressão no volume n com relação ao valor de

pressão no centroide f da face.

p

n

s

q

rp,n

p fL ,

Figura 2.7 – Representação do ângulo ? .

Na situação particular em que os vetores r p,n e L p,f são colineares,
o fator peso, conforme apresentado na equação (2.16), torna a equação

(2.9) uma aproximação de segunda ordem já que uma interpolação linear

estaria sendo considerada [27].

?f =
|L p,f|
|r p,n|

(2.16)

Através das variantes média aritmética e média ponderada pela dis-

tância é possível determinar os valores de pressão em todas as faces inter-

nas dos volumes de controle de uma malha. Uma atenção especial para o

tratamento das faces de fronteira é dada a seguir.

Estando disponíveis os valores de pressão nos centroides de todas

as faces de uma malha arbitrária, a aproximação do gradiente segundo a

equação (2.8) é então realizada considerando-se dois procedimentos: com

um passo e com dois passos.



26 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

2.2.1.3 Procedimento com um passo

O primeiro procedimento é o mais simples. Os valores de pressão

nos centroides das faces são substituídos diretamente na equação (2.8)

obtendo-se o valor do gradiente para cada volume de controle da malha.

2.2.1.4 Procedimento com dois passos

O segundo procedimento, apresentado em [30], é uma extensão do
anterior visando melhorar a precisão dos gradientes de pressão através de

uma correção dos valores nas faces internas.

Com os valores aproximados do gradiente de pressão obtidos utili-

zando-se a equação (2.8), um novo valor de pressão no centroide f da face

pode ser determinado considerando-se uma expansão em série de Taylor

truncada, ao redor do centroide do volume de controle p

Pf,p = Pp +(?P)p ·L p,f (2.17)

Um segundo valor de pressão pode também ser obtido considerando

o volume adjacente n

Pf,n = Pn +(?P)n ·L n,f (2.18)

sendo o vetor L n,f aquele que une o centroide do volume de controle n ao
centroide da face em questão.

Tendo-se dois valores possíveis de pressão para cada face interna,

uma média aritmética é realizada a fim de se obter o valor corrigido de

pressão nesse local

Pf =
Pf,p +Pf,n

2
(2.19)

Calculados assim os valores corrigidos de pressão em todas as faces

internas dos volumes de controle, aplica-se novamente a equação (2.8)

para assim obter novos valores do gradiente de pressão. Vale destacar

que os valores de pressão nos centroides das faces de fronteira não são

corrigidos.

Deve ficar claro que o valor aproximado do gradiente de pressão em-

pregando a abordagem cell-based pode ser obtido considerando-se uma

combinação entre as duas variantes (média aritmética e média ponde-



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 27

rada pela distância) com os dois procedimentos (um passo e dois passos).

Sendo assim, é possível reconstruir os gradientes de quatro maneiras dis-

tintas.

2.2.1.5 Faces de fronteira

Com as variantes média aritmética e média ponderada pela distância

é possível determinar os valores de pressão nos centroides das faces inter-

nas da malha. Vale ser ressaltado que tais valores são obtidos considerando-

se os valores associados aos centroides dos volumes de controle que pos-

suem as referidas faces em comum.

Analisando a figura 2.8 percebe-se que as faces de fronteira não apre-

sentam a configuração descrita no parágrafo anterior, ou seja, tais faces

não são adjacentes a dois volumes de controle. Logo, uma outra maneira

de se obter os valores de pressão nos centroides destas deve ser adotada.

Já que os métodos de reconstrução serão utilizados na discretização

de equações diferenciais com condições de contorno definidas nas fron-

teiras, pensou-se em utilizar essas condições para especificar os valores de

pressão nas faces de fronteira [27].
Nos problemas analisados neste trabalho serão consideradas condi-

ções de Dirichlet, ou seja, a variação da pressão nas fronteiras será conhe-

cida. Logo, os valores de pressão nos centroides das faces de fronteira serão

determinados a partir das condições prescritas nas fronteiras do domínio.

p

f

Face de fronteira
Fronteira

Figura 2.8 – Volume de controle e faces de fronteira.



28 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

2.2.2 Abordagem vertex-based

O princípio desta abordagem é determinar os valores de pressão nos

centroides das faces utilizando os valores aproximados nos vértices destas.

Na abordagem vertex-based, os valores da variável nos vértices in-

ternos da malha 3 são aproximados por interpolação dos valores corres-

pondentes aos volumes de controle que circundam a cada vértice. Isto é

ilustrado esquematicamente na figura 2.9.

1p
2p

v

3p

Figura 2.9 – Volumes de controle que cooperam para a determinação do
valor da pressão no vértice.

A aproximação empregada em [23]para se determinar o valor de pres-
são em um dado vértice interno da malha é aqui utilizada

Pv =

Nv
?

k=1

w k Ppk

Nv
?

k=1

w k

(2.20)

onde k = 1, 2, ..., Nv com Nv sendo o número de volumes de controle que
cercam o vértice. Nas malhas analisadas neste trabalho normalmente os

3 Vértices que não estão localizados na fronteira do domínio de solução.



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 29

vértices internos são cercados por três volumes de controle, mas esse nú-

mero de volumes poderia ser maior. O entêncil 4 para se aproximar o gradi-

ente de pressão em um volume de controle p, segundo a abordagem vertex-

based, é mostrado na figura 2.10.

3n 2n

n

5n
6n

p
1n4

6v

4v

5v

3v

2v

1v

Figura 2.10 – Volumes de controle que contribuem para a determinação do
gradiente de pressão associado ao volume de controle p.

A cada valor de pressão envolvido na equação (2.20) associa-se um

fator de ponderação w k . Na literatura encontram-se duas formas princi-

pais para determinar valores para os fatores de ponderação na abordagem

vertex-based: o procedimento da ponderação pelo inverso da distância e o

procedimento do pseudolaplaciano [19]. Segundo [19, 22] o procedimento
do pseudolaplaciano garante precisão de segunda ordem na aproximação

dos valores nos vértices, enquanto que com a ponderação pelo inverso da

distância a precisão é menor que segunda ordem.

2.2.2.1 Ponderação pelo inverso da distância

Neste procedimento o fator de ponderação é considerado igual ao

inverso da distância entre um vértice e o centroide do volume de controle

4 Conjunto de vizinhos ao volume de controle em questão que contribuem para o cálculo
do gradiente de pressão.



30 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

circundante. Considerando a figura 2.11, o valor deste fator é dado por [23]

w k =
1

|r pk ,v|
(2.21)

Assim, com o intuito de se obter Pv, a contribuição do valor de pressão

de um dado volume de controle é tanto maior quanto menor for a distância

entre seu centroide e o vértice em questão.

3p1
p

rp ,v
1 v

2p

Figura 2.11 – Demonstração do vetor r p1 ,v .

2.2.2.2 Procedimento do pseudolaplaciano

Este procedimento, proposto inicialmente em [16], apresenta uma
forma mais elaborada de se obter os fatores de ponderação w k . O intuito é

determinar os valores para esses fatores que quando aplicados na equação

(2.20) garantam precisão de segunda ordem na aproximação dos valores da

variável nos vértices. Para tanto, deve ser satisfeita a denominada condição

de pseudolaplaciano nulo, dada por

Nv
?

k=1

w k(r pk ?r v)= 0 (2.22)

Esta condição é deduzida na seção A.1 do apêndice A. O vetor r pk é o
vetor posição do centroide de um volume de controle circundante ao vér-



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 31

tice em questão e r v o vetor posição desse vértice. O somatório é realizado
considerando-se todos os volumes de controle que cercam o dado vértice.

As coordenadas cartesianas do vetor r v podem ser representadas por
x v e y v e aquelas referentes ao vetor posição r pk por x pk e y pk . Com isso,
através da equação (2.22) obtém-se duas condições de pseudolaplaciano

nulo na forma escalar
Nv
?

k=1

w k(x pk ?x v)= 0 (2.23)

Nv
?

k=1

w k(y pk ?y v)= 0 (2.24)

De acordo com procedimento apresentado, o fator de ponderação

pode ser definido considerando-se um desvio ?w k em relação à unidade

w k = 1+?w k (2.25)

Observando as equações (2.23) e (2.24) e sabendo que os vértices das

malhas analisadas neste trabalho possuem normalmente três volumes de

controle os cercando, ter-se-á um sistema linear de duas equações, as duas

condições de pseudolaplaciano nulo na forma escalar, com três incógnitas,

os fatores de ponderação.

A fim de tornar possível a obtenção de valores dos fatores de ponde-

ração satisfazendo a condição de pseudolaplaciano nulo, o seguinte pro-

blema de minimização auxiliar é proposto

min
Nv
?

k=1

(?w k)
2 (2.26)

sujeito às restrições dadas pelas equações (2.23) e (2.24). Como mostrado

na seção A.2 do apêndice A, a solução deste problema fornece a seguinte

expressão para o cálculo dos fatores de ponderação

w k = 1+
I x y Ry ? I y y Rx
I x x I y y ? I x y 2

(?x pk )+
I x y Rx ? I x x Ry
I x x I y y ? I x y 2

(?y pk ) (2.27)

onde



32 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

?x pk =x pk ?x v

?y pk = y pk ?y v

I x x =
Nv
?

k=1

?x 2pk

I y y =
Nv
?

k=1

?y 2pk

(2.28)

I x y =
Nv
?

k=1

?x pk ?y pk

Rx =
Nv
?

k=1

?x pk

Ry =
Nv
?

k=1

?y pk

Percebe-se que os valores dos fatores de ponderação dependem so-

mente de parâmetros geométricos da malha, sendo necessário apenas dis-

por das coordenadas cartesianas dos vértices e dos centroides dos volumes

de controle circundantes.

Um fato interessante pode ser ressaltado ao se isolar as coordenadas

cartesianas do vetor r v das equações (2.23) e (2.24)

x v =

Nv
?

k=1

w k x pk

Nv
?

k=1

w k

(2.29)

y v =

Nv
?

k=1

w k y pk

Nv
?

n=1

w k

(2.30)

Verifica-se uma grande similaridade entre as equações anteriores e



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 33

(2.20). Os valores das coordenadas dos vértices da malha dependem dos

valores das coordenadas dos volumes de controle circundantes assim como

o valor da pressão nos vértices dependem dos valores de pressão nos volu-

mes de controle ao seu redor.

Observação

De acordo com a disposição dos vértices em relação aos centroides

dos volumes de controle circundantes notou-se através de testes realiza-

dos que os fatores de ponderação poderiam se tornar negativos. Este fato

ocorre quando uma situação conforme apresentada na figura 2.12 é evi-

denciada.

v

Fronteira

1p 2p

3p

Figura 2.12 – Vértice deslocado do triângulo que se forma conectando os
centroides dos volumes p1 ,p2 e p3 .

Apesar desta anomalia, constatou-se nos testes que a determinação

da pressão nos vértices utilizando o procedimento de pseudolaplaciano

não foi afetada. O número de casos com esta particularidade é muito

pequeno, visto que os vértices com essa configuração são apenas alguns

daqueles localizados em volumes de controle adjacentes às fronteiras do

domínio.

Problemas com os fatores de ponderação apresentando valores nega-

tivos e com alta magnitude são relatados em [16] para malhas triangulares
extremamente distorcidas. A fim de superar tal problema, na publicação

citada sugere-se limitar os valores dos fatores de ponderação à faixa entre

0 e 2. Sendo assim, a fatores com valor calculado maior a 2 deveria-se

atribuir o valor 2 e a fatores com valor negativo deveria-se atribuir o valor



34 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

0. Porém, a referência [19] afirma que esse procedimento de ajuste faz com
que a precisão do procedimento deixe de ser de segunda ordem. Por este

motivo, neste trabalho nenhuma restrição com relação a tais valores foi

considerada, sendo constatado que valores de pressão nos vértices apre-

sentando tal particularidade não foram influenciados por tal atitude.

2.2.2.3 Vértices de fronteira

A determinação dos valores de pressão nos vértices, através da equa-

ção (2.20) em conjunto com algum dos dois procedimentos apresentados,

é válida somente para os vértices internos da malha, conforme destacado

anteriormente. Um procedimento diferenciado deve ser considerado para

os vértices localizados sobre as fronteiras do domínio. Da mesma forma

que na abordagem cell-based, optou-se por associar os valores nesses vér-

tices com as condições de contorno estipuladas para o problema físico

sendo resolvido.

Considerando a figura 2.13, a pressão no vértice de fronteira v será

dada por

Pv = w 1Pf1 +(1?w 1)Pf2 (2.31)

sendo Pf1 e Pf2 os valores de pressão nas faces adjacentes ao vértice, pro-

venientes da condição de contorno do problema. Além disso, o respectivo

fator de ponderação é dado por

w 1 =
|r v,f2|
|r f1 ,f2|

(2.32)

2.2.2.4 Obtenção dos valores de pressão nas faces

De posse dos valores de pressão nos vértices internos e de fronteira

da malha e sabendo que no caso bidimensional cada face é composta por

duas destas entidades (v1 e v2), os valores nos centroides das faces internas

são determinados através de uma média aritmética simples. Esse procedi-

mento se justifica plenamente em duas dimensões, pois esses centroides

encontram-se exatamente no ponto médio entre os vértices envolvidos

Pf =
Pv1 +Pv2

2
(2.33)



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 35

1f

2f

v

2p

1p

v,r f 21 2f  ,fr

Figura 2.13 – Entidades envolvidas na determinação do valor de pressão
em um vértice de fronteira.

Vale destacar que os valores de pressão nas faces de fronteira não são

determinados com a equação anterior pois, nesse caso, se utilizam dos

valores de pressão prescritos como condição de contorno.

Com todos os valores de pressão nos centroides das faces em mãos,

parte-se para a aplicação da equação (2.8) para se obter finalmente os

valores aproximados do gradiente de pressão em cada volume de controle

da malha.

2.2.3 Comparação entre as abordagens cell-based e vertex-
based

O número de variáveis envolvidas no cálculo da pressão no centroide

de cada face interna da malha é maior na abordagem vertex-based com

relação à abordagem cell-based. Através da figura 2.14 procura-se mostrar

o exposto analisando-se apenas um centroide f. À esquerda, o valor de

pressão na referida posição é obtido empregando-se cell-based e à direita

vertex-based. Ao se utilizar a primeira abordagem apenas os valores de

dois volumes de controle (p e n) contribuem para a determinação de Pf,

já para a abordagem vertex-based são necessários quatro destas entidades

(p1,p2,p3 e p4).

A abordagem vertex-based é mais elaborada que a cell-based pois nesta

os valores conhecidos nos centroides dos volumes de controle são dire-



36 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

p

f

n

f

1p

3p

2p

v

v2

1

4p

Figura 2.14 – Volumes de controle envolvidos na aproximação da pressão
na face f . À esquerda cell-based e à direita vertex-based.

tamente empregados para se determinar as pressões em f, já naquela os

valores de pressão conhecidos são utilizados para se obter os valores nos

vértices para somente assim se determinar os valores nos centroides das

faces.

Conforme [3] a abordagem vertex-based é mais precisa que a aborda-
gem cell-based para malhas não-estruturadas, porém, demanda um maior

custo computacional, por envolver um nível de cálculo adicional. Já a

abordagem cell-based possui como principal vantagem a facilidade de im-

plementação.

Apresentadas as duas abordagens comentadas, encerram-se assim

as metodologias baseadas na fórmula de Green-Gauss empregadas neste

trabalho.

2.3 Mínimos quadrados

Com este método assume-se que a pressão apresenta variação linear

na vizinhança de um volume de controle. Partindo da expansão em série

de Taylor na região adjacente ao centroide de um volume de controle,

P = Pp +(?P)p ·(r?r p)+O (|r?r p|2) (2.34)

pode-se desconsiderar os termos de ordem maior que um, restando a ex-

pressão linear antes mencionada. Considere-se agora que tal variação se



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 37

dá entre o volume de controle p e um vizinho nk , como representado na

figura 2.15. A pressão no centroide de tal volume vizinho pode ser escrita

por

Pnk ? Pp +(?P)p ·r p,nk (2.35)

sendo r p,nk o vetor que conecta o centroide do volume p com o volume
vizinho nk . A expressão é valida para k = 1, 2, ..., Nvc, onde Nvc é o número
de volumes vizinhos do volume p. O erro desta aproximação é de segunda

ordem, já que os termos dessa ordem e ordens mais altas foram desconsi-

derados.

3n 2n

n

5n
6n

p
p,r n1

1n4

Figura 2.15 – Volume de controle p e seus vizinhos.

A equação (2.35) pode ser escrita em uma forma alternativa, conside-

rando a comutatividade do produto escalar,

r p,nk ·(?P)p =
?

?x k i+?yk j
?

·
?

?P

?x

?

?

?

p
i+
?P

?y

?

?

?

p
j

?

? Pnk ?Pp (2.36)

sendo ?x k e ?yk as componentes cartesianas do vetor r p,nk .
Particularizando a equação (2.36) para todos os volumes vizinhos a

p, obtém-se um sistema linear de equações, que pode ser escrito na forma

matricial [20]



38 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

?

?

?

?

?

?

?

?

?x 1 ?y1
?x 2 ?y2

...
...

?x m ?ym

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?P

?x

?

?

?

p

?P

?y

?

?

?

p

?

?

?

?

?

?

?

=

?

?

?

?

?

?

?

?

Pn1 ?Pp
Pn2 ?Pp

...

Pnm ?Pp

?

?

?

?

?

?

?

?

(2.37)

na qual se considerou m = Nvc para tornar a representação matricial mais
clara. Portanto, obteve-se um sistema linear de m equações com apenas

duas incógnitas, que são as componentes cartesianas do gradiente de pres-

são. Analisando o sistema linear anterior, percebe-se que os coeficientes

da primeira matriz dependem apenas de parâmetros geométricos conhe-

cidos, enquanto que os termos independentes são diferenças de valores de

pressão entre volumes vizinhos, os quais também consideram-se conheci-

dos em um método de reconstrução do gradiente.

Com o intuito de nas equações anteriores dar maior importância aos

volumes de controle cujos centroides estejam mais próximos de p, uma

ponderação pela distância é algumas vezes considerada. Uma matriz

Wm×m , diagonal cujos componentes são fatores de ponderação ?k , foi
introduzida no sistema linear anterior da mesma forma encontrada em

[20]. Obtém-se assim o sistema linear modificado

?

?

?

?

?

?

?

?

?1?x 1 ?1?y1
?2?x 2 ?2?y2

...
...

?m?x m ?m?ym

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?P

?x

?

?

?

P

?P

?y

?

?

?

P

?

?

?

?

?

?

?

=

?

?

?

?

?

?

?

?

?1(Pn1 ?Pp)
?2(Pn2 ?Pp)

...

?m(Pnm ?Pp)

?

?

?

?

?

?

?

?

(2.38)

Os fatores de ponderação são fatores geométricos que levam em con-

sideração a distância entre os volumes de controle adjacentes da seguinte

forma

?k =
1

|r p,nk|c
(2.39)

Assim como em [19], o expoente c assume neste trabalho os valores
0, 1 e 2. É claro que ao considerar a primeira opção nenhuma ponderação

é realizada, retornando-se para o caso original. O fato é que três possibili-

dades para o método surgem e são assim denominadas:



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 39

• Mínimos quadrados sem ponderação: c = 0;
• Mínimos quadrados com ponderação pelo inverso da distância:

c = 1;

• Mínimos quadrados com ponderação pelo quadrado do inverso da
distância: c = 2.

Para facilitar a análise posterior, o sistema linear apresentado na equa-

ção (2.38) pode ser representado de uma maneira simplificada por

Am×n xn×1 = bm×1 (2.40)

sendo n a dimensão física do problema considerado, m o número de vi-

zinhos de p, A a matriz dos coeficientes e b o vetor independente. Como
um caso bidimensional é analisado, n assume o valor 2, portanto, normal-

mente o sistema linear da equação (2.40) será sobredeterminado, já que

ter-se-á m &gt; n .

Sistemas sobredeterminados como os representados na equação (2.40)

surgem na prática e de alguma forma precisam ser resolvidos. Uma ma-

neira é utilizar o método dos mínimos quadrados, cujo princípio é deter-

minar x de modo que se minimize o erro nas equações do sistema. Este
erro é definido como sendo a norma 2 do resíduo, conforme mostrado a

seguir

min?Ax?b?2 (2.41)

O erro ?Ax ? b?2 pode ser interpretado como a distância entre b e o
ponto Ax localizado no espaço-coluna da matriz A 5 [36]. Portanto, mi-
nimizando ?Ax ? b?2 está se determinando o ponto Ax mais próximo a b
que qualquer outro ponto no espaço-coluna. A solução do problema de

mínimos quadrados para esse ponto será denominada x.

x = argmin?Ax?b?2 (2.42)

Na literatura existem inúmeros métodos para determinar uma so-

lução para um problema de mínimos quadrados. Os dois métodos mais

usuais são o método das equações normais e o da fatoração QR. Segundo

[13] o primeiro é mais rápido porém menos preciso, sendo adequado para

5 O espaço-coluna da matrizAé um subespaço vetorial que tem como base as colunas de
A.



40 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

problemas com baixo número de condição 6 e o segundo pode ser empre-

gado em problemas mal condicionados, porém, seu custo computacional

é aproximadamente duas vezes maior que o primeiro. As duas opções são

discutidas com mais detalhes a seguir.

2.3.1 Equações normais

A figura 2.16 é mostrada para auxiliar a descrição do método. Ela ilus-

tra um caso onde b não pertence ao espaço-coluna deApodendo-se então
aplicar o método dos mínimos quadrados para obter a solução requerida.

O sistemaA3×2 x2×1 = b3×1 representado tem os seguintes componentes
?

?

?

?

?

a 11 a 12

a 21 a 22

a 31 a 32

?

?

?

?

?

 

x 1

x 2

!

=

?

?

?

?

?

b 1

b 2

b 3

?

?

?

?

?

(2.43)

Esp
aço

 co
lun

a

a

a

a

11

21

31

æ ö
ç ÷
ç ÷
ç ÷
è ø

a

a

a

12

22

32

æ ö
ç ÷
ç ÷
ç ÷
è ø

xA

1

2

3

b

b b

b

æ ö
ç ÷

= ç ÷
ç ÷
è ø

bx-A

Figura 2.16 – Ilustração de um sistema linear onde b não pertence ao
espaço coluna deA. Reproduzida de [36].

Na referida figura o vetor representado com uma linha tracejada é o

resíduo correspondente, o qual é perpendicular ao espaço-coluna. Esta

6 O número de condicionamento de uma matriz indica o quão sensível ela é a alterações
nos valores de seus elementos, causadas por exemplo por erros de arredondamento. Tal
número é definido por c(A)=?A?2?A?1?2 .



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 41

condição de ortogonalidade é necessária para minimizar a norma 2 desse

resíduo, tornando assim a solução encontrada a melhor possível.

Como o vetor resíduo é perpendicular ao espaço-coluna, ele será por

consequência perpendicular a todos os vetores coluna da matrizA. Sendo
cada um destes vetores representados por an , com n variando de 1 ao
número de colunas da matriz, para que a condição de ortogonalidade seja

satisfeita é necessário que

aTn ·(Ax?b)= 0 (2.44)

Reunindo as expressões correspondentes a todas as colunas da matriz

A, obtém-se a seguinte expressão

AT(Ax?b)= 0 (2.45)

com AT sendo a transposta da matriz dos coeficientes. Manipulando-se
algebricamente a equação anterior, chega-se a

ATAx =ATb (2.46)

onde a matriz ATA é uma matriz quadrada (ordem 2 para o caso bidi-
mensional considerado), simétrica e inversível [36]. O conjunto de equa-
ções representado pelo sistema da equação (2.46) é conhecido na literatura

como as "equações normais" [36] e também pode ser escrito para o caso
considerado neste trabalho na forma expandida

?

?

?

?

?

?

m
?

k=1

?k
2?x k

2
m
?

k=1

?k
2?x k?yk

m
?

k=1

?k
2?x k?yk

m
?

k=1

?k
2?yk

2

?

?

?

?

?

?

?

?

?

?

?

?

?

?P

?x

?

?

?

p

?P

?y

?

?

?

p

?

?

?

?

?

?

?

=

(2.47)
?

?

?

?

?

?

m
?

k=1

?k
2?x k(Pnk ?Pp)

m
?

k=1

?k
2?yk(Pnk ?Pp)

?

?

?

?

?

?

A solução do problema de mínimos quadrados torna-se simples, já

queATAé uma matriz inversível. Como o intuito é determinar o gradiente



42 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

de pressão encontrado no vetor x, basta inverter tal matriz obtendo-se

x =(ATA)?1ATb (2.48)

onde (ATA)?1 é a matriz inversa de (ATA). Vale a pena destacar que a
solução deve ser obtida para cada volume de controle da malha.

2.3.2 Fatoração QR

A fatoração QR da matriz Am×n é dada pelo produto de uma matriz
Qm×m ortogonal 7 e uma matriz triangular superiorRm×n . Ou seja,

A=QR (2.49)

A matriz ortogonal Q pode ser obtida através de um método de orto-
gonalização, cujo princípio é transformar os vetores coluna da matrizAem
vetores coluna ortonormais. Dois métodos de ortogonalização conhecidos

são o de Gram-Schmidt e o de Householder, encontrados em [13, 15, 36].
O primeiro é aplicável a situações onde a matriz A é composta por

vetores coluna linearmente independentes 8. A ideia do método é eliminar,

através de projeções, as componentes de cada vetor coluna nas direções já

fixadas por outros vetores coluna.

O método de Householder é mais robusto numericamente, podendo

ser aplicado em casos em que os vetores colunas sejam quase linearmente

dependentes. O princípio do método é refletir os vetores coluna da matriz

A de tal modo que estes possam ser escritos considerando apenas uma de
suas direções.

A matriz triangular superiorRapresenta elementos nulos que podem
ser desconsiderados. Nesse caso, a fatoração QR pode ser escrita na forma

reduzida

A=QR=
?

Q1 Q2
?

 

R1
0

!

(2.50)

7 Matriz ortogonal é aquela formada por vetores coluna ortonormais (ortogonais entre sim
e com módulo unitário). Devido a isso, para tal matriz a sua inversa é igual a sua transposta,
Q?1 =QT. Assim,QTQ=I.

8 Um conjunto de vetores coluna é dito linearmente independente quando a sua combi-
nação linear fornece para os coeficientes somente a solução trivial. Exemplo: a combinação
c 1 a+c 2 b+c 3 c = 0 fornecendo c 1 = c 2 = c 3 = 0.



CA PÍT ULO 2 – M ÉTO DOS DE R ECO NS T RUÇÃO EX PLÍ CITA DO GR A DIENT E 43

Percebe-se que a matriz original Q é decomposta em duas outras, Q1
e Q2. Limitando o número de colunas de Q de acordo com o número de
colunas deA, obtém-se a matrizQ1, cuja dimensão é m x n .

O mesmo ocorre com a matriz R. Limitando o seu número de linhas
de acordo com o número de colunas da matrizA, obtém-seR1 cuja dimen-
são é n x n . Ao efetuar tal procedimento, consegue-se trabalhar somente

com a porção deRque apresenta elementos não-nulos.
Realizando o produto das matrizes na equação (2.50), por blocos,

substituindo depois tal resultado na equação (2.40) e sabendo que a matriz

Q1 é uma matriz ortogonal, obtém-se a seguinte expressão

R1x =QT1 b (2.51)

Invertendo-se a matriz triangular superior R1 obtém-se a solução re-
querida

x =R?11 Q
T
1 b (2.52)

A fatoração QR é o método utilizado neste trabalho já que ele é mais

robusto por ser o número de condicionamento da mesma ordem de gran-

deza daquele da matriz original. Já quando as equações normais são apli-

cadas, o número de condicionamento da matriz (ATA) é o quadrado do da
matriz A [36], tornando o método muito mais sensível a erros aritméticos
no cálculo dos coeficientes da matriz.

A biblioteca de álgebra linear chamada de JAMA [35], desenvolvida na
linguagem C ++ foi utilizada neste trabalho para a obtenção das matrizes

no método de fatoração QR. Optou-se pela utilização de tal biblioteca já

que os algoritmos disponíveis são otimizados e amplamente validados. O

método de ortogonalização utilizado em tal biblioteca é o de Householder.

2.3.3 Comentários

Uma observação importante na aplicação dos mínimos quadrados é

que para realizar a reconstrução do gradiente não se necessita dos valores

de pressão nas fronteiras do domínio conforme ocorre nos métodos que

utilizam a fórmula de Green-Gauss. Analisando a equação (2.8) referente a

tal fórmula, verifica-se que o gradiente é calculado através de um somató-

rio considerando todas as faces do volume de controle p, não importando

se essas são internas ou de fronteira. Por outro lado observando a equação



44 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

(2.37) referente aos mínimos quadrados, percebe-se que o gradiente é de-

terminado considerando informações dos vizinhos do volume de controle

analisado, logo, como um volume de controle localizado na fronteira não

é totalmente cercado por vizinhos, as parcelas referentes aos valores de

pressão na fronteira não são levadas em conta. Outro ponto relevante a

respeito dos mínimos quadrados é que o método não depende da geo-

metria dos volumes de controle da malha, e sim apenas das posições dos

centroides destas entidades geométricas.



CAPÍTULO

3
A N Á L I S E CO M PA R AT I VA D O S

M É TO D O S D E R E CO N S T RU Ç ÃO

3.1 Introdução

De posse dos métodos de reconstrução explícita do gradiente apre-

sentados no capítulo anterior, procura-se neste capítulo determinar quais

destes métodos apresentam o melhor comportamento com relação à pre-

cisão na aproximação do gradiente bem como com relação ao tempo com-

putacional associado.

A determinação dos métodos que melhor se enquadram segundo a

precisão é realizada em malhas poligonais ditas regulares, formadas prin-

cipalmente por hexágonos do mesmo tamanho e forma, e também em

malhas poligonais com algum tipo de distorção geométrica. Já o tempo

computacional é analisado somente nas malhas regulares.

A estratégia considerada nos testes apresentados neste capítulo é a

de aplicar os diferentes métodos de reconstrução do gradiente a valores

discretos de pressão obtidos a partir de expressões analíticas. Diferenci-

ando essas expressões podem ser obtidos os valores exatos dos gradientes

associados aos volumes de controle. De posse desses valores exatos, pode-

se então mensurar o erro associado a cada método de reconstrução e ana-

lisar seu comportamento ao se refinar progressivamente as malhas. Dessa

forma pode-se estimar a ordem de convergência associada a cada método,

sendo que métodos mais precisos apresentarão ordens de convergência

45



46 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

maiores. Para tanto, são consideradas geometrias simples e malhas de

estrutura topológica fixa com o intuito de manter sob controle a forma com

que o refino destas é realizado.

Os principais objetivos deste capítulo são analisar a influência de di-

ferentes funções, que fornecem os campos de pressão no domínio, e a in-

fluência da geometria de diferentes malhas poligonais no comportamento

do erro do gradiente ao se empregar os métodos de reconstrução apresen-

tados no capítulo 2. A análise do tempo de computação associado a esses

métodos também é um dos objetivos.

Tanto a precisão dos resultados numéricos como o tempo computa-

cional são analisados para se determinar qual método apresenta o melhor

custo/benefício, isto é, resultados aceitáveis em tempos de execução ra-
zoáveis. Procura-se determinar se os métodos com melhor precisão con-

somem realmente um tempo muito maior com relação aos demais.

Os resultados descritos neste capítulo foram obtidos com códigos im-

plementados na liguagem C ++.

3.1.1 Funções analisadas

Com o intuito de analisar a precisão da reconstrução do gradiente

com os diferentes métodos descritos, os resultados serão comparados com

valores do gradiente exatos, obtidos por diferenciação de algumas funções

propostas. Os métodos de reconstrução fornecem o valor do gradiente

aproximado associado a cada volume de controle da malha. A fim de poder

realizar a comparação desse valor com o gradiente exato, considerar-se-á

que o valor representativo para um volume de controle é aquele avaliado

no seu centroide. Em todos os casos considerados, o domínio analisado

é um quadrado. Segundo mostra a figura 3.1, a origem do sistema de

coordenadas se encontra no canto inferior esquerdo da malha.

Conforme descrito no capítulo anterior, os dados de entrada para os

métodos de reconstrução do gradiente são o conjunto de valores discretos

de pressão associados a todos os volumes de controle da malha. Nos testes

apresentados neste capítulo, esses valores discretos são obtidos mediante

avaliação das funções analíticas propostas nos centroides dos volumes de

controle.

Foram consideradas quatro tipos de funções, cada uma apresentando

uma característica distintiva. A primeira é uma função linear, para a qual



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 47

(0,0) (1,0)

(1,1)(0,1)

y

x

Domínio W

Figura 3.1 – Origem do sistema de coordenadas nas malhas analisadas.

os métodos que apresentarem precisão de segunda ordem deverão for-

necer valores do gradiente exatos. Outras duas funções consideradas são

não-lineares, sendo que uma delas apresenta oscilações no interior do do-

mínio, enquanto que a outra é quase-monotônica. Finalmente, a última

função apresenta uma descontinuidade da derivada (?P/?x ) na linha mé-

dia do domínio x = 1/2. As expressões matemáticas das funções utilizadas
são apresentadas a seguir.

Função linear

P = 5x ?3y (3.1)

Função oscilatória

P = 5x ?3y + B
?

sen(7x +1)sen(4y +1)
?

(3.2)

Função exponencial

P = 5x ?3y + B
?

exp(?2x +3y )
?

(3.3)



48 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Função descontínua

P =

?

?

?

1

2

?

x ?
1

2

?

[(1+E)seny +(1?E)cos y ]+seny , x ?
1

2

exp
?

x ?
1

2

?

seny , x &gt;
1

2

(3.4)

Os parâmetros B e E envolvidos na definição das funções valem res-

pectivamente 2 e 50. Testes com valores diferentes foram realizados, con-

tudo nenhuma alteração nos resultados foi percebida, concluindo-se que

os parâmetros não influenciam os resultados para um dado tipo de função.

Logicamente que alguns valores dos parâmetros alteram totalmente a fun-

ção, quando B = 0 as funções oscilatória e exponencial tornam-se funções
lineares e quando E = 1 a função descontínua se torna contínua.

As figuras 3.2, 3.3, 3.4, 3.5 mostram a variação da pressão no domínio

considerando cada uma das funções apresentadas. Já as figuras 3.6, 3.7, 3.8

e 3.9 mostram o campo do gradiente de pressão no domínio.

Figura 3.2 – Campo de pressão segundo a função linear.

As funções apresentadas foram utilizadas nas malhas regulares pri-

meiramente para determinar quais métodos de reconstrução do gradiente

apresentavam o melhor comportamento. Definidos esses métodos, so-

mente a função oscilatória foi analisada nas demais malhas. Nos méto-

dos que precisam de valores da pressão nas fronteiras foram considerados

valores obtidos a partir das próprias funções propostas.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 49

Figura 3.3 – Campo de pressão segundo a função oscilatória.

Figura 3.4 – Campo de pressão segundo a função exponencial.

3.1.2 Malhas consideradas

As malhas consideradas neste trabalho são denominadas de regula-

res, não-conformes, com razão de aspecto alta, com distorção aleatória e

com distorção senoidal, cada uma apresentando uma determinada carac-

terística geométrica.

Naquelas denominadas de regulares, ver exemplo na figura 3.10 (a),

considerou-se uma sequência em que a malha mais grosseira apresenta 85



50 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Figura 3.5 – Campo de pressão segundo a função descontínua.

Figura 3.6 – Campo do gradiente de pressão referente à função linear.

volumes de controle e a mais refinada 6930. Essas malhas são constiuí-

das predominantemente por volumes de controle hexagonais com as mes-

mas dimensões. Todas as funções expostas na seção 3.1.1 foram testadas

considerando-se essa sequência.

As malhas não-conformes são aquelas cujos volumes de controle po-

dem possuir vértices que se localizam sobre as faces de volumes de con-

trole adjacentes. A sequência de malhas utilizada é tal que a mais grosseira

apresenta 220 volumes de controle e a mais refinada 56320. Na figura 3.10



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 51

Figura 3.7 – Campo do gradiente de pressão referente à função oscilatória.

Figura 3.8 – Campo do gradiente de pressão da função exponencial.

(b) está ilustrado um exemplo de uma malha não-conforme utilizada neste

trabalho. Nessa figura destacam-se duas regiões distintas: os volumes de

controle de uma delas possuem a metade do tamanho dos volumes de

controle da outra.

As malhas com razão de aspecto alta são malhas cujos volumes de

controle possuem uma dimensão muito maior em uma determinada di-

reção. Neste trabalho tais malhas possuem a dimensão na coordenada



52 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Figura 3.9 – Campo do gradiente de pressão da função descontínua.

vertical muito maior que a dimensão na horizontal, em uma proporção

aproximadamente igual a 10. A sequência de malhas utilizada vai desde

uma malha de 205 até uma de 9331 volumes. Na figura 3.10 (c) é mostrada

a malha com 427 volumes de controle, onde se pode perceber claramente

o alongamento desses volumes na direção vertical.

Nas malhas com distorção aleatória os vértices internos das malhas-

base regulares são deslocados aleatoriamente [29]. Nessas malhas, o má-
ximo deslocamento em cada direção coordenada é 12.5% do comprimento

característico da malha. Esse comprimento será definido na equação (3.10).

Na figura 3.10 (d) encontra-se um exemplo de uma malha com distorção

aleatória apresentando 232 volumes de controle.

Para as malhas com distorção senoidal, a distorção dos volumes de

controle ocorre através dos deslocamentos dos vértices segundo as rela-

ções matemáticas seguintes, encontradas em [18] e [29]

x ?v =x v +?v (3.5)

y ?v = yv +?v (3.6)

?v =C sen(2?x v) sen(2?yv) (3.7)



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 53

(a)

(b)

(d) (e)

(c) 

Figura 3.10 – Malhas:(a)regular, (b)não-conforme, (c)com razão de aspecto
alta, (d)com distorção aleatória, (e)com distorção senoidal.



54 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Nas relações matemáticas das equações (3.5), (3.6) e (3.7), as coorde-

nadas dos vértices nas malhas-base regulares estão representadas por x v
e yv e as novas posições dos vértices nas malhas distorcidas por x ?v e y

?
v . A

amplitude dos deslocamentos dos vértices (C ) controla o nível de distorção

das malhas, sendo o valor 0.08 adotado nos testes a serem apresentados.

Na figura 3.10 (e) encontra-se um exemplo de uma malha com distor-

ção senoidal. Percebem-se regiões onde os volumes de controle estão mais

deformados e que a deformação não é dada somente em uma direção.

Nas tabelas 3.1, 3.2 e 3.3 são mostradas informações sobre as entida-

des geométricas das malhas utilizadas. Todas as sequências de malhas são

apresentadas sendo Nc o número de volumes de controle, Nfi o número

de faces internas, Nff o número de faces de fronteira e Nve o número de

vértices de cada uma das malhas. Já que as malhas com distorção aleatória

e senoidal derivam das malhas-base regulares, na tabela 3.1 são mostradas

as informações referentes a essas três malhas.

Tabela 3.1 – Informações sobre as malhas regulares, com distorção aleató-
ria e com distorção senoidal.

Malha Nc Nfi Nff Nve
1 85 220 36 172

2 232 637 60 466

3 742 2119 108 1486

4 2232 6509 188 4466

5 4128 12128 257 8258

6 6930 20459 332 13862

Tabela 3.2 – Informações sobre as malhas não-conformes.

Malha Nc Nfi Nff Nve
1 220 416 58 255

2 880 1712 116 949

3 3520 6944 232 3657

4 14080 27968 464 14353

5 56320 112256 928 56865



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 55

Tabela 3.3 – Informações sobre as malhas com razão de aspecto alta.

Malha Nc Nfi Nff Nve
1 205 524 92 412

2 427 1146 136 856

3 729 2008 180 1460

4 1573 4452 268 3148

5 3820 11039 422 7642

6 9331 27330 664 18664

3.1.3 Norma do erro analisada
Tendo-se os valores exatos do gradiente, determinados mediante di-

ferenciação das funções analíticas, e valores aproximados, determinados

aplicando os diferentes métodos de reconstrução, pode-se determinar o

erro associado à aproximação e analisar seu comportamento à medida que

as malhas são refinadas. É esperado que o erro decresça com o refina-

mento das malhas, sendo a determinação da ordem de convergência um

dos objetivos deste capítulo, a fim de se avaliar a qualidade dos diferentes

métodos.

O erro na aproximação do gradiente de pressão em cada volume de

controle da malha [24], é dado por

"i =?P numi ??P
a

i (3.8)

onde?P numi é o gradiente numérico e?P
a

i é o valor do gradiente analítico.

Conforme já comentado, o gradiente analítico é determinado consideran-

do-se as coordenadas dos centroides dos volumes de controle da malha.

A fim de quantificar o erro em toda a malha, a forma adimensional da

norma L 2 deste erro para o gradiente de pressão foi utilizada, seguindo-se

a ideia encontrada em [18]

"grad =

?

?

?

?

?

?

?

Nc
?

i=1

|"i |2?Vi

Nc
?

i=1

|?P ai |
2?Vi

?

?

?

?

?

?

?

1/2

(3.9)

sendo que os somatórios abrangem todos os volumes de controle da malha



56 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

e ?Vi representa o volume de cada um deles. O numerador da referida
expressão é a versão discreta da norma

??

?
|?P num ??P a |2 dV

?1/2
, sendo

? o domínio em análise. O denominador é a norma da solução analítica no
domínio [29].

O domínio físico de análise é discretizado considerando uma sequên-

cia de malhas com um refinamento que procura manter a mesma estrutura

destas. A intenção é verificar a redução do valor da norma do erro, definida

na equação (3.9), ao se realizar esse refinamento além de tentar determinar

a ordem de convergência da aproximação do gradiente.

As sequências de malhas utilizadas satisfazem a chamada proprie-

dade do refinamento consistente [38], que requer que o comprimento ca-
racterístico dos volumes de controle destas malhas decresça uniforme-

mente com o acréscimo do número de volumes de controle, Nc . Esta

propriedade permite que se faça a avaliação da ordem de convergência da

norma do erro, porém, deve-se ressaltar que a manutenção da estrutura

topológica da malha considerada neste trabalho é importante, já que o

refinamento deve apresentar regularidade.

O comprimento característico da malha mencionado anteriormente

é determinado pela seguinte expressão

h =

Nc
?

i=1

(?Vi)
1/2

Nc
(3.10)

com o somatório abrangendo todos os volumes de controle da malha. Ad-

mitindo que o comprimento característico de um dado volume de controle

i é dado por (?Vi)
1/2, a expressão anterior define h como a média aritmé-

tica dos comprimentos de todos os volumes da malha.

Se b é a ordem de convergência de um método numérico, é de se

esperar que o erro associado possa ser representado pela expressão [24]

"grad = a h
b (3.11)

sendo a uma constante que independe de h . Uma forma prática de de-

terminar o valor da ordem de convergência de um dado método, utilizada

também neste trabalho, é ajustar o conjunto de valores de erro obtidos em

uma sequência de malhas a uma expressão da forma da equação (3.11).

Para isso, foi utilizado o software Origin [32] com o qual foi possível gerar



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 57

os gráficos que apresentam os ajustes dos valores do erro à expressão co-

mentada e também fazer a análise dos dados.

Nos gráficos apresentados a seguir, cada ponto representa o valor da

norma do erro associado a uma dada malha e método de reconstrução

do gradiente. Para cada sequência de malhas apresentam-se também os

ajustes dos pontos a expressões na forma da equação (3.11). Como se pode

observar nos gráficos com escalas logarítmicas, os ajustes são represen-

tados por linhas retas cuja inclinação está dada pelo valor da ordem de

convergência b . Dessa forma, a ordem de convergência pode ser interpre-

tada como a taxa de caimento da norma do erro à medida que a malha é

refinada.

3.2 Convergência dos métodos

Nesta seção são apresentados os resultados obtidos com os diferen-

tes métodos de reconstrução, funções analíticas e tipos de malha. Tais

resultados estão expostos na forma de gráficos e tabelas, sendo que as

siglas surgentes têm seu significado nas tabelas 3.4 e 3.5. A primeira é

referente aos métodos de reconstrução do gradiente e a segunda às malhas

analisadas.

Nos gráficos de convergência, a norma do erro do gradiente está re-

presentada no eixo vertical e o comprimento característico das malhas no

eixo horizontal. As linhas tracejadas são apenas linhas de referência que

indicam quedas do erro de primeira ordem e segunda ordem, respectiva-

mente.

Os gráficos de convergência são apresentados em três grupos: resul-

tados com métodos utilizando a fórmula de Green-Gauss e abordagem

cell-based, resultados utilizando Green-Gauss e abordagem vertex-based e

resultados utilizando o método de mínimos quadrados. Assim, para cada

tipo de malha e função analisada três gráficos são apresentados.

A convergência pode ser analisada somente a partir de um certo grau

de refinamento da malha. Por exemplo, se a aproximação utilizada for de

segunda ordem, porém, a malha for muito grosseira, componentes do erro

de ordem mais alta podem não ser desprezíveis, prejudicando a estimativa

da ordem real de convergência. Alguns pontos dos gráficos foram des-

considerados por esse motivo, isto é, os valores em algumas das malhas



58 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Tabela 3.4 – Significado das siglas referentes aos métodos de reconstrução
do gradiente.

Sigla Método

GGCBA_1S Green-Gauss cell-based com média aritmética

e um passo

GGCBA_2S Green-Gauss cell-based com média aritmética

e dois passos

GGCBW_1S Green-Gauss cell-based com média ponderada

pela distância e um passo

GGCBW_2S Green-Gauss cell-based com média ponderada

pela distância e dois passos

GGVBID Green-Gauss vertex-based com ponderação pelo

inverso da distância

GGVBPL Green-Gauss vertex-based utilizando pseudolaplaciano

LSID Mínimos quadrados com ponderação pelo

inverso da distância

LSSID Mínimos quadrados com ponderação pelo

quadrado do inverso da distância

LSUN Mínimos quadrados sem ponderação

Tabela 3.5 – Significado das siglas referentes às malhas.

Sigla Malhas

RE regulares

NC não-conformes

RA com razão de aspecto alta

DA com distorção aleatória

DS com distorção senoidal

mais grosseiras alteravam a linha de tendência visível nas malhas mais

refinadas.

A convergência dos métodos é analisada primeiramente com o ob-

jetivo de se captar os efeitos que as diversas funções provocam nos re-

sultados utilizando-se as malhas regulares. Logo após, considerando a

função oscilatória, as malhas serão variadas buscando-se isolar o efeito das



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 59

particularidades geométricas destas sobre os resultados.

3.2.1 Testes com diferentes funções

O objetivo desta subseção é determinar a influência das diferentes

funções, apresentas na seção 3.1.1, nos resultados dos métodos de recons-

trução do gradiente. Deve ficar claro que somente as malhas regulares são

as utilizadas para esse fim.

Uma observação relevante com relação às malhas regulares é que

elas apresentam volumes de controle com formato hexagonal e dimensões

idênticas na região central e apenas alguns volumes de controle deforma-

dos nas regiões próximas às fronteiras. Aqueles localizados próximos às

fronteiras serão aqui denominados de volumes laterais. Os demais serão

denominados de volumes centrais. Na figura 3.11 está representada uma

malha regular onde os volumes de controle com coloração mais escura são

os volumes laterais.

Figura 3.11 – Malha regular mostrando os volumes de controle laterais e
centrais.

3.2.1.1 Testes com a função linear

Nas figuras 3.12 e 3.13 são apresentados os gráficos que mostram o

comportamento dos valores da norma do erro do gradiente ("grad) nas ma-

lhas regulares utilizando-se a função linear. Os gráficos referentes ao mé-



60 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

todo dos mínimos quadrados e ao método utilizando a abordagem vertex-

based com pseudolaplaciano (GGVBPL) não estão apresentados já que com

esses métodos obteve-se gradientes exatos em todas as malhas. Observa-

ções relevantes aos resultados expostos nas referidas figuras são apresen-

tadas através de campos do módulo do erro do gradiente em uma malha

específica, sendo o erro dado pela equação (3.8). As figuras que mostram

esses resultados apresentam na legenda, por simplificação, somente a pa-

lavra erro e não módulo do erro.

Uma observação muito importante deve ser feita antes que os resul-

tados sejam detalhados. Analisando os passos dados para a obtenção da

fórmula de Green-Gauss na seção 2.2, percebe-se que somente a partir

da equação (2.6) as aproximações numéricas são efetivamente realizadas.

Ao se considerar ? (pressão neste trabalho) uma função linear, uma par-

ticularidade é evidenciada ao se empregar a equação (2.6). O gradiente

desta função é uniforme no volume de controle em análise e a aplicação

da regra do ponto médio fornece o resultado exato da integral de superfície
?

?Sf
? dS. A explicação para esta afirmação encontra-se no apêndice B.

Sendo assim, para esse caso a fórmula de Green-Gauss deixa de ser

uma aproximação e o gradiente calculado a partir dela passaria a ser obtido

de forma exata se o valor de pressão no centroide de cada face pudesse ser

obtido de forma exata. Por consequência, o módulo do erro do gradiente

nesse caso deveria ser nulo.

Para o caso dos métodos que utilizam mínimos quadrados, o gradi-

ente calculado deveria também ter um valor exato com as funções lineares,

já que nele se parte do princípio que há uma variação linear de pressão na

vizinhança de um volume de controle.

Cada método de reconstrução é agora analisado individualmente com

o intuito de se discutir os resultados apresentados nos gráficos das figuras

3.12 e 3.13.

Método GGCBA_1S

Conforme descrito na seção 2.2.1, ao se utilizar o método GGCBA_1S

o valor da variável pressão no centroide f da face é calculado como uma

média aritmética dos valores de pressão encontrados nos volumes de con-

trole que cercam esta face. Como as malhas regulares apresentam volumes

de controle distintos nas regiões do domínio, uma análise para cada oca-

sião deve ser realizada.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 61

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? g

rad

h

2
1

1
1

Figura 3.12 – Convergência do gradiente de pressão nas malhas regulares
considerando a função linear. Métodos com abordagem cell-
based.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D

? gr
ad

h

2
1

1
1

Figura 3.13 – Convergência do gradiente de pressão nas malhas regula-
res considerando a função linear. Método com abordagem
vertex-based.

Os volumes centrais possuem o mesmo formato e dimensões, logo

o centroide da face em comum entre eles encontra-se precisamente na

metade da distância entre seus centroides. Basta verificar na figura 3.14

a disposição geométrica destas entidades, sendo 2d a distância entre os

centroides dos volumes de controle e d a distância entre cada centroide e



62 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

o centroide da face.

Assim, como no método se calcula o valor de Pf considerando uma

média aritmética, esse valor é o exato para a posição já que, segundo a

função analisada, a pressão varia linearmente. Logo, sendo os fatores geo-

métricos determinados com uma precisão adequada, deveriam ser obtidos

valores exatos do gradiente utilizando a equação (2.8). Portanto, o erro ao

calcular o gradiente nos volumes centrais deve ser nulo e a região a que

eles pertencem não contribui em nada para os valores da norma do erro

observados na figura 3.12.

p 1n

d
d

dd
1f

2f

3n 2n

Figura 3.14 – Volumes centrais nas malhas regulares.

Já os volumes laterais apresentam-se deformados e assim, o exposto

anteriormente não se aplica. Considerando dois volumes laterais p e n,

conforme a figura 3.15, nota-se claramente que a distância entre o primeiro

e f não é a mesma que entre o segundo e f. Devido a essa característica

geométrica, o método GGCBA_1S é menos preciso ao calcular o gradiente

já que a pressão corresponde a um local diferente do centroide de f. Surge-

se assim um erro ao se empregar o referido método de reconstrução do

gradiente.

A figura 3.16 mostra a distribuição do erro do gradiente na malha

regular mais grosseira. Percebe-se uma faixa diferenciada nos volumes

laterais, exatamente onde os erros se encontram, evidenciando a região as-

sim como se apresenta na figura 3.11. Nos demais volumes de controle, os



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 63

f

p

Dd

n

Figura 3.15 – Volumes laterais nas malhas regulares.

centrais, o campo do módulo do erro é nulo conforme explicação anterior.

Figura 3.16 – Distribuição do erro na malha regular com 85 volumes de
controle utilizando GGCBA_1S.

Os resultados obtidos evidenciam que o método em questão é forte-

mente influenciado pela geometria da malha. Dentre os volumes laterais,

o módulo do erro apresenta-se com um maior valor naqueles com menor

quantidade de faces. Além de possuírem uma menor conectividade que os



64 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

demais, a influência da deformação nestes é ainda mais evidenciada.

Os quatro volumes de controle localizados nos cantos possuem a

mesma geometria e disposição da vizinhança, porém, uma diferença na

magnitude do erro é evidenciada entre eles. Observando aqueles loca-

lizados nos cantos inferior esquerdo e superior direito percebe-se que o

módulo do erro associado é menor que nos outros dois. Aparentemente

isso é devido ao tipo da função considerada, isto é, o ponto onde a pressão

está sendo calculada nos referidos volumes de controle fornece um valor

mais próximo do valor exato no ponto requerido f.

As figuras 3.17 e 3.18 ajudam a ilustrar o exposto anteriormente. Con-

siderando a origem na posição mostrada na figura 3.1, as tabelas 3.6 e 3.7,

referentes às figuras citadas, indicam as coordenadas e valores de pressão

em alguns pontos de interesse, para os volumes de controle dos cantos

inferior e superior esquerdo respectivamente. Nessas tabelas, f1, f2 e f3
são os centroides das faces internas dos volumes considerados, enquanto

que A1, A2 e A3 são os pontos nos quais os valores aproximados por média

aritmética seriam exatos. As faces das fronteiras não estão sendo conside-

radas já que, nestas, a pressão é obtida corretamente através da condição

de contorno de Dirichlet.

f1
f2

f3

A3

A2A1

p 1n

3n 2n

PÑ

Figura 3.17 – Volume do canto inferior esquerdo da malha regular com 85
volumes de controle. Representação dos pontos fornecidos
pelo método GGCBA_1S e do vetor gradiente da função linear.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 65

Tabela 3.6 – Coordenadas e valores de pressão em alguns pontos associa-
dos ao volume de controle no canto inferior esquerdo.

f1 A1 f2 A2 f3 A3
x 1.042 1.930 4.167 5.032 6.250 7.694

y 7.292 7.950 6.250 7.950 2.083 3.320

P -16.666 -14.200 2.085 1.310 25.001 28.510

f1
f2

f3

A3

A2A1

p

1n

3n

2n

PÑ

Figura 3.18 – Volume do canto superior esquerdo da malha regular com 85
volumes de controle. Representação dos pontos fornecidos
pelo método GGCBA_1S e do vetor gradiente da função linear.

Pode-se observar nas figuras 3.17 e 3.18 que a distância entre f1 e A1,

entre f2 e A2 e entre f3 e A3 são as mesmas para ambos os volumes de

controle considerados. Porém, devido à função linear analisada, os valores

de pressão encontrados nos pontos A, associados ao volume de controle

do canto inferior esquerdo, são mais próximos dos valores em cada uma

de suas faces fazendo com que o erro de aproximação tenha uma menor

Tabela 3.7 – Coordenadas e valores de pressão em alguns pontos associa-
dos ao volume de controle no canto superior esquerdo.

f1 A1 f2 A2 f3 A3
x 1.042 1.930 4.167 5.032 6.250 7.694

y 92.708 92.050 93.750 92.050 97.917 96.680

P -272.914 -266.500 -260.415 -250.990 -262.501 -251.570



66 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

magnitude no referido volume de controle. Basta analisar os valores de

pressão indicados nas tabelas 3.6 e 3.7, comparando-se as colunas de f

e A correspondentes para confirmar o anteriormente exposto. A maior

variação de pressão considerando o volume de controle superior esquerdo

é justificada pelo fato de que, nesse caso, as linhas que unem os pontos f e A

estão praticamente alinhadas com o vetor gradiente de pressão, conforme

pode ser verificado na figura 3.18. Diferentemente, no volume inferior

esquerdo tais linhas são praticamente ortogonais a esse vetor gradiente.

Vale a pena ressaltar que os valores encontrados nas tabelas 3.6 e 3.7 estão

em uma ordem 100 vezes maior do considerado no domínio quadrado

unitário.

Apesar do campo exposto na figura 3.16 nos levar a pensar que o

módulo do erro do gradiente no volume de controle do canto inferior es-

querdo é um valor igual ao valor encontrado nos volumes centrais, no

referido volume de controle tal valor é aproximadamente 0.16. Já o valor

do módulo de "i no volume de controle do canto superior esquerdo é

aproximadamente 2.15.

Conclui-se então através do método analisado que os erros associa-

dos estão concentrados nos volumes laterais fazendo com que, ao se re-

finar a malha, a convergência para tal situação não seja nem de primeira

ordem (aproximadamente 0.54). O comportamento do campo do erro do

gradiente em todas as malhas regulares é o mesmo, logicamente que com

o refinamento a faixa de valores não-nulos de "i vai se tornando cada vez

menor, diminuindo-se por consequência o valor da norma do erro associ-

ado.

Método GGCBA_2S

Deve-se lembrar que o método GGCBA_2S é uma extensão do mé-

todo GGCBA_1S já que ele se utiliza dos resultados do gradiente calculados

neste último para corrigir os valores de pressão nas faces.

Nos volumes laterais, o fato dos valores do gradiente possuírem um

erro de aproximação agregado, devido ao emprego de GGCBA_1S, faz com

que os valores corrigidos de pressão nos centroides das faces, apesar de

serem mais próximos dos corretos, não sejam ainda os valores exatos. Con-

sequentemente os novos gradientes de pressão nos referidos volumes de

controle também são valores aproximados. Assim, os erros apesar de me-

nores com relação ao método GGCBA_1S também estão presentes ao se



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 67

empregar GGCBA_2S.

Devido à correção do valor de pressão nos centroides das faces, até

mesmo alguns volumes centrais, aqueles adjacentes aos laterais, são afeta-

dos pelos erros localizados nestes últimos. O que ocorre é que os gradien-

tes de pressão nos referidos volumes centrais passam a apresentar um erro

de aproximação, pois levam em consideração os gradientes incorretos de

seus vizinhos para determinar os valores corrigidos nas faces. Com isso,

os valores de Pf deixam de ser exatos, surgindo o erro de aproximação

comentado ao se aplicar a equação (2.8).

Na figura 3.19 é mostrada a distribuição do erro do gradiente na ma-

lha com 85 volumes de controle, utilizando GGCBA_2S. O erro nos volumes

laterais neste caso se difunde em direção aos volumes centrais afetando

estes que são seus vizinhos. Isto ocorre devido à iteração feita para corrigir

a Pf conforme explicado anteriormente. Na referida figura, devido aos

limites da norma do erro apresentandos, essa difusão do erro não está cla-

ramente evidenciada contudo alterando-se essa faixa de valores o exposto

é facilmente verificado.

Figura 3.19 – Distribuição do erro na malha regular mais grosseira utili-
zando GGCBA_2S.

A fim de facilitar a comparação entre os dois métodos até agora anali-

sados, a figura 3.20 mostra a distribuição do erro do gradiente utilizando-se

GGCBA_2S e considerando a mesma faixa de valores apresentadas na fi-

gura 3.16. É visível a redução global do erro utilizando GGCBA_2S, consta-



68 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

tando-se que a correção do valor de pressão na face é uma possibilidade in-

teressante para melhorar a reconstrução do gradiente. Isso também pode

ser verificado na figura 3.12 onde se percebe que os valores da norma rela-

cionados ao método com dois passos são menores que os valores empre-

gando o método com apenas um passo. O valor da ordem de convergência,

porém, é aproximadamente o mesmo, pois as linhas de convergência são

praticamente paralelas.

Figura 3.20 – Distribuição do erro na malha com 85 volumes utilizando
GGCBA_2S. Mesma faixa de valores empregada na figura 3.16.

Método GGCBW_1S

Como neste método não é considerada apenas uma média aritmética

para determinar os valores de pressão na face, os resultados aqui encon-

trados são mais próximos dos valores exatos. Sendo assim, a magnitude da

norma do erro do gradiente é menor com relação aos métodos anteriores.

Novamente nos volumes centrais da malha o valor do gradiente de

pressão obtido é o exato. Isso porque, devido à configuração geométrica

regular, a interpolação considerada neste método coincide com a média

aritmética, que, como se viu anteriormente, fornece valores exatos de pres-

são nas faces desses volumes de controle. A figura 3.21 mostra os vetores

envolvidos no cálculo do fator de interpolação. Pelo fato de serem colinea-

res e o módulo de um ser a metade do módulo do outro, dão origem a um

fator de interpolação igual a 1/2, como na média aritmética.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 69

Porém, na figura 3.22 percebe-se que para os volumes laterais o vetor

r p,n não atravessa o ponto f. Conforme explicado na seção 2.2.1, para
contornar esta característica geométrica realiza-se a projeção de L p,f sobre
r p,n sendo a pressão então calculada no ponto f´. É devido a esta projeção
que surge o erro na determinação da pressão no centroide da face e, por

consequência, no gradiente do volume de controle envolvido.

s

1n

3n 2n

p
1f

2f
p
f

L
,

r p
,n
2

Figura 3.21 – Volumes centrais nas malhas regulares analisando o método
GGCBW_1S.

O módulo do erro em cada volume de controle é demonstrado na fi-

gura 3.23, para a malha regular com 85 volumes de controle. Nota-se, assim

como no método GGCBA_1S, uma faixa diferenciando os volumes centrais

e laterais, aqui mais ainda evidenciada. A faixa de valores da norma do erro,

menor que nos dois casos até aqui apresentados, evidencia que a aproxi-

mação com a ponderação pela distância é mais precisa entre as analisadas

até aqui.

Método GGCBW_2S

Nesta variante, em que os valores aproximados nas faces são corrigi-

dos em um segundo passo, observa-se uma redução dos valores do erro

em relação ao procedimento com um único passo. De fato, como se pode

evidenciar na figura 3.12, o nível dessa redução é similar ao que tinha

sido observado entre as variantes de um e dois passos utilizando média

aritmética. Apesar de o método GGCBW_2S apresentar o menor nível de



70 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

erro entre os métodos cell-based considerados, as ordens de convergência

de todos eles são praticamente idênticas.

f f’

s

p

n

p fL ,

rp,n

Figura 3.22 – Volumes laterais nas malhas regulares analisando o método
GGCBW_1S.

Figura 3.23 – Distribuição do erro na malha com 85 volumes de controle
utilizando GGCBW_1S.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 71

Método GGVBID

Conforme descrito anteriormente, a principal característica dos mé-

todos com abordagem vertex-based é determinar os valores de pressão nos

centroides das faces utilizando os valores previamente determinados nos

vértices da malha. A obtenção destes se dá combinando os valores de

pressão nos volumes de controle circundantes considerando algum tipo

de ponderação. Para o caso do método GGVBID cada fator de ponderação

é definido como o inverso da distância entre o vértice em questão e o

centroide do volume de controle correspondente.

Devido à uniformidade dos volumes centrais nas malhas regulares, as

pressões obtidas nos vértices na região central são os valores exatos para

estas posições. Como para esses volumes os vértices estão a uma mesma

distância dos centroides dos volumes vizinhos, a média ponderada pela

distância torna-se uma média aritmética, que, pela linearidade da função

considerada, coincide com o valor exato. Sendo assim, os valores depois

calculados nos centroides das faces serão também exatos, de modo que ao

aplicar a equação (2.8) os erros de aproximação do gradiente tornam-se

nulos para os volumes centrais.

Este fato não ocorre nos volumes laterais já que estes não possuem a

uniformidade dos volumes centrais. Portanto, os valores de pressão impre-

cisos nos centroides das faces destes volumes de controle induzem a valo-

res inexatos do gradiente de pressão. É nesta região que se encontram os

erros na aproximação do gradiente, como se pode observar na figura 3.24,

que apresenta a distribuição do erro para a malha regular mais grosseira.

Mesmo com um procedimento mais elaborado para a determinação

de Pf, o erro empregando o método GGVBID é de uma magnitude compa-

rável ao erro encontrado com os métodos GGCBA_1S e GGCBA_2S, como

se pode observar nas figuras 3.12 e 3.13.

Método GGVBPL

A convergência do método GGVBPL não é mostrada na figura 3.13

pois o método fornece valores de gradiente exatos em todo o domínio, no

caso da pressão variar de forma linear. Essa propriedade surge do fato que,

tanto a aproximação dos valores nos vértices, quanto a posterior aproxima-

ção dos valores nas faces, possuem precisão de segunda ordem. Isso quer

dizer que o erro envolvido nessas aproximações, para uma função arbitrá-



72 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Figura 3.24 – Distribuição do erro na malha regular com 85 volumes de
controle utilizando GGVBID.

ria, é proporcional ao quadrado da dimensão característica e às segundas

derivadas da função considerada. Como no caso analisado a função é

linear, as derivadas segundas são todas nulas, resultando que os valores

da pressão nos centroides das faces tornam-se exatos utilizando as formas

de aproximação consideradas. A substituição desses valores na fórmula de

Green-Gauss fornece, portanto, valores exatos também.

Método dos mínimos quadrados

Da mesma forma que o método GGVBPL, o método dos mínimos

quadrados, independentemente do fator peso associado (LSID, LSSID e

LSUN), fornece valores exatos do gradiente para uma variação linear da

pressão no domínio. Por este motivo o gráfico de convergência associado

aos métodos de mínimos quadrados também não é apresentado.

3.2.1.2 Testes com a função oscilatória

Nas figuras 3.25, 3.26 e 3.27 são apresentados os gráficos que mostram

a redução da norma do erro considerando valores de pressão gerados com

a função oscilatória definida na equação (3.2).

Percebe-se que ao se modificar a função analisada os resultados en-

contrados diferem daqueles obtidos com a função linear. Os volumes cen-



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 73

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.25 – Convergência do gradiente de pressão nas malhas regulares
com a função oscilatória. Métodos com abordagem cell-
based.

trais que apresentavam soluções exatas ao se utilizar os métodos com abor-

dagem cell-based, não apresentam mais essa particularidade ao se consi-

derar a função oscilatória. Porém, observando a figura 3.25 percebe-se que,

ao se refinar a malha a norma do erro decresce com maior intensidade.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.26 – Convergência do gradiente de pressão nas malhas regulares
com a função oscilatória. Métodos com abordagem vertex-
based.



74 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.27 – Convergência do gradiente de pressão nas malhas regulares
com a função oscilatória. Métodos utilizando mínimos qua-
drados.

Como a função considerada não é linear, os métodos GGVBPL e todos

os baseados nos mínimos quadrados já não apresentam mais a norma

do erro nula. Através dos gráficos expostos nota-se que os métodos que

se sobressaem com relação à abordagem cell-based são o GGCBW_1S e

GGCBW_2S. Utilizando a abordagem vertex-based fica evidente que o mé-

todo GGVBPL apresenta maior precisão, sendo que a redução do erro está

quase paralela à linha de referência associada a uma convergência de se-

gunda ordem. Por fim, utilizando mínimos quadrados, apesar da simila-

ridade, o LSSID se destaca levemente. A ordem de convergência do gradi-

ente de pressão é maior no método LSSID, valor de 1.73 aproximadamente.

O método GGVBPL apresenta uma ordem de convergência bastante pró-

xima à do método LSSID. Já para os métodos GGCBW_1S e GGCBW_2S a

convergência da norma do erro ocorre a uma taxa próxima a de primeira

ordem.

A distribuição do erro com a função oscilatória é qualitativamente

semelhante à mostrada anteriormente para a função linear, com os erros

maiores concentrados na vizinhança das fronteiras. Porém, como já men-

cionado, na região central os erros não são mais nulos, como acontecia

com a função linear.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 75

3.2.1.3 Testes com a função exponencial

Nas figuras 3.28, 3.29 e 3.30 são mostrados os gráficos obtidos para

a redução da norma do erro considerando a pressão variando segundo a

função exponencial definida na equação (3.3).

A figura 3.28, correspondente aos métodos com abordagem cell-based,

mostra que a convergência para todos eles considerando a função expo-

nencial é menor que de primeira ordem. Um comportamento similar é

apresentado com o método GGVBID, que também mostra uma conver-

gência menor à primeira ordem. Entretanto, o outro método vertex-based

considerado, o GGVBPL, apresenta uma convergência próxima à segunda

ordem, como se pode ver na figura 3.29. Já os métodos de mínimos qua-

drados mostram um comportamento similar entre eles, também com um

inclinação intermediária entre primeira e segunda ordem.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.28 – Convergência do gradiente de pressão nas malhas regulares
com a função exponencial. Métodos com abordagem cell-
based.

Quanto à distribuição do erro do gradiente, mais uma vez a concen-

tração dos maiores valores se dá nos volumes de controle laterais. Den-

tre os volumes centrais, nota-se que os maiores valores estão localizados

próximos ao canto superior esquerdo do domínio, onde se encontram os

maiores valores do gradiente de pressão.



76 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.29 – Convergência do gradiente de pressão nas malhas regulares
com a função exponencial. Métodos com abordagem vertex-
based.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.30 – Convergência do gradiente de pressão nas malhas regulares
com a função exponencial. Métodos utilizando mínimos
quadrados.

3.2.1.4 Testes com a função descontínua

A função definida pela equação (3.4) apresenta uma descontinuidade

na derivada normal à linha média x = 1/2. Essa situação seria típica de um
escoamento em meios porosos em que a permeabilidade fosse descontí-



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 77

nua através dessa linha. O intuito dos testes nesta seção é precisamente ve-

rificar o comportamento dos métodos de reconstrução do gradiente nessa

situação. As figuras 3.31, 3.32 e 3.33 exibem os valores da norma do erro do

gradiente de pressão com o refinamento da malha regular ao se empregar

a função descontínua.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.31 – Convergência do gradiente de pressão nas malhas regulares
com a função descontínua. Métodos com abordagem cell-
based.

Devido à característica da função analisada, a derivada normal à linha

x = 1/2 não está definida. Como alguns volumes de controle das malhas
regulares apresentam seu centroide exatamente em x = 1/2, para obter o
valor do gradiente analítico nesta posição determinou-se a derivada par-

cial da pressão com relação ao eixo x através de uma média aritmética das

derivadas parciais com relação a este eixo, considerando todo o domínio

apresentado na equação (3.4).

Com a função descontínua os valores da norma do erro são os maio-

res encontrados até agora, considerando os métodos de reconstrução des-

tacados nas funções anteriores, GGCBW_1S, GGCBW_2S, GGVBPL e aque-

les que utilizam mínimos quadrados. Analisando os gráficos expostos,

pode-se verificar que com nenhum dos métodos obteve-se valores da

norma do erro menores que 10?2 e que os valores da ordem de conver-

gência são próximos em todos esses métodos, entre 0.60 e 0.71. Com isso

conclui-se que nenhum dos métodos se sobressai e que estes apresentam

dificuldades ao se tratar uma possível descontinuidade no domínio.



78 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L

? gr
ad

h

2
1

1
1

Figura 3.32 – Convergência do gradiente de pressão nas malhas regulares
com a função descontínua. Métodos com abordagem vertex-
based.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.33 – Convergência do gradiente de pressão nas malhas regulares
com a função descontínua. Métodos utilizando mínimos
quadrados.

Analisando a distribuição do erro do gradiente de pressão na figura

3.34 verifica-se que elevados valores deste erro localizam-se nos volumes

cujos centroides se encontram na linha média x = 1/2 ou que possuem
uma face sobre esta. Os maiores valores do erro encontram-se nos volumes

dispostos onde a descontinuidade é mais evidente sendo que, naqueles



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 79

que são adjacentes à linha média, a aproximação numérica do gradiente

é realizada considerando-se os valores discretos de pressão de volumes

localizados em todo domínio analisado na equação (3.4), já o gradiente

analítico é determinado levando em conta apenas um subdomínio desta

equação. O volume de controle com maior erro agregado além de estar

localizado na região de descontinuidade, apresenta um menor número de

volumes vizinhos com relação à maioria dos volumes da malha.

Figura 3.34 – Distribuição do erro na malha com 742 volumes de controle
utilizando LSSID. Função descontínua.

3.2.1.5 Comentários

Apesar de não se ter encontrado valores da norma do erro e da ordem

de convergência b idênticos ao se variar cada função empregada nas ma-

lhas regulares, a conclusão ao se verificar os resultados é a mesma, ou seja,

os métodos que se destacaram foram GGCBW_1S e GGCBW_2S conside-

rando a abordagem cell-based, GGVBPL considerando a abordagem vertex-

based e por fim LSSID empregando mínimos quadrados (apesar da grande

similaridade com relação aos demais).

3.2.2 Testes com diferentes malhas

Analisada a influência das diferentes funções sobre os erros na re-

construção do gradiente considerando as malhas regulares, parte-se agora



80 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

para a análise do efeito das características geométricas de diferentes ma-

lhas sobre estes erros. A ideia é isolar o efeito de cada uma destas par-

ticularidades na convergência dos métodos e também na magnitude da

norma do erro do gradiente. Deve ser ressaltado que as diferentes malhas

utilizadas nos testes a seguir se encontram na seção 3.1.2 e que a função a

ser considerada é a oscilatória, apresentada na equação (3.2).

3.2.2.1 Testes com as malhas não-conformes

Na malha mostrada na figura 3.10 (b), se na interface entre regiões

as faces dos volumes maiores forem divididas em duas para coincidir exa-

tamente com as faces dos volumes menores, obter-se-ia uma malha con-

forme. Como em uma malha poligonal, os volumes podem ter um número

arbitrário de faces, não seria necessário nenhum tratamento especial para

os volumes resultantes com cinco faces. Essa é uma das vantagens adicio-

nais de se considerar formulações numéricas aptas para lidar com volumes

poligonais. Possivelmente esta situação aconteça quando se analisar o

conjunto poço-reservatório, na região de transição entre a malha poligonal

e a malha corner-point.

Os volumes de controle localizados na interface entre as duas regiões

mencionadas merecem uma atenção especial. Aqueles com o maior tama-

nho são considerados constituídos por cinco faces, como pode ser visto na

figura 3.35. Já os volumes com menor tamanho apresentam quatro faces,

assim como nos demais volumes de controle afastados da interface. A

aproximação do gradiente segundo a abordagem cell-based para o volume

de controle p, apresentado na figura 3.35, considera os valores de pressão

em p e nos seus cinco volumes vizinhos para se determinar a pressão nas

faces, assim como foi explicado na seção 2.2.1. Já para o outro volume

p, também localizado na interface porém com menor tamanho, mostrado

na figura 3.36, devem ser considerados os valores de pressão no próprio

volume e nos seus quatro volumes de controle vizinhos.

A mesma análise, de considerar os volumes vizinhos ao volume em

questão, é realizada ao se empregar os métodos que utilizam mínimos

quadrados. Sendo assim, o estêncil para se determinar o gradiente nos

volumes de controle localizados na interface pode variar dependendo do

método empregado.

Os valores de pressão nos vértices, necessários ao se considerar a

abordagem vertex-based, são obtidos de maneira distinta na interface já



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 81

p

f1

f2

f3

f4

f5

Figura 3.35 – Faces do volume de controle p localizado na interface.

p

1n

2n

3n
4n

Figura 3.36 – Volumes de controle vizinhos a um volume de menor tama-
nho na interface.

que o número de volumes adjacentes a eles varia entre três e quatro. A

figura 3.37 mostra que para se determinar o valor de pressão nos vértices

v1 e v3 devem ser considerados os valores associados aos quatro volumes

circundantes. Para o vértice v2 apenas três são os volumes adjacentes.

Depois de algumas particularidades das malhas não-conformes se-

rem discutidas, finalmente os resultados as empregando são apresentados.

Nas figuras 3.38, 3.39 e 3.40 são exibidos gráficos que mostram a redução



82 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1v3v

2v

Figura 3.37 – Volumes adjacentes aos vértices v1 , v2 e v3 .

do erro do gradiente considerando-se a função oscilatória na sequência

de malhas não-conformes antes mencionada. Percebe-se que o método

que se destaca é o GGVBPL, apresentando uma convergência aproxima-

damente de segunda ordem, seguido dos métodos que utilizam mínimos

quadrados. A convergência é aproximadamente de primeira ordem nos

métodos GGCBW_1S e GGCBW_2S, apresentando o último uma ordem de

convergência levemente superior. Esses dois métodos se destacam dentre

os métodos com abordagem cell-based.

Na figura 3.40 verifica-se que a ponderação pela distância não in-

fluencia de maneira significativa os resultados com relação aos métodos

que utilizam mínimos quadrados. Excluindo os volumes localizados na

interface, os demais volumes são iguais aos seus vizinhos, logo a distância

entre eles é sempre a mesma não sendo necessária tal ponderação.

3.2.2.2 Testes com as malhas com razão de aspecto alta

Nas figuras 3.41, 3.42 e 3.43 encontram-se os resultados da norma do

erro do gradiente de pressão para a análise da convergência considerando

a sequência de malhas com razão de aspecto alta.

Os resultados obtidos considerando a abordagem cell-based mostram

mais uma vez que os métodos GGCBW_1S e GGCBW_2S apresentam os

melhores resultados com relação aos valores da norma do erro do gradi-

ente. Quanto à ordem de convergência, todos esses métodos apresentam



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 83

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.38 – Convergência do gradiente de pressão nas malhas não-
conformes. Métodos com abordagem cell-based.

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.39 – Convergência do gradiente de pressão nas malhas não-
conformes. Métodos com abordagem vertex-based.

um valor similar, notoriamente menor que um.

Os métodos com abordagem vertex-based apresentam resultados dis-

tintos com relação às demais malhas analisadas em conjunto com a função

oscilatória. Percebe-se no gráfico da figura 3.42 que o comportamento de

ambas as variantes do método é parecido, sendo o desempenho do método

GGVBPL levemente melhor. Nas demais malhas é clara a superioridade



84 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

2
1

1
1

h

Figura 3.40 – Convergência do gradiente de pressão nas malhas não-
conformes. Métodos utilizando mínimos quadrados.

1 0 - 2 4 x 1 0 - 2 7 x 1 0 - 21 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.41 – Convergência do gradiente de pressão nas malhas com razão
de aspecto alta. Métodos com abordagem cell-based.

deste último método.

Analisando o gráfico da figura 3.43 percebe-se que a reconstrução

do gradiente nas malhas com razão de aspecto alta é sensível à pondera-

ção pela distância. Ao se comparar o LSUN (método que não considera

ponderação) e o LSID (método que considera a ponderação pelo inverso

da distância) nota-se que além dos valores do erro ficarem menores para



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 85

1 0 - 2 4 x 1 0 - 2 7 x 1 0 - 21 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.42 – Convergência do gradiente de pressão nas malhas com razão
de aspecto alta. Métodos com abordagem vertex-based.

1 0 - 2 4 x 1 0 - 2 7 x 1 0 - 21 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.43 – Convergência do gradiente de pressão nas malhas com razão
de aspecto alta. Métodos utilizando mínimos quadrados.

este último, a ordem de convergência é levemente maior. Considerando-se

todos os métodos que utilizam os mínimos quadrados fica claro que aquele

que se destaca é o LSSID, no qual a ponderação se dá pelo quadrado da

distância.

Os métodos que utilizam mínimos quadrados apresentam os maiores

valores de ordem de convergência dentre todos os métodos analisados,



86 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

com destaque para LSSID cujo valor é aproximadamente 1.60.

Ao examinar o campo do módulo do erro do gradiente considerando

todos os métodos de reconstrução, percebe-se que os maiores valores do

erro concentram-se nos volumes localizados nas fronteiras do domínio.

Isto já era esperado pois são nessas regiões que os volumes de controle

apresentam-se com uma maior deformação. Para os métodos que utilizam

mínimos quadrados, que não dependem da geometria dos volumes de

controle da malha, os maiores erros ali se encontram pois esses volumes

apresentam um menor número de vizinhos com relação aos demais.

3.2.2.3 Testes com as malhas com distorção aleatória

As figuras 3.44, 3.45 e 3.46 exibem os valores da norma do erro do

gradiente de pressão para as malhas com distorção aleatória.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.44 – Convergência do gradiente de pressão nas malhas com dis-
torção aleatória. Métodos com abordagem cell-based.

O gráfico referente aos métodos com abordagem cell-based mostra

que nenhum dos métodos consegue tratar de maneira adequada as malhas

com volumes distorcidos. O declínio do valor da norma do erro com o

refinamento é bastante reduzido neste caso, sendo a linha de tendência

uma reta praticamente horizontal para os quatro métodos.

Os resultados referentes aos métodos com abordagem vertex-based,

apresentados na figura 3.45, mostram que o método GGVBID também

apresenta uma ordem de convergência baixa. A inclinação da reta é um



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 87

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.45 – Convergência do gradiente de pressão nas malhas com dis-
torção aleatória. Métodos com abordagem vertex-based.

pouco mais acentuada que com os métodos com abordagem cell-based,

porém, a convergência está ainda longe de ser de primeira ordem. Já o mé-

todo GGVBPL exibe um melhor desempenho com relação à convergência,

apresentando uma ordem de convergência de 1.63, aproximadamente.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.46 – Convergência do gradiente de pressão nas malhas com dis-
torção aleatória. Métodos utilizando mínimos quadrados.

Examinando a figura 3.46, nota-se que os métodos que utilizam míni-

mos quadrados não são afetados pela distorção das malhas. Este compor-



88 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

tamento já era esperado, pois conforme comentado no capítulo anterior,

tais métodos não são influenciados pela geometria dos volumes de con-

trole. O método LSSID apresenta uma leve vantagem sobre os demais com

relação ao valor da ordem de convergência (1.71 aproximadamente).

3.2.2.4 Testes com as malhas com distorção senoidal

Nas figuras 3.47, 3.48 e 3.49 encontram-se os gráficos que exibem

o comportamento da norma do erro do gradiente para as malhas com

distorção senoidal.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 S? gr

ad

h

2
1

1
1

Figura 3.47 – Convergência do gradiente de pressão nas malhas com dis-
torção senoidal. Métodos com abordagem cell-based.

Os gráficos das figuras 3.47 e 3.48 mostram que a distorção em análise

não teve uma grande influência nos resultados, assim como se percebeu

nas malhas com distorção aleatória. Até mesmo os métodos com abor-

dagem cell-based apresentam resultados razoáveis ao serem comparados

com os resultados obtidos nas malhas regulares (analisando a mesma fun-

ção oscilatória). Novamente, como nas demais malhas, os métodos que se

destacam com relação à ordem de convergência e magnitude da norma do

erro são GGCBW_1S, GGCBW_2S, GGVBPL e LSSID.

Com o objetivo de mostrar a influência da distorção dos volumes de

controle na convergência dos métodos de reconstrução do gradiente, os

resultados das ordens de convergência b bem como da constante a encon-

trados nas malhas regulares foram comparados com aqueles encontrados



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 89

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 G G V B I D
 G G V B P L? gr

ad

h

2
1

1
1

Figura 3.48 – Convergência do gradiente de pressão nas malhas com dis-
torção senoidal. Métodos com abordagem vertex-based.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 L S I D
 L S S I D
 L S U N? gr

ad

h

2
1

1
1

Figura 3.49 – Convergência do gradiente de pressão nas malhas com dis-
torção senoidal. Métodos utilizando mínimos quadrados.

nas malhas com distorção aleatória e senoidal. Vale a pena ressaltar que a

função analisada para todas os tipos de malhas é a oscilatória e que tanto

a ordem b como a constante a fazem parte da equação (3.11).

Os valores estão expostos na tabela 3.8. Essa comparação é possível

porque as malhas com distorção aleatória e senoidal derivam das malhas-

base regulares. As siglas têm seu significado nas tabelas 3.4 e 3.5.



90 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Tabela 3.8 – Valores da constante a e da ordem de convergência b obtidos
nas malhas regulares, com distorção aleatória e senoidal.

RE DA DS

a b a b a b

GGCBA_1S 0.39 0.58 0.17 0.19 0.66 0.66

GGCBA_2S 0.31 0.70 0.10 0.12 0.35 0.67

GGCBW_1S 0.57 0.92 0.09 0.13 0.82 0.91

GGCBW_2S 0.59 1.13 0.05 0.07 0.54 0.99

GGVBID 0.66 0.83 0.22 0.38 1.02 0.92

GGVBPL 6.89 1.72 5.54 1.63 7.53 1.69

LSID 7.05 1.69 6.68 1.65 7.62 1.63

LSSID 7.37 1.73 7.10 1.70 7.71 1.67

LSUN 6.93 1.66 6.46 1.61 7.57 1.59

Analisando as colunas referentes aos valores das ordens de conver-

gência das malhas regulares e com distorção aleatória, percebe-se que os

métodos com abordagem cell-based assim como o método GGVBID não

podem ser recomendados para se tratar estas últimas. Os baixos valores

de b evidenciam a deficiência já observada nos gráficos referentes a esses

tipos de malha.

Em contrapartida, os métodos GGVBPL e os que utilizam mínimos

quadrados são insensíveis a tal distorção. Basta verificar a proximidade dos

valores das ordens de convergência na tabela 3.8. Para os referidos méto-

dos, ao se analisar também a constante a , encontram-se valores maiores

da norma do erro nas malhas com distorção aleatória.

Comparando-se as colunas referentes às ordens de convergência das

malhas regulares e com distorção senoidal, não se verificam alterações

significativas dos valores de b nos métodos analisados. Isto nos leva a

concluir que esse tipo de distorção pouco influencia a convergência dos

métodos. Ao se analisar também a constante a , os valores da norma do

erro nas malhas regulares são menores em comparação aos valores refe-

rentes às malhas com distorção senoidal.

A fim de complementar a análise anterior, a distribuição do erro do

gradiente nas malhas regulares, com distorção senoidal e aleatória são apre-

sentados nas figuras 3.50, 3.51 e 3.52, respectivamente. Para o método

GGCBW_2S analisado, percebe-se a influência da distorção no sentido que



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 91

o número de volumes de controle com erros mais elevados aumenta da

malha regular até a malha com distorção aleatória. Esse fato faz com que a

norma do erro aumente seu valor, ficando evidente a influência da distor-

ção das malhas nos resultados dos métodos de reconstrução do gradiente.

Figura 3.50 – Distribuição do erro na malha regular com 232 volumes de
controle utilizando GGCBW_2S.

Figura 3.51 – Distribuição do erro na malha com distorção senoidal com
232 volumes de controle e utilizando GGCBW_2S.



92 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Figura 3.52 – Distribuição do erro na malha com distorção aleatória com
232 volumes de controle utilizando GGCBW_2S.

3.2.2.5 Comentários

Analisados os gráficos referentes às malhas não-conformes, com ra-

zão de aspecto alta, com distorção aleatória e senoidal pode-se concluir

que os métodos que apresentam os melhores resultados com relação à

ordem de convergência são os mesmos apontados quando se analisou a

influência das diferentes funções na aproximação do gradiente. Assim,

como conclusão final referente aos resultados numéricos da aproximação

do gradiente, os métodos que se sobressaem são GGCBW_1S, GGCBW_2S

para aqueles com abordagem cell-based, GGVBPL para aqueles com abor-

dagem vertex-based e LSSID para aqueles que utilizam mínimos quadra-

dos. De forma global, GGVBPL e LSSID se destacaram apresentando os

melhores resultados independentemente do tipo de malha.

A fim de poder comparar os quatro métodos citados de forma mais

clara, em cada uma das figuras 3.53, 3.54, 3.55 e 3.56 apresenta-se o com-

portamento da norma do erro do gradiente com o refinamento das cinco

diferentes malhas apresentadas.

Nos gráficos das figuras 3.53 e 3.54 nota-se que os métodos com abor-

dagem cell-based somente não conseguem tratar as malhas com distorção

aleatória. Nos demais tipos de malhas percebe-se que há a convergência

sendo que os resultados encontrados na figura 3.54 apresentam-se mais

aceitáveis, isto é, maiores ordens de convergência e menores valores da

norma do erro.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 93

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 R A
 D A
 D S? gr

ad

h

Figura 3.53 – Convergência do gradiente de pressão nas diferentes malhas
apresentadas, considerando o método GGCBW_1S.

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 R A
 D A
 D S? gr

ad

h

Figura 3.54 – Convergência do gradiente de pressão nas diferentes malhas
apresentadas, considerando o método GGCBW_2S.

Utilizando GGVBPL percebe-se que a dificuldade encontrada nos mé-

todos com abordagem cell-based para tratar a malha DA não existe. Logo,

o referido método é altamente recomendado já que pode ser utilizado em

qualquer tipo de malha testada, apresentando altas ordens de convergên-

cia.



94 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 R A
 D A
 D S? g

rad

h

Figura 3.55 – Convergência do gradiente de pressão nas diferentes malhas
apresentadas, considerando o método GGVBPL.

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 R A
 D A
 D S? gr

ad

h

Figura 3.56 – Convergência do gradiente de pressão nas diferentes malhas
apresentadas, considerando o método LSSID.

Na figura 3.56 nota-se a insensibilidade do método LSSID com rela-

ção à distorção das malhas. Basta verificar que para todas as malhas as

inclinações são praticamente as mesmas, variando-se somente o nível da

norma do erro.

Deve-se examinar agora se os métodos que apresentam os melhores

resultados de gradiente não consomem um tempo demasiadamente ele-



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 95

vado para desempenhar tal função. É importante então discutir o tempo

computacional necessário para executar a reconstrução do gradiente se-

gundo cada método.

3.3 Comparação dos tempos de computação

A fim de caracterizar o tempo computacional foram empregados dois

novos conceitos a serem discutidos nesta seção: os tempos de inicialização

e de reconstrução. Gráficos de tempo, seja ele o de inicialização ou de re-

construção, versus o comprimento característico da malha foram plotados

também em escala logarítmica a fim de se avaliar o comportamento desses

tempos com o refino da malha.

O tempo computacional foi medido utilizando a biblioteca Timer da

Boost [8]. Através desta biblioteca é possível determinar qual o tempo
necessário para se executar um determinado código na linguagem C ++,

utilizada neste trabalho.

O tempo envolvido pode ser ajustado a uma função potência con-

forme

t =?h? (3.12)

assim como na equação (3.11) quando a norma do erro estava sendo ana-

lisada. Espera-se que este tempo seja maior à medida que a malha é refi-

nada, pois através desta ação o número de volumes de controle aumenta

e por consequência a quantidade de operações a serem executadas cresce.

Sendo assim, como o comprimento característico h é um valor menor que

a unidade, a ordem ? deve ser um valor negativo esperando-se que seu

módulo seja aproximadamente 2. A explicação para essa expectativa é

dada a seguir.

Lembrando que o objetivo é a obtenção do gradiente de pressão atra-

vés de um campo de pressão conhecido, ao considerar que o domínio

unitário é discretizado por exemplo com as malhas regulares, espera-se

que o aumento do número de volumes de controle seja diretamente pro-

porcional ao aumento do tempo computacional. Ou seja, aumentando-se

o número de variáveis aumenta-se linearmente o tempo computacional

associado.

Idealmente, o tempo de computação deveria crescer de forma pro-

porcional ao número de valores de gradiente calculados, que, neste caso, é

igual ao número de volumes de controle de uma dada malha. Se a malha



96 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

fosse uma malha cartesiana uniforme e o domínio quadrado unitário, o

comprimento característico dos volumes da malha seria h = Nc ?1/2, onde
Nc é o número de volumes da malha. Para uma malha poligonal arbitrária,

poder-se-ia esperar que fosse válida uma relação da forma

h ? Nc ?1/2 (3.13)

ou, escrita de outra forma,

Nc ? h?2 (3.14)

Portanto, uma relação linear entre o tempo computacional e o nú-

mero de volumes de controle daria lugar a uma relação entre o tempo

computacional e o comprimento característico da forma

t ? h?2 (3.15)

Antes de apresentar os resultados obtidos é necessário definir os tem-

pos de inicialização e de reconstrução. O de inicialização é aquele gasto

para o cálculo de parâmetros que não se alteram durante uma simulação.

Os valores desses parâmetros são fixos já que dependem de fatores geomé-

tricos da malha, e, portanto, ao se atualizar o campo de pressão elas não

necessitam ser calculadas novamente. Exemplos desses parâmetros são

o fator de ponderação ?f encontrado na equação (2.15) quando se quer

utilizar o método GGCBW_1S, e o vetor L p,f encontrado na equação (2.17)
quando se quer utilizar os métodos GGCBA_2S ou GGCBW_2S.

O tempo de reconstrução é aquele gasto nas operações de reconstru-

ção do gradiente utilizando os parâmetros computados na inicialização e

os valores atuais do campo de pressão. Por exemplo, considerando o mé-

todo GGVBPL, o tempo de reconstrução leva em conta o cálculo do valor

da pressão nos vértices, nas faces e também a substituição desses valores

na fórmula de Green-Gauss para se determinar o gradiente de pressão em

cada volume da malha.

Os gráficos apresentados a seguir correspondem a testes de recons-

trução do gradiente em malhas regulares, considerando a pressão vari-

ando de acordo com a função oscilatória. Comparando o tempo com-

putacional dos métodos que se destacaram nos testes de convergência

com os demais métodos, o propósito é verificar se os melhores resultados

encontrados naqueles estão associados a tempos computacionais eleva-

dos. Procura-se, assim, avaliar quais métodos apresentam uma boa relação



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 97

custo/benefício.
Nas figuras 3.57 e 3.58 encontram-se os gráficos de tempo de ini-

cialização e de reconstrução, considerando os métodos com abordagem

cell-based. Da forma como está implementado o código computacional,

a diferença entre esses métodos com relação aos procedimentos com um

passo e dois passos está somente no tempo de reconstrução, por isso o

tempo de inicialização é o mesmo entre eles. Sendo assim, GGCBW_1S e

GGCBW_2S apresentam o mesmo tempo de inicialização, mesmo o pri-

meiro sendo mais simplificado, assim como GGCBA_1S e GGCBA_2S. Este

é o motivo pelo qual no gráfico referente ao tempo de inicialização apenas

dois métodos são mostrados.

Na figura 3.57 percebe-se que o método GGCBW_1S, e por consequên-

cia GGCBW_2S, exibe um valor de tempo de inicialização maior que

GGCBA_1S. Porém, deve-se lembrar que os parâmetros considerados no

tempo de inicialização são calculados somente uma vez durante a simu-

lação, assim, a pequena diferença de valores entre os pontos envolvidos

justifica o uso dos métodos com média ponderada pela distância.

Nota-se na figura 3.58 que o método GGCBW_1S além de apresentar

bons resultados com relação à aproximação do gradiente apresenta tam-

bém um tempo de reconstrução cujos valores são próximos ao método que

apresenta o menor tempo, o GGCBA_1S. Este último apesar de apresentar

o mais baixo tempo de reconstrução, não apresentou resultados aceitá-

veis com relação à aproximação do gradiente, não tendo assim um bom

custo/benefício.
O mais alto tempo obtido em GGCBW_2S ainda o torna um dos mé-

todos a ser destacado pois além de apresentar um bom desempenho com

relação à aproximação do gradiente, é visível que os valores de tempo de

reconstrução a ele associado são baixos, basta verificar a baixa ordem de

grandeza desses valores na figura 3.58. Logo, somente um valor muito alto

de número de iterações evidenciaria uma diferença significativa de tempo

computacional ao se comparar GGCBW_2S e GGCBA_2S, por exemplo.

Os gráficos das figuras 3.59 e 3.60 mostram o comportamento dos

tempos de inicialização e reconstrução quando se utilizam os métodos

com abordagem vertex-based. Os parâmetros fixos nesses métodos são os

fatores de ponderação associados a cada vértice da malha analisada.

Ao analisar a figura 3.59 fica claro que a determinação dos fatores de

ponderação associados a cada vértice interno das malhas tem um maior



98 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 1 0 - 11 0
- 2

1 0 - 1

1 0 0

1 0 1

 G G C B A _ 1 S
 G G C B W _ 1 St ini

 [s
]

h

Figura 3.57 – Tempo de inicialização considerando os métodos com abor-
dagem cell-based.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

 G G C B A _ 1 S
 G G C B A _ 2 S
 G G C B W _ 1 S
 G G C B W _ 2 St rec

 [s
]

h

Figura 3.58 – Tempo de reconstrução considerando os métodos com abor-
dagem cell-based.

custo computacional no método GGVBPL. Basta verificar as equações (2.21)

e (2.27), referentes a GGVBID e GGVBPL respectivamente, para confirmar

que na segunda equação esses fatores necessitam de mais parâmetros ge-

ométricos para serem determinados.

Com relação ao tempo de reconstrução, algum erro na sua medição

é verificado, já que os tempos associados aos dois métodos deveriam ser



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 99

iguais. Isso pelo fato do procedimento ser o mesmo em ambos os méto-

dos depois de determinados os fatores de ponderação, isto é, calcula-se a

pressão nos vértices, nas faces correspondentes e por fim o gradiente de

pressão associado.

Pode-se concluir a partir dos testes com abordagem vertex-based que

a utilização de GGVBPL é a mais recomendável pois somente o tempo de

inicialização apresenta um valor maior com relação ao método GGVBID.

Além da diferença entre o tempo de inicialização dos dois métodos ser um

valor aceitável, deve-se ressaltar mais uma vez que os parâmetros fixos

a ele associados são determinados somente uma vez durante toda uma

simulação.

1 0 - 2 1 0 - 11 0
- 2

1 0 - 1

1 0 0

1 0 1

 G G V B I D
 G G V B P Lt ini

 [s
]

h

Figura 3.59 – Tempo de inicialização considerando os métodos com abor-
dagem vertex-based.

Nas figuras 3.61 e 3.62 encontram-se os valores do tempo de iniciali-

zação e de reconstrução considerando os métodos que utilizam mínimos

quadrados. Percebe-se em ambas as figuras que as linhas de tendência se

sobrepõem, logo não se observa uma variação no tempo computacional

entre tais métodos.

Uma observação importante com relação ao tempo de inicialização é

que no código computacional a matriz de pesos W, única diferença entre
os três métodos expostos, é calculada considerando o expoente c como um

parâmetro de entrada. Mesmo empregando o método LSUN deve-se de-

terminar cada valor das componentes da referida matriz, basta considerar



100 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

 G G V B I D
 G G V B P L

t rec
 [s

]

h

Figura 3.60 – Tempo de reconstrução considerando os métodos com abor-
dagem vertex-based.

c com o valor 0 assim como é explicado na seção do método de recons-

trução correspondente. É por esse motivo que o tempo de inicialização é

semelhante para todos os métodos de reconstrução que utilizam mínimos

quadrados.

O tempo de reconstrução também é equivalente entre os referidos

métodos já que, uma vez determinados os parâmetros fixos, o procedi-

mento para determinação do gradiente de pressão ao longo da malha não

varia.

Observando os gráficos desta seção, percebe-se que a ordem de gran-

deza dos tempos de inicialização é maior que a dos tempos de reconstru-

ção. O expoente ?, definido na equação (3.12), é de aproximadamente -2,

conforme esperado.

Dentre os métodos analisados, aqueles que utilizam mínimos qua-

drados apresentam os maiores tempos de inicialização e reconstrução. Isto

ocorre pois, diferentemente dos demais, tais métodos necessitam resolver

um sistema de equações para cada volume de controle da malha em aná-

lise.

Sendo assim, os métodos que se sobressaíram com relação à aproxi-

mação do gradiente, GGCBW_1S, GGCBW_2S, GGVBPL e LSSID, apresen-

tam uma boa relação custo/benefício. Logo, estes serão utilizados na apro-
ximação dos fluxos em uma formulação numérica para malhas poligonais,

conforme será discutido no próximo capítulo.



CA PÍT ULO 3 – A NÁ LISE CO M PAR AT I VA DO S M ÉTODO S DE R ECO NST RUÇ ÃO 101

1 0 - 2 1 0 - 11 0
- 2

1 0 - 1

1 0 0

1 0 1

 L S I D
 L S S I D
 L S U Nt ini

 [s
]

h

Figura 3.61 – Tempo de inicialização considerando os métodos que utili-
zam mínimos quadrados.

1 0 - 2 1 0 - 11 0
- 4

1 0 - 3

1 0 - 2

 L S I D
 L S S I D
 L S U Nt rec

 [s
]

h

Figura 3.62 – Tempo de reconstrução considerando os métodos que utili-
zam mínimos quadrados.





CAPÍTULO

4
A P L I C AÇ ÃO À D I S C R E T I Z AÇ ÃO

D E U M M O D E LO D E

E S COA M E N TO M O N O FÁ S I CO

4.1 Introdução

Ao se fazer a discretização da equação do modelo bidimensional mo-

nofásico em meios porosos utilizando o método dos volumes finitos, surge

a necessidade de aproximar os fluxos através das faces dos volumes de

controle das malhas poligonais. Esta aproximação é realizada segundo um

esquema numérico que tem como princípio determinar o fluxo mediante

uma expressão composta por dois termos, um tratado implicitamente e

o outro explicitamente. Para este último são necessários os valores do

gradiente de pressão em cada um dos volumes da malha. É nesse ponto

que se fazem importantes os métodos de reconstrução apresentados no

capítulo 2.

No presente capítulo é então apresentada a equação da conservação

da massa discretizada considerando volumes de controle internos e de

fronteira, sendo a forma de aproximar os fluxos nas faces também eviden-

ciada.

103



104 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

4.2 Discretização da equação da conservação de

massa

Conforme já mencionado, o método utilizado para discretizar a equa-

ção de conservação é o método dos volumes finitos. No caso do presente

trabalho, a equação discretizada é obtida integrando-se sobre os volumes

de controle a equação (1.6), escrita na forma conservativa 1.

Realizando a referida integração para o caso monofásico em regime

permanente em um volume de controle ?V, obtém-se

?

?V

? ·(?v) dV =
?

?V

q dV (4.1)

Aplicando o teorema da divergência na integral volumétrica no lado

esquerdo da equação anterior, chega-se a

?

?S

?v ·dS =
?

?V

q dV (4.2)

O primeiro termo da equação (4.2) representa o fluxo de massa lí-

quido através da superfície do volume de controle, já o termo do lado

direito representa uma fonte ou sumidouro de massa no seu interior.

Neste trabalho, os volumes de controle analisados são poligonais. Por-

tanto, pode-se utilizar a propriedade da aditividade das integrais a fim de

expressar a integral de superfície da equação (4.2) como um somatório de

integrais em cada face de um volume de controle qualquer p [17]. Assim, a
equação anterior pode ser escrita como

?

f?p

?

?Sf

?v ·dS =Q p (4.3)

sendo o termo da integral o fluxo de massa através de uma face do volume

p e o termo fonte Q p representa a integral no lado direito da equação (4.2).

Aproximando a integral de superfície da equação anterior pela regra

do ponto médio [17], tal equação pode ser assim apresentada

1 Também denominada de forma divergente é aquela em que na equação diferencial os
fluxos estão dentro do sinal da derivada [25].



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 105

?

f?p

(?v ·?S)f =Q p (4.4)

A equação (4.4) é resultado da discretização espacial da equação da

conservação da massa. O termo da esquerda representa o somatório dos

fluxos de massa através de todas as faces do volume de controle em ques-

tão. Substituindo a velocidade de Darcy, equação (1.2), na equação (4.4)

obtém-se
?

f?p

?

?
?

µ
K?P ·?S

?

f

=Q p (4.5)

O fluxo de massa através de uma face do volume de controle
?

?
?

µ
K?P ·?S

?

f

está deduzido na próxima seção e será denominado por

qf. Recomenda-se a leitura da seção 4.3 para o correto entendimento deste

desenvolvimento.

Adotando a nomenclatura apresentada no parágrafo anterior, a equa-

ção (4.5) pode ser escrita de uma forma simplificada por

?

f?p

qf =Q p (4.6)

sendo a expressão do fluxo dada por

qf =
Pp ?Pn
?p ??n

?
?p??p ??n?

?
n

?p ??n
(4.7)

com Pp e Pn representando os valores de pressão associados aos volumes

de controle adjacentes à face f, ?p e ?n sendo parâmetros que envolvem

a geometria dos volumes envolvidos e propriedades do fluido e do meio

poroso. Os demais parâmetros da equação (4.7),??p e ?
?
n , dependem, além

de propriedades e geometria, do gradiente de pressão calculado segundo

os métodos de reconstrução do gradiente apresentados no capítulo 2.

Considerando um volume de controle p, a equação discretizada da

conservação da massa (4.6) pode ser organizada de tal maneira a ser escrita

na forma usual do método dos volumes finitos

A pPp =
Nvc
?

k=1

A nk Pnk +b p (4.8)



106 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

onde k = 1, 2, ..., Nvc sendo Nvc o número de volumes de controle adjacen-
tes a p. O termo b p é o termo independente da equação composto por

valores já conhecidos, A p é o coeficiente central associado a p (onde se

deseja obter a pressão) e A nk é o coeficiente relacionado a cada um dos

volumes de controle adjacentes a p. A figura 4.1 ilustra os volumes de

controle que participam diretamente da equação discretizada (4.8).

3n 2n

n

5n
6n

p
1n4

Figura 4.1 – Volumes de controle que participam da equação aproximada
associada a p.

Para um volume de controle que apresenta um termo fonte, os coefi-

cientes e o termo independente da equação (4.8) são a seguir apresentados

A nk =
1

?p ??nk

A p =
Nvc
?

k=1

A nk (4.9)

b p =Q p +
Nvc
?

k=1

(?p??p ??nk ?
?
nk
)

?p ??nk

sendo os somatórios realizados considerando-se todos os volumes vizi-

nhos a p.

Para um volume de controle que não apresenta fonte ou sumidouro

de massa, a equação discretizada da conservação da massa tem a mesma



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 107

forma da equação (4.8), porém, Q p = 0 ao se determinar o termo indepen-
dente.

A equação (4.8) é aplicada para os volumes de controle internos da

malha, isto é, aqueles que não fazem parte das fronteiras do domínio físico.

A equação para um volume de controle adjacente a uma ou mais fronteiras

deve ser alterada para que as informações das condições de contorno se-

jam sentidas no interior do domínio. Na seção 4.4 os volumes localizados

nas fronteiras são analisados.

4.3 Aproximação dos fluxos

O esquema numérico para aproximação dos fluxos aqui apresentado

é baseado na abordagem apresentada em [30], a qual foi proposta original-
mente para a discretização das equações de Navier-Stokes.

Em tal referência o fluxo através de uma face f é aproximado através

de uma expressão composta por dois termos. O primeiro deles depende

de fatores geométricos e dos valores da variável nos volumes de controle

associados à referida face. Este termo é tratado de forma implícita, isto é,

ele contribui para os coeficientes da equação discretizada.

O segundo termo é usualmente chamado de difusão cruzada já que

representa a componente transversal do fluxo. Esse termo se anula nos

casos em que o meio é isotrópico e a linha que une os centroides dos

volumes de controle coincinde com a direção do vetor área da face comum

a eles, ou seja, quando a malha é localmente ortogonal.

Em [30] sugere-se tratar o termo da difusão cruzada de forma explí-
cita, utilizando para isto valores da variável de uma iteração anterior. Tal

procedimento torna a referida parcela do fluxo um integrante do termo

independente da equação da conservação analisada, pois seu valor será

conhecido. A implementação é facilitada ao empregar essa abordagem,

porém, ao mesmo tempo um esquema iterativo é necessário para deter-

minar a solução numérica da equação de conservação [27]. A seguir é
descrito o esquema numérico para aproximação dos fluxos adotado neste

trabalho. Vale ressaltar que, apesar do meio ser considerado homogêneo

nos problemas aqui analisados, a referida aproximação é descrita para um

caso mais genérico, em que a permeabilidade pode variar de um volume

de controle para outro.

O fluxo através de uma face é analisado considerando-se primeira-

mente um dos volumes de controle que compartilham essa face, conforme



108 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

mostra a figura 4.2. Utilizando a propriedade comutativa do produto esca-

lar tem-se na forma matricial para esse fluxo

?

µ
(K?P)p ·?Sf =

?

µ
?Sf ·(K?P)p =

?

µ

?

?Sx ?Sy
?

f

 

K x x K x y

K x y K y y

!

p

 

?x P

?y P

!

p

(4.10)

Nesta expressão, o tensor permeabilidade e o gradiente de pressão

estão associados ao volume de controle considerado. As componentes

cartesianas do vetor área de face são ?Sx e ?Sy , enquanto que ?x P e ?y P
são as componentes do gradiente de pressão.

A equação (4.10) ainda não é aplicável à discretização da equação

de conservação de massa, pois não envolve valores discretos da pressão.

Com o intuito de introduzir esses valores na expressão do fluxo, irá se

considerar uma transformação local de coordenadas. Os eixos cartesianos

(x , y ) são transformados em (?,?), sendo ? aquele que segue a direção da
linha que une o centroide do volume de controle ao centroide da face e

cujo sentido (de p para f) está demonstrado na figura 4.2. Por conveniência,

escolheu-se que o outro eixo, ?, coincidisse com o eixo y . O critério para

a transformação dos eixos depende da configuração local, e será descrito

mais adiante.

fx

pK

x
h

x

y

fSD

ppp

h

Figura 4.2 – Representação de um volume de controle e disposição do novo
sistema coordenado (?,?).

Escrevendo o gradiente de pressão de acordo com o novo sistema



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 109

coordenado, a equação (4.10) torna-se

?

µ
(K?P)p ·?Sf =

?

µ

?

?Sx ?Sy
?

f

 

K x x K x y

K x y K y y

!

p

 

?x? ?x?

?y ? ?y ?

!

p

 

??P

??P

!

p

(4.11)

A terceira matriz do lado direito da equação (4.11) é a matriz jacobi-

ana da transformação de coordenadas, que faz a conexão entre os sistemas

coordenados. A fim de se determinar as métricas que compõem essa ma-

triz, a seguinte relação encontrada em [25] é utilizada

 

?x? ?y ?

?x? ?y ?

!

p

=

 

??x ??x

??y ??y

!?1

p

(4.12)

A matriz a ser invertida é composta pelas métricas da transformação

inversa. Essas métricas são determinadas conforme descrito a seguir.

Seja e? o vetor obtido unindo os centroides do volume de controle p
e da face f. Esse vetor pode ser decomposto segundo os eixos cartesianos,

conforme mostrado na figura 4.3.

x

y

p

fe x
Ly

Lx

Figura 4.3 – Decomposição do vetor e? no sistema cartesiano.

Sendo o eixo coordenado ? colinear ao vetor e? e a distância entre os
centroides p e f um valor igual a ?? (o módulo do referido vetor), tem-se
utilizando o conceito de derivada a situação ilustrada na figura 4.4.

Analisando as duas últimas figuras, obtém-se por comparação duas



110 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

p

f

x

x¶ Dx
x

Dx

x

yy¶ Dx
x

Figura 4.4 – Eixo coordenado ? e centroides p e f.

das métricas da transformação inversa

?

??x
?

p =
?

L x
??

?

p
(4.13)

?

??y
?

p =
?

L y
??

?

p
(4.14)

Para a situação ilustrada na figura 4.2, os eixos coordenados ? e ?

foram escolhidos de tal forma que ? coincidisse com y . Logo, as duas

métricas restantes são

?

??x
?

p
= 0 (4.15)

?

??y
?

p
= 1 (4.16)

Estando assim determinadas todas as métricas da transformação in-

versa, basta realizar a inversão da matriz apresentada na equação (4.12)

para finalmente obter a matriz jacobiana necessária na equação (4.11)

 

?x? ?x?

?y ? ?y ?

!

p

=

?

?

?

?

??
L x

?L y
L x

0 1

?

?

?

?

p

(4.17)

Com o intuito de simplificar a equação do fluxo será definido o vetor

?

?x ?y

?

p
=
?

?Sx ?Sy
?

f

 

K x x K x y

K x y K y y

!

p

(4.18)

com o qual a equação (4.11) pode ser rescrita, após realizar os produtos

indicados, como



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 111

?

µ
(K?P)p ·?Sf =

?

µ

?

?x ?x?+?y ?y ?
?

p

?

??P
?

p +

?

µ

?

?x ?x?+?y ?y ?
?

p

?

??P
?

p
(4.19)

Ainda é necessário definir as derivadas parciais da pressão para que

o fluxo esteja completamente determinado. A derivada (??P)p pode ser
aproximada aplicando diferenças finitas por (??P)p ? (Pf ?Pp)/??p, onde
Pf e Pp são as pressões associadas aos centroides da face e do volume

p, respectivamente. Como no caso considerado o eixo coordenado ? é

concidente com y , a outra derivada da equação (4.19) pode ser escrita

simplesmente como (??P)p =(?y P)p.
Substituindo as derivadas parciais correspondentes às métricas da

transformação e as derivadas da pressão, a equação (4.19) toma a seguinte

forma aproximada

?

µ
(K?P)p ·?Sf ?

?

µ

?

?x
??
L x

?

p

Pf ?Pp
??p

+

?

µ

?

??x
L y
L x
+?y

?

p

?

?y P
?

p
(4.20)

Com o intuito de simplificar a escrita da equação anterior, os seguin-

tes parâmetros associados à face f e ao volume de controle p são definidos

?p =
µ

?

?

L x
?x

?

p

(4.21)

??p =
?

µ

?

??x
L y
L x
+?y

?

p
(?y P)?p

O asterisco aparente na equação anterior indica que a derivada par-

cial (?y P)p é determinada de forma explícita, considerando os valores de
pressão conhecidos do nível iterativo anterior ao analisado.

Definidos os novos parâmetros na equação (4.21), a expressão para o

fluxo atravessando a face f pode ser escrita por

qf =?
?

µ
(K?P)p ·?Sf =?

Pf ?Pp
?p

???p (4.22)



112 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Deve-se ressaltar que recém na equação (4.22) foi incluído o sinal ne-

gativo proveniente da definição da lei de Darcy. As equações apresentadas

até o momento estiveram relacionadas a um dos volumes de controle adja-

centes a f. Expressões equivalentes podem ser determinadas considerando

o outro volume. Assim, a expressão equivalente à equação (4.22) para o

volume de controle n é dada por

qf =?
?

µ
(K?P)n ·?Sf =?

Pf ?Pn
?n

???n (4.23)

onde os parâmetros ?n e ??n são expressões análogas às da equação (4.21),

envolvendo neste momento os parâmetros geométricos e o tensor perme-

abilidade associados ao volume n. De acordo com a figura 4.5, para cada

volume de controle deverá ser definido um eixo auxiliar ? diferente, com o

sentido positivo apontando na direção da face [27].
As derivadas parciais, componentes dos parâmetros ??p e ?

?
n , são par-

celas do gradiente de pressão que podem ser determinadas por algum dos

métodos de reconstrução explícita do gradiente vistos no capítulo 2. É

portanto nestes parâmetros que surge a conexão entre a discretização da

equação de conservação de massa e os referidos métodos de reconstrução

do gradiente.

n

xn

pK
nK

fSD
f

ppp

xp

x

y

h h

Figura 4.5 – Entidades envolvidas na determinação do fluxo em uma face
interna.

Partindo do princípio de que o fluxo que deixa o volume de controle

p através da face f é o mesmo fluxo que ingressa no volume vizinho n, as



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 113

equações (4.22) e (4.23) podem ser manipuladas algebricamente a fim de

eliminar a pressão Pf. A expressão final do fluxo, que envolve apenas os

valores de pressão nos centroides dos volumes de controle adjacentes a f,

é a seguinte

qf =
Pp ?Pn
?p ??n

?
?p??p ??n?

?
n

?p ??n
(4.24)

Os dois termos na equação (4.24) podem ser interpretados da mesma

forma que em [30]. O primeiro pode ser entendido como uma difusão
primária e é tratado implicitamente já que durante o ciclo iterativo, a ser

explicado no próximo capítulo, considera as variáveis do nível iterativo

corrente, contribuindo assim com os coeficientes da equação discretizada.

O segundo termo é referente à difusão cruzada. Este termo torna-se

importante nos casos em que a face não é ortogonal à linha que une os

centroides dos volumes vizinhos ou a permeabiilidade é altamente aniso-

trópica. A fim de manter um estêncil compacto para a equação discreti-

zada de conservação de massa, o segundo termo é tratado explicitamente,

ou seja, ele é calculado com os valores do gradiente calculados utilizando

o campo de pressão do nível iterativo anterior. Logo, na equação dis-

cretizada da conservação da massa, o referido termo fará parte do termo

independente.

A aproximação do fluxo considerando apenas dois pontos, sem qual-

quer termo explícito de correção como na equação (4.24), é uma prática

comum na simulação de reservatórios, pois dá origem a sistemas lineares

de equações com matrizes altamente esparsas e fáceis de resolver. Depen-

dendo do tipo de problema, geometria da malha e anisotropia do meio,

essa abordagem pode originar erros significativos nas soluções. Somente

para o caso particular de um meio isotrópico e malha ortogonal, como a

cartesiana por exemplo, o fluxo através das faces dos volumes de controle é

calculado corretamente utilizando-se apenas dois valores de pressão. Isso

ocorre nesse caso porque o fluxo depende somente da derivada da pressão

em relação a um eixo coordenado [37]. Utilizando as malhas de Voro-
noi [25] em problemas isotrópicos consegue-se também calcular os fluxos
exatamente empregando-se apenas dois pontos de pressão. Isto ocorre

porque a linha que une os centroides dos volumes de controle é ortogonal

à face que os separa.

Um ponto importante a ser comentado é que os parâmetros apresen-

tados na equação (4.21) foram obtidos considerando a transformação local



114 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

de coordenadas apresentada na figura 4.2, em que o eixo ? coincide com

y . Esta transformação seria apropriada, por exemplo, para a configuração

geométrica apresentada na figura 4.6 (a) em que os valores absolutos das

projeções horizontais do vetor rp,n e do vetor área face são maiores que os
valores absolutos das suas projeções verticais.

Em uma outra situação, por exemplo a do caso (b) da figura 4.6, o

contrário é verificado. A transformação de coordenadas mais conveniente

para esse caso é a mostrada na figura 4.7, sendo agora o eixo ? coincidente

com o eixo x . Para esta nova situação, os parâmetros envolvidos na equa-

ção (4.22) passam a ser dados por

?p =
µ

?

?

L y
?y

?

p

(4.25)

??p =
?

µ

?

?x ??y
L x
L y

?

p

(?x P)?p

f
p

n f

p

n

x

y

(a) (b)

pK nK

nK

pK

rp,n

rp,n

fSD
fSD

Figura 4.6 – Duas situações possíveis para transformação dos sistemas co-
ordenados.

Na implementação computacional do método descrito, além de veri-

ficar qual projeção do vetor r p,n é maior para selecionar a transformação
de coordenadas mais adequada, uma verificação adicional é feita. Nela, as

projeções do vetor área de face são analisadas. A projeção deste vetor sobre



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 115

x

h

x

y

Figura 4.7 – Transformação dos sistemas coordenados para o caso em que
as projeções verticais dos vetores rp,n e da área face são maiores
que as projeções horizontais.

o eixo escolhido na primeira etapa (aquele sobre o qual a projeção de r p,n
é maior) não deve ter um valor muito menor que a projeção sobre o outro

eixo e também não pode ser um valor nulo. Caso alguma dessas condições

se verifique, escolhe-se a outra opção de transformação de coordenadas.

Essa segunda etapa de verificação é importante para que problemas

na determinação do parâmetro ? não venham a surgir e também para

dar maior importância à parcela implícita na equação (4.24). No próximo

capítulo é verificado que quando a parcela explícita nessa equação é muito

maior à parcela implícita, a convergência do processo iterativo de solução

pode ser comprometida.

Deve ficar claro que a equação final do fluxo (4.24) é utilizada para

qualquer tipo de transformação de coordenadas. O que realmente dife-

rencia uma transformação da outra em tal equação é a determinação dos

parâmetros associados.

4.4 Volumes de controle de fronteira

O objetivo desta seção é apresentar a equação da conservação da

massa na forma discretizada considerando um volume de controle locali-

zado na fronteira do domínio. Na apresentação feita a seguir considera-se

que nas fronteiras é imposta uma condição de Dirichlet, ou seja, a variação

da pressão em todas as fronteiras é conhecida.

O fluxo através de uma face coincidente com uma fronteira pode ser

aproximado com a equação (4.22), a qual pode ser reescrita como

qf1 =
Pp ?Pf1
?p

???p (4.26)

sendo f1 a face localizada na referida posição, conforme ilustrado na figura



116 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

4.8. A transformação de coordenadas realizada deve seguir o mesmo prin-

cípio apresentado na seção anterior. Contudo, agora o vetor rp,f é o vetor
cujas projeções devem ser analisadas na primeira etapa.

Na equação (4.26), o valor de Pf1 é conhecido, pois f1 se encontra

sobre uma fronteira em que a variação da pressão é conhecida. Portanto,

ao substituir a equação (4.26) na equação de balanço para o volume de

controle correspondente, a parcela associada a Pf1 poderá ser adicionada

ao termo independente da equação. Assim, a equação discretizada para

um volume de controle p adjacente à fronteira é

A pPp =
Nvc
?

k=1

A nk Pnk +b
?
p (4.27)

em que os coeficientes e o termo independente são dados por

A nk =
1

?p ??nk

A f1 =
1

?p
(4.28)

A p =
Nvc
?

k=1

A nk +A f1

b ?p =Q p +
Nvc
?

k=1

(?p??p ??nk ?
?
nk
)

?p ??nk
+A f1 Pf1 +?

?
p

Os somatórios envolvem todos os volumes de controle adjacentes a

p. Percebe-se que a equação (4.27) tem o mesmo formato da equação

(4.8), que corresponde a um volume interno. Tais equações diferem apenas

no coeficiente A p e no termo b ?p, os quais para os volumes adjacentes às

fronteiras carregam as informações da condição de contorno.

Comentários

Após calcular os coeficientes e os termos independentes das equa-

ções de todos os volumes de controle da malha, eles podem ser reunidos

no sistema linear

AP = b (4.29)



CA PÍT ULO 4 - A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO M ON OFÁ SICO 117

f1 p 3n

2n

5n

1n

n4

p,r f1

Figura 4.8 – Volume de controle adjacente a uma fronteira.

ondeAé a matriz que contém os coeficientes de todas as equações envolvi-
das, b é o vetor dos termos independentes e P é o vetor de valores discretos
de pressão associados aos volumes de controle da malha.

Vale destacar que como o vetor b contém gradientes determinados
com valores discretos de pressão que não necessariamente satisfazem o

sistema linear anterior, um processo iterativo é necessário para determinar

o campo de pressão que seja a solução do problema considerado. Em

cada iteração desse processo o sistema linear da equação (4.29) deve ser

resolvido e com a solução correspondente os gradientes de pressão devem

ser recalculados. O algoritmo de solução considerado será descrito em

detalhes no próximo capítulo.





CAPÍTULO

5
R E S U LTA D O S

5.1 Introdução

Depois de apresentadas as expressões da equação da conservação

da massa discretizada e da aproximação dos fluxos através das faces dos

volumes de controle nas malhas poligonais, no presente capítulo procura-

se descrever o processo iterativo necessário para se determinar o campo de

pressão no domínio. Dois casos são também apresentados com o intuito

de avaliar a metodologia numérica descrita neste trabalho.

5.2 Algoritmo de solução

Nesta seção é descrito o algoritmo de solução que foi utilizado para

obter os resultados apresentados neste capítulo. O processo iterativo con-

siderado segue os seguintes passos:

1. Estima-se um campo de pressão inicial;

2. Mediante algum dos métodos de reconstrução explícita do gradi-

ente, obtém-se o gradiente de pressão associado a cada volume

de controle da malha, utilizando os valores discretos de pressão

disponíveis;

3. Monta-se o sistema linear conforme explicado no capítulo 4. Como

os coeficientes da matrizAdependem de parâmetros geométricos
e propriedades do fluido e do meio, que são invariáveis, tal matriz

119



120 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

pode ser montada somente a primeira vez que este passo é exe-

cutado. Já o vetor b deve ser atualizado sempre, uma vez que ele
depende dos gradientes de pressão;

4. Resolve-se o sistema linear, obtendo-se um novo campo de pres-

são;

5. Retorna-se para o item 2 e itera-se até que um nível de convergên-

cia preestabelecido seja atingido.

O critério considerado no passo 5 para finalizar o processo é que uma

norma da variação do campo de pressão entre duas iterações consecutivas

seja menor que um valor preestabelecido. A norma considerada, que segue

os princípios apresentados em [18], está definida pela expressão

?PI =

?

?

?

?

?

?

?

N c
?

i=1

?

P ni ?P
n?1

i

?2
?Vi

N c
?

i=1

?

P ai
?2
?Vi

?

?

?

?

?

?

?

1/2

(5.1)

sendo P ni e P
n?1

i as pressões no volume de controle i no nível iterativo

atual e no nível anterior, respectivamente. O somatório é mais uma vez

computado considerando-se todos os volumes de controle da malha. Além

disso, P ai é o valor de pressão no centroide do volume i , correspondente

à solução analítica do problema. O denominador da expressão definida

na equação (5.1) pode ser interpretado como um valor de normalização

da variação do campo de pressão entre iterações. Para todos os resultados

apresentados aqui, o processo iterativo foi executado até atingir a condição

?PI &amp;lt;10?8.

Os resultados aqui apresentados foram obtidos mediante códigos im-

plementados na liguagem C ++. A biblioteca ACMLib [29] auxiliou na solu-
ção dos sistemas lineares empregando o método multigrid de correções

aditivas [25].

5.3 Especificação do problema

O problema considerado para testar as metodologias numéricas des-

critas neste trabalho é o determinado pela equação diferencial de segunda



CA PÍT ULO 5 - R ESULTADO S 121

ordem

?? ·K?P = F(x , y ) em ? (5.2)

sendo ? um domínio quadrado unitário e F um termo fonte. A referida
equação nada mais é do que a equação da conservação da massa (1.7)

considerando ? e µ valores unitários. Dessa forma, essa equação deter-

mina o campo de pressão em um escoamento monofásico no domínio

considerado.

No contorno ?? desse domínio são prescritas condições de Dirichlet

P = PD i r(x , y ) em ?? (5.3)

Dois casos são aqui considerados a fim de avaliar a metodologia nu-

mérica descrita neste trabalho. Em ambos os casos o meio é homogêneo

e anisotrópico. O tensor permeabilidade, o termo fonte e a solução analí-

tica, correspondentes aos dois casos considerados estão especificados na

tabela 5.1. O primeiro caso, em que o tensor permeabilidade é diagonal,

é uma variante de um problema apresentado em [25]. O segundo caso foi
proposto originalmente em [29].

Tabela 5.1 – Especificação dos casos considerados.

No caso 1 serão considerados diferentes valores para a razão de anis-

tropia, a qual foi definido como

?=
K y y
K x x

(5.4)



122 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

A fim de caracterizar o erro associado à solução numérica em uma

determinada malha, a seguinte forma adimensional da norma L 2 do erro é

considerada

"P =

?

?

?

?

?

?

?

N c
?

i=1

?

P ni ?P
a

i

?2
?Vi

N c
?

i=1

?

P ai
?2
?Vi

?

?

?

?

?

?

?

1/2

(5.5)

sendo P ni o valor discreto de pressão associado ao volume i e P
a

i o valor

correspondente à solução analítica no centroide do mesmo volume.

Mais uma vez será analisada a taxa com que a magnitude do erro cai

à medida que as malhas são refinadas. Os gráficos exibidos no presente

capítulo apresentam as mesmas características daqueles mostrados no ca-

pítulo 3, porém aqui a norma do erro é relacionada com a variável pressão.

A análise é da mesma forma realizada, considerando-se as malhas anteri-

ormente empregadas. As siglas mostradas nas tabelas 3.4 e 3.5 continuam

a ter o mesmo significado.

5.4 Resultados para o caso 1

Neste caso a permeabilidade é dada por um tensor diagonal e a equa-

ção diferencial da pressão não apresenta o termo fonte. As condições de

contorno deste problema são mostradas na figura 5.1. Percebe-se que

somente no topo do domínio, em y = 1, a pressão prescrita não é nula.
A primeira análise feita é um comparativo dos quatro métodos de

reconstrução do gradiente que se destacaram nos testes realizados no capí-

tulo 3, considerando-se para isto as malhas regulares. Em seguida, para um

mesmo método de reconstrução, as análises da convergência da pressão e

do gradiente são realizadas considerando-se as diferentes malhas mostra-

das no capítulo mencionado. Por fim, uma avaliação da influência da razão

de anisotropia ? é efetuada.

5.4.1 Análise da influência dos métodos de reconstrução

Na figura 5.2 estão apresentados os resultados referentes à conver-

gência dos métodos de reconstrução GGCBW_1S, GGCBW_2S, GGVBPL e

LSSID utilizando-se as malhas regulares. O valor considerado para a razão

de anisotropia é ?= 10.



CA PÍT ULO 5 - R ESULTADO S 123

(0,0) (1,0)

(1,1)(0,1) ( )P sen xp=

P = 0P = 0

P = 0

Domínio  W

Figura 5.1 – Domínio com as condições de contorno do caso 1. Malha
regular.

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 2
1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

 G G C B W _ 1 S
 G G C B W _ 2 S
 G G V B P L
 L S S I D

? p

h

2
1

1
1

Figura 5.2 – Convergência da pressão nas malhas regulares. Caso 1.

Percebe-se na figura 5.2 que os métodos que utilizam a fórmula de

Green-Gauss com abordagem cell-based apresentam convergência similar

entre si e levemente superior que de primeira ordem. A magnitude da

norma do erro da pressão é visivelmente menor naquele com dois passos.



124 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Os outros dois métodos encontrados no gráfico da figura 5.2 se desta-

cam com relação à convergência, ligeiramente superior à segunda ordem,

assim como com relação à própria magnitude do erro. Apesar do método

que utiliza mínimos quadrados apresentar valores da norma do erro um

pouco superiores, principalmente nas malhas mais grosseiras, percebe-se

que a tendência é que estes valores se tornem menores que aqueles obtidos

com GGVBPL.

5.4.2 Análise da influência da geometria das malhas

Considerando especificamente o método LSSID, procura-se analisar

a influência das particularidades geométricas das malhas na convergência

da pressão e do gradiente. Mais uma vez ? apresenta o valor 10.

Infelizmente o esquema numérico adotado para o cálculo dos fluxos

não é suficientemente robusto. A convergência não foi obtida nas malhas

com razão de aspecto alta (RA) e com distorção senoidal (DS). O problema

se encontra no processo iterativo e não nas soluções dos sistemas lineares,

já que estas foram possíveis de serem atingidas. Em virtude do exposto,

os gráficos aqui mostrados apresentam somente os resultados referentes

às malhas regulares (RE), não-conformes (NC) e com distorção aleatória

(DA).

Na figura 5.3 são apresentados os resultados da norma do erro da

pressão nas três malhas citadas anteriomente. A convergência é pratica-

mente de segunda ordem, sendo a inclinação ligeiramente superior nas

malhas RE. Nota-se um incremento um pouco mais acentuado nos valores

da norma do erro considerando as malhas NC. Porém, pode-se afirmar

que as particularidades encontradas nas malhas NC e DA não têm grande

influência nos resultados comparando-se com aqueles obtidos nas malhas

RE.

Na figura 5.4 é feita uma comparação entre os valores de pressão

obtidos com a solução analítica (Pa ) do caso 1 e a solução numérica corres-

pondente (Pnum). A malha analisada é a regular sendo os valores de pressão

correspondentes aos volumes de controle cujos centroides se encontram

na linha média x = 1/2. Percebe-se no gráfico a grande similaridade entre
as soluções analítica e numérica.

Procurou-se também verificar a convergência do gradiente, da mesma

maneira realizada no capítulo 3. Com a solução do campo de pressão

determinada ao fim da simulação aplicou-se novamente o método de re-



CA PÍT ULO 5 - R ESULTADO S 125

2 x 1 0 - 3 1 0 - 2 1 0 - 11 0
- 6

1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

h

? p

 R E
 N C
 D A2

1

1
1

Figura 5.3 – Convergência da pressão considerando LSSID. Caso 1.

0 . 0 0 . 5 1 . 0
0 . 0

0 . 5

1 . 0

 P a
 P n u mP [

Pa
]

y  [ m ]

Figura 5.4 – Comparação entre a pressão obtida com as soluções analítica
e numérica na malha RE com 2232 volumes de controle.

construção LSSID para obter a aproximação numérica do gradiente. Essa

aproximação foi então comparada com o gradiente obtido a partir da solu-

ção analítica.

A diferença com relação aos resultados do capítulo 3 é que agora além

dos erros associados à reconstrução do gradiente se adicionam os erros do

próprio campo de pressão, que não é mais o exato. O gráfico da figura 5.5

mostra os valores da norma do erro do gradiente nas três malhas RE, NC e



126 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

DA.

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 D A

h

? gr
ad

2
1

1
1

Figura 5.5 – Convergência do gradiente considerando LSSID. Caso 1.

Como se pode observar as ordens de convergência obtidas são supe-

riores à unidade, com destaque para as malhas NC.

5.4.3 Análise da influência da razão de anisotropia

Considerando novamente as malhas regulares e o método de recons-

trução LSSID, procura-se verificar agora se diferentes valores da razão de

anisotropia influenciam a convergência da pressão. Situações com valores

deste parâmetro maiores e menores que a unidade são apresentadas nas

figuras a seguir.

Na figura 5.6 variam-se os valores de ? entre 1 e 10000. Um valor

unitário deste parâmetro caracteriza o meio como isotrópico, já um alto

valor indica que o escoamento se dá preferencialmente na direção do eixo

y, pois para esse caso a componente K y y é maior que K x x .

Analisando a figura 5.6 nota-se que ao se aumentar o valor de ?, os

erros não apresentam um comportamento monotônico. Percebe-se que,

para uma dada malha, ao aumentar o valor do parâmetro da razão de 1

para 10 tem-se uma redução do erro e também um aumento na ordem de

convergência, caracterizando assim uma melhora nos resultados. Porém,

ao se aumentar o parâmetro de 100 para 1000 o efeito contrário ocorre.



CA PÍT ULO 5 - R ESULTADO S 127

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 2

1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

 1
 1 0
 1 0 0
 1 0 0 0
 1 0 0 0 0

? p

h

2
1

1
1

Figura 5.6 – Convergência da pressão considerando valores do parâmetro ?
entre 1 e 10000.

Percebe-se na figura 5.6 que um meio anisotrópico, considerando ?

com valores de no máximo 1000, apresenta melhores resultados compa-

rando-se com o caso de um meio isotrópico. Porém, os resultados com

uma mais alta anisotropia passam a se equivaler àquele isotrópico. Vale

destacar que o máximo valor de ? apresentado na figura não é um valor

limitante, sendo possível obter resultados utilizando-se valores maiores

para essa razão.

No gráfico da figura 5.7 são analisados valores de ? unitário e menores

que a unidade. Parte-se de um meio isotrópico até um anisotrópico com

uma razão de anisotropia de 0.001. Valores com uma mais baixa ordem

de grandeza apresentaram resultados em que não há mais a influência do

refino na convergência, isto é, a linha de convergência passa a ser prati-

camente horizontal. Vale destacar que valores do referido parâmetro me-

nores que a unidade caracterizam um meio em que o escoamento ocorre

preferencialmente ao longo do eixo x .

Ao observar o gráfico da figura 5.7 nota-se que existe um comporta-

mento monotônico nos resultados, diferentemente do que ocorre no grá-

fico da figura 5.6. À medida que o meio se torna cada vez mais anisotrópico

os resultados se tornam cada vez menos precisos, até o limite máximo

onde o refino já não é mais sentido.

A fim de verificar se há influência da disposição da malha com relação

às condições de contorno pensou-se em rotacionar o problema original



128 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 21 0
- 5

1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 1
 0 . 1
 0 . 0 1
 0 . 0 0 1? p

h

2
1

1
1

Figura 5.7 – Convergência da pressão considerando valores de ? unitário e
menor que a unidade.

apresentado na figura 5.1 e realizar a mesma análise da variação de ?. Vale

destacar que os problemas original e rotacionado, apesar da nomencla-

tura diferenciada, são idênticos, apresentando o segundo a condição de

contorno senoidal na lateral direita do domínio quadrado (ver figura 5.8).

Logicamente, a análise anteriormente feita com o valor de ? maior que a

unidade será agora realizada com o valor do parâmetro menor que um e

vice e versa. Assim, a situação onde no problema original ?= 10 é a mesma
daquela em que ?= 0.1 no problema rotacionado.

Percebe-se através dos resultados obtidos com o problema rotacio-

nado, mostrados nas figuras 5.9 e 5.10, um comportamento similiar ao

visto no problema original. Em um deles nota-se a influência negativa do

aumento da anisotropia, onde as linhas de convergência tornam-se linhas

horizontais e no outro resultados que não possuem um comportamento

monotônico.

As figuras 5.6 e 5.9, referentes ao problema original e rotacionado

respectivamente, ilustram os resultados de situações idênticas onde o es-

coamento se dá preferencialmente ao longo do eixo perpendicular à fron-

teira com condição de contorno senoidal. Apesar da semelhança visível

percebe-se que com o problema rotacionado os valores da norma do erro

são menores.

Analisando agora as figuras 5.7 referente ao problema original e 5.10

ao rotacionado, percebe-se que o aumento da anisotropia torna os resul-



CA PÍT ULO 5 - R ESULTADO S 129

(0,0) (1,0)

(1,1)(0,1)

( )P sen yp=

P = 0

P = 0

P = 0

Domínio  W

Figura 5.8 – Problema rotacionado. Domínio discretizado com a malha
regular.

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 2

1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

 1
 0 . 1
 0 . 0 1
 0 . 0 0 1
 0 . 0 0 0 1

? p

h

2
1

1
1

Figura 5.9 – Convergência da pressão considerando valores de ? entre 1 e
0.0001. Problema rotacionado.

tados cada vez mais distantes dos valores exatos. Novamente esses re-

sultados, considerando situações idênticas, não são exatamente iguais. O

segundo gráfico apresenta somente valores até ?= 100 pois valores supe-
riores fazem com que as normas do erro não diminuam com o refino da

malha.



130 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 21 0
- 5

1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

1 0 0

 1
 1 0
 1 0 0?

p

h

2
1

1
1

Figura 5.10 – Convergência da pressão considerando valores de ? entre 1 e
100. Problema rotacionado.

A partir das análises feitas conclui-se que os resultados não estão

sendo influenciados de maneira substancial pela disposição da malha re-

gular com relação às condições de contorno do problema. Mesmo os valo-

res da norma do erro não sendo exatamente iguais ao se considerar situa-

ções idênticas, o comportamento dos resultados é o mesmo.

5.4.4 Comentários

Na seção referente à análise das malhas comentou-se que resultados

não foram obtidos naquelas com distorção senoidal e com razão de as-

pecto alta. O método de reconstrução explícita do gradiente utilizado foi o

LSSID em conjunto com o valor de ?= 10.
Como o método iterativo ponto a ponto de Gauss-Seidel é utilizado

para solucionar os sistemas lineares de equações, o principal requesito

para sua convergência é a dominância diagonal da matriz dos coeficientes.

Aplicando o critério de Scarborough encontrado em [25], que estipula a
condição suficiente para a convergência de um método iterativo ponto a

ponto, verificou-se que as matrizes dos coeficientes geradas nas malhas

DS e RA satisfazem tal critério. O fato de que durante o processo iterativo

as soluções dos sistemas lineares foram obtidas confirma o exposto.

A impossibilidade em obter soluções numéricas ao se analisar as ma-

lhas DS e RA pode estar relacionada com a grande importância do termo



CA PÍT ULO 5 - R ESULTADO S 131

explícito na equação do fluxo. Em virtude disso, um novo esquema numé-

rico empregando uma formulação totalmente implícita foi implementado

no conjunto de bibliotecas Orion. O fluxo neste novo esquema é deter-

minado considerando-se os valores de pressões atuais, sendo assim, por

exemplo, a derivada (?y P)?p aparente na equação (4.21) não é mais um valor
já conhecido. Essa derivada parcial é determinada agora considerando o

princípio dos métodos que empregam mínimos quadrados, necessitando

das pressões atuais localizadas nos volumes de controle vizinhos ao anali-

sado, pressões estas que são incógnitas do sistema. Com isso, a equação do

fluxo de massa (4.24) além de levar em consideração os volumes p e n, tam-

bém envolve os vizinhos desses volumes, portanto, o método totalmente

implícito possui um estêncil com dois níveis de vizinhança. Ao se con-

siderar um volume de controle central da malha regular, por exemplo, um

estêncil três vezes maior é necessário neste novo esquema. A consequência

do emprego do esquema totalmente implícito é um aumento considerável

da quantidade de termos não-nulos na matriz do sistema linear.

A figura 5.11 apresenta os resultados da norma do erro da pressão

nas malhas DS e RA utilizando-se o método totalmente implícito e con-

siderando ? = 10. Ela vem a confirmar o exposto no parágrafo anterior
já que agora a convergência é obtida. Os resultados são muito similares,

convergência de aproximadamente segunda ordem, verificando-se que o

esquema é insensível às particularidades das malhas.

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 21 0
- 5

1 0 - 4

1 0 - 3

1 0 - 2

 R A
 D S? p

h

2
1

1
1

Figura 5.11 – Convergência da pressão considerando o esquema total-
mente implícito nas malhas DS e RA.



132 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

Conclui-se então que o esquema numérico para obtenção dos fluxos

através das faces das malhas poligonais apresentado neste trabalho con-

tém um ponto que deve ser analisado com mais cuidado. Este ponto-chave

é o termo explícito que está afetando a convergência da solução numérica

em alguns casos. É portanto necessário fazer um estudo mais aprofundado

dos seus parâmetros dando uma atenção especial à transformação local de

coordenadas que pode vir a alterá-los.

5.5 Resultados para o caso 2

Neste segundo caso a permeabilidade é dada pelo tensor cheio espe-

cificado na tabela 5.1. Os autovalores desse tensor são 1 e 2, enquanto que

suas direções principais estão rotacionadas 45o em relação aos eixos carte-

sianos. No referido caso utilizou-se a técnica das soluções manufaturadas

[18] onde se propõe a solução exata da equação diferencial e através de
diferenciação obtém-se a expressão do termo fonte associado.

Conforme mostrado na figura 5.12, no caso 2 a pressão é nula em todo

o contorno do domínio.

(0,0) (1,0)

(1,1)(0,1)

P = 0P = 0

P = 0

Domínio  W

P = 0

Figura 5.12 – Domínio físico com as condições de contorno do caso 2.

As análises feitas seguem a mesma ideia daquelas apresentadas para

o caso 1. Primeiramente apresentam-se os valores da norma do erro da



CA PÍT ULO 5 - R ESULTADO S 133

pressão utilizando-se os mesmos quatro métodos de reconstrução explí-

cita do gradiente aplicados nas malhas regulares. A seguir, utilizando-se

um desses métodos variam-se as malhas com o intuito de determinar as

normas do erro da pressão e do gradiente.

5.5.1 Análise da influência dos métodos de reconstrução

Na figura 5.13 encontram-se expostos os valores das normas do erro

considerando os métodos GGCBW_1S, GGCBW_2S, GGVBPL e LSSID nas

malhas regulares.

Nota-se que para este caso levemente anisotrópico os quatro méto-

dos apresentam resultados muito similares. A convergência é de apro-

ximadamente segunda ordem em todos os métodos podendo-se afirmar

que apesar de GGCBW_2S apresentar resultados levemente melhores, o

desempenho dos quatro métodos é praticamente o mesmo. Uma vez que

os resultados da figura 5.13 foram obtidos com malhas regulares, deve-

se verificar se o mesmo ocorre com malhas apresentando algum tipo de

distorção.

1 0 - 2 3 x 1 0 - 2 5 x 1 0 - 2 7 x 1 0 - 21 0
- 5

1 0 - 4

1 0 - 3

1 0 - 2

 G G C B W _ 1 S
 G G C B W _ 2 S
 G G V B P L
 L S S I D?

p

h

2
1

1
1

Figura 5.13 – Convergência da pressão nas malhas regulares. Caso 2.

5.5.2 Análise da influência da geometria das malhas

Como os resultados dos quatro métodos apresentaram-se muito si-

milares nas malhas regulares, repetiu-se o experimento numérico nas de-



134 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

mais malhas. Constatou-se que com nenhum dos métodos obteve-se a

convergência no processo iterativo ao se empregar as malhas DS e RA.

Para aqueles que utilizam a fórmula de Green-Gauss com abordagem cell-

based, nas malhas DA não se obteve uma redução consistente do erro.

Os métodos GGVBPL e LSSID produziram resultados aceitáveis nas

malhas RE, NC e DA. Na figura 5.14 mostra-se o comportamento da norma

do erro da pressão empregando este último método.

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

? p

h

 R E
 N C
 D A2

1

1
1

Figura 5.14 – Convergência da pressão nas malhas RE, NC e DA. Método
LSSID, caso 2.

Nota-se uma grande similaridade nos resultados, sendo que nas ma-

lhas NC o erro é levemente maior e a ordem de convergência levemente

inferior. Assim, independentemente das particularidades das malhas o

esquema numérico consegue tratá-las. Vale destacar que para o caso 2 a

ordem de convergência é aproximadamente 2 nas três malhas apresenta-

das.

Na figura 5.15 mostra-se o comportamento da norma do erro do gra-

diente. Percebe-se que o comportamento do erro é melhor nas malhas

regulares, seja com relação ao valor da ordem de convergência ou à própria

magnitude do erro. As ordens de convergência apresentam valores em

torno de 1.5.



CA PÍT ULO 5 - R ESULTADO S 135

2 x 1 0 - 3 1 0 - 2 1 0 - 1
1 0 - 5

1 0 - 4

1 0 - 3

1 0 - 2

1 0 - 1

 R E
 N C
 D A? gr

ad

h

2
1

1
1

Figura 5.15 – Convergência do gradiente de pressão nas malhas RE, NC e
DA. Método de reconstrução LSSID, caso 2.





CAPÍTULO

6
CO N C LU S ÃO

Este trabalho teve como objetivo principal comparar diferentes meto-

dologias para reconstrução do gradiente em malhas poligonais. No longo

prazo, pela generalidade desse tipo de malhas, espera-se que malhas poli-

gonais e poliédricas possam ser empregadas na discretização de regiões

de geometria intrincada. O presente trabalho contribuiu na fase inicial

de um projeto de P&amp;amp;D em desenvolvimento no laboratório SINMEC, cujo

objetivo final é aplicação do tipo de malhas poligonais e poliédricas para a

discretização de regiões de transição em reservatórios de petróleo.

Métodos de reconstrução explícita do gradiente foram descritos e ana-

lisados com o intuito de se determinar quais seriam os mais adequados

para uma aplicação na discretização de um modelo de escoamento em

reservatórios. Com base em uma série de experimentos numéricos, o de-

sempenho dos diferentes métodos considerados foi analisado sob a ótica

da precisão e do tempo de computação demandado. Para tanto, verificou-

se como o erro de truncamento nas aproximações se reduz e como o tempo

computacional aumenta à medida que as malhas são refinadas. Após ana-

lisar os métodos de reconstrução do gradiente, foi descrita uma estratégia

para aplicar esses métodos na discretização dos termos de fluxo nas equa-

ções de conservação. Essa estratégia consiste na aproximação do fluxo em

uma face considerando uma parcela implícita, envolvendo os valores de

pressão nos dois volumes adjacentes à face, e uma parcela explícita que

leva em conta a denominada difusão cruzada. Essa parcela explícita de-

pende dos valores do gradiente aproximados com algum dos métodos de

137



138 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

reconstrução descritos previamente. Alguns resultados obtidos aplicando

essa estratégia à discretização de uma modelo de escoamento monofásico

foram apresentados também neste trabalho.

6.1 Principais conclusões

A bateria de testes realizados com os métodos de reconstrução explí-

cita do gradiente de pressão possibilitou analisar o comportamento destes

em diferentes situações. Seus pontos fortes e suas deficiências puderam

ser evidenciados tanto com relação à precisão na aproximação do gradi-

ente bem como com relação ao tempo de computação associado.

Os métodos de reconstrução que se destacaram foram aqueles que,

apesar de apresentarem um tempo de execução igual ou levemente su-

perior aos demais, compensaram tal fato com resultados numéricos mais

precisos e apresentando maior robustez. Dentre eles, o método de Green-

Gauss com abordagem vertex-based aplicando o procedimento do pseu-

dolaplaciano (GGVBPL) e o método que aplica mínimos quadrados (LS-

SID) mostraram que podem fornecer aproximações mais precisas, inclu-

sive quando as malhas apresentam distorções geométricas importantes. A

expectativa em encontrar bons resultados neste último se confirmou já que

segundo seu princípio a geometria dos volumes de controle não é levada

em consideração.

Já o esquema numérico proposto para a aproximação dos fluxos nas

faces dos volumes de controle das malhas poligonais não se mostrou su-

ficientemente robusto. Não foi possível obter soluções numéricas com

algumas malhas testadas. Constatou-se que quando a parcela explícita é

maior que a parcela implícita em algumas faces da malha a convergên-

cia do processo iterativo é prejudicada, ou inclusive impossibilitada em

alguns casos com níveis de anisotropia altos. Um estudo mais detalhado

a respeito da estratégia de aproximação dos fluxos deve ser realizado a fim

de determinar maneiras para contornar tal anomalia. A forma pela qual

é realizada a transformação local de coordenadas em cada face pode ser

a questão-chave que determina a robustez do esquema numérico. Alguns

progressos nesse aspecto já foram alcançados no projeto de P&amp;amp;D comen-

tado, durante o período em que esta dissertação foi redigida.

Os princípios que norteiam os métodos de reconstrução do gradiente

podem ser empregados em outros esquemas numéricos até mesmo em



CA PÍT ULO 6 - CO NCLU SÃO 139

um que aproxima os fluxos de forma totalmente implícita. Sendo assim,

a implementação computacional dos métodos de reconstrução não limita

seu uso a apenas o esquema numérico descrito neste trabalho. Com o

referido esquema totalmente implícito foi possível obter resultados em

malhas cuja anisotropia estava influenciando negativamente a convergên-

cia ao se empregar o esquema proposto neste trabalho. Este fato poderia

induzir o abandono do esquema com a parcela explícita, contudo, deve-

se ressaltar que o esquema totalmente implícito aumenta consideravel-

mente o estêncil associado à equação de conservação discretizada para um

volume de controle. Isto pode tornar mais difícil a solução dos sistemas

lineares com métodos iterativos e aumenta consideravelmente a demanda

de memória para executar o código associado. Essas dificuldades podem

ser contornadas de alguma forma em problemas bidimensionais, contudo,

em casos tridimensionais a situação seria mais crítica pois o número de

vizinhos de um volume poliédrico aumenta consideravelmente.

Como sugestões para trabalhos futuros, além da análise mais criteri-

osa da aproximação dos fluxos nas faces já comentada, seria interessante:

considerar problemas cujas condições de contorno nas fronteiras são de

Neumann, mais especificamente de fluxo nulo já que esta é a condição

normalmente utilizada em reservatórios, realizar um estudo mais deta-

lhado do processo iterativo com o objetivo de reduzir o tempo compu-

tacional para a solução do problema e por fim realizar um estudo mais

detalhado dos métodos de reconstrução para que eles sejam capazes de

tratar uma possível heterogeneidade no meio.





R E F E R Ê N C I A S

[1] AHMED, T. Reservoir engineering handbook, third edition. Elsevier
Inc., 2006.

[2] AMBRUS, J. Volumes finitos utilizando aproximações de múltiplos
pontos aplicados à simulação numérica de reservatórios de petróleo.
Dissertação de mestrado, Departamento de Engenharia Mecânica, Uni-

versidade Federal de Santa Catarina, Florianópolis, 2009.

[3] ANSYS INC. ANSYS FLUENT 12.0 Theory Guide, 2009.

[4] ANSYS INC. ANSYS FLUENT 12.0 User´s Guide, 2009.

[5] ANSYS INC. ANSYS ICEM CFD 12.0 Tutorial Manual, 2009.

[6] AZIZ, K.; SETTARI, A. Petroleum reservoir simulation. Applied
Science Publishers LTD, 1979.

[7] BENNIS, C.; BOROUCHAKI, H.; FLANDRIN, N. 3D conforming power
diagrams for radial LGR in CPG reservoir grids. Engineering with
Computers, v. 24, pp. 253–265, 2008.

[8] BOOST. Boost C++ Libraries. http://www.boost.org , 2012.

[9] BORISENKO, A.; TARAPOV, I. Vector and tensor analysis with applica-
tions, revised english edition. Dover Publications Inc., 1979.

[10] BREZZI, F.; LIPNIKOV, K.; SHASHKOV, M.; SIMONCINI, V. A new
discretization methodology for diffusion problems on generalized
polyhedral meshes. Computer Methods in Applied Mechanics and
Engineering , pp. v. 196, pp. 3682–3692, 2007.

[11] CEI INC. Ensight User Manual, 2009.

[12] CRAFT, B.; HAWKINS, M. Applied petroleum reservoir engineering,
second edition. Prentice-Hall Inc., 1991.

141



142 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

[13] DEMMEL, J. W. Applied numerical linear algebra. Society for
Industrial an Applied Mathematics, Berkeley, California, 1997.

[14] GESSNER, T.; LIM, C. K.; POTDAR, S. A strategy to convert unstruc-
tures meshes into polyhedra meshes. Ansys Inc., 2006.

[15] GOLUB, G.; LOAN, C. Matrix computations, third edition. The Johns
Hopkins University Press, Baltimore, 1996.

[16] HOLMES, D. G.; CONNELL, S. D. Solution of the 2D Navier–Stokes
equations on unstructured adaptive grids. Proceedings of the AIAA
9th Computational Fluid Dynamics Conference, Buffalo, USA, pp. 25–39,

1989.

[17] HURTADO, F. S. V. Uma formulação de volumes finitos baseada em
elementos para a simulação do deslocamento bifásico imiscível em
meios porosos. Dissertação de mestrado, Departamento de Engenharia
Mecânica, Universidade Federal de Santa Catarina, Florianópolis, 2005.

[18] HURTADO, F. S. V. Formulação tridimensional de volumes fi-
nitos para solução de reservatórios de petróleo com malhas não-
estruturadas híbridas. Tese de doutorado, Departamento de Engenha-
ria Mecânica, Universidade Federal de Santa Catarina, Florianópolis,

2011.

[19] JAWAHAR, P.; KAMATH, H. A high-resolution procedure for Euler
and Navier-Stokes computations on unstructured grids. Journal of
Computational Physics, v. 164, pp. 165–203, 2000.

[20] JAYANTA, P. A.; TURNER, I. W. A comparison of gradient appro-
ximations for use in finite-volume computational models for two-
dimensional diffusion equations. 2001.

[21] KELECY, F. J. Using polyhedral cells in Fluent 6.3. Ansys Inc., 2006.

[22] KUMAR, M.; DUFFY, C.; SALVAGE, K. A second-order accurate, finite
volume-based, integrated hydrologic modeling (FIHM) framework for
simulation of surface and subsurface flow. Vadose Zone, v. 8, n. 4,
pp. 873–890, November, 2009.

[23] LEE, H.; JEONG, J. J.; CHO, H. K.; YOON, H. Y. An improved numerical
scheme to evaluate the pressure gradient on unstructured meshes for



R EFER ÊNCIA S 143

two-phase flow analysis. International Communications in Heat and
Mass Transfer, v. 37, pp. 1273–1279, 2010.

[24] LEVEQUE, R. J. Finite-volume methods for hyperbolic problems.
Cambridge University Press, Cambridge, UK, 2002.

[25] MALISKA, C. R. Transferência de calor e mecânica dos fluido com-
putacional. 2a edição. LTC Editora, Rio de Janeiro, Brasil, 2004.

[26] MALISKA, C. R.; SILVA, A. F. C.; TADA, M. P.; KARPINSKI, L.; SOPRANO,
A. B.; PESCADOR, A. V. B.; RIBEIRO, G. G.; MAGRI, V. A. P. Desenvol-
vimento de um aplicativo para a simulação do escoamento acoplado
poço-reservatório ( WellRes). Relatório Final UFSC-0050, Laboratório
SINMEC/UFSC, Florianópolis, Brasil, 2012.

[27] MALISKA, C. R.; SILVA, A. F. C.; HURTADO, F. S. V.; PESCADOR,
A. V. B.; RIBEIRO, G. G.; GREIN, E. A.; CERBATO, G. Introdução às
malhas poliédricas e ao método baseado na reconstrução explícita
do gradiente. Relatório técnico SINMEC/SIGER II-01, Laboratório
SINMEC/UFSC, Florianópolis, Brasil, 2012.

[28] MALISKA, C. R.; SILVA, A. F. C.; HURTADO, F. S. V.; PESCADOR, A. V. B.;
RIBEIRO, G. G.; CERBATO, G.; GREIN, E. A. Simulação de reservatórios
de petróleo pelo método EbFVM com solver multigrid (SIMREP). Re-
latório técnico no 7, Laboratório SINMEC/UFSC, Florianópolis, Brasil,
2011.

[29] MALISKA, C. R.; SILVA, A. F. C.; HURTADO, F. S. V.; DONATTI, C. N.;
PESCADOR, A. V. B. Simulação de reservatórios de petróleo pelo
método EbFVM com solver multigrid (SIMREP). Relatório técnico no

4, Laboratório SINMEC/UFSC, Florianópolis, Brasil, 2009.

[30] MATHUR, S. R.; MURTHY, J. Y. A pressure-based method for uns-
tructured meshes. Numerical Heat Transfer, Part B, v. 31, pp. 195–215,
1997.

[31] MOUNTON, T.; BENNIS, C.; BOROUCHAKI, H. Hybrid mesh genera-
tion for reservoir flow simulation in CPG grids. Proceedings of the 18th
International Meshing Roundtable, 2009.

[32] ORIGIN LAB CORPORATION. Origin 8 User Guide, 2007.



144 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

[33] PAPANASTASIOU, T. C.; GEORGIOU, G. C.; ALEXANDROU, A. N.
Viscous fluid flow. CRC Press LLC, 2000.

[34] ROSA, A. J.; CARVALHO, R. S.; XAVIER, J. A. D. Engenharia de
reservatórios de petróleo. Editora Interciência, Rio de Janeiro, 2006.

[35] STANDARDS, N. I. O.; TECHNOLOGY. TNT - Template numerical
toolkit. http://math.nist.gov/tnt/documentation.html, 2004.

[36] STRANG, G. Linear algebra and its applications, third edition.
Harcourt Brace Jovanovich College, San Diego, USA, 1988.

[37] TADA, M. P. Análise de esquemas numéricos de cinco e nove pontos
para malhas tipo corner-point. Dissertação de mestrado, Departa-
mento de Engenharia Mecânica, Universidade Federal de Santa Cata-

rina, Florianópolis, 2009.

[38] THOMAS, J. L.; DISKIN, B.; RUMSEY, C. Towards verification of
unstructured-grid solvers. American Institute of Aeronautics and As-
tronautics, Paper AIAA 2008-666, 2008.



APÊNDICE

A
D E D U ÇÕ E S R E L AT I VA S AO

P RO C E D I M E N TO D O

P S E U D O L A P L AC I A N O

O procedimento do pseudoplaciano tem como objetivo determinar

valores dos fatores de ponderação para a aproximação da pressão nos vér-

tices da malha, de modo que tal aproximação possua precisão de segunda

ordem. A figura A.1 ilustra os elementos geométricos relacionados ao pro-

cedimento, sendo r v o vetor posição do vértice considerado e r pk o vetor
posição do centroide de um volume de controle adjacente ao vértice. As

coordenadas cartesianas do vetor r v serão representadas por x v e y v, en-
quanto as coordenadas cartesianas do vetor posição r pk serão representa-
das por x pk e y pk .

A.1 Condição de pseudolaplaciano nulo

A dedução da condição de pseudolaplaciano nulo apresentada a se-

guir segue os passos descritos em [27].
O valor de pressão em um ponto próximo a um vértice da malha pode

ser obtido utilizando-se uma expansão em série de Taylor em torno de v,

145



146 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

1p
2p

v

3p

vr-rp1 vr-rp2

vr-rp3

Figura A.1 – Elementos geométricos envolvidos no procedimento de pseu-
dolaplaciano.

conforme equação abaixo

P = P?v +(?P?)v ·(r?r v)+O (|r?r v|2) (A.1)

sendo P?v e (?P?)v os valores exatos da pressão e do seu gradiente no vér-
tice analisado. Considerando que os centroides dos volumes de controle

circundantes estão suficientemente próximos a tal vértice, a equação an-

terior pode ser particularizada para cada um desses centroides, resultando

a expressão

Ppk = P?v +(?P?)v ·(r pk ?r v)+O (|r pk ?r v|
2) (A.2)

O termo referente à aproximação de segunda ordem leva em consi-

deração a distância entre o centroide do volume de controle e o vértice

em questão. Considera-se aqui que as dimensões dos volumes de controle

da malha podem ser caracterizadas por um comprimento característico

h e que a distância entre o centroide do volume de controle e o vértice

em questão é proporcional a tal comprimento. Com isso, o erro de trun-

camento 1 da aproximação numérica apresentada na equação (A.2) é de

segunda ordem, sendo proporcional a h 2.

Ao somar as equações equivalentes à equação (A.2), correspondentes

1 Os erros de truncamento devem tender a zero quando a malha tender a possuir um
número infinito de pontos [25].



A PÊNDIC E A – DEDUÇÕ ES R EL AT IVA S AO P RO CEDIM EN TO DO PSEUDO L A PL ACI AN O 147

a todos os volumes de controle cercando um vértice, multiplicadas pelos

respectivos fatores de ponderação, obtém-se a seguinte expressão

Nv
?

k=1

w k Ppk = P?v
Nv
?

k=1

w k +
Nv
?

k=1

w k(?P?)v ·(r pk ?r v)+O (h
2) (A.3)

sendo a ordem de aproximação ainda proporcional a h 2, pois este termo

independe de w k .

A operação anterior foi feita com o intuito de estimar a ordem do

erro associado à aproximação realizada na equação (2.20), utilizada para

se encontrar os valores de pressão nos vértices. Tal equação é aqui repetida

por clareza

Pv =

Nv
?

k=1

w k Ppk

Nv
?

k=1

w k

(A.4)

Percebe-se que o primeiro termo da equação (A.3) é exatamente o nu-

merador encontrado no lado direito da equação (A.4). Assim, substituindo-

se a primeira equação na segunda encontra-se

Pv = P?v +

Nv
?

k=1

w k(?P?)v ·(r pk ?r v)

Nv
?

k=1

w k

+O (h 2) (A.5)

sendo Pv e P?v, respectivamente, o valor de pressão aproximado e o valor

de pressão exato. A diferença entre eles, o erro, apresenta em geral uma

aproximação de primeira ordem, já que o vetor diferença (r pk ? r v) é pro-
porcional a h .

A situação ideal seria que a aproximação considerada tivesse erro de

segunda ordem. A equação (A.5) mostra que isso aconteceria se o segundo

termo no lado direito se anulasse. A condição suficiente para tanto é que

Nv
?

k=1

w k(?P?)v ·(r pk ?r v)= 0 (A.6)



148 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

De acordo com as propriedades do produto escalar, a expressão ante-

rior pode ser escrita na forma equivalente

(?P?)v ·
Nv
?

k=1

w k(r pk ?r v)= 0 (A.7)

A igualdade anterior é satisfeita se

Nv
?

k=1

w k(r pk ?rv)= 0 (A.8)

A última expressão apresentada é exatamente a condição conhecida

na literatura como condição de pseudolaplaciano nulo. Com ela pode-se

determinar quais valores de w k fazem com que a aproximação dos valores

nos vértices seja de segunda ordem.

A.2 Obtenção dos fatores de ponderação

Um problema de minimização sujeito a restrições pode ser resolvido

através do método dos multiplicadores de Lagrange [15]. O referido mé-
todo foi utilizado em [22] com o mesmo objetivo aqui apresentado, deter-
minar os desvios dos fatores peso associados a cada volume de controle

pk .

A ideia do método de Lagrange é gerar uma nova função a ser mini-

mizada incluindo as restrições impostas. Esta nova função é abaixo apre-

sentada

F(?w k ,?x ,?y )=
Nv
?

k=1

?w k
2 ??x

Nv
?

k=1

(1+?w k)(x pk ?x v)

??y
Nv
?

k=1

(1+?w k)(y pk ?y v) (A.9)

onde ?x e ?y são os multiplicadores de Lagrange. Eles multiplicam as

restrições escritas na forma escalar, estabelecidas nas equações (2.23) e

(2.24).

Considerando as condições de extremo da função definida na equa-

ção (A.9), surge o seguinte sistema de equações



A PÊNDIC E A – DEDUÇÕ ES R EL AT IVA S AO P RO CEDIM EN TO DO PSEUDO L A PL ACI AN O 149

?F

??w k
= 2?w k ??x(x pk ?x v)??y (y pk ?y v)= 0 (A.10)

?F

??x
=?

Nv
?

k=1

(1+?w k)(x pk ?x v)= 0 (A.11)

?F

??y
=?

Nv
?

k=1

(1+?w k)(y pk ?y v)= 0 (A.12)

O referido sistema é formado por Nv equações, correspondentes às

Nv incógnitas ?w k , mais duas relacionadas aos multiplicadores de La-
grange, conseguindo-se agora obter o mesmo número de incógnitas e de

equações. Vale lembrar que Nv representa o número de volumes de con-

trole que cercam um dado vértice e seu valor é normalmente três para as

malhas analisadas.

Isolando-se ?w k na equação (A.10) tem-se

?w k =
?x?x pk +?y ?y pk

2
(A.13)

sendo

?x pk =x pk ?x v
(A.14)

?y pk = y pk ?y v

O próximo passo é dado ao substituir a equação (A.13) nas equações

(A.11) e (A.12). São encontrados assim os valores dos multiplicadores de

Lagrange

?x =
2(I x y Ry ? I y y Rx)

I x x I y y ? I x y 2
(A.15)

?y =
2(I x y Rx ? I x x Ry )

I x x I y y ? I x y 2
(A.16)



150 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

onde

I x x =
Nv
?

k=1

?x 2pk

I y y =
Nv
?

k=1

?y 2pk

(A.17)

I x y =
Nv
?

k=1

?x pk ?y pk

Rx =
Nv
?

k=1

?x pk

Ry =
Nv
?

k=1

?y pk

Obtidos os referidos valores, retorna-se para a equação (A.13), obtendo-

se então o valor de cada ?w k

?w k =
I x y Ry ? I y y Rx
I x x I y y ? I x y 2

(?x pk )+
I x y Rx ? I x x Ry
I x x I y y ? I x y 2

(?y pk ) (A.18)

Assim, o valor do fator peso associado a um volume de controle cer-

cando o dado vértice é finalmente dado por

w k = 1+
I x y Ry ? I y y Rx
I x x I y y ? I x y 2

(?x pk )+
I x y Rx ? I x x Ry
I x x I y y ? I x y 2

(?y pk ) (A.19)



APÊNDICE

B
C A S O E S PE C I A L D A R E G R A D O

P O N TO M É D I O

O objetivo aqui é demonstrar que para uma função linear a seguinte

igualdade é satisfeita identicamente

?

?Sf

? dS =?f?Sf (B.1)

De uma maneira mais específica, o que se pretende provar é que

não há aproximação ao se empregar a regra o ponto médio na integral de

superfície acima, na situação em que ? é uma função linear.

Considerando uma face do volume de controle como sendo uma su-

perfície plana, o vetor área desta pode ser escrito de acordo com o vetor

unitário n? normal à sua superfície. Sendo assim, a integral acima pode ser
escrita por

?

?Sf

? dS =

?

?Sf

? n? dS = n?

?

?Sf

?dS (B.2)

já que n? é constante na superfície em questão.
Escrevendo ? como uma função linear da seguinte forma

?= a x +b y +c (B.3)

151



152 GI OVAN I C ER BATO - DISSERTAÇÃO DE M ES T R A DO

com a , b , c constantes, a última integral da equação (B.2) pode ser assim

apresentada

?

?Sf

?dS = a

?

?Sf

x dS+b

?

?Sf

y dS+c ?Sf (B.4)

De acordo com a definição de centroide de superfícies planas tem-se

que
?

?Sf

x dS =x f ?Sf (B.5)

?

?Sf

y dS = yf ?Sf (B.6)

sendo x f e yf as coordenadas do centroide f da superfície conforme figura

abaixo.

x

y

yf

xf

f

fSD

Figura B.1 – Superfície plana com representação das coordenadas de seu
centroide.

Aplicando as equações (B.5) e (B.6) na equação (B.4) tem-se

?

?Sf

?dS =(a x f +b yf +c)?Sf =?f?Sf (B.7)

Substituindo a equação anterior na equação (B.2), obtém-se

?

?Sf

? dS = n??f?Sf =?f n??Sf (B.8)

e como ?Sf = n? ?Sf, o apresentado na equação (B.1) é finalmente provado.


</field>
	</doc>
</add>