<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20538</field>
		<field name="filename">4115_Vidal_JoseOliveira_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA DE CAMPINAS
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada A
Faculdade de Engenharia de Campinas
Como Requisito Parcial A ObtençAo do
Titulo de Mestre em Engenharia de Petróleo
ANÁLISE AUTOMATIZADA DE TESTES DE PRESSÃO EM
POÇOS
NAO SURGENTES

Se	o-
^\KD.^aclMO~	^0/03/Sc?t -


U- -
AUTOR
í
J
José Oliveira Vidal

ORIENTADOR
Antônio Cláudio de França Corrêa
Março. 1089
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA DE CAMPINAS
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação "Análise Automatizada de testes de pressão em poços não surgentes", elaborada por José 01 i veir a Vi dal e apr ovada por todos os membr os da Banca Examinadora foi aceita pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial à obtenção do Título de Mestre em Engenharia de Petróleo
Campinas, 20 de março de 1989
Banca Examinadora
Maria Cristina Cunha Bezerra, Ph, D.
Para meus familiares
Para minha esposa
Roseane
Par a mi nha f i1ha
Cecília
ií
AGRADECIMENTOS
Agradeço ao Centro de Engenharia de Petróleo da Universidade Estadual de Campinas pela disposição durante a execução deste trabalho.
Aos meus pais, Oscar e Maria, pela educação recebida.
Ao meu orientador. Prof. Antônio Cláudio de F. Corrêa, pela ajuda, compreensão e determinação em todas as etapas da tese.
Aos professores José Martinez, Maria Cristina e Martin Tygel do I. M.E.C. C/UNICAMP e ao prof. Secundino da Faculdade de Engenhar ia Elétr ica/UNICAMP pelos eselareei mentos imprescindíveis neste estudo.
A todos aqueles, inclusive aos amigos da PETROBRAS, que de alguma forma contribuiram para a realização desta tarefa.
Sumário
Agradecimentos ........................................... iií
Sumário................................................     iv
Lista de figuras ............................*............ vii
Lista de tabelas ........................................   tx
Resumo....................................................  xi
Abstract.........................................    .	xii
1.	Introdução..................-..........................   1
1.1	Histórico da análise de teste de formação ............ £
1.2	Histórico da análise automatizada de teste ....	5
1.3	Objetivo e metodologia .............................. 6
2.	Modelo matemático do problema de DST .................... 7
2.1	Equaçdes dimensionais ................................ 8
2. 2 EquaçSes normalizadas ...........................    10
3.	SoluçSes das equaçSes para poços não surgentes ...	12
3.1	As equaçóes governantes ............................  12
3.1.1	Solução para o periodo de fluxo................. 13
3.1.2	Solução para o problema de DST................. 14
4.	Estimativa dos parâmetros por regressão ................ 17
4.1	Escolha do método de estimativa ....................  18
4.2	Problema de	quadrados	mínimos	não lineares ....	19
4.	2.1 Método	de	Newton.............................. 20
4.	2. 2 Método	de	Gouss-.............................. 20
4. 2. 3 Método	de	¿.evember^-Aíorqxtózrdí. ........... 21
4.3	Justificativa teórica do método ................     22
6.	Interpretação automatizada com dados simulados....	26
5.	1 No f 1 uxo por di f er enças f i ni tas ............ 26
5.1.1	Discussão do método e resultados  .............. 27
6.2	No fluxo por inversão numérica.....................  28
5.2.1	Discussão do método e resultados.........	30
5.3	Na estática por inversSo numérica .................. 35
5.3.1	Métodos de solução da integral ...............  36
5.3.2	Aplicação do método .........................  40
5.	3. 2. 1 Discussão do método e resultado . . .	42
5.4	Nos períodos de fluxo e estática.................... 43
5.4.1	Aplicação do método ........................... 45
5.	4. 2 Discussão e novas propostas . ..............  47
6.	Interpretação automatizada em dados reais ............. 51
6.1	Poços de alta produtividade......................... 51
6.1.1	Discussão dos resultados ....................   55
6.1.2	Nova proposta...............................   55
6.1.3	Uso de pesos diferenciados .................   56
6.1.4	Outros exemplos..............................  58
6.2	Poços de baixa produtividade....................... 63
6.2.1	Discussão dos resultados ...................... 67
6.2.2	Retirando pontos da estática ................. 62
6.3	Análise estatística da regressão .................. 70
7.	Otimização no DST por diferenças finitas........	72
7.1	Uso em dados simulados ...........................   73
7.	2 Uso em dados reais .  ...........................   78
7.2. 1 Outros exemplos .............................  83
7.2.2	Discussão do método .......................... 84
8.	Conclusão e Recomendação..............................  26
8.1	Conclusões .......................................   86
8.2	Recomendações ....................................  88
9.	Monencl atura........................................   89
10.	Referência bibliográfica.............................. 93
Apêndice A
Solução da equação do "51 ug Test" dimensionalizada ..	96
Apêndice B
Derivação do "Slug Test" em relação aos parâmetros ..	98
Caso "skin" positivo..................................   98
Caso "skin” negativo ..................................   100
Apêndice C
Solução do problema do DST em forma dimensional ......... 103
Apêndice D
Derivação do DST em relação aos parâmetros............... 105
Caso "skin" positivo................................    105
Caso “skin" negativo................................... 100
Apêndice E
Alternativas de solução da integral do DST..............  114
Apêndice F
Solução do problema do DST por diferenças finitas ...	122
Apêndice G
Listagens dos programas de otimização...................  126
&lt;3.1 No fluxo por diferenças finitas para cálculo
de k &gt; S, p e C, ................................. 127
G. 2 No fluxo por inversSo numérica para cálculo de
kf S, e p	131
o
G.3 Na estática por inversão numérica para cálculo
de k, S e p.....................................   134
L
G.4 Em um ciclo por inversão numérica para cálculo
de L £» p. e p ................................... 144
V	o
Apêndice H
Listagem do programa gerador de dados de pressão ....	175
Apêndi ce I
Listagem do programa de otimização por diferenças
finitas..............................................     183
Lista de figuras
Pácti na
Figura	3.1	Função degrau
Figura	4.1	Esquema de um
Figura	5.1	Otimização no
Figura	5.2	Otimização no
Fi gura	5. 3	Otimização no
Figura	3. 4	Sensibi1i dade
Figura		Sensi bi1i dade
Figura	5.6	Sensibilidade
Fi gura	5. 7	Otimização na
Figura	5. 3	Dados gerados
Fi gur a	5. 0	Otimização no
Figura	3. 10	FunçSEo objeti’'
e complemento ................ 15
Dst Cl ciclo} ................ 17
fluxo Ck, S e p } ............ 31
&lt;s
fluxo CS, Cf e SSR} .......... 33
fluxo Ck, SeC) ............... 33
de k com C ................... 33
de k e S com API óleo ........ 34
de S com C .................   35
estática Ck, S . p.5 ......... 43
para DST Cl ciclo} ........... 45
fluxo e estática . ,.......... 46
o durante otimização ......... 40
Figura	5.11
Fi gur a	5.12
Figura	5.13
Figura	6. 0
Fi gur a	6. i
Fi gur a	6. 2
Figura	6.3
Figura	6. 4
Figura	6, 5
Figura	6. 6
Figura	6. 7
Figura	6. 8
Figura	6.0
Figura	6. 10
Fi gura	6. 11
Figura	6.12
Figura	6.13
Otimização no DST Ck, S, p^ e pO ....... 49
Sensibi1idade dos parâmetros com C .... 50 Sensibilidade dos parâmetros com C^ ... 50 Carta do DST no poço A ................. . 53
Otimização no DST do poço A Csem peso) ..
Otimização no DST do poço A Ccom peso) ..
Resultados manual vs otimizado ..........
37
Otimização sem	peso	no	CpllS............. 50
Otimização com	peso	no	CpllS............. 59
Otimização sem	peso	no	Cpl37............. 60
OtimizaçSo com	peso	no	Cpl37............. 60
Otimização sem	peso	no	Cp222............. 61
Otimização com	peso	no	Cp222 ............. 61
Otimização sem	peso	no	Cp2Q3............. 62
Otimização com	peso	no	Cp293............. 62
Carta DST do poço CP760 ..........  .	. . .
OtimizaçSo com peso Cp760 CN=20} ......
vi i
63
66
Figura 6.14 Otimização com peso Cp760 CN=1O2) ............ 67
Figura 6.13 Otimização com peso Cp760 ttrechoj ...... 6D Figura 7.1 PressBes por diferenças finitas e por
inversão numérica..........................  74
Figura 7.2	Otimização no fluxo e no DST	completo	...	75
Figura 7.3	Otimização para DST por diferenças
finitas ................................     76
Figura 7.4	Otimização no fluxo................... 77
Figura 7.3	Função objetivo na otimização .............. 77
Figura 7.6	Otimização por diferenças	finitas	no
CP760 Csem pesoD .........................   78
Figura 7.7	Oráfico cartesiano do CP760 ................ 78
Figura 7.8	Otimização	Por	diferenças	finitas	no
CP760 Ccom peso2&gt; ............ ............. 80
Figura 7. ©	Otimização	por	diferenças	finitas	no
CP760 C trecho! ........................     81
Figura 7.10	Otimização	por	diferenças	finitas	no
CP7Ê0 Ctrecho} ............................. 88
Figura 7.11	Otimização	no	DST	do	Fu22.................. 83
Figura 7.12	Otimização	no	DST	do	Fu2£	Ccom peso}	....	83
Figura 7.13	Otimização	no	DST	do	Fu22	Ctrecho} ........ 85
Lista de tabelas
Páqi na
Tabela 3.1	Definição das	variáveis	admensionaís	11
Tabela 5.1	Dados de fluido e rocha	 .............. 23
Tabela 5.2	Dados gerados	para fluxo ...................    23
Tabela 5.3	Cálculo de k,	S» C. e p	no	fluxo........ 27
f	o
Tabela 5.4	Dados de fluído e rocha.......................  26
Tabela 5.5	Dados gerados para fluxo ...................... 29
Tabela 5.5	Cálculo de k, S, C, e P no fluxo............... 30
Tabela 5.7	Métodos de integração ......................... 37
Tabela 5.8	Comparação da integração de FCt? .............. 38
Tabela 5.8	Comparação da integração de GCt? .............. 38
Tabela 5.10 Dados de fluído e mecânico do poço.......... .	40
Tabela 5.11	Dados gerados de pressão estática ............. 41
Tabela 5.12	Cálculo de k» S, p. e C. na estática......	42
Tabela 5.13	Dados simulados de um DST Cl ciclo? ......	44
Tabela 5.14	Cálculo de k, S, p.» C. e C no DST ......	46
Tabela 5.15	Cálculo de k, S, p. e p no DST................  47
i.	o
Tabela 5.16	Cálculo de k, S e p. no DST.................... 48
L
Tabela 6.1	Dados poço A Cdo SFE 16802? ................... 52
Tabela 6.2	Interpretação manual do poço A................. 53
Tabela 6.3 Interpretação automática do poço A
Csem peso? ...............................      54
Tabela 6.4 Interpretação automática do poço A
Ccom peso? .................................... 56
Tabela 6.5	Exemplos de ínterpretação automática ....	58
Tabela 6.6	Pressão no poço Cp760 ..................- - .	64
Tabela 6.7	Dados do poço, rocha e fluído	do	Cp760 ...	65
Tabela 6.8	Interpretação manual do Cp760	 .......... 65
Tabela 6.9 Interpretação automática do Cp760
C completo? . .....
LX
Tabela 6.10 Interpretação automática do Cp760 CtrechcO 60 Tabela 6.11	Intervaio	de	conf1ança	do	poço	À
C sem pescD ................................. 71
Tabela 6.12	Intervalo	de	confiança	do	poço	A
Ccom pesca) ................................. 71
Tabela 7.1 Dados simulados DST Cl aiclcD ............  .	73
Tabela 7.2	Cálculo de	k t	S e pi no Cp7BO............... 81
Tabela 7.3	Cálculo de	k,	S e pi no Cp76O Ctrecho3	...	82
Tabela 7.4	Resultados	de	interpretação no	Fu82	..... 84
Tabela 7.5	Resultados	de	interpretação no	poço	A ....	85
Tabela 9.1 Conversão de unidade de grupos
adimensionais...........................      92
Tabela 9.2 Constantes de transformação de unidades ..	92
RESUMO
Este trabalho apresenta um método para interpretação de teste de pressão em poços não surgentes Cou DST?.
O método faz um ajuste dos dados de campo com os dados gerados por modelo teórico de reservatório, usando uma técnica de regressão irrestrita, não linear sob o critério dos quadrados mínimos, acoplado a um algoritmo de inversão numérica de transformada de ¿.aplace para os dados de pressão de fluxo e estática.
Obteve-se a solução da pressão no poço por técnica de transformadas de ¿.¡zplexce, modelando o teste de formação como sendo um “slug test" com uma mudança brusca de estocagem.
Os gradientes de pressão necessários para implementar a técnica de regressão foram determinados analiticamente e depois invertidos numericamente para o espaço real usando o algoritmo de Sieh/est.
Analisou-se o período de fluxo, o período de estática e ambos os per1odos si mui taneamente C um ci clo completo? do teste de formação para o caso de um reservatório homogéneo, i nfi ni to com f1uxo r adi ai par a o poço e i nclui ndo os efei tos de estocagem e ‘'skin" Cpositivo ou negativo?.
Esta análise fornece a pressão estática inicial do reservatório, a permeabilidade da formação e o dano no poço.
Atri buiu-se pesos individuais aos dados de pressão vs tempo para compensar os efeitos de flutuação devido instabilidade dos registradores de pressão.
Analisou~se testes com dados reais e simulados para ilustrar a aplicação do método, e verificou-se os resultados com um algoritmo de diferenças finitas.
Embor a não sej a necessária a deter mi nação da vazão de fluxo para esta análise, é de vital importância a estimativa da densidade média dos fluidos produzidos.
Este método reduz o tempo gasto para análise do teste e elimina a subjetividade da interpretação.
ABSTRACT
This paper presents a method for automatic interpretation of drillstem tests when produced fluids do not fill the dri. iirf'Lr'i nci
The method matches the field data wi th theoreti cal reservoir models using	an unconstrained, nonlinear,
least-squares regression technique coupled with numerical Laplace inversion of both flowing and shut in pressures.
The solution for the pressure at the wellbore has been obtained by Laplace transformation, by modelling a drillstem test as a slug test with a step- change in wellbore storage.
The parameter gradients needed to implement the regression technique were determined analiticaly and then numerically inverted to real space using the Stehfest algorithm.
Analysis of the flow period, of the shut in period and of both peri ods Cone eompl ete cycl e2&gt; of a drill stem test were done for a single, homogeneous and infinite system with wellbore storage and skin effect Cboth positive and negati veJ . Thi s analysi s may provi de the i ni ti al reservo!r pressure, the formation permeabili ty and the skin effect factor.
The pressure vs time data points have been properly weighted in order to eliminate the effects of fluctuations or instability on data aquisition device.
Simulated pressure tests and actual field data are analyzed to ilústrate the aplication of the method.
The results are checked by a finite difference algorithm.
Although flow rate measurements are not required for the applications of the proposed method, it is very important to estimate correctly the average density of the produced fluids for a good interpretation of the test.
The method reduces the time to perform drillstem test analysis and minimizes the subjectivity of interpretation.
xi i
1.	INTRODUÇÃO
Ã prática atual de interpretação de teste consiste em usar técnicas 1og-1og e semi ~1og principalmente durante o período de estática. Em poços não surgent.es uma vazão média é estimada do volume recuperado, e procede-se A interpretação com um dado modelo de comportamento a fim de determinar a permeabilidade CkJ, o efeito de película CSD e a pressão estática Cp.&gt;.
Não é feito contudo um estudo dos resultados da interpretação para verificar a sua validade com os dados de pressão versus tempo obtidos doj poço.
Este trabalho apresenta uma técnica de interpretação de de teste em poços não surgentes&gt; usando um microcomputador digital, para determinação dos principais parâmetros do sistema poço-reservatório considerando os efeitos de estoeagem e de película no poço.
Este capítulo 1 apresenta uma cronologia dos estudos da interpretação de teste em poços não surgentes, um histórico da interpretação automatizada e as definições do objetivo e metodologia usadas. Nos capítulos 2 e 3 introduz-se os modelos físicos e matemáticos usados. No capítulo 4 estuda-se critérios matemáticos para aplicação do algori tmo que será aplicado inicialmente para os dados simulados no capitulo 3.
O capítulo S apresenta a aplicação do método a dados reais e novos critérios práticos para serem usados. O capítulo 7 discute o método por diferenças finitas e no capí tulo 8 apresentam-se as conclusões e recomendações.
Nos apêndices À e C estão as deduções das equações da pressão durante os períodos de fluxo e estática para o “skin” positivo e negativo. Nos apêndices 8 e D estão as respectivas expressões analíticas dos gradientes de pressão. O apêndice E apresenta um estudo comparativo de métodos de integração. O apêndice F mostra o método de diferenças finitas e nos apêndices G e H estão as listagens dos programa usados.
1.1.	HISTÓRICO DA TEORIA DE ANÁLISE DO TESTE DE FORMAÇÃO
O teste de formação Cou DSTD é a mais antigo método usado na determinação de parâmetros de reservatório. O DST pode ser visto como uma completaçào provisória do poço. As ferramentas de teste são descidas no poço e uma sequência de per i odos de pr oduçao e f echamento é fei ta com o obj et i vo de registrar o comportamento de pressão durante o teste.
Durante o período de fluxo Ctambém dito "slug test"? é imposta uma mudança de pressão no poço devido à entrada de fluido da formação para o interior da coluna. A análise deste período. que normalmente é curto, pode nos fornecer a transmisaibilidade da formação e as condiç3es do poço CdanoJ.
No periodo de estática, após o fluxo, a pressão do reservatório é recomposta e a análise deste crescimento de pressão pode fornecer a transmissibilidade. o efeito de película e a pressão estática do reservatório..
O desenvolvi mento da teoria de análi se do DST dependeu do progresso da análise do período de fluxo C‘*slug test"2&gt; e da elabor ação de métodos coerentes par a o per í odo de estática.
A teoría do "slug test*' progrediu em complexidade desde a consideração do poço como uma fonte linear até a inclusão de efeitos de película e estocagem num poço de raio finito.
Em 1954 Ferris&amp;lt;&amp;amp; Knowles estenderam o conceito de fonte linear de Theis ti9331 para a solução de longo tempo do "slug test" para determinar a transmissibilidade em aquíferos.
Em 1960 Ccxrslauí &amp;amp;	apresentaram em estudo de calor .
a solução no espaço de Loplcce para o problema do "slug test" considerando ralo finito e incluindo o efeito de estocagem, mas sem efeito de película C"skin"l.
Cooper C19601 aplicou esta solução para fluido semi~ compressível em um aquífero usando análise semilog do "slug test
A técnica de ajuste em curva tipo semilog foi usada pela
primeira vez em análise de DST par Koh.lh.aas em 197S.
.i^arual &amp;amp; Ramey C197£&gt; mostraram que a solução do ’’slug test’* é proporcional à derivada em rei ação ao tempo da solução da pressão de fluxo para poços produzindo com vazão constante, incluindo os efeitos de estocagem e “skin".
Ramey at aL. C18721 apresentaram duas novas curvas tipo log-Tog incluindo o efeito de pelicuia. sendo que uma descreve o "slug test" em tempos iniciais, e a outra os tempos finais. As curvas apresentadas por Cooper foram consideradas válidas para os tempos intermediários.
Contudo, devido a extensão do estudo do "slug test" o conceito do efeito de película não foi solucionado corretamente, e as curvas tipo de Ramey não valem para os tempos iniciais e intermediários.
Em recente publi cação A. Sa^eev C1986? apresentou a solução do "slug test" com efeito de estocagem e "skin" através de curvas tipo e concluiu:
O São necessárias £ curvas tipo log-log para a análise da resposta do "slug test" nos tempos iniciais, dependendo da presença do efeito de película.
íO O efeito de película causa uma vazão constante nos tempos iniciais de produção, durante o qual o parâmetro de correlação deve ser S nas curvas tipo.
¿£D O parâmetro de correlação para tempos longos na curva tipo log-log é C^expCS S) como apresentado por Ramey.
Em geral o período de fluxo do DST C"slug test"3 é curto e os métodos de análise simplifiçados não podem ser aplicados, poi s não se atinge o trecho reto no gráfico de pressão versus inverso do tempo, ficando pois a interpretação restrita aos métodos manuais ou automatizados de ajustes em curvas tipo.
No período da estáti ca do DST a vazão da for mação decresce rapidamente com o tempo, fornecendo uma curva suave de cresci mento de pressão. Hi stori camente este per1 crdo tem sido interpretado pelo método de Worner, o qual foi concebido
para, poços produzindo com vazão constante. O método de Worner apresenta resultados exatos para poços produzidos com pressão constante Ccomo é o caso de muitos DST3 desde que se utilize como tempo de produção a razão entre o volume total recuperado dividido pela última vazão antes do fechamento.
ftorw C19313 aplicou o princípio da superposição com a solução de vazão constante a fim de obter uma equação para a pressão estática» a qual poderia ser usada como método para estimar a permeabilidade e a pressão estática da formação.
Ehli g-Eeanom.1 des &amp;amp; Rarney C19723 usar amai ntegr al de superposição para computar a pressão estática após um período de produção com pressão constante. Eles concluiram.que a linha correta do método de Worner poderia ser obtida usando o tempo de produção calculado por balanço de materiais; e que a per meabi1i dade cor r eta dever i a ser calculada usando a últi ma vazão antes do fechamento do poço.
Uratet &amp;amp; Ra^hauan Cl 9793 resolveram o mesmo problema usando à técnica de diferenças finitas» e concluiram que deveria ser usado o tempo de produção correto no método de ttorner» e também a vazão média para determinação da permeabilidade do reservatório.
Solímari C19S13 usou a função degrau unitário para representar a condição de contorno interna para cálculo da pressão estática após um período de fluxo com vazão constante.
Corrêa C19SS3 apresentou a solução analítica exata para os per1odos de f1uxo e de estática através da solução da equação da difusividade com uma condição de contorno mista. À solução inclue os efeitos de estocagem e **skin"» e foi obtida por transformada de Laplace e generalizada para o caso de vários ciclos de produção e fechamento.
A solução geral de Corrêa para o DST será usada neste trabalho em conjunto com o algoritmo para inversão numérica da transformada de Laplase desenvolvido por Stehfest Cl9703» para a interpretação automatizada dos dados de teste de
pressão de poços náa surgentes CDETJ, usando regressão não 1inear,
l.a. HISTÓRICO DA ANÁLISE AUTOMATIZADA DE TESTE DE PRESSÃO
Ecrlou^her ¿5 Ker-sch C1972? apresentaram 2 exemplos de análise de teste transiente de pressão com dados de campo.
Eles usaram a solução da fonte linear para reservatório infinito e empregaram um método de análise de regressão para determinação de parâmetros de reservatório em teste de interferência e fall-off.
Em 1972 Wernandes &amp;amp; Swtft formularam um algoritmo diferencial de quadrados mínimos que eliminava os problemas de linearização de sistemas nâo lineares.
Chen at oi. Cl 9741 compararam a eficiência de vários métodos CSteepest descent, 6&lt;xuss-Ateií&gt;íon e gradiente conjugado? para obterem ajustes com histórico de pressão de reservatório.
Em 1981 Rod^er et al empregaram técnicas de regressão nâo linear para estimar permeabilidade, dif usi vidade, pressão inicial e distância geométrica em reservatórios limitados sem incluir efeitos de estocagem e "skin”.
Em 1983 Rosa testou alguns métodos quase Afeuíton Cou seja métodos que otimizam usando somente a deri vada pri mei ra? para ajuste automático de dados de campo em curvas tipo geradas em cada iteração. Foram considerados modelos de reservatório homogêneo e heterogêneos, com estocagem e "skin" positivo, mas a análise foi desenvolvida somente para o período de fluxo em poços surgentes.
No estudo de Roscc as soluçòes da pressão para os diversos modelos de fluxo em reservatórios foram obtidas no espaço de ¿.aptoce, tendo sido invertidas numericamente para o espaço real a fim de se fazer o ajuste com os dados de campo. Isto possibilitou nào só a estimativa dos parâmetros do reservatório como também os do poço.
Rosa escreveu a algoritmo de regressão passo a passo e explorou vários aspectos dos métodos de Gawss e de Gauss-Marguordí. Ctambém conhecido como Lewember^-NórguordO tais como:
i 3 Si ngular i dade nas matr i zes devi do a dependénci a 1 i near entre os parâmetros a serem determinados.
t i 5 Con J unto de par ámetr os que podem ser deter mi nados par a cada modelo de reservatório.
££O Influência do parâmetro de Harguardt CX3 que cresce com o número de condição da matriz.
¿v? Necessidade de restrição nos parámetros para evitar respostas negativas indesejáveis.
vi Intervalo de confiança dos parámetros determinados .
Para cada modelo de reservatório deve-se estudar qual o melhor algoritmo de regressão a ser aplicado, e isto parece ser o problema mais difícil.
//orne&amp;lt;&amp;amp; Bctruo C19855 publ i car am vários ar ti gos sobre a escolha e uso de diversos algoritmos para aplicação em regressão não linear para análise de teste de pressão. Parece que informações complementares, como uso de algoritmo cora derivada segunda e ou inclusão do comportamento da vazão vs tempo, podem melhorar o mal condicionamento dos parámetros e até mesmo permitir a determinação de maior quantidade deles.
Comparando os diversos algoritmos Worns Ê garúa concluem que o método de Levember^-Narguardí é o melhor Cem térmos de convergência e menor trabalho nos cálculos das derivadas), quando só existe apenas um parámetro mal condicionado.
Neste trabalho será usado o método de ¿evember^-Norguizrdí. sem restrição nos parâmetros do modelo.
1.3.	OBJETIVO E METODOLOGIA
O principal objetivo deste estudo é a determinação dos parâmetros do poço e do reservatório automaticamente, através do uso de algoritmo de regressão não linear, e da solução
recentemente desenvolvida por Corrêa. para poços não surgentes.
As equaçóes das pressóes de f1uxo e estática Cl oi cio) serão usadas em conjunto para determinação da pressão de fluxo inicial Cp^'J, da pressão estática do reservatório Cp 3 , da permeabilidade CkX do efeito de película ou "‘skin" CS, e dos coeficientes de estocagem no fluxo CCp e estática CC^L).
Como as soluções exatas das pressdes dos períodos de fluxo e estática só são conhecidas explicitamente no espaço de toplace, os seus valores e dos seus respectivos gradientes com relação aos parâmetros desconhecidos serão obtidos no espaço real através da inversão- numérica pelo o algoritmo de Síeh/est C1970J. O ajuste dos dados com o modelo serão então feito no espaço real.
Será estudado o caso do D£T em reservatório infinito com fluxo radial, homogéneo, e inieialmente em repouso.
2.	MODELO MATEMÁTICO DO PROBLEMA DE TESTE DE FORMAÇÃO
A dedução da equação que descreve o comportamento da pressão como função da posição e do tempo para o fluxo de fluido em um meio poroso, é baseada nos seguintes princípios: CA)) Conservação da massa CED Equação de Estado
CO Equação de escoamento Ciei de DarcyD
Q princípio da conservação de massa produz a equação da continuidade que, combinada com a equação de fluxo e com a equação de estado adequada fornece a equação diferencial que descreve o comportamento da pressão no modelo proposto.
Para resolver esta equação difer enei al par ci al é necessário a definição das condições iniciais e de contorno.
Como o DST é um teste de curta duração, e devido a geometria cilíndrica do poço, o fluxo no reservatório pode ser descrito pela equação da difusividade em forma radial
2.1.	Equações dimensionais
As equaçóes no sistema internacional de unidades serão:
2.1.1.	Equação diferencial parcial da difusividade
d2 p +	1 d p	p c d p
	 	 	L —	C2.i? d 2 r----------------------------------------------r d r-k &amp;amp; t
Na deri vação da equação da	dlf usi vi dade	aci ma»
foram feitas as seguintes hipóteses :
Cl? Fluxo horizontal radial
CS? Meio poroso isotrópico e homogéneo
C3? Fluxo monofásico
C4? Fluido com viscosidade constante
CS? Fluido com pequena compressibilidade
C6? Gradiente de pressão pequeno em todo o reservatório
2.1.2.	Condição inicial do reservatório :
Assume-se que o reservatório tenha uma distribuição de pressão homogênea antes do teste, ou seja ■.
pC r , O) - p , r &gt; r	C 2. 2?
L	w
2.1.3.	Condição de contorno externa :
Devido à curta duração do DST os efeitos de limites externos do reservatório não afetam o seu comportamento de pressão.
11 m pCmt) = p	C2. 3?
r=$ tr
2.1.4.	Condição inicial do poço :
Por causa da entrada instantânea de fluido no poço e ou a presença de um colchão de fluido na coluna de teste, tem-se:
C2. 43
2.1,5.	Período de fluxo :
Como o período de f1uxü é pequeno e nenhum 1í qui do é pr oduzi do na super f 1 ei e t a taxa de acumul ação de f 1 ui do no poço deve ser igual à vazSo da formação.
dp
q Ct3 - C “w = O» O &amp;lt;t &amp;lt;t	C2.53
w	f dt	p
Determina-se C pela equação de balanço de materiais:
-Vazão do reservatório:
2nkhr dp qf r 3 =	. p	dr	ca. 83
2nkhpr dp dp	
H	~ Hr	M	dp dr	C2.73
c w	1 dp p dr		Cequação de estado?			C2. 83
		2rrkhpr	1	dp	2rrkhr	dp	
q						—	ca. ©3
		p	c p dr	p c	dr	
			V			
Taxa de acumulação		de fluido no poço				
			1			
ms	=	PvdV	= AJA, dl			ca. to?
						
dms			dl			
—	=	q =	A p —			ca.li?
dt			dt			
		1				
P	=	f p g dh				ca. ia?
		o				
dl		1	dp			
	=		. 				Ca. 133
dt		P 9 w	dt			
Derivando parcialmente e substituindo C2, 83 em CS. 133
tem-se:
Á	dp
p g c dt w
C2.143
Igualando as equaçóes	C2.S3 e C2.143	teremos que :	
2nkhr	âp	A	dp	
		 = 	—	—	C2.133
u a w	âr	p g c V	dt	
	A	2 n r	
então	c „	„ 	 P	C2. 163
	'	Pu 9	r V	
2.1.6.	Período de estática
Após o fechamento, através da válvula de fundo, o fluído proveniente do reservatório é comprimido abaixo do ponto de fechamento, o que pode ser descrito por :
	dp		
q Ct3 w	_Cs dt"	o , t &gt; t p	C 2. 163
onde:	C = c â	v	V w	C2. 163
A semelhança entre as equaçóes do período de fluxo C2.S3 e da estática C2.183 sugere que o problema de DST pode ser visto como um “ sl ug test“ com uma mudança brusca do coeficiente de estocagem.
2»1.7. Condição de aclopamento
Assumindo a existência de um efeito de película num raio infinitesimal no poço. Segundo Van Everdín^ert &amp;amp; Hurs-t Cl 9333, pode-se relacionar a pressão do reservatório com a pressão no poço por:
p Ct3 = pCr ,t) -qCO Sf £ &gt; O	C2.i£D
No caso de “skin" negativo pode-se usar o conceito de raio efetivo do poço Csegundo Nottews &amp;amp; /íussel C196733:
p Ct3 = pCr ,t3,	S &amp;lt;O	C2. 203
W	va
2.2	~ Equaçdes normalizadas :
Usando os grupos adimensionais da tabela 2.1 , obtém-se
para o problensa do DST as seguintes equações ;
2.2.1.	Equação da difusívidade no reservatório:
d2 pr,	1	d p	d Pr&gt;	
o	+	„ _P =	D	C2. 215
&amp;amp; r n	r ¿? r D	D	ô t D	
2.2.2.	Condição inicial do reservatório :
p Cr ,05 = O	C2. 225
2.2.3.	Condição de contorno externa do reservatório :
lim p Cr ft 5	=0	C2. 235
D B D
r=3 co
2.2.4.	Condição inicial no poço :
p C0+5 = 1	C2.245
WD
2.2.5.	Equação de fluxo no poço :
0&lt;t&amp;lt;t&amp;lt;0
D pD
ca. 253
o
a. 2. 6. Equaçao da estática na poça :
dt
D
t &gt;t
D pD
C2. 263
O
2»2.7. Equação da vazão no poço;
q	Ct 3		a p v - r ■ j, ,
\'D	n		D &amp;amp; t D
C2. 273
2* 2.8. Equação da vazão na formação :
p Ct 3= p Cl,t 3 + S q Ct 3, £&gt;O
D	D	D	WD D
p C t 3 = p C e , t ) , S&amp;lt;O ‘wD D	D	D
C2. 283
C2. 293
3.	SOLUÇÃO DO MODELO MATEMÁTICO PARA POÇOS NXO SURGENTES
3.1,	As equaçSes governantes
A equação diferencial que descreve o escoamento de fluído no meio poroso, e as condiçóes iniciais e de contorno, que delimitam as hipóteses de solução do problema, já foram discutidas no capítulo anterior.
O problema do DST pode agora ser resolvido analisando o período do fluxo, que pode ser visto como um "slug test", e o respectivo período de fechamento. A solução será então uma função contínua por partes, onde:
p Ct3 — •/"	PwfC°	se 0&amp;lt;	t	&amp;lt;t p	C3.13
1	p Ct3	se	t	&gt; t	C3. £3
				p	
3.1.1. Solução do	perí odo	de fluxo	ou	"Slug testf&gt;	
Embora muitas vêzes seja conveniente trabalhar com as equaçóes em forma adimensional t no nosso caso será preciso escrevê-la num sistema consistente de unidades. Isto porque deseja-se estimar os vários parâmetros do reservatório, os quais precisam aparecer explicitamente na soluçSo da equação diferencial.
Para o período de fluxo o problema estará bem posto com as equaçdes C2. 213 a C2. 233 mais as equaçSes C2.283 ou C2.293. Todas elas estão reunidas no Apêndice A que apresenta esta solução do ”slug test" através do uso de transformada de Lctplcce.
A equação CA.183 que mostra a solução final no espaço de Ltxpltxce. é dada por Cem unidades do Sistema Internacional}:
% 1	KoC r	~‘/’n 3 *	w	"S s +	2nkh p.
	rW-/*^ K‘Crv/1Ç? ,	Cf p s
s •&lt;		""* KoCr y "/d 3 r	W	n s -#■	2nkh
	r / s ’ K±Cr / s *3 wv Z77	vV ZfJ	J	■	+	A	 Cf p
Os parâmetros do reservatório estimados pela equaçáo acima normalmente são: permeabilidade Ck3f fator de película CS3. e pressão de fluxo inicial ou de abertura Cp^3. A análise cartesiana convencional permite, em alguns casos, a estimativa da transmi ssibil idade CkhZpi e do fator de película CS3.
A técnica de ajustagem em curva tipo Cfetmey -	1970?
propSe a estimativa da transmissibilidade CkhZ(u3f e do
produto ào fator de peí i eula C 25 peío eoef iciente de estocagem adi mena!onal	sendo que na prática este
procedi mento de ajustagem é muito difícil de ser' obtido.
Observando-se a equação C3. 35 que rege o comportamento da pressão de flujos em poços não surgentes, nota-se que não é possível obter a inversão analítica para o espaço real devido à complexidade da expressão,, a qual ê função não linear dos parâmetros do sistema.
3.1.2.	Solução do período de estática ou do problema de DST
A solução deste problema foi desenvolvida por Corrêa
Cl98851 sem envolver superposição , através do uso de uma
nova condição de contorno interna dependente do tempo.
Uma vez que o poço é fechado» a produção do reservatório fica confinada abaixo do ponto de fechamento e a pressão estática é afetada pela magnitude do coeficiente de estocagem
do poço. Um balanço de materiais nesse período nos fornece a equação C2.285.
A semelhança entre as equaçdes C2.235 e C.2. 265 sugere que o problema de DST pode ser visto como uma solução de "slug test1’ com uma mudança do coeficiente de estocagem. Para todos
os tempos menores que t , o mecanismo de produção é governado pela mudança do nível de líquido no poço, e após o fechamento
do poço C tempos maiores que t 5, o mecanismo passa a ser P
dominada pela compressão do fluido no volume confinado abaixo do ponto de fechamento.
As equaçóes CS.255 e CS.265 podem ser combinadas»através da função degrau de Weovtsíde» que é apresentada na Figuras 3.1» gerando uma nova condição de contorno.
1
1
o
o
Figura 3.1 - Função degrau unitário e seu complemento
Esta nova condição de contorno interna para o problema do
DST é válida para todos os tempos de teste:
[C1“S,3 C + S, C	]	dp 'JB	d p	n - r a .		=	0»	t	&gt; 0
k	fD	k aD	dt	D d t		4	D	
	D	D	J	r = D	1	C3. 43
onde k é equivalente	ao	tempo de produção		t . p	
0 problema de	DST	poderá então	ser	resolvido	se
tormarmos as equaçSes CS. 213 a CS. 263, CS. 283 ou C2.283 e a equação C3.43 acima.
Para se resolver esta equação diferencial com as respectivas condiçSes de contornos e iniciais, incluindo a condição de contorno dada por C3.43, através de técnicas de
Transformadas			de	Lcpiace, foram	desenvoivi das por	Corrêa
novas	regras		para	transformadas das	quais serão usadas:	
H	£fc	FCt3 J	=	k fCs3 - Je"st FCt3 dt o		C3. 53
t					,	k	A ”ltS	r* “St	
n J i	c?	4	k, W ,&gt;Z	}	s fCs3 - FCk_3e	" Je	FCt3 dt o	C3. S3
Q apêndice C mostra o desenvolvimento teórico da solução exata em forma di mensi onal deste pr oblema f no espaço de taplace, para o Sistema Internacional de unidades» que é:
Z
l"ws
onde:
s
S
+
1
KoCr /szk5 ____y______

r ■/sZk KiCr t/ s/k5&gt; w	w
+ c -
c
f t
p
|e~stp ,Ct?'dt+C,Uc J	vf	d .
o	-5
v
a
1
X
+
S
c
e
C 2nh/p5 k
C3. 75

C
0
C “c
C3. 8?
C2nh/p5 k
C8nh/p5k
r
“d
“St
= Prf e	p
c
f
C3. 95
C
e
Po
C3.105
A
-FTt
dever á
C 2rh/p5 k
btencão do comportamento de ser feita através da inversão
pressão no numérica da
Existe aqui a não linearidade da parâmetros do reservatório e do poço,
r eservatór1o nor malmente
funç&amp;amp;&gt;
com
campo real
eq. C3.75,
relação aos
métodos
Os parâmetros de de análi se
de
estimados pelos no per1odo de
estática
não
par a poços de película reservatório Cp,5.
t,
A análise convencionai semi-log ter apli cação restrita aos casos vazão constante, com o uso do tempo
balanço de materiais. Determina-se então k,S e pi.
efeitos
ou
teste de pressão
surgentes sfc: permeabilidade Ck5 , "skin" CS5 e pressão estática do
Cmétodo de Horner5 parece de poços produzidos com de produção calculado por
A análise cartesiana Cmétodo de Corrêa? é aplicável para poços onde o tempo de fechamento seja longo,se comparado ao tempo de produção, para a determinação de k e p Para a determinação do “skin*" faz-se o estudo do per iodo de fluxo
pelas curvas de "slug test" ou usa-se uma fórmula que se baseia na hipótese de produção com vazão constante.
A análise através de curva tipo não é disponível para o período de estática em poços não surgentes.
4.	ESTIMATIVA DOS PARÂMETROS POR REGRESSÃO NAO LINEAR
A determi nação dos parâmetros do poço e do reservatóri o por regressão não 1i near pode ser fei ta no per1odo de f1uxo, no período de estática ou em ambos os períodos de teste simuitaneamente.
A Figura 4.1 com as equaçbes C3. 33 e&amp;lt;3.73 definem o modelo esquemática e matematicamente.
Tempo
Figura 4.1 - Desenho esquemático de um DST
As incógnitas do modelo são os parâmetros do reservatório.
Deseja-se determinar os valores de parâmetros que fazem as equaçbes&amp;lt;3. 33 e C3. 70 ajustarem-se aos dados de pressão
obtidos do teste de campo, resultando em um problema ajustagem de um modélo não linear.
4.1.	Escolha do método de estimativa
Àpesar de existirem vários métodos para a estimativa de parâmetros em regressSo, será usado neste trabalho o método dos quadrados mínimos.
Seja	o valor teórico da pressão no poço no tempo
ti,definido pela inversão numérica das equaçSes C3. 33 ou C3.9\ dependendo do valor de t ser maior ou menor que o tempo de produção t .
Seja íp ] o valor registrado ou observado de pressão no teste do poço não surgente no tempo t .
O procedimento do método dos quadrados mínimos procura minimizar a soma dos quadrados dos resíduos definida por:
SSRCfo =	- Pupt }	C4.15
*	f
onde x- Ck,S,p ,p.,...C.,C3 é o vetor formado pelos m O L	I S
parâmetros desconhecidos* cujos valores devem ser determinados.
SSR é função somente dos parâmetros do reservatório, pois a variável tempo é conhecida. SSR dá uma medida da proximidade ou afastamento dos pontos reais do modélo teórico e é conhecida como função objetivo.
Procura-se por um vetor x no qual a função objetivo seja mínima. A determinação do valor mínimo de SSRCxj denomina-se otimização, a qual pode ser do tipo restrito ou irrestrito.
Quando o problema a ser resolvido não impóe nenhuma restrição sobre os valores que as variáveis independentes podem assumir, o método é dito sem restrição, Àlguns destes métodos são: gr adi ente pr oj etado, gr adi ente reduzi do, gradiente conjugado, método de N&amp;amp;wton e quase Wewtcn Cou Newion modificado!), etc.
Os problemas de quadrados mi nimos não 1i neares são um caso especial de minimização sem restriçESes, embora para
muitos problemas já se sabe a priorí que certos valores são inaceitáveis como solução.
As restrições nos valores das variáveis são do tipo 1i near e não 1i near .
Na otimização restrita existem dois métodos básicos:
1. Transformar o problema r estr1 to numa sequênci a de problemas irrestritos; com isto a solução não é factível mas é ótima. Também o valor inicial nSo precisa ser factível. Os métodos mais usados são: o método de penalidades, o método de barreiras Cque é uma exceçSo pois a solução e o valor inicial i ni ci al sâto f acti vei sJ, duali dade» 1agrangeano aumentado e lagrangeana projetado.
S.	Adaptar as técnicas de otimização irrestrita onde a solução é sempre facti vel e também o vaior forneci do inicialmente necessita ser factível. C?s métodos mais usados são: Gradiente projetado,Gradiente reduzido,etc.
Adotar um método de otimização restrita parece mais vantajoso, pois já se sabe que parâmetros como por exempla a permeabilidade e pressão de reservatório não podem assumir valores negativos. Porém estes algoritmos têm de ser desenvolvidos para cada modelo específico, considerando as restrições desejadas. Os algoritmos sem restrições funcionam bem para valores iniciais próximos da solução e serão usados neste trabalho.
4.2.	Escolha do método de procedimento para o problema de de quadrado mínimo não linear
O problema de quadrados mínimos não lineares, para ajuste de dados	L~ ......n- com um modelo pCx,t^D
consiste em se determinar um vetor x, tal que o ajuste seja o melhor possível, no sentido de que a soma dos quadrados dos resíduos seja minimizada.
Da equação C4.13, seja :
conhecida como função residual, a qual
é
O problema se torna entào :
Min
onde n &gt; m e FCxJ V
é náo linear em x.
SerSo apresentados a seguir, alguns métodos para resolver
problemas de quadrados mínimos nSo lineares segundo Dennts &amp;amp;
Sehnabell Cl£833 .
4.2.1.	Método de Newtan. para quadrados mínimos rsáo lineares
As derivadas de SSRCxJ são : primeira derivada	n
7 SSRCxD- aV F.Cx2&gt;-7 F.Cx^ = 2JJC xJL. FCxJ ¿1 L	L	i
i=l	C4.4J
segunda derivada x_	n
72SSRCx3= sY CVF.C&amp;amp;.V F.C&amp;amp;1 + FCxJ72FCx3J
Zj	t	v	L	L
t=í	C4.5J
=	SC^CãbjJC^ +	DSCíb?	C4.83
m
onde	DSCx3	=	J FCxOS^FCíb	C4.£D
t = 1	o
DSCxJ são informaçSes de FCxJ de segunda ordem em v £SR.
O método de Wewton aplicado ao problema de minimizaçSo sem restriçdes fornece o valor de x, dado um vetor inicial x , através da seguinte expressão:
$ -	[d?^k + DS ] d£ Ffc	C4. 102)
A sua convergência é quadrática mas a maior dificuldade é para se obter DSCxJ, ou seja a expressão da 2a, derivada, além da estimativa de DSCxZJ exigir aproximadamente Cm2 + 3m D avaliaçdes da função resíduo FCx&gt; por iteração.
4.2.2.	Método de Gctuss para quadrados mínimos não lineares
Jc
Dada uma aproximação $ „ os métodos tipo Cuuss Cou Ga.uss~N&amp;amp;wt.oriG usanu para determinar uma nova aproximação )R para o modélo linear de FCx? em torno de	a seguinte
Ê?ss si So *
Ã = Êk- [ JkJ&gt;k ] *j‘ Fk	C4.11J
Às equações C4.10? e C4.11? diferem somente peio têrmo DSCx?.
Outras conclusSes do método de Gauss :
~Á convergência local é quadrática em problemas de resíduo zero,
-A convergência local é linear em problemas não lineares e que tenham resíduos razoavelmente pequenos.
-Resolve problema de quadradas mínimos lineares em uma íteração.
-Convergência local linear lenta em problemas que são suficientementes não lineares ou que tenham resíduos razoavelmente grandes.
-Não convergente localmente em problemas que sejam muito não-lineares ou que tem resíduos muitos grandes.
4.2.3.	Método de ¿euember#-#orguordí ou úcuss-Nctrquardt para problemas de quadrados mínimos não lineares.
tforguordí. Cl963? desenvolveu um método que evita a di vergénci a do método de iScwsí e também acelera a convergênci a do método gradi ente. Ele mostrou que resolver o sistema (E ÈÔ = $ é equivalente a resolver o sistema:
C E + 1 3 1 ¡D = QJ	C4. IS?
onde 0 é a matriz identidade e X é uma constante.
Às iteraçdes são dadas pela expressão :
$ =	[yj), +10 ] S1 F	C4.13?
k k	** k k
A solução do vetor de parâmetros a serem determinados após cada iteração k+1 é dada em termos da solução k&gt; por:
$&lt;W±Í =	+	C4.14Í
onde íÔ é a solução do sistema normal de equações modificadas pelo método de Zfctr quctr d t.
O procedimento será:
CaJ Iniciar com X = O. 01
CbJ Substituir X por O. IX se SSR^&lt;k + il £ &amp;lt;SSR{$&lt;k)^
CcD Caso contrário determinar um fator de relaxação dado por
= á&lt;k&gt;+	tal que ssg^C^Op ssR^Ck^
e substituir X por 10X.
Conclusões sobre o método de ¿evember^-Mízrquujrdí.:
-Se o resíduo de Fíx for zero, o método converge quadraticamente.
-O método pode ainda, ter convergência local lenta em problemas de resíduos grandes ou muito não lineares.
Este método é melhor que o de Gauss quanto ao:
O mal condicionamento da matriz do sistema. £¿3 tamanho do passo na direção da máxima descida.
Existem também os métodos tipo secante para problemas de quadrados mínimos não lineares, que na prática são muito eomplexos quanto a i mplementação, e devem ser apli cados a problemas com resíduos grandes ou não muito lineares.
Uma boa implementação dos métodos de Cause-?fezrqttíxrdt e do método secante fornece valores semelhantes, para problemas de resíduos relativos pequenos ou pouco não lineares.
Pela simplicidade e disponibilidade de várias implementações do método de Gauss-íícxrguardi, além de outras utilizações em problemas semelhantes com sucesso, justifica-se o seu uso neste trabalho. A versão do algoritmo utilizada é a apresentada por Press, ht H. ®t oi. CÍ98ÕJ.
4.3.	Justificativa teórica do uso do método na determinação, de k, Se p^
Para a utilização de algoritmos de
otimização sem
restrição aos problemas de quadrados mínimos não lineares»
tem-se que determinar o mínimo da função objetivo:
2{tf’W1t=V - pwp. }
Â condição necessária para existência de mínimo é que a derivada primeira se anule:
C4.153
logo
dSSFCx3 -------- = o
C4.183
n
V SSRCx3 = V F.Cx3.V F.Cx3 £j v	i
1=1
C4.173
Quando se tem 7FCx3 anui ado. obtem-se o mínimo
da função
resíduo e também o mínimo da função objetivo.
Como se deseja minimizar
o desvio entre as
press Síes
observadas e teórica
FÇx3
[ p ] ,	-
*v t =t
i
pelo método de Gauss-ítorquardi	deveremos
linearização de cada resíduo
C4.183
f azer
F, L
na
série de Taylor até
cyrpr 3")
â x
p
O
a
a
derivada primeira
F.Ck »Stp.3 t	t
&lt;3F.
CS-S 2
Of
dS 3s=s
O
&lt;?F
&lt;?k
#F.
L
dp.
Ck“ko3 + k=k
o
Cp. -p. 3 C 4. 193 *1 vO
p. =p.
t vo
+
Sendo os gradientes calculados
1 ni oíais
próxi mos
Para
C4. 203
C4. 213
olutrf	no
espaço
real
pois
¿aplace:
d F.C x»t 2 t	M "I		dp 1 a x }•
d	—	
	X. J	j
	onde	j	~ 1,2,	,m.
C4. 243
As expressSes das derivadas com relação a cada parâmetro encontram-se no apêndice B para o período de fluxo» e no apêndice D para o período de estática.
Pode-se também usar um algoritmo que avalie numericamente estas derivadas em rei ação aos parâmetros, através de diferenças finitas.
5.0. INTERPRETAÇÃO AUTOMATIZADA EM DADOS SIMULADOS
Para evitar problemas causado pelos dados, fixaram-se os dados de fluído e rocha CTabela 3.1D e geraram—se dados de pr essàd vs tempo pel o pr ogr ama do anexo H CTabela 5. 23.
Parâmetro	vai or assumi do	uni dade
Permeabl1i dadeC k 3	1.384	Dorcy
Fluído: Õleo	25. 92	API -i
Compr. total Cc*}	149. 9	atm
Efeito Pelic.CSJ	-2.	-
P. flux» ín.Cpp	S. 85	atm
P. estática Cp.3 L	ao. 68	atm
Vi scosi dade C p3	60.	cp
Espessura	Ch?	38.	pés
Raio poço	Cr&amp;lt;3	4. 248	pol.
Raio tuba	Cr 3 p	1.908	pol.
Porosidade	C$0	0.062	—
Tabela 5.1-Dados de fluído e rocha para "slug test" simulado.
tc hr3	PufCpsig3	tChr3	PvfCpsig3	tC hr3	Pu(Cpslg2
0. 022	151.968	0.166	359.328	0. 470	377.893
0. 026	160. 472	0. 187	380. 819	0. 328	604.529
0. 034	176.479	O. 209	401.907	0. 590	629. 653
0.041	189. 614	0. 235	425.153	0. 662	655.165
0. 053	210. 657	0. 264	449.182	0.774	688. 467
0. 067	233.345	0. 295	472. 901	0. 833	703. 914
0. 084	258.766	0. 334	300. 206	0. 938	726.506
0. 106	288.897	0. 372	524.424	1.051	747. 149
0. 132	321.266	0. 418	530.996	1.126	758.896
Tabela 5.2 - Dados gerados de pressão de fluxo vs tempo.
5.1.	OTIMIZAÇÃO NO PERÍODO DE FLUXO
GRADIENTES POR DIFERENÇAS FINITAS
COM CÁLCULO DOS
O cálculo dos par âmetros será Lei to
considerando-se os dados referentes ao período
i ni oi almente
de f 1 uxo do
teste de formação.
Sabe-se que, o método de Levember^-Wargiiordí defi ni do pei a equação C 4.133 exi ge que calculemos as derivadas da função objetivo com relação às incógnitas inúmeras vezes, porque a solução é encontrada através de uma sequência de aproximaçtSes até o ponto de mínimo.
Pode-se calcular estas derivadas por avançadas:
e?F
di f erenças fi ni tas
{
}
dx.i
h j
ou diferenças centradas;
1
h.3
j
- f Cx&gt;
t
dx j
/ f.Cx
2h. I 1
hD
j
f .Cx
L
-h .3 j
computador, J o número
de
parâmetros, e í=

4-
+
}
equação C3.33 através
ter mos.
As pressSes serão calculadas pela
do algoritmo de inversão numérica de Steh/esí com 8 À i mplementação do método de mi ni mi sação por mínimos de ¿.evember^-Zforquordí. * calculando-se as
quadrados
der i vadas
por diferenças finitas» serà feita através de um programa da biblioteca de	rotinas- matemáticas do IMSL para
microcomputadores padrão IBM-PC, a fim de testar a aplicabilidade do algoritmo apresentado no apêndice G.1.
O período de f1uxo do DST C ou "siug test"3 depende basicamente de 4 parâmetros do reservatório, que para estes
dados gerados apresentados na Tabela 3.2 são k = 1.384 Darcy. r = *^40 cm3/atm» S = -8 e p = 3 85 atm.
T	o
Na primeira tentativa aplicou-se o algoritmo para a deter mi nação de todos os 4 par âmetros. A segui r apli cou-se
novamente o método para se determinar 3 parâmetros €fixando 1 parâmetro} e finalmente para se determinar 3 parámetros Cfixando 3}.
Os valores iniciais arbitrados foram os mesmos nas 3 tentativas» sendo k = i. 00 Dcrcy, C = 80000 cm3/atm, S = 0. 0 e p =5. 85 atm.
a
O critério de convergência adatada exige que a diferença entre a soma dos quadrados dos residuos entre 2 iterações sucessivas seja menor que 10~ .
A Tabela 3.3 abaixo apresenta o resumo, dos resultados.
Parametros	Solução	Num.	SSR	Valor	Erro
arbitrados	calculada	total		real	per-
inicialmente		itera-		param.	cen-
Csis. Dorcy?	C s. Darcy}	çSes	Catm2}	C s. Dcrcyl	%
k =	1.	k = o. so		3x10™6	k =1.384	-35.
S =	0.	S =-l. 79	S			-10.
p =	9.69 o	p = 5. 85 o				0.
C = 80000 f	C = 58500			S = -2.	-31
k =	1.	k =1.05				-24.
S =	0.	S = -l. 86	9	3x1O~5		
C( = 80000	C = 64460			p =5» 85 Q	-24.
k =	1.	k = 1.383	8	"**6 7x10		0. 07
C “ 80000	C = 85200			C =85240	O. 05
Tabela 3.3 ~ Resultado do método de L&amp;amp;vember-g-tfarquard.t com cálculo das derivadas por diferenças finitas para o periodo de fluxo do DST, tentando-se calcular k, S, Cf e p .
3.1.1.	Discussão do método usado e dos resultados
Uma vez que a soma dos quadrados dos resíduas são da —3
ordem de 10 ou menor, os 3 resultados podem ser aceitos
como soluç«to do problema» porém como os dados foram gerados ar ti f i clalmente e a solução correta é conheci da, vê-se que existe eombinação de parâmetros que não reproduzem a solução verdadeira com unicidade. A causa disto pode ser a alta
correlação existente entre os parâmetros a serem
deter mi nados,
ou o êr r o no
eál cul o das
derivadas por
diferenças fi ni tas,
devido a
precisão
do
computador
e a
sensibilidade do método com relação ao número de parâmetros a
serem estimados.
Pode-se pesquisar todas as combinações possíveis de parâmetros com este algoritmo» mas devida ao longo tempo envolvido no cálculo das derivadas» esta pesquisa será feita calculando-se as derivadas através de inversões numéricas de expressões analí ticas.
3.2	- OTIMIZAÇXO NO PERÍODO DE FLUXO
A otimização para o período de fluxo será baseada no cálculo dos gradientes de pressão por inversão numérica das expressões no espaço de ¿.cxplcxce.
O apêndice B apresenta as derivadas da solução do período de fluxo, com relação aos parâmetros k» S, p£ „ p^ e Cf.
Para aplicação do método foram usados:
il&gt; O algoritmo de SteZi/est „ para a inversão numérica das expressões da pressão e derivadas obtidas no espaço de Laploce» com 8 termos.
iiD Um critério de convergência baseado na variação da soma dos quadrados dos resíduos entre duas iterações sucessivas,
! SSR - SSR. j &amp;lt;IO-2,
iii3 Valores iniciais dos parâmetros arbitrados de modo a evitar a divergência ou impossibilitar convergência nas i terações sucessivas.
i	v3 Uso das equações A. 16, B. 1.8» B. 1.12»	B.1.13» B. 1.14 e
B. 1.15 para cálculo da pressão e dos gradientes de pressão.
v3 O programa de otimização apresentado no anexo G.2.
Para o teste do método foram geradas presstâes de f 1 uxo com o programa apresentado no Apêndice F. Os parâmetros fixados para as propriedades de fluido e rocha estSo na Tabela 5.4» e os valores obtidos de pressSo vs tempo est^o na Tabel a 5.5.
Parâmetro	vaior assumi do	uni dade
Per meabi1i dadeC k1	1.384	Dtrrcy
Estoc. fluxoCCD f	85240	3 cm Zatm
Efeito Pelic. C3D	2.	
P. fluxo in. Cp 2? G	5. 85	atm
P. estatica Cp. 2?	60. 68	atm
Viscosidade Cpí	60.	cp
Espessura	Ch&gt;	38.	pés
Ralo poço	4. 248	£3Ojl *
Por osi dade	C&amp;lt;fü	0.062	—
Tabela 5.4 -Dados de fluído e rocha para "slug test" simulado
tChrZ)	PvfCpsigD	tChr?	PvfC psi gl	tChrD	PwfCpsig5
0. 022	107.887	0. 166	215. 743	0. 470	381.277
0. 026	111.445	O. 187	229. 337	0. 528	406.778
0.034	118. 367	0.209	243. 156	0.590	432.344
0. 041	124. 266	0. 235	258. 970	0. 662	460. 022
0. 053	134. ose	0. 264	275.990	0. 774	499.211
0. 067	145,186	0. 295	293. 512	0. 835	518. 768
0. 084	158. 217	0. 334	314.638	0. 938	549,225
0. 106	174.438	0. 372	334.308	1.051	379.306
0. 132	192. 820	0. 418	007	1.126	597.544
Tabela 5.5 - Dados gerados de pressão de fluxo vs tempo.
A Tabela 5.6 a seguir apresenta o resumo dos resultados;
Parâmetros	Soluçáo	Num.	SSR	Valor	Erro
arbitrados	calculada	total		real	per-
inicialmente		itera-		param.	cen-
Cslsfj	x»'8)	C S. r¡rtr-r-y&gt;	ç£5es	Catm5	Cs. ZkzrcyZ)	
k =	0.5	k = 1.384		5x10	k = 1.384	0.
S =	0.	S =-2. 00	7			0.
p ~	9,69 o	p = 5. 85 o			S = ”2.	0.
k =	1.	k = 1 . 15				-17.
S -	2.	S =2.09	10	5x10	p =5.85 O	4. 3
C = 80000 f	C = 70838 f				20.
k =	0.5 S =	5.	k = 1.405 S = 1.97	9	5x10™®	p. -©0u 68 L	5. 8 -1.5
Cf “ 75000	C = 90242 f			Cf =85240	5. 8
Tabela 5.6 - Resultado do método de Levember^-Narquctrdí com cálculo das derivadas por inversão númerica para o período de fluxo do DST, tentando calcular combinações de k , S» p^ e Cf.
5.2.1.	Discussão do método e dos resultados obtidos:
de
Dos resultados acima nota-se que, quando a combinação parâmetros a serem determi nados é k, Se p^, o método funciona com muita rapidez Ctempo total de execução menor que 30 segundosí e
Quando há
dados iniciais
a resposta é precisa.
a inclusSo de C , que afeta principal mente os
o método nâo converge com unicidade
As 3 Figuras a seguir mostram este
do teste,
correta.
3. 1
os
valores das respostas obtidas nas
cada parâmetro foram normalizadas com as razÊSes deverão
para a solução comport amento.
Na Figura
diversas iteraçdes para relação ao valor correto, sendo que todas
ser unitárias quando a convergência for correta. De fato, obteve-se este resultado correto quando tentou-se determinar
k,	£ e p mantendo fixos p. e C
O	1	f
Figura 5.1 - Otimização no fluxo
O mesmo Já nSo ocorre ao se tentar determinar k, S e C^, £ ví de Fi gur a □. 2D mantendo-se fixo p e ; poi s embor a a solução tenda para 1 muito lentamente, observa-se que existe uma aparente dependênei a entre k e Cf, poi s os doi s parâmetros crescem a uma mesma taxa. O critério de convergência é sempre satisfeito com os mesmos resíduos antes que se atinja a solução correta, o que sugere uma limitação da capacidade do microcomputador, ou do algoritmo utilizado.
A Figura 3,3 mostra que, para o mesmo procedimento, mantendo-se f i xo o vaior da per meabi1i dade pode-se determinar £ e C'.
f
1.5
5E+ÍW7
Eigurí! 5.2 - Oürnizaçoa poro o fiunp
Figuro 5.3 - OtimizoçSo poro o ftuxc
Estas observaçSes permitem se concluir:
i&gt; £ possível se determinar k, Se p^ com rapidez e precisão mantendo-se fixos, em seus valores correto, a estocagem no fluxo	e pressão estática do reservatório Cp^5.
ü) Quando se deseja determinar Cf e S, deve-se conhecer com exatidão os valores de k, p e p..
o	t
iii? O número máximo de parâmetros que pode ser determinado para este caso é aparentemente 3.
Pelo exposto seria interessante estudar a influência na determinação de k e S, de pequenas variações de C .
O valor de Cf, quando não se tem variação no diâmetro das ferramentas de teste, depende apenas da densidade do fluido produzido Cvide equação 2,i£D.
As S Figuras a seguir mostram esta influência.
A Figura s- apresenta o resultado da permeabilidade calculada como função da estocagem adotada, sendo ambos os
par âmet r os nor mal 1 zados com r el ação a seus vai or es r eai s -Nota-se que existe uma relação linear entre estes dois parâmetros, ou seja adotando-se um valor de C diferente do real causa-se o mesmo erro na permeabilidade. Ê importante lembrar que a densidade do fluido pode variar bastante com a produção de gás, sendo difícil estabelecer um valor médio correto para o valor de Cf que satisfaça ao modelo.
Fíg. 5.4 — Sensibiiidade da permeabilidade com a estocagem
Por- out r o 1 ado se o r eser vatór i o pr aduz i r apenas água ou óleo morto, a densidade será função do grau ÀPI médio do líquido, medido nas condiçSes de pressão e temperatura do reservatório. A vari ação de k e S com o grau API é apresentada na Figura 3.3.
Fig. 5. 5 ~ Sensibilidade da permeabilidade e skín com o AP! do fluído
A Figura 3.6 mostra a influência de pequenos erres no cálculo do coeficiente de estocagem do fluxo Cf sobre o valor Skin, revelando que quanto mais acima do valor real estiver o valor de Cf adotado» menor em termos reais será o valor do skín calculado.
Logo, se o valor de Cf estiver super-estimado, o valor da permeabilidade obtida deverá estar acima da real, e o valor obtido para o skin estará abaixo do real.
1.60
Q --------------*------------1-------------!____________I
&amp;amp;80 1.00 1.20 Cf(adotado)/Cf(reoí)
Fíg. 5.6 — Sensibilidade do skin com a estocagem
5.3.	OTIMIZAÇÃO NO PERÍODO DE ESTÁTICA
A otimização para o período de estática será realizada com	no cAlculo des gr adi entes de pressAo atr avés da
inversão numénea das expressões no espaço de Laplace.
A equação C3. 73, deduzida no apêndice C, e as derivadas determinadas no apêndice D» serão usadas para o processo de otimização no período de estática.
A equação&amp;lt;3.73 permite o cálculo dos valores das pressões par a todos os tempos do teste. durante os per í odos de fluxo e de estática, sendo que para o período de fluxo ela pode ser simplificada para a equação C3. 33.
O cálculo da pressão no período de estática exige que se caldtl e o valor de uma integral dependente do período de
fluxo definida por:
t P
Integral =	| e^p CO dt
Jo w
5.3.1.	Estudo dos métodos de solução da integral acima
Estudaram-se várias alternativas de soluçóes para esta integral, visando-se principalmente a rapidez e a precisão nos cálculos.
Esta integral deve ser calculada numericamente em instantes discretos, ou seja, nos pontos onde se conhece os valores de pressão no período de fluxo, ou nos tempos onde se calculou o valor de p ttD através da inversão numérica da wf
sua expressão obtida no campo de ¿.cplczce.
Deve-se notar que o tipo de função existente no integrando é o produto de uma função com declínio exponencial Ce D pelos valores de pressSes de fluxo no intervalo CO-tpD, que neste caso são sempre crescente para o poços não surgentes. O resultado é um i ntegrando decrescente rapidamente com o tempo.
Dentre os princípios utilizados para a resolução desta
integral podemos citar: i&gt; Integração direta qualquer para p^CO, anal i tica.
ií 5
Consiste em se adotar uma função tornando-se possível a integração
Integração através
das
f6r mui as de Mswton~CÔtes,
que
utilizam valores calculados da função p^fCt.D, para tempos regularmente espaçados.
iii3 Integração através da fórmula de quadratura óuctssíctno.
que utiliza pontos diferentementes espaçados, onde este es paç amento é deter mi nado por c er t as pr opr i edades dos
pol1nômi os or togonai s.
iv? Integração direta dos coeficientes dos polinómios cúbicos obtidos após interpolação de p Ct) por splines cúbicos.
vJ Quadratura da biblioteca de subrotinas do IMSL que
utiliza basicamente os mesmos princípios do item Civl acima, vi? Integração usando técnicas de transformada de Laplaee. vii? Integração através de uso da função 8-splines com quadr ados mí ni mos.
O apêndice E apresenta o desenvolvimento teórico e comparativo de cada um destes métodos.
A Tabela 3.7 a segui r apresenta uma comparação resund da entre os resultados obtidos Cseguindo a mesma numeração ací ma?, pri nci palmente quanto ao tempo gasto e quanto a conf i abi1i dade,
Método	Vantagens	Desvantagens	tempo padrão
	Rapi dez	Não é genérico	80 seg
ii	Facilidade	Demora	7S00seg
i i i	Faci1i dade	Não confiável	40 seg
i V	Precisão	Não é genérico	30 seg
V	Precisão	Repetiti vo	53 seg
vi	Precisão	Não confiável	33 seg
vii	Gener aii dade		5 seg
Tempo r equer i do par a cál cul o e i mpr essao de um per í odo de estática padrão formado por 33 pontos.
Tabela 3.7-Quadro comparativo de métodos de integração.
As Tabelas 3.8 e 5.9 a seguir apresentam um estudo comparativo dos diversos métodos para a solução da integraih no casos em que pwftt? = t ou pwfCt? = -/t para s = tp = 1.
Estas funçSes tem derivadas diferentes no tempo zero de fluxo, o que é uma condição auxiliar usada na interpolação por splines.
A função pv{CO = t tem um comportamento crescente e linear semelhante ao crescimento de pressão de fluxo em poços não surgentes de baixa produtividade. Suas derivadas primeira e segunda são constantes iguais a um e zero respectivamente.
Estudo comparativo dos métodos de solução de . t.dt	=*	pvfBt&gt;tp“S“l.			
Método	Pr i nci pi o matemático	Resultado	Erro %
Integraçao analítica	Integração por par tes	0.364341117	O
Integração dos coeficientes de interp.	Spli nes cúbi cos	0.264341117	0
Quadratura do IMSL	Spli nes cúbi cos	0.2642407138	-8D-4
Tr ansformada de 1aplace	Inversão númerica por Sleli/esl	0.3651804479	O. 36
Tr ansf or mada de ¿.aplace	Inversão númerica por Crump	0. 864341117	0
Inter polação com quadrados mini mos	B—Spli nes com quadr ados mi ~ ní mos	0.864841117	0
Tabela 5.8 ~ Compar açSes dos	resultadas da i ntegr ação
—t
da função FCt&gt; “te através de diversos métodos.
A função Pwf£ tD “ t tem um comportamento crecente e levemente assintótico que assemelha ao crescimento inicial de pressão de fl uxo em poços não surgentes de alta produtividade. Suas derivadas primeira e segunda tem valores infinito no tempo zero.
Estudo comparativo dos métodos de solução de			
U	r	dt ío	"wf=7t,tp=S:i.	
integ. Gauss, com 3 pontos pZ 100 subdi v	Polinómios ortogonal s	O.378947357	6D-4
IntegragSo dos coeficien-tes de interp.	Spli nes cúbicos	O.378943890	O
Quadratura do IMSL	Spli nes cúbicos	0.3763631362	-0. 71
Transfermada de Laplace	Inversão numérica por Crwnp	0.37894343823	0
Intergraq2to cZ quadrados min.	B-Splines cZ quadrados mínimos	0.37609861199	-1.0
Tabela 3.9	- Comparações dos resultados da integração
da função FC t&gt; - V t e através de diversos métodos.
Do estudo feito para escolha do método apropriado para o cálculo da integral conclue-se que:
15	As melhores rotinas para o cálculo da integral quanto ao critério da precisão dos resultados são: Quadradatura do IMSL, Integração numérica usando a transformada de ¿apíace e a integração numérica dos coeficientes da função B-splines com quadrados mínimos.
113 O algoritmo desenvolvido por Crump fornece valores conf1ávei s par a o cálculo da i ntegr al atr avés do uso de transformadas de lapiace.
iii3 Como a quadratura do IMSL exige muito tempo para calcular o valor da integral, e o método da transformada de Laplace exige o conhecimento das funções de Bessei modificadas para argumentos complexos Cque não estão dispaniveis5, deve-se então usar o processo de integração dos quadrados mínimos com a função B-spiines, que foi o método que exigiu menor tempo de computação e é igualmente preciso e
genérico.
iv) No método de integração por funções B-splines com quadrados mínimos, existe a depêndencia da preeisSo da integrai com o número de funçSes B~splines utilizado» que define o número de sub-intervalos que serão usados para fazer a interpolação. Porém concluiu-se através de integrais conhecidas que para o número de B-splines igual a 2» obtém-se o valor exato da integração.
v3 As integrais obtidas pela derivação da expressão da pressão com relação aos parâmetros Cvide apéndice O devem ser resolvidas por este método.
5.3.2.	Otimização para o período de estática
Para o teste do método foram gerados dados de pressão estática a partir de:
13 Parâmetros de fluido e rocha mostrados na Tabela 5.1.
ii3 Dados do fluxo artificialmente gerados e apresentados na Tabela 5.2.
1113 Cálculo da integral pelo método de integração por funções B-splines com quadrados mínimos.
iv3 Parâmetros de fluído produzido e dados mecânicos do poço, para o cálculo de C , definidos por:
Si
Dados do poço e do fluído
C = 88.2 x 10"6 atm_í
v
Prof. packer = 810.39 m	Fundo do poço = 882. Si m
Tabela 5.10	- Dados arbitrados para geração de pressão
estática.
A partir destes dados, pode-se determinar o volume da
&lt;5	3
câmara de estocagem Vw =0.44694-8545x10 cm e o fator de estocagem da estática C =39.42 cm’/atm.
s
A Tabela 5,10 apresenta cs dados de pressão estática resultante.
tChr?	pvacPsieP |	tChrl	PvaCpsig3 |	1 tC hrl	77^77
0. 022	718. 304	0. 209	780.089	0.774	861.560
0. 025	719. 896	0.235	786. 814	0. 835	863. 179
0. 034	723.044	0.264	793. 846	0. 938	870. 107
0. 041	725.737	0. 295	800.846	1.051	874.139
0.053	730. 319	0. 334	808.941	1. 181	877. 519
0. 067	735. 502	0. 372	816.120	1.325	880.080
0. 084	741.595	0. 418	823.955	1.486	881.953
0. 105	749. 161	0. 470	831.792	1.666	883. 240
0. 132	757.630	0. 528	839.400	1.870	884.068
0. 166	768.042	0. 590	846.377	2. 098	884. 541
0. 187	774.073	0.662	833. 196	2. 189	884.652
Tabela 5.11 - Dados gerados de pressão estática vs tempo.
Para a aplicação do método serão usados:
13 As condições Ci3, Cii3 e Ciii3 da seção 5.2.
ii3 A equação CD. 1.13 e as derivadas deduzidas no apêndice D. v3 o programa apresentado no apêndice G.3.
Deseja-se encontrar o grupo de parâmetros através de minimização da função objetivo considerando apenas o período de estática.
Â Tabela 5.12 a seguir resume os resultados obtidos:
Parâmetros	Solução	Num.	SSR	Valor	Sr ro
arbitr ados	calculada	total			per-
inici al mente		i tera-		param.	een-
c si.	f cr	A Ir.	V -f	çdes	C atmZ2?	Cs. Dorcyl	V •* w
k = 0. 50 S =0.	k = 1.384 S =2.00	8	-4&amp;lt;10	k =1.384	0. 0.
p. =60. 18 *L	p. =60. 68 t			S =+2.	0.
k = 0.1384 S =0.20	k = 1.385 S =1.88	8	”1&amp;lt;10	p =5.85 O	0. 07 0.
C - 3. 34 s	C =70-44 a				78.
k = 0.028 = 0.78	k = 1.384 C =50. 02 s	6	-1&amp;lt;1O	p. =60, 66 L	0. 27.
S =0.667 =19.71	S =1.99 =45.27	6	-1&amp;lt;10	Cf =85240	0. 05 15.
p. =60. 18 í. = 0. 78	pT =60, 18 *L c =50.oa £	8	-1&amp;lt;10	C =33,43 Gt	0. 27.
Tabela 5.12 - Resultado do método de Z.evem&amp;amp;er^-?farQuardt com cálculo das derivadas por inversão númerica para o período de estática do DST, tentando determinar k, S( p. e C .
5.3.2-1 “ Discussão do método e dos resultados obtidos
Para o período de estática, o conjunto de parâmetros melhor determinado é formado por k, S, e P . Quando o conjunto de parâmetros inclui o fator de estocagem C » há convergência sem que se atinja os valores corretos dos parâmetros. Â Figura 5.7 mostra a evolução das parâmetros calculados durante as iteraçdes.
1.5
1.0 ----------—J-------------1--------------1------------
0	2	4	^6	8
N. de Iterações
Figura 5.7 ~ Otimização para a estdtica
5.4.	OTIMIZAÇÃO NQS PERÍODOS DE FLUXO E DE ESTÁTICA
A otimização será feita com base na cálculo dos gradientes de pressão por inversão numérica das expressSes no espaço de Lapioce.
Usando-se a experiência obtida nas aplicacSes dos métodos descritos nos itens 5. £ e 5.3, serão determinados os parâmetros que explicam simultaneamente os dados do fluxo e estática.
Geraram-se dados de pressão vs tempo para um DST completo, os quais estão apresentados na Tabela £5.14 e na Figura 5.8 :
Dados de pressão							
Período de fluxo				Período de estática			
t				At	p ws	At	p
Chr?	f" rsc* i z-x	3 Chr?	CpsigD	ChrD	Cpsi çp	ChrZ)	C psi gl
0. 000	86. 0	0. 264	449. 1	0.000	759. 4	0.372	850.6
0. 022	152. 0	0. 295	472. 8	0.022	781.4	0. 418	853. 9
0.025	160. 5	0. 334	500. 0	0.026	782. 7	0. 470	856. 4
0. 034	176.5	0. 372	524. 3	0.034	785. 2	0. 528	858. 5
0. 041	183.6	0. 418	550. 8	0.041	787. 4	0. 590	859. 9
0.053	210. 7	0. 470	577. 7	0. 053	791.1	0.662	860. 9
0.057	233. 3	0. 528	604. 4	0. 067	795. 2	0. 774	862. 0
0. 084	258. 8	0.590	629. 6	0.084	800. 2	0. 835	862.6
0.106	288. 9	0. 662	&amp;lt;iMi	0.106	806. 3	0. 938	863. 6
0. 132	321.2	0. 774	688. 8	0.132	813. 0	1.051	864.8
0. 166	359. 3	0. 835	704. 1	0.166	821.0	1.810	866. 3
0. 187	380. 7	0. 938	726.8	0. 187	825. 4	1.325	868. 1
0. 209	401.8	1.051	747. 6	O. 209	829. 8	1.486	870. 1
0. 235	425. 1	1.260	759. 4	0.235	834. 3	1.666	872. 0
				0. 264	838. 8	1.870	873. 9
				0. 295	843. 0	2. 098	875. 5
				0. 334	847. 2	2. 189	876. 1
Tabela 5.13 - Dados simulados de um DST completo Cum ciclcD.
Os dados gerados Cvide apêndice H?, para o DST completo, assumem os valores apresentados nas Tabelas 5.1 e 5.2, assim como os dados mecâni cos do paço e do fluí do produzi do
r esumidos	na	Tabela 5. 10,	considera-se também	que:	
		r P vf	se	0&lt;t&lt;tp	Cequação	3. 33
	~	4	p CtD	se	t&gt;tp	C equação	3. 7&gt;
Ã Figura 5.8 abaixo mostra os dados: gerados de pressão vs tempo para este DST.
Fig. 5.8 — Dados gerados para DST
5.4.1.	Otimização para o DST completo
A Tabela 14 abaixo apresenta uma tentativa de se determinar todos os 6 parâmetros que definem o DST, usando o programa do apêndice G. 4.
Parâmetros iniciai s Csis.	Sol uçãío calcuiada Cs. DarcyO	Num. itera-çE5es	SSR C atmZD	Valor real Cs. DecreyO	Erro %
k = 0.923 S - 1.333 p =50.04 C =59.13 K c =56330 p =40.65 o	k = 0.783 £ = 2. 28 p. =60. 68 L C =21.56 8 C =48250 p =5.85 o	5	-3&amp;lt;1O	k = 1.384 £ = 2. 00 p.=60. 68 i C =39.42 fit C =85240 f p = 5.85 o	-43. 14. 0. ~45. -43. 0.
Tabela 3.14 - Resultado do método de	com
cálculo das derivadas por inversão númerlca para o DST de um ciclo, tentando determinar k, S, p.» C . C , e p .
t e f	o
A	Fi gur a 5.9 mostra a aderénci a perfei ta que existe
entre os valores medidos e calculados com os dados acima.
Fig. 5.9 - Otimização no fluxo e na estática
5.4.2.	Discussão dos resultados obtidos e novas propostas para determinação dos parâmetros.
Da experiencia numérica, vê-se que não é possível deter mi nar todos os sei s parâmetros simuitaneamente pois não há convergência para os valores corretos, embora o resíduo final seja baixo.
Para se determinar apenas 3 ou 4 parâmetros deve-se fixar os demais. Para a aplicação do algoritmo num caso real, quando não são conhecidos os valores corretos a serem fixados deve-se descobrir uma maneira de determiná-los corretamente.
Nas aplicaçSes anteriores do método, os dois parâmetros que apresentam pi or condi ci onamento eram os coefi ci entes de eslocagem no fluxo e na estática, e C.
Suponhamos que se fixem os valores dos coeficientes de estocagem, restando então 4 parâmetros a se determinar: k, S. p. e po.
Estes quatro parâmetros podem ser determinados simultaneamente para dados gerados, como mostra a tabela 5.15.
Parâmetros	Solução	Num.	SSR	Valor	Erro
arbitrados	calculada	total		real	per-
i rri i**- 4 -i 1 a. a * a. i» d.	a i w Vw		i i oi r- o *— A. S?	«A		param.	cen~
Cs. liare y 5	Cs. Deurcyl)	ç&lt;3e?s	C atra*}	C s. £jetrcy&gt;	5í
k = 1.110	k = 1 .384			k = 1.384	0.
s =-i.	S =-2.			S =-2. 00	0.
p =60.92 L	p -60,68 t	5	&lt;10	p. =60. 68 t	0.
p = 6.80 o	p =5.85 Ct			p = 5. 83 a	0.
Tabela 5.15 - Resultado do método de ¿evember^-^orquordi com cálculo das derivadas por inversão númerica, para o DST completo, tentando determinar k, S, p. e p .
Outra al ter nativa é a de se otimizar os parâmetros por etapas:
O Áplica-se a regressão não linear ao fluxo usando como p o
i
últi mo vaior lido da estáticat ou o vai or extr apolado do gráfico do método de Corrêo, e determina-se k, S e p
Q
iil Com os valores aproximados estimados em Cil aplioa-se a regressão não linear na estática e determina-se p^ correto. 1113 Volta-se ao item Ci3 com p. correto e determina-se p
X	o
correto.
vi3 Com o valor de p correto determina-se então os valores o
de k,S e p^ que satisfazem o fluxo e estática dentro do critério estabelecidos.
À Tabela 5.16 a segui r resume este últi mo procedi mento:
Parâmetros	Solução	Num.	SSF	Vai or	Erro
arbitrados	calcul ada	total		real	per -
inicialmente		itera-		param.	cen-
C si s. Z?arcy3	Cs. Darcy3	ções	Catm23	C s. Dar cy3	%
k -0.50	k = 1.384			k -1.384	0.
S -0.	S = 2. OO	8	&lt;10~4	S =+2. 00	O.
p. =60.18	p =60,68 L			p,=60, 68	0.
Tahei a 5.16 - Pesultado do método de tevember^-^orquordí com cálculo das deri vadas por i nversSo númerica t para o DST completo, determinando k, S, p corretos.
O comportamento da função objetivo dur ante as vár i as etapas da otimização está apresentado na Figura 3.10, que nos mostra que em cada período há uma redução brusca nos valores dos resíduos.
Calculado/Real	Funcao objetivo (atm2)
Fig. 5.10 ™ Funcao objetivo nas etapas da otimizacao
Funcao objetivo (atm2)
Rtgura 5.11 — Otimização no fluxo e na estática
O estudo de sensibi1idade do ajuste aos parâmetros C e C estão apresentados nas Figuras 3.18 e 3.13. Eles indicam £
que os parâmetros k, S e p são pouco sensíveis à variação de C^. Entretanto, esta indicação precisa de investigação mais profunda, uma vez que a regi ão de mai or í nf1uenci a de encontra-se logo após o fechamento do poço, onde o gradiente de pressão em relação ao tempo é elevado, podendo causar imprecisão no cálculo da transformada inversa através do método de Stehfest.

Cf(grtiiiroao)/Cf(n&gt;o!)	Cs(ortiitrqda}/Cs{real)
- Serxi&amp;amp;iiiOAQe aos	rcs a estocagr?
ce per i crscj ere í 1 ux»
pens 2 bii i naoe act ci*rart»etr©s a ectcçacer oi* pétiOítc- tiv etiá.u*
Quanto à sensibilídade dos parâmetros em relação a C , nota-se que existe uma relação linear entre a variação de Cf e a permeabilidade, e inversamente proporcional em relação ao “skin**. No caso estudado na Figura 3.12 o "skin" é negativo e por isto embora seu valor real descresça a razão entre valores calculado e real é crescente.
O cálculo de C depende pr i nci palmente da densi dade do fluído produzido. Â sensibilidade dos cálculos doa parâmetros com o valor de C mostra a importância da determinação correta da densidade média dos fluídos produzidos no teste.
6.0. APLICAÇÃO DA INTERPRETAÇÃO AUTOMATIZADA EM DADOS REAIS
Até agora, discutiu-se basicamente a solução analítica do DST e sua aplicação no ""match" automatizado dos dados simulados. Descobriu-se que os parâmetros que podem ser determinados pela regressSo nSo linear sSo k. S. p. e p=.
Viu-se também que entre todos os parâmetros que foram mantidos fixos, o que mais influencia os resultados da análise do teste é a densidade do fluido produzido, pois dele depende o coeficiente de estocagem do fluxo C .
Passaremos então A aplicar este método de regressão não linear a dados reais de campo obtidos nos testes de formação.
6.1.	Otimização em poços de alta produtividade.
Nos poços de alta produtividade há uma tendência de - amortecimento de pressão durante o fluxo.
A aplicação da regressão não linear para o teste composto de um ei cl o compl eto será f ei ta de acordo com os princípios apresentados na seção 5.4.
Para a determinação dos valores iniciais dos parâmetros para o processo de otimização usou-se os seguintes critérios: i&gt; O método de Cor-réc, o qual foi automatizado para cálculo de k, e p , tomando-se os 6 pontos finais da estática. LiÇ O valor lido da pressão de abertura para p .
iii3 O último valor lido na estática como sendo p..
t
iv2) O valor discreto do Sfein entre -3 e 3 que conduz ao menor resíduo entre os dados observados e calculados durante o fluxo.
Vamos estudar inicialmente o exemplo A apresentado por Corrêa C1SS8X Trata-se de um DST feito a poço aberto num campo de ól eo vi scoso C Car mópol i s -SE j . O r eser vatór i o é um conglomerado que foi completamente aberto para fluxo.
O detalhe dos dados de pressão vs tempo e demai s informaçbes estão apresentados na Tabela 6.1, e Figura 6.0.
	Dados do poço do fluído e				da rocha		
= 0.	062			h = 38	ft		
API =	25.92			C = 10. t	.	—6	, ~1 v í A	rsc-'í f*r “	p-** w,		
r = 0 w C =6 V	.354 ft .0x10	-6 psxg	-1	r = 0.159 ft p -1 C = 0.0365 RB/psig			
p = 60 cp							
Prof.	packer	= 810. 39 m		Fundo do poço		= 822.61 m	
		Dados de		pressão			
Per i odo		de fluxo		Período		de estática	
	Pvf	+ .	pvf	At	^ve	At	p WS
Chr)	C ps 1 g?	C hr3	Cpaigl	ChrO	Cpa tg3	C hr □	C pa t gZ&gt;
0.000	142. 4	0.264	430. 3	0.000	712. 2	0. 372	856. 6
0. 022	186. 2	0. 295	449. 6	0. 022	766. 9	O. 418	858.2
0. 026	195. 1	0- 334	470. 9	0. 026	798. 7	0. 470	859. 4
0.034	209. 9	0. 372	491.0	0.034	816. 4	0. 528	861.0
0. 041	221.6	0. 418	511.1	0. 041	824. 0	O. 590	862. 2
0.053	239. 3	0. 470	537.7	0. 053	830. 9	0. 662	863. 4
0. 067	261.8	0. 528	561.0	0 . 067	835. 7	0. 774	864. 6
0. 064	282. 3	0. 590	583. 9	0. 084	838. 9	0. 835	865. 8
0.106	310. 5	0. 662	607. 3	0. 106	841.3	0. 938	867. 4
0. 132	333. 4	0. 774	630. 2	0. 132	844. 1	1.051	868. 7
0. 166	364.0	0. 835	655. 1	0. 166	846. 9	1.810	870. 3
0. 187	380.0	0. 938	677.2	0. 187	848. 5	1.325	871.5
0. 209	394.9	1.051	698. 9	0. 209	849.8	1.486	872.3
0. 235	412. 2	1.260	712.2	0. 235	851.4	1.666	873. 3
				0. 264	852. 6	1.870	874. 7
				0.295	853. 8	2.098	876. 3
				0. 334	855. 4	2. 189	876. 3
Tabela 6.1 ~ Dados poço A - C SPE 16802 3
Figura 6.0 ~ Carta do DST no poço À C SFE 168020
Á interpretacão manual foi feita pelo método de Corréez na estática para calcular k e p^, e pela análi se da pressão de fluxo vs raiz quadrada do tempo para calcular S e p .
O
Parâmetro	Vaior calculado	Uni dade
Permeabi1i dade C k 1	1.884	Darcy
Efeito de Película CS)	-3. 4	-
Pressão estática reserv. Cpil	60.68	
Pressão fluxo inicial Cpol	5. as	atm
Tabela 6.2 - Interpretação gráfica manual poço A ~ SFE 16802.
A Interpretação automatizada foi feita usando o programa apresentado no apêndice 6. 4 e tivemos o seguinte resultado:
Parâmetro	Valor I ni ei ai	Valor CalcuIado	Uni dade
Permeabilidade CIO	1.16	1.03	Darcy
Efeito de Película CS)	~1.0	-2. 21	-
Pressão estática Cp.3 L	60. 54	61.46	atm
Pressão inicial Cp D O	9. 69	8. 28	atm
Tabela 6,3 - Interpretação automatizada poço A — SPE 16802. Vejamos a Figura 6.1 para discussão dos resultados.
1000
T
T
T
800 -
CL
600
o o~ o CL
o e
O iO
tn
&lt;n o k.
o.
400
200
Legenda
Dados lidos do DST
Dados calculados de pressão
Resíduo (~ P. lida — P. cale.)
+■
f*****M*l |.M &gt; *++ *- + + ++ ++	+	+	+ +
+ + + +H.
~20&amp;amp;í)
i____________!______._____!---
1.0	2.0	3.0
Tempo acumulado de teste (h)
4.0
Fíg, 6.1 - Otimização no DST do poço A

* o
6.1.1.	Discussão dos resultados
Pela aplicação do método verificou-se que:
13	O programa funcionou bem e a convergência foi rápida.
Ü3 Q valor final da função objetivo é de 41.08 atmz.
iii3 Os trechos que apresentaram maiores resíduos foram o final do fluxo» o início da estática e o final da estática. iv3 Os	menores resíduos foram obtidos nos trechos
i	ntermedi ári os.
v3 Quanto à comparação dos resultados obtidos pela interpretação automatizada e pela interpretação manual» observa-se diferenças acentuadas nos valores dos parâmetros.
6.1.2.	Nova proposta para otimização do DSTT&amp;lt;1 cicloJ
Na análise de DST’s os trechos mais importantes para interpretação com gráficos específicos Cmétodos de Corrêa, Worner, Cartesiano» etc.3» são os finais da estática e do fluxo uma vez que os dados nestas faixas estão pouco influenciados pela estocagem .
Sabe-se também que os registradores de pressão tem seu intervalo de medição ideal que é de aproximadamente de 30% a 80% de sua capacidade máxima. Este fato» junto ao grande choque iniciai imposto à formação no DST» podem explicar a má qualidade da leitura obtida de pressão obtida neste trecho.
Para a otimização foram fixados os valores dos coeficientes de estocagem de fluxo CCf3 e estática	» o
que torna o período de estocagem quase definido.
Por outro lado» os valores de pressão calculados para os pontos iniciais da estática não são confiáveis devido à limitação do algoritmo de inversão numérica de Steh/est.
Por todos estes motivos expostos acima parece que se houver minimização dos resíduos nos trechos finais dos respectivos períodos o resultado da interpretação do teste será mais confiável. Isto pode ser feito atribuindo pesos
E55
individuais aos pontos lidos proporcionalmente ao seu valor de pressão.
6.1.3.	Interpretação automatizada usando pesos diferenciados por pontos.
Usando o mesmo programa apresentado no apêndice F't mas atribuindo pesos para cada ponto lido, proporcional à pressão
do período.	que em forma	de desvio padrão é:	
	Pff		
o. “	i - 1 ,	ndf.	Para pontos do fluxo e
			
o. =	Pvef .	d t = l,	nde.	Para pontos da estática.
	p		
O resíduo será a diferença de pressSo dividido por o..
O resultado da interpretação automatizada fica então:
Parâmetro	Vai or Inicial	Valor Calculado	Uni dade
Permeabi1idade Ck?	1.18	1.31	Dcrcv -y
Efeito de Película CSD	-1.0	-1.31	-
Pressão estática Cp, 3	60. 34	60. 78	atm
Pressão inicial Cp J 0	9.69	9. 13	atm
Tabela 6, 4 ~ Interpretação automatizada poço A ~ SPE 16802.
Observando a Figura 8.2 apresentada na página seguinte vemos que os trechos com maiores resíduos são os trechos iniciais do fluxo e da estática. O trecho com menor resíduo agora é o final da estática, com a função objetivo da última
2
iteraçSo igual a 22.73 atm . Este ajuste parece explicar melhor o histórico da pressão. Na Figura 6. 3 a curva gerada com os dados da .interpretação manual é o que apresenta pior desempenho, talvez devido aos valores errôneos obtidos para o skin e a pressão inicial do gráfico pwfCtD vs /t
Ffg. 6.2 - Otimização com peso no DST do poco A
1000
300
g&gt; *w
Q.
« fl •
O u o CL
o
c:
o ‘O
&lt;íi td li
a.
600
400
Legenda
Dados fidos do DST
Dados calculados de pressão Dados interpretação manual
200 F
8.o
---í---------------i______________L—.-.■■■ t
1*0	2,0	3,0
Tempo acumulado&amp;lt;íe teste (h)
4.0
S
4

T
* • ♦
0
* o
frg. 6,3 - Comparação dos resultados manual x otimizado
6.1»4. Outros exemplos estudados
A Tabela 6.6 abaixo apresenta os resultados comparativos em outras aplicações do método para teste de formação de um eielo em poços de alta produtividade.
Poço	Parâmetro	Resul tado das i nter pretaçÊSes do teste		
		Gráfica Manual	Automati zada Csem pescD	Automati zada Ccom pescO
Cp-113	k E md]	6. 5	4.8	5. 3
	S [ ]	2. 3	-1.3	-0. 9
	p. E atm]	19.07	19.13	19.08
	p £ atm] O	7.07	6. 71	6. 81
Cp-137	k E md3	4. 00	2.16	3. 21
	S E 1	-2.01		-3. 97
	p [ atm]	25. 99	27. 99	27. 22
	p EatmJ o	3. 49		4.68
Cp-222	k E mdJ	81.60	17. 46	20. 01
	S £ ]	-3.10	-3. 38	-a pia
	p, E atml t	41.80	42. 64	42. 30
	p E atm] O	8. 67	3. 92	3. 68
Cp-295	k E md]	264.00	310. 80	318. 90
	S E ]	-3.46	~3. 28	"3. 33
	p. E atm] t	38. 33	38.00	38. 00
	p E atml O	3.58	1.48	0. 00
Tabela 6. 3 ~ Outros exemplos de otimização em poços
As Figuras 6.4 a 6.11 a seguir mostram os respeetivos ajustes de curvas obtidos. A análise dos resíduos* indicará a aplicabilidade do modelo e/ou a qualidade dos dados do DST.
Pressão no poço (psíg)	Pressão no poço (psig)
Fig. 6.4 ~ Otimização sem peso — poço CP 115
Ftg. 6.5 — Otímizaçao com peso — poço CP 115
5Q
Pressão no poco (psig)	Pressão no poço (psig)
Fíg. 6.6 — Otimização sem peso - poço CP 137
Fíg. 6.7 - Otimização com peso — poço CP 137
ÔO
Pressão no poço (psig)	Pressão no poço (psig)
500
300
100
$
*
*
*
*
o -
f
¥
+ o

-,0&amp;amp;
		
Legenda
Dados lidos do DST
Dados calculados de pressão Resíduo P. Sida - P. calc.)
1
1
To
Tempo acumulada de teste (h)
Fíg. 6.8 ~ Otimização sem peso ~ poço CP 222
700
500 -
300
100


T
T
T
T
T
T
T
8.0
****** * ♦ * *
♦
♦
f
*♦*
Legenda
* Dados lidos do DST
+ Dados calculados de pressão o Resíduo P. lida - P. calc.)
G Q O C ÍJ O O O CJ 0 O 0
T
1
__}
A.O Tempo acumulada de teste (h) ^Eíg. 6.9 — Otimização com peso — poço CP 222
1Ofio
1
8.0
Pressão no poço (psig)	Pressão no poço (psig)
Fig. 6.10 — Otimização sem peso - Poco CP 295
Fíg. 6.11 — Otimização com peso - Poço CP 295
6.2	- Otimização em poços de baixa produtividade
Nos poços de baixa produtivadade há um crescimento contínuo de pressão, sem tendência de amortecimento.
Iniciaimente será aplicado a regressão não linear, para o teste composto de um ciclo completo, usando-se os mesmos pri ncí pi os da seção 6.1.3 para defini çâo dos vai ores i ni ci ai s dos parâmetros e da seção 5.4 para a convergência do método.
O TFR**3 CTeste de formação revestido n? 33 do poço 7-Cp~760-Se é um exemplo de DST com baixa produtividade, conforme mostra o desenho esquemático da carta na Figura 6.12 abaixo:
Fig.6. 12 - DST no poço 7 - Cp - 760 - Se CTFR-33.
A Tabela 6.6 mostra as respectivas pressSes no poço:
Dados lidos de pressão do poço : 7-Cp-76O~Se							
Período de fluxoCK)				Período de estática			
t	pwf	t	Pvf	At	p va	At	p
CpolZJ	CpolO	C poi 5 C pol ?		CpolO	C pol 3 C pol 2)		cpon
0.000	0. 143	0.318	0. 416	0. 004	0. 629	0.110	1.599
0.043	0.182	0. 379	0. 378	0.006	0.642	0. 120	1.608
0.086	0.221	0.441	0. 491	0.009	0.660	0.140	1.629
O. 129	0.261	0.502	0. 529	0. 011	0. 679	0.155	1.631
A 1 TM W * «h í a»	0.300	0. 563	0. 366	0.014	0. 706	0. 175	1.641
0. 214	0. 339	0.624	0. 604	0.017	0. 733	0.195	1.650
0. 257	O. 378			0.019	0. 7&amp;amp;&amp;amp;	0.220	1.659
				0.022	0.827	0. 245	1.667
				0.025	0. 904	0.275	1.674
				0. 028	0. 996	0. 310	1.682
				0.031	1.082	0.350	1.689
				0.035	1.186	0. 390	1.695
				0.039	1.275	0. 440	1.702
				O. 044	1.341	O. 490	1.708
				0.049	1.405	0.550	1.714
				0.065	1.456	0. 620	1.720
				0. 062	1.499	0.780	1.730
				0. 069	1.326	0.870	1.734
				0.078	1.552	1.980	1.738
				0.087	1.568	1.100	1.743
				0.098	1.584	1.205	1.746
Equação	de calibração		registrador e constante do relógio				
	Pvf =	M t + A	ou	p Vfi	—	M At + A		
	M	377.81200 psigZpoi.	¿			L =	“3.	0431 psi g	
	Kr ei .	=	4.8 hZpol.					
C Os dadas de pr essões de f 1 uxo foram obti dos por i nter polação 1i near em 2 trechos, por que só se di spunha da pressão de fluxo inicial e final no relatório de teste.
O teste foi executado com o obj eti vo de determi nar a produtividade» permeabilidade» dano, pressão estática e demais parâmetros da formação. O tempo de fluxo foi de 3 horas e o de estática de 6 horas.
A Tabela 6.7 mostra os demais dados a serem usados para a interpretação do teste:
Dados de fluido e rocha do poço: 7-Cp-760-Se
&lt;£ = 0.146	h = 6. O m
API = 22.8	Ct- 9. 62 x lO^psig"1
r = 3.183 pol.	p = 61.9 cp
W -6-1 °
C = 6.0 X 10 psig
*J	3	3
Capacidade da coluna de produção » 0.00302 m Zm
Prof, packer = 577.00 m	Fundo do poço ~ 350.24 m
Tabela 6. 7 - Dados de fluído, rocha e mecânico do 7-Cp-7SO-Se
A Tabela 6.8 mostra o resultado da interpretação manual
Parâmetro	Vaior calculado	Método
Permeabilidade E md 1	113.76	Horner
Coeficiente de película [ 3	0. 92	Horner
Pressão estática Eatrn]	45.79	Horner
Pressão fluxo inicial Eatm 3	3. 60	-
Tabela 6. 8 - Interpretação gráfica manual poço 7-Cp-760-£e.
A Interpretação automatizada foi feita usando o programa do apresentado no apêndice G. 4, com o seguinte resultado:
Parâmetro	Valor I ni ci ai	Valor Calculado CO	Valor Calculado C**T
Permeabilidade E Md 1	59.9	86. 2	133.0
Efeito de Película E 1	-1.0	1.07	3. 58
Pressão estática EAtm)	46.11	46. 33	45. 57
Pressão fluxo EAtml	3.47	2.78	2. 78
* Interpretação com pêso diferenciado e SteA/est com N ~ 20. ««Interpretação com pêso diferenciado e SteA/est com N = 10. Tabela 6. 9 - Interpretação automatizada poço 7-Cp-760-Se.
As Figuras 6.13 e 6.14 mostram estes resultados:
çn
t/i
n
o
o
CL
0 c
o o w cn a&gt;
CL
800		T"'	  T	  '	!		í		
600		.$tm*** * * * * *	*	* à	-
		$		-
400		f &amp;amp;	Legenda		
		* * Dados lidos » +■ Dados calculados		
				
		1 o Residuo(= lido-calc.)		
200	-	* * *		-
		*		-
		A		
0	hJ e a o o » o	e ©	« o t»	0 Q o g o	9	o	4	O	0	
		o s		
“2C®		0 / 1 1 1	1	
	0	4.Ó	8.0	
		Tempo acumulado de teste		
Fig. 6.13 - Otimizacao com peso — Poco CP 760
700
500
300
/
♦
*
*	Legenda
/ * Dados lidos
*	4- Dados calculados
o Resíduo(~ lído-caíc.)
100
-
,r
&lt;s o « a »
Cl
T
*
*
*
9
o
-100
1
-3O&lt;9.o
1
__í	I	I_ 4.0____________________________8.0
Tempo acumulado de teste (h)
F7q 6.14- - Otimízacao com peso ~~ Poco CP 760
(N = 10)
C3. a. 1 ~ Discussão dos resultados
Pela aplicação do método verificou-se que:
xl O programa funcionou bem e a convergência foi rápida.
113 O valor final da função objetivo é alto O ¡238.7 atmz3. iiiO O trecho com maiores resíduos foi o do inicio da estática.
iva Nos demais trechos verificou-se resíduos baixíssimos.
v&gt; Quanto a eompar ação dos resultados obti dos pela interpretação manual e automatizada ícom pêsos e para diferentes parâmetros N de S£eh/est3 nota-se semelhanças bastantes acentuadas nos valores finais dos parâmetros.
O método dos quadrados mínimos não lineares faz um ajuste final da curva de tal modo que, além da soma dos quadrados ser	mínima, há uma distribuição uniforme dos erros ou
resíduos. Como isto aconteceu no exemplo acima, podemos dizer
que o método de regressão funcionou satisfatoriamente e os resultados podem ser aceitos.
O grande problema da aplicação desta metodologia de otimização está exatamente no algoritmo de inversão numérica das expressões da pressão e gradientes de pressão para poços de baixa produti vidade.
O algoritmo de Stehf&amp;amp;st usado tem apenas controle sobre a precisão dos seus coeficientes» mas não tem nenhuma condição de convergência imposta para diferentes tipos de funções a serem invertidas» lago ele fornece uma resposta que pode ser incorreta.
Para a inversão de funções contínuas» mas com descontínuidades nas derivadas» como é o caso da expressão da pressão de fluxo para a estática em poços de baixa produtividade, o algoritmo de Stehfest não fornece valores corretos.
Uma alternativa para a análise do teste é aplicar o método reti rando estes pontos i ni ci ai s da estáti ca onde o algor11mo não funciona corretamente e prosseguír a análise normalmente.
Outra alternativa é fazer esta análise do teste por regressão não linear avaliando as pressões e gradientes de pressões numericamente como por exemplo através do método das diferenças finitas.
6» 2.3. Interpretação automatizada retirando os pontos iniciais da estática
Será usado o mesmo programa anterior» que é apresentado no apêndice G. 4» e também o mesmo critério de pesos diferenciados estabelecido anteriormente; apenas retirando os 34 pontos iniciais da estática.
A Tabela 6.12 da página seguinte apresenta o resultado desta interpretação automatizada, que mostra um resultado bastante próximo da interpretação manual gráfica.
Parâmetro	Vai or I ni ci al	Valor Final
Permeabilidade £ md 3	39. 90	90. 0
Efeito de Felicuia £ 3	-1.	1.19
Pressão estática £atml	46.11	46. 09
Pressão fluxo £atml	3. 47	£.78
Tabela 6.10 - Interpretação automatizada poço 7-Cp-76O-Se.
A Figura 6. IS mostra a curva finai e os resíduos obtidos» donde se concl ui que neste caso o r esui tado f i nal f az um ajuste muito bom com os dados de campos usados.
T
700
cn
cu
500
o u o CL
o c
o o w (71 cu L-.
CL
300
100
♦ *++*** * * *
Legenda
* Dadas lidos
+ Dados calculados
o Resídua(- lido-calc.)
„Cr c o 6 fr â&amp;lt;S 0 u q 0	&amp;amp;
4.0
8.0
Tempo acumulado de teste (h)
■Ftg. 6.13 - Otímizacao com peso — Poco CP 760
6.3.	ANÁLISE ESTATÍSTICA Dá REGRESSÃO
Até agora tratou-se apenas de se obter uma estimativa pontual de um parâmetro desconhecido. Existem contudo vários métodos estatísticos, tais como intervalo de confiança e coeficientes de correlação, que podem conduzir a resultados mais significati vos da análise da regressão. Assim ao invés de í nf or mar apenas o vai or ót 1mo de um dado par âmetr o, pode-se fornecer um 1ntervai o com um certa probabi1i dade de conter êsse parâmetro calculado.
Intervai os de confi ança mui to grande i ndi cam que a análi se não é confi ável.
0 intervaio de confiança de cada parâmetro é computado, segundo Rortíey Cl3643, pela seguinte relação aproximada:
com nível
v. de 952-É oi
ot
a
escolhi do
de
5&gt;0.
para
t	= valor da distribuição de S
OtX2,n-m
risco a CExp. : para inter
O nível de risco&amp;lt;x é tal que
OtZ2;n-m
Assi m, quanto menor o ní vel de rí st análise da regressão, maiores serão os intervalos da confiança dos parâmetros, embora esses dependam também da qualidade dos pontos registrados é da quantidade de pontos n.
Quanto maior o número de pontos, menor será o intervalo de confiança e maior será a confiança nos resultados da otimização.
Adotaremos para este estudo nível de risco o =	que
equivale aos intervalos de confiança de âSS-í.
}
o
O programa apresentado no apêndice G. 4 fornece os intervalos de confiança para este caso.
As Tabelas abai xo trazem cs 1imites destes i nter vai os para o poço A que está sendo anal i sado» consi der ando-se a otimização sem pêso e com pês o diferenciado nos pontos.
Parâmetro Eunid. 3	Limi te Inferior	Li mi te Superior	Valor Õtimo
Per meabi1i dade E Dorcy]	-0. 60	2. 72	1.03
Efeito de Película E 1	-2.29	-2.12	-2. 21
Pressão estática Eatml	61.18	61.74	61.46
Tabela 6.11 - Intervalos de confiança da otimização sem pêso do poço A - SPE 16802.
Parâmetro Eunid.3	Limite Inferior	Li mi te Superior	Vai or õti mo
Per meabi1i dade E Dctrcy3	0.05	2.37	1.31
Efeito de Película E 3	-1.43	-1.20	-1.31
Pressão estática Eatm]	60. 34	61.02	60. 78
Tabela 6.12 - Intervalos de confiança da otimização com pêso do poço A - SPE 16802.
Como vemos o intervalo de confiança de maior comprimento é o da permeabilidade. Isto evidencia que nesta análise este parâmetro pode ser o menos confiável, o que está coerente com a análi se de sensi bi1i dade fei ta anteri ormente no qual verificou—se que este parâmetro era o mais sensível aos valores de densidade média de fluido adotado.
7.0 - OTIMIZAÇÃO NO DST USANDO DIFERENÇAS FINITAS
Estudaremos; a otimização por regressSo nSo linear, sob o critério dos quadrados minimos, calculando as pressSes e gradientes de pressóes com relação aos parâmetros do reservatório via diferenças finitas com o objetivo de:
i3	Comparação entre os resultados obtidos anteriormente pela inversdes numérica da pressão e gradientes via algoritmo de S t eh/es t.
iiD Apresentação de um algoritmo capaz de interpretar todos os dados de pressão vs tempo de um teste de formação de baixa produti vi dade.
O cálculo das pressGes por diferenças finitas consiste em determinar novos valores de pressão no espaço e no tempo, a partir de padróes iniciais conhecidos, como pressão de fluxo inicial Cp reservatório em repouso, etc.
O
O apêndice F apresenta o desenvolvimento teórico do método através das discretizaçóes:
O Da equação diferencial parcial para fluxo radial em r eservatór i o homogeneo,
iD Da condição de contorno interna, que considera o problema do DST como um "slug tesf* com uma mudança brusca do coeficiente de estocagem,
iiil Da condição de contorno externa, que considera o sistema ccm extensão radial infinita.
O apêndice I apresenta o programa que :
i3	Calcula as pressSes no poço através das diferenças fi ni tas.
ii3 Usa a subrotina ZERXTS. LIB da biblioteca de programas do IMSL para cálculo das gradientes de pressão em relação aos parâmetros a serem determinados, e também para a regressão não linear por quadrados mínimos através do algoritmo de tevertóMBrg-Warquardi.
ii3 Calcula as pressSes nos tempos lidos e em mais um ponto intermediário para melhorar a precisão do resultado.
7.1	- Otimização por diferenças finitas em dados simuidaos
Para evitar erros causados pelos dados na aplicação do método» gerou-se dados de pressSes de um DST completo, usando o algoritmo de Sí&amp;amp;tif&amp;amp;st e o algoritmo de diferenças finitas, que está resumido na Tabela 7.1 abaixo.
Os parâmetros de fluído» rocha e poço sào os mesmos das Tabelas 5.1 e 3.10.
Dados simulados de pressão no poço							
Período		de fluxo		Período de		estática	
t	pvf	t		At	Pv«	¿t	p
Ch2)	C psi g2&gt;	CbJ CpsigD			C psi gj	ChD	Cpsig3
0. 000	86.0	0.122	306. 3	0.005	687. 8	0. 209	818, 1
0. 003	106. 3	0.132	318. 4	0.011	712. 4	0. 315	832. 4
0.011	123. 4	0. 149	337.8	0.022	734. 9	0. 418	841.6
0, 023	149. 0	0. 166	356. 2	0.024	738. 2	0.500	847. 0
0. 024	153. 4	0. 177	367. 7	0. 026	741.2	0.662	854. 9
0.023	137. 7	0. 187	377. 7	0.030	746. 4	0. 800	839. 7
0.028	161.9	0. 198	388. 5	0. 034	750. 9	0. 938	863. 4
0. 034	173. 8	0. 209	398. 8	0. 037	754. 1	1.325	870. 2
0. 037	179. 5	0. 222	410. 7	0. 041	757. 9	1.400	871.2
0. 041	186. 9	0. 235	422. 1	0. 045	761.3	1.486	872. 1
0. 045	194. 2	0. 250	434. 7	0. 053	767, 3	1.520	872.5
0. 053	208. 0	0. 264	446. 1	0. 060	771.9	1.666	873. 9
0. 030	219. 6	0.279	457. 8	0.067	775.9	1.750	874.6
0. 037	230. 7	0.295	469. 8	0.075	780.2	1.870	875. 5
0. 075	242. 9	0. 382	527. 2	0. 084	784. 4	1.950	876.1
0. 084	256. 0	0. 400	537. 8	0.095	788.9	2, 098	877. 1
0.094	270. 1	0. 460	569. 7	0.106	793. 0	2.140	877. 3
0.1 oa	286. 1	0. 500	588. 9	0. 119	797. 3	2. 189	877. 6
Tabela 7.1 - Dados simulados de DST com baixa produtividade
A Figura 7.1 apresenta a comparação das press3es no poço obtidas por estes dois métodos.
Fig, 7.1 - Pressões por inversão numérica x por dif, finita
Usando apenas os dados gerados por diferenças finitas, vamos aplicar o método de otimização por diferenças finitas da apêndice I„ para determinar a permeabilidade CkD, o efeito de película ÍS) e a pressão estética Cp^.
Os critérios usados para os valores iniciais dos parâmetros são os mesmos do item 6.1.
Será feita inicialmente uma regressão apenas nos dados do fluxo até a convergência e depois no período de fluxo e estética em conjunto até a otimização final.
A Figura 7. S mostra os valores das razESes entre os valores calculados e os valores reais, usados para gerar os dados de k, S e pi para as diversas iterações, sendo as 19 iteraçSes iniciais no período de fluxo e as restantes no DST
completo Cfluxo e estática}.
1.8
Q.8 L---~í---------------------------J-------i-
0	10	20	30
N. de Iterações
Figura 7, 2
Otimízacao para o fluxo e fluxo +estático
À Figura 7.3 mostra as cur vas de pressdes obtidas na primeira iteração no DST completo, na otimização finai e a curva gerada para aplicação do método. Nota-se que quando iniciou-se o processo de otimização no DST completo os valores dos parâmetros já estavam praticamente iguais aos valores finais, mas a função objetivo ainda diminuiu.
Fig. 7.3 - Otímizacao para fiuxo e estatica por dif. finita
Para a oti mi zação 1 ni ci ai que é apenas no f 1 uxo os valores iniciais ainda são distantes dos valores finais como mostra a Figura 7. ¿1.
A Figura 7. E3 resume este comportamento da função obJeti vo. El a mostr a a con ver gência r ápi da dos par âmetros durante o fluxo nas 19 iteraçdes iniciais e lenta a para o DST completo. Há também um aumento da função objetivo no início da otimização em todo DST que é devido ao maior número de pontos analisados.
Em termos de valores absolutos a permeabilidade, skin e pressão estática têm valores iniciais 1,11 darcy, -1, e 60.8 atm ; atingem 1.378 darcy, -8.005, com pi= 60.8 C fixcD no fluxo e convergem para seus valores exatos no DST completo.
Fig/7, 4- Otimização na fiuxa por dif. finitas
8E+004
f
■^68+004
S
o
o
&gt;
4E&gt;004
ío
o
o ¡O íjr'
¿ 2E+004
-¡60
*
OE+QQC^
* Fiuxa
o Huxo e estático l
i
f
i
i.
i
!
40
d2°
1G	20
Numero de iterocoes
301
Fíe, 7.5 — Funçàc osjstíva nas etooas dü athTrjzacóc
7„ 2. Otimização por diferenças finitas em dados reais
O método de otimização baseado na inversão numérica das expressdes obtidas em Laplacs não funcionou em poças de baixa produti vidade devido à 1 imitação no algoritmo que faz a inversão numérica das respectivas equaçSes. Para que o algoritmo de Steh/est seja confiável a função deve ser monotânica, e sem descontinuidade brusca nas derivadas.
O algorítmo de oti mi zação que calcula a pressão e gradientes através de diferenças finitas em poços de baixa produtividade forneceu valores exatos e convergiu rapidamente na sua aplicação para dados simulados.
Para a aplicação em dados reais é necessário que se faça um escalonamento dos parâmetros a determinar, colocando-os na mesma ordem de grandeza, para que na convergência todos eles tenham a mesma quantidade de número significativos.
A Figura 7.6 seu uso no DST do poço 7-Cp-760-Se.
cb
vi Cu
O ü-o Cl
0 c
o ÍO
w Kl
800 ----!---!----T~--f--------!---1----r---r
	. 0 » 9	8 , B 9 ’ • * 			 *	’		
600		&lt;í9	
400		/ í	Legenda í * Dados lidos	—■
200	* ♦	, . ;	o’otimizacao finai - *	o	+ resíduos T + *	-
0	* * s « 9 » * + * 1	5 t &gt; “ 9 » í		 1 1!1!.	1	t 1	-
9001----1-----1----1-----1----i----1----1----í_____í____
CW	2.0	4.0	6.0	8.0	10.0
Tempo acumuíado de teste (h)
Flg. 7.6 - Otimizacao por dif. finitas para 7—Cp—760—Se
O resultado da otimização não é bom. O algoritmo não converge e os resíduos são altos. Tudo isto devido aos valores de pressdes finais da estática que são diferentes dos valores calculados por diferenças finitas, o que causa um deslocamento de toda a curva do DST na tentativa da minímização dos quadrados mínimos.
O gráfico de Corrêa na Figura 7.7 mostra o comportamento
anómalo existente no período de estocagem.
çn
CJ.
O O O
CL
0 c
o
CO cn
0?
u.
Cl
800		~i	j	j	1	r	1 i	i 	r		
		• * O g _		
600		” * 		-	: j B»	%	
			•». •• % • % a â V \	
400			0O 0	-
		Legenda	*	
		* Dados lidos	o	
		o otimização final	• X	
200		4- resíduos	0 o	-
				
0				-
			t * + *	
-20ft		i .	. i . . ..	&gt;	¡	t	1	1	í	I	
	2	0.4	0.6	0.8 1.0	1.
tp / (tp + dt)
Fíg. 7.7 — Grafico cartesiano da otímíz. do 7—Cp-760-Se
A aplicação de qualquer método de análise para dados
reais é sempre mais complicada» porque existem fenómenos tais
como fricção, inércia. simplificação da equação da
difusividade na linearização Conde se despreza os gradientes
de pr i mei r a or dem) r var i açSSes dos coef i ci entes de est ocagem
no fluxo e estática Cque pelo modelo são constantes}.
A primeira idéia que surge é o uso de pesos diferenciados para os pontos, de tal modo se que force o ajuste sempre nos
é onde se tem mai or
confiança no modelo
matemático e nos
dados medi dos.
Estes pesos sSo fatores
introduzidos nos
cálculos dos residuos ou
a
onde
SSR Cx3
= 5ÍC[P\4“P	.3/ o. 1
L	W t=U WpL	V J
i
par a per i odo de f1uxo
C7.13
C7. 33
o. -t
para a análise em todo o DST C7. 33
Cp 1.	. e p estão definidos no item C4.13.
w t=t	Wpl
Este método também não convergiu e apresenta resultados ruins, embora os pontos finais da estática estejam mais próximos como mostra a Figura 7.8 abaixo.
800
600
o.
8 400
o
tx
O
c:
o 200
o
v
k_
Cl
0
Q	&amp;amp;
° ’ **	_ .» * s s ?
- + &gt; +
Legenda
* Dados üdos
o otimizacao finai + residuos
-20&amp;amp;
J---------1----i----¡----1----t____L.
2.0	4.0	6.0	8.0
Tempo acumulado de teste (h)
10.0
Flg. 7 S “ Otimizacao por dtf. finitas para 7~-Cp~760“Se
0
T
T
T
T
T
T
T
T
1
í
’H'
♦
1
1

1
Se retirar mos os 15 pontos i ni ciai s da estática no computo do resíduo e aplicarmos a método» usando pesos para os pontos, há convergênci a e os resul tados serão real i st as como mostra a Ta bei a 7. 2 e a Figura 7.9 abaixo.
Parâmetro	Valor I ni ci al	Vai or Final
Permeabilidade t md 3	39.90	66. 3
Efeito de Peiicula t 1	”1.	-0.09
Pressão estática íatmJ	43. 11	46.13
Tabela 7. 2 - Interpretação automatizada poço 7-Cp“760-Se» por diferenças finitas para determinar k» S e p..
800
T
T
T
T
T
T
T
T
7
600 -
ÇH 'w
o.
u ’
¿si000
o o o cu
o
400
o o w
M e CL
200 -
Legenda
* Dados lidos
• o otimizacao final + .resíduos
Op-»»
2O£o
+•
r 4* 4- +■ s»
I	1	I_,...,,,1 . L_____í-----Í------L_
2.0	4.0	6.0	8.0
Tempo acumulado de teste (h)
Ju
10.0

»
. •

4

f
Fig. 7.9 — Otimizacao por dif. finitas para 7—Cp—760—Se
Estes valores ainda podem ser melhorados se retirarmos os 34 pontos Iniciais da estática como fizemos na análise por inversSo numérica da transformada de Laplaae para este poço.
A Figura 7.10 mostra o ajuste obtido.
800
T
T
T
T
&gt; a
600
J 5 ! » •	*	‘
g&gt;
£X
O U' o
Q.
O a
400 H
o 'O
tfí
&lt;n
4)
c CL
200
“2Ofto
Hg. /J0
A Tabela
Legenda
* Dados lidos c otimização final 4- resíduos
i L.
Tempo acumulado Otimização por dif.
7. 3 apresenta um
interpretação pelo dois métodos.
_i_____1-	....1..
5.0	8.0
de teste (h) finitas para 7—Cp~760~Se
quadr o compar atívo da
10.0
0

» »
v

a
4 *
♦
+
f- *
1
1
Parâmetro	Inversão numé- rica CSíeh./esU	Diferenças finitas com po= pfi
Permeabilidade í md 1	90. 00	66.17
Efeito de Película C 1	1.19	0. 03
Pressão estática Eatm]	46. 09	46.10
Tabela 7. 3 - Interpretação automatizada poço 7-Cp~7©0~Se.
7.8.1.	Outro exemplo estudado por diferença finita
Aplicou-se o método no poço 7-Fu-8r2-Al.
As Figuras 7.11 e 7.18 mostram o resultado com todos os pontos do DST e sem os 11 pontos i ni ci ai s de pressSo vs tempo respectivamente.
1800
1600
* • •
uoo
£1200
gJOOO
o” a
o
c
O o w
(0
V £
500 -
600
400 -
200 -
'*'200q
Legende
Dados Üdos otimização finai resíduos
..*»&lt;«*-* t t	.
----1------í-------1------i______I___
4	8	12
lampo acumulado de teste (h)
16
F1g&gt; 7*11 - Otimízacao por dif, finitas paro 7—Fu—22—AJ
1800
1600 -
'í............1—
&amp;lt;• ♦ *
400 -
cr* £1200 -
T
° W00h o cu
o c
o IO
ff» ffl
Q.
soo -
600
400 -
200 -
Legenda «.Dados lidas o otimiza pão final + residuos
0 -

f

*
o
T
T

0 -
”2OOo
~~4	' É	12
Tempo cçumulodo de teste (h)
16
Frg, 7J 2 - Otimização por dif. finitas para 7~Fu—2.2—Al
A Tabela 7.4 abaixa apresenta a resultado comparativo dos
métodos:
Parâmetros	Valores finais calculados pelos métodos			
	Manual gráfi ca		Automatizada por dif. fin.	
	Corrêa	Worner	todas pontos	-li pantos*
k E mdl	8. 0	11.3	3. 7	7. 3
£ [ 1	~0. 5	“2.0	“2.7	“2. 6
p. £ atml	117. 3	116. 8	120.2	118.1
* retirando os 11 pontos iniciais da estática.
Tabela 7.4 - Resultados dos métodos gráficos e de otimização por diferenças finitas no DST do poço 7-Fu~22-Al.
7.2.2. Discussão do método
Podemos afirmar que o melhor resultado é o que apresenta menores resíduos principalmente para os pontos finais da estática.
Os exemplos analisados tinham poucos pontos lidos no
incluído no programa.
Para os poços de média e alta produtividade os métodos de diferenças finitas e o método de inversão numérica apresentam resultados bem próximos, embora esta comparação seja difícil porque a pressão de fluxo inicial, que é importante no estudo do DST, é calculada pelo método de inversão numérica e é um valor fixo fornecido pelo método das diferenças finitas.
A Tabela 7.3 abaixo mostra as resultados das duas análises para o poço A Cdo SPE 1ÊJ8OED que vinha sendo estudado.
Parâmetro	Inversão numé- rica CSteh/est.)	Diferenças finitas com po= pfi
Permeabilidade £ md ]	1130.00	1145.00
Efeito de Película £ 1	-1.31	- 1.74
Pressão estática tatml	eo. 78	©1.45
Pressão fluxo in. £atml	0. 13	9. ©9
Tabela 7.5	- Resultados da interpretação automatizada por
diferenças finitas e por inversão numérica no poço A.
A Figura 7. 13 mostra o ajuste final por diferenças finitas*
Fíg. 7,13 — Ctimizaçõo por dif. finita no poço A
83
8.0. CONCLUSÕES E RECOMENDAÇÕES
A interpretação automatizada para poços não surgentes é mai s um método de anál i se de teste , que somente deve ser aceito após verificação da qualidade do ajuste, análise estatística e principaimente com informações de outras fontes como testemunhos, perfis e geologia.
Estudou-se aqui a apli cação do método de análise para o caso do reservatório homogéneo, infinito e com fluxo radial para o poço. Este modelo parece ser válido para a maioria dos testes, mas não para todos.
Como nem todos os parâmetros podem ser calculados pelo algori tmo de regressão, porque alguns deies podem ter correlação entre si e outros podem ter pouco efeito na resposta de pressão, os primeiros estudos foram para deter mi nar quals par âmetr os podem ser deter mi nados com unicidade e precisão.
A premissa básica para a análise de ajuste automatizado é que o modelo matemático escolhido descreva o comportamento do poço/reser vatór i o. Se isto não ocor r er o pr ocesso de regressão por quadrados mínimos simplesmente forçará um ajuste que melhor explique os dados de campo. Também é importante a estimativa inicial dos parâmetros a serem calculados, e principal mente a qualidade dos dados do teste.
8.1	- Conclusões
1.	- O método de análise automatizado para poços não surgentes, num ciclo completo de fluxo e estática, permite a deter mi nação dos 4. par âmetr os gover nantes do teste que são: permeabilidade Ck2&gt;, efeito de película ÍS, pressão estática do reservatório CpiD e pressão de fluxo inicial Cpol.
8.- A inclusão nesta análise das equações com alternati vas de determi nação do skin positi vo ou negati vo tornou a interpretação mais abrangente &amp;amp; realista.
3.- À análise simultânea do fluxo e da estática constitue um avanço em termos de técnicas de análise automatizada de teste. As informaçdes adicionais do período de estática permitiram a determinação de maior quantidade de parâmetros e maior confiabilidade na interpretação.
A. - O uso de pesos diferenciados para cada ponto de pressão vs tempo do fluxo e estática força o ajuste da curva CmatchJ nos trechos mais conf iÃveis do teste. Estes trechos são aqueles com maior densidade de mediçSes e com pressão de fluxo mais próxima da capacidade ideal do registrador.
3.- Embora este método de análise não exija o cálculo das vazdes de teste, é i mpresci ndi vel a determi nação correta da densi dade médi a do f1 ui do produzi do para uma análi se realista, devido sua influencia no cálculo do coeficiente de estocagem do fluxo.
ô.- A sensibilidade dos parâmetros calculados com relação ao coeficiente de estocagem da estática CC 3 é muito baixa, e portanto o seu cálculo Cque depende do volume de estocagem do teste e da compressibilidade do fluído! não precisa ser rigoroso.
7.	- A análise automatizada apenas no período de fluxo do DST Cou slug testJ permite a determinação de 3 parâmetros que podem ser: k, S e po ou k, S e pi. No caso de k , S e pi é necessário que haja uma tendencia de estabilização de pressão Camortecimento!.
8.	- À versão usada do algoritmo de regressão de quadrados mínimos não lineares de ¿evember#~?tarquardt com cálculo dos gradientes de pressão pela expressão analítica obtida no espaço de Loploce é mais rápida que a versão que calcula estes gradientes através de diferenças finitas.
9.	-0 método foi usado para análise de testes em poços não surgentes de alta, média e baixa produtividade e mostrou-se mai s reali sta para análi se em teste de alta e média produtividade.
&amp;amp;7
8.2	- RecomendacSes
l.~ Investigar a possibilidade de uso dos algoritmos de regressão não linear com cálculo das derivadas de segunda ordem Cpor exemplo o algoritmo de Newton-GreenstacD, com o objetivo de determinação de fô parâmetros do DST que são: k, S, p ► p . C e C .
S.	- Implementar algoritmos que calculem a função de Besseí modificada de segunda espécie e ordem zero e um para argumentos complexos. Eles serão usados em conjunto com o algoritmo de Crwnp para inversão numérica da transformada de La.pt ac e para resolver a integral do DST conforme método apresentado no apêndice E. 6.
3.	- Implementar este algoritmo apresentado para problemas de DST com vários ciclos, e também para outros tipos de modelo de fluxo e reservatórios* tais como:
±3 Fluxo linear, esférico e elíptico
íiJ Sistema heterogéneos:	dupla porosidade, dupla
permeabilidade e reservatório composto.
iiiD Reservatórios limitados com pressão constante nos limites ou com falha plana selante.
4.	~ Incluir neste estudo os efeitos inerciais e de turbulência existentes em poços não surgentes de altíssima pr oduti vi dade.
—■ T 1 r	dai f fiC* tdô 'í fidf&amp;amp;r*/'5' í Çiç HtfC*
*	A 4 4^w *A «, *	W lnlAiiif	W 4 W	1—*. 4 * U, *A
atrito, gradientes de pressão de primeira ordem em relação ao espaço e variaçóes do coeficiente de estocagem do fluxo CCp existentes em poços não surgentes de baixa produtividade.
9.	MONENCLÁTURA
SÍMBOLOS ROMANOS: s
A	= área da seção transversal da -tubo £cml
~3
C	= constante de estocagem, [ atmH cml
—1
c	= compressibilidade total, latml
1	—i
c	= compressibilidade do fluido do poço» £atml
w
d	~ operador diferencial
Ô	-	vetor solução do sistema de equações lineares
DSCxD -	Derivações de segunda ordem da função objetivo
tE	-	matriz	dos coeficientes do sistema	normal
E	-	matriz	inversa dos coeficientes	do	sistema	normal
F	*	função	resíduo C- diferença	entre os	valores
computados e medidos em cada iteração da regressão) h	»	espessura da formação,ícml
”2
q	= constante de aceleração da gravidade CcmlCs]
0	-	matriz identidade
JJ	-	Jacobiano
3
k	«	permeabilidade da	formação.£ cm]
Ko	«	função Bessei modificada de 2a.	espécie ordem	O.
Ki	-	função fesseí modificada de 2o..	espécie ordem	1.
EL	-	operador de letpíace
1	-	altura de fluído no tubo £cml
m	»	número de parâmetros a serem determinados
ms	=	massa específica	do fluído
n	=	número de pontos	de tempo	vs. pressão do teste
ndf	-	número de pontos	lidos no	período	de fluxo
nde	=	número de pontos	lidos no	período	de estática
p	=	pressão,£atml
p^	■-	solução do fluxo	para S.C	e vazão	constantes
p.	=	pressão inicial do reservatório, £ atml
p	=	pressão de fluxo inicial»E atm]
O
p	-	pressão	de fluxo final.Catm]
p	~	pressão	estatica final.Eatml
VO
p	-	pressão	no poço.Eatm]
p	=
ws
q CO «
q CO =
pressão fluxo no poço Cespaço Lcpíctce^ , í atml
pressão lida no teste, Eatml
pressão estática no poço Cespaço Lap Latee’} , íatml 3	-1
vazão instantánea da formação,Ecml Es]
3	—1
vazão específica, EcmJ Es]
distância radial do poço.Ecm]
r	=	raio externo do reservatório,Ecm]
r	=	raio interno da tubulação de produção* £ cm3
P
r	= raio do poço.Ecm]
w
r	= raio efetivo do poço Crwa «= rw. DexpC-S3J Ecm]
w&lt;x
s	- variável ou argumento no espaço de Laptcce
SSR = função objetivo ou soma dos quadrados dos resíduos
em cada passo&amp;lt;£atm]&gt;
S	= fator de película ou fator skin ou skin
S&amp;amp; ~ função degrau unitário
t
T
tempo, £ s ] transposto
t
P
t
Otj, n-m
2
V
w
X
*
X
tempo de produção ou de fluxo. Es]
distribuição de student com nível de risco oi e n-m graus de liberdade
3
volume da camera de estocagem do fundo,£cm]
vetor composto dos parâmetros da formação/reservatório.
vetor solução da minimizaçãd da função objetivo
SÍMBOLOS GREGOS:
cx	- ni vel de r i sco para o i nter vai o de conf i ança com
probabilidade Cl-oô
Qr	~	desvio padrão médio da regressão
AP	-	transformada de laplace de ApCr,tZ&gt;
d	=	operador diferencial parcial
$	-	porosidade, fração do volume total
yw ~	específico do fluido do poço, í gf ] Ecm]
a —1
X)	~	constante de difusividade,EcmJ Csl
X.	=	parâmetro do método de Gauss-Mar-quarrit
p	= viscosidade do fluido do reservatório,CcpJ
p	~	densidade do fluído produzido no teste, ígHcml
a.	=	fator do péso para cálculo do resíduo 1-1.........n
Ô ~ fator de relaxação usado por Gauss-rfaríjucu^t
subscritor
»	-	admens ionai
d	=	admens i onal
a	=	estática
f	=	fluxo
i	=	número do ponto
J	=	número do parâmetro
k	=	número da iteração
o		i nici al
w		poço
wf	-	fluxo no poço
we		estática final no pi
Superescrito:		
» ♦ S*	22 t Unidades		derivada primeira derivada segunda transpôsto físicas:
ELJ		comprimento
CM3	SS	massa
CT1	-	tempo
Sistema		DARGY de unidade
CL]		centí metro
CM]	-	grama
tf]	-	segundos
Quantidade	Uni dade íkxrcy	Mui ti pl i car por	Uni dade SI
	2	1	017-/1	2
			
Comprimento	cm	1.OE-2	m
Compressi bi1 idade	atm 1	9.867E-6	Pa
Massa específica	3 gZcm	1.OE+3	kg/m3
Per meabi1i dade	Darcy	9.869E-7	a m
Pressão	atm	1.OI32E-1	Mpa
Vi scüsidade	cp	1.OE-3	PaZs
~ Constantes de transformação de unidades
Tabel a 9.2
10.	REFERÊNCIA BIBLIOGRAFICA
1.	Âbramovitz, M. and Stegun, I. A. editores : Handbook of Mathematical fuñetinos, Dover Publications Inc., New York C19703.
2.	Barua, J. and Horne, R. N. : Improved Estimation Algorithm for Automated Type Curve Analysis of Well Test Data - SPE 14265C 1985.3.
3.	Barua, J. and Horne, R. N. : Computerized Analysis for ThermalRecovery Well Test Data ~ SPE 12745 Cl9843.
4.	Barua, J. and Horne, R. N. : Using Simultaneous Downhole FlowRate and Pressure Measurement to Improve Analysis of WellTest Data - SPE 12985 Cl 9843.
5.	Chang, J. and Ershaghi, I. : An Improved Microcomputer Approachto Well Test Interpretation ~ SPE 15928 Cl 9863.
6.	Corrêa,A. C.: Análise de Teste de Pressão em Poços Produzidos com Pressão Constante - Trabalho Apresentado no Segundo Congresso Brasileiro de Petróleo, Rio De JaneiroCRJD Brasil , Outubro 3-7, 1982.
7.	Corrêa, A. C. and Ramey, H. J. Jr. : Combined Effects of Shut-In and Production : Solution with a New Inner Boundary Condition- SPE 15579 Cl9863.
8.	Corrêa, A. C. : Application fo the Unit Step Function to Transient Flow Problems with Time-Dependent Boundary Conditions, Dissertação de Ph. D. , Stanford University, Stanford, CA, Março, 1988.
9.	Corrêa. A. C. and Ramey, H, J. Jr. : A Method forPressure Buildup Analysis of Drill Stem Test - SPE 16803 Cl 9875.
10.	Dennis , J. E. Jr. and Schnabel1. R.B.: Numeri cal Methods for unconstrained Optimization and Nonlinear Equations - Ed. Academic Press, London - Chapter 10 Cl9855.
11.	Earlougher„ Robert C.Jr.: Advances in Well Test Analysis, Monograph Series, Society of Petroleum Engineers of Ai me, Dal1 as Chapter 8 C19775.
18. Hanson, J. M. : Nonlinear Inversion of Pressure Transient Data- SPE 18848 C19845.
13.	Hefeman, P. S. and Abbaszadh,M. : A Simulator for Drillstem Test Interpretation - SPE 16380 Cl9875.
14.	Marquardt, D. W. :	An Algorithm for Least Squares
Estimation of Nonlinear Parameter - J.Soc. Ind. Appl. Math, vol. 11, No. a, Vol.il, No. a, 431-41 CJune 19635.
15.	Press, W. H. , Fannery, B. P. , Teukolsky S. A. and Vetterling W. T. : Numerical Recipes - Cambridge University Press, 1986.
IS. Ramey, Henry J. , Jr. and Agarwal, R. : Annulus Unloading Rates as influenced by Wellbore Storage and Skin Effects -Soc. Pet. Eng. J. 463-468; Trans. , Aime, 253 CJuly-Sept. 19755.
17. Ramey, Henry J.
Jr. ,
and Agarwal, R. and Martin, I.:
Analysis
of ’ SIug
Test *
or Dst Fl ow
Period Data , J.
Cdn.
Pet. Tech.
C July
Sept.
19855 37 -42.
18. Rosa,
A.
J.
and Horne, R. N. :
Automated Type
Curve
Matching
in
Wei 1	Test	Anal ysi s
Usi ng Laplace
Space
Determination of parameter Gradients , paper SPE 12131 presented at the 1983 SPE Annual techni cal Conference and Exhibit!on, San Francisco, Oct. 3~8.
Water Resources
20. Santos, S. A.
Algoritmo
Tabelada Segundo
para aproximação de Função
Mlni mos Usando B-Spli nes,
CDez-19875.
21.
Scales, L.E. : Introduction
Ed.
Spr i nger - Ver 1 ag
t o Non -Li near Opt i mi zat i on
New York Inc. Chapter 4 - Cl9835.
22.
Silva, M.L. F.
Geometrias Di versas
SoluçSes para Testes de Formação com
", Dissertação de Mestrado, Universidade
CMarço, 19895
23.	Stehfest, H. :	Numerical Inversion of Laplace
Transform - commucications to the ACM, Volume 13, N. 1, Algorithm 36SCJan. 19705.
24.	Wylie,C. R. : Advanced Engineering Mathematics» Ed. Macgraw Hill Book Company, New York Cl9755.
25.	Van Everdingen, A. F. and Hurst, W. : The Application of Laplace Transformation to Flow Problems in Reservoirs, Trans. Aime Vol. 186, 303-324, Cl9495.
ÂPENDICE a - SOLUÇÃO DA EQUAÇÃO DO SLUG TEST EM FORMA
DIMENSIONAL C Sistema Internacional3
Considerando o fluxo radial de um fluido com viscosidade pequena e com baixa compressibilidade escoando num meio poroso homogéneo isotrópico de espessura constante teremos as seguintes equações diferencial* inicial e de contorno:
+ 1	d p	â p "o	o
	
dr	r	d r	d t
d	n	D	D
p C r , 0 D	U	3=0
lim p C r	ft 3 « 0 'x	rs
CA. 13
CA. 23
CA. 23
CA. 43
CA. 53
C
D
&lt;?P WD
dt
CA. S3
Usando os grupos dimensionais da tabela 1 e os conceitos de:
queda de pressão no reservatório: ApCr,t3 = p. - pCr,t3
queda de pressão no poço: Ap^Ct3 = pi - p^Ct3
o problema se torna então:
d2Ap 1 3 Ap 1 dAp
CA. 73

e r
r â r
â t
Ap C r , 05 -O
CA. 85
11m Ap Cr,t5 = 0 r-+&lt;®
Ap C 0+5 - 1
CA. 95
CA. 105
Ap C t 5
V
õAp
ApC r ,t5 ~ Sr -----------
v	t?r r-r
CA. 115
&lt;?Ap
&lt;?r..
- cf p
CA. 125
r=r
w
8 n k h â t
r w
CA. 145 A transformada	de	tapíoce	da	eondiçSo de contorno
interna, equação CA. 125, é:
C	p	_
=	------—_ C s p ~ p 5	CA. 155
2	n	k h	vt
r=r
w
Substituindo CA.155 na equação CA.145 e resolvendo para p teremos:
wf
o

....*	J ..%
S/77 K C r v SZy) 3
V	1 w
cf p s

J*
s
1
t,
S + -7=^
r /%
v
K Cr •/SZp 3 O v
K C
i
r VSZi) 3 w

►

2 n k h
’+■
Cf p
CA. 163
APENDICE B
- DERIVAÇÃO
REI.AÇÃO AOS PARÂMETROS DO
DAS
EQUAÇÕES
DO "SLUG TEST" COM
RESERVATÓRIO
B. 1
Caso
do
Poço
com efeitcr de película positivo CSkin &gt; 03
A equação
para
p Cx&gt;s3 foi deduzida wf
no apêndice A.
Definindo
C
i
v $ u e r z t V
¡5 n h
e

¡u
Então a equação CA. 163 se torna :
/*•
po&amp;lt;
c
2
k

+■•
Cf s
Pí
p , wf
CB. 1.13

s

s

K CC -/Szk 3
o i_________. .
C /SZk K C C -/SZk 3
1	* i	J
C k
2
1
Cf
definindo as
segui ntes
funções auxiliares, teremos:
K CC -/^ZY. 3
Auxl
S +
CB. 1.23
Aux2
Aux3
C k p.
2	l.
C B.1.33
'“‘f
s
po Auxl + Aux2
r
“2
Aux8 = s Auxl + Àux4
A expressão da pressão no poço se torna Aux3
CB. 1.43
CB. 1.53
CB. 1 . S3
CB. 1.73
Aux8
A derivada da pressão com relação à permeabilidade será;
&lt;3 Pvf
d k
CC ZC,3Cp.-p 3-ÍAuxl/k- Aux7
2 f „ L O 1_______________ »
CAux83^
CB. 1.83
Aux5 =
ccp^/k'
1.
3
1
• *
CB. 1.93
3
2
AuxS =	1 - Aux5
CB. 1.103
Auxõ
Aux7 - -----
2 k
As outras derivadas são: .
13 Em relação ao "skin":
â p .	Aux4 Cp - p 3
'-ft „	________o_____v
° S	C AuxSlf
113 Em relação a p : o
â p,	Auxl
¿? po	AuxS
CB. 1. 113
CB. 1.123
CB. 1.133
Q9
iW Em relação a Cf
•' p.„(	C AuxlZC 5 C p Aux4 - s Aux25 f	o
â CL f	C Aux85~'
CB. 1. 145
Ív5 Em relação a pressSo do reservatório p. :
rs	AtT-vzt
w £-/	&lt;r*4 U* ww
---w£ -		 c B. 1,155 â p;	s Aux8
Foram usadas as seguintes reiaçdes para a derivação da funçào de Bessei modificadas :
o5		&lt;* xp K Ca x 5 dx 1	p	= -	■ a xp K C a x 5 (p-ií			CB.1.165
&amp;amp;5	a	” SC Ca x 5 = dx p	“ &amp;lt;K„t	a 5 + K C P	a x		CB. 1.155
		lembrando que	K Ca x ~p	5 = K Ca p	x 5		
	regra da cadeia						
	a	K C C /s/k 3 V ’	O	£	&lt;	d ■&lt;	’ K Ca x5 1 o	} *	X	CB. 1.165
			&amp;amp; X			dk	
B. 2 ~ Casa do Paço com efeito de película negativo CSkin &amp;lt;0)
A equaçSo para PufCx,si foi deduzida no apêndice A.
Neste caso usa-se o conceito de raio efetivo do poço Cr 5
wo. r - r expC ~£5
wa w
Definindo C
■t
- V u c r 2 t wa
e
ent^o a equação CA.165 se torna :
	"■	J		1	*1 K CC /SZk 3 O	1	C	k p.
o	C ^Zk K C C -ZSZk3 1 11 K	J	» + Cf s
wf	K CC /BZk 3 O	1
s&amp;lt;	C T^Zk ¡C C C ZSZk 3 1 11
sendo:
Auxl =
K CC /SZk 5
o i_________
C /Szk K c C -/SZk 3 ±	ti
C k p.
Auxa =	-----v
C, s f
Aux3 = p Auxl + Àux2
o
k
Aux4 — C ---
h
Aux8 = s Auxl + Aux4
CB. a. 13
CB.a. S3
CB. a. 33
CB. a. 43
CB. a. S3
CB. a. S3
A expressão da pressão no poço se torna :
__	Aux3
PvfC*’s5 =	-----
AuxB
CB. a. 73
A derivada da pressão com relação a permeabilidade é:
â p	CC ZC 3 Cp. - p 34 Auxl - k Aux7 $■
wt_______Z f	o }
d k	CAux83z
CB. a. S3
ÀuxÔ
AuxZ = -----
a k
CB. a. 93
AuxB =	1 - AuxS2
CB. 2.102
Aux5
CC / /k 2
í	..
CC^y S/k 2
.2
CB. 2. 112
As outras derivadas sâo:
13	Em relação ao "skin”:
Ê a expressSo mais complicada, pois a função de Bessel depende também deste parâmetro; que pode ser explicitado
1 ogo,
3 p-.-r
CAuxl/C,3Cp Aux4 - s Aux23
 f o.............
CB. 2.123
CAux832
d £
a
ii3 Em relaçSo
p=

Auxl
CB. 2.113
dp
O
AuxB
1113
Em relação
a a,
t
d p .
*vf
dCf
C Auxl/G, 3 C p Àux4 - s Aux23 ______ f____o________
CAux83S
CB. 2. 123
pressão do
reservatório p^
a
At !v^
CB. 2. 133
à p.
Usou-se a
s ÀuxS
relação para
a derivação da função
de Bessel:
d
o3	—— -í K C òt x 3 1
dx 1 i	f
Ca x 3
1
--- K Co x3
i
x
CB. 2.143
a K
o
APÉNDICE C
SOLUÇÃO DO DST EN FORMA DIMENSIONAL
CSistema Internacional^
Usando as mesmas hipóteses estabeleci das no Apéndi ce A
para a solução do	"si ug	test” o problema	do DST será dado por.-
i 2p 	d P D		CC. 13
&amp;amp; r	r	d r	â t	
D	Ü	o	d	
p Cr , 03 D	D	= 0		CC. 33
= O
lim p C 'n
r -&gt;c»
D
r t 3 D, D
CC. 33
P ‘wD	C0+3	= 1	r	i	
p	C t 3	= p C r » t 3 ~S	u r —	
‘wi&gt;		D	O	D	D	J L	n J	r =1 »
CC. 43
CC. 52?
CC. 02?
Usando os grupos adimensionais da tabela 1 e os conceitos:
¿3 queda de pressSo no reservatório ApCr.t) = p^ ~ pCr,t3 ¿i? queda de pressão no poço : Ap^Ct3 = p - p^QCt3
o problema se torna ent&amp;amp;o:
dz&amp;amp;p	1	â	Ap	1	dAp	
	 + .				 —	—		CC. 73
a rZ	r	a	r	T?	d t	
Ap C r »	0	3	= 0			CC. 83
CC. 93
lim Api r, t 2? = O r-Kü
Ap C0+3 = 1
Ap„ Ct3 = ApCFtr,t3 “S
- áp
i----
dr r-r u	w
CC. 103
CC. 113
(C1	~ s 3C 4- se &gt;		‘^Ap ~		&lt;?Ap		CC. 123
1	k	o.	fc b j		d r	r -r w	- dr 3	r=r V	
Onde	s	p					CC. 133
	2 n	h	k				
	C	V					CC.143
	“b ~ a n	h	k				
Aplicando-se a transformada de ¿aplace As equaçSes CC. 73 a CC. 113» e resolvendo-se a equaçAo ordinária resultante»
CC. 163
A transformada interna, eq, CC. 123 »	de ¿cxpiace é:	da condição de	contorno
T &amp;amp; CApll	t		
r 	 - L â r	-»	a r-r	t o	p Ct3 dt + p._ e S	*•}•
w			
4- C a	p - S C. p o	o	va		CC. 173
Substituindo a equação CC. 173 em CC.16D e resolvendo-se
para p CsJ, resulta:
ws
p
w
r
p. -t.
—
s
£+■
s
1 1
K Cr -/*Sri &gt;
________O y_______'______
r t/SZy? K Cr sZrç 3&gt;
V	1 V
- +■
/ t
P	-v
e~stp	Ct3dt+C l + C
vf	d[	4&gt;
ro	J
V
k.
K Cr -/~^'r¡ 3
O v	’
'•'"S.•"*
ZT) 3
r /sZt?’ K Cr
V	1 V
C 2nhZp3 k
CC. 183
onde
CC. 193
C SrrhZjuT k	C 2nhzp3 k
C
CC. 803
c - [
c J


r-
4*
C
s
C
f
c
s
C = a
f
C2nhz^3k
APÊNDICE D
DERIVAÇÃO DA EQUAÇÃO DO
DST COM RELAÇÃO AOS
PARÂMETROS DO RESERVATÓRIO EM FORMA DIMENSIONAL
D,1 - Caso do poço com efeito de película positivo CSkin &gt; 03
A equação geral do DST para o caso de um
ciclo foi
deduzida no apéndice C.
Definindo-se C
i
r
2 n h

então a equação CC.183 se torna :
s

sendo
&lt;
S^J
K CC /Szk3 ________o i	 C y^Zk K CC “/szk3&gt;' 1_______4	1
c 4 c
le Stp COdt +Cl + C J	wf	d	&lt;
0	J
v
ô
a
c
1
K CC 7®Zk 3
o l
C /^Zk K CC -/Szk 1
1 1
1


c ..te.
C 2nhZp3 k
C D. X . 13
cf
c
s
CD. 1.23
C EtnhZp3 k
C 2nhZp3 k
C2nh/p3k
definindo-se:
K CC /Bzk 3
AuxlO = -----------...S....'...'.;.,  - . _ ■  ,	,
CC / zk3K C C / zk 3
i	li
CD. 1.33
CD. 1.43
CD. 1.33
Auxl1 =	1
	K S	o c/s u	1
Auxl 2 = C. = b	C &amp;amp; c k
Auxl 3 — C = d	2 c f C k ’ 2
	
CC -/szk 3 1	,	CD. 1.63
Zk K C C /sZk 3 ti	J	CD. 1.73
	C D. 1.83
Auxl4 » C - C
o. b
Auxl 3
Auxl 2,
CD. 1.93
Auxl 5 - p„. e
t
P
►
CD. 1.103
Pi
Auxl 6 =—“ Auxl 1
s
t
AuxlA-jsJ e pvfCC3dl +
Áuxl 51- + p Auxl 3,
*	o
CD. 1.113
Auxl7 = Auxll + s. AuxlS,
CD. 1.123
¿?p
&lt;?k
entSo:	p
ws
Auxl 7 C Auxl 63 *
Auxl 6
Áuxl 7
CD. 1.133
Auxl 6 C Auxl 73 ‘
C Auxl 73 a
»■
CD. 1.143
sendo:
Auxl. 6
CAuxl63 »
3
~p. Auxl 9 Auxll
v
e
O k
s

Áuxl 4
cidkJ
Auxl 5 AuxSO
Auxl 9
AuxSO
CI
s CI AuxSO +
p Auxl 3 o
k
CD. 1.1S3

r r
1
3 1
3
l K C C /S/k 3 j
v i	i
-)■
CD. 1.163
Auxl 8

C D. 1.173
ak
Auxl 4


CD. 1.183
CD. 1.193
CIDK
p p ~st n ~1 í	Cx.sJ 1	,,
I e L	! ■
C D. 1. 203
&lt;?C Auxl 73
CAuxl 73’ = -------
2
-Auxl9 Auxil
s AuxlS
d k
k
C D. 1.21D
Às outras derivadas são:
Ü3 Em relação ao "skin”:
C Auxl 1D SC Auxl 6 ~ p. Auxl7/s3
___ t	____
Auxl 7 Auxl 4
s
CIOS
dS
CAuxl 73 2
CD. 1.223

CIOS
J
0
l
P -st.
q_ :/-TA Cx.s3
( â S
J dt
CD. 1.233
iii? Em relação a
estocagem dimensional
da estática» Cs:
* va
âc
{ cTT }{AUX17 {s CI *
CAuxl 73 2
Auxl 5 J - s Auxl 6 J
CD. 1.243
iv3 Em relação
crp
yq
a pressão estática* p^:
^AuxllZs - s Auxl 4 Cl PI J
CD. 1.253
¿?p.
sendo
Auxl 7
t
A...
Cl PI
J
o
wf Cx,s3
}dt .
CD. 1.2S3
¿to
wa
Auxl 3 - s
dpa
de fluxo inicial, p :
o
Auxl 4 CIPO

C D. 1.273
Auxl 7
tos
sendo
riPrt =	p p -st j e o	rt -1 í ^wf Cx, s3 l *po	} dt	CD. 1 . £83
ÍÜ3 Em relação	a estücagem dimensional		do fluxo, C :
dp vs	f 1	~ Auxl5 - s	ClJ - s CICF AuxlA
	k		
		C Auxl 73	CD. i. £93
sendo:			
CICF =	t r p -st J e o	CÍ&gt;s3 ’	} dt"	CD. 1.303
D.i - Casa do poço com efeito de película positivo CSkin &amp;lt;03
equação Qeral do DST para
t r*y 'í H d» rir**»	ip^éT'íH -í r^cíSi	f**4 f	í** í 55"^
^—■—	U	W*-r rA.V^Z-Z »■
Definindo-se C = i/&amp;lt;£ p cr^
i	t va
onde r = r exp C-SO,
va	v
então a equação CC.103 se torna :
! 1 i	K	1	- +
	K CC 7 SZk3 o 1	
	&amp;lt;C /3/k K CC 7 SZk3^ 1	i	1	
P	“ vs&amp;lt;	Z	1	&gt;	
	K CC J*/*. 3 a	1 &gt; C /SZk K CC /SZk 3z 1 1 ±	
onde:
o	caso de	Uffi	ciclo	foi
		2 n	h	
e	S ~ ■	P	»	
c -e	z t p fe stpvfCt3dt		+ c d	+c Q
	0		J	
	c a			»
+ s	C2nhzp3	k	CD.	£.13
c
a

C
si
C 2nhZp5 k
C 2nhZp5 k
CC. a. £3
C,
a
“St Pff e p
&gt;
CD. 2. 35
C
c f
-----------, p ,
C2nhZp5k
CD. 2. 45
def 1 ní ndo-se
Auxl O
K CC -/®zk 5
____o___i___________
C -/ z~k. K c C / ® zk 5
i	ti
CD. 2. 55
r
1
Auxl 1
Auxi a
Auxl 3
Auxl 4
Auxl 5
Auxl 6-
K CC /Szk 5 o i________
C -/^zk K C C -/ Zk 5
i
cb
C
&lt;x
C
a.
Pff
£
CD. 2. 65
1
1
Pí
--- Auxll

Auxl7 =
p Cx,s)
W«t
C s
C k
2
s
C k
2

-K. tp e
Auxl 4
Auxll +
5
Auxl 6
Auxl 7
CD. 2. 75
»
fr
CD. a. 85
Auxl3 - Auxl2&gt;
C D. 2. 83
CD. 2. 105


t
p ¡' o
-st, P
vf
Auxl 2


CL5 dt +
Auxl 5 J *
CD. a. 115
CD. a. 125
CD. 2. 135
A derivada em relaçSo a permeabilidade é :
¿to ws ák
Auxl7.C Auxl631
Auxl 6. CAuxl73
C &amp;amp;WXÍ 73 £
para
C Auxl 63 ’
áCAuxl63 -p. . AuxlS. C Auxll3£
 1. 

k
s
Auxl 5 Aux20 i- - p Auxl 3 &gt;
i	‘o.

e
ii3 Em
I £X W
Auxl 8
Auxl Õ
Aux20
CI
t P
J
a
C Auxl73
1
X»
i
a CC^ S/k 3
C -/ ^/k 3
1
F
[KiC
}‘
»
1
---Auxl 8,
2 k
-Auxl 4
k
~st
e
&gt;
r t 'í
pvf
t P
“St
e
dt,
e1/.
J a k
Cx»s3
}
dt t
às outras
AuxllS Auxl 9
derivadas s2o:
’’skin'*
s
k
relação ao
CAuxll3£AuxlSCAuxl6 -p, Auxl7/s3
J-
CAuxl73£
Auxl 2.
Auxl 7
senda:
&gt; CD, 2. 143 s CI. Aux20 +•
CD. 2. 153
CD. 2. 163
CD. 2. 173
CD. 2. 183
CD. 2.193
CD. 2. 203
CD. 2. 213
Auxl4 s CIOS
»
CD. 2. 223
CIOS =
ftp -stn-V	f *•„, Cx.s5	
J	e	[L &amp;lt;O	l~s	&gt; dt
CD. 2. 233
Auxl 8 -&amp;lt;	r	fK CC y^Zk 3 i O	1	2 .
	X ■“	«	K C C */®Zk 3 k	' &gt; *
CD. 2.243
C :
S
CD. 2. 253
iv3 Em relaçao a pressão estática»
Auxll
s
&lt;?p.
CD. 2. 253
Auxl 7
D. 3 - Comentários adicionais:
Os termos do tipo
273
ÔFCx»t3 -i
-------- _
dx
onde l = 1,2»....»m
x = parâmetros Ck,s,.. ,C)
representam a transformada inversa de ¿.«xplaee da derivação da
pressão do período de f 1uxo» em reiação aos parâmetros a
serem determinados
(3 termo Cl ~ je p^fCt3dt representa a integração sobre
o período de fluxo, para cada argumento de La.pla.c&amp;amp; s do período de estática,
Para a derivação desta integral em relação aos parâmetros foi usada a regra de L&amp;amp;íbrií t-z:
da
$2Ca3
J FCx,a3dx
$iCa3
$zCa3
&lt;?f
----- dx +
J da
&lt;£iCa3
d^i
FC^t.oú----
da
d&lt;£z
FC , «3--------
dot
d
CD, a. 283
Para
no tempo
zero,a qual não é
de se obter por inversão
numérica
da transformada de
foi
usado o
valor inicial:
lim
s-&gt;cr
(L^fCO fv
lim fCt3 t-&gt;o
CD. 2, 293


usando as
equaçâes B.1.8»	B.1.10»	8.1.11»
8.1.12 e 8,1.13 respectivamente:
...__
d k
CD. 2. 303
rítt
(as
CD, 2. 313
í^d&amp;lt;ts3 I ° Po
CD, 2. 323
f
t â Pi
/	Cx,s3
t * S
CD. 2. 333
o.
CD. 2. 343
APENDICE E
MÉTODOS INVESTIGADOS COMO ALTERNATIVAS PARA
SOLUÇÃO DA INTEGRAL DO PROBLEMA DO DST
E. 1	- Integração direta através do uso de expressões para
pwfCtl como por exemplo: pwfCtl w ai/t '+ b t + c
Vantagens:
£5 A integração é rápida.
Desvantagens:
O Perde-se muito tempo na determinação de a,b, &amp;amp; c através de regressão não linear, e muitas vezes obtém-se residuos multo grandes.
¿O A expressão não é genérica, país depende do comportamento das pressões de fluxo.
£ £ ¿3 Este processo não pode' ser api i cado para resolver as demais integrais que dependem da derivação de parámetros no f1uxo.
E. S- Integração através de avaliações do integrando pelos métodos trapezoidais:	Regra de Slmpson, método
de Newton-Cotes, Quanc8 etc.
Estes algoritmos exigem que se forneça a expressão para o cálculo do integrando, no caso através de inversão númerica da expressão obtida em ¿aplace, em pontos igualmente espaçados.
-Vantagens:
O Facilidade de uso do método
-Desvantagens:
O Exige-se muito tempo para convergir para o valor correto, devido aos fatos:
¿.13 O integrando não é uma função suave,
¿.23 Para se determinar cada valor do integrando tem-se que fazer a inversão numérica da expressão em ¿aplace.
£. 33 Exige-se a estimativa de muitos valores do integrando	para a convergénciaC em torno de 200
estimativas^.
E. 3 - Integração através de método tipo polinómios ortogonais: método de Gauss.
Deve-se fornecer a expressão para cálculo do integrando, através da inversão numérica, em pontos diferentemente espaçados.
-Vantagens:
¿3 Facilidade de uso
t- -#•	ítkrfj» i», aaa u wj,
¿¿¿3 Possibilidade de melhorar a precisão do resultado através de subdivisões do intervalo de integração.
—Des vantagens:
¿3 A preci são do método depende da quanti dade de subdi vi sSes do intervalo, e nSo se sabe qual a subdivisão ideal para cada caso.
¿O O tempo gasto para a integração é proporcional a quantidade de subdivisões do intervalo de integração.
E. 4
Integração através de uso do splines cúbicos
Interpola-se os valores obtidos de pwfCt3 ou dpwfCtJZdxj através do polinómio cúbico definido por:
fCO = CCi ,33 . Ct-ti33 + CCi»2XCt-ti32 + CCi,13.Ct-U3 + PCi3
e integra-se a expressão resultante analiticamente.
O problema se torna então a determinação dos coeficientes CCi ,33, CCi,23 e CCi,13 para cada caso.
Pode-se também usar a função degrau unitário para efetuar esta integração, e transformar a integração do intervalo de zero a tp em:
tp	n tCi+13
¡.-t rtu dl,
i=l tC13
11	=	CCi ,33. El. CE2CA13+A23-6Zs43	CE.	43
12	=	CCi,23.El.CE2CBl3+ÍZs33+2Zs33	CE.	S3
13	=	CCi ,13. El. CE2. BI + ÍZS^	CE.	63
14	=	PCi3.El.CE2 + 1ZS3	CE.	73
onde
Dt =	Tiií - Ti	CE.	83
Al =	CDt - lzs3	CE.	93
À2	=	3. DtZs2-5Zs3	CE. 103
BI	-	Dt + izs	CE. 113
El	=	e“sTl-	CE.1E3
-e~S'Dt	CE. 133
-Vantagens:
£3 Rapidez no cálculo da integral
¿£3 Precisão nos resultados
-Desvantagens:
£3 O método de integração só funciona bem para integração com dados gerados Csent ruidos3. porque a variação dos valores da interpolação entre os pontos tem que ser suave.
ti3 Para alguns casos deve-se modificar os valores das condições auxiliares do splines cúbicos, que geralmente são os vaiores das der i vadas pr i mei ra ou segunda, devi do à mudança das derivadas nos tempos inicial e final de um teste para outro dependendo do comportamento do poço.
ii3gasta-se um tempo grande calculando os coeficientes do splines.
E. 5 - Cálculo da integral através do uso de quadratura dos coeficientes do splines cúbicos pelo IMSL:
calcular
C3.CÍ3. Vwii or
o integrando
para gerar
os coefi ci entes
do splines cúbicos, os quais serão usados no cálculo da
integral.
-Vantagens:
i3	Facilidade de uso
ti3 Precisão nos resultados
-Desvantagens:
£3 Demora nos cálculos das integrais
6.	Integração através do uso de transformada de Laplace.
»
162)
pwfCz
O método consiste em obter uma nova expressão no espaço de Laplace, a qual possa ser Invertida numericamente, seja
t
p
Cl - j e“st.p^.CtCdt	CE. 143
Jo w
Aplicando-se a transformada de ¿ctplcxce a eq. E.Í4 tem-se:
OL^CI ~ pTfCz + s2&gt;,	CE.15D
Logo
Cl « a."4/ - .
I	z
onde:
z é o novo argumento da transformada de Laplaae
PvfCz + s) é a transformada de taploce da pressão p calculada em Cz + sD.
-Vantagens;
€3 Rapidez e simplicidade do método
-Desvant agens:
O A precisão do método depende basicamente da preci são do algoritmo de inversão numérica da transformada de La.ploce.
¿t? D algoritmo que apresenta melhor precisão é o algoritmo de Crurrtp &gt; que i ncl usi ve tem o contrôl e do erro máxi mo permitido. Entretanto, sua utilização requer o conhecimento das funçSes de Ôesse^ modificadas para argumentos complexos, as quais não estão disponíveis.
¿¿¿D O algoritmo de Steh/est apresentou erros consideráveis quando aplicado ao exemplo, principalmente para os dados finais do período de estática.
E. 7	- Cálculo da integral através do uso dos quadrados
mínimos com funçSes B-Splines cúbicos.
Para se resol ver
tp
integral Cl = j" a stp dt no a	w
intervalo de zero a tp Ctempo de produção?, pode-se usar um ajuste que n2o passa necessariamente pelos pontos observados, O método consiste em se aproximar o integrando p Ct?
20	W por
&lt;Ns+2)
PwfCt? = ACiX	CE.17?
L=±
onde Ns é o número de B-splines do intervalo BXt? são valores definidos pela base B-splines, AC 13 são coeficientes que minimizam o resíduo ao quadrado definido por:
	n	&lt;N»+2)	2	
RCACi?? = Min	1 f t.co	- 2 ACi?.	BC t? ]	CE. 183
j=t		i—1		
Para determi naçao	de ACi} dever-se derivar a			expressão
acima com relação a	cada AC i 3	e obter	o vai or	nulo da
derivada:				
a R				
	 = O	para	i = 1,2, , . .	. . ► ns+2		CE. 19?
dACi?
Resultando em um sistema normal com ns+2 equaçdes ns+2 inc6gnitas&gt; as quais são os coeficientes ACi?.
Para se efetuar o cálculo da integral em sub-intervaios definidos entre os tempos tj e tj+i» deve-se novamente multiplicar a integral pela função degrau unitário [Si+í-Si], a fim de restringir o limite de integração:
tp íNa+2)	tv+l
ACj? [*e~st B.Ct? dt CE. 20} "0	'f~*	t=i	X.
i
Nesse caso a função B-Splines também deve ser definida no intervalo de tt a ti+i ao invés de tí-2 a tí+2 como
+3Ct-t ís+e sêh3+ 3^ Ct.-t? + 3hCt.-t3S -3CL, -C33 + j	j+i	j+i	j+i
CE. 333
cuja solução é:
Cl = 1/h3 CACj~13 li + ACJ3 12 + ACj+13 Ia + ÀCj+23 Ití,
para j= 1,2»	,Ns+2.	CE, 243
onde:	
3	2	3	4	
I± = E1CE2CA1 + 3dtZs - 5/s5 + GZs3	CE. 253
Iz ~ E1CE2 A2 - A3Zs3	C E, 253
Is - E3CE4 B2 + B3zs3	CE. 273
Í4 = E3CE4CB13 + 3 DtZs3 + 5 Zs3 3 + 6Zs43	CE. 283
com	
Al = Dt - iZs	CE. 293
sendo	Dt = tj+i -tj	CE. 303
A2 « h3 + 3hZsS - SDtZs3 + 16Zs3 - SAICÁI3 - Al h	2 - h 3
	CE. 313
A3 ~ Ch-lZsD3 + 3hZs3 + IQZs3	CE. 323
BI - Dt + IZs	CE. 333
B£ - h3 + 3hZsa ~ QDtZs3 ~ 13Zs3 ~ 3BlCBia - Bi h	~ h33
	CE. 343
B3 = Ch+lZs33 + 3hZs3 + 19Zs3	CE. 353
™.	“S tj+l Ei ~ e	CE. 363
s Dt	
£5	CE. 373
E3 =	CE. 383
~s Dt	
E4 =	-	CE. 393
s
-Vantagens do método:
Rapidez no cálculo da integral
¿£3 Precisão nos resultados
¿¿□Permite suavizar a curva .de fluxo pela minimização dos ruídos.
£v3 Permite o cálculo das integrais envolvendo a derivada da pressão no integrando com relação aos parâmetros.
-Desvantagens do método:
£3 Com relação aos métodos pesquisados não há desvantagem.
APÊNDICE H - SOLUÇÃO DO PROBLEMA DO DST ATRAVÉS DE DIFERENÇAS
FINITAS
Considerando a equação diferencial parcial para um fluxo
radial de um fl*	ií do	com vi scosi dade		pequena e	com bai xa
compr es si bi 1 i dade	^5	coando	num mei o	poroso	homogéneo.
isotrópieo» de *&gt; j*	espessura		constante	teremos a	segui nte
1 3 L.	a p	- 1 ~ ■	a p		CH. 13
r â r t	&amp;amp; r	J	a t		
x “ ir*	r-		X r- —		CH. 23
1	&amp;amp;	f Jr	a p	1 ■)	i	a p		CH. 33
r* ¿? x -	a x	r J	r	a t		
CH. 43
A discretização fica:		
x=a	Ax	Ax
X=Xn
í	i	i	i
i “0	l~"í	1	t+í
nx
a^ p	p	— 2 p + p
L - i	L + 1
2:	. 2
d x	Ax
CH. 53
â p	n+i p. -		n pv
a t		At	
CH. 63
sendo
nível de tempo atual
n + 1&amp;lt;♦ nível de tempo futuro
O método totalmente implícita fica
P.-i
■ a p. + p.
I	tfl
j.
Ax
Mi
Sx f P t
= e
{■
n
P- 1
At2_ }
CH.53
n+1
i-i
ni-1
pi
Ax 2 1
At
n+i
P
i+t
C zx,3
-e t
z
Ax n ~At~ Pt
Chamando ce
^2X 3
B L
CH. 63
n+i p.
t+1
n+1
P
t
■b
n+1
P
t+i
Ax At
n -a p.
CH.73
CH. 83
[ a + .«
[
a + o
]
a&amp;lt;
&amp;lt;nx
i
i.
Discretização da condicão de		contorno interna	
d p	f	* P i		
C 	-	-	—	= O	CH. 93
d t	c	d r	-*r =	1	
onde
{C	no fluxo
C	na estática
s
Fazendo a substituição de variável
d p.
&lt;? P
CH.93
n+t rP, „ l At
rite. L
H+i r c pi ["Ãt +
n+i
P
ÃX
4-
z
^2
n+1
P 1
C
At
CH. 103
CH.113
d t
à x
n
= 0
C
]
- O
1

n P *2
chamando
n+1
n+t
CH. 123
CH. 133
contorno externa
Considera-se um
reservatório limitado com
raio externo grande o suficiente
para que a queda de pressão
em r = ro seja nulo.
p
[

a r
CH. 143
a p
]
-*X ~ X
0
CH. 133
a x
*¿X1¿X I
nx-i nx	nx+*
ponto
o
Cnx+13 é um ponto imaginária.
Q p
n+1
P n+ 1
n+1
Pn-1
CH. 163
O
a x
a ¿x
P
n+1
n+í
n-f-1
CH. 173
Montagem do sistema tridiagonal
i	= 1
.	1	n+1	n+1	n
*+1J p- + p‘ - -e p.
CH. 133
1 24
A X
A t
CH. 143
i &amp;lt;2 &amp;lt;nx ~ 1
n+i	! p.	-	2 V+A	t	+	r&gt;+± p	= -« L+l	n pí	CH. 153
para		C zx 3&amp;lt;x, — e	í	ZAx	CH. 163
			At	
i - nx				
...	n+1 r 2. p	- nx-t	{	.	1	n+1 2 + a 1 p nx i	nx	n - -Oí	p nx nx		CH. 173
Si £ tema t r i di agonal
Seja Ã a matriz dos coeficientes abaixo:
i -
rix-l
nx
1
-ca-no	i
1	3
nx
1
a
Se ja IB &amp;amp;&amp;lt;C os vetores coluna abaixo:
A solução das pressSes será dada por &amp;amp; EB = C
programs
I,. I* »» M
í UÍKC» àW
¿K4 wat ¿ifl *5¡ft «S tv*.
ruf u nA
Apêndice G. 1 - Otimização no fluxo para cálculo de k, S, p e
C f
-	As subrotinas Coeff, S18acf, &amp;amp; SlSadf estád no apêndice G. 4
—	A subrotina Zxssq é da biblioteca do IMSL para micro PC.
Program zero
External Pressa,Coeff , SISacf, SI8adf
Integer M,bf,Ixjac,Nsig, Maxfn, Iopt, I,Infer,ler
Real ParamC43 ,XC43 ,FC273 ,XJacC27,43 ,XjtJCiO&gt; , Work&amp;lt;843 ,Eps,Del ta wíSsq,XlC43
Real*8 Timet 273 , Pwf C273 ,DpwfC27? ,P1 ,Pe, Po, Rw,Ct,Phi , Vi sc, Th, Cl, C2, mC3
Common /Dados/Time,Pwf
Common /calc/ Dpwf
Common /reser/Po,Pe,Rw,Ct,Phi,Vise, Th, Pi,Cl,C2,C3
Open Cl,File = ’Topo. dat *3
Open C 2, File = * c: slug, dat ’ 3
OpenCS, Fi le = * C: itera, datf 3
OpenC4,File = ’C: curva, dat‘3
C. . . .. Parametros para a rotina de minimizacao.........................
M = 27
N = 4
Ixjac = 27
Nsig = 8
Eps =0.0
Delta = 0.0
Maxfn = 300
Iopt = 2
ParamC13 = 0.01
ParamCSl = 25.
slihC 33	130 „
ParamC43 =0.1
C....Vai cross i r&gt;i ci'ai s dos parsmotro k , c , pi , s.................
X1C13 = 1.
X1C23 = 80000.
X1C33 = 0.
X1C43 = S.6S
C.....Outros dadosC Unidades Americanas?
Ct = 10.20D-Q6
Phi= 0.062
Visc= 60.0
Pe = 8S2.
Th = 38.
Rw = 4.248
C
C. ,...parametros iniciais de reservatórios k,c,po e s C Unidades Darcy?... WriteC2,200?
200 FormatClh,/,49x,/,10x,’PermeabilidadeCdarcy?’,
-x3x, ’EstocagemCcm3/atm? ’ , 3x, ’ PoCatm? ’ ,5x, ’Skin* , /?
WriteC2,2iO3XlC13,XlC23,XlC43,XlC33
210 Formatí 10x,Dll. 4,9x,Dll. 2,10x,D12. 3,5x,D12. 3,/3
C.....parametros de fluido e rocha........................................
WriteC2*1805
180 FormatCz*25x*1 Dados de fluido e rocha't/,3x,'Compress. Cl/ps£5’, *3x, "Poros!dade’ , 3x* * viscCcp5 * ,4xt ’Pi Cps!5 ' ,3x,'Thípes) \3x, »’RwCin5 ’ ,/5
Wri teC 8.1405Ct,Phi,Vi se,Pe,Th,Rw
140 FormatCIx,El0.3.10x,F8.3»7x,F6. 3,3x.F9. 8,6x»F6. 8,3x*FS.35 C.....Transformacao dos dados para o sistema Darcy de undidades.
Ct = Ct»14. 7
Pe = Pe/14.7
Th = Th*30.48
Rw = Rw»2. 54
C.....Parametro auxiliar
P1 =4.«Datant1.0D05
C1 ~ DsartCPhi*Visc*Ct*Rw*Rw5
C8 = 8. xPl*Th/Visc
C3 = DlogC2.D05
C
C.....Escalonamento dos parametros para minimizacao.......................
XC15 = X1C15
XC85 = X1C25/100000.
XC35 = XIC 35/10.
XC45 = XIC 45/10.
Cali ZxssqCPressa,M,N*NSIG( EPS*DELTA»MAXFN,I&lt;5PT, PARAM, X *SSQ,F* wXJAC * IXJAC , X JTJ * WORK * INFER*IER5
C: :::::::::::::::::: : Impressão dos dados finais:
WriteC2,35Ssq*Infer.Ier
3	FormatCSx*’Soma dos quadrados dos residuos = ’,D10.5,/,5x,’Criterio *e de convergencia que foi satisfeito =’(I3,/,ox,’Erro =’,I3,//,3x, «’Valores residuais = Pmed. —Peal na ultima convergencia’ * /5
C.....Descalonamento dos residuos apos minimizacao
150 51 I s 1 ,M
31 FCi5 ~FCi5*PwfCi5
WriteC2.8205
880 FormatClH*////,13x,’Pressões Geradas no file 4’,//*19x,’tChr5’*3x* x’PwfCpsi5’,5x,'DpwfCPsi5’,5x,’Residuos’,/5
WriteC4,24O5CTimeCi5 *PwfCi5 *Dpwfíi5 *FCi5 *1=1 ,M5
840 FormatCl7x*F7. 4*3x,F9. 2*5x*F9. 3*3x*F10. 55
C. . . . .Descalonamento dos parametros apos a minimizacao........    .	. . .
XC15 = XC15
XC25 = XC25W1OOOOO.
XC35 = XC35*1O.
XC45 = XC45W10.
WriteC8*15Ci,XCi5*i = 1,45
1 For matt Sx. ’Valor otimo = ’ * ’XC ’ * i3, ’5= ’,2x,DlO. 45
WriteC£,115
11	Fórmate//,5x,’Matriz aproximada do ultimo j acobi ano ’ ,/5
Do 7 I = 1*13
7 WriteC2,95 I *CXjacCi *J5,j = 1*45
9	FormatC2x*i2*4C4x*lPel2.555
WriteC2,135
13 Fórmate/* i x. ’ Vetor norma grad- num iteracoes~num dígitos signific-~ e marquadt algorit resp. ’,/)
WriteC2,15?Cl .WorkCl? ,i=l ,5?
15	FormatCSx,rWorkC*,12,*3= ’.FIS.S?
Ci	i ■'»
Close C2?
m	3^
S-4A	iwêri?
CloseC4?
End
Block Data Entra
C..... Dados de pressão do teste
Real*8 Ti meC 273,PwfC273
common ZDadosZ Ti me,Pwf
Data Time ZO.022.0.026,0.034,0.041,0.053,0.067,0.084 *,0. 106,0. 132.0. 166.0. 187.0. 209.0. 236,0. 264,0. 296,0. 334, *0.372.0.418,0.47,0.528,0.59,0.662,0. 774,0. 836,0. 938,1.061. Ml.126Z
C
Data Pwf Zl54. 36,162. 77,178. 64,191.66.212. 33,235. 07,260.33
*,290. 27.322. 43,360. 31,381.69,402. 68,426. 82,449. 74,473.37,500.57, *524.7,651.18,678.,604.36,629.63,655.09,688.34,703.76,726.34, *746.97,758. 71Z
End
Subr out i ne Pr essat X, M, N, F?
Integer M.N.M1,NL»I,K.J.Ifail
Real *8 PwtC 275 , Ti meC 272 , AC 27? , VC 20? . DPwf C 373 , SI 8acY.
«SI 8adf,Xs,Cl, C2, C3, BkO, Bkl , Auxl , Aux2,Aux3, Àux4, Sumr , Plapr , Y, Z, Pi M,Pe,Po.Rw,Ct,Phi , visc,Th
Real XCNJ.FCM?
Commonzl pl ZV, Ml
Common zDadosZTi me,Pwf
Common ZcaleZDpwf
CoKiinon /reser/Po,Fe,Rw,Ct,Phi , Vise ,Th, PI ,Cl , C2,C3
C.....Descaionamento dos parâmetros para minimizacao.......................
XC1? = XC1?
XÍ2? = XC 2? *100000.
KC3? = XC3?*10.
XC4? = XC4?*10.
C. ... Impressão dos parâmetros que serão minimizado........................
WriteC3,42?CXC1?,i=l,N?
42	FormatC3x,4C3x,Fl5.3??
C. . . . . Calculo da funcao com inversão de laplace.......................
Ml = 8
Ml = 1
Do 10 i = 1 ,M
10	TimeCi? = Ti met i ? *3600.
Gama = DsqrtCXCl??
Al f a = ClzGama
Aux4 = C2*XC1?ZXC2?
C
D0 20 1=1,M
20 ACI?=C3ZTlmeCI?
C
Cali CoeffCNl?
C
Do 40 i = 1j M
Sumr = 0.
Eto 30 J = 1,N1
Z = J * ACiD
Y = DsqrtCzD
Xs = Y* Alfa
BkO = SISACFCXs. IFAILD
Bkl = S18ADFCXstIFAILD
Àuxl = XC32) + BkOzCXs * BK12)
AuxZ = C2*XCll*PeZCXí3D*ZD
Aux3 = XC 42) *Auxl + Aux2
Plapr ~ Aux3ZCZ*Auxl + Aux4 D
30	Sumr = Sumr + VCJ2)*Plapr
40 DpwfCiD- Sumr* AC 12)
C
Do 50 I = 1,M
DpwfCiD = DpwfCi2)*14. 7
Ti meC i D = Ti meC i D Z3S00.
FC12) = CPwfCiD - DpwfCiDDzPwfClD
30	Write C*^1DFC1D
1 FormatC3x&gt; ’ F =* , El5. 82)
C
C.....Impressão do valor da soma dos quad. resíduo nesta iteracao..........
Tot = 0.
Do 31 jk=l(M
31	Tot Tot + FCjkDwFCjkD
C.....Escalonamento dos parâmetros para minimizacao........................
XC1D = XC1D
XC22) ~ XC2DZ100000.
XC32) = XC32JZ1O.
XC42? = XC4DZ10.
WriteCl t32DCXCI5 fI«l »N2&gt; &gt;Tot
32	FormatCSF14.43
Eeturn
End
Apêndice G. 2 - Otimização no fluxo para cálculo de k, Sep O
—As subrotinas Mrqmin, SISacf, SL8adf, Coeff est^o apresentadas
no apêndice G. 4.
Program Kspoposi
Implicit real*8Ca-h, o-zD
Externai Mrqmi n * Funes
Di mensi on XC 273 ,Fwf C 273 , Si gC 273 . AC 33 , Li staC 33 , «CevarC 3 , 33 t Al f aC 3,33 , VC 203
Common /reser/Cf * Pe, Rw, Ct , Phi , Vi sc , Th, PI. Cl ,C2, C3
Common ZLplzV,Ml
Save Ic
C
OpenC2,file = ’Kspo.dat’3
Data IcZlZ
Data X ZO.O22,O. 026,0.034,0. 041,0. 053,0. 067,0.084
«,0.106.0.132,0.166,0.187,0.206,0. 235,0. 264,0. 295,0. 334, «O.372,0. 418,0. 47,0.328,0.69,0. 662,0.774,0.835,0.938,1.031, Ml . 12ÔZ
C
Data Pwf xl07. 897,111.445.118.367,124.266,134.099,145.196,158. 217 M,174.438,192. 820,215.743,229. 337,243. 156,258. 970,275.990,293.512, *314.638,334. 308,356.997,381.277,406.778,432.344,460.022,499.211, M61S.768,549. 225,579.306,597. 544Z
C
Data A Z. 5,0. ,8. 5Z
Ml = 1
Ndp = 27
Np = 3
Nca = 3
Mfit = 3
Al amda ■= -í.
Chisgi = 0.
Listad D =1
Li staC 2D =2
ListaC 33 =3
C.. . . . Outras dadosCUnidades DarcyD
Cf = 85239.7
Ct = 10. 20D-06M14. 7
Phi ~ 0.062
Visc= 60.0
Pe = 892. Z14. 7
Th = 38. *30. 48
Rw = 4.248*2.54
C. ... .Impressão dos parâmetros
WriteC2,O ' Valores arbitrados inicial mente para otimizacao ’ WriteC2,200D
200 FormatC lOx, ’ PermeabilidadeCdarcyD ’ , 5x, &gt;Ski n ’ , 3x, * PoC atmD ’ , ZO Wri teC 2,21OD AC ID , AC2D , ÀC3D
210 FormatC 10x, Dll.4,9x, Dl 1.2,10x, Dl2. 3D
C. . . . .parametros de Tluido e rocha....................................
WriteC2,1203
120 FormatCZ,25x,* Dados de fluido e rocha1,z,2x,’Compress. C1Zatm3 f„ *tâx.’Porosidade’»2x.‘viscCcp3 ‘ ,3x,’Pi Catm3 ’,3x, !ThCcm3 ’,3x. «’Cf* .2x, ’KwCcnO ’ ,Z3
Wri teC2»1403Ct, Phi ,Vise, Pe, Th» Cf» Rw
140 FormatClx,El0. 3,7x,F8. 3,5x,F6. 3,4x,F8. 2,5x,F8. 2.2x.F8.5»2x.F8. 33 C.....Parametro auxiliar .................................................
PI = 4.«DatanCl.ODO3
Cl = Dsqr tC Phi *Vi sc«CtmRwmRw3
C2 = 2. «PlMThzVise
C3 = DlogC2. DOO
C.....Transfornacao do Tempo para unidades Darcy..........................
Do 10 1 = 1» Ndp
XC13 = XCi3*36O0.
PwfC13 = PwfCi3Z14.7
10	SigCi3 = l.D-03
C
190 Call MrqminCX,Pwf»Sig,Ndp, A, Np, Lista»Mfi t,Covar , Alfa,Nca,Chisq *» Funcs,Alamda3
Wr i teC«» 1553Chi sq, Alamda
155 FormatCSx, ’Chisq= ’ ,F25. 7,3x, ’ Alamda=’ ,F15. 103
C	WriteCl ,1603
C 160 FormatClOx, ’ Permeab. Cdarcy3 ‘ , 3x, ’ PoCatm3 ’ , 5x, ’ Ski n ’ 3 WriteCl ,18031c,CACI3,1=1 ,Np3
180 FormatCI3,3x,F11.4,3x,F12. 3»3x»F12. 33
Ic = Io + 1
IfCCChisq-Chi sql3 . Ge. O. 3 Then
Chisql = Chisq
Go to 190
Endif
IfCCDabsCChisq“Chísql33.Le.1.0D“23 Go to 195
Chisql = Chisq
Go to 190
193 Do 55 I = 1, Ndp
Call FuncsCXCi3,A,Dpwf,Dp.Np3
35 Wri teCS» 113CXC13Z36OO. 3 ,CPwfCi3M4. 73 ,CDpwfX14. 73 ,CPwfCi3 -Dpwf3* *14. 7
11	Formate3x, FIO. 3,3C3x, F13. 53 3
CloseC23
End
Subroutine FuncsCXl,A,Dpwf,Dp,Np3
C esta funes e para o caso de determinação de K,S e Po.
Implieit real«SCa~h,o~z3
Externai Coeff,SISacf.SlSadf
Di mensi on AC Np3 , DpC Np3 , VC 203
Common ZLplZV, Ml
Common Zr eserZCf,Pe,Rw,Ct,Phi »Vi sc»Th»PI , Cl,C2,C3
C
Wri teC«, *3C AC 13 ,i=l ,Np3
C. . . . .Calculo da funcao com inversão de laplace.......................
NI = 8
Do 40 I = 1»Np-l,3
Gama = DsqrtCACI33
Alfa = ClzGama
Aux4 = CSMACID/Cf
c
Al = C3ZX1
C
IfCMl. Eq. N13Ga to 11
C
Call CoeffCN13
C
11 Sumr = 0.
Sumbl - 0.
SuiKhS = 0.
Sumb3 = O.
Do 30 j = 1 * N1
Z = J * Al
¥ = DsqrtCZ)
Xs = YM Alfa
BkO « SISACFCXs*IFAIL3
Bkl » S18ADFCXs,IFAIL3
B ~ BkOzBkl
Auxl = AC I *13 + BzXs
Aux2 = C2«ACI3-*PeZCCf *zD
Aux3 = ACI+2j*Aux1 * Aux2
AuxS = C1.ZC2. *ACI333mC1.-B*®3
Aux8 = Z*Auxl + Aux4
Plapr = Aux3ZAux8
Plap2 = CZ*Aux2 ~ ACT *23 *Aux43 *C Auxl ZC AC 13 3
Plap3 = C Aux8*ACI*23 —Aux3*Z3 ZC AuxQ*Aux83
Plap4 = AuxlZAuxB
Sumr = Sumr + VC J 3 *P1 apr
Sumhl = Sumbl + VC J 3 *P1 ap2
Sumb2= Sumb2* VCJ3MPlap3
30 Sumb3= Sumb3+ VCJ3*Plap4
Dpwf - Sumr* Al
DpCi3 = SumblxAl
DpCi*13= SuniD2*Al
40 DpC 1 *23 = Sumb3*Al
Return
End
Aux33 ZCAuxQxAuxSl
Apêndice G. 3 ~ Otimização na estática para cálculo de ktS ♦ Pi.
—As rotinas Mrqmin, SISacf , SlSadf, Coeff e Qíííbs estão apresentadas no apêndice G. 4.
d ei n ft n
PROGRAM DSTp
I mpl i cx t real *8C a-h t o-z3 Externai Mrqmin,Funcs Dimension AC63 ,Lista.CS&gt; ,CovarC6,6) , AlfaC6,65 Real*8 TCNxD.PCNxJ
Real *8 DpweC Ndx3 , X tC Ndx3 . Si gC Ndx5 , VC 203 Common ZLplz V.Ml Common zCestzVw.Cw
Common Zr eserZCl,CE,C3
Common zSplZT.P.Sig.Xt,Dpwe
Common zPontosZN.Ndp.Nx,Nde,Ndx
Common zPvtzCt,Phi,Vi sc .Po»Pf f,Th,Rw,PI,Cs,Cf . Pk,S»Pe Common ZVazA
Save ZVaz
C: : : : : Abre-se arquivo para dados de saida: I:::::::::::::::::::::::::::::: QpenCE.file — f Dstp.dat '3
C:::::Chama-se todos os dados do fluxo, estatica e Pvt CVia CommonD: : : ::: Cal1 Dados
C::::: Chuta-se os parâmetros iniciais para otimizacao: ::::::::::::::::::: AC15 - Pkz6.
AC23 = Sz5.
AC 35 - DpweC Ndx3 AC45 = Cw*VwZ2. AC 35 = Cf
AC63 = Po
C: : : :Define-se os parametros para o algoritmo de otimizacao: Np = 6 Nca = 6
Mfit = 4
Alamda = -1.
Chisql = O. ListaC 13=1 ListaC 23 =2 ListaC 35 =3 ListaC 43 =4 Li staC 55 =5 ListaC 65=6
:::;;Imprime os valores iniciais das variaveis: WriteC2.*3 ’Valores e iterações de K.S.Pi.Cs.Cf e Po sao:’ WriteC2,13O5CACI5.1=1 , Np5
180 FormatC6C2x, D10. 453
: : : : : Processo de otimizacao: I:::::;:::::::::::::::::::::::::::::::::::::
190 Call MrqminCXt,DPwe,Sig,Ndx,A,Np,Lista.Mfit,Covar.Alfa.Nca.Chisq
r&gt; n
M,Funcs. Alamda3
C: : : : Imprime-se os resultados da regressão nao linear:
Wr iteC*.1553Chisq»Alamda
155 FormatCSx. &gt;Chisq= &gt;/E15. 5.3x, ’ Alamda-‘ , F26. 153 WriteC2,1853C ACI3.1-1 . Np3
183 FormatC6C3x,D10. 433
IfCCChisq-Chisql3 . Ge. (3. 3 Then
Chisql = Chisq
Go to 190
Endif
IfCCDabsCChisq-Chisql33 . Le. 1. OD-23 Go to 195
Chisql = Chisq
Go to 190
195 WriteC2,1653
155 FormatCSx^ * Valores finais de K S Pi Cs Cf e Po apos a otimizacao’3 WriteC2.1833CACI3.I-l.Np3
183 FormatC6C3x, Dl0. 433
Do 55 I = 1 , Ndx
Cal 1 FuncsC I. XtCi3 .A,Dpws, Dp(Np3
55 Wri teCS. 113CCXtCi33z3600. 3 &gt; CDpweCi3*l 4. 73 ,CDpws*14. 73 .
*C DpweC i 3 -Dpws3 *14.7
11	FormatC3x. FIO. 5,3C3x»F15. 533
CloseC S3
Return
End
: ::: :Entrada de todos os dados do fluxo»estatica e Pvt: ::::::::::::::::: Subroutine Dados
Implici t Real*8C a-h,o-z3
Reales VC203
Real *8 Ti meC Ndp3 , Pwf C Ndp3 , TC Nx3 , PC Nx3
Real*8 XC Nde3„PwsC Nde3,DpweC NdxS„XtC Ndx3,EigC Ndx3 CommonZl.pl ZV, Ml
Common ZCestZVw,Cw
Common ZreserZCl.C2»C3
Common ZSplzT,P(Sig»Xt,Dpwe
Common Zpontos/N,Ndp.Nx,Nde.Ndx
Common zPvtzct.Phi .Vi sc,Pa.Pff»Th, Rw, PI, Cs, Cf * Pk »S, Pe
C:	:os parametros para o calculo dos coeficientes de Stehfest
Ml — 1
N ~ 8
C: : : : : Dados relativos ao Spline: ::::::::::::::::::::::::::::::::::
Ndp = 27
Nde = 33
Nx = Ndp + 1
Ic ~ Ndp
Ndx = Ndp + Nde
C: : : : : Outros dadosCUnidades Americanas3 ::::::::::::::::::::::::::::::::::
Ct ~ 10.20-05
Phi = 0.062
Vise = 60.
Po = 86.
Pff = 397.344
Th = 38. Rw » . 354
C: : : : : Calculo do parámetro auxiliar PI
PI = 4. «DatanCl. DOZ)
CPA= 1. /14. 7
C: : :: :As unidades relativas a estática ja estão em DARCY:
Vw = O.446S48545E+06
Cw = 6.0E-O6*14.7
Cs = Cw*Vw
Rp =&amp;lt;3. 826/25*2. 54
Grad = 0.00087017
C: : : : : Parametros de reservatórios k,c,pi e s CUnidades DARCYj:::::::::::: Pk = 1.384
Cf « CPI«RpxRpD/Grad
S =	2.
Pe = 892.MCPA
C: : : : :Transformacao dos outros dados para o sistema DARCY: : :::::::::::: : Ct = Ct*14.7
Po = Po*CPA
Pff = Pff*CPA
Th = Th*3O.48
Rw = Rw«30. 48
C: : : : : Parametro auxiliar: ::::::::::::::::::::::::::::::::::::::::::::::::
C1 = DsqrtCPhi*Visc*Ct*Rw*Rw3
C2 = 2. *PI*Th/Visc
C3 = DlogC2. EX»
C:::::Impressão dos parametros::::::::::::::::::::::::::::::::::::::::::: C	Wr i teC *, 2002)
C 200 FórmatelOx,’Permeabi1idadeCdarcy?’,Sx,'Skin’,5x,♦PICatnO *,/O
C	WriteC*,21O0Pk,S,Pi
C 210 FormatClOx.Dll. 4,9x,Dll. 2,5x,D12. 32)
C: : : : : Parametros de fluido e rocha: ¡i::::::::::::::;:.*::::;:::::::;:::::: C	WriteC2,1203
C120 FarmatC/, 2Sx, ' Dados de fluido e rocha’t/,3x,’Compresa. Cl/atm)’, C »3x,1 Porosidade*»3x,’viscCcpD*,4x,’Pff Catm2&gt; * , 3x, ’ IThCcmlí *,3x, C w’RwCciíü * ,zO
C	Wri teC2,1403Ct,Phi , Vise, Pf f,Th,Rw
C140 FormatClx,E10. 3,10x,F8. 3,7x,F6. 3,6x, F8. 2,4x, F8. 2,2x,F8. 32?
C
Data Time /O. 022D0,0.026D0,0.03400,0. 04100,0.O53DO,O.067D0.0.O84D0 »,O.10600,0.13200,0.166DO,O. 187D0,0.20900,0. 23500,0.264,0.295,0.334 *,0.372,0. 418,0.47,0.528,0. 59,0. 662,0. 774,0. 835,0. 938,1.051,1.126/
C
Data Pwf ZL07. 897,111.445,118. 366,124. 266,134. 099,145. 196,158. 217 *,174. 438,192. 820,215. 743,229. 337,243. 156,258. 970,275.990,293. 512, *314. 638,334.308,356.997,381.277,406.778,432.344,460.022,499.211, *518. 768,549. 225,579. 306,597. 544/
c
Data X Z0.O22D0,0.Oa6D0,0,034D0,0.O41D0,O.053D0»0.067D0»0.084D0 *,0.106D0,0. Í32EX&gt;.0.166Ex3,0. 187!X),0. 2C9DO.O. 235DO.O. 264,0. 295,0. 334 x,O.372»O, 418,0. 47,0. 528,0. 59,0.662,0.774,0.835,0.938,1.051,1.181. *1.326,1.486,1.666,1.87,2. 098,2.189Z
C
Data Pws z718. 327,719. 993,723. 106,725. 840,730.437.735.658,741.793, *6749. 407,757. 946,768. 390,774. 449,780. 488,787. 236.794. 288,801.302, *809. 408,816. 592,824. 426,832. 254,839.846,846.801,853.591.861.905, *865.498,870. 382,874. 390,877. 707,880.226,882.063.883.319,884.120, *884.573,884. 677Z
C
C.. . . .Transformacao do Tempo para unidades Darcy......................
TC 13 = 0.
PC13 = Po
Do 10 I = l,Ndp
K - I + 1
TCKD - Timed 3*3600.
XtCI3 ® TCK3
PCK3 = PwfCi3zl4.7
SigCI3 = l.D-03
10	DpweCID = PCK3
Do 17 K = Nx,Ndx
le = K-Ndp
DpweC SO - PwsC I e3 Z14. 7
XtCK3 -	XCIe3*3600. + TCNx3
17 SigCKD « 1.D-O3
Return
End
SUBROUTINE FUNCSCKF.XI,A,DPWF,DP,NP3
Implicit real*8Ca-h,o-zD
External Coeff
Di mensi on AC Np3 , DpC Np3 , VC 203
Real*8 TC503 , PC50D , SigClOO3 , XtClOOD , DpweClOOD
Common zLpl/V.Ml
Common ZReser ZC1,C2,C3
Common ZControleZld„Icent
Common ZSplZT,P,Si g,Xt,Dpwe Common ZPontosZN,Ndp,Nx,Nde,Ndx Common ZDeri ZGarna, Al f a,Auxl2,Auxl3,Auxl4,Aux20 Save ZControlez,zDeri z
C: : : : : Calculo da funcao com inversão de laplace: ::::::::::::::::::::::::: IfCKf. LE. NdpDThen
CALL FLUXOCX1 ,A,DPWF,DP,NP3
I cont = Icont + 1
Return
Endif
Al = C3ZX1
IfCMl. Eq. ND Go to 9
CALL COEFFCN3
Q	IfCId.Eq.13 Go to 11
CALL CONSTCNP.A3
11	Continue
SuiRT = 0.
Sumbl = 0.
Surab2= O.
Sumb3= 0.
Sumb4= 0.
Sumb5= O.
Sumb6= O.
Do 30 J = 1,N Z = J * Al
Y - DsqrtCZ3
Xs = Y* Alfa
CALL PDESTATICAC A,NP,XS,Z,FLAP , PLAP1»PLAPE,FLAPS, * PLAP4,FLAPS,PLAP63
30
Sumr ~ Sumr + Sumbl- Sumbl+ Sumb2= Sumb2+ Sumh3= £umb3+ Sumb4= Sumb4+ SumbS- SumbS+ Sum.b6= Sumb6+
VCp*Pl ap VC J3*F1 api
VC p*Pl ap2 VC p*Pl ap3 VCj3*Plap4 VCJ3*Plap5
VC J3*Plap6
Dpwf = Sumr* Al
WriteC*,*OCXI/3600. 3 .Dpwf*14. 7
DpC 13= Sumbl *A1
DpC 23 = Sumb2*Al
DpC 33= Sumb3*Al
DpC 43 = Sumb4*Al
DpC53= Sumb5*Al
DpC 63= £umb6*Al
Icont = Icont + 1
IfCleant. Eq. Ndx3 Then
Id = 0
Icont = 0
Endif
Return
End
SUBROUTINE C0NSTCMP.A3
Implicit Peal*8 Ca-h,0-2:3
Di mens!on AC Np3
Common /ReserZC1.C2.C3
Common /Deri/Gama, Al f a,Auxl2,Auxl3,Auxl4,AuxSO
Common /Pvt/Ct , Phi,Vise,Po,Pff,Th» Rw,FI,Cs»Cf, Pk »£,Pe Save ZDer iZ
Gama = DsqrtCAC133
Alfa = Cl/Gama
Cte = 1./CC2 M AC133
Auxl2 = CAC403* Cte
Auxl3 = CAC533* Cte
Auxl 4 = Auxl3-Auxl2
Aux20 = -Auxl4ZAC13
Retur n
End
SUBROUn NE PDFLUXOC A, ZE. NP t CI, CI DK. CI OS, CI PI , CI CF, CI PO3
Implicit realx-SCa-h, o-zj
External Coeff,SISacf, SISadf,Mqbs,Cint eg
Di mensi on AC Np3 , VC 203 »TC 503 , PC 503 . Si gC 1003 , X tC 1003 , DpweC 1003
Real*8 PwfC503,DkC503,DsC503 »Dpi C 503.Dpcf C 503 ,DppoC 503„A2C 503
Real *8 AsC 43 , BsC 43 &gt; CswC 43 , DspC 43 , EsC 43 , FsC 43
Common ZL.pl ZV&gt; Ml
Common ZReser ZC1,C2,C3
Common zControleZId ,1cont
Common zSplZT,P,Sig,Xt*Dpwe
Common ZPontosZhi &gt; Ndp, Nx, Nde, Ndx
Common ZDeri ZGama, Al f a, Auxl 2, Auxl 3, Auxl 4 * Aux20
Common ZPvtzCt,Phi »Vise * Po,Pff&gt;Th, Rw, PI,Cs,Cf»Pk,S,Pe
Save ZControleZ,zDeriZ,As,Bs,Csw,Dsp,Es►Fs
IfCId. Eq. 13 Go to 45
Aux4 = C2MAC13ZAC53
PwfC13 = PC13
DkC13 = O.
DsC13 = 0.
DpiC13 = 0.
DpcfC13 = O.
DppoC13 = 1.
Do 40 I = 2,Nx
A2C13 = C3ZTCI3
SumbO = 0.
Sumbl - 0.
Sumb2 = 0.
Sumb3 = 0.
Sumb4 = 0.
SumbS = O.
Do 30 J - 1,N
Z = J * A2C13
Y = DsqrtCZ3
X = Y * Alfa
BkO « SIBacf CX, If al 13
Bkl = S18adfCX,Ifa±13
zi - i. zz
AuxS = BkOZBkl
Auxl - AC 23 + AuxSzX
Aux2 » Aux4*AC33*Zi
Aux3 = AC 63 *Auxl + Aux2
AuxS = 1.-Aux5*Aux5
Aux7 = Aux6ZC2. *AC133
30
40 C
45
C
Aux8 = Z * Auxl + Aux4
AuxSl= 1. ZAux8
AuxSqi = AuxSi *Aux8i
Pressa « Aux3*Aux8i
Derk = C C2ZAC 53 3 *C AC 33 - AC 63 3 *C Auxl ~ AC13*Aux73«AuxSqi
Dersw = Aux4*CAC63 ~ AC333*Aux8qi
Derpi = Aux4*Zi*AuxBi
Dercf = Auxl ZAC 53 *CAC63*Aux4-Z*Aux23*Aux8ql
Derpo = Auxl*Aux8i
SumbO	=	SumbO	+	VCJ3«Pressa
Sumbl	=	Sumbl	+	VCj3«Derk
SumbS	=	Sumb2	-4-	VCj3*Dersw
Sumb3	=	Sumb3	+	VCJ3*Derpi
Sumb4	=	Sumb4	+	VCJ3«Dercf
Sumb5	=	SumbB	+	VCJ3«Derpo
PwfCi3		SumbO		A2Ci3
DkCi3		Sumbl	a	A2CiD
DsCi3		SumbS		A2C13
DpiCi3		SumbS		A2C13
DpcfCi3	=	Sumb4		A2C13
DppoCiD		Sumb5		A2C13
CALL QMBSCT, PWF &gt; AS2)
CALL QHBSCT,DK,BS3
CALL QMBSCT,DS,CSW3
CALL QMBSCT ,DPI&gt;DSP3 CALL QMBSCT. DPCF, ES3 CALL QMBSC T, DPPO, FS3
Id = 1
CALL CINTEGCZE.CI ,T, AS3 CALL CINTEGCZE,CIDK,T,BS3 CALL CINTEGCZE, CIOS, T, CSW3 CALL CI NTEGC ZE, CI PI ,T,DSP3 CALL CINTEGCZE,CICF,T,ES3 CALL CINTEGCZE.CIPO,T»FS3 Return
End
SUBROUTINE PDESTATICACA.NP.XS,Z,PLAPR,PLAP1,PLAP2,PLAF3,PLAP4,
FLAPS,PLAP63
I mpl ici t Real *8C a-h, o~z3
Real *8 AC NpD , TC 503 , PC 503 , Si gC 1003 , XtC 1003 , DpweC 1003
Common ZReser ZC1,C2,C3
Common ZSplzT,P,Sig,XL,Dpwe
Common ZPontoszN,Ndp,Nx,Nde,Ndx
Common zDeri zGama,Alfa, Auxl2. Auxl3, Auxl 4, Aux2O
Common zPvtzCt, Phi , Vi sc, Po, Pf f, Th, Rw, PI, Cs, Cf, Pk , S, Pe
CALL PDFLUXOC A, Z, NP, CI , CI DK, CI OS, CI PI ,CICF,CIPO3
BkO - S18ACFCXs.IFAIL3
Bkl = SlBADFCXs, IFAIL3
B = BkOZBkl
Zi- l.ZZ
AuxlO = BzXs
Auxl 1 = 1.ZCAC2D + Auxl03
Auxllq = Auxl 1* Auxl 1
Auxl 5 = Pf f*DexpC -TCNx3*Z3
AuxlS = CAC33*Zi3*Auxll - Auxl4*CZ*CI + Auxl 53 + AC63*Auxl3
Auxl 7 = Auxll + Z* Auxl 2
Auxl 71 ~ 1. ZAuxl 7
Auxi7qi = Auxl 7i *Auxl 71
Auxl 8 = 1.- B*B
Auxl 9 = AuxlB/Ca. *ACi:n
DauxlS = C - AC 33 * Auxl 9*Auxl 1 q*Zi 3 ~Z*CCi*Aux2O +• Ci dk* Auxl 43
* -Auxl5*Aux20 - AC 63 * Auxl3Z AC 13
Dauxl? « ~Z*Auxl2ZAC13 - Auxl9*Auxllq
Aux = Auxl2ZAC43
Plapr = Auxl6*Auxl7i
Plapl = C Auxl 7*Dauxl 6 - Auxl 6*Dauxl 73 * Auxl 7qi
Pl ap2 = C Auxl 1 q*C Auxl S-AC 33 *Zi *Auxl 73 ~Z*Ci os* Auxl 4*Auxl 73 *Auxl 7qi
Plap3 = CAuxll*Zi - ZxCipi *Auxl 43 XAuxl 71
Plap4 » Aux*CAuxl7*CZ*CI+Auxl53-Z*Auxl63*Auxl7qi
Pl ap5 = C Aux*&amp;lt;AC 63 - Auxl 5-Z*Ci 3 ~Z*Ci c f «Auxl 43 *Auxl 7i
PlaptS = C Auxl 3-ZwCi po*Auxl 43 *Auxl 71
Return
End
C
SUBROUTINE FLUXOCX1,A,DPWF,DP,NP3
Impl1ci t real*8Ca-h,o~z3
External Coeff,SlSacf,SISadf
Dimension AC Np3 , DpC Np3 , VC 203
Common ZLpl ZV, Ml
Common ZReserZCl,C2, C3
Common ZPontosZN,Ndp,Nx,Nde,Ndx
Common zPvtzCt, Phi , Vi so, Po, Pf f, Th, Rw, PI, Cs, Cf, Pk:, S, Pe
C... ..Calculo da funcao com inversao de laplace..........................
Gama = DsqrtCAC133
Al fa — ClZGama
Aux4 = C2*AC13ZAC53
Al = C3ZX1
IfCMl. Eq.N3Go to 11
CALL C0EFFCN3
11	Sumr = 0.
Sumbl= 0.
SumbS—&amp;lt;3.
Sumb3= Ch
Sumb5= 0.
Sumb6= O.
Do 30 j = 1,N
Z = J * Al
Y = DsqrtCZD
Xs = Y* Alfa
BkO - £18ACFC Xs . I FAT. L3 Bkl = S18ADFCXs»IFAIL3 Zi = l.ZZ
AuxS = BkOZBkl
Auxl = AC 23 + AuxSZXs
Aux2 = Aux4*AC 33*Zi
Aux3 ~ ACxAuxl + AuxS
Aux6 “ 1. -Aux6*Aux5
Aux7 = AuxoZC2. *AC 133
AuxB = ZXAuxl * Aux4 AuxSi= 1.ZAuxS
AuxSqi- Aux8i*Aux8i Pressao = Aux3*Aux8i
30
Der k = C2ZAC 33 *C AC 33 - AC 63 3 *C Auxl - AC 13 *Aux73 *Aux8qi
Der sw - Aux4«C AC 63 - AC 33 3 MAuxSqi
Der pi = Aux4*Zi *Aux8i
Dercf - AuxlZAC 53 *C AC63*Aux4-2*Aux23*Aux8qi
Derpo - Auxl*Aux8i
Sumr = Sumr + Sumbl = Sumbl + Sumb2“ Sumb2+ Sumb3- Sumb3+ SurnbES- Sumb5+ Sumb6“ Sumb6+
VC j3*Pressao
VC J3*Derk
VC j3*Dersw
VCJ3«Derpi
VCJ3 *Dercf
VCJ3 «Derpo
Dpwf = Sumr* Al
WriteC*» «3CX1Z3600. 3 ,Dpwf*14. 7
DpC13= SumblMAl DpC23 = SumbgxAl DpC33= £umb3«Al DpC43as 0.
DpC53= Sumb5*Al DpC63 = Sumb6«Al Pet urn
End
C
SUBROUTINE CINTEGCZ.CI»X.A3
Implicit real*8 Ca-hto-x3 Real«8 XCNx3,ACO:33 CommonZVetor2ZCC 0:103 CommonZGer alZNp, Ns»H
Common ZPontos ZN,Ndp(Nx,Nde &gt;Ndx Tp = XCNP3
Hq = H«H
He = H*H*H
Hoi = 1. ZHc
Zi = l./Z
Zq = Z«Z
Zqi - 1. ZZq
Ze = Zq*Z
Zci - 1. /"Z¡z
Cl = 6. *Zqi*Zqi
Hg = H+Zi
Hgc ~ Hg*Hg*Hq
Hl = CH-ZO
Hie»
Ci = O.
T1 = O
ra = Tp
Dt = TS-T1
Al « Dt~Zi
Alq = Al* Al
Al c = Al q*Al
A2 = He + 3. *H*Zqi - Q*Dt*Zqi + 15. *Zci -3. *A1*C Alq~Al *H-Hql
A3 = Hie + 3. *H*Zqi +■ 19. *Zci
Bl = Dt+Zi
Blq- B1»B1
Ble» Blq*Bl
¡32 ~ He + 3. *H*Zqi - 9. *Dt*Zqi ~ 13. *Zci ~ 3. *B1*C81q-Bl*H-Hql
B3 = Hgc + 3. *H*Zqi - 19,*Zci
El = DexpC-Z*T31
EE — DexpC Z*Dtl *Zi
E3 = DexpC~Z*Tll
E4 = - DexpC ~Z*Dtl*Zi
C21 - El*CE2*CAlc + 3. *Dt*Zqi - 5. *Zcil * CO
Q2 = E1*CE2*A2 -A3*Zil
Q3 = E3*CE4*B2 +B3*Zil
Q4 » E3*C E4*CBle+3. *Dt,*Zqi+5. *Zcil+CO
d = CI + Qi *AC 01+Q2* AC 11+Q3*AC 21+04* AC 31
CI » CI*Hci
Return
End
BLOCK DATA COM
I mpl i ci t Real *8 C a-h.o-zl
Common ZControleZIdLIcont
Data Id,Icont z0,0z
End
pnnnnnnnnnnnnannannnnnnnannannnnnnnnnnnnonannnnai
PROGRAMA AUTO
AUTOR : José oliveira VIDAL CSET/885
OBJETIVO :
Calcular os parâmetros k»S,Pi e Po através do automático em poços não surgentes de um ciclo
METODO UTILIZADO :
Regressão nâo linear de Levemberg-Marquardt
USO :
i5Rodar programa em fortran Ccom co-processador ii5Nome do programa : Auto
iii5Argui vo de dados :
Dados.dat ou outro
ajuste completo
80875
nome sem extensão
NLFF TIME.PWF NLE X.PWS CCM CCA CR
CT
PHI vise
TH RW
PP
FP CW
CDP
DO
Cinclusive em t=05 Cinclusive em t=05
PARÂMETROS DE ENTRADA :
LEITURA DO TESTE
Número de pontos lidos no fluxo
Pares de pontos lidos no fluxo
Número de pontos lidos na estática Csem Dt - 05
Pares de pontos lidos na estática Csem Dt = 05 Constante do registrador Epsig/poll ou EpsigZmml Constante do registrador £ psigl
Constante do relógio CpoiZh] ou Cmmxhl LEITURA PVT E DO POÇO
Compressibilidade total [psig-12
Porosidade [Fração 0-1J Viscosidade Ccpl
Espessura do reservatório ou net pay Im] Raio do poço Cpol = polegadas!
Profundidade vertical do packer [ml Profundidade vertical do Fundo poço Cm] Compressibilidade do fluído produzido Cpsig-ll Capacidade da coluna de teste Cm3zm31
Densidade média do fluido produzido C água -11
PARAMETROS DE SAIDA : k
S
Pi
Po
Cf
Cs
Permeabilidade do reservatório Cdarcy]
skin ou efeito de pelicula [ 3
Pressão estatica do reservatório íatm]
Pressão de abertura ou de fluxo inicial latml Coeficiente de estocagem de fluxo Cfixo5 [atm/cmSl Coeficiente de estocagem estática Cfixo5CatmZcm3]
PROGRAM AUTO
n n n n n n
ESTE PROGRAMA PRINCIPAL ABRE OS ARQUIVOS DE ENTRADA E SAIDA, DEFINE OS VETORES DE TRABALHO E LE ARQUIVO DE DADOS DO FLUXO + ESTATTCA, E CHAMA ÁS ROTINAS AUXILIARES DE OTTMIZACÀO.
ESTA VERSÃO CONSIDERA O CASO DO SKIN POSITIVO EzOU NEGATIVO,
IMPLICIT REALm8CA-H,O~Z2
REALMS TI MEC 502 ,PWFC502,SIGFC 502
REALMS XC 502 , PWSC 502 , SI GEC 500 , XTC1002 , DPWEC1002 , SI GC1002 , VC 202
CHARACTERM30 DADOS
COMMON ZLPLZ V,ML
COMMON ZCESTZVW,CW,RP,GRAD
COMMON zPONTO£ZN,NDP,NX,NDE,NDX
COMMON ZPVTZCT.PHI,VISC,PO,PFF,TH,RW.PI,CS,CF,PR,S,PE
C:::: Parametros para o calculo dos coeficientes de Stehfest :::::::::: ML = 1
N =	20
C:::: Arquivos de entrada e saida de dados I::::;:::::::::::::::::;:::: CALL LIMPA
WRITECM, *CA’2 * ENTRE NOME DO ARQUIVO DE DADOS PRESSÃO E PVT: * READCm, »C BN, A302 ’ 2 DADOS
IFCDADOS. EQ. » ’2DADOS = * DADOS’
OPENCl.FILE = DADOS,STATUS = ’OLD’2
OPENC2,FILE = ’AUTO. DAT’2
C: ; : ; Dados relativos a leitura do fluxo e estatica
READC1,102NLFF
READC1.202TEMPO,PO
NLF » NLFF -1
READCl ,2O2CTTMECI2 ,PWFCI2,1=1 ,NLF2
READCl,102NLE
IFCNLE.EQ. 02 GO TO 5
READCl,202CXCJ2,PWSCJ2,J=1,NLE2
10 FORMATCI22
20 FORMATC2F15. 02
5 READCl,3O2CCM
READCl,302CCA
READCl,302CR
30	FORMATCF15. 02
PO = POMGCM + CCA
DO 15 I = 1, NLF
TIMECI2 = TIMECI2MCR
15 PWFCI2 = PWFCI2MCCM + CCA
DO 25 I = l.NLE
XCI2 - XCI2MCR
25 PWSCI2=PWSCI2mCCM + CCA
NDP = NLF
NDE = NLE
NX = NDP + 1
NDX = NDP + NDE
G
CALL DSTPCTI ME,PWF,X,PWS,XT,DPWE,SIGF,SIGE,SIG2
CL0SEC12
CL0SEC22
CLOSEC33
END
r
SUBROUTINE DSTPCTIME* PWF, X , PWS, XT, DPWE, SIGF, SI GE, SIG3
u u u u
ESTA SUBROTINA PASSA TODOS OS DADOS DE ENTEADA PARA O SISTEMA CGS* . CALCULA OS PARAMETROS INICIÁIS E PASSAZRECEBE DADOS DA OTIMIZACAO .
IMPLICIT REALX8CA-H.O-ZD
EXTERNAL MRQMIN,FUNCSÍPIKSR2 DIMENSION SWC33.CHIC53 DI MENSI ON AC 63 * LI STAC 63 * COVARC 6.63. ALFAC 6 * 63 REALMS TC 603 * PC 503, II MEC NDP3 * PWFCNDP3 * SIGFCNDP3 REALMS XC NDE3,PWSC NDE3 * SIGEC NDE3,DPWECNDX3 * XTC NDX3,SIGC NDX3,VC 203 COMMON ZLPLZ V,ML COMMON ZSPLZT.P
COMMON ZRESERZC1,C2.C3
COMMON ZCESTZVW.CW,RP*GRAD
COMMON ZPONTOSZN*NDP,NX.NDE*NDX
COMMON ZPVTZCT, PHI * VISC,PO* PFF ,TH,RW,PI * CS* CF * PK.S.PE COMMON ZVÁZÁ
SAVE ZVAZ
C; : : Chamam-se todas os dados do fluxo, estática e Pvt CVia CommorD : : CALL DADOSCTIME, PWF.X * PWS, XT, DPWE, SIGF* SIGE* SIG3
C;::: Regressão nao linear nos pontos somente do fluxo IFCNDE.EQ. 03 GO TO 5
C: : : : Estima-se pelo método cartesiano K e Pi como valores iniciais ::: CAP = PlwRPwRP
J = NDX “ S
DT = TCNX3 MC1. ZXTCNDX3-1« zXTC J33
DP - CDPWECNDX3-DPWEC333*14. 7
DC = -DPZDT
DPF- CPWFCNDP3-PWFC133
DH = DPFZGRAD
DV » DHmCAP
DTF= C TI MECNDP3 -TI MEC 133/336400.
QW = DV*6. 29D-06ZDTF
PKC- 2. 151888*QW*VISCZCDC«TH3
FC1 - TCNX3ZXTCNDX3
PEI = DPWECNDX3Ml4.7 + DOFC1
PEI - PEIZ14. 7
C: :: : Inicia-se alguns parametros para o processo de otimizacao ::::::: NP = 6
NCA = 6
ALAMDA = -1.
CHI SQL - 0.
C:;:r Busca unidimensional para definir o valor do skin ::::::::::::::: AC13 = PKC
AC 33 = PEI
AC 43 = CS
AC 53 - CF
AC 63 = PO
SWMAX = 3.
SWMIN - ~5.
DSW ~ SVMAX-SWMIN
NB = 3
M 20 I = l.NB+l
SWCIO ~ SWMIN + DSWmCI-IOZNB
AC23 = SWCÍ3
SUMF = O.
DO 30 KF - l.NDP
CALL FLUXOC TI MEC KF3 »A»DPWF»DP. NP3
RES = PWFCKFD-DPWF
30 SUMF - SUMF + RES*RES
CHICI3 = SUMF
30 WRITEC*,*3 SWCI3(CHICI3
CALL PIKSR2CNB,CHI,SWO
S = SWC13
WRITEC*,*}’VALOR DO SKIN QUASE COIMO = * »S
C:::: Primeira RegressaoCSomente no CluxoD para determinar K,S e Po :::
AC13 = PKC
AC23 = S
AC 33 = PEI
AC 43 = CS
AC 50 = CF
AC 63 - PO
MFIT » 3
LISTÁC10 = 1
LISTAC20 = 2
LISTAC33 = 6
M = 0
ICONTA-O
WRITEC*,«O &gt;VALORES INICIAIS E ITERAÇÕES DE K.S.Pi.CF e PO SAO: » WRITEC*. 4030» CACI3 , 1=1 , NPO
15 CALL MRQMINCTTME, PWF» SIGF» NDP» A, NP» LISTA» MFIT»COVAR, ALFA» NCA, CHISQ *,FUNCS,ALAMDA,ND
WRITEC», 4000, CACI&gt;, 1=1 »NP2) .CHISQ
CALL IMPRESSACM»A.NP.CHISQ3
IFCCCHISQ-CHISQO.GE. O.D THEN
CHISQ1 » CHISQ
ICONTA = ICONTA + 1
IFCICONTA. GT. 5. AND. CCHISQ-CHISQ1'J . LT. 1 . D-033 GO TO 25
GO TO 15
ENDIF
ICONTA = 0
25	IFC DABSCCHISQ-CHISQ13 . L.E. 1.00-010 GO TO 35
CHI SQ1 = CHISQ
GO TO 15
C:::: Segunda RegressaoCSo na estatieaO para determinar K»S e Pi ::::::
35 PK= AC 13
S = AC23
IFCAC63 . LT. 03 THEN
AC 6D = O.
ENDIF
PO= AC63
PC13=PO
CHI SOL - 0.
ALAMDA = -I.
ACÍD = PK
AC25 » S
AC 35 = PEI
AC45 - CS
AC 55 - CF
AC 65 - PO
MFIT = 3
LISTAC15 = 1
LISTAC2D = 2
LISTAC3D = 3
ICONTA = O
M = 1
WRITEC*,*} ’VALORES INIC. E ITERAÇÕES DE K,S,Pi ,CS,CF E PO SAO: ’ WRITEC*.4O51 ,CACID,I«1 ,NPD
43 CALL MRQMINC X tPWS.SIGE,NDE , A, NP, LISTA,MFIT,COVAR,ALFA ,NCA* CHISQ
* „ FUNCS, ALAMDA, MD
WRITEC«,4OD1 ,CACID ,1-1 ,NPD .CHISQ
CALL IMPRESSACM, A.NP.CHISQD
IFCCCHISQ-CHISQ1D . GE. 0. 5 THEN
CHI SOÍ = CHISQ
ICONTA = ICONTA + 1
IFCI CONTA, GT. 3. AND. CCHISQ-CHISQ15 . LT. 1. D-065 GO TO 53
GO TO 43
ENDIF
I CONTA = O
33 IFCCDABSCCCHISQ1-CHISQD/CHISQ1DD.LE. 1.OD-O1D GO TO 65
CHI SQ1 = CHISQ
GO TO 45
Ci : : : Terceira RegressaoíSomente no fluxoD para determinar KtS e Po : : : ©5 PE=AC35
ALAMDA « -1-
CHISd - O,
AC15 = PK
AC 25 = S
AC 3'5 « PE
AC 45 « CS
AC 55 = CF
AC 65 = PO
MFIT = 3
LISTACÍD = 1
LI ST AC 25 = 2
LI ST AC 35 = 6
M = O
ICONTA= 0
WRITECw.O ’Valores iniciais e iterações de K,S,Pi,Cf e Po sao:’ WRITEC*, 4050, C ACID , 1=1 ,NPD
73 CALL MRQMINCTTME, PWF, SIGF, NDP, A, NP,LISTA, MFIT, COVAR, ALFA» NCA, CHISQ *,FUNCS,ALAMDA,MD
WRITEC*. 4050, CACID ,1=1 ,NP5 , CHISQ
CALL IMPRESSACM, A, NP, CHISQD
IFCCCHISQ-CHISQL5 . GE. 0. 5 THEN
CHI sen - CHI se
ICONTA = ICONTA + 1
IFCIC0NTA.GT.5. AND. CCHISQ-CHISQ12.LT. 1.D-O32 GO TO 83
GO TO 75
ENDIF
ICONTA = O
85 IFCCDABSCCHISQ-CHISen22. LE. 1. OD-12 GO TO 95
CHI SOÍ = CHISO
GO TO 75
C: : : : Quarta RegressaoCno f 1uxa+estaticaO para determinar K,S,Pi :::::: 05 PK=AC1D
S -AC22
IFCAC62.LT. 02 THEN
AC62 = O.
ENDIF
PO=AC62
PC12=PO
CHISQ1 = O.
ALAMDA=~1.
AC12 « PK
AC 22 = S
AC 32 = PE
AC42 = CS
AC 52 = CF
AC 62 « PO
MFIT » 3
LISTAC12 = 1
LISTAC22 - 2
LI STAC 32 = 3
WRITEC*,*2 ’VALORES INIC. E ITERAÇÕES DE K,S,Pi.CS,CF E PO SAO: ’ WRITEC*,4022,C ACI2 ,1 =1 ,NP2
4O FORMATCI2.7CD10. 422
ICONTA = O
M S
105 CALL MRQMINCXT.DPWE.SIG.NDX , A, NP.LISTA.MFIT.COVAR. ALFA, NCA.CHISQ x,FUNCS, ALAMDA,M2
WEITEC*,4O2£,CACI2,1=1 , NP2 ,CHISQ
CALL IMPRESSACM»A»NP.CHISa&gt;
IFCCCHISQ-CHISQ12.GE. O. 2 THEN
CHI SOÍ = CHISO
ICONTA = ICONTA + 1
IFCICONTA. GT. 3.AND. CCHISQ~CHISCn2.LT. 1.D-O52 GO TO 115
GO TO 105
ENDIF
ICONTA = O
115 IFCCDABSCCCHISen-CHISQ2zCHÍSQ122.LE.l.OD“22 GO TO 125
chi sen = cHisQ
60 TO 105
C: : : : Calculo e Impressão dos valores finais otimizadas K,S(Po,Pi : : : : : 125 WRITEC2.1352
135 FORMATO 5XVALORES FINAIS DE K S Pi CS CF E PO APOS A OTIMIZACÁO’2 WRITEC2,1452M,CACI2,1=1 ,NP2
145 FORMATCI2,1X,6C2X,D1O. 422
14Q
ALAMDA = O.
SSR = O.
DO 50 I = 1, NDX
CALL FUNCSCI.XTCI1,A.DPWS.DP.NP.20
SSR - SSR + CDPWECIO - DPWSO*CDPWECID - DPWSO
50 WRITEC2.6O3CCXTCI3JZ36OO. 0 .CDPWECIO«14. 70 tCDPWS*14. 70 , *CDPWECI0-DPWS0*14. 7.SIGCIJ
60	FORMATC3X . F10. 3 . 4C 3X , F12. 300
WRÍTEC2.O’VALOR DA FUNCAO OBJETIVO NA ULTIMA I TER AC AO ’ , SSR CALL MRQMINC XT.DPWE, SI G.NDX. A,NP ,LISTA.MFIT,COVAR.ALFA,NCA,CHISQ «, FUNCS. ALAMDA. MO
C: : : : Estudo estatístico dos valores finais dos parâmetros
EMS = SSRZCNDX ~ 30
VARK = DSQRTCEMS*COVARC1.100
STUD = TI N VE RC NDX-30
PKINF- AC10-STUD*VARK
PKSUP- AC10+STUDMVARK
WRITEC2,*0&gt;CPKINF tPKSUP0’.PKINF,PKSUP
VARS = DSQRTCEMS*COVARC2.200
SKINF- AC20-STUD«VARS
SKSUP- AC20+STUD*VARS ’VEITEC2. *0 'CSKINF.SKSUP1 ’ .SKINF.SKSUP VARPI~ DSQRTCEMSmCOVARC3.300
PIINF» AC31-STUD*VARPI
PISUP= AC30+£TUD*VARPI
WRITEC2.X1 ‘CPIINF. PISUP0 ’ ,PIINF, PISUP RETURN
C:::: Final da regressão nos dados completos do Dst ::::::::::::::::::: C:::: Regressão ou analise so do slug teste Cse for o caso) ::::::::::: 5 WRITEC».’CA'0’ ENTRE VALOR PROVÁVEL DA PERMEABILIDADE EMdl READCM, 'CBN.FIO. 30 "0PKC
WRITEC«( *CÁ*0 ’ PRESSÃO ESTÁTICA PROVÁVEL EM £ Psig 1	: &gt;
REÁDC*, ‘CBN.FIO. 30 f0PEI
NP = 6
NCA = 6
ALAMDA = -l.
CHI SOÍ = O.
AC 10 = PKC/lOOO.
ÀC30 = PEI/14.7
AC40 = O.
AC 50 = CF
AC 60 = PO
SWMAX = 5.
■OWKÍT m =	— k:
DSW = SWMAX-SWMIN
NB = 6
DO 70 I = 1 , NB+1
SWCI0 = SWMIN + DSW«CI~10ZNB
AC20 = SWCiO
SUMF = O.
DO 80 KF = 1. NDP
CALL FLUXOC TI MEC KFO .A.DPWF,DP.NPO
RES = PWFCKFO-DPWF
u u u
80 SUMF = SUMF + RESwRES
CHICI3 = SUMF
70 WRITEC*»*3 SWCI3.CHICI3
CALL PIKSRSCNB.CHI ,SW3
s ~ swcn
WRITEC*,*3-VALOR DO SKIN QUASE OTTMO = ’ ,S
Atas ==■ s
MFIT - 3
LISTAC13 = 1
LI STAC S3 = 8
LI STAC 33 = 3
M = 0
IC0NTA=0
WRITEC*,*! ‘VALORES INICIAIS E ITERAÇÕES DE K,S,Pi,CF E PO SAO: ’ WRITEC*, 4030. CACI3,1=1 ,NP3
135 CALL MRQMINC TIME» PWF. SI GF, NDP, A, NP, LISTA, MFTT» COVAR, ALFA» NCA, CHISQ *, FUNCS, ALAMDA, M3
WRITEC*,4O3O,CACI3.1=1 ,NP3 .CHISQ
CALL IMPRESSÀC M, A, NP, CHI SQ3
IFCCCHIEQ-CHISQ13 . GE. 0. 3 THEN
CHI SQL = CHI SQ
ICONTA » ICONTA + 1
X FC I CONTA, GT, 5, AND. C CHI SQ-CHISQ13 . LT. 1. D-l 03 GO TO 166 GO TO 155
ENDIF
ICONTA = 0
165 IFCDABSCCHISQ-CHISQ13 . LE. 1.0D-013 GO TO 173
CHI SQL = CHISQ
GO TO 155
175 WRITEC2.903
SO	FORMATC5X.*VALORES FINAIS DE K S Pi CF E PO APOS A OTIMIZACAO’3
WRITEC2,1003M, C ACI3,1 =1 , NP3
100 FORMATCIS»1X, SC2X,DlO. 433
ALAMDA = O.
SSR = O.
DO 110 1=1, NDX
CALL FUNCSCI, XTC13 , A,DPWS,DP,NP,03
SSR = SSR + CDPWECI3 - DPWS3«CDPWECI3 - DPWS3
110 WRITEC2,1S03CCXTCI33Z3600. 3 ,CDPWECI3*14. 73 ,CDPWS*14. 73 » *C DPWEC13 -DPWS3 *14. 7, SI GC13
120 FORMATC3X, F1O. 3, 4C3X.F12. 333
RETURN
END
Rotina, de impressão dos parâmetros calculadas nas iterações
SUBROUTINE IMPRESSACM» A, NP.CHISQ3
IMPLICIT REALMS CA-H.O-23
REALMS ACNP3
IFCM. EQ. 03 THEN
WRITEC2.103 M.CACI3.I = 1,NP3, CHISQ
RETURN
ENDIF
IFCM. EQ. ID THEN
WRI TEC 2»1ODM, C AC ID,1 =1,NPD.CHISQ RETURN
ENDIF
IFCM. EQ. 2D THEN
WRITEC2.10D M.CACID.I =1,NPD,CHISQ 10 FORMATCI 2,7CIX, E10. ADD
ENDIF
RETURN
END
C
C
c
Transformacao de Ledos os dados de Entrada para unidades Darcy
ZSPL/T.P
ZRESERZCl,C2.C3
ZCEST/VW.CW.RP.GRAD
ZPONTOSZN.NDP&gt;NX,NDE,NDX
ZPVTzCT.PHI,VISC.PO,PFF,TH.RW,PI,CS.CF.PK,S.Pe
SUBROUTINE DADOSCTI ME* PWF, X . PWS, XT, DPWE, SI GF, SI GE. SIGD
IMPLICIT REAL*8CA~H,O-ZD
REAL*8 IT MEC NDPD,PWFCNDPD,SIOFCNDPD,TC 50D,PC 50D
REALES XCNDED , PWSCNDED , SIGECNDED . DPWECNDXD , XTCNDXD ,SIGCNDXD ,VC20D COMMONZLPLZV,ML
COMMON
COMMON
COMMON
COMMON
COMMON
C: : : : Calculo dos parametros auxiliares PI e CPA I:::::::::::::::::::::
PI = 4. «DATANC1.DOD
CPA— Í./14. 7
C: : : : Outros dadosCUnidades Americanas e SI
C: : : ; Ct, CwCPsx-1D ; Th, Pp, FpCmD ; RwC polD ; CdpCm3Zm3D ; DoCD , PhiCdeci malD :::
READCI,10DCT
READC 1.1ODPHI
READC1,1ODVISC
READC 1.1OD TH
READCI,1ODRW
READCI,1ODPP
READCI ,1ODFP
READCI,1ODCW
READCI ,10DCDP
READCI,1ODDO
10 FORMATCF25. OD
C: ::: Transformacaa dados fluido e reservatório para o sistema DARCY :
RP = DSQRTCCDPZPID*100.
GRAD=DO»O.000966307
CF = CPIMRPMRPDZGRAD
CW = CW*14.7
RW = RWx2.54
VW = PI»RW*RW*CFP--PPD*100.
CS = CW*VW
CT = CTM14.7
PO = POMCPA
PE = PWSCNDED mCPA
ppp = PWFCNDPD*CPA
TH = THM00.
C:::: Calculo dos parametros auxiliares C2 e C3
ca = 2. *PI*THzVISC
C3 - DLOGC2.DO3
C: : : : Impressão dos parametros I::::::::::;:::::::::::::::::::::::::::: WRITEC2.ÊO3
£0 FORMATC Z, 25X, ’DADOS DE FLUIDO E ROCHA’,Z,3X,‘COMPRESS. ClZatm3’, *3X, ’POROSIDADE* ,3X, *VISCCcp3 ’ , 4X. ’THCcrrD ’ ,3X, *RWCcm3* ,z3
WRITECE, 403CT, PHI . VISC, TH, RW
40	FORMATC1X,E1O. 3,1ÔX,F8. 3,7X,F6.3,5X,F8.2,3X,FÔ.33
C:::: Transforroacao do Tempo e pressão para unidades Darcy ::::::::::::
TC13	= 0.
PC13	= PO
DO 50 I	» 1,NDP
K	= 1+1
TCK3	= TIMECI3*3600.
IT MECI 3	= TCK3
XTCI3	= TCK3
PCK3	= PWFCI3Z14.7
PWFCI3	= PCK3
SIGCI3	= PffZPCKD
SIGFCI3	= SIGCI3
50	DPWECI3	= PCK3
DO 60 X	~ NX,NDX
IE	» K-NDP
DPWECK3	« PWSCIE3Z14.7
PWSCIE3	= DPWECK3
XTCK3	= XCIE3*3600. + TCNX3
XCIE3	= XTCK3
SIGCK3	= PEZPWSCIE3
60	SIGECIE3	= SIGCK3
RETURN	
END	
SUBROUTINE FUNCSCKF.Xl,A,DPWF,DP,NP,MPER3	
n n n n
Esta rotina calcula os valores de pressão e gradiente de pressão em relacao aos parámetros para os periodos de fluxo eZou estática .
IMPLICIT REALX8C A-H. C’-ZD
REALMS TCSOD.PC503
DI MENSI ON AC NP3 , DPC MP3 , VC 203
EXTERNAL COEFF
COMMON ZLPLZV.ML
COMMON ZSPLZT.P
COMMON zRESERzCl,C2.C3
COMMON ZCONTROLEZID,ICONT
COMMON ZPONTOSZN,NDP,NX,NDE,NDX
COMMON ZDERIZGAMA,ALFA,AUX12.AUX13,AUX14,AUX20,CTE
SAVE ZCONTROLEZ,ZDERIZ
IFCAC13.LT. 03THEN
AC13=DABSCAC133
WRITEC*,*3’Convergencia difícil devido dados de entrada’
ENDIF
IFCMPER. EQ-13 GO TO 7
IFCMPER. EQ. 2. AND. KF. Gt. NDP3 GO TO 7
7
Q
IX
30
IFCKF. LE. NDP. AND. MPER. EQ. 0. OR. MPER. EQ. 23THEN
CALL FLUXOCX1,A.DPWF,DP,NP3
IFC MPER. EQ. 23THEN
ICONT = ICONT + 1
RETURN
ENDIF
IFCMPER. EQ. O. AND. KF. EQ. NDP3THEN
ICONT = O
ID = 0
RETURN
ENDIF
IFCMPER. EQ. O. AND. KF. LT. NDP3THEN
I CONT - I CONT 4- X
RETURN
ENDIF
ENDIF
Al - C3ZX1
IFCML. EQ. N3G0 TO 9
CALL COEFFCN3
IFCID. EQ. 13 GO TO 11
CALL C0NSTCNP,A3
CONTINUE
SUHR = 0.
SUMB1- 0.
SUMB2= 0.
SUMB3= O.
SUMB4= 0.
SUMS5= O.
SUMB6= O.

VCJ3*PLAPR VCJ3MPLAP1 VCJ3XPLAP2 VC J3*PLAP3 VCJ3*PLAP4 VC J3*PLAPS VCJ3«FLAPS
DO 30 J = 1,N
Z = J M Al
Y = DSQRTCZD
XS « Y* ALFA
CALL PDESTATICACAfNP,XS,Z.PLAPR,PLAP1,PLAP2,PLAP3
FLAP4.FLAPS,PLAP83
SUHR =
SUMB1 =
SUMB2=
SUM83-
SUMB4=
SUMB5=
SUMPS-
DPWF =
DPC13 =
DPC23 =
DPC33 =
EPC 43 =
CPC S3 =
DPC63 =
IFCMPER. EQ. 1. AND. I CONT. LT. CNDE-133 THEN
ICONT=ICONT+1
RETURN
ENDIF
SUHR + SUMB1 + SUMB2+ SUMB3+ SUMB4+ SUMBS+ SUMB6+
SUMP* Al SUMB1WA1 SUMB2*A1 SUMB3WA1 SUMB4«A1 SUMB5*A1 SUMB6MA1
1S4
n	non
I FC MPER. EQ. 1. AND. I CONT. EQ. C NDE-12 3 THEN
ICONT=O
ID “ O
RETURN
ENDIF
I FCMPER. EQ. a. AND. ICONT. LT. CNDX-133THEN
I CONT = ICONT + 1
RETURN
ENDIF
IFCMPER. EQ. £. AND. ICONT. EQ. CNDX-iDDTHEN
ID - O
ICONT = O
RETURN
ENDIF
END
C
SUBROUTINE CONSTCNP*AD
C. . . .................................................................
Esta retina calcula os valores de alguns parametros auxiiiares da . estatica que sao usados varias vezes.
IMPLICIT REAL*8CA-H,O-ZD
DIMENSION ACNPD
COMMON ZRESERZCI.C2,C3
COMMON ZDERI/'GAMA,ALFA*AUX12*AUX13 &gt; AUX14,AUX20,CTE
COMMON ZPVTZCT*PHI,VISC*PO*PFF* TH,RW*PI»CS*CF*PK*S,PE SAVE ZDERIZ
GAMA = DSQRTCAC1DD
I FC AC 23 . LT. OD THEN
RWA	=	RW*DEXPC -AC 23D
Cl	=	DSQRTC PHI*VI SC*CT*RWA*RWA3
ELSE
Cl	»	DSQRTCPHIKVISC*CT*RWmRW3
ENDIF
ALFA C1ZGAMA
CTE = l.ZCCS * AC1DD
AUX12 = CAC4DD» CTE
AUX13 = CACSDD* CTE
AUX 14 = AUX13-AUX12
AUX 20 = -AUX14ZAC1D
RETURN
END
SUBROUTINE PDFLUXOCA,ZE*NP*CI *CIDK,CIOS*CIPI ,CICF, CIPOD
Esta retina calcula os valores da integracao sobre o fluxo para a pressao e para os gradientes de pressao.
IMPLICIT REAL*8CA-H*O-Z3
EXTERNAL COEFF * SI8ACF,SI8ADF,QMBS
DI MENSI ON AC NPD * VC 203 , TC 503 , PC 503
REALMS ASCO: 3D *BSCO: 3D ,CSWCO: 3D *DSPCO: 3D * ESCO: 3D .FSCO: 3D
REALMS DKC SOD * DSC SOD * DPIC SOD * DPCFC SOD * DPPOC SOD,A2CSOD
COMMON ZLPLZV.ML
COMMON ZSPL/TQP
COMMON ZRESERZCI„C2,C3
COMMON ZCONTROLEZID,ICONT
COMMON ZPONTOSZN.ND?,NX&gt;NDE,NDX
COMMON ZDERIZGAMA. ALFA. AUX 12»AUX13.AUX14, ALJX20,CTE
COMMON ZPVTZCT,PHI,VISC &gt;PO»PFF &gt; TH &gt; RW,PI.CS,CF,PK,S,PE SAVE ZCONTROLEZ,ZDERI Z,AS,BS.CSW,DSPfES.FS
IFCID. EQ. 13 GO TO 45
AUX4 = C2*AC13ZAC53
PC1D = AC63
DKC13 = O.
DSC13 = 0.
DPIC13 = O.
DPCFC13= O.
DPP0C13= 1.
DO 40 1= 2,NX
À2CI3 = C3ZTCI3
SumbO = O,
SUMB1 =■- a.
SUMB2 = 0.
SUMB3 = 0.
SUMB4 = O.
SUMB5 = O.
DO 30	1,N
Z “ J * A2CI3
Y * DSQRTCZ3
X “ Y * ALFA
BKO - SI 8ACFCX,IFALHA3
BK1 = S1SADFCX,IFALHA3
ZI = l.ZZ
AUXS = BK0ZBK1
IFCAC23.LT. 03 THEN
AUX1 = AUX5ZX
ELSE
AUX1 = AUX3ZX 4- AC 23
ENDIF
AUX2 = AUX4*AC33*ZI
AUX 3 = AC63*AUX1 + AUX2
AUX6 = 1. -AUX5kAUXS
AUX7 = AUX6ZC2. «AC133
AUX8 = Z * AUX1 + AUX 4
AUX8I = 1.ZAUX8
AUX8QI = AUX 81* AUX 81
PRESSA = AUX3*AUX8I
DERK = C C2ZAC 533 *C AC 33 - AC633*CAUX1 - AC 13 * AUX 73 * AUX 8 QI
IFCÀC23.LT. 03 THEN
DERSW = AUX4*AUX6*C.AC63 - AC333*AUX8QI
ELSE
DERSW = AUX4MCAC63 - AC33 3*AUX8QI
ENDIF
DERPI = AUX4KZI *AUX81
DERCF = AUX1ZAC 53 *C AC 63 *AUX4-Z*AUX23*AUX8 QI
ao
40 C
DERPO	= AUX1*AUX8I			
SumbO	-	SumbO	+	VCJD*PRESSA
SUMB1	-	SUMB1	+	VCJD*DERK
SUMB2		SUMBB	+	VCJDmDERSW
SUMB3		SUMB3	+	YCJDxDERPI
SUMB4	—	SUMB4	+	VCJ&gt;*DERCF
SUMB5	=	SUMBS	+	VCJD*DERPO
pen	=	SumbO		A2CID
dkcid		SUMB1		Ascn
osen		SUMBS		A2CID
DPICID		SUMB3	*	A2CID
DPCFCI3	=	SUMB4	*	A2CID
DPPOCID	=	SUMBS	-M	A2CID
43
CALL QMBSCT.P.ASD
CALL QMBSC T, DK, BSD
CALL QMBSCT,DS,CSWD
CALL QMBSCT,DPI , DSPD
CALL QMBSCT.DPCF.ESD
CALL OMBSC T, DPPO. FSD
ID = 1
CALL CINTEGCZE»CI&gt;T.AS&gt;
CALL CI NTEGCZE, CIDK, T» BSD
CALL CI NTEGCZE, CIOS» T»CSWD
CALL CI NTEGCZE. CI PI ,T,DSFD
CALL CI NTEGCZE. CI CF, T, ESD
CALL CINTEGCZE.CIPO.T.FED
RETURN
END
SUBROUTT HE P DE ST ATICACA, NP, XS. Z,FLAPS,PLAP1.FLAPS. PLAP31PLAP4.
x FLAPS»PLAP6D
C............................-........................  -...............
C Esta rotina calcula os valores de pressão estatica e os respect!- , C vos gradientes em relacao aos parametros.
C.......................................................................
IMPLICIT REAL*8CA-H,O-ZD
REAL*© ACNPD, TC30D.PCSOD
COMMON /SPL/T.P
COMMON /RESER/'Cl ,C2.C3
COMMON ZPONTOS/N„NDP,NX»NDE»NDX
COMMON /DERI/GAMA»ALFA,AUX!2,AUX13» AUX14,AUX20,CTE
COMMON /PVT/CT.PHI, VISC. PO, PFF. TH, RW, PI»CS»CF,PK&gt;S,PE
CALL PDFLUXOCA.Z.NP.CI »CI DK, CI OS» CI PI .CICF.CIPOD
BKO = S1BACFCXS»IFALHAD
BK1 = S18ADFCXS. IFALHAD
B - BK0/BK1
ZI = l./Z
AUX10 = B/XS
IFCAC2D.LT. OD THEN
AUX11 = 1./AUX10
ELSE
AUXÍ1 = 1./CAUX10 + AC2DD
1ST
nnnfi
ENDIF
AUX11Q ~ AUX11*AUX11
AUX15 = PFFmDEXPC-TCNX3*Z3
ALFX16 = C AC3D*ZI3xAUXll - AUX14*CZmCI + AUX133 + AC63*AUX13
ÀUX17 = AUX11 + ZMAUX12
AUX17I = 1.ZÂUX17
AUX17QI = AUX17I*AUX17I
AUX18 = 1. ~ B*B
AUX19 = ÀUX18ZC2. *AC13 3
DAUX16 = C-AC33*AUX1Q*AUX11Q*ZI3 -Z*C Cl *AUX20 + CIDK*AUX143
*	-AUX15*AUX20 " ÀC63*AUX13ZAC13
DAUX17 = -Z*fAUX12zAC13 - àUX19*AUX11Q
PLAPR = AUX16*AUX17I
PLAP1 = C AL’X17*DAUX16 - AUX16*DALIX173 *AUX17QI
IFCAC23. LT. 03 THEN
PLAP2 = C AUX11OAUX18MC AUX16-AC33kZI*ALJX173-Z*CIOS*AUX14*AUX173*
*	AUX1 7QI
ELSE
PLAP2 = C AUXllOC AUX16“AC33*ZImAUX17j-Z*CIOS-m-AUX14*AUX173k
M AUX17QI
ENDIF
PLAP3 - CAUX11*ZI ~ Z*CIPI*AUX143*AUX17I
PLAP4 = CTE*C AUX17MCZMCI +AÜX153-Z»AUX163*AUX17QI
PLAP3 = CCTE*C AC63-AUX15-Z*CI3-ZxCICF*AUX143*AUX17I
PLAP6 = C AUX13“ZmCIPOAUX143*AUX17I
RETURN
END
SUBROUTT NE FLUXOC XI«A,DPWF&gt; DP,NP3
Esta rotina calcula os valores da pressão no periodo de fluxo e dos respectivos gradientes com reiacao aos parâmetros.
IMPLICIT REAL»8CA-H.O-Z3
EXTERNAL COEFF,S18ACF,S18ADF
DI MENSI ON AC NP3 , DPC NP3 ,VC 203
COMMON ZLPLZV.ML
COMMON ZRESERZCl»C2»C3
COMMON ZPONTOSZN»NDP»NX»NDE»NDX
COMMON ZPVTZCT.PHI,VISC*PO»PFF»TH»RW,PI»CS,CF,PfC»S.PE
GAMA = DSQRTCAC133
IFC AC 23 . LT. 03 THEN
RWA = RW*DEXPC-AC233
Cl = DSQRTC PHI *VI SC*CT*RWA*PWA'.)
ELSE
Cl = DSQRTCPHI*VISC*CT*RWRW3
ENDIF
ALFA = C1ZGAMA
AUX4 = C2KAC13ZAC33
Al C3ZX1
IFCML. EQ. N3GO TO 11
CALL C0EFFCN3
11	SUMR = O.
30
O.
O.
O.
O.
O.
= 1»N
SUMB1-
SUMB2=
SUMB3-
SUMB5=
SUMB6=
DO 30 J
Z = J * Al
Y = DSQRTCZ3
XS = Y« ALFA
BKO = Sí8ACFCXS.IFALHÂ3
BK1 « SlSADrCXS.IFALHÁD
ZI « l.ZZ
AUX5 BK0ZBK1
IFCAC23. LT. 03 THEN
AUX1 =
ELSE
AUXl «
ENDIF
AUX2 »
AUX3 «
AUX6 =
AUX7 =
AUX8 -
AUX8I =
AUX8QI
PRESSÃO = AUX3«AUX8I
DERK = C2ZAC 53 *C AC 33 -AC 63 3 «C AUXl - AC 13 «AUX73 «AUX8QI
IFCAC23.LT. 03 THEN
DERSW = AUX4*AUX6*C AC 63 -AC 333 «AIJX8QI
AUXSzXS
AUX3ZXS + AC 23
AUX4*AC33«ZI AC.63XAUX1 + AUX2 1. ~AUX3*AUX6 AUX6ZC2. «AC 133 Z*AUX1 + AUX4
1.ZAUX8
; AUX8I«AUX8I
AUX4*C AC 63 ~AC 33 3 *AUX8QI
VC J3«PRESSÃO VCJ3«J3ERK VCJ3*DER£W
VCJ3WDERPI
VCJ3*DERCF .
VCJ3MDERPO
SUBROUTINE CINTEGCZ.CI fXt A3
C. . ,
C Esta rotina executa a integracao dos coeficientes da íuncao B-C splines obtidos por quadrados mínimos.
C...............- -..............-...............................    .	. .
IMPLICIT REAL*8C A-H, O-ZD
E'EAL*8 X€NXD,AC0:33
CommonZGERALZNP fNS,H
COMMON ZPONTOSZN.NDP,NX&gt;NDE,NDX
IP = XCNFO
HQ - H*H
HC = H*H*H
HCI = l.ZHC
zi = i.zz
ZQ = Z*Z
ZQI = l.ZZQ
ZC « ZQ*Z
ZCI - l.zZC
Cl = 6.*ZQI*ZQI
HG = H+ZI
HGC = HG*HG*HG
Hl = CH-ZI3
H1C™ H1*H1*H1
Cl = O.
DO 3 J = 1 »NS-1
TI = TP*C J -13 ZC NS-13
T2 = TP*t IZCNS-im
DT = T2-T1
Al = DT-ZI
A1Q = A1*A1
À1C = A1Q*A1
A2 = HC + 3,*H*ZQI - 9*DT*ZQI + 13. *ZCI -3. *A1*CÂ1Q-A1*H~HQ3 A3 = H1C + 3. *H*ZQI + 19. *ZCI
BI = DT+ZI
BiQ- BI *B1
B1C= BlOBl
BB = HC * 3. «H*ZQI - 9. *DT*ZQI - 15. *ZCI - 3. *81 BIQ-Bl*H-HQ2 B3 « HGC + 3. *H*ZQI - IQ.mZCI
El = DEXPC—Z*T23
ES = DEXPCZ*DTT*ZI
E3 « DEXPC-Z«T12&gt;
E4 = -DEXPC-Z*DTJ *ZI
Q1 = E1*CE2«CA1C + 3. *DT«ZQI - 5. «ZCIií + C12&gt;
QS = E1«CE2mAB -A3MZIJ
03 = E3«CE4«BS +B3*ZID
Q4 = E3*C E4«C BlC+3.*DT»ZQI +5. *ZCII+C11
5 Cl = Cl + Q1*AC J-1'1^Q3*AC .jj+Q3*AC J+Í3+Q4*AC J +2D
Cl = Cl «HCI
RETLÍRN
END
C
BLOCK DATA COM
C................................-......................................
C	Estas variaveis servem para controle do fluxo nos cálculos da
C	pressão e gradientes para o período de estatica.
c.......................................................................
IMPLICIT REALxSCA~H.O-Z3 COMMON ZCONTROLEZlD,ICONT DATA ID.ICONT ZO&gt;OZ END
SUBROUTINE COEFFCN3
C.......................................................................
C	Calculo dos; coef icientes para o algor it mo de Stehfest
C..........................................-............................
IMPLICIT REAL*8CA-H.O~Z3
INTEGER ItMfN,ML»KtKlfK2,NH
DI MENS! ON GC 0-203 &gt; HC103 , VC 203
CommonZLPLzV„ML
IF CML.EQ. N3 GO TO 100
ML = N
GC03 = 1.
GC13 = 1.
NH = NZ2
DO 5 I = 2»N
3	GCI3 = GCI-13 * I
HC13 = a.ZGCNH-13
DO 10 I = 2.NH
FT = I
IF CI.EQ.NHD GO TO 8
HCI3 = FI**NH*GC2*I3ZCGCNH-I3*GCI3*GCI ~133
GO TO 10
8 HCI3 ~ FI**NH*GC2*13ZCGC13*GCI -133
10 CONTINUE
SN = 2*C NH~NHZ2*23-1
DO 50 I ~ 1 »N
VCID = 0.
KI = CI+13Z2
K2 =1
ITCK2.GT. NH3 K2 = NH
DO 40 K = KI.K2
IFC2*K-I. EQ. 03 GO TO 37
I FC I. EQ. JO GO TO 38
VCI3 =\d3 + HC K3 ZC GC I HO *GC2*K~13 3
GO TO 40
37	VCI3 = VCI3 + HCK3ZCGCI-K3.3
GO TO 40
38	VCI3 = VCI3 + HCK3ZGC2*K-I3
40 CONTINUE
VCI3 - SN* VCI3
SN = -SN
50 CONTINUE
100 CONTI NUE
RETURN
END
C	Funcoes de Bessel :::::: r	:
DOUBLE PRECISION FUNCTION S18ACFCX. IFAIL3
C................................................................      ~
c
C	BESSEL FUNCTION .KOCX? FROM NAG LIBRARY
C........................................................................
DOUBLE PRECISION X INTEGER I FAIL
DOUBLE PRECISION SRNAME
DOUBLE PRECISION EGAM, G, T, XBIG, XVSMAL. Y
DOUBLE PRECISION DLOG, DEXP, DSORT
DATA SRNAME Z8H S18ACF Z
DATA XVSMAL,EGAMZ3. 2D-9,3. 77215664Q01532861D~1Z
DATA XBIG Z86.4D0Z
DATA Qi , 02,03. Q4. Q5. •Q6. Q7Z1.25331414D0, -0. 7832358D-1,0. 218Q568D-1 , M-0.1062446D-1,0.587872D-2.-0. 2513400-2,0. 53208D-3Z
IF CX.LE.O.ODO? GO TO 120
IFAIL = 0
IF CX. LT. XBIG? GO TO 20
Y = 2.0ZX
S1SACF » €DEXPC“X^ZDSQRTCXD2«Cai+YMCC^+Y*CQ3+Y*€Q4+¥*CC0+Y*CQ6+Y* *Q7??????
GO TO 140
20 IF CX. GT. 4. ODO? GO TO 100
IF CX. GT. 2. ODO? GO TO 80
IF CX.GT. l.ODO? GO TO GO
IF CX.GT. XVSMAL? GO TO 40
S18ACF = -CDLOGCO. 5D0*X?+EGAM?
GO TO 140
40 T =
G=
AT«&lt;
BT*C
CT*C
Y=
AT*C
BT*C
CT*C
DT*C
S18ACF = GO TO 140
2. ODO*X*X - l.ODO
+1.12896092945412762D+0+TX
+4. 07157485171389048D-3+T*C'
+4.34562671546158210D-7+T*C +7.49110736894134794D-12+T*C +2.618418792586870550-1+T*C
+6.63513979313943827D-3+T*&lt;
+9. 57878493265929443D-7+T*C +1.92405264219706684D-11+T*£
+1.05407718191360000D-1633333333 ■DLOGCX?*G + Y
-*-1.32976966478338191 D~1 +
+5.59702338227915383D-5+
+2.16382411824721532D-9+
+1.9067419751466128OD-143335333
+1,52436921799395196D-1+
+1.09534292632401542D-4+
+5.19906865800665633D-9+
+6.168678869463321600-14+
60 T - 2.ODO*X ~ 3.ODO
¥=	+9.582100S3294896496D-1+T*C
AT *4	+3. 23582010649653009D-2+T*C
BT*C +2. 24709729617770471D-3+T*C C.TX +1.8265246008934278QD-4+T*&amp;lt;DT*C +1.6018597414Q720562D-5+Tx&amp;lt;ET*C +1.47055796078231691D-6+T*C FT*C +1.392172702246141S3D-7+T*C GT*C +1.34790467361340101D-8+T*C HT*C +1.32069362385968867D-9+T*C
IT«C +1.37999268074442719D-1O+T*C
JT*C +9. 74410152270679245D-12+T*C
-1.42477910128828234D-1+
-8.27780330331692662D-3+ -6.32678357460594866D-4+ -5.37101208898441760D-5+ -4.. 83134250336922161D-6+ -4.51017292375200017D~7+ -4.32185089841834127D-8+ -4.20597329258249948D-9+ -4. 33326665618780914D~10+
-3.19241059198852137D-11+
-7.83738609108569293D-12+
KT*C +2. S7466288575820595D-12??????????????????????
S16ACF = DEXPC-Xj»Y
GO TO 140
80 T = X - 3. ODO
10. ODOZC1. ODO + X 3 ~ 1. ODO
.23688664769425422D+0+TxC
-9,25551464765637133D-4+T*C
-6.31692398333746470D~6+T*C
-4,16044811174114579D-8+T*&amp;lt;+1.753393212735806030-10+T*&amp;lt;+3. 495642932665459620-11 +T*F. +2.86481235167705907D-12+T*C +8.06328892562554880D-13+T*C
+4, 43741979886551040D-14^3^^2)33333^35^32 DEXPC-X3 *YZDSQRTCX3
-1.72683652385321641D~2+
“9.02553345187404564D-5+
-7.69177622529272933D-7+
-9.41555321137176073D-9+ -2.22829582288833265D-10+ -1.113917585726476390-11+ -7.31344482663931904D-13+ -1.28108310826991616D-13+
Y= +6.97
AT*C +8. 5
BT*C +1.8
CTxC +1.5
DT*C +1.4
ET*C +1.3:
FTxC +1. S
GTxC +1.2
HT*C +1,2;
IT*C +1.88
JT*C +9.11:
KT»C +2.43
S18ACF - ;
&lt;30 TO 140
100 T =
Y=
AT*C
BT*Z
CT*C
DT*&lt;
ET*C
FT*C
GT*C
HT*C
S18ACF = 1
GO TO 140
120 I FAIL = 1
WRI TEC *, 999993SRNAME»IF Al L
99999 FORMAT ClHO, 38HERR0R DETECTED BY NAG LIBRARY ROUTINE , AS,
x 11H - IFAIL = . I5ZZ3
S18ACF = O. ODO
140 RETURN
END
** END OF S18ACFTEXT
xUPTODATE S18ADFTEXT
DOUBLE PRECISION FUNCTION S18ADFCX, IFAIL3
annn
BESSEL FUNCTION K1CX3 FROM NAG LIBRARY
DOUBLE PRECISION X
INTEGER IFAIL
DOUBLE PRECISION SRNAME
DOUBLE PRECISION G, T. XBIG. XSEST. XSMALL. Y
DOUBLE PRECISION DLOG. DEXP, DSQRT
DATA SRNAME z8H S18ADF Z
DATA XSMALL Z7.9D-10Z
DATA XBIG.XSEST Z86.4DO.3. 9D-39Z
DATA QI . 02,03. Q4,05.06,07Z1.2533141400,0.23498619D0,-0.3655620D-1, xO.1504268D-1,-0.7803530-2,0. 325614D-2.-0. 68245D-3Z
IF CX.LE. O.OD03 GO TO 120
IF CX. LE. XSEST3 GO TO 140
IFAIL = O
IF CX.LT. XBIG3 GO TO 20
Y - 2. OzX
S.18ADF = CDEXPC-XIZDEQRTCXTOMQ1+YMQ2+YMQ3+YMQ4+Y*CQ6+YMQ6+Y*
M27TOTOTO
GO TO ISO
20 IF CX. GT. 4.0D03 GO TO 100
IF CX. GT. 2.0003 GO TO 30
IF CX. GT. 1.0D03 GO TO 60
IF CX. GT. XSMALL3 GO TO 40
S18ADF = I.ODOZX
GO TO 160
40 T - 2.000*X*X - l.ODO
6=	+3.31907865913352762D-1+TM
ATM +6. 716428058734986530-4+TM BTM +4. 327648236429977530-8+TM CTM +5.338882686656589440-13+TM
Y »	+3. 51825828289325S36D-1+TM
ATM +1.20333585658219028D-3+TM BTM +9.966866892737815310-8+TM
CTM +1.40917103024514301 D-l 2+TM
+3.257259681371104950-2+
+6.953002745482062370-6+
+1.797847923801557520-10+
+1.1896496243991O4OOD-15TO TO TOD
+4.50490442966943726D-2+
+1.44612432533006139D-3+
+4.46828628435618679D-10+
+3. 298810580198656000-133 TO TO TO
S18ADF = I.ODOZX + XM DLOGC XD *G~Y3
GO TO 160
60 T = 2.ODO*X - 3.ODO
Y “	+1.24316387355255299D+0+TM	-2. 71 QI0714388689413D-1 +
ATM +8.202502208606938880-2+TM BTM +8. 57388087067410089D-3+TM CTM +9. 34594154387642940D-4+TM DTM +1.029827467000607300-4+TM ETM +1.13930169202553526D-5+TM FTM +1.262635783319419230-6+TM GTM +1.401383319851835O9D-7+TM HTM +1.54456653Õ0S012693D-8+TM ITM +1.82808381381205361D-9+TM JTM +1.280440239499462570-10+TM KTM +4. 274043305687672420-11 +
-2.62545818729427417D-2+ -2.82450787841655931D-3+ -3.10007681013626626D-4+ -3.42424912211942134D-5+ -3.792276988211429080-6+ -4.205071523389349560-7+ -4.6692891Bl68020101D-8+ -5.13783508140332214D-9+ -6.158114168988950860-10+ -4. 02591066627023831D-l1 +
L.TM -1.4663Q29178£948454D“1133333333333333333333333
S18ADF = DEXPC-X3M
GO TO 160
BOTOX - 3.ODO
Y= +8.066634801287869030-1+TM
ATM +4.58591S28414023064D-2+TM
BTM +4. 55865751206724687D-3+TM
CTM +4. 867071747786636520-4 +TM
DTM +3. 28712919123131781D-5+TM
ETM +3. 806923118422967240-6+TM
FTM +6. 403818140373982740-7+TM
GTM +7,087233666965698800-8+TM
HTM +7.79421651144832709D-9+TM
ITM +9, 20781685906110546D-10+TM
JTM +6. 44913423545894175D-11+TM
KTM +2.14736751063133220D-11+
-1.60052611291327173D-1+
-1.423631366844236460-2+
-1.481854720326885230-3+
-1.59994873621599146D-4+
-1,750895943540799440-5+
-1.Q2794586996432593D-6+
-2.129692293463103430-7+
-2.338556184610232650-8+
-2.5Q0393Õ9308009059D-9+ -3.09667392343243062D-10+ -2.02680401514733862D-11+
LTM -7.36478297050421658D-1233333333333333333333333
E18ADF = DEXPC-X3M
GO TO ISO
100 T = 10. ODOZCl. 0D0+X3 ~ 1. ODO
Y =	+1.30387573604230402D+0+T*C
AT*C +4. 3.163S434283445364D-3+T*C BT*C +4. 04720631528493020D-5+TMC CT*C +4,07563856931843484D~7+T«C DT*C +3. 82717692121438315D-9+T*C ET*C +6,9707537911773137QD-Í2+T*C FT*C -3. 60774502020271104D-12+T*C GT*C -2. 19287104441802732D-13+T*C
+3.44845254318331612D-2+
-4.29373370898766831D-4+
+4. 32776409784235211D-6+
+4.86651420008153956D-8+ +6.77688943857588882D-1O+ +1.72026097285930936D-11+ +8.58211523713560576D-13+ +1.39321122940600320D-13+
HT*C -4. 77850238111380160D-143333333333333333
S18ADF = DEXPC-X3*Y/DSQRTCX3
GO TO 160
120 IFAIL = 1
WRI TEC *L999983 SRNAME,IFAIL
99998 FORMAT Cl HO, 38HERROR DETECTED BY NAG LIBRARY ROUTINE &gt; A8, * 11H - IFAIL = , IS/Z3
S18ADF = 0.000
GO TO 160
140 IFAIL = 2
WRITEC *,999983 SRNAME, IF Al L
99997 FORMAT ClHO, 38HERR0R DETECTED BY NAG LIBRARY ROUTINE , A8, * UH - IFAIL = » I5ZZ)
S18ADF = l.ODO/XSEST
160 RETURN
END
END OF S18ADFTEXT
SUBROUTINE MRQMINCX.Y,SIG,NDATA,A,MA,LISTA,MFIT.
m	COVAR,ALPHA,NCA,CHISQ,FUNCS,ALAMDA,MPER3
uuu
Esta rotina executa a regressão nao linear
IMPLICIT REAL*8CA-H.O-ZO
EXTERNAL FUNCS
PARAMETER CMMAX=203
DI MENSI ON XC NDATA3 , YC NDATA3 , SI GC NDATA3 , AC MA3 , LI STAC MAO ,
M COVARCNCA,NCAO,ALPHACNCA,NCA3,ATRYCMMAXO,BETACMMAXO,DACMMAX3 IFCALAMDA. LT. O. 3THEN
KK«MFIT+1
DO 12 J=1 , MA
IHIT=O
DO 11 K=1,MFIT
I FC LI STAC KO . EQ. JO I HI T=I HI T+l
11	CONTINUE
IF CI HIT. EQ. 03 THEN
LISTACKK3 =J
KK=KK+1
ELSE IF CIHIT. GT. 13 THEN
PAUSE ’Improper permutation in LISTA’ ENDIF
12	CONTINUE
IF CKK. NE. CMA-s-103 PAUSE ’Improper permutation in LISTA’ ALAMDA=O. 001
CALL MROÇOFC X » Y(SIG,NDATA,A,MA.LISTA, MFT T»ALPHAtBETA»NCA, CHI SQ»F «UNCS» MPER2?
OCHISQ—CHISQ
DO 13 J-l.MA
ATRYC J2)=AC JD
13	CONTINUE
ENDIF
DO 15 J=1»MFIT
DO 14 K-l»MFIT
COVARCJ,Kl=ALPHACJ.Kl
14	CONTINUE
COVARCJ,JI-ALPHACJ,«C1. +ALAMDA1
DACJ1 =BETACJ?
13 CONTINUE
CALL GAUSSJCCOVAR, MFIT» NCA» DA» 1 »12) IFCALAMDA. EG. O- 1THEN
CALL COVSRTC COVAR»NCA, MA»LI STA, MFI TO
RETURN
ENDIF
DO 16 J=1,MFIT
ATRYC LI ST AC JI 2&gt; -AC LI STAC J1 1 +DAC J1
16	CONTINUE
CALL MRQCOFCX»Y,SIG,NDATA,ATRY»MA»LISTA,MFIT.COVAR,DA,NCA.CHISQ»FU «NCS.MPER1
IFC CHISQ. LT. OCHISQ1THEN
ALAMDA=O. 1*ALANDA
OCHISQ—CHISQ
DO 18 J~1 , MFIT
DO 17 K=1 »MFIT ALPHAC J ,Kl =COVARC J , Kl
17	CONTINUE
BETACJ1 =DÀCJ2?
AC LI STAC J12) =ATRYC LI STAC J2) 2)
18	CONTINUE
ELSE
ALAMDA-10. XALAMDA
CHISQ=OCHISQ
ENDIF
RETURN
END
SUBROUTINE MRQCOFCX, Y,SIG,NDATA»A» MA» LISTA» MFIT, ALPHA,BETA,NALP» «CHI SQ. FUNCS, MPER2)
Esta rotina executa a regressão nao linear
q n o
IMPLICIT REAL«8CA-H,0-ZD
EXTERNAL FUNCS
PARAMETER CMMAX=BO2)
DI MENSI ON XC NDATAl , YC NDATA1 , SI GC NDATA1 » ALPHAC NALP, NALP1 , BETÁC MA1 , « DYDACMMAX1 .LISTACMFIT1 , ACMA1
DO 1£ J=1, MFIT
DO 11 K=1,J
ALPHACJ,Kl =0.
11	CONTIHUE
BETACJJ=O.
12	CONTINUE
CHI£Q=O.
DO 13 I=1&gt;NDATA
CALL FUNCSCIkZCI),A.YMOD.DYDA.MA.MPER)
£1021=1. ZCSIGCI)*£IOCI))
DY=YCI)~YMOD
DO 14 J=1 »MFIT
WT=DYDAC LI STAC J) )*SI G2I
DO 13 K-L.J
ALPHAC J , K3 =ALPHAC J t K) +WT»DYDAC LI STAC IO 3
13	CONTINUE
BETACJ? =BETAC J) +DY*WT
14	CONTINUE
CHISO=CHISQ+DY*DY*SI021
13 CONTINUE
DO 17 J=2.MFIT
DO 13 K=1 ,J-l
ALPHAC KJ) =ALPHAC J , IO
16	CONTINUE
17	CONTINUE
RETURN
END
SUBROUTINE OAUSSJCA,N.NP.B.M,MP)
C.....................................- ................................
C Esta rotina executa a regressão nao linear
C. . .................-...............-.................................
IMPLICIT REAL«8CA-H.O-Z)
PARAMETER CNMAX=50J
DIMENSION ACNP» NP) , BCNP» MP) r IPIVCNMAX) * INDXRCNMAX) , INDXCC NMAX)
DO 11 J-l.N
I PIVCJ)=o
11	CONTINUE
DO 22 I =1 ,H
BI 0=0.
DO 13 J=1,N
“~I FC I PI VC J) . NE. 1) THEN
Fy) 1 p Z—1 N
IF CIPIVCK). EQ. 0) THEN
IF CDABSCACJtK)).GE.BIG)THEN
BI O=DABSC AC J , IO )
IROW=J
ICOL=fC
ENDIF
ELSE IF CIPIVCK) . OT. 1) THEN
PAUSE ’Singular nsatrix’
ENDIF
12	CONTINUE
ENDIF
13	CONTINUE
I PI VC I COL) =1 PI VC I COL) +1
IF CIROW.NE.ICOL) THEN
DO 14 L=1,N
DUM=ACIROW,LD
AC I ROWf LD - AC I COL, LD
AC I COL, LD =DUM
14	CONTINUE
DO IS L=1,M
DUM-BCIROW,LD
BCIROW,LD -BCICOL,LD
BCICOL.LD=DUM
15	CONTINUE
ENDIF
I NDXRC I D=I ROW
I NDXCC I D=I COL
IF C AC I COL, I COLD. EQ. O. D PAUSE ’Singular matrix.’
PI VINV-1, ZAC I COL. I COLD
AC ICOL,ICOLD=1.
DO IS L=1,N
ACI COL, LD =AC I COL, LD *PI VI NV
IS	CONTINUE
DO 17 L-l.M
BCICOL,LD =BCICOL,LD*PIVINV
17	CONTINUE
DO El LL-i,N
IFCLL. NE. I COLD THEN
DUM=ACLL,ICOLD
AC LL, I COLD-0.
DO 18 L=1,N
AC LL,LD =AC LL,LD-ACICOL,LD *DUM
18	CONTINUE
DO 10 L=1.M
BCLL &gt;LD =BCLL,LD-BCICOL,LD *DUM
19	CONTINUE
ENDIF
21	CONTINUE
22	CONTINUE
DO 24 L»N,1,~i
IFCINDXRCLD. NE. INDXCC LDDTHEN
DO 23 K=1,N
DUM=AC K,INDXRC LD D
AC K, I NDXRC LD D =AC K, I NDXCC LD D
AC X, INDXCC LD D =DUM
23	CONTINUE
ENDIF
24	CONTINUE
RETURN
END SUBROUTI NE COVSRTC COVAR,NCVM, MA, LISTA,MFI ID
C. . . .....................-.............-............................
C Esta rotina executa a regressão nao linear
C......................................................................
IMPLICIT REAL*8CA-H.O-ZD
DIMENS!ON COVARCNCVM,NCVMD,LISTAC MFITD
DO 12 J=1 ,MA-1
DO 11 I=J+1 .MA
COVARCI,J3=0.
11	CONTINUE
12	CONTINUE
DO 14 1=1 ,MFTT~1
DO 13 J=I+1 ,MFIT
I FC LI STAC JO . GT. LI STAC 133 THEN
COVARC LISTAC J3 ,LISTAC133=COVARCI,J3
ELSE
COVARC LI STAC 13 , LI STAC J 3 3 =COVARC I»J 3
ENDIF
13	CONTINUE
14	CONTINUE
SWAP=COVARC1,13
DO 15 J=1, MA
COVARC1 , J 3 -COVARC J,J3
COVARCJ, J3=O.
15	CONTINUE
COVARC LI STAC13 , LISTAC133-SWAP
DO 16 J=2,MFIT
COVARC LISTAC J3,LISTAC J3 3 -COVARC1,J3
IS	CONTINUE
DO 18 J=2,MA
DO 17 1=1 , J~1
COVARCI,J3 -COVARC J, 13
17	CONTINUE
18	CONTINUE
RETURN
END
SUBROUTINE QMBSCX.Y.A3
C.......................................................................
C	Esta rotina calcula os coeficientes do B-splines com quadrados
C	mi ni mos
C. ...............................................    -.......-.........
IMPLICIT REALMS CA-H.O-Z3
REALMS XCNX3 , YCNX3 , ACO: 33
COMMONZGERALZNP,NS,H
COMMONZVETOR2ZCCO:103
COMMONZVETOR3ZTC303
COMMONZMATRIZZBCO: 3,0: 33
COMMONZPONTOSZN»NDP.NX,NDE,NDX
NP = NX
NS = 2
H=C XC NP3 ~XC 13 3 ZC NS~13
DO 10 1=0,3
DO 10 J=I,3
CALL SOMACI,J,0,X,Y3
10 CONTINUE
DO 20 I=O,NS+1
S0M=O.
DO 30 J=1,NP
SOM=SOM*YCJ3*BSPCI,XCJ3,X,Y3
30	CONTINUE
CCI3=S0M
ao CONTINUE
IPOS=O
DO 40 IE=1,NS~1
DO 50 I =1 »3
RMULT=BC0.I&gt;ZBCO»05
DO 60 J=I,a
BC I »J3 =BC I »J3-RMuLTxBC0, J3
60	CONTINUE
CCIE+I -15 =CC IE+I -15 -RMULTxCC I E-l 5
50	CONTINUE
DO 70 J=0»3
IPOS=IPOS+1
TCIPOS3 =BCOf J3
70	CONTINUE
IF CIE .NE. NS-13 THEN
DO 60 i=o»a
DO 80 J=I »2
BCI »J3=BCI*1 &gt;J+13
60	CONTINUE
DO 80 1=0» 3
CALL SOMACI . 3, IE.X/Y5
80	CONTINUE
ENDIF
40 CONTINUE
DO 100 K=1»a
DO 100 I=K+1,3
RMULT=BCK»13ZBC K, K3
DO 110 J=I,3
BCI»J5«BCI.J3 ” RMULT x BCK.J3
110	CONTINUE
CCNS+I-23 = CCNS+I-23 ~ RMULTxCCNS+K-23
100 CONTINUE
AC NS+13 =CC NS+15 ZBC 3 (33
ACNS3=CCCNS&gt; -CBC2» 33 *AC NS+13 3 3 z*BC 2,23
ACNS-13=CCCNS-13“CBC1»23 «AC NS3+BC1 »33 «AC NS+13 3 3 ZBC1,13
DO 120 I=CNS~23,O»~1
IPOS=4*I +1
SOM=O,
DO 130 J=l»3
SOM=SOM+TCIPOS+J3*ACI+J3
130	CONTINUE
AC 13 =C CC13-SOM3/TC I PO£3
120 CONTINUE
2ETURN
END
C INICIO DAS SUBROTINAS
SUBROUTTNE SOMACI ,J &gt; IE» X,Y3
C. . .....................................................................
c	Esta rotina calcula as coeficientes do B-splines com quadrados mi-
C	nimos.
C.........................................................................
IMPLICIT REALx-8 CA-H.O2D
n n n o
REALMS XCNP3.YCNP3
COMMON/GERAL/NP, NS, H
COMMON/VET0R2ZCC0: 103
COMMON/VET0R3/TCSCO
COMMON/MATPIZZBC 0:3.0:33
SOM-O.
□0 140 K-1,NP
IF CI, EQ. J3 THEN
AUX=BSPCI+IE»XCK3 »X,Y3
SOM=SOM+AUX*AUX
ELSE SOM=SOM+BSPC I +1E * XC K3»X, Y3 «BSPC J+IE, XC K3 , X t Y3 ENDIF
BCI ,.D-S0M
140 CONTINUE
RETURN
END
C	INICIO DA FUNCAO BSP
REALES FUNCTION BSPCI,Z,X,Y3
Esta retina calcula os coeficientes do B-splines com quadrados mini mos
IMPLICIT REALMS CÂ-H.O-Z3
REALMS XCNP3,YCNP3
COMMON/GERAL/NP,NS,H COMMON/VETOR2/CCO:103 COMMONZVETOR3/TC503
COMMON/MATRIZ/BC0:3,0:33
V-C Z-XC 13 -CI -13 MH3 /H
IF CZ , LT. XC13-H .OR. Z .GT. XCNP3+H3 THEN
BSP-O.
ELSE
IF CI.EQ. NS3 THEN
IF CZ .LT. CXCNP3~a»H33 THEN
BSP=O.
ft
~~ IF CZ .LT. CXCNP3-H33 THEN
BSP=RINTERVC1,V3
ELSE
IF CZ .LT. XCNP33 THEN
BSP=RINTERVC 2,V3
ELSE
BSP=RINTERVC3,V3
ENDIF
ENDIF
ENDIF
ELSE
IF CI .EQ. NS+13 THEN
IF CZ .LT. CXCNP3-H33 THEN
BSP=O.
FI .SR
IF CZ .LT. XCNP33 THEN
BSP=RINTERVC1 , VO
ELSE
BSP-RINTERVC2. VO
ENDIF
ENDIF
ELSE
IF CI . EQ. 05 THEM
IF CZ .GT. CXC13+-HOO THEN
BSP=O.
ELSE
IF CZ .LT. XC103 THEN
BSP-RINTERVC3. VO
ELSE BSF=RINTERVC4fVO
ENDIF
ENDIF
ELSEIF CI .EQ. 13 THEN
IF CZ .GT. CXC10+2*H03 THEN
BSP=O.
ELSE
IF CZ . LT. XC100 THEN BSP^RI NTERVC 2, VO
ELSIE
IF CZ .LT. CXC10+H0D THEN
BSP—RINTERVC 3 r VO
ELSE
BSP=RINTERVC4, VO
ENDIF
ENDIF
ENDIF
IF CCZ.LE.CXC13+CI~33*H3D.OR.CZ.GT.CXC13+CI+13*H333 THEN BSP=O.
ELSE
IF CZ. LE. CXC10 +CI -23KH00 THEN BSP=RINTERVC1 , VO
ELSE
IF CZ. LE. CXCIO-&lt;-CI ~13*H33 THEN
BSP-RIN TER VC 2. VO
ELSE
IF CZ. LE.CXC1O4-IMH00 THEN B£P=RINTERVC 3,VO
ELSE
BSP=RINTERVC4&gt;VO
ENDIF
ENDIF
ENDIF
ENDIF
ENDIF
ENDIF
ENDIF
ENDIF
RETURN
EHD
C	FUNCAO RINTERV
KEALM8 FUNCTION RINTERVCK.VD
C. ......................................................................
C	Esta rotina calcula os coeficientes do B-splines com quadrados
C	nimos.
IMPLICIT REALMS CA-H.O-ZD
IF	CK	.EQ.	13
IF	CK	.EQ.	23
IF	CK	• EQ.	35
IF	CK	■ EQ.	43
RETURN
RI NTERV=C V+2D MC V+2D *C V+23
El NTERV=1 +3*C V+l3 mC1 -V*C V+l 2&gt; 3
RI NTERV=1 +3*C1 -VD MC 1 +V*C 1 -VD 3
RI NTERV=C 2-VD «C 2-VD *C £~V3
END
SUBROUTINE PIKSR2CN,ARR.BRRD
C.......................................................................
C	Esta rotina ordena os valores obtidos na busca unidimensional
C	da funcao objetivo para determinar o valor inicial do Skin.
C................. ..............................................
IMPLICIT REAL*8CA-H.O-ZD
DI MENSI ON ARRC ND , E3RRC ND
DO 12 J=2,N
A=ARRC
B=BRRC J?
DO 11 I =1-1,1 , -I
IFCARRCIO. LE. AO GO TO 10
ARRCI+1D-ARRCID
BRRCI+iJ^BRRCn
11	CONTINUE 1=0
10	ARRCI+13=A BRRCI+1D=B
12	CONTINUE
RETURN
END
REALMS FUNCTION TINVERCNDXD
IMPLICIT REALMS CA-H.O-ZD
REALMS TALFAC90D
DATA TALFA Z12.7062,4.3027,3.1824.2.7764.2.5706,4469,2.3646, m2. 3060,2. 2622,2. 2281 ,2. 2010,2. 1788,2.1604,2.1448,2.1315,2. 1199, *2.1098,2.1009,2.0930,2. 0860,2.0796,2.0739,2.0687,2.0639,2.0595, m2.0555,2.0518.2.0484,2.0452,2.0423,2. 0395,2.0369,2.0345,2.0322, M2.0301,2.0281,2.0262,2.0244,2.0227,2.0211,2.0195,2.0181,2.0167, Mg,0154,2. 0141,2.0129,2. 0117,2. 0106,2.0096,2.0086,2.0076,2.0066, m2.0057,2.0049,2.0040,2. 0032,2.0025,2.0017,2.0010,2.0003,1.9996, Ml.9990,1.9983,1.9977,1.9971,1.9966,1.9960.1.9955,1.9949,1.9944, Ml.9939,1.9935.1.9930,1.9925,1.9921.1.9917,1.9913,1.9908,1.9905, Ml.9901,1.9897,1,9893,1.9890,1.9886,1.9883,1.9879,1.9876,1.9873, Ml.9870,1.9S67Z
UN VER = TALFACNDXD
RETURN
END
SUBROUTINE LI MPA
WRI TEC *,10337,^7
10 F0RMATC1X» Al &gt; ” EH* ( Al &gt; * E
END
Apêndice H - Programa gerador de dados de fluxo ou de um DST completo Cum ciclcD.
— As subrotinas Coeff, S18aef . SIBadf e QMBS est&amp;amp;o no apêndice
6.4.
u u
PROGRAM GERADOR
..Este programa gera dados de pressão de fluxo e pressão estatica ..Para o caso de Skin positivo e do Skin negativo.
IMPLICIT REALX8CA~H,0-23
II MEC 1003
XC1003 . XTC 2003 ,VC 203
ZLPLZ V.ML
ZCESTZVW,CW»RF,GRAD
ZPONTOSZN ,NDP,NX.NDE,NDX
ZPVTzCT.PHI.VISC .PO,PFF,TH.RW rPI, CS,CF.PK,S,PE
C:
REALES
REALMS
COMMON
COMMON
COMMON
COMMON
Parametros para o calculo dos coeficientes de Stehfest ML - 1
N =	20
C:::::Dados relativos a leitura do fluxo e estatiea:::::::::
OPENCI,FILE = ’TEMPOS. DAT’3
0PENC2.FILE = ’GERADOR. DAT’3
0PENC3.FILE ’PVT. DAT’3
0PENC4.FILE = ’GERA. DAT’3
READCI,23NLF
READCI ,43CTTMECI3.1=1 ,NLF3
READCI.23NLE
READCI.43CXCJ3,J=1,NLE3
FORMATCI23
FORMATCF1O. 03
NDP = NLF
NDE = NLE
NX = NDP + 1
NDX ~ NDP + Nde
2
4
C
C
SUBROUTINE DSTPC TI ME * X, XT3
IMPLICIT REALM8CA~H,0-23
EXTERNAL FUNCS, Si 8 ACF, SI 8ADF,MQBS REALES REAL*» COMMON COMMON COMMON COMMON COMMON
TC 1003 , PC 1003 , TI MEC NDP3 . AC 63
XCNDE3 t XTC NDX3 ,VC203
ZLPLZ V.ML
ZSPLZT.P
ZRESERZCl.C2.C3
ZCESTZVW,CW.PP , GR A D
ZPONTOSZN&gt;NDP,NX tNDE.NDX
COMMON ZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE COMMON ZPARZA
DADOSCTTME,X,XT3
6
= AC 13 ZC PHIMVISCMCTMRWMRW3
1. ZC2. MPIMPHIMTHMCTMRWMRW3 = AC33 - AC63
ÀC43MCTE2
AC53MCTE3
= TCNX3MCTE1
17
19
160
161
TD *.4X /
TCH3 ’ ,4X, ’
PD '3
PC PSI&amp;lt;53
C: : ; ::Chamam~se Lodes os dados do fluxo, estatica e Pvt CVia Common3 : : : CALL NP = CTE1 CTE2 CTE3 CSD &gt; CFD &amp;lt;TPD
WRITEC2,173
FORMATCIOX,’ CSD ’,10X,’ CFD ’,1OX,*
WRITEC 2,193 CSD,CFD,TPD
FORMATC7X, Fl0. 3,6X, E15. 3, IX , E1S. 33
WRI TECS, 1603
FORMATCZ,21X&gt;’
WRI TEC4,1613
FORMATCZ, 21X , ’
DO 35 I = 1, NDX
CALL FUNCSCI,XLCI3,A,DPWS,NP,23
TD = XTCI3MCTE1
PD = CAC33-DPWS3ZCTE3
W£ITEC2,113 TD,PD
IFCI. EQ. 13LHEN
WRITEC4,m3 ’
ENDIF
IFCI.EQ. NX3 THEN
WRI TEC 4, m3 ’
ENDIF
IFCI. GT. NDP3THEN
WRITEC4,113CCXTCI33Z36OO. 3 . DPWS*14. 7
ELSE
WRITEC4,113CXTCI3Z36OO. 3 ,DPWS*14. 7
ENDIF
CONTINUE
FORMATC15X. 2F13. 43
RETURN
END
C:::::Transformacao de todos os dados de Entrada
SUBROUTINE DADOSCTTME, X ,XT3
IMPLICIT REALmSCA~H,0-Z3
REALMS TTMEC NDP3 , TC1003 , PC 1003 , AC 63
REALMS XCNDE3 , XTCNDX3 , VC203
COMMONZPARZ A
COMMONzLPLzV,ML
COMMON
COMMON
COMMON
COMMON
COMMON
C:::::Calculo dos parametros auxiliares PI e CPA
PI = 4. mDATANC1. DO3
DADOS
DADOS
DO
DA
TPD *3
FLUXO’
ESTATICA ’
para unidades Darcy: : :
ZSPLZT,P
ZRESERZCI,C2,C3
ZCESTZVW,CW,RP,GRAD
/PONTOSZN,NDP , NX tNDE , NDX
ZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS.CF,PK*S.PE
CPA= 1. Z14. 7
C: ; : : : Outras dadosCUnidades Americanas e S::	:
C: : : : : Ct» CwC Psi -13 ; Th, Pp t FpCrrO ; RwC pal 3 ; CdpC m3Zm33 ; DoC 3 , Phi C deal mal D : : : : : : C: : : : : Po,PeCPsÍg3:	: : : : : : : : :::::::::::::: : :::::::: : : : : : : : : ;
READC3t63CT
READC3&gt;63PHI
RE ADC 3163 VI SC
READC3,63TH
READC3.63RW
READC3.63PP
READC3.63FP
READC3.63CW
READC 3.63 CDP
READC3.63DO
READC3.63PK
READC3&gt;63S
READC3.63PO
READC3.63PE
a FORMATCF25.03
C: : : : : Transformacao dados fluido e reservatório para o sistema DARCY: : :
RP = DSC32TCCDPZPI3MÍOO.
GRAD=DO«O. 000966397
AC 33 = CPI*RP*RP3ZGRAD
CW = CW*14.7
RW = RW*2. 54
W = PI«RW*RWmCFF-PP3*100.
AC 43 = CW*VW
CT = CTM4.7
PO = P0*CPA
PE = PE*CPA
TH = THMOO.
AC13-PK
AC S3=S
AC33=FE
AC 63 =PO
C: : : : : Calculo dos parametros auxiliares Cl ,C2 e C3:
CE = a. *PlwTH/VISC
C3 = DL.O0C2. D03
C: : : : :Impressão dos parametros: ::::::::::: : :::::::: ::::::::::::: : : :::::: :
WRITEC2.1203
120 FORMATCZt2SXDADOS FIXADOS ’ . Z&gt; 3X * ’ CTC1ZATM3 ’ , 2X, ’ COC1ZÀTM3 ’ t
«3X»‘POROSIDADE’ &gt;3X( 'VISCCCP3 ’ ,3Xh ‘THCCM3 » »5X» ‘RWCCM3‘3
WRITEC 2.1403 CT.CW .PHI,VISC,TH.RW
140 FORMATCIX,E10.3t4XtE8.3.3X.F8,3,6X&gt;F6.3.3X,F8.2,3X»F8.3,Z3
WRI TEC 2 * 1503
150	FORMATC25X,’DADOS DO RESERVATÓRIO *3
WRI TEC2,1353
155 F0RMATC10X, ’ PERM. CDARCY3 ‘ ,13X» ’SKIN’ ,10X. ‘P. ESTATICAC ÀTM3 ’ 3
WRITEC2,1583 AC 13 &gt;AC23 , AC 33
WRI TEC2t 1573
157	FORMATC11X»‘CS CCM3ZATM3’&gt;9X,‘CF CCM3ZATM3’„8X.’POCATM3’3
WRI TEC 2,1583 AC 43 »AC53 , AC 63
158	FORMATC7X, FIO. 3,14Xf FIO. 3,6X, FIO. 3, Z3
C: : :
10
17
C: : : :
8
11
30
C
WRITEC4.1205
WRI TEC 4.1405 CT. CW, PHI, VI EC, TH»RW
WRITEC4,1SO5
WRITEC4*1555
WRITEC4&gt;1585AC15 &gt;AC25 , AC35
WRI TEC 4,1575
WRITEC 4.1385 AC 45 ( AC 55 , AC 65
: Transformaeao do Tempo e pressao para unidades Darcy::::::::::::::: TC15 = 0.
PC15 = Po
DO 10 I =1,NDP
K =1+1
TCK5 = TIMECI5*3600.
XTCI5 = TCK5
DO 17 K = NX»NDX
IE = K-NDP
XTCK5 =	XCIE5*3600. + TCNX5
RETURN
END
SUBROUTINE FUNCSCKF,XI&gt;A»DrWF,NP,MPER5
Implicit real*8Ca-h,o~z5
Real*8 TC 505 »PC 505
Di mens! on AC NpD * VC 205
External Coeff
Common zLplZV,Ml
Common ZSpl ZT.P
Common ZReserZCltC2*C3
Common zControleZld.Icont
Common ZPbntosZN,Ndp,Nx,Nde»Ndx
Common ZDer1/Gama.Alfa»Auxl2.Auxl3 * Auxl4 * Aux2O
Save zControleZ,/DeriZ
:Calculo da funcao com inversao de laplaee::::::::::::::::::::::::::
IfCKf. LE. NdpDThen
CALL FLUXOCKf tXl . A.DPWLNPD
Return
Endif
Al = C3ZX1
IfCMl. Eq. N3Go to 9
CALL COEFFCN5
IfCId.Eq. 15 Go to 11
CALL CONSTCNP,A5
Conti nue
Sumr = 0.
Do 30 J = 1.N
Z = J * Al
Y = DsqrtCZl
Xs = Y* Alfa
CALL PDESTATICACA,NP,XS&gt;ZiPLAP5
Sumr ~ Sumr + VCJ5*Plap
Dpwf = Sumr* Al
WriteC*t*5CXlZ3600, 5 ,Dpwf*14. 7
IfCKf. Eq. Ndx5Then
Id = 0
Icant = O
Return
Endif
End
SUBROUTINE CONSTCNP.AD
Implicit Real*® Ca-h.o-z)
Dimension ACNpD
Common zReserZC1.C2.C3
Common ZDer i ZGama. Al f a,Auxl2,Auxl3,Auxl4,Aux20
Common ZPvtZCt.Phi,Visc.Po.Pff,Th,Rw,PI ,0s,Of.Pk,S,Pe Save ZDeriZ
Gama = DsqrtCAClDD
IfCACSD. Lt. OD Then
Rwa	= Rw*DexpC-AC 23'J
Cl	= DsqrtCPhi*Visc*CtMRwaKRwaD
Else
01	= DsqrtCPhi*Visc*Ct*RwMRwD
Endif
Alfa ~ ClzGama
Cte = 1.ZCC2 * AC1DD
Auxl 2 « CAC4DD* Cte
Auxl 3 - C AC 5D 3* Cte
Auxl4 = Auxl3-Auxl2
AuxSO = ~ Auxl 4ZAC13
Return
End
SUBROUTINE PDFLUXOCZE. CID
Implicit real*8Ca~h.o~zD
External Q mbs, Cinteg
Dimension FC503 , PC503 , AsCO: 103
Common ZSplZT,P
Common ZControleZld.Icont
Save /Controle/, As
IfCId. Eq. ID Go to 45
CALL QM8SCT.P.ASD
Id = 1
45 CALL CI NTEGC ZE. CI . T, ASD
Return
End
SUBROUTINE PDESTATICAC A. NP. XS.Z.PLAPRD
Implicit Real*8Ca-h. o-zD
Real *8 AC NpD , TC SOD , PC 50D
Common ZSplzT,P
Common /ReserZC1.C2.C3
Common ZPontoaZN.Ndp&gt;Nx,Nde,Ndx
Common ZDeri ZGama.Alfa.Auxl2,Auxl3.Auxl4» Aux20
Common ZPvtZCt.Phi„Vi sc.Po.Pff. Th» Rw»PI,Cs,Cf.Pk.S,Pe
CALL PDFLUXiXZ.Cn
BkO = SIBACFCXs.IFAILD
Bkl = SIBADFCXs . IFAILD
B = BkOzBkl
Zí = l.zZ
AuxlQ = BzXs
IfCÀC23. Lt. 03 Then
Àuxll = l.ZAuxiO
Else
Àuxll = l.ZCAuxlO + AC233
Endif
AuxlS = Pf f*DexpC -TC Nx3*Z3
ÂUX16 = C AC 33 *ZÍ 3 *Áuxl 1 - Auxl4*CZ*CI + Auxl53 + AC63*Auxl3
Auxl7 = Àuxll + ZxAuxlS
Auxl 71 = 1, ZAuxl 7
Flapr = Auxl6*Auxl71
Return
End
C
SUBROUTINE FLUXOCKf *X1 , A*DPWF,NP3
I mpl i cít real *8C a~h » o~z3
Externai Coeff *S18acf ,S18adf
Dl mens!on AC Np3 s VC £03
EM mens!on TC 503,PC 503
Common zSplzT*P
Common zLplzV*Ml
Common ZReserZCl,C2.C3
Common ZPontosZN,Ndp,Nx*Nde *Ndx
Common ZPvtzCt,Phi,Vise*Po* Pff,Th*RwtPI,Cs,Cf *Pk,S,Pe
C.....Calculo da funcao com inversão de laplaee............................
Gama = DsqrtCAC133
XfCAC23 . Lt. 03 Then
Rwa ■= Rw*DexpC “AC233
Cl = DsqrtCPhi «VI sc*Ct*Rwa»Rwa3
Else
Cl = DsqrtCPhi «Vi sc*Ct*fRw*Rw3
End! f
Alfa = ClzGama
Aux4 = C£*AC1 JZAC53
Al = C3ZX1
IfCMl. Eq.N3Go to 11
CALL C0EFFCN3
11	Conti nue
Sumr = 0.
Do 30 j = 1 * N
Z = J * Al
Y = DsqrtCZ3
Xs = Y* Alfa
BkO = SlBACFCXs * IFAIL3
Bkl = SlBADFCXs * XFAIL3
Zi = 1.ZZ
Aux5 = Bk OZBk1
IfCÀC23 . Lt. 03 Then
Auxl = AuxSzXs
El se
Auxl ~ AuxSzXs + AC 23
30
C
c
Endif
AuxB = Aux4*AC33*Zi
Aux3 - AC63*Auxl + Aux2
Aux6 = 1.-Aux5*Aux5
Aux7 = AuxÔZCS. *AC133
Aux8 = Z*Auxl +■ Aux4
AuxBi = 1. ZAuxB
Aux8qi= AuxÕi*Aux8i
Pressa = Aux3*Aux8i
Sumr = Sumr + VCJ3*Pressa
Dpwf = Sumr* Al
K = Kf + 1
PC 50 = Dpwf
IfCKf.Eq.Ndp3 Then
Pff = Dpwf
Endif
Wr i teC *, *3 C XIZ3600. 3 fPCk3*14. 7
Return
End
SUBROUTINE CINTEGCZ,CI , X. A3
Implicit real*8 Ca“h,O"z3
RealMB XCNx3 , ACO: 103
CommonZVetor2/CC0:103
Common/'Ger alZNp * Ns. H
Common ZPontosZN,Ndp f Nx,Nde„Ndx
Tp = XCNP3
Hq = H*H
He = H*H*H
Hci ~ 1./He
Zi = l.ZZ
Zq = 2&gt;Z
Zqi = l./Zq
Ze = Zq*Z
Zci = l.ZZc
Ci = 6,*Zqi*Zqi
Hg = H+Zi
Hge = Hg*Hg*Hg
Hl = CH-ZÍ3
Hle= H1*H1*H1
Ci = O.
Tl = O
IB = Tp
Dt = T2-T1
Al = Dt-Zi
Aiq = Al*Al
Al c -Al q*Al
A3 = He + 3. *H*Zqi ~ 9*Dt*Zqi + 15. *Zci -3. *A1 *C Alq-Ai
A3 = Hie + 3. *H*Zqi + 19. xZci
Bi = Dt+Zi
Blq= Bl «81
Blc = Biq*Bl
B2 = He + 3.*H*Zqi - 9. *Dt*Zqi - 15. *Zei - 3. *Bl*CBlq“Bl*H-Hq3
1 Bl
B3 = Hgc + 3.*H*Zqi ~ 19. *Zci
El = DexpC-ZWT2?
E2 = DexpCZ*DO*Zi
E3 = DexpC-Z*Tl?
E4 = ~DexpC-Z*DtO*Zi
QI = El*CE2»CAle + 3. *Dt*Zqi - 5. *Zei? + Cl?
02 - £1*CE2*A2 ~A3*Zi?
03 = E3*CE4*B2 +B3MZ13
04 E3*CE4*CBle+3. *eDt*Zqi+S. MZci?+Cl?
CI = CI + QI *AC 0? +Q2»AC 1 ? +Q3*AC 2? +Q4*AC 3?
CI = ClwHci
Return
End
BLOCK DATA COM
Implicit Reales ia-h,o-z)
Common zControlezId,leont
Data I d (Icont ZO,Oz
End
Apêndice I - Otimização em um ciclo completo de um DST para calcular k, S, p e p. através de diferenças finitas.
O	t
- As entradas de dados de campo para análise neste programa é idêntica ao programa Auto do apêndice 0.4 cujo exemplo é;
41	numero de pontos do fluxo
.0000,86
. 005,106. 86783
tempo e pressão lidos
.470,574.68563
. 500,588. 88144
66	numero de pontos da estatica
.005,687. 64880
tempo e pressão lidos
8. 140,877.30984	
3, 189,877.59765 1.	M ~ const, calib. em psigZpol,
0.	A ~ const, calib. em psig.
1.	k = const, do relogio em hZpol
IO. 2D—06	Ct= compress, total em lZpsig
0. 063	Phi = porosidade O
60.	Vise = viscosidade em cp
11.5834	Th =■ espessura em m
4.348	Rw = rsíLa do poco em pai.
810. 39	pp = prof, packer em m.
822. 61	FP - prof, poco em m.
6. 0E-06	Cw = compres, fluido em lZpsig
0.007417323	Cdp = capacidade do tubo m3Zm3
0. 90042954	Do « densidade fluido Cagua=l
PROGRAM FINITA

ESTE PROGRAMA PRINCIPAL ABRE 0S ARQUIVOS DE ENTRADA E SAIDA, DEFINE.
C OS VETORES DE TRABALHO E LE ARQUIVO DE DADOS DO FLUXO + ESTATICA, . C E CHAMA AS ROTINAS AUXILIARES DE OTTMIZACAO.
C ESTA VERSÃO CONSIDERA O CASO DO SKIN POSITIVO E/OU NEGATIVO.
C.......................................................................
IMPLICIT REALm8CA~H,O-Z&gt;
REÀL*8 TI MEC 1003 ,PWFC1003
R’EAL*8 XC1003 , PWSC1003 , XTC £003 . DPWEC 2003
CHARACTER**3Õ DADOS
COMMON /CESTzVW,CW,RP,GRAD
COMMON ZPONTOSZN,NDP,NX,NDE.NDX
COMMON ZPVTZCT,PHI, VTSC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE
C: : : : Arquivos de entrada e saída de dados
CALL LIMPA
WRITEC*, *CA’3 * ENTRE NOME DO ARQUIVO DE DADOS PRESSÃO E PVT: ‘ READC *,’ C BN,A303’3DADOS
IFCDADOS.EQ. * ’3DADOS = ’DADOS*
OPENCl.FILE = DADOS,STATUS = ’OLD‘3 OPENC2,FILE = ’ GERADO. DAT’3
OPENC3.FILE = ’FINITA. DAT’3
C; : : : Dados relativos a leitura do fluxo e estatica
READC 1,103NLFF
READC1,203 TEMPO,PO
NLF = NLFF -1
READC1,203CTIMECI3 , PWFCI3,1=1 , NLF3
READC1,103NLE
IFCNLE. EQ. 03 GO TO 3
READC1,2O3CXCJ3,PWSCJ3,J=1,NLE3
10 FORMATCI23
20	F0RMATC2F15. 03
3	READC1 ,303 CCM
READC1,303CGA
READC1,303CR
30 F0RMATCF15. 03
PO = POMCCM + CCA
DO 15 I = 1,NLF
TIMECI3 = TI MEC II «CR
15 PWFCI3 = PWFCI3«CCM + CCA
DO 25 I = 1 ,NLE
XCI3 = XCI3MCR
25	PWSCI3-PWSCI 3«CCM + CCA
NDP = NLF
NDE = NLE
NX = NDP + 1
NDX = NDP + NDE
C
CALL DSTPCTIME,PWF,X.PWS,XT,DPWE3
CLOSEC13
CLOSEC23
CLOSEC33
END
C
SUBROUTINE DSTPCU ME, PWF, X, PWS, XT, DPWE3
U'JUU
ESTÁ SUBROTTNA PASSA TODOS OS DADOS DE ENTRADA PARA O SISTEMA CGS. CALCULA OS PARAMETROS INICIAIS A SER USADO DURANTE A OTIMIZACAO
IMPLICIT REAL*8C A-H. O-ZD
EXTERNAL PIKSR2
DIMENSION SWC 503, CHIC 603
DIMENSION AC63
REALMS TC1Õ03 , PC 1003 . IT MEC1003 ,PWFC 1003 , VC 203
REALES X C1003,PWSC1003.DPWEC2003,XTC 2003
REAL FC£003 »XJACC£00,43,X JTJC103,WORKC5123,EPS,DELTA,SSQ,XIC63
COMMON ZSPLzT.P
COMMON ZLPLZV.ML
COMMON ZRESERZCI.C2,C3
COMMON ZFATORZFATORK,FATORP
COMMON ZCESTZVW.CW.RP.GRAD
COMMON ZPONTOSZN,NDP,NX,NDE.NDX
COMMON ZPVTZCT.PHI, VISC, PO, PFF. TH. RW, PI,CS.CF,PK,S,PE
COMMON ZVAZA
SAVE ZVAZ
C:::: Chamam-se todos os dados do fluxo, estatica e Pvt CVia Common3 : :
CALL DADOSCTIME, PWF, X. PWS, XT, DPWE3
C: : : : Estima-se pelo método cartesiano K e Pi como valores iniciais : : : CAP = PIMRPMRP
J - NDX ~ 5
DT = TCNX3MC1. ZXTCNDX3-1. ZXTCJ33
DP « CDPWECNDX3-DPWECJ33M14.7
DC = -DPZDT
DPF= CPWFCNDP3-PWFC133
DH = DPFZGRAD
DV » DHMCAP
DTF= CTIMECNDP3“TIMEC133ZS6400.
GW = DVM6. 29D-O6ZDTF
PKC= 2.151888*QW*VISCzC DCMTH3
FC1 ~ TCNX3ZXTCNDX3
PEI = DPWECNDX3*1 4. 7 + DCmFCI
PEI = PEIZ14.7
WRI TEC M, M3 PKC, PEI
C: ::: Busea unidimens!onal para definir o valor do skin :::::::::::::::
AC13 = PKC
AC 33 = PEI
AC 43 « CS
AC 53 = CF
AC 63 = PO
SWMAX = 5.
SWMIN = "5.
DSW = SWMAX-SWMIN
MB = 50
DO 20 I = 1.NB+1
SWCI3 = SWMIN + DSWMCI-13ZNB
AC23 = SWCI3
SUMF = 0.
DO 30 KF = 1,NDP
CALL FLUX OC ITMEC KFD.A.DP WF „NPD
RES = PWFCKFD-DPWF
30 SUMP = SUMF + RES*RES
20 CHICID = SUMF
CALL PIKSR2CNB.CHI . SWD
S = SWC1D
WRITEC*t*D &gt; VALOR DO SKIN QUASE OTIMO = f,S
C: : : : Priineira RegressaoCSomente no fluxoD para determinar K,S e Po : : ACID = PKC
AC2D = S
AC 3D = PEI
ACAD = CS
AC3D - CF
AC6D = PO
NP = 3
X1C1D = SNGLC ACID *1000. D
IfCXiClD. LT. C1000.D. AND. X1C1D. GT. C100.DD THEN
FATORK =100.
ELSE
FATORK = 1000.
ENDIF
IFCX1C1D. LT. C100. DD THEN
FATORK =10.
ENDIF
X1C2D = SNGLCAC2DD
X1C3D = SNGLC AC 3D *14. 71
IFCX1C3D . LT. CIOOO. D . AND. X1C3D . GT. C100. DD THEN
FATORP = 1OO.
ELSE
FATORP = 1000.
ENDIF
IFCX1C3D . LT. C100. DD THEN
FATORP = 10.
ENDIF
X1C4D = SNGLCAC4D*4. 279D-07D
X1CSD = SNGLCAC ED *4.279D-07D
XICOD = SNGLCACSD*14. 7D
N1 = CNP + lD*NP/2
N2 = 5*NP + 2*NDX +N1
CALL FINITACXT.DPWE.XI,F,XJAC.XJTJ.NP,N1,N2.WORKD
RETURN
END
SUBROUTINE FI NITAC XT. DPWE. XI . F. X J AC, X JTJ ,NP.Nl. NS. WORKD
IMPLICIT REAL*8CA-H,O~ZD
EXTERNAL FUNC.SLUG
REAL PARAMC4D .XICOD .FCNDXD ,XJACCNDX.NPD , XJTJCN1D , W0RKCN2D . XPC2D , *XPPC3D
REAL*8 DPWECNDXD,XTCNDXD
COMMON zFATORZFATORK,FATORP
COMMON zLIDAZ TTC200D.PWEC200D
COMMON ZPONTOSZN,NDP,NX,NDE,NDX
COMMON /PVTZCT.PHI, VISC.PO.PFF.TH.RW.PI,CS.CF.PK,S.PE
COMMON ZPVTl/CTl . PHI1, VISC1, PO1 , TH1, RW1 &gt; CS1, CF1,PI1 TTC1D = O.
PWEC1D = PO*14. 7
DO S I = 1,NDX
TTCI-HD = XTCIDZ3600.
5 PWECI+1D = DPWECIDM4.7
M - NDP
np = a
IXJAC NDP
NSIG = 3
EPS = O.OO1
DELTA = 0.0001
MAXFN = 300
I0PT = 1
CS1 = X1C4D
CF1 = X1C5D
P01 = XI COD
PHI1 =-- PHI
VISC1 = vise
CT1 - CT/14.7
TH1 =• TH/30. 48
RW1 = RW/30.48
XPC1D = X1C1DZFATORK
XPC2D » X1C2D
PI1 = X1C3D
CALL ZXSSQCSLOG.M.NP.NSIG.EPS»DELTA.MAXFN,IOPT.PARAM,XP.SSQ.F, MXJAC,IXJAC.X JTJ,WORK,INFER,IERD
XPC1D = XPC1D*FATORK
XPC2D = XPC2D
WRITEC3,6ODCI ,XPCID ,I = 1.2D
60 F0RMATC5X,’VALOR OTIMO = ’ , *XC ’ ,13, ’D = ’.2X.DiO.4D
NSIG = 4
M « NDX
MP = 3
IXJAC = NDX
XPPC1D = XPC1DZFAT0RK
XPPC2D = XPC2D
XPPC3D = XIC3DZFATORP
CALL ZXSSQCFUNC.M.NP.NSIG,EPS.DELTA.MAXFN,IOPT»PARAM,XPP.SSQ.F, *XJAC,IXJAC,XJTJ,WORK,INFER,I ERD
XPPC1D = XPPC1D*FATORK
XPPC2D = XPPC2D
XPPC3D = XPPC3D«FAT0RP
WRITEC3,10DCI , XPPCID . I = 1,3D
10 FORMATC5X, 'VALOR OTIMO = ’,’XC’.I3.D- ’.2X.D10.4D
WRITEC3.403
40 FORMAT!Z,IXVETOR NORMA GRAD™ NUM ITERACOES-NUM DIGITOS SIGNIFIC-
* E MARQUARDT CONST. ’. Z&gt;
WRITEC3,503CI .WORKCI3 ,1=1 ,53
50 FORMATC5X, ’ WORKC ’ ,12, * 3 = ’,F15.53
RETURN
END
C
G................. .....................................................
C	Transformacao de todos os dados de Entrada para unidades Darcy
C.......................................................................
SUBROUTINE DADOSCUME, PWF. X, PWS, XT, DPWE3
IMPLICIT REAL*8CA"H,O™Z3
REALES TIMEC NDP3,PWFCNDP3 ,TC1003.PC1003
REAL*8 XC NDE3 , PWSC NDE3 , DPWEC NDX3 , XTCNDX3 , VC203
COMMON Zl.PL.ZV, ML
COMMON ZSPLZT.P
COMMON ZRESERZCI.02,C3
COMMON ZCESTzVW,CW,RP,GRAD
COMMON ZPONTOSZN,NDP.NX,NDE.NDX
COMMON ZPVTZCT,PHI,VISC.PO,PFF,TH,RW,PI,CS,CF,PK&gt;S,Pe
C:::: DEFINICAO DOS PARAMETROS PARA A INVERSÃO DE STEHFEST:i:::::::::::
N = 8
ML= 1
C: : ; : Calculo dos parametros auxiliares PI e CPA i::::::;;::::;::::::::
PI = 4. M3ATANC1. D03
CPA= 1. Z14. 7
C:::: Outros dadosCUnidades Americanas e SI i:::::::::::::::::;:::::::: C: : : : Ct,CwCPsi -13 ;Th.Pp, FpCm3 ;RwC pol3 ; CdpCm3Zm33 ; Dot) , PhiCdecimal3 : : :
READCI ,103CT
READCI,103PHI
READCI ,103VISC
READCI ,103TH
READCI,103RW
READCI,103PP
READCI ,103FP
READCI ,103CW
READCI,103CDP
READCI .103DO
10	FORMAT!F25.03
C:::: Transformacao dados fluido e reservatório para o sistema DARCY :
RP = DSQRTCCDPZPI3*100.
0RAD=DO*O. 000966397
CF = CPI*RP*RP3zGRAD
CW = CW*14. 7
RW = RW*2. 54
VW = PI*RW*RW«CFP-PP3*100.
CS ~ CW*VW
CT = CTM4.7
PO = POMCPA
PE = PWSCNDE3*CPA
PFF = PWFCNDP3*CPA
TH = TH*100.
C: : : : Calculo dos parametros auxiliares C2 e C3
C2 = 2. xPlxTHZVISC
C3 = DLOGC2.DO3
C: : : : Impressão dos parametros WRITEC2,203
20 FORMATCZ, 23X .* DADOS DE FLUIDO E ROCHA’,Z»3X,’ COMPRESS.ClZatnD ’, *3X, ’POROSIDADE’ ,3X. ’ VISCCcpj ’ , 4X, ’ THCcirD ’.3X, ’RWCcnO ’ , Z3 WRITEC2,403CT, PHI , VISC, TH, RW
40	FGRMATCÍX,E10.3,10X,F8. 3,7X,F6. 3,5X,F8.2,3X,F8.33
C:::: Transformacao do Tempo e pressão para unidades Darcy TC13 = O.
PC 13 = PO
DO 50 I = 1 ,NDP
K =1+1
TCK3 = TI MEC 13 *3600.
TIMECI3 = TCK3
XTCI3 = TCJC3
PCK3 = PWFCI3Z14.7
PWFCI3 = PCK3
SO DPWECI3 = PCK3
DO 60 K = NX,NDX IE = K-NDP
DPWECK3 = PWSCIE3Z14.7
PWSCIE3 = DPWECKD
XTCK3 = XCIE3*36OO. + TCNX3
60 XCIE3 = XTCK3
RETURN
END SUBROUTINE FLUXOCX1,A,DPWF,NP3
C...........................-...........................................
C Esta rotina calcula os valores da pressão no periodo de fluxo e dos respectivos gradientes com relacao aos parâmetros.
n n
IMPLICIT REAL*8CA-H.O-Z3
EXTERNAL COEFF.SI8ACF,SI8ADF
DIMENSION AC NP3, VC 203, TCI 003, PC 1003
COMMON ZSPLzT,P
COMMON ZLPLZV,ML
COMMON ZRESERZC1,C2,C3
COMMON ZPONTOSZN,NDP,NX,NDE,NDX
COMMON ZPVTZCT,PHI,VISC,PO,PFF,TH,RW,PI,CS,CF,PK,S,PE
GAMA = DSQRTCAC133
IFCAC23.LT. 03 THEN
RWA = RWxDEXPC~AC233
Cl « DSQRTCPHIXVISC*CT*RWA*RWAD
ELSE
Cl = DSQRTCPHIXVISC*CTxRW*RW3
ENDIF
ALFA = C1ZGAMA
AUX4 = C2XAC13ZACS3
Al « C3ZX1
IFCML. EQ. N3GO TO 11
CALL COEFFCN3
11	CONTINUE
SUHR = 0.
DO 30 J = 1 , N
Z = J * Al
Y = DSQRTCZ3
XS = Y* ALFA
BKO = S18ACFCXS, IFALHA3
BK1 = S18ADFCXS.IFALHA3
ZI ~ 1. ZZ
AUX 5 = BKOzBKl.
I FC AC 23. LT. 03 THEN
AUX1 = AUX5ZXS
ELSE
AUX1 = AUX3ZXS + AC 23
ENDIF
AUX 2 = AUX4*AC3D*ZI
AUX 3 = AC63*AUX1 + AUX 2
AUX8 = Z«AUX1 + AUX4
AUX8I = 1.ZAUX8
PRESSAO = AUX3*AUXSI
30	SUHR - SUMR + VCJ3*PRE£SAO
DPWF = SUMR* Al
RETURN
END
SUBROUTINE FUNC CX1&gt;M,NPO.F3
uuuuuuuuuu
NP = NUMERO DE INTERVALOS DE TEMPO NO FLUXO
NE = NUMERO DE INTERVALOS DE TEMPO NA ESTATE CA
N = NUMERO DE GRID POINTS
IMPLICIT REALES CA-H.O-Z3
REAL XI C NPO3 , FC M3 , FRC 2003
COMMON Z TRI Z AC 603 &gt; BC 603 , CC 603 &gt; DC 603 , PDC 603 . PC 2003 . TC 2003
COMMON ZPVTIZCT.PHI.AMI,PO,H,RW1»CS,CF,PI1
COMMON ZPONTOSzN»NDP.NX,NDE,NDX
COMMON ZLIDAZ TTC2003tPWEC2003
COMMON ZFATORZFATORK,FATORP
AK = DBLECX1C13«FAT0RK3
S = DBLECX1C233
PI - DBLECX1C33 «FATORF3
WRITEC*,«3’K»S»PI ‘ .AK.S.PI
WRI TEC 2. *3 AK. S, PI
NP = NDP
ME = NDE
c
CALL EÁD CAK.S&gt;PI ,NP.NE3
C
PC13 = PO
DO 3 I = 2.M + 1
J = I - 1
FRCJ3 = SNGLCPWECI3-PCI33
WRITEC2.1OO3TTCI3 ,PWECI3 ,PCI3 ,FRCJ3
FCJ3 - FRC J3*PC 13 ZP WEC13
3 COm NUE
100 FORMATCF6. 3,2X,F15. 5,2X»F15. 5,2X,F15. S3
:::: RESIDUO
SSR = 0.
DO 4 X =lfM
SSR ~ SSR + FrCI3*FrCI3
4	CONTINUE
WRITEC3t*3 ’SSR-’ &gt;SSR
RETURN
END
u u	uuuu	u	u u u o u u
SUBROUTINE RAD CAK^S^PIfNP,NE3
IMPLICIT REAL *8 CA-H.O-Z3
COMMON Z TRI Z AC 603.BC 603 .CC603 . DC603.PDC603,PC 2003„TC 2003
COMMON ZPVT1 /CT, PHI»AMI, PO, H t RW1 »CS» CF f PI 1
COMMON ZLIDAZ TTC2003,PWEC2003
IF CS. GE. 0.0003 RW = RW1
IF CS. LT. 0.0003 RW = RW1 * DEXP C -S3
AUX	= PHI	* CT * RW * RW
Auxl	= AUX	: * H * l.HSOOOOSdO
CTO	= AUX	* AMI * 3792.18809300
CSD	= CS z auxl	
CD =	CF Z	auxl
N »	51	
XN =	OLOG	Cl. 0153
DX =	XN Z	CN-13
DIF	= PI	- PO
NT	= NP	+ NE
CONDI CAO INICIAL
TO = 0. DO PDC13 = 1.000
DO 1 I = 2,N
PDCI3 = O. DO
1 c	CONTINUE DO 2 I = 2*NT + 1 I FC I. GT. CNP+1D. AND. I. LT. CNP+1ODD THEN DT = CCTTCID-TTCI-IDDZCTDDZI. DO 3 J = 1,1 TD = TD + DT CALL MONTAGEM CCD,DX,DT,XN, ND
a	CONTINUE GO TO 7 ENDIF
c	DT = CCTTCID-TTCI-IDDzCTDDzl. DO 5 J = 1,1 ID = TD + DT
C	CALL MONTAGEM CCD,DX»DT,XN,ND
5 C	CONTINUE TCID = TD * CTD PCID = PI - DIF * PDC1D I FCS. GT. O.DOD THEN 0 = CF*CPCID-POLDDZDT POLD = PCID PCID = PCID -Q*S ENDIF
c	IF CI. EQ. CNP+1DD THEN CD = CSD ENDIF
2 C	CONTINUE RETURN END
on	n n n n n no no
SUBROUTINE MONTAGEM CCD, DX , DT, XN t ND
IMPLICIT REAL*8 CA-H,O-ZD
COMMON / TRI Z AC SOD , BC 603 , CC SOD , DC SOD , PDC SOD , PC SOOD , TC SOOD
MONTAGEM DA MATRIZ TRI DIAGONAL
I = 1 -&gt; CONDICAO DE CONTORNO INTERNA
SETA = - DX * CD z DT
BC1D = BETA - l.ODO
CC1D = l.ODO
DC1D = BETA * PDC1D
I = 2,N-1
DO 2 I = 2,N-1
X = Cl-10 * DX
ALFA = - DEXP C2.DO * XO * DX * DX Z DT
ACID = 1, ODO
BCID = ALFA - 2. DO
CCID = l.ODO
DCID = ALFA * PDCID
2 CONTINUE
nnannnnnnnnonn nr&gt; n n n n	nnn
I - N -&gt; CONDICAO DE CONTORNO EXTERNA
ALFA = - DEXP C2.D0 * XND * DX * DX / DT AC ND = 2. ODO
BCND = ALFA - 2. ODO
DC ND = ALFA * PDCND
CALL TRIDAG CND
RETURN
END
SUBROUTINE TRI DAG CND
IMPLICIT REAL*8 CA-H.O-Z2
COMMON Z TRI Z AC 60D , BC ÕQD , CC 60D &gt; DC 60D , PDC 6GD . PC 200D 6 TC 2CQD
A -&gt; DIAGONAL INFERIOR
B -&gt; DIAGONAL PRINCIPAL
C -&gt; DIAGONAL SUPERIOR
D -&gt; VETOR INDEPENDENTE
P -&gt; VETOR SOLUCAO
N ~&gt; NUMERO DE EQUAÇÕES
DO 1 I = 1 , N-l
L = I + 1
BCLD = BCLD ” CCID * ACLD Z BC ID
DCLD = DCLD - DCID * ACLD Z BCID
1 CONTINUE
PDCND = DCND Z BCND
DO 2 I = N~1 ,1 t-l
L = 1+1
PDCID « C DCID - CCID * PDCLD D Z BCID
CONTINUE
RETURN
END
C
SUBROUTINE SLUG CXltM,NPO&gt;F3
IMPLICIT REALMS CA-H.O-ZD
REAL X1CNPO5 ,FCM0»FrCSOOO
COMMON Z TRI Z AC 603 , BC603 ,CC600 , DC 603 , PDC603 ,PC£003 ,TC2OO3
COMMON ZPVT1ZCT &gt; PHI,AMI»PO&gt;H,RW1,CS,CF,PI
COMMON ZPONTOSZN,NDP,NX&gt;NDE,NDX
COMMON ZLIDAZ TTC2005,PWEC£003
COMMON ZFATORZFATORK.FATORP
C; c : DESCALONAMENTO E USO ADEQUADO
AK - DBLECX1C13«FATORKO
S	= DBLECX1C233
WRITEC*. *3 ’K.S' ,AK.S
WRITECS, «OAK. S,PI
NP = NDP
NE = 0
C
CALL RADI CAK.S,NP,NE3
C
PC 13 - PO
DO 3 I = 2»M + 1
J = I - 1
FRCJ3 = SNGLCPWECI3-PCI33
FC JO - FRC J3ZCPWECNDP+13 -PC 13 0 WRITEC2,1003 TTCI3 &gt; PWEC 13 (PC 15 ( Fr C JO
3 CONTINUE
100 FORMATCF6. 3,2X,F15. 5.2X, FIS. 5,2X,F15. S3
C
C: : : : RES DUO
SSR = 0,
DO 4 I =1,M
SSR SSR + FrCIOMFrCID
4	CONTINUE
WRITEC3, *3SSR
RETURN
END
u u u u
SUBROUTINE RADI CAK,S»NP.NE3
IMPLICIT REALMS CA-H.O-Z3
COMMON Z TRI S AC 603 , BC 603 t CC 600 , DC 600 , PDC 603 , PC 2003 , TC 2000
COMMON ZPVT1ZCT, PHI , AME , PO, H,RW1,CS,CF,PI
COMMON ZLIDAZ TTC2000.PWEC2000
IF CS. GE. 0.0D03 RW = RW1
IF CS. LT. 0. ODOO RW = RW1 * DEXP C-S3
AUX	- PHI	* CT * RW m RW
Àuxl	= AUX * H * 1.11000006d0	
CTD	AUX	* AMI * 3792.18809300
CSD	- CS Z AUX1	
CD =	CF Z	AUX1
N =	51	
XN =	DLOG	Cl .Dl 53
DX ~	XN z	CN-13
DIF	= PI	~ PO
NT	= NP	+ NE
u-uu
CONDICAO INICIAL
TD - 0. DO
PDC13 - l.ODO
DO 1 I - S,M
PDCID = O. DO
1	CONTE NUE
DO 2 I - 2fNT + 1
DT « CCTTC13-TTC 1-1&gt;’3ZCTD3Z1.
DO 3 J = 1,1
TD = TD + DT
CALL MONTAGEM CCDtDXtDT»XN.N3
3 CONTINUE
TCI3 = TD * CTD
PCI2&gt; = PI ” DIF * PDC1D IFCS. GT. O. DOD THEN
Q = CF*CPCI3-POLD3ZDT POLD = PC 13
PCI3 = PCI3 -Q*S ENDIF
IF Cl. EQ. CNP+133 THEN
CD = CSD
ENDIF
2	CONTINUE
RETURN
END</field>
	</doc>
</add>