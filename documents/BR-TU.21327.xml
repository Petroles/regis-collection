<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.21327</field>
		<field name="filename">5044_001025179.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

 

ESTIMAÇÃO DE PARÂMETROS EM MODELOS COM CICLO 

LIMITE 

 

DISSERTAÇÃO DE MESTRADO 

 

Andressa Apio 

 

 

 

Porto Alegre 

2017 

  



 

 



UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

ESTIMAÇÃO DE PARÂMETROS EM MODELOS COM CICLO 

LIMITE 

Andressa Apio 

Dissertação de Mestrado apresentada como 
requisito parcial para obtenção do título de 
Mestre em Engenharia  

Área de concentração: Pesquisa e 
Desenvolvimento de Processos 

Linha de Pesquisa: Projeto, Simulação, 
Modelagem, Controle e Otimização de Processo 
Químicos e Bioprocessos. 

 

Orientador:  Prof. Dr. Jorge Otávio Trierweiler 

Co-orientadora: Dra. Viviane Rodrigues Botelho 

 

Porto Alegre 

2017 

  



 

  





 

  



 
 

 
 
 

Resumo 
 

Sistemas não-lineares podem apresentar um comportamento periódico, no qual o 
ponto de equilíbrio no diagrama de fase, quando se plota uma variável de estado versus 
outra variável de estado, é substituído por uma órbita circular, denominada ciclo limite. A 
estimação de parâmetros desses sistemas não é uma tarefa simples, devido a não 
convexidade do problema de otimização. A fim de estimar parâmetros em tais modelos, 
este trabalho propõe um método que quantifica o comportamento oscilatório do sistema 
em função do valor dos parâmetros, adicionando essa informação, na forma de uma 
penalidade à função objetivo do problema de otimização associado reduzindo a não 
convexidade do problema, conduzindo o modelo a produzir o comportamento oscilatório. 
Para avaliar a metodologia, primeiramente foi estudado o modelo de Jöbses et al. (1986), 
onde foi comparada metodologia proposta com abordagens disponíveis na literatura. A 
metodologia proposta também foi aplicada a modelos relativos à produção de petróleo 
offshore, onde foram considerados: o modelo simplificado de Meglio et al. (2009), com três 
estados dinâmicos,  representando apenas a região do sistema pipeline/riser, o modelo 
estendido de Diehl et al. (2017), com seis estados dinâmicos, representando a dinâmica das 
regiões anular/tubing e pipeline/riser e, por fim, a aplicação real, onde foram estimados os 
parâmetros desse último modelo com os dados de planta de produção offshore de uma 
plataforma de petróleo nacional. Os resultados mostraram que o método proposto foi 
capaz de garantir o comportamento oscilatório, diferentemente das outras abordagens, 
reduzindo a não convexidade do problema de estimação e forçando o comportamento 
dinâmico do sistema a produzir o ciclo limite, mesmo quando a otimização fosse inicializada 
a partir de valores fora da região de ciclo limite. 

 

 



ii 
 

 

  



iii 
 
 
 

 
 

 
Abstract 

 
Non-linear systems may present a periodic behavior, where the phase diagram 

equilibrium point, obtained by plotting a state variable versus another state variable, is 
replaced by a circular orbit called limit cycle. The parameters estimation in these systems 
is not an easy task due to the non-convexity of the optimization problem. In order to 
estimate parameters in these models, this work proposes a method that quantifies the 
system oscillatory behavior in function of the parameters values, adding this information 
in the form of a penality to the objective function of the associated optimization problem, 
reducing the non-convexity and leading the model to produce an oscillatory behavior. 
Firstly, to evaluate the methodology, it was studied the Jöbses et al. (1986) model,  where 
the proposed methodology was compared to the approaches available in the  literature. 
The methodology was also applied to models related to offshore oil production, where it 
was considered: the simplified Meglio et al. (2009) model, with three dynamical states, 
representing  only the pipeline/riser region, the Diehl et al. (2017) extended model, with 
six dynamical states, representing the dynamics of the anular/tubing and pipeline/riser 
region and, lastly, to a real application, where the parameters were estimated with the 
Diehl et al. (2017) model using real data obtained from a national oil plataform.  The results 
showed that the proposed approach was able to ensure the oscillatory behavior, differently 
of other approaches, reducing the non-convexity of the estimation problem and forcing the 
dynamical behavior of the system to produce the limit cycle, even when the optimization 
was initializated with values outside the region of the limit cycle.



iv 
 

 

  



v 
 

 
Agradecimentos 

 

À Universidade Federal do Rio Grande do Sul e ao Departamento de Engenharia 
Química pela estrutura oferecida e excelente formação. 

Ao meu orientador Prof. Dr. Jorge Otávio Trierweiler pela confiança, paciência, e 
orientação desde o primeiro contato. Certamente sem o seu incentivo, não teria chegado 
ao fim desta etapa. 

À minha coorientadora Prof. Dra. Viviane Rodrigues Botelho, a qual eu considero uma 
grande amiga, por toda a ajuda, atenção, disponibilidade e conselhos dados nos altos e 
baixos do desenvolvimento deste trabalho. 

Aos meus pais José Carlos e Zelfa e ao meu irmão Anderson, por acreditarem em mim 
e me incentivarem nos caminhos que escolhi. 

Ao Igor, pela convivência, carinho, paciência e generosidade em todos os momentos 
que passamos juntos. Além disso, por me ter me desafiado a ficar na linha tênue entre 
conforto e comodismo, me fazendo uma pessoa melhor. 

A todos os queridos amigos do GIMSCOP, que me receberam de braços abertos e que 
tornam o meu dia a dia mais divertido e descontraído. Agradeço, em especial, ao Denilson, 
que considero como um irmão. 

Ao pessoal do projeto das golfadas, principalmente ao Giovani e ao Leonardo pela 
disponibilidade em me auxiliarem e pela eficiência no compartilhamento das informações 
sobre os poços. À Marthina pela amizade e carinho nestes últimos e importantes meses. 

Às colegas de mestrado e amigas Caroline Machado e Débora Strossi pela amizade, 
conselhos e materiais divididos. 

À Caroline Weber e Taís Garlet, minhas irmãs de alma, pela compreensão, carinho e por 
serem tão indispensáveis na minha vida. Às minhas amadas engenheiras Andressa 
Marchesan, Karen, Martina, Julia e Tanisa por serem minha segunda família e estarem 
sempre presentes apesar da distância. Agradeço também ao meu afilhado do coração, 
Raoli, pela valiosa amizade depois de todos esses anos. 

Às minhas eternas professoras do ensino médio, Tatá Gouveia e Silvia Beber, por serem 
e terem sido meus exemplos de maturidade profissional e pessoal.  

E, por fim, a todas as pessoas que cruzaram por minha vida e que, de alguma forma, 
contribuíram para a formação do meu caráter e/ou me motivaram a evoluir psicológica e 
intelectualmente. 

 
 
“Give it all and ask for no return and very soon you'll see and you'll begin to learn that it's 
alright.” 

(Black Sabbath – It’s alright) 



vi 
 

 

 
 

SUMÁRIO 
 

 Introdução ............................................................................................1 

1.1 Motivação .................................................................................................................. 1 
1.2 Objetivos do trabalho ................................................................................................ 3 
1.3 Estrutura da dissertação ........................................................................................... 3 

 Revisão Bibiliográfica ............................................................................4 

2.1 Bifurcação .................................................................................................................. 4 
2.2 Análise do plano de fase e o ciclo limite ................................................................... 6 
2.3 A bifurcação Hopf ...................................................................................................... 7 
2.4 Métodos para estimação de parâmetros em modelos com bifurcação Hopf ........ 11 

 Metodologia ....................................................................................... 14 

3.1 Critério ?-Hopf ......................................................................................................... 14 
3.2 Adaptação do método de penalidade exata ........................................................... 16 
3.3 Função objetivo ....................................................................................................... 18 
3.4 Estimação dos parâmetros utilizando o método single-shooting .......................... 19 

 Estudo de caso .................................................................................... 21 

4.1 Métricas para otimização ........................................................................................ 21 
4.1.1 Abordagens para a otimização do problema com ciclo limite ......................................21 
4.1.2 Avaliação numérica dos resultados ...............................................................................22 
4.1.3 Intervalo de confiança dos parâmetros .........................................................................23 

4.2 Modelo de Jöbses et al. (1986) ............................................................................... 24 
4.2.1 Modelagem matemática ...............................................................................................24 
4.2.2 Cenários .........................................................................................................................26 
4.2.3 Análise da função objetivo ............................................................................................28 
4.2.4 Resultados e discussão ..................................................................................................30 
4.2.5 Validação .......................................................................................................................33 

 Aplicação na produção de petróleo offshore ........................................ 36 

5.1 Modelo de Meglio et al. (2009) ............................................................................... 36 
5.1.1 Modelagem matemática ...............................................................................................37 
5.1.2 Cenários .........................................................................................................................39 
5.1.3 Análise da função objetivo ............................................................................................40 
5.1.4 Resultados e discussão ..................................................................................................41 

5.2 Fast Offshore Well Model (FOWM) ......................................................................... 45 
5.2.1 Modelagem matemática ...............................................................................................46 
5.2.2 Cenários .........................................................................................................................51 
5.2.3 Análise da função objetivo ............................................................................................51 
5.2.4 Resultados e discussão ..................................................................................................52 

5.3 Aplicação do modelo FOWM utilizando dados reais .............................................. 56 
5.3.1 Cenários .........................................................................................................................56 
5.3.2 Resultados e discussão ..................................................................................................57 

 Considerações Finais ........................................................................... 62 

6.1 Conclusões ............................................................................................................... 62 



vii 
 

6.2 Sugestões para trabalhos futuros ........................................................................... 63 

Referências ................................................................................................................. 64 

Apêndice A .................................................................................................................. 68 

A.1 Análise do plano de fase ......................................................................................... 68 
A.1.1 Plano de fase de nós ......................................................................................................68 
A.1.2 Plano de fase de selas ....................................................................................................69 
A.1.3 Plano de fase foco..........................................................................................................69 

A.2 Análise de bifurcação .............................................................................................. 70 
A.2.1 Bifurcação ponto limite (turning point) .........................................................................70 
A.2.2 Bifurcação transcrítica (transcritical bifurcation) ..........................................................71 
A.2.3 Bifurcação forquilha (pitchfork bifurcation) ..................................................................72 

A.3 Funções teste de bifurcação ................................................................................... 74 
  



viii 
 

 

LISTA DE FIGURAS 
 
Figura 1.1: Relação entre as regiões de operação na produção de petróleo em relação à 
máxima produção, retorno financeiro e valor presente. Adaptado de Gerevini (2017). ..... 2 
Figura 2.1: Surgimento do ciclo limite na produção de petróleo em gráfico de a) variável 
de saída versus tempo e b) análise de plano de fase de variável de saída versus outra 
variável de saída e entrada. Adaptado de Gerevini (2017). .................................................. 6 
Figura 2.2: Transição de soluções estacionárias para periódicas exibida em um a) 
diagrama de bifurcação e em b) gráfico da saída versus o tempo para a produção de 
petróleo. Adaptado de Gerevini (2017). ............................................................................... 7 
Figura 2.3: Geração dos ciclos limites em  ? = 0 (plano de fase dependente do 
parâmetro). Adaptado de Seydel (2010). .............................................................................. 8 
Figura 2.4:  Geração de ciclos climites no ponto Hopf; dependência do tempo e do 
parâmetro. Adaptado de Seydel (2010). ............................................................................... 8 
Figura 2.5: Plano complexo dos autovalores; caminho dos autovalores relacionados à 
bifurcação Hopf em relação à abertura da válvula choke na produção de petróleo. 
Adaptado de Gerevini (2017). ............................................................................................... 9 
Figura 2.6: Comportamento de estabilidade local de bifurcações Hopf.  Adaptado de 
Seydel (2010). ...................................................................................................................... 10 
Figura 3.1: Comportamento da a) resposta da saída ? para diferentes valores de ? e b) 
penalidade ? ao longo das iterações na estimação de parâmetros. .................................. 18 
Figura 3.3: Loop interno da metodologia proposta para a estimação dos parâmetros. .... 20 
Figura 4.1: Relação de variâncias entre os dados simulados e experimentais. .................. 23 
Figura 4.2: Perturbação na concentração de alimentação de substrato. ........................... 27 
Figura 4.3: Distúrbios na taxa de diluição para o (a) cenário B e o (b) cenário C. .............. 28 
Figura 4.4: Gráfico da função objetivo do modelo de Jöbses et al. (1986) (a) abordagem 1: 
mínimos quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade 
para (b) ? = 5?3, (c) ? = 1?4 e (d) ? = 1,5?4. ................................................................ 29 
Figura 4.5: Cenário A do modelo de Jöbses et al. (1986) (a) abordagem 1: sem penalidade 
e b) abordagem 2: com penalidade ?.  Os “dados experimentais” são representados pela 
linha pontilhada azul e os dados estimados pela linha sólida vermelha. ........................... 31 
Figura 4.7: Cenário C do modelo de Jöbses et al. (1986) (a) abordagem 1: sem penalidade 
e b) abordagem 2: com penalidade ?. Os “dados experimentais” são representados pela 
linha pontilhada azul e os dados estimados pela linha sólida vermelha. ........................... 31 
Figura 4.8:  Cenário D do modelo de Jöbses et al. (1986) (a) sem penalidade e (b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 32 
Figura 4.9: Planos de fase para os cenários A, B, C e D do modelo de Jöbses et al. (1986).
 ............................................................................................................................................. 33 
Figura 4.10: Distúrbio na taxa de diluição para a etapa de validação para o modelo de 
Jöbses et al. (1986). ............................................................................................................. 34 
Figura 4.12: Validação do modelo de Jöbses et al. (1986) para o (a) cenário C e (b) cenário 
D. Os dados “experimentais” são representados pela linha pontilhada azul e os dados 
estimados pela linha sólida vermelha. ................................................................................ 35 
Figura 5.1: Diagrama esquemático do sistema. Fonte: Meglio et al. (2009). ..................... 37 



ix 
 
Figura 5.2: Gráfico da função objetivo do modelo de Meglio et al. (2009) (a) abordagem 1: 
mínimos quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade 
para (b) ? = 10, (c) ? = 1?4 e (d) ? = 1?5. ..................................................................... 41 
Figura 5.3: Cenário A do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 42 
Figura 5.4: Cenário B do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os “dados experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 43 
Figura 5.5: Cenário C do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. os dados experimentais são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 43 
Figura 5.6: Cenário D do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 44 
Figura 5.7: Planos de fase para os cenários A, B, C e D do modelo de Meglio et al. (2009).
 ............................................................................................................................................. 45 
Figura 5.8: Sistema da produção de óleo e gás no mar modelado pelo FOWM. Retirado de 
Diehl et al. (2017). ............................................................................................................... 46 
Figura 5.9:  Gráfico da função objetivo do FOWM para a (a) abordagem 1: mínimos 
quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade para (b) 
? = 1?4, (c) ? = 1?8 e (d) ? = 1?12. ............................................................................... 52 
Figura 5.10: Cenário A do FOWM sem penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. ..................................................................... 53 
Figura 5.11: Cenário A do FOWM com penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha.  .................................................................... 54 
Figura 5.12: Cenário B do FOWM sem penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha.  .................................................................... 54 
Figura 5.13:  Cenário B do FOWM com penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha.  .................................................................... 55 
Figura 5.14: Planos de fase para os cenários A e B do modelo FOWM. ............................. 56 
Figura 5.15: Entradas no modelo real do FOWM da abertura da válvula choke. ............... 57 
Figura 5.16: Resultados utilizando a metodologia proposta para o cenário A do FOWM 
sem penalidade (linha verde) e com penalidade (linha vermelha) utilizando dados reais 
(linha azul). .......................................................................................................................... 58 
Figura 5.17: Resultados obtidos por Diehl et al. (2017) (linha vermelha) para o mesmo 
conjunto de dados reais (Azul). ........................................................................................... 59 
Figura 5.18: Planos de fase para o cenário A do modelo FOWM utilizando dados reais. .. 60 
Figura A.1: Nó estável no plano de fase para o caso não-linear (autovalores são 
pontilhados). Fonte: Seydel (2010). .................................................................................... 68 
Figura A.2:  Sela em um plano de fase (autoespaço é indicado pelo seu autovalor ?). 
Fonte: Seydel (2010). ........................................................................................................... 69 
Figura A.3:  Mudança de estabilidade do foco em um plano de fase. Fonte: Seydel (2010).
 ............................................................................................................................................. 70 
Figura A.4: Bifurcação ponto limite. Fonte: Seydel (2010). ................................................ 70 
Figura A.5: Estabilidade da bifurcação ponto limite. Fonte: Seydel (2010). ....................... 71 



x 
 

 

Figura A.6: Bifurcação transcrítica. Fonte: Seydel (2010). .................................................. 72 
Figura A.7: Bifurcação forquilha supercrítica. Fonte: Seydel (2010). ................................. 73 
Figura A.8: Bifurcação forquilha subcrítica. Fonte: Seydel (2010). ..................................... 73 
 
 
 
  



xi 
 

LISTA DE TABELAS 
 
Tabela 2.1:  Variáveis para resolução da matriz delimitada ????. .................................... 13 
Tabela 4.1:  Valores originais para os parâmetros do modelo de Jöbses et al. (1986). ..... 26 
Tabela 4.2: Cenários para a simulação do modelo de Jöbses et al. (1986). ....................... 27 
Tabela 4.3: Resultados dos erros quadráticos do modelo de Jöbses et al. (1986) para 
todos os cenários e seus respectivos casos. ........................................................................ 30 
Tabela 4.4: Valores dos parâmetros estimados para todos os cenários do modelo de 
Jöbses et al. (1986) utilizando a abordagem 2. ................................................................... 32 
Tabela 4.5: Resultados dos erros quadráticos e variâncias do modelo de Jöbses et al. 
(1986) para todos os cenários e abordagem 2. ................................................................... 34 
Tabela 5.1:  Parâmetros do modelo de Meglio et al. (2009). ............................................. 39 
Tabela 5.2: Cenários para a simulação do modelo de Meglio et al. (2009). ....................... 39 
Tabela 5.3: Resultados dos erros quadráticos do modelo de Meglio et al. (2009) para os 
cenários e seus respectivos casos. ...................................................................................... 42 
Tabela 5.4: Valores dos parâmetros estimados para todos os cenários do modelo de 
Meglio et al. (2009) utilizando a abordagem 2. .................................................................. 44 
Tabela 5.5: Parâmetros do Fast Offshore Well Model. ....................................................... 50 
Tabela 5.6: Cenários para os dados experimentais provenientes da simulação do FOWM.
 ............................................................................................................................................. 51 
Tabela 5.7: Resultados dos erros quadráticos do FOWM com dados experimentais 
simulados para os cenários e seus respectivos casos. ........................................................ 53 
Tabela 5.8: Valores dos parâmetros estimados para todos os cenários do FOWM 
utilizando dados experimentais simulados utilizando a abordagem 2. .............................. 55 
Tabela 5.9: Cenários para os dados experimentais e reais provenientes da simulação do 
FOWM. ................................................................................................................................. 57 
Tabela 5.10: Resultados dos erros quadráticos do FOWM com dados reais para o cenário 
A e seus respectivos casos. .................................................................................................. 58 
Tabela 5.11: Valores dos parâmetros estimados para todos os cenários do FOWM 
utilizando dados reais para a abordagem 2. ....................................................................... 60 

 

  



xii 
 

 

 
 

NOTAÇÃO E SIMBOLOGIA 
 

? vetor das saídas 

? vetor das entradas 

? tempo 

? determinado tempo decorrido 

? parâmetro de bifurcação 

? autovalores 

???? matriz delimitada 

? matriz do produto bialternado 

? matriz U da decomposição em valores singulares de A 

? matriz V da decomposição em valores singulares de A 

? matriz de zeros  

? polos de uma equação 

? fator de amortecimento  

?i
?

 soluções estacionárias 

? função objetivo de mínimos quadrados 

? parâmetro de penalidade 

?? restrição do problema 

???? função objetivo  

? tolerância 

????  predição do modelo 

?? número de amostras disponíveis 

? contribuição real do autovalor 

? contribuição imaginária do autovalor 

??? erro quadrático médio 

?? variância ? 

???? variância simulada 

???? variância experimental 

?? relação entre a variância simulada e experimental 

 
?2 estimativa da variância experimental 

? probabilidade para intervalo de confiança 

?? matriz de covariância 



xiii 
 
?? parâmetros do modelo 

?? valor do parâmetro estimado  

?? variância para cada parâmetro ? 

?? distribuição t-student 

?? taxa de reação 

? matriz de sensibilidade 

?0 tempo inicial 

?? tempo final 

?2 estimativa da variância experimental 

??? desvio padrão do parâmetro ?? 

???  concentração de alimentação da biomassa E  

??? concentração de alimentação do produto  

?? taxa de diluição  

?? constante de Monod  

?? constante da taxa de reação  

?? fator de manutenção baseado na formação de substrato  

?? fator de manutenção baseado na formação de produto  

??? fator de rendimento da conversão de substrato em biomassa 

??? fator de rendimento da conversão de biomassa em produto 

??? massa de gás na bolha alongada 

??? massa de gás no riser 

??? massa de líquido no riser 

???? vazão mássica de gás entrando no riser 

????? vazão mássica de gás saindo do riser 

???? vazão mássica de líquido entrando no riser 

???? vazão mássica de gás entrando no riser 

? fração da vazão de gás 

???? vazão mássica total 

??? volume da bolha alongada 

??? volume do gás no riser 

?? volume do riser 

??? pressão na bolha acumulada 

??? pressão à montante da válvula virtual 

??? pressão no topo do riser 

? inclinação do riser 

? área do corte transversal 

?? densidade do líquido 



xiv 
 

 

?? pressão de separação 

? constante do gás 

? temperatura  

? massa molar do gás de elevação 

? constante de gravidade 

? diâmetro do riser 

? comprimento do riser 

??????? massa de mínima de líquido no riser 

?? coeficiente de fluxo da bolha alongada 

???? coeficiente de fluxo da choke 

??? massa de gás no anular 

??? vazão mássica de gás natural entrando no anular 

??? vazão mássica de gás natural através da válvula de injeção no tubing 

??? massa de gás no tubing 

??? massa de líquido no tubing 

?? vazão mássica total proveniente do reservatório 

???? vazão mássica de gás saindo do tubing 

???? vazão mássica de líquido saindo do tubing 

??? pressão no ponto de injeção de elevação no tubing 

??? pressão no ponto de injeção de gás de elevação no anular 

??? pressão no ponto de injeção de elevação no tubing 

??? pressão no ponto de injeção de gás de elevação no tubing 

?? pressão no reservatório 

??? massa específica do gás no anular 

?? massa específica do óleo 

??? fração mássica de gás no tubing 

?? fração mássica de líquido no riser 

?? fração mássica de gás no riser 

?? coeficiente de fluxo de válvula de injeção 

?? coeficiente de fluxo da árvore de Natal 

?? coeficiente de fluxo do reservatório 

? abertura da choke 

?? volume do anular 

??? massa específica do líquido no riser 



xv 
 
????? massa específica de líquido no reservatório 

??? massa específica do líquido no tubing 

??? massa específica do gás no tubing 

?? comprimento do anular 

?? comprimento do tubing 

???? distância até o medidor de pressão no tubing 

???? distância até o ponto de injeção de gás de elevação no tubing 

??? volume de gás no tubing 

?? volume do tubing 

?? diâmetro do tubing 

??? fração de gás no reservatório 

??   comprimento do anular 

 

 

 

 
  



xvi 
 

 

  



 
 

 Introdução 

1.1 Motivação 

Muitos processos dinâmicos são suscetíveis à presença de comportamento oscilatório 
devido ao ciclo limite, o qual é uma trajetória fechada no plano de fase onde ao menos uma 
trajetória espira dentro dela enquanto o tempo se aproxima do infinito. Um exemplo 
clássico de sistema com ciclo limite consiste no modelo de Lotka-Volterra, que descreve a 
dinâmica de sistemas biológicos quando duas espécies interagem: é o caso do predador-
presa, onde o predador e a presa estão continuamente se sobrepondo. Muitos trabalhos 
reportam a presença de ciclos limites em processos de fermentação, conforme Wang et al. 
(2014), Daugulis et al. (1997), McLellan et al. (1999) e Jöbses et al. (1986). Da mesma forma, 
Zamamiri et al. (2001) e Zhang &amp;amp; Henson (2001)  abordaram uma análise de multiplicidade 
e estabilidade de microorganismos em culturas contínuas. Em reatores químicos, Ourique 
et al. (2002) mostram que dependendo das condições de operação, é possível que se tenha 
múltiplos estados estacionários e soluções oscilatórias. 

Na produção de petróleo é comum a existência de um fenômeno denominado golfada, 
o qual é proveniente do regime de escoamento multifásico, sendo caracterizado pelo fluxo 
intermitente de líquido seguido de ondas de gás. Segundo Filho (2011), existem diversos 
mecanismos físicos que geram as golfadas, sendo o mais relevante, o causado devido à 
inflexão das tubulações de transporte. As golfadas ocasionam grandes oscilações de 
pressão no sistema afetando diretamente a produtividade, a vida útil e a segurança das 
instalações. Pequenas perturbações do sistema podem causar uma mudança drástica de 
comportamento do fluxo, levando-a à ocorrência de golfadas, que são um sistema com 
ciclo limite. Meglio et al. (2009) confirma esta hipótese utilizando o critério Poincaré-
Bendixson (KHALIL, 2002). Um exemplo onde a identificação de um modelo com ciclo limite 
é importante, é na produção de petróleo em sistemas de produção offshore, onde se utiliza 
o controle NMPC (GEREVINI et al., 2016).  

A escolha por se operar em uma região instável, ou seja, onde o comportamento é 
oscilatório, pode ser vantajosa uma vez que é possível que a máxima produção nesse ponto 
de operação quando comparado a uma região estável. Gerevini (2017) discute a relação da 
abertura da válvula choke de produção em relação à produção de petróleo na Figura 1.1, 
onde é mostrado que quando se opera no regime das golfadas (ou com oscilações), se tem 
a máxima produção de petróleo e retorno financeiro. Enquanto isso, na operação em malha 



2 Introdução 

 

 

aberta em uma região estável, por conhecimento empírico e intuição das equipes de 
operação, se tem uma menor produção de petróleo. 

 

Figura 1.1: Relação entre as regiões de operação na produção de petróleo em relação à 
máxima produção, retorno financeiro e valor presente. Adaptado de Gerevini (2017). 

A identificação de sistemas dinâmicos não-lineares possui grandes demandas na 
indústria de processos, especialmente nas áreas de controle e otimização. O principal 
objetivo da identificação do sistema dinâmico é construir um modelo a partir das 
observações experimentais que reproduza a dinâmica desses sistemas tão fielmente 
quanto possível. Para Qiao &amp;amp; Han (2012), em muitas situações práticas, no entanto, é 
praticamente inviável obter modelos matemáticos precisos do sistema devido à falta de 
conhecimento de alguns parâmetros. Dessa forma, a estimação dos parâmetros é uma 
etapa fundamental para obtenção de modelos com capacidade preditiva. Em sistemas com 
ciclo limite, a estimação de parâmetros é um problema mais complexo, quando comparado 
aos sistemas com comportamento dinâmico estável convencional. Isso porque a 
instabilidade destes sistemas tende a atrapalhar a convergência do problema de otimização 
associado à estimação.  

A estimação de parâmetros em modelos com ciclo limite é um tópico que vêm sendo 
frequentemente abordados na literatura. Dentre os métodos existentes, destacam-se os 
trabalhos de Guckenheimer et al. (1997), que foram aprimorados por Meerbergen &amp;amp; 
Spence (2010) e Elman et al. (2012), além das abordagens propostas por Cedersund &amp;amp; 
Knudsen (2005), Hynne et al. (1993) e Hynne et al. (2001) e Govaerts (2000), que descreve 
a abordagem mais difundida para detecção do ponto crítico do ciclo limite, a bifurcação 
Hopf. Nos trabalhos mencionados a maior dificuldade é a complexidade de implementação 
dessas metodologias, o que as torna, muitas vezes, inviáveis de serem aplicadas, 
dependendo do tamanho do modelo associado. Além disso, muitos deles exigem que 
modificações algébricas nos modelos sejam realizadas, as quais nem sempre são facilmente 
detectáveis. 

Com base no que foi descrito, este trabalho propõe uma metodologia de estimação de 
parâmetros para modelos com ciclo limite simples de ser implementada e sem a 
necessidade de modificações algébricas no modelo. A ideia consiste em se utilizar um 
critério para detectar a presença de ciclos limite, incluindo-o na forma de penalização da 
função objetivo. Os modelos que serão empregados nesta dissertação são tipo caixa cinza, 
ou seja, são construídos sob fundamentos físicos com parâmetros estimados a partir dos 



1.2 Objetivos do trabalho 3 

 
dados experimentais medidos. Segundo Romijn et al. (2008), esse modelo em caixa cinza é 
um sistema combinando mecanística (leis físicas e químicas) e componentes caixa preta 
(empírico), onde a principal ideia é minimizar a extra experimentação e pesquisa. Embora 
seja mais difícil de construir, esses sistemas podem levar a modelos melhores quando 
comparados à identificação caixa branca e caixa preta (KROLL, 2000), combinando as 
vantagens desses dois últimos principalmente para sistemas em que o comportamento 
não-linear precisa ser adequadamente capturado, como nos caso dos sistemas com ciclo 
limite. 

1.2 Objetivos do trabalho 

O principal objetivo deste trabalho é desenvolver uma metodologia simples que facilite 
a estimação de parâmetros em modelos com ciclo limite, tendo como objetivos 
secundários a aplicação em: 

? estudos de casos representativos encontrados na literatura, como o modelo de 
Jöbses et al. (1986), que descreve a produção de etanol com Zymmona mobilis e o 
modelo de Meglio et al. (2009), que representa o regime de fluxo das golfadas em 
tubos verticais, e 

? um sistema real utilizando um modelo para produção offshore em um poço de 
petróleo de uma empresa nacional que possui o fenômeno das golfadas. 

1.3 Estrutura da dissertação 

Neste capítulo foi realizada uma apresentação geral deste trabalho, onde são 
abordadas as principais motivações e objetivos para o desenvolvimento desta pesquisa. 

O capítulo 2 apresenta a revisão bibliográfica que visa solidificar conceitos importantes 
para o entendimento do trabalho. 

A metodologia proposta nesta dissertação é descrita no capítulo 3 sendo aplicada no 
capítulo 4 no estudo de caso simulado empregando o modelo de Jöbses et al. (1986). 

O capítulo 5 é aplicado na produção de petróleo offshore onde a metodologia proposta 
foi aplicada no modelo simplificado de Meglio et al. (2009), no modelo estendido de Diehl 
et al. (2017) e na aplicação real, onde foram estimados os parâmetros desse último modelo 
com os dados de planta de produção offshore de uma plataforma de petróleo nacional. 

Já o capítulo 6 apresenta as conclusões finais e sugestões de trabalhos futuros.  

 



 
 

  4 

 Revisão Bibiliográfica 

Este capítulo é constituído por uma revisão bibliográfica dos principais assuntos 
necessários para o desenvolvimento deste trabalho. Inicialmente são abordados os 
fundamentos da teoria e conceitos de bifurcação e, por conseguinte, conceitos sobre 
análise do plano de fase para o entendimento do ciclo limite. Na sequência é feita uma 
revisão sobre o ciclo limite e o ponto Hopf e, por último, é realizado um levantamento 
sobre os principais métodos existentes para a detecção da bifurcação Hopf. 

2.1 Bifurcação 

O conceito de bifurcação foi introduzido em 1880 pelo francês Poincaré, sendo definido 
como uma mudança da dinâmica do sistema, sendo ela qualitativa ou quantitativa no plano 
de fase de um sistema dinâmico, decorrente da variação de algum parâmetro de controle.  
Assim, em um sistema de equações diferenciais, uma bifurcação no estado estacionário 
acontece se há alterações no número de soluções estacionárias ou na estabilidade do 
sistema (BEQUETTE, 1998). Ou seja, quando um determinado parâmetro do modelo 
atravessa um valor crítico, chamado de ponto de bifurcação(?). Em outras palavras, 
segundo Bequette (1998), supondo um sistema contínuo que apresente determinada 
propriedade (como, por exemplo, o número de soluções de equilíbrio ou sua estabilidade) 
invariante para determinado parâmetro ?  em um intervalo aberto (?,?) , mas essa 
propriedade não se mantém para nenhum intervalo maior. Então os pontos ? e ? são 
chamados de pontos de bifurcação. 

O diagrama de bifurcação é uma importante ferramenta para o estudo do 
comportamento dinâmico de um sistema e consiste em avaliar graficamente a relação 
entre um determinado parâmetro (?) e os pontos de equilíbrio, também denominados 
soluções estacionárias do sistema, os quais estão associados à uma variável de estado. 
Esses diagramas são gerados a partir da análise da resposta do sistema a partir da variação 
de um parâmetro, onde regiões estáveis são representadas por linhas contínuas e regiões 
instáveis por linhas pontilhadas. Cada uma destas regiões é denominada ramo. Os 
autovalores da Jacobiana do sistema estão diretamente associados com o plano de fase, 
onde pontos estáveis (parte real negativa) são atratores e pontos instáveis (parte real 
positiva) são repulsores de soluções. O surgimento de autovalores complexos conjugados 
é a causa da ocorrência do ciclo limite. 



2.1 Bifurcação 5 

 
O fenômeno da bifurcação acontece em modelos não-lineares, uma vez que nestes 

sistemas as saídas não são diretamente proporcionais às entradas, ou a mudança em uma 
variável não produz uma mudança proporcional na variável relacionada. Ou seja, os valores 
das saídas do sistema não são proporcionais aos valores em tempos próximos (WILLIAMS, 
1997). Nesses sistemas, análises baseadas em simulação dinâmica podem ser incapazes de 
captar comportamentos característicos relevantes. Assim, análises da dinâmica não-linear 
são necessárias para sistemas complexos como reatores químicos e biorreatores 
(BEQUETTE, 1998). Portanto, uma das técnicas mais importantes no estudo de sistemas 
não-lineares é a análise dos diagramas de fase. Através dessa técnica é possível caracterizar 
comportamentos como o efeito das condições iniciais e da estabilidade de soluções 
estacionárias. 

Nos últimos 50 anos, o fenômeno de multiplicidade e soluções para um dado ponto de 
operação foi estudado de forma generalizada em pesquisas da engenharia química e 
biológica e em particular, em reações químicas/biológicas. O fascínio por esse fenômeno 
tem sido amplamente difundido na literatura em sistemas como muitos trabalhos 
reportam a presença de oscilações principalmente em processos de fermentação 
(DAUGULIS; MCLELLAN; LI, 1997; JÖBSES et al., 1986; MCLELLAN; DAUGULIS; LI, 1999; 
WANG et al., 2014), reatores químicos (OURIQUE; BISCAIA; PINTO, 2002) e na produção de 
petróleo (DIEHL et al., 2017; MEGLIO; KAASA; PETIT, 2009). Parte da literatura de 
matemática aplicada também estuda esse fenômeno, mas de forma mais geral e em termos 
mais abstratos sob o nome de “teoria de bifurcação” (ELNASHAIE; UHLIG, 2007). 

Embora a literatura seja rica em investigações teóricas de bifurcação e em laboratórios 
experimentais para verificação, ainda é pouco extensa no que diz respeito a esse fenômeno 
em sistemas industriais. Segundo Elnashaie &amp;amp; Uhlig (2007), apenas alguns trabalhos foram 
publicados que abordam a questão em relação a quando a multiplicidade de estados 
estacionários ou mudança de dinâmica do sistema é importante industrialmente. Ainda, 
segundo o mesmo autor, a filosofia industrial tenta evitar regiões problemáticas de 
operação e parâmetros de projeto que são caracterizados por instabilidades, uma vez que 
nestes casos o controle do sistema pode ser difícil.  Essa filosofia conservativa era 
justificável antes dos grandes avanços das últimas décadas em relação à modelagem e 
simulação de modelos, além dos avanços no ramo de tecnologia da informação e no 
desenvolvimento de sensores e atuadores, os quais viabilizam a exploração das vantagens 
de se operarem regiões de multiplicidade de soluções ou mudança de comportamento 
dinâmico.  

Em sistemas contínuos de primeira ordem, tem-se os três tipos de bifurcação mais 
tradicionais: ponto limite, transcrítica e forquilha. Essas possuem uma característica em 
comum, que é a mudança de estabilidade em suas soluções estacionárias de um ramo 
estável para um ramo instável. Já o que as diferencia são as possíveis configurações, tal 
como a existência de mais de um ramo de soluções estacionárias (multiplicidade de 
soluções), para diversos parâmetros de controle. Esses tipos de bifurcação tradicionais são 
descritos no Apêndice A. As bifurcações citadas consistem de soluções estacionárias (??? =
0 = ?(?,?) ), enquanto fenômenos com movimento podem ser representados por 
oscilações regulares, onde se tem ciclos limites no plano de fase, enquanto que as demais 
são apenas pontos no mesmo gráfico. Dentre os diferentes tipos de bifurcação 
mencionados, o enfoque deste trabalho é a bifurcação Hopf, que é o ponto crítico do ciclo 
limite, a qual é descrita mais detalhadamente no item 2.3, sendo que no item 2.2 é 



6 Revisão Bibiliográfica 

 

 

apresentado o conceito do plano de fase e o ciclo limite, necessário para o seu 
entendimento. 

2.2 Análise do plano de fase e o ciclo limite 

A análise do plano de fase consiste em graficar curvas de uma variável de estado versus 
outra variável de estado, onde cada curva é baseada em uma condição inicial. Esse tipo de 
análise é uma das técnicas mais importantes para estudar o comportamento de sistemas 
não-lineares, já que frequentemente não se tem soluções analíticas para um sistema não-
linear. Os padrões de planos de fase mais comuns são: o nó, a sela, o foco e o ciclo limite, 
que são classificados desta forma devido ao comportamento de seus autovalores. Neste 
caso é analisado profundamente apenas o último tipo, tendo em vista que ele está 
associado ao objetivo principal deste trabalho, sendo que os demais padrões de planos de 
fase são descritos no Apêndice A. 

Segundo Seydel (2010), um ciclo limite é uma solução periódica (órbita periódica) que 
acontece apenas para modelos não-lineares. Nesse caso, depois que um certo período de 
tempo ? é transcorrido, os valores da solução ? de uma órbita periódica são os mesmos. 

 ?(? + ?) = ?(?) (2.1) 

O mínimo valor de ? &gt; 0  que satisfaz essa equação é denominado período. 
Considerando o surgimento do ciclo limite no exemplo da produção de petróleo (GEREVINI, 
2017) na Figura 2.1, sabe-se que neste caso o ponto de equilíbrio do diagrama de fase é 
substituído por uma órbita circular. Ou seja, para o caso onde se tem oscilações, o diagrama 
de fase converge para o ciclo limite (terceiro ciclo) ao invés de um ponto (primeiro e 
segundo ciclo). 

  

Figura 2.1: Surgimento do ciclo limite na produção de petróleo em gráfico de a) variável 
de saída versus tempo e b) análise de plano de fase de variável de saída versus outra 

variável de saída e entrada. Adaptado de Gerevini (2017). 

Nesse caso, percebe-se que o diâmetro da espiral no plano de fase aumenta com o 
tempo, enquanto a amplitude da oscilação aumenta. Portanto, os ciclos limites 
representam movimentos regulares e não são necessariamente uma órbita fechada. 
Exemplos são impulsos nervosos, correntes elétricas em circuitos elétricos, dentre outros. 



2.3 A bifurcação Hopf 7 

 

2.3 A bifurcação Hopf 

A bifurcação Hopf conecta um ramo de equilíbrio com um ramo de oscilações 
(movimento periódico), conforme apresentado na Figura 2.2 para o exemplo da produção 
de petróleo. 

 

Figura 2.2: Transição de soluções estacionárias para periódicas exibida em um a) 
diagrama de bifurcação e em b) gráfico da saída versus o tempo para a produção de 

petróleo. Adaptado de Gerevini (2017). 

Nos diagramas de bifurcação se tem representações gráficas da relação entre os valores 
do parâmetro de bifurcação em relação ao comportamento do sistema no qual o 
parâmetro é medido. Neste caso, considera-se que cada valor do parâmetro de bifurcação 
é correspondente à medida da variável de estado no estacionário. No diagrama da Figura 
2.2 observa-se que quando ocorre a birfucação Hopf, ou seja, a transição das soluções 
estacionárias para as oscilatórias, o ramo de equilíbrio é substituído por três novos ramos: 
a amplitude máxima (linha verde), mínima (linha vermelha) e o ponto de equilíbrio (linha 
azul) das oscilações. Considerando um sistema de equações onde existe bifurcação Hopf 
(SEYDEL, 2010): 

 ?1? = ??2 + ?1(? ? ?1
2 ? ?2

2) (2.2) 

 ?2? = ?1 + ?2(? ? ?1
2 ? ?2

2) (2.3) 

a única solução estacionária para o parâmetro ? é ?1 = ?2 = 0.  

Os autovalores que advêm do determinante da matriz Jacobiana associada à 
linearização do modelo, devem possuir necessariamente parte imaginária na forma ? ± ?? 
para ser bifurcação Hopf. Neste caso, o equilíbrio é estável para ? &amp;lt;0 e instável para ? &gt;
0, ou seja, existe uma perda de estabilidade em ? = 0, mas não se tem mudança de 
estabilidade dentro do espaço de equilíbrio. Na Figura 2.3, variando ?, as órbitas formam 
um ramo o qual se mescla ? = 0 com o ramo de equilíbrio. Nesse caso, perturbações no 
sistema induzem a formação de diferentes órbitas fechadas. 



8 Revisão Bibiliográfica 

 

 

 

Figura 2.3: Geração dos ciclos limites em  ? = 0 (plano de fase dependente do 
parâmetro). Adaptado de Seydel (2010). 

No exemplo, em ? = 0  existe uma mudança de estabilidade do equilíbrio estável para 
ciclo limite estável. O ciclo limite cerca o equilíbrio instável. A Figura 2.4 ilustra como o 
comportamento temporal da variável de estado muda com o parâmetro de bifurcação. 
Apenas estados estáveis são mostrados. A figura deixa evidente o aumento da amplitude 
das órbitas periódicas com a variação do parâmetro. Neste exemplo, a Jacobiana avaliada 
no ponto Hopf possui um par de autovalores imaginários. 

 

Figura 2.4:  Geração de ciclos climites no ponto Hopf; dependência do tempo e do 
parâmetro. Adaptado de Seydel (2010). 

O Teorema de Hopf (1942) apresenta três condições que devem ser satisfeitas para se 
ter a bifurcação Hopf, conforme a seguir: 

(1) ?(?0,  ?0) = 0; 

(2) 
??

??
(?0,  ?0) possui um simples par de autovalores imaginários ?(?0) = ±?? e nenhum 

autovalor com parte real zero; 



2.3 A bifurcação Hopf 9 

 

(3)
?(???( ?0))

??
? 0 

A origem dos ciclos limites ocorre em (?0,  ?0). O período inicial (oscilação de zero 
amplitude) é: 

 ?0 =
2?

?
 (2.4) 

onde ? é a variável de estado, ? é o parâmetro de bifurcação, ? são os autovalores nos 
pontos de operação ?0 e  ?0 e ? é a contribuição imaginária dos autovalores. 

A Figura 2.5 ilustra o comportamento dos autovalores no plano complexo quando 
existe bifurcação Hopf para o exemplo da produção de petróleo. 

 

Figura 2.5: Plano complexo dos autovalores; caminho dos autovalores relacionados à 
bifurcação Hopf em relação à abertura da válvula choke na produção de petróleo. 

Adaptado de Gerevini (2017). 

A Figura 2.5 mostra que o caminho dos autovalores satisfazem ?(?0) = ±?? , 
lembrando que a hipótese (3) do teorema de Hopf é responsável pelo cruzamento 
transversal do eixo imaginário. Quando a parte real dos autovalores é negativa, a solução 



10 Revisão Bibiliográfica 

 

 

tende a convergir para uma solução, conforme as aberturas da válvula choke de 3% e 4%. 
A bifurfação Hopf ocorre quando os autovalores cruzam o eixo real, ou seja, possuem parte 
real igual a zero, onde a solução possui oscilações de frequência e amplitude constante, 
segundo abertura da válvula choke de 5%. Já quando a parte real dos autovalores é positiva, 
as oscilações tendem a aumentar a frequência ou a amplitude, conforme aberturas da 
válvula choke de 10% e 25%. 

O ciclo limite existe, portanto, quando os autovalores complexos têm a sua parte real 
diferente de zero com a parte imaginária conjugada. Nesse caso, a parte real dos 
autovalores pode estar localizada à direita ou à esquerda, conquanto que esteja próxima 
do eixo imaginário. O ponto Hopf se dá, portanto, quando o autovalor real é zero, e existe 
parte imaginária conjugada. 

Quanto à estabilidade do ponto Hopf, a bifurcação supercrítica ocorre quando órbitas 
estáveis circulam o equilíbrio instável (conforme primeira linha da Figura 2.6), enquanto na 
bifurcação subcrítica órbitas periódicas instáveis circulam o equilíbrio estável (segunda 
linha da Figura 2.6). No caso da terceira linha da figura, um autovalor cruza o eixo 
imaginário transversalmente, de modo que a bifurcação Hopf se torna uma ramificação 
para órbitas periódicas instáveis, não importando a direção. 

 

Figura 2.6: Comportamento de estabilidade local de bifurcações Hopf.  
Adaptado de Seydel (2010). 



2.4 Métodos para estimação de parâmetros em modelos com bifurcação Hopf 11 

 

2.4 Métodos para estimação de parâmetros em modelos com 
bifurcação Hopf 

Conforme mencionado na seção 2.1, muitos trabalhos reportam a presença de 
oscilações principalmente em processos de fermentação (DAUGULIS; MCLELLAN; LI, 1997; 
JÖBSES et al., 1986; MCLELLAN; DAUGULIS; LI, 1999; WANG et al., 2014), reatores químicos 
(OURIQUE; BISCAIA; PINTO, 2002) e na produção de petróleo (DIEHL et al., 2017; MEGLIO; 
KAASA; PETIT, 2009). No entanto, a estimação de parâmetros nesses modelos com ciclo 
limite é difícil, já que o comportamento oscilatório associado aos sistemas com ciclo limite, 
tende a atrapalhar a convergência do problema de otimização associado.  

Alguns métodos para estimação de parâmetros em modelos com ciclo limite vêm sendo 
abordados na literatura. Dentre os trabalhos, Guckenheimer et al. (1997) propuseram dois 
novos métodos que dependem da ampliação da condição de equilíbrio para que a 
bifurcação Hopf ocorra em um ponto regular e isolado do sistema estendido. Esses novos 
métodos são baseados em resultados clássicos algébricos em relação às raízes das 
equações polinomiais e propriedades do produto Kronecker para matrizes. A vantagem 
deste método é que ele permite a estimação dos parâmetros que correpondem ao ponto 
Hopf sem a necessidade de avaliar os autovalores da matriz Jacobiana. Entretanto, como 
esse método utiliza a soma dos produtos Kronecker, ele envolve a solução de matrizes de 
dimensão quadrada, que é praticamente impraticável para aplicações em larga-escala 
devido às dimensões da matriz gerada pelo produto de Kronecker. Assim, o método só se 
torna eficiente quando bons chutes iniciais estiverem disponíveis para o parâmetro e se o 
autovalor for puramente imaginário. 

 Meerbergen &amp;amp; Spence (2010) propuseram um método para obter bons chutes iniciais 
para o método de Guckenheimer et al. (1997), baseado em encontrar os autovalores 
imaginários de um problema de dois parâmetros para autovalores, os quais advém de um 
processo de linearização. Esse problema é reformulado como um método de iteração 
inexato inverso que requer a solução de uma sequência de equações de Lyapunov com um 
baixo rank no lado direito. Elman et al. (2012) refinaram o método de iteração inversa a fim 
de torná-lo mais robusto e eficiente. Neste caso o algoritmo proposto pertence à classe de 
métodos iterativos interna-externa, onde a iteração externa é inversa para o problema 
especial de autovalores, e o problema interno se resume em resolver uma equação de 
Lyapunov. Baseando-se na teoria existente de métodos de iteração interna-externa, as 
equações de Lyapunov não necessitam ser resolvidas com alta precisão; ao invés disso, uma 
tolerância suave é o suficiente.  

Uma abordagem diferente foi proposta por Cedersund &amp;amp; Knudsen (2005), os quais 
mostraram como o conhecimento da bifurcação Hopf pode ser reformulado em um 
problema de otimização não-linear com restrições através da adição de n novos 
parâmetros descrevendo o ponto fixo correspondente à estimativa dos atuais parâmetros. 
Isso permite a introdução de n+1 novas restrições, e o resultado é que o espaço de busca 
é reduzido a um grau de liberdade. O preço para a redução é que mais métodos avançados 
de otimização podem ser utilizados. Devido ao comportamento da restrição, os métodos 
de otimização utilizados devem garantir que os parâmetros estimados nunca cheguem 
longe demais da região possível, e por isso, indica-se a utilização dos métodos de 
eliminação e métodos de gradientes reduzidos. 



12 Revisão Bibiliográfica 

 

 

A estimação de parâmetros para modelos com bifurcação Hopf também foram 
estudados por Hynne et al. (1993) e Hynne et al. (2001), mas eles eram focados na avaliação 
algébrica de modelos, não incluindo o uso de séries temporais coletadas durante a fase de 
estimação. Cedersund &amp;amp; Knudsen (2005) contribuíram com um método de identificação 
que inclui o conhecimento da localização da bifurcação Hopf em um algoritmo de 
otimização que usa toda a série temporal durante a simulação. Esse método é realizado 
utizando uma sobre-parametrização no problema original, onde é permitida a adição de 
restrições extras, levando à redução do espaço de busca.   

Ainda que os métodos apresentados anteriormente se mostrem teoricamente 
eficientes, quando se trata da modelagem de sistemas reais com bifurcação Hopf, eles são 
de difícil aplicação prática. Isso porque eles são demasiadamente complexos, em termos 
matemáticos, de modo que, dependendo da dimensão do sistema, número de parâmetros 
a serem estimados e da qualidade dos dados experimentais disponíveis, o problema de 
otimização associado à estimação se torna computacionalmente impraticável.  Neste 
contexto, a abordagem mais difundida para detecção de bifurcação Hopf consiste no 
método descrito por Govaerts (2000). Esse método é muito utilizado pelos softwares 
tradicionais para análise de bifurcação em modelos dinâmicos, tais como MatCont 
(DHOOGE; GOVAERTS; KUZNETSOV, 2003) e PyDsTool (CLEWLEY, 2012). Baseando-se neste 
critério, o método considera que, como na bifurcação Hopf existem autovalores complexos 
cruzando o eixo imaginário, a seguinte igualdade pode ser escrita: 

 ?? = ?? (2.5) 

onde ? é a Jacobiana em seu ponto de equilíbrio e ? são os autovalores associados ao 
autovetor ?. Neste caso onde se tem um problema de bifurcação Hopf, os autovalores 
possuem apenas a contribuição imaginária, de modo que 

 ? = ?? (2.6) 

onde ? é o termo de contribuição imaginária do autovalor. 

A fim de multiplicar a matriz que possui autovalores complexos, é utilizado o produto 
bialternado ?  (GOVAERTS; SIJNAVE, 1999), e para evitar o determinante de matrizes 
singulares se tem o métodos de matrizes delimitadas ???? (WERNER, 1996) 

 ????(2????) = 0 (2.7) 

onde ?? é a matriz identidade de tamanho n. Segundo o autor, a igualdade apresentada 
pela Equação 2.9 garante a existência de  um ponto de bifurcação Hopf no sistema. 

O produto bialternado de 2????, segundo Govaerts &amp;amp; Sijnave (1999), pode ser obtido 
explicitamente da seguinte forma: 



2.4 Métodos para estimação de parâmetros em modelos com bifurcação Hopf 13 

 

 (2????)(?,?),(?,?) =

{
 
 

 
 
????                   ?? ? = ?,                 
???                     ?? ? ? ? ? ? = ?,
??? + ???           ?? ? = ? ? ? = ?,

?
???                      ?? ? = ? ? ? ? ?,    
???                   ?? ? = ?,                   
0                     ?????                       

                (2.8) 

Já a matriz delimitada ???? de 2????, conforme Werner (1996), é dada por 

 (
? ?
?? ?

)(
?
?
) = (

0
1
) (2.9) 

onde as variáveis para resolução desse problema são dadas na Tabela 2.1. 

 
Tabela 2.1:  Variáveis para resolução da matriz delimitada ????. 

?(?,?) 2???? 

? Matriz U da decomposição em valores singulares de A 
? Matriz V da decomposição em valores singulares de A 
? Máximo entre m e n 
? Corank de A 
? ? ? ? + ? 
? ? ? ? + ? 
? 0(?,?) 

? Número de linhas da matriz ? 
? Número de colunas da matriz ? 
? Número de linhas da matriz ?? 
? Número de colunas da matriz ?? 
? Resultado da fatoração LU do sistema dada pela Equação 2.10 

? = ???? ?[?1 ? ?: , : ] 
 

 

 

 

 

 

 

 



 
 

  14 

 Metodologia 

Neste trabalho foi desenvolvida uma metodologia para a detecção do ciclo limite, que 
é baseada no conceito do fator de amortecimento de sistema de segunda ordem, oriundo 
da teoria de funções de transferência, e na utilização de uma modificação do método de 
penalidade exata para otimização com restrições. Todas as implementações foram 
realizadas em linguagem Python, pois além de ser um software livre, suporta a instalação 
de pacotes com diferentes ferramentas numéricas e de otimização. Para a simulação dos 
modelos dinâmicos foi utilizada a plataforma livre JModelica (ÅKESSON et al., 2010), que é 
uma extensão da linguagem Modelica para a otimização, simulação e análise de sistemas 
dinâmicos complexos. O JModelica integra as ODE/DAE utilizando o SUNDIALS (SUite of 
Nonlinear and DIfferencial/Algebraic equation Solvers) para o solver CVode, e o RADAU5 
(HAIRER; WANNER, 1987) para o solver Radau5DAE, sendo esses os principais solvers 
utilizados neste trabalho.  Esta plataforma foi desenvolvida para ser incorporada ao 
ambiente Python, juntamente com outros pacotes que possibilitam o tratamento de dados, 
otimização do modelo e visualização dos dados.  

Para toda a metodologia apresentada neste trabalho, considera-se que todos os 
modelos possuem equações que são funções de seus estados ??, de suas entradas ??, e de 
seus parâmetros ?? (sendo o parâmetro de bifurcação ? um deles), de modo que as saídas 
são ??,  conforme Equação 3.1. 

 ?(??,??;??) = ?? (3.1) 

3.1 Critério ?-Hopf 

O fator de amortecimento é uma medida adimensional que descreve como a amplitude 
das oscilações em um sistema decaem após o mesmo ser perturbado. Usualmente esse 
parâmetro é denotado pela letra grega ? (zeta). Na teoria de controle, o fator de 
amortecimento caracteriza o grau de oscilação da resposta de uma função de transferência 
de segunda ordem cujo o denominador consiste no seguinte polinômio de segunda ordem: 

 ?2?2 + 2??? + 1 (3.2) 



3.1 Critério ?-Hopf 15 

 
Neste trabalho é considerado que o ciclo limite pode aparecer desde o caso 

subamortecido (?&amp;lt;1), onde a solução decai exponencialmente, até o ponto Hopf, que é 
equivalente ao caso não-amortecido (? ? 0). Neste caso, quanto mais próximo de zero 
estiver o valor de ?, maior a possibilidade de o sistema gerar uma resposta oscilatória. Ou 
seja, o ponto Hopf é o caso em que ? = 0, enquanto o ciclo limite abrange este ponto e os 
demais que ficam na proximidade de ? ? 0, possuindo oscilações constantes, crescentes 
ou decrescentes. Considera-se que as suas raízes (ou polos) são encontradas utilizando a 
fórmula quadrática da Equação 3.2: 

 ?i =
?2??±?4?2?2?4?2

2?2
  ?  ?

?

?
±
??2?1

?
   (3.3) 

Como é considerado o caso subamortecido, onde o ciclo limite pode aparecer entre 0 
&amp;lt;? &amp;lt;1, são obtidos dois complexos conjugados: 

 ?i = ?
?

?
+ ?

?(1??2)

?
 (3.4) 

no qual as partes real (?) e imaginária (?) são escritas, respectivamente como: 

  ? = ?
?

?
,     (3.5) 

 ? =
?(1??2)

?
 (3.6) 

Portanto, a partir da razão entre o termo imaginário e o termo real do polo é obtido o 
parâmetro ?: 

 ? = ?
1

1+(
?

?
)
2 = ?

?2

?2+?2
 (3.7) 

Quando se lineariza um sistema de equações diferenciais utilizando a matriz Jacobiana, 
o número de autovalores é equivalente à dimensão desssa matriz (ou ao número das 
variáveis de estado). Portanto, para um sistema com mais de quatro equações diferenciais, 
para um problema com ciclo limite, dificilmente existem dois pares de autovalores 
conjugados. O que é mais comum acontecer é a troca da posição desses pares de 
autovalores conjugados, sendo o cálculo do parâmetro ? realizado com o par mencionado.  

Da Equação 3.7 é possível determinar o grau de oscilação do sistema em um 
determinado ponto, indo desde o caso menos oscilatório/mais amortecido (? ? 1), até o 
caso mais oscilatório (ponto Hopf ? ? 0) a partir dos autovalores da matriz Jacobiana. Para 
essa medida é utilizada a informação dos autovalores no seu ponto estacionário, obtida 
através da linearização do modelo em cada estado ? no sistema de ? equações: 

 ??(?) = 0 (3.8) 

ou seja, a Jacobiana é avaliada no seu ponto de equilíbrio  

 ?(??) = (

??1

??1
(?1

?,??
?)

??1

???
(?1

?,??
?)

???

??1
(?1

?,??
?)

???

???
(?1

?,??
?)
) (3.9) 



16 Metodologia 

 

 

onde ? é a Jacobiana e ??é o valor do estado estacionário. 

Como a solução de um problema com ciclo limite é oscilatória, a determinação de seu 
ponto estacionário não é direta, assim como no caso de um sistema amortecido. Dessa 
forma será utilizada a determinação de pontos estacionários definida por Seydel (2010). 

 
??1

??
= 0,   

???

??
= 0. (3.10) 

No ponto de equilíbrio o sistema está em repouso: soluções no equilíbrio são soluções 
constantes. Esses pontos (?1

?,?n
?) são também denominados soluções estacionárias, que 

são as soluções do sistema de equação dadas pelo lado direito das equações diferenciais.  

 ?1(?1
?,?n

?) = 0,?n(?1
?,?n

?) = 0 (3.11) 

Para modelos simples, geralmente é possível determinar as raízes das equações, ou 
seja, os valores das variáveis de estado no estacionário, utilizando o método de Newton. 
No entanto, para modelos mais complexos, é adequado a formulação de um problema de 
otimização que visa minimizar os resíduos quadraticamente somados das respectivas 
equações, o qual pode ser resolvido através de métodos baseados em aproximações 
lineares, tais como o BOBYQA (Bound Optimization BY Quadratic Approximation) e o 
COBYLA (Constrained Optimization BY Linear Approximation). Como a penalidade oferece 
apenas um “direcionador” da região Hopf, é possível fazer uma aproximação do estado 
estacionário simulando o modelo para o dado conjunto de parâmetros e avaliando: 

 ??
? =

(??,???
? +??,???

? )

2
 (3.12) 

O modelo linearizado pode ser obtido através do cálculo da Jacobiana simbólica 
utilizando o pacote SymPy, que é um pacote para matemática simbólica. Outra forma que 
pode ser empregada quando se tem modelos mais complexos e/ou ordem maior do que 
quatro, consiste no cálculo da Jacobiana numericamente através do pacote Numdifftools 
(D’ERRICO, 2006), que resolve problemas de diferenciações numéricas em uma ou mais 
variáveis.  

3.2 Adaptação do método de penalidade exata  

O método da penalidade exata é uma técnica para a solução de problemas de 
otimização com restrição (NOCEDAL; WRIGHT, 2006) da forma: 

 min
?
 ?(??,??;??)  (3.13) 

 ?.?.  ??(?
?,??;??) (3.14) 

onde ?(??,??;??) é a função objetivo original do problema (mínimos quadrados, no caso 
deste trabalho) e ??(?

?,??;??)  é a sua restrição no estado estacionário ?
? , com as 

entradas ?? e no valor do parâmetro ??. Este método é capaz de substituir a utilização de 
restrições em um problema de programação não-linear, incorporando-as na função 
objetivo na forma de uma penalidade, de modo que para certas escolhas de parâmetros de 



3.2 Adaptação do método de penalidade exata 17 

 
penalidade, a minimização pode levar a solução exata do problema. A função objetivo de 
um problema com penalidade exata, conforme Equações 3.13 e 3.14 pode ser escrita como: 

 min
?
 ?(??,??;??) + ?? |??(?

?,??;??)|???  (3.15) 

onde ? é o parâmetro de penalidade. Este parâmetro de penalidade deve ser atualizado à  
medida que o problema se aproxima da solução.  Nocedal &amp;amp; Wright (2006) apresentam um 
algoritmo para a avaliação de um problema clássico de penalidade exata: 

Dado ?0 &gt; 0, tolerância ??? &gt; 0, ponto inicial ??; 

Para ? = 0,1,2,… 

Encontrar um minimizador ?? aproximado de ????(?
?,??;??,?k), começando em ??; 

Se |??(?
?,??)| ? ??? 

 Parar com a solução aproximada ??; 

Fim (se) 

Escolher um novo parâmetro de penalidade ?k+1 &gt; ?k; 

Escolher um novo ponto de partida ??+1; 

Fim (para) 

Usualmente o esquema mais simples para atualizar o parâmetro ?k  consiste na 
multiplicação deste por um múltiplo contante (por exemplo, 5 ou 10). Para o caso da  
metodologia proposta, o primeiro loop inicia com um valor de parâmetro de penalidade 
elevado  (?0 = 1 × 10

4 até 1 × 1012) multiplicado ao valor de ?, a fim de direcionar o 
primeiro passo da otimização para um conjunto de parâmetros que leve a uma solução com 
ciclo limite. Diferentemente do algoritmo de penalidade exata apresentado por Nocedal &amp;amp; 
Wright (2006), a escolha do próximo parâmetro de penalidade é obrigatoriamente menor 
ou igual ao anterior. 

 ?k+1 ? ?k (3.16) 

Assim, na metodologia proposta neste trabalho, o valor do parâmetro de penalidade é 
atualizado através da multiplicação do parâmetro de penalidade anterior pelo fator de 
amortecimento determinado pela equação 3.7. 

 ?k+1 = ? ? ?k . (3.17) 

Desta forma, ?k+1 pode se manter igual se a solução for amortecida (? ? 1), ou pode 
diminuir à medida que a solução se torna mais oscilatória (? ? 0), conforme Figura 3.1a. 
Considerando que no decorrer das iterações a solução já possui caráter oscilatório, a 
penalidade se aproxima de zero à medida que os parâmetros se aproximam da região de 
Hopf (Figura 3.1b). Deste ponto em diante o termo dos mínimos quadrados (?(??,??;??)) 
passa a ser o que possui o maior peso na função objetivo, ajustando a aderência do modelo 
aos dados experimentais. 



18 Metodologia 

 

 

a)      b)  

Figura 3.1: Comportamento da a) resposta da saída ? para diferentes valores de ? e b) 
penalidade ? ao longo das iterações na estimação de parâmetros. 

É importante observar que a utilização do conceito do fator de amortecimento resulta 
em um valor entre 0 e 1, que é capaz de ponderar de forma normalizada o grau de oscilação 
para dado conjunto de parâmetros. A vantagem em se utilizar a abordagem proposta, em 
relação a um método com restrição é que, apenas a utilização de uma restrição, 
considerando que ? = 0, não é o suficiente para a obtenção dos resultados esperados, uma 
vez que o ciclo limite não se encontra apenas nesse ponto. A utilização de uma restrição de 
desigualdade também não seria o mais adequado, pois apesar de se conhecer o limite 
inferior (? = 0), o limite superior é desconhecido. O ciclo limite pode existir, portanto, na 
proximidade ? ? 0, que pode ser encontrado utilizando o método da penalidade exata 
descrito neste item. Esta hipótese será abordada nos estudos de caso (Capítulo 4 e 5), onde 
este resultado fica evidente. 

3.3 Função objetivo 

A função objetivo é a responsável por direcionar o problema de otimização. No caso da 
estimação de parâmetros, a sua finalidade é avaliar o comportamento do modelo frente 
aos dados. Uma vez que a identificação de modelos fenomenológicos tem por objetivo 
gerar modelos representativos de sistemas reais, tal avaliação consiste em analisar a 
discrepância entre os valores dos estados reais medidos e dos estados simulados frente a 
um determinado conjunto de parâmetros (BOTELHO, 2012). 

A seguinte metodologia utiliza em sua função objetivo o termo de mínimos quadrados, 
que procura minimizar o quadrado dos erros/resíduos, adicionado ao termo de penalidade, 
conforme equação abaixo: 

 min
?
? (?? ? ?(??)?)

2??
?=1 + ??(??) (3.18) 

onde ?? representa as saídas medidas, ???? representa as saídas preditas pelo, ?? é o número 
de amostras disponíveis, ? é o parâmetro de penalidade e ? é o fator de amortecimento, e 
?? é o conjunto de parâmetros a ser estimado. 

Conforme descrito no item 3.1, o termo de penalidade é importante para a obtenção 
de soluções oscilatórias com ciclo limite. No primeiro passo é necessário o cálculo do 
estado estacionário para dado conjunto de parâmetros; a partir do modelo linearizado 
(Jacobiana) e dos valores das variáveis de estado no estacionário, são avaliados os 



3.4 Estimação dos parâmetros utilizando o método single-shooting 19 

 
autovalores do sistema para o conjunto de parâmetros atual. Por conseguinte, calcula-se a 
penalidade, dada pelo critério ?-Hopf multiplicado pelo parâmetro de penalidade ?. 

3.4 Estimação dos parâmetros utilizando o método single-
shooting 

A metodologia para a estimação dos parâmetros deste trabalho é baseada no método 
single-shooting (BIEGLER; GROSSMANN, 2004), o qual consiste um método sequencial 
onde dadas as condições iniciais e um conjunto de parâmetros, o modelo de equações 
diferenciais é integrado e resolvido em um loop interno, enquanto este conjunto de 
parâmetros é atualizado do lado externo do loop utilizando um algoritmo de otimização. O 
método single-shooting é adequado para esta metodologia, pois a cada passo da 
otimização é necessário atualizar o valor dos estado, da Jacobiana e do ?, sendo que tudo 
isso depende da simulação do modelo sob dadas condições e conjuntos de parâmetros 
fornecidos pelo otimizador. 

A sub-rotina desenvolvida para a estimação dos parâmetros foi baseada na utilização 
do pacote NLopt (JOHNSON, 2008), que é uma biblioteca livre para a otimização não-linear. 
Essa suporta otimizações em larga escala e contém diferentes algoritmos NLP. Para este 
trabalho foi utilizado o método COBYLA. Sua vantagem é que este solver não necessita do 
cálculo do gradiante da função objetivo sendo baseado em aproximações lineares da 
função objetivo e de cada restrição. Ele foi desenvolvido por Powell (1994), e em cada 
iteração uma aproximação do problema de programação linear é resolvido para se obter 
um canditado para a solução ótima. A solução candidata é avaliada utilizando a função 
objetivo original e as restrições, resultando em um novo ponto de dados no espaço de 
otimização. Essa informação é utilizada para melhorar a aproximação do problema de 
programação linear usado para a próxima iteração do algoritmo. Quando a solução não 
pode ser mais melhorada, o tamanho do passo é reduzido, refinando a busca. Quando o 
passo se torna suficientemente pequeno, o algoritmo termina. 

As Figuras 3.2 e 3.3 mostram um esquema simplificado de como é realizada a estimação 
de parâmetros com o método single-shooting para os estudos de caso deste trabalho, onde 
a Figura 3.2 exibe o loop externo e a Figura 3.3 o loop interno da metodologia. 

Conjunto de chutes 
iniciais para os 

parâmetros

Método single-
shooting

Parâmetro de 
penalidade inicial 

?start 

Início

Fim

Novo conjunto 
de parâmetros

Sim

Melhor solução

Atualização do 
parâmetro de 

penalidade
?  = ? ?

NãoNão

 

Figura 3.2: Loop externo da metodologia proposta para a estimação dos parâmetros. 



20 Metodologia 

 

 

Conjunto de chutes iniciais 
para os parâmetros

Cálculo do estado estacionário

Modelo linearizado

Critério ?-Hopf

Autovalores

Início

Função objetivo

Fim

Conjunto de parâmetros 
estimados

Programação não-linear 

Melhor solução
Sim

Não

Integração do sistema de 
equações diferenciais

Novo conjunto de parâmetros

 

Figura 3.3: Loop interno da metodologia proposta para a estimação dos parâmetros.



 
 

  21 

 Estudo de caso 

Neste capítulo primeiramente são apresentadas as abordagens, incluindo a proposta, 
que têm como objetivo direcionar o problema de otimização a regiões com ciclo limite. O 
estudo de caso apresentado neste capítulo é o modelo proposto por  Jöbses et al. (1986), 
o qual representa a fermentação contínua da glicose com a bactéria Zymomonas mobilis. 
Nesse estudo de caso é realizada uma análise detalhada, onde são comparados os 
resultados de todas as abordagens mencionadas. 

4.1 Métricas para otimização 

4.1.1 Abordagens para a otimização do problema com ciclo limite 

A fim de comparar a metodologia proposta com as metodologias para estimação de 
parâmetros previamente discutidas, diferentes abordagens foram consideradas nos 
estudos de caso, as quais serão discutidas a seguir. 

? Abordagem 1. Método dos mínimos quadrados clássico sem restrições: 

O problema de otimização não possui nenhuma restrição, possuindo apenas o termo 
de mínimos quadrados: 

 min
?
? (?? ? ??(?)?)

2??
?=1  (4.1) 

? Abordagem 2. Inclusão do fator de amortecimento (?) como penalidade na função 
objetivo (metodologia proposta) 

O problema de otimização possui uma função de penalidade ? adicionada ao termo de 
mínimos quadrados, resultando na função objetivo da Equação 4.2, conforme descrito no 
no item 3.4. 

 min
?
? (?? ? ??(?)?)

2??
?=1 + ??

1

1+(
?

?
)
2 (4.2) 

? Abordagem 3. Com o valor real do autovalor (?) como penalidade  



22 Estudo de caso 

 

 

Considerando os autovalores do modelo linearizado 

 ? = ? ± ?? (4.3) 

onde ? é contribuição real e ? é a porção imaginária dos autovalores. O comportamento 
do ciclo limite requer autovalores complexos conjugados, conforme estudado no item 2.4, 
com a parte real igual a zero. Portanto, a penalidade advém da restrição de igualdade 

 ?? = ? (4.4) 

a qual é incorporada na função objetivo: 

 min
?
? (?? ? ??(?)?)

2??
?=1 + ? ? ? (4.5) 

? Abordagem 4. Inclusão do fator de amortecimento (?) como restrição 

O problema de otimização possui uma restrição de igualdade (Equação 4.7) associada 
ao fator de amortecimento: 

 min
?
? (?? ? ??(?)?)

2??
?=1  (4.6) 

 ?.?.  ?
1

1+(
?

?
)
2 = 0 (4.7) 

? Abordagem 5. Método de Govaerts (2000). Este método foi previamente apresentado 
na seção 2.4. Neste caso, o problema de otimização é dado por: 

 min
?
? (?? ? ??(?)?)

2??
?=1  (4.8) 

 ?.?.  ????(2????) (4.9) 

onde ???? é o método de matrizes delimitadas (WERNER, 1996), utilizado para evitar o 
determinante de matrizes singulares; ? é o produto bialternado (GOVAERTS; SIJNAVE, 
1999), que multiplica as matrizes quando elas possuem autovalores complexos; ?  é a 
Jacobiana no ponto de equilíbrio e ?? é a matriz identidade com tamanho ?. 

4.1.2 Avaliação numérica dos resultados 

A avaliação numérica dos resultados da otimização pode ser realizada através do erro 
quadrático e da variância. 

O erro quadrático médio (Mean Squared Error) da estimação de parâmetros é calculado 
utilizando as saídas medidas que aparecem na função objetivo, conforme demonstrado na 
Equação 4.10. 

 MSE =
1

n
? (???? ? ????(?))

2?
?=1  (4.10) 

onde ? é o número de pontos. 



4.1 Métricas para otimização 23 

 
 Já o cálculo da variância é dado por 
 

 ? = ?
(??????)

2

??1

?
?=0   (4.11) 

onde ?? é o cálculo da variável de saída no ponto ?, ??? é a média da variável de saída e ? é o 
número de pontos. Além do erro, foi escolhida a análise da variância, pois com seu 
resultado é possível verificar se o conjunto de dados possui oscilações ou não. Por exemplo, 
para casos com oscilações, a variância tende a ser elevada uma vez que o somatório da 
diferença entre os picos (ou vales) em relação à média é alto. Se o conjunto de dados não 
for oscilatório, a diferença entre a média e o ponto atual é baixa, então a variância é 
pequena.  

 Portanto, é avaliada a relação entre a variância simulada e a variância experimental 
para apenas uma das variáveis de saída: 

 

 ?? =
????

????
 (4.12) 

O objetivo de ?? é relacionar o valor da variância simulada e experimental, de modo 
que, como os dados de ???? são oscilatórios eles tendem a apresentar variância elevada.  

Dessa forma, a medida que ????  e ???? se tornam similiares, é provável que o modelo 

tenha capturado de forma satisfatória o comportamento oscilatório dos dados. Sendo 
assim, valores de ?? = 1  indicam que tais variâncias são iguais (Figura 4.1b). Para os 
estudos de caso deste trabalho, valores muito pequenos indicam baixa aderência ao 
comportamento oscilatório (Figura 4.1a) e valores muito elevados denotam que o 
comportamento oscilatório detectado é demasiadamente elevado (Figura 4.1c). 

 

a) b) c)  

Figura 4.1: Relação de variâncias entre os dados simulados e experimentais. 

4.1.3 Intervalo de confiança dos parâmetros 

O intervalo de ? % de confiança ao conjunto de resultados, segundo a curva de 
distribuição de probabilidades, concentra ? % dos resultados admissíveis. Portanto, 
são descartados os (100 ? ?)%   resultados menos prováveis (SCHWAAB; PINTO, 
2007). Para calcular o intervalo de confiança dos parâmetros estimados é calculada a 
matriz de covariância: 

 ?? = [

??1
2 ??2?1 ??1???

??1?2 ??2
2 ??2???

?????1 ?????2 ????
2

]  (4.13) 

onde ?? é o número de parâmetros do modelo e ?? são os parâmetros do modelo. Os 
elementos da diagonal são as variâncias de cada parâmetro ?, enquanto que os demais 
elementos são as covariâncias dos parâmetros ??. 



24 Estudo de caso 

 

 

Para modelos não-lineares a matriz covariância é obtida, de forma aproximada, da 
seguinte forma: 

 ?? = (?
???

?1?)?1  (4.14) 

onde ? é a matriz de sensibilidade dada por: 

 ? = 

[
 
 
 
 
 
 
 
??1

??1
|
?0

…
??1

????
|
?0

????

??1
|
?0

…
????

????
|
?0

??1

??1
|
??

…
??1

????
|
??

????

??1
|
??

…
????

????
|
??]
 
 
 
 
 
 
 

 (4.15) 

e ?? é o número de experimentos (número de saídas × número de pontos), ?0 é o tempo 
inicial, e ??  é o tempo final. Por não se conhecer a variância ?? , então considera-se a 

estimativa da variância experimental: 

 ?? ? ?
2 =

????

?????
  (4.16) 

onde ???? é o valor da função objetivo de mínimos quadrados. 

Assim, o intervalo de confiança é dado por 

 ?? = ?? ± ??? ??????
1??

  (4.17) 

no qual ?? é o valor estimado, ??? é o desvio padrão do parâmetro obtido através da matriz 

de covariância e ?? é a distribuição t-Student com ?? ? ?? graus de liberdade e um nível 
de confiança igual a 1 ? ?.  Para todos os estudos de caso é utilizado o intervalo de 
confiança de 95%. 

 

4.2 Modelo de Jöbses et al. (1986) 

O sistema proposto por Jöbses et al. (1986) representa a fermentação contínua da 
glicose com a bactéria Zymomonas mobilis, o qual é um modelo não-segregado e 
estruturado que divide a biomassa em dois compartimentos e introduz uma nova variável, 
o componente chave, que leva em consideração a influência da concentração de produto 
no meio reativo. Este modelo é caracterizado pela existência de multiplicidade de 
equilíbrios, bifurcação Hopf e mudança de estabilidade do sistema.  

4.2.1 Modelagem matemática 

O modelo dinâmico definido em Jöbses et al. (1986) é constituído por quatro estados: 
substrato (?), biomassa (?), produto (?) e o componente chave (?), os quais são dados 
pelas equações do balanço material (4.18) a (4.21): 



4.2 Modelo de Jöbses et al. (1986) 25 

 

 
???

??
= ???? (?

1

???
)(

????

??+??
) ? ???? + ??(??? ? ??) (4.18) 

 
???

??
= ???? (

????

??+??
) + ??(??? ? ??) (4.19) 

 
???

??
= ????(?1 ? ?2?? + ?3??

2)(
????

??+??
) + ??(??? ? ??) (4.20) 

 
???

??
= ???? (

1

???
)(

????

??+??
) + ???? + ??(??? ? ??) (4.21) 

onde ?? é a concentração do componente chave E (kg/m³), ?? é a concentração de produto 
(kg/m³), ??  é a produção de substrato (kg/m³) e ??  é a concentração de biomassa X 
(kg/m³). ??? é a concentração de substrato de alimentação (kg/m³) e ?? (h

-1) é a taxa de 

diluição.  Os demais termos referem-se aos parâmetros do modelo conforme descrito na 
Tabela 4.11. 

O consumo de substrato por microorganismos e a a taxa de crescimento de biomassa 
podem ser respectivamente expressos por: 

 ?? = (
1

???
)?? + ???? (4.22) 

 ?? = ???? (4.23) 

A taxa de formação de e leva em consideração a concentração de substrato, produto e 
do componente chave “e”: 

 ?? = ?(??)?(??)?? (4.24) 

A relação entre a concentração de substrato e a taxa de crescimento específico é dada 
pela equação de Monod, onde ?? é a constante de Monod e ???? é a taxa específica de 
crescimento máxima. 

 ?(??) = ???? (
??

??+??
) (4.25) 

A função ?(??) é dada pela relação de Monod e ?(??) é um polinômio que advém dos 

dados experimentais, fornecido por: 

 ?(??) = ?1 ? ?2?? + ?3(??)
2 (4.26) 

Na Tabela 4.1 são mostrados os parâmetros do modelo Jöbses et al. (1986), seus valores 
e suas respectivas unidades. 

 

 

 

 



26 Estudo de caso 

 

 

Tabela 4.1:  Valores originais para os parâmetros do modelo de Jöbses et al. (1986). 

Parâmetro Valor Unidade 

???- Concentração de alimentação da biomassa E 0 kg/m³ 

???- Concentração de alimentação do produto 0 kg/m³ 

???- Concentração de alimentação de biomassa 0 kg/m³ 

?? – Taxa de diluição 0,07 h
-1 

?? – Constante de Monod 0,5 kg/m³ 

?1 – Constante da taxa de reação 16,0 h
-1 

?2 – Constante da taxa de reação 0,497 m³/kg h 

?3 – Constante da taxa de reação 0,00383 m
6/kg2 h 

?? – Fator de manutenção baseado na formação 
de substrato 

2,16 kg/kg h 

???? – taxa específica de crescimento máxima 1 h
-1 

?? – Fator de manutenção baseado na formação 

de produto 

- kg/kg h 

??? – Fator de redimento da conversão de 
substrato em biomassa 

- kg/kg 

??? – Fator de rendimento da conversão de 
biomassa em produto 

- kg/kg 
 

 

Sendo que as condições iniciais da simulação são ?? = 80,67 kg/m
3, ?? = 1,47 kg/m

3, ?? 
= 0,08 kg/m3 e ?? = 58,08 kg/m

3. 

4.2.2 Cenários 

Para avaliar as metodologias apresentadas neste trabalho, simulações do modelo de 
Jöbses et al. (1986) foram realizadas considerando uma série de cenários previamente 
definidos. Para isso, inicialmente os parâmetros  ??, ??? e ???  foram selecionados para 

serem estimados, a partir do método de análise de identificabilidade proposto por Botelho 
et al. (2012).  

Modificações nos valores originais dos parâmetros selecionados foram realizadas a fim 
de que o comportamento de bifurcação Hopf fosse atingido. Para isso os cenários foram 
estruturados considerando os diagramas de bifurcação do fator de manutenção baseado 
na formação de produto (??) e no fator de rendimento da conversão de biomassa em 

produto (???), enquanto o fator de rendimento da conversão de substrato em biomassa 
( ???) foi mantido constante em 0,02339905. Dados “experimentais” foram gerados 
considerando estes valores de parâmetros (sendo os demais mantidos de acordo com a 
Tabela 4.1). Em seguida, desvios nos seus valores foram realizados, sendo estes usados 
como chutes iniciais na etapa de estimação. A Tabela 4.2 apresenta os valores dos 
parâmetros usados para a geração dos dados bem como os chutes iniciais para a estimação. 

 



4.2 Modelo de Jöbses et al. (1986) 27 

 
Tabela 4.2: Cenários para a simulação do modelo de Jöbses et al. (1986). 

Cenário 
Valores para geração 

dos dados 

Chute inicial 
para a 

estimação* 

A 

?? = 1,3 

??? = 0,06 
 

85% 

B 

?? = 1,4 

??? = 0,05 
 

60% 

C 
?? = 1,7 

??? = 0,045 
 

40% 

D 
?? = 1,55 

??? = 0,05 
60% 

* Em relação aos valores usados para a geração dos dados. 
 

Para a geração dos dados “experimentais” simulações do modelo foram realizadas 
considerando a configuração para os parâmetros previamente discutida. Além disso, a 
concentração de alimentação de substrato (??? ) foi perturbada conforme ilustrado na 
Figura 4.2. 

 

Figura 4.2: Perturbação na concentração de alimentação de substrato. 

Distúrbios não-medidos, i.e., que não foram levados em conta como entrada para a 
estimação dos parâmetros, foram adicionados à taxa de diluição em dois dos cenários 
propostos. Foi considerado um distúrbio no cenário B de acordo com a Figura 4.3a e um 
distúrbio no cenário C, conforme apresentado nas Figura 4.3b. 



28 Estudo de caso 

 

 

 

Figura 4.3: Distúrbios na taxa de diluição para o (a) cenário B e o (b) cenário C. 

Para a geração do cenário D, um erro estrutural no modelo foi adicionado. Neste caso 
a Equação 4.20 do modelo de Jöbses et al. (1986) é substituída pela Equação 4.27. Cabe 
salientar que esta modificação foi realizada apenas para a geração de dados considerados 
como sendo experimentais:  

 
???

??
=

??????(?1??2??+?3??
2)

(??+1)
(
????

??+??
) + ??(??? ? ??)  (4.27) 

Embora o modelo de Jöbses et al. (1986) tenha quatro variáveis de estado 

(??,??,??,??) , apenas duas variáveis de saída são consideradas medidas (??,??)  no 

problema de mínimos quadrados, uma vez que essas são as medidas mais factíveis de 
serem medidas em um processo de fermentação real. A estas saídas um ruído branco com 
magnitude de 5% em relação aos estados foi adicionado em todos os cenários na geração 
dos dados experimentais. 

Utilizando os dados gerados em cada cenário, os parâmetros ?? , ???  e ???  foram 

estimados de acordo com as abordagens descritas na seção 4.1. Em cada caso o chute inicial 
para os parâmetros foi conforme a Tabela 4.2. 

4.2.3 Análise da função objetivo 

Uma análise preliminar considerando os valores da função objetivo em função dos 
parâmetros ???  e ??, que são os mais sensíveis em relação ao ciclo limite, para as as 

abordagens 1 e 2 e cenário A (i.e., mínimos quadrados clássicos e fator de amortecimento 
como penalidade) foi realizada. Os resultados são ilustrados na Figura 4.4: 



4.2 Modelo de Jöbses et al. (1986) 29 

 

a) b)  

c) d)  

Figura 4.4: Gráfico da função objetivo do modelo de Jöbses et al. (1986) (a) abordagem 1: 
mínimos quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade 

para (b) ? = 5?3, (c) ? = 1?4 e (d) ? = 1,5?4. 

A Figura 4.4a mostra que, quando a estimação de parâmetros é realizada considerando 
apenas o método de mínimos quadrados, o problema é altamente não-convexo, de modo 
que existem vários mínimos locais próximos ao mínimo global. Isto implica que um chute 
inicial distante do valor correto para os parâmetros pode levar a uma solução distante do 
ótimo global. No entanto, quando a metodologia sugerida neste trabalho é utilizada (Figura 
4.4c) com um valor de parâmetro de penalidade suficientemente alto a não-convexidade 
do problema, dependendo do valor de ? , é eliminada ou pelo menos reduzida. É 
importante destacar que o parâmetro de penalidade após um certo valor não influencia 
mais na convexidade da função objetivo. 

Dessa forma a vantagem da metodologia proposta é que mesmo para um chute inicial 
distante, o conjunto de parâmetros converge para valores que levam a simulação para 
próximo da região com ciclo limite (? ? 0)  e enquanto ?  está próximo de zero, a 
atualização do parâmetro de penalidade ?  resulta em um valor muito pequeno, 
praticamente desconsiderando a penalidade. Então, com os próximos passos iniciando 
apenas com o termo de mínimos quadrados na função objetivo, e com um bom chute inicial 
para o comportamento de ciclo limite, o solver pode ajustar o modelo aos dados 
experimentais mais adequadamente. 



30 Estudo de caso 

 

 

4.2.4 Resultados e discussão 

Os resultados para a estimação de parâmetros do modelo de Jöbses et al. (1986) para 
os cenários A, B, C e D são mostrados na Tabela 4.3 como o erro quadrático médio (???) 
das variáveis de estado ?? e ??, variância (??) da variável ?? e tempo de otimização (????) 

dado em minutos. 

 Tabela 4.3: Resultados dos erros quadráticos do modelo de Jöbses et al. (1986) para 
todos os cenários e seus respectivos casos. 

Cenário 

Abor A B C D 

??? ?? ???? ??? ?? ???? ??? ?? ???? ??? ?? ???? 

1 2,08  0,11 0,8 0,45 0,09 1,0 0,66 0,12 1,7 0,67 0,08 1,6 

2 0,38 1,00 11 0,05 1,00 3,0 0,07 1,03 28 0,35 1,10 24 

3 1,93 0,77 32 0,51 1,78 73 0,71 0,40 51 0,34 1,04 73 

4 2,58 0,82 1,3 1,70 4,48 1,5 0,78 1,44 3,4 0,80 0,64 1,8 

5 2,02 0,31 1,7 1897 514 1,6 12,0 0,37 1,5 1300 204 1,5 

 

Conforme apresentado na Tabela 4.3, os melhores resultados para os erros 
quadráticos, ou seja, os valores mais baixos são dados pela abordagem 2, seguido da 
abordagem 1. Em relação à variância, as abordagens 2, 3 e 4 e são as que indicam 
numericamente a presença de oscilações (ou seja, valores próximos ou maiores do que 
um), enquanto a abordagem 1 é a que possui valores mais próximo de zero, indicando que 
essa pode ser incapaz de representar o comportamento oscilatório de forma similar aos 
dados. Já a abordagem 5 foi a que apresentou valores da variância muito pequenos ou 
muito grandes (dados muito defasados em relação a sua média). Ademais, destaca-se que 
a abordagem 2 possui valores da variância muito próximos a um, o que pode indicar que 
além dos dados serem oscilatórios, eles podem ter aderência aos dados experimentais. 

A fim de analisar o comportamento do modelo utilizando o conjunto de parâmetros 
obtidos através das abordagens 1 e 2, são apresentados os resultados da simulação do 
modelo com os  parâmetros estimados para o modelo de Jöbses et al. (1986) para os 
cenários A, B, C e D, nas Figuras 4.5, 4.6, 4.7 e 4.8, respectivamente. 



4.2 Modelo de Jöbses et al. (1986) 31 

 

 

 

 

Figura 4.5: Cenário A do modelo de Jöbses et al. (1986) (a) abordagem 1: sem penalidade 
e b) abordagem 2: com penalidade ?.  Os “dados experimentais” são representados pela 

linha pontilhada azul e os dados estimados pela linha sólida vermelha. 

 

 

 

Figura 4.6: Cenário B do modelo de Jöbses et al. (1986) (a) abordagem 1: sem penalidade 
e b) abordagem 2: com penalidade ?. Os “dados experimentais” são representados pela 

linha pontilhada azul e os dados estimados pela linha sólida vermelha. 

 

 

 

Figura 4.7: Cenário C do modelo de Jöbses et al. (1986) (a) abordagem 1: sem penalidade 
e b) abordagem 2: com penalidade ?. Os “dados experimentais” são representados pela 

linha pontilhada azul e os dados estimados pela linha sólida vermelha. 

 



32 Estudo de caso 

 

 

 

 

 

Figura 4.8:  Cenário D do modelo de Jöbses et al. (1986) (a) sem penalidade e (b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 

Para o caso sem penalidade (abordagem 1), o resultado alcança um conjunto de 
parâmetros que levam o sistema a um comportamento sem ciclo limite, visto que os 
estados simulados pelo modelo convergem para um valor estacionário. No entanto, para 
casos onde a penalidade ? é adicionada ao termo de mínimos quadrados, os resultados 
mostram o compartamento típico do ciclo limite. Mesmo para chutes iniciais relativamente 
ruins, como 40% do valor original, e com distúrbios na taxa de alimentação, a otimização 
alcança um bom conjunto de parâmetros.  

O tempo de otimização ( ???? ), dado em minutos na Tabela 4.3, mostra que as 

abordagens que utilizam penalidade são as que demandam mais tempo de otimização. Isso 
acontece pois são necessárias várias iterações do método single-shooting, conforme o 
método de penalidade exata, para finalizar a estimação. Enquanto isso, os outros métodos 
(incluindo com a presença das restrições) demoram muito menos tempo. Apesar da 
abordagem 2 demorar em média 16,5 minutos para otimizar, enquanto a abordagem 1 
demora apenas 1,3 minuto em média, ela é a que retorna os melhores resultados. 

Os valores dos parâmetros estimados e seus respectivos intervalos de confiança para 
cada cenário, utilizando a abordagem 2, são mostrados na Tabela 4.4. 

Tabela 4.4: Valores dos parâmetros estimados para todos os cenários do modelo de 
Jöbses et al. (1986) utilizando a abordagem 2. 

 Cenário 

Parâmetros A B C D 

?? (kg/kg h) 1,3413±0,000136 1,4037±0,000006 1,7220±0,002031 1.6870±0,000108 

??? (kg/kg) 0,0585±0,000182 0,0500±0,000007 0,0443±0,002672 0,0463±0,000179 

??? (kg/kg) 0,0222±0,005203 0,0233±0,002082 0,0228±0,075816 0,0204±0,004484 

  



4.2 Modelo de Jöbses et al. (1986) 33 

 
Apesar de a abordagem 2 ter obtido o melhor resultado dentre as demais, ela ainda não 

foi capaz de alcançar o valor exato dos parâmetros que geraram os dados simulados. Essas 
pequenas diferenças podem ser justificadas pelos ruídos e distúrbios não-medidos 
aplicados no modelo para a geração dos dados.  

Na Figura 4.9 são mostrados os planos de fase para os cenários A, B, C e D considerando 
os parâmetros ótimos determinados pela estimação de parâmetros. 

a)  

 

b)  

c)  

 

d)  

Figura 4.9: Planos de fase para os cenários A, B, C e D do modelo de Jöbses et al. (1986). 

4.2.5 Validação 

Com os modelos já identificados, é realizada uma etapa de validação, a qual consiste 
em verificar a capacidade de predição dos modelos obtidos considerando um novo 
conjunto de dados experimentais. Portanto, a qualidade do modelo pode ser verificada 
através da sua simulação, onde são obtidos dados sob diferentes condições operacionais 
com os parâmetros estimados através da etapa de estimação e esses são comparados com 
os dados obtidos através dos parâmetros originais.  

O modelo foi simulado para os cenários A, B, C e D utilizando a abordagem 2 com um 
distúrbio na taxa de diluição ?? conforme a Figura 4.10.  



34 Estudo de caso 

 

 

 

Figura 4.10: Distúrbio na taxa de diluição para a etapa de validação para o modelo de 
Jöbses et al. (1986). 

A Tabela 4.5 apresenta os resultados destas simulações para os subconjuntos de 
parâmetros estimados na etapa anterior sob condições experimentais diferentes, onde o 
erro quadrático médio das variáveis de estado ?? e ?? é dado por  ???, e a variância da 
variável ?? é dada por ??. 

Tabela 4.5: Resultados dos erros quadráticos e variâncias do modelo de Jöbses et al. 
(1986) para todos os cenários e abordagem 2. 

Cenário ??? ?? 

A 0,92 0,98 

B 0,12 0,86 

C 1,16 1,11 

D 2,31 2,07 

 

Através da Tabela 4.5 analisa-se que os maiores erros são dados pelos cenários C e D, 
enquanto que os valores de variância mais distantes de 1 são os dos cenários B e D. Com o 
objetivo de verificar o comportamento do modelo sob as condições de validação, são 
apresentadas as Figuras 4.11 e 4.12. 

 



4.2 Modelo de Jöbses et al. (1986) 35 

 

a)  

 

b)  

Figura 4.11:  Validação do modelo de Jöbses et al. (1986) para o (a) cenário A e (b) 
cenário B. Os dados “experimentais” são representados pela linha pontilhada azul e os 
dados estimados pela linha sólida vermelha. 

 

a)  

 

d)  

Figura 4.12: Validação do modelo de Jöbses et al. (1986) para o (a) cenário C e (b) cenário 
D. Os dados “experimentais” são representados pela linha pontilhada azul e os dados 

estimados pela linha sólida vermelha. 

Os cenários B e D mostram uma maior diferença modelo/experimental, pois possuem 
os chutes iniciais mais distantes do valor original, além da presença da discrepância 
paramétrica no último cenário. Apesar disso, constata-se que, de uma forma geral, o 
padrão de qualidade dos resultados se manteve em relação à etapa de estimação.



 
 

  36 

 Aplicação na produção de 
petróleo offshore 

Neste capítulo é estudada a aplicação da metodologia proposta na produção de 
petróleo offshore, uma vez que essa foi a principal motivação deste estudo. Existem vários 
trabalhos que abordam a modelagem dinâmica simplificada do fenômeno da golfada na 
produção de petróleo. Primeiramente é considerado o modelo simplificado de Meglio et 
al. (2009), que possui apenas três estados dinâmicos e representa apenas a região do 
sistema pipeline/riser. Em sequência, é abordado o modelo estendido de Diehl et al. (2017), 
com seis estados dinâmicos, que representa a dinâmica das regiões anular/tubing e 
pipeline/riser. Por fim se tem a aplicação no modelo FOWM, onde é realizada a estimação 
de parâmetros nesse modelo com os dados de planta de produção offshore de uma 
plataforma de petróleo nacional. 

5.1 Modelo de Meglio et al. (2009) 

Meglio et al. (2009) propuseram um modelo simples para representar o regime de fluxo 
das golfadas em tubos verticais, onde é considerado um fluxo unidimensional composto de 
uma fase líquida e uma fase gasosa compressível. Esse modelo pode ser aplicado a uma 
grande classe de sistemas, indo desde tubos verticais puros até geometrias mais 
complexas, como aquelas encontradas nas instalações de extração de petróleo submarinas 
reais. A fim de reproduzir os regimes periódicos característicos deste tipo de escoamento, 
foi introduzida uma válvula virtual localizada no fundo do tubo, o qual também traz 
conhecimento da física associada ao fenômeno das golfadas. 



5.1 Modelo de Meglio et al. (2009) 37 

 

 

Figura 5.1: Diagrama esquemático do sistema. Fonte: Meglio et al. (2009). 

5.1.1 Modelagem matemática 

O modelo é proposto considerando os princípios de balanço de massa, segundo a Figura 
5.1. Considera-se que o tubo contém três distintos volumes, dois deles são preenchidos 
com gás, e separados por uma válvula virtual horizontal, enquanto o último volume é 
preenchido com líquido. Esse esquema salienta a possível existência de uma interface de 
obstrução de líquido em um certo local no riser (tubo longo que conecta o reservatório às 
instalações da superfície para a produção de óleo), o qual é modelado por uma válvula 
virtual, impedindo o gás de fluir normalmente. Isso produz a formação de uma grande e 
alongada bolha atrás dessa interface. Nesta bolha alongada, a pressão acumulada ocorre e 
eventualmente gera instabilidades associadas às oscilações. As variáveis de estado são as 
massas de gás na bolha alongada (????), no riser (??,?), e da massa do líquido no riser 

(???). A conservação de massa leva a: 

 
????

??
= (1 ? ?)???? ? ??(?) (5.1) 

 
????

??
= ????? + ??(?) ? ?????(?) (5.2) 

 
????

??
= ???? ? ?????(?) (5.3) 

onde ????  e ?????  são as vazões mássicas de gás na entrada e na saída do riser, 

respectivamente; ???? e ?????são as vazões mássicas de líquido na entrada e na saída do 
riser, respectivamente e ?? é a vazão mássica de gás através do orifício da válvula virtual 

choke. O fluido petrolífero ao ser extraído alcança a cabeça do poço produtor com um 
elevado valor de pressão em função das características do reservatório ou do método de 
elevação artificial; neste ponto utiliza-se a válvula choke para quebrar a pressão do 
escoamento produzido e permitir o controle da vazão do poço produtor, harmonizando-a 
à pressão de trabalho dos equipamentos a jusante (“Escoamento em tubulações 
horizontais”, [s.d.]). Neste modelo, uma fração da vazão de gás flui diretamente até a parte 
superior do tubo, e o gás remanescente acumula na parte inferior do volume ???, causando 
o acúmulo da pressão.  



38 Aplicação na produção de petróleo offshore 

 

 

 Conforme mencionado anteriormente, os fluxos de gás (???? ) e líquido (???? ) são 

assumidos constantes. A massa de gás no riser é negligenciada, visto que representa uma 
quantidade muito pequena quando comparada à massa de líquido no tubo. No entanto, se 
???? é a massa total da vazão mássica através da produção da válvula choke então: 

 ??,??? =
???

???+???
???? ?

???

???
???? (5.4) 

 ??,??? =
???

???+???
???? ? ???? (5.5) 

As únicas modificações feitas no modelo de Meglio et al. (2009) foram as suavizações 
das equações de válvulas; elas são funções da queda de pressão sobre a válvula choke em 
consideração (real ou virtual). Meglio et al. (2009) também assumem que não há nenhum 
fluxo de volta através dessas válvulas, levando às seguintes expressões para os fluxos não-
constantes: 

 ?? = ??
(???????)+?(???????)

2+?

2
 (5.6) 

 ???? = ????????
(??????)+?(??????)

2+?

2
 (5.7) 

onde ??? é a pressão de gás na bolha alongada, ??? é a pressão do gás corrente abaixo da 
válvula choke, ??? é a pressão acima da choke de produção, e ?? é a pressão de separação. 
?? e ???? são constantes positivas. 

 As pressões no riser são dadas pela lei de gases ideais. O volume na bolha alongada ??? 
é assumido constante, onde o gás corrente abaixo da choke virtual é assumido como 
compressível. O seu volume ??? depende da massa do líquido nesta parte: 

 ??? = ?? ?
??,?

??
 (5.8) 

onde ?? é o volume do tubo. Além disso, supõe-se que a queda de pressão sobre o riser é 
dominada pela gravidade (fricção sendo negligenciada).  

 ??? =
??

????
??? (5.9) 

 ??? = ??? +
?????

?
(??? + ???????) (5.10) 

 ??? =
??

?(???
???+???????

??
)
??? (5.11) 

onde ??? é a pressão na bolha acumulada, ??? é a pressão à montante da válvula virtual, 
??? é a pressão no topo do riser, ? é a inclinição do riser, e ? é a área do corte transversal. 

Na Tabela 5.1 são mostrados os parâmetros do modelo de Meglio et al. (2009), seus 
valores e suas respectivas unidades. 



5.1 Modelo de Meglio et al. (2009) 39 

 
Tabela 5.1:  Parâmetros do modelo de Meglio et al. (2009). 

Parâmetro Valor Unidade 

?? – Densidade do líquido 900 kg/m³ 

?? – Pressão de separação 6,6e5 Pa 

? – Temperatura 363 K 

? – Massa molar do gás de elevação 0,022 kg/mol 

? – Inclinação do riser ?/4 rad 

? – Área do corte transversal 0,0177 m2 

? – Diâmetro do riser 0,15 m 

? – Comprimento do riser 5200 m 

??,????? – Massa minima de líquido no riser 37300 kg 

???? – Vazão mássica de gás entrando no riser 0,82 kg/s 

???? – Vazão mássica de líquido entrando no riser 11,75 kg/s 

?? – Coeficiente de fluxo da bolha alongada 1e-4 m
-1 

? – Fração de vazão de gás 0,78 - 

??? – Volume da bolha alongada 48,0 m³ 

???? – Coeficiente de fluxo da choke 2.8e-3 m
-1 

 

Onde as condições iniciais da simulação são ??? = 5413,2 kg, ???= 270,4 kg e ??? = 

4967 kg. 

5.1.2 Cenários 

Alguns dos parâmetros do modelo de Meglio et al. (2009) foram selecionados para 
serem estimados , sendo eles o ??, ?, ??? e ????. Essa seleção foi feita de acordo com um 

método de identificabilidade prática de Botelho et al. (2012). Os cenários foram 
estruturados mantendo os mesmos valores para os parâmetros conforme Tabela 5.1, 
modificando apenas o chute inicial de todos os parâmetros para a otimização. 

Tabela 5.2: Cenários para a simulação do modelo de Meglio et al. (2009). 

Cenário Chute 
inicial* 

A 50% 

B 40% 

C 110% 

D 50% 
* Relativo aos valores originais. 

 

O cenário D contém uma discrepância estrutural no modelo, onde as Equações (5.6) e 
(5.7) são substituídas pelas Equações (5.12) e (5.13) para a geração de dados 
experimentais, que são as versões não suavizadas dessas funções, originais do modelo de 
Meglio et al. (2009). 

 ?? = ??max (0,(??? ? ???)) (5.12) 



40 Aplicação na produção de petróleo offshore 

 

 

 ???? = ????????(??? ? ??) (5.13) 

Dados experimentais foram gerados a partir da simulação do modelo, considerando os 
valores originais apresentados na Tabela 5.1, considerando a abertura da choke constante 
e igual a 0,3%. Além disso, um ruído branco com magnitude de aproximada 5% dos valores 
de saída foi adicionado aos estados na geração dos dados experimentais. A partir dos dados 
gerados, a estimação dos parâmetros selecionados foi realizada considerando como chute 
inicial para otimização os valores descritos na Tabela 4.6.  

O modelo de Meglio et al. (2009) possui três variáveis de estado (????,???,???), que 

não possuem possibilidade de serem medidas na prática. Portanto, no problema de 
mínimos quadrados são consideradas apenas as medições das variáveis ??? e ???, uma vez 
que essas são medidas reais no processo.  

5.1.3 Análise da função objetivo 

Uma análise preliminar considerando os valores da função objetivo em função dos 
parâmetros ?, ???  para as as abordagens 1 e 2  (i.e., mínimos quadrados clássicos e fator 
de amortecimento como penalidade) foi realizada. Os resultados são ilustrados na Figura 
4.9. Dentre os parâmetros selecionados para a estimação, optou-se por estes para a 
realização da análise da função objetivo devido a maior incidência de mínimos locais gerada 
para este caso.  

 

 

 

 

 

 

 

 



5.1 Modelo de Meglio et al. (2009) 41 

 

a) b)  

c) d)  

Figura 5.2: Gráfico da função objetivo do modelo de Meglio et al. (2009) (a) abordagem 1: 
mínimos quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade 

para (b) ? = 10, (c) ? = 1?4 e (d) ? = 1?5. 

Conforme ilustrado na Figura 5.2a, utilizando apenas a função objetivo de mínimos 
quadrados, é possível verificar vários mínimos locais próximos do mínimo global. Dessa 
forma, qualquer chute distante do valor original para o problema de otimização pode levar 
a solução para um mínimo local.  Já na Figura 5.2c, para a função objetivo com penalidade, 
observa-se que a função objetivo é não-convexa, pois apresenta um conjunto de mínimos 
locais para o parâmetro ??? no valor fixo de 48 m

3. Isso acontece, pois no intervalo de ? 
entre 0,5 e 1,0, para ??? fixo em 48 m

3 o valor de ? está próximo de zero, significando que 
para todo esse segmento de ? o sistema oscila. Assim, apesar de não existir exatamente 
um mínimo local na função objetivo, o termo de mínimos quadrados pode compensar essa 
possível dificuldade através da aderência do modelo aos dados experimentais. Neste caso 
também se observa que o parâmetro de penalidade, após um certo valor, não influencia 
mais na convexidade da função objetivo. 

5.1.4 Resultados e discussão 

Os resultados do erros quadrático médio (???) das variáveis ??? e ???,  e da variância 
da variável ???  (??) da estimação de parâmetros do modelo de Meglio et al. (2009) para os 
cenários A, B, C e D são apresentados para as três abordagens que obtiveram os melhores 
resultados para o estudo de caso de Jöbses et al. (1986), conforme Tabela 5.3. 

 



42 Aplicação na produção de petróleo offshore 

 

 

Tabela 5.3: Resultados dos erros quadráticos do modelo de Meglio et al. (2009) para os 
cenários e seus respectivos casos. 

Cenário 

Abordagem A B C D 

 ??? ?? ??? ?? ??? ?? ??? ?? 

1 8,81 0,04 20,23 2,71 8,87 0,07 8,81 0,04 

2 4,81 1,08 7,47 0,83 7,61 0,56 4,75 0,55 

3 7,20 0,25 7,28 0,28 5,38 0,50 NO NO 

 
Conforme apresentado na Tabela 4.7, os erros quadráticos são significativamente 

menores para todos os cenários quando a penalidade ? é utilizada (abordagem 2). 
Numericamente, através da análise das variâncias, a abordagem 1 não possui 
comportamento oscilatório, com exceção do cenário B, enquanto que para a abordagem 2 
os resultados ficam mais próximos de 1, exceto para o cenário D. A abordagem 3 obteve 
resultados piores para o erro comparado à abordagem 2, enquanto que em relação à 
variância, ela também não foi capaz de representar o comportamento oscilatório do 
sistema. Além disso, para esa mesma abordagem, para o cenário D não foi possível realizar 
a otimização (NO). 

 
A fim de ratificar essa constatação, são analisados os resultados da estimação de 

parâmetros do modelo de Meglio et al. (2009) para os cenários A, B, C e D nas Figuras 5.3, 
5.4, 5.5 e 5.6, respectivamente, onde são mostrados graficamente apenas os resultados 
das abordagens 1 e 2.  

 

 

Figura 5.3: Cenário A do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 

 



5.1 Modelo de Meglio et al. (2009) 43 

 

 

Figura 5.4: Cenário B do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os “dados experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 

 

 

Figura 5.5: Cenário C do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. os dados experimentais são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 



44 Aplicação na produção de petróleo offshore 

 

 

 

Figura 5.6: Cenário D do modelo de Meglio et al. (2009) (a) sem penalidade e b) com 
penalidade ?. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 

De forma similar ao estudo de caso anterior, as figuras deixam evidente que para o 
modelo de Meglio et al. (2009) a formulação da função objetivo com penalidade gera 
resultados superiores quando comparadas ao método de mínimos quadrados.  

Utilizando a abordagem 1 os parâmetros estimados são incapazes de capturar o 
comportamento oscilatório característico do sistema, exceto do cenário B. Além disso, 
apesar de se dispor de chutes iniciais distantes do valor original, a abordagem 2 consegue 
alcançar um comportamento oscilatório nas variáveis de saída observadas. Entretanto, 
uma discrepância é observada nos instantes iniciais da simulação em todos os casos, as 
quais podem ser atribuídas a inicialização do modelo. Entretanto, após transcorrido o 
período de inicialização dos modelos, a tendência dos dados experimentais foi capturada. 
No cenário B, a abordagem sem penalidade resultou em um comportamento oscilatório, 
mas apenas quando foi adicionada a penalidade na função objetivo é que se obteve um 
comportamento similar aos dados experimentais (aderência aos dados).  
 Os valores dos parâmetros estimados a partir da abordagem 2 e seus respectivos 
intervalos de confiança, para cada cenário, são apresentados na Tabela 5.4. 
 

Tabela 5.4: Valores dos parâmetros estimados para todos os cenários do modelo de 
Meglio et al. (2009) utilizando a abordagem 2. 

 Cenário 

Parâmetros A B C D 

?? (m
-1) 1,02e-4±1,39e-5 8,94e-5±7,34e-5 1,15e-4± 1,78e-4 1,81e-4± 5,2e-4 

? 0,7600±0,0004 0,7664±0,0018 0,8243±0,0017 0,8610± 0,0017 

???(m
-1) 48,4481±0,0094 52,2164±0,0741 50,6012± 0,0709 48,1205± 0,0624 

???? (m
-1) 0,0029±1,60e-6 0,0029±9,18e-6 0,0031± 9,25e-6 0,0028± 6,63e-6 

 



5.2 Fast Offshore Well Model (FOWM) 45 

 
Pode-se observar através da Tabela 5.4, que apesar de a abordagem 2 ter obtido o 

melhor resultado dentre as demais, ela ainda não foi capaz de alcançar o valor exato dos 
parâmetros da Tabela 5.1, sendo que o parâmetro ?? é o menos preciso deles segundo os 

intervalos de confiança. Apesar disso, o comportamento do modelo com os parâmetros 
estimados foi satisfatório, sendo capaz de capturar a tendência dos dados experimentais.  

Na Figura 5.7 são apresentados os planos de fase para os cenários A, B, C e D, 
considerando os parâmetros ótimos determinados pela estimação de parâmetros. 

a)  

 

b)  

c)  

 

d)  

Figura 5.7: Planos de fase para os cenários A, B, C e D do modelo de Meglio et al. (2009). 

 

5.2 Fast Offshore Well Model (FOWM)  

O modelo proposto por Diehl et al. (2017), denominado FOWM, é baseado no modelo 
de Meglio et al. (2009) e Jahanshahi et al. (2012). Essse modelo foi desenvolvido através do 
balanço de massa do sistema ilustrado na Figura 5.8, que é dividido em quatro subsistemas: 
anular, tubing, flowline e riser. 



46 Aplicação na produção de petróleo offshore 

 

 

 

Figura 5.8: Sistema da produção de óleo e gás no mar modelado pelo FOWM. Retirado de 
Diehl et al. (2017). 

5.2.1 Modelagem matemática 

Ao todo, o FOWM descreve o sistema de produção de petróleo com elevação tipo gás-
lift através de 6 EDOs e 25 EAs. 

O anular é o compartimento vertical da entrada e acúmulo de gás natural, que envolve 
a coluna de produção, conectada ao tubing pela válvula de injeção de gás natural. Neste há 
presença somente de gás e o balanço mássico é descrito por: 

 
????

??
= ??? ? ??? (5.14) 

onde ??? é a massa de gás no anular, ??? é a vazão mássica de gás natural entrando no 

anular e ??? é a vazão mássica de gás natural através da válvula de injeção na tubulação 
chamada normalmente de tubing. O tubing é o compartimento vertical que conecta o 
reservatório ao leito do mar, através da rocha impermeável onde ocorre a mistura do gás 
natural ao óleo. Neste subsistema há duas fases: a gasosa (g) e a líquida (l) formada por 
óleo e água do mar, sendo o balanço dado por: 

 
????

??
= ????? + ??? ? ???? (5.15) 

 
????

??
= ??(1 ? ???) ? ???? (5.16) 



5.2 Fast Offshore Well Model (FOWM) 47 

 
onde ??? e ??? são, respectivamente, a massa de gás e líquido no tubing, ?? é a vazão 

mássica total proveniente do reservatório, ???? e ???? são, respectivamente, as vazões 

mássicas de gás e líquido saindo do tubing, e ??? é a fração mássica de gás presente no 

tubing dada por ???/(??? + ???) . O flowline e o riser são compartimentos de 

encaminhamento da mistura gás/óleo do leito do mar à superfície. O flowline é a região 
junto ao leito do mar e o riser é a região vertical até o mainfold de produção, localizado na 
superfície. No FOWM as regiões do flowline e do riser são consideradas apenas um 
subsistema e a dinâmica de golfadas causada pelo acúmulo no ponto baixo é abstraída pela 
presença de uma bolha alongada e válvula virtual no ponto de inflexão, proposto por 
Meglio et al. (2009). Assim, o balanço no flowline/riser é dado por: 

 
????

??
= (1 ? ?)???? ? ?? (5.17) 

 
????

??
= ????? + ?? ? ????? (5.18) 

 
????

??
= ???? ? ????? (5.19) 

onde ???é a massa de gás acumulada na bolha à jusante da válvula virtual, ??? e ??? são, 

respectivamente, as massas de gás e líquido no riser, ?? é a vazão mássica de gás através 

da válvula virtual, ????? e ????? são as vazões mássicas de gás e líquido através da válvula 

de produção, respectivamente, e ? é a fração de gás que é desviada pela válvula virtual. 

 As vazões mássicas já suavizadas, em kg/s, são dadas por: 

 ???? = ????????
(??????)+?(??????)

2+?

2
  (5.20) 

 ?? = ??
(???????)+?(???????)

2+?

2
 (5.21) 

 ??? = ?????
(???????)+?(???????)

2+?

2
  (5.22) 

 ??? = ??????
(???????)+?(???????)

2+?

2
 (5.23) 

 ????? = ?????? (5.24) 

 ????? = ?????? (5.25) 

 ???? = ?????? (5.26) 

 ???? = (1 ? ???)??? (5.27) 

 ?? = ?? (1 ? 0,2(
???

??
) ? 0,8(

???

??
)
2

) (5.28) 

onde ??? é a pressão no ponto de injeção de gás de elevação no anular, ??? é a pressão no 
ponto de injeção de gás de elevação no tubing, ??? é a pressão no topo do tubing, ??? é a 
pressão à montante da válvula virtual, ??? é a pressão no ponto de injeção de gás de 
elevação no tubing, ?? é a pressão no reservatório, ??? é a pressão no topo do riser, ?? é a 



48 Aplicação na produção de petróleo offshore 

 

 

pressão no separador e ??? é a pressão na bolha acumulada; ??? é a massa específica do 
gás no anular, ?? é a massa específica do óleo; ??? é a fração mássica de gás no tubing, ?? 

é a fração mássica de líquido no flowline/riser, ??  é a fração mássica de gás no 

pipeline/riser; ?? é o coeficiente de fluxo da válvula de injeção, ?? é o coeficiente de fluxo 
da árvore de Natal, ?? é o coeficiente de fluxo do reservatório; ???? é o coeficiente da 
válvula de produção (choke) e ? é a abertura da choke. 

 As pressões são calculadas por: 

 ??? =
??

????
??? (5.29) 

 ??? = ??? +
?????

?
(??? + ???????) (5.30) 

 ??? =
??

?(???
???+???????

??
)
??? (5.31) 

 ??? =
?????

?
 (5.32) 

 ??? = ??? + ???????? (5.33) 

 ???? = ??? + ??????(???? ? ????) (5.34) 

 ??? = ???? + ??????(?? ? ????) (5.35) 

 ??? = (
??

???
+ ?

??

??
)??? (5.36) 

onde ?? é o volume do anular, ??? é o volume da bolha acumulado à jusante da válvula 
virtual, ?? é o volume do riser, ??? é a massa específica do líquido no riser, ????? é a massa 
específica do líquido no reservatório, ??? é a massa específica do líquido no tubing, ??? é 

a massa específica do gás no tubing; ??????? é a massa mínima de líquido no riser, ?é a 
massa molar do gás de elevação; ? é a constante gravitacional, ? é a temperatura do 
sistema, ? é a constante dos gases;  ?? é o comprimento do anular, ?? é o comprimento 
do tubing, ???? é a distância até o medidor de pressão no tubing, ???? é a distância até o 

ponto de injeção de gás de elevação no tubing e ? é a inclinação do ponto de inflexão do 
riser. 

 As massas específicas, expressas em kg/m3, são calculadas considerando gás ideal, ou 
seja: 

 ??? =
???

???
 (5.37) 

 ??? =
???+???

??
 (5.38) 

 ??? =
????

??
 (5.39) 



5.2 Fast Offshore Well Model (FOWM) 49 

 
onde ??? é o volume de gás no tubing e ?? é o volume do tubing. 

 As frações mássicas são calculadas por: 

 ?? =
???

???+???
 (5.40) 

 ?? = 1 ? ?? (5.41) 

 ??? =
???

???+???
 (5.42) 

Os cálculos geométricos são dados por:  

 ??? = ?? ?
???

??
 (5.43) 

 ?? =
?????

2

4
 (5.44) 

 ?? =
?????

2

4
 (5.45) 

 ? =
??2

4
 (5.46) 

onde ? é o diâmetro do riser, ?? é o diâmetro equivalente do anular e ?? é o diâmetro do 
tubing. 

 O modelo possui ao todo 27 parâmetros, sendo 18 desses relacionados diretamente às 
características físicas do sistema, conforme descrito na Tabela 5.5. 

 

 

 

 

 

 

 

 

 

 

 

 



50 Aplicação na produção de petróleo offshore 

 

 

Tabela 5.5: Parâmetros do Fast Offshore Well Model. 

Parâmetro Valor Unidade 

??? – Fração de gás no reservatório 0,0188 - 

?? – Diâmetro equivalente do anular 0,140 m 

? – Diâmetro do riser 0,152 m 

?? – Diâmetro do poço 0,150 m 

? – Constante de gravidade 9,81 m/s2 

???? – Distância vertical entre a árvore de natal e 

o ponto de medição de PDG 

916 m 

?? – Distância vertical entre a árvore de natal e o 
fundo do poço 

1279 m 

????  – Distância vertical entre a árvore de natal e 

o ponto de injeção de gás lift 

1117 m 

??  – Comprimento do anular 1118 m 

??  – Comprimento do poço 1639 m 

? – Massa molar do gás 18 kg/kmol 

?? – Pressão no reservatório 2,25e6 Pa 

?? – Pressão no separador 1013250 Pa 

? – Constante dos gases 8314 m3Pa/kmol.K 

?? – Massa específica do óleo 987,45 kg/m
3 

????? – Massa específica da mistura no 
reservatório 

891,9523 kg/m3 

? – Temperatura 298 K 

? – Inclinação do riser ?/4 rad 

??????? – Massa mínima de líquido no riser - kg 

?? – Coeficiente de fluxo da bolha alongada - m
-1 

???? – Coeficiente de fluxo da choke - m
-1 

??? – Volume da bolha alongada - m³ 

? – Fração de gás preso na bolha alongada - - 

?? – Coeficiente de fluxo do topo do poço - m
-1 

?? – Coeficiente de fluxo do anular para o poço - m
-1 

?? – Volume à montante da válvula virtual - m
3 

?? – Vazão mássica estimada para o poço - m
-1 

 

Onde as condições iniciais da simulação são ??? = 9347,55 kg, ???= 5347,54 kg,  ??? = 

35014,12 kg, ??? = 2395,94 kg, ???= 1788,01 kg e ??? = 11725,32 kg. 

 



5.2 Fast Offshore Well Model (FOWM) 51 

 
5.2.2 Cenários 

Nove parâmetros do modelo de Diehl et al. (2017) foram selecionados para serem 
estimados, sendo eles o ???????, ??, ????, ???, ?, ??, ??. ?? e ??. Essa seleção foi feita de 

acordo com um método de identificabilidade prática de Botelho et al. (2012). Dois únicos 
cenários para este modelo utilizando dados “experimentais” simulados foram 
estabelecidos mantendo o mesmo conjunto de parâmetros, modificando apenas o chute 
inicial, conforme mostrado na Tabela 5.7. 

Tabela 5.6: Cenários para os dados experimentais provenientes da simulação do FOWM. 

Cenário Valores originais 
simulação 

Chute 
inicial* 

A 
 
 
 
 

???????= 1957,03 
?? = 2,05e-4, 

????= 1,97e-2, 
??? = 83,5091 
? = 0,57 

?? = 8,68e-4 
?? = 1,59-4 
?? = 630,36 
??= 131,31 

20% 

B 140% 

* Relativo aos valores originais. 
 

As entradas referente à válvula choke e à vazão de gás lift foram mantidas constantes 
e iguais a 5,0% e 0,69 kg/s, respectivamente. Um ruído branco nas variáveis de saída ????, 

??? e ???. 

O FOWM possui seis variáveis de estado (???, ???, ???, ???, ??? e ???), que não 

possuem possibilidade de serem medidas na prática. Portanto, no problema de mínimos 
quadrados são consideradas apenas as medições das variáveis ????, ??? e ???, uma vez que 

essas são medidas reais no processo.  

5.2.3 Análise da função objetivo 

A análise da função objetivo para o FOWM é realizada confrontando os valores dos 
dados experimentais (simulados) com os dados advindos da estimação de parâmetros. 
Optou-se por utilizar os dados simulados, uma vez que a visualização da função objetivo 
tridimensional fica mais compreensível. Foram selecionados os parâmetros ???????  e ??, 

pois eles se mostram os mais sensíveis em relação aos demais para a análise do mínimo 
global, conforme Figura 5.9. 



52 Aplicação na produção de petróleo offshore 

 

 

a) b)

c) d)  

Figura 5.9:  Gráfico da função objetivo do FOWM para a (a) abordagem 1: mínimos 
quadrados clássicos (? = 0) e abordagem 2: com o parâmetro de penalidade para (b) 

? = 1?4, (c) ? = 1?8 e (d) ? = 1?12. 
 

A Figura 5.9a mostra que o gráfico da função objetivo sem penalidade possui inúmeros 
mínimos, o que dificulta muito a busca do solver pela melhor solução para o conjunto de 
parâmetros estimados. Por conseguinte, a Figura 5.8c, no qual a a penalidade é adicionada 
à função objetivo, exibe um mínimo local bastante visível, possuindo uma geometria 
totalmente diferente do que da Figura 5.9a. A função objetivo da abordagem 2 para um 
valor de ? suficientemente alto (Figura 5.8c), baseando-se apenas nos gráficos, é muito 
mais adequada para a estimação de parâmetros do que a abordagem 1 (Figura 5.8a). Da 
mesma forma que para os outros estudos de caso, após certo valor do parâmetro de 
penalidade, a convexidade da função objetivo não muda. 

5.2.4 Resultados e discussão  

Os resultados do erros quadrático médio ( ??? ) das variáveis ???? , ???  e ??? ,  e 

variância da variável ????  (??) da estimação de parâmetros do Fast Offshore Well Model 

utilizando dados experimentais simulados para os cenários A, B, C e D para as abordagens 
1 e 2 são mostrados na Tabela 5.7. 

 



5.2 Fast Offshore Well Model (FOWM) 53 

 
Tabela 5.7: Resultados dos erros quadráticos do FOWM com dados experimentais 

simulados para os cenários e seus respectivos casos. 

Cenário 

Abordagem A B 

 ??? ?? ??? ?? 

1 18,87 0,21 13,16 0,12 

2 5,46 1,31 3,27 0,82 

 
Conforme observado, o erro quadrático para a abordagem 2 chega a ser mais do que 

três vezes menor do que o erro da abordagem 1. Em relação à variância, a abordagem 1 
possui valores próximos a zero indicando que o o sistema não está oscilando, enquanto 
que na abordagem 2 o comportamento é oscilatório, pois os valores da variância estão 
maiores ou próximos de um. 

Nas Figuras 5.10, 5.11, 5.12 e 5.13 são mostrados os resultados gráficos dos cenários A, 
B, C e D para as abordagens 1 e 2, respectivamente. 
 

 

Figura 5.10: Cenário A do FOWM sem penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha. 

 



54 Aplicação na produção de petróleo offshore 

 

 

 

Figura 5.11: Cenário A do FOWM com penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha.  

 

Figura 5.12: Cenário B do FOWM sem penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha.  



5.2 Fast Offshore Well Model (FOWM) 55 

 

 

Figura 5.13:  Cenário B do FOWM com penalidade utilizando dados experimentais 
simulados. Os dados “experimentais” são representados pela linha pontilhada azul e os 

dados estimados pela linha sólida vermelha.  

A partir das figuras observa-se que os resultados utilizando a penalidade adicionada à 
função objetivo (Figuras 5.11 e 5.13) são os que possuem maior aderência aos dados 
experimentais, além de possuírem o comportamento oscilatório característico do ciclo 
limite, conforme esperado. Enquanto isso, utilizando a função objetivo sem a penalidade, 
obtêm-se resultados que convergem um resultado não-oscilatório (Figuras 5.10 e 5.12). 
 Os valores dos parâmetros estimados a partir da abordagem 2 e seus respectivos 
intervalos de confiança, para cada cenário, são apresentados na Tabela 5.8. 
 
 

Tabela 5.8: Valores dos parâmetros estimados para todos os cenários do FOWM 
utilizando dados experimentais simulados utilizando a abordagem 2. 

 Cenário 

Parâmetro A B 

??????? (kg) 1398,5±82,5281 1135,4±72,3007 

?? (m
-1) 1,35e-4±1,3e-4 2,15e-4±4,90e-4 

???? (m
-1) 1,84e-2±6,41e-5 2,20e-2±8,41e-5 

??? (m
3) 68,479±0,1459 89,740±0,1431 

? 0,2621±0,0046 0,6582±0,0015 

?? (m
-1) 4,99e-4±8,95e-6 9,74e-4±2,80e-5 

?? (m
-1) 9,47e-5±1,36e-5 2,14e-4±3,68e-5 

?? (m
3) 753,74±3,0440 567,80±1,4145 

?? (m
-1) 95,348±0,4104 167,334±0,6534 

 
 Apesar de os resultados dos parâmetros da Tabela 5.8 serem semelhantes aos valores 
da Tabela 5.3, as pequenas discrepâncias podem ser justificadas pela presença do ruído e 



56 Aplicação na produção de petróleo offshore 

 

 

pela não-linearidade do modelo (observado principalmente no cenário B). Além disso, os 
valores menos precisos, segundo os intervalos de confiança, foram para o parâmetro ??  

Assim, estimar os parâmetros do modelo para o caso em que os dados experimentais são 
simulados foi importante para testar se a metodologia era capaz de obter um bom 
resultado para um modelo tão complexo e extenso. A partir disso, é possível partir para o 
caso em que os dados experimentais são reais, conforme a sub-seção a seguir. 

Na Figura 5.14 são apresentados os planos de fase para os cenários A e B considerando 
os parâmetros ótimos determinados pela estimação de parâmetros. 

a)  

 

b)  

Figura 5.14: Planos de fase para os cenários A e B do modelo FOWM. 

 

5.3 Aplicação do modelo FOWM utilizando dados reais 

Nesta seção é realizado o ajuste do Fast Offshore Well Model utilizando os dados 
advindos dos sistemas de produção offshore de uma plataforma de petróleo nacional.  

5.3.1 Cenários 

Na aplicação real é estimado o mesmo conjunto de parâmetros da seção 5.2, sendo 
eles o ???????, ??, ????, ???, ?, ??, ??. ?? e ??. O único cenário formulado para este caso 

possui o chute inicial para os parâmetros baseados nos valores sugeridos por Diehl et al. 
(2017). 

 

 

 

 



5.3 Aplicação do modelo FOWM utilizando dados reais 57 

 
Tabela 5.9: Cenários para os dados experimentais e reais provenientes da simulação do 

FOWM. 

Cenário Valores originais 
dados reais** 

Chute 
inicial* 

A 
 
 
 
 

???????= 62,22 
?? = 1,137e-3 

????= 2,039e-3 
??? = 60,98 
? = 0,1545 

?? = 6,876e-4 
?? = 2,293e-3 

120% 

 ?? = 126,9 
??= 227,1 

- 

* Relativo aos valores originais. **Valores retirados de Diehl et al. (2017). 

 

A abertura da válvula choke possui comportamento conforme ilustrado na Figura 5.15. 
Já vazão de gás lift é mantida constante e igual a aproximadamente 33,7 kg/s.  

 

Figura 5.15: Entradas no modelo real do FOWM da abertura da válvula choke. 

O FOWM possui seis variáveis de estado (???, ???, ???, ???, ??? e ???), que não 

possuem possibilidade de serem medidas na prática. Portanto, no problema de mínimos 
quadrados são consideradas apenas as medições das variáveis ????, ??? e ???, uma vez que 

essas são medidas reais no processo.  

5.3.2 Resultados e discussão  

Os resultados do erros quadrático médio (???) das variáveis ????, ??? e ??? ,  e da 

variância da variável ????(??)  para a estimação de parâmetros do Fast Offshore Well Model 

utilizando dados reais para os cenários A são apresentados na Tabela 5.10 através dos erros 
quadráticos (Equação 3.27) para as duas primeiras abordagens. 

 
 
 
 



58 Aplicação na produção de petróleo offshore 

 

 

Tabela 5.10: Resultados dos erros quadráticos do FOWM com dados reais para o cenário 
A e seus respectivos casos. 

Abordagem ??? ?? 

1 4,77 0,31 

2 8,65 1,50 

 
Conforme resultados da Tabela 5.10 o erro quadrático para o caso sem penalidade é 

menor do que para o caso com penalidade. Essa diferença se deve ao bias do modelo obtido 
em relação aos dados experimentais, o que aumenta consideravelmente o erro quadrático 
mensurado através do problema de mínimos quadrados. No entanto, observando os 
resultados da variância, a abordagem 2 foi capaz de capturar de forma mais apropriada o 
comportamento oscilatório dos dados. 

Nas Figuras 5.14 e 5.15 são mostrados graficamente apenas os resultados das 
abordagens 1 e 2, respectivamente. Já na Figura 5.7 é mostrado o resultado para o mesmo 
conjunto de dados reais obtido por Diehl et al. (2017). 
 

 

Figura 5.16: Resultados utilizando a metodologia proposta para o cenário A do FOWM 
sem penalidade (linha verde) e com penalidade (linha vermelha) utilizando dados reais 

(linha azul). 



5.3 Aplicação do modelo FOWM utilizando dados reais 59 

 

 

Figura 5.17: Resultados obtidos por Diehl et al. (2017) (linha vermelha) para o mesmo 
conjunto de dados reais (Azul). 

Na Figura 5.16, partindo-se da otimização apenas com o termo de mínimos quadrados 
na função objetivo, da mesma forma que para os estudos de caso do capítulo anterior, foi 
obtido um conjunto de parâmetros que leval o modelo a convergir para um estado não 
oscilatório). Já utilizando a penalidade proposta neste trabalho adicionada à função 
objetivo, o modelo foi capaz de atingir o comportamento oscilatório esperado.  

Apesar de o conjunto de parâmetros estimados utilizando a abordagem 2 não mostrar 
uma aderência maior aos dados experimentais (Figura 5.16), ela ficou semelhante ao 
resultado obtido por Diehl et al. (2017) (Figura 5.17).  

Da mesma forma que Diehl et al. (2017), embora o comportamento dinâmico do poço 
estudado seja não-uniforme, o Fast Offshore Well Model foi capaz de predizer a pressão na 
PDG com relativa boa performance. Além disso, este modelo proposto pode contribuir para 
muitos aspectos da produção de petróleo, incluindo o monitoramento em tempo real, 
controle e otimização. Nesses casos, o offset entre o modelo obtido na identificação e os 
dados reais acaba sendo não muito problemático para o controlador, de forma que esse 
bias pode ser corrigido através da utilização de um estimador de estados durante a 
estimação de parâmetros. 

Na Tabela 5.11 são apresentados os valores dos nove parâmetros simulados na 
estimação de parâmetros para a abordagem 2, junto a seus respectivos intervalos de 
confiança. 

 

 

 

 



60 Aplicação na produção de petróleo offshore 

 

 

Tabela 5.11: Valores dos parâmetros estimados para todos os cenários do FOWM 
utilizando dados reais para a abordagem 2. 

 Cenário 

Parâmetro A 

??????? (kg) 71,8293± 12865,15 

?? (m
-1) 1,3290e-3± 0,3442 

???? (m
-1) 3,9747e-3± 1,7e-3 

??? (m
3) 70,473± 20,4848 

? 0,2095± 0,1772 

?? (m
-1) 5,9363e-4± 2,03e-4 

?? (m
-1) 4,2365e-5± 2,4693e-5 

?? (m
3) 153,1257± 113,4982 

?? (m
-1) 246,9820± 91,9644 

 
Os resultados da Tabela 5.11 mostram uma pequena diferença dos valores da Tabela 

5.9, o que pode ser justificada pela utilização de metodologias diferentes na estimação dos 
parâmetros nos dois casos. Observa-se que os parâmetros ??????? e ?? são menos precisos, 

uma vez que seus intervalos de confiança são maiores que o valor de seus parâmetros. Já 
na Figura 5.18 é apresentado o plano de fase para o cenário A considerando os parâmetros 
ótimos determinados pela estimação de parâmetros. 

 

 

Figura 5.18: Planos de fase para o cenário A do modelo FOWM utilizando dados reais. 

 
 Portanto, a vantagem da metodologia proposta em relação ao que foi apresentado no 

trabalho de Diehl et al. (2017) é, além de não ser necessária a utilização de um solver global, 



5.3 Aplicação do modelo FOWM utilizando dados reais 61 

 
que o método single-shooting com a penalidade ? não precisa de nenhuma modificação ou 
ser aplicado mais de uma vez. Ou seja, o procedimento aplicado por por Diehl et al. (2017) 
foi repetido diversas vezes, além de ter sido necessária a modificação manual dos 
parâmetros para direcionar o problema ao seu ótimo, enquanto isso, para a metodologia 
proposta fez tudo automaticamente, demorando cerca de 12 horas para encontrar o seu 
ótimo. 

 
 



 
 

  62 

 Considerações Finais 

6.1 Conclusões 

A estimação de parâmetros em modelos com ciclo limite é relevante para diferentes 
processos, tais como fermentação, reatores químicos e na produção de petróleo. A 
estimação de parâmetros nesses modelos dinâmicos não-lineares é complexa devido a 
não-convexidade da função objetivo, onde se tem a presença de mínimos locais. Dessa 
forma, o objetivo principal deste trabalho consistiu em elaborar uma metodologia eficiente 
para estimação de parâmetros em modelos com ciclo limite, considerando todas as suas 
possíveis aplicações, tanto em escala laboratorial como industrial. Nela foi possível suavizar 
a dificuldade mencionada reduzindo o espaço de busca (através da adição de restrições), 
ou desencorajando a busca em áreas inviáveis do espaço de busca (através da adição de 
penalidade na função objetivo). Baseado nesta ideia, a proposta de apresentar um método 
para estimação de parâmetros em sistemas com ciclo limite foi alcançada.  

O conhecimento contendo a localização do ciclo limite foi reformulado como uma 
penalidade adicionada na função objetivo do problema de otimização. Isso foi feito com o 
auxílio do critério ?-Hopf adicionado como uma restrição de igualdade na função objetivo, 
onde o método de penalidade exata foi adaptado a esse problema. Neste caso, depois do 
primeiro passo do método single-shooting, o parâmetro de penalidade decresce enquanto 
? se aproxima de zero (comportamento do ciclo limite). Com a penalidade quase 
desconsiderada, o modelo pode ser ajustado aos dados experimentais com o termo de 
mínimos quadrados. 

A metodologia proposta neste trabalho foi aplicada a dois estudos de caso que 
utilizaram dados experimentais simulados, sendo eles o modelo de Jöbses et al. (1986) e o 
modelo de Meglio et al. (2009). Em ambos os casos a adição da penalidade ? à função 
objetivo se mostrou mais eficiente do que as demais abordagens, sendo elas: sem 
penalidade, utilizando a parte real do autovalor como penalidade, incluindo o critério ?-
Hopf como restrição, ou até mesmo considerando a restrição que se baseia no critério Hopf 
que é empregado por programas de análise de bifurcação, descrito por Govaerts (2000). 
Desta forma, a utilização da penalidade ? é a que resulta em comportamentos típicos do 
ciclo limite, além de ajustar melhor o modelo aos dados através do termo de mínimos 
quadrados. 



6.2 Sugestões para trabalhos futuros 63 

 
Além disso, quando foram observados os gráficos das funções objetivo dos estudos de 

caso mencionados, foi perceptível que a utilização da penalidade ? reduziu os mínimos 
locais próximos ao máximo global. Com a função objetivo mais convexa, foi possibilitada a 
utilização de chutes iniciais mais distantes do valor original, impedindo respostas 
indesejadas para o problema de otimização, como a resposta de um modelo resultando em 
linha reta para dados com característica oscilatória. 

A aplicação real desde trabalho, a qual usa dados experimentais advindos dos sistemas 
de produção offshore de uma indústria de extração nacional, também trouxe resultados 
promissores, considerando a dificuldade do modelo fenomenológico utilizado para 
estimação dos parâmetros. Os resultados obtidos utilizando a metodologia proposta neste 
trabalho ficaram muito semelhantes ao que foi apresentado por Diehl et al. (2017). Além 
disso, o modelo proposto pode contribuir para muitos aspectos da produção de petróleo, 
incluindo na etapa de controle, que já é apresentado por Gerevini et al. (2016). 

Por fim pode-se concluir que a metodologia para estimação de parâmetros em modelos 
com ciclo limite possui potencial de utilização prática com sucesso, sendo essa de 
implementação simples e de fácil compreensão. 

6.2 Sugestões para trabalhos futuros 

? Adicionar uma etapa de pré-tratamento e seleção de dados experimentais, cujo 
objetivo é utilizar a menor quantidade de dados possível que traga a maior 
quantidade de informações sobre o modelo. 

? Utilizar estimadores de estado em adição à estimação de parâmetros, de modo que 
seja reduzido o efeito dos distúrbios desconhecidos. Esses podem comprometer a 
qualidade da estimação, principalmente para processos reais. 



 
 

  64 

Referências 

ÅKESSON, J. et al. Modeling and optimization with Optimica and JModelica.org—Languages 
and tools for solving large-scale dynamic optimization problems. Computers &amp;amp; Chemical 
Engineering, v. 34, n. 11, p. 1737–1749, 2010.  

BEQUETTE, B. W. Process Dynamics: Modeling, Analysis and Simulation. [s.l.] Prentice Hall 
PTR, 1998.  

BIEGLER, L. T.; GROSSMANN, I. E. Retrospective on optimization. Computers &amp;amp; Chemical 
Engineering, v. 28, n. 8, p. 1169–1192, 15 jul. 2004.  

BOTELHO, V. R. Nova Metodologia para Análise de Identificabilidade e Estimação de 
Parâmetros de Modelos Fenomenológicos. [s.l.] Universidade Federal do Rio Grande do 
Sul, 2012. 

BOTELHO, V. R.; TRIERWEILER, L. F.; TRIERWEILER, J. O. A New Approach for Practical 
Identifiability Analysis Applied to Dynamic Phenomenological Models. IFAC Proceedings 
Volumes, v. 45, n. 15, p. 691–696, 2012.  

CEDERSUND, G.; KNUDSEN, C. Improved parameter estimation for systems with an 
experimentally located Hopf bifurcation. IEE Proceedings - Systems Biology, v. 2, n. 3, p. 
161–168, 2005.  

CLEWLEY, R. Hybrid Models and Biological Model Reduction with PyDSTool. PLoS Comput 
Biol, v. 8, n. 8, p. e1002628, 2012.  

D’ERRICO, J. Adaptive Robust Numerical Differentiation. Disponível em: 
&lt;http://www.mathworks.com/matlabcentral/fileexchange/13490-adaptive-robust-
numerical-differentiation?requestedDomain=www.mathworks.com&gt;.  

DAUGULIS, A. J.; MCLELLAN, P. J.; LI, J. Experimental investigation and modeling of 
oscillatory behavior in the continuous culture of Zymomonas mobilis. Biotechnology and 
Bioengineering, v. 56, n. 1, p. 99–105, 1997.  

DHOOGE, A.; GOVAERTS, W.; KUZNETSOV, Y. A. MATCONT: A MATLAB package for 



Referências 65 

 
numerical bifurcation analysis of ODEs. ACM Trans. Math. Softw., v. 29, n. 2, p. 141–164, 
2003.  

DIEHL, F. C. et al. Fast Offshore Wells Model (FOWM): A practical dynamic model for 
multiphase oil production systems in deepwater and ultra-deepwater scenarios. 
Computers &amp;amp; Chemical Engineering, 2017.  

ELMAN, H. et al. Lyapunov Inverse Iteration for Identifying Hopf Bifurcations in Models of 
Incompressible Flow. SIAM Journal on Scientific Computing, v. 34, n. 3, p. A1584–A1606, 
1 jan. 2012.  

ELNASHAIE, S.; UHLIG, F. Numerical Techniques for Chemical and Biological Engineers 
Using MATLAB: A Simple Bifurcation Approach. [s.l.] Springer, 2007.  

Escoamento em tubulações horizontais. Disponível em: 
&lt;http://www.turbulencia.coppe.ufrj.br/petroleo/&gt;. Acesso em: 20 fev. 2017.  

FILHO, H. DOS S. R. A otimização de gás lift na produção de petróleo: avaliação da curva 
de performance do poço. [s.l.] UFRJ, 2011. 

GEREVINI, G. G. et al. Aumento da Produção de Petróleo em Sistemas de Produção 
Offshore através de Controle NMPC. Congresso Brasileiro de Automática. Anais...Vitória: 
2016 

GEREVINI, G. G. Nova Política de Aumento de Produção para Sistema de Elevação de 
Petróleo. [s.l.] Universidade Federal do Rio Grande do Sul, 2017. 

GOVAERTS, W. J. F. Numerical Methods for Bifurcations of Dynamical Equilibria. [s.l.] 
Society for Industrial and Applied Mathematics, 2000.  

GOVAERTS, W.; SIJNAVE, B. Matrix manifolds and the Jordan structure of the bialternate 
matrix product. Linear Algebra and its Applications, v. 292, n. 1, p. 245–266, 1999.  

GUCKENHEIMER, J.; MYERS, M.; STURMFELS, B. Computing Hopf Bifurcations I. SIAM 
Journal on Numerical Analysis, v. 34, n. 1, p. 1–21, 1 fev. 1997.  

HAIRER, E.; WANNER, G. Solving Ordinary Differential Equations II, Stiff and Differential-
Algebraic Problems. [s.l.] Springer-Verlag, 1987.  

HOPF, E. Abzweigung einer periodischen Lösung von einer station aren Lösung eines 
Differential systems. Bericht der Math. - Phys. Klasse der Sächsischen Akademie der 
Wissenschaften zu Leipzig, v. 92, 1942.  

HYNNE, F.; DANØ, S.; SØRENSEN, P. G. Full-scale model of glycolysis in Saccharomyces 
cerevisiae. Biophysical Chemistry, v. 94, n. 1–2, p. 121–163, 2001.  

HYNNE, F.; SO/RENSEN, P. G.; MO/LLER, T. Complete optimization of models of the 
Belousov–Zhabotinsky reaction at a Hopf bifurcation. The Journal of Chemical Physics, v. 
98, n. 1, p. 219–230, 1993.  

JAHANSHAHI, E.; SKOGESTAD, S.; HANSEN, H. Control structure design for stabilizing 
unstable gas-lift oil wells. IFAC Proceedings Volumes, v. 45, n. 15, p. 93–100, 2012.  



66 Referências 

 

 

JÖBSES, I. M. L. et al. Fermentation kinetics of Zymomonas mobilis at high ethanol 
concentrations: Oscillations in continuous cultures. Biotechnology and Bioengineering, v. 
28, n. 6, p. 868–877, 1986.  

JOHNSON, S. G. The NLopt nonlinear-optimization package.  

KHALIL, H. K. Nonlinear systems. 3rd. ed. [s.l.] Prentice Hall, 2002.  

KROLL, A. Grey-Box Models: Concepts and Application. New Frontiers in Computational 
Inteligence and its Applications, 2000.  

MCLELLAN, P. J.; DAUGULIS, A. J.; LI, J. The Incidence of Oscillatory Behavior in the 
Continuous Fermentation of Zymomonasmobilis. Biotechnology Progress, v. 15, n. 4, p. 
667–680, 1999.  

MEERBERGEN, K.; SPENCE, A. Inverse Iteration for Purely Imaginary Eigenvalues with 
Application to the Detection of Hopf Bifurcations in Large-Scale Problems. SIAM Journal on 
Matrix Analysis and Applications, v. 31, n. 4, p. 1982–1999, 1 jan. 2010.  

MEGLIO, F. DI; KAASA, G. O.; PETIT, N. A first principle model for multiphase slugging flow 
in vertical risersProceedings of the 48h IEEE Conference on Decision and Control (CDC) 
held jointly with 2009 28th Chinese Control Conference, 2009.  

NOCEDAL, J.; WRIGHT, S. J. Numerical Optimization. Second ed. [s.l.] Springer, 2006.  

OURIQUE, C. O.; BISCAIA, E. C.; PINTO, J. C. The use of particle swarm optimization for 
dynamical analysis in chemical processes. Computers &amp;amp; Chemical Engineering, v. 26, n. 12, 
p. 1783–1793, 2002.  

POWELL, M. J. D. A Direct Search Optimization Method That Models the Objective and 
Constraint Functions by Linear Interpolation. In: GOMEZ, S.; HENNART, J.-P. (Eds.). . 
Advances in Optimization and Numerical Analysis. Dordrecht: Springer Netherlands, 1994. 
p. 51–67.  

QIAO, J.-F.; HAN, H.-G. Identification and modeling of nonlinear dynamical systems using 
a novel self-organizing RBF-based approachAutomatica. [s.l: s.n.].  

ROMIJN, R. et al. A grey-box modeling approach for the reduction of nonlinear systems. 
Journal of Process Control, v. 18, n. 9, p. 906–914, 2008.  

SCHWAAB, M.; PINTO, J. C. Análise de Dados - Volume I: Fundamentos de Estatística e 
Estimação de Parâmetros. [s.l.] Série Piloto de Engenharia Química COPPE-UFRJ, 2007.  

SEYDEL, R. Practical Bifurcation and Stability Analysis. London: Springer, 2010. v. 3 

WANG, H. et al. Optimization of a continuous fermentation process producing 1,3-propane 
diol with Hopf singularity and unstable operating points as constraints. Chemical 
Engineering Science, v. 116, p. 668–681, 2014.  



Referências 67 

 
WERNER, B. Computation of Hopf Bifurcation with Bordered Matrices. SIAM Journal on 
Numerical Analysis, v. 33, n. 2, p. 435–455, 1996.  

WILLIAMS, G. P. Chaos Teory Tamed. [s.l.] Joseph Henry Press, 1997.  

ZAMAMIRI, A.-Q. M.; BIROL, G.; HJORTSØ, M. A. Multiple stable states and hysteresis in 
continuous, oscillating cultures of budding yeast. Biotechnology and Bioengineering, v. 75, 
n. 3, p. 305–312, 2001.  

ZHANG, Y.; HENSON, M. A. Bifurcation Analysis of Continuous Biochemical Reactor Models. 
Biotechnology Progress, v. 17, n. 4, p. 647–660, 2001.  

  



68  

 

 

 

Apêndice A  

A.1 Análise do plano de fase 

Considerando um sistema não-linear, onde ?1e ?2 são os autovalores do problema: 

A.1.1 Plano de fase de nós 

 ?1, ?2 reais, ?1 ? ?2 &gt; 0, ?1 ? ?2  (A.1) 

Neste caso, onde ambos os autovalores são reais e possuem o mesmo sinal, o ponto 
estacionário é denominado um nó. Esse caso se divide em dois subcasos: 

a) ? &amp;lt;0: nó estável (stable node) 

b) ? &gt; 0: nó instável (unstable node) 

 

Figura A.1: Nó estável no plano de fase para o caso não-linear (autovalores são 
pontilhados). Fonte: Seydel (2010). 



Referências 69 

 
Na Figura A.1, os eixos são as variáveis de estado do sistema, no qual se tem um nó 

estável. O autovalor real ?  define as quatro linhas sólidas que passam pelo ponto 
estacionário, e cada uma delas é uma trajetória do sistema de equações lineares do 
problema. Se |?| é grande (pequeno), o movimento correspondente é rápido (lento). Um 
autovalor negativo ?  significa que a trajetória é direcionada em direção ao ponto de 
equilíbrio, no caso em que o nó é estável, enquanto um nó positivo é associado a um 
afastamento do ponto de equilíbrio, ou seja, o nó é instável.  

A.1.2 Plano de fase de selas 

 ?1, ?2 reais, ?1 ? ?2 &amp;lt;0  (A.2) 

Quando os autovalores reais possuem sinais diferentes, o ponto estacionário é 
denominado ponto de sela. Uma vez que um dos autovalores é positivo, duas das quatro 
trajetórias associadas com os autovalores deixam o equilíbrio. Um ponto de equilíbrio de 
sela, portanto, é sempre instável, conforme Figura A.2. 

 

Figura A.2:  Sela em um plano de fase (autoespaço é indicado pelo seu autovalor ?). 
Fonte: Seydel (2010). 

A.1.3 Plano de fase foco 

Nesse caso, ?1, ?2 são complexos conjugados com parte real diferente de zero. Assim: 

 ?1 = ? + i?, ?2 = ? ? i?  (A.3) 

Onde ? e ±? denotam as partes reais e imaginárias, respectivamente. Nesse caso, o 
equilíbrio correspondente é denominado foco estável (? &amp;lt;0), centro (? = 0) e foco 
instável (? &gt; 0). 



70  

 

 

 

Figura A.3:  Mudança de estabilidade do foco em um plano de fase. Fonte: Seydel (2010). 

 

A.2 Análise de bifurcação 

A.2.1 Bifurcação ponto limite (turning point) 

Também denominado de bifurcação dobra (fold bifurcation), nó de sela (saddle node) 
ou de ponto limite (limit point), pode ser introduzindo usando as seguintes equações 
escalares: 

 0 = ?2 ? ?  ou 0 = ?2 + ?  (A.4) 

As soluções de ?(?) de 0 = ?2 ? ?  formam uma parábola que é definida apenas para 
? ? 0. Em ? = 0  existe apenas uma solução (? = 0), onde para ? &gt; 0  existem duas 

soluções ? = +?? e ? = ???. O ponto onde as soluções começam a existir (? = 0,? = 0 
nesse exemplo) é um ponto de inflexão. Os pontos de inflexão geralmente surgem em 
pares, resultando em efeitos de histerese. Na Figura A.4, o ramo vem de um lado (direção 
de ?) e vira no ponto de inflexão.  

 

Figura A.4: Bifurcação ponto limite. Fonte: Seydel (2010). 



Referências 71 

 
O ponto de inflexão sela (saddle node) é motivado pelo comportamento de estabilidade 

das soluções quando elas são interpretadas como equilíbrio das equações diferenciais. No 
caso, por exemplo, da equação diferencial abaixo: 

 ??? = ?2 + ?  (a.5) 

o equilíbrio +?? é estável, enquanto que ??? é instável. Na Figura A.5 a estabilidade da 
equação é mostrada graficamente, onde distingue-se o equilíbrio estável e instável pela 
utilização de uma linha contínua para o primeiro e de uma linha pontilhada para o segundo. 

 

Figura A.5: Estabilidade da bifurcação ponto limite. Fonte: Seydel (2010). 

Ou seja, a bifurcação do tipo sela é uma bifurcação descontínua, uma vez que no ponto 
crítico ?? se tem o fim de um ramo estável. Se houver um caminho sobre o ramo estável 
através de ??, então a bifurcação é contínua e deixa de ser um ponto limite. 

A.2.2 Bifurcação transcrítica (transcritical bifurcation) 

Na bifurcação transcrítica ocorre a mudança de estabilidade das soluções. O exemplo 
mais simples dessa bifurcação é: 

 ??? = ?? ? ?2  (A.6) 

O equilíbrio é dado por ? = 0  e ? = ? . Nesse caso, o ramo trivial ? = 0  perde 
estabilidade no ponto de bifurcação (?,?) = (0,0). Simultaneamente há uma troca de 
estabilidade no outro ramo. A Figura 8 indica os ramos estáveis por linhas contínuas, 
conforme a seguir: 



72  

 

 

 

Figura A.6: Bifurcação transcrítica. Fonte: Seydel (2010). 

 

A.2.3 Bifurcação forquilha (pitchfork bifurcation) 

O tipo de bifurcação forquilha é caracterizada pelo aparecimento e desaparecimento 
de equilíbrios e pela ocorrência de mudança de estabilidade. Esse tipo de bifurcação é 
caracterizado pelo fato de que ? = 0 é um conjunto de soluções estáticas e existe uma 
segunda curva que a intercepta ?(?,??) situada inteiramente em um dos lados de ??.  

No plano (?,?), a segunda curva de equilíbrios fica inteiramente no lado direito de ? =
?? se a segunda derivada é positiva, ao passo que se a segunda derivada for negativa, a 
curva se localiza no lado esquerdo. Assim, quando o equilíbrio não-trivial aparece para ? &gt;
??, se diz haver uma bifurcação foquilha supercrítica, já para ? &amp;lt;?? se tem uma bifurcação 
forquilha subcrítica. 

O exemplo mais simples de bifurcação forquilha supercrítica (supercritical pitchfork 
bifurcation) é: 

 ??? = ?? ? ?3  (A.7) 

Para ? &gt; 0 existem dois equilíbrios não-triviais, ? = ±??. A transição da estabilidade 
é ilustrada na Figura A.7. 



Referências 73 

 

 

Figura A.7: Bifurcação forquilha supercrítica. Fonte: Seydel (2010). 

Existe uma simetria na equação utilizada neste exemplo: ou seja, substituindo ? ? ?? 
tem-se a mesma equação, logo, a equação é invariante em relação a essa transformação. 
A simetria também é encontrada nas soluções estacionárias. Além da transformação ? ?
??, os dois ramos que surgem das condições iniciais (?0, ?0) = (0,0) são idênticos e assim 
pode ser identificado. 

O exemplo mais simples de bifurcação forquilha subcrítica é: 

 ??? = ?? + ?3  (A.8) 

Neste caso há também perda de estabilidade no ponto de bifurcação (?0, ?0) = (0,0). 
Diferente do exemplo da bifurcação forquilha supercrítica, não há mudança de 
estabilidade. Ao invés disso, a estabilidade é perdida localmente no ponto de bifurcação. A 
equação diferencial e as soluções estacionárias possuem a mesma simetria como o 
exemplo anterior. 

 

Figura A.8: Bifurcação forquilha subcrítica. Fonte: Seydel (2010). 

 



74  

 

 

A.3 Funções teste de bifurcação 

Supondo que uma cadeia de soluções 

 (?1,?1),(?
2,?2),…  (A.9) 

Para ?(?,?) = 0  foram aproximadas e que um ponto de bifurcação é dado por 

(???1,???1) e (?
?,??). Portanto, a partir desses dados das soluções é possível reconhecer 

se uma bifurcação (?0,?0) está próxima utilizando as funções teste ?(?,?), as quais são 
avaliadas durante a varredura dos ramos. Uma bifurcação é indicada por um zero de ?, ou 
seja, uma função teste da bifurcação que satisfaz a propriedade 

 ?(?0,?0) = 0  (A.10) 

e é contínua em um intervalo suficiente grande que inclui ?0. Uma mudança de sinal de ? 
em (?0,?0) é conveniente. A aplicação de ? é ilustrada na Figura x. A parte de cima da 
figura mostra muitas soluções calculadas em um ramo. Durante essas computações, os 
valores da função teste da bifurcação são monitorados (parte de baixo da figura). Uma vez 
que é improvável obter-se exatamente o zero (ou a bifurcação, respectivamente), faz 
sentido checar uma mudança de sinal de ?. Uma bifurcacão é mais provável de ocorrer se: 

 ?(???1,???1)?(?
?,??) &amp;lt;0  (A.11) 

é satisfeito. 

 

 

Figura A.9: Valores da função teste abrangendo um zero. Fonte: Seydel (2010). 


</field>
	</doc>
</add>