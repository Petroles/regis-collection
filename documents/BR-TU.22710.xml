<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.22710</field>
		<field name="filename">6732_Ferraz_PaolaCunha_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Paola Cunha Ferraz

Implementação de um algoritmo multi-escala para

sistemas de equações lineares de grande porte

mal condicionados provenientes da discretização

de problemas elípticos em dinâmica de fluidos

em meios porosos

CAMPINAS
2015

i



ii





Ficha catalográfica
Universidade Estadual de Campinas

Biblioteca do Instituto de Matemática, Estatística e Computação Científica
Maria Fabiana Bezerra Muller - CRB 8/6162

    
  Ferraz, Paola Cunha, 1988-  
 F413i FerImplementação de um algoritmo multi-escala para sistemas de equações

lineares de grande porte mal condicionados provenientes da discretização de
problemas elípticos em dinâmica de fluidos em meios porosos / Paola Cunha
Ferraz. – Campinas, SP : [s.n.], 2015.

 

   
  FerOrientador: Eduardo Cardoso de Abreu.
  FerDissertação (mestrado) – Universidade Estadual de Campinas, Instituto de

Matemática, Estatística e Computação Científica.
 

    
  Fer1. Meios porosos. 2. Métodos multigrid (Análise numérica). 3. Abordagem

multiescala. 4. Equações diferenciais elípticas. 5. Métodos do gradiente
conjugado. 6. Método dos elementos finitos. I. Abreu, Eduardo Cardoso de,1974-.
II. Universidade Estadual de Campinas. Instituto de Matemática, Estatística e
Computação Científica. III. Título.

 

Informações para Biblioteca Digital

Título em outro idioma: Implementation of a multiscale algorithm for the solution of ill-
conditioned large linear systems obtained by the discretization of elliptic problems in fluid
dynamics
Palavras-chave em inglês:
Porous media
Multigrid methods (Numerical analysis)
Multiscale approach
Elliptic differencial equations
Conjugate gradient methods
Finite element method
Área de concentração: Matemática Aplicada
Titulação: Mestra em Matemática Aplicada
Banca examinadora:
Eduardo Cardoso de Abreu [Orientador]
Samuel Rocha de Oliveira
Fábio Antonio Dorini
Data de defesa: 23-02-2015
Programa de Pós-Graduação: Matemática Aplicada

Powered by TCPDF (www.tcpdf.org)

iv





vi



Abstract

The focus of this work is the numerical approximation of differential problems involving partial
differential equations (PDE’s) of elliptic nature, in the context of modelling and simulation in
fluid dynamics in porous media. The dissertation aims to contribute with an implementation
of a multiscale multigrid algorithm, recently introduced in the literature, designed for solving
ill-conditioned large linear systems of equations derived from those classes of PDE’s, typically
associated with Poisson problems of pressure-velocity with boundary conditions typical of flow
in porous media. The Poisson problem discussed here is identified from the coupled convection-
diffusion transport system counterpart of PDE’s, with dominated convection, and by a linearization
by means the use of an operator splitting approach based on the physics of the underlying model.
The methodology used for the discretization of the Poisson elliptic problem is mixed hybrid finite
elements. The numerical solution of the resulting linear system will be addressed by a multiscale
multigrid preconditioned conjugate gradient (PCG) method. We combine both methodologies
in order to capture the distinct wavelengths associated with the different wavelengths from the
assosiated self-adjoint Poisson operator, strongly influenced by the heterogeneity of the geological
properties of the porous media, in particular to the absolute permeability, which in turn might
exhibit very large fluctuations of orders of magnitude. Numerical experiments in applications of
fluid dynamics problems in porous media are presented and discussed for a verification of the
results obtained by direct numerical simulations with the multiscale multigrid algorithm under
consideration.

Keywords: Multigrid Multiscale Method, Fluid Dynamics in Porous Media, Darcy’s Flow,
Elliptic PDE, Mixed Hybrid Finite Element Method, Ill-conditioned Linear Systems, Precondioned
Conjugate Gradient Method.

Resumo

O foco deste trabalho é aproximação numérica de problemas envolvendo equações diferenciais
parciais (EDPs), de natureza elíptica, no contexto de aplicações em dinâmica de fluidos em meios
porosos. Especificamente, a dissertação pretende contribuir com uma implementação de um algo-
ritmo multiescala e multigrid, recentemente introduzido na literatura, para resolução aproximada
de sistemas de equações lineares de grande porte e mal condicionados, proveniente dessa classe de
EDPs, tipicamente associada a problemas de Poisson de pressão-velocidade com condições de con-
tornos típicas de fluxo em meios porosos. O problema concreto de Poisson discutido neste trabalho

vii



será desacoplado do sistema de transporte de EDPs de convecção-difusão, com convecção domi-
nante, e linearizado por meio do emprego de uma técnica de decomposição de operadores baseado
na física do modelo subjacente. A metodologia para a discretização do problema elíptico de Poisson
é elementos finitos mistos híbridos. A resolução numérica do sistema linear resultante deste proce-
dimento será realizado via um método do tipo Gradientes Conjugados com Pré-condicionamento
(PCG) multiescala e multigrid. Combinamos as metodologias multiescala e multigrid de modo
a capturar os distintos comprimentos de onda associados aos diferentes comprimentos de onda
do operador diferencial auto-adjunto de Poisson, fortemente influenciado pela heterogeneidade das
propriedades geológicas do meio poroso, em particular da permeabilidade absoluta, que pode exibir
flutuações em várias ordens de grandeza. Experimentos computacionais em aplicações de proble-
mas de dinâmica de fluidos em meios porosos são apresentados e discutidos para verificação dos
resultados obtidos.

Palavras-chave: Método multigrid multiescala, Dinâmica de fluidos em meios porosos, Fluxo
de Darcy, EDP elíptica, Método de elementos finitos mistos híbridos, Sistemas lineares mal condi-
cionados, Gradientes conjugados com pré-condicionamento.

viii



Sumário

Agradecimentos xi

1 Introdução 1
1.1 Motivação da pesquisa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Objetivos específicos e proposta de trabalho . . . . . . . . . . . . . . . . . . . . . . 3
1.3 Temas desenvolvidos e resultados obtidos . . . . . . . . . . . . . . . . . . . . . . . . 4
1.4 Organização da dissertação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

2 Modelagem matemática de fluxos multifásicos em meios porosos heterogêneos 13
2.1 Equações fundamentais de escoamento com duas e três fases . . . . . . . . . . . . . 14

2.1.1 Modelo de escoamento de três fases com gravidade . . . . . . . . . . . . . . 16
2.1.2 Modelo de escoamento de duas fases com gravidade . . . . . . . . . . . . . . 18
2.1.3 Modelo de escoamento de duas fases com gravidade e histerese . . . . . . . . 19

2.2 O modelo do traçador passivo e da pressão global . . . . . . . . . . . . . . . . . . . 21
2.2.1 Traçador passivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
2.2.2 A formulação da pressão global . . . . . . . . . . . . . . . . . . . . . . . . . 21

3 Modelagem computacional das equações governantes em fenômenos de trans-
porte em meios porosos heterogêneos 25
3.1 Decomposição de operadores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4 Aproximação numérica das equações diferenciais parciais governantes 29
4.1 Discretização do sistema parabólico e hiperbólico de EDPs associado ao problema

de transporte de convecção-difusão . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
4.2 Discretização por elementos finitos mistos da EDP elíptica associada ao problema

de pressão e velocidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
4.2.1 Elementos Finitos Mistos Híbridos . . . . . . . . . . . . . . . . . . . . . . . 33
4.2.2 Equações discretas e eliminação do multiplicadores de Lagrange e fluxos. . . 35

5 Resolução do sistema linear associado ao problema elíptico 39
5.1 Gradientes Conjugados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

5.1.1 Precondicionadores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
5.2 O Método Multigrid . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

5.2.1 Métodos de relaxação e a propriedade de smoothing . . . . . . . . . . . . . . 43

ix



5.2.2 A estrutura do Método Multigrid . . . . . . . . . . . . . . . . . . . . . . . . 46
5.2.3 O Multigrid como Pré-condicionador . . . . . . . . . . . . . . . . . . . . . . 48
5.2.4 Outra maneira de derivar o pré-condicionador multigrid . . . . . . . . . . . . 49

5.3 Gradientes conjugados com pré-condicionador multiescala recursivo . . . . . . . . . 50
5.4 Implementação do método dos gradientes conjugados com pré-condicionador multi-

escala recursivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
5.4.1 Aproximação da permeabilidade na malha . . . . . . . . . . . . . . . . . . . 53
5.4.2 Smoother . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
5.4.3 Operadores de Restrição e Prolongação . . . . . . . . . . . . . . . . . . . . . 54
5.4.4 Critério de Parada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

6 Experimentos numéricos para problemas elípticos de Poisson em geometrias de
aplicações 59
6.1 Pressão-fluxo slab Dirichlet-Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . 61
6.2 Fluxo slab Neumann-Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
6.3 Geometria 1/4 de five-spot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

7 Conclusões e Perspectivas 77
7.1 Conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
7.2 Perspectivas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
7.3 Considerações finais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

Referências 81

A Eliminação dos multiplicadores de Lagrange 93

B A computational multiscale approach for incompressible two-phase flow in he-
terogeneous porous media including relative permeability hysteresis 95
B.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
B.2 Computational Modeling with Hysteresis . . . . . . . . . . . . . . . . . . . . . . . . 97
B.3 Continuous-time mixed finite element approximations to the Ellipitc and Parabolic

problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
B.3.1 Discretization of the Poisson-elliptic problem . . . . . . . . . . . . . . . . . . 99
B.3.2 A multigrid multiscale preconditioner method for the discretized coupled

nonlinear Poisson-elliptic problem . . . . . . . . . . . . . . . . . . . . . . . . 100
B.3.3 A combined domain decomposition with mixed fiment method formulation

for diffusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
B.4 Two-dimensional numerical experiments . . . . . . . . . . . . . . . . . . . . . . . . 103

B.4.1 Numerical experiments with hysteresis and slab geometry . . . . . . . . . . . 103
B.4.2 Purelly Poisson pressure-velocity numerical experiments . . . . . . . . . . . . 106

B.5 Concluding remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

x



Agradecimentos

Primeiramente gostaria de agradecer a toda minha família por sempre me apoiarem em to-
dos esses anos de estudo, principalmente a Paloma C. Ferraz pela companhia e ajuda durante a
elaboração desse trabalho.

Agradeço especialmente meu orientador, Eduardo Cardoso de Abreu, por sempre acreditar em
mim, me motivar e me desafiar a ser uma pesquisadora e pessoa melhor.

Agradeço os meus irmãos de orientação pela ajuda, pelo entendimento e por compartilharem
comigo todo o sofrimento e alegria de ser um pós-graduando.

Agradeço demais a todos os meus amigos desses anos de unicamp, que me apoiram, riram
comigo, choraram comigo, e que estarão sempre no meu coração.

Agradeço também aos professores Samuel Oliveira e Fabio Dorini pela leitura e criticas cons-
trutivas que levaram a aprimoração da versão final do texto.

Eu, Paola Ferraz, também agradeço o apoio da Coordenação de Aperfeiçoamento de Pessoal
de Nível Superior (CAPES), juntamente com o Programa de Pós-Graduação em Matemática Apli-
cada e Computacional do IMECC/UNICAMP, pelo apoio via uma bolsa institucional CAPES de
Mestrado, no período de 03/2013 até 02/2015.

Agradeço também o apoio da Fundação de Amparo a Pesquisa do Estado de São Paulo - FA-
PESP - pelo suporte aos projetos No. 2014/03204-9, No. 2011/11897-6, No. 2012/19874-8 e
No. 2011/23628-0, a UNICAMP/FAEPEX (Fundo de Apoio ao Ensino, à Pesquisa e Extensão)
pelo suporte ao projeto 519.292-785/11, e ao Conselho Nacional de Desenvolvimento Científico
e Tecnológico (CNPq) pelo suporte ao projeto 445758/2014-7, todos de responsabilidade de meu
Orientador Professor Eduardo Cardoso de Abreu. Estes projetos viabilizaram a compra de equi-
pamentos computacionais com os quais foi possível realizar um grande conjunto de simulações
numéricas, bem como sua análise, e que fazem parte integrante da presente dissertação de mes-
trado.

xi



xii



Capítulo 1

Introdução

O tema científico deste trabalho de mestrado consiste na implementação computacional de um
algoritmo multiescala recursivo para resolução de sistemas de equações lineares de grande porte
mal condicionados provenientes da discretização de problemas elípticos em dinâmica de fluidos
em meios porosos. Neste trabalho a discussão da decomposição de operadores é motivada para
identificar o problema de Poisson a ser resolvido, que é o foco principal desta dissertação. Es-
pecificamente, no presente trabalho será adotado uma abordagem de discretização via Elementos
Finitos Mistos Híbridos do problema de Poisson, em espaços ?(???) de Raviart-Thomas, resul-
tando em um problema de álgebra linear cuja matriz associada é simétrica definida positiva e,
portanto, naturalmente consistente com o problema diferencial elíptico auto-adjunto. Tal abor-
dagem é justificada pelo bom desempenho na aproximação numérica e simulação de escoamentos
bifásicos água-óleo e problemas trifásicos [65, 83, 69, 84, 138, 2, 6, 14, 8, 5, 4, 11, 7, 13, 10,
9]. Desta maneira, será explorado uma formulação iterativa do método dos gradientes conjugados
com pré-condicionador para a resolução numérica do sistema linear proveniente da discretização do
problema de Poisson. Em linhas gerais, o escopo deste trabalho de mestrado abrange modelagem
matemática, análise numérica e simulação computacional para a resolução numérica de modelos
de EDPs não lineares, exibindo coeficientes descontínuos com rápida variação, para auxiliar no
entendimento físico/matemático da dinâmica não linear do fluxo de fluidos em reservatórios e
aquíferos.

1.1 Motivação da pesquisa
Problemas de transporte de fluidos em meios porosos são modelados por equações diferenciais

e derivadas parciais (EDPs) não lineares. Desta forma o desenvolvimento e a análise numérica
de algoritmos precisos e eficientes constituem uma alternativa ao entendimento matemático da
dinâmica não linear destas EDPs. Do ponto de visto matemático o desafio fundamental consiste
no entendimento do mapeamento não linear que leva a micro-física, posta na escala de centímetros,
até a macro-física, posta na escala real de campo de dezenas de metros, que é mais adequada
para uma descrição destes problemas em dinâmica de fluidos em meios porosos heterogêneos e de
natureza multiescala. Do ponto de vista de aplicações práticas podemos citar recursos energéticos

1



e hídricos no meio ambiente. Por exemplo, o tema exibe certo potencial no contexto de captura
de CO2, diretamente de fontes emissoras, como termo-elétricas, e sua injeção (em estado super-
crítico, com elevada compressão) em reservatórios ultraprofundos e com elevada concentração de
sais minerais, tipicamente de alto custo de tratamento para o consumo humano. Além disso,
existe uma potencial aplicação em território brasileiro, no contexto do aumento da produção de
petróleo, como aqueles na camada pré-sal ao longo da costa brasileira (e.g., bacia de Santos).
A ideia básica aqui é a reinjeção de hidrocarbonetos leves (gás) in-situ. Devido a sua afinidade
com o hidrocarboneto pesado (petróleo), espera-se um aumento na mobilidade das fases fluidas
para uma maior recuperação de petróleo, ou seja, aumento da produção. Em uma percepção
extremamente muito otimista, o armazenamento de CO2 pode ser visto como um mecanismo
viável para a mitigação parcial, e controlada, das emissões de gases poluentes ao meio ambiente,
promovendo nesse contexto um efeito benéfico de contenção às mudanças climáticas.

Em mais detalhes, ainda no contexto de motivação em matemática aplicada e computação ci-
entífica, este projeto abrange modelagem matemática, análise numérica e simulação computacional
para a resolução numérica de modelos de EDPs não lineares, exibindo coeficientes descontínuos
com rápida variação, para auxiliar no entendimento fisico/matemático da dinâmica não linear do
fluxo de fluidos em reservatórios e aquíferos. A compreensão matemática da dinâmica do escoa-
mento de várias fases fluidas em meios porosos em fenômenos de transporte é muito importante
em diversos contextos, tanto no aspecto matemático puro das EDPs (existência, unicidade e regu-
laridade de soluções) como em análise numérica [6, 5, 14, 77, 104, 56, 115, 110, 113, 143, 103] e
aplicações [60, 59, 4, 2, 6], como recursos energéticos e meio ambiente (e.g., reservatórios de petró-
leo [13, 76] monitoramento de aquíferos [101] e solos contaminados [59]). Existem muitos desafios
e dificuldades para a modelagem matemática e análise numérica de EDPs que governam escoa-
mentos multifásicos complexos em meios porosos (veja, e.g., [103, 60, 13, 59, 101]). Uma grande
dificuldade advém do seu inerente caráter multiescala devido as heterogeneidades de propriedades
geológicas da rocha que compõe o reservatório (e.g., “permeabilidade ?(x)” e “porosidade ?(x)”)
que são modelados no sistema governante de EDPs como coeficientes descontínuos com rápida va-
riação [76, 59]. Além disso, soluções analíticas são muito difíceis (e.g., [60, 76, 89, 104, 56, 77, 121,
110]), senão impossíveis, de serem obtidas com as técnicas tradicionais devido também à natureza
matemática não linear destas EDPs, como por exemplo, modelos de EDPs de tipo misto elíptico,
hiperbólico e parabólico. Assim, a análise numérica de algoritmos é uma alternativa (adicional)
ao entendimento matemático desses modelos de EDPs. Do ponto de vista científico, os tópicos
de modelagem matemática e análise numérica abordados neste projeto são convergentes para uma
investigação em base matemática sólida do problema de mapeamento (transferência de escalas) de
EDPs não-lineares em meios porosos (e.g., [89, 59]).

Do ponto de vista tecnológico, os resultados esperados são de potencial relevância para o
desenvolvimento de técnicas para o aumento de produção de petróleo, área estratégica para a
economia do Brasil, e para o estado de São Paulo (e.g., área do pré-sal na bacia de Santos) e para a
preservação do meio ambiente, permitindo o monitoramento do transporte de poluentes no subsolo
e em aquíferos. De fato, os campos interligados de matemática aplicada e computacional abrangem
modelagem, desenvolvimento e análise de algoritmos numéricos e simulação para problemas que
surgem na ciência pura e na indústria, como por exemplo, o entendimento refinado de propriedades
não lineares de modelos matemáticos como os discutidos neste projeto e que ocorrem de forma

2



similar na física, química, biologia, geologia, astronomia, ciência de materiais, mecânica dos fluidos,
e em um bom número de outras disciplinas (e.g., [60, 86, 101, 121, 115, 104, 103, 76, 59, 13]).
Este Trabalho abrange modelagem e solução numérica de EDPs não lineares com o potencial de
aplicação em problemas científicos e tecnológicos no meio ambiente e em recursos energéticos, ou
seja,

• mudança climática e contenção do aquecimento global via captura e sequestramento de CO2
em reservatórios petrolíferos e em aquíferos com elevada concentração de sal (água não po-
tável) [58, 43, 45, 81, 16, 90, 111, 93];

• remediação em subsolos contaminados por fases líquidas não aquosas [43, 45, 81, 16, 90, 111,
93];

• recuperação avançada de hidrocarbonetos em reservatórios petrolíferos, incluindo aqueles na
camada pré-sal [58, 81, 16, 90, 111, 44, 29, 2, 4, 11, 13, 76];

• o problema de transferência de escalas é um tema de caráter científico básico, que está em-
butido naturalmente nos três tópicos anteriores, ver, e.g., [123, 81, 76, 89, 95, 97, 94].

1.2 Objetivos específicos e proposta de trabalho
O presente trabalho destina-se a implementação de um algoritmo multiescala, recentemente

introduzido na literatura, para resolução de sistemas de equações lineares de grande porte mal
condicionados provenientes da discretização de problemas elípticos em dinâmica de fluidos em
meios porosos.

Os objetivos deste trabalho são:

• Apresentar um novo método multiescala recursivo para a resolução de problemas de naturesza
elíptica no contexto de escoamento de fluidos em meios porosos heterogêneos. Esse método foi
primeiramente introduzido no trabalho de Klaus Lackner e Ralph Menikoff [115], “Multiscale
Linear Solvers for Very Large Systems Derived from PDES”, publicado em SIAM Journal
on Scientific Computing (2000), e faz uso das propriedades multiescala do meio poroso. O
método multiescala recursivo baseia-se na decomposição espectral e combina gradientes con-
jugados, métodos multigrid e métodos iterativos em um único algortimo. Essencialmente
combinamos o método dos gradientes conjugados com um pré-condicionador dado por uma
iteração do método multigrid combinado novamente com gradientes conjugados. Métodos
multigrid tipicamente tiram vantagens de aspectos multiescala do modelo, usando diferentes
malhas para aproximar a solução do sistema linear e, dessa forma, levam em conta a varia-
bilidade associada a geologia do meio poroso, como a permeabilidade e porosidade. A nova
metodologia combina técnicas que se mostraram apropriadas para a aproximação numérica
de problemas de Poisson, e em conjunto com uma estratégia de decomposição de operado-
res, esta metodologia pode ser empregada em problemas de escoamento de fluidos em meios
porosos heterogêneos, tanto bifásicos quanto trifásicos.

3



• Enfatizamos diversas situações relevantes em aplicações de dinâmica de fluidos em meios
porosos onde é natural identificar o problema modelo diferencial de Poisson associado ao
cálculo do problema de pressão-velocidade. Para melhor exemplificar uma ampla classe de
problemas em escoamento de fluidos em meios porosos que envolvem, em sua modelagem, um
problema de natureza elíptica, consideramos sistemas governantes de modelos incompressíveis
e imiscíceis, trifásico e bifásico, expressos na formulação de fase. Essa formulação é mais geral
com relação a forma das equações englobando, entre outros, problemas bifásicos, trifásicos,
e problemas bifásicos com a introdução do parâmetro de histerese, em uma, duas e três
dimensões espaciais.

• Apresentamos um estudo e aplicação de uma estratégia para identificar e discretizar o pro-
blema de Poisson associado a um modelo de dinâmica de fluidos em meios porosos heterogê-
neos bidimensionais e que levam em conta efeitos de histerese. Combinamos uma técnica de
decomposição de operadores, baseada na física, com Elementos Finitos Mistos Híbridos para
discretizar a EDP elíptica, representada pelo problema de pressão-velocidade, e obter um
sistema linear com boas propriedades. Tal abordagem é justificada pelo bom desempenho na
aproximação numérica e simulação de escoamentos bifásicos água-óleo e problemas trifásicos,
dentro da tradição estabelecida por Jim Douglas Jr., Richard Ewing, Thomas F. Russell e
Mary F. [65, 83, 69, 84, 138]. Por fim, o método multiescala recursivo é usado para obter a
solução numérica do sistema linear proveniente da discretização.

• Implementação do método apresentado. O método multiescala recursivo foi implementado
na linguagem C pura e mostrou-se acurado. Obtivemos soluções para problemas de Poisson
em duas dimensões e o algoritmo se comportou como indicado na literatura [115].

1.3 Temas desenvolvidos e resultados obtidos
Técnicas de decomposição de operadores visando a aproximação de operadores diferenciais

(sistemas de equações diferenciais parciais), concomitantemente com a componente de eficiência
computacional, tem sido frequentemente empregadas em problemas de simulação de escoamentos
de fluidos em problemas de dinâmica de fluidos em meios porosos, como em aquíferos naturais e em
reservatórios petrolíferos, particularmente em problemas de escoamentos monofásicos e bifásicos;
veja alguns trabalhos relevantes na área de dinâmica de fluidos bem como as referências lá citadas
[80, 104, 86, 123, 76, 89, 17, 73, 61, 111, 65]. Em linhas gerais, ao invés de se resolver o sistema
original de equações diferenciais na forma que resulta diretamente das leis básicas de conservação,
suplementada por relações constitutivas (que tipicamente são obtidas por experimentos de labo-
ratório), o sistema de equações é reescrito para exibir claramente a sua natureza matemática, ou
seja, na forma de modelos hiperbólico, parabólico, elíptico ou misto no contexto de classificação
(local) de EDPs. Desta maneira, técnicas numéricas distintas e apropriadas podem ser emprega-
das, dentro da formulação de decomposição de operadores, para fornecer procedimentos numéricos
eficientes projetados para resolver equações diferenciais parciais que desenvolvem em suas soluções
choques e gradientes abruptos e também para capturar as complexas dinâmicas do escoamento

4



que evoluem nas mais diferentes taxas que tipicamente ocorrem em problemas de fluxo multifásico
em reservatórios heterogêneos.

Neste trabalho a discussão da decomposição de operadores é motivada para identificar o pro-
blema de Poisson a ser resolvido, que é o foco principal desta dissertação. Técnicas de decomposição
de operadores constituem uma das principais pontes entre análise numérica e análise funcional.
Em análise numérica, as técnicas de decomposição de operadores representam algoritmos numé-
ricos eficientes com o objetivo de aproximar de maneira precisa equações e sistemas de equações
diferenciais de evolução temporal de uma forma computacionalmente conveniente para incorporar
efeitos físicos distintos. Em análise funcional, essas técnicas são usadas para a demonstração de
estimativas de erro, existência de solução e teoremas de representação. Os artigos [80, 57, 144]
discutem os usos da técnica de decomposição de operadores e indicam uma grande variedade de
referências na literatura. Veja também os trabalhos [109, 63, 107, 108, 86, 110, 104, 56, 4, 5, 8,
2] para desenvolvimentos recentes na análise dos erros presentes na decomposição de operadores
(time-splitting errors) para problemas unidimensionais não lineares de convecção-difusão.

Cumpre mencionar, ainda, que para a introdução da decomposição de operadores, considera-
se o sistema governante de modelos incompessíveis e imiscíveis (bifásico e trifásico) expresso na
formulação de fase, na qual as equações diferenciais governantes são escritas em termos de uma
pressão de referência com respeito a uma das fases presentes no escoamento de duas equações
para o transporte das saturações das fases [2]. Essencialmente, tal formulação é mais geral para o
propósito de desenvolvimento de ferramentas de aproximação e simulação de transporte de fluidos
em meios porosos heterogêneos em múltiplas escalas. Para um maior aprofundamento sobre esse
aspecto específico no contexto de escoamentos trifásicos indica-se ao leitor interessado as referências
[2, 31, 33, 106, 15, 49, 54].

A técnica de decomposição de operadores discutida aqui permite que o passo de tempo para
a atualização do campo de velocidades no cálculo do problema de pressão-velocidade seja maior
do que aquele para o cálculo do problema de difusão, que, por sua vez, pode ser maior do que o
passo de tempo usado no cálculo que incorpora os efeitos de convecção dos fluidos. Primeiramente,
decompõe-se o cálculo do problema de pressão-velocidade (sub-problema elíptico) do cálculo do
problema de transporte das saturações (1? nível) e, então, decompõe-se o cálculo das saturações
em transporte convectivo e transporte difusivo (2? nível). Desta maneira, três passos de tempo são
naturalmente introduzidos na decomposição de operadores: ??? para a solução do problema hiper-
bólico associado ao transporte convectivo dos fluidos, ??? para o cálculo dos efeitos difusivos e ???
para o cálculo do problema de pressão-velocidade. Desta maneira, em uma aplicação “máxima”
da técnica de decomposição, temos especificamente três sub-problemas que devem ser resolvi-
dos sequencialmente: o sub-problema elíptico de Poisson de pressão-velocidade, o sub-problema
hiperbólico de convecção e o sub-problema parabólico de difusão. Os problemas hiperbólico e
parabólico não serão tratados nesse trabalho. Para os leitores interessados na aproximação desses
sub-problemas no contexto de dinâmica de fluidos aqui discutidos indica-se os trabalhos [2, 6, 14,
8, 5, 4, 11, 7, 13, 89, 22, 21, 73, 72, 71, 24, 18].

Existem várias metodologias na literatura para aproximação de EDPs. Fundamentalmente,
essa escolha deve ser guiada pela natureza matemática do modelo diferencial sob investigação
tendo em vista que se espera obter, ou melhor, recuperar no nível discreto, as mesmas propri-
edades física e matemática do modelo original posto no contínuo. Isso é igualmente válido, em

5



particular, para problemas elípticos de segunda ordem de Poisson associados a problemas de valor
de contorno, mesmo que resultantes de um procedimento de decomposição de operadores, como
mencionado anteriormente. Neste contexto, pode-se citar várias técnicas para discretização de
problemas elípticos, como por exemplo, Diferenças Finitas [147, 140], Volumes Finitos [74, 153],
Diferenças finitas miméticas (ou Mimetic finite differences) [119, 28, 40, 140], Elementos Finitos
(clássico) [39], Elementos Finitos da classe Galerkin Descontínuo [67, 23, 134], Elementos Finitos
Mistos Híbridos em espaços ?(???) [136, 137, 41] entre outros, como elementos finitos generaliza-
dos [26]. No presente trabalho adota-se a abordagem de discretização Elementos Finitos Mistos
Híbridos em espaços ?(???) de Raviart-Thomas [136, 137, 41], motivado fundamentalmente pela
sua bem sucedida aplicação em problemas trifásicos [2, 6, 14, 8, 5, 4, 11, 7, 13, 10, 9] e previamente
pelo bom desempenho na aproximação numérica e simulação de escoamentos bifásicos água-óleo,
dentro da tradição estabelecida por Jim Douglas Jr., Richard Ewing, Thomas F. Russell e Mary F.
Wheeler nos trabalhos conjuntos [65, 83, 69, 84, 138] e mais recentemente nos trabalhos [7, 9, 18,
73, 72, 71] e nas referências lá citadas. Nesta série de trabalhos, elementos finitos mistos híbridos
foram identificados como muito apropriados para o cálculo de campos de velocidade precisos na
presença de heterogeneidades geológicas abruptas dos campos de porosidade e permeabilidade.
Além disso, é válido sempre mencionar que a formulação de elementos finitos mistos híbridos pos-
sui uma rigorosa fundamentação matemática e em conexão refinada com distintas abordagens em
análise numérica para problemas elípticos [136, 137, 41, 39, 23, 153, 28].

A ideia básica de métodos mistos no contexto de escoamento de fluidos em meios porosos é
de aproximar a pressão e o campo de velocidades simultaneamente. Para garantir a existência de
solução do problema misto, é importânte que o problema satisfaça a coercividade e a condição
inf-sup [41, 46, 137]. No entanto, mesmo que a condição inf-sup é satisfeita no contínuo, no nível
discreto deve-se ter cuidado na escolha dos espaços de aproximação – eles devem “recuperar” a
condição inf-sup dos espaços originais de modo a garantir a estabilidade do método. Métodos de
elementos finitos mistos não são estáveis para todos os casos, alguns desses problemas mostram
oscilações espúrias se os espaços de aproximação não forem adequadamente escolhidos [41, 48].
Para problemas elípticos, foram construídos diversas famílias de espaços de elementos finitos que
atendem a condição inf-sup e portanto são estáveis, como os espaços de Raviart-Thomas usado
neste trabalho [136]. Além disso, hibridizar a formulação de elementos finitos mistos não altera a
estabilidade.

No contexto deste trabalho, após a aplicação da decomposição de operadores, o problema elíp-
tico é então totalmente identificado, após uma convenientemente linearização do coeficiente do
fluxo de velocidade, ou lei de Darcy [136, 137, 41, 39]. A ideia básica é obter após a discretização,
e demais aproximações associados inerente às distintas formulações, um sistema linear com boas
propriedades matemáticas, como ser “bem condicionada” e ter uma natureza localmente conser-
vativa no nível discreto, tal qual seu correspondente operador diferencial no contínuo. Apesar
de ser bem conhecido que a formulação de elementos finitos mistos conduz a um sistema linear
esparso, que é simétrico e definido positivo [136, 137, 41, 39], tal sistema é mal condicionado de-
vido à natureza multiescala da permeabilidade da rocha reservatório que pode variar em ordens
de magnitude, de 10?2 milidarcy até 10+9 (1 darcy = 1.0 × 10?12 m2 = a permeabilidade que dá o
escoamento de 1 cm s?1 para um fluido com viscosidade de 1 centipoise (1 g m?1s?1) sob o gradi-
ente de pressão de 1 atm cm?1). Isso significa que é necessário ainda o emprego de alguma técnica

6



de pré-condicionamento para a resolução numérica do problema de álgebra linear proveniente da
discretização do problema de valor de contorno de Poisson de pressão-velocidade. Devido à natu-
reza do sistema linear A? = ?, é importante agora discutir sobre qual técnica de resolução deve
ser empregada para o problema de Poisson, ou seja, se é mais adequado adotar um método direto
ou um método iterativo para sua resolução numérica de forma precisa com robustez e eficiência
computacional. Será explorado uma formulação iterativa do método dos gradientes conjugados
com pré-condicionador 1 (PCG) para a resolução do problema A? = ?, como será argumento a
seguir.

A resolução de grandes sistemas esparsos de equações lineares da forma A? = ?, onde A = [??? ]
é uma matriz ? × ? (no contexto de EDPs tipicamente não singulares, pelo fato do problema
diferencial ser bem posto), e ? um vetor ? × 1 dado, é fundamental para muitas simulações nu-
méricas em ciência pura e em problemas de engenharia e é muitas vezes a parte mais demorada
de um cálculo para a compreensão global de um determinado cenário real em nosso cotidiano em
sociedade. Embora uma principal fonte de grandes sistemas A? = ? seja a discretização (e lineari-
zação) das EDPs do tipo elíptica (e também parabólicas; problemas de fluidos compressíveis, por
exemplo, são governados por modelos de EDPs de pressão-velocidade de natureza parabólica) é
válido mencionar que, sistemas lineares de grande porte e esparsos também surgem em aplicações
que não sejam provenientes de discretização de EDPs [142, 132, 124, 75, 139].

Tipicamente, os métodos diretos, com base na fatoração da matriz de coeficientes A em produto
de matrizes que são relativamente simples de inverter, são amplamente utilizados e são o “método
de escolha” em muitos códigos industriais, especialmente onde a confiabilidade da exatidão dos
cálculos é a principal preocupação. De fato, métodos diretos são muito robustos em geral. Além
disso, tais métodos exibem uma vantagem de permitir uma quantidade previsível de recursos em
termos de tempo computacional e armazenamento em memória (RAM, L2, Rígida, etc...); ver,
e.g., [75, 92]. Em problemas estacionários de EDPs, ou outros de natureza distinta [19, 139, 142],
é possível resolver de forma eficiente uma quantidade razoável de sistemas de equações lineares em
um tempo relativamente aceitável, subjacente a um problema em particular [19, 139, 142], mesmo
em duas dimensões espaciais. Isso já não é tão simples quando temos uma problema de evolução
temporal como ocorre com frequência em dinâmica de fluidos em meios porosos [65, 40, 23, 58, 15,
31, 72, 21, 2, 89, 76, 86]. Infelizmente, os métodos diretos não exibem um bom escalonamento com
o tamanho do problema em termos de contagem do número de operações envolvidas e os requisitos
de memória. Isso é notadamente visível em problemas decorrentes da discretização de EDPs em
duas e três dimensões espaciais de evolução temporal.

Simulações multifísica detalhadas, em problemas bidimensionais e tridimensionais (dentro do
escopo deste trabalho como estamos interessados) levam a sistemas lineares que podem atingir
facilmente a ordem de centenas de milhões (2D) ou até bilhões (3D) de equações com as corres-
pondentes incógnitas. Mesmo em problemas bidimensionais, face à natureza heterogênea do meio
poroso, é natural incorporar uma noção de incerteza, o que conduzirá a EDPs estocásticas [95,
97, 94, 24, 89, 123, 2] e uma abordagem do tipo Monte Carlo é uma alternativa viável. Essencial-

1Introduzido por E. Stiefel e M. R. Hestenes [102], o método dos gradientes conjugados é um método direto. No
entanto, na década de 70 descobriu-se o potencial desse algoritmo como um método iterativo [149, 128, 150]. Para
uma história mais completa sobre a pesquisa e desenvolvimento do método dos gradientes conjugados indicamos ao
leitor a referência [99] e as referências lá citadas.

7



mente, isso significa o cálculo de momentos estatísticos [95, 97, 94, 89] provenientes de um conjunto
de experimentos determinísticos em ordens de centenas ou milhares (desejável) de experimentos
computacionais. Assim, facilmente temos um contexto bidimensional com um número elevado de
operações associadas a aproximação de problemas de Poisson que pode envolver até 85% de todos
os cálculos para cada uma dessas milhares de simulações [8, 4, 7]. Para modelos dessa natureza,
levando em conta o conhecimento atual, métodos iterativos são a única opção disponível no me-
lhor entendimento do autor no contexto deste trabalho. Enquanto os métodos iterativos requerem
menos armazenamento de memória, e um número ainda muitas vezes menor de operações do que
os métodos diretos – especialmente quando uma solução aproximada de relativa baixa precisão é
exigida – tais métodos diretos não têm a “confiabilidade” dos métodos diretos, que podem fornecer
uma solução “exata”, a menos de erros de aritmética de ponto flutuante. Em algumas aplicações,
métodos iterativos tipicamente falham e o pré-condicionamento é indispensável, embora nem sem-
pre tal “remédio” seja suficiente para torná-lo competitivo a ponto de atingir a convergência em
uma quantidade razoável de tempo dentro de uma tolerância estabelecida a priori. Isto é devido
também em grande parte ao aumento da complexidade e tamanho da “nova geração de sistemas li-
neares e não lineares”, que surgem a partir de atuais aplicações típicas em fenômenos de transporte
de problemas em dinâmica de fluidos.

Por outro lado, ao mesmo tempo, a computação paralela tem penetrado as mesmas áreas
de aplicação como um novo ingrediente. Como o computador tornou-se amplamente disponível
em termos de custos e com a unificação de linguagens de comunicação padrão, como o MPI
(Message Passing Interface), criou-se um novo incentivo para utilizar métodos iterativos face que
problemas sob investigação são tipicamente em duas e três dimensões espaciais, e não estacionários,
ao invés dos métodos diretos os quais muitas vezes são ineficazes em termos do elevado tempo
computacional. Outro incentivo é que os métodos iterativos são muito mais fáceis de implementar
em computadores paralelos, embora métodos iterativos para sistemas lineares têm ainda obtido
um amadurecimento significativo e ainda há muitas questões em aberto [100, 124, 42, 132, 151,
145, 127, 142].

De um modo geral, ainda não pode ser afirmado que um sistema de equações lineares esparso
arbitrário pode ser resolvido de forma iterativa de uma forma eficiente. Por exemplo, se a infor-
mação física sobre o problema em questão pode ser explorada, os métodos mais eficazes e robustos
podem ser ainda mais adaptados para obtenção dessas soluções. De fato, esta estratégia é explo-
rada pelos métodos multigrid, que tipicamente tiram vantagens de aspectos multiescala do modelo.
Além disso, máquinas paralelas podem exigir diferentes arquiteturas de tal forma que os algoritmos
requerem distintos paradigmas de programação e radicalmente diferentes dos métodos clássicos e
consolidados na literatura. A título de revisão bibliográfica, observa-se que existem diversos textos
sobre o tema multigrid e multiescala, como por exemplo [100, 124, 42, 132]. Apesar de vários
outros pacotes computacionais prontos e disponíveis para uso “imediato”, como por exemplo [151,
145, 127, 66, 142, 42, 100, 124, 132, 142], muito desses não são, de fato, tão amigáveis para um
usuário não especialista (i.e., um usuário final com experiência em compiladores, programação de
baixo nível, etc...). Além disso, muitos desses códigos são genuinamente paralelos e assim não são
simples de executá-los em ambiente serial (uma boa exceção é o “SuperLU for sequential machi-
nes” [145], disponível desde 2011). Mesmo assim, um código aberto de alta qualidade exige uma
demanda de tempo considerável para um bom aprendizado. Outro ponto fundamental é que o

8



usuário ficará dependente de atualizações e sem um controle absoluto do código e, portanto, do
ponto de vista de amadurecimento acadêmico, isso pode ser um aspecto negativo, em particular no
campo científico como um ambiente de uma pós-graduação. Claramente esses pacotes devem ser
usados sempre que um dado objetivo está bem definido e quando há a disponibilidade de usuários
bem treinados.

Pelo exposto acima, é preciso escolher um método iterativo com pré-condicionamento que reúne
rigorosa fundamentação matemática, robustez, eficiência computacional, certa simplicidade de
implementação, e que ao mesmo tempo tenha uma forte motivação física face ao problema elíptico
de Poisson, e que leve ainda em conta as inerentes propriedades multiescala associadas à geologia do
meio poroso (porosidade e permeabilidade). Cumpre ainda reiterar que o problema de Poisson de
interesse neste trabalho está diretamente, e naturalmente, associado a uma equação de transporte,
governado por uma EDP de evolução temporal. Isso significa que toda a discussão precedente deve
ser vista em uma perspectiva de que o problema de Poisson será, de fato, resolvido a cada passo
de tempo em uma simulação computacional. Desta maneira, no contexto de resolução de sistemas
lineares esparsos e da natureza do presente trabalho de dinâmica de fluidos em meios porosos,
entendemos que o trabalho de Klaus Lackner e Ralph Menikoff [115], “Multiscale Linear Solvers
for Very Large Systems Derived from PDES”, publicado em SIAM Journal on Scientific Computing
(2000) engloba todos esses pré-requisitos de uma maneira natural em sua construção. Esse trabalho
aborda exatamente a situação física em escala de campo (quilômetros) que estamos interessados;
outros métodos exibem também um excelente rigor matemático, porém ainda no campo mais
teórico em problemas “testes” ou em aplicações distintas daquelas que estamos interessados em
investigar nesse trabalho. Um ponto importante no problema de pressão-velocidade de Poisson, é
quando temos pressões capilares descontínuas e a situação muda drasticamente, pois é necessário
identificar condições de acoplamento corretas, localmente conservativas, no nível discreto [125, 126,
78]. Neste contexto, técnicas multiescala, como a discutida aqui, precisam ser revisitadas quando
associadas a problemas de natureza elíptica. No caso do problema de pressão-velocidade com
pressões capilares descontínuas, outras técnicas podem ser adotadas, como Galerkin descontínuo
no contexto de elementos finitos [78, 126], decomposição de domínio combinado com métodos de
elementos finitos mistos em espaço ?(???) com condições de transmissibilidade de Robin [1, 2]
entre outras como um esquema de aproximação de fluxo multi-pontos de volumes finitos [82].

O método discutido nesse trabalho, o qual foi introduzido em [115], faz uso da formulação
iterativa do método dos gradientes conjugados em conjunto a um pré-condicionador escolhido
especialmente de modo a considerar a heterogeneidade do meio poroso. Isso é feito combinando o
método multigrid e o método dos gradientes conjugados criando um pré-condicionador multiescala
recursivo. Como mencionado anteriormente, a natureza multiescala da permeabilidade da rocha
que compõe o meio poroso conduz a um sistema linear mal condicionado, assim a escolha desse
pré-condicionador multiescala recursivo é interessante pois a forma com que ele é construido leva
em consideração ambos os extremos do espectro da matriz do sistema linear, através do método
multigrid, de maneira que a matriz do sistema pré-condicionado tenha um número de condição
pequeno, e consequentemente apenas um pequeno número de iterações é preciso para a convergência
do método dos gradientes conjugados.

Modificações foram introduzidas no algoritmo do método multiescala, especificamente nas es-
colhas das componentes do método multigrid. O método multiescala foi construido em [115] para

9



resolver numéricamente um problema de Poisson a partir de uma discretização por diferenças fi-
nitas centradas. No presente trabalho, por motivos já discutidos anteriormente, optamos por uma
discretização por elementos finitos mistos e dessa forma alguns parâmetros indicados no artigo
original [115] não forneceram um bom resultado, em termos de número de iterações e tempo com-
putacional. Isso nos levou a pensar em diferentes abordagens na escolha das componentes que
formam o pré-condicionar multiescala recursivo. Assim, uma novidade do nosso trabalho está na
diferente escolha de métodos de relaxação – smoother – e um diferente tratamento das condições
de contorno. Esse assunto será abordado no capítulo 5. As modificações são feitas com o intuito de
melhorar a convergência e tempo computacional do algoritmo multiescala. Computacionalmente,
nosso objetivo é que esse algoritmo possa ser usado em computadores pessoais. Dessa forma, não
nos preocupamos ainda em programacao paralela, porém é algo a ser explorado futuramente. Por
fim, os resultados obtidos com o nosso algoritmo multiescala recursivo foram coerentes com os
resultados obtidos no artigo de Lackner e Menikoff [115], mantendo a mesma tendência do número
de iterações e esforço computacional em cada nível.

Para maiores detalhes sobre métodos iterativos com precondicionamento multiescala e mul-
tigrid, com diferentes abordagens e uma ampla diversidade de aplicações, ver [66, 142, 42, 100,
124, 132]. A referência [142] é composta por 5 (cinco) volumes e reúne um amplo espectro sobre
álgebra linear numérica, de métodos diretos a iterativos, como diferentes abordagens sobre pré-
condicionamento em distintas aplicações em sua perspectiva de apresentação dos métodos. Para
informações sobre métodos diretos para a resolução de sistemas lineares de grande porte, sugere-se
as seguintes fontes [151, 145, 127].

O trabalho produzido nessa dissertação gerou um trabalho [3], o qual foi aceito no congresso
International Conference on Approximation Methods and Numerical Modelling in Environment
and Natural Resources MAMERN VI, em Pau na França. Nesse trabalho, nos concentramos na
aproximação numérica de problemas em transporte de fluidos que apresentam histerese em meios
porosos heterogeneos bidimensionais. A histerese tenta quantificar as diferenças no comportamento
dos fluidos durante o escoamento, devido as mudanças na saturação dos fluidos no tempo e espaço.
No capítulo 2 será explicado com detalhes como o parâmetro de histerese é incluido na formulação
de fase do escoamento bifásico.

Para aproximar a solução desse problema, usamos a técnica de decomposição de operadores,
como veremos no capítulo 3, e uma discretização por elementos finitos mistos híbridos combinado
com o método multiescala apresentado no capítulo 4 e 5 dessa dissertação para a aproximação do
problema de pressão-velocidade. E usaremos uma estratégia de decomposição de domínio para a
solução numérica do problema parabólico associado com transporte difusivo das fases fluidas.

Usamos um esquema de alta resolução de diferenças finitas centrado, não oscilatório, conser-
vativo e de segunda ordem para a aproximação do sistema de leis de conservação hiperbólico não
linear, que modela o transporte convectivo das fases fluidas [2, 123, 34]. Para a solução numérica
do sistema de transporte difusivo, aplicamos elementos finitos mistos para a discretização espacial
combinado com uma estratégia implícita, usando Euler regressivo, para a discretização temporal.

Um manuscrito do trabalho enviado ao congresso pode ser encontrado no Apêndice B desta
dissertação.

10



1.4 Organização da dissertação
No Capítulo 2 revisitamos a modelagem matemática básica de fluxos multifásicos em meios

porosos heterogêneos. No Capítulo 3 é feita uma discussão sobre modelagem computacional das
equações governantes em fenômenos de transporte em meios porosos heterogêneos na formulação de
fase para “isolar” o problema de Poisson para sua discretização numérica. O Capítulo 4 é dedicado
a aproximação numérica do problema de pressão-velocidade “isolado”, que é o foco deste trabalho,
via elementos finitos mistos híbridos e a identificação do problema de álgebra linear resultante
deste procedimento. No Capítulo 5 discute-se, em detalhes, um método da classe dos gradientes
conjugados com pré-condicionador multigrid multiescala recursivo para a resolução do sistema
linear associado ao problema de Poisson elíptico, bem como sua implementação. No Capítulo 6
apresentam-se os experimentos numéricos de um problema elíptico de pressão-velocidade modelo,
com permeabilidade variável, e uma discussão dos resultados obtidos. No Capítulo 7 temos uma
conclusão sobre os experimentos e perspectivas futuras.

11



12



Capítulo 2

Modelagem matemática de fluxos
multifásicos em meios porosos
heterogêneos

O estudo de transporte de fluidos em meios porosos heterogêneos é de grande importância
em diversas áreas científicas e tecnológicas com aplicações em sequestro de carbono [58, 43, 45],
transporte de contaminantes no subsolo [59], monitoramento de aquíferos [101], recuperação de
petróleo em reservatórios de hidrocarbonetos [13, 76], entre outros. Existem muitos desafios e
dificuldades para a modelagem matemática e análise numérica das EDPs não lineares que governam
escoamentos multifásicos complexos em meios porosos. Uma grande dificuldade advém do seu
inerente caráter multiescala devido as heterogeneidades de propriedades geológicas da rocha que
forma o reservatório, como a permeabilidade ?(x) e a porosidade ?(x), que são modelados no
sistema governante de EDPs como coeficientes descontínuos com rápida variação [76, 59].

Neste trabalho estamos interessados na aplicação do escoamento multifásico no contexto de
recuperação de petróleo em reservatórios heterogêneos, para o caso em que as fases são incom-
pressíveis e imiscíveis. Tipicamente, um reservatório de petróleo é um corpo de rocha sedimentar
subterrânea profunda, formada por depósitos não uniformes que variam abruptamento no espaço,
e que contém uma mistura de fluidos nos espaços intersticiais entre os grãos (em torno de 10-100
?m) [76]. O volume de espaço disponível, denominado porosidade, geralmente varia dentro da
escala 0.1-0.3 [m3/m3] e contém água e pelo menos um hidrocarboneto (gás ou óleo) na fase lí-
quida ou gasosa. Erosão, falhas naturais e fraturas complicam ainda mais o conhecimento preciso
da heterogeneidade presente no meio poroso. A permeabilidade da rocha pode variar por ordens
de magnitude, de 10?2 milidarcy até 10+9 (1 darcy = 1.0 × 10?12 m2 = a permeabilidade que
dá o escoamento de 1 cm s?1 para um fluido com viscosidade de 1 centipoise (1 g m?1s?1) sob o
gradiente de pressão de 1 atm cm?1) [76]. Estas heterogeneidades ocorrem em múltiplas escalas,
desde a escala microscópica do poros até a escala de campo, que pode se extender por quilômetros
impossibilitando o conhecimento preciso e detalhado das variações das propriedades das rochas
que influenciam fortemente o transporte de fluidos no meio poroso.

13



Figura 2.1: Ilustração da propriedade multiescala do meio poroso na micro-escala (a) e macro-
escala (b). Retiradas da referência [76].

Neste capítulo falaremos sobre a modelagem, via formulação de fase, de problemas de transporte
de fluidos em meios porosos heterogêneos, específicamente com duas e três fases. Na formulação
de fase as equações diferenciais governantes são reescritas em função de uma pressão de referência,
neste trabalho escolhida como a pressão da fase oleosa, em conjunto com equações de transporte
das saturações referentes as outras fases presentes durante o escoamento [2]. A motivação para a
escolha dessa formulação para descrever o processo de transporte de fluidos vem do fato dela ser
mais geral [54]. As equações governantes provenientes dessa formulação mantém a mesma forma
para escoamentos de três e duas fases. Outra motivação para o uso da formulação de fase é que ela
mantém uma forma geral para as funções de permeabilidade relativa e modelos de pressão capilar
[54, 51, 49], o que facilita a modelagem da histerese no sistema governante. Por causa desses fatos,
sua aplicação é vantajosa para o propósito de desenvolvimento de ferramentas de aproximação
e simulação em problemas de transporte de fluidos em meios porosos heterogêneos em múltiplas
escalas.

Em conjunto com a formulação de fase, discutiremos também sobre a inclusão da histerese no
problema de escoamento bifásico de modo a ilustrar a diversidade da aplicação dessa formulação.
Em seguida, apresentaremos brevemente outras formulações usadas na modelagem de problemas
em dinâmica de fluidos em meios porosos.

Nosso principal objetivo é mostrar que há uma ampla classe de problemas de escoamento em
meios porosos que envolvem, em sua modelagem, um problema de natureza elíptica. Dessa forma,
métodos eficientes e robustos para a resolução de EDPs elípticas são de extrema importância.

2.1 Equações fundamentais de escoamento com duas e três
fases

As equações que governam o escoamento e transporte das fases fluidas em meios porosos hete-
rogêneos são dadas pelas equações de conservação de massa e pela extensão multifásica da equação
de Darcy [76, 133]. A equação de Darcy foi formulada como uma lei empírica pelo engenheiro

14



francês Henri Darcy em 1856 e estabelece uma relação entre a velocidade macroscópica do fluido
e o gradiente de pressão no caso monofásico [76, 133].

Neste trabalho consideramos o modelo matemático multifásico da lei de Darcy, com até três
fases, levando em conta forças capilares, expressões gerais para as funções de permeabilidade, po-
rosidade e campos de permeabilidade variáveis, e efeitos da gravidade. Na discussão da equações
governantes consideramos um fluxo bidimensonal de fases incompressíveis e imissíveis num meio
poroso heterogêneo. Consideramos que não há fontes ou sorvedouros internos e que não há trans-
ferência de massa entre as fases e os efeitos térmicos são desprezados. Observamos que existem
modelos mais gerais que levam em conta a transferência de massa entre as fases, como o modelo
composicional e o modelo Black-oil [133], porém esse não é o foco desse trabalho.

As fases gás, óleo e água serão indicadas pelas as letras g, o e w, respectivamente. Além
disso supomos que as fases saturam completamente os poros. Dessa forma, denotando a saturação
(fração de volume local) da fase ? por ?? [m3/m3], com 0 ? ?? ? 1, temos que,??

?

?? = 1, ? = ?, ?, ?. (2.1.1)

As equações da conservação de massa do óleo, gás e água são [133],

?

??
(?(x)????) + ? · (??v?) = 0, ? = ?, ?, ?, x ? R2, ? ? 0, (2.1.2)

onde ?(x) [m3/m3] denota a porosidade do meio poroso. Para a fase ?, ?? [Kg/m3] denota sua massa
específica, e v? [m3/m2 ?] é o seu fluxo volumétrico (ou velocidade de Darcy). O fluxo volumétrico
é obtido através da extensão multi-fase da lei de Darcy, (ver, [76], [133]),

v? = ??(x)
??
??

(??? ? ?? g ??), ? = ?, ?, ?, x ? R2, ? ? 0, (2.1.3)

onde ?(x) [m2] denota o tensor de permeabilidade absoluta do meio poroso. No caso geral (meio
poroso anisotrópico) ?(x) é uma matriz simétrica definida positiva, porém em casos relativamente
mais simples (meio poroso isotrópico) ?(x) é um escalar positivo [133, 76, 50]. Neste trabalho
utiliza-se essa modelagem. Para cada fase ?, ?? [Pa] é a pressão, ?? [? ? ?] é a viscosidade, e ??
[m3/m3] é a permeabilidade relativa. Cada permeabilidade relativa ?? é uma função adimensional
da saturação e é medida em laboratório. Experimentalmente, ?? (0 ? ?? ? 1) aumenta quando
?? aumenta, e as permeabilidades relativas nunca desaparecem simultâneamente [133, 76, 50]; g
[m/s2] é a gravidade e ? [m] é a profundidade.

As equações de Darcy (2.1.3) permitem que diferentes fluidos exerçam diferentes pressões.
Assim, definiremos a pressão capilar entre as fases ? e ?, ? ?= ?, por

??? = ?? ? ?? , (2.1.4)

e note que somente duas das seis possíveis pressões capilares são independentes uma vez que

??? = ????, ??? = ??? + ???. (2.1.5)

15



Um par independente deve ser medido experimentalmente como uma função do vetor de saturação
[133, 76, 50]. Se os efeitos térmicos e a compressibilidade forem ignorados, ?? e ?? serão constantes,
e (2.1.2) pode ser reescrita como:

?

??
(?(x)??) + ? · v? = 0, ? = ?, ?, ?. (2.1.6)

Este sistema deve ser complementado por condições de contorno e condições iniciais.
Para entender melhor as importantes características presentes na solução de escoamentos trifási-

cos o sistema governante (2.1.3)-(2.1.6), posto originalmente pelas equações básicas de conservação,
é reescrito em função de uma pressão de referência, aqui escolhida como a pressão do óleo pois
estamos no contexto de recuperação de petróleo, em conjunto a duas equações de transporte das
saturações das fases água e gás. Essa formulação se chama formulação de fase [54]. No contexto
desse trabalho, a escolha dessa formulação é justificada pelo fato dela ser mais geral, englobando
escoamentos de duas e três fases com e sem gravidade e histerese. Assim, a motivação de estudar
a resolução numérica de EDPs elípticas é mais forte pois se estende para diferentes modelos em
dinâmica de fluidos em meios porosos.

Nas próximas seções, vamos descrever em detalhes a formulação de fase para o problema trifá-
sico, bifásico e bifásico com histerese.

2.1.1 Modelo de escoamento de três fases com gravidade
Primeiramente, iremos definir a mobilidade relativa ??(??, ??) [m3/(m3 ? ? ?)], a mobilidade

total ?(??, ??), e o fluxo fracionário ??(??, ??) [m3/m3], respectivamente, por

??(??, ??) =
??
??

, ?(??, ??) =
??

?

??, ??(??, ??) = ??/?, ? = ?, ?, ?, (2.1.7)

e note que
??

? ?? = 1. Em seguida, definimos a velocidade total (ou fluxo volumetrico total) por
v =

??
? v? . Usando essas equações, podemos reescrever a equação (2.1.3) como [2],

v? = v?? + ?(x)??
??
? ?=?

?? (???? + ??? g ??), (2.1.8)

onde ??? ? ?? ? ?? . Portanto, por (2.1.6) e (2.1.8), o sistema de equações que governam o fluxo
para cada fase ? = ?, ?, ?, é:

?

??
(?(x) ??) + ? · (v??) = ? · {?(x)??

??
? ?=?

?? (???? ? ??? g ??)}. (2.1.9)

As equações diferenciais acima estão acompanhas de condições de contorno e iniciais típicas de
problemas em escoamento de fluidos em meios porosos. Abrindo as equações (2.1.9) temos,

?

??
(?(x) ??) + ? · (v??) =? · {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}, (2.1.10)

?

??
(?(x) ??) + ? · (v??) =? · {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}, (2.1.11)

?

??
(?(x) ??) + ? · (v??) =? · {?(x)?? [??(???? ? ??? g ??) + ??(???? ? ??? g ??)]}. (2.1.12)

16



Note que uma das equações acima é redundante pois
??

? ?? = 1.
Escolhemos ??, ?? e ?? como as três variáveis independentes do problema [7]-[13]. O sistema

(2.1.10)-(2.1.12) pode ser reescrito para as equações de saturação ?? e ?? usando a relação (2.1.1)
como,

?

??
(?(x)??) + ? · (v?? + G?) = ? · w?,

?

??
(?(x)??) + ? · (v?? + G?) = ? · w?, (2.1.13)

onde os termos do fluxo difusivo para as fases água, w?, e gás ,w?, em (2.1.13) são dados por

w? = ?(x) [??(1 ? ??)???? ? ????????] , (2.1.14)
w? = ?(x) [??(1 ? ??)???? ? ????????] . (2.1.15)

Os termos envolvendo a gravidade, G? = G?(??, ??, ?(x)), ? = ?, ?, que aparecem em (2.1.13)
são dados, respectivamente, por

G? = ?(x)[??(1 ? ??)??? ? ???????] g??, G? = ?(x)[??(1 ? ??)??? ? ???????] g??. (2.1.16)

As equações (2.1.13)-(2.1.16) levam a um sistema parabólico degenerado. De forma a resolvê-
lo para o campo de pressões ??, independentemente das saturações, as três equações (2.1.9) são
somadas de modo a obter o seguinte problema elíptico de Poisson de pressão-velocidade associado
ao sistema de fluxo trifásico para as pressões capilares ??? e ???,

? · v = 0, v = ??(x)?(??, ??)??? + v?? + v?? + v?, (2.1.17)

onde v?? e v?? são as velocidades de correção, definidas por v?? = ??(x)??(??, ??)???? , e v? é a
velocidade de correção devido a gravidade dada por v?(??, ??) = ?(x)?? g ??, onde ??(??, ??) ?
???? + ???? + ????.

Condições de contorno e iniciais para (2.1.13)-(2.1.17) devem ser impostas de modo a completar
a definição do modelo matemático; em particular, ?? e ?? devem ser especificados num tempo
inicial ? = ?0 (e.g., ? = 0).

As equações (2.1.13)-(2.1.17) podem ser adimensionalizadas identificando os valores caracterís-
ticos de cada variável [2, 13]:

?* = ? ??/?, ?* = ? ?, v* = v/??, ?*?? = ???/??,
?*?? = ???/??, ?

*
?? = ???/???? , ?

*
?? = ???/???? , ?

*(x) = ?(x)/??,
? * = ?/?, ? *(x)?*? = ?(x)??/(??/??), ?

*(x)?*? = ?(x)??/(??/??).

As equações adimensionalizadas tem a mesma forma que as (2.1.13)-(2.1.17) e dois importantes
grupos adimensionais aparecem,

?? =
?? ??? g

?? ??
, ?? =

?? ??
?? ?? ?

. (2.1.18)

O primeiro grupo, ??, quantifica a razão entre os efeitos gravitacionais e os efeitos convectivos
[2]. ?? é a permeabilidade característica (o valor médio de ?(x) na malha computacional) e ?? é a

17



velocidade total característica (em magnitude). O segundo grupo adimensional, ?? , representa a
razão entre os efeitos convectivos e difusivos [2]; ele controla a importancia relativa entre as forças
difusivas e convectivas. ? é o tamanho característico do sistema e ?? é o valor característico da
pressão capilar.

Após adimensionalizar o sistema trifásico (2.1.13)-(2.1.17) notamos que para cada fase ? =
?, ? os grupos adimensionais ?? e ?? estão, respectivamente, presentes junto aos termos difusivo
w?(??, ??, ?(x)), gravidade-convecção G?(??, ??, ?(x)) e de velocidade v:

?

??
(?(x)??) + ? · (v?? + ??G?) = ? · (?? w?),

?

??
(?(x)??) + ? · (v?? + ??G?) = ? · (?? w?),

? · v = 0, v = ??(x)???? + ?? (v?? + v??) + ??v?.

(2.1.19)

O sistema de equações governantes (2.1.19) são também sujeitas às condições de contorno e con-
dições iniciais de (2.1.13)-(2.1.17).

2.1.2 Modelo de escoamento de duas fases com gravidade
Uma das vantagens da formulação de fase [54, 55, 49] para o problema trifásico é que pode-

mos facilmente recair na formulação de fase para o problema bifásico com as mesmas suposições
colocando ?? = 0 (ou ?? = 0). Assim, as equações governantes são dadas [55] por,

?

??
(? (x) ??) + ? · (v?? + G?) = ? · w?, (2.1.20)

onde os termos de gravidade G?(??, x) e do fluxo difusivo w?(??, x), são dados respectivamente
por,

G? = ?(x)[??(1 ? ??)???]g??, e w? (??, x) = ?? (x) [?? (??) (1 ? ??)] ????. (2.1.21)
O sistema de pressão-velocidade é dado por,

? · v = 0, v = ?? (x) ? (??) ??? + vwo + v?, (2.1.22)
onde v?? = ?? (x) ?? (??) ???? é a velocidade de correção de fase e v?(??) = ?(x)?? g ?? é a
velocidade de correção devido a gravidade; e ??(??) ? ???? + ????.

As equações (2.1.20)-(2.1.22) podem ser adimensionalizadas identificando seus valores caracte-
rísticos, que são os mesmos que aparecem no caso trifásico. As equações resultantes são da mesma
forma que (2.1.20)-(2.1.22) e dois importantes grupos adimensionais aparecem:

?? =
?? ??? g

?? ??
, e ?? =

?? ??
?? ?? ?

. (2.1.23)

Esses grupos adimensionais tem a mesma interpretação dos grupos que aparecem na formulação
trifásica, e após a adimensionalização o sistema bifásico na formulação de fase fica,

?

??
(?(x)??) + ? · (v?? + ??G?) = ? · (?? w?),

? · v = 0, v = ??(x)???? + ?? v?? + ??vG.

18



Outra vantagem da formulação de fase é que facilita a inclusão da histerese, sem que a forma
das equações mudem.

2.1.3 Modelo de escoamento de duas fases com gravidade e histerese
As propriedades de escoamento de misturas de água e óleo em meios porosos são frequentemente

modeladas como se dependessem somente da saturação da água. A permeabilidade relativa, uma
das funções mais importântes em escoamento de fluidos, é tradicionalmente tomada como função
fixa das saturações dos fluidos. No entanto, estudos teóricos e experimentais revelam que isso
não é totalmente verdade: as permeabilidades relativas dependem das propriedades molhantes dos
fluidos, dos processos de embebição e drenagem, e da história do escoamento dos fluidos [120]. Ou
seja, o fluido apresenta histerese (ou memória) durante o escoamento. Uma explicação para esse
comportamento é que a distribuição da água e do óleo em poros de diferentes tamanhos tem um
papel importante em determinar as propriedades locais de escoamento, e essa distribuição pode
mudar numa escala de tempo diferente da escala de tempo das ondas hidrodinâmicas durante o
escoamento [27, 120]. Em escoamento imiscível de duas fases, água-óleo, a fase molhante (água) age
como um filme cobrindo as paredes dos poros e também preenchendo completamente alguns dos
poros menores. Quando ambas as fases são transportadas juntas no meio poroso, cada uma caminha
por um filamento de poro diferente. Tensões superficiais fazem com que a fase molhante preencha
preferencialmente os poros menores e a fase não molhante (óleo) preencha preferencialmente os
poros maiores, os quais estão cobertos por uma fina camada da fase molhante (água). Isso leva
a diferenças no comportamento do escoamento baseado na direção das mudanças da saturação
no tempo e espaço. Isto é, o escoamento exibe histerese. Essencialmente, histerese depende da
evolução da saturação, i.e., sua história de redistribuição nos poros.

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

WATER SATURATION  ( S
w
 )

P
E

R
M

E
A

B
IL

IT
Y

 F
U

N
C

T
IO

N
S

  
( 

k
w
, 

k
I , 

k
D
 )

Drainage ( k
D
o
 )

Imbibition ( k
I
o
 )

(a) Embebição ??? (??, ?), drena-
gem ??? (??, ?) da permeabilidade
do óleo, e permeabilidade ??(??)
da água.

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

WATER SATURATION  ( S
w
 )

P
E

R
M

E
A

B
IL

IT
Y

 F
U

N
C

T
IO

N
S

 P
L

A
N

E

Drainage ( k
D
o
 )

Scanning ( ? )

Imbibition ( k
I
o
 )

(b) Scanning curves para as curvas
de permeabilidade da fase óleo de
constante ?.

Figura 2.2: A permeabilidade do óleo não depende somente da saturação do fluido, mas também
do parâmetro de histerese e nas tendências da saturação (processos de embebição e drenagem).

19



Matematicamente [27, 152], os efeitos de histerese são modelados supondo que (i) existem duas
curvas extremas de permeabilidade para o óleo e para a embebição e drenagem que descrevem o
escoamento quando a saturação do óleo está decrescendo e crescendo, respectivamente, de maneira
irreversível, ver Figura 2.2.(a); e (ii) existe uma família de curvas de permeabilidade contínuas,
chamada de scanning curves, ver Figura 2.2.(b), que estão entre as curvas de absorção e drenagem
e descreve o escoamento quando da permeabilidade do óleo muda irreversivelmente. Absorção
ocorre quando a saturação da fase molhante aumenta, e a drenagem acontece quando a saturação
da fase não molhante aumenta [152, 116].

Para escoamento de duas fases, o primeiro modelo matemático levando em conta os efeitos de
histerese foi formulado em [120]. Neste artigo, apenas as curvas de absorção e drenagem foram
modeladas. Um modelo mais completo para a histerese, que incorpora as scanning curves de
permeabilidade, chamado de Scanning Hysteresis Model (SHM) foi introduzido em [88] e supõe
que o equilíbrio é sempre mantido e descreve a fenomenologia da histerese da permeabilidade
relativa ao introduzir um parâmetro de histerese para parametrizar as scanning curves.

Na presente modelagem de escoamento bifásico com histerese em meios porosos heterogêneos
usamos um modelo chamado de Scanning Hysteresis Model with Relaxation (SHMR) [27]. Esse
modelo estende o SHM ao, (a) permitir o scanning flow se estender além das curvas de absorção e
drenagem, e; (b) tratando as curvas somente como atratores de estados fora da região de scanning.
A atração, ou relaxação, ocorre numa escala de tempo que corresponde a redistribuição de fases
nos poros conduzida pelas forças capilares [27].

Neste modelo uma variável de estado, o parâmetro de histerese ? = ?(x, ?), é introduzida
para contabilizar a dependência da permeabilidade do óleo, ??(??, ?), da história do fluxo [27]. A
seguinte equação diferencial parcial, em sua forma adimensional,

??

??
= ? (??, ?) =

???
??

(?? (??) ? ?)/?, if ? &amp;lt;?? (??) ,
(?? (??) ? ?)/?, if ? &gt; ?? (??) ,
0, caso contrário,

é usada para modelar os processos de absorção e drenagem de modo a incorporar a histerese
durante o mecanismo de injeção de água [27].

A permeabilidade da água não possui histerese, dessa forma ?? = ??(??). ?? e ?? estão rela-
cionados aos processos de embebição e drenagem, respectivamente, via do mecanismo de histerese.
A constante ? define uma escala de tempo que corresponde a redistribuição de fase dentro do meio
poroso.

A extenção das equações (2.1.13)-(2.1.17) para incorporar a histerese é direta, e as equações
governantes são dadas por:

?

??
(? (x) ??) + ? · (v?? (??, ?) + G? (??, x, ?)) = ? · w? (??, x, ?) , (2.1.25)

? · v (??, x, ?) = 0, (2.1.26)

v (??, x, ?) = ?? (x) ? (??, ?) ??? + v?? (??, x, ?) + v? (??, x, ?) , (2.1.27)

20



??

??
= ? (??, ?) =

???
??

(?? (??) ? ?)/?, if ? &amp;lt;?? (??) ,
(?? (??) ? ?)/?, if ? &gt; ?? (??) ,
0, caso contrário.

(2.1.28)

Condições iniciais e de contorno devem ser impostas para completar o modelo.

2.2 O modelo do traçador passivo e da pressão global
Nessa seção, iremos apresentar outros modelos físicos, no contexto de escoamento em meios

porosos, onde um problema elíptico naturalmente aparece.

2.2.1 Traçador passivo
A formulação do traçador passivo apresentada em [34] modela o escoamento de um fluido que

carrega um soluto passivo pelo meio poroso. Essa modelagem ignora os efeitos de gravidade,
compresssão (do gás) e dispersão na escala do poro. A porosidade do meio é fixada como uma
constante. Assim, o modelo é dado por

??

??
+ v · ?? = 0, (2.2.1)

v = ?
??
?

??, ? · v = 0 (2.2.2)

onde ? corresponde a saturação do fluido marcado, v é a velocidade do fluido dado pela lei de
Darcy, ?? a permeabilidade, ? a viscosidade, e ? a pressão. Condições de contorno e condições
iniciais são necessárias para completar o modelo (2.2.1)-(2.2.2). Note que nessa formulação aparece
um problema de pressão-velocidade de natureza elíptica, dada pela equação (2.2.2), acoplado ao
problema de transporte de saturação.

2.2.2 A formulação da pressão global
Apresentamos a formulação global para fluxo de duas fases, água (w) e óleo (o), para fluidos

incompressíveis e imissíveis, em que não há transferência de massa entre as fases e sem influência
da gravidade [70]. As equações de balanço de massa e velocidade de Darcy são as dadas por (2.1.2)
e (2.1.3), respectivamente.

Temos que ?? + ?? = 1 e as mobilidades e fluxos fracionários são dados como em (2.1.7).
Definimos a pressão capilar como ?? = ?? ? ??.

Assim, definimos a pressão global como [70]

? =
1
2

[?
?? + ?? +

?? ??
0

(?
?0?

?1
? (?) ? ???

?1
? (?)

)?
??
]?

. (2.2.3)

21



A equação de saturação é dada, supondo que apenas água é injetada no reservatório e que a
produção de água é proporcional a sua mobilidade local, por:

?
??

??
+ ??v · ?? + ? · (?(x)?????????) =

??
?(1 ? ??)?, se ? &gt; 0,0, se ? &amp;lt;0, (2.2.4)

onde ? é o fluxo volumétrico externo total, definido por ? = ?? + ??. A equação de pressão-
velocidade é dada por,

? · v = ?(?, ?), v = ??(?)?(?)??. (2.2.5)
Condições de contorno e condições iniciais são necessárias para completar o modelo (2.2.3)-(2.2.5).
Note que novamente temos uma formulação de um problema em escoamento de fluidos em meios
porosos em que um problema de natureza elíptica: o problema de pressão-velocidade (2.2.5).
Nessa formulação para o problema bifásico, o acoplamento entre as equações de pressão-velocidade
e saturação é menor que na formulação de fase. No entanto, isso não acontece para a formulação
com pressão global para o problema trifásico. É bem entendido que para o problema trifásico essa
formulação nem sempre existe [54]; ver também [49].

Considerando os modelos matemáticos discutidos aqui, formulação de fase, formulação global
e traçador passivo, podemos ver que para todas essas formulações temos uma EDP de natureza
elíptica, dada por um problema de pressão-velocidade acoplado a um problema de transporte de sa-
turação. Dessa forma, mostramos que problemas elípticos frequentemente aparecem na modelagem
de problemas de transporte de fluidos em meios porosos. Como esses modelos envolvem grandes
sistemas acoplados de equações diferenciais parciais não-lineares, uma grande preocupação em si-
mulação numérica é desenvolver técnicas estáveis, robustas e eficientes para sua aproximação. Há
diversas estratégias para a aproximação da solução de problemas em escoamento multifásicos como
o IMPES (implicit in pressure and explicit in saturation), SS (simultaneous solution), sequential
methods, adaptative implicit methods, entre outros [53, 55, 133]. Estratégia IMPES se comporta
bem em problemas com dificuldade e não-linearidades intermediárias, como o escoamento bifásico
incompressível e é muito usada na indústria do petróleo [53, 55]. Porém, ela não é eficiente para
problemas com fortes não-linearidades e problemas com mais de duas fases. A técnica SS é inte-
resante para formulações que envolvem poucas componentes, como o Black-oil e modelos termais
[55], enquanto que os esquemas sequenciais (sequential methods) são adequados para problemas
com muitas componentes, como o modelo composicional [55, 53]. Adaptative implicit methods pro-
curam um meio termo entre IMPES (ou SS) e sequential methods [55]. Os esquemas acima foram
desenvolvidos pensando nas dificuldades encontradas na aproximação de sistemas não-lineares de
EDPs. Dessa forma, considerando que o foco deste trabalho está na resolução de problemas elípti-
cos, optamos por uma técnica de decomposição de operadores para aproximar a solução do sistema
governante de equações diferenciais de escoamentos multifásicos. Essa técnica é interessante pois é
capaz de separar a resolução numérica dos problemas de pressão-velocidade e saturação, de modo a
“isolar” a EDP elíptica [7, 8, 9, 2]. Podemos então, escolher métodos específicos e robustos para re-
solver o problema elíptico isoladamente. Outro motivo para a escolha dessa técnica é que ela pode
ser empregada em uma grande variedade de problemas de transporte de fluidos. Como veremos no
próximo capítulo, ela engloba, em conjunto a formulação de fase, problemas com três e duas fases,
e também pode ser empregada em problemas onde há histerese, apresentado na Seção 2.1.3. A

22



possibilidade de aplicação dessa técnica em uma grande variedade de problemas torna a técnica de
decomposição de operadores interessante de um ponto de vista de implementação computacional
para a simulação de problemas em dinâmica de fluidos em meios porosos heterogêneos. Assim,
podemos nos concentrar somente na aproximação do problema de contorno de Poisson associado
ao problema de pressão-velocidade.

No próximo capítulo, para ilustrar melhor a técnica de decomposição de operadores usada
vamos nos concentrar na aproximação numérica das equações governantes do problema trifásico
(2.1.19).

23



24



Capítulo 3

Modelagem computacional das equações
governantes em fenômenos de transporte
em meios porosos heterogêneos

No Capítulo 2 deduzimos por meio da formulação de fase as equações diferenciais governantes
que modelam o problema de transporte de fluidos em meios porosos heterogêneos para três e
duas fases, onde as equações são escritas em termos de uma pressão de referência com respeito
às saturações das fases presentes no escoamento [7, 8, 9, 2, 55, 54]. Vemos que para esse tipo
de formulação, e para outras formulações, temos uma EDP elíptica associada a um problema de
pressão-velocidade, acoplado as equações de transporte das saturações.

Há diversas estratégias (citadas brevemente no Capítulo 5) para aproximar as equações go-
vernantes resultante das leis básicas de conservação, suplementada por relações contitutivas que
tipicamente são obtidas por experimentos de laboratório [7, 8, 9, 2, 55, 54].

Como estamos interessados na resolução numérica do problema de Poisson, é de interesse usar
uma técnica de decomposição de operadores para aproximar a solução do sistema de equações
governantes, de modo a “isolar” a EDP elíptica.

Técnicas de decomposição de operadores, em conjunto a métodos numéricos, são usadas com
o intuito de decompor um sistema acoplado de equações diferenciais em modelos individuais mais
simples, respeitando seu comportamento fisico e matemático, podendo então aproximar cada um
desses modelos através de métodos numéricos apropriados, visando uma maior eficiência compu-
tacional [91]. A decomposição de operadores é regularmente aplicada em diversas áreas como
transporte reativo para combustão [135, 86], química da atmosfera [117, 86, 35, 32], e também tem
sido frequentemente empregada em simulação de problemas de escoamento em dinâmica de fluidos
em meios porosos [86, 2, 7, 8, 64].

Neste trabalho usamos uma técnica de decomposição de operadores baseada na física onde
o sistema original de equações é reescrito de modo a exibir claramente a sua natureza física e
matemática, ou seja, na forma de modelos hiperbólico, parabólico, elíptico ou misto no contexto de
classificação (local) de EDPs que representam os processos fisicos presentes durante o escoamento
de fluidos em meios porosos.

Ao reescrever o sistema original de equações, técnicas numéricas distintas e apropriadas podem

25



ser empregadas, dentro da formulação de decomposição de operadores, para resolver apropriada-
mente e eficentemente cada subproblema.

Técnicas de decomposição de operadores constituem uma das principais pontes entre análise
numérica e análise funcional. Em análise numérica, as técnicas de decomposição de operado-
res representam algoritmos numéricos eficientes com o objetivo de aproximar de maneira precisa
equações e sistemas de equações diferenciais de evolução temporal de forma computacionalmente
conveniente para incorporar efeitos físicos distintos. Em análise funcional, essas técnicas são usadas
para a demonstração de estimativas de erro, existência de solução e teoremas de representação.
Os artigos [80, 57, 144] discutem os usos da técnica de decomposição de operadores e indicam
uma grande variedade de referências na literatura. Veja também os trabalhos [109, 63, 107, 108,
86, 110, 104, 56, 4, 5, 8, 2] para desenvolvimentos recentes na análise dos erros presentes na de-
composição de operadores (time-splitting errors) para problemas unidimensionais não lineares de
convecção-difusão.

Neste capítulo iremos aplicar uma técnica de decomposição de operadores no sistema de equa-
ções governantes (2.1.19) do modelo trifásico com gravidade, com a intenção de “isolar” o problema
de Poisson para aproximação numérica.

3.1 Decomposição de operadores
Para ilustar melhor a técnica de decomposição de operadores usada vamos nos concentrar na

aproximação numérica das equações governantes do problema trifásico (2.1.19).
A técnica usada é um procedimento baseado na decomposição de operadores de dois níveis,

de maneira a desacoplar as equações (2.1.19), [86, 110, 64, 2, 7]. No primeiro nível, separamos o
cálculo do problema de pressão-velocidade (2.1.17), de natureza elíptica, do cálculo do problema
de transporte das saturações (2.1.13). No segundo nível, separamos o cálculo das saturações em
cálculo de subproblemas de transporte difusivo, de natureza parabólica, e de transporte convec-
tivo, de natureza hiperbólica. Essa estratégia reflete as diferentes naturezas matemáticas e físicas
presentes na formulação do problema de transporte de fluidos em meios porosos heterogêneos [7]-
[13]. Assim, podemos usar diferentes estratégias de aproximação para cada subproblema, ou seja,
podemos escolher o método numérico mais apropriado para a resolução de cada subproblema se
adaptando as suas características fisicas inerentes.

Basicamente, essa técnica de decomposição de operadores aproxima sequencialmente os proble-
mas de pressão-velocidade, transporte difusivo e transporte convectivo, com métodos numéricos
específicos a cada um deles, de maneira iterativa. A solução aproximada de cada problema é usada
na resolução numérica do problema seguinte, e assim por diante até o fim da simulação. Isso per-
mite que o passo de tempo para a atualização do campo de velocidades para o cálculo do problema
de pressão-velocidade seja maior do que o usado para o problema de difusão, que por sua vez pode
ser maior do que o passo do cálculo que incorpora os efeitos de convecção [7, 2]. Desta maneira,
três passos de tempo são naturalmente introduzidos na decomposição de operadores: ??? para a
solução do problema hiperbólico associado ao transporte convectivo de fluidos, ??? para o cálculo
dos efeitos difusivos, e ??? para a solução do problema de pressão-velocidade, de modo que

??? ? ??? ? ???. (3.1.1)

26



Os problemas hiperbólico e parabólico não serão tratados nesse trabalho.
A velocidade v é uma função suave no tempo [11] como uma função das saturações (??, ??). Por

esse motivo resolvemos primeiramente as equações de pressão-velocidade. Consideramos também
as saturações no tempo presente de modo a linearizar seus coeficientes não-lineares. Após encontrar
o campo de velocidades ele é usado para calcular as saturações no no tempo seguinte via a equação
(2.1.13) [2, 7].

Em resumo, o procedimento de resolução temporal, por decomposição de operadores, é:

?? = ????, ?? = ????, e ??,? = ?? + ????, 0 ? ? ? ?2, (3.1.2)

de forma que ??,?2 = ??+1. A pressão do óleo e a velocidade de Darcy serão aproximadas nos
tempos ??, ? = 0, 1, 2, . . . . As saturações ??, e ?? serão aproximadas nos tempos ??, ? = 1, 2, . . . ,
lembrando que elas devem ser dadas no tempo ? = 0. Além disso, temos valores de saturação
computados em tempos intermediários ??,?, para ?? &amp;lt;??,? ? ??+1, onde resolvemos o subproblema
hiperbólico levando em conta o transporte convectivo da água e/ou gás, mas não os efeitos difusivos.
O algoritmo para a resolução é detalhado abaixo.

Primeiro nível:

1. Dados ??? (x) e ??? (x), ? ? 0, determine o par (??? , v?) através das equações do problema
de pressão-velocidade (2.1.17), sujeito as condições de contorno dadas.

2. Para ?? &amp;lt;? ? ??+1, resolva o sistema de difusão-convecção (2.1.13) com condições iniciais
??(x, ??) = ??? (x) e ??(x, ??) = ??? (x); ??? (x) e ??? (x) são dados como os valores finais
calculados em [???1, ??] para ? &gt; 0 ou como a saturação inicial para ? = 0.

Segundo nível:

1. Seja ??1 = ?? e assuma que (??, v, ??, ??) são conhecidos em ? ? ??1.

2. Para ? = ?1, . . . , ?2 = ?1 + (?1 ? 1):
Primeiro, para ? = 0, . . . , (?2 ? 1) e ? ? [??,?, ??,?+1], resolva o sistema convectivo dado por
(??,?? é substituido por ??? abaixo)

?

??
(?(x) ???)+?·[E(??,?, v) ?

?
? +G

?
?] = 0,

?

??
(?(x) ??? )+?·[E(??,?, v) ?

?
? +G

?
? ] = 0, (3.1.3)

??,? &amp;lt;? &amp;lt;??,?+1, com condições iniciais,

??? (x, ??,?) =
{?

??(x, ??), ? = 0,
???1? (x, ??,?), ? = 1, . . . , ?2 ? 1,

(3.1.4)

e condiçe?s de contorno,

[E(??,?, v) ? ?? + G
?
?] · ? = ? ??(?

?
? , ?

?
? ), [E(??,?, v) ?

?
? + G

?
? ] · ? = ? ??(?

?
? , ?

?
? ), (3.1.5)

para (?, ?) ? {0} × [0, ? ], e ? = ?, ?, onde ??? , ??? são as saturações da água e do gás
injetada na mistura e ? denota a razão de injeção volumétrica dos fluidos de injeção; o
operador E(??,?, v) extrapola linearmente o campo de velocidades v??1 e v? no tempo
??,? ? (??, ??+1).

27



3. Tome ??(x, ??) = ??2?1? (x, ??,?2 ), ? = ?, ?.
Resolvemos o subproblema difusivo nos tempos ?? = ????, ? = 1, 2, . . . ; lembrando que eles
precisam ser especificados em ? = 0,

?

??
(?(x) ??) ? ? · w? = 0,

?

??
(?(x) ??) ? ? · w? = 0, (3.1.6)

?? &amp;lt;? &amp;lt;??+1, com condições iniciais e de contorno,

w? · ? = 0, ? = ?, ?, x ? ??, ??(x, ??) = ???1,?2?1? (x, ??), ? = ?, ?, (3.1.7)

onde ??,?? é definido em (3.1.3)-(3.1.4).

Este algoritmo deve ser repetido até o fim estipulado do tempo de simulação [7, 8, 9].

Com a decomposição de operadores “isolamos” o problema de pressão-velocidade, o qual está
associado a um problema de natureza elíptica. Dessa forma, podemos nos concentrar em técnicas
de discretização e métodos numéricos que melhor se aplicam para a aproximação do problema de
Poisson levando em conta sua origem.

No capítulo seguinte aplicaremos o método de elementos finitos mistos para discretizar o pro-
blema de pressão-velocidade.

28



Capítulo 4

Aproximação numérica das equações
diferenciais parciais governantes

Após a aplicação da decomposição de operadores no capítulo anterior, o problema elíptico é
totalmente identificado após uma conveniente linearização do coeficiente do fluxo de velocidade,
ou lei de Darcy [136, 137, 41, 39]. Agora, precisamos nos concentrar em escolher uma metodologia
para aproximar o problema elíptico. Fundamentalmente, essa escolha deve ser guiada pela natureza
matemática do modelo diferencial sob investigação tendo em vista que se espera recuperar no nível
discreto, as mesmas propriedades físicas (e matemáticas) do modelo original posto no contínuo.
Neste contexto, pode-se citar várias técnicas para discretização de problemas elípticos, como por
exemplo, Diferenças Finitas [147, 140], Volumes Finitos [74, 153], Diferenças finitas miméticas (ou
Mimetic finite differences) [119, 28, 40, 140], Elementos Finitos (clássico) [39], Elementos Finitos
da classe Galerkin Descontínuo [67, 23, 134], Elementos Finitos Mistos Híbridos em espaços ?(???)
[136, 137, 41] entre outros, como elementos finitos generalizados [26].

Neste trabalho adotamos a abordagem de discretização por Elementos Finitos Mistos Híbridos
em espaços ?(???) de Raviart-Thomas de menor índice [136, 137, 41]. A escolha dessa abordagem
é motivada fundamentalmente pela sua bem sucedida aplicação em problemas trifásicos [2, 6,
14, 8, 5, 4, 11, 7, 13, 10, 9] e previamente pelo bom desempenho na aproximação numérica e
simulação de escoamentos bifásicos água-óleo, dentro da tradição estabelecida por Jim Douglas
Jr., Richard Ewing, Thomas F. Russell e Mary F. Wheeler nos trabalhos conjuntos [65, 83, 69,
84, 138] e mais recentemente nos trabalhos [7, 9, 18, 73, 72, 71] e nas referências lá citadas. Nesta
série de trabalhos, elementos finitos mistos híbridos foram identificados como muito apropriados
para calcular, de forma precisa, campos de velocidade na presença de heterogeneidades geológicas
do meio poroso. Isto é, ele trata de forma eficiente a alta variabilidade dos valores dos campos
de permeabilidade e porosidade. Além disso, é válido mencionar que a formulação de elementos
finitos mistos híbridos possui um rigorosa fundamentação matemática e tem conexão refinada com
distintas abordagens em análise numérica para problemas elípticos [136, 137, 41, 39, 23, 153, 28].

Neste capítulo discutiremos em detalhes discretização por elementos finitos mistos híbridos
do subproblema elíptico associado ao problema de pressão-velocidade (2.1.17) do modelo trifásico
com gravidade. Para o modelo bifásico, a discretização é análoga [41, 39, 52]. A ideia básica
é obter, após a discretização, um sistema linear com boas propriedades matemáticas, como ser

29



“bem condicionada” e ter uma natureza localmente conservativa no nível discreto, tal qual seu
corresponde operador diferencial no contínuo.

Iremos também citar, brevemente, técnicas localmente conservativas para a aproximação dos
subproblemas hiberbólico e parabólico obtidos após a aplicação da técnica de decomposição de
operadores. No entanto, a aproximação desses problemas não será o foco nesse trabalho.

4.1 Discretização do sistema parabólico e hiperbólico de
EDPs associado ao problema de transporte de convecção-
difusão

A técnica de decomposição de operadores empregada no capítulo anterior nos permite separar
os processos fisícos que atuam no modelo de escoamento trifásico em meios porosos heterogêneos.
Nosso interesse principal neste trabalho é na resolução do subproblema elíptico associado ao pro-
blema de pressão-velocidade. Porém não podemos esquecer que esse problema está associado a
um sistema de transporte de saturações, e como vimos no capítulo anterior, a EDP elíptica é
resolvida em conjunto (e em sequência) aos subproblemas de difusão (parabólico) e conveccção
(hiperbólico), pela técnica de decomposição de operadores de modo a aproximar numericamente a
solução do problema trifásico de transporte de fluidos em meios porosos heterogêneos. A resolução
dos subproblemas parabólico e hiperbólico não será discutido neste trabalho, no entando existe
diversas técnicas usadas para a aproximação desses problemas [7]-[13].

Das técnicas existentes para aproximar problemas parabólicos temos, por exemplo, Diferenças
Finitas, Volumes Finitos [133, 55, 53]. Temos também o método de elementos finitos mistos
hibridos em conjunto a uma estratégia implícita para discretizar o operador temporal [2, 9, 10].

Para o subproblema hiperbólico temos os esquemas conservativos centrais de diferenças fi-
nitas como o Nessyahu-Tadmor (NT) [129] e Kurganov-Tadmor (KT) [114]. Há também os mé-
todos Euleriano-Lagrangeanos como o Modified Method of Characteristics (MMOC) [61], Eulerian-
Lagrangian Localized Adjoint Methods (ELLAM) [62, 47], e Locally Conservative Eulerian-Lagrangian
Method (LCELM) [18, 73], porém a extensão dessa última classe de métodos para sistemas de leis
de conservação ainda não é bem entendido. Logo essas metodologias ainda não podem ser aplica-
das a problemas trifásicos e bifásicos. Outro método importante para problemas hiperbólicos é o
método de Godunov [98]. Ele é bastante usado em problemas que apresentam descontinuidade na
solução. Para uma maior discussão da aproximação desses sub-problemas no contexto de dinâmica
de fluidos indica-se os trabalhos [2, 6, 14, 8, 5, 4, 11, 7, 13, 89, 22, 21, 73, 72, 71, 24, 18].

Nas próximas seções apresentamos o método de elementos finitos mistos para a discretização
do problema de pressão-velocidade.

30



4.2 Discretização por elementos finitos mistos da EDP elíp-
tica associada ao problema de pressão e velocidade

Tendo separado a equação de pressão-velocidade (2.1.17) no Capítulo 3 vamos aproximar o
par (?, ??) através do método de elementos finitos mistos híbridos. Efetivamente, as simulações
numéricas para a previsões de cenários e tomada de decisões do problema de escoamento em meios
porosos heterogêneo requerem uma aproximação muito boa do campo de velocidades dos fluidos
em movimento. Por esta razão métodos mistos são adequados para a aproximação simultânea das
equações de pressão e velocidade [55, 53, 7, 9, 73, 72, 71].

Durante todo esse trabalho iremos trabalhar com um domínio bidimensional, porém as ideias
descritas em detalhes aqui podem ser facilmente extendidas para domínios tridimensionais sem
dificuldades, dado que ?? seja aproximado por constantes em cada elemento. Elementos de ordem
maior precisariam de algumas modificações não triviais no método [2]. Para domínios unidimen-
sionais as ideias também se aplicam, mas precisam de certos cuidados.

Considere um reservatório horizontal, sem influência da gravidade no escoamento do fluido.
Considere também um domínio computacional retangular particionado em quadrados uniformes
usando o espaço de Raviart-Thomas retangular mais simples [136] nessa partição, i.e., ? ? ?? = ??.
Sem perda de generalidade, seja ? = [0, ?] × [0, ? ] ? R2 um domínio retângular limitado com
uma fronteira Lipschitz ??. Seja {?? , ? = 1, . . . , ? } uma partição de ?:

?? = ???=1??? ; ?? ? ?? = ?, ? ?= ?. (4.2.1)

Suponha que ??? , ? = 1, . . . , ? , também é Lipschitz e ?? = ?? × ?? = ? × ?. Defina ? = ??, e

?? = ? ? ??? , ??? = ??? = ??? ? ???. (4.2.2)

Vamos reescrever o problema de pressão-velocidade (2.1.17) em uma forma mais conveniente,
facilitando os cálculos. Definindo u = (v ? v?? ? v??) podemos reescrever essa equação na forma,

? · u = ?? , u = ??(x)?(??, ??)??, x ? ? ? R2, (4.2.3)

onde ?? = ?? · (v?? + v??) e ? ? ??, sujeito as seguintes condições de contorno,

u · n =
{?

??, para ? = {0}, ? ? [0, ? ],
0, para ? = {0, ? }, ? ? [0, ?], (4.2.4)

onde n é o vetor unitário normal externo à fronteira ?? e ? é a taxa de injeção do fluido. Também
mantemos uma pressão de referência ???? em ? = {?} e ? ? [0, ? ], como visto na Figura 4.1.

Inicialmente iremos tratar do caso em que {?? } é uma partição do domínio ? em elementos
individuais e vamos discutir a forma fraca da equação de pressão-velocidade (4.2.3).

Introduzimos os seguintes espaços globais:

?2(?) = {? |
??

?|?(?)|2 ?? &amp;lt;?}, ?(div; ?) = {u ? (?2(?))2 | div u ? ?2(?)},
? (?) = {? ? ?2(?) |

??
? ?(?) ?? = 0}, ??(?) = {u ? ?(div; ?) | u · n = ? em ??}.

31



Figura 4.1: Domínio retangular do problema de pressão-velocidade (4.2.3)-(B.2.2).

A forma fraca global da equação de pressão-velocidade (4.2.3) é dada [41] por: encontrar {?, u} ?
? × ?? tal que,

(??1? ?1u, u?) + (??, u?) = 0, u? ? ?0, (4.2.5)
(? · u, ?) = (?? , ?), ? ? ?2(?). (4.2.6)

Agora, vamos definir a forma fraca localmente nos elementos {?? }. Isto é, considere os problemas
nas partições {?? }, ? = 1, . . . , ? , e defina os espaços,

??,? = {u ? u(?? )) | u · n? = ? em ?? }, ?? = {? |?? | ? ? ? (?)},

e queremos que {u? , ?? } (definindo ?? = ?|?? , etc.) seja solução de (4.2.5)-(4.2.6) para x ? ?? ,
? = 1, . . . , ? , dessa forma é necessário impor condições de consistência [2, 85, 10],

?? = ??, ? ? ???, (4.2.7)
u? · n? + u? · n? = 0, ? ? ???, (4.2.8)

onde n? é o vetor normal externo ao elemento ?? ? ?.
A formulação fraca local do sistema de pressão-velocidade (4.2.5)-(4.2.6) correspondente a de-

composição de domínios acima é dada ao procurar soluções aproximadas ? ? ? e u ? ?? tal que,
{?? , u? } ? ?? × ??,? e que, após aplicar o teorema da divergência no termo (??, u?) [41] fica,

(? · u, ?)?? ? (?? , ?)?? = 0, ? ? ?? , (4.2.9)
(? ?1??1u, u?)?? ? (?, ? · u?)?? +

??
? ?=?

??, u? · n? ???? = 0, u? ? ??,? , (4.2.10)

Quando o sistema (4.2.9)-(4.2.10) é aproximado no espaço de Raviart-Thomas obtemos um
sistema linear por blocos do tipo, [30],(?

A ?B?
B 0

)?(?
u
p

)?
=
(?

Ru
Rp

)?
(4.2.11)

onde a matriz A é simétrica definida positiva, a matriz (?B?) representa uma aproximação do
operador divergente e B uma discretização do operador gradiente [30, 41]. Esse é um problema
indefinido, chamado de problema de ponto de sela.

32



Há várias possibilidades de resolver o sistema (4.2.11). Uma dessas possibilidades é reformulá-
lo como um problema do tipo complemento de Shur, por meio de eliminação de Gauss por blocos
[30, 41]. Outros métodos numéricos que resolvem (4.2.11) são os métodos iterativos do tipo ponto
fixo. Entre esses métodos está o método de Uzawa e o método de Arrow-Hurwicz [30, 41, 52].

Outra forma de resolver o problema de ponto de sela, e que iremos descrever neste trabalho, é
reescrever convenientemente o problema via multiplicadores de Lagrange [41, 52], de modo que o
sistema linear equivalente tenha uma matriz que seja simétrica e definida positiva.

A seguir, introduzimos os multiplicadores de Lagrange, definidos como a pressão nas fronteiras
dos elementos, de modo a transformar o problema de ponto de sela em um problema simétrico e
definido positivo.

4.2.1 Elementos Finitos Mistos Híbridos
Seja ? ?? × ? ?? o espaço de elementos finitos mistos sobre {?? }. Cada um desses espaços é

definido através de espaços locais ? ?? × ? ?? = ? ?(?? ) × ? ?(?? ), [2, 41, 9].
Em cada espaço de elementos mistos, as funções genericas ? ? ? ?? e u ? ? ?? podem ser

descontínuas em ???. Como consequência, tentar impor as condições de consistência (4.2.7) e
(4.2.8) forçaria a continuidade da pressão ?, ou seja, as condições de consistência (4.2.7) e (4.2.8)
não seriam satisfeitas a não ser que a solução aproximada da pressão fosse constante em todo
o domínio [71]. Esse caso não é interessante no contexto desse trabalho. Estamos interessados
em meios heterogêneos, onde a grande variabilidade das propriedades do meio causa gradientes
abruptos de pressão, i.e., a pressão não é constante.

Dessa forma, introduzimos os multiplicadores de Lagrange ??? nas arestas {???}, [2, 10]. Os
multiplicadores de Lagrange podem ser fisicamente definidos como pressão nas fronteiras, e seu
principal propósito é introduzir um novo parâmetro de modo a relaxar as condições de consistência.
Dessa forma o método permite uma maior flexibilidade no tratamento de pressões descontínuas, o
que é de extremo interesse nesse trabalho. Características multiescala do meio poroso heterogêneo
significam grande variabilidade das propriedades geológicas das rochas, como permeabilidade e
porosidade, e elas influenciam fortemente o transporte de fluidos no meio. Então é razoável esperar
a formação de gradientes abruptos de pressão durante todo o escoamento do fluido, de modo
que formulações numéricas para a aproximação das equações governantes devem tratar bem o
aparecimento de pressões descontínuas.

Suponha que, quando u?? = u?|?? , u? ? ? ?, sua componente normal u?? · n? em ??? é um
polinômio de grau fixo ? = grau(u?? · n? ), por simplicidade supomos que ? é independente de ???.
Seja, ???? ? ??(?? ) definido pela projeção,

?? ? ???? , u? · n? ??? = 0, u? · n? ? ??(?? ), ?? ?= ?. (4.2.12)
E seja,

? ? = {u ? ?(div; ?) | u? ? ? ?? e u? · n? |?? = ???? }, ? ? = {? ? ?2(?? ) | ?? ? ? ?? },
?? = {? : ?|??? ? ??(???) = ???, ??? ?= ?}.

Note que há duas cópias de ?? associadas ao conjunto ???: ??? e ??? .

33



O método de elementos finitos híbridos é dado [52] por: Procurar {?? , u? , ???} ? ? ?? × ? ?? × ???,
? = 1, . . . , ? , tal que para todo u? ? ? ?, ? ? ? ? e ?? ? ??:

(? · u? , ?)?? ? (?? , ?)?? = 0, (4.2.13)

(? ?1??1u? , u?) ? (?? , ?·u?)?? +
??
? ?=?

????, u? · n? ???? = 0, (4.2.14)

???
?=1

(??, u? · n? )?? = 0. (4.2.15)

A inclusão dos multiplicadores de Lagrange transforma o problema de ponto de sela (4.2.11)
em um novo problema dado por [52, 41]:

?
?? A B CB? 0 0

C? 0 0

?
??
?
??up

?

?
?? =

?
??fg

0

?
?? , (4.2.16)

onde A é uma matriz diagonal por blocos, e cada bloco corresponde a um elemento ?? [52]. O
sistema linear (4.2.16) representa as equações (4.2.13)-(4.2.15) após a introdução das funções de
base para os espaços ? ?, ? ? e ??.

A matriz A do sistema linear (4.2.16) é facilmente inversível a nível de elemento. Dessa forma,
podemos escrever a primeira equação de (4.2.16) como,

u = A?1(f ? Bp ? C?). (4.2.17)

Substituindo (4.2.17) nas outras equações de (4.2.16) temos que,

B?A?1Bp + B?A?1C? = g ? B?A?1f (4.2.18)
C?A?1Bp + C?A?1C? = ?C?A?1f (4.2.19)

Sabemos que C?A?1C é simétrica definida positiva [154]. Assim, podemos reescrever a equação
(4.2.19),

? = (C?A?1C)?1
[?
?C?A?1Bp ? C?A?1f

]?
(4.2.20)

E substituindo a equação acima em (4.2.18) temos um sistema linear Hp = R,

H = B?A?1B ? (B?A?1C)(C?A?1C)?1(C?A?1B) (4.2.21)
= B?A?1

[?
I ? C(C?A?1C)?1C?A?1

]?
B. (4.2.22)

A identidade em colchetes é uma projeção ortogonal, assim a matriz H é não-negativa e si-
métrica. Como a solução do método misto hibrido é única [46, 52, 41], temos que H é simétrica
definida positiva. Assim, podemos reescrever o problema (4.2.13)-(4.2.15) para a variável ? por
meio de um sistema linear onde a matriz é simétrica definida positiva.

34



4.2.2 Equações discretas e eliminação do multiplicadores de Lagrange
e fluxos.

Considere um elemento ?? . Escolhemos o espaço de elementos finitos mistos ? ?? × ? ?? como
sendo o espaço de Raviart-Thomas de menor índice sobre um quadrado de lado ?. Denominamos
as fronteiras ??? do elemento ?? como ???, ? = ?, ?, ?, ?, indicando as arestas à direita (Right), à
esquerda (Left), acima (Up), e abaixo (Down) respectivamente. Dessa maneira, sobre um elemento
finito ?? existem nove graus de liberdade, ver Figura 4.2: um para a pressão ?? no centro do
elemento ?? e quatro valores constantes para os multiplicadores de Lagrange ??? e para os fluxos
nas fronteiras ??? = u? · n??, um por aresta.

Vamos usar como funções de base para o espaço ? ?? as funções [41, 52, 136],

e? =
(?

?

?
, 0
)?

, e? =
(?

?

?
? 1, 0

)?
, (4.2.23)

e? =
(?

0,
?

?

)?
, e? =

(?
0,

?

?
? 1

)?
, (4.2.24)

(4.2.25)

de modo a escrever u? = ???e? + ???e? + ??? e? + ???e?. Agora, a partir das funções de base
vamos obter a forma discreta das equações (4.2.13)-(4.2.14). Fazendo uso da regra do trapézio para
a integração dos termos obtemos (omitindo o índice ? por motivos de simplificação) as seguintes
equações discretas para o elemento ?? ,

?? + ?? + ?? + ?? = ?? ?, (4.2.26)

?? ?
2? ?

?
(? ? ??) = 0, ? = ?, ?, ?, ?, (4.2.27)

? e ? estão definidos nos centros dos elementos.
Note que em (B.3.3)-(B.3.4) temos cinco equações e nove variáveis. Então precisamos incluir

mais quatro equações ou eliminar quatro variáveis de modo a obter um sistema linear consistente.
Escolhemos eliminar quatro variáveis, os multiplicadores de Lagrange, pois como vimos anterior-
mente obtemos um sistema com uma matriz definida positiva, a qual possui boas propriedades.

As condições de consistência para a pressão de referência (?) e velocidade de Darcy (u), ex-
pressas nas fronteiras dos elementos por (4.2.7)-(4.2.8), requer que,

?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?, (4.2.28)

o subescrito ?? indica o multiplicador de Lagrange (na fronteira ??) do elemento adjacente a ?? que
compartilha a mesma aresta ? com o elemento ?? , como podemos ver na Figura 4.2. Introduzimos
o superescrito ?? para denotar as variáveis dos elementos adjacentes a ?? . Assim, combinando as
equações (B.3.3)-(4.2.28) temos,

?? ?
2? ?

?
(? ? ??) = 0, ????? ?

2???? ????
?

(?? ? ???? ) = 0, (4.2.29)

?? = ???? =
?? ? ???? ???? ??

? ? + ???? ????
, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?. (4.2.30)

35



p

?j

p?U

p?R

p?D

p?L

uU, `U

uL, `L

uD, `D

uR, `R

u???, ˜???

~n

~n

~n ~n

Figura 4.2: Espaço de Raviart-Thomas de menor índice sobre o elemento ?? e seus elementos
adjacentes. As pressões estão definidas no centro dos elementos. Os fluxos e multiplicadores de
Lagrange estão definidos nas arestas.

36



Nas equações acima ???? e ???? indicam, respectivamente, ? e ? definidos nos elementos adjacentes
a aresta ? de ?? ; ?? indica a pressão de referência no centro do elemento adjacente a aresta ?.

Manipulando as equações (4.2.29)-(4.2.30) de modo a eliminar os multiplicadoresde Lagrange
temos que o fluxo em cada interface é dado por

?? =
(? ?)eff?

?
(? ? ??), (4.2.31)

onde
(??)eff? = (??????)eff?? =

2 ? ? ???? ????
? ? + ???? ????

, (4.2.32)

que é definida como sendo a permeabilidade efetiva entre os elementos ?? e seu adjacente ??? .
Note que no caso que estamos trabalhando a permeabilidade é uma função escalar do espaço.
Podemos extender facilmente para o caso em que a permeabilidade é um tensor diagonal. Os
cálculos necessários para encontrar (B.3.7) podem ser encontrados no Apêndice A.

Por fim, combinando as equações (B.3.3) e (B.3.7) escrevemos a a equação para a pressão em
cada elemento ?? (retornando com o índice ?)

??
?=?,?,?,?

(?? ?? )eff?
?2

(?? ? ??,?) = ??? , ? = 1, 2, . . . , ?. (4.2.33)

O sistema linear para a pressão (B.3.5) obtido por meio da discretização por elementos finitos
mistos é equivalente a formulação de diferenças finitas centrada [133, 148, 140].

A equação (B.3.5), escrita na sua forma matricial, é dada por:

A? = ?? , (4.2.34)

onde a matriz A é definida positiva [137, 41], e seus coeficientes são dados por médias das funções
de permeabilidade absoluta e mobilidade, como na equação (B.3.6). Após encontrar as pressões
resolvendo o sistema linear utilizando um método numérico, podemos reconstruir o campo de
velocidades através da equação (B.3.7).

Por fim, tendo obtido o sistema linear por meio da discretização por elementos finitos mis-
tos hibridos do problema de Poisson de pressão-velocidade, podemos nos concentrar na escolha
do método numérico para resolução do sistema linear discreto (B.3.5). Apesar da discretização
conduzir a um sistema linear esparso e definido positivo [136, 137, 41, 39], tal sistema é mal condi-
cionado devido à natureza multiescala da permeabilidade da rocha do reservatório. Os coeficientes
da matriz A são formados por valores de permeabilidade, como podemos ver em (B.3.5). Logo,
em um meio poroso muito heterogêneo esses valores apresentam grande variabilidade tornando a
matriz do sistema mal-condicionada. Isso significa que é necessário o emprego de alguma técnica
de pré-condicionamento para a resolução numérica do problema de álgebra linear proveniente da
discretização do problema de valor de contorno de Poisson.

Devido à natureza do sistema linear A? = ?? , é importante agora escolher qual técnica de
resolução deve ser empregada, ou seja, se é mais adequado adotar um método direto ou um método
iterativo que resolva o sistema linear de forma precisa, com robustez e eficiência computacional.

37



Métodos diretos, com base na fatoração da matriz A em um produto de matrizes que usualmente
são simples de inverter, são amplamente utilizados e são o tipo de método escolhido em diversos
códigos industriais, especialmente onde a confiabilidade da exatidão dos cálculos é a principal
preocupação. Esses métodos exibem uma vantagem de permitir uma quantidade previsível de
recursos em termos de tempo computacional e armazenamento de memória (RAM, L2, Rígida,
etc...); ver, [75, 92]. Em problemas estacionários [19, 139, 142] é possível resolver de forma eficiente
uma quantidade razoável de sistema de equações lineares em um tempo relativamente aceitável.
Isso já não é tão simples quando temos um problema de evolução temporal como ocorre com
frequência em dinâmica de fluidos em meios porosos [65, 40, 23, 58, 15, 31, 72, 21, 2, 89, 76, 86],
como é o nosso caso. Infelizmente, os métodos diretos não exibem um bom escalonamento com o
tamanho do problema em termos do número de operações e requisitos de memória. Dessa forma,
adotamos um método iterativo para a resolução do sistema linear (B.3.5).

Neste trabalho utilizaremos o método iterativo introduzido no trabalho de Klaus Lackner e
Ralph Menikoff [115], “Multiscale Linear Solvers for Very Large Systems Derived from PDES”,
publicado em SIAM Journal on Scientific Computing (2000), que combina o método dos Gradientes
conjugados com um pré-condicionador multiescala dado por uma iteração do método Multigrid. No
próximo capítulo discutiremos em detalhes esse método bem como a motivação para sua escolha.

38



Capítulo 5

Resolução do sistema linear associado ao
problema elíptico

Neste capítulo iremos nos concentrar na solução numérica do sistema linear (B.3.5) obtido da
discretização por elementos finitos mistos híbridos do problema de pressão-velocidade (4.2.3) de
natureza elíptica. Esse sistema é definido positivo e esparso, assim podemos procurar métodos
numéricos que façam proveito da estrutura especial da matriz.

A resolução de grandes sistemas esparsos de equações lineares é fundamental para muitas si-
mulações numéricas em ciência pura e em problemas de engenharia e é muitas vezes a parte
mais demorada do cálculo de uma simulação realizada para a compreensão de um cenário real.
Simulações multifísica detalhadas, em problemas bidimensionais e tridimensionais como estamos
interessados levam a sistemas lineares que podem atingir facilmente a ordem de centenas de milhões
ou até bilhões de equações com as correspondentes incógnitas. Mesmo em problemas bidimensio-
nais, face à natureza heterogênea do meio poroso, é natural incorporar uma noção de incerteza o
que conduzirá a EDPs estocásticas [95, 97, 94, 24, 89, 123, 2], e uma abordagem do tipo Monte
Carlo é necessária. Essencialmente, isso significa o cálculo de momentos estatísticos [95, 97, 94, 89]
provenientes de um conjunto de experimentos determinísticos da ordem de centenas ou milhares
(desejável) de experimentos computacionais. Assim, facilmente temos um contexto bidimensional
com um número elevado de operações associadas a aproximação de problemas de Poisson que
pode envolver até 85% de todos os cálculos para cada uma dessas milhares de simulações [8, 4,
7]. Para modelos dessa natureza, levando em conta o conhecimento atual, métodos iterativos são
a única opção disponível, e o método dos gradientes conjugados é uma escolha frequente para a
resolução desses problemas [2]. O método dos gradientes conjugados é um método robusto com
uma rigorosa fundamentação matemática, e é extremamente simples de implementar. Como seu
algoritmo envolve apenas multiplicação de matriz por vetor ele consome pouca memória sendo um
ótimo candidato para a resolução do sistema linear [154, 139].

Porém, em algumas aplicações, métodos iterativos tipicamente falham e o pré-condicionamento
é indispensável, embora nem sempre tal “remédio” seja suficiente para torná-lo competitivo a ponto
de atingir a convergência em uma quantidade razoável de tempo dentro de uma tolerância estabe-
lecida a priori. Isto é devido também em grande parte ao aumento da complexidade e tamanho da
nova geração de sistemas lineares e não lineares, que surgem a partir de atuais aplicações típicas

39



em fenômenos de transporte em problemas de dinâmica de fluidos. Dessa maneira, escolher um
pré-condicionador eficiente é de extrema importância para garantir a convergência do método dos
gradientes conjugados.

Ao mesmo tempo, a computação paralela tem penetrado as mesmas áreas de aplicação como
um novo ingrediente. Como o computador tornou-se amplamente disponível em termos de custos e
com a unificação de linguagens de comunicação padrão, como o MPI (Message Passing Interface),
criou-se um novo incentivo para utilizar métodos iterativos tendo em mente que problemas sob
investigação são tipicamente em duas e três dimensões espaciais, e não estacionários. Outro incen-
tivo é que os métodos iterativos são muito mais fáceis de implementar em computadores paralelos.
De um modo geral, ainda não pode ser afirmado que um sistema de equações lineares esparso
arbitrário pode ser resolvido de forma iterativa eficientemente. Por exemplo, se a informação fí-
sica sobre o problema em questão pode ser explorado, os métodos mais eficazes e robustos podem
ser melhor adaptados para obtenção dessas soluções. De fato, esta estratégia é explorada pelos
métodos multigrid, que tipicamente tiram vantagens de aspectos multiescala do modelo.

Métodos multigrid usam informações de diferentes malhas para aproximar a solução do sistema
linear e dessa forma levam em conta a variabilidade associada à geologia do meio poroso (porosidade
e permeabilidade). Além disso, esse tipo de método foi usado como pré-condicionador em conjunto
ao método dos gradientes conjugados mostrando-se competitivo comparado a outros tipos de pré-
condicionadores [146, 115, 25]. Pelo exposto acima, a combinação dos gradientes conjugados com
pré-condicionador multigrid parece vantajosa visto que essa escolha tem uma forte motivação
física. Dessa forma, escolhemos para a resolução de sistemas lineares um método que se baseia na
decomposição espectral e combina gradientes conjugados, métodos multigrid, e métodos iterativos
em um único algoritmo. Essencialmente, ele usa o método dos gradientes conjugados com um
pré-condicionador dado por uma iteração do método multigrid em combinação com o método
dos gradientes conjugados novamente, o qual chamamos de método dos gradientes conjugados
multiescala recursivo. Esse método foi introduzido no trabalho de Klaus Lackner e Ralph Menikoff
[115], “Multiscale Linear Solvers for Very Large Systems Derived from PDES”, publicado em
SIAM Journal on Scientific Computing, 2000, e engloba todos os pré-requisitos que queremos de
uma maneira natural em sua construção. Esse trabalho aborda exatamente a situação física em
escala de campo (quilômetros) que estamos interessados; os demais métodos exibem também um
excelente rigor matemático, porém ainda no campo mais teórico em problemas “testes” ou em
diferentes aplicações daquelas que estamos interessados em investigar nesse trabalho.

Neste capítulo discutiremos o método dos gradientes conjugados, e em seguida discutiremos
em detalhes o método multigrid de modo a justificar a escolha do método usado nesse trabalho.
Nas seções seguintes detalhamos o método dos gradientes conjugados multiescala recursivo e sua
implementação.

5.1 Gradientes Conjugados
O método dos Gradientes Conjugados é um método de projeção ortogonal da classe de métodos

de subspaços de Krylov [139, 141] para resolução de sistemas lineares do tipo A? = ? , onde a
matriz do sistema é simétrica definida positiva. Esse método foi introduzido por E. Stiefel e M. R.

40



Hestenes [102] e é similar ao método de máxima descida [139, 154, 141]. No entanto, nos gradientes
conjugados as direções de descida são A-ortogonais, também chamadas de A-conjugadas. Esse
método é um método direto, produzindo uma solução exata no máximo após ? “iterações” ou
projeções, sendo ? a dimensão da matriz do sistema linear. Porém, erros de truncamento e erros
de aproximação e de linearização introduzidos na discretização são suficientes para a gradual perda
da A-ortogonalidade das direções de descida, e os erros acumulados fazem com que o método
não encontre a solução do sistema com poucas projeções. Felizmente, o método dos gradientes
conjugados pode ser usado como um “método iterativo” pois ele melhora, a cada iteração, as
aproximações para a solução exata dada uma certa tolerância a prori. Sua convergência depende
do número de condição de A [139, 154, 141]. A operação mais custosa em cada iteração é a
multiplicação de matriz por vetor, portanto o número de operações é da ordem de ?(???), onde
??? é o número de entradas não nulas de A [141]. Desse modo, esse é um método barato para
implementar.

Temos interesse em resolver sistemas lineares de grande porte da ordem de milhões (2D) e
bilhões (3D) de equações, os quais possuem coeficientes com alta variabilidade devido a caracte-
rística multiescala do meio poroso. Logo, essas matrizes são frequentemente mal-condicionadas
necessitando de um pré-condicionamento em conjunto ao método dos Gradientes Conjugados.

A seguir discutiremos alguns pré-condicionadores e apresentaremos o pré-condicionador a ser
usado nesse trabalho.

5.1.1 Precondicionadores
Quando a matriz de um sistema linear A? = ? é mal condicionada o método dos gradientes

conjugados, entre outros, passa a ter uma convergência lenta. Para melhorar esse problema trans-
formamos o sistema linear num outro equivalente A???? = ???, onde A? seja mais bem condicionada
que A. Esse procedimento é chamado de pré-condicionamento [154].

Assim, seja M uma matriz não singular que aproxima A. Podemos obter um sistema linear
equivalente,

M?1A? = M?1?. (5.1.1)

A matriz M é chamada de pré-condionador.
Caso M seja uma boa aproximação para A a matriz M?1A terá um número de condição

menor, dando melhor estabilidade e taxa de convergência para o método dos gradientes conjugados.
Um dos cuidados que temos que ter ao usar um pré-condicionador com o método dos gradientes
conjugados é que para garantir a convergência do método precisamos que a matriz M?1A seja
simétrica positiva definida. Portanto, M?1 tem que ser definida positiva.

Com efeito, fazendo a decomposição Cholesky de M = G?G temos o seguinte sistema linear
equivalente

A???? = ? , (5.1.2)

onde A? = G??AG?1, ??? = G? e ? = G??? .
Como A? é simétrica positiva definida, podemos aplicar o método dos gradientes conjugados na

equação (5.1.2).

41



Há vários tipos de pré-condicionadores como, por exemplo, o SSOR (symmetric sucessive over-
relaxation) [154, 139] onde o pré-condicionador é dado pela matriz,

M???? = (D + ?L)D?1(D + ?L?).

Separamos a matriz A = D + L + L?, D é matriz diagonal e L é estritamente triangular inferior;
0 &amp;lt;? &amp;lt;2 é um parâmetro de relaxação.

No método que vamos apresentar neste trabalho, o pré-condicionador é escolhido de forma a
respresentar o método multigrid de dois níveis, [115], dado por

M?1 = (P?1Q)??A?1? ?(QP
?1)? +

2??1??
?=0

H?P?1. (5.1.3)

As matrizes ? e ? representam os operadores de prolongação e restrição; P e Q vem da decom-
posição da matriz A, A = P ? Q. A? é a matriz de discretização numa malha mais grossa.

O método multigrid é uma técnica numérica de resolução de sistemas lineares, associados a
discretizações de equações diferenciais, que combina diferentes malhas com o intuito de acelerar a
taxa de convergência de métodos iterativos [139, 122, 42].

Nas seções seguintes, vamos discutir em detalhes o método multigrid de modo a esclarecer a
escolha desse método como pré-condicionador.

5.2 O Método Multigrid
Os métodos numéricos existentes para a solução de sistemas lineares recaem em duas categorias:

métodos diretos e métodos iterativos (ou de relaxação).
Métodos diretos determinam a solução exata (na precisão da máquina) em um número finito de

operações. Esses métodos não são de interese neste trabalho pois, como visto no final do Capítulo
4, eles tem um custo computacional muito grande levando em consideração a origem do sistema
linear aqui discutido.

Os métodos iterativos, como os métodos de Jacobi e Gauss-Seidel, começam com uma apro-
ximação inicial para a solução e tem como objetivo melhorar a aproximação por meio de uma
sucessão de passos simples que atualizam a solução. A sequência de passos gerada (idealmente)
converge para a solução do sistema. Métodos de relaxação clássicos são mais fáceis de implementar
e podem ser aplicados com sucesso em sistemas lineares mais gerais que métodos diretos [42, 139].

Uma dificuldade na aplicação de esquemas de relaxação é que, quando há convergência, ela
pode ser muito lenta para certos problemas. Dessa forma, o método necessita de muitos passos
para obter uma aproximação razoável. Dessa forma, os métodos multigrid foram desenvolvidos
por meio de tentativas de superar essa limitação [122, 42, 155, 132]. A ideia básica do método
Multigrid é resolver um sistema linear A? = ? , frequentemente associado a discretização de uma
equação diferencial, explorando diferentes malhas com a intenção de melhorar a taxa de conver-
gência de técnicas de relaxação [139, 122, 42, 155]. Esses métodos foram bem sucedidos: métodos
de relaxação, usados no contexto de multigrid, são competitivos com os métodos diretos mais
rápidos em problemas modelo e eles são mais gerais tendo uma aplicação mais ampla [42, 132].

42



As ideias do multigrid também foram estendidas para problemas puramente algébricos levando ao
desenvolvimento do método multigrid algébrico [42, 122, 155, 132].

Os métodos multigrid foram aplicados em diversas áreas, desde problemas de dinâmica de
fluidos, problemas em processamento de imagens, otimização combinatória, mecânica estatística,
e eletrodinâmica quântica [42, 155, 132].

Nas próximas seções falaremos sobre o método multigrid e como ele se conecta com métodos
iterativos. Para uma discussão mais aprofundada do método, e suas aplicações, recomendamos ao
leitor as seguintes referências: [42, 155, 132, 122, 148, 146, 37, 139].

5.2.1 Métodos de relaxação e a propriedade de smoothing
Uma parte extremamente importante dos Métodos Multigrid é como ele se aproveita de cer-

tas propriedades de métodos de relaxação para acelerar a convergência dos mesmos. A principal
propriedade aproveitada é a propriedade de smoothing. Métodos com essa propriedade aplicados
a sistemas lineares acomodam rapidamente as componentes mais oscilatórias do erro da apro-
ximação (relacionadas a expansão espectral e análise de Fourier) [42, 37, 155], usualmente nas
primeiras iterações, em componentes menos oscilatórias. Há também redução das componentes
menos oscilatórias nas iterações seguintes, porém com menos eficiência [139, 42].

Nessa seção iremos analisar sem muitos detalhes essa propriedade. Para uma discussão mais
aprofundada sobre smoothing recomendamos as seguinte referências: [42, 155, 132, 122, 37].

Dado um sistema linear A??? = ?? proveniente de uma discretização, onde ? corresponde ao
espaçamento da malha, a ?-ésima iteração de um método iterativo qualquer é escrita da forma
[42, 139],

?
(?)
? = H

??
(0)
? + R?. (5.2.1)

H = P?1Q é chamada de matriz de iteração. As matrizes R =
????1

?=0 H
?P?1 e P e Q vem da

decomposição da matriz A? = P ? Q; ?(0) é uma aproximação inicial. Além disso, sabemos que o
erro da ?-ésima iteração é

?
(?)
? = H

??
(0)
? . (5.2.2)

Dessa maneira, se o raio espectral ?H?2&amp;lt;1 então o erro vai a zero conforme as iterações aumentam.
Logo, o método iterativo associado a matriz de iteração H converge para qualquer valor inicial se,
e somente se, ?(H) &amp;lt;1 [42, 139, 122]. Assim, considere o exemplo onde aplicamos a iteração de
Jacobi com peso ? no problema discreto,

????1 + 2?? ? ??+1 = 0, 1 ? ? ? ? ? 1, (5.2.3)
?0 = ?? = 0. (5.2.4)

A matriz de iteração do problema é dada [42, 139] por

H? = I ?
?

2
A? (5.2.5)

e seus autovalores ?? e seus autovetores ?? são dados por

??(H?) = 1 ? 2? sin2
(?

??

2?

)?
, ??,? = sin

(?
???

?

)?
, 1 ? ? ? ? ? 1, 0 ? ? ? ?, (5.2.6)

43



onde ??,? é a ?-ésima componente de ??. Para esse caso os autovetores correspondem aos modos de
Fourier encontrados através da análise de Fourier [105, 130, 131, 36, 42]. Note que nesse exemplo
se 0 &amp;lt;? ? 1 temos que |??(H?)|&amp;lt;1 e a iteração de Jacobi converge.

Agora seja ?(0)? o erro do valor inicial usado no método de Jacobi. Então é possível representá-lo
pela seguinte expansão:

?
(0)
? =

??1??
?=1

????, ?? ? R, (5.2.7)

com os coeficientes ?? representando a “quantidade” de cada modo no erro. Usando a equação
(5.2.2) podemos representar o erro da ?-ésima iteração por,

?
(?)
? = H

?
? ?

(0)
? =

??1??
?=1

??H?? ?? =
??1??
?=1

???
?
? (H?)??. (5.2.8)

Para cada modo de Fourier [105, 130, 131] e cada esquema de relaxação proposto podemos definir
via análise de Fourier um fator de amplitude ? que mede a amplitude que cada componente do
erro é multiplicada na ?-ésima relaxação [37]. No nosso exemplo, o fator de amplitude é dado por
?? = ????? (H?) e ele nos mostra o quanto um modo é reduzido em cada iteração.

No nosso exemplo, vamos chamar as componentes ?? da metade para baixo do espectro, 1 ?
? ? ?/2, de low frequency modes ou smooth modes, e as componentes da metade ?? para cima,
?/2 ? ? &amp;lt;? ? 1, de high frequency modes ou oscillatory modes. Dessa forma, o fator de smoothing
é dado por [37],

? = max{|??|, ?/2 ? ? &amp;lt;? ? 1}, (5.2.9)
e é o maior fator, no pior caso, no qual os high frequency modes são reduzidos a cada iteração do
método. Essa propriedade de rapidamente reduzir os high frequency modes é chamada de smoothing
e o fator de smoothing quantifica essa propriedade.

No nosso exemplo (5.2.3) usando o método de Jacobi com peso ?, podemos mostrar que o fator
de smoothing ótimo é dado por ? = 2/3 com ? = 1/3.

Para ilustrar a ação do método de Jacobi com peso ? = 2/3 sobre as componentes do erro
considere a Figura 5.1. Na Figura 5.1(a) é dada uma aproximação inicial para o erro ?(0)? = ?3,
que é um modo associado aos smooth modes. Após 10 iterações não houve mudanças qualitativas
na aproximação. Na Figura 5.1(b) nós temos uma componente dos high frequency modes como
aproximação inicial. Podemos ver que a amplitude das oscilações foram extremamente reduzidas
em 10 iterações. A Figura 5.1(b) mostra, como aproximação inicial, uma combinação de high e low
frequency modes. Em apenas 10 iterações a componente oscilatória foi reduzida, porém o mesmo
não aconteceu com a componente menos oscilatória.

O método de Jacobi, no entanto, não é muito eficiente em reduzir os high frequency modes
[42, 115]. Outros métodos, como o método de Gauss-Seidel são mais eficiêntes. A propriedade
de smoothing desse último esquema é analisada usando local mode analysis (LMA) [105, 130, 131,
36] introduzida por Brandt [36]. No LMA a definição de low- e high-frequency modes é dada com
relação a uma malha fina G? e uma malha grossa G2?. Assim, uma componente do erro em G? é
dita como high-frequency mode se sua projeção (restrição) na malha G2? não é visível nessa malha.

Esquemas de relaxação com a propriedade de smoothing funcionam bem nas primeiras iterações,
reduzindo rapidamente os modos mais oscilatórios, porém nas iterações seguintes a convergência

44



Figura 5.1: O método de Jacobi com peso ? = 2/3 aplicado ao problema teste (5.2.3) com ? = 64
pontos e com uma aproximação inicial dada por (a) ?3, (b) ?16, e (c) (?2 + ?16)/2. As ilustrações
mostram a aproximação da solução após uma iteração (lado esquerdo) e após 10 iterações (lado
direito), podendo ver a acomodação “qualitativa” dos high modes. Retirada da referência [42].

se torna extremamente lenta. O método necessita de uma quantidade grande de iterações para
reduzir os low modes satisfatóriamente e isso é uma grande limitação para aplicações desse tipo de
métodos. É nessa hora que o método Multigrid usa diferentes malhas (mais grossas) para reduzir
de forma conviniente os low modes acelerando a convergência do método iterativo. Para uma
discussão mais aprofundada sobre a análise dos high modes e low modes no contexto de smoothing
no método multigrid recomendamos as referências: [105, 155, 132, 112, 130, 131, 36].

45



5.2.2 A estrutura do Método Multigrid
A ideia básica do método Multigrid é resolver um sistema linear, frequentemente associado a

discretização de uma equação diferencial, explorando diferentes malhas com a intenção de melhorar
a taxa de convergência de técnicas de relaxação, [139, 122, 42]. Ele é composto por três etapas:
pre-smoothing, correction step e post-smoothing.

Na etapa de pre-smoothing, usamos um smoother com a intenção de acomodar os oscillatory
modes em low modes. O smoother é geralmente ? iterações de algum método iterativo com a
propriedade de smoothing, como visto na seção anterior e na equação (5.2.1). Algum dos métodos
que possuem essa propriedade são: Jacobi com peso 1/2, Gauss-Seidel, red-black Gauss-Seidel,
entre outros [115, 122, 42].

Na etapa correction step nos concentramos em reduzir os low frequency modes, de modo a ace-
lerar a convergência do método de relaxação usado. Para isso, usamos o fato de que alguns smooth
modes na malha fina “parecem” oscillatory modes numa malha mais grossa [155, 42, 122], como
na Figura 5.2. Assim, quando a relaxação começa a estagnar (significando uma predominância de

Figura 5.2: Aqui é ilustrado como uma solução suave na malha fina (acima) pode parecer mais
oscilatória na malha mais grossa (abaixo). Baseado na ilustração da referência [42].

smooth modes no erro) é aconselhavel ir para uma malha mais grossa onde podemos tratar esses
smooth modes como oscillatory modes. Então, relaxamos novamente o sistema na malha grossa
reduzindo esses aparentes high-frequency modes. Em seguida retornamos a solução aproximada
para a malha fina com a intenção de obter uma melhor aproximação.

Porém, ao invés de trabalhar com o sistema linear diretamente iremos usar algo equivalente
[42, 122]: relaxar a equação original A? = ? com uma aproximação inicial arbitrária é equivalente
a relaxar a equação residual A? = ? com aproximação inicial dada por ?0 = 0. Ou seja, usamos a
equação residual

A? = ?, ou ? ? A? = ?, (5.2.10)

46



para, em vez de relaxar a solução, relaxar o erro na malha grossa e obter uma aproximação para
o erro na malha fina. Isso é feito transferindo o resíduo para uma malha grossa e encontrando o
erro a partir do sistema (5.2.10). Em seguida tranferimos o erro para a malha fina e atualizamos
a aproximação. Essa operação é feita por meio de dois operadores: o operador de restrição, ?,
que transfere um vetor de uma malha fina para um vetor numa malha mais grossa, e o operador
de prolongação, ?, que transfere um vetor de uma malha grossa para um vetor numa malha mais
fina.

Na etapa post-smoothing é feita uma relaxação para eliminar possíveis oscilações provenientes
a transferência de malhas.

A forma mais simples do método Multigrid é considerando 2 malhas regulares, uma fina ?? e
outra grossa ?? de modo que

?? = {? ? ? : ? = ??? , ? = 1, 2, . . . , ?? ? 1, ?? =
1

??
},

?? = {? ? ? : ? = ???, ? = 1, 2, . . . , ?? ? 1, ?? =
1

??
},

onde ?? = ?? /2.
Uma iteração de método de dois níveis consiste em ? iterações do pre-smoother, o correction

step, e ? iterações do post-smoothing. Os parâmetros ? e ? são dados e dependem do problema a
ser resolvido. Eles podem ser escolhidos a priori, análisando o problema, ou escolhidos experimen-
talmente [42, 122].

Algoritmo 5.1 : Algoritmo para o método multigrid de dois níveis [146, 122].
while not convergent do

? = H?1 ? + R1? ; {pre-smoothing}
? = ?(A? ? ? ? ); {correction step}
Resolver o sistema A?? = ? por algum método numérico;
? = ? ? ??;
? = H?2 ? + R2? ; {post-smoothing}

end while

O Algoritmo 5.1 mostra como o multigrid de dois níveis funciona. As matrizes A? e A?
representam os operadores discretos na malha fina (? ) e na malha grossa (?); ? e ? são os
operadores de restrição e prolongação, e H?, R?, ? = 1, 2 são os pré e pós smoothers.

Condições de Contorno

Um cuidado especial deve ser tomado em cada passo do método Multigrid ao incluir as con-
dições de contorno pois elas usualmente afetam a escalabilidade do problema [37]. Isso afeta a
converge?ncia do smoother usado. Há algumas maneiras de contornar esse problema. Podemos
usar operadores de prolongação e restrição melhores, de modo a transferir os valores da fronteira
com mais precisão. Outra forma é aumentar o número de iterações do smoother nos elementos da

47



fronteira [42, 37]. O primeiro não é muito usado devido a dificuldade de implementação. Esses
operadores podem ficar muito complexos e especializados.

Outros cuidados que devemos ter com as condições de contorno é que os operadores de restrição
e prolongação devem ser alterados no elementos de fronteiras de modo a considerar as condições
de contorno [42, 37, 155, 132]. No melhor entendimento do autor não há uma teoria matemática
rigorosa para o tratamento das condições de contorno. As estratégias são, em sua maioria, base-
adas em problemas específicos e/ou na experiência dos usuários em problemas específicos como o
problema de Poisson.

5.2.3 O Multigrid como Pré-condicionador
O pré-condicionador proposto por K. Lackner e R. Menikoff [115] é composto pelo método

Multigrid de dois níveis. Iremos construir a matriz pré-condicionadora M a partir do Algoritmo
5.1.

Seja H1 = P?11 Q1 e H2 = P?12 Q2 respectivamente as matrizes de iteração do pre e pós smo-
others. Então [146],

M?1 = H?2 {(I ? ?A
?1
? ?A? )R1 + ?A

?1
? ?} + R2

= H?2 R1 + R2 + H
?
2 ?A

?1
? ?(I ? AR1). (5.2.11)

Como R1 =
????1

?=0 (P
?1
1 Q1)?P?11 pela equação (5.2.1), temos que

I ? A? R1 = (Q1P?11 )
? . (5.2.12)

Podemos reescrever a equação (5.2.11) como

M?1 = H?2 R1 + R2 + H
?
2 ?A

?1
? ?(Q1P

?1
1 )

? . (5.2.13)

Para podermos usar o método multigrid de dois níveis como pré-condicionador precisamos que
a matriz M seja simétrica e definida positiva, como visto na seção 5.1.1. Os seguintes teoremas
garantem a simetria e positividade dessa matriz.
Teorema 1. Seja A?1? simétrica e definida positiva e ? = ? *. Se P1 = P2 = P?1, ?(H1) &amp;lt;1 e
? = ?, então M é simétrica definida positiva. (Teorema 6.1.3, [146])
Teorema 2. Seja A?1? simétrica e definida positiva e ? = ? *. Se P1 = P?2, ?(H1) &amp;lt;1 e ? = ?,
então M é simétrica definida positiva. (Teorema 6.1.5, [146])

A partir do Teorema 1, seja P = P1 = P2 e H = H1 = H2. Como QP?1 = H? então,

M?1 = H? R + R + H? ?A?1? ?(H
?)? . (5.2.14)

Temos também que R =
????1

?=0 H
?P?1, como visto na equação (5.2.1), então

H? R + R = H?
??1??
?=0

H?P?1 +
??1??
?=0

H?P?1

=
2??1??
?=0

H?P?1. (5.2.15)

48



Desde que P seja simétrica e definida positiva, ?(H) &amp;lt;1 e P + Q seja definida positiva podemos
mostrar que H? R + R é definida positiva. Podemos também mostrar que essa matriz é simétrica
[146]. A?1? é definida positiva e portanto H? ?A?1? ?(H?)? é semi-definida positiva 1. Assim, M?1
é simétrica definida positiva. E obtemos a matriz precondicionadora obtida em [115],

M?1 = (P?1Q)? W(QP?1)? +
2??1??
?=0

H?P?1, (5.2.16)

onde W = ?A?1? ?.

5.2.4 Outra maneira de derivar o pré-condicionador multigrid
Nesta seção, apresentaremos uma outra maneira de derivação do pré-condicionador multigrid,

feita no artigo do R. Menikoff e K. Lakner [115].
Considerando o sistema linear A? = ? obtido pela discretização discutida neste trabalho,

podemos decompor o operador A como A = P?Q. Essa decomposição é responsável pelo processo
de smoothing visto na seção anterior, através da equação (5.2.1). Assim, dada a decomposição de
A e supondo que P é simétrica definida positiva, podemos escrever a inversa de A da seguinte
maneira [115, 139, 154],

A?1 =
???

?=0
(P?1Q)?P?1. (5.2.17)

Essa série é convergente para ?P?1Q?&amp;lt;1, na norma matricial ?2.
Agora queremos escrever um precondicionador M?1 que seja uma boa aproximação para A?1.

Isso será feito usando a identidade,

A?1 = (P?1Q)?A?1(QP?1)? +
2??1??
?=0

(P?1Q)?P?1. (5.2.18)

Analisando a identidade (5.2.18) podemos interpreta-la como combinação de outras duas aproxi-
mações para A?1. De fato, o segundo termo do lado direito de (5.2.18) é nada mais que o somatório
truncado da identidade (5.2.17) que aproxima a inversa de A. Podemos também substituir A?1
no primeiro termo do lado direito de (5.2.18) por uma outra aproximação para a inversa de A,
digamos W. Dessa forma, obtemos uma nova aproximação para A?1,

M?1 = (P?1Q)?W(QP?1)? +
2??1??
?=0

(P?1Q)?P?1. (5.2.19)

A equação acima nos dá a forma do pré-condicionador M, agora nos resta encontrar a aproxima-
ção W. Levando em consideração a natureza multiescala do meio poroso, uma escolha interessante
seria escolher um passo do método Multigrid, ou seja, escolher W de modo que o pré-condcionador
M seja um passo do mutigrid. Dessa forma temos W = ?A?1? ?.

1Uma matriz A ? ??(?) se ??A? ? 0, ?? ? ?? [154].

49



5.3 Gradientes conjugados com pré-condicionador multi-
escala recursivo

Relembrando o propósito deste trabalho, queremos aproximar a solução de um problema de
pressão-velocidade de natureza elíptica no contexto de dinâmica de fluidos em meios porosos. Pri-
meiramente, usamos uma técnica de decomposição de operadores para isolar a resolução numérica
do problema elíptico, e em seguida aplicamos uma discretização por elementos finitos mistos hí-
bridos para obter um sistema linear A? = ? que será resolvido a partir de um método numérico
introduzido no artigo de R. Menikoff e K. Lackner [115].

Agora, com o sistema linear em mãos e após discutir sobre todos os elementos que compõe
este método iremos apresentar o método dos gradientes conjugados com pré-condicionador mul-
tiescala recursivo recentemente introduzido no artigo de Klaus Lackner e Ralph Menikoff [115],
“Multiscale Linear Solvers for Very Large Systems Derived from PDES”, publicado em SIAM
Journal on Scientific Computing em 2000. Esse método combina gradientes conjugados com um
pré-condicionamento multiescala e recursivo, tendo como base o método multigrid de dois níveis.
Basicamente, definimos o pré-condicionador como o método multigrid de dois níveis,

M?1 = (P?1Q)?(?A?1? ?)(QP
?1)? + P?1

2??1??
?=0

(P?1Q)? , (5.3.1)

no entanto, a multiplicação de A?1? por um vetor é feita aplicando recursivamente o método dos
gradientes conjugados com esse pré-condicionador. Isto é, a resolução do sistema residual A?? = ?,
como no Algoritmo 5.1, é obtida aplicando novamente o método dos gradientes conjugados com
pré-condicionador multiescala recursivo nesse sistema. A recursão acaba quando o problema é
resolvido exatamente na malha mais grossa.

Uma propriedade importante desse pré-condicionador é que ele acopla as componentes asso-
ciadas aos high frequency modes e low frequency modes em cada nível através de um método de
gradientes conjugados antes de seguir para o próximo nível. Isso evita acumulo dos erros de trun-
camento provenientes da restrição do operador discreto na malha grossa [115]. Em particular,
se o operador na malha grossa não reduzir muito bem algumas componentes, o que tipicamente
acontece quando os coeficientes da EDP são discontínuos, então essas componentes serão corrigidas
pelo método dos gradientes conjugados com apenas uma pequena penalidade [115].

A forma com que o pré-condicionador é construido leva em consideração ambos os extremos
do espectro da matriz A, através do método multigrid, de maneira que a matriz do sistema
pré-condicionado M?1A tenha um número de condição pequeno, e consequentemente apenas um
pequeno número de iterações é preciso para a convergência do método dos gradientes conjugados
em cada nível. É esperado que a alta qualidade do pré-condicionador resulte na redução do número
de iterações [115].

50



5.4 Implementação do método dos gradientes conjugados
com pré-condicionador multiescala recursivo

Nessa seção iremos mostrar a implementação do método dos gradientes conjugados com pré-
condicionador multiescala recursivo para resolver um sistema linear provenienteda discretização de
um problema de Poisson associado ao problema de pressão-velocidade com condições de contorno
típicas de fluxos em meios porosos. Iremos também definir quem serão os operadores de restrição
e prolongação, os smoothers, as matrizes do sistema linear discretizado na malha grossa e como
iremos tratar as condições de contorno.

O algoritmo para o método dos Gradientes Conjugados com Pré-condicionador multiescala
Recusivo (GCMR) é dado abaixo.

Algoritmo 5.2 : Algoritmo para o Método GCMR.
GCMR(A?, ?, ?0, ?, ????):
Let ?0 = ? ? A??0;
?0 = ?0 = PMR(A?, ?0, ?, ?);
for ? = 0, 1, . . . , ???? ou até convergência do

?? =
??

?
??

??
?
A? ??

;
??+1 = ?? + ????;
??+1 = ? ? A???+1;
??+1 = PMG(A?, ??+1, ?, ?);

??+1 =
??

?+1??+1
??

?
A? ??

;

??+1 = ??+1 + ??+1??;
end for

Algoritmo 5.3 : Pré-condicionador multiescala recursivo (PMR)
PMR(A?, ?, ?, ?):
? = ?????????(A?, ?, ?, ?);
? = ????????(? ? A??);
if (? = 0) then

Solve A?? = ? ;
else

? = GCMR(A??1, ?, ?0, ?, ????);
end if
? = ? + ? ?????????(?);
? = ??????????(A?, ?, ?, ?);

51



Com base nos Algoritmos 5.2 e 5.3, pode-se ver que o método dos gradientes conjugados
multiescala recursivo possui uma “dupla” recursão. A recursão termina quando chegamos na
malha mais grossa, onde esperamos que a dimensão da matriz A? nesse nível seja pequena o
suficiente para que possamos aplicar um método direto para resolver o sistema A?? = ?.

A implementação do algoritmo multiescala Recursivo foi feita de acordo com a implementação
sugerida no artigo de R. Menikoff e K. Lackner . No entanto, algumas modificações tiveram que
ser feitas, e serão discutidas a seguir.

Primeiramente, no artigo [115] os autores usaram um método de diferenças finitas centrado
para discretizar o problema elíptico usando uma malha cell-centered. No entanto, neste trabalho
usamos discretização por elementos finitos mistos, como visto no Capítulo 4. A nossa escolha
por elementos finitos é motivada pelo contexto de dinâmica de fluidos em meios porosos, onde o
problema elíptico é resolvido em conjunto a equações de natureza parabólica e hiperbólica pela
técnica de decomposição de operadores. Assim, o principal propósito em resolver o problema
de pressão-velocidade é obter uma boa aproximação para o campo de velocidades, o qual será
usado para aproximar as equações de transporte, como mostrado nos Capítulos 2 e 3. Nesse
contexto, a formulação por elementos finitos mistos se mostra mais vantajosa. Como já dito no
Capítulo 2, elementos finitos mistos são considerados muito apropriados para cálculo de campos de
velocidade precisos na presença de heterogeneidades geológicas abruptas dos campos de porosidade
e permeabilidade [136, 137, 41, 39, 23, 153, 28]. Outra vantagem é que o valor das permeabilidades
nas fronteiras dos elementos são naturalmente obtidas [136, 137]. Em diferenças finitas é necessário
tomar uma média ad-hoc [115, 118]; ver também [40].

De modo a evitar as dificuldades introduzidas pelas condições de contorno, R. Menikoff e K.
Lackner escolheram, em seu artigo, anular as condições de contorno. Isso é, os autores geraram um
campo ??? de pressão de tal forma a anular as condições de contorno. O problema então é resolvido
para ? = ? ? ??? com fronteira nula e um termo adicional no termo de fonte [115]. Neste trabalho
resolvemos não fazer isso. Na discretização por elementos finitos mistos as condições de contorno
são explicitamente incluidas nas equações discretas, diferentemente da formulação por diferenças
finitas. Então é razoável matermos esses valores pois eles carregam as principais informações do
escoamento dos fluidos em consideração.

No entanto, o uso de condições de contorno não homogêneas trazem alguns problemas. Como
visto na seção 5.2.2 essas condições não tem uma boa escalabilidade, fazendo com que a relaxação
do smoother nos elementos da fronteira seja menos eficiente do que nos elementos internos. Dessa
forma, seguindo as estratégias descritas na seção 5.2.2 optamos por usar um smoother mais eficiente
e um maior número de iterações, ?. Nesse caso, modificar os operadores de restrição e prolongação
não é interessante devido a maior dificuldade de implementação.

Assim, para o smoother, escolhemos usar uma estratégia red-black em conjunto ao método
iterativo Gauss-Seidel simétrico, o qual é originalmente usado em [115], para acelerar a convergência
desse método. Em seu artigo, R. Menikoff e K. Lackner usaram ? igual ao fator de escala do
problema, isto é igual a escala de discretização do problema na malha mais fina [115], porém
nossos experimentos não tiveram sucesso usando esse ?, mesmo considerando a aceleração do
smoother. Nesses experimentos, o método dos gradientes conjugados não convergia (no sentido de
que atingia o número máximo de iterações estabelecido, dado pelo número total de elementos) em
níveis mais grossos. Após vários experimentos encontramos que ? = 3?/2, onde ? é o fator de

52



escala de discretização do problema na malha mais fina, era o melhor valor para a maior parte dos
problemas, considerando tempo computacional e número de iterações do gradientes conjugados.

Nas próximas seções vamos definir os operadores de restrição e prolongação e o método iterativo
usado como smoother. Precisamos também dar uma atenção especial para a escolha da matriz do
sistema linear discreto na malha grossa A?, e isso será visto logo a seguir.

5.4.1 Aproximação da permeabilidade na malha
Neste momento precisamos definir como será a matriz do sistema linear discreto na malha

grossa, A?. Há duas maneiras de definir essa matriz: primeiro, usamos os operadores de restrição
e prolongação de modo que A? = ?A?, [122, 146, 132]. Escrevendo a matriz dessa forma na malha
grossa, obtemos uma maneira de gerar A? automaticamente, no entanto perdemos a estrutura de
esparsidade de A. Outra forma de escrever A? seria rediscretizando o problema em uma malha
grossa. Assim, mantemos a mesma estrutura da matriz na malha fina [146]. Essa é a forma que
escolhemos para definir A?.

Após escolher A? precisamos nos preocupar em definir a permeabilidade na malha grossa.
Como podemos ver pela equação (B.3.5), a matriz do sistema linear resultante da discretização por
elementos finitos mistos, tanto na malha fina quanto na grossa, tem seus coeficientes dependente
das permebilidades. Em um problema real, os únicos dados de permeabilidades que temos são as
permeabilidades na malha fina, portanto precisamos usar esses dados para aproximar de alguma
forma as permeabilidades na malha grossa. Isso será feito através das transmissividades [115],
definidas para um tensor diagonal de permeabilidade, ?(x) = diag [???(x) ???(x)], ? ? R2 como:

??? =
??
??

???, na direção ?,

??? =
??
??

???, na direção ?,

onde ?? e ?? denota o comprimento e altura de um elemento, respectivamente. A transmissividade
numa malha mais grossa, ? ?, é tomada como,

1
? ???(x)

=
??

?

1??
? ???(?, ?)

;
1

? ???(x)
=
??

?

1??
? ???(?, ?)

;

onde essa soma é sobre os elementos da malha fina contidos num elemento da malha mais grossa;
? e ? são os índices correspondentes as direções ? e ? respectivamente.

Essa forma de definir as permeabilidades na malha grossa é vantajosa pois [115]: (a) Mesmo
que ?(x) seja escalar na malha fina, tipicamente ele não será escalar na malha grossa; (b) Os
efeitos das condições de contorno em ? são apropriadamente contabilizadas; e (c) A forma do
operador discreto na malha grossa é preservado.

5.4.2 Smoother
Em [115], R. Menikoff e K. Lackner escolheram como smothers os métodos de Jacobi com peso

1/2 e o método de Gauss-Seidel simétrico. No entanto, como já dito anteriormente, encontramos

53



dificuldades em relaxar os elementos da fronteira devido as condições de contorno não nulas. Dessa
forma, aproveitamos o método Gauss-Seidel simétrico e o combinamos com uma estratégia red-
black para usar como smoother, melhorando sua taxa de convergência.

A estratégia red-black percorre e atualiza os elementos de modo não sequencial. Primeiro é
atualizado os elementos ímpares (ou pares) e em seguida usa-se os elementos atualizados para
calcular os elementos pares (ou ímpares), como em um tabuleiro de xadrez, ver Figura 5.3.

Figura 5.3: Estratégia red-black. Atualiza os elementos primeiro os elementos ímpares, em seguida
atualiza os elementos pares. Note que cada elemento ímpar tem todos os seus vizinhos como pares,
e vice-versa.

O smoother red-black Gauss-Seidel simétrico é escrito da seguinte forma: a matriz do sistema
linear é decomposta como A = P ? Q,

P = (D + L)D?1(D + L?), Q = LD?1L?,

onde as matrizes D e L vem da decomposição A = D + L + L?, e L é a parte estritamente inferior
e D é a diagonal.

5.4.3 Operadores de Restrição e Prolongação
Para o operador de prolongação usamos o produto tensorial de duas interpolações lineares em

1-D, os mesmos utilizados por R. Menikoff e K. Lackner [115]. O operador de restrição é dado pelo
adjunto do operador de prolongação. Os operadores de prolongação e restrição para o caso onde a
discretização é cell-centered são representados pelos stencils [132],

? =
1
16

?
????
1 3 3 1
3 9 9 3
3 9 9 3
1 3 3 1

?
???? , ? = 164

?
????
1 3 3 1
3 9 9 3
3 9 9 3
1 3 3 1

?
???? . (5.4.1)

A partir do stencil de prolongação, construimos os valores nos centros dos elementos da seguinte
forma:

?? =
1
16

(9?? + 3?? + 3?? + ??) , (5.4.2)

54



onde ?? é um elemento da malha fina como ilustrado na Figura 5.4.
Os valores nos centros dos elementos grossos são construidos a partir das seguintes equações,

obtidas pelo stencil de restrição,

?? =
1
64

(9?? + 3?? + 3?? + ??) , (5.4.3)

?? =
1
64

(9?? + 3?? + 3?? + ??) , (5.4.4)

?? =
1
64

(9?? + 3?? + 3?? + ??) , (5.4.5)

?? =
1
64

(9?? + 3?? + 3?? + ??) , (5.4.6)

onde ??, ?? , ?? e ?? são os centros dos elementos na malha mais grossa como mostrado na Figura
5.4.

Figura 5.4: Prolongação e restrição em um pedaço da malha. As letras em maiúsculo represen-
tam os centros dos elementos da malha grossa. As letras minúsculas representam os centros dos
elementos da malha fina .

Os operadores (5.4.1) são validos para todos os elementos internos, no entanto um maior cuidado
é necessário para restringir e prolongar os elementos de fronteira. Esses elementos tem vizinhos em
apenas um dos lados, como mostrado na Figura 5.5. Dessa forma não podemos aplicar o operador
acima. Iremos usar para os elementos de fronteira uma interpolação com derivada normal nula na
fronteira, como feito pelos autores em [115].

Por exemplo, o stencil de prolongação para o elemento ? da fronteira à esquerda, sem estar no
canto, como mostra a Figura 5.5 é dado por,

? =
1
16

?
????
0 4 3 1
0 12 9 3
0 12 9 3
0 4 3 1

?
???? , (5.4.7)

55



E para o elemento ? do extremo canto inferior à esquerda, Figura 5.5, temos o stencil

? =
1
16

?
????
0 4 3 1
0 12 9 3
0 16 9 3
0 0 3 1

?
???? . (5.4.8)

A restrição dos elementos de fronteira é feito de uma maneira similar, através dos mesmos stencils
porém com um fator multiplicante de 1/64, como em (5.4.1).

Figura 5.5: Prolongação e restrição dos elementos de fronteira. A letra em maiúsculo representa
o centro do elemento da malha grossa. As letras minúsculas representam os centros dos elementos
da malha fina .

5.4.4 Critério de Parada
Como critério de parada escolhemos o mesmo critério de usado no artigo de R. Menikoff e K.

Lackner [115]. Ele é dado através da norma do resíduo normalizada,

???2?
??

&amp;lt;??, ?? = ?
?

??, (5.4.9)

onde ?? é o número de elementos na malha, ? é uma tolerância dada e ? é um parâmetro ajustável
que controla o erro em cada nível ?. De acordo com o artigo de R. Menikoff e K. Lackner, [115],
o algoritmo parece ser bastante sensível a escolha de ?. Assim, conforme ? aumenta o número de
iterações no nível da malha mais fina também aumenta, e se ? for muito pequeno então temos
iterações desnecessárias nos níveis mais grossos [115]. Nesse trabalho, os autores encontraram
experimentalmente que o valor ? = 0.1 tem um funcionamento razoavelmente bom, dessa forma
fixamos esse valor para os nossos experimentos.

Por fim, após definir todos os ingredientes necessários para o algoritmo do método dos gradientes
conjugados multiescala recursivo, nós o implementamos em linguagem C pura e em um laptop
básico. A implementação foi simples, serial e intensionalmente não procuramos uma implementação
eficiente. Dessa forma podemos testar o efeito do pré-condicionador multiescala na redução do
número de iterações do método dos gradientes conjugados.

56



No próximo capítulo apresentaremos experimentos numéricos onde aplicamos o método mul-
tiescala recursivo em problemas representativos de pressão-velocidade, variando o campo de per-
meabilidades, de maneira a validar o método e reproduzir as mesmas tendências do algoritmo
apresentadas no artigo de K. Lackner e R. Menikoff [115].

57



58



Capítulo 6

Experimentos numéricos para problemas
elípticos de Poisson em geometrias de
aplicações

No capítulo anterior, discutimos sobre a derivação e a implementação do método dos gradien-
tes conjugados multiescala recursivo, introduzido por Klaus Lackner e Ralph Menikoff no artigo
“Multiscale Linear Solvers for Very Large Systems Derived from PDES”, publicado em SIAM
Journal on Scientific Computing, 2000 [115], para a resolução de um sistema linear proveniente da
discretização de sistemas de equações diferenciais parciais elípticas.

Neste trabalho estamos interessados na aplicação do método multiescala para a aproximação
numérica de problemas de Poisson no contexto de escoamento de fluidos em meios porosos.

No capítulo 2 apresentamos modelagens de diversos problemas em dinâmica de fluidos. En-
tre elas, formulações para o problema de escoamento incompressível com três fases (2.1.19), com
duas fases (2.1.20)-(2.1.22) e com duas fases e histerese (2.1.25)-(2.1.27). Apresentamos também,
modelos como o do traçador passivo (2.2.1) e pressão global (2.2.4)-(2.2.5). Todas essas formula-
ções possuem em comum um problema de pressão-velocidade de natureza elíptica associado a um
sistema de transporte, que pode ser escrito de forma geral como:

? · u = ?(x), u = ??(x)??(x), x ? ?. (6.0.1)

onde ?(x) é um termo de fonte e ?(x) é uma função que acompanha a pressão e representa
características do meio. Por exemplo, no caso trifásico ?(x) = ?(x)?(??, ??), as funções de per-
meabilidade e mobilidade do meio poroso. Assim, mostramos que problemas de Poisson aparecem
naturalmente na modelagem matemática de diversos problemas concretos em escoamento de flui-
dos em meios porosos, e devido a sua abrangência, o estudo de problemas elípticos nesse contexto
é de extrema importância.

Não podemos esquecer que neste momento o problema de pressão-velocidade está acoplado
as equações de transporte. Tendo em vista o foco deste trabalho, aplicamos uma técnica de
decomposição de operadores para desacoplar o problema de Poisson do sistema de transporte,
como descrito no capítulo 3. Assim, uma simulação completa de um problema em escoamento de
fluidos em meios porosos envolveria resolver em sequência, o problema de pressão-velocidade e o

59



sistema de transporte, aplicando técnicas numéricas específicas para cada problema. No entanto
nos concentraremos apenas na resolução numérica do problema de Poisson.

Ao “isolar” a resolução do problema de Poisson, discretizamos o problema através da formulação
de elementos finitos mistos (ver, Cap. 4). Esse método é considerado muito apropriado para o
cálculo de campos de velocidade na presença de heterogeneidades, o qual é justamente o nosso
caso. O cálculo preciso do campo de velocidades é necessário para a aproximação do subsequente
problema de transporte, considerando uma simulação completa de um problema em escoamento
em meios porosos (ver, Cap. 3). Por fim, obtemos um sistema linear simétrico definido positivo
para a pressão e aplicamos o método dos gradientes conjugados multiescala recursivo para sua
resolução.

Como dito no capítulo anterior, o método multiescala foi desenvolvido para melhor capturar
os distintos comprimentos de onda associados aos diferentes comprimentos de onda do operador
auto-adjunto de Poisson, os quais são fortemente influênciados pela heterogeneidade do meio. E
isso é feito combinando o método dos gradientes conjugados com um pré-condicionador multiescala
obtido através do método multigrid.

Figura 6.1: Representação de um aquífero subterrâneo .

Para nossos experimentos numéricos consideramos alguns problemas de Poisson simplificados.
Não estamos interessados em uma geometria complexa. Queremos estudar um problema protótipo
de modo a validar nosso algoritmo. Diversos problemas matemáticos podem ser entendidos por
meio de geometrias mais simples [2, 21, 24, 31, 34, 61, 62, 68, 71, 76]. Por exemplo, considere
a Figura 6.1 que ilustra um aquífero. Agora, veja a Figura 6.2.(a) que representa o domíno
complexo do aquífero. A Figura 6.2.(b) ilustra uma malha geométrica que aproxima o domínio
complexo do reservatório. E na Figura 6.2.(c) mostra um domínio retangular contido no aquífero.
Dessa forma, é razoável esperar que geometrias retangulares forneçam uma boa aproximação para

60



diversos reservatórios. O uso de um domínio retangular facilita a transferência de valores entre

Figura 6.2: Representação da geometria complexa de um domínio, com uma simplificação dada
por uma geometria retangular. Baseada na referência [20] .

malhas, não precisando nos preocupar com possíveis modificações aos operadores de restrição e
prolongação (ver, Seção 5.4.3) devido a maior complexidade da malha. O cálculo dos valores das
permeabilidades nas malhas mais grosseiras (ver, Seção 5.4.1) se torna mais simples, facilitando a
implementação. Dessa forma temos mais controle sobre cada passo do algoritmo.

A seguir vamos listar os problemas escolhidos para os experimentos numéricos deste capítulo,
bem como os resultados obtidos em cada caso. Todos os experimentos a seguir foram feitos em
um laptop básico com sistema operacional UBUNTU 14.04 LTS, processador i3 2.53 GHz e 4 MB
de memória RAM.

6.1 Pressão-fluxo slab Dirichlet-Dirichlet

Para este experimento consideramos um problema de Poisson bidimensional simplificado de
pressão-velocidade em um domínio retangular, que modela o escoamento de um fluido em um meio

61



poroso, dado por:

? · u = 0, u = ??(x)??(x), x ? ? = [0, ??] × [0, ??] ? R2,
?(0, ?) = 1, ?(??, ?) = 0, ?? ? [0, ??],
u(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??],

(6.1.1)

Figura 6.3: Domínio retangular do problema (6.1.1) ilustrando as condições de contorno.

?(x) é o tensor de permeabilidade absoluta do meio poroso definido no capítulo 2 (ver, Sec. 2.1).

O problema (6.1.1) é bem posto pois é unicamente determinado pelas condições impostas
na fronteira. As fronteiras acima e abaixo do domínio retangular possuem fluxo nulo, não há
transferência de fluidos. Na fronteira a esquerda temos imposta uma pressão ? = 1, e na fronteira
a direita temos pressão nula. Dessa forma temos uma diferença de pressão que causa o aparecimento
de um gradiente de pressão da esquerda para a direita, movendo o fluido nessa direção.

Para os testes numéricos consideramos três tipos de funções de permeabilidade absoluta: ho-
mogênea, com barreira e heterogênea. A permeabilidade homogênea é dada como uma constante
em todo o domínio, com um valor de 10?06. A permeabilidade do tipo barreira é mostrada na
Figura 6.4. Temos uma permeabilidade constante de 10+06 em quase todo o domínio, porém há
duas colunas em aproximadamente cada 1/3 do domínio com uma permeabilidade de 10?06, de
modo a diminuir drasticamente o escoamento do fluido nesses locais.

62



Figura 6.4: Ilustração da função de permeabilidade do tipo barreira usada nos experimentos deste
trabalho. A permeabilidade é de 10+06 em quase todo o domínio, porém há 2 colunas com uma
permeabilidade de 10?06.

Por último, a permeabilidade heterogênea é definida em todo o domínio usando o mesmo
mecanismo descrito em [96]. Para modelar a permeabilidade absoluta de uma estrutura rochosa
heterogenea consideramos um campo de permeabilidade log-normal ?(x), de modo que ?(x) =
log ?(x) é uma Gaussiana e sua distribuição é determinada por suas funções de média e covariância.
A permeabilidade absoluta é dada por [34, 71]:

?(x) = ?0???(x), (6.1.2)

?0 é um valor de truncamento, e 0 &amp;lt;? ? 1 é um fator de escala. Para os nossos experimentos
fixamos o valor de truncamento para ?0 = 1 e o fator de escala em ? = 2. Podemos também gerar
fácilmente uma matriz de permeabilidade homogênea usando a equação (6.1.2) colocando ? = 0 e
fixando ?0 = 10?06. Em todos os casos considerados, a permeabilidade é determinística. No caso
da permeabilidade heterogênea, trabalhamos com apenas uma realização da gaussiana ?(x).

Aplicamos nosso algoritmo multiescala no problema (6.1.1) com os três tipos de permeabilidade
para ? = 512, 1024, 2048, onde ? é a escala de discretização do problema na malha mais fina.
Assim, temos 5122 = 262144, 10242 = 1048576 e 20482 = 4194304 elementos e podemos analisar o
comportamento do algoritmo na presença de sistemas lineares da ordem de centenas de milhares
de equações.

Escolhemos o tamanho do domínio como ?? = ?? = 512m, para que cada elemento tenha
inicialmente tamanho 1m × 1m. Usamos o método red-black Gauss-Seidel simétrico (ver, Sec.
5.4.2) como smoother e fixamos seu número de iterações como ? = 3?/2, considerando tempo
computacional e número de iterações do gradientes conjugados (ver, Cap. 5.3). No entanto,
tivemos que aumentar esse valor no caso do problema com permeabilidade tipo barreiras. O fator
de escala entre malhas foi fixado em 4 e a tolerância fixada em ? = 10?07. Fixamos também a
quantidade de níveis de malha em 4.

63



Na Figura 6.5 temos os gráficos da pressão e do fluxo do problema (6.1.1) com permeabilidade
homogênea, com barreiras e heterogênea com ? = 2. Nelas podemos ver a direção de escoamento
do fluido, que percorre o domínio da esquerda para a direita. No caso homogêneao o meio poroso é
caracterizado pela permeabilidade, e devido ela ser uma constante, qualquer ponto do meio poroso
compartilha a mesma característica. Por isso a velocidade e a intensidade do fluido é a mesma
em todo o domínio. Não há transferência de fluidos nas fronteiras superior e inferior, como se é
esperado.

Permeabilidade homogênea:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 8 16 × 16 8 32 × 32 8
2 32 × 32 4 64 × 64 4 128 × 128 4
3 128 × 128 2 256 × 256 2 512 × 512 2
4 512 × 512 1 1024 × 1024 1 2048 × 2048 1

Permeabilidade com barreiras:
512 1024

Nível Dim Iterações Dim Iterações
1 8 × 8 78 16 × 16 95
2 32 × 32 40 64 × 64 53
3 128 × 128 29 256 × 256 34
4 512 × 512 8 1024 × 1024 7

Permeabilidade heterogênea com ? = 2:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 40 16 × 16 50 32 × 32 39
2 32 × 32 20 64 × 64 25 128 × 128 22
3 128 × 128 12 256 × 256 18 512 × 512 12
4 512 × 512 7 1024 × 1024 6 2048 × 2048 4

Tabela 6.1: Iterações acumuladas por nível para o problema (6.1.1) com permeabilidade homogênea,
com barreiras e heterogênea com ? = 2. A tabela mostra o número de iterações por nível do
problema com dimensões 512 × 512, 1024 × 1024 e 2048 × 2048.

Para o problema com permeabilidade do tipo barreira, temos duas colunas com um valor de
permeabilidade diferente do resto do domínio. A diferença entre os valores é da ordem de 1012,
assim é esperado que no momento que o fluido se aproxima dessas colunas temos um gradiente
abrupto de pressão na fronteira dessas colunas e o fluido muda rapidamente de direção. A maior
parte do fluido contorna essas colunas com permeabilidade diferente, caminhando para o outro
extremo do domínio. Dentro das colunas também há passagem de fluido, pois as colunas não são
completamente impermeáveis, porém o fluido passa com uma velocidade bem menor do que no
resto do meio poroso. Aqui podemos perceber a vantagem do uso dos multiplicadores de Lagrange
na discretização por elementos finitos mistos híbridos (ver, Cap. 4) do problema de Poisson.

64



Quando usamos os multiplicadores relaxamos a condição de que a pressão na fronteira de um
elemento seja igual a de seu vizinho. Com os multiplicadores apenas pedimos que o traço da
pressão nas fronteiras dos elementos sejam iguais, permitindo assim o cálculo de problemas com
pressões descontínuas.

No experimento com permeabilidade heterogênea, geramos uma matriz de permeabilidade ab-
soluta com os seguintes parâmetros: ? = 2 e ?0 = 1. A função ?(x) foi construída de forma a ter
um coeficiente de variação ?? = 2, obtida em cima de uma malha geológica de 512 × 512. Por
meio do gráfico de pressão e fluxo na Figura 6.5 podemos ver o comportamento do fluido. Devido
a variabilidade da função de permeabilidade absoluta do meio temos gradientes abruptos durante
todo o escoamento, isto é, a velocidade do fluido muda de direção constantemente devido a influên-
cia da permeabilidade. Ainda assim, podemos ver nos gráficos da Figura 6.5 que a direção do fluxo
ocorre da esquerda para a direita, em concordância com o caso com permeabilidade homogênea.
A Tabela 6.1 mostra o número de iterações acumuladas do método dos gradientes conjugados em
cada nível. Podemos ver que para o problema com permeabilidade homogênea, em todas as di-
mensões foram necessários apenas 1 iteração na malha mais fina para a convergência do algoritmo
multiescala. E em apenas 1 iteração reduzimos a norma-2 do resíduo normalizado, ?r?2/

?
??, em

10?12, como podemos ver na Tabela 6.2. O tempo computacional aumentou consideravelmente em
cada dimensão. Foi de 1 minuto para a dimensão 512 × 512 para quase 2 horas para o problema
com dimensão 2048 × 2048.

Permeabilidade homogênea:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 1.21 4.7512e-10 2.03795e-11 2.9345e-12
1024 0.50 9.66 9.86644e-10 3.00549e-11 3.04692e-12
2048 0.25 111.13 2.02647e-09 4.37593e-11 3.12903e-12

Permeabilidade com barreiras:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.0 8.35 3.46806e-07 1.18744e-08 2.14199e-09
1024 0.5 46.59 1.00591e-05 1.64844e-07 3.10641e-08

Permeabilidade heterogênea com ? = 2:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 5.22 1.22889e-05 4.34704e-06 7.59001e-08
1024 0.50 40.36 2.22662e-05 7.30542e-06 6.87618e-08
2048 0.25 228.75 1.492e-05 8.48055e-07 2.30377e-08

Tabela 6.2: Informações gerais para o problema (6.1.1) e permeabilidade homogênea, com barrei-
ras e heterogênea com ? = 2. A tabela mostra a norma do resíduo da aproximação e tempos
computacionais. ?? é o número total de elementos.

No problema com barreiras, o método convergiu em 8 e 7 iterações na malha mais fina. A
norma-2 do resíduo normalizado foi reduzida em 10?09 para o problema de dimensão 512 × 512 e
10?08 para o problema de dimensão 1024 × 1024. Nesse problema foi necessário aumentar o ? para
5?/2 de modo a obter convergência dos gradientes conjugados em todos os níveis. Falaremos sobre

65



 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

Figura 6.5: Gráficos da pressão e do campo de velocidades para o problema (6.1.1), com permea-
bilidade homogênea, com barreiras e heterogênea com ? = 2.

isso mais adiante. Novamente, o tempo computacional aumentou drasticamente de uma dimensão
para outra, levando 9 minutos e 45 minutos respectivamente.

Agora, para o problema com permeabilidade heterogênea e ? = 2 foi necessário 7 e 6 iterações
do método para convergir. Neste caso reduzimos a norma-2 do resíduo normalizado em 10?08 e o

66



tempo computacional do algoritmo foi parecido com os anteriores, levando 5 minutos, 40 minutos
equase 4 horas respectivamente.

O grande tempo computacional apresentado pelo algoritmo multiescala é um empecilho para
que ele se torne competitivo nesse momento. Outros testes feitos para permeabilidade heterogênea
com ? = 4 levaram mais de 9 horas para terminar, considerando um problema com dimensão
2048 × 2048. Mesmo assim o algoritmo mantém o número baixo de iterações por nível e isso é
uma indicação de que o tempo computacional não está conectado com a acurácia do algoritmo.
Analisando o algoritmo e fazendo mais alguns testes foi possível perceber que a parte que mais
necessita esforço computacional é o smoother, mais especificamente o smoother aplicado nas malhas
mais finas. Mesmo considerando que o número de iterações do smoother escolhido é menos de
0.2% da quantidade total de elementos da malha mais fina, ele ainda consome a maior parte do
tempo de computação. Não podemos diminuir ? pois a convergência depende dele (ver, Sec. 5.3).
Imaginamos que smoothers mais eficientes, que necessitem de menos operações ou implementações
mais eficiêntes diminuam consideravelmente o tempo computacional desse método.

6.2 Fluxo slab Neumann-Dirichlet
Para este experimento consideramos um problema de Poison bidimensional simplificado de

pressão-velocidade em um domínio retangular, que modela o escoamento de um fluido em um meio
poroso, dado por:

? · u = 0, u = ??(x)??(x), x ? ? = [0, ??] × [0, ??] ? R2,
u = 1, ?(??, ?) = 0, ?? ? [0, ??],
u(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??],

(6.2.1)

Figura 6.6: Domínio retangular do problema (6.2.1) demonstrando as condições de contorno.

?(x) é o tensor de permeabilidade absoluta do meio poroso. Mostramos o domínio de (6.2.1) na
Figura 6.6.

67



O problema (6.2.1) é completamente determinado pelas condições impostas na fronteira. As
fronteiras acima e abaixo do domínio retangular possuem fluxo nulo e na fronteira a esquerda
temos um fluxo de u = 1 entrando no meio. Na fronteira a direita temos imposta uma pressão
? = 0. Esperamos que o fluido entre pela a fronteira à esquerda, devido ao sentido do fluxo, e
caminhe em direção a fronteira à direita, como mostra a Figura 6.7.

Figura 6.7: Direção de escoamento do fluido do problema (6.2.1).

Para os testes numéricos usamos os mesmos três tipos de funções de permeabilidade absoluta
definidas na seção anterior: homogênea, tipo barreiras e aleatória, com os mesmos valores.

Consideramos como escala de discretização os valores ? = 512, 1024 e 2048. O tamanho do
domínio foi definido como ?? = ?? = 512m. Continuamos com o método red-black Gauss-Seidel
simétrico (ver, Seção 5.4.2) como smoother com ? = 3?/2, considerando tempo computacional
e número de iterações. Novamente, tivemos que aumentar esse valor no caso do problema com
permeabilidade tipo barreiras. O fator de escala entre malhas foi fixado em 4, a tolerância em
? = 10?07, e fixamos a quantidade de níveis em 4.

Na Figura 6.8 temos os gráficos da pressão e do campo de velocidades do problema (6.2.1)
com permeabilidade homogênea, com barreiras e heterogênea com ? = 2. O escoamento do fluido
ocorre da esquerda para a direita em todos os casos, como esperado, e não há passagem de fluido
nas fronteiras acima e abaixo. Como nos experimentos anteriores, no problema com permeabilidade
do tipo barreiras o fluido percorre o meio desviando das colunas com permeabilidade diferente.
Pouco fluido passa nas colunas, e quando passa possui uma velocidade bem menor do que no resto
do domínio. Podemos também ver que na fronteira à esquerda o fluido entra no meio poroso com
uma certa inclinação. Isso se deve ao fato de termos, nessa fronteira, uma condição imposta pelo
fluxo. Para o problema com permeabilidade heterogênea, usamos uma matriz de permeabilidade
absoluta gerada com os parâmetros ? = 2 e ?0 = 1, com a mesma função ?(x) gerada para os
experimentos anteriores. A direção do fluido nesse caso varia constantemente por causa da variação
da permeabilidade do meio poroso. Globalmente, podemos ver no gráfico que o fluxo percorre o
caminho da esquerda para a direita, em concordância com o caso com permeabilidade homogênea.

Analisando a Tabela 6.3 e a Tabela 6.3 vemos que no nível mais fino foi necessário 3 iterações
para o método multiescala convergir no caso homogêneo, 5 para o caso com barreiras e 10, 7 e 5 para
as dimensões 512, 1024 e 2048, respectivamente para o caso heterogêneo. E o resíduo normalizado

68



Permeabilidade homogênea:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 21 16 × 16 19 32 × 32 19
2 32 × 32 11 64 × 64 10 128 × 128 10
3 128 × 128 6 256 × 256 5 512 × 512 5
4 512 × 512 3 1024 × 1024 3 2048 × 2048 3

Permeabilidade com barreiras:
512 1024

Nível Dim Iterações Dim Iterações
1 8 × 8 39 16 × 16 1871
2 32 × 32 21 64 × 64 22
3 128 × 128 12 256 × 256 13
4 512 × 512 5 1024 × 1024 5

Permeabilidade heterogênea com ? = 2:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 71 16 × 16 77 32 × 32 66
2 32 × 32 37 64 × 64 42 128 × 128 41
3 128 × 128 23 256 × 256 27 512 × 512 19
4 512 × 512 10 1024 × 1024 7 2048 × 2048 5

Tabela 6.3: Iterações acumuladas por nível para o problema (6.2.1) com permeabilidade homogênea,
com barreiras e heterogênea com ? = 2. A tabela mostra o número de iterações por nível do
problema com dimensões 512 × 512, 1024 × 1024 e 2048 × 2048 .

foi reduzido em pelo menos 10?08 em todos os problemas com diferentes permeabilidades.
No caso com permeabilidadedo tipo barreiras, novamente tivemos que aumentar o valor de ?

para obter convergência, no sentido de que não atingisse o número máximo de iterações estabele-
cido, dado pelo número total de elementos. Portanto usamos novamente ? = 5?/2. No entando,
não conseguimos convergência no sentido descrito acima para o problema de dimensão 1024. Au-
mentamos ? para 4? e ainda assim não conseguimos convergência. Podemos ver na Tabela 6.4
que no nível mais grosso tivemos 1871 iterações, mil vezes mais que o número de iterações dos
níveis anteriores, e do mesmo nível do problema de dimensão 512 × 512. Isso mostra que algumas
das passagens do gradientes conjugados naquele nível alcançaram o número máximo de iterações.
Mais precisamente, 10 das passagens do gradientes conjugados não convergiram nesse nível para
? = 4? . Uma maneira de corrigir esse problema seria aumentar ? ainda mais. Porém, devido ao
grande tempo computacional não testamos esse problema para ? &gt; 4? .

O tempo computacional aumentou consideravelmente em cada dimensão. Foi de menos de
10 minutos para os problemas com dimensão 512, sendo o mais rápido o caso homogêneo com 3
minutos, para até quse 5 horas para os problemas com dimensão 2048, sendo o mais demorado o
caso onde temos permeabilidade heterogênea.

69



 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

Figura 6.8: Gráficos da pressão e do campo de velocidades para o problema (6.2.1) com permeabi-
lidade homogênea, com barreiras e heterogênea com ? = 2. .

70



Permeabilidade homogênea:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 2.50 1.77109e-06 7.32431e-08 1.09388e-08
1024 0.50 21.03 1.56631e-06 4.57239e-08 4.83701e-09
2048 0.25 227.30 1.18678e-06 2.44318e-08 1.83249e-09

Permeabilidade com barreiras:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.0 7.64 2.75814e-06 5.93989e-08 1.70352e-08
1024 0.5 92.33 7.83335e-07 2.33695e-08 2.41906e-09

Permeabilidade heterogênea com ? = 2:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 7.10 5.14147e-06 7.9038e-07 3.17554e-08
1024 0.50 47.53 2.28301e-05 5.34859e-06 7.05031e-08
2048 0.25 281.90 5.65836e-05 1.0347e-06 8.73697e-08

Tabela 6.4: Informações gerais para o problema (6.2.1) com permeabilidade homogênea, com bar-
reiras e heterogênea com ? = 2. A tabela mostra a norma do resíduo da aproximação e tempos
computacionais. ?? é o número total de elementos.

6.3 Geometria 1/4 de five-spot
O problema de Poison bidimensional escolhido para este experimento é dado por:

? · u = ? (x), u = ??(x)??(x), x ? ? = [0, ??] × [0, ??] ? R2,??
? (x)?? = 0,

u(0, ?) = 0, u(??, ?) = 0, ?? ? [0, ??],
u(?, 0) = 0, u(?, ??) = 0, ?? ? [0, ??].

(6.3.1)

O problema é definido em um domínio retangular e não há fluxo em nenhuma das fronteiras.
A função de fonte ? (x) é definida como

? (x) =

???
??

10?07, no canto inferior esquerdo,
?10?07, no canto superior direito,

0, caso contrário,

de modo que a condição de compatibilidade
??

? ? (x)?? = 0 seja satisfeita. As condições do
problema estão melhor ilustradas na Figura 6.9.

O problema (6.3.1), em conjunto a condição de compatibilidade, é unicamente determinado
(bem posto). Esperamos que o fluido entre pela extremidade inferior e caminhe em direção ao
ponto de produção no canto superior.

Para os testes numéricos consideramos as mesmas funções de permeabilidade absoluta usadas
nos problemas anteriores. Aplicamos nosso algoritmo multiescala no problema (6.3.1) para ? =

71



Figura 6.9: Domínio retangular do problema (6.3.1) demonstrando as condições de contorno.

Figura 6.10: Direção de escoamento do fluido do problema (6.3.1).

512, 1024, 2048, com ?? = ?? = 512m. Usamos o mesmo smoother dos experimentos anteriores
com ? = 3?/2. O fator de escala entre malhas foi fixado em 4, a tolerância em ? = 10?07, e 4
níveis de malha.

A Figura 6.11 mostra lado a lado os gráficos de pressão e do campo de velocidades obtidos
pelo método multiescala para o problema (6.3.1) com permeabilidades homogênea, com barreiras e
heterogênea. Nos gráficos de fluxo podemos ver a direção de escoamento do fluido, que “caminha”
em direção o ponto de produção no canto superior. No caso heterogêneo, o fluido sofre diversos
desvios devido a variabilidade da permeabilidade do meio, como nos experimentos anteriores. Os
parâmetros para construir a permeabilidade heterogênea foram novamente ? = 2, ?0 = 1, com a
mesma função ?(x) dos experimentos anteriores.

72



Permeabilidade homogênea:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 8 16 × 16 8 32 × 32 8
2 32 × 32 4 64 × 64 4 128 × 128 4
3 128 × 128 2 256 × 256 2 512 × 512 2
4 512 × 512 1 1024 × 1024 1 2048 × 2048 1

Permeabilidade heterogênea com ? = 2:
512 1024 2048

Nível Dim Iterações Dim Iterações Dim Iterações
1 8 × 8 43 16 × 16 41 32 × 32 41
2 32 × 32 4 64 × 64 4 128 × 128 4
3 128 × 128 2 256 × 256 2 512 × 512 2
4 512 × 512 1 1024 × 1024 1 2048 × 2048 1

Tabela 6.5: Iterações acumuladas por nível para o problema (6.3.1) com permeabilidade homogênea
e heterogênea com ? = 2. A tabela mostra o número de iterações por nível do problema com
dimensões 512 × 512, 1024 × 1024 e 2048 × 2048 .

Na Tabela 6.5 temos o número acumulado de iteração por nível. Podemos ver que foi neces-
sário somente 1 iteração no nível mais fino para o algoritmo convergir para todas as dimensões
consideradas no caso homogêneo e no caso heterogêneo.

A norma do resíduo normalizado foi reduzida em pelo menos 10?12 no problema com permeabi-
lidade homogênea, e pelo menos 10?10 no caso heterogêneo. O tempo computacional neste caso foi
bem menor do que nos outros experimentos com permeabilidade heterogênea. O tempo se apro-
ximou do tempo obtido nos casos em que a permeabilidade é constante. Uma possível explicação
para o menor tempo pode ser encontrada no fato de que para esse problema consideramos condições
de contorno homogêneas. Como visto no Capítulo 5, problemas com condições de contorno não
homogêneas precisam de um maior esforço do smoother para acomodar os high frequency modes.
Mas com condições de contorno nulas esse problema é resolvido e o método converge em menos
iterações, e portanto diminuindo o tempo computacional. Podemos ver também que o tempo não
é afetado pelo fato de que no nível mais grosso foi necessário aproximadamente 41 iterações no
caso heterogêneo, muito mais que nos níveis mais finos. Isso ocorre pois o sistema linear resolvido
naquele nível tem uma dimensão muito menor comparado com o sistema do nível mais fino. O
maior sistema linear resolvido no nível mais grosso é 32 × 32, ou seja, 1024 elementos. Isso é 0.02%
da quantidade de elementos do nível mais fino. Dessa forma, o custo computacional de resolver o
sistema linear no nível mais grosso é quase que negligenciável. Esse resultado mostra que o maior
esforço computacional do método multiescala está concentrado no nível mais fino.

73



 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

Figura 6.11: Gráficos da pressão e do campo de velocidades para o problema (6.3.1) com permea-
bilidade homogênea e heterogênea com ? = 2. .

Permeabilidade homogênea:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 1.24 4.18866e-10 2.95716e-10 2.58705e-12
1024 0.50 10.29 3.08826e-10 2.18227e-10 9.53706e-13
2048 0.25 85.49 2.26141e-10 1.59861e-10 3.4918e-13

Permeabilidade heterogênea com ? = 2:
Dim ? Tempo (min) ?r?2 ?r?? ?r?2/

?
??

512 1.00 1.22 2.15329e-08 1.49262e-08 1.32994e-10
1024 0.50 9.74 6.89399e-09 3.78218e-09 2.12898e-11
2048 0.25 80.78 2.71593e-09 1.83088e-09 4.19361e-12

Tabela 6.6: Informações gerais para o problema (6.3.1) com permeabilidade homogênea, com bar-
reiras e heterogênea com ? = 2. A tabela mostra a norma do resíduo da aproximação e tempos
computacionais. ?? é o número total de elementos.

Analisando todos os experimentos realizados vemos que o método multiescala necessitou, em

74



todos os problemas, de muito poucas iterações para convergir em cada nível, comparado com o
número de elementos da malha. O nível referente a malha mais fina foi o que precisou de menos
iterações. Esse resultado está de acordo com o que foi encontrado por K. Lackner e R. Menikoff
[115]. Os níveis subsequentes precisaram de mais iterações, no entanto o esforço computacional é
menor devido a redução da dimensão do problema nesses níveis.

Os experimentos com melhores resultados de iterações e tempo foram os problemas com geome-
tria slab e condições de contorno de Dirichlet-Direchlet, e problemas com geometria 1/4 five-spot.
No artigo de K. Lackner e R. Menikoff [115], os autores se concentraram em problemas de com
condições de contorno de Dirichlet-Direchlet, tipo slab. Dessa forma, os nossos experimentos estão
de acordo com os resultados encontrados em [115]. Os experimentos com 1/4 five-spot também
tiveram bons resultados, senão melhores que o slab, devido ao uso de condições de contorno ho-
mogêneas.

O tempo computacional foi um grande limitante para um maior aprofundamento da análise
computacional do algoritmo multiescala. Experimentos com problemas de dimensões maiores que
2048 foram inviáveis nesse momento devido ao alto tempo de simulação na máquina utilizada. Um
maior estudo é necessário para avaliar o comportamento do algoritmo com relação aos parâmetros
de tolerância, níveis de malha e iterações do smoother.

Um desafio foi rodar todos os experimentos em um laptop básico, já que uma motivação desse
trabalho é o aumento da eficiência computacional, a partir de uma melhor compreensão matemática
do método e não apenas com o uso de uma máquina computadora especializada.

75



76



Capítulo 7

Conclusões e Perspectivas

7.1 Conclusões
Foi realizada a implementação computacional de um método numérico, recentemente introdu-

zido na literatura, para a aproximação de EDPs elípticas no contexto de dinâmica de fluidos em
meios porosos heterogêneos. Esperamos, neste trabalho, ter justificado a escolha do método dos
gradientes conjugados multiescala recursivo [115] para a resolução do sistema linear proveniente
da discretização por elementos finitos mistos híbridos do problema de valor de contorno de Poisson
associado ao sistema de pressão-velocidade. Para isso, fizemos uma breve revisão da literatura
sobre as diversas aplicações do sistema de EDPs que governam o transporte de fluidos em meios
porosos e procuramos motivar e indicar a importância do tratamento de equações elípticas mos-
trando sua frequente presença na modelagem matemática e computacional de diversos problemas
de transporte de fluidos em meios porosos. Nesse contexto, a resolução de problemas de Poisson
envolve a maior parte de todos os cálculos envolvidos na aproximação desses problemas [8, 4, 7].
Assim, há a necessidade de métodos robustos e computacionalmente eficientes para a resolução
numérica de problemas de natureza elíptica.

Vale ressaltar que problemas de Poisson surgem naturalmente na modelagem de problemas de
escoamento com três e duas fases, onde suas equações governantes são compostas por um sistema
de transporte de saturações, acoplado a um problema de pressão-velocidade de natureza elíptica
(ver, Cap. 2). Em seguida, usamos uma técnica de decomposição de operadores de modo a separar
a resolução das equações de pressão-velocidade das equações de transporte de fluidos. Por fim,
conseguimos “isolar” a aproximação da EDP elíptica (ver, Cap 3). Usamos então, um método de
elementos finitos mistos híbridos para discretizar as equações de pressão-velocidade recaindo em
um sistema linear simétrico definido positivo e esparso (ver, Cap 4).

Analisando todo o contexto em que se insere esse sistema linear, como a heteregeneidade do
meio poroso e o fato de que esse sistema será resolvido em conjunto a um problema de evolução no
tempo, escolhemos um método recentemente introduzido por Klaus Lackner e Ralph Menikoff no
artigo “Multiscale Linear Solvers for Very Large Systems Derived from PDES”, publicado em SIAM
Journal on Scientific Computing, 2000 [115]. Esse método combina gradientes conjugados com um
pré-condicionador multiescala que satisfaz todos os nossos pré-requisitos, levando em consideração
a natureza física do problema a ser resolvido. Dessa forma, esperamos que esse método resolva

77



eficientemente o sistema linear em um número pequeno de iterações no contexto de problemas de
transporte de fluidos.

Apresentamos no Capítulo 6 diversos experimentos para o problema de pressão-velocidade com
permeabilidade heterogênea, de forma a reproduzir o caráter multiescala do meio poroso. O método
multiescala obteve boas soluções numéricas para distintos problemas de Poisson em dinâmica de
fluidos com meios homogêneos e heterogêneos em duas dimensões, mostrando a viabilidade do
método proposto. Foi possível ver que o método necessitou de poucas iterações em todos os casos.
Foram menos de 0.02% do total de elementos do problema na malha mais fina. E esse número se
manteve mesmo mudando as condições de contorno. Tal resultado é compatível com os encontrados
por K. Lackner e R. Menikoff em [115].

Nas malhas mais grossas, o número acumulado de iterações é maior que na malha fina, porém a
razão das iterações entre malhas diminui conforme engrossamos e refinamos a malha (diminuimos
o espaçamento). O esforço computacional em cada nível é proporcional ao número de iterações
desse nível vezes a dimensão do nível. Assim, mesmo com o maior número de iterações nos níveis
grossos, o esforço computacional total é dominado pelo nível mais fino.

O tempo de computação foi maior que o esperado. Isso se deve ao número grande de iterações do
smoother, causado pela difícil escalabilidade das condições de contorno (ver, Cap. 5). Esperamos
que o uso de smoothers e implementações mais eficientes resolva esse problema.

7.2 Perspectivas
O próximo passo no estudo desse algoritmo é reduzir o tempo computacional. Para termos uma

ideia de como o tempo do algoritmo se comporta, resolvemos apenas um problema de geometria
Slab com permeabilidade heterogênea (? = 2) e dimensão 1024 × 1024 em uma máquina com-
putadora mais potente. Esse tipo de problema levou cerca de 50 minutos para ser resolvido pela
máquina utilizada para os experimentos deste trabalho. Na máquina mais potente, esse tempo caiu
para 18 minutos com o uso do compilador gcc. O tempo computacional foi reduzido ainda mais,
para cerca de 12 minutos ao usarmos um compilador intel. Foi um ganho de aproximadamente
76% do tempo computacional de uma máquina para outra, e aproximadamente 33% de ganho em
uma mesma máquina mas com compiladores diferentes.

Uma possível modificação da implementação do pré-condicionador multiescala recursivo está
em andamento e esperamos implementá-la futuramente. Em coloboração com o Professor Doutor
Tomihiro Sogabe 1, conseguimos obter uma forma mais eficiente de calcular o smoother, reduzindo
o número de operações. Basicamente, fazemos uma mudança no cálculo do pré e pós smoothers.

Considere o precondicionador multiescala multigrid (5.2.16) apresentado no Capítulo 5, dado
pela equação

M?1 = (P?1Q)? ?A?1? ?(QP
?1)? +

2??1??
?=0

H?P?1. (7.2.1)

1Professor associado em Graduate School of Information Science &amp;amp; Technology Aichi Prefectural University,
Japan.

78



A modificação é dada da seguinte maneira: considere o sistema linear discreto A? = ? obtido
da discretização por elementos finitos mistos do problema de pressão-velocidade, como feito no
Capítulo 4. A aplicação do pré-condicionador (7.2.1) em um vetor ? = M?1? será feita em uma
ordem diferente, dada pelo seguinte algoritmo:

Algoritmo 7.1 : Implementação modificada do pré-condicionador multiescala.
Seja ? = M?1?.
Resolva P? = ?;
for ? = 0, 1, . . . , ? ? 1 do

? = P?1Q? + ?;
end for
? = (P?1Q)? [? + ?A??(? ? A?)] + ?;

No nosso algoritmo atual, o número de operações da multiplicação (P?1Q)-vetor é da ordem
de 4?. Com a modificação, esse número reduz para 2?. O Algoritmo 7.1 obtem esse resultado
calculando os termos referentes ao smoother de uma maneira diferente. Esperamos que essa imple-
mentação resulte na redução do tempo computacional devido à diminuição do número de operações.

Esperamos futuramente também explorar programação em paralelo para reduzir o tempo. Pre-
tendemos usar a estratégia OpenMP [4], em conjunto ao algoritmo apresentado neste trabalho e
também à possível modificação vista nos parágrafos anteriores. Nossa intenção é continuar rodando
o algoritmo em um laptop básico.

Uma outra estratégia para a redução do tempo computacional seria aplicar diferentes opera-
dores de restrição e de prolongação. Vimos, com base nos experimentos numéricos, que o pré-
condicionamento multiescala recursivo é fortemente baseado nas estratégias de definição dos ope-
radores de restrição e prolongação. Tais operadores de aproximação estão naturalmente associadas
ao procedimento de discretização subjacente. Neste trabalho, escolhemos empregar os operadores
de restrição e de prolongação especificamente com respeito à variável pressão, de acordo com o que
foi feito no trabalho do Lackner &amp;amp; Menikoff por meio da discretização por diferenças finitas. No
entanto, adotamos neste trabalho uma metodologia de aproximação por elementos finitos mistos
em espaços ?(???), onde a pressão e a velocidade são aproximados simultaneamente. Portanto,
é também natural considerar operadores de restrição e de prolongação no contexto de espaços
mistos, de tal forma que a boa propriedade de conservação local seja efetiva em conduzir uma boa
aproximação e também preservando a conservação local. Isso também constitui uma perspectiva
para trabalho futuro.

7.3 Considerações finais
Apresentamos um método multiescala para a aproximação de problemas elípticos, com foco em

problemas de pressão-velocidade que frequentemente aparecem em problemas de escoamentos em
meios porosos. A escolha de um algoritmo multiescala é motivada pela heterogeneidade intrinsica
do meio poroso, demonstrado pela grande variabilidade das propriedades de permeabilidade e
porosidade das rochas que compõe o meio poroso.

79



Aplicações futuras do método multiescala recursivo envolvem o acoplamento deste algoritmo
com outros métodos numéricos para resolver os problemas de convecção e difusão, de modo a
resolver problemas completos de escoamento de fluidos em meios porosos. Nosso próximo passo é
aplicar esse método em problemas bifásicos com histerese, como visto no capítulo 2.

80



Referências

[1] E. Abreu. “Numerical simulation of three-phase flow in heterogeneous media with spatially
varying nonlinear hyperbolic-parabolic flux functions”. Em: AIMS on Applied Mathematics
Vol.8 Hyperbolic Problems: Theory, Numerics, Applications (2012), pp. 233–240.

[2] E. Abreu. “Numerical modelling of three-phase immiscible flow in heterogeneous porous
media with gravitational effects”. Em: Mathematics and Computers in Simulation 97 (2014),
pp. 234–259.

[3] E. Abreu, A. Alvarez, P. Ferraz e W. Lambert. “A computational multiscale approach for
incompressible two-phase flow in heterogeneous porous media including relative permeabi-
lity hysteresis”. Em: International Conference on Approximation Methods and Numerical
Modelling in Environment and Natural Resources MAMERN VI (2015).

[4] E. Abreu e R. Beauclair. “Exploiting OpenMP Efficiency for Multiphase Flow Simula-
tion in Heterogeneous Porous Media”. Em: 30? Iberian-Latin-American Congress on Comp.
Methods in Engineering (2012), p. 18.

[5] E. Abreu e D. Conceição. “Numerical Coupling of Multiphysics Flows in Porous Media”.
Em: 3rd International Conference on Approximation Methods and Numerical Modelling in
Environment and Natural Resources, Pau (France), June 8-11 1 (2009), pp. 19–24.

[6] E. Abreu e D. Conceição. “Numerical Modeling of Degenerate Equations in Porous Media
Flow”. Em: Journal of Scientific Computing 55.3 (2013), pp. 688–717.

[7] E. Abreu, J. Douglas, F. Furtado e F. Pereira. “Operator splitting based on physics for
flow in porous media”. Em: International Journal of Computational Science 2.3 (2008),
pp. 315–335.

[8] E. Abreu, J. Douglas, F. Furtado e F. Pereira. “Operator splitting for three-phase flow in
heterogeneous porous media”. Em: Communications in Computational Physics 6.1 (2009),
p. 72.

[9] E. Abreu, J. Douglas Jr, F. Furtado, D. Marchesin e F. Pereira. “Three-phase immiscible
displacement in heterogeneous petroleum reservoirs”. Em: Mathematics and computers in
simulation 73.1 (2006), pp. 2–20.

[10] E. Abreu, F. Furtado e F. Pereira. “On The Numerical Simulation of Three-phase Flows
in Heterogeneous Porous Media”. Em: Lecture Notes in Computer Science 4395 (2007),
pp. 504–517.

81



[11] E. Abreu, F. Furtado, F. Pereira e G. Souza. “Numerical Modeling of Two-phase Flow
With Hysteresis in Heterogeneous Porous Media”. Em: Rio Oil &amp;amp; Gas Conference, IBP1685
(2008), pp. 8–15.

[12] E. Abreu e W. Lambert. “Computational modeling technique for numerical simulation of
immiscible two-phase flow problems involving flow and transport phenomena in porous
media with hysteresis”. Em: American Institute of Physics 1453 (2012), pp. 141–146.

[13] E. Abreu e F. Pereira. “Desenvolvimento de Novas estratégias Para a Recuperação Avançada
de Hidrocarbonetos em Reservatórios de Petróleo”. Em: Boletim Técnico da Produção de
Petróleo (PETROBRAS-CENPES) 2 (2007), pp. 83–106.

[14] E. Abreu, F. Pereira e S. Ribeiro. “Central schemes for porous media flows”. Em: Compu-
tational &amp;amp; Applied Mathematics 28.1 (2009), pp. 87–110.

[15] P. Ackerer, G. Chavent, M. Quintard, R. di C. Roupert e G. Schäfer. “Construction of
three-phase data to model multiphase flow in porous media: Comparing an optimization
approach to the finite element approach”. Em: Comptes Rendus Geoscience 342 (2010),
pp. 855–863.

[16] M. Ahmadi. “Development of a higher-order finite volume method for simulation of thermal
oil recovery process using moving mesh strategy”. Em: Society of Petroleum Engineers
(2008), pp. 37–57.

[17] C. Almeida, J. Douglas Jr e F. Pereira. “A new characteristics-based numerical method
for miscible displacement in heterogeneous formations”. Em: Computational and Applied
Mathematics 21 (2002), pp. 573–605.

[18] C. Almeida, J. Douglas Jr, F. Pereira, L. C. Roman e L. M. Yeh. “Algorithmic Aspects of
a Locally Conservative Eulerian-Lagrangian Method for Transport-Dominated Fluid Flow
and Transport in Porous Media”. Em: Mathematical and Numerical Treatment: Proceedings
of an AMS-IMS-SIAM Joint Summer Research Conference on Fluid Flow and Transport in
Porous Media, Mathematical and Numerical Treatment, June 17-21, 2001, Mount Holyoke
College, South Hadley, Massachusetts. Vol. 295. American Mathematical Soc. 2002, p. 37.

[19] P.R. Amestoy, I.S. Duff, J. Koster e J-Y. L’Excellent. “A fully asynchronous multifrontal
solver using distributed dynamic scheduling”. Em: SIAM Journal on Matrix Analysis and
Applications 23.1 (2001), pp. 15–41.

[20] M.P. Anderson e H. Wang. Introduction to Groundwater Modeling: Finite Difference and
Finite Element Methods. Academic Press, 1982.

[21] J. Aquino, H. P. Amaral Souto, A. S. Francisco, T. Jordem Pereira e F. Pereira. “A La-
grangian strategy for the numerical simulation of radionuclide transport problems”. Em:
Progress in Nuclear Energy 52.3 (2010), pp. 282–291.

[22] J. Aquino, H. P. Amaral Souto, A. S. Francisco e F. Pereira. “On the stric hypebolicity of
the Buckley-Leverett equations for three-phase flow in a porous medium”. Em: An overview
of Euleriane-Lagrangian schemes applied to radionuclide transport in unsaturated porous
media 50 (2008), pp. 774–787.

82



[23] D.N. Arnold, F. Brezzi, B. Cockburn e L. D. Marini. “Unified analysis of discontinuous
Galerkin methods for elliptic problems”. Em: SIAM journal on numerical analysis 39.5
(2002), pp. 1749–1779.

[24] V. Artus, F. Furtado, B. Noetinger e F. Pereira. “Stochastic analysis of two-phase immis-
cible flow in stratified porous media”. Em: Computational and Applied Mathematics 23.2-3
(2004), pp. 153–172.

[25] S.F. Ashby e R.D. Falgout. “A parallel multigrid preconditioned conjugate gradient algo-
rithm for groundwater flow simulations”. Em: Nuclear science and engineering 124.1 (1996),
pp. 145–159.

[26] I. Babuvska, U. Banerjee e J.E. Osborn. “Generalized finite element methods—main ideas,
results and perspective”. Em: International Journal of Computational Methods 1.01 (2004),
pp. 64–103.

[27] P. Bedrikovetsky, P. Krause, D. Marchesin e B. Plohr. “Modeling hysteresis in porous media
flow via relaxation”. Em: Computational Geosciences 5.3 (2001), pp. 225–256.

[28] N. Bellomo, F. Brezzi e G. Manzini. “Recent techniques for PDE discretizations on polyhe-
dral meshes”. Em: Mathematical Models and Methods in Applied Sciences 24.8 (2014),
pp. 1453–1455.

[29] S. M. Benson, S. Krevor e R. Pini. “Capillary pressure and heterogeneity for the CO2 water
system in sandstone rocks at reservoir conditions”. Em: Advances in Water Resources 38
(2012), pp. 48–59.

[30] M. Benzi, G.H. Golub e J. Liesen. “Numerical solution of saddle point problems”. Em: Acta
numerica 14 (2005), pp. 1–137.

[31] I. Berre, H.K. Dahle, K.H. Karlsen e H.F. Nordhaug. “A streamline front tracking method
for two-and three-phase flow including capillary forces”. Em: Contemporary Mathematics
295 (2002), pp. 49–62.

[32] J. G. Blom e J. G. Verwer. “A comparison of integration methods for atmospheric transport-
chemistry problems”. Em: Journal of computational and Applied Mathematics 126.1 (2000),
pp. 381–396.

[33] M.J. Blunt e M.D. Jackson. “Elliptic regions and stable solutions for three-phase flow in
porous media”. Em: Transport in porous media 48.3 (2002), pp. 249–269.

[34] M.R. Borges, F. Furtado, F. Pereira e H.P.A. Souto. “Scaling analysis for the tracer flow pro-
blem in self-similar permeability fields”. Em: Multiscale Modeling &amp;amp; Simulation 7.3 (2008),
pp. 1130–1147.

[35] M. A. Botchev e J. G. Verwer. “A new approximate matrix factorization for implicit time
integration in air pollution modeling”. Em: Journal of computational and applied mathe-
matics 157.2 (2003), pp. 309–327.

[36] A. Brandt. “Multi-level adaptive solutions to boundary-value problems”. Em: Mathematics
of computation 31.138 (1977), pp. 333–390.

83



[37] A. Brandt e O. E. Livne. Multigrid Techniques: 1984 Guide with Applications to Fluid Dy-
namics, Revised Edition. Classics in Applied Mathematics. Society for Industrial e Applied
Mathematics, 2011. isbn: 9781611970746. url: http://books.google.com.br/books?
id=EvClMX03MyAC.

[38] S. C. Brenner, H. Li e L. Y. Sung. “Multigrid methods for saddle point problems: Stokes
and Lamé systems”. Em: Numerische Mathematik 128.2 (2014), pp. 193–216.

[39] S.C. Brenner e R. Scott. The mathematical theory of finite element methods. Vol. 15. Sprin-
ger, 2008.

[40] F. Brezzi, A. Buffa e K. Lipnikov. “Mimetic finite differences for elliptic problems”. Em:
ESAIM: Mathematical Modelling and Numerical Analysis 43.02 (2009), pp. 277–295.

[41] F. Brezzi e M. Fortin. Mixed and hybrid finite element methods. Springer, 1991.
[42] W. L. Briggs e S. F. McCormick. A multigrid tutorial. Vol. 72. Siam, 2000.
[43] H. Bruining, R. Farajzadeh e B. Meulenbroek. “The effect of interface movement and vis-

cosity variation on the stability of a diffusive interface between aqueous and gaseous CO2”.
Em: Physics of Fluids (1994-present) 25.7 (2013), p. 074103.

[44] J. Bruining e W. J. Plug. “Capillary pressure for the sand-CO2-water system under various
pressure conditions. Application to CO2 sequestration”. Em: Advances in Water Resources
30 (2007), 2339–2353.

[45] J. Bruining, H. Salimi e K. H. Wolf. “The influence of capillary pressure on the phase
equilibrium of the CO2-water system: Application to carbon sequestration combined with
geothermal energy”. Em: International Journal of Greenhouse Gas Control 11S (2012),
S47–S66.

[46] L.C. Campos. “Modelagem do escoamento de fluidos em meios porosos utilizando a es-
trutura de dados Autonomous Leaves Graph”. Diss. de mestrado. Universidade Federal de
Minas Gerais, UFMG, 2013.

[47] M. A. Celia, R. E. Ewing, I. Herrera e T. F. Russell. “An Eulerian-Lagrangian localized
adjoint method for the advection-diffusion equation”. Em: Advances in Water Resources
13.4 (1990), pp. 187–206.

[48] D. Chapelle e K. J. Bathe. “The inf-sup test”. Em: Computers &amp;amp; structures 47.4 (1993),
pp. 537–545.

[49] G. Chavent, R. di Chiara Roupert e G. Schäfer. “Three-phase compressible flow in porous
media: Total Differential Compatible interpolation of relative permeabilities”. Em: Journal
of Computational Physics 229.12 (2010), pp. 4762–4780.

[50] G. Chavent e J. Jaffré. Mathematical Models and Finite Elements for Reservoir Simula-
tion: Single Phase, Multiphase and Multicomponent Flows through Porous Media. Studies
in Mathematics and its Applications. Elsevier Science, 1986.

[51] Z. Chen. “Formulations and numerical methods of the black oil model in porous media”.
Em: SIAM Journal on Numerical Analysis 38.2 (2000), pp. 489–514.

84

http://books.google.com.br/books?id=EvClMX03MyAC
http://books.google.com.br/books?id=EvClMX03MyAC


[52] Z. Chen. Finite element methods and their applications. Vol. 5. Springer, 2005.
[53] Z. Chen. Reservoir simulation: mathematical techniques in oil recovery. Vol. 77. Siam, 2007.
[54] Z. Chen e R.E. Ewing. “Comparison of various formulations of three-phase flow in porous

media”. Em: Journal of Computational Physics 132.2 (1997), pp. 362–373.
[55] Z. Chen, G. Huan e Y. Ma. Computational methods for multiphase flows in porous media.

Vol. 2. Siam, 2006.
[56] A. Chertock, C. R. Doering, E. Kashdan e A. Kurganov. “A fast explicit operator splitting

method for passive scalar advection”. Em: Journal of Scientific Computing 45.1-3 (2010),
pp. 200–214.

[57] A.J. Chorin, T.J.R. Hughes, M.F. McCraken e J.E. Marsden. “Product Formulas and Nu-
merical Algorithms”. Em: Comm. Pure Appl. Math. 31 (1978), pp. 205–256.

[58] H. de Coninck e E. Rubin. “IPCC special report on carbon dioxide capture and storage”.
Em: Prepared by working group III of the intergovernmental panel on climate change Inter-
governmental Panel on Climate Change. Cambridge, UK (2005).

[59] J. H. Cushman. Dynamics of fluids in hierarchical porous media. Academic Press Inc.(London)
Ltd., 1990.

[60] C. M. Dafermos. Hyperbolic conservation laws in continuum physics, 2nd edition. Springer-
Verlag, Berlin, 2005.

[61] H. K. Dahle, M. S. Espedal, R. E. Ewing e O. Saevereid. “Characteristic adaptive subdo-
main methods for reservoir flow problems”. Em: Numerical Methods for Partial Differential
Equations 6.4 (1990), pp. 279–309.

[62] H. K. Dahle, R. E. Ewing e T. F. Russell. “Eulerian-Lagrangian localized adjoint methods
for a nonlinear advection-diffusion equation”. Em: Computer methods in applied mechanics
and engineering 122.3 (1995), pp. 223–250.

[63] H. K. Dahle, K. H. Karlsen, K. A. Lie, J. R. Natvig e H. F. Nordhaug. “Operator splitting
methods for systems of convection-diffusion equations: nonlinear error mechanisms and
correction strategies”. Em: J. of Computational Physics 173.2 (2001), pp. 636–663.

[64] H.K. Dahle, K.H. Karlsen, K.A. Lie, J.R. Natvig e H.F. Nordhaug. “Operator splitting
methods for systems of convection-diffusion equations: nonlinear error mechanisms and
correction strategies”. Em: Journal of Computational Physics 173.2 (2001), pp. 636–663.

[65] C.N. Dawson e M.F. Wheeler. “An operator-splitting method for advection-diffusion-reaction
problems”. Em: The Mathematics of Finite Elements and Applications VI (1988), pp. 463–
482.

[66] dealII14. Último acesso em Maio de 2014. url: http://www.dealii.org/.
[67] D.A. Di Pietro e A. Ern. Mathematical aspects of discontinuous Galerkin methods. Springer,

2012, p. 410.

85

http://www.dealii.org/


[68] C. Douglas, F. Furtado, V. Ginting, M. Mendes, F. Pereira e M. Piri. “On the development
of a high-performance tool for the simulation of CO2 injection into deep saline aquifers”.
Em: Rocky Mountain Geology 45.2 (2010), pp. 151–161.

[69] J. Douglas Jr. “Numerical methods for the flow of miscible fluids in porous media”. Em:
Numerical methods in coupled systems (1984), pp. 405–439.

[70] J. Douglas Jr, F. Furtado e F. Pereira. “On the numerical simulation of waterflooding of
heterogeneous petroleum reservoirs”. Em: Computational Geosciences 1.2 (1997), pp. 155–
190.

[71] J. Douglas Jr, F. Furtado, F. Pereira e L. M. Yeh. “On the numerical simulation of waterflo-
oding of heterogeneous petroleum reservoirs”. Em: Computational Geosciences 1.2 (1997),
pp. 155–190.

[72] J. Douglas Jr, F. Pereira e L. M. Yeh. “A locally conservative Eulerian-Lagrangian method
for flow in a porous medium of a mixture of two components having different densities”.
Em: Numerical Treatment of Multiphase Flows in Porous Media (2000), pp. 138–155.

[73] J. Douglas Jr, F. Pereira e L. M. Yeh. “A locally conservative Eulerian-Lagrangian numerical
method and its application to nonlinear transport in porous media”. Em: Computational
Geosciences 4.1 (2000), pp. 1–40.

[74] J. Droniou. “Finite volume schemes for diffusion equations: Introduction to and review of
modern methods Math”. Em: Models Methods Appl. Sci. 24 (2014), pp. 1575–1619.

[75] I.S. Duff, A.M. Erisman e J.K. Reid. Direct methods for sparse matrices. Clarendon Press
Oxford, 1986.

[76] L.J. Durlofsky e M.G. Gerritsen. “Modeling fluid flow in oil reservoirs”. Em: Annu. Rev.
Fluid Mech. 37 (2006), pp. 211–238.

[77] C. Erath. “Coupling of the finite volume element method and the boundary element method:
An a priori convergence result”. Em: SIAM Journal on Numerical Analysis 50.2 (2012),
pp. 574–594.

[78] A. Ern, I. Mozolevski e L. Schuh. “Discontinuous Galerkin approximation of two-phase
flows in heterogeneous porous media with discontinuous capillary pressures”. Em: Computer
Methods in Applied Mechanics and Engineering 199.23 (2010), pp. 1491–1501.

[79] O. G. Ernst e M. J. Gander. “Why it is difficult to solve Helmholtz problems with clas-
sical iterative method”. Em: Numerical Analysis of Multiscale Problems. Lecture Notes in
Computational Science and Engineering 83 (2012), pp. 325–363.

[80] M.S. Espedal e K. H. Karlsen. “Numerical solution of reservoir flow models based on large
time step operator splitting algorithms”. Em: Filtration in Porous Media and Industrial
Application. Springer, 2000, pp. 9–77.

[81] S. Evje, I. Fjelde, T. Kaarstad, H. Kleppe, S. M. Skjaeveland e L. Yu. “Modelling of wet-
tability alteration processes in carbonate oil reservoirs”. Em: Networks and Heterogeneous
Media 3.1 (2008), p. 149.

86



[82] S. Evje e H. Friis. “Numerical treatment of two-phase flow in capillary heterogeneous porous
media by finite-volume approximations”. Em: Int. J. Numer. Anal. Mod. 9 (2012), pp. 505–
528.

[83] R.E. Ewing, T.F. Russell e M.F. Wheeler. “Convergence analysis of an approximation of
miscible displacement in porous media by mixed finite elements and a modified method of
characteristics”. Em: Computer Methods in Applied Mechanics and Engineering 47.1 (1984),
pp. 73–92.

[84] R.E. Ewing e M.F. Wheeler. “The approximation of the pressure by a mixed method in the
simulation of miscible displacement”. Em: ESAIM: Mathematical Modelling and Numerical
Analysis-Modélisation Mathématique et Analyse Numérique 17.1 (1983), pp. 17–33.

[85] R.E. Ewing e M.F. Wheeler. “The approximation of the pressure by a mixed method in the
simulation of miscible displacement”. Em: RAIRO Anal. Numér. 17.1 (1983), pp. 17–33.

[86] M.W. Farthing, S.E. Gasda, C.E. Kees e C.T. Miller. “Adaptive split-operator methods
for modeling transport phenomena in porous medium systems”. Em: Advances in Water
Resources 34.10 (2011), pp. 1268–1282.

[87] A. Francisco, V. Ginting, F. Pereira e Rigelo J. “Design and implementation of a mul-
tiscale mixed method based on a nonoverlapping domain decomposition procedure”. Em:
Mathematics and Computers in Simulation 99 (2014), pp. 125–138.

[88] K.M. Furati. “Effects of relative permeability history dependence on two-phase flow in
porous media”. Em: Transport in Porous Media 28.2 (1997), pp. 181–203.

[89] F. Furtado e F. Pereira. “Crossover from nonlinearity controlled to heterogeneity control-
led mixing in two-phase porous media flows”. Em: Computational Geosciences 7.2 (2003),
pp. 115–135.

[90] S. Geiger, R. Holm e M.I.J. van Dijke. “Three-phase flow modelling using pore-scale capillary
pressures and relative permeabilities for mixed-wet media at the continuum-scale”. Em:
Transport in porous media 81.3 (2010), pp. 423–442.

[91] J. Geiser. Decomposition methods for differential equations: theory and applications. CRC
Press, 2009.

[92] A. George e J.W. Liu. Computer Solution of Large Sparse Positive Definite Systems. Prentice-
Hall, Englewood Cliffs, NJ, 1981.

[93] M. G. Gerritsen, J. E. Kozdon e B. T. Mallison. “Multidimensional upstream weighting
for multiphase transport in porous media”. Em: Computational Geosciences 15.3 (2011),
pp. 399–419.

[94] J. Glimm, S. Hou, Y. Lee, D. Sharp e K. Ye. “Prediction of oil production with confidence
intervals”. Em: SPE Reservoir Simulation Symposium. Society of Petroleum Engineers.
2001.

[95] J. Glimm e D. Sharp. “Stochastic methods for the prediction of complex multiscale pheno-
mena”. Em: Quarterly of applied mathematics 56.4 (1998), pp. 741–766.

87



[96] J. Glimm e D. H. Sharp. “A random field model for anomalous diffusion in heterogeneous
porous media”. Em: Journal of statistical Physics 62.1-2 (1991), pp. 415–424.

[97] J. Glimm e D. H. Sharp. “Prediction and the quantification of uncertainty”. Em: Physica
D (1999), pp. 152–170.

[98] S. K. Godunov. “A finite difference method for numerical calculation of discontinuous so-
lutions of the equations of fluid dynamics”. Em: Mat. Sb. (in russian) 47 (1959), pp. 271–
290.

[99] G. H. Golub e D. P. O’Leary. “Some history of the conjugate gradient and Lanczos algo-
rithms: 1948-1976”. Em: SIAM review 31.1 (1989), pp. 50–102.

[100] A. Greenbaum. Iterative methods for solving linear systems. Vol. 17. Siam, 1997.
[101] P. E. Hardisty, S. A. Mathias, M. R. Trudell e R. W. Zimmerman. “Approximate solutions

for pressure buildup during CO2 injection in brine aquifers”. Em: Transport in Porous
Media 79.2 (2009), pp. 265–284.

[102] M. R. Hestenes e E. Stiefel. “Methods of Conjugate Gradients for Solving Linear Systems1”.
Em: Journal cf Research of the National Bureau of Standards Vol 49 (1952), pp. 409–436.

[103] H. Holden e L. Holden. “On the stric hypebolicity of the Buckley-Leverett equations for
three-phase flow in a porous medium”. Em: J. Applied Math. 50.3 (1990), pp. 667–682.

[104] H. Holden, K.H. Karlsen, K. A. Lie e N. H. Risebro. “Operator Splitting for Nonlinear
Partial Differential Equations with Rough Solutions Analysis and Matlab Programs”. Em:
EMS Series of Lectures in Mathematics (2010), 226 pages.

[105] W. Joppich e R. Wienands. Practical Fourier Analysis for Multigrid Methods. Numerical
Insights. CRC Press, 2004. isbn: 9781420034998.

[106] R. Juanes e T.W. Patzek. “Relative permeabilities for strictly hyperbolic models of three-
phase flow in porous media”. Em: Transport in porous media 57.2 (2004), pp. 125–152.

[107] K. H. Karlsen e N. H. Risebro. “An operator splitting method for nonlinear convection-
diffusion equations”. Em: Numer. Math. 77.3 (1997), pp. 365–382.

[108] K. H. Karlsen e N. H. Risebro. “Viscous splitting approximation of mixed hyperbolic-
parabolic convection-diffusion equations”. Em: Numer. Math. 83.1 (1999), pp. 107–137.

[109] K. H Karlsen e N. H. Risebro. “Corrected operator splitting for nonlinear parabolic”. Em:
J. on Numerical Analysis 37.3 (2000), 980–1003.

[110] K. H. Karlsen e N. H. Risebro. “Corrected Operator Splitting Method For Nonlinear Para-
bolic Equations”. Em: J. Numer. Anal. 37.3 (2000), pp. 980–1003.

[111] J. Kou e S. Sun. “A new treatment of capillarity to improve the stability of IMPES two-
phase flow formulation”. Em: Computers and Fluids 39.10 (2010), pp. 1923–1931.

[112] J. C. C. Kuo e B. C. Levy. “Two-Color Fourier Analysis of the Multigrid Method with Red-
Black Gauss-Seidel Smoothing”. Em: Applied Mathematics and Computation 29 (1989),
pp. 69–87.

88



[113] A. Kurganov, G. Petrova e B. Popov. “Adaptive semidiscrete central-upwind schemes for
nonconvex hyperbolic conservation laws”. Em: SIAM Journal on Scientific Computing 29.6
(2007), pp. 2381–2401.

[114] A. Kurganov e E. Tadmor. “New high-resolution central schemes for nonlinear conserva-
tion laws and convection-diffusion equations”. Em: Journal of Computational Physics 160.1
(2000), pp. 241–282.

[115] K. Lackner e R. Menikoff. “Multiscale Linear Solvers for Very Large Systems Derived
from PDES”. Em: SIAM Journal on Scientific Computing 21.5 (2000), pp. 1950–1968.
issn: 1064-8275 (print), 1095-7197 (electronic). doi: http : / / dx . doi . org / 10 . 1137 /
S1064827598339785.

[116] C.S. Land. “Calculation of imbibition relative permeability for two-and three-phase flow
from rock properties”. Em: Society of Petroleum Engineers Journal 8.02 (1968), pp. 149–
156.

[117] D. Lanser e J. G. Verwer. “Analysis of operator splitting for advection-diffusion-reaction
problems from air pollution modelling”. Em: Journal of computational and applied mathe-
matics 111.1 (1999), pp. 201–216.

[118] R.J. LeVeque. Finite Difference Methods for Ordinary and Partial Differential Equations:
Steady-State and Time-Dependent Problems. SIAM e-books. SIAM, 2007. url: http : / /
books.google.com.br/books?id=lZysESfSWwgC.

[119] K. Lipnikov, G. Manzini e L. B. Veiga. “The Mimetic Finite Difference Method for Elliptic
Problems”. Em: MS&amp;amp;A XVI (2014), 394 pages.

[120] D. Marchesin, H.B. Medeiros e P.J. Paes-Leme. “A model for two-phase flow with hystere-
sis”. Em: Contemporary Mathematics 60 (1987), pp. 89–107.

[121] D. Marchesin e B. J. Plohr. “Wave structure in WAG recovery”. Em: Society of Petroleum
Engineering Journal 71314 6.2 (2001), pp. 209–219.

[122] S.F. McCormick. Multigrid Methods. Frontiers in Applied mathematics. Society for Indus-
trial e Applied Mathematics, 1987. isbn: 9780898712148. url: http : / / books . google .
com.br/books?id=594AN97YHtwC.

[123] M. A. Mendes, M. A. Murad e F. Pereira. “A new computational strategy for solving
two-phase flow in strongly heterogeneous poroelastic media of evolving scales”. Em: In-
ternational Journal for Numerical and Analytical Methods in Geomechanics 36.15 (2012),
pp. 1683–1716.

[124] G. Meurant. Computer solution of large linear systems. Vol. 28. Studies in Mathematics e
its Applications, North-Holland, Amsterdam, 1999.

[125] A. Miranda. “Modelagem numérica do comportamento dinâmico entre frentes de ondas e
meios porosos descontínuos em problemas evolutivos de transporte de convecção-difusão”.
Tese de Doutorado em matemática aplicada em andamento, orientador: prof. Dr. Eduardo
Abreu.

89

http://dx.doi.org/http://dx.doi.org/10.1137/S1064827598339785
http://dx.doi.org/http://dx.doi.org/10.1137/S1064827598339785
http://books.google.com.br/books?id=lZysESfSWwgC
http://books.google.com.br/books?id=lZysESfSWwgC
http://books.google.com.br/books?id=594AN97YHtwC
http://books.google.com.br/books?id=594AN97YHtwC


[126] I. Mozolevski e L. Schuh. “Numerical simulation of two-phase immiscible incompressible
flows in heterogeneous porous media with capillary barriers”. Em: Journal of Computational
and Applied Mathematics 242 (2013), pp. 12–27.

[127] MUMPS: a parallel sparse direct solver. Último acesso em Maio de 2014. url: http://
mumps.enseeiht.fr/.

[128] L. Neal e G. Poole. “A Geometric Analysis of Gaussian Elimination”. Em: Linear Algebra
and its Applications 149 (1991), pp. 249–272.

[129] H. Nessyahu e E. Tadmor. “Non-oscillatory central differencing for hyperbolic conservation
laws”. Em: Journal of computational physics 87.2 (1990), pp. 408–463.

[130] C. W. Oosterlee, T. Washio e R. Wienands. “Fourier analysis of GMRES(m) preconditioned
by multigrid”. Em: SIAM Journal on Scientific Computing 22.2 (2000), pp. 582–603.

[131] C. W. Oosterlee e R. Wienands. “On three-grid Fourier analysis for multigrid”. Em: SIAM
Journal on Scientific Computing 23.2 (2001), pp. 651–671.

[132] C. O. Osterlee, U. Trottenberg e A. Schuller. Multigrid. Academic, Press, New York, 2001.
[133] D.W. Peaceman. Fundamentals of Numerical Reservoir Simulation. Developments in Petro-

leum Science. Elsevier Science, 2000. isbn: 9780080868608. url: http://books.google.
com.br/books?id=-DujQRDF4kwC.

[134] J. Peraire e P-O. Persson. “The compact discontinuous Galerkin (CDG) method for elliptic
problems”. Em: SIAM Journal on Scientific Computing 30.4 (2008), pp. 1806–1824.

[135] S. B. Pope e Z. Ren. “Second-order splitting schemes for a class of reactive systems”. Em:
Journal of Computational Physics 227.17 (2008), pp. 8165–8176.

[136] P. Raviart e J. Thomas. “A mixed finite element method for second order elliptic problems”.
Em: In: Lecture Notes in Mathematics (1977), pp. 292–315.

[137] J.E. Roberts e J-M. Thomas. “Mixed and hybrid methods”. Em: Handbook of numerical
analysis 2.Part 1 (1991), pp. 523–633.

[138] T. F. Russell. “Time stepping along characteristics with incomplete iteration for a galerkin
approximation of miscible displacement in porous media”. Em: J. Numer. Anal. 22 (1985),
pp. 970–1013.

[139] Y. Saad. Iterative Methods for Sparse Linear Systems: Second Edition. Society for Industrial
e Applied Mathematics, 2003. isbn: 9780898715347. url: http://books.google.com.br/
books?id=ZdLeBlqYeF8C.

[140] M. Shashkov e S. Steinberg. “Support-operator finite-difference algorithms for general el-
liptic problems”. Em: Journal of Computational Physics 118.1 (1995), pp. 131–151.

[141] J. R. Shewchuk. An introduction to the conjugate gradient method without the agonizing
pain. 1994.

[142] G. W. Stewart. Matrix Algorithms. Vol. 1-5. Siam, 2002.
[143] G. Strang. “On the construction and comparison of difference schemes”. Em: SIAM Journal

on Numerical Analysis 5.3 (1968), pp. 506–517.

90

http://mumps.enseeiht.fr/
http://mumps.enseeiht.fr/
http://books.google.com.br/books?id=-DujQRDF4kwC
http://books.google.com.br/books?id=-DujQRDF4kwC
http://books.google.com.br/books?id=ZdLeBlqYeF8C
http://books.google.com.br/books?id=ZdLeBlqYeF8C


[144] G. Strang. “On the construction and comparison of difference schemes”. Em: J. on Nume-
rical Analysis 5.3 (1968), pp. 506–517.

[145] SuperLU: is a general purpose library for the direct solution of large, sparse, nonsymmetric
systems of linear equations on high-end computers. Último acesso em Maio de 2014. url:
http://www.cs.berkeley.edu/~demmel/SuperLU.html, ouhttp://crd- legacy.lbl.
gov/~xiaoye/SuperLU/.

[146] O. Tatebe. “MGCG Method: A Robust And Highly Parallel Iterative Method”. Tese de
doutorado. University of Tokio, 1996.

[147] J. W. Thomas. Numerical partial differential equations: conservation laws and elliptic equa-
tions. Vol. 2. N.Y. Springer, 1999.

[148] J. W. Thomas. Numerical partial differential equations: conservation laws and elliptic equa-
tions. Vol. 3. Springer Berlin, 1999.

[149] A. Townsend e L. N. Trefethen. “Gaussian Elimination as an Iterative Algorithm”. Em:
SIAM News 46.2 (2013).

[150] L. N. Trefethen. “Three Mysteries of Gaussian Elimination”. Em: ACM SIGNUM Newsletter
20 (1985), pp. 2–5.

[151] UMFPACK: unsymmetric multifrontal sparse LU factorization package. Último acesso em
Maio de 2014. url: http://www.cise.ufl.edu/research/sparse/umfpack/.

[152] F.M. Van Kats e C.J. Van Duijn. “A mathematical model for hysteretic two-phase flow in
porous media”. Em: Transport in Porous Media 43.2 (2001), pp. 239–263.

[153] M. Vohralìk. “Equivalence between lowest-order mixed finite element and multi-point finite
volume methods on simplicial meshes”. Em: ESAIM: Mathematical Modelling and Nume-
rical Analysis 40.2 (2006), pp. 367–391.

[154] D.S. Watkins. Fundamentals of Matrix Computations. Wiley International Editions. Wi-
ley, 1991. isbn: 9780471614142. url: http : / / books . google . com . br / books ? id = 8 -
gZAQAAIAAJ.

[155] P. Wesseling. An Introduction to Multigrid Methods. Pure and applied mathematics. Wiley,
1992.

91

http://www.cs.berkeley.edu/~demmel/SuperLU.html, ou http://crd-legacy.lbl.gov/~xiaoye/SuperLU/
http://www.cs.berkeley.edu/~demmel/SuperLU.html, ou http://crd-legacy.lbl.gov/~xiaoye/SuperLU/
http://www.cise.ufl.edu/research/sparse/umfpack/
http://books.google.com.br/books?id=8-gZAQAAIAAJ
http://books.google.com.br/books?id=8-gZAQAAIAAJ


92



Apêndice A

Eliminação dos multiplicadores de
Lagrange

Iremos apresentar os cálculos para a eliminação das variáveis multiplicadores de Lagrange da
Seção 4.2.3 do Capítulo 4.

Considere as equações discretas (B.3.3) e (B.3.4) para um elemento ? qualquer,

?? + ?? + ?? + ?? = ?? ?, (A.0.1)

?? =
2? ?

?
(? ? ??), ? = ?, ?, ?, ?, (A.0.2)

mais as equações de consistência (4.2.28)

?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?, e ?? = ?, ?, ?, ?. (A.0.3)

Agora, vamos fixar ? = ?. Das equações de consistência (A.0.3) temos que,

?
(1)
? = ??

(2)
? , ?

(1)
? = ?

(2)
? , (A.0.4)

onde os superscritos (1) e (2) são usados para denotar elementos adjacentes. Dessa forma,

?
(1)
? =

2? (1) ?(1)
?

(?(1) ? ?(1)? ) = ?
2? (2) ?(2)

?
(?(2) ? ?(2)? ) = ??

(2)
? , (A.0.5)

=? ? (1) ?(1)(?(1) ? ?(1)? ) = ??
(2) ?(2)(?(2) ? ?(2)? ), (A.0.6)

=? ? (1) ?(1)(?(1) ? ?(1)? ) = ??
(2) ?(2)(?(2) ? ?(1)? ), (A.0.7)

=? ? (1) ?(1)?(1) ? ? (1) ?(1)?(1)? = ??
(2) ?(2)?(2) + ? (2) ?(2)?(1)? , (A.0.8)

=? ?(1)? =
? (1) ?(1)?(1) + ? (2) ?(2)?(2)

? (1) ?(1) + ? (2) ?(2)
. (A.0.9)

93



Substituindo ?(1)? em (A.0.5) temos:

?
(1)
? =

2? (1) ?(1)
?

[?
?(1) ?

? (1) ?(1)?(1) + ? (2) ?(2)?(2)
? (1) ?(1) + ? (2) ?(2)

]?
(A.0.10)

=
2(? (1) ?(1))2?(1) + 2? (1) ?(1)? (2) ?(2)(?(1) ? ?(2)) ? 2(? (1) ?(1))2?(1)

?(? (1) ?(1) + ? (2) ?(2))
(A.0.11)

=
2? (1) ?(1)? (2) ?(2)(?(1) ? ?(2))

?(? (1) ?(1) + ? (2) ?(2))
. (A.0.12)

Os cálculos para ? = ?, ?, ? são análogos, assim temos a seguinte equação para cada ?,

?? =
2? ? ???? ????(? ? ??)

?(? ? + ???? ????)
, ? = ?, ?, ?, ?. (A.0.13)

Definimos então,

(??)eff? =
2 ? ? ???? ????
? ? + ???? ????

. (A.0.14)

Por fim, juntando as equações (A.0.1) e (A.0.13) obtemos a seguinte equação para cada elemento,

??
?=?,?,?,?

(? ?)eff?
?2

(? ? ??) = ?? , (A.0.15)

que corresponde a equação (B.3.5) que compõe o sistema linear para a pressão.

94



Apêndice B

A computational multiscale approach for
incompressible two-phase flow in
heterogeneous porous media including
relative permeability hysteresis

Aqui apresentamos o texto completo do trabalho aceito no congresso International Conference
on Approximation Methods and Numerical Modelling in Environment and Natural Resources MA-
MERN VI, em Pau na França [3].

Abstract: The focus of this work is the numerical approximation of incompressible two-phase
transport problems with hysteresis in porous media coupled to a Poisson problem to the pressure-
velocity problem. Modeling hysteresis in porous media flow is relevant for instance in the numerical
simulation framework for modeling CO2 sequestration operations in large-scale heterogeneous for-
mations, such as deep saline aquifers and depleted oil and gas reservoirs. A combined mixed
discretization of locally conservative finite volume and mixed finite techniques will be applied
via an operator splitting formulation to address the flow equations. In particular, the numerical
solution of the resulting linearized system associated to the Poisson problem will be addressed
by a multiscale multigrid preconditioned conjugate gradient (PCG) method. Accurate numeri-
cal solutions in two-space dimensions to the hysteresis differential model at hand are provided to
demonstrate the viability of the proposed formulation.

B.1 Introduction
In this work we are concerned with an accurate numerical approximation of a related wate-

flooding transport flow problems with hysteresis phenomena in a two-dimensional heterogeneous
porous media. In particular, we describe a numerical method based on the preconditioned con-
jugate gradient method (PCG), with a multigrid multiscale preconditioner, recently introduced
in the literature “Multiscale Linear Solvers for Very Large Systems Derived from PDES”, SIAM

95



Journal on Scientific Computing, 2000, by Klaus Lackner and Ralph Menikoff [115] – see also [38,
30, 79] and references therein – for the numerical solution of the pressure-velocity system linked to
the underlying hysteresis two-phase flow problem. This scheme is combined with locally conserva-
tive hybrid mixed finite elements (HMFEM) along with a domain decomposition iteration for the
numerical solution of the parabolic problem associated with the diffusive transport of fluid phases.
Hybridized mixed finite elements is locally conservative by construction and it is quite adequate
for accurate computation of fluxes and velocity fields in the case of heterogeneous porous media
transport problems [7, 2, 70, 136]. In our numerical procedure a high resolution, nonoscillatory,
second order, conservative central difference scheme is used for the approximation of the nonlinear
system of hyperbolic conservation laws modelling the convective transport of the fluid phases [2,
123, 34].

Hysteresis may be the most important phenomenon in multiphase porous media flow that is
lacking rigorous mathematical analysis (see, e.g., [27, 12] and references therein). Hysteresis has
been identified for instance in physical phenomenas as such pseudo-elasticity, plasticity, supercon-
ductivity, ferromagnetism, biology, thin-film transistors, ferroelectricity, phase transitions, porous
media filtration, and in several other physical phenomena. Typically, hysteresis is often associated
with an irreversible mode of thermodynamic change. Mathematically, this means that we must
be able to deal with approximate or exact solutions of differential equations (i.e., parabolic, and
hyperbolic) with a flux function which is discontinuous with respect a state variable, e.g., satura-
tion. Essentialy, nonequilibrium effects associated with the state variable in interfaces in porous
media naturally leads to discontinuities in the hysteresis relation, which in turn is also associated
to the occurrence of free boundaries and (local) internal layers in the physical domain. This means
that hysteresis might be expressed by means of initial boundary value problems in the form of a
prototype nonlinear parabolic convection-diffusion problem. Its effects are modeled by assuming
that exists two extreme permeability curves, imbibition and drainage, describing the flow for the
oil saturation, in an irreversible fashion; and exists a continuous family of permeability curves,
called scanning curves, between the imbibition and drainage, describing the flow when the oil
permeability changes reversible.

The two-phase flow model with hysteresis considered herein takes into account capillary forces,
general expressions for the relative permeability functions, variable porosity and permeability fields.
For concreteness, we consider horizontal reservoirs with no gravity influence in the fluid flow. The
fluid phases are water and oil, indicated by the subscripts w and o, respectively, and they occupy
the whole pore space (i.e., ?? + ?? = 1). An additional state variable, the hysteresis parameter
? = ?(x, ?) is introduced to account for the dependence of the oil permeability ??(??, ?) on the
flow history [27, 12]. Then, we write the governing system of equations of two-phase flow with
hysteresis and no gravity, in the so-called phase formulation [50]; see also [2, 7]:

?

??
(? (x) ??) + ? · (u??) = ? · w?, (B.1.1)

? · u = 0, u = ?????? + u??, (B.1.2)

where (u??) (??, ?), w? and u are functions of ??, x and ?. Also, the diffusive term w? is defined
by,

w? (??, x) = ?? (x) [?? (??) (1 ? ??)] ???. (B.1.3)

96



The term u?? is a correction velocity and is are given by,

u?? = ?? (x) ?? (??) ???, (B.1.4)

with ??(??) = ??(??)/??, ? = ?, ?, (phase mobilities), ? = ?? + ?? (total mobility), ?? = ?/?? and
?? is the capillary pressure. The following PDE,

??

??
= ? (??, ?) =

???
??

(?? (??) ? ?)/?, if ? &amp;lt;?? (??) ,
(?? (??) ? ?)/?, if ? &gt; ?? (??) ,
0, otherwise,

(B.1.5)

is used to modeling the hysteresis in ?? with relaxation, where ?? and ?? relate to the imbibition
and drainage processes, respectively, and ? is the relaxation time. We consider the Scanning
Hysteresis Model with Relaxation (SHMR) [27] represented by equation (B.1.5). It allows the
scanning flow to extend beyond the drainage and imbibition curves treating those as attractors
of states outside the scanning region. The attraction occurs on a time scale corresponding to the
redistribution of phases within the pores, driven by capillary forces.

The outline of the remaining of the paper is as follows. In Section B.2 the key issues of compu-
tational modeling of the coupled two-phase flow system with hysteresis is discussed to the Poisson
pressure-velocity problem and to the diffusive problem by means of an operator splitting based
on physics for flow in porous media. We mention that for both fixed, the velocity and the water
saturation with hysteresis into the operator splitting approach, we then solve the purely convective
transport subproblem, associated to Eqs. (B.1.1) -(B.1.2) with the aid of a modified central scheme
to take into account variable porosity in the temporal operator as well as discontinuous hyperbolic
flux functions; for more details to the hyperbolic step see [2, 7]. The continuous-time mixed finite
element approximations to the ellipitc and parabolic problems are depicted in Section B.3 and
the numerical experiments are presented and analyzed in Section B.4, along with our concluding
remarks in Section B.5.

B.2 Computational Modeling with Hysteresis
In this stage, an operator splitting technique [2, 96, 12, 123, 34] is used to separate the un-

derlying physical process presented in the governing system. At first, we separate the calculation
of pressure-velocity problem from the saturation transport equation. Then we decompose the sa-
turation calculation into convective and diffusive followed by a relaxation step by solving (B.1.5).
Thus, we introduce three time steps: ??? for the hyperbolic problem related to the convective
transport of the fluids, ??? for the parabolic problem related to the diffusive transport, and ???,
for the pressure-velocity field. The algorithm for approximation of Eqs.(B.1.1)-(B.1.5) is described
as follows (only one single time step will be described ??? = ??? = ???, under the assumption
of all time steps are subject to stability conditions [2, 7, 70, 12]): 1) Given boundary and initial
conditions, we solve the pressure-velocity problem (B.1.2) using mixed finite elements [136] for
the computation of the pair (??, u); 2) use the latter solution of the saturation equation, which
incorporates convection and diffusion effects, as an initial condition. Then solve the stiff nonlinear

97



PDE (B.1.5) to incorporate the hysteresis effects on the flow; 3) fixing the velocity and the water
saturation with hysteresis, we solve the purely convective subproblem, associated to Eq.(B.1.1); see
[2, 70] for details. After each hyperbolic step we also solve Eq.(B.1.5) [12]; 4) take the convective
solution as initial condition and solve the purely diffusive subproblem associated to Eq.(B.1.1),
by a hybridized mixed finite element method [136] with an implicit backward Euler strategy in
time [7, 2]; 5) finally, use the latter solution of the saturation (as an initial condition), we update
Eq.(B.1.5) to solve the hysteresis effects on the flow. This sequence must be repeated until the
end of the simulation. Below we describe in more details this numerical approach.

First, assume {??} and {ww} are known. Than calculate the correction velocity uC. Let
u = v + uC and define a problem for (??, v) equivalent to Eq.(B.1.2) by,

v = ?? (x) ? (??, ?) ???,
? · v = ?? · uC (??, x, ?) ? ?? ,

(B.2.1)

subject to the boundary condition,

v · n =
{?

??, for ? = {0}, ? ? [0, ? ],
0, for ? = {0, ? }, ? ? [0, ?], (B.2.2)

where n is the unit outer normal vector to ?? and ? is the rate of water injection. In order to
capture viscous fingering effects [70, 2] we keep a constant reference pressure ?? at ? = {?} and
? ? [0, ? ]. Now:

1) Given ??? (x), ? ? 0, determine {??? , v?} at ?? = ????, ? = 0, 1, 2, ..., by solving the
Eq.(B.2.1). The initial data of ?? and hysteresis are given by right state (??, ?)? and left state
(??, ?)?, at ? = 0 [12].

2) Due to the stiff time scale [12], first use the following analytical solution for Eq.(B.1.5) to
account for the hysteresis equilibrium state from the initial data ?0? (x) = 1 ? ?0?(x) for ??? , in
particular for initial data out side the non-equilibrium region,

?? =

????
???

?? (?0? ) +
(?
?0 ? ?? (?0? )

)?
?????/? , if ?0 &amp;lt;?? (?0? ) ,

?? (?0? ) +
(?
?0 ? ?? (?0? )

)?
?????/? , if ?0 &gt; ?? (?0? ) ,

?0, otherwise.
(B.2.3)

3) ??? (x) is calculated in [???1, ??] for ? &gt; 0. For ?? &amp;lt;? &amp;lt;??+1 solve, sequentially, Eq.(B.1.1)
with initial condition, ??(x, ??) = ??? (x), and Eq.(B.1.5) for the relaxation parameter with initial
condition, ?(x, ??) = ??(x); and ??(x) is defined by solution of Eq.(B.2.3). Use the following
analytical solution for Eq.(B.1.5) to incorporate hysteresis for ???,

??+1 =

????
???

?? (??? ) +
(?
?? ? ?? (??? )

)?
?????/? , if ?? &amp;lt;?? (??? ) ,

?? (??? ) +
(?
?? ? ?? (??? )

)?
?????/? , if ?? &gt; ?? (??? ) ,

??, otherwise.
(B.2.4)

The initial condition for the analytical calculation of the hysteresis step is defined by ??? (x) =
1 ? ??? (x). The expression for ?? , is obtained by setting ??? (??) = ??? (??, ?); after algebraic

98



manipulations it is possible to obtain a functional form for ?? , such that 0 ? ?? ? 1 and 0 ? ?? ?
1. A similar procedure is adopted for ??, by setting ??? (??) = ??? (??, ?), [12].

We now turn our attention to the continuous-time mixed finite element approximations to the
elliptic (B.2.1) and to the parabolic problems. We focus on the approximation of the Poisson
equation by means of a multiscale algorithm for the solution of ill-conditioned large linear systems
obtained by the discretization of elliptic problems in fluid dynamics.

B.3 Continuous-time mixed finite element approximations
to the Ellipitc and Parabolic problems

After having identified the pressure-velocity problem (B.2.1)-(B.2.2) in Section B.2 we wish to
approximate the pair (v, ?) by mixed hybrid finite elements in order to obtain a symmetric positive
definite linear system, and then apply the multiscale method as introduced in [115].

B.3.1 Discretization of the Poisson-elliptic problem
It is well know that the mixed finite element formulation leads to a sparse symmetric positive

definite linear system [136, 2, 70, 7], but due to the multiscale nature of the reservoir permeability
this system is ill-conditioned. So a preconditioning technique is necessary to address this problem.

Now let ? = [0, ?] × [0, ? ] ? R2 be a bounded domain with a Lipschitz boundary ?? and
let {?? , ? = 1, . . . , ? } be a partition of disjoint elements of ?. Assume that the edges of each
partition are also Lipschitz and that ?? is star-shaped and ?? = ?? × ??. Let ? = ??, ?? =
? ? ??? , ??? = ??? ? ???. Defining the spaces ? ? ?2(?) and ? ? ?(???; ?), the hybridized
mixed finite element method is given [2, 136, 70, 7] by seeking, {?? , v? , ???} ? ? ?? × ? ?? × ???,
{?? , ? = 1, . . . , ? }, such that:

(? · v? , ?)?? ? (?? , ?)?? = 0, (B.3.1)
(??1??1v? , v?)?? ? (?? , ?·v?)?? +

??
? ?=?

????, v? · n? ???? = 0, (B.3.2)

for all test functions v?, ? ? (?? ) and ?, ? ? (?? ); n? is the unit outer normal to each element.
The Lagrange multipliers, ???, defined on ?? are introduced as a way to relax the consistency
conditions, ?? = ?? and v? · n? + v? · n? = 0 in ???, so we can permit discontinuous pressures across
each edge of ?? . The space ? ?? × ? ?? are the mixed finite element space chosen to be the lowest
index Raviart-Thomas space [136] over rectangles. The natural degrees of freedom on the element
?? , are the constant value ?? of the pressure at the center of ?? , and the four constant values
???, ? = ?, ?, ?, ? , of the outward normal component of the total fluxes across the edges of the
element for Darcy velocity [2, 70]. The Lagrange multipliers ??? and ??? on ??? are also constants
[2, 70, 136]. We also assume the absolute permeability to be constant on each element, and the
relative permeability functions to be independent of position.

For simplicity suppress the subscript ? and define ? ? ?? = ??. Now, consider the test function
as a basis function for vectors on the standard reference square [0, ?] and apply a trapezoidal rule

99



[2, 70] to the Eqs.(B.3.1)-(B.3.2), since it will allow us to write the resulting algebraic problem in a
particularly simple form. After the calculation with the four basis functions (?/?, 0), (1 ? ?/?, 0),
(?/?, 0) and (1 ? ?/?, 0) [2, 70], collect the five equations for the reference (oil) pressure in the
phase formulation:

?? + ?? + ?? + ?? = ?? ?, (B.3.3)

?? ?
2??

?
(? ? ??) = 0, ? = ?, ?, ?, ?. (B.3.4)

Note that we have five equations and nine variables. We chose to eliminate the Lagrange multipliers
since the resultant linear system is symmetric positive definite [2] and we can apply our numerical
method based on the conjugate gradient method. Combining the consistency conditions with the
Eqs.(B.3.3) and (B.3.4) we obtain the following discrete equation for the (oil) pressure and velocity:

??
?=?,?,?,?

(? ?)eff?
?2

(? ? ??) = ?? , (B.3.5)

where, (??)eff? is defined as the effective permeability across the ?-interface,

(??)eff? =
2 ? ? ???? ????
? ? + ???? ????

. (B.3.6)

In the above, ??, ????(??, ?) and ???? indicate the values of ? (reference oil pressure), ?(??, ?) and ?
in the element across the ?-interface, respectively. Indeed, ?? and ? are well defined at the element
cells. Notice that ? in (??)eff? depends on the relative permeability, which can be discontinuous;
(see Section B.4.1). The velocity in each interface is given by

?? =
(? ?)eff?

?
(? ? ??). (B.3.7)

Now we have a linear system A? = ?? for the oil pressure given by Eq. (B.3.5), which can be
solved by any efficient algebraic linear solver.

We now turn our attention to the discussion of the multiscale multigrid approach for solving
the algebraic linear problem A? = ?? , obtained from the above discretized Poisson problem by
the locally conservative mixed method.

B.3.2 A multigrid multiscale preconditioner method for the discreti-
zed coupled nonlinear Poisson-elliptic problem

The matrix A of the linear system (B.3.5) is ill-conditioned due to the rapid variation of the
permeability field caused by the geological properties of the reservoir, so the use of a preconditioner
is necessary [70, 2, 7, 96, 115]. This means we need a precondioning matrix M?1 that is a
good approximation for A?1. Since the pressure-velocity problem is coupled with a transport of
saturation equation over time – see Section B.2 – this means that we need to solve a Poisson
problem (B.3.5) for each time step during the simulation time. Thus, we need a robust and

100



fast solver to tackle this issue. To this end, we use the multiscale recursive conjugate gradient
method, introduced by K. Lackner and R. Menikoff in [115]; see also [38, 30, 79] and references
therein. It combines both a multigrid method and the precondioned conjugate gradient method
in order to capture the distinct wavelengths associated with the different wavelengths from the
associated self-adjoint Poisson operator, strongly influenced by the heterogeneity of the porous
media, in particular to the absolute permeability tensor. This method uses the following multigrid
multiscale preconditioner [115]:

M?1 = (P?1Q)?(?A?1? ?)(QP
?1)? + P?1

2??1??
?=0

(P?1Q)? , (B.3.8)

where A?1? is inverse of the coarsened operator A?. The coarse operator is obtained by a redis-
cretization of the Eq.(B.2.1) on a coarser grid. The Eq.(B.3.8) is a special case of a multigrid
scheme, with only two levels [115]. In our method, the evaluation of A?1? on a vector is computed
by applying the same algorithm to the coarse grained operator A?. This continue on the next
coarse levels, until we can solve the problem exactly on the coarsest level [115]. An important
feature of this preconditioner is that long and short wavelengths are coupled at each level by a
conjugate gradient solver before proceeding to the next level, preventing truncation errors from
the coarsening of the operator at each level from accumulating [115]. In particular, if A? does
poorly on a few modes, which typically occurs when the coefficients of the underlying PDE are
discontinuous, then these modes will be corrected by the conjugate gradient solver with only a
small penalty [115].

The matrices P and Q are obtained by the decomposition A = P ? Q, where P = P?.
It represents the smoother: a relaxation method that smooths the short wavelengths. Here we
chose the Red-Black symmetric Gauss-Seidel (RB-SGS). The parameter ? on Eq.(B.3.8) is fixed,
defined as the number of iterations of the smoother. In this work we use ? = 3?/2, where ? is
the discretization scale on the finest level. The value of ? was defined based on both, on the work
of K. Lackner and R. Menikoff [115] and based on our own numerical experiments.

On the other hand, the matrices ? and ? are the prolongation and restriction operators [115,
38, 30, 79], responsible for the transference of vectors from coarser grids to finer grids and from
finer to coarser grids, respectively. The prolongation operator is defined as the tensor product
of cell-centered linear interpolations, and the restriction operator is taken as the adjoint of the
prolongation operator. The coarse grained permeability tensor necessary to construct A? is based
on the transmissivitie defined in [115], as ??? = ???? ??? in the ?-direction, where ?? and ?? are
the width and height of a grid cell. The ? ??? component is taken as,

1
? ???

=
??

?

1??
? ???(?, ?)

,

where the sum is over fine cells contained within a coarse cell, and ? and ? are the indices corres-
ponding to the ?- and ?-directions, respectively. ? ??? is constructed in the same way, but with the
sums over ? and ? interchanged.

101



B.3.3 A combined domain decomposition with mixed fiment method
formulation for diffusion

The numerical solution of the diffusive transport system (B.1.3), can also be obtained by
applying a mixed hybrid finite element method for the spatial discretization combined with a
implicit backward Euler strategy. Here we will describe the key features of the implementation.
Indeed, some variations of this approach were discussion in [70, 7, 2, 87], but here we have a
novelty related fo the discontinuous fractional flow function induced by the modelling hysteresis
in the flow.

First, we redefine Eq.(B.1.3) by setting w? = ?(??, x, ?)???, where the term ?(??, x, ?) =
?? (x) [?? (??) (1 ? ??)] ?????? . Then, the diffusive-stage equation is given on the ?

??-element by,

??
??+1?,? ? ??,?

???
?

1
?

[?
??+1?? + ?

?+1
??

+ ??+1?? + ?
?+1
??

]?
= 0, (B.3.9)

(1 + ??? ???) ??+1?? + ??? ?
?+1
?,? = ??? ??? ????? + ??? ????? , (B.3.10)

where ??? ,???? = 2???(???, ?)/?, ???(???, ?) ? ?? eff ?,?? as will described bellow. The superscript?? and the subscript ?? denote variables on adjacent elements and, for simplicity of notation, the
time index ? + 1 is suppressed on ??? and on the right-hand side of Eq.(B.3.10). If the capillary
pressure function ??(??) on the diffusive term w? is independent of ?, similar consistency relations
used in the pressure-velocity discretization lead to the relations:

?? = ???? , ?? + ????? = 0, ? = ?, ?, ?, ?. (B.3.11)

Moreover, ?? ? ? ?? , and w ? ? ?? are allowed to be discontinuous across each ??? [12]. As a
consequence, it is needed to define an interface transmission condition to the diffusive fluxe w?.
Thus, it follows from bellow equations,

?? =
2
?

???(??, ?, ?)(?? ? ???), ????? =
2
?

???? (??, ???, ???)(?? ? ? ????? ),

that
?

? eff ?,?? =
2 ??? ????
??? + ????

, ? = ?, ?, ?, ?. (B.3.12)

Because the domain decomposition into individuals elements ?? of the finite element method
localizes the computations it is then natural as well as advantageous to let them be difined on each
interface in terms of local properties of the medium (?(x), ?(x)), saturation ?? and hysteresis
parameter ?. A dimension analysis of the diffusive Robin transmission condition at the interfaces
of each element leads to the choice:

??? =
?

?
? eff ?,??

. (B.3.13)

Finally, we also use an ordinary checkboard ordening – as used in [2, 7, 70] – to separate the
subdomains into “red” and “black” subsets in order the achieve a faster convergence.

102



B.4 Two-dimensional numerical experiments
Our main concern is to justify the new numerical approach. To this end, we consider the

classical slab and 1/4 of five-spot geometries as test cases. For the experiments we also consider a
slab geometry with barriers. The algorithm was implemented in pure C language programing and
all its experiments were made in a basic laptop with a intel processor i3 2.53 GHz and 4 MB of
RAM.

For the numerical experiments presented in this work we consider scalar, log-normal permeabi-
lity fields ?(x) as a model for multiscale rock heterogeneity, so that ?(x) = log ?(x) is Gaussian
and its distribution is determined by its mean and covariance function, where the absolute perme-
ability is given by ?(x) = ?0???(x), and ?0 is a constant, and 0 &amp;lt;? ? 1 is a scaling factor [96,
2].

B.4.1 Numerical experiments with hysteresis and slab geometry
We are setting up to calculate the complete two-phase flow problem with hysteresis, as described

in Section B.2, along with,

??(??) = ?2?, ?
?
? (??) = (1 ? ??)

3 and ??? (??) = (1 ? ??)
2. (B.4.1)

Each scanning permeability curve is a straight line in the (??, ?)-plane through the point (1/?, 0),
and is given by [27],

???? (??, ?) =
(1 ? ?)2

(1 ? ? ?)
(1 ? ???) . (B.4.2)

Following [27], we take ? = 0.5 and ? = 0.00015 in the numerical experiments. The water fractional
flow function ? (??, ?) is expressed by (B.4.1)-(B.4.2),

? (??, ?) =
?? (??) /??

?? (??) /?? + ???? (??, ?) /??
, (B.4.3)

and the capillary pressure function is given by ?? = 5? ? (2 ? ??) (1 ? ??), where ? ? is a characte-
ristic pressure which we take to be 1.18215×105 Pa, so that the corresponding dimensionless value
1/Peclet, is of order 10?3 for two-phase flow. We take ?? = 1.0 cP and ?? = 0.5 cP. The initial
condition corresponds to the Riemann problem with initial discontinuity at ? = 0.3 × ? ? [0, ? ]
separating the states (??? , ??) = (0.7, 0.8) and (??? , ??) = (0.3, 0.4), which both lie inside the
scanning region. The two-dimensional simulation results for the SHMR with the maximally split
version of the operator splitting algorithm (see Section B.2) are in a very good accordance with the
one-dimensional solutions [12] and are shown in the bottom frames in Figure B.1. Notice the 1D
wave structure of lateral projections obtained from 2D numerical simulations agree very well with
preliminary 1D analytical solutions (solid lines) [27, 12]. For the two-dimensional experiments, in
Figure B.1) we have used the following CFL condition [12]:

???&amp;lt;
1

2?

[?
max

?? ?[0,1]

{?
? ?(??, ?) ??

??
,

? ?(??, ?) ??
??

}?]??1
, (B.4.4)

103



where the variables ?? and ?? (i.e., v = (??, ??)) are related to the two-dimensional pressure-
velocity problem (B.2.1) presented in Section B.2; we remark that the subscripts ? and ? do not
denote derivatives.

We use the same multiscale field ?(x) to construct a variable porosity field ?(x) ?(x) = ? +
??(x), ? &gt; 0, where ? = 0.2 and the normalizing factor ? is chosen so that 0.05 ? ?(x) ? 0.35.
Then, we have both synthetic models of permeability and porosity that resemble to the same
geological properties [7, 2] of the porous medium for our numerical experiments.

0 0,1 0,2 0,3 0,4 0,5 0,6 0,7 0,8 0,9 1

POSITION   ( FIXED TIME )

0

0,1

0,2

0,3

0,4

0,5

0,6

0,7

0,8

W
A

T
E

R
 S

A
T

U
R

A
T

IO
N

    1 m
  32 m
  64 m
  96 m
128 m
 1D

0,56

0,0

0,7

0,773

Figura B.1: Water saturation pictures are shown as function of distance in a grid refinement study
256 × 128 (top) and 1024 × 512 cells, for a horizontal two-dimensional reservoir with aspect
ratio ?/? = 4. Bottom frame show ??direction longitudinal sections for water saturartion with
hysteresis. Note that the interplay between nonlinearity and heterogeneity from porosity and
permeability seems not to modify the wave pattern (or wave sequence) in comparison with case of
one-dimensional space. Similar results were observed for the oil saturation since ?? + ?? = 1.

104



 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y-
d

ir
e

ct
io

n

x-direction

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y-
d

ir
e

ct
io

n

x-direction

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y-
d

ir
e

ct
io

n

x-direction

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y-
d

ir
e

ct
io

n

x-direction

 0

 0.125

 0.25

 0.375

 0.5

 0.625

 0.75

 0.875

 1

 0  0.125  0.25  0.375  0.5  0.625  0.75  0.875  1

y

x

Figura B.2: On the left (resp. right) column is shown the pressure (resp. velocity) field for several
geometries. We take ? = 2 for heterogeneous reservoir simulation problems.

105



B.4.2 Purelly Poisson pressure-velocity numerical experiments

Here we are interesting to the application of the multigrid multiscale preconditioner method
discussed in Section B.3.2 for the discretized purely Poisson-elliptic problem (B.2.1). For simplicity
we take ?? = 0 and ? = 1 to the Poisson pressure-velocity equation (B.2.1) as discussed in
[115], which in turn we consider two-dimensional flows in a rectangular domain [0, ?] × [0, ? ],
heterogeneous horizontal reservoir with no gravity effects fo the flow. Simulations were performed
for both homogeneous and heterogeneous reservoirs; see pictures in Figure B.2. The spatially
variable permeability field is defined on a 1024 × 1024 grid with the value of the coefficient of
variation ?? = 2. We use 5 grid levels for the multiscale algorithm and a scale factor of 4 between
coarsenings. We set the root mean squared residual as the criterion for convergence of the PCG
and set the tolerance as 10?07.

Five-spot geometry

We first simulate the pressure-velocity problem on a 1/4 of five-spot; see first (homogeneuous)
and third (heterogeneous) rows in Figure B.2. Assume the reservoir to have dimensions 1024m
× 1024m, and blocks with size of 1m × 1m. A fluid is injected into the reservoir at the lower
left corner at a uniform rate of 10?07 and production takes place at the top right corner fluid
at rate ?10?7; no flow is allowed along all the boundaries of the reservoir. We set ? = 2 and
?0 = 1 for heterogeneous reservoirs (third row in Figure B.2) and ? = 0 and ?0 = 10?06 for the
homogeneous case (first row in Figure B.2). The pressure (left column) and velocity fields (right
column) are presented in Figure B.2. In addition, we can see in Table B.1 and Table B.2 that
it was necessary only 1 iteration of the conjugate gradient method in the finest level. The root
mean squared residual norm was reduced to less then 10?10. All three experiments took about 10
minutes to converge.

Slab geometry

For the slab geometry, the boundary condition the Poison pressure-velocity like-problem (B.2.1)
are as follows: no flow is allowed along the boundaries at the top and bottom of the reservoir;
a reference pressure ? = 0 (at the infinity [70] to better account to viscous fingering effects) is
specified along the boundary on the right. We set a flow of value ? = 1 at the left boundary
for the homogeneous (second row of Figure B.2) and heterogeneous (fourth row of Figure B.2)
reservoir. The parameters used for the reservoir are the same as the 1/4 of 5-spot experiments.
On the bottom of Figure B.2 is displayed the slab simulations along with barriers. Notice that
we were able capture with good accuracy the main pattern of the flow through the barriers with
low permeability values of 10?06 and 10+06 otherwise. Again, the Figure B.2 shows the pressure
(left column) and velocity fields (right column). It was necessary 3 iterations on the finest level
for the convergence of the homogeneous case with computational time around 10 minutes. In the
heterogeneous slab problem and the slab problem with barriers took 9 and 8 iterations, respectively,
and about 50 minutes to reach convergence in each test problem. The root mean squared residual
was reduced to 10?08 in all cases. See also Table B.1 and Table B.2.

106



Quarter of five-spot problem:
Level Dim. ? = 0 ? = 2

1 4 × 4 16 16
2 16 × 16 8 8
3 64 × 64 4 4
4 256 × 256 2 2
5 1024 × 1024 1 1

Slab problem:
Level Dim. ? = 0 ? = 2 barr.

1 4 × 4 38 134 192
2 16 × 16 19 67 96
3 64 × 64 10 36 53
4 256 × 256 5 21 34
5 1024 × 1024 3 9 8

Tabela B.1: The top table shows the accumulated iterations of the multiscale algorithm for the 1/4
of five-spot with homogeneous permeability and heterogeneous permeability field, with ? = 2. The
bottom table shows the accumulated iterations of the multiscale algorithm for the slab problem with
homogeneous permeability, along with ? = 2 for the heterogeneous permeability field.

5-spot: ?r?2 ?r?? ?r?2/
?

??
? = 0 3.0882e-10 2.1823e-10 9.5369e-13
? = 2 1.5481e-08 1.0773e-08 4.7808e-11

Slab: ?r?2 ?r?? ?r?2/
?

??
? = 0 7.8315e-07 2.2862e-08 2.4185e-09
? = 2 1.4170e-05 2.7802e-06 4.3758e-08
barr. 7.1256e-06 1.1176e-07 2.2005e-08

Tabela B.2: The top table shows the residual norms for the 1/4 of five-spot problems; we take
? = 2 for the heterogeneous simulation problem. The bottom table shows the residual norms. ??
is the number of elements.

B.5 Concluding remarks
In this paper we discussed a computational method for modeling hysteresis in porous media

flow via relaxation by means of an operator splitting numerical strategy. For concreteness we
considered a hysteresis incompressible two-phase flow relaxation system in porous media, a rele-
vant problem very common in waterflooding of reservoirs. To address this problem we describe a
numerical method based on an operator splitting technique for the numerical solution of the gover-
ning system of PDEs modeling two-phase, immiscible two-phase flow problems in two-dimensional
heterogeneous porous media with hysteresis. A combined mixed discretization of locally conserva-
tive finite volume and mixed finite techniques was applied to tackle the Poisson problem (B.2.1).
In particular, both the multiscale multigrid method with a conjugate gradient method (to solve
the Poisson problem) as well as the red-black iterative domain decomposition method with mixed
finite element (to solve the diffusion problem) were able to give very good numerical solutions
for distinct transport problems in fluid dynamics in homegeneuous and heterogeneous two-space
dimensions in order demonstrate the viability of the proposed formulation. Modelling hysteresis
in porous media flow is relevant for instance in the numerical simulation framework for modeling
CO2 sequestration operations in large-scale heterogeneous formations, such as deep saline aquifers
and depleted oil and gas reservoirs.

107



108


	Agradecimentos
	Introdução
	Motivação da pesquisa
	Objetivos específicos e proposta de trabalho
	Temas desenvolvidos e resultados obtidos
	Organização da dissertação

	Modelagem matemática de fluxos multifásicos em meios porosos heterogêneos
	Equações fundamentais de escoamento com duas e três fases
	Modelo de escoamento de três fases com gravidade
	Modelo de escoamento de duas fases com gravidade
	Modelo de escoamento de duas fases com gravidade e histerese

	O modelo do traçador passivo e da pressão global
	Traçador passivo
	A formulação da pressão global


	Modelagem computacional das equações governantes em fenômenos de transporte em meios porosos heterogêneos
	Decomposição de operadores

	Aproximação numérica das equações diferenciais parciais governantes
	Discretização do sistema parabólico e hiperbólico de EDPs associado ao problema de transporte de convecção-difusão
	Discretização por elementos finitos mistos da EDP elíptica associada ao problema de pressão e velocidade
	Elementos Finitos Mistos Híbridos
	Equações discretas e eliminação do multiplicadores de Lagrange e fluxos.


	Resolução do sistema linear associado ao problema elíptico
	Gradientes Conjugados
	Precondicionadores

	O Método Multigrid
	Métodos de relaxação e a propriedade de smoothing
	A estrutura do Método Multigrid
	O Multigrid como Pré-condicionador
	Outra maneira de derivar o pré-condicionador multigrid

	Gradientes conjugados com pré-condicionador multiescala recursivo
	Implementação do método dos gradientes conjugados com pré-condicionador multiescala recursivo
	Aproximação da permeabilidade na malha
	Smoother
	Operadores de Restrição e Prolongação
	Critério de Parada


	Experimentos numéricos para problemas elípticos de Poisson em geometrias de aplicações
	Pressão-fluxo slab Dirichlet-Dirichlet
	Fluxo slab Neumann-Dirichlet
	Geometria 1/4 de five-spot

	Conclusões e Perspectivas
	Conclusões
	Perspectivas
	Considerações finais

	Referências
	Eliminação dos multiplicadores de Lagrange
	A computational multiscale approach for incompressible two-phase flow in heterogeneous porous media including relative permeability hysteresis
	Introduction
	Computational Modeling with Hysteresis
	Continuous-time mixed finite element approximations to the Ellipitc and Parabolic problems
	Discretization of the Poisson-elliptic problem
	A multigrid multiscale preconditioner method for the discretized coupled nonlinear Poisson-elliptic problem
	A combined domain decomposition with mixed fiment method formulation for diffusion

	Two-dimensional numerical experiments
	Numerical experiments with hysteresis and slab geometry
	Purelly Poisson pressure-velocity numerical experiments

	Concluding remarks


</field>
	</doc>
</add>