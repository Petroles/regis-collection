<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06616</field>
		<field name="filename">11164_Nogueira_ReinaldoGoncalves_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Universidade Estadual de Campinas
Faculdade de Engenharia Elétrica
Departamento de Sistemas e Controle de Energia
Controle de Posição e Orientação de um Manipulador através de um Mouse Espacial
	Autor: Reinaldo Gonçalves Nogueira
Orientador:	Prof. Dr. Álvaro Geraldo Badan Palhares
Dissertação submetida à Faculdade de Engenharia Elétrica da Universidade Estadual de Campinas, para preenchimento dos pré-requisitos parciais para obtenção do Título de Mestre em Engenharia Elétrica .
3 de março de 1995
M *	J
■C£ WfW.L, Jj
UrMICAMP	Universidade Estadual de Campinas Faculdade de Engenharia Elétrica Departamento de Sistemas e Controle de Energia
Tese	: Controle de Posição e Orientação de um Manipulador através de um Mouse Espacial
Autor	: Reinaldo Gonçalves Nogueira
Orientador	: Álvaro Geraldo Badan Palhares
Aprovada em 3 de março de 1995 pela banca examinadora
Prof. Dr. Álvaro Geraldo Badan Palhares (Presidente)
Prof. Dr. Edson Moschim - UNICAMP
Dr. Cesar de Souza Lima - PETROBRAS/CENPES
/los meus pais Jair e Anna Maria, meus irmãos Eduardo, Cristina e Andrea, meu sobrinho Luis Henrique e minha esposa Maria Assima.
Resumo
Sistemas robot izados tem sido cada vez mais utilizados nas indústrias, principalmente em se tratando de tarefas em que a operação humana torna-se perigosa. A Petrobras é urna empresa que vem utilizando esta tecnologia e, para tal, possui em seu Centro de Pesquisas e Desenvolvimento um manipulador que é utilizado para desenvolvimentos onde geralmente atua como um robo tele operado visando a realização de tarefas submarinas em águas intermediarias e profundas.
O robó tele-operado é um sistema Master-Slave, onde o Master, que é um manipulador em escala reduzida, tem a função de enviar sinais de comando ao Slave, quando manipulado por um operador na sala de controle localizada na superficie. 0 sistema, entretanto, possui o inconveniente de necessitar de uma perfeita sincronização entre os ángulos das juntas do Master e do Slave no inicio de cada operação, o que demanda um certo tempo.
Este trabalho teve como objetivo desenvolver urna nova opção de controle para o manipulador, com a utilização de um Mouse Espacial em substituição ao Master, o que permitiu mini-mizar os tempos de inicialização de tarefas, visto não serem mais necessárias as correspondências angulares .
O sistema foi implementado em um microcomputador compatível com a linha IBM-PC-AT de forma modular, possibilitando alterações, como a substituição do manipulador ou do Mouse Espacial.
Abstract
Robotic systems have been more and more used in industries, mainly in tasks where human operations became dangerous. Petrobras, the Brazilian state owned petroleum industry, has been using this tecnology and, for that, has a manipulator in its Research &amp;amp; Development Center which is used like a tele-operated robot to perform underwater tasks in medium and deep seawaters.
A tele-operated robot is a Master-Slave system, where the Master, a manipulator in reduced scale, has the function of sending the command signals to the Slave, when manipulated by an operator in the control room on the surface. The system, however, has the necessity of a perfect synchronization between Master’s and Slave’s joint angles at the beginning of each op eration as a great inconvenient, and this operation demands a certain time.
This work has the objective to develop a new control option to the manipulator, using a Spatial Mouse instead of the Master, which allows to minimize the initiation times of tasks, since no more angular correspondence is necessary.
The system was implemented in a microcomputer compatible with the IBM-PC-AT line in a modular form, making possible alterations such as the manipulator or the Spatial Mouse replacements .
Agradecimentos
—	Ao professor Álvaro Geraldo Badan Palhares, pela orientação e incentivo em todas as etapas do trabalho.
—	Ao professor João Maurício Rosário, pela colaboração paciente e elucidativa e pela estrutura cedida para o desenvolvimento deste trabalho.
—	Ao CNPq, pelo apoio financeiro durante a maior parte do trabalho.
—	À PETROBRAS, pelos equipamentos utilizados e pelo apoio financeiro na etapa final do trabalho.
—	Aos amigos da FEE, por proporcionarem inúmeros e indispensáveis momentos de descontração.
- A todos que, direta ou indiretamente, contribuíram para a conclusão deste trabalho.
Conteúdo
RESUMO	i
ABSTRACT	ii
AGRADECIMENTOS	iii
CONTEÚDO	iv
LISTA DE FIGURAS	vii
LISTA DE TABELAS	ix
1	- Introdução	1
1.1	Introdução...........................................................     1
2	- Análise de Deslocamento de Manipuladores Robóticos Industriais	6
2.1	Introdução...........................................................     6
2.2	Trigonometria Esférica.................................................   7
2.2.1	Definições...........................................    ,	7
2.2.2	Triângulos	Esféricos..............................................  7
2.2.3	As Leis do Seno, Seno-cosseno e Cosseno para Triângulos Esféricos.  9
2.2.4	As Leis do Seno, Seno-cosseno e Cosseno para Triângulos Polares... 13
2.2.5	Algumas Propriedades dos Triângulos Esféricos e Polares .......... 13
2.2.6	Equações para o Quadrilátero Esférico . .......................... 15
2.2.7	Equações	para o Polígono Esférico de n Lados........................ 17
2.2.8	Equações	Subsidiárias do Polígono Esférico de	n	Lados .............. 18
2.2.9	Equações para o Quadrilátero Polar................................... 19
2.2.10	Equações	para o Polígono Polar de n Lados........................... 20
2.2.11	Equações	Subsidiárias do Polígono Polar de n	Lados ..................21
2.3	Polígonos Espaciais  ......................................................  23
2.3.1	Equação de Malha Fechada para Polígonos Espaciais Ortogonais..........23
2.3.2	Cadeia Espacial Ortogonal Aberta..................................... 25
2.3.3	Equações Secundárias para Polígonos Espaciais ......................  20
2.3.4	Triângulo Espacial: Equações Secundárias do Cosseno.................. 28
2.3.5	Quadrilátero Espacial: Equações Secundárias do Cosseno............... 28
2.3.6	Pentágono Espacial: Equações Secundárias do Cosseno ................. 29
2.3.7	Hexágono Espacial: Equações Secundárias do Cosseno..................  30
2.3.8	Heptágono Espacial: Equações Secundárias do Cosseno ................  30
2.4	Manipuladores Robóticos .................................................... 32
2.4.1	Fechamento do Mecanismo Espacial : Solução Inversa................... 34
2.4.2	Posicionamento da Garra: Solução do Problema Cinemático Direto ...... 37
3	-	Modelagem	38
3.1	Introdução ...............................................................   38
3.2	Problema Cinemático Inverso . ...........................................,	. 39
3.2.1	Análise	do	Mecanismo Espacial RRRR-R-RR.............................. 45
3.2.2	Equação de Entrada-SaTda (Í7XÍ1). . ............................      45
3.3	Problema Cinemático Direto ................................................  51
4	-	Interface Homem-Máquina	53
4.1	Master Slave .............................................................   55
4.1.1	Calibração .........................................................  55
4.1.2	Monitoramento........................................................ 55
4.2	Micro Computador....................................................... 57
4.2.1	Controle .........................................................57
4.2.2	Animação.....................................................    .	61
4.2.3	Parâmetros....................................................... 61
4.3	Teste de Hardware...................................................    61
5	- Resultados e Conclusões	63
5.1	Testes e Resultados.................................................... 63
5.1.1	Controle Via Master...........................................    63
5.1.2	Controle Via Teclado...........................................   63
5.1.3	Controle no Modo Automático....................................   64
5.1.4	Controle Via Mouse Espacial.....................................  64
5.2	Conclusões ...........................................................  65
5.3	Sugestões para Trabalhos Futuros....................................... 65
BIBLIOGRAFIA	67
APÊNDICE	68
A	- Características Técnicas do Manipulador Kraft	68
A.l Especificações Gerais..................................................  68
A.2 Efetuador..............................................................  68
A.3 Movimento das Juntas ....................................................  69
B - Listagem dos Modelos Implementados
70
Lista de Figuras
1.1	Manipulador Kraft............................................................ 2
1.2	Dispositivo de Controle Master............................................... 3
1.3	Esquema do Mouse Espacial.................................................... 4
2.1	Eixo Polar e Pólos...................................................... 7
2.2	Triângulos Esférico e Polar ................................................. 8
2.3	Triângulos Anti-Polares...................................................... 9
2.4	Triângulo Esférico.......................................................... 10
2.5	Obtenção do Sistema XYZ a partir do Sistema	xyz............................. 11
2.6	Triângulo Polar...........................................................   14
2.7	Quadrilátero Esférico.................................................       16
2.8	Polígono Esférico de n Lados................................................ 17
2.9	Quadrilátero Esférico: Equações Fundamentais	e	Subsidiárias................. 19
2.10	Quadrilátero Polar ......................................................   20
2.11	Polígono Polar de n Lados................................................... 21
2.12	Quadrilátero Polar: Equações Fundamentais	e Subsidiárias ...................23
2.13	Polígono Espacial Ortogonal com n Lados.....................................24
2.14	Cadeia Espacial Ortogonal Aberta .........................................  25
2.15	Triângulo Espacial ......................................................   26
2.16	Manipulador Genérico . ..................................................   33
3.2	Parâmetros para a Representação Geométrica Genérica de um Manipulador ..... 41
3.3	Representação Geométrica do Manipulador Kraft..............................  42
3.4	Pentágonos Esférico e Polar  .............................................   46
4.1	Configuração Inicial do Sistema............................................. 53
4.2	Primeiro Menu do Programa...............................................     54
4.3	Diagrama de Blocos do Programa.............................................  54
4.4	Tela Inicial do Modo Master Slave.........................................   55
4.5	Tela de Calibração...........................................................56
4.6	Tela de Monitoramento......................................................  56
4.7	Tela Inicial do Controle Via Microcomputador. .............................. 58
4.8	Tela de Controle Via Mouse Espacial. . ....................................  59
4.9	Tela de Controle Via Teclado................................................ 60
4.10	Tela do Movimento Direto.....................................................61
4.11	Tela de Animação Via Teclado..............................................   62
A.l Movimentos das Juntas do Manipulador Kraft.................................   69
Lista de Tabelas
3.1	Simplificações Inerentes ao Manipulador Kraft
43
Capítulo 1
Introdução
1.1	Introdução
A Automação Industrial é um assunto que tem despertado grande interesse em inúmeros profissionais envolvidos com a indústria brasileira, por exemplo, engenheiros, empresários e cientistas. Isto está ocorrendo devido à necessidade incontestável de modernização de massas industriais, visando um aumento significativo da produtividade e da qualidade. A automação já está sendo introduzida nas indústrias aqui no Brasil e não há dúvidas que sua utilização crescerá exponencialmente nos anos vindouros. Dentro deste contexto, a Robótica tem um papel fundamental devido à sua alta aplicabilidade na automação de indústrias manufaturei ras.
A robotização de ambientes de difícil acesso, como o fundo do mar. e em tarefas hostis ao homem, como operações repetitivas, em ambientes poluídos ou com riscos de acidentes, tem sido cada vez mais objeto de interesse e pesquisa em todo o mundo e, no Brasil, a Petrobras tem sido a pioneira na utilização de sistemas robóticos em águas submarinas profundas.
Automatizar tarefas submarinas significa criar um sistema dedicado, remotamente controlado e capaz de realizar determinadas operações , como manobreis ou reparos em equipamentos ou instalações. Por se tratarem de tarefas nem sempre repetitivas e realizadas em ambientes remotos, perigosos ou mesmo inacessíveis ao homem, surge a necessidade de utilização de robôs ou manipuladores submarinos tele-operados.
0 manipulador Kraft, mostrado na figura 1.1 e cujas características técnicas [2] podem ser vistas no apêndice A, é projetado para executar tarefas gerais em ambiente submarino ou em outros ambientes hostis. Este sistema robótico é classificado como tele-operad o, dado que seus movimentos são comandados à distância por um dispositivo de controle denominado ”mas-ter” e localizado na base de controle, que envia sinais de movimentos a serem reproduzidos pelo manipulador e cujas trajetórias podem ser definidas em parte pela ação do operador, em parte por programações pré definidas na tarefas padrões de localização e fixação do manipulador ao seu ambiente de trabalho. 0 sistema completo robô tele-operado é denominado Sistema Robótico
Master-Slave.
Figura 1.1: Manipulador Kraft.
No Sistema Kraft, o dispositivo de controle utilizado é um ’’minimaster” ou simplesmente ’’master” mostrado na figura 1.2, que é um modelo em escala reduzida do manipulador Kraft. Este modo de controle possui algumas vantagens, como o fato de trabalhar diretamente com os ângulos de juntas, ou seja, os ângulos lidos no ’’master” são enviados para o manipulador (’’slave”). Mas uma grande dificuldade deste sistema é a inicialização: ’’master” e ’’slave” devem estar sincronizados, ou seja, devem possuir os mesmos ângulos de juntas no início de cada operação e esta sincronização demanda um certo tempo, o que pode ser indesejável quando a rapidez for um dos requisitos da tarefa executada.
Figura 1.2: Dispositivo de Controle Mas ter.
Com a preocupação de minimizar esta dificuldade, principalmente pelo fato de que as tarefas que exigem rapidez tem apresentado uma demanda cada vez maior, estamos propondo neste trabalho um método alternativo que viabilize o sistema sem que os problemas de inicialização prejudiquem o desempenho desejado, no que diz respeito ao tempo de resposta do sistema aos comandos do master.
Um sitema desenvolvido pelo CENPES - Centro de Pesquisas e Desenvolvimento da Petrobras, denominado Mouse Espacial, é mostrado esquematicamente na figura 1.3. É um sistema que gera sinais de deslocamentos em coordenadas cartesianas no espaço tridimensional, que são enviados a um microcomputador, a fim de controlar a posição e orientação do manipulador. A denominação Mouse Espacial é feita por analogia aos mouses bidimensionais tradicionalmente utilizados em microcomputadores. O sistema é composto, basicamente, de manipulo, fios, molas e potenciómetros, cujos valores de tensão chegam ao microcomputador através de uma porta serial. Estes valores, devidamente tratados, são transformados em posição e orientação do manipulo em relação a um sistema de coordenadas X}.\Yp, Zp, mostrado na mesma figura.
Figura 1.3: Esquema do Mouse Espacial.
O objetivo deste trabalho é contribuir para a viabilização de um sistema ’’inaster-slave” mais eficiente e amigável de inicialização instantânea, ou melhor, bem mais rápida que a atual, substituindo o mini manipulador ’’master” pelo Mouse Espacial acima descrito. Para isto, desenvolveremos uma interface de comunicação entre o Mouse Espacial e o manipulador Kraft, juntamente com um ’’software’1 de operação que permita ao usuário acessar facilmente todas as formas de comando do sistema. Este ’’software” é constituído de telas gráficas com menus oferecendo opções para cada tipo de tarefa a ser executada. Constam atualmente nos menus algumas das tarefas típicas solicitadas e utilizadas pela Petrobras, mas existe a possibilidade de ampliar o conjunto de funções, na medida em que surjam novas demandas de tarefas.
Para o desenvolvimento deste trabalho procuramos organizar um texto que contenha um estudo preliminar dos Fundamentos Matemáticos das relações geométricas e cinemáticas dos manipuladores quanto à sua orientação, posicionamento e velovidade de resposta, a fim de que o usuário possa compreender melhor como utilizar o sistema e eventualmente desenvolver novas funções para ampliar o menu principal. Este estudo está apresentado no capítulo 2 - Análise de Deslocamentos de Manipuladores Robóticos Industriais, onde são desenvolvidas expressões para as leis do seno, seno-cosseno e cosseno de polígonos esféricos e polares, as quais são também aplicáveis aos manipuladores robóticos, e no capítulo 3 ~ Modelagem, onde é feita a adaptação das equações encontradas no capítulo 2 para o caso do manipulador Kraft.
Após este estudo preliminar, apresentamos o desenvolvimento da interface proposta, descrita com detalhes no capítulo 4 - Interface Homem-Máquina e, finalmente, os resultados obtidos e conclusões, no capítulo 5,
Capítulo 2
Análise de Deslocamento de Manipuladores Robóticos Industriáis
2.1	Introdução
Os robôs industriais são equipamentos multifuncionais reprogramáveis e oferecem grande flexibilidade de operação. A programação destes robôs atualmente é feita, na maioria das vezes, através de uma ’’caixa de ensino”, que é usada de modo a conduzir o robô através das posições críticas do ciclo de operação. As informações sobre essas posições são armazenadas numa unidade de memória, possibilitando assim a repetição do movimento original quantas vezes for necessário.
A programação por caixa de ensino tem duas grandes limitações: ela utiliza o robô no período da programação - muitas vezes longos - quando ele poderia estar produzindo; e não permite um controle mais preciso sobre a trajetória da garra ou ferramenta de trabalho do manipulador robótico.
A programação ”off-line”, por sua vez, não apresenta as duas limitações anteriores por ser realizada em um computador digital, utilizando-se apenas um modelo matemático. A tendência é de que esse tipo de programação seja cada vez mais utilizado e, em se tratando de um robô ’’inteligente” (ou ’’sensorial”), a programação ”off-line” torna-se obrigatória.
0 modelo matemático contém informações sobre a geometria do sistema. Por isso, ele é chamado de modelo cinemático. Se as velocidades e acelerações envolvidas no movimento do robô forem suficientemente altas, caracterizando uma classe de robôs denominados robôs de alto desempenho, a utilização de um modelo dinâmico também se faz necessária para que se tenha uma operação mais precisa e estável.
Apresenta-se, a seguir, uma metodologia para se chegar ao modelo cinemático de qualquer manipulador robótico industrial. Para se obter tal modelo, a malha aberta formada pelos elos e juntas do manipulador é fechada acrescentando-se a ele mais uma junta e mais um elo imaginários, resultando em um mecanismo espacial que passa a servir de base para a derivação do modelo
cinemático desejado. Esta metodologia, apresentada neste capítulo e no seguinte, é baseada no trabalho de Duffy [4],
2.2	Trigonometria Esférica
2.2.1	Definições
—	Plano central - plano que passa pelo centro de uma esfera;
—	Grande-círculo - interseção de uma esfera com um plano central;
—	Pequeno-círculo - interseção de uma esfera com um plano que não seja central;
—	Esfera unitária - a que tem raio unitário. Nesta metodologia, a esfera considerada será sempre unitária;
—	Eixo polar - reta orientada passando pelo centro de um pequeno ou grande círculo e perpendicular ao plano deste círculo;
—	Pólos - as duas interseções entre um eixo polar e uma esfera (figura 2.1). Para a metodologia apresentada, o pólo P será sempre o considerado.
Figura 2.1: Eixo Polar e Pólos
2.2.2	Triângulos Esféricos
, #2 e $3 são considerados positivos quando orientados por uma rotação tipo parafuso pela mão direita, em torno e nos sentidos dos versores S4, S_z e S3, respectivamente. Os eixos polares a12, n23 e 03!, perpendiculares aos planos centrais definidos respectivamente por e 52, S_2 e £3, e e Sj, interceptam a esfera nos pólos 1’, 2’ e 3’ e possuem orientações definidas pelo produtos vetoriais entre 5, e formando assim um segundo triângulo, denominado triângulo polar, com lados 02 e #3 e ângulos externos qi2, o23 e 0:31, os quais são considerados positivos quando orientados por uma rotação tipo parafuso pela mão direita, em torno e no sentido dos eixos polares u12, n23 e respectivamente. Qualquer teorema válido para triângulos esféricos valem também para os polares M-
Figura 2.2: Triângulos Esférico e Polar
Os triângulos 123 e 1”2”3” (figura 2.3) cujos vértices são diametralmente opostos são chamados triângulos anti-polares. Todos os elementos dos dois triângulos são iguais mas eles não são congruentes, pois não podem se superpor um ao outro. Diz-se, portanto, que eles são ’’simetricamente iguais” ou ’’inversos”.
É correto concluir-se que dois triângulos numa mesma esfera e com lados menores que tt são congruentes ou inversos quando se souber que três determinados elementos de um dos triângulos são respectivamente iguais aos do outro. Tais elementos podem ser:
—	Dois lados e o ângulo por eles formado;
—	Os três lados;
—	Dois ângulos e o lado a eles comum; ou
— Os três ângulos.
12 = 1"2"
23 = 2T
31 = 3T'
Figura 2.3: Triângulos Anti-Polares
E apropriado notar que o último caso não tem correspondência na geometria plana.
2.2.3	As Leis do Seno, Seno-cosseno e Cosseno para Triângulos Esféricos
Considere um sistema de coordenadas cartesianas XYZ tal que X = a12 e, consequentemente, Z = Sx, visto que u12 é perpendicular ao plano	As coordenadas dos vértices do
triângulo esférico da figura 2.4, neste sistema cartesiano, podem ser descritas em termos dos ângulos Oi e &amp;amp;ij como mostrado.
Suponha que desejamos obter as coordenadas do vértice 3. Teremos, então, as componentes S3x, S3y e S3- do vetor £3, cujo módulo é unitário (o vértice 3 pertence a uma esfera unitária) dadas na seguinte forma:
$3x	—	«31	«1
^3y	•=	«31	Cl	(2.1)
$3z	=	C31
onde ”s” e ”c” representam o seno e o cosseno, respectivamente, do ângulo indicado pelo índice, ou seja, 031 ou Oi, E importante lembrar que o eixo X é perpendicular ao plano definido por e S2.
Figura 2.4: Triângulo Esférico
Obviamente as componentes de S3 também podem ser expressas em função de 012, 02 e a23- (É importante observar que o eixo Y está no plano definido por Sj e S2). P^a isso, posiciona-se um sistema xyz de coordenadas de modo que sua origem coincida com a origem ”0” de XYZ, seu eixo ”z” tenha o mesmo sentido de S3 e o eixo V tenha o mesmo sentido de S2 x S3. As projeções do vetor S3 nesse novo sistema são:
S^x = 0
S^y —	0
Ssz =	1
Aplicando três rotações consecutivas ao sistema xyz pode-se fazê-lo coincidir com XYZ. Consideremos as seguintes rotações utilizando a regra da mão direita, as quais são ilustradas na figura 2.5:
-	I - rotação de -a23 em torno de xz xyz xy'z' (figura 2.5 a b);
-	II - rotação de -#2 em torno de z’: xy‘’z'&gt; —&gt;■ x^y^z' (figura 2.5 b — c);
-	III - rotação de -o12 em torno de x\ x'y”z'	= XYZ (figura 2.5 c - d).

(C)	(d)
Figura 2.5: Obtenção do Sistema XYZ a partir do Sistema xyz
Portanto, as componentes do vetor no sistema XYZ são:
' s3x ’		' 1	0	0		' c2	-^2	0 ‘		" 1	0	0		’ 0 ‘
		0	Cl 2	-512		«2	«2	0		0	«23	“523		0
. &amp;amp;		. 0	¿12	«12 .		. 0	0	1 _		. 0	523	«23		. 1 _
Fazendo-se as multiplicações, obtém-se:
$3z	=	-$2332
$3y	~	-~(&lt;S12C23 + ^12^23^2)
$3z	=	€12c23 ~~ -S12S23C2
(2-2)
Igualando-se a equação 2.1 à 2.2, tem-se:
Yo =»	^23^2 = $31
53y =&gt; "“(312^23 + C12323C2) = 331^1	(2.3)
$3z =&gt;	C12C23 - 312323^2	=	&lt;31
que são as equações do seno, seno-cosseno e cosseno, respectivamente. Essas equações podem ser reescritas da seguinte forma:
X2 = TÇ = z% ~
33131
331 Cl
C31
(2.4)
onde
%2	—	32332
y2	=	— (si2c23 + C12323C2)	(2.5)
Z2	=	C12C23 — 312323^2
Se aplicarmos uma rotação de o12 no sistema XYZ (figura 2.4) em torno do eixo X, então as coordenadas de S3 passam a ser, a partir das equações 2.4:
“ S3x “		' 1	0	0			 t		’ 1	0	0		33131
	—	0	&lt;12	312		r2		0	C12	312		331 Cl
. $3; .		_ 0		&lt;12 .				. 0	— 312	&lt;12 .		.	&lt;31	.
Introduzindo-se as equações 2.5 acima, resulta:
$3x	—	32332	=	331 «i
~^3y	=	323C2	=	— (312C31 + C12S31C1)	(2.6)
$3z	~	&lt;23	~	&lt;12&lt;31 — 312331C1
ou, rearranjando e pondo numa forma semelhante à das equações 2.4, tem-se:
{ §3x} =&gt; Yi —	S23S2
{-^3y} Y1 =	323C2
{	=&gt; Zx =	c23
(2.7)
onde:
X1 =	331^1
Y1 =	—(s12C31 + C12Ó31C1)
Zx =	C12C31 — 312331C1
(2.8)
E fundamental observar que as barras em X2 , ¥2 e Z2 nas equações 2,5 indicam que no percurso do triângulo esférico a partir de S3 em direção ao eixo Z, passando por S2, a ordem dos vértices é decrescente. Em contraposição, Xj , Ei e Z\ nap possuem as barras, pois a ordem dos vértices é crescente no percurso de para Z (S2) que inclui
2.2.4	As Leis do Seno, Seno-cosseno e Cosseno para Triângulos Polares
Na figura 2.6 vê-se o triângulo polar correspondente ao triângulo esférico da figura 2.4. Um sistema UVW de coordenadas é fixado ao triângulo polar de maneira que W h a12 eU = Si. Portanto, tem-se também U = Z, V = -Y e W = X.
Como o posicionamento do sistema UVW é equivalente ao posicionamento de XYZ para as equações 2.7 e 2.8, fica fácil escrever as equações do seno, sen o-cosseno e cosseno para o triângulo polar:
	{«23u} {“«23V} {«23 H'}		C31 V31 W31	=	S2S12 ~ «2^12 = C2	(~ «23Z) (- a23y) (= G23X)	(2-9)
onde:						
U31	—	53531
V31	=	-~(5ic3 + C1S3C31)	(2.10)
W31	=	cjc3 - S1S3C31
É importante notar que os alfas e os tetas foram intercambiados no triângulo polar e que os índices de U, V e W são formados por dois algarismos, tornando-se, assim, desnecessária a utilização de barras, uma vez que a ordem dos vértices já está explícita nos próprios índices. (Os índices procuram indicar a presença dos respectivos tetas na expressão: A'i , Ei e Zj têm ; V31 e W31 têm $3 e #1 ; í/3i foge parcialmente à regra e só contém 03).
2.2.5	Algumas Propriedades dos Triángulos Esféricos e Polares
Para triângulos esféricos com 0&amp;lt;	, ij = 12, 23, 31, são válidas as seguintes
desigualdades:
Figura 2.6: Triângulo Polar
&lt;*12	+	&lt;*23	&gt;	&lt;*31
&lt;*23	+	&lt;*31	&gt;	&lt;*12
«12	+	&lt;*31	&gt;	&lt;*23
(2.11)
Em outras palavras, a soma de dois lados quaisquer é sempre maior que o terceiro se 0&amp;lt;	&amp;lt;7r.
Outra propriedade indica que a soma dos três lados é menor que 2tt, ou seja:
&amp;lt;2?r ;	= 12,23,31
n (2.12)
0 &amp;lt;aij &amp;lt;r	7
Naturalmente essas propriedades se aplicam de forma equivalente aos triângulos polares.
Uma vez que aqui os triângulos são sempre formados em esferas unitárias, tem-se que:
x22 + y2 +	= 1
e, similarmente,
&amp;lt;+ cá + W3\ = 1
De acordo com a notação que está sendo usada, temos:
^2 — C23C12 — ^23'512c2
(2.15)
e, comparando-se as equações 2.15 e 2.5, pode-se concluir que:
Z2 = Z2
(2.16)
A notação utilizada também permite escrever:
W13 = c3ci ~ S3S1 Cu
e, comparando-se as equações 2.17 e 2.10, tem-se que:
2.2.6 Equações para o Quadrilátero Esférico
A figura 2.7 ilustra um quadrilátero esférico subdividido nos triângulos 124 e 234. Para o primeiro triângulo, pode-se escrever, por analogia às equações obtidas para o triângulo esférico (2.3), que:
s42^2'	—	'"11 ■‘il
-(■$12^42 + C12S42C2')	=	^4iCl
C12C42 - S12S42C2'	=	C41
e para o triângulo 234, por analogia ás equações 2.4, temos:
(2.19)
^3	-	542-S2”
5	=	ó42Cr	(2-2°)
z^	~	C42
A partir da figura 2.7, pode-se concluir que x - 0'2 = 0’2 ~ 02. Portanto,
s2&gt; ~
c2&gt; =
(52”c2 — ^2”52);
™(c2”C2 + S2”32)
Substituindo 2.21 em 2.19 e reagrupando os termos, obtém-se:
(342^2” )&lt;^2 “ («42C2”)S2	=
c12 {(^42^2” )$2 + (^42C2’’)C2} ~~ ^12^42	=
312 {(^4232” )ó2 + (C42C2”)C2} + ¿12^42	—
341^1
«41^1
C41
(2.22)
W3I = W13
Substituindo 2.20 em 2.22, tem-se:
Figura 2.7: Quadrilátero Esférico
^3C2 — ^3^2	=
C12(^3^2 + I3C2) ~~ «12^3	=	«41cl
^12(^3^2 + I3C2) + Cj2^3	=	C41
que são as equações do seno, seno-cosseno e cosseno para o quadrilátero esférico, as quais podem ser expressas da seguinte forma:
{^4r}	=&gt;	A32	=	S4161
{S4jJ	=&gt;	I32	=	*541 Cj
í^4z}	^32	=	^41
Como está indicado, essas equações representam as coordenadas do vetor S4 no sistema XYZ. É importante enfatizar que X32, I32 Ê ^32 são apenas uma representação abreviada das expressões do lado esquerdo das equações 2.23.
Convém observar que:
X3 -
&gt;3 =
¿3 =
^34 53
“(^23^34 + C23534C3)
C23C34 — ^23^34^3
e também:
X322 + *£ + Z322 = 1
Z32	==	^23
2.2.7	Equações para o Polígono Esférico de n Lados
Estabelecendo o procedimento da seção anterior para o polígono esférico de n lados da figura 2.8, tem-se as seguinte equação do seno, seno-cosseno e cosseno:
{■Sw}	=&gt;	-^(n-l)(n-2)...2	~	snl^l
=&gt;	F(n—l)(n—2J...2	~	5nl C1
{^nz}	=&gt;•	^(n-l)(n-2)...2	~	cnl
Figura 2.8: Polígono Esférico de n Lados
0 desdobramento do lado esquerdo dessas equações dá-se da seguinte forma:
-^(n-l)(n~2)...2 = ^(n-l)(n-2)...3 c2 ~ P(n-l)(n-2)...3 52
^(n—l)(n—2)...3 “ -^(n—l)(n—2)...4 ^3 ~	l)(n—2)...4 ^3
...etc
P(n-l)(n-2)...2 —	c12(^(n-l)(n-2)...3 $2 + P(n-l)(n-2)...3&amp;lt;-2)	'$12^(n-l)(n-2)...3
P(n-l)(n-2)...3 = c23(-^(n-l)(n-2)...4 53 + P(n-l)(n~2)...4 c3) “ ^23^(n-l)(n-2)...4
..... etc
^(n-l)(n-2)...2 — s12(X(n- 1 )(n-2)...3 5 2 + ^(n-l)(n-2)...3 c2) + c12^(n-l)(n-2)...3 ^(n~l)(n—2J...3 ~ «23(X(„_1j^n_2j 4 s3 + Y(n_i)(n-2)...4 c3) + c23^(n-l)(n-2)...4 ..... etc
e, finalmente:
A"(n—1)	=	^(n—l)n 5(n—1)
'"('s(n”-2)(n—1) c(n—l)n d” c(n—2)(n—1) ^(n—l)n £(n—1)) ^(n~l)	£(n—2)(n—1) ^(n—l)n	^(n—2)(n—1) ^(n—l)n ^(n—1)
2.2.8	Equações Subsidiárias do Polígono Esférico de n Lados
As igualdades 2.25, que são as equações do seno, seno-cosseno e cosseno do polígono esférico de n lados e também chamadas de equações fundamentais, representam as coordenadas do vetor S_n no sistema XYZ com eixo Z no sentido de Sj e eixo X no sentido de a12. Aplicando-se uma rotação de cq2 em torno do eixo X no sistema XYZ obtém-se as equações subsidiárias 1, que representam as coordenadas de Sj no novo sistema de coordenadas. Aplicando-se uma segunda rotação de 02 em torno do eixo Z, obtém-se as equações subsidiárias 2. Uma rotação seguinte de Q'23 em torno de X conduz às equações subsidiárias 3, e assim por diante, até chegar-se ao conjunto de equações subsidiárias (2n — 1). Os quatro primeiros conjuntos de equações subsidiárias são:
— Conjunto 1 (após a rotação de Oj2)		
•tr A (n—l)(n~2)..,2	—		
^(*n-l)(n-2)...2	=	-Kr	(2.26)
^(n-l)(n-2)...3	~	Zi	
— Conjunto 2 (após as rotações de a12 e 02)		
^(n-l)(n-2)...3	=	X12	
Y(n-l)(n—2)...3	=	v*	(2.27)
^(n-l)(n-2)...3	=		
— Conjunto 3 (após a rotações de cq2 , #2 e 023)		
-X(n—l)(n-2)...3	“	x12	
^(n—l)(n—2)...3	™bi2	(2.28)
^(n-l)(n-2)...4	“	Z12	
— Conjunto 4 (após a rotações de oj2 , #2 •&gt; «23 e #3)		
-^(n-l)(n~2)...4	=	-X123	
^(n-l)(n™2)...4	=	V* _yV123	(2.29)
l)(n—2)...4	=	^12	
onde
Xi2 = Xió2 + Y1C2 , e assim por diante.
A figura 2.9 mostra os sete conjuntos de equações subsidiárias e o conjunto de equações fundamentais para o quadrilátero esférico.
	FUNDAMENTAIS		SUBS. 4
	X		z
	XJ!=s.,s,(=X,)		0 — X ia
	j Xj2 =S41CS ( = -XJ		
	7 2 ™	¡Vi	J 2
	Z32=C41		v34 = Zj 12
z			
			X
	SUBS. 1		SUBS. 5
Xj		z	
	~~~&gt;3 X32=Xj	K	^&gt;3	0 ” X 123
[	\	x;2=-y5	b	0 « Y123
	riri/i ~		__ri2
	x z3 =z,		1	= ^123
	z	í	X
	SUBS. 2		SUBS. 6
			z	
	x,= XB	K	,	x32,= o
	x 1 y3 ~-x;2		4-x	Ys21_0
A	rix2 “	™	1	J 2
	\ Z3 = Z3		z32I« 1
	z		
	SUBS. 3		SUBS. 7
-	ri (X=) S,„s .= X„		XM1= 0
ri-	|	(Xj~) ~ S34C3	Yj2	(z	”r*x	X32 -
iV			-ri2
	C"= z,2		Z32 - C4!
		z	
Obs.: Os números 1,2,3 e 4 nos vértices dos quadriláteros indicam a localização de
Figura 2.9: Quadrilátero Esférico: Equações Fundamentais e Subsidiárias
2.2.9	Equações para o Quadrilátero Polar
O quadrilátero polar da figura 2.10 foi obtido a partir do quadrilátero esférico da figura 2.7. A posição do sistema de coordenadas UVW é determinada de maneira que U = Z, V = -Y e W ~ X. Através de um procedimento análogo ao utilizado na seção 2.2.6 para o quadrilátero esférico,
pode-se chegar às seguintes equações de seno, seno-cosseno e cosseno para o quadrilátero polar da figura 2.10:
^321	—	54	S41
y32i	=	54	C41
W32l	-	C4
(2.30)
onde,
fel	=	U32	C12 — ^32	512
V32I	=	€1(^32	^12 + V32	C12)	-&amp;lt;§1	W32	(2.31)
W321	=	31(1732	312 + V32	C12)	+ Ci	H'32
Ê importante entender que as equações (2.30) representam as componentes do vetor n34 no sistema de coordenadas obtido pela rotação de UVW de -#1 em torno de U, de modo que o eixo W passe a coincidir com .
Figura 2.10: Quadrilátero Polar
2.2.10	Equações para o Polígono Polar de n Lados
Por indução, a partir da equação (2.30), pode-se chegar às seguintes equações do seno, seno-cosseno e cosseno para o polígono polar de n lados mostrado na figura 2.11:
í^(n—l)(n—2)...l	= sn 3ni
^(n—l)(n—2)...l	—	Cni
l)(n—2)...l	“ Cn
(2.32)
onde,
^(n-l)(n-2)...l	=	^(n-l)(n-2)..,2	c12	P(n-l)(n-2)...2	512
P(n-1 )(n-2)...l	=	Cl(P(n-l)(n~2)...2	-$12	+	V(n-l)(n-2)...2	c12) ~ ^1	WZ(n-l)(n-2)...2	(2.33)
W(n-l)(n-2)...l	=	Sl(P(n-l)(n-2)...2	512	+	P(n-l)(n~2)...2	c12) + Cl	^(n-l)(n-2)...2
sendo que ambos os lados de (2.32) correspondem às componentes do vetor	no sistema
UVW da figura 2.11 rotacionado de ~&amp;amp;i em torno de U, de modo que o eixo W coincida com anl.
Figura 2.11: Polígono Polar de n Lados
2.2.11	Equações Subsidiárias do Polígono Polar de n Lados
De forma semelhante à descrita na seção 2.2.8 para polígonos esféricos, é possível obter-se as equações subsidiárias para o pohgono polar de n lados através de rotações sucessivas do sistema UVW. Os quatro primeiros conjuntos são:
— Conjunto 1 (após a rotação de 0Ç
W(n-1 )(r¡ —2J...2	=
Um
-Vm
(2.34)
—	Conjunto 2 (após as rotações de 0y e oi2)
^(n-l)(n-2)...2	™	^nl2
V(n-l)(n-2)...2	=	~^nl2
W(n-l)(n~2)..,2	~	Wnl
—	Conjunto 3 (após as rotações de 0-[, 03 2 e 02)
U(n~l)(n — 2)...2	—	Un\2
^(n-l)(n-2)...2	=	~^nl2
WZ(n-l)(n™2)...3	~	Wnl2
(2.35)
(2.36)
- Conjunto 4 (após as rotações de o12, #2 e o23)
U(n-l)(n-2)...3	~~
^(n-l)(n-2)...3	=
W(n-1)(„-2)...3	-
b7nl23
~^nl23
Wm2
(2.37)
onde,
^(n-l)(n-2).„2 ^12 + ^(n~l)(7í-2)...2 c32 Um$\2 + Vnlci2 , e assim por diante.
Na figura 2.12 estão apresentadas as equações fundamentais e subsidiárias drilátero polar.
para o qua-
Obs.: Os números 1,2, 3 e 4 nos vértices dos quadriláteros indicam a localização de
6
e
Figura 2.12: Quadrilátero Polar: Equações Fundamentais e Subsidiárias
2.3	Polígonos Espaciais
2.3.1	Equação de Malha Fechada para Polígonos Espaciais Ortogonais
Na figura 2.13 vê-se um polígono espacial ortogonal com n lados (n12, a23,anl) e n excentricidades (5i,52, ...,5n), sendo que os vetores e 5, associados aos lados e excentricidades desse polígono são os mesmos vetores dos polígonos polar e esférico de n lados. Esse polígono é dito ortogonal porque uma excentricidade e um lado adjacentes são perpendiculares entre si. Como os ângulos cris e $'s são os mesmos dos polígonos esférico e polar correspondentes, as equações válidas para esses polígonos são também válidas para o polígono espacial ortogonal.
Figura 2.13: Polígono Espacial Ortogonal com n Lados
A equação de malha fechada para o polígono espacial da figura 2.13 é a seguinte:
(‘S'l *£1 + $2 S_2 + -• + $n ¿n) +
(«12 «12 + «23 «23 + ... +	+ anl Ünl)	== 0
(2.38)
Os cossenos diretores dos vetores unitários da equação 2.38 para alguns polígonos são mostradas a seguir:
— Triângulo Espacial (n=3) - (o,o,i)
S2 ~	(0 , -«12 , C12)
£3 = (T2, F2, Z2)
«12 = (1,0,0)
«23	—	(c2 , — U21 , ^21)
«31 = («1 , —•$] , 0)
Quad	rilátero Espacial (n=4)		
£1	= (0,0,1)	—12	= (1,0,0)
S-2	= (0 , -Í12 , C12)	^23	= (c2, -v2i , e21)
	= (X2, y2 , Z2)	«34	=	(1^32 , ~U3n , £1321)
S4	= (X32, y32, Z32)	«41	= («1 , -«1 , 0)
— Pentágono Espacial (n=5)
= (0,0,1)
^2	_ (Q , — 6]2 , C12)
£3 = (X2, y2, Z2)
£4 = (^32, r32, z32) S5 —	(^432 , ^432 , Z432)
«12 = (1,0, 0)
«23	™	(c2 , -#21 &gt; ^21)
£34	=	(WZ32 , —17321 , 1/321)
«45	=	(1^432 , ~^4321 , ^4321)
«51	=	(C1 , —51 , 0)
onde 1/21 = “62 «12 e Z/2i = s2 $21-
Como a equação 2.38 é vetorial, pode ser desdobrada em três equações algébricas.
2.3.2	Cadeia Espacial Ortogonal Aberta
A cadeia da figura 2.14 foi obtida removendo-se o lado anl e a excentricidade Sn do polígono espacial da figura 2.13. O vetor posição R^n^n da extremidade pode ser expresso por:
-	(£1	£11)£1 + S2 S_2 +...+ £(n-l)	+	(2 39)
+ «12 «12 + «23 «23 + ••• + «(n-l)n «(n-l)n
A razão da introdução de Sn ficará clara posteriormente. A equação vetorial 2.39 também pode ser desdobrada em três equações algébrica
Figura 2.14: Cadeia Espacial Ortogonal Aberta
2.3.3	Equações Secundárias para Polígonos Espaciais
As equações secundárias do seno, seno-cosseno e cosseno para polígonos espaciais representam, respectivamente, os momentos em relação aos eixos X, Y e Z da reta orientada definida por qualquer uma das excentricidades. Aqui interessam apenas as equações secundárias do cosseno, as quais são muito importantes para a derivação das equações de entrada-saída para a grande maioria dos mecanismos espaciais.
Considerando-se o momento em relação ao eixo Z da reta que contém a excentricidade definida por no triângulo espacial da figura 2.15, tem-se:

(-SlSi ™ 031 O31)x£3-à
«Slí&amp;amp;X^).* + 031 (£3X031). i
Figura 2,15: Triângulo Espacial
Os coeficientes de S} e 031 na equação 2,40 podem ser calculados da seguinte forma: t(Si) - (Xj , -X* , cai) x (0,0,1) . (0,0,1) = 0 ;
Para o cálculo de r(a31) é conveniente utilizar um novo sistema X’Y’Z’ de coordenadas
cujo eixo Z’ seja paralelo a Z e 5beo eixo X’ seja paralelo a o31. Assim, tem-se:
^(«31)	=	x	. (¿)x'Y'Z' =
=	(0 , s31 , c31) x (1 , 0 , 0) . (0,0,1) = -s31
Portanto, a equação 2.40 resume-se a:
O momento expresso pela equação 2.40 também pode ser calculado da seguinte forma:
Zj2x¿3‘— —	(«12 «12 4~ S2S.2 d" tt23 «23)x^3*^
~	«12(®12x^3)'¿ + ^(^xSg).^ + «23(«23x^3)-j&amp;amp;
onde r(a12) = (1 , 0,0) x (X2 , Y2 , Z2) . (0 , 0 , 1) = K2
Para o cálculo de r(S2) é conveniente utilizar um sistema X’Y’Z’ cujo eixo Z’ seja paralelo a 52 eo eixo X’ seja paralelo aq12. Desta forma, tem-se:
t(52) = (0,0,1)x (X2 , X2 , €23) ■ (0 , ^12 , C12) = Si2 X2
Para o cálculo de t(«23) o sistema X’Y’Z’ a ser utilizado tem o eixo Z’ paralelo a 53 e o eixo X’ paralelo a 023- Assim, obtém-se:
r(a23) = (1 , 0 , 0) x (0,0,1) . (X2 , ~Y2 , Z2) = Y2
A equação 2.42 resume-se agora a:
r.2x^3‘k — «12 Y2 + S2 5j2 X2~ + «23 Y2 — Zo2
Igualando-se as equações 2.41 e 2.43 chega-se à seguinte equação secundária do cosseno:
-^02 — —«31 531
É oportuno ressaltar que Z02 = Zo2- De forma geral, é óbvio que:
Zopqr...
Zo..,rqp
Deve ser também observado o fato de que para o cálculo de um coeficiente há, geralmente, duas posições convenientes para o sistema X’Y’Z’, podendo-se, portanto, obter duas expressões distintas para o coeficiente. Por exemplo, se para o cálculo de r(S2) o eixo X’ for paralelo a «23, ao invés de q12, tem-se:
t(52) - (0,0 , 1) x (0 , -s23 , c23) • (X2 , -X2* , c12) = s23 X2
Deve ficar claro, no entanto, que s23 X2 = 612 X2.
O procedimento para encontrar as equações 2.41 e 2.43 pode ser igualmente aplicado a qualquer polígono espacial ortogonal. É útil saber que o número de termos principais nas expressões dos momentos é sempre ímpar e que estes termos obedecem certa simetria em relação ao termo central. Este fato facilita bastante a derivação de expressões de momento mais complexas e pode ser observado na igualdade 2.43, onde u12 Y2 é simétrico de «23 Y2 em relação a S2.
2.3.4	Triângulo Espacial: Equações Secundárias do Cosseno
Para o triângulo espacial da figura 2.15, com a excentricidade Si no eixo Z, pode-se obter duas equações secundárias do cosseno: uma delas considera o momento da excentricidade 82 em relação a Z, e a outra refere-se ao momento da excentricidade S3. Esta última, conforme demonstrado anteriormente, é a seguinte:
(2.46)
e a outra, que considera o momento da excentricidade 82, tem a seguinte forma:
Z^o3 — “ Cl 12 ® ¡2
onde. Zro ~a31 Y3 4- S3 s 31X34*^223^3
As igualdades 2.47 são muito semelhantes às igualdades 2.46. De fato, elas diferem apenas pelos índices. Para os polígonos nas próximas seções, apenas algumas equações secundárias do cosseno serão mostradas.
2.3.5	Quadrilátero Espacial: Equações Secundárias do Cosseno
Considerando-se o momento da excentricidade S3, tem-se:
7	= 7
^04	^02
onde. ZM = ci41Y4 4- S4 S43X44-CI34Y4
e = Y2 4* S2 S ¡2X 24~ O23Y2
(2.48)
Considerando-se, agora, o momento da excentricidade 84. tem-se:
S41
onde. Z — 12 Y32 S 2 s j2 X 32 4~
+ aB (c ,2Y3 + x; Z3) +
+ CI34Y23 4* S3 S34X 23
Pode-se observar na última igualdade de 2.49 a simetria entre os dois primeiros e os dois últimos termos em relação ao termo central referente as lado a.23.
2.3.6	Pentágono Espacial: Equações Secundárias do Cosseno
3	onde: Zw32~~ c*J2Y43:3+ S2Sj2X432+	(c¡2 Y434-X2 Z43)
- s3 (x2x:3+y2 x43) +
4- CI45Y234+S4 S45X 234+ ^34 (C45 Yzj 4- X 4 Z ,3)
Outra equação secundária do cosseno pode so:
4
05 — ^032” ^]2Yj24S2 Si2X32 4-
+ a23(c32Y3 + x;Z3) +
+ ^*34X23 4 S3 S34X23
onde. Zü5 — d5] y5 4-S3 S51X54'a45Y5
(2.51)
2.3,7	Hexágono Espacial: Equações Secundárias do Cosseno
Z
05432"
^61 $¡61
onde: Z05432—o 12Y5432+S2 s 12X5432+Y543+X2 Z543)
- S3 (X2X«+Y2Xm)
+ aM(Z 2 Ym+XãZ 54)
- S4 (X.XJa+Y, X„)
+ ^6 Y2345+S 5 850X2345+ ^45(^50 Y234+X5 Z 2J4,
(2.52)
A equação resultante quando o momento da excentricidade S5 é considerado é o seguinte:
onde: ZKi — cj6;Y6 + S6 sfc;Xfi+
(2.53)
2.3.8	Heptágono Espacial: Equações Secundárias do Cosseno
As seis equações secundárias do cosseno podem ser obtidas para o heptágono espacial quando o eixo Z é mantido fixo à excentricidade Si, são apresentadas a seguir.
— Momento da excentricidade S7:
^'065432==~ G71 873
065432
- S3 (X2 X 6543 +Y2 X&amp;lt;5543 ) + CÇ4 (Z 2X54+ X 23 Z ,554)
- S4 ( X 23X ¡54+Y23 X 654 )
— Momento da excentricidade S&amp;amp;:
onde: Z07 — o71 Y7 4- S7 S7iX74»afi7Y7
(2.55)
- Momento da excentricidade S$:
onde: Z^., = o71Ygz + 87871X57
+ ^(0,, y6 +x;z6)
4- ^sfiY^ 4- Sg 855X76
(2.56)
Momento da excentricidade S4:
+■ O23 (c 12Y3 4 X2 Z3) 4
4- a^Ya 4- 83 S 34X23
onde. ZG5(^ = q7j Y^-4 S7 S7lX567 4- ^37(c7j Y56 4X7 Z%)
- S6 (XX+Y; XJ +
— Momento da excentricidade S3:
~ Z
04567	02
- S6 (X7 X 456+Y7 X456)
+ a56(Z7 y45+x;6z45)
— ^*71 Y4567+ S7X 4567 +^6?(C7] Y4564- X 7 Z456)
+ Pj4Y7654 +S41X7654+ Cl4S ( C34 Y765 + X4 Z765)
e: ZO2=a32Y2 + S2s32X2+a^Y2
(2.58)
— Momento da excentricidade S2:
Z 034567-----ai2S12
2.4	Manipuladores Robóticos
A figura 2.16 ilustra um manipulador robótico cujas juntas são movimentadas por atu-adores, sendo que cada atuador controla e aciona um grau de liberdade em um par cinemático. A mobilidade M ou o número de graus de liberdade (g.d.l.) da garra em relação à base é igual à soma dos g.d.l. de todas as juntas.
Para que a garra possa ser posicionada de forma arbitrária no espaço, é necessário que M seja, no mínimo, igual a seis. Existem manipuladores com M &amp;lt;6 e outros com M &gt; 6. Os com M &amp;lt;6 possuem uma capacidade de movimentação limitada. Por exemplo, o manipulador pode ser capaz apenas de realizar movimentos coplanares com a garra (M — 3). O número de graus de liberdade extras dos manipuladores com M &gt; 6 pode ser chamado de manobrabilidade, uma vez que eles dão ao manipulador uma maior capacidade para evitar obstáculos.
Figura 2.16: Manipulador Genérico
A capacidade de abrir e fechar a garra corresponde a mais um movimento que, contudo, não influencia no posicionamento e orientação da mesma, não sendo, por este motivo, considerado mais um g.d.l. da cadeia.
2.4.1	Fechamento do Mecanismo Espacial : Solução Inversa
A localização da garra ou da extremidade de trabalho de um manipulador pode ser especificada pelas coordenadas de um ponto da garra (figura 2.16) RET	e Pe_
los cossenos diretores a(n_1)n (X(*n_1)n, Y*nZ(*n_i)n) e £«	Na análise a seguir,
assume-se que o valor numérico desses nove parâmetros são conhecidos e que o manipulador tem mobilidade M = 6.
Para qualquer posição e orientação da extremidade de trabalho do manipulador é possível obter um mecanismo espacial imaginando-se um lado anl e excentricidades Snn e ¿’15 que fecham a malha do mecanismo. Esse mecanismo possui mobilidade M = 1, ângulo de entrada 0n e ângulo de saída
A transformação {(X£r,	Z^T), (X(*n_1)n,y(*„1)n, Z(*n_1)n), (X*,yn*,Z*)} =&gt;
{0n, anl, (0j —&amp;lt;^i), Snn-&gt;	será mostrada detalhadamente. Conhecendo-se a equação de en-
trada e saída do mecanismo espacial resultante, é possível, então, computar um conjunto de valores para 0^ (o número de soluções depende do grau da equação de entrada-saída) e conjuntos correspondentes de valores para as variáveis restamos (#2,#3,---)- ^sse procedimento permite, geralmente, uma escolha de configurações geométricas alternativas do manipulador para uma dada posição qualquer da extremidade de trabalho. Isi o é preferível a obter uma única configuração através de um processo numérico interativo. Além disso, o processo interativo pode tornar-se instável e requer um tempo computacional maior que o processo direto aqui considerado.
Primeiramente será derivada a seguinte transformação:
{(^n-Dn^rn-Dn^tVtJn) &gt; (X^Y^Z*)}	{&amp;amp;n, Qnl, (^ -	)}
Os sistemas de coordenadas X*y*Z* e XYZ (figura 2.16) estão relacionados pela matriz de rotação da seguinte forma:
/

X*
yr*
' x
Y
. Z


z
/

onde
cosçh

— senfii COS(fa
0
(2.60)
(2.61)
0 '
0
1
Substituindo em 2.60 as coordenadas de	no sistema XYZ, tem-se:
^(*n-i)n = CO5(#i -&amp;lt;Mcos0n ~~ sen(ffi — (/&gt;i)s€n0ncosani
(2.62)
“ [se7i(0i - ^cos&amp;amp;n +	-&amp;lt;Ai )sen0ncosanl]
^(n-i)n = senOnsenanl
(2.64)
e substituindo-se em 2.60 as coordenadas de £n no sistema XYZ, resulta:
X“ = senanlsen(0i -&amp;lt;^)
(2.65)
yn* ~ senanlcos(0i -&amp;lt;h)
(2.66)
Z* = cosanJ
Multiplicando-se 2.63 por sen($j —&amp;lt;Ai) e 2.62 por cos($i — ^i) e fazendo-se a subtração dos dois resultados, obtém-se:
X(n-i)n C0s(&amp;amp;i ~	~ Y(n_i)n senifft - -&amp;lt;&amp;amp;)	= cos8n
Multiplicando-se a equação anterior por senani e subtraindo-se nela as equações 2.65 e
2.66, obtém-se:
(n—ljn^n I COS0nSCnOLn\
(2.68)
onde
As equações 2.64 a 2.68 levam ao seguinte conjunto de equações:
anl = co5ml(Z*)
(2.69)
(2.70)
== -(&gt;? - $enanl)/X*
t3(en/2) = Z^JQX^Y^ + sena^
(2.71)
Os valores de an3, (#i ™	) e &amp;amp;n podem ser computados pelas soluções sequenciais das
equações de 2.69 a 2.71, para qualquer orientação especificada da extremidade de trabalho.
O vetor Ret que localiza um ponto determinado da extremidade de trabalho (figura 2.16) pode ser escrito da seguinte forma:
(2.72)
onde:
«nl = (^nl,ynl^nl) ~ (cos(^i - ^ ), ~5en(^i -	0) e
= (xr,^*,^*) = (o,o,i)
Desta forma, as componentes de Ret são:
%ET
V*
*ET
ZET
~(SnnX* +
-(s^ + a^KA)
—(SnnZ* + 5ji)
(2.73)
Das expressões de X(*n_1)n e K(* _1)n da equação 2.73, tem-se que:
(2.74)
ílnl
(2.75)
e da expressão de Z%T, tem-se:
Sn = -(SnnZ: + Z£T)	(2.76)
E importante observar que na situação particular em que Sn // Sj, os valores de Snn e Sn dados pelas equações anteriores ficam indeterminados. Neste caso, pode-se atribuir qualquer valor para 5n„, por exemplo 0, e calcularán.
2.4.2 Posicionamento da Garra: Solução do Problema Cinemático Direto
A solução do problema cinemático direto consiste no cálculo da posição e orientação da extremidade de trabalho quando são conhecidos os deslocamentos dos pares cinemáticos ou juntas. Esta solução é relativamente simples comparada à solução do problema cinemático inversa.
Utilizando-se a matriz de rotação 2.61, tem-se:


X
y*
(n—l)n y*
(n—l)n
Z(n-l)n
■^(n—l)n r(n-l)n ^(n—l)n



e
/
a':
yz*
* n
X
(2.77)
&lt;
Z* n

(2.78)
Vale observar que Àn,Kn eZn podem ser calculados pelo lado esquerdo das equações 2.25, e	e i)n pelo lado esquerdo das equações 2.32.
O vetor posição do ponto referencial da extremidade de trabalho é dado por:
n—1	n
&amp;amp;ET = (£1~~S11)£1 + 52 SrSr + 52a(r~l)r^(r-l)r
t=2	t=2
Aqui também os versores Sr e a^r_iy podem ser calculados no sistema XYZ através do lado esquerdo das equações 2.25 e 2.32, respectivamente.
Capítulo 3
Modelagem
3.1	Introdução
Para a implementação de um sistema de controle, faz-se necessário o conhecimento de uma relação que forneça a posição e orientação espacial da garra para urna dada configuração de juntas, assim como o inverso, ou seja, uma relação que forneça os ángulos de junta correspondentes a urna dada configuração espacial.
A execução de uma tarefa pré-programada por um manipulador depende do previo conhecimento da localização do objeto a ser manipulado e da orientação que o elemento terminal deve ter em relação a este objeto. Isto torna necessária a determinação de um modelo completo para o manipulador.
O modelo direto consiste no cálculo da posição e orientação do elemento final (X) como função das variáveis generalizadas (variáveis de juntas, 0), ou seja:
X = X(0)	(3.1)
onde:	0 ~	é o vetor posição angular das juntas ( variáveis generalizadas
no caso de todas as juntas serem rotacionais);
X ~	(x.y,	é o vetor posição/orientação do elemento terminal.
0 problema cinemático inverso consiste na determinação de valores para as variáveis generalizadas (ángulos de juntas neste caso, 0) de modo que a garra do manipulador assuma uma dada posição e orientação (X).. A solução do problema cinemático inverso é bem mais complexa que o direto, e é expresso através de uma equação do tipo:
Capítulo 3: Modelagem
A solução da equação 3.2 pode não ser única, ou até mesmo nem existir. Geralmente é necessário a utilização de algoritmos que cheguem a uma única solução , em função dos limites físicos das juntas do manipulador.
Uma forma muito utilizada é a que trabalha com transformações homogêneas e a sistemática de Denavit-Hartenberg [1], que permite descrever a posição sucessiva das coordenadas de cada ’’link” através da utilização de determinados parâmetros pré-definidos.
Neste trabalho, fez-se a opção pela metodologia de Duffy [4], que transforma o manipulador em um mecanismo espacial do malha fechada. Tal metodologia foi escolhida pelo fato de não fazer uso de muitas operações matriciais e, consequentemente, demandar menor tempo computacional.
3.2	Problema Cinemático Inverso
A figura 3.1 mostra uma representação geométrica genérica de um manipulador com seis juntas rotativas. Com relação a esta figura, são oportunos os seguintes comentários:
1.	Os versores (z — 1...6) representam a direção e o sentido dos eixos de rotação das juntas;
2.	Os versores representam a direção da perpendicular comum a e ou seja,
x S-j’,
3.	As constantes representam os ângulos entre S_z e medidos de Si para S ■ e satisfazendo a condição 2;
4.	As variáveis representam os ângulos entre e h = i-1 e j - i+1, medidos de g^
para g^j e satisfazendo	x
5.	0 sistema X°YOZ° é fixo à base. O eixo Z° tem o mesmo sentido de S_} e o eixo Xo (ou Y°) pode ter um sentido apropriado qualquer. A origem deste sistema também é arbitrária ao longo do eixo S j;
6.	A junta 7 é fictícia. Seu eixo, 57, fica definido após a escolha de g^ (que deve ser perpendicular a Sg). Isto feito, a71 pode ser determinado;
7.	As constantes escalares correspondem ao ’’offset” entre as juntas i e j;
8.	As constantes escalares Si correspondem ao comprimento do ’’link” i;
9.	Para facilitar a visualização, os parâmetros que representam comprimentos estão indicados na figura 3.2.
Figura 3.1: Representação Geométrica Genérica de um Manipulador
Figura 3.2: Parâmetros para a Representação Geométrica Genérica de um Manipulador
Nesta figura (3.2), Si pode ser negativo, mas S% a S7 são todos não negativos, e «c~ é nulo.
O objetivo da inclusão da junta fictícia (junta 7) é fechar a cadeia cinemática do manipulador de modo a obter, no instante considerado, um mecanismo espacial com um grau de liberdade. Isto feito, a próxima meta passa a ser a determinação da equação de entrada-saída que permitirá calcular o ângulo de saída do mecanismo (#}) para um dado valor do ângulo de entrada 67. Para um manipulador genérico como o representado pela figura 3.1, a equação de entrada-saída é um problema muito difícil. Teoricamente, esta equação seria um polinómio de grau 32. Felizmente, o manipulador Kraft em estudo é um caso particular do manipulador da figura 3.1, pois alguns ângulos assumem valores 0 ou múltiplos de 7r/2, e alguns comprimentos também assumem valor nulo (figura 3.3). As simplificações conseguidas neste último caso são mostradas na tabela 3.1.
Figura 3.3: Representação Geométrica do Manipulador Kraft
O objetivo agora é encontrar expressões para os parâmetros fictícios a67l 071 o7j. (^»j -0j), U7i e St, sendo que éo ângulo que relaciona os dois sistemas cartesianos (X°Y0Z0 e XYZ) mostrados na figura 3.3. Isto pode ser feito da seguinte forma:
Parâmetros conhecidos:
~ ¿Lê e
—	Vetor posição do ponto G da garra = (G'x , Gy , Gz)
—	Versor Og7 ~ («erx , «67Y , «67z)
—	Versor S_7c — (S7cx , S7cy , S7cz) - x S$
Ângulos			Comprimentos	
«12	—	?r/2	S2 =	0
«23	=	0	s3 =	0
«34	=	0	II	0
«45	=	3tt/2	«12	=	0
«56	=	tt/2	«56	—	0
«67	=	tt/2 ou 37t/2	«67	=	0
«71	é	variável		
Tabela 3.1: Simplificações Inerentes ao Manipulador Kraft
Como nesta seção somente o sistema X°Y°Z° será considerado (figura 3.3), os índices das componentes vetoriais poderão ter sua notação simplificada. Por exemplo, Gx = Gx°-
Primeiramente, é necessário determinar a perpendicular comum entre a reta que passa pelo ponto ”G” com direção S7c e a reta que passa pela origem O com direção Z (ou Isto pode ser feito através do seguinte produto vetorial (ver também figura 3.2:
[(£ + AS7c) - T/Sj] x g71c = 0	(3.3)
onde «71c é o produto vetorial entre os versores S7c e igual a (S7cy , -S7cx , 0)
Expandindo-se a equação vetorial 3.3, obtém-se as seguintes equações algébricas:
^7cX(Gz +
ÀS7cz - rç) = 0
(3-4)
S7cy(Gz +
^S7cz - 7?) = o
(3-5)
— S7cx(Gx + M&gt;7cX) ~ S7cy(Gy + ÀS7cy) — 0
O valor de À pode ser determinado através da equação 3.6. e tj através das equações 3.4 e 3.5 da seguinte forma:
GxS7cX + GyS7cy
(S7cx)2 + (S7cY)2
(3.7)
Estas duas últimas equações valem se o produto vetorial 57c x Sj 7^ 0. Quando S7c e S_r assumem a mesma direção, A fica indeterminado, podendo assumir qualquer valor. Neste caso pode-se fazer A = 0 e T] = Gg-
É oportuno frisar que S7 = |A| e Si = So — g. Desta última igualdade pode-se concluir que 5i pode ser negativo, quando o ponto de interseção I (figura 3.3) ficar acima da junta 2.
Uma vez conhecidos A erç, pode-se calcular 57, a71 e a7x. Assim:
57 = sí?(A).57c			(3-9)
	í 1 se A &gt; 0		
onde sg(A)	1 —1 se A &amp;lt;0		
		«71 ~ IM-71II	(3.10)
onde A71 -	=	~ (G + A57c)		
e			
	0.71 ■ =	A7~i -	,	se A7i 0 «71	(3.11)
Se A7i — 0	, então:		
	u7i = 5 7	x 53	se 5 7 x 51	0	(3-12)
ou			
	«71	—	se 57 x 5X = 0	(3.13)
	Os ângulos 067, 3? e	~~	podem ser calculados utilizando-se		as seguinte fórmulas:
	O67 =		(3.14)
= atan2(a71.sg(X).S6la71.a67)	(3,15)
(&lt;¿&gt;i~0i) = atan2(a71Y,a71X)
a71	= atan2(S_1.(a7i x ^y),^.^)
= atan2(a7ix-S7Y ~ a7iY-S7x,S7z)
3.2.1	Análise do Mecanismo Espacial RRRR-R-RR
0 manipulador da figura 3.3 foi transformado no mecanismo espacial RRRR-R-RR pela inclusão de uma sétima junta rotativa (fictícia). Esse mecanismo possui três juntas paralelas, indicadas por R-R-R na notação acima, e apenas um grau de liberdade (mobilidade igual a um), conforme demonstrado abaixo
n
M = ]C/í - 6 = 7- 6= 1	(3.18)
í=l
onde,
M — Mobilidade de um mecanismo espacial com ’’single loop” e n juntas;
fi = graus de liberdade da ?-ésima junta.
Portanto, é possível encontrar a equação que relaciona o ângulo de entrada. 07 com o ângulo de saída ou seja, dada uma posição e orientação da garra, pode-se determinar pela equação 3.15 o ângulo de entrada 07 do mecanismo espacial fictício associado à referida posição e orientação da garra e, então, pela equação de entrada e saída que será deduzida a seguir, determinar o valor do ângulo de saída Oj e, consequentemente, o valor de Serão também mostradas equações para os demais ângulos (i—2...6) que, juntamente com , representam a solução para o problema cinemático inverso.
3.2.2	Equação de Entrada-Saída (07 x ¿A)
A equação de entrada-saída do mecanismo espacial RRRR-R-RR (figura 3.3) pode ser deduzida a partir da componente Z da equação vetorial para o ’’loop” do mecanismo. A localização deste sistema XYZ na junta 2 deve-se ao fato de termos as juntas 2, 3 e 4 com eixos de rotação paralelos, o que simplifica os cálculos a serem feitos. Portanto, utilizando-se o sistema XYZ indicado na figura 3.3, tem-se:
+ S7Z\ + ^71 £^12 = 0
onde,
Zn é a componente Z do versor
Z\ é a componente Z do versor 57;
{712 é a componente Z (ou U) do versor a71.
sendo que foram considerados os seguintes pentágonos esférico e polar:
U“ Z
VE - Y
WE X
Figura 3.4: Pentágonos Esférico e Polar
Expandindo Z71, Z\ e Z712, tem-se:
Z7i — si2(Y7si 4- YrCj) + ci2Z7 — A7sj + V7C1	(3.20)
onde S{j = «en(a,j), st- = sen(6{), c, = cos{9,) e a12 = tr/2, conforme visto anteriormente na tabela 3.1.
Zi — C12C71 - 512^71 Ci — — ^71 ci
U12 = S1S12 =	(3.22)
Substituindo-se as equações 3.20, 3.21 e 3.22 na equação 3.19, tem-se:
(sgXy +&amp;lt;271 )$i + (SqY? — S7ó7)ci = 0
E possível, agora, calcular o ângulo através da seguinte expressão:
#i = atan2(S7S7í - 56Y7.,56X7 + «ri)	(3.23)
onde X7 ~ $q7s7 e Y7 — — c7\ôq7c7.
Utilizando-se o valor de (çb - 0j) calculado pela equação 3.16, tem-se:
&lt;¿&gt;1 = (^i -0i) +	(3.24)
Considerando novamente o pentágono esférico da figura 3.4, é possível obter-se três igualdades para as componentes X, Y e Z do versor 5c:
{Sex} =	X71	=	(3.25)
onde o = 02 + ^3 d" ^4 •
{S6y} =	-Yti	=	X5*a	(3.26)
{S6Z} s	Zn	=	Z5	(3.27)
sendo que JV71, Y71 e ^71 são funções de 07 e	podendo ser calculados. Os demais elementos são
dados por:
-X,5a —	5^a Yg-S^	(3.28)
onde .Y5 = SseSs e Y5 = ~(545C56 + C45S56C5). Substituindo-se os valores de a45 e o56 da tabela
3.1,	tem-se:

+ YgCQ — $$$&amp;amp;
(3.30)
e, finalmente,
— C45C56 —&amp;lt;$45â56cS — c5
Pela substituição de 3.29, 3.30 e 3.31 em 3.25, 3.26 e 3.27. respectivamente, tem-se:
cQ = Xn/s5
(3.32)
¿a = -Y71/s5
Z71 = c5
Posicionando agora o sistema XYZ no pentágono esférico conforme a seguir, obtém-se:
onde,
i S2X)	X 37 — X%
{ S2Y }	Yj7 = - X56
{S2Z}	Z37=Z5
X56	— X5C6 — 15S6
=	S45S5C6 + (S56C45 + C56S45C5)s6
~	“^5^6
X55 — Xg&lt;$6 + Y5C6 =
Zg — C56C45 — 656^45^5 = Cg
Substituindo 3.36, 3.37 e 3.38 em 3.35, resulta:
Xi7 — —SsCe
(3.35)
(3.36)
(3.37)
(3.38)
(3.39)
K17 - S5S6
(3.40)
Z17 = Cg
Dividindo-se Y17 por X17, obtém-se:
tge6 =	=
C6
V17
A17
sendo que
-Xj.7	= XiC7 — Y1-S7
—	&gt;S12'‘HÍ&gt;7 + (-S71C12 + C7iS12C1)aS7
= SjC? + C71C1S7
¥17	=	C67(Xi$7 4- Y1C7) — Se7^1
—	S67S71C1
Substituindo-se K17 e X17 na equação 3.42, obtém-se o valor do ângulo 0G:
06 = atan2(—Yi7,Xi7) #5 pode agora ser calculado através das equações 3.39, 3.40 e 3.41:	(3.43)
05 = atan2( --Xi7/c6, Zi7), se cG 0	(3-44)
05 ~ G/an2(y17/ó6,Zi7), se c6 = 0
Onde Zi7 = ^67Í5157 — c71clc7)-
Considerando a figura 3.3 e os pentágonos esférico e polar da figura 3.4, é possível obter as seguintes equações algébricas que representam as componentes em X e ¥ da equação vetorial da malha fechada para o mecanismo espacial da figura 3.3:
í!?!	=	(0 , S12 1 C12)	—23	=	(C2 ,52,0)
5$	=	(&lt;$45Sq , ~~S45Ca ,	Ca)	034	=	(C2+3 , 52+3	,	0)
jSg —	(-X7I ,	¥71 , ^71)	^45	= (^cr ,	, 0)
S7	=	(Xi , -¥1 , z?i)	a71	=	(cj , —S1C12	,	51S12)
onde C2+3 ~ cos(02 + #3) e ¿2+3 - sen(02 + #3)-
— Componentes em X:
«23^2 + «34C2+3 + Ü45Ca ~ ^5^a + ‘$6-^71 + £7X1 + «nCl = 0	(3.45)
Componentes em Y:
G23S2 + a34&lt;52+3 + a45'‘’a + SsCa —	“ «S^Yl + Sj = 0	(3.46)
Substituindo 3.32 e 3.33 em 3.45 e 3.46, tem-se:
G23C2 + ^34c2+3 = ~~P	(3-47)
a23s2 + a3452+3 ~ Q	(3.48)
Somando-se os quadrados de 3.47 e 3.48, chega-se ao valor de 03:
e3 = ±co.s-^2 + ^-tà + ^) 2g23°34	(3.49)
onde:
P ~	^6)	fs^71 +	4- «71Cj
Q =	+ s«) Yn ~	+ s?Yi - 5,
A71	=	Ã67S7C1 + 5g7C7iC7^j
y7í = S67S71C7
Xj =	$7131
“	-«71
Cabe aqui frisar que ¿5 (sen#5) é sempre / 0e^ é sempre &amp;lt;0, devido aos limites físicos para os ângulos do manipulador Kraft.
Expandindo-se C2+3 e ^2+3 nas equações 3.47 e 3.48, chega-se ao seguinte sistema de equações:
(«23 + «34«3)«2	«34^3^2	=
-P
«3453c2 + («23 + «34«3)'s2	— Q
Resolvendo-se este sistema de equações, resulta:
—	^g34^3 ~ ^(g23 + «34«s)
(«23 + «34C3)2 + («34-S3)2
—	a34c3)c2
«34*3
Das equações 3.51 e 3.52, tem-se a expressão para o cálculo de 02'.
02 — atan2(s2^ C2)
(3.50)
(3.51)
(3.52)
(3.53)
Finalmente, através das equações 3,32 e 3.33, pode-se chegar a uma expressão para o cálculo de £4, o último ângulo procurado:
3.3	Problema Cinemático Direto
Como o próprio nome sugere, o problema aqui é obter a posição e orientação da garra, sendo dados os ângulos das juntas do manipulador, ou seja, com referência à figura 3.3, dados os ângulos&amp;lt;/&gt;i, #i, #2, #3, #4, $5 e&amp;lt;96, procura-se obter as coordenadas do ponto G e os versores 5^ e Oq7, Da referida figura, pode-se facilmente tirar as componentes dos versores «23, e «45, referentes ao sistema de coordenadas XYZ fixo na junta de número dois e mostradas a seguir:
«23	=	(c2 , S2 , 0)
U34	=	(c2+3 , ^24-3 , 0)
Ü45	— («cr •&gt; y 0)
onde a = 02 + #3 + @4-
Ainda no sistema XYZ, os versores S_$ e S6 são calculados da seguinte forma:

C«45
S&amp;amp;X ~	~ X5Q — X5CQ	Y 5&lt;$'q — - ^*56^5^0 4“ [*^&lt;&gt;45 ^«56 + d- £(*45	csJsq ~
S^y -	~ X£a — X^Sct+YsCa = ~	^a^^5sa	4“ -	^s)^a
56, =	= Z5 = C0,46CQf56	^0-45 ^a5S Cg) — = cs)
De posse dos versores 033, «34, c^5, S_5 e 5$, pode-se calcular as coordenadas do ponto G, também no sistema XYZ, como a seguir:
Gj. ~ «23 «23^ + «34 a34x 4~ a45 «45x + .95 55r + S6 56.c; Gy = «23 «23y + «34 «34y + «45 «45^ + 55 S5y + 56 56y; Gz = «23 «23^ + «34 «34z + «45«45z + 55 55z + 56 56z:
(3.55)
onde aij e Si são parâmetros mostrados na figura 3.2.
Resta, agora, calcular o versor para que a solução do problema cinemático direto esteja resolvido. As componentes deste versor em XYZ são dadas por:
4"	4“ l^GS^or
Ctg7y —	4-	j 4- W(55Sq
®67í	=	£^65^0(45 ~ ^65^045
Tem-se agora, as coordenadas do ponto G e os versores S&amp;amp; e ftg7 no sistema de coordenadas fixo na junta dois.
Para que se possa fazer uso destes elementos, deve-se tê-los em coordenadas do sistema fixo na base do manipulador XaYoZ°, também mostrado na figura 3.3. Basta, então, montar a matriz que faça a transformação de rotação entre os dois sistemas, a qual é composta de duas rotações : a primeira de 90 graus em torno de X seguida de uma rotação de graus em torno do novo Z. A matriz resultante R é mostrada a seguir:
1
0
0
0
0
1
0
0
1
s&lt;tn
c&lt;h
0
0
-1
0
0
0 1 0
Os versores S# e expressos acima no sistema XYZ podem, agora, ser transformados para o sistema XC,YOZ° , pré-multiplicando-os pela matriz [R] anterior. As coordenadas do ponto G no sistema X°Y°Z° ficam determinados pela transformação :


T XYZ
Capítulo 4
Interface Homem-Máquina
Neste capítulo são descritos os módulos criados e/ou modificados a partir da configuração inicial do Sistema Kraft [3], cujo diagrama de blocos pode ser visto na figura 4.1, com a finalidade de viabilizar a utilização do microcomputador como opção de controle para o manipulador, tanto através do teclado quanto com a utilização do Mouse Espacial.
A estrutura e opções dos menus apresentados foram feitos de modo a possibilitar ao usuário um acesso mais rápido às funções necessárias e disponíveis.
onde: MSC	Módulo de Controle do Sistema do Master;
RSD	Módulo Driver Remoto;
KMC	Chassis da Eletrônica Kraft;
A/D	Conversor Analógico/Digital;
D/A	Conversor Digital/Analógico.
Figura 4.1: Configuração Inicial do Sistema
í'-: ’■'¿r' ‘i

■ r P. *" v * *T*.. “1'r *r' ” “¿‘	‘A A,i • T f'

Figura 4.2: Primeiro Menu do Programa.
Figura 4.3: Diagrama de Blocos do Programa
4.1	Master Slave
Esta opção mantém a possibilidade de controlar o manipulador através do Master, como descrito no capítulo 1. A tela inicial deste modo de controle pode ser vista na figura 4.4,
$
I
" *’ *■* * * “ "’ v &gt; ?	:	
	
	
	






Figura 4.4: Tela Inicial do Modo Master Slave.
4.1.1	Calibração
Tem por finalidade fazer a correspondência entre os valores máximos e mínimos dos ângulos de junta do Master e do Slave. A calibração é feita junta por junta, conforme instruções mostradas na tela (figura 4.5), e armazenadas em um arquivo.
4.1.2	Monitoramento
Esta tela, mostrada na figura 4.6, monitora todas as tensões dos potenciómetros do master e do slave, os quais são mostrados através de gráficos. Apresenta ainda uma janela com os valores dos ângulos das juntas do manipulador e uma outra com a posição e orientação da garra, obtidos via modelo cinemático direto.
Apresenta ainda as seguintes funções :
R&lt;&gt; í: irs» tint C»3
$	— Fi-«!Ls; jow a fe- 1-a Cí7S.
KfSiCÍO 13’s» » juriíi» a ««;{-ftjuí.t?:	p s: !av&lt;"
Prí-.s-í-sont ENTER7 A.ímsíí t? Íl.ipíier fe pres.s;o!W E'íH3’. .
rio	T erm j rvs» 1 :
&lt;:»1 t tir
na rsos trao irsip í w f .
Figura 4.5: Tela de Calibração .
í?
¿J15V
K i ' +€.ÚtX 7. ’ */ : -3Ü8. £
	. Jyrit a? l&lt;® auJS?	
■ *1 :	*2-5	s	+2.5
-■ tf2. s	*75*2 -.	i	■ - *52.7
73 ;	“2I:*S	- :-	HrS í	'131.1

3 A
e


S'+t S5:&gt;i¿ t&amp;lt;:-:-&gt;íí í" i im 1 -
Figura 4.6: Tela de Monitoramento
—	F1 : Ativa a animação do master ou do slave, de acordo com os valores das tensões lidas dos p ot en ciômet ros.
—	F2 : Ativa a gravação de trajetória. Quando acionada esta tecla, todos os pontos passam a ser guardados em um arquivo cujo nome é escolhido pelo operador. A gravação termina quando outra tecla é acionada.
—	F3 : Ao primeiro toque, abre um arquivo cujo nome é escolhido pelo operador e grava a posição atual. A Patir daí, a cada vez que F3 é acionada é feito o armazenamento da posição atual no mesmo arquivo.
4.2	Micro Computador
Esta opção passa o controle do manipulador do Master para o computador, e dá ao operador as seguintes opções :
-	Controle;
-	Animação ;
-	Parâmetros.
4.2.1	Controle
São apresentadas três formas de operação paia o manipulador, sendo que as duas primeiras, via teclado e via mouse espacial, são manuais, e a terceira, é o modo automático, conforme mostrado na figura 4.7.
Controle Via Mouse Espacial
Neste modo, o manipulador é controlado diretamente pelo Mouse Espacial. Assim que esta opção é acionada, o microcomputador lê os ângulos atuais das juntas do manipulador, os quais são enviados para o modelo cinemático direto. Deste modelo, descrito no capítulo 3, obtém-se a posição e orientação atuais da extremidade do manipulador (garra),
Quando o acoplamento do Mouse é feito, o sistema calcula e guarda os cossenos diretores (Xeg, Yeg e Zeg) e as coordenadas do ponto central do manipulo, mostrado na figura 1.3. Isto feito, sempre que o Mouse é acionado, é possível obter a matriz de transformação que leva o manipulo da posição inicial para a final, bem como a variação na posição do ponto central. Esta matriz é aplicada à matriz de orientação do manipulador, leva à nova orientação do mesmo. De posse da nova orientação e da nova posição da garra (posição inicial acrescida da variação das coordenadas do
Figura 4.7: Tela Inicial do Controle Via Microcomputador.
ponto central do manipulo), pode-se enviar ao manipulador os novos ângulos das juntas, calculados através do modelo cinemático inverso.
A tela aprensentada neste modo é mostrada na figura 4.8, e é composta dos seguintes itens:
—	Seis gráficos mostrando as impulsões dos potenciómetros do manipulador;
—	Uma janela mostrando a posição e orientação da garra;
—	Uma janela mostrando os ângulos das juntas do manipulador.
Além disto, existe ainda um menu na parte superior da tela com as seguintes opções :
—	Teclado: muda o controle do modo mouse espacial para o modo teclado;
—	Grava Posição: grava em um arquivo, cujo nome é escolhido pelo operador, a posição atual do manipulador;
—	Grava Trajetória: grava todas as mudanças de posição do manipulador a partir do momento em que é acionada até que outra opção seja ativada. 0 nome do arquivo é escolhido pelo operador;
—	TV: mostra uma tela reservada para a imagem de uma câmera a ser instalada no manipulador.
Figura 4.8: Tela de Controle Via Mouse Espacia].
Controle Via Teclado
Neste modo, o controle é feito diretamente através do teclado. Ao ser acionada, o sistema lê a posição atual do manipulador e fica aguardando algum comando via teclado. A tela montada para esta opção é mostrada na figura 4.9, e possui os seguintes itens:
-	Seis gráficos mostrando as impulsões dos potenciómetros do manipulador;
-	Uma janela mostrando a posição e orientação da garra;
-	Uma janela mostrando os ângulos das juntas do manipulador.
Apresenta na parte superior da tela um menu com as seguintes opções :
-	Mouse: muda o controle do modo teclado para o modo mouse espacial;
-	Define Reta: define a reta entre dois pontos escolhidos pelo operador. Estes pontos, devidamente tratados, formam uma trajetória que é armazenada e pode ser enviada ao manipulador;
-	Grava Posição: grava em um arquivo, cujo nome é escolhido pelo operador, a posição atual
do manipulador; ---------- _	.... " ’	’	’
Figura 4.9: Tela de Controle Via Teclado.
—	Grava Pontos: ao primeiro toque, abre um arquivo cujo nome é escolhido pelo operador, e guarda a posição do manipulador. Cada subsequente chamada da função armazena a posição atual no mesmo arquivo;
-	TV: mostra uma tela reservada para a imagem de uma câmera a ser instalada no manipulador.
Apresenta ainda uma função acionada pelas teclas ALT D que ativa o Movimento Direto e desativa o menu acima descrito.
Uma vez ativado o Movimento Direto (figura 4.10), passa-se a ter a possibilidade de movimentar cada uma das juntas separadamente ou fazer movimentos nas direções X, Y ou Z da orientação da garra, conforme instruções na própria tela.
Controle Automático
Esta opção possibilita ao operador enviar ao manipulador trajetórias previamente tratadas e armazenadas, de forma a não causarem movimentos bruscos.
Podem ser enviadas trajetórias únicas ou um conjunto de trajetórias, formando uma tarefa específica. Esta possibilidade foi criada para suprir problemas em que a memória do com-
Figura 4.10: Tela do Movimento Direto.
putador não seja suficiente para armazenar todos os pontos de uma determinada trajetória a ser enviada.
4.2.2	Animação
Apresenta as mesmas opções do controle, sendo que as variações nos ângulos das juntas somente são usados na animação , sem afetar o manipulador. A figura 4.11 mostra a tela com a animação do manipulador no modo teclado.
4.2.3	Parâmet ros
Opção criada para permitir a mudança nos valores tidos como ’’default” de alguns parâmetros do Mouse Espacial e do teclado.
4.3	Teste de Hardware
Permite testar elementos do hardware utilizado, tais como conversores analógicos/digitais e digitais/analógicos (A/D e D/A), entradas e saídas digitais, modos de operação e porta serial de conexão do Mouse Espacial.
Figura 4.11: Tela de Animação Via Teclado.
Capítulo 5
Resultados e Conclusões
Para finalizar o presente trabalho, o programa foi testado usando o Sistema Kraft no CENPES - Centro de Pesquisas e Desenvolvimento da Petrobras. Descreve-se, a seguir, os principais testes realizados, os resultados obtidos e as conclusões finais do trabalho.
5.1	Testes e Resultados
5.1.1	Controle Via Master Foi o primeiro modo a ser testado, devido a ser o mais conhecido e o único utilizado
sem o uso do microcomputador.
Foram verificadas todas as funções do controle via ’’master” e as opções criadas para a aquisição de pontos e gravação de trajetórias.
5.1.2	Controle Via Teclado
	Foram verificadas as opções de aquisição de pontos para geração de trajetórias ”off line”
(como no modo anterior) e, principalmente, o controle individual de cada junta via teclado, bem como da abertura, fechamento e rotação contínua da garra.
Neste modo de controle, o microcomputador faz o papel do ’’master”, como descrito no capítulo 4. Por este motivo, foi necessário criar uma rotina que, no momento de transição do modo de controle via microcomputador para o modo de controle via ’’master”, verifica se a posição do manipulador corresponde à do ’’master”. Caso não seja, é executada uma trajetória que leva o manipulador para a posição atual do ’’master”. Tal rotina foi criada e testada.
5.1.3	Controle no Modo Automático
Para testar este modo, foram criadas trajetórias ’’offline” a partir de arquivos de pontos obtidos através dos modos de controle via "master' e via teclado, bem como foram gravadas trajetória contínuas no modo ”m áster”. Além disto, para testar a possibilidade de enviar trajetórias consecutivas, foram criadas trajetórias que fossem continuação da anterior.
Estas trajetórias foram enviadas ao manipulador das duas formas possíveis (simples ou composta), sendo que na composta existe a possibilidade de abrir ou fechar a garra no final de cada pedaço da trajetória maior. Este modo de envio possibilitou a composição de tarefas a partir pequenas trajetórias gravadas em qualquer um dos modos de controle.
5.1.4	Controle Via Mouse Espacial
Objetivo principal do trabalho, foi o último modo a ser testado, uma vez que dependia do bom funcionamento das funções de controle via teclado.
Como os ângulos de junta são calculados a partir dos valores das tensões dos potenciómetros, foram necessários ajustes nos valores de tensão lidos do manipulador antes de transformá-los em ângulos e aplicá-los aos modelos direto e inverso, devido à dependência das juntas 2 e 3 ( os potenciómetros destas duas juntas estão localizados no eixo de rotação da junta 2). Da mesma forma, transformação oposta é necessária para obter os valores de tensão a serem enviados ao manipulador a partir dos ângulos obtidos no modelo inverso.
As tensões lidas nos potenciómetros do manipulador são proporcionais às tensões enviadas pelo "niaster" ou microcomputador, e estas proporcionalidades são obtidas na calibração do sistema e armazenadas na caixa de controle de Kraft. Portanto, para cada calibração existe um conjunto de constantes diferentes.
Como o modelo inverso trabalha com ângulos (tensões) obtidas diretamente do manipulador, foi necessário descobrir a relação existente entre estes ângulos e a tensão enviada pelo microcomputador (na função de ”master”) para obtenção de tais ângulos, ou seja, obter os parâmetros Ki e Ci da seguinte equação :
Oi = KíTí + Ci	(5.1)
onde :
-	&amp;amp;i = ângulo da i-ésima junta do manipulador; e
—	Ti = tensão a ser enviada pelo microcomputador para a i-ésima junta.
Para isto, utilizando a rotina de calibração , foram obtilos dois valores distintos de
tensão do ’’master” e do ’’slave” (índices 1 e 2 na equação 5.2) para cada junta, e as constantes puderam ser calculadas resolvendo os seguintes sistemas de equações :
(5-2)
Isto feito, foi possível calcular a tensão necessária para levar o manipulador para a posição desejada:
(5.3)
Feitas as devidas transformações , o sistema foi ligado e testado.
5.2	Conclusões
—	O sistema no modo ”m áster-slave” manteve todas as funções originais e ganhou a possibilidade de arquivar trajetórias inteiras ou pontos para criação de trajetórias ’’offline”;
—	0 modo de controle via teclado mostrou-se bastante útil para movimentos nas proximidades do objeto, quando apenas determinada junta deve ser movimentada;
—	0 modo de controle automático mostrou ser possível e bastante útil armazenar trajetórias para posterior uso;
—	O modo de controle via Mouse Espacial mostrou-se bastante útil e prático, principalmente em se tratando de movimentos com maior exigência de controle na orientação da garra;
—	0 modelo implementado mostrou-se bastante eficaz e rápido, não sendo fator limitante na questão de resposta em tempo real;
—	0 sistema Kraft tem uma grande dependência do ’’master”, mas o controle via microcomputador mostrou-se viável e bastante útil, tanto no modo de controle via teclado quanto no modo de controle via Mouse Espacial,
5.3	Sugestões para Trabalhos Futuros
—	Um dos objetivos do trabalho foi a minimiz ação do tempo de inicialização do sistema através do uso do Mouse Espacial. Uma possibilidade de melhorar ainda mais este tempo seria construir uma nova caixa de controle para o sistema, de forma que a dependência do ’’master” pudesse ser eliminada.
—	Um dos motivos da escolha do modelo implementado foi o esforço computacional. Seria interessante uma comparação quantitativa entre este modelo e o modelo usando a sistemática de Denavit-Hartenberg, o qual ainda é bastante usado atualmente.
—	Seria interessante a implementação de um Mouse Espacial com realimentação de força, o que seria muito útil para aplicações deste tipo.
—	Seria interessante implementar um sistema no qual o Mouse Espacial fosse impedido de continuar o movimento quando algum ângulo de junta estivesse para sair do limite permitido pelo modelo inverso do manipulador. Isto evitaria des acoplamentos indesejados.
Bibliografia
[1]	Spong, M. W.; Vidyasagar, M.; Robot Dynamics and Control; John Wiley &amp;amp; Sons, Inc.;
1989.
[2]	Underwater Manipulator System; Kraft TeleRobotics, Inc.; 1985.
[3]	Cruz, J.M Projeto e Desenvolvimento de um Sistema de Geração Automática de Trajetória para Manipuladores; Tese de Mestrado; 1993.
[4]	Duffy, J.; Analysis of Mechanisms and Robot Manipulators; John Wiley &amp;amp; Sons, Inc,; 1980.
Apêndice A
Características Técnicas do Manipulador
Kraft
A.l Especificações Gerais
Máximo alcance Capacidade de carga com o braço extendido Graus de liberdade de movimento	130 cm 34 kg 6 (+ abrir/fechar garra)
A.2 Efetuador
Padrão Abertura máxima da garra Força de fechamento da garra Método de controle	Garra paralela 10 cm 90 kg Força proporcional
A.3 Movimento das Juntas
Eixos	Excursão (graus)	Velocidade (graus/s)
Shoulder azimuth	180	80
Shoulder elevation	120	65
Elbow pivot	110	50
Wrist pitch	100	100
Wrist yaw	105	115
Wrist rotate:		
Mo do 1 (slaved)	180	200
Mo do 2 (continuo)	—	210
Estes movimentos são mostrados na figura A.l a seguir.
WRIST PITCH
DA
SHOULDER
AZIMUTH
* SHOULDER ELEVATE
WRIST ROTATE
MODO 3 (CONTINUO)
MAXIMA
ABERTURA GARRA (10 em)
WRIST ROTATE
MODO 1 (SLAVED)
Figura A.l: Movimentos das Juntas do Manipulador Kraft.
Apêndice B
Listagem dos Modelos Implementados
#include&amp;lt;stdio.h&gt;
#include&amp;lt;conio.h&gt;
#include&amp;lt;stdlib.h&gt;
#include&amp;lt;dos.h&gt;
#include&amp;lt;math.h&gt;
#include "beginl.h."
int Kraftlnv (double *G_, double *S6_, double *a67_,double *phi„tetas); void KraftDir (double *phi_tetas, double *G_, double *S6_, double *a67_); void trassforma(double beta, double X[3], double X0[3]);
void salva„phitetas(void);
double sup3,phi_tetas [8] ,G_[3] ,omi_[3] ;
double S6_[3],a67_[3],si[3];
int I;
/**********************************************************************
* MODELO CINEMATICO INVERSO	4
************************************************************* *********y,'
#define DotProd(x,y) (x[0]*y[0] + x(l]*y[l] + x[2]*y£2j)
#define sign(x) ((x&gt;-0)~(x&lt;0))
#define quad(x) ((x)*(x))
/ *************************************************************************
*	-	A íuncao deve retomar	um valor inteiro	nao	nulo	se	existir	solucao.*
*	-	0 array phi_tetas deve	ter espaço	para	8	componentes,	ou	seja:	*
*	phi_tetas£0] - phii	*
*	ph.i_tetas [1.. . 7] = tetal...teta7	*
*************************************************************************/
int Kraftlnv (double *G_, double *S6_, double *a67_,
double *phi„tetas)
&lt;
double /*ld_keep,*/keep,keep2; /* variavel de uso generico e temporário ♦/
double S7i„[3j; /* 0 underscore indica que a variavel e um vetor com componentes nos eixos x, y e 2. 0 "i” substitui a interrogação usada no desenvolvimento analítico,
ou seja, S7i„ aqui = S7? la. */
double DEU;	/* denominador da eq.(S) ♦/
double S7, SI, a71, lambda, sig.lam;
double S7„[3], a71_[3], ALFA71, ALFA67;
double eta;
double A71_C3];
double /*X7, Y7,*/ X17, Y17, teta6, teta6_linha,teta5;
double P,Q,c2,s2,/*Xl,Yl,*/X71,Y71,Z17;
S7i„[0] = a67_[1]*S6_[2] - S6„[l]*a67„[2] ;
S7i_[lJ = a67„ [2] *S6„ [0] - S6_ [2] *a67_ [0] ;
S7i_C2] = a67_C0]*S6_[ll - S6_[0]*a67_ [1] ;
******************************
* Calculo de teta[7] =&gt; phi„tetas[7j * *************************************/
DEN = quad(S7i„ [0] ) + quad(S7i„[l] ) ;
if ((0&lt;=DEN) &amp;amp;&amp;amp; (DENO3.0E-8)) /♦ conforme analise feita para a eq.(5) */
&lt;
S7 = 0; /* comprimento do lado do polígono espacial ao longo do vetor S7_ */ S7_[0] = S7i_t0];
S7„[l] = S7i_Cl];
S7_[2] = S7i„[2];
SI = SO - G_[2] ;
a71 = sqrt( quad(G_[0]) + quad(G_[l]) );
if (a71==0)
&lt;
a71„[0j « a67_[0];
a71_[lj = a67_[lj;
a71_[2] = a67_[2];
else
&lt;
a71_£0] = -G_[0]/a71;
a71_[lj = -G_[l]/a71;
a71_[2] = 0;
ALFA67 - PI_2;
keep - DotProd(a71„&gt;a67„);
if (fabs(keep)&lt;=1.OE-8)
phi_tetas[7] ~ PI„2 * sign(DotProd(a71_&gt;S6„)); else
phi_tetas[7] * atan2(DotProd(a71_,S6„) ,keep) ;
if (S7„[2]&lt;0)
ALFA71 - PI;
else
ALFA71 - 0;
}
else	/♦ DEN fora do intervalo considerado zero ♦/
&lt;
lambda = ~(G_[0]*S7i_[0] + G_[l] *S7i_[l] )/DEN;
S7 - fabs(lambda);
sig„lam = sign(lambda);
S7_[0] = sig„lam*S7i_[0] ;
S7_£1J = sig„lam*S7i_[l] ;
S7-E2J = sig„lam*S7i_[2];
eta = G_[2] + lambda*S7i_[2];	/* eq,(6) */
SI ~ S0 - eta;	/* eq.(10) */
A71_[0] = -(G„[0] + lambda*S7i_£0j );
A71_[lj = -(G„[1J + lambda*S7i„[l]);
A71_[2] = eta - (G_ [2] + lambda*S7i_[2]);
a71 = sqrt (quad(A71_ [0] )+quad(A7í_[l] )+quad(A71_ [2] ) ) ; /♦ eq.(13) */ ií (a7K=1.0E-8)
&lt;
a71_£0] = S7_£ll; a71_[l] = - S7„[0]; a71_[2] = 0;
/♦ eq.(15’) */
else
a71_£0j = A71_[0]/a71;
a71„[l] = A71_£l]/a71;
a71_[2] = A71_[2]/a7í;
&gt;
ALFA67 = PI_2 * (2 - sign(lambda)); keep - DotProd(a71_,a67_);
if (fabs(keep)&lt;=1.OE-8)
ph.i_tetas£7] = PI_2 * sign(lambda)*sign(DotProd(a71_,S6_)); /*
else	....."..	. ---	-
/*
/*
eq.(IS)
eq.(16)
*/
♦/
eq.(17) */
phi_tetas[7] = sign(lambda)*atan2(DotProd(a71_f S6_) ,keep) ;
ALFA71 = atan2(a71__[0]*S7_[l] - a71_ [1] *S7„[0] ,S7„[2] );	/* eq.(18) */
}
/*********************************
*	Calculo de phi =&gt; phi_tetas[O] *
*********************************/
/* phil-tetal (eq.18) sera armazenado temporariamante em phi_tetas[O]
(lugar de ph.il) ate que tetal seja calculado */
phi_tetas[O] = atan2(a71„[1] ,a71„[0] ) ; /* (-PI^PI] */
phi_tetas[O] s= phi_tetas[Oj + PI2*(phi_tetas[0]&lt;0); /* [0,2PI) */
/*************************************
*	Calculo de tetaCl] =&gt; phi_tetas[l] *
*************************************/
/********************
*	Calculo de phi[l] *
********************/
keep2 = S6*sin(ALFA67)*sin(phi„tetas[7j)ta71;
keep = S7*sin(ALFA71) +S6*cos (ALFA71)*sin(ALFA67)*cos(phi_tetas [7] ) ;
if ( (fabs(keep)&lt;=:l. 0E"12)&amp;amp;&amp;amp;(fabs (keep2)&lt;=l. OE-12) )
return 1;	/* Teta[l] indeterminado ♦/
keep = atan2(keep,keep2);	/* tetal (-PI.PI] */
keep2 ~ keep + phi_tetas[0];	/* phil (~PI,3PI] ♦/
keep2 = keep2 - PI2*(keep2&gt;PI); /♦ phil (~PI,PI] */
if ((infl&gt;keep2) II (keep2&gt;supl))	/* teste dos limites ♦/
{	/* de phi[lj	*/
keep2 ~ keep2 + PI; /* segunda solucao para phil (0,2PIj */ phi_tetas[O] = keep2 - PI2*(keep2&gt;PI);	/* phil (-PIjPI] */
keep = keep + PI; /*tetal (0&gt;2PI) */
phi_tetas[l] - keep - PI2*(keep&gt;PI);	/* tetal (-PI,PI] */
if ((infl&gt;phi_tetas[Oj) II (phi_tetas[O]&gt;supl))
return 11;
else /♦ Primeira solucao boa. A segunda cert ament e esta fora dos limites*/
phi_tetas[Oj - keep2; /* phil (-PI,PI) */
phi_tetas[l] = keep; /* tetal ("PI^PI) */
&gt;
/***#******#********+*
*	Calculo de teta[6] *
**********^**********/
X17 = sin(phi„tetas [11 )*cos(phi_tetas [7] )+cos(ALFA71)*cos(phi_tetas [1] ) *sin(phi_tetas[7]);
Y17 = sin(ALFA67)*sin(ALFA71)*cos(phi„tetas[1]);
teta6 = atan2(Y17,~X17);	/* teta6 (~PI,PIJ */
teta.6_li.nha = teta6 + PI;	/* teta6_linha C0&gt;2PI) */
teta6„linha = teta6_linha ~ PI2*(teta6_linha&gt;PI); /* teta6„linha (-PIjPI]*/
Z17 = sin(ALFA67)*(sin(phi_tetas[l] )*sin(phi_tetas[73 )
-cos(ALFA71)*cos(phi„tetas[1])*cos(phi_tetas[7] ));
if(fabs(cos(teta6))&gt;.71) /* Icos(teta6)I&gt;Isen(teta6)| */
tetaS = atan2(-X17/cos(tetaô) ,Z17);	/* ("PI,PI] (eq.55)*/
else
tetaS = atan2(Y17/sin(teta6) ,Z17) ;	/* (~PI,PI] (eq.56)*/
if ((teta6&gt;-inf6) &amp;amp;&amp;amp; (teta6&lt;-sup6))
&lt;
/+*#***+++*+******+***
*	Calculo de teta[S3 ♦
****************+****/
if ((inf5&lt;=teta5) &amp;amp;&amp;amp; (teta5&lt;=sup5)) /* teste dos limites */
•{ phi_tetas[6] - tetaS; phi_tetas [5]=teta5;}	/* de teta[5] ♦/
else
if ((inf6&lt;=teta6_lmha) &amp;amp;&amp;amp; (teta6_linha&lt;=sup6))
&lt;
tetaS = -tetaS; /* [~PI,PI) eq.SS ♦/
if((teta5&gt;=infS)&amp;amp;&amp;amp;(tetaS&lt;=supS) )
i phi_tetas[63 =teta6_linha; phi_tetas[5]=teta5;}
else
return 55;	/* teta[5] fora dos limites */
}
else
return 66;	/* teta[53 e teta[63 fora dos limites ♦/
else
&lt;
if ( (t et a6 _1inha&gt;- inf 6 )	(t e t a6 _1 inha&lt;“ sup6 ) )
&lt;
tetaS = -tetaS;
if ((teta5&gt;=inf 5)&amp;amp;&amp;amp;(teta5&lt;=sup5))
{ phi_tetas[6]-teta6_linha; phi.tetas[53-tetaS;} else
return 55;
}
else
return 66;
}
/*********************
*	Calculo de teta [3] *
X71 = sin(ALFA67)*sin(phi„tetas[7] )*cos (phi„tetas [1] ) +
sin(ALFA67)*cos(ALFA71)*cos(phi__tetas [7] )*sin(phi_tetas[1] ) ;
Y71 = sin(ALFA67)*sin(ALFA71)*cos(phi_tetas [73 ) ;
keep = (a45/sin(phi_tetas[5]))+S6;
P = keep*X71+(S5/sin(phi_tetas[5] ) )*Y71+S7*sin(ALFA71)*sin(phi._tetas [1] )
+a7l*cos(phi_tetas[1]);
Q = keep*Y71-(S5/sin(phi_tetas[5] ))*X71-S7*cos(ALFA71)-Sl;
keep=(P*P+Q*Q-a23*a23~a34*a34)/(2.0*a23*a34);
if((keep&lt;"l)I I(keep)&gt;l)
return 99;
phi„tetas[33 = -acos(keep);
if (finf3&gt;phi„tetas[33) II (phi_tetas[3]&gt;sup3_maior)) /* teste dos limites*/
return 33;	/* de teta[33	*/
/♦ Para sabermos se teta3 esta ok, precisamos saber o valor de teta2,
pois o limite superior de teta3 depende de teta2*/
/*+*++*+++*+*****+****
*	Calculo de teta[2] *
***#*****************/
keep=a23+a34*cos (ph.i_tetas [3]);
keep2=a34*sin(phi_tetas[33);
c2 = (Q*keep2~P*keep)/(quad(keep)+quad(keep2));
s2 ~ (P+keep*c2)/keep2;
* ou :	*
* s2 - (Q-keep2*c2)/keep;	*
+ ^**3(t*ii:* + ^*4: + + ** + **** + **4:*** + ** + + *********** + **4:**^^**:#****/
phi„tetas[2] - atan2(s2,c2);	/* (-PI,PI) */
if ( (inf 2&gt;phi_tetas [2] ) El (phi_tetas [2] &gt;sup2))	/* teste dos limites */
return 22;	/♦ de teta[2]	*/
sup3 = sup3_maior-(phi_tetas [2]-inf2)*(sup3_maior-sup3_menor)/(sup2-inf 2) ;
if (phi_tetas [3] &gt;sup3)
return 33;
/a*********************
* Calculo de teta[4] *
#$*******************/
if((fabs(X71)&lt;=i.0E-12)&amp;amp;&amp;amp;(fabs(Y7i)&lt;=1.0E~12))
return 4;	/* Teta[4] indeterminado */
phi_tetas[4] = atan2(-Y71 ,X71) - (phi_tetas [2]+phi_tetas [3] );	/* (~PI,PI) */
if ( (inf4&gt;phi_tetas [4] ) II (phi_tetas[4]&gt;sup4)) /* teste dos limites*/ return 44;	/♦ de teta[4] */
return 8;
}
/** + ************** + ************************ ******* + *************4:******
* MODELO CINEMATICO DIRETO	*
***************************$***************+**************************/
void KraftDir (double *phi_tetas, double *G_t double *S6_, double *a67_)
&lt;
double temp, tempi;
double /*Si„[3ji*/ a23_[3j, a34„[3], a45_t3], S5_[3],
a67_linhaE3] , G_linha[3] , S6_linhaE3] ;
/* S1_CO] = 0; Sl„[l] - 0;	Sl_[2] = 1;*/
a23_[0] - cos (phi_tetas [2] );	a23_[i] = sin(phi_tetas [2] ) ; a23_[2] = 0;
tempi = phi_tetas[2] + phi_tetas [3] ;
a34_[0] = cos(templ); a34_[l] = sin(templ); a34_[2] - 0;
temp = tempi + phi_tetas [4] ;
a45„[0j = cos(temp); a45_[l] = sin(temp); a45_[21 = 0;
S5_ [01 = — sin(temp); S5„[ll = cos(temp); S5_[21 = 0;
S6„linha[01 - sin(phi_tetas[51)*cos(temp);
S6_linhaEl] = sin(phi_tetas [5] )*sin(temp);
S6„linha[21 - cos (phi„tetas [5] ) ;
a67_linha [0] = -sin(temp)*sin(phi_tetas [6] )+cos(temp)*cos(phi_tetas [5j ) *cos(phi_tetas[61);
a67_linha[ll = cos(temp)*sin(phi„tetas[6] )+sin(temp)*cos(phi__tetas [51 ) ♦cos(phi„tetas[61);
a67_linha[2] = -~s in (phi_tetas [51 )*cos (phi_tetas [6] ) ;
G„linha[Oj = a23*a23„[01+a34*a34„[01+a45+a45_[01+S5*S5_[0] +S6*S6_linha[0];
G_linha[ll = a23*a23„[ll+a34*a34_[l] +a45*a45_ [1]+S5+S5_ [1] +S6*S6_linha[1] ;
G_linha[2j = a23*a23_ [21 +a34*a34_ [2] +a45*a45_ [2]+S5+S5_[2] +S6*S6_linha[2] ;
transí orma (phi _t etas [01,a67_linha, a67__) ; transforma(phi_tetas[01 ,S6_linha,S6_);
transí orma (phi _t etas [01,G_linha,G_) ;
G_ [21 = G_[21 + SO;
si[01 = - a67_[l]*S6_[2] + S6_[ll*a67_[2] ;
si[l] = - a67_[21*S6_[0] + S6_ [21 *a67_ [0] ;
si[21 = - a67„[01*S6_[l] + S6_[0&gt;a67_[l] ;
}
void trans forma (double teta, double X[3j, double X0[3])
&lt;
X0[0j = X[01*cos(teta) + X[21*sin(teta);
X0[l] = X[0]*sin(teta) - X[21*cos(teta);
X0[2j = XCU;
&gt;</field>
	</doc>
</add>