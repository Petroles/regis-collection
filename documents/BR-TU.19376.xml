<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19376</field>
		<field name="filename">2709_Dissertacao_MarioTUchiyamaJr_unprotected.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
MÁRIO TOMIYOSHI UCHIYAMA JUNIOR 

 

 

 

 

 

 

 

 

 

 

 

 

CONTROLE PREDITIVO APLICADO AO PROCESSAMENTO 

PRIMÁRIO DE PETRÓLEO 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

São Paulo 

2013 

2013  



  

MÁRIO TOMIYOSHI UCHIYAMA JUNIOR 

 

 

 

 

 

 

 

 

 

 

 

 

CONTROLE PREDITIVO APLICADO AO PROCESSAMENTO 

PRIMÁRIO DE PETRÓLEO 

 

 

 

 

 

 

 

 

 

 

Dissertação apresentada à Escola 
Politécnica da Universidade de São 
Paulo para a obtenção do título de 
Mestre em Engenharia 
 
 
 
 

 

 

 

 

 

São Paulo 

2013 

2013  



 

MÁRIO TOMIYOSHI UCHIYAMA JUNIOR 

 

 

 

 

 

 

 

 

 

 

 

 

CONTROLE PREDITIVO APLICADO AO PROCESSAMENTO 

PRIMÁRIO DE PETRÓLEO 

 

 

 

 

 

 

 

 

 

 

 

 

 

Dissertação apresentada à Escola 
Politécnica da Universidade de São 
Paulo para a obtenção do título de 
Mestre em Engenharia 
 
Área de Concentração: Engenharia 
Química 
 
Orientador: Prof. Dr. Darci Odloak 
 
 
 

 

 

 

São Paulo 

2013 

2013  



 

 

Este exemplar foi revisado e corrigido em relação à versão original, sob 
responsabilidade única do autor e com a anuência de seu orientador. 
 
São Paulo,      de maio de 2013. 
 

 

Assinatura do autor   ____________________________ 
 
 

Assinatura do orientador   _______________________ 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
 
 
 

FICHA CATALOGRÁFICA 

 
 
 

FICHA CATALOGRÁFICA 
 

DEDICATÓRIA 

 

 

 

 

 

 

  

 
 
Uchiyama Junior, Mário Tomiyoshi 

Controle preditivo aplicado ao processamento primário de 
petróleo / M.T. Uchiyama Junior. – versão corr. -- São Paulo, 
2013. 

89 p. 
 

Dissertação (Mestrado) - Escola Politécnica da Universidade  
de São Paulo. Departamento de Engenharia Química. 
 

1. Controle de processos 2. Controle preditivo 3. Petróleo 
I. Universidade de São Paulo. Escola Politécnica. Departamento 
de Engenharia Química II. t. 

 



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Aos meus pais Suely e Mário. 

 

  



 

 

AGRADECIMENTOS 

 

 

Ao Prof. Dr. Darci Odloak pelo apoio, compreensão e ajuda durante a elaboração 

dessa dissertação. 

 

Aos membros da banca de qualificação, pelas sugestões de melhoria e correções. 

 

Aos meus pais por sempre me apoiar. 

 

A minha namorada Maria Giuliana, pela compreensão e pelo apoio nessa etapa da 

minha vida. 

 

Ao engenheiro Bruno, pela amizade e pela ajuda durante o desenvolvimento dessa 

dissertação. 

 

A Deus, por me dar força para superar todas as dificuldades enfrentadas nessa 

jornada. 

  



 

 

RESUMO 

 

 

Esta dissertação estuda o controle multivariável de uma plataforma "offshore" típica. 

Com esse propósito, um modelo dinâmico rigoroso do processo não-linear foi 

desenvolvido e usado para representar o processo real nas simulações das 

estratégias de controle propostas. Baseado no modelo rigoroso e usando métodos 

de identificação, foram desenvolvidos modelos lineares aproximados para 

representar o processo no controlador preditivo (MPC). O sistema de controle foi 

projetado visando manter as variáveis controladas em valores adequados e reduzir o 

efeito de golfadas severas nos equipamentos à jusante da plataforma. Foram 

testados dois controladores preditivos: o MPC convencional que opera com "set-

points" fixos para as variáveis controladas e o controlador preditivo que opera com 

zonas para as variáveis controladas. Os resultados da simulação mostram que o 

controlador preditivo com controle por zonas é capaz de ter uma performance bem 

melhor que o controlador preditivo convencional, com uma significativa redução na 

amplitude das oscilações causadas pelas golfadas na vazão de petróleo na saída da 

plataforma. 

 

 

Palavras-chave: Plataformas de petróleo. Controle preditivo. Atenuação de golfadas. 

  



 

 

ABSTRACT 

 

 

This dissertation studies the multivariable control of a typical offshore platform. For 

this purpose, a rigorous nonlinear dynamic model of the process system is developed 

and used to represent the true process in the simulation of the proposed control 

strategies. Based on this rigorous model, approximate linear models are obtained 

through identification methods in order to represent the platform process in the Model 

Predictive Control (MPC). The control system was designed aimed at keeping all the 

controlled variables at adequate values and to reduce the effect of severe riser 

slugging on the downstream systems. Two model predictive controllers are tested: 

the conventional MPC with fixed set-points to the controlled outputs and the MPC 

with zone control of the outputs. The simulation results show that the controller based 

on the output zone control has a better performance than the conventional MPC with 

a significant reduction on the amplitude of the oscillation of oil flow at the outlet of the 

platform process. 

 

 

Keywords: Platform. Model Predictive Control. Riser slugging attenuation. 

  



 

 

LISTA DE FIGURAS 

 

 

Figura 3-1 - Representação das fases de um ciclo de golfada. Nunes et at (2010) .. 19 

Figura 3-2 - Elevação artificial de petróleo por tecnologia Gas-Lift. Nunes et al (2010)

 .................................................................................................................................. 21 

Figura 3-3 - Planta trifásica de processamento primário de petróleo. Nunes et al 

(2010) ........................................................................................................................ 22 

Figura 3-4 - Separador Trifásico. Nunes et al (2010) ................................................ 27 

Figura 3-5 - Separador Bifásico. Nunes et al (2010) ................................................. 33 

Figura 3-6 - Tratador eletrostático. Nunes et al (2010) .............................................. 36 

Figura 3-7 - Hidrociclone de-oiler. Moraes (1994) ..................................................... 41 

Figura 4-1 - Planta de separação trifásica com indicação das variáveis controladas e 

manipuladas. ............................................................................................................. 44 

Figura 4-2 - Planta trifásica de processamento primário de petróleo com os 

controladores do tipo PI. ........................................................................................... 46 

Figura 4-3 - Resposta de y1 ao estímulo em u7. ........................................................ 48 

Figura 4-4 - Resposta de y1 ao estímulo em u8. ........................................................ 49 

Figura 4-5 - Resposta de y2 ao estímulo em u1. ........................................................ 49 

Figura 4-6 - Resposta de y2 ao estímulo em u2. ........................................................ 50 

Figura 4-7 - Resposta de y3 ao estímulo em u1. ........................................................ 50 

Figura 4-8 - Resposta de y3 ao estímulo em u2. ........................................................ 51 

Figura 4-9 - Resposta de y3 ao estímulo em u7. ........................................................ 51 

Figura 4-10 - Resposta de y4 ao estímulo em u2. ...................................................... 52 

Figura 4-11 - Resposta de y4 ao estímulo em u4. ...................................................... 52 

Figura 4-12 - Resposta de y5 ao estímulo em u2. ...................................................... 53 

Figura 4-13 - Resposta de y5 ao estímulo em u3. ...................................................... 53 

Figura 4-14 - Resposta de y5 ao estímulo em u4. ...................................................... 54 

Figura 4-15 - Resposta de y6 ao estímulo em u4. ...................................................... 54 

Figura 4-16 - Resposta de y6 ao estímulo em u9. ...................................................... 55 

Figura 4-17 - Resposta de y7 ao estímulo em u4. ...................................................... 55 

Figura 4-18 - Resposta de y7 ao estímulo em u6. ...................................................... 56 

Figura 4-19 - Resposta de y8 ao estímulo em u4. ...................................................... 56 



 

 

Figura 4-20 - Resposta de y8 ao estímulo em u5. ...................................................... 57 

Figura 4-21 - Resposta de y8 ao estímulo em u6. ...................................................... 57 

Figura 5-1 - Vazão de saída de óleo do poço............................................................ 72 

Figura 5-2 - Nível de água no Separador Trifásico. ................................................... 72 

Figura 5-3 - Nível de óleo no Separador Trifásico. .................................................... 73 

Figura 5-4 - Pressão no Separador Trifásico............................................................. 73 

Figura 5-5 - Nível de óleo no Separador Bifásico 1. .................................................. 74 

Figura 5-6 - Pressão no Separador Bifásico 1........................................................... 74 

Figura 5-7 - Nível no Tratador Eletrostático............................................................... 75 

Figura 5-8 - Nível de óleo no Separador Bifásico 2. .................................................. 75 

Figura 5-9 - Pressão no Separador Bifásico 2........................................................... 76 

Figura 5-10 - Vazão de óleo saída do Separador Bifásico 2 ..................................... 76 

Figura 5-11 - Vazão de saída de óleo do poço.......................................................... 79 

Figura 5-12 - Nível de água no Separador Trifásico. ................................................. 80 

Figura 5-13 - Nível de óleo no Separador Trifásico. .................................................. 80 

Figura 5-14 - Pressão no Separador Trifásico........................................................... 81 

Figura 5-15 - Nível no Separador Bifásico 1.............................................................. 81 

Figura 5-16 - Pressão no Separador Bifásico 1. ........................................................ 82 

Figura 5-17 - Nível do Tratador Eletrostático............................................................. 82 

Figura 5-18 - Nível no Separador Bifásico 2.............................................................. 83 

Figura 5-19 - Pressão no Separador Bifásico 2. ........................................................ 83 

Figura 5-20 - Vazão de óleo do Separador Bifásico 2. .............................................. 84 

Figura 5-21 - Vazão de óleo da Planta para o MPC convencional (com set-points 

fixos) e MPC com faixas. ........................................................................................... 85 

 

  



 

 

LISTA DE TABELAS 

 

 

Tabela 4-1 - Variáveis controladas do sistema. ......................................................... 45 

Tabela 4-2 - Variáveis manipuladas do sistema. ....................................................... 45 

Tabela 4-3 - Aberturas iniciais das válvulas, variações das aberturas das válvulas e 

intervalos entre as implementações das ações de controle que foram adotadas para 

cada variável manipulada. ......................................................................................... 47 

Tabela 4-4 - Combinação variável controlada-variável manipulada. ......................... 48 

Tabela 4-5 - Modelo em funções de transferência da plataforma de petróleo .......... 59 

Tabela 5-1 - Valor inicial, mínimo e máximo das variáveis manipuladas do sistema.70 

Tabela 5-2 - Valor inicial e set-points das variáveis controladas do sistema. ............ 71 

Tabela 5-3 - Sintonia utilizada. .................................................................................. 71 

Tabela 5-4 - Valor inicial, mínimo e máximo das variáveis manipuladas do sistema.78 

Tabela 5-5 - Valor inicial, mínimo e máximo das variáveis controladas do sistema. . 78 

Tabela 5-6 - Sintonia utilizada. .................................................................................. 79 

 

  



 

 

LISTA DE SÍMBOLOS 

 

 

Ar 
Área da secção transversal da coluna de produção abaixo do 
ponto de injeção 

(m
2
) 

At 
Área da secção transversal da coluna de produção acima do 
ponto de injeção 

(m
2
) 

BSW Fração de água e sedimentos presente na carga oleosa 
 

C Comprimento do vaso (m) 

C1 Comprimento do vaso do separador bifásico (m) 

C2 Comprimento do vaso do tratador eletrostático (m) 

CCL Comprimento da câmara de óleo (m) 

CCS Comprimento da câmara de separação (m) 

Civ Constante de injeção de gás na coluna de produção 
 

Cpc Constante da choke de produção 
 

Cr 
Constante de saída de petróleo do reservatório para a coluna 
de produção  

CVG Coeficiente de vazão da válvula de gás 
 

CVL Coeficiente de vazão da válvula de óleo 
 

CVo Coeficiente de vazão da válvula de óleo de topo 
 

CVu Coeficiente de vazão da válvula de água de fundo 
 

CVW Coeficiente de vazão da válvula de água 
 

D Diâmetro do vaso (m) 

D1 Diâmetro do vaso do separador bifásico (m) 

D2 Diâmetro do vaso do tratador eletrostático (m) 

e 
Eficiência de separação da água emulsionada presente na 
carga oleosa  

g Constante de aceleração da gravidade (m/s
2
) 

Gin Vazão de entrada de gás (m
3
/s) 

Gout Vazão de saída de gás (m
3
/s) 

hL Altura fase oleosa (m) 

hT Altura total de líquido (m) 

hVERT Altura do vertedouro (m) 

hW Altura da fase aquosa (m) 

La Comprimento da região anular (m) 

Lin Vazão de entrada da fase líquida (m
3
/s) 

Lout Vazão de saída de óleo (m
3
/s) 

Lr Comprimento do reservatório até o ponto de injeção de gás (m) 

Lt Comprimento da coluna de produção (m) 

LVERT Vazão através do vertedouro (m
3
/s) 

M Massa molar do gás natural (kg/mol) 

P Pressão no separador (bar) 

P1 Pressão a jusante da válvula de óleo (bar) 

P2 Pressão à jusante da válvula de gás (bar) 

P3 Pressão à jusante da válvula de água (bar) 



 

 

Pai Pressão na região anular no ponto de injeção (bar) 

Po Pressão na descarga na linha de topo (bar) 

Pr Pressão no reservatório (bar) 

Ps Pressão no separador trifásico (bar) 

Pt Pressão no topo da coluna de produção (bar) 

Ptb Pressão no fundo da coluna de produção (bar) 

Pti Pressão na coluna de produção no ponto de injeção (bar) 

Pu Pressão na descarga na linha de fundo (bar) 

R Constante universal dos gases (J/mol.K) 

Ta Temperatura do gás natural na região anular (K) 

Tt Temperatura na coluna de produção (K) 

u1 Abertura da válvula de saída de gás do separador trifásico 
 

u10 
Abertura da válvula de saída de rejeito de óleo/água do 
hidrociclone do tratador eletrostático  

u2 Abertura da válvula de saída de óleo do separador trifásico 
 

u3 Abertura da válvula de saída de gás do separador bifásico 1 
 

u4 Abertura da válvula de saída de óleo do tratador eletrostático 
 

u5 Abertura da válvula de saída de gás do separador bifásico 2 
 

u6 Abertura da válvula de saída de óleo do separador bifásico 2 
 

u7 
Abertura da válvula de saída de água do hidrociclone do 
separador trifásico  

u8 
Abertura da válvula de saída de rejeito de óleo/água no 
hidrociclone do separador trifásico  

u9 
Abertura da válvula de saída de água do hidrociclone do 
tratador eletrostático  

V Volume do vaso (m
3
) 

Va Volume da região anular (m
3
) 

VL Volume da fase oleosa (m
3
) 

vO Volume específico do petróleo (m
3
/kg) 

VT Volume da fase líquida na câmara de separação (m
3
) 

VW Volume da fase aquosa (m
3
) 

VWFL 
Volume de água dispersa na fase oleosa no separador 
eletrostático 

(m
3
) 

VWFLCL Volume de água dispersa na fase oleosa na câmara de óleo (m
3
) 

VWFLCS 
Volume de água dispersa na fase oleosa na câmara de 
separação 

(m
3
) 

wgc Vazão mássica constante de gás injetado na região anular (kg/s) 

wiv 
Vazão mássica que vai da região anular para a coluna de 
produção 

(kg/s) 

Wo Vazão de saída de topo (kg/s) 

Wout Vazão de saída de água (m
3
/s) 

wpc Vazão mássica total através do choke de produção (kg/s) 

wpg Vazão mássica de gás através da choke de produção (kg/s) 

wpo 
Vazão mássica de petróleo produzido através da choke de 
produção 

(kg/s) 

wr 
Vazão mássica de petróleo do reservatório para a coluna de 
produção 

(kg/s) 



 

 

Wu Vazão de saída de fundo (kg/s) 

x1 Massa de gás na região anular (kg) 

x2 Massa de gás na coluna de produção (kg) 

x3 Massa de petróleo na coluna de produção (kg) 

xG Fração de abertura da válvula de gás 
 

xL Fração de abertura da válvula de óleo 
 

xo Fração de abertura da válvula de topo 
 

xp Fração de abertura da válvula choke de produção 
 

xu Fração de abertura da válvula de fundo 
 

xW Fração de abertura da válvula de água 
 

y1 Nível da água na câmara de separação do separador trifásico (m) 

y2 Nível da câmara de óleo do separador trifásico (m) 

y3 Pressão do separador trifásico (bar) 

y4 Nível do separador bifásico 1 (m) 

y5 Pressão do separador bifásico 1 (bar) 

y6 Nível do tratador eletrostático (m) 

y7 Nível do separador bifásico 2 (m) 

y8 Pressão do separador bifásico 2 (bar) 

ygás/líquido 
Fração da corrente de alimentação líquida que passa para a 
fase gasosa na condição de temperatura e pressão do 
equipamento seguinte 

 

 

Símbolos gregos: 

 

?1 Parâmetro de ajuste do modelo para perda de carga 
 

?2 Parâmetro de ajuste do modelo para perda de carga 
 

?ai Massa específica do gás na região anular no ponto de injeção (kg/m
3
) 

?G Massa específica da fase oleosa (kg/m
3
) 

?H2O,15,5°C Massa específica da água a 15,5°C (kg/m
3
) 

?L Massa específica da fase oleosa (kg/m
3
) 

?m 
Massa específica da mistura petróleo e gás no topo da coluna 
de produção 

(kg/m
3
) 

?o Massa específica do petróleo (kg/m
3
) 

?Po 
Diferença de pressão entre a corrente de alimentação e a 
corrente de descarga de topo 

(bar) 

?Pu 
Diferença de pressão entre a corrente de alimentação e a 
corrente de descarga de fundo 

(bar) 

?u Massa específica da saída de fundo (kg/m
3
) 

?W Massa específica da fase aquosa (kg/m
3
) 

  



 

 

SUMÁRIO 

 

 

1 INTRODUÇÃO ....................................................................................................... 15 

2 REVISÃO BIBLIOGRÁFICA .................................................................................. 17 

3 MODELAGEM DO PROCESSO ............................................................................ 19 

3.1 Descrição do processo ............................................................................................ 19 

3.2 Modelo da alimentação vinda do poço de petróleo ............................................... 22 

3.3 Modelo de cada equipamento ................................................................................. 26 

3.3.1 Separador trifásico............................................................................................................... 26 

3.3.2 Separador bifásico ............................................................................................................... 32 

3.3.3 Tratador eletrostático ........................................................................................................... 35 

3.3.4 Hidrociclone de-oiler ............................................................................................................ 40 

3.4 Modelo integrado ..................................................................................................... 43 

4 MODELOS LINEARES .......................................................................................... 44 

4.1 Metodologia utilizada na identificação das funções de transferência ................. 45 

4.2 Critérios utilizados para identificar quais variáveis controladas não são 

influenciadas por cada variável manipulada................................................................ 47 

4.3 Funções de transferência identificadas ................................................................. 58 

5 CONTROLE PREDITIVO ....................................................................................... 60 

5.1 Introdução ao Controle Preditivo baseado em Modelo (MPC) .............................. 60 

5.1.1 Perspectiva Histórica ........................................................................................................... 60 

5.1.2 Aplicações ........................................................................................................................... 61 

5.1.3 Vantagens e Desvantagens ................................................................................................ 61 

5.1.4 Elementos Básicos .............................................................................................................. 62 

5.2 Controle preditivo de horizonte finito com modelo em espaço de estados na 

forma incremental .......................................................................................................... 63 

5.3 Controle preditivo de horizonte finito com faixas para as variáveis controladas 66 

5.4 Simulação e Análise dos Resultados ..................................................................... 69 



 

 

5.4.1 Controle preditivo da plataforma de petróleo com set-points fixos ..................................... 70 

5.4.2 Controle preditivo da plataforma de petróleo com controle por faixas para as variáveis 

controladas ................................................................................................................................... 77 

6 CONSIDERAÇÕES FINAIS ................................................................................... 86 

6.1 Conclusões............................................................................................................... 86 

6.2 Sugestões de continuidade ..................................................................................... 87 

REFERÊNCIAS ......................................................................................................... 88 

 

 



15 

1 INTRODUÇÃO 

 

 

O petróleo é um mineral de origem fóssil composto de hidrocarbonetos complexos,  

podendo ser encontrado na forma sólida, líquida ou gasosa, a depender de sua 

composição, pressão e temperatura. Ele fica alojado nos poros de rochas chamadas 

“rochas-reservatórios”, formadas no fundo de antigos oceanos. Por isso o petróleo é, 

geralmente, encontrado em bacias sedimentares. Em decorrência da migração do 

petróleo nessas rochas-reservatórios, que contem água, até encontrar uma rocha 

selante, vão se formando os três fluidos principais - óleo, gás e água - presentes nos 

campos de produção. O gás pode estar dissolvido no óleo, ou se apresentar como 

uma camada independente entre o óleo e a rocha selante (THOMAS, 2001). 

A produção de um poço de petróleo é consubstanciada na elevação dos fluídos até 

a superfície e na sua separação. O óleo e o gás são os fluídos buscados nesta 

atividade. A obtenção desses fluídos se dá através das atividades de Exploração e 

Produção (E&amp;amp;P). Dentre as atividades de Produção, destaca-se o tratamento inicial 

do petróleo, com produtos químicos, para a separação dos fluídos e no seu 

enquadramento em parâmetros físico-químicos de qualidade exigidos pela cadeia 

produtiva e pelos órgãos ambientais. 

O foco desse trabalho será o processamento primário do petróleo que é responsável 

pela separação das diferentes fases presentes na mistura (água, óleo e gás) 

proveniente dos poços. Nesse processo, o óleo é tratado e processado para envio 

às refinarias. A água pode ser descartada no mar ou reciclada para injeção em 

poços. O gás natural é utilizado para geração de potência em turbinas a gás, 

alimentação de sistemas de injeção em poços e pode ser enviado a plantas de 

processamento em terra para posterior comercialização. 

A complexidade do processo se deve à alimentação da planta de processamento 

primário ser intermitente ou em golfada. Essa alimentação é resultado dos longos 

trechos verticais de tubulação (risers) combinada com o processo Gas-Lift, que é 

utilizado para incrementar a produção dos poços de petróleo offshore de baixa 

surgência. Tais variações na alimentação da planta resultam em oscilações na 

pressão e nas vazões em todo o processo. 



16 

Dessa forma, o objetivo do trabalho é realizar o estudo comparativo entre o 

controlador preditivo com set-points fixos para as variáveis controladas e o 

controlador preditivo com faixas para as variáveis controladas para verificar qual 

deles suporta melhor o tipo de escoamento intermitente da alimentação citado 

anteriormente. Para isso, primeiramente será construída uma simulação em 

MATLAB
®
 que contemple a planta de separação trifásica de processamento primário 

e a alimentação em golfadas. Em seguida, será realizada a identificação das 

funções de transferência e finalmente, os controladores serão implementados. 

Este documento divide-se em 6 capítulos: no capítulo 2 é feita uma revisão da 

literatura sobre as técnicas que foram desenvolvidas ao longo do tempo para 

diminuir os efeitos da alimentação em golfadas nas plantas de processamento 

primário. Em seguida, o capítulo 3 apresenta com detalhes o modelo da planta de 

separação trifásica e da alimentação em golfadas. No capítulo 4 é apresentada a 

estrutura de controle que será empregada na planta e as funções de transferência 

identificadas e sua aderência aos dados do modelo rigoroso. Já no capítulo 5 são 

apresentados os modelos dos controladores preditivos com set-points fixos e com 

faixas e seus resultados. Por fim, o capítulo 6 contém as conclusões obtidas e 

sugestão para trabalhos futuros. 



17 

2 REVISÃO BIBLIOGRÁFICA 

 

 

Muito esforço e dinheiro têm sido gastos tentando evitar os problemas operacionais 

resultantes do fluxo multifásico em golfadas. Henriot et al. (1999) mostraram que é 

possível prevenir golfadas severas com a instalação de uma bomba multifásica na 

base do riser. A aplicação da bomba multifásica tem o mesmo efeito da injeção de 

Gas-lift na base do riser, no entanto é um método mais dispendioso. 

Duret et al. (2004) propõem a aplicação de um bypass ativo para estabilizar o 

fenômeno indesejado das golfadas. Esta técnica consiste na implantação de uma 

válvula de passagem para o gás localizado entre a seção de alimentação da 

tubulação e o riser, resultando em um fluxo constante. O ponto negativo deste 

método é que ele não é aplicável a plantas de processamento já existentes, uma vez 

que necessita de alteração da estrutura. 

Para instalações já existentes, o uso de controladores tem se apresentado como a 

melhor solução para a minimização dos efeitos das golfadas. 

Vários sistemas de controle têm sido desenvolvidos com o intuito de amenizar os 

problemas gerados pela alimentação intermitente nos processos de tratamento do 

petróleo. Fard et al. (2006) utilizaram uma estratégia de controle em cascata com 

realimentação baseada em medidas de pressão na seção de alimentação do 

encanamento e na taxa de fluxo no topo do riser para suprimir as golfadas. Já 

Storkaas e Skogestad (2007) utilizaram um sistema de controle PID que mede a 

pressão na base do riser e manipula a válvula choke para evitar golfadas no riser. O 

único inconveniente dessa solução é que a instalação e a manutenção desse 

sistema são muito dispendiosas por necessitar de medidas submarinas, como a 

pressão na seção de alimentação. 

Estratégias de controle que atuam diretamente nas unidades de separação são as 

mais encontradas na literatura, além de ser a solução mais viável do ponto de vista 

econômico. Filgueiras (2005) propõe a aplicação de controladores PI para controlar 

os níveis da câmara de separação e do óleo da câmara de óleo e a pressão do 

separador trifásico. 

Recentemente, estratégias de controle baseadas no conceito de oscilação de nível 

dentro dos vasos separadores têm-se mostrado eficientes no controle do fluxo das 



18 

golfadas. Nunes (2004) propõe o “Controle por bandas”, no qual são permitidas 

variações do nível dentro dos vasos de acúmulo, de modo a estabilizar as vazões de 

saída do processo. Diferentemente dos outros métodos, que necessitam de medidas 

de vazão, o “Controle por bandas” requer somente medidas de nível dos 

separadores. Esse método tem apresentado desempenho satisfatório, porém 

apresenta problemas de chaveamento de controladores PI. 

O objetivo deste trabalho é aplicar um controlador do tipo MPC (Model Predictive 

Control) para o processo de separação trifásico, uma vez que o MPC permite o 

controle por faixas e não apresenta problemas de chaveamento como no “Controle 

por bandas”.  



19 

3 MODELAGEM DO PROCESSO 

 

 

3.1 Descrição do processo 

 

 

A maior parte da complexidade do controle de processos offshore advém das 

instabilidades no escoamento de óleo e gás proveniente dos poços produtores de 

petróleo. Essas instabilidades da alimentação são resultado da combinação dos 

grandes comprimentos das linhas de produção e dos risers com o uso de tecnologia 

Gas-Lift de elevação do óleo. 

O grande comprimento da linha horizontal de produção, seguida por outro grande 

trecho vertical (riser), associados a baixas velocidades superficiais de líquido e gás, 

resultam em um escoamento sob a forma estratificada no trecho horizontal da 

tubulação, seguido pelo padrão de golfadas no trecho vertical. As fases do ciclo de 

uma golfada estão esquematizadas na Figura 3-1. 

 

 

Figura 3-1 - Representação das fases de um ciclo de golfada. Nunes et at (2010) 

 



20 

Na primeira fase, ocorre o acúmulo do líquido na base em V do riser, o líquido 

acumulado é proveniente da linha de produção e do retorno do riser. Este acúmulo 

acaba gerando um selo na base V do riser retendo o gás proveniente do poço pela 

linha de produção. 

A segunda fase inicia-se com a pressurização de gás na linha de produção até que 

um valor crítico de pressão seja alcançado e o gás penetre o riser empurrando 

abruptamente o líquido acumulado. Nessa fase, o líquido passa pela Top-Side 

Choke do riser, atingindo separador primário. No início da terceira fase, o gás ocupa 

praticamente todo o riser e também se movimenta com alta velocidade através do 

Top-Side Choke ingressando no separador, impactando o controle de pressão. Por 

fim, a quarta fase é caracterizada por uma produção transitória de gás com uma taxa 

decrescente de gás até cessar pelo início da primeira fase. 

O processo Gas-Lift é uma alternativa para aumentar a produção de poço de 

petróleo offshore, cuja pressão disponível no reservatório geológico de óleo não é 

suficiente para fazer o fluido escoar a taxas apropriadas, vencendo a gravidade em 

dois longos trechos verticais: a coluna de produção do poço e o percurso via riser 

através da lâmina de água na zona de campo. 

Na tecnologia Gas-Lift, o gás natural comprimido é bombeado da plataforma de 

produção e injetado na coluna de produção do poço (Figura 3-2). A injeção de gás 

na coluna de produção resulta em uma mistura bifásica com densidade inferior à do 

óleo, permitindo que a pressão disponível no reservatório movimente o fluído 

ascensionalmente em direção à plataforma. 

 



21 

 

Figura 3-2 - Elevação artificial de petróleo por tecnologia Gas-Lift. Nunes et al (2010) 

 

A produção dos poços de petróleo passa por um manifold, onde a pressão é 

equalizada, seguindo através de uma válvula choke, cuja função é reduzir a 

intermitência do escoamento por meio de estrangulamento, antes de alimentar a 

primeira fase de separação. 

No caso das plantas com separação trifásica (Figura 3-3), a primeira fase de 

separação é realizada por um separador trifásico, onde as correntes líquida e 

gasosa são separadas na câmara de separação. A corrente líquida (mistura água-

óleo) se acumula na câmara de separação até que ocorra o transbordo do óleo, que 

tem menor massa específica que a água, para a câmara de óleo. A água oleosa 

retirada da câmara de separação é encaminhada para um hidrociclone de-oiler, que 

pela ação da força centrífuga, separa as gotículas de óleo dispersas na fase aquosa. 

O óleo, contendo água, é retirado da câmara de óleo e alimenta o primeiro estágio 

de separação bifásica, onde a separação do gás dissolvido no óleo é realizada em 

pressão inferior à do separador trifásico. A corrente líquida efluente do separador 

bifásico escoa para o tratador eletrostático, onde um campo elétrico é aplicado na 

fase oleosa para promover a coalescência das gotas de água, que se acumulam na 

fase inferior do equipamento. A água retirada do tratador eletrostático ainda contém 

óleo, então é necessário que passe pelo hidrociclone de-oiler antes de ser 



22 

descartada. O óleo proveniente do tratador eletrostático é então enviado para um 

segundo estágio de separação em outro separador bifásico, com pressão inferior à 

estabelecida no primeiro separador bifásico, para a remoção do gás dissolvido. 

 

Separador 

trifásico
Separador

bifásico

Tratador

eletrostático

Separador

bifásico

Hidrociclone 

de-oilers

Choke 

de produção

Manifold 

de produção
Poços

Hidrociclone

de-oilers

Água

Óleo

Gás

Gás

Óleo + Água

Água + Óleo

Óleo

Água

Gás

Gás

Óleo + Água

Óleo

Água Óleo

Água + Óleo

Óleo

...

 

Figura 3-3 - Planta trifásica de processamento primário de petróleo. Nunes et al (2010) 

 

 

3.2 Modelo da alimentação vinda do poço de petróleo 

 

 

O modelo apresentado por Jahanshahi et al. (2007) foi adotado para representar o 

escoamento em golfadas de óleo e gás resultante do Gas-Lift provenientes dos 

poços produtores de petróleo. O processo descrito na seção anterior é modelado 

matematicamente através de três estados: 

 

             3-1 

             3-2 



23 

            3-3 

 

onde: 

x1 – massa de gás na região anular (kg) 

x2 – massa de gás na coluna de produção (kg) 

x3 – massa de óleo na coluna de produção (kg) 

wgc – vazão mássica constante de gás injetado na região anular (kg/s) 

wiv – vazão mássica de gás que vai da região anular para a coluna de produção 

(kg/s) 

wpg – vazão mássica de gás através da choke de produção (kg/s) 

wr – vazão mássica de petróleo do reservatório para a coluna de produção (kg/s) 

wpo – vazão mássica de petróleo produzido através da choke de produção (kg/s) 

 

Por hipótese, a vazão mássica de gás natural injetado na coluna de produção é 

considerada constante. 

 

A vazão mássica de gás que vai da região anular para a coluna de produção é 

representada pela Equação 3-4. 

 

                           3-4 

 

onde: 

Civ – constante de injeção de gás na coluna de produção 

?ai – massa específica do gás na região anular no ponto de injeção (kg/m
3
) 

Pai – pressão na região anular no ponto de injeção (bar) 

Pti – pressão na coluna de produção no ponto de injeção (bar) 

 

A vazão mássica total (óleo e gás) de saída através da choke de produção é 

representada pela Equação 3-5. 

 

                           3-5 

 

onde: 



24 

Cpc – constante da choke de produção 

Ps – pressão no separador trifásico (bar) 

Pt – pressão no topo da coluna de produção (bar) 

xp – fração de abertura da válvula choke de produção 

?m – massa específica da mistura petróleo e gás no topo da coluna de produção 

(kg/m
3
) 

wpc – vazão mássica total através do choke de produção (kg/s) 

 

A vazão mássica de gás e petróleo que passam através da válvula choke de 

produção (kg/s) é apresentada nas Equações 3-6 e 3-7. 

 

    
  

     
     3-6 

 

    
  

     
     3-7 

 

A vazão mássica de petróleo do reservatório para a coluna de produção é 

representada através da Equação 3-8. 

 

              3-8 

 

onde: 

Cr – constante de saída de petróleo do reservatório para a coluna de produção 

Pr – pressão no reservatório (bar) 

Ptb – pressão no fundo da coluna de produção (bar) 

 

As massas específicas do gás na região anular no ponto de injeção e da mistura 

petróleo e gás no topo da coluna de produção são modelados da seguinte forma: 

 

    
 

    
    3-9 

 



25 

   
              

    
 3-10 

 

onde: 

Ar – área da secção transversal da coluna de produção abaixo do ponto de injeção 

(m
2
) 

At – área da secção transversal da coluna de produção acima do ponto de injeção 

(m
2
) 

Lr – comprimento desde o reservatório até o ponto de injeção de gás (m) 

Lt – comprimento da coluna de produção (m) 

M – massa molar do gás natural (kg/mol) 

R – constante universal dos gases (J/mol.K) 

Ta – temperatura do gás natural na região anular (K) 

?O – massa específica do petróleo (kg/m
3
) 

 

A pressão na região anular no ponto de injeção é dado pela Equação 3-11. 

 

     
    
    

 
    
  

     3-11 

 

onde: 

g – constante de aceleração da gravidade (m/s
2
) 

La – comprimento da região anular (m) 

Va – volume da região anular (m
3
) 

 

A pressão no topo da coluna de produção é apresentada na Equação 3-12. 

 

   
    
 

 
  

              
 3-12 

 

onde: 

Tt – temperatura na coluna de produção (K) 

vO – volume específico do petróleo (m
3
/kg) 

 



26 

A pressão na coluna de produção no ponto de injeção é dada pela Equação 3-13: 

 

       
 

  
                3-13 

 

A pressão no fundo da coluna de produção é dada pela Equação 3-14: 

 

              3-14 

 

 

3.3 Modelo de cada equipamento 

 

 

O modelo de cada equipamento que compõe a planta trifásica de processamento 

primário de petróleo é apresentado a seguir. O separador trifásico, o separador 

bifásico e o tratador eletrostático foram modelados conforme Nunes et al (2010). Já 

a modelagem do hidrociclone foi baseada em Moraes (1994). 

 

 

3.3.1 Separador trifásico 

 

 

O separador trifásico (Figura 3-4) é responsável pela separação do óleo, da água e 

do gás proveniente dos poços produtores. Este equipamento possui um vertedouro 

que o divide em duas seções: câmara de separação e câmara de óleo. A câmara de 

separação efetua a separação do óleo e da água por diferença de massa específica. 

O óleo separado verte para a câmara de óleo. 

 



27 

Lst,in
Gst,in

Pst,2, Gst,out

Pst,1, Lst,out

Lst,vert

hst,T

hst,W

hst,L

Pst,3, Wst,out

Gás

Óleo

Água

Câmara de 

separação

Câmara de 

óleo

Pst

 

Figura 3-4 - Separador Trifásico. Nunes et al (2010) 

 

onde: 

Lst,in – vazão de entrada da fase líquida (água + óleo) (m
3
/s) 

Gst,in – vazão de entrada de gás (m
3
/s) 

Lst,out – vazão de saída de óleo da câmara de óleo (m
3
/s) 

Wst,out – vazão de saída de água da câmara de separação (m
3
/s) 

Gst,out – vazão de saída de gás (m
3
/s) 

hst,T – altura total de líquido na câmara de separação (m) 

hst,W – altura da fase aquosa na câmara de separação (m) 

hst,L – altura fase oleosa na câmara de óleo (m) 

hst,VERT – altura do vertedouro (m) 

Lst,VERT – vazão através do vertedouro (m
3
/s) 

Pst – pressão no separador (bar) 

Pst,1 – pressão a jusante da válvula de óleo (bar) 

Pst,2 – pressão à jusante da válvula de gás (bar) 

Pst,3 – pressão à jusante da válvula de água (bar) 

 

Vale observar que a vazão volumétrica de entrada da mistura óleo e água, Lin, é 

dada pela variável wpo obtida pelo modelo do poço dividido pelo valor de sua massa 

específica. O mesmo ocorre para a vazão volumétrica de gás, em que Gst,in do 



28 

modelo do separador trifásico é equivalente a wpg do modelo do poço dividido pela 

sua respectiva massa específica. 

 

 

Câmara de separação 

 

 

Na câmara de separação são necessários dois balanços de massa. O primeiro 

balanço considera a fase líquida como volume de controle:  

 

         

  
 

                                

                              

 
3-15 

 

onde: 

Cst,CS – comprimento da câmara de separação (m) 

Dst – diâmetro do vaso (m) 

 

O segundo balanço é realizado na fase aquosa: 

 

         

  
 

                                  

                              

 
3-16 

 

onde: 

BSWst,in – fração de água e sedimentos presentes na carga oleosa 

?st – eficiência de separação da água emulsionada presente na carga oleosa 

 

 

Câmara de óleo 

 

 

Para a câmara de óleo, tem-se o seguinte balanço de massa: 

 



29 

         

  
 

                      

                              

 
3-17 

 

onde: 

Cst,CL – comprimento da câmara de óleo (m) 

 

A presença do vertedouro leva a duas condições de operação. A primeira condição é 

quando hst,L?hst,VERT, ou seja, o líquido verte da câmara de separação para a câmara 

de óleo. Na segunda condição, hst,L &gt; hst,VERT não há mais influência do vertedouro e 

o separador começa a operar como se fosse um único vaso. Nesse último caso, a 

variação do nível de óleo na câmara de óleo será igual à variação do nível total da 

câmara de separação: 

 

         

  
 

         

  
 3-18 

 

 

Fase gasosa 

 

 

Aplicando-se um balanço de massa na fase gasosa, tem-se: 

 

       

  
 

                                                            

                     
 

3-19 

 

 

onde: 

Vst – volume do vaso (m
3
) 

Vst,W – volume da fase aquosa (m
3
) 

Vst,L – volume da fase oleosa (m
3
) 

 

 

 

 



30 

Água dispersa na fase oleosa na câmara de separação 

 

 

O balanço de massa da água dispersa na fase oleosa na câmara de separação 

resulta em: 

 

             

  
                                        

            

                 
 3-20 

 

onde: 

Vst,T – volume da fase líquida na câmara de separação (m
3
) 

Vst,WFLCS – volume de água dispersa na fase oleosa na câmara de separação (m
3
) 

 

 

Água dispersa na fase oleosa na câmara de óleo 

 

 

Aplicando um balanço de massa na água dispersa na fase oleosa na câmara de 

óleo, tem-se: 

 

             

  
            

            

                 
           

            

        
 3-21 

 

onde: 

Vst,WFLCL – volume de água dispersa na fase oleosa na câmara de óleo (m
3
) 

 

A partir das relações geométricas do separador trifásico é possível determinar o 

volume da fase líquida na câmara de separação e o volume da fase oleosa na 

câmara de óleo. 

 

      
         

 

 

 
 
 
 
 

      
             

   
  

 
 
 
 

 
                       

   
 
 
 
 

 
             

   
 

 
 
 
 
 

 3-22 



31 

      
         

 

 

 
 
 
 
 

      
             

   
  

 
 
 
 

 
                       

   
 
 
 
 

 
             

   
 

 
 
 
 
 

 3-23 

 

A equação de vazão através do vertedouro e as equações que relacionam as 

vazões de gás, óleo e água com as aberturas das suas respectivas válvulas são 

apresentadas a seguir. 

 

 

Vertedouro 

 

 

                                                                      
   

 3-24 

 

Essa equação é valida somente para o caso em que a altura do líquido na câmara 

de separação é maior do que a altura do vertedouro, ou seja, hst,T&gt;hst,VERT. Caso a 

altura do líquido seja inferior ou igual a altura do vertedouro (hst,T?hst,VERT), a vazão 

através do vertedouro será nula (Lst,VERT=0). 

 

 

Óleo 

 

 

                 
                

 

            
     

          
 

 
3-25 

 

onde: 

Cst,VL – coeficiente de vazão da válvula de óleo 

xst,L – fração de abertura da válvula de óleo 

?st,L – massa específica da fase oleosa (kg/m
3
) 

?H2O,15,5°C – massa específica da água a 15,5°C (kg/m
3
) 

 



32 

Gás 

 

 

                 
                 

                            

        
          

 
 

3-26 

 

onde: 

Cst,VG – coeficiente de vazão da válvula de gás 

xst,G – fração de abertura da válvula de gás 

?st,G – massa específica da fase oleosa (kg/m
3
) 

 

 

Água 

 

 

                 
                

 

            
     

          
 

 
3-27 

 

onde: 

Cst,VW – coeficiente de vazão da válvula de água 

xst,W – fração de abertura da válvula de água 

?st,W – massa específica da fase aquosa (kg/m
3
) 

 

 

3.3.2 Separador bifásico 

 

 

Diferentemente do separador trifásico, o separador bifásico (Figura 3-5) é um 

equipamento composto por somente uma câmara e tem a função de retirar o gás 

presente nas correntes oleosas. É projetado para um tempo de residência da fase 

líquida entre 3 e 5 minutos e para valores de velocidade do gás que não ocorram 

arraste de líquido. 



33 

Psb1,2, Gsb1,out

Psb1,1, Lsb1,out

Lsb1,in
Gsb1,in

hsb1,L

Dsb1

Psb1

Csb1

 

Figura 3-5 - Separador Bifásico. Nunes et al (2010) 

 

onde: 

Lsb1,in – vazão de entrada da fase líquida (água + óleo) (m
3
/s) 

Gsb1,in – vazão de entrada de gás (m
3
/s) 

Lsb1,out – vazão de saída de óleo (m
3
/s) 

Gsb1,out – vazão de saída de gás (m
3
/s) 

hsb1,L – altura fase oleosa na câmara de óleo (m) 

Psb1 – pressão no separador (bar) 

Psb1,1 – pressão a jusante da válvula de óleo (bar) 

Psb1,2 – pressão à jusante da válvula de gás (bar) 

Csb1 – comprimento do vaso (m) 

Dsb1 – diâmetro do vaso (m) 

 

 

Fase líquida 

 

 

A partir do balanço de massa na fase líquida, é possível obter a Equação 3-28: 



34 

          

  
 

                      

                               

 
3-28 

 

 

Fase gasosa 

 

 

O balanço de massa para a fase gasosa resulta em: 

 

        

  
 

                                                      

              
 3-29 

 

onde: 

Vsb1 – volume do separador bifásico (m
3
) 

Vsb1,L – volume da fase oleosa (m
3
) 

 

As equações que relacionam as vazões de óleo e água com as aberturas das suas 

respectivas válvulas são apresentadas a seguir. 

 

 

Óleo 

 

 

                  
                  

 

              
      

          
 

 
3-30 

 

onde: 

Csb1,VL – coeficiente de vazão da válvula de óleo 

xsb1,L – fração de abertura da válvula de óleo 

?sb1,L – massa específica da fase oleosa (kg/m
3
) 

?H2O,15,5°C – massa específica da água a 15,5°C (kg/m
3
) 

 



35 

Gás 

 

 

                  
                   

                                

         
          

 
 

3-31 

 

onde: 

Csb1,VG – coeficiente de vazão da válvula de gás 

xsb1,G – fração de abertura da válvula de gás 

?sb1,G – massa específica da fase oleosa (kg/m
3
) 

 

A partir da relação geométrica das dimensões do vaso é possível definir uma 

equação não linear que relaciona o volume da fase oleosa (Vsb1,L) com a altura da 

fase oleosa (hsb1,L). 

 

          
        

 

 

 
 
 
 
 

      
               

    
  

 
 
 
 

 

                          

    
 
 
 
 

 
               

    
 

 
 
 
 
 

 3-32 

 

 

3.3.3 Tratador eletrostático 

 

 

O tratador eletrostático (Figura 3–6) tem como função o enquadramento do óleo nas 

especificações, que ainda contém traços de água, nas plataformas, retirando o 

restante da água e deixando passar apenas o óleo para o equipamento seguinte. 

Placas metálicas carregadas eletricamente são utilizadas para gerar campo elétrico 

na fase oleosa e aproximar as gotas de água, resultando no coalescimento destas. 

Para evitar que bolhas de gás perturbem esse processo, adota-se a configuração na 

qual um separador bifásico garante a retirada do gás de modo que o tratador 

eletrostático opere completamente cheio de líquido. 



36 

Lte,out, Pte,1

Wte,out, Pte,3

Lsb2,out

hte,W

Tratador

eletrostático

Separador

Bifásico 2

hsb2,L

Lsb2,in 

Gsb2,in

Gsb2,out, Psb2,2

 

Figura 3-6 - Tratador eletrostático. Nunes et al (2010) 

 

onde: 

Lsb2,in – vazão de entrada da fase líquida (m
3
/s) 

G sb2,in – vazão de entrada de gás (m
3
/s) 

Lsb2,out – vazão de saída de óleo do separador bifásico (m
3
/s) 

Lte,out – vazão de saída de óleo do tratador eletrostático (m
3
/s) 

Wte,out – vazão de saída de água do tratador eletrostático (m
3
/s) 

Gsb2,out – vazão de saída de gás do separador bifásico (m
3
/s) 

hte,W – altura da fase aquosa no tratador eletrostático (m) 

hsb2,L – altura fase oleosa no separador bifásico (m) 

Psb2 – pressão no separador bifásico (bar) 

Pte,1 – pressão a jusante da válvula de óleo no tratador eletrostático (bar) 

Psb2,2 – pressão à jusante da válvula de gás no separador bifásico (bar) 

Pte,3 – pressão à jusante da válvula de água no tratador eletrostático (bar) 

 



37 

Dos balanços de massa aplicados para a fase líquida e gasosa do separador 

bifásico, tem-se: 

 

 

Fase líquida no separador bifásico 

 

 

          

  
 

                      

                               

 
3-33 

 

onde: 

Csb2 – comprimento do vaso do separador bifásico (m) 

Dsb2 – diâmetro do vaso do separador bifásico (m) 

 

 

Fase gasosa no separador bifásico 

 

 

        

  
 

                                                      

              
 3-34 

onde: 

Vsb2 – volume do vaso do separador bifásico (m
3
) 

Vsb2,L – volume da fase líquida do separador bifásico (m
3
) 

 

Aplicando um balanço de massa na fase aquosa e considerando que a quantidade 

de óleo presente na corrente de saída de água do tratador eletrostático (Wte,out) não 

é significativa, tem-se: 

 

 

 

 

 

 



38 

Fase aquosa no separador eletrostático 

 

 

         

  
 

                                    

                           

 
3-35 

Com 

                                   e        
          

                  
. 

 

onde: 

BSWsb2 – fração de água e sedimentos presente na carga oleosa 

Cte – comprimento do vaso do tratador eletrostático (m) 

Dte – diâmetro do vaso do tratador eletrostático (m) 

?te – eficiência de separação da água emulsionada presente na carga oleosa 

 

 

Água dispersa na fase oleosa no tratador eletrostático 

 

 

           

  
                                        

          

               
 3-36 

 

onde: 

Vte,WFL – volume de água dispersa na fase oleosa no separador eletrostático (m
3
) 

Vte – volume do vaso do tratador eletrostático (m
3
) 

Vte,w – volume da fase aquosa no tratador eletrostático (m
3
) 

 

As relações geométricas permitem calcular o volume de óleo (Vsb2,L) e água (Vte,W) 

no separador bifásico e no tratador eletrostático respectivamente. 

 

       
        

 

 

 
 
 
 
 

      
               

    
  

 
 
 
 

 

                          

    
 
 
 
 

 
               

    
 

 
 
 
 
 

 3-37 



39 

      
      

 

 

 
 
 
 
 

      
             

   
  

 
 
 
 

 
                       

   
 
 
 
 

 
             

   
 

 
 
 
 
 

 3-38 

 

As equações que relacionam a vazão através das válvulas com as suas aberturas 

são apresentadas a seguir. 

 

 

Óleo do tratador eletrostático 

 

 

                 
                

 

            
     

          
 

 
3-39 

 

onde: 

Cte,VL – coeficiente de vazão da válvula de óleo 

xte,L – fração de abertura da válvula de óleo 

?te,L – massa específica da fase oleosa (kg/m
3
) 

?H2O,15,5°C – massa específica da água a 15,5°C (kg/m
3
) 

 

 

Gás do separador bifásico 

 

 

                  
                  

 

                                

         
          

 
 

3-40 

 

onde: 

Csb2,VG – coeficiente de vazão da válvula de gás 

xsb2,G – fração de abertura da válvula de gás 

?sb2,G – massa específica da fase oleosa (kg/m
3
) 



40 

Água do tratador eletrostático 

 

 

                 
                

 

            
     

          
 

 
3-41 

 

onde: 

Cte,VW – coeficiente de vazão da válvula de água 

xte,W – fração de abertura da válvula de água 

?te,W – massa específica da fase aquosa (kg/m
3
) 

 

 

3.3.4 Hidrociclone de-oiler 

 

 

O hidrociclone de-oiler (Figura 3-7) é um equipamento utilizado na recuperação de 

óleo de águas de produção. O princípio de funcionamento consiste na entrada 

tangencial de água oleosa, sob pressão, no trecho de maior diâmetro do 

hidrociclone, sendo direcionada em fluxo espiral, em direção ao trecho de menor 

diâmetro. O contínuo decréscimo de diâmetro faz com que o fluxo seja acelerado, 

gerando uma força centrífuga que força o componente mais pesado (água) contra as 

paredes. O fluxo axial reverso ocorre, na parte central do equipamento, em virtude 

do diferencial de pressão existente entre as paredes e o centro, que se estabelece 

em consequência do campo centrífugo, associado à perda de intensidade do vórtice 

ao longo do escoamento axial. A fase líquida central, que deixa o hidrociclone pela 

parte superior contendo óleo, é denominada de rejeito. A saída de água se localiza 

na parte inferior do equipamento com certa quantidade de óleo residual. 



41 

Phc,o
Whc,o

Phc,u
Whc,u

Phc,1

 

Figura 3-7 - Hidrociclone de-oiler. Moraes (1994) 

 

onde: 

Phc,1 – pressão da corrente de alimentação (bar) 

Phc,o – pressão na descarga na linha de topo (bar) 

Phc,u – pressão na descarga na linha de fundo (bar) 

Whc,o – vazão de saída de topo (m
3
/s) 

Whc,u – vazão de saída de fundo (m
3
/s) 

 

A modelagem do hidrociclone adotada foi desenvolvida por Moraes (1994), pois 

além de apresentar resultados satisfatórios, admite a não dependência da eficiência 

em relação à pressão interna do equipamento. A vazão do equipamento depende 

das pressões de entrada e saída e da perda de carga no equipamento. O modelo do 

hidrociclone é apresentado a seguir. 

 

A relação da perda de carga com a vazão de saída de rejeito de topo é dada por: 

 

                         3-42 

 

onde: 

?Phc,o – diferença de pressão entre a corrente de alimentação e a corrente de 

descarga de topo (bar) 

?hc,1 – parâmetro de ajuste do modelo para perda de carga 

 



42 

Por sua vez, a relação da perda de carga com a vazão de saída de água é fornecida 

por: 

 

                         3-43 

 

onde: 

?Phc,u – diferença de pressão entre a corrente de alimentação e a corrente de 

descarga de fundo (bar) 

?hc,2 – parâmetro de ajuste do modelo para perda de carga 

 

A vazão de topo é apresentada a seguir. 

 

               
                

 

                           
     

          
 

 
3-44 

 

onde: 

xhc,o – fração de abertura da válvula de topo 

Chc,Vo – coeficiente de vazão da válvula de óleo de topo 

?hc,o – massa específica da saída de topo (kg/m
3
) 

?H2O,15,5°C – massa específica da água a 15,5°C (kg/m
3
) 

 

A vazão de fundo é apresentada a seguir. 

 

               
                

 

                           
     

          
 

 
3-45 

 

onde: 

xhc,u – fração de abertura da válvula de fundo 

Chc,Vu – coeficiente de vazão da válvula de água de fundo 

?hc,u – massa específica da saída de fundo (kg/m
3
) 

 

 



43 

3.4 Modelo integrado 

 

 

Na integração dos modelos dos equipamentos foram adotadas algumas hipóteses 

visando simplificar o modelo sem que houvesse o comprometimento dos fluxos da 

planta trifásica. 

Para evitar que as equações termodinâmicas fossem incluídas na simulação para 

representar o equilíbrio líquido-vapor e resultasse em mais não linearidades ao 

modelo da simulação, foi adotada a hipótese de que uma fração da corrente que vai 

para o equipamento seguinte passa para a fase gasosa ao entrar em equilíbrio nas 

condições de temperatura e pressão desse equipamento. Isso pode ser 

representado através da seguinte expressão. 

 

                                 3-46 

 

onde: 

Gin,2 – vazão de entrada de gás no equipamento seguinte (m
3
/s) 

Lout,1 – vazão de saída de líquido do equipamento anterior (m
3
/s) 

ygás/líquido – fração da corrente de alimentação líquida que passa para a fase gasosa 

na condição de temperatura e pressão do equipamento seguinte 

 

A hipótese anterior foi adotada, pois o solver utilizado não encontrava solução para 

muitos casos e porque o foco desse trabalho é o estudo dos controladores, de 

maneira que os fluxos da planta são importantes, não sendo necessário o 

detalhamento da composição das correntes. 

Quanto à variação da pressão ao longo do processo, foi adotada a hipótese de que 

a pressão à jusante da válvula do equipamento anterior é igual à pressão de 

operação do equipamento seguinte, de maneira que a perda de carga no trecho 

válvula-equipamento seguinte é desprezada. Com isso, complicações 

desnecessárias no modelo da simulação são evitadas. 

 

 



44 

4 MODELOS LINEARES 

 

 

Com o modelo rigoroso do processo, neste capítulo será definida a estrutura de 

controle (Figura 4-1) e será realizada a identificação das funções de transferência 

que relacionam as variáveis controladas com as variáveis manipuladas. Na Tabela 

4-1 e na Tabela 4-2 são apresentadas as variáveis controladas e manipuladas do 

sistema, respectivamente. 

 

Separador 

trifásico
Separador

bifásico 1

Tratador

eletrostático

Separador

bifásico 2

Hidrociclone 

de-oilers

Choke 

de produção

Manifold 

de produção
Poços

Hidrociclone

de-oilers

y2y1

y3

y4

y5

y6

y7

y8

u1

u2

u3

u4

u5

u6

u8

u7

u10

u9

Água

Óleo

Gás

Gás

Água + Óleo (Resíduo)

Água

Óleo

Óleo + Água

Gás

Óleo + Água

Óleo

Água + Óleo (Resíduo)

Água

Óleo

Gás

Óleo

 

Figura 4-1 - Planta de separação trifásica com indicação das variáveis controladas e manipuladas. 

 

 

 

 

 



45 

Tabela 4-1 - Variáveis controladas do sistema. 

Variáveis controladas 

y1 Nível da água na câmara de separação do separador trifásico (m) 

y2 Nível da câmara de óleo do separador trifásico (m) 

y3 Pressão do separador trifásico (bar) 

y4 Nível do separador bifásico 1 (m) 

y5 Pressão do separador bifásico 1 (bar) 

y6 Nível do tratador eletrostático (m) 

y7 Nível do separador bifásico 2 (m) 

y8 Pressão do separador bifásico 2 (bar)  

 

Tabela 4-2 - Variáveis manipuladas do sistema. 

Variáveis manipuladas 

u1 Abertura da válvula de saída de gás do separador trifásico 

u2 Abertura da válvula de saída de óleo do separador trifásico 

u3 Abertura da válvula de saída de gás do separador bifásico 1 

u4 Abertura da válvula de saída de óleo do tratador eletrostático 

u5 Abertura da válvula de saída de gás do separador bifásico 2 

u6 Abertura da válvula de saída de óleo do separador bifásico 2 

u7 
Abertura da válvula de saída de água do hidrociclone do separador 
trifásico 

u8 
Abertura da válvula de saída de rejeito de óleo/água no hidrociclone do 
separador trifásico 

u9 
Abertura da válvula de saída de água do hidrociclone do tratador 
eletrostático 

u10 
Abertura da válvula de saída de rejeito de óleo/água do hidrociclone do 
tratador eletrostático 

 

 

4.1 Metodologia utilizada na identificação das funções de transferência 

 

 

Para a identificação, o modelo de alimentação intermitente da planta de separação 

trifásica foi trocado por uma alimentação constante. Houve dificuldade em definir as 

aberturas de válvulas que garantissem um estado estacionário para o processo. 

Essa dificuldade é justificada pelas equações de nível dos equipamentos resultarem 

em um sistema integrador, assim qualquer variação nas aberturas das válvulas 

resulta em um aumento/diminuição do nível do equipamento até este 

encher/esvaziar completamente. Diante disso foi necessário implementar 



46 

controladores do tipo PI (ação proporcional e integral) no processo. Na Figura 4-2 é 

possível visualizar todos os controladores do tipo PI do processo. 

Com os controladores PI implementados no processo, foi possível estabelecer set-

points para as variáveis controladas e definir as aberturas das válvulas necessárias 

para que esse estado estacionário fosse alcançado.  

Com o estado estacionário definido, partiu-se para a identificação das funções de 

transferência e, para isso, os controladores PI foram desligados e foram realizadas 

variações nas ações de controle para cada variável manipulada. A primeira ação 

mantém a variável manipulada na abertura inicial, depois se aplica um degrau 

positivo por um determinado período e retorna-se para a abertura inicial e por fim, 

aplica-se um degrau de mesma intensidade no sentido negativo por um determinado 

período e retorna-se para a abertura inicial novamente. 

 

Separador 

trifásico
Separador

bifásico

Tratador

eletrostático

Separador

bifásico

Hidrociclone 

de-oilers

Choke 

de produção

Manifold 

de produção
Poços

Hidrociclone

de-oilers

PT-1

PIC-1 PY-1

PT-2

PIC-2 PY-2

LT-1 LIC-1

LY-1

LT-2

LIC-2

LY-2

LT-3 LIC-3

LY-3

PT-3

PIC-3 PY-3

LT-4 LIC-4

LY-4

LT-5

LIC-5

LY-5

Água

Óleo

Gás

Gás

Óleo + Água

Água + Óleo

Óleo

Água

Gás

Gás

Óleo + Água

Óleo

Água Óleo

Água + Óleo

Óleo

 

Figura 4-2 - Planta trifásica de processamento primário de petróleo com os controladores do tipo PI. 

 

O tempo de amostragem utilizado para a identificação foi de 3 segundos. A seguir, 

são apresentadas as tabelas com as aberturas iniciais das válvulas, as variações 



47 

das aberturas das válvulas e os intervalos entre as implementações das ações de 

controle que foram adotadas. 

 

Tabela 4-3 - Aberturas iniciais das válvulas, variações das aberturas das válvulas e intervalos entre 

as implementações das ações de controle que foram adotadas para cada variável manipulada. 

Variável Manipulada 
Abertura 
inicial da 
válvula 

Variação na 
abertura da 

válvula 

Intervalo entre as 
mudanças na abertura da 

válvula (s) 

u1 0,3044 0,10 20 

u2 0,6056 0,10 50 

u3 0,4664 0,10 20 

u4 0,4783 0,10 30 

u5 0,6030 0,10 20 

u6 0,7563 0,10 20 

u7 0,3969 0,10 30 

u8 0,5000 0,10 30 

u9 0,2424 0,10 50 

u10 0,5000 0,10 30 

 

Para definir a ordem do numerador e do denominador de cada função de 

transferência, cujas estruturas são ARMAX, sempre foi escolhida a menor ordem 

para a função de transferência, de maneira que os seus valores se aproximassem 

dos valores do modelo rigoroso de forma satisfatória. 

 

 

4.2 Critérios utilizados para identificar quais variáveis controladas não 

são influenciadas por cada variável manipulada 

 

 

Como o sistema possui um número grande de variáveis controladas e manipuladas 

e ainda, algumas funções de transferência são instáveis em malha aberta, foi 

necessário adotar um critério para determinar quais funções de transferência serão 

consideradas. O critério consiste em selecionar as variáveis manipuladas que têm 

influência em cada variável controlada baseado no modelo desenvolvido no capítulo 

anterior. Na Tabela 4-4 é apresentada a combinação variável controlada - variável 

manipulada. 

 



48 

Tabela 4-4 - Combinação variável controlada-variável manipulada. 

Variável controlada Variável manipulada 

y1 u7 e u8 

y2 u1 e u2 

y3 u1, u2 e u7 

y4 u2 e u4 

y5 u2, u3 e u4 

y6 u4 e u9 

y7 u4 e u6 

y8 u4, u5 e u6 

 

A seguir são apresentadas as respostas ao degrau positivo (Figura 4-3) seguido de 

um negativo das funções de transferência que foram consideradas importantes. 

Para o nível de água na câmara de separação do separador trifásico (y1), tem-se as 

respostas para o estímulo na abertura da válvula de saída de água do hidrociclone 

do separador trifásico (u7) e na abertura da válvula de saída de rejeito de óleo/água 

no hidrociclone do separador trifásico (u8). 

 

 

Figura 4-3 - Resposta de y1 ao estímulo em u7. 

 

0 50 100 150
-0.035

-0.03

-0.025

-0.02

-0.015

-0.01

-0.005

0

0.005

y
1
 -

y
1
s
s
 (

m
)

t (s)

y1-u7

 

 

resposta EDO

estimação ARMAX



49 

 

Figura 4-4 - Resposta de y1 ao estímulo em u8. 

 

Já para o nível da câmara de óleo do separador trifásico (y2), tem-se as respostas 

para o estímulo na abertura da válvula de saída de gás do separador trifásico (u1) e 

na abertura da válvula de saída de óleo do separador trifásico (u2). 

 

 

Figura 4-5 - Resposta de y2 ao estímulo em u1. 

 

0 50 100 150
-2.5

-2

-1.5

-1

-0.5

0

0.5
x 10

-4

y
1
-y

1
s
s
 (

m
)

t (s)

y1-u8

 

 

resposta EDO

estimação ARMAX

0 10 20 30 40 50 60 70 80 90 100
-0.04

-0.02

0

0.02

0.04

0.06

0.08

0.1

y
2
-y

2
s
s
 (

m
)

t (s)

y2-u1

 

 

resposta EDO

estimação ARMAX



50 

 

Figura 4-6 - Resposta de y2 ao estímulo em u2. 

 

Para a pressão do separador trifásico (y3), tem-se as respostas para o estímulo na 

abertura da válvula de saída de gás do separador trifásico (u1), na abertura da 

válvula de saída de óleo do separador trifásico (u2) e na abertura da válvula de saída 

de água do hidrociclone do separador trifásico (u7). 

 

 

Figura 4-7 - Resposta de y3 ao estímulo em u1. 

 

0 50 100 150 200 250
-0.5

-0.4

-0.3

-0.2

-0.1

0

0.1

0.2

y
2
-y

2
s
s
(m

)

t (s)

y2-u2

 

 

resposta EDO

estimação ARMAX

0 10 20 30 40 50 60 70 80 90 100
-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

y
3
-y

3
s
s
 (

b
a
r)

t (s)

y3-u1

 

 

resposta EDO

estimação ARMAX



51 

 

Figura 4-8 - Resposta de y3 ao estímulo em u2. 

 

 

Figura 4-9 - Resposta de y3 ao estímulo em u7. 

 

Para o nível do separador bifásico 1 (y4), tem-se as respostas para o estímulo na 

abertura da válvula de saída de óleo do separador trifásico (u2) e na abertura da 

válvula de saída de óleo do tratador eletrostático (u4). 

 

0 50 100 150 200 250
-0.08

-0.06

-0.04

-0.02

0

0.02

0.04

0.06

0.08

0.1

y
3
-y

3
s
s
 (

b
a
r)

t (s)

y3-u2

 

 

resposta EDO

estimação ARMAX

0 50 100 150
-0.04

-0.03

-0.02

-0.01

0

0.01

0.02

0.03

y
3
-y

3
s
s
 (

b
a
r)

t (s)

y3-u7

 

 

resposta EDO

estimação ARMAX



52 

 

Figura 4-10 - Resposta de y4 ao estímulo em u2. 

 

 

Figura 4-11 - Resposta de y4 ao estímulo em u4. 

 

Para a pressão do separador bifásico 1 (y5), tem-se as respostas para o estímulo na 

abertura da válvula de saída de óleo do separador trifásico (u2), na abertura da 

válvula de saída de gás do separador bifásico 1 (u3) e na abertura da válvula de 

saída de óleo do tratador eletrostático (u4). 

 

 

0 50 100 150 200 250
-0.02

-0.015

-0.01

-0.005

0

0.005

0.01

0.015

0.02

0.025

0.03

y
4
-y

4
s
s
 (

m
)

t (s)

y4-u2

 

 

resposta EDO

estimação ARMAX

0 50 100 150
-0.025

-0.02

-0.015

-0.01

-0.005

0

0.005

0.01

0.015

y
4
-y

4
s
s
 (

m
)

t (s)

y4-u4

 

 

resposta EDO

estimação ARMAX



53 

 

Figura 4-12 - Resposta de y5 ao estímulo em u2. 

 

 

 

Figura 4-13 - Resposta de y5 ao estímulo em u3. 

 

0 50 100 150 200 250
-0.2

-0.15

-0.1

-0.05

0

0.05

0.1

0.15

y
5
-y

5
s
s
 (

b
a
r)

t (s)

y5-u2

 

 

resposta EDO

estimação ARMAX

0 10 20 30 40 50 60 70 80 90 100
-0.035

-0.03

-0.025

-0.02

-0.015

-0.01

-0.005

0

0.005

0.01

0.015

y
5
-y

5
s
s
 (

b
a
r)

t (s)

y5-u3

 

 

resposta EDO

estimação ARMAX



54 

 

Figura 4-14 - Resposta de y5 ao estímulo em u4. 

 

 

Para o nível do tratador eletrostático (y6), tem-se as respostas para o estímulo na 

abertura da válvula de saída de óleo do tratador eletrostático (u4) e na abertura da 

válvula de saída de água do hidrociclone do tratador eletrostático (u9). 

 

 

Figura 4-15 - Resposta de y6 ao estímulo em u4. 

 

0 50 100 150
-0.1

-0.08

-0.06

-0.04

-0.02

0

0.02

0.04

0.06

y
5
-y

5
s
s
 (

b
a
r)

t (s)

y5-u4

 

 

resposta EDO

estimação ARMAX

0 50 100 150
-4

-2

0

2

4

6

8

10

12
x 10

-4

y
6
-y

6
s
s
 (

m
)

t (s)

y6--u4

 

 

resposta EDO

estimação ARMAX



55 

 

Figura 4-16 - Resposta de y6 ao estímulo em u9. 

 

Para o nível do separador bifásico 2 (y7), tem-se as respostas para o estímulo na 

abertura da válvula de saída de óleo do tratador eletrostático (u4) e na abertura da 

válvula de saída de óleo do separador bifásico 2 (u6). 

 

 

Figura 4-17 - Resposta de y7 ao estímulo em u4. 

 

0 50 100 150 200 250
-4

-3.5

-3

-2.5

-2

-1.5

-1

-0.5

0
x 10

-3

y
6
-y

6
s
s
 (

m
)

t (s)

y6-u9

 

 

resposta EDO

estimação ARMAX

0 50 100 150
-0.015

-0.01

-0.005

0

0.005

0.01

0.015

0.02

y
7
-y

7
s
s
 (

m
)

t (s)

y7-u4

 

 

resposta EDO

estimação ARMAX



56 

 

Figura 4-18 - Resposta de y7 ao estímulo em u6. 

 

Para a pressão do separador bifásico 2 (y8), tem-se as respostas para o estímulo na 

abertura da válvula de saída de óleo do tratador eletrostático (u4), na abertura da 

válvula de saída de gás do separador bifásico 2 (u5) e na abertura da válvula de 

saída de óleo do separador bifásico 2 (u6). 

 

 

Figura 4-19 - Resposta de y8 ao estímulo em u4. 

 

0 10 20 30 40 50 60 70 80 90 100
-10

-8

-6

-4

-2

0

2

4
x 10

-3

y
7
-y

7
s
s
 (

m
)

t (s)

y7-u6

 

 

resposta EDO

estimação ARMAX

0 50 100 150
-0.08

-0.06

-0.04

-0.02

0

0.02

0.04

0.06

0.08

0.1

0.12

y
8
-y

8
s
s
 (

b
a
r)

t (s)

y8--u4

 

 

resposta EDO

estimação ARMAX



57 

 

Figura 4-20 - Resposta de y8 ao estímulo em u5. 

 

 

Figura 4-21 - Resposta de y8 ao estímulo em u6. 

 

Observando as comparações das respostas do modelo com as respostas das 

funções de transferência, nota-se que as respostas de algumas funções de 

transferência levantadas apresentaram um leve desvio em relação ao modelo 

rigoroso da planta. Isso pode ser observado na Figura 4-4, Figura 4-7, Figura 4-8 e 

na Figura 4-9. Mesmo com esse leve desvio, essas funções de transferências 

0 10 20 30 40 50 60 70 80 90 100
-12

-10

-8

-6

-4

-2

0

2

4

6
x 10

-3

y
8
-y

8
s
s
 (

b
a
r)

t (s)

y8-u5

 

 

resposta EDO

estimação ARMAX

0 10 20 30 40 50 60 70 80 90 100
-0.05

-0.04

-0.03

-0.02

-0.01

0

0.01

0.02

y
8
-y

8
s
s
 (

b
a
r)

t (s)

y8-u6

 

 

resposta EDO

estimação ARMAX



58 

podem ser consideradas aceitáveis, uma vez que apresentam o mesmo 

comportamento do modelo rigoroso. 

Desta forma, todas as funções de transferências levantadas podem ser 

consideradas satisfatórias e poderão ser utilizadas nos controladores preditivos para 

prever o comportamento da planta. 

 

 

4.3 Funções de transferência identificadas 

 

 

Finalmente, são apresentadas a seguir, na Tabela 4-5, as funções de transferências 

que foram consideradas para a representação do sistema da planta trifásica de 

processamento primário de petróleo. 

 

 

 

 

 

 

 



 

 

 

 

5
9
 

 

Tabela 4-5 - Modelo em funções de transferência da plataforma de petróleo 

 

                

   
                  

                           

                       

                            
     

   
       

      

                           

                                  

       

     

      

     
   

      
        

     
   

     
       

     

        

     

        

      

       

      

      

      

         
       

      

        
        

     

       

      

  
        

      
 

        

                     
     

  
         

      
       

       
         

      
  

 

 

 



60 

5 CONTROLE PREDITIVO 

 

 

5.1 Introdução ao Controle Preditivo baseado em Modelo (MPC) 

 

 

O MPC surgiu no final da década de 70 e ainda hoje vem se desenvolvendo. 

Segundo Camacho e Bordons (2000), essa técnica não designa apenas uma 

estratégia específica de controle, mas sim uma gama de métodos de controle. Esses 

métodos utilizam explicitamente um modelo do processo para prever as saídas do 

sistema em instantes de tempo futuros (horizontes). Possuindo tal modelo, é 

possível determinar uma trajetória ótima das variáveis controladas através da 

minimização de uma função objetivo, que geralmente é um custo. 

Os algoritmos do MPC se diferem basicamente no modelo do processo estudado, 

nos ruídos e na função objetivo. 

 

 

5.1.1 Perspectiva Histórica 

 

 

O controle preditivo foi proposto independentemente por vários autores, mais ou 

menos simultaneamente, por isso não se pode atribuir sua criação a um único autor. 

No entanto, o que se sabe é que os pioneiros no assunto eram, em sua maioria, 

oriundos da indústria e já haviam implementado o controle preditivo anos antes das 

primeiras publicações científicas aparecerem. 

Foi no final da década de 70 que apareceram os artigos embrionários tratando do 

assunto. Nessa época, pode-se destacar Richalet et al (1978), que propuseram, 

segundo eles próprios, “um novo método de controle de processos” que pode ser 

aplicado mesmo em sistemas com ruídos, distúrbios e variações de parâmetros 

chamado de Model Predictive Heuristic Control (MPHC), traduzindo: Controle 

Heurístico com Predição baseada em Modelo. Outra publicação relevante nesta 

época foi a de Cutler e Ramaker (1980), que também propuseram um método de 

controle preditivo, chamado de Dynamic Matrix Control (DMC). Observa-se que tanto 



61 

Richalet et al (1978) quanto Cutler e Ramaker (1980) utilizaram um modelo dinâmico 

do processo em seus algoritmos. 

Em 1986, Garcia e Morshedi desenvolveram o QDMC: Quadratic Dynamic Matrix 

Control. Esse método foi desenvolvido para lidar com as restrições impostas às 

variáveis manipuladas, já que algoritmos como o MPHC e DMC apresentavam 

dificuldades em tratar as restrições. Assim, vários outros modelos foram surgindo ao 

longo dos anos. 

Com o passar do tempo, o controle preditivo baseado em modelo foi sendo cada vez 

mais utilizado, especialmente na indústria de processos, e vem se expandindo por 

outras áreas, como mostra o tópico seguinte. 

 

 

5.1.2 Aplicações 

 

 

As aplicações do Controle Preditivo são, em sua maioria, industriais. Como exemplo, 

tem-se a indústria petroquímica, de cimento, em equipamentos como as torres de 

secagem e colunas de destilação, entre outros. Além dessas aplicações industriais, 

também existem aplicações em variadas áreas, como na robótica e na anestesia 

clínica (CAMACHO e BORDONS, 2000). 

 

 

5.1.3 Vantagens e Desvantagens 

 

 

As vantagens desse método de controle giram em torno da sua versatilidade, já que 

ele pode ser utilizado para controlar uma boa variedade de processos, desde 

aqueles com dinâmica relativamente simples, até os mais complexos, incluindo 

sistemas com tempo morto ou instáveis; o caso multivariável pode ser facilmente 

tratado; há uma compensação intrínseca de tempo morto; é uma metodologia aberta 

baseada em alguns princípios básicos que permitem futuras extensões (CAMACHO 

e BORDONS, 2000). 

A principal desvantagem é a necessidade de um modelo representativo e atualizado 

do processo, já que o algoritmo do MPC depende de um conhecimento prévio desse 



62 

modelo. No controle clássico (que utiliza os controladores PID), não há a 

necessidade de um modelo extremamente rigoroso, já este último lida apenas com o 

erro entre a variável controlada e o set-point. 

 

 

5.1.4 Elementos Básicos 

 

 

Os algoritmos MPC possuem elementos comuns. Tais elementos são: o modelo de 

predição, a função objetivo e a obtenção da lei de controle (sequência de ações das 

variáveis manipuladas) (CAMACHO e BORDONS, 2000). 

 

 

Modelo de Predição 

 

 

O modelo de predição é o elemento mais importante do MPC, todos os outros 

elementos desse método serão definidos em relação a ele. Tal modelo é utilizado 

para prever o comportamento do processo, devendo ser capaz de capturar 

completamente a dinâmica do processo e também permitir que as predições sejam 

calculadas no mesmo tempo, ser intuitivo, estar atualizado e permitir uma análise 

teórica (CAMACHO e BORDONS, 2000). 

 

 

Função Objetivo 

 

 

Diferentes funções custo são propostas para os algoritmos MPC, sendo que a 

otimização dessa função é feita em tempo real. 

Na função custo é possível considerar parâmetros como horizonte de predição e 

horizonte de controle; também podem ser incluídas restrições, já que, na prática, 

todos os processos estão sujeitos a restrições (CAMACHO e BORDONS, 2000). 

 

 



63 

Obtenção da Lei de Controle 

 

 

A Lei de Controle é obtida a partir da otimização (minimização) da função custo. 

Para tanto, os valores das saídas preditas são calculadas como função dos valores 

anteriores das entradas e das saídas e dos futuros sinais de controle, fazendo uso 

do modelo escolhido e substituindo na função custo (CAMACHO e BORDONS, 

2000). 

 

 

5.2 Controle preditivo de horizonte finito com modelo em espaço de 

estados na forma incremental 

 

 

Considerando que o processo a ser controlado pode ser representado pelo seguinte 

modelo em espaço de estados: 

 

                    5-1 

           5-2 

 

onde: 

       ,         e                   

   é o número de variáveis manipuladas 

   é o número de variáveis controladas 

 

Métodos de conversão do modelo de função de transferência representado na 

Tabela 4-5 para o modelo em variáveis de estado usual (posicional) podem ser 

encontrados em Ogata (2002), e métodos para a conversão do modelo em variáveis 

de estado posicional para o modelo em variáveis de estado incremental podem ser 

encontrados em Maciejowski (2002). 

 



64 

Assumindo também que o estado      seja conhecido para o passo de tempo  , 

então o controlador preditivo calcula a sequência de controle       ,     

    , ,            que minimiza a seguinte função objetivo: 

 

               
     

 

   

                           

   

   

          5-3 

 

onde p é o horizonte de predição; m é o horizonte de controle; y
sp

 é valor desejado 

para as variáveis controladas;                              ;   e   são 

matrizes de pesos com dimensões apropriadas. 

Usando o modelo definido na Equação 5-1 e na Equação 5-2, pode-se representar o 

vetor de saídas preditas como: 

 

                                    

                                                               

                                                      

                                                                        

                                                               

 

Supondo que  

 

                          5-4 

 

ou que as entradas manipuladas permaneçam constantes depois do instante de 

tempo    , então com a hipótese adotada na Equação 5-4, as saídas preditas 

podem ser escritas da seguinte maneira: 

 

 
 
 
 
 
 
 

        

        
 

        

          
 

         
 
 
 
 
 
 

 

 
 
 
 
 
 
 

  
   

 
   

     

 
    

 
 
 
 
 
 

     

 
 
 
 
 
 
 

     
       
    

               
              

    
                    

 
 
 
 
 
 

 

       

         
 

           

  

5-5 



65 

A Equação 5-5 da saída predita pode ser apresentada na seguinte forma: 

 

                   

 

onde:  

 

  

 
 
 
 
 
 
 

  

   

 

   

     

 

    
 
 
 
 
 
 

,    

 
 
 
 
 
 
 

     

       

    

               

              

    

                    
 
 
 
 
 
 

       

       

         
 

           

  

 

O vetor de set-points como                         
 

 

 

, assim como as matrizes de 

pesos estendidas                   
 

  e                   
 

 . 

Então, a função custo de controle pode ser escrita da seguinte maneira: 

 

                    
      

 

   

                
        

 
  

   

   

    5-6 

 

A função custo pode então ser reduzida à forma quadrática: 

 

      
 
          

        

onde 

              

   
                     

                                 

 

A lei de controle do MPC baseada no modelo de espaço de estados incremental 

resulta da seguinte QP (Programação Quadrática): 

 



66 

   
   

   
 
          

     

     

                  ,              

                      ,              

5-7 

 

No problema definido em 5-7, o vetor de entradas pode ser relacionado com o vetor 

de variação das entradas, que são as varáveis de decisão do problema, conforme é 

mostrado a seguir: 

 

                  

 

onde: 

 

    

      
        
    

          

  

 

    

   
   
 

   

  

 

 

5.3 Controle preditivo de horizonte finito com faixas para as variáveis 

controladas 

 

 

Na maioria dos processos industriais controladas por MPC, as saídas controladas 

não têm set-points, mas apenas faixas onde essas variáveis devem ser mantidas. 

Assim, o controlador preditivo apresentado na seção anterior tem que ser modificado 

para acomodar essa situação prática. 

Na extensão do controlador preditivo convencional apresentada por González e 

Odloak (2009), os valores dos set-points que antes eram parâmetros de entrada do 

modelo passam a ser considerados variáveis adicionais do problema de controle e 



67 

devem ser incluídas novas restrições de valores máximos e mínimos para essas 

novas variáveis. 

 

Supondo que: 

 

             

 

onde: 

 

                    
 

 

 

 

 

A função custo dada pela Equação 5-6 de controle pode ser escrita na seguinte 

forma: 

 

                     
                        

       
 
      

 

Considerando as matrizes na forma estendida para que as variáveis controladas 

sejam incluídas: 

 

             

 

           
     

 

            

 

            

 

Assim a função objetivo pode ser escrita da seguinte maneira: 

 

        
 
     

 
                   

                   
          

      
 
  

 
          

 



68 

A função objetivo pode ser reduzida à forma quadrática: 

 

        
 
              

             

 

onde: 

 

           
 
           

 
     

  
                 

                          

 

A lei de controle do MPC baseado no controle das saídas por faixas resulta na 

seguinte QP: 

 

   
   

     
 
              

       

     

                  ,              

                      ,             

      
        

5-8 

 

Como consequência de trabalhar-se com modelos em variáveis de estado, surge a 

necessidade de estimar o estado do sistema a partir das medidas das variáveis 

controladas (saídas). Um dos estimadores de estado mais eficientes é o Filtro de 

Kalman, que foi originalmente desenvolvido para a estimação do estado de sistemas 

lineares, mas pode ser adaptado para a estimação do estado de sistemas não 

lineares. Inicialmente será apresentado o desenvolvimento desse estimador para 

sistemas lineares. Considerando então um sistema linear representado pelo 

seguinte modelo em variáveis de estado: 

 

( 1) ( ) ( ) ( )x k A x k B u k w k? ? ? ? ?  

( ) ( ) ( )y k C x k v k? ?  

 



69 

onde w(k) e v(k) são ruídos randômicos associados com os erros no modelo e na 

medida respectivamente. Esses ruídos são admitidos ter valor esperado nulo e 

serem não correlacionados entre si e com nenhuma outra variável do sistema. O 

vetor y(k) é a saída medida, porém tem dimensão menor que o estado x(k). 

Portanto, não é possível calcular diretamente o estado a partir da medida da saída. 

O filtro de Kalman apresenta uma solução para a estimativa de x a partir do 

conhecimento de y. 

 

A estimativa do filtro de Kalman pode ser colocada na forma: 

 

? ?ˆ ˆ ˆ( 1/ ) ( / 1) ( ) ( ) ( ) ( / 1)x k k A x k k B u k K k y k C x k k? ? ? ? ? ? ?  

 

onde: 

 

)/1(ˆ kkx ?  é a estimativa de )1( ?kx  baseada em informações da planta até o 

instante k. 

K é o ganho do filtro que é calculado pelas seguintes equações (ASTROM e 

WITTENMARK, 1990): 

 

? ? 1??? TT CPCVCPAK  

? ? WAPCCPCVCPAAPAP TTTT ???? ?1  
 

onde W e V são as matrizes de covariância de w(k) e v(k) respectivamente. 

 

 

5.4 Simulação e Análise dos Resultados 

 

 

Nesta seção, serão realizados os estudos dos controladores preditivos com 

horizonte finito com valores de set-points fixos para as variáveis controladas e com 

faixas nas variáveis de saída utilizando a alimentação em golfadas do poço e as 

funções de transferência identificadas no capítulo anterior. Foi necessária a 



70 

utilização do Filtro de Kalman para se estimar o estado do sistema a partir das 

medidas das variáveis controladas e com isso evitar que as variáveis controladas 

divirjam após terem convergido para o set-point devido ao sistema possuir funções 

de transferência instáveis. 

 

 

5.4.1 Controle preditivo da plataforma de petróleo com set-points fixos 

 

 

Os valores iniciais, valores mínimos e máximos das variáveis manipuladas e os 

valores iniciais e os set-points das variáveis controladas são apresentados na 

Tabela 5-1 e na Tabela 5-2, respectivamente. 

 

Tabela 5-1 - Valor inicial, mínimo e máximo das variáveis manipuladas do sistema. 

Variável Manipulada 
Valor 
Inicial 

Valor 
Mínimo 

Valor 
Máximo 

Abertura da válvula de saída de gás do 
separador trifásico 

0,3044 0 1 

Abertura da válvula de saída de óleo do 
separador trifásico 

0,6056 0 1 

Abertura da válvula de saída de gás do 
separador bifásico 1 

0,4664 0 1 

Abertura da válvula de saída de óleo do tratador 
eletrostático 

0,4783 0 1 

Abertura da válvula de saída de gás do 
separador bifásico 2 

0,6030 0 1 

Abertura da válvula de saída de óleo do 
separador bifásico 2 

0,7563 0 1 

Abertura da válvula de saída de água do 
hidrociclone do separador trifásico 

0,3969 0 1 

Abertura da válvula de saída de rejeito de 
óleo/água no hidrociclone do separador trifásico 

0,5000 0 1 

Abertura da válvula de saída de água do 
hidrociclone do tratador eletrostático 

0,2424 0 1 

Abertura da válvula de saída de rejeito de 
óleo/água do hidrociclone do tratador 
eletrostático 

0,5000 0 1 

 

 

 



71 

 

Tabela 5-2 - Valor inicial e set-points das variáveis controladas do sistema. 

Variável Controlada Valor Inicial Valor Set-Point 

Nível da água na câmara de 
separação do separador trifásico 

0,50 m 0,55 m 

Nível da câmara de óleo do 
separador trifásico 

0,49 m 0,60 m 

Pressão do separador trifásico 10,00 bar 10,00 bar 

Nível do separador bifásico 1 1,00 m 1,00 m 

Pressão do separador bifásico 1 7,50 bar 7,50 bar 

Nível do tratador eletrostático 1,50 m 1,50 m 

Nível do separador bifásico 2 1,50 m 1,50 m 

Pressão do separador bifásico 2 5,00 bar 5,00 bar 

 

O tempo de amostragem considerado na simulação foi equivalente a 3 segundos 

devido à dinâmica rápida das pressões nos vasos. Para horizonte de predição foi 

escolhido p=100 e para horizonte de controle m=15, por tentativa e erro.  

Para a sintonia do controlador as variáveis controladas foram levadas ao seu 

respectivo set-point uma de cada vez, depois em conjuntos de duas e assim por 

diante até que todas as variáveis fossem controladas ao mesmo tempo. 

 

A sintonia utilizada é apresentada na Tabela 5-3. 

 

Tabela 5-3 - Sintonia utilizada. 

Parâmetro de Sintonia Valor Escolhido 

                  
                         

 

Os resultados das simulações considerando set-points fixos para as saídas 

controladas estão apresentados na Figura 5-1 até a Figura 5-10: 

 



72 

 

Figura 5-1 - Vazão de saída de óleo do poço 

 

 

 

Figura 5-2 - Nível de água no Separador Trifásico. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.08

0.085

0.09

0.095

0.1

0.105

0.11

0.115

0.12
Variáveis do Poço

t (h)

V
a
z
ã
o
(m

³/
s
)

 

 

Saída de Petróleo do Poço

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.2

0.25

0.3

0.35

0.4

0.45

0.5

0.55

0.6

0.65
Variáveis Controladas - Separador Trifásico

t (h)

N
ív

e
l 
(m

)

 

 

y1-nível da água no separador trifásico

y1 set-point



73 

 

Figura 5-3 - Nível de óleo no Separador Trifásico. 

 

 

 

Figura 5-4 - Pressão no Separador Trifásico. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9
Variáveis Controladas - Separador Trifásico

t (h)

N
ív

e
l 
(m

)

 

 

y2-nível de óleo no separador trifásico

y2 set-point

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
9

9.2

9.4

9.6

9.8

10

10.2

10.4

10.6

10.8

11
Variáveis Controladas - Separador Trifásico

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y3-pressão do separador trifásico

y3 set-point



74 

 

Figura 5-5 - Nível de óleo no Separador Bifásico 1. 

 

 

 

Figura 5-6 - Pressão no Separador Bifásico 1. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Separador Bifásico 1

t (h)

N
ív

e
l 
(m

)

 

 

y4-Nível no separador bifásico 1

y4 set-point

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
6

6.5

7

7.5

8

8.5
Variáveis Controladas - Separador Bifásico 1

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y5-Pressão no separador bifásico 1

y5 set-point



75 

 

Figura 5-7 - Nível no Tratador Eletrostático. 

 

 

 

Figura 5-8 - Nível de óleo no Separador Bifásico 2. 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Tratador Eletrostático

t (h)

N
ív

e
l 
(m

)

 

 

y6-Nível do tratador eletrostático

y6 set-point

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Tratador Separador Bifásico 2

t (h)

N
ív

e
l 
(m

)

 

 

y7-Nível no separador bifásico 2

y7 set-point



76 

 

Figura 5-9 - Pressão no Separador Bifásico 2. 

 

 

 

Figura 5-10 - Vazão de óleo saída do Separador Bifásico 2 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
3.5

4

4.5

5

5.5

6

6.5
Variáveis Controladas - Tratador Separador Bifásico 2

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y8 - Pressão no separador bifásico 2

y8 set-point

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.05

0.06

0.07

0.08

0.09

0.1

0.11

Saída de Óleo da Planta

t (h)

V
a
z
ã
o
(m

³/
s
)

 

 

Saída de Óleo do Último Separador Bifásico



77 

A análise dos resultados obtidos mostra que o controlador preditivo cumpriu o seu 

papel de forma excelente mantendo todas as variáveis controladas muito próximas 

de seus set-points apesar da sequência de golfadas que atinge a plataforma. 

As golfadas são representadas na Figura 5-1, que representa a vazão total do fluído 

(óleo, água e gás) que deixa o poço. Como resultado desses distúrbios, existe 

alguma oscilação nos valores das variáveis controladas como pode ser observado 

para os casos do nível de água e óleo e pressão do separador trifásico (Figura 5-2, 

Figura 5-3 e Figura 5-4). Além disso, nota-se que o perfil da vazão de saída de óleo 

da planta trifásica (Figura 5-10) apresenta o padrão das golfadas de entrada (Figura 

5-1), com amplitudes menores. Isso significa que o controlador preditivo com set-

points fixos, está transferindo quase que totalmente os distúrbios na vazão de 

entrada de óleo para a vazão de óleo na saída da plataforma. 

Tal perfil é indesejado, por isso será implementado o controle preditivo com faixas 

nas variáveis controladas. Esse método será utilizado na tentativa de aproveitar 

melhor os níveis dos vasos ao longo do processo, de maneira que o perfil acima seja 

amenizado. 

 

 

5.4.2 Controle preditivo da plataforma de petróleo com controle por faixas para 

as variáveis controladas 

 

 

Os valores iniciais, valores mínimos e máximos das variáveis manipuladas e os 

valores iniciais e os valores mínimos e máximos das variáveis controladas são 

apresentados na Tabela 5-4 e na Tabela 5-5, respectivamente. 

 

 

 

 

 

 

 

 

 



78 

Tabela 5-4 - Valor inicial, mínimo e máximo das variáveis manipuladas do sistema. 

Variável Manipulada 
Valor 
Inicial 

Valor 
Mínimo 

Valor 
Máximo 

Abertura da válvula de saída de gás do 
separador trifásico 

0,3044 0 1 

Abertura da válvula de saída de óleo do 
separador trifásico 

0,2510 0 1 

Abertura da válvula de saída de gás do 
separador bifásico 1 

0,3498 0 1 

Abertura da válvula de saída de óleo do tratador 
eletrostático 

0,3587 0 1 

Abertura da válvula de saída de gás do 
separador bifásico 2 

0,3015 0 1 

Abertura da válvula de saída de óleo do 
separador bifásico 2 

0,3781 0 1 

Abertura da válvula de saída de água do 
hidrociclone do separador trifásico 

0,2825 0 1 

Abertura da válvula de saída de rejeito de 
óleo/água no hidrociclone do separador trifásico 

0,5000 0 1 

Abertura da válvula de saída de água do 
hidrociclone do separador bifásico 1 

0,3621 0 1 

Abertura da válvula de saída de rejeito de 
óleo/água do hidrociclone do separador bifásico 
1 

0,5000 0 1 

 

 

Tabela 5-5 - Valor inicial, mínimo e máximo das variáveis controladas do sistema. 

Variável Controlada Valor Inicial Valor Mínimo Valor Máximo 

Nível da água na câmara de 
separação do separador trifásico 

0,50 m 0,25 m 0,60 m 

Nível da câmara de óleo do 
separador trifásico 

0,49 m 0,20 m 0,80 m 

Pressão do separador trifásico 10,00 bar 9,50 bar 10,50 bar 

Nível do separador bifásico 1 1,00 m 0,42 m 2,80 m 

Pressão do separador bifásico 1 7,50 bar 6,50 bar 8,00 bar 

Nível do tratador eletrostático 1,50 m 0,42 m 2,80 m 

Nível do separador bifásico 2 1,50 m 0,42 m 2,80 m 

Pressão do separador bifásico 2 5,00 bar 4,00 bar 6,00 bar 

 

O tempo de amostragem do controlador foi também de 3 segundos devido à 

dinâmica rápida das pressões nos vasos. Para horizonte de predição foi escolhido 

p=100 e para horizonte de controle m=15 baseado na tentativa e erro. 



79 

A sintonia utilizada é apresentada na Tabela 5-6. 

 

Tabela 5-6 - Sintonia utilizada. 

Parâmetro de Sintonia Valor Escolhido 

                               
                       

 

Os resultados das simulações estão apresentados nas Figura 5-11 a Figura 5-20. 

 

 

 

Figura 5-11 - Vazão de saída de óleo do poço 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.08

0.085

0.09

0.095

0.1

0.105

0.11

0.115

0.12
Variáveis do Poço

t (h)

V
a
z
ã
o
(m

³/
s
)

 

 

Saída de Petróleo do Poço



80 

 

Figura 5-12 - Nível de água no Separador Trifásico. 

 

 

 

Figura 5-13 - Nível de óleo no Separador Trifásico. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.2

0.25

0.3

0.35

0.4

0.45

0.5

0.55

0.6

0.65
Variáveis Controladas - Separador Trifásico

t (h)

N
ív

e
l 
(m

)

 

 

y1-nível da água no separador trifásico

y1 min

y1 max

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9
Variáveis Controladas - Separador Trifásico

t (h)

N
ív

e
l 
(m

)

 

 

y2-nível de óleo no separador trifásico

y2 min

y2 max



81 

 

Figura 5-14 - Pressão no Separador Trifásico. 

 

 

 

Figura 5-15 - Nível no Separador Bifásico 1. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
9

9.2

9.4

9.6

9.8

10

10.2

10.4

10.6

10.8

11
Variáveis Controladas - Separador Trifásico

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y3-pressão do separador trifásico

y3 min

y3 max

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Separador Bifásico 1

t (h)

N
ív

e
l 
(m

)

 

 

y4-Nível no separador bifásico 1

y4 min

y4 max



82 

 

Figura 5-16 - Pressão no Separador Bifásico 1. 

 

 

 

Figura 5-17 - Nível do Tratador Eletrostático. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
6

6.5

7

7.5

8

8.5
Variáveis Controladas - Separador Bifásico 1

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y5-Pressão no separador bifásico 1

y5 min

y5 max

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Tratador Eletrostático

t (h)

N
ív

e
l 
(m

)

 

 

y6-Nível do tratador eletrostático

y6 min

y6 max



83 

 

Figura 5-18 - Nível no Separador Bifásico 2. 

 

 

 

Figura 5-19 - Pressão no Separador Bifásico 2. 

 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.5

1

1.5

2

2.5

3
Variáveis Controladas - Tratador Separador Bifásico 2

t (h)

N
ív

e
l 
(m

)

 

 

y7-Nível no separador bifásico 2

y7 min

y7 max

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5
3.5

4

4.5

5

5.5

6

6.5
Variáveis Controladas - Tratador Separador Bifásico 2

t (h)

P
re

s
s
ã
o
 (

b
a
r)

 

 

y8 - Pressão no separador bifásico 2

y8 min

y8 max



84 

 

Figura 5-20 - Vazão de óleo do Separador Bifásico 2. 

 

Observando a Figura 5-11 até a Figura 5-20, nota-se que o controlador conseguiu 

manter as variáveis controladas dentro das suas respectivas faixas e ainda utilizou 

as faixas dos níveis dos vasos do separador trifásico (Figura 5-12 e Figura 5-13), do 

primeiro separador bifásico (Figura 5-15) e do segundo separador bifásico (Figura 

5-18) para amortecer os efeitos da alimentação em golfadas (Figura 5-11) sobre as 

demais vazões do processo. 

Esse resultado pode ser comprovado pela Figura 5-20, na qual nota-se que a vazão 

de saída de óleo da planta apresenta um perfil totalmente diferente do perfil da 

alimentação deixando de ter o formato de “h” com um grande pico no início de cada 

ciclo de golfadas, passando a ter um perfil com oscilações de menor amplitude. 

Na Figura 5-21, observa-se que com o controlador preditivo com faixas, a amplitude 

das oscilações foram reduzidas para menos de 1/3 do valor da amplitude das 

oscilações resultantes da aplicação do controlador preditivo com set-points fixos. 

 

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.05

0.06

0.07

0.08

0.09

0.1

0.11

Saída de Óleo da Planta

t (h)

V
a
z
ã
o
(m

³/
s
)

 

 

Saída de Óleo do Último Separador Bifásico



85 

 

Figura 5-21 - Vazão de óleo da Planta para o MPC convencional (com set-points fixos) e MPC com 

faixas. 

 

Na Figura 5-14, a pressão do separador trifásico acaba ultrapassando o limite 

máximo de pressão e oscilando bastante com baixa amplitude para depois retornar a 

faixa definida para esta variável. Como a dinâmica da pressão é muito mais rápida 

que a dinâmica das demais variáveis do processo, podemos atribuir esse 

comportamento mais a problemas numéricos do solver utilizado para resolver o 

modelo não-linear do que a problemas com o controlador. 

O nível de água do tratador eletrostático (Figura 5-17), não apresenta variações, isso 

pode ser justificado pelo fato do equipamento ter que operar em uma faixa de nível 

restrita para que ocorra a separação correta da água do óleo. Assim, a sintonia do 

controlador deve contemplar essa condição. 

Diante dos resultados obtidos, conclui-se que o controlador preditivo com faixas nas 

variáveis controladas garante uma saída de óleo da planta com menores oscilações 

por utilizar as faixas nos níveis dos equipamentos para compensar as golfadas. 

Desta maneira os objetivos desse trabalho foram alcançados. 

  

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

0.05

0.06

0.07

0.08

0.09

0.1

0.11

Saída de Óleo da Planta

t (h)

V
a
z
ã
o
(m

³/
s
)

 

 

Saída de Óleo do Último Separador Bifásico - MPC convencional

Saída de Óleo do Último Separador Bifásico - MPC com faixas



86 

6 CONSIDERAÇÕES FINAIS 

 

 

6.1 Conclusões 

 

 

Neste trabalho foram apresentados os modelos de extração do petróleo pelo 

processo Gas-lift e o processo de uma planta trifásica de processamento primário de 

petróleo. A partir da simulação da plataforma usando os modelos rigorosos não-

lineares, foi possível realizar a identificação das funções de transferência do 

processo. As funções de transferência levantadas estão aderentes aos dados do 

modelo rigoroso do processo. Também foram aplicados os controladores preditivos 

com set-points e com faixas nas variáveis controladas. Os resultados foram 

satisfatórios e mostraram que o controlador preditivo com faixas nas variáveis 

manipuladas é melhor que o controlador preditivo com set-points, uma vez que 

garantiu uma produção de óleo com menor oscilação e conseguiu manter todas as 

variáveis controladas dentro das suas respectivas faixas de maneira adequada. A 

menor oscilação da vazão de saída da planta foi obtida através das variações dos 

níveis dos equipamentos dentro dos limites das faixas. 

Como resultado final desde trabalho, fica uma boa perspectiva para a aplicação do 

controlador preditivo com controle das saídas por faixas em sistemas trifásicos em 

plataformas offshore reais. Essa aplicação parece atraente em termos de melhorias 

na performance do sistema de controle e perfeitamente factível em termos de 

esforço computacional. Nas simulações aqui apresentadas, período de amostragem 

de 3s foi suficiente para um controle adequada tanto das dinâmicas lentas quanto 

das dinâmicas rápidas do processo da plataforma. Os computadores atuais 

conseguem resolver o problema de controle preditivo proposto em um tempo menor 

que 1/10 desse período de amostragem. 

 

 

 

 



87 

6.2 Sugestões de continuidade 

 

 

Diante de uma série de dificuldades e restrições enfrentadas durante o 

desenvolvimento dos estudos, podem-se sugerir alguns pontos para trabalhos 

futuros. 

Seria interessante estudar a possibilidade de representar o modelo rigoroso em 

algum simulador comercial, já que os solvers do MATLAB
®
 enfrentaram certa 

dificuldade para resolver o conjunto das equações diferenciais do modelo, gerando 

assim um modelo não tão robusto quanto era esperado. 

Uma sugestão de melhoria seria utilizar dados reais de uma planta de separação 

trifásica para se realizar esse tipo de estudo, uma vez que todos os dados de 

dimensão dos equipamentos e valores iniciais para as vazões foram retirados de 

Nunes et al (2010) e Filgueiras (2005). 

Além disso, outra possibilidade de estudo seria separar o controle de pressão dos 

controles de níveis, permitindo adotar tempos de amostragem diferentes, já que o 

controle de pressão é mais rápido que o controle de nível. Assim poderiam ser 

aplicados controladores do tipo PI para controlar as pressões dos equipamentos e 

utilizar um controlador MPC para o restante das variáveis controladas ou aplicar dois 

controladores MPC, um para a pressão e outro para o nível dos equipamentos. 



88 

REFERÊNCIAS
1
 

 

 

AZEVEDO, D. O., SOTOMAYOR, O. A. Z. Controle de escoamentos no regime de 
golfadas em processos de produção de petróleo. Mecânica Computacional XXIX, 
8447-8461, 2010. 
 
 
ASTROM, K. J., WITTENMARK, B., Computer-Controlled Systems Theory and 
Design. Prentice-Hall International Inc. New Jersey, 1990. 
 
 
CAMACHO, E. F., BORDONS, C. Model Predictive Control, Springer, 2000. 
 
 
CUTLER, C. R., RAMAKER, B. L. Dynamic Matrix Control – A Computer control 
Algorithm, Proceedings Joint Automatic Control Conference, San Francisco, CA 
(EUA), 1980. 
 
 
DURET, E., PEYSSON, Y., TRAN, Q. H., ROUCHON, P. Active bypass to 
eliminate severe-slugging in multiphase production, Proceeding of the 4

th
 North 

American Conference on Multiphase Technology, Banff, June, J. Brill, ed., Cranfield, 
2004,BHR Group Limited, 205-223 , 2004. 
 
 
FARD, M. P., GODHAVN, J. M., SAGATUN, S. I. Modeling of severe slug and slug 
control with OLGA, SPE Productions &amp;amp; Operations 2006, 21, 3, 381-387, 2006. 
 
 
FILGUEIRAS, N. G. T. Modelagem, Análise e Controle de Separação Óleo/Água. 
2005. 86 p. Dissertação de mestrado. Universidade Federal do Rio de Janeiro, Rio 
de Janeiro, Brasil, 2005. 
 
 
GARCIA, C. E., MORSHEDI, A. M. Quadratic Programming Solution of Dynamic 
Matrix Control (QDMC). Chemical Engeneering Communications 46, 73-87, 1986. 
 
 
GODHAVN, J. M., FARD, M. P., FUCHS, P. H. New slug control strategies, tuning 
rules and experimental results. Journal of Process Control 15, 547–557, 2005. 
 
 
GODHAVN, J. M., STRAND, S., SKOFTELAND, G. Increased oil production by 
advanced control of receiving facilities. Statoil R&amp;amp;D Process Control, 2005. 
 

                                            
1
 De acordo com a Associação Brasileira de Normas Técnicas. NBR 6023 



89 

GONZÁLEZ, A. H., ODLOAK, D. A stable MPC with zone control, Journal of 
Process Control, 19, 110-122, 2009. 
 
 
HENRIOT, K., COURBOT, A., HEINTZE, E., MOYEUX, L. Simulation of process to 
control severe slugging: Application to the Dunbar pipeline, SPE Annual 
Conference&amp;amp; Exhibition, SPE 56461, Houston, TX , 1999. 
 
 
JAHANSHAHI, E., SALAHSHOOR, K., SAHRAIE, Y. Application of fuzzy observer 
and controller in gas-lifted oil wells. Petroleum University of Technology, Tehran, 
Iran, 2007. 
 
 
MACIEJOWSKI, J. M. Predictive Control with Constraints. Pearson Eductation 
Ltd, London, 2002. 
 
 
MORAES, C. A. C. Modelo Fluidodinâmico para a Estimativa de Eficiência em 
Hidrociclones para Águas Oleosas. Dissertação de mestrado. Universidade 
Federal do Rio de Janeiro, Rio de Janeiro, Brasil, 1994. 
 
 
NUNES, G. C., MEDEIROS, J. L., ARAÚJO, O. Q. F. Modelagem e controle na 
produção de petróleo: aplicações em Matlab. São Paulo, Editora Blucher, 2010. 
 
 
NUNES, G. C. Design and analysis of multivariable predictive control applied to 
an oil-water-gas separator: a polynomial approach. D. Sc. Thesis, University of 
Florida, 2001. 
 
 
NUNES, G. C. Controle por Bandas para Processamento Primário: Aplicação e 
conceitos fundamentais, PETROBRAS – Comunicação Técnica, 2004. 
 
 
OGATA, K, Modern Control Engineering, Prentice Hall, 4

th
 Ed. 2002. 

 
 
RICHALET, J., RAULT, A., TESTUD, J. L., PAPON, J. Model Predictive Heuristic 
Control: Applications to industrial processes, Automatica 14, 413-428, 1978. 
 
 
STORKAAS, E., SKOGESTAD, S., Controllability analysis of two-phase pipeline 
riser systems at riser slugging conditions, Control Engineering Practice 15, 567-
581, 2007. 
 
 
THOMAS, J. E, Fundamentos de Engenharia de Petróleo. Editora Interciência 
Ltda, Rio de Janeiro, 2001. 


</field>
	</doc>
</add>