<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20223</field>
		<field name="filename">3681_DISSERTA%c3%87%c3%83O%20Gustavo%20Galindez%20Ramirez.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade Federal de Pernambuco
Centro de Tecnologia e Geociências

Departamento de Engenharia Mecânica

Gustavo Galindez Ramirez

Método Espectral dos Volumes Finitos para a Simulação 1-D de Escoamentos Bifásicos
em Reservatórios de Petróleo

Dissertação de Mestrado

Recife, 2014.



Gustavo Galindez Ramirez

Método Espectral dos Volumes Finitos para a Simulação 1-D de
Escoamentos Bifásicos em Reservatórios de Petróleo

Dissertação apresentada ao Programa de Pós-graduação
em Engenharia Mecânica do Centro de Tecnologia e Ge-
ociências da Universidade Federal de Pernambuco, como
requisito parcial para obtenção do grau de Mestre em
Engenharia Mecânica.

Orientador: Paulo Roberto Maciel Lyra
Co-orientador: Darlan Karlo Elisiário de Carvalho

Recife, 2014.



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Catalogação na Fonte 

Bibliotecária Margareth Malta, CRB-4 / 1198 

 

 R173m      Ramirez, Gustavo Galindez. 
Método espectral dos volumes finitos para simulação 1-D de 

escoamentos bifásicos em reservatórios de petróleo / Gustavo Galindez 

Ramirez. - Recife: O Autor, 2014. 

99 folhas, il., gráfs., tabs. 

 

Orientador: Prof. Dr. Paulo Roberto Maciel Lyra. 

Coorientador: Prof. Dr. Darlan Karlo Elisiário de Carvalho. 

Dissertação (Mestrado) – Universidade Federal de Pernambuco. CTG. 

Programa de Pós-Graduação em Engenharia Mecânica, 2014. 

Inclui Referências. 

 

1. Engenharia Mecânica.  2. Reservatórios de petróleo.  3. Escoamentos 

bifásicos.   4. Método dos volumes finitos.  5. Método de alta ordem. 6. 

Método espectral.  I. Lyra, Paulo Roberto Maciel. (Orientador).   II. 
Carvalho, Darlan Karlo Elisiário de. (Coorientador). III. Título. 

      

 

                        UFPE 

 

621 CDD (22. ed.)          BCTG/2015-17 
 



27 de janeiro de 2014 

 

“MÉTODO ESPECTRAL DOS VOLUMES FINITOS PARA SIMULAÇÃO 1-D DE 
ESCOAMENTOS BIFÁSICOS EM RESERVATÓRIOS DE PETRÓLEO” 

 
GUSTAVO GALINDEZ RAMIREZ 

 
ESTA DISSERTAÇÃO FOI JULGADA ADEQUADA PARA OBTENÇÃO DO 

TÍTULO DE MESTRE EM ENGENHARIA MECÂNICA 
 

 
ÁREA DE CONCENTRAÇÃO: MECÂNICA COMPUTACIONAL E PROJETO 

MECÂNICO 
 

APROVADA EM SUA FORMA FINAL PELO 
PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA 

MECÂNICA/CTG/EEP/UFPE 
                                            

____________________________________________________ 
                                          Prof. Dr. PAULO ROBERTO MACIEL LYRA 

                                       ORIENTADOR/PRESIDENTE 
                                            

____________________________________________________ 
                                          Prof. Dr. DARLAN KARLO ELISIÁRIO DE CARVALHO 

                                       CO-ORIENTADOR 
 

____________________________________________________ 
          Prof. Dr. JORGE RECARTE HENRÍQUEZ GUERRERO 

                                            COORDENADOR DO PROGRAMA 
 
 
BANCA EXAMINADORA: 
 
_________________________________________________________________ 
Prof. Dr. PAULO ROBERTO MACIEL LYRA (UFPE) 
 
_________________________________________________________________ 
Prof. Dr. DARLAN KARLO ELISIÁRIO DE CARVALHO (UFPE) 
 
_________________________________________________________________ 
Prof. Dr. RAMIRO BRITO WILLMERSDORF (UFPE) 
 
_________________________________________________________________ 
Prof. Dr. JOÃO LUIZ FILGUEIRAS DE AZEVEDO (IAE) 
 
_________________________________________________________________ 
Prof. Dr. ALESSANDRO ROMARIO ECHEVARRIA ANTUNES (UFPE) 



Agradecimentos

À Fundação de Amparo à Ciência e Tecnologia do Estado de Pernambuco (FACEPE)
e ao projeto SIGER, financiado pelo CEMPES-PETROBRAS, pelas bolsas concedidas
durante o período de realização do mestrado.

Aos colegas do grupo PADMEC pela troca de ideias e o apoio recebido.
Ao aluno de mestrado Jan Sourek, da University of West Bohemia, Czech Republic

pela ajuda recebida.
Aos Professores Paulo Lyra, Darlan Karlo Elisiário de Carvalho e Márcio Rodrigo de

Araújo Souza, pela orientação e apoio na minha formação acadêmica.
A meus familiares e amigos, que me acompanharam desde o início desta jornada.



Resumo

As técnicas de discretização de alta ordem podem ser vantajosas quando comparadas
aos métodos upwind de primeira ordem (FOUM), para o modelamento do escoamento
dos fluidos através dos reservatórios de petróleo, em que complexidades físicas, tais como
heterogeneidade e anisotropia desempenham um papel importante, pois essas técnicas
são capazes de produzir soluções muito menos difusivas. Este trabalho tem como objetivo
aplicar o método espectral dos volumes finitos (SFVM), metodologia formulada por Z. J.
Wang em 2002, para o modelamento 1D do escoamento de água e óleo em meios porosos.
Este tipo de recuperação de óleo é conhecido como recuperação secundária. O modelo
matemático, que caracteriza as equações de transporte em meios porosos, inclui os efeitos
da gravidade e da pressão capilar, onde os fluidos são considerados imiscíveis. Neste
modelo matemático, o termo advectivo é discretizado usando o SFVM de alta ordem,
a capilaridade o termo difusivo é aproximada utilizando o método de diferenças finitas
para os volumes de controle (CVFDM) de segunda ordem. A integração no tempo é
feita utilizando o método de Runge-Kutta explícito de terceira ordem. Para satisfazer
a condição tipo TVD (Total Variation Diminishing) e suprimir as oscilações perto das
descontinuidades, um limitador de declividade é usado no estagio de reconstrução. Toda
a formulação desenvolvida foi verificada numericamente através de uma variedade de
problemas modelo. Sempre que possível, os resultados são comparados com a solução
semi-analítica ou com outras soluções numéricas disponíveis na literatura. Os resultados
obtidos no presente trabalho se comparam de maneira favorável com outras metodologias
fornecidas por diferentes autores e apresentaram um bom desempenho, atingindo uma alta
acurácia de forma eficiente. Os perfis de saturação para as ditas simulações mostram a
correta captura da frente de saturação ou choque, e da onda de rarefação. Para o modelo
simples analisado neste trabalho, o uso de métodos de alta ordem produz resultados
acurados e eficientes, o que é ainda mais relevante se aplicações reais em grande escala
são planejados.

Palavras chave: Reservatórios de Petróleo. Escoamentos Bifásicos. Método dos Volu-
mes Finitos. Método de Alta Ordem. Método Espectral.



Abstract

High order discretization techniques may offer advantages relative to standard FOUM
(first order upwind methods) for the modeling of flows through petroleum reservoirs, in
which physical complexities such as heterogeneity and anisotropy play an important role,
because these techniques are capable of producing much less diffusive solutions. The
purpose of this work is to apply a SFVM (spectral finite volume method) methodology
formulated by Z. J. Wang in 2002, for the modeling 1D oil-water displacement through
porous formations. This sort of oil recovery is known as secondary recovery. The mathe-
matical model that characterizes the transport equations in porous media includes the
effects of gravity and capillary pressure, where the fluids are considered immiscible. In
this mathematical model the hyperbolic term is discretized using a high order SFVM, the
capillary (diffusive term) is approximated using a second order CVFDM (control volume
finite difference method). The integration in time is carried out using a third-order explicit
Runge-Kutta method. In order to satisfy the TVD (total variation diminishing) condition
and to suppress numerical oscillations near shocks, a slope limiter is used in the recons-
truction stage. The entire formulation developed was checked numerically by a variety of
problems model. Where it was possible the results are compared with the semi-analytical
solution or other numerical solutions available in the literature. The results obtained in
this study compare favorably with other methods provided by different authors and per-
formed well achieving a high accuracy efficiently. Saturation profiles for said simulations
show the correct capture of the saturation front (shock) wave and rarefaction. The simple
model analyzed in this work shows that the use of high order methods yields accurate and
efficient results, which is even more relevant if real large scale applications are devised.

Keywords: Petroleum Reservoirs. Two Phase Flows. Finite Volume Method. High
Order Methods. Spectral Method.



vii

Lista de Figuras

2.1 (a) Solução inicial descontínua compressiva. (b) Solução no plano x-t. . . . 24
2.2 (a) Condição inicial descontinua de caráter expansiva. (b) Solução do cho-

que de rarefação no plano x-t. . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.3 Onda de rarefação: (a) Condição inicial descontínua de caráter expansiva.

(b) Solução (rarefação) satisfazendo a condição de entropia. . . . . . . . . 25
2.4 (a) Função fadv. (b) Derivada da função fadv, para o modelo de Brooks-

Corey com µo/µw = 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
2.5 Construção do ponto tangencial. . . . . . . . . . . . . . . . . . . . . . . . . 27
2.6 Curva para a função pressão capilar, correspondente aos parâmetros pd = 1,

? = 3, Swr = 0. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
2.7 Curvas para as funções de permeabilidade relativa, correspondente aos pa-

râmetros ? = ? = 2, Swr = Sor = 0. . . . . . . . . . . . . . . . . . . . . . . 30
2.8 Diagrama esquemático das condições de contorno para a equação de satu-

ração, adaptada de (Chavent and Jaffré, 1986). . . . . . . . . . . . . . . . 33
2.9 Solução semi analítica para o problema do Buckley-Leverett (a) e função

fluxo e velocidade característica (b) . . . . . . . . . . . . . . . . . . . . . . 34

3.1 Esquema de primeira ordem de acurácia. . . . . . . . . . . . . . . . . . . . 37
3.2 Esquema de segunda ordem de acurácia. . . . . . . . . . . . . . . . . . . . 41
3.3 Reconstrução linear típica: (a) não limitada e (b) limitada. . . . . . . . . . 43
3.4 Regiões de estabilidade para o esquema de Runge-Kutta. . . . . . . . . . . 46

4.1 Domínio físico com 4 células espectrais SV, utilizando segunda ordem de
acurácia, k = 2, com contornos xi,j?1/2 e xi.j+1/2 para a subcélula espectral
CV e pontos solução (•) S?w(i,j). . . . . . . . . . . . . . . . . . . . . . . . . 49

4.2 (a) Polinômios de Chebyshev até ordem 5. (b) Partições não uniformes
do SV no domínio computacional gerados pelos zeros do polinômio de
Chebyshev, para ordem de acurácia 2 (b.1), ordem 3 (b.2) e ordem 4 (b.3). 51

4.3 Bases polinomiais {L} com variável média no centro da célula utilizando
CV equidistantes para: (a) k=3 e (b) k=6. . . . . . . . . . . . . . . . . . 52

4.4 Surgimento do fenômeno de Runge ao interpolar a função: f(x) = 1
1+12x2

utilizando 16 pontos de interpolação. . . . . . . . . . . . . . . . . . . . . . 53



Lista de Figuras viii

4.5 Bases polinomiais {L} com variável média no centro da célula utilizando
CVs dados pelos pontos de quadratura de Gauss-Lobatto para (a) k=3 e
(b) k=6. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

4.6 Esquema do domínio físico, com uma célula fantasma SV(gho) e três células
espectrais, incluindo a célula interna SV(int) e o contorno SVbnd. . . . . . 61

4.7 Reconstrução polinomial por partes para o SFVM. . . . . . . . . . . . . . . 64

5.1 Detalhe da solução exata e numérica obtida utilizando o método SFVM de
ordem 5 para 64 SVs com CVs uniformes. . . . . . . . . . . . . . . . . . . 71

5.2 Taxa de convergência demostrando a acurácia espectral para o refinamento
h para a equação de onda linear. . . . . . . . . . . . . . . . . . . . . . . . . 72

5.3 Taxa de convergência demostrando a acurácia espectral com o refinamento
p, para a equação de onda linear. . . . . . . . . . . . . . . . . . . . . . . . 73

5.4 Simulação do pulso Gaussiano utilizando SFVM de ordem k = 1,2,3 e 4 no
tempo t=1.0, sem função limitadora. . . . . . . . . . . . . . . . . . . . . . 74

5.5 Simulação de uma onda quadrada feita com o método SFVM para um
tempo final t = 1: (a) sem função limitadora. (b) Utilizando o limitador
SVTVDM. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

5.6 Soluções numéricas para a equação do Burgers no tempo t=0.3 através do
SFVM do ordem 2, com 12 DOFs, graficada junto com a solução numérica
para ordem 4 com 12 graus de liberdade. . . . . . . . . . . . . . . . . . . . 76

5.7 Soluções numéricas para a equação de Burgers no tempo t = 2/? , utili-
zando o SFVM de ordem k = 4, com 80 DOFs, sem função limitadora (a)
e com função limitadora tipo SVTVBM e CVTVBM (b). . . . . . . . . . . 78

5.8 Soluções numéricas para a equação de Burgers no tempo t = 1 , utilizando
o SFVM de ordem k = 4, com 160 DOFs, sem função limitadora (a) e com
função limitadora do tipo SVTVBM e CVTVBM (b). . . . . . . . . . . . . 79

5.9 Comparação entre os perfis de saturação de água para o problema unidi-
mensional de Buckley-Leverett numa malha primal com 16 subdivisões (a)
e numa malha de 32 subdivisões (b) ao longo do eixo x em t=0.2. Solução
semi-analítica e soluções aproximadas obtidas com o SFVM e MUSCL-TVD. 81

5.10 Comparação entre os perfis de saturação de água para o problema unidi-
mensional de Buckley-Leverett numa malha primal com 64 subdivisões (a)
e numa malha de 128 subdivisões (b) ao longo do eixo x em t=0.2. Solução
semi-analítica e soluções aproximadas obtidas com o SFVM e MUSCL-TVD. 82

5.11 Operações de ponto flutuante para o SFVM e MUSCL-TVD. . . . . . . . . 83
5.12 Solução do problema de Buckley-Leverett, utilizando o SFVM de diferentes

ordens de acurácia k = 2, 4, 8 e 16. . . . . . . . . . . . . . . . . . . . . . . . 85
5.13 Função fluxo fracional com efeitos gravitacionais (acima), velocidade ca-

racterística (abaixo) e ponto de choque (símbolo ponto quadrado). . . . . . 86



5.14 Solução do modelo bifásico com efeitos gravitacionais pelo SFVM para um
tempo t = 0.25 (a) e t = 0.5 (b) vs a solução obtida através do método
TB(TVD)-FV de ordem 2 (Durlofsky, 1993). . . . . . . . . . . . . . . . . . 87

5.15 Solução do modelo bifásico sem efeitos gravitacionais (Buckley-Leverett),
utilizando SFVM de segunda ordem de acurácia, para t = 0.25 (a) e t =
0.5 (b) vs a solução obtida através do método TB(TVD)-FV de ordem 2. . 88

5.16 Efeito da pressão capilar no perfil de saturação para diferentes valores de ?. 89
5.17 Modelo do fluxo bifásico com efeitos da pressão capilar, utilizando o SFVM

de diferentes ordens de acurácia e deixando fixo o número de CV, ou seja,
igual número de incógnitas ou DOFs são resolvidas. . . . . . . . . . . . . . 90

5.18 Modelo do fluxo bifásico com efeitos gravitacionais e de pressão capilar
para um tempo t =2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91



Lista de Tabelas

4.1 Coeficientes de reconstrução para CVs não uniformes utilizando a distri-
buição dos pontos de Gauss-Lobatto Eq. (4.32). . . . . . . . . . . . . . . . 59

4.2 Coeficientes de reconstrução para CVs uniformes utilizando utilizando a
distribuição dada na Eq. (4.33). . . . . . . . . . . . . . . . . . . . . . . . . 59

4.3 Posições otimizadas para os contornos dos CVs no domínio computacional. 60

5.1 Avaliação da acurácia do esquema 1-D SFVM, para a equação da onda,
utilizando CV uniformes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

5.2 Avaliação da acurácia do 1-D SFVM, para a equação da onda, utilizando
CV não uniformes gerados pelos pontos de quadratura de Gauss-Lobatto. . 72

5.3 Estudo da acurácia na solução da Equação de Burgers com condição inicial
senoidal no tempo t = 0.3 e volumes de controle não uniformes, gerados
pelos pontos de quadratura de Gauss-Lobatto. . . . . . . . . . . . . . . . . 77

5.4 Tempo da CPU em segundos utilizado pelos resolvedores SFVM e MUSCL-
TVD, para a simulação do problema de Buckley-Leverett. . . . . . . . . . . 84



xi

Nomenclatura

Acrônimos e siglas

ADER Arbitrary Derivative Riemann Problem

CFD Computational Fluid Dynamics

CFL Courant-Friedrichs-Lewy

CV Control Volume

CVFDM Control Volume Finite Difference Method

CVTVBM (CV-wise-TVBM) Limiter

CVTVDM (CV-wise-TVDM) Limiter

DG Discontinuous Galerkin

DOF Degrees of Freedom

EDO Equação Diferencial Ordinária

ENO Essentially-Non-Oscilatory

FCT Flux Correct Transport

FEM Finite Element method

FVM Finite Volume Method

MPFA Multipoint Flux Approximation

MUSCL Monotonic Upstream-Centered Scheme for Conservation Laws

PDE Partial Differential Equation

RK Runge-Kutta Method

SFDM Spectral Finite Difference Method

SFVM Spectral Finite Volume Method



Nomenclatura xii

SV Spectral Volume

SVTVBM (SV-wise-TVBM) Limiter

SVTVDM (SV-wise-TVDM) Limiter

TB(TVD)-FV Triangle-Based TVD-type Finite Volume

TPFA Two Point Flux Aproximation

TV Total variation

TVB Total Variation Bounded

TVD Total Variation Diminishing

VC Volume de controle e célula de malha primal

WENO Weighted Essentially-Non-Oscilatory

Símbolos Latinos

S?w(i,j) Saturação média no CVi,j

S?w Saturação média da fase água no volume de controle

?t Intervalo temporal

S? Função primitiva para a variavél de estado

~n Vetor área normal

S?±w Variáveis reconstruidas limitadas

a Velocidade de propagação da onda

F Função fluxo numérico

fadv Fluxo advectivo

hi,j Comprimento do CV

k Ordem de acurácia

p Ordem do polinômio interpolador

pc Pressão capilar

Q? Vazão da fase ?

Qw Vazão volumetrica específica da fase w



Ri Residuo

S
?

w(i+1/2) Derivada espacial da saturação nas interfaces numéricas

Sw Saturação da fase água

t Instante de tempo

v? Velocidade da fase ?

vt Velocidade total do fluido

Símbolos Gregos

?max Raio espectral da matriz Jacobiana dos fluxos

??ni Função limitadora de inclinação

? Contorno ou fronteira

µ Viscosidade

? Domínio

?? Contorno do domínio

? Porosidade

? Tipo de fase

Subscritos

i Célula espectral

L Lado esquerdo da interface numérica

R Lado direito da interface numérica

Superescritos

n Instante de tempo atual

n + 1 Instante de tempo posterior



xiv

Sumário

1 Introdução 16
1.1 Motivação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
1.3 Organização da dissertação . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2 Equações governantes 20
2.1 Considerações iniciais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
2.2 Problemas modelo da dinâmica dos fluidos . . . . . . . . . . . . . . . . . . 20

2.2.1 Equação linear da advecção . . . . . . . . . . . . . . . . . . . . . . 20
2.2.2 Equação não linear de Burgers . . . . . . . . . . . . . . . . . . . . . 21
2.2.3 O problema de Riemann . . . . . . . . . . . . . . . . . . . . . . . . 23

2.3 Escoamento bifásico e imiscível em meios porosos . . . . . . . . . . . . . . 28
2.3.1 Conceitos fundamentais . . . . . . . . . . . . . . . . . . . . . . . . 28
2.3.2 Condições iniciais e de contorno . . . . . . . . . . . . . . . . . . . . 32
2.3.3 Equação de Buckley-Leverett . . . . . . . . . . . . . . . . . . . . . 33

3 O método dos volumes finitos clássico 35
3.1 Esquema de primeira ordem de acurácia . . . . . . . . . . . . . . . . . . . 36

3.1.1 Formulação geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
3.1.2 Resolvedores de Riemann aproximados . . . . . . . . . . . . . . . . 38

3.2 Esquemas TVD e TVB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
3.3 Esquema de alta ordem de acurácia . . . . . . . . . . . . . . . . . . . . . . 40
3.4 Esquema limitador de declividade . . . . . . . . . . . . . . . . . . . . . . . 42
3.5 Discretização do termo difusivo . . . . . . . . . . . . . . . . . . . . . . . . 43
3.6 Discretização temporal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

4 Método espectral dos volumes finitos 47
4.1 Considerações iniciais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
4.2 Método espectral dos volumes finitos unidimensional . . . . . . . . . . . . 48
4.3 Definição das partições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
4.4 Reconstrução polinomial unidimensional . . . . . . . . . . . . . . . . . . . 53
4.5 Constantes de interpolação polinomial . . . . . . . . . . . . . . . . . . . . 55



4.6 Condições de contorno e iniciais . . . . . . . . . . . . . . . . . . . . . . . . 61
4.6.1 Condição de contorno de Dirichlet . . . . . . . . . . . . . . . . . . . 61
4.6.2 Condições iniciais . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

4.7 Funções limitadoras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
4.8 Avaliação de acurácia dos métodos numéricos . . . . . . . . . . . . . . . . . 66
4.9 Algoritmo geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

5 Aplicações 69
5.1 Estudo da acurácia utilizando a equação da onda linear . . . . . . . . . . . 69

5.1.1 Propagação da onda senoidal . . . . . . . . . . . . . . . . . . . . . 69
5.1.2 Propagação do pulso Gaussiano . . . . . . . . . . . . . . . . . . . . 73
5.1.3 Propagação da onda quadrada . . . . . . . . . . . . . . . . . . . . . 74

5.2 Teste para equação não linear de Burgers . . . . . . . . . . . . . . . . . . . 75
5.3 Modelo do fluxo bifásico . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80

5.3.1 Problema de Buckley-Leverett . . . . . . . . . . . . . . . . . . . . . 80
5.3.2 Efeitos gravitacionais . . . . . . . . . . . . . . . . . . . . . . . . . . 86
5.3.3 Efeitos da pressão capilar . . . . . . . . . . . . . . . . . . . . . . . 89
5.3.4 Efeitos gravitacionais e da pressão capilar . . . . . . . . . . . . . . 91

6 Conclusões e trabalhos futuros 92

Referências Bibliográficas 94



16

Capítulo 1

Introdução

1.1 Motivação

I números reservatórios de petróleo de interesse econômico e particularmente os re-servatórios do pré-sal, apresentam uma variação muito acentuada das propriedades
geofísicas tanto em termos espaciais como direcionais (i.e. heterogeneidade e anisotropia),
requerendo uma modelagem numérico-computacional acurada e eficiente dos processos
envolvidos no escoamento multifásico em meios porosos.

De fato a simulação de escoamentos multifásicos em reservatórios de petróleo com ge-
ometrias e características complexas, ainda é um problema desafiador. Contudo, levando
em consideração que existem atualmente formulações clássicas relativamente bem sucedi-
das utilizando-se os métodos das diferenças finitas, elementos finitos ou volumes finitos,
ainda se apresentam algumas questões a serem resolvidas.

O principal problema tem relação com a acurácia da solução numérica. De fato, uma
anomalia das formulações clássicas que decrementa a acurácia e surge com maior inten-
sidade na simulação de reservatórios de petróleo é a difusão numérica. A referida difusão
numérica causa demasiada suavização da solução perto de descontinuidades e gradientes
acentuados. Do ponto de vista físico, as descontinuidades podem ser entendidas como as
interfaces entre fases fluídicas, quando ocorre o fenômeno de deslocamento dos fluidos no
interior do meio poroso (Chavent and Jaffré, 1986). A ocorrência do fenômeno da difu-
são numérica têm sua origem nas interpolações pouco acuradas utilizadas nos métodos
de baixa ordem de acurácia, como por exemplo no esquema upwind de primeira ordem.
Estes métodos de primeira ordem são muito utilizados para aproximar termos advecti-
vos na área de simulação de reservatórios devido à sua simplicidade, além de garantir a
monotonicidade das soluções numéricas.

Para lidar com o problema da difusão numérica na literatura existem inúmeras me-
todologias que são denominadas de alta ordem, tais como; esquemas centrais clássicos,
como por exemplo o MC (MacCormack scheme) - TVD (Total Variation Diminishing),
esquemas do tipo MUSCL (monotonic upstream centered scheme for conservation laws)



1. Introdução 17

- TVD, ENO (essentially-non-oscilatory) e WENO (weighted essentially-non-oscilatory),
DG (discontinuous Galerkin), SFVM (spectral finite volume method) e esquemas ADER
(arbitrary derivative Riemann problem) (Schwartzkopff et al., 2004; Titarev and Toro,
2005). Estas formulações são utilizadas para tratar modelos com equações hiperbólicas
ou parabólicas, além de hiperbólica dominante (Cueto-Felgueroso and Colominas, 2008).
Contudo, os esquemas de segunda ordem de acurácia tipo MUSCL-TVD apresentam re-
sultados com uma ordem de acurácia menor que o esperado quando são utilizadas malhas
não estruturadas. Além deste fato, é bem conhecido que esquemas TVD têm a sua or-
dem de acurácia reduzida a primeira ordem na presença de choques. Isto ocorre devido
ao efeito das funções limitadoras necessárias para a manutenção da monotonicidade das
soluções.

Entretanto, os esquemas ENO e WENO utilizam um modelo de reconstrução intrínseca
o qual depende da disponibilidade de células vizinhas para a reconstrução polinomial de
cada célula em cada passo de tempo, o qual é bastante caro computacionalmente.

O esquema DG fornece uma alta ordem de acurácia, porem a desvantagem é perce-
bida quando se precisa calcular as integrais de superfície e de volume, próprias do método,
que são computacionalmente caras. Devido às considerações anteriores, e visando o es-
tudo numérico-computacional do processo de recuperação secundária, dentre os métodos
citados, será investigado o método espectral dos volumes finitos (SFVM), que tem sido
empregado com sucesso na solução de problemas regidos pelas equações de Euler e Navier-
Stokes, com aplicações na área da aerodinâmica (Sun et al., 2006; Cueto-Felgueroso and
Colominas, 2008; Breviglieri et al., 2010), além de ter também sido empregado na solução
das equações de águas rasas (Choi et al., 2004).

A técnica de produção denominada recuperação secundária convencional é, em geral,
utilizada durante ou após a possível saída espontânea do óleo residente devido às altas
pressões no interior das rochas reservatório. Esta técnica envolve a injeção, normalmente,
de água através de poços injetores, de forma que esta água sirva para aumentar a pressão
no interior dos reservatórios e também para deslocar mecanicamente o óleo na direção de
poços produtores (Fanchi, 2005; Chen et al., 2006).

A recuperação secundária é de extrema importância. Um primeiro modelo simplifi-
cado, para o estudo da mesma considera apenas o escoamento bifásico de água e óleo
que será utilizado neste trabalho. Levando-se em conta que no modelo simplificado os
fluidos são incompressíveis, o problema pode ser modelado por uma equação de advecção-
difusão-reação não linear. Quando o termo difusivo é dominante, a equação apresenta
comportamento parabólico. No caso contrário, quando o termo advectivo predomina sobre
o termo difusivo, a equação assume um carácter fortemente hiperbólico, com proprieda-
des similares ao que apresentam as equações hiperbólicas de primeira ordem (Peaceman,
1977). Apesar das simplificações neste modelo, ele detêm as principais características
físico-matemáticas dos modelos multifásicos, envolvendo um sistema de equações diferen-
ciais parciais acopladas, não lineares, contendo termos de acumulação (ou transientes),



1. Introdução 18

de difusão, de advecção e de fonte (ou sumidouro).
Até onde nós sabemos, depois de fazer a pesquisa bibliográfica em diversas bases de

dados a nível mundial, o SFVM não foi investigado no contexto de simulação de reserva-
tórios de petróleo e parece particularmente promissor para lidar com meios heterogêneos,
além de ter um bom desempenho no tratamento da equação hiperbólica onde se pode ter
a presença de “choques” ou gradientes acentuados de saturação.

1.2 Objetivos

A presente dissertação tem como objetivo geral a aplicação de uma formulação numérica
conservativa, denominada o SFVM, às equações diferenciais parciais do modelo matemá-
tico que descreve o escoamento bifásico e imiscível de água e óleo no interior da rocha
reservatório. Serão considerados apenas problemas unidimensionais, embora todos os
aspectos conceituais considerados na formulação podem ser estendidos a problemas mul-
tidimensionais.

Os objetivos específicos podem ser resumidos como:

• Obter as equações discretizadas do modelo matemático a partir do SFVM.

• Implementar e avaliar um solver baseado na formulação conservativa do SFVM,
para a solução da equação modelo que rege o escoamento bifásico e imiscível de
água-óleo em reservatórios de petróleo, utilizando uma integração temporal através
do método Runge-Kutta explícito de terceira ordem .

• Inclusão na modelagem dos fenômenos físicos que possam se tornar relevantes no
processo de deslocamento. Assim, por exemplo, deverão estar consideradas as influ-
encias da pressão capilar e da gravidade.

• Finalmente, propõe-se avaliar a metodologia numérica adotada, comparando seus
resultados com outras formulações de alta ordem e soluções semi-analíticas dispo-
níveis, discutindo-se suas vantagens e desvantagens.

1.3 Organização da dissertação

O presente texto está dividido em seis capítulos e, uma bibliografia.
No presente capítulo, fazemos uma breve introdução, onde é apresentada a motivação

para a realização deste trabalho e onde são discutidas em forma breve algumas vantagens
e desvantagens de diferentes formulações numéricas utilizadas no estudo de escoamentos
de fluidos em meios porosos. Finalmente o objetivo geral e os objetivos específicos da
dissertação são apresentados.



1. Introdução 19

No capítulo dois, apresentamos a formulação matemática para o problema físico de
interesse, onde as principais propriedades da rocha reservatório e do fluido são descritas
e as equações que modelam o fluxo bifásico da água e óleo em meios porosos são obtidas.

A formulação clássica do método dos volumes finitos (FVM) é introduzida no capítulo
três, onde também é discutida a discretização conservativa dos termos elípticos, utilizando
o CVFDM (Control Volume Finite Difference Method).

O Método Espectral dos Volumes Finitos é descrito detalhadamente no capítulo qua-
tro, junto com o tratamento das condições de contorno e iniciais, além da utilização de
funções limitadoras de nos gradientes.

Com o objetivo de avaliar a acurácia da formulação proposta neste trabalho, no capí-
tulo cinco aplicou-se o SFVM em alguns problemas de referência encontrados na literatura.

As principais conclusões e contribuições deste trabalho estão contidas no capítulo seis,
onde também serão indicadas sugestões para trabalhos futuros.

Por fim, apresenta-se uma bibliografia que contém as referências aos trabalhos que
foram utilizados no desenvolvimento desta dissertação.



20

Capítulo 2

Equações governantes

2.1 Considerações iniciais

N este capítulo se apresentam as equações fundamentais que descrevem o problema re-lacionado ao escoamento bifásico incompressível de dois fluidos imiscíveis no interior
de rochas reservatório. As equações abordadas neste trabalho podem ser classificadas do
ponto de vista matemático como parabólicas, elípticas, ou hiperbólicas (Anderson et al.,
1984; Fortuna, 2000).

De forma geral as equações elíptica e parabólicas podem ser associadas a problemas
de difusão ou dispersão de uma propriedade física característica por exemplo condução
de calor em sólidos, determinação de campo de pressões em escoamentos mono ou mul-
tifásicos, no regime transiente ou permanente. Por outro lado as equações hiperbólicas
podem ser relacionadas a problemas de advecção ou convecção por exemplo dinâmica dos
gases, geofísica, ótica, onde o termo convecção é utilizado para o transporte advectivo de-
vido à diferença de temperatura, em geral estas equações estão associadas a problemas de
transporte de ondas com pouco ou nenhum amortecimento. Dependendo da relação entre
a velocidade e os mecanismos físicos de dissipação da informação transportada, as equa-
ções de advecção-difusão ou advecção-dispersão podem apresentar carácter parabólico ou
hiperbólico (Hirsch, 2007; Lyra, 1994).

2.2 Problemas modelo da dinâmica dos fluidos

2.2.1 Equação linear da advecção

Considerando a equação linear da advecção, a qual pode ser escrita na forma a seguir:

?S

?t
+ a

?S

?x
= 0, (2.1)

onde a grandeza transportada S(x,t) é uma função de duas variáveis independentes. O
problema de Cauchy ou problema de valor inicial para esta equação no domínio ??&amp;lt;



2. Equações governantes 21

x &amp;lt;?, t ? 0, fica definido com a introdução da condição inicial:

S (x,t) = S(x, 0) = S0 (x) , (2.2)

cuja solução é dada por:

S (x,t) = S0 (x?at) , (2.3)

para t ? 0 . Como a evolução do tempo, a perturbação é propagada sem mudança alguma
para o lado direito do domínio computacional quando a &gt; 0, ou para o lado esquerdo se
a &amp;lt;0, onde “a” representa a velocidade de propagação da onda. Portanto, a solução
S (x,t) é constante ao longo de cada reta x ? at = x0, que são conhecidas com o nome
de linhas características da equação. As linhas características são curvas no plano x? t
satisfazendo a equação diferencial ordinária (dx (t) /dt) = a, x (0) = x0. Tomando a
derivada total de S (x,t) ao longo de uma destas curvas para encontrar a taxa de variação
de S ao longo das linhas características, temos:

d

dt
S (x (t) , t) =

?

?t
S (x (t) , t)

dt

dt
+

?

?x
S (x (t) , t)

dx (t)

dt
,

=
?S

?t
+
?S

?x
a, (2.4)

= 0,

mostrando que S é constante ao longo das linhas características (LeVeque, 1992).

2.2.2 Equação não linear de Burgers

Considerando a equação escalar:

?S

?t
+
?fadv (S)

?x
= 0, (2.5)

onde fadv (S) é uma função não linear de S, sendo que fadv (S) é uma função con-
vexa, ou seja df2adv (S) /dS

2 &gt; 0, para todos os valores de S, ou fadv (S) é côncava com
df2adv (S) /dS

2 &amp;lt;0 ?S.
Um dos modelos mais estudados para equações não lineares é a equação de Burgers,

na qual fadv (S) = 12S
2, então a Eq. (2.5) pode ser escrita na forma a seguir:

?S

?t
+ S

?S

?x
= 0, (2.6)

que representa um dos modelos mais simples que inclui efeitos não lineares na dinâmica
dos fluidos.

Agora, considerando a equação de Burgers Eq. (2.6) com uma condição inicial suave,
isto é sem gradientes acentuados, é possível construir uma solução utilizando a teoria



2. Equações governantes 22

das linhas características, em que a Eq. (2.6) é uma equação de advecção, porém com
velocidade de advecção S igual à grandeza advectada ou transportada. Logo, podemos
escrever:

dx (t)

dt
= S (x (t) , t) , (2.7)

onde ao longo da cada linha característica S é constante, uma vez que:

d

dt
S (x (t) , t) =

?

?t
S (x (t) , t)

dt

dt
+

?

?x
S (x (t) , t)

dx (t)

dt
,

=
?S

?t
+ S

?S

?x
, (2.8)

= 0.

Além disso, uma vez que S é constante em cada linha característica, a inclinação
(dx (t) /dt) é dada pela Eq. (2.7) onde as características são linhas retas determinadas
pela condição inicial. Se a condição inicial é suave e, para tempos curtos, quando as
linhas característica não se cruzam, o desenvolvimento anterior pode ser utilizado para
encontrar a solução S (x,t), onde para cada (x,t) pode-se resolver a equação,

x = x0 + u (x0, 0) t, (2.9)

para x0 e, então, temos que

S (x,t) = u (x0, 0) . (2.10)

Formação do choque Para determinado tempo t a Eq. (2.9) é multi-avaliada. Isto
acontece quando as linhas características se cruzam, ou também podemos dizer quando
a onda quebra, por analogia do choque de uma onda contra a praia. Para um tempo “t”
dado por:

tchoque =
1

max
???fadv
?x0

??, (2.11)
onde as linhas se cruzam pela primeira vez, a derivada função ?S (x,t) /?x é infinita,
então tem-se a formação do choque (Toro, 2009). Depois deste ponto, temos soluções não
clássicas para a PDE e a solução fraca que desejamos encontrar torna-se descontínua. O
problema é que a Eq. (2.5) pode admitir várias soluções fracas, então outras condições
devem ser impostas para que a solução fisicamente correta seja obtida (LeVeque, 1992).



2. Equações governantes 23

2.2.3 O problema de Riemann

O problema de Riemann surge na tentativa de dar solução à equação de conservação,
como por exemplo a Eq. (2.5), utilizando uma condição inicial especial. Dita condição
inicial é uma função contínua por partes, com uma única descontinuidade, por exemplo
em x = 0,

S(x, 0) =

??
?SL para x &amp;lt;0,SR para x &gt; 0. (2.12)

As Eqs. (2.5) e (2.12), representam o transporte de informação de, por exemplo, uma
certa quantidade de matéria, de forma descontínua através de um domínio característico.
A forma da solução para S(x,t) depende da relação entre SL e SR e, de se a função fadv
é convexa ou côncava, ou convexa e côncava (LeVeque, 1992; Wesseling, 2009).

Problema de Riemann tipo I

Inicialmente é considerada uma função convexa. Desta forma existem dois possíveis casos
a considerar:

Caso I. Neste caso é considerado SL &gt; SR, logo temos uma única solução fraca,

S(x,t) =

??
?SL para x &amp;lt;vchoquet,SR para x &gt; vchoquet. (2.13)

onde

vchoque =
fadv (SL) ?fadv (SR)

SL ?SR
(2.14)

é a velocidade de choque, i.e. a velocidade com que a descontinuidade se desloca. A
Eq. (2.14) representa a relação entre a vchoque e os estados L e R, e é chamada de condição
de Rankine-Hugoniot. Eq. (2.14) representa a propriedade de conservação local na pre-
sença de descontinuidade. Note que com a evolução no tempo as linhas características de
cada região onde S é constante se interceptam configurando a formação de um choque,
ver Fig. 2.1. Finalmente pode-se dizer que a solução descontínua com a evolução, é uma
onda de choque, que é de caráter compressiva, e satisfaz a condição a seguir:

fadv (S) ?fadv (SL)
S ?SL

? vchoque ?
fadv (S) ?fadv (SR)

S ?SR
, (2.15)

a qual é denominada de condição de entropia (Toro, 2009), cujos termos repressentam
a inclinação das linhas características. Segundo Oleinik (1957), a condição de entropia,
Eq. (2.15) garante que a solução satisfaz a 2a Lei da Termodinâmica, e que a entropia
cresce através da descontinuidade (Lyra, 1994).



2. Equações governantes 24

0

SL

SR

0

x=v *tchoque

(a) (b)

S t

x x

Figura 2.1: (a) Solução inicial descontínua compressiva. (b) Solução no plano x-t.

Caso II Neste caso é considerado que SL &amp;lt;SR, que permite um conjunto infinito de
soluções fracas disponíveis tem-se, por exemplo, a solução descontínua que se propaga
com velocidade vchoque semelhante à descrita no caso I. Esta condição inicial é de caráter
expansiva. Observe que agora algumas linhas características não se originam na condição
inicial, mas sim na linha que representa o “choque”, como indicado na Fig. 2.2, portanto,
esta solução é fisicamente incorreta.

0

SL

SR

0

x=v *tchoque

(a) (b)

S t

x x

Figura 2.2: (a) Condição inicial descontinua de caráter expansiva. (b) Solução do choque
de rarefação no plano x-t.

Neste caso as linhas características não podem ser acompanhadas até a condição inicial,
logo viola a condição de entropia Eq. (2.15), a “física” do problema. Logo aparece o
denominado choque de expansão ou rarefação não físico, pois a condição de entropia
garante que o “choque” é determinado pelas condições iniciais e não por eventos futuros
(Lyra, 1994). Entre outras várias razões para rejeitar esta solução, como uma solução física
admisível, esta a instabilidade, que destaca-se como um argumento importante. Entenda-
se o conceito de instabilidade como, o efeito de pequenas perturbações na solução inicial,



2. Equações governantes 25

geram grandes mudanças na solução numérica (Toro, 2009).
Outra solução fraca possível é a onda de rarefação centrada, como se apresenta a

seguir:

S (x,t) =

?????
????
SL x &amp;lt;SLt,

x/t SL ? x ? SR,

SR x &gt; SRt.

(2.16)

A solução Eq. (2.16) é estável. As linhas características podem ser acompanhadas até
a condição inicial e esta é uma solução fisicamente correta e corresponde à solução da Eq.
de Burgers viscosa no limite em que os termos de difusão são eliminados, i.e., tendem
para zero (LeVeque, 2002; Lyra, 1994), ou seja

lim
??0

{
?S

?t
+ S

?S

?x
??

?2S

?S2
= 0

}
,

como indicado na Fig. 2.3.

0

SL

SR

0

(a) (b)

S t

x x

Figura 2.3: Onda de rarefação: (a) Condição inicial descontínua de caráter expansiva. (b)
Solução (rarefação) satisfazendo a condição de entropia.

Finalmente a análise do caso para uma função convexa é concluído. O tratamento
para a função côncava é similar e não será discutido (ver LeVeque, 2002). Observe que
em nos casos das funções convexa e côncava, a descontinuidade na solução do problema
de Riemann resulta ou em uma onda de choque, ou uma onda de rarefação, porém não
por ambos. No entanto, isso não precisa ser assim para uma função arbitrária (Wesseling,
2009). O caso em que a função é nem convexa nem côncava será ilustrado pelo exemplo
da versão unidimensional escalar da equação Buckley-Leverett.



2. Equações governantes 26

Problema de Riemann tipo II

A seguir será analisado o caso para o qual a função fadv tem forma de "S", como indicado
na Fig. 2.4a. A solução resultante pode ter ondas de choque, de rarefação ou ambas. Este
caso é tratado extensivamente em (LeVeque, 1992; Helmig, 1997). Agora considerando o
problema de Riemann com estados SL e SR. O valor onde a derivada da função fadv é
máxima é chamado de ponto de inflexão SI, como indicado na Fig 2.5, para Sw = 0.5. A
solução é obtida considerando os casos a seguir (Bastian, 1999):

0.2 0.4 0.6 0.8 1.0
Sw

0.2

0.4

0.6

0.8

1.0

fadv
Função fadv

(a)
0.2 0.4 0.6 0.8 1.0

Sw

0.2

0.4

0.6

0.8

1.0

fadv¢
Derivada da Função fadv, fadv'=dfadv?dS

(b)

Figura 2.4: (a) Função fadv. (b) Derivada da função fadv, para o modelo de Brooks-Corey
com µo/µw = 1.

Caso I Neste caso é considerado que SR &amp;lt;SL ? SI. Nessa faixa temos que
?fadv (SL) /?S &gt; ?fadv (SR) /?S como no caso I do problema de Riemann tipo I, Eq (2.13).
Com velocidade de choque dada pela Eq. (2.14).

Caso II Neste caso é considerado que SI ? SR &amp;lt;SL. Agora temos que ?fadv (SL) /?S&amp;lt;
?fadv (SR) /?S, e obtemos uma onda de rarefação como solução:

S (x,t) =

?????
????
SL x/t &amp;lt;?fadv(SL)/?S,

[?fadv(SL)/?S]
?1

(x/t) ?fadv(SL)/?S ? x/t ? ?fadv(SR)/?S,

SR x/t &gt; ?fadv(SR)/?S.

(2.17)

Para os restantes dois casos, definiremos o ponto de saturação tangencial ST, tal que:

?fadv (ST) /?S =
fadv (ST) ?fadv (SR)

ST ?SR
. (2.18)

A construção do ponto tangencial é apresentada graficamente na Fig. 2.5.

Caso III Neste caso é considerado que SR &amp;lt;SI &amp;lt;SL ? ST. Este caso é uma extensão
do caso I (onda de choque), isso devido a que ainda consideramos que ?fadv (SL) /?S &gt;



2. Equações governantes 27

fadv

Figura 2.5: Construção do ponto tangencial.

?fadv (SR) /?S. Contudo, é mais complexo para mostrar que as características todas se
interceptam para formar o choque.

Caso IV Neste caso é considerado que SR &amp;lt;SI &amp;lt;ST &amp;lt;SL. O estado à esquerda esta
acima do ponto tangencial. Assim, obtemos uma onda de rarefação do estado à esquerda
para o ponto tangencial, e um choque do ponto tangencial para o estado à direita, i.e.:

S (x,t) =

?????
????
SL x/t ? ?fadv(SL)/?S,

[?fadv(SL)/?S]
?1

(x/t) ?fadv(SL)/?S &amp;lt;x/t &amp;lt;?fadv(ST)/?S,

SR x/t &gt; ?fadv(ST)/?S.

(2.19)

Observe que a velocidade de choque é dada pela Eq. (2.18) e cumpre com a condição
de Rankine-Hugoniot. De fato a Eq. 2.18 é construída de forma que a derivada da função
?fadv(SL)/?S, seja inversível para a onda de rarefação. A velocidade de choque satisfaz
a condição de Rankine-Hugoniot e as linhas características para x/t &gt; ?fadv(ST)/?S
entram no choque.

A solução do problema de Riemann é uma ferramenta fundamental no desenvolvimento
de formulações numéricas, tais como o métodos dos volumes finitos que será apresentado
no capítulo 3.



2. Equações governantes 28

2.3 Escoamento bifásico e imiscível em meios porosos

2.3.1 Conceitos fundamentais

Nesta seção, apresentamos as equações que modelam o escoamento bifásico e incompres-
sível de água e óleo em meios porosos rígidos. A lei de Darcy é substituída diretamente
na equação de conservação de massa para cada fase produzindo um conjunto de EDPs
parabólicas que são, em geral, resolvidas simultaneamente. Este tipo de formulação é
amplamente utilizada na indústria do petróleo (Ertekin et al., 2001). Neste tipo de for-
mulação, diferentes alternativas podem ser utilizadas na escolha das variáveis primitivas
do problema. Em função da escolha destas variáveis, podemos classificar estas formulações
como (Helmig, 1997; Carvalho, 2005):

1. Pressões das Fases: Nesta formulação as variáveis fundamentais são as pressões das
fases.

2. Pressão-Saturação: As variáveis fundamentais são a pressão de uma fase, e as satu-
rações das outras fases (no caso de termos mais de duas fases).

3. Saturação das Fases: As saturações das fases são tomadas como variáveis funda-
mentais.

No presente trabalho adotaremos a formulação número 3, com o objetivo de obter as
referidas equações que regem o comportamento do escoamento bifásico e incompressível
em meios porosos. Para obter a referida formulação, as principais hipóteses simplificadoras
adotadas são (Peaceman, 1977):

• O meio poroso esta totalmente saturado pelas fases líquidas.

• O fluido e a rocha são incompressíveis.

• O escoamento é imiscível.

• Os fluidos obedecem à lei de Darcy generalizada, isto é: Os fluidos são newtonianos;
não há reação química entre os fluidos e o meio poroso; o escoamento é laminar e
isotérmico; a permeabilidade absoluta é independente da pressão e da temperatura
(Helmig, 1997).

Tendo em vista as considerações acima, a equação de conservação da massa para o
modelo do fluxo bifásico, para a fase ?, pode ser expressa, utilizando as equações de
continuidade, dadas por (Helmig, 1997; Bear, 1988)

Fase 1: fase molhante ? = w (p. ex., água), tem-se:

?
? (?wSw)

?t
+ ?· (?w~vw) ??wqw = 0. (2.20)



2. Equações governantes 29

Fase 2: fase não-molhante ? = o (p. ex., óleo),tem-se:

?
? (?oSo)

?t
+ ?· (?o~vo) ??oqo = 0. (2.21)

Somando as equações (2.20) e (2.21), além de introduzir a velocidade total do sistema
bifásico incompressível, com ~vt = ~vw + ~vo, temos:

?·~vt = qo + qw = qt. (2.22)

Nas equações (2.20) e (2.21), v? é a velocidade da fase ?, ou taxa de fluxo por unidade
de área da secção transversal do reservatório, ?? é a massa específica ou a densidade da
fase ?, ? é a porosidade, i.e., a fração da rocha que pode ser ocupada por fluidos, q?
denota termos fonte ou sumidouros (por ex. poços) e S? é a saturação da fase ?, que
representa a fração do volume poroso ocupado por esta fase. Devido à consideração de
que o meio poroso esta totalmente saturado, podemos escrever a equação constitutiva ou
de restrição das saturações, como:

?
?=o,w

S? = 1 ou S0 + Sw = 1. (2.23)

Finalmente define-se a pressão capilar como a diferença entre as pressões das fases, ou
seja:

pc = po ?pw. (2.24)

A pressão capilar representa uma descontinuidade da pressão associada ao contato
entre dois fluidos imiscíveis nos interstícios do meio poroso (Bear, 1988; Helmig, 1997).
Ela é um parâmetro obtido experimentalmente que depende fortemente da saturação da
água, o seja, pc = pc (Sw). Um modelo empírico clássico utilizado para relacionar pressão
capilar e saturação da água é o modelo de Brooks e Corey (Brooks and Corey, 1964).
Neste modelo, a pressão capilar é da forma a seguir

pc (Sw) = pd

(
Sw ?Swr
1 ?Swr

)?1/?
. (2.25)

O gráfico para a Eq. (2.25) é indicado na Fig. 2.6. As permeabilidades relativas e
saturações normalizadas das fases se relacionam através das seguintes expressões:

krw (Sw) =

(
Sw ?Swr

1 ?Swr ?Sor

)?
, (2.26)

kro (Sw) =

(
1 ?Sw ?Swr
1 ?Swr ?Sor

)?
, (2.27)



2. Equações governantes 30

0.0 0.2 0.4 0.6 0.8 1.0
Sw0

1

2

3

4

5

Pc

Função Pressão Capilar

Figura 2.6: Curva para a função pressão capilar, correspondente aos parâmetros pd = 1,
? = 3, Swr = 0.

Onde Swr e Sor são as saturação residual da água e a saturação residual de óleo
respectivamente, ver gráficos das Eqs. (2.26) e (2.27) na Fig. 2.7. Maiores detalhes sobre
os modelos e, particularmente sobre os coeficientes empíricos pd, ?, ?, e ?, podem ser
encontrados em Helmig (1997).

krw

kro

0.2 0.4 0.6 0.8 1.0
Sw

0.2

0.4

0.6

0.8

1.0

kr
Funções permeabilidade relativa

Figura 2.7: Curvas para as funções de permeabilidade relativa, correspondente aos parâ-
metros ? = ? = 2, Swr = Sor = 0.

Para determinar a equação de saturação, inicialmente tomamos o gradiente da pressão
capilar, Eq. (2.24), de modo que (Helmig, 1997):

?pc = ?po ??pw. (2.28)



2. Equações governantes 31

Utilizando as equações (2.20) e (2.21), e levando em conta que no presente trabalho só
será considerado o deslocamento de fluidos em meios porosos isotrópicos, as velocidades
das fases água e óleo podem ser escritas, respectivamente, como:

~vw = ??wK (?pw ??wg) , (2.29)

~vo = ??oK (?pw + ?pc ??og) , (2.30)

onde K é a permeabilidade absoluta do meio, representando uma propriedade apenas da
rocha, p? é a pressão da fase ?, g é o módulo da aceleração gravitacional, e ?? = kr?µ? é a
mobilidade da fase ?, onde kr? e µ? são a permeabilidade relativa e a viscosidade da fase
?, respectivamente.

Multiplicando a Eq. (2.29) por ?o e a Eq. (2.30) por ?w obtemos (Carvalho, 2005):

?o~vw = ?K?w?o (?pw ??wg) , (2.31)

?w~vo = ?K?o?w (?po ??og) . (2.32)

Subtraindo a Eq. (2.31) da Eq. (2.32) chegamos a:

?w~vo ??o~vw = ?K?o?w (?po ??og ??pw + ?wg) . (2.33)

Multiplicando a Eq. (2.33) por (-1), e usando a Eq. (2.28) temos:

??w~vo + ?o~vw = K?o?w?pc ?K?o?w (?o ??w) g. (2.34)

Rearranjando os termos e usando ainda o fato que ~vo = ~vt ?~vw e que ?t = ?w + ?o pode
se escrever:

?t~vw = ?w~vt + K?o?w [?pc + (?w ??o) g] , (2.35)

onde ~vt representa a velocidade total e ?t a mobilidade total.
Definindo o fluxo fracional de uma fase ? como:

f? =
??
?t
, (2.36)

e, para simplificar a notação, definindo

hw = ??
(?o?w)

?t

dpc
dSw

, (2.37)

onde 0 ? ? ? 1 é um parâmetro livre (Cueto-Felgueroso, 2009), escolhido pelo usuário para
controlar a intensidade da força capilar, o que tem implicações na estabilidade numérica.



2. Equações governantes 32

Desta forma, obtemos a equação da velocidade para a fase água dada por:

~vw = fw~vt ?Khw?Sw + K?tfw (?w ??o) g. (2.38)

Assim, consegue-se escrever a velocidade da fase água, ~vw, em função da velocidade
total ~vt. Substituindo a Eq. (2.38) na Eq. (2.20) e rearranjando os termos, temos:

? (??wSw)

?t
= ??· [?w (fw~vt ?Khw?Sw + K?ofw (?w ??o) g)] + qw. (2.39)

Utilizando as hipóteses de que o meio poroso é rígido e que os fluidos são incompressíveis
podemos escrever:

??w
?Sw
?t

= ??w?· [(fw~vt ?Khw?Sw + K?ofw (?w ??o) g)] + qw. (2.40)

Finalmente, dividindo por ?w e assumindo que Qw = qw/?w chega-se a:

?
?Sw
?t? ?? ?

termo 1

= ??·

??
?fw[~vt + K?o (?w ??o) g]? ?? ?

termo 2

?Khw?Sw? ?? ?
termo 3

??
? + Qw????

termo 4

. (2.41)

A Eq. (2.41) é conhecida como a equação de saturação da fase água num meio poroso
rígido. Esta equação é similar a uma equação de advecção-difução-reação não linear. Por
outro lado, na Eq. (2.41), o termo 1 representa o termo de acumulação, o termo 2, é o
termo advectivo

fadv = fw [~vt + K?o (?w ??o) g] , (2.42)

e o termo 3 está associado aos efeitos de capilaridade de carácter difusivo,

fdiff = Khw?Sw, (2.43)

o termo 4 representa as fontes ou sumidouros. Um pré-requisito para a solução da
Eq. (2.41) é ter calculado a priori a velocidade total vt (Helmig, 1997).

2.3.2 Condições iniciais e de contorno

Para que o problema representado pela equação de saturação seja completamente deter-
minado é necessário utilizar as condições iniciais e de contorno adequadas. A seguir se
apresenta um conjunto de condições iniciais e de contorno associadas a um reservatório
com contorno de injeção ?? e contorno de produção ?+ , como indicado na Fig. 2.8.

No presente contexto, uma condição de contorno fisicamente admissível do tipo Diri-
chlet para a equação de saturação será imposta da forma a seguir:



2. Equações governantes 33

W
vT

vT

n

n

G+
G-

Figura 2.8: Diagrama esquemático das condições de contorno para a equação de saturação,
adaptada de (Chavent and Jaffré, 1986).

Sw (~x,t) = Sw em ?? ×
[
t0,T

]
, (2.44)

onde Sw é um valor da saturação prescrito para o contorno ?? e [t0,T] representa o
intervalo de tempo considerado. As condições iniciais do problema podem ser escritas
como:

Sw (~x, 0) = S
0

w em ? × t
0, (2.45)

para um domínio ? no tempo inicial t0.

2.3.3 Equação de Buckley-Leverett

A equação diferencial não linear (2.41) é formalmente parabólica, se o gradiente de pressão
capilar têm valor significativo. Por outro lado se o gradiente de pressão capilar é muito
pequeno dpc

dSw
w 0, o termo difusivo é desprezível e a Eq. (2.41) torna-se hiperbólica. Se são

desconsiderados os efeitos da pressão capilar, os efeitos gravitacionais e os termos fonte
ou sumidouro, a Eq. (2.41) transforma-se na chamada de equação de Buckley-Leverett:

?
?Sw
?t

+ ~vt
dfw
dSw

?Sw
?x

= 0. (2.46)

Nesta equação é assumido que a velocidade ~vt é constante (Helmig, 1997). A Eq. (2.46)
foi originalmente obtida por Buckley and Leverett (1942), num trabalho clássico e que se
tornou referência para o estudo de escoamentos bifásicos em meios porosos. Esta equação
representa o deslocamento imiscível e unidimensional de óleo por água num meio poroso
rígido (Carvalho, 2005). Para ilustrar, apresentamos na Fig. 2.9 a frente de saturação nos
instantes t=1.1 para o problema do deslocamento imiscível unidimensional de óleo por
água, com presença de ondas de compressão (choque Sw = 0.5), ondas de rarefação e suas
respectivas curvas da função fluxo fracional e velocidade característica.



2. Equações governantes 34

0 100 200 300 400 500
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

Posição (m)

S
w

Perfil de saturações para o tempo (t = 1.1 d)

(a)

0 0.2 0.4 0.6 0.8 1
0

0.2

0.4

0.6

0.8

1

Sw

fw

 

 

Função fluxo (fadv)

0 0.2 0.4 0.6 0.8 1
?2

0

2

4

6

Sw

d
fa

d
v/

d
S

w

 

 
Vel. Característica (dfadv/dSw)

(b)

Figura 2.9: Solução semi analítica para o problema do Buckley-Leverett (a) e função fluxo
e velocidade característica (b)



35

Capítulo 3

O método dos volumes finitos clássico

U ma grande classe de problemas físicos pode ser descrita por sistemas de equaçõesdiferenciais parciais. Soluções analíticas para estes sistemas estão disponíveis para
apenas um número reduzido de casos simplificados, e em geral o domínio e as equações
governantes têm que ser discretizadas para se obter uma solução aproximada (van den
Abeele, 2009).

A seguir, apresenta-se uma visão geral de um dos métodos mais utilizado na discreti-
zação espacial das equações governantes da dinâmica dos fluidos, e que é conhecido como
o método dos volumes finitos (FVM) que foi introduzido por McDonald em 1971. Na
prática são considerados métodos dos volumes finitos todos os métodos de discretização
em que, inicialmente, as equações diferencias são integradas diretamente no domínio fí-
sico e, posteriormente, o teorema da divergência de Green-Gauss é utilizado, de modo a
transformarem-se as integrais de domínio em integrais de superfície. Só então, aplica-se
algum procedimento de discretização que permita a obtenção da solução numérica do
problema (Carvalho, 2005). Uma característica importante de todos os métodos que se
enquadram nesta categoria é o fato que, quando bem aplicados, garantem conservação lo-
cal no nível da célula e global de quantidades como massa, momento e energia. O FVM é
o mais utilizado para a discretização espacial na simulação de problemas na dinâmica dos
fluidos computacional e atingiu um nível considerável de maturidade. É suficientemente
flexível para resolver problemas físicos com acurácia em geometrias complexas utilizando
malhas não estruturadas, em geral, de primeira ou “segunda” ordem. Isto, inclusive, é
adequado para o nível de erro requerido para a maioria dos problemas de engenharia.
Além disso, este método possui robustez suficiente para lidar com soluções de uma ampla
classe de problemas. Por estas razões, a maioria dos pacotes de softwares comerciais para
a simulação de escoamentos existentes hoje são baseados no FVM (van den Abeele, 2009).



3. O método dos volumes finitos clássico 36

3.1 Esquema de primeira ordem de acurácia

3.1.1 Formulação geral

Considerando a forma geral da lei de conservação da grandeza Sw, Eq. (2.41), com apenas
fluxos advectivos ~fadv e termo fonte Qw, temos:

?
?Sw
?t

+ ?.(~fadv) = Qw, (3.1)

onde ~fadv = fw~vt. Integrando a Eq. (3.1) em cada célula também conhecida como volume
de controle, onde são realizados os balanços discretos no caso do FVM, obtemos:?

?

?
?Sw
?t

d? +

?
?

?· (~fadv)d? =
?
?

Qwd?, (3.2)

com volume ?, contornos ??, e aplicando o teorema da divergência de Green-Gauss temos:

?
?S?w
?t

= ?
?
?

~fadv(Sw) ·~nd? +
?
?

Qwd?, (3.3)

onde o vetor ~n é o vetor área normal que aponta para fora da superfície de controle, e a
variável conservativa média no volume de controle S?w é dada por:

S?w =

?
?

Swd?. (3.4)

Estas representam as incógnitas do problema discretizado pelo método dos volumes finitos.
Para avaliar o primeiro termo do lado direito da Eq. (3.3), as variáveis conservativas

nas faces dos volumes de controle são necessárias para calcular os fluxos advectivos. Estes
não estão imediatamente disponíveis e, assim, devem ser reconstruídos a partir dos valores
médios das células. No método “upwind” clássico de primeira ordem de acurácia de
Godunov (1959), a solução em uma face é aproximada pela solução média da célula,
o que corresponde a uma extrapolação com um polinômio de grau zero (ver Fig. 3.1). A
fim de assegurar a conservação em nível discreto, as contribuições de uma face para as
suas duas células vizinhas devem ser iguais em magnitude e opostas em sinal.

Assim um único fluxo ~F ·~n deverá ser calculado a partir de duas soluções disponíveis
(LeVeque, 2002; Hirsch, 2007; van den Abeele, 2009). No método original de Godunov,
este objetivo é alcançado ao calcular a solução exata para o problema de Riemann re-
sultante (Toro, 2009). Alternativamente e visando uma maior eficiência computacional,
são utilizados resolvedores de Riemann aproximados para este propósito que, em muitos
casos, podem ser escritos na forma



3. O método dos volumes finitos clássico 37

Figura 3.1: Esquema de primeira ordem de acurácia.

~F (SwL,SwR) ·~n =

?
?? ~fadv (SwL) + ~fadv (SwR)

2? ?? ?
termo 1

?
?? ·~n?|A| SwR ?SwL

2? ?? ?
termo 2

, (3.5)

onde SwL e SwR são, respectivamente, as variáveis conservadas reconstruídas a partir das
células da esquerda e da direita de uma face, o vetor normal ~n é orientado da esquerda
para a direita. No método “upwind” de primeira ordem de acurácia temos:

SwL = S?wL e SwR = S?wR. (3.6)

O termo 1 no lado direito da Eq. (3.5) é apenas a média dos fluxos advectivos analíticos
do lado esquerdo e do lado direito da face e corresponde a diferenças finitas centradas de
segunda ordem. O termo 2 assegura que os dados que são utilizados para o cálculo do fluxo
vem do lado a partir do qual as grandezas físicas estão se propagando. Isto é conhecido
com o nome de “upwinding” que introduz uma quantidade de amortecimento ou difusão
para estabilizar os cálculos. A matriz |A| deve ser definida de tal forma que o “upwinding”
seja assegurado. O fluxo de Riemann mais simples é o de Rusanov (1962). A definição de
|A| para o fluxo de Rusanov é simplesmente:

|A| = ?maxI, (3.7)

onde ?max é o raio espectral da matriz jacobiana dos fluxos no sentido de ~n na face, que
é dada por:



3. O método dos volumes finitos clássico 38

?
(
~fadv?L(R) ·~n

)
?SwL(R)

. (3.8)

Para a equação linear de advecção, discutida na subsec. 2.2.1, isso simplesmente re-
sulta em ?max = |a|, e para a equação de Burger em 1D, ?max = 0.5 (|u|L + |u|R), ver
subsec. 2.2.2.

Na subseção a seguir apresentamos outros exemplos de resolvedores de Riemann apro-
ximados, os quais são geralmente utilizados na comunidade de CFD (computational fluid
dynamics) na solução de um problema de Riemann escalar (Cockburn and Shu, 1989).

3.1.2 Resolvedores de Riemann aproximados

Godunov :

FG(SwL,SwR) =

{
minSwL?Sw?SwR fadv(Sw) se SwL ? SwR,
maxSwL?Sw?SwR fadv(Sw) se SwL &gt; SwR.

(3.9)

Lax-Friedrichs (global):

FLFG(SwL,SwR) =
1

2
[fadv(SwL) + fadv(SwR) ??(SwR ?SwL)], (3.10)

? = max
?????fadv(Sw)?Sw

???? ,
onde o máximo é calculado sobre a região inteira de Sw, isto é [infu0(x),supu0(x)], onde
u0(x) é a solução inicial.

Lax-Friedrichs (local):

FLFL(SwL,SwR) =
1

2
[fadv(SwL) + fadv(SwR) ??(SwR ?SwL)], (3.11)

? = max
min(SwL,SwR)?Sw?max(SwL,SwR)

?????fadv(Sw)?Sw
???? ,

para funções convexas, isto é
?2fadv
?S2w

? 0, temos que ? = max
[????fadv(SwL)?Sw ??? , ???fadv(SwR)?Sw ???].

Roe com correção de entropia:

FRF(SwL,SwR) =

?????
????
fadv(SwL) sef

?

adv(Sw) ? 0; Sw ? [min(SwL,SwR),max(SwL,SwR)],

fadv(SwR) sef
?

adv(Sw) ? 0; Sw ? [min(SwL,SwR),max(SwL,SwR)],

FLFL caso contrário.
(3.12)



3. O método dos volumes finitos clássico 39

Geralmente é utilizado o resolvedor de Riemman aproximado tipo FG se a função fadv
é simples. Contudo, para funções convexas, é sugerido utilizar resolvedores de Riemann
tais como FLFL ou FRF por sua simplicidade e bons resultados numéricos (ver sec. 4 de
(Cockburn and Shu, 1989)).

3.2 Esquemas TVD e TVB

Um conceito relevante surge da propriedade matemática de que a variação total (TV):

TV (Sw) =
? ?????Sw?x

????dx, (3.13)
de qualquer solução física admissível de uma lei de conservação hiperbólica escalar, que
não deve crescer no tempo (LeVeque, 2002). A medida da TV para uma dada função Sw,
que é a solução numérica do problema descrito pela Eq. (3.1) com as condições iniciais e
de contorno apropriadas, além de desconsiderar o termo de fonte, é definida na sua forma
discreta como:

TV (Sw) =
?
i

??Sw(i+1) ?Sw(i)?? . (3.14)
Levando em consideração a premissa anterior, a seguir, é apresentado uma classe de
método conservativo de muito sucesso para resolver a Eq. (3.1), definido pela expressão:

Sn+1
w(i)

= Snw(i) ?
4t
4x

(
Fi+1/2 ?Fi?1/2

)
, (3.15)

que é TVD, ou seja, total variation diminshing se

TV
(
Sn+1w

)
? TV (Snw) ? TV

(
S0w
)
, (3.16)

donde Snw refere-se à solução numérica no nível de tempo t
n. Um esquema é chamado de

TVB, i.e. total variation bounded, quando:

TV (Snw) ? M(4x)
2, (3.17)

onde M é um parâmetro fixo escolhido pelo usuário (Shu, 1987, 1988).
Métodos numéricos que satisfazem as condições Eq. (3.16) e Eq. (3.17) preservam a mo-

notonicidade, apresentando um comportamento livre de oscilações. Harten et al. (1983),
provou que:

1. Todo esquema numérico monótono é TVD. Para nosso caso Sw é denominada mo-
nótona se, para todo i, min

(
Sw(i?1),Sw(i+1)

)
? Sw(i) ? max

(
Sw(i?1),Sw(i+1)

)
.

2. Todo esquema TVD preserva a monotonicidade.



3. O método dos volumes finitos clássico 40

O objetivo principal por trás da construção de um método de alta resolução e que seja
TVD é obter uma aproximação de ordem maior em regiões suaves, impedindo o surgimento
de oscilações nas proximidades de gradientes acentuados e apresentando nestas regiões
propriedades semelhantes àquelas de métodos monótonos de ordem mais baixa.

Infelizmente, em quaisquer esquemas TVD, a solução é, em geral, de segunda ordem
em regiões suaves da solução e de primeira ordem contíguo a “descontinuidades”. Por outro
lado os esquemas TVB permitem relaxar a exigência de monotonicidade, para manter o
ordem de acurácia espacial globalmente (Shu, 1987). Para construir métodos de ordem
mais alta é preciso utilizar as denominadas funções limitadoras de declividade ou slope
limiters para as variáveis dependentes Sw ou a partir da limitação do fluxo ~fadv(Sw) de
maneira adaptativa. Boris and Book (1973) foram os primeiros a trabalhar com funções
limitadoras não lineares incluindo na formulação a diferença entre os fluxos de primeira
ordem e os fluxos de segunda ordem para evitar o surgimento de oscilações próprias dos
esquemas de segunda ordem. Estes métodos são denominados FCT, i.e. flux correct
transport.

3.3 Esquema de alta ordem de acurácia

Na decada de 70, van Leer (1974) introduz a ideia de modificar o método de Godunov
de primeira ordem, a partir da utilização de uma aproximação de maior ordem para
Eq. (3.4) nos volumes de controle, de maneira a obtermos uma melhor aproximação para
os fluxos ~fadv(Sw), nas interfaces, como um primeiro passo para alcançar uma alta ordem
de acurácia. Esta é a base para o esquema MUSCL (Monotone Upstream Centered
Scheme for Conservation Laws). Seguindo os mesmos princípios que foram utilizados
por van Leer, para a extensão do método de Godunov, Colella and Woodward (1984)
introduziram uma reconstrução quadrática que permite representações de ordem mais
elevada do que MUSCL. Eles nomearam o esquema método parabólico por partes (PPM).
Outra abordagem, seguindo ideias semelhantes e que permite ainda uma reconstrução de
ordem superior é o método ENO (essentialy non-oscillatory) (Harten and Osher, 1997).
A acurácia de segunda ordem pode ser conseguida com relativa facilidade, através da
substituição do estado constante {Snw(i)} para cada VC no método de primeira ordem,
por um polinômio linear por partes para cada célula Sw(i) (x), usando apenas os dados a
partir das células vizinhas próximas como indicado na Fig. 3.2.

De igual forma que no esquema de primeira ordem de acurácia é considerado que S?nw(i)
representa a integral média na célula Ii =

[
xi?1/2,xi+1/2

]
, como indicado a seguir:

S?nw(i) =
1

4x

xi+1/2?
xi?1/2

Sw (x,t
n) dx. (3.18)

Isto resulta geralmente numa reconstrução conservativa e linear por partes. Um polinômio



3. O método dos volumes finitos clássico 41

Figura 3.2: Esquema de segunda ordem de acurácia.

linear da forma:
Snw (x,tn) = S?

n
w(i) + ?

n
i (x?xi), x ? Ii (3.19)

é calculado, onde xi é a posição do centro da célula e ?ni é a inclinação de S
n
w(x,tn) no

volume de controle i, onde a função linear Snw(x,tn) é definida localmente no volume de
controle. De modo que se ?ni = 0, o esquema se reduz ao esquema de primeira ordem tipo
Godunov, enquanto que para ?ni 6= 0, é possível obter um esquema de ordem mais alta.

O centro do volume de controle xi em coordenadas locais é x = 124x, onde 4x =
xi+1/2 ?xi?1/2, portanto, Snw(xi, tn) = S?nw(i). Os valores de S

n
w(x,tn) nos pontos extremos

desempenham um papel fundamental e são dados por:

Snw(i)L(x,tn) = S
n
w(xi?1/2) = S?

n
w(i)?

1

2
?ni ; S

n
w(i)R (x,tn) = S

n
w(xi+1/2) = S?

n
w(i) +

1

2
?ni , (3.20)

obtendo-se uma melhor estimativa em comparação com a reconstrução constante. Note
que a integral de Snw (x,tn), no VC Ii é a mesma que S?

n
w(i), e assim, desta forma conse-

guimos que o processo de reconstrução se mantém conservativo (Toro, 2009). Os valores
para Snw(i)L e S

n
w(i)R para cada volume de controle são então conhecidos, o que pode

ser usado para avaliar os fluxos numéricos para cada face, como por exemplo o fluxo
Fi+1/2

(
Snw(i)R,S

n
w(i+1)L

)
para a face xi+1/2 do volume de controle i, como indicado na

Fig. 3.2. Com a disponibilidade dos fluxos em cada uma da interfaces numéricas para
os volumes de controle, é possível calcular o resíduo de alta ordem procurado, como se
apresenta a seguir:



3. O método dos volumes finitos clássico 42

Ri = ?
1

4x
(
Fi+1/2 ?Fi?1/2

)
. (3.21)

Agora nosso objetivo é lidar com as oscilações espúrias características dos métodos de
ordem maior que um, as quais surgem na vizinhança de altos gradientes ou nas desconti-
nuidades. Isto é estabelecido pelo teorema de Godunov, onde é mencionado, que esquemas
numéricos lineares para resolver EDPs sem gerar novos extremos são, no máximo, de pri-
meira ordem (Godunov, 1959). Para este fim, na seção 3.4 é apresentada uma forma para
construir versões não lineares para os esquemas de alta ordem de acurácia, onde para
alcançar o referido objetivo a inclinação ?ni na Eq. (3.19) no estágio de reconstrução é
substituída pela inclinação limitada ?

n

i , atendendo às restrições dadas pela Eq. (3.16).

3.4 Esquema limitador de declividade

A ideia básica por trás do conceito de limitadores é controlar o processo de geração de
oscilações, over and undershoots, impedindo que os gradientes excedam certos limites ou
mudem de sinal entre volumes de controle vizinhos (LeVeque, 2002). Desta forma, os
esquemas não-monótonos podem ser “controlados” em cada intervalo de tempo e, dentro
de cada célula, mantendo os gradientes dentro dos limites adequados. Diversas funções
limitadoras de inclinação podem ser utilizadas (Hirsch, 2007), sendo que no presente
trabalho é utilizada à função limitadora “min mod”, que é sugerido por Wang (2002), para a
implementação de funções limitadoras tipo SVTVDM, SVTVBM, CVTVDM, CVTVBM.
Este é um limitador de propósito geral que, embora seja mais difusivo e menos preciso
do que outros limitadores, converge melhor. O limitador de inclinação tipo minmod, com
dois parâmetros, é apresentado a seguir:

??ni =
1

4x
min mod(S?nw(i+1) ? S?

n
w(i), S?

n
w(i) ? S?

n
w(i?1)), (3.22)

onde a função minmod é definida como:

min mod(a,b) =

?????
????
a se |a| &amp;lt;|b|e ab &gt; 0,

b se |b| &amp;lt;|a|e ab &gt; 0,

0 se ab ? 0;

(3.23)

=
1

2
[sign(a) + sign(b)] min(|a| , |b|).

Este procedimento pode ser melhor explicado pela visualização de uma reconstrução
linear para um caso 1D simples. A Fig. 3.3a ilustra uma solução típica utilizando-se
uma reconstrução linear não limitada nos volumes de controle. Usando-se uma função
limitadora as inclinações são reduzidas para evitar a formação de “extremos” ou oscilações



3. O método dos volumes finitos clássico 43

Figura 3.3: Reconstrução linear típica: (a) não limitada e (b) limitada.

espúrias. Isto é feito durante a reconstrução levando à solução ilustrada na Fig. 3.3b.
Um dos métodos de alta ordem, conhecido com o nome de SFVM ou spectral finite

volume method será descrito nesta dissertação e aplicado ao tratamento do modelo do
fluxo bifásico em reservatórios de petróleo nos capítulos subsequentes.

3.5 Discretização do termo difusivo

O modelo matemático unidimensional para o fluxo imiscível de água e óleo Eq. (2.41),
desconsiderando o termo fonte pode ser rescrita como:

?Sw
?t

+
?

?x
(fadv(Sw) + fdiff(Sw)) = 0. (3.24)

Levando em conta a natureza distinta dos termos advectivo e difusivo, as discretizações se-
guem caminhos separados. Isto significa que suas discretizações serão realizadas de forma
independente e com distintos esquemas numéricos. No presente trabalho, e considerando o
modelo matemático dado em Eq. (3.24), o termo advectivo é discretizado usando o SFVM
a ser descrito no capitulo 4. O termo de capilaridade ou termo difusivo será aproximado
utilizando o método de diferenças finitas centrado para os volumes de controle (CVFD).
A integração no tempo é feita utilizando o método explícito de Runge-Kutta (RK) de
ordem 3.

Com as definições prévias, o esquema “semi-discreto” pode ser escrito como (Cueto-
Felgueroso, 2009):

dSw
dt

+
1

4xi
[
(fnadv + f

n
diff)

??
xi+1/2 ? (f

n
adv + f

n
diff)

??
xi?1/2

]
= 0. (3.25)

Rearranjando os termos da Eq. (3.25), temos:



3. O método dos volumes finitos clássico 44

dSw
dt

+
1

4xi
[(
fnadv |xi+1/2 ?f

n
adv |xi?1/2

)
+
(
fndiff |xi+1/2 ?f

n
diff |xi?1/2

)]
= 0. (3.26)

Para calcular os fluxos difusivos fndiff |xi±1/2, precisa-se aproximar a Eq. (2.43) nas interfaces
numéricas xi±1/2 de cada volume de controle , o que implica:

1. Interpolar a saturação Sw para as interfaces.

2. Aproximar a derivada espacial da saturação S
?
w, também nas interfaces.

Uma vez que temos as saturações interpoladas nas interfaces, e utilizando-se a derivada
“analítica” dpc/dSw do modelo de Brooks e Corey na Eq. (2.25) podemos avaliar os co-
eficientes de “difusão” hw(Sw), dados pela Eq. (2.37). Multiplicando pela derivada da
saturação nas interfaces, é obtido o fluxo nas interfaces dado pela Eq. (2.43). A fim
de aproximar a derivada das saturações nas interfaces, pode-se construir uma matriz de
diferenciação. Assim dadas as saturações nos centros das células e nos contornos das
referidas células, pode-se obter as derivadas nos pontos centrais através de um produto
matriz-vetor. Nos pontos interiores do domínio, xi+1/2, i = 1, . . . ,N ? 1, nós podemos
utilizar diferenças centradas de ordem 2, da forma a seguir:

S
?

w(i+1/2) =
Sw(i+1) ?Sw(i)

4xi
, (3.27)

e para a esquerda (LB) e direita (RB) do contorno utilizamos fórmulas de ordem 1,

S
?

w(1/2) =
Sw1 ?SwLB
4xi/2

, S
?

w(N+1/2) =
SwRB ?SwN
4xi/2

, (3.28)

onde 4xi é o comprimento do volume de controle (VC).
Com os fluxos advectivos e difusivos calculados, pode-se avançar no tempo de acordo

com a Eq. (3.26), utilizando um esquema explícito tipo RK. Este foi escolhido na procura
de uma discretização temporal acurada e de uma faixa de estabilidade maior, e será
descrito na continuação.

3.6 Discretização temporal

Na discretização temporal tem-se duas abordagens. Uma delas consiste em tratar a di-
mensão temporal como apenas uma outra dimensão “espacial”. Isto é possível, e foi
considerado no passado (Zienkiewicz and Taylor, 1988). Mas este abordagem não encon-
trou ampla aceitação, pois é computacionalmente injustificada porque implica em custo
computacional desnecessário e proibitivo (Löhner, 2008). A segunda abordagem considera
de forma separada a discretização espacial e a temporal. Em geral, realiza-se primeiro a
discretização espacial do operador e o problema semi-discreto a ser resolvido é expresso



3. O método dos volumes finitos clássico 45

por um sistema de equações diferenciais ordinárias não lineares (EDO). Considerando a
segunda abordagem a Eq. (3.26) pode ser escrita em forma compacta como:

dSw
dt

= R (Sw) , (3.29)

com Sw representando as incógnitas.
Abordagem para esquemas explícitos para a solução da Eq. (3.29) é feita tomando o

R do lado direito da Eq. (3.29) em um momento conhecido e calculando a incógnita Sw
em algum momento no futuro, com base nele. O caso mais simples é o esquema de Euler
avançado, que é dado por:

Sw
n+1 = Snw + 4tR (S

n) . (3.30)

Este esquema é apenas de primeira ordem. Uma generalização imediata que permite
obter esquemas de ordem superior é dada pelo método explícito de RK (Hirsch, 2007;
Lyra, 1994), que pode ser expresso como:

S0w = S
n
w,

...

S(m)w = S
n
w + ?m4tR

(m+1)(Sw), m = 1 . . .s,
...

Sn+1w = S
(s)
w .

Qualquer método de RK é definido pelo número de etapas ”s” e os coeficientes ”?”.
Estes coeficientes são escolhidos de acordo com as propriedades desejadas, tais como a
quantidade de difusão artificial e ordem temporal de acurácia. As escolhas mais comuns
são:

1. Esquema de uma-etapa (Euler avançado): ?1 = 1.0

2. Esquema de duas-etapas: ?1 = 0.5, ?2 = 1;

3. Esquema de três-etapas ?1 = 0.6, ?2 = 0.6, ?3 = 1;

As principais propriedades dos esquemas explícitos são:

• Permitir uma ordem arbitrária de acurácia temporal.

• Facilidade de implementação.

• Simplicidade na aplicação das condições de contorno.

• Existência de um 4t máximo ditado por questões de estabilidade, como indicado
na Fig. 3.4. Onde observa-se o aumento da região de estabilidade ao incrementar a



3. O método dos volumes finitos clássico 46

?5 ?4 ?3 ?2 ?1 0 1 2

?3

?2

?1

0

1

2

3

Real ?? t

Im
a

g
 ?

?
 t

 Regiões de estabilidade para o esquema de Runge?Kutta 
 no plano complexo

 

 

RK?1
RK?2
RK?3
RK?4

Figura 3.4: Regiões de estabilidade para o esquema de Runge-Kutta.

ordem de acurácia, ou seja o número de etapas do método (Trefethen, 2000; Hirsch,
2007).

O intervalo de tempo permissível 4t é limitado por restrições de estabilidade, tais
como o chamado número de CFL (Courant-Friedrichs-Levy) (Hirsch, 2007). Para um
sistema hiperbólico de equações diferenciais parciais lineares, o número de CFL é dado
pela relação a seguir:

CFL =
4t?max
4x

, (3.31)

onde 4t é o intervalo de tempo, 4x é um tamanho característico da célula e ?max é o
máximo autovalor da matriz jacobiana A = ?fadv

?Sw
, onde fadv é fluxo advectivo de Sw.



47

Capítulo 4

Método espectral dos volumes finitos

4.1 Considerações iniciais

A lgoritmos numéricos para leis de conservação têm sido extensivamente pesquisadosnas últimas três décadas. As formulações numéricas para lidar com leis de conser-
vação hiperbólicas mais utilizadas basam-se no método de Godunov (1959) e, em geral,
utilizam procedimentos como resolvedores de Riemann aproximados ou métodos do tipo
Flux/Vector-Splitting, para melhorar a eficiência Liou (2000); Osher (1984); Roe (1981);
van Leer (1982); Wang (1997). O capítulo anterior foi apresentado o método dos volumes
finitos clássico (FVM). Este método tem muitas propriedades favoráveis, tais como fle-
xibilidade para trabalhar com malhas quaisquer, disponibilidade de funções limitadoras
de inclinação/fluxo “robustas” para garantir as propriedades TVD, além de apresentar
a propriedade de conservação local. Ditas características fazem com que o método seja
amplamente utilizado para a discretização espacial de equações governantes associadas a
problemas físicos e da engenharia (Choi et al., 2004). Por outro lado o FVM apresenta
algumas importantes deficiências para lidar com problemas onde a física e a geometria
são complexas, e onde a ordem de acurácia maior que dois (k &gt; 2), é desejável (van den
Abeele, 2009). O FVM de primeira ou segunda ordem de acurácia apresenta excessiva
quantidade de erros numéricos, amplamente difusivos, embora também dispersivos, que
só podem ser minimizados com o aumento do número de VC e, portanto, aumentando o
custo computacional (Choi et al., 2004). A principal limitante do FVM é a disponibilidade
de só um grau de liberdade por VC, ou seja a solução média. Portanto é necessário um
conjunto de VC vizinhos para conseguir uma reconstrução polinomial de ordem maior que
um (k &gt; 1). A disponibilidade do conjunto de VC vizinhos é complexa dada ao quase-
aleatória arranjo de VC das malhas não estruturadas. A complexidade ainda é maior na
tentativa de construir esquemas de alta ordem (Choi et al., 2004).

Diversos esquemas de alta ordem têm sido desenvolvidos, por exemplo, o esquema de
alta ordem de volumes finitos k-exato, desenvolvido por Barth and Frederickson (1990), o
esquema ENO (essentially non-oscillatory) desenvolvido por Abgrall (1994) e o esquema



4. Método espectral dos volumes finitos 48

WENO (weighted essentially non-oscillatory) desenvolvido por Friedrich (1998) e Hu and
Shu (1999). Destacam-se ainda os algoritmos localmente conservativos e de alta ordem
conhecidos como método de Galerkin descontínuo (DG) que foi desenvolvido por Cockburn
and Shu (1989) e Cockburn et al. (1989, 1990), e outro esquema conservativo de alta ordem
conhecido por método multidomínio espectral que foi desenvolvido por Kopriva (1991) e
Kopriva and Kolias (1995).

No presente capítulo um método muito eficaz de alta-ordem de acurácia (k ? 2), para
lidar com leis de conservação hiperbólicas, denominado método espectral dos volumes
finitos ou SFVM (spectral finite volume method), que foi desenvolvido por Wang, Liu
e colaboradores no início do século vinte um será discutido (Wang, 2002; Wang and
Liu, 2002). A expressão “método espectral” pode possuir diferentes significados para
diversas subáreas da matemática. Porém, no contexto deste trabalho, a dita expressão
faz referência a um método numérico de alta acurácia para resolver PDE eficientemente,
onde a solução numérica é expressa como uma expansão finita de um conjunto de funções
de base polinomiais. Para a atualização da referida solução é utilizado um método tipo
Godunov (1959), que tornou-se o estado da arte para lidar com leis de conservação. O
SFVM pode ser visualizado como uma extensão do método tipo de Godunov para alta
ordem, no qual o DOFs (degrees-of-freedom) é acrescentado na forma de sub-células, no
interior de cada célula simples da malha primal ou VC. No SFVM cada VC é denominado
SV (spectral volume) e cada sub-célula é referida como CV (control volume). No SFVM
todos os SVs são subdivididos em forma geométrica similar e utilizando procedimentos
analíticos, conseguindo desta maneira um estêncil de reconstrução único e pré-definido
para todos os SVs. Com o objetivo de atualizar as incógnitas ou DOFs que são as soluções
médias nas sub-células ou CVs, um procedimento de igual modo ao FVM é utilizado.
Diversos estudos realizados no passado têm demostrado a eficácia do SFVM para lidar
com uma ampla variedade de aplicações na engenharia, e desta forma mostrando sua
robustez (Kannan and Wang, 2012).

4.2 Método espectral dos volumes finitos unidimensio-

nal

Para analisar as características do SFVM, o esquema unidimensional será estudado a
partir de agora. Por conseguinte é considerada a lei de conservação unidimensional a
seguir, onde o termo fonte é desconsiderado:

?Sw (x,t)

?t
+ ?· ~fadv(Sw(x,t)) = 0 em [a,b] × [0,T] , (4.1)

com condição inicial Sw (x, 0) = Sw(0) (x) , ?x ? [a,b] e condições de contorno periódicas.
Outros tipos de condições de contorno serão analisadas na seção 4.6. Aqui Sw (x,t) é a
variável conservativa e ~fadv (Sw (x,t)) representa o fluxo advectivo dado pela Eq. (2.42).



4. Método espectral dos volumes finitos 49

O domínio computacional ? ? a ? x ? b sobre o qual esta lei de conservação é válida
é dividido em NSV células espectrais, SV(?i), com índice i : xi?1/2 ? x ? xi+1/2 de tal
forma que x1/2 ? a e xNSV+1/2 ? b. Para um esquema unidimensional de k-ésima ordem
de acurácia, estas células SV são subdivididos em k volumes de controle, CV(?i,j), com
índice j e contornos xi,j?1/2 e xi.j+1/2. Na Fig. 4.1 a subdivisão do volume espectral SV em
volumes de controle CV é apresentada para segunda ordem de acurácia.

Figura 4.1: Domínio físico com 4 células espectrais SV, utilizando segunda ordem de
acurácia, k = 2, com contornos xi,j?1/2 e xi.j+1/2 para a subcélula espectral CV e pontos
solução (•) S?w(i,j).

Integrando a Eq. (4.1) em cada CV(?i,j) e aplicando o teorema da divergência de
Green-Gauss, temos: ?

?i,j

?Sw(x,t)

?t
dx +

?
??i,j

~fadv(Sw(x,t)) ·d~s = 0. (4.2)

Aplicando o teorema da média a Eq. (4.2), pode-se escrever da forma a seguir:

dS?w(i,j)
dt

= ?
~fadv

(
Sw(i,j+1/2)

)
? ~fadv

(
Sw(i,j?1/2)

)
xi,j+1/2 ?xi,j?1/2

, (4.3)

onde S?w(i,j) são as variáveis conservativas médias nos CVs. Estas são obtidos através de:

S?w(i,j) =
1

xi,j+1/2 ?xi,j?1/2

? xi,j+1/2
xi,j?1/2

Sw (x,t) dx. (4.4)

Em cada SV a solução pode ser aproximada por um polinômio PSVi (x,t) de grau p
(i.e. p = k ? 1), assim:

Sw(i) (x,t) ? PSVi (x,t) ?
p+1?
j=1

L?i,j (x) S?w(i,j) (t) . (4.5)

Na Eq. (4.5), as funções de base L?i,j para o SV são definidas por



4. Método espectral dos volumes finitos 50

1

x
i,j+1/2

?xi,j?1/2

? xi,j+1/2
xi,j?1/2

L?i,k (x) dx = ?j,k, (4.6)

com ?j,k sendo a função delta de Kronecker. Agora, utilizando a solução polinomial dada
na Eq. (4.5), os fluxos nos contornos dos CV podem ser aproximados e o lado direito da
Eq. (4.3) pode ser avaliado. Na interface entre as duas células dos SVs, um resolvedor
de Riemann Eq. 3.5 para fadv é utilizado para lidar com a potencial descontinuidade na
solução numérica, onde SwL e SwR representam os estados à esquerda e à direita das
interfaces, respectivamente. Assim, a Eq. (4.3) pode ser escrita da forma a seguir:

dS?w(i,j)
dt

= ?
F(i,j+1/2) ?F(i,j?1/2)
xi,j+1/2 ?xi,j?1/2

, (4.7)

onde F(i,j+1/2) são os fluxos obtidos do resolvedor de Riemann. Deste modo, cada CV
dentro de um SV é tratado independentemente, com o objetivo de atualizar a variável
de estado média para o CV no próximo passo de tempo. Para o caso onde as variáveis
reconstruídas nos contornos dos CV são continuas. Isto é para funções simples, as quais
não apresentam gradientes acentuados, e onde as funções limitadores não são necessárias.
O fluxo numérico nas interfaces internas torna-se um fluxo analítico, que é muito mais
barato, que o fluxo numérico ou de Riemann. O fluxo analítico é da forma a seguir:

F(i,j?1/2) = fadv(i,j?1/2). (4.8)

No entanto, quando se introduz uma função limitadora para suprimir oscilações espú-
rias, os resolvedores de Riemann podem ser necessários nas interfaces entre CVs (Wang
et al., 2004; Breviglieri et al., 2010). Neste ordem de ideias, quando o fluxo numérico é
requerido, um primeiro passo é calcular a diferença entre as variáveis de estado à esquerda
e à direita da face entre CVs. O caso a referida diferença seja zero, para todas as variá-
veis no interior do SV, o fluxo analítico é calculado. Caso contrário o fluxo numérico é
avaliado, como será discutido na Sec. 4.7. A Eq. (4.7) é uma equação diferencial ordinária
(EDO) e pode ser resolvida no tempo utilizando qualquer algoritmo para tais sistemas,
por exemplo o esquema de RK.

4.3 Definição das partições

O processo para obter as partições para a célula espectral no SFVM, que para o caso
unidimensional é composto por segmentos de reta, é discutido a seguir. Uma célula padrão
SV é utilizada para definir as partições, sendo mapeada no domínio computacional [-1,1]
como se apresenta na Fig. 4.2.

Existem duas abordagens para fazer as partições. A primeira é uma subdivisão natu-
ral do SV em CVs uniformes. Porém deve-se tomar cuidado com esta partição devido ao
comportamento fortemente oscilatório dos polinômios perto dos contornos da célula espec-



4. Método espectral dos volumes finitos 51

?1 ?0.8 ?0.6 ?0.4 ?0.2 0 0.2 0.4 0.6 0.8 1
?6

?4

?2

0

2

4

6

X

Polinômios de Chebyshev de segunda clase

 

 

U1
U2
U3
U4
U5

(a)

(b)

Figura 4.2: (a) Polinômios de Chebyshev até ordem 5. (b) Partições não uniformes do SV
no domínio computacional gerados pelos zeros do polinômio de Chebyshev, para ordem
de acurácia 2 (b.1), ordem 3 (b.2) e ordem 4 (b.3).



4. Método espectral dos volumes finitos 52

tral, para ordens de acurácia maiores que 3 (k &gt; 3). Note-se que para k = 6 na Fig. 4.3b,
as bases polinomiais perto dos contornos do SV são bastante oscilatórias. Os valores
estabelecidos nesses pontos variam de -4 a 4, tornando as interpolações potencialmente
oscilatórias em tais locais.

?1 ?0.5 0 0.5 1
?1.5

?1

?0.5

0

0.5

1

1.5

2

X

Malha Uniforme

 

 

 L
1

 L
2

 L
3

(a) k = 3

?1 ?0.5 0 0.5 1
?4

?3

?2

?1

0

1

2

3

4

X

Malha Uniforme

 

 

 L
1

 L
2

 L
3

 L
4

 L
5

 L
6

(b) k = 6

Figura 4.3: Bases polinomiais {L} com variável média no centro da célula utilizando CV
equidistantes para: (a) k=3 e (b) k=6.

Isto é conhecido como o fenômeno de Runge (Isaacson, 1994), que é um problema de
oscilação nas bordas de um intervalo, que ocorre quando se utiliza interpolação polinomial
com polinômios de ordem elevada. A continuação se apresenta uma maneira de minimizar
este problema, utilizando os nós de Chebyshev ou pontos de Gauss-Lobatto, em vez de



4. Método espectral dos volumes finitos 53

nós equidistantes, como indicado na Fig. 4.4.

?1 ?0.5 0 0.5 1
0

0.2

0.4

0.6

0.8

1
Pontos Equidistantes

 

 

Interpolação Eq
Função

?1 ?0.5 0 0.5 1
0

0.2

0.4

0.6

0.8

1
Pontos Gauss?Lobatto

 

 
Interpolação G?L
Função

Figura 4.4: Surgimento do fenômeno de Runge ao interpolar a função: f(x) = 1
1+12x2

utilizando 16 pontos de interpolação.

Se os pontos da malha no intervalo padrão do domínio computacional (DC) [-1,1],
utilizados para subdividir o SV são os pontos da quadratura de Gauss-Lobatto, definidos
a seguir:

xDCi,j+1/2 = ?cos
(
j?

k

)
, j = 0, . . . ,k, (4.9)

os quais correspondem aos zeros do polinômio de Chebyshev de segunda classe, consegue-
se uma reconstrução polinomial muito menos oscilatória. Note-se na Fig. 4.5b que as bases
polinomiais estão limitadas entre -1.0 e 1.7, obtendo-se desta forma uma interpolação com
menor oscilação nos extremos do DC. É claro, então, que o agrupamento dos pontos da
malha perto dos contornos produz interpolações polinomiais limitadas.

O mapeamento de cada SV do DC para o domínio físico (DF) é feito utilizando a
relação a seguir:

xDFi,j+1/2 = a +

(
xDCi,j+1/2 + 1

)
2

(b?a) , (4.10)

onde a e b são os extremos no intervalo do DF.

4.4 Reconstrução polinomial unidimensional

Dadas as variáveis de estado médias de Sw para todos os CVs em SVi, Eq. (4.4), temos
como objetivo construir um polinômio PSVi (x), de grau no máximo k ? 1, para SVi, de



4. Método espectral dos volumes finitos 54

?1 ?0.5 0 0.5 1
?1

?0.5

0

0.5

1

1.5

2

X

Malha Gauss?Lobatto

 

 

 L
1

 L
2

 L
3

(a) k = 3

?1 ?0.5 0 0.5 1
?4

?3

?2

?1

0

1

2

3

4

X

Malha Gauss?Lobatto

 

 

 L
1

 L
2

 L
3

 L
4

 L
5

 L
6

(b) k = 6

Figura 4.5: Bases polinomiais {L} com variável média no centro da célula utilizando CVs
dados pelos pontos de quadratura de Gauss-Lobatto para (a) k=3 e (b) k=6.



4. Método espectral dos volumes finitos 55

tal forma que este polinômio seja de k-ésima ordem de aproximação para a função Sw (x)
no interior de SVi, i.e.,

PSVi (x) = Sw (x) + O
(
hk
)
, x ? SVi, i = 1, ...,N. (4.11)

Em particular a Eq. (4.11) fornece as aproximações para a função Sw (x) nos contornos
dos CVs, da forma a seguir:

Sw(i,j+1/2) ? PSVi
(
xi,j+1/2

)
= Sw(i)

(
xi,j+1/2

)
+ O

(
hk
)
, j = 0, ...,k i = 1, ...,N. (4.12)

Esta reconstrução pode ser feita de muitas formas. Porém, aqui é utilizado o método
apresentado por Shu (1998), no qual se considera a existência de um único polinômio de
grau no máximo k ? 1, de tal forma que a média em cada um dos CV em SVi pode ser
escrita como:

S?w(i,j) =
1

hi,j

? xi,j+1/2
xi,j?1/2

PSVi (x) dx; j = 1, ...,k, (4.13)

onde PSVi (x) é a aproximação de Sw(x) e hi,j = xi,j+1/2?xi,j?1/2 (ver Eq. 4.4). Resumindo,
é preciso calcular a solução aproximada de Sw (x) nos contornos dos CV, para atualizar
a variável de estado S?w (x) no próximo nível de tempo. Uma vez que o mapeamento das
variáveis médias S?w(i,j) para os contornos dos CV é resultado de uma combinação linear,
existem coeficientes cjl os quais dependem do ordem de acurácia k e do tamanho da malha
hi,j em SVi, mas não da própria função Sw (Shu, 1998), de tal forma que:

Sw(i,j+1/2) =
k?
l=1

cjlS?w(i,l), j = 0, ...,k. (4.14)

Com a expressão anterior, Eq. (4.14), é possível aproximar o valor de Sw nos contornos
dos CVs de forma simples. A continuação é discutido o procedimento para calcular as
constantes de interpolação cjl.

4.5 Constantes de interpolação polinomial

Considerando a função primitiva para Sw (x), dada por:

S?w (x) ?
x?

xi,1/2

Sw (?) d (?) , x ? SVi. (4.15)

Ao avaliar em x = xi,j+1/2 a Eq. (4.15) pode ser expressa exatamente pela média de Sw (x)
das células dos CVs nos contornos do volume de controle para um SVi, como se apresenta
a seguir:



4. Método espectral dos volumes finitos 56

S?w
(
xi,j+1/2

)
=

j?
l=1

xi,l+1/2?
xi,l?1/2

Sw (?) d? =

j?
l=1

S?w(i,l)hi,l, para j = 1, ...,k. (4.16)

Por definição, a Eq. (4.15), quando j = 0 é:

S?w
(
xi,1/2

)
= 0. (4.17)

Resumindo, acontece que conhecendo as variáveis médias nas células para os CV, é
possível calcular a função primitiva S?w (x) exatamente nos contornos dos CV. Denotando
o único polinômio de grau no máximo k, o qual interpola S?w

(
xi,j+1/2

)
nos k + 1 pontos a

seguir:
xi,1/2, ...,xi,k+1/2, (4.18)

por ?i (x) e a derivada deste polinômio por Pi (x), i.e.,

Pi (x) ? ?
?

i (x) , (4.19)

então se verifica que:

1

hi,j

xi,j+1/2?
xi,j?1/2

Pi (x) dx =
1

hi,j

xi,j+1/2?
xi,j?1/2

?
?

i (x) dx =
1

hi,j

[
?
(
xi,j+1/2

)
??

(
xi,j?1/2

)]
,

=
1

hi,j

[
S?w
(
xi,j+1/2

)
? S?w

(
xi,j?1/2

)]
,

=
1

hi,j

?
??
xi,j+1/2?
xi,1/2

Sw (x) dx?

xi,j?1/2?
xi,1/2

Sw (x) dx

?
?? , (4.20)

=
1

hi,j

xi,j+1/2?
xi,j?1/2

Sw (x) dx = S?w(i,j), j = 1, ...,k.

Isto implica que Pi (x) é o polinômio procurado. Pela teoria de aproximação padrão
tem-se:

?
?

i (x) = S?
?

w (x) + O
(
hk
)
, x ? SVi; (4.21)

i.e.,

Pi (x) = Sw (x) + O
(
hk
)
, x ? SVi. (4.22)

A Eq. (4.22), apresenta o requerimento de acurácia desejado. Para obter as constantes



4. Método espectral dos volumes finitos 57

{cjl} da Eq. (4.14), é utilizado o formalismo de interpolação polinomial de Lagrange, onde

?i (x) =
k?
r=0

S?w(i,r+1/2)?i,r+1/2 (x) x ? SVi. (4.23)

Onde, S?w(i,r+1/2) = S?w
(
xi,r+1/2

)
e ?i,r+1/2 (x) são os coeficientes de interpolação de La-

grange, da forma a seguir:

?i,r+1/2 (x) =
k?

l=0,l 6=r

x?xi,l+1/2
xi,r+1/2 ?xi,l+1/2

. (4.24)

Introduzindo:

? (x) =
(
x?xi,1/2

)(
x?xi,3/2

)
. . .
(
x?xi,k+1/2

)
, (4.25)

pode-se escrever a Eq. (4.24) como:

?i,r+1/2 =
? (x)(

x?xi,r+1/2
)
?
?
(
xi,r+1/2

). (4.26)
Para a reconstrução baseada nas variáveis média na célula, o polinômio de ordem k?1

procurado, considerando as Eqs. (4.17) e (4.19), a Eq. (4.23) pode ser escrita da forma a
seguir:

Pi (x) = ?
?

i (x) =
k?
r=0

S?w(i,r+1/2)?
?

i,r+1/2 (x) =
k?
r=1

S?w(i,r+1/2)?
?

i,r+1/2 (x) , (4.27)

onde da Eq. (4.26) temos:

?
?

i,r+1/2 (x) =
?
?
(x)(

x?xi,r+1/2
)
?
?
(
xi,r+1/2

) ? ? (x)(
x?xi,r+1/2

)2
?
?
(
xi,r+1/2

),
=

1

?
?
(
xi,r+1/2

) k?
l=0,l 6=r

? (x)(
x?xi,r+1/2

)(
x?xi,l+1/2

). (4.28)
Substituindo a Eq. (4.16) na Eq. (4.27), é obtido o polinômio de ordem k?1 baseado nas
variáveis média nas células da forma a seguir:

Pi (x) =
k?
r=1

r?
l=1

S?w(i,l)hi,l?
?

i,r+1/2 (x) =
k?
l=1

(
k?
r=l

?
?

i,,r+1/2 (x) hi,l

)
S?w(i,l). (4.29)

Utilizando as Equações (4.28) e (4.29), pode-se escrever a forma geral para as funções de
base polinomiais da forma a seguir:



4. Método espectral dos volumes finitos 58

Ll (x) = hi,l

k?
r=l

?
?

i,r+1/2 (x) = hi,l

k?
r=l

1

?
?
(
xi,r+1/2

) k?
m=0,m 6=r

? (x)(
x?xi,r+1/2

)(
x?xi,m+1/2

)
= hi,l

k?
r=l

1

?
?
(
xi,r+1/2

) k?
m=0
m 6=r

k?
q=0
q 6=r,m

(
x?xi,q+1/2

)
. (4.30)

Logo,

Pi (x) =
k?
l=1

Ll (x) S?w(i,l). (4.31)

Portanto os coeficientes {cjl} são da forma a seguir:

cjl = Ll
(
xi,j+1/2

)
= hi,l

k?
r=l

1

?
?
(
xi,r+1/2

) k?
m=0
m 6=r

k?
q=0
q 6=r,m

(
xi,j+1/2 ?xi,q+1/2

)
. (4.32)

A Eq. (4.32) pode ser utilizada para calcular as constantes de interpolação para qualquer
distribuição de pontos i.e., subdivisão de CV no SV. Se os CVs são de igual tamanho a
Eq. (4.32) pode ser escrita da forma a seguir:

cjl =
k?
r=l

1?k
q=0,q 6=r (r ? q)

k?
m=0
m 6=r

k?
q=0
q 6=r,m

(j ? q) . (4.33)

Nas Tabelas (4.1) e (4.2) são apresentadas as constantes de interpolação utilizando a
Eq. (4.32) e Eq. (4.33) respectivamente. As constantes de interpolação cjl não mudam ao
mapear do domínio computacional para o domínio físico para quaisquer SV. Isto se deve
ao fato de que só dependem da ordem de acurácia desejada e da relação do tamanho dos
CVs. Esta é uma clara vantagem do SFVM quando comparado com outros métodos de
alta ordem, porque as constantes podem ser previamente computadas analiticamente e
só ser utilizadas no momento do cálculo das variáveis reconstruídas. Outra forma de ver
como é feito o cálculo das constantes cjl é avaliando as funções base Ll em sua forma
explícita nos pontos de quadratura do domínio computacional para uma determinada
partição.

A seguir apresenta-se como exemplo as funções base para ordem de acurácia k = l = 3:



4. Método espectral dos volumes finitos 59

Tabela 4.1: Coeficientes de reconstrução para CVs não uniformes utilizando a distribuição
dos pontos de Gauss-Lobatto Eq. (4.32).

k j l=1 l=2 l=3 l=4

1
0 1
1 1

2
0 3/2 -1/2
1 1/2 1/2
2 -1/2 3/2

3

0 19/12 -5/6 1/4
1 1/2 2/3 -1/6
2 -1/6 2/3 1/2
3 1/4 -5/6 19/12

4

0 1801/1118 -1053/1121 1786/3761 -204/1393
1 1/2 985/1393 -408/1393 102/1189
2 -204/1393 373/577 373/577 -204/1393
3 102/1189 -408/1393 985/1393 1/2
4 -204/1393 1786/3761 -1053/1121 1801/1118

Tabela 4.2: Coeficientes de reconstrução para CVs uniformes utilizando utilizando a dis-
tribuição dada na Eq. (4.33).

k j l=1 l=2 l=3 l=4

1
0 1
1 1

2
0 3/2 -1/2
1 1/2 1/2
2 -1/2 3/2

3

0 11/6 -7/6 1/3
1 1/3 5/6 -1/6
2 -1/6 5/6 1/3
3 1/3 -7/6 11/6

4

0 25/12 -23/12 13/12 -1/4
1 1/4 13/12 -5/12 1/12
2 -1/12 7/12 7/12 -1/12
3 1/12 -5/12 13/12 1/4
4 -1/4 13/12 -23/12 25/12



4. Método espectral dos volumes finitos 60

L1 (x) = ?
2x? 3x2 + ?2

2 + 2?
,

L2(x) =
1 ? 3x2 + ? + ?2

1 + ?
, (4.34)

L3(x) =
2x + 3x2 ? ?2

2 + 2?
,

onde x = xDCi,j+1/2 pertence ao domínio computacional [-1,1] e ? é um parâmetro livre
que depende do tipo de partição (Liu, 2013). Para o caso analisado as funções base
polinomiais Eq. (4.34) são avaliadas nos pontos de quadratura gerados pela distribuição
de Gauss-Lobatto, Eq. (4.9), com ? = 1/2, i.e.,

xDCi,j+1/2 = [?1 ? 1/2 1/2 1] . (4.35)

A distribuição de Gauss-Lobatto foi adotada neste trabalho devido ao fato de que ela
apresenta baixa oscilação perto dos extremos do domínio computacional e, desta forma,
conseguimos minimizar o surgimento de oscilações espúrias associadas a esquemas de
ordem de acurácia maior a um. Outro motivo é que a distribuição de Gauss-Lobatto é
utilizada na maioria dos testes que foram tomados como referência para verificar nosso
trabalho.

Por outro lado, existem outros tipos de partições como por exemplo a denominada
tangente hiperbólica,

xi,j+1/2 =
tanh

(
2µj
k
?µ

)
tanh (µ)

, j = 0, ...,k, (4.36)

onde o parâmetro livre µ controla o grau de agrupamento dos pontos de quadratura perto
dos contornos da célula espectral. Para mais detalhes, ver Wang (2002). Finalmente,
procurando uma optimização do comportamento das partições na solução, van den Abeele
et al. (2007b) propõem a distribuição fornecida na Tabela 4.3.

Tabela 4.3: Posições otimizadas para os contornos dos CVs no domínio computacional.

k ?1 ?2 ?3 ?4 ?5
2 -1,00 0,00 1,00
3 -1,00 -0,58 +0,58 +1,00
4 -1,00 -0,78 0,00 +0,78 +1,00



4. Método espectral dos volumes finitos 61

4.6 Condições de contorno e iniciais

As condições de contorno desempenham um papel muito importante em todos os pro-
blemas físicos. Dado um conjunto de equações governantes válidas, em um determinado
domínio, a solução para um problema físico em estado estacionário é definida inteiramente
pelas condições de contorno. No caso de problemas físicos transientes, a solução inicial
e as condições de contorno são relevantes. Como consequência, impor adequadamente
as condições de contorno e iniciais é uma necessidade para obter simulações numéricas
acuradas (van den Abeele, 2009).

Para alcançar este objetivo, um valor para a face no contorno Sbnd é imposto. Isto
significa que a solução numérica é forçada a ter exatamente o mesmo valor no contorno
como o que é prescrito pela condição de fronteira, o que corresponde a uma imposição
forte. Além disso no SFVM, soluções em um SV “fantasma”, i.e., S?w(gho), são introduzidas
na face à esquerda do contorno de entrada SVbnd, ver Fig. 4.6. Isto para auxiliar na im-
plementação das funções limitadoras, como será apresentado na Sec. 4.7. Um tipo básico
de condição de contorno, conhecida com o nome de condição de contorno de Dirichlet,
será discutido a seguir.

4.6.1 Condição de contorno de Dirichlet

A condição de contorno de Dirichlet, que é utilizada nos testes do problema de Buckley-
Leverett na Sec. 5.3.1, impõe diretamente um valor para a saturação Sw no contorno de
entrada “bnd” como indicado na Fig 4.6 da forma a seguir:

Figura 4.6: Esquema do domínio físico, com uma célula fantasma SV(gho) e três células
espectrais, incluindo a célula interna SV(int) e o contorno SVbnd.

Sw(bnd) = Sw (0, t) = 1 ?Sor, (4.37)

desta forma o fluxo numérico no ponto de quadratura “bnd” pode ser calculado utilizando
o fluxo analítico, como se apresenta a seguir:



4. Método espectral dos volumes finitos 62

Fbnd = fadv
(
Sw(bnd)

)
. (4.38)

Para alguns testes apresentados neste trabalho foram utilizadas condições de contorno
periódicas. Detalhes a respeito de outras formas para lidar com condições de contorno no
contexto do SFVM podem ser encontrados em (van den Abeele, 2009; Breviglieri et al.,
2010).

4.6.2 Condições iniciais

Para o tratamento da condição inicial no SFVM é necessário tomar cuidado na forma em
que é implementada esta condição quando o ordem de acurácia do SFVM é maior que
2 (k &gt; 2). Acontece que para orden igual a 2, o teorema do valor medio garante que a
posição do ponto de colocação corresponda ao centro do CV, onde a condição inicial é
avaliada para inicializar a solução numérica. Caso a ordem for maior que 2 isto não é
verdade e se adotaramos a condição inicial erroneamente como no caso de ordem 2 correta,
isto produz erros e queda na taxa de convergência esperada. A inicialização da solução
numérica para qualquer ordem do SFVM deve utilizar a média exata no CV, a qual é
dada pela integral da condição inicial como se apresenta a seguir (Sourek, 2013):

S(x, 0) = f(x), (4.39)

S?(x, 0) =
1

hi,j

? xi,j+1/2
xi,j?1/2

f(x)dx, (4.40)

o tratamento da condição inicial na solução analítica deve ser feito da mesma forma.

4.7 Funções limitadoras

O fenômeno de Gibbs associado com esquemas de alta ordem na presença de descontinui-
dades provoca a perda de monotonicidade da solução de leis de conservação hiperbólicas.
Godunov (1959) foi o primeiro a demostrar que não existem esquemas numéricos linea-
res de segunda ordem, ou de mais alta ordem, que garantem monotonicidade. Portanto,
esquemas monotônicos de alta ordem, se existirem, devem ser não-lineares (Godunov,
1959).

Há duas diferentes abordagens de funções limitadoras para alcançar monotonicidade.
Uma delas é adotada pelo algoritmo de FCT (Flux Corrected Transport) de Boris and
Book (1973), onde se limita o fluxo anti-difusivo e, assim, a solução no próximo nível de
tempo permanece monótona. A outra abordagem, originalmente desenvolvido por van
Leer (1974, 1979), é a de limitar a reconstrução de modo que a solução reconstruída seja
monótona. Neste trabalho vai ser utilizada a segunda aproximação, com dois tipos de



4. Método espectral dos volumes finitos 63

limitadores, TVD e TVB, que se encontram formulados em termos da notação para os
CVs e os SVs (Wang, 2002).

O primeiro limitador de declividade a ser abordado é denominado CVTVDM e atua
a nível dos CVs. Deste modo, dadas as variáveis médias para todos os CVs {S?w(i,j)}, no
interior dos SVi, existe um polinômio de reconstrução de ordem ao menos k ? 1, o qual
satisfaz a relação a seguir:

xi,j+1/2?
xi,j?1/2

PSVi (x)dx = S?w(i,j)hi,j, j = 1, ...,k. (4.41)

Lembrando que o polinômio de reconstrução é utilizado para atualizar as variáveis de
estado nos contornos dos CVs. Por sua vez estes são usadas para atualizar a solução no
próximo nível de tempo, como se apresenta a seguir;

dS?w(i,j)
dt

hi,j +
(
fadv(i,j+1/2) ?fadv(i,j?1/2)

)
= 0. (4.42)

onde

fadv(i,j+1/2) = F(S?
?
w(i,j+1/2)

, S?+
w(i,j+1/2)

), (4.43)

sendo F o resolvedor de Riemann a ser utilizado em todas as interfaces dos CVs, além das
interfaces dos SVs. Sendo S??

w(i,j+1/2)
e S?+

w(i,j+1/2)
as variáveis reconstruídas limitadas, as

quais garantem que o método ?umérico tem a propriedade “TVD” ou “TVB”. Para calcular
as variáveis reconstruídas limitadas, levamos em consideração que Sw(i,j+1/2) = S

?
w(i,j+1/2)

=

S+
w(i,j+1/2)

no interior dos SVs, então podemos escrever os operadores diferenças avançadas
e diferenças atrasadas, em termos das variáveis não limitadas como:

4S+
w(i,j)

= S?
w(i,j+1/2)

? S?w(i,j), (4.44)

4S?
w(i,j+1)

= S?w(i,j+1) ?S+w(i,j+1/2), (4.45)

conforme se apresenta na Fig 4.7, o tratamento nos contornos do SV é da forma:

Sw(i?1,k+1/2) = S
?
w(i,1/2)

= S?w(i?1,k) + 4S+w(i?1,k), (4.46)

Sw(i,1/2) = S
+
w(i.1/2)

= S?w(i.1) ?4S?w(i,1). (4.47)

Nas equações anteriores os superescritos (-) e (+) são usados para indicar o lado esquerdo
e o lado direito da interface numérica, respectivamente, e k é o ordem de acurácia. Com
as considerações anteriores as variáveis limitadas podem ser escritas como:



4. Método espectral dos volumes finitos 64

DS
+

w(i,j)

DS
-

w(i,j )+1

Sw(i,j)

Sw(i,j+1)

Sw(i,j-1)

Sw(i,j- )1/2 Sw(i,j )+1/2

S
-

w(i,j /2)+1 S
+

w(i,j )+1/2

Figura 4.7: Reconstrução polinomial por partes para o SFVM.

S??
w(i,j+1/2)

= S?w(i,j) + 4S?+w(i,j), (4.48)

S?+
w(i,j+1/2)

= S?w(i,j+1) ?4S??w(i,j), (4.49)

onde 4S??
w(i,j)

e 4S?+
w(i,j)

utilizam as funções limitadoras a seguir:

Função limitadora tipo CVTVDM

4S??
w(i,j)

= min mod
(
4S?

w(i,j)
, S?w(i,j+1) ? S?w(i,j), S?w(i,j) ? S?w(i,j?1)

)
, (4.50)

4S?+
w(i,j)

= min mod
(
4S+

w(i,j)
, S?w(i,j+1) ? S?w(i,j), S?w(i,j) ? S?w(i,j?1)

)
, (4.51)

onde a função min mod com três parâmetros é definida como:

min mod(x,y,z) =

??
?smin (|a| , |b| , |c|) , ses = sign(a) = sign(b) = sign(c)0 caso contrário. (4.52)



4. Método espectral dos volumes finitos 65

Função limitadora tipo CVTVBM

4S??
w(i,j)

??
?4S

?
w(i,j)

se
???S?w(i,j)??? ? Mh2i,j,

min mod
(
4S?

w(i.j)
, S?w(i,j+1) ? S?w(i,j), S?w(i,j) ? S?w(i,j?1)

)
caso contrário.

(4.53)

4S?+
w(i,j)

??
?4S

+
w(i,j)

se
???S+w(i,j)??? ? Mh2i,j,

min mod
(
4S+

w(i.j)
, S?w(i,j+1) ? S?w(i,j), S?w(i,j) ? S?w(i,j?1)

)
caso contrário.

(4.54)
O número M é dependente da segunda derivada da solução e é recomendado escolher o
valor máximo absoluto da segunda derivada da solução para o domínio computacional
(Wang, 2002).

O segundo limitador é conhecido com o nome de SVTVDM. Portanto, dado o vetor
das variáveis solução

{
S?w(i,j)

}
, calcula-se o vetor das variáveis solução limitadas

{
U?w(i,j)

}
,

de tal forma que:

{
U?w(i,j)

}
= SVTVDM

({
S?w(i,j)

})
. (4.55)

A seguir são apresentadas as etapas para obter o limitador SVTVDM:

• Primeiro calcular as variáveis médias nas células para os SV, de acordo com:

S?w(i) =

?k
j=1 S?w(i,j)hi,j?k

j=1 hi,j
, i = 1, ...,N, (4.56)

onde hi,j é o comprimento do CV, k é a ordem de acurácia do SFVM, e N é o número de
SVs.

• Cálculo da solução limitada nos contornos dos SV utilizando as soluções reconstruí-
das nos contornos,

S+
w(i,1/2)

= S?w(i) ?min mod
[
S?w(i) ?PSVi

(
xi,1/2

)
, S?w(i) ? S?w(i?1), S?w(i+1) ? S?w(i)

]
, (4.57)

S?
w(i,k+1/2)

= S?w(i) + min mod
[
PSVi

(
xi,k+1/2

)
? S?w(i), S?w(i) ? S?w(i?1), S?w(i+1) ? S?w(i)

]
,

(4.58)
onde PSVi (x) é o polinômio interpolador.

• Agora, se S+
w(i,1/2)

= PSVi
(
xi,1/2

)
e S?

w(i,k+1/2)
= PSVi

(
xi,k+1/2

)
, então:

U?w(i,j) = S?w(i,j), j = 1, ...k, (4.59)

caso contrário uma distribuição linear é assumida para SVi, i.e.,



4. Método espectral dos volumes finitos 66

Sw(i) (x) = S?w(i) + ? (x?xi) . (4.60)

A inclinação ? é dada por:

? = min mod

[
2
(
S?w(i) ? S?w(i?1)

)
hi

,
2
(
S?w(i+1) ? S?w(i)

)
hi

]
. (4.61)

Com a distribuição linear, Eq. (4.60), as variáveis médias na células para os CV podem
ser computadas de acordo com:

U?w(i,j) (x) = S?w(i) + ? (xi,j ?xi) . (4.62)

Similarmente, pode-se definir o limitador SVTVBM, alterando as funções limitadoras
das Eq. (4.57) e Eq. (4.58) da forma a seguir:

S+
w(i,1/2)

=

?????
????
S?w(i) ?PSVi

(
xi,1/2

)
se

??S?w(i) ?PSVi (xi,1/2)?? ? Mh2i ,
S?w(i) ?min mod

[
S?w(i) ?Pi

(
xi,1/2

)
, S?w(i) ? S?w(i?1),

S?w(i+1) ? S?w(i)
]

caso contrário.

(4.63)

S?
w(i,k+1/2)

=

?????
????
PSVi

(
xi,k+1/2

)
? S?w(i) se

??S?w(i) ?PSVi (xi,k+1/2)?? ? Mh2i ,
S?w(i) + min mod

[
PSVi

(
xi,k+1/2

)
? S?w(i), S?w(i) ? S?w(i?1),

S?w(i+1) ? S?w(i)
]

caso contrário.

(4.64)

A desvantagem da função limitadora tipo “TVD” é que reduz a acurácia do método,
na presença de descontinuidades, mesmo nos pontos extremos de soluções suaves. Este
problema é minimizado utilizando funções limitadoras tipo “TVB”.

4.8 Avaliação de acurácia dos métodos numéricos

Para quantificar o erro é preciso escolher uma norma. O conjunto padrão de normas mais
comumente usadas na comunidade CFD são as normas p, i.e.,

?E?p =

(
4x

??
i=??

|Ei|
p

)1/p
, (4.65)

onde E representa a função aproximação do erro ou a diferença entre a solução numérica
e a solução exata, isto é, E = (Variávelnumérica ?Variávelexata). Note-se que o termo 4x
é muito importante para se obter a escala certa e ordem de acurácia quando a malha é
refinada. O método é dito ser de ordem k se:



4. Método espectral dos volumes finitos 67

?E?p = O
(
4xk

)
, (4.66)

quando 4x ? 0. Idealmente é desejável obter numericamente a taxa de convergência
teórica quando a malha é refinada (Hirsch, 2007).

Na obtenção da taxa de convergência utilizou-se a norma L1 e a norma máxima L?,
ou norma ?, para a medida do erro, como se apresenta a seguir:

?E?1 =

(
4x

??
i=??

|Ei|

)
, (4.67)

?E?? = max??&lt;i&lt;? |Ei| . (4.68)

Assim, o erro numérico do SVFM, como uma função do espaçamento da malha, pode
ser escrita como:

erro ?4xk. (4.69)

Ao tomar o logaritmo em ambos lados desta equação, ela pode ser escrita como:

log (erro) ? k log (4x) . (4.70)

Assim, tomando-se duas malhas 1 e 2, temos:

k ?
log
(
erro 1
erro 2

)
log
(
4x 1
4x 2

), (4.71)
ou, alternativamente, levando em conta o número de graus de liberdade, DOFs, tem-se:

k ?
log
(
erro 1
erro 2

)
log
(
DOFs 2
DOFs 1

). (4.72)
4.9 Algoritmo geral

As etapas do SFVM para dar solução à equações do modelo matemático que regem o
escoamento bifásico de água-óleo em reservatórios de petróleo podem ser resumidas como:

1. A partir de um domínio [a,b], a malha primal é construída pela subdivisão do
domínio físico em o número N de SV desejados.

2. Subdivisão dos SVs em CVs, segundo o ordem de acurácia k, utilizando a Eq. (4.10)
para fazer o mapeamento do DC ao DF.

3. Pré-computar os coeficientes de interpolação polinomial para o tipo malha a ser
usada. Utilizar a Eq. (4.32) ou Tab. 4.1.



4. Método espectral dos volumes finitos 68

4. Calcular o passo de tempo, de acordo com a condição CFL, o comprimento hi,j do
CV de menor tamanho e a função fluxo Eq. (2.42), da forma a seguir:

4t =
CFL

|dfadv/dSw|
4x +

hw
4x2

. (4.73)

5. Calcular a solução inicial Sw0, de acordo com as Eqs. (4.39) e (4.40).

6. Utilização da função FFN
(
S?w
)
para calcular os fluxos numéricos, como se apresenta

a seguir:

• Cálculo das variáveis reconstruídas nas interfaces numéricas para cada CV,
Eq. (4.14).

• Cálculo das variáveis reconstruídas limitadas, usando a função limitadora de incli-
nação (ver Subsec. 4.7).

• Cálculo do fluxo numérico utilizando os resolvedores de Riemann aproximados (ver
Subsec. 3.1.2) nas interfaces entre SVs, e fluxo analítico nas interfaces internas do
CV. Se for o caso de que a função limitadora tornou descontínua a variável re-
construída nos contornos dos CVs, o fluxo analítico deve ser substituído pelo fluxo
numérico também nas interfaces internas do CV.

7. Avanço no tempo n-loop via o método explícito de Runge-Kutta de ordem 3.

• Calculo da solução (etapa 1) usando a solução inicial (Sw0):

– Calculo dos fluxos numéricos usando a função FFN (Sw0).

– Calculo da solução (S?w1) via formula conservativa Eq. (4.7).

• Calculo da solução (etapa 2) usando a solução (S?w1)

– Calculo dos fluxos numéricos usando a função FFN
(
S?w1
)
.

– Calculo da solução (Sw2) via formula conservativa Eq. (4.7).

• Calculo da solução (etapa 3) usando a solução (S?w2)

– Calculo dos fluxos numéricos usando a função FFN
(
S?w2
)
.

– Calculo da solução (S?w3) via formula conservativa Eq. (4.7).

• Atualização de solução Sw0 = S?w3, para ser utilizada no próximo nível de tempo
t = n?4t.

• Fim do loop quando o tempo final de simulação é igual a t.

8. Calculo de erros (ver subsec. 4.8) e apresentação de resultados em forma gráfica.



69

Capítulo 5

Aplicações

5.1 Estudo da acurácia utilizando a equação da onda

linear

5.1.1 Propagação da onda senoidal

Neste exemplo vamos utilizar a equação linear (2.1), no domínio computacional [-1,1] com
condição inicial:

S(x, 0) = sin(?x), (5.1)

e condições de contorno periódicas nas extremidades do domínio. Para atingir a taxa de
convergência esperada a solução numérica para o SFVM deve ser inicializada utilizando a
média exata no CV , a qual é dada pela integral da Eq. (5.1), como se apresenta a seguir:

S?(x, 0) =
1

hi,j

? xi,j+1/2
xi,j?1/2

sin(?x)dx. (5.2)

O tratamento da solução analítica deve ser feito de forma similar. Por outro lado, um
esquema de integração temporal de ordem 3, tipo TVD Runge-Kutta, foi utilizado, com
um intervalo de tempo 4t = 10?4, com o objetivo de conseguir um erro de discretização
praticamente não dependente da discretização temporal (Breviglieri et al., 2010; Wang,
2002). Neste teste foi utilizado uma velocidade, a = 1 (van den Abeele et al., 2007b), e
o resolvedor de Riemann tipo Roe. Na Tabela 5.1, mostram-se as normas L1 e L? do
erro produzido com SFVM, utilizando CVs equidistantes para um tempo t = 1. Aqui, o
DOFs, ou seja, o número de SV por o número de CV é calculado da forma a seguir:

DOF = SV?CV. (5.3)

Como pode-se ver na Tabela 5.1 o SFVM de ordem 2 e 3 com pontos equidistantes se
comportam corretamente e atingem a ordem de acurácia esperada em malhas de baixa



5. Aplicações 70

Tabela 5.1: Avaliação da acurácia do esquema 1-D SFVM, para a equação da onda,
utilizando CV uniformes.

k ?x DOFs L? erro L? ordem L1 erro L1 ordem

2

1.00e-1 20 5.34e-2 - 3.29e-2 -
5.00e-2 40 1.41e-2 1,92 8.72e-3 1,92
2.50e-2 80 3.56e-3 1,99 2.24e-3 1,96
1.25e-2 160 8.94e-4 1,99 5.65e-4 1,99
6.25e-3 320 2.24e-4 2,00 1.42e-4 1,99
3.13e-3 640 5.59e-5 2,00 3.55e-5 2,00

3

6.67e-2 30 4.12e-3 - 2.40e-3 -
3.33e-2 60 5.31e-4 2,96 3.08e-4 2,96
1.67e-2 120 6.66e-5 3,00 3.90e-5 2,98
8.33e-3 240 8.34e-6 3,00 4.90e-6 2,99
4.16e-3 480 1.04e-6 3,00 6.14e-7 3,00
2.08e-3 960 1.30e-7 3,00 7.69e-8 3,00

4

1.00e-1 20 3.24e-3 - 1.64e-3 -
5.00e-2 40 1.91e-4 4,08 1.13e-4 3,85
2.50e-2 80 1.47e-5 3,70 7.04e-4 4,01
1.25e-2 160 8.44e-7 4,12 4.30e-7 4,03
6.25e-3 320 5.39e-8 3,97 2.71e-8 4,00
3.13e-3 640 3.79e-9 3,83 1.70e-9 3.99

5

1.00e-1 20 1.27e-3 - 4.42e-4 -
5.00e-2 40 7.55e-5 4,07 2.19e-5 4,33
2.50e-2 80 8.15e-6 3,21 3.98e-6 2,46
1.25e-2 160 1.06e-5 -0,20 4.58e-6 -0,38
6.25e-3 320 4.61e-4 -5,29 1.80e-4 -5,43



5. Aplicações 71

densidade. O desempenho do método para ordem k = 4 ainda é próximo do esperado,
porém, a taxa ou ordem tem comportamento oscilatório (quedas e ascensões), ou seja,
não se comporta exatamente como “esperado”, conforme podemos observar. A ordem 5
de acurácia pode nunca ser atingida porque, quando a malha é refinada, se apresenta
um aumento na norma L? e na norma L1 e consequentemente é obtido uma taxa de
convergência negativa. Isto pode acontecer devido a que a interpolação lagrangiana é
muito oscilatória, quando o grau do polinômio interpolador atinge p = 3 ou mais (Wang,
2002). Resumindo, acontece que quando a malha é de baixa densidade, o método é
capaz de atingir o ordem de acurácia desejada, porém quando a malha é refinada, se
apresenta um aumento das normas L1 e L?. Isto acontece devido a algumas oscilações
locais desenvolvidas com a distribuição dos CV equidistantes (Wang, 2002), ver Sec. 4.3.

A fim de observarmos o comportamento oscilatório local do polinômio interpolador
danificando a solução numérica, na Fig. 5.1 apresentamos a solução obtida com o SFVM
de ordem k = 5, comparado com a solução analítica. Levando em consideração que as
oscilações locais apresentadas na Fig. 5.1 são produzidas somente pela discretização espa-
cial, no teste seguinte são utilizados os pontos de Gauss-Lobatto (Eq. 4.9) para subdividir
os SVs. Os outros parâmetros permanecem iguais. Na Tabela 5.2 são apresentadas as
normas dos erros L1 e L?, para um tempo final t = 1.

?0.55 ?0.5 ?0.45
0.99

0.995

1

1.005

t = 1.0e+00 / 1600 iter / k =  5 / 320 NDOF / mu 1.0e?06 
 CFL = 1.0e?01 / 64 SVs                                  

X

S

 

 
S. Numérica
S. Analitica

Figura 5.1: Detalhe da solução exata e numérica obtida utilizando o método SFVM de
ordem 5 para 64 SVs com CVs uniformes.

Neste exemplo, fica claro que o comportamento do SFVM para ordens de acurácia
k = 3, 4, 5, 6, utilizando a distribuição de Gauss-Lobatto para gerar as partições dos SVs,
apresentou uma melhoria expressiva na acurácia e na convergência com respeito ao teste
para o SFVM utilizando CVs equidistantes (ver Fig. 5.2).

Com o objetivo de verificar a acurácia espectral do SFVM, um refinamento tipo p,
como o utilizado no contexto do FEM, é realizada. Neste estudo o número de SVs, é



5. Aplicações 72

Tabela 5.2: Avaliação da acurácia do 1-D SFVM, para a equação da onda, utilizando CV
não uniformes gerados pelos pontos de quadratura de Gauss-Lobatto.

k ?x DOFs L? erro L? ordem L1 erro L1 ordem

3

6.67e-2 30 2.58e-3 - 1.07e-3 -
3.33e-2 60 3.45e-4 2,90 1.36e-4 2,97
1.67e-2 120 4.46e-5 2,95 1.73e-5 2,97
8.33e-3 240 5.67e-6 2,98 2.18e-6 2,99
1.25e-2 480 7.14e-7 2,99 2.74e-7 2,99

4

1.00e-1 20 2.23e-3 - 6.77e-4 -
5.00e-2 40 1.53e-4 3,86 4.61e-5 3,88
2.50e-2 80 9.52e-6 4,00 2.95e-6 3,97
1.25e-2 160 6.00e-7 3,99 1.86e-7 3,99
6.25e-3 320 3.75e-8 4,00 1.17e-8 3,99
3.13e-3 640 7.3e-10 4,00 2.35e-9 4,00

5

1.00e-1 20 5.50e-4 - 1.57e-4 -
5.00e-2 40 1.95e-5 4,82 5.11e-6 4,94
2.50e-2 80 6.24e-7 4,96 1.67e-7 4,94
1.25e-2 160 2.02e-8 4,95 5.35e-9 4,96
6.25e-3 320 6.2e-10 5,02 1.7e-10 4,96

6

6.67e-2 30 1.31e-5 - 2.96e-6 -
3.33e-2 60 4.61e-8 6,20 1.78e-7 6,00
1.67e-2 120 7.4e-10 5,94 2.89e-9 5,97
8.33e-3 240 4.2e-11 6,12 1.2e-11 5,90

?3 ?2.5 ?2 ?1.5 ?1
?11

?10

?9

?8

?7

?6

?5

?4

?3

?2

?1

Log10(? x)

L
o

g
1

0
(L

1
 E

rr
o

r)

Refinamento h

 

 
k=2
k=3
k=4
k=5
k=6

Figura 5.2: Taxa de convergência demostrando a acurácia espectral para o refinamento h
para a equação de onda linear.



5. Aplicações 73

mantido fixo, enquanto o grau do polinômio interpolador é aumentado no interior do
SV. Como é apresentado na Fig. 5.3, observe que o logaritmo do erro L1 decresce quase
linearmente com respeito à ordem de acurácia.

2 3 4 5 6 7 8 9
?12

?10

?8

?6

?4

?2

0

Ordem de Acurácia

L
o

g
1

0
(L

?
 e

rr
o

r)

Refinamento p

 

 
2 SVs
4 SVs
6 SVs
8 SVs

Figura 5.3: Taxa de convergência demostrando a acurácia espectral com o refinamento p,
para a equação de onda linear.

5.1.2 Propagação do pulso Gaussiano

A seguir é feita a simulação para um pulso Gaussiano com largura média de 0.05 e condição
inicial dada por:

S (x, 0) = exp

[
?
(
x? 0.5

0.05

)2]
, (5.4)

com condições de contorno periódicas. Esta simulação foi feita com o SFVM de ordem
k = 1, 2, 3 e 4 com CFL= 0,5; 0,3; 0,18 e 0,12 respectivamente, como é sugerido por Zhang
and Shu (2005), na procura do o limite de estabilidade ótimo para as diferentes ordens. O
tempo de simulação é de t=1,0; foram utilizados 60 SVs e velocidade a = 1. As partições
dos SVs foram feitas utilizando uma distribuição de pontos otimizada, como é apresentado
na Tab. 4.3. Os resultados são apresentados na Fig. 5.4. Pode-se observar que o esquema
de ordem 1 e 2 fornecem uma solução com excesso de difusão numérica. A simulação
de segunda ordem mantêm a forma da condição inicial, porém mostra difusividade e
comportamento oscilatório, o qual esta relacionado com as propriedades de dispersão e
difusão do método. Para mais detalhes, ver van den Abeele et al. (2007a) e van den
Abeele (2009). As simulações de terceira e quarta ordem produzem boas soluções, ou
seja, a solução numérica aproxima-se da solução semi-analítica e não surgem oscilações



5. Aplicações 74

0 0.2 0.4 0.6 0.8 1
?0.2

0

0.2

0.4

0.6

0.8

1

1.2

t = 1.0e+00 / 60 SVs / CFL = 5.0e?01 
 

X

S

 

 
k=1
k=2
k=3
k=4
S. Analítica

Figura 5.4: Simulação do pulso Gaussiano utilizando SFVM de ordem k = 1,2,3 e 4 no
tempo t=1.0, sem função limitadora.

espúrias, como se apresenta na Fig. 5.4.

5.1.3 Propagação da onda quadrada

No teste subsequente é utilizada uma onda quadrada que se propaga no domínio [0,1],

S(x, 0) =

??
? 1,0,

1
4
? x ? 3

4
,

caso contrário,
(5.5)

com velocidade constante a = 1 e condições de contorno periódicas. Neste teste foi
utilizado o SFVM de ordem de acurácia k = 2, com 40 volumes espectrais e volumes de
controle gerados pelos pontos de quadratura de Gauss-Lobatto para fazer as partições do
SV, além do resolvedor de Riemann de Roe. As simulações foram feitas com e sem função
limitadora, para um tempo final t = 1, utilizando o esquema de Runge Kutta de ordem 3,
para a discretização temporal com um intervalo de tempo 4t = 10?4. Na Fig. 5.5a pode-se
observar as oscilações perto das descontinuidades ou gradientes acentuados denominadas
fenômeno de “Gibbs”, as quais se apresentam em formulações numéricas de ordem de
acurácia maior que um (k &gt; 1), como neste caso (Godunov, 1959).

Para resolver o problema das oscilações na solução numérica, é introduzido um termo
não linear na formulação, através de uma função limitadora tipo SVTVDM (ver Sec. 4.7).
Na figura 5.5b mostra-se a solução utilizando a função limitadora que atua controlando
o gradiente da variável reconstruída nos contornos dos SVs. Desta forma, esta função
diminui ou suprime as oscilações espúrias na solução perto dos gradientes acentuados.



5. Aplicações 75

0 0.2 0.4 0.6 0.8 1
?0.2

0

0.2

0.4

0.6

0.8

1

1.2

t = 1.000e+00 / 667 iter / k =  2 / 80 NDOF/ CFL = 1.200e?01 
 Pontos g?l

X

S

 

 

SFVM
S. Analítica

(a)

0 0.2 0.4 0.6 0.8 1
?0.2

0

0.2

0.4

0.6

0.8

1

1.2

t = 1.000e+00 / 667 iter / k =  2 / 80 NDOF/ CFL = 1.200e?01 
 Pontos g?l

X

S

 

 

SFVM
S. Analítica

(b)

Figura 5.5: Simulação de uma onda quadrada feita com o método SFVM para um tempo
final t = 1: (a) sem função limitadora. (b) Utilizando o limitador SVTVDM.

5.2 Teste para equação não linear de Burgers

Neste teste é estudado a equação não linear de Burgers (2.5), no domínio [-1,1], com
condições de contorno periódicas e condição inicial:



5. Aplicações 76

S(x, 0) = 1 +
1

2
sin(?x). (5.6)

Para este teste foi utilizado o resolvedor de Riemman de Roe, volumes de controle gerados
utilizando a distribuição de Gauss-Lobatto, velocidade constante a = 1, e um esquema de
discretização temporal tipo Runge Kutta de ordem 3, com passo de tempo 4t = 10?4. A
solução exata é suave até um tempo t = 2/?. A partir deste instante de tempo, tem-se
então a formação de uma onda de choque. O primeiro teste é feito no tempo t = 0.3, onde
a solução apresenta comportamento suave. Aqui o SFVM é analisado para diferentes
ordens de acurácia e os resultados para as normas do erro L1 e L? são mostrados na
Tabela 5.3, junto com a ordem de acurácia numérica. Em geral observa-se que a ordem
de acurácia esperada é atingida.

Com o objetivo de verificar a acurácia espectral e o desempenho computacional, outro
teste é apresentado na Fig. 5.6, na qual a solução numérica do método SFVM de ordem 2
com 12 DOFs é graficada junto com a solução numérica para ordem 4 com igual número
de graus de liberdade ou igual número de incógnitas por solucionar. Neste problema, não
é utilizada a função limitadora, isto é devido a que para o tempo final t = 0.3 a solução é
ainda suave e não apresenta ondas de choque. Observa-se neste teste que a solução para
ordem k = 4 apresenta melhor comportamento, aproximando-se da solução semi-analítica.

?1 ?0.5 0 0.5 1
0.4

0.6

0.8

1

1.2

1.4

1.6

t = 2.957e?01 / 22 iter / order  4 / 12 NDOF / CFL = 1.200e?01 
  3 SVs                                                        

X

S

 

 

k=2
k=4
S. Analitica

Figura 5.6: Soluções numéricas para a equação do Burgers no tempo t=0.3 através do
SFVM do ordem 2, com 12 DOFs, graficada junto com a solução numérica para ordem 4
com 12 graus de liberdade.

No teste subsequente para o tempo t = 2/?, a solução inicia a formação do choque de-
vido ao cruzamento das linhas características. Então, a solução numérica pode apresentar
oscilações sem a utilização da função limitadora (ver Fig. 5.7a).



5. Aplicações 77

Tabela 5.3: Estudo da acurácia na solução da Equação de Burgers com condição inicial
senoidal no tempo t = 0.3 e volumes de controle não uniformes, gerados pelos pontos de
quadratura de Gauss-Lobatto.

k ?x DOFs L?erro L?ordem L1 erro L1 ordem

2

1.00e-1 20 2.73e-2 - 1.19e-2 -
5.00e-2 40 9.94e-3 1,46 3.05e-3 1,96
2.50e-2 80 3.16e-3 1,67 7.85e-4 1,96
1.25e-2 160 8.12e-4 1,95 1.91e-4 2,04
6.25e-3 320 2.11e-4 1,94 4.87e-5 1,97
3.13e-3 640 5.25e-5 2,00 1.25e-5 1,96

3

6.67e-2 30 1.14e-2 - 1.46e-3 -
3.33e-2 60 2.14e-3 2,41 1.95e-4 2,90
1.67e-2 120 3.86e-4 2,47 2.75e-5 2,83
8.33e-3 240 5.82e-5 2,73 3.61e-6 2,93
1.25e-2 480 7.71e-6 2,92 4.82e-7 2,91
2.08e-3 960 9.95e-7 2,95 6.20e-8 2,96

4

1.00e-1 20 1.63e-2 - 2.89e-3 -
5.00e-2 40 7.84e-4 4,38 1.05e-4 4,78
2.50e-2 80 2.56e-4 1,62 1.25e-5 3,07
1.25e-2 160 1.62e-5 3,98 7.19e-7 4,12
6.25e-3 320 1.11e-6 3,87 4.35e-8 4,04
3.13e-3 640 7.05e-8 3,98 2.70e-9 4,01

5

0.2 20 1.43e-2 - 2.10e-3 -
0.1 40 8.14e-4 4,14 6.40e-5 5,04
0.05 80 9.16e-5 3,15 3.50e-6 4,19
2.5e-2 160 4.52e-6 4,34 9.51e-8 5,20
1.25e-2 320 1.81e-7 4,64 3.81e-9 4,64
6.25e-3 640 6.75e-9 4,75 1.3e-10 4,87

6

6.67e-2 30 2.93e-3 - 2.79e-4 -
3.33e-2 60 5.94e-5 5,62 3.65e-6 6,26
1.67e-2 120 5.46e-6 3,44 1.45e-7 4,65
8.33e-3 240 8.72e-8 5,97 1.71e-9 6,41
1.25e-2 480 1.51e-9 5.85 2.6e-11 6,04



5. Aplicações 78

?1 ?0.5 0 0.5 1
0.4

0.6

0.8

1

1.2

1.4

1.6

t = 6.361e?01 / 318 iter / order  4 / 80 NDOF / CFL = 1.200e?01 
 20 SVs

X

S

 

 
SFVM
S. Analitica

(a)

?1 ?0.5 0 0.5 1
0.4

0.6

0.8

1

1.2

1.4

1.6

t = 6.378e?01 / 318 iter / order  4 / 80 NDOF / CFL = 1.200e?01 
 20 SVs                                                         

X

S

 

 
SVTVBM
CVTVBM
S. Analitica

(b)

Figura 5.7: Soluções numéricas para a equação de Burgers no tempo t = 2/? , utilizando o
SFVM de ordem k = 4, com 80 DOFs, sem função limitadora (a) e com função limitadora
tipo SVTVBM e CVTVBM (b).

Na Fig. 5.7b é apresentada a solução fazendo uso do limitador CVTVBM, que atua
diminuindo as oscilações espúrias, que se apresentam perto de gradientes acentuados.
O limitador tipo CVTVBM é escolhido neste teste devido ao fato de que apresenta os
melhores resultados na captura do choque, tanto no início do mesmo, t = 2/?, como ao
final do tempo de simulação, t = 1, quando a onda de choque já esta formada (Wang,



5. Aplicações 79

2002). O comportamento da solução sob a ação da função limitadora tipo CVTVBM,
a qual é utilizada, para lidar com oscilações nas descontinuidades no tempo t = 1 é
apresentada na Fig. 5.8.

?1 ?0.5 0 0.5 1
0.4

0.6

0.8

1

1.2

1.4

1.6

t = 9.754e?01 / 1000 iter / order  4 / 160 NDOF / CFL = 1.200e?01 
 40 SVs

X

S

 

 
SFVM
S. Analitica

(a)

?1 ?0.5 0 0.5 1
0.4

0.6

0.8

1

1.2

1.4

1.6

t = 1.001e+00 / 1000 iter / order  4 / 160 NDOF / CFL = 1.200e?01 
 40 SVs                                                           

X

S

 

 
SVTVBM
CVTVBM
S. Analitica

(b)

Figura 5.8: Soluções numéricas para a equação de Burgers no tempo t = 1 , utilizando o
SFVM de ordem k = 4, com 160 DOFs, sem função limitadora (a) e com função limitadora
do tipo SVTVBM e CVTVBM (b).



5. Aplicações 80

5.3 Modelo do fluxo bifásico

5.3.1 Problema de Buckley-Leverett

Este problema, consiste basicamente no deslocamento imiscível unidimensional de óleo
por água ao longo de um meio poroso homogêneo em que, no modelo matemático da
Eq. (2.41), desprezamos os efeitos gravitacionais, de capilaridade e termo de fonte. As
saturações residuais de água e óleo são Srw = Sro = 0.1 e a razão entre as viscosidades
das fases é µo/µw = 1 .

Nos exemplos a seguir, apenas a equação de saturação foi resolvida com as seguintes
condições iniciais e de contorno:

Sw (x, 0) = Swr = 0.1 para 0 &amp;lt;x ? 1,

Sw (0, t) = 1.0 ?Sor para x = 0. (5.7)

Comparação do método numérico MUSCL-TVD e SFVM

Para este exemplo utilizamos os métodos MUSCL-TVD e SFVM para segunda ordem de
acurácia e com igual DOFs. Nas Figs. 5.9 e 5.10, apresentamos as soluções obtidas em
t=0.2, para quatro malhas unidimensionais diferentes, com 16, 32, 64 e 128 divisões da
malha primal. Seguindo Pinto (1991), os intervalos de tempo escolhidos para cada malha
foram tais que CFL = v4t4x = 0.1 onde v = |~vt| = 1. Além disso, uma função limitadora
tipo CVTVBM foi utilizada para lidar com as oscilações perto das descontinuidades.
Como podemos observar nas Figs. 5.9 e 5.10, mesmo para a malha menos densa, com
16 subdivisões ao longo do domínio, nenhum dos métodos apresenta oscilações espúrias.
Além disso, os métodos convergem adequadamente para a solução analítica à medida que
refinamos as malhas.

Como um primeiro passo para avaliar o desempenho computacional é calculado o
número de operações de ponto flutuante (flops) para o SFVM e para o MUSCL-TVD.
A premissa para realizar este teste é que a principal diferença entre o SFVM e MUSCL-
TVD esta no processo de reconstrução das variáveis nas interfaces numéricas. Por isso só
será avaliada a primeira etapa do algoritmo para os dois métodos, desconsiderando então,
etapas como a aplicação de funções limitadoras, cálculo de fluxos numéricos, etc. Para
fazer o cálculo dos flops, inicialmente consideramos uma malha primal com igual número
de células para ambos os métodos. Agora o processo de reconstrução para o MUSCL-TVD
é analisado.

Levando em consideração que é atribuido “1-flop” para cada operação básica, como por
exemplo, adição (+), subtração (-), multiplicação (*). O número de flops para as faces
são calculados utilizando a Eq. (3.20), com a inclinação ?i = S?w(i) ? S?w(i?1), da forma a
seguir:



5. Aplicações 81

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01  / 17 iter /  CFL = 1.000e?01 
 16 células

x

S
w

 

 
SFVM
MUSCL?TVD
Semi?Analítica

(a)

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01  / 33 iter /  CFL = 1.000e?01 
 32 células

x

S
w

 

 
SFVM
MUSCL?TVD
Semi?Analítica

(b)

Figura 5.9: Comparação entre os perfis de saturação de água para o problema unidimen-
sional de Buckley-Leverett numa malha primal com 16 subdivisões (a) e numa malha
de 32 subdivisões (b) ao longo do eixo x em t=0.2. Solução semi-analítica e soluções
aproximadas obtidas com o SFVM e MUSCL-TVD.



5. Aplicações 82

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01  / 65 iter /  CFL = 1.000e?01 
 64 células

x

S
w

 

 
SFVM
MUSCL?TVD
Semi?Analítica

(a)

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01  / 129 iter /  CFL = 1.000e?01 
 128 células

x

S
w

 

 
SFVM
MUSCL?TVD
Semi?Analítica

(b)

Figura 5.10: Comparação entre os perfis de saturação de água para o problema unidi-
mensional de Buckley-Leverett numa malha primal com 64 subdivisões (a) e numa malha
de 128 subdivisões (b) ao longo do eixo x em t=0.2. Solução semi-analítica e soluções
aproximadas obtidas com o SFVM e MUSCL-TVD.



5. Aplicações 83

Sw(i)L = S?w(i) ? 0.5 ?
(
S?w(i) ? S?w(i?1)

)
Sw(i)R = S?w(i) + 0.5 ?

(
S?w(i) ? S?w(i?1)

)
(5.8)

Como podemos observar na Eq. (5.8), cada variável reconstruida só faz uso de 3-flops. Isto
é “-,*,-”, para Sw(i)L, e “+,*,-” para Sw(i)R, como indicado na Fig. 5.11a. Agora a análise
para o SFVM é feito utilizando a equação Eq. (4.14), da forma a seguir

Sw(i,1/2) = c01 ? S?w(i,1) + c02 ? S?w(i,2), (5.9)

Sw(i,3/2) = c11 ? S?w(i,1) + c12 ? S?w(i,2), (5.10)

Sw(i,5/2) = c21 ? S?w(i,1) + c22 ? S?w(i,2), (5.11)

onde os coeficientes cjl são tomados da Tab. 4.1 ou 4.2, para k=2. Como podemos observar
nas Eqs. (5.9), (5.10) e (5.11). O número de flops para cada face numérica é 3, incluindo
dois multiplicações e uma adição “*,+,*”. Devido que cada resolvedor utiliza o mesmo
DOFs, o SFVM precisa de duas células da malha primal para fazer a reconstrução, como
indicado na Fig. 5.11b, então o número total de flops para obter a segunda ordem de
acurácia é de 9-Flops por célula espectral SV. Por outro lado o MUSCL-TVD precisa
fazer uma nova reconstrução, por exemplo, na célula (i+1), utilizando mais uma vez 3-
flops por face, ou seja, 6-flops por célula da malha primal. Em conclusão o SFVM utiliza
o equivalente a um 25% menos de flops que o MUSCL-TVD no processo de reconstrução.

Figura 5.11: Operações de ponto flutuante para o SFVM e MUSCL-TVD.



5. Aplicações 84

Como segunda opção para avaliar o custo computacional é feito um teste sugerido
por Liang et al. (2013). Neste teste é mantido o número de DOFs, e todos os outros
parâmetros permanecem iguais para os dois métodos. Foram efetuadas 5 simulações para
cada malha computacional, com o objetivo de ter uma melhor estimativa do tempo. O
teste foi realizado num laptop ACER, com um processador Intel® Atom™ CPU N270 @
1.60GHz × 2, com 2 Gb de memória RAM, Como é observado na Tab. 5.4, praticamente
em todos os casos o SFVM gastou menor tempo de maquina, em comparação com o
MUSCL-TVD. Também podemos observar no caso para 128 DOFs que a tendência de
aumentar a diferença entre os dois métodos é percebida quando a malha é mais densa.
Por outro lado e fazendo um analise visual das Figs. 5.9 e 5.10, as quais apresentam uma
resolução similar para os dois métodos. Podemos concluir que o SFVM comporta-se com
melhor eficiência computacional que o MUSCL-TVD. O ganho na eficiêcia computacional
será mais relevante no caso de modelos multidimensionais.

Tabela 5.4: Tempo da CPU em segundos utilizado pelos resolvedores SFVM e MUSCL-
TVD, para a simulação do problema de Buckley-Leverett.

DOFs Simulação Iterações RK-3 SFVM MUSCL-TVD

16

No.1

240

2,0270 2,0685
No.2 1,9247 1,9181
No.3 1,9266 1,9281
No.4 1,8835 1,9017
No.5 2,0316 1,9614

32

No.1

480

6,5462 7,2605
No.2 5,6553 6,2673
No.3 5,7379 6,1089
No.4 5,9469 6,0766
No.5 5,9047 7,4681

64

No.1

960

17,6170 20,5005
No.2 18,1249 19,0619
No.3 17,2354 18,6759
No.4 17,5940 18,8335
No.5 17,5810 20,0829

128

No.1

1920

59,5418 76,0072
No.2 59,2562 70,0573
No.3 58,4880 69,2475
No.4 61,9353 63,4321
No.5 58,6911 64,1760

Solução do problema de Buckley-Leverett utilizando refinamento tipo p.

Neste teste o problema de Buckley-Leverett é resolvido utilizando o refinamento tipo p,
para verificar “visualmente” a acurácia espectral e a alta resolução do SFVM. Os intervalos



5. Aplicações 85

de tempo escolhidos para a malha primal com 8 SVs, foram tais que CFL = v4t4x = 0.01
onde v = |~vt| = 1 e 4x = hi,j. Sendo hi,j, o menor comprimento do CV, dentre os k
possíveis CVs no interior do SV, para satisfazer o critério de estabilidade. Além disso,
uma função limitadora tipo CVTVBM foi utilizada para lidar com as oscilações perto
das descontinuidades. Observamos na Fig. 5.12a que, apesar da malha primal ser pouco
densa, o SFVM resolveu o problema, porém ainda com baixa acurácia.

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 80 iter / k =  2 / 16 NDOF / CFL = 1.000e?01 
  8 SVs

X

S
w

 

 
SFVM
Semi?Analitica

(a) k = 2

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 160 iter / k =  4 / 32 NDOF / CFL = 1.000e?01 
  8 SVs

X

S
w

 

 
SFVM
Semi?Analitica

(b) k = 4

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 320 iter / k =  8 / 64 NDOF / CFL = 1.000e?01 
  8 SVs

X

S
w

 

 
SFVM
Semi?Analitica

(c) k = 8

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 640 iter / k = 16 / 128 NDOF / CFL = 1.000e?01 
  8 SVs

X

S
w

 

 
SFVM
Semi?Analitica

(d) k = 16

Figura 5.12: Solução do problema de Buckley-Leverett, utilizando o SFVM de diferentes
ordens de acurácia k = 2, 4, 8 e 16.

A seguir é utilizado o mesmo número de SVs, porém aumentamos o grau do polinômio
de reconstrução, ou seja aumentamos a ordem de acurácia do SFVM, para k = 4, 8,
e 16, como mostram as Figs. 5.12b, c e d. Observamos uma melhoria significativa no
comportamento da solução numérica, isto é, a solução numérica apresenta maior acurácia
nas regiões suaves de escoamento atrás do choque e sem presença de oscilações espúrias
na descontinuidade, convergindo adequadamente para a solução semi-analítica à medida
que aumentamos o grau da reconstrução polinomial.



5. Aplicações 86

5.3.2 Efeitos gravitacionais

Neste teste, resolveremos o problema dado na Eq. (2.41), no domínio [0,1], desconside-
rando o efeito de pressão capilar e o termo fonte. A velocidade total é conhecida e
constante, vt = 1. As saturações residuais de água e óleo são Swr = Sor = 0. Considera-
se a razão de mobilidade µo/µw = 5; a porosidade ? = 1; densidade da água ?w = 1;
densidade do óleo ?o = 0.78; aceleração gravitacional g = 9.8 e as condições iniciais e de
contorno a seguir:

Sw (x, 0) = Swr = 0, 0 &amp;lt;x ? 1,

Sw (0, t) = 1 ?Sor, x = 0. (5.12)

Nesta simulação, 40 células espectrais foram utilizadas para o SFVM em comparação
com 80 células para o método TB(TVD)-FV de segunda ordem de acurácia no caso
bidimensional (Durlofsky, 1993), cujos resultados foram capturados das figuras do referido
artigo. Neste teste, o fluxo advectivo inclui efeitos gravitacionais que atuam no sentido
oposto à velocidade vt, isto é, no sentido negativo de x.

Observe na Fig. 5.13, que a curva para a função fluxo tem um “ponto sônico” em
Sw = 0.19.

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
?0.5

0

0.5

1

Sw

fa
d

v

Função fluxo fracional com efeito gravitacional

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
?1

0

1

2

3

Sw

d
fa

d
v/

d
S

w

Velocidade característica

Figura 5.13: Função fluxo fracional com efeitos gravitacionais (acima), velocidade carac-
terística (abaixo) e ponto de choque (símbolo ponto quadrado).

Os perfis de saturação para t = 0.25 e t = 0.5 são apresentados na Fig. 5.14. Em
nenhum momento durante o deslocamento apresentam-se oscilações não físicas, mesmo



5. Aplicações 87

na vizinhança do ponto sônico. A gravidade tende a forçar o líquido (água) para a parte
de baixo do reservatório, devido à diferença de densidades entre as fases.

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
t = 2.500e?01 / 915 iter / k = 2 / 160 NDOFs / CFL = 1.000e?01

X

S
w

 

 
FV?(Durlofsky, 1993)
SFVM
Semi?Analítica

(a)

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
t = 4.999e?01 / 1830 iter / k = 2 / 160 NDOFs / CFL = 1.000e?01

X

S
w

 

 
FV?(Durlofsky,1993)
SFVM
Semi?Analítica

(b)

Figura 5.14: Solução do modelo bifásico com efeitos gravitacionais pelo SFVM para um
tempo t = 0.25 (a) e t = 0.5 (b) vs a solução obtida através do método TB(TVD)-FV de
ordem 2 (Durlofsky, 1993).

Assim, o perfil de saturação avança mais devagar e apresenta uma frente mais acentu-



5. Aplicações 88

ada em comparação com a frente do problema de Buckley-Leverett sem efeitos gravitacio-
nais (ver Fig. 5.15). A localização do ponto de choque é 0.76, de acordo com os resultados
numéricos apresentados por Durlofsky (1993) e da solução semi-analítica.

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
t = 2.499e?01 / 981 iter / k = 2 / 160 NDOFs / CFL = 1.000e?01

X

S
w

 

 
FV?(Durlofsky, 1993)
SFVM
Semi?Analítica

(a)

0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1
t = 5.001e?01 / 1963 iter / k = 2 / 160 NDOFs / CFL = 1.000e?01

X

S
w

 

 
FV?(Durlofsky, 1993)
SFVM
Semi?Analítica

(b)

Figura 5.15: Solução do modelo bifásico sem efeitos gravitacionais (Buckley-Leverett),
utilizando SFVM de segunda ordem de acurácia, para t = 0.25 (a) e t = 0.5 (b) vs a
solução obtida através do método TB(TVD)-FV de ordem 2.



5. Aplicações 89

5.3.3 Efeitos da pressão capilar

Neste teste é resolvido o problema da injeção de água num meio poroso saturado pelo óleo
incluindo efeitos de pressão capilar. A lei de conservação, Eq. (2.41), então é resolvida no
domínio [0,1], desconsiderando os efeitos gravitacionais e o termo fonte. O fluxo fadv é,
em geral, uma função não linear de Sw(x). A razão entre as viscosidades, é µo/µw = 1,
e as permeabilidades relativas da fase água e óleo são equivalentes às do problema de
Buckley-Leverett da Sec. 5.3.1.

A condição inicial neste teste é da forma a seguir:

Sw (x, 0) =

??
? (1 ?Sor) ? ?Swr + ?

x &amp;lt;0,

x ? 0,
(5.13)

onde ? ? 1 é um número pequeno, por exemplo 10^-4, para evitar singularidades para
certos funcionais de pressão capilar com Sw = 0 ou Sw = 1. As condições de contorno são
Sw(0, t) = (1 ?Sor) ? ? e Sw(1, t) = Swr + ? (Cueto-Felgueroso, 2009). O parâmetro ?,
na Eq. (2.25), é tomado como 3. E diferentes valores são testados, para o parâmetro ? na
Eq. (2.37), que atua como um controle da força capilar. O passo temporal foi calculado
a partir de CFL = 0.05. Na Fig. 5.16, são apresentados os resultados para um tempo
final t = 2. A pressão capilar é definida como a diferença entre a pressão da fase óleo
e a pressão da fase água. Levando em consideração que o gradiente de pressão capilar é
positivo e, portanto, este aumenta o valor da frente de penetração da solução do modelo
do fluxo bifásico, como se apresenta na Fig. 5.16.

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9
Perfis de saturação da fase água com efeitos da pressão capilar 

X

S
w

 

 
? = 0.1
? = 0.05
? = 0.01

Figura 5.16: Efeito da pressão capilar no perfil de saturação para diferentes valores de ?.



5. Aplicações 90

No teste subsequente avaliaremos o tempo computacional utilizando para solucionar o
problema de Buckley-Leverett com efeitos de pressão capilar. Os parâmetros considerados
neste exemplo são os mesmos do teste anterior, além de ? = 0.01, porém com igual número
de DOFs para diferentes ordens de acurácia k = 1, 2, 3 e 5, e o CFL = 0.1, para garantir o
limite de estabilidade para todos os testes. Para gerar a solução de referência foi utilizado
o FVM de primeira ordem, com 5000 células. O teste foi feito num laptop ACER, com
um processador Intel® Atom™ CPU N270 @ 1.60GHz × 2, com 2 Gb de memória RAM.
O tempo médio para os cálculos da solução numérica pelo SFVM foi de 29.5 segundos.
Neste caso fica claro que é muito melhor utilizar o SFVM de alta ordem, com por exemplo
k = 5, que os resolvedores de ordem mais baixa, já que a resolução é muito melhor como
se apresenta na Fig. 5.17.

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 150 iter / k =  1 / 30 NDOF / CFL = 1.000e?01 
 30 SVs / t = 2.8e+01 seg                                     

X

S
w

 

 
SFVM
Referencia

(a) k = 1

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 150 iter / k =  2 / 30 NDOF / CFL = 1.000e?01 
 15 SVs / t = 3.0e+01 seg                                     

X

S
w

 

 
SFVM
Referencia

(b) k = 2

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 150 iter / k =  3 / 30 NDOF / CFL = 1.000e?01 
 10 SVs / t = 3.0e+01 seg                                     

X

S
w

 

 
SFVM
Referencia

(c) k = 3

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.000e?01 / 150 iter / k =  5 / 30 NDOF / CFL = 1.000e?01 
  6 SVs / t = 3.0e+01 seg                                     

X

S
w

 

 
SFVM
Referencia

(d) k = 5

Figura 5.17: Modelo do fluxo bifásico com efeitos da pressão capilar, utilizando o SFVM
de diferentes ordens de acurácia e deixando fixo o número de CV, ou seja, igual número
de incógnitas ou DOFs são resolvidas.



5. Aplicações 91

5.3.4 Efeitos gravitacionais e da pressão capilar

Finalmente, neste teste, a Eq. (2.41) é resolvida levando em consideração os efeitos de
pressão capilar e de gravidade, sem considerar termo de fonte. As saturações residuais de
água e óleo são Srw = Sro = 0.1, e a razão entre as viscosidades das fases é µo/µw = 1.
A porosidade é ? = 1, a densidade da água é ?w = 1, a densidade do óleo é ?o = 0.78,
a aceleração gravitacional é g = 9.8, e termo fonte é Qw = 0. As condições iniciais e de
contorno dadas na Sec. 5.3.3 são também utilizadas aqui, além de considerar o parâmetro
para o controle da força capilar como ? = 0.01.

Na Fig. 5.18, é apresentada a comparação entre os perfis da frente de saturação in-
cluindo e sem incluir os efeitos de pressão capilar e gravidade. Nesta figura, observa-se que
os efeitos da pressão capilar são muito pequenos ou insignificantes, quando comparados
com os efeitos gravitacionais. Neste caso os termos que consideram velocidade e gravidade
Eq. (2.42) são mais relevantes.

0 0.2 0.4 0.6 0.8 1
0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

t = 2.001e?01 / 746 iter / k = 2 / 64 NDOFs / CFL = 5.000e?2 / 32 células 
 

X

S
w

 

 
Sem pressão capilar e gravidade
Com pressão capilar e gravidade

Figura 5.18: Modelo do fluxo bifásico com efeitos gravitacionais e de pressão capilar para
um tempo t =2.



92

Capítulo 6

Conclusões e trabalhos futuros

O método espectral dos volumes finitos de alta ordem foi implementado com sucesso e
verificado para a solução do modelo de fluxo bifásico de água e óleo em meios porosos.

As principais conclusões são listadas a seguir:

• A alta resolução do SFVM foi verificada através de testes numéricos para problemas
lineares e não lineares utilizando soluções suaves, confirmando as taxas de conver-
gência esperadas do método.

• O comportamento do método para resoluções de segunda ordem mostrou bom de-
sempenho quando foi comparado com dados numéricos e semi-analíticos, além disso
os resultados obtidos indicam que o referido método consegue dar soluções com si-
milar resolução e razoável custo computacional quando comparado com os métodos
tradicionais de alta ordem k ? 2.

• Por outro lado, devido a o SFVM fornecer resolução ao nível das sub-células, o SFVM
captura com excelente resolução as descontinuidades. Esta vantagem é visualizada
no desempenho dos limitadores SVTVDM e CVTVBM.

• A função limitadora CVTVBM foi melhorada, utilizando um discriminador para
distinguir entre extremo suave e extremo descontínuo nas interfaces internas dos
CVs, no interior do SV, a fim de evitar utilizar um resolvedor de Riemann quando
é desnecessário.

O SFVM é viável para simulação de reservatórios de petróleo, no sentido de ser com-
pacto da perspectiva da implementação. Isto é, o SV analisado só interage com os vizinhos
imediatos o que é importante para trabalhar com meios heterogêneos e anisotrópicos, ma-
lhas não estruturadas e computação paralela. O SFVM é extensível para alta ordem de
acurácia e computacionalmente eficiente.

Para trabalhos futuros é de interesse estender nosso trabalho para lidar com métodos
espectrais, tais como;



6. Conclusões e trabalhos futuros 93

• SFVM e SFDM, para o estudo do problema de fluxos multifásicos em meios porosos
em múltiplas dimensões.

• Estudo e acoplamento via IMPES (implicit pressure- explicit saturation), destas
formulações espectrais com diferentes métodos utilizados para dar solução à equa-
ção de pressão, como por exempto, TPFA (two point flux aproximation), MPFA
(multipoint flux approximation), etc.

• Implementação de metodologias para adaptação h-p.



94

Referências Bibliográficas

Abgrall, R. (1994). On essentially non-oscillatory schemes on unstructured meshes: analy-
sis and implementation. Journal of Computational Physics, 114(1):45–58. 47

Anderson, D. A., Tannehill, J. C., and Pletcher, R. H. (1984). Computational fluid
mechanics and heat transfer. 20

Barth, T. J. and Frederickson, P. O. (1990). Higher order solution of the Euler equations
on unstructured grids using quadratic reconstruction. AIAA paper, 90:0013. 47

Bastian, P. (1999). Numerical computation of multiphase flows in porous media. PhD
thesis, Ph. D. thesis, Universitat Kiel, Kiel. 26

Bear, J. (1988). Dynamics of fluids in porous media. Dover publications. 28, 29

Boris, J. P. and Book, D. L. (1973). Flux-corrected transport. I. SHASTA, A fluid trans-
port algorithm that works. Journal of computational physics, 11(1):38–69. 40, 62

Breviglieri, C., Azevedo, J. L. F., and Basso, E. (2010). An unstructured grid implemen-
tation of high-order spectral finite volume schemes. Journal of the Brazilian Society of
Mechanical Sciences and Engineering, 32(SPE):419–433. 17, 50, 62, 69

Brooks, R. H. and Corey, A. T. (1964). Hydraulic properties of porous media. Hydrology
Papers, Colorado State University, (March). 29

Buckley, S. E. and Leverett, M. (1942). Mechanism of fluid displacement in sands. Trans.
AIME, 146(107):1–7. 33

Carvalho, D. K. d. (2005). Uma Formulação do Método dos Volumes Finitos com Estru-
tura de Dados por Aresta para a Simulação de Escoamentos em Meios Porosos. PhD
thesis, Tese de Doutorado, Universidade Federal de Pernambuco (UFPE), Recife. 28,
31, 33, 35

Chavent, G. and Jaffré, J. (1986). Mathematical models and finite elements for reservoir
simulation: single phase, multiphase, and multicomponent flows through porous media,
volume 17. North Holland. vii, 16, 33



Referências Bibliográficas 95

Chen, Z., Huan, G., and Ma, Y. (2006). Computational methods for multiphase flows in
porous media, volume 2. SIAM. 17

Choi, B.-J., Iskandarani, M., Levin, J., and Haidvogel, D. B. (2004). A spectral finite-
volume method for the shallow water equations. Monthly weather review, 132(7):1777–
1791. 17, 47

Cockburn, B., Hou, S., and Shu, C.-W. (1990). The Runge-Kutta local projection discon-
tinuous Galerkin finite element method for conservation laws IV: The multidimensional
case. Math. Comp, 54(190):545–581. 48

Cockburn, B., Lin, S.-Y., and Shu, C.-W. (1989). TVB Runge-Kutta local projection
discontinuous Galerkin finite element method for conservation laws III: One-dimensional
systems. Journal of Computational Physics, 84(1):90–113. 48

Cockburn, B. and Shu, C.-W. (1989). TVB Runge-Kutta local projection discontinuous
Galerkin finite element method for conservation laws II: General framework. Math.
Comp, 52(186):411–435. 38, 39, 48

Colella, P. and Woodward, P. R. (1984). The piecewise parabolic method (PPM) for
gas-dynamical simulations. Journal of computational physics, 54(1):174–201. 40

Cueto-Felgueroso (2009). Finite volume methods for one-dimensional scalar conservation
laws. Computational methods for flow in porous media, page 1.723. 31, 43, 89

Cueto-Felgueroso, L. and Colominas, I. (2008). High-order finite volume methods and
multiresolution reproducing kernels. Archives of Computational Methods in Engineering,
15(2):185–228. 17

Durlofsky, L. J. (1993). A triangle based mixed finite element finite volume technique
for modeling two phase flow through porous media. Journal of Computational Physics,
105(2):252–266. ix, 86, 87, 88

Ertekin, T., Abou-Kassem, J. H., and King, G. R. (2001). Basic applied reservoir simu-
lation. Richardson, TX: Society of Petroleum Engineers. 28

Fanchi, J. R. (2005). Principles of applied reservoir simulation. Gulf Professional Pu-
blishing. 17

Fortuna, A. d. O. (2000). Técnicas computacionais para dinâmica dos fluidos: conceitos
básicos e aplicações. EDUSP. 20

Friedrich, O. (1998). Weighted essentially non-oscillatory schemes for the interpolation of
mean values on unstructured grids. Journal of Computational Physics, 144(1):194–212.
48



Referências Bibliográficas 96

Godunov, S. (1959). A finite-difference method for the numerical computation of discon-
tinuous solutions of the equations of fluid dynamics. Mat. Sb, 47(271). 36, 42, 47, 48,
62, 74

Harten, A., Lax, P. D., and Leer, B. v. (1983). On upstream differencing and Godunov-
type schemes for hyperbolic conservation laws. SIAM Review, 25(1):35–61. 39

Harten, A. and Osher, S. (1997). Uniformly high-order accurate nonoscillatory schemes.
I. Springer. 40

Helmig, R. (1997). Multiphase flow and transport processes in the subsurface, volume 6.
Springer Berlin. 26, 28, 29, 30, 32, 33

Hirsch, C. (2007). Numerical computation of internal and external flows: the fundamentals
of computational fluid dynamics, volume 1. Butterworth-Heinemann. 20, 36, 42, 45, 46,
67

Hu, C. and Shu, C.-W. (1999). Weighted essentially non-oscillatory schemes on triangular
meshes. Journal of Computational Physics, 150(1):97–127. 48

Isaacson, E. (1994). Analysis of numerical methods. Courier Dover Publications. 52

Kannan, R. and Wang, Z. (2012). Improving the high order spectral volume formulation
using a diffusion regulator. Communications in Computational Physics, 12(1):247. 48

Kopriva, D. A. (1991). Multidomain spectral solution of the Euler gas-dynamics equations.
Journal of Computational Physics, 96(2):428–450. 48

Kopriva, D. A. and Kolias, J. H. (1995). A Conservative Staggered-Grid Chebyshev
Multidomain Method for Compressible Flow. Technical report, DTIC Document. 48

LeVeque, R. J. (1992). Numerical methods for conservation laws, volume 132. Springer.
21, 22, 23, 26

LeVeque, R. J. (2002). Finite volume methods for hyperbolic problems, volume 31. Cam-
bridge university press. 25, 36, 39, 42

Liang, C., Cox, C., and Plesniak, M. (2013). A comparison of computational efficiencies
of spectral difference method and correction procedure via reconstruction. Journal of
Computational Physics, 239:138–146. 84

Liou, M.-S. (2000). Mass flux schemes and connection to shock instability. Journal of
Computational Physics, 160(2):623 – 648. 47

Liu, Y. (2013). Comunicação pessoal via e-mail. 60



Referências Bibliográficas 97

Löhner, R. (2008). Applied computational fluid dynamics techniques: an introduction
based on finite element methods. Wiley. 44

Lyra, P. R. M. (1994). Unstructured grid adaptive algorithms for fluid dynamics and heat
conduction. PhD thesis, University of Wales Swansea. 20, 23, 24, 25, 45

Oleinik, O. A. (1957). Discontinuous solutions of non-linear differential equations. Uspekhi
Matematicheskikh Nauk, 12(3):3–73. 23

Osher, S. (1984). Riemann solvers, the entropy condition, and difference. SIAM Journal
on Numerical Analysis, 21(2):217–235. 47

Peaceman, D. W. (1977). Fundamentals of numerical reservoir simulation, volume 6.
Elsevier. 17, 28

Pinto, A. C. C. (1991). Esquemas de alta resolução para controle da dispersão numérica
em simulação de reservatórios. Technical report. 80

Roe, P. L. (1981). Approximate Riemann solvers, parameter vectors, and difference sche-
mes. Journal of computational physics, 43(2):357–372. 47

Rusanov, V. V. (1962). Calculation of interaction of non-steady shock waves with obsta-
cles. NRC, Division of Mechanical Engineering. 37

Schwartzkopff, T., Dumbser, M., and Munz, C.-D. (2004). Fast high order ADER schemes
for linear hyperbolic equations. Journal of Computational Physics, 197(2):532–539. 17

Shu, C.-W. (1987). TVB uniformly high-order schemes for conservation laws. Mathematics
of Computation, 49(179):105–121. 39, 40

Shu, C.-W. (1988). Total-variation-diminishing time discretizations. SIAM Journal on
Scientific and Statistical Computing, 9(6):1073–1084. 39

Shu, C.-W. (1998). Essentially non-oscillatory and weighted essentially non-oscillatory
schemes for hyperbolic conservation laws. Springer. 55

Sourek, J. (2013). Comunicação pessoal via e-mail. University of West Bohemia, Czech
Republic. 62

Sun, Y., Wang, Z. J., and Liu, Y. (2006). Spectral (finite) volume method for conservation
laws on unstructured grids VI: extension to viscous flow. Journal of Computational
Physics, 215(1):41–58. 17

Titarev, V. and Toro, E. (2005). ADER schemes for three-dimensional non-linear hyper-
bolic systems. Journal of Computational Physics, 204(2):715–736. 17



Referências Bibliográficas 98

Toro, E. F. (2009). Riemann solvers and numerical methods for fluid dynamics: a practical
introduction. Springer. 22, 23, 25, 36, 41

Trefethen, L. N. (2000). Spectral methods in MATLAB, volume 10. Siam. 46

van den Abeele, K. (2009). Development of high-order accurate schemes for unstructured
grids. PhD thesis, Vrije Universiteit Brussel. 35, 36, 47, 61, 62, 73

van den Abeele, K., Broeckhoven, T., and Lacor, C. (2007a). Dispersion and dissipation
properties of the 1D spectral volume method and application to a&amp;lt;i&gt; p&lt;/i&gt;-multigrid
algorithm. Journal of Computational Physics, 224(2):616–636. 73

van den Abeele, K., Lacor, C., and Wang, Z. J. (2007b). Short note: On the connection
between the spectral volume and the spectral difference method. Journal of Computa-
tional Physics, 227(2):877–885. 60, 69

van Leer, B. (1974). Towards the ultimate conservative difference scheme. II. Monotonicity
and conservation combined in a second-order scheme. Journal of computational physics,
14(4):361–370. 40, 62

van Leer, B. (1979). Towards the ultimate conservative difference scheme. V. A second-
order sequel to Godunov’s method. Journal of computational Physics, 32(1):101–136.
62

van Leer, B. (1982). Flux-vector splitting for the Euler equations. In Eighth international
conference on numerical methods in fluid dynamics, pages 507–512. Springer. 47

Wang, Z. (1997). A fast flux-splitting for all speed flow. In Fifteenth International
Conference on Numerical Methods in Fluid Dynamics, pages 141–146. Springer. 47

Wang, Z. J. (2002). Spectral (Finite) Volume Method for Conservation Laws on Unstruc-
tured Grids. Basic Formulation. Journal of Computational Physics, 178(1):210–251. 42,
48, 60, 63, 65, 69, 71, 78

Wang, Z. J. and Liu, Y. (2002). Spectral (finite) volume method for conservation laws
on unstructured grids: II. Extension to two-dimensional scalar equation. Journal of
Computational Physics, 179(2):665–697. 48

Wang, Z. J., Zhang, L., and Liu, Y. (2004). Spectral (finite) volume method for conser-
vation laws on unstructured grids IV: extension to two-dimensional systems. Journal
of Computational Physics, 194(2):716–741. 50

Wesseling, P. (2009). Principles of computational fluid dynamics, volume 29. Springer
Science &amp;amp; Business. 23, 25



Referências Bibliográficas 99

Zhang, M. and Shu, C.-W. (2005). An analysis of and a comparison between the Dis-
continuous Galerkin and the Spectral Finite Volume Methods. Computers &amp;amp; fluids,
34(4):581–592. 73

Zienkiewicz, O. C. and Taylor, R. L. (1988). The finite element method. McGraw-hill. 44


	Introdução
	Motivação
	Objetivos
	Organização da dissertação

	Equações governantes
	Considerações iniciais
	Problemas modelo da dinâmica dos fluidos
	Equação linear da advecção
	Equação não linear de Burgers
	O problema de Riemann

	Escoamento bifásico e imiscível em meios porosos
	Conceitos fundamentais
	Condições iniciais e de contorno
	Equação de Buckley-Leverett


	O método dos volumes finitos clássico
	Esquema de primeira ordem de acurácia
	Formulação geral
	Resolvedores de Riemann aproximados

	Esquemas TVD e TVB
	Esquema de alta ordem de acurácia
	Esquema limitador de declividade
	Discretização do termo difusivo
	Discretização temporal

	Método espectral dos volumes finitos
	Considerações iniciais
	Método espectral dos volumes finitos unidimensional
	Definição das partições
	Reconstrução polinomial unidimensional 
	Constantes de interpolação polinomial
	Condições de contorno e iniciais
	Condição de contorno de Dirichlet
	Condições iniciais

	Funções limitadoras
	Avaliação de acurácia dos métodos numéricos
	Algoritmo geral

	Aplicações
	Estudo da acurácia utilizando a equação da onda linear
	Propagação da onda senoidal
	Propagação do pulso Gaussiano
	Propagação da onda quadrada

	Teste para equação não linear de Burgers
	Modelo do fluxo bifásico
	Problema de Buckley-Leverett
	Efeitos gravitacionais
	Efeitos da pressão capilar
	Efeitos gravitacionais e da pressão capilar


	Conclusões e trabalhos futuros 
	Referências Bibliográficas

</field>
	</doc>
</add>