<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20260</field>
		<field name="filename">3731_212915.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
VALDEMAR ANTONIO DALLAGNOL FILHO

Identificac?a?o de modelos ARMAX e NARMAX

para um poc?o de petro?leo operando por injec?a?o

cont??nua de ga?s

FLORIANO?POLIS

2005



Universidade Federal de Santa Catarina

Programa de Po?s-Graduac?a?o

em Engenharia Ele?trica

Identificac?a?o de modelos ARMAX e

NARMAX para um poc?o de petro?leo

operando por injec?a?o cont??nua de ga?s

Dissertac?a?o submetida a?

Universidade Federal de Santa Catarina

como parte dos requisitos para a

obtenc?a?o do grau de Mestre em Engenharia Ele?trica

Valdemar Antonio Dallagnol Filho

Floriano?polis, fevereiro de 2005.



Identificac?a?o de modelos ARMAX e NARMAX

para um poc?o de petro?leo operando por injec?a?o

cont??nua de ga?s

Valdemar Antonio Dallagnol Filho

Esta Dissertac?a?o foi julgada adequada para obtenc?a?o do T??tulo de Mestre em Enge-

nharia Ele?trica, A?rea de Concentrac?a?o em Automac?a?o e Sistemas, e aprovada em sua

forma final pelo Programa de Po?s-Graduac?a?o em Engenharia Ele?trica da Universidade

Federal de Santa Catarina.

Floriano?polis, 25 de Fevereiro de 2005.

Prof. Denizar Cruz Martins, Dr.
Coordenador do Programa de Po?s-Graduac?a?o em Engenharia Ele?trica

Prof. Daniel Juan Pagano, Dr.
Orientador

Prof. Edson Roberto de Pieri, Dr.
Co-Orientador

Banca Examinadora

Prof. Daniel Juan Pagano, Dr.
Presidente da Banca

Prof. Eduardo Camponogara, Dr.

Prof. Julio Elias Normey Rico, Dr

Prof. Nestor Roqueiro, Dr.



“Tudo o que voce? fizer sera? insignificante,

mas e? muito importante que voce? o fac?a”

Mahatma Gandhi



Agradecimentos

Ao professor Daniel Juan Pagano, pela valiosa orientac?a?o e amizade.

Ao professor Edson Roberto De Pieri, pela coragem em me orientar a? dista?ncia

numa a?rea pouco explorada.

A? minha fam??lia, pelo carinho, presenc?a constante e apoio irrestrito: Ma?e, Pai,

Luciana, Paulo, Rodrigo e Lucas.

A? Patr??cia Schaeffer, pelo carinho e incessante est??mulo.

Ao colega Agustinho Pluce?nio pela infinda?vel disposic?a?o em ajudar.

Aos membros da banca - Prof. Eduardo Camponogara, Prof. Julio Elias Normey

Rico e Prof. Nestor Roqueiro - por suas sugesto?es.

A todos meus amigos, por fazerem parte da minha vida. Na?o me atrevo a cita?-los

nominalmente para na?o correr o risco de injustamente deixar algue?m de fora.

Ao professor Luis Antonio Aguirre e ao engenheiro Ma?rcio Santos Barroso por

prontamente terem disponibilizado rotinas de grande utilidade para este trabalho.

A? empresa Scandpower por disponibilizar para a UFSC uma licenc?a acade?mica do

simulador OLGA 2000.

Ao CNPq pelo suporte financeiro.

A? Age?ncia Nacional de Petro?leo - ANP, atrave?s do programa de Recursos Humanos

da ANP para o setor de Petro?leo e Ga?s Natural - PRH34-ANP/MCT, pelo apoio

financeiro.

iii



Resumo da Dissertac?a?o apresentada a? UFSC como parte dos requisitos necessa?rios

para a obtenc?a?o do grau de Mestre em Engenharia Ele?trica.

Identificac?a?o de modelos ARMAX e NARMAX
para um poc?o de petro?leo operando por injec?a?o

cont??nua de ga?s

Valdemar Antonio Dallagnol Filho

Orientador : Daniel Juan Pagano, Dr.

Co-orientador : Edson Roberto De Pieri, Dr.

A?rea : Automac?a?o e Sistemas

Palavras-chave : Identificac?a?o de Sistemas, Sistemas Na?o-Lineares,

Modelos ARMAX, Modelos NARMAX, Produc?a?o de Petro?leo,

Elevac?a?o Artificial, Gas-Lift

Nu?mero de pa?ginas : 121

Neste trabalho sa?o identificados modelos lineares do tipo ARMAX e na?o-lineares

do tipo NARMAX polinomial para a relac?a?o existente entre a vaza?o ma?ssica de ga?s

injetado e a pressa?o no tubo de produc?a?o de um poc?o de petro?leo operando por injec?a?o

cont??nua de ga?s, simulado pelo software OLGA 2000. O objetivo e? fornecer um mo-

delo que seja u?til posteriormente para o projeto de um controlador que possibilite ao

poc?o operar na regia?o de maior interesse econo?mico. A escolha do par de varia?veis de

entrada e sa??da permitiu que a ana?lise do sistema fosse feita como sendo monovaria?vel,

sendo controladores locais utilizados para as demais varia?veis do poc?o. Ale?m disso,

as varia?veis de entrada e sa??da sa?o facilmente mensura?veis, ja? existindo toda a instru-

mentac?a?o necessa?ria nos poc?os atuais, ao contra?rio de outras estrate?gias de controle

para sistemas similares, encontradas na literatura.

Tre?s modelos do tipo ARMAX foram identificados em diferentes pontos de operac?a?o

dentro da regia?o de interesse, demonstrando ter validade restrita a uma faixa muito

estreita de operac?a?o, devido a? caracter??stica na?o-linear do poc?o. Dois modelos do tipo

NARMAX polinomial foram enta?o obtidos, sendo o primeiro identificado com o uso de

uma entrada mais “agressiva”, que visa excitar toda a dina?mica na?o-linear do sistema.

Essa entrada, no entanto, apresenta um maior risco a?s instalac?o?es devido a?s variac?o?es



abruptas. O modelo identificado demonstrou ser va?lido para uma regia?o maior que

os modelos lineares. O segundo modelo NARMAX foi identificado reaproveitando-se

os dados usados para a identificac?a?o dos modelos lineares - mais “comportados” e

mais seguros para as instalac?o?es. Devido a na?o-linearidade existente na?o ser ta?o forte,

o uso de dados mais comportados mostrou ser suficiente para a identificac?a?o de um

modelo va?lido para toda a regia?o de operac?a?o. Entradas deste tipo possibilitam que a

identificac?a?o seja realizada sem grandes alterac?o?es na operac?a?o normal do poc?o real e

que a realizac?a?o dos testes na?o cause perda de produc?a?o.



Abstract of Dissertation presented to UFSC as a partial fulfillment of the refinements

for the degree of Master in Electrical Engineering.

Identification of ARMAX and NARMAX models
for an oil well operating by continuous gas-lift

Valdemar Antonio Dallagnol Filho

Advisor : Daniel Juan Pagano, Dr.

Co-advisor : Edson Roberto De Pieri, Dr.

Area : Automation and Systems

Keywords : System Identification, Nonlinear Systems,

ARMAX Models, NARMAX Models, Oil Production,

Artificial Lift, Gas-Lift

Number of pages : 121

Linear ARMAX models and nonlinear polynomial NARMAX models are identified

for the relation between the mass flow of injected gas and pressure in the production

tubing of an oil well operating with continuous gas-lift, simulated by the software

OLGA 2000. The goal is to find a model that is useful for the design of a controller

that allows the operation of the well in the region of greater economic gains. The

choice of the input/output pair allowed the analysis of the system to be done as if it

were SISO, with local controllers used for the remaining variables of the well. Besides

that, the input and output variables are easily measurable, with all the instrumentation

needed already available in modern wells, unlike other control strategies proposed for

similar systems, found in literature.

Three ARMAX models were identified in different operating points inside the desi-

red region, showing to be valid only in a small zone, due to the nonlinear characteristics

of the well. Two polynomial NARMAX models were then identified, the first one iden-

tified with the usage of an “aggressive” input, which tries to excite all the nonlinear

dynamics of the system. This input, however, offers a risk to the plant due to its abrupt

shifts. The identified model was shown to be valid in a region larger than that for li-

near models. The second NARMAX model was identified reusing the data collected

for identifying linear models - more “well-behaved” and safer for the plant. Because



the existent nonlinearity is not very strong, the use of the well-behaved data showed to

be enough to identify a model valid in all the operating region. These kind of inputs

allow the identification to be done without great shifts in the normal operation of the

well and that the execution of the tests do not cause loss in production.



Suma?rio

1 Introduc?a?o 1

2 Modelagem de Sistemas Dina?micos 4

2.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

2.2 Classificac?a?o de Modelos . . . . . . . . . . . . . . . . . . . . . . . . . . 6

2.3 Representac?o?es Lineares . . . . . . . . . . . . . . . . . . . . . . . . . . 8

2.3.1 Representac?a?o Geral Discreta . . . . . . . . . . . . . . . . . . . 8

2.3.2 Modelos AR e ARX . . . . . . . . . . . . . . . . . . . . . . . . 9

2.3.3 Modelos ARMA e ARMAX . . . . . . . . . . . . . . . . . . . . 9

2.4 Representac?o?es na?o-Lineares e Modelos NARMAX . . . . . . . . . . . . 11

3 Identificac?a?o de Sistemas 15

3.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

3.2 Etapas na identificac?a?o de Sistemas . . . . . . . . . . . . . . . . . . . . 16

3.3 Func?o?es de Correlac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

3.4 Projeto do Sinal de Teste . . . . . . . . . . . . . . . . . . . . . . . . . . 18

3.5 Determinac?a?o do per??odo de amostragem . . . . . . . . . . . . . . . . . 20

3.6 Estimac?a?o de Para?metros . . . . . . . . . . . . . . . . . . . . . . . . . . 21

3.6.1 O Estimador de M??nimos Quadrados (MQ) . . . . . . . . . . . . 21

viii



3.6.2 O Me?todo de MQ com Modelos Autoregressivos . . . . . . . . . 25

3.6.3 Polarizac?a?o de Estimadores . . . . . . . . . . . . . . . . . . . . 27

3.7 Crite?rios de Informac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

3.8 Ferramentas Utilizadas na Identificac?a?o de Sistemas na?o-Lineares . . . 30

3.8.1 Algoritmos MQ Ortogonais . . . . . . . . . . . . . . . . . . . . 30

3.8.2 A Taxa de Reduc?a?o de Erro . . . . . . . . . . . . . . . . . . . . 33

3.8.3 Agrupamento de termos . . . . . . . . . . . . . . . . . . . . . . 36

3.8.4 Caracter??stica esta?tica . . . . . . . . . . . . . . . . . . . . . . . 38

3.9 Validac?a?o do Modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

4 Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 42

4.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

4.2 Descric?a?o do Sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

4.3 O simulador Olga . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

4.4 Identificac?a?o Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

4.4.1 Identificac?a?o em torno de u=1.5 kg/s . . . . . . . . . . . . . . . 66

4.4.2 Identificac?a?o em torno de u=2.15 kg/s . . . . . . . . . . . . . . 72

4.4.3 Identificac?a?o em torno de u=2.8 kg/s . . . . . . . . . . . . . . . 75

4.4.4 Comenta?rios sobre os modelos lineares identificados . . . . . . . 82

4.5 Identificac?a?o na?o-Linear . . . . . . . . . . . . . . . . . . . . . . . . . . 88

4.5.1 Identificac?a?o usando sinal de entrada “agressivo” . . . . . . . . 89

4.5.2 Identificac?a?o usando sinal de entrada “comportado” . . . . . . . 98

4.6 Comparac?a?o entre os modelos identificados . . . . . . . . . . . . . . . . 106

4.7 Comenta?rios ao controle do sistema . . . . . . . . . . . . . . . . . . . . 113

5 Considerac?o?es Finais 116



Lista de Figuras

3.1 Exemplo de res??duos na equac?a?o de uma reta . . . . . . . . . . . . . . . 24

3.2 Validac?a?o atrave?s da simulac?a?o livre de um modelo . . . . . . . . . . . 40

4.1 Curva IPR (Inflow Performance Relationship) t??pica para fluido subsa-

turado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

4.2 Poc?o morto . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.3 Esquema de um poc?o operando por elevac?a?o cont??nua de ga?s, destacando

os principais equipamentos envolvidos . . . . . . . . . . . . . . . . . . . 46

4.4 Curva da vaza?o de produc?a?o x vaza?o de injec?a?o, com a a?rea de maior

interesse econo?mico em destaque. . . . . . . . . . . . . . . . . . . . . . 48

4.5 Estrutura do controlador de vaza?o ma?ssica de injec?a?o de ga?s . . . . . . 49

4.6 Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, inicialmente utilizados 50

4.7 Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s . . 51

4.8 Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s . . . . 51

4.9 Queda de pressa?o no choke de produc?a?o em func?a?o da vaza?o de injec?a?o

de ga?s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

4.10 Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da

vaza?o de injec?a?o de ga?s . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

4.11 Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo . . . . . . . . . . . . 54

4.12 Sequ?e?ncia de degraus de teste aplicada na entrada e sa??da do sistema,

mostrando a na?o-linearidade do mesmo . . . . . . . . . . . . . . . . . . 55

x



4.13 Degrau mostrando a presenc?a de fase na?o-m??nima no sistema . . . . . . 56

4.14 Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s para

Ph constante . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

4.15 Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s para Ph

constante . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

4.16 Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da

vaza?o de injec?a?o de ga?s para Ph constante . . . . . . . . . . . . . . . . 58

4.17 Geometria do sistema em ana?lise, implementado no OLGA . . . . . . . 60

4.18 Sinal aplicado na entrada do sistema para realizar a identificac?a?o linear 61

4.19 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de

1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

4.20 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de

2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

4.21 Sa??da do sistema para a identificac?a?o linear com a entrada em torno de

2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

4.22 Func?a?o de autocovaria?ncia linear usada para definir o fator de reamos-

tragem adequado para o sinal de sa??da . . . . . . . . . . . . . . . . . . 64

4.23 Sinal aplicado na entrada do sistema para validar a identificac?a?o linear 65

4.24 Valor de AIC para modelos estimados em torno da entrada 1.5 kg/s . . 67

4.25 Simulac?a?o livre do modelo ARX encontrado em torno da entrada 1.5 kg/s 68

4.26 Diagrama de po?los e zeros do modelo ARX encontrado em torno da

entrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

4.27 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da

entrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

4.28 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno

da entrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

4.29 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 1.5

kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72



4.30 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da

entrada 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73

4.31 Valor de AIC para modelos estimados em torno da entrada 2.15 kg/s . 74

4.32 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da

entrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

4.33 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno

da entrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

4.34 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada

2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76

4.35 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da

entrada 2.15 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

4.36 Valor de AIC para modelos estimados em torno da entrada 2.8 kg/s . . 78

4.37 Diagrama de po?los e zeros do modelo ARX encontrado em torno da

entrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

4.38 Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno da

entrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80

4.39 Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno

da entrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

4.40 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 2.8

kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

4.41 Diagrama de po?los e zeros do modelo ARMAX encontrado em torno da

entrada 2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

4.42 Diagrama com os po?los e zeros de todos os tre?s modelos lineares encon-

trados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

4.43 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 1.5

kg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . . . . 86

4.44 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada

2.15 kg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . 86



4.45 Simulac?a?o livre do modelo ARMAX encontrado em torno da entrada 2.8

kg/s com a amplitude da entrada de 0.6 kg/s . . . . . . . . . . . . . . . 87

4.46 Sa??da do modelo ARMAX encontrado em torno de 2.8 kg/s para um

degrau unita?rio aplicado na entrada . . . . . . . . . . . . . . . . . . . . 87

4.47 Sinal de entrada do sistema (vaza?o de ga?s injetado) para estimac?a?o de

para?metros do modelo na?o-linear . . . . . . . . . . . . . . . . . . . . . 90

4.48 Pressa?o no tubo de produc?a?o (sa??da do sistema) para estimac?a?o de

para?metros do modelo na?o-linear . . . . . . . . . . . . . . . . . . . . . 90

4.49 Sinal de entrada do sistema (vaza?o de ga?s injetado) para validac?a?o do

modelo na?o-linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91

4.50 Pressa?o no tubo de produc?a?o (sa??da do sistema) para validac?a?o do mo-

delo na?o-linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92

4.51 Func?a?o de autocovaria?ncia normalizada - caso na?o-linear . . . . . . . . 93

4.52 Coeficientes de agrupamento do modelo NARMAX obtido para o sistema

excitado com uma entrada “agressiva” . . . . . . . . . . . . . . . . . . 94

4.53 Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-

MAX do sistema excitado por uma entrada agressiva . . . . . . . . . . 96

4.54 Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma

entrada agressiva comparada com os dados de validac?a?o . . . . . . . . . 98

4.55 Pontos fixos do modelo NARMAX identificado com a entrada agressiva 99

4.56 Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-

MAX do sistema excitado por uma entrada comportada . . . . . . . . 102

4.57 Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma

entrada comportada comparada com os dados de validac?a?o . . . . . . . 103

4.58 Pontos fixos do modelo NARMAX identificado com a entrada comportada104

4.59 Simulac?a?o livre dos modelos ARMAX L1.5 e L2.8 comparados com a

sa??da real do sistema para uma entrada PRBS de amplitude 0.6 kg/s em

torno de 1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107



4.60 Simulac?a?o livre do modelo ARMAX L1.5 comparado com a sa??da real

do sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de

2.8 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

4.61 Simulac?a?o livre do modelo NARMAX NLC comparado com a sa??da real

do sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de

1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

4.62 Simulac?a?o livre do modelo NARMAX NLA comparado com a sa??da real

do sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de

1.5 kg/s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

4.63 Histograma de valores da entrada u(k) para a entrada agressiva e com-

portada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

4.64 Histograma de valores da sa??da y(k) para a entrada agressiva e comportada112



Lista de Tabelas

4.1 Po?los, zeros e ganhos esta?ticos dos modelos lineares identificados . . . . 84

4.2 Ajuste das curvas dos modelos lineares para diferentes amplitudes do

sinal de entrada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

4.3 Termos do modelo NARMAX identificado para uma entrada agressiva,

em ordem do valor de ERR . . . . . . . . . . . . . . . . . . . . . . . . 95

4.4 Termos do modelo NARMAX identificado para uma entrada agressiva,

em ordem do valor de ERR, com todos os para?metros estatisticamente

significativos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

4.5 Termos do modelo NARMAX identificado para uma entrada agressiva,

em ordem do valor de ERR, para aplicac?a?o em controle preditivo . . . 100

4.6 Termos do modelo NARMAX identificado para uma entrada compor-

tada, em ordem do valor de ERR, com todos os para?metros estatistica-

mente significativos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

4.7 Termos do modelo NARMAX identificado para uma entrada compor-

tada, em ordem do valor de ERR, para aplicac?a?o em controle preditivo 105

4.8 Modelos lineares e na?o-lineares identificados . . . . . . . . . . . . . . . 108

4.9 Comparac?a?o do desempenho dos modelos, para entradas PRBS osci-

lando em torno de uma entrada . . . . . . . . . . . . . . . . . . . . . . 109

xv



Cap??tulo 1

Introduc?a?o

E? inega?vel o quanto a sociedade atual depende do petro?leo. Na?o somente do petro?leo

como fonte de energia, mas tambe?m dos produtos derivados dele, como por exemplo

os pla?sticos, borrachas sinte?ticas, tintas, corantes, adesivos, solventes, detergentes, ex-

plosivos, produtos farmace?uticos, cosme?ticos entre outros [37].

Constitu??do basicamente de uma mistura de compostos qu??micos orga?nicos (hidro-

carbonetos), o petro?leo tem sido utilizado pelo ser humano desde a e?poca dos ba-

bilo?nicos, que utilizavam o petro?leo para assentar tijolos, e dos fen??cios, que o usavam

para calafetar embarcac?o?es. Naquela e?poca, o petro?leo era retirado de exsudac?o?es natu-

rais. Hoje em dia, a demanda crescente de petro?leo requer o uso de te?cnicas modernas

de engenharia para sua prospecc?a?o e explorac?a?o, sendo o petro?leo obtido de poc?os cada

vez mais profundos. Quando a pressa?o do reservato?rio de petro?leo for suficientemente

alta, o petro?leo fluira? ate? a superf??cie sem a necessidade de ajuda externa. No entanto,

quando a pressa?o for baixa, utilizam-se me?todos de elevac?a?o artificial para suplementar

a energia natural e melhorar a produtividade do poc?o. Um dos me?todos de elevac?a?o

artificial utilizados e? a elevac?a?o por injec?a?o cont??nua de ga?s (continuous gas-lift), onde

atrave?s da injec?a?o de ga?s num ponto profundo do poc?o, diminui-se a densidade da

coluna de petro?leo, reduzindo as forc?as contra?rias a? chegada deste ate? a superf??cie.

O me?todo de elevac?a?o por injec?a?o cont??nua de ga?s possui uma vaza?o o?tima de ga?s,

do ponto de vista econo?mico, numa regia?o de operac?a?o do poc?o que e? muito oscilato?ria.

Assim, ha? um grande interesse em estruturas para o controle de poc?os que operem com

este me?todo de elevac?a?o artificial.

Para efetuar o controle do poc?o, recorrem-se a?s ferramentas da teoria de controle,



Introduc?a?o 2

que requerem o uso de um modelo matema?tico do sistema em ana?lise. A modelagem

fenomenolo?gica das relac?o?es de entrada e sa??da do poc?o e? uma tarefa complexa, en-

volvendo equac?o?es com derivadas parciais de dif??cil manipulac?a?o. Uma alternativa e?

recorrer a? modelagem emp??rica, ou identificac?a?o de sistemas, que e? um ramo da cie?ncia

que se ocupa em encontrar relac?o?es matema?ticas entre uma se?rie de valores de entrada

e uma se?rie de valores de sa??da de um sistema, sem que haja conhecimento pre?vio do

seu funcionamento interno (identificac?a?o caixa-preta). Tal conhecimento pre?vio pode

evidentemente ser utilizado, quando dispon??vel, para melhorar a qualidade dos modelos

identificados, chamando-se esse procedimento de identificac?a?o caixa-cinza.

O sistema em ana?lise possui um comportamento na?o-linear, de forma que modelos

lineares que venham a ser obtidos sera?o va?lidos somente dentro de uma estreita faixa

de operac?a?o. Como ha? interesse que o sistema possa funcionar dentro de uma regia?o

mais ampla que aquela permitida pelos modelos lineares, recorrem-se aos modelos na?o-

lineares, que apesar de serem mais complexos e requererem um ferramental espec??fico,

representam de forma mais completa a caracter??stica esta?tica e dina?mica de um sistema

na?o-linear.

A motivac?a?o para este trabalho e? justamente a necessidade da obtenc?a?o de modelos

lineares e na?o-lineares para um poc?o, que possam ser utilizados na implementac?a?o de

estruturas de controle que visem a otimizac?a?o do seu funcionamento.

O tipo de modelo utilizado neste trabalho e? o NARMAX (na?o-linear auto-regressivo

com me?dia mo?vel e entradas exo?genas - do ingle?s Nonlinear AutoRegressive Moving

Average with eXogenous inputs) polinomial, que e? adequado para representar sistemas

na?o-lineares desde que na?o haja variac?o?es abruptas nos dados de sa??da, estando dis-

pon??veis uma se?rie de algoritmos simples e robustos (conseguem lidar com um certo

n??vel de mal-condicionamento nume?rico) para estimac?a?o dos para?metros do modelo.

As varia?veis de entrada e sa??da do sistema foram definidas como sendo a vaza?o

ma?ssica de injec?a?o de ga?s na entrada do poc?o e a pressa?o no tubo de produc?a?o, respec-

tivamente. Esta escolha de varia?veis tem o me?rito de transformar o sistema a ser contro-

lado num sistema SISO, com controles locais atuando sobre as demais varia?veis. Ale?m

disso, as varia?veis escolhidas sa?o facilmente mensura?veis, tornando a implementac?a?o

pra?tica do sistema fact??vel e interessante financeiramente.

Este trabalho esta? organizado da seguinte maneira. O cap??tulo 2 faz uma revisa?o

teo?rica sobre modelagem e identificac?a?o de sistemas, classificac?a?o de modelos e sobre as



Introduc?a?o 3

representac?o?es lineares e na?o-lineares existentes, em particular as representac?o?es ARX

e ARMAX (lineares) e a representac?a?o NARMAX polinomial (na?o-linear), utilizadas

mais adiante.

O cap??tulo 3 faz uma revisa?o teo?rica sobre identificac?a?o de sistemas; etapas na

identificac?a?o de sistemas; questo?es pra?ticas como a escolha do per??odo de amostragem e

do sinal de entrada para identificac?a?o; estimac?a?o de para?metros; ferramentas espec??ficas

a? identificac?a?o de sistemas na?o-lineares do tipo NARMAX; e sobre a validac?a?o dos

modelos obtidos.

O cap??tulo 4 conte?m a parte pra?tica deste trabalho, com o estudo de caso de um

poc?o de petro?leo operando por injec?a?o cont??nua de ga?s, simulado pelo software OLGA

2000. Faz-se inicialmente uma descric?a?o do sistema em estudo e do software utilizado

para simulac?a?o; seguida da identificac?a?o de modelos lineares para o sistema em tre?s

pontos de operac?a?o; identificac?a?o de modelos na?o-lineares utilizando duas estrate?gias

para o sinal de entrada; e comparac?a?o entre os modelos obtidos. E? tambe?m sugerida

uma estrate?gia para o controle do poc?o com o uso dos modelos identificados, a ser

usada em trabalhos futuros.

Por u?ltimo, no cap??tulo 5 sa?o apresentadas considerac?o?es finais e sugesto?es para

trabalhos futuros.



Cap??tulo 2

Modelagem de Sistemas Dina?micos

2.1 Introduc?a?o

Um sistema pode ser definido como “um conjunto de objetos agrupados por alguma

interac?a?o ou interdepende?ncia, de modo que existam relac?o?es de causa e efeito nos

feno?menos que ocorrem com os elementos deste conjunto” [29]. Em Ogata [31] define-

se um sistema como “uma combinac?a?o de componentes que atuam em conjunto e

realizam um certo objetivo. Um sistema na?o e? limitado apenas a algo f??sico. O conceito

de sistemas pode ser aplicado a feno?menos abstratos, dina?micos, como os encontrados

em Economia”.

Para estudos quantitativos de sistemas, como os feitos na engenharia, e? necessa?rio

que estes sistemas sejam representados por modelos matema?ticos adequados aos estudos

em curso. Fala-se em modelo adequado pois e? praticamente imposs??vel obter um modelo

matema?tico exato que represente um sistema. Ale?m de imposs??vel, um modelo exato

seria inu?til na maioria das vezes pois, em geral, o que se deseja e? um modelo que seja

representativo de uma ou mais caracter??sticas do sistema em ana?lise, na?o de todas elas

ao mesmo tempo. Um modelo que represente todas as caracter??sticas de um sistema

de forma exata seria ta?o complexo que seria mais fa?cil lidar com o pro?prio sistema e

ignorar o modelo.

Assim, utilizam-se modelos aproximados, sendo a aproximac?a?o boa ou na?o de acordo

com o objetivo do estudo. Por exemplo, modelos constru??dos com base na meca?nica

Newtoniana para estudar o movimento de um carro podem ser uma boa aproximac?a?o.



Modelagem de Sistemas Dina?micos 5

Se entretanto tratamos de movimento de ele?trons, esta aproximac?a?o na?o sera? adequada,

sendo necessa?rio utilizar modelos baseados na meca?nica qua?ntica. Ve?-se enta?o que na?o

ha? um u?nico modelo para representar um sistema.

Coelho [12] menciona alguns usos poss??veis para os modelos obtidos:

Previsa?o Sa?o tentativas de “prever” o comportamento futuro do sistema com base no

seu estado atual e na entrada do sistema.

Ana?lise e projeto de sistemas de controle Os modelos sa?o nesse caso utilizados

para a s??ntese de controladores usando as ferramentas da Teoria de Controle.

Em geral os modelos utilizados para projeto de sistemas de controle na?o sa?o de

grande complexidade.

Supervisa?o Utilizados para a detecc?a?o de erros e diagno?sticos, ao comparar-se a

dina?mica esperada (sa??da do modelo validado) comparada com o comportamento

do sistema real.

Otimizac?a?o Usados como ferramenta de tomada de decisa?o, visando a maxi-

mizac?a?o/minimizac?a?o de alguma varia?vel. Para o propo?sito de otimizac?a?o,

exigem-se modelos matema?ticos precisos.

Treinamento Utilizados para treinamento de operadores. Como exemplo desta ca-

tegoria de modelos pode-se citar os simuladores de vo?o, que sa?o baseados em

modelos matema?ticos do sistema real (um avia?o).

Pode-se obter o modelo basicamente de duas formas: atrave?s de uma modelagem

f??sica do processo ou atrave?s de uma modelagem emp??rica. A modelagem f??sica e?

derivada das equac?o?es f??sicas que regem um dado sistema, sendo tambe?m conhecida

por modelagem pela natureza do processo, modelagem fenomenolo?gica, conceitual ou

ainda modelagem caixa branca. Para tanto, faz-se necessa?rio conhecer a fundo o sistema

em ana?lise e as equac?o?es que o regem, o que nem sempre e? poss??vel ou via?vel. Ja? a

modelagem emp??rica, tambe?m conhecida por modelagem (ou identificac?a?o) caixa preta

requer pouco conhecimento do funcionamento interno do sistema, baseando a ana?lise

somente no estudo dos dados provenientes de observac?o?es do sistema.

Este cap??tulo faz uma breve revisa?o teo?rica de modelagem, comec?ando pela clas-

sificac?a?o de modelos segundo a Teoria de Sistemas Dina?micos. Em seguida, mostra



Modelagem de Sistemas Dina?micos 6

alguns modelos lineares usados, entre eles os modelos AR(X) e ARMA(X) utilizados

no estudo de caso mais adiante. Finalmente, comenta-se sobre representac?o?es na?o-

lineares e, em particular, a representac?a?o NARMAX e NARMAX polinomial, sendo

esta u?ltima o foco deste trabalho.

2.2 Classificac?a?o de Modelos

As poss??veis representac?o?es matema?ticas de sistemas sa?o diversas, sendo a seguir

mencionadas algumas classificac?o?es poss??veis de modelos, de acordo com a nomencla-

tura comumente usada na Teoria de Sistemas Dina?micos [4, 29].

Modelos Esta?ticos ou Dina?micos Modelos dina?micos sa?o aqueles modelos onde o

estado de um sistema num dado instante de tempo depende do estado do sistema

em instantes anteriores. Tais modelos sa?o normalmente descritos por equac?o?es

diferenciais ou a diferenc?as. Ja? modelos esta?ticos (ou instanta?neos) sa?o aqueles

onde para calcular o estado do sistema num dado instante de tempo, o estado

do sistema em instantes anteriores na?o e? relevante. Em outras palavras, mode-

los esta?ticos na?o te?m memo?ria, sendo normalmente representados por equac?o?es

alge?bricas. Na pra?tica, os sistemas reais sa?o todos dina?micos, mas para uma dada

ana?lise a dina?mica do sistema pode ser desprez??vel por ser muito ra?pida ou muito

lenta comparada com a escala de tempo utilizada.

Modelos de Tempo Cont??nuo, de Tempo Discreto ou H??bridos Um modelo e?

de tempo cont??nuo quando a varia?vel que representa o tempo t e? um nu?mero real

positivo. Ou seja, pode-se encontrar o valor de uma dada varia?vel do sistema em

qualquer instante de tempo t ? R+. Estes modelos sa?o em geral representados
por equac?o?es diferenciais, como por exemplo: x?(t) + 2x(t) = 0. A temperatura de

uma sala, por exemplo, pode ser representada por um modelo de tempo cont??nuo,

ja? que para qualquer instante de tempo, pode-se encontrar um valor de tempe-

ratura correspondente. Modelos de tempo discreto sa?o aqueles onde o valor que

define um instante de tempo k e? um nu?mero inteiro positivo, sendo normalmente

representados por equac?o?es a diferenc?as como: x(k)?3x(k?1) = 0, onde k ? Z+.
O prec?o de fechamento de uma ac?a?o na bolsa de valores e? bem representado num

modelo a tempo discreto, ja? que este dado so? e? obtido uma vez por dia, no final

do prega?o. Sistemas amostrados tambe?m sa?o bem representados por modelos a



Modelagem de Sistemas Dina?micos 7

tempo discreto, sendo este tipo de sistema muito utilizado na Identificac?a?o de

Sistemas. Modelos h??bridos te?m uma parte descrita na forma cont??nua e outra

parte descrita na forma discreta, sendo u?teis em aplicac?o?es de Controle Digital e

para Tratamento Digital de Sinais.

Modelos Lineares ou na?o-Lineares Um modelo e? dito linear se verifica o princ??pio

da superposic?a?o [9]. Caso contra?rio e? chamado de na?o-linear. De forma pra?tica,

um modelo e? dito linear se as varia?veis que o definem na?o aparecem na equac?a?o

sob a forma de func?o?es na?o lineares. Por exemplo, o modelo 2x?(t) + x(t) = u(t) e?

linear, ja? os modelos 2x?(t) + x2(t) = u(t) e 2x?(t) + x(t)u(t) = 0 sa?o na?o-lineares.

Modelos Causais ou Antecipativos Um modelo e? dito causal (ou na?o-

antecipativo) quando a sa??da do sistema no instante t na?o depende das

entradas aplicadas ao sistema apo?s o instante de tempo t. Um modelo e? dito

antecipativo (ou na?o-causal) quando a sa??da do sistema no instante t depende do

valor da entrada apo?s o instante de tempo t. Ainda que seja poss??vel representar

matematicamente um modelo antecipativo, nenhum sistema f??sico tem esta

caracter??stica. Portanto os modelos estudados sera?o sempre causais.

Modelos Auto?nomos ou na?o-Auto?nomos Modelos que na?o conte?m sinais de en-

trada dependendo explicitamente do tempo sa?o chamados de auto?nomos. As

entradas do modelo sa?o frequ?entemente chamadas de entradas exo?genas, onde

exo?gena significa que e? algo determinado fora do sistema considerado.

Modelos Monovaria?veis ou Multivaria?veis Sa?o chamados de monovaria?veis os

modelos que representam a relac?a?o entre uma entrada e uma sa??da. Na lite-

ratura sa?o conhecidos tambe?m por modelos SISO (single input single output).

Caso haja mais de uma entrada ou mais de uma sa??da os modelos passam a

ser chamados de multivaria?veis. Dentre estes, e? comum classifica?-los em: MISO

(multiple input single output) quando ha? va?rias entradas e somente uma sa??da;

SIMO (single input multiple output) para o caso em que ha? uma u?nica entrada e

mais de uma sa??da; e finalmente MIMO (multiple input multiple output) quando

ha? va?rias entradas e va?rias sa??das.

Modelos Determin??sticos ou Estoca?sticos Segundo Ljung [28], chama-se um mo-

delo de determin??stico se ele trabalha com uma relac?a?o exata entre as varia?veis

em ana?lise e se expressa sem incertezas. Por outro lado, um modelo e? estoca?stico

se ele tambe?m trabalha com conceitos de incerteza e probabilidade. Desta forma,



Modelagem de Sistemas Dina?micos 8

a sa??da de um modelo estoca?stico e? uma varia?vel aleato?ria. Na pra?tica, sem-

pre teremos algum grau de contaminac?a?o dos dados por ru??do ou incerteza na

medic?a?o, de forma que os modelos estoca?sticos sa?o mais adequados a? identificac?a?o

de sistemas.

2.3 Representac?o?es Lineares

As representac?o?es de um sistema tentam descrever da forma mais completa poss??vel

as caracter??sticas de um sistema. Pore?m, sempre existe algum grau de simplificac?a?o.

Quando se considera que a caracter??stica de entrada-sa??da de um sistema e? razoa-

velmente linear dentro de uma certa faixa de operac?a?o, utilizam-se as representac?o?es

lineares. As principais representac?o?es de sistemas lineares sa?o a resposta ao impulso,

a func?a?o de transfere?ncia, a resposta em frequ?e?ncia e as representac?o?es no espac?o de

estados, todas elas existentes no caso cont??nuo e no caso discreto. Descreve-se a seguir

a representac?a?o geral discreta e duas representac?o?es derivadas dela, particularmente

u?teis no contexto de identificac?a?o de sistemas: os modelos ARX e ARMAX.

2.3.1 Representac?a?o Geral Discreta

Um sistema linear de tempo discreto pode ser representado sob a forma geral:

A(q)y(k) =
B(q)

F(q)
u(k) +

C(q)

D(q)
?(k), (2.1)

onde q?1 e? o operador de atraso, u(k) e? entrada do sistema, y(k) e? a sa??da do sistema

e ?(k) e? um ru??do branco. O operador atraso e? um operador linear tal que:

q?1y(k) = y(k ? 1). (2.2)

As principais propriedades do operador de atraso sa?o discutidas em [16]. Os po-

lino?mios A(q),B(q),C(q),D(q) e F(q) sa?o definidos a seguir:

A(q) = 1 + a1q
?1 + · · · + anyq

?ny ;

B(q) = b0 + b1q
?1 + · · · + bnuq

?nu ;

C(q) = 1 + c1q
?1 + · · · + cn?q

?n? ;

D(q) = 1 + d1q
?1 + · · · + dndq

?nd ;

F(q) = 1 + f1q
?1 + · · · + fnf q

?nf . (2.3)



Modelagem de Sistemas Dina?micos 9

Os modelos derivados da forma geral discreta, como por exemplo os modelos ARX

e ARMAX, sa?o particularmente u?teis para a identificac?a?o de sistemas por existirem

diversos algoritmos para a estimac?a?o de seus para?metros.

2.3.2 Modelos AR e ARX

O modelo ARX, sigla de auto-regressivo com entradas exo?genas (do ingle?s - Au-

toRegressive with eXogenous inputs) e? obtido a partir da representac?a?o geral discreta

fazendo-se C(q) = D(q) = F(q) = 1 e arbitrando-se os polino?mios A(q) e B(q). Desta

forma, um modelo ARX possui a seguinte representac?a?o:

A(q)y(k) = B(q)u(k) + ?(k). (2.4)

Reagrupando-se os termos, temos:

y(k) =
B(q)

A(q)
u(k) +

1

A(q)
?(k). (2.5)

O modelo AR, ou modelo auto-regressivo, e? um caso particular do modelo ARX,

onde na?o existem entradas externas, ou seja, B(q) = 0. Assim:

A(q)y(k) = ?(k)

(1 + a1q
?1 + · · · + apq?p)y(k) = ?(k)

y(k) = ?(a1q?1 + · · · + apq?p)y(k) + ?(k)

y(k) = ?(a1y(k ? 1) + · · · + apy(k ? p)) + ?(k) (2.6)

Desta forma, a evoluc?a?o da se?rie representativa do sistema e? func?a?o apenas das

condic?o?es iniciais e do ru??do que incide sobre o sistema.

2.3.3 Modelos ARMA e ARMAX

O modelo ARMAX, sigla de autoregressivo com me?dia mo?vel e entradas exo?genas

(do ingle?s - AutoRegressive Moving Average with eXogenous inputs), e? obtido a par-

tir da representac?a?o geral discreta fazendo-se D(q) = F(q) = 1 e arbitrando-se os

polino?mios A(q), B(q) e C(q). Um modelo ARMAX tem a forma:

A(q)y(k) = B(q)u(k) + C(q)?(k). (2.7)



Modelagem de Sistemas Dina?micos 10

Reagrupando-se os termos, temos:

y(k) =
B(q)

A(q)
u(k) +

C(q)

A(q)
?(k). (2.8)

Os modelos do tipo ARMA (autoregressivos com me?dia mo?vel) sa?o um caso par-

ticular do modelo ARMAX, onde na?o existem entradas externas, ou seja, B(q) = 0.

Assim:

A(q)y(k) =C(q)?(k)

(1 + a1q
?1 + · · · + apq?p)y(k) =(1 + c1q?1 + · · · + cqq?q)?(k)

y(k) = ?(a1q?1 + · · · + anyq
?ny )y(k) + ?(k) + c1?(k ? 1) + · · · + cq?(k ? q). (2.9)

Os modelos do tipo ARMA podem ser utilizados quando a se?rie em ana?lise e? esta-

ciona?ria. De forma resumida, uma se?rie e? estaciona?ria quando possui me?dia e varia?ncia

constantes e sua covaria?ncia e? invaria?vel no tempo1. Entretanto muita se?ries temporais

na?o atendem a esses requisitos, como por exemplo a se?rie histo?rica do Produto Interno

Bruto (PIB) de um pa??s, sendo consideradas integradas.

Quando uma se?rie temporal for integrada de ordem 1 (tambe?m chamadas de se?rie

do tipo I(1)), suas primeiras diferenc?as sa?o do tipo I(0), ou seja, na?o-integradas ou

estaciona?rias. Assim, dada uma se?rie y do tipo I(1), fazendo-se:

?y(k) = y(k) ? y(k ? 1), (2.10)

temos que a se?rie ?y sera? estaciona?ria.

Da mesma forma, um processo do tipo I(2) tera? a sua segunda diferenc?a do tipo

I(0) que e? estaciona?ria. De forma gene?rica, um processo do tipo I(d ) podera? ser trans-

formado em estaciona?rio diferenciando-o d vezes.

Um modelo ARIMA (do tipo I(1)) e? enta?o um modelo ARMA da primeira diferenc?a

de um sinal. O “I” da sigla corresponde a? integrac?a?o discreta necessa?ria: a sa??da do

modelo ARMA deve ser integrada para chegar ao sinal original.

1Uma discussa?o mais detalhada sobre estacionariedade de se?ries pode ser vista em [7, 20]



Modelagem de Sistemas Dina?micos 11

2.4 Representac?o?es na?o-Lineares e

Modelos NARMAX

Observando os sistemas existentes na Natureza, pode-se dizer que a grande maio-

ria (talvez todos) sa?o na?o-lineares. No entanto, muitos deles podem ser considerados

lineares dentro de uma certa faixa de operac?a?o. Quando se esta? trabalhando fora desta

faixa, ou quando o sistema possui uma dina?mica na?o-linear muito forte, recomenda-se

a utilizac?a?o de uma representac?a?o na?o-linear do sistema. Segundo Aguirre [4], mais

do que melhorar a exatida?o dos modelos, o uso de representac?o?es na?o-lineares e? ne-

cessa?ria por possibilitar a representac?a?o de certos comportamentos dina?micos que na?o

sa?o poss??veis de serem descritos com o modelos lineares.

O leque de representac?o?es dispon??veis para sistemas na?o-lineares e? vasta, podendo

serem citadas, entre outras, os modelos NARMAX, a se?rie de Volterra, os modelos

de Hammerstein e de Wiener, modelos polinomiais cont??nuos, func?o?es de base radial e

redes neurais artificiais [1, 21]. Cada representac?a?o possui suas vantagens, desvantagens

e gama de aplicac?o?es, na?o sendo objetivo deste trabalho detalha?-las.

Os modelos NARMAX, sigla de na?o-linear auto-regressivo com me?dia mo?vel e en-

tradas exo?genas (Non-linear AutoRegressive Moving Average model with eXogenous

inputs), podem ser representados da seguinte maneira [25]:

y(k) = F[y(k ? 1), . . . ,y(k ?ny),u(k ? 1), . . . ,u(k ?nu),?(k),?(k ? 1), . . . ,?(k ?n? )],
(2.11)

onde F e? uma func?a?o na?o-linear, ny, nu e n? sa?o os maiores atrasos em y, u e ?,

respectivamente. Entretanto, a determinac?a?o da func?a?o F e? de grande dificuldade.

Um modelo NARMAX polinomial e? uma expansa?o da func?a?o F (equac?a?o 2.11) em

uma func?a?o polinomial com grau de na?o-linearidade `. Considera-se que o sistema na?o

tem atraso puro de tempo e que nenhum dos para?metros a ser estimado depende de

?(k). Assim, um modelo NARMAX polinomial e? dado por uma parte determin??stica

NARX, mais uma parte me?dia mo?vel contendo o erro. A aproximac?a?o polinomial de

grau ` e? descrita por [10]:

y(k) = ?0 +
n?

i1=1

?i1xi1 (k) +
n?

i1=1

n?
i2=i1

?i1i2xi1 (k) · xi2 (k) + . . .

+
n?

i1=1

· · ·
n?

il=il?1

?i1...ilxi1 (k) . . .xil (k) + ?(k) (2.12)



Modelagem de Sistemas Dina?micos 12

onde:

n = ny + nu

x1 = y(k ? 1)

x2 = y(k ? 2)
...

xny = y(k ? ny)

xny+1 = u(k ? 1)
...

xn = u(k ? nu) (2.13)

e ? sa?o para?metros constantes.

Ou seja, y(k) e? uma soma de termos com grau de na?o-linearidade m, com 1 ? m ? `.
Sendo p o grau de y e q o grau de u num dado termo, enta?o p + q = m ? `. O grau de
na?o-linearidade ` do modelo polinomial corresponde ao maior valor m dentre todos os

termos do modelo.

Para exemplificar, um modelo NARMAX representado por uma func?a?o F expandida

em um polino?mio com grau ` = 2, com ny = 2 e nu = 1 tem sua parte determin??stica

dada por:

y(k) = c0,0 + c1,0(1)y(k ? 1) + c1,0(2)y(k ? 2) + c0,1(1)u(k ? 1)

+ c2,0(1, 1)y
2(k ? 1) + c2,0(1, 2)y(k ? 1)y(k ? 2) + c2,0(2, 2)y2(k ? 2)

+ c1,1(1, 1)y(k ? 1)u(k ? 1) + c1,1(2, 1)y(k ? 2)u(k ? 1). (2.14)

A constante na forma cp,q(n1, . . . ,nm), vista na equac?a?o 2.14, representa a constante

que multiplica um termo onde os fatores em y possuem grau p, os fatores em u possuem

grau q e os valores ni representam os atrasos em cada um dos termos em y seguidos

dos atrasos nos termos em u.

Um fato interessante a ser notado no modelo NARMAX polinomial e? que apesar

de ser um modelo na?o-linear nas varia?veis, ele e? linear nos para?metros, sendo poss??vel

coloca?-lo na forma (ver sec?a?o 3.6.2):

y(k) = ?T (k)
~?
? + ?(k) (2.15)



Modelagem de Sistemas Dina?micos 13

que e? linear nos para?metros, facilitando a estimac?a?o destes. No caso do modelo

do exemplo anterior (equac?a?o 2.14), temos que o vetor de regressores e o vetor de

para?metros sa?o dados por:

?(k) =

?
???????????????????

1

y(k ? 1)
y(k ? 2)
u(k ? 1)
y2(k ? 1)

y(k ? 1)y(k ? 2)
y2(k ? 2)

y(k ? 1)u(k ? 1)
y(k ? 2)u(k ? 1)

?
???????????????????

,
~?
? =

?
???????????????????

c0,0

c1,0(1)

c1,0(2)

c0,1(1)

c2,0(1, 1)

c2,0(1, 2)

c2,0(2, 2)

c1,1(1, 1)

c1,1(2, 1)

?
???????????????????

. (2.16)

E? poss??vel, de forma ana?loga aos modelos ARIMA(X), utilizar modelos NA-

RIMA(X), correspondendo a modelos NARMA(X) da diferenciac?a?o de um sinal (ver

sec?a?o 2.3.3). Isso corresponderia a? existe?ncia de um ou mais integradores no modelo.

No entanto, na?o e? muito comum encontrar refere?ncias na literatura ao uso destes mo-

delos.

O uso da representac?a?o NARMAX pode ser justificada por va?rias razo?es, dentre as

quais [5, 23]:

• e? uma representac?a?o global, permitindo representar a dina?mica global do sistema
e na?o somente em torno a um ponto de equil??brio;

• consegue lidar com n??veis moderados de ru??do;

• informac?o?es anal??ticas sobre o modelo sa?o fa?ceis de se obter;

• e? poss??vel obter modelos NARMAX com bom ajuste aos dados desde que os dados
de sa??da na?o apresentem variac?o?es abruptas;

• algoritmos simples e robustos podem ser utilizados para a estimac?a?o de
para?metros (ja? que o modelo e? linear nos para?metros).

Entretanto, como o modelo e? linear nos para?metros, ele requer mais para?metros

para representar um sistema do que modelos que sa?o na?o-lineares nos para?metros,

como e? o caso de modelos NARMAX racionais [4].



Modelagem de Sistemas Dina?micos 14

Ale?m disso, comparando-se com modelos puramente lineares, fica claro que o

nu?mero de regressores candidatos acaba sendo muito maior nos modelos NARMAX

polinomiais do que nos modelos ARMAX (lineares), fazendo com que seja mais com-

plexa a tarefa de encontrar a estrutura ideal para o modelo.



Cap??tulo 3

Identificac?a?o de Sistemas

3.1 Introduc?a?o

A identificac?a?o de sistemas, ou modelagem emp??rica dedica-se a encontrar uma

relac?a?o matema?tica entre as entradas e as sa??das de um sistema, sem necessariamente

se ater a?s relac?o?es f??sicas que o regem. Mas por que utilizar identificac?a?o em um

sistema em vez de modela?-lo fisicamente? A modelagem f??sica permite obter um modelo

que pode ser “interpretado”: em geral ha? um significado teo?rico para cada um dos

para?metros e para a estrutura da equac?a?o. Com isso, e? mais fa?cil que o modelo acomode

eventuais alterac?o?es no sistema, bastando para isso atualizar um ou mais para?metros

do modelo. Pore?m, quando se trata de sistemas complexos e? por vezes dif??cil (ou

invia?vel) obter um modelo que descreva de forma satisfato?ria a interac?a?o entre todos

os subsistemas presentes. Recorre-se enta?o a? identificac?a?o de sistemas, que teve um

grande avanc?o nas u?ltimas de?cadas com a evoluc?a?o e o aumento na velocidade de ca?lculo

dos computadores.

O problema da identificac?a?o pode ser tratado como um problema de otimizac?a?o,

onde a func?a?o custo e? definida de forma a penalizar os modelos que na?o represen-

tem adequadamente as caracter??sticas de interesse do sistema. Va?rios fatores podem

influenciar a selec?a?o dos modelos e o ajuste dos para?metros [12]:

• Conhecimento a priori do sistema (na?o-linearidade, atraso de transporte, carac-
ter??stica esta?tica).

• Propriedades do modelo identificado (complexidade).



Identificac?a?o de Sistemas 16

• Selec?a?o da medida do erro a ser minimizado.

• Presenc?a de ru??dos.

A identificac?a?o pode ser feita considerando-se somente as se?ries de entrada e sa??da

do sistema, sem qualquer outra informac?a?o adicional, sendo neste caso chamada de

identificac?a?o caixa preta. Em alguns casos, dispo?em-se de dados adicionais sobre o

sistema, como por exemplo a caracter??stica esta?tica ou o diagrama de bifurcac?o?es.

Evidentemente seria um desperd??cio na?o utilizar essas informac?o?es para melhorar o

modelo. Chama-se de identificac?a?o caixa cinza aquela que busca incorporar dados

adicionais sobre o sistema, ale?m das informac?o?es obtidas das se?ries de entrada e sa??da.

Para executar a identificac?a?o de sistemas, faz-se uso de um conjunto de ferramen-

tas matema?ticas e estat??sticas. Este cap??tulo faz uma breve revisa?o do ferramental

dispon??vel, dando e?nfase a?quelas ferramentas utilizadas na identificac?a?o de modelos

ARMAX e NARMAX polinomiais, que sa?o utilizados no restante deste trabalho.

3.2 Etapas na identificac?a?o de Sistemas

A identificac?a?o de um sistema segue uma se?rie de passos de forma iterativa, ate?

que se encontre um modelo adequado ao uso previsto. Os principais passos podem ser

assim descritos [7]:

1. Determine uma classe de modelos adequada ao fim para o qual o modelo se

prestara?. Esta classe de modelos pode ser uma representac?a?o matema?tica do

tipo Func?a?o de Transfere?ncia, Rede Neural, ou um modelo do tipo ARMAX, por

exemplo.

2. Determine uma sub-classe dentro desta classe de modelos selecionada, ou seja,

determine a estrutura do modelo a ser usada. No caso de uma func?a?o de trans-

fere?ncia isso significa determinar o nu?mero de po?los e zeros, no caso de uma rede

neural significa determinar o nu?mero de camadas de neuro?nios e o nu?mero de

neuro?nios por camada.

3. Estime os para?metros do modelo com base nos dados dispon??veis.



Identificac?a?o de Sistemas 17

4. Valide o modelo, verificando se ele e? aplica?vel ao propo?sito previsto e descreve

adequadamente as caracter??sticas de interesse do sistema em ana?lise. Caso isso

na?o se verifique, retorne ao ciclo de determinac?a?o de estrutura, estimac?a?o dos

para?metros e validac?a?o do modelo.

Ale?m dos passos descritos acima, Aguirre [4] menciona mais um passo, logo no

in??cio, que consiste em testes dina?micos e coletas de dados. Neste passo sa?o escolhidos

o sinal de excitac?a?o do sistema, a forma de execuc?a?o do teste e o tempo de amostragem.

No caso de sistemas auto?nomos, este passo na?o faz tanto sentido, ja? que na?o ha? sinal

externo excitando o sistema. Eventualmente pode-se ter que retornar a? etapa de testes

dina?micos apo?s uma validac?a?o frustrada do modelo, devido, por exemplo, a um sinal

de teste mal projetado.

3.3 Func?o?es de Correlac?a?o

Define-se a Func?a?o de Correlac?a?o Cruzada (FCC) entre dois sinais u(t) e y(t) como

sendo:

ruy(?,t) = E[u(t)y(t + ?)]. (3.1)

Considerando-se o processo ergo?dico1 e estaciona?rio2 pode-se substituir a esperanc?a

matema?tica pela me?dia temporal e eliminar a depende?ncia da FCC com o tempo [4],

resultando, no caso discreto, em:

ruy(k) = lim
N??

1

2N + 1

N?
i=?N

u(i)y(i + k), (3.2)

com k ? Z.
1Um processo aleato?rio e? ergo?dico se existe equivale?ncia, para janelas longas de tempo, entre as

me?dias de conjunto e as me?dias temporais do processo. Em suma, ergodicidade implica que qualquer

realizac?a?o do processo estoca?stico sera? suficientemente “t??pica” ou, de outra maneira, as realizac?o?es

na?o diferem muito entre si
2Segundo Gujarati [20]: “a grosso modo, um processo estoca?stico e? estaciona?rio se suas me?dias e

varia?ncia forem constantes ao longo do tempo e o valor da covaria?ncia entre dois per??odos de tempo

depender apenas da dista?ncia ou defasagem entre os dois per??odos, e na?o do per??odo efetivo em que a

covaria?ncia e? calculada”. Estacionariedade, enta?o, implica em dizer que o processo esta? num estado

particular de equil??brio estat??stico [7].



Identificac?a?o de Sistemas 18

A Func?a?o de Correlac?a?o Cruzada entre dois sinais mede a depende?ncia temporal

entre eles, ou seja, o qua?o relacionados esta?o dois sinais no tempo. Para dois sinais

independentes no tempo, a FCC entre eles possuira? valores estatisticamente iguais

a zero para todos os valores de atraso (para todo k no caso discreto ou ? no caso

cont??nuo).

De forma ana?loga a? equac?a?o 3.1, a Func?a?o de Autocorrelac?a?o (FAC) de um sinal e?

definida como:

ruu(?,t) = E[u(t)u(t + ?)], (3.3)

podendo ser estimada no caso discreto atrave?s de:

ruu(k) = lim
N??

1

2N + 1

N?
i=?N

u(i)u(i + k), (3.4)

permitindo avaliar se os valores que um sinal adquire esta?o relacionados com os valores

anteriores ou posteriores do mesmo sinal. Um sinal aleato?rio satisfaz ruu(k) = 0,

?k 6= 0, pois se ele e? aleato?rio, na?o ha? nenhuma relac?a?o entre os valores da se?rie.

3.4 Projeto do Sinal de Teste

A escolha do sinal a ser utilizado na entrada do sistema que se deseja identificar

e? um fator que define criticamente a qualidade dos modelos obtidos. O sinal de en-

trada do sistema e? responsa?vel por excitar as dina?micas internas do sistema na faixa de

operac?a?o desejada. Um sinal mal projetado pode, por um lado, na?o revelar o comporta-

mento do sistema num dado regime de operac?a?o ou, por outro lado, trazer informac?o?es

indesejadas de fora deste regime.

Tipicamente deseja-se que a func?a?o de autocorrelac?a?o (equac?a?o 3.4) do sinal de

entrada utilizado seja nula para todos os valores de k 6= 0. Dois tipos de sinais que
satisfazem essa condic?a?o sa?o os sinais aleato?rios e os pseudo-aleato?rios. O uso de sinais

aleato?rios ou pseudo-aleato?rios para identificac?a?o pode ser justificada de duas maneiras:

uma delas e? que a estimac?a?o de para?metros envolve a inversa?o de uma matriz e quanto

menos variar o sinal u(k), mais mal-condicionada sera? esta matriz, ja? que duas colunas

contendo regressores do tipo u(k ? i) sera?o muito parecidas (sera?o quase linearmente
dependentes). Outro motivo e? que um sinal aleato?rio possui pote?ncia espectral numa

grande faixa de frequ?e?ncias. Em particular para a identificac?a?o linear isto e? interessante



Identificac?a?o de Sistemas 19

pois, num sistema linear, as frequ?e?ncias presentes na sa??da sera?o aquelas da entrada.

Assim, um sistema excitado por um sinal aleato?rio tera? energia suficiente na faixa

de frequ?e?ncias desejada para que elas se revelem na sa??da. Para sistemas lineares,

sa?o frequ?entemente utilizados sinais pseudo-aleato?rios do tipo PRBS (Pseudo Random

Binary Signal ). Ja? para sistemas na?o-lineares, prefere-se utilizar sinais aleato?rios [4].

Segundo Brosilow [8], algumas vantagens de usar sinais do tipo PRBS sa?o:

• Um sinal PRBS perturba o sistema em torno de um ponto de operac?a?o em regime
permanente, sem desvia?-lo significativamente deste valor. Esta e? uma vantagem

pois permite que o sistema continue funcionando na sua regia?o de operac?a?o en-

quanto e? feita a identificac?a?o, o que e? particularmente importante em processos

lentos, onde a execuc?a?o dos testes requer um tempo longo (como e? o caso do poc?o

de petro?leo operando por elevac?a?o artificial tipo injec?a?o cont??nua de ga?s, que sera?

estudado no cap??tulo 4);

• O conteu?do frequ?encial de um sinal PRBS pode ser ajustado facilmente para
atender as especificac?o?es sobre qual faixa de frequ?e?ncias se deseja excitar;

• Sinais PRBS podem ser repetidos muitas vezes (e va?rios ensaios podem ser feitos),
o que pode aumentar a precisa?o das estimativas.

Ljung [28] sugere inicialmente aplicar uma entrada do tipo degrau no sistema, para

obter uma impressa?o geral sobre as constantes de tempo do sistema. Desta forma evita-

se aplicar um sinal que seja ta?o “ra?pido” que o sistema na?o tenha tempo de responder

a ele. Aguirre [4] fornece uma heur??stica mais precisa, sugerindo que apo?s definir o

tempo de amostragem do sistema, manter constante cada valor aleato?rio por 3 a 5

per??odos de amostragem, e no caso de sinais PRBS, fazer com que o menor patamar

do sinal dure de 3 a 5 per??odos de amostragem.

Outro fator a ser determinado no projeto do sinal de teste e? a amplitude do sinal

de entrada, sendo ela responsa?vel por levar o sistema a diferentes regio?es de operac?a?o.

No caso linear, busca-se que a amplitude seja a menor poss??vel para na?o excitar as

na?o-linearidades do sistema (mas que seja grande o suficiente para garantir uma boa

relac?a?o sinal-ru??do). Ja? no caso na?o-linear, a amplitude do sinal deve ser projetada

para levar o sistema a?s regio?es de operac?a?o onde se deseja proceder a identificac?a?o.



Identificac?a?o de Sistemas 20

3.5 Determinac?a?o do per??odo de amostragem

O per??odo de amostragem (Ts) de um sistema corresponde ao intervalo de tempo

decorrido entre duas amostras e sua escolha tem grande impacto na qualidade dos mo-

delos identificados. Um per??odo de amostragem muito grande significa que ao amostrar

um sinal, uma parte da dina?mica do sistema na?o esta? sendo registrada. Ja? um per??odo

de amostragem muito pequeno resulta em mal condicionamento nume?rico no problema

de identificac?a?o. A raza?o deste mal-condicionamento nume?rico e? que ha? pouca diferenc?a

no valor de y(kTs) para y((k + 1)Ts), onde k e? o valor do instante de tempo discreto.

Assim, na equac?a?o 3.30, as colunas da matriz ? sera?o muito parecidas (quando Ts ? 0,
y(kTs) = y ((k + 1)Ts)), causando problema na inversa?o da matriz da equac?a?o 3.31.

Sendo ?s a frequ?e?ncia de amostragem dada em radianos por segundo (?s = 2?/Ts)

e ?max a maior frequ?e?ncia que compo?e um sinal y(t), o teorema de Shannon afirma

que e? poss??vel reconstruir o sinal y(t) a partir do sinal amostrado y(kTs), desde que

?s &gt; 2 ?max. Na pra?tica, entretanto, costuma-se utilizar a frequ?e?ncia de amostragem

de 5 a 10 vezes maior do que a maior frequ?e?ncia do sistema (5 ?max &amp;lt;?s &amp;lt;10 ?max).

Ale?m disso, pode-se utilizar um filtro para eliminar os componentes de frequ?e?ncia mais

elevadas que eventualmente existam, de forma a evitar o aliasing3 do sinal.

Um problema existente para a aplicac?a?o da heur??stica acima e? que, em geral, na?o se

conhece o valor de ?max a priori. Uma estrate?gia utilizada e? amostrar o sinal y(t) com

uma frequ?e?ncia muito maior do que a necessa?ria e posteriormente reamostrar o sinal

convenientemente, conforme descrito em [4] e apresentado, resumidamente, a seguir.

Dado um sinal amostrado y?(k), calcula-se as func?o?es de autocovaria?ncia:

ry?(?) = E
[(
y?(k) ? y?(k)

)(
y?(k ? ?) ? y?(k)

)]
, (3.5)

ry?2 (?) = E
[(
y?2(k) ? y?2(k)

)(
y?2(k ? ?) ? y?2(k)

)]
, (3.6)

onde E[·] e? a esperanc?a matema?tica, y?(k) e? a me?dia de y?(k) e y?2(k) e? a me?dia do
quadrado de y?(k).

O uso das func?o?es de autocovaria?ncia linear (equac?a?o 3.5) e na?o-linear (equac?a?o 3.6)

visa quantificar o quanto de redunda?ncia existe nas amostras feitas do sinal original.

Determinam-se os m??nimos de ry?(?) e ry?2 (?), correspondendo a ?y? e ?y?2 respectiva-

3Para uma descric?a?o do feno?meno de aliasing, sugere-se a leitura do cap??tulo 3 de [30]



Identificac?a?o de Sistemas 21

mente. E? deseja?vel que no caso linear a seguinte relac?a?o seja satisfeita:

10 ? ?y? ? 20 (3.7)

e no caso na?o-linear:

10 ? min(?y?,?y?2 ) ? 20. (3.8)

Para que tal objetivo seja alcanc?ado, busca-se determinar uma taxa de reamostra-

gem ? ? N tal que y(k) = y?(?k). A escolha de ? deve permitir a y(k) satisfazer as
equac?o?es 3.7 e 3.8. Vale notar que as func?o?es de autocovaria?ncia de y(k) e de y?(k)

sera?o as mesmas, exceto pelo fator de escala ?. Assim, ? deve ser escolhido de forma

a satisfazer:
?y?

20
? ? ?

?y?

10
(3.9)

para o caso linear ou
min(?y?,?y?2 )

20
? ? ?

min(?y?,?y?2 )

10
(3.10)

para o caso na?o-linear.

3.6 Estimac?a?o de Para?metros

Uma vez definida a estrutura de um modelo, passa-se a? etapa de estimac?a?o de

para?metros, que consiste em determinar os valores dos para?metros de uma equac?a?o,

com base em dados de entrada e sa??da do sistema real. Esta estimac?a?o pode ser vista

como um problema de otimizac?a?o, onde se busca o vetor de para?metros que minimize

uma certa func?a?o custo. Faz-se a seguir uma breve revisa?o do estimador de m??nimos

quadrados - um dos estimadores mais utilizados - de onde derivam va?rios outros estima-

dores. Em seguida comenta-se o seu uso para identificac?a?o de para?metros de modelos

auto-regressivos. Finalmente trata-se o problema da polarizac?a?o das estimativas e como

contorna?-lo.

3.6.1 O Estimador de M??nimos Quadrados (MQ)

Considere uma func?a?o escalar y = f(~x,~?), onde y e? a varia?vel dependente, ~x e? um

vetor de varia?veis independentes (ou regressoras) e ~? e? um vetor contendo os para?metros

da func?a?o f.



Identificac?a?o de Sistemas 22

Tomando-se um conjunto de n aplicac?o?es da func?a?o f podemos montar o seguinte

conjunto de equac?o?es:

y1 = f( ~x1,~?)

y2 = f( ~x2,~?)

... =
...

yN = f( ~xN,~?). (3.11)

Cada uma das equac?o?es 3.11 e? chamada de uma restric?a?o da func?a?o f, desta forma,

3.11 forma um conjunto de N restric?o?es da func?a?o f.

Considerando-se que a func?a?o f seja linear e que f e ~? permanec?am os mesmos em

todas as N restric?o?es, podemos reescrever a equac?a?o 3.11 como:?
??????
y1

y2
...

yN

?
?????? =

?
??????

~x1
T

~x2
T

...

~xN
T

?
??????

?
??????
?1

?2
...

?n

?
?????? , (3.12)

onde a func?a?o f possui n para?metros, dados por ?i (com i = 1, 2, . . . ,n) e

~xk
T = [ xk1 xk2 . . . xkn ], com k = 1, 2, . . . ,N, e? um vetor com n regressores. Po-

demos reescrever a equac?a?o 3.12 da seguinte maneira:?
??????
y1

y2
...

yN

?
?????? =

?
??????
x11 x12 . . . x1n

x21 x22 . . . x2n
...

...
...

xN 1 xN 2 . . . xN n

?
??????

?
??????
?1

?2
...

?n

?
?????? ,

~y = X~?. (3.13)

No caso em que n = N, ou seja, quando existem o mesmo nu?mero de restric?o?es que

de para?metros, pode-se encontrar o vetor de para?metros do sistema fazendo-se:

~? = X?1~y, (3.14)

desde que X seja na?o singular.

Por exemplo, supondo que temos dois pontos P1 e P2 em R2 dados pelas coordenadas
Pi = (xi,yi), sendo: P1 = (1, 2) e P2 = (2, 3). Deseja-se encontrar a reta que melhor se

ajusta a estes pontos.



Identificac?a?o de Sistemas 23

A equac?a?o de uma reta e? dada por:

y = ?1 + ?2x. (3.15)

Assim, podemos escrever o conjunto de restric?o?es como sendo:

2 = ?1 + ?2,

3 = ?1 + 2?2. (3.16)

Na forma matricial, com o formato da equac?a?o 3.13 temos:[
2

3

]
=

[
1 1

1 2

][
?1

?2

]
. (3.17)

Pode-se encontrar o vetor de para?metros ~? = [ ?1 ?2 ]
T com o uso da equac?a?o 3.14,

resultando em ~? = [ 1 1 ]T e, por consequ?e?ncia, y = 1 + x.

A soluc?a?o da equac?a?o matricial 3.13 possui tre?s casos:

• Quando posto(X) = posto( [X ~y] ) = n, o sistema possui uma soluc?a?o u?nica, que
e? o caso da equac?a?o 3.17;

• Quando posto(X) = posto( [X ~y] ) &amp;lt;n, o sistema possui infinitas soluc?o?es;

• Finalmente, quando posto(X) &amp;lt;posto( [X ~y] ), o sistema na?o possui soluc?a?o.

Por exemplo, tomando-se um conjunto de N = 12 pontos mostrados na figura 3.1,

na?o conseguimos encontrar uma reta que passe por todos os pontos do gra?fico. Em

geral procura-se uma reta que melhor se encaixe aos pontos apresentados. Para cada

ponto, havera? uma dista?ncia ? entre a reta e o ponto em questa?o, conforme mostrado

na figura 3.1, sendo essa dista?ncia chamada de res??duo. O res??duo corresponde ao erro

que o modelo encontrado comete em descrever a varia?vel y. Para cada restric?a?o i (com

i = 1, 2, . . . ,N), o res??duo ?i e? definido como:

?i = yi ? [ xi1 xi2 . . . xin ]

?
??????
??1

??2
...

??n

?
?????? ,

?i = yi ? ~xiT
~?
?, (3.18)



Identificac?a?o de Sistemas 24

Figura 3.1: Exemplo de res??duos na equac?a?o de uma reta

onde o acento circunflexo em ?? indica que estamos tratando de uma estimativa dos

para?metros.

Pode-se escrever os res??duos numa equac?a?o matricial, levando-se em considerac?a?o

todas as restric?o?es, da seguinte forma:?
??????
?1

?2
...

?N

?
?????? =

?
??????
y1

y2
...

yN

?
?????? ?

?
??????
x11 x12 . . . x1n

x21 x22 . . . x2n
...

...
...

xN 1 xN 2 . . . xN n

?
??????

?
??????
??1

??2
...

??n

?
?????? ,

~? = ~y ? X~??. (3.19)

O me?todo dos m??nimos quadrados busca minimizar o somato?rio do quadrado dos

res??duos, sendo o somato?rio do quadrado dos res??duos definido por:

JM Q =
N?

i=1

?(i)2 = ? ~? ?2 = ~? T ~? (3.20)

Substituindo-se a equac?a?o 3.19 na equac?a?o 3.20 temos:

JM Q = (~y ? X
~?
?)T (~y ? X~??). (3.21)



Identificac?a?o de Sistemas 25

Para minimizar a func?a?o de custo JM Q em relac?a?o a
~?
? deve-se fazer:

?JM Q

?
~?
?

= 0. (3.22)

O que se consegue com [4]:

~?
? = [XT X]?1XT ~y, (3.23)

que fornece uma estimativa para o vetor de para?metros, com base em um conjunto de

restric?o?es do modelo proposto, minimizando-se o somato?rio do quadrado dos res??duos.

E? interessante notar que [XT X]?1 existe se e somente se X tem posto completo, ou

seja, se posto(X) = n.

Pode-se ainda escrever a estimativa dos para?metros, de uma forma mais geral:

~?
? = A~y, (3.24)

onde A e? o estimador utilizado. No caso do estimador de m??nimos quadrados,

A = [XT X]?1XT .

3.6.2 O Me?todo de MQ Usado Para Estimar Para?metros de

Modelos Autoregressivos

Considere um modelo do tipo ARX como o mostrado na equac?a?o 2.4, com um atraso

de transporte na entrada de tal forma que a entrada u so? passe a afetar a sa??da y a partir

do instante de tempo discreto nk, ou seja, que os coeficientes b0 = . . . = bnk?1 = 0.

Expandindo-se os polino?mios e rearranjando-se os termos, temos que:

y(k) = a1y(k ? 1) + · · · + anyy(k ? ny)

+ bnku(k ? nk) + b1+nku(k ? nk ? 1) + · · · + bnu+nku(k ? nk ? nu) + ?(k).
(3.25)



Identificac?a?o de Sistemas 26

Comparando-se a equac?a?o 3.25 com a equac?a?o 3.18 e isolando-se y(k), temos que:

y(k) =
[
y(k ? 1) · · · y(k ? ny) u(k ? nk) · · · u(k ? nk ? nu)

]
?
????????????

a1
...

any

bnk
...

bnu+nk

?
????????????

+ ?(k),

y(k) = ?T (k)
~?
? + ?(k), (3.26)

onde ?T (k) =
[
y(k ? 1) . . . y(k ? ny) u(k ? nk) . . . u(k ? nk ? nu)

]
e? o vetor

com os regressores e
~?
? =

[
a1 · · · any bnk · · · bnk+nu

]T
e? o vetor com os para?metros

a serem estimados, ambos com dimensa?o n? = ny + nu.

Tomando-se um conjunto de N restric?o?es, forma-se a equac?a?o matricial:?
??????
y1

y2
...

yN

?
?????? =

?
??????
?T1

?T2
...

?TN

?
??????

?
??????

??1

??2
...

??n?

?
?????? +

?
??????
?1

?2
...

?N

?
??????

~y = ?
~?
? + ~?. (3.27)

Por exemplo, supondo um modelo ARX com ny = 2, nu = 2 e nk = 1, a equac?a?o

que representa o modelo sera?:

y(k) = a1y(k ? 1) + a2y(k ? 2) + b1u(k ? 1) + b2u(k ? 2) + ?(k), (3.28)

ou ainda:

y(k) =
[
y(k ? 1) y(k ? 2) u(k ? 1) u(k ? 2)

]
?
??????
a1

a2

b1

b2

?
?????? + ?(k). (3.29)

Tomando-se uma massa de dados, podemos escrever um conjunto de restric?o?es sob



Identificac?a?o de Sistemas 27

a forma: ?
??????
y(0)

y(1)

y(2)
...

?
?????? =

?
??????
y(?1) y(?2) u(?1) u(?2)
y(0) y(?1) u(0) u(?1)
y(1) y(0) u(1) u(0)

...
...

...

?
??????

?
??????
a1

a2

b1

b2

?
?????? +

?
??????
?(0)

?(1)

?(2)
...

?
?????? ,

~y = ?
~?
? + ~?, (3.30)

que e? ana?loga a? equac?a?o 3.19. Assim, a estimativa dos para?metros de um modelo

auto-regressivo e?:

~?
? = [?T ?]?1?T ~y. (3.31)

3.6.3 Polarizac?a?o de Estimadores

Seja ~? um vetor de para?metros “real” que define um sistema e
~?
? o seu valor estimado.

Define-se a polarizac?a?o (tambe?m conhecida por vie?s ou bias) como:

~b = E[
~?
?] ? ~?. (3.32)

Deve-se notar que ~? e? um valor determin??stico, ainda que desconhecido, e
~?
? e? uma

varia?vel aleato?ria, possuindo valores diferentes para cada realizac?a?o, sendo por isso

usada a esperanc?a matema?tica para o ca?lculo da polarizac?a?o b.

Dado um modelo do tipo y(k) = ?T (k)~? + e(k), linear em ~? (onde e(k) e? um erro

aleato?rio introduzido no sistema) pode-se estimar os para?metros deste modelo com

um estimador do tipo
~?
? = A~y, como mostrado na equac?a?o 3.24. A matriz A e? uma

matriz que depende dos elementos da matriz de regressores (A = [?T ?]?1?T no caso

do estimador de m??nimos quadrados). Substituindo-se a equac?a?o 3.24 na equac?a?o 3.32

e manipulando-a, chega-se a:

~b = (E[A? ? I]) ~? + E[A~e]. (3.33)

Para que a polarizac?a?o do estimador seja nula (~b = 0 na equac?a?o 3.33) deve-se

atender aos seguintes requisitos [4]:

1. A matriz A deve ser tal que A? = I.



Identificac?a?o de Sistemas 28

2. Os elementos de A na?o devem estar correlacionados com o vetor de erro ~e, de

forma que se possa dizer que E[A~e] = E[A]E[~e].

3. O erro deve ter me?dia zero, ou seja, E[~e] = 0.

No caso do estimador de m??nimos quadrados, a matriz A = [?T ?]?1?T . Portanto

o primeiro requisito listado e? atendido. Se o erro que incide sobre o sistema na?o tiver

me?dia nula (terceiro requisito), basta acrescentar um termo constante a ser estimado

junto com os outros para?metros. Desta forma, o requisito mais importante a ser avali-

ado para o estimador de MQ e? o segundo, ou seja, os elementos de A na?o devem estar

correlacionados com o vetor de erro ~e. Esses requisitos sa?o todos atendidos quando o

ru??do e(k) e? branco.

As representac?o?es ARMAX e NARMAX sa?o duas representac?o?es que sofrem com

a polarizac?a?o, ou seja, os para?metros estimados pelo estimador de m??nimos quadrados

sera?o sistematicamente diferentes dos para?metros reais do sistema. Para contornar

este problema, recorre-se aos estimadores na?o-polarizados que de alguma forma tentam

transformar a equac?a?o de regressa?o, fazendo com que o vetor de erros passe a ser branco

e, assim, seja poss??vel utilizar o me?todo dos m??nimos quadrados originalmente descrito.

Dentre tais estimadores na?o polarizados, podemos citar o Estimador Estendido de

M??nimos Quadrados (EMQ), o Estimador Generalizado de M??nimos Quadrados (GMQ)

e o Me?todo das Varia?veis Instrumentais (VI), todos eles descritos em [4].

3.7 Crite?rios de Informac?a?o

Uma vez que tenham sido gerados diversos modelos para um sistema, e? necessa?rio

compara?-los para ver qual deles e? o mais adequado para o uso em questa?o. Uma das

formas de verificar a adequac?a?o de um modelo e? verificar o qua?o bem ele se encaixa

aos dados utilizados para estimar os para?metros. E? claro que aumentando-se o nu?mero

de para?metros do modelo, o nu?mero de graus de liberdade do modelo aumenta e,

por consequ?e?ncia, ele passa a se “encaixar” melhor nos dados. No limite, quando

temos o mesmo nu?mero de para?metros que de restric?o?es, a matriz de regressores ?

passa a ser quadrada e pode-se calcular o vetor de para?metros diretamente, resolvendo-

se um sistema linear. Um modelo sub-parametrizado possui menos para?metros do

que os necessa?rios para representar a dina?mica do sistema e e? incapaz de descreve?-la



Identificac?a?o de Sistemas 29

adequadamente. Ja? um modelo sobre-parametrizado acaba descrevendo mais do que

a dina?mica do sistema, passando a descrever tambe?m a realizac?a?o espec??fica do ru??do

que incidiu sobre o sistema durante o ensaio, na?o sendo suficientemente gene?rico. Ou

seja, um modelo sobre-parametrizado seria inu?til diante de uma realizac?a?o diferente do

ru??do. O modelo ideal situa-se enta?o na fronteira entre um modelo sub-parametrizado

e de um modelo sobre-parametrizado.

Para decidir se o nu?mero de para?metros utilizados em determinado modelo e? o

ideal, pode-se recorrer aos crite?rios de informac?a?o. Eles atribuem um ??ndice ao modelo,

penalizando por um lado o mal ajuste aos dados e por outro o excesso de para?metros. O

modelo ideal sera? aquele com o menor valor do crite?rio de informac?a?o utilizado dentre

todos os modelos candidatos.

O Crite?rio de Informac?a?o de Akaike (AIC - do ingle?s Akaike Information Criterium)

[6] e? definido por:

AIC(n?) = N ln(?
2
erro) + 2n?, (3.34)

onde n? e? o nu?mero de para?metros do modelo, N e? o nu?mero de restric?o?es e ?
2
erro e? a

varia?ncia do erro de modelagem (varia?ncia dos res??duos). O valor de AIC sera? maior

(pior) quanto maior for a varia?ncia do erro de modelagem (o modelo na?o se ajusta bem

aos dados), ou quando mais para?metros tiver um modelo (maior a sua complexidade).

Leontaritis e Billings [26] argumentam que o crite?rio de Akaike pode levar a? escolha

de modelos sobre-parametrizados, propondo que em vez dele se utilize uma equac?a?o

similar, mas que penalize de forma mais dura o nu?mero de termos do modelo:

C(n?) = N ln(?
2
erro) + 4n?, (3.35)

no entanto o AIC e? largamente utilizado na identificac?a?o de sistemas e sera? utilizado

neste trabalho tal como mostrado na equac?a?o 3.34.

Outro crite?rio similar e? o Erro Final de Predic?a?o, ou em ingle?s, Final Prediction

Error (FPE) [6], definido por:

FPE(n?) = N ln(?
2
erro) + N ln

(
N + n?
N ? n?

)
. (3.36)

O valor absoluto dos ??ndices dados pelas equac?o?es 3.34 e 3.36 na?o e? importante. O

que e? importante e? encontrar dentre um conjunto de modelos candidatos aquele que

possui o valor m??nimo para o ??ndice em ana?lise. Deve-se lembrar que estes sa?o crite?rios

estat??sticos para definir o nu?mero de para?metros e na?o garantem que o modelo escolhido

seja o?timo em termos de validade para a aplicac?a?o pretendida.



Identificac?a?o de Sistemas 30

3.8 Ferramentas Utilizadas na Identificac?a?o de Sis-

temas na?o-Lineares

Um modelo do tipo NARMAX polinomial e? um modelo na?o-linear na relac?a?o entre a

entrada e a sa??da, mas e? linear nos para?metros, de forma que pode-se utilizar a equac?a?o

matricial 3.27. Os vetores que compo?em a matriz ? sa?o mostrados na equac?a?o 2.16.

Caso o conjunto de termos do modelo seja pequeno, a matriz ? tera? poucas colunas

e portanto e? poss??vel encontrar o valor de
~?
? com a aplicac?a?o da equac?a?o 3.31. Deve

ser notado que da entrada e sa??da utilizadas na estimac?a?o de para?metros de modelos

NARMAX na?o se desconta a me?dia dos dados, tal como feito na identificac?a?o linear

(onde se trabalha com ?y(k) = y(k) ? y0 e ?u(k) = u(k) ? u0), trabalhando-se com
os dados colhidos na entrada (u(k)) e sa??da (y(k)) do sistema diretamente [23].

No entanto, tipicamente o nu?mero de termos candidatos para um modelo NARMAX

e? grande, levando a um problema de mal condicionamento nume?rico. Assim, utilizam-se

algoritmos alternativos para a estimac?a?o dos para?metros. Segundo Chen et al [11], ha?

tre?s maneiras via?veis para determinar
~?
?: solucionar a equac?a?o normal por eliminac?a?o

gaussiana ou formando a decomposic?a?o de Cholesky de ?T ?; formar uma decomposic?a?o

ortogonal de ?; ou formar uma decomposic?a?o de valores singulares (SVD) de ?. Cada

um dos tre?s me?todos possui suas vantagens e desvantagens. Neste trabalho utiliza-se

a decomposic?a?o ortogonal de ?, que e? o me?todo mais preciso, ainda que a?s custas de

um maior esforc?o computacional.

A sec?a?o 3.8.1 fala sobre a decomposic?a?o ortogonal de ? e a sec?a?o 3.8.2 mostra

uma alterac?a?o no algoritmo de ortogonalizac?a?o que permite classificar os regressores

por ordem de importa?ncia, servindo como ferramenta para a selec?a?o de estrutura do

modelo. Em seguida sa?o definidos os coeficientes de agrupamento (sec?a?o 3.8.3) e seu

uso no ca?lculo da caracter??stica esta?tica dos modelos (sec?a?o 3.8.4).

3.8.1 Algoritmos MQ Ortogonais

A ortogonalizac?a?o da matriz ? pode ser feita com va?rios algoritmos, como por

exemplo atrave?s do me?todo cla?ssico de Gram-Schmidt (CGS), do me?todo modificado

de Gram-Schmidt e atrave?s da transformac?a?o de Householder. A descric?a?o destes

algoritmos pode ser vista em [19] e [34]. A aplicac?a?o destes me?todos para modelos



Identificac?a?o de Sistemas 31

NARMAX e? mostrada em [11]. A seguir descreve-se o me?todo da transformac?a?o de

Householder utilizada neste trabalho.

Sendo ? uma matriz de dimensa?o N ×n? com posto pleno de colunas, ela pode ser
decomposta em:

? = QR, (3.37)

onde Q e? uma matriz ortogonal (QT Q = I) com dimensa?o N × n? e R e? uma matriz
triangular superior com dimensa?o n? × n?.

Forma-se enta?o a matriz Q? expandindo-se a matriz Q com (N ? n?) colunas orto-
normais, de forma a gerar um conjunto de N vetores ortogonais:

Q? = [Q : q?n?+1 . . . q?N ]. (3.38)

Assim:

? = Q?R? = Q?

[
R

0

]
(3.39)

Aplicando-se Q?T ao vetor contendo a sa??da do sistema (~y), encontramos:

Q?T ~y =

[
~y1

~y2

]
, (3.40)

onde ~y1 e? um vetor com n? elementos e ~y2 e? um vetor com (N ? n?) elementos.

Reescrevendo-se a equac?a?o 3.30 e calculando-se a norma, obte?m-se:

? ~? ? = ?~y ? ?~?? ?. (3.41)

Das equac?o?es 3.41 e 3.20, chega-se a:

JM Q = ? ~? ? = ?~y ? ?
~?
? ? (3.42)

Multiplicando ambos os lados da equac?a?o 3.42 por ?Q?T ? e manipulando-a:

JM Q = ?Q?T ~y ? R
~?
? ? (3.43)

Finalmente, recorrendo-se a? equac?a?o 3.40:

JM Q = ?~y1 ? R
~?
? ? + ?~y2 ?. (3.44)



Identificac?a?o de Sistemas 32

A estimativa que minimiza o crite?rio de m??nimos quadrados descrito na equac?a?o

3.44 pode ser enta?o obtida solucionando-se o sistema triangular:

R
~?
? = ~y1 (3.45)

e a soma do quadrado dos res??duos (JM Q) sera? enta?o ?~y2 ?.

Antes de mostrar como se chega a? matriz Q?T , conve?m definir a matriz de regressores

modificada ??:

?? = [? : ~y ], (3.46)

que e? formada pelas colunas da matriz ?, tendo sido adicionada como u?ltima coluna

o vetor ~y. Ao iniciar o algoritmo, a matriz ??(0) = ??, e com a aplicac?a?o da k-e?sima

transformac?a?o de Householder (H(k)) sera?o obtidas as matrizes ??(1) = H(1)??(0), ??(2) =

H(2)??(1) e assim por diante.

A matriz Q?T pode ser encontrada calculando-se:

Q?T = H(?)H(??1) . . . H(1) (3.47)

sendo a k-e?sima transformac?a?o de Householder dada por:

H(k) = I ? ?(k)~v (k)(~v (k))T , (3.48)

com

?(k) =

???? N?
i=k

(??
(k?1)
ik )

2 (3.49)

?(k) =
1

?(k)(?(k) + |??(k?1)kk |)
(3.50)

~v (k) = [v
(k)
1 . . . v

(k)
N ]

T (3.51)

v
(k)
i =

????
???

0, para i &amp;lt;k

??
(k?1)
kk + sgn[??

(k?1)
kk ]?

(k), para i = k

??
(k?1)
ik , para i &gt; k

, (3.52)

sendo ??ij o elemento da matriz ?? situado na i-e?sima linha e j-e?sima coluna.



Identificac?a?o de Sistemas 33

A aplicac?a?o de ? transformac?o?es de Householder a? matriz ?? (ver equac?a?o 3.47)

permite chegar a? matriz ??(?):

??(?) = Q?T ??(0) =

[
R ~y1

0 ~y2

]
(3.53)

que possibilita solucionar o problema de estimac?a?o de para?metros bastando para isso

solucionar o sistema linear triangular dado na equac?a?o 3.45.

Conve?m notar que a matriz Q?T na?o precisa necessariamente ser calculada, ja? que

nos interessa somente o valor de ??(?) e esse pode ser calculado iterativamente com o

uso da equac?a?o:

??(k) = H(k)??(k?1) k = 1, . . . ,?. (3.54)

3.8.2 A Taxa de Reduc?a?o de Erro

Os algoritmos de m??nimos quadrados ortogonais sa?o de grande utilidade por permi-

tir contornar os problemas de mal condicionamento geralmente existentes no problema

de estimac?a?o de para?metros de modelos NARMAX polinomiais. Ale?m disso, uma mo-

dificac?a?o no algoritmo permite detectar dentre o conjunto de regressores candidatos,

quais sa?o os realmente importantes para explicar a sa??da em func?a?o da entrada.

Dado um modelo NARMAX descrito por (ver equac?a?o 2.15):

y(k) =

n??
i=1

??i?i(k) + ?(k), (3.55)

onde ??i sa?o os para?metros associados aos regressores ?i(k) (com i = 1, . . . ,n?), avaliados

no instante de tempo k, pode-se derivar um modelo auxiliar:

y(k) =

n??
i=1

g?iwi(k) + ?(k), (3.56)

onde g?i e? o para?metro associado ao regressor ortogonal wi (com i = 1, . . . ,n?).

Tomando um conjunto de N restric?o?es para a equac?a?o 3.56 (fazendo-se k =

1, . . . ,N), pode-se escrever a equac?a?o matricial:

~y = W~?g + ~?. (3.57)



Identificac?a?o de Sistemas 34

A soma dos quadrados da varia?vel dependente ~y e? enta?o [11]:

N?
i=1

y(k)2 = ~y T ~y = ?~y,~y? =
n??
i=1

g2i ?~wi, ~wi? + ?~?, ~?? (3.58)

onde ?·, ·? significa o produto interno.

A Taxa de Reduc?a?o de Erro (Error Reduction Ratio - ERR) e? enta?o definida como:

[ERR]i =
g2i ?~wi, ~wi?
?~y,~y?

(3.59)

e representa a frac?a?o da sa??da que a inclusa?o do i-e?simo regressor consegue descrever.

Quanto maior for o ERR de um termo, maior a sua importa?ncia para o modelo. Termos

com ERR baixo na?o contribuem significativamente para o modelo e podem ser exclu??dos

do modelo final. Assim, pode-se determinar a estrutura de um modelo escolhendo

aqueles termos que possuem os maiores valores de ERR.

O me?todo de Householder descrito na sec?a?o 3.8.1 pode ser adaptado para incluir o

ERR. Inicia-se com a matriz ??(0) (ver equac?a?o 3.46):

??(0) = [? : ~y] = [??
(0)
1 . . . ??

(0)
n?

: ~y (0)] (3.60)

e chama-se de Rk o menor principal da matriz R (sendo esta definida na equac?a?o 3.39).

Apo?s a aplicac?a?o de k ? 1 transformac?o?es de Householder, a matriz ??(0) e? transfor-
mada em:

??(k?1) =

[
Rk?1

0
??

(k?1)
k . . . ??

(k?1)
n?

: ~y (k?1)

]
. (3.61)

A soma do quadrado dos res??duos sera? dada por (ver equac?o?es 3.44 e 3.45):

J
(k?1)
M Q =

N?
i=k

(y
(k?1)
i )

2, (3.62)

onde y
(k?1)
i e? o i-e?simo elemento do vetor ~y apo?s a aplicac?a?o de k ? 1 transformac?o?es

de Householder. Vale notar que a aplicac?a?o da j-e?sima transformac?a?o de Householder

(H(j)) deixa inalteradas as primeiras j ? 1 linhas de ??(j?1).

Aplicando-se a k-e?sima transformac?a?o de Householder, a soma do quadrado dos

res??duos passa a ser:

J
(k)
M Q =

N?
i=k+1

(y
(k)
i )

2 =
N?

i=k

(y
(k?1)
i )

2 ? (y(k)k )
2 (3.63)

J
(k)
M Q = J

(k?1)
M Q ? (y

(k)
k )

2. (3.64)



Identificac?a?o de Sistemas 35

Busca-se enta?o selecionar qual coluna de ? (dentre as colunas ??
(k?1)
k , . . . , ??

(k?1)
n? )

minimiza o valor de (y
(k)
k )

2, ou em outras palavras, qual e? o pro?ximo regressor a ser

inclu??do no modelo.

Para determinar qual coluna deve ser inclu??da, considere [11]:

a
(k)
j =

???? N?
i=k

(??
(k?1)
ij )

2 (3.65)

b
(k)
j =

N?
i=k

??
(k?1)
ij y

(k?1)
i (3.66)

para j = k, . . . ,n?, onde ??
(k?1)
ij e? o elemento da matriz ??

(k?1) situado na i-e?sima linha

e j-e?sima coluna, ou de forma equivalente, e? o i-e?simo elemento do vetor ?j.

O valor de ERR dos (n? ? (k ? 1)) regressores ainda na?o inclu??dos no modelo na
k-e?sima iterac?a?o pode ser calculado com o uso da equac?a?o [4]:

[ERR]
(k)
j =

(
b
(k)
j

)2
a

(k)
j ?~y , ~y?

para j = k, . . . ,n? (3.67)

Assim, na k-e?sima iterac?a?o calcula-se o valor de ERR de todos os regressores candi-

datos ainda na?o inclu??dos no modelo e escolhe-se aquele com o mais alto valor de ERR.

Sendo jm o ??ndice do regressor com maior ERR, basta enta?o trocar na matriz ??
(k?1) a

coluna jm com a coluna k e aplicar a k-e?sima transformac?a?o de Householder a? matriz

resultante.

O nu?mero de termos a ser inclu??do no modelo final pode ser determinado com o uso

de um crite?rio de parada tal como [11]:

1 ?
M?
i=1

[ERR]i &amp;lt;?, (3.68)

onde M e? o nu?mero de regressores ja? inclu??dos no modelo e (0 &amp;lt;? ? 1) e? a tolera?ncia
desejada.

Outra maneira muito utilizada e? o uso paralelo de um crite?rio de informac?a?o como o

crite?rio de Akaike. A cada termo inclu??do, simula-se o modelo e calculam-se os res??duos.

O modelo com menor AIC sera? o modelo com a quantidade ideal de termos.



Identificac?a?o de Sistemas 36

3.8.3 Agrupamento de termos

Considerando-se um modelo NARMAX polinomial descrito pela equac?a?o abaixo

(que e? equivalente a? equac?a?o 2.12) [2]:

y(k) =
??
m=0

m?
p=0

ny ,nu?
n1,nm

cp,m?p(n1, . . . ,nm)

p?
i=1

y(k ? ni)
m?

i=p+1

u(k ? ni), (3.69)

onde
ny ,nu?
n1,nm

?
ny?

n1=1

· · ·
nu?

nm=1

(3.70)

e uma janela de dados suficientemente suave onde seja poss??vel fazer as seguintes apro-

ximac?o?es:

y(k ? 1) ? y(k ? 2) ? . . . ? y(k ? ny) (3.71)

u(k ? 1) ? u(k ? 2) ? . . . ? u(k ? nu). (3.72)

Podemos enta?o escrever a seguinte aproximac?a?o:

y(k) ?
ny ,nu?
n1,nm

cp,m?p(n1, . . . ,nm)
??
m=0

m?
p=0

y(k ? 1)pu(k ? 1)m?p. (3.73)

Os agrupamentos de termos ?ypum?p sa?o conjuntos que conte?m os termos do tipo

ypum?p para m = 0, . . . ,` e p = 0, . . . ,m. As constantes que aparecem na equac?a?o

3.73 sa?o chamadas de coeficientes de agrupamentos e sa?o representadas por ?ypum?p

[3]. Os coeficientes de agrupamento de termos sa?o simplesmente o somato?rio de todos

os termos do modelo que pertencem a um dado agrupamento (ou seja, que possuem o

mesmo formato).

Por exemplo, no caso do modelo com grau ` = 2, ny = 2 e nu = 1 mostrado na

equac?a?o 2.14 e repetido abaixo:

y(k) = c0,0 + c1,0(1)y(k ? 1) + c1,0(2)y(k ? 2) + c0,1(1)u(k ? 1)

+ c2,0(1, 1)y
2(k ? 1) + c2,0(1, 2)y(k ? 1)y(k ? 2) + c2,0(2, 2)y2(k ? 2)

+ c1,1(1, 1)y(k ? 1)u(k ? 1) + c1,1(2, 1)y(k ? 2)u(k ? 1),



Identificac?a?o de Sistemas 37

temos os seguintes agrupamentos de termos:

?0 = {c0,0} (3.74)

?u = {c0,1(1)u(k ? 1)} (3.75)

?y = {c1,0(1)y(k ? 1),c1,0(2)y(k ? 2)} (3.76)

?y2 = {c2,0(1, 1)y2(k ? 1),c2,0(1, 2)y(k ? 1)y(k ? 2),c2,0(2, 2)y2(k ? 2)} (3.77)

?yu = {c1,1(1, 1)y(k ? 1)u(k ? 1),c1,1(2, 1)y(k ? 2)u(k ? 1)} (3.78)

Os coeficientes de agrupamento deste modelo sa?o:

?0 = c0,0 (3.79)

?u = c0,1(1) (3.80)

?y = c1,0(1) + c1,0(2) (3.81)

?y2 = c2,0(1, 1) + c2,0(1, 2) + c2,0(2, 2) (3.82)

?yu = c1,1(1, 1) + c1,1(2, 1) (3.83)

De forma que em uma janela de dados suficientemente suave, podemos escrever:

y(k) ? ?0 + ?u · u(k ? 1) + ?y · y(k ? 1)

+ ?y2 · y2(k ? 1) + ?yu · y(k ? 1)u(k ? 1). (3.84)

O uso dos agrupamentos de termos facilita o ca?lculo da caracter??stica esta?tica do

modelo, ale?m de ajudar na detecc?a?o da estrutura. Para tal empreitada o que se faz e?

gerar uma fam??lia de modelos com nu?mero crescente de termos selecionados pelo ERR.

Depois trac?am-se gra?ficos com o valor dos coeficientes de agrupamento em func?a?o do

nu?mero de termos e buscam-se ind??cios de que algum agrupamento e? espu?rio (e portanto

pode ser eliminado do conjunto de termos candidatos). Alguns ind??cios procurados nos

gra?ficos para caracterizar agrupamentos espu?rios sa?o [2, 4]:

• Inclusa?o tardia de um dado agrupamento (o coeficiente do agrupamento sera?
diferente de zero somente para um valor “grande” do nu?mero de termos)

• Valor absoluto de um coeficiente muito pequeno comparado com os demais ou
decrescentes com o aumento do nu?mero de termos (devem ser descontados os

problemas decorrentes de mal-condicionamento nume?rico)

• Coeficientes com valores oscilato?rios



Identificac?a?o de Sistemas 38

3.8.4 Caracter??stica esta?tica

A caracter??stica esta?tica de um sistema corresponde a? relac?a?o alge?brica existente

entre uma entrada constante e a sa??da do sistema em regime permanente. A carac-

ter??stica esta?tica de um modelo na?o-linear a tempo discreto e? definida pelos seus pontos

fixos de primeira ordem, sendo os pontos fixos de primeira ordem de uma equac?a?o a

diferenc?as definidos por:

x(k + 1) = x(k) = x? (3.85)

onde x(·) e? o vetor de estados do sistema. Os pontos fixos de primeira ordem do caso
discreto correspondem aos pontos de equil??brio de uma equac?a?o diferencial cont??nua.

Uma vez que x? e? atingido, as sucessivas iterac?o?es na?o sa?o capazes de tirar o sistema

deste ponto [29].

No caso de um modelo NARMAX, os pontos fixos sa?o definidos como sendo aqueles

pontos onde y(k) = y(k + i), ?i ? Z. Para o caso de modelos auto?nomos, os pontos
fixos podem ser calculados com o uso dos coeficientes de agrupamento como descrito

por Aguirre e Mendes [2]. Para o caso na?o auto?nomo, uma a?lgebra similar e? utilizada,

pore?m considera-se que a entrada u? e? constante e serve como para?metro para definir a

localizac?a?o dos pontos fixos. Para modelos de grau ` = 2, os pontos fixos do sistema

na?o-auto?nomo podem ser calculados buscando y? que satisfac?a a seguinte equac?a?o de

segundo grau:

(?y2 )y?
2 + (?y + ?yuu? ? 1)y? + (?0 + ?uu? + ?u2u?2) = 0 (3.86)

No caso particular de um modelo com grau ` = 2 com coeficiente de agrupamento

?y2 = 0, teremos somente um ponto fixo, dado por:

y? = ?
(?0 + ?uu? + ?u2u?

2)

(?y + ?yuu? ? 1)
(3.87)

3.9 Validac?a?o do Modelo

Como ja? foi dito anteriormente, na modelagem ou identificac?a?o de um sistema,

na?o se deseja um modelo que represente exatamente todas as caracter??sticas de um

sistema, mas sim um modelo que aproxime satisfatoriamente algumas caracter??sticas

de interesse. Validar um modelo significa verificar se o modelo encontrado representa



Identificac?a?o de Sistemas 39

adequadamente as caracter??sticas de interesse do sistema. Basicamente ha? dois tipos

de validac?a?o: validac?a?o estat??stica e validac?a?o dina?mica.

A validac?a?o estat??stica busca verificar se um dado modelo conseguiu descrever tudo

o que e? poss??vel, em um conjunto de dados. Quando isso e? verificado, os res??duos (o que

sobrou dos dados) devem ser puramente aleato?rios. Esta tarefa e? chamada de ana?lise

de res??duos, onde os res??duos sa?o definidos por:

?(k) = y(k) ? ?(k) T ~??. (3.88)

Na identificac?a?o linear, busca-se satisfazer [28]:

r??(?) = E[?(k)?(k ? ?)] = ?(k) (3.89)

r?u(?) = E[?(k)u(k ? ?)] = 0 ?? (3.90)

onde r?? e? a func?a?o de autocorrelac?a?o dos res??duos (ver equac?o?es 3.3 e 3.4), r?u e? a

func?a?o de correlac?a?o cruzada entre os res??duos e a entrada (ver equac?o?es 3.1 e 3.2) e

?(k) e? func?a?o delta de Dirac4. A equac?a?o 3.89 garante que os res??duos sa?o brancos e,

portanto, a estimativa de para?metros na?o esta? polarizada. Por outro lado, a equac?a?o

3.90 garante que o modelo e? gene?rico, ou seja, os res??duos obtidos na?o dependem da

entrada do sistema utilizada para estimac?a?o de para?metros e o modelo pode ser usado

com um outro conjunto de dados.

No caso de modelos lineares, so? e? poss??vel explicar as relac?o?es lineares entre a

entrada e a sa??da. Portanto eventuais correlac?o?es na?o-lineares detectadas na ana?lise de

res??duos podem ser ignoradas, bastando ater-se a?s equac?o?es 3.89 e 3.90.

Quando se lida com modelos na?o-lineares, busca-se modelar toda dina?mica do sis-

tema, mesmo a na?o-linear. Assim, outros testes devem ser incorporados a? ana?lise de

res??duos, como por exemplo [5]:

r??u(?) = E[?(k)?(k ? ?)u(k ? ?)] = 0 ??

ru2? ?(?) = E[(u
2(k) ? E[u2(k)]) ?(k ? ?)] = 0 ?? (3.91)

ru2? ?2 (?) = E[(u
2(k) ? E[u2(k)]) ?2(k ? ?)] = 0 ??

4A func?a?o Delta de Dirac, no caso discreto, e? definida como:

?(k) =

??
?1 para k = 00 para k 6= 0



Identificac?a?o de Sistemas 40

A validac?a?o estat??stica de um modelo garante que na?o existam correlac?o?es na?o

modeladas no modelo, mas na?o garante que o modelo tenha as caracter??sticas dina?micas

de interesse. Faz-se necessa?rio enta?o a validac?a?o dina?mica dos dados.

Na validac?a?o dina?mica do modelo, trabalha-se com um conjunto de dados diferente

daquele utilizado para estimac?a?o dos para?metros, para assegurar que o modelo em

ana?lise possui capacidade de generalizac?a?o. Esse conjunto de dados diferente pode vir

de um segundo ensaio feito no sistema (tendo-se o cuidado de garantir que o segundo

ensaio tenha sido feito nas mesmas condic?o?es do primeiro) ou dividindo-se a massa

original de dados em dois conjuntos, sendo um utilizado para estimac?a?o de para?metros

(este conjunto e? chamado de dados de estimac?a?o) e o segundo utilizado para validac?a?o

dos modelos (chamado de dados de validac?a?o).

Duas maneiras utilizadas para a validac?a?o dina?mica de um modelo sa?o a ana?lise

da caracter??stica esta?tica e o resultado da simulac?a?o livre. A comparac?a?o entre a

caracter??stica esta?tica de um modelo e a caracter??stica esta?tica do sistema real permite

avaliar se em regime permanente a sa??da do modelo e a do sistema real se equivalem

para uma mesma entrada.

Para avaliar o comportamento no transito?rio do sistema, pode-se utilizar a si-

mulac?a?o livre (tambe?m conhecida por predic?a?o de infinitos passos a? frente), que consiste

em aplicar no modelo uma entrada e comparar a sua sa??da com a sa??da do sistema ex-

citado pela mesma entrada. A ana?lise de um gra?fico contendo as sa??das do modelo e

do sistema permite avaliar o desempenho dina?mico do modelo em ana?lise. A figura 3.2

mostra como e? feita a simulac?a?o livre de um modelo.

Figura 3.2: Validac?a?o atrave?s da simulac?a?o livre de um modelo

Quantitavamente, pode-se avaliar o desempenho dina?mico do modelo com o uso de



Identificac?a?o de Sistemas 41

??ndices, como por exemplo a soma do quadrado dos res??duos, ou o ??ndice sugerido por

Ljung [27]:

ajuste = 100 ?

(
1 ?

?~?y ? ~y?
?~y ? me?dia(~y)?

)
, (3.92)

onde ~?y e? o vetor contendo a sa??da do modelo e ~y e? o vetor contendo a sa??da real

do sistema. Um modelo com ajuste = 100% corresponde a um modelo que descreva

exatamente a sa??da do sistema com base em uma dada entrada. Ja? um modelo com

ajuste = 0% dara? uma soma do quadrado dos res??duos igual ao que se obteria pelo uso

da me?dia dos dados da sa??da como preditor trivial. Esse ??ndice e? u?til principalmente

para a comparac?a?o entre o desempenho de va?rios modelos, sendo equivalente ao RMSE

(Root Mean Square Error ) [4]:

RMSE =

??N
k=1(y(k) ? y?(k))2??N

k=1(y(k) ? y?)
(3.93)

pore?m e? de mais fa?cil interpretac?a?o.

No pro?ximo cap??tulo sera?o aplicadas estas te?cnicas a um estudo de caso: um poc?o

de petro?leo simulado, operando com elevac?a?o artificial por injec?a?o cont??nua de ga?s.



Cap??tulo 4

Estudo de Caso:

Aplicac?a?o a? Indu?stria Petrol??fera

4.1 Introduc?a?o

Nos cap??tulos anteriores foi realizada uma breve revisa?o teo?rica sobre modelagem e

identificac?a?o de sistemas. Neste cap??tulo sera? feita uma aplicac?a?o deste conhecimento

sobre um poc?o de petro?leo simulado, operando por elevac?a?o artificial mediante injec?a?o

cont??nua de ga?s (gas-lift).

O objetivo deste cap??tulo e? analisar a problema?tica de encontrar modelos va?lidos

para o sistema, que possam ser utilizados para o controle do poc?o numa certa regia?o

de operac?a?o com comportamento na?o-linear. Os dados utilizados foram obtidos num

modelo simulado no software OLGA 2000 da empresa Scandpower Petroleum Techno-

logies. Considera-se o uso do software OLGA 2000 suficiente para gerac?a?o de dados

numa primeira abordagem, ja? que este software e? amplamente utilizado na indu?stria e

foi validado com centenas de aplicac?o?es reais.

Inicialmente e? feita uma descric?a?o do sistema em ana?lise na sec?a?o 4.2, seguida de

uma descric?a?o do software OLGA 2000 na sec?a?o 4.3. Na sec?a?o 4.4 e? feita a identificac?a?o

de modelos lineares para operar em tre?s pontos de operac?a?o do poc?o. A sec?a?o 4.5 faz a

identificac?a?o de modelos na?o-lineares do tipo NARMAX polinomial para o poc?o, sendo

inicialmente utilizada uma entrada mais “agressiva” e em seguida e? feita a identificac?a?o

de um modelo reaproveitando os dados da identificac?a?o linear. Por u?ltimo, a sec?a?o 4.6



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 43

faz uma comparac?a?o dos modelos lineares e na?o-lineares obtidos e a sec?a?o 4.7 sugere

uma estrate?gia para o controle, a ser implementada em trabalhos futuros.

4.2 Descric?a?o do Sistema

O petro?leo e? uma substa?ncia formada basicamente por hidrocarbonetos, com impu-

rezas tais como compostos sulfurados, compostos nitrogenados, compostos oxigenados,

resinas, asfaltenos e compostos meta?licos [37]. Ele e? formado a partir da mate?ria

orga?nica depositada junto com sedimentos, sob condic?o?es na?o-oxidantes. Esta mate?ria

orga?nica quando soterrada a uma profundidade suficiente para que haja um aumento de

temperatura e pressa?o, desencadeia o processo de maturac?a?o, similar a um cozimento

em panela de pressa?o, dando origem ao petro?leo [32].

Apo?s a gerac?a?o do petro?leo, ocorre a migrac?a?o do petro?leo para a superf??cie. Quando

o caminho do petro?leo para a superf??cie e? interrompido por alguma armadilha geolo?gica,

comec?a o processo de acumulac?a?o. A barreira que se interpo?e no caminho do petro?leo e?

chamada de rocha selante, tendo como principal caracter??stica a baixa permeabilidade,

ale?m da plasticidade (que permite a? rocha manter sua condic?a?o selante mesmo apo?s

submetida a esforc?os determinantes de deformac?o?es). Abaixo desta rocha forma-se um

reservato?rio de petro?leo, constitu??do por uma rocha com espac?os vazios no seu interior

(porosidade intergranular), onde o petro?leo se deposita.

Para explorar uma formac?a?o de petro?leo, e? necessa?ria a perfurac?a?o de um ou mais

poc?os que permitam o acesso ao petro?leo a partir da superf??cie. Preliminarmente

sa?o perfurados poc?os explorato?rios, nos quais sa?o feitos diversos testes para avaliar a

formac?a?o. Segundo Pluce?nio [32], os principais resultados de um teste de formac?a?o sa?o

a pressa?o esta?tica do reservato?rio, a permeabilidade, a curva IPR (Inflow Performance

Relationship), a ana?lise PVT (Pressa?o, Volume, Temperatura) do fluido de formac?a?o,

o teor de areia e as razo?es A?gua-O?leo e Ga?s-O?leo. Uma curva IPR t??pica para fluido

subsaturado e? mostrada na figura 4.1, relacionando a vaza?o de produc?a?o na cabec?a do

poc?o para diferentes valores de pressa?o no fundo do poc?o. Para fluidos saturados, a

curva se altera ligeiramente, deixando de ser um reta e adquirindo uma curvatura. O

processo de prospecc?a?o de petro?leo e? explicado em [37] e a perfurac?a?o e explorac?a?o de

poc?os e? detalhada em [13, 37].

Considere um poc?o onde a pressa?o esta?tica do reservato?rio (Pr) e? igual a? pressa?o da



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 44

Figura 4.1: Curva IPR (Inflow Performance Relationship) t??pica para fluido subsatu-

rado

coluna de fluido dentro do tubo de produc?a?o (Ptp), sem que a coluna de fluido atinja

a cabec?a do poc?o, na?o haveria produc?a?o, como pode ser visto na figura 4.2. Para que

seja poss??vel extrair petro?leo deste poc?o e? necessa?rio que se utilize alguma forma de

elevac?a?o artificial. Em outro caso menos extremo, o reservato?rio pode possuir pressa?o

suficiente para vencer o peso da coluna de fluido (Pr &gt; Ptp) mas na?o o suficiente para

proporcionar uma vaza?o que seja interessante do ponto de vista econo?mico. Tambe?m

neste caso utiliza-se algum me?todo de elevac?a?o artificial. Ale?m disso, conforme se extrai

petro?leo de uma reservato?rio, a pressa?o dele diminui com o tempo, exigindo alguma

forma de elevac?a?o artificial.

Segundo Pluce?nio [32], os principais me?todos de elevac?a?o artificial de petro?leo sa?o:

• bomba de succ?a?o com hastes;

• bomba de cavidade;

• bomba centr??fuga submersa;

• elevac?a?o por injec?a?o cont??nua de ga?s;

• elevac?a?o por injec?a?o intermitente de ga?s.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 45

Figura 4.2: Poc?o morto

Para escolher o me?todo de elevac?a?o artificial mais adequado para um dado poc?o,

deve-se levar em considerac?a?o fatores tais como a geometria do poc?o, profundidade,

caracter??sticas do fluido, pressa?o esta?tica do reservato?rio, disponibilidades de insumos

para o me?todo, entre outros. O me?todo da elevac?a?o atrave?s da injec?a?o cont??nua de ga?s

possui um bom desempenho comparado com os demais me?todos, na?o sendo entretanto

recomendado para reservato?rios ja? muito esgotados, onde os custos tornam a operac?a?o

invia?vel em termos econo?micos.

As principais vantagens do me?todo de elevac?a?o por injec?a?o cont??nua de ga?s sa?o [24]:

• custos iniciais do equipamento podem ser menores do que outros tipos de siste-
mas;

• custo de manutenc?a?o e? mais baixo;

• grande facilidade de instalac?a?o e operac?a?o;

• permite operac?a?o intermitente para poc?os com baixa produc?a?o;

• adapta-se facilmente a poc?os que produzam areia, o que poderia danificar outros
tipos de sistemas.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 46

O me?todo de elevac?a?o por injec?a?o cont??nua de ga?s (gas lift) funciona atrave?s da

reduc?a?o da pressa?o hidrosta?tica no tubo de produc?a?o. Para realizar esta tarefa, uma

va?lvula direcional e? colocada no tubo de produc?a?o no ponto mais profundo poss??vel

e ga?s e? injetado com pressa?o maior do que a pressa?o da coluna de fluido naquele

ponto. O ga?s, por ser mais leve do que o fluido existente na coluna, sobe e gaseifica

o conteu?do do tubo de produc?a?o, reduzindo a densidade do fluido ali existente. Isso

diminui a pressa?o da coluna de fluido na formac?a?o e, quando a pressa?o da coluna de

fluido tornar-se menor do que a pressa?o na formac?a?o, consegue-se efetuar a elevac?a?o

artificial do petro?leo [14, 22, 32]. A figura 4.3 apresenta os principais equipamentos

utilizados num poc?o operando por elevac?a?o cont??nua de ga?s.

Figura 4.3: Esquema de um poc?o operando por elevac?a?o cont??nua de ga?s, utilizando

o me?todo cla?ssico onde o controle e? realizado na pro?pria va?lvula de gas-lift inserta?vel,

destacando os principais equipamentos envolvidos - Adaptado de [32]

Em um reservato?rio, podemos ter a?gua, o?leo ou ga?s em quaisquer combinac?o?es. O

fluido obtido na sa??da do poc?o passara? enta?o por um separador, que fara? a separac?a?o



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 47

das tre?s fases do fluido. O ga?s extra??do podera? evidentemente ser reaproveitado no

processo de elevac?a?o por injec?a?o de ga?s.

Ainda sobre a figura 4.3, nota-se a presenc?a de dois “chokes” (ou “choke valves” -

do ingle?s: “va?lvula de estrangulamento”): o de produc?a?o e o de injec?a?o de ga?s. Um

choke e? uma va?lvula de orif??cio com grande resiste?ncia a? abrasa?o, na?o sofrendo danos

com a passagem das part??culas so?lidas que eventualmente venham junto com o fluido

da formac?a?o (que pode inclusive escoar a uma velocidade superso?nica). Quando se

trata da vaza?o de ga?s por um choke, tem-se que caso a pressa?o a montante do choke

(P1) seja igual a? pressa?o a jusante (P2), na?o ha? fluxo atrave?s dele. Para valores de

P2/P1 abaixo de um certo valor (ao redor de 0.5), atinge-se um fluxo cr??tico onde uma

diminuic?a?o de P2 na?o mais provoca um aumento na vaza?o ma?ssica atrave?s do choke.

Isso ocorre pois nesta condic?a?o a vaza?o ocorre a? velocidade do som. Essa propriedade

dos chokes e? usada na indu?stria do petro?leo para garantir que oscilac?o?es na pressa?o dos

equipamentos existentes a jusante do choke de produc?a?o na?o afetem a vaza?o ma?ssica

que passa pela tubulac?a?o. Por outro lado, a inclusa?o deste choke provoca o aumento

da pressa?o nos componentes a montante no choke, o que no fim provoca uma queda na

produc?a?o do poc?o [33].

De acordo com a vaza?o de ga?s injetada, temos diversos regimes de operac?a?o do

poc?o:

• Fluxo tipo bolhas - para pequenas vazo?es de ga?s, o ga?s sobe ate? a superf??cie na
forma de bolhas;

• Fluxo tipo plugue - aumentando-se a vaza?o de ga?s, as bolhas acabam se fundindo
e formam um fluxo de l??quido entremeado por golfadas de ga?s;

• Fluxo anular - neste regime, a quantidade de ga?s toma a sec?a?o central do tubo
de produc?a?o e a fase l??quida viaja rente a? parede do tubo;

• Fluxo ne?voa - a fase l??quida deixa de ocupar as paredes do tubo de produc?a?o e
passa a viajar na forma de gotas carregadas pelo ga?s.

A figura 4.4 mostra um gra?fico teo?rico da curva de produc?a?o de um poc?o ope-

rando por injec?a?o cont??nua de ga?s. A vaza?o de produc?a?o e? func?a?o da vaza?o de ga?s

injetado. Conforme explicado anteriormente, a injec?a?o de ga?s reduz a densidade do

fluido presente no tubo de produc?a?o, tornando a pressa?o da coluna de fluido menor do



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 48

que a pressa?o na frente dos canhoneados do poc?o, o que resulta num fluxo subindo o

tubo de produc?a?o. Com o aumento da vaza?o de ga?s, o atrito do fluido da coluna de

produc?a?o aumenta ate? um ponto onde passa a dominar a dina?mica do fluxo, reduzindo

a vaza?o de produc?a?o do poc?o. Existe uma regia?o o?tima de operac?a?o do poc?o, em termos

econo?micos, assinalada na figura 4.4, que esta? relacionada com o custo de compressa?o

do ga?s, o prec?o do petro?leo no mercado, entre outros. Esta regia?o, no entanto, possui o

inconveniente de apresentar oscilac?o?es, quando o sistema opera em malha aberta, o que

e? ruim por reduzir a produtividade do poc?o e dificultar a separac?a?o da a?gua/ga?s/o?leo

[14].

Figura 4.4: Curva da vaza?o de produc?a?o x vaza?o de injec?a?o, com a a?rea de maior

interesse econo?mico em destaque.

Em Imsland et al [15, 22] propo?em-se estrate?gias para a estabilizac?a?o das oscilac?o?es

de poc?os operando por gas lift, mas nelas devem estar dispon??veis as medic?o?es da

pressa?o na cabec?a e no fundo do poc?o e a vaza?o ma?ssica atrave?s do choke de produc?a?o e

de injec?a?o. Os modelos utilizados sa?o lineares, mas o procedimento detalhado utilizado

para a modelagem do sistema e? omitida nos artigos.

Pluce?nio [32], por outro lado, propo?e uma estrate?gia para o controle de um poc?o

operando por gas lift que envolve a medic?a?o da vaza?o ma?ssica de produc?a?o na superf??cie,

utilizando uma rede Fieldbus como plataforma para o desenvolvimento do controle. Os



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 49

modelos utilizados sa?o lineares do tipo ARX, identificados em tre?s diferentes pontos de

operac?a?o.

Busca-se neste trabalho identificar um modelo (ou fam??lia de modelos) que possibi-

lite a posterior implementac?a?o do controle da produc?a?o no poc?o de petro?leo, eliminando

as oscilac?o?es existentes e permitindo que o sistema opere na faixa que economicamente

e? mais interessante. Devido a? caracter??stica na?o-linear do sistema, o interesse principal

reside na obtenc?a?o de modelos na?o-lineares.

Inicialmente, considera-se que sa?o medidas a pressa?o no fundo do poc?o (Pwf ) e a

pressa?o na cabec?a do poc?o (Ph). Pode-se atuar sobre a abertura do choke de injec?a?o

de ga?s e sobre a abertura do choke de produc?a?o. Supo?e-se que haja um compressor

capaz de fornecer ga?s comprimido a uma pressa?o constante, sendo o controle da vaza?o

de ga?s efetivamente injetado no sistema feito atrave?s da abertura do choke de injec?a?o.

A estrutura do controlador de vaza?o ma?ssica de ga?s injetado e? mostrada na figura

4.5, onde Kp = 5 × 10?3 e Ki = 0.1). Considerando-se a existe?ncia deste controle
local, as entradas do sistema a ser identificado passam a ser a vaza?o ma?ssica de injec?a?o

de ga?s (Qi - refere?ncia do controlador mostrado na figura 4.5) e a abertura do choke

de produc?a?o (?c). A figura 4.6 ilustra os pontos de medic?a?o e atuac?a?o das varia?veis

mencionadas acima.

Figura 4.5: Estrutura do controlador de vaza?o ma?ssica de injec?a?o de ga?s

Na figura 4.7 pode-se ver uma fam??lia de curvas relacionando a pressa?o no tubo

de produc?a?o (Ptp - corresponde a? diferenc?a de pressa?o na cabec?a e no fundo do poc?o)

em regime permanente em func?a?o da vaza?o de injec?a?o de ga?s (Qi), com o choke de

produc?a?o mantido com abertura constante, igual a 20%, 35%, 50%, 65%, 80% e 95%.

No mesmo ensaio foram tambe?m medidos a pressa?o no fundo do poc?o (Pwf ), a queda

de pressa?o no choke de produc?a?o (Pc) e a vaza?o de l??quido na sa??da (Qliq), todos em

func?a?o da vaza?o de injec?a?o de ga?s, podendo os resultados serem vistos nas figuras 4.8,



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 50

Figura 4.6: Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, inicialmente utilizados

4.9 e 4.10. A pressa?o no separador (boundary do sistema) foi mantida constante em

375 psi (que corresponde a aproximadamente 2.59 MPa).

As figuras 4.7 e 4.8 sa?o fa?ceis de interpretar: dado que esta? sendo injetado continu-

amente ga?s na entrada do sistema, quanto mais fechado estiver o choke de produc?a?o,

maior sera? a pressa?o a montante desta va?lvula, ou seja, maior sera? a pressa?o no tubo

de produc?a?o e no fundo do poc?o. Na figura 4.7 a pressa?o no tubo de produc?a?o de-

cresce com o aumento da vaza?o de injec?a?o (em cada uma das curvas) pois com mais

ga?s injetado na coluna de produc?a?o, reduz-se a densidade do fluido ali existente e con-

sequ?entemente a pressa?o (pois Ptp = ?gh), ate? um ponto onde o atrito do fluido com

as paredes da tubulac?a?o passam a influenciar mais fortemente a dina?mica. A figura 4.9

mostra que quanto mais fechado estiver o choke de produc?a?o, maior sera? a diferenc?a

da pressa?o a montante e a jusante dele e a figura 4.10 mostra o custo de utilizar um

choke de produc?a?o: a reduc?a?o da produc?a?o do poc?o.

Com a definic?a?o feita de varia?veis de entrada (Qi e ?c) e de sa??da (Pwf e Ph), temos

um modelo multivaria?vel com 2 entrada e 2 sa??das. No entanto, em testes preliminares,



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 51

Figura 4.7: Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s em

regime permanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%, 65%,

80% e 95%

Figura 4.8: Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s em regime

permanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%, 65%, 80% e

95%



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 52

Figura 4.9: Queda de pressa?o no choke de produc?a?o em func?a?o da vaza?o de injec?a?o de

ga?s em regime permanente - choke de produc?a?o com abertura igual a: 20%, 35%, 50%,

65%, 80% e 95%

Figura 4.10: Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da

vaza?o de injec?a?o de ga?s em regime permanente - choke de produc?a?o com abertura igual

a: 20%, 35%, 50%, 65%, 80% e 95%



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 53

verificou-se que a identificac?a?o do modelo e o posterior controle do sistema com esta

estrutura se tornaria dif??cil, pois ha? uma relac?a?o forte entre a pressa?o no fundo do poc?o

(Pwf ) e a pressa?o na cabec?a do poc?o (Ph). Isso porque a pressa?o no fundo do poc?o pode

ser aproximada por Pwf = Pr + Ptp + Ph, onde Pr e? a pressa?o me?dia do reservato?rio,

Ptp e? a pressa?o exercida pela coluna de fluido no tubo de produc?a?o e Ph e? a pressa?o

medida na cabec?a do poc?o. Podemos tambe?m escrever Ph = Pc + Psep, onde Pc e? a

queda de pressa?o no choke de produc?a?o e Psep e? a pressa?o no separador. Vemos que

com esta estrutura, a pressa?o no fundo do poc?o e a pressa?o na cabec?a do poc?o esta?o

inter-relacionadas, dificultando a implementac?a?o de um controlador multivaria?vel que

consiga isolar Pwf de Ph.

Partiu-se enta?o para uma redefinic?a?o das entradas e sa??das do sistema. Em vez

de lidar diretamente com a pressa?o no fundo do poc?o, passou-se a utilizar a queda de

pressa?o no tubo de produc?a?o Ptp, que e? definida como: Ptp = Pwf ? Ph. A vantagem
de passarmos a lidar com Ptp em vez de Pwf e? que, enquanto variac?o?es na pressa?o do

separador afetavam diretamente Pwf , a pressa?o da coluna de fluido no tubo de produc?a?o

na?o e? afetada. Isso porque Ptp e? calculada como a diferenc?a entre Pwf e Ph e estes dois

termos reagem de forma similar a eventuais perturbac?o?es na pressa?o no separador.

A pressa?o na cabec?a do poc?o passa enta?o a ser controlada por um controlador

local, que agindo sobre a abertura do choke de produc?a?o garante que Ph permanec?a

constante (o que e? deseja?vel na pra?tica). A refere?ncia utilizada para o controlador de

pressa?o na cabec?a do poc?o foi de 325 Psi (aproximadamente 2.24 MPa) e a estrutura

do controlador e? a mesma utilizada para o controle da vaza?o de ga?s injetado, mostrada

na figura 4.5, mas com Kp = ?1 × 10?5 e Ki = 0.01).

O sistema a ser identificado passa enta?o a ser um sistema monovaria?vel, cuja en-

trada e? a vaza?o de ga?s injetado (Qi) e a sa??da e? a pressa?o da coluna de fluido no tubo

de produc?a?o (Ptp), conforme mostrado na figura 4.11. Esta estrutura tem a vantagem

de ser facilmente implementada na pra?tica, ja? que todos os novos poc?os ve?m equipa-

dos com sensores para medir a pressa?o no fundo e na cabec?a do poc?o. Ale?m disso, a

instrumentac?a?o necessa?ria para medic?a?o de pressa?o e? trivial, ao contra?rio da instru-

mentac?a?o requerida para medic?a?o de vaza?o de um fluido multifa?sico, que e? muito cara,

dificultando a implementac?a?o das estrate?gias de controle propostas por Pluce?nio [32]

ou por Imsland et al [22]. A relac?a?o entre Ptp e a vaza?o de produc?a?o na sa??da (que e? o

que efetivamente se desejaria controlar) e? considerada como tendo uma dina?mica des-

prez??vel. Assim, e? suficiente levantar posteriormente uma relac?a?o esta?tica entre essas



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 54

duas varia?veis.

Figura 4.11: Pontos de medic?a?o e atuac?a?o no poc?o de petro?leo, utilizados no restante

deste trabalho

E? interessante notar que a modelagem fenomenolo?gica da relac?a?o entre Ptp e Qi

e? complexa, pois envolve equac?o?es com derivadas parciais, na?o sendo automa?tica a

conversa?o para modelos com formatos que possibilitem a aplicac?a?o de ferramentas

habituais da teoria de controle.

O sistema possui um comportamento evidentemente na?o linear, como pode ser

observado na figura 4.12, onde foram aplicados degraus na entrada do sistema (vaza?o

de injec?a?o de ga?s) e medida a pressa?o no tubo de produc?a?o em um poc?o simulado

utilizando o software OLGA (descrito na sec?a?o 4.3). Percebe-se que na?o somente a

resposta em regime transito?rio do sistema se altera de acordo com a regia?o de operac?a?o,

apresentando uma resposta muito oscilato?ria para baixos valores de Qi, mas tambe?m a

resposta em regime permanente. Vale notar que foram desprezados os dados referentes

a? partida do poc?o, que possui um comportamento particular, cuja descric?a?o na?o faz

parte do escopo deste trabalho.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 55

Figura 4.12: No alto, sequ?e?ncia de degraus de teste aplicada na entrada (Qi) e embaixo

a sa??da (Ptp), mostrando a na?o-linearidade do sistema

Ale?m da caracter??stica na?o-linear, o sistema possui uma resposta com fase na?o-

m??nima1, como pode ser observado na figura 4.13, que e? uma ampliac?a?o da figura 4.12.

A presenc?a da fase na?o-m??nima significa que o sistema reage a uma entrada inicialmente

na direc?a?o contra?ria a? esperada, o que dificulta a implementac?a?o de um controlador.

As figuras 4.14, 4.15 e 4.16 mostram a pressa?o no tubo de produc?a?o (Ptp), a pressa?o

no fundo do poc?o (Pwf ) e a quantidade de l??quido produzido na sa??da do sistema

(Qliq) respectivamente, todos em regime permanente, em func?a?o da quantidade de ga?s

injetado na entrada do sistema, para o caso onde se implementou um controlador que

1O termo “fase na?o-m??nima” e? em geral utilizado no contexto de sistemas lineares significando a

presenc?a de um zero fora do c??rculo unita?rio (no caso discreto). Essa noc?a?o foi aqui extrapolada,

utilizando-se o termo “resposta com fase na?o-m??nima” pois a resposta do sistema apresenta um com-

portamento similar ao que se observaria num sistema linear com fase na?o-m??nima [18]. E? poss??vel

encontrar na literatura o termo “resposta inversa” com o mesmo significado.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 56

Figura 4.13: No alto, degrau aplicado na entrada do sistema. Embaixo a sa??da (Ptp),

mostrando a presenc?a de fase na?o-m??nima no sistema

mante?m a pressa?o na cabec?a do poc?o constante em Ph = 325 Psi. A regia?o de operac?a?o

e? mostrada em linha cheia nestes gra?ficos e os tre?s pontos de operac?a?o onde foram

identificados modelos lineares sa?o representados com c??rculos, correspondendo a Qi =

1.5, Qi = 2.15 e Qi = 2.8 kg/s. A relac?a?o Pwf × Qi vista na figura 4.15 corresponde a?
caracter??stica esta?tica entre a varia?vel de entrada e a de sa??da do sistema a ser modelado.

Caso o sistema fosse linear, este gra?fico seria uma reta, o que evidentemente na?o e? o

caso. Nota-se tambe?m nesta figura e na figura 4.14 que o sistema possui ganho esta?tico

negativo ate? um valor de Qi pro?ximo a 3 kg/s e para valores maiores que este o ganho

esta?tico passa a ser positivo. Na figura 4.16 observa-se que a regia?o de trabalho situa-se

dentro da faixa de o?timo econo?mico mostrada teoricamente na figura 4.4.

Deve ser notado que o modelo identificado quantificando a relac?a?o Ptp × Qi e? in-
fluenciado pela escolha dos para?metros dos controladores de vaza?o de ga?s injetado e

do controlador de pressa?o na cabec?a do poc?o. Assim, qualquer alterac?a?o na estru-



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 57

Figura 4.14: Pressa?o no tubo de produc?a?o em func?a?o da vaza?o de injec?a?o de ga?s quando

a pressa?o na cabec?a do poc?o (Ph) e? mantida constante em 325 Psi. A regia?o de operac?a?o

e? mostrada em linha cheia. Os c??rculos mostram os tre?s pontos onde foram identificados

modelos lineares

Figura 4.15: Pressa?o no fundo do poc?o em func?a?o da vaza?o de injec?a?o de ga?s quando a

pressa?o na cabec?a do poc?o (Ph) e? mantida constante em 325 Psi. A regia?o de operac?a?o e?

mostrada em linha cheia. Os c??rculos mostram os tre?s pontos onde foram identificados

modelos lineares



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 58

Figura 4.16: Quantidade de l??quido (produzido) na sa??da do sistema em func?a?o da

vaza?o de injec?a?o de ga?s quando a pressa?o na cabec?a do poc?o (Ph) e? mantida constante

em 325 Psi. A regia?o de operac?a?o e? mostrada em linha cheia. Os c??rculos mostram os

tre?s pontos onde foram identificados modelos lineares

tura ou nos para?metros destes controladores exige a reidentificac?a?o do sistema. Da

mesma forma, uma alterac?a?o na refere?ncia do controlador de pressa?o na cabec?a do

poc?o tambe?m exige uma nova identificac?a?o do sistema.

A pressa?o no reservato?rio foi considerada constante neste estudo, mas conforme ele

for explorado, esta pressa?o deve diminuir. A constante de tempo envolvida, entretanto,

e? bastante lenta e os modelos identificados para o poc?o devem mostrar-se va?lidos por

um intervalo de tempo razoa?vel.

4.3 O simulador Olga

Para o desenvolvimento deste trabalho, foi utilizado o software OLGA 2000, versa?o

4.10.1, da empresa Scandpower Petroleum Technologies AS. Este software originalmente

chamava-se OLGA 83, tendo sido desenvolvido em 1983 para a Norwegian State Oil

Company. Desde enta?o, o OLGA tem sido aprimorado sendo atualmente capaz de fazer

simulac?o?es dina?micas de sistemas operando com duas ou tre?s fases fluidas, incluindo



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 59

equipamentos como compressores, bombas, trocadores de calor, separadores, va?lvulas

e controladores [36].

O software OLGA e? validado com dados do SINTEF Multi-Phase Flow Laboratory,

IFE, dados de laborato?rio de processos de pequena escala, ale?m de dados tirados de

poc?os reais em operac?a?o. Os me?todos nume?ricos utilizados pelo OLGA permitem a

simulac?a?o de transientes de operac?a?o de um sistema. Este software e? comumente

utilizado na indu?stria do petro?leo [14].

Obviamente a opc?a?o de identificar um modelo para a relac?a?o Ptp×Qi obtida atrave?s
de dados provenientes de simulac?o?es com o software OLGA na?o e? o ideal, ja? que o que

e? simulado dentro do OLGA e? tambe?m um modelo. O ideal seria a utilizac?a?o de dados

extra??dos de um poc?o real. No entanto, a ide?ia e? que o modelo identificado venha a

ser utilizado posteriormente para a implementac?a?o de um controlador. A utilizac?a?o do

OLGA permite que se verifique a viabilidade da implementac?a?o deste controlador, sem

se preocupar com limitac?o?es f??sicas existentes num poc?o real. Ale?m disso, a execuc?a?o de

um teste de identificac?a?o num poc?o real requereria a interrupc?a?o da operac?a?o do poc?o,

ou ao menos a alterac?a?o da operac?a?o normal, por um certo tempo. Antes de chegar a?

execuc?a?o destes testes no sistema real e? conveniente testar num modelo de computador

(dentro do OLGA) se a abordagem e? fact??vel e com isso minimizar o tempo de poc?o

parado e os riscos da implementac?a?o. Considera-se que o software OLGA, por ser muito

usado na indu?stria do petro?leo, represente uma boa aproximac?a?o do comportamento

de um poc?o real.

O sistema que foi montado no simulador e? uma modificac?a?o de um modelo fornecido

pela Scandpower de um poc?o real operando em a?guas profundas no Golfo do Me?xico,

com completac?a?o a seco. A figura 4.17 mostra a geometria do sistema em estudo, que

possui as seguintes caracter??sticas:

• Pressa?o esta?tica do reservato?rio = 4.800 Psi = 33,094 MPa

• Temperatura do reservato?rio = 82, 2oC

• I?ndice de produtividade do reservato?rio = 2 × 10?6 kg/s/Pa

• Pressa?o do separador = 375 psi = 2,585 Mpa

• Temperatura do separador = 26, 7oC

• Pressa?o do ga?s na sa??da do compressor = 9,652 Mpa



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 60

• Temperatura do ga?s na sa??da do compressor = 20oC

Figura 4.17: Geometria do sistema em ana?lise, implementado no OLGA

4.4 Identificac?a?o Linear

A primeira abordagem feita e? a realizac?a?o da identificac?a?o de modelos lineares para

o sistema. Como ja? se mostrou anteriormente, o sistema possui uma caracter??stica

na?o-linear, portanto os modelos lineares encontrados sera?o va?lidos somente dentro de

uma estreita faixa de operac?a?o.

A identificac?a?o linear foi feita em torno de tre?s valores de entrada: Qi = 1.5 kg/s,

Qi = 2.15 kg/s e Qi = 2.8 kg/s. Qi = 1.5 kg/s foi o menor valor de Qi que o simulador

permitiu simular. Abaixo deste valor o simulador OLGA apresentava erro por entrar

numa regia?o onde as caracter??sticas do fluido na?o estavam descritas. Qi = 2.8 kg/s foi

escolhido pois para uma vaza?o de injec?a?o em torno de 3 kg/s ocorre o ponto de m??nimo

da curva Ptp × Qi, como pode ser observado na figura 4.7. Ha? interesse em operar



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 61

abaixo deste valor, por isso a escolha acima. Ja? Qi = 2.15 kg/s foi escolhido por ser o

ponto me?dio entre Qi = 1.5 kg/s e Qi = 2.8 kg/s.

Para proceder a identificac?a?o, o valor da vaza?o de injec?a?o de ga?s foi mantido cons-

tante ate? o sistema estabilizar-se e em seguida foi adicionado ao sinal de entrada cons-

tante um sinal PRBS variando entre ?0.1 e 0.1 kg/s, com durac?a?o de 12600 segundos,
de forma a excitar as diversas frequ?e?ncias do sistema, mas possuindo amplitude sufi-

cientemente pequena para evitar excitar as na?o-linearidades presentes. O tempo em

que cada valor do sinal PRBS e? mantido na entrada foi escolhido como sendo de 200

segundos. O sinal PRBS de entrada pode ser visto na figura 4.18. A sa??da do sistema

(Ptp) para as tre?s entradas descritas acima (uma para cada ponto de operac?a?o) pode

ser vista nas figuras 4.19, 4.20 e 4.21.

Figura 4.18: Sinal ?u(t) aplicado na entrada do sistema para realizar a identificac?a?o

linear

As varia?veis foram redefinidas passando-se a ser considerada como entrada e sa??da

do sistema a variac?a?o em torno do ponto de operac?a?o. O ponto de operac?a?o utilizado

foi obtido mantendo-se a vaza?o de injec?a?o de ga?s (entrada) constante num valor e

observando-se o valor em que a sa??da estabilizava. As novas definic?o?es das varia?veis

de entrada e sa??da esta?o listadas nas equac?o?es 4.1, 4.2 e 4.3, relativas aos tre?s casos



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 62

Figura 4.19: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 1.5

kg/s

Figura 4.20: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 2.15

kg/s



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 63

Figura 4.21: Sa??da do sistema (Ptp) para a identificac?a?o linear com Qi em torno de 2.8

kg/s

analisados na identificac?a?o linear.

?u(t) = u(t) ? 1.5 [kg/s]

?y(t) = y(t) ? 3.588600 [MPa] (4.1)

?u(t) = u(t) ? 2.15 [kg/s]

?y(t) = y(t) ? 3.398670 [MPa] (4.2)

?u(t) = u(t) ? 2.8 [kg/s]

?y(t) = y(t) ? 3.329300 [MPa] (4.3)

Como per??odo de amostragem, adotou-se a estrate?gia descrita na sec?a?o 3.5,

amostrando-se o sistema a uma taxa muito acima da necessa?ria e depois reamostrando-

se o sinal adequadamente. Neste caso utilizou-se uma taxa de amostragem inicial de 1

segundo, que observando-se a resposta do sistema da figura 4.12, e? suficiente para lidar

com as maiores frequ?e?ncias de interesse presentes no sistema.

A figura 4.22 mostra a func?a?o de autocovaria?ncia linear (equac?a?o 3.5) da sa??da do

sistema (Ptp). As tre?s func?o?es mostradas correspondem a? autocovaria?ncia do sistema

excitado na entrada em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s. Para facilitar a



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 64

visualizac?a?o, o resultado da equac?a?o 3.5 foi normalizado, fazendo com que ry?(0) = 1

nos tre?s casos. Para a entrada variando em torno de Qi = 1.5 kg/s, temos que o

primeiro m??nimo de ry?(?) ocorre em ? = 691, para Qi = 2.15 kg/s o primeiro m??nimo

ocorre em ? = 560 e para Qi = 2.8 kg/s o primeiro m??nimo ocorre em ? = 472.

Figura 4.22: Func?a?o de autocovaria?ncia linear usada para definir o fator de reamostra-

gem adequado para o sinal de sa??da

O fator de reamostragem (?) do sinal deve ser escolhido de modo a satisfazer a ine-

quac?a?o 3.9, resultando nas inequac?o?es 4.4, 4.5 e 4.6, que correspondem a? identificac?a?o

feita com a entrada em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s, respectivamente.

34.55 ? ? ? 69.10 (4.4)

28.00 ? ? ? 56.00 (4.5)

23.60 ? ? ? 47.20 (4.6)

Escolheu-se utilizar nos tre?s casos um fator de reamostragem ? = 40, que satisfaz

simultaneamente as inequac?o?es 4.4, 4.5 e 4.6. Como inicialmente utilizou-se um tempo

de amostragem de 1 segundo, apo?s a reamostragem o sinal usado para a identificac?a?o

possui Ts = 40 segundos. Logicamente seria poss??vel utilizar um fator de reamostragem

diferente para cada um dos casos analisados, mas e? interessante utilizar a mesma taxa

para facilitar a eventual comparac?a?o entre os modelos identificados.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 65

Segundo o que foi discutido na sec?a?o 3.4, uma heur??stica para o projeto do sinal de

teste e? que a durac?a?o do menor patamar esteja entre 3Ts e 5Ts (neste caso, entre 120 e

200 segundos). O sinal PRBS utilizado para este ensaio possui o menor patamar com

durac?a?o de 200 segundos, portanto esta? adequado para a utilizac?a?o na identificac?a?o

deste sistema. Escolheu-se uma durac?a?o grande para o menor patamar para aumentar

a excitac?a?o das baixas frequ?e?ncias do sistema.

Apo?s a reamostragem do sinal, os vetores contendo a entrada e a sa??da do sistema

possuem 316 elementos cada. Vale notar que estes dados foram utilizados na ??ntegra

para a estimac?a?o dos para?metros do sistema. Para validac?a?o dos modelos, foram feitos

outros tre?s ensaios similares pore?m utilizando um sinal PRBS diferente (visto na figura

4.23) mas com as mesmas caracter??sticas do sinal de entrada usado para gerar os dados

de estimac?a?o. Este sinal de entrada para validac?a?o tem 6200 segundos de durac?a?o

total, e os vetores contendo a entrada e a sa??da, apo?s a reamostragem, possuem 156

elementos cada.

Figura 4.23: Sinal ?u(t) aplicado na entrada do sistema para validar a identificac?a?o

linear

Na identificac?a?o linear em torno dos tre?s pontos de operac?a?o mencionados, buscam-

se modelos que tenham a ordem mais baixa poss??vel e que tenham a mesma estrutura

(nu, ny e nk sejam os mesmos para os tre?s modelos), de forma a facilitar a comparac?a?o

entre eles. Este u?ltimo requisito e? buscado desde que a manutenc?a?o da estrutura na?o

comprometa o desempenho do modelo naquele ponto de operac?a?o.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 66

4.4.1 Identificac?a?o em torno de u=1.5 kg/s

O primeiro modelo a ser identificado foi para a entrada do sistema variando em torno

de Qi = 1.5 kg/s. Inicialmente supo?s-se que na?o existe uma dina?mica significativa

no ru??do, buscando-se enta?o um modelo do tipo ARX, cuja estrutura atendesse a:

1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5. Ou seja, buscou-se um modelo autoregressivo
que utilize informac?o?es da sa??da e da entrada atrasadas em ate? 8 instantes de tempo

(de y(k ? 1) ate? y(k ? 8) e de u(k ? nk) ate? u(k ? nk ? 7)) e que possua atraso de
transporte (nk) de ate? 5 instantes de tempo discreto.

O crite?rio utilizado para a classificac?a?o dos modelos e selec?a?o do mais adequado

foi o crite?rio de Akaike (ver sec?a?o 3.7), que penaliza por um lado o mau ajuste do

modelo aos dados e por outro lado o nu?mero de para?metros do modelo. Para aumentar

a robustez do crite?rio de Akaike, primeiramente foram estimados modelos com base

nos dados de estimac?a?o, para va?rios valores de ny, nu e nk. Em seguida, calculou-se

os res??duos da simulac?a?o livre dos modelos encontrados, comparado com os dados de

validac?a?o. Do valor destes res??duos calculou-se o AIC do modelo.

A figura 4.24 mostra um gra?fico onde os AICs dos modelos foram agrupados por

nu?mero de para?metros do modelo (nu + ny). Ou seja, cada valor da figura 4.24 re-

presenta o menor AIC encontrado dentre todos os modelos com um dado nu?mero de

para?metros. O melhor modelo enta?o, segundo o crite?rio adotado, possui 5 para?metros,

sendo ny = 3, nu = 2 e nk = 1:

A(q)y(k) = B(q)u(k) + ?(k)

A(q) = 1 ? 2.796q?1 + 2.634q?2 ? 0.8331q?3

B(q) = 0.003566q?1 ? 0.006526q?2 (4.7)

ou, de outra maneira:

y(k) =2.796y(k ? 1) ? 2.634y(k ? 2) + 0.8331y(k ? 3)

+ 0.003566u(k ? 1) ? 0.006526u(k ? 2) + ?(k). (4.8)

Uma simulac?a?o livre do modelo, comparada com os dados de validac?a?o pode ser

vista na figura 4.25. Nesta simulac?a?o, as condic?o?es iniciais do modelo foram definidas

como sendo o valor da sa??da do sistema real para os tre?s primeiros valores da sa??da, ja?



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 67

Figura 4.24: Valor de AIC para modelos estimados em torno de Qi = 1.5 kg/s em

func?a?o do nu?mero de para?metros do modelo estimado

que o modelo possui 3 estados. A partir de k = 4 (inclusive), o modelo foi simulado

tendo em comum com o sistema real apenas a entrada do sistema. Uma ana?lise visual

da figura 4.25 sugere que o modelo encontrado e? adequado para explicar a pressa?o no

tubo de produc?a?o a partir da vaza?o de ga?s injetado na entrada do sistema.

Como ??ndice para quantificar a qualidade do ajuste da curva de sa??da do modelo

simulado aos dados reais de validac?a?o, utilizou-se o ??ndice de ajuste dado pela equac?a?o

3.92, resultando num ajuste de 66.4%. Aqui vale comentar que o uso da func?a?o compare

do Matlab resultaria num melhor ajuste da curva para o mesmo modelo (neste caso, a

func?a?o compare do Matlab encontrou um ajuste de 80.4%), uma vez que ela busca um

conjunto de condic?o?es iniciais que minimize o res??duo na comparac?a?o dos resultados.

Por outro lado, a func?a?o de comparac?a?o e ca?lculo de ajuste implementada neste traba-

lho utiliza como condic?o?es iniciais os primeiros valores da se?rie de dados de validac?a?o

e somente depois deixa o modelo “rodar livremente”, por isso o ??ndice de ajuste das

curvas pode ficar pior. A justificativa para esta escolha de func?a?o e? que escolher as

condic?o?es iniciais que possibilitem um melhor ajuste das curvas parece de certa forma

artificial. Ale?m disso, deseja-se utilizar o mesmo ??ndice de desempenho quando for

feita a comparac?a?o com os modelos na?o-lineares NARMAX mais adiante no trabalho



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 68

Figura 4.25: Simulac?a?o livre do modelo ARX encontrado em torno de Qi = 1.5 kg/s

e as bibliotecas padro?es do Matlab na?o possuem suporte a este tipo de modelo, da?? a

necessidade da implementac?a?o de uma nova func?a?o.

Desprezando-se a parte aleato?ria do modelo (a dina?mica do ru??do). e substituindo-

se q = z, onde q e? o operador de atraso e z corresponde a? transformada z do sistema,

podemos encontrar a func?a?o de transfere?ncia entre a entrada e sa??da do modelo ARX

em ana?lise:
Y (z)

U(z)
=

0.003566z2 ? 0.006526z
z3 ? 2.796z2 + 2.634z ? 0.8331

, (4.9)

de onde se calculam os 3 po?los e 2 zeros existentes:

p1 = 0.8555 z1 = 1.8300

p2 = 0.9703 + 0.1797i z2 = 0.0000

p3 = 0.9703 ? 0.1797i. (4.10)

A figura 4.26 mostra ale?m da localizac?a?o dos po?los e zeros, a regia?o onde com 99% de

probabilidade eles se localizam (em trac?o e ponto). Percebe-se que na?o ha? necessidade

de reduzir a ordem do modelo, pois na?o ocorrem cancelamentos prova?veis entre po?los

e zeros.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 69

Figura 4.26: Diagrama de po?los e zeros do modelo ARX encontrado em torno de

Qi = 1.5 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)

Para proceder com a identificac?a?o do modelo ARX da equac?a?o 4.7, supo?s-se que

o ru??do presente no sistema era branco. No entanto, caso tal hipo?tese na?o fosse ver-

dadeira, os para?metros do modelo encontrado seriam polarizados. Atrave?s da ana?lise

de res??duos, pode-se verificar se a dina?mica existente foi modelada adequadamente.

Na figura 4.27 pode observa-se a autocorrelac?a?o dos res??duos do modelo. Nesta figura

percebe-se que existe uma dina?mica na?o modelada no res??duo, em particular parece

haver uma correlac?a?o entre ?(k) e ?(k ? 5), o que pode ter resultado numa polarizac?a?o
dos para?metros estimados.

Passa-se enta?o para o uso de um modelo ARMAX, que com a parte me?dia mo?vel

busca eliminar a polarizac?a?o da estimativa dos para?metros. Apo?s um processo intera-



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 70

Figura 4.27: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de

Qi = 1.5 kg/s, com os intervalos de confianc?a de 99%

tivo de busca do melhor modelo, encontrou-se o modelo abaixo:

A(q)y(k) = B(q)u(k) + C(q)?(t)

A(q) = 1 ? 2.634q?1 + 2.319q?2 ? 0.6755q?3

B(q) = 0.01326q?1 ? 0.01763q?2

C(q) = 1 ? 0.4218q?1 + 0.1711q?2 + 0.08476q?3

+ 0.1723q?4 ? 0.8331q?5 + 0.4569q?6 (4.11)

ou, de outra maneira:

y(k) = 2.634y(k ? 1) ? 2.319y(k ? 2) + 0.6755y(k ? 3)

+ 0.01326u(k ? 1) ? 0.01763u(k ? 2)

+ ?(k) ? 0.4218?(k ? 1) + 0.1711?(k ? 2) + 0.08476?(k ? 3)

+ 0.1723?(k ? 4) ? 0.8331?(k ? 5) + 0.4569?(k ? 6). (4.12)

A figura 4.28 mostra a autocorrelac?a?o dos res??duos do modelo ARMAX encon-

trado, calculadas com o uso dos dados de estimac?a?o. Percebe-se que desta vez na?o

ha? evide?ncias de qualquer dina?mica na?o modelada nos res??duos, ja? que todos os va-

lores do gra?fico esta?o dentro da faixa onde estatisticamente sa?o iguais a zero (com

99% de probabilidade). A u?nica excec?a?o e? o ponto zero, mas isso e? esperado, ja? que

?(k) = ?(k + 0).



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 71

Figura 4.28: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de

Qi = 1.5 kg/s, com os intervalos de confianc?a de 99%

Uma simulac?a?o livre deste modelo pode ser vista na figura 4.29. O ??ndice de ajuste

do modelo aos dados de validac?a?o foi de 79.6%, que e? superior ao ajuste de 66.4% do

modelo ARX encontrado anteriormente. E? importante notar que a parte me?dia mo?vel

do modelo (polino?mio C(q)) e? utilizada somente na estimac?a?o dos para?metros para

evitar polarizac?a?o. Para a simulac?a?o e? utilizada somente a parte determin??stica do

modelo, ou seja, os polino?mios A(q) e B(q).

Fazendo q = z, encontramos a func?a?o de transfere?ncia do modelo ARMAX encon-

trado:
Y (z)

U(z)
=

0.01326z2 ? 0.01763z
z3 ? 2.634z2 + 2.319z ? 0.6755

, (4.13)

de onde se calculam os 3 po?los e 2 zeros:

p1 = 0.6969 z1 = 1.3297

p2 = 0.9685 + 0.1766i z2 = 0.0000

p3 = 0.9685 ? 0.1766i. (4.14)

O diagrama de po?los e zeros pode ser visto na figura 4.30, juntamente com a regia?o

onde com 99% de probabilidade eles se encontram (em trac?o e ponto). As diferenc?as

mais evidentes em relac?a?o ao diagrama de po?los e zeros do modelo ARX (figura 4.26)

e? o deslocamento do zero que esta? fora do c??rculo unita?rio em direc?a?o a? origem e o



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 72

Figura 4.29: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 1.5

kg/s

deslocamento do po?lo real tambe?m em direc?a?o a? origem, o que demonstra como a

estimativa dos para?metros do modelo ARX estava polarizada. Ale?m disso, a regia?o

onde com 99% de probabilidade se localiza o zero fora do c??rculo unita?rio reduziu seu

tamanho, indicando um aumento da precisa?o da estimac?a?o deste para?metro. Ja? a

localizac?a?o do po?lo real tornou-se mais incerta no modelo ARMAX.

4.4.2 Identificac?a?o em torno de u=2.15 kg/s

Para efetuar a identificac?a?o em torno do ponto de operac?a?o existente com a injec?a?o

de ga?s igual Qi = 2.15 kg/s, seguiu-se passos similares aos mostrados na sec?a?o 4.4.1.

Buscou-se inicialmente um modelo ARX com 1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5,
sendo os valores dos AICs encontrados mostrados na figura 4.31. Com base neste

gra?fico, o melhor modelo e? um modelo com 6 para?metros, sendo ny = 3, nu = 3 e



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 73

Figura 4.30: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de

Qi = 1.5 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)

nk = 0:

A(q)y(k) = B(q)u(k) + ?(k)

A(q) = 1 ? 2.582q?1 + 2.251q?2 ? 0.6604q?3

B(q) = 0.006281 ? 0.003272q?1 ? 0.004691q?2. (4.15)

No entanto, o modelo com ny = 3, nu = 2 e nk = 1 na?o apresenta uma performance

muito inferior ao modelo mostrado na equac?a?o 4.15, com a vantagem de manter a

mesma estrutura do modelo encontrado na sec?a?o 4.4.1 (equac?a?o 4.7), o que era uma

das metas da identificac?a?o linear em curso. Portanto, prefere-se utilizar o modelo:

A(q)y(k) = B(q)u(k) + ?(k)

A(q) = 1 ? 2.519q?1 + 2.137q?2 ? 0.607q?3

B(q) = 0.01139q?1 ? 0.01345q?2. (4.16)

O teste da autocorrelac?a?o dos res??duos do modelo ARX estimado (equac?a?o 4.16)

pode ser visto na figura 4.32. Ali percebe-se um forte ind??cio de polarizac?a?o da es-



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 74

Figura 4.31: Valor de AIC para modelos estimados em torno de Qi = 2.15 kg/s em

func?a?o do nu?mero de para?metros do modelo estimado

timativa dos para?metros do modelo, ja? que a figura demonstra haver uma dina?mica

na?o modelada no res??duo do modelo (atrasos 2, 4, 5 e 6 fora da faixa onde seriam

estatisticamente nulos).

Parte-se enta?o para um modelo ARMAX com estrutura similar ao modelo ARX

mostrado na equac?a?o 4.16, chegando, apo?s o teste de va?rios modelos candidatos, ao

modelo:

A(q)y(k) = B(q)u(k) + C(q)?(t)

A(q) = 1 ? 2.492q?1 + 2.087q?2 ? 0.5826q?3

B(q) = 0.0121q?1 ? 0.01423q?2

C(q) = 1 ? 0.9664q?1 + 0.008977q?2 + 0.0006797q?3

+ 0.05992q?4 ? 0.5734q?5 + 0.6454q?6 (4.17)

Desta vez, na?o ha? ind??cios de dina?mica na?o modelada dos res??duos, como pode ser

visto na figura 4.33, portanto os para?metros devem estar mais pro?ximos dos valores

“reais”. O desempenho do modelo pode ser visto na figura 4.34 que mostra uma

simulac?a?o livre do modelo comparada com a sa??da real do sistema. O ??ndice de ajuste



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 75

Figura 4.32: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de

Qi = 2.15 kg/s, com os intervalos de confianc?a de 99%

do modelo aos dados de validac?a?o foi de 79.82%, o que representa um desempenho

muito bom.

A func?a?o de transfere?ncia do modelo e? mostrada abaixo:

Y (z)

U(z)
=

0.0121z2 ? 0.01423z
z3 ? 2.492z2 + 2.087z ? 0.5826

, (4.18)

de onde se calculam os 3 po?los e 2 zeros existentes (mostrados sob a forma de diagrama

na figura 4.35):

p1 = 0.7031 z1 = 1.1767

p2 = 0.8946 + 0.1680i z2 = 0.0000

p3 = 0.8946 ? 0.1680i. (4.19)

4.4.3 Identificac?a?o em torno de u=2.8 kg/s

Para a identificac?a?o em torno deste ponto, novamente buscou-se um modelo ARX

que satisfizesse 1 ? ny ? 8, 1 ? nu ? 8 e 0 ? nk ? 5. O gra?fico mostrando o valor
do AIC em func?a?o do nu?mero de para?metros do modelo esta? mostrado na figura 4.36.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 76

Figura 4.33: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de

Qi = 2.15 kg/s, com os intervalos de confianc?a de 99%

Figura 4.34: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.15

kg/s



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 77

Figura 4.35: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de

Qi = 2.15 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)

pouco vis??veis neste caso



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 78

Segundo este crite?rio, o melhor modelo para descrever a relac?a?o Ptp × Qi quando Qi
oscila em torno de 2.8 kg/s possui 9 para?metros, sendo ny = 2, nu = 7 e nk = 0:

A(q)y(k) = B(q)u(k) + ?(k)

A(q) = 1 ? 1.734q?1 + 0.7698q?2

B(q) = 0.005164 + 0.001886q?1 ? 0.001235q?2 ? 0.00241q?3

? 0.00145q?4 ? 0.001435q?5 ? 0.002131q?6 (4.20)

Figura 4.36: Valor de AIC para modelos estimados em torno de Qi = 2.8 kg/s em

func?a?o do nu?mero de para?metros do modelo estimado

No entanto a ordem deste modelo parece desnecessariamente alta, especialmente ao

se observar o diagrama de po?los e zeros deste modelo na figura 4.37. Ali vemos que os

dois zeros complexos com parte real negativa possuem uma grande incerteza sobre a

localizac?a?o, como se pode notar pelas duas elipses que delimitam a regia?o de 99% de

probabilidade. O zero real com parte real negativa tambe?m possui uma grande incerteza

de localizac?a?o, correspondendo ao segmento de reta sobre o eixo das abscissas. Ale?m de

haver grande incerteza sobre a localizac?a?o destes zeros (ou seja, sobre os coeficientes do

polino?mio B(q)), ha? um prova?vel cancelamento destes zeros com os po?los localizados na



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 79

origem. Tenta-se portanto encontrar um outro modelo ARX que possua ordem menor

mas que ainda seja capaz de representar adequadamente a dina?mica do sistema.

Figura 4.37: Diagrama de po?los e zeros do modelo ARX encontrado em torno de

Qi = 2.8 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)

O novo modelo com ordem mais baixa encontrado utilizando o crite?rio de Akaike e?

um modelo ARX com ny = 3, nu = 3 e nk = 0, mas que na?o apresenta um desempenho

muito superior a um modelo ARX com ny = 3, nu = 2 e nk = 1 (apresentando ajuste

aos dados de validac?a?o de 74.71% e 74.67%, respectivamente). Prefere-se enta?o este

u?ltimo por apresentar estrutura ide?ntica aos utilizados em torno de Qi = 1.5 kg/s e

Qi = 2.15 kg/s. O modelo utilizado e? enta?o:

A(q)y(k) = B(q)u(k) + ?(k)

A(q) = 1 ? 2.382q?1 + 1.909q?2 ? 0.5134q?3

B(q) = 0.01103q?1 ? 0.01178q?2 (4.21)

Este modelo, entretanto, apresenta uma dina?mica na?o modelada do ru??do, como pode

ser visto na figura 4.38. Assim, opta-se pelo uso de um modelo ARMAX, como feito

nos dois outros pontos de operac?a?o. O modelo ARMAX escolhido consegue modelar

adequadamente a dina?mica dos res??duos, como se pode ver na figura 4.39, sendo dado



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 80

Figura 4.38: Autocorrelac?a?o dos res??duos do modelo ARX encontrado em torno de

Qi = 2.8 kg/s, com os intervalos de confianc?a de 99%

pelos seguintes polino?mios:

A(q)y(k) = B(q)u(k) + C(q)?(t)

A(q) = 1 ? 2.324q?1 + 1.8q?2 ? 0.4617q?3

B(q) = 0.01227q?1 ? 0.01301q?2

C(q) = 1 ? 1.127q?1 + 0.04333q?2 + 0.06346q?3

+ 0.1797q?4 ? 0.3374q?5 + 0.2615q?6 (4.22)

Uma comparac?a?o entre a sa??da da simulac?a?o livre do modelo ARMAX e os dados

de validac?a?o pode ser vista na figura 4.40. Nesta comparac?a?o, o ajuste do modelo

aos dados foi de 75.73%. Ali percebe-se que exceto pelos primeiros 1000 segundos, o

modelo tem um o?timo ajuste aos dados.

Quanto a? estrutura em si do modelo, temos que a func?a?o de transfere?ncia entre a

entrada e a sa??da e? dada por:

Y (z)

U(z)
=

0.01227z2 ? 0.01301z
z3 ? 2.324z2 + 1.8z ? 0.4617

, (4.23)

de onde se calculam os 3 po?los e 2 zeros existentes (mostrados sob a forma de diagrama



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 81

Figura 4.39: Autocorrelac?a?o dos res??duos do modelo ARMAX encontrado em torno de

Qi = 2.8 kg/s, com os intervalos de confianc?a de 99%

Figura 4.40: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.8

kg/s



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 82

na figura 4.41):

p1 = 0.6244 z1 = 1.0601

p2 = 0.8497 + 0.1321i z2 = 0.0000

p3 = 0.8497 ? 0.1321i. (4.24)

Figura 4.41: Diagrama de po?los e zeros do modelo ARMAX encontrado em torno de

Qi = 2.8 kg/s, com as respectivas regio?es de 99% de probabilidade (em trac?o e ponto)

4.4.4 Comenta?rios sobre os modelos lineares identificados

Nas sec?o?es 4.4.1, 4.4.2 e 4.4.3 foram feitas a identificac?a?o de modelos lineares em

torno dos valores de entrada Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s, respectivamente.

Ainda que os modelos que melhor se ajustassem aos dados dos tre?s conjuntos na?o

tivessem a mesma estrutura, optou-se em manter a estrutura fixa para facilitar a com-

parac?a?o. O desempenho dos modelos na?o apresentou piora significativa por tal res-

tric?a?o, sendo os modelos encontrados adequados para fins de projeto de controladores

desde que o sistema opere dentro de uma estreita faixa.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 83

O ganho esta?tico de um modelo linear identificado em um dado ponto de operac?a?o

corresponde a? derivada da curva mostrada na figura 4.15). Assim, ja? era esperado que o

ganho esta?tico dos tre?s modelos lineares na?o fosse o mesmo. Ale?m disso, a localizac?a?o

dos po?los e zeros dos tre?s modelos e? diferente, como pode ser observado na tabela

4.1. Nela vemos que conforme se aumentou a vaza?o de injec?a?o de ga?s (passando de

Qi = 1.5 a Qi = 2.8 kg/s) os po?los do sistema deslocaram-se em direc?a?o a? origem, ou

seja, tornaram-se mais ra?pidos. Tal posicionamento dos po?los era esperado observando-

se as figuras 4.19, 4.20 e 4.21, onde se percebe que conforme aumenta-se o valor de Qi as

frequ?e?ncias mais altas passam a estar mais presentes na sa??da, tornando a resposta do

sistema mais ra?pida. Na figura 4.19 (referente a Qi = 1.5 kg/s), por exemplo, percebe-

se que as alterac?o?es no sinal de entrada levam um tempo maior ate? serem refletidas no

sinal de sa??da do que no caso da identificac?a?o feita em torno de Qi = 2.15 ou Qi = 2.8

kg/s.

Em relac?a?o ao po?lo real puro existente, conve?m notar que apesar de ele estar mais

afastado na origem para o caso onde Qi = 2.15 kg/s, tal fato na?o e? garantido, dada a

incerteza do posicionamento dos po?los vista nas figuras 4.30 e 4.35. No caso de Qi = 1.5

kg/s, onde a incerteza e? maior, a observac?a?o da linha trac?o e ponto da figura 4.30 nos

permite dizer que com 99% de probabilidade este po?lo localiza-se entre 0.6 e 0.79. Assim

e? poss??vel que tambe?m o po?lo real puro seja maior para o modelo identificado em torno

de Qi = 1.5 kg/s e menor para o modelo identificado em torno de Qi = 2.8 kg/s. Na

identificac?a?o realizada, os po?los reais puros dos casos onde Qi = 1.5 e Qi = 2.15 kg/s sa?o

praticamente iguais, de forma que a diferenc?a na resposta e? influenciada pela dina?mica

dos dois po?los complexos conjugados. No caso onde Qi = 1.5 kg/s eles esta?o mais

distantes da origem que nos outros dois casos, confirmando a dina?mica mais lenta. A

figura 4.42 mostra num mesmo diagrama os po?los e zeros dos tre?s modelos identificados,

possibilitando a visualizac?a?o da regia?o em que eles podem ser encontrados quando se

varia o ponto de operac?a?o.

O sistema em ana?lise entretanto e? bastante na?o-linear, como ja? mencionado anteri-

ormente. Desta forma, a regia?o de validade dos modelos identificados na?o sera? muito

grande. Para testar o quanto sa?o va?lidos os modelos identificados quando aumenta a

regia?o de operac?a?o, utilizou-se como entrada o mesmo sinal mostrado na figura 4.23,

mas multiplicou-se a amplitude de ?u(t) primeiramente por dois e depois por tre?s,

fazendo o sinal ?u(t) variar entre -0.2 e 0.2 kg/s, no primeiro caso e entre -0.3 e 0.3

kg/s no segundo caso. A tabela 4.2 mostra o quanto se altera o ajuste da sa??da do



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 84

Qi = 1.5 kg/s Qi = 2.15 kg/s Qi = 2.8 kg/s

Po?los
0.6969 0.7031 0.6244

0.9685 ± 0.1766i 0.8946 ± 0.1680i 0.8497 ± 0.1321i

Zeros
1.3297 1.1767 1.0601

0.0000 0.0000 0.0000

Ganho Esta?tico
0.013255 0.012272 0.012096

(MPa s/Kg)

Tabela 4.1: Po?los, zeros e ganhos esta?ticos dos modelos lineares identificados

Figura 4.42: Diagrama com os po?los e zeros de todos os tre?s modelos lineares encon-

trados



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 85

Ponto de operac?a?o do modelo

Amplitude do sinal ?u(t) Qi = 1.5 kg/s Qi = 2.15 kg/s Qi = 2.8 kg/s

0.2 kg/s 79.6% 79.8% 75.7%

0.4 kg/s 72.0% 80.5% 75.1%

0.6 kg/s 52.9% 74.0% 70.1%

Tabela 4.2: Ajuste das curvas dos modelos lineares para diferentes amplitudes do sinal

de entrada

modelo aos dados reais. As figuras 4.43, 4.44 e 4.45 mostram a comparac?a?o entre uma

simulac?a?o livre dos modelos obtidos em torno de Qi = 1.5, Qi = 2.15 e Qi = 2.8 kg/s,

respectivamente, para ?u(t) variando entre -0.3 e 0.3 kg/s.

O fato de que o modelo obtido em torno de Qi = 2.8 kg/s ser mais robusto a?

variac?o?es na amplitude da entrada, comparado com os outros dois modelos obtidos, e?

justificado observando-se a figura 4.15. Ali pode-se ver que com o aumento da vaza?o

de injec?a?o de ga?s na entrada do sistema, a inclinac?a?o da curva com os pontos fixos

aproxima-se da horizontal, portanto a variac?a?o do ganho esta?tico com a mudanc?a de

Qi e? menor tambe?m naquela regia?o. A melhoria do ajuste da curva para o modelo

identificado em torno de Qi = 2.15 kg/s e? muito pequeno e pode ser considerada

acidental, na?o sendo digna de nota.

Em todos os tre?s modelos lineares identificados ha? um zero de fase na?o-m??nima (fora

do c??rculo unita?rio). A presenc?a deste zero representa uma dificuldade no projeto do

controlador, pois implica que para uma dada entrada aplicada no sistema, a resposta

sera? primeiramente no sentido contra?rio ao esperado em regime permanente. A figura

4.46 mostra o resultado da aplicac?a?o de um degrau unita?rio na entrada do modelo linear

encontrado em torno de Qi = 2.15 kg/s (equac?a?o 4.17). Nela se percebe claramente

que como o ganho esta?tico do modelo e? negativo, em regime permanente a sa??da do

modelo sera? negativa. No entanto, logo apo?s aplicado o degrau, a sa??da do modelo

atinge ?y = 0.06 MPa (positivo). E outro inconveniente deste zero e? que ele na?o

pode ser cancelado pela adic?a?o de um po?lo no controlador, sob o risco de instabilizar

o sistema.

E? poss??vel concluir-se, a? luz dos modelos obtidos, que a variac?a?o do ganho esta?tico

representa uma parte importante da na?o-linearidade. Pode-se tentar utilizar este co-

nhecimento de alguma maneira para facilitar o projeto do controlador.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 86

Figura 4.43: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 1.5

kg/s com a amplitude da entrada de 0.6 kg/s

Figura 4.44: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.15

kg/s com a amplitude da entrada de 0.6 kg/s



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 87

Figura 4.45: Simulac?a?o livre do modelo ARMAX encontrado em torno de Qi = 2.8

kg/s com a amplitude da entrada de 0.6 kg/s

Figura 4.46: Sa??da do modelo ARMAX encontrado em torno de Qi = 2.8 kg/s para

um degrau unita?rio aplicado na entrada



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 88

4.5 Identificac?a?o na?o-Linear

Os modelos lineares encontrados para este sistema te?m validade somente dentro

de uma faixa estreita em torno dos pontos onde foram identificados. Isso se deve

principalmente em func?a?o da variac?a?o do ganho esta?tico do sistema de acordo com a

faixa de operac?a?o. O uso de um modelo na?o-linear parece enta?o bastante adequado

para este sistema, quando se deseja operar numa regia?o mais ampla.

O modelo na?o-linear que sera? usado sera? do tipo NARMAX polinomial. Uma

alterac?a?o feita no modelo NARMAX polinomial, descrito por Chen e Billings [10] na

sec?a?o 2.4, e? que aqui foram inclu??dos como parte dos regressores candidatos os termos

contendo u(k). A presenc?a de um termo do tipo u(k) entre os termos candidatos

significa que pode haver uma transmissa?o imediata de informac?a?o entre a entrada e

a sa??da do sistema, ou seja, que uma parte da dina?mica do sistema e? suficientemente

ra?pida para refletir-se “imediatamente” na sa??da. Nas equac?o?es 2.11 (NARMAX) e

2.12 (NARMAX polinomial) na?o se considerou termos contendo u(k), somente termos

com pelo menos um atraso (de u(k ? 1) em diante), pois considerou-se que a sa??da
do sistema no instante atual depende de informac?o?es de instantes anteriores. Para

muitos sistemas ha? que se fazer esta restric?a?o, em particular quando se trabalha com

controle preditivo. No entanto, para o sistema em ana?lise, tem-se condic?o?es de saber

exatamente qual e? a entrada do sistema no instante atual, ja? que a entrada do sistema

e? uma refere?ncia do controle da injec?a?o de ga?s, sendo esta estabelecida pelo usua?rio.

Assim, o formato do modelo procurado sera?:

y(k) = ?0 +
n?

i1=1

?i1xi1 (k) +
n?

i1=1

n?
i2=i1

?i1i2xi1 (k) · xi2 (k) + . . .

+
n?

i1=1

· · ·
n?

il=il?1

?i1...ilxi1 (k) . . .xil (k) + e(k) (4.25)

onde:

n = ny + nu + 1

x1 = y(k ? 1)

x2 = y(k ? 2)
...

xny = y(k ? ny)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 89

xny+1 = u(k)

xny+2 = u(k ? 1)
...

xn = u(k ? nu)

e ny e? o atraso ma?ximo em y e nu e? o atraso ma?ximo em u.

Como sinal de entrada, adotou-se duas estrate?gias. A primeira e? utilizar um si-

nal mais “agressivo”, com variac?o?es mais abruptas, que possibilite excitar uma grande

quantidade de frequ?e?ncias e regio?es de comportamento do sistema. Pore?m, este sinal

provavelmente na?o seria bem aceito pelo operador do processo real, por utilizar al-

terac?o?es muito bruscas na entrada, deixando o processo muito “solto” e aumentando o

risco de danos aos equipamentos. Decorrente disso, fez-se uma segunda identificac?a?o,

utilizando um sinal mais “comportado”, reaproveitando os dados utilizados para a iden-

tificac?a?o linear feita na sec?a?o 4.4. Este sinal varia de forma menos abrupta, reduzindo

o risco de danos a?s instalac?o?es.

4.5.1 Identificac?a?o usando sinal de entrada “agressivo”

O sinal de entrada “agressivo” foi obtido mantendo-se o sinal constante u = 2.15

kg/s, ate? que estivesse completo o transito?rio de inicializac?a?o do poc?o. Em seguida,

somou-se ao valor 2.15 um sinal aleato?rio com me?dia nula e varia?ncia unita?ria, sendo

que cada patamar do sinal foi mantido por 200 segundos. O uso deste sinal aleato?rio

busca excitar um largo espectro de frequ?e?ncias. E como o sistema e? na?o-linear, busca-

se, ale?m da excitac?a?o das va?rias frequ?e?ncias existentes, a excitac?a?o das na?o-linearidades

existentes nas diferentes regio?es de operac?a?o. Assim, o sinal aleato?rio foi multiplicado

por um valor crescente, antes de ser somado a 2.15, de forma que inicialmente o sistema

opere somente em torno da entrada 2.15 kg/s e se afaste cada vez mais deste ponto

com o passar do tempo. O perfil do sinal de entrada e? mostrado na figura 4.47, e a

sa??da correspondente e? mostrada na figura 4.48. Apesar da regia?o de operac?a?o desejada

consistir do intervalo de u = 1.5 kg/s a u = 3.0 kg/s, tomou-se o cuidado do sinal de

entrada na?o avanc?ar demasiado em direc?a?o a esses limites, pois no regime transito?rio

a sa??da do sistema poderia atingir valores perigosamente fora da regia?o de interesse. A

durac?a?o total do sinal de teste e? de 15000 segundos, sendo formada por 75 patamares.

Estes dados foram utilizados para estimac?a?o dos para?metros do sistema.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 90

Figura 4.47: Sinal de entrada do sistema (vaza?o de ga?s injetado) para estimac?a?o de

para?metros do modelo na?o-linear

Figura 4.48: Pressa?o no tubo de produc?a?o (sa??da do sistema) para estimac?a?o de

para?metros do modelo na?o-linear



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 91

Tambe?m foi gerado um outro sinal com as mesmas caracter??sticas, mas com ou-

tra realizac?a?o de nu?mero aleato?rios para servir como dados de validac?a?o dos modelos

encontrados. A entrada utilizada para validac?a?o e? mostrada na figura 4.49 e a sa??da

correspondente na figura 4.50.

Figura 4.49: Sinal de entrada do sistema (vaza?o de ga?s injetado) para validac?a?o do

modelo na?o-linear

A determinac?a?o da taxa de reamostragem dos sinais foi feita conforme descrito na

sec?a?o 3.5, sendo a taxa inicial de amostragem utilizada de 1 segundo. A figura 4.51

mostra a autocovaria?ncia normalizada dos dados de estimac?a?o. No caso particular

deste sistema, a autocovaria?ncia normalizada linear do sinal de entrada coincide com a

autocovaria?ncia normalizada quadra?tica. O primeiro m??nimo de ry?(?) (e tambe?m de

ry?2 (?)) ocorre em ? = 742, de forma que a taxa de reamostragem deve satisfazer:

37 ? ? ? 74 (4.26)

Foi escolhido para este sistema um fator de reamostragem ? = 40, por ser a mesma

taxa utilizada para o caso linear, o que facilita eventuais comparac?o?es. Assim, o novo

tempo de amostragem e? Ts = 40 segundos. O conjunto de dados de estimac?a?o possui

enta?o 376 amostras.

Buscou-se um modelo com grau de na?o-linearidade ` = 2, ny = nu = 5, resul-

tando em 78 termos candidatos. Ale?m destes, incluiu-se 10 termos lineares de ru??do,



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 92

Figura 4.50: Pressa?o no tubo de produc?a?o (sa??da do sistema) para validac?a?o do modelo

na?o-linear

para eliminar a polarizac?a?o da estimac?a?o. O nu?mero de termos de ru??do foi esco-

lhido suficientemente grande para acomodar a dina?mica do ru??do. Poderia ocorrer que

fosse necessa?rio um nu?mero menor de termos, mas nesse caso a pro?pria estimac?a?o de

para?metros se encarregaria de estimar para?metros estatisticamente insignificantes para

os termos a mais. Caso o nu?mero de termos de ru??do fosse menor do que o necessa?rio,

tal fato se revelaria nas equac?o?es 3.89, 3.90 e 3.91. Como os termos que modelam o

ru??do sa?o descartados para simulac?a?o do modelo, na?o e? problema?tico ter mais termos

para o ru??do do que o estritamente necessa?rio, mas e? cr??tico ter um nu?mero m??nimo de

termos.

Em seguida, identificou-se um conjunto de modelos com nu?mero crescente de termos

selecionados pelo crite?rio ERR e calculou-se o coeficiente de agrupamento de termos,

para detectar eventuais agrupamentos de termos espu?rios. A figura 4.52 mostra o

coeficiente de agrupamentos dos 6 conjuntos existentes (?0, ?y, ?y2 , ?u, ?u2 e ?yu)

nos termos candidatos. Observando-se a figura em busca de ind??cios de agrupamentos

espu?rios, percebemos que o coeficiente de agrupamento ?y2 e? inclu??do tardiamente no

modelo. Portanto, exclui-se os regressores que compo?em esse agrupamento do conjunto

de termos candidatos. Ale?m do agrupamento ?y2 ser espu?rio segundo o teste feito, ele e?

indeseja?vel no conjunto de regressores candidatos, pois se deseja um modelo NARMAX



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 93

Figura 4.51: Func?a?o de autocovaria?ncia normalizada do sinal de sa??da usada para defi-

nir o fator de reamostragem adequado para a identificac?a?o na?o-linear (a autocovaria?ncia

normalizada linear e quadra?tica sa?o iguais neste caso)

polinomial com somente um ponto fixo (ver equac?a?o 3.86). O novo conjunto de termos

candidatos passa a ter enta?o 63 termos de processo candidatos em 5 agrupamentos:

?0, ?y, ?u, ?u2 e ?yu.

O crite?rio ERR foi utilizado para ordenar os termos que devem ser inclu??dos no

modelo final. Para a selec?a?o do ponto de corte, ou seja, do nu?mero de termos que

o modelo efetivamente vai incluir utilizou-se o crite?rio de Akaike. Para cada nu?mero

de para?metros no modelo, estimou-se um modelo com esta quantidade de para?metros

e efetuou-se uma simulac?a?o livre do modelo. Em seguida, calculou-se os res??duos do

modelo confrontado com os dados de validac?a?o. Estes res??duos foram utilizados para

o ca?lculo do AIC. A figura 4.53 mostra os valores do crite?rio de Akaike para diferentes

nu?meros de termos no modelo. O menor valor do AIC corresponde ao seguinte modelo

com 8 termos de processo (mais 10 termos de ru??do para eliminar a polarizac?a?o da

estimac?a?o de para?metros), sendo o valor dos para?metros estimados, os respectivos



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 94

Figura 4.52: Coeficientes de agrupamento do modelo NARMAX obtido para o sistema

excitado com uma entrada “agressiva” em func?a?o do nu?mero de para?metros do modelo

ERR e desvio padra?o do para?metro estimado listados na tabela 4.3:

y(k) = +2.48317 y(k ? 1)
?1.99585 y(k ? 2)
+5.07796×10?1 y(k ? 3)
+2.78594×10?2 u(k ? 2)y(k ? 3)
+2.75746×10?3 u(k ? 2)u(k)
+3.06819×10?2

?4.90432×10?4 u(k ? 4)u(k)
?3.12171×10?2 u(k ? 2)y(k ? 2)
+?(k)

(4.27)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 95

Ordem Regressor ??i ERR ?

1 y(k ? 1) +2.48317 +9.99997×10?1 +5.80593×10?2

2 y(k ? 2) ?1.99585 +2.35586×10?6 +1.55969×10?1

3 y(k ? 3) +5.07796×10?1 +1.11143×10?7 +1.08937×10?1

4 u(k ? 2)y(k ? 3) +2.78594×10?2 +1.97021×10?8 +3.60594×10?2

5 u(k ? 2)u(k) +2.75746×10?3 +1.36129×10?8 +3.35207×10?4

6 constante +3.06819×10?2 +5.99208×10?9 +6.99328×10?3

7 u(k ? 4)u(k) ?4.90432×10?4 +3.87273×10?9 +2.54059×10?4

8 u(k ? 2)y(k ? 2) ?3.12171×10?2 +1.40659×10?9 +3.61177×10?2

Tabela 4.3: Termos do modelo NARMAX identificado para uma entrada agressiva, em

ordem do valor de ERR. ??i e? o valor do para?metro estimado e ? e? o valor do desvio

padra?o do para?metro estimado

onde ?(k) conte?m os 10 termos lineares de res??duo, na?o sendo necessa?rios a? simulac?a?o

do sistema:
?(k) = ?5.84466×10?1 ?(k ? 1)

?2.61484×10?1 ?(k ? 7)
+1.30859×10?1 ?(k ? 3)
?1.28290×10?1 ?(k ? 2)
?1.99363×10?1 ?(k ? 10)
?8.05819×10?2 ?(k ? 8)
?1.43919×10?1 ?(k ? 5)
?1.23529×10?1 ?(k ? 6)
+7.61805×10?2 ?(k ? 4)
?2.52195×10?2 ?(k ? 9).

(4.28)

Observando-se o valor dos para?metros estimados (??i) e comparando-se com o valor

do desvio padra?o dos para?metros na tabela 4.3, podemos testar se os para?metros esti-

mados sa?o estatisticamente significativos. Para uma confianc?a de 99%, os para?metros

sera?o estatisticamente insignificantes se ?3?i ? ??i ? 3?i. Portanto, os para?metros
correspondentes aos termos u(k ? 2)y(k ? 3), u(k ? 4)u(k) e u(k ? 2)y(k ? 2) na?o
te?m significa?ncia estat??stica e devem ser removidos do conjunto de termos candidatos,

sendo necessa?ria a estimac?a?o de um novo modelo.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 96

Figura 4.53: Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-

MAX do sistema excitado por uma entrada agressiva

Os seguintes passos foram enta?o executados de forma iterativa: gerou-se um novo

conjunto de termos candidatos sem os termos considerados insignificantes estatisti-

camente, ordenou-se estes termos pelo ERR, definiu-se o nu?mero de termos a serem

inclu??dos com o uso do AIC e verificou-se a significa?ncia estat??stica dos termos do

modelo encontrado. O modelo encontrado possui 6 termos de processo:

y(k) = +2.01356 y(k ? 1)
?1.01002 y(k ? 2)
?3.49843×10?2 u(k ? 4)y(k ? 2)
+2.37093×10?2 u(k ? 4)y(k ? 5)
+3.09134×10?2 u(k ? 4)
+8.50101×10?4 u2(k) + ?(k)

(4.29)

onde ?(k) conte?m os termos do tipo MA utilizados para evitar a polarizac?a?o da esti-

mativa dos para?metros.

A tabela 4.4 mostra os termos de processo inclu??dos, juntamente com o ERR e o

desvio padra?o da estimativa dos para?metros, onde desta vez se verifica que todos os

termos inclu??dos sa?o estatisticamente significativos com 99% de probabilidade.

Este modelo foi validado estatisticamente, satisfazendo a?s equac?o?es 3.89, 3.90 e

3.91, que garantem que na?o ha? dina?mica na?o modelada nos res??duos. Para validac?a?o



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 97

Ordem Regressor ??i ERR ?

1 y(k ? 1) +2.01356 +9.99997×10?1 +2.23668×10?2

2 y(k ? 2) ?1.01002 +2.35586×10?6 +2.24378×10?2

3 u(k ? 4)y(k ? 2) ?3.49843×10?2 +7.57968×10?8 +2.93181×10?3

4 u(k ? 4)y(k ? 5) +2.37093×10?2 +4.70686×10?8 +3.52717×10?3

5 u(k ? 4) +3.09134×10?2 +1.03597×10?8 +2.84186×10?3

6 u2(k) +8.50101×10?4 +1.18979×10?8 +7.68678×10?5

Tabela 4.4: Termos do modelo NARMAX identificado para uma entrada agressiva, em

ordem do valor de ERR, com todos os para?metros estatisticamente significativos. ??i e?

o valor do para?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado

dina?mica, recorreu-se a uma comparac?a?o entre a sa??da do modelo encontrado e os dados

reais de validac?a?o, mostrada na figura 4.54. O ajuste da sa??da do modelo aos dados

reais e? de 87.78% que e? bastante superior ao desempenho obtido pelos modelos lineares

(ver tabela 4.2), ainda mais quando se considera que no caso linear a entrada oscilou

com pequena amplitude em torno dos pontos de linearizac?a?o e no caso na?o-linear houve

uma grande variac?a?o na amplitude da entrada.

Para calcular os pontos fixos do modelo encontrado, recorre-se a? equac?a?o 3.87, resul-

tando na figura 4.55, que mostra a localizac?a?o dos pontos fixos do modelo comparada

com a do sistema real. Percebe-se que dentro da faixa de operac?a?o do sistema (que e? de

Qi = 1.5 kg/s a Qi = 3 kg/s), o modelo aproxima razoavelmente bem o a caracter??stica

esta?tica real. Na parte central da faixa de operac?a?o o ajuste e? praticamente exato e nas

extremidades ocorre um pequeno erro do modelo em relac?a?o ao sistema real (0.59% em

Qi = 1.5 kg/s e -2.76% em Qi = 3 kg/s). Na figura 4.55 este erro pode parecer maior

devido a? escala utilizada para o eixo das ordenadas.

Para que o modelo encontrado possa ser usado em aplicac?o?es de controle preditivo,

na?o pode haver um modelo instanta?neo entre a entrada e a sa??da, ou seja, na?o podem

existir termos contendo u(k). Assim, foi identificado um outro modelo, a partir dos

dados “agressivos”, que possa ser u?til para tais aplicac?o?es. Para encontrar um modelo

que ainda seja representativo do sistema, foi necessa?rio reduzir o tempo de amostragem

para Ts = 20 segundos, resultando no seguinte modelo (ver tambe?m tabela 4.5), com



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 98

Figura 4.54: Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma

entrada agressiva comparada com os dados de validac?a?o

ajuste de 73.1% aos dados de validac?a?o:

y(k) = +2.06136 y(k ? 1)
?1.06075 y(k ? 2)
?9.36609×10?1 u(k ? 5)y(k ? 2)
+6.26485×10?2 u(k ? 5)y(k ? 6)
+3.13088×10?1 u(k ? 5)y(k ? 1)
+1.01030 u(k ? 5)y(k ? 3)
?4.51079×10?1 u(k ? 5)y(k ? 4)
+4.18587×10?3 u(k ? 5)
+2.24055×10?4 u(k ? 1)u(k ? 1) + ?(k)

(4.30)

4.5.2 Identificac?a?o usando sinal de entrada “comportado”

Na sec?a?o 4.5.1 foi identificado um modelo NARMAX que representou adequada-

mente a dina?mica do sistema em ana?lise. No entanto, a entrada utilizada para identi-

ficac?a?o do sistema era muito “agressiva”, por apresentar variac?o?es abruptas e, portanto,

representa um risco maior de danos aos equipamentos.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 99

Figura 4.55: Pontos fixos do modelo NARMAX identificado com a entrada agressiva

em func?a?o da vaza?o de injec?a?o de ga?s, comparado com os pontos fixos do sistema real

Nesta sec?a?o sera? feita a identificac?a?o de um modelo NARMAX com o uso de uma

entrada mais bem “comportada”, ou seja, com variac?o?es mais suaves, de forma a di-

minuir os riscos ao patrimo?nio. A entrada “comportada” aplicada no sistema e? uma

reutilizac?a?o dos dados utilizados para a identificac?a?o linear. Assim, sendo u1.5 e y1.5

as se?ries colhidas respectivamente na entrada e na sa??da do sistema, utilizadas para

identificac?a?o linear em torno do ponto de operac?a?o 1.5 kg/s (ver sec?a?o 4.4.1), pode-se

formar a matriz ?1.5 contendo os regressores candidatos para a identificac?a?o na?o-linear.

Da mesma maneira, pode-se formar a matriz ?2.15 com as se?ries u2.15 e y2.15 e a matriz

?2.8 com os se?ries u2.8 e y2.8. As se?ries u2.15 e y2.15 foram utilizadas para identificac?a?o

linear em torno de 2.15 kg/s (sec?a?o 4.4.2) e as se?ries u2.8 e y2.8 foram utilizadas para

identificac?a?o linear em torno de 2.8 kg/s (sec?a?o 4.4.3). Assim:

?1.5 = f(u1.5 , y1.5) (4.31)

?2.15 = f(u2.15 , y2.15) (4.32)

?2.8 = f(u2.8 , y2.8) (4.33)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 100

Ordem Regressor ??i ERR ?

1 y(k ? 1) +2.06136 +9.99999×10?1 +3.11657×10?2

2 y(k ? 2) ?1.06075 +6.17695×10?7 +3.11643×10?2

3 u(k ? 5)y(k ? 2) ?9.36609×10?1 +3.75491×10?9 +1.33013×10?1

4 u(k ? 5)y(k ? 6) +6.26485×10?2 +4.49870×10?9 +1.00275×10?2

5 u(k ? 5)y(k ? 1) +3.13088×10?1 +5.36415×10?10 +4.96058×10?2

6 u(k ? 5)y(k ? 3) +1.01030 +7.87245×10?10 +1.44218×10?1

7 u(k ? 5)y(k ? 4) ?4.51079×10?1 +3.75076×10?10 +7.11290×10?2

8 u(k ? 5) +4.18587×10?3 +1.16190×10?10 +6.85643×10?4

9 u(k ? 1)u(k ? 1) +2.24055×10?4 +2.76396×10?10 +2.85129×10?5

Tabela 4.5: Termos do modelo NARMAX identificado para uma entrada agressiva, em

ordem do valor de ERR, para aplicac?a?o em controle preditivo. ??i e? o valor do para?metro

estimado e ? e? o valor do desvio padra?o do para?metro estimado

e pode-se definir a matriz ? contendo todos as restric?o?es:

? =

?
???

?1.5

?2.15

?2.8

?
??? , (4.34)

a ser utilizada nos algoritmos de estimac?a?o de para?metros.

Os dados utilizados para estimac?a?o de para?metros na?o sa?o ideais do ponto de vista

de identificac?a?o, pois o sinal de entrada fica restrito a tre?s regio?es de operac?a?o do

sistema, na?o excursionando por toda a faixa de interesse (entrada variando de 1.5 kg/s

a 3 kg/s). Pore?m, o uso deste conjunto de dados te?m duas vantagens claras sobre o

sinal de entrada utilizado na sec?a?o 4.5.1:

• Representa menos risco ao patrimo?nio, por ser uma entrada mais comportada;

• Permite a continuidade da produc?a?o durante a execuc?a?o dos testes, pois a um
sinal constante na entrada adiciona-se apenas uma pequena variac?a?o.

Para a validac?a?o dos modelos obtidos nesta sec?a?o, utilizou-se o mesmo conjunto de

dados utilizados na validac?a?o dos modelos da sec?a?o 4.5.1, ou seja, usou-se a entrada

mostrada na figura 4.49 e a sa??da mostrada na figura 4.50. O uso destes dados foi feito



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 101

para que os modelos obtidos nesta sec?a?o sejam testados de forma mais “agressiva” do

que os dados de estimac?a?o, ale?m de permitir uma comparac?a?o direta entre os ??ndices

de ajuste do modelo nas duas sec?o?es.

Inicialmente, utilizou-se as func?o?es de autocovaria?ncia definidas nas equac?o?es 3.5 e

3.6, sendo que a taxa de reamostragem escolhida deve satisfazer a equac?a?o 3.8 nos tre?s

conjuntos de dados. Verificou-se que e? poss??vel escolher a mesma taxa de reamostragem

das sec?o?es anteriores (? = 40), resultando em Ts = 40 segundos.

Passou-se enta?o a buscar modelos candidatos, com grau de na?o-linearidade ` = 2,

ny = nu = 5, e mais 10 termos lineares de ru??do para eliminar a polarizac?a?o da es-

timac?a?o, como descrito anteriormente na sec?a?o 4.5.1. Do conjunto de termos candidatos

foi eliminado o agrupamento de termos ?y2 pois se deseja um modelo com apenas um

ponto fixo.

Apo?s a classificac?a?o dos demais termos candidatos com o uso do ERR, eliminac?a?o

dos agrupamentos espu?rios (o agrupamento ?0 mostrou tambe?m aqui ser espu?rio), a

definic?a?o do nu?mero de termos a serem inclu??dos no modelo com o uso do AIC (ver

figura 4.56), a verificac?a?o da significa?ncia estat??stica dos para?metros estimados e a

repetic?a?o iterativa deste processo ate? que todos os para?metros sejam significativos,

chegou-se ao modelo:

y(k) = +2.84619 y(k ? 1)
?2.23221 y(k ? 2)
+3.88183×10?1 y(k ? 4)
?7.26036×10?3 u(k ? 2)y(k ? 1)
+5.29649×10?3 u(k)
+2.78799×10?3 u(k ? 5)
?2.67362×10?1 u(k ? 3)y(k ? 1)
+1.25873×10?2 u(k ? 2)
?1.22951×10?3 u(k ? 5)u(k ? 3)
+3.64800×10?1 u(k ? 3)y(k ? 2)
?9.75874×10?2 u(k ? 3)y(k ? 4)
+1.73758×10?3 u(k ? 2)u(k ? 2)
+?(k)

(4.35)

que possui 12 termos de processo e onde ?(k) corresponde aos 10 termos lineares do

tipo me?dia mo?vel utilizados para eliminar a polarizac?a?o da estimativa dos para?metros.



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 102

Figura 4.56: Valor do AIC em func?a?o do nu?mero de para?metros para modelos NAR-

MAX do sistema excitado por uma entrada comportada

Os termos inclu??dos, com os respectivos ERR e desvio padra?o sa?o mostrados na

tabela 4.6. Este modelo antes de tudo foi validado estatisticamente, satisfazendo a?s

equac?o?es 3.89, 3.90 e 3.91. Uma comparac?a?o entre os dados de validac?a?o e a simulac?a?o

livre do modelo pode ser vista na figura 4.57. O modelo teve um ajuste de 91.2% aos

dados de validac?a?o, que e? um desempenho excelente. O fato do ajuste deste modelo aos

dados de validac?a?o ser superior ao ajuste aos mesmos dados do modelo encontrado na

sec?a?o 4.5.1 (ajuste de 87.78%) na?o significa que o modelo encontrado nesta sec?a?o seja

“melhor” em todos os sentidos. Um ensaio utilizando uma outra entrada pode resultar

numa mundanc?a nos ??ndices de desempenho, que esta?o pro?ximos. Ale?m disso, como o

modelo descrito na equac?a?o 4.29 possui apenas 6 termos de processo (contra 12 termos

do modelo desta sec?a?o - equac?a?o 4.35) mostra que aquele modelo e? mais “conciso” para

descrever os dados e e? mais facilmente manipula?vel, que sa?o caracter??sticas deseja?veis

num modelo “ideal”. Pode-se dizer que ambos os modelos descrevem satisfatoriamente

a dina?mica do sistema em ana?lise, dentro da faixa de operac?a?o desejada.

A figura 4.58 mostra a caracter??stica esta?tica do modelo, comparada com a carac-

ter??stica esta?tica do sistema real. Percebe-se que os pontos fixos do modelo esta?o muito

pro?ximos dos pontos fixos do sistema real. O modelo encontrado nesta sec?a?o possui

uma caracter??stica esta?tica mais pro?xima do sistema real do que o modelo encontrado

na sec?a?o 4.5.1. A explicac?a?o prova?vel para esta melhora e? que a entrada agressiva



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 103

Ordem Regressor ??i ERR ?

1 y(k ? 1) +2.84619 +9.99997×10?1 +3.94354×10?2

2 y(k ? 2) ?2.23221 +2.97116×10?6 +5.70014×10?2

3 y(k ? 4) +3.88183×10?1 +1.59919×10?7 +1.83896×10?2

4 u(k ? 2)y(k ? 1) ?7.26036×10?3 +5.01335×10?10 +5.33763×10?4

5 u(k) +5.29649×10?3 +2.99404×10?8 +1.78812×10?4

6 u(k ? 5) +2.78799×10?3 +4.68878×10?9 +6.50890×10?4

7 u(k ? 3)y(k ? 1) ?2.67362×10?1 +1.60423×10?9 +2.23946×10?2

8 u(k ? 2) +1.25873×10?2 +7.31568×10?10 +2.18152×10?3

9 u(k ? 5)u(k ? 3) ?1.22951×10?3 +1.47531×10?9 +2.48621×10?4

10 u(k ? 3)y(k ? 2) +3.64800×10?1 +1.58334×10?9 +3.17758×10?2

11 u(k ? 3)y(k ? 4) ?9.75874×10?2 +1.13923×10?9 +9.86630×10?3

12 u(k ? 2)u(k ? 2) +1.73758×10?3 +1.16196×10?9 +2.33335×10?4

Tabela 4.6: Termos do modelo NARMAX identificado para uma entrada comportada,

em ordem do valor de ERR, com todos os para?metros estatisticamente significativos. ??i

e? o valor do para?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado

Figura 4.57: Simulac?a?o livre do modelo NARMAX encontrado com o uso de uma

entrada comportada comparada com os dados de validac?a?o



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 104

excursionava por uma ampla faixa, mas concentrava-se em torno da me?dia do sinal

(u = 2.15 kg/s). A entrada comportada, por outro lado, na?o excursionava por uma

ampla faixa, mas tinha valores de entrada concentrados em torno de 3 pontos (u = 1.5,

u = 2.15 e u = 2.8 kg/s). Assim, o estimador tinha “dados melhores”, ao menos para

estimar a caracter??stica esta?tica do sistema.

Figura 4.58: Pontos fixos do modelo NARMAX identificado com a entrada comportada

em func?a?o da vaza?o de injec?a?o de ga?s, comparado com os pontos fixos do sistema real

Finalmente, para uma poss??vel aplicac?a?o em controle preditivo, foi identificado um

modelo sem termos contendo u(k). Este modelo esta? listado a seguir (ver tambe?m



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 105

Ordem Regressor ??i ERR ?

1 y(k ? 1) +2.84173 +9.99997×10?1 +4.92964×10?2

2 y(k ? 2) ?2.19893 +2.97116×10?6 +6.92244×10?2

3 y(k ? 4) +3.60274×10?1 +1.59919×10?7 +2.17346×10?2

4 u(k ? 2)y(k ? 1) ?1.03589×10?2 +5.01335×10?10 +8.82645×10?4

5 u(k ? 2) +2.30653×10?2 +1.77098×10?8 +2.49163×10?3

6 u(k ? 1) +6.65549×10?3 +6.26630×10?9 +4.81868×10?4

7 u(k ? 3)y(k ? 1) ?3.12043×10?1 +2.03759×10?9 +3.44452×10?2

8 u(k ? 3)y(k ? 2) +4.15930×10?1 +2.77158×10?9 +4.80461×10?2

9 u(k ? 2)u(k ? 2) +1.90760×10?3 +2.74267×10?9 +2.42476×10?4

10 u(k ? 3)y(k ? 4) ?1.04140×10?1 +1.06766×10?9 +1.43814×10?2

11 u(k ? 5)u(k ? 3) ?1.20889×10?3 +1.85126×10?9 +2.12560×10?4

Tabela 4.7: Termos do modelo NARMAX identificado para uma entrada comportada,

em ordem do valor de ERR, para aplicac?a?o em controle preditivo. ??i e? o valor do

para?metro estimado e ? e? o valor do desvio padra?o do para?metro estimado

tabela 4.7), com ajuste de 82.9% aos dados de validac?a?o:

y(k) = +2.84173 y(k ? 1)
?2.19893 y(k ? 2)
+3.60274×10?1 y(k ? 4)
?1.03589×10?2 u(k ? 2)y(k ? 1)
+2.30653×10?2 u(k ? 2)
+6.65549×10?3 u(k ? 1)
?3.12043×10?1 u(k ? 3)y(k ? 1)
+4.15930×10?1 u(k ? 3)y(k ? 2)
+1.90760×10?3 u(k ? 2)u(k ? 2)
?1.04140×10?1 u(k ? 3)y(k ? 4)
?1.20889×10?3 u(k ? 5)u(k ? 3) + ?(k)

(4.36)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 106

4.6 Comparac?a?o entre os modelos identificados

Neste trabalho foram identificados 5 modelos, sendo 3 lineares (em torno dos pontos

de operac?a?o dados pelas entradas Qi = 1.5 kg/s, Qi = 2.15 kg/s e Qi = 2.8 kg/s) e 2

na?o-lineares (um identificado com o uso de uma entrada “agressiva” e outro identificado

com uma entrada mais “comportada”). Esta sec?a?o visa promover uma comparac?a?o en-

tre os modelos lineares e na?o-lineares, de forma a justificar o aumento de complexidade

decorrente.

A tabela 4.6 faz uma s??ntese dos modelos encontrados, mostrando a parte deter-

min??stica dos modelos e desprezando os termos MA utilizados para evitar a polarizac?a?o

das estimativas. A tabela 4.9 faz um comparativo do desempenho dos modelos encon-

trados, utilizando sinais PRBS em torno de 3 pontos de operac?a?o na entrada: u0 = 1.5,

u0 = 2.15 e u0 = 2.8 kg/s. O sinal PRBS utilizado e? o mesmo variando apenas a sua

amplitude. O objetivo e? avaliar como os modelos se comportam em torno dos pontos

onde foram identificados os modelos lineares e quando afastados destas regio?es. Os

comenta?rios sobre a performance dos modelos lineares em torno aos valores de entrada

onde foram identificados podem ser vistos na sec?a?o 4.4.4. Quando o ponto de operac?a?o

e? mudado, a pro?pria linearizac?a?o utilizada (se mantida a mesma) invalidaria os mode-

los, o que pode ser visto observando-se as equac?o?es 4.1, 4.2, 4.3 ou o gra?fico 4.14. Para

montar a tabela 4.9, considerou-se que os valores de u0 e y0 tambe?m sa?o mudados nas

linearizac?o?es. Assim, para quantificar o ajuste do modelo L1.5 aos dados gerados para

uma entrada em torno de u0 = 2.15 kg/s, por exemplo, utilizou-se os pontos fixos da-

dos pela equac?a?o 4.2, referente ao modelo L2.15, mas com a dina?mica dada pelo modelo

L1.5.

Mesmo com essas alterac?o?es, os modelos lineares se mostraram de pouca valia

quando afastado do ponto onde foram identificados. No pior caso para o modelo L2.8,

quando utilizado em torno do ponto u0 = 1.5 kg/s, o seu uso se revela praticamente

igual ao uso da me?dia da sa??da como preditor trivial (ajuste pro?ximo a 0%), o que pode

ser visto na figura 4.59. O modelo L1.5, por outro lado, possui desempenho negativo

quando utilizado em outros pontos de operac?a?o. O desempenho negativo significa que

o uso do modelo para predizer o comportamento do sistema e? pior do que o uso da

me?dia como preditor trivial. Isso ocorre porque o modelo L1.5 possui um ganho esta?tico

muito superior ao ganho esta?tico do sistema operando na regia?o das entradas 2.15 e 2.8

kg/s. A figura 4.60 mostra uma comparac?a?o da sa??da do modelo L1.5 quando operando



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 107

em torno da entrada 2.8 kg/s, onde e? fa?cil ver como o ganho esta?tico elevado do modelo

torna-o inu?til para operar naquela regia?o.

Figura 4.59: Simulac?a?o livre dos modelos ARMAX L1.5 e L2.8 comparados com a sa??da

real do sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5

kg/s, mostrando que neste caso o desempenho do modelo L2.8 fica muito aque?m do

esperado

Assim, como ja? era esperado, o uso dos modelos lineares fica restrito a uma faixa

muito estreita em torno do ponto onde foram linearizados. Ja? os modelos na?o-lineares

foram gerados justamente para representar a dina?mica do sistema numa faixa maior

de operac?a?o. O modelo NLC demonstra cumprir seu objetivo, apresentando um ajuste

compara?vel ao modelo linear em torno de u0 = 2.8 kg/s e ligeiramente inferior em torno

de u0 = 2.15 e u0 = 1.5 kg/s. A figura 4.61, por exemplo, mostra uma comparac?a?o

da sa??da do modelo NLC com o sistema para uma entrada PRBS oscilando em torno

de u0 = 1.5 kg/s e amplitude 0.6 kg/s. Apesar da sa??da do modelo estar ligeiramente

afastada da sa??da do sistema real, o modelo ainda mostra-se u?til para representar

a dina?mica do sistema. Juntando isso com o o?timo ajuste do modelo a? curva da

caracter??stica esta?tica do sistema (figura 4.58), tem-se que o modelo NLC foi o que

apresentou melhor performance dentre os modelos identificados.

Do modelo NLA esperava-se que representasse o melhor desempenho, pois os dados

utilizados como entrada do sistema eram os que mais pro?ximos estavam do ideal teo?rico



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 108

Modelo Co?digo Parte determin??stica

Linear em torno de 1.5 L1.5

y(k) = 2.634y(k ? 1) ? 2.319y(k ? 2)
+0.6755y(k ? 3)
+0.01326u(k ? 1) ? 0.01763u(k ? 2)

Linear em torno de 2.15 L2.15

y(k) = 2.492y(k ? 1) ? 2.087y(k ? 2)
+0.5826y(k ? 3)
+0.0121u(k ? 1) ? 0.01423u(k ? 2)

Linear em torno de 2.8 L2.8

y(k) = 2.324y(k ? 1) ? 1.8y(k ? 2)
+0.4617y(k ? 3)
+0.01227u(k ? 1) ? 0.01301u(k ? 2)

Na?o-Linear Agressivo NLA

y(k) = +2.01356 y(k ? 1)
?1.01002 y(k ? 2)
?3.49843×10?2 u(k ? 4)y(k ? 2)
+2.37093×10?2 u(k ? 4)y(k ? 5)
+3.09134×10?2 u(k ? 4)
+8.50101×10?4 u2(k)

Na?o-Linear Comportado NLC

y(k) = +2.84619 y(k ? 1)
?2.23221 y(k ? 2)
+3.88183×10?1 y(k ? 4)
?7.26036×10?3 u(k ? 2)y(k ? 1)
+5.29649×10?3 u(k)
+2.78799×10?3 u(k ? 5)
?2.67362×10?1 u(k ? 3)y(k ? 1)
+1.25873×10?2 u(k ? 2)
?1.22951×10?3 u(k ? 5)u(k ? 3)
+3.64800×10?1 u(k ? 3)y(k ? 2)
?9.75874×10?2 u(k ? 3)y(k ? 4)
+1.73758×10?3 u(k ? 2)u(k ? 2)

Tabela 4.8: Modelos lineares e na?o-lineares identificados



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 109

Ajuste dos Modelos

u0 Amplitude do sinal L1.5 L2.15 L2.8 NLA NLC

1.5 kg/s

0.2 kg/s 79.6% 16.8% 5.0% 10.5% 66.9%

0.4 kg/s 72.0% 14.8% 3.5% 20.1% 58.6%

0.6 kg/s 52.9% 10.3% 0.7% 22.1% 53.9%

2.15 kg/s

0.2 kg/s -166.6% 79.8% 37.6% 75.8% 68.4%

0.4 kg/s -172.4% 80.5% 33.7% 72.6% 74.6%

0.6 kg/s -158.8% 74.0% 31.5% 68.5% 70.9%

2.8 kg/s

0.2 kg/s -545.5% -27.7% 75.7% 19.4% 70.4%

0.4 kg/s -554.8% -28.4% 75.1% 28.8% 70.7%

0.6 kg/s -563.5% -30.7% 70.1% 23.0% 64.6%

Tabela 4.9: Comparac?a?o do desempenho dos modelos, para entradas PRBS oscilando

em torno da entrada u0, com diferentes amplitudes ma?ximas

Figura 4.60: Simulac?a?o livre do modelo ARMAX L1.5 comparado com a sa??da real do

sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 2.8 kg/s



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 110

Figura 4.61: Simulac?a?o livre do modelo ARMAX NLC comparado com a sa??da real do

sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5 kg/s

para identificac?a?o de sistemas na?o-lineares. No entanto, a performance do modelo

degradou-se fora do entorno da entrada u0 = 2.15 kg/s, como pode ser visto na figura

4.62 que mostra uma comparac?a?o da sa??da do modelo com o sistema, para uma entrada

em torno de u0 = 1.5 kg/s com amplitude 0.6 kg/s. A principal raza?o que explica o

fraco desempenho do modelo NLA quando comparado com o modelo NLC e? que o

sinal de entrada usado para gerar os dados de estimac?a?o para o modelo NLA tinham

como centro o ponto u0 = 2.15 kg/s e na?o chegavam a atingir, por uma questa?o de

seguranc?a, os extremos da regia?o de operac?a?o do sistema. Assim, o estimador na?o tinha

informac?o?es sobre o comportamento do sistema nos extremos da regia?o de operac?a?o,

devendo extrapolar os dados para tanto. A figura 4.63 mostra o histograma dos valores

de u(k) aplicado ao sistema para identificac?a?o, no caso de um sinal agressivo e no caso

de um sinal comportado. Percebe-se que a entrada comportada cobre um espectro

maior dos poss??veis valores de u(k), ao contra?rio do sinal agressivo, que concentra-se

me torno do centro da regia?o (u0 = 2.15 kg/s). Na figura 4.64 ve?-se o histograma de

valores de y(k), onde tambe?m percebe-se que o sinal comportado esta? mais distribu??do

do que o sinal agressivo. Na?o se pode esquecer, no entanto, que o sistema possui mais

de um estado, de forma que na?o somente o valor de y(k) e? importante, mas sim todos

os estados envolvidos deveriam ser excitados pela entrada (y(k?1), . . . ,y(k?ny)). As



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 111

figuras mencionadas servem somente como ind??cio do que causou a pior performance

do modelo NLA comparada com o modelo NLC .

Figura 4.62: Simulac?a?o livre do modelo ARMAX NLA comparado com a sa??da real do

sistema para uma entrada PRBS de amplitude 0.6 kg/s em torno de u0 = 1.5 kg/s

A gerac?a?o de um sinal de entrada aleato?rio que excite de forma mais uniforme o

sistema por toda a faixa de operac?a?o e? uma tarefa dif??cil pois possivelmente este sinal,

para garantir todas as propriedades estat??sticas exigidas, apresentara? variac?o?es muito

abruptas e dificilmente sera? aceito pelos supervisores do processo devido ao risco que

coloca a? integridade das instalac?o?es.

O modelo NLA na?o pode ser considerado “ruim”, apesar dos comenta?rios acima.

Validando-se o modelo com uma entrada similar a utilizada para estimar o seus

para?metros (ver figura 4.57), ve?-se que o modelo tem um bom ajuste (87.78%) mesmo

comparado ao modelo NLC (91.2%). Ale?m disso, o modelo NLA tem a vantagem de

ser mais conciso que o modelo NLC facilitando a sua utilizac?a?o, por exemplo, em al-

guma estrutura de controle que efetue a linearizac?a?o da equac?a?o atrave?s da entrada.

Assim, caso se pretenda trabalhar na maioria dos casos pro?ximo ao centro da regia?o

de operac?a?o definida, o modelo NLA e? adequado.

O modelo NLC , por outro lado, cumpriu seu papel de mostrar que e? poss??vel obter

um modelo na?o-linear com ampla faixa de validade, com base em dados obtidos sem



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 112

Figura 4.63: Histograma de valores da entrada u(k) para a entrada agressiva e com-

portada

Figura 4.64: Histograma de valores da sa??da y(k) para a entrada agressiva e comportada



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 113

grandes alterac?o?es na operac?a?o normal do processo. Foi poss??vel obter este modelo

somente porque a na?o-linearidade presente na?o e? muito severa, na?o havendo grandes

mudanc?as estruturais no sistema.

4.7 Comenta?rios ao controle do sistema

O objetivo deste trabalho e? encontrar modelos na?o-lineares do tipo NARMAX po-

linomial que fossem va?lidos para prever o comportamento do sistema para valores de

entrada oscilado entre 1.5 e 3 kg/s. Tal objetivo foi cumprido nas sec?o?es anteriores,

tendo sido mostrado a superioridade dos modelos na?o-lineares em relac?a?o aos linea-

res, para predizer a sa??da do sistema em diferentes pontos de operac?a?o. O controle

do sistema na?o faz parte do objetivo deste trabalho, no entanto nesta sec?a?o tecem-se

algumas considerac?o?es sobre o poss??vel uso dos modelos para controle.

A estrutura de controle que parece ser mais imediatamente aplica?vel aos modelos

encontrados e? o Controle Preditivo com Modelos Na?o-Lineares (NMPC - do ingle?s

Nonlinear Model Predictive Control ), que e? um caso particular do Controle Preditivo

com Modelos (MPC - do ingle?s Model Predictive Control ). MPC e? o nome dado a um

conjunto de algoritmos que busca controlar o comportamento futuro de um sistema

com base em um modelo de processo. A cada amostragem o controlador calcula uma

sequ?e?ncia de valores para a entrada do sistema (atuando em malha aberta) que otimiza

o comportamento futuro do sistema. O primeiro valor desta sequ?e?ncia e? enta?o aplicado

na entrada e toda rotina de otimizac?a?o e? executada novamente na pro?xima amostra

[35].

Uma vantagem do MPC em relac?a?o a outros me?todos de controle e? que no algo-

ritmo de otimizac?a?o podem ser incorporadas diretamente restric?o?es sobre as entradas

de controle e sobre as varia?veis controladas. A performance de um controlador MPC

depende criticamente das capacidades preditivas do modelo utilizado, sendo este mo-

delo comumente obtido na pra?tica por modelagem emp??rica [17]. Por esses motivos, os

modelos NARMAX polinomiais parecem ser especialmente indicados.

Dado um modelo SISO no espac?o de estados, na?o-linear a tempo discreto:

~x(k + 1) = f (~x(k),u(k),~v(k), ~w(k)) (4.37)

y(k) = g (~x(k)) + ?(k) (4.38)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 114

onde y(k) e? a sa??da do sistema, ~x(k) e? um vetor contendo os estados do sistema, u(k)

e? a entrada do sistema, ~v(k) sa?o perturbac?o?es mensura?veis, ~w(k) sa?o perturbac?o?es na?o

mensura?veis (ou ru??do) e ?(k) e? o ru??do de medic?a?o, o problema do controle preditivo

consiste em calcular uma sequ?e?ncia de entradas {u(k)} que leve o sistema a um valor
ys(k). Um algoritmo de controle NMPC minimiza um objetivo similar a:

JN M P C =
P?

j=1

(ey(k + j)wyj)
2 +

M?1?
j=0

(?u(k + j)w?uj)
2 +

M?1?
j=0

(eu(k + j)wuj)
2 (4.39)

sujeito a?s restric?o?es do modelo:

~x(k + j) = f (~x(k + j ? 1),u(k + j ? 1)) (4.40)

y(k + j) = g (~x(k + j)) (4.41)

e a?s restric?o?es para o controle:

y
j

? y(k + j) ? yj ?j = 1,P

u ? u(k + j) ? u ?j = 0,M ? 1
?u ? ?u(k + j) ? ?u ?j = 0,M ? 1

(4.42)

Na equac?a?o 4.39, existem tre?s parcelas conflitantes:

ey(k + j) = y(k + j) ? ys(k + j) (4.43)

?u(k + j) = u(k + j) ? u(k + j ? 1) (4.44)

eu(k + j) = u(k + j) ? us(k + j) (4.45)

onde ey(k + j) penaliza o erro da sa??da do sistema, sobre um horizonte de predic?a?o P ,

?u(k + j) penaliza as variac?o?es abruptas na entrada e eu(k + j) penaliza os desvios em

relac?a?o ao valor desejado de us(k), sobre um horizonte de controle M. Os termos de

erro sa?o multiplicados por wyj, w?uj e wuj, permitindo atribuir pesos diferentes para

cada um dos tipos de erro e para cada instante de tempo do horizonte de predic?a?o.

Nas restric?o?es de controle dadas na equac?a?o 4.42, y
j

e yj sa?o os limites inferior e

superior, respectivamente, para a sa??da do sistema y(k) no instante de tempo k + j; u

e u sa?o os limites inferior e superior, respectivamente, para a entrada do sistema u(k);

e ?u e ?u sa?o os limites inferior e superior, respectivamente, para a variac?a?o aceita?vel

no sinal u(k) entre cada amostra.

A soluc?a?o do problema de otimizac?a?o resulta em um vetor ~uc com M valores de

entrada futura:

~uc =
[
u(k) u(k + 1) · · · u(k + M ? 1)

]T
(4.46)



Estudo de Caso: Aplicac?a?o a? Indu?stria Petrol??fera 115

O valor de u(k) e? usado como entrada na planta e todos os ca?lculos sa?o repetidos

na pro?xima amostra.

Alguns dos problemas que imediatamente surgem com o uso do NMPC sa?o:

• O uso de modelos na?o-lineares no controle MPC em geral leva a? perda de con-
vexidade no problema, o que significa que e? muito mais dif??cil de encontrar uma

soluc?a?o e na?o ha? garantia de que a soluc?a?o encontrada seja um o?timo global.

• Os algoritmos MPC para serem u?teis em aplicac?o?es industriais precisam convergir
rapidamente, o que pode na?o ser o caso quando se usa um modelo na?o-linear.

• Uma soluc?a?o o?tima para o controle na?o necessariamente implica em estabilidade
em malha fechada, mesmo quando o modelo representa a planta perfeitamente

[35].

Desta forma, limita-se aqui a indicar um poss??vel uso dos modelos encontrados,

deixando o estudo da aplicac?a?o em controle como sugesta?o para trabalhos futuros.



Cap??tulo 5

Considerac?o?es Finais

Neste trabalho foram identificados modelos lineares e na?o-lineares para um poc?o de

petro?leo operando por elevac?a?o artificial via injec?a?o cont??nua de ga?s. O uso de modelos

lineares revelou-se limitado pois o sistema possui uma caracter??stica esta?tica na?o-linear

e quando ocorre uma afastamento maior do ponto onde os modelos foram identificados,

eles rapidamente perdem sua validade. Ademais, a pro?pria dina?mica do sistema, dada

pelos po?los e zeros existentes e? alterada de acordo com o ponto de operac?a?o.

A escolha de varia?veis de entrada e sa??da para o sistema foi feita de forma a tornar o

sistema monovaria?vel e facilitar a implementac?a?o futura do controle do poc?o. Escolheu-

se como varia?vel de entrada a vaza?o ma?ssica de ga?s injetado no poc?o e como sa??da a

pressa?o no tubo de produc?a?o, sendo esta u?ltima dada pela diferenc?a entre a pressa?o na

cabec?a e no fundo do poc?o. A vantagem de escolher a pressa?o no tubo de produc?a?o

como varia?vel de sa??da e? que isto permite isolar a varia?vel de sa??da de flutuac?o?es da

pressa?o no separador. Ale?m disso, as varia?veis escolhidas sa?o facilmente mensura?veis

em qualquer poc?o, tornando fact??vel a implementac?a?o posterior do controle num sistema

real.

Mostrou-se a viabilidade de usar modelos do tipo NARMAX polinomial com grau

` = 2 para o sistema, tendo sido identificados dois modelos diferentes a partir de dois

conjuntos de dados: o primeiro conjunto de dados utiliza uma entrada mais “agressiva”

que visa excitar ao ma?ximo a dina?mica na?o-linear do sistema; o segundo utiliza uma

entrada mais bem “comportada”, consistindo no reaproveitamento dos dados utilizados

na identificac?a?o linear - sinais PRBS que fazem a entrada oscilar em torno dos tre?s

pontos de operac?a?o onde os modelos lineares foram identificado.



Considerac?o?es Finais 117

A estrate?gia que reutilizou dados da identificac?a?o linear para identificac?a?o de um

modelo na?o-linear mostrou ser bem sucedida, ao resultar num modelo com grande

ajuste da dina?mica e caracter??stica esta?tica em toda a regia?o de operac?a?o. Esta es-

trate?gia tem a vantagem de representar menor risco aos equipamentos, por utilizar

pequenas variac?o?es em torno a tre?s pontos de operac?a?o estrategicamente selecionados

dentro da regia?o de operac?a?o. Ale?m disso, as entradas utilizadas permitem a continui-

dade da produc?a?o do poc?o, na?o alterando significativamente a sua operac?a?o durante

a coleta de dados. Este ponto e? muito importante do ponto de vista econo?mico. Foi

poss??vel obter um modelo na?o-linear com o uso de uma entrada mais “comportada”

porque a na?o-linearidade existente no sistema na?o e? muito severa.

Como perspectivas para trabalhos futuros sugere-se:

• Implementac?a?o de estrate?gias de controle utilizando os modelos identificados, a
serem testadas no software OLGA 2000. Sugere-se como primeira abordagem

uma estrutura de controle preditivo por modelo na?o-linear (NMPC).

• Identificac?a?o de modelos e implementac?a?o do controle proto?tipo de poc?o operando
por gas-lift existente na UFSC e posteriormente em um poc?o real.

Um dos problemas que possivelmente surgira?o quando forem feitos testes em siste-

mas reais e? a existe?ncia de ru??do na medic?a?o, que pode exigir mais testes ate? encontrar

a relac?a?o sinal/ru??do ideal.



Refere?ncias Bibliogra?ficas

[1] AGARWAL, M. A systematic classification of neural-network-based control.

IEEE Control Systems Magazine, v. 17, n. 2, p. 75–93, Abril 1997.

[2] AGUIRRE, L. A.; MENDES, E. M. A. M. Global nonlinear polynomial models:

Structure, term clusters and fixed points. Int. J. Bifurcation and Chaos, v. 6,

n. 2, p. 279–294, 1995.

[3] AGUIRRE, L.; BILLINGS, S. Improved structure selection based on term

clustering. International Journal of Control, v. 62, n. 3, p. 569–587, 1995.

[4] AGUIRRE, L. A. Introduc?a?o a? Identificac?a?o de Distemas: Te?cnicas

Lineares e Na?o-Lineares Aplicadas a Sistemas Reais. 2a ed. Belo Horizonte:

Ed. UFMG, 2004.

[5] AGUIRRE, L. A.; RODRIGUES, G. G.; JACOME, C. R. F. Indentificac?a?o de

sistemas na?o-lineares utilizando modelos narmax polinomiais - uma revisa?o e novos

resultados. SBA Controle &amp;amp; Automac?a?o, v. 9, n. 2, p. 90–106, Maio-Agosto

1998.

[6] AKAIKE, H. A new look at the statistical model identification. IEEE

Transactions on Automatic Control, v. 19, n. 6, p. 716–723, dezembro 1974.

[7] BOX, G. E. P.; JENKINS, G. M.; REINSEL, G. C. Time Series Analysis:

Forecasting and Control. 3 ed. New Jersey: Prentice-Hall, 1994.

[8] BROSILOW, C.; JOSEPH, B. Techniques of model based control. Upper

Saddler River: Prentice Hall, 2002.

[9] CHEN, C.-T. Linear System Theory and Design. 3 ed. New York: Oxford

University Press, 1998.



Refere?ncias Bibliogra?ficas 119

[10] CHEN, S.; BILLINGS, S. A. Representation of non-linear systems: the narmax

model. International Journal of Control, v. 49, n. 3, p. 1013–1032, 1989.

[11] CHEN, S.; BILLINGS, S. A.; LUO, W. Orthogonal least squares methods and

their application to non-linear system identification. International Journal of

Control, v. 50, n. 5, p. 1873–1896, 1989.

[12] COELHO, A. A. R.; COELHO, L. S. Identificac?a?o de Sistemas Dina?micos

Lineares. Floriano?polis: Editora da UFSC, 2004.

[13] ECONOMIDES, M. J.; HILL, A. D.; EHLIG-ECONOMIDES, C. Petroleum

Production Systems. Upper Saddle River: Prentice Hall, 1993.

[14] EIKREM, G. O.; FOSS, B.; IMSLAND, L. Stabilization of gas lifted wells based

on state estimation. IFAC ADCHEM2003, Hong Kong, 2004.

[15] EIKREM, G. O. et al. Stabilization of gas lifted wells. Proceedings of the

IFAC 15th World Congress, Barcelona, 2002.

[16] ENDERS, W. Applied econometric time series. 1 ed. New York: John Wiley

&amp;amp; Sons, 1995.

[17] FOSS, B. A.; JOHANSEN, T. A.; SØRENSEN, A. V. Nonlinear predictive

control using local models - applied to a batch fermentation process. Control Eng.

Practice, v. 3, n. 3, p. 389–396, 1995.

[18] GLAD, T. Step responses of nonlinear non-minimum phase systems. In:

Preprints, 6th IFAC Symposium on Nonlinear Control Systems,

NOLCOS 2004. Stuttgart, Germany: [s.n.], 2004. p. 1445–1449.

[19] GOLUB, G. H.; Van Loan, C. F. Matrix Computations. 2 ed. Baltimore:

Johns Hopkins University Press, 1989.

[20] GUJARATI, D. N. Econometria Ba?sica. 3 ed. Sa?o Paulo: Makron Books,

2000.

[21] HAGAN, M.; DEMUTH, H. Neural networks for control. Invited Tutorial,

American Control Conference, San Diego, p. 1642–1656, Junho, 1999.

[22] IMSLAND, L.; EIKREM, G. O.; FOSS, B. State feedback control of a class of

positive systems: Application to gas lift control. ECC’03, Cambridge, 2003.



Refere?ncias Bibliogra?ficas 120

[23] JACOME, C. R. F. Uso de Conhecimento Pre?vio na Identificac?a?o de

Modelos Polinomiais NARMAX. Dissertac?a?o — Programa de Po?s-Graduac?a?o

em Engenharia Ele?trica, Universidade Federal de Minas Gerais, Belo Horizonte,

1996.

[24] LANGSTON, L. V. The Lease Pumpers Handbook. 1a. ed. Norman,

Oklahoma: Commission on Marginally Producing Oil and Gas Wells of Oklahoma,

2003.

[25] LEONTARITIS, I. J.; BILLINGS, S. A. Input-output parametric models for

non-linear systems. part i: deterministic non-linear systems; part ii: stochastic

non-linear systems. International Journal of Control, v. 41, n. 2, p. 303–344,

1985.

[26] LEONTARITIS, I. J.; BILLINGS, S. A. Model selection and validation methods

for non-linear systems. International Journal of Control, v. 45, n. 1, p. 311–341,

1987.

[27] LJUNG, L. System Identification Toolbox For Use With Matlab 6.0.

Natick, MA: The MathWorks, Inc., 2004.

[28] LJUNG, L.; GLAD, T. Modelling of Dynamical Systems. Englewwod Cliffs,

NJ: Prentice-Hall, 1994.

[29] MONTEIRO, L. H. A. Sistemas dina?micos. Sa?o Paulo: Editora Livraria da

F??sica, 2002.

[30] OGATA, K. Discrete-Time Control Systems. 2 ed. Englewood Cliffs, New

Jersey: Prentice-Hall, 1995.

[31] OGATA, K. Engenharia de Controle Moderno. 3 ed. Rio de Janeiro: LTC,

2000.

[32] PLUCENIO, A. Automac?a?o da Produc?a?o de Poc?os de Petro?leo Operando

com Elevac?a?o Artificial por Injec?a?o Cont??nua de Ga?s. Dissertac?a?o —

Programa de Po?s-Graduac?a?o em Engenharia Ele?trica, Universidade Federal de

Santa Catarina, Floriano?polis, 2003.

[33] PLUCENIO, A. Uma estrate?gia de controle para a elevac?a?o por gaslift.

Relato?rio interno do DAS - UFSC, 2004.



Refere?ncias Bibliogra?ficas 121

[34] POLLOCK, D. A Handbook of Time-Series Analysis, Signal Processing

and Dynamics. London: Academic Press, 1999.

[35] QIN, S. J.; BADGWELL, T. A. An overview of nonlinear model predictive

control applications. Nonlinear MPC Workshop, Ascona, Switzerland, 1998.

[36] Scandpower Petroleum Technologies. Olga 2000 v. 4.10 User Manual. Kjeller,

Norway: Scandpower P. T., 2003.

[37] TOMAS, J. E. Fundamentos de Engenharia de Petro?leo. Rio de Janeiro:

Editora Intercie?ncia, 2001.


	Introdução
	Modelagem de Sistemas Dinâmicos
	Introdução
	Classificação de Modelos
	Representações Lineares
	Representação Geral Discreta
	Modelos AR e ARX
	Modelos ARMA e ARMAX

	Representações não-Lineares e Modelos NARMAX

	Identificação de Sistemas
	Introdução
	Etapas na identificação de Sistemas
	Funções de Correlação
	Projeto do Sinal de Teste
	Determinação do período de amostragem
	Estimação de Parâmetros
	O Estimador de Mínimos Quadrados (MQ)
	O Método de MQ com Modelos Autoregressivos
	Polarização de Estimadores

	Critérios de Informação
	Ferramentas Utilizadas na Identificação de Sistemas não-Lineares
	Algoritmos MQ Ortogonais
	A Taxa de Redução de Erro
	Agrupamento de termos
	Característica estática

	Validação do Modelo

	Estudo de Caso: Aplicação à Indústria Petrolífera
	Introdução
	Descrição do Sistema
	O simulador Olga
	Identificação Linear
	Identificação em torno de u=1.5 kg/s
	Identificação em torno de u=2.15 kg/s
	Identificação em torno de u=2.8 kg/s
	Comentários sobre os modelos lineares identificados

	Identificação não-Linear
	Identificação usando sinal de entrada ``agressivo''
	Identificação usando sinal de entrada ``comportado''

	Comparação entre os modelos identificados
	Comentários ao controle do sistema

	Considerações Finais

</field>
	</doc>
</add>