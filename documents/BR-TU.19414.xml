<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19414</field>
		<field name="filename">2765_000976241.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

TRABALHO DE DIPLOMAÇÃO EM ENGENHARIA DE 
CONTROLE E AUTOMAÇÃO 

 

 

 

 

 

 

 

Controle antigolfadas na produção 
de petróleo por gas-lift 

 

 

 

 

Autor: Leonardo de Mattos Rolim 

Orientador: Prof. Dr. Marcelo Farenzena 

 

 

 

Porto Alegre, 8 de dezembro de 2014 

  



Controle antigolfadas na produção de petróleo por gas-lift ii 

Su má r i o  

 

Sumário ii 

Agradecimentos iv 

Resumo v 

Abstract vi 

Lista de Figuras vii 

Lista de Tabelas ix 

Lista de Símbolos x 

Lista de Abreviaturas e Siglas xi 

1 Introdução 1 

1.1 Objetivos 1 

1.2 Estrutura do Trabalho 1 

2 Revisão Bibliográfica 2 

2.1 Extração e produção de petróleo 2 

2.1.1 Sistemas para extração 2 

2.2 Escoamento multifásico e golfadas 2 

2.2.1 Características de bifurcação e ciclo limite 4 
2.2.2 Modelagem matemática 4 

2.3 Otimização da alocação de gas-lift 5 

2.4 Controle regulatório e garantia de escoamento 6 

2.4.1 Instrumentação dificultada 6 
2.4.2 Estratégias clássicas e prática de controle 7 
2.4.3 Controle não linear e controle robusto 7 
2.4.4 Inferência das pressões utilizando observadores lineares e não-lineares 8 
2.4.5 Terminologia da Instrumentação 9 

3 Materiais e Métodos 10 

3.1 Modelo do processo 10 

3.2 Metodologia computacional de resolução 14 

3.3 Formulação do Problema 16 

3.3.1 Acoplamento dos sistemas 16 
3.3.2 Seleção da estrutura para controle regulatório 16 
3.3.3 Denominação dos controladores 16 

4 Resultados e discussões 17 

4.1 Modelo com vazões de óleo e gás dependente das pressões no poço 17 

4.1.1 Acoplamento dos sistemas 17 

4.2 Bifurcação do modelo proposto 17 

4.2.1 Discussões 18 

4.3 Controladores utilizando os sensores no fundo do mar 18 



DEQUI / UFRGS – Leonardo de Mattos Rolim iii 

4.3.1 Experimento 1: Controladores com ??? (TPT) e ??? (PDG-TPT) como CVs 18 
4.3.2 Saturação da ação de controle e perda de controlabilidade 20 
4.3.3 Comparação dos controladores do poço 22 

4.4 Controladores utilizando os sensores na plataforma 23 

4.4.1 Limites de estabilidade para ??? (Pmon) e (??? ? ???) (TPT-Pmon) 23 

4.5 Limitações de instrumentação: atuadores e sensores 24 

4.5.1 Resultados dos degraus em malha fechada. 25 

4.6 Convergência do observador não linear simplificado 26 

4.6.1 Discussão 26 

5 Conclusões e Trabalhos Futuros 27 

5.1 Trabalhos futuros 27 

5.1.1 Análise de robustez 27 
5.1.2 Conexão com camada supervisória 27 

6 Referências 28 

7 Apêndices 31 

7.1 Modelo em diagrama de blocos do Simulink 31 

7.2 S-functions utilizadas no MATLAB 32 

7.2.1 Modelo flowline-riser 32 
7.2.2 Modelo poço com elevação por gas-lift 36 
7.2.3 Observador de estados 39 

 

  



Controle antigolfadas na produção de petróleo por gas-lift iv 

A gra d e c i me nto s  

 

Dedico este trabalho aos meus pais, Ana Elisa e Otavio, por todo o suporte que sempre me 
deram ao longo desta trajetória de vida. Minha família é o mais importante para mim, e 
tenho certeza de que eles me moldaram em como sou hoje e devo tudo a eles e a minhas 
duas irmãs, Rafaela e Fabiane. Agradeço também a minha parceira Miroo e sua família, por 
todo o suporte e companheirismo nestes últimos anos.  

Agradeço também a meus orientadores e professores com quem tive contato nesta 
trajetória, em especial aos meus professores orientadores Bor-chin Chang, Marcelo 
Farenzena, e Harry Kwatny, com os quais aprendi muito mais que conceitos e abordagens 
de engenharia. 

A meus colegas de universidade na UFRGS e na Drexel e aos engenheiros que trabalham 
comigo todos os dias na TriSolutions, meu sincero agradecimento por todos os 
ensinamentos e momentos passados juntos nesta trajetória na engenharia.  

  



DEQUI / UFRGS – Leonardo de Mattos Rolim v 

Re s u mo  

Neste trabalho, uma estrutura de controle antigolfadas em sistemas de extração e 
produção de petróleo com elevação artificial é apresentada, levando em conta diferentes 
casos de disponibilidade de instrumentação. O principal objetivo é a maximização da 
produção e a supressão do regime de escoamento em golfadas, focando na robustez a 
falhas, ruído ou indisponibilidade da instrumentação submarina, que possui difícil 
manutenção.  

A escolha de uma estrutura de controle é realizada, com o uso das melhores variáveis 
controladas disponíveis segundo os critérios de estabilização e produção, tendo como base 
simulações dinâmicas realizadas com modelos não lineares simplificados. Como estratégia 
para casos em que falhas na instrumentação ocorrem, uma inferência de variáveis de 
interesse é também proposta e sua convergência testada de maneira superficial através de 
simulações.  

Utilizando os resultados do trabalho, é possível verificar que a utilização de variáveis no 
poço é essencial para o melhor controle desse sistema. Ressalvas no entanto devem ser 
feitas com relação à simplicidade dos modelos utilizados, e trabalhos futuros são sugeridos 
para continuidade da pesquisa em sistemas experimentais ou modelos mais rigorosos. 

PALAVRAS-CHAVE: Exploração offshore de petróleo, elevação artificial por gas-lift, 
controle antigolfadas, ciclos limites, observadores não lineares.  

  



Controle antigolfadas na produção de petróleo por gas-lift vi 

A bst ra c t  

This paper explores an antislugging control structure for oil production and extraction 
systems with artificial lift, taking into account different cases of availability of 
instrumentation. The main objective is the maximization of production and the abolition of 
the flow regime in gulps, focusing on robustness to failure, noise or unavailability of 
underwater instrumentation, which has difficult to maintain. 

This work presents methods and results for the choice of a control structure with the 
usage of the best available controlled variables according to the criteria of stabilization of 
pressures and flows and maximum production. The evaluation is based on dynamic 
simulations performed with simplified nonlinear models. As a strategy for cases where 
failures occur in the instrumentation, an inference of variables of interest is also proposed 
and superficially tested for convergence through simulations. 

Using the results of the work, we can see that the use of variables in the well is essential 
for better control of this system. However, reservations must be made with respect to the 
simplicity of the models used, and future work is suggested for continued research with 
experimental systems or commercial rigorous models for multiphase flow. 

KEYWORDS Offshore oil production, artificial lifting by gas-lift, antislugging control, 
limit cycles, nonlinear observer.  

 

  



DEQUI / UFRGS – Leonardo de Mattos Rolim vii 

Li sta  d e  F i gu ra s  

 

Figura 2.1 - Visão esquemática de um campo de extração. .................................................. 2 

Figura 2.2 – Equipamentos para extração e elevação de petróleo no fundo do mar........... 2 

Figura 2.3 – Regimes de escoamento bifásico em dutos verticais. ....................................... 3 

Figura 2.4 – Diagrama de bifurcação e ciclo limite em função da abertura da válvula choke 
de produção. .......................................................................................................................... 3 

Figura 2.5 - Diagrama de bifurcação em função da abertura da válvula choke. ................... 4 

Figura 2.6 – Produção de petróleo como função da vazão de gas-lift. ................................. 4 

Figura 2.7 - Comparação de diagramas de bifurcação das pressões do topo e do fundo de 
um riser entre modelo mecanicista aproximado e valores obtidos experimentalmente. ... 5 

Figura 2.8 - Distribuição de gás natural para árvores de natal na elevação artificial. .......... 5 

Figura 2.9 - Diagrama esquemático de poço com elevação por gas-lift. .............................. 5 

Figura 2.10 – Lugar das raízes de linearização com sensor de pressão no topo do riser. .... 6 

Figura 2.11 – Malha de override de com controlador PIC em cascata. ................................. 7 

Figura 2.12 - Controle em cascata utilizando sensores na plataforma. ................................ 7 

Figura 2.13 – Comparativo de robustez de controladores lineares antigolfadas. ................ 8 

Figura 3.1 - Generalização do modelo proposto por Storkaas com uma “válvula virtual”. 11 

Figura 3.2 - Modelo em espaço de estados do subsistema poço por gas-lift. .................... 14 

Figura 3.3 - Modelo em espaço de estados do sistema pipeline-riser ................................ 15 

Figura 3.4 – Modelo completo com ambos os sistemas acoplados. ................................... 15 

Figura 4.1- Diagrama de bifurcação da produção mássica de líquido com ??????=20%. .. 17 

Figura 4.2 - Bifurcação das pressões no fundo do riser e do poço para ??????=20%. ...... 18 

Figura 4.3 – Gráficos CV/MV do Controlador 1 na comparação do Experimento 1. .......... 19 

Figura 4.4 Vazões mássicas de gás e óleo no Experimento 1 (CVs no poço). ..................... 19 

Figura 4.5 Vazões mássicas de gás e óleo no Experimento 1 (CVs no poço). ..................... 20 

Figura 4.6 - Diferença de pressão no poço (???-???) com a saturação da choke. ........... 20 

Figura 4.7 - Perda de controlabilidade do sistema devido à saturação da choke ............... 20 

Figura 4.8 - Oscilações nas vazões mássicas de produção após saturação da choke. ........ 21 

Figura 4.9 - Diferença de pressão no poço (???-???) com anti-reset limitado. ............... 21 

Figura 4.10 - Abertura da válvula choke de produção com anti-reset limitado. ................. 21 

Figura 4.11 - Vazões de produção de gás e líquido com anti-reset modificado. ................ 22 

Figura 4.12 - Comparação do uso de medidas de pressão na flowline e na plataforma. ... 23 

Figura 4.13 – Seguimento de trajetória utilizando medições no poço e limitações de 
instrumentação e de dinâmica do atuador. ........................................................................ 24 

Figura 4.14 – Pressões no do poço com estimação de estados a partir de sinal ruidoso. .. 24 



Controle antigolfadas na produção de petróleo por gas-lift viii 

Figura 4.15 – Degraus em malha fechada com controladores proporcionais. ................... 25 

Figura 4.16 – Testes de degrau em malha fechada utilizados na sintonia. ......................... 26 

Figura 4.17 - Estimação da pressão no fundo do poço ....................................................... 26 

  



DEQUI / UFRGS – Leonardo de Mattos Rolim ix 

Li sta  d e  Ta b e l a s  

 

Tabela 2.1 – Terminologia da instrumentação nos sistemas para extração offshore .......... 9 

Tabela 4.1 - Comparação da utilização de sensores no poço para ???????? = 40%. ...... 22 

Tabela 4.2: Comparação do uso de sensores na plataforma para ???????? =  40%. ...... 23 

 

  



Controle antigolfadas na produção de petróleo por gas-lift x 

Li sta  d e  Sí mb o l o s  

 

Sistema linha de produção-riser 
 
???- Diferença de pressão entre o fundo e o topo do riser;  
???  – Constante multiplicativa para equação de perda de carga na linha de produção. 

?geb – Massa de gás na bolha alongada (estado do sistema linha de produção-riser;) 

?gr– Massa de gás no interior do riser (estado do sistema linha de produção-riser); 

?lr– Massa de líquido no interior do riser (estado do sistema linha de produção-riser);  
??? – Pressão na bolha alongada no interior da linha de produção (flowline); 
??? – Pressão no topo do riser (medida com o sensor Pmon); 
??? – Pressão no fundo do riser;  
???  – Pressão na linha de produção, a jusante da válvula on-off de fechamento do poço. 

?? – Massa específica média da fase líquida.  
?prod – Abertura da válvula choke de produção 

?gout  – Vazão de saída de gás do sistema linha de produção-riser; 

?gv,riser– Vazão de líquido através da válvula virtual no sistema linha de produção-riser; 

?lout – Vazão de saída de líquido (água e óleo) do sistema linha de produção-riser;  
 

Sistema poço de elevação por gas-lift 
 
???- Diferença de pressão entre o fundo e o topo do tubo de produção do poço; 
?gc– Massa de gás no interior do casing do poço (estado do sistema poço por gas-lift); 

?gw – Massa de gás no tubo de produção (estado do sistema poço por gas-lift); 

?lw – Massa de líquido no tubo de produção (estado do sistema poço por gas-lift); 
??? – Pressão no anular do poço; 
??? – Pressão no topo do poço (medida com o sensor TPT); 
??? – Pressão no fundo do poço (medida com o sensor PDG); 

?well – Abertura da válvula de produção entre o poço e a linha de produção (on-
off)  
?gLift – Abertura da válvula choke de alocação de gás para elevação 

?gGLM – Vazão de gás para elevação entre o gas-lift manifold e o casing do poço; 

?ginRes– Vazão de gás entre o reservatório e o poço de extração de petróleo;  

?gout,well  – Vazão de saída de gás do sistema poço por gas-lift; 

?gv,well– Vazão de líquido através da válvula unidirecional de gas-lift, no fundo do poço; 

?linRes– Vazão de líquido entre o reservatório e o poço de extração de petróleo;  
?lout,well  – Vazão de saída de líquido (água e óleo) do sistema poço por gas-lift; 
 
 
  



DEQUI / UFRGS – Leonardo de Mattos Rolim xi 

Li sta  d e  A b re vi at u ra s  e  Si gl a s  

 

ANM – Árvore de Natal Molhada; 

CV – Variável Controlada (do inglês, Controlled Variable); 

EKF – Filtro de Kalman Estendido (do inglês, Extended Kalman Filter); 

IMC – Controle Baseado em Modelo Interno (do inglês, Internal Model Control); 

MPC – Controlador Preditivo baseado em Modelo (do inglês, Model Predictive Controller); 

MV – Variável Manipulada (do inglês, Manipulated Variable); 

NTNU – Universidade Norueguesa de Ciência e Tecnologia; 

OLGA – Software para simulação de escoamento multifásico OLGA 2000®; 

PIC – Controlador de pressão na terminologia de instrumentação de processos. 

PDG – Sensor de pressão no fundo do poço (do inglês, Pressure Downhole Gauge);  

TPT – Transmissor de pressão e temperatura no topo do poço (do inglês, Temperature and 
Pressure Transmitter); 

UFSC – Universidade Federal de Santa Catarina; 

UKF – Filtro de Kalman Inodoro (do inglês, Unscented Kalman Filter); 

 

 





1 Int ro d u çã o  

No processamento primário de petróleo, o desempenho da separação da mistura de 
óleo, gás e água nos separadores trifásicos afeta todos equipamentos a jusante na 
plataforma de petróleo. A eficiência da separação e a integridade dos equipamentos (como 
pré-aquecedores de placas da unidade) são fortemente afetadas pelo regime de fluxo de 
chegada do petróleo na plataforma (Campos, 2013).  

O regime de golfadas severas, caracterizado por grandes variações das vazões e 
pressões na produção nas tubulações e nos poços de petróleo são as principais 
perturbações nesses sistemas, e a garantia de escoamento tem como principal objetivo a 
redução ou a eliminação deste fenômeno. Para garantir uma operação segura e máxima 
produtividade, estas perturbações devem ser mitigadas. Uma das maneiras de alcançar um 
regime estável é com o uso de controle automático (Storkaas, 2005). 

Um dos grandes desafios, do ponto de vista de controle, da produção de petróleo em 
águas profundas decorre da existência dessas instabilidades severas devido ao regime de 
escoamento em golfadas. A estratégia utilizada industrialmente é inferir a formação da 
golfada pela pressão de fundo do poço (ou em outros pontos da linha de produção ou até 
na plataforma) e atuar nas válvulas de controle para estrangulamento da produção para 
evitar a formação de golfadas severas. Neste trabalho, é estudado o controle do regime de 
escoamento de óleo e gás na elevação de petróleo em sistemas de extração offshore.  

1.1 Objetivos 

A definição de uma estrutura de controle prática, capaz de suprimir golfadas, 
estabilizando o escoamento e permitindo a máxima produção de petróleo, tendo em vista 
as restrições operacionais e recursos de instrumentação disponíveis é o objetivo principal 
deste trabalho. Isso deve ser alcançado com o comando das válvulas de controle de 
produção dos poços de maneira robusta, evitando danos aos equipamentos e assegurando 
a segurança da equipe operacional. 

1.2 Estrutura do Trabalho 

O trabalho está organizado da seguinte maneira:  

No Capítulo 2 é apresentada uma breve revisão bibliográfica sobre a extração e 
produção de petróleo, escoamento de misturas multifásicas, técnicas de supressão dos 
danos causados pelo regime de golfadas e sobre estratégias de controle automático para 
esses sistemas. 

No Capítulo 3 é apresentado o desenvolvimento dos modelos, observadores e 
nomenclatura da instrumentação para os controladores utilizados na elaboração dos 
algoritmos de controle, inferência. A formulação do problema é também apresentada, 
mostrando a proposta do emprego das técnicas descritas anteriormente para atingir os 
objetivos do trabalho. 

No Capítulo 4, são apresentados resultados das simulações de malhas de controle do 
trabalho.  

Finalmente, no Capitulo 5 serão apresentadas as principais conclusões do trabalho e 
perspectivas futuras.  



Controle antigolfadas na produção de petróleo por gas-lift 2 

2 Revi s ã o  B i b l i o g ráf i ca  

2.1 Extração e produção de petróleo 

2.1.1 Sistemas para extração 

O petróleo é extraído de reservatórios através de poços até uma estrutura na cabeça de 
cada poço chamada de árvore de natal molhada (ANM). Essas estruturas ficam localizadas 
na “cabeça do poço”, onde ficam as conexões para instrumentação e válvulas no fundo do 
mar. Estas árvores são utilizadas para conectar as colunas de produção dentro dos poços 
com as tubulações horizontais no fundo do mar denominadas linhas de produção 
(flowlines), como mostrado na Figura 2.1.  

 A elevação do petróleo até a plataforma é realizada através de dutos verticais 
denominados risers. A mistura multifásica de óleo, gás e água é extraída e então separada 
em um separador trifásico antes de seguir para os outros estágios primários de produção 
na própria plataforma. Em poços maduros, com baixas pressões de reservatórios e vazões 
de produção, estratégias para elevação artificial são utilizadas para permitir um aumento 
da produtividade da extração (Campos, 2013). Esta técnica de elevação é responsável por 
mais de 70% do volume de extração de petróleo no Brasil (Teixeira, 2013). 

 

 
Figura 2.1 - Visão esquemática de um 

campo de extração. 
Fonte: (Di Meglio, F. et al., 2012) 

  
Figura 2.2 – Equipamentos para extração e 

elevação de petróleo no fundo do mar. 
Fonte: (Kammerzell, 2014) 

2.2 Escoamento multifásico e golfadas 

O escoamento multifásico de fluidos em um duto pode apresentar distintos regimes 
de escoamento em cada fase, e assim o regime de escoamento multifásico é classificado 
de maneira empírica, baseado em interpretação visual (Stasiak, Pagano e Plucenio, 2012). 
Ferramentas usais para descrever o comportamento desses sistemas são os mapas de 
regime de escoamento.  

As classificações de escoamento, no entanto, são mais gerais e apresentam características 
comparáveis em misturas diferentes (apesar de ocorrerem em diferentes pontos de 
operação). Na Figura 2.3, diferentes regimes de escoamento em dutos verticais são 
ilustrados. A complexidade da dinâmica em dutos submarinos na extração de petróleo é 
ocasionado principalmente por esses regimes de escoamento indesejáveis da mistura 
extraída (composta principalmente por gás, óleo e água), como o regime em golfadas. 

Na indústria de petróleo, o escoamento em golfadas se refere a um escoamento não 
homogêneo de uma mistura bifásica. Apesar de tratar-se geralmente do escoamento de 



DEQUI / UFRGS – Leonardo de Mattos Rolim 3 

misturas predominantemente compostas por gás, óleo e água, o escoamento é geralmente 
aproximado por um escoamento de uma fase líquida e outra gasosa.  

O regime instável denominado “golfadas severas” é uma condição comum em risers e que 
pode causar danos às instalações e redução na produção de petróleo devido ao fluxo 
intermitente. Os impeditivos mais importantes para o aumento da produtividade em 
reservatórios offshore são essas instabilidades dinâmicas, que impactam diretamente na 
produção média de petróleo (Sinegre, 2006). 

Diferentemente dos escoamentos em bolhas dispersas, agitado e anular, a distribuição 
espacial das fases líquida e gasosa não são invariantes ao longo do eixo principal das 
tubulações. Este regime é caracterizado pela formação de bolhas alongadas de gás 
separadas periodicamente pela fase líquida (Di Meglio, 2011).  

A principal estratégia utilizada para proteger os equipamentos de superfície, que 
apresentam limitações de pressão e/ou vazão, como separadores gravitacionais, é a 
restrição de fluxo (ou estrangulamento, em tradução livre do inglês choking).  

O choking é geralmente realizado com o uso de restrições denominadas válvulas para 
choke, que ainda podem evitar formação de cones de gás ou água no reservatório. Estas 
válvulas podem ser instaladas em diferentes pontos do sistema, como na cabeça do poço 
de produção ou na entrada da estação de produção (Jahanshahi, Skogestad e Lieungh, 
2013). 

 

Figura 2.3 – Regimes de escoamento 
bifásico em dutos verticais.  

Fonte: (Stasiak, Pagano e Plucenio, 
2012) 

 
Figura 2.4 – Diagrama de bifurcação e ciclo limite 

em função da abertura da válvula choke de 
produção. 

Adaptado de:(Stasiak, Pagano e Plucenio, 2012). 

A instalação de válvula de controle para choking na árvore de natal molhada (ANM) permite 
que a linha de produção (flowline) seja sujeita a menor fadiga devido às menores pressões.  

A utilização da válvula choke na estação de produção (na plataforma) permite uma maior 
facilidade de controle de pressão e mudança de abertura da válvula. Em campos de 
extração offshore, as limitações de confiabilidade e manutenção a centenas ou milhares de 
metros de profundidade limitam a utilização contínua de válvulas no fundo do mar, e assim 
muitos autores desconsideram o uso destas para controle (Campos, 2013). 



Controle antigolfadas na produção de petróleo por gas-lift 4 

2.2.1 Características de bifurcação e ciclo limite 

As transições para regimes instáveis (ciclos limites) ocorrem em uma superfície do 
plano descrito pela abertura da válvula choke de produção, como mostrado na Figura 2.4.  

Em sistemas em regimes de escoamento por golfadas, como risers com bloqueio de 
gás devido ao terreno ou poços de elevação por gas-lift ligados a poços maduros, um 
diagrama simplificado de bifurcação pode ser traçado como uma função da abertura da 
válvula choke de produção pode ser traçado como mostrado na Figura 2.5.  

 

Figura 2.5 - Diagrama de bifurcação em 
função da abertura da válvula choke. 

(Fonte: Di Meglio et alli, 2012a) 

 

Figura 2.6 – Produção de petróleo como 
função da vazão de gas-lift. 
Fonte: (Aamo et al., 2005) 

Nos sistemas de extração de petróleo por elevação artificial, o tipo de regime de 
escoamento depende também do ponto de operação em função da injeção de gás natural 
a alta pressão, como mostrado na Figura 2.6. 

2.2.2 Modelagem matemática 

Devido à natureza distribuída nas longas tubulações submarinas, modelos 
fenomenológicos rigorosos são adequados para a representação da distribuição das 
pressões. Exemplos de simuladores comerciais rigorosos deste tipo de escoamento são as 
ferramentas computacionais FMC FlowManager® e OLGA 2000® (Di Meglio, 2011). 

Para fins de controle, diversos modelos foram propostos na literatura visando 
capturar as instabilidades por cabeceio de anular (fenômeno provocador de regimes 
instáveis de escoamento em poços) ou as golfadas ocasionadas devido ao relevo mas 
mantendo uma relativa simplicidade (Jahanshahi e Skogestad, 2011). Modelos empíricos 
do comportamento do sistema, foram também propostos para estudar diferentes 
estratégias de controle (Stasiak, Pagano e Plucenio, 2012; Kaasa et al., 2008). 



DEQUI / UFRGS – Leonardo de Mattos Rolim 5 

  

Figura 2.7 - Comparação de diagramas de bifurcação das pressões do topo e do fundo de 
um riser entre modelo mecanicista aproximado e valores obtidos experimentalmente.  

Fonte: (Jahanshahi, Skogestad e Grotli, 2013)  

2.3 Otimização da alocação de gas-lift 

Devido à natureza de capital parado do petróleo na extração, quanto maior a 
produtividade de campos de petróleo, melhor a rentabilidade e a velocidade de retorno 
dos investimentos. Assim, economicamente é interessante que os poços produzam a maior 
quantidade de óleo, e a elevação artificial por gás natural é uma das estratégias para atingir 
este fim. No entanto, a elevação artificial por injeção de gás custa energia, pois uma parte 
do gás extraído dos reservatórios deve desidratado e comprimido, o que também é custoso 
(Teixeira, 2013).  

A Figura 2.8 mostra um sistema de distribuição de gás para uma série de poços de 
extração. Nestes sistemas, a pressão no interior de uma tubulação que liga os 
compressores a todos os poços, chamada de gas lift manifold, é regulada pelos sistemas de 
controle da plataforma (Camponogara et al., 2010). Como existe um custo para processar 
e comprimir o gás (e até mesmo uma inversão de ganho quanto à injeção de gás, como 
pode ser visto na Figura 2.6), um ponto ótimo de alocação da gás para elevação geralmente 
pode ser encontrado para cada poço utilizando rotinas de otimização (Campos, 2013).  

Estes sistemas afetam a estabilidade do regime de escoamento do sistema de 
extração, e dependendo das vazões de injeção podem também ocasionar golfadas. 

 

Figura 2.8 - Distribuição de gás natural para 
árvores de natal na elevação artificial. 

Fonte: (Camponogara et al., 2010). 

 

Figura 2.9 - Diagrama esquemático de 
poço com elevação por gas-lift.  

Fonte: (Sinegre, Petit e Menegatti, 2006). 

De acordo com Aamo (Aamo et al., 2005), existem duas abordagens principais para eliminar 
essas fortes oscilações ocasionadas por cabeceio de anular em poços com elevação por 
gas-lift: 



Controle antigolfadas na produção de petróleo por gas-lift 6 

I. Aumento da queda de pressão causada pela fricção. As opções geralmente 
utilizadas são a redução da abertura na válvula choke de produção do poço, a 
redução do tamanho da válvula de injeção de gas-lift ou o aumento da vazão de gás 
para elevação  

II. O desacoplamento da dinâmica do anular com a dinâmica da coluna de produção 
(com operação de fluxo supercrítico do gás para elevação), como por exemplo com 
o uso de válvulas de injeção especiais. 

Neste trabalho, a primeira alternativa é explorada, utilizando controle automático para 
regular a queda de pressão nas válvulas do sistema. 

2.4 Controle regulatório e garantia de escoamento  

2.4.1 Instrumentação dificultada 

Devido à localização e às condições de trabalho, a manutenção da instrumentação 
submarina em sistemas de extração offshore é geralmente impraticável. Como existe a 
possibilidade de falhas para cada um destes equipamentos submarinos, válvulas de 
controle e outros atuadores submarinos em geral não são utilizados continuamente 
(Campos, 2013). Sensores e transmissores de sinais também podem falhar, o que limita as 
opções de informação em tempo real sobre o poço. 

A utilização de sensores na plataforma em uma estratégia de controle geralmente 
limita o desempenho do sistema devido à característica de fase não-mínima destas 
medições (Jahanshahi, 2013). Assim, a utilização de outras medidas submarinas quando 
disponíveis ou observadores para inferência de variáveis de processo é recomendada 
(Jahanshahi, Skogestad e Grotli, 2013). Baseado nisso, este trabalho utiliza também um 
algoritmo para inferência da pressão de fundo para validação de uma possível estrutura 
para controle caso ocorra falha nos sensores submarinos. 

 

Figura 2.10 – Lugar das raízes de linearização com sensor de pressão no topo do riser. 
Fonte: (Jahanshahi, Skogestad e Grotli, 2013) 

A Figura 2.10 apresenta um gráfico do plano complexo de lugar das raízes (pólos e 
zeros) de um sistema linearizado para várias diferentes aberturas da válvula de produção 
e estrangulamento do poço (válvula choke, representada na Figura pela letra Z).   

-0.1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
-0.2

-0.15

-0.1

-0.05

0

0.05

0.1

0.15

Real axis

Im
a
g
in

a
ry

 a
x
is

 

 

Z=5% Z=95%Z=5% Z=95%

Z=15%

Z=20%

Z=30%

Z=45%

Z=60% Z=95%

Z=15%

Z=20%

Z=30%

Z=45%

Z=60%Z=95%

RHP-Zeros

RHP-poles



DEQUI / UFRGS – Leonardo de Mattos Rolim 7 

2.4.2 Estratégias clássicas e prática de controle 

A estratégia de controle usual é inferir a formação da golfada utilizando sensores de 
pressão no poço ou na plataforma e atuar na choke de produção para evitar a formação de 
golfadas severas. Quando medições no poço estão disponíveis, estas são geralmente 
utilizadas devido ao melhor desempenho observado com os controladores com acesso a 
elas.  

Um exemplo de uma estratégia com acesso a essas variáveis controladas pode ser 
observado na Figura 2.11. Quando estas medições não estão disponíveis, diferentes 
sensores na plataforma podem ser utilizados visando obter mais informações para 
controlar as golfadas, como mostrado na Figura 2.12. 

 
Figura 2.11 – Malha de override de com 

controlador PIC em cascata. 
(Fonte: Campos et alli, 2013) 

 
Figura 2.12 - Controle em cascata 

utilizando sensores na plataforma.  
Fonte: (Godhavn, Fard e Fuchs, 2005) 

 

2.4.3 Controle não linear e controle robusto 

Alguns controladores não lineares apresentados na literatura apresentam bom 
desempenho em relação a variações estruturais e parametrais das plantas. Linearização 
parcial por feedback também foi estudada (Jahanshahi, Skogestad e Grøtli, 2013); (Di 
Meglio, F et al., 2012), mas não apresentaram robustez em experimentos.  

Um trabalho na área de controle antigolfadas desenvolvido na Universidade Federal 
de Santa Catarina (UFSC) apresenta um controlador baseado em um modelo não linear 
simplificado e que calcula um valor numérico ótimo para o setpoint da diferença de pressão 
ao longo do riser (em vez da abertura da válvula choke de produção). Apesar da 
aplicabilidade de um controlador discreto como na solução apresentada, esta solução não 
foi estudada neste trabalho devido ao requerimento da derivada da pressão no fundo do 
riser (Stasiak, Pagano e Plucenio, 2012). 

Outros controladores não lineares com estratégias menos práticas foram propostos, 
como controladores de estrutura variável por modos deslizantes (em tradução livre do 
inglês sliding mode control). Inicialmente, a proposta deste trabalho era a utilização de 
controladores deste tipo, devido à robustez frente à incerteza de parâmetros e dinâmicas 
da planta e simplicidade. A implementação apresentada na dissertação de Reinsnes (2009) 
requer uma medição precisa da pressão no fundo do poço ou de um riser de maneira que 
a derivada desta possa ser calculada, e sofre com a dinâmica do atuador na válvula de 



Controle antigolfadas na produção de petróleo por gas-lift 8 

produção. Os resultados da abordagem não foram satisfatórios em simulações devido 
principalmente à necessidade de altas taxas e baixo ruído na medição de pressão.  

De acordo com trabalhos realizados pelo grupo de pesquisa da Universidade 
Norueguesa de Ciência e Tecnologia (NTNU, do norueguês Norges teknisk-
naturvitenskapelige universitet i Trondheim), sistemas de controle robusto por síntese pela 
norma H? e controle PID utilizando a estratégia de Controle por Modelo Interno (IMC, do 
inglês Internal Model Control) com um modelo Hammerstein (modelo linear com não 
linearidade estática são estratégias comparáveis em termos de robustez (Jahanshahi et al., 
2014). Estas duas estratégias são ainda mais robustas experimentalmente que 
controladores baseados em modelos mecanicistas (Jahanshahi, E. e Skogestad, S., 2013).  

 
Figura 2.13 – Comparativo de robustez de controladores lineares antigolfadas.  

Fonte: (Jahanshahi et al., 2014) 

De acordo com os critérios apresentados (normas H? das funções características do 
sistema, margens de ganho e de atraso), verifica-se que controladores PID, apesar de sua 
simplicidade (e linearidade), foram avaliados teoricamente segundo critérios de robustez e 
experimentalmente, e obtiveram bom desempenho mesmo sem a utilização de gain-
scheduling. Devido a isso, uma estratégia utilizando simples controladores PI 
(proporcionais integrais) é utilizada neste trabalho.  

Uma identificação em malha fechada de uma planta linear instável realimentada com 
um controlador proporcional foi proposta para sintonizar o controlador IMC, e 
posteriormente implementá-lo como um PIDF (controlador PID com filtro na ação 
derivativa). A partir das assíntotas deste controlador PIDF, é possível encontrar uma 
aproximação das características de resposta em frequência utilizando um PI (Jahanshahi, 
Esmaeil e Skogestad, Sigurd, 2013).  

Para simplificar o presente trabalho, a sintonia dos controladores será realizada de 
maneira heurística, mas os resultados para um teste de degrau em malha fechada serão 
apresentados para fins comparativos. 

2.4.4 Inferência das pressões utilizando observadores lineares e não-lineares 

Apesar de o princípio da separação (que prega que controlador e estimador de 
estados possam ser projetados de maneira separada, para então funcionarem juntos) não 
ser garantido para sistemas não lineares em geral, estudos práticos foram realizados com 
o uso de observadores para realimentação do sistema (Jahanshahi, Skogestad e Grotli, 
2013) e controle automático antigolfadas.  

Diversos observadores não-lineares foram propostos para estimar as pressões 
inacessíveis devido a problemas de instrumentação, em geral baseados em modelos 
simplificados (modelos caixa-cinza).  



DEQUI / UFRGS – Leonardo de Mattos Rolim 9 

Em trabalho da NTNU por Eikrem (Imsland, Foss e Eikrem, 2003), um estimador 
baseado no Filtro de Kalman Extendido (EKF) foi proposto. Uma comparação do Filtro de 
Kalman Inodoro e Rápido (Fast UKF, do inglês Unscented Kalman Filter) com um observador 
de alto ganho foi realizada em outro trabalho da NTNU. Os maiores problemas detectados 
foram a robustez devido a diferenças estruturais e variações parametrais da planta (Syre, 
2012).  

Uma descrição resumida de observadores por caixa cinza apresentados na literatura 
está apresentada abaixo: 

? Observadores de Grøtli (Jahanshahi, Skogestad e Grotli, 2013) Observador 
Luemberger de alto ganho, UKF e UKF rápido utilizando pressões de fundo ou topo 
de um riser. 

? Observadores de Aamo (Aamo et al., 2005) – para o poço por elevação artificial, não 
utiliza vazão de gas-lift (do ânulo para o tubo de produção do poço) no observador 
e assume massa no ânulo conhecida (e assim, apresenta um estado a menos no 
observador). Pode usar densidade ou vazão de óleo no topo como medições 
auxiliares. 

? Observador de Di Meglio (Di Meglio et al., 2012)– tanto para poço com elevação 
artificial quanto para o sistema linha de produção-riser, utiliza a vazão de gas-lift 
(pois é de ordem completa) mas possui um modelo mais simples.  

Neste trabalho, o observador do tipo Tau de Di Meglio (2012) é implementado e utilizado. 

2.4.5 Terminologia da Instrumentação 

Para manter o trabalho de acordo com a terminologia geralmente utilizada nestes sistemas, 
uma nomenclatura da Petrobras é utilizada, de acordo com o trabalho apresentado por 
Campos (2013). 

Tabela 2.1 – Terminologia da instrumentação nos sistemas para extração offshore 

Terminologia Modelo Descrição 

SDV – Shut-Down Valve ?well Válvula on-off na cabeça do poço 
utilizada para fechá-lo, caso 
necessário, mas não para controle. 

Production Choke ?prod Válvula de controle para choking do 
fluido, localizada no topo do riser 

TPT – Temperature Pressure 
Transmitter 

?wt Sensor de temperatura e pressão na 
cabeça do poço, após a primeira 
válvula da árvore de natal molhada 

PDG – Pressure Down-Gauge ?wb Sensor de pressão no fundo do poço. 
Difícil acesso para manutenção e 
incerteza alta de medição. 

Pmon – Pressão a montante da 
choke 

?rt Transmissor de pressão a montante da 
válvula choke 

 

  



Controle antigolfadas na produção de petróleo por gas-lift 10 

3 Mate r i a i s  e  Méto d o s  

3.1 Modelo do processo 

Para simular o comportamento dinâmico do escoamento de petróleo, um modelo 
simplificado é utilizado. Este modelo está baseado do trabalho de Esmaeil Jahanshahi 
(Jahanshahi, Skogestad e Helgesen, 2012), que utilizou primeiros princípios para modelar a 
interação entre a tubulação e o riser e o poço a montante destes. Esta abordagem permite 
uma análise quantitativa da produção de óleo e gás em sistemas em golfadas, de maneira 
similar ao modelo de Imsland (Imsland, 2002). 

O modelo matemático utilizado neste trabalho para representar o comportamento 
dos subsistemas linha de produção-riser e poço gas-lift é um modelo de equações 
diferenciais ordinárias adaptadas do modelo por balanço de massa criado por Di Meglio 
(2009). 

 
?

??
[?geb]  =   ?gineb  ? ?gv                            [

??

?
] ( 3.1 ) 

   
?

??
[?gr]   =   ?ginr    + ?gv         ? ?gout    [

??

?
] ( 3.2 ) 

    
?

??
[?lr]   =     ?lin                         ? ?lout     [

??

?
] ( 3.3 ) 

As equações (3.1) – (3.3) são as equações de estado do subsistema, de acordo com a 
conservação de massa para cada uma das fases. A fase líquida é composta por água e óleo, 
com a massa específica ?? ajustada para diferentes razões de água e óleo, e a fase gasosa 
é composta por gás natural. Explicações mais detalhadas sobre a derivação por primeiros 
princípios e relações constitutivas do modelo podem ser encontradas em Di Meglio 
(2012a). 

Sistemas de ordem 3 representados por essas equações referentes à massa de cada 
uma das fases são utilizadas nos modelos de Storkaas (2005), Eikrem (Aamo et al., 2005) e 
Di Meglio (Di Meglio, Kaasa e Petit, 2009), e apesar da simplicidade do modelo, foram 
validadas com dados de simuladores rigorosos comerciais (em alguns pontos de operação) 
e também utilizadas para fins de controle com resultados satisfatórios (Storkaas e 
Skogestad, 2007). 

De maneira similar ao proposto na literatura (Storkaas, 2005); (Di Meglio et al., 2010), 
a modelagem é feita neste trabalho com o balanço de massa simplificado, levando em 
conta a separação em dois volumes distintos: um volume composto por uma massa de gás 
?gr e outra de líquido ?lr, separadas de outro volume repleto de gás (?geb) por uma 

“válvula virtual” A própria natureza de ambos os subsistemas, onde existe uma estrutura 
que eventualmente bloqueia a passagem de gás em alta pressão, induz essa separação em 
dois volumes (Di Meglio, Florent et al., 2012).  



DEQUI / UFRGS – Leonardo de Mattos Rolim 11 

  

Figura 3.1 - Generalização do modelo proposto por Storkaas com uma “válvula virtual”. 
Fonte: (Di Meglio, 2011) 

A vazão mássica ?gv é aproximada por uma equação linear de válvula unidirecional 

(diferente do modelo de Eikrem (Aamo et al., 2005), que assume escoamento turbulento). 
Segundo Di Meglio (2009), o ajuste do coeficiente ?? permite aproximar de maneira 

satisfatória o formato das oscilações. 

 ?gv,riser = ?? × Max[0, (?eb ? ?rb)] ( 3.4 ) 

As pressões ?eb e ?rb referem-se às pressões no volume de gás a montante da válvula 
virtual (chamada de bolha alongada, ou elongated bubble, por Di Meglio) e no fundo do 
riser (ou do poço), respectivamente. A definição de cada uma das vazões mássicas e os 
parâmetros no equacionamento diferenciam o subsistema riser do subsistema poço por 
gas-lift, como pode ser visto na Figura 3.2 e na Figura 3.3. 

No caso das golfadas induzidas pelo terreno (golfadas na conexão linha de produção-
riser), a separação pela “válvula virtual” ocorre devido à geometria do local que provoca a 
acumulação de líquido bloqueando a passagem de gás. No caso do poço com elevação por 
gas-lift, a separação ocorre na válvula de injeção de gás, que permite a vazão apenas no 
sentido de entrada na tubulação de produção. Em terminologia de engenharia de petróleo, 
o fenômeno que representa golfadas no poço modelado é denominado cabeceio de anular 
(Jahanshahi, Skogestad e Hansen, 2012). 

As vazões de saída ?gout e ?lout são dadas através de uma relação direta entre a fração 

mássica de cada fase na coluna de produção (riser ou tubo de produção do poço) e uma 
equação da válvula para escoamento turbulento.  

 ?lout =
(?lr)

(?lr) + ?gr
?out ( 3.5 ) 

 ?gout =
(?gr)

?lr + (?gr)
?out ( 3.6 ) 

No caso do riser, essas vazões de saída do sistema dependem das pressões a jusante do 
sistema (??, que é a pressão no separador na plataforma) e no topo do riser (?rt). 

 ?out,riser = ?out × ?Max[0, ?? (?rt ? ?? )]?prod ( 3.7 ) 



Controle antigolfadas na produção de petróleo por gas-lift 12 

O formato escolhido para diferenciar as pressões e massas é o da utilização das 
subscritos mantendo o padrão de denominações em inglês, com w (de well, referindo-se 
ao poço) junto à especificação da localidade (wa para o anular, wb para o fundo do poço e 
wt para o topo do tubo de produção do poço). 

No modelo de Di Meglio, as vazões de entrada de gás e líquido são assumidas 
constantes. Para permitir estudar a produção de saída como função das pressões do 
sistema (assim como o acoplamento das dinâmicas de cabeceio de anular e golfadas 
severas devido ao terreno), aqui as vazões de entrada no riser dependem da interface entre 
a tubulação a jusante do poço (flowline) e o próprio poço, assim como as vazões de entrada 
no poço dependem da interface do poço com o reservatório e com o anular de gas-lift.  

Este acoplamento foi realizado com a utilização da pressão na linha de produção 
(flowline) como a pressão ?? (separator pressure) do subsistema poço. Assim, sem modelar 
a perda de carga devido ao atrito na tubulação entre o poço e o riser, o coeficiente da 
válvula de saída do poço (?out,well) poderia ser ajustado apropriadamente. No entanto, 
para permitir uma análise da controlabilidade com o uso da pressão na cabeça do poço 
(??? ) para controlar o sistema completo, uma equação de perda de carga no pipeline é 
utilizada.  

Considerando apenas a perda de carga da fase líquida, como utilizado no modelo de 
Jahanshahi (2012), uma simplificação da equação para escoamento turbulento em 
tubulações, conforme recomendações na literatura com uma equação proporcional ao 
quadrado da vazão de saída do poço (?lout,well).  

 ?fl = ?rb + ??? (?lout,well
2) ( 3.8 ) 

A abertura da válvula na cabeça do poço geralmente não se trata de uma válvula de 
controle, e sim uma válvula on-off (chamada de SDV, ou shut-down valve). 

 ?out,well = ?out,well ×
?Max[0, ??,???? (?wt ? ?fl)]?well ( 3.9 ) 

No caso do subsistema gas-lift, as vazões de entrada dependem da interação entre o poço 
e o reservatório. Para fins de validação do modelo e do observador de estados utilizado, 
experimentos preliminares serão realizados utilizando uma vazão constante de entrada 
vinda do reservatório. No desenvolvimento dos resultados, no entanto, uma relação linear 
simples é proposta com relação à diferença de pressão entre o fundo do poço e o 
reservatório, utilizando como base valores médios de um ponto de operação intermediário. 

 ?ginr,well =
??????? ?? ?? ?

??????
(???? ? ??? ) ( 3.10 ) 

 ?linr,well =
??????? ?? ?? ?

??????
(???? ? ??? ) ( 3.11 ) 

Onde ??????? ?? ?? ? é a vazão média de gás entre o reservatório e o poço, ??????? ?? ?? ? é a vazão média de 

líquido e ??????  é a diferença média de pressão entre o reservatório e o poço. Esta relação está 
de acordo com o apresentado em  (Imsland, 2002), com a relação linear diretamente 
relacionado com o Índice de Produtividade do poço (definido como a vazão mássica total 
dividida pela diferença de pressão média entre reservatório e poço).  

  



DEQUI / UFRGS – Leonardo de Mattos Rolim 13 

O subscrito r é utilizado para especificar a vazão de entrada diretamente na coluna de 
produção (riser ou tubo de produção do poço), como apresentado na Equação (3.12), 
enquanto o subscrito eb é utilizado para mostrar a vazão de gás bloqueado na bolha 
alongada, como apresentado na Equação (3.13). 

 ?ginr,riser = (1 ? ?)?gout,well ( 3.12 ) 

 ?gineb,riser = (?)?gout,well ( 3.13 ) 

A vazão de entrada na Bolha alongada é modelada por Di Meglio com a utilização de um 
parâmetro de ajuste (1-?) para indicar a fração que acumula na bolha em vez de entrar 
diretamente na coluna de produção, de maneira que a fração ? da vazão de entrada de gás 
passa diretamente para o riser (sem acumular na bolha). No caso do poço, em vez de utilizar 
o parâmetro ?, a vazão de entrada na bolha alongada (correspondente ao anular) é 
modelada com uma equação da válvula de controle de injeção de gás para elevação entre 
o compartimento Gas Lift Manifold (?glm) e o anular para elevação artificial do poço (?wa), 

como mostrado na Figura 2.8.  

 
?ginLift = ?Max[0, ?glm ? ?wa]?glift?glift ( 3.14 ) 

Assim, devido ao uso de dois subsistemas acoplados, a vazão através da válvula 
virtual no caso do poço de gas-lift ?gv,well é vinculada às pressões no anular do poço ?wa 

(well annulus) e no fundo do poço, ?wb (well tubing bottom). Essas são as pressões no 
interior do anular (entre a válvula de controle de injeção de gás, fora do poço, e a válvula 
unidirecional de gas-lift no fundo do poço) e no ponto de injeção de gas-lift no interior da 
tubulação de produção, respectivamente. 

 ?gv,well = ?? × Max[0, (?wa ? ?wb)] ( 3.15 ) 

Casos em que o escoamento na válvula da injeção é supercrítico (com válvulas especiais), 
o que evitaria o fenômeno de cabeceio de anular (Aamo et al., 2005), não são modelados 
neste trabalho. 

As outras pressões do subsistema flowline-riser são definidas como a pressão no interior 
da Bolha Alongada (?eb), a montante da válvula choke de produção (?rt) e no fundo do riser 
(?rb). 

 ?eb = ?geb × a ( 3.16 ) 

 ?rt =
?gr

?l? ? ?lr
b ( 3.17 ) 

 ?rb = ?rt + (?lr + ?lstill) × c ( 3.18 ) 

Onde a, b, c, ?l? e ?lstill são outros parâmetros do modelo calibrados de acordo com o 
diagrama de bifurcação do sistema estudado. De maneira análoga, as equações das 
pressões no poço são dadas pelas equações 3.16 a 3.18, com a substituição de ?eb por ?wa, 
de ?rt por ?wt, de ?rb por ?wb, ?geb por ?gc e do subscrito r pelo subscrito w nas outras 

variáveis de estado (massas de gás e líquido na coluna de produção do sistema).  

  



Controle antigolfadas na produção de petróleo por gas-lift 14 

Um procedimento para ajuste dos coeficientes do modelo caixa-cinza de Di Meglio é 
descrito em (Di Meglio et al., 2010). 

 ? ?
??

??eb
 ( 3.19 ) 

 ? ?  
?? × ? × ?

?
 ( 3.20 ) 

 ? ?  
(g × Sin[?])

?
 ( 3.21 ) 

 ?l?: = ?? ?? ? ?lstill  ( 3.22 ) 

Os parâmetros R (constante universal dos gases) e M (massa molecular da mistura gasosa) 
são utilizados assumindo que os gases no sistema se comportam como gases ideais. A 
temperatura do sistema T é assumida constante e igual nos três volumes do modelo. A 
seção transversal e o volume da tubulação de produção aparecem nos parâmetros ? e ??, 
respectivamente. A inclinação da coluna de produção em relação ao plano normal à 
aceleração da gravidade (g) é aproximada como um único valor (tubulação reta) com o 
parâmetro ?.  

Os outros parâmetros podem ser obtidos para aproximar um dado sistema de golfadas, 
conforme os procedimentos descritos em (Di Meglio et al., 2010). Apesar das modificações 
do modelo, as vazões dependentes das pressões, os acoplamentos e a vazão através da 
válvula de gas-lift ( 3.14 ) serão aproximadas por constantes e um processo iterativo de 
ajuste dos modelos será realizado no trabalho. 

3.2 Metodologia computacional de resolução  

As simulações são realizadas utilizando a ferramenta de programação gráfica Simulink®, 
dentro do ambiente do MATLAB®, da MathWorks. Os sistemas dinâmicos serão construídos 
utilizando S-Functions, e as conexões algébricas entre eles gerenciada pelo Simulink. Os 
diagramas de blocos são apresentados no Apêndice 8.1 e as S-Functions no Apêndice 8.2. 

A versão para estudantes do software Wolfram Mathematica 10® é utilizada para o 
equacionamento do modelo, ajuste dos parâmetros e validação das alterações relevantes, 
assim como na solução simbólica de equações e transformações das equações em espaço 
de estados, definição dos parâmetros e acoplamentos do modelo ao longo do 
desenvolvimento. As equações dos submodelos e do modelo final estão apresentadas na 
Figura 3.2 e na Figura 3.3.  

 
Figura 3.2 - Modelo em espaço de estados do subsistema poço por gas-lift. 

Fonte: Autor 

uGasLift wlin wgin

mgwc mgc Max eps, wA mgc
wB mgw

Max eps, mlw wml
wC mlw wmlstill wcg Max eps, wA mgc pglm kglift 0 0

mgw mgw Max eps, wA mgc
wB mgw

Max eps, mlw wml
wC mlw wmlstill wcg

Max eps,
wB mgw

Max eps, mlw wml
pfl w m mgw wCout

mgw mlw
0 0 1

mlw mlw

Max eps,
wB mgw

Max eps, mlw wml
pfl w m mlw wCout

mgw mlw
0 1 0

p wt
wB mgw

Max eps, mlw wml
0 0 0

p wb
wB mgw

Max eps, mlw wml
wC mlw wmlstill 0 0 0



DEQUI / UFRGS – Leonardo de Mattos Rolim 15 

 
Figura 3.3 - Modelo em espaço de estados do sistema pipeline-riser  

Fonte: Autor. 

 
Figura 3.4 – Modelo completo com ambos os sistemas acoplados.  

Fonte: Autor. 

O observador de Di Meglio (2009) é empregado para inferência da pressão de fundo do 
poço, com as pequenas modificações apresentadas nesta seção. O estimador utiliza como 
variáveis de estado as mesmas variáveis propostas originalmente: a massa de gás no anular, 
a massa de líquido no riser e a pressão no topo do riser.  

A inferência utiliza para correção do modelo interno as medições de pressão no topo do 
poço, a abertura da válvula de injeção de gas-lift, e estimativas para a pressão média e 
vazões de entrada de gás e líquidas médias (vindas do reservatório). Estes dados podem, 
na prática, ser obtidos com estudos das características dos reservatórios (com ferramentas 
computacionais de engenharia), com dados dos separadores de teste utilizados 
periodicamente nas plataformas e nos sensores on-line. 

A formulação é a mesma que nas equações 3.1 e 3.3 (como mostrado na primeira e segunda 
linha da Figura 3.2), com a adição de uma terceira equação de estado dependente da 
pressão medida. Esta equação pode ser obtida derivando a Equação 3.16 em relação ao 
tempo e adicionando um termo de injeção da saída medida através de um ganho 
multiplicado pelo erro entre o valor estimado pelo modelo e lido no processo, como 
mostrado na Equação 3.23. 

 
d

dx
[pwt]: = b

(?l? ? ?lw)?gw
.

+ ?gw?lw?

(?l? ? ?lw)
2

? ?(pwt ? pwt?? ?? ?) ( 3.23 ) 

Assim, o modelo do observador é dado pelas equações 3.1, 3.3 e 3.23, com parâmetros 
ajustados para o poço do estudo de caso.  

uprod wlinRiser wginRiser

mgeb mgeb Max eps, rA mgeb
rB mgr

Max eps, mlr rml
rC mlr rmlstill rcg

0 0 1

mgr mgr Max eps, rA mgeb
rB mgr

Max eps, mlr rml
rC mlr rmlstill rcg

Max 0, pfl ps r m mgr rCout
mgr mlr

0

mlr mlr 0
Max 0, pfl ps r m mlr rCout

mgr mlr
1 0

Peb
rB mgr

Max eps, mlr rml
0 0 0

Prt
rB mgr

Max eps, mlr rml
rC mlr rmlstill 0 0 0

" up rod " " uglift "

" " mgeb Max eps, riserAa mgeb
riserBb mgr

Max eps, mlr riserml
riserCc mlr riserm lstill riserc g 1 wginRiser 0 0

" " mgr Max eps, riserAa mgeb
riserBb mgr

Max eps, mlr riserml
riserCc mlr riserm lstill riserc g wginRiser

Max 0,
riserBb mgr

Max eps, mlr riserml
ps riserCc mlr risermlstill riser m mgr riserCout

mgr mlr
0

" " mlr

Max eps,
riserBb mgr

Max eps, mlr riserml

wellBb mgw

Max eps, mlw wellml
riserCc mlr risermlstill well m mlw wellCout

mgw mlw

Max 0,
riserBb mgr

Max eps, mlr riserml
ps riserCc mlr risermlstill riser m mlr riserCout

mgr mlr
0

" " mgc Max eps, wellAa mgc
wellBb mgw

Max eps, mlw wellml
wellCc mlw wellm lstill wellc g 0 Max eps, wellAa mgc pglm kglift

" " mgw wginReservoir Max eps, wellAa mgc
wellBb mgw

Max eps, mlw wellml
wellCc mlw wellm lstill wellc g

Max eps,
riserBb mgr

Max eps, mlr riserml

wellBb mgw

Max eps, mlw wellml
riserCc mlr risermlstill well m mgw wellCout

mgw mlw

0 0

" " mlw wlinReservoir

Max eps,
riserBb mgr

Max eps, mlr riserml

wellBb mgw

Max eps, mlw wellml
riserCc mlr risermlstill well m mlw wellCout

mgw mlw
0 0

" Pmon "
riserBb mgr

Max eps, mlr riserml
0 0

" TPT"
wellBb mgw

Max eps, mlw wellml
0 0

" PDG"
wellBb mgw

Max eps, mlw wellml
wellCc mlw wellm lstill 0 0



Controle antigolfadas na produção de petróleo por gas-lift 16 

3.3 Formulação do Problema  

Utilizando simulações no modelo completo, com as vazões de produção dependentes 
das pressões no sistema e o acoplamento entre o poço por elevação artificial, a linha de 
produção e o riser, estudar o desempenho de controladores para regular a planta sob duas 
fontes de instabilidade: por cabeceio de anular no poço de elevação por gas-lift e no 
sistema linha de produção-riser devido a irregularidades no terreno. O objetivo é a 
maximização da produção de óleo com garantia de escoamento estável, e a escolha da 
estrutura será realizada utilizando diferentes variáveis controladas.  

3.3.1 Acoplamento dos sistemas 

Como as pressões no separador gravitacional são especificadas constantes neste 
modelo, não existe diferença entre utilizar somente a pressão a montante ou a diferença 
de pressão ao longo da válvula choke na plataforma em controladores lineares, além da 
combinação das incertezas de ambas as medidas.  

Modelar as variações de pressão no separador gravitacional (a jusante da choke) é 
fora do escopo do trabalho, mas a influência deste no sistema dinâmico é semelhante ao 
que ocorre no poço com pressão na flowline especificada. 

3.3.2 Seleção da estrutura para controle regulatório 

Essa seção versará sobre a estratégia de controle proposta:  

? Utilizar a pressão no fundo do poço (PDG) quando disponível, possivelmente em 
combinação com outra variável. A utilização apenas da pressão de fundo não é 
recomendada na literatura devido à dependência dos controladores de uma ligação 
em uma janela de tempo (dependendo da fase do ciclo limite das pressões) para 
que a estabilização seja possível(Di Meglio, F et al., 2012). 

? Utilizar a medição de pressão (e temperatura) no TPT na árvore de natal molhada, 
se disponível (??? ), o que permite um sistema de fase mínima (Jahanshahi, 
Skogestad e Helgesen, 2012) no caso de golfadas severas (devido ao terreno), mas 
variáveis do fundo do poço apenas utilizando observadores.  

? Identificar e ajustar modelo caixa cinza do observador simplificado escolhido em 
simulação, que deve ser ajustado para vazões de entrada constantes, para permitir 
um ajuste prático dos parâmetros do mesmo (Di Meglio, F. et al., 2012). 

3.3.3 Denominação dos controladores 

Os controladores utilizados neste trabalho foram numerados para facilitar a discussão e 
comparação entre eles. O critério para numeração utilizado é em relação às variáveis 
controladas (CVs) de cada controlador. 

? Controlador 1. Diferença de pressão entre o fundo e o topo do poço; 

? Controlador 2. Pressão medida no topo do poço; 

? Controlador 3. Pressão medida na plataforma, no topo do riser; 

? Controlador 4. Diferença de pressão entre o topo do poço e do riser.  



DEQUI / UFRGS – Leonardo de Mattos Rolim 17 

4 Re s u l ta d o s  e  d i s c u s s õ e s  

4.1 Modelo com vazões de óleo e gás dependente das pressões no poço  

4.1.1 Acoplamento dos sistemas 

Inicialmente, a simulação apenas do subsistema poço (com pressão da flowline 
especificada) foi realizada para definir os parâmetros do sistema. Para simular o 
acoplamento, uma condição de contorno periódica foi aplicada à pressão da linha de 
produção (flowline). Após a obtenção de parâmetros que permitissem a ocorrência de 
golfadas, com a estabilização do escoamento para baixas aberturas da válvula choke de 
produção ou altas vazões de gás para elevação, o acoplamento com o sistema do riser e da 
plataforma foi realizado. Iterativamente, novos ajustes de parâmetros dimensionais foram 
realizados para determinar uma frequência para as oscilações de cada ciclo limite (no poço 
e no riser).  

De maneira similar ao proposto por Grøtli (Jahanshahi, Skogestad e Grøtli, 2013), o 
acoplamento dos sistemas para análise da influência das pressões foi analisado como uma 
interconexão entre sistemas: o acoplamento do subsistema riser com os sistemas a 
montante dele pode ser observado como uma conexão em série com a abertura da válvula 
choke de produção (?prod) como entrada do subsistema riser, e a pressão no fundo do riser 

(?rb) é a entrada do subsistema linha de produção-poço-reservatório.  

No caso estudado neste trabalho, no entanto, o subsistema após o Riser pode 
apresentar instabilidade (ciclo-limite) para algumas condições das pressões e vazões nas 
conexões com o reservatório e/ou com o sistema de elevação artificial devido ao cabeceio 
de anular (que ocasiona as golfadas no poço). Assim, a realimentação (através das vazões 
entre poço e linha de produção e das pressões na cabeça do poço e no flowline) não pode 
ser negligenciada em uma análise da estabilidade dinâmica do riser.  

 
4.2 Bifurcação do modelo proposto 

Para determinar as características de bifurcação do sistema acoplado em função da 
abertura da choke, uma simulação em malha aberta foi realizada para diferentes condições 
de abertura da válvula de gas-lift. De maneira sequencial, o sinal para abertura da válvula 
choke foi reduzida em degraus de 10% partindo de 90%. Apenas uma seção plana do espaço 
de bifurcação do sistema (para condição de abertura da válvula de injeção de gas-lift em 
20%) é apresentada por restrições de espaço. 

 

Figura 4.1- Diagrama de bifurcação da produção mássica de líquido com ??????=20%. 

0
5

10
15
20
25
30
35

15% 20% 25% 30% 35% 40% 45% 50% 55% 60% 65% 70% 75% 80% 85% 90% 95%

Vazão de produção de líquido: wlout [kg/s]

Média Máximo Series3Mínimo 



Controle antigolfadas na produção de petróleo por gas-lift 18 

  

Figura 4.2 - Bifurcação das pressões no fundo do riser e do poço para ??????=20%. 

4.2.1 Discussões 

Foi verificado que o aumento da vazão de gas-lift, além do aumento da zona de 
estabilidade, também aumenta a vazão de saída de líquido (e gás). Na realidade, o gás é 
injetado em reciclo, e portanto deve ser desconsiderado no cálculo de produção. A redução 
da produção de óleo devido à característica de inversão de ganho mostrada na Figura 2.6 
entre a vazão de entrada de gás para elevação (entrada) e vazão de produção de óleo 
(saída) não foi observada neste modelo simplificado, no entanto. Esta característica advém 
do fato de o modelo não contemplar a perda de carga por fricção no interior do poço. 

4.3 Controladores utilizando os sensores no fundo do mar  

Utilizando a estratégia usual para controle desses sistemas, semelhante ao empregado 
idustrialmente, os experimentos são realizados com um controlador proporcional integral 
(PI). Neste primeiro experimento, após um período em que o controle da válvula choke é 
mantido em manual, o sistema é colocado em automático utilizando um controlador 
(Controlador 1). Posteriormente, um segundo controlador PI (Controlador 2, utilizando 
outra variável controlada) é acionado, para comparar o desempenho dos mesmos sob 
condições semelhantes.  

Segundo Di Meglio (2009a), a variável controlada que permite a estabilização para as 
maiores aberturas da válvula choke é a diferença de pressão na coluna de produção (seja 
do riser ou do poço, dependendo da utilização do modelo), devido à correlação desta 
variável com a massa de líquido (um dos estados do modelo). Assim, o primeiro controlador 
utilizado  

4.3.1 Experimento 1: Controladores com ???  (TPT) e ??? (PDG-TPT) como CVs 

Para analisar o desempenho dos controladores, os resultados dos experimentos com 
os valores de setpoint correspondentes às maiores aberturas da válvula choke são 
apresentados na Figura 4.3 e na Figura 4.5. É importante observar que valores absolutos 
menores de pressão no interior do poço (ou do riser) implicam em uma maior produção 
(para mesmas condições do reservatório). Valores mais afastados do ponto de bifurcação 
de cada variável controlada dentro da região instável em malha aberta representam um 
melhor desempenho do controlador. 

60

65

70

75

80

85

90

15% 25% 35% 45% 55% 65% 75% 85% 95%

Pressão no fundo do riser: 
prb [bar]

Média Máximo Mínimo

150

160

170

180

190

15% 25% 35% 45% 55% 65% 75% 85% 95%

Pressão no fundo do poço: 
pwb [bar]

Média Máximo Mínimo



DEQUI / UFRGS – Leonardo de Mattos Rolim 19 

  

 

Figura 4.3 – Gráficos SP-CV/MV do Controlador 1 na comparação do Experimento 1.  
Fonte: Autor. 

Na Figura 4.3 é possível verificar que a variável controlada do controlador 1 apresenta 
um offset, apesar do bom desempenho do mesmo em relação à abertura da válvula e 
estabilidade do sistema. Isto se deve ao fato da perda de carga por fricção no interior do 
poço ser desconsiderada no modelo (em comparação com a diferença de pressão estática, 
dependente das frações de gás e óleo no tubo de produção do poço), como mostrado na 
Equação 3.18.  

Como a massa de líquido no poço no interior da tubulação (e a fração mássica) 
apresentam um valor de equilíbrio para cada abertura da choke no modelo de Di Meglio 
(2012), enquanto o sistema está estável em uma dada abertura, a diferença de pressão 
pouco varia (ocasionando o offset observado no desempenho do Controlador 1). 

 

  
Figura 4.4 Gráficos SP-CV/MV do Controlador 2 na comparação do Experimento 1.  

Fonte: Autor. 
 
 
 



Controle antigolfadas na produção de petróleo por gas-lift 20 

 

Figura 4.5 Vazões mássicas de gás e óleo no Experimento 1 (CVs no poço).  
Fonte: Autor. 

4.3.2 Saturação da ação de controle e perda de controlabilidade 

Um segundo experimento foi realizado para verificar se a estratégia para o anti-reset 
windup do controlador 1 estava adequada, devido principalmente à presença de um offset 
em regime permanente entre o setpoint e a variável controlada no Experimento 1. 
 

 

Figura 4.6 - Diferença de pressão no poço ???  com a saturação da choke.  
Fonte: Autor. 

 

Figura 4.7 - Perda de controlabilidade do sistema devido à saturação da choke  
Fonte: Autor. 

Como mostrado na Figura 4.6, em no Experimento 2 o setpoint da diferença de 
pressão na coluna de produção do poço foi alterado de 90bar para 88bar, da mesma 
maneira que no experimento da Seção 4.3.1. Para aumentar o erro e permitir resultados 
dentro do tempo de simulação, o setpoint foi em seguida reduzido para 87 e 86bar.  

Devido ao termo integral e à redução característica do ganho estático da planta na 
região de maior abertura da válvula (Jahanshahi, Esmaeil e Skogestad, Sigurd, 2013), o 
controlador PI aumenta sua saída visando aproximar-se do setpoint até a saturação, como 
pode ser visto na Figura 4.7. Isso ocasionou grandes variações nas vazões (maiores que em 
malha aberta com a abertura de 35% da válvula choke), como pode ser visto na Figura 4.8. 



DEQUI / UFRGS – Leonardo de Mattos Rolim 21 

 

Figura 4.8 - Oscilações nas vazões mássicas de produção após saturação da choke.  
Fonte: Autor. 

Apesar da estratégia anti-reset windup, o sistema perde a estabilidade quando o 
controlador para de compensar a dinâmica responsável pelo ciclo limite. Para contornar o 
problema, uma estratégia de limitação do termo integral para manter a variável fora dos 
limites de saturação foi implementada, como pode ser visto na Figura 4.9 e na Figura 4.10. 

 

Figura 4.9 - Diferença de pressão no poço (???-??? ) com anti-reset limitado.  
Fonte: Autor. 

 

Figura 4.10 - Abertura da válvula choke de produção com anti-reset limitado.  
Fonte: Autor. 

Utilizando esta modificação, o poço e o riser foram estabilizados com uma abertura da 
válvula de produção de 97%. Este resultado permitiu que as vazões de saída fossem 
estabilizadas em 13.3 ±0.4 kg/s como pode ser observado na Figura 4.11, o maior valor 
estável obtido até aqui.  



Controle antigolfadas na produção de petróleo por gas-lift 22 

 

Figura 4.11 - Vazões de produção de gás e líquido com anti-reset windup limitado.  
Fonte: Autor. 

O bom desempenho se deu devido à utilização de um limite apropriado para a região da 
ação integral, evitando a saturação da variável manipulada e a redução da região de atração 
do controlador, e a um setpoint inalcançável apropriado (que manteve o sistema estável 
para aquelas condições).  

Este mecanismo é semelhante ao utilizado em controladores preditivos para otimizar 
processos, inclusive na extração de óleo e gás offshore (Willersrud et al., 2013).  

4.3.3 Comparação dos controladores do poço 

A comparação das duas variáveis controladas do poço e das estratégias para o anti-reset 
windup é apresentado na Tabela 4.1.  

Tabela 4.1 - Comparação da utilização de sensores no poço para ???????? = 40%. 
 CV = ??? ? ???  CV = ??? CV = ??? ? ??? 

????? : Abertura média da válvula choke  60 [%] 50 [%] 97 [%] 

?????: Setpoint para controlador 90 [bar] 67 [bar] 88 [bar] 

?????: Pressão máxima no fundo do riser 65,2 [bar] 69 [bar] 64,0 [bar] 

????? ?? : Pressão média no fundo do riser 64,1 [bar] 67 [bar] 63,8 [bar] 

?????: Pressão mínima no fundo do riser 64 [bar] 66 [bar] 63,7 [bar] 

??: Ganho proporcional  -0,09 [
%

???
] -0,07 [

%

???
] -0,09 [

%

???
] 

?? : Tempo integral do controlador  2. 10
4 [s]  2. 104 [s] 2. 104 [s] 

?????: Saturação superior do anti-windup  100 [%] 100 [%] 90 [%] 

?????: Saturação inferior do anti-windup 10 [%] 10 [%] 20 [%] 

 
  



DEQUI / UFRGS – Leonardo de Mattos Rolim 23 

4.4 Controladores utilizando os sensores na plataforma  

A utilização apenas com medições na plataforma dificulta seriamente o controle devido à 
natureza instável da dinâmica de zeros do sistema para esta medição. Ainda assim, os 
resultados do sistema com o uso do sensor de pressão a montante da válvula choke Pmon  
(sensor de ???) são também apresentados para fins comparativos. 

4.4.1 Limites de estabilidade para ??? (Pmon) e (??? ? ??? ) (TPT-Pmon) 

 

 

 

Figura 4.12 - Comparação do uso de medidas de pressão na plataforma.  
Fonte: Autor. 

Ainda que não existam grandes variações nas frações mássicas (que provocariam 
variações na diferença de pressão média dentro da coluna de produção), esta variável está 
intimamente ligada à massa de líquido do sistema, que por sua vez está diretamente ligada 
à estabilidade do sistema (Di Meglio, F et al., 2012). 

Tabela 4.2: Comparação do uso de sensores na plataforma para ???????? =  40%. 

 CV = ??? CV = ??? ? ??? 

????? : Abertura média da válvula choke  20 [%] 50  [%] 

?????: Setpoint para controlador 11 [bar] 88 [bar] 

?????: Pressão máxima no fundo do riser 86 [bar] 67,5 [bar] 

????? ?? : Pressão média no fundo do riser 74 [bar] 67 [bar] 

?????: Pressão mínima no fundo do riser 66 [bar] 66 [bar] 

??: Ganho proporcional  -0,1; -0,2; -0,35; +0,1 [
%

???
] -0,09 [

%

???
] 

?? : Tempo integral do controlador 10
3;  5.103; 104; 102 [s] 1. 104 [s] 

?????: Saturação superior do anti-windup  90 [%] 90 [%] 

?????: Saturação inferior do anti-windup 20 [%] 20 [%] 

Como a estabilidade não foi alcançada com o primeiro controlador inicialmente, diversos 
valores para sua sintonia foram testados, sem sucesso. 
  



Controle antigolfadas na produção de petróleo por gas-lift 24 

4.5 Limitações de instrumentação: atuadores e sensores  

Como em sistemas reais os valores medidos pelos sensores apresenta incertezas, alguns 
experimentos foram realizados para verificar o funcionamento das estratégias 
apresentadas nas seção 4.3 em cenários não ideais. O atuador foi também alterado, de 
modo a apresentar uma dinâmica de primeira ordem (com constante de tempo de 1.5min) 

 

 

 

Figura 4.13 – Seguimento de trajetória utilizando medições no poço e limitações de 
instrumentação e de dinâmica do atuador.  

Fonte: Autor. 

Da mesma maneira, o ruído presente nos sensores afetou as estimativas da pressão 
de fundo do poço do observador Tau utilizado, como pode ser visto na Figura 4.14. 

 

Figura 4.14 – Pressões no do poço com estimação de estados a partir de sinal ruidoso.  



DEQUI / UFRGS – Leonardo de Mattos Rolim 25 

4.5.1 Resultados dos degraus em malha fechada.  

Como mencionado na seção 2.4.3, testes em degrau em malha fechada para 
verificação do modelo para reprodução das golfadas. No sistema apresentado neste 
trabalho, o ciclo limite característico do escoamento em golfadas foi modelado com um 
sistema de extração completo composto por um reservatório estático, um poço de 
extração por elevação artificial, um sistema de linha de produção, um riser e um separador 
na plataforma estático.  

Este sistema, apesar de ligeiramente mais complexo, deve apresentar características 
semelhantes às encontradas experimentalmente e em simuladores rigorosos, como 
observado no trabalho proposto por Jahanshahi (Jahanshahi, Esmaeil e Skogestad, Sigurd, 
2013) para identificação e sintonia de controladores. Assim, para fins comparativos, um 
simples teste para identificação foi realizado aproximando os controladores apresentados 
anteriormente por controladores puramente proporcionais, após ajuste do valor de bias.  

O termo integral dos controladores foi aumentado até que a ação integral ficasse 
insignificativa, para assim aproximá-los do controlador proporcional utilizado por 
Jahanshahi. Os resultados deste experimento são apresentados na Figura 4.15, assim como 
a comparação com a figura do artigo de sintonia por identificação, apresentada na Figura 
4.16 para a pressão no topo do poço (TPT). 

 

 

 
Figura 4.15 – Degraus em malha fechada com controladores proporcionais.  

Fonte: Autor 



Controle antigolfadas na produção de petróleo por gas-lift 26 

  
Figura 4.16 – Testes de degrau em malha fechada utilizados na sintonia.  

Fonte: Autor 

4.6 Convergência do observador não linear simp lificado 

Como visto na seção 4.5, apesar da dinâmica não modeladas do acoplamento dos sistemas, 
e da suposição de vazões de entrada no poço constantes, o observador proposto 
apresentou convergência em todas os pontos de operação e situações testadas. Estes 
resultados são semelhantes a outros na literatura (Di Meglio, F. et al., 2012), (Jahanshahi, 
Skogestad e Grotli, 2013), (Aamo et al., 2005), (Syre, 2012).  

 

 
Figura 4.17 - Estimação da pressão no fundo do poço.  

Fonte: Autor 

4.6.1 Discussão 

Como o modelo para o observador do poço especificamente apresenta o mesmo 
número de estados e características estruturais semelhantes, era de se esperar que a 
convergência fosse atingida com uma sintonia do modelo.  

Não foram aplicados distúrbios nas pressões do reservatório, mas testes com 
diferentes valores da injeção de gás (que altera a frequência das oscilações em malha 
aberta devido a golfadas no poço) foram realizados. A robustez com relação a 
especificações não foi avaliada exaustivamente, mas a utilização de uma planta real ou 
simulador rigoroso será interessante para mais desenvolvimentos neste tópico.  

  



DEQUI / UFRGS – Leonardo de Mattos Rolim 27 

5 C o n c l u s õ e s  e  Tra b a l h o s  F u t u ro s  

 

De acordo com os resultados das simulações, foi possível verificar que as medições no poço 
são fundamentais para efetivo controle automático e estabilização do regime de 
escoamento em sistemas com elevação por gas-lift. Ainda que sensores no fundo do poço 
apresentem ruído considerável e apresentem difícil manutenção, a utilização desta variável 
foi verificada como a melhor para estabilização do sistema com controladores PI.  

Baseado nas simulações utilizando os modelos não lineares, a estratégia definida é a 
utilização da pressão no fundo do poço caso este sensor esteja disponível, e de uma 
estimativa para esta pressão utilizando um observador não linear com parâmetros 
ajustados utilizando medidas históricas do sensor de fundo quando ocorrer a falha do 
mesmo. 

Experimentos superficiais utilizando uma inferência que utiliza como medições a pressão 
no topo do poço, a abertura da válvula de gas-lift, a pressão na linha de injeção de ar (gas-
lift manifold) e a pressão no topo do poço (TPT, na árvore de natal molhada) foram também 
realizados, e o estimador de pressão de fundo apresentou convergência, mesmo com sinais 
ruidosos. 

5.1 Trabalhos futuros 

Algumas propostas para continuidade do trabalho 

5.1.1 Análise de robustez 

Simulações com variações de parâmetros e distúrbios, como: 

? Variações nas pressões, razão gás/óleo e percentual de água no reservatório 

? Variações nas pressões no reservatório e no Gas Lift Manifold. 

? Atuações na válvula para injeção de gas-lift.  

5.1.2 Conexão com camada supervisória 

Integração do sistema de controle proposto utilizando um MPC com estratégias da camada 
de otimização da literatura  

Utilização de controlador preditivo baseado em modelo, utilizando: 

? Restrições por faixas na utilização do compressor p/ gas-lift. 

? Variáveis manipuladas: setpoints de pressão para a camada regulatória, targets. 

? Variáveis controladas: pressão a montante da válvula choke de produção, pressão 
na árvore de natal molhada, pressão de fundo do poço, vazão mássica de gas-lift.  

? Objetivo da otimização: maximizar produção, utilizando faixas p/ seguimento de 
target para a vazão de gas-lift. 

? Restrições: manter pressões em faixas determinadas,  

? Override na válvula de controle de gas-lift quando o sistema de controle da pressão 
pela estação de compressores apresenta pressão muito baixa no gas-lift manifold 
(estratégias para atenuar posterior distúrbio no poço).  

  



Controle antigolfadas na produção de petróleo por gas-lift 28 

6 Refe rê n c i a s  

AAMO, O. M.  et al. Observer design for multiphase flow in vertical pipes with gas-
lift––theory and experiments. Journal of process control, v. 15, n. 3, p. 247-257,  
2005. ISSN 0959-1524.   
 
CAMPONOGARA, E.  et al. An automation system for gas-lifted oil wells: Model 
identification, control, and optimization. Journal of Petroleum Science and 
Engineering, v. 70, n. 3-4, p. 157-167,  2010. ISSN 09204105.   
 
CAMPOS, M. C. M. M. G., MARCOS VINICIUS DE CARVALHOPEREZ,JOSÉ MANUEL 
GONZALEZ TUBIO. Controle Avançado e Otimização na Indústria do Petróleo.   
INTERCIÊNCIA, 2013. 
 
DI MEGLIO, F. Production de pétrole: étude dynamique et contrôle des 
écoulements à bouchons. 2011.   Paris, ENMP 
 
DI MEGLIO, F.; KAASA, G.-O.; PETIT, N. A first principle model for multiphase slugging 
flow in vertical risers. Decision and Control, 2009 held jointly with the 2009 28th 
Chinese Control Conference. CDC/CCC 2009. Proceedings of the 48th IEEE 
Conference on, 2009,   IEEE. p.8244-8251. 
 
DI MEGLIO, F.  et al. Reproducing slugging oscillations of a real oil well. Decision and 
Control (CDC), 2010 49th IEEE Conference on, 2010,   IEEE. p.4473-4479. 
 
DI MEGLIO, F. Model-based control of slugging: advances and challenges. IFAC 
Workshop on Automatic Control in Offshore Oil and Gas Production 2012, 2012. 
 
DI MEGLIO, F. Stabilization of slugging in oil production facilities with or without 
upstream pressure sensors. Journal of Process Control, v. 22, n. 4, p. 809-822,  2012. 
ISSN 0959-1524.   
 
GODHAVN, J. M.; FARD, M. P.; FUCHS, P. H. New slug control strategies, tuning rules 
and experimental results. J. Process Control, v. 15, n. 5, p. 547-557,  2005. ISSN 
0959-1524.   
 
IMSLAND, L. Topics in nonlinear control.: Output Feedback Stabilization and Control 
of Positive Systems.  2002.    
 
IMSLAND, L.; FOSS, B. A.; EIKREM, G. O. State feedback control of a class of positive 
systems: application to gas lift stabilization. Proc. of the 7th European Control Conf, 
2003. 
 
JAHANSHAHI, E.  et al. A comparison between Internal Model Control, optimal PIDF 
and robust controllers for unstable flow in risers.  2014.    
 



DEQUI / UFRGS – Leonardo de Mattos Rolim 29 

JAHANSHAHI, E.; SKOGESTAD, S. Simplified dynamical models for control of severe 
slugging in multiphase risers. World Congress, 2011. p.1634-1639. 
 
JAHANSHAHI, E. Closed-loop model identification and pid/pi tuning for robust anti-
slug control. 10th IFAC International Symposium on Dynamics and Control of Process 
Systems. Mumbai, India, 2013. 
 
JAHANSHAHI, E. Comparison between nonlinear model-based controllers and gain-
scheduling Internal Model Control based on identified model. Decision and Control 
(CDC), 2013 IEEE 52nd Annual Conference on, 2013, 10-13 Dec. 2013. p.853-860. 
 
JAHANSHAHI, E.; SKOGESTAD, S.; GROTLI, E. I. Anti-slug control experiments using 
nonlinear observers. American Control Conference (ACC), 2013, 2013, 17-19 June 
2013. p.1056-1062. 
 
JAHANSHAHI, E.; SKOGESTAD, S.; GRØTLI, E. I. Nonlinear model-based control of 
two-phase flow in risers by feedback linearization. 9th IFAC Symposium on 
Nonlinear Control Systems, 2013. 
 
JAHANSHAHI, E.; SKOGESTAD, S.; HANSEN, H. Control structure design for stabilizing 
unstable gas-lift oil wells. Advanced Control of Chemical Processes, v. 8, n. part 1, 
p. 93-100,  2012.    
 
JAHANSHAHI, E.; SKOGESTAD, S.; HELGESEN, A. H. Controllability analysis of severe 
slugging in well-pipeline-riser systems. IFAC Workshop-Automatic Control in 
Offshore Oil and Gas Production, 2012. p.101-108. 
 
JAHANSHAHI, E.; SKOGESTAD, S.; LIEUNGH, M. Subsea solution for anti-slug control 
of multiphase risers. Control Conference (ECC), 2013 European, 2013, 17-19 July 
2013. p.4094-4099. 
 
KAASA, G.-O.  et al. Attenuation of slugging in unstable oil wells by nonlinear control. 
17th IFAC World Congress, 2008. 
 
KAMMERZELL, J. Long subsea lines, vertical risers and in offshore oil production in 
West Africa.  2014.  Disponível em: &amp;lt;
http://oilpro.com/img/usermedia/0nBbvrbxIU6Lfc2TvCCV4g/original.png &gt;.  
 
REINSNES, S. E. Stabilization of slugging by sliding mode control.  2009.    
 
SINEGRE, L. Etude des instabilités dans les puits activés par gas-lift. 2006.   École 
Nationale Supérieure des Mines de Paris 
 
SINEGRE, L.; PETIT, N.; MENEGATTI, P. Predicting instabilities in gas-lifted wells 
simulation. American Control Conference, 2006, 2006, 14-16 June 2006. p.8 pp. 
 

http://oilpro.com/img/usermedia/0nBbvrbxIU6Lfc2TvCCV4g/original.png


Controle antigolfadas na produção de petróleo por gas-lift 30 

STASIAK, M.; PAGANO, D.; PLUCENIO, A. A new discrete slug-flow controller for 
production pipeline risers. IFAC Workshop on Automatic Control in Offshore Oil and 
Gas Production-ACOOG, 2012. 
 
STORKAAS, E. Stabilizing control and controllability: Control solutions to avoid slug 
flow in pipeline. 2005.   Ph. D. thesis, Norwegian University of Science and 
Technology 
 
STORKAAS, E.; SKOGESTAD, S. Controllability analysis of two-phase pipeline-riser 
systems at riser slugging conditions. Control Engineering Practice, v. 15, n. 5, p. 567-
581,  2007. ISSN 0967-0661.   
 
SYRE, T. V. Anti-Slug Control with Non-Linear State Estimation.  2012.    
 
TEIXEIRA, A. F. Otimização da Produção de Poços de Petróleo com Gas Lift 
Contínuo. 2013.   Universidade Federal do Rio de Janeiro 
 
WILLERSRUD, A.  et al. Short-term production optimization of offshore oil and gas 
production using nonlinear model predictive control. 23: 215-223 p. 2013. 
 
 

  



DEQUI / UFRGS – Leonardo de Mattos Rolim 31 

7 A p ê n d i c e s   

7.1  Modelo em diagrama de blocos do Simulink  

Bloco principal, mostrando o acoplamento dos sistemas. 

 

 

  



Controle antigolfadas na produção de petróleo por gas-lift 32 

7.2 S-functions utilizadas no MATLAB  

7.2.1 Modelo flowline-riser 

function [sys,x0,str,ts,simStateCompliance] = sFunDiMeglio_riser(t,x,u,flag,statesIC,p) 
 
switch flag, 
  case 0, 
    [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC); 
  case 1, 
    sys=mdlDerivatives(t,x,u,p); 
  case 2, 
    sys=mdlUpdate(t,x,u); 
  case 3, 
    sys=mdlOutputs(t,x,u,p); 
  case 4, 
    sys=mdlGetTimeOfNextVarHit(t,x,u); 
  case 9, 
    sys=mdlTerminate(t,x,u); 
  otherwise 
    DAStudio.error('Simulink:blocks:unhandledFlag', num2str(flag)); 

  
end 

  
% end sfuntmpl 
%============================================================================= 
% mdlInitializeSizes 
% Return the sizes, initial conditions, and sample times for the S-function. 
%============================================================================= 
% 
function [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC) 
sizes = simsizes; 

  
sizes.NumContStates  = 3; 
sizes.NumDiscStates  = 0; 
sizes.NumOutputs     = 8; % 3;  
sizes.NumInputs      = 4; 
sizes.DirFeedthrough = 1; 
sizes.NumSampleTimes = 1;   % at least one sample time is needed 

  
sys = simsizes(sizes); 

  
% 
% initialize the initial conditions 
% 
x0 = statesIC; 

  
% 
% str is always an empty matrix 
% 
str = []; 

  
% 
% initialize the array of sample times 
% 
ts  = [0 0]; 

  
% Specify the block simStateComliance. The allowed values are: 
%    'UnknownSimState', &amp;lt;The default setting; warn and assume DefaultSimState 
%    'DefaultSimState', &amp;lt;Same sim state as a built-in block 
%    'HasNoSimState',   &amp;lt;No sim state 
%    'DisallowSimState' &amp;lt;Error out when saving or restoring the model sim state 
simStateCompliance = 'UnknownSimState'; 

  
% end mdlInitializeSizes 

  
% 
%============================================================================= 
% mdlDerivatives 
% Return the derivatives for the continuous states. 
%============================================================================= 
% 

  
function sys=mdlDerivatives(t,x,u,p) 

  
% Variáveis manipuladas 
uProd = u(1); 
% Pressões de conexão 



DEQUI / UFRGS – Leonardo de Mattos Rolim 33 

ps     = u(2); 

  
% Vazões mássicas de conexão com reservatório 
wgin   = u(3); 
wlin   = u(4); 

  
% Parâmetros de entrada 
% T      = u(7); 

  
% Parâmetros fixos 

  
% aa = p(1); 
% bb = p(2); 

  
% Variáveis de estado do modelo 
mgeb = x(1); 
mgr  = x(2); 
mlr  = x(3); 

  
%------------------- 
% Parâmetros do modelo 

  
rhom = p(1);    % 900; 
mlstill = p(2); % 3.73*10^4; 
mldelta = p(3); % 45402.4; 

  
aa   = p(4);    % 2857.94; 
bb   = p(5);    % 1.23463*10^8; 
% cc   = 1576.53;             % Para A = 4.4e-3 
cc   = p(6);    % 391.905;    % Para A = 1.77e-2 

  
% Constantes das válvulas 
cout = p(7);    % 2.8*10^-3;  % Coeficiente da válvula de produção 
cg   = p(8);    % 10^-4;      % Coeficiente da válvula virtual 

  
epsilon = p(9); 

  
eps=1e-15; 
%------------------- 
% Pressões 
peb = aa*mgeb; 
prt = bb*mgr/max(eps,(mldelta-mlr)); 
prb = prt + (mlr + mlstill)*cc; 

  
%----  
f1 = -max(0, peb-prb)*cg; 
f2 =  max(0, peb-prb)*cg; 

  
%---- uProd 
wout_mult=sqrt( max( 0,(prt-ps)*rhom ) )*cout; 
mass_riser=mgr+mlr; 
riser_gasFraction=mgr/mass_riser; 
riser_liqFraction=mlr/mass_riser; 

  
% if riser_gasFraction&gt;0.3 
%    display(strcat('riser_gasFraction =',num2str(riser_gasFraction))); 
% end 
g21 = -wout_mult*riser_gasFraction; % g31*mgr/mlr 
g31 = -wout_mult*riser_liqFraction; 

  
% epsilon = 0.78; % 0.78; 
wgin_eb= (1-epsilon)*wgin; 
wgin_r = epsilon*wgin; 

  
%----- 

  
% Equações de estado na forma AffineStateSpace 

  
dx1dt = f1 + 0         + 1*wgin_eb + 0         + 0      ; 
dx2dt = f2 + g21*uProd + 0         + 1*wgin_r  + 0      ; 
dx3dt = 0  + g31*uProd + 0         + 0         + 1*wlin ; 

  
% dx1dt = (1-epsilon)*wgin + 0         + g12*uGLift ; 
% dx2dt = (epsilon)*wgin + g21*uProd + g22*uGLift ; 

  



Controle antigolfadas na produção de petróleo por gas-lift 34 

  
sys=[ dx1dt 
      dx2dt 
      dx3dt ]; 

  
% end mdlDerivatives 

  
% 
%============================================================================= 
% mdlUpdate 
% Handle discrete state updates, sample time hits, and major time step 
% requirements. 
%============================================================================= 
% 
function sys=mdlUpdate(t,x,u) 

  
sys = []; 

  
% end mdlUpdate 

  
% 
%============================================================================= 
% mdlOutputs 
% Return the block outputs. 
%============================================================================= 
% 
function sys=mdlOutputs(t,x,u,p) 

  
% sys = x; 

  
% Variáveis de estado do modelo 
mgeb = x(1); 
mgr  = x(2); 
mlr  = x(3); 

  
% Entradas do modelo 
uProd  = u(1); 
ps     = u(2); 

  
%------------------- 
% Parâmetros do modelo 

  
rhom = p(1);    % 900; 
mlstill = p(2); % 3.73*10^4; 
mldelta = p(3); % 45402.4; 

  
aa   = p(4);    % 2857.94; 
bb   = p(5);    % 1.23463*10^8; 
% cc   = 1576.53;             % Para A = 4.4e-3 
cc   = p(6);    % 391.905;    % Para A = 1.77e-2 

  
% Constantes das válvulas 
cout = p(7);    % 2.8*10^-3;  % Coeficiente da válvula de produção 

  
%------------------- 

  

  
peb = aa*mgeb; 
prt = bb*mgr/(mldelta-mlr); 
prb = prt + (mlr + mlstill)*cc; 

  
% if isnan(ps) || isnan(uProd) 
%     wout=0; 
% else 
%     wout  = cout* sqrt(max(0,rhom*(prt-ps)))*uProd; 
% end 
% wlout = wout; 
% wgout = (mgr/mlr)*wout; 

  
wout_mult=sqrt( max( 0,(prt-ps)*rhom ) )*cout*uProd; 
mass_riser=mgr+mlr; 
fraction_gr=mgr/mass_riser; 
fraction_lr=mlr/mass_riser; 
wgout = wout_mult*fraction_gr; % g31*mgr/mlr 
wlout = wout_mult*fraction_lr; 

  



DEQUI / UFRGS – Leonardo de Mattos Rolim 35 

sys = [ wgout 
        wlout 
        prt 
        prb 
        peb 
        x(1) 
        x(2) 
        x(3) ]; 

  

  
% end mdlOutputs 

  
% 
%============================================================================= 
% mdlGetTimeOfNextVarHit 
% Return the time of the next hit for this block.  Note that the result is 
% absolute time.  Note that this function is only used when you specify a 
% variable discrete-time sample time [-2 0] in the sample time array in 
% mdlInitializeSizes. 
%============================================================================= 
% 
function sys=mdlGetTimeOfNextVarHit(t,x,u) 

  
sampleTime = 1;    %  Example, set the next hit to be one second later. 
sys = t + sampleTime; 

  
% end mdlGetTimeOfNextVarHit 

  
% 
%============================================================================= 
% mdlTerminate 
% Perform any end of simulation tasks. 
%============================================================================= 
% 
function sys=mdlTerminate(t,x,u) 

  
sys = []; 

 

  



Controle antigolfadas na produção de petróleo por gas-lift 36 

7.2.2 Modelo poço com elevação por gas-lift 

function [sys,x0,str,ts,simStateCompliance] = sFunDiMeglio_mod(t,x,u,flag,statesIC,p) 

  
switch flag, 
  case 0, 
    [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC); 
  case 1, 
    sys=mdlDerivatives(t,x,u,p); 
  case 2, 
    sys=mdlUpdate(t,x,u); 
  case 3, 
    sys=mdlOutputs(t,x,u,p); 
  case 4, 
    sys=mdlGetTimeOfNextVarHit(t,x,u); 
  case 9, 
    sys=mdlTerminate(t,x,u); 
  otherwise 
    DAStudio.error('Simulink:blocks:unhandledFlag', num2str(flag)); 

  
end 

  
% end sfuntmpl 
% 
%============================================================================= 
% mdlInitializeSizes 
% Return the sizes, initial conditions, and sample times for the S-function. 
%============================================================================= 
% 
function [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC) 

  
sizes = simsizes; 

  
sizes.NumContStates  = 3; 
sizes.NumDiscStates  = 0; 
sizes.NumOutputs     = 8; % 3;  
sizes.NumInputs      = 7; 
sizes.DirFeedthrough = 1; 
sizes.NumSampleTimes = 1;   % at least one sample time is needed 

  
sys = simsizes(sizes); 

  
% 
% initialize the initial conditions 
% 
x0 = statesIC; 

  
% 
% str is always an empty matrix 
% 
str = []; 

  
% 
% initialize the array of sample times 
% 
ts  = [0 0]; 

  
simStateCompliance = 'UnknownSimState'; 

  
% end mdlInitializeSizes 

  
%============================================================================= 
% mdlDerivatives 
% Return the derivatives for the continuous states. 
%============================================================================= 
% 

  
function sys=mdlDerivatives(t,x,u,p) 

  
% Variáveis manipuladas 
uProd = u(1); 
uGLift = u(3); 

  
% Pressões de conexão 
ps     = u(2); 
pglm   = u(4); 

  
% Vazões mássicas de conexão com reservatório 
wgin_r = u(5); 
wlin   = u(6); 

  
% Parâmetros de entrada 
% T      = u(7); 
pres    = u(7); % 320e5; 

  
% Parâmetros fixos 



DEQUI / UFRGS – Leonardo de Mattos Rolim 37 

  
% aa = p(1); 
% bb = p(2); 

  
% Variáveis de estado do modelo 
mgeb = x(1); 
mgr  = x(2); 
mlr  = x(3); 

  
%------------------- 
% Parâmetros do modelo 

  
rhom = p(1);    % 900; 
mlstill = p(2); % 3.73*10^4; 
mldelta = p(3); % 45402.4; 

  
aa   = p(4);    % 2857.94; 
bb   = p(5);    % 1.23463*10^8; 
% cc   = 1576.53;             % Para A = 4.4e-3 
cc   = p(6);    % 391.905;    % Para A = 1.77e-2 

  
% Constantes das válvulas 
cout = p(7);    % 2.8*10^-3;  % Coeficiente da válvula de produção 
cg   = p(8);    % 10^-4;      % Coeficiente da válvula virtual 

  
kgl  = p(9);    % (1/2)*1.73948*10^-4;   % Coeficiente da válvula de entrada de gas-lift 

  
eps=1e-15; 
%------------------- 
% Pressões 
peb = aa*mgeb; 
prt = bb*mgr/max(eps,(mldelta-mlr)); 
prb = prt + (mlr + mlstill)*cc; 

  

  
%--- 
avg_prb = 220e5; 

  
if size(p,2) &gt; 9 
    avg_prb = p(10); 
end 

  
avg_dp  = pres - avg_prb; 
if pres &gt; 0 
    wlin   = (pres-prb)*(wlin/avg_dp); %/(11.5144e5); 
    wgin_r = (pres-prb)*(wgin_r/avg_dp); %/(182.0773e5); 
end 
%----  
f1 = -max(0, peb-prb)*cg; 
f2 =  max(0, peb-prb)*cg; 

  
%---- uProd 
wout_mult=sqrt( max( 0,(prt-ps)*rhom ) )*cout; 
well_mass=mgr+mlr; 
well_gasFraction=mgr/well_mass; 
well_liqFraction=mlr/well_mass; 

  
g21 = -wout_mult*well_gasFraction; % g31*mgr/mlr 
g31 = -wout_mult*well_liqFraction; 

  
%----- uGasLift 
usePglm = pglm~=0 &amp;amp;&amp;amp; uGLift ~= 0; 
if usePglm 
    g12 = sqrt( max( 0,pglm-peb ) )*kgl; 
    wgin_eb = g12*uGLift; 
else 
    epsilon = 0.78; % 0.78; 
    wgin    = wgin_r/epsilon; 
    wgin_eb = (1-epsilon)*wgin; 
end 

  
%----- 

  
% Equações de estado na forma AffineStateSpace 

  
dx1dt = f1 + 0         + 1*wgin_eb + 0         + 0      ; 
dx2dt = f2 + g21*uProd + 0         + 1*wgin_r  + 0      ; 
dx3dt = 0  + g31*uProd + 0         + 0         + 1*wlin ; 

  
sys=[ dx1dt 
      dx2dt 
      dx3dt ]; 

  
% end mdlDerivatives 

  
% 



Controle antigolfadas na produção de petróleo por gas-lift 38 

%============================================================================= 
% mdlUpdate 
% Handle discrete state updates, sample time hits, and major time step 
% requirements. 
%============================================================================= 
% 
function sys=mdlUpdate(t,x,u) 

  
sys = []; 

  
% end mdlUpdate 

  
% 
%============================================================================= 
% mdlOutputs 
% Return the block outputs. 
%============================================================================= 
% 
function sys=mdlOutputs(t,x,u,p) 

  
% sys = x; 

  
% Variáveis de estado do modelo 
mgeb = x(1); 
mgr  = x(2); 
mlr  = x(3); 

  
% Entradas do modelo 
uProd  = u(1); 
ps     = u(2); 

  
%------------------- 
% Parâmetros do modelo 

  
rhom = p(1);    % 900; 
mlstill = p(2); % 3.73*10^4; 
mldelta = p(3); % 45402.4; 

  
aa   = p(4);    % 2857.94; 
bb   = p(5);    % 1.23463*10^8; 
cc   = p(6);    % 391.905;    % Para A = 1.77e-2 

  
% Constantes das válvulas 
cout = p(7);    % 2.8*10^-3;  % Coeficiente da válvula de produção 
%------------------- 

  

  
peb = aa*mgeb; 
prt = bb*mgr/(mldelta-mlr); 
prb = prt + (mlr + mlstill)*cc; 

  
if isnan(ps) || isnan(uProd) 
    wout=0; 
else 
    wout  = cout* sqrt(max(0,rhom*(prt-ps)))*uProd; 
end 

  
wlout = wout; 
wgout = (mgr/mlr)*wout; 

  
sys = [ wgout 
        wlout 
        prt 
        prb 
        peb 
        x(1) 
        x(2) 
        x(3) ]; 

  

  
% end mdlOutputs 

  
function sys=mdlGetTimeOfNextVarHit(t,x,u) 

  
sampleTime = 1;    %  Example, set the next hit to be one second later. 
sys = t + sampleTime; 

  
% end mdlGetTimeOfNextVarHit 

  
% 
%============================================================================= 
% mdlTerminate 
% Perform any end of simulation tasks. 
%============================================================================= 
% 
function sys=mdlTerminate(t,x,u) 



DEQUI / UFRGS – Leonardo de Mattos Rolim 39 

  
sys = []; 

  
% end mdlTerminate 

7.2.3 Observador de estados  

function [sys,x0,str,ts,simStateCompliance] = sFunObserver_DiMeglio(t,x,u,flag,statesIC,p) 

  
switch flag, 
  case 0, 
    [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC,p); 
  case 1, 
    sys=mdlDerivatives(t,x,u,p); 
  case 2, 
    sys=mdlUpdate(t,x,u); 
  case 3, 
    sys=mdlOutputs(t,x,u,p); 
  case 4, 
    sys=mdlGetTimeOfNextVarHit(t,x,u); 
  case 9, 
    sys=mdlTerminate(t,x,u); 
  otherwise 
    DAStudio.error('Simulink:blocks:unhandledFlag', num2str(flag)); 
end 
% 
%============================================================================= 
% mdlInitializeSizes 
% Return the sizes, initial conditions, and sample times for the S-function. 
%============================================================================= 
function [sys,x0,str,ts,simStateCompliance]=mdlInitializeSizes(statesIC,p) 

  
% 
% call simsizes for a sizes structure, fill it in and convert it to a 
% sizes array. 
% 
% Note that in this example, the values are hard coded.  This is not a 
% recommended practice as the characteristics of the block are typically 
% defined by the S-function parameters. 
% 
sizes = simsizes; 

  
sizes.NumContStates  = 3; 
sizes.NumDiscStates  = 0; 
sizes.NumOutputs     = 4; % 3;  
sizes.NumInputs      = 8; 
sizes.DirFeedthrough = 0; 
sizes.NumSampleTimes = 1;   % at least one sample time is needed 

  
sys = simsizes(sizes); 

  
mldelta = p(3); 
bb = p(5); 

  
mgeb_0 = statesIC(1); 
mgr_0 = statesIC(2); 
mlr_0 = statesIC(3); 

  
prt_0 = mgr_0/(mldelta-mlr_0)*bb; 

  

  
x0 = [ mgeb_0 
       prt_0 
       mlr_0  ]; 

  
% str is always an empty matrix 
% 
str = []; 

  
% 
% initialize the array of sample times 
% 
ts  = [0 0]; 

  
% Specify the block simStateComliance. The allowed values are: 
simStateCompliance = 'UnknownSimState'; 

  
% end mdlInitializeSizes 

  
%============================================================================= 
% mdlDerivatives 
% Return the derivatives for the continuous states. 
%============================================================================= 
function sys=mdlDerivatives(t,x,u,p) 

  
% Variáveis manipuladas 



Controle antigolfadas na produção de petróleo por gas-lift 40 

uProd = u(1); 
uGLift = u(3); 

  
% Pressões de conexão 
ps     = u(2); 
pglm   = u(4); 

  
% Vazões mássicas de conexão com reservatório 
wginr  = u(5); 
wlin   = u(6); 

  
% Parâmetros de entrada 
% T      = u(7); 
pres   = u(7); 

  
% Saídas lidas 
prt_measured = u(8); 

  
% Parâmetros fixos 

  
% aa = p(1); 
% bb = p(2); 

  
% Variáveis de estado do modelo 
x1  = x(1); 
x2  = x(2); 
x3  = x(3); 

  
mgeb = x1; 
prt = x2; 
mlr = x3; 

  
%------------------- 
% Parâmetros do modelo 

  
rhom = p(1);    % 900; 
mlstill = p(2); % 3.73*10^4; 
mldelta = p(3); % 45402.4; 

  
aa   = p(4);    % 2857.94; 
bb   = p(5);    % 1.23463*10^8; 
% cc   = 1576.53;             % Para A = 4.4e-3 
cc   = p(6);    % 391.905;    % Para A = 1.77e-2 

  
% Constantes das válvulas 
cout = p(7);    % 2.8*10^-3;  % Coeficiente da válvula de produção 
cg   = p(8);    % 10^-4;      % Coeficiente da válvula virtual 

  
kgl  = p(9);    % (1/2)*1.73948*10^-4;   % Coeficiente da válvula de entrada de gas-lift 

  
kObserver = p(10);  

  
peb = mgeb*aa; 

  
% Vazões do sistema 
wout = sqrt(max(0, prt - ps)*rhom)*cout*uProd; 

  
wglift = kgl*uGLift*sqrt(max(0, pglm - peb)); 

  
wvirtual = cg*max(0, peb - prt -cc*(mlr + mlstill)); 

  
x1Dot = wglift - wvirtual; 

  
% Como o modelo do Di Meglio foi alterado, a alteração deve ser passada p/ 
% a pressão: 
x2Dot = (bb/(mldelta - mlr))*... 
        (wginr + wvirtual + wlin*(prt/bb)-(mldelta/mlr)*(prt/bb)*wout); 
x3Dot = wlin - wout; 

  
sys = [ x1Dot 
        x2Dot - kObserver*(prt - prt_measured) 
        x3Dot         ]; 
% end mdlDerivatives 

  
% 
%============================================================================= 
% mdlUpdate 
% Handle discrete state updates, sample time hits, and major time step 
% requirements. 
%============================================================================= 
% 
function sys=mdlUpdate(t,x,u) 

  
sys = []; 

  



DEQUI / UFRGS – Leonardo de Mattos Rolim 41 

% end mdlUpdate 

  
% 
%============================================================================= 
% mdlOutputs 
% Return the block outputs. 
%============================================================================= 
% 
function sys=mdlOutputs(t,x,u,p) 

  
%  
mlstill = p(2); 
aa =  p(4); 
cc = p(6); 

  
pwc = ( x(1)*aa ); 
pwt = x(2); 
mlr  = x(3); 

  
pwb_est = pwt + (mlr + mlstill)*cc; 

  
sys = [ pwc 
        pwt 
        mlr  
        pwb_est]; 

  

  
% end mdlOutputs 

  
% 
%============================================================================= 
% mdlGetTimeOfNextVarHit 
% Return the time of the next hit for this block.  Note that the result is 
% absolute time.  Note that this function is only used when you specify a 
% variable discrete-time sample time [-2 0] in the sample time array in 
% mdlInitializeSizes. 
%============================================================================= 
% 
function sys=mdlGetTimeOfNextVarHit(t,x,u) 

  
sampleTime = 1;    %  Example, set the next hit to be one second later. 
sys = t + sampleTime; 

  
% end mdlGetTimeOfNextVarHit 

  
%============================================================================= 
% mdlTerminate 
% Perform any end of simulation tasks. 
%============================================================================= 
% 
function sys=mdlTerminate(t,x,u) 

  
sys = []; 

  
% end mdlTerminate 


</field>
	</doc>
</add>