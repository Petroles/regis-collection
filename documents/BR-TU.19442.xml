<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19442</field>
		<field name="filename">2792_001057852.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 
 

 

 

 

ATENUAÇÃO DE GOLFADAS EM SISTEMAS DE 

ELEVAÇÃO DE PETRÓLEO EM AMBIENTE 

OFFSHORE 

DISSERTAÇÃO DE MESTRADO 

 

Giovani Gonçalves Gerevini 

 

 

 

 

 

 

 

Porto Alegre 
2017 

  



 

  



UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 
 

 

 

 

ATENUAÇÃO DE GOLFADAS EM SISTEMAS DE 

ELEVAÇÃO DE PETRÓLEO EM AMBIENTE 

OFFSHORE 

Giovani Gonçalves Gerevini  

Dissertação de Mestrado apresentada como 
requisito parcial para obtenção do título de Mestre 
em Engenharia. 

Área de concentração: Pesquisa e Desenvolvimento 
de Processos. 

Linha de Pesquisa: Projeto, Simulação, Modelagem, 
Controle e Otimização de Processos Químicos e 
Bioprocessos. 

Orientadores: 

Prof. Dr. Marcelo Farenzena 

Prof. Dr. Jorge Otávio Trierweiler 

 

 

Porto Alegre 
2017 

  



 

  



UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

 

 

 

 

 

A Comissão Examinadora, abaixo assinada, aprova a Dissertação Atenuação 

de Golfadas em Sistemas de Elevação de Petróleo em Ambiente Offshore, 

elaborada por Giovani Gonçalves Gerevini, como requisito parcial para obtenção do 

Grau de Mestre em Engenharia. 

 

Comissão Examinadora: 

 

 

 Prof. Dr Cassiano Ranzan / FURG  

 

 Prof. Dr. Mario C.M.M. Campos / CENPES - PETROBRAS 

 

 Prof. Dr. Rafael de P. Soares Pelegrini / PPGEQ - UFRGS 

 

  



 

 



 

I 

 

 

Agradecimentos 

Primeiramente agradeço ao professor Marcelo Farenzena pelo acolhimento 
no projeto golfadas, sem isto nada disso seria possível. 

Agradeço os meus orientadores professores Marcelo Farenzena e Jorge 
Trierweiler ao tempo dedicado de mentoria e disponibilidade dedicados a mim ao 
longo do projeto. Ambos foram fundamentais para o desenvolvimento deste 
trabalho e contribuíram significativamente para o meu crescimento profissional. 

Agradeço também ao pessoal do CENPES/PETROBRAS, principalmente 
ao Fábio e à Cristina, pelo treinamento, compartilhamento de conhecimento e 
apoio motivacional ao longo desta parceria. 

Agradeço os não só colegas de trabalho, mas amigos que fiz na GIMSCOP 
ao longo desses anos, em especial ao Zé, Maria, Leonardo, Denilson, Juliano, 
Cláudia e Cris. Sem dúvida vocês fizeram meus dias mais doces, literalmente. 

Agradeço a minha família, Beto, Cledi e Gabi. O orgulho de vocês por mim 
me motiva a cada chegar mais longe.  

Em especial agradeço a minha esposa Jéssica pelo apoio incondicional 
nesta caminhada. A tua ambição me inspira em busca do melhor. 

Por fim, agradeço a ANP pelo apoio financeiro e suas políticas de incentivo 
à pesquisa e desenvolvimento, que fazem com que pessoas como eu possam 
trabalhar com o que gostam e acreditam.  

  



II 

 

  



III 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

“O impossível não é um fato, é apenas uma opinião. ” 

 (Mario Sérgio Cortella)  



IV 

 

  



V 

 

 

Resumo 

A Exploração e Produção de petróleo e gás é de suma importância para 
economia brasileira e mundial sendo fundamental o entendimento dos 
comportamentos do sistema produtivo para o aumento na produção. Neste 
entendimento, a problemática relacionado ao fluxo intermitente chamado de 
golfada, tem um comportamento tipicamente cíclico que pode causar oscilações 
de pressão problemáticas à produção, à vida útil e à segurança de sistemas de 
produção offshore. Através do desenvolvimento de um modelo simplificado para 
reprodução das golfadas, o presente trabalho propõe a aplicação de um 
Controlador Preditivo Não Linear (NMPC) para a atenuação do regime de golfada 
em sistemas de elevação de petróleo por Gas-Lift. 

Resultado de uma revisão dos modelos simplificados e dos métodos de 
controle de golfadas, é apresentado neste trabalho um novo modelo caixa cinza 
de produção de petróleo de sistemas tipicamente profundos e ultra profundos 
para exploração dos potenciais do algoritmo NMPC chamado Linearização ao 
Longo da Trajetória (Duraiski et al., 2002). Para a aplicação do modelo, um 
método de estimação dos parâmetros do modelo cíclico, com penalização de 
regiões oscilatórias, é apresentada. Para aplicação do controle uma sistemática 
de ajuste dos parâmetros do controlador é proposta, baseada nas características 
do ciclo limite da golfada.  

O modelo apresentado é validado para dados do modelo rigoroso OLGA e 
é extrapolado para diversas regiões de operação demonstrando o potencial de 
estudos não-intrusivos da dinâmica e ganhos de um poço, fazendo o uso do novo 
modelo. Na exploração do controle, o modelo é utilizado num estudo de 
desempenho servo para controle de pressão de fundo de poço ( ???? ). 

Gradualmente, o NMPC é comparado ao controle linear PI, inicialmente numa 
estrutura monovariável. Enquanto o PI tem sua robustez limitada por regiões de 
baixo ganho, devido às restrições físicas das válvulas choke, o NMPC trata 
naturalmente a não-linearidade do sistema, atingindo ganhos de até 9 % na 
produção de óleo teórica. Num segundo momento, a taxa de injeção de gás de 
elevação é adicionada ao controlador, numa estrutura multivariável fazendo com 
que a manipulação da choke diminua 80 % com uma diminuição sensível de 
ganho teórico da produção em 1,7 %, em relação à estrutura monovariável.  

Numa análise de aplicabilidade de controle, conclui-se que a estrutura a ser 
utilizada é dependente do objetivo da aplicação de controle. Se o objetivo é o de 
eliminar a golfada, o controlador linear mostrou mais eficaz. Se o objetivo é 
aumentar a produção o NMPC na forma monovariável alcança resultados 
semelhante ao PI, mas de forma mais robusta em relação às não linearidades. 
Entretanto a taxa de utilização da choke aumenta. Ainda assim, se isto for um 
empecilho para uma aplicação real, a incorporação da multivariabilidade do 
controlador NMPC faz com que a taxa de utilização seja distribuída entre as 
variáveis manipuladas, amenizando o uso excessivo da choke , com uma sensível 
perda de ganho teórico. 



VI 

 

  



VII 

 

 

Abstract 

The Exploration and Production of oil and gas is of paramount importance 
to the Brazilian and world economy, being fundamental the understanding of the 
behaviors of the productive system for the increase in production. In this 
understanding, the problem related to the intermittent flow called slugging has a 
typically cyclic behavior that can cause pressure oscillations problematic to the 
production, the useful life and the safety of offshore production systems. The 
present work proposes the application of a Non-linear Predictive Controller 
(NMPC) for the attenuation of the slug in Gas-lift systems. 

As a result of a review of the simplified models and the methods of control 
of slugging, a new gray box model of petroleum production from typically deep and 
ultra deep systems is presented for the exploration of the potentials of the NMPC 
algorithm called Local Linearization Trajetory (Duraiski et al., 2002). For the model 
application, a method of parameter estimation of the cyclic model with oscillatory 
regions penalty is presented. For control application a systematic adjustment of 
the controller parameters is proposed, based on the characteristics of the slug. 

The model presented is validated for data from the rigorous OLGA model 
and is extrapolated to several regions of operation demonstrating the potential of 
non-intrusive studies of the dynamics and gains of a well using the new model. In 
the control exploration, the model is used in a servo performance study for well 
bottom pressure control (???? ). Gradually, the NMPC is compared to the linear 

control PI, initially in a monovariable structure. While the PI has its robustness 
limited by low gain regions due to the physical constraints of choke valves, NMPC 
naturally addresses system nonlinearity, achieving gains of up to 9 % in theoretical 
oil production. In a second moment, the rate of injection of elevation gas is added 
to the controller in a multivariate structure causing the choke manipulation to 
decrease 80 % with a sensible decrease of the theoretical oil production gain by 
1.7 % in relation to the monovariable structure . 

In an control applicability analysis, it is concluded that the structure to be 
used is dependent on the purpose of the control application. If the goal is to 
eliminate the slugging, the linear controller proved more effective. If the objective 
is to increase production the NMPC in the monovariable form achieves results 
similar to the PI, but in a more robust way in relation to the nonlinearities. 
However, the rate of choke use increases. If this is an obstacle to a real 
application, the incorporation of the multivariate NMPC controller causes the 
utilization rate to be distributed among the manipulated variables, reducing the 
excessive use of the choke, with a sensible loss of theoretical gain.  

  



VIII 

 

 

  



IX 

LISTA DE FIGURAS 

 
Figura 1.1: Curva Hipotética de Produção de Petróleo em relação à variáveis de 
entrada de processo (Baseado em HU, 2004, DI MEGLIO et al.,2012 e 
CAMPONOGARA et al.,2010). ............................................................................... 4 
Figura 2.1: Ilustração de uma unidade típica de extração de petróleo por Gas-lift 
(Adaptado de IGUMA E SORRELL, 2015). .......................................................... 11 
Figura 2.2: Ilustração simplificada do processo de extração de um poço por GL 
(adaptado de JAHANSHAHI, 2013). .................................................................... 12 
Figura 2.3: Ilustração do mapa de padrão de escoamento em escoamento: A. 
horizontal; e B. vertical  (STANISLAV; KOKAL; NICHOLSON, 1986; TAITEL, 
YEHUDA, 1986). .................................................................................................. 14 
Figura 2.4: Ilustração do comportamento das fases gás (em azul) e da fase 
líquida (em cinza) das etapas do Mecanismo de Cabeceio Anular: 1) Início do 
Enchimento do Anular; 2) Esvaziamento do Anular e Injeção de gás no Tubing; 3) 
Propagação do gás seguido da cessão de injeção e novo enchimento do Anular; 
4) Retomada do enchimento do Anular. ............................................................... 16 
Figura 2.5: Ilustração do comportamento das fases gás (em azul) e da fase 
líquida (em cinza) das etapas do Mecanismo de Onda de Densidade: 1) Fluxo 
mínimo; 2) Fluxo crescente; 3) Fluxo máximo com aumento da densidade do 
meio; 4) Diminuição do fluxo até o mínimo e reinício do ciclo. ............................. 17 
Figura 2.6: Ilustração do comportamento das fases gás (em azul) e da fase 
líquida (em cinza) das etapas do mecanismo de Golfada por Acidente na 
produção de óleo: 1) Acúmulo de óleo no acidente seguido de compressão de gás 
à montante; 2) Impulsão do líquido; 3) propagação da onda de gás; e 4) Retorno 
de óleo (Holdup) com novo acúmulo na inflexão de óleo e retomada do ciclo 
(baseado em Jahanshahi,2013). .......................................................................... 18 
Figura 2.7: Monitoramento da produção de óleo através da pressão dinâmica das 
etapas do Mecanismo de Cabeceio Anular: 1) Enchimento do Anular; 2) Injeção 
de gás no Tubing; 3) Propagação do gás seguido da cessão de injeção; 4) 
Retomada do enchimento do Anular (baseado em Hu, 2004).............................. 20 
Figura 2.8: Monitoramento da produção de óleo através da pressão dinâmica das 
etapas do Mecanismo de Onda de Densidade: 1) Fluxo mínimo; 2) Fluxo 
crescente; 3) Fluxo máximo com aumento da densidade do meio; 4) Diminuição 
do fluxo até o mínimo e reinício do ciclo(baseado em Hu, 2004). ........................ 21 
Figura 2.9: Monitoramento da produção de óleo através da pressão dinâmica das 
etapas do mecanismo de Golfada por Acidente na produção de óleo: 1) Acúmulo 
de óleo no acidente seguido de compressão de gás à montante; 2) Impulsão do 
líquido; 3) propagação da onda de gás; e 4) Retorno de óleo (Holdup) com novo 
acúmulo na inflexão de óleo e retomada do ciclo (baseado em Jahanshahi, 2013).
 ............................................................................................................................. 21 
Figura 2.10: Diagrama de Bifurcação Hipotético (baseado em Jahanshahi, 2013).
 ............................................................................................................................. 22 
Figura 2.11: Representação do sistema modelado para a região do Poço 
propostos por: A. Aamo et al.(2005), Eikrem et al.(2008), Jahanshahi et al.(2012) 
e Hussein et al.(2015); e B. Shao et al.(2016). (Baseado em Aamo et al., 2005, e 
Shao et al., 2016) ................................................................................................. 28 
Figura 2.12: Representação do sistema modelado para a região do Pipeline-Riser 
propostos por: A. Storkaas et al.(2003), Siverstsen et al. (2010) e Jahanshahi et 
al.(2011); e B. Di Meglio et al.(2009). (Baseados em Siverstsen et al., 2010, e 
Di Meglio et al., 2009) .......................................................................................... 29 
Figura 2.13: Representação do sistema propostos por: A. Jahanshahi (2013); e B. 
Necessidades do modelo a ser desenvolvido. (Baseados Jahanshahi, 2013) ..... 30 



X 

 

Figura 2.14: Pontos Ótimos de Desempenho de um Poço (baseado em Hu, 2004)
 ............................................................................................................................. 33 
Figura 2.15: Dinâmica da produção de petróleo em relação à abertura da choque 
(baseada em Di Meglio et al.,2009). ..................................................................... 34 
Figura 2.16: Candidatas à CVs e MVs e identificação de distúrbios (DVs)  
propostas por Jahanshahi (2013), para A. um sistema Anular-Tubing; e B. um 
sistema Tubing-Pipeline-Riser. (Baseado em Jahanshahi, 2013) ........................ 37 
Figura 2.17: Estruturas de Controle Linear;  A. Controle de Pressão de Fundo 
para Cabeceio Anular e Onda de Densidade pela manipulação da choke; B. 
Controle de pressão de fundo para Golfada por Acidente pela manipulação da 
choke; C. Controle aliado a Analisadores Virtuais pela manipulação da choke; e D. 
Controle de Pressão de Fundo pela manipulação da choke de Gas-Lift (KRIMA; 
CAO; LAO, 2012). (Baseados em Aamo et al., 2005, Di Meglio et al., 2012, Krima 
et al., 2012, Jahanshahi, 2013) ............................................................................ 39 
Apesar de não recomendada pelos estudos de controlabilidade de Jahanshahi 
(2013), a choke de Gas-lift ainda é uma candidata para atuação do controle de 
pressão, como a representada na Figura 2.17.D. Fazendo o uso desta variável 
manipulada Krima et al. (2012) aplicaram uma estratégia monovariável PI de 
supressão de golfadas com baixa amplitude. ....................................................... 40 
Figura 2.18: A. Válvula Choke. B. Atuador do tipo Engrenagem (MASTERFLO, 
2011). ................................................................................................................... 42 
Figura 3.1: Representação do Novo Modelo Simplificado de Produção por GL de 
um sistema Reservatório-Poço-Linha de Produção em sistemas offshore. 
(Reservatório – Preto; Poço – Verde; e Linha de Produção – Azul). .................... 47 
Figura 3.2: (A) Perfil de vazão de Válvulas Venturi para diferentes pressões de 
entrada, em um sistema de elevação de petróleo. (B) Ajuste da equação do 
modelo simplificado (Wiv1) e da nova proposta (Wiv2) ao perfil de pressão de 
entrada igual a 280 kgf/cm². ................................................................................. 54 
Figura 3.3: Diferença de comportamento entre a função original f1 e a 
descontinuidade gerada em diff(f1) e a nova equação proposta f2 com a 
suavização do comportamento da derivada diff(f2). .............................................. 55 
Figura 3.4: Convexidade da função objetivo ??? : A. em relação a microrregião 
2D de ???????; e B: a macro região 3D de ??????? e ??. ................................... 57 
Figura 3.5: Convexidade, frente aos parâmetros ??????? e ??, dos componentes 
da função objetivo (A) para ???, (B) para penalização ?; e (E) da nova proposta 
?(??). .................................................................................................................... 58 
Figura 3.5: Método de estimação de parâmetros. ............................................... 60 
Figura 4.1: Identificação da transição de estabilidade típica de poço de GL para 
uma variação de: A. e B. ?? ; C. e D. ???. .......................................................... 64 
Figura 4.2: Influência da ck na localização do par de polos complexos avaliados 
no estacionário para o modelo simplificado. ......................................................... 65 
Figura 4.3: Identificação dos pontos de análise ao longo da dinâmica para um 
poço de GL com mudança de ck. ......................................................................... 66 
Figura 4.4: Localização dinâmica dos pólos e zeros do sistema ao longo da 
transição de operação. ......................................................................................... 68 
Figura 4.5: Algoritmo LLT (baseado em DURAISKI et al., 2002). ........................ 69 
Figura 4.6: Pontos de predição baseados na série de Fibonacci, com diferentes 
taxas de amostragem, com identificação de ?? e ??. ............................................ 71 
Figura 4.7: Estimação de estados com o filtro de Kalman estendido, para 
retroalimentação do Sistema de Controle. ........................................................... 74 



XI 

Figura 4.8: Estratégia de controle NMPC de PDG pela manipulação da ?? e da 
??? (MISO), com retroalimentação pelo Filtro de Kalman Estendido (EKF). ...... 75 
Figura 5.1: Batimetria do Poço A. ........................................................................ 78 
Figura 5.2: Análise monovariável da dinâmica do sistema de golfada para, 
reproduzidas em OLGA, para o poço A, A. para variação de ??? com ?? igual a 
18 % e B. ?? com ??? fixo e igual a 8x104 Sm³/d. .............................................. 79 
Figura 5.3: Resposta do Ajuste dos parâmetros para ?? igual a 18% e ??? 
8x104Sm³/dia, (A) para ??? e (B) para a função objetivo proposta. .................... 80 
Figura 5.4: Extrapolação do novo modelo simplificado para diferentes pontos de 
operação para o intervalo de (A) ?? de 18% e (B) ??? de 8x104 Sm³/dia. .......... 81 
Figura 5.5: Identificação do ponto de bifurcação (Hopf) através do diagrama de 
bifurcação para os dados de referência do OLGA e a predição do modelo para 
??? de 8x104 Sm³/dia. ......................................................................................... 82 
Figura 5.6: Regiões de operação utilizadas na análise de identificabilidade para 
A. uma variação de ?? e B. uma variação de alimentação de ???. .................... 83 
Figura 5.7: Parâmetros de Ajuste do Controlador. .............................................. 85 
Figura 5.8: Estratégia de controle linear monovariável de ???? com ?? , utilizando 
algoritmo PID paralelo, com Bias e Antiwindup. ................................................... 88 
Figura 5.9: Desempenho servo dos controladores lineares (PID e PI) para 
controle de ???? pela manipulação da ?? , . ....................................................... 89 
Figura 5.10: Desempenho servo do controlador linear com a dinâmica na válvula 
PIdin para controle de ???? pela manipulação da ??. ......................................... 90 
Figura 5.11: Desempenho servo dos controladores lineares (PID, PI e PIdin) para 
controle de ???? pela manipulação da ??. .......................................................... 91 
Figura 5.12: Desempenho servo do controlador não linear NMPC e do linear com 
a dinâmica na válvula PIdin para controle de ???? pela manipulação da ??. ....... 93 
Figura 5.13: Diferença de ganho da ?? entre o PIdin e o NMPC para controle de 
????. .................................................................................................................... 93 
Figura 5.14: Desempenho servo do controlador não linear NMPC em uma 
estrutura SISO e uma estrutura MISO para controle de ???? pela manipulação da 
??. ........................................................................................................................ 95 
Figura 5.15: Diferença de ganho de ?? entre o NMPCMISO e o NMPCSISO para 
controle de ????. ................................................................................................. 95 
Figura 5.16: Diagrama de bifurcação do Poço A, identificando o ganho dos 
valores médios (azul) e teóricos no estado estacionário (vermelho) da ???? e da 
Produção de Óleo (admensionalizada) perante as entradas ?? e ??? de 6x104 (A), 
8x104 (B) e 10x104 (C) Sm³/d................................................................................ 98 
Figura 5.17: Transição do ponto de operação médio dos controladores PIdin e 
NMPC’s (pontos) para um SP de 199,49x105 Pa , com ampliação da região 
indicando o desvio padrão.................................................................................... 98 
Figura 5.18: Diagrama de Bifurcação de ???? e Produção de Óleo para a ?? para 
os controladores PIdin e NMPC’s, com a identificação do ponto de bifurcação (Bif.) 
para cada controlador. ......................................................................................... 99 
Figura 5.19: Resumo e quantificação dos principais objetivos da implementação 
de controle em sistemas golfantes. .................................................................... 101 
Figura 5.20: Resumo e quantificação das características dos controladores 
visando a aplicação real, salientando as vantagens do controlador multivariável.
 ........................................................................................................................... 102 
Figura 5.21: Fluxograma da sistemática de construção do método de controle de 
poços através de controlador não linear baseado em modelo. .......................... 103 
Figura 5.22: Predição do modelo simplificado ajustado a um poço real através do 
método proposta. ............................................................................................... 104 



XII 

 

Figura A.1: Métodos de Controle Passivo de Golfada por: A. Relação L/D 
(SHEMER, 2003) ; B. Condicionador em Onda (XING et al., 2013); C. Slug 
Catcher tipo Manifold (JARI et al., 2015); e D. Desemulsificante (HANAPI; 
ARIFFIN; WAN, 2006). ....................................................................................... 119 
Figura C.1: A. Ciclo da golfada normalizado pelo desvio padrão, para o poço A 
com 18 % de abertura de ?? e 1x105 Sm³/d de gás de elevação; B. Distribuição 
dos valores do ciclo comparado ao comportamento normal............................... 124 
 

 

  



XIII 

LISTA DE TABELAS 

 

Tabela 2.1: Comparação entre modelo simplificados de sistema de Gas-Lift. ..... 31 
Tabela 2.2: Comparação entre as técnicas de Controle de Golfadas. ................. 44 
Tabela 3.1: Modelos existentes aderentes às novas necessidades. .................... 46 
Tabela 3.2: Resumo das Constantes e dos Parâmetros do Modelo Simplificado. 56 
Tabela 4.1: Evolução da Localização dos polos complexos conforme ??. ........... 65 
Tabela 4.2: Efeito da trajetória na localização dos polos e zeros do sistema GL. 68 
Tabela 5.1:  Parâmetros Poço A .......................................................................... 78 
Tabela 5.2: Parâmetros Estimados para o Poço A ............................................... 80 
Tabela 5.3: Ranking de Importância dos parâmetros de estimação do modelo, 
baseado na identificabilidade, para diferentes regiões de operação. ................... 84 
Tabela 5.4: Parâmetros  do NMPC, em minutos. ................................................. 85 
Tabela 5.5: Parâmetros de ajuste dos PID’s. ....................................................... 89 
Tabela 5.6: Desempenho e robustez servo dos controladores lineares (PID, PI e 

PIdin) para controle de ???? pela manipulação da ??. ........................................ 91 
Tabela 5.7: Desempenho e robustez servo dos controladores não lineares e PIdin, 
para controle de ???? pela manipulação da ??. ................................................. 96 
Tabela 5.8: Comparação entre o esforço das ações de controle, ao longo da troca 
de SP, para os controladores linear (PIdin) e não lineares (NMPCSISO e NMPCMISO).
 ........................................................................................................................... 100 
Tabela 5.9: Produção de óleo teórica para a malha aberta e para as malhas 
fechadas dos controladores linear (PIdin) e não lineares (NMPCSISO e NMPCMISO), 
ao longo da troca de SP. .................................................................................... 101 

Tabela C.1: Valores de ????, em Pax105, no estado estacionário, utilizado como 
referência dos SP’s para diferentes pontos de operação ................................... 127 

 

  



XIV 

 

 



XV 

NOTAÇÃO E SIMBOLOGIA 

 

? Área da seção transversal do Riser 

ANM Árvore de Natal Molhada 

??? 
Matriz dos estados do modelo na representação em espaço de 

estado 

Bpd Barris de Petróleo por Dia 

??? 
Matriz das medidas do modelo na representação em espaço de 

estado 

?? Abertura da choke de produção 

CV Variável Controlada 

? Diâmetro do Anular 

?? Diâmetro do Pipeline/Riser 

?? Diâmetro do Tubing 

? Fração de gás que by-passa pela “válvula virtual” 

EA’s Equações Algébricas 

EDO’s Equações Diferenciais Ordinárias 

EDP’s Equações Diferenciais Parciais 

EKF Extended Kalman Filter 

E&amp;amp;P Extração e Produção de Petróleo 

F Fluxo de produção 

FOWM Fast Offshore Well Model   

FPSO Floating Production Storage and Offloading 

g Aceleração gravitacional; 

GL Gas-lift 

h Altura do Riser 

???? Distância do leito do mar até o medidor de pressão no Tubing 

?? Comprimento do Tubing 

???? 
Distância do leito do mar até o ponto de injeção de gás de elevação 

no Tubing 

? Matriz Identidade 

?? Índice de impacto do parâmetro “j” 

JLLT Função objetivo do algoritmo LLT 

?? Coeficientes de fluxo da válvula de injeção 

?? Constante proporcional de controle 



XVI 

 

?? Constante da válvula virtual 

???? Coeficientes de fluxo da válvula da produção 

?? Constante de Produção do Reservatório 

?? Constante da válvula venturi 

?? Coeficientes de fluxo da válvula da ANM 

l Comprimento do pipeline antes do Riser 

L Comprimento depois do ponto de inflexão 

?? Comprimento do Anular 

?? Comprimento do Tubing 

LLT 
Algoritmo de Linearização ao longo da trajetória, ou Local 

Linearization on the Trajectory 

LQP Problema Linear Quadrático 

Mm Massa molar do gás de elevação 

M Horizonte de controle do algoritmo LLT 

??? Massa de gás no Anular 

??? Massa de gás acumulada na bolha à montante da “válvula virtual”, 

??? Massa de gás no Riser 

??? Massa de gás no Tubing 

??? Massa de líquido no Riser 

??????? Acúmulo mínimo de massa de líquido a montante da inflexão 

??? Massa de líquido no Tubing 

MIMO Multiple Input Multiple Output 

MISO Multiple Input Single Output 

MP Máxima Produção de Óleo 

MPC Model Predictive Control 

MRF Máximo Retorno Financeiro 

MSDE Erro Mínimo do Quadrado da Derivada 

MSE Erro Mínimo Quadrado ou Mínimos Quadrados 

MSPE Erro Mínimo do Quadrado do Período 

MV Variável manipulada 

? Filtro da ação derivativa 

NMPC Non Linear Model Predictive Control 

NSRGA Non Square Relative Gain Array 

P Horizonte de Predição 



XVII 

??? Pressão no ponto de injeção de gas de elevação no Anular 

PATM Pressão atmosférica 

??? Pressão no fundo do Poço 

??? Pressão da bolha à montante do ponto de inflexão 

?? Transição de covariância dos estados 

Pin, ??, ?? Pressão de entrada e saída 

???? Pressão em PDG 

Ptr Pressão no Topo do Riser 

 Pr Pressão no Reservatório 

??? Pressão à jusante da válvula virtual 

??? Pressão no topo do Riser 

Ps Pressão no Separador 

??? Pressão no ponto de injeção de gás de elevação no Tubing 

??? Pressão na ANM (topo do Tubing) 

???? Pressão no Topo do Riser 

PDG Permanent Downhole Gauge 

PI Controlador Proporcional Integral 

PIB Produto Interno Bruto 

PID Controlador Proporcional Integral Derivativo 

PTop Pressão de Topo do Riser 

PV Variável de Processo 

?? Covariância dos estados 

R Constante universal dos gases 

?? Covariância das variáveis medidas 

S Matriz de sensibilidade 

Sescal Matriz de sensibilidade escalonada 

SISO Single Input Single Output 

SP Setpoint 

SPD Semi Plano Direito 

t Tempo 

T Temperatura do sistema 

TA Taxa de Amostragem do controlador 

?? Taxa de atualização 

?? Período do ciclo 

?? Constante do tempo derivativo de controle 

?? Constante do tempo integral de controle 

TPT Temperature and Pressure Transdutor 



XVIII 

 

?? Tempo de subida 

??? 
Fluxo de massa de gás saindo através da válvula de injeção no 

Anular 

???? 
Fluxo de massa de gás saindo através da válvula de injeção no 

Anular, para a válvula venturi 

?? Fluxo mássico de gás através da válvula virtual; 

??? 
Fluxo de massa de gás entrando através da válvula de injeção no 

Anular 

???? Fluxo de produção através da choke de produção 

?? Fluxo de produção do reservatório 

??? Fluxo mássico de produção através da ANM. 

UGS Velocidade superficial do gás 

UKF Unscented Kalman Filter 

U Ação de Controle 

?? Ação de controle na posição anterior 

Ul Velocidade superficial de líquido 

Ut Velocidade da bolha 

?? Volume do Anular 

??? Volume da bolha acumulado à montante da válvula virtual 

??? Volume do gás no Tubing 

?? Volume do Riser 

VPM Valor Presente Máximo 

?? Volume do Tubing 

X Valor de referência medido 

y Valor simulado 

??? Fração de gás presente no Pipeline-Riser. 

??? Fração de gás presente no Riser 

??? Fração de gás no Tubing 

??? Fração de gás no reservatório 

?P Variação de Pressão 

?t Variação de Tempo 

?y Variação do sinal de saída 

??? Variação do parâmetro de ajuste 

?? Variação de ação de controle 



XIX 

? Razão entre o volume de líquido em relação ao volume de gás 

?’ Fração de vazio ocupada pela bolha que adentra o Riser 

j? Componente imaginário dos polos do sistema 

? Ângulo de Inclinação do ponto de inflexão do Pipeline-Riser 

?? Parâmetros de estimação 

??? Massa específica do gás no Anular 

?L Massa específica do óleo produzido 

????? Massa específica da mistura no reservatório 

??? Massa específica do óleo no Tubing 

? Termo real dos polos do sistema  

? Peso do Erro do setpoint 

? Supressão de movimento da ação de controle  

? Penalidade da função objetivo 

?(?) Erro dos estados na formulação do EKF 

?(?) Erro das variáveis medidas na formulação do EKF 

  

  

  

  

 



XX 

 

  



XXI 

 

SUMÁRIO 

 

 Introdução ................................................................................... 1 

1.1 Produção de Petróleo ............................................................................................ 2 
1.2 Estabilização e Aumento de Produção Atual ..................................................... 3 
1.3 Controle Automático de Golfadas ........................................................................ 5 
1.4 Atenuação de Golfadas Através de uma Estratégia de Controle Preditivo 
Não Linear ....................................................................................................................... 6 
1.5 Estrutura do Trabalho ............................................................................................ 7 

 Sistemas de Produção de Petróleo por Gas-lift ...................... 9 

2.1 Reservatório de Petróleo ....................................................................................... 9 
2.2 Técnica de Elevação por Gas-lift ....................................................................... 11 

2.2.1 Produção Multifásica ..................................................................................................13 
2.2.2 Golfadas em Sistemas de Gas-lift ............................................................................15 
2.2.3 Produção Golfante ......................................................................................................19 

2.3 Modelagem de Sistemas Gas-lift ....................................................................... 22 
2.3.1 Modelos Simplificados para Sistemas de Gas-lift ..................................................25 

2.4 Controle de Produção em Sistema de Gas-lift ................................................ 32 
2.4.1 Controle Ativo de Golfadas........................................................................................35 

 Modelo Simplificado ................................................................ 45 

3.1 Modelo Simplificado de Produção por GL ........................................................ 45 
3.1.1 Alternativa Modelo ......................................................................................................53 

3.2 Estimação de Parâmetros ................................................................................... 55 
3.2.1 Não Convexidade do Objetivo ..................................................................................57 
3.2.2 Método de Ajuste ........................................................................................................59 

 Estratégia de Controle Preditivo Não Linear – NMPC ........... 63 

4.1 Dinâmica do Sistema de Gas-lift ........................................................................ 63 
4.2 Algoritmo de Controle LLT .................................................................................. 69 

4.2.1 Ajuste do Controlador .................................................................................................70 
4.2.2 Estratégia de Retroalimentação ...............................................................................72 

4.3 Estratégia de Controle ......................................................................................... 74 

 Implementação do Controle Preditivo Não Linear ................ 77 

5.1 Ajuste do Modelo .................................................................................................. 77 
5.1.1 Estimação de Parâmetros .........................................................................................79 
5.1.2 Validação do Ajuste ....................................................................................................81 
5.1.3 Identificabilidade do Parâmetros ..............................................................................82 

5.2 Ajuste do Controlador NMPC ............................................................................. 85 
5.2.1 Ajuste do Filtro de Kalman ........................................................................................86 

5.3 Controle Linear VS Não Linear .......................................................................... 86 
5.3.1 Critérios de Desempenho e Robustez e Ganho ....................................................86 
5.3.2 Controlador Linear ......................................................................................................87 
5.3.1 Limitação de Desempenho pela Dinâmica da MV .................................................89 
5.3.2 Desempenho do Controlador Linear ........................................................................90 
5.3.3 Controlador NMPC SISO ...........................................................................................92 

5.4 Estratégias MISO.................................................................................................. 94 
5.4.1 Desempenho do Controlador Não Linear ...............................................................95 

5.5 Aumento Teórico da Produção ........................................................................... 97 
5.6 Resumo Comparativo dos Controladores ...................................................... 101 



XXII 

 

5.7 Aplicação do Método em um Sistema Real .................................................... 102 
5.7.1 Estimação de um Sistema Real ............................................................................. 104 

 Conclusões e Trabalhos futuros .......................................... 105 

6.1 Conclusões da Modelagem ............................................................................... 105 
6.2 Conclusões do Controle ..................................................................................... 106 
6.3 Próximos Passos ................................................................................................. 107 
6.4 Sugestões para Trabalhos Futuros .................................................................. 107 

Referências ....................................................................................................... 109 

Apêndice A – Controle Passivo de Golfadas .............................................. 117 

Apêndice B – Implementação do Modelo Simplificado ............................. 121 

S-function ...................................................................................................................... 121 

Apêndice C – Construção do Diagrama de Bifurcação ............................. 123 

Diagrama de Bifurcação em Sistemas de GL ........................................................ 123 
Média, Amplitude e Ponto Hopf ................................................................................ 124 
Cálculo do Estacionário.............................................................................................. 125 

 
 



 

1 

  Introdução 

A crescente tendência do consumo energético e da produção de bens de 

consumo derivados do “ouro negro” faz com que a cadeia produtiva do Petróleo 

atraia vultuosos recursos financeiros de investimento e renovação. Nos últimos 

anos, o setor vem sendo uma parcela fundamental no crescimento do PIB 

nacional, chegando a representar 13 % da riqueza brasileira em 2014 (BRASIL, 

2014).  

O setor de Upstream ou Exploração e Produção de Petróleo (E&amp;amp;P) 

contribuiu significativamente para essa parcela uma vez que é o carro-chefe deste 

setor industrial. Mundialmente, em 2015, a produção média total de petróleo foi de 

99 milhões de barris por dia (bpd), sendo 6,3% produzidos no Brasil. Pequenos 

incrementos na produção podem resultar em um retorno financeiro substancial.  

Neste sentido, nas últimas décadas, muito se tem investido em Exploração 

e Perfuração de novos campos de produção. Em 2006, a partir de uma busca por 

petróleo na Bacia de Santos, foi descoberta um gigantesco acúmulo de gás e 

condensado de petróleo offshore. No mesmo ano, também na Bacia de Santos, 

foi descoberta o reservatório Tupi, precursor do pré-sal, impactando fortemente no 

cenário nacional do setor petrolífero.  

O fomento às descobertas exploratórias cresceu a partir daí e a produção 

de petróleo chegou à marca de 2,128 milhões bpd em 2015. A produção de 

petróleo, operada na camada pré-sal, alcançou um terço da produção total 

nacional, em 2015, e já ultrapassou metade em 2017 (PETROBRAS, 2016, 2017). 



2  Introdução 

 

Estimativas mais otimistas apontam que o setor de produção de petróleo poderá 

representar 20 % do PIB em 2020 (RITTER, 2015). 

Entretanto, a partir de 2014, o comportamento dos preços sofreu uma 

súbita mudança que vai de encontro a este pensamento otimista. O desequilíbrio 

entre oferta e demanda no mercado internacional e nos fluxos de comercialização 

contribuíram para a queda dos preços do petróleo. Isso favorece produções com 

menor custo agregado, como na Líbia e Iraque, e o mercado de produção não 

convencional, como nos EUA, aumentando a concorrência aos processos com 

alto valor agregado de poços profundos e ultra profundos, como o do Brasil.  

Apesar das tentativas políticas de estabilização e recuperação do setor 

através da manutenção de preços dos derivados no mercado interno, 

principalmente dos combustíveis, a evolução está aquém da expectativa. Novas 

descobertas não conseguem equilibrar as leis de oferta e demanda e a produção 

ainda é economicamente ineficiente para afetar o seu valor de mercado (ANP, 

2015). 

Para tornar sistemas profundos competitivos, faz-se necessário o maior 

entendimento do processo produtivo como um todo para que só assim se 

desenvolvam novos métodos para aumento de eficiência da produção de 

petróleo.  

1.1 Produção de Petróleo 

A degradação natural dos reservatórios em operação e a batimetria 

singular da produção nacional dificultam a elevação de óleo. Para viabilizar o 

processo de extração é necessária a implantação de técnicas artificiais de 

elevação que agregam custo de produção à commoditie.  

Dentre as técnicas artificiais de elevação destaca-se o Gas-lift (GL), que 

consiste em injetar gás natural à alta pressão na base da coluna de produção. Isto 

afeta a massa específica do meio diminuindo a pressão hidrostática da mistura, o 

que facilita e aumenta a vazão de óleo proveniente do reservatório. 

Por um lado o GL ganha vantagem frente às demais técnicas de elevação 

por ser tecnicamente viável na maioria dos cenários de extração onshore e 



1.1  3 

offshore; poços rasos, profundos e ultra profundos; com óleos leves, pesados e 

arenosos; etc. Por este motivo a técnica é aplicada em mais de 70 % da produção 

brasileira (FILHO, 2011). Por outro lado, esta técnica traz o ônus de amplificar a 

problemática do escoamento multifásico gás/líquido, que dependendo das 

condições de operação, leva ao regime chamado de golfadas (ou slugging).  

O comportamento golfante é caracterizado pelo fluxo intermitente de líquido 

seguido de ondas de gás, que é decorrente de diferentes mecanismos 

hidrodinâmicos intrínsecos ao GL. Esta dinâmica é caracterizada como um ciclo 

limite estável, que pode produzir grandes oscilações de pressão no sistema a 

ponto de inviabilizar operacionalmente o processo, afetando a vida útil das 

instalações, a segurança da unidade operacional e a produção (GUO; LYONS; 

GHALAMBOR, 2007a). 

Visto a importância econômica não só nacional, mas também mundial, é de 

extremo interesse evitar a dinâmica intermitente característica da produção de 

petróleo por GL. A problemática exposta acima referente aos novos desafios de 

mercado e às insipientes rotinas operacionais, fortalece a ideia de que a cada dia 

torna-se mais importante que os recursos um dia investidos na E&amp;amp;P sejam 

redirecionados para o segmento de Produção e Elevação de Petróleo.  

1.2 Estabilização e Aumento de Produção Atual 

O comportamento da produção de petróleo de sistemas do tipo GL tem 

sido estudado por diversos autores (CAMPONOGARA et al., 2010; DI MEGLIO, 

FLORENT et al., 2012; HU, 2004). Como mostrado por DI MEGLIO et al.(2012) e 

CAMPONOGARA et al.(2010), a produção de petróleo possui uma dinâmica não-

linear com dois padrões de comportamento: estável e golfante. Como ilustrado na 

Figura 1.1, a transição dessas regiões é dependente da abertura da válvula de 

produção, também chamada de choke, e do fluxo de gás injetado.  

As golfadas ocorrem com elevadas aberturas de choke e baixa injeção de 

gás de elevação influenciando negativamente na produção média do sistema 

(Prod. Malha Aberta indicada na Figura 1.1). Em relação à produção equivalente 

ao estado estacionário do sistema (Prod. Estacionário indicada na Figura 1.1) há 

um potencial ganho/perda de produção (área hachurada da Figura 1.1), que 

encoraja a busca por soluções operacionais que explorem este potencial, 

aumentando a eficiência do processo.  



4  Introdução 

 

 

Figura 1.1: Curva Hipotética de Produção de Petróleo em relação à variáveis de 

entrada de processo (Baseado em HU, 2004, DI MEGLIO et al.,2012 e 

CAMPONOGARA et al.,2010). 

Na atualidade, ações manuais neste sentido já são realizadas. A 

manipulação do fornecimento de gás de elevação conduz o sistema para um 

escoamento livre das golfadas e de maior produção. Entretanto, por questões de 

projeto e maturidade dos poços, não é possível atingir o ótimo em termos de 

produção. Além disso, devido à quantidade de poços, que podem chegar até onze 

em uma mesma plataforma de produção, pode afetar a alocação ótima de gás 

entre os diferentes poços (DE SOUZA et al., 2010; HU, 2004).  

A utilização da válvula choke é a solução mais empregada de supressão 

das golfadas, uma vez que não tem custo agregado. É prática comum a atuação 

manual da choke (dita Malha Aberta) por conhecimento empírico e intuição das 

equipes de operação. Contudo, além da limitação física intrínseca de válvulas 

(aberturas de 0 a 100%), a ação de fechamento implica no retorno à região de 

baixa produção. Ainda, a possibilidade de ocorrência de distúrbios desconhecidos 

de processo que podem afetar o sistema no momento da manobra e pôr em risco 

a segurança do processo. 

Como uma terceira prática, há a possibilidade de quebra de emulsão 

água/óleo com a consequente diminuição da viscosidade da mistura multifásica 

através da adição de desemulsificante. Esta ação em associação ao GL é uma 

alternativa que aumenta da taxa de recuperação dos reservatórios e a eficiência 



1.3 Controle Automático de Golfadas 5 

do processo (ALSHEHRI; RICARDEZ-SANDOVAL; ELKAMEL, 2010; NGUYEN; 

SADEGHI; HOUSTON, 2012).  

Apesar das vantagens aparentes, esta abordagem necessita de um 

footprint da unidade de operação e a instalação de um sistema dedicado à injeção 

de desemulsificante agregando custos ao processo de produção. Além disso, 

assim como para a alternativa de aumento de injeção de gás de elevação, o 

processo recai num problema de alocação de recursos, uma vez que o 

suprimento de desemulsificante é limitado pelas instalações e preços de contratos 

de fornecimento. 

Frente ao cenário econômico, as rotinas atuais de aumento e controle de 

produção já não são suficientes para um processo eficiente. Assim, os avanços 

tecnológicos em Controle e Automação Industrial permite uma nova abordagem 

para o aumento da produtividade em processos industriais. 

1.3 Controle Automático de Golfadas 

A utilização de controle ativo (dito Malha Fechada) alia a otimização da 

produção a um baixo custo de implementação (ÅSTRÖM; HÄGGLUND, 2001). É 

possível aliar a estabilidade e segurança operacional, pelo controle do regime de 

escoamento, com o aumento de produção com o menor investimento possível.  

Esta alternativa, através de estudos já realizados por SIVERTSEN et al. 

(2010), DI MEGLIO et al. (2012) e JAHANSHAHI et al. (2014), mostrou-se 

promissora para uma aplicação real de controladores clássicos e estruturas 

avançadas. Através da manipulação ativa das variáveis de processo disponíveis o 

uso de controladores Proporcional Integral Derivativo (PID) em diferentes 

estruturas de controle (feedback, cascata, etc.) foram propostas e testadas.  

Apesar do sucesso experimental, o desempenho real de tais técnicas ditas 

lineares se torna incerto devido à não linearidade, à característica multivariável do 

sistema e às bruscas ações de controle requeridas que podem ultrapassar os 

limites disponíveis. 

Consequentemente, os estudos na área de controle de golfadas estão cada 

vez mais rumando para a utilização de controle não linear baseado em modelo 

(JAHANSHAHI, ESMAEIL; SKOGESTAD, 2013). Ainda para incorporar as 

restrições do sistema e agregar cenários multiváriáveis o uso de controle preditivo 



6  Introdução 

 

baseado em modelos ganha espaço (SALAHSHOOR; ZAKERI; HAGHIGHAT 

SEFAT, 2013).  

Apesar dos esforços, até o momento, as estruturas propostas ainda 

apresentam pontos de melhoria e possuem uma resistência cultural para a 

viabilização e aplicação real. Existe uma dificuldade e incompatibilidade de 

replicação de modelos desenvolvidos até agora para sistemas tipicamente 

brasileiros. Além disso, os algoritmos que utilizam modelos apresentados 

possuem elevado custo computacional, o que é intrínseco ao controle preditivo, 

limitando o uso em tempo real (CODAS; JAHANSHAHI; FOSS, 2016). 

1.4 Atenuação de Golfadas Através de uma Estratégia de 
Controle Preditivo Não Linear 

O principal objetivo deste trabalho consiste na aplicação de um 

controlador preditivo não linear para a atenuação do regime de golfadas e 

aumento de produção em sistemas de elevação de petróleo por GL, visando 

uma posterior aplicação real. 

Para atingir esse objetivo os seguintes objetivos secundários devem ser 

alcançados: 

- construção de um novo modelo caixa cinza que concilia simplicidade e 

acuracidade para representação de sistemas offshore profundos e ultraprofundos, 

tipicamente brasileiros; 

- desenvolvimento de um método de estimação dos parâmetros do modelo 

à dinâmica de sistemas reais 

- apresentar o uso do modelo como ferramenta de estudos não intrusivos 

da dinâmica das golfadas e dos ganhos potenciais da atenuação deste regime; 

- o uso do modelo como uma ferramenta para o estudo de controlabilidade 

e o uso em estruturas NMPC; 

- uma sistemática de ajuste dos parâmetros do controlador, baseado na 

dinâmica dos sistema e no compromisso entre baixo custo computacional e 

representatividade da dinâmica; 



1.5 Estrutura do Trabalho 7 

- comparação entre diferentes possíveis estruturas de controle, visando 

manter um compromisso entre inovação (aplicação de controladores em poços de 

extração) e mudanças de paradigmas das ações atuais (pela constante 

manipulação das entradas e processo) para uma futura aplicação real. 

1.5 Estrutura do Trabalho 

Para o desenvolvimento dos objetivos, o trabalho foi dividido em seis 

capítulo, sendo este primeiro uma introdução ao assunto onde se apresenta a 

motivação econômica e técnica para a construção dos objetivos desta 

dissertação. 

O capítulo 2 compreende a revisão bibliográfica do trabalho, introduzindo o 

processo de produção de petróleo na seção 2.1 e detalhando na seção 2.2 a 

técnica de GL, para futuro desenvolvimento do modelo. Nas seções 2.3 e 2.4 são 

apresentados a modelagem e as técnicas de controle empregadas na produção 

de petróleo desenvolvidos até o momento, respectivamente. Em complemento, no 

Apêndice A - Controle Passivo de Golfadas está apresentado uma revisão das 

técnicas de controle passivo empregadas na produção de petróleo offshore. 

O capítulo 3, o novo modelo simplificado é apresentado, sendo detalhado 

na seção 3.1. O método de estimação de parâmetros e replicação do modelo à 

poços reais é apresentada na seção 3.2. Em complemento, o código no modelo 

implementado em simulink está apresentado no Apêndice B - Implementação do 

Modelo Simplificado.  

O capítulo 4 é apresentado o algoritmo de controle proposto e ao longo 

deste, a estratégia de controle será apresentada baseada no estudo da dinâmica 

de produção, desenvolvido na seção 4.1, a partir do modelo simplificado. Na 

seção 4.2, o algoritmo LLT é detalhado, com uma sistemática de ajuste inicial dos 

parâmetros de controle e de correção de não linearidades provenientes de 

distúrbios. Por fim, na seção 4.3, a estratégia de controle sugerida para aplicação 

do controle não linear é apresentada.  

Em complemento, no Apêndice C - Construção do Diagrama de Bifurcação, 

será apresentado o procedimento de construção do diagrama de bifurcação 

apresentando o método de cálculo dos valores estacionários, médios, máximos e 

mínimos, referência para os estudos de desempenho e robustez dos 

controladores, 



8  Introdução 

 

O capítulo 5 o método apresentado nos capítulos 4 e 5 é aplicada para um 

poço virtual implementado no modelo rigoroso OLGA. Na seção 5.1, o modelo é 

ajustado ao poço e os parâmetros de estimação determinados, seguido de uma 

etapa de validação e extrapolação da dinâmica. Na seção 5.2, a sistemática de 

ajuste proposta é aplicado ao controlador, baseada no modelo estimado. Na 

seção 5.3, o um controlador linear e uma estrutura monovariável do NMPC são 

estressados ao longo de uma variação de setpoints para fins de comparação de 

desempenho. 

Na seção 5.4 a estratégia proposta neste trabalho é aplicada e seu 

desempenho é medido. Por fim, na seção 5.5, os impactos das ações dos 

controladores testados são medidos em termos de produção de petróleo e na 

seção 5.6 é apresentado um resumo comparativo entre os controladores 

estudados frente à potencial aplicação em um sistema real. De forma 

complementar, na seção 5.7 os primeiros passos do método para a implantação 

no sistema real serão mostrados.  

As conclusões do trabalho, estão apresentadas no Capítulo 6, onde a partir 

de uma análise conclusiva do modelo simplificado proposto, na seção 6.1, e da 

estrutura de controle proposta, na seção 6.2, seguido dos próximos passos para 

implementação em um poço real, na seção 6.3. Sugestões para trabalhos futuros 

estão enumeradas na seção 6.4.  

 



 

9 

  Sistemas de Produção de 
Petróleo por Gas-lift 

Este capítulo apresenta a revisão bibliográfica do trabalho sendo que, na 

primeira subseção são introduzidas noções básicas dos reservatórios de petróleo 

e suas unidades de produção offshore. Na seção 2.2, o processo produtivo que 

utiliza a técnica de Gas-lift é detalhado, apresentando os principais parâmetros de 

processo e o impacto da dinâmica multifásica das golfadas na produção. Na 

seção 2.3 e 2.4 serão apresentados os trabalhos desenvolvidos até o momento 

em modelagem e controle, respectivamente, do processo de produção de 

petróleo. 

2.1 Reservatório de Petróleo 

Os reservatórios de petróleo são armadilhas geológicas porosas e 

permeáveis, com características variáveis conforme a sua geolocalização e 

batimetria. Estas formações contêm um acúmulo de hidrocarbonetos num sistema 

de alta pressão isolado por rochas impermeáveis, por barreiras de água em 

sistemas offshore e por camadas de acúmulo salino nos campos do pré-sal. 

Idealmente, o óleo do reservatório é composto de uma mistura de hidrocarboneto 

de composição definida localizado em locais de fácil acesso (GUO; LYONS; 

GHALAMBOR, 2007a).  

Contudo, na realidade o produto é uma mistura multifásica de 

hidrocarbonetos, líquidos e gasosos, água e sedimentos sem composição bem 

definida e variante no tempo (GUO; LYONS; GHALAMBOR, 2007a). 



10  Sistemas de Produção de Petróleo por Gas-lift 

 

Uma vez perfurado o reservatório, o processo de produção é realizado 

através da interligação de múltiplos poços de extração construídos na etapa 

posterior à Exploração e Perfuração. É realizada a montagem de um revestimento 

metálico para cada poço, através da rocha impermeável, conectando o 

reservatório ao leito marítimo (RIBEIRO, CIDO HERNANI PERISSÉ, 2012). 

Em seguida uma tubulação de escoamento e elevação do petróleo do 

reservatório à superfície é introduzida perfurando a rocha permeável liberando o 

reservatório à superfície (RIBEIRO, CIDO HERNANI PERISSÉ, 2012). 

A mistura de hidrocarbonetos, devido à alta pressão de aprisionamento a 

que o poço está submetido no início da sua vida produtiva (dito poço surgente), 

tende naturalmente a escoar para superfície. À medida que a produção flui, ocorre 

uma degradação inerente do reservatório e sua pressão interna cai, inviabilizando 

o processo natural de ascensão do petróleo(GUO; LYONS; GHALAMBOR, 

2007a). 

Neste momento faz-se necessária a aplicação de técnicas artificiais de 

elevação, a fim de injetar energia suficiente no processo para que viabilize 

novamente a operação. Estas técnicas também são utilizadas com o intuito de 

elevar as taxas de recuperação de reservatórios surgentes (GUO; LYONS; 

GHALAMBOR, 2007a). 

Dependendo da pureza das fases envolvidas o desempenho de técnicas 

“clássicas” de elevação de petróleo como o Bombeio Mecânico, o Bombeio por 

Cavidade Progressiva ou Bombeio Centrífugo Submerso diminui a ponto de 

inviabilizar o processo. Além disso, as profundidades às quais os sistemas 

offshore estão submetidos, especialmente os do pré-sal com lâminas d’água de 

até 2 km, dificultam a construção e manutenção da maioria das técnicas de 

elevação mecânicas. 

Diante destas dificuldades o chamado Sistema de Produção por Gas-lift 

(GL), apesar do alto valor agregado pela necessidade de um sistema de 

compressão, atinge a viabilidade econômica para áreas de extração com um 

grande número de poços (LEA; NICKENS; WELLS, 2008; PETROBRAS, 2015). 



2.2 Técnica de Elevação por Gas-lift 11 

Tipicamente, uma unidade de produção que emprega esta técnica consiste 

numa série de poços de extração que interligam o reservatório a uma unidade de 

armazenamento e transferência (Floating Production Storage and Offloading, 

FPSO), como ilustrado na Figura 2.1. Os poços são constituídos de uma 

tubulação metálica (chamado Tubing), que interliga os reservatórios ao leito 

marinho, envolvido por um compartimento anular (chamado Anular) dedicado ao 

envio de gás à coluna de produção através da Válvula de Injeção.  

A entrada de gás e saída de produto para o leito do mar é regulada por 

uma estrutura de válvulas submarinas chamada Árvore de Natal Molhada (ANM). 

A partir desta, também é encaminha a produção para a superfície, junto ao fundo 

do mar por uma tubulação flexível horizontal (chamada Pipeline) e por uma 

tubulação flexível vertical (chamada Riser) (GUO; LYONS; GHALAMBOR, 2007a). 

 

Figura 2.1: Ilustração de uma unidade típica de extração de petróleo por Gas-lift 

(Adaptado de IGUMA E SORRELL, 2015). 

2.2 Técnica de Elevação por Gas-lift 

O Gas-lift é uma técnica de elevação artificial de petróleo dada pela injeção 

contínua de gás natural no Tubing. O gás injetado afeta o sistema de três formas: 

a) “aerando” a mistura oleosa reduzindo a massa específica média do meio, b) a 

energia de expansão do gás ao entrar na coluna, a qual se encontra a uma 

pressão menor, impulsiona o óleo para a superfície; e c) ocasiona um 

deslocamento pistonado de líquido por grandes bolhas de gás.  



12  Sistemas de Produção de Petróleo por Gas-lift 

 

Todos estes mecanismos diminuem a pressão hidrostática da coluna de 

líquido aumentando o diferencial de pressão entre superfície e reservatório. 

Consequentemente, o escoamento ascendente do óleo é facilitado e com isso é 

possível não só aumentar taxas de produção em sistemas surgentes como 

viabilizar a extração em sistemas maduros (GUO; LYONS; GHALAMBOR, 

2007b). 

O suprimento de gás de elevação é proveniente do Módulo de 

Compressão, presente no FPSO, que trabalha a altas pressões (acima de 200 

kgf/cm²). O gás é distribuído para os poços através de um manifold, conforme a 

necessidade individual de cada poço e capacidade dos trens de compressão. A 

regulagem da distribuição é realizada por válvulas tipo choke. Como ilustrado na 

Figura 2.2, o gás escoa através do Anular até um ponto baixo no Tubing, próximo 

ao ponto de perfuração do reservatório. 

 
Figura 2.2: Ilustração simplificada do processo de extração de um poço por GL 

(adaptado de JAHANSHAHI, 2013).  

Ali se localiza a chamada Válvula de Injeção onde ocorre a atuação do gás 

na coluna de produção. Esta é uma válvula de via única, não permitindo refluxo 

de produto para o compartimento de gás, acionada pela diferença de pressão 



2.2 Técnica de Elevação por Gas-lift 13 

entre o Tubing e Anular. Os mecanismos de facilitação de escoamento, descritos 

anteriormente, ocorrem neste momento e o produto escoa ascendentemente para 

a ANM, Pipeline e Riser, consequentemente, até a válvula choke de produção 

(GUO; LYONS; GHALAMBOR, 2007a).  

Na superfície, junto à jusante da choke de produção, ocorre uma primeira 

equalização do produto no manifold de produção que encaminha a mistura 

multifásica para os Módulos de Processo/Separação junto à FPSO.  

A partir daí, as correntes segregadas são devidamente encaminhadas: a 

água é tratada e reinjetada no reservatório ou descartada ao mar; o óleo é 

encaminhado para armazenamento e posterior exportação; e o gás é encaminha 

para os Módulos de Compressão (GUO; LYONS; GHALAMBOR, 2007a). 

2.2.1 Produção Multifásica 

Uma vez que o produto é uma mistura multifásica de água, gás, óleo e 

areia, seu comportamento depende da natureza hidrodinâmica das fases 

envolvidas e da geometria do sistema (SIVERTSEN; STORKAAS; SKOGESTAD, 

2010). Em outras palavras, o padrão de escoamento depende das velocidades 

superficiais de líquido e gás e do sentido e inclinação do fluxo (horizontal ou 

vertical) e pode influenciar de forma drástica a operação do processo produtivo. 

Pensado nisso, a partir da década de 60, esforços foram direcionados à 

identificação e modelagem dos diversos tipos de regimes de escoamento. 

Harmathy (1960) estudou as relações entre as velocidades de escoamento 

bifásico e equacionou a formação de bolhas em estruturas cilíndricas com 

diferentes componentes.  

Mais tarde, Yemada e Duckler (1976) a partir de dados experimentais 

propuseram um mapa genérico de regimes para fluxos bifásicos em sistemas 

horizontais identificando a transição de cinco regimes básicos: Estratificado, 

Estratificado Ondulado, Golfada (Severa), Anular e Bolha Dispersa.  

Estendendo a questão para o setor de produção offshore, Taitel e Yehuda 

(1986) validou e mapeou experimentalmente a ocorrência destes regimes para 

um sistema água-óleo em um sistema horizontal, ilustrados na Figura 2.3.A.  

Posteriormente, o mapa foi validado para sistemas verticais ascendentes, 

como para ar-óleo por Stanislav et al.(1986). Neste trabalho, na Figura 2.3.B, 



14  Sistemas de Produção de Petróleo por Gas-lift 

 

assim como no anterior são identificados os fluxos intermitentes com os diferentes 

regimes de escoamento já identificados por Yemada e Duckler (1976), como a 

problemática Golfada Severa.  

A. B. 

 

Figura 2.3: Ilustração do mapa de padrão de escoamento em escoamento: A. 

horizontal; e B. vertical  (STANISLAV; KOKAL; NICHOLSON, 1986; TAITEL, 

YEHUDA, 1986). 

Com o intuito de prever a ocorrência do fluxo intermitente, Taitel et 

al.(1990) propuseram um critério para ocorrência das golfadas. Baseado numa 

estrutura de Riser com fluxos constantes de entrada de líquido e gás, 

correlacionando a energia disponível no sistema (?) e a contrapressão exercida 

no Riser (Ps), os autores chegaram a seguinte expressão: 

 
P?

PATM
&gt;

??l+L

??
??

?0
??????

 (2.1) 

onde PATM é a pressão atmosférica; ?L é a massa específica do líquido (água e 

óleo); ? é a razão entre o volume de líquido em relação ao volume de gás, 

baseado em dados do separador; ?’ é a fração de vazio ocupada pela bolha que 

adentra o Riser, assumida como constante e igual a 0,9 em qualquer sistema 

vertical; l é o comprimento do pipeline antes do Riser; h é a altura do Riser, L é o 

comprimento depois do ponto de inflexão; g é a aceleração gravitacional; e ? é 

um índice de holdup de líquido no Riser calculado por ? = 1?UGS/Ut, onde Ut é a 

velocidade da bolha e UGS é a velocidade superficial do gás. 



2.2 Técnica de Elevação por Gas-lift 15 

Este critério, assim como outros propostos (BOE, 1981; JANSEN, F. E.; 

SHOHAM; TAITEL, 1996), fornece diretrizes para aplicações reais de sistemas 

com escoamento multifásico. A partir de uma equação algébrica de parâmetros de 

projeto dos sistemas é possível identificar limitações físicas de operação e projeto 

e embasar sistemas de controle de produção.  

A aplicabilidade dos métodos depende se as hipóteses do critério 

correspondente são plenamente válidas e se as variáveis e parâmetros estão 

disponíveis. Além disso, os mecanismos que levam a ocorrência das 

instabilidades devem estar bem esclarecidos e esta é uma análise estática, 

insuficiente para aplicações em controle automático dinâmico. 

2.2.2 Golfadas em Sistemas de Gas-lift  

Em sistemas de GL como os ilustrados na Figura 2.2, segundo Jahanshahi 

(2013) foram identificados os principais mecanismos sistemáticos que ocasionam 

a golfada severa:  

a) Cabeceio Anular; 

b) Onda de Densidade;  

c) Golfada por Acidente; 

d) Golfada Hidrodinâmica; e  

e) Golfada Operacional. 

Golfada por Cabeceio Anular 

O fenômeno de Cabeceio Anular ocorre quando o fluxo de gás de elevação 

não é crítico, ou seja, a taxa de injeção de gás no Tubing é variável conforme a 

diferença de pressão entre o Anular e Tubing. A instabilidade provém da dinâmica 

de escoamento no compartimento Anular e necessita de duas condições para 

ocorrer: a) a dinâmica do fluxo bifásico no Tubing ser dominado pela gravidade e 

b) possuir um grande volume de gás natural comprimido no Anular (HU, 2004). 

Sendo o tamanho da válvula de injeção grande o suficiente, qualquer 

variação na taxa de injeção de gás natural irá perturbar a pressão da coluna de 

produção e vice-versa (HU, 2004).  



16  Sistemas de Produção de Petróleo por Gas-lift 

 

Assim, como ilustrado na , assumindo uma variação negativa de pressão 

no Tubing, a taxa de injeção de gás de elevação irá aumentar (1) devido ao 

aumento da diferença de pressão com o Anular. Consequentemente, ocorre a 

diminuição da densidade da mistura e a pressão na coluna será reduzida ainda 

mais (2). Esta condição se estende até o momento em que a pressão no 

compartimento de gás diminui (3). Isto decorre do não equilíbrio entre o fluxo de 

entrada de gás natural no anular e o fluxo de saída do gás através da válvula de 

injeção (escoamento não crítico). A partir daí o fluxo de gás de elevação, entrando 

na coluna de produção, começa a cair. Este efeito pode resultar em um ciclo limite 

(4) como o ilustrado na .  

 

Figura 2.4: Ilustração do comportamento das fases gás (em azul) e da fase 

líquida (em cinza) das etapas do Mecanismo de Cabeceio Anular: 1) Início do 

Enchimento do Anular; 2) Esvaziamento do Anular e Injeção de gás no Tubing; 3) 

Propagação do gás seguido da cessão de injeção e novo enchimento do Anular; 

4) Retomada do enchimento do Anular. 

Golfada por Onda de Densidade 

O fenômeno de Onda de Densidade ocorre quando o fluxo através da 

Válvula de Injeção é crítico, ou seja, o fluxo de gás através do orifício da válvula 

de injeção é supersônico e, consequentemente, a vazão de gás é constante e 

1) 2) 

3) 4) 



2.2 Técnica de Elevação por Gas-lift 17 

independente da diferença de Pressão entre Anular e Tubing. A instabilidade é 

proveniente da dinâmica de escoamento no Tubing e variações do fluxo de líquido 

vindo do reservatório alteram a densidade da coluna de produção mudando as 

frações relativas das fases (gás e líquido).  

Num primeiro momento, como ilustrado na , a fração de gás na coluna não 

é suficientemente grande e a pressão no fundo do poço é igual à pressão no 

reservatório resultando num fluxo mínimo de produção proveniente do 

reservatório (1). À medida que gás entra constantemente no sistema a coluna de 

produção vai sendo aerada e a pressão no fundo do poço vai diminuindo até que 

atinge valores menores que a pressão do reservatório. Isto gera uma região de 

baixa de densidade no fundo do Tubing facilitando o escoamento de óleo 

proveniente do reservatório através das tubulações.  

A partir daí o óleo começa a entrar no sistema (2) e, paralelamente e 

concorrentemente à aeração, começa a incrementar a densidade do meio até o 

momento em que a produção atinge um máximo (3). Daí em diante a dinâmica do 

óleo domina o cenário e a produção decai até o ponto em que a produção cessa 

novamente e o ciclo se repete (4), conforme ilustrada na . 

 

Figura 2.5: Ilustração do comportamento das fases gás (em azul) e da fase 

líquida (em cinza) das etapas do Mecanismo de Onda de Densidade: 1) Fluxo 

mínimo; 2) Fluxo crescente; 3) Fluxo máximo com aumento da densidade do 

meio; 4) Diminuição do fluxo até o mínimo e reinício do ciclo. 

1) 2) 

3) 4) 



18  Sistemas de Produção de Petróleo por Gas-lift 

 

Golfada por Acidente 

O fenômeno de Golfada por Acidente é causado pelo acúmulo de líquido 

em pontos baixos gerados por acidentes na tubulação de encaminhamento no 

leito marinho, principalmente no ponto de transição Pipeline ? Riser. Neste local 

o acúmulo de líquido exerce uma contrapressão estática no fluxo de produção, 

bloqueando a fase gás, como ilustrado na Figura 2.6.  

Num primeiro momento há a formação do bloqueio por ação da gravidade 

acarretando no impedimento do fluxo de gás (1). À medida que o tempo aumenta, 

gás vai se acumulando à montante da inflexão, a pressão vai aumentando até o 

momento em que está excede a pressão hidrostática da coluna líquida (2) e a 

mistura é impulsionada abruptamente à superfície (3). Após esta ação, uma parte 

de líquido que não consegue ascender completamente retorna ao ponto baixo por 

ação da gravidade (holdup de líquido) (4) e o ciclo é retomado, como ilustrado na 

Figura 2.6. 

 

Figura 2.6: Ilustração do comportamento das fases gás (em azul) e da fase 

líquida (em cinza) das etapas do mecanismo de Golfada por Acidente na 

produção de óleo: 1) Acúmulo de óleo no acidente seguido de compressão de gás 

à montante; 2) Impulsão do líquido; 3) propagação da onda de gás; e 4) Retorno 

de óleo (Holdup) com novo acúmulo na inflexão de óleo e retomada do ciclo 

(baseado em Jahanshahi,2013). 

1) 2) 

3) 4) 



2.2 Técnica de Elevação por Gas-lift 19 

Golfada Hidrodinâmica 

A hidrodinâmica ocorre nas seções horizontais do pipeline e é gerada pela 

diferença de perda de carga das fases (consequentemente das velocidades de 

escoamento de líquido e gás). Essa diferença gera uma defasagem no 

escoamento e produz a chamada golfada hidrodinâmica. Esta instabilidade origina 

oscilações significantemente mais brandas do que a dos mecanismos citados 

acima e acaba sendo amortizada ao longo do sistema. (JAHANSHAHI, ESMAEIL, 

2013). 

Golfada Operacional 

A golfada operacional ocorre devido a transições de pontos operacionais, 

distúrbios de operação e partidas operacionais. Como será mostrado na 

Subseção 4.1, variações nas entradas de processo, sendo elas previsíveis ou 

não, podem levar ao regime de escoamento golfante (JAHANSHAHI, ESMAEIL, 

2013). 

2.2.3 Produção Golfante 

O cenário de operação intermitente, como introduzido no Capítulo 1, pode 

gerar problemas operacionais e de segurança para instalações industriais, uma 

vez que a intermitência de fases causa grandes oscilações de pressão no 

sistema. Devido à característica multifásica, não é viável (em sistemas reais) 

realizar o monitoramento dinâmico de parâmetros diretos de produção como 

vazão e densidade.  

Tipicamente, faz-se uma associação direta de produção com a pressão do 

sistema em três pontos ao longo do processo: Pressão de Fundo de Poço 

(chamada PDG, Permanent Downhole Gauge), Pressão de Topo do Poço 

(chamada TPT, Temperature and Pressure Transductor), e Pressão de Topo do 

Riser (chamada PTop). Devido ao posicionamento e ao tempo de resposta 

relativo aos demais pontos de medição, PDG é o principal parâmetro de 

monitoramento do poço.  

Esta relação produção versus pressão é sensível ao mecanismo de 

intermitência. Como ilustrado na Figura 2.7, para o mecanismo de Cabeceio 

Anular em um caso genérico, as golfadas podem ocasionar oscilações de pressão 

de até 50 bar no fundo do poço durante um ciclo de 1,5 h.  



20  Sistemas de Produção de Petróleo por Gas-lift 

 

 
Figura 2.7: Monitoramento da produção de óleo através da pressão dinâmica das 

etapas do Mecanismo de Cabeceio Anular: 1) Enchimento do Anular; 2) Injeção 

de gás no Tubing; 3) Propagação do gás seguido da cessão de injeção; 4) 

Retomada do enchimento do Anular (baseado em Hu, 2004). 

Estas oscilações estão em fase com a produção de óleo e diretamente 

correlacionadas com a intermitência na produção. Para o Cabeceio Anular, as 

etapas enumeradas anteriormente podem ser visualizadas na dinâmica da 

pressão de fundo do poço e do Anular.  

Para a dinâmica de Onda de Densidade, a correlação é vista para a Pressão 

do Reservatório e Pressão de Fundo de poço, como ilustrado na Figura 2.8. Já 

para o mecanismo de Golfada por Acidente, esta correlação não pode ser 

diretamente relacionada às variáveis de processo uma vez que os acidentes de 

tubulação são incertos. Neste, as oscilações são sentidas diretamente na vazão 

de produção de óleo, que como pode ser visualizado sofre grandes variações de 

até 300 m³/d, como ilustrado Figura 2.9 para um caso genérico. 

Os casos observados são genéricos e meramente ilustrativos. A magnitude 

das amplitudes, períodos e reposta à produção dos diferentes mecanismos são e 

dependentes das características físicas e físico-químicas do poço, como será 

discutido no Capítulo 3 e 4.  

1

3

4

2



2.2 Técnica de Elevação por Gas-lift 21 

 

Figura 2.8: Monitoramento da produção de óleo através da pressão dinâmica das 

etapas do Mecanismo de Onda de Densidade: 1) Fluxo mínimo; 2) Fluxo 

crescente; 3) Fluxo máximo com aumento da densidade do meio; 4) Diminuição 

do fluxo até o mínimo e reinício do ciclo(baseado em Hu, 2004). 

 

Figura 2.9: Monitoramento da produção de óleo através da pressão dinâmica das 

etapas do mecanismo de Golfada por Acidente na produção de óleo: 1) Acúmulo 

de óleo no acidente seguido de compressão de gás à montante; 2) Impulsão do 

líquido; 3) propagação da onda de gás; e 4) Retorno de óleo (Holdup) com novo 

acúmulo na inflexão de óleo e retomada do ciclo (baseado em Jahanshahi, 2013).  

 

1
3

42

1 2 3 4



22  Sistemas de Produção de Petróleo por Gas-lift 

 

Análise Dinâmica de Processo 

Uma forma de visualizar a produção e identificar a transição de uma região 

operacionalmente estável para uma golfante é a construção do diagrama de 

bifurcação, como o ilustrado na Figura 2.10. O gráfico traduz a resposta do 

sistema frente às entradas, como a abertura da choke, indicando o início da 

região golfante (Ponto de Bifurcação) e a sensibilidade/ganho da região estável. 

Para a região golfante, o gráfico traz informações de amplitude (Valores máximos 

e mínimo) e média (indicada pela Prod. Malha Aberta) do ciclo limite. De forma 

complementar, através do cálculo do valor estacionário (indicada pela Prod. 

Estacionário) a perda de produção é diretamente relacionada. O uso desta 

ferramenta será melhor explorado na Seção 4.1.  

 

Figura 2.10: Diagrama de Bifurcação Hipotético (baseado em Jahanshahi, 2013). 

Por questão de espaço, o procedimento de construção do diagrama de 

bifurcação está apresentado no Apêndice C - Construção do Diagrama de 

Bifurcação. 

2.3 Modelagem de Sistemas Gas-lift  

Como já mencionado, equações algébricas como a equação 2.1, são 

indicadores estáticos e não são suficientes para representação do comportamento 

dinâmico. Para tanto, existem três tipos diferentes de modelos desenvolvidos para 

sistemas de GL: fenomenológicos, empíricos e semi-empíricos. 



2.3 Modelagem de Sistemas Gas-lift 23 

O primeiro tipo, também dito caixa branca, retrata a dinâmica do sistema a 

partir de leis básicas de conservação da engenharia (Balanços de Massa, Energia 

e Momentum, relações de Navier-Stokes, etc.) e correlações físico químicas. Uma 

série de Equações Diferenciais Parciais (EDP’s) são resolvidas para descrição do 

fluxo bi (óleo e gás) e trifásico (óleo, água e gás).  

Para estes tipos de modelos podem-se citar os softwares OLGA e 

LedaFlow (BELT et al., 2011; BENDIKSEN et al., 1991; EHINMOWO; CAO, 2015; 

HESKESTAD, 2005; JAHANSHAHI, ESMAEIL et al., 2014; LEEBEECK; 

JOHANSEN, 2013). Estes softwares são capazes de reproduzir os mecanismos 

da golfada para muitos casos, sem a necessidade de ajustes estruturais e 

estimação paramétrica para uma boa representação. Entretanto, ainda são 

incapazes de representar instabilidades provenientes da dinâmica dos 

reservatórios (PEDERSEN; DURDEVIC; YANG, 2015). 

Apesar da potencial acuracidade, a complexidade associada aos modelos 

do tipo caixa branca trás o ônus do elevado custo computacional, além do custo 

monetário relativo à aquisição de licenças de uso. Para a área de otimização, traz 

consigo o ônus da impossibilidade de derivação de leis de controle e critérios de 

estabilidade e observabilidade (DI MEGLIO, FLORENT et al., 2011). 

Num sentido oposto ao fenomenológico, a modelagem empírica, também 

chamada caixa preta, é composta de uma série polinomial de ordem variada 

geradas a partir de dados históricos do sistema. A estrutura deste é mais simples 

e o custo computacional é consideravelmente menor do que para modelos caixa 

branca, uma vez que a solução é analítica e não necessita da aplicação de 

métodos numéricos.  

Jahanshahi et al.(2008) e Salahshoor et al.(2013) reconstroem a dinâmica 

do sistema através de modelagem Fuzzy para Cabeceio Anular e Redes 

Neuronais para Onda de Densidade, respectivamente, em um reservatório 

simulado para o emprego em controle. 

Já Teixeira et al.(2014) a partir de um método que emprega métodos de 

identificação de sistemas e redes neuronais, reconstrói a dinâmica para a 

aplicação em medidores virtuais de pressão. Apesar do sucesso relatado, para 

sistemas extremamente não lineares e suscetíveis a diversos distúrbios não 

medidos, como é o GL, modelos caixa preta não são robustos o suficiente para 



24  Sistemas de Produção de Petróleo por Gas-lift 

 

aplicações reais. Este tipo de abordagem é recomendada para interpolação de 

sistemas lineares e pouco usado para extrapolações.  

No intuito de corrigir discrepâncias proveniente da não linearidade, ambos 

os trabalhos citados utilizam técnicas de retroalimentação como modificações do 

Filtro de Kalman, EKF (Extended Kalman Filter) e UKF (Unscented Kalman Filter). 

Além disso, para formulação de modelos abrangentes é necessária uma gama de 

dados de sistemas golfantes e não golfantes suficientemente grandes, que pode 

não estar disponível em sistemas reais.  

A replicação direta do modelo de um sistema para outro não é possível, 

sendo necessária a construção de um novo modelo baseado em novos dados, 

dificultando o processo de escalonamento de tecnologia. 

Por último, os modelos semi-empíricos mesclam os conceitos das outras 

duas classes a fim de assumir um compromisso entre complexidade e acurácia. 

Através ou Equações Diferenciais Parciais (EDP’s), ou de Equações Diferenciais 

Ordinárias (EDO’s), que descrevem apenas balanços mássicos, somadas a 

Equações Algébricas (EA’s) derivadas das leis de conservação e de correlações 

são construídos modelos chamados caixa cinza.  

Em relação ao caixa branca, a complexidade do sistema é diminuída por 

simplificações realizadas no processo de construção do modelo. Como 

consequência, para manter a acurácia a sistemas reais tem-se a necessidade de 

estimar alguns parâmetros matemáticos baseado em dados históricos, similar ao 

caixa preta. Apesar do esforço para a estimação, esta classe de modelos é útil 

para interpretação de dinâmicas, sendo utilizado até mesmo para estudos de 

modelagem empírica (JAHANSHAHI, E.; SALAHSHOOR; SAHRAIE, 2008). 

Quanto aos desenvolvimento de modelos baseados em EDP’s podem-se 

citar os modelos desenvolvidos por Storkaas et al.(2001), Sinegre et al.(2006), Di 

Meglio et al.(2011) e Nemoto e Baliño (2012). O segundo trabalho foi 

desenvolvido a fim de predizer os mecanismos de Golfada por Onda de 

Densidade e Cabeceio Anular. Os outros três desenvolvidos para a predição da 

Golfada por Acidente. Entretanto, estes modelos, assim como os 



2.3 Modelagem de Sistemas Gas-lift 25 

fenomenológicos impossibilitam ou tornam muito complexas as derivações das 

leis de controle e critérios de estabilidade e observabilidade. 

Assim, dentro do objetivo deste trabalho (de controle e otimização através 

de controle baseado em modelo) os modelos baseados em EDO’s tornam-se a 

principal ferramenta para desenvolvimento de novos métodos (BEQUETTE, 

1998).  

Pensado assim, a fim de definir a ferramenta mais adequada, será 

apresentado, na seção que segue, um breve histórico da evolução de modelos 

tipo caixa cinza baseado em EDO’s para sistemas de produção de petróleo por 

GL. 

2.3.1 Modelos Simplificados para Sistemas de Gas-lift 

Um dos primeiros estudos apresentados na modelagem de sistemas de GL 

foi o de Taitel et al.(1980), já apresentado seção 2.2.1, aonde os autores 

validaram o modelo com dados experimentais e foram capazes de descrever a 

transição de dinâmica para um sistema bifásico gás-óleo em um escoamento 

vertical ascendente.  

Este modelo, assim como os apresentados por Sarica e Shonam (1991) e 

Jansen et al.(1996), são denominados “Early-Stage Models” e deram início aos 

estudos sobre a modelagem do tipo caixa cinza para sistema de GL. Apesar do 

sucesso inicial para representação das oscilações de pressão, estes modelos 

pecavam na representação de regiões estáveis e transição de mecanismos. 

Já no século 21, o foco da modelagem passou a ser reprodução dinâmica 

de todo o mapa de estabilidade embasada apenas nos balanços de massa 

simplificados. Inspirados pela ideia inicial de Jansen et al.(1999), que propuseram 

a modelagem simplificada por três EDO’s para o equacionamento da conservação 

da massa na região do poço (Tubing e Anular) e equações algébricas para 

correlacionar pressão e temperatura aos estados dinâmicos calculados.  

Além disso, os autores sugerem que as equações de fluxo devam ser 

calculadas de forma algébrica e simplificada pela correlação de pressões e que 

devem ser ajustadas conforme o tipo de válvula utilizada no sistema estudado.  



26  Sistemas de Produção de Petróleo por Gas-lift 

 

Pensado nesta ideia de simplicidade e nos resultados motivadores 

apresentados pelos autores em termos de controle, todos os modelos 

apresentados utilizam três principais premissas:  

1. Sistema bifásico gás-óleo imiscíveis;  

2. Velocidade constante da fase líquida; 

3. Comportamento ideal da fase gás; e 

4. Temperatura constante;  

Mais tarde, Aamo et al.(2005) propõem um modelo simplificado para um 

poço como o representado pela .A, para construção de um analisador virtual para 

fins de controle. Baseado nas ideias e premissas de Jansen et al.(1999), o autor 

equaciona os três estados dinâmicos do sistema (Massa de Gás no Anular, 

Massa de Gás no Tubing e Massa de Líquido no Tubing ) e define as equações 

de fluxo das válvulas choke e de injeção de gás como modelos simplificados para 

regime turbulento do tipo W = K ? ??P.  

A dinâmica do reservatório é negligenciada e o fluxo de produção 

proveniente é considerado monofásico (apenas óleo) e dado por uma relação 

linear. A perda de carga dinâmica e a compressibilidade das fases são 

desconsideradas.  

Estas premissas restringem a aplicação do modelo ao fenômeno de 

Cabeceio Anular, uma vez que o comportamento turbulento e o supersônico 

(necessário para ocorrência da onda de densidade) são distintos. Ainda assim, o 

modelo proposto é validado e comparado com o software OLGA com boa 

aderência (IMSLAND, 2002). O modelo apresentado, descreve um poço por três 

EDO’s, quinze EA’s e três parâmetros estimados (Constantes de Válvulas).  

A fim de aprimorar este modelo, Eikrem et al. (2008) adicionam a 

informação da razão óleo/gás do reservatório e incluem o fluxo de gás 

proveniente no reservatório no balanço. A partir desta modificação, que 

agregaram mais uma EA, os autores realizaram satisfatórios estudos de 



2.3 Modelagem de Sistemas Gas-lift 27 

controlabilidade e estabilidade, utilizando-o dados de OLGA para ajuste de 

modelo e aplicação de controle.  

Jahanshahi et al. (2012) adicionaram um termo de perda de carga dinâmica 

ao sistema e modificaram a forma de cálculo das frações e massa específica, a 

fim de excluir a premissa inicialmente adotada de não compressibilidade do 

sistema na Árvore de Natal. Este novo modelo, com mais dezenove EA’s 

agregadas, foi utilizado para a realização de um novo estudo de estabilidade e 

controlabilidade, validado com OLGA. 

Com a mesma intenção, Hussein et al.(2015) utilizam considerações para o 

balanço material idênticas às de Eikrem et. al(2008), desconsiderando a presença 

de gás proveniente do reservatório. Os autores propõem equações de fluxo nas 

válvulas choke de GL para descrição do fluxo de entrada de gás de elevação e 

uma equação de válvula baseada em projeto de válvulas para a injeção de gás no 

sistema, que leva em consideração a dinâmica do sistema (escoamento subcrítico 

e crítico).  

Além disso, um termo exponencial é adicionado para o cálculo das 

pressões, a fim de tratar a premissa de gás ideal. Apesar disso, este modelo 

apresenta problemas de estabilidade numérica para reprodução das golfadas e é 

utilizado apenas para estudo teóricos de controlabilidade (HUSSEIN; AL-DURRA; 

BOIKO, 2015; SHI et al., 2016).  

A fim de viabilizar o modelo para os fenômenos de Onda de Densidade e 

Cabeceio Anular e resolver os problemas de instabilidade numérica, Shao et 

al.(2016) propõem a atualização das pressões das misturas ao longo do Tubing 

no chamado “Plastic Bag Model”, ilustrado pela .B.  

Os problemas de convergência numérica são resolvidos através da 

discretização da região do Tubing em N componente discretos. Em contrapartida, 

o custo computacional do problema aumenta consideravelmente e apesar do 

sucesso aparente, os modelos não foram validados experimentalmente ou por 

modelos fenomenológicos e apenas comparados a modelos simplificados. 



28  Sistemas de Produção de Petróleo por Gas-lift 

 

A. 

 

B. 

 
Figura 2.11: Representação do sistema modelado para a região do Poço 

propostos por: A. Aamo et al.(2005), Eikrem et al.(2008), Jahanshahi et al.(2012) 

e Hussein et al.(2015); e B. Shao et al.(2016). (Baseado em Aamo et al., 2005, e 

Shao et al., 2016)  

Para o mecanismo de Golfada por Acidente, Storkaas et al.(2003) 

desenvolvem um modelo simplificado para a região Pipeline-Riser, como a 

representada na Figura 2.12.A, com três EDO’s, vinte e quatro EA’s e quatro 

parâmetros de estimação. São utilizadas equações simplificadas de válvula para a 

descrição do fluxo considerando perdas estáticas e dinâmicas de pressão ao 

longo do sistema (?P = Pf + ? ? ? ? ?h).  

Os autores consideram os fluxos de entrada do sistema constantes e o 

comportamento estacionário no fundo do Riser, de modo que o mecanismo 

golfante é gerado pela obstrução de líquido. Através deste modelo, é possível 

capturar com boa aderência a transição de estabilidade operacional a dados 

experimentais e dados simulados em OLGA (SIVERTSEN; STORKAAS; 

SKOGESTAD, 2010; STORKAAS, ESPEN; SKOGESTAD; GODHAVN, 2003).   

Na mesma linha, para um sistema Pipeline-Riser, Jahanshahi et al.(2011) 

propõem a inclusão de um estado dinâmico pela segregação de duas correntes 

de líquido, uma no Pipeline e outra no Riser. O modelo é ajustado e validado a 

dados de OLGA e demonstra ser o que melhor representa as golfadas em termos 

de transição de regimes frente aos demais modelos apresentados. 



2.3 Modelagem de Sistemas Gas-lift 29 

Paralelamente, Di Meglio et al.(2009) propõem a inserção de uma válvula 

virtual no ponto de inflexão do sistema Pipeline-Riser, como indicado na 

Figura 2.12.B, para modelar as instabilidades operacionais ocasionadas pela 

Golfada por Acidente. A montante desta válvula virtual, gás se acumula e forma 

uma grande bolha alongada, cuja pressão aumenta com o aumento do gás 

acumulado, eventualmente, gerando instabilidade. O modelo utiliza três EDO’s e 

sete EA’s, com fluxos de entrada de gás e óleo constantes e fluxo de saída 

representado por uma equação simplificada de válvula.  

A. 

 

B. 

 
Figura 2.12: Representação do sistema modelado para a região do Pipeline-Riser 

propostos por: A. Storkaas et al.(2003), Siverstsen et al. (2010) e Jahanshahi et 

al.(2011); e B. Di Meglio et al.(2009). (Baseados em Siverstsen et al., 2010, e 

Di Meglio et al., 2009) 

A válvula virtual, por não ser um objeto real do sistema, agrega quatro 

novos parâmetros de estimação, além da constante da válvula choke. A 

simplicidade do modelo faz com que haja solução analítica para o problema. 

Ainda simples, o modelo demostrou uma boa adequação à modelagem 

fenomenológica e a sistemas experimentais (DI MEGLIO, FLORENT et al., 2012; 

DI MEGLIO, FLORENT; KAASA; PETIT, 2009). 

Mesmo com o significativo esforço até aqui apresentado, na tentativa de 

modelar sistemas de GL não há consolidação da real aplicabilidade de tais 

modelos. Estes não são capazes de abranger um sistema real de produção como 

um todo, uma vez que as instabilidades são provenientes de diferentes 

mecanismos em diferentes pontos do processo (SKOFTELAND et al., 2007). 

Diante disso, Jahanshahi (2013) adicionou ao modelo, anteriormente 

proposto por Jahanshahi e Skogestad (2011), dois estados dinâmicos para a 

representação da massa de gás e líquido proveniente do Tubing, como ilustrado 

na Figura 2.13.A.  



30  Sistemas de Produção de Petróleo por Gas-lift 

 

A dinâmica do reservatório é uma relação linear de pressões na base do 

poço. As pressões calculadas considerando perda de carga estática e dinâmica. 

Isto agrega ao modelo mais duas EDO’s, dezoito EA’s e um parâmetro a ser 

estimado. O modelo se ajusta com boa qualidade aos dados gerados pelo OLGA, 

mas não inclui as dinâmicas provenientes do Anular. 

Com tudo, fica clara a necessidade da construção de um modelo Anular-

Tubing-Pipeline-Riser como o ilustrado na Figura 2.13.B. Tal modelo deve 

abranger todas as especificidades de um sistema tipicamente brasileiro, descrito 

anteriormente. Uma análise crítica dos trabalhos existentes às necessidades do 

novo modelo está resumida na Tabela 2.1, identificando a elegibilidade dos 

modelos existentes às características necessárias para o novo modelo. 

A. 
 

B. 

 
Figura 2.13: Representação do sistema propostos por: A. Jahanshahi (2013); e B. 

Necessidades do modelo a ser desenvolvido. (Baseados Jahanshahi, 2013) 

  



2.3 Modelagem de Sistemas Gas-lift 31 

Tabela 2.1: Comparação entre modelo simplificados de sistema de Gas-Lift. 

A
u

to
re

s
 

S
to

rk
a
a
s
  

e
t 

a
l.
 (

2
0
0
3
) 

A
a
m

o
 

 e
t 

a
l.
 (

2
0
0
5
) 

E
ik

re
m

  

e
t 

a
l.
 (

2
0
0
8
) 

D
i 

M
e

g
li
o

  

e
t 

a
l.
 (

2
0
0
9
) 

J
a
h

a
n

s
h

a
h

i 
a
n

d
 

S
k
o

g
e

s
ta

d
 

(2
0
1
1
) 

J
a
h

a
n

s
h

a
h

i 
 

e
t 

a
l 

(2
0
1
2
) 

J
a
h

a
n

s
h

a
h

i 
(2

0
1
3
) 

H
u

s
s
e
in

  

e
t 

a
l.
 (

2
0
1
5
) 

S
h

a
o

  
e
t 

a
l.
 (

2
0
1
6
) 

N
e
c
e
s
s
id

a
d

e
s
 

d
o

 N
o

v
o

 

M
o

d
e

lo
 

D
in

â
m

ic
a
 d

o
 

R
e
s
e
rv

a
tó

ri
o

 

N
A

 

L
in

e
a
r 

M
o
n
o
fá

s
ic

o
 

L
in

e
a
r 

B
if
á
s
ic

o
 

N
A

 

N
ã
o
 

L
in

e
a
r 

B
if
á
s
ic

o
 

L
in

e
a
r 

B
if
á
s
ic

o
 

N
ã
o
-l
in

e
a
r 

M
o

n
o
fá

s
ic

o
 

N
ã
o
-l
in

e
a
r 

M
o

n
o
fá

s
ic

o
 

N
ã
o

-l
in

e
a
r 

B
if

á
s
ic

o
 

T
u

b
in

g
 

Não Sim Sim Não Não Sim Sim Sim Sim Sim 

A
n

u
la

r 

Não Sim Sim Não Sim Sim Não Sim Sim Sim 

P
ip

e
li

n
e
 

/R
is

e
r 

Sim Não Não Sim Não Não Sim Não Não Sim 

E
s
ti

m
a
ç
ã
o

 
d

e
  
P

D
G

 

Não Não Não Não Não Não Sim Sim Sim Sim 

E
s
ti

m
a
ç
ã
o

 
d

e
 T

P
T

 

Não Sim Sim Sim Sim Sim Sim Sim Sim Sim 

E
s
ti

m
a
ç
ã
o

 
d

e
 P

_
T

o
p

 

Sim Não Não Sim Sim Não Sim Não Não Sim 

C
a
b

e
c
e
io

 
A

n
u

la
r 

Não Sim Sim Não Não Sim Não Sim Sim Sim 

O
n

d
a
 d

e
 

D
e
n

s
id

a
d

e
 

Não Não Não Não Não Não Não Não Sim Sim 

G
o

lf
a
d

a
 

p
o

r 

A
c
id

e
n

te
 

Sim Não Não Sim Sim Não Sim Não Não Sim 

R
ig

id
e
z
 

N
u

m
é
ri

c
a
 

Não Não Não Não Sim Sim Sim Sim Sim Não 

V
a
li
d

a
ç
ã
o

 

E
x
p

e
ri

m
e

n
ta

l 

Sim Sim* Sim* Sim Sim Sim* Sim Não Não Sim 

V
a
li
d

a
ç
ã
o

 
R

e
a
l 

Não Não Não Sim Não Não Não Não Não Sim 

A
d

e
rê

n
c

ia
 

5 6 6 7 5 5 6 5 5 12 

Notas:                  NA – Não aplicável.                 (*) – Validado a partir de um modelo Fenomenológico. 



32  Sistemas de Produção de Petróleo por Gas-lift 

 

2.4 Controle de Produção em Sistema de Gas-lift 

A produtividade de um reservatório é diretamente dependente da energia 

acumulada e disponível no sistema. Como mencionado no Capítulo 1, ações 

diretas como a manipulação de gás de elevação, da abertura da válvula choke 

afetam este acúmulo e a quebra química da emulsão água/óleo. Nesta Seção as 

típicas ações manuais serão detalhadas. 

O aumento do fornecimento de gás de elevação conduz o sistema para um 

escoamento livre das golfadas, porém nem sempre ótimo no que tange a 

produção de óleo. Hu (2004) mostrou que o desempenho típico de um poço de 

GL é não-linearmente dependente à taxa de injeção de gás de elevação, como 

ilustrado na Figura 2.14. Num primeiro momento a taxa de produção cresce 

rapidamente com a taxa de injeção de gás, mas se continuar a aumentar o 

fornecimento a produção irá diminuir gradualmente.  

Isto ocorre no momento em que a perda de carga dinâmica induzida pelo 

aumento da velocidade da fase gás não é mais compensada pela perda de carga 

hidrostática e a Máxima Produção de Óleo (MP), indicada na figura, é alcançada. 

Em sistemas multipoço, devido à interação entre as descargas que podem 

ocasionar instabilidades operacionais, o Máximo Retorno Financeiro (MRF) global 

da unidade é diferente da MP para um poço específico. 

Para muitos poços o MRF é diferente do ponto de MP uma vez que a 

alocação do gás disponível depende das características dos poços, como o índice 

de Produção, grau de maturidade e etc (CAMPONOGARA et al., 2010). Além 

disso, o suprimento de gás em sistemas de produção é limitado à capacidade de 

compressão da unidade operacional adicionando uma nova restrição ao problema 

de alocação de gás.  

O resultado disso é que este limite no fornecimento de gás pode levar a 

ocorrência de um novo ponto ótimo de produção dito Valor Presente Máximo 

(VPM). Assim, na prática o ótimo de produção VPM poderá ser no máximo igual 

ao MRF quando o sistema de compressão não limita a operação. 

Isso sugere que o controle ativo de superfície, da alimentação de gás, 

possa manter a variável controlada em um ponto ótimo, amenizando de distúrbios 



2.4 Controle de Produção em Sistema de Gas-lift 33 

proveniente dos trens de compressão. Outro ponto importante é o de que a região 

de operação deste sistema (região ascendente da curva de produção) garante 

uma operação dominada pelas perdas de carga hidrostáticas. Isso faz com que 

não seja garantida a operação estável do sistema, como visto na Figura 2.14 (HU, 

2004). 

 

Figura 2.14: Pontos Ótimos de Desempenho de um Poço (baseado em Hu, 2004) 

A estabilidade do sistema está diretamente ligada às velocidades das fases 

envolvidas (Seção 2.2.1) e uma vez que a fase gás é definida pelo ótimo, 

conforme descrito anteriormente, a necessidade do controle do tipo de 

escoamento nos leva à segunda prática convencional que é o controle manual. O 

fluxo de produção é diretamente proporcional à perda de carga ao longo do 

processo (? ? ??? ? ???  ? ?? , ???, onde Pr e Ptr são as pressões no Reservatório 

e no Topo do Riser e ?? a velocidade superficial de líquido, respectivamente).  

Considerando que a pressão no reservatório possui dinâmica lenta, 

podendo assim ser considerada constante, a Pressão no Topo do Riser torna-se a 

variável que afeta imediatamente de estabilidade operacional. Esta perturbação é 

feita com a válvula choke que regula a pressão a montante pela sua abertura, que 

quanto maior for, menor será Ptr, afetando a produtividade, como ilustrado na 

Figura 2.15 (DI MEGLIO, FLORENT; KAASA; PETIT, 2009). 

Na prática, assim que definido o ponto de trabalho (MP, MRF ou VPM) é 

ação comum a atuação manual da choke por conhecimento empírico e intuição 

das equipes de operação. Na tentativa de aumentar a produção, a válvula é 

gradativamente aberta até que o poço comece a “golfar”, momento no qual a 



34  Sistemas de Produção de Petróleo por Gas-lift 

 

válvula é fechada abruptamente até a estabilização da produção. Como a 

dinâmica do sistema é lenta, é possível um sensível aumento de produção com 

esta prática, sem comprometer a segurança das instalações (HU, 2004). 

 

Figura 2.15: Dinâmica da produção de petróleo em relação à abertura da choque 

(baseada em Di Meglio et al.,2009). 

De forma semelhante à choke, a pressão no manifold de produção e/ou a 

pressão e o nível do Separador também afetam o regime de escoamento da 

produção, influenciando a pressão de topo do sistema (LUO et al., 2014). Porém a 

sensibilidade em relação às demais variáveis de impacto (choke e gás de 

elevação) é menor, como descrito por Hu (2004).  

Apesar de afetar a produção média, a variação da pressão do manifold (ou 

do separador) muitas vezes não é capaz de estabilizar o sistema. Isso pode 

explicar o motivo pelo qual nenhum dos trabalhos publicados até o momento 

utiliza esta variável como variável manipulada. Isto também corrobora a ideia da 

utilização desta variável (Ps) como uma entrada constante dos modelos propostos 

Jansen et al.(1996), Storkaas et al.(2003), Sivertsen et al.(2010) e  Di Meglio et 

al.(2009).  

Entretanto, do ponto de vista de controle esta variável não pode ser 

negligenciada, uma vez que dependendo da região de operação, pequenas 

perturbações podem alterar o regime de escoamento de uma rede de poços. A 

pressão no header de produção é função direta da produção global de uma 

unidade e é uma variável disponível para monitoramento e controle. Por isso, 



2.4 Controle de Produção em Sistema de Gas-lift 35 

Gustavsen e Tondel (2009) utilizam a Pressão no Separador como variável 

monitorada e controlada em uma estrutura hierárquica. 

Apesar disso, estes métodos de controle de produção manual não 

garantem que distúrbios de processo levem à ocorrência das golfadas e a 

consequente perda de produção e avaria nas instalações. Devido a esta influência 

negativa, algumas soluções no que tange o projeto (ditas Soluções Passivas) e a 

operação automática (ditas Soluções Ativas) vêm sendo propostas. Na seção que 

segue serão apresentadas somente as soluções ativas. Uma revisão do Controle 

Passivo aplicado às golfadas pode ser lida no Apêndice A – 

2.4.1 Controle Ativo de Golfadas 

O Controle Ativo é aquele que elimina o fluxo intermitente através da 

aplicação de uma estratégia automática de controle retroalimentado baseado nas 

informações de processo disponíveis (PEDERSEN; DURDEVIC; YANG, 2015).  

Estas técnicas são preferidas na implantação em sistemas reais, pois não 

necessitarem de um elevado investimento inicial principalmente em sistemas já 

comissionados. Tais alternativas utilizam as variáveis já disponíveis necessitando 

apenas a instalação da plataforma a ser utilizada (software de controle). Além 

disso, existe a possibilidade da combinação com técnicas de Controle Passivo 

(ALSHEHRI; RICARDEZ-SANDOVAL; ELKAMEL, 2010; XING et al., 2013). 

A atuação automática por controle retroalimentado necessita dos sinais de 

processo disponíveis que em teoria, para sistemas lineares, podem ser utilizados 

se este reproduzir as instabilidades de processo (SKOGESTAD; 

POSTLETHWAITE, 1996). Entretanto, limitações provenientes dos atuadores 

devido às saturações físicas ou limitações de taxas de variação ou ainda Zero no 

semi-plano direito (RHP-zeros) podem prejudicar a controlabilidade do sistema.  

Segundo Skogestad e Postlethwaite (2005), controlabilidade de entrada e 

saída é a capacidade de atingir um desempenho aceitável de controle para 

manter as saídas dentro dos limites especificados ou deslocamentos de suas 

referências, apesar de desconhecido, nas limitadas variações, como distúrbios e 

mudanças de plantas (incluindo a incerteza), utilizando insumos e medidas 

disponíveis.  



36  Sistemas de Produção de Petróleo por Gas-lift 

 

Por isso, é necessária a seleção de qual sinal é o mais indicado para o 

controle ativo e qual o atuador disponível com melhor desempenho pode ser 

determinado por analises de controlabilidade entrada-saída. 

Variáveis Controladas 

Existe uma série de variáveis controladas candidatas no sistema: pressão 

no fundo do poço; pressão no topo do reservatório de GL; pressão no topo da 

coluna de produção; pressão à montante da válvula de produção; vazão mássica 

de produto; densidade da mistura no topo da coluna de produção; e fração 

volumétrica de líquido no topo da coluna de produção (JAHANSHAHI, ESMAEIL; 

SKOGESTAD; HANSEN, 2012).  

Diante das possibilidades, Storkaas (2005) estudou a controlabilidade de 

um sistema Pipeline-Riser, como o ilustrado na Figura 2.16.A, e identificou que a 

definição da localização dos sinais de processo é uma importante decisão que 

impacta no desempenho do controle ativo.  

O autor conclui que é possível estabilizar o sistema com todas as medições 

de pressão no sistema, mas que o aumento da frequência de ciclo da golfada as 

medições de topo se tronam ineficientes. Isto se deve, segundo o autor, ao 

elevado tempo de propagação da instabilidade (tempo morto) associado aos 

longos caminhos da tubulação.  

Outra constatação interessante é a de que um sistema de controle de 

vazão só é possível em estruturas multivariáveis, pois a baixas frequências o 

desempenho desta variável em controle é baixo. Dois distúrbios do sistema são 

identificados como a pressão do reservatório e a pressão do fornecimento de 

Gas-lift.  

Estendendo este estudo para um sistema Well-Pipeline-Riser, como o 

Figura 2.16.B, Jahanshahi (2013) identificou a pressão de fundo de poço como a 

melhor variável controlada. Isso decorre do fato de que o tempo de resposta desta 

variável às instabilidades é menor do que para as demais. 



2.4 Controle de Produção em Sistema de Gas-lift 37 

A. 

 

B. 

 

Figura 2.16: Candidatas à CVs e MVs e identificação de distúrbios (DVs)  

propostas por Jahanshahi (2013), para A. um sistema Anular-Tubing; e B. um 

sistema Tubing-Pipeline-Riser. (Baseado em Jahanshahi, 2013) 

Além disso, o autor também recomenda a aplicação de estruturas 

multivariáveis aliando pressão e vazão demostrou possuir um ganho estático 

maior do que as demais variáveis. 

Para análise das possíveis variáveis manipuladas, Jahanshahi (2013) fez 

um estudo de diversas posições (junto à Árvore de Natal, no ponto de inflexão 

Riser-Pipeline e no Topo) identificando que para o controle das instabilidades o 

uso exclusivo da válvula da ANM não é recomendado.  

Storkaas (2005) identificou os limites de desempenhos do sistema 

referentes às taxas máximas de variação e a discretização dos sinais das 

variáveis manipuladas.  

Sinegre (2006) demostra a possibilidade da utilização não apenas da 

choke, mas também da alimentação de GL para estabilização do processo, mas 

sem estudos mais elaborados de controlabilidade.  

Diante destas constatações, estudos abordando diferentes estruturas de 

controle vêm sendo apresentados e serão descritos subsequentemente. 

Controle Linear 

Baseado nos trabalhos supracitados, verifica-se que há um consenso 

acerca da atuação da choke por controlador Proporcional Integral Derivativo (PID) 

objetivando a atenuação das golfadas (PEDERSEN; DURDEVIC; YANG, 2015). 



38  Sistemas de Produção de Petróleo por Gas-lift 

 

O uso deste tipo de técnica foi comprovado e reproduzido em simulação e 

em experimentos para os mecanismos de Cabeceio Anular por por Sivertsen et 

al.(2010),  Onda de Densidade por Sinegre et al.(2005) e por Acidente por Di 

Meglio et al.(2012) e Jahanshahi et al.(2012), através das estruturas ilustradas 

nas Figuras .A e .B.  

Utilizando a pressão no fundo do poço, com um controlador Proporcional-

Integral (PI) em uma malha feedback os autores monstraram sucesso pela 

manipulação da abertura da choke resultando em estabilidade de processo e um 

acréscimo de produção.  

Esta estrutura é tida como solução padrão para controle de golfadas. 

Entretanto, a pressão de fundo de poço, devido às características mencionadas 

na Seção 2.1, nem sempre está disponível em sistemas reais. A manutenção ou 

substituição destes sensores que estão a até 2 mil metros de profundidade, como 

os do pré-sal (PETROBRAS, 2015), é uma tarefa desafiadora e muitas vezes 

inviável (ECK et al., 1999).  

Mesmo em poços com menores profundidades, as medições ainda podem 

sofrer grande interferência de ruídos. Além do mais, quando o sensor falhar, 

conforme relatado por Di Meglio et al.(2012), o controle pode encaminhar o 

processo para a região de ocorrência das golfadas. 

Pensando nesta indisponibilidade, Sivertsen et al.(2010) compara o 

desempenho de outras possíveis candidatas a variáveis controladas na estrutura 

PI. Utilizando a densidade da mistura do topo, os autores obtiveram um 

desempenho próximo ao utilizando a pressão de fundo e com vazão de saída não 

foi possível estabilizar o sistema.  

Em contribuição à solução deste problema Aamo et al.(2005), Jahanshahi 

et al.(2008), Scibilia et al.(2008) e Di Meglio et al.(2012) propuseram estruturas de 

controle PI e PID aliados a analisadores virtuais de pressão, como a ilustrada na 

Figura .C.  

 



2.4 Controle de Produção em Sistema de Gas-lift 39 

A. 

 

B. 

                    

C. 

 

D. 

 

Figura 2.17: Estruturas de Controle Linear;  

A. Controle de Pressão de Fundo para Cabeceio Anular e Onda de Densidade 

pela manipulação da choke; B. Controle de pressão de fundo para Golfada por 

Acidente pela manipulação da choke; C. Controle aliado a Analisadores Virtuais 

pela manipulação da choke; e D. Controle de Pressão de Fundo pela manipulação 

da choke de Gas-Lift (KRIMA; CAO; LAO, 2012). (Baseados em Aamo et al., 

2005, Di Meglio et al., 2012, Krima et al., 2012, Jahanshahi, 2013) 

A partir de medidas de topo disponíveis, os autores reconstroem a pressão 

de fundo e utilizam como variável controlada obtendo sucesso para a supressão 

da golfadas. Di Meglio et al.(2012) ainda compara diferentes estruturas de 

controle, com pressão de fundo disponível e controlada, com pressão de topo 

controlada e com analisador virtual de pressão de fundo, identificando a 



40  Sistemas de Produção de Petróleo por Gas-lift 

 

desempenhos similares, mas ainda com menor sensibilidade na produção do que 

a solução padrão.  

Para aplicação desta técnica, Godhavn et al.(2005) fornece um método 

para ajuste de controladores PI aplicados a sistemas de elevação e produção, 

operando em regime de golfadas. 

Apesar de não recomendada pelos estudos de controlabilidade de Jahanshahi 

(2013), a choke de Gas-lift ainda é uma candidata para atuação do controle de 

pressão, como a representada na Figura .D. Fazendo o uso desta variável 

manipulada Krima et al. (2012) aplicaram uma estratégia monovariável PI de 

supressão de golfadas com baixa amplitude. 

Controle Não Linear 

Controladores PID são uma alternativa sensíveis para processos 

complexos e não lineares, como o fluxo multifásico. Por utilizarem parâmetros 

fixos podem ter um comportamento indesejado em determinadas regiões de 

operação instabilizando o sistema (DI MEGLIO, FLORENT et al., 2012).Por este 

motivo, estratégias de controle não linear utilizando parâmetros de controle 

variáveis também foram propostas. 

Jahanshahi et al. (2013) propuseram uma estrutura switch de controle 

dependente da região de operação. Três controladores são ajustados para três 

regiões diferentes de abertura de válvula de produção e o controlador é 

selecionado conforme a faixa de operação e setpoint de pressão. 

Hussein et al. (2015) propuseram um controlador gain scheduling onde os 

parâmetros de controle são ponderados conforme a região de operação. Os 

pesos e a ponderação são definidos por um método intrusiva de testes para 

alcançar um desempenho desejado.  

Ainda assim, estas estratégias são estritamente monovariáveis e como 

sugerido por Sivertsen et al. (2010) a combinação de mais de uma variável 

controlada/manipulada em estruturas multivariáveis pode ser uma alternativa com 

melhor desempenho.  



2.4 Controle de Produção em Sistema de Gas-lift 41 

Por causa disso, outra abordagem proposta são os controladores baseados 

em modelo, que levam em consideração as não linearidades do processo 

conhecidos por uma modelagem simplificada e podem naturalmente trabalhar 

com estruturas multivariáveis. 

 Di Meglio et al. (2012) apresentam uma estrutura de controle baseada na 

linearização da dinâmica da massa de líquido no oleoduto, controlada pela choke. 

Os autores demonstram experimentalmente o desempenho superior desta frente 

ao PI, em uma estrutura monovariável de controle de pressão de fundo pela 

manipulação da choke.  

Jahanshahi et al. (2012) estendem o conceito para sistemas multivariável 

Multiple Input Multiple Output (MIMO) para diversas combinações de variáveis 

candidatas controladas pelas choke e de gás. No trabalho, apesar de estabilizar 

operacionalmente o sistema, o autor conclui que a adição de uma segunda 

variável manipulada não beneficia o desempenho em termos de produção, 

apresentando menor ganho. 

Mesmo com o sucesso, ressalta-se que o método de linearização pode não 

ser robusta o suficiente para diversos pontos de operação, necessitando de 

técnicas on-line de manutenção de modelo (DI MEGLIO, FLORENT et al., 2012). 

Mesmo com uma estrutura de controle bem definida a fim de tratar as não 

linearidades e os atrasos de sinal, a incapacidade dos controladores disponíveis 

em lidar com as restrições físicas dos sistemas limitam o desempenho do 

controle, como demonstrado por Storkaas (2005) e identificado por Di Meglio et al. 

(2012). 

No contexto real, as limitações inerentes às válvulas típicas em sistemas 

upstream, chamadas choke de passo, ilustrado na Figura 2.18.A. Essas válvulas 

possuem posicionadores do tipo engrenagem, com ilustrado na Figura 2.18.B, 

com amostragem discreta e resolução em função da rotação, que implicam em 

bandas mortas de manipulação podendo inviabilizar o controle (KITTILSEN et al., 

2016).  



42  Sistemas de Produção de Petróleo por Gas-lift 

 

A. 

 

B. 

 
Figura 2.18: A. Válvula Choke. B. Atuador do tipo Engrenagem (MASTERFLO, 

2011). 

Neste sentido, por tratar com naturalidade tais limitações o Controle 

Preditivo Baseado em Modelo se apresenta como candidato potencial a superar 

as limitações elencadas (MACIEJOWSKI, 2002). 

Controle Preditivo Baseado em Modelo (MPC)  

O Controle Preditivo Baseado em Modelo (ou Model Predictive Control) não 

é uma estratégia de controle por si só, mas um amplo método de controle 

avançado baseado no uso explícito de um modelo a fim de predizer o 

comportamento do processo num tempo futuro.  

Através de um algoritmo de otimização, o controlador calcula as ações de 

controle futuras, em estrutura mono ou multivariável, necessárias para a 

minimização de uma função objetivo que leva em consideração as restrições 

físicas do processo (CAMACHO; BORDONS, 1999). A utilização das restrições 

físicas e operacionais é uma vantagem da utilização dessa estratégia.  

Industrialmente, além das restrições físicas como a descritas no parágrafo 

acima, os processos industriais possuem restrições operacionais relacionadas a 

custos diretos e custos de energia e que devem ser minimizados e mantidos no 

menor valor possível (MACIEJOWSKI, 2002).  

O algoritmo ainda utiliza informações do comportamento do processo ao 

longo de um horizonte futuro sendo capaz de antecipar e remover os efeitos de 

file:///C:/Users/giovanig/Dropbox/02 - ACADÊMICO/02 - MESTRADO/01 - Dissertação/DISSERTACAO/Pneumatic Stepping Actuator (Top View).wmv


2.4 Controle de Produção em Sistema de Gas-lift 43 

distúrbios medidos (intrinsicamente feedfoward e feedback), permitindo que o 

controlador encaminhe o processo o mais perto possível de uma trajetória ótima 

desejada. Os avanços tecnológicos estão se sobrepondo às desvantagens 

associado à carga computacional necessária e o MPC vem ganhando espaço 

(QIN; BADGWELL, 1998).  

Utilizando este método Ribeiro et al. (2016) demonstraram as vantagens da 

utilização desta estrutura em sistemas de produção offshore pra um potencial uso 

em sistemas reais. Gustavsen e Tondel (2009) aplicam o MPC em uma estrutura 

multivariável de controle de pressão para uma rede de três poços.  

Entretanto, devido à dependência da qualidade do modelo no seu 

desempenho, como Ribeiro et al. (2016) salienta, que devido ao fato de o 

processo com o GL ter uma característica altamente não-linear, o desempenho do 

MPC pode ser prejudicado, uma vez que o método se utiliza de uma versão 

linearizada do modelo dinâmico.  

O Controle Preditivo Não Linear (NMPC) tem por objetivo atuar no sistema 

numa faixa de processo grande o suficiente para captar a dinâmica e atuar de 

forma eficaz (MACIEJOWSKI, 2002; QIN; BADGWELL, 1998).  

Salahshoor et al. (2013) utilizaram uma estrutura NMPC demonstrando o 

potencial do método ao estudar o controle multivariável MISO de um sistema de 

GL com distúrbios de reservatório. A complexidade desta estrutura, maior do que 

as apresentadas anteriormente, associada ao fato de o modelo utilizado no 

controlador ser do tipo caixa preta necessitando de uma atualização constante 

podem inviabilizar a técnica proposta pelos motivos já mencionados na Seção 

2.3.1 (RIBEIRO, C.H.P. et al., 2016).  

Codas et al. (2016) utilizam um algoritmo de NMPC econômico para o 

controle e otimização de uma rede de dois poços através da manipulação da 

choke e da pressão no separador. Os resultados mostram o avanço e a 

variabilidade na aplicação do NMPC, mas esbarram em custo computacional e 

amostragem do sistema de trinta minutos, o que é demasiadamente grande 

quando comparado ao ciclo da golfada em sistemas com menor frequência.  

Na mesma linha de pensamento, Plucenio et al. (2009) propõem o 

chamado Practical Nonlinear Predictive Control (PNMPC) para aplicação 

multípoço.  



44  Sistemas de Produção de Petróleo por Gas-lift 

 

Diante dos métodos expostos acima o NMPC demostrou um grande 

potencial para aplicação em sistemas reais offshore. Como pode ser observado 

na Tabela 2.2, comparada às demais estruturas, o NMPC trata as restrições do 

sistema naturalmente com a possibilidade do emprego de estruturas 

multivariáveis.  

Tabela 2.2: Comparação entre as técnicas de Controle de Golfadas. 

 
Controle 

Linear 
(PI / PID)  

Controle Não 
Linear 
(PI/PID 

gainscheduling) 

Controle 
Baseado em 

Modelo 
 MPC  NMPC 

Estrutura SISO Sim Sim Sim Sim Sim 
Estrutura MIMO Não Não Sim Sim Sim 
Robustez Não Sim Não Não Sim 
Método de 
Ajuste para 
Golfadas 

Disponível Disponível 
Não- 

Disponível 
Não- 

Disponível 
Não- 

Disponível 

Inclusão das 
Restrições 

Não Não Não Sim Sim 

Complexidade de 
Aplicação 

Baixa Média Média Alta Alta 

 

Devido ao problema observado para Codas et al. (2016) relativo ao tempo 

computacional e à alta complexidade de aplicação, neste trabalho será proposto o 

uso do controlador NMPC, utilizando o algoritmo LLT (DURAISKI et al., 2002), 

para dirimir tais limitações. O algoritmo minimiza o custo computacional pela 

sucessiva resolução de modelos linearizados ao longo da trajetória de controle. O 

algoritmo será detalhado no Capítulo 4. 

 



 

45 

 Modelo Simplificado 

O sucesso de uma estrutura de controle preditivo é dependente do modelo 

matemático utilizado para a predição de comportamentos futuros do processo.  

Como mencionado na Seção 2.4.1, a discrepância do modelo ao sistema 

real inviabiliza a aplicação da técnica. Por este motivo, o modelo a proposto 

deverá agregar as características da batimetria de um sistema tipicamente 

profundo / ultra profundo.  

Assim, neste capítulo, o desenvolvimento do modelo será detalhado na 

Seção 3.1. Alternativas de aplicação do modelo para correção da descontinuidade 

do modelo e da representatividade de outros fenômenos serão apresentadas na 

Seção 3.1.1.  

Uma análise dos parâmetros de estimação para adaptação do modelo a 

poços reais será desenvolvida na Seção 3.2, baseado na convexidade da função 

objetivo, Seção 3.2.1, a fim de justificar o método apresentada na Seção 3.2.2. 

3.1 Modelo Simplificado de Produção por GL 

Com o objetivo de obter um modelo simples para fins de controle que se 

adeque intuitivamente a poços de produção de petróleo offshore em regiões 

profundas e ultra profundas, o desenvolvimento partiu dos trabalhos 

desenvolvidos por Jahanshahi et al.(2012) e Di Meglio et al.(2012).  

A escolha foi resultado de uma análise qualitativa da Tabela 2.1, resumida 

na Tabela 3.1. A partir destes modelos foi desenvolvido um trabalho colaborativo 



46  Modelo Simplificado 

 

entre o Centro de Pesquisa da Petrobras (CENPES) e o grupo de trabalho da 

GIMSCOP que resultou na publicação do chamado FOWM - Fast Offshore Well 

Model (DIEHL et al., 2017).  

O modelo apresentado neste trabalho foi elaborado em uma etapa 

subsequente de estudos que gerou o modelo proposto por DIEHL et al.(2017). 

Existem diferenças estruturais, sendo a principal a inserção de um fator corretivo 

do volume do Riser proposto por Diehl et al. (2017), mas não significativas em 

termos de representatividade.  

Além do mais, neste trabalho são apresentadas alternativas para 

representação da onda de densidade, também indicada na Tabela 3.1, e uma 

alternativa ao cálculo das vazões mássicas que retira a descontinuidade 

relacionadas da função max, como será decrito nas seções que seguem. 

Tabela 3.1: Modelos existentes aderentes às novas necessidades. 

Autores 
Di Meglio  

et al. (2009) 
Jahanshahi  
et al. (2012) 

Novo Modelo 
(Este Trabalho) 

FOWM 
Diehl et al. 

(2017) 

Dinâmica do 
Reservatório 

Não Linear Bifásico 
Não linear 
Bifásico 

Não linear 
Bifásico 

Tubing Não Sim Sim Sim 

Anular Não Sim Sim Sim 

Pipeline/Riser Sim Não Sim Sim 

Estimação de PDG Não Não Sim Sim 

Onda de Densidade Não Não Sim* Não 

Descontinuidade Sim Sim Não* Sim 

 * - Representação diante de modificação estrutural 

No Novo Modelo Simplificado de Produção por GL, três partes principais do 

processo de extração, acoplando os dois modelos existentes, ilustrado na 

Figura 3.1: Reservatório, Poço (Anular e Tubing) e Linha de Produção (Pipeline e 

Riser). 

Em um primeiro momento estes dois modelos foram acoplados para 

representação do Sistema Anular-Tubing-Pipeline-Riser e posteriormente 

aprimorados para atender as necessidades inexistentes nos trabalhos já 

realizados. 



3.1 Modelo Simplificado de Produção por GL 47 

 
Figura 3.1: Representação do Novo Modelo Simplificado de Produção por GL de 

um sistema Reservatório-Poço-Linha de Produção em sistemas offshore. 

(Reservatório – Preto; Poço – Verde; e Linha de Produção – Azul). 

O Fluxo de Produção do Reservatório (??) vem da sua dependência da 

energia disponível com a resistência estática da coluna de produção. Objetivando 

a inclusão da característica não linear desta relação, no novo modelo, foi incluída 

a equação desenvolvida por Vogel (1968): 

 Wr = Kr (1 ? (0.2
Pbh

Pr
) ? (0.8

Pbh

Pr
)

2

) (3.1) 

onde, ???  é a pressão no fundo do Poço, ??  é a pressão do reservatório, 

assumida constante devido à dinâmica lenta frente ao ciclo da golfada, e ?? é o 

coeficiente de fluxo do Reservatório correspondente à máxima produção do poço.  



48  Modelo Simplificado 

 

A partir deste ponto, a modelagem do Poço e da Linha de Produção é 

diretamente dinâmica e reproduzida por seis EDO’s e nas premissas introduzidas 

na Seção 2.3.1.  

A região do Poço é representada por três equações diferenciais que 

descrevem o balanço de massa das duas regiões para cada fase (gás e líquido). 

Na região do Anular há apenas a presença de gás e a variação de massa no 

compartimento (
????

??
) é função da massa injetada no poço através do gás de 

elevação (???) e a energia que efetivamente afeta a coluna de produção através 

da válvula de injeção (???). Isso se traduz por: 

 
dmga

dt
= Wgl –  Wiv (3.2) 

onde, ??? é a massa de gás no Anular, ???  e ??? são os fluxos de massa de 

gás entrando no Anular e saindo através da válvula de injeção, respectivamente. 

A região do Tubing é onde ocorre a interação do fluxo de produção do 

reservatório, ??, e a Injeção de energia no sistema, ???.  

Esta é a região onde ocorre a ação efetiva da técnica de GL e o regime 

multifásico líquido-gás e o balanço é individualizado para cada fase, conforme 

premissa 1 da Seção 2.3.1. Á media que o gás proveniente do Reservatório (Wr ?

?gr) e se mistura com o gás proveniente do anular a fração mássica do meio 

(?gt),que é calculada pela relação proporção de entre as massas das fases, se 

altera.  

Consequentemente o fluxo de entrada de líquido [Wr (1 ? ?gr)] e o fluxo 

multifásico através da ANM (???) sofrem influência e o comportamento é dado 

por: 

 
dmgt

dt
= (Wr ?gr) + Wiv – (Wwh ?gt) (3.3) 

 
dmlt

dt
= [Wr (1 ? ?gr)]– [Wwh (1 ? ?gt)] (3.4) 

 ?gt  =
mgt

mgt+mlt
 (3.5) 



3.1 Modelo Simplificado de Produção por GL 49 

onde, ??? e ??? são as massas de gás e líquido no Tubing, respectivamente; ??? 

e ???  são as frações mássicas de gás no reservatório e no Tubing, 

respectivamente; e ???  é a vazão mássica de produção através da Choke da 

Árvore de Natal.  

A Linha de Produção é representada por outras três equações diferenciais 

que descrevem a admissão do fluxo proveniente da ANM (???) e descarga de 

produção (????) . Assim como para a região do Poço, a corrente de entrada 

bifásica é segregada para fase gás (Wwh ?gt) e óleo [Wwh (1 ? ?gt)]. Isto faz com 

que as irregularidades provenientes da dinâmica Anular-Tubing se propaguem 

para o Pipeline-Riser.  

A fim de agregar a informação da geração do mecanismo de Golfada por 

Acidente, o modelo incorpora o artifício proposto por Di Meglio et al. (2009), que 

insere uma “válvula virtual” no ponto de inflexão e ascensão da tubulação. Este 

recurso possibilita a representação de forma simplificada o acúmulo de 

gás/líquido e a consequente geração da golfada, como representado no detalhe 

da Figura 3.1.  

Uma fração do gás proveniente da ANM se acumula à jusante da válvula 

(1 ? E)(Wwh ?gt) e conforme as características dinâmicas do ciclo descarrega a 

massa de gás acumulada na bolha (???) para o Riser, através da válvula (??), 

somando à outra fração de gás E (Wwh ?gt) que “by-passa” a inflexão. O balanço 

é fechado pelo fluxo de produção através da choke (????), segregado pela razão 

de massas no Pipeline/Riser (???): 

 
dmgb

dt
= (1 ? E)(Wwh ?gt)– Wg (3.6) 

 
dmgr

dt
= E (Wwh ?gt) + Wg ? (Wout ?gp) (3.7) 

 
dmlr

dt
= [Wwh(1 ? ?gt)]– [Wout(1 ? ?gp)] (3.8) 

 ?gp  =
mgr

mgr+mlr
 (3.9) 

onde, ??? é a massa de gás acumulada na bolha à jusante da “válvula virtual” no 

Pipeline, ???  e ???  são as massas de gás e líquido no Riser; ??  é o fluxo 

mássico de gás através da válvula virtual; ? é a fração de gás que by-passa a 



50  Modelo Simplificado 

 

“válvula virtual”; ???? é o fluxo de produção através da choke; e ??? é a fração de 

gás presente no Pipeline-Riser. 

Não diferente dos modelos matrizes e considerando a premissa 2 da Seção 

2.3.1, para o cálculo dos fluxos de massa, o novo modelo utiliza equações 

simplificadas de válvula, desconsiderando as características multifásicas 

presentes na ANM e na choke.  

Pela relação entre a variação de pressão à jusante e à montante da válvula 

e a capacidade da válvula os fluxos são determinados.  

Numa consideração inicial, assume escoamento laminar apenas para a 

“válvula virtual”, uma vez que o fluxo nesta é monofásico: 

 Wg = Kg max (0, (Peb ? Prb)) (3.10) 

onde ??? é a pressão da bolha alongada, ??? é a pressão à jusante da válvula 

virtual exercida pela coluna de ascensão do Riser e ?? é a constante da válvula 

virtual.  

Para o cálculo dos demais fluxos assume-se a relação não linear entre ?P 

e W para que as características principais das válvulas de injeção e do fluxo 

bifásico não sejam totalmente perdidas. Assim: 

 Wiv = Ka??ai max (0, (Pai ? Ptb)) (3.11) 

 Wwh = Kw??L max (0, (Ptt ? Prb)) (3.12) 

 Wout = Kout ?? ??L max (0, (Prt ? Ps)) (3.13) 

onde ??? é a pressão no ponto de injeção de gas de elevação no Anular, ??? é a 

pressão no ponto de injeção de gás de elevação no Tubing, ??? é a pressão na 

ANM (topo do Tubing), ??? é a pressão no topo do Riser; ??? é a massa específica 

do gás no Anular, ?? é a massa específica do óleo produzido; ??, ?? ? ???? são 

os coeficientes de fluxo das válvulas de injeção, da ANM e de produção, 

respectivamente; e ?? é a abertura da choke.  



3.1 Modelo Simplificado de Produção por GL 51 

Para a convergência numérica, o artifício numérico “max” é utilizado em 

todas as equações de fluxo, que seleciona o maior valor entre o calculado e zero, 

evitando fluxo reverso. 

As pressões das fases gás e as massas específicas do meio são obtidas 

pelo desenvolvimento das premissas 3 (Gás ideal) e 4 (Temperatura constante) 

da Seção 2.3.1 em três pontos principais: à montante da válvula de injeção 

(???, ???), na ANM (???, ???) e na bolha virtual (???). Para tanto, têm-se: 

 Pai = (
R  T

Va Mm 
+

g  La

Va 
)  mga (3.14) 

 ?ai =
M Pai

R T
  (3.15) 

 Ptt =
mgt R T

Vgt M
 (3.16) 

 ?mt =
mgt+mlt

Vt
  (3.17) 

 Peb =
mgb R  T

Mm Veb  
  (3.18) 

onde, R é a constante universal dos gases, Mm é a massa molar do gás de 

elevação; g é a constante gravitacional, T é a temperatura do sistema, ?? e ?? 

são o comprimento e o volume do Anular, respectivamente, ??? é o volume de gás 

no Tubing, ??  é o volume do Tubing e ???  é o volume da bolha acumulado à 

montante da “válvula virtual” no Pipeline, que regula a dinâmica do ciclo 

intermitente. 

A partir destas, é possível calcular as demais pressões, que no novo 

modelo desconsideram as perdas de carga na tubulação, anteriormente 

calculadas por Jahanshahi et al.(2012), diminuindo a rigidez numérica. Esta 

premissa é valida, pois conforme introduzido na Seção 2.4, a região ótima de 

operação de sistemas de GL é caracterizada pela dominância das perdas 

estáticas ? ? g ? ??. Assim, a determinação das demais pressões do Poço são 

dadas por: 

 Pbh = Ppdg + ?mt g (Ht ? Hpdg) (3.19) 

 Ppdg = Ptb + ?mres g (Hpdg ? Hvgl) (3.20) 



52  Modelo Simplificado 

 

 Ptb = Ptt + ?mt g Hvgl (3.21) 

onde, ?? é o comprimento do Tubing, ???? é a distância do leito do mar até o 

medidor de pressão no Tubing, ???? é a distância do leito do mar até o ponto de 

injeção de gás de elevação no Tubing. 

Para o cálculo das pressões no Riser é levado em conta um holdup mínimo 

ou acúmulo mínimo de massa de líquido a montante da inflexão (???????), de forma 

que: 

 Prb = Prt +
(mlr+mLstill) g sin(?)

A
  (3.22) 

 Prt =
mgr R T

Mg (Vr?
mlr+mLstill

 ?L
 )  

  (3.23) 

onde, ?? e ? são o volume e a área da seção transversal do Riser; ?? é a massa 

específica do líquido no riser, ??????? é a massa mínima de líquida no Riser, e ? é 

a inclinação do ponto de inflexão do Pipeline-Riser. 

Os cálculos geométricos são dados por: 

 Va =
La ? Da

2

4
 (3.24) 

 Vgt = Vt ?
mlt

?L
  (3.25) 

 Vt = Lt A (3.26) 

 A =
? Dr

2

4
 (3.27) 

onde,  ?? ?  ??  são os diâmetros equivalente do Anular e Tubing, 

respectivamente. 

Em síntese, o novo Modelo Simplificado de Produção por GL é um sistema 

de equações composto por um total de seis ODE’s com seis estados dinâmicos 

(??? , ???, ???, ???, ???, ??? ). A partir de quatro entradas de processo 

(???, ??, ?? ? ??) e vinte e cinco parâmetros é possível predizer, com e vinte e 

uma EA’s, sete diferentes pontos de pressão ao longo do processo. Destas, três 

diretamente ligados às variáveis de processo disponíveis ????, ??? ? ????. 



3.1 Modelo Simplificado de Produção por GL 53 

Para resolução do modelo apresentado, nesta dissertação foi utilizada a 

plataforma Matlab/Simulink. Os detalhes da linguagem das implementações e os 

métodos utilizados para resolução numérica dos modelos encontram-se no 

Apêndice B –. 

3.1.1 Alternativa Modelo 

O desenvolvimento do novo modelo teve como premissa determinante o 

custo computacional, uma vez que o mesmo será utilizado em um algoritmo de 

controle com baixa taxa de amostragem. Por isso, equações de válvula foram 

simplificadas e a perda de carga dinâmica negligenciada. Essas premissas trazem 

o ônus da não representatividade da onda de densidade e a indeterminação da 

função de cálculo da válvula ao se utilizarem métodos baseado em derivada.  

Por este motivo, foram desenvolvidas duas variações do modelo para tratar 

estas fragilidades. Por questões de espaço, os resultados mostrados neste 

trabalho utilizam apenas a primeira versão do modelo e as variações serão 

apenas apresentadas a seguir.  

Válvula Venturi (ou Orifício Venturi) 

As regiões de escoamento são dependentes das velocidades de 

escoamento das fases e consequentemente das vazões mássicas do sistema. 

Para o novo modelo simplificado, as vazões são calculadas por uma relação 

direta ao diferencial de pressão por uma equação linear em relação ao parâmetro 

de ajuste, traduzidas pela equação 3.11.  

Alguns sistemas de elevação utilizam válvulas de injeção chamadas do tipo 

Venturi ou Orifício Venturi. Estas são projetadas para trabalhar com velocidades 

supersônicas, que podem ocasionar a golfada do tipo onda de densidade descrito 

(Seção 2.2.2). A válvula opera como um filtro de pressão atingindo um patamar de 

vazão dependente apenas da pressão de entrada do sistema, como pode ser 

visto na .A.  

Na tentativa de melhor ajustar a equação 3.11 ao comportamento da 

válvula Venturi, o parâmetro ??  da Equação 1 é estimado para descrever a 

dinâmica. Utilizando um método de otimização não linear sem restrições (função 

fminunc do Matlab) o resultado não capta a dinâmica correta, como reproduzido 

na .B. 



54  Modelo Simplificado 

 

Assim para que o modelo capte esta dinâmica, uma nova função para 

substituição da equação 3.11 é proposta a seguir: 

 Wiv2 = Kv Pin [
 a (Pin?Pout)

2 ?Pin+? (Pin?Pout) ?Pin+?

1+? (Pin?Pout)
2 ?Pin

] (3.28) 

onde a, b, c e d são a parâmetros a serem estimados a partir da curva de teste do 

fornecedor (.A). Com esta equação, é possível captar a dinâmica, como pode ser 

visualizado no ajuste realizado para Pin = 280kgf/cm² na .B. 

A. 

 

B. 

 

Figura 3.2: (A) Perfil de vazão de Válvulas Venturi para diferentes pressões de 

entrada, em um sistema de elevação de petróleo. (B) Ajuste da equação do 

modelo simplificado (Wiv1) e da nova proposta (Wiv2) ao perfil de pressão de 

entrada igual a 280 kgf/cm². 

Esta alternativa agrega uma etapa anterior de ajuste do modelo que 

depende da curva da válvula e aumenta 10% o custo computacional. 

Descontinuidade da Função de Vazão 

As funções de cálculo das vazões apresentam uma descontinuidade devido 

ao operador máximo (“max”). Como a função original previne o fluxo reverso, no 

momento em que o delta de pressão (??1 = ?1 ? ?2) torna-se negativo, a função 

zera, onde ?1 = ??á?(0, ??). Este comportamento torna a derivada da função 

indefinida, inviabilizando a aplicação de métodos de otimização baseado na 

derivada, como ilustarado na Figura 3.3.A.  

Para tratar este problema, é possível uma substituição da equação original 

de fluxo pela seguinte expressão: 

0 50 100 150 200 250 300
0

0.5

1

1.5

2

2.5

3
x 10

5

dP [kgf/cm²]

V
a
z
ã
o
 [
m

³/
d
]

Pin

P
in

 = 280 kgf/cm²

P
in

 = 200 kgf/cm²

0 50 100 150 200 250 300
0

1

2

3

4
x 10

5

dP [kgf/cm²]

V
a
z
ã
o
 [
m

³/
d
]

 

 

Expl

W
iv1

W
iv2



3.2 Estimação de Parâmetros 55 

 dP2 =
dP1+ ?dP1

2+?

2
 (3.29) 

onde ? é um fator de suavização. Como pode ser visto na Figura 3.3.B, em 

vermelho, a nova função, para ? = 0,1, suaviza a transição, evitando o refluxo e a 

descontinuidade da função original.  

A. 

 

B. 

 

Figura 3.3: Diferença de comportamento entre a função original f1 e a 

descontinuidade gerada em diff(f1) e a nova equação proposta f2 com a 

suavização do comportamento da derivada diff(f2). 

Para substituição no modelo, o fator de suavização deverá ser definido a 

fim de manter a baixa velocidade e a acuracidade do modelo. Apesar de simples, 

se comparada a modificação da válvula Venturi, a nova equação aumenta o custo 

de cálculo, em tempo de resolução numérica, em 35%. Além disso, a amortização 

implica numa parametrização diferente do modelo original. Para melhor 

visualização, os sinais da derivada das funções na Figura 3.3.A e B foram 

normalizados. 

3.2 Estimação de Parâmetros 

Para reprodução de sistemas reais através do novo modelo simplificado se 

faz necessária a definição de um método para determinação dos vinte e cinco 

parâmetros.  

Dentre estes, sete, ditos Parâmetros Físico-químicos, indicam as 

constantes físico-químicas do processo, os quais podem ser obtidos diretamente 

pelas informações de processo.  

Outros nove parâmetros, ditos Parâmetros Físicos, remetem às constantes 

físicas do sistema offshore e como já indicado na Figura 3.1 são diretamente 

estipulados pela arquitetura do poço. 

-1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1
-1

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

1

dP

f(
d
P

)

 

 

dP
1

f
1

diff(f
1
)

-1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1
-1

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

1

dP
f(

d
P

)

 

 

dP
2

f
2

diff(f
2
)



56  Modelo Simplificado 

 

Os nove parâmetros restantes, ditos Parâmetros de Estimação, permitem 

que o modelo seja adequado para a representação de plantas reais. A Tabela 3.2 

complementada pela Figura 3.1 apresentam a descrição destes parâmetros do 

modelo e a indicação física ou virtual dos mesmos no processo de GL. 

Tabela 3.2: Resumo das Constantes e dos Parâmetros do Modelo Simplificado. 

 Físico-
Químico 

Descrição 
 

 Físicos Descrição 
 De 

Estimação 
Descrição 

G 
Aceleração 

Gravitacional 

 
Da 

Diâmetro 
equivalente do 

anular 

 
E 

Fração de gás 
preso na bolha  

Mm 
Massa molar do 
gás de elevação 

 
Dt Diâmetro do Poço 

 
Ka 

Coeficiente de 
fluxo da injeção 

T 
Temperatura 

média 

 
D Diâmetro do Riser 

 
Kg 

Coeficiente de 
fluxo da válvula 

virtual  

R 
Constante dos 

gases 
 

La 
Comprimento do 

Anular 
 

Kout 
Coeficiente de 
fluxo da choke 

?gw 
Fração de gás 
no reservatório 

 
Lt 

Comprimento do 
Poço 

 
Kw 

Coeficiente de 
fluxo da ANM 

?L 
Massa 

específica do 
óleo produzido 

 
Hpdg 

Distância vertical 
entre a ANM e a 
medição de PDG 

 
Kr 

Vazão mássica 
estimada para o 

poço 

?mres 

Massa 
específica da 

mistura no 
reservatório 

 

Ht 
Distância vertical 
entre a ANM e o 
fundo do poço 

 

mLstill 
Massa mínima de 
líquida no Riser 

holdup 

  

 

Hvgl 

Distância vertical 
entre a ANM e o 

ponto de injeção de 
gás 

 

Veb 
Volume da bolha 

alongada 

  
 

? 
Ângulo de Inclinação 

do Riser 

 
Vr 

Volume à 
montante da 
válvula virtual 

 

A tarefa de estimação dos parâmetros não é simples, uma vez que o 

sistema possui seis estados dinâmicos não medidos e apenas informações de 

entrada de processo e três medições disponíveis (????, ??? ? ????).  

Além disso, o comportamento cíclico do sistema multifásico, introduzido na 

Seção 2.2, pode ser um problema na replicação de métodos difundidos de 

estimação de parâmetros, como Mínimos Quadrados ( ??? ). Estudos com 

dinâmicas semelhantes mostram a dificuldade de se estimar os parâmetros com 

métodos clássicas (SIONG, 2009; WANG; BOVIK, 2009). 



3.2 Estimação de Parâmetros 57 

Assim, a necessidade de um procedimento mais eficiente para a estimação 

desses parâmetros é um ponto chave na aplicação de controladores preditivos. 

Neste trabalho, o método propõe a modificação da clássica ??? para penalização 

de respostas indesejadas fazendo o uso de um algoritmo global de otimização. A 

seguir o método é apresentado e justificado.  

3.2.1 Não Convexidade do Objetivo 

A formulação clássica da função ??? é dada por: 

 ??? = ?
[?????(??)]

2

?

?
?=1  (3.30) 

onde “i” é o componente dentro do intervalo contendo “n” observações; x é o valor 

de referência medido e y o valor simulado e função dos parâmetros de estimação 

??. Num primeiro momento, a não convexidade desta abordagem foi analisada 

frente aos parâmetros de ajuste para as três mediadas disponíveis.  

Como identificado para uma microrregião de ???????  (Figura 3.4.A), a 

resposta do ???  é extremamente ruidosa. Numa análise mais ampla e da 

iteração com outro parâmetro, ?? , (Figura 3.4.B), a ocorrência de regiões de 

mínimo é evidenciada.  

A.

 

B.  

 

Figura 3.4: Convexidade da função objetivo ??? : A. em relação a microrregião 

2D de ???????; e B: a macro região 3D de ??????? e ??. 

Com isso, o presente trabalho propõe a modificação da função 

objetivo,para suavizar o comportamento ruidoso e a elevada não convexidade, 

pela inclusão na função objetivo de um termo de penalidade, ?, calculado por: 

1850 1900 1950 2000 2050 2100
0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

mlstill

M
S

E

 

 

PDG

TPT

PTop



58  Modelo Simplificado 

 

 ? = ?
[

???
???

?
???(??)

???
]

2

?

?
?=1 [??? ? ??? (??)]

2
 (3.31) 

onde, o primeiro termo (???? ) representa o erro quadrático da derivada e o 

segundo termo (????) é o erro quadráticos do período de oscilação. A derivada é 

calculada numericamente (
???

??
=

??????1

??
) e o período calculado pela identificação 

dos vales do sinal.  

A relação dada por uma multiplicação do período e a derivada do erro é 

feita a fim de manter a dimensão do problema. O ??? é dado em unidades de 

pressão (Pa), ????  em unidade de pressão por tempo (Pa/s) e ????  em 

unidade de tempo (s), mantendo a significância estatística do MSE. Uma vez que 

no momento em que o Período e Fase do sinal medido é igual ao do sinal de 

referência são correspondentes, o segundo termo zera, mantendo somente o erro 

quadrático.  

Assim, a função objetivo proposta é dada por: 

 ?(??) = ??? + ?  (3.32) 

Como pode ser visto na Figura 3.5, a utilização da penalização acentua 

regiões não cíclicas, como ilustrado pela Figura 3.5.B, que representa a resposta 

bidimensional do termo ( ???? x ???? ). Dessa forma, a nova abordagem de 

função objetivo, ?(??), salientada a dinâmica desejada, como pode ser visualizado 

na Figura 3.5.C, que ilustra a resposta da nova função objetivo.  

A.  

 

B.  

 

C.  

 

Figura 3.5: Convexidade, frente aos parâmetros ??????? e ??, dos componentes 

da função objetivo (A) para ???, (B) para penalização ?; e (E) da nova proposta 

?(??). 



3.2 Estimação de Parâmetros 59 

As implicações da alta não convexidade da função de ??? , frente ao 

ajuste, será melhor analisada nos resultados, bem como a suavização da 

penalização proposta será ilustrada no Capítulo 5. 

3.2.2 Método de Ajuste  

Como ilustrado acima, numa breve análise macro, a sensibilidade entre 

dois parâmetros gera diferentes pontos de mínimos locais na superfície de 

resposta da função objetivo, ainda com a suavização. O problema abordado neste 

trabalho apresenta nove parâmetros, o que aumenta a complexidade do 

problema. Isto nos leva a crer que a ocorrência de múltiplas regiões de mínimo 

será ainda maior, Esta característica nos leva a utilização de métodos globais de 

otimização (SIONG, 2009).  

A fim de tratar as características, o método de otimização utilizado é o 

algoritmo DIRECT. O algoritmo é uma alternativa de busca global, que divide 

sequencialmente o espaço de busca em retângulos. Assim que atingidos critérios 

de parada, ele retorna os parâmetros correspondentes à mínima função objetivo 

avaliada na busca. Maiores detalhes do algoritmo podem ser vistos em (FINKEL, 

2003).  

Assim, o método de estimação dos parâmetros é sequencial, iniciada pela 

coleta de dados. Nesta, o intervalo escolhido deverá possuir entradas constantes. 

De posse dos dados de produção aproximados (vazão de produção máxima e 

mínima) é possível, assumindo comportamento estacionário, estimar o intervalo 

dos parâmetros diretamente relacionados à vazão (??, ??, ????,  ?? e ??).  

Os parâmetros ligados ao holdup de líquido no poço (???????, ??? e ??) são 

determinados pela energia disponível no reservatório ( ?? ) e o tamanho das 

tubulações de encaminhamento (??e ?) 

Num primeiro momento, com o intervalo calculado, o algoritmo de 

otimização é executado até atingir o número máximo de avaliações dentro do 

espaço de busca. Para suavizar a ação do algoritmo, as saídas (x e y) são 

escalonadas pelo valor mínimo da referência x.  

Sequencialmente a partir do resultado anterior, o intervalo de busca vai 

sendo restringido “n” vezes, até que o valor obtido na etapa “n” seja igual ao “n-1”. 

A sequência de ajuste está ilustrada no fluxograma da Figura 3.6. 



60  Modelo Simplificado 

 

 

Figura 3.6: Método de estimação de parâmetros. 

Análise de Identificabilidade 

A análise de Identificabilidade é uma ferramenta utilizada para a 

identificação de parâmetros de modelos dinâmicos, tendo por objetivo quantificar 

a dependência entre as saídas e os parâmetros de estimação do modelo.  

Neste trabalho, a fim de avaliar essa dependência como uma forma de 

atualização de parâmetros ao longo da aplicação, foi aplicada o método proposta 

por Botelho et al. (2012).  

A partir de conceitos da teoria de controle utilizando a matriz NSRGA (Non 

Square Relative Gain Array). A matriz de ganhos é obtida através da matriz de 

sensibilidade ( Si,j ) do sistema, obtida através do cálculo da sensibilidade do 



3.2 Estimação de Parâmetros 61 

sistema. Este, definido pela Matriz de Sensibilidade (Si,j), que é uma matriz de 

ganhos envolvendo as saídas em função dos parâmetros, sendo definida por: 

 Si,j =
?yi

??j
 (3.33) 

onde ???  corresponde a faixa de variação do sinal de saída, sendo “i” 

número de saídas e  ??? corresponde à faixa de variação dos parâmetros, sendo 

“j” o número de parâmetros de estimação. Como saídas do modelo foram 

analisadas os valores absolutos, médios, derivadas, amplitude, período e fase de 

????, ??? e  ????. Dessa forma a matriz S é uma madriz retangular onde “i” é igual 

a dezoito e “j” é igual a nove.  

É necessário um conhecimento prévio do comportamento da dinâmica para 

determinar ???. Neste trabalho, devido a não linearidade do sistema, foi utilizada 

uma variação de ±?%  dos valores de referência no cálculo numérico das 

derivadas, as quais foram estimadas através do uso de diferenças centrais.  

Para o cálculo da NSRGA, devido a diferença de magnitude das saídas, o 

escalonamento de S é feito através da resolução de um problema de otimização 

que visa determinar as matrizes de escalonamento que levam o sistema ao 

condicionamento mínimo (Sescal), como detalhado em Botelho et al. (2012).  

De posse da Sescal é possível calcular a matriz NSRGA, ordenando assim a 

impacto (I) dos parâmetros frente às saídas: 

 NSRGAi,j = Sescal.? Sescal
+T  (3.34) 

onde Sescal +T são as matrizes de sensibilidade e sua pseudo-inversa, 

respectivamente, das saídas em relação aos estados. Por fim, é definido para 

cada parâmetro de estimação, um índice de impacto Ij, calculado por: 

 Ij =
? |NSRGAi,j|

i
0

máx(? |NSRGAi,j|
i
0 )

   (3.35) 

Através deste índice, é possível determinar qual parâmetro tem maior 

impacto na mudança de dinâmica do sistema e com isso, acredita-se agregar ao 

trabalho, uma sistemática de atualização on-line de parâmetros do modelo. 

  



62  Modelo Simplificado 

 

 



 

63 

  Estratégia de Controle 
Preditivo Não Linear – NMPC 

Nesse capítulo será apresentada o método de controle proposta. Para isso, 

inicialmente será apresentada uma análise da dinâmica do processo de GL, na 

Seção 4.1, fazendo uso do novo modelo simplificado, a fim de justificar o emprego 

do Controle Preditivo Não Linear. Na seção seguinte, o algoritmo LLT será 

apresentado juntamente com as diferentes estruturas de controle propostas. 

4.1 Dinâmica do Sistema de Gas-lift  

Sistemas de elevação de petróleo, conforme o ponto de operação, 

possuem características oscilatórias, como já mostrado na Seção 2.2.3. Este 

comportamento é chamado de ciclo-limite e o seu entendimento é de suma 

importância para eliminá-los quando eles são indesejáveis, e, inversamente, como 

gerá-los ou amplificá-los quando eles são desejáveis. 

Para fazer isso, no entanto, é necessária uma compreensão das 

propriedades dos ciclos de limite e uma familiaridade com as ferramentas para 

manipulá-los (SLOTINE; LI, 1991). À medida que as condições do processo em 

sistemas dinâmicos são alteradas, a estabilidade do ponto de equilíbrio pode 

mudar e inclusive o número de pontos de equilíbrio pode ser alterado. 

Os pontos que ocorrem estas mudanças, i.e. em que a estabilidade é 

afetada, são conhecidos como valores críticos ou de Pontos de Bifurcação. Ao se 

analisar o comportamento de um sistema de GL através das variáveis de medida 

disponíveis ???? e ???, um comportamento cíclico típico de uma bifurcação Hopf é 



64  Estratégia de Controle Preditivo Não Linear – NMPC 

 

identificado. Com a mudança da ?? (Figura 4.1.A) ou a mudança de ??? 

(Figura 4.1.B), o sistema transita de uma região oscilatória convergente para uma 

região oscilatória divergente, como ilustrado nas Figura 4.1.B e Figura 4.1.D. 

A. 

 

C. 

 
B. 

 

D. 

 

Figura 4.1: Identificação da transição de estabilidade típica de poço de GL para 

uma variação de: A. e B. ?? ; C. e D. ???. 

Este comportamento foi reproduzido pelo novo modelo simplificado, e 

assim como feito por Jahanshahi (2012) e Storkaas(2007) uma análise de 

controlabilidade baseada nos polos do sistema será realizada. O modelo foi 

linearizado e avaliado no correspondente ponto de equilíbrio para valores de ??de 

3, 4, 5, 6, 10, 15, 20 e 25%. 

Como pode ser observado na Figura 4.2, os polos complexos ingressam no 

Semi Plano Direito (SPD) do eixo real no momento em que o sistema entra no 

ciclo limite, i.e. a partir de 5% de ??. À medida que a abertura é incrementada, o 

termo real do polo complexo ? adentra aumenta dentro do SPD, instabilizando o 

sistema e o termo complexo do polo j? aumenta suavemente e, 

consequentemente, a dinâmica instável se acelera.  

0 20 40 60 80
200

205

210

P
D

G
 x

1
0

5
 [

P
a
]

Tempo [h]

0 20 40 60 80
3

4

5

c
h
o
k
e
 [

%
]

3
4

5

0.9

0.95

1
0.95

1

Choke[%]TPT

P
D

G

0 20 40 60 80
200

205

210

Tempo [h]

0 20 40 60 80
6

8

10
x 10

4

W
g
l 
[S

m
³/

d
]

6
8

10
x 10

4

0.9

0.95

1

0.95

1

GL [Sm³/d]TPT

P
D

G

0 20 40 60 80
200

205

210

P
D

G
 x

1
0

5
 [

P
a
]

Tempo [h]

0 20 40 60 80
3

4

5

3
4

5

0.9

0.95

1
0.95

1

Choke[%]TPT

P
D

G

0 20 40 60 80
200

205

210

Tempo [h]
P

D
G

 x
1
0

5
 [

P
a
]

0 20 40 60 80
6

8

10
x 10

4

W
g
l 
[S

m
³/

d
]

6
8

10
x 10

4

0.9

0.95

1

0.95

1

GL [Sm³/d]TPT

P
D

G
0 20 40 60 80

200

205

210

P
p
d
g
 [

k
g
f/

c
m

²]

Tempo [h]

0 20 40 60 80
3

4

5

c
h
o
k
e
 [

%
]

3
4

5

0.9

0.95

1
0.95

1

Choke[%]TPT

P
D

G

0 20 40 60 80
200

205

210

P
p
d
g
 [

k
g
f/

c
m

²]

Tempo [h]

0 20 40 60 80
6

8

10
x 10

4

W
g
l 
[S

m
³/

d
]

6
8

10
x 10

4

0.9

0.95

1

0.95

1

GL [Sm³/d]TPT

P
D

G

0 20 40 60 80
200

205

210

P
p
d
g
 [

k
g
f/

c
m

²]

Tempo [h]

0 20 40 60 80
3

4

5

c
h
o
k
e
 [

%
]

3
4

5

0.9

0.95

1
0.95

1

Choke[%]TPT

P
D

G

0 20 40 60 80
200

205

210

P
p
d
g
 [

k
g
f/

c
m

²]

Tempo [h]

0 20 40 60 80
6

8

10
x 10

4

W
g
l 
[S

m
³/

d
]

6
8

10
x 10

4

0.9

0.95

1

0.95

1

GL [Sm³/d]TPT

P
D

G



4.1 Dinâmica do Sistema de Gas-lift 65 

 

Figura 4.2: Influência da ck na localização do par de polos complexos avaliados 

no estacionário para o modelo simplificado. 

Tabela 4.1: Evolução da Localização dos polos complexos conforme ??. 

ck 
(%) 

Pólos Complexos 
(? ± j?) 

3 -0,00017 ± 0,00060i 
4 -0,00007 ± 0,00078i 

4,6 
(Hopf) 

0,00000 ± 0,00086i 
(Extrapolação²) 

5 0,00003 ± 0,00089i 
6 0,00019 ± 0,00099i 

10 0,00072 ± 0,00129i 
15 0,00131 ± 0,00150i 
20 0,00190 ± 0,00157i 
25 0,00232 ± 0,00179i 

Isso justifica a intensificação da golfada (do ciclo e da amplitude) para 

grandes aberturas de ck. Pela extrapolação quadrática da curva, é possível 

identificar com maior exatidão o ponto Hopf de 4,6% para ck e j? igual a 8,6x10e-

4, indicado na Tabela 4.1. 

Como mencionado, a região de convergência do ciclo-limite e a dinâmica 

do sistema estão diretamente associadas ao ponto de operação e ao instante da 

trajetória, corroborando a ideia de múltiplos pontos de equilíbrio para sistemas 

tipicamente oscilantes, de forma que: 

 ??? = f[x(t), u(t), t] (4.1) 

 y = g[x(t), u(t), t] (4.2) 



66  Estratégia de Controle Preditivo Não Linear – NMPC 

 

onde ??? é a taxa de variação no tempo dos estados dinâmicos x(t), variantes no 

tempo correspondentes à ??? , ???, ???, ???, ???, ???, u(t) são as entradas do 

sistema correspondentes à ???, ??, ?? ? ?? , e y são as variáveis medidas do 

sistema correspondentes à ????, ??? ? ????.  

O comportamento dinâmico do sistema é altamente não-linear fazendo com 

que a análise estacionária do sistema não traga informações suficientes relativas 

à controlabilidade dinâmica, especialmente para técnicas de controle empregadas 

fazem uso de métodos de aproximação linear.  

Até o momento, apenas estudos baseados em pontos estacionários e 

análises lineares foram apresentadas para a proposição de estruturas de controle, 

como revisado na Seção 2.4.1. 

Com o intuito de extrair informações de controlabilidade do sistema ao 

longo da trajetória, utilizando o novo modelo simplificado, o processo foi analisado 

em diferentes pontos de operação e diferentes instantes da trajetória (snapshots) 

identificados na Figura 4.3: um ponto estável (P.Op1), em um ponto 

“marginalmente” estável (P.Op2), e em momentos diferentes da instabilidade: 

Subida (P.Op3); Ponto de Máximo (P.Op4); Descida (P.Op5); e Ponto de Mínimo 

(P.Op6). 

  

Figura 4.3: Identificação dos pontos de análise ao longo da dinâmica para um 

poço de GL com mudança de ck. 

A análise é realizada a partir da obtenção de uma aproximação linear do 

sistema dinâmico para cada ponto através de pequenas perturbações de  

10-5(1+|x|), onde x corresponde a cada estado dinâmico medido no ponto 

20 30 40 50 60
180

185

190

195

P
D

G
 x

1
0

5
 [
P

a
]

Tempo [h]

 

 Modelo

P.Op1

P.Op2

P.Op3

P.Op4

P.Op5

P.Op6

Estacionário



4.1 Dinâmica do Sistema de Gas-lift 67 

analisado. Desta forma, para cada snapshot tem-se uma aproximação linear nova 

e cada novo modelo uma sensibilidade diferente às mudanças de processo com 

dois comportamentos distintos. 

O primeiro está relacionado à transição da estabilidade (convergência 

pontual para cíclica). À medida que o processo sofre a troca de região de 

operação em direção ao Hopf (Transição P.Op1?P.Op2?P.Op5) o sistema tende 

a instabilizar, como identificado pelas respostas degrau dos sistemas linearizado, 

ilustrados na Tabela 4.2. Os polos imaginários ingressam no SPD, instabilizando 

o sistema, assim como na análise do estacionário. A resposta dinâmica de forma 

“quasi”-linear, possibilita, também a interpolação do Ponto Hopf.  

Já o segundo comportamento está relacionado à transição de 

comportamento no ciclo limite. Identifica-se que para um ponto de operação fixo, 

a resposta do sistema possui diferentes dinâmicas de forma não-linear. Esta 

transição, identificada na Tabela 4.2 (P.Op5? P.Op6? P.Op3? P.Op4) 

apresenta variação de todos os aspectos, como pode ser visualizado pela troca 

de valores dos pólos da resposta frente às entradas, sem um padrão aparente.  

Após o comportamento divergente (P.Op5) o sistema naturalmente retoma 

a característica oscilatório convergente (P.Op6). À medida que o ciclo caminha, a 

resposta aproxima-se do eixo imaginário aumentando a oscilação (P.Op3) até que 

o surgimento de um zero no zero (P.Op4) anula o comportamento oscilatório 

respondendo de forma suave. A partir daí o sistema volta a divergir (P.Op5) e o 

ciclo é retomado. Uma análise visual deste ciclo, baseada na localização dos 

pólos pode ser visualizada na Figura 4.4. 

Desta forma, o métodos lineares de análise de ganhos e de controle podem 

ser comprometidos por esta transição de comportamentos. Esta transição é 

ilustrada pela trajetória dos polos imaginários do sistema, mostrada na 

Figura 4.4.B. Uma trajetória quasi-linear (Estabilidade) e uma não-linear (Ciclo-

Limite).  

Uma vez que há a presença de um ramo instável intrínseco à dinâmica, o erro 

das ações de controle que tendem a zero para o ramo estável poderá tender ao 

infinito para o instável, gerando ações de controle inesperadas e até mesmo 

instabilizando o processo. 



68  Estratégia de Controle Preditivo Não Linear – NMPC 

 

Tabela 4.2: Efeito da trajetória na localização dos polos e zeros do sistema GL. 

A.  

 

B. 

 
Figura 4.4: Localização dinâmica dos pólos e zeros do sistema ao longo da 

transição de operação. 

-0.3 -0.2 -0.1 0 0.1
-1.5

-1

-0.5

0

0.5

1

1.5
x 10

-3

 

 

Pole-Zero Map

Eixo Real (seconds
-1

)

E
ix

o
 I
m

a
g

in
á

ri
o

 (
s
e

c
o

n
d

s-
1
)

P.Op1

P.Op2

P.Op3

P.Op4

P.Op5

P.Op6

 P.Op1 P.Op2 P.Op5 

ck 3 4 5 

R
e
s
p

o
s
ta

 D
e
g

ra
u

  

   

Zeros - - - 

P
ó

lo
s

 

p1 
p2 
p3 
p4 

p5,6 x10-4 

-0,3911 
-0,1655 
-0,0191 
-0,0034 

-1,7±6,0i 

-0,3918 
-0,1606 
-0,0187 
-0,0033 

-0,7±7,8i 

-0,3915 
-0,1499 
-0,0179 
-0,0036 

0,4±8,9i 

 P.Op6 P.Op3 P.Op4 

ck 5 5 5 

R
e
s
p

o
s
ta

 D
e
g

ra
u

  

   

Zeros  - 0 

P
ó

lo
s

 

p1 
p2 
p3 
p4 

p5,6 x10-4 

-0,3902 
-0,1202 
-0,0161 
-0,0034 

-3,2±9,6i 

-0,3434 
-0,1503 
-0,0180 
-0,0030 

-0,7±10,3i 

0 
-0,2417 
-0,0223 
-0,0053 

-8,3±3,1i 

     

0 1 2 3 4

x 10
4

-10

0

10

20

From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 1 2 3 4

x 10
4

-6

-4

-2

0

2
x 10

5

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 1 2 3 4

x 10
4

-2

0

2

4

6
x 10

5

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 1 2 3 4

x 10
4

-0.5

0

0.5

1

1.5

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-20

-10

0

10

20

From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 2 4 6 8

x 10
4

-4

-2

0

2
x 10

5

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-5

0

5

10
x 10

5

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-0.5

0

0.5

1

1.5

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 5 10 15

x 10
5

-2

-1

0

1

2
x 10

27
From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 1 2 3 4

x 10
4

-2

-1

0

1

2
x 10

6

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 5 10 15

x 10
5

-4

-2

0

2

4
x 10

30

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 5 10 15

x 10
5

-1

-0.5

0

0.5

1
x 10

26

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 0.5 1 1.5 2 2.5

x 10
4

-10

-5

0

5

10

From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 0.5 1 1.5 2 2.5

x 10
4

-4

-2

0

2
x 10

5

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 0.5 1 1.5 2 2.5

x 10
4

-2

0

2

4

6
x 10

5

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 0.5 1 1.5 2 2.5

x 10
4

-0.5

0

0.5

1

1.5

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-20

-10

0

10

20

From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 2 4 6 8

x 10
4

-4

-2

0

2
x 10

5

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-1

0

1

2
x 10

6

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2 4 6 8

x 10
4

-0.5

0

0.5

1

1.5

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 5000 10000
-5

0

5

10

From: MODELO/1(1)  To: Out(1)

Resposta degrau do Gas-lif t no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

0 2000 4000 6000 8000
-3

-2

-1

0

1
x 10

4

 

 
From: MODELO/1(2)  To: Out(1)

Resposta degrau da choke no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 2000 4000 6000 8000
-5

0

5

10
x 10

5

 

 
From: MODELO/1(3)  To: Out(1)

Resposta degrau da Ps no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

0 5000 10000
-0.5

0

0.5

1

1.5

 

 
From: MODELO/1(4)  To: Out(1)

Resposta degrau da Pr no modelo linearizado

Time (seconds)

A
m

p
lit

u
d
e

PDG

TPT

PTop

p1 
p2 

p3 

p5,6 

p4 



4.2 Algoritmo de Controle LLT 69 

Além disso, ferramentas utilizadas no controle podem sofrem influência 

desta transição de dinâmica. Por exemplo, estratégias de retroalimentação que 

fazem uso de modelos linearizados na trajetória tem seu desempenho 

dependente do ponto de linearização do sistema. Esta relação será melhor 

discutida na Seção seguinte, relativo à estrutura de controle. 

4.2 Algoritmo de Controle LLT 

Como introduzido na Seção 2.4, neste trabalho será adotado o algoritmo de 

NMPC chamado LLT. Inicialmente idealizado por Trierweiler e Secchi (2000) e 

desenvolvido por Duraiski et al. (2002) soluciona uma sequência de Problemas 

Lineares Quadráticos (LQP) dados por sucessivas linearizações ao longo de uma 

trajetória de controle (também chamada de Horizonte de Controle, M).  

Isto, adicionado ao erro relativo ao setpoint desejado (SP) ao longo de um 

horizonte de predição, a função objetivo JLLT a ser minimizada é dada por: 

 JLLT = min
??

|
?LLT

0
|

(? ??
|
?
0

|
(?

|
?
0

|
? ??

|
?
0

|
)?

2

+??=0 ? ??|?
0

|
(??

|
?
?1

|
? ?

|
?LLT?1

?2
|

? )?

2

?
?=0 ) (4.3) 

onde o termo (? ? ??) é termo do erro relativo a variável de processo ?, e (?? ?

?) refere-se ao esforço de ações da variável de manipulação (??) em relação à 

posição anterior ( ?? ), ponderado pelo Peso do Erro do setpoint ( ? ) e pela 

Supressão de Movimento da ação de controle (?).  

As ações e os componentes do méetodo descritos podem ser visualizados 

na Figura 4.5. 

 

Figura 4.5: Algoritmo LLT (baseado em DURAISKI et al., 2002). 



70  Estratégia de Controle Preditivo Não Linear – NMPC 

 

As restrições físicas do sistema, como as introduzidas na Seção 2.4.1, 

dadas por limites máximos e mínimos (????, ????) e pelas taxas de variação de 

abertura e fechamento (???, +??) das variáveis manipuladas são adicionadas ao 

problema por restrições ao longo do horizonte de controle, M: 

 ?
???[

?
1

]
? ?

[
?
1

]
? ?

???[
?
1

]
 (4.4) 

 ???
[
?
1

]
? ??

[
?
1

]
? +??

[
?
1

]
 (4.5) 

4.2.1 Ajuste do Controlador 

A configuração de controle empregada exige o ajuste de cinco parâmetros: 

Tempo de Amostragem (TA), ?, ?, ? e ?. A definição do TA e dos horizontes (M 

e P) estão diretamente ligadas a convergência das ações de controle e da 

variável de processo. 

Assim, estes parâmetros não devem ser grandes a ponto de aumentar a 

complexidade do LQP e não tão pequeno que deixe de representar a golfada.  

Por exemplo, se utilizarmos a série de Fibonacci para definição dos pontos 

de amostragem e horizonte, necessitaríamos de uma amostragem pequena, para 

que haja uma representatividade mínima da dinâmica inicial da golfada.  

Como pode ser visto na Figura 4.6, uma representação de dez pontos na 

dinâmica de subida é obtida para uma amostragem de meio minuto, de oito 

pontos para 1,5 minutos e cinco para 3 minutos. 

Apesar disso, a golfada como um todo, perde a característica devido ao 

aumento do espaçamento da série para uma predição mais longo, a partir do 

primeiro período.  

Para tratar este problema, neste trabalho, é proposto um horizonte 

calculado para duas regiões que englobe duas características do sistema: o 

tempo de subida (??) e o período do ciclo (??). O tempo de subida é dado pelo 

tempo entre um pico e um vale, indicado na Figura 4.6. 



4.2 Algoritmo de Controle LLT 71 

  

Figura 4.6: Pontos de predição baseados na série de Fibonacci, com diferentes 

taxas de amostragem, com identificação de ?? e ??. 

A primeira região é calculada por uma série de espaçamento variável, 

contendo de cinco a dez pontos amostrados para maior representatividade da 

subida. Para a segunda região, a fim de manter a representatividade da dinâmica 

cíclica com baixo custo computacional, a amostragem determinada por uma série 

igualmente espaçada a partir do ponto de descida com no mínimo cinco pontos 

amostrados em cada ciclo. 

 Assim, o Horizonte de Predição é definido como:  

 ?
[
?
0

]
= {

(
??(?+1)

2
+ 1) ? ??              , ???? ? = 0 … ?1

???1 + (?1 ? ?) ? ??         , ???? ? = ?1 … ?2
 (4.6) 

onde ?1 é definido como o valor entre 5 e 10; e ?2 é igual 
??

5
; e ??é definido de 

forma arbitrária obedecendo a restrição de que 5 a 10 pontos amostrados na 

subida e para que o tamanho do horizonte de predição preveja pelo menos três 

ciclos da golfada.  

Como uma referência, a relação entre o tempo de subida e o tempo do 

ciclo, calculada por 
??

??
? 1, da um ponto inicial para a amostragem. O Horizonte de 

Controle ? é definido como sendo igual ao horizonte de menos um ciclo: 

0 2 4 6 8 10
190

195

200

205

210

P
D

G
 x

1
0

5
 [
P

a
]

Tempo [h]

 

 

Dinâmica TA = 0,5 min TA = 1 min TA = 1,5 min

ts
tc



72  Estratégia de Controle Preditivo Não Linear – NMPC 

 

 ? = ?
[
?3
0

]
  (4.7) 

onde ?3 é o valor equivalente ao segundo ciclo da golfada.  

Por último, para determinação dos Peso do Erro e a Supressão de 

Movimento é proposta uma sistemática determinada pelo ponto de operação e 

que relaciona a amplitude de golfada e o valor estacionário, calculado por 
?

?
=

?????????

????????á??
? %?????.  

Esta relação da uma referência inicial de grandeza dos parâmetros e que 

conforme o desempenho do controlador podem ser finamente ajustados.  

4.2.2 Estratégia de Retroalimentação  

É importante dizer que o algoritmo NMPC é um controlador de 

retroalimentação natural que usa as saídas disponíveis do processo e trata 

naturalmente as perturbações medidas devido ao seu comportamento 

feedforward intrínseco. Com base na predição do modelo, a perturbação medida 

pode ser facilmente compensada pelas ações de controle futuras calculadas pelo 

algoritmo. 

No entanto, nem sempre é possível medir distúrbios do processo, como no 

offshore, por exemplo, não podemos medir a corrente atual que mudará o ponto 

de inclinação e alterará o padrão de fluxo. Um dos principais problemas dos 

controladores baseados em modelo é a discrepância entre Modelo e Realidade, 

que pode ser gerada por estes distúrbios não medidos.  

Para manter a robustez e compensar esses efeitos, faz-se necessária a 

utilização de uma técnica de correção. Neste trabalho, esta correção é feita pela 

retroalimentação dos estados através do Filtro de Kalman Estendido (EKF) na sua 

forma híbrida ou também chamada contínuo-discreto. Essa formulação considera 

a dinâmica do sistema em tempo contínuo, integrando o modelo ao longo da 

trajetória, mas faz observações discretas para a atualização dos estados.  

Reconsiderando as equações 4.1 e 4.2 e assumindo que tanto os estados 

dinâmicos e a saída de processo possuem erros para a formulação do filtro, 

temos que: 



4.2 Algoritmo de Controle LLT 73 

 ??? = f[x(t), u(t), t] + ?(t) (4.8) 

 y = g[x(t), u(t), t] + ?(t) (4.9) 

onde ?(t) é o erro dos estados dado por um ruído branco em tempo contínuo com 

covariância ??  e ?(t) é o erro das medidas dado ruído branco na medida, com 

covariância ?? . Desta forma, a correção do estado ( ????|? ) é feita levando em 

consideração o estado atual (????|??1) e erro entre a variável medida no instante 

atual (??) e a variável estimada no instante atual (????). A característica discreta do 

filtro, dá-se na obtenção de ???? , obtida através da linearização do modelo no 

instante ?? = (
??

??
)

????|??1
, formulada por: 

 ???? = ??  ????|??1 (4.10) 

Desta forma o estado corrigido é calculado de forma incremental ao estado 

atual (????|??1) por: 

 ????|? =  ????|??1 + ??  ??? ? ??  ????|??1? (4.11) 

onde ?? é o ganho de Kalman definido como: 

 ?? =
?? ??

?

?? ??  ??
?+ ?

 (4.12) 

onde ??  é a transição de covariância dos estados e ??
?  é a transposta das 

medidas y linearizados em ????|? . Aqui, a contribuição contínua da formulação é 

evidenciada, de forma que a atualização de ?? é realizada de forma contínua ao 

longo da trajetória: 

 ?? = ???1|??1 + ? (f ?? + ??  f 
? + ?? )

?

??1
 (4.13) 

Por fim, ao final de um tempo de amostragem, os estados são atualizados 

( ????|? =  ????|??1 ) e a matriz de covariância também ( ?? = ???1|??1 ). Assim, o 

processo de correção dos estados do sistema de controle pode ser ilustrado como 

na Figura 4.7. Diante do ajuste dos parâmetros de entrada ??=0 , ?? e ??. 

Essa implementação, na forma híbrida, evita problemas relativos à 

linearização ao longo da trajetória, previstos na seção anterior. Maiores detalhes 

do projeto e ajuste dos parâmetros do Filtro podem ser vistos em Salau (2009). 



74  Estratégia de Controle Preditivo Não Linear – NMPC 

 

 

Figura 4.7: Estimação de estados com o filtro de Kalman estendido, para 

retroalimentação do Sistema de Controle. 

Análise de Observabilidade 

Para aplicação da retroalimentação de estados, é necessário saber se é 

possível a reconstrução destes a partir das informações disponíveis no processo 

(variáveis medidas). Para isso, foi utilizado o critério de Hautu’s, onde para todos 

os alto-valores ? da matriz Ass a seguinte condição deverá ser satisfeita:  

 ???? =  [
?? ? Ass

???
] = ? (4.14) 

onde I é a matriz identidade, "n“ é o número de estado que podem ser 

recontruídos à partir das medições disnponíveis, baseado no modelo em espaço 

de estado Ass , ??? e os autovalores ?.  

A partir desta análise foi possível determinar que mesmo para situações 

onde existam apenas uma medida de pressão, com esta, ck e ???  é possível 

retroalimentar até seis estados dinâmicos. 

4.3 Estratégia de Controle 

O presente trabalho irá apresentar duas estratégias de controle, tendo 

como variável controlada a pressão ????. A fim de fazer um comparativo com 

estratégias de controle linear clássicas (PI/PID) a primeira estratégia é 

monovariável (controle padrão para golfadas, descritos na revisão bibliográfica) 

pela manipulação da ck.  



4.3 Estratégia de Controle 75 

Num segundo momento, a estratégia proposta incorporará a principal 

vantagem do controle avançado de processos (multivariabilidade) numa estrutura 

MISO de controle de PDG com a manipulação da ck e da Wgl. Esta estrutura está 

ilustrada na Figura 4.8, onde a estratégia como um todo pode ser vista: Algoritmo 

LLT, MISO com EKF. 

 

Figura 4.8: Estratégia de controle NMPC de PDG pela manipulação da ?? e da 

??? (MISO), com retroalimentação pelo Filtro de Kalman Estendido (EKF). 

  



76  Estratégia de Controle Preditivo Não Linear – NMPC 

 

  



 

77 

  Implementação do 
Controle Preditivo Não Linear  

Nesse capítulo será apresentado um estudo de caso da aplicação do 

método proposto. O estudo apresenta os resultados do procedimento de ajuste 

proposto, na Seção 5.1, com o complemento de uma análise de sensibilidade dos 

parâmetros.  

Na Seção 5.2 serão apresentados os parâmetros de ajuste do controlador 

que serão aplicados e comparados ao controle clássico na 5.3. Por fim, a 

estratégia multivariável será apresentada e comentada diante dos resultados 

obtidos.  

5.1 Ajuste do Modelo 

O estudo de caso é baseado em um poço em operação nos campos 

maduros brasileiro, chamado poço A, de operação em águas profundas com 

5.5 km de extensão linear e 2.5 km de profundidade. A Figura 5.1 ilustra a 

arquitetura e identifica os pontos de medição do poço de ????,  ???  e ???? e os 

parâmetros físicos diretamente ligados ao modelo estão indicados na Tabela 5.1.  

A pressão no reservatório é de 2,206 x107 Pa e a contrapressão exercida 

pelo header de produção igual a 0,981x107 Pa. Como já comentado 

anteriormente, em termos de escala temporal, a dinâmica do reservatório é mais 

lenta que a da dinâmica do ciclo da golfada (meses para horas, respectivamente).  



78  Implementação do Controle Preditivo Não Linear 

 

A abordagem deste trabalho é de um poço (singular), o que simplifica a 

interação da descarga múltipla com no header. Com estas duas considerações, 

as análises feitas consideram as entradas de ?? ? ?? como fixas. 

 

Figura 5.1: Batimetria do Poço A. 

Tabela 5.1:  

Parâmetros Poço A 

 Valor Und. 

G 9,81 m/s² 

Mm 18 
kg / 
kmol 

T 298 K 

R 8314 
m³.Pa 

/kmol.K 

?gw 0,0188 kg/kg 

?L 987,45 kg/m³ 

?mres 891,95 kg/m³ 

Da 0,140 m 

Dt 0,150 m 

D 0,152 m 

La 1118 m 

Lt 1639 m 

Hpdg 916 m 

Ht 1279 m 

Hvgl 1117 m 

? Pi/4 rad 
 

A estrutura que opera este poço possui limitações físicas, como já introduzido 

na Seção 2.4.1. O ??? é limitado à 10
5 Sm³/d e a ?? é limitada à uma taxa de 

abertura e fechamento de 0 a 100 % em sete minutos. Estas informações são 

inseridas diretamente nas restrições do algoritmo LLT. Para evitar problemas de 

fechamento de poço o limite mínimo de ??? é estipulado em 6x10
4 Sm³/d. 

A partir destes dados, o poço foi reproduzido em OLGA (software citado na 

Seção 2.3) para geração dos dados de referência ao ajuste do novo modelo 

simplificado. O resultado inicial indicou que o poço está sujeito a pressões de até 

2,059x107 Pa em ????, com amplitudes de até 0,196x10
7 Pa sujeito a períodos de 

ciclo da golfada até duas horas, como pode ser visualizado na Figura 5.2. 



5.1 Ajuste do Modelo 79 

 
A. 

 

B. 

 

Figura 5.2: Análise monovariável da dinâmica do sistema de golfada para, 

reproduzidas em OLGA, para o poço A, A. para variação de ??? com ?? igual a 

18 % e B. ?? com ??? fixo e igual a 8x10
4 Sm³/d. 

5.1.1 Estimação de Parâmetros 

Os dados coletados foram tratados para um ajuste da região de operação 

de ?? igual a 18 %, ???  8x10
4 Sm³/d. Os ajustes foram realizados tendo como 

referência apenas medições de pressão em ???? . Num primeiro momento, o 

método de estimação foi utilizada com a função objetivo clássica de ??? .  

Como esperado e já comentado na Seção 3.2.1, o resultado não obteve 

sucesso em relação à reprodução da dinâmica cíclica do sistema, retornando um 

ajuste ao valor médio do comportamento, visualizado na Figura 5.3.A. Já fazendo 

uso da nova abordagem para a função objetivo, ?(??), as regiões de análise são 

suavizadas enquanto a região do MSE é penalizada salientando a região ótima, 

como já ilustrado na Figura 3.5.  

A nova resposta adere o comportamento do modelo ao OLGA 

satisfatoriamente, em termos de controle, captando as características de ciclo, 

amplitude e magnitude do sistema, como vemos na validação visual na 

Figura 5.3.B. 

40 60 80 100 120 140
0

1

2
x 10

5

Dinâmica para Choke = 18% Sm³/d

W
g
l 
[S

m
³/

d
ia

]

40 60 80 100 120 140
1.8

2

2.2
x 10

7

P
D

G
 [

P
a
]

40 60 80 100 120 140
0

1

2
x 10

7

T
P

T
 [

P
a
]

40 60 80 100 120 140
0

5
x 10

6

P
T

o
p
 [

P
a
]

Tempo [h]

40 60 80 100 120 140
0

20

40

Dinâmica para GL = 8e4 Sm³/d

C
h
o
k
e
 [

%
]

40 60 80 100 120 140
1.8

2

2.2
x 10

7

P
D

G
 [

P
a
]

40 60 80 100 120 140
0

1

2
x 10

7

T
P

T
 [

P
a
]

40 60 80 100 120 140
0

5

10
x 10

6

P
T

o
p
 [

P
a
]

Tempo [h]

40 60 80 100 120 140
0

1

2
x 10

5

Dinâmica para Choke = 18% Sm³/d

W
g
l 
[S

m
³/

d
ia

]

40 60 80 100 120 140
1.8

2

2.2
x 10

7

P
D

G
 [

P
a
]

40 60 80 100 120 140
0

1

2
x 10

7

T
P

T
 [

P
a
]

40 60 80 100 120 140
0

5
x 10

6

P
T

o
p
 [

P
a
]

Tempo [h]

40 60 80 100 120 140
0

20

40

Dinâmica para GL = 8e4 Sm³/d

C
h
o
k
e
 [

%
]

40 60 80 100 120 140
1.8

2

2.2
x 10

7

P
D

G
 [

P
a
]

40 60 80 100 120 140
0

1

2
x 10

7

T
P

T
 [

P
a
]

40 60 80 100 120 140
0

5

10
x 10

6

P
T

o
p
 [

P
a
]

Tempo [h]



80  Implementação do Controle Preditivo Não Linear 

 

A. 

 

 

B. 
 

 
Figura 5.3: Resposta do Ajuste dos parâmetros para ?? igual a 18% e ??? 

8x104Sm³/dia, (A) para ??? e (B) para a função objetivo proposta. 

Em termos dinâmicos a nova proposta obteve sucesso frente à abordagem 

clássica, capturando a característica cíclica do sistema. Ao compararmos as 

respostas numéricas dos resultados a conclusão é diferente. Pelo resultado do 

MSE o valor ótimo em termos numéricos a 6,47x107 Pa. Já a nova proposta 

retorna um valor de mínimo de 9,09x107 Pa. 

Essa diferença é devido à incluso da penalidade, que soma uma parcela ao 

???, e que como observado na Figura 5.3.B, ainda é validada para o ajuste, uma 

vez que o cíclico e a derivada não zeram. Uma simples análise dos números 

resulta uma resposta em termos dinâmicos indesejados. 

Os parâmetros obtidos pelo método proposto, após 18 horas de simulação, 

estão indicados na Tabela 5.2: 

Tabela 5.2: Parâmetros Estimados para o Poço A 

 Descrição Valores Unidade 

E Fração de gás preso na bolha  0,57 - 

Ka Coeficiente de fluxo da injeção 1,59x10-4 m-1 

Kg Coeficiente de fluxo da válvula virtual  2,05x10-4 m-1 

Kout Coeficiente de fluxo da choke 1,97x10-2 m-1 

Kw Coeficiente de fluxo da ANM 8,68x10-4 m-1 

Kr Vazão mássica estimada para o poço 0,13 m-1 

mLstill Massa mínima de líquida no Riser holdup 1957,03 kg 

Veb Volume da bolha alongada 83,51x103 m³ 

Vr Volume à montante da válvula virtual 620,36 m³ 

0 1 2 3 4 5 6 7 8

x 10
4

0

0.5

1

1.5

2

2.5

3
x 10

7

Tempo [seg]

P
re

s
s
ã
o
 [

P
a
]

 

 

TPT-sim

PDG-sim

TPT-OLGA

PDG-OLGA



5.1 Ajuste do Modelo 81 

 
5.1.2 Validação do Ajuste 

A validação do ajuste foi feita pela extrapolação das regiões de operação, a 

partir dos dados inicialmente obtidos através do OLGA. O modelo foi extrapolado 

para regiões de ??? variando de 4x10
4 Sm³/d até 10x104 Sm³/d, com ?? constante 

e igual à 18 %, conforme indicado na .A. De forma similar, para um ??? constante 

e igual a 10x104 Sm³/d, a ?? foi variada de 5 % a 30 %, como ilustrado na .B.  

A.

 

B.

 

Figura 5.4: Extrapolação do novo modelo simplificado para diferentes pontos de 

operação para o intervalo de (A) ?? de 18% e (B) ??? de 8x10
4 Sm³/dia. 

O resultado gerado, mostrou uma boa capacidade de extrapolação do 

modelo. A sensibilidade do sistema é atingida pelo modelo, onde o aumento da ?? 

e/ou a diminuição do ??? agravam o ciclo da golfada, aumentando a amplitude e 

o período de oscilação. Além disso, é mantido um compromisso suficiente para 

fins de controle dos valores absolutos das pressões do sistema, mesmo com a 

utilização de apenas um valor de referência para o ajuste (????). 

Ao fazer a validação para o diagrama de bifurcação e identificação do 

ponto Hopf vê-se que ocorre uma leve diferença entre o ponto de bifurcação 

predito e o resultado do OLGA.  

30 40 50 60 70 80 90 100 110 120
0

5

10

15
x 10

4

W
g

l 
[S

m
³/

d
]

30 40 50 60 70 80 90 100 110 120
1.8

2

2.2
x 10

7

P
D

G
 [
P

a
]

30 40 50 60 70 80 90 100 110 120
0.5

1

1.5

2
x 10

7

T
P

T
 [
P

a
]

30 40 50 60 70 80 90 100 110 120
0

2

4

6
x 10

6

P
T

o
p

 [
P

a
]

Tempo [h]

 

 
OLGA

Predito

40 60 80 100 120 140 160
0

10

20

30

C
k
 [
%

]

40 60 80 100 120 140 160
1.8

2

2.2
x 10

7

P
D

G
 [
P

a
]

40 60 80 100 120 140 160
0

1

2
x 10

7

T
P

T
 [
P

a
]

40 60 80 100 120 140 160
0

5

10
x 10

6

P
T

o
p

 [
P

a
]

Tempo [h]

 

 

OLGA

Predito



82  Implementação do Controle Preditivo Não Linear 

 

Como ilustrado na Figura 5.5, há uma diferença absoluta de 2 % de ?? 

para o início da golfada. É possível notar que no ponto de ajuste dos modelos, 

com ?? igual a 100 %, a diferença entre os comportamentos é mínima.  

 

Figura 5.5: Identificação do ponto de bifurcação (Hopf) através do diagrama de 

bifurcação para os dados de referência do OLGA e a predição do modelo para 

??? de 8x10
4 Sm³/dia. 

Esta diferença de comportamento também é obtida nos estudos realizados 

por Jahanshahi et al.(2012) e Di Melgio et al.(2012) e como os mesmos relatam e 

será mostrado no capítulo que segue, esta discrepância é minimizada ainda mais 

na aplicação de controle. 

5.1.3 Identificabilidade do Parâmetros 

A partir do conhecimento prévio dos parâmetros estimados (Tabela 5.2), o 

método proposto na Seção 3.2.2 foi aplicada para diferentes pontos de operação. 

Como indicado na Figura 5.6.A, pela variação individual das entradas do sistema, 

a identificabilidade dos parâmetros foi analisada: para uma região estável ( ?? 

2 %); uma região marginalmente oscilante (próximo ao Hopf, ?? 5 %); para uma 

região oscilante e igual ao ponto de ajuste (?? 18 %); e uma região altamente 

golfante (?? 30 %); e de forma análoga para a variação de ??? (Figura 5.6.B). 

O intuito da análise era o de identificar os parâmetros com maior 

significância para a dinâmica do sistema, conforme os índices propostos na 

Seção 3.2.2, que estão indicadas na Tabela 5.3. Como sugestão de ponto de 

corte para a Identificabilidade, parâmetros com índice acima de 0,4 serão 

considerados significantes.  



5.1 Ajuste do Modelo 83 

 
A.

 

B.

 
Figura 5.6: Regiões de operação utilizadas na análise de identificabilidade para 

A. uma variação de ?? e B. uma variação de alimentação de ???. 

Diante disso, num primeiro momento, identificou-se que para as regiões 

estáveis (2 % de ?? e 8x105 Sm³/d de ???, na primeira linha da Tabela 5.3, há 

uma troca de significância dos parâmetros, sem um padrão claro. Enquanto para 

??, Vr  e mLstill para o ???, Kout e Kw tornam-se significantes para a dinâmica.  

Para as regiões marginalmente estáveis (2ª linha da Tabela 5.3), essa 

significância muda novamente, uma vez que, os parâmetros significantes são Vr, 

Veb, Kout e Kw para ?? de 5 % e Veb, e E, e para ??? de 5x10
5 Sm³/d E, Vr e Ka.  

Para regiões golfantes (3ª linha da Tabela 5.3), com 18 % de ??, Vr, Veb, Kout e Kw 

ganham significância e para ???  de 1x10
5 Sm³/d Kg, Veb e Vr. Para regiões 

altamente golfantes (4ª linha da Tabela 5.3), com 30 % de ??, praticamente todos 

os parâmetros ganham significância e ??? de 6x104Sm³/d Kg, Ka e Kout. 

Estes resultados nos levam a crer que não há um padrão de importância 

individual dos parâmetros, uma vez que para cada ponto de operação analisado a 

ordem muda, independência da característica oscilante do processo. Em regiões 

de dinâmica semelhante, os parâmetros de elevada importância são diferentes.  

Para as regiões analisadas, em termos de ocorrência, Vr , Veb, Kout 

possuem maior importância local. Ainda assim, a atualização do modelo é 

dificultada, pois a eleição de apenas um parâmetro e descarte dos demais num 

procedimento de re-estimação pode não representar a real interação global dos 

parâmetros, em termos da dinâmica.  

0 5 10 15 20
1.6

1.7

1.8

1.9

2

2.1

2.2
x 10

7

Tempo [h]

P
pd

g 
[P

a]

 

 

2%

5%

18%

30%

0 5 10 15 20
1.7

1.8

1.9

2

2.1

2.2
x 10

7

Tempo [h]

P
pd

g 
[P

a]

 

 

6e4 Sm³/d

10e4 Sm³/d

50e4 Sm³/d

80e4 Sm³/d



84  Implementação do Controle Preditivo Não Linear 

 

Tabela 5.3: Ranking de Importância dos parâmetros de estimação do modelo, 

baseado na identificabilidade, para diferentes regiões de operação.  
 Variação de ?? para 

???=8x10
4 Sm³/d 

Variação de ??? para 

 ?? = 18 % 

E
s
tá

v
e
l 

2 % 

 

8x105 Sm³/d 

 

M
a
rg

in
a
lm

e
n

te
 o

s
c
il

a
n

te
 

5 % 

 

5x105 Sm³/d 

 

O
s
c
il
a
n

te
 

18 % 

 

1x105 Sm³/d 

 

A
lt

a
m

e
n

te
 o

s
c
il
a
n

te
 

30 % 

 

6x104 Sm³/d 

 

Vr mlstillCout Cg E Ka Veb Kr Kw
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

Cout Kw Kr Vr mlstill Ka Veb Cg E
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

Veb E mlstill Kr Kw Vr Cg Ka Cout
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

E Vr Ka Cout Veb Kr mlstill Cg Kw
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

Vr VebCout Kw Ka Kr E Cg mlstill
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

Cg Veb Vr Ka mlstillCout E Kw Kr
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

VebCout E Kw Kr Vr Ka Cg mlstill
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia

Cg Ka Cout Vr Veb E Kr Kwmlstill
0

0.2

0.4

0.6

0.8

1

Parâmetro

Im
p
o
rt

â
n
c
ia



5.2 Ajuste do Controlador NMPC 85 

 
Isso deve-se ao fato de a análise realizada tem uma característica local, 

pois a variação dos parâmetros na construção da matriz de sensibilidade é feita 

um a um. Sugere-se que num momento futuro, que essa análise seja realizada 

com um método de análise global, que leve em consideração a interação de todos 

os parâmetros. 

5.2 Ajuste do Controlador NMPC 

Para o ajuste do controlador, introduzido na Seção 4.2.1, a sistemática foi 

aplicada para o controle de uma região marginalmente golfante, com 5 % de ?? . 

Pela estrutura proposta (Seção 4.3), apenas a dinâmica de ????  é levada em 

consideração.  

Assim, o ajuste se baseou no pior caso deste cenário (com alimentação 

mínima de gás), com a característica dinâmica ilustrada na Figura 5.7. O ciclo da 

golfada possui um período de 1,7 horas (102 minutos), com um tempo de subida 

de 40,5 minutos e uma amplitude de 0,132x107 Pa de pressão em ????. 

A partir destas informações, para manter o compromisso entre pontos 

amostragem e representatividade da dinâmica, a amostragem foi definida como 

igual a 1,5 minutos, acarretando em oito pontos no período de subida e cinco 

pontos nos ciclos futuros, como indicado na Tabela 5.4.  

 

 

Figura 5.7: Parâmetros de Ajuste do 

Controlador. 

Tabela 5.4: Parâmetros  

do NMPC, em minutos. 

 Valor 

TA 1,5 

? 
1.5; 3.0; 6.0; 10.5; 16.5; 24.0; 
33.0; 43.5; 55.5; 79.5; 103.5; 

127.5; 151.5; 175.5; 199.5 

? 

1.5; 3.0; 6.0; 10.5; 16.5; 24.0; 
33.0; 43.5; 55.5; 79.5; 103.5; 
127.5; 151.5; 175.5; 199.5; 
223.5; 247.5; 271.5; 295.5; 

319.5; 343.5 
? 0,6 
? 1 

 

0 2 4 6 8 10
190

195

200

205

210

215

P
D

G
 x

1
0

5
 [
P

a
]

Tempo [h]

 

 Dinâmica

Pontos Predição

Pontos Movimento

M

P



86  Implementação do Controle Preditivo Não Linear 

 

5.2.1 Ajuste do Filtro de Kalman 

Para o ajuste do EKF, conforme Salau (2009), foram ajustados o tempo de 

amostragem do filtro, para a parte discreta, as matrizes de covariância dos 

estados ?? e de covariância das medidas ?? e a matriz de inicialização ??=?.  

Para aplicação da estrutura proposta neste trabalho, a taxa de amostragem 

foi determinada igual à do controlador e as matrizes de covariância como sendo 

igual ao valor médio dos estados, para ??, e médio das saídas, para ??, relativo 

ao ponto de partida do controlador. A matriz de inicialização ??=? , foi definida 

igual a 1x106. 

5.3 Controle Linear VS Não Linear 

Para fins de comparação de desempenho, seguindo a tendência no uso de 

controladores lineares, uma estrutura de controle PID foi testada e comparada ao 

NMPC proposto, na seção que segue. 

Devido à característica monovariável do PID, neste primeiro momento a 

estrutura NMPC será utilizada na forma monovariável (Single Input Single Output 

– SISO) de controle de ???? (CV) através da ?? (MV). Para estas duas estruturas 

monovariáveis, a alimentação de gás de elevação foi fixada no valor máximo de 

105Sm³/d, e num segundo momento a ??? é inserida como MV no NMPC. 

5.3.1 Critérios de Desempenho e Robustez e Ganho 

Os testes de controlabilidade formam realizados pela sucessão de degraus 

no SP de pressão levando em consideração apenas o desempenho e a robustez 

servo. Os valores de SP são obtidos através do cálculo e mapeamento do 

estacionário de ???? . A sistemática de cálculo dos valores estacionário dos 

estados do novo modelo é apresentada no Apêndice C - Construção do Diagrama 

de Bifurcação. 

O desempenho do controlador, para cada SP foi baseada na reposta na 

forma de erro quadrático relativo (?(?? ? ??)?) e alcance do valor desejado. 



5.3 Controle Linear VS Não Linear 87 

 

Para robustez, foram utilizados a média (
? ??

?
,

? ??

?
) e desvio padrão 

(
?(??????? ?? )2

?
, 

?(??????? ?? ?)2

?
) da variável de processo e da variável manipulada e a taxa 

máxima de variação da manipulada (???[
????1????

???1???
]).  

Para quantificar ganhos de produção, os resultados foram comparados à 

dinâmica em malha aberta equivalente ao ponto de operação médio das ações de 

controle média em malha fechada, para um SP fixo. Assim, fazendo uso do 

modelo, a produção média de óleo em malha aberta é comparada à produção 

média em malha fechada, para cada SP. 

5.3.2 Controlador Linear 

Controlando ???? (como CV) através da ?? (como MV), o controlador PID é 

utilizado numa estratégia feedback, como a ilustrada na Figura 5.8. O controlador 

foi implementado na sua forma paralela: 

 MV = Kc {1 +
1

?? ?
+

?? ?
??

?
??+1

} (SP ? CV) (5.1) 

onde Kc  é o ganho proporcional; ??   é a constante do tempo integral; ??  é a 

constante do tempo derivativo e ?  é o filtro da ação derivativa. Para evitar 

problemas de variações abruptas (“bump”) na inicialização do controlador, devido 

ao elevado erro inicial (evitando um salto inicial), é utilizado o artifício do “Bias”.  

Além disso, é adicionada uma ação Antiwindup, para evitar problemas 

decorrentes da saturação na MV, acarretados pela ação integral. A estratégia 

utilizada está ilustrada na Figura 5.8, e o algoritmo utilizado pode ser visto no 

detalhe. 

Os parâmetros do controlador PID forma ajustados baseados em regras 

heurística (DE CAMPOS; TEIXEIRA, 2010) com a premissa de uma rápida 

atuação no ramo de subida inicial da golfada (ts), seguido por um ajuste fino 

manual. A Taxa de Atualização (Ta) do Antiwindup foi definida como igual a ??  e 

saturação da variável manipulada de 0 a 100 %.  

Mesmo não recomendada para ajuste de sistemas subamortecidos, como o 

da golfada, as regras heuríticas foram utilizadas como uma estimativa inicial do 

tempo derivativo. Há espaço para melhoria de desempenho do controlador linear 



88  Implementação do Controle Preditivo Não Linear 

 

PID, utilizando-se regras de ajuste que levem em consideração a característica 

oscilatória. 

Num primeiro momento, foi analisada a contribuição da ação derivativa, 

comparando a robustez de um PID e um PI. Num segundo momento a limitação 

da taxa de variação da ?? foi inserida na forma de função de transferência de 

forma que a resposta degrau seja equivalente a limitação física do sistema 

 

 
Figura 5.8: Estratégia de controle linear monovariável de ???? com ?? , utilizando 

algoritmo PID paralelo, com Bias e Antiwindup. 

Para o sistema do Poço A, a taxa máxima de 0 à 100% em 7 minutos foi 

representada por um função do tipo 
1

400?+1
. Os parâmetros da constante 

proporcional e integral foram resintonizados para tratar essa dinâmica, de forma 

similar a um tempo morto. Os parâmetros utilizados estão indicados na 

Tabela 5.5. 



5.3 Controle Linear VS Não Linear 89 

 
Tabela 5.5: Parâmetros de ajuste dos PID’s. 

Parâmetro PID PI PIDdin 

?? -30 -30 -10 
?? 120 120 520 

?? 
1

4 ??
 0 0 

? 10 - - 
?? ?? ?? ?? 

???? 2 2 2 

5.3.1 Limitação de Desempenho pela Dinâmica da MV 

Num primeiro momento, o controlador PID ajustado apresentou um bom 

desempenho. Como pode ser visto em magenta na Figura 5.9, ao longo da 

trajetória de SP’s (linha tracejada), as ações de controle fazem com que o erro 

seja minimizado, a ponto de a dinâmica sobrepor o SP. 

Como observado na região ampliada da figura, ação de controle é rápida e 

em cerca de dois minutos, o SP é atingido. Apesar do bom desempenho, 

observam-se uma ação brusca nas ações integrais e derivativa, tendo uma taxa 

de variação de até 90,23 %/s. A retirada da ação derivativa (??=0) atenua a ação, 

mas ainda não atende o limite, retornado ações de controle de até 26,54 %/s. 

  

Figura 5.9: Desempenho servo dos controladores lineares (PID e PI) para 

controle de ???? pela manipulação da ?? , . 

Para analisar o ajuste junto à restrição da taxa de variação, a dinâmica foi 

incluída na resposta da válvula de controle, como descrito na seção anterior, 

seguido de uma reparametrização dos controladores. Com desempenho similar, o 

novo controlador (PIdin) tem um bom desempenho ao longo da troca de SP’s, mas 

a restrição limita sua robustez, como pode ser visto na Figura 5.10.  

0 10 20 30 40 50 60 70
0

50

100

C
K

 [
%

]

Tempo [h]

0 10 20 30 40 50 60 70
203

204

205

206

P
D

G
 x

1
0

5
 [
P

a
]

 

 

SetPoint

PID

PI

12.7 12.72 12.74 12.76 12.78 12.8
0

50

100

C
K

 [
%

]

Tempo [h]

12.7 12.72 12.74 12.76 12.78 12.8

203.6

203.8

204

P
D

G
 x

1
0

5
 [
P

a
]

 

 

SetPoint

PID

PI



90  Implementação do Controle Preditivo Não Linear 

 

 

Figura 5.10: Desempenho servo do controlador linear com a dinâmica na válvula 

PIdin para controle de ???? pela manipulação da ??. 

Contudo, o PIdin se limita a região equivalente à 10 % de abertura de 

válvula e a partir deste momento, com 63 h de teste, o controlador instabiliza o 

sistema. Entretanto, até esta região, o controlador é eficaz e alcança o SP 

desejado. Em relação aos controladores anteriores, a resposta das ações de 

controle é diferente, e como visto no detalhe da figura, age de forma 

compensatória à oscilação. Isso faz com que o tempo até atingir o SP seja quinze 

vezes maior, de dois para trinta minutos. 

5.3.2 Desempenho do Controlador Linear  

O controle linear apresentou elevado desempenho para os testes 

realizados, atingindo os valores de SP almejados até o caso em que a dinâmica 

da válvula é inserida, onde o controle perde desempenho, como já mostrado. 

Isso, provavelmente dá-se pela baixa robustez em regiões acima de 10 % de ??, 

consequência do fato de o controle linear utilizado possuir parâmetros fixos.  

Entretanto, em relação à malha aberta, a dinâmica da golfada é suprimida, 

como pode ser visualizado na Figura 5.11. Os controladores foram robustos 

diante das métrica, como indicado na Tabela 5.6, sugeridas no início da Seção 

5.3.  

0 10 20 30 40 50 60 70
0

50

100

C
K

 [
%

]

Tempo [h]

0 10 20 30 40 50 60 70
203

204

205

206
P

D
G

 x
1
0

5
 [
P

a
]

 

 

SetPoint

PI
din

13 14 15 16 17
3

4

5

6

C
K

 [
%

]

Tempo [h]

13 14 15 16 17
203

203.5

204

204.5

P
D

G
 x

1
0

5
 [
P

a
]

 

 

SetPoint

PI
din



5.3 Controle Linear VS Não Linear 91 

 

  

Figura 5.11: Desempenho servo dos controladores lineares (PID, PI e PIdin) para 

controle de ???? pela manipulação da ??. 

Tabela 5.6: Desempenho e robustez servo dos controladores lineares (PID, PI e 

PIdin) para controle de ???? pela manipulação da ??. 

SP x105 

[Pa] 

?(?? ? ??)? [Pa]² Mean ± StD (PV) x105 [Pa] 

MA PID PI PIdin MA PID PI PIdin 

201,22 
5,54 
x1011 

1,92 
x108 

1,92 
x108 

2,11 
x1015 

201,22  
± 0,01 

201,22 
± 0,98 

201,22 
±0,98 

200,77 ± 
0.86 

200,10 
3,1 

x1016 
2,64 
x1011 

2,67 
x1011 

8,35 
x1014 

200,10  
± 0,08 

200,10 
± 2,94 

200,10 
±2,94 

200,09 ± 
0,14 

199,72 
4,65 
x1017 

2,11 
x109 

2,11 
x109 

4,32 
x1015 

199,99  
± 3,03 

199,72 
± 5,88 

199,72 
±5,88 

199,73 ± 
0,02 

199,57 
1,24 
x1018 

7,69 
x108 

7,69 
x108 

1,32 
1015 

200,08  
± 4,43 

199,56 
± 0,29 

199,56 
±0,29 

199,57 ± 
0,01 

199,49 
1,94 
x1018 

4,81 
x108 

4,81 
x108 

7,89 
x1012 

199,97  
± 5,35 

199,49 
± 0,20 

199,49 
±0,20 

199,50 ± 
0,01 

199,47 
2,62 
x1018 

3,85 
x108 

3,85 
x108 

4,49 
x1018 

200,03  
± 5,99 

199,44 
± 0,20 

199,44 
±0,20 

200,27 ± 
7,86 

SP x105 

[Pa] 

Média ± Dvp (MV) [%] Taxa Máxima de Variação (MV) [%/s] 

MA PID PI PIdin MA PID PI PIdin 

201,22 2,00 2,00 
± 0,09 

2,00  
± 0,09 

2,15  
± 0,60 

- 1,15 1,15 0,19 

200,10 3,67 3,68  
± 1,55 

3,67  
± 0,71 

3,71  
± 0,43 

- 90,27 26,54 0,15 

199,72 5,67 5,72  
± 1,42 

5,71  
± 0,52 

5,67  
± 0,50 

- 90,53 6,42 0,05 

199,57 7,75 7,76  
± 0,82 

7,75  
± 0,48 

7,69  
±0,49 

- 51,54 2,44 0,02 

199,49 9,76 9,77  
± 0,57 

9,76  
± 0,47 

9,66  
± 0,50 

- 26,08 1,10 0,01 

199,47 11,8 11,78  
± 0,50 

11,78  
± 0,47 

52,10  
± 37,23 

- 14,85 0,55 1,20 

0 10 20 30 40 50 60 70
0

5

10

15

C
K

 [
%

]

Tempo [h]

0 10 20 30 40 50 60 70
190

200

210

P
D

G
 x

1
0

5
 [
P

a
]

 

 

Malha Aberta PID PI PIdin



92  Implementação do Controle Preditivo Não Linear 

 

A diferença das dinâmicas iniciais entre os controladores é salientada pela 

ação de controle. Isso interfere no valor do erro quadrático, que como visto na 

tabela, é maior para o controle com a dinâmica, em todos os casos.  

Em termos da média da CV e da MV, os resultados são idênticos, levando o 

processo às mesmas regiões de operação, com baixo desvio padrão (menor que 

0,5 % da CV). Em relação à malha aberta, a variação da CV diminui em até 96 % 

e em até 82 % para o PID/PI e PIdin, respetivamente. Esta diminuição na 

variabilidade é transferida de forma não significativa para a CV (até ± 41 % -PID, 

± 18 % - PI e 11 % - PIdin, relativos à média). 

5.3.3 Controlador NMPC SISO 

No teste para a estrutura NMPC de controle monovariável de ????  as 

vantagens do algoritmo não linear já é evidenciada no momento da 

implementação. As limitações físicas do sistema ( ???? , ???? , ±?? ) são 

diretamente incluídas na função custo, sem a necessidade de um ajuste de 

dinâmica, como no PIdin. Comparado ao controlador linear, a performance na 

região tipicamente oscilante em malha aberta é distinta em relação ao PI.  

Enquanto o controlador linear busca a ação que leva ao estacionário referente 

ao SP dado, até a região crítica (em 62,5 horas), o NMPC age na minimização da 

amplitude pela constante manipulação da ??, como ilustrado na Figura 5.12.  

Entretanto, como visto no detalhe, a manipulação da MV é baixa (até ±0,5 %) 

comparado ao ganho relativo à diminuição da oscilação em relação à malha 

aberta (maior que 98 %). Este comportamento, faz com que na região crítica ao 

PIdin, o NMPC mantenha a ?? num ciclo estável a fim de manter a CV em torno do 

SP. Além disso, o tempo para atingir o SP diminui significativamente, de trinta 

para seis minutos, com ações de controle similares, como observado no detalhe 

da Figura 5.12. 



5.3 Controle Linear VS Não Linear 93 

 

 
Figura 5.12: Desempenho servo do controlador não linear NMPC e do linear com 

a dinâmica na válvula PIdin para controle de ???? pela manipulação da ??. 

Entretanto, o NMPC possui uma leve diminuição do ganho da ??, como já 

observado no detalhe acima. Ao se analisar uma região ampliada, anterior ao 

ponto crítico, na , essa diferença de ganhos fica evidente. Enquanto o PIdin 

alcança valores de ?? de até 10 %, o NMPC alcança uma média de 9,9 %. 

 

Figura 5.13: Diferença de ganho da ?? entre o PIdin e o NMPC para controle de 

????. 

Outra vantagem fundamental em termos operacionais do controle baseado 

em modelo em relação ao PIdin, verificada ao longo dos testes, é a resposta frente 

à SP não-alcançáveis (valores de pressão dados que não são alcançáveis na 

análise estacionária do processo em malha aberta). Por não serem valores 

alcançáveis, controladores lineares, na tentativa de buscar valores inalcançáveis, 

instabiliza o processo. 

0 20 40 60
0

50

100

C
K

 [
%

]

Tempo [h]

 

 

0 20 40 60
203

204

205

206

P
D

G
x
1
0

5
 [

P
a
]

 

 

SetPoint

PI
din

NMPC

13 14 15 16 17

4

5

6

C
K

 [
%

]

Tempo [h]

 

 

13 14 15 16 17

203.5

204

P
D

G
 x

1
0

5
 [

P
a
]

 

 

SetPoint

PI
din

NMPC

45 50 55 60
8

9

10

C
K

 [
%

]

Tempo [h]

 

 

45 50 55 60
203

203.5

204

P
D

G
 x

1
0

5
 [

P
a
]

 

 

SetPoint

PI
din

NMPC



94  Implementação do Controle Preditivo Não Linear 

 

Já o NMPC, por trabalhar diretamente com a predição de um modelo 

interno, trata de forma naturalmente, retornando ações de controle que mantém a 

PV o mais próximo possível do SP. Este comportamento agrega valor à aplicação 

do NMPC frente ao PI, num processo não-linear e altamente suscetível à 

distúrbios desconhecidos. Em outras palavras, operacionalmente é desejada a 

maior produção possível a qual não se sabe ao certo o valor de SP.  

No entanto, para garantir um bom desempenho do controlador, mesmo o 

não-linear, o SP deve ser alcançável. Uma vez identificado o ponto de operação 

desejado o seu valor estacionário é calculado para garantir o alcance do 

controlador. 

5.4 Estratégias MISO 

A fim de explorar as vantagens do controlador baseado em modelo frente 

ao PID, a possibilidade do NMPC naturalmente trabalhar com sistemas 

multivariáveis a estrutura proposta na seção 4.3 foi testada. O controle 

multivarável (Multiple Input Single Output - MISO) incorpora a ??? como MV para 

controle de ???? . Os parâmetros de ajuste dos controladores foram mantidos 

como no caso SISO, pois o algoritmo trata as entradas e saídas (através do 

escalonamento de engenharia) antes de aplicar a função custo. 

A estrutura proposta mostrou-se eficaz no alcance do SP, assim como os 

demais. Como pode ser visto na Figura 5.14, o controlador age de forma similar à 

estrutura SISO até a região em torno de 6 % de ??. A diferença é que a adição da 

nova MV ameniza a manipulação da válvula, o que comparado ao controle SISO, 

faz com que a estrutura MISO perca velocidade de alcance do SP. Como visto no 

detalhe da figura, o tempo de assentamento dobra.  

Para regiões de menor ganho, a atuação da ???  ganha importância no 

controle do sistema, e como pode ser visto na Figura 5.14, a partir de 26 h há 

uma divisão de variabilidade entre as MV’s. A incorporação de mais um grau de 

liberdade implica numa redução, comparado ao SISO, na variabilidade da ?? em 

até 80 %. Essa variabilidade é transferida minimamente para a vazão de gás em 

± 67 Sm³/d (± 0,1 %). 



5.4 Estratégias MISO 95 

 

   
Figura 5.14: Desempenho servo do controlador não linear NMPC em uma 

estrutura SISO e uma estrutura MISO para controle de ???? pela manipulação da 

??. 

Entretanto, novamente o controlador diminui o ganho da de ??. A análise 

do trecho ampliado entre 9 e 10 horas (Figura 5.15) evidencia  diminuição de 

ganhos para duas trocas de SP. Enquanto a estrutura SISO varia de 8,1 para 

10 % de ?? média, a MISO varia de 7,3 para 8 %. 

   
Figura 5.15: Diferença de ganho de ?? entre o NMPCMISO e o NMPCSISO para 

controle de ????. 

5.4.1 Desempenho do Controlador Não Linear  

Assim como o linear, o controlador NMPC mostrou bom desempenho no 

alcance do SP, para as duas estruturas apresentadas. Comparando o PIdin com o 

NMPCSISO, o controlador não linear apresentou um desempenho similar na CV, 

até a região crítica ao linear, mas um menor ganho na MV média (de até 9.2 % 

0 10 20 30 40
9.95

10
x 10

4

W
g

l 
[S

m
³/

d
]

Tempo [h]

0 10 20 30 40
0

5

10

15

C
k
 [

%
]

0 10 20 30 40
203

204

205

206

P
D

G
 x

1
0

5
 [

P
a
]

 

 
SetPoint

NMPC
SISO

NMPC
MISO

9 10 11 12 13 14
9.99

9.995

10

10.005
x 10

4

W
g

l 
[S

m
³/

d
]

Tempo [h]

9 10 11 12 13 14

4

5

6

C
k
 [

%
]

9 10 11 12 13 14

203.5

204

P
D

G
 x

1
0

5
 [

P
a
]

 

 

SetPoint

NMPC
SISO

NMPC
MISO

25 30 35 40
9.95

10
x 10

4

W
g

l 
[S

m
³/

d
]

Tempo [h]

25 30 35 40
6

8

10

12

C
k
 [

%
]

25 30 35 40

203.2

203.4

203.6

P
D

G
 x

1
0

5
 [

P
a
]

 

 

SetPoint

NMPC
SISO

NMPC
MISO



96  Implementação do Controle Preditivo Não Linear 

 

para NMPCSISO e 9.7 % para o PIdin). Os resultados estão indicados na . 

Entretanto, por tratar com naturalidade a região crítica, com baixo ganho na PV, o 

NMPC atingiu até 10,4 % de abertura de válvula. Isso traz um ganho em relação à 

PV de até 0,11x105 Pa em relação ao linear. Ainda assim, a estrutura possui uma 

alta taxa de variação da MV, batendo no limite superior ao longo da região de 

baixo ganho, que pode ser visualizado na Figura 5.15. 

Tabela 5.7: Desempenho e robustez servo dos controladores não lineares e PIdin, 

para controle de ???? pela manipulação da ??. 

SP x105 

[Pa] 

?(?? ? ??)? [Pa]² Mean ± StD (PV) x105 [Pa] 

MA PIdin 
NMPC 
SISO 

NMPC 
MISO 

MA PIdin 
NMPC 
SISO 

NMPC 
MISO 

201,22 
5,54 
x1011 

2,11 
x1015 

0,00 0,00 
201,22  
± 0,01 

200,77  
± 0,86 

201,22  
± 0,00 

201,22  
± 0,00 

200,10 
3,1 

x1016 
8,35 
x1014 

9,62 
x1011 

3,85  
x1011 

200,10  
± 0,08 

200,09  
± 0,14 

200,10 
± 0,00 

200,11  
± 0,00 

199,72 
4,65 
x1017 

4,32 
x1015 

9,62 
x1011 

9,62  
x1011 

199,99  
± 3,03 

199,73  
± 0,02 

199,73 
 ± 0,00 

199,73  
± 0,00 

199,57 
1,24 
x1018 

1,32 
1015 

2,98  
x1012 

8,17  
x1012 

200,08  
± 4,43 

199,57  
± 0,01 

199,56  
± 0,02 

199,61 
 ± 0,02 

199,49 
1,94 
x1018 

7,89 
x1012 

3,15  
x1013 

2,67  
x1013 

199,97  
± 5,35 

199,50  
± 0,01 

199,51  
± 0,06 

19958  
± 0,06 

199,47 
2,62 
x1018 

4,49 
x1018 

5,73  
x1013 

4,16  
x1013 

200,03  
± 5,99 

200,27  
± 7,86 

199,49  
± 0,11 

199,57 
 ± 0,11 

SP x105 

[Pa] 

Média ± Dvp (MV) [%] Taxa Máxima de Variação (MV) [%/s] 

MA PIdin 
NMPC 
SISO 

NMPC 
MISO 

MA PIdin 
NMPC 
SISO 

NMPC 
MISO 

201,22 2,00 
2,15  

± 0,60 
2,00  

± 0,00 
2,00  

± 0,00 
- 0,19 0,00 0,00 

200,10 3,67 
3,71 

 ± 0,43 
3,72  

± 0,45 
3,49  

± 0,51 
- 0,15 0,07 0,02 

199,72 5,67 
5,67  

± 0,50 
5,76  

± 0,44 
5,45  

± 0,55 
- 0,05 0,07 0,02 

199,57 7,75 
7,69  

± 0,49 
7,93  

± 0,50 
6,90  

± 0,37 
- 0,02 0,36 0,03 

199,49 9,76 
9,66  

± 0,50 
9,22  

± 0,31 
7,81  

± 0,08 
- 0,01 0,36 0,08 

199,47 11,8 
52,10  
± 37,2 

9,91  
± 0,45 

7,96  
± 0,09 

- 1,20 0,36 0,07 

Neste sentido, a estrutura multivarável diminui a taxa de variação da ??, 

distribuindo de forma igualitária (devido ao ajuste com pesos iguais empregados 

no sistema) a variação entre válvula e alimentação de gás. Isso faz com que a 

taxa de variação da ?? diminua significativamente (81 % em relação ao SISO, ). 

Apesar disso, comparando as estruturas, em regiões de ganho elevado (até 7 % 

de ?? ) a estrutura SISO mostrou-se mais eficiente quanto ao ganho e 

variabilidade da ??.  



1.1  97 

 
Por apresentar uma menor taxa de variação da CV, a estrutura MISO 

obteve um erro quadrático menor comparada à SISO, como indicado na . 

Contudo, a estrutura monovariável apresentou uma diferença de ganho na PV de 

0,08x105 Pa. Na próxima seção os impactos destes resultados na produção serão 

discutidos. 

5.5 Aumento Teórico da Produção 

A produtividade do poço, como já comentado, está diretamente ligada ao 

ponto de operação do poço. Quanto maior a abertura da válvula ou maior a 

injeção de gás de elevação (até o ponto de Máxima Produção, ver seção 2.4), 

maior será a produção teórica, como introduzido na Seção 1.2. O comportamento 

foi reproduzido com o modelo simplificado ajustado ao Poço A, a fim de validar 

este comportamento com o modelo.  

A Figura 5.16 reproduz este comportamento médio (em azul) e o estacionário 

(em vermelho) para variações de ?? de 2 a 20 % e ??? de 6x10
4 (A), 8x104 (B) e 

10x104 Sm³/d (C). Na ilustração, a diminuição de ganho de pressão para 

aberturas de válvula maiores que 7 % fica clara. Analogamente, a Produção de 

Óleo sofre uma diminuição de ganho na mesma região e isso também está 

relacionado à alimentação de gás. Quanto menor a alimentação de gás, mais 

adiantada (em relação a ??) esta perda de ganho ocorrerá. O método de cálculo 

dos valores estacionário de pressão e produção de óleo está apresentado no 

Apêndice C - Construção do Diagrama de Bifurcação. 

Assim, a produtividade do poço está associada ao ponto de operação e 

consequentemente à estratégia de controle, que como visto da seção anterior, 

atua de formas diferentes. A transição do ponto de operação causada pelos 

controladores leva o sistema a diferentes pontos dentro da região 

operacionalmente instável em malha aberta. A , representa um mapa de 

estabilidade em relação às entradas, indicando a transição da dinâmica estável 

para a golfantes em malha aberta.  

 



98  Implementação do Controle Preditivo Não Linear 

 

 

Figura 5.16: Diagrama de bifurcação do Poço A, identificando o ganho dos 

valores médios (azul) e teóricos no estado estacionário (vermelho) da ???? e da 

Produção de Óleo (admensionalizada) perante as entradas ?? e ??? de 6x10
4 (A), 

8x104 (B) e 10x104 (C) Sm³/d. 

   
Figura 5.17: Transição do ponto de operação médio dos controladores PIdin e 

NMPC’s (pontos) para um SP de 199,49x105 Pa , com ampliação da região 

indicando o desvio padrão.  

A transição em malha fechada, para um SP de 199,49x105 Pa está 

ilustrada na figura. Enquanto o controlador PIdin e o NMPCSISO alcançam ganhos 

similares em torno de 9,5 %, em relação à média da válvula, a estrutura MISO 

alcança 1,5 % menos. Observando a distribuição dos pontos de atuação nas 

5 10 15 20
203

203.5

204

204.5

205

205.5

206

206.5

207

Choke [%]

P
D

G
 x

1
0

5
 [

P
a
]

 

 

5 10 15 20
0.8

1

1.2

1.4

1.6

1.8

Choke [%]

P
ro

d
u
ç
ã
o
 d

e
 Ó

le
o
 [

a
d
m

]

 

 

Valor Médio Valor Estacionário Ponto Bifurcação

W
gl

 = 6x10
4

W
gl

 = 8x10
4

W
gl

 = 10x10
4

A

B

B

C

C

A

2 4 6 8 10 12
6

7

8

9

10

11
x 10

4

W
g

l [
S

m
³/

d
]

CK [%]

 

 

Limite de Estabilidade

PI
din

NMPC
SISO

NMPC
MISO

Região Instável em 
Malha Aberta 

 

R
e
g
iã

o
 E

s
tá

v
e
l 
e
m

 
M

a
lh

a
 A

b
e
rt

a
 



5.5 Aumento Teórico da Produção 99 

 
MV’s, no detalhe ampliado da , fica evidente a diferença entre variabilidade das 

ações de controle. Enquanto o PIdin exige mais da ??, o NMPCSISO atua de forma 

preditiva e consequentemente mais amena e a estrutura SISO ameniza a 

variabilidade com o ???. 

Essa manipulação do ponto de operação implica não somente na 

diminuição da oscilação do processo, em relação à malha aberta, mas também no 

deslocamento do ponto de bifurcação. Para comparar as mudanças na 

localização de Hopf, as variações em ????abaixo de 0,1x10
5 Pa são consideradas 

produção livre de golfadas, pois este valor não é absorvido pelo sistema e não 

implica na oscilação da produção.  

Na Figura 5.18, o diagrama de bifurcação, em relação à PV e à Produção de 

óleo é apresentado, para comparação entre a resposta em Malha Aberta e as 

respostas em malha fechada. O controle linear PIdin movimenta o ponto de 

bifurcação aumentando a região da operação livre de golfadas até uma ?? média 

de 9,68 %. Isso acarreta num aumento teórico de produção de até 9,2 %, em 

relação à produção livre em malha aberta.  

  

Figura 5.18: Diagrama de Bifurcação de ???? e Produção de Óleo para a ?? para 

os controladores PIdin e NMPC’s, com a identificação do ponto de bifurcação (Bif.) 

para cada controlador. 

Este ganho (livre de golfadas) diminui com o NMPCSISO para 5,76 % de ??, 

implicando num aumento de 5,6 % de produção de óleo livre. Este ganho é 

parcialmente recuperado com a utilização da estrutura multivariável. Quando o 

5 10 15

1.2

1.3

1.4

1.5

1.6

1.7

Choke [%]

P
ro

d
u
ç
ã
o
 d

e
 Ó

le
o
 [

a
d
m

]

 

 

5 10 15
203

203.5

204

204.5

205

205.5

Choke [%]

P
D

G
 x

1
0

5
 [

P
a
]

 

 

Média

Téorica

Bif.MA

Bif.NMPC
SISO

Bif.NMPC
MISO

Bif.PI
din

NMPC
SISO

PI
din

NMPC
MISO



100  Implementação do Controle Preditivo Não Linear 

 

???  é combinado, o ponto Hopf é deslocado para 6,9 % da abertura do 

estrangulamento com aumento de 7,3 % na produção de óleo livre.  

Estes indicadores de aumento e deslocamentos relativos estão quantificados e 

apresentados na . Apesar da menor produção relativa (em relação ao controle PI), 

o NMPC apresentou uma habilidade única tratando a não-linearidade em regiões 

críticas para controle linear.  

Conforme discutido em seções anteriores, o controlador LLT é capaz de 

diminuir a amplitude da golfada (em comparação com a operação em malha 

aberta) e, como ilustrado na Figura 5.18, afetando diretamente a produção.  

Tabela 5.8: Comparação entre o esforço das ações de controle, ao longo da troca 

de SP, para os controladores linear (PIdin) e não lineares (NMPCSISO e NMPCMISO). 

 OL PIdin NMPCSISO NMPCMISO 

Deslocamento da Bifurcação 
(% Abertura da choke) 

4.00 9.68 5.76 6.90 

Produção de Óleo Relativa  
Livre de Golfadas 

0% +9.2% +5.6% +7.3% 

Esforço relativo da 
Choke na região crítica 

SP=199,49x105Pa - 0% -38% -84% 

SP=199,47 x105Pa  - - 0% -80% 

Produção de óleo 
relativa na região 
crítica 

SP=199,49x105Pa 0% +9.2% +8.3% +7.2% 

SP=199,47x105Pa  0% +5.2% +9.0% +7.3% 

Com pequena oscilação PDG, o NMPCSISO pode atingir o desempenho PI com 

aumento de 9,2 % de produção média de óleo em comparação com uma 

produção de circuito aberto. O ônus é que a produção varia de ± 12,0 %, mas 

com menor esforço da ?? (-38 %).  

Para suavizar essa variabilidade de produção, a estrutura MISO suaviza não 

só o uso da MV (-80 %), mas como a variabilidade da produção, que cai para ± 

2,5 %. Mesmo assim, para o NMPCMISO, a produção atinge a magnitude de 1,57 

fluxo de óleo adimensional que é apenas 1,25 % menor do que as outras 

estruturas, como indicado na Tabela 5.9.  



5.6 Resumo Comparativo dos Controladores 101 

 
Tabela 5.9: Produção de óleo teórica para a malha aberta e para as malhas 

fechadas dos controladores linear (PIdin) e não lineares (NMPCSISO e NMPCMISO), 

ao longo da troca de SP. 

SP x105 

[Pa] 

Produção Teórica de Óleo [adm] 

MA PIdin 
NMPC 
SISO 

NMPC 
MISO 

201.22 - 1,30 ± 1,69 1,21 ± 0,00 1,21 ± 0,00 

200.10 1,45 ± 0,78 1,45 ± 0,25 1,45 ± 0,03 1,45 ± 0,04 

199.72 1,48 ± 2,92 1,53 ± 0,07 1,53 ± 0,01 1,53 ± 0,01 

199.57 1,44 ± 4,31 1,57 ± 0,03 1,57 ± 0,06 1,56 ± 0,02 

199.49 1,49 ± 5,45 1,59 ± 0,02 1,58 ± 0,14 1,57 ± 0,05 

199.47 1,39 ± 5,28 1,43 ± 11,59 1,59 ± 0,19 1,57 ± 0,04 

 

5.6 Resumo Comparativo dos Controladores 

Para resumir os resultados deste trabalho, em termos de custo x benefício, 

os controladores aplicados foram avaliados, em uma escala quantitativa de 1 a 3, 

sendo 1 pior e 3 melhor, dentro das principais características necessárias para 

uma implementação real.  

Como pontos cardeais, levando em consideração os objetivos introduzidos 

no início deste trabalho, a Atenuação do Ciclo Limite, a Simplicidade de 

Implementação, Desempenho Servo e Otimização Econômica da Produção 

(maior produção de petróleo) foram avaliadas e ilustrada na Figura 5.19.  

 

Figura 5.19: Resumo e quantificação dos principais objetivos da implementação 

de controle em sistemas golfantes. 

Como visto ao longo do trabalho, o Controlador linear (PIdin) ganha 

destaque nos quesitos Otimização Econômica e Simplicidade de Implementação. 



102  Implementação do Controle Preditivo Não Linear 

 

De forma antagônica, o Controlador NMPCMISO ganha destaque ao verificarmos a 

Atenuação das golfadas e o Desempenho Servo enquanto que a versão 

NMPCSISO alia todas estas características de forma harmônica exibindo um 

comportamento médio.  

Entretanto, em termos de implementação real, outros pontos (análogos aos 

pontos colaterais) devem ser levados em consideração. Assim, foi agregado a 

análise as características relacionadas ao (Menor) Uso da ?? , característica 

Multivariável, comportamento frente a SP não alcançáveis e estabilização do ciclo 

limite. Estes novos fatores salientam as vantagens da estrutura MISO, frente às 

demais, como pode ser visualizado na Figura 5.20. 

 

Figura 5.20: Resumo e quantificação das características dos controladores 

visando a aplicação real, salientando as vantagens do controlador multivariável. 

5.7 Aplicação do Método em um Sistema Real  

O objetivo deste trabalho consiste no desenvolvimento de um método de 

controle automático para aplicação em um sistema real de produção. Para tanto, 

será resumido um passo a passo da sistemática do método para uma aplicação 

real. 

Num primeiro momento, após a disponibilidade do poço para estudo, uma 

etapa de Coleta deve identificar as constantes diretas do modelo relacionadas a 

batimetria e às propriedades físico-químicas. Em paralelo, as restrições físicas do 

sistema das variáveis de controle, como as taxas de variação permitidas e a 

grandeza máxima e mínima devem ser determinadas. Assim que determinadas, 



5.7 Aplicação do Método em um Sistema Real 103 

 
um intervalo de dados representativos das pressões (????, ??? ? ????) e entradas 

do sistema (???, ?, ?? ? ??) deve ser coletado e tratado. 

Com estas informações, o próximo passo é o Ajuste do Modelo, conforme o 

método proposto no Capítulo 3 – e demonstrada na seção 5.1. Como o modelo 

estimado é possível identificar os ganhos do sistema e construir o diagrama de 

bifurcação (Apêndice C). A partir deste momento, uma validação online deve ser 

realizada pela simulação do modelo e comparação direta com dados de processo 

em tempo real. Para questões de ajuste fino da dinâmica, pode ser realizado o 

estudo de Identificabilidade, demonstrado na seção 5.1.3. 

O próximo passo é o ajuste dos parâmetros da estrutura de controle, 

demostrado na seção 5.2 para o NMPC e na 5.2.1 para o EKF. Assim que 

determinados, a estrutura está pronta para os primeiros testes off-line, que 

consistem no cálculo das ações de controle dadas pelo algoritmo de controle, sem 

a aplicação no sistema real. Com isto é possível monitorar as ações e observar 

qualquer comportamento indesejado, para que seja corrigido antes da aplicação 

efetiva em planta. Por fim, o algoritmo está apto para a aplicação Online. Esta 

sistemática está resumida e indicada no fluxograma da Figura 5.21.  

  

Figura 5.21: Fluxograma da sistemática de construção do método de controle de 

poços através de controlador não linear baseado em modelo. 



104  Implementação do Controle Preditivo Não Linear 

 

5.7.1 Estimação de um Sistema Real  

Durante o desenvolvimento deste trabalho e até o presente momento, em 

parceria com o Centro de Pesquisas da Petrobras, o método foi aplicado até a 

etapa de validação online. As etapas foram aplicadas a um poço real, que foi a 

base para a construção do poço “virtual” A. Até esta etapa, o método obteve 

sucesso como ilustrado na Figura 5.22 pela representação dinâmica de ????. 

Apesar de o novo modelo não captar por completo toda a dinâmica do 

sistema, observada por uma discrepância na região de pico dos ciclos, a 

representatividade da dinâmica cíclica se adequou satisfatoriamente ao 

comportamento real. Em termos de controle, essa leve discrepância não afeta o 

desempenho do controlador de forma significativa, muito por cnta da 

retroalimentação do sistema pelo EKF. 

Os estudos da dinâmica e dos ganhos foram aplicados com o modelo 

ajustado e os próximos passos que compreendem os testes offline das ações de 

controle do NMPC estão em andamento 

 

Figura 5.22: Predição do modelo simplificado ajustado a um poço real através do 

método proposta. 

 

  



 

105 

  Conclusões e Trabalhos 
futuros 

Neste capítulo serão apresentadas as conclusões a respeito da aplicação 

do controlador NMPC para atenuação de golfadas em sistemas offshore. A 

análise crítica está dividida entre a elaboração e reprodutibilidade do modelo 

simplificado apresentado, na seção 6.1, e a aplicação do algoritmo LLT em 

sistemas de produção de petróleo por Gas-lift, na seção 6.2. A continuidade do 

trabalho está apresentada nos próximos passos, na seção 6.3. Baseado nestas 

avaliações, sugestões para a continuidade e desenvolvimentos futuros serão 

indicadas na seção 6.4. 

6.1 Conclusões da Modelagem 

Diante da necessidade inicial, o modelo simplificado apresentado se 

adequa para representação de sistemas tipicamente brasileiros. O modelo 

engloba de forma associativa as principais características físicas do sistema 

(dimensões do sistema Anular-Tubing-Pipeline-Riser) e as físico-químicas do 

processo. O modelo foi satisfatório em termos de validação e extrapolação da 

dinâmica em sistemas reais.  

Com o mesmo, foi mostrado que é possível uma análise da dinâmica do 

sistema, de forma não intrusiva, para estudo da dinâmica e análise de ganhos do 

processo. Este modelo foi uma contribuição deste trabalho que culminou no 

desenvolvimento do trabalho publicado e proposto por Diehl et al.(2017), 

chamado Fast Offshore Well Model. 



106  Conclusões e Trabalhos futuros 

 

A dinâmica cíclica do processo da golfada mostrou dificuldade de estimar 

os parâmetros para o método clássico de ajuste, retornando resultados 

indesejados no ponto de vista de representatividade da dinâmica. Este 

comportamento foi tratado pela penalização de regiões indesejadas através da 

comparação da derivada e do período dos sinais. A penalização foi incluída de 

forma que, para o resultado ótimo, o termo de penalização zera, mantendo a 

representatividade dos mínimos quadrados. 

Entretanto, o modelo ainda não é capaz de representar todos os 

mecanismos que geram a golfada necessitando um ajuste estrutural para tanto, 

conforme o sugerido para sistemas que utiliza válvula do tipo venturi para injeção 

de gás. Outro problema é a utilização futura de métodos de otimização que fazem 

uso da derivada. O problema da descontinuidade das funções de vazão é tratado 

pela modificação estrutural sugerida. 

6.2 Conclusões do Controle 

Devido a não linearidade do sistema, o controlador linear mostrou uma 

perda de robustez em regiões de baixo ganho, uma vez que o ajuste é baseado 

numa região de elevado ganho (ação de controle brusca). Isso está relacionado 

ao uso de parâmetros fixos (constantes proporcional, integral e derivativa), o que 

sugere que para aplicações deste tipo de estrutura (PI/PID) utilizem constantes 

variáveis, como a estrutura gain-scheduling.  

O NMPC, mostrou-se robusto quanto à não linearidade do sistema, 

trabalhando naturalmente em regiões de baixo ganho. A estrutura a ser utilizada 

(SISO ou MISO) influencia diretamente no comportamento das MV’s. Ao 

aumentar graus de liberdade no controlador (pela adição do gás de elevação 

como MV) o ganho tem uma diminuição sensível. Entretanto, a taxa de utilização 

das MV’s é distribuída, o que pode facilitar a aceitação da aplicação real das 

equipes de operação. 

Em termos de produção, a estratégia deve ser definida antes da 

determinação do objetivo. Se o objetivo é o de eliminar a golfada, o controlador 

linear mostrou maior capacidade, mas em contrapartida é mais sensível à 

mudança de dinâmica em regiões de baixo ganho. Se o objetivo é aumentar a 



6.3 Próximos Passos 107 

 
produção o NMPC na forma monovariável alcança resultados semelhante ao PI, 

mas de forma mais robusta em relação às não linearidades. Entretanto a taxa de 

utilização da válvula aumenta. Ainda assim, se isto for um empecilho para uma 

aplicação real, a incorporação da multivariabilidade do controlador NMPC faz com 

que a taxa de utilização seja distribuída entre as MV’s, amenizando o uso 

excessivo das válvulas. 

6.3 Próximos Passos 

Os próximos passos do trabalho compreendem a aplicação e teste off-line 

da estrutura NMPCMISO no sistema real, inicialmente ajustado (seção 5.7.1).  

Num próximo momento, com o intuito de incorporar as melhores 

características de cada um dos controladores, estruturas híbridas de NMPC e PID 

serão estudadas. O intuito é construir um sistema hierárquico de controle onde o 

controlador não linear atue na otimização de produção e o linear atue na 

supressão da golfada.  

6.4 Sugestões para Trabalhos Futuros 

Diante dos resultados apresentados algumas necessidades foram 

identificadas.  

Em termos de modelagem, a característica dinâmica de sistemas de 

petróleo (especificamente relativos à vida útil dos reservatórios) traz a 

necessidade de uma atualização dos parâmetros do modelo. Para tanto, o 

método utilizado para Identificabilidade dos parâmetros não mostrou-se 

conclusiva e fidedigna à realidade, devido a diferença de dinâmica dos pontos de 

operação. Assim, um método de análise da sensibilidade que leve em conta a 

multivariabilidade do sistema deve ser estudada e aplicada na formulação de uma 

sistemática de atualização do modelo. 

Para o controle, na utilização de controladores lineares, faz-se necessária a 

definição de uma sistemática de ajuste dos mesmo para sistema cíclicos. Não só 

os métodos de ajuste, mas também as métricas clássica de robustez e 

desempenho levam em conta processos tipicamente convergentes. Uma vez que 

a golfada é um ciclo limite, tais métodos perdem significância e reprodutibilidade 

para o caso estudo. Isto também é valido para a análise de desempenho do 

NMPC. 



108  Conclusões e Trabalhos futuros 

 

Uma ferramenta, a qual foi pouco explorada neste trabalho e que é de 

extrema importância para o funcionamento do método proposto é o EKF. Este 

método de retroalimentação pode ser explorada através da definição de uma 

sistemática de ajuste para sistemas cíclicos e até mesmo a comparação deste 

com outros tipos de retroalimentação. Além disso, sugere-se um estudo 

comparataivo com outras técnicas de retroalimentação como o Unscentend 

Kalman Filter e o Moving Horizon Estimation.  

Em termos de aplicabilidade do método apresentado, devido à mudança de 

dinâmica dos reservatórios há a necessidade de um sistema de monitoramento 

dessa mudança. Uma vez que o método é baseado numa dinâmica conhecida, a 

retroalimentação das mudanças é necessária para um bom desempenho à longo 

prazo. 

Como já indicado nos próximos passos, o estudo de novas estruturas de 

controle é uma possibilidade interessante. Não só a estrutura em si, mas como 

estratégias que utilizem outras variáveis de processo como CV’s.  

 
  



 

109 

Referências  

AAMO, O. M. et al. Observer design for multiphase flow in vertical pipes with gas-
lift - Theory and experiments. Modeling, Identification and Control, v. 26, n. 2 
SPEC. ISS., p. 65–80, 2005. 

ALMEIDA, Alcino Resende De; GONÇALVES, Marcelo De Albuquerque Lima. 
DEVICE AND METHOD FOR ELIMINATING SEVERE SLUGGING IN 
MULTIPHASE-STREAM FLOW LINES. . Brazil: [s.n.]. , 1999 

ALSHEHRI, A. K.; RICARDEZ-SANDOVAL, L. A.; ELKAMEL, A. Designing and 
Testing a Chemical Demulsifier Dosage Controller in a Crude Oil Desalting Plant: 
An Artificial Intelligence-Based Network Approach. Chemical Engineering &amp;amp; 
Technology, n. 6, p. n/a-n/a, 2010.  

ANP. Boletim Anual de Preços?: preços do petróleo, gás natural e combustíveis 
nos mercados nacional e internacional. Agência Nacional do Petróleo, Gás 
Natural e Biocombustíveis. Rio de Janeiro: [s.n.], 2015. 

ÅSTRÖM, K. J.; HÄGGLUND, T. The future of PID control. Control Engineering 
Practice, v. 9, n. 11, p. 1163–1175, 2001. 

BELT, R et al. Comparison of commercial multiphase flow simulators with 
experimental and field databases. 15th International Conference on Multiphase 
Production Technology, p. 413–427, 2011.  

BENDIKSEN, Kjell H. et al. The Dynamic Two-Fluid Model OLGA: Theory and 
Application. SPE Production Engineering, v. 6, n. 2, p. 171–180, 1 maio 1991.  

BEQUETTE, B. W. Process Dynamics: Modeling, Analysis and Simulation. [S.l.]: 
Prentice Hall Professional, 1998.  

BOE, A. Severe slugging characteristics. 1981, Trondheim, Norway: [s.n.], 1981.  

BOTELHO, Viviane. Nova Metodologia para Análise de Identificabilidade e 
Estimação de Parâmetros de Modelos Fenomenológicos. 2012. 123 f. 
UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL, 2012.  



110   

 

BRASIL. Setor de petróleo e gás chega a 13% do PIB brasileiro. Disponível em: 
&lt;http://www.brasil.gov.br/economia-e-emprego/2014/06/setor-de-petroleo-e-gas-
chega-a-13-do-pib-brasileiro&gt;. Acesso em: 13 out. 2015.  

CAMACHO, Eduardo F.; BORDONS, Carlos. Model Predictive Control. [S.l: s.n.], 
1999.  

CAMPONOGARA, Eduardo et al. An automation system for gas-lifted oil wells: 
Model identification, control, and optimization. Journal of Petroleum Science and 
Engineering, v. 70, n. 3–4, p. 157–167, 2010. 

CODAS, Andres; JAHANSHAHI, Esmaeil; FOSS, Bjarne. A two-layer structure for 
stabilization and optimization of an oil gathering network ?. 11th IFAC Symposium 
on Dynamics and Control of Process Systems, including Biosystems. Trondheim, 
Norway: [s.n.]. , 2016 

DE CAMPOS, Mario Cesar M. Massa; TEIXEIRA, Herbert Campos Gonçalves. 
Controles Típicos de Equipamentos e Processos Industriais. 2a ed. São Paulo, 
SP, Brazil: Petrobras, 2010.  

DE SOUZA, J. N M et al. Modeling, simulation and optimization of continuous gas 
lift systems for deepwater offshore petroleum production. Journal of Petroleum 
Science and Engineering, v. 72, n. 3–4, p. 277–289, 2010. 

DI MEGLIO, F. et al. Model-based control of slugging: Advances and challenges. 
IFAC Proceedings Volumes (IFAC-PapersOnline), v. 1, n. PART 1, p. 109–115, 
2012. 

DI MEGLIO, Florent et al. Slugging in multiphase flow as a mixed initial-boundary 
value problem for a quasilinear hyperbolic system. American Control Conference 
(ACC), n. August 2011, p. 3589–3596, 2011. 

DI MEGLIO, Florent et al. Stabilization of slugging in oil production facilities with or 
without upstream pressure sensors. Journal of Process Control, v. 22, n. 4, p. 
809–822, 2012. 

DI MEGLIO, Florent; KAASA, Glenn Ole; PETIT, Nicolas. A first principle model for 
multiphase slugging flow in vertical risers. Proceedings of the IEEE Conference on 
Decision and Control, p. 8244–8251, 2009. 

DIEHL, F.C. et al. Fast Offshore Wells Model (FOWM): A practical dynamic model 
for multiphase oil production systems in deepwater and ultra-deepwater scenarios. 
Computers and Chemical Engineering, v. 99, 2017. 

DURAISKI, Ricardo Guilherme et al. MÉTODO PREDITIVO, MULTIVARIÁVEL 
NÃO LINEAR PARA O CONTROLE DE PROCESSOS. . Brazil: [s.n.]. , 2002 

ECK, J et al. Downhole Monitoring: The story so far. Oilfield Review, v. 11, n. 4, p. 
20–23, 1999. 

EHINMOWO, Adegboyega Bolu; CAO, Yi. Stabilizing slug flow at large valve 



6.4 Referências 111 

opening using active feedback control Stabilizing slug flow at large valve opening 
using active feedback control. International conference on automation and 
computing, n. SEPTEMBER, p. 1–6, 2015. 

EIKREM, Gisle Otto; AAMO, Ole Morten; FOSS, Bjarne. On Instability in Gas Lift 
Wells and Schemes for Stabilization by Automatic Control. SPE Production &amp;amp; 
Operations, v. 23, n. 2, p. 268–279, 2008. 

FILHO, Haroldo dos S. R. A Otimização de Gás Lift na Produção de Petróleo: 
Avaliação da Curva de Performance do Poço. 2011. 92 f. UFRJ, 2011.  

FINKEL, D. E. DIRECT optimization algorithm user guide. . [S.l: s.n.], 2003. 

GODHAVN, John Morten; FARD, Mehrdad P.; FUCHS, Per H. New slug control 
strategies, tuning rules and experimental results. Journal of Process Control, v. 15, 
n. 5, p. 547–557, 2005. 

GUO, Boyun; LYONS, William C.; GHALAMBOR, Ali. Petroleum Production 
Engineering. Petroleum Production Engineering. [S.l: s.n.], 2007a. p. 181–206.  

GUO, Boyun; LYONS, William C; GHALAMBOR, Ali. Chapter 13 - Gas-Lift. 
Petroleum Production Engineering. [S.l: s.n.], 2007b. p. 181–206.  

GUSTAVSEN, Øyvind; TONDEL, P. Production Optimization using Automatic 
Control at Heidrun. 2009, 11 March, Bergen, Norway: StatoilHydro, 2009.  

HANAPI, B. M.; ARIFFIN, S.; WAN, A. A. Study on demulsifier formulation for 
treating Malaysian crude oil emulsion. p. 158, 2006. 

HARMATHY, Tibor Z. Velocity of large drops and bubbles in media of infinite or 
restricted extent. AIChE Journal, v. 6, n. 2, p. 281–288, 1960. 

HASSANEIN, T.; FAIRHURST, P. Challenges in the mechanical andhydraulic 
aspects of riser design for deep water developments. 1998, Oslo, Norway: [s.n.], 
1998.  

HESKESTAD, Karl Ludvig. Field Data Analysis Using the Multiphase Simulation 
Tool OLGA2000. 2005. 89 f. Norges teknisk-naturvitenskapelige universitet 
Studieprogram, 2005.  

HU, B. Characterizing gas-lift instabilities. 2004. 178 f. Norwegian University of 
Science and Technology, 2004.  

HUSSEIN, Huda; AL-DURRA, Ahmed; BOIKO, Igor. Design of gain scheduling 
control strategy for artificial gas lift in oil production through modified relay 
feedback test. Journal of the Franklin Institute, 2015.  

IGUMA, Eliseo; SORRELL, Mike. Pumps for the Booming FPSO Sector. 

IMSLAND, Lars Struen. Output feedback stabilization and control of positive 
systems. 2002. 210 f. Norwegian University of Science and Technology, 2002.  

JAHANSHAHI, E.; SALAHSHOOR, K.; SAHRAIE, Y. Application of fuzzy observer 
and controller in gas-lifted oil wells. Proceedings of 2008 IEEE International 
Conference on Networking, Sensing and Control, ICNSC, p. 101–106, 2008. 



112   

 

JAHANSHAHI, Esmaeil et al. A comparison between Internal Model Control, 
optimal PIDF and robust controllers for unstable flow in risers. IFAC Proceedings 
Volumes (IFAC-PapersOnline), v. 19, n. March 2016, p. 5752–5759, 2014. 

JAHANSHAHI, Esmaeil. Control solutions for multiphase flow – Linear and 
nonlinear approaches to anti-slug control. 2013. Norwegian University of Science 
and Technology, 2013.  

JAHANSHAHI, Esmaeil; SKOGESTAD, Sigurd. Comparison between nonlinear 
model-based controllers and gain-scheduling Internal Model Control based on 
identified model. Proceedings of the IEEE Conference on Decision and Control, p. 
853–860, 2013. 

JAHANSHAHI, Esmaeil; SKOGESTAD, Sigurd. Simplified dynamical models for 
control of severe slugging in multiphase risers. IFAC Proceedings Volumes (IFAC-
PapersOnline), v. 18, n. PART 1, p. 1634–1639, 2011. 

JAHANSHAHI, Esmaeil; SKOGESTAD, Sigurd; HANSEN, Henrik. Control 
structure design for stabilizing unstable gas-lift oil wells. IFAC Proceedings 
Volumes (IFAC-PapersOnline), v. 8, n. PART 1, p. 93–100, 2012. 

JAHANSHAHI, Esmaeil; SKOGESTAD, Sigurd; HELGESEN, Anette H. 
Controllability analysis of severe slugging in well-pipeline-riser systems. IFAC 
Proceedings Volumes (IFAC-PapersOnline), v. 1, n. PART 1, p. 101–108, 2012. 

JANSEN, Bård et al. Automatic Control of Unstable Gas Lifted Wells. SPE Annual 
Technical Conference and Exhibition, p. 1–9, 1999. 

JANSEN, F. E.; SHOHAM, O.; TAITEL, Y. THE ELIMINATION OF SEVERE 
SLUGGING - EXPERIMENTS AND MODELING F. International Journal 
Multiphase Flow, v. 22, n. 6, p. 1055–1072, 1996. 

JARI, H R Kalat et al. A new approach for sizing finger - type ( multiple - pipe ) 
slug catchers. Gas Processing News, p. 1–9, 2015. 

KITTILSEN, Pål et al. Robust Automatic Well Choke Control – Physical Constraint 
Based Operation. 11th IFAC Symposium on Dynamics and Control of Process 
Systems, including Biosystems, Trondheim, Norway, 2016. , p. 296–301. 

KRIMA, Hazem; CAO, Yi; LAO, Liyun. Gas injection for hydrodynamic slug control. 
IFAC Proceedings Volumes (IFAC-PapersOnline), v. 1, n. PART 1, p. 116–121, 
2012. 

LEA, James F.; NICKENS, Henry V.; WELLS, Mike R. Chapter 11 - Gas Lift. Gas 
Well Deliquification. [S.l: s.n.], 2008. p. 331–359.  

LEEBEECK, A De; JOHANSEN, S T. Simulation of hydrodynamic slug flow using 
the LedaFlow slug capturing model. n. m, p. 365–383, 2013. 

LUO, Xiaoming et al. Influence of separator control on the characteristics of severe 
slugging flow. Petroleum Science, v. 11, n. 2, p. 300–307, 2014. 



6.4 Referências 113 

MACIEJOWSKI, J M M. Predictive control: with constraints. [S.l: s.n.], 2002.  

MASTERFLO. MasterFlo Actuators Catalog. . [S.l: s.n.], 2011. 

MCGUINNESS, M; COOKE, D. Partial Stabilisation at St. Joseph. Proceedings of 
the Third International Offshore and Polar Engineering Conference, June 6-11, 
Singapore, v. 2, n. June, p. 235–241, 1993. 

MOKHATAB, Saeid; POE, William A.; MAK, John Y. Raw Gas Transmission. 
Handbook of Natural Gas Transmission and Processing, p. 85–180, 2012.  

NEMOTO, Rafael Horschutz; BALIÑO, Jorge Luis. Modeling and simulation of 
severe slugging with mass transfer effects. International Journal of Multiphase 
Flow, v. 40, p. 144–157, 2012.  

NGUYEN, Duy; SADEGHI, Nicholas; HOUSTON, Christopher. Chemical 
interactions and demulsifier characteristics for enhanced oil recovery applications. 
Energy and Fuels, v. 26, n. 5, p. 2742–2750, 2012. 

PEDERSEN, Simon; DURDEVIC, Petar; YANG, Zhenyu. Review of Slug 
Detection , Modeling and Control Techniques for Offshore Oil &amp;amp; Gas Production 
Processes. IFAC-PapersOnLine, v. 48, n. 2006, p. 89–96, 2015.  

PETROBRAS. A cada desafio, novas tecnologias. Disponível em: 
&lt;http://presal.hotsitespetrobras.com.br/tecnologias-pioneiras/#7&gt;. Acesso em: 1 
maio 2016.  

PETROBRAS. Blog Fatos e Dados - Confira nossa produção de petróleo e gás 
natural em julho. Disponível em:&amp;lt;http://www.petrobras.com.br/fatos-e-
dados/confira-nossa-producao-de-petroleo-e-gas-natural-em-julho.htm&gt;. Acesso 
em: 1 ago. 2017.  

PETROBRAS. Blog Fatos e Dados - Produção anual de petróleo no Brasil 
aumenta 4,6% e supera nossa meta de 2015. Disponível em: 
&lt;http://www.petrobras.com.br/fatos-e-dados/producao-de-petroleo-anual-no-brasil-
aumenta-4-6-e-supera-nossa-meta-de-2015.htm&gt;. Acesso em: 20 jun. 2016.  

PLUCENIO, A et al. Gas-lift Optimization and Control with Nonlinear MPC. 
Proceedings of IFAC Inter-national Symposium on Advanced Control of Chemical 
Processes, v. 7, n. 1, p. 904–909, 2009.  

POWELL, Mjd. The BOBYQA algorithm for bound constrained optimization without 
derivatives. NA Report NA2009/06, p. 39, 2009. 

QIN, S. Joe; BADGWELL, Thomas A. An Overview of Nonlinear Model Predictive 
Control Applications. 1998, Ascona, Switzerland: [s.n.], 1998. p. 3–5.  

RIBEIRO, C.H.P. et al. Model Predictive Control with quality requirements on 
petroleum production platforms. Journal of Petroleum Science and Engineering, v. 
137, n. January 2016, p. 10–21, 2016. 

RIBEIRO, Cido Hernani Perissé. Controle Preditivo Multivariável Em Plataformas 
Para A Produção De Petróleo Com Restrição De Qualidade. 2012. 83 f. UFRJ, 
2012.  



114   

 

RITTER, Affonso. A crise da Petrobras e o PIB. Disponível em: 
&lt;http://jcrs.uol.com.br/site/noticia.php?codn=187109&gt;. Acesso em: 13 out. 2016.  

SALAHSHOOR, Karim; ZAKERI, Sepide; HAGHIGHAT SEFAT, Morteza. 
Stabilization of gas-lift oil wells by a nonlinear model predictive control scheme 
based on adaptive neural network models. Engineering Applications of Artificial 
Intelligence, v. 26, n. 8, p. 1902–1910, 2013. 

SALAU, N P G. Abordagem Sistemática para Construçao e Sintonia de 
Estimadores de Estados Não-Lineares. 2009. 182 f. UNIVERSIDADE FEDERAL 
DO RIO GRANDE DO SUL, 2009.  

SARICA, C.; SHOHAM, O. A Simplified Transient Model for Pipeline-Riser 
Systems. Chenricnl Engineering Science, v. 46, n. 9, p. 2167–2179, 1991. 

SCIBILIA, Francesco; HOVD, Morten; BITMEAD, Robert. Stabilization of gas-lift oil 
wells using topside measurements. IFAC Proceedings Volumes (IFAC-
PapersOnline), v. 17, n. 1 PART 1, 2008. 

SHAO, Weiming; BOIKO, Igor; AL-DURRA, Ahmed. Plastic bag model of the 
artificial gas lift system for slug flow analysis. Journal of Natural Gas Science and 
Engineering, v. 33, p. 573–586, 2016. 

SHEMER, Lev. Hydrodynamic and statistical parameters of slug flow. International 
Journal of Heat and Fluid Flow, v. 24, n. 3, p. 334–344, 2003. 

SHI, Jing et al. Stabilization of Artificial Gas-lift Process Using Nonlinear Predictive 
Generalized Minimum Variance Control. p. 4169–4174, 2016. 

SINEGRE, L.; PETIT, Nicolas; MENEGATTI, P. Predicting instabilities in gas-lifted 
wells simulation. 2006 American Control Conference, p. 8 pp., 2006.  

SINEGRE, Laure et al. Active control strategy for density-wave in gas-lifted wells. 
International Symposium on Advanced Control of Chemical Processes, v. xx, p. 1–
6, 2005. 

SINEGRE, Laure. DYNAMIC STUDY OF UNSTABLE PHENOMENA STEPPING 
IN GAS-LIFT ACTIVATED WELLS. 2006. École Nationale Supérieure des Mines 
de Paris, 2006.  

SIONG, Ang Kok. Parameter Estimation of Oscillatory Systems. 2009. NATIONAL 
UNIVERSITY OF SINGAPORE, 2009.  

SIVERTSEN, Heidi; STORKAAS, Espen; SKOGESTAD, Sigurd. Small-scale 
experiments on stabilizing riser slug flow. Chemical Engineering Research and 
Design, v. 88, n. 2, p. 213–228, 2010. 

SKOFTELAND, G et al. Implementation of a Slug Control System for Subsea 
Wells in an Integrated Operation Environment. 13th International Conference on 
Multiphase Production Technology, n. Figure 1, p. 225–236, 2007.  

SKOGESTAD, Sigurd; POSTLETHWAITE, I. Multivariable feedback control. New 



6.4 Referências 115 

York: Wiley: [s.n.], 1996.  

SLOTINE, Jean-Jacques E.; LI, Weiping. Applied Nonlinear Control. first ed. [S.l: 
s.n.], 1991.  

STANISLAV, J. F.; KOKAL, S.; NICHOLSON, M. K. Intermittent gas-liquid flow in 
upward inclined pipes. International Journal of Multiphase Flow, v. 12, n. 3, p. 
325–335, 1986. 

STORKAAS, E. Stabilizing control and controllability. 2005. 156 f. Norwegian 
University of Science and Technology, 2005.  

STORKAAS, E; SKOGESTAD, S; ALSTAD, V. Stabilization of Desired Flow 
Regimes in Pipelines. n. 1, p. 1–19, 2001. 

STORKAAS, Espen; SKOGESTAD, Sigurd. Controllability analysis of two-phase 
pipeline-riser systems at riser slugging conditions. Control Engineering Practice, v. 
15, n. 5, p. 567–581, 2007. 

STORKAAS, Espen; SKOGESTAD, Sigurd; GODHAVN, Jm. A low-dimensional 
dynamic model of severe slugging for control design and analysis. 11th 
International Conference on …, p. 117–133, 2003.  

TAITEL, Y. et al. Severe slugging in a riser system: experiments and modeling. 
International Journal of Multiphase Flow, v. 16, n. 1, p. 57–68, 1990. 

TAITEL, Y; BORNEA, D; DUKLER, AE. Modelling Flow Pattern Transitions for 
Steady Upward Gas-Liquid Flow in Vertical Tubes. AIChE Journal, v. 26, n. 3, p. 
345–354, 1980. 

TAITEL, Yehuda. Stability of severe slugging. International Journal of Multiphase 
Flow, v. 12, n. 2, p. 203–217, 1986. 

TEIXEIRA, Bruno O S et al. Data-driven soft sensor of downhole pressure for a 
gas-lift oil well. Control Engineering Practice, v. 22, n. 1, p. 34–43, 2014. 

TRIERWEILER, Jorge O; SECCHI, Argimiro Resende. Exploring the Potentiality of 
Using Multiple Model Approach in Nonlinear Model Predictive Control. Nonlinear 
Model Predictive Control. [S.l.]: Birkhäuser Basel, 2000. p. 191–203.  

VOGEL, J V. Inflow Performance Relationships for Solution-Gas Drive Wells. 
Journal of Petroleum Technology, v. 20, n. 1, p. 83–92, 1968. 

WANG, Zhou; BOVIK, Alan C. Mean Squared Error: Love It or Leave It? IEEE 
SIGNAL PROCESSING MAGAZINE, n. January, p. 98–117, 2009. 

XING, Lanchang et al. Experimental study on severe slugging mitigation by 
applying wavy pipes. Chemical Engineering Research and Design, v. 91, n. 1, p. 
18–28, 2013. 

YEMADA, Taitel; DUCKLER, A. E. A Model for Predicting Flow Regime 
Transitions in Horizontal and Near Horizontal Gas-liquid Flow. AIChE Journal, v. 
22, n. 1, p. 47–55, 1976. 

YOCUM, B. T. Offshore Riser Slug Flow Avoidance: Mathematical and 



116   

 

Optimization. SOCIETY OF PETROLEUM ENGINEERS OF AIME, v. SPE 4312, 
1973. 

 

 
  



 

117 

Apêndice A – Controle Passivo de 
Golfadas 

O Controle Passivo é aquele que elimina o fluxo intermitente através de 

alguma modificação de projeto da unidade ou pela adição de algum novo sistema 

dedicado à supressão das golfadas. Em comparação com os métodos ativos, os 

métodos passivos são menos flexíveis, uma vez que dificilmente podem ser 

ajustados quando o sistema projetado é comissionado. No entanto estes não 

necessitam de influências externas ao processo e não precisam de investimento 

extra em treinamento de operadores, compressores, instrumentos de medição e 

atuadores (GUO; LYONS; GHALAMBOR, 2007b; XING et al., 2013). 

Um dos primeiros trabalhos a proporem tais modificações foi publicado por 

Yocum (1973), aonde o autor sugere modificações de projeto, como a diminuição 

dos diâmetros dos trechos de entrada do Riser. Como demostrado por 

Shemer (2003) e ilustrado na Figura A.1.A, a magnitude e a frequência de 

oscilação da golfada está diretamente relacionada à relação L/D 

(Comprimento/Diâmetro) da tubulação. Esta ideia inicial evolui para os chamados 

Condicionadores de Fluxo, que através de modificações físicas dos 

encaminhamentos de produção procura estratificar as correntes e eliminar o fluxo 

intermitente. Um exemplo destes é o Condicionador em Onda desenvolvido por 

Xing et al.(2013), ilustrado na Figura A.1.B, que adiciona trechos ondulados na 

seção do Pipeline a fim de transitar um regime de golfada severa para um mais 

tênue. Outro é o dispositivo patenteado por Almeida (1999) que através do 

princípio de Venturi, procura estabilizar o fluxo multifásico. Apesar de 



118  Controle Passivo de Golfadas 

 

promissores, estas técnicas envolvem modificações físicas dos sistemas quando 

já em operação o que é de extrema dificuldade, devido às profundidades que o 

Pipeline é submetido. Em adição. Ademais, o emprego destas técnicas em poços 

surgentes pode implicar na ocorrência da golfada quando este não é um problema 

ainda. 

Uma segunda proposição de Yocum (1973) envolve a divisão do fluxo de 

produção em mais de um Riser, estratificando as correntes em diferentes 

velocidades para uma posterior homogeneização no topo. Esta evoluiu para os 

chamados Slug Catchers, que é uma solução largamente empregada na 

atualidade em sistemas multipoço. Este dispositivos podem ser do tipo Vaso, 

Looping ou Header, como o ilustrado na ilustrado na Figura A.1.C e tem por 

objetivo receber e equalizar as correntes provenientes de diversos poços, antes 

de encaminhá-las para o Separador Primário (JARI et al., 2015; MCGUINNESS; 

COOKE, 1993). Ainda que largamente empregados, estes equipamentos 

necessitarem de um alto investimento e um grande espaço físico na unidade 

inviabilizando a aplicação em unidades remotas Offshore. Além disso, é garantido 

apenas a estabilização de produção, mas não a seguridade da instalação, uma 

vez que a golfadas como um “soco de pressão” é recebida e assimilada 

diretamente por estes dispositivos.  



6.4 Controle Passivo de Golfadas 119 

A.

 

B. 
 

 
 
 

C. 

 

D.

 

 Figura A.1: Métodos de Controle Passivo de Golfada por: A. Relação L/D 

(SHEMER, 2003) ; B. Condicionador em Onda (XING et al., 2013); C. Slug 

Catcher tipo Manifold (JARI et al., 2015); e D. Desemulsificante (HANAPI; 

ARIFFIN; WAN, 2006). 

Uma terceira solução de Yocum (1973) é a injeção de gás em 

determinados ponto ao longo do Riser a fim de aumentar a velocidade da fase 

gás e criar uma espuma como produto multifásico. Pensando nisso, Hassanein e 

Fairhurst  (1998), propuseram a adição de um surfactante para aumentar a 

formação de espuma, tornando o sistema mais homogêneo. Entretanto esta ação 

agrega dificuldade à etapa de separação e esta ação tem o ônus de, devido a 

formação dessa espuma (ou emulsão), como o ciclo ilustrado na Figura A.1.D, a 

viscosidade do meio aumenta e, consequentemente, a perda de carga dinâmica 

começa a influenciar o regime de escoamento. Num sentido oposto a esta ideia 

uma técnica de adição de desemulsificante foi desenvolvida, como a proposta por 

Hanapi et al.(2006), a fim de quebrar a emulsão pela desestabilização interfacial 



120  Controle Passivo de Golfadas 

 

entre as fases gás e óleo. A viscosidade do meio diminui significativamente e a 

gravidade volta a ser o fator significante no regime de escoamento. Além disso, as 

fases envolvidas são segregadas, facilitando a operação e aumentando a 

eficiência do Separador Primário (ALSHEHRI; RICARDEZ-SANDOVAL; 

ELKAMEL, 2010). 

Mesmo que esta técnica passiva seja largamente utilizada em poços 

Offshore como os nacionais, existe a necessidade da construção de um sistema 

dedicado à injeção de desemulsificante nos poços. Ainda que menor comparado 

às duas primeiras soluções passivas, o investimento monetário e físico necessário 

para tal aplicação agrega preço ao produto. Além disso, o processo recai num 

problema de alocação de recursos, uma vez que o suprimento de 

desemulsificante é limitado pelas instalações e preços de contratos de 

fornecimento, e de ponto de operação ótimo, pois o quebra de emulsão é 

diretamente relacionada à quantidade de desemulsificante injetado (ALSHEHRI; 

RICARDEZ-SANDOVAL; ELKAMEL, 2010; MOKHATAB; POE; MAK, 2012). 

 
  



 

121 

Apêndice B – Implementação do Modelo 
Simplificado 

Neste apêndice são apresentados os códigos de implementação do Novo 

Modelo Simplificado de Produção por GL. A modelagem foi implementada na 

linguagem de s-function do Matlab para a reprodução vai plataforma Simulink. 

Para resolução numérica foi utilizado o integrador ODE15s. 

Para execução do modelo, deverão ser criados os arquivos 

“Param_Batimetria.m”, “Param_FisicoQ.m” e “Param_Ajuste.m”, aonde as 

constantes da batimetria, as constantes físico-químicas e os parâmetros de 

ajuste, respectivamente, conforme Tabela 3.2, deverão ser declaradas.  

Os valores de chutes iniciais dos estados foram definidos como os valores 

estacionários de um ponto estável de operação (livre de golfadas).  

S-function 

============================================================== 
% Novo Modelo Simplificado de Produção por GL 
% Autores: UFRGS E CENPES 
% Última edição: 05/10/2015 
% Editores: Giovani Gerevini e Fabio Diehl 
% Versão: 1.00 
============================================================== 
function [sys, x0] = Model(t,x,u,flag) 
run(‘Param_Batimetria.m’) 
run(‘Param_FisicoQ.m’) 
run(‘Param_Ajuste.m’) 
% Cálculos geometria 
       A       = D*D*pi/4; 
       Vt      = Lt*Dt*Dt*pi/4; 
       Va      = La*Da*Da*pi/4; 
switch flag 



122  Implementação do Modelo Simplificado 

 

    case  0 
        % Chute Inicial dos estados 
        x0   = [0.8955   0.5286   3.3373   0.2197   0.1776   1.1211]*1e4;  
        % n de estados, n de saídas, n de entradas 
        sys = [6 0 4 3 0 0];                                                
    case 1 
       % Entradas de Processo 
        Wgl  = u(1)*101325*M/(293*R)/3600/24;         % taxa de Gas-lift 
        z      = u(2)*0.01;                                              % abertura da choke 
        Ps    = u(3)*101325;                                         % Pressão no header 
        Pr     = u(4)*101325;                                        % Pressão do Reservatório 
        % Algebrismo PIPELINE-RISER 
        Peb = x(1).*R*T/(M* Veb);                                % Pressão na Bolha 
        Prt   = x(2).*R*T/(M*(Vr-(x(3)+ mlstill/Rol));      % Pressão no Topo 
        Prb  = Prt + (x(3) + mlstill)*g*sin(teta)/A;          % Pressão na Base do Riser 
        ALFAg = x(2)/(x(2) + x(3));                               % Fração mássica de gás no Riser 
        Wout = Kout*z*sqrt(max(0,Rol*(Prt - Ps)));      % Fluxo de Produção bifásico 
        Wg    = Kg*max(0,(Peb - Prb));                         % Fluxo de gás na válvula virtual 
        % Algebrismo TUBING-ANULAR 
        Vgt = Vt - x(6)/Rol;                                             % Volume de gás no Tubing 
        ROmt = (x(5) + x(6))/Vt;                                     % Massa específica  do meio no Tubing 
        Ptt  = x(5)/Vgt *R*T/M;                                       % Pressão na ANM 
        Ptb  = Ptt + ROmt*g*Hvgl;                                  % Pressão na injeção do Tubing 
        Ppdg = Ptb + Romres*g*(Hpdg-Hvgl);               % Pressão medida em PDG 
        Pbh    = Ppdg + Romres*g*(Ht-Hpdg);               % Pressão na base do Tubing 
        ALFAgt = x(5)/(x(6) + x(5));                                % Fração de gás no Tubing 
        Wwh = Kw*sqrt(Rol*max(0,(Ptt - Prb)));             % Fluxo bifásico na ANM 
        Pai  = ((R*T/(Va*M)) + (g*La/Va))*x(4);              % Pressão na injeção no Anular 
        ROai = M*Pai/(R*T);                                           % Massa específica  do gás no Anular 
        Wiv  = Ka*sqrt(ROai*max(0,(Pai - Ptb)));           % Fluxo de injeção de gás 
        % Algebrismo RESERVATÓRIO 
        Wr   = Kr*(1-0.2*Pbh/Pr-0.8*(Pbh/Pr).^2);                  % Fluxo do Reservatório 
        % EDO’s 
        dx1 = (1 - E)*(Wwh*ALFAgt) - Wg;                              % massa de gás na bolha 
        dx2 = E*(Wwh*ALFAgt) + Wg - ALFAg*Wout;             % massa gás no Riser 
        dx3 = Wwh*(1 - ALFAgt) - (1 – ALFAg)*Wout;             % massa de líquido no Riser 
        dx4 = Wgl - Wiv;                                                           % massa de gás no Anular 
        dx5 = Wr * ALFAgw + Wiv - Wwh*ALFAgt;                  % massa de gás no Tubing 
        dx6 = Wr * ( 1 - ALFAgw ) - Wwh*(1 - ALFAgt);           % massa de líquido no Tubing 
        sys = [dx1; dx2; dx3; dx4; dx5; dx6]; 
    case 3 
        % Saídas de Processo – PDG, TPT e PTop 
        Prt = x(2).*R*T/(M*(Vr-(x(3)+mlstill)/Rol)); 
        Prb = Prt + (x(3) + mlstill)*g*sin(teta)/A; 
        Vgt = Vt - x(6)/Rol; 
        ROgt = x(5)/Vgt; 
        ROmt = (x(5) + x(6))/Vt; 
        Ptt = ROgt*R*T/M;  
        Ptb = Ptt + ROmt*g*Hvgl; 
        Ppdg  = Ptb + Romres*g*(Hpdg-Hvgl); 
        sys = [Ppdg Ptt Prt]; 
    otherwise 
        sys = []; 
end 

  



 

123 

Apêndice C – Construção do Diagrama 
de Bifurcação 

Como introduzido na seção 2.2.3, o diagrama de bifurcação é uma 

ferramenta visual de identificação do ponto de transição de uma região 

operacionalmente estável para uma golfante (ver seção 4.1) e de três 

características fundamentais do ciclo limite: média, amplitude (máximo e mínimo) 

e valor estacionário. Este apêndice tem por objetivo mostrar o método de 

construção do diagrama de bifurcação e indicando uma contribuição deste 

trabalho em relação ao cálculo do estacionário.  

Diagrama de Bifurcação em Sistemas de GL 

O sistema de produção de petróleo por Gas-lift possui uma característica 

singular onde dependendo do ponto de operação, o sistema se comporta de 

forma estável (oscilatório convergente para um valor) ou golfante (ciclo limite em 

torno de um valor estacionário), como introduzido na seção 2.2.3 e ilustrado na 

seção 4.1 fazendo uso do modelo simplificado.  

Este comportamento segue um comportamento típico de ciclo-limite do tipo 

Hopf, o que faz com que dentro da região instável não possua uma distribuição de 

valores simétrica e fortemente afetada por distúrbios de processo. Ao analisarmos 

o ciclo da golfada normalizado, para o poço A com 18 % de ?? e 1x105 Sm³/dia de 

gás de elevação ilustrado na .A, essa assimetria é salientada e identificada como 

negativa.  



124  Construção do Diagrama de Bifurcação 

 

Observa-se que a média, centrada em zero, pode não ser o melhor 

indicador dentro da golfada. Analisando a distribuição dos valores dentro do ciclo, 

ilustrada na .B, é possível identificar a distribuição não-normal com assimetria 

negativa e um pico de frequência agudo concentrado na região de 0 à 1. Essa 

não normalidade é quantificada pelo cálculo da curtose e da assimetria do ciclo de 

6,66 e -2,21, respectivamente. 

A.  B.  

Figura C.1: A. Ciclo da golfada normalizado pelo desvio padrão, para o poço A 

com 18 % de abertura de ?? e 1x105 Sm³/d de gás de elevação; B. Distribuição 

dos valores do ciclo comparado ao comportamento normal. 

Essa análise estatística inicial, indica que a produção média analisada na 

região operacionalmente golfante, é ligeiramente diferente dos valores calculados 

para o ponto de equilíbrio. Como dito seção 4.1, a partir do ponto limítrofe onde 

há o surgimento da golfada há um padrão produtivo bastante díspar entre o 

comportamento médio e o estacionário.  

Tal observação corrobora que a definição do SP pelo cálculo da média da 

pressão em uma janela de dados não é adequado, podendo levar o sistema para 

valores inadequados (muito altos ou inalcançáveis). Isso salienta a importância da 

determinação dos valores estacionário para estudos de controlabilidade de 

sistemas com ciclo-limite. 

Média, Amplitude e Ponto Hopf 

A identificação da transição (ponto Hopf), dos valores médios, máximo e 

mínimos é feita através da simulação do modelo. Uma única entrada do sistema 

( ou ???, ou ?, ou ??, ou ?? ) dentro de um intervalo desejável (e que seja viável 

fisicamente), fixando as demais, análoga à análise de sensibilidade. Por exemplo, 

0 0.5 1 1.5 2 2.5
-4

-3

-2

-1

0

1

P
D

G
 n

o
rm

a
li
z
a
d
o

Tempo [h]
-4 -2 0 2 4
0

50

100

150

200

250

O
c
o
rr

ê
n
c
ia

s

PDG Normalizado

 

 

Ocorrências

Ajuste Normal

Média



Construção do Diagrama de Bifurcação 125 

 
para construção do diagrama de bifurcação em relação à ?? , os valores de 

abertura de válvula são variados de 0 à 100 %, lendo as saídas de pressão do 

modelo.  

O modelo é simulado com um tempo de simulação grande o suficiente para 

manter a significância do cálculo da média, englobando no mínimo vinte ciclos da 

golfada. Além disso, dez por cento do trecho inicial da simulação são descartados 

da análise, devido a convergência numérica inicial, para não influenciar nos 

cálculos. Assim, a média, o mínimo e o máximo são calculados utilizando as 

funções med(), min() e max() do Matlab, como indicado pelo script abaixo: 

% Determinação da média, mínimo e máximo do diagrama de bifurcação 
u = [1:1:100] % Simula choke variável 
Wgl = 1e5;    %Sm³/d 
Ps = 10;        %kgf/cm² 
Pr = 225;       %kgf/cm² 
for j=1:size(u,2) 
    z = u(j) 
    uu = [0 Wgl z Ps Pr]; 
    sim('Model',50*3600) 
    corte = floor(size(yy.signals.values,1)*0.1); 
    Xmed (:,j) = xout(corte:end,:); 
    PDGsim   = yy.signals.values(corte:end,1); 
    % Cálculo dos Parâmetros – Média, Mínimo e Máximo 
    PDGmed(j) = mean(PDGsim); 
    PDGmin(j)  = min(PDGsim); 
    PDGmax(j) = max(PDGsim); 
end 

Cálculo do Estacionário 

Os modelos existentes para descrição de golfadas, inclusive o modelo 

apresentado neste trabalho, são altamente não lineares e mal condicionados. Isso 

torna a tarefa de encontrar o ponto estacionário do modelo, onde 
dx

dt
= 0 , 

complexa. Diante disto, neste trabalho é desenvolvida um método para a 

construção da cura estacionária para sistemas com ciclo-limite, exemplificado 

pelo caso de produção de petróleo por GL, utilizando o modelo simplificado, 

A determinação dos valores estacionários em regiões estáveis, utiliza-se o 

próprio modelo dinâmico, o qual é integrado até a convergência para tal ponto. 

Para regiões golfantes, é utilizado um método de otimização que visa minimizar o 

somatório da derivada dos estados, formulado pela função objetivo Jss dada por: 

 Jssi,j = ??? ?
?????,? 

??

?
?   (C.1) 



126  Construção do Diagrama de Bifurcação 

 

onde i é o índice do estado n,que é igual a seis, j representa o ponto de operação, 

que depende da análise, e ????,?  são os estados escalonados. Para resolução do 

problema o escalonamento dos estados é crucial, devido ao mal condicionamento 

do sistema. Segue o script de definição da função de minimização do somatório 

das derivadas dos estados: 

% Função objetivo de minimização do somatório das derivadas dos estados 
function Jss = steady(x) 
    [t,y] = ode15s(@Model_100,[0 10*3600],x); 
    corte = floor(size(y,1)*0.5); 
    y = abs(diff(y./ x0)); 
    Jss = sum(y) * sum(y)'; 
end 

Para resolução do problema de otimização, foram testados diversos algoritmos 

locais e globais, de busca em linha e baseados em derivada. O método que 

obteve resposta válida para todo o intervalo de análise foi o método de otimização 

por aproximação quadrática restrita, BOBYQA (POWELL, 2009). 

Existem três pontos cruciais para o sucesso do método: estimativa inicial, 

escalonamento e tolerância numérica. A estimativa inicial do ponto a ser 

analisado é igual ao resultado do ponto anterior. Os estados do modelo passam 

por um escalonamento de engenharia, sendo divididos pelo valor dos estados 

correspondentes ao resultado anterior. A tolerância numérica absoluta e relativa 

do método de otimização são definidas igual à 1e-12.  

Abaixo segue o script para a mesma variação de ?? da análise da média:  

% Determinação da média, mínimo e máximo do diagrama de bifurcação 
u = [1:1:100] % Simula choke variável 
Wgl = 1e5;    %Sm³/d 
Ps = 10;        %kgf/cm² 
Pr = 225;       %kgf/cm² 
% Definição dos Parâmetros do otimizador 
lb = [0, 0, 0, 0, 0, 0]; 
ub = [1, 1, 1, 1, 1, 1]*1e6; 
opt.rho_end = 1e-12;  
for j=1:size(u,2) 
    z = u(j) 
    uu = [0 Wgl z Ps Pr]; 
    if j==1 
        sim('Model',10*3600) 
        Xss(j)     = xout(:,end) 
    else 
        [ybest,Xss(j)] = bobyqa('steady', Xss(j-1), lb, ub, opt) 
    end 
end 



Construção do Diagrama de Bifurcação 127 

 
De posse dos valores de estados relacionados ao estacionário, as variáveis 

controladas do sistema, ????, ??? ? ???? , são obtidas de forma analítica pelo 

modelo simplificado, pelas equações 3.20, 3.23 e 3.16, respectivamente. 

Com este procedimento, de cálculo são determinados os valores do 

estacionário que são os SP’s dos estudos de controlabilidade realizados neste 

trabalho, para cada ponto de operação. A Tabela C.1, indica os valores 

calculados de ????  para diferentes pontos de operação e que foram utilizados 

como base para os estudos de controlabilidade das seções 5.3 e 5.4. 

Tabela C.1: Valores de ????, em Pax10
5, no estado estacionário, utilizado como 

referência dos SP’s para diferentes pontos de operação 

??? 

        ?     
6x104 

Sm³/d 
8 x104 

Sm³/d 
10x104 

Sm³/d 

2 % 202,852 201,965 201,223 

4 % 202,413 201,198 200,103 

6 % 202,297 200,968 199,726 

8 % 202,253 200,874 199,564 

10 % 202,232 200,827 199,482 

12 % 202,220 200,801 199,435 

14 % 202,212 200,785 199,406 

16 % 202,208 200,774 199,387 

18 % 202,204 200,768 199,374 

20 % 202,202 200,762 199,364 

22 % 202,200 200,758 199,357 

24 % 202,199 200,755 199,352 

26 % 202,198 200,753 199,348 

28 % 202,197 200,751 199,345 

30 % 202,196 200,750 199,342 

 


</field>
	</doc>
</add>