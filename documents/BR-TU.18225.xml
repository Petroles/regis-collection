<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.18225</field>
		<field name="filename">25074_Munerato_FernandoPerin_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade Estadual de Campinas

Instituto de Matemática, Estatística e Computação
Científica

Dissertação de Mestrado

Remigração na profundidade mediante a equação
da onda imagem

Autor: Fernando Perin Munerato
Orientador: Prof. Dr. Jörg Schleicher
Co-orientadora: Profa. Dra. Amélia Novais

Campinas, SP
Março 2006



Remigração na profundidade mediante a equação
da onda imagem

Este exemplar corresponde à redação final da

dissertação devidamente corrigida e defendida

por Fernando Perin Munerato e aprovada

pela comissão julgadora.

Campinas, 31 de março de 2006.

Prof. Dr. Jörg Schleicher

Orientador

Profa. Dra. Amélia Novais

Co-orientadora

Banca Examinadora

Prof. Dr. Jörg Schleicher

Prof. Dr. Maurilio Boaventura

Prof. Dr. Ricardo Biloti

Dissertação de Mestrado apresentada no Instituto

de Matemática, Estatística e Computação Científica,

UNICAMP, como requisito parcial para obtenção do

Título de Mestre em Matemática Aplicada.



Remigração na profundidade mediante a equação
da onda imagem

Este exemplar corresponde à redação final da

dissertação devidamente corrigida e defendida

por Fernando Perin Munerato e aprovada

pela comissão julgadora.

Campinas, 31 de março de 2006.

~.~&gt;9-J
Prof. Dr. Jorg Schleicher

Orientador

~~~ ~~

Profa. Dra. Amélia Novais

Co-orientadora

Banca Examinadora

Prof. Dr. Jorg Schleicher

Prof. Dr. Maurilio Boaventura

Prof. Dr. Ricardo Biloti

Dissertação de Mestrado apresentada no Instituto

de Matemática, Estatística e Computação Científica,

UNICAMP, como requisito parcial para obtenção do

Títulode Mestre em Matemática Aplicada.



FICHA CATALOGRÁFICA ELABORADA PELA
BIBLIOTECA DO IMECC DA UNICAMP

Bibliotecária:MiriamCristinaAlves- CRB8a / 859

M923r

Munerato, Fernando Perin

Remigração na profundidade mediante a equação da onda imagem

/ Femando Perin Munerato --Campinas, [S.P. :s.n.], 2006.

Orientador : Joerg Schleicher

Dissertação (mestrado) - Universidade Estadual de Campinas,
Instituto de Matemática, Estatistica e Computação Científica.

1. Ondas sísmicas. 2. Diferenças finitas. 3. Método de volumes

finitos. 4. Análise numérica. I. Schleicher, Joerg. lI. Universidade

Estadual de Campinas. Instituto de Matemática, Estatística e

Computação Científica. 111.Título.

Título em inglês: Depth remigration by means ofthe image wave equation.

Palavras-chave em inglês (Keywords): I. Seismic wave. 2. Finite difference. 3. Finite
volume method. 4. Numerical analysis.

Área de concentração: Geofisica computacional

Titulação: Mestre em Matemática Aplicada

Banca examinadora: Prof. Dr. Joerg Schleicher (IMECC-UNICAMP)
Prof. Dr. Maurilio Boaventura (IBILCE-UNESP)
Prof. Dr. Ricardo Biloti (IMECC-UNICAMP)

Data da defesa: 31/03/2006



Dissertação de Mestrado defendida em 31 de março de 2006 e aprovada

Pela Banca Examinadora composta pelos Profs. Drs.

~,()s
ERG DIETRICH WILHELM SCHLEICHER

~
Prof. (a). Dr (a). RICARDO CAETANO AZEVEDO BILOTI

~~~
Prof. (a). Dr (a). MAURILIO BOAVENTURA



Resumo

Palavras-chave: Remigração, onda imagem, diferenças finitas, volumes finitos, análise

numérica

Este trabalho aborda a questão de como resolver a equação da onda imagem para o problema

de remigração na profundidade através de métodos numéricos. O objetivo deste problema é

a reconstrução de uma imagem das camadas geológicas do subsolo a partir de uma imagem

previamente migrada com um modelo de velocidade, geralmente, incorreto.

Nosso principal objetivo neste trabalho é a investigação de possíveis métodos que possam

resolver os problemas que surgiram ao usarmos esquemas explícitos do método de diferenças

finitas na solução da equação da onda imagem em trabalhos anteriores, como, por exemplo,

a dispersão numérica. Para isso, estudamos aqui o método de volumes finitos, assim como

esquemas implícitos do método de diferenças finitas.

O método de volumes finitos possui como característica principal propagar as médias das

células da malha ao invés de simplesmente os dados pontuais como é feito no método de dife-

renças finitas.

As outras tentativas para solucionar o problema da dispersão foram dois tipos de implemen-

tação de esquemas implícitos do método de diferenças finitas, isto é, implementações implícitas

de esquemas convencionais avaliados em pontos da malha e um esquema avaliado nos centros

das células.

A qualidade dos algoritmos estudados foi testada numericamente. Estes testes numéricos

mostram que o método de volumes finitos não é adequado para resolver o problema da dis-

persão, uma vez que a média calculada a cada passo aumenta o estiramento do pulso. Além

disso, as implementações implícitas dos esquemas convencionais mostram o mesmo compor-

tamento de dispersão que as implementações explícitas. Unicamente o esquema centrado foi

capaz de melhorar a dispersão numérica em comparação com as implementações anteriores,

porém somente para dados contendo exclusivamente baixas freqüências.

iii



Abstract

Keywords: Remigration, image wave, finite differences, finite volumes, numerical analysis

This work approaches the question of how to solve the image-wave equation for depth

remigration by numerical methods. The objective is the reconstruction of an image of the geo-

logic layers of the subsoil from a previously migrated image with a different velocity model.

Our main objective in this work is the investigation of possible methods that can solve the

problems that appeared when using explicit finite-difference schemes for the solution of the

image-wave equation in previous works, particularly numerical dispersion. For this purpose,

we study the method of finite volumes, as well as implicit finite-difference schemes.

The main characteristic of the finite-volume method is to simply propagate the averages

in the cells of the mesh instead of the discretized data themselves as it is done in the finite-

difference method.

As another attempt to solve the problem of the dispersion, we study two types of implemen-

tation of implicit finite-difference schemes, that is, implicit implementations of conventional

schemes evaluated out the edge of the cell and a scheme evaluated in the center of the cell.

The quality of the studied algoritms has been tested numerically. These numerical tests

show that the method of finite volumes is not adequate to solve the problem of dispersion,

for the average calculated in each step additionally increases the pulse stretch. Moreover, the

implicit implementations of the conventional schemes show the same dispersion behavior as

the explicit implementations. Solely the centered scheme was capable to improve the numerical

dispersion in comparison with the previous implementations, however only for data containing

exclusively low frequencies.

iv



“A casa da saudade chama-se memória: é uma cabana pequenina a um canto

do coração.”(Henrique Maximiliano Coelho Neto)

Às nossas boas lembranças (aquelas que ninguém pode tirar de nós, que estão

guardadas no nosso íntimo) que existem para nos dar força para nos ajudar a

enfrentar momentos difíceis em nossa vida. (Sandra Marega)

v



Agradecimentos

Ao meu orientador, Prof. Dr. Jörg Schleicher, por acreditar na minha capacidade

acadêmica, pela paciência em repetir diversas vezes um mesmo tópico, pelos nossos trabalhos

durante mais de 4 anos e, principalmente, pelas suas infinitas reflexões olhando diretamente nos

nossos olhos.

À minha co-orientadora, Profa. Dra. Amélia Novais, pelo apoio acadêmico e pessoal

nos momentos felizes e tristes dessa “nossa” caminhada. Também pela sua maneira “mãe” de

orientar e pelos infinitos lenços de papel utilizados nas nossas conversas amigas.

À toda minha família, principalmente, minha querida mãe Jandira, por toda luta travada

e pelo seu eterno amor, minhas queridas irmãs Juciléia e Silvia, por todo amor de seus olhos e

minha grande namorada e melhor amiga Ticiana, por todo seu amor, sua paciência, seu sorriso,

sua família e, principalmente, os lindos momentos ao seu lado.

Ao meu pai, José Wagner Moura Reis (em memória), por apostar e confiar em mim e

possibiliar meu primeiro passo nessa caminhada.

Aos antigos e eternos amigos, em especial o “grande” Minhão, por todo ensinamento

e alegria nos vários anos de convivência. Aos atuais e presentes amigos, pela compreensão,

pelas experiências, pelas risadas e, principalmente, pelos momentos de descontração em nossas

festas.

Ao sorriso sincero das crianças, em particular, àquelas que motivam ainda mais minha

batalha, Marília Naomi Hatori Rock’n Roll Super Poderosa, Luísa, Maria Clara, Lucas, Mirko

e Arthur.

Aos professores e amigos acadêmicos que sempre estiveram de portas abertas para me

receber e por serem pessoas fantásticas além dos portões da universidade: Fátima, Chico, Talita,

Cheti, Lúcio, Tânia, Biloti e Ary.

vi



vii

À amizade e àqueles que fazem desta um incentivo para minha vida: Alessandra, Ana

Carolina e Gabi, pelo companherismo durante toda a graduação e todo o mestrado. Aleixo,

Gabriel, Flávia, Marcela, Ricardinho, Vanessa e Vânia, pelos bons momentos vividos na gra-

duação. Ana Letícia, Janne e Mari Aiub, pelo carinho, jogos e alegria, respectivamente. Fred,

Juliano, Márcio, Marquinho e Neto, por me aturarem morando junto deles. Vera, Jana e Lin-

coln, por zelarem por mim como membro da família. Camila, Gabi, Juliana e Processinho, pelos

momentos inesquecíveis de alegria e diversão. Heid, Matheus e Maurício, por terem feito e fa-

zerem parte da minha vida. Lopes, Wando e Vivi, pela convivência hoje. Valéria por toda ajuda

amiga, principalmente nos momentos de desespero. Priscila e os amigos do apoio do vestibular.

Os companheiros do LGC. Os amigos da faculdade em geral. Os amigos do messenger. E, é

claro, os amigos sem grupo.

À UNICAMP e ao IMECC pela infraestrutura disponibilizada.

À FAPESP pelo suporte financeiro.

A todos que direta ou indiretamente fizeram parte desta etapa da minha vida meus sin-

ceros agradecimentos.



Sumário

Lista de Figuras x

1 Introdução 1

2 Equação da onda imagem 8

3 Introdução ao método de volumes finitos 12

3.1 Desenvolvimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

3.2 Implementação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

4 Esquemas de diferenças finitas implícitos 20

4.1 Esquemas implícitos convencionais . . . . . . . . . . . . . . . . . . . . . . . 20

4.1.1 Desenvolvimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4.1.2 Implementação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

4.2 Esquema avaliado no centro da célula . . . . . . . . . . . . . . . . . . . . . . 26

4.2.1 Desenvolvimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4.2.2 Consistência . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4.2.3 Estabilidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

4.2.4 Dispersão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

4.2.5 Dissipação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46

4.2.6 Implementação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

viii



SUMÁRIO ix

5 Experimentos numéricos 50

5.1 Refletor plano . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

5.2 Método de volumes finitos . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

5.3 Esquemas implícitos convencionais . . . . . . . . . . . . . . . . . . . . . . . 56

5.4 Esquema implícito avaliado no centro da célula . . . . . . . . . . . . . . . . . 57

5.5 Tempos computacionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

6 Conclusões 71

Referências bibliográficas 74

A Equação do envelope para onda imagem 76

B Equação iconal da onda imagem 78

C Equação iconal independente de F 80

D Matrizes de iteração do esquema centrado 82

E Mudança de variável na equação da onda imagem 84

E.1 Consistência . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84

E.2 Estabilidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

E.3 Dispersão numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85



Lista de Figuras

1.1 Imagem do refletor plano remigrado (esquerda) e migrado (direita) com veloci-

dades: (a) v = 2320 m/s, (b) v = 2680 m/s e (c) v = 3000 m/s. A migração foi

feita por migração Kirchhoff convencional e a remigração através do método

DF (esquema avançado em v e z). . . . . . . . . . . . . . . . . . . . . . . . . 5

2.1 Representação de um ponto P0(x0, z0) sobre o refletor. . . . . . . . . . . . . . 9

2.2 Representação gráfica das isócronas quando: (a) se interseptam no ponto refle-

tor P0(x0, z0), (b) não mais se interseptam no ponto refletor P (x0, z0), aqui para

uma velocidade v &gt; v0. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

3.1 Malha representando a célula Cm,n. . . . . . . . . . . . . . . . . . . . . . . . . 13
3.2 Ilustração do algoritmo REA para uma malha de dados. Os dados iniciais são

subdivididos em células Cm,n e usa-se a expressão (3.1) para calcular as médias
nessas células. Passo 1: recontrução da malha a partir das médias P lm,n. Passo

2: evolução dos dados para um nível posterior na velocidade (através de algum

método). Passo 3: cálculo das novas médias no novo nível. . . . . . . . . . . . 15

3.3 Ilustração do algoritmo REA para uma malha discreta de dados. Os dados inici-

ais são subdivididos em células Cm,n e usa-se uma das equações (3.9) para cal-
cular as médias nessas células. Passo 1: recontrução da malha discreta, como

sugerido ser o caso mais simples, plm,n = P lm,n. Passo 2: evolução dos dados

para um nível posterior na velocidade, usando método de DF. Passo 3: cálculo

das novas médias no novo nível. . . . . . . . . . . . . . . . . . . . . . . . . . 17

x



LISTA DE FIGURAS xi

4.1 Aproximação do ponto (xm, zn+1/2, vl+1/2). . . . . . . . . . . . . . . . . . . . 27

4.2 Visualização da distância de propagação. . . . . . . . . . . . . . . . . . . . . . 42

4.3 Gráfico da relação entre o número de passos das mudanças de variável em

função da razão entre a maior e a menor velocidade. . . . . . . . . . . . . . . . 49

5.1 Modelo de afastamento nulo para refletor plano horizontal. . . . . . . . . . . . 51

5.2 Seções migradas na profundidade com velocidade de migração (a) v = 2000 m/s

e (b) v = 4000 m/s. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

5.3 Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda:

Método de diferenças finitas explícito. Direita: Método de volumes finitos. . . . 53

5.4 Imagem do refletor plano remigrado com velocidades: (a) v = 3680 m/s, (b)

v = 3320 m/s e (c) v = 3000 m/s, para o esquema avançado em v e atrasado

em z. Esquerda: Método de diferenças finitas explícito. Direita: Método de

volumes finitos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

5.5 Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda:

Método de diferenças finitas explícito. Direita: Método de diferenças finitas

implícito fixando x. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.6 Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda:

Método de diferenças finitas explícito. Direita: Método de diferenças finitas

implícito fixando z. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.7 Imagem do refletor plano remigrado com velocidades: (a) v ? 2320 m/s, (b)
v ? 2680 m/s e (c) v ? 3000 m/s. Esquerda: Método de diferenças finitas
explícito. Direita: Método de diferenças finitas implícito centrado no centro da

célula. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61



LISTA DE FIGURAS xii

5.8 Imagens do refletor plano, na velocidade correta do meio v = 3000 m/s, para

diferentes valores de ??. A remigração foi feita utilizando o método de dife-

renças finitas implícito centrado no centro da célula. . . . . . . . . . . . . . . . 63

5.9 Imagem do refletor plano remigrado pelo método de DF implícito centrado no

centro da célula com velocidades: (a) v ? 2320 m/s, (b) v ? 2680 m/s e (c)
v ? 3000 m/s. Esquerda: incrementos espaciais ?x = ?z = 10 m. Direita:
incrementos espaciais ?x = ?z = 5 m. . . . . . . . . . . . . . . . . . . . . . 64

5.10 Seção migrada na profundidade com velocidade v = 2000 m/s, com conteúdo

maior de baixas freqüências. . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

5.11 Imagem do refletor plano, com menor conteúdo de altas freqüências, remigrado

com velocidades: (a) v ? 2320 m/s, (b) v ? 2680 m/s e (c) v ? 3000 m/s.
Esquerda: Método de diferenças finitas explícito. Direita: Método de diferenças

finitas implícito centrado no centro da célula. . . . . . . . . . . . . . . . . . . 66

5.12 Imagem do refletor plano, com menor conteúdo de altas freqüências, remi-

grado (esquerda) e migrado (direita) com velocidades: (a) v ? 2320 m/s, (b)
v ? 2680 m/s e (c) v ? 3000 m/s, respectivamente. A migração foi feita por
migração Kirchhoff e o esquema utilizado para remigração foi DF implícito

centrado no centro da célula. . . . . . . . . . . . . . . . . . . . . . . . . . . . 67



Capítulo 1

Introdução

A Geofísica dedica-se à determinação dos parâmetros do interior da terra por experimentos

físicos realizados em sua superfície. Entre os vários métodos físicos empregados pare este obje-

tivo, a sísmica tem um papel fundamental. Métodos sísmicos trabalham usando os princípios da

ecografia. Estes métodos baseiam-se na propagação de energia em forma de ondas elásticas ou

acústicas na Terra. Existem fontes naturais (terremotos) e artificiais (explosões, vibradores, etc.)

que geram ondas sísmicas. Por meio do registro dessas ondas, em chamadas seções sísmicas,

obtém-se uma imagem distorcida no tempo da situação geológica no subsolo.

O objetivo principal tanto da sismologia de terremotos quanto da sísmica de exploração é a

reconstrução da melhor imagem possível não distorcida na profundidade a partir desta imagem

distorcida no tempo. Para este objetivo, empregam-se os chamados métodos de imageamento,

entre eles principalmente o da migração. Uma vez que estes métodos dependem do conheci-

mento de um modelo de velocidade do subsolo, que não é conhecido a priori, é de praxe que

uma migração seja aplicada várias vezes com modelos de velocidade variados.

Uma alternativa à migração repetida dos dados originais consiste na chamada remigração

ou continuação de velocidade, i.e., a construção da imagem migrada para um modelo de ve-

locidade atualizado a partir de uma imagem anterior, obtida com um modelo original. Para

a realização deste processo de imageamento, existem várias técnicas. Neste trabalho, estu-

damos a chamada equação da onda imagem para remigração, desenvolvida por Fomel (1994)

1



CAPÍTULO 1. INTRODUÇÃO 2

e Hubral et al. (1996), observando a necessidade de melhorar a imagem obtida, uma vez que

o modelo correto da velocidade de migração não é conhecido e tem que ser determinado du-

rante o processo da construção da melhor imagem possível. Portanto, convém variar o modelo

de velocidade e construir as correspondentes imagens. Quando é feita tal variação da veloci-

dade, observa-se que as novas imagens dos refletores (fronteiras entre as camadas geológicas)

comportam-se de forma similar à propagação de uma frente de onda em diferentes instantes.

Esta “propagação” de imagens é descrita por uma equação diferencial parcial semelhante à

equação da onda (Fomel, 1994; Hubral et al., 1996) que, conseqüentemente, recebe o nome de

“equação da onda imagem para remigração” (Hubral et al., 1996).

Existem equações da onda imagem para a remigração no tempo e na profundidade. A uti-

lidade da equação da onda imagem no tempo já foi comprovada na prática (Jaya et al., 1999).

Resultados recentes para a análise de velocidade, usando a remigração no tempo, também

mostraram-se bastante promissores (Fomel, 2003).

Neste trabalho, tratamos da equação na profundidade, a saber,

pxx + pzz +
v

z
pvz = 0 . (1.1)

A dedução da equação (1.1) se encontra no Capítulo 2. Aqui, p representa o campo de onda

imagem, i.e., a seção migrada em função da velocidade de migração, v. Além disso, x e z

representam as variáveis espaciais, sendo x a coordenada horizontal e z a profundidade. Nesta

equação, a variável de propagação, no entanto, não é o tempo como no caso de ondas físicas

convencionais, mas a velocidade de migração, v. Esta equação está em sua forma bidimensional

e é estritamente válida somente para meios homogêneos. Apesar disso, pode ser aplicada para

meios inomogêneos com variação vertical de velocidade, como mostrado em Schleicher et al.

(2003b, 2004a). A condição inicial para o problema é dada por um campo de ondas migrado,

p0. As condições de contorno são, em conseqüência da falta de dados fora do domínio a ser

migrado, tomadas nulas.

Observamos que em comparação com a equação da onda, ao invés da derivada segunda

com respeito à variável de propagação, a equação da onda imagem contém uma derivada mista

que envolve uma coordenada espacial. Esta característica reflete o fato de que o campo de



CAPÍTULO 1. INTRODUÇÃO 3

onda p que satisfaz a equação (1.1) possui um comportamento cinemático diferente das ondas

convencionais (Fomel, 1994; Hubral et al., 1996; Schleicher et al., 2004a).

Mediante um estudo numérico da equação da onda imagem (Schleicher et al., 2003a, 2004a),

vimos que imagens remigradas de refletores propagam à profundidade correta quando a veloci-

dade atinge o seu valor correto e estruturas como pontos difratores se focalizam na profundidade

correta assim como gravatas se dissolvem corretamente. Os primeiros exemplos realizados em

meios não homogêneos (Schleicher et al., 2003b, 2004a) mostram que é possível levar a técnica

adiante. Estas aplicações numéricas indicam o potencial da remigração da onda imagem de ser

útil como uma ferramenta para análise de velocidade de migração quando se possui informação

adicional sobre a posição do refletor, por exemplo, a sua profundidade medida em um poço.

O objetivo concreto deste trabalho é a análise de métodos numéricos para solucionar a

equação da onda imagem, com a finalidade de contribuir com a análise de velocidade de mi-

gração. Como foi mostrado em Fomel (2003) e Schleicher et al. (2004a), o uso da solução

numérica das equações da onda imagem no tempo e na profundidade possui um potencial neste

sentido. Para a remigração na profundidade, este potencial é difícil de ser explorado, principal-

mente por causa das dificuldades numéricas, especialmente a dispersão numérica dos esquemas

de diferenças finitas estáveis. Aqui continuamos os estudos desta equação que foi iniciado em

Schleicher et al. (2003a, 2004a), onde foram testados esquemas explícitos do método de dife-

renças finitas para diversas aproximações da derivada mista assim como algumas mudanças de

variáveis para a velocidade de migração. Em todos os casos estudados anteriormente não foi

encontrado um método numérico que faça a remigração na profundidade através da equação da

onda imagem sem que ocorresse um forte efeito de dispersão numérica, mesmo que a estabili-

dade e a consistência do método estejam garantidas.

O efeito de dispersão ocorre quando ondas de diferentes freqüências propagam com diferen-

tes velocidades distorcendo, desta forma, o formato do pulso da onda. Quando as velocidades

das ondas de diferentes freqüências realizadas pelo esquema numérico são diferentes da solução

exata do problema, fala-se de dispersão numérica. Este efeito, intrínseco de métodos de dife-

renças finitas, aqui é tão forte que influência a resolução nos testes numéricos quando usamos



CAPÍTULO 1. INTRODUÇÃO 4

o método de diferenças finitas para simular a propagação da onda imagem. Para cada um dos

esquemas investigados em Schleicher et al. (2003a, 2004a) observou-se que o comprimento

do pulso não se mantinha igual ao comprimento obtido pela migração direta dos dados para

velocidades correspondentes.

Esta desvantagem do método pode ser observada quando comparamos os resultados da téc-

nica de remigração com imagens migradas correspondentes, obtidas por migração direta dos

dados sísmicos originais. A Figura 1.1 mostra tal comparação para dados sintéticos de afasta-

mento nulo, modelados, por exemplo, com um único refletor horizontal em 550 m de profundi-

dade (modelo descrito detalhadamente no Capítulo 5). Na Figura 1.1 fica evidente a diferença

entre as larguras dos pulsos obtidos pela migração direta dos dados distorcidos no tempo e pela

largura do pulso quando fazemos a remigração da onda imagem através do método de diferen-

ças finitas a partir de uma imagem previamente migrada com velocidade supostamente incorreta

de 2000 m/s. No lado esquerdo, estão as imagens obtidas pela remigração por onda imagem nas

velocidades 2320 m/s, 2680 m/s e 3000 m/s. No lado direito, para efeito de comparação, estão

as correspondentes imagens obtidas por migração direta dos dados originais no tempo usando

migração de Kirchhoff convencional com as velocidades 2320 m/s, 2680 m/s e 3000 m/s, res-

pectivamente. São estas as imagens que deveriam ser obtidas na propagação da onda imagem.

Observa-se que as imagens do refletor estão posicionadas corretamente, na mesma profundi-

dade da migração direta. Para a velocidade correta do meio, Figuras 1.1c, a imagem se encontra

na posição correta do refletor indicada pela linha preta. Observa-se ainda que o formato do

pulso não é o mesmo. A diferença do comprimento do pulso das figuras da direita para as da

esquerda se deve a dispersão numérica do esquema de diferenças finitas utilizado para a rea-

lização da propagação. Nota-se também que mesmo nas figuras da direita, o pulso se estica

com o aumento da velocidade de migração. Este é o efeito de estiramento do pulso introduzido

pela própria migração (Tygel et al., 1994), que não pode ser removido. Ele se reflete no fato de

que a equação (1.1) possui dispersão intrínseca (Schleicher et al., 2004a). O estiramento adi-

cional gerado pela dispersão numérica, nas figuras da esquerda, é criado somente pela forma em



CAPÍTULO 1. INTRODUÇÃO 5

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 1.1: Imagem do refletor plano remigrado (esquerda) e migrado (direita) com velocidades:

(a) v = 2320 m/s, (b) v = 2680 m/s e (c) v = 3000 m/s. A migração foi feita por migração

Kirchhoff convencional e a remigração através do método DF (esquema avançado em v e z).



CAPÍTULO 1. INTRODUÇÃO 6

que a equação (1.1) é implementada e é altamente indesejável, uma vez que causa uma perda

significativa de resolução da imagem remigrada. Pela Figura 1.1, é claramente visível o quão

difícil seria a detecção de um segundo refletor horizontal perto do primeiro, digamos em 500 m

de profundidade. Enquanto no lado direito, as imagens dos dois refletores ficariam claramente

separadas, no lado esquerdo os seus pulsos se sobreporiam, o que impossibilitaria a distinção

dos dois refletores.

Motivados por esta observação, estudamos neste trabalho outras maneiras de implementar

a equação da onda imagem para remigração na profundidade (1.1) em busca de uma solução

para o problema dos efeitos numéricos indesejados que aparecem na propagação pelo método

de diferenças finitas como, principalmente, o da dispersão, ou pelo menos minimizá-los quando

estes não puderem ser eliminados.

Para solucionar estes problemas investigamos primeiramente os efeitos da aproximação da

equação da onda imagem pelo “método de volumes finitos”, uma vez que tal método tem se

mostrado de alta precisão na resolução numérica de vários outros problemas complexos (Le-

Veque, 2002). Este método funciona de forma similar ao método de diferenças finitas. No

entanto utiliza como passo inicial para propagação uma média nas células, ao invés dos da-

dos pontuais, e faz isso a cada iteração do algoritmo, ou seja, a cada passo na velocidade de

propagação.

Outra maneira na tentativa de solucionar os problemas numéricos, é utilizar métodos de

diferenças finitas implementados implicitamente, similares aos usados por Fomel (2003) na

sua implementação da remigração no tempo, visto que em estudos anteriores apenas formas

explícitas foram implementadas (Schleicher et al., 2004a,b).

Este trabalho encontra-se na seguinte disposição:

No Capítulo 2 deduzimos a equação da onda imagem para o problema de remigração na

profundidade, enfatizando a maneira como esta é utilizada neste trabalho.

Na tentativa de solucionar os problemas encontrados na propagação da onda imagem pelo

método de diferenças finitas explícito introduzimos, no Capítulo 3, o método de volumes finitos.

Constatamos que este é muito similar ao método de diferenças finitas, diferenciando-se apenas



CAPÍTULO 1. INTRODUÇÃO 7

na forma dos dados a serem propagados a cada passo na velocidade.

No Capítulo 4, métodos de diferenças finitas implícitos foram estudados para, também,

tentar solucionar os problemas mencionados acima. Para isso, utilizamos métodos de diferenças

finitas implícitos convencionais avaliados em pontos da malha e um método avaliado nos centros

das células.

Os resultados numéricos estão descritos no Capítulo 5. Neste é feita a comparação entre

os resultados dos métodos descritos aqui com os resultados do método de diferenças finitas

explícito estudado em Schleicher et al. (2004a,b).

Finalmente, no Capítulo 6 encontram-se um resumo dos principais resultados e as con-

clusões.



Capítulo 2

Equação da onda imagem

Neste capítulo apresentamos brevemente a dedução da equação da onda imagem conforme

detalhada em Hubral et al. (1996).

Supomos que o refletor no subsolo é composto por um conjunto de pontos refletores (Fi-

gura 2.1). Nestas circunstâncias, o campo de onda refletido pode ser considerado como uma

superposição dos campos espalhados em todos pontos refletores. Primeiramente, estudamos

somente um ponto refletor P0(x0, z0) localizado no subsolo (Figura 2.1). Para um par fonte-

receptor situados num mesmo ponto (?, 0) na superfície (situação conhecida como afastamento

nulo), a distância entre este e o ponto refletor P0(x0, z0) é dada por

d =
?

(x0 ? ?)2 + z20 .

Logo, o tempo t de propagação da onda emitida pela fonte, situada na superfície em (?, 0),

até o ponto P0 e, então, captada pelo receptor, situado no mesmo ponto (?, 0), é expresso em

função de ?, por

t(?) =
2d

v0
=

2

v0

?

(x0 ? ?)2 + z20 , (2.1)

onde v0 é a velocidade de propagação no subsolo, supostamente homogêneo, i.e., v0 é constante.

Agora podemos pensar que para um dado ponto (?, 0), temos um conjunto de pontos que

satisfaz a equação (2.1) para a mesma velocidade v0, i.e., dado um ponto (?, 0) temos um mesmo

8



CAPÍTULO 2. EQUAÇÃO DA ONDA IMAGEM 9

0 0P (x  ,z  )0

v
0

(   ,0)?

x

z

x

d

Figura 2.1: Representação de um ponto P0(x0, z0) sobre o refletor.

tempo de propagação t correspondente a este par fonte-receptor para todos os pontos P (x, z)

que satisfazem a equação

z =

?

(

v0t

2

)2

? (x ? ?)2 . (2.2)

Esta equação descreve uma semi-circunferência de raio d = v0t/2 que é chamada de isócrona,

pois todos os pontos nesta curva possuem o mesmo tempo de propagação.

Assim, em um levantamento sísmico inteiro de afastamento nulo, sobre o ponto P0(x0, z0)

fixo, cada valor de ? define um ponto (?, 0) com seu respectivo t(?) que gera uma nova isócrona.

Todas essas isócronas passam por P0, i.e., a interseção dessas isócronas é o ponto P0(x0, z0),

como pode ser visto na Figura 2.2a. Esta construção é implicitamente realizada por uma mi-

gração com a velocidade v0.

Mas existe a possibilidade da velocidade de migração utilizada v não ser a velocidade correta

do meio, v0, assim, teríamos uma reformulação da equação (2.2), agora para uma velocidade

v 6= v0,

z =

?

(

vt

2

)2

? (x ? ?)2 . (2.3)

Nesta situação, a interseção das isócronas não é mais o ponto P0(x0, z0) (ver Figura 2.2b),

pois se a velocidade aumentar (v &gt; v0) a distância d entre o par fonte-receptor e um ponto

P (x, z) aumentará também considerando que o tempo permaneça constante, i.e., o raio da

isócrona é proporcional à velocidade. O envelope do conjunto das isócronas representa a nova



CAPÍTULO 2. EQUAÇÃO DA ONDA IMAGEM 10

P
0
(x

0
,z

0
)

z

x

(a) 

P
0
(x

0
,z

0
)

z

x

(b) 

Figura 2.2: Representação gráfica das isócronas quando: (a) se interseptam no ponto refletor

P0(x0, z0), (b) não mais se interseptam no ponto refletor P (x0, z0), aqui para uma velocidade

v &gt; v0.

imagem do ponto refletor para a nova velocidade v. Observe que, para cada velocidade v 6= v0,
temos um novo envelope. Isto nos dá a idéia da propagação de uma onda imagem, sendo gerada

no ponto P0(x0, z0).

Agora temos que encontrar a equação que descreve estes envelopes pois, assim, temos a

equação que descreve a posição da onda imagem. Como mostrado no Apêndice A, seguindo o

desenvolvimento de Hubral et al. (1996), o envelope é descrito pela equação

z = (v/v0)

?

?

?

?z20 +
(x ? x0)2

1 ? (v/v0)2
. (2.4)

Calculando esta posição para vários valores de v 6= v0, obtemos a propagação desta imagem.
O próximo passo consiste em estabelecer a relação entre esta parte cinemática da propagação

da onda imagem e a correspondente equação diferencial parcial. Esta relação obedece aos

mesmos princípios que a correspondente relação entre a cinemática da propagação de ondas

acústicas e a equação da onda. No caso desta, a cinemática da propagação é descrita pela

chamada equação iconal (Bleistein, 1984). Correspondentemente, existe uma “equação iconal

da onda imagem” que descreve a cinemática da propagação da onda imagem (Hubral et al.,

1996).



CAPÍTULO 2. EQUAÇÃO DA ONDA IMAGEM 11

Para encontrarmos esta equação iconal para a onda imagem, substituimos a velocidade de

migração v da equação (2.4) pelo iconal da onda imagem, V (x, z), e calculamos as derivadas

parciais desta equação modificada com respeito a x e a z. Substituindo essas derivadas parciais

novamente na equação (2.4) e realizando assim as eliminações de x0, z0 e v0, obtemos a equação

iconal da onda imagem (veja Apêndice B e Hubral et al. (1996))

V 2x + V
2
z ?

V

z
Vz = 0 . (2.5)

A solução desta equação para uma fonte pontual em P0(x0, z0) é representada pela equação

(2.4). A equação (2.5) pode ser interpretada como a equação iconal de uma equação da onda

imagem, i.e., ela descreve a parte cinemática de uma solução aproximada da forma

p(x, z, v) = p0(x, z)f [v ? V (x, z)] (2.6)

da equação

pxx + pzz +
v

z
pvz = 0 , (2.7)

que é a equação da onda imagem (1.1) para o problema de remigração. Na equação (2.6), o

campo p é aproximado por um pulso f (v), deslocado no espaço conforme descrito pela função

iconal v = V (x, z) e com amplitude p0(x, z). Aqui, a função amplitude p0(x, z) é somente

introduzida para descrição completa de um campo de onda. Nesta dissertação, os valores de

p0(x, z) não são de interesse.

Por esta razão, podemos desconsiderar uma função F ? F (px, pz, pv, p, x, z, v) na forma
geral da equação,

pxx + pzz +
v

z
pvz = F (px, pz, pv, p, x, z, v) , (2.8)

que não alteraria a equação iconal (2.5), como mostrado no Apêndice C.



Capítulo 3

Introdução ao método de volumes finitos

3.1 Desenvolvimento

A primeira tentativa para solucionar os problemas numéricos encontrados quando usamos o

método de diferenças finitas (DF) para fazer a remigração da onda imagem foi utilizar o método

de volumes finitos (VF).

O método de VF está fortemente relacionado ao método de DF. No entanto, o método de

VF é deduzido na base da forma integral, i.e., é baseado em subdividir o domínio espacial em

células (os “volumes finitos”, também chamados de células da malha) e calcular média dos

dados dentro dessas células através de uma integral e, assim, fazer a propagação da equação

diferencial.

Para entender como este método funciona, consideramos uma malha de pontos no espaço

(x, z, v). Sejam ?x, ?z e ?v números positivos. O campo de onda imagem, para uma malha

de pontos (xm, zn, vl) = (x0 + m?x, z0 + n?z, v0 + l?v) para quaisquer inteiros não negativos

m, n e l e valores iniciais x0, z0 e v0, é denotado por plm,n (onde aqui x0 e z0 não são mais as

coordenadas de P0 do capítulo anterior).

Seja, também, a (m, n)-ésima célula, i.e., a célula centrada no ponto (xm, zn), representada

por Cm,n = (xm?1/2, xm+1/2) × (zn?1/2, zn+1/2)

= {(x, z) | xm?1/2 &amp;lt;x &amp;lt;xm+1/2 , zn?1/2 &amp;lt;z &amp;lt;zn+1/2} ,

12



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 13

z

n?1/2

n+1/2z

z

m+1/2 xm+1xm
x

xm?1

nz

n+1

m?1/2

z

x
z n?1

x

Cm,n

Figura 3.1: Malha representando a célula Cm,n.

como ilustrada na Figura 3.1. O valor P lm,n aproximará o valor médio de p(x, z, vl) sobre essa

(m, n)-ésima célula, para uma velocidade vl, por

P lm,n ?
1

?x

1

?z

? xm+1/2

xm?1/2

? zn+1/2

zn?1/2

p(x, z, vl) dx dz ?
1

?x

1

?z

? ?

Cm,n

p(x, z, vl) dx dz , (3.1)

onde ?x = xm+1/2 ? xm?1/2 e ?z = zn+1/2 ? zn?1/2. Para simplificar, supomos uma malha
uniforme, mas ressaltamos que a uniformidade da malha não é sempre requerida.

Assim, usamos para fazer a propagação da onda imagem os valores de P lm,n calculados de

acordo com a expressão (3.1). Portanto, o método de VF é diferente do método de DF somente

pelo conteúdo utilizado para realizar a propagação. Enquanto o método de VF utiliza a média

na célula Cm,n (isto para o caso bidimensional) para fazer a propagação, o método de DF realiza
sua propagação usando somente os dados pontuais plm,n = p(xm, zn, vl).

Uma aplicação deste método para a Lei de Conservação foi desenvolvido por “Godunov”

(LeVeque, 2002). Baseado nesta aplicação, Godunov desenvolveu o “Algoritmo REA” (Recons-

truct-Evolve-Average) para a equação de advecção. Tal algoritmo é dividido em três passos

como descrito a seguir:



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 14

Algoritmo REA:

1. Reconstruir uma função polinomial por partes p?l(x, z, vl) definida para todo x e z,
pelas médias das células P lm,n. No caso mais simples esta é uma função constante
por partes que leva o valor P lm,n na (m, n)-ésima célula,

p?l(x, z, vl) = P
l
m,n , para todo (x, z) ? Cm,n .

2. Evoluir a equação da onda imagem exatamente (ou aproximadamente) com estes
dados iniciais para obter p?l+1(x, z, vl+1) para uma velocidade ?v posterior.

3. Calcular a média desta função sobre cada célula da malha para obter uma nova média
da célula

P l+1m,n =
1

?x

1

?z

? ?

Cm,n

p?l+1(x, z, vl+1) dx dz .

Este processo completo é então repetido nos próximos passos da velocidade.

Como dado inicial para usarmos este algoritmo (veja Figura 3.2), supomos pl(x, z, vl) uma

função contínua para todo ponto (x, z), p0(x, z, v0). A partir desta função calculamos a mé-

dia do volume, P lm,n, para todas as células Cm,n através da expressão (3.1). Tendo as médias
P lm,n, aplicamos o primeiro passo do algoritmo REA, ou seja, reconstruimos então uma função

polinomial por partes p?l(x, z, vl) através das médias P lm,n, para todo (x, z) ? Cm,n. Esta recons-
trução é feita de tal forma que obtemos uma função seccionalmente contínua para todo (x, z),

que pode ser evoluída a partir do passo dois utilizando, por exemplo, o método de DF.

No passo de evolução, os dados são passados de p?l(x, z, vl) para uma função ainda sec-

cionalmente contínua p?l+1(x, z, vl+1) através de algum método numérico, como pode ser visto

na Figura 3.2. Sobre esta, aplicamos o passo 3, i.e., calculamos uma nova média dos dados

evoluídos p?l+1(x, z, vl+1), obtendo assim P l+1m,n.

No final do passo 3, temos novamente médias nas células só que agora num nível posterior.

Podemos então voltar ao passo 1 e reconstruir uma nova função polinomial por partes para fazer

uma nova evolução e consequentemente uma nova média, e assim por diante, como ilustrado na

Figura 3.2.

Vemos então, que a principal diferença entre o método de VF e o método de DF é o fato de o



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 15

i?1/2x xi+1/2

0 0
p (x,z,v )

P lm,n

p (x,z,v )l
^ l

P l+1m,n

i?1/2z

zi+1/2
m,n

^ l+1p     (x,z,v     ) l+1

x

z

xx

x x x

xx x

x

xxx

x

xx

x

x

x

Passo 1 (Reconstruir):

Passo 2 (Evoluir):

Dados iniciais:

Passo 3 (Media):

Media:

C

Figura 3.2: Ilustração do algoritmo REA para uma malha de dados. Os dados iniciais são

subdivididos em células Cm,n e usa-se a expressão (3.1) para calcular as médias nessas células.
Passo 1: recontrução da malha a partir das médias P lm,n. Passo 2: evolução dos dados para um

nível posterior na velocidade (através de algum método). Passo 3: cálculo das novas médias no

novo nível.



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 16

primeiro utilizar uma aproximação para a média nas células, P lm,n, para calcular o próximo nível

da propagação, enquanto que o segundo utiliza somente os dados pontuais plm,n. Utilizamos

uma adaptação do algoritmo REA para implementar o método de VF para a equação da onda

imagem (1.1). A seção seguinte descreve este procedimento.

3.2 Implementação

Uma pergunta a se fazer é como podemos calcular P lm,n a partir de (3.1) quando não co-

nhecemos p(x, z, vl) para todos os valores de (x, z) ? Cm,n, mas somente a função discretizada
plm,n em (xm, zn), veja os dados iniciais na Figura 3.3. Nesta situação, não podemos resolver

a equação (3.1) pois não temos a informação sobre os valores da função no interior da célula

Cm,n.
Então, ao invés de calcular a integral da equação (3.1) de maneira exata, aproximamo-la

utilizando a “Regra dos Trapézios” a partir dos valores discretizados plm,n. Em outras palavras,

para aproximar a integral em duas variáveis, utilizamos a seguinte aproximação
? b

a

? d

c
f (x, z) dx dz ?

?x?z

4
[f (a, c) + f (a, d) + f (b, c) + f (b, d)] . (3.2)

Esta aproximação foi usada para fazer uso dos pontos onde a função original é dada. Uma

aproximação com mais pontos poderia também ser utilizada, contanto que os dados para tal

estejam disponíveis.

Substituindo a aproximação acima na equação (3.1), obtemos a seguinte expressão para as

médias P lm,n,

P lm,n =
1

4
[plm?1/2,n?1/2 + p

l
m?1/2,n+1/2 + p

l
m+1/2,n?1/2 + p

l
m+1/2,n+1/2] , (3.3)

para uma velocidade fixa vl. Entretanto, para calcularmos a média P lm,n no ponto (xm, zn), pre-

cisaríamos dos valores da função p nos pontos intermediários da malha, conforme explicitado

na equação (3.3). Como os dados iniciais são fornecidos somente em cima dos pontos da malha,

calculamos então, ao invés da equação (3.3), a seguinte média

P lm+1/2,n+1/2 =
1

4
[plm,n + p

l
m,n+1 + p

l
m+1,n + p

l
m+1,n+1] , (3.4)



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 17

P l+1m,n

xi+1ix

zi+1

iz
p lm,n

P lm,n

p lm,n=P
l

m,n

p l+1m,n

m,n

x

z

xx

x x x

xx x

x

xxx

x

x

x x

Passo 1 (Reconstruir):

Passo 2 (Evoluir):

Dados iniciais:

Passo 3 (Media):

Media:

o

ooo

ooo

oooo

oooo

oooo

o o o o

oooo

oooo

ooo

ooo

o

o

oooo

ooo

o

x x

x

x

x
x x x

xx x
x

x

x

o

o

o
C

Figura 3.3: Ilustração do algoritmo REA para uma malha discreta de dados. Os dados iniciais

são subdivididos em células Cm,n e usa-se uma das equações (3.9) para calcular as médias
nessas células. Passo 1: recontrução da malha discreta, como sugerido ser o caso mais simples,

plm,n = P
l
m,n. Passo 2: evolução dos dados para um nível posterior na velocidade, usando

método de DF. Passo 3: cálculo das novas médias no novo nível.



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 18

como ilustrado na Figura 3.3. Logo, concluímos que a média na célula Cm,n para o nosso caso
de uma malha de pontos discreta bidimensional, é simplesmente uma média linear entre quatro

pontos da célula da malha.

Mas, na prática, o valor de P lm+1/2,n+1/2 é atribuido à variável P
l
m,n que constitui a base

para o passo seguinte da evolução pois não possuímos os pontos intermediários da malha (caso

Média na Figura 3.3).

Após termos obtido as médias P lm,n, podemos aplicar o primeiro passo do algoritmo de

Godunov. Neste passo, reconstruímos uma função constante por partes, como sugerido ser o

caso mais simples para a reconstrução, ou seja, plm,n = P lm,n (passo 1 na Figura 3.3). Assim,

tendo obtido uma nova função após a reconstrução podemos executar um passo da evolução do

método, i.e., o segundo passo do algoritmo, usando o método de DF.

Para o passo da evolução do algoritmo REA (passo 2 na Figura 3.3), no caso de uma malha

discreta, foram utilizadas, a critério de comparação, as duas aproximações pelo método de DF

já estudadas anteriormente em Schleicher et al. (2004a). Ou seja, para as derivadas segundas es-

paciais, usamos aproximações de quarta ordem (veja, por exemplo, Strikwerda, 1989; Thomas,

1995), i.e.,

pxx ? ?(2)x,4p =
1

12(?x)2

[

?plm+2,n ? plm?2,n + 16(plm+1,n + plm?1,n) ? 30plm,n
]

(3.5)

(uma expressão correspondente para pzz) e para a derivada mista a aproximação avançada em v

e z e a avançada em v e atrasada em z, i.e., respectivamente,

pvz ?
pl+1m,n+1 ? pl+1m,n ? plm,n+1 + plm,n

?z?v
e pvz ?

pl+1m,n ? pl+1m,n?1 ? plm,n + plm,n?1
?z?v

. (3.6)

Desta forma, obtemos dois esquemas de DF para a propagação da onda imagem:

Avançado em v e z

pl+1m,n+1 = ?
zn?z?v

vl

{

?
(2)
x,4p + ?

(2)
z,4p

}

+ pl+1m,n + p
l
m,n+1 ? plm,n , (3.7)

Avançado em v e atrasado em z

pl+1m,n = ?
zn?z?v

vl

{

?
(2)
x,4p + ?

(2)
z,4p

}

+ pl+1m,n?1 + p
l
m,n ? plm,n?1 . (3.8)



CAPÍTULO 3. INTRODUÇÃO AO MÉTODO DE VOLUMES FINITOS 19

Estamos utilizando tais esquemas pois estes foram os que tiveram resultados convergentes

para a solução da onda imagem (1.1) pelo método de DF. Os respectivos resultados numéricos

se encontram no Capítulo 5.

Em conseqüência da evolução realizada no passo 2, como descrita anteriormente, podemos

agora passar para o passo 3, onde neste novamente fazemos as médias em cada uma das células

da malha utilizando a equação (3.4), ver Figura 3.3. No entanto, precisamos novamente atribuir

P lm+1/2,n+1/2 à variável P
l
m,n e esta atribuição, porém, é equivalente a um deslocamento por

meia célula. Como esta média é feita em todo passo do algoritmo, foi observado que esta causa

uma propagação dos dados, isto devido ao deslocamento que estamos fazendo para armazenar

os dados, já que não temos os pontos intermediários da malha.

Além disso, foi observado, também, que esta propagação causada pelo deslocamento da

média é maior que a realizada pela onda imagem causando assim uma não convergência do

método.

A solução para esta falha na implementação foi, portanto, fazer a média em um sentido

para um passo e no sentido contrário para o passo seguinte, ou seja, fazemos a média em duas

direções distintas para que o deslocamento dos dados seja compensado a cada segunda iteração

do algoritmo.

Resumindo, as médias são então calculadas da seguinte forma, em cada passo da velocidade,

passo ímpar: P lm,n =
1

4
[plm,n + p

l
m,n+1 + p

l
m+1,n + p

l
m+1,n+1] ,

passo par: P lm,n =
1

4
[plm?1,n?1 + p

l
m,n?1 + p

l
m?1,n + p

l
m,n] , (3.9)

como pode ser visto na Figura 3.3.

Desta maneira, conseguimos fazer com que o método de VF propagasse a equação da onda

imagem à sua profundidade correta. Portanto, através de uma adaptação do algoritmo de Go-

dunov (REA), construímos um esquema de VF para a equação da onda imagem que é conver-

gente (ver Capítulo 5). Apesar de óbvio, constatamos que há um acréscimo no tempo computa-

cional em relação ao método de DF pois fazemos o cálculo das médias em cada iteração do

algoritmo, (ver Seção 5.5).



Capítulo 4

Esquemas de diferenças finitas implícitos

Além da abordagem pelo método de VF, exposta no Capítulo 3, tentamos solucionar os

problemas numéricos que aparecem ao propagarmos uma imagem sísmica através de esquemas

de DF implementados explicitamente, como detalhado em Schleicher et al. (2004a,b), usando

esquemas de DF implementados implicitamente.

Para isso, dividimos nossos estudos desse capítulo em duas partes onde em cada uma delas

trabalhamos com aproximações implícitas de forma diferente. Na primeira, utilizamos os já

estudados esquemas avançado em v e z e avançado em v e atrasado em z (Schleicher et al.,

2004a,b), mas agora implementados de maneira implícita pois, no trabalho citado, estes só

foram resolvidos explicitamente. Na segunda forma, foi feita uma aproximação avaliada no

centro da célula pois esta forma de aproximação gerou bons resultados quando aplicada à remi-

gração no tempo, conforme demonstrado no trabalho realizado por Fomel (2003).

Nas seções seguintes fazemos um estudo de cada uma dessas aproximações onde os respec-

tivos experimentos numéricos estão descritos no Capítulo 5.

4.1 Esquemas implícitos convencionais

Agora, queremos implementar implicitamente os esquemas de DF utilizados anteriormente,

i.e., o avançado em v e z e o avançado em v e atrasado em z, para que possamos compará-

20



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 21

los com estes mesmos quando estes são implementados de maneira explícita, como foi feito

em Schleicher et al. (2004a,b). Estes esquemas foram implentados de maneira explícita pois

foi observado que condições de contorno adicionais poderiam ser tomadas nulas facilitando a

implementação.

Porém, quando tais esquemas são considerados explícitos aparecem alguns efeitos indese-

jados na propagação da onda imagem (1.1), como, por exemplo, a dispersão numérica. Então,

o motivo de uma implementação implícita desses esquemas é que queremos fazer com que não

seja necessário criar condições de contorno adicionais tentando evitar assim que tais efeitos

indesejados apareçam na propagação.

4.1.1 Desenvolvimento

Considerando uma malha de pontos no espaço (x, z, v), como definida no capítulo ante-

rior, montamos os esquemas de DF implícitos. Para as derivadas segundas espaciais pxx e pzz ,

usamos a aproximações de quarta ordem como a representada pela equação (3.5).

Os esquemas escolhidos para a derivada mista foram os mesmos do capítulo anterior e de

Schleicher et al. (2004a,b). No que segue, consideramos esses esquemas, escritos de forma a

simplificar a identificação de um esquema implícito na velocidade de migração,

Avançado em v e z

µln[p
l+1
m,n ? pl+1m,n+1] = ??plm,n?2 + 16?plm,n?1 ? ?plm?2,n + 16?plm?1,n
?[30(? + ?) ? µln]plm,n + 16?plm+1,n ? ?plm+2,n + (16? ? µln)plm,n+1 ? ?plm,n+2 , (4.1)

Avançado em v e atrasado em z

?µln[pl+1m,n ? pl+1m,n?1] = ??plm,n?2 + (16? + µln)plm,n?1 ? ?plm?2,n + 16?plm?1,n
?[30(? + ?) + µln]plm,n + 16?plm+1,n ? ?plm+2,n + 16?plm,n+1 ? ?plm,n+2 , (4.2)

onde ? = 1/(12?x2), ? = 1/(12?z2) e µln = vl/(zn?z?v) .



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 22

Como podemos observar, estes esquemas de DF são esquemas implícitos na velocidade.

Porém, para acelerar os testes numéricos foram tratados como esquemas explícitos em Schlei-

cher et al. (2004a,b).

Para estes casos, também esperamos um aumento no custo computacional pois, apesar de

esquemas implícitos possuirem em geral matrizes esparsas, temos que resolver sistemas lineares

de grande porte (muito comum em sísmica) que, geralmente, é mais caro que uma implemen-

tação explícita.

4.1.2 Implementação

Esquema avançado em v e z

A implementação implícita do método de DF avançada em v e z foi feita de duas formas

diferentes. Em ambas as formas utilizamos a discretização dada pela equação (4.1). A diferença

entre as duas formas está na ordem de execução e, portanto, na forma das matrizes de iteração.

No primeiro caso, para montarmos tais matrizes, fixamos a variável x e variamos z, no segundo

caso fixamos z e variamos x. Fizemos isto pois, ao implementarmos o primeiro caso vimos que

a propagação da onda imagem estava sofrendo uma dispersão numérica muito grande. Assim,

mediante este fato e estudos anteriores do método explícito, a construção das matrizes de ite-

ração foi realizada utilizando a segunda forma, pois quando implementamos a forma explícita

deste caso em Schleicher et al. (2004a), fixando z e variando x, obtivemos melhores resultados

conforme descritos no Capítulo 5.

Para fins de implementação, escrevemos a equação (4.1) na forma matricial, Alul+1m = bl,

onde ul+1m representa o vetor a ser determinado a cada passo, i.e., ul+1m =
[

pl+1m,1, p
l+1
m,2, . . . , p

l+1
m,nz

]T
,

e onde bl representa o vetor conhecido no lado direito da equação (4.1). Observamos que, tanto

a matriz Al quanto o vetor bl precisam ser atualizados a cada iteração do algoritmo, ou seja, a

cada passo da velocidade. Para o caso de x fixo e z variando, a matriz Al correspondente do

esquema (4.1) tem a forma



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 23

Al =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

µl1 ?µl1
µl2 ?µl2

µl3 ?µl3
. . . . . .

µlnz?1 ?µlnz?1
µlnz

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

,

onde µln = vl/(zn?z?v). Aqui e no restante do texto, espaços em branco em uma matriz

representam elementos nulos. Em decorrência das condições de contorno necessárias para o

problema, implementamos este algoritmo por blocos, i.e., a cada passo da velocidade resolve-

mos cada um dos sistemas abaixo

Bloco 1: Alul+11 = E
lul1 + Du

l
2 + Cu

l
3 = b

l
1

Bloco 2: Alul+12 = Du
l
1 + E

lul2 + Du
l
3 + Cu

l
4 = b

l
2

Blocos j = 3,..., nx?2: Alul+1j = Culj?2 + Dulj?1 + Elulj + Dulj+1 + Culj+2 = blj
Bloco nx?1: Alul+1nx?1 = Culnx?3 + Dulnx?2 + Elulnx?1 + Dulnx = blnx?1

Bloco nx: Alul+1nx = Cu
l
nx?2 + Du

l
nx?1 + E

lulnx = b
l
nx ,

onde o vetor blj representa a forma do vetor bl para o bloco j, que é construído a partir das

matrizes C, D e El e do dado inicial U l0. Aqui, supomos que os dados iniciais possam ser

escritos da seguinte forma matricial,

U l0 =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

pl1,1 p
l
1,2 p

l
1,3 · · · pl1,nz

pl2,1 p
l
2,2 p

l
2,3 · · · pl2,nz

pl3,1 p
l
3,2 p

l
3,3 · · · pl3,nz

...
...

... . . .
...

plnx,1 p
l
nx,2 p

l
nx,3 · · · plnx,nz

?

?

?

?

?

?

?

?

?

?

?

?

?

?

, (4.3)

onde o vetor ulj =
[

plj,1, p
l
j,2, . . . , p

l
j,nz

]T
representa a j-ésima linha transposta da matriz U l0,

j = 1, . . . , nx, com nx sendo o número de elementos de x. Portanto, resolvemos nx sistemas



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 24

lineares em cada passo de vl. Usando a notação Iz para a matriz identidade nz ×nz, as matrizes
do lado direito são dadas por

C = ?? Iz , D = 16? Iz e

El =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

dl1 e
l
1 ??

16? dl2 e
l
2 ??

?? 16? dl3 el3 ??
. . . . . . . . . . . . . . .

?? 16? dlnz?2 elnz?2 ??
?? 16? dlnz?1 elnz?1

?? 16? dlnz

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

,

onde dli = µli ? 30(? + ?), eli = 16? ? µli, para i = 1, 2, . . . , nz, com nz sendo o número de
elementos de z. As matrizes Al, C, D e El possuem dimensão nz × nz. Observamos que a
matriz El precisa ser atualizada a cada passo enquanto as matrizes C e D são constantes durante

a execução do algoritmo.

Já para o caso de fixar a variável z e variar x, encontramos uma desvantagem na imple-

mentação, porém, os resultados obtidos se mostraram melhores que no caso anterior. Esta

desvantagem foi o fato de não conseguirmos representar a matriz de iteração de uma maneira

tão simples e fácil de resolver como no caso onde fixamos a variável x. Neste caso, a forma

matricial do esquema (4.1) é Aliu
l+1
i + B

l
iu

l+1
i+1 = b

l, onde ul+1i representa o vetor u
l+1
i =

[

pl+1nx,i, p
l+1
nx?1,i, . . . , p

l+1
1,i

]T
, para i = nz, . . . , 1.

As matrizes envolvidas para este caso, são similares às do caso anterior. Porém, a imple-

mentação só é possível se resolvermos o sistema linear de trás para frente. Usando a notação Ix
para a matriz identidade nx × nx, as matrizes do lado esquerdo, para este caso, são

Ali = µ
l
i Ix , B

l
i = ?µli Ix ,

onde µli = vl/(zi?z?v) . Aqui, além das matrizes Ali e Bli serem atualizadas a cada passo da

velocidade de propagação l, estas também são diferentes em cada bloco i. Ou seja, ainda por



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 25

causa das condições de contorno necessárias para o problema, implementamos este algoritmo

por blocos, só que, neste caso, resolvendo os blocos de trás para frente, i.e., a cada passo da

velocidade resolvemos cada um dos sistemas abaixo

Bloco nz: Alnz u
l+1
nz = Cu

l
nz?2 + Du

l
nz?1 + E

l
nzu

l
nz = b

l
nz

Bloco nz?1: Alnz?1 ul+1nz?1 + Blnz?1 ul+1nz = Culnz?3 + Dulnz?2 + Elnz?1ulnz?1
+F lnz?1u

l
nz = b

l
nz?1

Blocos i = nz?2,..., 3: Ali ul+1i + Bli ul+1i+1 = Culi?2 + Duli?1 + Eliuli + F li uli+1 + Culi+2 = bli
Bloco 2: Al2 u

l+1
2 + B

l
2 u

l+1
3 = Du

l
1 + E

l
2u

l
2 + F

l
2u

l
3 + Cu

l
4 = b

l
2

Bloco 1: Al1 u
l+1
1 + B

l
1 u

l+1
2 = E

l
1u

l
1 + F

l
1u

l
2 + Cu

l
3 = b

l
1 ,

onde o vetor bli representa a forma do vetor bl para o bloco i, que é construído a partir das ma-

trizes C, D, Eli e F li e do dado inicial U l0 representado por (4.3). O vetor uli =
[

plnx,i, p
l
nx?1,i, . . . ,

pl1,i
]T

representa a i-ésima coluna invertida da matriz U l0 (i = nz, . . . , 1), com nz sendo o

número de elementos de z. Portanto, resolvemos nz sistemas lineares em cada passo de v. As

matrizes do lado direito são dadas por

C = ?? Ix , D = 16? Ix , F li = (16? ? µli) Ix e

Eli =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

dli 16? ??
16? dli 16? ??
?? 16? dli 16? ??

. . . . . . . . . . . . . . .

?? 16? dli 16? ??
?? 16? dli 16?

?? 16? dli

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

,

onde i = nz, . . . , 1. Logo, as matrizes Eli e F li também devem ser atualizadas em cada iteração

do algoritmo, assim como são diferentes em cada bloco a ser resolvido. As matrizes acima

possuem dimensão nx × nx.
Quando implementamos este último algoritmo, com z fixo, obtemos uma propagação da

onda imagem com a dispersão numérica reduzida em comparação ao caso para x fixo. Ape-

sar de termos obtido um resultado convergente, foi observado que os resultados obtidos para



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 26

esta implementação são muito similares aos obtidos para com a implementação explícita. Os

resultados obtidos estão descritos no Capítulo 5.

Esquema avançado em v e atrasado em z

Considerações correspondentes se aplicam ao caso deste esquema. Verifica-se que as ma-

trizes envolvidas ficam muito semelhantes. Por isso, não há necessidade de explicitá-las aqui.

4.2 Esquema avaliado no centro da célula

Nesta seção, estudamos uma aproximação alternativa de DF implícita a qual identificamos

como esquema avaliado no centro da célula. Este tipo de aproximação foi sugerido e estudado

por Fomel (2003) para o caso de remigração no tempo e mostrou um bom desempenho naquele

caso.

Esta nova aproximação, diferentemente das aproximações de DF vistas neste trabalho, faz

a discretização da onda imagem (1.1) nos centros das células da malha ao invés de discretizá-la

nos vértices desta.

Nas subseções seguintes, descrevemos detalhadamente este esquema assim como sua im-

plementação e sua respectiva análise numérica. Ao contrário dos esquemas estudados na Seção

4.1, este esquema não pode ser implementado de forma explícita.

4.2.1 Desenvolvimento

Para montar o esquema de DF avaliado no centro da célula, para a equação da onda imagem,

consideramos uma malha de pontos no espaço (x, z, v) conforme descrito no Capítulo 3.

Porém, para este esquema, nossa discretização é feita no ponto (xm, zn+1/2, vl+1/2), ou seja,

pxx

?

?

?

?

l+ 1
2

m,n+ 1
2

+ pzz

?

?

?

?

l+ 1
2

m,n+ 1
2

+
v

z
pvz

?

?

?

?

l+ 1
2

m,n+ 1
2

= 0 . (4.4)

No entanto, o ponto (xm, zn+1/2, vl+1/2) não é um ponto da malha, portanto, aproximamos o

campo p neste ponto pela média aritmética dos seus valores nos 4 pontos dos vértices da célula



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 27

(m,n,l) (m,n+1,l)

(m,n,l+1) (m,n+1,l+1)

(m,n+1/2,l+1/2)

x

Figura 4.1: Aproximação do ponto (xm, zn+1/2, vl+1/2).

(veja Figura 4.1). Logo, para as derivadas segunda em relação a x e z, temos

pxx

?

?

?

?

l+ 1
2

m,n+ 1
2

= 1
4

[

pxx
?

?

?

l
m,n + pxx

?

?

?

l
m,n+1 + pxx

?

?

?

l+1
m,n + pxx

?

?

?

l+1
m,n+1

]

,

pzz

?

?

?

?

l+ 1
2

m,n+ 1
2

= 1
4

[

pzz
?

?

?

l
m,n + pzz

?

?

?

l
m,n+1 + pzz

?

?

?

l+1
m,n + pzz

?

?

?

l+1
m,n+1

]

.

(4.5)

Para a derivada mista pvz , fazemos então uma aproximação avaliada no centro da célula da

seguinte forma

pvz

?

?

?

?

l+ 1
2

m,n+ 1
2

=
1

?z?v

[

pl+1m,n+1 ? plm,n+1 ? pl+1m,n + plm,n
]

. (4.6)

E, para o termo que multiplica pvz , fazemos uma média linear nos dois níveis l, l + 1 e n, n + 1,

i.e.,

v

z

?

?

?

?

l+ 1
2

m,n+ 1
2

=
(vl+1 + vl)/2

(zn+1 + zn)/2
=

vl+1 + vl
zn+1 + zn

=
2vl + ?v

2zn + ?z
. (4.7)

Agora, podemos substituir as aproximações de (4.5), (4.6) e (4.7) na equação (4.4) e chegar

na seguinte equação, quando isolamos os termos do nível l + 1 do lado esquerdo e os do nível l

do lado direito,
[

pxx
?

?

?

l+1
m,n + pxx

?

?

?

l+1
m,n+1 + pzz

?

?

?

l+1
m,n + pzz

?

?

?

l+1
m,n+1 + k

l
n

(

pl+1m,n+1 ? pl+1m,n
)]

=

?
[

pxx
?

?

?

l
m,n + pxx

?

?

?

l
m,n+1 + pzz

?

?

?

l
m,n + pzz

?

?

?

l
m,n+1 + k

l
n

(

plm,n ? plm,n+1
)]

,
(4.8)



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 28

onde

kln =
4(2vl + ?v)

(2zn + ?z)?z?v
. (4.9)

Na equação (4.8), falta ainda discretizar cada um dos termos de derivadas segunda em x e

z. Assim, para essas derivadas espaciais, usamos as aproximações de segunda ordem descritas

abaixo (veja, por exemplo, Strikwerda, 1989; Thomas, 1995)

pxx
?

?

?

l
m,n ? ?

(2)
x,2p =

plm+1,n ? 2plm,n + plm?1,n
?x2

e

pzz
?

?

?

l
m,n ? ?

(2)
z,2p =

plm,n+1 ? 2plm,n + plm,n?1
?z2

.

(4.10)

Nesta implementação, reduzimos a ordem das aproximações das derivadas segundas para faci-

litar as contas.

As aproximações (4.10) são então substituídas na equação (4.8). Logo, após algumas sim-

plificações algébricas, chegamos em

?pl+1m,n?1 + ?p
l+1
m?1,n + µ

l
np

l+1
m,n + ?p

l+1
m+1,n + ?p

l+1
m?1,n+1

+?lnp
l+1
m,n+1 + ?p

l+1
m+1,n+1 + ?p

l+1
m,n+2 = ?

[

?plm,n?1 + ?p
l
m?1,n + ?

l
np

l
m,n

+?plm+1,n + ?p
l
m?1,n+1 + µ

l
np

l
m,n+1 + ?p

l
m+1,n+1 + ?p

l
m,n+2

]

, (4.11)

onde ? = 1/?x2, ? = 1/?z2, µln = ?kln ? 2? ? ? e ?ln = kln ? 2? ? ?.
A partir da discretização acima, observamos que o esquema só pode ser resolvido implici-

tamente. Logo, os trabalhos computacionais tornam-se mais complicados e custosos que nos

casos onde podemos considerar o esquema como sendo explícito, através de condições adi-

cionais de contorno.

A seguir, fazemos uma análise numérica deste esquema, assim como uma discussão a res-

peito de como este pode ser implementado. O resultado numérico deste esquema está apresen-

tado no Capítulo 5.



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 29

4.2.2 Consistência

Nesta seção, estudamos a consistência do esquema avaliado no centro da célula. Sabe-

mos que um esquema de DF é consistente com a equação diferencial parcial, se para qualquer

função suave ?(x, z, v), a diferença entre o operador diferencial e o discretizado em um ponto

(xm, zn, vl), aplicados a esta função, tende a zero quando ?x, ?z e ?v tendem a zero, i.e.,

L? ? L?? ? 0 , quando ?x, ?z, ?v ? 0 , (4.12)

onde L?? = L?xx? + L?zz? + L?vz? representa o operador discretizado do operador

L =
?

?x2
+

?

?z2
+

v

z

?

?v?z
.

Para verificarmos se o esquema citado na seção anterior é consistente, consideramos as

séries de Taylor de ordem conveniente para determinar seu operador discretizado.

Primeiramente, consideramos a aproximação para pxx no centro da célula dada pela primeira

expressão da equação (4.5), só que agora aplicada a função suave ?, ou seja,

L?xx? =
1

4

[

?
(2)
x,2?

?

?

?

l
m,n + ?

(2)
x,2?

?

?

?

l
m,n+1 + ?

(2)
x,2?

?

?

?

l+1
m,n + ?

(2)
x,2?

?

?

?

l+1
m,n+1

]

,

onde podemos substituir a primeira expressão da equação (4.10) em cada um dos seus termos e

chegar em

L?xx? =
1

4?x2

[

?lm+1,n ? 2?lm,n + ?lm?1,n + ?l+1m+1,n ? 2?l+1m,n + ?l+1m?1,n + ?lm+1,n+1
?2?lm,n+1 + ?lm?1,n+1 + ?l+1m+1,n+1 ? 2?l+1m,n+1 + ?l+1m?1,n+1

]

. (4.13)

Agora, para cada um dos termos da equação acima, fazemos uma expansão em série de

Taylor na variável v em torno de v = vl+1/2. Para facilitar as contas, tomamos esses termos aos

pares para que alguns termos se cancelem entre si. Assim, para o primeiro e o quarto termo de

(4.13), temos

?lm+1,n = ?
l+ 1

2

m+1,n ?
?v

2
(?v)

l+ 1
2

m+1,n +
?v2

8
(?vv)

l+ 1
2

m+1,n + O(?v3) ,

?l+1m+1,n = ?
l+ 1

2

m+1,n +
?v

2
(?v)

l+ 1
2

m+1,n +
?v2

8
(?vv)

l+ 1
2

m+1,n + O(?v3) .



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 30

Logo, a soma desses termos fornece

?lm+1,n + ?
l+1
m+1,n = 2?

l+ 1
2

m+1,n +
?v2

4
(?vv)

l+ 1
2

m+1,n + O(?v3) . (4.14)

Agora, para o segundo e o quinto termo de (4.13), temos

?2?lm,n = ?2
[

?
l+ 1

2
m,n ?

?v

2
(?v)

l+ 1
2

m,n +
?v2

8
(?vv)

l+ 1
2

m,n + O(?v3)
]

,

?2?l+1m,n = ?2
[

?
l+ 1

2
m,n +

?v

2
(?v)

l+ 1
2

m,n +
?v2

8
(?vv)

l+ 1
2

m,n + O(?v3)
]

,

e, portanto,

?2(?lm,n + ?l+1m,n) = ?4?
l+ 1

2
m,n ?

?v2

2
(?vv)

l+ 1
2

m,n + O(?v3) . (4.15)

Similarmente, podemos fazer para os demais termos da equação (4.13) e encontrar

?lm?1,n + ?
l+1
m?1,n = 2?

l+ 1
2

m?1,n +
?v2

4
(?vv)

l+ 1
2

m?1,n + O(?v3) , (4.16)

?lm+1,n+1 + ?
l+1
m+1,n+1 = 2?

l+ 1
2

m+1,n+1 +
?v2

4
(?vv)

l+ 1
2

m+1,n+1 + O(?v3) , (4.17)

?2(?lm,n+1 + ?l+1m,n+1) = ?4?
l+ 1

2

m,n+1 ?
?v2

2
(?vv)

l+ 1
2

m,n+1 + O(?v3) , (4.18)

?lm?1,n+1 + ?
l+1
m?1,n+1 = 2?

l+ 1
2

m?1,n+1 +
?v2

4
(?vv)

l+ 1
2

m?1,n+1 + O(?v3) . (4.19)

Agora, expandimos os novos termos acima, (4.14) até (4.19), em série de Taylor na variável

z em torno de z = zn+1/2. Novamente, para facilitar as contas, agrupamos os termos aos pares

para que alguns termos se cancelem entre si. Iniciando com a expansão da soma (4.14), temos

?lm+1,n + ?
l+1
m+1,n = 2

[

?
l+ 1

2

m+1,n+ 1
2

? ?z
2

(?z)
l+ 1

2

m+1,n+ 1
2

+
?z2

8
(?zz)

l+ 1
2

m+1,n+ 1
2

+ O(?z3)
]

+
?v2

4

?

?(?vv)
l+ 1

2

m+1,n+ 1
2

?
?z

2

(

?3?

?v2?z

)l+ 1
2

m+1,n+ 1
2

+
?z2

8

(

?4?

?v2?z2

)l+ 1
2

m+1,n+ 1
2

+O(?z3)
]

+ O(?v3) ,

e, para a soma (4.17), temos

?lm+1,n+1 + ?
l+1
m+1,n+1 = 2

[

?
l+ 1

2

m+1,n+ 1
2

+
?z

2
(?z)

l+ 1
2

m+1,n+ 1
2

+
?z2

8
(?zz)

l+ 1
2

m+1,n+ 1
2

+ O(?z3)
]



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 31

+
?v2

4

?

?(?vv)
l+ 1

2

m+1,n+ 1
2

+
?z

2

(

?3?

?v2?z

)l+ 1
2

m+1,n+ 1
2

+
?z2

8

(

?4?

?v2?z2

)l+ 1
2

m+1,n+ 1
2

+O(?z3)
]

+ O(?v3) .

Portanto, somando as duas igualdades acima, obtemos

?lm+1,n + ?
l+1
m+1,n + ?

l
m+1,n+1 + ?

l+1
m+1,n+1 =

4?
l+ 1

2

m+1,n+ 1
2

+
?z2

2
(?zz)

l+ 1
2

m+1,n+ 1
2

+
?v2

2
(?vv)

l+ 1
2

m+1,n+ 1
2

+
?v2?z2

16

(

?4?

?v2?z2

)l+ 1
2

m+1,n+ 1
2

+O(?v3) + O(?z3) . (4.20)

Similarmente, para os outros termos, obtemos

?2(?lm,n + ?l+1m,n + ?lm,n+1 + ?l+1m,n+1) =

?8?l+
1

2

m,n+ 1
2

? ?z2(?zz)
l+ 1

2

m,n+ 1
2

? ?v2(?vv)
l+ 1

2

m,n+ 1
2

?
?v2?z2

8

(

?4?

?v2?z2

)l+ 1
2

m,n+ 1
2

+O(?v3) + O(?z3) , (4.21)

e

?lm?1,n + ?
l+1
m?1,n + ?

l
m?1,n+1 + ?

l+1
m?1,n+1 =

4?
l+ 1

2

m?1,n+ 1
2

+
?z2

2
(?zz)

l+ 1
2

m?1,n+ 1
2

+
?v2

2
(?vv)

l+ 1
2

m?1,n+ 1
2

+
?v2?z2

16

(

?4?

?v2?z2

)l+ 1
2

m?1,n+ 1
2

+O(?v3) + O(?z3) . (4.22)

Agora, expandimos as equações (4.20) e (4.22) em x e em torno de xm e as somamos.

A partir daqui, omitimos o ponto no qual estamos pois todos os termos do lado direito das

igualdades já estão no ponto (xm, zn+1/2, vl+1/2). Expandindo a equação (4.20), temos

?lm+1,n + ?
l+1
m+1,n + ?

l
m+1,n+1 + ?

l+1
m+1,n+1 =

4

[

? + ?x?x +
?x2

2
?xx +

?x3

6
?xxx +

?x4

24

?4?

?x4
+ O(?x5)

]

+
?z2

2

[

?zz + ?x
?3?

?z2?x
+

?x2

2

?4?

?z2?x2
+

?x3

6

?5?

?z2?x3
+

?x4

24

?6?

?z2?x4
+ O(?x5)

]



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 32

+
?v2

2

[

?vv + ?x
?3?

?v2?x
+

?x2

2

?4?

?v2?x2
+

?x3

6

?5?

?v2?x3
+

?x4

24

?6?

?v2?x4
+ O(?x5)

]

+
?v2?z2

16

[

?4?

?v2?z2
+ ?x

?5?

?v2?z2?x
+

?x2

2

?6?

?v2?z2?x2
+

?x3

6

?7?

?v2?z2?x3

+
?x4

24

?8?

?v2?z2?x4
+ O(?x5)

]

+ O(?v3) + O(?z3) ,

e a equação (4.22),

?lm?1,n + ?
l+1
m?1,n + ?

l
m?1,n+1 + ?

l+1
m?1,n+1 =

4

[

? ? ?x?x +
?x2

2
?xx ?

?x3

6
?xxx +

?x4

24

?4?

?x4
+ O(?x5)

]

+
?z2

2

[

?zz ? ?x
?3?

?z2?x
+

?x2

2

?4?

?z2?x2
? ?x

3

6

?5?

?z2?x3
+

?x4

24

?6?

?z2?x4
+ O(?x5)

]

+
?v2

2

[

?vv ? ?x
?3?

?v2?x
+

?x2

2

?4?

?v2?x2
? ?x

3

6

?5?

?v2?x3
+

?x4

24

?6?

?v2?x4
+ O(?x5)

]

+
?v2?z2

16

[

?4?

?v2?z2
? ?x

?5?

?v2?z2?x
+

?x2

2

?6?

?v2?z2?x2
?

?x3

6

?7?

?v2?z2?x3

+
?x4

24

?8?

?v2?z2?x4
+ O(?x5)

]

+ O(?v3) + O(?z3) .

Fazendo a soma, temos

?lm+1,n + ?
l+1
m+1,n + ?

l
m+1,n+1 + ?

l+1
m+1,n+1 + ?

l
m?1,n + ?

l+1
m?1,n + ?

l
m?1,n+1 + ?

l+1
m?1,n+1 =

8? + 4?x2?xx +
?x4

3

?4?

?x4
+ ?z2?zz +

?z2?x2

2

?4?

?z2?x2
+

?z2?x4

24

?6?

?z2?x4

+?v2?vv +
?v2?x2

2

?4?

?v2?x2
+

?v2?x4

24

?6?

?v2?x4
+

?v2?z2

8

?4?

?v2?z2

+
?v2?z2?x2

16

?6?

?v2?z2?x2
+

?v2?z2?x4

192

?8?

?v2?z2?x4

+O(?x5) + O(?v3) + O(?z3) . (4.23)

Portanto, somamos as equações (4.21) e (4.23) e obtemos

?lm+1,n + ?
l+1
m+1,n + ?

l
m+1,n+1 + ?

l+1
m+1,n+1 + ?

l
m?1,n + ?

l+1
m?1,n + ?

l
m?1,n+1 + ?

l+1
m?1,n+1

?2(?lm,n + ?l+1m,n + ?lm,n+1 + ?l+1m,n+1) =

4?x2?xx +
?x4

3

?4?

?x4
+

?z2?x2

2

?4?

?z2?x2
+

?z2?x4

24

?6?

?z2?x4



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 33

+
?v2?x2

2

?4?

?v2?x2
+

?v2?x4

24

?6?

?v2?x4
+

?v2?z2?x2

16

?6?

?v2?z2?x2

+
?v2?z2?x4

192

?8?

?v2?z2?x4
+ O(?x5) + O(?v3) + O(?z3)

= 4?x2?xx + O(?x4) + O(?v2?x2) + O(?z2?x2) + O(?v2?z2?x2) .

Aqui, utilizamos que os termos de ordem menor que ?x2 também cancelam nos termos não

explicitados de ordem ?v3 e ?z3.

Logo, voltando para a equação (4.13), temos

L?xx? = ?xx +
?x2

12

?4?

?x4
+

?z2

8

?4?

?z2?x2
+

?z2?x2

96

?6?

?z2?x4
+

?v2

8

?4?

?v2?x2

+
?v2?x2

96

?6?

?v2?x4
+

?v2?z2

64

?6?

?v2?z2?x2
+

?v2?z2?x2

768

?8?

?v2?z2?x4

+O(?x3) + O(?v3) + O(?z3) ,

= ?xx + O(?x2) + O(?z2) + O(?v2) . (4.24)

Na seqüência, consideremos a aproximação para pzz no centro da célula dada pela segunda

expressão da equação (4.5) novamente para uma função suave ?, ou seja,

L?zz? =
1

4

[

?zz
?

?

?

l
m,n + ?zz

?

?

?

l
m,n+1 + ?zz

?

?

?

l+1
m,n + ?zz

?

?

?

l+1
m,n+1

]

,

onde podemos substituir a segunda expressão da equação (4.10) em cada um dos seus termos e

chegar em

L?zz? =
1

4?z2

[

?lm,n+1 ? 2?lm,n + ?lm,n?1 + ?lm,n+2 ? 2?lm,n+1 + ?lm,n
+?l+1m,n+1 ? 2?l+1m,n + ?l+1m,n?1 + ?l+1m,n+2 ? 2?l+1m,n+1 + ?l+1m,n

]

,

=
1

4?z2

[

??lm,n+1 ? ?lm,n + ?lm,n?1 ? ?l+1m,n+1 ? ?l+1m,n + ?l+1m,n?1 + ?lm,n+2
+?l+1m,n+2

]

. (4.25)

Agora, para cada um dos termos da equação acima, fazemos uma expansão em série de

Taylor em torno de vl+1/2. Para facilitar as contas, agrupamos esses termos aos pares para que

alguns termos se cancelem entre si. Expandindo o primeiro e o quarto da equação (4.25), temos

??lm,n+1 = ??
l+ 1

2

m,n+1 +
?v

2
(?v)

l+ 1
2

m,n+1 ?
?v2

8
(?vv)

l+ 1
2

m,n+1 + O(?v3) ,

??l+1m,n+1 = ??
l+ 1

2

m,n+1 ?
?v

2
(?v)

l+ 1
2

m,n+1 ?
?v2

8
(?vv)

l+ 1
2

m,n+1 + O(?v3) ,



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 34

que somando, obtemos

??lm,n+1 ? ?l+1m,n+1 = ?2?
l+ 1

2

m,n+1 ?
?v2

4
(?vv)

l+ 1
2

m,n+1 + O(?v3) . (4.26)

Similarmente, para os demais termos, temos

??lm,n ? ?l+1m,n = ?2?
l+ 1

2
m,n ?

?v2

4
(?vv)

l+ 1
2

m,n + O(?v3) , (4.27)

?lm,n?1 + ?
l+1
m,n?1 = 2?

l+ 1
2

m,n?1 +
?v2

4
(?vv)

l+ 1
2

m,n?1 + O(?v3) , (4.28)

?lm,n+2 + ?
l+1
m,n+2 = 2?

l+ 1
2

m,n+2 +
?v2

4
(?vv)

l+ 1
2

m,n+2 + O(?v3) . (4.29)

Assim, podemos expandir os novos termos acima em série de Taylor em z em torno de

z = zn+1/2 e novamente trabalhar aos pares. Por comodidade, vamos negligenciar os índices

nas novas expressões pois todas são feitas no ponto (xm, zn+1/2, vl+1/2). Para (4.26) e (4.27),

temos

??lm,n+1 ? ?l+1m,n+1 = ?2
[

? +
?z

2
?z +

?z2

8
?zz +

?z3

48
?zzz +

?z4

384

?4?

?z4
+ O(?z5)

]

?
?v2

4

[

?vv +
?z

2

?3?

?v2?z
+

?z2

8

?4?

?v2?z2
+

?z3

48

?5?

?v2?z3
+

?z4

384

?6?

?v2?z4

+O(?z5)
]

+ O(?v3) ,

??lm,n ? ?l+1m,n = ?2
[

? ? ?z
2

?z +
?z2

8
?zz ?

?z3

48
?zzz +

?z4

384

?4?

?z4
+ O(?z5)

]

??v
2

4

[

?vv ?
?z

2

?3?

?v2?z
+

?z2

8

?4?

?v2?z2
? ?z

3

48

?5?

?v2?z3
+

?z4

384

?6?

?v2?z4

+O(?z5)
]

+ O(?v3) .

Agora, somando as expressões acima, temos

??lm,n+1 ? ?l+1m,n+1 ? ?lm,n ? ?l+1m,n = ?4? ?
?z2

2
?zz ?

?z4

96

?4?

?z4
? ?v

2

2
?vv

??v
2?z2

16

?4?

?v2?z2
? ?v

2?z4

768

?6?

?v2?z4
+ O(?z5) + O(?v3) . (4.30)

Similarmente, para as equações (4.28) e (4.29), chegamos em

?lm,n?1 + ?
l+1
m,n?1 = 2

[

? ? 3?z
2

?z +
9?z2

8
?zz ?

9?z3

16
?zzz +

27?z4

128

?4?

?z4
+ O(?z5)

]



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 35

+
?v2

4

[

?vv ?
3?z

2

?3?

?v2?z
+

9?z2

8

?4?

?v2?z2
? 9?z

3

16

?5?

?v2?z3

+
27?z4

128

?6?

?v2?z4
+ O(?z5)

]

+ O(?v3) ,

?lm,n+2 + ?
l+1
m,n+2 = 2

[

? +
3?z

2
?z +

9?z2

8
?zz +

9?z3

16
?zzz +

27?z4

128

?4?

?z4
+ O(?z5)

]

+
?v2

4

[

?vv +
3?z

2

?3?

?v2?z
+

9?z2

8

?4?

?v2?z2
+

9?z3

16

?5?

?v2?z3

+
27?z4

128

?6?

?v2?z4
+ O(?z5)

]

+ O(?v3) .

Logo, a soma das duas expressões acima é

?lm,n?1 + ?
l+1
m,n?1 + ?

l
m,n+2 + ?

l+1
m,n+2 = 4? +

9?z2

2
?zz +

27?z4

32

?4?

?z4
+

?v2

2
?vv

+
9?v2?z2

16

?4?

?v2?z2
+

27?v2?z4

256

?6?

?v2?z4

+O(?z5) + O(?v3) . (4.31)

Portanto, somando as equações (4.30) e (4.31), temos

??lm,n+1 ? ?l+1m,n+1 ? ?lm,n ? ?l+1m,n + ?lm,n?1 + ?l+1m,n?1 + ?lm,n+2 + ?l+1m,n+2 =

4?z2?zz +
5?z4

6

?4?

?z4
+

?v2?z2

2

?4?

?v2?z2
+

5?v2?z4

48

?6?

?v2?z4
+ O(?z5) + O(?v3)

= 4?z2?zz + O(?z4) + O(?v2?z2) + O(?v3) .

Observamos, novamente, que o termo de ordem ?v3 nessa expansão também é multiplicado

por ?z2 se considerarmos mais termos.

Voltando para a equação (4.25), temos

L?zz? = ?zz +
5?z2

24

?4?

?z4
+

?v2

8

?4?

?v2?z2
+

5?v2?z2

192

?6?

?v2?z4
+ O(?z3) + O(?v3) ,

= ?zz + O(?z2) + O(?v2) . (4.32)

Por fim, consideramos a expressão dada pela equação (4.6), junto com a expressão (4.7), e

aplicamos o operador L?vz a uma função suave ?, ou seja,

L?vz? =
2vl + ?v

(2zn + ?z)?z?v

[

?l+1m,n+1 ? ?lm,n+1 ? ?l+1m,n + ?lm,n
]

. (4.33)



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 36

Para esta expressão, também fazemos a expansão em séries de Taylor em cada um dos seus

quatro termos, primeiramente em torno de v = vl+1/2, trabalhando ainda aos pares dos termos

da equação (4.33). Inicialmente, expandimos o primeiro e o segundo termo de (4.33)

?l+1m,n+1 = ?
l+ 1

2

m,n+1 +
?v

2
(?v)

l+ 1
2

m,n+1 +
?v2

8
(?vv)

l+ 1
2

m,n+1 +
?v3

48
(?vvv)

l+ 1
2

m,n+1

+
?v4

384

(

?4?

?v4

)l+ 1
2

m,n+1

+ O(?v5) ,

??lm,n+1 = ??
l+ 1

2

m,n+1 +
?v

2
(?v)

l+ 1
2

m,n+1 ?
?v2

8
(?vv)

l+ 1
2

m,n+1 +
?v3

48
(?vvv)

l+ 1
2

m,n+1

??v
4

384

(

?4?

?v4

)l+ 1
2

m,n+1

+ O(?v5) .

Agora, somando estas duas igualdades, temos

?l+1m,n+1 ? ?lm,n+1 = ?v(?v)
l+ 1

2

m,n+1 +
?v3

24
(?vvv)

l+ 1
2

m,n+1 + O(?v5) . (4.34)

Similarmente, temos para os dois últimos termos da equação (4.33)

??l+1m,n + ?lm,n = ??v(?v)
l+ 1

2
m,n ?

?v3

24
(?vvv)

l+ 1
2

m,n + O(?v5) . (4.35)

Agora, expandimos as equações (4.34) e (4.35), em torno de zn+1/2, e obtemos

?l+1m,n+1 ? ?lm,n+1 = ?v
[

?v +
?z

2
?vz +

?z2

8

?3?

?v?z2
+

?z3

48

?4?

?v?z3
+

?z4

384

?5?

?v?z4

+O(?z5)
]

+
?v3

24

[

?vvv +
?z

2

?4?

?v3?z
+

?z2

8

?5?

?v3?z2
+

?z3

48

?6?

?v3?z3

+
?z4

384

?7?

?v3?z4
+ O(?z5)

]

+ O(?v5) ,

??l+1m,n + ?lm,n = ??v
[

?v ?
?z

2
?vz +

?z2

8

?3?

?v?z2
? ?z

3

48

?4?

?v?z3
+

?z4

384

?5?

?v?z4

+O(?z5)
]

? ?v
3

24

[

?vvv ?
?z

2

?4?

?v3?z
+

?z2

8

?5?

?v3?z2
? ?z

3

48

?6?

?v3?z3

+
?z4

384

?7?

?v3?z4
+ O(?z5)

]

+ O(?v5) ,

os quais, quando somamos, fornecem

?l+1m,n+1 ? ?lm,n+1 ? ?l+1m,n + ?lm,n = ?v?z?vz +
?v?z3

24

?4?

?v?z3
+

?v3?z

24

?4?

?v3?z



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 37

+
?v3?z3

576

?6?

?v3?z3
+ O(?z5) + O(?v5)

= ?v?z?vz + O(?v?z3) + O(?v3?z) . (4.36)

Novamente, observamos que os termos representados por O(?z5) e O(?v5), se expandidos,
são multiplicados por ?v e ?z, respectivamente.

Portanto, voltando para a equação (4.33), chegamos em

L?vz? =
2vl + ?v

2zn + ?z

[

?vz +
?z2

24

?4?

?v?z3
+

?v2

24

?4?

?zv ?3
+

?v2?z2

576

?6?

?v3?z3

+O(?z4) + O(?v4)
]

, (4.37)

=
2vl + ?v

2zn + ?z
?vz + O(?v2) + O(?z2) .

(4.38)

De acordo com a equação (4.12), concluímos que o esquema centrado no centro da célula é

consistente de ordem 2 em x, z e v com a equação diferencial parcial da onda imagem, ou seja,

L? ? L?? = ?xx + ?zz +
v

z
?vz ?

{

?xx +
?x2

12

?4?

?x4
+

?z2

8

?4?

?z2?x2
+

?z2?x2

96

?6?

?z2?x4

+
?v2

8

?4?

?v2?x2
+

?v2?x2

96

?6?

?v2?x4
+

?v2?z2

64

?6?

?v2?z2?x2

+
?v2?z2?x2

768

?8?

?v2?z2?x4
+ ?zz +

5?z2

24

?4?

?z4
+

?v2

8

?4?

?v2?z2

+
5?v2?z2

192

?6?

?v2?z4
+

2vl + ?v

2zn + ?z

[

?vz +
?z2

24

?4?

?v?z3
+

?v2

24

?4?

?zv?3

+
?v2?z2

576

?6?

?v3?z3

]

+ O(?x3) + O(?z3) + O(?v3)
}

= O(?x2) + O(?z2) + O(?v2) ?? 0 ,

quando ?x, ?z, ?v ? 0 .

4.2.3 Estabilidade

Baseado no critério de estabilidade de von Neumann (Strikwerda, 1989; Thomas, 1995),

podemos verificar a estabilidade do esquema centrado no centro da célula estudado nesta seção,



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 38

i.e., substituimos na equação discretizada (4.11) a seguinte expressão

plm,n = ?
leimkx?xeinkz?z, (4.39)

onde kx e kz são as freqüências espaciais (i.e., números de ondas) em x e z, respectivamente, e

? é chamado de fator de amplificação. Depois verificamos se a condição

|?| ? 1 (4.40)

é satisfeita. Se esta desigualdade for verdadeira dizemos que o esquema de DF é estável.

Consideremos inicialmente o lado esquerdo (LE) da equação (4.11). Quando substituímos

a expressão de (4.39) em cada um dos seus termos e dividimos por esta mesma expressão,

obtemos

LE ? ?
[

?e?i?z + ?e?i?x + µln + ?e
i?x + ?e?i?x ei?z + ?lne

i?z + ?ei?x ei?z + ?ei2?z
]

,

onde µln = ?kln ? 2? ? ?, ?ln = kln ? 2? ? ? e kln é o dado pela equação (4.9). Logo,

LE = ?
[

?e?i?z + ?e?i?x ? kln ? 2? ? ? + ?ei?x + ?e?i?xei?z + klnei?z ? 2?ei?z ? ?ei?z

+?ei?x ei?z + ?ei2?z
]

= ?
[

??(ei?z ? e?i?z ) + ?(ei?x + e?i?x ) + ?ei?z (ei?x + e?i?x ) + kln(ei?z ? 1)

?2?(ei?z + 1) + ?(ei2?z ? 1)
]

= ?
[

??2i sin ?z + 2? cos ?x(ei?z + 1) ? 2?(ei?z + 1) + kln(ei?z ? 1) + ?(ei2?z ? 1)
]

= ?
[

??2i sin ?z + 2?(ei?z + 1)(cos ?x ? 1) + kln(ei?z ? 1) + ?(ei2?z ? 1)
]

.

Daí, separando a parte real da parte imaginária, temos

LE ? ?
[

2?(cos ?x ? 1)(cos ?z + 1) + kln(cos ?z ? 1) + ?(cos 2?z ? 1)
]

+i
{

[kln ? 2? + 2?(cos ?x ? 1)] sin ?z + ? sin 2?z
}

.

Trabalhamos agora com as partes real e imaginária separadamente. Usamos as seguintes re-

lações trigonométricas

cos ? = 1 ? 2 sin2
?

2
,



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 39

sin ? = 2 sin
?

2
cos

?

2
,

sin2 ? = 4 sin2
?

2
? 4 sin4 ?

2
= 4 sin2

?

2

(

1 ? sin2 ?
2

)

,

e obtemos

r1 ? Re(LE) = 2?
(

?2 sin2 ?x
2

)(

2 ? 2 sin2 ?z
2

)

+ kln

(

?2 sin2 ?z
2

)

+ ?
(

?2 sin2 ?z
)

= ?8? sin2
?x
2

(

1 ? sin2
?z
2

)

? 2kln sin2
?z
2
? 8? sin2

?z
2

(

1 ? sin2
?z
2

)

= ?8? sin2 ?x
2

+ 8 sin2
?z
2

[

? sin2
?x
2

? k
l
n

4
? ?

(

1 ? sin2 ?z
2

)]

(4.41)

e

r2 ? Im(LE) =
[

kln ? 2? + 2?
(

?2 sin2 ?x
2

)]

2 sin
?z
2

cos
?z
2

+ 2? sin ?z cos ?z

= 2

[

kln ? 2? ? 4? sin2
?x
2

]

sin
?z
2

cos
?z
2

+ 4? sin
?z
2

cos
?z
2

(

1 ? 2 sin2
?z
2

)

= 2

[

kln ? 4? sin2
?x
2

]

sin
?z
2

cos
?z
2
? 8? sin2 ?z

2
sin

?z
2

cos
?z
2

= 8

[

kln
4

? ? sin2 ?x
2

? ? sin2 ?z
2

]

sin
?z
2

cos
?z
2

. (4.42)

Para o lado direito (LD) da equação (4.11) as contas são muito similares. Vejamos os cál-

culos para este caso

LD ? ?
[

?e?i?z + ?e?i?x + kln ? 2? ? ? + ?ei?x + ?e?i?x ei?z ? klnei?z ? 2?ei?z ? ?ei?z

+?ei?xei?z + ?ei2?z
]

= ?
[

??2i sin ?z + 2?(cos ?x ? 1)(ei?z + 1) ? kln(ei?z ? 1) + ?(ei2?z ? 1)
]

,

que, separando a parte real da parte imaginária, fornece

LD = ?
{[

2?(cos ?x ? 1)(cos ?z + 1) ? kln(cos ?z ? 1) + ?(cos 2?z ? 1)
]

+i
{

[?kln ? 2? + 2?(cos ?x ? 1)] sin ?z + ? sin 2?z
}}

.

Utilizando as relações trigonométricas vistas anteriormente, chegamos nas seguintes expressões

para as partes real e imaginária do lado direito de (4.11)

s1 ? Re(LD) = ?
{

?8? sin2 ?x
2

+ 8 sin2
?z
2

[

? sin2
?x
2

+
kln
4

? ?
(

1 ? sin2 ?z
2

)]}

(4.43)



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 40

e

s2 ? Im(LD) = ?
{

8

[

?k
l
n

4
? ? sin2 ?x

2
? ? sin2 ?z

2

]

sin
?z
2

cos
?z
2

}

. (4.44)

Portanto, podemos expressar ? da seguinte forma

? =
s1 + is2
r1 + ir2

, (4.45)

onde, usando a notação ?x = sin2 ?x2 e ?z = sin
2 ?z

2
, temos

? = ?
???x + ?z

[

??x +
kln
4
? ? (1 ? ?z)

]

+ i
[

?k
l
n

4
? ??x ? ??z

]

sin ?z
2

cos ?z
2

???x + ?z
[

??x ? k
l
n

4
? ? (1 ? ?z)

]

+ i
[

kln
4
? ??x ? ??z

]

sin ?z
2

cos ?z
2

= ?
???x/?z +

[

??x +
kln
4
? ? (1 ? ?z)

]

+ i
[

?k
l
n

4
? ??x ? ??z

]

cot ?z
2

???x/?z +
[

??x ? k
l
n

4
? ? (1 ? ?z)

]

+ i
[

kln
4
? ??x ? ??z

]

cot ?z
2

. (4.46)

Logo,

|?|2 =
[

???x/?z + ??x + k
l
n

4
? ?(1 ? ?z)

]2
+
[(

?k
l
n

4
? ??x ? ??z

)

cot ?z
2

]2

[

???x/?z + ??x ? k
l
n

4
? ?(1 ? ?z)

]2
+
[(

kln
4
? ??x ? ??z

)

cot ?z
2

]2
.

Agora, seja a = ???x ? ??z . Observando que (1/?z ? 1) = cot2 ?z/2, temos

|?|2 =
[

???x/?z ? ? + ??x + ??z + k
l
n

4

]2
+
[(

?k
l
n

4
? ??x ? ??z

)

cot ?z
2

]2

[

???x/?z ? ? + ??x + ??z ? k
l
n

4

]2
+
[(

kln
4
? ??x ? ??z

)

cot ?z
2

]2

=

[

a/?z ? a + k
l
n

4

]2
+
[(

a ? k
l
n

4

)

cot ?z
2

]2

[

a/?z ? a ? k
l
n

4

]2
+
[(

a +
kln
4

)

cot ?z
2

]2

=

[

a(1/?z ? 1) + k
l
n

4

]2
+
[(

a ? k
l
n

4

)

cot ?z
2

]2

[

a(1/?z ? 1) ? k
l
n

4

]2
+
[(

a +
kln
4

)

cot ?z
2

]2

=

[

a cot2 ?z
2

+
kln
4

]2
+
[(

a ? k
l
n

4

)

cot ?z
2

]2

[

a cot2 ?z
2
? kln

4

]2
+
[(

a +
kln
4

)

cot ?z
2

]2

=
a2 cot4 ?z

2
+ 2a

kln
4

cot2 ?z
2

+
(

kln
4

)2
+ a2 cot2 ?z

2
? 2a k

l
n

4
cot2 ?z

2
+
(

kln
4

)2
cot2 ?z

2

a2 cot4 ?z
2
? 2a kln

4
cot2 ?z

2
+
(

kln
4

)2
+ a2 cot2 ?z

2
+ 2a

kln
4

cot2 ?z
2

+
(

kln
4

)2
cot2 ?z

2

=
a2 cot4 ?z

2
+
(

kln
4

)2
+ a2 cot2 ?z

2
+
(

kln
4

)2
cot2 ?z

2

a2 cot4 ?z
2

+
(

kln
4

)2
+ a2 cot2 ?z

2
+
(

kln
4

)2
cot2 ?z

2

= 1 .



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 41

Ou seja, o esquema é incondicionalmente estável.

O fato deste esquema ser incondicionamente estável é de extrema importância pois nos diz

que a convergência do método é independente do tamanho do passo dado na velocidade de

propagação. Também, que podemos usar este esquema tanto para crescer como decrescer na

velocidade.

É importante observar neste contexto que, o fato do esquema ser incondicionalmente es-

tável não implica que um passo ?v, de tamanho arbitrário, possa ser usado na sua realização

numérica. O tamanho do passo ?v ainda tem influência na qualidade da aproximação realizada,

mesmo o esquema sendo estável. Um efeito que pode degradar a qualidade da aproximação nu-

mérica em função do tamanho do passo ?v é a dispersão numérica dos esquemas, apresentada

na próxima seção.

4.2.4 Dispersão

Primeiramente, estudamos o efeito de dispersão no exemplo da propagação de uma onda no

tempo. Ou seja, na propagação sem dispersão é de se esperar que um pulso de onda deslocado

para (x1, z1), no tempo t1, tenha as mesmas propriedades que possuía na sua posição original

(x0, z0), no tempo t0. É de nosso interesse que a onda imagem se comporte desta maneira

quando propagada por meio de um esquema numérico. Assim, como mencionado anterior-

mente, é de se esperar que um pulso de onda f (x, z, t) no tempo t0 e no tempo t1 = t0+?t sejam

iguais, a não ser pelo seu deslocamento. Com isso esperamos que f (x0, z0, t0) = f (x1, z1, t1).

É conhecido que podemos obter a transformada de Fourier no domínio das freqüências

espaciais para cada uma das funções acima. As suas inversas são dadas por

f (x0, z0, t0) =

(

1?
2?

)2
?

?

??

?

?

??

f? (kx, kz, t0)e
ikxx0 eikzz0 dkxdkz

e

f (x1, z1, t1) =

(

1?
2?

)2
?

?

??

?

?

??

f? (kx, kz, t1)e
ikxx1eikz z1 dkxdkz ,

(4.47)

onde supomos que a função f satisfaça todas as condições necessárias para que estas transfor-

madas existam.



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 42

x (x  ,z  )

(x  ,z  )0 0

11

x

?

?

zd

?

z

?

Figura 4.2: Visualização da distância de propagação.

Como queremos a igualdade das funções e sabemos que a transformação de Fourier é única,

concluímos que os argumentos da integrais devem ser iguais, isto é,

f? (kx, kz, t0)e
ikxx0 eikzz0 = f? (kx, kz, t1)e

ikxx1eikz z1 , (4.48)

de onde, com t1 = t0 + ?t, x1 = x0 + ?x e z1 = z0 + ?z, temos que

f? (kx, kz, t0 + ?t) = e
?i(kx?x+kz?z)f? (kx, kz, t0) . (4.49)

Para uma melhor compreensão deste resultado, mostramos a expressão acima de uma forma

diferente. Consideramos, então d o deslocamento que o pulso de onda teve do tempo t0 para t1,

assim temos

d =
?

(?x)2 + (?z)2 = a?t , (4.50)

onde a é a velocidade de progagação da onda.

Da Figura 4.2, temos

d = ?x cos ? + ?z sin ? , (4.51)

do qual, ao considerarmos kx = k cos ? e kz = k sin ?, isto é, k2 = k2x + k2z , chegamos em

kx?x + kz?z = k(?x cos ? + ?z sin ?) = kd = ka?t . (4.52)



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 43

Logo, da equação (4.49),

f? (kx, kz, t0 + ?t) = e
?ika?tf? (kx, kz, t0) . (4.53)

Portanto, queremos que um esquema de diferenças finitas realize esta propagação no tempo,

isto é, multiplique a transformada de Fourier do campo de onda a cada passo por um fator de

multiplicação igual a e?ika?t. Ou, em tradução ao nosso problema, queremos que um esquema

de diferenças finitas da equação da onda imagem multiplique a transformada de Fourier do

campo de onda a cada passo por eika?v , onde a é a velocidade de propagação a ser realizada

pela equação da onda imagem. Em outras palavras, queremos que

p?(kx, kz, v + ?v) = e
?ika?vp?(kx, kz, v) . (4.54)

Mas isso quase nunca acontece, pois sempre há perda de energia na propagação da onda ou as

velocidades de ondas de diferentes freqüências são distintas, quando propagadas pelo esquema

de diferenças finitas.

O que pretendemos então é determinar quão boa é a aproximação para o termo e?ika?v que

o esquema de DF realiza. Para isso, consideramos um passo no esquema de diferenças finitas

no domínio das freqüências espaciais kx e kz. Temos que o esquema realiza o cálculo de p?n+1 a

partir de p?n. Em símbolos,

p?n+1 = ?(kx?x, kz?z)p?
n , (4.55)

onde ? é o chamado fator de amplificação do esquema.

Comparamos a equação (4.55) com a equação (4.53) para enfatizarmos suas similaridades.

Para tal, escrevemos ? como

?(kx?x, kz?z) = |?(kx?x, kz?z)| e?ikc?v , (4.56)

onde c é função de ?x e ?z, bem como kx e kz , e é chamada de velocidade de fase realizada

pelo esquema. Observamos, pela comparação das equações (4.53) e (4.55), que um esquema

ideal seria aquele que realizasse a propagação com |?| = 1 e c = a.



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 44

Em outras palavras, se c(?x, ?z, kx, kz) for igual a a para todos kx e kz, então ondas propa-

gariam com a velocidade correta e sem dispersão numérica, mas isto não acontece para quase

nenhum esquema de diferenças finitas para equações diferenciais hiperbólicas exceto em casos

triviais. O fenômeno de ondas de diferentes freqüências propagando com diferentes velocidades

do que corresponderia à equação diferencial é chamada de dispersão numérica.

Para estudar a dispersão numérica, precisamos encontrar a função c(?x, ?z, kx, kz) que

aproxima a velocidade de propagação a da equação da onda imagem. Para isso, usamos o já

encontrado fator de amplificação ? dado pela equação (4.45), onde aqui o representamos por

? =
s1 + is2
r1 + ir2

=
(s1r1 + s2r2)

r21 + r
2
2

+ i
(s2r1 ? s1r2)

r21 + r
2
2

, (4.57)

onde r1, r2, s1 e s2, são dados pelas equações (4.41), (4.42), (4.43) e (4.44), respectivamente.

Logo, para determinar a velocidade de fase, escrevemos

? = |?|e?ikc?v, (4.58)

onde a velocidade de fase c é função de ?x e ?z, bem como kx e kz .

Por análise de números complexos temos que o argumento da exponencial é dado pelo arco-

tangente da parte imaginária dividida pela parte real, isto é,

arg ? = ?kc?v = arctan
(

s2r1 ? s1r2
s1r1 + s2r2

)

. (4.59)

Para encontrarmos uma aproximação interpretável para a velocidade de fase c(?x, ?z, kx, kz),

desenvolvemos a equação (4.59) em séries de Taylor de quarta ordem em ?v e de terceira nos

incrementos espaciais ?x e ?z usando o software Mathematica e depois dividimos o resultado

por ?k?v. Assim, encontramos

c ? kzn
kzvl

? k
5z3n?v

2

12k3z v
3
l

? k
4
xzn?x

2

12kzvlk
? kz(k

2
x + 2k

2
z )zn?z

2

12vlk

+
[k4x?x

2 + k2z (k
2
x + 2k

2
z )?z

2] k3z3n?v
2

48k3z v
3
l

+ O(?v4) + O(?x3) + O(?z3) , (4.60)

onde k2 = k2x + k2z . Observa-se que o efeito da dispersão é maior para as freqüências mais altas,

ou seja, quanto maior o valor de k maior a dispersão deste esquema.



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 45

Na aproximação para c, o primeiro termo não depende de ?z e ?v. Este representa a

velocidade de fase realizada pela própria equação da onda imagem. Observa-se, ainda, que este

termo depende de k e kz , isto é, a própria equação diferencial causa dispersão na propagação

da onda imagem. Este efeito não pode ser reduzido pela escolha dos valores de ?z e ?v

convenientes.

Os demais termos dependem dos incrementos em x, z, e v e descrevem a dispersão numé-

rica. Uma vez que estes termos dependem não só de kx, kz e k, mas também de zn e vl, não

é possível reduzir a dispersão numérica em todo o domínio por uma escolha inteligente de ?v

em função de ?x e ?z.

Como não podemos reduzir o efeito da dispersão com uma escolha inteligente dos incre-

mentos em x, z, e v, fazemos uma análise da equação (4.60) de maneira a tentar avaliar seus

efeitos na solução numérica. Primeiramente, observamos que os três termos com sinal negativo

são os termos que mais influenciam para a dispersão numérica, já que o último termo, que é

positivo, é de ordem maior. Desta forma, tentamos encontrar condições sobre ?x, ?z e ?v que

reduzam ao máximo a influência destes termos sobre a velocidade de fase c da equação da onda

imagem. Para isso, fazemos com que cada um desses termos seja muito menor que o primeiro

termo que é a velocidade de fase realizada pela própria equação. Assim, chegamos à condição

que os incrementos em x, z e v devem satisfazer

?v ?
?

12 kzvl
k2zn

, ?x ?
?

12 k

k2x
e ?z ?

?
12 k

kz
?

k2x + 2k
2
z

. (4.61)

Portanto, concluímos que, para o esquema avaliado no centro da célula, a escolha dos in-

crementos espaciais é muito importante como critério para reduzir a dispersão numérica, apesar

deste esquema ser incondicionalmente estável.

Para fins práticos, analizamos considerações que podem ser feitas em relação as freqüências

espaciais. Inicialmente, consideramos kx ? kz, ou seja, podemos negligenciar kx na equação
(4.60), chegando em

c ? zn
vl

? k
2
z ?v

2z3n
12v3l

? k
2
z ?z

2zn
6vl

+
k4z ?z

2?v2z3n
24v3l

. (4.62)



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 46

Logo, ao observamos os três últimos termos da equação acima, concluímos que a velocidade de

propagação é reduzida quando os dados iniciais possuem maior quantidade de altas freqüências,

já que o último termo, apesar de positivo, possui ordem em ?z e ?v maior que nos termos

negativos. Portanto, a dispersão deste esquema possui uma forte dependência nos números de

onda, ou seja, quanto maior a quantidade de altas freqüências, para este esquema, mais lenta a

propagação da respectiva onda e, conseqüentemente, maior a dispersão numérica.

Outra consideração feita é quando kx ? kz, onde chegamos em

c ?
?

2
zn
vl

?
?

2
k2z ?v

2z3n
3v3l

?
?

2
k2z ?x

2zn
24vl

?
?

2
k2z ?z

2zn
8vl

+
?

2
k4z ?x

2?v2z3n
24v3l

+
?

2
k4z ?z

2?v2z3n
8v3l

, (4.63)

onde podemos ver que a argumentação para este caso é similar ao caso anterior pois somente

subtraímos um termo com o fator ?x2 e somamos outro menor com o fator ?x2?v3 em relação

ao caso anterior, mesmo tento o fator
?

2 nos termos. Em outras palavras, mesmo para dados

com os números de freqüências proporcionais na horizontal e na vertical o esquema considerado

é dispersivo e sua dependência da freqüência é, ainda, muito forte.

4.2.5 Dissipação

Quando o fator de amplificação de um esquema tem um módulo menor que um (veja

equação (4.56)), perde-se amplitude do campo propagado a cada passo. Neste caso, fala-se

de dissipação numérica.

Na Seção 4.2.3, observamos que, para o esquema em questão, |?| = 1. Portanto, o esquema
(4.11) não apresenta dissipação. Observa-se, porém, que a sua realização computacional pode,

por erro numérico, possuir um ? com módulo diferente de 1. Se este ? numérico tiver um módulo

menor que 1, temos uma pequena dissipação. Por outro lado, caso que o ? numérico possuir

um módulo maior do que 1, a realização computacional do esquema apresenta instabilidades

numéricas.



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 47

4.2.6 Implementação

Como notado anteriormente, o esquema avaliado no centro da célula, representado pela

equação (4.11), só pode ser implementado implicitamente.

Para implementar um esquema de DF implícito se faz necessário encontrar as matrizes de

iteração para que possamos estabelecer um sistema linear que será resolvido em cada iteração

do algoritmo.

A partir do esquema discretizado (4.11), montamos as matrizes de iteração para resolver o

problema de propagar a equação da onda imagem. Porém, mediante observações anteriores,

resolvemos montar as matrizes de iteração fixando z e variando x , como é comumente feito em

problemas geofísicos. Com isso, conseguimos montar um sistema linear que pode ser escrito

da seguinte forma

AlU l+1 = BlU l . (4.64)

As estruturas das matrizes Al e Bl e do vetor U l estão mostradas no Apêndice D.

Logo, o algoritmo se resume em resolver o sistema linear acima a partir de um dado de

entrada U 0, que é fornecido previamente e que consiste de uma seção sísmica migrada com

uma velocidade a princípio incorreta.

Um dos problemas encontrados para resolver o sistema linear acima, foi o fato de que as

matrizes de iteração dependem da velocidade de propagação. Assim, é necessário que estas

matrizes sejam atualizadas a cada iteração do algoritmo já que este é feito em função da veloci-

dade de propagação, por motivos de definição da equação da onda imagem. Logo, quanto maior

forem as dimensões do problema, torna-se mais difícil a resolução do sistema linear (4.64), pois

as matrizes Al e Bl, apesar de esparsas (ver Apêndice D), possuirão dimensões ainda maiores.

Por exemplo, para o caso de uma matriz de dados iniciais com dimensão 600 × 160, as matrizes
Al e Bl terão dimensão dada por 96160×96160, pois quando montamos essas matrizes de itera-
ção não conseguimos separá-las por bloco. Portanto, o trabalho computacional deste algoritmo

é alto porque as dimensões das matrizes são, em geral, muito grande.

Uma alternativa ao problema discutido acima, foi utilizar uma mudança de variável já estu-



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 48

dada em Munerato (2003), ? = ln (v/v0). Através desta mudança conseguimos fazer com que

a equação da onda imagem (1.1) não possua mais a velocidade de propagação v multiplicando

o fator da derivada mista, como pode ser visto a seguir

pxx + pzz +
1

z
p?z = 0 , (4.65)

pois, quando fazemos a mudança de variável ? = ln (v/v0), obtemos

v

z
pzv =

v

z

?pz
?v

=
v

z

?pz
??

??

?v
=

v

z

1

v

?pz
??

=
1

z
p?z .

onde ??/?v = 1/v.

Mediante esta mudança de variável e a nova equação para a onda imagem (4.65), con-

seguimos evitar o problema de ter que atualizar a matriz de iteração a cada iteração do algoritmo.

Isto foi um ganho substancial na implementação deste esquema pois o custo computacional foi

bastante reduzido (ver Seção 5.5).

Esta mudança de variável também foi útil no sentido de diminuir o número de iterações que

o algoritmo precisava executar sem tal mudança pois, se consideramos nv e n? o número de

passos de v e ?, respectivamente, obtemos

nv =
vmax ? vmin

?v
, n? =

?max ? ?min
??

. (4.66)

Agora, se consideramos, por exemplo, ?? = ?v/vmin, ou seja, uma relação onde ?? seja

menor que ?v, obtemos os seguintes cálculos

n? =
?max ? ?min

??
=

ln (vmax/v0) ? ln (vmin/v0)
?v/vmin

=

?

?

ln vmax
vmin

vmax
vmin

? 1

?

? nv , (4.67)

que é menor que nv sempre que vmax &gt; vmin (veja Figura 4.3). Logo podemos concluir que

para este caso, ? = ln (v/v0), temos sempre menos passos que para v, isto quer dizer que

quando fazemos esta mudança de variável estamos tendo vantagem no ponto de vista de tempo

computacional. Outras mudanças podem ser feitas, porém, não são todas que possuem esta

vantagem, como pode ser visto na Figura 4.3.

Portanto, toda a implementação feita para este esquema foi baseada na mudança de va-

riável ? = ln (v/v0). Assim, as matrizes mostradas no Apêndice D são agora independentes



CAPÍTULO 4. ESQUEMAS DE DIFERENÇAS FINITAS IMPLÍCITOS 49

2 3 4 5 6 7 8 9 10
0

1

2

3

4

5

6

v
max

/v
min

n
?,

?
,?
 /
 n

v
? = v2 

v 

? = ln(v/v
0
) 

? = v1/2 

Figura 4.3: Gráfico da relação entre o número de passos das mudanças de variável em função

da razão entre a maior e a menor velocidade.

da velocidade de propagação, pois ao invés da variável kln aparece no esquema em ? o fator

correspondente,

kn =
8

(2zn + ?z)?z??
, (4.68)

e conseqüentemente, µn = ?kn ? 2? ? ? e ?n = kn ? 2? ? ?.
Como pode ser visto no Apêndice E, tal mudança de variável não altera as propriedades de

consistência, estabilidade e dispersão da equação da onda imagem feitas anteriormente.

Os testes numéricos para este esquema estão descritos no Capítulo 5.



Capítulo 5

Experimentos numéricos

Esta seção tem como objetivo comparar os resultados numéricos entre os métodos já estu-

dados anteriormente (Schleicher et al., 2004a,b) e os métodos propostos neste trabalho para a

solução numérica da equação da onda imagem (1.1).

Exemplos para a propagação da imagem de refletores (planos, inclinados e em meios ino-

mogêneos) pelo método de DF foram apresentados em Schleicher et al. (2004a), assim como

uma análise dos efeitos da propagação quando refinamos a malha em z, pois, pelo desenvolvi-

mento teórico, constatou-se que os efeitos de dispersão e dissipação têm forte dependência dos

números de onda e do tamanho da malha.

5.1 Refletor plano

Para tornar os estudos numéricos mais simples, foi simulado um experimento sísmico como

descrito em Schleicher et al. (2004a,b), i.e., utilizamos um modelo simples com um refletor

plano horizontal localizado em 550 m de profundidade com dados registrados por um experi-

mento de afastamento nulo com 401 pares de fonte-receptor localizados a cada 10 m na região

entre ?2000 m e 2000 m na direção x, como ilustrado na Figura 5.1. Os dados na direção z
foram simulados entre 10 m e 1600 m, com ?z = 10 m. A velocidade de propagação vc no

meio, supostamente homogêneo, é de vc = 3000 m/s. Os dados de entrada para a remigração,

50



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 51

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

Distância (m)

P
ro

fu
n

d
id

d
a

d
e

 (
m

)

Figura 5.1: Modelo de afastamento nulo para refletor plano horizontal.

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a) 

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(b) 

Figura 5.2: Seções migradas na profundidade com velocidade de migração (a) v = 2000 m/s e

(b) v = 4000 m/s.

neste caso de refletor plano, foram obtidos pela migração na profundidade dos dados de afas-

tamento nulo com duas velocidades de migração incorretas de v = 2000 m/s (Figura 5.2a) e

de v = 4000 m/s (Figura 5.2b), para que pudessem ser utilizados em testes com velocidade de

migração crescente ou decrescente, respectivamente.

Como podemos observar nestas figuras, o pulso do evento de reflexão na Figura 5.2b é mais

largo do que na Figura 5.2a. Este efeito corresponde ao conhecido estiramento do pulso na

migração, que é proporcional à velocidade de migração (Tygel et al., 1994).

Então, utilizamos as imagens acima para testar a implementação dos métodos estudados

neste trabalho. Com esses dados migrados podemos utilizar incrementos positivos e negativos



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 52

na velocidade, ou seja, para o dado da esquerda (Figura 5.2a) queremos sair de uma velocidade

baixa e aumentar até atingir a velocidade correta, já para o segundo dado (Figura 5.2b) queremos

partir de uma velocidade alta para podermos diminuir a velocidade até atingir a velocidade

correta, que neste caso é menor que a velocidade usada na migração inicial.

5.2 Método de volumes finitos

Esquema avançado em v e z

A seção migrada na profundidade incorretamente com velocidade baixa, Figura 5.2a, foi

então remigrada utilizando para evolução o esquema avançado em v e z. Como condição para

o método de VF, resolvemos a equação (3.1) para a malha finita do modelo descrito acima.

Assim, constatou-se que os dados iniciais para a remigração na profundidade para o método

em questão são simplesmente as médias dos pontos da malha discreta. , Então, esta média foi

feita em todo o domínio. Nos pontos onde não temos informação dos quatro pontos (borda)

fizemos a média utilizando somente dois pontos, ou seja, consideramos os valores nos outros

dois pontos como iguais.

Do estudo teórico para o método de DF deste esquema (Schleicher et al., 2004a,b), sabemos

que este só é condicionalmente estável para passos de velocidade positivos, ?v &gt; 0. Assim,

utilizando um incremento na velocidade que satisfaça a condição de estabilidade, ?v = 2 m/s,

obtemos a Figura 5.3 que representa a propagação da imagem do refletor plano através do

método de DF (esquerda) e do método de VF (direita).

Em virtude dos ruídos que aparecem quando implementamos este esquema na direção cres-

cente em z (Schleicher et al., 2003a, 2004a), ou seja, ruído numérico gerado pelos dados pos-

suirem números de onda maior na horizontal do que na vertical, utilizamos aqui a forma reversa

em z, i.e., implementamos a variável z na direção decrescente. Também foi necessário fazer

as médias em cada iteração em dois sentidos, um contrário ao outro, pois o deslocamento da

média realiza uma propagação maior do que a da própria equação, i.e., se utilizamos somente a

média em um só sentido, esta não permite a convergência do método (Capítulo 2).



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 53

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.3: Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda: Método

de diferenças finitas explícito. Direita: Método de volumes finitos.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 54

As partes (a), (b) e (c) da Figura 5.3 representam imagens intermediárias da propagação

da onda imagem para velocidades v = 2320 m/s, v = 2680 m/s e v = 3000 m/s, respectiva-

mente, a última sendo a velocidade do meio correta. Observamos que a imagem do refletor nas

Figuras 5.3c é remigrada para a profundidade correta de 550 m em ambos os casos.

A observação principal é em relação ao estiramento do pulso que pode ser observado em

ambas as propagações na Figura 5.3. Na propagação do método de DF (esquerda) já sabemos

que o estiramento acontece por dois motivos. O primeiro é o estiramento do pulso convencional

devido a migração na profundidade (Tygel et al., 1994), como observado na Figura 5.2. O

segundo, que causa o estiramento adicional, é a dispersão numérica que foi discutida teórica e

numericamente em Schleicher et al. (2004a).

Na propagação obtida pelo método de VF, Figura 5.3 (direita), observamos que o estira-

mento do pulso é maior ainda do que no método de DF, logo, além dos dois motivos discutidos

anteriormente, existe um terceiro motivo que causa tal estiramento. Este é devido ao fato de

o método de VF fazer a média a cada iteração do algoritmo, ou seja, esta média causa uma

dispersão adicional.

Assim, concluímos que o método de VF não nos ajuda a solucionar o problema com relação

a dispersão causada pelo já estudado método de DF. Em contrapartida, nos incentiva a pensar

em um estudo futuro com relação a uma possível aplicação de um operador “anti-média” para,

ao invés de aumentar, diminuir o estiramento observado no método de DF.

Convém ressaltar que, o método de VF também possui um tempo computacional maior do

que o método de DF pois, adicionalmente ao passo de propagação, necessita fazer as médias a

cada iteração na velocidade, ou seja, o tempo computacional vai aumentar proporcionalmente

ao tamanho da seção sísmica a ser remigrada (ver Tabela 5.1, Seção 5.5).

Esquema avançado em v e atrasado em z

A seção migrada na profundidade incorretamente com velocidade alta, Figura 5.2b, foi então

remigrada utilizando o esquema avançado em v e atrasado em z. Também do estudo teórico para

este esquema (Schleicher et al., 2003a, 2004a), sabemos que este só é condicionalmente estável



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 55

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.4: Imagem do refletor plano remigrado com velocidades: (a) v = 3680 m/s, (b)

v = 3320 m/s e (c) v = 3000 m/s, para o esquema avançado em v e atrasado em z. Esquerda:

Método de diferenças finitas explícito. Direita: Método de volumes finitos.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 56

para passos de velocidade negativos, ?v &amp;lt;0. Assim, utilizando um incremento na velocidade

que satisfaça a condição de estabilidade, ?v = ?1 m/s, obtemos a Figura 5.4 que representa a
propagação da imagem do refletor plano através do método de DF (esquerda) e do método de

VF (direita).

Para este caso avançado em v e atrasado em z, os ruídos não aparecem quando implemen-

tamos o esquema da forma direta e sim, ao contrário do que foi observado para o esquema

avançado em v e z, aparecem na implementação reversa de z (Schleicher et al., 2003a, 2004a).

Portanto, utilizamos aqui a forma direta em z, i.e., implementamos a variável z na forma cres-

cente. Também aqui fizemos as médias em sentido alternado, já que independe do método

utilizado para que a média não introduza uma propagação adicional.

As partes (a), (b) e (c) da Figura 5.4 representam imagens intermediárias da propagação

da onda imagem para velocidades v = 3680 m/s, v = 3320 m/s e v = 3000 m/s, respectiva-

mente, a última sendo a velocidade do meio correta. Observamos que a imagem do refletor nas

Figuras 5.4c também são remigradas para a profundidade correta de 550 m em ambos os casos.

Neste caso, a observação em relação ao estiramento do pulso na propagação é similar ao

discutido para o caso avançado em v e z, ou seja, o método de VF não é útil como forma de

resolver o problema do estiramento causado na propagação do método de DF pois possui um

estiramento ainda maior do que neste método.

5.3 Esquemas implícitos convencionais

Como o método de volumes finitos não ajudou no propósito desta dissertação, que é a re-

dução da dispersão numérica na realização computacional de propagação da onda imagem,

acrescentamos um estudo de esquemas implícitos com a mesma finalidade.

Esquema avançado em v e z

A partir da Figura 5.2a, foi feita a remigração através da equação da onda imagem para o

método de DF implícito na velocidade de migração. Aqui utilizamos também, um passo na



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 57

velocidade que satisfaça a condição de estabilidade observada em Schleicher et al. (2004a),

?v = 2 m/s.

Utilizando a iteração fixando ora a variável x e ora a variável z, obtemos as Figuras 5.5

e 5.6, respectivamente. Estas foram colocadas ao lado da propagação obtida pelo método de DF

explícito (Schleicher et al., 2004a), para que possamos compará-las com os resultados deste.

Como podemos observar na Figura 5.5 (direita), existe uma forte dispersão numérica na

propagação da onda imagem usando esta implementação. Esta dispersão é bem maior do que

a observada na propagação da Figura 5.5 (esquerda), obtida pelo método explícito. Ela não só

estica o pulso, como nos exemplos anteriores, mas faz com que o pulso se desfaça totalmente.

Podemos até ver que as freqüências baixas propagam para cima enquanto as freqüências altas

propagam para baixo. Esta dispersão acontece quando montamos a matriz de iteração fixando

a variável x e variando z.

Quanto à Figura 5.6 (esquerda), observamos que o esquema utilizado propagou a imagem

do refletor à profundidade correta, assim como o método explícito. Esta foi obtida fazendo

a varíavel z ser fixa e x variável na montagem da matriz de iteração do método implícito.

A observação principal para este caso é o fato das imagens serem praticamente idênticas, nas

velocidades correspondentes. Em outras palavras, não há vantagem na implementação implícita

deste esquema, uma vez que resultados iguais podem ser obtidos pela implementação explícita

que é computacionalmente menos custosa (ver Tabela 5.1, Seção 5.5).

5.4 Esquema implícito avaliado no centro da célula

Nesta seção, estudamos numericamente o esquema implícito avaliado no centro da célula

para que pudessemos compará-lo com os outros esquemas citados neste trabalho. Isto se faz

necessário pois procuramos um esquema que, na propagação da onda imagem, não seja tão

dispersivo quanto os esquemas já estudados aqui e em Schleicher et al. (2004a,b).

A grande dificuldade na implementação deste esquema na forma original é o fato de preci-

sarmos atualizar as matrizes de iteração a cada passo do algoritmo. Porém, como foi observado



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 58

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.5: Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda: Método

de diferenças finitas explícito. Direita: Método de diferenças finitas implícito fixando x.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 59

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.6: Imagem do refletor plano remigrado com velocidades: (a) v = 2320 m/s, (b)

v = 2680 m/s e (c) v = 3000 m/s, para o esquema avançado em v e z. Esquerda: Método

de diferenças finitas explícito. Direita: Método de diferenças finitas implícito fixando z.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 60

no Capítulo 4 - Seção 4.2.6, sugerimos uma mudança de variável na equação da onda imagem

tal que esta dificuldade não mais ocorra. Portanto, a equação implementada aqui foi a equação

(4.65), na qual foi feita a mudança de variável ? = ln (v/v0), ou seja, resolvemos o sistema

linear

AU l+1 = BU l

onde A, B e U l têm as formas como mostrado no Apêndice D, só que A e B sem a dependência

em l.

Para o nosso caso, do modelo do refletor plano, utilizamos a seção migrada dada pela Fi-

gura 5.2a para fazermos a remigração da onda imagem pelo método implícito centrado no centro

da célula. Para isso, escolhemos o passo ?? = 0.002 (adimensional). Já que o esquema é in-

condicionalmente estável, a escolha foi aleatória de modo que o número de passos não ficou

muito grande. O resultado desta remigração está ilustrado na Figura 5.7 (direita).

Como podemos observar nesta figura, existe uma forte dispersão quando fazemos a propa-

gação com este esquema em comparação com o já visto esquema explícito avançado em v e z,

Figura 5.7 (esquerda). Isto se deve ao fato dos dados utilizados para a remigração apresentarem

um grande conteúdo de alta freqüência. Observamos, novamente, o efeito de freqüências altas e

baixas propagarem em direções diferentes (agora altas para cima e baixas para baixo). Este re-

sultado coincide com a observação teórica de que a dispersão deste esquema será maior quanto

maiores forem as freqüências espaciais na profundidade, kz.

Vimos na equação (4.60) que o primeiro termo da dispersão numérica depende de ?v2. Para

observar e tentar reduzir o efeito da dispersão deste caso, inicialmente, variamos o tamanho do

passo na velocidade de propagação ?, ou seja, fizemos ?? = 0.04, ?? = 0.005, ?? = 0.001,

?? = 0.0005, ?? = 0.0001 e ?? = 0.00005. Para cada um destes valores de ??, foi

feita a remigração da onda imagem, onde selecionamos, dentre cada propagação, a imagem

correspondente a velocidade correta do meio, v = 3000 m/s, como ilustrado na Figura 5.8.

Nesta, observamos que não há uma redução na dispersão numérica quando variamos o valor

de ??, mesmo tendo uma redução do ?? por um fator de 800. Logo, para esta tentativa

não obtivemos êxito, somente um acréscimo significativo no tempo computacional, o que não



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 61

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.7: Imagem do refletor plano remigrado com velocidades: (a) v ? 2320 m/s, (b)
v ? 2680 m/s e (c) v ? 3000 m/s. Esquerda: Método de diferenças finitas explícito. Direita:
Método de diferenças finitas implícito centrado no centro da célula.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 62

é aconselhável pela similaridade dos resultados. Concluímos que o termo em ?v2 contribui

pouco para a dispersão numérica.

Outra alternativa para reduzir o efeito da dispersão, foi diminuir os incrementos espaciais ao

invés do incremento da velocidade, i.e., utilizamos agora os mesmos dados anteriores, porém

com a migração feita tendo os incrementos espaciais ?x e ?z iguais a 5 m, e não mais 10 m,

como era anteriormente. Na Figura 5.9, podemos ver que há uma redução da dispersão numérica

quando implementamos esta caso, logo, a dispersão deste esquema esta diretamente relacionada

com os incrementos espaciais, ou seja, quanto menor forem esses incrementos menos dispersão

apresentará o esquema. Concluímos que os termos em ?x2 e ?z2 são os responsáveis pela

maior parte da dispersão numérica. Neste caso, é intuitivo fazer os incrementos espaciais cada

vez menor, porém, isto é impraticável computacionalmente, pois temos que resolver sistemas

lineares de grande porte, como discutido teoricamente.

Ainda, para confirmar a conclusão sobre a dispersão numérica, em decorrência do conteúdo

de altas freqüências nos dados a ser propagado, modelamos novos dados reduzindo a quantidade

de altas freqüências, i.e., dados com o pulso duas vezes mais largo. Esta alternativa está de

acordo com o fato observado teoricamente pois, quando usamos o pulso mais largo, estamos

diminuindo as freqüências nos dados, i.e., pulsos estreitos possuem freqüências maiores e assim

aumentam o efeito de dispersão numérica quando utilizamos para a remigração o esquema

centrado no centro da célula. Desta forma, é possível reduzir o efeito dos termos em ?x2 e

?z2, sem ter que reduzir o espaçamento. A Figura 5.10 mostra o novo modelo de dados que

usamos para fazer a remigração.

Esta figura possui as mesmas propriedades da Figura 5.2a, ou seja, a configuração da

aquisição de dados é a mesma, porém, o pulso da fonte é mais largo. Logo, os dados migrados

também possuem mais baixas freqüências. A migração foi feita novamente com a velocidade

incorreta de 2000 m/s.

Assim, a partir dos dados da Figura 5.10, foi feita a remigração utilizando o esquema avali-

ado no centro da célula com incrementos ?z = ?x = 10 m. Como podemos ver na Figura 5.11

(direita) esta propagação não apresenta dispersão numérica muito grande, ao contrário, sua dis-



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 63

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,04

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,001

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,0001

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,005

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,0005

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?? = 0,00005

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Figura 5.8: Imagens do refletor plano, na velocidade correta do meio v = 3000 m/s, para dife-

rentes valores de ??. A remigração foi feita utilizando o método de diferenças finitas implícito

centrado no centro da célula.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 64

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.9: Imagem do refletor plano remigrado pelo método de DF implícito centrado no centro

da célula com velocidades: (a) v ? 2320 m/s, (b) v ? 2680 m/s e (c) v ? 3000 m/s. Esquerda:
incrementos espaciais ?x = ?z = 10 m. Direita: incrementos espaciais ?x = ?z = 5 m.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 65

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Figura 5.10: Seção migrada na profundidade com velocidade v = 2000 m/s, com conteúdo

maior de baixas freqüências.

persão é imperceptível em comparação à remigração feita utilizando os dados com altas fre-

qüências, Figura 5.7 (direita), assim como à observada quando utilizamos os mesmos dados

migrados para fazer a remigração através do método de DF explícito avançado em v e z, Fi-

gura 5.11 (esquerda).

Na Figura 5.12, estabelecemos a relação entre os dados migrados diretamente e os dados

remigrados através do esquema centrado. Nesta, observamos que a remigração com este es-

quema, Figura 5.12 (esquerda), possui uma dispersão praticamente igual àquela observada na

migração direta dos dados originais, Figura 5.12 (direita). Assim, podemos concluir que este

esquema é muito eficiente no sentido de evitar a dispersão quando o conteúdo de freqüência

dos dados é baixo. Em outras palavras, a redução da dispersão numérica por diminuição do

espaçamento da malha é mais forte do que nos esquemas convencionais. Como anteriormente,

uma diminuição no incremento da velocidade de propagação, ??, não nos mostrou vantagem

neste caso, pois os resultados são muito similares, assim temos então a vantagem de escolher

incrementos não tão pequenos como acontece para os esquemas discutidos anteriormente.

No entanto, apesar deste esquema possuir a propriedade de não causar muita dispersão nu-

mérica na propagação da onda imagem, quando os dados contêm números de ondas com baixas

freqüências, este esquema também pode apresentar problemas para dados com quaisquer quan-



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 66

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.11: Imagem do refletor plano, com menor conteúdo de altas freqüências, remigrado

com velocidades: (a) v ? 2320 m/s, (b) v ? 2680 m/s e (c) v ? 3000 m/s. Esquerda: Método de
diferenças finitas explícito. Direita: Método de diferenças finitas implícito centrado no centro

da célula.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 67

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

Distância (m)

P
ro

fu
n

d
id

a
d

e
 (

m
)

?3000 ?2000 ?1000 0 1000 2000 3000

0

200

400

600

800

1000

1200

1400

1600

(a)

(b)

(c)

Figura 5.12: Imagem do refletor plano, com menor conteúdo de altas freqüências, remigrado

(esquerda) e migrado (direita) com velocidades: (a) v ? 2320 m/s, (b) v ? 2680 m/s e (c)
v ? 3000 m/s, respectivamente. A migração foi feita por migração Kirchhoff e o esquema
utilizado para remigração foi DF implícito centrado no centro da célula.



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 68

tidade de números de onda, pois as propriedades de dispersão deste esquema dependem mais

fortemente ainda do conteúdo de freqüência dos dados do que os outros aprensentados neste

trabalho e para reduzí-los, precisa-se diminuir a malha o que aumenta o custo computacional.

A princípio, pelo fato deste esquema ser incondicionalmente estável temos a vantagem de

crescer ou decrescer na velocidade de propagação quando o esquema é implementado, e, com

isso, podemos também utilizar o modelo migrado com velocidade incorreta de 4000 m/s, como

ilustrado na Figura 5.2b, para fazer a remigração da onda imagem até a profundidade correta

de 550 m e conseqüentemente, até a velocidade correta de 3000 m/s. Porém, para este caso, o

algoritmo numérico não é executável pois a matriz de iteração gerada para resolver o sistema é

mal-condicionada e, portanto, não permite inversão.

Outra dificuldade observada neste esquema é o custo computacional elevado (ver Seção 5.5)

pois se faz necessário resolver sistemas lineares de grande porte a cada iteração. O fato deste es-

quema só poder ser implementado de maneira implícita nos mostra que sempre temos matrizes

de iteração com dimensões elevadas, em decorrência dos problemas relacionados à geofísica.

É importante mencionar, neste contexto, que os problemas de demonstração escolhidos neste

trabalho são de dimensão bastante reduzida em comparação com os problemas reais.

5.5 Tempos computacionais

Nesta seção relatamos a comparação dos tempos computacionais que cada um dos métodos

investigados neste trabalho gastou na realização da propagação da onda imagem para o modelo

de um refletor plano como descrito no início deste capítulo, ou seja, os dados iniciais conforme

representado na Figura 5.2a, que são os dados contendo maior conteúdo de altas freqüências.

Os dados inicias estão armazenados numa matriz de dimensões 601 × 160, que são os números
de pontos na horizontal (distância x) e na vertical (profundidade z), respectivamente.

Na Tabela 5.1 estão os tempos de execução de cada um dos métodos estudados assim como

o tempo da migração direta dos dados por Kirchhoff. Para a migração direta, o tempo repre-

sentado na tabela é o tempo de se fazer uma única migração. Para os métodos investigados, o



CAPÍTULO 5. EXPERIMENTOS NUMÉRICOS 69

Método Tempo (s)

Migração Kirchhoff 116

DF explícito 51

Volumes finitos 72

DF implícito 18700

DF centrado 3050

Tabela 5.1: Comparação entre os tempos computacionais.

tempo representado na tabela é o tempo de se construir aproximadamente 500 imagens pela re-

migração, armazenando-se somente 10 imagens. Assim, para se construir 500 imagens fazendo

a migração direta levaríamos aproximadamente 58000 s, ou seja, em todos os métodos inves-

tigados a vantagem em se fazer a remigração é bem clara do ponto de vista computacional,

principalmente o método de DF explícito (Schleicher et al., 2003a, 2004a). Um exemplo da

vantagem de se fazer a remigração ao invés da migração é quando temos um bom chute para a

velocidade correta do meio (medida, por exemplo, através de uma rocha conhecida no interior

do subsolo) e queremos um conjunto de 20 imagens ao redor desta velocidade para podermos

fazer uma análise de velocidade. Para isso, seria necessário se fazer 20 migrações o que levaria

o tempo de 2320 s. Já para a remigração por onda imagem, usando o método de DF explícito,

seria praticamente de graça, ou seja, aproximadamente 2 s. Logo, fica claro nossa busca por um

método que não cause dispersão, pois as vantagens são grandes em usar a remigração, porém

este método não pode ser mais caro em comparação com a migração direta.

Uma comparação entre tempos para cada um dos métodos nos mostra que o método de DF

explícito é o mais aconselhável. O método de volumes finitos possui um tempo computacional

maior que o método de DF explícito e ainda possui maior dispersão. O método de DF implícito

convencional é o menos aconselhável pois possui um tempo computacional muito maior e não

soluciona o problema da dispersão em relação ao método de DF explícito. Já o DF centrado é

aconselhável quando nosso critério é não causar dispersão, porém só é possível para dados com

baixas freqüências.



Capítulo 6

Conclusões

Neste trabalho, estudamos a chamada equação da onda imagem, cuja dedução, original-

mente desenvolvida por Fomel (1994) e Hubral et al. (1996), é apresentada no Capítulo 2. O

objetivo dos nossos estudos foi a solução dessa equação utilizando métodos numéricos, como,

por exemplo, os métodos de diferenças finitas, melhorando a qualidade da solução numérica em

comparação àquela alcançada em estudos anteriores Schleicher et al. (2004a). Ao utilizarmos

tais métodos, observamos alguns efeitos indesejáveis em sua propagação, como o efeito de

dispersão. A redução deste efeito foi um dos principais objetivos deste trabalho.

Assim, a primeira tentativa de solucionar o problema da dispersão numérica, observada na

propagação da onda imagem quando utilizamos o método de DF explícito (Schleicher et al.,

2004a), foi implementar o método de volumes finitos, estudado no Capítulo 3. Este método não

apresentou resultados satisfatórios apesar de convergentes, pois, além de termos a dispersão

já estudada anteriormente, também observamos uma dispersão causada pela média realizada

para a execução do método a cada iteração. Esta média é o diferencial deste método em re-

lação ao método de DF explícito, logo temos também um aumento no custo computacional em

comparação com o método de DF explícito.

Em decorrência deste resultado, as outras tentativas propostas foram apresentadas no Capí-

tulo 4. Utilizamos esquemas de DF implícitos, já que este método só havia sido implementado

explicitamente para simplificar a implementação (Schleicher et al., 2004a). Inicialmente, os

70



CAPÍTULO 6. CONCLUSÕES 71

esquemas propostos foram os mesmos estudados em Schleicher et al. (2004a), só que aqui im-

plementamos implicitamente, porém, sem resultados satisfatórios. Apesar de não termos identi-

ficado um aumento na dispersão numérica, também não identificamos ganho nesse sentido, pois

a propagação da onda imagem para este caso apresentou os mesmos efeitos de dispersão encon-

trados no melhor caso das implementações explícitas. Isso demonstra que a análise teórica da

dispersão numérica destes esquemas vale independentemente da forma em que os esquemas

forem implementados, explícita ou implícita. Na forma implícita, observamos um aumento no

custo computacional.

Outro esquema implícito proposto no Capítulo 4, foi o centrado no centro da célula. Para

este esquema foi estudada sua consistência, estabilidade, dispersão e dissipação, de onde con-

cluímos que este é consistente, incondicionalmente estável e não dissipativo, porém, que a

dispersão tem forte dependência no número de ondas, isto é, para este caso, quanto maior a

quantidade de altas freqüências mais dispersivo é este esquema. Alternativas para solucionar

este problema foram testadas, como, por exemplo, redução dos incrementos espaciais e da ve-

locidade. No entanto, apesar deste esquema apresentar ótimos resultados para problemas con-

tendo um baixo conteúdo de altas freqüências, não soluciona por completo o nosso problema,

pois significa que, dependendo do conteúdo de freqüência dos dados a serem migrados, pode ser

necessária uma malha de migração muito fina que implica um custo computacional do esquema

implícito muito alto.

Os resultados numéricos de cada um dos métodos estudados neste trabalho estão ilustrados

e discutidos no Capítulo 5. A fim de comparação, utilizamos um modelo com um refletor plano,

com levantamento sísmico inteiro de afastamento nulo, assim como o utilizado em Schleicher

et al. (2004a).

Em conclusão, podemos constatar os seguintes resultados deste trabalho:

• O método de VF, na sua forma mais simples, não é indicado para resolver os problemas

de dispersão dos esquemas de DF. A média contida no procedimento acrescenta dispersão

adicional ao invés de reduzi-la.

• As implementações explícita e implícita de um mesmo esquema de DF apresentam a



CAPÍTULO 6. CONCLUSÕES 72

mesma dispersão numérica. Assim, a implementação explícita, onde possível, é prefe-

rível, uma vez que possui um menor custo computacional.

• O esquema centrado no centro da célula, com espaçamento da malha adequado para o

conteúdo de freqüência dos dados, reduz o efeito de dispersão, porém, apresenta um

custo computacional alto.

Observamos então que, no âmbito desta dissertação, não foi possível apresentar uma solução

para o problema da dispersão numérica dos esquemas de diferenças finitas para a aproximação

da solução da equação da onda imagem que não aumentasse o custo computacional proibitiva-

mente. Deve-se lembrar que, para que o método de remigração tenha significado prático, deve

ser executável mais rápido do que uma migração repetida.

Devido as observações do efeito da média aplicada no método de volumes finitos, sugerimos

estudos de métodos baseados em conceitos de anti-média para futuras tentativas de solução dos

problemas considerados neste trabalho.



Referências Bibliográficas

Bleistein, N., 1984, Mathematical methods for wave phenomena: Academic Press.

Fomel, S., 1994, Method of velocity continuation in the problem of seismic time migration:

Russian Geology and Geophysics, 35, no. 5, 100–111.

——– 2003, Time migration velocity analysis by velocity continuation: Geophysics, 68, 1662–

1672.

Hubral, P., M. Tygel, and J. Schleicher, 1996, Seismic image waves: Geophysical Journal Inter-

national, 125, 431–442.

Jaya, M., M. Botelho, P. Hubral, and G. Liebhardt, 1999, Remigration of ground-penetrating

radar data: Journal of Applied Geophysics, 41, 19–30.

LeVeque, R. J., 2002, Finite volume methods for hyperbolic problems: Cambrigde University

Press.

Munerato, F., 2003, Solução da equação da onda imagem pelo método de diferenças finitas:

Technical report, FAPESP. Relatório de iniciação científica.

Schleicher, J., A. Novais, and F. Munerato, 2003a, Análise numérica da equação da onda ima-

gem na profundidade: TEMA – Tendências em Matemática Aplicada e Computacional, 4,

267–276.

——– 2003b, Migration velocity analysis by depth image-wave remigration: First results:

EAGE/SEG Summer Research Workshop on “Processing and Imaging of Seismic Data Using

Explicit or Implicit Velocity Information?”, Extended Abstracts, T18.

——– 2004a, Migration velocity analysis by depth image-wave remigration: First results: Geo-

physical Prospecting, 52, 559–574.

73



REFERÊNCIAS BIBLIOGRÁFICAS 74

——– 2004b, Migration velocity analysis by depth image-wave remigration: First results: 74th

Ann. Internat. Meeting, Soc. Expl. Geoph. (SEG), Expanded Abstracts, ST1.6:1–4.

Strikwerda, J., 1989, Finite difference schemes and partial differential equations: Wadsworth &amp;amp;

Brooks.

Thomas, J., 1995, Numerical partial differential equations: Springer-Verlag.

Tygel, M., J. Schleicher, and P. Hubral, 1994, Pulse distortion in depth migration: Geophysics,

59, 1561–1569.



Apêndice A

Equação do envelope para onda imagem

Neste apêndice relacionamos o ponto refletor P0(x0, z0), referente à velocidade v0, à sua

imagem, referente à velocidade v. Para tal, reconhecemos que o tempo t representado nas

equações (2.2) e (2.3) é o mesmo. Desta forma, podemos igualar a equação do tempo (2.1)

T =
2

v0

?

z20 + (x0 ? ?)2 , (A.1)

com a equação

T =
2

v

?

z2 + (x ? ?)2 , (A.2)

que é a equação (2.3) resolvida para o tempo.

Ao igualarmos estas duas equações, temos a seguinte equação

F (x, z, ?) = (x ? ?)2 + z2 ? (v/v0)2[(x0 ? ?)2 + z20 ] = 0 . (A.3)

A condição para a curva envelope é

?F

??
= 0 ,

que define, para cada x, um valor do parâmetro ?. Aplicando esta condição à equação (A.3),

encontramos a igualdade

2(x ? ?)(?1) ? 2(v/v0)2(x0 ? ?)(?1) = 0 ,

75



APÊNDICE A. EQUAÇÃO DO ENVELOPE PARA ONDA IMAGEM 76

que pode ser resolvida para ?, fornecendo

? =
x ? (v/v0)2x0
1 ? (v/v0)2

. (A.4)

Este, substituído na equação (A.3), fornece, após solução da expressão resultante em z,

z = (v/v0)

?

?

?

?z20 +
(x ? x0)2

1 ? (v/v0)2
, (A.5)

que é a equação do envelope (2.4).



Apêndice B

Equação iconal da onda imagem

Queremos achar a equação iconal da onda imagem para o problema de remigração. Fazemos

então a substituição de v = V (x, z) na equação (2.4)

z = (V /v0)

?

?

?

?z20 +
(x ? x0)2

1 ? (V /v0)2
. (B.1)

Para simplificar a notação, usamos M (x, z) = V (x, z)/v0. Agora derivamos esta equação com

respeito a x e a z

Mx

?

?

?

[

z20 +
(x ? x0)2
1 ? M 2

]1/2

+
M 2(x ? x0)2
(1 ? M 2)2

[

z20 +
(x ? x0)2
1 ? M 2

]

?1/2
?

?

?

+
M (x ? x0)

1 ? M 2
[

z20 +
(x ? x0)2
1 ? M 2

]

?1/2

= 0 , (B.2)

Mz

?

?

?

[

z20 +
(x ? x0)2
1 ? M 2

]1/2

+
M 2(x ? x0)2
(1 ? M 2)2

[

z20 +
(x ? x0)2
1 ? M 2

]

?1/2
?

?

?

= 1 . (B.3)

Da equação (B.3), observamos imediatamente que
?

?

?

[

z20 +
(x ? x0)2
1 ? M 2

]1/2

+
M 2(x ? x0)2
(1 ? M 2)2

[

z20 +
(x ? x0)2
1 ? M 2

]

?1/2
?

?

?

=
1

Mz
. (B.4)

Da equação (B.1), temos a expressão
[

z20 +
(x ? x0)2
1 ? M 2

]1/2

=
z

M
, (B.5)

77



APÊNDICE B. EQUAÇÃO ICONAL DA ONDA IMAGEM 78

que, juntamente com a equação (B.4), pode ser substituída na equação (B.2), obtendo

Mx
1

Mz
+

M (x ? x0)
1 ? M 2

M

z
= 0 . (B.6)

Esta equação usamos para expressar o último termo desconhecido em (B.3),

M (x ? x0)
1 ? M 2

= ? z
M

Mx
Mz

. (B.7)

Agora, substituímos as equações (B.5) e (B.7) na equação (B.3) e obtemos

z

M
+
(

? z
M

Mx
Mz

)2 M

z
=

1

Mz
ou

z

M
+

z

M

M 2x
M 2z

=
1

Mz
,

que, após multiplicação por
M

z
M 2z , torna-se a equação iconal para M (x, z),

M 2x + M
2
z ?

M

z
Mz = 0 . (B.8)

Retornando para V (x, z) = v0M (x, z), nós achamos a procurada equação iconal (2.5) da

equação da onda imagem (1.1).



Apêndice C

Equação iconal independente de F

Neste apêndice mostramos que a equação (2.5) representa a equação iconal para qualquer

equação diferencial de segunda ordem da forma (2.8). Para tal, calculamos as derivadas parciais

da candidata a solução da equação da onda imagem (2.6), em relação as variáveis espaciais x e

z e a velocidade v. Chegamos nas expressões abaixo

px =
?p

?x
= p0xf ? p0f ?Vx , (C.1)

pxx =
?2p

?x2
= p0xxf ? 2p0xf ?Vx + p0f ??V 2x ? p0f ?Vxx , (C.2)

pz =
?p

?z
= p0zf ? p0f ?Vz , (C.3)

pzz =
?2p

?z2
= p0zzf ? 2p0zf ?Vz + p0f ??V 2z ? p0f ?Vzz , (C.4)

pv =
?p

?v
= p0f

? . (C.5)

Agora, utilizando a equação (C.3), calculamos a derivada mista em relação à profundidade

e à velocidade, obtendo

pzv =
?2p

?z?v
= p0zf

? ? p0f ??Vz . (C.6)

Assim, podemos substituir as equações (C.2), (C.4) e (C.6) na equação (2.8) e obter

p0xxf ? 2p0xf ?Vx + p0f ??V 2x ? p0f ?Vxx

79



APÊNDICE C. EQUAÇÃO ICONAL INDEPENDENTE DE F 80

+p0zzf ? 2p0zf ?Vz + p0f ??V 2z ? p0f ?Vzz

+
V

z
[p0zf

? + p0f
??Vz] = F (px, pz, pv, p, x, z, v) = F? (p0, f, f

?, x, z, v) ,

onde utilizamos que as primeiras derivadas de p somente dependem de f e f ?. Rearranjando os

termos, chegamos em

p0[V
2
x + V

2
z ?

V

z
Vz]f

?? = F? (p0, f, f
?, x, z, v) ? [p0xx + p0zz]f

+[2p0xVx ? p0Vxx + 2p0zVz ? p0Vzz +
V

z
p0z]f

? . (C.7)

Como podemos observar, o lado direito da equação (C.7) não depende da segunda derivada de

f . Portanto, concluímos que a equação iconal

V 2x + V
2
z ?

V

z
Vz = 0 ,

é associada a todas as equações diferenciais parciais que podem ser representadas da forma

(2.8), independentemente da forma da função F . Isto justifica a nossa escolha F = 0 para a

desejada equação da onda imagem (2.7).



Apêndice D

Matrizes de iteração do esquema centrado

As matrizes de iteração Al e Bl e o vetor U l necessários para resolver o sistema linear, dado

pela equação (4.64), para um exemplo com nx = 6 e nz = 3, possuem as seguintes estruturas

Al =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

µl1 ? ?
l
1 ? ?

? µl1 ? ? ?
l
1 ? ?

? µl1 ? ? ?
l
1 ? ?

? µl1 ? ? ?
l
1 ? ?

? µl1 ? ? ?
l
1 ? ?

? µl1 ? ?
l
1 ?

? µl2 ? ?
l
2 ?

? ? µl2 ? ? ?
l
2 ?

? ? µl2 ? ? ?
l
2 ?

? ? µl2 ? ? ?
l
2 ?

? ? µl2 ? ? ?
l
2 ?

? ? µl2 ? ?
l
2

? µl3 ?

? ? µl3 ?

? ? µl3 ?

? ? µl3 ?

? ? µl3 ?

? ? µl3

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

,

81



APÊNDICE D. MATRIZES DE ITERAÇÃO DO ESQUEMA CENTRADO 82

Bl =

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?l1 ? µ
l
1 ? ?

? ?l1 ? ? µ
l
1 ? ?

? ?l1 ? ? µ
l
1 ? ?

? ?l1 ? ? µ
l
1 ? ?

? ?l1 ? ? µ
l
1 ? ?

? ?l1 ? µ
l
1 ?

? ?l2 ? µ
l
2 ?

? ? ?l2 ? ? µ
l
2 ?

? ? ?l2 ? ? µ
l
2 ?

? ? ?l2 ? ? µ
l
2 ?

? ? ?l2 ? ? µ
l
2 ?

? ? ?l2 ? µ
l
2

? ?l3 ?

? ? ?l3 ?

? ? ?l3 ?

? ? ?l3 ?

? ? ?l3 ?

? ? ?l3

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

e

U l = (pl1,1 p
l
2,1 p

l
3,1 p

l
4,1 p

l
5,1 p

l
6,1 p

l
1,2 p

l
2,2 p

l
3,2 p

l
4,2 p

l
5,2 p

l
6,2 p

l
1,3 p

l
2,3 p

l
3,3 p

l
4,3 p

l
5,3 p

l
6,3)

T .

As matrizes Al e Bl foram obtidas quando fazemos as variáveis z fixa e x variando. O vetor

U 0 é o dado de entrada do problema, o qual foi reestruturado a partir de uma matriz nx × nz.



Apêndice E

Mudança de variável na equação da onda

imagem

E.1 Consistência

Aqui, queremos enfatizar que o fato de fazermos a mudança de variável citada no Capítulo 4

não altera as condições de consistência, estabilidade e dispersão do esquema centrado no centro

da célula.

Como podemos observar no desenvolvimento para determinar a consistência do esquema,

o fato de não haver mais a velocidade multiplicando o termo misto da equação diferencial da

onda imagem (4.65) não altera o cálculo dos termos

L??xx ? = ?xx + O(?x2) + O(?z2) + O(??2) ,

L??zz ? = ?zz + O(?z2) + O(??2) ,

agora alterados para a variável ?. Porém, no termo L???z , temos a seguinte mudança

L???z ? =
2

2zn + ?z
??z + O(??2) + O(?z2) ,

que nos diz que

L? ? L??? = ?xx + ?zz +
1

z
??z

?
[

?xx + ?zz +
2

2zn + ?z
??z + O(?x2) + O(?z2) + O(??2)

]

?? 0 ,

83



APÊNDICE E. MUDANÇA DE VARIÁVEL NA EQUAÇÃO DA ONDA IMAGEM 84

quando ?x, ?z, ?? ? 0 .
Logo, o esquema continua sendo consistente de segunda ordem em x, z e ? com a equação

diferencial, mesmo tendo feito a mudança de variável ? = ln (v/v0).

E.2 Estabilidade

Em relação à estabilidade do esquema centrado no centro da célula, a conclusão é a mesma

que para o caso da consistência, pois ao observarmos o desenvolvimento e, em particular, a

equação (4.45), concluímos que |?|2 é igual a 1, independente do valor kln, que neste caso é kn,
como mostrado na equação (4.68).

Portanto, o esquema em discussão, é ainda incondicionalmente estável mesmo tendo feito a

mudança de variável sugerida no contexto.

E.3 Dispersão numérica

Correspondentemente, concluímos, pela semelhança do fator de amplificação ? dos esque-

mas em v e em ?, que a dispersão do esquema em ? pode ser obtida por substituir na equação

(4.60) ?v por ?? e vl por 1.


</field>
	</doc>
</add>