<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.16049</field>
		<field name="filename">22572_Farias_AgnaldoMonteiro_D.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Agnaldo Monteiro Farias

Novas formulações de elementos finitos e
simulações multifísicas

CAMPINAS
2014

i



ii





Ficha catalográfica
Universidade Estadual de Campinas

Biblioteca do Instituto de Matemática, Estatística e Computação Científica
Ana Regina Machado - CRB 8/5467

    
  Farias, Agnaldo Monteiro, 1977-  
 F225n FarNovas formulações de elementos finitos e simulações multifísicas / Agnaldo

Monteiro Farias. – Campinas, SP : [s.n.], 2014.
 

   
  FarOrientador: Philippe Remy Bernard Devloo.
  FarTese (doutorado) – Universidade Estadual de Campinas, Instituto de

Matemática, Estatística e Computação Científica.
 

    
  Far1. Simulação multifísica. 2. Método dos elementos finitos. 3. Galerkin, Métodos

de. 4. Análise numérica. I. Devloo, Philippe Remy Bernard,1958-. II. Universidade
Estadual de Campinas. Instituto de Matemática, Estatística e Computação
Científica. III. Título.

 

Informações para Biblioteca Digital

Título em outro idioma: New formulations of finite element and multiphysics simulation
Palavras-chave em inglês:
Multiphysics simulation
Finite element method
Galerkin methods
Numerical analysis
Área de concentração: Matemática Aplicada
Titulação: Doutor em Matemática Aplicada
Banca examinadora:
Philippe Remy Bernard Devloo [Orientador]
Eduardo Cardoso de Abreu
Cristiane Oliveira de Faria
Lucia Catabriga
Marcio Arab Murad
Data de defesa: 05-12-2014
Programa de Pós-Graduação: Matemática Aplicada

Powered by TCPDF (www.tcpdf.org)

iv





vi



Abstract

The issues of interest in this thesis are related to non classical formulations of the finite
element method (FEM). In this sense, the main focus is on developing computational
tools for the FEM targeting the simulation of multiphysics problems. This type of pro-
blem often occurs in engineering applications modeled by coupling several physical phe-
nomena, which can be resolved in a single numerical simulation. This kind of modeling
is called multiphysics simulation. In this context, to obtain an optimized simulation, it
is convenient to give a different treatment for each physical phenomenon involved. For
instance, in the FEM context, such multiphysics approach can be accomplished by cho-
osing different approximation subspaces in accordance with the phenomena considered.
For the verification of the developed code, a problem of fluid-structure interaction in
linear poroelasticity and a problem of flow in porous media with tracer injection are
solved in the context of multiphysics simulation. H1-conforming approximation is used
for the displacement of the porous matrix, Hdiv-conforming for the fluid flow and dis-
continuous functions for the approximation of fluid pressure and saturation. In another
development, the discontinuos-continuous Galerkin formulation is considered for pro-
blems of linear elasticity. In such formulation, the spaces finite elements are formed
by continuous or discontinuous functions in different regions of the domain. Another
study refers to the Petrov-Galerkin scheme with test functions optimized by symmetri-
zation. A new approach to the method by means of two approximations by continuous
Galerkin method is proposed. The implementation and verification of all considered
formulations are made on the object-oriented programming environment called NeoPZ.
Keywords: finite element, discontinuous-continuous Galerkin, multiphysics simula-
tion, Petrov-Galerkin.

Resumo

Os assuntos de interesse nesta tese dizem respeito a formulações não clássicas do método
dos elementos finitos (MEF). Neste sentido, o foco principal está no desenvolvimento
de ferramentas computacionais para o MEF visando simulações de problemas multi-
físicos. Este tipo de problema ocorre, frequentemente, nas aplicações de Engenharia
modeladas pelo acoplamento de diversos fenômenos físicos, os quais podem ser resol-
vidos numa única simulação numérica. A esta modelagem dá-se o nome de simulação
multifísica. Neste contexto, para se obter uma simulação otimizada, é conveniente dar

vii



um tratamento diferenciado para cada fenômeno físico envolvido. No MEF, por exem-
plo, tal abordagem multifísica pode ser realizada pela escolha de diferentes subespaços
de aproximação, em conformidade com os fenômenos considerados. Para efeito de ve-
rificação do código desenvolvido, resolvem-se dois problemas no contexto de simulação
multifísica. Um problema de acoplamento fluido-estrutura em poroelasticidade linear
e um problema de escoamento em meios porosos com injeção de traçador. Utilizam-
se subespaços de aproximação H1-conformes para o deslocamento da matriz porosa,
Hdiv-conformes para o fluxo de fluido e funções descontínuas para a aproximação da
pressão do fluido e da saturação. Outro desenvolvimento diz respeito a formulações
combinadas de Galerkin contínuo-descontínuo para problemas de elasticidade linear.
Na abordagem proposta, os espaços de elementos finitos são formados por funções con-
tínuas ou descontínuas, em diferentes regiões do domínio. Estuda-se também o esquema
de Petrov-Galerkin com funções teste otimizadas via simetrização. Aplica-se uma nova
abordagem para este método através de duas aproximações pelo método de Galerkin
contínuo. A implementação e avaliação do desempenho de todas as formulações pro-
postas são feitas no ambiente de programação orientada a objetos chamado NeoPZ.
Palavras-chave: elementos finitos, Galerkin contínuo-descontínuo, simulação multifí-
sica, Petrov-Galerkin.

viii



Sumário

1 Introdução 1
1.1 Motivação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.3 Principais tópicos e contribuições da tese . . . . . . . . . . . . . . . . . 3
1.4 Organização do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . 6

2 Conceitos básicos 9
2.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
2.2 Notações . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
2.3 Espaços funcionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

2.3.1 Espaços Hm(?) e Hdiv(?) . . . . . . . . . . . . . . . . . . . . . 11
2.4 Método de Galerkin (ou Bubnov-Galerkin) . . . . . . . . . . . . . . . . 15
2.5 Método de Petrov-Galerkin . . . . . . . . . . . . . . . . . . . . . . . . . 18
2.6 Formulação variacional mista . . . . . . . . . . . . . . . . . . . . . . . 20

3 Formulações de elementos finitos 23
3.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
3.2 Problema modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

3.2.1 Formulação clássica H1-conforme . . . . . . . . . . . . . . . . . 24
3.2.2 Formulação de Galerkin descontínuo . . . . . . . . . . . . . . . 24
3.2.3 Formulação mista . . . . . . . . . . . . . . . . . . . . . . . . . 28

3.3 Subespaços de elementos finitos . . . . . . . . . . . . . . . . . . . . . . 29
3.3.1 Subespaços de aproximação H1-conformes . . . . . . . . . . . . 29
3.3.2 Subespaços de aproximação descontínuos . . . . . . . . . . . . . 32
3.3.3 Subespaços de aproximação Hdiv-conformes . . . . . . . . . . . 32

3.4 Análise de erro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

ix



3.5 Aplicação numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

4 Método da dupla projeção 41
4.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.2 Métodos de Petrov-Galerkin . . . . . . . . . . . . . . . . . . . . . . . . 42

4.2.1 Método de Petrov-Galerkin ótimo via simetrização . . . . . . . . 42
4.2.2 Método de Petrov-Galerkin descontínuo ótimo . . . . . . . . . . 45

4.3 Método da dupla projeção (MDP) . . . . . . . . . . . . . . . . . . . . . 47
4.4 Experimento numérico . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

5 MEF contínuo-descontínuo 53
5.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
5.2 MEF CD para elasticidade linear . . . . . . . . . . . . . . . . . . . . . 54

5.2.1 Formulação MEF contínuo . . . . . . . . . . . . . . . . . . . . . 55
5.2.2 Formulação MEF descontínuo . . . . . . . . . . . . . . . . . . . 55
5.2.3 Formulação MEF CD . . . . . . . . . . . . . . . . . . . . . . . . 56

5.3 Problema de Girkmann . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
5.3.1 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . 59
5.3.2 Resultados numéricos . . . . . . . . . . . . . . . . . . . . . . . . 60
5.3.3 Comparação com outros resultados da literatura . . . . . . . . . 66

6 Simulação multifísica no NeoPZ 69
6.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
6.2 NeoPZ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

6.2.1 Procedimento de cálculo . . . . . . . . . . . . . . . . . . . . . . 71
6.2.2 Descrição dos principais módulos . . . . . . . . . . . . . . . . . 72

6.3 Implementação multifísica . . . . . . . . . . . . . . . . . . . . . . . . . 76
6.3.1 Descrição detalhada . . . . . . . . . . . . . . . . . . . . . . . . . 77
6.3.2 Classes implementadas . . . . . . . . . . . . . . . . . . . . . . . 80
6.3.3 Etapas para simulação multifísica . . . . . . . . . . . . . . . . . 84

6.4 Verificação numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

7 Simulação multifísica do problema poroelástico linear 95
7.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
7.2 Descrição do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . 95

7.2.1 Problema poroelástico linear . . . . . . . . . . . . . . . . . . . . 96

x



7.3 Formulação variacional mista . . . . . . . . . . . . . . . . . . . . . . . 98
7.4 Aplicações . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

7.4.1 Problema de Terzaghi . . . . . . . . . . . . . . . . . . . . . . . 101

8 Simulação multifísica do problema de injeção de traçador em meios
porosos 113
8.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
8.2 Modelo matemático . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
8.3 Formulações variacionais e discretas . . . . . . . . . . . . . . . . . . . . 115

8.3.1 Problema elíptico . . . . . . . . . . . . . . . . . . . . . . . . . . 116
8.3.2 Problema de transporte . . . . . . . . . . . . . . . . . . . . . . 117

8.4 Esquema de segunda ordem para o problema de transporte . . . . . . 118
8.4.1 Reconstrução linear por partes . . . . . . . . . . . . . . . . . . . 119
8.4.2 Reconstrução explícita do gradiente . . . . . . . . . . . . . . . . 120
8.4.3 Limitador do gradiente . . . . . . . . . . . . . . . . . . . . . . . 122
8.4.4 Integração temporal de Runge-Kutta . . . . . . . . . . . . . . . 123
8.4.5 Testes de verificação para o problema de transporte . . . . . . . 125

8.5 Experimentos numéricos para o problema de injeção de traçador . . . . 133
8.5.1 Problema adimensional . . . . . . . . . . . . . . . . . . . . . . . 134
8.5.2 Testes de Verificação . . . . . . . . . . . . . . . . . . . . . . . . 134
8.5.3 Escoamento com barreiras . . . . . . . . . . . . . . . . . . . . . 147
8.5.4 Meio heterogêneo com permeabilidade aleatória . . . . . . . . . 150

9 Conclusões e trabalhos futuros 153
9.1 Conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
9.2 Trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

xi



xii



A minha pequena Lavínia,
para quem dedico com muito amor e carinho.

. . .
Ser pai é um presente divino.

xiii



xiv



Agradecimentos

Em primeiro lugar, agradeço aos meus familiares e minha esposa pelo apoio e incentivo
durante toda essa jornada.

Aos meus orientadores, Prof. Dr. Philippe R. B. Devloo e Sônia Maria Gomes, os
quais me deram elementos necessários para avançar na direção certa da pesquisa e, com
muita qualidade profissional e humana, contribuiram na formação de novos recursos
humanos em nível do ensino e pesquisa. Agradeço pela atenção, compreensão e ami-
zade no desenvolvimento do trabalho.

A todos os alunos e ex-alunos do LabMeC-FEC, os quais de forma direta e indireta
contribuiram no desenvolvimento deste trabalho. Em particular agradeço ao Cesar,
Pira, Caju, Gustavo, João, Alaor, Denise, Diogo, Omar e Nathan.

Agradeço a todos os meus professores, desde a graduação ao doutorado, pela dissemi-
nação de conhecimento na interação professor-aluno e por despertar em mim o interesse
pela pesquisa.

A todos os funcionários do IMECC e da Unicamp pelo bom trabalho prestado. Agra-
deço a Unicamp por todo o apoio estrutural e administrativo.

Agradeço a Petrobras e ANP pelo apoio financeiro concedido através de bolsa de estudo.

Agradeço a Deus pelo sonho realizado.

xv



xvi



Lista de símbolos

Letras Romanas:

h : Parâmetro relacionado ao diâmetro do elemento

Hdiv(·) : Espaços de funções vetoriais v ? L2(·)d tal que div(v) ? L2(·)

Hm(·) : Espaço de Sobolev

k : Grau do polinômio

K : Elemento geométrico

L2 : Espaço de funções de quadrado integráveis

n : Normal externa ao contorno de uma região

p : Pressão

PkPk?1: Bases de funções polinomiais de grau máximo k dos espaços Hdiv
e L2, respectivamente

Q+k : Base de funções polinomiais de grau k do espaço Hdiv acrescentado
de funções internas de ordem k + 1

Q+k Qk: Bases de funções polinomiais de grau k dos espaços Hdiv e L
2,

respectivamente

T : Partição

Letras Gregas:

?ij : Delta de Kronecker

? : Operador laplaciano

?D : Parte do contorno com condições de Dirichlet

?N : Partes do contorno com condições de Neumann

xvii



? : Tensor das permeabilidades

µ : Viscosidade do fluido

? : Operador gradiente

?· (ou div) : Operador divergente

? ? Rd : Aberto limitado com contorno ?? Lipschitz.

Índices

d : Dimensão do domínio

D : Adimensionalização

D : Contorno de Dirichlet

f : Referência ao fluido

k : Grau do polinômio

N : Contorno de Neumann

s : Referência ao meio sólido

Termos e unidades:

b : Força de campo, Pa/m ou kg/(m2s2)

? = (?ij) : Tensor de deformação, com ?ij = (ui,j + uj,i)/2, adimensional

I = (?ij) : Tensor identidade na forma matricial, adimensional

ks : Permeabilidade do meio poroso, mD ou m2

p : Pressão de fluido no meio poroso, Pa ou kg/(ms2)

pD : Pressão adimensional

pD : Valor da pressão no contorno de Dirichlet, Pa ou kg/(ms2)

qf : Termo fonte externo, Pas/m2 ou kg/(m3s)

S? : Coeficiente de armazenamento a volume constante, Pa?1 ou ms2/kg

sf = qf/?f : Termo fonte externo com ?f constante, 1/s

s : Saturação, adimensional

t : Tempo, s

xviii



tD : Tempo adimensional

u : Deslocamento, m

uD : Deslocamento adimensional

uD : Valor de u no contorno de Dirichlet, m

q : Velocidade de escoamento do fluido, m/s

qD : Velocidade de escoamento do fluido adimensional

qN : Valor de q no contorno de Neumann, m/s

? : Parâmetro poroelástico de Biot-Willis, adimensional

? e µ : Constantes elásticas de Lamé, Pa ou kg/(ms2)

µf : Viscosidade dinâmica do fluido, Pas ou kg/(ms)

? : Porosidade da rocha, adimensional

?f : Densidade do fluido kg/m3

?s : Densidade aparente da rocha kg/m3

?s = [?
s
ij] : Tensor das tensões da fase sólida, Pa ou kg/(ms

2)

?f = [?
f
ij] : Tensor das tensões da fase líquida, Pa ou kg/(ms

2)

xix



xx



Capítulo 1

Introdução

O estudo desta tese se enquadra na área de Análise Numérica, especificamente, em
métodos de elementos finitos (MEF) para a resolução de equações diferenciais parciais
(EDP). Consideram-se formulações não clássicas envolvendo a combinação de diferen-
tes tipos de espaços de aproximação, dando origem a simulações que atualmente são
chamadas de multifísicas.

1.1 Motivação

Na base da tecnologia de elementos finitos encontram-se o que chamamos de espaços
de aproximação, cuja construção envolve o particionamento do domínio em um número
finito de elementos, sobre os quais são definidas as funções básicas, por partes. Em
problemas acoplados, envolvendo diferentes fenômenos físicos, a escolha desses espaços
pode variar conforme a necessidade de precisão e/ou necessidade de satisfação da conser-
vação de quantidades de interesse a nível local. Se um único espaço de aproximação for
utilizado para todas as variáveis de estado na mesma simulação, podem ocorrer instabi-
lidades nos algoritmos ou resultados com baixa precisão. Um dos principais focos desta
tese está na combinação de diferentes espaços de aproximação, chamados de espaços
multifísicas, que contribuem no sentido de permitir a simulação de problemas com dife-
rentes fenômenos físicos acoplados. Por exemplo, o problema de poroelasticidade linear
é resolvido no contexto da simulação multifísica utilizando espaços de funções contínuas
para o deslocamento do sólido, espaços vetoriais com componentes normais contínuas
nas interfaces dos elementos para o fluxo de fluido e espaços de funções descontínuas
para a pressão do fluido.

1



O MEF é explorado há mais de 60 anos, tendo suas técnicas, desenvolvidas com
diferentes enfoques, se tornado clássicas e entre as mais populares nas simulações de
problemas de Engenharia. O MEF baseia-se no uso de conceitos variacionais e na
aplicação do método de Galerkin (ou Petrov-Galerkin). Tradicionalmente, o MEF está
associado a subespaços H1-conformes. Tipicamente, estes subespaços são utilizados
na simulação de problemas regulares elípticos com operador linear auto-adjunto, que
ocorrem, por exemplo, em problemas de elasticidade linear, em que as propriedades
ideais de aproximação podem ser alcançadas.

No entanto, em algumas situações, a utilização de formulações clássicas do MEF,
usando subespaços H1-conformes, não é apropriada:

• No contexto de problemas de convecção-difusão, com convecção dominante, po-
dem ocorrer regiões com fortes gradientes na solução. Nessas circunstâncias, fortes
oscilações ocorrem nas soluções aproximadas do MEF clássico, tornando o método
instável. Uma alternativa adotada para contornar este problema é a utilização de
métodos do tipo Petrov-Galerkin otimizados.

• Uma outra abordagem para tratar problemas que possuem regiões com singulari-
dade ou fortes gradientes na solução é através do uso de espaços de aproximação
de funções descontínuas (método de Galerkin descontínuo), em que a continui-
dade é imposta de forma fraca, através de termos integrais, sobre o contorno dos
elementos.

• Para problemas de escoamentos de fluidos, o MEF clássico, formulado em termos
da pressão, a conservação de massa não é garantida a nível local (no elemento),
apenas globalmente. Neste sentido, formulações mistas, em que os campos de
pressão e velocidade do fluido são calculados simultaneamente, são apropriadas,
garantindo a conservação local de massa.

1.2 Objetivos

Os principais objetivos do presente trabalho são:

• Desenvolver simulações multifísicas aplicando vários espaços de aproximação para
abordar diferentes fenômenos em uma mesma simulação.

2



• Desenvolver esquemas combinados MEF contínuo-descontínuo, com partição do
domínio computacional e o emprego de formulações diferenciadas em cada uma
das sub-regiões.

• Avaliar esquemas de Petrov-Galerkin com funções teste otimizadas e propor uma
abordagem diferente para o método de Petrov-Galerkin otimizado via simetriza-
ção, em que utilizam-se duas aproximações pelo MEF contínuo.

• Implementar e avaliar o desempenho das formulações propostas na biblioteca
NeoPZ (https://code.google.com/p/neopz), que é um ambiente de programação
orientada a objetos de código fonte livre.

Proposta da tese

Sendo assim, as metas principais deste trabalho são:

• Proposta de uma abordagem diferente para o método de Petrov-Galerkin oti-
mizado via simetrização, em termos de duas aproximações pelo MEF contínuo,
chamado de método da dupla projeção de Galerkin (MDP). Aplicação numérica
do MDP em um problema unidimensional.

• Formulação e implementação do método MEF contínuo-descontínuo para proble-
mas de eslasticidade linear, com aplicação ao Problema de Girkmann.

• Estudo e desenvolvimento de uma estrutura de classes que contemple simulações
multifíscas no ambiente NeoPZ.

• Resolução do problema de poroelasticidade linear no contexto da simulação mul-
tifísica.

• Resolução do problema de injeção de traçador passivo em meio poroso no contexto
da simulação multifísica.

1.3 Principais tópicos e contribuições da tese

A seguir, descrevem-se, brevemente, os principais tópicos tratados nesta tese e os resul-
tados obtidos.

3



Métodos de Petrov-Galerkin otimizados

No contexto de problemas de convecção-difusão, com convecção dominante, a utilização
de MEF clássicos, baseados em formulações de Galerkin H1-conformes, pode não ser
apropriada pois fortes oscilações podem ocorrer nas soluções aproximadas, tornando as
simulações instáveis. Uma das soluções adotadas para contornar este tipo de problema
é a utilização dos métodos do tipo Petrov-Galerkin. O método de Petrov-Galerkin é
utilizado com referência a uma modificação do método de Galerkin, em que os espaços
de funções admissíveis e de funções teste são diferentes entre si [1]. A liberdade de
escolher diferentes espaços de funções teste abre várias possibilidades de novas ferra-
mentas para otimizar o desempenho dos métodos com base em um determinado espaço
de funções admissíveis. Nesse sentido, novos métodos de Petrov-Galerkin otimizados
foram desenvolvidos, relacionados à escolha de funções teste ótimas.

No contexto das aproximações pelo método dos elementos finitos contínuos, passos
importantes foram dados em [2, 3], em que a taxa ótima de convergência para problemas
de convecção dominante pode ser alcançada usando funções teste ótimas. A técnica é
conhecida como método de Petrov-Galerkin via simetrização (do operador diferencial)
[2, 3].

No contexto das aproximações descontínuas, o método de Petrov-Galerkin foi
explorado inicialmente nos trabalhos [4, 5, 6]. Recentemente, novos métodos do tipo
Petrov-Galerkin para espaços de funções descontínuas (DPG) auto-adptativos, em que
o espaço de funções teste ótimas é calculado automaticamente, foram considerados nos
trabalhos [7, 8, 9, 10, 11, 12, 13, 14].

De modo geral, as funções teste ótimas são calculadas aproximadamente, em que,
para cada função admissível um sistema linear é resolvido. Além disso, após o cálculo
das funções teste ótimas deve-se resolver um problema de Petrov-Galerkin discreto.

Neste trabalho, propõe-se uma abordagem diferente para o método de Petrov-
Galerkin otimizado via simetrização, em que utilizam-se duas aproximações pelo MEF
contínuo, e mostra-se a equivalência entre as duas abordagens. Alguns resultados deste
item foram publicados em [15].

Combinação MEF contínuo-descontínuo

A propriedade de localização nos elementos das bases descontínuas facilita a utilização
de aproximações polinomiais de alta ordem e o emprego de estratégias hp. Uma outra
vantagem na utilização do MEF descontínuo (Galerkin descontínuo) é a propriedade de

4



conservação local, elemento por elemento. No entanto, uma desvantagem do método de
Galerkin descontínuo é a grande quantidade de graus de liberdade requeridos, quando
em comparação com MEF contínuo. Desse modo, uma das soluções adotadas para fazer
a melhor utilização das vantagens de cada método seria a combinação dos MEF contínuo
e descontínuo aplicados ao mesmo problema. Ou seja, pode-se obter simulações mais
econômicas em termos computacionais usando elementos descontínuos na proximidade
de singularidades e elementos contínuos em outras partes, em regiões de solução suave.
Desse modo, pode-se obter a conservação local do método de Galerkin descontínuo, com
um número reduzido de graus de liberdade, e a precisão do MEF contínuo [16, 17, 18, 19].

Um exemplo de problema apropriado para a aplicação dessa metodologia é o
problema de Girkmann, um modelo matemático, no contexto de elasticidade linear, para
uma casca fina axissimétrica apoiada sobre um anel de reforço, igualmente axissimétrico.
Na interface anel-casca, a solução apresenta comportamento singular, sendo suave no
resto do domínio. Este problema foi primeiro descrito por Girkmann, em 1956 [20],
e mais tarde por Timoshenko, em 1959 [21], em que as soluções, através de métodos
clássicos, são apresentadas. Em janeiro de 2008, a Associação Internacional de Mecânica
Computacional (IACM) convidou a comunidade científica para resolver o problema de
Girkmann pelo método dos elementos finitos (MEF). Vários trabalhos foram feitos,
todos usando o MEF contínuo, em resposta à chamada feita pela IACM. Esses resultados
encontram-se resumidos em [22], publicado em 2009. Em um trabalho mais recente [23],
fez-se uma análise do problema nas versões h e hp do MEF.

Propõe-se neste trabalho, a resolução do problema de Girkmann utilizando a
metodologia combinada MEF contínuo-descontínuo, cujo resultados foram publicados
em [24].

Simulação multifísica

Nas aplicações de Engenharia, é comum acontecer que os problemas sejam modelados
pelo acoplamento de diversos fenômenos.

Por exemplo, o escoamento multifásico em um reservatório petrolífero é modelado
pela interação do escoamento de fluido no meio poroso, dado pela equação de Darcy,
com transporte de componentes. O fluido pode ser uma mistura de petróleo com água
e, eventualmente, gás que estão sendo transportados no meio do reservatório, exigindo
a modelagem de transporte de multicomponentes.

Pode ocorrer também a interação de deslocamento do sólido com a pressão de

5



fluido no meio poroso, que é tratada no contexto de poroelasticidade linear. Quando
se extrai petróleo, o reservatório vai se adensar porque se está retirando fluido, e isso
representa uma deformação da matriz elástica onde se aloja o petróleo. Ou seja, a
matriz porosa pode se deformar, fenômeno que está no contexto de poroelasticidade
linear.

Aplicações envolvendo interação fluido-estrutura ocorrem também em operações
de fraturamento hidráulico, em que o comportamento da matriz porosa e do escoamento
de fluidos dentro da fratura estão acoplados. Este escoamento é diferente daquele que
acontece em um meio poroso, e é modelado com outro tipo de equacionamento.

Todos esses fenômenos podem ser considerados numa única simulação numérica
do reservatório. Cada um deles pode ser melhor aproximado com algum tipo de subes-
paço. Alguns com subespaços contínuos do tipo H1-conformes, como, por exemplo, na
simulação de problemas regulares em elasticidade linear. Subespaços Hdiv-conformes
são apropriados para escoamento de fluidos e espaços descontínuos são comumente em-
pregados para as equações de transporte. A esse tipo de simulação, em que se aplica
um tratamento adequado a cada um dos fenômenos físicos envolvidos, dá-se o nome
de simulação multifísica [25]. Modelos de simulações multifísicas têm sido amplamente
estudados recentemente por terem uma ampla diversidade de aplicações como mostrado
na literatura [25, 26, 27, 28, 29, 30, 31, 32].

Atualmente, no ambiente NeoPZ [33, 34, 35], já é possível trabalhar com subes-
paços de funções contínuas H1-conformes, descontínuas e Hdiv-conformes. Um dos
principais focos da tese está no desenvolvimento de classes que possibilitam a combi-
nação de diferentes espaços de aproximação para simulações multifísicas no NeoPZ de
problemas com diferentes fenômenos físicos acoplados. Alguns resultados obtidos foram
publicados em [36, 37]

1.4 Organização do trabalho

Nos Capítulos 2 e 3, abordam-se, de maneira sucinta, os principais tópicos tratados
neste trabalho. Faz-se também, um resumo de alguns conceitos de Análise Funcional
que são úteis na teoria do MEF.

O Capítulo 4 é dedicado ao método da dupla projeção de Galerkin, em que se
mostra uma equivalência entre essa técnica e o método de Petrov-Galerkin via simetri-
zação.

6



O Capítulo 5 é dedicado à aplicação da combinação MEF contínuo-descontínuo
ao problema de Girkmann. O problema de Girkmann é resolvido em um modelo axis-
simétrico utilizando a versão p do MEF contínuo-descontínuo e comparado com outros
resultados da literatura.

No Capítulo 6, faz-se uma breve apresentação do ambiente NeoPZ e descreve-se
como a simulação multifísica foi incorporada a este ambiente.

Nos Capítulos 7 e 8, resolvem-se, no contexto da simulação multifísica, alguns
problemas poroelástico linear e o proplema de injeção de traçador em meios porosos.
Utilizam-se os espaços H1-conformes para o deslocamento do sólido, espaços Hdiv-
conforme para o fluxo de fluido, espaços em L2 para a pressão do fluido e os espaços de
Galerkin descontínuo com funções constantes por partes para a saturação.

No Capítulo 9, apresentam-se as conclusões da tese.

7



8



Capítulo 2

Conceitos básicos

2.1 Introdução

Neste capítulo, faz-se uma abordagem, de maneira sucinta, de alguns conceitos de
Análise Funcional que são úteis na teoria de métodos dos elementos finitos. No desen-
volvimento desta seção, utilizam-se como referência [38, 39, 40, 41, 42, 43, 44].

2.2 Notações

Denota-se por ? ? Rd, d = 1, 2, como sendo um conjunto aberto, limitado com contorno
??. Geralmente, ?? é de classe Lipschitz e é decomposto nas partes ?D e ?N tal que
?D ? ?N = ?? e ?D ? ?N = ?, em que são estabelecidas as condições de Dirichlet e de
Neumann, respectivamente.

A primeira etapa da construção de um espaço de elementos finitos é o estabe-
lecimento de uma partição (malha de elementos finitos) T = {K} do domínio ?, em
que:

• Cada elemento K ?T é um aberto com interior não vazio

• ? = ?
K?T

K

• Dados dois elementos distintos Ki, Kj ?Th tem-se ?Ki ??Kj = fij, em que ou
fij = ? ou fij é um vértice ou fij é formado por dois vértices e a aresta que os
une.

9



No decorrer deste trabalho a partição T pode também ser denotada por Th, em que
h = max{hi} é um parâmetro relacionado à partição, com hi = diâmetro de Ki.

Sendo ?K, K ? T , o contorno de um elemento, denota-se por F o conjunto de
todas as arestas, `, unidimensionais abertas de ?K. O conjunto F0, constituído de
todas as arestas, é definido por

F0 = {` ?F : ` ? ?} . (2.1)

Com isso, define-se o conjunto dos contornos internos (arestas interiores) por

?int = ?
`?(F0\?? )

` (2.2)

Para cada aresta ` ?F0, existem índices i e j, únicos, com i &gt; j, tais que ` é uma
aresta comum dos elementos Ki e Kj. Assim, define-se o salto e o valor médio de uma
função u em `, respectivamente, por

[u] = u|?Ki?` ? u|?Kj?` e ?u? = (u|?Ki?` + u|?Kj?`) /2. (2.3)

Para as arestas ` ? ??, estendem-se as definições de salto e médias como

[u] = u|` e ?u? = u|` .

Para cada aresta ` ? F0, ` ? ?Ki ??Kj, associa-se o vetor unitário normal a `,
de Ki para Kj, denotado por n. Logo n = nKi = ?nKj, em que nKi e nKj denotam
as normais exteriores a ?Ki e ?Kj, respectivamente. Para cada ` ? ??, associa-se a
normal externa n a ??.

2.3 Espaços funcionais

Espaço de Banach Seja X = (X,? . ?) um espaço normado. Se X for completo ele
é chamado de espaço de Banach.

Espaço de Hilbert É um espaço de Banach, em que a norma provém do produto
interno.

10



Espaço L2 Dado um domínio ? ? Rd, o espaço L2(?) é o conjunto de todas funções
de quadrado integráveis definidas em ?. Ou seja,

L2(?) =

{
u : ? ? R,

ˆ
?

| u(x) |2 dx &amp;lt;?
}
.

Esse espaço é um espaço de Hilbert, em que a norma é proveniente do produto interno

?u,v? =
ˆ

?

u(x)v(x)dx. (2.4)

Espaço dual Seja (X,? · ?) um espaço vetorial normado. O conjunto de todos
funcionais lineares contínuos sobre X é chamado de espaço dual de X e é denotado por
X?. Além disso, X? constitui um espaço normado, com a norma definida por

? f ?X?= sup
u?X,u 6=0

| f(u) |
? u ?X

= sup
u?X,?u?X=1

| f(u) | .

Teorema 2.1. (Teorema de representação de Riesz) Seja X um espaço de Hilbert.
Se f : X ?? R é um funcional linear limitado, f ? X?, então existe um único elemento
u ? X de modo que o funcional f é representado por:

f(v) = ?v,u?, ?v ? X

sendo ?·, ·? o produto interno em X. Além disso,

? f ?X?=? u ?X .

2.3.1 Espaços Hm(?) e Hdiv(?)

Nesta subseção, apresentam-se os conceitos principais dos espaços de Sobolev Hm(?)
e do espaço Hdiv(?), os quais são de grande importância na construção de espaços de
aproximação no método dos elementos finitos.

Os espaços de Sobolev Hm(?)

Sejam
? = (?1,?2) e | ? |= ?1 + ?2,

11



com ?j inteiros não negativos. Define-se o operador de derivação parcial em Rd

D? =
?p?p

?x?11 ?x
?2
2

.

Definição 2.2. (Derivada fraca) Seja um aberto limitado ? ? Rd e u ? L2(?). Diz-se
que u?(?) = D?u é a derivada de ordem ? de u, no sentido das distribuições, se:

ˆ
?

(uD??) dx = (?1)|?|
ˆ

?

(u??)dx, ?? ? C?0 (?), (2.5)

sendo C?0 (?) o espaço das funções infinitamente diferenciáveis e com suporte em ?.

Exemplo 2.3. Seja u ? L2(?), em que ? = (0, 1) ? R, definida por

u(x) =

{
x, 0 &amp;lt;x ? 1/2,

1 ?x, 1/2 &amp;lt;x &amp;lt;1.

Esta função não admite derivada ordinária du/dx pois não é derivável em x = 1/2. No
entanto, admite derivada fraca definida por

Du =

{
1, 0 &amp;lt;x &amp;lt;1/2,

?1, 1/2 &amp;lt;x &amp;lt;1.

Definição 2.4. Dados um aberto limitado ? ? Rd e um inteiro m &gt; 0, define-se o
espaço

Hm(?) = {u ? L2(?) : D?u ? L2(?),? | ? |? m}. (2.6)

O espaço Hm(?) é um espaço de Hilbert com o produto interno definido como

?u,v?Hm =
?
|?|?m

?D?u,D?v? =
ˆ

?

?
|?|?m

D?u ·D?v dx (2.7)

e a correspondente norma

? u ?2Hm=
ˆ

?

?
|?|?m

| D?u(x) |2 dx. (2.8)

12



Em Hm(?) pode-se ainda usar a seminorma

| u |2Hm=
ˆ

?

?
|?|=m

| D?u(x) |2 dx . (2.9)

O espaço Hm(?) pode ser visto ainda como o completamento de Cm(?), o espaço
vetorial das funções reais definidas em ?, tal que D?u é contínua em ?, para 0 ?| ? |?
m, provido da norma (2.8).

Definição 2.5. Dados um aberto limitado ? ? Rd, um inteiro m ? 0 e uma partição
T de ?, define-se o espaço de Sobolev particionado

Hm(T ) =
{
u ? L2(?) : u|K ? H

m(K), ?K ?T
}
. (2.10)

A norma associada ao espaço Hm(?,T ) é dada por:

? u ?m,T =

(?
K?T

? u ?2Hm,K

)1/2
,

em que, ? u ?Hm,K é a norma de Sobolev de u em K.

Operador traço. Dado um aberto limitado ? ? Rd com fronteira Lipschitz, pode-se
mostrar que existe um operador linear e contínuo, chamado de operador traço,

?0 : H
1(?) ? L2(??),

tal que ?0(u) = u |?? , ?u ? C1(?).

Definição 2.6. Define-se o espaço H1/2(??) como

H1/2(??) =
{
u0 ? L2(??) : existe u ? H1(?) com ?0u = u0 em ??

}
. (2.11)

Este é um espaço de Hilbert com a norma

? u0 ?H1/2(??)= inf
{
? u ?H1(?): u ? H1(?), ?0u = u0 em ??

}
.

13



O dual de H1/2(??) é o espaço H?1/2(??), com a norma

? v0 ?H?1/2(??) = sup
u0?H1/2(??)

?v0,u0???
? u0 ?H1/2(??)

, (2.12)

em que

?v0,u0??? =
ˆ
??

v0u0 ds, v0 ? H?1/2(??) e u0 ? H1/2(??)

denota o produto de dualidade entre H1/2(??) e H?1/2(??).

Definição 2.7. (Funções de traço nulo ) Define-se H10 (?) como o subespaço das funções
de H1(?) com traço ?0(u) = 0.

Teorema 2.8. (Conformidade em H1(?)) Uma função u : ? ? R pertence a H1(?)
se e somente se em uma partição T de ? são verificadas as propriedades:

i) u |K? H1(K), para todo K ?T
ii) para cada aresta comum fi,j = ?Ki ??Kj os traços ui = u |fi,j e uj = u |fi,j

coincidem, isto é, ui |fi,j ?uj |fi,j = 0

Teorema 2.9. (Teorema de Green):
i) Para u e v ? H1(?) e para 1 ? i ? d tem-se que

ˆ
?

u

(
?v

?xi

)
dx = ?

ˆ
?

(
?u

?xi

)
v dx +

ˆ
??

?0(uv)nids,

com ni as componentes da normal externa, n, a ??.
ii) Para v ? H1(?) e u ? H2(?) tem-se

ˆ
?

?u ·?vdx = ?
ˆ

?

?uv dx +

ˆ
??

?0

(
v
?u

?n

)
ds,

sendo ?u =
?n

i=1 ?
2u/?x2i e ?u = (?u/?x1, ..., ?u/?xn) os operadores Laplaciano e

Gradiente de u, respectivamente.

Espaço Hdiv

Definição 2.10. Dada uma função v : ? ? Rd, define-se o espaço Hdiv(?) por

Hdiv(?) =
{
v ? L2(?)d : div(v) ? L2(?)

}
, (2.13)

14



sendo div(v) =
?n

i=1 ?vi/?xi o operador divergente. Tal espaço, munido da norma

? v ?2Hdiv(?)=? v ?
2
L2(?) + ? div(v) ?

2
L2(?),

é um espaço de Hilbert.

O Teorema de Green, 2.9, pode ser estendido para funções em Hdiv(?), conforme
mostrado em [45]. Ou seja, dadas as funções u ? H1(?) e v ? Hdiv(?), tem-se

ˆ
?

?u ·vdx +
ˆ

?

udiv(v)dx = ?v ·n,u??? ,

em que ?·, ·??? denota o produto de dualidade entre H
?1/2(??) e H1/2(??) .

Uma das características mais importante das funções em Hdiv(?) é enunciada no
Teorema 2.11, conforme mostrado em [46].

Teorema 2.11. Dada uma partição T = {K}, seja u ? (L2(?))d tal que u |K?
Hdiv(K), ?K ? T . Então u ? Hdiv(?) e div(u) |K= div(u) se e somente se o salto
da componente normal é nulo nas interfaces dos elementos da partição T de ?.

2.4 Método de Galerkin (ou Bubnov-Galerkin)

Seja X um espaço de Hilbert e considere um problema variacional abstrato{
encontrar u ? uD + U solução da equação
a(u, v) = l(v), para todo v ? U,

(2.14)

em que U ? X é um subespaço de X, a : X ×X ? R é uma forma bilinear, l : U ? R
é uma forma linear contínua, ou seja l ? U ?, e uD ? X é o valor assumido por u em um
contorno do tipo Dirichlet.

Assumem-se as seguintes hipóteses:

1. a(·, ·) é uma forma bilinear contínua, isto é, existe uma constante M &gt; 0 tal que

| a(u,v) |? M ? u ?X? v ?X, ?u,v ? X. (2.15)

Define-se a norma de a(·, ·) por

? a ?= sup
u,v?U?{0}

| a(u,v) |
? u ?X? v ?X

= sup
?u?X=?v?X=1

| a(u,v) | .

15



2. a(·, ·) é uma forma bilinear U-coerciva. Ou seja, existe uma constante ? &gt; 0
tal que

a(u,u) ? ? ? u ?2U, ?u ? U, u 6= 0. (2.16)

A constante ? é denominada constante de coercividade da forma bilinear. Nota-se
que a condição de coercividade implica na positividade da forma bilinear.

Norma energia. Se a forma bilinear a(·, ·) é simétrica e coerciva, então ela define
um produto interno ?·, ·?a : X ×X ? R, tal que

?u,v?a = a(u,v), ?u,v ? X.

A norma proveniente desse produto interno, denominada norma energia, é dada por

? u ?a= [?u,u?a]
1/2
.

Teorema 2.12. (Teorema de Lax-Milgram) Sejam a(·, ·) uma forma bilinear contínua
sobre o espaço de Hilbert X e U-coerciva e l ? U ?. Então, existe um único elemento
u ? uD + U solução da equação

a(u, v) = l(v), para todo v ? U.

Tem-se ainda que

? u ?X?
1

?
? l ?U? +

(
M

?
+ 1

)
? uD ?X,

em que ? e M são, respectivamente, as constantes de coercividade e continuidade da
forma bilinear a(·, ·).

Demonstração. A demonstração pode ser vista em [39], pag. 521.

Com base no problema variacional (2.14), pode-se definir o método de Galerkin,
que consiste em encontrar soluções aproximadas em um subespaço Un ? U de dimensão
finita

Un = span{?i, i = 1, ..., n} ,

em que ?i ? U formam uma base. Ou seja, para todo un ? Un tem-se sua representação
única

un =
n?
i=1

?j?j, ?j ? R.

16



Assim, uma discretização para o problema variacional (2.14), usualmente denominada
de método de Galerkin, consiste em:{

encontrar un ? uD + Un tal que
a(un, ?i) = l(?i) para todo ?i ? Un

(2.17)

O problema (2.17) define um sistema linear quadrático com n equações e n incóg-
nitas ?1, ?2, ..., ?n, que são as coordenadas de un com relação à base do subespaço Un.
Na forma matricial, esse sistema torna-se

K? = d,

em que os elementos da matriz K = (kij) são dados por

kij = a(?i,?j) para todos i, j = 1, ...,n,

e os elementos do vetor d = (dj) são dados por

dj = l(?i) para todos i = 1, ...,n.

De maneira análoga ao problema variacional simétrico (2.14), a existência e uni-
cidade da solução do problema variacional discreto (2.17) são garantidas pelo Teorema
de Lax-Milgram.

Interpretação Geométrica Supondo que a forma bilinear a(·, ·) é simétrica, apresenta-
se a seguir uma interpretação geométrica para a solução de Galerkin do problema vari-
acional (2.14) com relação ao produto interno energia ?·, ·?a associado à forma bilinear
a(·, ·) sobre X.

Se u ? uD + U é a solução do problema variacional (2.14), então

a(u,v) = l(v), ?v ? U.

Como Un ? U, a igualdade acima continua valendo se escolhermos ?i ? Un, ou seja

a(u,?i) = l(?i), ??i ? Un. (2.18)

Da mesma forma, se u?n ? uD +Un for a solução do problema variacional discreto (2.17),

17



tem-se
a(u?n,?i) = l(?i), ??i ? Un. (2.19)

Assim, subtraindo (2.19) de (2.18) e utilizando a definição do produto interno ?·, ·?a =
a(·, ·), tem-se

a(u?u?n,?i) = 0, ??i ? Un.

Portanto, pode-se dizer que o erro u?u?n da solução de Galerkin é ortogonal ao
subespaço de aproximação Un com relação ao produto interno energia. Esta propriedade
é conhecida como ortogonalidade de Galerkin. Ou seja, a solução de Galerkin u?n é
a projeção ortogonal de u no espaço de aproximação Un com relação ao produto interno
energia. Em outras palavras, diz que a solução de Galerkin u?n ? uD + Un ? uD + U é
a melhor aproximação de u ? uD + U com relação à norma energia, isto é

? u?u?n ?a?? u?v ?a, para todo v ? Un. (2.20)

2.5 Método de Petrov-Galerkin

Sejam X e Y espaços de Hilbert, U ? X subespaços em X e V ? Y o espaço de funções
teste em Y . O método de Petrov-Galerkin é uma generalização do método de Galerkin,
em que usam-se subespaços de dimensão finita Un ? U e Vn ? V diferentes entre si. A
existência e unicidade da solução é mostrada através de uma generalização do teorema
de Lax-Milgram.

Considere a formulação variacional:{
encontrar u ? uD + U tal que
a(u, v) = l(v) para todo v ? V,

(2.21)

em que l : V ? R é uma forma linear contínua, ou seja l ? V ?, e uD ? X é o valor
assumido por u em um contorno do tipo Dirichlet. Assume-se que:

1. a(·, ·) : X ×Y ? R é uma forma bilinear contínua, isto é, existe uma constante
M &gt; 0 tal que

| a(u,v) |? M ? u ?X? v ?Y , ?u ? X, ?v ? Y (2.22)

18



e satisfaz a condição inf-sup

inf
?u?X=1

sup
?v?Y =1

a (u,v) ? ? &gt; 0, ?u ? X, ?v ? Y. (2.23)

2. O espaço nulo do operador adjunto A? : V ? U ?, com o ?A?v,u? = a(u,v), é tal
que

V0 = N (A?) = {v ? V : a(u,v) = 0, ?u ? U} = {0} ,

que é equivalente a
sup
u?U
| a(u,v) |&gt; 0, ?v 6= 0, v ? V. (2.24)

Teorema 2.13. (Teorema de Lax-Milgram generalizado) Nas condições (2.22), (2.23)
e (2.24), o problema variacional (2.21) possui uma única solução para todo funcional
linear l ? V ?. Ou seja, existe um único u ? uD + U tal que

a(u,v) = l(v) ?v ? V, ?l ? V ?.

Além disso, u depende continuamente de l e uD

? u ?X?
1

?
? l ?V ? +

(
M

?
+ 1

)
? uD ?X,

sendo ? a constante da condição inf-sup (2.23).

Demonstração. A demonstração pode ser vista em [39], pg. 518.

Sejam o subespaço Un ? U e o subespaço de funções teste Vn ? V , com dim Un =
dim Vn = n. O análogo discreto do problema variacional (2.21), conhecido como método
de Petrov-Galerkin, é dado por{

encontrar un ? uD + Un tal que
a(un,vn) = l(vn), ?vn ? Vn.

(2.25)

Desse modo, vale o seguinte resultado.

Teorema 2.14. Suponha que vale a condição inf-sup

inf
?un?X=1

sup
?vn?Vn=1

a (un,vn) ? ?n &gt; 0, ?un ? uD + Un, ?vn ? Vn.

19



Então, o problema variacional discreto (2.25) possui solução única u?n,

? u?n ?X?
M

?n
? u ?X ,

sendo u ? uD + U a solução exata do problema variacional (2.25), e tem-se a seguinte
estimativa do erro

? u?u?n ?X?
M

?n
inf

wn?uD+Un
? u?wn ?X . (2.26)

A demonstração deste resultado pode ser vista em [47] ou [48].

2.6 Formulação variacional mista

Sejam X e W espaços de Hilbert e V ? X um subespaço de X. Considere um problema
variacional misto dado por: encontrar q ? qN + V, u ? W tal que{

a(q, v) ? b(v,u) = l1(v), ?v ? V,
b(q,w) = l2(w), ?w ? W,

(2.27)

em que qN ? X é o valor assumido por q em um contorno do tipo Neumann, l1 e l2 são
formas lineares contínuas, l1 ? V? e l2 ? W ?.

Assume-se as condições:

1. a(·, ·) : X ×X ? R é uma forma bilinear contínua (ver 2.15).

2. b(·, ·) : X ×W ? R é uma forma bilinear contínua (ver 2.22).

Define-se
V0 = {v ? qN + V : b(v,w) = 0, ?w ? W} . (2.28)

O próximo teorema, conhecido como condição LBB ou condição Babuska-Brezzi, esta-
belece as condições de existência e unicidade do problema (2.27), e é demonstrado em
[49, 46, 47],.

Teorema 2.15. (LBB) Sob as condições (1) e (2) anteriores, o problema variacional
(2.27) é bem posto se e somente se as seguintes condições de inf-sup forem válidas:
existem constantes ? e ? tais que

inf
0 6=q?V0

sup
0 6=v?V0

a (q,v)

? q ?X? v ?X
= inf

0 6=v?V0
sup

06=q?V0

a (q,v)

? q ?X? v ?X
= ? &gt; 0 (2.29)

20



e
inf

06=w?W
sup

06=v?qN +V

b (v,w)

? v ?V? w ?W
= ? &gt; 0. (2.30)

Além disso, nas condições (2.29) e (2.30), o problema (2.27) possui solução única
(q,u) ? V ×W tal que

? (q,u) ?X×W?K(??1,??1,? a ?) ? (l1, l2) ?V?×W ?,

em que K(·, ·, ·) é uma função positiva.

O análogo discreto do problema variacional (2.27) é dado por: encontrar qn ?
qN + Vn, un ? Wn tal que{

a(qn, vn) ? b(vn,un) = l1(vn), ?vn ? Vn,
b(qn,wn) = l2(wn), ?wn ? Wn,

(2.31)

em que Vn ? qN + V e Wn ? W são subespaços admissíveis de dimensão finita.
O análogo discreto ao Teorema 2.15 é enunciado a seguir.

Teorema 2.16. Seja Vn,0 = {vn ? qN + Vn : b(vn,wn) = 0, ?wn ? Wn} e assumem-
se válidas as seguintes condições de Babuska-Brezzi:

inf
0 6=qn?Vn,0

sup
06=vn?Vn,0

a (qn,vn)

? qn ?X? vn ?X
= ?n &gt; 0 (2.32)

e
inf

06=wn?W
sup

06=vn?V

b (vn,wn)

? vn ?X? wn ?W
= ?n &gt; 0, (2.33)

sendo ?n e ?n as constantes da condição inf-sup do caso discreto. Então, o problema
(2.31) é bem posto e são válidas as estimativas

? q ? qn ?X? (? a ? + ? b ?)K(??1n ,?
?1
n ,? a ?) inf

vn?qN +Un
? q ?vn ?X

e
? u?un ?W? (? a ? + ? b ?)K(??1n ,?

?1
n ,? a ?) inf

wn?Wn
? u?wn ?W .

21



22



Capítulo 3

Formulações de elementos finitos

3.1 Introdução

Neste capítulo descrevem-se diferentes formulações variacionais do método de elementos
finitos, a partir de um problema modelo, bem como os espaços de aproximação utilizados
neste trabalho.

Simplificadamente, a metodologia do MEF consiste nos seguintes passos:

1. Formulação matemática de um problema em termos de uma equação diferencial,
em geral proveniente de uma lei de conservação, e informações de contorno.

2. Obtenção da formulação variacional do problema.

3. Escolha de um espaço de funções de aproximação de dimensão finita.

4. Obtenção do problema discreto baseado no espaço de funções de aproximação
adotado. Como resultado da aplicação do método, obtém-se um sistema algébrico
cuja solução consiste de coeficientes da combinação linear da solução aproximada
em relação à da base adotada.

5. Resolução do sistema gerado pelo problema discreto para obtenção dos coeficien-
tes.

6. Análise da solução obtida.

Algumas das etapas da metodologia do MEF são tratadas no decorrer do presente
capítulo.

23



3.2 Problema modelo

Como problema modelo, considera-se o seguinte problema de Poisson: encontrar a
função escalar u solução de

??u = f, em ?, (3.1)

que satisfaz as condições de contorno

u = uD, em ?D,
?u ·n = uN, em ?N,

(3.2)

em que f, uD e uN são funções dadas.
Descrevem-se a seguir, algumas formulações variacionais, no contexto do MEF,

para o problema modelo (3.1)-(3.2).

3.2.1 Formulação clássica H1-conforme

Definem-se o espaço de funções teste

U =
{
v ? H1(?), tal que v = 0 em ?D

}
(3.3)

e o conjunto de funções admissíveis uD + U. Assim, multiplicando a equação (3.1) por
uma função teste v e integrando por partes, a formulação fraca do problema modelo
(3.1) e (3.2) é dada por: encontrar u ? uD + U tal que

a(u,v) = l(v), ?v ? U, (3.4)

com
a(u,v) =

ˆ
?

?u ·?v dx e l(v) =
ˆ

?

f v dx +

ˆ
?N

uNvds.

Esta formulação se enquadra no contexto do método de Galerkin (2.14). Sendo
assim, a verificação da existência e unicidade da solução, com base no Teorema 2.12, é
um resultado clássico da literatura, por exemplo, ver [39] na página 522.

3.2.2 Formulação de Galerkin descontínuo

O processo de generalização do MEF para contemplar espaços de aproximação de fun-
ções descontínuas é conhecido como método de Galerkin descontínuo.

24



K|
i

K|
j

n

-n

!

Figura 3.1: Esquema do contorno interno ` entre dois elementos vizinhos.

Suponha que a solução do problema modelo (3.1) tenha regularidade suficiente
para pertencer a

V = H2(T ),

sendo H2(T ) o espaço de Sobolev particionado definido em (2.10), com m = 2. Multi-
plicando a equação (3.1) por uma função teste v ? V e integrando por partes, obtém-se:

?
K?T

(ˆ
K

?u ·?v dx
)
?
?
K?T

(ˆ
?K

(?u ·n)v ds
)

=
?
K?T

(ˆ
K

f v dx

)
. (3.5)

Sobre cada elemento K fazem-se algumas manipulações [50]. A primeira das manipu-
lações considera a decomposição de fluxos sobre as arestas dos elementos (Figura 3.1).
Escreve-se

?
K?Th

(ˆ
?K

?u ·nv ds
)

=
?
`?F0

(ˆ
`

(?u ·n)ivi + (?u ·n)jvjds
)

+

ˆ
?D

(?u ·n)v ds +
ˆ

?N

(?u ·n)v ds.

(3.6)

Sabendo-se que

(?u ·n)ivi + (?u ·n)jvj = n · (?u)ivi ?n · (?u)jvj,

e utilizando a relação

ac? bd =
1

2
(a + b) (c?d) +

1

2
(a? b) (c + d),

25



e as definições do salto [·, ·] e da média ?·, ·? (2.3), reescreve-se :

?
`?F0

(ˆ
`

(?u ·n)ivi + (?u ·n)jvjds
)

=
?
`?F0

(ˆ
`

1

2
(n · (?u)i + n · (?u)j) (vi ?vj) +

1

2
(n · (?u)i ?n · (?u)j) (vi + vj)ds

)

=

ˆ
?int

??u ·n? [v] + [?u ·n]?v?ds =
ˆ

?int

??u ·n? [v] .

(3.7)
Com u ? H2(T ), tem-se que a componente normal do gradiente ?u ·n é contínua nas
interfaces dos elementos, de modo que

ˆ
?int

[?u ·n]?v?ds = 0. Assim, das equações

(3.6) e (3.7) tem-se

?
K?Th

(ˆ
?K

?u ·nv ds
)

=
´

?int??D
??u ·n? [v] +

ˆ
?N

(?u ·n)v ds. (3.8)

A segunda manipulação é a adição do termo

?

ˆ
?int

??v ·n? [u] ds = ?
ˆ

?int??D
??v ·n? [u] ds??

ˆ
?D

??v ·n?uDds. (3.9)

A terceira e última manipulação é a adição do termo de penalidade interior

?

ˆ
?int??D

[u] [v] ds??
ˆ

?D

uD [v] ds. (3.10)

Portanto, substituindo as equações (3.8)-(3.10) em (3.5), a solução do problema
modelo (3.1)-(3.2) verifica a formulação variacional de Galerkin descontínuo

b(u,v) = f(v), v ? V, (3.11)

em que

b(u,v) = a1(u,v) ?a2(u,v) + ?a2(v,u) + ?a3(u,v)

26



e
f(v) = l1(v) + ?l2(v) + ?l3(v),

tais que

a1(u,v) =
?
K?T

(ˆ
K

?u ·?v dx
)
,

a2(u,v) =

ˆ
?int??D

??u ·n? [v] ,

a3(u,v) =

ˆ
?int??D

[u] [v] ds,

l1(v) =
?
K?Th

(ˆ
K

f v dx

)
+

ˆ
?N

uNv ds,

l2(v) =

ˆ
?D

??v ·n?uDds

e

l3(v) =

ˆ
?D

uDv ds.

No contexto de Galerkin descontínuo, os parâmetros ? e ? são introduzidos para
fins de penalização e simetrização. O parâmetro ? é chamado de parâmetro de penaliza-
ção da descontinuidade e é utilizado para reforçar a estabilidade do método descontínuo
através de uma penalização interior [51].

Para ? = ?1 e ? = 0, obtém-se a formulação simétrica GEM (Global Element
Method) proposta por [52]. Uma vantagem deste método é que ele define um problema
simétrico. Por outro lado, uma desvantagem é que a forma bilinear não garante ser
semidefinida positiva [50]. Para ? = 1 e ? = 0, obtém-se a formulação não-simétrica
proposta por [53], em que obtém-se uma forma bilinear semidefinida positiva.

Para ? 6= 0 e ? = ?1, obtém-se a formulação simétrica com penalidade inte-
rior SIPG (Symmetric Interior Pênalti Galerkin Method) proposta por [54]. Além da
perda da propriedade de conservação local do método de Galerkin descontínuo, com a
utilização do parâmetro de penalidade ?, uma outra desvantagem deste método é que
ele depende da escolha deste parâmetro. Para ? 6= 0 e ? = 1, obtém-se a formulação
não-simétrica com penalidade interior NIPG (Non-Symmetric Interior Pênalti Galerkin

27



Method) apresentada por [51] e citada em [50]. A vantagem desse método NIPG é que
ele não depende da escolha do parâmetro de penalidade ?. No entanto, a garantia de
conservação local do método de Galerkin descontínuo é perdida com a utilização do
parâmetro de penalidade ?.

O parâmetro de penalização ? é definido sobre as interfaces dos elementos. Para
problemas elípticos, uma fórmula para ? [51, 55] é dada por

? = C`
?k2?
?h?

, ?` ?F0, (3.12)

sendo C` &gt; 0 uma constante positiva, chamada de constante de penalização, k o grau
da função polinomial utilizada, h o tamanho do elemento e ?·, ·? é a média definida em
(2.3). De acordo com [50] e [55] o valor de C` deve ser cuidadosamente escolhido para
garantir estabilidade do método. Para o método SIPG é necessário que C` &gt; 0 seja
uma valor suficientemente grande e para o método NIPG qualquer valor C` &gt; 0 garante
a estabilidade do método.

3.2.3 Formulação mista

Na representação de um fenômeno físico, pode ser interessante escrevê-la em uma for-
mulação mista. Por exemplo, escoamentos em meios porosos ocorrem em diversas
aplicações de interesses práticos, entre elas na extração de petróleo. Os fenômenos en-
volvidos são usualmente modelados por um sistema de equações diferenciais composto
por uma lei de conservação de massa e uma lei constitutiva. Para isso, é considerada a
conhecida lei de escoamento de Darcy, que estabelece a relação entre o fluxo e a pressão.
Na resolução pelo método de elementos finitos clássico, encontra-se uma aproximação
para a variável de pressão e utilizam-se técnicas de pós-processamentos para se obter
uma estimativa para o fluxo. No entanto, sabe-se que, com esta técnica, a taxa de
convergência assintótica do erro para o fluxo é inferior, quando comparada com a da
pressão.

Uma metodologia desenvolvida para melhorar a aproximação de problemas deste
tipo é conhecida como MEF misto, cujo princípio consiste na aproximação simultânea
das variáveis vetorias (como o fluxo) e variáveis escalares (como a pressão). Como
descrito em [46], a principal característica de funções em Hdiv(?) é a continuidade da
componente normal nas interfaces entre elementos de uma partição T .

Considerando o problema modelo (3.1)-(3.2) e definindo q = ??u , o problema

28



misto é dado por {
q = ??u, em ?,
?·q = f, em ?,

(3.13)

com as condições de contorno

u = uD, em ?D,
q ·n = qN = ?uN, em ?N.

(3.14)

Definem-se os espaços

V = {v ? Hdiv(?) tal que v ·n = 0 em ?N} , W = L2(?).

Assim, a formulação fraca do problema misto (3.13) é dada por: encontrar q ? qN + V
e u ? W tal que

a(q,v) ? b(v,u) = l1(v), ?v ? V,
b(q,w) = l2(w), ?w ? W,

(3.15)

com
a(q,v) =

ˆ
?

q ·vdx, b(v,u) =
ˆ

?

u?·v dx,

l1(v) = ?
ˆ

?D

uDv ·nds e l2(w) =
ˆ

?

f w dx.

Esta formulação se enquadra no contexto da formulação mista (2.27) e sua análise
é feita através do Teorema 2.15.

3.3 Subespaços de elementos finitos

Nas subseções seguintes, mostram-se alguns subespaços de elementos finitos utilizados
neste trabalho [33, 35], a serem usados nas discretizações das formulações variacionais
anteriores, os quais estão implementados no ambiente computacional NeoPZ [56, 34].

3.3.1 Subespaços de aproximação H1-conformes

Nesta seção, consideram-se subespaços de elementos finitos Uh ? U a serem utiliza-
dos na discretização da formulação de elementos finitos clássica. As funções escalares
H1-conformes utilizados no presente trabalho foram desenvolvidas em [33, 57]. Dada

29



uma partição do domínio computacional Th, esse processo é feito usando mapeamentos
geométricos e transformações paramétricas a partir de um elemento de referência K?. O
mapeamento geométrico, FK : K? ? K é tal que K = FK(K?), para qualquer elemento
K ?Th. Ou seja,

Uh =
{
v ? U : F?1K (v|K) ?P(K?)

}
,

em que U é o espaço definido em (3.3) e P(K?) é uma espaço de polinômios no elemento
de referência. Em [33], o autor desenvolveu funções de base hierárquicas para P(K?) as-
sociadas a várias geometrias dos elementos: linha para K? ? R, triângulo e quadrilátero
para K? ? R2 e tetraedro, pirâmide, prisma e hexaedro para K? ? R3. Nos Exemplos
3.1 e 3.2 mostram-se as bases hierárquicas para elementos triangulares e quadrilaterais,
respectivamente.

Exemplo 3.1. (Elemento triangular) Seja o elemento triangular de referência

K? = {(?,?), 0 ? ? ? 1, 0 ? ? ? 1 ? ?} ,

com vértices a0 = (0, 0), a1 = (1, 0) e a2 = (0, 1) e arestas lm, m = 0, 1, 2, correspo-
dendo aos lados que unem os vértices am e am+1(mod)3. Neste caso considera-se

P(K?) = Pk(K?) = span
{
xiyjzr : 0 ? i, j, r ? k e i + j + r ? k

}
,

com dimensão igual a 1
2
(k + 1)(k + 2). A base hierárquica para Pk(K?) é dada por:

• 3 funções de vértice ??am

??a0 (?,?) = 1 ? ? ??, ??a1 (?,?) = ? e ??a2 (?,?) = ?.

• 3(k ? 1) funções de aresta ??lm,n, k ? 2

??l0,n(?,?) = ??a0 (?,?)??a1 (?,?)fn(? + 2? ? 1),

??l1,n(?,?) = ??a1 (?,?)??a2 (?,?)fn(? ? ?),

??l2,n(?,?) = ??a2 (?,?)??a0 (?,?)fn(1 ? ? ? 2?),

sendo fn o polinômio de Chebychev de grau n = 0, ..., k ? 2.

30



•
1

2
(k ? 2)(k ? 1) funções internas ??K?,n0,n1, k ? 3

??K?,n0,n1 (?,?) = ??a0 (?,?)??a1 (?,?)??a2 (?,?)fn0 (2? ? 1)fn1 (2? ? 1),

com 0 ? n0 + n1 ? k ? 3.

Exemplo 3.2. (Elemento quadrilateral) Seja

K? = {(?,?), ?1 ? ?,? ? 1}

o elemento retangular de referência com vértices a0 = (?1,?1), a1 = (1,?1), a2 = (1, 1)
e a3 = (?1, 1) e arestas lm, m = 0, 1, 2, 3, correspodendo aos lados que unem os vértices
am e am+1(mod)4. Neste caso considera-se

P(K?) = Qk(K?) = span
{
xiyjzr : 0 ? i, j, r ? k

}
,

com dimensão igual a (k + 1)2. A base hierárquica para Qk(K?) é dada por:

• 4 funções de vértice ??am

??a0 (?,?) =
(1 ? ?)

2

(1 ??)
2

, ??a1 (?,?) =
(1 + ?)

2

(1 ??)
2

,

??a2 (?,?) =
(1 + ?)

2

(1 + ?)

2
, ??a3 (?,?) =

(1 ? ?)
2

(1 + ?)

2
.

• 4(k ? 1) funções de aresta ??lm,n, k ? 2

??l0,n(?,?) = ??a0 (?,?) [??a1 (?,?) + ??a2 (?,?)] fn(?),

??l1,n(?,?) = ??a1 (?,?) [??a2 (?,?) + ??a3 (?,?)] fn(?),

??l2,n(?,?) = ??a2 (?,?) [??a3 (?,?) + ??a0 (?,?)] fn(??),

??l3,n(?,?) = ??a3 (?,?) [??a0 (?,?) + ??a1 (?,?)] fn(??),

sendo fn o polinômio de Chebychev de ordem n = 0, ..., k ? 2.

• (k ? 1)2 funções internas ??K?,n0,n1, k ? 2

??K?,n0,n1 (?,?) = ??a0 (?,?)??a2 (?,?)fn0 (?)fn1 (?),

31



com n0,n1 = 0, ..., k ? 2.

Para um elemento triangular ou quadrilateral qualquer, K ? Th, transformações e
parametrizações são usadas para mapear as funções de base do elemento mestre para
criar uma base

BK = {?am, ?lm,n, ?K,n0,n1}, (3.16)

formada por funções de vértice, aresta e internas em K. Para garantir que o subespaço
de elementos finitos Uh gerado por essas bases seja H1-conforme, assume-se que dois
elementos vizinhos quaisquer, Ki,Kj ? Th , possuem os mesmos coeficientes multipli-
cadores que ocorrem nas funções de vértice e ou de aresta.

3.3.2 Subespaços de aproximação descontínuos

Nesta subseção descrevem-se os subespaços de elementos finitos Vh a serem usados nas
formulações de Galerkin descontínuo (3.11).

Dados uma partição Th e mapeamentos geométricos FK : K? ? K entre o elemento
de referência e os elementos da partição Th, define-se o subespaço de elementos finitos
particionado

Vh =
{
v ? L2(?) : F?1K (v|K) ?P(K?)

}
, (3.17)

em que P(K?) denota algum espaço de funções polinomiais no elemento de referência,
podendo ser Pk(K?) ou Qk(K?). Observa-se que as funções de Vh estão em H2(Th)
podendo ser descontínuas nas interfaces dos elementos.

3.3.3 Subespaços de aproximação Hdiv-conformes

A construção de subespaços de elementos finitos Vh ? V do tipo Hdiv-conformes, a
serem usados na formulação mista (3.15), foi proposta inicialmente por Raviart-Thomas
[58], para o caso bidimensional. A partir de mapeamentos e transformações sobre um
elemento de referência, constroem-se os espaços nos elementos da partição. Posteri-
ormente, Nédelec [59] estabeleceu sua generalização para elementos tridimensionais.
Pode-se, ainda, citar o trabalho de Brezzi-Douglas-Marini (BDM) mostrado em [46],
em que não se faz uso de elemento de referência, a construção é feita diretamente, em
cada elementos K da partição.

Neste trabalho são utilizados os subespaços Hdiv-conformes, propostos por Si-
queira [35, 60], relacionados a elementos bidimensionais triangulares e quadrilaterais.

32



O procedimento utiliza as bases hierárquicas H1-conformes, descritas na Seção 3.3.1, e
um conjunto de vetores ~v, convenientemente construído de acordo com cada geometria
do elemento. As características de conformidade das funções de base escalares ? e a
escolha apropriada do conjunto de vetores ~v garantem a condição de continuidade da
componente normal [35]. A seguir, mostram-se, respectivamente, as funções de base
Hdiv-conformes para elementos triangulares e quadrilaterais [35].

Elementos triangulares. Seja BK a base hierárquica (3.16) definida sobre um ele-
mento triangular K ?Th. Considera-se o conjunto de vetores ~v = {~?j, j = 0, ..., 13},
como mostrado na Figura 3.2, tal que

1. Para cada aresta lm, m = 0, 1, 2, tem-se que

(a) ~?2+3m e ~?m+9 são, respectivamente, a normal externa e o vetor tangente a lm

(b) Para s = 3m, os vetores ~?s e ~?s+1 são tais que ~?s ·~?s+2 = ~?s+2 ·~?s+1 = 1

2. No interior do elemento, ~?12 e ~?13 são ortogonais

Funções de base para um subespaço de Hdiv(K) são dadas por:

• 3(k + 1) funções de aresta ?lm,am e ?lm,n

m = 0 : ?l0,a0 = ?a0~v0, ?
l0,a1 = ?a1~v1, ?

l0,n = ?l0,n~v2

m = 1 : ?l1,a1 = ?a1~v3, ?
l1,a2 = ?a2~v4, ?

l1,n = ?l1,n~v5

m = 2 : ?l2,a2 = ?a2~v6, ?
l2,a3 = ?a3~v7, ?

l2,n = ?l2,n~v8

• k2 ? 1 funções internas

?
K,n0,n1
1 = ?

K,n0,n1~v12, ?
K,n0,n1
2 = ?

K,n0,n1~v13 e ?
lm,n
3 = ?

lm,n~vm+9.

Com isso obtém-se o total de (k+1)(k+2) funções para a base de um elemento triangular

BK = {?lm,am, ?lm,n, ?
K,n0,n1
1 , ?

K,n0,n1
2 , ?

lm,n
3 }.

33



Figura 3.2: Conjunto de vetores no elemento triangular, [35].

Elementos quadrilaterais Seja BK a base hierárquica (3.16) definida sobre um ele-
mento quadrilateral K ?Th. Considera-se o conjunto de vetores ~v = {~?j, j = 0, ..., 17},
como mostrado na Figura 3.3, tal que

1. Para cada aresta lm, m = 0, 1, 2, 3, tem-se que

(a) ~?2+3m e ~?m+12 são, respectivamente, a normal externa e o vetor tangente a
lm

(b) Para s = 3m, os vetores ~?s e ~?s+1 são tais que ~?s ·~?s+2 = ~?s+2 ·~?s+1 = 1

2. No interior do elemento, ~?16 e ~?17 são ortogonais

Funções de base para um subespaço de Hdiv(K) são dadas por:

• 4(k ? 1) funções de aresta ?lm,am e ?lm,n

m = 0 : ?l0,a0 = ?a0~v0, ?
l0,a1 = ?a1~v1, ?

l0,n = ?l0,n~v2

m = 1 : ?l1,a1 = ?a1~v3, ?
l1,a2 = ?a2~v4, ?

l1,n = ?l1,n~v5

m = 2 : ?l2,a2 = ?a2~v6, ?
l2,a3 = ?a3~v7, ?

l2,n = ?l2,n~v8

m = 3 : ?l3,a3 = ?a3~v9, ?
l3,a0 = ?a0~v10, ?

l3,n = ?l3,n~v11

para n = 0, ..., k ? 2 e k ? 2 o grau máximo dos polinômios.

34



• 2(k2 ? 1) funções internas

?
K,n0,n1
1 = ?

K,n0,n1~v16, ?
K,n0,n1
2 = ?

K,n0,n1~v17 e ?
lm,n
3 = ?

lm,n~vm+12,

com n0,n1,n = 0, ...k ? 2 e k ? 2.

Com isso, obtém-se o total de 2(k+1)2 funções para a base de um elemento quadrilateral

BK = {?lm,am, ?lm,n, ?
K,n0,n1
1 , ?

K,n0,n1
2 , ?

lm,n
3 }.

Figura 3.3: Conjunto de vetores no elemento quadrilateral, [35]

Sendo assim, consideram-se subespaços de elementos finitos Hdiv(T )-conforme, a
serem usados na formulação mista discreta, da forma

Vh = {vh ? Hdiv(?) : vh|K ? spanBK, ?K ?Th, e vh ·n = 0 em ?N} . (3.18)

A condição que garante continuidade das componentes normais de uma função vh ? Vh,
é que a soma dos coeficientes multiplicadores correspondentes às funções de aresta,
comum aos dois elementos vizinhos Ki,Kj ?Th quaisquer (?Ki??Kj 6= ?), seja igual
a zero [35, 60].

35



3.4 Análise de erro

O MEF fornece uma aproximação uh da função procurada u dentro de um subespaço de
aproximação de dimensão finita escolhido. Caso o subespaço de aproximação não seja
adequado, a função aproximada pode não apresentar uma precisão satisfatória. Neste
caso, uma análise para verificar tal precisão é necessária. Para a análise de aproximação
gerada por meio de uma metodologia de elementos finitos considera-se o erro

eh = u?uh , (3.19)

em que u é a solução exata e uh é a solução aproximada.
Os estimadores de erro podem ser baseados em dois grupos: a priori e a posteriori.

As estimativas de erro a priori trazem informações antecipadas sobre a grandeza do
erro e sobre o modo de convergência da solução. De um modo geral, as estimativas a
priori são da forma

? eh ?? C hr, (3.20)

em que C é uma constante que depende dos dados do problema e r é um inteiro
que depende da regularidade da solução e do grau dos polinômios usados na definição
das funções de base utilizadas. O expoente r é uma medida da taxa de convergência
assintótica do erro, com respeito a norma ? · ? escolhida. Além disso, se r &gt; 0, então
o erro ? e ? aproxima-se de zero quando h tende a zero. Um estudo mais aprofundado
do assunto pode ser visto em [61, 62].

Nos casos do MEF usando subespaços H1-conformes, como mostrado em [61],
estimativas a priori são da forma

? u?uh ?L2(?)? Chk+1 e ??u??uh ?L2(?)? Chk. (3.21)

Para a formulação mista, com espaços de aproximação Vh ? Hdiv(?)-conforme e
Wh ? L2(?) LBB consistentes, as estimativas para o problema modelo são do tipo

? u?uh ?L2(?)? Chr e ? q?qh ?L2(?)? Chk+1, (3.22)

com r ? k + 1 usando espaço de Raviart-Thomas e r ? k usando os espaços de Brezzi-
Douglas-Marini, como mostrado em [46].

Um estimador de erro a posteriori é baseado nas informações obtidas durante o
processo de solução e as estimativas de erro podem ser feitas para cada elemento da

36



malha (erro local) ou para toda malha (erro global). Embora este assunto não fazer
parte do estudo proposto, vale ressaltar que o primeiro trabalho de destaque sobre esti-
madores de erro a posteriori foi desenvolvido por BABUSKA [63], em que o estimador
de erro baseia-se nas aproximações da norma de energia do erro em cada elemento K
da malha. Um outro trabalho similar utilizando a norma energia foi desenvolvido por
[64].

3.5 Aplicação numérica

Considera-se o problema modelo (3.13)-(3.14) com condição de contorno homogênea
u = 0, em ??, com ? = [0, 1]2 e f(x,y) = 2?2sen(?x)sen(?y). Cuja solução analítica é
dada por

q(x,y) = ??cos(?x)sen(?y)~i??cos(?x)sin(?y)~j e u(x,y) = sin(?x)sin(?y).

Ilustra-se a seguir a aplicação do MEF misto para este problema. Outras aplicações
para o problema modelo usando as formulações do MEF H1-conforme e do Galerkin
descontínuo são apresentadas no Capítulo 6.

Na formulação variacional mista do problema modelo, os subespaços envolvidos
são do tipo Hdiv-conforme para a variável de grandeza vetorial (o fluxo) e L2 para a
variável de grandeza escalar (a pressão). Para representar o fluxo consideram-se apro-
ximações em Vh como definido em (3.18) enquanto que, a pressão pode ser aproximada
em subespaços Wh de funções descontínuas como indicado em (3.17).

Como descrito na subseção anterior, uma condição fundamental para estabilidade
das aproximações, bem como na obtenção de taxas ótimas de aproximação, é conhecida
como condição LBB (Ladyzenskaya–Babuska–Brezzi) ou condição inf-sup [46]. Esta
condição estabelece um balanceamento ou compatibilidade entre os espaços Vh e Wh
utilizados na formulação mista.

Condição de balanceameno

Para os espaços Vh e Wh descritos anteriormente, a condição LBB não foi provada. No
entanto, a partir de experimentos numéricos em [35], estabeleceu-se este balanceamento
da seguinte forma: para elementos triangulares, toma-se um par de espaço do tipo
PkPk?1 no sentido de que se as funções de Vh são definidas a partir de polinômios

37



de Pk(K?), então Wh são definidas a partir de polinômios em Pk?1(K?). Analogamente,
para elementos quadrilaterais toma-se um par de espaços do tipo Q+k Qk, em que Q

+
k

refere-se ao espaço Vh definido a partir de polinômios de Qk(K?), acrescido de funções
internas de ordem k + 1, enquanto que em Wh as funções são definidas a partir de
polinômios em Qk(K?).

Com os espaços de elementos finitos balanceados Vh ? V e Wh ? L2(?), a
formulação discreta do problema é dada por: encontrar qh ? Vh e uh ? Wh tal que

a(qh,vh) ? b(vh,uh) = 0, ?vh ? Vh,
b(qh,wh) = l2(wh), ?wh ? Wh.

(3.23)

As Figuras 3.4 e 3.5 mostram os resultados numéricos obtidos. Pode-se observar
que, tanto para uma malha triangular quanto para uma quadrilateral, obtém-se a taxa
ótima de convergência para a variável de fluxo. Precisamente, para elementos triangu-
lares as ordens são k + 1 para o fluxo e k para a pressão. Para elementos quadrilaterais,
as taxas de convergência são de ordem k + 1 tanto para o fluxo quanto para a pressão.

æ
æ

æ

æ

æ

à

à

à

à

à

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

0.10 1.000.500.20 0.300.15 0.70

10
-7

10
-5

0.001

0.1

h

°
q
-

q
h
´

L
2

Fluxo

ò k = 4

ì k = 3

à k = 2

æ k = 1

1

2

1

3

1

4

1

5

Figura 3.4: Formulação mista: análise da taxa de convergência do erro para uma malha
uniforme de elementos triangulares utilizando subespaços do tipo PkPk?1. Erros da
pressão (à esquerda) e do fluxo (à direita) na norma L2(?).

38



æ

æ

æ

æ

æ

à
à

à

à

à

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

0.10 1.000.500.20 0.300.15 0.70

10
-7

10
-5

0.001

0.1

h

°
p
-

p
h
´

L
2

Pressão

ò k = 4

ì k = 3

à k = 2

æ k = 1

1

1

1

1

2

3

4

5

æ

æ

æ

æ

æ

à

à

à

à

à

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

0.10 1.000.500.20 0.300.15 0.70

10
-8

10
-6

10
-4

0.01

1

h

°
q
-

q
h
´

L
2

Fluxo

ò k = 4

ì k = 3

à k = 2

æ k = 1

1

1

1

1

5

4

3

2

Figura 3.5: Formulação mista: análise da taxa de convergência do erro para uma malha
uniforme de elementos quadrilaterais utilizando subespaços do tipo Q+k Qk. Erros da
pressão (à esquerda) e do fluxo (à direita) na norma L2(?).

39



40



Capítulo 4

Método da dupla projeção

4.1 Introdução

O MEF é uma das ferramentas de modelagem numérica preferidas em aplicações de
engenharia, o qual tem sido amplamente aplicado e analisado em diferentes contex-
tos. Utilizando a metodologia de Galerkin clássico (também conhecido como método
Bubnov-Galerkin), as propriedades ideais de aproximação podem ser alcançadas para
uma classe de problemas modelos, por exemplo, para problemas de valor de contorno
elípticos lineares com operadores auto-adjuntos. No entanto, em outras situações, como
no contexto de problemas de convecção-difusão, fortes oscilações podem ocorrer nas so-
luções de elementos finitos de Bubnov-Galerkin quando o problema é de convecção
dominante ou quando a malha não for suficientemente refinada.

Uma das várias soluções adotadas para contornar este problema é a utilização
do método SUPG (Streamline Upwind Petrov-Galerkin) [65], que se baseia em uma
relaxação do operador diferencial relacionado à equação diferencial parcial. Ou seja, o
método visa a obtenção de uma formulação variacional consistente com as propriedades
de estabilidade superiores às da formulação original.

Em geral, a referência a um método de Petrov-Galerkin surge numa classe de
modificações para o método de Galerkin, em que os espaços de funções admissíveis e de
funções teste são formados por espaços de funções diferentes entre si [1]. A liberdade
de escolher diferentes espaços de funções teste abre várias possibilidades de novas ferra-
mentas para otimizar o desempenho dos métodos, com base em um determinado espaço
de funções admissíveis. Neste sentido, novos métodos de Petrov-Galerkin, relacionados
à simetrização da forma bilinear da formulação variacional do problema original, foram

41



desenvolvidos.
No contexto das aproximações contínuas, passos importantes foram dados em

[2, 3], em que, a taxa ótima de convergência pode ser recuperada usando funções teste
ótimas. No entanto, as funções teste ótimas, correspondentes à um determinado con-
junto de funções admissíveis, são muitas vezes difíceis de se obter, particularmente em
dimensões maiores do que um.

No contexto das aproximações descontínuas, o método de Petrov-Galerkin foi
explorado inicialmente nos trabalhos de [4, 5, 6]. Recentemente, novos métodos de
Petrov-Galerkin descontínuo (DPG) auto-adptativos foram considerados, em que o
espaço de funções teste é calculado automaticamente, como descrito nos trabalhos
[7, 8, 9, 10, 11, 12, 13, 14]. Usando funções descontínuas, o processo numérico para
calcular as funções teste ótimas é realizado localmente, de forma exata ou aproximada,
usando espaços enriquecidos que contenham o espaço teste ótimo.

No presente trabalho, o foco está em uma abordagem diferente para o método de
Petrov-Galerkin em aproximações pelo MEF contínuo, chamado de método da dupla
projeção de Bubnov-Galerkin, que foi originalmente proposto em [66] e resgatado em
[15]. Tal como indicado pelo seu nome, o método baseia-se em duas projeções. Uma
sobre a soma do espaço gerado pelas funções teste e o espaço gerado pelas funções
admissíveis. A outra projeção está no espaço das funções admissíveis. A principal
vantagem da técnica proposta é que não é preciso se preocupar com a construção ou
aproximação das funções teste ótimas. Como será mostrado, a técnica produz os mes-
mos resultados como se as funções teste ótimas fossem aproximadas numericamente em
um espaço enriquecido.

4.2 Métodos de Petrov-Galerkin

Nessa seção descrevem-se duas metodologias na resolução de problemas de Petrov-
Galerkin com o uso de espaços teste ótimos.

4.2.1 Método de Petrov-Galerkin ótimo via simetrização

Esta é uma classe de métodos, que foram formulados em [2, 3], para problemas de
convecção-difusão estacionários, do tipo

42



???
??
???u + ?· (cu) = f em ?,

u = g em ?D,
?u ·n = 0 em ?N.

(4.1)

Além disso, assume-se que f ? L2(?), o coeficiente de difusão ? é positivo, o campo de
velocidade de convecção c é incompressível (?·c = 0), o contorno de Dirichlet ?D 6= ?
e contém o contorno de entrada de fluxo, ou seja c ·n &amp;lt;0 em ?D e c ·n ? 0 em ?N.

Para g ? H1/2(?D), seja uD ? H1(?) tal que uD = g em ?D. Definem-se o espaço
de funções teste U e o conjunto de funções admissíveis, respectivamente,

U =
{
v ? H1(?) : v = 0 em ?D

}
e uD + U. (4.2)

Assim, a fórmulação variacional do problema (4.1) é dada por{
encontrar u ? uD + U tal que
a(u, v) = l(v), v ? U,

sendo
a(u,v) =

ˆ
?

??u ·?v dx +
ˆ

?

?· (cu)v dx e l(v) =
ˆ

?

f v dx.

No método de Galerkin padrão tomam-se o subespaço de funções teste Un ? U
de dimensão finita e resolve-se o problema: encontrar un ? uD + Un tal que

a(un, vn) = l(vn), vn ? Un. (4.3)

Para o caso de difusão pura (c = 0), se un é a solução do problema discreto (4.3),
o método produz estimativas de erro ótimas na norma energia, proveniente da forma
bilinear,

? u?un ?a= inf
w?uD+Un

? u?w ?a .

No entanto, na configuração advecção-difusão, fortes oscilações podem ocorrer nas solu-
ções de elementos finitos de Galerkin quando o problema é de convecção dominante, ou
seja, para valores elevados do número de Péclet Pe =? c ? h/? [2, 3]. Esta dificuldade
pode ser contornada no cenário de Petrov-Galerkin, usando funções teste apropriadas,
baseado no método da simetrização [2, 3]. A ideia do método é definir uma forma
bilinear b(·, ·) em U ×U que seja contínua, coerciva e simétrica para construir as bases
dos subespaços de funções teste ótimas.

43



Pelo teorema da representação de Riez existe um operador R : U ? U, chamado
operador de simetrização, tal que

a(w,Rv) = b(w,v), ?v, w ? U.

Considere o subespaço de funções Un ? U dado por

Un = span{?i, i = 1, ..., n} .

Assim, o método de Petrov-Galerkin baseado na simetrização [2, 3] é dado por:

1. Para cada função de base ?i ? Un, encontre ?i = R?i ? U, resolvendo o seguinte
problema: encontrar ?i ? U tal que

a(w,?i) = b(w,?i), ?w ? U. (4.4)

Construir o subespaço teste ótimo Xn ? U,

Xn = span{?i, i = 1, ..., n} .

2. Resolver o problema discreto de Petrov-Galerkin{
encontrar u?n ? uD + Un tal que
a(u?n, vn) = l(vn), ?vn ? Xn.

(4.5)

Se u ? uD + U é a solução exata de (4.1) e u?n ? uD + Un, é a solução do problema de
Petrov-Galerkin (4.5), observando que u?un ? U, de (4.4) e (4.5) segue que

0 = a(u?u?n,?i) = b(u?u
?
n,?i), ?i = 1, ... n.

Portanto, o erro na aproximação de Petrov-Galerkin (4.5) satisfaz a propriedade de
ortogonalidade

b(u?u?n,vn) = 0, ?vn ? Un. (4.6)

Assim, na norma induzida por b(·, ·), a propriedade de aproximação ótima é mantida

? u?u?n ?b= inf
w?uD+Un

? u?v ?b .

44



Ou seja, a taxa de convergência ótima é recuperada, na norma induzida por b(·, ·), para
o método Petrov-Galerkin com funções teste ótimas.

De acordo com [2, 3], a forma bilinear b(·, ·) não precisa ter nenhum forma es-
pecífica. O objetivo é de melhorar a qualidade das soluções aproximadas através de
subespaços de funções teste ótimas Xn e obter melhores estimativas de erro.

Método da simetrização aproximada

Na maioria das aplicações, exceto para alguns problemas unidimensionais ou bidimen-
sionais específicos, as funções teste ótimas ?i são impossíveis de serem calculadas anali-
ticamente [2, 3]. A alternativa natural, nesses casos, é calcular aproximações numéricas
?i. Na prática, a primeira etapa do método da simetrização (4.4) é feita de maneira
aproximada. Para cada função de base ?i ? Un, calcula-se ?i ? Ur em um espaço
enriquecido Ur ? U, resolvendo-se

a(vr, ?i) = b(vr,?i), ?vr ? Ur, (4.7)

e constrói-se um novo subespaço de funções teste ótimas aproximadas

Xrn = span{?i, i = 1, ..., n} .

Na segunda etapa do método, em (4.5), calcula-se a solução de Petrov-Galerkin urn ?
uD + Un usando as funções teste aproximadas, ou seja{

encontrar urn ? uD + Un tal que
a(urn, vn) = l(vn), ?vn ? Xrn.

(4.8)

4.2.2 Método de Petrov-Galerkin descontínuo ótimo

Uma metodologia similar ao método da simetrização foi desenvolvida em [7, 8, 10, 11,
12], no contexto do método de Petrov-Galerkin descontínuo (DPG). O método DPG é
descrito a partir de uma formulação variacional abstrata, como descrito na Seção 2.5,{

encontrar u ? uD + U tal que
a(u, v) = l(v) para todo v ? V

(4.9)

em que, U ? X, X e V são espaços de Hilbert e l ? V ?.

45



O método DPG considera um operador T : X ? V definido para todo u ? U,
sendo Tu ? V a solução única de

a(u,v) = (Tu,v)V , ?v ? V, (4.10)

em que (·, ·)V : V ×V ? R é algum produto interno em V .

Descrição do método DPG. Dados os subespaços Un ? U e Vn ? V e o operador
T , como definido em (4.10), o método DPG consiste em:

1. Definir o espaço teste ótimo Xn = T(Un), tal que

a(un,vn) = (Tun,vn)V , ?vn ? Vn.

2. Resolver o problema de Petrov-Galerkin: encontrar u?n ? uD + Un tal que

a(u?n,vn) = l(vn), ?vn ? Xn. (4.11)

Neste contexto ideal, o erro ótimo na aproximação de Petrov-Galerkin (4.11) é igual ao
melhor erro de aproximação na norma energia,

? u?u?n ?E= inf
w?Un

? u?w ?E,

em que
? u ?E= sup

?v?V =1
a(u,v) =? Tu ?V .

Método DPG aproximado

Como no método da simetrização, o método DPG não é implementado exatamente.
Faz-se uma aproximação do operador T definido em (4.10). O método considera um
espaço enriquecido Vr ? V e uma aproximação Tr para o operador T , Tr : U ? Vr tal
que a(u,vr) = (Tru,vr).

Descrição do método DPG aproximado. Na prática, dado um subespaço admis-
sível Un ? U gerado por funções de base ej ? U, j = 1, . . . ,n, o método DPG consiste
em:

46



1. Definir um produto interno em V, (·, ·)V : V ×V ? R

2. Para cada base admissível ej, resolver o problema variacional:{
encontrar e?j = Tej ? V tal que
a(e?j, vr) = (ej,vr)V ?vr ? Vr,

sendo Vr ? V um subespaço enriquecido com dim(Vr) ? dim(Un).
Construir o subespaço teste ótimo aproximado Xrn ? V ,

Xrn = {e?i, i = 1, ..., n} .

3. Resolver o problema discreto de Petrov-Galerkin descontínuo{
encontrar urn ? uD + Un, tal que
a(urn, vn) = l(vn) ?vn ? Xrn.

De acordo com os autores [7, 8, 10, 11, 12], não existe uma forma universal na escolha
de Vr. Apenas, deve-se garantir que a dimensão de Vr seja maior ou igual à de Un. A
motivação é que, quanto mais rico for o espaço Vr, o método discreto herdará cada vez
mais a propriedade de estabilidade do problema. Na prática, se elementos de ordem
k são usados em Un, o espaço teste enriquecido Vr pode conter polinômios de ordem
k + ?k, ?k ? N.

Comentário. Os métodos do tipo Petrov-Galerkin descritos anteriormente oferecem,
teoricamente, ótimos resultados de aproximação. No entanto, computacionalmente são
muito caros. No processo de calcular as funções teste ótimas aproximadas resolvem-se n
sistemas lineares mr×mr, sendo mr ? n a dimensão do espaço enriquecido. Além disso,
após o cálculo das funções teste ótimas aproximadas, deve-se resolver um problema de
Petrov-Galerkin discreto para resolução do problema.

4.3 Método da dupla projeção (MDP)

Nesta seção, mostra-se que a solução u?n ? uD + Un, via o método da simetrização
aproximada, descrito na Seção 4.2.1 para o problema de convecção-difusão, pode ser

47



calculada através da utilização de duas aproximações (projeções) de Galerkin. A essa
nova técnica dá-se o nome de método da dupla projeção (MDP), que é descrito a seguir.

Método MDP. Seja Ur o subespaço enriquecido usado na aproximação do subespaço
teste ótimo Xrn = span{?i, i = 1, ..., n}? Ur. O MDP consiste em:

1. Encontrar u?r ? uD + Ur tal que

a(u?r,vr) = l(vr), ?vr ? Ur. (4.12)

2. Encontrar u?n ? uD + Un, tal que

b(u?r ? u?n,vn) = 0, ?vn ? Un. (4.13)

Teorema 4.1. (Método da dupla projeção ? Método da simetrização aproximada)
Sejam urn e u?n as soluções de (4.8) e (4.13), respectivamente. Tem-se que

u?n = u
r
n.

Demonstração. Seja o subespaço teste ótimo Xrn o subespaço enriquecido. Como X
r
n ?

Ur, pela propriedade da ortogonalidade, tem-se

a(u?r ?urn,vr) = 0, ?vr ? X
r
n.

Tomando vr = ?i, pela condição (4.4) tem-se

0 = a(u?r ?urn, ?i) = b(u?r ?u
r
n,?i), ??i ? Un. (4.14)

Assim, tem-se que

0 = b(u?r ?urn,?i) = b(u?r ? u?n + u?n ?urn,?i)
= b(u?r ? u?n,?i) + b(u?n ?urn,?i)
= b(u?n ?urn,?i), ??i ? Un.

Portanto, conclui-se que u?n ?urn ? Un satisfaz

b(u?n ?urn,vn) = 0, ?vn ? Un

48



e, consequentemente, u?n = urn.

O Teorema 4.1 mostra que há uma equivalência entre o MDP e o método da simetrização
aproximada. No entanto, o MDP tem as seguintes vantagens:

• Computacionalmente, o MDP é mais barato que os métodos de simetrização apro-
ximada.

• O MDP necessita apenas de duas aproximações de Galerkin, uma no espaço en-
riquecido e outra no espaço original.

• O método de Galerkin é mais fácil de se programar do que os métodos Petrov-
Galerkin.

4.4 Experimento numérico

Nesta seção, resolve-se um problema de convecção-difusão unidimensional, em estado
estacionário, como parte de verificação na utilização do método da dupla projeção.

Problema teste

Seja o problema de convecção-difusão unidimensional,???
??
??(u?)? + cu? = 0 em ? = (0, 3),

u = g em ??,
(4.15)

em que g(0) = 10, g(3) = 0 e cuja solução analítica é dada por

u(x) = 10
1 ?e

c
?
(x?3)

1 ?e?3
c
?

.

Sejam U e g + U, respectivamente, o espaço de funções teste e o conjunto de
funções admissíveis definidos como em (4.2). O subespaço de dimensão finita Un ? U,

Un = span{?i, i = 1, ..., n} ,

49



é formado por funções nodais, ?i(xj) = 1 para i = j e 0 para i 6= j, lineares por partes

?i(x) =

?????
????

x?xi?1
hi

em x ? [xi?1,xi],

xi+1 ?x
hi+1

em x ? [xi,xi+1],

e com hi = xi ?xi?1, i = 1, ..., n.
De acordo com [2], a partir do método da simetrização (4.4) e definindo-se a forma

bilinear
b(u,v) =

ˆ
?

?u?v?dx,

as funções teste ótimas ?i, calculadas analiticamente, são dadas por

?i(x) =

??????
?????

1 ?e?
c
?
(x?xi?1)

1 ?e?
c
?
hi

em x ? [xi?1,xi],

e?
c
?
(x?xi) ?e?

c
?
hi+1

1 ?e?
c
?
hi+1

em x ? [xi,xi+1],

(4.16)

Deste modo, Xn = span{?i, i = 1, ..., n} é o espaço teste ótimo relacionado às funções
de Vn. Estas funções ?i são também funções nodais e são conhecidas como funções
exponenciais de Hemker [67].

Resultados numéricos

O problema foi resolvido usando o MEF contínuo (MEF-C), o método de Petrov-
Galerkin via simetrização (PG) e o método da dupla projeção (MDP). O espaço enri-
quecido, utilizado na primeira etapa do método da dupla projeção, contém o espaço de
funções teste acrescentado por uma função bolha dada pela combinação linear entre as
funções teste ?i e as funções teste ótimas ?i, ou seja,

Ur = Un ?{?i(x) ??i(x), x ? [xi?1,xi]}.

A Figura 4.1 mostra os resultados numéricos, em uma malha fixa com espaçamento
h = 3/32, para vários valores do número de Péclet Pe = c×h/?, em que c = 10?1, ? =
1, 10?1, 10?2, 10?3 e 10?4. Nota-se que a solução numérica obtida pelo MEF apresenta
fortes oscilações com o aumento de Pe. Além disso, em todas considerações, o MDP

50



apresenta a mesma solução numérica do método de Petrov-Galerkin via simetrização
(PG). Para o caso de menor difusão ? = 10?4, mesmo refinando a malha, a solução
numérica pelo MEF contínuo apresenta fortes oscilações, enquanto que com PG e MDP
a precisão melhora consistentemente, o que pode ser observado na Figura 4.2.

é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

é MEF-C

Exata

Pe = 9.375´10
-3

é é é é é é é é é é
é
é
é
é
é
é
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

é

õ õ õ õ õ õ õ õ õ õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ
õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

é MEF-C

Exata

Pe = 9.375´10
-2

é é é é é é é é é é é é é é é é é é é é é é é é é é é é é
é

é

é

é

õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ
õ

õ

õ

õ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

é MEF-C

Exata

Pe = 9.375´10
-1

é é é é é é é é é é é é é é é é é é é é é é é
é
é

é

é

é

é

é

é

é

é

õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

5

10

15

õ MDP

PG

é MEF-C

Exata

Pe = 9.373

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

5

10

15

20

25

é MEF-C

Exata

Pe = 9.375´10
1

õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ õ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

Exata

Pe = 9.375´10
1

Figura 4.1: Soluções numéricas pelos métodos MEF-C, de Petrov-Galerkin via simetri-
zação (PG) e da dupla projeção (MDP). Considaram-se vários valores do número de
Péclet Pe = c×h/?, em que h = 3/32, c = 10?1 e variam-se os valores de ?.

51



ééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

5

10

15

é MEF-C

Exata

h = 3?64

õõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

Exata

h = 3?64

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

5

10

15

é MEF-C

Exata

h = 3?128

õõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõõ

õ

0.0 0.5 1.0 1.5 2.0 2.5 3.0

0

2

4

6

8

10

õ MDP

PG

Exata

h = 3?128

Figura 4.2: Soluções numéricas pelos métodos MEF-C, de Petrov-Galerkin via sime-
trização (PG) e da dupla projeção (MDP). Considera-se convecção dominante, com
c = 10?1, ? = 10?4 e malhas com refinamentos h = 3/64 e h = 3/128.

52



Capítulo 5

MEF contínuo-descontínuo

5.1 Introdução

No presente capítulo, descreve-se uma abordagem combinada MEF contínuo-descontínuo
(MEF CD), na qual o MEF contínuo e a formulação de Galerkin descontínuo (GD) são
usados na mesma simulação. O objetivo é fazer a melhor utilização das vantagens de
cada método, obtendo-se melhores resultados, usando elementos descontínuos perto de
singularidades e elementos contínuos em outras partes, em regiões de solução suave.
Desse modo, obtém-se a robustez do método de Galerkin descontínuo com um número
reduzido de graus de liberdade, como discutido em [16, 17, 18, 19]. Como aplicação do
MEF CD, resolve-se o problema de Girkmann (um problema de mecânica dos sólidos).

O problema de Girkmann é um modelo matemático, representado por um pro-
blema elástico linear, para uma casca fina axissimétrica apoiada sobre um anel de
reforço, igualmente axissimétrico. A geometria da junção entre a casca e o anel implica
em um comportamento singular da solução elástica, próximo a esta região. Este pro-
blema foi primeiro descrito por Girkmann, em 1956 [20], e mais tarde por Timoshenko,
em 1959 [21], em que as soluções, através de métodos clássicos, são apresentadas. Uma
recente análise detalhada da solução clássica para o problema foi publicada em [68].

Em janeiro de 2008, a Associação Internacional de Mecânica Computacional
(IACM) convidou a comunidade científica para resolver o problema de Girkmann pelo
método MEF. O desafio foi obter certas quantidades de interesse, representadas por
funcionais lineares, em termos das soluções aproximadas dentro de 5% de precisão. Vá-
rios trabalhos foram feitos, todos usando o MEF contínuo, em resposta à chamada feita
pela IACM. Esses resultados encontram-se resumidos em [22], publicado em 2009. Em

53



um trabalho mais recente [23], fez-se uma análise do problema nas versões h e hk do
MEF.

Devido à singularidade na junção casca-anel, o MEF clássico (contínuo) pode
encontrar sérias deficiências. O método de Galerkin descontínuo mostra ser bastante
preciso e robusto na resolução de problemas em que fortes gradientes estão presentes.
Sob este ponto de vista, o método GD torna-se uma ferramenta promissora para resolver
o problema de Girkmann. Além disso, o grande atrativo na utilização do método GD
em problemas de elasticidade é a garantia da conservação local elemento por elemento.
Fato importante quando se pretende obter soluções aproximadas de alguma quantidade
interesse em função do tensor de tensões. No entanto, uma desvantagem dos métodos
GD é a grande quantidade de graus de liberdade requeridos, em comparação com MEF
contínuo. Sendo assim, propõe-se a resolução do problema de Girkmann utilizando a
metodologia combinada MEF CD. Os resultados deste capítulo foram publicados em
[24].

5.2 MEF CD para elasticidade linear

Considere o problema de elasticidade linear

??·? = b em ?,
u = uD em ?D,

? ·n = uN em ?N,
(5.1)

em que u = (u1,u2,u3) é o deslocamento, ? = ?(u) = [?ij] é o tensor de tensão, b é a
força de volume, ?D e ?N são os contornos de Dirichlet e Neumann, respectivamente,
uD e uN são funções dadas e n é a normal externa à ?N. Definindo o tensor de
deformação ?(u) = (?u + ?uT )/2, a lei constitutiva que relaciona os tensores de
tensão e deformação é dada por

?(u) = ?tr?(u)I + 2µ?(u),

em que I é o tensor identidade, tr?(u) =
?

i ?ii e ? and µ são as constantes de Lamé.
Faz-se a seguir a sua formulação variacional considerando o método FEM CD.

Antes, destacam-se as formulações para o MEF contínuo e para o MEF descontínuo.

54



5.2.1 Formulação MEF contínuo

Definem-se o espaço de funções teste e o conjunto de funções admissíveis, respectiva-
mente,

U =
{
v ? [H1(?)]2 tal que v = 0 em ?D

}
e uD + U.

A formulação variacional para o problema de elasticidade linear (5.1) é dada por: en-
contrar u ? uD + U tal que

A(u,v) = F(v), ?v ? U,

sendo

A(u,v) =

ˆ
?

tr
(
?vT?(u)

)
dx e F(v) =

ˆ
?

b ·v dx +
ˆ

?N

v ·uNds. (5.2)

5.2.2 Formulação MEF descontínuo

Dado uma partição T de ?, seja V o espaço de Sobolev particionado definido por

V =
{
u ? [L2(?)]2; u|K ? [H2(K)]2, ?K ?T

}
.

Define-se o subespaço de elementos finitos Vh ? V,

Vh = (Vh)
2
,

em que Vh, definido em (3.17), é o subespaço de elementos finitos particionado para o
caso escalar.

O MEF descontínuo para o problema de elasticidade linear (5.1) é dado por:
encontrar uh ? Vh tal que

B(uh,vh) = F(vh), ?vh ? Vh,

em que

B(u,v) = A(u,v) ?J(u,v) + ?J(v,u) + ?L(u,v),

F(v) = F(v) + ?J(v) + ?L(v),

55



tais que

A(u,v) =
?
K?T

ˆ
K

tr
(
?vT?(u)

)
dx,

J(u,v) =

ˆ
?int??D

??(u)n? · [v] ds,

L(u,v) =

ˆ
?int??D

[u] · [v] ds,

J(v) =

ˆ
?int??D

??(v)n? ·uDds,

L(v) =

ˆ
?int??D

[v] ·uDds

e F(v) é como na Equação (5.2).
Assim, como no caso do problema modelo da Seção 3.2.2, para ? = ?1 e ? = 0

tem-se a formulação simétrica não penalizada, para ? = 1 e ? = 0 tem-se a formulação
não-simétrica sem penalização. A formulação simétrica com penalização SIPG usa
? = ?1 e ? &gt; 0 e a formulação não-simétrica com penalização NIPG tem ? = 1 e ? &gt; 0.

5.2.3 Formulação MEF CD

Define-se abaixo a formulação variacional utilizando o método MEF CD. Seja a decom-
posição do domínio

? = ?
i=S,R

?i,

com ?? ? Rd?1 tal que

?? = ?R ? ? = ?S ? ?,

como mostra a Figura 5.1. Além disso, sejam TR e TS partições para cada um dos
subdomínios ?R e ?S.

Sejam o espaço de funções teste

VCD =
{
v ? [L2(?)]d; v|?i ? [H

2(?i)]
d, i = R,S, tal que v = 0 em ?D

}

56



??

?
R

?
S

Figura 5.1: Partição do domínio ? em ?S e ?R.

e o subespaço de aproximação VCDh ? V
CD, dado por

VCDh =
{
u ? VCD : u|?i ? (U(?i))

2
, i = R, S

}
,

em que U(?i) são subespaços de elementos finitos H1-conformes em ?i. Observa-se que
as funções em VCD podem ser descontínuas em ??.

O MEF CD do problema de elasticidade linear (5.1) é dado por: encontrar uh ?
uD + V

CD
h tal que

A(uh,vh) = F(vh), ?vh ? VCDh , (5.3)

em que

F(v) =

ˆ
?

b ·v dx +
ˆ

?N

v ·uNds,

A(u,v) = X(u,v) ?J?(u,v) + ?J?(v,u) + ?L?(u,v),

tais que

X(u,v) =
?
i=S,R

ˆ
?i

tr
(
?vT?(u)

)
dx,

J?(u,v) =

ˆ
??

??(u)n? · [v] ds

e
L?(u,v) =

ˆ
??

[u] · [v] ds.

57



Nas aproximações via MEF descontínuo, as soluções aproximadas podem ser des-
contínuas em todas as interfaces entre os elementos K ?T . Diferentemente, as soluções
via MEF CD as soluções aproximadas devem ser contínuas nas arestas ?K ? ? \ ?? e
descontínuas em ??. Além disso, observa que a condição de contono é aplicada forte-
mente em ?D. Neste sentido, o método MEF CD pode ser visto como um caso particu-
lar do método MEF descontínuo correspondente. Portanto, espera-se que a formulação
discreta proposta, MEF CD, herda as propriedades de estabilidade e convergência do
método MEF descontínuo correspondente.

5.3 Problema de Girkmann

O problema de Girkmann é resolvido em um modelo axissimétrico utilizando o método
MEF CD proposto. Considera-se uma interface ?? unidimensional para representar a
região de interesse (a junção entre a casca e o anel de enrijecimento). Denota-se por
?S o domínio ocupado por uma casca esférica (spherical shell) e por ?R por um anel
de enrijecimento (stiffening ring), conforme Figura 5.2. A seguir, seguem a descrição
do problema e alguns resultados numéricos obtidos de [69, 24].

?
R

?
S

??

Rc

r

z

?
R

?
S

??

r

z

?n = ?o 

A B

uz= g

ur= 0

?n = 0
?n = 0

?n = 0
?n = 0

?n = 0

?n = 0

D

Figura 5.2: Geometria axissimétrica para o problema de Girkmann e condições de
contorno.

58



5.3.1 Descrição do problema

O problema está descrito de acordo com [22]. A geometria do problema e a notação para
os principais parâmetros são introduzidos na Figura 5.2, em que o domínio, as forças e
as condições de apoio são axissimétricos e o eixo z é o eixo de simetria rotacional.

Uma casca esférica de espessura h = 0, 06 m e raio de coroa Rc = 15, 00 m
está conectada a um anel de enrijecimento no ângulo meridional ? = 2?/9 (40o). As
dimensões do anel são: a = 0, 60 m, b = 0, 50 m. O raio da superfície média da casca
esférica é Rm = Rc/ sin(?). A casca é feita de concreto, supostamente homogêneo,
isotrópico e linearmente elástico, com o módulo de Young E = 20, 59 GPa e coeficiente
de Poisson ? = 0.

Consideram-se que:

• As forças de carregamento são devido apenas a gravidade. O peso unitário do
material (homogêneo), composto da casca e do revestimento, é 32, 69 kN/m3.

• A pressão normal uniforme pAB (força distribuida) age sobre a base AB do anel
de enrijecimento. A resultante de pAB é igual ao peso da estrutura.

Os objetivos de cálculo são os seguintes:

1. Encontrar a força de cisalhamento Q? em unidades de kN/m e o momento fletor
M? nas unidades de Nm/m atuando na junção entre a casca esférica e o anel de
enrijecimento.

2. Verificar se os resultados são precisos dentro de 5% de precisão.

De acordo com [22], o problema é determinado estaticamente com respeito às forças
atuando na direção vertical, pressão pAB atuando sobre a base do anel ?AB. Se o peso
unitário do anel é considerado leve, então a força distribuída uniformemente atuando
sobre a base do anel é pAB = 27, 256 kPa. Se o peso unitário do anel for assumido ser
igual ao da casca, então, pAB = 43, 553 kPa.

Usando coordenadas cilíndricas, r, z e %, para o modelo axissimétrico o tensor de
tensão é dado por

? =

?
?? ?r ?rz 0?rz ?z 0

0 0 ?%

?
?? ,

59



em que

?r = (2µ + ?)
?ur
?r

+ ?

(
?uz
?z

+
ur
r

)
, ?z = (2µ + ?)

?uz
?z

+ ?

(
?ur
?r

+
ur
r

)
,

?rz = µ

(
?ur
?z

+
?uz
?r

)
, ?% =

2µ

r
ur + ?

(
?ur
?r

+
?uz
?z

+
ur
r

)
.

Portanto, a força de cisalhamento e o momento fletor são dados, respectivamente, pelos
funcionais

Q? =
1

Rc

ˆ h
2

?h
2

(Tr sin ? + Tz cos ?)rds e M? =
1

Rc

ˆ h
2

?h
2

(Tz sin ??Tr cos ?)srds,

em que as componentes de tração de superfície são

Tr = ?rnr + ?rznz e Tz = ?rznr + ?znz,

e n = (?r,?z) é a normal externa de ?S para ??.
Nota-se que, assumindo modelo axissimétrico, a solução u não depende do ângulo

%, u = u(ur,uz) e os termos relacionados a % podem ser eliminados na equação da
elasticidade linear. Portanto, o problema reduz-se a um caso bidimensional, em que o
domínio ? é formado por duas partes: as seções transversais da casca ?S e do anel ?R,
as quais estão ligadas pela jução casca-anel ??, em que ? indica o ângulo da junção.

5.3.2 Resultados numéricos

Todos os testes foram feitos na formulação não-simétrica proposta por [53], sem pena-
lização. Ou seja, a formulação MEF CD com os parâmetros ? = 1 e ? = 0. De modo
que a propriedade de conservação local do método descontínuo é garantida.

A implementação computacional da formulação MEF CD é feita no ambiente
NeoPZ. A geometria do problema é representada exatamente por elementos curvos ao
longo da casca [70, 71]. A fim de melhorar a precisão e eficiência, utilizam-se elementos
geométricos curvos ao longo da casca, refinamento direcional [72] na junção casca-anel
e aproximação polinomial de alta ordem.

Considerando-se o MEF CD com subespaço VkCD(T ) com funções polinomiais de
ordem k, 2 ? k ? 8, dois tipos de partições do domínio são utilizadas: sem e com
refinamento direcional perto de ??, como ilustrado na Figura 5.3. A malha sem refina-

60



mento direcional consta de dois elementos quadrilaterais na região do anel e de 160 ele-
mentos quadrilaterais curvos distribuídos uniformemente na região da casca (conforme
exemplifica-se na Figura 5.3 (a)). Outras duas malhas com refinamento direcional são
também consideradas, tal como indicado nas Figuras 5.3 (b) e (c).

(a)

(b) (c)

Figura 5.3: Malhas geométricas utilizadas no problema de Girkmann. (a) Sem refina-
mento direcional, (b) e (c) com refinamento direcional.

O problema foi resolvido considerando duas configurações referentes às proprieda-
des do anel e da casca: supondo anel com peso unitário leve e outra assumindo anel e
casca com o mesmo peso unitário. Na Tabela 5.1 descrevem-se os valores das condições
de contorno e da força de volume para estes dois casos.

Os resultados numéricos obtidos são apresentados e comparados com os da formu-
lação MEF contínuo e com outros resultados das literaturas estudadas. Os resultados
mostram uma convergência consistente de ambos os lados da junção casca-anel, a partir
das malhas com refinamento direcional, e com alta ordem de precisão. Nota-se que os
resultados obtidos utilizando MEF CD foram superiores aos resultados obtidos a partir
do MEF contínuo, principalmente no cálculo da força de cisalhamento. Comparando a

61



técnica MEF CD com outros modelos da literatura [22, 23] a técnica fornece excelentes
resultados e com a vantagem de não utilizar técnicas de pós-processamento, ou seja, os
resultados foram obtidos por integração numérica direta. Outros resultados referentes
ao método MEF CD são encontrados em [69, 24].

Restrições do problema Anel leve Anel-Casca
? ·n = ?o em ?AB ?o = 27, 256 kPa ?o = 43, 553 kPa

? ·n = 0 em ?? ? ?AB 0 0

u = uD no ponto D de ?R ur = 0, uz = 10?3 m ur = 0, uz = 10?3 m

b =

(
fr
fz

)
em ?S =

(
0

?32, 69 kN/m3
)

=

(
0

?32, 69 kN/m3
)

b =

(
fr
fz

)
em ?? =

(
0

?32, 69 kN/m3
)

=

(
0

?32, 69 kN/m3
)

b =

(
fr
fz

)
em ?R =

(
0
0

)
=

(
0

?32, 69 kN/m3
)

Tabela 5.1: Valores das condições de contorno e da força de volume.

Para os estudos de convergência, usa-se como referência a solução numérica, pelo
MEF CD, obtida a partir de uma simulação com ordem polinomial k = 9 em uma
malha refinada direcionalmente do tipo mostrado na Figura 5.3 (c) e com a região da
casca formada por 200 elementos quadrilaterais curvos distribuídos uniformemente.

5.3.2.1 Caso I: Anel leve

Para esta configuração, os resultados de referência (malha mais refinada e k = 9) para
a força de cisalhamento e momento fletor na junção casca-anel são, respectivamente,

Q? = 943, 65071 N/m e M? = ?36, 792031 Nm/m.

Note que no método clássico de Pitkäranta [22] a força de cisalhamento e o momento
fletor são Q? = 942, 5 N/m e M? = ?37, 45 Nm/m.

Os resultados apresentados nas Tabelas 5.2-5.4 correspondem às simulações dos
métodos MEF contínuo e MEF CD sobre as malhas mostradas nas Figuras 5.3 (a)-(c),
respectivamente. Em que mostram-se os resultados de convergência das quantidades

62



QS?, M
S
? e Q

R
?, M

R
? , obtidos, respectivamente, pela integração numérica dos resultados

provenientes dos lados casca (shell) e anel (ring) da região de interesse. Nas tabelas,
k corresponde ao grau polinomial e DOF refere-se ao número de graus de liberdade.
Observa-se que com a malha da Figura 5.3 (c) obtém-se resultados mais confiáveis.
Assim, utilizando essa malha, a Tabela 5.5 mostra os resultados para os erros relativos
er dos valores médios ?Q?? = (QS? + QR? )/2 e ?M?? = (MS? + MR? )/2, em relação à
solução de referência.

MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1630 2904, 2 ?598, 31 8, 927 ?21, 97 1640 3538, 6 ?1648, 3 ?1, 894 ?69, 79
3 3416 1137, 6 ?806, 11 ?34, 08 ?28, 53 3430 2327, 3 ?438, 87 ?42, 73 ?31, 43
4 5850 1021, 3 ?748, 56 ?36, 12 ?37, 00 5868 2243, 2 ?355, 43 ?40, 98 ?33, 12
5 8932 1015, 4 ?572, 11 ?36, 27 ?44, 53 8954 2141, 5 ?254, 00 ?35, 35 ?38, 68
6 12662 1007, 9 ?333, 36 ?36, 37 ?50, 31 12688 1970, 5 ?83, 045 ?30, 24 ?43, 71
7 17040 998, 86 ?62, 227 ?36, 46 ?54, 00 17070 1760, 3 127, 07 ?26, 74 ?47, 14
8 22066 989, 65 179, 83 ?36, 54 ?55, 95 22100 1564, 7 322, 64 ?24, 82 ?48, 99

Tabela 5.2: Anel leve: convergência das quantidades de interesse obtidas pela solução
numérica em ambos os lados da junção, usando a malha da Figura 5.3 (a).

MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1770 1114, 7 480, 65 ?36, 49 ?44, 87 1780 1294, 8 593, 74 ?31, 62 ?42, 69
3 3710 1008, 3 894, 17 ?36, 71 ?44, 68 3724 988, 27 899, 15 ?32, 39 ?41, 33
4 6354 983, 75 1026, 6 ?36, 75 ?40, 94 6372 907, 74 979, 60 ?35, 00 ?38, 63
5 9702 969, 84 1037, 3 ?36, 77 ?38, 37 9724 904, 34 982, 97 ?36, 34 ?37, 27
6 13754 961, 85 1015, 2 ?36, 77 ?37, 19 13780 917, 49 969, 82 ?36, 81 ?36, 79
7 18510 956, 94 992, 82 ?36, 78 ?36, 74 18540 928,59 958, 72 ?36, 92 -36,68
8 23970 953, 72 976, 89 ?36, 79 ?36, 61 24004 935, 35 951, 95 ?36, 92 ?36, 67

Tabela 5.3: Anel leve: convergência das quantidades de interesse obtidas pela solução
numérica em ambos os lados da junção, usando a malha da Figura 5.3 (b).

63



MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1810 1010, 2 826, 31 ?36, 90 ?42, 68 1820 1023, 1 865, 68 ?33, 63 ?40, 79
3 3794 965, 97 997, 56 ?36, 81 ?39, 40 3808 918, 55 968, 98 ?35, 76 ?37, 98
4 6498 954, 44 997, 02 ?36, 80 ?37, 35 6516 921, 49 965, 88 ?36, 74 ?36, 91
5 9922 949, 52 973, 52 ?36, 80 ?36, 74 9944 933, 94 953, 38 ?36, 90 ?36, 70
6 14066 947, 18 958, 66 ?36, 80 ?36, 65 14092 940, 14 947, 17 ?36, 89 ?36, 71
7 18930 945, 93 951, 08 ?36, 80 ?36, 67 18960 942, 76 944, 55 ?36, 85 ?36, 74
8 24514 945, 22 947, 44 ?36, 80 ?36, 71 24548 943, 65 943, 65 ?36, 83 ?36, 76

Tabela 5.4: Anel leve: convergência das quantidades de interesse obtidas pela solução
numérica em ambos os lados da junção, usando a malha da Figura 5.3 (c).

MEF CD
k DOF ?Q?? [N/m] er(Q?)(%) ?M?? [Nm/m] er(M?)(%)
2 1820 944,395 7, 9×10?2 ?37, 207 1, 1
3 3808 943,766 1, 2×10?2 ?36, 872 2, 2×10?1

4 6516 943,683 3, 5×10?3 ?36, 821 7, 9×10?2

5 9944 943,660 1, 0×10?3 ?36, 805 3, 5×10?2

6 14092 943,654 3, 4×10?4 ?36, 799 1, 8×10?2

7 18960 943,652 1, 1×10?4 ?36, 796 1, 0×10?2

8 24548 943,650 8, 0×10?5 ?36, 794 5, 3×10?3

Tabela 5.5: Anel leve: erros relativos das quantidades de interesse com respeito à
solução de referência utilizando a malha da Figura 5.3 (c).

5.3.2.2 Caso II: Anel e casca com o mesmo peso

Os resultados de referência (malha mais refinada e k = 9) para a força de cisalhamento
e momento fletor na junção casca-anel são, respectivamente,

Q? = 949, 26605 N/m e M? = ?40, 875581 Nm/m.

Usando o método clássico de Pitkäranta [22], os valores das quantidade de interesse são
Q? = 943, 8 N/m e M? = ?41, 12 Nm/m.

Os resultados apresentados nas Tabelas 5.6-5.8 correspondem às simulações dos
métodos MEF contínuo e MEF CD sobre as malhas mostradas nas Figuras 5.3 (a)-(c),
respectivamente. Como no caso anterior, a malha da Figura 5.3 (c) oferece melhores
resultados. Assim, utilizando essa malha, a Tabela 5.9 mostra os resultados para os
erros relativos er dos valores médios ?Q?? e ?M??, em relação à solução de referência.

64



MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1630 2924, 9 ?657, 46 5, 128 ?23, 71 1640 3625, 8 ?1724, 5 ?6, 743 ?72, 88
3 3416 1147, 0 ?876, 92 ?38, 13 ?30, 74 3430 2402, 5 ?502, 87 ?48, 11 ?34, 14
4 5850 1030, 9 ?820, 09 ?40, 17 ?39, 79 5868 2314, 9 ?415, 91 ?46, 18 ?36, 06
5 8932 1024, 9 ?637, 49 ?40, 32 ?47, 83 8954 2207, 4 ?308, 66 ?40, 21 ?41, 98
6 12662 1016, 9 ?389, 36 ?40, 43 ?54, 05 12688 2028, 9 ?130, 23 ?34, 74 ?47, 38
7 17040 1007, 4 ?107, 76 ?40, 53 ?58, 07 17070 1810, 3 88, 318 ?30, 94 ?51, 10
8 22066 997, 63 144, 30 ?40, 61 ?60, 26 22100 1606, 4 292, 19 ?28, 82 ?53, 17

Tabela 5.6: Anel e casca com o mesmo peso: convergência das quantidades de interesse
obtidas pela solução numérica em ambos os lados da junção, usando a malha da Figura
5.3 (a).

MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1770 1125, 7 456, 75 ?40, 57 ?48, 95 1780 1322, 9 576, 88 ?35, 74 ?46, 76
3 3710 1017, 2 890, 32 ?40, 79 ?49, 03 3724 1001, 9 896, 80 ?36, 31 ?45, 59
4 6354 991, 30 1031, 0 ?40, 83 ?45, 23 6372 915, 34 983, 23 ?38, 97 ?42, 83
5 9702 976, 68 1044, 0 ?40, 85 ?42, 56 9724 910, 13 988, 42 ?40, 37 ?41, 41
6 13754 968, 30 1022, 2 ?40, 86 ?41, 32 13780 922, 91 975, 63 ?40, 86 ?40, 90
7 18510 963, 15 999, 59 ?40, 87 ?40, 86 18540 934, 01 964, 53 ?40, 98 ?40, 77
8 23970 959, 78 983, 39 ?40, 86 ?40, 70 24004 940, 83 957, 71 ?40, 99 ?40, 76

Tabela 5.7: Anel e casca com o mesmo peso: convergência das quantidades de interesse
obtidas pela solução numérica em ambos os lados da junção, usando a malha da Figura
5.3 (b).

MEF contínuo MEF CD
k DOF QS? Q

R
? M

S
? M

R
? DOF Q

S
? Q

R
? M

S
? M

R
?

2 1810 1018, 3 820, 10 ?40, 99 ?46, 90 1820 1037, 3 862, 76 ?37, 63 ?44, 97
3 3794 972, 65 1002, 0 ?40, 89 ?43, 62 3808 925, 33 973, 44 ?39, 77 ?42, 14
4 6498 960, 55 1003, 5 ?40, 89 ?41, 49 6516 926, 87 971, 73 ?40, 79 ?41, 02
5 9922 955, 39 979, 92 ?40, 88 ?40, 85 9944 939, 28 959, 28 ?40, 98 ?40, 80
6 14066 952, 94 964, 80 ?40, 88 ?40, 74 14092 945, 56 952, 98 ?40, 97 ?40, 80
7 18930 951, 64 957, 04 ?40, 88 ?40, 76 18960 948, 25 950, 29 ?40, 94 ?40, 82
8 24514 950, 89 953, 29 ?40, 88 ?40, 79 24548 949, 18 949, 36 ?40, 91 ?40, 84

Tabela 5.8: Anel e casca com o mesmo peso: convergência das quantidades de interesse
obtidas pela solução numérica em ambos os lados da junção, usando a malha da Figura
5.3 (c).

65



MEF CD
k DOF ?Q?? [N/m] er(Q?)(%) ?M?? [Nm/m] er(M?)(%)
2 1820 950, 020 7, 9×10?2 ?41, 301 1, 0
3 3808 949, 384 1, 2×10?2 ?40, 957 2, 0×10?1

4 6516 949, 299 3, 5×10?3 ?40, 905 7, 3×10?2

5 9944 949, 276 1, 0×10?3 ?40, 889 3, 2×10?2

6 14092 949, 269 3, 5×10?4 ?40, 883 1, 7×10?2

7 18960 949, 267 1, 2×10?4 ?40, 880 9, 7×10?3

8 24548 949, 265 8, 1×10?5 ?40, 878 4, 9×10?3

Tabela 5.9: Anel e casca com o mesmo peso: erros relativos das quantidades de interesse
com respeito à solução de referência utilizando a malha da Figura 5.3 (c).

5.3.3 Comparação com outros resultados da literatura

Nas tabelas seguintes resumem-se os resultados obtidos pela técnica MEF CD, utili-
zando k = 8 e malha com refinamento direcional da Figura 5.3 (c), e vários modelos de
elementos finitos adotados por outros autores [22, 23].

Métodos Q?[N/m] M?[Nm/m]
clássico de Pitkäranta 942,5 ?37, 45
Axissimétrico MEF CD 943,65 ?36, 79
p-Version axisymmetric solid [73] 934,5 ?34, 81
p-Version axisymmetric solid - Extraction [22] 943,6 ?36, 81
hp-Version axisymmetric solid - Extraction [23] 943,65 ?36, 79
Outros autores [22]
p-Version axisymmetric solid 940,9 ?36, 63
p-Version 3D thin solid q = 3 948,4 ?37, 31
p-Version axisymmetric solid 940,9 ?36, 80
h-Version axisymmetric shell - solid 949,2 ?36, 62
h-Version 3D shell - solid 951,3 ?38, 35
h-Version axisymmetric solid - 4 node elements 953,7 ?10, 57
h-Version axisymmetric solid - 8 node elements 953,7 ?19, 67
h-Version axisymmetric shell - solid 593,8 ?140, 12
h-Version 3D shell - solid 1140 ?205
h-Version axisymmetric solid 960,0 ?31, 86
h-Version 3D shell - solid 1015,7 86, 30
h-Version axisymmetric shell - solid 989,1 ?89, 11

Tabela 5.10: Resumo dos resultados para o problema de Girkmann para o caso de anel
leve.

A partir das Tabelas 5.10 e 5.11 nota-se que nem todos os métodos fornecem

66



resultados com uma tolerância de 5% em comparação com os resultados obtidos pelo
método clássico de Pitkäranta [22]. O modelo axissimétrico com a técnica de MEF CD
proporciona excelentes resultados, que são consistentes com os resultados de [22, 23]
com base em técnicas de extração.

Métodos Q?[N/m] M?[Nm/m]
clássico de Pitkäranta 943,8 ?41, 12
Axissimétrico MEF CD 949,27 ?40, 88
p-Version axisymmetric solid - nodal force [22] 949,3 ?40, 91
p-Version axisymmetric solid - automesh[22] 947,3 ?40, 88

Tabela 5.11: Resumo dos resultados para o problema de Girkmann para o caso em que
o anel e a casca tem o mesmo peso médio.

67



68



Capítulo 6

Simulação multifísica no NeoPZ

6.1 Introdução

Modelos de simulações multifísicas têm sido amplamente estudados recentemente por
terem uma ampla variedade de aplicações, como mostrado na literatura [25, 26, 27, 28,
29, 30, 31, 32]. Simulações multifísicas ocorrem na resolução de sistemas de equações
diferenciais parciais, provenientes de problemas acoplados, envolvendo diferentes fenô-
menos físicos. Problemas multifísicas ocorrem em diversas áreas científicas, tais como
bioengenharia, físico-química, Engenharia de Petróleo, etc. Na engenharia de petró-
leo tais problemas são caracterizados por interações de vários fenômenos. Tem-se, por
exemplo, o problema de escoamento multifásico que é a interação do escoamento de
fluido no meio poroso, dado pela equação de Darcy, com transporte de componentes.
Pode-se também considerar o problema de interação fluido-estrutura, caracterizado por
operações de fraturamento hidráulico, em que ocorre a interação entre a matriz porosa
e o escoamentos de fluidos em espaços livres (dentro da fratura). Outro fenômeno que
pode ocorrer é a interação de deslocamento do sólido com a pressão de fluido no meio
poroso, que é tratada no contexto de poroelasticidade consolidada por Biot [74].

O subespaço de aproximação das variáveis de estado em problemas acoplados
pode variar conforme a necessidade de precisão e/ou necessidade de satisfação da con-
servação de quantias de interesse a nível local. Se um único subespaço de aproximação
for utilizado para todas as variáveis de estado na mesma simulação, podem ocorrer
instabilidades nos algoritmos ou resultados com baixa precisão.

Tendo em vista que em simulações multifísicas é necessário levar em consideração
os diferentes fenômenos físicos envolvidos, uma alternativa para se obter uma simulação

69



ótima pode ser dada por um tratamento diferenciado para cada meio físico envolvido.
Pode-se usar diferentes métodos na simulação multifísica, tais como diferenças finitas,
elementos finitos, volumes finitos ou a combinação desses. Em elementos finitos, por
exemplo, tal abordagem poderia ser descrita utilizando-se, em cada meio físico, um
espaço de aproximação diferente e com níveis de refinamento diferentes da malha de
elementos finitos. Por exemplo, considerando um problema de escoamento multifásico,
pode-se resolver o fluxo utilizando subespaços Hdiv-conformes, a pressão e a saturação
usando subespaços com funções descontínuas de L2.

Alguns softwares comerciais contemplam a simulação multifísica, ADINA Mul-
tiphysics, ANSYS Multiphysics, COMSOL Multiphysics, são exemplos de alguns softwa-
res. Pode-se citar, também, o OOMPH-LIB [31] que é uma biblioteca de elementos fini-
tos, de orientação a objeto, com código fonte livre para a simulação de alguns problemas
multifísicas, tais como termoelasticidade estacionário e alguns problemas de interação
fluido estrutura.

Todas as implementações computacionais desta tese são realizadas no NeoPZ
[56, 34], que é um ambiente de programação científica de código fonte livre, orien-
tado a objeto, formado por um conjunto de classes que facilitam o desenvolvimento de
simulações de elementos finitos. O NeoPZ inclui classes que contemplam diferentes ti-
pos de subespaços de aproximação, tais como subespaço de funções em H1 (contínuas),
de funções descontínuas e subespaços Hdiv-conformes. No entanto, apenas um único
espaço de aproximação era permitido em uma dada simulação.

Sendo assim, desenvolve-se nesta tese uma estrutura de classes que permite uma
interação de maneira flexível entre estes subespaços, de modo a contemplar simulações
multifísicas. Para melhor entendimento, na Seção 6.2 faz-se uma breve apresentação
do ambiente NeoPZ. Na Seção 6.3, descreve-se como a nova estrutura de classes para
simulação multifísica foi incorporada ao NeoPZ.

6.2 NeoPZ

O NeoPZ é um ambiente de programação científica escrito em linguagem C++ que
permite o desenvolvimento de códigos de elementos finitos com muita flexibilidade. É
constituído de módulos independentes que oferecem as funcionalidades necessárias a
um código de elementos finitos, quando combinados. Os principais módulos são: Geo-
métrico (malha geométrica e elementos geométricos), Espaços de Aproximação (malha

70



computacional e elementos computacionais) e Material (formulação variacional). Ou-
tros módulos importantes são o Matricial (classes matriciais) e o de Pós-processamento.
Um esquema geral da estrutura de classe do ambiente NeoPZ é mostrado na Figura 6.1.

TPZGeoEl

modelagem geométrica

TPZCompEl

espaço de aproximação

TPZMaterial

formulação variacional

TPZMatrix

resolução do sistema algébrico

Figura 6.1: Esquema geral do NeoPZ.

6.2.1 Procedimento de cálculo

O procedimento de cálculo de um programa de elementos finitos passa geralmente pelas
seguintes etapas: definição da malha de elementos finitos, cálculo da matriz e do vetor
do sistema algébrico, solução do sistema algébrico e pós-processamento da solução. No
NeoPZ esse procedimento é implementado da seguinte maneira:

1. Construção da malha de elementos finitos.

(a) Geometria da malha - implementado pelo módulo Geométrico, destacando-se
as classes TPZGeoMesh e TPZGeoEl

71



(b) Espaço de aproximação dos elementos - implementado pelo módulo Espaço
de Aproximação, destacando-se as classes TPZCompMesh, TPZCompEl,
TPZInterpolationSpace e TPZInterfaceElement

2. Cálculo da matriz e vetor do sistema algébrico.

(a) A matriz e o vetor do sistema algébrico são compostos das contribuições
de diversas matrizes e vetores associados a cada elemento da malha. Esse
processo é conhecido como assemblagem e é feito no NeoPZ pela classe
TPZAnalysis.

(b) As matrizes e vetores dos elementos são obtidos a partir de integrais definidas
na formulação variacional e implementados pelo módulo Material. Vale res-
saltar que a inclusão de novas formulações variacionais no NeoPZ é simples,
necessitando apenas da implementação de uma nova classe no módulo Ma-
terial. A flexibilidade do ambiente é certamente uma das grandes vantagens.
As formulações disponíveis vão desde a equação de Poisson, elasticidade,
plasticidade, equações de Euler compressíveis, etc.

3. Solução do problema matricial. As classes matriciais implementam diversos tipos
de armazenamentos, decomposição de matriz e métodos iterativos.

4. Pós-processamento da solução. O NeoPZ exporta a solução em vários formatos
gráficos, tais como OpenDX, MVS e VTK.

6.2.2 Descrição dos principais módulos

Nesta seção faz-se um breve comentário sobre os módulos destacados anteriormente.
Para um entendimento mais aprofundado sobre o ambiente NeoPZ, existe uma docu-
mentação do código que pode ser obtida pelo site http://www.labmec.org.br, além das
referências [56, 34, 72, 16].

Módulo Geométrico

O ambiente NeoPZ dá uma distinção muito forte entre geometria e espaço de aproxima-
ção. As classes do módulo Geométrico são responsáveis pela aproximação da geometria
do problema e pela topologia da malha. Para a definição da topologia da malha, existem
elementos geométricos pertencentes à classe TPZGeoEl, associados à malha geométrica

72



da classe TPZGeoMesh. Um diagrama de classes que definem um elemento geométrico é
mostrado na Figura 6.2. A classe TPZGeoElement implementa um elemento geométrico
com padrão de refinamento uniforme, já a classe TPZGeoElRefPattern implementa um
elemento geométrico que é refinado de acordo com um padrão de refinamento genérico,
a partir de um arquivo de dados com informações necessárias a respeito da divisão do
elemento.

TPZGeoEl

TPZGeoElement TPZGeoElRefPattern

Figura 6.2: Diagrama de classe que definem um elemento geométrico.

No NeoPZ, a definição geométrica e o refinamento utilizam definições topológicas
que consideram que um elemento é o resultado da união de uma quantidade finita de
subdomínios chamados de lados, podendo ser nós, arestas, faces e volume. Desta forma,
é possível estabelecer transformações paramétricas entre os elementos. Mais detalhes
podem ser vistos em [72]. Um esquema da composição de um elemento geométrico
quadrilateral no NeoPZ é ilustrado na Figura 6.3.

0 1

23

4

5

6

7 8

Figura 6.3: Esquema de um elemento quadrilateral no NeoPZ, composto de 9 lados: 4
nós (0, 1, 2, 3), 4 arestas (4, 5, 6, 7) e 1 face (8).

Módulo de Subespaços de aproximação

Esse módulo é composto por classes que definem os subespaços de aproximação, o
elemento finito, as funções de forma (funções de base) e as regras de integração para a

73



construção das matrizes e vetores dos elementos.
Os subespaços de aproximação são implementados pelos elementos computaci-

onais, derivados da classe base TPZCompEl. Esta classe define os métodos básicos
que devem ser implementados pelas classes derivadas. As principais classes derivadas
são TPZInterpolationSpace e TPZInterfaceElement. Um esquema da estrutura de clas-
ses que definem os subespaços de aproximação é ilustrado na Figura 6.4. A classe
TPZInterpolationSpace e suas derivadas definem e implementam os métodos comuns
aos métodos de Galerkin contínuo e descontínuo. O método de elementos finitos clássico
(Galerkin contínuo) é implementado pela classe TPZInterpolatedElement e suas deriva-
das. O método de Galerkin descontínuo é implementado pelas classes TPZCompElDisc
e TPZInterfaceElement. A classe TPZCompElDisc é responsável pela interpolação no
interior dos elementos descontínuos, sem exigir continuidade em suas fronteiras, e a
classe TPZInterfaceElement é responsável pelos cálculos na interface entre elementos.

TPZCompEl

TPZInterfaceElement TPZInterpolationSpace

TPZInterpolatedElement

TPZCompElHdiv

TPZCompElDisc

Figura 6.4: Arquitetura de classes que definem os espaços de aproximação.

Os elementos computacionais derivados da classe TPZInterfaceElement não pos-
suem funções de aproximação associadas a ele. De fato, as funções de aproximação são
definidas à esquerda e à direita da interface, sobre os elementos vizinhos, que devem
ser do tipo TPZInterpolationSpace. O processo de construção da malha computacional
é igual para elementos contínuos e descontínuos. Os elementos são criados através do
método TPZCompMesh::AutoBuild. Para criar elementos contínuos e/ou descontínuos,
deve-se chamar antes os métodos TPZCompMesh::SetAllCreateFunctionsContinuous
e/ou TPZCompMesh::SetAllCreateFunctionsDiscontinuous. Os elementos geométricos
não fazem distinção sobre elementos contínuos e descontínuos. A diferença é a pre-

74



sença dos elementos geométricos associados às interface, após a construção da malha
computacional.

O cálculo das integrais é feito pelas classes computacionais, auxiliados por seus
elementos geométricos e pelo material. As integrais são calculadas numericamente
através de quadraturas gaussianas. Por exemplo,

ˆ
K

?i?jdx =

np?
ip=1

?i(xip)?j(xip)wip,

com xip a coordenada do ponto de integração, wip o seu peso e K um elemento repre-
sentativo. Os elementos computacionais calculam as funções de forma e suas derivadas.
O elemento geométrico fornece o mapeamento geométrico e a matriz jacobiana. Para
cada ponto de integração, o elemento solicita a seu material que faça a contribuição. Ou
seja, a matriz do sistema algébrico do elemento é atualizada a cada ponto de integração,
por exemplo kij =

?np
ip=1 ?i(xip)?j(xip)wip.

Módulo Material

As classes pertencentes a esse módulo são responsáveis pela implementação da for-
mulação variacional da EDP tratada no NeoPZ. A função dessas classes é calcular a
contribuição de um ponto de integração para a matriz e o vetor do sistema algébrico de
um elemento. As classes base deste módulo são a classe TPZMaterial e sua classe deri-
vada TPZDiscontinuousGalerkin. No NeoPZ, um elemento computacional existe desde
que uma formulação variacional (objeto da classe TPZMaterial) estiver associada a ele.
A classe TPZMaterial define os métodos e funções necessários para a construção de
problemas do MEF clássico. São de especial importância os métodos:

• Contribute(TPZMaterialData &amp;amp;data, REAL weight, TPZFMatrix &amp;amp;ek, TPZF-
Matrix &amp;amp;ef): calcula a contribuição de um ponto de integração para a matriz
(ek) e o vetor (ef ) do sistema algébrico de um elemento. Para cada ponto de
integração o método recebe como parâmetros de entrada um objeto do tipo TPZ-
MaterialData e o valor do peso da regra de integração. A classe TPZMaterialData
faz uma interface entre as classes TPZCompEl e TPZMaterial. Os principais atri-
butos da classe TPZMaterialData são phi e dphix, os quais devolvem os valores
das funções de forma e suas derivadas calculadas no ponto de integração

• ContributeBC(TPZMaterialData &amp;amp;data, REAL weight, TPZFMatrix &amp;amp;ek, TPZF-

75



Matrix &amp;amp;ef, TPZBndCond &amp;amp;bc): calcula a contribuição de um ponto de integra-
ção para a matriz (ek) e o vetor (ef ) do sistema algébrico de um elemento de
contorno. O NeoPZ trabalha com condições de contorno do tipo Dirichlet, Neu-
mann e mista. A classe TPZBndCond define se o elemento é de contorno.

A classe TPZDiscontinuousGalerkin, classe derivada da TPZMaterial, define os métodos
e funções adicionais necessários para o método de Galerkin descontínuo. São de especial
importância o método Contribute, já definido na classe TPZMaterial, e os seguintes
métodos:

• ContributeInterface(TPZMaterialData &amp;amp;data, TPZMaterialData &amp;amp;dataleft, TPZ-
MaterialData &amp;amp;dataright, REAL weight, TPZFMatrix &amp;amp;ek, TPZFMatrix &amp;amp;ef):
calcula a contribuição de um ponto de integração para a matriz e o vetor do
sistema algébrico de um elemento de interface. Pode-se observar que o método
recebe como parâmetros de entrada dois objetos do tipo TPZMaterialData refe-
rentes aos elementos vizinhos (a esquerda e a direita) do elemento de interface.

• ContributeBCInterface(TPZMaterialData &amp;amp;data, TPZMaterialData &amp;amp;dataleft,
REAL weight, TPZFMatrix &amp;amp;ek, TPZFMatrix &amp;amp;ef, TPZBndCond &amp;amp;bc): cal-
cula a contribuição de um ponto de integração para a matriz e o vetor do sistema
algébrico de um elemento de interface de contorno. As simulações de Galerkin
descontínuo não utilizam o método ContributeBC(). As condições de contorno
são aplicadas pelo método ContributeBCInterface().

Módulo Matricial

Esse módulo é composto das classes matriciais e dos métodos de resolução de sistemas
lineares disponíveis no NeoPZ. São disponíveis diversos modos de armazenamento de
matrizes: matriz cheia, matriz de banda, matriz simétrica, matriz não simétrica e matriz
esparsa. Para resolução de sistemas lineares são implementados os métodos diretos, tais
como decomposição LU, Cholesky, LDLt e método frontal. Os métodos iterativos são
Jacobi, SOR, SSOR, Gradiente conjugado, GMRes, etc.

6.3 Implementação multifísica

Nesta seção descreve-se a incorporação ao ambiente NeoPZ de uma estrutura de classes
para uma interação entre os subespaços de aproximação de modo a contemplar simu-

76



lações multifísicas. Faz-se uma breve descrição das classes e métodos desenvolvidos,
bem como de um roteiro de utilização do código através de um problema simples, sem
nenhum significado físico, com objetivo apenas de verificar o código.

O objetivo principal é construir uma malha multifísica como sendo um objeto do
tipo TPZCompMesh, composto de elementos representando subespaços de aproxima-
ção combinados. Esses elementos multifísicas, chamados de elementos computacionais
multifísicas, combinam um ou mais elementos do tipo TPZInterpolationSpace ou TP-
ZInterfaceElement. Cada elemento multifísica terá um elemento geométrico correspon-
dente. Quando o elemento geométrico (TPZGeoEl) corresponder a um subelemento, é
necessário aplicar uma transformação que leva um ponto (?,?) do subelemento para o
elemento maior (pai).

De modo geral, para manter uma relação sólida com o objeto TPZMaterial, o
método Contribute() recebe um vetor de objetos TPZMaterialData. Na forma mais
tradicional (apenas uma variável de estado ou um único fenômeno físico), ele recebe
um vetor com um único elemento. Simplifica-se a classe TPZMaterialData, de modo
a contemplar um conjunto de funções de forma e suas derivadas. Os elementos de
interface chamam um método ContributeInterface() que recebe um vetor de objetos
TPZMaterialData com pelo menos dois objetos: left e right.

6.3.1 Descrição detalhada

Elementos computacionais multifísicas. Um elemento multifísica tem uma refe-
rência para o elemento geométrico e uma lista de ponteiros para elementos computaci-
onais (cada um relacionado a um espaço de aproximação). A ordenação dos elementos
computacionais é muito importante, pois isso determina a ordem em que as funções de
forma são passadas para o objeto material. É necessário criar uma estrutura especial
para um elemento multifísica de interface, com uma lista de elementos left e uma lista
de elementos right.

Formulação variacional. Como no NeoPZ um elemento computacional existe
desde que uma formulação variacional (objeto da classe TPZMaterial) estiver associada
a ele, um elemento multifísica é composto de um número de elementos computacionais,
cada qual com a sua própria característica (espaço de aproximação, ordem polinomial,
etc).

77



Construção da malha computacional multifísica. Na construção da malha com-
putacional multifísica, várias malhas computacionais necessitam ser criadas para confi-
gurar um problema multifísica. Além disso, vale destacar que:

• No NeoPZ, cada elemento computacional possui uma referência a seu elemento
geométrico.

• Cada uma das malhas computacionais está associada a uma variável de estado
(correspondendo a um fenômeno físico) e podendo ter elementos geométricos com
refinamentos diferentes.

• Assume-se que os elementos geométricos são estruturados de forma hierárquica:
os elementos geométricos correspondentes aos elementos computacionais são dis-
juntos, iguais ou inclusos uns aos outros.

• Uma malha composta de elementos multifísicas herda as informações de cada uma
das malhas computacionais.

• A malha computacional multifísica depende do problema multifísica simulado e
de sua formulação variacional.

• Cada elemento multifísica tem uma referência ao menor elemento geométrico re-
ferido pelo elemento computacional. Assim, a malha geométrica final é composta
da união de todos elementos geométricos.

O processo de criação da malha computacional multifísica deve seguir as seguintes
etapas:

1. Carregar todas as malhas computacionais.

2. Fazer um loop sobre o conjunto de malhas computacionais.

(a) Carregar a malha computacional multifísica.

(b) Para cada elemento geométrico da malha multifísica, buscar o elemento com-
putacional correspondente e adicioná-lo ao elemento multifísica.

(c) Se o elemento computacional for um elemento de interface multifísica, adi-
cionar também os elementos left e right para o elemento mutifísica.

78



Refinamento da malha geométrica. Considerando que as variáveis de estado são
armazenadas em cada malha referida, o processo de refinamento da malha multifísica é
um processo que se aplica em cada malha, individualmente. Então, a malha multifísica
é recomposta pelo refinamento da malha geométrica correspondente a cada fenômeno
físico (a cada variável de estado). A única restrição que se faz é que: dado um elemento
de qualquer uma das malhas, ele tem que ser um elemento pai (maior) ou filho (me-
nor) de um dos elementos das outros malhas. A representação geométrica das malhas
referentes a dois fenômenos físicos diferentes (Malha 1 e Malha 2) e a representação
geométrica da malha multifísica são ilustradas na Figura 6.5.

1 2 3 4

5678

1

2 3

45

67

8

1 2 3 4

91011

56

78

Malha multifísica

Malha 2Malha 1

Figura 6.5: Esquema da representação geométrica da malha multifísica.

Transformação paramétrica. No NeoPZ, todos os cálculos referentes à formula-
ção variacional são efetuados sobre pontos de integração (?,?) do elemento geométrico
referenciado pelo elemento computacional correspondente. Além disso, todo elemento
multifísica tem uma referência para o elemento geométrico e uma lista de ponteiros
para os elementos computacionais (cada qual relacionado a um fenômeno físico e o

79



seu elemento geométrico). Sendo assim, para todo ponto de integração sobre um ele-
mento geométrico da malha multifísica, é necessário criar um método que calcule o
mapeamento afim (transformação afim) que leva um ponto paramétrico do elemento
geométrico multifísica para um ponto paramétrico dos seus respectivos elementos mai-
ores (elementos pai), ou seja, para os elementos geométricos referenciados pelos seus
respectivos elementos computacionais. Sobre esses novos pontos de integração, fazem-se
os cálculos referentes à formulação variacional do problema multifísica. Note-se que a
vantagem de utilizar a transformação afim é que ela preserva a colinearidade entre os
pontos e a relação de distância entre pontos colineares após a transformação.

Como exemplo, considere a malha multifísica mostrada na Figura 6.5. Dado um
ponto de integração (?,?) sobre o elemento geométrico de índice 8 da malha multifísica,
transformações afins são aplicadas para levar esse ponto aos seus respectivos elementos
pais, elementos 5 e 7 das Malhas 1 e 2, respectivamente, como mostrado na Figura 6.6.

Malha multifísica

Malha 2

Malha 1

4

6

(?,?)

(?1,?1)

(?2,?2)

6 5

7

4

5

?1

?
2

8

5

7

Figura 6.6: Esquema da transformação paramétrica para a simulação multifísica.

6.3.2 Classes implementadas

Lembra-se que uma malha computacional multifísica é um objeto do tipo TPZComp-
Mesh, composto de elementos representando espaços de aproximação combinados. Es-

80



ses elementos são chamados de elementos computacionais multifísicas, que combinam
um ou mais elementos do tipo TPZInterpolationSpace ou TPZInterfaceElement. Cada
elemento multifísica tem uma referência para o elemento geométrico e uma lista de
ponteiros para elementos computacionais. A ordenação dos elementos computacionais
é muito importante, pois isso determina a ordem em que as funções de forma são pas-
sadas para o objeto material.

As classes implementadas no NeoPZ para contemplar a simulação multifísica
são TPZMultiphysicsElement e sua classe derivada TPZMultiphysicsCompEl, TPZMul-
tiphysicsInterfaceElement e TPZBuildMultiphysicsMesh. Um esquema da estrutura de
classes que definem o elemento computacional multifísica é mostrado na Figura 6.7.
A classe TPZMultiphysicsElement é uma classe derivada da classe TPZCompEl, que
juntamente com a sua classe derivada TPZMultiphysicsCompEl contém os métodos e
funções responsáveis pela construção de um elemento computacional multifísica, tanto
de interior quanto de interface. Note que o elemento multifísica de interface é criado
apenas quando o método de Galerkin descontínuo é aplicado em uma das EDPs do
problema multifísica. A classe TPZMultiphysicsInterfaceElement é responsável pelos
cálculos sobre o elemento multifísica de interface entre dois elementos descontínuos.
A classe TPZBuildMultiphysicsMesh é uma classe auxiliar na construção do elemento
computacional multifísica.

TPZCompEl

TPZInterfaceElement TPZInterpolationSpace TPZMultiphysicsElement TPZMultiphysicsInterfaceElement

TPZMultiphysicsCompEl

Figura 6.7: Arquitetura das classes que definem o elemento computacional multifísica.

81



Classe TPZMultiphysicsCompEl

A classe TPZMultiphysicsCompEl é a classe principal na simulação multifísica, sendo
responsável pela criação dos elementos computacionais multifísicas. Os principais mé-
todos da classe são:

• AddElement(TPZCompEl *cel, int meshindex): adiciona um elemento computa-
cional ao elemento multifísica.

• SetConnectIndexes(TPZVec&lt;int&gt; &amp;amp;indexes): insere os índices dos connects (ob-
jetos da classe TPZConnect) ao elemento multifísica. No NeoPZ, a classe TPZ-
Connect é responsável pela representação do conjunto de funções de base associ-
ado ao elemento computacional.

• InitMaterialData(TPZVec&lt;TPZMaterialData &gt; &amp;amp;dataVec): inicializa o vetor de
dados da classe TPZMaterial e seus atributos associados a cada fenômeno físico
da formulação variacional.

• AffineTransform(TPZManVector&lt;TPZTransform&gt; &amp;amp;trVec): calcula o mapea-
mento de um ponto paramétrico no elemento multifísica para um ponto para-
métrico nos seus respectivos elementos pai referenciados.

• CalcStiff(TPZElementMatrix &amp;amp;ek, TPZElementMatrix &amp;amp;ef): calcula a matriz de
rigidez e o vetor de carga (matriz e vetor do sistema algébrico) localmente, ou
seja, em um elemento multifísica.

• Solution(TPZVec&lt;REAL&gt; &amp;amp;qsi, int var, TPZVec&lt;REAL&gt; &amp;amp;sol): calcula a so-
lução aproximada, sol, para uma variável de estado em um ponto paramétrico
qsi do elemento multifísica, em que qsi é expresso em termos das coordenadas do
elemento de referência (elemento mestre).

Classe TPZMultiphysicsInterfaceElement

Essa classe é responsável pelos cálculos sobre os elementos multifísicas de interface.
Alguns dos principais métodos dessa classe são:

• ComputeSideTransform(TPZManVector&lt;TPZCompElSide&gt; &amp;amp;Neighbor, TPZ-
ManVector&lt;TPZTransform&gt; &amp;amp;transf): calcula a transformação paramétrica que
leva um ponto paramétrico do elemento multifísica de interface para um ponto

82



paramétrico do elemento multifísica vizinho. Note que não existem funções de
aproximação associadas ao elemento de interface. Portanto, em todos os cálculos
feitos sobre um elemento de interface, é necessário aplicar essas transformações
paramétricas.

• CalcStiff(TPZElementMatrix &amp;amp;ek, TPZElementMatrix &amp;amp;ef): calcula a contribui-
ção na matriz de rigidez e o vetor de carga (matriz e vetor do sistema algébrico)
em um elemento multifísica de interface.

• Solution(TPZVec&lt;REAL&gt; &amp;amp;qsi, int var, TPZVec&lt;REAL&gt; &amp;amp;sol): calcula a so-
lução aproximada, sol, para uma variável de estado em um ponto paramétrico
qsi do elemento multifísica de interface, em que qsi é expresso em termos das
coordenadas do elemento de referência (elemento mestre).

Classe TPZBuildMultiphysicsMesh

A classe TPZBuildMultiphysicsMesh possui os métodos auxiliares na construção da
malha computacional multifísica. Os principais métodos são:

• AddElements(TPZVec&lt;TPZCompMesh *&gt; cmeshVec, TPZCompMesh *MFMesh):
faz um loop sobre um conjunto de malhas computacionais e adiciona os elementos
computacionais, de cada um das malhas, na malha multifísica.

• AddConnects(TPZVec&lt;TPZCompMesh *&gt; cmeshVec, TPZCompMesh *MFMesh):
faz um loop sobre um conjunto de malhas computacionais e adiciona o conjunto
de connects ( objetos da classe TPZConnect), de cada um das malhas, na malha
multifísica.

• TransferFromMeshes(TPZVec&lt;TPZCompMesh *&gt; &amp;amp;cmeshVec, TPZCompMesh
*MFMesh): transfere informações (solução, matriz de rigidez e vetor de carga,
etc) de um conjunto de malhas computacionais para a malha multifísica.

• TransferFromMultiPhysics(TPZVec&lt;TPZCompMesh *&gt; &amp;amp;cmeshVec, TPZComp-
Mesh *MFMesh): transfere informações (solução, matriz de rigidez e vetor de
carga, etc) da malha multifísica para um conjunto de malhas computacionais.

83



Outros métodos

Como descrito anteriormente, para manter uma relação sólida com as classes TPZMa-
terial e TPZDiscontinuousGalerkin, foi necessário criar métodos Contribute(), Contri-
buteBC(), ContributeInterface() e ContributeBCInterface() que recebam um vetor de
objetos TPZMaterialData. Além disso, foi necessário adicionar outros métodos dentro
do ambiente NeoPZ de modo a contemplar a simulação multifísica. Abaixo, seguem
alguns dos métodos implementados:

• Contribute(TPZVec&lt;TPZMaterialData&gt; &amp;amp;datavec, REAL weight, TPZFMatrix
&amp;amp;ek, TPZFMatrix &amp;amp;ef): calcula a contribuição da matriz de rigidez e do vetor
de carga localmente em um ponto de integração no elemento multifísica.

• ContributeBC(TPZVec&lt;TPZMaterialData&gt; &amp;amp;datavec, REAL weight, TPZFMa-
trix &amp;amp;ek, TPZFMatrix &amp;amp;ef, TPZBndCond &amp;amp;bc): calcula a contribuição da ma-
triz de rigidez e do vetor de carga localmente em um ponto de integração para os
elementos multifísica de contorno.

• Solution(TPZVec&lt;TPZMaterialData&gt; &amp;amp;datavec, int var, TPZVec&lt;REAL&gt; &amp;amp;So-
lout): retorna uma solução aproximada relacionada a uma variável de estado do
problema multifísica.

• SetAllCreateFunctionsMultiphysicElem(): método para definir funções de aproxi-
mação relacionadas ao elemento multifísica.

6.3.3 Etapas para simulação multifísica

Nesta seção apresenta-se um algoritmo para aplicação da simulação multifísica.

Algoritmo de Simulação Multifísica

Assume-se que existe um material (classe derivada de TPZMaterial) para a formulação
variacional do problema multifísica. Seja n o número de EDP do sistema acoplado e
consequentemente o quantidade de variável de estado.

Etapa 1 Criando as malhas do sistema de EDP

- Carregar a malha geométrica

- criar um objeto da classe TPZGeoMesh: gmesh

84



- Carregar as malhas computacionais referentes às variáveis de estado (ao sistema
de EDP)

- Para i = 1, 2, ..., n

- criar objetos da classe TPZCompMesh: cmesh_i

- Se for aplicar níveis de refinamentos geométricos diferentes, relacionado a cada
variável de estado, ir para a Etapa 2. Caso contrário ir para a Etapa 3

Etapa 2 Refinamento geométrico (refinamento h)

- Para i = 1, 2, ..., n, faça

- gmesh –&gt; ResetReference();

- cmesh_i –&gt; LoadReferences();

- aplique o refinamento h

- cmesh_i –&gt; AdjustBoundaryElements();

- cmesh_i –&gt; CleanUpUnconnectedNodes();

Etapa 3 Criando a malha computacional multifísica

- Limpar a referência da malha geométrica

- gmesh –&gt; ResetReference();

- Carregar a malha computacional do problema multifísica

- criar um objeto da classe TPZCompMesh: mphysics

- Criar um vetor de malhas computacionais

- TPZVec&lt;TPZCompMesh *&gt; meshvec(n);

- Para i = 1, 2, ..., n, meshvec[i] = cmesh_i;

- Adicionar os elementos na malha multifísica

- TPZBuildMultiphysicsMesh::AddElements(meshvec, mphysics);

- TPZBuildMultiphysicsMesh::AddConnects(meshvec, mphysics);

- TPZBuildMultiphysicsMesh::TransferFromMeshes(meshvec, mphysics);

Etapa 4 Resolver o problema matricial do problema multifísica

Etapa 5 Pós-processamento da solução aproximada

85



- Transferir informações da malha multifísica para as malhas computacionais

- TPZBuildMultiphysicsMesh::TransferFromMultiPhysics(meshvec,
mphysics);

- Fazer o pós-processamento desejado: imprimir a solução, calcular o erro de
aproximação, etc.

Exemplo demonstrativo

Para uma melhor compreensão do Algoritmo de Simulação Multifísica e com o objetivo
de verificar o código, resolve-se um problema simples, formado por um sistema de duas
EDP desacopladas. Nota-se que esse problema não possui nenhum significado físico
específico, mas pode ser encarado como uma maneira de validar o código e de melhor
entender as etapas do algoritmo.

Descrição do problema. Resolver o sistema de equações

???
??
??u = 8 em ? = (0, 1) × (0, 1)

??p = f em ? = (0, 1) × (0, 1)
(6.1)

com f(x,y) = 2?2sen(?x)cos(?y) e condições de contorno

?u ·~n = 0, ?(x,y) ? ?uN = (x, 0) ? (x, 1),
u = 0, ?(x,y) ? ?uD = (0,y) ? (1,y),
p = 0 em ?pD = ??.

(6.2)

As soluções analíticas deste problema são: u(x,y) = 4x(1?x) e p(x,y) = sin(?x)cos(?y).
Definem-se os espaços

U =
{
u ? H1(?), u = 0 em ?uD

}
e V = H10 (?).

A formulação variacional é dada por: encontrar u ? U e p ? V tal que??????
?????
?
ˆ

?

?u?w dx = 8
ˆ

?

w dx?
´

?u
N
w?u ·~nds, ?w ? U,

?
ˆ

?

?p?v dx =
ˆ

?

f v dx, ?v ? V.

86



O sistema matricial oriundo da discretização da formulação variacional usando subes-
paços Un ? U e Vm ? V é do tipo(

A 0

0T B

)(
u

p

)
=

(
b

d

)
,

com An×n, Bm×m, 0n×m (matriz nula), un×1, pm×1 , bn×1 e dm×1.

Implementação computacional. Para resolver o problema no sentido da simula-
ção multifísica, criou-se, primeiramente, uma classe material (TPZMatPoissonDesaco-
plado), derivada da TPZMaterial, para implementar a formulação variacional do pro-
blema. A partir daí, todas as etapas do Algoritmo de Simulação Multifísica foram
aplicadas passo-a-passo, como mostram os próximos experimentos.

Experimento 1. Considerando a primeira EDP (variável u), adotam-se um
espaçamento uniforme h = 1/4 e um espaço de aproximação formado por funções
polinomiais por partes de grau k = 2. Na segunda EDP (variável p ), aplicam-se um
espaçamento uniforme h = 1/4 sobre toda a malha e subdivisão de alguns elementos,
e escolhe-se um espaço de aproximação formado por funções polinomiais por partes de
grau k = 3.

• Etapas 1 e 2: Usando os métodos criados, a malha geométrica e as malhas
computacionais do problema, conforme ilustrado na Figura 6.8. Os detalhes do
código são mostrados na Figura 6.9.

Figura 6.8: Malhas usadas no Problema (6.1)-(6.2). Variável u - primeira EDP (figura
à esquerda) e variável p- segunda EDP (figura à direita).

87



Figura 6.9: Aplicação das Etapas 1 e 2 no Problema (6.1)-(6.2).

• Etapas 3, 4 e 5: A Figura 6.10 mostra, passo-a-passo, todas as etapas. Nota-se
que o método MalhaCompMultifisica() é definido para criação da malha compu-
tacional multifísica. A Figura 6.11 mostra as soluções do problema.

88



Figura 6.10: Aplicação das Etapas 3, 4 e 5 no Problema (6.1).

Figura 6.11: Solução aproximada do Problema (6.1) para o Experimento 1.

89



Experimento 2. Neste experimento, mudam-se os refinamento aplicados na
malha referente à segunda EDP (variável p), aplicando-se um refinamento com h = 1/8,
uniformemente, sobre toda a malha. Os detalhes da etapa 2 são mostrados na Figura
6.12. Na Figura 6.13 mostra-se os resultados numéricos para este experimento.

Figura 6.12: Aplicação da Etapa 2 do Problema (6.1)-(6.2) para o Experimento 2.

Figura 6.13: Solução aproximada do Problema (6.1)-(6.2) para o Experimento 2.

6.4 Verificação numérica

Para verificar todas as classes e métodos desenvolvidos para contemplar a simulação
multifísica, analisa-se a preservação da taxa de convergência assintótica dos erros dos

90



métodos no seguinte problema:

???
??
??p = f em ? = (0, 1) × (0, 1),
??u = f em ? = (0, 1) × (0, 1),
u = p = 0 em ??,

(6.3)

com f(x,y) = 2?2sen(?x)cos(?y), em que as soluções analíticas são

u(x,y) = p(x,y) = 4x(1?x), ?(x,y) ? ?.

O problema é resolvido usando o Algoritmo de Simulação Multifísica, em que utiliza-
se o mesmo nível de refinamento uniforme nas malhas geométricas. Definem-se por
Nref ? N o número de refinamentos uniformes aplicados, de modo que h = 1/2Nref, e
por k o grau polinomial.

Teste 1. Aplicam-se subespaços do tipo H1(?)-conformes e os subespaços de Sobo-
lev particionado para obter soluções aproximadas de u e p, respectivamente. Ou seja,
aplicam-se o MEF contínuo para resolver a segunda EDP e o MEF descontínuo na re-
solução da primeira EDP. Na formulação de Galerkin descontínuo, utiliza-se o método
não-simétrico sem penalização, com ? = 1 e ? = 0. Utilizam-se malhas de elementos
quadrilaterais. As Tabela 6.1 e 6.2 mostram os valores dos erros e das taxas de conver-
gência assintótica medidos nas normas H1 e L2 nas aproximações, respectivamente, de
u e p. A Figura 6.14 mostra os gráficos dos respectivos erros.

MEF contínuo, erros em u (Teste 1)
Nref k = 1 k = 2 k = 3 k = 4

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 2.277 - 2.81e-1 - 2.81e-1 - 8.91e-3 -
1 1.004 1.1818 2.03e-1 0.4742 2.67e-2 3.3967 2.64e-3 1.7551
2 5.02e-1 0.9988 5.10e-2 1.9894 3.38e-3 2.9837 1.67e-4 3.9823
3 2.52e-1 0.9972 1.28e-2 1.9987 4.23-4 2.9961 1.05e-5 3.9956
4 1.26e-1 0.9992 3.19e-3 1.9998 5.30e-5 2.9990 6.55e-7 3.9989
5 6.30e-2 0.9998 7.98e-4 2.0000 6.62e-6 2.9998 4.09e-8 3.9997

Tabela 6.1: Verificação do erro e(u) =? u?uh ?H1 e da taxa de convergência.

91



método GD, erros em p (Teste 1)
Nref k = 1 k = 2 k = 3 k = 4

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 8.41 - 1.50e-1 - 1.50e-1 - 2.44e-3 -
1 9.43e-1 3.1571 8.70e-2 0.7904 5.52e-3 4.7693 4.34e-4 2.4870
2 1.84e-1 2.3589 3.77e-2 1.2076 2.69e-4 4.3580 3.44e-5 3.6572
3 4.39e-2 2.0656 1.18e-2 1.6794 1.56e-5 4.1071 2.30e-6 3.9019
4 1.09e-2 2.0153 3.14e-3 1.9054 9.57e-7 4.0279 1.47e-7 3.9742
5 2.71e-3 2.0038 7.99e-4 1.9752 5.95e-8 4.0070 9.20e-9 3.9935

Tabela 6.2: Verificação do erro numérico e(p) =? p?ph ?L2 e da taxa de convergência.

æ

æ
æ

æ
æ

æ

à
à

à

à

à

à

ì

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

ò

0.05 0.10 0.20 0.50 1.00

10
-7

10
-5

0.001

0.1

h

°
u
-

u
h
´

H
1

ò k = 4

ì k = 3

à k = 2

æ k = 1

æ

æ

æ

æ

æ

æ

à
à

à

à

à

à

ì

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

ò

0.05 0.10 0.20 0.50 1.00

10
-8

10
-6

10
-4

0.01

1

h

°
p
-

p
h
´

L
2

ò k = 4

ì k = 3

à k = 2

æ k = 1

Figura 6.14: Teste 1: Erros e(u) =? u ? uh ?H1 (em cima) e e(p) =? p ? ph ?L2 (em
baixo).

Teste 2. Aplicam-se os subespaços do tipo H1(?)-conformes para obter a solução
aproximada de u na segunda EDP e os subespaços em L2(?) e Hdiv(?)-conformes
para obter as soluções aproximadas de p e q = ??p, respectivamente, na formulação
mista da primeira EDP. Utilizam-se malhas de elementos triangulares. As Tabela 6.3,
6.4 e 6.5 mostram os valores dos erros e das taxas de convergência assintótica medidos
nas normas H1 nas aproximações de u e L2 nas aproximações de p e q. A Figura 6.15
mostra os gráficos dos respectivos erros.

Os resultados das tabelas e gráficos demonstram a confiabilidade nas classes desen-
volvidas e do código numérico implementado. Pode-se observar que os erros diminuem
à medida que h tende a zero. Além disso, a taxa de convergência dos erros cometidos
nas aproximações estão de acordo com os encontrados na literatura.

92



MEF contínuo, erros em u (Teste 2)
Nref k = 1 k = 2 k = 3 k = 4

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 2.277 - 1.407 - 7.69e-1 - 1.33e-1 -
1 1.523 0.5805 4.67e-1 1.5921 1.01e-1 2.9260 1.70e-2 2.9616
2 8.42e-1 0.8543 1.29e-1 1.8503 1.32e-2 2.9356 1.13e-3 3.9166
3 4.32e-1 0.9622 3.34e-2 1.9550 1.65e-3 2.9987 7.14e-5 3.9789
4 2.18e-1 0.9904 8.42e-3 1.9877 2.06e-4 3.0056 4.48e-6 3.9956
5 1.09e-1 0.9976 2.11e-3 1.9968 2.57e-5 3.0040 2.80e-7 3.9996

Tabela 6.3: Verificação do erro e(u) =? u?uh ?H1 e da taxa de convergência.

Formulação mista, erros em p (Teste 2)
Nref k = 0 k = 1 k = 2 k = 3

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 3.02e-1 - 3.29e-1 - 5.84e-1 - 4.71 -
1 2.58e-1 0.2225 7.39e-2 2.1527 1.63e-2 5.1647 2.86e-3 10.687
2 1.32e-1 0.9690 1.95e-2 1.9217 2.16e-3 2.9125 1.89e-4 3.9189
3 6.57e-2 1.0075 4.95e-3 1.9780 2.75-4 2.9778 1.20e-5 3.9796
4 3.28e-2 1.0035 1.24e-3 1.9943 3.45e-5 2.9944 7.53e-7 3.9949
5 1.64e-2 1.001 3.11e-4 1.9986 4.31e-6 2.9986 4.71e-8 3.9987

Tabela 6.4: Verificação do erro numérico e(p) =? p?ph ?L2 e da taxa de convergência.

Formulação mista, erros em q (Teste 2)
Nref k = 1 k = 2 k = 3 k = 4

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 10.00 - 5.534 - 1.132 - 7.32e-1 -
1 4.376 1.1934 8.43e-1 2.7151 1.59e-1 2.8357 2.28e-2 5.0057
2 1.201 1.8647 1.18e-1 2.8346 1.06e-2 3.9014 7.73e-4 4.8823
3 3.07e-1 1.9702 1.52e-2 2.9539 6.74e-4 3.9774 2.48e-5 4.9613
4 7.70e-2 1.9935 1.92e-3 2.9872 4.23e-5 3.9940 7.82e-7 4.9871
5 1.93e-2 1.9987 2.41e-4 2.9963 2.65e-6 3.9980 2.45e-8 4.9954

Tabela 6.5: Verificação do erro numérico e(q) =? q?qh ?L2 e da taxa de convergência.

93



æ
æ

æ
æ

æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

ò

0.05 0.10 0.20 0.50 1.00

10
-5

0.001

0.1

h

°
u
-

u
h
´

H
1

ò k = 4

ì k = 3

à k = 2

æ k = 1

ææ
æ

æ
æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

ò

0.05 0.10 0.20 0.50 1.00

10-7

10-5

0.001

0.1

h

°
p
-

p
h
´

L
2

ò k = 3

ì k = 2

à k = 1

æ k = 0

æ
æ

æ

æ

æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ì

ì

ò

ò

ò

ò

ò

ò

0.05 0.10 0.20 0.50 1.00

10-6

10-4

0.01

1

h

°
q
-

q
h
´

L
2

ò k = 4

ì k = 3

à k = 2

æ k = 1

Figura 6.15: Teste 2: Erros e(u) =? u?uh ?H1 (em cima - a esquerda), e(p) =? p?ph ?L2
(em cima - a direita) e e(q) =? q?qh ?L2 (em baixo).

94



Capítulo 7

Simulação multifísica do problema
poroelástico linear

7.1 Introdução

Neste capítulo, como parte de aplicação do código multifísica e de verificação da classe
TPZPoroElasticMF2d, implementados no NeoPZ, resolve-se o problema poroelástico
linear no contexto da simulação multifísica. Utilizam-se os subespaços H1-conformes
para o deslocamento do sólido, subespaços Hdiv-conformes para o fluxo de fluido e
subespaços em L2 para a pressão do fluido. Na Seção 7.2, descreve-se a formulação
matemática do problema [75]. Na Seção 7.3, faz-se a sua formulação mista e, na Seção
7.4, fazem-se algumas aplicações numéricas sobre problemas de soluções conhecidas,
como parte de verificação do código. A análise matemática, quanto a existência e
unicidade da solução, do problema variacional contínuo e discreto pode ser vista em
[75]. Os resultados form publicados em [36].

7.2 Descrição do problema

Poroelasticidade linear trata-se do contexto em que é descrito o acoplamento do sis-
tema rocha-fluido para fluxo de fluido sobre deformações induzidas, em um meio po-
roso deformável, sob a suposição de deformações relativamente pequenas. Termos como
consolidação, compactação e subsidência são relacionados à poroelasticidade como um
resultado dos efeitos secundários observados após processos de perfuração no meio po-
roso, em que consolidação diz respeito à redução do volume de um meio poroso, devido

95



à extração de fluidos, compactação refere-se à redução de volume devido à remoção
de ar e subsidência refere-se à consolidação ou compactação orientados verticalmente.
Informações sobre esses efeitos, obtidas durante o processo de perfuração, tornam-se
muito importantes no combate a desastres mecânicos.

A teoria da poroelasticidade linear iniciou-se com o trabalho de Terzaghi [76] e
foi consolidada com os trabalhos de Biot [77, 74], em que relaciona-se o deslocamento u
do sólido com a pressão de fluido p no meio poroso. Este é um problema acoplado que
engloba a modelagem elástica do comportamento mecânico (deslocamento do sólido)
com as leis da continuidade e de fluxo em meios porosos. A teoria de Biot considera
que o meio poroso está totalmente ocupado por um fluído (fluxo monofásico), que todo
o fenômeno ocorre em condições isotérmicas e que não há interação química do fluido
com o meio poroso.

7.2.1 Problema poroelástico linear

A formulação matemática do problema poroelástico é um problema acoplado que en-
globa a modelagem elástica do comportamento mecânico com as leis da continuidade e
de fluxo em meios porosos.

De acordo com Biot [74], a modelagem elástica do comportamento mecânico com
as leis da continuidade é dada pela equação de equilíbrio (problema mecânico), que
concilia fluido-sólido,

??·?t = b, (7.1)

em que
?t = ?t(u,p,t) = ?s + ?f (7.2)

é o tensor de tensões total. Sendo ?s, o tensor das tensões efetivas atuando no sólido,
e ?f, o tensor de tensões na fase líquida, dados pelas leis constitutivas

?s = ?s(u, t) = tr (?(u)) ?I + 2µ?(u) (7.3)

e
?f = ?f (p,t) = ??pI, (7.4)

em que 0 &amp;lt;? ? 1 é o fator poroelástico de Biot. Além disso, b = (0, 0, (??f )g +
(1 ? ?)?sg) é a força de campo, g é a magnitude da força devido à gravidade, ?s é a
densidade da rocha, ?f é a densidade do fluido e ? é a porosidade da rocha [78].

96



A equação de conservação de massa, considerando ?f constante, que relaciona o
deslocamento do sólido e a pressão do fluido no meio poroso é dada por

??

?t
+ ?·q = sf, (7.5)

sendo q = ?µ?1f ?(?p ? ?fg) a velocidade de Darcy, sf um termo de fonte externa e
? = ??· u + S?p o conteúdo líquido de fluido em um volume elementar do material.
Além disso, S?p mede a quantidade de fluido que pode ser injetado em um volume
de referência e ??· u mede a quantidade de fluido que pode ser extraído do volume.
O parâmetro S? = ??/?p é uma constante não negativa (S? ? 0), conhecido como
coeficiente poroelástico ou coeficiente de armazenamento a volume constante de Biot.

Modelo matemático para o problema poroelástico

O sistema de equações diferenciais parciais acopladas para o problema poroelástico é
dado por

??·?t = b em ? ×J,
?

?t
(??·u + S?p) + ?·q = sf em ? ×J,

(7.6)

sendo J = (0,T], T &gt; 0, e com as condições

u = uD em ?D ×J,
?t ·n = uN em ?N ×J,

u(x, 0) = u0 em ?,
p = pD em ?D ×J,

q ·n = qN em ?N ×J,
p(x, 0) = p0 em ?,

(7.7)

em que uD, uN, pD, qN, u0 e p0 são funções dadas, b é a força de campo, sf um termo
de fonte externa e ?t o tensor de tensões total (7.2)-(7.4).

As equações do problema poroelástico ficam acopladas, uma vez que o parâmetro
de Biot ? 6= 0. O coeficiente de armazenamento a volume constante S? é limitado por
uma constante positiva Mc, ou seja,

0 ? S? ? Mc. (7.8)

Como citado em [75], para ? = 1 tem-se que o sólido é incompressível, para S? = 0 o

97



fluido é incompressível e para ? = 1 e S? = 0 tem-se um modelo incompressível para o
problema poroelástico.

7.3 Formulação variacional mista

Escrevendo a equação de conservação de massa (7.5) na fórmula mista, o sistema de
equações diferenciais parciais acopladas para o problema poroelástico linear (7.6) é
reescrito como

??·?t = b em ? ×J,
q +

?

µf
?p = ?f

?

µf
g em ? ×J,

?

?t
(??·u + S?p) + ?·q = sf em ? ×J,

(7.9)

com as condições iniciais e de contorno dadas em (7.7).
Definem-se

U =
{
v ?

(
H1(?)

)2
: v = 0 em ?D

}
, V = {z ? Hdiv(?) : z ·n = 0 em ?N}

e
W =

{
w ? L2(?)

}
.

A formulação variacional do problema é dada por: encontrar u ? uD + U, q ? qN + V
e p ? W tal que

ˆ
?

tr
(
?vT?s(u)

)
dx +

ˆ
?

tr
(
?vT?f (p)

)
dx?

ˆ
?N

v ·uN ds =
ˆ

?

v ·b dx

ˆ
?

q ·zdx?
?

µf

ˆ
?

p?·zdx +
?

µf

ˆ
?D

pDz ·ndx =
ˆ

?

?f

(
?

µf
z

)
·g dx

ˆ
?

(
?

?t
(??·u + S?p)

)
w dx +

ˆ
?

?·qw dx =
ˆ

?

w sf dx,

(7.10)

?v ? U, ?z ? V, ?w ? W e t ? J.

98



Formulação variacional discreta

Sejam Uh ? U, Vh ? V e Wh ? W os espaços de elementos finitos, tais que

Uh = span{?i, i = 1, ..., n} , Vh = span{?i, i = 1, ..., m} e

Wh = span{?i, i = 1, ..., r} ,

sendo ?i, ?i e ?i funções de base dos respectivos subespaços, Uh, Vh e Wh. Os termos
envolvendo a derivada temporal de primeira ordem são aproximados pelo método de
Euler implícito (atrasado). Ou seja, com uma aproximação do tipo

yn = yn?1 + ?tf(tn,y
n), (7.11)

para uma equação ?y/?t = f(t,y), em que yn ' y(tn), tn = n?t, n = 1, 2, ..., M, e
?t = T/M é o tamanho do passo de tempo.

Assim, usando um esquema implícito, o problema variacional discreto é dado por:
encontrar unh ? uD + Uh, q

n
h ? qN + Vh e p

n
h ? Wh tal que

ˆ
?

tr
(
?vTh?s(u

n
h)
)
dx +

ˆ
?

tr
(
?vTh?f (p

n
h)
)
dx =

ˆ
?

vh ·b dx +
ˆ

?N

vh ·uNds

µf

ˆ
?

(??1zh) ·qnhdx?
ˆ

?

?·zhpnh dx =
ˆ

?

?fzh ·gh dx?
ˆ

?D

pDzh ·ndx

?

ˆ
?

wh?·unhdx + S?
ˆ

?

whp
n
hdx + ?t

ˆ
?

wh?·qnhdx = ?t
ˆ

?

whsf dx+

?

ˆ
?

wh?·un?1h dx + S?
ˆ

?

whp
n?1
h dx

(7.12)
para todo vh ? Uh, zh ? Vh e wh ? Wh.

O sistema matricial resultante de (7.12) é da forma

Kxn = F + Mxn?1,

sendo K a matriz de rigidez e M a matriz de massa, tal que KN×N, MN×N, FN×1, xn?1N×1,
com N = 2nu + m + r, e

99



K =

?
???????

Au 0 Bup

0T Cq Eqp

?BTup ??tETqp Dp

?
??????? , M =

?
???????

0

0 0

?BTup 0 Dp

?
??????? , F =

?
???????

fup

hqp

?tspu

?
???????

e

xn =

?
???????
?n

?n

?n

?
??????? , ?n = 0, 1 ..., .

As submatrizes são dadas por

Au = (aij) :i,j = 1, ..., 2nu, Bup = (bik) : i = 1, ..., 2nu e k = 1, ..., r,

Cq = (cis) : i,s = 1 ..., m, Eqp = (eik) : i = 1, ..., m e k = 1, ...r,

Dp = (dik) : i,k = 1, ..., r, fup = (fi) : i = 1, ..., 2nu, hqp = (hi) : i = 1, .., m,

spu = (si) : i = 1, ..., r, ?
n =

(
?nj
)

: j = 1, ..., 2n, ?n = (?ns ) : k = 1, ..., m

e
?n = (?nk ) : k = 1, ..., r,

em que

aij =
2n?
j=1

?j

{ˆ
?

tr
(
??i

T?s(?j)
)
dx

}
, i,j = 1, ..., 2nu,

bik =
r?

k=1

?k

{
??
ˆ

?

tr
(
??i

T?s(?k)
)
dx

}
, i = 1, ..., 2nu e k = 1, ..., r,

cis =
m?
s=1

?s

{
µf

ˆ
?

(
??1?i

)
·?s dx

}
, i, s = 1, ..., m,

100



eij =
r?

k=1

?k

{
?
ˆ

?

?·?i?k dx
}
, i, = 1, ..., m e k = 1, ..., r,

dik =
r?

k=1

?k

??
?S?

ˆ

?

?i ?kdx

??
?, i,k = 1, ..., r,

fi =

ˆ
?

?i ·b dx +
ˆ

?N

?i ·uN ds, i = 1, ..., 2nu,

hi =

ˆ
?

?f?i ·g dx?
ˆ

?D

pD?i ·ndx, i = 1, ..., m,

e
si =

ˆ
?

?isf dx, i = 1, ..., r.

Rearranjando o sistema de equações (7.12), e multiplicando a segunda equação por ?t
e a terceira equação por ?1, tem-se o problema matricial simétrico final

?
???????

Au 0 Bup

0T ?tCq ?tEqp

BTup ?tE
T
qp ?Dp

?
???????

?
???????
?n

?n

?n

?
??????? =

?
???????

fup

?thqp

??tspu

?
??????? +

?
???????

0

0 0

BTup 0 ?Dp

?
???????

?
???????
?n?1

?n?1

?n?1

?
??????? ,

que é resolvido a cada passo de tempo n = 1, 2, ... M.

7.4 Aplicações

Como parte de verificação do código numérico, resolvem-se alguns problemas teste.

7.4.1 Problema de Terzaghi

O problema de Terzaghi [76] é um problema clássico unidimensional referente a uma
força de superfície aplicada a um domínio poroelástico completamente saturado por

101



um fluido. O problema é dado por uma coluna porosa de comprimento H, limitada
pelas paredes impermeáveis, exceto na sua parte superior onde uma carga de pressão
mecânica ??o é aplicada e que é livre para drenar, como representado na Figura 7.1.

z = 0

z = H ?p/?x = 0, uz = 0   

 p = 0   

?s = - ?o   

Tempo inicial Tempo final

?s = - ?o   

Figura 7.1: Esquema da coluna poroso do problema de Terzaghi.

As condições de contorno e iniciais do problema são

?s ·n = ?s = ??o e p = 0 em z = 0,
uz = 0 e ?p/?z = 0 em z = H,
uz = 0 e p = 0 em t = 0 e z ? (0,?H),

(7.13)

em que ?s(t)|t=0 = 0 e ?s(t) = ??o para t &gt; 0. Além disso, assume-se que o meio poroso
é homogêneo, com kx = kz = ks. A permeabilidade da rocha (ks) e a viscosidade do
fluido (µf) são constantes. Não se consideram termo fonte (sf = 0) e força de gravidade
(g = 0).

A solução p(z,t) do problema de Terzaghi apresenta forte gradiente em z = 0,
para t ? 0+. Este comportamento sugere que os maiores erros na aproximação devem
ocorrer nos tempos iniciais. Mas, fixando o tamanho h dos elementos da malha e
discretizando no tempo, o erro cai com o tempo. Na obtenção da taxa de convergência,
a fim de minimizar os efeitos do erro produzido pela discretização do tempo, escolhe-se
passo de tempo bem pequeno ?t = 10?6.

Como a solução do problema de Terzaghi é constante na largura da coluna (Figura
7.2), o problema é resolvido em um domínio bidimensional e os resultados são mostrados
no corte vertical central.

102



Figura 7.2: Caso 1: pressão adimensional analítica do problema de Terzaghi no tempo
final t = 1000 s.

Caso 1: S? 6= 0

Neste caso, a solução analítica para a variável da pressão do problema de Terzaghi é
dada pela série numérica [75]

p(z,t) =
??0

S?(Ku + 4µ/3)

??
n=0

4

?(2n + 1)
sen
(

(2n + 1)?

2H
z

)
exp

(
(2n + 1)2?2

2H2
cft

)
,

com Ku = K + ?2/S?, K = ? + 2µ/3 e cf = k(K + 4µ/3)/ (µfS?(Ku + 4µ/3)), sendo
? e µ os coeficientes de Lamé, ks a permeabilidade da rocha e µf a viscosidade do
fluido. A pressão e o tempo adimensionais são dados, respectivamente, por pD = p/p+,
com p+ = ?

S?
?0

Ku+4µ/3
, e tD = t

cf
H2

. A Tabela 7.1 resume os dados do problema e os
parâmetros do material poroelástico utilizados.

Parâmetros valor unidade
módulo de Young (E) 3 × 105 Pa
coeficiente de Poisson (?) 0.2 -
permeabilidade (ks) 10?10 m2
viscosidade (µf) 10?4 Pas
fator poroelástico de Biot-Willis (?) 1.0 -
coeficiente poroelástico (S?) 10?1 Pa?1
carga aplicada (?0) 103 Pa
comprimento (H) 1 m

Tabela 7.1: Caso 1 - parâmetros do material.

103



Malha triangular. Na primeira abordagem, utiliza-se uma malha formada por ele-
mentos triangulares. Para ordem polinomial k, define-se por Puk×PkPk?1 a combinação
dos espaços de aproximação, sendo Puk o subespaço de funções H1-conformes usados
para o deslocamento e PkPk?1 o par de subespaços de funções em Hdiv e L2 usados
para o fluxo e a pressão, respectivamente (Seção 3.3.3). As soluções analíticas e nu-
mérica, em tempos distintos, são ilustradas na Figura 7.3. Os gráficos mostrando a
evolução dos erros e(p) =? p?ph ?L2 e e(q) =? q?qh ?L2 são ilustrados na Figura
7.4. Fica evidente o decaimento do erro em função do tempo e o aumento da precisão
com o refinamento da malha e a ordem polinomial.

Na Tabela 7.2 e na Figura 7.5 mostram-se os erros, medidos na norma L2, na
aproximação do valor da pressão e do fluxo no tempo tD = 5×10?2, para uma configu-
ração dos espaços com k = 1, 2. Observa-se que é obtida taxa de convergência ótima
na aproximação da pressão e do fluxo, com h ? 0.

Malha retangular. Define-se por Quk+1 × Q
+
k Qk a combinação de espaços de apro-

ximação, em que Quk+1 refere-se ao espaço de funções em H1 para o deslocamento e
Q+k Qk ao par de espaços de funções em Hdiv e L

2, respectivamente. A notação Q+k
refere-se ao espaço de funções polinomiais de ordem k acrescido de algumas funções de
ordem k + 1, para efeitos de compatibilidade, como definido em [35].

Usando k = 1 e k = 2, os resultados da Figura 7.6 mostram que os erros na
norma L2 decaem com o tempo e a precisão melhora com o refinamento da malha e
com o aumento da ordem polinomial. Na Tabela 7.3 e na Figura 7.7 motram-se os
erros, medidos na norma L2, na aproximação do valor da pressão e do fluxo no tempo
tD = 5×10?2. Observa-se que é obtida taxa de convergência ótima na aproximação da
pressão, com h ? 0. Na aproximação do fluxo, obtém-se taxa ótima apenas para k = 1.
Para esquema de ordem maior, k = 2, à medida que o espaçamento da discretização
espacial diminui, o erro é dominado pela discretização temporal de primeira ordem
utilizada (Euler implícito).

104



ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

é

é

é

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

é

é

é

é

é

é

é

é

é

é

é

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

éééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

0.0 0.2 0.4 0.6 0.8 1.0

0.0

0.2

0.4

0.6

0.8

1.0

zD

p
D

p, t = 1´104

é ph, t = 1´10
4

p, t = 6´103

é ph, t = 6´10
3

p, t = 3´103

é ph, t = 3´10
3

p, t = 5´102

é ph, t = 5´10
2

Figura 7.3: Caso 1: soluções numérica (ph) e analítica (p) do problema de Terzaghi
em uma configuração Pu2 × P2P1 de espaços e com h = 1/64. Sendo zD = z?/H, com
z? = z + H.

æ

æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ

à

à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à

ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì

ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò

0.0 0.2 0.4 0.6 0.8 1.0

0.001

0.002

0.005

0.010

0.020

0.050

tD

°
p
-

p
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 1

æ

æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ

à

à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à

ì

ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì

ò

ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò

0.0 0.2 0.4 0.6 0.8 1.0

1´10
-5

5´10
-5

1´10
-4

5´10
-4

0.001

0.005

tD

°
p
-

p
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 2

æ

æ

æ

æ

æ
æ
æ
æ æ æ æ æ æ æ æ æ æ æ æ æ

à

à

à

à

à
à
à
à à à à à à à à à à à à à

ì

ì

ì

ì
ì
ì
ì
ì ì ì ì ì ì ì ì ì ì ì ì ì

ò

ò

ò

ò

ò
ò
ò
ò ò ò ò ò ò ò ò ò ò ò ò ò

0.0 0.2 0.4 0.6 0.8 1.0

10
-4

0.001

0.01

tD

°
q
-

q
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 1

æ

æ

æ

æ
æ
æ æ æ æ æ æ æ æ æ æ æ æ æ æ æ

à

à

à

à
à
à à à à à à à à à à à à à à à

ì

ì

ì

ì
ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì

ò

ò

ò

ò
ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò

0.0 0.2 0.4 0.6 0.8 1.0

10
-6

10
-5

10
-4

0.001

tD

°
q
-

q
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 2

Figura 7.4: Caso 1 em uma malha triangular. Evolução dos erros na pressão (em cima)
e fluxo (em baixo), medidos na norma L2, na configuração Puk ×PkPk?1.

105



Pu1 ×P1P0 P
u
2 ×P2P1

h Pressão (p) Fluxo (q) Pressão (p) Fluxo (q)
1 0.260040 0.351239 0.094725 0.118246
1/2 0.155788 0.097565 0.022633 0.039404
1/4 0.078699 0.038041 0.005340 0.004033
1/8 0.039356 0.010244 0.001345 0.000477
1/16 0.019677 0.002609 0.000337 5.8834e-5
1/32 0.009838 0.000652 8.4275e-5 1.0984e-5

Tabela 7.2: Caso 1 em uma malha triangular. Verificação do erro na aproximação de
(q,p) na norma L2.

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

0.05 0.10 0.20 0.50 1.00

1´10
-4

5´10
-4

0.001

0.005

0.010

0.050

0.100

h

°
p
-

p
h
´

L
2

à k = 2

æ k = 1

1

1

2

1

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
q
-

q
h
´

L
2

à k = 2

æ k = 1

2

1

3

1

Figura 7.5: Caso 1 em uma malha triangular. Erros na norma L2 da pressão (lado
esquerdo) e do fluxo (lado direito) na configuração Puk ×PkPk?1.

Pu2 ×Q
+
1 Q1 P

u
3 ×Q

+
2 Q2

h Pressão (p) Fluxo (q) Pressão (p) Fluxo (q)
1 0.120753 0.107747 0.021267 0.098270
1/2 0.029328 0.056141 0.002893 0.002752
1/4 0.006882 0.005708 0.000556 0.000439
1/8 0.001735 0.000666 7.0542e-5 2.8736e-5
1/16 0.000435 8.1843e-5 8.9667e-6 8.6755e-6
1/32 0.000109 1.2961e-5 1.8304e-6 8.5099e-6

Tabela 7.3: Caso 1 em malha retangular. Verificação do erro numérico, na aproximação
de (q,p) na norma L2.

106



æ

æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ

à

à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à

ì

ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì
ì

ò

ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò
ò

0.0 0.2 0.4 0.6 0.8 1.0

1´10
-5

5´10
-5

1´10
-4

5´10
-4

0.001

0.005

tD

°
p
-

p
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 1

æ

æ

æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ

à

à

à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à
à

ì

ì

ì
ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì

ò

ò

ò
ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò

0.0 0.2 0.4 0.6 0.8 1.0

10
-6

10
-5

10
-4

tD

°
p
-

p
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 2

æ

æ

æ

æ
æ
æ æ æ æ æ æ æ æ æ æ æ æ æ æ æ

à

à

à

à
à
à à à à à à à à à à à à à à à

ì

ì

ì

ì
ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì

ò

ò

ò

ò
ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò

0.0 0.2 0.4 0.6 0.8 1.0

10
-6

10
-5

10
-4

0.001

tD

°
q
-

q
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 1

æ

æ

æ

æ

æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ
æ

à

à

à

à

à
à à à à à à à à à à à à à à à

ì

ì

ì

ì

ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì ì

ò

ò

ò

ò

ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò ò

0.0 0.2 0.4 0.6 0.8 1.0

1´10
-6

5´10
-6

1´10
-5

5´10
-5

1´10
-4

5´10
-4

tD

°
q
-

q
h
´

L
2

ò h = 1?32

ì h = 1?16

à h = 1?8

æ h = 1?4

k = 2

Figura 7.6: Caso 1 em malha retangular. Evolução dos erros e(p) e e(q), medidos na
norma L2, na configuração Quk+1 ×Q

+
k Qk.

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
p
-

p
h
´

L
2

à k = 2

æ k = 1

1

1

3

2

æ

æ

æ

æ

æ

æ

à

à

à

à

àà

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
q
-

q
h
´

L
2

à k = 2

æ k = 1
2

1

3

1

Figura 7.7: Caso 1 em malha retangular. Gráficos log-log dos erros e(p) e e(q), na
norma L2, na configuração Quk+1 ×Q

+
k Qk.

107



Caso 2: S? = 0

Considera-se o caso incompressível ( ? = 1 e S? = 0) com os dados do problema e os
parâmetros do material mostrados na Tabela 7.4.

De acordo com [79], a solução analítica para este caso é dada por

?D(z,t) = ?1 +
??
n=0

2

M
sin (M zD) exp

?M2tD,

uD(z,t) = 1 ?zD ?
??
n=0

2

M2
cos (M zD) exp

?M2tD,

pD(x,t) =
??
n=0

2

M
sin (M zD) exp

?M2tD,

em que

zD =
z

H
, tD =

(? + 2µ)k t

µfH
, M =

?

2
(2n + 1)

são quantidades adimensionais e

?D = ?s/p0, uD = uz(? + 2µ)/p0H e pD = p/p0

são, respectivamente, a tensão efetiva atuando no sólido, o deslocamento e a pressão de
poro adimensionais.

Parâmetros valor unidade
módulo de Young (E) 3 × 104 Pa
coeficiente de Poisson 0.2 -
permeabilidade (ks) 10?10 m2
viscosidade (µf) 10?3 Pas
fator poroelástico de Biot-Willis (?) 1.0 -
coeficiente poroelástico (S?) 0 -
carga aplicada (?0) 103 Pa
pressão inicial (p0) ?0 Pa
deslocamento inicial (u0) 0
tempo total de simulação (t) 300. s

Tabela 7.4: Caso 2: dados do problema e parâmetros do material.

108



ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é

0.0 0.2 0.4 0.6 0.8 1.0

-0.8

-0.6

-0.4

-0.2

0.0

zD

u
D

é uh, t = 300

u, t = 300

é uh, t = 150

u, t = 150

é uh, t = 75

u, t = 75

é uh, t = 45

u, t = 45

é uh, t = 15

u, t = 15

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

0.0 0.2 0.4 0.6 0.8 1.0

-1.0

-0.8

-0.6

-0.4

-0.2

0.0

zD

?
D

é ?h, t = 300

?, t = 300

é ?h, t = 150

?, t = 150

é ?h, t = 75

?, t = 75

é ?h, t = 45

?, t = 45

é ?h, t = 15

?, t = 15

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

éééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé
é
é
é
é
é
é

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

ééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééééé

0.0 0.2 0.4 0.6 0.8 1.0

0.0

0.2

0.4

0.6

0.8

1.0

zD

p
D

é ph, t = 300

p, t = 300

é ph, t = 150

p, t = 150

é ph, t = 75

p, t = 75

é ph, t = 45

p, t = 45

é ph, t = 15

p, t = 15

éééééééé
éééééé
ééééé
ééé
ééé
éé
éé
éé
éé
éé
éé
éé
éé
éé
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
é
éé
éé
éé
éééé
ééé

éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
ééé
ééé
ééé
ééé
éééé
éééé
éééééé
ééééééé

éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
éé
ééé
ééé
ééé
ééé
ééé
ééé
ééé
ééé
éééé
éééé
ééééé
ééééééé

ééééééééééééé

ééé
ééé
ééé
ééé
éééé
éééé
éééé
éééé
éééé
éééé
éééé
éééé
éééé
ééééé
ééééé
ééééé
éééééé
éééééééé

ééééééééééé
ééééééééééééé

ééééééééééé
ééééééééééé

éééééééééééé
ééééééééééééé

éééééééééééééééé
éééééééééééééééééééééééééééééé

éééééééé

0.0 0.2 0.4 0.6 0.8 1.0

0.0

0.5

1.0

1.5

2.0

2.5

zD

q
D

é qh, t = 300
q, t = 300

é qh, t = 150
q, t = 150

é qh, t = 75
q, t = 75

é qh, t = 45
q, t = 45

é qh, t = 15
q, t = 15

Figura 7.8: Caso 2 - problema incompressível. Soluções analítica e numérica em alguns
instantes, para a configuração de espaços Pu3 × P3P2 e espaçamento h = 1/32. Sendo
zD = z?/H, com z? = z + H.

Uma comparação da solução analítica com a solução numérica é mostrada na
Figura 7.8, para uma configuração Pu3 ×P3P2, em vários instantes. Nas Tabelas 7.5-7.7
e na Figura 7.9 mostram-se os erros nas aproximações do deslocamento, na norma H1,
pressão e do fluxo, medidos na norma L2, calculados no tempo tD = 5×10?2. Observa-
se que nas aproximações do deslocamento e da pressão obtém-se taxa de convergência
ótima. Na aproximação do fluxo obtém-se taxa de convergência ótima apenas para
para k = 1, 2. Para valores maiores da ordem polinomial k o erro é dominado pela
discretização temporal de primeira ordem. Observa-se também que os erros numéricos
decaem com o refinamento da malha e com o aumento da ordem polinomial.

109



Análise na aproximação do deslocamento (u)
h Pu1 ×P1P0 P

u
2 ×P2P1 P

u
3 ×P3P2

1 0.258556 0.096168 0.016848
1/2 0.168848 0.025346 0.002465
1/4 0.089165 0.006294 0.000480
1/8 0.045620 0.001630 6.1829e-5
1/16 0.023031 0.000413 7.9455e-6
1/32 0.011556 0.000104 1.7115e-6

Tabela 7.5: Caso 2 - problema incompressível em malha triangular. Verificação do erro
na norma H1 na aproximação do deslocamento.

Análise na aproximação da pressão (p)
h Pu1 ×P1P0 P

u
2 ×P2P1 P

u
3 ×P3P2

1 0.264299 0.094640 0.016927
1/2 0.157639 0.022957 0.002276
1/4 0.078998 0.005348 0.000421
1/8 0.039404 0.001345 5.3360e-5
1/16 0.019683 0.000337 6.8454e-6
1/32 0.009839 8.4269e-5 1.6814e-6

Tabela 7.6: Caso 2 - problema incompressível em malha triangular. Verificação do erro
numérico na norma L2 na aproximação da pressão.

Análise na aproximação do fluxo (q)
h Pu1 ×P1P0 P

u
2 ×P2P1 P

u
3 ×P3P2

1 0.329513 0.105601 0.079751
1/2 0.122953 0.049389 0.002856
1/4 0.047640 0.005350 0.000394
1/8 0.013697 0.000648 2.6119e-5
1/16 0.003561 8.0807e-5 8.6464e-6
1/32 0.000898 1.2914e-5 8.5114e-6

Tabela 7.7: Caso 2 - problema incompressível em malha triangular. Verificação do erro
numérico na norma L2 na aproximação do fluxo.

110



æ
æ

æ

æ

æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ì

ì

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
u
-

u
h
´

H
1

ì k = 3

à k = 2

æ k = 1

1

1

2

3

1

1

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ì

ì

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
p
-

p
h
´

L
2

ì k = 3

à k = 2

æ k = 1

1

2

3

1

1

1

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

ì

ì

ì

ì

ìì

0.05 0.10 0.20 0.50 1.00

10
-5

10
-4

0.001

0.01

0.1

h

°
q
-

q
h
´

L
2

ì k = 3

à k = 2

æ k = 1

2

3

4

1

1

1

Figura 7.9: Caso 2 - problema incompressível em malha triangular. Erros e(u), na
norma H1, e(p) e e(q), na norma L2, na configuração Puk ×PkPk?1.

111



112



Capítulo 8

Simulação multifísica do problema de
injeção de traçador em meios porosos

8.1 Introdução

Como segundo exemplo ilustrativo da utilização do código multifísica implementado
no NeoPZ, considera-se a resolução de um problema de injeção de traçador em meios
porosos.

O traçador é um composto utilizado para marcar uma das fases em um sistema de
mistura de dois fluidos com o objetivo de acompanhar a evolução desta fase no tempo e
no espaço. Na Engenharia de Petróleo, testes com injeção de traçadores são realizados
para caracterizar o reservatório, informando, por exemplo, a direção preferencial do
escoamento, a existência de barreiras ao escoamento, comunicação entre reservatórios
etc. Outra aplicação envolvendo traçadores é a modelagem da dispersão de poluentes em
aquíferos. Informações mais detalhadas sobre o problema e das equações aqui tratadas
podem ser obtidas nas referências [80, 81, 82].

O modelo matemático que descreve o problema de injeção de traçador em meios
porosos consiste de um sistema elíptico, proveniente da lei de Darcy, condição de in-
compressibilidade para os campos de pressão e velocidade e de uma equação linear de
transporte hiperbólica para a saturação do fluido marcado. Além disso, a equação de
transporte é tal que a velocidade do fluido é obtida a partir do problema elíptico. Sendo
assim, é necessário escolher um método numérico para o problema elíptico que aproxime
de forma direta e precisa a velocidade do fluido. O método de elementos finitos mistos
é uma boa escolha.

113



Neste trabalho, este problema é resolvido no contexto da simulação multifísica.
Resolve-se o sistema elíptico pelo método dos elementos finitos mistos, em que utilizam-
se os subespaços Hdiv-conformes para o fluxo de fluido (velocidade de Darcy) e subes-
paços em L2 para a pressão. O problema de transporte é resolvido explicitamente pelo
método de Galerkin descontínuo, com um esquema upwind, usando os espaços partici-
onados de Sobolev de baixa ordem (funções constantes por partes) para a saturação.
Além disso, aplicam-se a técnica de reconstrução de gradientes e a linearização da so-
lução de modo a se obter uma melhor aproximação na solução numérica através de
um esquema de segunda ordem [83, 84]. A aproximação temporal é feita através de
um método de Runge-Kutta explícito de dois estágios [85]. Alguns resultados obtidos
foram publicados em [37].

Este capítulo é composto das seguintes seções. Na Seção 8.2, descreve-se o mo-
delo matemático do problema de injeção de traçador em meios porosos. Na Seção
8.3, descreve-se a formulação variacional e semidiscreta do problema. Na Seção 8.4
decreve-se um esquema para gerar aproximações de segunda ordem para a equação de
transporte. A Seção 8.5 é dedicada a alguns experimentos numéricos.

8.2 Modelo matemático

O escoamento incompressível de um traçador em um meio poroso é governado pela
equação linear de transporte

?
?s

?t
+ q ·?s = 0 em ? ×J, (8.1)

em que s(x, t) é a concentração do fluido marcado e q = q(x) é a velocidade do campo,
dada pela lei de Darcy e representada pelo sistema elíptico

q = ?
?

µ
?p em ?,

?·q = 0 em ?.
(8.2)

Nas equações (8.1) e (8.2) não são considerados os efeitos da gravidade e da pressão
capilar. Além disso, tem-se que µ &gt; 0 é a viscosidade dos dois fluidos (os fluidos têm
viscosidades iguais), ? = ?(x) &gt; 0 é a permeabilidade absoluta do meio, p é a pressão,
a porosidade do meio poroso ? &gt; 0 é constante, ? ? R2 e J = (0,T] com T &gt; 0 um

114



número real fixo. As condições de contorno e inicial do problema (8.1)-(8.2) são

s(x, 0) = s0 em ?,
s(x, t) = g em ?? ×J
q ·n = qN em ?N,
p = pD em ?D,

(8.3)

sendo n a normal externa à ??, ?? ? ?? o contorno de entrada de fluxo (inflow), ?N
o contorno de Neumann e ?D o contorno de Dirichlet.

Observa-se que a solução do problema elíptico (8.2) não depende da solução do
problema de transporte (8.1). Sendo assim, resolve-se primeiro o problema elíptico,
para as variáveis p e q, e em seguida o problema de transporte (8.2) para a variável s.

8.3 Formulações variacionais e discretas

Definem-se os espaços funcionais

V = {z ? Hdiv(?) tal que z ·n = 0 em ?N} , (8.4)

W =
{
w ? L2(?)

}
(8.5)

e o espaço de Sobolev particionado

V =
{
v ? L2(?) : v|K ? H

2(K), ?K ?T
}
. (8.6)

em que T é uma partição disjunta de ?.
Definem-se os espaços de elementos finitos Vh ? V, Wh ? W e V kh (T ) ? V (T )

tais que

Vh = span{?i, i = 1, ..., m} , Wh = span{?i, i = 1, ..., n} e

V kh = span{?i, i = 1, ..., r} , sendo k a ordem polinomial da função ?i.

Assim, para todo qh ? Vh, ph ? Wh e sh ? V kh ,

qh =
m?
j=1

?j?j, ph =
n?
j=1

?j?j e sh =
r?
j=1

?j?j, ?j, ?i, ?j ? R.

115



8.3.1 Problema elíptico

Considerando os espaços (8.4)-(8.5), a formulação variacional do sistema elíptico (8.2)
com as condições de contorno em (8.3) é dada por: encontrar q ? qN + V e p ? W tal
que

a(q,z) ? b(z,p) = l(z), ?z ? V,
b(q,w) = 0, ?w ? W,

com

a(q,z) =

ˆ
?

??1µ (q ·z) dx, b(z,p) =
ˆ

?

p?·zdx e l(z) = ?
ˆ

?D

pD?·zds.

O problema variacional discreto é dado por: encontrar qh ? qN + Vh e ph ? Wh
tal que

a(qh,zh) ? b(zh,ph) = l(zh), ?zh ? Vh,
b(qh,wh) = 0, ?wh ? Wh.

Após multiplicar a segunda equação por ?1, representar as soluções nas bases dos
espaços de aproximação e usar as funções de base como funções teste, obtém-se o
sistema linear

m?
j=1

?j

{ˆ
?

??1µ
(
?i ·?j

)
dx

}
+

m+n?
j=m+1

?j?m

{
?
ˆ

?

?·?i?j?m dx
}

= ?
ˆ

?D

pD?·?i ds,

m?
j=1

?j

{
?
ˆ

?

?k?m?·?j dx
}

= 0,

para i = 1, ..., m e k = m + 1, ..., m + n, que pode ser representado na forma matricial(
A B

Bt 0

)(
?

?

)
=

(
f

0

)
,

tal que A = (aij) m×m, B = (bij)m×n, ? = (?j)m×1, ? = (?j)n×1 e f = (fi)m×1, sendo

aij =

ˆ
?

??1µ
(
?i ·?j

)
dx, bij = ?

ˆ
?

?·?i?j?m dx, e fi = ?
ˆ

?D

pD?·?i ds.

116



8.3.2 Problema de transporte

Definem-se, respectivamente, os contorno de entrada (inflow) e saída (outflow),

?? = {x ? ?? : (q ·n)(x) &amp;lt;0} e ?+ = {x ? ?? : (q ·n)(x) ? 0} ,

em que n é a normal externa a ??. Além disso, para cada elemento K ?T , divide-se
o seu contorno, ?K, em contorno de entrada e saída, respectivamente,

?K? = {x ? ?K : (q ·n)(x) &amp;lt;0} e ?K+ = {x ? ?K : (q ·n)(x) ? 0} ,

em que n é a normal externa a ?K.

Formulação semidiscreta de Galerkin descontínuo

Para a equação de transporte considera-se o método de Galerkin descontínuo, conhecido
como RKDG (Runge-Kutta Discontinuous Galerkin Methods), proposto em [85] para
resolução de problemas com convecção dominante. Multiplicando a equação de trans-
porte (8.1) por uma função teste v ? V (T ), do espaço (8.6), e utilizando a condição de
contorno em (8.3) tem-se que

?
K?T

{ˆ
K

?
?s

?t
v dx?

ˆ
K

s(q ·?v)dx +
ˆ
?K\?K?

v(sq) ·nds

}
+

ˆ
?K?

vg(q·n)ds = 0, (8.7)

em que ?K? = ?K ? ??. Como as funções em V (T ) são descontínuas em ?K, o termo
da integral sobre esses contornos é aproximado por um fluxo numérico FK(s).

Observa-se que o método de Galerkin descontínuo de menor ordem, utilizando
subespaços V 0h (T ) ? V

k
h (T ) formados por funções constantes por partes, corresponde

aos conhecidos esquemas de volumes finitos, e que variam dependendo da escolha do
fluxo numérico

FK(s) ?
ˆ
?K\?K?

s(q ·n)ds. (8.8)

Sendo assim, a formulação semidiscreta do problema (8.1) torna-se: encontrar sh ?
V 0h (T ) ? V

k
h (T ) tal que, ?K ?T ,

ˆ
K

?
?sh
?t

dx + FK(sh) +
ˆ

?K?

vg(q ·n)ds = 0. (8.9)

117



Como analisado em [86, 85, 87], a escolha do fluxo numérico pode ser feita de forma
a satisfazer certas características, tais como consistência, monotocidade, continuidade
Lipschitz, etc., de modo a manter as propriedades de estabilidade e convergência do
método. Os esquemas monótonos são capazes de reproduzir soluções numéricas não
oscilatórias condizentes com a solução física do problema. No entanto, esquemas mo-
nótonos são apenas de primeira ordem de precisão, mesmo quando a solução exata for
suave.

Como exemplo, tem-se o fluxo upwind, em que para as interfaces do elemento que
têm entrada de fluxo (q · n &amp;lt;0) o valor de sh em FK(sh) é o valor s? do elemento
vizinho e para as interfaces de saída de fluxo (q ·n ? 0), o valor de sh é dado pelo valor
s+ do próprio elemento. A Figura 8.1 esquematiza o significado de s? e s+.

K s
-

s
+

s
+

s
-

n
q

n

s
+

s
-

n n

Figura 8.1: Esquema da entrada e saída de fluxo em um elemento K.

8.4 Esquema de segunda ordem para o problema de

transporte

Uma das técnicas para gerar aproximações de volumes finitos de ordens superiores para
problemas de transporte consiste em utilizar no cálculo do fluxo numérico reconstru-
ções da solução numérica por funções polinomiais por partes de grau maior do que zero,
combinadas com limitadores de momentos. Neste trabalho, restringe-se apenas ao caso
de segunda ordem usando o método de reconstrução linear com limitação do gradiente
[83, 87]. A idéia é, a partir de aproximações constantes por partes, reconstruir o gradi-
ente e definir uma função linear por partes sL. A fim de evitar soluções numéricas com
oscilações e fortes gradientes, aplica-se um limitador na inclinação da função linear.
Em seguida, a função linear resultante é usada para avaliar o fluxo numérico FK(sL).
Então, a formulação variacional discreta do problema é integrada no tempo por um
esquema de Runge-Kutta de segunda ordem. A seguir, descrevem-se com mais detalhes
as etapas deste processo.

118



8.4.1 Reconstrução linear por partes

A idéia do processo consiste em reconstruir a solução constante por partes como uma
função linear por partes em cada elemento K, de modo a obter um esquema de segunda
ordem de precisão.

Seja s(x) = s?K,x = (x,y) ? K, uma função constante por partes. Sendo s?K, a
média celular de s(x) no elemento K. Uma linearização de s(x) é dada por

sL(x) = s?K + ?K · (x? x?), ?K ?T ,

em que x? é um ponto arbitrário contido em K e ?K é um vetor gradiente (a ser
estimado) de sL em K.

Para esquemas de volumes finitos, uma condição necessária ao processo de line-
arização é que a média celular da função linearizada sL e da função original s sejam
iguais, isto é,

sK =
1

vol(K)

ˆ
K

s(x) dV =
1

vol(K)

ˆ
K

sL(x) dV, (8.10)

sendo vol(K) o volume de K (ou área, no caso bidimensional). Para qualquer função
afim, sabe-se que sua média celular em um dado elemento K corresponde a seu valor
no centróide do elemento. Sendo assim, independente do valor do gradiente ?K, a
condição (8.10) é satisfeita quando x? = x0, em que x0 é o centróide do elemento K,
cujas coordenadas x0 = (x0,y0) são dadas por

x0 =
1

vol(K)

ˆ
K

xdV e y0 =
1

vol(K)

ˆ
K

y dV.

Oscilações durante o processo de linearização são evitadas aplicando um limitador
para o gradiente. O objetivo é evitar a formação de novos mínimos e máximos locais,
ou seja, que o valor sL|K seja maior ou menor que o valor calculado nos seus elementos
vizinhos. Com isso o processo de linearização é definido abaixo.

Definição 8.1. (Linearização por partes) Seja s(x) uma função constante por partes
com médias celulares s?K em cada elemento K ? T . O processo de linearização por
partes corresponde a encontrar uma função linear por partes de forma que, em cada
elemento K ?T , tenha-se a expressão

sL(x)
??
K

= s?K + ?K?K · (x?x0), ?K ?T , (8.11)

119



em que x0 é o centróide de K, ?K é um gradiente calculado por uma técnica de
reconstrução e ?K ? [0, 1] é um limitador do gradiente.

Para ?K = 0 a equação (8.11) retorna a solução constante por partes, e para
?K = 1 corresponde a um esquema sem limitador do gradiente. Na seção seguinte,
descreve-se a técnica de reconstrução do gradiente utilizada e sua função limitadora.

8.4.2 Reconstrução explícita do gradiente

Neste trabalho utiliza-se a técnica dos mínimos quadrados para a reconstrução explícita
do gradiente. Existem outras técnicas utilizadas na reconstrução do gradiente, por
exemplo, tem-se a reconstrução explícita via fórmula de Green-Gauss [88]. A grande
vantagem da reconstrução via mínimos quadrados é que não se necessita dos valores da
solução nas fronteiras dos elementos, apenas dos valores nos centróides dos elementos.

Dado um elemento K ?T , usam-se as seguintes notações:

• N(K) = número de elementos Ki vizinhos à K, vizinhança pelas faces de dimensão
dim(K) ? 1

• V(K) = {Nj, j = 1, 2, ..., n} é o conjunto dos vértices (nós) do elemento K.
Nota-se que n ? dim(K), dependendo da geometria do elemento.

• xi = (xi,yi) é o centróide de Ki, i = 1, 2, ..., N(K)

• si = s(xi) é a média celular no elemento vizinho Ki, i = 1, 2, ..., N(K)

Seja sL dada pela fórmula (8.11). Em uma primeira etapa, assume-se que
?K = 1. Como já foi observado anteriormente, a média celular de sL coincide com
s?K. O objetivo da técnica é estimar um vetor ?K de forma que a média celular de
sL também reproduza as médias celulares de s nos elementos vizinhos. Sendo assim,
obtém-se o sistema linear sobredeterminado:

s?i ? s?K = ?K · (xi ?x0), i = 1, 2, ...N(K), (8.12)

a ser resolvido no sentido de mínimos quadrados ponderados. Ou seja, multiplica-se
a equação de cada coordenada por pesos ?i, conforme [88]. Seja N ? V(K) o nó de
mínima distância a x0,

? x0 ?N ?= min
j
? x0 ?Nj ? .

120



A ideia, nas escolhas dos pesos ?i, é atribuir maiores pesos aos elementos vizinhos Ki
com baricentros mais próximos ao nó N. Uma das escolhas é tomar a média harmônica
das respectivas distâncias ? xi ?N ?, ou seja

?i =
? xi ?N ??c

N(K)?
j=1

(? xj ?N ??c)
, i = 1, 2, ..., N(K), (8.13)

em que c, o parâmetro de ponderação, é um valor constante valendo 0, 1 ou 2. É claro
que, para c = 0 tem-se o método dos mínimos quadrados sem ponderação. O valor de
c = 1 ou 2 vai depender da distorção da malha ou da razão de aspecto (aspect ratio)
dos elementos. Quanto mais distorcida for a malha maior será o valor de c.

Neste trabalho, utiliza-se a fatoração QR com refletor de Householder para a
resolução do problema de mínimos quadrados ponderados. Uma das vantagens da
fatoração QR é possuir número de condicionamento da mesma ordem de grandeza da
matriz original. Além disso, o método de Householder é mais estável que o método de
Gram-Schmidt.

x
0

x
1

x
2

x
4

x
3

K

K
1K

2

K
3

K
4

N
1

N
2

N
3

Figura 8.2: Elemento triangular K e seus vizinhos Ki, utilizados no esquema da recons-
trução do gradiente via mínimos quadrados.

Para ilustrar o processo de reconstrução do gradiente, considera-se um elemento
triangular K, dim(K) = 2, e seus quatro elementos vizinhos K1, K2, K3 e K4, conforme
Figura 8.2. Assim a relação (8.12) é vista como um sistema linear sobredeterminado de
quatro equações para duas incógnitas ?K = (?sL/?x,?sL/?y)K.

Multiplicando o sistema linear (8.12) por um peso (ponderação) ?i ? (0, 1], que é

121



escolhido de acordo com a distorção da malha, tem-se a sua representação matricial?
?????

?1?x1 ?1?y1

?2?x2 ?2?y2

?3?x3 ?3?y3

?4?x4 ?4?y4

?
?????
(
?sL/?x

?sL/?y

)
K

=

?
?????

?1(s?1 ?sK)
?2(s?2 ?sK)
?3(s?3 ?sK)
?4(s?4 ?sK)

?
????? , (8.14)

com ?xi = xi ?x0 e ?yi = yi ?y0.

8.4.3 Limitador do gradiente

A ideia consiste em encontrar valores limites ?K para o gradiente reconstruído em cada
elemento K. Adota-se neste trabalho a função limitadora encontrada em [83], em que
os autores foram os primeiros a definir função limitadora para malhas não estruturadas.

Sejam os valores mínimo e máximo, respectivamente,

s?minK = min
i=1,...,N(K)

{s?i, s?K} e s?maxK = max
i=1,...,N(K)

{s?i, s?K}.

A função limitadora é dada por

?K = min
?`?{?K,V(K)}

?????????
????????

min
(

1,
s?max
K
?s?K

sL(x`)?s?K

)
, sL(x`) &gt; s?K

min
(

1,
s?min
K
?s?K

sL(x`)?s?K

)
, sL(x`) &amp;lt;s?K

1 caso contrário

, (8.15)

em que x` é a coordenada do centróide em cada aresta do contorno e nó (ou vértice) de
K e sL(x`)|K é calculado usando a equação da reconstrução linear (8.11) com ?K = 1.

Considere uma malha com refinamento h não uniforme, em que um elemento K
pode ter como vizinho, por uma das arestas, mais de um elemento. Neste caso, no
cálculo de ?K (8.15), o valor do centróide x` referente a esta aresta é substituído pelos
valores dos centróides das arestas de vizinhança desses elementos vizinhos. Por exemplo,
tomando-se o elemento K da Figura 8.2, o centróide x` da aresta vizinha aos elementos
K3 e K4 será substituída pelos centróides x` das arestas de ?K3 e ?K4 vizinhas ao
elemento K.

De acordo com [84], para o caso não linear da equação de transporte (8.1), a não

122



diferenciabilidade da função limitadora (8.15) causa grandes degradações na conver-
gência do método. Sendo assim, uma versão suave para (8.15) é obtida substituindo a
função min(1,y) por

l(y) =
y2 + 2y

y2 + y + 2
.

Outras funções limitadoras para reconstrução de alta ordem, maior ou igual a 2, podem
ser obtidas em [89].

8.4.4 Integração temporal de Runge-Kutta

A formulação semidiscreta (8.9) está na forma de uma EDO dada por

?u/?t = L(u), (8.16)

em que L = ?1
?
[FK(sn?1h ) + f(g)], com

f(g) =

ˆ
?K\?K?

vg(q ·n)ds (8.17)

e FK o fluxo numérico upwind.
Consideram-se valores aproximados un ' u(tn) para a solução em instantes discre-

tos tn = n?t, n = 1, 2, ..., M e ?t = T/M. Conhecendo-se a solução un?1, o método
de Runge-Kutta explícito de 2 estágios para resolução de uma EDO do tipo (8.16) [85]
calcula a aproximação no passo de tempo seguinte usando dois estágios intermediários:

1. Faça u(0) = un?1,

2. Para k = 1, 2, calcule
u(k) = un?1 + ?tL(u(k?1)),

3. Faça

un =
u(1) ?u(2)

2
.

A condição CFL para o método é dada por
(
| qx

?t

?x
| + | qy

?t

?y
|
)
? 1/2.

Nota-se que, interrompendo o processo no primeiro estágio, o método de Runge-
Kutta descreve o método de Euler explícito de primeira ordem. Ou seja, tem-se a

123



aproximação
un = un?1 + ?tL(un?1),

para n = 1, 2, ..., M.

Formulação discreta de primeira ordem

Aplicando o método de Runge-Kutta de primeira ordem na formulação semidiscreta
(8.9), obtém-se a formulação clássica de volumes finitos upwind de primeira ordem:

• Seja a solução inicial s0h obtida pelas médias celulares da condição inicial na malha
geométrica

• Para n = 1, 2 ..., M, faça

snh = s
n?1
h ?

?t

?

[
FK(sn?1h ) + f(g)

]
, (8.18)

em que FK é o fluxo numérico upwind e f(g) é dado por (8.17).

Formulação discreta de segunda ordem

Para se obter um esquema de segunda ordem, utiliza-se o método de Runge-Kutta de
dois estágios combinado com a metodologia de cálculo dos fluxos numéricos em cada
estágio usando uma função linear por partes reconstuída com limitação do gradiente.
Tem-se então o seguinte algoritmo:

• Seja a solução inicial s0h obtida pelas médias celulares da condição inicial na malha
geométrica

• Para n = 1, 2 ..., M, faça s?(0) = sn?1h

• Para cada estágio, k = 1, 2

– Reconstrua o gradiente de s?(k?1) usando (8.12)

– Calcule o limitador do gradiente usando (8.15)

– Faça a linearização sL, (k?1) usando (8.11)

– Calcule
s?(k) = sn?1h ?

?t

?

[
FK(sL, (k?1)) + f(g)

]
,

em que FK é o fluxo numérico upwind e f(g) é dado por (8.17).

124



• Faça
snh =

1

2

[
s?(1) + s?(2)

]
• A solução final é dada pela linearização de sMh

Implementou-se no NeoPZ uma classe, com o nome de TPZGradientReconstruction,
responsável pela reconstrução do gradiente e a linearização da solução numérica.

8.4.5 Testes de verificação para o problema de transporte

Como parte de verificação do código, dois exemplos testes são resolvidos. No primeiro
exemplo, resolve-se um problema estacionário, com solução exata suave, para mos-
trar a taxa de convergência espacial do método. No segundo exemplo resolve-se um
problema de Riemann, cuja grande propriedade é a presença de descontinuidade na
solução. Mostra-se que o esquema de segunda ordem gera uma solução numérica com
melhor aproximação nas regiões com descontinuidade, quando comparado ao esquema
de primeira ordem em que se usa apenas funções constantes por partes e fluxo numérico.

De agora em diante, em todo o texto, a sigla RGL é utilizada para denotar o
algoritmo em que se faz a linearização da solução numérica com reconstrução e limitação
do gradiente. Além disso, as siglas RK1 e RK2 referem-se, respectivamente, ao método
de Runge-Kutta de um e dois estágios. Em todas as aproximações sem RGL utiliza-se
o método RK1.

Problema de transporte estacionário

O exemplo consiste em resolver o problema de condição de contorno

q ·?s(x,y) = exp[?10(x? 1)2] em ?
s(x,y) = ?0, 280247 em ?D,

(8.19)

em que ? = [0, 2] × [0, 2], ?D = [0,y] e cuja solução analítica é dada por

s(x,y) =

?
?

?
40

erf[10(x? 1)2].

O problema é resolvido em várias configurações de malhas formadas por elementos
quadrilaterais e triangulares. O número de refinamentos uniformes nos eixos x e y é
denotado por Nref.

125



Figura 8.3: Gráficos unidimensionais, corte em y = 1, dos resultados aproximados do
problema problema estacionário (8.19) para malhas quadrilaterais e tringulares com
número de refinamento Nref = 6.

Malha quadrilateral Malha triangular
Nref Com RGL Sem RGL Com RGL Sem RGL

Erro Taxa Erro Taxa Erro Taxa Erro Taxa
0 0.74098 - 0.74098 - 0.49270 - 0.49270 -
1 0.15114 2.2935 0.36587 1.0181 0.08610 2.5166 0.24120 1.0305
2 0.04282 1.8196 0.23372 0.6466 0.03739 1.2033 0.14679 0.7164
3 0.01053 2.0237 0.12656 0.8850 0.01107 1.7566 0.07789 0.9143
4 0.00218 2.2698 0.06400 0.9835 0.00290 1.9341 0.03925 0.9889
5 0.00045 2.2668 0.03210 0.9958 0.00071 2.0299 0.01966 0.9972
6 0.00011 2.1061 0.01606 0.9989 0.00012 2.0250 0.00984 0.9993
7 0.00003 2.0301 0.00803 0.9997 0.00004 2.0139 0.00492 0.9998

Tabela 8.1: Tabela dos erros de aproximação e taxa de convergência, na norma L2, com e
sem RGL para o problema estacionário (8.19). O número de refinamentos uniformes nos
eixos x e y é denotado por Nref. Malha quadrilateral (à esquerda) e malha triangular
(à direita).

Na Figura 8.3 mostram-se cortes das soluções aproximadas do problema estacio-
nário, com e sem RGL, em malhas formadas por elementos quadrilaterais e triangulares
e com um número de refinamento Nref = 6. Os valores dos erros de aproximação, na
norma L2, e as taxas de convergência são apresentados na Tabela 8.1 e na Figura 8.4.

126



Como esperado, as aproximações com e sem RGL apresentam, respectivamente, taxas
de convergência de segunda e primeira ordem.

æ

æ

æ

æ

æ

æ

æ

æ

à

à
à

à

à

à

à

à

0.01 0.02 0.05 0.10 0.20 0.50 1.00

10-4

0.001

0.01

0.1

1

h

°
.´

L
2

Malha quadrilateral

à Sem RGL

æ Com RGL

æ

æ

æ

æ

æ

æ

æ

æ

à

à

à

à

à

à

à

à

0.01 0.02 0.05 0.10 0.20 0.50 1.00

10-4

0.001

0.01

0.1

1

h

°
.´

L
2

Malha triangular

à Sem RGL

æ Com RGL

Figura 8.4: Gráficos log-log do erro de aproximação, na norma L2, com e sem RGL para
o problema estacionário (8.19). Malha quadrilateral (à esquerda) e malha triangular (à
direita).

Problema de Riemann

O problema é dado pela equação linear de transporte e condições de contorno e inicial:

?
?s

?t
+ q ·?s = 0 em ? ×J,

s0 = s(x, 0) =

{
1 em x &amp;lt;0,
0 em x &gt; 0,

s(x, t) = 1 em ?? = [0,y],

em que ? = [0, 1] × [0, 1], x = (x,y), J = (0, 1], q = (qx,qy) = (1, 0) e ? = 1. Neste
caso tem-se que a solução exata do problema é s(x, t) = s0(x? qxt).

O problema é resolvido com e sem a técnica RGL. O parâmetro de pondera-
ção da reconstrução do gradiente (8.13) é tomado igual a zero, c = 0. Na aproxi-
mação temporal aplica-se os métodos de Runge-Kutta de um e dois estágios, RK1 e
RK2, respectivamente. Na aproximação sem RGL, aplica-se apenas o método RK1.
Implementam-se dois casos, um com malha formada por elementos quadrilaterais e ou-
tro por elementos triangulares. Nos dois casos, utilizam-se a condição de CFL = 10?1

e h = 1/64 ? 0, 016.
Os resultados obtidos em malhas quadilaterais e triangulares estão apresentados,

127



respectivamentes, nas Figuras 8.5 - 8.7 e nas Figuras 8.8 - 8.10. Como pode-se observar,
todos os resultados reproduzem a descontinuidade com suavização. No entanto, as
aproximações com RGL apresentam melhores resultados do que as aproximações sem
RGL, obtidas a partir do esquema de primeira ordem, as quais apresentam maior difusão
numérica devido aos erros de discretização. Observa-se também, que a técnica com RGL
- RK1 aproxima a solução com menos difusão numérica do que a técnica RGL - RK2.
Isso é devido à descontinuidade da solução, no caso de solução mais suave espera-se que
o método RK2 apresente melhor resultado que o método RK1.

Figura 8.5: Gráficos unidimensionais dos cortes em y = 0, 5, dos resultados aproximados
do problema de Riemann com e sem RGL em malha quadrilateral com 64×64 elementos.
Soluções nos tempos t = 0, 5 (à esquerda) e t = 0, 94 (à direita).

128



Figura 8.6: Gráfico 2D dos resultados aproximados do problema de Riemann, no tempo
t = 2/3, com e sem RGL em malha quadrilateral com 64 × 64 elementos.

129



Figura 8.7: Gráficos inclinados dos resultados aproximados do problema de Riemann,
no tempo t = 2/3, com e sem RGL em malha quadrilateral com 64 × 64 elementos.

130



Figura 8.8: Gráfico 2D dos resultados aproximados do problema de Riemann, no tempo
t = 2/3, com e sem RGL em malha triangular com 64 × 128 elementos.

131



Figura 8.9: Gráficos inclinados dos resultados aproximados do problema de Riemann,
no tempo t = 2/3, com e sem RGL em malha triangular com 64 × 128 elementos.

132



Figura 8.10: Gráficos unidimensionais dos cortes em y = 0, 5, dos resultados aproxi-
mados do problema de Riemann com e sem RGL em malha triangular com 64 × 128
elementos. Soluções nos tempos t = 0, 5 (à esquerda) e t = 0, 94 (à direita).

8.5 Experimentos numéricos para o problema de in-

jeção de traçador

Implementou-se no NeoPZ a classe TPZTracerFlow, do módulo material, para simulação
numérica do problema de injeção de traçador no contexto da simulação multifísica. Para
ilustrar as verificações do código, apresentam-se alguns resultados numéricos. Em todos
os experimentos o problema é resolvido usando um modelo adimensional.

Utiliza-se a seguinte combinação dos espaços de aproximação. Na combinação
Qs0 × Q

+
k Qk para uma malha quadrilateral, Q

s
0 refere-se as funções constantes por

partes para a aproximação da concentração e Q+k Qk refere-se a aproximação do fluxo e
pressão usadas na formulação mista para o problema de Darcy. Analogamente, tem-se
a combinação Ps0 × PkPk?1 para uma malha triangular, como introduzidos em [60].
Em todos os experimentos aplica-se a técnica RGL para a reconstrução do gradiente e
linearização da solução numérica da concentração, cujos resultados são comparados com
aqueles obtidos sem a técnica RGL. O parâmetro de ponderação da reconstrução do

133



gradiente (8.13) é tomado igual a zero, c = 0. Os esquemas de Runge-Kutta de primeira
e segunda ordem são denotados, respectivamente, por RK1 e RK2. Nas aproximações
sem RGL utiliza-se o método RK1.

8.5.1 Problema adimensional

Usando valores de referência µref, kref, Lref, pref, respectivamente, para a viscosidade
de fluido, a permeabilidade do meio poroso, o comprimento do domínio e a pressão do
fluido, a formulação adimensional do modelo matemático (8.1)-(8.3) é dada por

?
?s

?tD
+ qD ·?Ds = 0 em ?D ×J, (8.20)

qD = ?
kD
µD
?DpD em ?D,

?D ·qD = 0 em ?D,
(8.21)

com as condições de contorno e inicial

s(xD, 0) = s
0 em ?D,

s(xD, tD) = g em ?? ×J
qD ·n = q?N em ?N,
pD = p?D em ?D.

(8.22)

Sendo

• qD(xD) = q(x)
µref
kref

Lref
pref

, pD(xD) = p(x)/pref, kD(xD) = k(x)/kref, xD = x/Lref,

• ?D = Lref?, LxD = Lx/Lref, LyD = Ly/Lref, ?D = [0,LxD] × [0,LyD],

• C =
µref
kref

L2ref
pref

, µD = µ/µref, tD = t?/C, p?D = pD/pref e q?N = qN
µref
kref

Lref
pref

.

São adotados como valores de referência µref = µ, kref = maxx{k(x)}, Lref = Ly e
pref = pin, em que pin é a pressão inicial do reservatório.

8.5.2 Testes de Verificação

Neste experimento considera-se um domínio computacional retangular (de espessura
unitária) com as dimensões Lx = 400 m e Ly = 100 m, Figura 8.11. A viscosidade do
fluido marcado é µ = 10?3 Pa×s e a porosidade do meio é ? = 30%.

134



q.n = q
N p = pD

q.n = 0

q.n = 0

Ly

Lx

?(x)

Figura 8.11: Domínio computacional para o problema de injeção de traçador.

A condição inicial do problema é dada por

s(x, 0) =

{
1 em x &amp;lt;0,
0 em x &gt; 0,

e a condição de contorno é dada por

s(x, t) = 1 em x = 0,
q ·n = 0 em y = 0 e y = Ly,
q ·n = qN em x = 0,
p = 0 em x = Lx.

A vazão de fluido, em x = 0, é de Q = 60 m3/d e o volume de poro (V poro =
Lx × Ly × 1m × ?) do fluido do traçador é injetado em 200 dias (V poro/Q). Assim,
a velocidade de entrada de fluxo é qN = Q/(Ly × 1m×?) = 2 m/d. Assume-se como
pressão inicial do reservatório pin = 107 Pa.

Consideram-se dois testes, o primeiro para um meio poroso homogêneo e o se-
gundo em um meio com barreiras de permeabilidades. São feitas várias simulações com
diferentes níveis de refinamento h em malhas uniformes, com ordem polinomiais k = 1
e condição de CFL = 10?1. Em todos os casos a solução numérica está de acordo com
o esperado, em que observa-se divergente nulo para o fluxo e a solução numérica da con-
centração reproduz a descontinuidade com suavização e com pouca difusão numérica

135



provocada pelo erro da discretização.

Figura 8.12: Problema de injeção de traçador em meio homogêneo, para uma malha
quadrilateral de 64 × 16 elementos. Magnitude do fluxo (acima) e o seu divergente
(abaixo).

Meio homogêneo

Considera-se o caso em que ?(x) = 9, 86923×10?13 m2. Note que após a adimensiona-
lização do problema tem-se que LxD = 4, LyD = 1, tD ? 5, µD = 1, q?N = 0, 234549 em
(0, LyD) e kD(xD) = 1. No caso homogêneo é possível obter solução analítica, ou seja
qD(xD) = qD(xD,yD) = (0, 234549, 0.0) para o fluxo e s(xD, tD) = s(xD ? (qxD/?) tD)
para a concentração, que é a solução do problema de Riemann.

As Figuras 8.12 - 8.15 mostram os resultados numéricos, adimensionais, para
malhas com 64×16 elementos quadrilaterais na configuração Qs0 ×Q

+
1 Q1 e as Figuras

8.16 - 8.19 mostram os resultados numéricos, adimensionais, para uma malha formada
por 64 × 32 elementos triangulares na configuração Ps0 ×P1P0.

Como pode-se observar, todos os resultados reproduzem a descontinuidade com
suavização. No entanto, as aproximações com RGL apresentam melhores resultados
do que as aproximações sem RGL, obtidas a partir do esquema de primeira ordem
(8.18), as quais apresentam maior difusão numérica devido aos erros de discretização.
Observa-se também, que a técnica com RGL - RK1 aproxima a solução com menos
difusão numérica do que a técnica RGL - RK2.

136



Figura 8.13: Problema de injeção de traçador: concentração em um campo homogêneo,
com e sem RGL, no tempo tD = 2, 5. Malha quadrilateral de 64 × 16 elementos.

137



Figura 8.14: Problema de injeção de traçador: concentração em meio homogêneo, no
tempo tD = 2, 5, com e sem RGL. Malha quadrilateral com 64 × 16 elementos.

138



Figura 8.15: Problema de injeção de traçador: concentração, no corte yD = 0, 5, em
meio homogêneo, no tempo tD = 2, 5, com e sem RGL. Malha quadrilateral com 64×16
elementos.

Figura 8.16: Problema de injeção de traçador, em meio homogêneo, para uma malha
triangular de 64×32 elementos. Magnitude do fluxo (acima) e o seu divergente (abaixo).

139



Figura 8.17: Problema de injeção de traçador: concentração em meio homogêneo, com
e sem RGL, no tempo tD = 2, 5. Malha triangular de 64 × 32 elementos.

140



Figura 8.18: Problema de injeção de traçador: Concentração em meio homogêneono,
com e sem RGL, no tempo tD = 2, 5. Malha triangular com 64 × 32 elementos.

141



Figura 8.19: Problema de injeção de traçador: concentração, no corte yD = 0, 5, em
meio homogêneo, no tempo tD = 2, 5, com e sem RGL. Malha triangular com 64 × 32
elementos.

Meio heterogêneo (barreira de permeabilidade)

Considera-se agora o caso com barreira de permeabilidade em que ?(x) = k1 = 9, 86923×
10?13 m2 (= 10?3 mD) em uma certa região e ?(x) = k2 = 9, 86923 × 10?16 m2

(= 10?6 mD) em outra, como mostra a Figura 8.20. Nota-se que, após a adimensi-
onalização do problema, tem-se que LxD = 4, LyD = 1, tD ? 5, µD = 1, q?N = 0, 234549
em (0, LyD), k1D(xD) = 1 e k2D(xD) = 10?3.

As Figuras 8.21 - 8.23 mostram os resultados numéricos, adimensionais, para
malhas com 64×16 elementos quadrilaterais na configuração Qs0 ×Q

+
1 Q1 e as Figuras

8.24 - 8.26 mostram os resultados numéricos, adimensionais, para uma malha formada
por 64 × 32 elementos triangulares na configuração Ps0 ×P1P0.

Como pode-se observar, todos os resultados reproduzem a descontinuidade com
suavização. No entanto, as aproximações com RGL apresentam melhores resultados
do que as aproximações sem RGL, obtidas a partir do esquema de primeira ordem, as
quais apresentam maior difusão numérica devido aos erros de discretização. Observa-
se também que não existem diferenças significativas nos resultados numéricos obtidos
pelas técnicas RGL - RK1 e RGL - RK2. De modo que a técnica RGL - RK1 é a melhor
escolha, no quesito custo benefício, na simulação do problema.

142



q.n = q
N p = pD

q.n = 0

q.n = 0

k
2

k
2

k
1

Ly

Lx

Figura 8.20: Esquema de um meio heterogêneo com barreira de permeabilidade para o
problema do traçador.

Figura 8.21: Problema de injeção de traçador: resultados para a magnitude do fluxo
(acima) e o seu divergente (abaixo) em uma malha quadrilateral de 64 × 16 elementos.

143



Figura 8.22: Problema de injeção de traçador: concentração em um meio heterogêneo,
com e sem RGL, no tempo tD = 2, 5. Malha quadrilateral de 64 × 16 elementos.

144



Figura 8.23: Problema de injeção de traçador: concentração em um meio heterogêneo,
com e sem RGL, no tempo tD = 3, 5. Malha quadrilateral de 64 × 16 elementos.

Figura 8.24: Problema de injeção de traçador: resultados para a magnitude do fluxo
(acima) e o seu divergente (abaixo) em uma malha triangular de 64 × 32 elementos.

145



Figura 8.25: Problema de injeção de traçador: concentração em um meio heterogêneo,
com e sem RGL, no tempo tD = 2, 5. Malha triangular de 64 × 32 elementos.

146



Figura 8.26: Problema de injeção de traçador: concentração em um meio heterogêneo,
com e sem RGL, no tempo tD = 3, 5. Malha triangular de 64 × 32 elementos.

8.5.3 Escoamento com barreiras

Neste exemplo, considera-se um caso semelhante ao anterior onde o meio poroso é
constituido de várias faixas (barreiras) de baixa permeabilidade de modo que o fluxo é
forçado a passar por um canal delimitado por essas faixas. As condições de contorno e
inicial, bem como o domínio computacional, são idênticos ao exemplo anterior. Além
disso, consideram-se que ?(x) = k2 = 9, 86923 × 10?16 m2 (= 10?6 mD) nas regiões
de baixa permeabilidade e ?(x) = k1 = 9, 86923 × 10?13 m2 (= 10?3 mD) nas outras
regiões do domínio.

As Figuras 8.27 e 8.28 mostram os resultados numéricos, adimensionais, obtidos
pela técnica RGL - RK1 em uma malha formada por 64 × 16 elementos quadrilaterais
na configuração Qs0 × Q

+
1 Q1. Como pode-se observar a concentração calculada repre-

147



Figura 8.27: Resultados numéricos do problema de injeção de traçador, em escoamento
com várias barreiras, em uma malha quadrilateral de 64×16 elementos. Magnitude do
fluxo (acima) e o seu divergente (abaixo).

senta fielmente a física do problema (Figura 8.27) e a descontinuidade do problema de
transporte é reproduzida com suavização e com difusão numérica devido aos erros de
discretização.

148



Figura 8.28: Problema de injeção de traçador: concentração em escoamento com várias
barreiras nos tempos tD = 1 (figura acima), tD = 2 (figura no meio) e tD = 5 (figura
abaixo). Malha quadrilateral de 64 × 16 elementos

149



Figura 8.29: Problema de injeção de traçador: meio heterogêneo, com uma função
aleatória para a permeabilidade, em uma malha quadrilateral de 64 × 16 elementos.
Magnitude do fluxo (acima) e o seu divergente (abaixo).

8.5.4 Meio heterogêneo com permeabilidade aleatória

Neste exemplo considera-se um caso em que a permeabilidade é tratada como uma
função de x = (x,y) ? ?. A permeabilidade foi tomada como uma função aleatória tal
que 9, 86923 × 10?13 m2 ? ?(x) &amp;lt;0 e sua forma adimensional é dada por 1 ? kD &amp;lt;0.
As condições de contorno e inicial, bem como o domínio computacional, são idênticos
ao exemplo anterior.

As Figuras 8.29 e 8.30 mostram os resultados numéricos respectivamente para o
fluxo e seu divergente e para a concentração, adimensionais, obtidos pela técnica RGL
- RK1 em uma malha formada por 64 × 16 elementos quadrilaterais na configuração
Qs0×Q

+
1 Q1. Através da solução numérica, fica evidente a caracterização do reservatório,

em que observa-se as direções preferenciais do escoamento e a existência de regiões com
baixa permeabilidade.

150



Figura 8.30: Problema de injeção de traçador: concentração em um meio heterogêneo,
com função aleatória para a permeabilidade, em uma malha quadrilateral de 64 × 16
elementos. As figuras, de cima para baixo, ilustram as soluções nos tempos tD = 1,
tD = 1, 5, tD = 2, tD = 3 e tD = 5.

151



152



Capítulo 9

Conclusões e trabalhos futuros

9.1 Conclusões

Neste trabalho, o foco está em algumas formulações não clássicas do MEF e de suas
implementações no NeoPZ, que é um ambiente de programação científica orientada a
objetos. Uma atenção especial é dada às chamadas simulações multifísicas, em que
aplicam-se vários espaços de aproximação para abordar diferentes fenômenos em uma
mesma simulação. Também são considerados esquemas combinados MEF contínuo-
descontínuo, baseados em uma decomposição do domínio computacional e do emprego
de formulações diferenciadas em cada uma das sub-regiões. Um outro desenvolvimento
refere-se aos esquemas de Petrov-Galerkin com funções teste otimizadas. Uma aborda-
gem para o método de Petrov-Galerkin otimizado via simetrização é proposta, em que
utilizam-se duas aproximações pelo MEF contínuo.

No Capítulo 4, é proposta uma nova abordagem para o método de Petrov-Galerkin
em aproximações pelo MEF contínuo de problemas de convecção-difusão. A essa nova
técnica dá-se o nome de método da dupla projeção de Galerkin (MDP). Tal como
indicado pelo seu nome, o método baseia-se em duas projeções de Galerkin. Uma
sobre um espaço enriquecido contendo as funções teste e as funções admissíveis. A
outra projeção está no espaço das funções admissíveis. Mostra-se que a solução, via
método da simetrização aproximada [2, 3] utilizando funções testes ótimas, para o
problema de convecção-difusão, pode ser calculada através da utilização do MDP. No
entanto, o MDP tem a vantagem de ser computacionalmente mais barato, além de ser
mais fácil para se implementar. Como aplicação da técnica, resolve-se um ploblema
unidimensional usando o MEF contínuo, o método de Petrov-Galerkin via simetrização

153



[2, 3] e o MDP. Várias configuração do problema, em relação ao número de Péclet (Pe),
são utilizadas. A solução numérica obtida pelo MEF contínuo apresenta fortes oscilações
com o aumento do número de Péclet, ou seja, no caso de uma convecção dominante.
Além disso, em todas considerações, o MDP apresentou a mesma solução numérica
do método de Petrov-Galerkin via simetrização, em que as soluções do problema foram
aproximadas de maneira suave sem oscilações. Alguns resultados obtidos neste capítulo
foram publicados em anais de congresso [15].

No Capítulo 5, descreve-se uma abordagem combinada MEF contínuo-descontínuo,
na qual o MEF contínuo e a formulação de Galerkin descontínuo são usados na mesma
simulação para resolver o problema de Girkmann. Um modelo matemático, represen-
tado por um problema elástico linear, para uma casca fina axissimétrica apoiada sobre
um anel de reforço igualmente axissimétrico. A geometria da junção entre a casca e o
anel implica em um comportamento singular da solução elástica, próximo a esta região.
Com isso, é possível fazer a melhor utilização das vantagens de cada método, usando
elementos descontínuos perto de singularidades e elementos contínuos em outras partes.
O objetivo na resolução do problema de Girkmann é calcular o valor de certas quan-
tidades de interesse, representadas por funcionais lineares, na região casca-anel. Os
resultados numéricos obtidos pela metodologia MEF contínuo-descontínuo apresenta
uma convergência consistente de ambos os lados da junção casca-anel e com alta ordem
de precisão. Além disso, os resultados são superiores aos resultados obtidos a partir do
uso do MEF contínuo em toda região computacional do problema. Comparando com
outros modelos da literatura [22, 23], essa metodologia fornece excelentes resultados e
com a vantagem de não utilizar técnicas de pós-processamento, ou seja os resultados
são obtidos por integração numérica direta. Alguns resultados obtidos neste capítulo
são publicados em [24].

O Capítulo 6 destina-se ao estudo das simulações multifísicas, ao entendimento da
estrutura de classes do ambiente NeoPZ e de como incorporar essa nova ferramenta de
simulação a este ambiente. Uma vez que o NeoPZ inclui classes que contemplam diferen-
tes tipos de subespaços de aproximação e permite, de maneira flexível, a combinação
entre eles, desenvolve-se uma estrutura de classes de modo a contemplar simulações
multifísicas. Com isso, grandes avanços são feitos na combinação de subespaços de
aproximação, a qual dá-se o nome de subespaços multifísicas. De modo que, nas si-
muações pelo MEF utilizando o NeoPZ agora é possível combinar vários subespaços de
aproximação, tais como H1-conforme, Hdiv-conforme e L2, em uma mesma simulação
dependendo do problema a ser resolvido. Como parte de validação do código alguns

154



problemas são resolvidos no contexto de simulações multifísicas.
No Capítulo 7, resolve-se o problema da poroelasticidade linear no contexto da

simulação multifísca. Este problema relaciona o deslocamento da matriz porosa com
a pressão de fluido no meio poroso. Implementa-se no NeoPZ a classe TPZPoroE-
lasticMF2d de modo a contemplar a simulação multifísica do problema, utiliza-se um
subespaço de aproximação apropriado a cada uma das variáveis. Ou seja, subespaço
em L2 para a pressão, subespaço Hdiv-conforme para o fluxo de fluido e subespaço
H1-conforme para o deslocamento do sólido. O código é verificado a partir da resolu-
ção de problemas com soluções analíticas conhecidas. Nas aproximações das variáveis,
obtém-se taxa de convergência ótima do erro numérico, de acordo com a regularidade
das soluções. Mostra-se também, que o erro numérico decai com o refinamento da ma-
lha e com o aumento da ordem polinomial. Alguns resultados obtidos neste capítulo e
no anterior são publicados em anais de congresso [36].

Por fim, no Capítulo 8, faz-se um estudo sobre o problema de injeção de traçador
em meios porosos e de sua resolução no contexto da simulação multifísica. Resolve-se
o sistema elíptico pelo método dos elementos finitos mistos, de modo que a velocidade
do fluido é aproximada de forma direta pelo subespaço Hdiv-conforme. O problema
de transporte, que é governado por uma equação linear, é resolvido por um esquema
constituído de subespaço de funções constantes por partes e de um fluxo numérico do
tipo upwind. Além disso, aplica-se a técnica de reconstrução de gradientes e lineariza-
ção da solução (RGL) de modo a obter um esquema numérico de segunda ordem na
aproximação da concentração. Implementa-se no NeoPZ as classes TPZTracerFlow e
TPZGradientReconstruction para contemplar a simulação multifísica do problema de
injeção de traçador e a técnica de reconstrução de gradientes e linearização, respectiva-
mente. Testes numéricos são realizados com objetivo de validar os códigos implementa-
dos. Resolvem-se vários problemas com e sem a técnica RGL. Os resultados numéricos
obtidos reproduz a descontinuidade com suavização. No entanto, as aproximações com
RGL apresentam melhores resultados do que as aproximações sem RGL, obtidas a par-
tir do esquema de primeira ordem, as quais contém maior difusão numérica devido aos
erros de discretização. Além disso, todos os resultados pela técnica RGL representam
fielmente a física do problema. Alguns resultados deste capítulo são publicados em
anais de congresso [37].

155



9.2 Trabalhos futuros

Tendo em vista os resultados aqui apresentados, pretende-se, primeiramente, publicar
em revistas científicas os resultados apresentados nos Capítulos 4 e 6, os quais, respec-
tivamente, dizem respeitos ao método da dupla projeção e do código de orientação a
objetos para simulações multifísicas. No caso do método da dupla projeção, pretende-
se expandir suas aplicações ao caso bidimensional e comparar os resultados com as
outras técnicas do método de Petrov-Galerkin via simetrização. Pretende-se também
aplicar os conhecimentos obtidos com a resolução do problema de injeção de traçador
em meios porosos para casos mais complexos, tais como problemas com geologia fractal
e problemas em escoamento multifásico em meios porosos rígidos e deformáveis.

Outros tópicos como perspectivas de trabalhos futuros são:

• Estudar, no sentido da simulação multifísica, o novo método de elementos finitos
conhecido como método multiescala híbrido misto (MHM) [90].

• Como em simulações multifísicas várias equações diferenciais parciais são acopla-
das, pretende-se estudar quais técnicas de resolução de sistema são mais apropri-
adas de acordo com a natureza do problema.

• Estudo de técnicas que possam melhorar a performance da resolução de problemas
via simulação multifísica, tais como, hp-adaptatividade e programação de alto
desempenho.

156



Referências Bibliográficas

[1] MORTON, K. W., Numerical Solution of convection-diffusion problems, volume 12
of Applied Mathematics and Mathematical Computation, Chapman &amp;amp; Hall, Lon-
don, 1996

[2] BARRETT, J. W. and MORTON, K. W., “Appoximate symmetrization and
Petrov-Galerkin methods for convection problems,” Comput Meth Appl Mech En-
grg, volume 45, pp. 79–122, 1984

[3] MORTON, K. W., MURDOCH, T., and SÜLI, E., “Optimal error estimation for
Petrov-Galerkin methods in two dimensions,” Numerische Mathematik, volume 61,
pp. 359–372, 1992

[4] BOTTASSO, C. L., MICHELETTI, S., and SACCO, R., “The discontinuous
Petrov-Galerkin method for elliptic problems,” Comput Methods Appl Mech Engrg,
volume 191, pp. 3391–3409, 2002

[5] BOTTASSO, C. L., MICHELETTI, S., and SACCO, R., “A multiscale formulation
of the Discontinuous Petrov-Galerkin method for advective-diffusive problems.”
Comput Methods Appl Mech Engrg, volume 194, pp. 2819–2838, 2005

[6] CAUSIN, P. and SACCO, R., “A Discontinuous Petrov-Galerkin method with La-
grangian Multipliers for second order elliptic problems,” SIAM J Numer Anal,
volume 43, no. 1, pp. 280–302, 2005

[7] DEMKOWICZ, L. and GOPALAKRISHNAN, J., “A class of discontinuous Petrov-
Galerkin methods. Part I: The transport equation,” Comput Methods Appl Mech
Engrg, volume 199, pp. 1558–1572, 2010

157



[8] DEMKOWICZ, L. and GOPALAKRISHNAN, J., “A Class of Discontinuous
Petrov-Galerkin Methods. Part II: Optimal Test Functions.” Numerical Methods
for Partial Differential Equations, volume 27, 2010

[9] DEMKOWICZ, L. and GOPALAKRISHNAN, J., “Analysis of the DPG method
for the Poisson equation,” Technical Report 10-37, ICES, The Institute for Compu-
tational Engineering and Sciences, The University of Texas at Austin, September
2010

[10] DEMKOWICZ, L., GOPALAKRISHNAN, J., and NIEMI, A., “A Class of Discon-
tinuous Petrov-Galerkin Methods. Part III: Adaptivity.” Technical report, ICES,
The Institute for Computational Engineering and Sciences, The University of Texas
at Austin, 2010

[11] ZITELLI, J., MUGA, I., DEMKOWICZ, L., GOPALAKRISHNAN, J., PARDO,
D., and CALO, V. M., “A class of discontinuous Petrov-Galerkin methods. Part
IV: The optimal test norm and time-harmonic wave propagation in 1D,” Journal
of Computational Physics, 2011

[12] CHAN, J, DEMKOWICZ, L., MOSER, R., and ROBERTS, N., “A New Discon-
tinuous Petrov-Galerkin Method with Optimal Test Functions. Part V: Solution
of 1d Burgers and Navier-Stokes Equations,” Ices report 10-25, The Institute for
Computational Engineering and Sciences, The University of Texas at Austin, June
2010

[13] NIEMI, A. H., BRAMWELL, J. A., and DEMKOWICZ, L. F., “Discontinuous
Petrov-Galerkin method with optimal test functions for thin-body problems in
solid mechanics,” Comput Methods Appl Mech Engrg, volume 200, pp. 1291–1300,
2011

[14] NIEMI, A. H., COLLIER, N. O., and CALO, V. M., “Discontinuous Petrov-
Galerkin method based on the optimal test space norm for one-dimensional
transport problems.” International Conference on Computational Science Proce-
dia Computer Science, volume 4, pp. 1862–1869, 2011

[15] DEVLOO, P. R. B., FARIAS, A. M., GOMES, S. M., and GONÇALVES, J. L.,
“Semelhança entre o método da dupla projeção Bubnov-Galerkin e o método

158



de Petrov-Galerkin,” XXXII Iberian Latin American Congress on Computational
Methods in Engineering, volume 1, Novembro 2011

[16] FORTI, T. L. D., Aplicações dos métodos de elementos finitos contínuo e Galer-
kin descontínuo combinados, Ph.D. thesis, Universidade Estadual de Campinas,
Faculdade de Engenharia Civil, Arquitetura e Urbanismo, 2010

[17] DEVLOO, P. R. B., FORTI, T., and GOMES, S. M., “A combined continuous-
discontinuous finite element method for convection-diffusion problems,” Latin
American Journal of Solids and Structures, volume 4, pp. 229–246, 2007

[18] DAWSON, C. and PROFT, J., “Coupling of continuous and discontinuous Galer-
kin methods for transport problems,” Comput Meth Appl Mech Eng, volume 191,
pp. 3213–3231, 2002

[19] DAWSON, C. and PROFT, J., “Coupled discontinuous and continuous Galerkin
finite element methods for the depth-integrated shallow water equations,” Comput
Meth Appl Mech Engrg, volume 193, pp. 289–318, 2004

[20] GIRKMANN, K, Flächentragwerke, Springer-Verlag, 1956

[21] TIMOSHENKO, S. and WOINOWSKI-KRIEGER, S., Theory of plates and shells,
4 edition, McGraw-Hill Book Company Inc, 1959

[22] SZABÓ, B., BABUSKA, I., PITKÄRANTA, J., and NERVI, S., “The problem of
verification with reference to the Girkmann problem,” Eng Comput, volume 26,
pp. 171–183, 2010

[23] NIEMI, H. A., BABUSKA, I., PITKÄRANTA, J., and DEMKOWICZ, L., “Finite
element analysis of the Girkmann problem using the modern hp-version and the
classical h-version,” Eng Comput, volume 28, pp. 123–134, 2012

[24] DEVLOO, P. R. B., FARIAS, A. M., and GOMES, S. M., “Application of a combi-
ned continuous-discontinuous Galerkin finite element method for the solution of the
Girkmann problem,” Computers and Mathematics with Applications, volume 65,
pp. 1786–1794, 2013

[25] KEYES, D. E. et al, “Multiphysics simulations: challenges and opportunities,”
Technical report, Argonne National Laboratory, ANL/MCS-TM-321, October 2012

159



[26] BENGZON, F., JOHANSSON, A., LARSON, M. G., and SÖDERLUND, R., “Si-
mulation of multiphysics problems using adaptive finite elements,” Springer Berlin
Heidelberg, volume 4699, pp. 733–743, 2007

[27] DEMKOWICZ, L., KURTZ, J., and QIU, F., “hp-Adaptive finite elements for cou-
pled multiphysics wave propagation problems,” Computer Methods in Mechanics,
pp. 19–42, 2010

[28] JIAO, X., ZHENG, G., ALEXANDER, P. A., CAMPBELL, M. T., LAWLOR,
O. S., NORRIS, J., and HASELBACHER, A., “A system integration framwork
for coupled multiphysics simulations,” Engineering with computers, volume 22,
pp. 293–309, 2006

[29] VIERA, M. A., FALCON, D. L, BERTHIER, A. M., and TAPIA, A. O., “COMSOL
Implementation of a multiphase fluid flow model in porous media,” Excerpt from
the Proceedings of the COMSOL Conference, 2008

[30] XUE, G., Numerica methods for multiphysics, multiphase and multicomponent mo-
dels for fuel cells, Ph.D. thesis, The Pennsylvania State University - Department
of Mathematics, August 2008

[31] HEIL, M. and HAZEL, A. L., “oomph-lib – An object-oriented multi-physics finite-
element library,” Fluid-Structure Interaction, volume 53, pp. 19-49, Springer - Lec-
ture Notes in Computational Science and Engineering, 2006

[32] NETTIS, L. and CATALANO, L. A., “Development of multiphysics tools for
object-oriented platforms,” Annual Report 2o Academic Year, Politecnico di Bari,
Scuola di Dottorato DRIMA, 2010

[33] BRAVO, C. M. A. A., Um sistema de refinamento hp adaptativo utilizando elemen-
tos finitos hierárquicos multidimensionais, Ph.D. thesis, Universidade Estadual de
Campinas, Faculdade de Engenharia Mecânica, 2000

[34] DEVLOO, P. R. B. and LONGHIN, G. C., “Object oriented design philosophy for
scientific computing,” Mathematical Modelling and Numerical Analysis, volume 36,
no. 5, pp. 793–807, 2002

[35] SIQUEIRA, D., Construção de espaços de elementos finitos do tipo hdiv, Ph.D.
thesis, Instituto de Matemática, Estatística e Computação Científica, Unicamp,
2012

160



[36] FARIAS, A. M., DEVLOO, P. R. B., and GOMES, S. M, “Simulação multifísica
para problemas de acoplamento fluido-estrutura,” XXXIV Iberian Latin American
Congress on Computational Methods in Engineering, volume 1, Pirenópolis-GO,
November 10-13 2013

[37] FARIAS, A. M., DEVLOO, P. R. B., and GOMES, S. M., “Simulação numérica do
problema do traçador passivo em contexto multifísica,” XXXV Iberian Latin Ame-
rican Congress on Computational Methods in Engineering, volume 1, Fortaleza,
November 23-26 2014

[38] MOURA, C. A., Análise funcional para aplicações-posologia, Rio de janeiro, 2002

[39] ODEN, J. T. and DEMKOWICZ, F. L., Applied Functional Analysis, second edi-
tion, Chapman &amp;amp; Hall/CRC Press. Second edition. Boca Raton, 2010

[40] KREYSZIG, E., AIntroductiory functional analysis with aplications, John Wiley,
1989

[41] JOHNSON, C., Numerical solution of partial differential equation by the finite
element method, Cambridge, USA, 1990

[42] CAREY, G. F., BERCKER, E. B., and ODEN, J. T., Finite element: an intro-
duction, volume I, Prentice-Hall, 1981

[43] SOLIN, P., Partial diferential equation an the finite element method, John Wiley
and Sons, Inc., 2005

[44] CIARLET, P. G., The finite element method for elliptic problems, North-Holland
Publishing Company, 1978

[45] GIRAULT, V. and RAVIART, P. A., Finite elements methods for Navier-Stokes
equations: theory and algorithms, Sringer-Verlag, 1986

[46] BREZZI, F. and FORTIN, M., Mixed and hybrid finite element methods, Springer-
Verlag, 1991

[47] XU, J. and ZIKATANOV, L., “Some observations on babuska and brezzi theories,”
Numer Math, volume 94, pp. 195–202, 2003

[48] DEMKOWICZ, L., “Babuska ? Brezzi,” Technical report, ICES, The University
of Texas at Austin, 2006

161



[49] BREZZI, F., “On the existence, uniqueness and approximation of saddle–point pro-
blems arising from Lagrange multipliers,” RAIRO Analyse Numerique, volume 8,
no. 2, pp. 129–151, 1974

[50] PRUDHOMME, S., PASCAL, F., ODEN, J. T., and ROMKES, A., “Review of a
priori error estimation for discontinuous Galerkin methods,” Technical Report 27,
TICAM, University of Texas at Austin, 2000

[51] HOUSTON, P., SCHWAB, C., and SÜLI, E., “Discontinuous hp-finite element
methods for advection-diffusion problems.” Technical Report 00/15, Oxford Uni-
versity Computing Laboratory, 2000

[52] DELVES, L. M. and HALL, C. A., “An implicit matching principle for global
element calculations,” J Inst Math Appl, volume 2, pp. 223–234, 1979

[53] BAUMANN, C. E., An hp-adaptive discontinuous finite element method for com-
putational fluid dynamics, Ph.D. thesis, University of Texas at Austin, 1997

[54] ARNOLD, D., “An interior penalty finite element method with discontinuos ele-
ments,” SIAM J Numer Anal, volume 19, no. 4, pp. 742–760, 1982

[55] HARRIMAN, K., HOUSTON, P., SENIOR, B., and SÜLI, E., “hp-Version discon-
tinuous Galerkin methods with interior penalty for partial differential equations
with nonnegative characteristic form,” Contemp Math, volume 330, pp. 89–119,
2003

[56] DEVLOO, P. R. B., “PZ: An object oriented environment for scientific program-
ming,” Comput Methods Appl Mech Engrg, volume 150, pp. 133–153, 1997

[57] DEVLOO, P. R. B., BRAVO, C. M. A. A., and RYLO, E. C., “Systematic and
generic construction of shape functions for p-adaptive meshes of multidimensional
finite elements,” Comput Methods Appl Mech Engrg, volume 198, pp. 1716–1725,
2009

[58] RAVIART, A. P. and THOMAS, J. M., “A mixed finite element method for 2nd
order elliptic problems,” Lecture Notes in Mathematics, volume 606, pp. 292–315,
1977

[59] NEDELEC, J. C., “A new family of mixed finite elements in R3,” Numerische
Mathematik, volume 50, pp. 57–81, 1986

162



[60] SIQUEIRA, D., DEVLOO, P. R. B., and GOMES, S. M., “A new procedure for
the construction of hierarchical high order Hdiv and Hcurl finite element spaces,”
Journal of Computational and Applied Mathematics, volume 240, pp. 204–214,
2013

[61] CAREY, G. F. and ODEN, J. T., Finite element: mathematical aspects, volume IV,
Prentice-Hall, 1983

[62] NECAS, J., Direct methods in the theory of elliptic equations, Springer monographs
in mathematics, Springer, 2012

[63] BABUSKA, I. and RHEINBOLDT, W. C., “A posteriori error estimates for the
finite elements method,” International Journal for Numerical Methods in Engine-
ering, volume 12, pp. 1597–1615, 1978

[64] AINSWORTH, M. and ODEN, J. T., A posteriori error estimation in finite element
analysis, A Wiley-interscience publication, 2000

[65] HUGHES, T. J. R. and BROOKS, A., “A multidimensional upwind scheme with
no crosswind diffusion, in Finite element methods for convection dominated flows,”
volume 34, pp. 19–35, 1979

[66] DEVLOO, P. R. B., “On the similarity betweem a double projection Bubnov-
Galerkin method and the Petrov-Galerkin,” XXVIII Seminario Brasileiro de Ana-
lise Rio de Janeiro, pp. 243–254, 1988

[67] HEMKER, P. W., “A numerical study of stiff two-point boundary problems. Ph.
D. Thesis,” , 1977

[68] PITIKÄRANTA, J., BABUSKA, I., and SZABÓ, B., “The dome and the ring:
Verification of an old mathematical model for the design of a stiffened shell roof,”
Comput Math Appl, volume 64, pp. 48–72, 2012

[69] FARIAS, A. M., DEVLOO, P. R., and LUCCI, P. C. A., “Solução numérica do
problema de Girkmnn usando o método dos elementos finitos contínuo e descontí-
nuo,” XXXI Iberian Latin American Congress on Computational Methods in En-
gineering, Novembro 2010, Buenos Aires, Argentina

163



[70] GORDON, W. J. and HALL, C. A., “Transfinite element methods: blending
function interpolation over arbitrary curved element domains,” Numer Math, vo-
lume 21, no. 2, pp. 109–129, 1973

[71] LUCCI, P. C. A., Descrição matemática de geometrias curvas por interpolação
transfinita, Master’s thesis, Universidade Estadual de Campinas, FEC-Unicamp,
2009

[72] RYLO, E. C., Adaptatividade hp em paralelo, Ph.D. thesis, Universidade Estadual
de Campinas, Faculdade de Engenharia Civil, Arquitetura e Urbanismo, 2007

[73] SZABÓ, B. and BABUSKA, I., Finite element analysis, John Wiley and Sons,
Inc., 1991

[74] BIOT, M., “Theory of elasticity and consolidation for a porous anisotropic solid,”
Journal of Applied Physics, volume 26, pp. 182–185, 1955

[75] PHILLIPS, P. J., Finite element methods in linear poroelasticity: Theoretical and
computational results, Ph.D. thesis, The University of Texas at Austin, 2005

[76] TERZAGHI, K., “Principle of soil mechanics,” Eng News Record, 1925

[77] BIO, M., “General theory of three-dimensional consolidation,” Journal of Applied
Physics, volume 2, pp. 155–164, 1941

[78] LI, C. and BORJA, R. I., “Finite element formulation of poro-elasticity suitable for
large deformation dynamic analysis,” Technical Report 147, Department of Civil
and Environmental Engineering Stanford University, 2005

[79] MURAD, M. A. and LOULA, A. F. D., “On stability and convergence of finite
element approximations of Biot’s consolidation problem,” International Journal
for Numerical Methods in Engineering, volume 37, pp. 645–667, 1994

[80] BORGES, M. R., FURTADO, F., PEREIRA, F., and SOUTO, H. P. A., “Scaling
analysis for the tracer flow problem in self-similar permeability fields,” Multiscale
Modeling and Simulation, volume 7, no. 3, pp. 1130–1147, 2008

[81] DOUGLAS, J., FURTADO, F., and PEREIRA, F., “On the numerical simulation of
waterflooding of heterogeneous petroleum reservoirs,” Computational Geosciences,
volume 1, pp. 155–190, 1997

164



[82] DOUGLAS, J and YIRANG, Y., “Numerical simulation of immiscible flow in po-
rous media based on combining the method of characteristics with mixed finite
element procedures,” Numerical Simulation in Oil Recovery The IMA Volumes in
Mathematics and its Applications, volume 11, pp. 119–131, 1988

[83] BARTH, T.J. and JESPERSEN, D.C., “The design and application of upwind
schemes on unstructured meshes,” AIAA paper 89 0366, January 1989

[84] VENKATAKRISHMAN, V., “On the accuracy of limiters and convergence to
steady-state solutions,” AIAA paper 93 0880, January 1993

[85] COCKBURN, B. and SHU, C. W., “Review article: Runge-Kurra discontinuous
Galerkin methods for convection-dominated problems,” Journal of Scientific Com-
puting, volume 16, no. 3, September 2001

[86] LEVEQUE, R. J., Finite-volume methods for hyperbolic problems, Cambridge Uni-
versity Press, 2004

[87] BARTH, T. and OHLBERGER, M., “Finite volume methods: foundation and
analysis,” Encyclopedia of Computational Mechanics, edited by John Wiley and
Sons Ltd., volume 1, 2004

[88] DUTYKH, D., PONCET, R., and DIAS, F., “The VOLNA code for the numerical
modeling of tsunami waves: Generation, propagation and inundation,” European
Journal of Mechanics BFluids, volume 30, pp. 598–615, 2011

[89] MICHALAK, C. and GOOCH, C. O., “Accuracy preserving limiter for the high-
order accurate solution of the Euler equations,” Journal of Computational Physics,
volume 228, pp. 8693–8711, 2009

[90] ARAYA, R., HARDER, C., PAREDES, D., and VALENTIN, F., “Multiscale
hybrid-mixed method,” SIAM J Numer Anal, volume 51, no. 6, pp. 3505–3531,
2013

165


</field>
	</doc>
</add>