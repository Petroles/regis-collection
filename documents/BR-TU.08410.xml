<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08410</field>
		<field name="filename">13246_BragaNeto_UlissesdeMendonca_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Universidade Estadual de Campinas
Faculdade de Engenharia Elétrica
Departamento de Engenharia da Computação e Automação Industrial
Reconstrução Volumétrica e Análise de Imagens
Tridimensionais por Morfologia Matemática
por Ulisses de Mendonça^Braga Neto r
orientador Prof. Dr. Roberto de Alencar ¡Lotufo
Dissertação submetida à Faculdade de Engenharia Elétrica da U-niversidade Estadual de Campinas, para preenchimento dos pré-requisitos parciais para obtenção do Título de Mestre em Engenharia Elétrica.
Dezembro 1994
Este oxêrnpíSr gí	s ■	rn/P ds
defendida por	(X ft-ViMW-A
“a	1"" ..........
Resumo
Este trabalho apresenta um conjunto de métodos e ferramentas que visam à reconstrução volumétrica e análise tridimensional de um objeto do mundo real.
Um método original para o registro de seções seriadas (etapa da reconstrução volumétrica) é proposto. São apresentadas também ferramentas de análise de imagens tridimensionais baseadas na Morfologia Matemática. Duas destas ferramentas, as granu-lometrias geodésicas e o histograma de gargantas, são técnicas originais desenvolvidas ao longo deste trabalho, não tendo sido encontradas na literatura consultada. Durante todo o processo de desenvolvimento, foi adotado como plataforma o sistema de visualização e processamento de imagens Khoros.
0 objeto tridimensional estudado consiste em uma amostra experimental a-través da qual pretendeu-se modelar um sistema físico poroso. 0 estudo de tais sistemas é de grande relevância em áreas economicamente importantes como petrofísica, engenharia de petróleo, engenharia de reservatórios, análise de solos e cristalografía. Este trabalho apresenta parâmetros de análise do meio poroso obtidos diretamente da amostra experimental tridimensional, sem nenhuma correção estereométrica envolvida.
Abstract
This work presents a set of methods and tools for the volumetric reconstruction and three-dimensional analysis of a real world object.
An original method for the registration of serial sections (a step in volumetric reconstruction) is proposed. Also, tools based on Mathematical Morphology are presented for the analysis of three-dimensional images. Two of these tools, the geodesic granulometries and the neck histogram, have not been found in the consulted literature, being original techniques developed in the course of this work. During all the development process, it was adopted as platform the Khoros visualization and image processing system.
The three-dimensional object studied was an experimental sample designed for modelling a porous physical system. The study of such systems is of great value in economically important areas like petrophysics, oil engineering, reservatory engineering, soil analysis and crystalography. This work presents analysis parameters for the porous medium obtained directly from the three-dimensional experimental sample, with no estereometric correction involved.
Agradecimentos
Ao Júnior Barrera, do IME-USP, pela ajuda inestimável que me deu na forma de comentários, sugestões e referências biliográficas sobre a Morfologia Matemática.
Ao Gerald Banon, do INPE, por todo o apoio recebido e pelo ótimo curso de Morfologia Matemática que tive oportunidade de assitir no Recife.
Ao Clésio Tozzi, da FEE-UNICAMP, pela cuidadosa revisão do texto e pelos comentários feitos.
Ao Renato Luppi e ao Alexandre Xavier, pela amizade e por todas as dicas e comentários sobre o Khoros e a V3DTOOLS.
Ao Marcelo Monteiro, do Instituto de Geociências da UNICAMP, por ter fornecido a amostra experimental e ter colaborado no processo de aquisição da mesma.
Ao Centro de Computação da UNICAMP ~ CCUEC, na pessoa do analista de sistemas Rubens Queiroz, pelo suporte computacional recebido.
A Ting e ao Jaime, pela ajuda que deram na chegada a Campinas.
Aos muitos amigos que fiz no LCA, que comigo conviveram cotidianamente e fizeram esta caminhada parecer muito mais curta e amena: Luís Gonzaga, Daniel Moralez, Leila, Jorge, Gonzalo, Marco Antônio, Maurício, Okamura, Ely, Alexandre Magalhães, Ilka, Pinda, Elton, Olga, Berutti, Nelson, Ricardo, Luciana, Márcio Leandro, Tetsu, Daniel Kligerman, Marcelo, Alencar, Andrea, Reginaldo.
A minha Tia Consuêlo, pela companhia, incentivo e “ajuda doméstica” recebida.
Aos meus pais, Jacinto e Consuêlo
“ ‘I always thought they were fabulous monsters!’ said the Unicorn. ‘Is it alive?’
‘It can talk,’ said Haigha solemnly.
The Unicorn looked dreamily at Alice, and said: ‘Talk, child?
Alice could not help her lips curling up into a smile as she began: ‘Do you know, I always thought Unicorns were fabulous monsters too? I never saw one alive before!’
‘Well, now that we have seen each other,’ said the Unicorn, ‘if you’ll believe in me, I’ll believe in you. Is that a bargain?’ ”
Trecho extraído do incrível livro “infantil” “Through the looking-Glass and What Alice Found There”, de Dewis Carrol
Conteúdo
RESUMO	i
ABSTRACT	n
AGRADECIMENTOS	iii
CONTEÚDO	v
LISTA DE FIGURAS	viii
LISTA DE TABELAS	xii
1	Introdução	1
1.1	Objetivos ..........................................     2
1.2	Materiais e Métodos....................................  3
1.3	Organização do trabalho................................. 3
2	Registro de Seções Seriadas	5
2.1	Introdução ...........................................   5
2.2	O problema do registro................................   6
2.3	0 método de registro proposto.........................   7
2.3.1	Obtenção da transformação de escala .............. 8
2.3.2	Obtenção das transformações de rotação e translação . ........... 11
2.3.3	Obtenção dos parâmetros de registro ............................. 23
2.4	Dois exemplos com imagens sintéticas..................................   24
2.4.1	Primeiro exemplo................................................. 24
2.4.2	Segundo exemplo ...........................................       26
3	Morfologia Matemática em Três Dimensões	29
3.1	Introdução............................................................   29
3.2	Conceitos preliminares...............................................    30
3.2.1	Esquema de Representação e Grid Digital . ....................... 31
3.2.2	Vizinhança e Conectividade...................................     32
3.2.3	Distância e Discos Digitais ...................................   35
3.3	As transformações básicas da Morfologia Matemática ..................... 37
3.3.1	Erosão e Dilatação .............................................. 38
3.3.2	Gradiente Morfológico............................................ 42
3.3.3	Aberturas e Fechamentos  ........................................ 43
3.3.4	Erosões e Dilatações Geodésicos e Reconstrução...............  .	45
4	Ferramentas da Morfologia Matemática para Análise de Imagens	48
4.1	Introdução.........................  ................................... 48
4.2	Watersheds...........................................................    49
4.2.1	Watersheds e a Segmentação de imagens nível-de-cinza............. 52
4.2.2	Separação de objetos superpostos via Watersheds.................. 55
4.3	Granulometria ....................................................       60
4.3.1	As Distribuições Granulométricas de Tamanho.....................  63
4.3.2	O Espectro de Padrões........................................     67
4.3.3	Granulometrias Geodésicas......................................   69
4.4	Histograma de Gargantas..........................................     77
4.5	Aspectos de implementação .........................................   82
5	Resultados Experimentais: Caracterização de Meio Poroso	87
5.1	Introdução ........................................................   87
5.2	Ambiente	e Ferramentas Computacionais Utilizados ................... 88
5.2.1	0	Sistema Khoros...........................................   89
5.2.2	A	toolbox V3DT00LS .........................................  91
5.2.3	A	toolbox MMACH...........................................    92
5.3	Reconstrução Volumétrica a partir de Seções Seriadas ................ 98
5.3.1	Aquisição das seções seriadas ..............................   98
5.3.2	Registro das seções seriadas..............................     99
5.3.3	Interpolação Volumétrica...................................   103
5.4	Atributos de análise para caracterização de meio poroso.........  .	109
5.4.1	Medidas de caráter geral...................................   112
5.4.2	Análise	Granulométrica ....................................   114
5.4.3	Análise	das Gargantas......................................   119
6	Conclusão	122
BIBLIOGRAFIA
124
Lista de Figuras
2.1	Seções mestre e corrente e respectivos pontos rotulados.....................  7
2.2	Contornos preenchidos de duas seções consecutivas de um objeto tridimensional 10
2.3	Especificação de geometria invariante a rotação e translação ..............	12
2.4	Especificação de	geometria invariante apenas a translação................... 13
2.5	Rotação sobre	e v'2 produzindo v" e v2 .................................   19
2.6	Seções sintéticas	utilizadas no primeiro exemplo..........................   24
2.7	Seções sintéticas	utilizadas no segundo exemplo............................. 26
3.1	Região de interesse e subdivisão do espaço voxel ........................... 32
3.2	Exemplo de espaço voxel: empilhamento das fatias de um joelho ......	33
3.3	Vizinhança 2D: (a) 4-vizinhos ao pixel central e (b) 8-vizinhos ao pixel central 33
3.4	Vizinhança 3D: (a) 6-vizinhos (b) 18-vizinhos e (c) 26-vizinhos ao voxel central 34
3.5	Discos 2D de raio r = 5 correspondentes às distâncias (a) quarteirão (b)
euclidiana e (c) máximo...................................................   36
3.6	Discos 3D de raio r = 10 correspondentes às distâncias (a) quarteirão (b)
euclidiana e (c) máximo ................................................     36
3.7	Modelo tridimensional da fase sólida de uma rocha .  ....................... 39
3.8	Erosão por discos digitais 3D de raio r = 5 segundo diversas métricas, (a)
disco do quarteirão (b) disco euclidiano (c) disco do máximo ........... .	40
3.9	Dilatação por discos digitais 3D de raio r = 5 segundo diversas métricas, (a)
disco do quarteirão (b) disco euclidiano (c) disco do máximo................ 41
3.10	Abertura por discos digitais 3D de raio r = 5 segundo diversas métricas, (a)
disco do quarteirão (b) disco euclidiano (c) disco do máximo .............. 44
3.11	Fechamento por discos digitais 3D de raio r ~ 5 segundo diversas métricas.
(a)	disco do quarteirão (b) disco euclidiano (c) disco do máximo ......... 45
3.12	Exemplo de reconstrução: (a) Imagem original (b) Marcadores (c) Resultado 47
4.1	Imagem sintética vista segundo (a) representação usual e (b) modelo topográfico 50
4.2	LDA superposta à imagem original: (a) representação usual e (b) modelo
topográfico . ...........................................................   51
4.3	Exemplo de super-segmentação: (a) Imagem original (b) Gradiente (c) LDA
resultante...............................................................   53
4.4	Marcadores utilizados na segmentação da imagem do pé......................  54
4.5	Resultado da segmentação por watersheds da imagem do pé.................... 55
4.6	Imagem binária a ser segmentada.........................................    56
4.7	Função distância associada ao objeto da fig. anterior segundo a métrica euclidiana ..............................................................     57
4.8	Modelo topográfico associado ao complemento da função distância euclidiana 57
4.9	Super-segmentação obtida com a determinação direta dos watersheds utilizando a função distância euclidiana........................................ 58
4.10	Perfil unidimensional da função distância mostrando os máximos espúrios
que são removidos pela abertura por reconstrução e os máximos filtrados que resultam.................................................................   59
4.11	Marcadores obtidos através de (a) Bissetor condicional de ordem 10 (b)
Última erosão (c) Máximos filtrados (d) Seleção manual....................  61
4.12	Segmentação via watersheds utilizando os marcadores da figura anterior: (a) Bissetor condicional de ordem 10 (b) Última erosão (c) Máximos fitrados (d)
Seleção manual...........................................................   62
4.13	Imagem sintética a ser submetida a análise granulométrica............  .	66
4.14	Curvas granulométricas associadas à imagem da figura anterior: (a) í(r) e
(b)	T(r)............................................... . ................ 66
4.15	Espectros de padrões associados a alguns objetos bidimensionais .......... 68
4.16	Imagem a ser submetida à análise granulométrica .......................  69
4.17	Espectro de padrões morfológico associado à imagem da fig. 4.16 ......	70
4.18	Resultados da abertura morfológica com disco euclidiano para diversos valo-
res de T sobre a imagem da fig. 4.16 .................................... 71
4.19	Espectro de padrões geodésico associado à imagem da fig. 4.16 .......	73
4.20	Resultados da abertura geodésica 7Br,Brec com disco euclidiano para diversos
valores de r sobre a imagem da fig. 4.16 ...............................  74
4.21	Segmentação dos grãos superpostos da fig. 4.16.......................... 75
4.22	Resultados da abertura geodésica 7Br)Brec com disco euclidiano para diversos
valores de r sobre a imagem da fig. 4.21................................  76
4.23	Espectro de padrões geodésico da imagem segmentada da fig. 4.21 ........ 77
4.24	Garganta entre dois componentes conectados e maior disco digital inscrito .	78
4.25	Exemplo de restrição que não é considerada uma garganta................  78
4.26	Componentes prestes a se desconectar após erosão pelo maior disco digital
inscrito na garganta................................................      78
4.27	Imagem binária de placa de circuito impresso.....................    .	83
4.28	Histogramas de gargantas associados à imagem do PCB (a) parte condutora
(b) parte isolante.....................................................   83
4.29	Representação esquemática de uma fila de espera .......................  84
5.1	Cantata e um workspace típico ........................................... 90
5.2	Workspace para gerar as visualizações tridimensionais do capítulo 3	....	97
5.3	Algumas seções da amostra experimental utilizada neste trabalho ......	100
5.4	Variação de magnitude nos dados originais .............................  101
5.5	Variação de magnitude após a aplicação da transformação de escala ....	101
5.6	As seções da fig. 5.3 após aplicada a transformação de registro segundo o
método proposto .......................................................  104
5.7	Processo de segmentação das fases sólida e porosa, (a) Seção nível-de-cinza original (b) Resultado indesejável obtido por limiarização simples (c) Imagem limitante (d) Resultado da limiarização adaptativa (e) Filtragem da imagem
do item d (fase sólida) (f) Subtração das imagens do itens cee (fase porosa) 107
5.8	Visualização da fase sólida (a) antes da interpolação (b) após a interpolação 110
5.9	Visualização da fase porosa (a) antes da interpolação (b) após a interpolação 110
5.10	Espectros de padrões morfológicos associados à fase sólida utilizando disco
digital segundo métrica (a) do quarteirão (b) euclidiana (c) do máximo . . .	115
5.11	Rotulação com vizinhança 6 da fase sólida (a) antes e (b) após a segmentação
binária com o método dos marcadores filtrados............................ 116
5.12	Espectros de padrões geodésicos associados à fase sólida utilizando disco digital segundo métrica (a) do quarteirão (b) euclidiana (c) do máximo ....	117
5.13	Espectros de padrões morfológicos associados à fase porosa utilizando disco
digital segundo métrica (a) do quarteirão (b) euclidiana (c) do máximo . . .	118
5.14	Histogramas de gargantas associados à fase sólida utilizando como elemento
estruturante primitivo disco unitário (a) do quarteirão (b) do máximo . . .	121
5.15	Histogramas de gargantas associados à fase porosa utilizando como elemento
estruturante primitivo disco unitário (a) do quarteirão (b) do máximo . . .	121
Lista de Tabelas
2.1	Resultados do primeiro exemplo para o método proposto......................  25
2.2	Resultados	do	primeiro exemplo para o método de Merickel................... 26
2.3	Resultados	do	segundo exemplo para o método proposto....................  27
2.4	Resultados do segundo exemplo para o método de Merickel .........	27
5.1	Resultados	do	registro das seções do modelo 3D ~~ método	proposto......... 102
5.2	Resultados	do	registro das seções do modelo 3D - método	de Merickel . . .	103
5.3	Raios médios segundo os diversos discos digitais utilizados (valores em mm
entre parênteses) ..................................................    .	119
5.4	Tamanhos médios segundo os dois elementos estruturantes utilizados (valores
em mm entre parênteses) ...............................................     120
Capítulo 1
Introdução
Com a disponibilidade de recursos computacionais cada vez mais poderosos que vem sendo constatada nos últimos anos, as técnicas de processamento e análise de imagens tridimensionais têm ganhado um grande impulso. Ao contrário das técnicas tradicionais, que procuram obter os parâmetros de interesse a partir de seções bidimensionais do objeto em estudo, os métodos tridimensionais lidam diretamente com a estrutura 3D real do objeto. Através desta tecnologia é possível simplificar e otimizar o trabalho humano no que diz respeito à quantificação e avaliação de imagens, produzindo-se resultados precisos, confiáveis e eficientes.
Dentro deste contexto, a análise de imagens tridimensionais tem se tornado uma tecnologia das mais importantes nos dias de hoje, devido ao largo campo de aplicações em que vem sendo utilizada, abrangendo as mais diversas áreas: medicina, biologia, geologia, engenharia, metereologia, astronomia, robótica, física, química e muitas outras.
Uma técnica não-linear, com sólida fundamentação teórica, que vem alcançando um grande êxito em aplicações de processamento e análise de imagens é a Morfologia Matemática , que teve suas bases lançadas em 1964 por Georges Matheron e Jean Serra na Ecole Nationale Supérieure des Mines de Paris.
A Morfologia Matemática se baseia em transformações de forma, que preservam a relação de inclusão, ao contrário das técnicas tradicionais lineares que preservam a relação de adição. A despeito de sua importância, as técnicas lineares não são suficientes para lidar com imagens do mundo tridimensional real, pois neste os objetos não se somam, mas se
Entretanto, antes de se passar ao processamento e análise tridimensionais propriamente ditos, é preciso considerar o importante problema da reconstrução volumétrica do objeto que se deseja estudar. A reconstrução volumétrica, também chamada de reconstrução tridimensional, consiste na formação de um conjunto de dados que represente a estrutura tridimensional do objeto em estudo a partir de informações bidimensionais do mesmo.
Um caso bastante comum é o da reconstrução tridimensional a partir de seções seriadas, que é o processo pelo qual se obtém um modelo tridimensional a partir de imagens 2D consecutivas que representam seções paralelas de um objeto do mundo real. Em muitos casos práticos, é necessário resolver o problema de registro entre as seções seriadas do objeto em estudo, o que usualmente consiste na determinação das transformações de translação, rotação e escala necessárias ao casamento ou alinhamentro entre as seções.
1.1	Objetivos
Neste trabalho, nos propomos a desenvolver um conjunto de métodos e ferramentas que permitam a reconstrução volumétrica e posterior análise tridimensional de um objeto do mundo real. Propomos um método original para o registro das seções seriadas do objeto, que apresentou um desempenho superior a um método anterior, encontrado na literatura. Desenvolvemos também ferramentas de análise de imagens tridimensionais baseadas na Morfologia Matemática, sendo que duas delas, as granulometrias geodésicas e o histograma de gargantas, foram desenvolvidas ao longo deste trabalho, não tendo sido encontradas na literatura pesquisada.
0 objeto tridimensional estudado consiste em uma amostra experimental através da qual pretendeu-se modelar um sistema físico poroso. 0 estudo de sistemas contendo meios porosos (rochas) é de grande relevância em diversas áreas economicamente importantes tais como a petrofísica, engenharia de petróleo, engenharia de reservatórios, análise de solos e cristalografia. A caracterização de meios porosos serve bem para demonstrar a aplicação das ferramentas 3D desenvolvidas, pois é usualmente feita a partir da análise de
1.2	Materiais e Métodos
A amostra experimental utilizada neste trabalho consiste em um objeto aproximadamente cilíndrico de gesso contendo pedaços de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha onde duas fases complementares normalmente existem: a fase sólida, que constitui o material propriamente dito e é representada pelos pedaços de giz, e a fase porosa, que corresponde ao espaço que pode ser invadido por fluidos modificando as propriedades físicas do meio, e que é representada pelo gesso.
Durante todo o processo de desenvolvimento, foi adotado como plataforma o sistema de visualização e processamento de imagens Khoros. Este sistema consiste em um pacote computacional aberto, desenvolvido na Universidade do Novo México e baseado no Unix e no XI1, sistemas por sua vez largamente difundidos. 0 Khoros tem alcançado enorme popularidade em todo o mundo e vem sendo utilizado nas mais diversas áreas, tais como manipulação e análise de imagens médicas, sensoreamento remoto, visualização científica, reconhecimento de padrões, sistema de informações geográficas, aplicações de processamento de imagem em geral e até mesmo aplicações como bancos de dados e sistemas de controle.
1.3	Organização do trabalho
Este trabalho se encontra organizado da maneira que se segue.
No capítulo seguinte é apresentado o método original de registro de seções seriadas que será utilizado para a reconstrução tridimensional da amostra experimental em estudo.
No capítulo 3, apresentamos as transformações básicas da Morfologia Matemática tridimensional, e também os conceitos preliminares que serão necessários para o desenvolvimento da teoria.
No capítulo 4, são apresentadas as ferramentas da Morfologia Matemática para a análise de imagens tridimensionais que serão utilizadas mais tarde para o estudo da caracterização de meio poroso. Estas ferramentas se baseiam principalmente nas transformações básicas apresentadas no capítulo 4.
No capítulo 5, discutiremos todas as etapas envolvidas na reconstrução tridimensional da amostra experimental, e em seguida utilizaremos as ferramentas de análise tridimensional baseadas na Morfologia Matemática, desenvolvidas no capítulo 4, para a obtenção de medidas que descrevam a estrutura morfológica da amostra em estudo. Antes, fazemos uma descrição do ambiente computacional utilizado, o Khoros, assim como das duas toolboxes utilizadas, a V3DTOOLS e a MMACH, em cujo desenvolvimento tivemos a oportunidade de participar.
Por fim, no capítulo 6 apresentamos algumas conclusões obtidas e também sugestões para continuação na linha de pesquisa abordada por este trabalho.
Capítulo 2
Registro de Seções Seriadas
2.1	Introdução
Em muitos casos práticos de reconstrução volumétrica, como o que consideraremos no capítulo 5, é necessário resolver o problema de registro entre as seções seriadas do objeto em estudo, o que usualmente consiste na determinação das transformações de translação, rotação e escala necessárias ao casamento ou alinliamentro entre as seções.
Na literatura, encontramos várias abordagens para o problema de registro de seções seriadas. Cygansky e Orr [15] e Faber e Stokely [19] utilizaram a teoria de momentos tensoriais para encontrar as transformações de registro. Esta teoria se aplica porém a problemas que envolvem apenas rotação e escala, isto é, transformações afins. Dudani et al. [18] tentaram resolver o problema utilizando os eixos principais das seções do objeto. Este método produz bons resultados quando as seções são idênticas a menos, mais uma vez, de uma transformação afim.
Abordagens mais gerais que estas usualmente se baseiam na determinação das transformações de registro a partir de um conjunto de pontos rotulados, utilizando geralmente um critério de mínimos quadrados, como por exemplo os trabalhos de Arun et al. [2] e Merickel [30]. Este tipo de abordagem, o qual adotaremos, tem a grande vantagem de ser geral, podendo ser aplicado a qualquer tipo de imagem.
Neste capítulo apresentaremos um método de registro original [11, 10], baseado
no criterio de mínimos quadrados, que possui a vantagem de não utilizar técnicas com-putacionalmente caras, tais como decomposição de valor singular [2] ou inversão numérica de matrizes [30]. Trata-se de urna técnica combinada de minimização associada a uma es-tratégia de busca orientada. Os erros numéricos introduzidos são desta forma reduzidos. Utilizaremos imagens sintéticas para demonstrar a efetividade do método proposto, estabelecendo inclusive uma comparação com um outro método de registro, proposto por Merickel [30]. Deixaremos para o capítulo 5 a apresentação dos resultados obtidos em um problema de reconstrução tridimensional real.
Vale ressaltar ainda que utilizamos conjuntos de pontos rotulados bidimensionais, já que nossa principal aplicação é a reconstrução tridimensional a partir de seções seriadas, mas a técnica apresentada é facilmente estendida para o problema de registro tridimensional, bastando para isto fazer uma modificação no processo de busca.
2.2	O problema do registro
O objetivo básico de um método de registro é encontrar o conjunto de transformações geométricas necessárias para alinhar uma secão corrente com uma seção mestre, a qual é a seção de referência (fixa). Note-se que esta atribuição é dinâmica, isto é, a seção corrente de uma passagem do algoritmo pode se tornar, após ser alinhada, a seção mestre da passagem seguinte (alternativamente, pode se fixar uma das seções, por exemplo a primeira, como a seção mestre de todo o processo de reconstrução). O conjunto de transformações pode ser aglutinado em uma só transformação chamada transformação de registro.
Uma vasta classe de técnicas utiliza pontos rotulados para se encontrar os parâmetros da transformação de registro. Estes pontos rotulados podem ser obtidos por métodos automáticos, utilizando técnicas de reconhecimento de padrões, ou de forma manual, onde um operador seleciona visualmente pontos de referência fixos entre as seções consecutivas, levando assim a uma técnica semi-automática.
Os pontos rotulados correspondentes à seção mestre e à seção corrente são cha-mados de pontos mestres e pontos correntes, respectivamente (ver fig. 2.1).
As transformações geométricas usualmente requeridas são escala, rotação e trans-
*	«	9
Pontos Mestres:	P,, P„, .... P
1’	2’	’ n
Pontos Correntes:	P., P_,.... P
1’	2	’ n
Figura 2.1: Seções mestre e corrente e respectivos pontos rotulados
lação. Portanto, o algoritmo deve, em geral, produzir quatro parâmetros como saída:
—	Escala: s
—	Rotação: 8
—	Translação: tx,ty
Observe que a ordem em que as transformações acima são aplicadas é relevante, pois nem a escala nem a rotação comutam com a translação, apesar de comutarem entre si (Em nosso método, a ordem assumida é a indicada acima). Observamos ainda que a mudança de escala é considerada uniforme, isto é, a variação de magnificação é a mesma nas direções x e y.
2.3	O método de registro proposto
Nesta seção descreveremos a técnica desenvolvida para se determinar as transformações de escala, rotação e translação necessárias ao registro das seções seriadas a partir dos pontos rotulados.
Alguns algoritmos encontram diretamente os parâmetros das transformações, como é o caso do método apresentado por Merickel em [30]. A técnica que desenvolvemos adota uma abordagem diferente: primeiro são determinados os pontos solução que se a-justam da melhor maneira possível (segundo o critério de mínimos quadrados) aos pontos
A transformação de escala é tratada à parte. A depender da aplicação e do tipo de imagem, duas opções são possíveis: o parâmetro de escala pode ser determinado a priori, em uma etapa de pré-processamento, ou pode ser calculado a partir dos pontos rotulados (ver seção 2.3.1.2). Em ambos os casos, a transformação de escala é aplicada às seções anteriormente à obtenção dos parâmetros de rotação e translação.
Concluímos então que o problema a ser atacado pode ser resumido como:
-	Determinar a transformação de escala existente entre as seções mestre e corrente.
-	Encontrar, usando o critério de mínimos quadrados, os pontos solução
a partir dos pontos mestres
e dos pontos correntes
(a:2!
-	Encontrar o conjunto de parâmetros que definem as transformações de rotação e translação (nesta ordem) capazes de mapear os pontos correntes sobre os pontos solução.
A seguir, descreveremos cada uma das etapas acima.
2.3.1	Obtenção da transformação de escala
As mudanças de escala existentes entre as seções de um objeto são normalmente produto de um processo de aquisição mal realizado, ou ainda problemas com o hardware de digitalização, como por exemplo scanners e câmeras com derivações (drifts) indesejáveis em seu funcionamento.
(2.1)
(2.2)
(2.3)
Propomos duas alternativas para resolver o problema de escala. A primeira opção, a mais geral, utiliza os pontos rotulados enquanto que a segunda pode ser vista como uma etapa de pré-processamento, não utilizando os pontos rotulados. Nas próximas duas seções descreveremos cada uma das duas metodologias propostas.
2.3.1.1	Obtenção da escala a partir dos pontos rotulados
Esta primeira técnica, a qual pode ser aplicada a qualquer caso, baseia-se na comparação entre os comprimentos médios dos segmentos formados pelos pontos rotulados nas seções mestre e corrente.
Os comprimentos médios correspondentes às seções corrente e mestre são calculados da seguinte forma:
&amp;lt;= E Ê Vw-;)2+«-^)2
2 *=1
™ e è y«-^)2+w-^)2
*'=i j=»+i
Desta forma, é possível determinar o parâmetro de escala como:
m
s = — c
2.3.1.2	A transformação de escala como etapa de pré-processamento
Nesta seção descreveremos a segunda técnica proposta para a obtenção do parâmetro de escala, a qual nao é tão geral quanto a apresentada na seção anterior, mas que é útil em muitos casos.
Considere-se por exemplo a fig. 2.2, que apresenta os contornos preenchidos de duas seções consecutivas obtidas na digitalização de um objeto tridimensional, um modelo de meio poroso, como veremos no capítulo 5 (Note as marcas fiduciais introduzidas, que são utilizadas em uma etapa posterior para a obtenção dos pontos rotulados).
Figura 2.2: Contornos preenchidos de duas seções consecutivas de um objeto tridimensional
A idéia é obter uma correlação entre o parâmetro de escala s e as áreas das seções. Não podemos relacionar contudo o parâmetro s com as áreas diretamente, pois se tratam de parâmetros de dimensionalidades distintas: este é linear, enquanto que aquelas são quadráticas. Temos que procurar portanto um atributo para as seções que seja linear.
A solução neste caso é tomar os raios médios das seções, os quais podem ser definidos em função das áreas como:
A
(2.5)
Desta forma, obtemos o parâmetro de escala s como:
2.3.2	Obtenção das transformações de rotação e translação
Esta etapa é o ponto central do método proposto, onde formulamos e derivamos a solução do problema de programação quadrática correspondente ao critério de mínimos quadrados e em seguida mostramos como obter os parâmetros de rotação e translação a partir de uma estratégia de busca orientada.
2.3.2.1	Solução do problema de três pontos
Para facilitar o entendimento da técnica desenvolvida, consideraremos inicialmente o problema de se encontrar as transformações de rotação e translação para o caso em que se dispõe de três pontos rotulados em cada seção. Posteriormente, será descrita a generalização para n pontos.
Procuraremos formular o problema de mínimos quadrados no contexto da programação quadrática. Para isso, necessita-se de uma função custo e de um conjunto de restrições.
A função custo para o método de mínimos quadrados é simplesmente a soma das distâncias ao quadrado entre os pontos solução e os pontos mestres:
(*1 - *i)2 + (yi - vi)2 + (*2 - ^)2 + (.Vi - Vi)2 + (*3 - X3)2 + (V3 - vi)2 (2.7)
O conjunto de restrições a que os pontos soluções devem obedecer diz respeito à geometria dos pontos correntes, já que se deseja que estes possam ser mapeados exatamente sobre os pontos solução. No caso de três pontos, o objetivo é portanto descrever, de forma a não permitir ambiguidades, a geometria de um triângulo.
Em uma primeira abordagem, poderíamos considerar o seguinte conjunto de restrições:
(z2 - *i)2 + to - yi)2	- 7]
(z3-zi)2 + to-i/i)2	~&amp;lt;	(2-8)
to - *i)to - *1) + to - 2/1 )to " yi) ~ í
onde:
■q = (x'2 - z'i)2 + (y2 - vj)2
&amp;lt;= Oá — xí )2 + (s4 — ví)2
C = (i'2-a:'j)(a:3-x;) + (i4-l4)(lé-/i)
Este conjunto de restrições corresponde a especificar o comprimento dos lados P1P2 e P{P^ ^em como 0 ângulo entre eles (ver fig. 2.3).
Figura 2.3: Especificação de geometria invariante a rotação e translação
O problema de programação quadrática formado por (2.7) e (2.8) acima é não-linear devido ao conjunto de restrições especificado. Sua solução pode ser obtida por métodos iterativos de aproximação, tal como o método de Newton [25].
Uma solução em forma fechada pode ser obtida desde que o conjunto de restrições seja linear, resultando em um sistema de equações lineares após a aplicação das condições de primeira ordem, conforme será visto mais adiante.
Um tal conjunto linear de restrições pode ser obtido se desvincularmos a rotação da translação. Se o problema de minimização envolve apenas translação, a descrição da geometria dos pontos correntes não precisa envolver comprimentos ou ângulos, mas apenas vetores.
No nosso caso, são especificados os vetores P\P^ e P1P3, como pode ser visto na fig. 2.4. 0 conjunto de restrições resultante é simplesmente:
X2 - Xj = Qi
2-3 - X! = a2
(2-9)
y? ” y-L = 0i
ífo - yi ~ ^2
A rotação está embutida nos parâmetros ai,a2»/?i e 02- O cálculo destes termos será descrito posteriormente.
Figura 2.4: Especificação de geometria invariante apenas a translação
Para fins de simplicidade na obtenção da solução do problema de programação quadrática, é conveniente introduzir a seguinte mudança de variáveis:
= si ~
Wí =	%2 “ ^2
=	^3-^3	(2.10)
= yi-vl
^V2 = yi-yí
	= V3 - y-3 0 problema de programação quadrática pode ser reescrito então da seguinte
forma:	min w^i2 + wX22 + wX32 + wyl2 +	+ wy32
sujeito a
Wx2 ~ ™xl

(2.11)
W^-Wari = a2 “ (^3 “ xl)
Wpj-Wji = A - (tó -’/Í)
Wy3 ~ Wyl
= &amp;amp;~ü/3”^r)
Observe que na formulação (2.11) acima o vetor solução fornece uma medida direta do resíduo ou erro associado à minimização, em contraste com a formulação anterior à mudança de variáveis.
A formulação (2.11) permite também colocar o problema na forma matricial
padrão:
min |wtQW
2
sa AW = b
onde:
Q = 2I6x6
w = [ wxi Wx2 Wx3 Wyi Wy2 Wy3
”-110	0	0	0 '
10	1	0	0	0
0 0	0	-1	1	0
0 0	0	-1	0	1
A =
(2.13)
(2.14)
(2.15)
&lt;*i + (x; - $;)
b= ^ + (^3-^1) Pi + fâ-yl)
. ^2 + (yã ” yí)
0 problema descrito por (2.12) pode ser resolvido utilizando-se o método da mínima. norma [34], ou, alternativamente, pode-se aplicar as condições necessárias de La-grange e resolver o sistema linear resultante [25]. Nosso método emprega a segunda opção, como veremos a seguir.
Usando as condições necessárias de Lagrange, obtém-se o seguinte sistema linear:
í QW + Atp =
I AW
onde p é o vetor de multiplicadores de Lagrange.
Mostra-se [25] que, se Q é uma matriz n x n positiva-definida no sub-espaço II = {W AW = 0} e A tem posto m, sendo A uma matriz m x n, então a matriz
Q A^
A 0
é não-singular, e consequentemente o sistema (2.17) possui solução.
No nosso caso, Q é uma matriz 6x6 positiva definida em todo o espaço R6, pois é múltipla positiva da identidade; A é uma matriz 4x6 de posto 4 (Basta verificar que os vetores-linha de A são linearmente independentes). Desta forma, está garantido que o sistema (2.17) possui solução, a qual pode ser obtida algébricamente como:
fi "~(aQ_1At) b	(2.18)
W = Q-1Ar(AQ-1AT)“1b	(2.19)
Um problema que surge neste momento é o da inversão da matriz AQ“1AT. Devido à maneira como foi formulado o problema de programação quadrática, a matriz A apresenta uma forma muito simples, como vemos na eq. (2.15). Isto permite se obter a
inversa da matriz AQ”1 AT algébricamente, de forma fechada, mesmo no caso geral de n pontos rotulados (como veremos adiante), evitando assim a inversão numérica de matrizes, a qual é cara computacionalmente e introduz erro numérico. Este é o principal aspecto do método proposto.
Desta forma, o vetor de multiplicadores de Lagrange g e o vetor solução W são dados simplesmente por:
			= Lb	
		w	= Mb	
onde:				
		2	-1 0	0
	2	-1	2 0	0
	L =			
	3	0	0 2	-1
		0	0 -1	2
1-10 0
2-100
0	0 2 -1
0	0-1 2 ,
Note que a matriz M possui um formato peculiar:
onde:
M =	0	0
		
	-1	-1
1		
4? = - 3	2	-1
	-1	2
(2.20)
(2.21)
(2.22)
(2.23)
(2.24)
(2.25)
as componentes x e y dos vetores Web separadamente,				
w =	Wx . Wy			(2.26)
b =	bx by			(2.27)
teremos:				
wx	= #b;		X	(2.28)
wy	= #b;		Z	(2.29)
As equações (2.28) e (2.29) permitem apreciar a simplicidade da abordagem adotada, possivelmente insuspeita a princípio. Vale ressaltar ainda que, como veremos adiante, para problemas com n pontos rotulados a separabilidade da matriz M se mantém, o que representa um fato muito vantajoso computacionalmente.
2.3.2.1.1	Determinação do parâmetro de rotação através da busca orientada
Os termos ai,a2,/?i e fa, daqui por diante chamados de termos de rotação. desempenham um papel importante no método proposto, pois representam a conexão entre o procedimento de minimização descrito na seção anterior e a busca orientada que determina o parâmetro de rotação 0.
Como já foi mencionado, a idéia central do método é, na formulação do problema de minimização, deixar a rotação à parte, resultando em uma derivação simples e que exija pouco esforço computacional, produzindo como consequência um menor erro numérico.
0 parâmetro de rotação 0 é encontrado de forma iterativa, em um processo de busca orientada, onde a cada iteração, o problema (2.12) é resolvido (o que como vimos requer apenas duas multiplicações de matrizes), o resíduo ou erro médio quadrático (RMS) é calculado diretamente a partir do vetor solução W, e a busca segue em direção do menor
RMS, dado por:
RMS = |£V^í + wJ,.	(2.30)
1=1
Constatou-se na prática que o criterio RMS acima apresenta um comportamento unimodal em relação ao parámetro isto é, não possui mínimos locais, mas apenas um mínimo global. Um esquema simples para a busca pode ser obtido portanto através da subdivisão do espaço de interesse (o intervalo 0o - 360°) em incrementos iguais e pelo refinamento progressivo da subdivisão em torno do RMS mínimo obtido a cada passo até atingir uma resolução predefinida. O processo de busca pode então ser implementado de forma bastante eficiente, começando com um incremento “grosso” que val sendo sucessivamente refinado tanto quanto se queira. Após a obtenção do parâmetro de rotação 0 a partir da busca, é fácil obter os parâmetros de translação tx e tVi como mostraremos na seção 2.3.3.
Os termos de rotação são calculados para cada iteração da busca a partir da geometria dos pontos correntes e do ángulo 0 corrente. O sistema de coordenadas pode ser escolhido arbitrariamente; no entanto, é imprescindível que a convenção adotada seja consistente em todos os passos da implementação, desde a etapa de obtenção dos pontos rotulados até o processo de reconstrução propriamente dito. No caso de nossa implementação, o sistema de coordenadas adotado é o sistema retangular usual cuja origem é o centro de cada seção, o que simplifica a etapa de reconstrução, pois permite implementar a transformação de rotação de maneira mais simples.
Explicaremos agora como obter os termos de rotação a partir da geometria dos pontos correntes e do parámetro 0 corrente. Como já vimos, o triangulo formado pelos três pontos correntes da seção a ser alinhada pode ser descrito por dois vetores:
v; =	(2.31)
v' = (xs-Zuys-y'i)	(2.32)
Esta descrição é invariante à translação, mas não o é em relação à rotação. Aplicando-se uma rotação de um ângulo 0 no sentido anti-horário, obtemos (ver fig. 2.5):
x" = 3?J eos 0 — sin 0 i = 1,2,3.
y','	— gf' gjn $ yt. cog Q í=l,2,3.
assim, os vetores após a rotação são dados por:
(*2 “ A) cos e - (y2 - 3/0 sin 0 (x2 - 2:0 sin 0 4- (3/2 ~ 3/0cos0
(x'3 - xft) cos 0 - (y3 - 3/í) sin 0 (^3 - 2:0 sin0 4* (3/3 ~ Vi)cos#
Desta forma, tem-se:
oi(0) = (x2 - 2:0 cos0 - (3/2 - 3/0 sin0
o2(0) = (2:3 - X0COS0 - (3/3 - 3/0sin0
&amp;amp;(0) = (z'2~?0sm0 + (3/2-i/0cos0
/?2(0) = (xf3 - a:0sin0 + (y3 ~ $/0cos0
(2.33)
(2.34)
(2.35)
(2.36)
(2.37)
(2.38)
(2.39)
(2.40)
2.3.2.2	Generalização do método para n pontos rotulados
A extensão da técnica proposta na seção anterior para um número n arbitrário de pontos é imediata.
A função custo a ser utilizada continua sendo a soma das distâncias ao quadrado entre os pontos solução e os pontos mestres:
(*1 ~ Xj)2 + (z2	+	~X*n)2 + (.yi " ^*)2 + (S/2	+	+	(2A1)
O conjunto de restrições especifica os vetores P^P?,, P1P3, . ■ •, PiPn&gt; mantendo a idéia anterior de uma especificação de geometria invariante apenas à translação:
X2 ~~ Xi = Oi
3?3 “	=	«2
ÍTn Xi	—	Ct'n—1
V2 - Vi	-	01
313-1/1	=	íh
Vn ~ Vl = Pn-l
Fazendo uma mudança de variáveis análoga à anterior,
Wxi = Xi ~~
i = 1,..., n
wvi = Vi~ Vi í = 1,..., n
(2.42)
(2.44)
obtemos a seguinte formulação para o problema de programação quadrática:
min
È^. + Èri.
Í=1	1=1
sujeito a
wx2 “ wxl
Wx3 ~ WX1

= «2 ” (®5 ~ Xj)
wxn ~ ^xl
Wy2 - Wyl
Wy^ Wyl
(ix	$ \
"~ xl)
= h- te* -ví)
Vlyn-wvl =	/3n-i - (s/j - 3/j)
Note que o problema acima contém n variáveis e 2(n - 1) restrições.
A forma matricial padrão do problema acima é dada por: min |wrQW
(2.45)
onde tem-se:
Q
= 2l2nx2n			(2-46)
^n~lxn	On—1xn		(2.47)
On-lXn	Nn_ixn		
wyl	Wy2 • • •	^yn 1	(2.48)
com:
j / 1 e i = j ~ 1 caso contrário
bxi = ai +	- xj)
(2.49)
(2.50)
(2.51)
-1 , j= 1
Ní; =	1
i =	— 1
j =
0
i = 1,..n — 1
ôy: = A’ + (&amp;amp;*+i ~~yi) í = 1,..., n - 1
Seguindo uma argumentação inteiramente análoga à da seção 2.3.2.1.1, concluímos que:
Oí(^) = (x$+1 - zí)cos0 ” (yi+1 “ #í)sin# í = l?...,7i“l	(2.53)
0i(0) = (z^i - zl)sin# + tó+i - *4)cos0 i = l,...,n~l	(2.54)
A solução do problema formulado em (2.45) existe, pois os vetores-linha da matriz A são linearmente independentes (ver seção 2.3.2.1), e é dada pela equação (2.19):
W = Q-1Ar(AQ-1Ar)'1b	(2.55)
Como foi discutido na seção 2.3.2.1, devido à forma particular da matriz A foi possível determinar a inversa de maneira puramente algébrica. Desta forma, a solução assume a forma simples da equação (2.21):
W = Mb
A matriz M permanece separável para o problema com. n pontos:
	M2nx2{	1 n-'&gt;- ñ	^riXn-l Onxn-1	Onxn-1 $nXn-1	(2.56)	
onde a matriz $ é descrita por:						
	-1,	i = 1 ou	1 - 1 / j	i = 1,	. ,.,n	
&lt;	n — 1 ,	«" 1 = j		j = 1	,...,71-1	(2.57)
	0 ,	caso contrário				
A solução é portanto dada simplesmente por:
Wx = l$bx	(2.58)
n
Wy = ifcby	(2.59)
Vale ressaltar que o erro médio quadrático a ser calculado a cada iteração da busca é dado por:
+ (2.60) n i=l
2.3.3	Obtenção dos parâmetros de registro
Podemos resumir a obtenção dos parâmetros de registro, descritos na seção 2.2, da seguinte forma:
Parâmetro de escala Obtido na etapa de pré-processamento descrita na seção 2.3.1
-	Parâmetro de rotação 0: Obtido diretamente da busca, sendo o ângulo que produz o menor erro médio quadrático, calculado para cada iteração conforme a eq. (2.60)
-	Parâmetros de translação tx e ty: São obtidos a partir do parâmetro de rotação e dos pontos solução e correntes. Note que os pontos solução são dados por:
Xi — x? + wxt	í = l,...,n	(2.61)
Vi = y* 4- wyi	i = 1,..., n	(2.62)
Tendo os pontos solução e os pontos correntes (e conhecendo-se o ângulo de rotação), é simples determinar a translação introduzida. O problema de minimização (2.11) garante que a translação é a mesma para cada um dos pontos, portanto os parâmetros tx e ty podem ser calculados tomando como base, por exemplo, o primeiro ponto:
= xi - (í| cos 0 -yí sin 0)	(2.63)
2.4	Dois exemplos com imagens sintéticas
Nesta seção apresentamos dois exemplos de aplicação do método de registro proposto utilizando imagens sintéticas.
Nestes dois exemplos o processo utilizado para a obtenção dos pontos rotulados é manual, e não consideraremos o problema de escala, isto é, assumiremos uma magnifi-cação uniforme entre as seções. No capítulo 5 apresentaremos os resultados obtidos em um caso de reconstrução tridimensional real, quando discutiremos também a determinação da transformação de escala.
Apresentaremos uma comparação feita com o método proposto por Merickel [30]. Como se verá, nosso método apresentou resultados superiores, devido à simplicidade numérica do algoritmo (Não há inversões numéricas de matrizes), apesar de se utilizar um processo de busca, o qual é inerentemente aproximativo.
2.4.1	Primeiro exemplo
Neste primeiro exemplo, a primeira seção é uma imagem sintética simples, enquanto que a segunda foi obtida a partir da primeira introduzindo~se uma transformação combinada de rotação e translação com os seguintes parâmetros (ver hg. 2.6):
Figura 2.6: Seções sintéticas utilizadas no primeiro exemplo
Utilizamos os asteriscos para indicar que os parâmetros acima são “ideais”, no sentido de que deveriam ser os parâmetros otidos em um processo de registro onde não houvesse a presença de qualquer tipo de erro (Na verdade, os parâmetros a serem obtidos são os acima multiplicados por -1, pois o método de registro encontrará a transformação inversa. Nas tabulações de resultados apresentadas para o primeiro exemplo, desconsideramos o sinal negativo).
Neste exemplo, os pontos rotulados correspondem aos “vértices” das imagens sintéticas. Foram empregados de dois até seis pontos. Vale ressaltar que, ao contrário do que é afirmado em [30], o método de Merickel pode ser aplicado ao caso de apenas dois pontos rotulados.
Os resultados obtidos para este exemplo pelo método proposto podem ser vistos na tabela 2.1, enquanto que os resultados obtidos pelo método de Merickel encontram-se na tabela 2.2.
Número de pontos	ta:	ty	0	RMS
2	24.754	51.739	59.87294	0.07173
3	25.024	51.943	59.75159	0.35999
4	24.916	51.945	59.78497	0.33898
5	24.901	51.962	59.77870	0.28318
6	24.899	51.935	59.78563	0.25959
^^^médio = 0'^6269
Tabela 2.1: Resultados do primeiro exemplo para o método proposto
As fontes de erro no caso deste exemplo são o erro do operador ao selecionar manualmente os pontos rotulados e o erro digital introduzido na geração da segunda seção. Os resultados indicam que o menor erro médio quadrático foi atingido para o caso de apenas dois pontos rotulados. Isto significa que as fontes de erro mencionadas acima têm pouca influência neste caso, o mais simples de todos. Deve ser observado, entretanto, que um pequeno RMS indica um bom casamento entre os pontos rotulados dados, mas não é uma condição suficiente para um bom registro, pois o processo de seleção dos pontos rotulados, quer seja manual, quer seja automático, é muito sujeito a erros. Se o erro na obtenção dos
Número de pontos			0	RMS
2	24.738	51.765	59.87294	0.07648
3	25.023	51.942	59.72631	0.36415
4	24.915	51.955	59.77184	0.34360
5	24.899	51.968	59.76995	0.28605
6	24.893	51.949	59.76402	0.26476
RMSmédio = 0.26701
Tabela 2.2: Resultados do primeiro exemplo para o método de Merickel
pontos rotulados for entretanto garanti d amente pequeno, então o RMS fornece um bom critério também de casamento entre as seções.
Finalmente, observamos que para este exemplo o método proposto foi superior ao método de Merickel em cada caso, assim como na média.
2.4.2	Segundo exemplo
O segundo exemplo apresentado é similar ao primeiro. Foram geradas duas seções sintéticas, onde a primeira é um hexágono e a segunda é obtida a partir da primeira não apenas se introduzindo uma transformação geométrica, mas também deformando-se a primeira imagem (fig. 2.7). Com isso, pretendeu-se modelar uma fonte de erro típica do
Figura 2.7: Seções sintéticas utilizadas no segundo exemplo
A transformação geométrica introduzida na segunda seção foi neste caso apenas
uma rotação, não tendo sida aplicada nenhuma translação:


e* ~ 20°
Os resultados foram obtidos mais uma vez variando-se o número de pontos rotulados de 2 a 6, os quais correspondem aos vértices dos polígonos. Como no exemplo anterior, as tabelas 2.3 e 2.4 permitem fazer a comparação entre os métodos proposto e o de Merickel, respectivamente, onde ignoramos o sinal negativo do parâmetro de rotação.
Número de pontos	tx		e	RMS
2	-0.865	-17.061	32.91169	1.42466
3	6.390	-7.492	26.23296	5.02885
4	7.932	-5.236	24.90108	5.12179
5	6.584	-1.143	22.88466	6.91792
6	7.989	0.295	23.07049	7.95289
RMSmédio ~ 5-28922
Tabela 2.3: Resultados do segundo exemplo para o método proposto
Número de pontos			e	RMS
2	-2.936	-15.382	32.91169	3.01608
3	4.458	-8.098	26.89112	5.36441
4	7.676	-5.256	24.81533	5.13932
5	6.219	-1.163	22.32030	6.91838
6	8.076	0.370	22.73598	7.98433
KMSmédio = 5.68450
Tabela 2.4: Resultados do segundo exemplo para o método de Merickel
Como era de se esperar, as taxas de erro RMS obtidas foram piores do que para o primeiro exemplo. Entretanto, é importante notar que com o acréscimo de pontos ambos os métodos produziram parâmetros de rotação cada vez mais próximos do parâmetro “ideal”.
Também observamos que, mais uma vez, o método proposto foi superior ao de Merickel em cada caso e também na média. Destaca-se o caso de dois pontos, onde há uma diferença superior a 100% entre as duas taxas de erro RMS. Vale ressaltar também que a diferença percentual entre os RMS médios foi maior no segundo exemplo que no primeiro, indicando uma tendência do método proposto ter um desempenho tão mais superior quanto menos exato for o casamento entre as seções e/ou entre os pontos rotulados.
Capítulo 3
Morfologia Matemática em Três Dimensões
3*1 Introdução
A análise e o processamento de imagens sofreram durante muito tempo, e ainda sofrem, de uma forte influência de técnicas do processamento de sinais clássico, tal como a filtragem linear. Esta baseia-se na preservação da adição, e se presta muito bem à modelagem de sistemas acústicos, eletrônicos, ópticos e outros. Infelizmente, tem-se constatado que, a despeito de sua importância, as técnicas lineares não são suficientes para lidar com as imagens. 0 mundo como o enxergamos não é translúcido, mas apresenta objetos que se sobrepõem uns aos outros, além de conter um conceito importante e subjetivo, o de forma.
A Morfologia Matemática, que teve suas bases lançadas em 1964 por Georges Matheron e Jean Serra na École Nationale Supérieure des Mines de Paris, é uma técnica não linear, com sólida fundamentação teórica, que vem alcançando um enorme sucessso em aplicações de análise de imagens.
A Morfologia Matemática se baseia em transformações de forma que preservam a relação de inclusão, e não a de adição. Estas transformações satisfazem a um conjunto de princípios fundamentais, escolhidos de forma a modelar fenômenos do mundo real dentro do que J. Serra denominou “Universo dos Corpos Morfológicos”. Estes princípios não vieram de um experimento específico, mas tão pouco podem ser encarados como axiomas matemáticos.
As transformações estudadas pela Morfologia Matemática são definidas sobre reticulados completos, entidades matemáticas com origem na teoria de conjuntos [5], Imagens binárias, em tom de cinza, multi-espectrais (coloridas), além dos intervalos, grafos, partições, etc. são conceitos que podem ser formalizados com o uso de reticulados completos, tornando clara assim a abrangência da teoria.
As operações fundamentais da Morfologia Matemática são denominadas erosão e dilatação. A partir de composições destas operações elementares é possível gerar qualquer outra operação definida entre reticulados completos [4]. As operações entre reticulados completos se aplicam a diversos problemas recorrentes no campo da análise de imagens, tais como filtragem, segmentação, descrição de forma e muitos outros.
A idéia básica das operações fundamentais da Morfologia Matemática consiste em investigar uma imagem através de um elemento estruturante, examinando onde este elemento se “encaixa”. De fato, é possível se demonstrar que existe uma bijeção entre o conjunto das dilatações (resp. erosões) e o conjunto dos elementos estruturantes [5], isto é, assim como cada elemento estruturante define uma operação de erosão e outra de dilatação, cada transformação que seja uma erosão ou dilatação possui um elemento estruturante associada a ela.
Neste capítulo, apresentaremos as transformações básicas da Morfologia Matemática tridimensional. Estaremos mais interessados na Morfologia Matemática binária ou de conjuntos [5], Daremos entretanto as principais definições e conceitos referentes à Morfologia Matemática nível-de-cinza ou de funções [49, 4]. Antes, apresentaremos conceitos preliminares que serão necessários para o desenvolvimento da Morfologia Matemática tridimensional.
3.2	Conceitos preliminares
Nesta seção apresentaremos os conceitos básicos sobre esquema de representação e topologia digital 3D que serão necessários na definição das transformações básicas da
3.2.1	Esquema de Representação e Grid Digital
A primeira questão relevante que deve ser analisada ao se propor um método de análise de imagens tridimensionais diz respeito ao esquema de representação a ser empregado e, mais particularmente, ao grid digital a ser adotado.
0 problema consiste em escolher como distribuir pelo espaço tridimensional os elementos digitais que compõem as imagens. Isto determina a topologia digital do espaço 3D, isto é, como os conceitos de vizinhança e conectividade, entre outros, estão definidos.
No caso bidimensional, as opções mais utilizadas são os grid retangular e hexagonal [3]. No espaço 3D o número de alternativas cresce consideravelmente, devido à maior complexidade. Têm sido estudados, entre outros, os grids hexagonal cilíndrico, cúbico, cúbico centrado e cúbico de faces centradas [32].
Neste trabalho utilizamos o grid cúbico. Apesar de apresentar desvantagens (“herdadas” do grid retangular no caso 2D), tais como paradoxos de conectividade [23], este esquema possui a vantagem da simplicidade: além de ser perfeitamente isotrópico, é o esquema de representação mais natural em computadores digitais. Além disso, como a maioria das imagens tridimensionais são obtidas a partir do empilhamento de seções bidimensionais, como no caso deste trabalho, o grid cúbico representa a solução mais simples e direta.
0 esquema de representação baseado no grid cúbico é também conhecido como modelo Voxel [20, 27]. O termo voxel é um acrônimo para volume element. Da mesma forma que o pixel é a unidade básica de uma imagem 2D, o voxel é o elemento básico de uma imagem tridimensional. Os voxels são portanto pequenos cubos de tamanho e orientação uniformes, isto é, que formam uma subdivisão regular do espaço.
Na coleção de cubos que constituem o espaço voxel, cada pequeno cubo pode ser completamente descrito em termos das coordenadas de seu canto superior esquerdo posterior ou, alternativamente, de seu centro. Isto significa que, devido à regularidade da
subdivisão espacial, apenas um conjunto de coordenadas precisa ser armazenado para cada voxel [27]. Normalmente podemos limitar nossa atenção a uma região de interesse, a qual é um subconjunto de Z3, e então a coleção pode ser eficientemente codificada como um matriz tridimensional c^, onde a posição do voxel é dada implicitamente pelos índices i,j, k (ver fig. 3.1). A este subconjunto de Z3 daremos o nome de espaço vozel e o representaremos pela letra E. Como ilustração, apresentamos na fig. 3.2 uma visualização tridimensional do espaço voxel formado pelo empilhamento das fatias de um joelho obtidas por tomografia computadorizada de raio-x (onde a fatia situada no topo do volume pode ser vista), uma aplicação típica do esquema de representação Voxel.
Figura 3.1: Região de interesse e subdivisão do espaço voxel
3.2.2	Vizinhança e Conectividade
Nesta seção e na seguinte, apresentaremos extensões para o caso 3D de conceitos de topologia digital [24] que nos serão úteis. Excelentes abordagens para o caso 2D podem ser encontradas em [43] e [22]
No caso do grid retangular 2D são bastante conhecidos os conceitos de 4- e 8-vizinhos. Dado um determinado pixel, os 4-vizinhos são aqueles que compartilham uma
Figura 3.2: Exemplo de espaço voxel: empilhamento das fatias de um joelho
aresta com este, enquanto que os 8-vizinhos compartilham pelo menos um vértice, como
(a)	(b)
Figura 3.3: Vizinhança 2D: (a) 4-vizinhos ao pixel central e (b) 8-vizinhos ao pixel central
No caso 3D, podemos definir analogamente os conceitos de 6-, 18- e 26-vizinhança. Os 6-vizinhos a um dado voxel são aqueles que compartilham uma face com este, os 18-vizinhos compartilham pelo menos uma aresta e os 26-vizinhos compartilham pelo menos um vértice. Isto pode ser visto esquematicamente na hg. 3.4, onde por conveniência os voxels são representados “achatados”.
A partir do conceito de vizinhança podemos definir o de conectividade. Para isso, define-se um caminho de comprimento n como sendo uma sequência de voxels vq, tq,..., vn
Figura 3.4: Vizinhança 3D: (a) 6-vizinhos (b) 18-vizinhos e (c) 26-vizinhos ao voxel central tal que v; é vizinho de para i = 1,.. .,n. Dependendo da vizinhança utilizada, podemos ter portanto 6-, 18- ou 26-caminhos.
Sendo S um subconjunto do espaço voxel E e u e v voxels pertencentes a 5, dizemos que u e v estão conectados se existe um caminho começando no primeiro e terminando no segundo contendo apenas voxels pertencentes a 5. Obviamente, u e v podem estar 6-, 18- ou 26-conectados e, além disso, um voxel isolado é sempre conectado a si próprio.
Partindo das definições acima podemos derivar os seguintes fatos sobre cornpo-nentes conexos, conceito que será importante em capítulos posteriores:
-	Dado um voxel v G E, o conjunto de todos os voxels que são conectados segundo alguma vizinhança a v definem um componente conexo de S.
-	Dois componentes conexos podem estar 6-, 18- ou 26-conectados, se for possível encontrar um voxel no primeiro que esteja 6-, 18- ou 26-conectado a outro voxel no segundo, ou podem não estar conectados.
-No caso de 5 conter apenas um componente conexo dizemos que S é 6-, 18- ou 26- conexo, dependendo da vizinhança utilizada.
3.2.3	Distância e Discos Digitais
d(u,v) &gt; 0
(d(u,t?) = 0 O u = v)
(3-1)
(3.2)
d(ti,v) = d(v,u)
d(u,v) &amp;lt;d(u,w) + d(w,v)
(3-3)
Sejam dois voxels u e v pertencentes a E descritos respectivamente pelas coordenadas (ux,Uy,uz) e (vx,vy,vz). A distância euclidiana entre os dois voxels é definida por:	________________________
&lt;(u, v) = ^(ux - vx)2 + (uy - vy)2 + (uz - vzf	(3.4)
Duas outras distâncias que nos serão bastante úteis são a distância do quarteirão: dq(u,v) =| ux ~ vx | + | Uy ■- vv | + | uz ~ vz |	(3.5)
e a distância do máximo:
dm(u, v) - max{| ux - vx |, | uy - vy |, | uz - vz [}	(3.6)
Pode-se mostrar que d€, dq e dm obedecem às restrições (3.1) a (3.3), portanto são distâncias válidas. Verifica-se também que:
ám&lt;de&amp;lt;dq	(3.7)
Tendo definido a noção de distância, podemos passar ao importante conceito de discos digitais em E:
Dd(o,r) = {uCE\d(o,u)&lt;r}	(3.8)
onde o € E determina o centro do disco e r 6 Z+, o seu raio.
Para se visualizar a forma assumida pelos discos digitais correspondentes às diversas distâncias, é útil reduzir o problema a duas dimensões, impondo por exemplo
Ddq C Dd' C Ddm

Figura 3.5: Discos 2D de raio r = 5 correspondentes às distâncias (a) quarteirão (b) euclidiana e (c) máximo
No caso tridimensional, é fácil agora concluir que, para as distâncias do quarteirão, euclidiana e do máximo, teremos respectivamente aproximações digitais de octaedros, esferas e cubos. Na fig. 3.6 podemos ver uma visualização 3D destes discos.
Figura 3.6: Discos 3D de raio r — 10 correspondentes às distâncias (a) quarteirão (b) euclidiana e (c) máximo
Os elementos estruturantes com os quais lidaremos para construção de gra-
nulometrias, realização de filtros morfológicos, e outras operações são os discos digitais, que possuem a vantagem de serem isotrópicos (simétricos) [44]. Os discos digitais 3D são também muito usados na Morfologia Matemática nível-de-cinza, como por exemplo na implementação de transformações top-hat e rolling bali [49, 31].
3.3	As transformações básicas da Morfologia Matemática
Consideremos o conjunto P(£) cujos elementos são todos os subconjuntos de E. O conjunto P(E) é parcialmente ordenado pela relação de inclusão “c”. O conjunto parcialmente ordenado (P(£), C) provido das operações de união, interseção e complementação constitui um reticulado completo [5].
Os elementos de P(E) são na verdade nossos objetos de interesse dentro do espaço voxel, enquanto que a relação de inclusão expressa o tipo de relacionamento entre os objetos que é característico à Morfologia Matemática, conforme mencionado anteriormente. A Morfologia Matemática pode ser encarada como a “aplicação da teoria dos reticulados às estruturas espaciais” [45].
No caso das imagens 3D nível-de-cinza, é possível desenvolver um formalismo similar. Sendo K — [0, k] um intervalo fechado no conjunto dos números inteiros Z, mostra-se que o conjunto EK das funções f : E —► K, provido da relação de ordem parcial&amp;lt;, tal que para todo f,g € EK\
f &amp;lt;g	, Vu € E	(3.10)
é um reticulado completo [4], onde as operações de união, interseção e complementação são dadas respectivamente por:
(/V^)(u) - max{/(u),^(u)} , Vu G E	(3.11)
(/ A g)(u) = min{/(u), g(u}} , Vu € E
(3.12)
(3.13)
(~f)(u) = k~	VuZE
3.3.1	Erosão e Dilatação
Para definir as transformações fundamentais da Morfologia Matemática, necessita-se antes do conceito de translação e de origem de um elemento estruturante.
Podemos obter translações de um subconjunto B € P(E) da seguinte forma:
B + u = (u+v)eE, iveB	(3.14)
Note que a operação de soma deixa implícito que assumimos uma origem o G E para o elemento estruturante:
u + v = o 4- (íhí + ou)	(3.15)
A erosão (invariante por translação) de um conjunto A € P(E) por um elemento estruturante B G P(E) pode ser definida como:
eS(A)^{ueE\(BAu)C A}	(3.16)
A erosão é uma transformação crescente, isto é, preserva a a relação de inclusão:
Ai C A2 =t&gt; cjg(Aj) C €3(^2)	(3.17)
Além disso, se a origem está contida no elemento estruturante, a erosão produz um efeito de “encolhimento” do conjunto original, isto é,
0 € B =&gt; £b(A) C A	(3.18)
diz-se então que a erosão por um elemento estruturante contendo a origem é uma transformação anti-extensiva.
Intuitivamente, a definição (3.16), em conjunto com a propriedade de anti-extensividade, reflete o conceito de “inspeção” através do elemento estruturante, que a-bordamos na introdução deste capítulo: a erosão é a transformação pela qual são mantidos
Para ilustrar o efeito da erosão, consideremos o objeto tridimensional da fig. 3.7, um modelo da fase sólida de uma rocha (0 processo de aquisição e reconstrução tridimen-sional deste objeto será descrito no capítulo 5).
Figura 3.7: Modelo tridimensional da fase sólida de uma rocha
Na fig. 3.8 podemos ver o efeito da erosão por diversos discos digitais 3D (ver seção 3.2.3) do objeto tridimensional da figura anterior.
A erosão possui um operador dual^ chamado de dilatação. Para definir este operador, será conveniente introduzir primeiramente o conceito de soma de Minkowski:
A @ B = {w € E )	€ A e € B, com w — u + v}	(3.19)
A dilatação (invariante por translação) de um conjunto A € P(E) por um elemento estruturante B € P(E) pode então ser definida como o operador tal que:
¿s(A) = A® B
(3.20)
Se nos limitarmos aos elementos estruturantes simétricos [45], a dilatação pode ser vista como uma “erosão do fundo”:
(a)
(b)
(c)
Figura 3.8: Erosão por discos digitais 3D de raio r 5 segundo diversas métricas, (a) disco do quarteirão (b) disco euclidiano (c) disco do máximo
Uma outra definição equivalente em P(E), porém mais útil para entender o efeito da dilatação, é a seguinte:
¿b(4) = |J(B + u), Vu£A	(3.22)
isto é, a dilatação é igual à união de todos as versões transladadas de B centradas em algum voxel de A.
Assim como a erosão, a dilatação também é uma transformação crescente (preserva a inclusão):
Ai C A2 =&gt; ¿b(Ai) C Ób(A2)	(3.23)
Além disso, se a origem estiver contida no elemento estruturante, o efeito produzido pela dilatação é o de “expansão” do conjunto original, isto é,
0 e B =&gt; A C ¿b(A)	(3.24)
Em outras palavras, a dilatação por um elemento estruturante que contenha a origem é uma transformação extensiva.
Uma outra propriedade, decorrente da definição da dilatação em (3.22), é a
seguinte:
Na fig. 3.9 vemos o efeito produzido por dilatações pelos vários discos digitais. As setas indicam posições onde pode-se visualizar o disco que foi empregado em cada uma das dilatações, consequência de haver voxels isolados naquela posição no objeto original da fig. 3.7.
Figura 3.9: Dilatação por discos digitais 3D de raio r — 5 segundo diversas métricas, (a) disco do quarteirão (b) disco euclidiano (c) disco do máximo
Uma propriedade muito útil da erosão e dilatação, que diz respeito à composição destes operadores, é a separabilidade:
eBy	€Bn = €Bi
¿Bi &amp;amp;B1 -^Bn =
(3.27)
A propriedade acima permite que erosões ou dilatações por elementos estrutu-rantes muito grandes possam ser obtidas pela composição de erosões ou dilatações por uma série de elementos estruturantes de menores dimensões, apropriadamente escolhidos, o que é bem mais eficiente do ponto de vista computacional [5]. Em particular, os discos digitais induzidos pelas métricas do quarteirão e do máximo (ver seção 3.2.3) possuem decomposições
muito convenientes:
Aí9(o, t) = Dd(o, 1) © ... ©	(o, 1), r &gt; 2	(3.28)
S—----—-----v-----------'
T ~ 1 somas de Minkowski
Z&gt;lím(o,r) = Z&gt;(im(o&gt;l)ffi...®/?dm(o,l), r&gt;2	(3.29)
...... '
T - 1 somas de Minkowski os discos digitais D¿q(o, 1) e D¿m(o, 1) são elementos estruturantes primitivos, subconjuntos do cubo 3x3x3 centrado na origem, levando a implementações bastante eficientes das erosões e dilatações correspondentes. Observamos que o disco digital euclidiano infelizmente não dispõe, no domínio digital, de uma decomposição tão simples quanto esta.
No caso da Morfologia nível-de-cinza, podemos definir a erosão e a dilatação de uma função f 6 EK por um elemento estruturante B € P(E) da seguinte forma:
(/)(«) = max{/(v) I (B-fi u) A E} , Vu € E	(3.30)
cb(/)(u) = min{/(v) | v € (B + u) n E} , Vti € £	(3.31)
As transformações assim definidas são muitas vezes chamadas de erosão e dilatação por um elemento estruturante planar, devido ao fato de B ser um conjunto e não uma função.
3.3.2	Gradiente Morfológico
Uma transformação derivada da erosão e dilatação que nos será útil é o gradiente morfológico, que é dado simplesmente pela subtração entre a dilatação e a erosão:
tb = ¿3 A egc = ¿8 - (B	(3.32)
onde A denota a interseção entre operadores.
Outras duas definições utilizadas para o gradiente morfológico são:
=	(3.33)
rB = I -	(3.34)
,em que I denota o operador identidade.
Encontraremos ao longo deste trabalho diferentes aplicações para o operador gradiente, tais como segmentação de imagens nível-de-cinza e extração de bordas.
3.3.3	Aberturas e Fechamentos
7fi =	(3.35)
Uma definição equivalente em PfE), porém mais esclarecedora, é a seguinte:
7b(4) = U{(B+u)C4}	(3.36)
isto é, a abertura consiste da união de todos as versões transladadas do elemento estrutu-rante que “encaixam” dentro da imagem.
Assim como a erosão (por um elemento estruturante contendo a origem), a abertura é um operador crescente e anti-extensivo. Diferentemente da erosão, a abertura é um operador idempotente:
~ÍB7B ~ 1B	(3.37)
0 operador dual da abertura chama-se fechamento:
= [7B(AC)]C	(3.38)
ou:
4&gt;b = &amp;amp;BtB	(3.39)
Igualmente à dilatação (por um elemento estruturante contendo a origem), o fechamento é crescente e extensivo. Além disso, também é idempotente:
&amp;amp;B&amp;amp;B = d&gt;B	(3.40)
Diversamente das erosões e dilatações, nas abertura e nos fechamentos a posição da origem em relação ao elemento estruturante não desempenha nenhum papel, já que o “efeito de translação” produzida pela erosão (resp. dilatação) é cancelado pela dilatação (resp. erosão) subsequente.
As propriedades de crescimento e idempotência fazem das aberturas e fechamentos parte de uma importante classe de transformações, os filtros morfológicos [46].
De fato, a abertura pode ser vista como um processo de filtragem interna das bordas, quebrando pequenas ligações entre objetos e eliminando partículas de tamanho reduzido. Por dualidade, o fechamento possui o efeito contrário: introduz uma suavízação externa das bordas, ligando objetos próximos e fechando pequenos buracos. Além disso, os efeitos das aberturas e fechamentos podem ser combinados através de composições utilizando elementos estruturantes apropriados, dando origem aos filtros alternados sequenciais [49, 46].
(a)
(c)
Figura 3.10: Abertura por discos digitais 3D de raio r = 5 segundo diversas métricas, (a) disco do quarteirão (b) disco euclidiano (c) disco do máximo
Nas figs. 3.10 e 3.11 podemos ver algums dos efeitos mencionados acima, introduzidos por aberturas e fechamentos com os diversos discos digitais sobre o objeto tridi-mensional da fig. 3.7.
No caso das funções, a abertura e o fechamento são definidos da mesma forma que nas eqs. (3.35) e (3.39). O efeito dessas transformações nas imagens nível-de-cinza é também de filtragem, removendo pequenos detalhes claros nas aberturas ou escuros nos fechamentos [49, 22],
Figura 3.11: Fechamento por discos digitais 3D de raio r ~ 5 segundo diversas métricas, (a) disco do quarteirão (b) disco euclidiano (c) disco do máximo
[29, 44]. Da mesma forma, temos fechamentos morfológicos e fechamentos algébricos. Teremos a oportunidade de encontrar uma classe de aberturas algébricas muito útil na próxima seção.
3.3.4	Erosões e Dilatações Geodésicos e Reconstrução
Define-se a erosão geodésica ou condicional de um conjunto A por um elemento estruturante B, dado um conjunto C (A, 13,0 € P(jF)), como:
cb,c(A) = c#(A) U 0	(3.41)
Sua operação dual, a dilatação geodésica ou condicional, é definida de forma análoga por:
= Ób(A) n C	(3.42)
Notamos que a erosão geodésica está sempre “envolvendo” o conjunto C
C C	(3.44)
o conjunto C é portanto chamado frequentemente de máscara da erosão e dilatação geodésicas.
No caso das imagens nível-de-cinza, podemos definir analogamente os operadores acima. A erosão geodésica de uma função f € EK por um elemento estruturante B € P(E) dada uma função g G EK é dada por:
*£,//)(«) = max{€B(/)(u),&amp;lt;?(«)} , W e E	(3.46)
Da mesma forma, a dilatação geodésica para funções é definida como:
g(u)} , Vu € E	(3.46)
A mais comum aplicação das erosões e dilatações geodésicas é o processo conhecido como reconstrução [46]. Consideremos o caso da dilatação: dado um conjunto A, não necessariamente conexo, e um conjunto M de marcadores então a aplicação repetida da dilatação geodésica
Pb,m(A) = 6b,a(¿b,a(‘ • -(^b,a(M)) ...))	(3.47)
irá fornecer como resultado os componentes conexos de A que intersectam algum marcador. Evidentemente que na prática nao se faz uma composição de infinitas dilatações geodésicas; como lidamos com subconjuntos limitados, o processo converge após um certo número de repetições, cessando de haver mudança ao se fazer uma nova dilatação. Na fig. 3.12 vemos um exemplo bidimensional de reconstrução. Note que os objetos binários são representados neste trabalho pela cor preta sobre o fundo branco.
Um resultado muito interessante [45] é que o operador de reconstrução pb,m (para um conjunto de marcadores M fixo) constitui uma abertura algébrica! Por isso mesmo esta transformação também é conhecida como abertura por reconstrução, ou ainda, abertura geodésica, 0 conjunto de marcadores M pode ser obtido através de uma simples erosão, ou pela aplicação de operadores como última erosão, bissetor condicional ou o método dos

I X J
Figura 3.12: Exemplo de reconstrução: (a) Imagem original (b) Marcadores (c) Resultado máximos filtrados^ como veremos no capítulo seguinte, ou mesmo podem ser impostos como um conjunto arbitrário, como no caso da fig. 3.12, onde foi utilizado um processo manual.
Note que a abertura por reconstrução não introduz “deformação” no conjunto original. Diferentemente da abertura morfológica, a abertura por reconstrução representa apenas uma operação de “limpeza”, que remove alguns componentes conexos do conjunto original, deixando os restantes intactos. Este fato pode ser explorado na construção de gra-nulometrias geodésicas e de histogramas de gargantas, como veremos no capítulo seguinte.
Uma outra importante diferença entre a abertura morfológica e a abertura por reconstrução é que esta última leva em conta a conectividade do conjunto original. Sendo assim, o resultado depende fortemente do elemento estruturante utilizado. Se este for muito grande, a dilatação geodésica pode acabar “saltando” entre componentes não-conectados [17]. Além disso, o tipo de conectividade obtida depende do tipo de vizinhança expressa pelo elemento estruturante; por exemplo, no caso de se utilizar um cubo 3x3x3, obteremos componentes 26-conexos.
Encerramos este capítulo observando que é possível definir de maneira análoga uma transformação de reconstrução baseada na erosão geodésica, isto é, um fechamento por reconstrução. O fechamento por reconstrução é uma transformação muito útil em várias aplicações, como por exemplo na mudança de homotopia associada à segmentação de imagens via watersheds, conforme veremos no capítulo que se segue.
Capítulo 4
Ferramentas da Morfologia Matemática para Análise de Imagens
4.1	Introdução
Neste capítulo apresentaremos ferramentas da Morfologia Matemática para a análise de imagens. Estas ferramentas se baseiam principalmente nas transformações básicas apresentadas no capítulo anterior. As ferramentas apresentadas serão aplicadas no capítulo seguinte em um estudo de caracterização de meio poroso.
A primeira ferramenta apresentada é a transformação de watersheds. Tratase de uma poderosa ferramenta de segmentação. Ilustraremos a aplicação dos watersheds na segmentação de uma imagem nível-de-cinza, um pé humano obtido por ressonância magnética, e então passaremos ao problema da segmentação binária de objetos superpostos, que é o caso que mais nos será útil.
Em seguida apresentamos as granulometrias, uma ferramenta poderosa para descrição de tamanho e forma. Ilustraremos a utilidade das distribuições granulométricas, em particular do espectro de padrões, para uma seção do modelo tridimensional estudado no capítulo 5. Introduzimos também uma classe de granulometrias baseadas no conceito de reconstrução, que chamamos de granulometrias geodésicas. Utilizando o resultado da segmentação binária via watersheds, estabelecemos uma comparação entre a granulometria morfológica tradicional e a granulometria geodésica proposta. Procuramos desenvolver no
Propomos também uma ferramenta para obtenção do histograma de gargantas de uma imagem, baseada apenas nas transformações básicas da Morfologia Matemática. Ilustramos a aplicação desta ferramenta em uma imagem de uma placa de circuito impresso.
Gostaríamos de ressaltar que todas estas ferramentas são desenvolvidas para o caso tridimensional, sendo aplicadas ao problema de caracterização de meio poroso 3D, como veremos no capítulo 5. Entretanto, para facilitar a visualização e compreensão de muitos dos conceitos que são apresentados, ilustramos neste capítulo a aplicação das ferramentas para imagens bidimensionais, deixando os resultados obtidos no caso tridimensional para o capítulo seguinte.
4.2	Watersheds
A transformação de watersheds é uma poderosa ferramenta de segmentação oferecida pela Morfologia Matemática [8]. Como veremos, esta transformação pode ser utilizada tanto para o caso usual da segmentação de imagens nível-de-cinza, como também para o problema da separação de objetos superpostos, que é o caso que mais nos interessará, pois será útil na construção de granulometrias geodésicas (seção 4.3.3).
Para compreender o conceito dos watersheds, pensemos em uma imagem nível-de-cinza bidimensional. Esta pode ser interpretada como um relevo, onde as áreas claras correspondem às elevações do terreno e as áreas escuras, às depressões. Na fig, 4.1 vemos uma imagem sintética, a soma de distribuições Gaussianas invertidas, e seu modelo de relevo, ou modelo topográfico, associado.
Consideremos agora que uma gota d’água é abandonada em um ponto qualquer do relevo. Esta tenderá, pela ação da gravidade, a escorrer até um ponto de mínimo regional. Define-se então o watershed (“bacia d’águas”) W(M) de um mínimo M como o conjunto de todos os pontos do relevo, i.e. pixels da imagem bidimensional, onde a gota d’água escorreria para M [46]. De maneira equivalente, podemos imaginar uma inundação em que a água surge primeiro nos mínimos regionais e vai subindo. Nos pontos em que a água de duas
Figura 4.1: Imagem sintética vista segundo (a) representação usual e (b) modelo topográfico
Figura 4.2: LDA superposta à imagem original: (a) representação usual e (b) modelo topográfico
No caso tridimensional o modelo topográfico deve ser substituído, por exemplo, por um campo elétrico, onde seriam abandonadas cargas negativas, que tenderiam a ir em direção aos mínimos regionais, as cargas positivas. A idéia dos watersheds pode então ser estendida facilmente: as bacias passam a ser volumes, enquanto que não temos mais uma linha, e sim uma superfície divisora, formada pela união das fronteiras fechadas dos volumes.
Vale ressaltar que, a despeito da descrição intuitiva dada acima, a transformação de watersheds pode ser definida totalmente em termos de transformações mais básicas da Morfologia Matemática [46]. Ainda assim, os algoritmos mais eficientes são aqueles que se
baseiam justamente na idéia da inundação [48].
4.2.1	Watersheds e a Segmentação de imagens nível-de-cinza
O problema de segmentação consiste em extrair as diferentes regiões presentes em uma imagem e obter contornos que as envolvam o mais perfeitamente possível.
A transição de uma região ã outra em uma imagem é caracterizada pela mudança abrupta de nível de cinza. 0 operador gradiente definido na seção 3.3.2 possui a propriedade de detectar estas variações. Ao o aplicarmos obtemos uma nova imagem nível-de-cinza, onde as elevações (segundo o modelo topográfico ou do campo elétrico) correspondem às regiões de transição enquanto que as depressões indicam regiões homogêneas. Portanto, determinar os watersheds do gradiente resolve, em tese, o problema da segmentação.
Infelizmente, a vida não é tão simples assim. Em imagens obtidas do mundo real sempre há uma considerável quantidade de ruído presente, o que introduz um grande número de bacias espúrias na determinação dos watersheds, em um efeito conhecido como super-segmentação. Na fig, 4.3 vemos um exemplo de super-segmentação em uma seção de um pé humano, obtida por ressonância magnética. Vale ressaltar que o gradiente foi obtido após uma filtragem da imagem original, o que melhora um pouco o resultado.
Uma solução para resolver o problema de super-segmentação é se tentar remover os contornos irrelevantes através de um processo de crescimento de regiões. Uma abordagem morfológica para este processo utilizando grafos planares é apresentada em [52].
Não adotaremos o processo de crescimento de regiões. Empregaremos uma metodologia mais universal, que utiliza a idéia dos marcadores (ver seção 3.3.4 do capítulo anterior). Os marcadores no caso da segmentação representam um conhecimento adicional que se possui sobre a imagem, podendo ser obtidos de maneira automática ou manual.
Uma vez de posse dos marcadores, em vez de tentar eliminar os falsos contornos após a determinação dos watersheds, efetua-se um pré-processamento do gradiente, em um processo conhecido como modificação de homotopia. e só então são computados os watersheds.
A modificação de homotopia se dá em duas etapas:
—	Imposição dos marcadores como mínimos regionais do gradiente.
-	Supressão dos mínimos indesejáveis através de um fechamento por reconstrução nível-de-cinza do gradiente utilizando como “função marcadora” o inverso dos marcadores originais.
Uma descrição mais detalhada da modificação de homotopia pode ser encontrada em [23, 46].
Como a cada bacia corresponde um mínimo regional na determinação dos wa-tersheds, é preciso fornecer um marcador para cada região a ser segmentada, inclusive o fundo da imagem. Na fig. 4.4 apresentamos os marcadores que utilizamos na segmentação de uma das regiões da fig. 4.3-a. Esses marcadores foram obtidos de forma automática. 0 marcador externo foi obtido através de um processo de limiarização seguido de filtragem, dilatação e extração de borda. 0 marcador interno foi obtido de maneira similar, substituindo-se a dilatação por uma erosão, sem extração de borda.
Figura 4.4: Marcadores utilizados na segmentação da imagem do pé
Na fig. 4.5 é apresentado o resultado após a determinação dos watersheds, onde vemos a LDA superposta à imagem original.
0 processo conjunto de modificação de homotopia seguido da determinação dos watersheds é também conhecido na literatura como watershed geodésico [46]
Figura 4.5: Resultado da segmentação por watersheds da imagem do pé
4.2.2	Separação de objetos superpostos via Watersheds
Vamos considerar agora o problema da segmentação binária, isto é, da separação de objetos superpostos em uma imagem binária. Este problema é muito comum em diversas áreas de aplicação, tais como geologia, metalurgia, agricultura, sensoreamento remoto e outras. 0 problema da segmentação binária é também frequentemente denominado de “decoalescência” dos objetos de uma imagem.
Consideremos por exemplo a imagem da fig. 4.6, que corresponde a uma seção do objeto tridimensional da fig. 3.7 no capítulo anterior (Os resultados obtidos com o objeto tridimensional propriamente dito serão apresentados no capítulo seguinte). Esta é tipicamente uma imagem granular, isto é, constituída de diversos componentes (grãos). E ilustrativo comparar esta imagem, que é uma imagem real, com a imagem sintética da fig. 3.12-a no capítulo anterior. Note como em uma imagem real os grãos tendem a se confundir uns como os outros, trazendo à tona o problema da segmentação binária.
Mostraremos que os watersheds fornecem uma solução para o problema de segmentação binária. Mas para a determinação dos watersheds, necessita-se de uma imagem nível-de-cinza, com seu modelo topográfico associado. Necessitamos portanto de um mapeamento P(E) -+ EK, isto é, que transforme uma imagem binária em uma imagem nível-de-cinza. 0 mapeamento que nos será útil é conhecido como função distância [9, 36]. Esta
Figura 4.6: Imagem binaria a ser segmentada transformação associa a cada voxel do objeto a distancia ao voxel mais próximo do fundo, isto é, dado um objeto A € P(E) temos:
. I d(u,Ac} se u € A	z
fd(A)(u) = ¿	'	f , Vu e s	(4.1)
1	0 caso contrario
Evidentemente, para cada métrica d considerada (ver seção 3.2.3) correponde uma função distancia distinta. Na fig. 4.7, vemos a função distancia associada à imagem da fig. 4.6 segundo a métrica euclidiana.
As funções distancia associadas às métricas do quarteirão e do máximo produzem resultados similares, mas em geral a função euclidiana é a que leva a melhores resultados.
Se tomarmos agora a função complementar f¿ à função distancia (ver seção 3.3), teremos um modelo topográfico associado apropriado para o problema da segmentação binária da imagem original via waterheds: os mínimos regionais corresponderão aproximadamente aos centros dos grãos, enquanto que as cristas entre as bacias são as fronteiras que procuramos (ver üg. 4.8). Fazendo a subtração dessas fronteiras, isto é, a LDA, em relação à imagem original, conseguimos “quebrar” as ligações entre os grãos adjacentes.
Infelizmente, as pequenas irregularidades presentes nos contornos de imagens
Figura 4.7: Função distância associada ao objeto da fig. anterior segundo a métrica euclidiana
Figura 4.8: Modelo topográfico associado ao complemento da função distância euclidiana
Figura 4.9: Super-segmentação obtida com a determinação direta dos watersheds utilizando a função distância euclidiana
Uma possível solução para este problema é fazer uma filtragem prévia da função distância, utilizando por exemplo uma abertura por reconstrução, como em [23]. Infelizmente, este método não surtiu efeito para a imagem da fig. 4.6, persistindo o problema da super-segmentação.
0 método que adotamos é a modificação de homotopia da função distância, utilizando o mesmo procedimento discutido na seção anterior. Isto nos traz o problema da obtenção dos marcadores. Para isto, foram examinadas as seguintes possibilidades:
™ Utilização do bissetor condicional de ordem 10
-	Utilização da última erosão
-	Máximos regionais da função distância filtrada
-	Seleção manual
CL =
0 bissetor condicional pode ser entendido com a analogia do “incendio no gramado”: se pensarmos no objeto como um gramado em que é ateado fogo simultaneamente ao longo de toda a sua borda, o conjunto de pontos que é atingido ao mesmo tempo pelo fogo originário de diferentes pontos na borda é conhecido como eixo médio do objeto. 0 bissetor condicional de ordem a é o subconjunto do eixo médio onde a “velocidade” do fogo entre um ponto e o outro é maior que a. Definições mais formais da última erosão e do bissetor condicional podem ser encontradas em [44],
Já a terceira opção, à qual nos referiremos por brevidade como “máximos filtrados”, é bastante interessante e representa um melhoramento em relação à última erosão [53]. Como foi mencionado acima, esta corresponde aos máximos regionais da função distância, mas devido a irregularidades no contorno dos objetos, um mesmo grão pode dar origem a dois ou mais máximos, e o que é pior, arbitrariamente distantes uns dos outros. Para evitar isto, é feita uma filtragem prévia na função distância que consiste em uma abertura por reconstrução da mesma utilizando como marcador a função f¿ - 1, o que remove os máximos “espúrios”, seguida da determinação dos máximos regionais, como podemos ver ilustrado em um perfil unidimensional na fig. 4.10.
Figura 4.10: Perfil unidimensional da função distância mostrando os máximos espúrios que são removidos pela abertura por reconstrução e os máximos filtrados que resultam
Na fig. 4.11 podemos ver, superpostos ao conjunto original, os marcadores obtidos por cada urna das alternativas descritas acima. Ressaltamos ainda que, com excessão dos máximos filtrados, uma pequena dilatação foi introduzida sobre os maracadores, o que melhora um pouco o resultado da segmentação. Note que não é necessário fornecer um marcador para o fundo, pois não se está procurando o contorno entre os grãos e o mesmo, mas apenas a quebra da ligação entre os grãos adjacentes após a subtração da LDA.
Utilizando o complemento da função distancia euclidiana, a qual como ja mencionamos representa o melhor caso, podemos ver na fig. 4.12 os resultados obtidos após a determinação dos watersheds.
Como vemos, o melhor resultado foi o conseguido com a seleção manual dos marcadores. Os máximos filtrados produziram um resultado próximo, mas podemos perceber neste caso que alguns grãos de dimensões reduzidas não foram segmentados, devido à ausência de marcadores para os mesmos.
Na verdade, o problema da escolha entre técnicas semi-automáticas e técnicas automáticas é uma questão recorrente nas aplicações de análise de imagens, especialmente nos problemas de segmentação. De maneira geral, poderíamos dizer que os procedimentos semi-automáticos, como o exemplo do watershed geodésico com marcadores manuais acima, possuem a grande vantagem de serem capazes de tirar proveito do conhecimento que o operador possui sobre a imagem. Os procedimentos automáticos nem sempre dão bons resultados e alguns deles são também muito dependentes da aplicação, exigindo ajustes para cada caso (por exemplo, no caso do problema de segmentação binária apresentado, a escolha da ordem do bis setor condicional a ser utilizada). Mas como veremos no capítulo 5, um procedimento automático, no caso o método dos máximos filtrados, pode se sair melhor quando a intervenção manual é difícil ou complicada, como é o caso de imagens tridimensionais (ou, pior ainda, de dimensión alidades maiores). Os procedimentos automáticos também têm uma importância grande em aplicações industriais, que envolvem processos em série.
4.3	Granulometria
As granulometrias, conceito introduzido por G. Matheron [29], constituem uma das mais poderosas ferramentas oferecidas pela Morfologia Matemática para a descrição de
Figura 4.11: Marcadores obtidos através de (a) Bissetor condicional de ordem 10 (b) Última erosão (c) Máximos filtrados (d) Seleção manual
Figura 4.12: Segmentação via watersheds utilizando os marcadores da figura anterior: (a) Bissetor condicional de ordem 10 (b) Última erosão (c) Máximos fitrados (d) Seleção manual
tamanho e forma em análise de imagens.
A idéia do método é realizar uma crivação (peneiração) dos objetos de uma imagem, seguida por uma medição quantitativa do resíduo, a fração de objetos que não atravessam a peneira. Vari ando-se o tamanho e forma dos “furos” da peneira e fazendo-se medidas consecutivas do resíduo deixado por cada crivação, obtém-se uma curva chamada por Matheron de distribuição granulométrica de tamanho, a partir da qual é possível obter um histograma de tamanho, o espectro de padrões [28]. A combinação de transformação seguida de medida representa o paradigma fundamental dos métodos de quantificação em Morfologia Matemática [44].
A medida a ser utilizada pode ser por exemplo a área ou o volume do resíduo, no caso respectivamente de imagens bidimensionais e tridimensionais. Já a transformação a ser empregada deve constituir um critério de tamanho, obedecendo aos axiomas de Matheron, como veremos na seção seguinte.
4.3.1	As Distribuições Granulométricas de Tamanho
Uma família de transformações	parametrizadas por um parâmetro A &gt; 0
(com ^o(A) = A) é chamada de uma granulometria se constituir um critério de tamanho, isto é, obedecer aos axiomas de tamanho de Matheron [44].
Os dois primeiros axiomas expressam propriedades já mencionadas no capítulo anterior (ver seção 3.3):
I)	V’a(A) C A	(anti-extensividade)	(4.2)
II)	AcC =&gt; ^a(A) C ^a(C) (crescimento)	(4.3)
para todo A e C do reticulado de interesse.
Os dois axiomas acima dizem respeito a cada transformação individualmente. 0 terceiro e mais sutil axioma, que se refere à família como um todo, é a propriedade conhecida como “comando do crivo mais forte”:
III)
= WV’aM)] =	. VA,n &gt; 0
(4-4)
Esta última propriedade requer que duas crivagens em sequência seja equivalente a uma só com a peneira “mais grossa”. Note que fazendo À = p, recaímos no conceito familiar de idempotência (seção 3.3). É fácil perceber que qualquer classificação de tamanho, mesmo as utilizadas cotidianamente, devem obedecer aos três axiomas de Matheron para que faça sentido. Um resultado fundamental, devido a Matheron, é que toda família de transformações que obedeça aos axiomas de tamanho é constituída necessariamente de aberturas algébricas [29].
Para nossos propósitos, vamos considerar inicialmente as aberturas morfológicas 7sr, onde os elementos estrurantes BT são os discos digitais de raio r (ver seção 3.2.3).
Partindo das decomposições (3.28) e (3.29) apresentadas no capítulo anterior, é possível mostrar que os discos digitais produzidos pelas métricas do quarteirão e do máximo formam sequências de abertos, significando que:
7Br(Bs) = Bs, para s &gt; r &gt; 0	(4.5)
em vista da definição de abertura na eq. (3.36) do capítulo anterior, isto é equivalente a afirmar que:
B. = Uí(5r + u)cB.}	(4.6)
e portanto
7B.(¿) £ 7b.(A)	(4.7)
para todo A 6 P(£).
Agora, pode ser mostrado [5, páginas 103-104] que se 7a e são aberturas, então para todo A € P(E),
7s(A) Ç 7r(A) O 7s[7r(A)] = 75(A) e 7rbX¿)] = 7s(-¿)	(4-8)
Das eqs. (4.7) e (4.8) acima concluímos que a propriedade do comando do crivo mais forte é satisfeita. Como os dois primeiros axiomas são automaticamente satisfeitos por aberturas, a família {vr = 75,}, r &gt; 0 utilizando os dicos digitais do quarteirão e do máximo constitui de fato uma granulóme!ria. O caso do disco digital euclidiano é mais complicado, devido ao truncamento digital que é introduzido na métrica euclidiana, invalidando a propriedade expressa em (4.5) (No caso contínuo a prova seria a mesma
Seja então A 6 P(E) o objeto de interesse e V(r) o número de voxels em 7#r(A), para r &gt; 0 (Como Bq = o, um único voxel na origem, temos que V(0)éo número de voxels em A). Note que pela eq. (4.7), V(r) é uma função monótona decrescente. Além disso, como A é um conjunto finito, V(r) = 0 para algum r &gt; R. A função : Z+ —»■ R definida por :
íW = i-^, T &gt; 0	(4.9)
é portanto monótona crescente no intervalo [0,1]. Considerando uma imagem binária como a realização de um random set [29], é possível mostrar que $(r) é uma função cumulativa de probabilidade. Sua função densidade de probabilidade associada é dada pela seguinte derivada discreta:
T(r) = í(r + 1) - $(r), r &gt; 0	(4.10)
Devido às propriedades de #(r) mencionadas acima, a função T(r) é não-negativa e se anula para r suficientemente grande. Tanto &amp;amp;(r) quanto T(r) foram chamadas por Matheron de distribuições granulométricas de tamanho. Estaremos mais interessados neste trabalho na função E(r), também chamada de espectro de padrões, a qual pode ser interpretada, conforme veremos a seguir, como um histograma de tamanho, onde para um determinado valor de r lê-se na curva a quantidade percentual de partículas, ponderada pela área (ou volume, no caso 3D), cujo raio é maior que r e menor que r + 1 (Na seção seguinte discutiremos detalhadamente o espectro de padrões).
Consideremos por exemplo a imagem bidimensional da fig. 4.13. Trata-se de u-ma imagem granular sintética onde diversos tipos de “partículas” estão presentes, entretanto pode-se dividi-las em três classes segundo o tamanho. Na fig. 4.14 temos as distribuições 4&gt;(r) e T(r) obtidas utilizando-se o disco euclidiano. Note que T(r) dá a informação de quantas e quais são as classes de tamanho presentes. No caso, temos três classes correspondendo aos raios de 5, 10 e 20, sendo que o raio médio encontrado foi de 12,699.
Este resultado também ilustra uma característica importante das distribuições
Figura 4.13: Imagem sintética a ser submetida a análise granulométrica
Figura 4.14: Curvas granulométncas associadas à imagem da figura anterior: (a) $(r) e (b) r(r)
Encerramos esta seção observando que P. Maragos propôs uma extensão para valores negativos de r das distribuições de tamanho discutidas acima [28]. Neste caso, as aberturas sao substituidas por fechamentos. Por dualidade, vemos que isto corresponde a se fazer a análise granulométrica do fundo do objeto. Neste trabalho, em vez de adotar o lado negativo das distribuições, faremos quando necessário a análise granulométrica do fundo do objeto diretamente, utilizando somente as aberturas.
4,3.2	O Espectro de Padrões
Variando-se não só o raio, mas também o próprio elemento estruturante, diferentes distribuições de tamanho são obtidas. Intuímos assim que as distribuições discutidas na seção anterior contém informação não apenas de tamanho, mas também de forma.
Tendo isto em vista, P. Maragos sugeriu o termo espectro de padrões [28] para designar a distribuição F(r), deixando claro que se trata de uma distribuição de tamanho e forma. Além disso, o termo espectro vem de uma analogia muito interessante com o processamento linear de sinais. É bem sabido que a Transformada de Fourier de um sinal é obtida transformando-o por uma multiplicação com a exponencial complexa	e em seguida
medindo a área, isto é, integrando o resultado da modulação. Variando-se a frequência u1, obtém-se o espectro de frequência, que indica a composição do sinal em termo das várias frequências (0 espectro de frequência da própria exponencial complexa é um impulso centrado em w). Apesar da Transformada de Fourier ser útil também ao processamento de imagens, ela não pode exprimir de maneira conveniente os conceitos de tamanho e forma (ver discussão na introdução do capítulo 3). 0 espectro de padrões, por outro lado, exprime justamente a composição de um objeto em termos do elemento estruturante utilizado e do tamanho do mesmo. A analogia fica clara se considerarmos por exemplo o espectro de padrões de uma esfera de raio R utilizando o disco euclidiano como elemento estruturante: 0 resultado será um impulso centrado em r = R, Na fig. 4.15 vemos os espectros de padrões correspondentes a alguns objetos bidimensionais, utilizando o disco euclidiano.
Figura 4.15: Espectros de padrões associados a alguns objetos bidimensionais
Como a maioria dos conceitos em Morfologia Matemática, o espectro de padrões é irreversível, isto é, ao contrário do processamento linear, não é possível recuperar um objeto dado o seu espectro. Apesar disso, o espectro de padrões é muito útil na caracterização dos objetos. Como pode ser visto na fig. 4.15, irregularidades na borda do objeto resultam em componentes de baixa amplitude próximo a r — 0. Além disso, a presença de protuberâncias formadas por discos de raio P se manifestam como impulsos em torno de T = P. Já o valor r(l?) (lembrando que R é o raio para além do qual P(r) se anula) indica o conteúdo de forma do objeto em relação ao elemento estruturante. Pode ser mostrado [28] que o conteúdo de forma é máximo para o elemento estruturante que mais se aproxima da forma “global” do objeto (Por exemplo, se o objeto for aproximadamente triangular, o conteúdo de forma será máximo para um elemento estruturante triangular). Infelizmente, este parâmetro só serve para a análise de imagens contendo um único objeto, não sendo útil para imagens granulares, a menos que se faça a análise individual de cada grão.
Um parâmetro útil para análise de imagens granulares é o raio médio dos grãos em relação ao disco digital utilizado como elemento estruturante. Lembrando que o espectro de padrões pode ser visto como uma distribuição de probabilidade discreta que representa um histograma de tamanho (ver seção anterior), o raio médio r pode ser obtido como o
valor esperado de F(r): R
T = V r r(r)
r=0
(4.11)
4.3.3	Granulometrias Geodésicas
A granulometria apresentada na seção 4.3.1, baseada nas aberturas morfológicas com os discos digitais, é bastante útil na descrição de tamanho e forma, como vimos na seção anterior. Esta granulometria, que chamaremos de granulometria morfológica, não leva em conta a conectividade do objeto [45], o que a princípio é uma vantagem, pois não é necessário tratar o problema de componetes superpostas.
Por exemplo, consideremos a imagem da fig. 4.6, a fatia de nosso modelo tridimensional utilizada na seção 4.2 e repetida aqui por conveniência.
Figura 4.16: Imagem a ser submetida à análise granulométrica
Como já mencionamos, trata-se de uma imagem granular, constituída por diversos componentes de variadas formas e tamanhos, sendo portanto tipicamente uma imagem
Figura 4.17: Espectro de padrões morfológico associado à imagem da fig. 4.16
Entretanto, as aberturas morfológicas agem como filtros para as bordas do objeto (ver seção 3.3.3 do capítulo anterior). Lembrando o conceito da crivação, isto significa que os objetos que não atravessam a peneira, isto é, o resíduo que é medido a cada passo da análise granulométrica, não são os objetos originais mas versões filtradas dos mesmos. Para ilustrar este fato, consideremos a fig. 4.18, que ilustra o resultado da abertura morfológica 7j3r (correspondente à construção do espectro de padrões da fig. 4.17), para alguns valores de r.
Nesta seção propomos uma granulometria utilizando uma abertura algébrica baseada no conceito de reconstrução. Como já foi mencionado no capítulo anterior (seção 3.3.4), as aberturas por reconstrução constituem uma operação de “limpeza” pura e simples, que remove alguns componentes conexos do conjunto original, deixando os restantes intactos. Vemos assim que a abertura por reconstrução introduz uma crivação “ideal”, idêntica à obtida utilizando uma peneira real onde a forma e o tamanho dos furos sejam iguais ao do elemento estruturante.
A operador baseado na reconstrução que consideraremos é definido da seguinte
r= 15
r = 18
Figura 4.18. Resultados da abertura morfológica com disco euclidiano para diversos valores de r sobre a imagem da íig. 4.16
forma:
7Br,Brec(A) = PBrte,&lt;Br(A)W	(4.12)
isto é, primeiro é feita uma erosão de um objeto A € P(E) com o disco de raio r, e em seguida a reconstrução utilizando como marcadores o resultado da erosão (0 elemento estruturante Brec é fixo e seu significado será discutido mais adiante). Apesar de não termos um conjunto de marcadores fixo, pode ser mostrado [46] que o operador definido acima constitui de fato uma abertura algébrica.
Afirmamos que a família {Vv = 7Brtj3rec}, r &gt; 0 constitui uma granulometria, a qual chamaremos de granulometria geodésica. Senão, vejamos: os axiomas de anti-extensividade e crescimento são trivialmente satisfeitos pois 7Br,Brec ® uma abertura. Já o axioma do comando do crivo mais forte pode ser mostrado lembrando que, pela definição de dilatação geodésica,
	M C N PBrtc,M(A) ç pBr&amp;amp;c,N(A)	(4.13)
Como		
	tB^A) Q	5 &gt; r &gt; 0	(4.14)
Concluímos que		
	7Br,Brec('4) Ç 7BítBrec(4), s &gt; r &gt; 0	(4.15)
para todo A 6 P(E). Recordando agora a propriedade das aberturas expressa pela eq. (4.8), temos que o terceiro axioma de Matheron está garantido. Note que a família de aberturas geodésicas considerada constitui uma granulometria inclusive para o caso dos discos digitais euclidianos, o que não é em gerai verdadeiro para as granulometrias morfológicas. Na verdade, uma condição suficiente para que uma família qualquer de aberturas geodésicas {Vn — 7Bn,Br^}f n 0 seja uma granulometria é simplesmente que a sequência de elementos estruturantes w utilizada seja crescente, isto é, Bn Ç Bm, m &gt; n, pois então a propriedade (4.14) está garantida.
Entretanto, um problema que temos que considerar é que a abertura geodésica 7Br,BreC5 ao contrário da abertura morfológica 7nr, é sensível à conectividade do conjunto original. Note que a reconstrução é feita utilizando um elemento estruturante fixo Brec, que indica justamente o tipo de conectividade a ser considerada (ver secão 3.2.2). Associando
Por exemplo, ao tentarmos fazer a análise granulométrica geodésica da fig. 4.16, obtemos o espectro de padrões geodésico mostrado na fig, 4.19, ao qual corresponde um valor de raio médio de 15,180.
Figura 4.19: Espectro de padrões geodésico associado à imagem da fig. 4.16
Vemos claramente que este não é um resultado satisfatório. Note especialmente o raio médio dos grãos, que é mais de 50% maior que o calculado com a granulometria morfológica! Isto ocorre devido justamente ao fato de termos um crivo ideal. Dessa maneira, dois ou mais grãos, mesmo que individualmente passem pela peneira para um dado valor de r, podem não passar se estiverem conectados, pois aí deixam de “caber” nos furos da peneira. Este fenômeno pode ser percebido na fig. 4.20, onde ilustramos, para alguns valores de r, o resultado da abertura geodésica 7srjBrec sobre a imagem da fig. 4.16, utilizando o disco euclidiano.
Para resolver este problema, temos que segmentar os grãos superpostos, utilizando a ferramenta apresentada na seção 4.2.2. Na fig. 4.21 repetimos por conveniência o resultado obtido naquela seção para a imagem da fig. 4.16, utilizando marcadores manuais.
Na fig. 4.22 vemos o resultado da abertura geodésica 7Br,Br&lt;c sobre a imagem segmentada da fig. 4.21, onde se pode perceber claramente o efeito da crivação ideal. É interessante comparar este resultado com aquele da fig. 4.18, correspondente à abertura
r = 3
r = 6
r = 9
r = 12
r= 15
Figura 4.20: Resultados da abertura geodésica 7sr,Brec com &amp;amp;sco euclidiano para diversos valores de r sobre a imagem da fig. 4.16
Figura 4.21: Segmentação dos grãos superpostos da fig. 4.16
morfológica.
Por fim, vemos na fig. 4.23 o espectro de padrões geodésico associado à imagem segmentada da fig. 4.21, utilizando o disco euclidiano, com um raio médio de 10,949. A utilização do disco euclidiano corresponde a uma peneira com os “furos” circulares. Isto significa na prática que se estabelece como critério de tamanho o raio da circunferência inscrita nos objetos, um parâmetro muito útil em várias aplicações.
Comparando o resultado da fig. 4.23 com o da fig. 4.17, notamos que a forma das curvas é similar, indicando ambas a presença de cinco classes de tamanho. Uma maneira de apreciar a diferença entre os dois espectros é observar que para vários valores de r o espectro de padrões geodésico se anula, indicando a ausência de grãos de tamanho correspondente àqueles valores. Já o espectro de padrões morfológicos não se anula para estes mesmos valores, revelando a imprecisão introduzida pelo efeito de filtragem associado às aberturas morfológicas.
r = 12
r = 6
r = 15
r = 18
Figura 4.22: Resultados da abertura geodésica 7Br,#rec com disco euclidiano para diversos valores de r sobre a imagem da fig. 4.21
Figura 4.23: Espectro de padrões geodésico da imagem segmentada da fig. 4.21
4.4	Histograma de Gargantas
0 histograma de gargantas constitui uma distribuição estatística que indica a frequência de ocorrência de gargantas em um objeto binário em função de um parâmetro linear, o qual corresponde ao tamanho do maior elemento estruturante inscrito na garganta, conforme detalharemos mais adiante.
Por garganta se entende a restrição que ocorre entre dois componentes conecta dos, conforme é ilustrado na fig. 4.24, onde podemos ver também o maior elemento estruturante, no caso um disco digital euclidiano, inscrito na garganta.
Um fato importante é que só deve ser considerada como uma garganta uma restrição entre dois componentes cujas dimensões são claramente maiores comparadas à da garganta. Por exemplo, a restrição da fig. 4.25 não é considerada uma garganta.
Nesta seção propomos um algoritmo para a obtenção do histograma de gargantas baseado em operações da Morfologia Matemática. A idéia do algoritmo surge naturalmente ao se considerar a interpretação da erosão. Sendo esta o conjunto de pontos onde o elemento estruturante “encaixa” no conjunto original, o maior elemento estruturante inscrito na garganta é o primeiro a produzir a separação dos componentes após a erosão, desde que descartemos casos como o da fig. 4.25, onde não seriam produzidos os dois componentes. A fig. 4.26 ilustra a detecção de uma garganta através da erosão.
Figura 4.24: Garganta entre dois componentes conectados e maior disco digital inscrito
Figura 4,25: Exemplo de restrição que não é considerada uma garganta
Figura 4.26: Componentes prestes a se desconectar após erosão pelo maior disco digital inscrito na garganta
o (origem),	s = 0
B,	6 = 1
	6 &gt; 2
,6-1 somas de Minkowski
possui tamanho 6.(0 mesmo conceito de tamanho foi utilizado por P. Maragos com objetivos diferentes, ver [28]). Utilizando a propriedade de separabilidade expressa na eq. (3.26), percebemos que a composição de erosões sucessivas com o elemento estruturante B produzirá uma erosão por um elemento estruturante de tamanho igual ao número de erosões efetuadas.
Reunindo as idéias acima, concluímos que para obter o histograma de gargantas devemos realizar erosões sucessivas por um elemento estruturante primitivo dado e, a cada erosão efetuada, contar o número de componentes conexos resultantes, obtendo assim uma distribuição acumulada H(s), função do tamanho s do elemento estruturante inscrito nas gargantas, isto é, do número de erosões até aquele instante efetuadas. 0 histograma de gargantas A(s) é dado então simplesmente como a derivada discreta da distribuição acumulada:
A(6) = Q(6 + 1) - íl(a), 6&gt;0	(4.17)
0 histograma de gargantas, à maneira do espectro de padrões (ver seção 4.3.1), produz uma curva onde para um determinado valor de s lê-se a quantidade de gargantas de tamanho maior que s e menor que s •+ 1, Vale ressaltar que o parâmetro de tamanho s depende do elemento estruturante primitivo utilizado, e diferentes histogramas de gargantas, contendo informações muitas vezes complementares, podem ser obtidos variando-se o elemento estruturante.
Para contar o número de componentes conexos realizamos a rotulaçâo da imagem binária. A rotulaçâo é uma transformação que leva uma imagem binária em uma imagem mvel-de-cinza onde o valor de cada voxel é um rótulo correspondente ao componente conexo
(ver seção 3.2.2) que o contém, isto é, dado um objeto A € P(E) temos:
K í 0 se u € Ac
rot(A)(u) =&amp;lt;	, Vu € S (4.18)
I l se u € 1-ésimo componente conexo
onde l &gt; 1 é o rótulo associado a cada componente conexo, Para determinar o número total de componentes conexos bastar tomar o valor máximo da imagem rotulada. Note ainda que a operação de rotulação depende evidentemente do tipo de vizinhança utilizada. Vale ressaltar que uma outra alternativa para a determinação do número de componentes conexos seria utilizar o algoritmo associado à relação de Euler [44], Esta solução, apesar de ser mais simples, possui entretanto problemas, como o de exigir que os componentes sejam simplesmente conexos (não possuam “buracos”), e por isso não foi adotada.
O algoritmo das erosões e rotulações sucessivas delineado acima apresenta no entanto uma falha: como na maioria das imagens há uma diferença de tamanho entre os diversos componentes, pode ocorrer que alguns deles desapareçam como consequência da erosão, antes de se ter determinado todas as gargantas, influindo no processo de rotulação. Isto faz com que a distribuição acumulada H(s) deixe de ser uma função crescente, e o histograma A(s) perde obviamente o seu significado.
A solução para este problema consiste em se utilizar erosões condicionais (ver seção 3.3.4 do capítulo anterior), onde a máscara a cada etapa é o conjunto de componentes que desapareceria após a erosão de tamanho s. Para se determinar a máscara utilizamos a abertura geodésica definida na equação (4.12). A diferença entre o conjunto original A e sua abertura geodésica, utilizando um elemento estruturante B, constitui uma operação que chamaremos de top-hat geodésico, dado por:
ÍS “ / “ 73,Bree	(4.19)
onde lembramos que Brec é o elemento estruturante primitivo utilizado na reconstrução (e que determina a vizinhança utilizada), que pode ser inclusive o próprio B.
E fácil ver que o top-hat geodésico produz justamente os componentes conexos que somem após a erosão pelo elemento estruturante B. O resultado obtido a cada passo com o top-hat geodésico deve ser então acumulado e utilizado como máscara na erosão condicional. Após um certo número finito de iterações 5 a imagem de entrada se iguala à máscara, não havendo mais modificação por meio de erosões condicionais subsequentes.
Para sintetizar e talvez esclarecer um pouco mais as idéias acima, apresentamos
a seguir o algoritmo de obtenção do histograma de gargantas em uma pseudo-implmentação.
-	Dados:
•	7,-, Imagem binária de entrada
•	Im, Imagem de trabalho (máscara)
♦	g[ ], Array correspondente à distribuição acumulada 0(s)
♦	h[ ], Array correspondente ao histograma de gargantas A(s)
~ Inicialização:
Inicialize Im com zeros
-	Determinação da distribuição acumulada Í2(s):
Para i +— 0,1,2,...
g[i] max {rot(Zt')}
Se (A = 7m) saia do loop;
Caso contrário, volte ao início do loop
— Determinação do histograma de gargantas A(s):
Para i&amp;lt;— 0,1,2,..., S - 1
h[i] g[i+l] - g[i]
A partir do histograma de gargantas, podemos definir ainda um parâmetro bas-
tante útil, o tamanho médio J das gargantas (segundo o elemento estruturante utilizado), que nada mais é que o valor esperado do histograma de gargantas visto como uma distribuição de probabilidade (lembrando que uma imagem pode ser vista como uma realização
probabilística de um random set):
S
£ «A(«)
5 = —f.------ (4.20)
DW
JJ-0
Como veremos no capítulo seguinte, o histograma de gargantas constitui uma ferramenta de análise muito útil para a caracterização de meios porosos. Sua utilidade porém não se restringe a este tipo de aplicação. No problema da inspeção automática de placas de circuito impresso, por exemplo, uma questão importante é a caracterização dos estreitamentos que ocorrem nas trilhas e também no material isolante, que indicam falhas no processo de manufatura da placa, O histograma de gargantas representa uma contribuição importante a esta área de aplicação, uma vez que fornece uma informação probabilística sobre os estreitamentos, embora não produza informação de natureza espacial, como localização dos estreitamentos.
Consideremos por exemplo a imagem da fig. 4.27, que representa uma imagem típica de uma placa de circuito impresso, já binarizada. O objeto nesta imagem é a parte condutora (as trilhas e as ilhas), enquanto que invertendo a mesma obtemos o material isolante. Utilizando como elemento estruturante primitivo o disco digital bidimensional de raio 1 segundo a métrica do quarteirão (a conhecida “cruz11)? obtivemos os histogramas de garganta correspondentes aos casos do material condutor e isolante, resultado este que pode ser visto na fig. 4.28, e também os tamanhos médios associados, respectivamente 3,514 e 4,903.
4.5	Aspectos de implementação
Encerrando o capítulo, gostaríamos de fazer uma discussão sobre algoritmos utilizados na implementação das ferramentas de análise discutidas.
Além das transformações básicas da Morfologia Matemática apresentadas no capítulo 3, as quais dispõem de implementações razoavelmente simples [23], as ferramentas discutidas neste capítulo fazem uso de algumas transformações que seriam muito ineficientes
Figura 4.27: Imagem binária de placa de circuito impresso
Figura 4.28: Histogramas de gargantas associados à imagem do PCB (a) parte condutora (b) parte isolante
se fossem implementadas a partir da composição de transformações básicas, principalmente no caso tridimensional, que envolve normalmente um volume muito grande de dados. Estas transformações são a determinação de watersheds, a função distancia e a rotulação. Além destas, a abertura e o fechamento por reconstrução, apresentadas no capítulo anterior e também utilizadas por ferramentas deste capítulo, são muito ineficientes para imagens nível-de-cinza, especialmente no caso tridimensional, exigindo também uma implementação específica.
A característica comum a todos os algoritmos adotados para implementar estas transformações é utilizarem uma estrutura de dados chamada fila de espera. Como o próprio nome sugere, trata-se de uma estrutura ordenada e linear, onde os dados são colocados por um lado e retirados pelo outro, conforme é ilustrado na fig. 4.29. A fila de espera é portanto uma estrutura do tipo “primeiro-a-entrar-primeiro-a-sair” (FIFO, First-In-First-Out). As filas de espera podem ser implementadas através de listas encadeadas ou arrays circulares [47, 23].
Fila de espera
Entrada dos dados
Saída dos dados
Figura 4.29: Representação esquemática de uma fila de espera
Ao contrário dos algoritmos ditos paralelos, onde não é utilizado o conceito de varredura ordenada dos voxels, e sequenciais, onde tipicamente são requeridas várias varreduras de todos os voxels da imagem [52], os algoritmos baseados na fila de espera possibilitam implementações muito eficientes onde a ordem em que os voxels são varridos garante que a cada instante sejam considerados os voxels realmente úteis.
Uma grande vantagem dos algoritmos baseados na fila de espera é que a extensão para qualquer número de dimensões é fácil de ser feita, bastando alterar as vizinhanças consideradas, isto é, as possíveis direções em que os elementos da imagem são percorridos. A desvantagem é a grande quantidade de memória requerida, que pode chegar a ser mais de duas vezes o tamanho ocupado pela imagem original, no caso tridimensional.
O algoritmo utilizado para a implementação da determinação dos watersheds, proposto por P. Soille e L. Vincent [48, 54], consiste na idéia da inundação do modelo topográfico associado à imagem (ver seção 4.2). Para tanto, é feita uma ordenação dos voxels do menor para o maior nível de cinza, de modo que sucessivos limiares crescentes da imagem (em correspondência com a idéia da água subindo em uma inundação) possam ser acessados eficientemente. Então são determinadas zonas de influência geodésica com base em limiares anteriores, utilizando para isto a fila de espera. Este algoritmo é bem mais eficiente do que o tradicional (encontrado em [44, 17]), baseado na determinação direta das zonas de influência geodésica via SKIZ.
A transformação de rotulação é também implementada muito facilmente com a fila de espera. A imagem é varrida e a cada vez que um voxel de um componente ainda não visitado é encontrado, é feita uma reconstrução do componente empregando o voxel em questão como marcador, utilizando para isto a fila. Apesar de este ser um esquema de rotulação bastante conhecido [44], a etapa de reconstrução baseada na fila torna o algoritmo muito mais eficiente. Vale resaltar ainda que uma grande quantidade de outros algoritmos de rotulação pode ser encontrada na literatura, dos quais citamos como exemplo os algoritmos em [50] e [51].
Já a função distância é um tema que vem atraindo a atenção de pesquisadores do mundo todo há bastante tempo. Os algoritmos de função distância podem ser divididos naqueles que determinam a função distância euclidiana “verdadeira” e naqueles que calculam aproximações desta, como é o caso das distâncias do quarteirão e do máximo. Neste último caso, algoritmos paralelos e sequenciais bidimensionais foram propostos por G. Borgerfors em [9], o qual se tornou um trabalho clássico sobre o assunto. A abordagem que adotamos para o caso das distâncias do quarteirão e do máximo [52] é baseada entretanto na fila de espera: Primeiro são determinados os voxels que formam a superfície do objeto e em seguida as distâncias são propagadas para o interior do mesmo utilizando a fila. Um algoritmo
similar a este pode ser encontrado em [36]. Já para o cálculo da função distância euclidiana, um algoritmo bidimensional clássico, sequencial, é o de Danielsson [16]. A abordagem que adotamos, proposta por P. Soille [47], é baseada na fila de espera e faz a propagação dos valores de distância utilizando três imagens de trabalho de forma a permitir uma representação vetorial (consumindo assim bastante memória). Uma implementação similar, porém baseada em uma fila de espera hierárquica, foi proposta por C. Gratin [23].
Finalmente, a abertura e fechamento por reconstrução foram implementados utilizando o algoritmo proposto por L. Vincent em [53]. Este algoritmo faz inicialmente duas varreduras sequenciais da imagem dos marcadores, seguida pela propagação dos máximos (resp. mínimos) regionais encontrados (utilizando para isto a fila de espera) para obter a abertura (resp. fechamento). Trata-se pois de um esquema híbrido entre um algoritmo sequencial e um baseado na fila de espera que consegue ser assim muito eficiente.
Capítulo 5
Resultados Experimentais: Caracterização de Meio Poroso
5.1	Introdução
0 estudo de sistemas contendo meios porosos (rochas) é de grande importância em diversas áreas economicamente importantes tais como a petrofísica, engenharia de petróleo, engenharia de reservatórios, análise de solos e cristalografia.
Neste sentido, a caracterização dos meios porosos tem por objetivo a determinação de propriedades físicas do meio — que indiquem por exemplo a possibilidade de extração de petróleo — diretamente a partir da sua estrutura morfológica. Esta técnica possui vantagens em relação a métodos considerados “indiretos”, como a porosimetria a mercúrio (onde os parâmetros de interesse são medidos a partir da intrusão forçada de mercúrio no material), que são em geral imprecisos [35].
A caracterização de meios porosos é usualmente feita a partir da análise de imagens bidimensionais provenientes de cortes seccionais de amostras da rocha em estudo. A extensão para o caso tridimensional é feita normalmente utilizando probabilidade geométrica ou estereologia, também chamada de correção estereométrica, que procura estimar os parâmetros físicos tridimensionais desejados a partir dos dados medidos nos cortes bidimensionais.
Neste capítulo, apresentaremos parâmetros de análise de meio poroso obtidos diretamente de uma amostra experimental tridimensional, sem nenhuma correção estereométrica envolvida. A amostra tridimensional estudada consiste em um objeto aproximadamente cilíndrico de gesso contendo pedaços de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha onde duas fases complementares normalmente existem: a fase sólida, que constitui o material propriamente dito e é representada pelos pedaços de giz, e a fase porosa, que corresponde ao espaço que pode ser invadido por fluidos modificando as propriedades físicas do meio, e que é representada pelo gesso.
Discutiremos todas as etapas envolvidas na reconstrução tridimensional da a-mostra experimental, desde o processo de aquisição até a interpolação para obtenção de volume isotrópico, passando pela etapa de registro das seções seriadas, quando apresentaremos os resultados obtidos pela aplicação do método proposto no capítulo 2 deste trabalho.
Em seguida, utilizaremos as ferramentas de análise tridimensional baseadas na Morfologia Matemática, desenvolvidas no capítulo anterior, para a obtenção de medidas que descrevam a estrutura morfológica da amostra em estudo. Após a apresentação de medidas de caráter geral, é feita a análise granulométrica das fases sólida e porosa, a qual produz interpretações relevantes na determinação de processos de invasão ou drenagem por fluidos, pois fornece informação sobre aspectos morfológicos (tamanho e forma) dos poros e grãos presentes no meio. Em seguida é realizada a análise das gargantas, que constitui um resultado muito útil, pois as gargantas presentes na fase porosa possuem também uma influência importante em processos de invasão ou drenagem, em consequência da oposição que elas representam à passagem de um fluido através do material.
Antes de passar aos resultados discutidos acima, iniciamos o capítulo com uma seção sobre o ambiente computacional utilizado no desenvolvimento deste trabalho, o sistema Khoros, em conjunto com as toolboxes V3DTOOLS e MMACH, discutindo também a nossa participação no desenvolvimento das mesmas.
5.2	Ambiente e Ferramentas Computacionais Utilizados
Nesta seção nos propomos a descrever o ambiente e as ferramentas computacionais que foram utilizados para desenvolver as implementações necessárias e para obter os
resultados apresentados ao longo deste trabalho.
5.2.1	O Sistema Khoros
A plataforma adotada durante todo o desenvolvimento foi o sistema de visualização e processamento de imagens Khoros [37, 40]. Este sistema consiste em um pacote computacional aberto, desenvolvido na Universidade do Novo México e baseado no Unix e no XI1, sistemas por sua vez largamente difundidos. O Khoros tem alcançado enorme popularidade em todo o mundo e vem sendo utilizado nas mais diversas áreas, tais como manipulação e análise de imagens médicas, sensoreamento remoto, visualização científica, reconhecimento de padrões, sistemas de informações geográficas, aplicações de processamento de imagem em geral e até mesmo aplicações como bancos de dados e sistemas de controle.
O sistema Khoros constitui-se basicamente de:
-	Uma coleção de programas principais, subdivididos quanto à utilização em subsistemas e acessíveis tanto através da linha de comando como através de uma linguagem de programação visual chamada cantata [38, 39].
-	Uma biblioteca de funções, que engloba a funcionalidade da maior parte dos programas principais, além de fornecer operações básicas como manipulação de arquivos, gerenciamento de memória, funções matemáticas e outras.
— Um conjunto de ferramentas de suporte ao programador (UIDS, User Interface Deve-lopment System), incluindo geradores automáticos de código e programas interativos para o desenvolvimento e manutenção do sistema.
Os programa principais do Khoros podem ser classificados em vrotinas, que não pressupõem interação com o usuário durante sua execução, e zvrotinas, que são programas que apresentam uma interface gráfica, permitindo ao usuário a utilização do mouse e do teclado para realizar a tarefa desejada. Nesta última classe de programas se enquadra o cantata, que é a interface que implementa a linguagem de programação visual mencionada acima. Os programas do Khoros são representados no cantata como ícones (glyphs, acessíveis através de menus pull-down), e o fluxo de dados é representado por ligações entre os ícones.
Os ícones representam portanto operadores^ que atuam sobre os dados transformando-os. ícones especiais para controle de fluxo de execução também estão disponíveis, possibilitando a implementação de complexos procedimentos utilizando apenas o cantata, não exigindo desta forma conhecimentos nem de linguagens de programação tradicionais, nem do Unix ou Xll. Os ícones e suas interligações são dipostos em uma área de trabalho (workspace), cujo conteúdo pode ser salvo e recuperado posteriormente. Na fig. 5.1 vemos o cantata e um workspace típico.
INPUT S&amp;amp;RCES	CaWHiSIONS
OUTPUT	ARITHMETIC
	flaia.	Cantata Hurkwaca	
IMAGE PROCESSING		SIGNAL PROCESSING)
IHPGE RrtftYSlS		REMOTE t GIS 1
CRNIRTR Visual Programing Ejwírorwwit for the KHLHJS Sosten TO^~mLinÊsj
TOOLBOXES|
Figura 5.1: Cantata e um workspace típico
Pode-se dizer que o cantata é urna das principais razões do sucesso obtido pelo Khoros, entretanto não é seu único ponto forte. Para usuarios mais avançados, que precisam implementar procedimentos mais especializados ou complexos, é oferecida a possibilidade de adicionar programas principais e/ou funções de biblioteca ao conjunto original disponível no Khoros, utilizando para isto a linguagem C ou ainda alguma linguagem shell interpretada do Unix. Ferramentas de geração e manutenção de código e bibliotecas de operações básicas são fornecidas para facilitar e padronizar a criação de novos programas.
Vale ressaltar que neste trabalho utilizamos a versão 1.05 do Khoros, mas já está sendo distribuída a versão 2.0, que incorpora novos conceitos como programação orientada a objeto, ferramentas de gerenciamento de projeto e outros. A filosofia do sistema, delineada nesta seção, permanece porém essencialmente a mesma.
Nas próximas seções, descreveremos duas toolboxes que foram utilizadas neste trabalho, e em cujo desenvolvimento tivemos oportunidade de participar.
5.2.2	A toolbox V3DTOOLS
A toolbox V3DTOOLS é desenvolvida pelo grupo liderado pelo Prof. Dr. Roberto de Alencar Lotufo, orientador deste trabalho, no DCA da Faculdade de Engenharia Elétrica da Unicamp. Ela surgiu inicialmente pela necessidade de adicionar ao Khoros ferramentas de visualização tridimensional aplicadas a imagens médicas [20].
Atualmente, a toolbox V3DTOOLS contém um conjunto razoavelmente completo de programas básicos para a manipulação, análise e visualização de dados volumétricos no Khoros. A única exigência feita é que os dados sejam representados segundo o esquema Voxel, já descrito no capítulo 3 (ver seção 3.2.1). Todos os programas da versão atual da V3DTOOLS são vrotinas. Uma descrição detalhada da toolbox V3DTOOLS pode ser encontrada em [26].
Tivemos a oportunidade de contribuir com programas de manipulação e processamento tridimensional à toolbox V3DTOOLS, os quais citamos a seguir:
-	vinsert3d - Insere, em uma posição especificada, uma sub-imagem 3D em outra imagem 3D.
-	vpad3d - Cria uma “borda” de dimensões e valor arbitrários em volta de uma imagem 3D.
-	vfft3d - Implementa a Transformada de Fourier tridimensional
Além destes, implementamos uma xvrotina chamada markimage. que permite ao usuário selecionar interativamente pontos em uma imagem 3D e depois armazená-los em um arquivo para posterior uso. Em seções seguintes mencionaremos a aplicação desta ferramenta em diferentes etapas deste trabalho.
5.2.3	A toolbox MMACH
A toolbox MMACH [7] contém as ferramentas básicas de processamento e análise de imagens por Morfologia Matemática que foram utilizadas neste trabalho. A MMACH é o resultado do esforço conjunto de grupos pertencentes a USP (Universidade de São Paulo), Unicamp e INPE (Instituto Nacional de Pesquisas Espaciais), liderados respectivamente pelos Proís. Drs. Junior Barrera, Roberto Lotufo e Gerald Banon.
Como foi visto no capítulo 3, os operadores da Morfologia Matemática possuem uma estrutura hierárquica onde transformações complexas são obtidas a partir da combinação de outras cada vez mais simples, até se chegar aos operadores fundamentais, as erosões e dilatações.
Esta estrutura hierárquica dos operadores morfológicos permite a especificação de uma linguagem morfológica (LM) [6], onde uma transformação arbitrária qualquer é expressa através de sentenças onde as palavras são operadores e os conectivos são operações de composição, tais como união e interseção.
Uma máquina morfológica (MMACH) consiste na implementação, em hardware ou software, de uma linguagem formal equivalente à linguagem morfológica [5]. Os programas de uma MMACH correspondem às frases da LM.
As características do sistema Khoros o fazem extremamente apropriado à implementação de uma máquina morfológica, devido à possibilidade de se organizar os programas em uma toolbox e permitir ao usuário a criação de procedimentos complexos e sofisticados a partir destes programas mais básicos. Para isto, pode-se utilizar a linguagem de programação visual Cantata, ou ainda criar um novo programa a partir de chamadas às funções
de biblioteca da toolbox.
A MMACH se encontra dividida em quatro níveis hierárquicos de operadores, além de um nível de ferramentas de uso geral. Damos a conhecer abaixo os programas que fazem parte da MMACH. Algumas das transformações implementadas por estes programas já foram mencionadas em capítulos anteriores ou serão ao longo deste capítulo; as demais podem ser encontradas em [5, 7, 44].
- Ferramentas de uso geral:
•	vstrset - Criação de elementos estruturantes primitivos 3x3
•	viff2str - Conversão de uma imagem do Khoros para elemento estruturante
•	vgdisk - Criação de discos digitais como elementos estruturantes
•	vrotstr - Rotação de elementos estruturantes primitivos
•	vequal - Comparação de igualdade entre duas imagens
•	vwind - Desenha as bordas de uma imagem 2D
•	vless - Comparação “menor ou igual que” entre duas imagens
•	vcastl - Conversão de tipo entre imagens
— Operações básicas:
•	vinf - ínfimo (interseção) de suas imagens
•	vsup - Supremo (união) de duas imagens
•	vxnv - Involução (complementação)
•	vsubm - Subtração
•	vaddm - Adição
•	vthreshad - Limiarização adaptativa
•	vtoggle - “Chaveamento” entre duas imagens
•	vdil - Dilatação por um elemento estruturante
•	vero - Erosão por um elemento estruturante
•	vdist - Função distância
•	vlabelexp - Rotulação de componentes conexos
« vwatersh - Determinação de watersheds
-	Operações de primeiro nível (utilizam apenas uma vez cada operação básica):
•	vadil - Anti-dilatação
•	vaero - Anti-erosão
•	vgradm - Gradiente morfológico
•	vcdil - Dilatação condicional
•	vcero - Erosão condicional
•	vopen - Abertura morfológica
•	vclose - Fechamento morfológico
•	vsupgen - Sup-geradora
•	vinfgen - Inf-geradora
•	vthin - Afinamento
•	vthick - Espessamento
•	vcthin - Afinamento condicional
•	vcthick - Espessamento condicional
•	vminf - ínfimo de múltiplas imagens
•	vmsup - Supremo de múltiplas imagens
-	Operações de segundo nível (utilizam mais de uma vez cada operação básica):
•	vndil - Composição de dilatações
•	vnero - Composição de erosões
•	vncdil - Composição de dilatações condicionais
•	vncero ~ Composição de erosões condicionais
•	vnopen - Composição de aberturas morfológicas
•	vnclose - Composição de fechamentos morfológicos
•	vnocfllt - Filtro alternado sequencial (abertura-fechamento)
•	vncofilt - Filtro alternado sequencial (fechamento*abertura)
•	vnocofilt - Filtro alternado sequencial (abertura-fechamento-abertura)
•	vncocfilt - Filtro alternado sequencial (fechamento-abertura-fechamento)
•	vnthin - Composição de afinamentos
•	vnthick - Composição de espessamentos
•	vncanon - Transformação canônica
•	vncanond - Transformação canônica dual
•	vdilseg - Dilatação por um segmento
•	veroseg - Erosão por um segmento
•	vopenseg - Abertura por um segmento
•	vcloseseg - Fechamento por um segmento
- Operações de terceiro nível (utilizam um número indeterminado de vezes cada ope-ração básica):
•	vopenrec - Abertura por reconstrução
•	vclosrec - Fechamento por reconstrução
•	vcenter - Filtro central
•	vskthin - Esqueleto por afinamento
•	vskthick - Exoesquelto por espessamento
•	vcskthin - Esqueleto condicional por afinamento
•	vcskthick - Exoesquelto condicional por espessamento
•	vskel - Esqueleto morfológico
•	vlastero - Última erosão
•	vbisset - Bissetor condicional
•	vskthinm - Esqueleto por afinamento com múltiplos elementos estruturantes
•	vclohole - Remoção de “buracos”
•	vedgeoff - Remoção de componentes que tocam a borda
•	vhomot - Modificação de homotopia
•	vlocmin - Determinação dos mínimos locais
•	vlocmax - Determinação dos máximos locais
•	vskiz - Esqueleto por zonas de influencia
•	vsmooth - Segmentação binaria suavizante
5.2.3.1	Extensões da MMACH para a Morfología Matemática 3D
Nossa participação no desenvolvimento da MMACH tem se concentrado basicamente na extensão para o caso 3D de seus programas, que originalmente só tratavam imagens bidimensionais. Além disso, por razões de eficiência, até então eram permitidos apenas elementos estruturantes primitivos 3x3, isto é, subconjuntos do quadrado elementar (Vale ressaltar que qualquer erosão ou dilatação bidimensional pode ser expressa respectivamente como composição de erosões ou dilatações por elementos estruturantes primitivos 3 x 3 [5, 55])
A fim de permitir erosões e dilatações 3D, e também possibilitar ao usuário utilizar elementos estruturantes de tamanho maior que 3 x 3, foi adicionado um novo algoritmo às rotinas vero e vdil para tratar estes casos. Além disso, foram criados os programas viff2str e vgdisk (vide descrição acima), que funcionam tanto para o caso 2D como 3D. Devido à estrutura hierárquica dos operadores, praticamente todos os programas do nível 1 em diante passaram a funcionar em 3D com estas modificações (alguns programas, como os de determinação de esqueleto, ainda se encontram em processo de extensão para 3D na USP).
Foi feita também a extensão dos programas vdist, vlabelexp e vwatersh para tratar imagens tridimensionais. Esta tarefa foi facilitada pelo fato da maior parte dos algoritmos utilizados no caso bidimensional serem baseados na fila de espera (ver discussão na seção 4.5 do capítulo anterior). Quanto aos demais programas do nível básico, não foi preciso fazer qualquer alteração, pois estes originalmente já tratavam imagens multi-bandas, que é a mesma representação utilizada para imagens 3D no Khoros.
Como ilustração das toolboxes MMACH e V3DTOOLS, vemos na fig. 5.2 um simples workspace que foi utilizado para gerar as imagens das ftgs. 3,8, 3.9, 3.10 e 3.11 do capítulo 3. As rotinas vzbuff, visnorm e vshad, vistas na fig. 5.2, fazem parte da V3DTOOLS e foram utilizadas para gerar todas as visualizações tridimensionais apresentadas neste trabalho. Note que para gerar as figuras do capítulo 3 citadas acima, o workspace da fig. 5.2 precisa ser executado várias vezes, mudando-se o tipo de disco gerado pelo programa vgdisk e conectando-se em sequência as saídas dos glyphs vero, vdil, vopen e vclose à entrada do glyph vzbuff.
Figura 5.2: Workspace para gerar as visualizações tridimensionais do capítulo 3
A reconstrução volumétrica, também chamada de reconstrução tridimensional, consiste na formação de um conjunto de dados que represente a estrutura tridimensional do objeto em estudo a partir de informações bidimensionais do mesmo. A reconstrução 3D é a etapa que obrigatoriamente antecede as operações de visualização, manipulação e análise tridimensionais.
Dentre as várias técnicas existentes de reconstrução tridimensional [13, 33], u-tilizaremos aquela que é a mais natural no contexto da representação Voxel, que é o empilhamento de seções consecutivas do objeto para formar uma matriz tridimensional que represente a estrutura 3D do objeto. Os principais tópicos que precisam ser levados em conta neste processo são basicamente três:
-	Metodologia de aquisição das seções seriadas.
-	Alinhamento (registro) das seções seriadas.
— Interpolação para obtenção de volume isotrópico.
Nas seções que se seguem abordaremos cada um dos itens acima.
5.3.1	Aquisição das seções seriadas
Como já foi dito, utilizamos como objeto de estudo uma amostra experimental aproximadamente cilíndrica de gesso contendo pedaços de giz de variadas formas e tamanhos. Com isto pretendeu-se modelar uma amostra real de rocha, onde a fase sólida é representada pelos pedaços de giz, e a fase porosa, pelo gesso.
As seções deste objeto foram digitalizadas da seguinte forma: envolveu-se a amostra com papel milimetrado, de forma a permitir, com o uso de uma lixa apropriada, ir se debastando o objeto na direção de seu eixo principal. A intervalos de 2mm, medidos com o auxílio de um papel milimetrado afixado em volta do objeto, a amostra era colocada sobre um scanner e sua base (a seção corrente), digitalizada.
Através do procedimento descrito acima, foram obtidas ao todo 32 seções do objeto. As imagens nível-de-cinza resultantes, de dimensões 256x256, apresentam resolução
Como podemos ver na figura 5.3, as seções se encontram desalinhadas, não só em relação à translação e rotação mas também em relação à escala, diferentemente dos exemplos sintéticos apresentados no capítulo 2. Na seção que se segue, discutiremos a aplicação da técnica apresentada no capítulo 2 para obter o registro das seções seriadas da amostra tridimensional em estudo.
5.3.2	Registro das seções seriadas
Nesta seção apresentaremos os resultados obtidos com a aplicação do método proposto no capítulo 2 ao registro da seções seriadas da amostra experimental em estudo.
0 primeiro problema a ser considerado é o da uniformização de escala, pois devido a um indesejável problema de deriva no hardware de digitalização, constatou-se uma diferença considerável de magnificação entre as seções. Um gráfico da área percentual dos contornos preenchidos de cada seção (ver fig. 2.2 do capítulo 2), que dá uma idéia da variação de escala existente, pode ser visto na fig. 5.4. E interessante observar a diferença acentuada existente entre as seções 15 e 16, devido ao fato da aquisição ter sido feita em dois dias diferentes, a primeira metade do modelo (seções 0 a 15) em um dia, a outra metade (seções 16 a 31), no outro.
Aplicamos a transformação de escala como etapa de pré-processamento, isto é, anteriormente à obtenção dos pontos rotulados, onde os parâmetros de escala são obtidos conforme descrito na seção 2.3.1.2. A metodologia proposta naquela seção produziu uma uniformização de magnificação bastante satisfatória, como pode ser visto no gráfico da fig. 5.5
Após ser feito o pré-processamento para a uniformização da escala, foram selecionados os pontos rotulados sobre as seções e em seguida foram determinadas as transformações de rotação e translação, comparando os resultados obtidos pelo método proposto no capítulo 2 com o método proposto por Merickel em [30].
Os pontos rotulados foram obtidos manualmente, através do uso do programa
Figura 5.3: Algumas seções da amostra experimental utilizada neste trabalho
Figura 5.4: Variação de magnitude nos dados originais
Figura 5.5: Variação de magnitude após a aplicação da transformação de escala
Além do critério do RMS, foi utilizado um critério de similaridade entre as seções registradas, apesar de que, como a única entrada para os métodos de registro são os pontos rotulados, o RMS continua a representar o critério de avaliação mais importante. O critério de similaridade utiliza os contornos preenchidos de duas seções consecutivas Si e S2 (ver hg. 2.2 do capítulo 2), e é dado por:
SIM = 100 x
A(Si0S2) \ a(S!) + a(s2);
(5-1)
onde A(S) denota a área percentual do contorno preenchido S, enquanto que 0 denota a operação lógica OU exclusivo (Note que Sj e S2 são imagens binárias). O critério SIM é portanto percentual, isto é, 0 significa uma situação de registro nulo e 100 indica uma situação de registro total.
Os resultados obtidos, tanto pelo uso de nosso método, proposto no capítulo 2, quanto pelo uso do método de Merickel foram avaliados utilizando o critério do RMS médio e do SIM médio calculados sobre os 31 pares de seções consecutivas do modelo. O resultado obtido pode ser visto nas tabelas 5.1 e 5.2 abaixo.
Número de pontos	R-MS médio	^^médio
2	0.92193	99.1886
3	1.97751	98.9232
4	2.73808	98.8266
5	2.92715	98.7200
Tabela 5.1: Resultados do registro das seções do modelo 3D ~ método proposto
Analisando os resultados das tabelas 5.1 e 5.2, constatamos que o RMS médio, para ambos os métodos, resultou em uma função crescente com o número de pontos, enquanto que o SIM médio apresentou um comportamento decrescente. Lembrando que o
Número de pontos	médio	Sl^médio
2	0.92664	99.1364
3	2.00743	99.0139
4	2.78560	98.8435
5	2.95856	98.6778
Tabela 5.2: Resultados do registro das seções do modelo 3D - método de Merickel
RMS é um critério de erro (quanto menor, melhor) enquanto que o SIM representa um critério de acerto (quanto maior, melhor), concluímos que o melhor resultado em ambos os casos é obtido com apenas dois pontos rotulados, o que pode ser explicado pelo fato de se ter introduzido apenas duas marcas ftduciais, levando assim à obtenção de apenas dois pontos confiáveis, isto é, menos sujeitos a erros operador na seleção manual dos mesmos.
A respeito da comparação entre as duas metodologias, podemos constatar que segundo o RMS médio, o método proposto foi superior ao de Merickel em todos os casos. Já quanto ao critério do SIM médio, há oscilações entre os dois métodos, mas o melhor resultado global (99,1886%) é atingido pelo método proposto para o caso de dois pontos rotulados, caso que apresenta também o melhor resultado quanto ao RMS médio.
Baseado na análise dos resultados feita acima, adotamos então o resultado de registro conseguido pelo nosso método utilizando dois pontos rotulados. Na fig. 5.6 vemos as mesmas seções apresentadas na fig. 5.3 após passarem pelo processo de registro (aplicação das transformações de escala, rotação e translação) utilizando o método proposto.
5.3.3	Interpolação Volumétrica
Para obtermos uma representação 3 D satisfatória do objeto em estudo, que possibilite a visualização e análise tridimensionais do mesmo, o passo seguinte é a interpolação volumétrica das seções registradas.
Este processo consiste em um processamento dos dados de forma a obter um volume is o trópico, isto é, que apresente idealmente a mesma resolução nas três dimensões. Normalmente a resolução entre a seções é menor que a resolução dos pixels que compõem as
Figura 5.6: As seções da fig. 5.3 após aplicada a transformação de registro segundo o método proposto
Da discussão acima, concluímos que sendo e a resolução original entre as seções
e d a resolução dos pixels (isotrópicos) das seções, o número s de seções intermediárias a
serem estimadas é dado por:
(5.2)
onde denotamos por “round” a função que devolve o inteiro mais próximo. Sendo n, o número original de seções, o número n0 de seções obtidas após a interpolação é então dado
por:
na = s x (ni - 1) + n-i
(5.3)
Existem na literatura diversos métodos para a estimação das seções intermediárias. Podemos classificar estes métodos em três categorias principais:
-	Interpolação nível-de-cinza: Este é o método tradicional de interpolação. Consiste na estimação de valores nível-de-cinza para as seções intermediárias a partir dos valores presentes em seções vizinhas [20]. As funções de estimação mais comuns são de ordem 0 (replicação das seções), linear e cúbica.
-	Interpolação nível-de-cinza via FFT: Os métodos tradicionais de interpolação nível-de-cinza podem ser vistos como processos de convolução no domínio espacial. Os métodos de interpolação via FFT obtêm o mesmo resultado no domínio da frequência, se valendo para isto do teorema da convolução [12]. Os tipos de função de estimação utilizados não precisam se limitar aos mencionados no item anterior, resultando assim em uma metodologia bem mais geral.
-	Interpolação baseada em forma: Diferentemente das anteriores, esta técnica se aplica a seções binárias. O tipo de interpolação conseguido porém é mais preciso que a maioria dos métodos de interpolação nível-de-cinza [41, 20] (no momento, não há resultados quanto a comparação com a interpolação pela FFT).
Neste trabalho, escolhemos a interpolação baseada em forma como método de estimação das seções intermediárias. Como a segmentação das seções nível-de-cinza nas fases sólida e porosa é uma etapa que terá de ser considerada mais cedo ou mais tarde, é bem mais eficiente realizá-la diretamente sobre as seções registradas originais, anteriormente à interpolação. Além disso, como já foi dito, a interpolação baseada em forma das seções já segmentadas produz um resultado mais preciso do aquele conseguido com a interpolação do volume nível-de-cinza seguida de segmentação, o que é um aspecto muito importante para a etapa posterior de análise.
Nas seções que se seguem, descreveremos o processo de segmentação utilizado e a interpolação baseada em forma.
5.3.3.1	Segmentação das fases sólida e porosa
Para se obter a segmentação das seções registradas nível-de-cinza da amostra experimental, foi utilizado basicamente um processo de limiarização seguido de filtragem das imagens binárias resultantes. Na fig. 5.7-a vemos uma das seções do modelo, que será utilizada como exemplo para ilustrar as diversas etapas do processo de segmentação descrito nesta seção.
O processo de limiarização não é tão simples quanto possa parecer à primeira vista, devido à dificuldade introduzida pelo papel milimetrado que foi colocado em volta do objeto quando da aquisição (ver seção 5.3.1). Uma limiarização simples produz um resultado indesejável, como pode ser visto na fig. 5.7-b.
A solução é utilizar uma limiarização adaptativa^ implementada pelo programa vthreshad (nível básico da MMACH). A limiarização adaptativa é uma transformação que leva de uma imagem nível-de-cinza em uma imagem binária, mas, diferentemente da limiarização simples, a imagem nível-de-cinza original f é comparada não com valores constantes mas com outras imagens nível-de-cinza fa e /2 (chamadas aqui de “imagens limitantes”):
Vh.hU'l =	€ E | /i(u) &amp;lt;f(u) &amp;lt;/s(u)}	(5.4)
note que se as imagens limitantes forem constantes, a limiarização adaptativa se reduz à limiarização simples.
Figura 5.7: Processo de segmentação das fases sólida e porosa, (a) Seção nível-de-cinza original (b) Resultado indesejável obtido por limiarizaçao simples (c) Imagem limitante (d) Resultado da limiarizaçao adaptativa (e) Filtragem da imagem do item d (fase sólida) (f) Subtração das imagens do itens cee (fase porosa)
No nosso caso, utilizamos um valor constante como limiar superior e uma imagem limitante como limiar inferior, a qual é obtida através de uma limiarização simples para segmentar o fundo seguida de uma pequena dilatação, o que produz a imagem vista na fig. 5.7-c (Note que esta é interpretada como uma imagem nível-de-cinza, onde o preto corresponde ao valor zero e o branco, ao valor 255). O resultado da limiarização adptativa pode ser visto na fig. 5.7-d.
Problemas de ruido, causado principalmente por um fino pó que se depositou sobre as seções do objeto devido ao processo de debastação (ver seção 5.3.1), tornam necessário introduzir também uma filtragem da imagem binária resultante da limiarização adaptativa. Esta filtragem consiste em um fechamento seguido por uma abertura com um pequeno elemento estruturante 3x3, operação implementada pelo programa vncoñlt (segundo nível da MMACH). 0 resultado conseguido, bastante satisfatório, é mostrado na fig. 5.7-e. Esta imagem já corresponde à seção da fase sólida da amostra experimental.
A fase porosa é obtida fazendo a subtração (programa vsubm, nível básico da MMACH) da imagem dos grãos da imagem obtida pela inversão da imagem limitante utilizada na limiarização adaptativa, o que produz o resultado da fig. 5.7-e (note que a imagem limitante passa a ser interpretada neste caso como uma imagem binária).
5.3.3.2	Interpolação baseada em forma
Uma vez que o processo descrito na seção anterior tenha sido aplicado para cada seção registrada da amostra experimental, o passo seguinte é aplicar a interpolação baseada em forma de maneira a obter dois volumes isotrópicos, correspondentes às fases sólida e porosa da amostra experimental.
A interpolação baseada em forma, introduzida por S. Raya e J. Udupa [41], é um esquema de interpolação que pode ser resumido da seguinte forma:
— Encontre a transformada de distância das seções previamente segmentadas.
- Aplique algum esquema de interpolação nível-de-cinza (tradicional ou via FFT) no volume formado pelas seções do item anterior.
A função distância utilizada é diferente daquela definida na seção 4.2.2 do capítulo anterior, pois atribui também valores de distância (negativos) ao fundo da imagem. Dado um objeto A € P(E) temos:
Mu) =&amp;lt;
d(w, Ac)
-d(u, A)
se u € A se u € Ac
(5.5)
Vu € E
A função distância definida acima pode entretanto ser obtida facilmente a partir da definida anteriormente:
/d(A) = fd(A) 4- (-/d(Ac))
(5-6)
Após aplicado um esquema de interpolação nível-de-cinza qualquer, obtém-se um volume Feo volume binário interpolado procurado é dado pelo conjunto de voxels {u | F(u) &gt; 0}.
No nosso caso, utilizando os dados apresentados na seção 5.3.1 e as equações
(5.2)	e (5.3), concluímos que é necessário estimar 6 novas seções entre as seções registradas da amostra experimental, resultando em um volume com 218 seções. Considerando que o espaçamento entre as seções era originalmente de 2mm, a resolução na direção z do volume interpolado passa a ser de aproximadamente 285,714//m, muito próxima portanto da resolução nas direções x e y, de 280/rm (ver seção 5.3.1).
Para ilustrar o efeito da etapa de interpolação volumétrica, apresentamos nas figs. 5.8 e 5.9 visualizações dos volumes correspondentes respectivamente à fase sólida (grãos) e à fase porosa, comparando os resultados conseguidos antes e após a interpolação baseada em forma.
5.4	Atributos de análise para caracterização de meio poroso
Uma vez que os objetos de interesse, as fases sólida e porosa da amostra experimental, se encontram disponíveis após a etapa de reconstrução tridimensional, o passo
Figura 5.8: Visualização da fase sólida (a) antes da interpolação (b) após a interpolação
Figura 5.9: Visualização da fase porosa (a) antes da interpolação (b) após a interpolação
Enumeramos a seguir os atributos que foram considerados neste trabalho, os quais julgamos constituírem um conjunto representativo para uma caracterização da amostra experimental em estudo.
-	Medidas de caráter geral
•	Volume da fase sólida, Vs
•	Volume da fase porosa, Vp
•	Fração em volume dos poros (porosidade), p
•	Área da superfície de interface porosa/sólida, Sps
•	Quantidade de grãos na fase sólida, ns
•	Volume médio do grão,
-	Análise Granulométrica
•	Espectro de padrões morfológico para a fase sólida, Tâm(r)
•	Raio médio do grão segundo a granulometria morfológica,
•	Espectro de padrões geodésico para a fase sólida, F^(r)
•	Raio médio do grão segundo a granulometria geodésica,
•	Espectro de padrões morfológico para a fase porosa, Ppm(r)
•	Raio médio do poro segundo a granulometria morfológica,
-	Análise das Gargantas
•	Histograma de gargantas dos grãos, A5(r)
•	Tamanho médio da garganta do grão,
•	Histograma de gargantas dos poros, Ap(r)
•	Tamanho médio da garganta do poro,
Nas seções seguintes apresentaremos os resultados obtidos para os atributos listados acima.
5.4.1	Medidas de caráter geral
Para o cálculo de volumes, não há maior problema, pois basta contar o número n de voxels pertencentes ao objeto A e multiplicar pelo volume do voxel unitário Vo:
vol(A) = n x Vo	(5.7)
onde Vo pode ser calculado a partir dos valores de resolução nas direções y e z, apresentados na seção 5.3:
Vo = 280pm x 280pm x 285,714pm = 0,0224mm3
Desta forma, obtivemos para os volumes totais das fases sólida e porosa:
Va = 5.106.748 x Vo - 114,391cm3
VP = 3.938.104 x Vo — 88,214cm3
Das medidas acima, obtemos diretamente a porosidade:
V
n =	= o,435
V + vp
Já o cálculo de áreas constitui um problema delicado, pois todo objeto repre-sentável no espaço voxel é necessariamente volumétrico. Uma “superfície” no espaço voxel é portanto apenas uma aproximação de uma superfície real, consistindo na verdade de um objeto tridimensional com espessura de poucos voxels, usualmente apenas um.
Uma possível solução para o problema seria somar as áreas das faces dos voxels pertencentes à “superfície”. Uma solução mais objetiva [32], a qual adotamos, é calcular o volume da “superfície” S e dividir por um parâmetro linear que indique sua espessura:
área(S) = ^¿1	(5.8)
No nosso caso, a superfície de interface entre as fases sólida e porosa é obtida através de uma operação de gradiente morfológico (ver seção 3.3.2). O parâmetro de espessura neste caso é dado pelo diâmetro do elemento estruturante usado (observamos que
vol(rs(S))
e(S)
1.487.190 x Vo
3 x 0,280mm
= 396,584cm2
Para a determinação do número de grãos, é necessário primeiramente fazer a segmentação binaria 3D da fase sólida, a qual se encontra quase totalmente conectada (ver fig. 5.11 na seção seguinte). Para obter a segmentação binária 3D utilizamos os watersheds, conforme apresentado no capítulo anterior (ver seção 4.2.2). A função distancia euclidiana tridimensional é computada e em seguida é feita a mudança de homotopia da mesma, utilizando um conjunto de marcadores 3D.
Na obtenção dos marcadores consideramos duas possibilidades: o método dos “máximos filtrados” e a seleção manual (ver seção 4.2.2). Da mesma forma que ocorreu com o caso bidimensional apresentado no capítulo anterior, os máximos filtrados produziram um resultado subsegmentado, onde os grãos de pequenas dimensões não são separados de seus vizinhos devido à não obtenção de marcadores para eles. Isto não ocorreu na seleção manual, onde é possível fornecer marcadores para todos os grãos.
Entretanto, constatou-se que as fronteiras entre os grãos obtidas com o método dos máximos filtrados foram bem melhor determinadas do que com a seleção manual dos marcadores. Isto ocorre devido à dificuldade em selecionar manualmente pontos em uma imagem tridimensional, pois os dispositivos de interação com o usuário disponíveis atualmente são bidimensionais. Utilizando a ferramenta markimage, foi necessário fazer uma inspeção 2D seção por seção do volume, o que levou a marcadores que nem sempre estavam bem posicionados tridimensionalmente dentro dos grãos, produzindo como consequência fronteiras pobremente localizadas. O método dos máximos filtrados, por outro lado, funciona da mesma forma no caso 3D que no caso 2D, ou na verdade qualquer outra dimensão. O método dos máximos filtrados corresponderia em uma analogia a um operador que possui um dispositivo de interação n~ dimensional, podendo localizar os marcadores perfeitamente na imagem, mas que em compensação é um pouco míope e não enxerga os grãos menores.
= 342 grãos
Com este resultado podemos obter de imediato o último atributo desta seção, o volume médio do grão:
= 0,334cm3
n8
5.4.2	Análise Granulométrica
Nesta seção apresentamos os espectros de padrões associados às fases sólida e porosa da amostra experimental, além dos raios médios correspondentes a estas distribuições, utilizando as granulóme!rias morfológica e geodésica desenvolvidas no capítulo anterior (ver seção 4.3). Utilizaremos como elementos estruturantes os três tipos de discos digitais introduzidos na seção 3.2.3, de maneira a obter diferentes informações de forma, conforme discutido na seção 4.3.2. Como foi mencionado na introdução deste capítulo, a análise granulométrica do meio poroso produz interpretações importantes na determinação de processos de invasão ou drenagem por fluidos, pois fornece informação sobre os aspectos morfológicos (tamanho e forma) dos poros e grãos presentes no meio.
Na flg. 5.10 vemos os espectros de padrões morfológicos Tam(r), associados à fase sólida, utilizando cada um dos discos digitais.
Para computar os espectros de padrões geodésicos, utilizamos a segmentação binária com o uso dos marcadores dos máximos filtrados, conforme vimos na seção anterior. Na fig. 5.11 temos uma visualização da rotulação da fase sólida antes e após a segmentação (note como antes da segmentação a fase sólida se encontra quase totalmente conectada). Na fig. 5.12 vemos então os espectros de padrões geodésicos Pâp(r) obtidos para a fase sólida, variando o tipo de disco digital utilizado.
(a)	(b)
(c)
Figura 5.11: Rotulação com vizinhança 6 da fase sólida (a) antes e (b) após a segmentação binária com o método dos marcadores filtrados
O último caso corresponde aos espectros de padrões morfológicos Fpm(r), associados à fase porosa, os quais podemos ver na hg. 5.13.
Lembramos que o eixo horizontal (raio do disco digital) nos gráficos correspondentes aos espectros de padrões acima é adimensional, isto é, exprime o raio como número de voxels. Já na determinação dos raios médios, os valores adimensionais obtidos através da eq. (4.11) do capítulo anterior são apresentados na tabela 5.3 e ao lado de cada um, entre parênteses, encontra-se o valor em mm obtido pela multiplicação pelo lado médio do voxel (aproximadamente 280/2m) de modo a obter um valor com significado físico em relação à amostra em estudo.
É preciso compreender que os valores expressos na tabela acima são função da métrica associada a cada disco digital. Assim, os raios médios segundo a métrica do máximo são subestimados em relação à métrica euclidiana, enquanto que os raios segundo a métrica do quarteirão são super-estimados, em acordância com as eqs. (3.7)e(3.9)do capítulo 3. Na verdade, o que está em jogo é o conceito de forma, pois não se está limitado ao uso dos discos digitais como elementos estruturantes; utilizando outros tipos de elementos estruturantes,
(a)	(b)
(c)
(a)	(b)
Parâmetro	Disco do quarteirão	Disco euclidiano	Disco do máximo
r99 Tpm	10.514 (2.944) 12.795 (3.583) 7.571 (2.120)	9.053 (2.535) 10.596 (2.967) 6.277 (1.758)	5.794 (1.622) 7.143 (2-000) 4.122 (1-154)
Tabela 5.3: Raios médios segundo os diversos discos digitais utilizados (valores em mm entre parênteses)
em associação com um conceito apropriado de tamanho como aquele apresentado na eq. (4.16) do capítulo anterior, é possível obter espectros de padrões e raios médios associados distintos para cada caso, o que é uma vantagem, pois permite justamente explorar o conceito de forma, como já foi dito antes.
Por fim, observamos que, como era de se esperar em um estudo de uma amostra real, os espectros de padrões apresentaram quase todos um comportamento muito próximo de uma distribuição normal, o que podemos comprovar não só examinando a forma das curvas, mas também comparando os valores adimensionais do raio médio com os valores máximos dos espectros correspondentes, que coincidem bem. A excessão são os espectros geodésicos correspondentes aos discos do quarteirão e euclidiano, o que pode ser explicado por problemas de subsegmentação devido à utilização dos máximos filtrados como marcadores (ver discussão na seção 5.4.1 acima). E interessante comparar este comportamento “normal” com o comportamento multi-modal apresentado pelos espectros de padrões bidimensionais obtidos no capítulo anterior. Esta diferença se explica pelo fato da imagem tomada como exemplo naquele capítulo não representar na realidade um objeto bidimensional real, mas apenas uma seção de um objeto tridimensional, este sim real. Isto ilustra o tipo de dificuldade que os métodos de correção estereométrica enfrentam na estimação dos atributos físicos reais a partir de seções bidimensionais.
5.4.3	Análise das Gargantas
Como dissemos na introdução, a análise da distribuição de gargantas em um meio poroso constitui uma medida muito útil, pois as gargantas presentes na fase porosa possuem uma influência acentuada nos processos de invasão ou drenagem, devido à restrição
que elas representam ao escoamento de um fluido.
Nas hgs. 5.14 e 5.15 vemos os histogramas correspondentes respectivamente às fases sólida e porosa, enquanto que na tabela 5.4 encontram-se os tamanhos médios associados.
Ressaltamos que, embora normalmente os tamanhos médios sejam parâmetros adimensionais (segundo o conceito de tamanho introduzido na seção 4.4 do capítulo anterior), os elementos estruturantes utilizados induzem as métricas do quarteirão e do máximo (ver eqs. (3.28) e (3.29) do capítulo 3), e portanto permitem uma interpretação em termos de raio médio das gargantas, em relação a estas métricas. Desta forma, à maneira da tabela 5.3 na seção anterior, os valores na tabela 5.4 foram multiplicados pelo lado médio do voxel de forma a obter medidas físicas em relação à amostra, sendo este resultado apresentado entre parênteses ao lado do valor original.
Parâmetro	Disco unitário do quarteirão	Disco unitário do máximo
	8.085 (2.264)	4.161 (1.165)
	5.579 (1.562)	2.938 (0.823)
Tabela 5.4: Tamanhos médios segundo os dois elementos estruturantes utilizados (valores em mm entre parênteses)
Notamos que, de maneira similar aos espectros de padrões, os histogramas de gargantas apresentaram um comportamente nitidamente “normal”, não só na forma das curvas, mas também pela proximidade dos valores de tamanho médio em relação aos valores máximos das curvas.
(a)	(b)
Figura 5.14: Histogramas de gargantas associados à fase sólida utilizando como elemento estruturante primitivo disco unitário (a) do quarteirão (b) do máximo
Figura 5.15: Histogramas de gargantas associados à fase porosa utilizando como elemento estruturante primitivo disco unitário (a) do quarteirão (b) do máximo
Capítulo 6
Conclusão
Os métodos tridimensionais para o processamento e análise de imagens constituem de fato uma tecnologia muito útil, pois ao lidar diretamente com a estrutura 3D real dos objetos de interesse é capaz de simplificar e otimizar o trabalho humano em tarefas de quantificação e avaliação de imagens, além de produzir resultados precisos, confiáveis e eficientes.
Procurou-se mostrar neste trabalho o “estado da arte” no campo da reconstrução volumétrica e da análise tridimensional por Morfologia Matemática. Julgamos também que as ferramentas apresentadas, incluindo as granulometrias geodésicas e o histograma de gargantas, contribuições originais deste trabalho, constituem um conjunto eficaz para a aplicação em problemas práticos do mundo real, como o demonstrou a caracterização da amostra experimental porosa realizada.
Uma contrapartida é a grande quantidade de memória e processamento requeridos pelas ferramentas de processamento e análise tridimensionais. A amostra experimental utilizada neste trabalho, por exemplo, constitui-se (após interpolada) de 218 seções nível-de-cinza de dimensões 256x256, como foi visto. Isto corresponde a aproximadamente 14.2 Mb de memória. Algumas ferramentas, como a função distância, os waterhseds e a rotu-lação, exigem representações do tipo short (dois bytes), duplicando o espaço em memória requerido. Além disso, vários algoritmos utilizados na implementação destas ferramentas utilizam imagens internas de trabalho e, como foi comentado no capítulo 4, as filas de espera utilizadas podem chegar a utilizar um espaço de memória duas vezes maior que o ocupado
pela imagem original. 0 resultado de tudo isto é que o espaço de memória em RAM requerido para rodar determinados programas pode atingir facilmente a casa de centenas de Mb. Apesar disto foi possível obter os resultados apresentados neste trabalho, utilizando para isto urna máquina muito poderosa, urna RISO de alto desempenho com 256 Mb de memória RAM, baseada no Centro de Computação da Unicamp.
Uma outra conclusão a que chegamos é sobre a importância do processo de aquisição dos objetos de interesse. E preciso ter um controle muito preciso sobre o método de fatiamento da amostra, selecionando corretamente a distância entre as seções e garantindo tanto quanto possível o paralelismo entre as mesmas. Uma aquisição mal realizada tende a comprometer todo o processo de reconstrução volumétrica, produzindo uma representação tridimensional sem uma perfeita correspondência com o objeto real original, obviamente prejudicando também os resultados obtidos na etapa de análise.
Várias sugestões podem ser feitas para introduzir melhorias neste trabalho e para continuar a linha de pesquisa iniciada. Entre elas destacamos as seguintes:
— Utilizar outros tipos de grids digitais além do cúbico, como os grids hexagonal cilíndrico, cúbico centrado e cúbico de faces centradas [32, 23]. Acreditamos que isto possa levar a melhores resultados, especialmente no caso da segmentação 3D.
-	Implementação de erosões e dilatações utilizando decomposições de elementos estru-turantes [1, 21, 55]. Isto tende a reduzir muitas vezes o tempo de processamento requerido para executar a maior parte das operações da Morfologia Matemática.
— Incorporação do espectro de padrões estatístico, uma proposta surgida muito recen-temente [42] que pode levar a resultados que coplementem os obtidos com o espectro de padrões clássico, utilizado neste trabalho.
-	Podem ser considerados também outros atributos de análise além daqueles que utilizamos. Destacamos por exemplo o “volume livre médio” na fase porosa [14], obtido com o uso da função “estrelada” [44].
BIBLIOGRAFIA
[1]	R. Adams. Radial decomposition of discs and spheres. CVGIP: Graph. Models, and Image Proces., 55(5):325-332, Sep 1993.
[2]	K.S. Arun, T.S. Huang and S.D. Blostein. Least-squares fitting of two 3-D point sets. IEEE Transactions on Pat. Anal. Mach. Intel., PAMI-9(5):698-700, Sep 1987.
[3]	D.H. Ballard and C.M. Brown. Computer Vision. Prentice-Hall, Englewood Cliffs, NJ, 1982.
[4]	G.J.F. Banon and J. Barrera. Decomposition of mappings between complete lattices by mathematical morphology, Part I. General lattices. Signal Processing, 30:299-327, 1993.
[5]	G.J.F. Banon e J. Barrera. Bases da Morfologia Matemática para a Análise de Imagens Binárias. IX Escola de Computação - Recife, PE, 1994.
[6]	J. Barrera and G.J.F. Banon. Expressiveness of the morphological language. In SPIE Vol. 1769 Image Algebra and Morphological Image Processing III, pages 264-275, San Diego, USA, 1992.
[7]	J. Barrera, G.J.F. Banon and R.A. Lotufo. A Mathematical Morphology toolbox for the KHOROS system. Technical Report RT-MAC-9403, Instituto de Matemática e Estatística - Universidade Estadual de São Paulo, São Paulo, SP, Brasil, Jan 1994.
[8]	S. Bencher. Segmentation d’images et morphologic mathématigue. Tese de doutorado - École Nationale Supérieure des Mines de Paris, França, 1990.
[9]	G. Borgefors. Distance transformations in digital images. Computer Vision, Graphics and Image Processing, 34:344-371,1986.
[10]	U.M. Braga Neto and R.A. Lotufo. A new efficient technique for the registration of serial sections. CVGIP: Graph. Models, and Image Proces., December 1994. submetido para publicação.
[11]	U.M. Braga Neto e R.A. Lotufo. Uma técnica computacionalmente eficiente para o registro de seções seriadas. In Anais do SIBGRAPI’9j ~ VII Simpósio Brasileiro de Computação Gráfica e Processamento de Imagens, Curitiba,PR - Brasil, Nov 1994.
[12]	U.M. Braga Neto, A.J.B Vieira and R.A. Lotufo, 3D interpolation in the frequency domain. In Abstracts of the World Congress on Medical Physics and Biomedical Engineering, Rio de Janeiro, Brasil, Aug 1994.
[13]	R.M. Cesar Jr. Reconstrução Tridimensional por Ajuste de Superfícies Paramétricas. Dissertação de mestrado, FEE-UNICAMP, Campinas, 1993.
[14]	J. Chermant, M. Coster, J. Jernot and J. Dupain. Morphological analysis of sintering. Journal of Microscopy, 121(1)189-98, Feb 1981.
[15]	D. Cyganski and J.A. Orr. Applications of tensor theory to object recognition and orientation determination. IEEE Transactions on Pat. Anal. Mach. Intel., PAMI-7(5)1662-673, Sep 1985.
[16]	P.E. Danielsson. Euclidean distance mapping. Computer Graphic and Image Processing, 14:227-248, 1980.
[17]	E.R. Dougherty. An Introduction to Morphological Image Processing. SPIE, 1992.
[18]	S.A. Dudani, K.J. Breeding and R.B. McGhee. Aircraft indentification by moments invariants. IEEE Transactions on Computers, C-26139-45, 1977.
[19]	T.L. Faber and E.M. Stokely. Orientation of 3-D structures in medical images. IEEE Transactions on Pat. Anal. Mach. Intel., 10(5)1626-633, Sep 1988.
[20]	A.X. Falcão. Visualização de Volumes aplicada à Area Médica. Dissertação de mestrado, FEE-UNICAMP, Campinas, 1993.
[21]	P.D. Gader. Separable decompositions and approximations of grayscale morphological templates. CVGIP: Image Understanding, 53(3)1288-296,1991.
[22]	R.C. Gonzalez and R.E. Woods. Digital Image Processing. Addison Wesley Publishing Co., 2nd edition, 1992.
[23]	C. Gratin. De la representation des images au traitment morphologique d’images tri-
✓
dimensionelles. Tese de doutorado - Ecole Nationale Supérieure des Mines de Paris, França, 1993.
[24]	T.Y. Kong and A. Rosenfeld. Digital topology: Introduction and survey. Computer Vision, Graphics and Image Processing, 48(3):357-393, Dec 1989.
[25]	D.G. Luenberger. Linear and Nonlinear Programming. Ad dison-Wesley Publising Co, 1984.
[26]	R. Luppi. Conjunto de Operadores Básicos para Visualização, Manipulação e Análise de dados 3D. Dissertação de mestrado, FEE-UNICAMP, Campinas, 1994.
[27]	M. Mantyla. An Introduction to Solid Modeling. Computer Science Press, 1978.
[28]	P. Maragos. Pattern spectrum and multiscale shape representation. IEEE Transactions on Pat. Anal. Mach. Intel., ll(7):701-716, jul 1989.
[29]	G. Matheron. Random sets and integral geometry. Wiley, New York, 1975.
[30]	M. Merickel. 3D reconstruction: The registration problem. Computer Vision, Graphics and Image Processing, 42:206-219, 1991.
[31]	F. Meyer. Automatic screening of cytological specimens. Computer Vision, Graphics and Image Processing, 35:356-369,1986. Edição especial em morfologia matemática.
[32]	F. Meyer. Mathematical morphology: from two dimensions to three dimensions. Journal of Microscopy, 165(l):5-28, Jan 1992.
[33]	H. Pedrini, L.M. Almeida e Silva e C.L. Tozzi, Avaliação da precisão no processo de reconstrução 3D a partir de seções seriadas. In Annü do SJBGRAPP92 - V Simpósio Brasileiro de Computação Gráfica e Processamento de Imagens, pages 155-161, Aguas de Lindóia,SP - Brasil, Nov 1992.
[34]	A.L. Peressini, F.E. Sullivan and J.J. Uhl. The Mathematics of Nonlinear Programming. Undergraduate Texts in Mathematics - Springer Verlag, 1988, 1988.
[35]	R.A. Pieritz. Desenvolvimento das técnicas do gráfico da linha mediana e da binari-zação por regiões conexas aplicadas à caracterização de meio poroso. Dissertação de mestrado, Programa de pós-graduação em engenharia mecânica, UFSC, Florianópolis,
[36]	J. Piper and E. Grantin. Computing distance transformations in convex and non-convex domains. Pattern Recognition, 20(6):599-615,1987.
[37]	J. Rasure and S, Kubica. The khoros application development environment. Khoral Re searsh Inc., 1993. KHOROS Group - EECE - University of New Mexico - Albuquerque - NM - USA.
[38]	J.R. Rasure, D. Argiro, T. Sauer and C.S. Williams. Visual language and software development environment for image processing. International Journal of Imaging Systems and Tecnology, 2:183-199, August 1990.
[39]	J.R. Rasure and C.S. Williams. An integrated visual language and software development environment. Visual Languages and Computing, 2:217-246,1991.
[40]	J.R. Rasure and M. Young. An open environment for image processing and software development. In 1992 SPIE/IS&amp;amp;T Symposium on Eletronic Imaging Proceedings, volume 1659, Feb 1992.
[41]	S.P. Raya and J.K. Udupa. Shape-based interpolation of multidimensional objects. IEEE Transactions on Medical Images, 9:32-42,1989.
[42]	C.S. Regazzoni, G.L. Foresti and A.N. Venetsanopoulos. Statistical pattern spectrum for binary pattern recognition. In Mathematical Morphology and Its Applications to Image Processing, pages 185-192,1994. eds. J. Serra and P. Soille.
[43]	A. Rosenfeld and A.C. Kak, Digital picture processing. Academic Press, Inc., 2nd edition, 1982.
[44]	J. Serra. Image analysis and mathematical morphology. Academic Press, Inc., 1982.
[45]	J. Serra. Introduction to mathematical morphology. Computer Vision, Graphics and Image Processing, 35:283-305,1986. Edição especial em morfología matemática.
[46]	J. Serra and L. Vincent. Morphological filtering. In EURASIP course: “Median and Morphological Filtering in Image and Signal Processing”, Tampere, Finland, Jun 1989.
[47]	P. Soille. Morphologie Mathématique: du relief à la dimensionalite - algorithmes et methods. Tese de doutorado - Uni ver sité catholique de Louvain, Bélgica, 1992.
[48]	P. Soille and L. Vincent. Determining watersheds in digital pictures via flooding simulations. In SPIE Vol. 1360 Visual Communications and Image Processing, pages 240-250,1990.
[49]	S.R. Sternberg. Grayscale morphology. Computer Vision, Graphics and Image Processing, 35:333-355,1986. Edição especial em morfología matemática.
[50]	L. Thurfjell, E. Bengtsson and B. Nordin. A new three-dimensional connected components labeling algorithm with simultaneous object feature extraction capability. CV-GIP: Graph. Models, and Image Proces., 54(4):357-364, jul 1992.
[51]	J.K. Udupa and V.G. Ajjanagadde. Boundary and object labeling in three-dimensional images. Computer Vision, Graphics and Image Processing, 51:355-369,1990.
[52]	L. Vincent. Algorithmes morphologiques à base de files d’attentte et de lacets. Tese de doutorado - Ecole Nationale Supérieure des Mines de Paris, França, 1990.
[53]	L. Vincent. Morphological grayscale reconstruction in image analysis: Applications and efficients algorithms. IEEE Transactions on Image Processing, 2(2): 176-201, Apr 1993.
[54]	L. Vincent and P. Soille. Watersheds in digital spaces: an efficient algorithm based on immersion simulations. IEEE Transactions on Pat. Anal. Mach. Intel., 13(6):583-598, Jun 1991.
[55]	X. Zhuang and R.M. Haralick. Morphological structuring element decomposition. Computer Vision, Graphics and Image Processing, 35:370-382, 1986. Edição especial em morfología matemática.</field>
	</doc>
</add>