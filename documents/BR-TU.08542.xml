<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08542</field>
		<field name="filename">13384_DISSERTA%c3%87%c3%83O%20Everton%20%20Tozzo.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">« » »
UNIVERSIDADE FEDERAL DE PERNAMBUCO
DEPARTAMENTO DE ENGENHARIA DE PRODUÇÃO
PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA DE PRODUÇÃO
EVERTON TOZZO
A HYBRID MULTI-OBJECTIVE GENETIC ALGORITHM FOR SCHEDULING
HETEROGENEOUS WORKOVER RIGS ON ONSHORE OIL FIELDS
EVERTON TOZZO
Master thesis presented to UFPE for the master's degree attainment as part of the requirements of the Programa de Pós-Graduação em Engenharia de Produção (Concentration Area: Operations Research).
Advisor: Ana Paula Cabral Seixas Costa, DSc.
Catalogação na fonte
Bibliotecária Margareth Malta, CRB-4 / 1198
T757h Tozzo, Everton.
A hybrid multi-objective genetic algorithm for scheduling heterogeneous workover rigs on onshore oil fields / Everton Tozzo. - 2017.
89 folhas, il., gráfs., tabs.
Orientadora: Profa. Dra. Ana Paula Cabral Seixas Costa.
Dissertação (Mestrado) - Universidade Federal de Pernambuco. CTG. Programa de Pós-Graduação em Engenharia de Produção, 2017.
Inclui Referências.
Texto em inglês.
1. Engenharia de Produção. 2. Problema de Sondas de Manutenção. 3. Frota heterogênea. 4. Otimização multiobjetivo. 5. Algoritmo Genético Híbrido. 6. Descida em Vizinhança Variável. I. Costa, Ana Paula Cabral Seixas. (Orientadora). II. Título.
UFPE
UNIVERSIDADE FEDERAL DE PERNAMBUCO
PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA DE PRODUÇÃO
PARECER DA COMISSÃO EXAMINADORA DE DEFESA DE DISSERTAÇÃO DE MESTRADO ACADÊMICO DE
EVERTON TOZZO
“A HYBRID MULTI-OBJECTIVE GENETIC ALGORITHM FOR SCHEDULING HETEROGENEOUS WORKOVER RIGS ON ONSHORE OIL FIELDS”
ÁREA DE CONCENTRAÇÃO: PESQUISA OPERACIONAL
A comissão examinadora composta pelos professores abaixo, sob a presidência do(a) primeiro(a), considera o candidato EVERTON TOZZO, APROVADO.
Recife, 16 de fevereiro de 2017.
Prof. ANA PAULA CABRAL SEIXAS COSTA, Doutora (UFPE)
Prof. ISIS DIDIER LINS, Doutora (UFPE)
Prof. MANOEL AFONSO DE CARVALHO JÚNIOR, PhD (UFPE)
To my parents, Aparecido and Elza.
To my sister and brother-in-law, Ana Paula and Francis.
ACKNOWLEDGEMENTS
À minha irmã e meu cunhado, Ana Paula e Francis, pelo apoio e encorajamento durante as diferentes fases de desenvolvimento deste trabalho. Em especial, agradeço à Francis por compartilhar sua experiência e contribuir com dicas importantes durante a fase de implementação do meu algoritmo.
Aos meus companheiros de mestrado, Caio, Gisele, Patrícia e Thaís, pela convivência e apoio mútuo, seja durante o desenvolvimento das atividades acadêmicas, seja durante nossos momentos de descontração. Tenho um carinho especial por cada um de vocês.
Aos amigos com quem tive a oportunidade de dividir apartamento, Alan, Cesar, Flávia, Lenon, Marcelo e Rafaela, por me acolherem em Recife e tornarem esse processo de adaptação o menos tumultuado possível. Vocês se mostraram uma verdadeira família para mim.
À minha orientadora Ana Paula Cabral, pela confiança depositada, pela transmissão de conhecimentos e experiências durante a elaboração deste trabalho.
À professora Isis Lins, por aceitar o convite para participação dessa dissertação e fornecer contribuições valiosas para o aperfeiçoamento do trabalho.
Ao Programa de Pós-Graduação em Engenharia de Produção da UFPE (PPGEP), pela oportunidade de estudo, pelos conhecimentos transmitidos e estrutura disponibilizada.
Ao CNPq, pelo apoio financeiro durante o desenvolvimento desta pesquisa.
De modo geral, agradeço a todos que acreditaram em mim e que contribuíram, de alguma forma, para que essa dissertação pudesse ser realizada. A todos sou muito grato.
ABSTRACT
Onshore oil fields are composed by a set of geographically distributed wells that, after some time of operation, might present some malfunction and have their production interrupted. When the oil production of some wells is interrupted, specially-equipped vehicles, also called workover rigs, are deployed to service the wells and guarantee that their activity is restored. Given the limited number of workover rigs and the large number of wells around the oil field, the workover rig problem consists in finding the best scheduling for the workover rigs so the total production loss of wells is minimized. The scheduling considers some factors such as the production loss rate of each well, the service level required and the planning time horizon in which the scheduling must be executed. This research presents a hybrid genetic algorithm to solve the multi-objective workover rig problem with a heterogeneous fleet and a finite time horizon. The hybrid genetic algorithm incorporates a variable neighborhood descent heuristic as a local search procedure to increase the convergence speed of the set of solutions. Both objectives of minimization of the production loss and fleet cost associated to the rent of workover rigs are taken in consideration. The fleet is held variable, so a workover rig depot is included at a strategic position on the oil field in order to guarantee that new workover rigs, besides the already existent ones on the oil field, might be included in the scheduling when required. The genetic algorithm was tested on a set of practical-sized instances up to 200 wells, 10 workover rigs and 300 period horizon. Results show a high conflict between the objectives of minimizing the production loss and fleet cost for the workover rig problem, besides important aspects of the solutions obtained by the proposed algorithm to solve the problem.
Keywords: Workover Rig Problem. Heterogeneous fleet. Multi-objective optimization. Hybrid Genetic Algorithm. Variable Neighborhood Descent.
RESUMO
Campos de produção de petróleo terrestres são compostos por um conjunto de poços de petróleo que, depois de certo tempo em operação, podem apresentar algum tipo de mau funcionamento e ter a produção interrompida. Quando isso ocorre, veículos especialmente equipados, também chamados sondas de manutenção, são utilizados para prestação de serviço nos poços e garantir que suas atividades sejam reestabelecidas. Dado um número limitado de sondas de manutenção e a grande quantidade de poços existentes no campo de petróleo, o problema das sondas de manutenção consiste em encontrar o melhor escalonamento para as mesmas de modo que a perda de produção total dos poços seja minimizada. O escalonamento dos poços considera alguns fatores como a taxa de perda de produção por poço, o nível de atendimento requerido e o horizonte de planejamento para o qual o escalonamento será executado. Este trabalho apresenta um algoritmo genético híbrido para a resolução do problema de sondas de manutenção com múltiplos objetivos, frota heterogênea e horizonte de planejamento finito. O algoritmo genético híbrido incorpora uma heurística de descida em vizinhança variável como método de busca local para aumentar a velocidade de convergência do conjunto de soluções. São considerados os objetivos de minimização da perda de produção e custo com frota associado ao aluguel das sondas de manutenção. A frota é mantida variável, portanto um depósito de sondas é incluído em uma posição estratégica no campo de produção de petróleo para garantir que as novas sondas de manutenção, além das já espalhadas no campo, possam ser incluídas no escalonamento quando requeridas. O algoritmo genético foi testado em um conjunto de instâncias com até 200 poços, 10 sondas de manutenção e horizonte de planejamento igual a 300. Os resultados demonstram um alto conflito entre os objetivos de minimização da perda de produção e o custo da frota para o problema das sondas de manutenção, além de importantes aspectos relacionados às soluções obtidas pelo algoritmo proposto aplicado ao problema.
Palavras-chave: Problema de Sondas de Manutenção. Frota heterogênea. Otimização multiobjetivo. Algoritmo Genético Híbrido. Descida em Vizinhança Variável.
FIGURE LIST
Figure 4.1	- Proposed hybrid genetic algorithm structure.............................43
Figure 4.2	- Chromosome representation..............................................44
Figure 4.3	- Creation of an individual by the Optimized Constructive Heuristic (OCH).46
Figure 4.4	- Pseudocode for the Optimized Constructive Heuristic (OCH)..............46
Figure 4.5	- Pseudocode for the Insertion Constructive Method (ICM)..................48
Figure 4.6	- Pareto ranking representation for the WRP..............................49
Figure 4.7	- Representation of the Best Cost-Longest Route Crossover (BCLRC)........51
Figure 4.8	- Pseudocode for the Best Cost-Longest Route Crossover (BCLRC)............52
Figure 4.9	- Representation of the Rig Reduction Operator (RRO).....................54
Figure 4.10	- Pseudocode for the	Insertion method...................................55
Figure 4.11	- Pseudocode for the	Swap method........................................56
Figure 4.12	- Pseudocode for the	ShortestPath method................................58
Figure 4.13	- Pseudocode for the	InsertionSR method.................................59
Figure 4.14	- Pseudocode for the	Variable Neighborhood Descent (VND)................60
Figure 5.1	- Initial configuration of the WRP instances for each time horizon........65
Figure 5.2	- Representation of the exact problem....................................66
Figure 5.3	- Exact Pareto front and results obtained by the GA when T = 200..........68
Figure 5.4	- Exact Pareto front and results obtained by the GA when T = 300.........68
TABLE LIST
Table 3.1 - Synthesis of previous WRP work - Part 1.......................................41
Table 3.2 - Synthesis of previous WRP work - Part 2.......................................42
Table 5.1 - Parameters for the set of wells of the exact problem..........................66
Table 5.2 - Parameters for the set of rigs of the exact problem...........................67
Table 5.3 -	Pareto front data and extreme individuals of instances with T = 200 - Part 1.75
Table 5.4 -	Pareto front data and extreme individuals of instances with T = 200 - Part 2.76
Table 5.5 -	Pareto front data and extreme individuals of instances with T = 300 - Part 1.77
Table 5.6 -	Pareto front data and extreme individuals of instances with T = 300 - Part 2.78
Table 5.7 -Pareto front size descriptive statistics for 30 executions of some instances..81
Table 5.8 - Mean execution time of the proposed GA........................................81
LIST OF CONTENT
1	INTRODUCTION.......................................................12
1.1	Opening Remarks....................................................12
1.2	Justification......................................................13
1.3	Objectives.........................................................15
1.3.1	General Obj ective.................................................15
1.3.2	Specific Objectives................................................15
1.4	Research Method....................................................16
1.5	Dissertation Structure.............................................16
2	THEORETICAL BACKGROUND.............................................18
2.1	Multi-objective Optimization.......................................18
2.2	Variable Neighborhood Descent (VND)................................19
2.3	Genetic Algorithm (GA).............................................21
2.3.1	Multi-Objective Genetic Algorithm..................................23
2.3.2	Hybrid Genetic Algorithm...........................................23
3	THE WORKOVER RIG PROBLEM (WRP).....................................24
3.1	General Description................................................24
3.2	Characteristics of the WRP.........................................26
3.2.1	Problem Objectives.................................................26
3.2.2	Variable or Fixed Fleet............................................27
3.2.3	Homogeneous or Heterogeneous Fleet.................................27
3.2.4	Existence of Time Window...........................................28
3.2.5	Planning Horizon...................................................28
3.3	Approaches to the WRP .............................................29
3.4	Mathematical Formulation ..........................................31
3.5	Methods and Solutions to the WRP.................................32
3.6	A Proposal of a Multi-Objective WRP..............................35
3.6.1	Prioritization of Objectives.....................................37
3.6.2	Mathematical Formulation for the Multi-Objective WRP.............37
4	THE HYBRID MULTI-OBJECTIVE GENETIC ALGORITHM.....................43
4.1	Chromosome Representation........................................44
4.2	Initial Population...............................................45
4.3	Pareto Ranking...................................................48
4.4	Tournament Selection.............................................50
4.5	Crossover Operator...............................................50
4.6	Mutation Operators...............................................53
4.7	Local Search Procedure...........................................54
4.7.1	Insertion Method.................................................55
4.7.2	Swap Method......................................................56
4.7.3	ShortestService Method...........................................57
4.7.4	InsertionSR Method...............................................59
4.7.5	Variable Neighborhood Descent (VND)..............................60
4.8	Population Update................................................61
5	COMPUTATIONAL EXPERIMENTS........................................62
5.1	Problem Instances ...............................................62
5.2	Comparison with an Exact Solution................................65
5.3	Case Study for an Instance of the WRP............................69
5.4	Experimental Results.............................................74
5.5	Results Discussion...............................................82
6	CONCLUSION.......................................................84
REFERENCES.............................................................86
1	INTRODUCTION
This chapter presents a general view of the workover rig problem, its importance and the proposition a new method to solve the problem based on a multi-objective approach. The research method used in this work and a brief description of the following chapters are also presented.
1.1	Opening Remarks
Since its discovery, oil has become one of the most important natural resources, with an enormous impact on the development of the global economy, not only by being the main energy source of our era, but also due its large use as industrial raw material to manufacture many products such as plastics, pharmaceutical drugs, cosmetics, lubricants, cleaning products, etc. This growing demand leads to an intense extraction process, where an efficient maintenance is required in order to keep the system working (MONEMI et al., 2015).
Many land (onshore) oil fields are formed by a set of wells geographically distributed to the best extraction of oil. Throughout the productive life of onshore wells, the system is subject to dysfunctions and sometimes the production has to be stopped. In this case, an intervention inside the wells is usually necessary in order to ensure operations. These interventions (also called workovers) require the use of workover rigs, big structures transported by trucks that can be dismounted and mounted from one well to another. Several types of maintenance might be performed by the workover rigs: cleaning, reinstatement or substitution of production equipment, stimulation of reservoir, besides others (BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016; MONEMI et al., 2015).
According to Ribeiro et al. (2014), in large oil fields, many wells require maintenance at the same time, so oil companies need more than one rig to service the wells as soon as possible. However, the rent of workover rigs is very expensive and so is the cost of having them available in standby mode. Thus, as a strategy to contain expenses, companies usually own relatively few workover rigs compared with the number of wells that need interventions. Consequently, an immediate allocation of a rig to a maintenance request is not possible, resulting in a queue of wells waiting for service.
are slow mobile units, moving at a speed of 12 mph. Consequently, the time to go from one well to another is an important factor to be considered while scheduling the workover rigs (ALOISE et al., 2006; BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016).
Because of these characteristics, the decision of the operation of each available rig must be carefully planned to establish a practical and efficient schedule. The problem of determining the sequence of wells to be served by each rig is called the workover rig problem (WRP), which is going to be approached in a multi-objective way during the development of this work.
1.2	Justification
During the oil field development and production phases, some of the most important and expensive activities are related to the use of rigs. The rigs are necessary for drilling wells and maintenance activities in order to maintain or even increase productivity. As rigs are very expensive assets, they become the dominant component in drilling expenses, representing rates of up to US$ 600,000 per day (BASSI, FERREIRA FILHO &amp;amp; BAHIENSE, 2012; OSMUNDSEN, ROLL &amp;amp; TVETERAS 2010). Aloise et al. (2006) affirm that the yearly rental cost of 10 rigs is around US$ 10,000,000 for Petrobras, a Brazilian multinational energy corporation. Hence, evaluating aspects of rig productivity, including renting and the efficient planning of their use, is of great importance for petroleum companies.
Trying to find an optimal solution for the WRP is an important issue from both financial and environmental point of views since, besides good productivity, regular maintenance services prevent many accidents on onshore and offshore wells (DUHAMEL, SANTOS &amp;amp; GUEDES, 2012). As presented by Aloise et al. (2006), for a medium-sized oil field in Brazil, the use of an optimization technique leaded to an annual oil economy of over US$ 2,500,000 to Petrobras. Thus, there is room for substantial savings by the appliance of efficient schedule optimization methods.
The recent work of Bissoli, Chaves &amp;amp; Ribeiro (2016) presents new trends for the WRP based on the analysis of the interaction between the WRP and the vehicle routing problem (VRP). The purpose of the authors is to expand the WRP research and bring the problem closer to the real situation of many oil fields. One of the new trends emphasized by the authors is to consider the WRP in a multi-objective approach, where more than one scheduling objective is chosen for optimization.
In general, the WRP approaches just one objective, which is usually associated with the minimization of production loss, what causes major impact in the solution cost. In practical cases, many other aspects, such as load balancing or workload can be taken into account. These objectives are usually conflicting with each other, when it is necessary to identify the existence of a tradeoff to find the best solution (BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016).
Due to the high rental cost of workover rigs, a multi-objective approach that considers the amount of rigs and the total production loss is useful to analyze the tradeoff between the rent of a new workover rig and the savings on the total production loss of the set of wells on the oil field (BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016). Since this work copes with the scheduling of a heterogeneous fleet, the equipment rent cost is a more efficient fleet measure than just the number of scheduled vehicles. It occurs because the same number of vehicles of two different sets of workover rigs might represent different fleet cost due to different service levels offered by the rigs.
A variety of mathematical programming techniques currently exist to solve multiobjective optimization problems, but real world problems appear to be too complex to be solved by conventional optimization methods. Thus, heuristics methods have been introduced to solve these problems (Hu et al., 2016). Specifically, genetic algorithm has received considerable attention as a novel approach to multi-objective optimization problems, what resulted in a fresh amount of research and applications known as Evolutionary Multiobjective Optimization (GEN, CHENG &amp;amp; LIN, 2008).
The basic feature of the GA is its multiple directional and global search by maintaining a population of potential solutions at each generation. This characteristic makes this metaheuristic a well suited and very attractive approach to solve multi-obj ective problems, since it is useful to explore the set of Pareto solutions (FONSECA &amp;amp; FLEMING, 1993; GEN, CHENG &amp;amp; LIN, 2008).
One of the main concerns about GA is the relatively slow evolution speed. Pure GAs have minor individual improvements between populations, so require the execution of many generations to find good solutions. Thereby, a promising approach to improve the convergence speed to better solutions is the incorporation of local search procedures into the GA framework, creating what is called a hybrid genetic algorithm (GAO, SUN &amp;amp; GEN, 2008).
For this work, a hybrid genetic algorithm is applied to solve the workover rig problem with heterogeneous fleet. The hybrid GA uses the VND local search in order to improve the set of individuals after the application of the genetic operators. The VND accelerates the speed of convergence of individuals, so the hybrid genetic algorithm reaches good solutions as soon as the first generations are executed.
1.3	Objectives
1.3.1	General Objective
This dissertation proposes a hybrid multi-objective genetic algorithm with a variable neighborhood descent heuristic to solve the workover rig scheduling problem with heterogeneous fleet and a finite time horizon for the optimization of two objectives, the fleet cost and total production loss.
1.3.2	Specific Objectives
In order to achieve the general objective, some specific targets are defined:
•	Definition of a strategy to incorporate the variability of the fleet size (and consequently, the variability of fleet cost) into the WRP;
•	Definition of the parameters, genetic operators and other procedures related to the metaheuristic chosen for the resolution of the problem;
•	Implementation of the multi-objective genetic algorithm to solve the WRP;
•	Performance of computational experiments with instances found in the literature;
•	Analysis of the results obtained by the genetic algorithm and, whenever possible, perform result comparison with previous literature.
1.4	Research Method
According to the classification presented by Silva &amp;amp; Menezes (2005), the nature of this research is applied, once it aims at the generation of new useful knowledge to practical application during the solution of a specific problem. As it concerns the approach, the research is quantitative, what means that it can be translated in numbers to be classified and analyzed. The study is carried out with the application of resources and statistical techniques to better analyze the results obtained by the implementation of a new algorithm.
The research method proposed is divided into seven steps: literature review, incorporation of variable fleet, definition of parameters and procedures, selection of an implementation strategy, implementation, experimentation and analysis of results. These stages can be detailed as follows:
1.	Literature review: execution of a research through papers aiming to identify previous and actual work related to the WRP and theoretical background necessary to understand relevant characteristics of the problem;
2.	Incorporation of variable fleet: definition of a strategy to incorporate a variable fleet to the WRP, so the problem is adapted for the multi-objective approach where the fleet cost is also an objective to be optimized;
3.	Definition of parameters and procedures: stablish parameters, details and operation procedures for the chosen metaheuristics, which may include local search methods, neighborhood structures, etc.;
4.	Selection of an implementation strategy: definition of the programming language and the implementation strategy (data structure) for the new method;
5.	Implementation: code writing of the new algorithm;
6.	Experimentation: execution of the new algorithm with data found in the literature. The experimentation proposes the exploration of different characteristics of the WRP regarding the number of workover rigs and wells;
7.	Analysis of results: identification of important characteristics of the results and analysis of the execution of the new algorithm.
1.5	Dissertation Structure
methods used in this work for the resolution of the multi-objective WRP. The characteristics of a multi-objective optimization and both genetic algorithm meta-heuristic and variable neighborhood descent framework are described.
Chapter 3 presents the main characteristics of the WRP and their peculiarities due to the different models and restrictions addressed for the problem in the literature. In the end, an adaptation of the WRP to the multi-objective case is presented, regarding the inclusion of a new objective, where the fleet size (and consequently, the fleet cost) is no longer a parameter, but a variable of the problem.
Chapter 4 describes the proposed meta-heuristic to solve the multi-objective WRP, i.e., presents detailed characteristics of the general structure, the methods (genetic operators) and the local search procedure for the implementation of the hybrid genetic algorithm.
Chapter 5 describes the set of instances from the literature and the adjustments necessary in order to adapt them to the characteristics of the multi-objective WRP. The same chapter presents the computational results and an analysis of the data obtained from the experiments in order to highlight the characteristics of multi-objective WRP and the performance of the proposed algorithm. The final considerations are presented in Chapter 6, with the proposition of future work within this research area.
2	THEORETICAL BACKGROUND
This chapter presents the methods used in this work as a new approach to solve the multi-objective WRP. Therefore, the chapter explores the multi-objective optimization process as well as the general genetic algorithm and the variable neighborhood descent framework. An overview of the multi-objective and hybrid genetic algorithm is also presented.
2.1	Multi-objective Optimization
Multi-objective optimization refers to the simultaneous optimization of a problem with two or more objective functions, often presenting trade-offs (MIRJALILI et al., 2016). The problem can be formulated as follows:
min	/(x) = [AW, AW,— , AWT		(2.1)
s.t.		
^¿(x) &gt; 0	i = 1, ...,m	(2.2)
AW = 0	i = 1, —,p	(2.3)
The objective of the problem is to find a vector x* = [xj, x* —&amp;lt;xn] that satisfies the m inequality constraints gi(x), the p equality constraints hi(x) and minimizes the k-dimensional function vector f(x). It is called feasible region Q the set of all values satisfying the constraints. Any point x G it is a feasible solution (ZAVALA et al., 2014).
It is necessary to introduce the concept of Pareto Dominance to determine the solution of a multi-objective optimization problem. Menchaca-Mendez &amp;amp; Coello (2016) define that, for a multi-objective minimization problem, a vector x = [x1,x2, .,xn] dominates vector y = [y1,y2, -^1, denoted by x&gt; y, if and only if /¿(x) &amp;lt;/¿(y) for all i E {1, ...,k} and there exists an i E {1, ...,k} such that fi(x) &amp;lt;fi(y).
A solution x is called Pareto optimal if it is not dominated by any other solution. The set of Pareto optimal (non-dominated) solutions in the feasible region is known in the literature as the Pareto set. When it refers to the decision space, the image of each Pareto optimal solution is called efficient solution. Whereas the Pareto set includes the vectors of values of the decision variables, the Pareto front includes the corresponding vector of values of the objective functions (MAVROTAS, FIGUEIRA &amp;amp; SISKOS, 2015).
Finding the Pareto front is an important step in a multi-obj ective optimization, however it does not stablish a complete order for the solutions of the problem. Hence, there are three different approaches to find a final solution: a priori, interactive and a posteriori. All these approaches are based on the interaction with a decision-maker. In a priori approaches, the decision-maker provides preferences for the different objectives. In the interactive approach, the decision-maker’s choice is made along with the solving process. In a posteriori approach, the set of non-dominated solutions is initially generated, and then the decision-maker chooses the best option based on the analysis of this set of solutions (JOZEFOWIEZ et al., 2008).
This work focuses on finding the Pareto front for the WRP based on the optimization of two objectives, the production loss and fleet cost. The multi-objective optimization does not involve the elicitation of preferences with any decision-maker. On the other hand, the set of non-dominated solutions obtained with the application of the proposed algorithm are the input information for an a posteriori approach.
2.2	Variable Neighborhood Descent (VND)
sequentially explores the neighborhood structures. For each of the neighborhood structures, the algorithm looks for the best neighbor of the current solution. When the neighbor does not show improvement with respect to the solution, the VND executes the next neighborhood structure. Otherwise, in case of improvement, the algorithm updates the solution and returns to the first neighborhood of the sequence. The method is repeated until it does not find improvement for any of the existent neighborhood structures, what means that a local optimum of the solution was found (MARTINS et al., 2012).
The importance of the VND as a local search method is that it is capable of exploring a variety of different solutions throughout the search space due to the appliance of a structured set of neighborhood structures, what makes it a very strong heuristic to solve complex problems (RAHIMIAN, AKARTUNALI &amp;amp; LEVINE, 2016).
The VND is usually applied in order to refine locally the current solution of a problem according to different perspectives of the designed neighborhood structures. Given a set kmax of neighborhood structures Nk (k = 0,1, ...,kmax — 1), let s0 be a current solution for a problem. The pseudocode for the VND procedure is presented in Figure 2.1.
Figure 2.1 - Pseudocode for the Variable Neighborhood Descent (VND) procedure
Begm;
1.	s' = so;
2.	k = 0;
3.	While (k&lt;kmax) do:
4.	Look for the best neighbor s" G Nk from s';
5.	If (cost of solution s" &amp;lt;cost of solution s'):
6.	s'	= s";
7.	k	= 0;
8.	Else:
9.	k	= k +	1;
10.	Return s';
End.
Source: Adapted from Rahimian, Akartunali &amp;amp; Levine (2016)
In line 4 of Figure 2.1, the best neighbor of the current solution s" is found according to a local search method used by the selected neighborhood structure.
2.3	Genetic Algorithm (GA)
Genetic algorithms (GAs) are a family of computational models inspired by evolution (WHITLEY, 1994). It was developed by Holland (1975) and popularized by one of his students, David Goldberg (1989). The algorithm was based on the evolutionism theory declared by the English naturalist and physiologist Charles Darwin in his famous book The Origin of Species with three basic principles: reproduction, natural selection and the diversity of individuals.
Basically, a GA starts with a random set of solutions called population, which usually satisfies all system constraints. Each individual in the population is called chromosome (or individual) and represent a potential solution. Chromosomes are usually represented by a string of symbols which captures the essence of the problem. They evolve through successive iterations (generations) in the population by the application of genetic operators. After several generations, the algorithm converges to the best chromosome, which may represent the optimum or suboptimum solution to the problem (GEN, CHENG &amp;amp; LIN, 2008). The general GA process is represented in Figure 2.2.
For each generation, the algorithm starts with the evaluation of each individual according to the fitness function. The fitness is directly related to the problem goal. It represents the strength of an individual and plays a very important role in the selection process. As occurs in natural selection, the fitter is an individual; the greater are its chances of being selected for reproduction (survival of the fitter). After the selection of individuals, the genetic operators are applied (KARAKATIC &amp;amp; PODGORELEC, 2015).
There are two different genetic operators to generate new solutions: crossover and mutation. The crossover is considered the dominant and most important operator. It is responsible for the recombination of characteristics during reproduction. In general, two chromosomes (parents) are combined together to form new chromosomes, called offsprings. The parents are selected among existing chromosomes in the population with preference towards fitness, so that the offsprings are expected to inherit good genes. The crossover operator must be implemented in such a way that the offsprings inherit characteristics of both parents. By iteratively applying the crossover operator, genes of good chromosomes are expected to appear more frequently in the population, eventually leading to convergence in an overall good solution (KONAK, COIT &amp;amp; SMITH, 2006).
Figure 2.2 - Genetic algorithm framework
Source: Karakatic &amp;amp; Podgorelec (2015, p. 522).
The mutation operator is responsible for introducing random changes into the characteristics of chromosomes. This operator is required for the introduction and maintenance of the genetic diversity of the population by changing one or more components from a selected structure in the chromosomes. The mutation operator is considered secondary, so the mutation rate is very small and depends on the chromosome length (KONAK, COIT &amp;amp; SMITH, 2006).
After the application of the genetic operators, the population is updated, so all remaining individuals represent a new generation. During the update of the population, some strategies may consider or not the total replacement of the former individuals. For the elitist strategy, for example, only the best individuals advance to the new generation.
After the population update, the whole genetic algorithm process is repeated until a defined stopping criterion is reached. When it occurs, the best solution is returned as a result of the execution of the process.
2.3.1	Multi-Objective Genetic Algorithm
Genetic Algorithms have been the most popular heuristic approach to multi-objective design and optimization problems (KONAK, COIT &amp;amp; SMITH, 2006). What is most attractive about these methods is their ability to process enormous parameters spaces, a very important characteristic when the problem deals with multi-objective optimization, and cope with multiple local optima. However, due to the limitation of the population size, usually the multiobjective GA can only achieve a finite set of discrete solutions (HIBBERT, 2003).
Unlike single objective optimization problems, the proximity and diversity of solutions are the goals of multi-objective optimization, which means the convergence to the complete Pareto front of the problem. Thus, the conflicting goals of achieving proximity and diversity in multi-objective GA require the delicate balance of exploration and exploitation throughout the evolutionary search (HU et al., 2016).
2.3.2	Hybrid Genetic Algorithm
Evolutionary methods are widely used in literature to solve the most diverse kind of problems. However, it has been recognized that evolutionary algorithms also have their limitations, both in terms of the systems that can be tackled and the ability to find the optimum. Thus, based on the fact that different types of optimizers have different strengths, the possibility of combining optimizing strategies has become a powerful approach widely used in the literature, creating what is called hybrid methods (HIBBERT, 2003).
For most hybrid methods, the GA usually provides input to a second optimizer: a local optimizer is incorporated into the GA and applied to every child before it is inserted into the population. Thus, whereas the GA is used to perform global exploration among populations, the local search procedure is used to perform exploitation among chromosomes. Based on the fact that the local search uses much of the problem-specific knowledge to improve the solution quality, the hybrid approach often outperforms GA methods operating alone (GAO, SUN &amp;amp; GEN, 2008).
3	THE WORKOVER RIG PROBLEM (WRP)
This chapter presents an overview of the workover rig problem. Initially, a theoretical background of its general characteristics is introduced. Then, the approaches and different models to solve the problem are carried out through a literature review. In the end, a multiobjective version is presented where two objective functions, the fleet cost and the total oil production loss, are to be optimized.
3.1	General Description
The workover rig problem (WRP) takes place on onshore oil fields that contains a set of wells responsible for oil extraction. These wells use complex equipment and artificial lift methods to make oil surface. Occasionally, after some time of operation, equipment may present some malfunction and wells might become less productive or faulty due to different operational factors, which includes flow restrictions, changes in reservoir characteristics, sand production, mechanical failure, among others (DEVOLD, 2013; KHURANA et al., 2003).
Since well productivity is reduced, a request of maintenance describing the type of maintenance necessary and the production loss rate is issued. The maintenance is performed by a specially-equipped vehicle called a workover rig (or just rig) which carries external equipment to perform services such as mud preparation and power generation (RIBEIRO et al., 2014).
It is commonly called workover any type of remediation (maintenance, restoration or productivity increase) applied on a well. Workover activities may include well stimulation but exclude minor repairs and routine maintenance that normally occur while wells are still operational. Thus, all workover interventions imply that well production is going to be suspended (SOARES, 2012). Figure 3.1 shows a workover rig. Figure 3.1 (a) presents a workover rig executing maintenance services and Figure 3.1 (b) illustrates a workover rig being transported.
decide the set of wells to be assigned to each workover rig and the order that maintenances are going to be performed (BASSI, FERREIRA FILHO &amp;amp; BAHIENSE, 2012).
Figure 3.1 - Workover rig being transported and in operation
Source: Duhamel, Santos &amp;amp; Guedes (2012, p. 2945), Aloise et al. (2006, p. 696)
Given the distance between wells and slow rig speed (approximately 12 mph), it is often important to consider the travel time between wells while scheduling the services. It is also important to consider the time to execute maintenance, which mainly depends on service type (completion, reinstatement, cleaning or stimulation) and not much on the type of rig (RIBEIRO et al., 2014).
The WRP consists on finding the best schedule for the existent workover rigs to minimize the total oil loss (due to production interruption) given a set of constraints to be satisfied. These constraints may include that each request has to be addressed within a specified time horizon by at most one workover rig and that each workover rig has to be given a time-feasible schedule (DUHAMEL, SANTOS &amp;amp; GUEDES, 2012).
To exemplify the WRP, Figure 3.2 illustrates an instance with 100 wells and 10 rigs and its optimum solution after the execution of the algorithm proposed by Ribeiro, Desaulniers &amp;amp; Desrosiers (2012). Figure 3.2 (a) represents the geographical location of wells and the initial position of rigs distributed around the oil field. Figure 3.2 (b) shows the solution of the problem with all routes associated with the workover rigs. The number of wells served by each rig is shown in parentheses.
Figure 3.2 - Example of the WRP instance and its optimum solution
Source: Ribeiro, Desaulniers, Desrosiers (2012, p. 3306)
3.2	Characteristics of the WRP
The set of works found in the literature approaches small variances of the WRP due to different characteristics in its mathematical formulation. These characteristics may include the fleet type, existence of time windows, planning time horizon, among others. The different variations of the problem are presented in greater detail in the next topics of this section.
3.2.1	Problem Objectives
Routing and scheduling problems, such as the WRP, usually have just one objective, which is related to the cost of the solution (BISSOLI et al., 2016). For the WRP, the classic objective is to minimize the oil production loss. The production loss of each well is evaluated as its average daily flow rate under regular operation multiplied by the number of days its production was interrupted (ALOISE et al., 2006).
In practical cases, the purpose of solving the problem is not always limited to the minimization of the production loss. Many other factors can be taken into account by adding new objectives and attacking the problem in a multi-objective context. Bissoli et al. (2016) present a list of new objectives that can be added to the WRP:
•	Balancing of rig fleet: it is important to balance the number of wells serviced by each rig in order to avoid overloading of workover teams;
•	Prioritization of wells: in practical cases, some wells must be serviced with priority due to management strategies besides the production loss rates.
The majority of works related to routing or scheduling workover rigs consider a singleobjective approach to reduce production loss (TRINDADE &amp;amp; OCHI, 2005; COSTA &amp;amp; FILHO, 2005; ALOISE et al, 2006; RIBEIRO, MAURI &amp;amp; LORENA, 2011; RIBEIRO, DESAULNIERS &amp;amp; DESROSIERS, 2012; DUHAMEL, SANTOS &amp;amp; GUEDES, 2012; BASSI, FILHO &amp;amp; BAHIENSE, 2012; RIBEIRO et al., 2014; MONEMI et al., 2015). Only Soares (2012) addresses the WRP with more than one objective. The author considers the scheduling problem coupled with the fleet composition problem in order to reduce production loss and fleet cost.
3.2.2	Variable or Fixed Fleet
The WRP may consider the existence of a fixed finite fleet where the set of workover rigs is a parameter of the problem. This is the most common approach found in the literature.
When the fleet is not fixed, the problem might consider either a finite or infinite fleet of workover rigs. In both cases, the problem initially considers the fleet composition, where the number of rigs to perform services is set, for further application of the scheduling process. For the best of our knowledge, Soares (2012) is the first author to approach the composition and scheduling problem using a variable fleet for the WRP.
3.2.3	Homogeneous or Heterogeneous Fleet
In practice, workover rigs can be homogeneous or heterogeneous. As it is specified by Ribeiro et al. (2014), sometimes a rig is not able to perform a specific maintenance service. It happens because rigs are not evenly equipped and only a subset of them may be suitable to serve a specific well request. In this case, when not all rigs are able to perform the maintenance service demanded by a specific well, the fleet is called heterogeneous. On the other hand, when all workover rigs are evenly equipped so that they might perform maintenance service at any well, the fleet is said homogeneous.
Let Qi be the offered service type of rig i = {1, and lj be the required level of well j = {1,...,ri}. For the heterogeneous fleet, a workover rig i can only perform
maintenance at a well j if its service type satisfies q, &gt; lj. In this case, the heterogeneous fleet problem may also be considered as a homogeneous problem if, and only if, the less capable rig is able to serve the most demanding well, i. e., qmin &gt; lmax.
Over time, most authors have tackled the homogeneous WRP (COSTA &amp;amp; FILHO, 2014; TRINDADE &amp;amp; OCHI, 2005; COSTA &amp;amp; FILHO, 2005; NEVES, 2007; RIBEIRO, MAURI &amp;amp; LORENA, 2011; RIBEIRO, LAPORTE &amp;amp; MAURI, 2012). However, more recent works have a greater tendency to approach the problem with heterogeneous fleet, considering its greater complexity and better approximation to the reality of onshore oil fields (ALOISE et al., 2006; RIBEIRO, DESAULNIERS &amp;amp; DESROSIERS, 2012; DUHAMEL, SANTOS &amp;amp; GUEDES, 2012; SOARES, 2012; BASSI, FILHO &amp;amp; BAHIENSE, 2012; RIBEIRO et al., 2014; MONEMI et al., 2015).
3.2.4	Existence of Time Window
Some workover rig problems consider the existence of a time window for each well, which consists in the period of time when the well is available to be served by a workover rig (COSTA &amp;amp; FILHO, 2004; COSTA &amp;amp; FILHO, 2005; NEVES, 2007; RIBEIRO, MAURI &amp;amp; LORENA, 2011; RIBEIRO, LAPORTE &amp;amp; MAURI, 2012). The time window is defined by an earliest and latest feasible service time for each well that needs service on the oil field.
3.2.5	Planning Horizon
For the classic WRP, there is usually no restriction about completion time, what means that rigs can finish their schedule loosely. This problem implies that all wells are able to be scheduled into the existent workover rigs, since there is no limitation about the time for all workovers to be completed.
However, sometimes the planning of rig routes is performed in a rolling horizon fashion, what means that a finite time horizon T is considered, so all workover rigs have to complete their assigned tasks until the end of the defined horizon. The finite horizon T is formed by P time periods, where each time period may correspond to, for example, 2, 6, 12 or 24 hours. When the number of workover rigs is limited, it might not be possible to schedule all wells within the time horizon T, what means that the unserved ones are postponed to the next planning horizon (RIBEIRO et al. , 2014).
As the main objective of the WRP is to minimize production loss or, in other words, to maximize the total oil production, sometimes the strategy to solve the problem may consider the non-scheduling of some wells even if they all could be visited in the specified time horizon (DUHAMEL, SANTOS &amp;amp; GUEDES, 2012).
The use of a finite time horizon is a common approach for the WRP (ALOISE et al., 2006; RIBEIRO, DESAULNIERS &amp;amp; DESROSIERS, 2012; DUHAMEL, SANTOS &amp;amp; GUEDES, 2012; SOARES, 2012; RIBEIRO et al., 2014). The existence of a planning horizon increases the complexity of the problem because the resolution method might also have to decide the set of wells that are not going to be included into the current planning horizon of the problem.
3.3	Approaches to the WRP
The WRP can be considered a vehicle routing problem where a set of vehicles (workover rigs) have to visit known demand nodes (wells) to perform maintenance. Due to different characteristics detected in several oil fields, the WRP has taken some variations during the years, what makes it difficult to present it in a generic approach. However, literature divides WRP into two different groups: scheduling and routing (BISOLI, CHAVES &amp;amp; RIBEIRO, 2016).
Bodin et al. (1983) states that when decisions are related to the spatial configuration of vehicles movements, the WRP is considered as a routing problem, where the main concern is defining the sequence of visits. On the other hand, if time instants to visit each node are taken into account, than the WRP may be classified as a scheduling problem. In most practical cases, both problems merge into the called routing and scheduling problems.
The machine scheduling problem represents a set of tasks (or jobs) that need to be processed by a set of machines. The process of each task consists of a sequence of operations that have to be performed in a given order on a set of specific machines. Each machine can only operate one task at a time. The objective of the problem is to determine the sequence of tasks to be processed in order to optimize a global performance measure of the whole system (MONEMI et al., 2015). The WRP can be seen as a parallel machine scheduling problem where each task (well) needs only one operation which is going to be performed by one machine (workover rig) among the existent ones.
When the WRP is considered a scheduling problem, workovers are performed to service all wells within a planning horizon and with deadlines for the services. Sometimes, these deadlines are replaced by time windows. The fleet type is homogeneous and the distance between wells is not considered (BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016).
As a routing problem, the WRP can be seen as a variant of the Vehicle Routing Problem (VRP) with small differences. Whereas the objective of the VRP is to minimize route length, the WRP is concerned about the minimization of the service time (arriving time plus maintenance time) at wells, in order to reduce production loss. Furthermore, unlike the VRP, which considers all vehicles initially located in the same position (vehicle depot), the WRP considers all workover rigs located in different positions at the beginning of the scheduling (RIBEIRO, LAPORTE &amp;amp; MAURI, 2012).
When the WRP is taken as a routing problem, a planning horizon is considered and a homogeneous or heterogeneous fleet is used. In this case, it is not mandatory to service all wells within the planning horizon. Thus, the unserved wells are postponed to the next planning session together with the new maintenances to be issued in the next period (BISSOLI, CHAVES &amp;amp; RIBEIRO, 2016).
Figure 3.3 summarizes the approaches found in the literature and different characteristics applied to the WRP considered either as a scheduling or routing problem.
Figure 3.3 - Characteristics of different approaches for the WRP
Source: Bisoli, Chaves &amp;amp; Ribeiro (2016, p.16)
3.4	Mathematical Formulation
Formally, the WRP can be represented by a graph G = (V, A) where V is the set of wells requiring maintenance service and A is the set of arcs representing the shortest path
oil production pj and maintenance service duration dj are associated to each well j EV. Once a service is done, the workover rig goes directly to the next well to performance the required services (DUHAMEL, SANTOS &amp;amp; GUEDES, 2012). Furthermore, when the last well is serviced, the workover rig does not have to return to any initial position and may remain at the position where the last service is executed.
For the mathematical formulation of the problem, consider that a rig i = {1, ...,w} of type qt can only perform maintenance in any well j = {1, ...,n} with service level lj &amp;lt;qt. Let y-j be a decision binary variable determining whether well j is the k-th served by rig i and let Xj &gt; 0 be an integer (or real) variable specifying the time the maintenance begins at well j. Aloise et al. (2006) present the following schedule-based formulation for the WRP.
min
n
(3.1)
s.t.
w n
i=1 k=1
(3.2)
n
i=i
n
Vi = 1, ... ,w,Vk = 1, ..., n
(3.3)
n
n
Vi = 1, ..., w,Vk = 1,., n — 1
J = 1
n
Vi = 1, ...,w,
n
(3.4)
&amp;lt;Qi
(3.5)
/	s	n	\ xk &gt; Xj + dj + tJk-	y-h - £ yhk ) x	h=1	h=s+1	/ w Xj &gt; £ e^yk i=1	V(i,k) EA,Vi= 1,		
	Vs = 1, ...,n — 1		(3.6) (3.7)
	Vj = 1, ..	■ ,n	
Xj &gt; 0	Vj = 1, ..	■ ,n	(3.8)
Vij G {0,1}	Vi = 1,.. Vk = 1,.	.,w,Vj = 1, ..,n	(3.9)
The objective function (3.1) is related to the minimization of the loss production while wells are waiting for maintenance. Equation (3.2) states that at most one workover rig is able to perform services at each well. Constraints (3.3) specify that each workover rig services at most one well at a time. Inequalities (3.4) state time continuity, what means that wells are serviced continuously by each rig. Equation (3.5) ensures that the service level required by each wells is guaranteed by the type of rig. Constraints (3.6) specify that if a well k is serviced by a rig i after it has served rig j, then its time xk must be equal or greater than the time Xj of well j plus service time dj and travel time tjk. In Constraints (3.6), M represents a big number. Restriction (3.7) guarantees that if a well j is the first one to get maintenance from a specific rig i, than its time Xj has to be equal or greater the travel time of rig i from its initial position to well j. The variables types are defined on Equations (3.8) and (3.9).
3.5	Methods and Solutions to the WRP
The purpose of this topic is to present a brief literature review of methods and solutions to solve the WRP. The research seeks to demonstrate the main contribution of current works on solving the different approaches of the problem.
neighborhoods as local search procedures in order to disturb the current solution. Computational experiments were executed on eight real-life problems provided by Petrobras. The results demonstrate an average increase of 425 m3 in oil production due to the reduction of losses in 15 days. The authors state that the annual economy with the implementation of the new method is equivalent to the rental of two or three additional workover rigs for Petrobras.
Neves (2007) implements four heuristics to solve the WRP: a traditional GRASP, a GRASP that uses adaptive memory techniques, a Tabu Search and an Iterated Local Search. Due to the nonexistence of previous instances, the author generates instances with 50, 100 and 500 wells and 5 and 10 workover rigs. As the main contribution, the author verified that the performance of the proposed metaheuristics is improved by the use of adaptive memory techniques.
Ribeiro, Mauri &amp;amp; Lorena (2011) present a robust simulated annealing algorithm for the WRP with time windows and planning horizon. Computational tests were performed based on instances presented by Costa &amp;amp; Filho (2004). The experimental results show that the algorithm has provided new best solutions for the literature since it outperformed previous metaheuristics such as GRASP, Genetic Algorithm and Scatter Search with low runtime.
Ribeiro, Desaulniers &amp;amp; Desrosiers (2012) present the first exact algorithm, named branch-price-and-cut (BPC), to solve the WRP with heterogeneous fleet and planning horizon. The authors use the instances provided by Neves (2007) with an adaptation for the heterogeneous case. The performed experiments showed that the proposed BPC algorithm is able to solve practical-sized instances in acceptable computational time.
Ribeiro, Laporte &amp;amp; Mauri (2012) compares the performance of three different metaheuristics on solving the WRP with homogeneous fleet and time windows: an iterated local search, a clustering search and an adaptive large neighborhood search (ALNS). The algorithms were tested on the set of instances proposed by Neves (2007) based on problems arising in Brazilian oil fields. The results show that all metaheuristics, especially ALNS, have outperformed the algorithm of Neves (2007).
instances from the characteristics of a Brazilian onshore oil field. The experiments show good results that represent the strength of the model.
Soares (2012) uses two different approaches for the multi-objective WRP with heterogeneous fleet with the same objectives of this work, the reduction of production loss and fleet cost. In his first approach, the author applies a two-stage algorithm. Initially, the configuration of a two-dimensional packing problem defines the composition of workover rigs to service the wells. After that, an approximate algorithm is used to define the best scheduling of wells into the selected fleet in order to reduce the production loss. In this approach, the existence of a finite time horizon is considered and an ABC curve defines the set of workover rigs to be served during the execution of the current planning time horizon.
In his second approach, Soares (2012) applies a one-stage algorithm by means of the implementation of a multi-objective tabu search. The author uses 25 as an upper bound for the number of available workover rigs. For this approach, the whole set of demanding wells are served during the resolution of the problem.
Bassi, Ferreira Filho &amp;amp; Bahiense (2012) present the first stochastic approach for the WRP with heterogeneous fleet where the service time is assumed to be uncertain. The approached problem deals with an offshore environment, where cost is significantly higher when compared with the onshore case. The authors developed a methodology based on simulation-optimization. Two different strategies were used to implement simulationoptimization methods, one of them based on a greedy algorithm and the other on GRASP. The experimental data was generated according to the reality of a Brazilian basis.
Ribeiro et al. (2014) implement and compare the existing variable neighborhood search implemented by Aloise et al. (2006) with three new different heuristics for the WRP with heterogeneous fleet and finite horizon: a branch-price-and-cut heuristic (BPC), an adaptive large neighborhood search heuristic (ALNS) and a hybrid genetic algorithm (HGA). All algorithms were tested on instances provided by Ribeiro, Desaulniers &amp;amp; Desrosiers (2012). Results show that HGA outperforms the other heuristics on average and in most cases.
with about 200 wells. The authors show that as long as the optimal solution is known, the solution obtained by the algorithm seems to be very close to it.
Table 3.1 and Table 3.2 synthesize the approaches of previous work related to the WRP, according to the most relevant characteristics of the problem. The tables are presented at the end of this chapter.
3.6	A Proposal of a Multi-Objective WRP
As it was presented in the literature review of the previous sections, the majority of works approach the WRP as a single objective combinatorial optimization problem where the only objective is to reduce the total production loss of the set of wells on the oil field that requires maintenance services. For this work, a new approach is presented in order to adapt the characteristics of the WRP from a single objective problem to a multi-objective problem where two objectives, the reduction of the total production loss and the fleet cost, are taken in consideration to find the best scheduling of workover rigs for the wells spread on the oil field.
The reduction of production loss was chosen once it is the most important objective considered since the early studies of the WRP and the only taken into account during the resolution of single objective problems. The reduction of fleet cost is an important objective since companies are concerned with the high cost associated with hiring fleet. Besides these two objectives, the WRP approached in this work holds the following characteristics:
•	Existence of a finite time horizon;
•	No existence of time windows;
•	Heterogeneous fleet.
As occurs in Ribeiro, Desaulniers &amp;amp; Desrosiers (2012), when the WRP deals with a fixed number of workover rigs and a planning time horizon, a set of wells are not able to be serviced within the execution of the optimization problem due to rig unavailability. Thus, the unserved wells have to be postponed to the next planning section together with the new service requests that are going to arise until the next execution of the problem.
As an initial configuration of the standard WRP, a set of workover rigs are already geographically distributed on the oil field near the wells that need intervention service. They have a well-defined initial position which is taken as a parameter of the problem. For this work, this set of workover rigs are called field workover rigs (or just field rigs). The reason they are already spread over the oil field is the execution of services before the beginning of the current planning section of the problem.
The variable number of available workover rigs is guaranteed by the inclusion of a workover rig depot into the initial configurations of the problem. Theoretically, the rig depot (or simply depot) is a warehouse with an infinite number of workover rigs of each service type available for rent. During the resolution of the WRP, the rigs from the depot might also be included as part of the ones that perform services on the existent well on the oil field. The set of workover rigs which are added into the solution of the problem are called depot workover rigs (or simply depot rigs).
The new approach for the WRP considers a prioritization of the already existent workover rigs on the oil field over the depot workover rigs. In order to guarantee the prioritization, the depot workover rigs are only included in a solution when no field rigs are able to perform service in the existent demanding wells. Furthermore, the workover rig depot might be located in a distant and strategic position on the oil field which is far from most of wells. Thus, the traveling time required for a depot rig to perform maintenance at any existent well creates a greater production loss than the production loss if the service was executed by any field workover rig.
In summary, this work considers the WRP with the existence of an infinite number of workover rigs to perform interventions within the planning time horizon at all wells that require services on the oil field. The workover fleet is said heterogeneous, because offers different service levels, and is divided in two different types: a limited number of workover rigs already spread on the oil field (field rigs) and an unlimited number of depot rigs located in a similar position (workover rig depot). Given these characteristics, the objective of the WRP is to reduce two conflicting objectives: the total production loss and the fleet cost of the solution.
3.6.1	Prioritization of Objectives
As it was presented in Section 3.3 of this work, the WRP shares similar characteristics with the vehicle routing problem (VRP). Whereas the main objective explored in the WRP is the reduction of production loss, the main objective explored in the VRP is the reduction of the total traveling distance. Although the multi-objective WRP for the reduction of production loss and fleet cost (or fleet size, for the homogeneous case) is poorly explored in the literature, the objective of minimization of the number of vehicles and total traveling distance often appears on the optimization of the multi-objective VRP (THANGIAH, OSMAN &amp;amp; SUN, 1992; OMBUKI, ROSS &amp;amp; HANSHAR, 2006; GHOSEIRI &amp;amp; GHANNADPOUR, 2010; GARCIA-NAJERA &amp;amp; BULLINARIA, 2011; GHANNADPOUR et al., 2014).
According to Jozefowiez, Semet &amp;amp; Talbi (2008), when the VRP consider both the reduction of traveling distance and the minimization of the number of vehicles, the classical model of the problem treats the two objectives lexicographically, what means that the number of vehicles is given priority. First the number of vehicles is minimized and then the distance traveled is minimized according to that given number of vehicles.
Ghoseiri &amp;amp; Ghannadpour (2010) mention that, for the VRP, most researches clearly prioritize the minimization of number of vehicles. The authors complement that, from a theoretical point of view, it might be impossible to minimize both the number of vehicles and the total traveled distance, because some solutions may minimize the number of vehicles at the expense of distance and others minimizing distance while necessarily increasing the number of vehicles.
Due to the high cost of renting workover rigs and the high conflict between both objectives of reduction of the production loss and fleet cost (as is present in Chapter 5), the approach of the WRP presented in this work gives priority to the number of workover rigs over production loss. Thus, during the resolution of the problem, the reduction of production loss is normally taken into consideration after the composition of the fleet that is going to perform maintenance services.
3.6.2	Mathematical Formulation for the Multi-Objective WRP
heterogeneous workover rigs i = {1,	with different service type t = {1, ...,r} are
available for maintenance service. The set of field rigs is initially located in different positions on the oil field, whereas the set of depot rigs is located at the depot position. After the execution of an intervention, the workover rig goes directly to the next well to performance the required services.
For the new mathematical formulation, the following parameters are considered:
n the number of wells that need service;
tjk	the travel time between two wells j and k;
etj	the travel time of rig i from its initial position to well j;
Pj	the daily oil production of well j;
dj	the maintenance service duration of well j;
lj	the service required level of well j;
q,	the maximum service level rig i is able to provide;
ct the rent cost of a rig with service type t;
T the planning time horizon of the problem.
Given the parameters of the problem, the variables of the optimization problem are defined as follows:
yk	a binary variable determining whether well j is the k-th served by rig i or not;
Xj	an integer variable specifying the time the maintenance begins at well j;
mt	an integer variable specifying the number workover rigs of each service type.
The mathematical formulation presented below is an adaptation of the model proposed by Soares (2012) as a multi-objective approach for the WRP applied on the minimization of the total production loss and the fleet cost of the solution.
min
n
]=1
r
(3.10)
min
ctmt
(3.11)
t=i
s.t.
r
mt&amp;lt;n	(3.12)
t=i
w n
22'	Vj = 1,..	..,n	(3.13)
i=1 k=1			
n			
2 y&amp;lt;1	Vi = 1, ..	,,w,Vk = 1, ...,n	(3.14)
J=1			
n	n			
X-1	Vi = 1,..	.,w, Vk	
2	y!j+' &amp;lt;2 y-j			(3.15)
J=1	J=1		= 1, ...,n- 1	
n			
ij^ytj &amp;lt;Qt	Vi = 1,..	.,w,Vj = 1, ...,n	(3.16)
k=1			
/	s	n	\	V(J,k) e	A,Vi = 1, ...,w,	
xk &gt; xj + dj + tjk-M\2-y y-j - y yj. 1			(3.17)
x	h=1	h=s+1	/	Vs = 1,.	..,n — 1	
w			
Xj &gt; 2 eijy1j	Vj = 1,.	..,n	(3.18)
i=1			
0 &amp;lt;Xj &amp;lt;(T — dj)	Vj = 1,.	..,n	(3.19)
	Vi = 1,..	.,w,Vj = 1, ...,n,	
y*j e {0,1}			(3.20)
	Vk = 1,.	-,n	
xj e l+	Vj = 1, .	■ ,n	(3.21)
mt e 1+	Vt = 1,.	-,r	(3.22)
service level requested by each well is not greater than the rig type. Constraints (3.17) specify that if a well k is serviced after well j by rig i, then the beginning of the maintenance on well k (xk) must be equal or greater than the beginning of the maintenance time on well j plus the service time on well j and travel time tjk between wells. In Constraints (3.17), M represents a big number. Restriction (3.18) guarantees that if a well j is the first one to be serviced from rig i, than the beginning of the maintenance time must be equal or greater the travel time from the rig initial position to the well. Constraints (3.19) guarantee that the planning time horizon is not violated. The variables types are defined on Equations (3.20), (3.21) and (3.22).
Table 3.1 - Synthesis of previous WRP work - Part 1						
Author(s)	WRP characteristics	Type of fleet	Performance objective(s)	Solving method(s)	Data source	Programming language
Costa &amp;amp; Filho (2004)	Existence of time window	Homogeneous	Reduction of production loss	- Maximum priority three criteria heuristic	-	-
Trindade &amp;amp; Ochi (2005)	Standard workover rig problem	Homogeneous	Reduction of production loss	-	A standard version of GRASP; -	A hybrid version of an adaptive memory GRASP that uses a memory to keep some information from the previous iterations.	Artificial data. Number of wells: 50, 100, 200, 300, 400 and 500.	Implemented in C
Costa &amp;amp; Filho (2005)	Existence of time window	Homogeneous	Reduction of production loss	-	Maximum priority three criteria heuristic from Costa &amp;amp; Filho (2004); -	Dynamic assembly heuristic.	Artificial data. Number of wells: 25, 50, 75, 100 and 125. Workover rigs: 2, 4, 6, 8 and 10. Four real instances from Petrobras/ES	Implemented in Delphi
Aloise et al (2006)	Existence of a finite horizon	Heterogeneous	Reduction of production loss	- Variable neighborhood search (VNS)	Eight real instances from Petrobras	Implemented in C
Neves (2007)	Existence of time window	Homogeneous	Reduction of production loss	-	A standard version of GRASP; -	An adaptive memory GRASP; -	A tabu search (TS); -	An iterated local search (ILS)	Artificial data. Number of wells: 50, 100 and 500. Workover rigs: 5 and 10.	Implemented in C++
Ribeiro, Mauri &amp;amp; Lorena (2011)	Existence of time window	Homogeneous	Reduction of production loss	- Simulated Annealing (SA)	Instances from Costa &amp;amp; Filho (2004)	Implemented in C++
Ribeiro, Desaulniers &amp;amp; Desrosiers (2012)	Existence of a finite horizon	Heterogeneous	Reduction of production loss	- Branch-price-and-cut exact algorithm	Adapted instances from Neves (2007) considering heterogeneous fleet.	Gencol software
Table 3.2 - Synthesis of previous WRP work - Part 2						
Author(s)	WRP characteristics	Type of fleet	Performance objective(s)	Solving method(s)	Data source	Programming language
Ribeiro, Laporte &amp;amp; Mauri (2012)	Existence of time window	Homogeneous	Reduction of production loss	-	Clustering neighborhood search algorithm -	Adaptive large neighborhood search heuristic	Instances from Neves (2007)	Implemented in C++
Duhamel, Santos &amp;amp; Guedes (2012)	Existence of a finite horizon	Heterogeneous	Reduction of production loss	-	Adaptation on the schedule-based formulation; -	An open vehicle routing based formulation; -	A set-covering formulation where a column generation strategy is developed.	Artificial data. Number of wells: up to 60 wells. Workover rigs: from 2 to 5.	Compact formulation was developed with OPL studio 6.3 and tested using CPLEX 12 software. Heuristics implemented in C++
Soares (2012)	Two approaches: -	Existence of a finite horizon and; -	Standard workover rig problem	Heterogeneous	Reduction of production loss and fleet cost.	-	A two-stage approximate algorithm; -	A multi-objective tabu search.	-	Adapted instances from Costa &amp;amp; Filho (2004) for the two-stage algorithm; -	Adapted instances from Ribeiro, Desaulniers &amp;amp; Desrosiers (2012) for the tabu search.	-	The two-stage approximate algorithm was implemented in C++ -	The multi-objective tabu search was implemented in C#
Bassi, Filho &amp;amp; Bahiense (2012)	Stochastic approach to the problem, where the service time is assumed being uncertain	Heterogeneous	Reduction of production loss	-	A greedy algorithm; -	A GRASP metaheuristics.	Data was obtained from probability distributions and data generation rules consistent with the reality of well from the Oil Exploration and Production Database (Banco de Dados e Exploração de Produção, BDEP).	Simulations were implemented in Arena and the GRASP heuristics in C++
Ribeiro et al. (2014)	Existence of a finite horizon	Heterogeneous	Reduction of production loss	-	A branch-price-and-cut heuristic; -	An adaptive large neighborhood search heuristic; -	A hybrid genetic algorithm (GA).	Instances from Ribeiro, Desaulniers &amp;amp; Desrosiers (2012) and additional instances involving different numbers of rigs and wells, and different horizon lengths generated in a similar way as Ribeiro, Desaulniers &amp;amp; Desrosiers (2012).	Implemented in C++
Monemi et al. (2015)	Standard workover rig problem	Heterogeneous	Reduction of production loss	- A two stage solution algorithm: a hyper heuristic algorithm in the first phase and a branch, price and cut algorithm in the second phase.	37 instances of perturbed data from Petrobras. Number of workover rigs: from 3 to 12; Wells: from 10 to 200.	Information not available
4	THE HYBRID MULTI-OBJECTIVE GENETIC ALGORITHM
This chapter presents a description of the hybrid genetic algorithm to solve the multiobjective WRP. The set of procedures from the genetic algorithm and the methods used as neighborhood structures by the variable neighborhood search are detailed, so the implementation of the algorithm is fully explained.
The genetic algorithm framework has seven main steps: population initialization, Pareto ranking of individuals, tournament selection, the crossover operator, the mutation operators, the application of the variable neighborhood descent procedure and the population update. The execution of the genetic algorithm is presented in the flowchart of Figure 4.1. All these steps are further detailed in the next topics of this chapter.
Figure 4.1 - Proposed hybrid genetic algorithm structure
Source: This research
The VND is incorporated into the structure of the GA to increase the convergence speed of the algorithm. Whereas the GA performs a global exploration among populations, the VND heuristic performs exploitation around chromosomes. These combined structures create a hybrid algorithm, a more robust and complete procedure for the resolution of the problem.
4.1	Chromosome Representation
The chromosome representation for the GA is given by a vector of integers. For this vector, there are two types of nodes, the positive and negative ones. The positive nodes represent the set of existing wells {1, ...,n} that must be scheduled in the individual. The negative nodes are rig identifiers which represent the beginning of a new route in the chromosome. For a chosen route, the wells are visited according to the sequence they appear in the chromosome.
Figure 4.2 illustrates an individual for a problem of ten (10) wells that are scheduled in three (3) different routes. All workover rigs were highlighted to simplify interpretation.
Figure 4.2 - Chromosome representation
-1	8	3	2	9	-2	4	10	7	5	-5	6	1
Source: This research
An important aspect to be considered about the individual representation is the analysis of its feasibility. An individual, represented by its chromosome, is considered to be feasible if it does not violate any problem constraints. Thereby, for the WRP, an individual is considered feasible if three different requirements are satisfied:
1.	The complete set of n wells requiring maintenance service are scheduled in the individual;
2.	The service type of any rig is not smaller than the service level required by any well scheduled on its route;
3.	The service completion time of each route (rig) is not greater than the time horizon T.
While trying to improve the performance measures of an individual, the proposed GA applies different methods (heuristics, genetic operators and neighborhood structures) which might change the position of wells in the individual, as well as the number of workover rigs that are going to compose the schedule. It is important to emphasize that all of these operators share the common characteristic of generating a feasible solution of the problem. All methods to create and manipulate individuals from the population are presented in the following topics of this section.
4.2	Initial Population
The GA creates the initial population according to two different methods: an Optimized Constructive Heuristic (OCH) and an Insertion Constructive Method (ICM). Whereas the OCH adds some good individuals to the initial population, the ICM adds completely random individuals with the aim of covering the entire search space of the problem. For the initial population, just a fourth of individuals are constructed by the OCH. The other individuals are created by the ICM.
Once the WRP prioritizes the maintenance of wells to be performed by already existing workover rigs on the oil field, for both OCH and ICM, all field rigs are initially included in a random order on each individual. The objective of the random order is to add more variability to the population, since further optimization methods follow the route sequence in the chromosome. At this point, each field rig has no wells assigned to its route yet.
For the execution of the OCH, all wells that need service are randomly ordered. Then, the first ordered well is selected and tested at all possible positions in all existent routes in the chromosome. The well is inserted at the position which generates a feasible individual with the lowest production loss among all feasible positions. This process is repeated until all wells are assigned to the individual. In case that, for a selected well, there is no position on any route that generates a feasible individual, then a new route is created, what means that a depot workover rig is inserted at the end of the chromosome. The created depot rig has a service type that is equal to the service level required by the selected well, which is assigned as the first well in the new route.
Figure 4.3 presents the creation of an individual of the initial population by the OCH for a problem composed by ten (10) wells and two (2) workover rigs already distributed on the oil field. In Figure 4.3 (a), the individual is initially composed by the two workover rigs already distributed on the oil field. After that, the wells are inserted in the chromosome at the best feasible position according to the order imposed by the random well vector, as is shown in Figure 4.3 (b). In Figure 4.3 (c), it is not possible to insert well 1 at any position on the existent routes in order to create a feasible individual. Thereby, a new route is created for a depot workover rig (-3) and added at the end of the chromosome. The offered service type of rig (-3) is the same as the required service level of well 1. After the insertion of the new route, the next wells from the random vector are tried to be inserted at the best feasible positions on both field rigs and depot rigs on the individual. Figure 4.3 (d) presents the final
individual after the insertion of all wells. It was necessary to include a new depot workover rig (-4) on the individual in order to guarantee feasibility.
Figure 4.3 - Creation of an individual by the Optimized Constructive Heuristic (OCH)
Source: This research
Let W be the set of workover rigs on the oil field that needs service, s0 an individual, T the time horizon, la the required service level of well a , qt the offered service type of workover rig i, s0.i. horizon the service completion time of rig i on individual s0 and s0.loss the total production loss of s0. Figure 4.4 presents the pseudocode for the OCH applied in the generation of some individuals from the initial population.
Figure 4.4 - Pseudocode for the Optimized Constructive Heuristic (OCH)
Begin;
1.	Create random vector Z with all wells a eW;
2.	Insert all field rigs at individual s0 randomly;
3.	V receives all rigs that belong to s0;
4.	s' = S0;
5.	For (each well a e Z) do:
6.	bestPosition = 0;
7.	For (each rig i eV) do:
8.	If (la &amp;lt;qt):
9.	For (each position p at rig i) do:
10.	s" = insert well a at position p in s0;
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
End.
If (s''. i. horizon &amp;lt;T and s''. loss &amp;lt;s'. loss):
bestPosition = p; s' = s'';
If (bestPosition	0):
Sq= insert well a at bestPosition in s0;
Else:
Include depot rig j with qj = la in V;
Include new depot rig j in s0; s0= schedule well a at rig j in s0;
Return s0;
Source: This research
For the first two individuals in the population, the OCH is applied with a slight difference that concerns the way the set of wells is ordered for posterior insertion in the chromosome. For the first individual, the set of wells is sorted according to their increasing value of required service level and, for the second individual, the wells are sorted according to their decreasing value of required service level. This method tries to prioritize the type of wells (most or least demanding) that are going to be first inserted into the individual and have greater probability of being assigned to the already existent rigs on the oil field. Once again, this strategy aims to vary the individuals in the initial population.
The second method to create individuals of the initial population is the Insertion Constructive Method (ICM). Whereas the OCH looks for the best position to insert each well in the individual that results in the lowest production loss, the ICM is not concerned about the resulting production loss of the insertion movement, placing the wells at the first feasible position in the individual.
For the execution of the ICM, after inserting all field rigs on each individual with no assigned wells, the set of wells that need service are also randomly ordered. The first well is then selected and tried to be inserted at the first feasible position in the individual. The attempts to insert the well are performed according to existing positions in the individual from the beginning to the end of the chromosome. This process is repeated until all wells are assigned to a route. As occurs in OCH, if there is no feasible position for the selected well on any route in the individual, then a new route is created and its associated depot rig is inserted at the end of the chromosome. The created depot rig has a service type that is equal to the service level required by the selected well, which is the first well assigned in the new route.
Figure 4.5 presents the pseudocode for the ICM, which is applied in order to generate greater diversity for the individuals of the initial population.
Figure 4.5 - Pseudocode for the Insertion Constructive Method (ICM)
Begin;	
1.	Create random vector Z with all wells a eW;
2.	Insert all field rigs at individual s0 randomly;
3.	V receives all rigs that belong to s0;
4.	s' = So;
5.	For (each well a e Z) do:
6.	insert = false;
7.	For (each rig i eV) do:
8.	If (la &amp;lt;Qi):
9.	For (each position p at rig i) do:
10.	s" = insert well a at position p in s';
11.	If (s”. i. horizori &amp;lt;T and s''. loss &amp;lt;s'. loss):
12.	s' = s”;
13.	insert = true;
14.	break;
15.	If(insert):
16.	break;
17.	If (not insert):
18.	Include depot rig j with qj = la in V;
19.	Include new depot rig j in s';
20.	s' = schedule well a at rig j in s';
21.	Return s';
End.	
Source: This research
4.3	Pareto Ranking
Since we are dealing with a multi-objective optimization, all created individuals cannot be directly compared. Thus, a Pareto ranking scheme (GHOSEIRI &amp;amp; GHANNADPOUR, 2010) is incorporated into GA as an attempt to create an order for the individuals in the population.
For the Pareto ranking scheme, each individual in the population is assigned what is called a Pareto rank. The ranks are sequential integer values that represent the layers of stratification in the population obtained via dominance testing. Individuals with rank 1 are
non-dominated and individuals with ranking i. + 1 are dominated by all chromosomes with rank 1 through i.
The Pareto ranking starts with the assignment of ranking 1 for all non-dominated individuals in the population. These chromosomes are removed and the next non-dominated individuals are assigned raking 2. This process is repeated until all individuals in the population are removed and assigned a Pareto rank. Figure 4.6 represents the Pareto ranking scheme for a population of 15 individuals. The population was stratified in three different layers according to the dominance testing.
Figure 4.6 - Pareto ranking representation for the WRP
□ Pareto front 1
+ Pareto front 2
O Pareto front 3
Fleet cost
Source: This research
The Pareto ranking scheme is firstly applied after the initialization of individuals in order to classify the initial population and is constantly repeated at the beginning of each generation, right after the population update. The next step of the GA is to select the parent's chromosomes for the application of the genetic operators. It is important to notice that nondominated individuals (assigned ranking 1) are the most important in the population and receive most attention during the whole execution of GA.
4.4	Tournament Selection
The selection method follows the multi-objective tournament selection used by Ghoseiri &amp;amp; Ghannadpour (2010) in their GA applied to the multi-objective vehicle routing problem with time windows.
In tournament selection, two copies of the population are created and ordered randomly in every generation. For each copy of the population, adjacent chromosomes are compared pair by pair, so the chromosome with the lower rank is selected. If both chromosomes have the same rank, each of them has the same probability of being chosen. The process is repeated until the whole copy of the population is compared and half of the individuals selected.
The tournament process selects half the size of the population from each of the two copies. In this process, superior chromosomes are given priority, but average entities also have chance of being selected. It goes according to the natural selection process, where better adapted individuals are more likely to perpetuate their genetic material through the next generation.
During the tournament process, the individual comparison occurs simultaneously for both copies of the population. Thus, both selected individuals from each copy of the population are paired up as parents for the next step, the crossover operator.
4.5	Crossover Operator
The crossover operator proposed in this work is called Best Cost-Longest Route Crossover (BCLRC). It is based on two methods: the Best Cost Route Crossover (BCRC) proposed by Ombuki, Ross &amp;amp; Hanshar (2006) and the Best Cost-Best Route Crossover (BCBRC) proposed by Ghoseiri &amp;amp; Ghannadpour (2010), both applied to the multi-objective vehicle routing problem with time windows.
For both methods, the crossover selects a route from each parent according to a defined criterion. The BCRC uses a random approach to select the route, whereas the BCBRC selects the best route according to the averaged cost over customers. After that, the customers of the chosen route from the opposite parent are removed. Since each chromosome must contain all customers, the next step reallocates the removed customers into the corresponding offspring. Both BCRC and BCBRC reinsert the removed customers at the best possible location in each offspring in order to minimize the number of vehicles and cost simultaneously, while checking feasibility constraints.
Following the characteristics of the BCRC and BCBRC, the BCLRC uses the same crossover framework, with minor changes, for the WRP. Firstly, the BCLRC choses the longest route of each parent to be removed from the opposite offspring. The longest route here is defined as the one with the greatest number of wells to be serviced. This strategy is chosen to ensure greater variability to the offspring, since a greater number of wells are going to be reallocated in the individual. After that, the BCLRC reinserts the removed wells at the best position in each offspring. In case there is no position that generates a feasible individual while trying to reinsert a well, then a new route is created and a depot rig with service type equal to the service level required by the selected well is inserted at the end of the offspring. The algorithm always verifies if there is any not scheduled field workover rig which satisfies the service required level for the new route before inserting a new depot rig into the chromosome.
Figure 4.7 represents the application of the BCLRC for a problem composed by ten (10) wells and two (2) depot workover rigs. The workover rigs {-1,-2} are the ones already distributed on the oil field. The other workover rigs {-3, -5} are the ones from the depot rig.
Figure 4.7 - Representation of the Best Cost-Longest Route Crossover (BCLRC)
Source: This research
Figure 4.7 (a) represents the creation of the offsprings as identical copies of their respective parents and the identification of the longest route from each parent. It can be seen that parent 1 has two longest routes with the same number of wells. In this case, the first longest route in the chromosome is selected. In Figure 4.7 (b), the wells from the longest route of the opposite parent are removed from the offspring. During this process, if all wells from a certain route are removed, the route might be excluded from the offspring. In order to maintain the scheduling of field rigs and guarantee the preference of field rigs over depot rigs, the route is only excluded if it belongs to a depot rig, as occurs with the workover rig (-5) in offspring 1. Figure 4.7 (c) represents the reinsertion of the removed wells into the feasible position that results in the lowest production loss in the offspring. For both offsprings, all removed wells are reinserted with no need to create a new route in the chromosome.
Figure 4.8 shows the pseudocode for the Best Cost-Longest Route Crossover (BCLRC) applied on the creation of offspring 1. The creation of offspring 2 follows a similar pseudocode as the one presented in Figure 4.8. Therefore, it was omitted for simplification.
Figure 4.8 - Pseudocode for the Best Cost-Longest Route Crossover (BCLRC)
Begin;
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
s0 = parent1;
k = rig with the greatest number of wells from parent2;
Create vector Z;
For (each well a scheduled at rig k in parent2) do:
Remove a from s0;
Add a to Z;
s' = So;
V gets all rigs that belong to s0;
For (each well a e Z) do:
bestPosition = 0;
For (each rig i eV) do:
If (la &amp;lt;Qi):
For (each position p at rig I) do:
s" = insert well a at position p in s0;
If (s".j. horizon &amp;lt;T and s". loss &amp;lt;s'. loss): bestPosition = p; s' = s";
If (bestPosition	0):
s0= insert well a at position p in s0;
Else:
Include new depot rig j in V;
22.	s0= schedule well a at rig j in s0;
23.	Return s0;
End.
Source: This research
4.6	Mutation Operators
After the application of the crossover operator, the resulting offspring may undergo some kind of mutation. The proposed GA applies two types of mutation in order to vary the position of wells in the chromosome and the number of workover rigs scheduled in the individual: the Reallocation Operator (RO) and the Rig Reduction Operator (RRO).
The RO consists in random well reallocation movements. For each well in the chromosome, it is associated a 5% probability of being selected, removed and tried to be reinserted at a random position. When a well is selected, the algorithm tries the reinsertion movement at most five times to create a feasible individual. Thus, after five attempts, the well is considered unable for the reinsertion movement and remains at its original position. This process is repeated for each well until the end of the chromosome.
The next mutation operator, the RRO, is applied with a probability of 5% to reduce the number of workover rigs. The algorithm starts by analyzing if there is any route in the individual with no assigned wells. Whenever it happens, it means that the cost of assigning any well to the empty route is bigger than the cost of maintaining just the other existing routes in the individual. Thereby, all existent empty routes in the individual are eliminated, whether they are depot workover rig routes or field workover rig routes.
After that, the RRO selects and eliminates the route with the smallest number of wells from the individual. For this process, the algorithm only eliminates field workover rig routes if there is no depot rigs scheduled in the individual. Otherwise, it chooses the route with the smallest number of wells among the depot rig ones. Then, the algorithm tries to reinsert the removed wells into the remaining routes in the chromosome. All removed wells are tried to be reinserted at the best feasible positions (i.e., the feasible position which generates the lowest production loss) in the individual. If a removed well is not able to be inserted at any position in the individual, then the whole process is canceled and the mutation operator returns the original individual with no changes.
In Figure 4.9 (a), the RRO scans the whole chromosome looking for empty routes. Since no empty routes are found, the algorithm selects the shortest route in the individual. The routes {-3,-5} have both the shortest number of wells. In this case, the route (-3) is selected because it is the first one to appear in the chromosome. Figure 4.9 (b) represents the chromosome after the shortest route removal and Figure 4.9 (c) shows the reinsertion of the removed wells into the remaining routes. Before the application of the RRO, the chromosome originally had four routes and after the operator it ended with just three routes.
Figure 4.9 - Representation of the Rig Reduction Operator (RRO)
Source: This research
4.7	Local Search Procedure
After the application of the genetic operators (crossover and mutation), the proposed GA uses the VND heuristic as a structured method to improve the offspring at the end of each generation. The VND uses different neighborhood structures as local search methods to improve the current solution. The set of neighborhood structures used by the VND are presented in the next topics of this section and is composed of four complementary methods: Insertion, Swap, ShortestService and InsertionSR. At the end, the whole VND operation is presented and described in details.
4.7.1	Insertion Method
The Insertion method is based on insertion movements, i.e., the removal of a well from its original position and reinsertion at a new position in a different route. All selected wells are tried to be inserted at all possible positions in all existent routes (besides its own) that belong to the individual.
The procedure uses the First Improvement strategy, what means that the insertion movement is always performed when the simulation of a well movement is accepted. The movement is only accepted if it produces a feasible individual and the new production loss is reduced. For the insertion movement, a feasible individual is created if:
1.	The service level of the selected well is not greater than the rig type associated to the new route and;
2.	The service completion time of the new rig is not greater than the time horizon stablished for the problem.
Each time the insertion movement is accepted and, therefore, executed, the search starts the insertion simulation process for the subsequent well in the individual. The search ends when a local optimum is found, i.e., when no longer insertion movement are accepted for any neighborhood.
Let W be the set of workover rigs on the oil field that needs service, s0 an individual, T the time horizon, la the required service level of well a , the offered service type of workover rig i, s0.i. horizon the service completion time of rig i on individual s0 and s0. loss the total production loss of s0. Figure 4.10 presents the pseudocode for the Insertion method.
Figure 4.10 - Pseudocode for the Insertion method
Begin;
1.	S'=S0';
2.	V receives all rigs	that belong to s';
3.	Insertion = True;
4.	While (Insertion)	do:
5.	Insertion = False;
6.	For (each rig i G V) do:
7.	For (each well a scheduled at rig i) do:
8.	For (each rig j G T) do:
9.	If (i*j):
10.	If (la &amp;lt;qj):
11.
12.	For (each position p at rig j) do:
13.	s'' = insert well a at position p in s';
14.	If (s''.j. horizon &amp;lt;T and s''. loss &amp;lt;s'. loss):
15.	s ' = s'';
16.	Insertion = True;
17.	Go to step 7;
Return s ';
End.
Source: This research
4.7.2	Swap Method
The Swap method is based on the swap neighborhood structure, i.e., an exchange movement between two wells that belong to different routes. For this method, all selected wells are tried to exchange position with all existent wells at other routes in the individual.
The method also uses the strategy First Improvement, what means that an exchange of wells is always performed when the swap simulation is accepted. The exchange movement is only accepted if it produces a feasible individual with lower production loss than the original one. During the execution of the swap movement, an individual is considered feasible if the following acceptance requirements are verified:
1.	The service levels of the exchanging wells are not greater than the rig type associated to their new route, and;
2.	The service completion time of the two involved rigs is not greater than the time horizon stablished for the problem.
Each time the swap movement is accepted, the swap simulation process starts at the subsequent well in the individual. When all wells are selected, the search restarts until a local optimum is found, i.e., until no longer swap movement are accepted for any neighborhood. Figure 4.11 presents the pseudocode for the Swap method.
Figure 4.11 - Pseudocode for the Swap method
Begin;
1.	s ' = s0;
2.	V receives all rigs that belong to s';
3.	Swap = True;
4.	While (Swap) do:
5.	Swap = False;
6.	For (each rig i eV) do:
7.	For (each well a scheduled at rig i) do:
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.	Return s';
End.
For (each rig j E F) do:
If (i*j):
If (la &amp;lt;qj):
For (each well b scheduled at rig j) do:
If (lb &amp;lt;qt):
s'' = swap wells a and b in s';
If (s''. i. horizon &amp;lt;T and s''. j. horizon &amp;lt;T): If (s''. loss &amp;lt;s'. loss):
s' = s'';
Swap = True;
Go to step 7;
Source: This research
4.7.3	ShortestService Method
The ShortestService method is based on a well-known heuristic called shortest path, which is usually applied to the vehicle routing problem in order to reduce the vehicle traveled distance (LIN, 1965). The shortest path heuristic rearranges the order of nodes (customers) from a particular route such that the node with the shortest distance is given priority. The first node is chosen based on its distance from the depot of vehicles. Then, the second node is chosen based on its distance from the first node. The process continues until all notes from the original route are re-ordered. The original route is restored if the new re-ordered route is infeasible (GHOSEIRI &amp;amp; GHANNADPOUR, 2010).
The shortest path heuristic can be easily adapted to the WRP in a new heuristic called shortest service. For the shortest service heuristic (SSH), each node represents a well from a route of the individual. Instead of choosing the first node based on its distance from a depot, the first well b E W is chosen based on the travel time (eib) of its route workover rig i from its initial position to well b plus the maintenance service duration (db), defined as service time sb = eib + db. The following wells are chosen based on their service time from the previous well.
According to the characteristics of the WRP, not only the distance (and consequently, the travel time) plus maintenance time should be taken into account to reduce production loss, but also the daily oil production pb associated to each well. Thus, a new variant of the shortest service heuristic is created, the shortest weighted service heuristic (SWSH).
The SWSH works in the same fashion as the shortest path and shortest service heuristic. However, it considers the travel time plus maintenance service duration divided by the daily oil production of each well (eib + db)/pb to re-order each well from a selected route.
Given the characteristics of SSH and SWSH, the ShortestService method applies both heuristics sequentially in order to rearrange the wells from all routes in the individual. For both heuristics, the new order is only accepted if the individual production loss is reduced and the service horizon of the selected rig is not greater than the time horizon of the problem. Figure 4.12 describes the pseudocode for the ShortestService method.
Figure 4.12 - Pseudocode for the ShortestPath method
Begin;
1.	s' = S0;
2.	V receives all rigs that belong to s';
3.	For (each rig i e U) do:
4.	W gets all wells scheduled at rig i;
5.	Waux = 0;
6.	currPosition = Initial position of rig i;
7.	While (W * 0) do:
8.	For (each well a e W) do:
9.	b = Well with the lowest (eib + db) from currPosition;
10.	currPosition = position of well b;
11.	Add b at the end of Waux;
12.	Remove b from W;
13.	s" = Update rig i route in s' according to Waux order;
14.	If (s". i. horizon &amp;lt;T and s” . loss &amp;lt;s'. loss):
15.	s ' = s'
16.	W gets all wells scheduled at rig I;
17.	Waux = 0;
18.	currPosition = Initial position of rig I;
19.	While (W*0) do:
20.	For (each well a e W) do:
21.	b = Well with the lowest ((eib + db")/pb) from currPosition;
22.	Add b at the end of Waux;
23.	currPosition = position of well b;
24.	Remove b from W;
25.	s '' = Update rig i route in s' according to Waux order;
26.	If (s” . i. horizon &amp;lt;T and s''. loss &amp;lt;s'. loss):
27.	s ' = s'';
28.	Return s ';
End.
Source: This research
4.7.4	InsertionSR Method
The InsertionSR method is based on a neighborhood structure that removes a well from its original position and reinserts it at a new position in the same route in the individual. Thus, all selected wells are tried to be inserted at all possible positions from its route.
The insertion of wells is performed according to the First Improvement strategy, what means that the procedure immediately performs an insertion movement when the acceptance criterion is verified. The acceptance criterion includes the creation of a feasible individual and reduction of production loss. For the insertion movement on the same route, a feasible individual is verified if the service horizon of the rig associated to the selected route is not greater than the time horizon stablished for the problem.
Each time the insertion movement is accepted and, therefore, executed, the search starts the insertion simulation process for the subsequent well in the route. The search ends when a local optimum is found, i.e., when no longer insertion movement are accepted for any route that belongs to the individual. Figure 4.13 presents the pseudocode for the InsertionSR method.
Figure 4.13 - Pseudocode for the InsertionSR method
Begin;
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
s ' = s0;
V receives all rigs that belong to s';
While (V * 0) do:
Vaux = 0;
For (each rig i eV) do:
For (each well a scheduled at rig I) do:
For (each position p at rig I) do:
s'' = Insertion of well a at position p in s ';
If (s''. i. horizon &amp;lt;T and s''. loss &amp;lt;s'. loss): s' = s'';
Insert rig i in Vaux;
12.	Go to step 6;
13.	V = Vaux;
14.	Return s ';
End.
Source: This research
4.7.5	Variable Neighborhood Descent (VND)
The VND is composed by the four presented neighborhood structures aiming the reduction of the production loss of the individual. The methods are executed in the following order: Insertion, Swap, ShortestService and InsertionSR. When a selected neighborhood structure does not present any improvement to the current individual, the search uses the next neighborhood structure to find a local optimum. However, if the selected neighborhood structure performs an improvement to the current individual, the search starts over from the first method. The pseudocode for the VND local search is presented in Figure 4.14.
Figure 4.14 - Pseudocode for the Variable Neighborhood Descent (VND)
Begm;
1.	s' = so;	
2.	k = 0;	
3.	While (k &amp;lt;4) do:	
4.	Switch (k):	
5.	Case 0:	
6.	s' ' =	s'. Insertion^ );
7.	Case 1:	
8.	s' ' =	s'. Swap( );
9.	Case 2:	
10.	s' ' =	s'. ShortestService( );
11.	Case 3:	
12.	s' ' =	s'. InsertionSR( );
13.	If (s''. loss&amp;lt;	s'. loss):
14.	s' = s'';	
15.	k = 0;	
16.	Else:	
17.	k = k + 1	;
18.	Return s ';	
End.		
Source: This research
The neighborhood structures order follows a logical sequence according to a decreasing degree of changes the method might cause in the individual. Whereas the Insertion and Swap methods cope with changes among different routes, the ShortestService and InsertionSR methods focus on the improvement of each route separately.
The Insertion and Swap are the first methods applied in the individual. The Insertion is the most flexible method, because it is capable of changing the number of wells scheduled at each rig by removing and reallocating wells at different positions in the routes. After its application, the Swap method changes, at the same time, the position of two wells from different routes. As the Insertion method, the Swap method has the characteristics of changing the set of wells assigned to each rig.
The Insertion and Swap methods are executed in order to define the set of wells allocated at each rig. Thereby, the ShortestService and InsertionSR methods are applied to improve the order of wells to be visited at each route separately.
The ShortestService method tries to reorder the route to reduce the production loss of the individual. The method usually performs big changes at each individual’s route while evaluates the best order of wells to be visited. Finally, the InsertionSR performs the final improvements in the individual routes by making individual changes to complement the results obtained by the ShortestService method.
4.8	Population Update
After the application of the VND heuristic to all offspring, the population is updated and becomes prepared for the execution of the next generation.
The strategy to update the current population is to compare all new offspring with the already existent individuals in the current population in order to look for repetition. The next generation will be formed by all non-repeated offspring and, in case the number of nonrepeated offspring does not fulfill the size of the population, it is completed with the best Pareto ranked parents from the previous generation.
5	COMPUTATIONAL EXPERIMENTS
This chapter describes the set of instances from the literature and the adjustments necessary in order to adapt them for the characteristics of the multi-objective WRP. After the presentation of the instances of the problem, the Pareto front obtained by the proposed algorithm is compared with the exact solution of a small instance of the WRP. Then, the resolution of a single instance is detailed for the best understanding of the problem. Main results for a set of instances are also presented in order to emphasize the characteristics of multi-objective WRP and general performance measures of the algorithm.
The proposed hybrid genetic algorithm for the resolution of the multi-obj ective workover rig problem was implemented in an object-oriented fashion using C++. Individuals in the population are represented by a dynamic list of integers. The parameters of the problem were set as follows:
•	Population size: 100;
•	Number of generations: 300;
•	Crossover rate: 1.00;
•	Mutation rate:
o Reallocation Operator: 0.05 for each well in the individual;
o Rig Reduction Operator: 0.05 for each individual.
Besides the number of generations, another stop criterion for the proposed algorithm is the execution of 75 generations with the non-update of the Pareto front. The experimentation was carried out on a computer with Windows 10 64-bits, processor Intel Core i7, 2.40 GHz and 8 GB of RAM memory.
5.1	Problem Instances
wells and number of rigs), there are ten instances of the problem with the following information: the rigs initial position and service type; and the wells' locations, production loss rates, service times and their required service levels. The set of instances with time horizon 200 and 300 are the same, except for the different time horizon. As mentioned by Ribeiro, Desaulniers &amp;amp; Desrosiers (2012), the time horizon 200 and 300 correspond to approximately 14 and 21 days, respectively.
For each problem instance, Neves (2007) formulated the parameters of the problem according to uniform discrete distributions. The x and y coordinate of each well are assigned in the interval [0,200] and the x and y coordinate of each rig initial position are assigned in the interval [1,100], in such a way that two wells and two rigs are not allowed to be assigned at the same position for each instance. The travel time between two locations is computed as the Euclidian distance, rounded as the nearest integer. The production loss rate of each well is in the interval [1,10] and the service time of each well is in the interval [1,5].
Ribeiro, Desaulniers &amp;amp; Desrosiers (2012) complement the parameters of the problem in order to adapt the instances to the characteristics of the WRP with heterogeneous fleet. The authors also use uniform discrete distributions for the remaining parameters: the required service level lw of each well in the interval [1,5] and the service type qt of each rig in the interval [3,5]. As a characteristic of the heterogeneous problem, a rig i is only able to service a well w if, and only if, lw &amp;lt;qt.
The set of instances proposed by Ribeiro, Desaulniers &amp;amp; Desrosiers (2012) is used in this work for the multi-objective WRP with heterogeneous fleet in such a way that the workover rigs of each instance with well-defined initial position are considered to be the already existent rigs that are spread around the oil field, also called field rigs. The set of additional workover rigs added to the problem in order to guarantee that all wells that need services are going to be attended within the time horizon (depot rigs), are not specified by the instances of the problem and have their initial position defined by the workover rig depot location.
rigs already placed on the oil field, so the traveling time for a depot rig impacts the production loss of all wells on its route.
However, the depot also has to be located in a position that guarantees that when a well requires the insertion of a new route in the individual, the depot rig is able to service the well (travel time plus service time) within the time horizon. Thereby, the depot location must consider that all wells on the oil field are able to be serviced by the depot rigs within the time horizon.
Taking the position (0,0) as a depot reference and the traveling time between two locations as their Euclidean distance rounded up as the nearest integer, then the farthest well on the oil field would be located at the position (200,200). Thus, the traveling time for any depot rig to service the farthest well would be 283. Since the service time of each well is in the interval [1,5], a depot workover rig located at the positon (0,0) would be ideal for the time horizon T = 300. However, for the time horizon T = 200, the depot rig could not be located at the position (0,0), since the traveling time plus service time would exceed the planning horizon for many wells on the oil field. In this case, the depot rig has to be located leastwise at the position (62.12,62.12), so the farthest well could be serviced within the time horizon. Based on these facts, a different depot location was created for each time horizon. For the time horizon T = 200, the depot was placed at the position (70,70) and for the time horizon 300, the depot was placed at the position (0.0). Figure 5.1 shows the initial configuration for the set of wells and workover rigs on the oil field, and the location of the depot rig for the instances of the WRP for each time horizon T = 200 and T = 300.
The rent cost for each workover rig type was chosen based on the real values estimated by Soares (2012) as an analysis of the annual rig rental cost for the Potiguar basis in Brazil. For the availability of three workover rigs service types on the oil field, the rental cost of each type of workover rig follows and arithmetic progression of reason R$ 22,500.00. Thus, the costs for the workover rigs with service types 3, 4 and 5 are given by R$22,500.00, R$ 45,500.00 and R$ 67,500.00, respectively.
service level is in the interval [1,5], the GA considers that the depot rig is going to have service type qt = 3 if the required service level of the current well is lw &amp;lt;3. Otherwise, the rig service type of the depot rig is equal to the required service level of the current well Qi lw.
Figure 5.1 - Initial configuration of the WRP instances for each time horizon
Source: This research
5.2	Comparison with an Exact Solution
This section presents the results of the proposed GA in comparison with the exact solution of a small problem solved exhaustively. The objective is to analyze the quality of the Pareto front reached by the GA and its number of individuals in comparison with the exact Pareto front of the problem. The exact solutions are an important way to understand the characteristics of the multi-objective WRP and the relation between both production loss and fleet cost objectives.
except for the x and y coordinates of wells, which are located in the interval [1,100], and the rig depot, which is located at position (0,0) for both time horizon T = 200 and T = 300.
Figure 5.2 represents the location of wells, the rig initial position and depot location for the exact problem. Table 5.1 and Table 5.2 present the parameters associated to each well and rigs of the problem, respectively.
Figure 5.2 - Representation of the exact problem
Rig
O Wells
■ Rig depot
Source: This research
Table 5.1 - Parameters for the set of wells of the exact problem.
well number	x coordinate	y coordinate	production loss rate	service time	required service level
1	27	24	8	3	5
2	8	60	5	9	5
3	72	51	4	10	5
4	99	33	7	8	5
5	58	88	10	6	5
6	59	40	8	9	5
7	83	18	2	10	5
Source: This research
Table 5.2 - Parameters for the set of rigs of the exact problem
rig number	x coordinate	y coordinate	service type
1	40	63	5
2-7	0	0	5
Source: This research
The problem was solved through all possible combinations of wells according to the number of rigs in the individual. The number of rigs ranged from just one workover rig, which is responsible for servicing the whole set of wells, to seven workover rigs, where each workover rig is responsible for servicing exactly one well in the scheduling. All combinations were checked and the feasible solutions were compared in order to create the exact Pareto front of the problem.
The proposed GA was also executed for the resolution of the same problem. Since the GA is probabilistic, it was executed 30 times in order to evaluate its robustness and quality of the solutions obtained in all executions. For the GA, the number of individuals was set as 100 and the number of generations was set as 300. As the fleet type of the problem was chosen to be homogeneous, all results presented in this section specify the number of workover rigs of an individual instead of its fleet cost to simplify interpretation.
The exact Pareto front and the Pareto front obtained by the GA for the time horizon T = 200 are presented in Figure 5.3. The figure also shows the objective function values of each solution of the exact Pareto front and their percentage of reduction or increase based on the objective values of the first solution of the Pareto front. It can be seen that the exact Pareto front is represented by a set of five individuals. The exact algorithm identified 933,223 feasible solutions among 1,451,520 existent combinations, what represents 64.3% feasible individuals in the search space. The GA obtained exactly the same two individuals in the Pareto front for the thirty executions of the algorithm. These individuals are the same two individuals with less number of vehicles from the exact Pareto front.
individuals for Pareto front on all thirty executions of the algorithm. These two individuals are the same as the individuals with less number of rigs from the exact Pareto front.
Figure 5.3 - Exact Pareto front and results obtained by the GA when T = 200
Number of workover rigs
□ Exact algorithm
* GA
Production %Loss	%Cost
.	r&gt; j . Fleet Cost
Loss Reduction	Increase
3649
3195
3090
3014
2994
100,0%
87,6%
84,7%
82,6%
82,0%
RS 135.000,00
RS 202.500,00
RS 270.000,00
RS 337.500,00
RS 405.000,00
100,0%
150,0%
200,0%
250,0%
300,0%
Source: This research
Source: This research
Figure 5.4 - Exact Pareto front and results obtained by the GA when T = 300
Production Loss	% Loss Reduction	Fleet Cost	%Cost Increase
6868	100,0%	RS 67.500,00	100,0%
3649	53,1%	RS 135.000,00	200,0%
3195	46,5%	RS 202.500,00	300,0%
3090	45,0%	RS 270.000,00	400,0%
3014	43,9%	RS 337.500,00	500,0%
2994	43,6%	RS 405.000,00	600,0%
prioritizing the reduction of the fleet cost over production loss. Furthermore, it can be seen from Figure 5.3 and Figure 5.4 that the production loss of individuals with the same number of workover rigs is equivalent for both time horizon T = 200 and T = 300.
An individual with the number of workover rigs equal to the total number of wells was not part of the exact Pareto front for both time horizons. It shows that, when the number of workover rigs is closer to the number of wells, the cost of scheduling a new depot rig is greater than the cost of maintaining a lower number of workover rigs to perform maintenance. This fact might be due to the position of the rig depot. The long distance of the depot from most wells on the oil field makes the traveling time more impactful on the overall production loss than the waiting time for a rig that is already performing service on another well.
Figure 5.3 and Figure 5.4 also show the highly negative conflict between both production loss and number of workover rigs. It represents the importance of tackling the WRP in a multi-objective context where the reduction of production loss is heavily affected by the number of workover rigs on the individual.
The conflict between the two objectives also reveals that the greater is the number of workover rigs on the solution, the lower is its production loss reduction. It means that the production loss undergoes major changes as the number of rigs gets closer to the minimum number of rigs from the Pareto front. In other words, the gain in production loss becomes more insignificant when the number of workover rigs increase. This fact shows the minor priority on exploring the whole set of solutions from the Pareto front and contributes to justify the prioritization on the reduction of fleet cost over production loss.
5.3	Case Study for an Instance of the WRP
Since there are many instances of the WRP, most of the results that are going to be presented in the next sections correspond to a compilation of data obtained by the set of instances that share the same initial parameters. Thus, the main objective of this section is to analyze more detailed characteristics of a single instance of the WRP through an in-depth evaluation. Based on the fact that the set of instances of the problem follows the same pattern, the in-depth study of a specific problem can reveal important aspects that might also be applied to other instances.
300, which contains the characteristics of the problem in the following order: number of wells, number of field workover rigs, instance number and planning time horizon.
Figure 5.5 represents the initial configuration of the WRP for instance 100-10-1-300. The set of wells and workover rigs are distributed through the oil field and the workover rig depot is located at position (0,0).
Figure 5.5 - Problem representation for instance 100-10-1-300
Source: This research.
The application of the proposed GA through the instance 100-10-1-300 creates the Pareto front presented in Figure 5.6. For this case, the final Pareto front corresponds to a set of 22 non-dominated individuals.
In order to present some characteristics of the solutions obtained by the proposed GA, Figure 5.7 and Figure 5.8 represent in details the routes created by the solutions with the lowest and highest fleet cost from the Pareto front, respectively. Both solutions are also pointed out in in Figure 5.6.
characteristic of the solutions of all instances of the WRP, the set of workover rigs always takes the last served well as final position of its route.
Figure 5.6 - Final Pareto front for instance 100-10-1-300
Source: This search
Figure 5.7 - Routes representation for the individual with the lowest fleet cost
0	20	40	60	80	100	120	140	160	180	200
As it shown in Figure 5.7, a set of 12 workover rigs is necessary to service all 100 wells. The solution creates a production loss of 86,632 and a fleet cost of R$540,000.00. All 10 field workover rigs are scheduled in the individual and it was necessary to add two new depot rigs to service the remaining wells within the time horizon. Both depot rigs added to the individual have service level five (5), so they are able to serve all existent wells on the oil field.
The individual with the highest fleet cost from the Pareto front of instance 100-10-1-300 is represented in Figure 5.8. Once again, the service type of each workover rig is shown in brackets and the number of wells serviced by each workover rig is shown in parentheses.
Figure 5.8 - Routes representation for the individual with the highest fleet cost
* Field Rigs
Depot Rig 28 [5] (2)
Source: This research
workover rigs have high service type: 78,57% has service type five (5), 21,43% has service type four (4) and none of them has service type three (3).
As a consequence of the long distance between the workover rig depot and the set of wells, the addition of a large number of depot rigs to the individual creates a gap between the number of wells serviced by the field rigs and the number of wells serviced by the depot rigs. As it can be calculated from data in Figure 5.7, whereas the average number of wells serviced by each field rig is 9.0, the average number of wells serviced by each depot workover rig is 5.0. For the case represented in Figure 5.8, the average number of wells serviced by each field rig is 6.7 against 2.4 serviced by each deport workover rig. In this case, the lower is the production loss of an individual, the lower is the service balance on its fleet. Thus, the inclusion of a high number of depot rigs to reduce production loss ends on the creation of an unfair workload among the workover rigs in the individual.
To present the Pareto front evolution through the execution of the GA generations, Figure 5.9 shows the Pareto front of the initial population (also called generation 0), the Pareto front obtained after the execution of a fourth of the total number of generations and the final Pareto front for instance 100-10-1-300. The number of individuals from each Pareto front is shown in parentheses.
Figure 5.9 - Pareto front evolution for instance 100-10-1-300
.. *105
14-----
T
T
13 -
12 -
□
□ OF
11 -
in co _o
c o
o
Z5 “C
2 Q_
10 -
O + □
9 -
Generation 0	(1)
Generation 75 (22)
Generation 300 (22)
8 -
7 -
6 -
+
□
+
5 -
8
1
9
O
I
8.4
1 l
8.6	8.8
Fleet cost
9.4
x104
As it can be seen from Figure 5.9, the number of individuals in the Pareto front increases significantly from generation 0 to generation 75, but remains the same from generation 75 to generation 300. Moreover, individuals from the Pareto front of generation 75 are relatively close to individuals from the Pareto front after the execution of the 300 generations. This aspect reveals the high speed convergence of the hybrid GA due to the application of the local search procedures before the population update in each generation. The local search procedure guarantees fast individual optimization. As a consequence, after the execution of the first generations, the local search performs minor (but very important) improvements to the population, since individuals are already good solutions for the problem.
The low number of individuals of the Pareto front of the initial population is due to the existence of the Insertion Constructive Method (ICM). The method includes random and not good individuals as three fourths of the initial population as a strategy to fully exploit the search space. Thus, most individuals from the initial population are dominated by a small group of solutions, what means that the number of individuals from the final Pareto front of the problem is mainly defined during the execution of the next generations of GA.
5.4	Experimental Results
This section explores the main results reached by the proposed GA through the execution of the selected instances of the WRP. Table 5.3 to Table 5.6 present a descriptive statistics of the objective functions and number of rigs of the individuals from the Pareto front, as well as the objective functions, the number of rigs, the number of added depot rigs and the number of unused field rigs for the individual with the lowest and highest fleet cost from the Pareto front of each instance of the problem for the planning time horizon T = 200 and T = 300. The mean as an overall result for each problem size is also presented.
The number of unused field rigs is defined as the set of workover rigs from the original 10 (ten) rigs already located on the oil field that are not scheduled in the individual. When the unused field rigs is greater than 0 (zero) and there is at least a depot workover rig scheduled in the individual, it means that some workover rigs already existent on the oil field are neglected because the GA has prioritized the inclusion of a depot workover rig over maintaining the set of field workover rigs in the individual. When this type of solution is found, the rule of prioritization of field rigs over depot workover rigs is violated, so the number of unused field rigs is bolded in Table 5.3 to Table 5.6.
Characteristics of the Pareto front	Individual with the lowest fleet cost	Individual with the highest fleet cost
# wells	prob. inst.	# indiv.	production loss		fleet cost (R$)		# rigs		prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs	prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs
			mean	SD	mean	SD	mean	SD										
	1	13	27161,3	1288,5	702692,3	105994,6	15,6	2,1	30075	540000	12	2	0	25859	877500	19	9	0
	2	18	25259,7	995,7	710000,0	122321,3	15,4	2,1	27330	517500	12	4	2	24021	922500	19	11	2
	3	20	29940,7	1237,7	733500,0	136842,7	16,2	2,2	32853	517500	12	3	1	28578	967500	20	12	2
	4	25	31641,3	1444,3	855900,0	167177,7	17,3	3,0	34870	585000	12	3	1	30027	1147500	22	12	0
50	5	11	25869,0	789,3	738409,1	103018,6	14,2	1,8	27346	607500	12	3	1	24795	945000	18	8	0
	6	12	26633,4	682,1	750000,0	103923,0	15,3	1,9	28160	607500	12	4	2	25806	922500	18	8	0
	7	10	25837,9	982,2	558000,0	81332,7	14,1	2,0	27425	450000	12	4	2	24597	720000	18	8	0
	8	12	29943,6	759,8	800625,0	103089,4	14,9	1,7	31644	630000	12	3	1	28929	990000	18	8	0
	9	16	27344,6	796,4	824062,5	111709,7	15,7	1,7	28871	652500	13	4	1	26265	1012500	19	9	0
	10	14	29713,4	977,6	776250,0	127813,5	15,3	2,1	31870	585000	12	3	1	28571	990000	19	9	0
MEAN		15,1	27934,5	995,4	744943,9	116322,3	15,4	2,1	30044,4	569250,0	12,1	3,3	1,2	26744,8	949500,0	19,0	9,4	0,4
	1	24	60955,5	1463,2	1213125,0	183861,4	25,5	3,1	64143	922500	20	11	1	58879	1552500	31	21	0
	2	22	53660,8	1663,4	1116818,2	172832,1	24,4	3,2	57045	855000	20	10	0	51465	1417500	30	20	0
	3	18	54848,7	1507,1	1040000,0	144906,2	24,1	2,5	57924	832500	20	10	0	52789	1327500	29	19	0
	4	20	51203,4	1464,3	1137375,0	146813,7	24,1	2,7	54638	877500	19	9	0	49315	1417500	29	19	0
100	5	25	58171,2	1761,2	1170000,0	168750,0	24,3	3,2	63179	877500	18	8	0	55972	1462500	30	20	0
	6	26	51736,3	1572,0	1170000,0	192923,6	24,7	3,3	55123	877500	19	9	0	49769	1575000	31	21	0
	7	27	59662,7	2175,9	1140833,3	199771,5	24,9	3,5	64419	832500	19	9	0	56766	1507500	31	21	0
	8	27	56097,8	2064,5	1221666,7	198696,5	24,4	3,4	60485	900000	19	9	0	53591	1552500	30	20	0
	9	28	54646,2	1689,2	1309017,9	217202,7	25,1	3,6	58347	945000	19	9	0	52546	1665000	31	21	0
	10	25	54760,9	2350,1	1139400,0	186546,6	24,4	3,7	60701	855000	17	7	0	51685	1507500	31	21	0
MEAN		24,2	55574,4	1771,1	1165823,6	181230,4	24,6	3,2	59600,4	877500,0	19,0	9,1	0,1	53277,7	1498500,0	30,3	20,3	0,0
Characteristics of the Pareto front	Individual with the lowest fleet cost	Individual with the highest fleet cost
# wells	prob. inst.	# indiv.	production loss		fleet cost (R$)		# rigs		prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs	prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs
			mean	SD	mean	SD	mean	SD										
	1	36	82976,8	2318,8	1584375,0	266515,5	36,8	4,5	88900	1147500	27	17	0	80138	2025000	44	34	0
	2	43	79073,3	3393,8	1530000,0	282522,1	34,7	5,5	87243	1057500	25	15	0	75262	2002500	43	33	0
	3	30	87254,9	2456,7	1545000,0	225877,6	36,1	3,8	95121	1192500	30	20	0	84380	1912500	42	32	0
	4	30	89675,3	2475,5	1499250,0	202757,0	34,6	4,0	95483	1170000	26	16	0	86575	1845000	41	31	0
150	5	35	88226,7	2970,4	1559571,4	242809,4	34,3	4,6	94923	1147500	26	16	0	84833	1980000	42	32	0
	6	31	85398,4	2499,2	1542338,7	222802,2	33,7	4,2	91586	1170000	26	16	0	82339	1935000	40	30	0
	7	35	78591,5	2743,1	1496571,4	249141,2	36,6	4,7	85718	1102500	28	18	0	75301	2002500	44	34	0
	8	37	88546,1	2787,1	1674729,7	261831,7	34,8	5,1	95925	1237500	26	16	0	85018	2160000	43	33	0
	9	34	82111,4	2437,3	1661029,4	284414,7	35,3	4,9	87951	1215000	26	16	0	78819	2250000	44	34	0
	10	32	85652,4	2904,5	1622109,4	266184,3	36,4	5,1	92412	1215000	27	17	0	82481	2092500	43	33	0
MEAN		34,3	84750,7	2698,6	1571497,5	250485,6	35,3	4,6	91526,2	1165500	26,7	16,7	0,0	81514,6	2020500,0	42,6	32,6	0,0
	1	44	110359,8	3627,7	1948295,5	316093,9	45,2	6,4	119925	1440000	31	21	0	106131	2520000	55	45	0
	2	47	108622,7	3568,5	1898138,3	319868,5	45,6	6,2	116946	1372500	35	25	0	104413	2497500	56	46	0
	3	47	114842,8	2861,0	2061383,0	330766,1	49,5	6,5	121670	1530000	38	28	0	111291	2700000	61	51	0
	4	42	115216,2	2344,0	2194285,7	339751,2	51,0	5,9	120688	1665000	40	30	0	111767	2857500	62	52	0
200	5	43	117655,3	3479,4	2018197,7	320332,5	45,3	6,5	126427	1507500	32	22	0	113336	2610000	56	46	0
	6	38	113645,4	3148,4	1911907,9	280366,2	42,7	5,2	120871	1462500	33	23	0	109632	2452500	51	41	0
	7	41	108676,2	2919,7	2000304,9	339399,8	47,8	6,2	115990	1462500	36	26	0	104950	2700000	60	50	0
	8	44	115535,2	3963,7	2038806,8	342373,5	44,5	6,7	125723	1462500	31	21	0	110952	2610000	55	45	0
	9	39	110067,1	3418,0	1891153,8	298270,7	42,9	5,6	118273	1417500	34	24	0	105890	2452500	52	42	0
	10	42	120913,4	3828,8	1910357,1	290224,7	44,9	6,1	129376	1440000	33	23	0	116070	2430000	55	45	0
MEAN		42,7	113553,4	3315,9	1987283,1	317744,7	45,9	6,1	121588,9	1476000	34,3	24,3	0,0	109443,2	2583000,0	56,3	46,3	0,0
Characteristics of the Pareto front	Individual with the lowest fleet cost	Individual with the highest fleet cost
# wells	prob. inst.	# indiv.	production loss		fleet cost (R$)		# rigs		prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs	prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs
			mean	SD	mean	SD	mean	SD										
	1	14	34606,1	1973,0	482142,9	106896,1	11,4	2,3	40059	315000	7	0	3	33149	675000	15	5	0
	2	7	30816,3	599,3	504642,9	78864,7	11,9	1,3	31693	405000	10	1	1	30245	630000	14	4	0
	3	9	37218,1	2397,0	425000,0	88899,5	9,1	1,8	42048	315000	7	0	3	34753	585000	12	2	0
	4	9	41372,2	2185,8	470000,0	116068,4	10,4	2,3	45637	337500	7	0	3	39041	675000	14	4	0
50	5	9	32664,8	1717,8	432500,0	70953,3	9,6	1,5	36167	337500	7	0	3	30899	562500	12	2	0
	6	8	35335,5	2013,0	462857,1	65598,2	10,5	1,2	37081	315000	7	0	3	31190	517500	11	1	0
	7	10	30568,9	1010,5	441000,0	72093,7	11,5	1,4	32477	337500	9	1	2	29477	562500	14	4	0
	8	12	40343,5	2966,9	491250,0	127580,2	9,8	2,3	46012	337500	7	0	3	36988	742500	14	4	0
	9	10	34448,0	2472,2	465750,0	110252,6	9,3	2,2	39365	337500	6	0	4	32045	675000	13	3	0
	10	8	38330,1	2518,1	441562,5	93110,3	9,0	1,9	42438	337500	7	0	3	35748	607500	12	2	0
MEAN		10	35570,4	1985,3	461670,5	93031,7	10,2	1,8	39297,7	337500,0	7,4	0,2	2,8	33353,5	623250,0	13,1	3,1	0,0
	1	22	82909,1	1321,1	867272,7	218997,9	17,4	3,5	86632	540000	12	2	0	81334	1282500	24	14	0
	2	19	71372,9	2177,7	738947,4	136298,6	16,2	2,3	77826	495000	12	2	0	69713	967500	20	10	0
	3	18	74230,7	2494,0	666250,0	133031,0	14,4	2,5	80832	450000	10	0	0	71820	922500	19	9	0
	4	13	70208,0	1441,3	716538,5	113562,3	15,5	2,2	73556	540000	12	2	0	68638	900000	19	9	0
100	5	15	76306,7	770,6	823500,0	141487,0	17,4	2,6	77968	630000	13	3	0	75387	1102500	22	12	0
	6	23	67862,5	1350,0	843260,9	170259,6	17,6	3,0	71201	585000	12	2	0	66383	1170000	23	13	0
	7	20	83456,0	1187,9	837000,0	162019,7	18,8	2,9	86272	585000	14	4	0	81937	1147500	24	14	0
	8	17	77409,4	1388,8	808676,5	115954,3	15,8	2,0	80919	607500	12	2	0	75843	990000	19	9	0
	9	18	73407,4	2368,3	803750,0	188059,5	15,7	3,0	79839	540000	11	1	0	71371	1147500	21	11	0
	10	14	75161,5	1864,5	769821,4	132430,9	15,1	2,2	80012	540000	11	1	0	73149	1012500	19	9	0
MEAN		18	75232,4	1636,4	787501,7	151210,1	16,4	2,6	79505,7	551250,0	11,9	1,9	0,0	73557,5	1064250,0	21,0	11,0	0,0
Characteristics of the Pareto front	Individual with the lowest fleet cost	Individual with the highest fleet cost
# wells	prob. inst.	# indiv.	production loss		fleet cost (R$)		# rigs		prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs	prod. loss	fleet cost (R$)	# rigs	# depot rigs	# unused field rigs
			mean	SD	mean	SD	mean	SD										
	1	29	119406,6	2580,0	1098620,7	228830,1	23,0	3,9	125869	742500	16	6	0	116234	1530000	30	20	0
	2	36	115766,1	3079,3	1091250,0	237052,2	23,1	4,2	123191	697500	16	6	0	112352	1485000	30	20	0
	3	34	123793,1	2460,0	1145514,7	272903,0	23,4	4,4	129750	742500	17	7	0	120916	1755000	33	23	0
	4	29	128335,8	2398,6	1083103,4	197136,5	23,1	3,9	133983	765000	16	6	0	125454	1462500	30	20	0
150	5	32	127086,8	2225,9	1188984,4	225443,0	23,5	3,6	133753	810000	16	6	0	124350	1597500	30	20	0
	6	29	125102,2	2422,2	1090086,2	202641,6	21,2	4,1	130819	765000	15	5	0	122215	1440000	28	18	0
	7	29	114302,3	2378,5	1100172,4	222685,4	23,9	4,0	119893	765000	17	7	0	111661	1507500	31	21	0
	8	25	129242,2	2345,4	1086300,0	179709,1	21,1	3,1	135343	787500	15	5	0	126480	1440000	27	17	0
	9	34	118839,4	2747,5	1122352,9	265979,4	22,0	4,6	125383	720000	14	4	0	115709	1665000	31	21	0
	10	26	119415,7	3074,7	1078269,2	213161,6	21,9	4,2	127035	765000	15	5	0	116136	1485000	29	19	0
MEAN		30	122129,0	2571,2	1108465,4	224554,2	22,6	4,0	128501,9	756000	15,7	5,7	0,0	119150,7	1536750,0	29,9	19,9	0,0
	1	35	162561,4	2548,5	1429714,3	252758,9	30,4	4,4	168819	1035000	23	13	0	159228	1957500	40	30	0
	2	43	162500,7	3148,5	1455174,4	315104,1	31,2	5,6	170363	945000	21	11	0	158706	2115000	42	32	0
	3	43	173797,1	3635,6	1388720,9	306754,0	28,6	5,1	182790	900000	20	10	0	169476	2047500	39	29	0
	4	52	173432,5	3012,6	1764086,5	452798,5	35,4	7,0	181233	1080000	23	13	0	169840	2655000	49	39	0
200	5	49	176874,5	3561,7	1513469,4	331056,5	31,4	5,8	186434	967500	20	10	0	172770	2137500	42	32	0
	6	38	168407,9	3381,5	1395592,1	298701,8	28,6	6,4	178367	900000	18	8	0	164670	1957500	40	30	0
	7	43	164511,4	3737,9	1442093,0	310328,1	31,7	6,1	173889	945000	21	11	0	160149	2047500	43	33	0
	8	33	171838,4	3191,4	1482954,5	282729,1	29,5	5,2	179433	1057500	20	10	0	168048	1980000	38	28	0
	9	39	162022,4	2549,3	1527692,3	332480,9	31,2	6,1	168013	1012500	21	11	0	158941	2115000	41	31	0
	10	33	174697,6	3300,8	1401818,2	249694,6	29,8	5,5	183024	1012500	20	10	0	170942	1845000	39	29	0
MEAN		41	169064,4	3206,8	1480131,6	313240,6	30,8	5,7	177236,5	985500	20,7	10,7	0,0	165277,0	2085750,0	41,3	31,3	0,0
Results from Table 5.3 and Table 5.4 of time horizon T = 200 show that, for the problem with 50 wells, the existence of unused field workover rigs in the individual occurs for most instances. For the problem with 100 wells, it occurs less frequently and for 150 and 200 wells, it never occurs.
The reason for the prioritization of depot rigs over field rigs is the location of the workover rig depot for the planning time horizon T = 200. As it was mentioned in Section 5.1, the workover rig depot was located at position (70,70) due to the fact that depot rigs must be able to perform service in all existent wells on the oil field within the time horizon. As field rigs are located at the square [0,100], when the GA is executed, the production loss obtained after the inclusion of a depot workover rig might be lower than the production loss of maintaining a field workover rig in the individual, because the depot rigs might be closer to most wells spread on the oil field.
This situation occurs for problems with small number of workover rigs. When the number of wells increases, the density of wells located at each region of the oil field is higher, so the GA tends to maintain all field workover rigs in the individual. For this situation, the set of wells closer to the field rigs and depot rigs increases in such a way that the distance between the rig depot and the field rigs does not interfere for the elimination of any field rig initially included in the individual.
For the planning time horizon T = 300, as is shown in Table 5.5 and Table 5.6, in some cases, when the minimum number of workover rigs necessary to service the wells is smaller than the already existent workover rigs on the oil field, the algorithm might consider the removal of a field rig due to the service level required by the set of wells. In order to minimize the number of workover rigs in the individual, it is preferable to remove a field rig with low service type and to include a depot workover rig with high service type. When this situation occurs, the number of unused field rigs does not violate the prioritization of the existent field rigs over the depot rigs.
From the results presented in Table 5.3 to Table 5.6, it is possible to verify that the number of individuals of the Pareto front is greater when the number of wells of the problem increases. Figure 5.10 presents a box plot for the number of workover rigs scheduled in the individuals from the Pareto front of the first instance of each problem size for both time horizons T = 200 and T = 300.
Figure 5.10 - Box plot for the number of workover rigs of the first instance of each size of the problem
Source: This research
As it is expected, the number of workover rigs scheduled for the time horizon T = 200 exceeds the number of rigs for the time horizon T = 300. Among the problem sizes used for the resolution of the proposed algorithm, the only situation when the number of workover rigs in some individuals from the Pareto front is smaller than the number of field rigs spread on the oil field is the problem with 50 wells and time horizon T = 300. Another characteristic is that the range of the number of vehicles from the Pareto front increases as the number of wells becomes greater for both time horizons. This fact can also be verified through the increase in the mean standard deviation of the number of vehicles for the different problem sizes in Table 5.3 to Table 5.6.
From the analysis of Figure 5.10, it is verified that the maximum number of workover rigs reached by the Pareto fronts is much smaller than the theoretical maximum number of workover rigs for each problem size, where the number of workover rigs is equal to the number of wells on the oil field. It can be seen as a result of the characteristic of the proposed algorithm on prioritizing the minimization of the fleet cost over the production loss of all individuals.
Table 5.7 presents the descriptive statistics for the Pareto front size after the execution of 30 repetitions of the first instance for the problem with 50 and 100 wells and T = 200 and T = 300.
Table 5.7 -Pareto front size descriptive statistics for 30 executions of some instances
# wells	Time horizon	Problem — instance	Results of 30 repetitions				
			Minimum value	Maximum value	Amplitude	Mean	Standard deviation
	200	1	8	16	8	12,6	1,73
50	300	1	7	13	6	9,6	1,89
	200	1	20	27	7	23,63	1,87
100	300	1	11	27	16	18,97	3,75
Source: This research
By the analysis of the data front, the Pareto front size differs slightly after the execution of 30 repetitions of the same problem. The analysis of the standard deviation demonstrates an acceptable level of variability and contributes to identify the robustness of the proposed algorithm.
Table 5.8 shows the mean execution time of the hybrid GA for the 10 instances of each size of the problem, the execution time of the local search VND and the percentage of participation of VND as a complementary method of the GA.
Table 5.8 - Mean execution time of the proposed GA
# wells	Tested inst.	T = 200			T = 300		
		GA (min)	VND (min)	% VND	GA (min)	VND (min)	% VND
50	10	2,64	2,56	97,0%	2,09	2,02	96,6%
100	10	26,39	26,09	98,9%	26,30	25,91	98,5%
150	10	94,83	94,20	99,3%	116,35	115,25	99,0%
200	10	274,39	273,19	99,6%	324,28	322,09	99,3%
Source: This research
With regard to the stopping criteria of the hybrid GA, it is possible to identify that for most instances, the used stopping criterion is the execution of the maximum number of generations, defined as 300. The execution of 75 generations with the non-update of the Pareto front occurs less frequently and is normally verified in small instances of the problem (50 and 100 wells).
5.5	Results Discussion
Before testing the proposed algorithm on medium and large scale problems, the objective was to validate the GA for a small example of the WRP. The results obtained by the proposed GA in comparison with the exact solution shows that all individuals are equal to some individuals of the exact Pareto front. It means that the algorithm is performing correctly and its results are acceptable in large instances. Thereby, it suggests that the algorithm is able to identify good results when instances of the problem take greater proportions, which represent the applied cases with 50, 100, 150 and 200 wells.
The results of the small instance in comparison with the exact solution also revealed the prioritization of the genetic algorithm in exploring solutions in which the amount of workover rigs to be scheduled in the individual is close to the minimum amount of rigs required for all wells to be serviced within the planning time horizon. As it can be verified in the Pareto front of the exact solution, when the number of workover rigs increases significantly, the small reduction in production loss does not justify the cost of renting new workover rigs. Thus, after some quantity of workover rigs, the decision maker may not be worried about the Pareto front solutions, since these solutions do not create great impact on the production loss of the system. This region is called the indifference zone for the decision maker.
The existence of an indifference zone justifies the approach of the genetic algorithm in exploring only one region of the Pareto front, considered most important from the point of view of the decision maker. The search through a smaller region of the Pareto front allows the algorithm to focus on finding good and various individuals from the region of interest. Besides, exploring the entire Pareto front would require a population with greater number of individuals, what could also impair the performance of the algorithm.
causes a great reduction in the beginning of service time of each well, what means that the production loss is directly affected. This characteristic justifies the importance of a multiobjective approach for the WRP. The Pareto front allows the decision maker to have different points of view when trying to find the best solution of the problem.
6	CONCLUSION
This research presented a hybrid multi-objective genetic algorithm as an approach for the resolution of the workover rig routing problem with heterogeneous fleet and finite time horizon. The proposed algorithm tackles two conflicting objectives of the WRP, the total production loss and the fleet cost. In order to service the whole set of wells within the planning time horizon during the execution of just one planning section, the problem considers the existence of a variable fleet, so wells are added or removed from the scheduling when necessary.
As an initial characteristic of the WRP, a limited set of wells are already spread on the oil field with a well-defined initial position. To guarantee a variable fleet and the origin of new workover rigs to be added in the scheduling, a workover rig depot was included on the oil field. The rig depot ensures the availability of an unlimited number of workover rigs of all types of service levels.
The resolution of the problem is constructed in such a way that field workover rigs are given priority over depot workover rigs. The priority order is mainly guaranteed by the high distance of the rig depot from the existent wells on the oil field. Furthermore, a depot rig is only added to the scheduling when the set of field rigs are not able to perform maintenance service to the requiring wells or when the resulting production loss from the scheduling of a field rig is greater than the production loss from the scheduling of a depot workover rig.
The existence of a variable fleet for the reduction of fleet cost is a poorly explored objective in the WRP literature. Thereby, the addition of a workover rig depot represents one of the main contributions of this work. The workover depot rig proposes a new configuration for the WRP as a new way to explore the problem that allows the proposition of new methods for its resolution. This approach is also poorly explored in the literature and, as far as we know, the addition of a source (workover rig depot) for the rent and scheduling of new rigs is firstly explored in this work.
decision and choose an appropriate scheduling based on more than one criterion of the problem.
Due to the characteristics of the instances used to solve the multi-objective approach of the WRP, for the majority of results, it became necessary to include new depot workover rigs into the scheduling to ensure that all wells were serviced within the planning time horizon. However, the proposed genetic algorithm also allows the resolution of problems where the number of field workover rigs is sufficient for the scheduling to be performed. In both cases, the Pareto front shows the trade-off between the minimum number of workover rigs required for scheduling to be performed within the planning horizon and the reduction of production loss due to the inclusion of more workover rigs (existent field rigs or new depot rigs) into the individual.
One of the objectives addressed by Bissoli, Chaves &amp;amp; Ribeiro (2016) as a new approach for the multi-objective WRP concerns the balancing of rig fleet in order to avoid the overloading of teams responsible for the workover rigs. As it was presented as a result of the proposed algorithm, the inclusion of a large number of workover rigs into the individual generates an overload of the field workover rigs in comparison with the depot workover rigs. Thus, an advance of the problem may consider the existence of a third objective to balance the workload of rigs.
The WRP with variable fleet and a workover rigs source (rig depot) creates a new decision context when the problem is executed over different planning sections: after the execution of every run, if any depot workover rig was added into the scheduling, it takes as final position the last serviced well location, and therefore, it is considered a field workover rig during the execution of the next planning section of the problem. Thus, over time, the number of field workover rigs may increase and some of them may not be necessary to remain on the oil field. For this case, the multi-obj ective problem is not only concerned about the inclusion of new workover rigs into the scheduling, but also the decision of returning some workover rigs from the oil field to the rig depot.
REFERENCES
ALOISE, D. J.; ALOISE, D.; ROCHA, C. T. M.; RIBEIRO, C. C.; RIBEIRO FILHO, J. C.; MOURA, L. S. S. Scheduling workover rigs for onshore oil production. Discrete Applied Mathematics. 154: 695-702, 2006.
BASSI, H. V.; FERREIRA FILHO, V. J. M.; BAHIENSE, L. Planning and scheduling a fleet of rigs using simulation-optimization. Computers &amp;amp; Industrial Engineering, 63: 1074-1088, 2012.
BISSOLI, D. C.; CHAVES, G. L. D.; RIBEIRO, G. M. Drivers to the workover rig problem. Journal of Petroleum Science and Engineering, 139: 13-22, 2016.
BODIN, L.D; GOLDEN, B.; ASSAD, A; BALL, E.M. Routing and scheduling of vehicles and crews: the state of art. Computer and Operations Research, v.10 n. 2, p. 63-211, 1983.
COSTA, L. R.; FILHO, V. J. M. F. Uma heurística para o problema do planejamento de itinerários de sondas em intervenções de poços de petróleo. In: SIMPÓSIO BRASILEIRO DE PESQUISA OPERACIONAL, 36., São José do Rei, 2004. Anais. São José do Rei, 2004.
COSTA, L. R.; FILHO, V. J. M. F. Uma heurística de montagem dinâmica para o problema de otimização de itinerários de sondas. In: SIMPÓSIO BRASILEIRO DE PESQUISA OPERACIONAL, 37., Gramado, 2005. Anais. Gramado, 2005.
GOLDBERG, D. E. Genetic Algorithms in Search, Optimization and Machine Learning. 1. ed. Boston, MA, USA, Addison-Wesley Longman Publishing Co., 1989.
DEVOLD, H. Oil and gas production handbook: an introduction to oil and gas production, transport, refining and petrochemical industry. 3 ed. ABB Oil and Gas, 2013.
DUHAMEL, C.; SANTOS, A. C.; GUEDES, L. M. Models and hybrid methods for the onshore wells maintenance problem. Computers &amp;amp; Operations Research, 39: 2944-2953, 2012.
FONSECA, C. M.; FLEMING, P. J. Multiobjective genetic algorithm. The Institution of Electrical Engineers - IEE, 1993.
GAO, J.; SUN, L.; GEN, M. A hybrid genetic and variable neighborhood descent algorithm for flexible job shop scheduling problems. Computers &amp;amp; Operations Research, 35: 28922907, 2008.
GEN, M.; CHENG, R.; LIN, L. Network models and optimization: multiobjective genetic algorithm approach. Girona, Springer, 2008, 702, 685p.
GHANNADPOUR, S. F.; NOORI, S.; TAVAKKOLI-MOGHADDAM R.; GHOSEIRI, K. A multi-objective dynamic vehicle routing problem with fuzzy time windows: model, solution and application. Applied Soft Computing, 14: 504-527, 2014.
GHOSEIRI, K.; GHANNADPOUR, S. F. Multi-objective vehicle routing problem with time windows using goal programming and genetic algorithm. Applied Soft Computing, 10: 10961107, 2010.
HIBBERT, D. B. Hybrid genetic algorithms. Data Handling in Science and Technology, 23: 55-68, 2003.
HOLLAND, J. H. Adaptation in natural and artificial systems: an introductory analysis with applications to biology, control, and artificial intelligence. University of Michigan Press, 1975.
HUE, Z.; YANG, J.; SUN, H.; WEI, L.; ZHAO, Z. An improved multi-objective evolutionaly algorithm based on environmental and history information. Neurocomputing, 2016.
JOZEFOWIEZ, N.; SEMET, F.; TALBI, E. Multi-objective vehicle routing problems. European Journal of Operational Research, 189: 293-309, 2008.
KARAKATIC, S.; PODGORELEC, V. A survey of genetic algorithms for solving multi depot vehicle routing problem. Applied Soft Computing, 27: 519-532, 2015.
KHURANA, S.; DEWALT, B.; HEADWORTH, C. Well intervention using rigless techniques. Offshore, 63 (9): 46-48, 2003.
KONAK, A.; COIT, D. W.; SMITH, A. E. Multi-obj ective optimization using genetic algorithms: a tutorial. Reliability Engineering and System Safety, 91: 992-1007, 2006.
LIN, S. Computer solutions for travelling salesman problem. Bell System Technical Journal, 44: 2245-2269, 1965.
MARTINS, A. X.; DUHAMEL, C.; MAHEY, P.; SALDANHA, R. R.; SOUZA, M. C. Variable neighborhood descent with iterated local search for routing and wavelength assignment. Computers &amp;amp; Operations Research, 39: 2133-2141, 2012.
MAVROTAS, G.; FIGUEIRA, J. R.; SISKOS, E. Robustness analysis methodology for multi-objective combinatorial optimization problems and application to project selection. Omega, 52: 142-155, 2015.
MIRJALILI, S.; SAREMI, S.; MIRJALILI, S. M.; COELHO, L. S. Multi-objective grey wolf optimizer: a novel algorithm for multi-criterion optimization. Expert Systems With Applications, 47: 106-119, 2016.
MONEMI, R. N.; DANACH, K.; KHALIL, W.; GELAREH, S.; LIMA JR, F. C.; ALOISE, D. J. Solution methods for scheduling of heterogeneous parallel machines applied to the workover rig problem. Expert Systems with Applications, 42: 4493-4505, 2015.
NEVES, T. A. Heurísticas com memória adaptativa aplicadas ao problema de roteamento e scheduling de sondas de manutenção. Niterói, 2007. 76p. (Master thesis - Programa de pós-graduação em computação / UFF).
OMBUKI, B.; ROSS, B. J.; HANSHAR, F. Multi-objective genetic algorithm for vehicle routing problem with time windowns. Applied Intelligence. 24: 17-30, 2006.
OMUNDSEN, P.; ROLL, K. H.; TVETERAS, R. Exploration drilling productivity at the Norwegian shelf. Journal of Petroleum Science and Engineering. 73: 122-128, 2010.
RAHIMIAN, E.; AKARTUNALI, K.; LEVINE, J. A hybrid integer programming and variable neighbourhood search algorithm to solve nurse rostering problems. European Journal of Operational Research, 000: 1-13, 2016.
RIBEIRO, C. M.; MAURI, G. R.; LORENA, L. A. N. A simple and robust simulated annealing algorithm for scheduling workover rigs on onshore oil fields. Computers &amp;amp; Industrial Engineering, 60: 519-526, 2011.
RIBEIRO, G. M.; DESAULNIERS, G.; DESROSIERS, J. A branch-price-and-cut algorithm for the workover rig routing problem. Computer &amp;amp; Operations Research, 39: 3305-3315, 2012.
RIBEIRO, M.; LAPORTE, G.; MAURI, G. R. A comparison of three metaheuristics for the workover rig routing problem. European Journal of Operational Research, 220: 28-36, 2012.
RIBEIRO, G. M.; DESAULNIERS, J. D.; VIDAL, T.; VIEIRA, B. S. Efficient heuristics for the workover rig routing problem with a heterogeneous fleet and a finite horizon. J Heuristics, 20: 677-708, 2014.
SILVA, E. L.; MENEZES, E. M. Metodologia de pesquisa e elaboração de dissertação. 4. ed. Florianópolis, UFSC, 2005.
SOARES, W. K. S. O problema da composição e sequenciamento de frota de sondas de produção em campos de petróleo onshore. Recife, 2012. 116p. (PhD thesis - Programa de pós graduação em engenharia de produção / UFPE).
THANGIAH, S. R.; OSMAN, I. H.; SUN, T. Hybrid geneti algorithm, simulated annealing and tabu search methods for vehicle routing problems with time windows. 1993.
TRINDADE , V. A.; OCHI, L. S. Hybrid Adaptive Memory Programming Using GRASP and Path Relinking for the Scheduling Workover Rig for Onshore Oil Production. In: INTERNATIONAL CONFERENCE ON HYBRID INTELLIGENT SYSTEMS, 5. Rio de Janeiro, 2005. Proceedings. IEE Rio de Janeiro, 2005.
WHITLEY, D. A genetic algorithm tutorial. Statistics and Computing, 4: 65,85, 1994.
ZAVALA, G. R.; NEBRO, A. J.; LUNA, F.; COELHO, C. A. C. A survey of multi-objective metaheuristics applied to structural optimization. Structural and Multidisciplinary Optimization, 49: 537-558, 2014.</field>
	</doc>
</add>