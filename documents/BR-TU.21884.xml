<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.21884</field>
		<field name="filename">5694_TESE%20Fernando%20Raul%20Licapa%20Contreras.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade Federal de Pernambuco
Centro de Tecnologia e Geociências

Departamento de Engenharia Mecânica

Programa de Pós-Graduação em Engenharia Mecânica

Fernando Raul Licapa Contreras

Métodos de Volumes Finitos Robustos para a
Simulação de Escoamentos Bifásicos de Água e

Óleo em Reservátorios de Petróleo

Recife

2017



Fernando Raul Licapa Contreras

Métodos de Volumes Finitos Robustos para a Simulação
de Escoamentos Bifásicos de Água e Óleo em

Reservátorios de Petróleo

Tese submetida ao corpo docente do curso de
Pós-Graduação em Engenharia Mecânica da
Universidade Federal de Pernambuco como
parte dos requisitos necessários à obtenção
do grau de doutor em ciencias de Engenharia
Mecânica.

Área de concentração: Energia

Orientador: Prof. Dr. Darlan Karlo Elisiá-
rio de Carvalho
Coorientador: Prof. Dr. Paulo Roberto Maciel
Lyra

Recife

2017



  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Catalogação na fonte 

Bibliotecária Maria Luiza de Moura Ferreira, CRB-4 / 1469 

 

  
C764m Contreras, Fernando Raul Licapa.  

        Métodos de volumes finitos robustos para a simulação de escoamentos bifásicos de água 

e óleo em reservatórios de petróleo   / Fernando Raul Licapa Contreras. - 2017. 

                            118 folhas, il., tabs. e simbs. 

 

                           Orientador: Prof. Dr. Darlan Karlo Elisiário de Carvalho. 

               Coorientador: Prof. Dr. Paulo Roberto Maciel Lyra. 

Tese (Doutorado) – Universidade Federal de Pernambuco. CTG. Programa de Pós-

Graduação em Engenharia Mecânica, 2017. 

                            Inclui Referências e Apêndice. 

    

                          

  1. Engenharia Mecânica. 2. Simulação de escoamentos bifásicos de óleo e água.   

3. Reservatórios de petróleo heterogêneos e anisotrópicos. 4. Método de volumes finitos 

lineares do tipo MPFA. 5. Método dos volumes finitos não lineares (NLFV). 6. MOOD.  

I. Carvalho, Darlan Karlo Elisiário de (Orientador). II. Lyra, Paulo Roberto Maciel 

(Coorientador). III. Título 

  

  

                                                                                      UFPE                       

               

 621 CDD (22. ed.)                                                 BCTG/2017-318 

 

 

                  



10 de Janeiro de 2017 

“MÉTODOS DE VOLUMES FINITOS ROBUSTOS PARA A SIMULAÇÃO DE 

ESCOAMENTOS BIFÁSICOS DE ÁGUA E ÓLEO EM RESERVATÓRIOS DE 

PETRÓLEO” 

 

FERNANDO RAUL LICAPA CONTRERAS 

 

ESTA TESE FOI JULGADA ADEQUADA PARA OBTENÇÃO DO TITULO DE 

DOUTOR EM ENGENHARIA MECÂNICA 

 

ÁREA DE CONCENTRAÇÃO: ENERGIA 

 

APROVADA EM SUA FORMA FINAL PELO 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA 

MECÂNICA/CTG/EEP/UFPE 

 

 

Prof. Dr. DARLAN KARLO ELISIÁRIO DE CARVALHO 

                                                              ORIENTADOR/PRESIDENTE 

 

 

Prof. Dr. PAULO ROBERTO MACIEL LYRA 

                                                                           COORIENTADOR 

 

 

Prof. Dr. CEZAR HENRIQUE GONZALEZ 

                                                                                 COORDINADOR DO PROGRAMA 

BANCA EXAMINADORA: 

 

Prof. Dr. DARLAN KARLO ELISIÁRIO DE CARVALHO (UFPE) 

 

Prof. Dr. FABIO SANTANA MAGNANI (UFPE) 

 

Prof. Dr. IGOR FERNANDES GOMES (UFPE) 

 

Prof. Dr. LEONARDO JOSÉ DO NASCIMENTO GUIMARÃES (UFPE) 

 

Prof. Dr. ALESSANDRO ROMÁRIO ECHEVARRIA ANTUNES (UFPE) 

 



"Dedico el presente trabajo a mis padres

Manuela y Copertino y mis hermanos

Ronal, Doris y Luis"



AGRADECIMENTOS

À Fundação de Amparo a Ciência e Tecnologia do Estado de Pernambuco (FACEPE)
pela bolsa de estudos concedida durante o período de desenvolvimento do doutorado. À Rede
Temática de Simulação e Gerenciamento de Reservatórios (SIGER), patrocinado pela empresa
PETROBRAS S.A., pela bolsa de estudos fornecidos e pelo incentivo nas pesquisas que motiva-
ram a realizar o presente trabalho.

A meus orientadores Darlan K. E. de Carvalho e Paulo R. M. Lyra pelo apoio prestado, a
confiança depositada, dedicação e exigência indispensáveis, muito obrigado professores.

Ao meu amigo e colega Marcio R. de Araújo Souza, pelas conversas compartilhadas, além
da sua incalculável contribuição no pré-processador e em tantas outras rotinas computacionais.

Aos meus pais, Manuela e Cupertino, pelo carinho e o apoio moral nos momentos de
decaimento, e a boa formação para o caminhar na vida. Aos meus irmãos, Ronal, Doris, Luis
Angel e Paulo Andre pelo carinho e confiança depositada em mim.

E finalmente, agradecimento aos meus colegas e amigos do Recife pelo apoio prestado
direta ou indiretamente durante minha estadia.



RESUMO
No presente trabalho apresentamos formulações numéricas para a discretização de um modelo
matemático que descreve o escoamento bifásico de água e óleo em reservatórios de petróleo
heterogêneos e anisotrópicos. Estas equações são resolvidas através da metodologia IMPES
(Implicit Pressure Explicit Saturation) que é, em particular, um método segregado para tratar
escoamento bifásico (água-óleo) em que, o campo de pressão é obtida implicitamente e o
campo de saturação é obtida explicitamente. Para resolver a equação de pressão propormos
formulações numéricas baseadas no método de volumes finitos lineares (a saber: MPFA-HD
e MPFA-H) e no método de volumes finitos não lineares (a saber: NLFV-PP e NLFV-DMP),
estas formulações em geral lidam com meios altamente heterogêneos e anisotrópicos sobre
malhas poligonais em geral. De outra parte, neste trabalho são estudadas as varias propriedades
numéricas que satisfazem as formulações numéricas propostas. Além disso, no caso do método
não linear que satisfaz o principio do máximo discreto (DMP), mostramos que este possui um
estêncil pequeno desde que os pontos de interpolação sejam calculados a partir dos pontos
harmônicos. Para resolver a equação de saturação, utilizamos um método multidimensional
nomeada MOOD (Multi-dimensional Optimal Order Detection), esta método é baseada numa
discretização espacial de alta ordem com procedimento de limitação a posteriori das variáveis
de estado (i. e. saturação) não físicos. Em cada volume de controle o grau polinomial ótimo é
determinado para construir uma aproximação das soluções respeitando o principio do máximo
discreto. Mediante um processo iterativo o grau polinomial é reduzido quando o volume de
controle em questão não satisfaz as condições de estabilidade. Neste método, uma estratégia
baseada na Técnica de Mínimos Quadrados é usada para a reconstrução polinomial. Todos
métodos propostos são localmente conservativos, e todas as incógnitas são completamente
centradas nos volumes de controle, e possuem a habilidade de representar reservatórios com
propriedades geológicas complexas utilizando malhas poligonais quaisquer. O desempenho
dessas foi avaliado a partir da solução de problemas relevantes encontrados na literatura.

Palavras-Chave: Simulação de escoamentos bifásicos de óleo e água. Reservatórios de petróleo
heterogêneos e anisotrópicos. Método de volumes finitos lineares do tipo MPFA. Método dos
volumes finitos não lineares (NLFV). MOOD.



ABSTRACT
In the present work we present numerical formulations for the discretization of a mathematical
models that describes the two-phase flow of water and oil in heterogenous and anisotropic oil
reservoirs. These equations are solved through Implicit Pressure Explicit Saturation (IMPES)
methodology which is in particular a segregated method to treat two-phase (water-oil) flow in
which the pressure field is implicitly obtained and the saturation field is obtained explicitly . In
order to solve the pressure equation we propose numerical formulations based on the finite linear
volume method ( MPFA-HD and MPFA-H) and non-linear finite volume method (NLFV-PP and
NLFV-DMP). Formulations generally deal with highly heterogeneous and anisotropic media
over polygonal meshes in general. On the other hand, in this work the numerical properties that
satisfy the proposed numerical formulations are studied. In addition, in the case of the non-linear
method that satisfies the discrete maximum principle (DMP), we show that it has a small stencil
since the interpolation points are calculated from the harmonic points. To solve the saturation
equation, we use a multidimensional method named MOOD (Multidimensional Optimal Order
Detection), this method is based on a high order spatial discretization with a posteriori limitation
procedure of the non-physical state variables (saturation). In each control volume the optimum
polynomial degree is determined to construct an approximation of the solutions respecting the
discrete maximum principle. By means of an iterative process the polynomial degree is reduced
when the control volume in question does not satisfy the stability conditions. In this method,
a strategy based on the Least Squares technique is used for polynomial reconstruction. All
proposed methods are locally conservative, and all unknowns are completely centered on control
volumes, and have the ability to represent reservoirs with complex geological properties using
any polygonal meshes. The performance of these was evaluated from the solution of relevant
problems found in the literature.

Keywords: Two-phase simulation oil and water. Heterogeneous and anisotropic oil reservoirs.
Linear finite volume method type MPFA. Non-linear finite volume method (NLFV). MOOD.



LISTA DE FIGURAS

Figura 1 – Domínio computacional identificando os poços injetores, produtores e os
contornos de Dirichlet (?D) e Neumann (?N ) . . . . . . . . . . . . . . . . . 32

Figura 2 – Algoritmo da estrategia IMPES . . . . . . . . . . . . . . . . . . . . . . . . 34
Figura 3 – As figuras representam a escolha do par de pontos que viola a condição 2

sem violar a condição 1 (a) e a escolha do par de pontos que viola a condição
1 sem violar a condição 2 (b) . . . . . . . . . . . . . . . . . . . . . . . . . 40

Figura 4 – Pontos de interpolação que coincidem com: os vértices formando uma região
Half-Diamond (a) e os pontos harmônicos (b) . . . . . . . . . . . . . . . . 41

Figura 5 – Mostramos os fluxos utilizando os vértices e os pontos harmônicos . . . . . 44
Figura 6 – Mostram os fluxos e faces que atuam no momento de escrever o balanço de

massa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Figura 7 – Região de iteração para interpolação LP . . . . . . . . . . . . . . . . . . . 54
Figura 8 – Região de iteração para interpolação do nó na fronteira de Neumann . . . . 55
Figura 9 – Estêncil para o calculo do fluxo utilizando os pontos interpolação centrados

nos vértices: estêncil do método MPFA-HD (esquerda) e estêncil usado pelo
método MPFA-D (direita) . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

Figura 10 – Entes geométricos sobre uma malha K-ortogonal . . . . . . . . . . . . . . . 58
Figura 11 – Fluxo na face de Neumann . . . . . . . . . . . . . . . . . . . . . . . . . . 59
Figura 12 – Os pontos harmônicos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figura 13 – Na figura esquerda são mostrados os pontos de interpolação obtidos pela

equação (3.115) e na direita os pontos harmônicos obtidos pela equação (3.119) 67
Figura 14 – Na figura esquerda são mostrados os ponto de interpolação obtida pela equa-

ção (3.115) e na direita são mostradas os pontos harmônicos considerado
como ponto médio da superfície de controle . . . . . . . . . . . . . . . . . 68

Figura 15 – Fluxo no contorno de Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . 71
Figura 16 – Fluxo no contorno de Neumann para o caso 1 . . . . . . . . . . . . . . . . 72
Figura 17 – Fluxo no contorno de Neumann para caso 2 . . . . . . . . . . . . . . . . . 72
Figura 18 – Fluxo no contorno de Neumann para o caso 3 . . . . . . . . . . . . . . . . 73
Figura 19 – Malha quadrilateral (a) e o campo de permeabilidade (b) . . . . . . . . . . . 79
Figura 20 – Perfil do campo de pressão obtido pelo método NLFV-PP . . . . . . . . . . 79
Figura 21 – Malha triangular não estruturada (a) com 158 e (b) 576 volumes de controle 80
Figura 22 – Perfil do campo de pressão obtido com o método MPFA-HD (a) e NLFV-PP (b) 82
Figura 23 – Malha triangular alinhada (a) e malha Kershaw quadrilateral (b) . . . . . . . 83



Figura 24 – Perfil do campo de pressões obtido sobre uma malha triangular alinhada
24x24: (a) MPFA-O (cor de branco denota as regiões com valores negativos
e a região cor de rosa denota valores maiores que 1), (b) MPFA-HD e (c)
NLFV-DMP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

Figura 25 – Malha não estruturada triangular . . . . . . . . . . . . . . . . . . . . . . . 85
Figura 26 – O perfil de pressão obtido pelo método: MPFA-H (a), MPFA-HD (b), NLFV-

PP (c) e NLFV-DMP (d). . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
Figura 27 – Múltiplos valores para a saturação (situação não-física) . . . . . . . . . . . 89
Figura 28 – Estêncil utilizado para obter uma aproximação de alta ordem . . . . . . . . 93
Figura 29 – Iedia do método clássico de alta ordem tipo MUSCL (acima) e ideia do

MOOD (baixo) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
Figura 30 – Malha não estruturada triangular com 1054 volumes de controle (esquerda) e

Campo de permeabilidade (direita) . . . . . . . . . . . . . . . . . . . . . . 99
Figura 31 – Perfil de saturação obtido pelo método MPFA-HD acoplado a: FOU (es-

querda) e solução de referencia foi obtido com o método MPFA-O/FOU . . 100
Figura 32 – Perfil de saturação obtido pelo método MPFA-HD acoplado a: HOMFV

(esquerda) e MOOD (dereita). . . . . . . . . . . . . . . . . . . . . . . . . . 100
Figura 33 – Curvas de corte de água no poço produtor . . . . . . . . . . . . . . . . . . 101
Figura 34 – Domínio computacional para um problema de três poços, para ? = 0 (es-

querda) e ? = ?/6 (direita). A região circular interior este me branco e o
outro em cinza. O poço superior é poço injetor, e os poços inferiores são pro-
dutores 1 (esquerda) e 2 (direita), adaptado de Kozdon, Mallison e Gerritsen
(2011) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

Figura 35 – Curvas de corte de água para o problema homogêneo de três de poços,
utilizando: método NLFV-PP/FOU (esquerda); NFLV-PP/HOMFV (centro) e
NLFV-PP/MOOD (direita). As linhas tracejadas referem-se ao poço produtor
1 e as linhas continuas referem-se ao poço produtor 2 . . . . . . . . . . . . 102

Figura 36 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = 0 (esquerdo), ? = ?/12 (centro) e ? = ?/8 (esquerda) obtido com o
método, NLFV-PP/MOOD . . . . . . . . . . . . . . . . . . . . . . . . . . 103

Figura 37 – Perfil de saturação para um problema homogêneo com três poços com an-
gulo ? = ?/6 (esquerdo) e ? = ?/4 (centro) obtido com o método NLFV-
PP/MOOD, o perfil da solução de referencia esta a esquerda da figura . . . . 103

Figura 38 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = 0 (esquerdo), ? = ?/12 (centro) e ? = ?/8 (esquerda) obtido com o
método, NLFV-PP/FOU . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

Figura 39 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = ?/6 (esquerdo) e ? = ?/4 (centro) obtido com o método NLFV-PP/FOU,
o perfil da solução de referencia esta a esquerda da figura. . . . . . . . . . . 104



Figura 40 – Representação do estêncil para o calculo do fluxo utilizando os pontos harmô-
nicos: figura esquerda é o estêncil do método MPFA-H e da direita é estêncil
usando pelo método MPFA-HD . . . . . . . . . . . . . . . . . . . . . . . . 115



LISTA DE TABELAS

Tabela 1 – Acrônimos dos métodos numéricos utilizados. . . . . . . . . . . . . . . . . 78
Tabela 2 – Erros entre solução exata e a solução numérica. . . . . . . . . . . . . . . . 78
Tabela 3 – Erros e taxas de convergência do campo de pressões. . . . . . . . . . . . . 81
Tabela 4 – Erros e taxas de convergência do campo de velocidades. . . . . . . . . . . . 81
Tabela 5 – Campo pressões máximos e mínimos obtidos pelos diferentes métodos, utili-

zando malha Kershaw quadrilateral. . . . . . . . . . . . . . . . . . . . . . 82
Tabela 6 – Pressões máximos e mínimos obtidos pelos diferentes métodos, utilizando

malha triangular não estruturada. . . . . . . . . . . . . . . . . . . . . . . . 84
Tabela 7 – Pressões máximos e mínimos obtidos pelos diferentes métodos, utilizando

malha triangular não estruturada. . . . . . . . . . . . . . . . . . . . . . . . 85



LISTA DE ABREVIATURAS E SIGLAS

EOR "Enhanced Oil Recovery"

MFE "Mixed Finite Element"

EMPFA "Enriched Multipoint Flux Approximation"

ENO "Essentially Non-Oscillatory"

DG "Discontinuous Galerking"

DMP "Discrete Maximum Principle"

FOU "First Order Upwind"

IFNLFV "Interpoltion Finite Non-Linear Finite Volume"

LPEW "Linearity Preserving Explicit weights"

LED "Local Extremum Diminishing"

MEF Método dos Elementos Finitos

MDF Método das Diferenças Finitas

MOOD "Multidimensional Optimal Order Detection"

MPFA "Multipoint Flux Approximation"

MPFA-HD "Multipoint Flux Approximation with Half-Diamond region"

MPFA-H "Multipoint Flux Approximation using Harmonic Points"

MUSCL "Monotone Upstream Scheme Conservation Laws"

MVF Método dos Volumes Finitos

NLFV-PP "Non Linear Finite Volume that Positive Preserving"

NLFV-DMP "Non Linear Finite Volume that satisfies the Discrete Maximum Principle"

SFV Spectral Finite Volume

TPFA "Two Point Flux Approximation"

TVD "Total Variation Diminishing"

TVB "Total Variation Boundary"

WENO "Weighted Essentially Non-Oscillatory"



LISTA DE SÍMBOLOS

i Subíndice que representa a fase água ou óleo

Si Saturação da fase i = w,o

S?w Saturação prescrita da fase água no poço injetor

S?0w Saturação inicial do reservatório

? Mobilidade

K˜? Permeabilidade absoluta
?w Densidade da fase i = w,o

~vi Velocidade da fase i = w,o

~v Velocidade total

t Tempo

t k Tempo na k-ésima iteração

?t passo de tempo

kro Permeabilidade relativa da fase óleo

krw Permeabilidade relativa da fase água

? Domínio contínuo

µi Viscosidade da fase i = w,o

qi Termo de fonte ou sumidouro i = w,o

ni São exponentes do modelo de Brook-Corey i = w,o

M Razão de mobilidade

?D e ?N Fronteira de Dirichlet e Neumann, respectivamente

~g Vetor aceleração gravitacional

?med Densidade de média

p Campo de pressão

pprod Pressão fornecida no poço produtor



pc Pressão capilar

p? Campo de pressão analítica

pL? Pressão no volume de controle L?

? p Gradiente de pressão

~F Fluxo numérico

~FIJ Fluxo numérico na superfície de controle IJ

~F RoeIJ Fluxo numérico de Upwind na superfície de controle IJ

~F LLFIJ Fluxo numérico de Local Lax Friedrichs na superfície de controle IJ

fw Fluxo fracional da fase água

L? Volume de controle a esquerda da face IJ ou volume de controle arbitrário

R? Volume de controle a direita da face IJ

VL? Volume do volume de controle L?

? L? Contorno do volume de controle L?

M Família finita de volumes de controle

E Família de faces ou superficies de controle do domínio computacional

E int Representa o conjunto de faces interiores do domínio computacional

E ext Representa o conjunto de faces do contorno da malha computacional

xL? Baricentro do volume de controle L?

~V Velocidade de Darcy total

~VIJ Velocidade de Darcy total media na face IJ

~V L?IJ Velocidade media na face IJ correspondente ao volume de controle L?

~NIJ Vetor área normal a face IJ

~nIJ Vetor normal unitário a face IJ

?IJ Mobilidade ponderada na face IJ

wL?,IJ Pesos sobre a face IJ utilizados nos métodos NLFV-PP e MPFA-HD

A˜? Matriz global do sistema discreto



P˜? Vetor de campo de pressão
B˜? Vetor termo de fonte

A˜?IJ Matriz local da face IJ
?i? Pesos correspondentes ao estratégia de interpolação LPEW

F (1)
L?,IJ

e F (2)
L?,IJ

Fluxos parciais, correspondentes ao volume de controle a esquerda L?

yIJ Ponto harmônico

pIJ Pressão no ponto harmônico

AIJ Área ponderada correspondente a face IJ

C Número de Courant

?IJ Velocidade característica na superfície de controle IJ

dL? Grau do polinômio reconstrutor no volume de controle L?

dIJ Grau do polinômio reconstrutor na superfície de controle IJ



SUMÁRIO

1 INTRODUÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
1.1 Motivação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18
1.2 Estado de Arte . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
1.3 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
1.4 Contribuições do Presente Trabalho . . . . . . . . . . . . . . . . . . . 24
1.4.1 Trabalhos Publicados em Artigos de Revista e Congressos . . . . . . . . . 26
1.5 Organização da Tese . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

2 EQUAÇÕES GOVERNANTES . . . . . . . . . . . . . . . . . . . . . 29
2.1 Equação de Conservação de Massa e a Lei de Darcy . . . . . . . . . 29
2.2 Equações de Pressão e Saturação . . . . . . . . . . . . . . . . . . . . 31

3 FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO . . . . 35
3.1 Método de Volumes Finitos Centradas no Volume de Controle . . . 36
3.2 Formulação Numérica Implícita da Equação de Pressão . . . . . . . 39
3.2.1 Método de Volumes Finitos Não Linear que Preserva Positividade (NLFV-PP) 44
3.2.1.1 Tratamento do Fluxo nas Faces de Contorno do Método NLFV-PP . . . . . . . 47
3.2.1.2 Sistema Discreto do Método NLFV-PP . . . . . . . . . . . . . . . . . . . . . 48
3.2.1.3 Estratégia de Interpolação que Preserva Linearidade (LPEW) . . . . . . . . . . 52
3.2.2 Método dos Volumes Finitos Não Ortodoxo tipo MPFA . . . . . . . . . . . 54
3.2.2.1 Tratamento do Fluxo nas Faces de Contorno do Método MPFA-HD . . . . . . 58
3.2.2.2 Sistema Discreto do Método MPFA-HD . . . . . . . . . . . . . . . . . . . . 60
3.2.3 Método dos Volumes Finitos Não Linear que Satisfaz o Princípio do Máximo

Discreto (NLFV-DMP) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
3.2.3.1 Estratégia de Interpolação Utilizando Pontos Harmônicos (HP) . . . . . . . . . 64
3.2.3.2 Tratamento dos Fluxos nas Faces de Contorno do Método NLFV-DMP . . . . 71
3.2.3.3 Sistema Discreto do Método NLFV-DMP . . . . . . . . . . . . . . . . . . . . 74

4 RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO . . 77
4.1 Teste de Linearidade: Escoamento Monofásico com Drenagem Oblí-

qua . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
4.2 Teste de Convergência . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
4.2.1 Escoamento Monofásico num Reservatório Homogêneo Suavemente Aniso-

trópico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
4.3 Teste de Preservar Positividade (PP) e/ou Satisfaz o Principio do

Máximo Discreto (DMP) . . . . . . . . . . . . . . . . . . . . . . . . . 81



4.3.1 Escoamento Monofásico Utilizando Condições de Contorno com Gradiente
Inclinada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

4.3.2 Escoamento Monofásico em Reservatório Muito Heterogêneo e Anisotrópico 84

5 FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO . . 87
5.1 Formulação Numérica Explícita para a Equação de Saturação . . . 87
5.1.1 Problema de Riemann e Método de Godunov . . . . . . . . . . . . . . . . 88
5.1.2 Fluxo Numérico e Resolvedores do Problema de Riemann . . . . . . . . . . 90
5.1.3 Método TVD (Total Variation Diminishing ) . . . . . . . . . . . . . . . . . 92
5.1.4 Formulação Numérica de Alta Ordem tipo MUSCL de Volumes Finitos

(HOMFV) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
5.1.4.1 Processo de Limitação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
5.1.5 Formulação Numérica Multidimensional de Detecção Ótima Ordem (MOOD) 96

6 RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO . . . . . 99
6.1 Escoamento num Reservatório Altamente Heterogêneo . . . . . . . 99
6.2 Escoamento Bifásico num Meio Homogêneo com Três Poços . . . . 101

7 CONCLUSÃO E TRABALHOS FUTUROS . . . . . . . . . . . . . . 105

REFERÊNCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108

APÊNDICE A – MÉTODOS DOS VOLUMES FINITOS LINEAR
UTILIZANDO PONTOS HARMÔNICOS (MPFA-
H) . . . . . . . . . . . . . . . . . . . . . . . . . . . 114



18

1 INTRODUÇÃO

1.1 Motivação
A modelagem do escoamento multifásico e multicomponente de fluidos em reservatórios

de petróleo compreende um conjunto de fenômenos físicos e químicos bastante complexos
e de difícil modelagem física e matemática, assim como numérico-computacional (EWING,
1983; CARVALHO, 2005). Geralmente, as pressões no interior das rochas reservatório são
bastante altas, de tal forma que a simples perfuração de um poço através da rocha reservatório
pode causar a saída espontânea de parte do óleo residente. Este tipo de processo é conhecido
como recuperação primária sendo responsável por baixas recuperações do óleo residente (em
torno de 20 porcento), que persistem até que as pressões no interior da rocha reservatório sejam
insuficientes para posterior expulsão do óleo. A recuperação secundária envolve a injeção de
água por meio de poços injetores, de modo que esta água aumenta a pressão no interior dos
reservatórios, além de promover o varrido do óleo na direção de poços produtores. É importante
lembrar que, apesar da importância da recuperação secundária, grandes quantidades de óleo
podem permanecer no reservatório. Desta forma, todas as técnicas que são utilizadas na tentativa
de retirar o óleo remanescente são conhecidas como técnicas de recuperação terciária ou avançada
(Enhanced Oil Recovey - EOR) (EWING, 1983).

A indústria de “Petróleo e Gás” é um exemplo importante de demanda pelo uso de
modelagem computacional com metodologias robustas e de alto desempenho. No Brasil, com os
desafios associados à exploração do Pré-Sal, ao invés dos arenitos turbidíticos característicos do
Pós-Sal, são encontrados carbonatos microbiais (microbiolitos) e formações de características
muito heterogêneas, praticamente sem parâmetros na história mundial, e cujo comportamento
com respeito à recuperação de petróleo é completamente desconhecido pela indústria, dificul-
tando a utilização de modelos físicos e geológicos adotados em outros reservatórios de petróleo.
Neste contexto, o analista numérico tem de enfrentar problemas associados à presença de ca-
racterísticas geológicas complexas como, por exemplo, falhas selantes, camadas estratificadas
inclinadas, canais, e a existência de poços inclinados que são cada vez mais utilizados na indústria
petrolífera. As falhas geológicas, comuns nos reservatórios de petróleo, podem gerar desconti-
nuidades em propriedades físicas de interesse, tais como porosidade e permeabilidade. Além
do mais, as camadas sedimentares podem se depositar de diferentes modos, gerando múltiplas
direções preferenciais para o escoamento de fluidos. Desta forma, os reservatórios devem ser
tratados como sistemas anisotrópicos fazendo uso de tensores de permeabilidade completos (Full
Tensor), (EDWARDS, 2000; CARVALHO, 2005). Tais características dificultam tanto a análise
matemática, quanto a análise numérica dos processos envolvidos no escoamento de fluidos nas
rochas reservatório (EWING, 1983). A modelagem do escoamento de água, óleo e gás, em



Capítulo 1. INTRODUÇÃO 19

reservatórios de petróleo envolve a solução de um sistema de equações diferencias parciais não-
lineares mais ou menos acopladas (EWING, 1983; CARVALHO, 2005), cuja solução analítica
só é conseguida nos casos mais simples e com geometrias muito simplificadas (HELMIG, 1997).
Portanto, a complexidade das equações governantes exigem técnicas computacionais sofisticados
e formulações numéricas robustas que sejam capazes de tratar adequadamente as características
complexas dos reservatórios de petróleo.

1.2 Estado de Arte
Modernamente, existem, na literatura, diversas formulações numéricas que podem ser

utilizadas para a simulação de fluxo em reservatórios de petróleo. Por exemplo, o tradicional
método de diferenças finitas baseado no volume de controle, também chamado Two Point Flux
Approximation (TPFA), é utilizado para a discretização dos termos de difusão, e o método de
ponderação a montante de primeira ordem, ou First Order Upwind (FOU) que é utilizado para
a discretização do termo de advecção são implementados em vários simuladores comerciais
devido ao baixo custo computacional, simplicidade e robustez em malhas K-ortogonais (ER-
TEKIN, 2001). O uso de tensores completos e/ou malhas não K-ortogonais em métodos TPFA
produzem fluxos aproximados inconsistentes nas superfícies de controle, levando a erros de
primeira ordem (O(1)), esses erros não desaparecem com o refinamento da malha (EDWARDS;
ZHENG, 2008). Segundo Carvalho (2005), as principais desvantagens do método TPFA é sua
incapacidade de produzir soluções convergentes quando o uso de tensores completos ou malhas
não-ortogonais e não-estruturadas, o que adicionalmente dificulta o uso de estratégias automáti-
cas de adaptação de malhas. Para uma modelagem adequada do fluxo em reservatórios muito
heterogêneos e anisotrópicos (AAVATSMARK, 2008; EDWARDS; ROGERS, 1998; QUEIROZ,
2014; CONTRERAS, 2016), numerosos métodos têm sido propostos na literatura. Idealmente
os métodos que aproximam numericamente o operador elíptico de pressão deveriam satisfazer
as seguintes propriedades: (1) conservação local, (2) preservação da positividade da solução
numérica, ou pelo menos o princípio do máximo discreto Discrete Maximum Principle (DMP),
(3) capacidade de lidar com malhas poligonais e distorcidas em geral, (4) produção de soluções
convergentes mesmo com o uso de tensores de permeabilidade completos e, potencialmente,
muito anisotrópicos, (5) capacidade de reproduzir soluções lineares por partes (LP) exatamente
"LP preserving"e (6) possuir acurácia maior que um (O(h)&gt;1) . Até onde sabemos não existe
método numérico que satisfaz todos os requerimentos anteriores simultaneamente (CRUMPTON,
1995; AAVATSMARK, 1998; EDWARDS; ZHENG, 2008; LE POTIER, 2005; LIPNIKOV,
2007; YUAN; SHENG, 2008; SHENG; YUAN, 2011; GAO; WU, 2011; GAO; WU, 2013;
QUEIROZ, 2014). Uma formulação bastante robusta e utilizada na literatura é o método dos
Elementos Finitos (MEF), formulado originalmente por Raviart e Thomas, neste método, pres-
sões e velocidades são variáveis incógnitas primárias de tal maneira que os fluxos são obtidas
mais acuradas, utilizando técnicas Eulerianas ou Lagrangeanas como, Front Tracking ou Level



Capítulo 1. INTRODUÇÃO 20

Set Method (CARVALHO, 2005). Em meados dos anos noventa surgiu uma nova família de
métodos localmente conservativos capazes de lidar com tensores de difusão completos e malhas
não estruturadas e não-ortogonais: o método Multi-Point Flux Approximation (MPFA) inspirados
no trabalho de Crumpton, Shaw e Ware (1995), Aavatsmark, Barkve, Bøe e Mannseth (1998),
Edwards e Rogers (1998). Duas características fundamentais do método MPFA são: (a) aproxi-
mação dos fluxos nas superfícies de controle são calculados utilizando múltiplos pontos e (b) a
imposição da continuidade dos fluxos nas superfícies de controle. Embora, o clássico método
MPFA satisfaça boa parte das propriedades de um método numérico ideal, ainda assim, todas as
versões lineares do mesmo violam o princípio do máximo discreto (LIPNIKOV, 2007; GAO;
WU, 2013), nesse caso oscilações espúrias podem-se perceber nos resultados, isso implica que
o método MPFA ainda tem dificuldade de lidar com meios onde o tensor possui elevada razão
de anisotropia e/ou malhas severamente distorcidas. A análise de monotonicidade do método
MPFA começou com Eigestad e Klausen (2005) que propõe modificar os volumes de controle
do MPFA a fim de tornar o sistema, uma Matriz-M e garantir a monotonicidade das soluções
numéricas. Mais tarde, o método Enriched Multipoint Flux Approximation (EMPFA) formulado
por Chen, Wan, Yang e Mifflin (2008) nasceu como uma alternativa de solução aos problemas
de monotonicidade a partir da constatação de que as oscilações espúrias estão associadas com
a aproximação pobre do gradiente de pressão nas superfícies de controle. O EMPFA produz
resultados quase não oscilatórios para meios altamente heterogêneos e anisotrópicos. A aparente
robustez obtida com as formulações mencionadas acima não tem sido a solução definitiva para
problemas verdadeiramente desafiadores. Este fato sugere o uso de formulações numéricas mais
robustas com expressões para os fluxos que representem adequadamente as heterogeneidades e a
anisotropia dos reservatórios. Diante disso, vários autores (LE POTIER, 2005; LIPNIKOV, 2007;
YUAN; SHENG, 2008; GAO; WU, 2013) propõem formulações numéricas que, preferencial-
mente, devem satisfazer a maioria das propriedades mencionadas anteriormente. É importante
ressaltar que em casos lineares, o requerimento de monotonicidade é equivalente a atender o
critério de DMP (SHENG; YUAN, 2011). Embora, para o caso geral, o critério de DMP é
mais restritivo que o critério de monotonicidade (SHENG; YUAN, 2011; GAO; WU, 2013).
No contexto da simulação de reservatórios de petróleo, a incapacidade de satisfazer o DMP ou
produzir soluções monótonas, implica em se obter soluções com oscilações espúrias no campo
de pressões que podem representar, por exemplo, o aparecimento de gás “fictício” em regiões do
reservatório onde a pressão cai erroneamente abaixo do ponto de bolha ou campos de velocidades
de Darcy sem significado físico algum (QUEIROZ, 2014). Atualmente configura-se como um
desafio na área de simulação numérica de reservatórios, formular métodos que possa satisfazer
simultaneamente, todas as propriedades citadas acima. Recentemente, diferentes métodos não
lineares fundamentados no método de volumes finitos foram propostos, a partir do trabalho
pioneiro de Le Potier (2005). A principal ideia desses métodos, com operador elíptico discreto
não-linear, é aproximar o gradiente de pressões usando uma formulação numérica cujos coefici-
entes são dependentes da própria variável a ser calculada. Como em todo método de volumes



Capítulo 1. INTRODUÇÃO 21

finitos, a definição desses coeficientes é fundamentada na imposição de continuidade de fluxo
nas superfícies de controle. Variáveis auxiliares, localizadas, por exemplo, no ponto médio de
cada superfície de controle e nos vértices que definem essa superfície de controle têm seu valor
interpolado a partir de uma combinação linear das incógnitas centradas nos volumes de controle
que concorrem nesses vértices. No trabalho original de Le Potier (2005), estes métodos são
restritos somente a malhas triangulares. A posição dos pontos de colocação em cada volume de
controle segue uma métrica fundamental para a obtenção da positividade dos coeficientes. Além
disso, os pesos das interpolações empregadas pelos referidos autores são caracterizados pela
positividade dos coeficientes, necessária para produzir soluções monótonas. Um efeito colateral
disso é a suavização exagerada no campo de solução em regiões de descontinuidade do campo
de permeabilidade, tal como observado em Queiroz, Souza, Contreras, Lyra e Carvalho (2014).
A aplicação dos métodos não lineares propostos por Le Potier (2005) e Lipnikov, Shashkov,
Svyatskiy e Vassilevski (2007) em problemas muito heterogêneos ou em malhas severamente
distorcidas, produz soluções de baixa acurácia, dada a deficiência das estratégias de interpolação
consideradas. Lipnikov, Svyatskiy e Vassilevski (2009), propuseram uma variante dos métodos
de volumes finitos não lineares monótonos, chamada pelos autores de “livre de interpolação”
(Interpolation Free Non-Linear Finite Volume). Segundo estes autores, e de maneira um tanto
quanto óbvia, a escolha da estratégia de interpolação afeta fortemente a acurácia do método
numérico utilizada na discretização do operador elíptico de pressão. De qualquer modo, fica
claro neste trabalho, que a escolha do melhor método de interpolação depende fortemente do
problema sendo tratado. Os autores mostraram que o IFNLFV era capaz de lidar com malhas
poligonais quaisquer além de ser mais acurado e mais eficiente computacionalmente que os
métodos até então desenvolvidos, apesar de ainda existirem algumas restrições fortes impostas
no tensor de permeabilidades. Há na literatura trabalhos sobre formulações não lineares que
preservam o critério DMP, por exemplo, o método não linear de (LIPNIKOV, 2012) que satisfaz
o critério de DMP. Neste método os pontos de interpolação são baseaidas nos pontos harmônicos
(AGÉLAS, 2009), onde os pesos de interpolação preservam positividade naturalmente por cons-
trução. Baseado nos trabalhos de Le Potier (2005), Lipnikov, Shashkov, Svyatskiy e Vassilevski
(2007), Yuan e Sheng (2008) introduzem um método não linear, capaz de produzir soluções
monótonas mesmo considerando meios altamente anisotrópico ou malhas poligonais em geral.
Neste método, as variáveis primárias estão localizadas nos baricentros do volume de controle e
os pontos de interpolação são os vértices da malha primal. Os pesos de interpolação são obtidos
a partir da solução de um sistema de equações locais associadas a um problema auxiliar de
conservação. A estratégia de interpolação utilizada possui erro de truncamento de segunda ordem
no espaço. Quando os pesos de interpolação não preservam a positividade, utiliza-se alguma
estratégia de interpolação com coeficientes positivos, como, por exemplo, a interpolação com
o inverso da distância. Em Sheng e Yuan (2011) foi apresentado um método não linear que
satisfaz o critério DMP sobre malhas poligonais bastante arbitrárias. Neste trabalho, o ponto
de interpolação é o ponto médio da face, os pesos da interpolação são calculados impondo



Capítulo 1. INTRODUÇÃO 22

a continuidade de fluxo nas superfícies de controle e, sendo obtidos em função das variáveis
primárias adjacentes a superfície de controle em questão. Essa estratégia de interpolação é mais
robusta do que as utilizadas por Le Potier (2005), Lipnikov, Shashkov, Svyatskiy e Vassilevski
(2007). As soluções produzidas por este método mantêm a acurácia, mesmo em meios muito
heterogêneos e anisotrópicos e para malhas distorcidas. Sheng e Yuan (2012) propõem um
método melhorado de volumes finitos não linear, cuja estratégia de interpolação se baseia no
método linear MPFA-O (AAVATSMARK, 1998; EDWARDS; ROGERS, 1998). Este método não
linear produz resultados bastante robustos e acurados mesmo que os coeficientes de interpolação
sejam negativos. No trabalho de Gao e Wu (2013) foi proposto um esquema numérico não
linear e que satisfaz o critério DMP. Os pontos de interpolação são os pontos harmônicos, cuja
construção é muito similar aos métodos clássicos introduzidos por Le Potier (2005), Lipnikov,
Shashkov, Svyatskiy e Vassilevski (2007). Os autores provam a estabilidade do método, que, em
geral, não é discutida em outras publicações anteriores. Este método é capaz de lidar com meios
heterogêneos e anisotrópicos. Os autores também observam, como única restrição, que, quando
o ponto harmônico não pertence à face avaliada ou quando não existem os eixos auxiliares que
contenham a sua co-normal, nem sempre é garantida a satisfação do critério DMP. Nos trabalhos
de Wu e Gao (2014), Gao e Wu (2015), os pontos de interpolação são os pontos harmônicos
ou os vértices. Na estratégia de interpolação dos vértices, o método de interpolação LPEW-M
(Linearity preserving with explicit weights - modified) é utilizada. Essa estratégia de interpolação
é bastante robusta e se mostra capaz de lidar com meios anisotrópicos e malhas poligonais em
geral.

Para discretizar a equação de saturação o método utilizado em vários simuladores
comerciais é o método de ponderação a montante de primeira ordem ou First Order Upwind
(FOU), este método caracteriza-se por produzir soluções não oscilatórias perto das regiões de
choque (HIRSCH, 1990). A desvantagem do método FOU é que este produz soluções com
excessiva difusão numérica, característica natural de métodos de primeira ordem, além disso,
é sensível a efeito de orientação de malhas quando o razão de mobilidade é bastante adversa
(KEILEGAVLEN, 2012), essas desvantagem podem causar predições totalmente errôneas sobre
o comportamento de variáveis de interesse, como o tempo de irrupção de água nos poços
produtores ou a produção acumulada de óleo. Para melhorar essas desvantagens do método FOU
precisamos utilizar métodos de ordem mais alta e multidimensionais. Para resolver a equação
de saturação não-linear com melhor precisão são propostas diferentes estratégias. Por exemplo,
o método MUSCL (Monotone Upstream Centered Scheme for Conservation Laws) de Van
Leer (1979) baseado nos trabalhos de Gudonov, Engquist, Osher e Roe usando o critério de
TVD (total variation diminishing) pode ser utilizado para resolver numericamente a equação de
saturação (BELL; SHUBIN, 1985; DURLOFSKY, 1993; EDWARDS, 1996; EDWARDS, 2006;
CONTRERAS, 2016). Neste método, a precisão de segunda ordem é obtida por um processo
de reconstrução linear local, e os extremos locais associados a fortes gradientes de solução são
eliminados por um procedimento de limitação a priori, vários tipos de limitadores são propostos



Capítulo 1. INTRODUÇÃO 23

na literatura (VAN LEER, 1979; SWEBY, 1984). Este método pode ser adaptado para malhas não
estruturadas de uma forma muito robusta (WOODFIELD, 2004; CONTRERAS, 2016). Variantes
dos métodos de alta ordem foram introduzidos por Osher-Shu e Harten: ENO (Essentially Non
Oscilatory), WENO (Weighted Essentially non oscilatory), respectivamente. Os métodos ENO
e o WENO são métodos essencialmente não oscilatórios, ou seja, que não precisam utilizar
limitadores, mas a reconstrução polinomial da variável primaria precisa de um estêncil estendido
a cada passo de tempo, implicando utilizar técnicas de extrapolação, tornando ao método custoso
do ponto de vista computacionalmente. O esquema DG (Discontinuous-Galerkin) é um método
de alta ordem capaz de ser adaptado para malhas poligonais em geral. Este método tem a
característica de ser local e de exigir o cálculo de integrais de volume e de superfície o que pode
ser computacionalmente custoso. Outros métodos mais recentes incluem o método de volumes
finitos espectrais (Spectral Finite Volume-SFV) proposto por (WANG, 2002; CHOI, 2004) e
recentemente aplicado na simulação de escoamentos bifásicos de água e óleo em reservatórios de
petróleo na versão unidimensional por Ramirez, Souza, Carvalho e Lyra (2013). No contexto de
simulação numérica de reservatórios de petróleo, Rubin e Blunt em 1991, introduzem métodos de
alta ordem do tipo TVD em 1-D. Durlofsky, Engquist e Osher (1992) introduze um método de alta
ordem tipo TVD baseado na formulação MUSCL; qual é aplicado em malhas não-estruturadas.
Em geral este método utiliza um procedimento de interpolação de fluxo adaptativo para alcançar
ordem superior. Seguindo o trabalho anterior Durlofsky (1993) introduz um método de alta
ordem para resolver a equação de saturação incluindo os efeitos de gravidade, pressão capilar
e a compressibilidade, utilizando malhas triangulares. Utilizando o MEF para o cálculo dos
campos de pressões e de velocidades. Pouco depois Edwards (1996) publicou um método de
alta ordem no contexto de simulação numérica de reservatórios onde o método de alta ordem
de Godunov é acoplado com um processo de refinamento local. Posteriormente, (EDWARDS;
ZHENG, 2008), o mesmo autor acopla o método de alta ordem ao método MPFA. Os resultados
mostram uma leve melhoria em reduzir o efeito de orientação de malha. Lamine e Edwards
(2010) propuseram, também para a equação de saturação, um esquema de alta ordem com
características de multidimensionalidade. Tendo inspiração no trabalho de Colella (1990), o
referido esquema tem estêncil definido de acordo com a orientação da direção característica
do problema. Dessa forma, os resultados produzidos sofrem menos influência de orientação da
malha quando se compara aos métodos de alta ordem tradicional, baseados apenas na avaliação
do sinal da velocidade em cada superfície de controle. No contexto de reduzir o efeito de
orientação de malhas (GOE), vários trabalhos foram propostos na literatura desde 1972, (TODD,
1972; KO; AU, 1979; YANOSIK; MCCRACKEN, 1979; BAJOR; CORMACK, 1989; BRAND,
1991; HURTADO, 2007; KOZDON, 2011; EYMARD, 2011; LAMINE; EDWARDS, 2013).



Capítulo 1. INTRODUÇÃO 24

1.3 Objetivos
Estudar, formular e implementar formulações numéricas robustas para simular o es-

coamento monofásico e bifásico de água e óleo em reservatórios de petróleo heterogêneos e
anisotrópicos utilizando malhas não-estruturadas em 2-D. Para atingir nosso objetivo vamos
enumerar nossos objetivos específicos nas seguintes item:

• Desenvolver e implementar métodos de volumes finitos lineares do tipo MPFA para a
solução aproximada do problema elíptico de pressão.

• Desenvolver e implementar métodos de volumes finitos não-lineares (monótonos ou que
satisfaçam o DMP) para a solução aproximada do problema elíptico de pressão.

• Desenvolver e implementar métodos de alta ordem e multidimensionais para a solução do
problema de saturação.

• Após implementar as formulações numéricas avaliar a acurácia e robustez das mesmas,
quando comparadas com outras formulações encontradas na literatura.

1.4 Contribuições do Presente Trabalho
No presente trabalho para resolver o operador elíptico característico da equação de

pressão propormos métodos de volumes finitos lineares e não lineares. O método de volumes
finitos não linear que preserva positividade (NLFV-PP) foi essencialmente inspirado nos trabalhos
de Lipnikov, Shashkov, Svyatskiy e Vassilevski (2007), Yuan e Sheng (2008), Queiroz, Souza,
Contreras, Lyra e Carvalho (2014), utilizando uma estratégia de interpolação LPEW proposto
por Gao e Wu (2011). Neste método, as variáveis auxiliares são centrados nos vértices da
malha primal e a estratégia de interpolação adotada é bastante robustos e capazes de representar
adequadamente reservatórios com tensores de permeabilidade heterogêneos e potencialmente
descontínuos, ou meios altamente anisotrópicos (QUEIROZ, 2014; GAO; WU, 2011). Além
disso, para calcular os pesos de interpolação, não precisamos resolver sistemas locais de equações
como em outros métodos de interpolação (AAVATSMARK, 1998). Os possíveis pesos negativos
gerados pela estratégia de interpolação (LPEW), não afeta a acurácia nem a robustez do método
podendo produzir soluções com taxas de convergência de segunda ordem para o campo de pressão
mesmo em malhas distorcidas ou em reservatórios altamente heterogêneos e anisotrópicos.
Por outro lado, propormos um método de volumes finitos não linear que satisfaz o critério do
princípio do máximo discreto (NLFV-DMP), este método foi inspirado nos trabalhos de Sheng e
Yuan (2011), Gao e Wu (2013). Segundo Sheng e Yuan (2011), o critério DMP é más restrito que
o critério de monotonicidade, embora em problemas lineares estes dois critérios coincidem. No
presente método, os pontos de interpolação são localizadas sobre as superfícies de controle, e são
chamados como pontos harmônicos inicialmente proposto por Agélas, Eymard e Herbin (2009),



Capítulo 1. INTRODUÇÃO 25

as variáveis auxiliares centrado nos pontos harmônicos são interpolados como combinação
convexa das pressões centradas nos volumes de controle adjacentes ao superfície de controle em
questão. A utilização destes pontos harmônicos como estratégia de interpolação é vantajoso já
que pela mesma construção preserva a positividade, melhora a robustez do método em problemas
heterogêneos e anisotrópicos, além disso, permite que o método possua um estêncil reduzido em
comparação com outros métodos clássicos propostos por Bertolazzi e Manzini (2005), Le Potier
(2009) e Sheng e Yuan (2011). O principal algoritmo de nosso método foi adaptado de Sheng e
Yuan (2011), em quanto a montagem do sistema discreto foi adotado de Gao e Wu (2013).
Como consequência dos métodos de volumes finitos não lineares NLFV-PP e NLFV-DMP, nós
propusemos ainda dois métodos de volumes finitos lineares, a saber: método de aproximação do
fluxo por multiplos pontos utilizando uma região Half Diamond (MPFA-HD) e outro método
de aproximação do fluxo multiplos pontos utilizando pontos harmônicos (MPFA-H). O método
MPFA-HD foi obtido a partir de modificar os diversos procedimentos numéricos do método
NLFV-PP, como o objetivo de obter um método capaz de produzir soluções aproximadas mas
acuradas para os fluxos, considerando tensores de permeabilidade heterogêneos e anisotrópicos,
possivelmente descontínuos, mesmo para malhas poligonais distorcidas e não estruturadas. Em
contraste com o método MPFA clássico (AAVATSMARK, 1998; EDWARDS; ROGERS, 1998),
no nosso método MPFA-HD, o fluxo em cada superfície de controle (SC) é explicitamente
expresso por incógnitas definidas nos volumes de controle que compartilham essa SC em questão
e dois pontos auxiliares definidos nas extremidades da SC que não necessariamente pertencem à
mesma SC em questão. Como desejamos um método completamente centrado nos volumes de
controle, as variáveis auxiliares centrados nos vértices são interpolados utilizando a estratégia de
interpolação LPEW.
Inspirado nos métodos propostos por Lipnikov, Shashkov, Svyatskiy e Vassilevski (2007), Yuan
e Sheng (2008), Queiroz, Souza, Contreras, Lyra e Carvalho (2014), (GAO; WU, 2014) propoe
um método linear que aproxima o fluxo por multiplospontos utilizando os pontos harmônicos
(MPFA-H). Este método inicialmente foi proposto para resolver problemas de difusão em meios
levemente heterogêneos e anisotrópicos, no presente trabalho nós utilizamos o método MPFA-H
para simular escoamentos bifásicos em reservatórios de petróleo. Neste método, os autores
recomendam primeiro construir os fluxos laterais em cada superfície de controle de forma
independente, logo uma expressão de fluxo único é obtida por uma combinação convexa de
fluxos laterais. Diferentemente de outros métodos MPFA clássicos, neste método, os fluxos
em cada SC são explicitamente expressos pelas incógnitas centradas no volume de controle e
pelas variáveis auxiliares definidos nas SC que não necessariamente pertencem à mesma SC
compartilhada pelos volumes de controle adjacentes.
Para resolver numericamente a equação de saturação, adotamos uma estratégia inicialmente
proposto por Clain, Diot e Loubere (2011) nomeado Multidimensional Optimal Order Detection
(MOOD), que foi originalmente desenvolvido para aplicações de hidrodinâmica e atualmente
aplicado em varias áreas de engenharia. Este método é radicalmente diferente dos métodos



Capítulo 1. INTRODUÇÃO 26

tradicionais de alta ordem descrito no estado de arte, uma vez que se baseia num procedimento de
limitação a posteriori. Em resumo, o esquema MOOD consiste em determinar uma reconstrução
de grau polinomial ótimo para cada volume de controle a cada passo de tempo, satisfazendo
alguma restrição física, por exemplo, o principio do máximo discreto (DMP). Em seguida, a
solução candidata em todos os volumes de controle é rigorosamente analisada pelos critérios
físicos. Sempre que os critérios físicos são violados no volume de controle, este último é
qualificado como um volume controle "ruim"e esta solução é descartada automaticamente e
o grau do polinômio é diminuído até que a restrição física seja satisfeita só naquele volume
de controle "ruim". Este esquema de alta resolução é relativamente simples, muito eficiente e
preciso, produzindo soluções de natureza multidimensional, sendo muito competitivo com outros
encontrados na literatura.

As equações que descrevem o escoamento bifásico óleo-água são resolvidas usando
a metodologia Implicit Pressure and Explicit Saturation (IMPES). Nesta técnica IMPES, as
equações de fluxo e de transporte são resolvidas de maneira segregada e sequencial de modo
que o campo de pressões é resolvido de maneira implícita a partir de uma saturação inicial. Daí
obtemos as vazões ou velocidades nas superfícies de controle e, assim, o campo de saturação é
calculado explicitamente, este procedimento é repetido até o alcance do tempo final de simulação.
Os programas acadêmicos foram construídos no ambiente MATLAB, fazendo uso de uma série
de vantagens da sua estrutura de dados e na realização de operações algébricas vetorizadas.

1.4.1 Trabalhos Publicados em Artigos de Revista e Congressos

Como consequência direta da nossa pesquisa durante o doutoramento temos escrito os
seguintes artigos publicados em revistas, congressos e conferencias internacionais, a saber:

Artigos Publicados em Revista

• A Higher Resolution Flow Oriented Scheme Coupled with the Robust MPFA-Half-Diamond
Applied for the Solution of Two-Phase Flows in Heterogeneous and Anisotropic Petroleum

Reservoirs (em preparação, 2017).

• A cell-centered multipoint flux approximation method with a diamond stencil coupled
with a higher order finite volume method for the simulation of oil–water displacements in

heterogeneous and anisotropic petroleum reservoirs, publicado na revista Computers and
Fluid -2016.

• On the accuracy of a nonlinear finite volume method for the solution of diffusion pro-
blems using different interpolations strategies, publicado na revista International Journal
Numerical Methods in Fluids -2013.



Capítulo 1. INTRODUÇÃO 27

Artigos Publicados em Congressos e Conferências Mundiais

• A Non-Orthodox MPFA Method Coupled to a High Order Modified Flow Oriented Scheme
for the Simulation of Two-Phase Flows in Heterogeneous and Anisotropic Reservoirs,

(SPE Reservoir Simulation Conference in Montgomery, Texas, USA, 2017). Aceito para
Fevereiro 2017.

• A MPFA method using harmonic points coupled to a multidimensional optimal order
detection method (MOOD) for the simulation of oil-water displacements in petroleum

reservoirs, publicado em XXXVII Iberian Latin American Congress on Computational
Methods in Engineering, CILAMCE 2016.

• A MPFA-Diamond Method Coupled to a Very Higher Order Multidimensional Upstream
Scheme for the Solution of Two-Phase Flows in Heterogeneous and Non-Isotropic Petro-

leum Reservoirs, publicado em 1st Pan-american Congress on Computational Mechanics,
Buenos Aires, Argentina, 2015.

• A High Resolution Finite Volume Method for the Simulation of Oil-Water Displacements in
Anisotropic and Heterogeneous Petroleum Reservoirs Using a Multidimensional Limiting

Process, publicado em SIAM, Conference Mathematical and Computational Issues in the
Geosciences, Stanford, California, USA, 2015.

• Numerical simulation of fluid flows in petroleum reservoirs using a cell centered non-linear
finite volume method in unstructured polygonal meshes, publicado em XXXVI Iberian
Latin American Congress on Computational Methods in Engineering, CILAMCE 2015.

• A Higher-order Multidimensional Upstream Scheme for the Simulation of Two-Phase Flows in
Porous Media, publicado em World Congress Computational Mechanics, Barcelona, Spain,
WCCM 2014.

• Numerical simulation in heterogeneous and anisotropic oil reservoirs using a MPFA-D
method coupled with a multidimensional upstream scheme, publicado em XXXV Iberian
Latin American Congress on Computational Methods in Engineering, CILAMCE 2014.

• Numerical simulation in heterogeneous and anisotropic oil reservoir using a finite volu-
men method, publicado em XXXIV Iberian Latin American Congress on Computational
Methods in Engineering - CILAMCE 2013.

• A cell-centered finite volume method for the simulation of two-phase flows in heterogeneous
and anisotropic oil reservoirs, publicado em 22nd International Congress of Mechanical
Engineering, COBEM 2013.



Capítulo 1. INTRODUÇÃO 28

1.5 Organização da Tese
Dividimos a presente tese principalmente em sete capítulos, além da referência bibliográ-

fica e de um apêndice. No Capítulo 1 consideramos a introdução onde detalhamos a motivação,
estado de arte, objetivos e contribuições do trabalho.

No Capítulo 2, detalhamos brevemente as propriedades da rocha e fluido, em seguida
descrevemos as equações constitutivas e suas hipóteses simplificadoras, que finalmente são
utilizadas para derivar as equações governantes, a saber: a equação de pressão e a equação de
saturação.

No Capítulo 3, desenvolvemos as técnicas numéricas empregadas na solução das equa-
ções governantes introduzidas no Capítulo 2. Primeiramente descrevemos as varias formulações
numéricas utilizadas para discretizar a equação de pressão: nesta seção introduzimos a descrição
de métodos de volumes finitos lineares (MPFA-HD e MPFA-H) e não lineares (NLFV-PP e
NLFV-DMP).

No Capítulo 4, resolvemos alguns problemas benchmark, com o objetivo de validar
nossas formulações numéricas propostas. Os resultados são interpretados e comparados com
outros métodos clássicos disponíveis na literatura. Neste, capítulo resolvemos problemas re-
lacionados com escoamento monofásico, e analisamos as propriedades numéricas que devem
satisfazer nossas formulações numéricas, por exemplo, a linearidade, satisfazer o critério de
monotonicidadeo e/ou princípio de máximo discreto.

No Capítulo 5, desenvolvemos as formulações numéricas que discretizam a equação de
saturação, neste capítulo dois método são descritos de maneira mas detalhada, a saber o método
de alta ordem tipo MUSCL (HOFMV) com um processo de limitação a priori e um método de
alta ordem multidimensional (MOOD) com um processo de limitação a posteriori.

No Capítulo 6, resolvemos alguns problemas benchmark envolvendo escoamento bifásico
óleo-água. Neste capitulo, avaliamos a robustez das formulações propostas (HOMFV e MOOD)
utilizando malhas poligonais em geral e meios altamente heterogêneos e anisotrópicos, além
disso, analisamos o fenômeno de efeito de orientação de malha (GOE) com alta razão de
mobilidade.

No Capítulo 7, descrevemos, as conclusões e indicamos os trabalhos futuros.
Finalmente apresentamos um apêndice: No apêndice A, descrevemos um método multi-

dimensional com estêncil tipo MPFA proposto por Eymard, Guichard e Masson (2011), para
malhas quadrilaterais ortogonais.



29

2 EQUAÇÕES GOVERNANTES

Neste capítulo, discutimos brevemente o conjunto das equações que governam a dinâmica
dos fluidos no interior dos reservatórios. Essas equações são derivadas a partir da equação de
Conservação de Massa e a Lei de Darcy generalizada, considerando as seguintes hipóteses sim-
plificadoras: os fluidos são Newtonianos e incompressíveis, o meio poroso é rígido, não existem
reações químicas entre os fluidos e a rocha porosa, o escoamento é laminar e a permeabilidade
absoluta é uma propriedade do meio poroso que é independente da pressão, da temperatura e do
escoamento. Além disso, são desprezados os efeitos de Klinkenberg e electrocinéticos, assim
como os efeitos de capilaridade (ERTEKIN, 2001; CARVALHO, 2005). Um modelo matemático
que rege o escoamento bifásico (óleo-água) em meios porosos é composto por duas equações
sendo uma equação elíptica (de pressão) e uma equação hiperbólica (de saturação), cujo aco-
plamento é feito através da velocidade de Darcy. Estas equações deverão estar munidas com as
respectivas condições de contorno e/ou iniciais adequadas, as quais dependem das características
geológicas da vizinhança do reservatório e da existência de poços produtores e injetores.

2.1 Equação de Conservação de Massa e a Lei de Darcy
A equação de Conservação de Massa para escoamento bifásico imiscível óleo (o)-

água (w) é definido sobre o domínio ?× [0,t]. Essa equação é desenvolvida a partir de uma
aproximação Euleriana da equação de balanço sobre um volume de controle arbitrário que, após
manipulações algébricas (CHEN, 2006), podemos expressar na forma diferencial como:

? (? ?iSi)
? t

=?? ·(?i~vi)+ qi, i = w,o em ?×[0,t] (2.1)

aqui, a porosidade é denotada por ? . por outro lado, na equação (2.1) ?i representa a densidade
da fase i e a fração de volume poroso ocupado pela fase i é representada por Si. Finalmente qi é
o termo de fonte ou sumidouro, que, no presente contexto pode representar poços produtores ou
injetores. Para modelar a velocidade do fluido no interior da rocha utilizamos a velocidade de
Darcy denotada, para uma fase i, por ~vi. Assumimos ainda que a rocha reservatório é totalmente
saturada pelas fases óleo e água, de modo que:

So + Sw = 1 (2.2)

A Lei de Darcy afirma que a taxa volumétrica do escoamento no meio poroso é linearmente
proporcional ao gradiente de pressão e a uma área transversal normal à direção do fluido, e



Capítulo 2. EQUAÇÕES GOVERNANTES 30

inversamente proporcional a viscosidade do fluido (EWING, 1983). Dessa forma podemos definir
a velocidade de Darcy (equação (2.1)) através da seguinte equação:

~vi =??iK˜(? pi ??i~g) com ?i = kri/µi, i = w,o em ? (2.3)
onde ?i, kri, µi e ~g são, respectivamente, a mobilidade, a permeabilidade relativa, a viscosidade
da fase i e o vetor gravidade.

Na equação (2.3) K˜ representa o tensor de permeabilidade do meio poroso que é dado
pelo seguinte tensor:

K˜ =
[

k11 k12
k21 k22

]
(2.4)

A permeabilidade é uma propriedade intrínseca da rocha que foi introduzida na Lei de Darcy
para quantificar a capacidade da rocha de transmitir fluidos. Do ponto de vista matemático, este
tensor, além de ser simétrico, deve satisfazer as condições de elipticidade, ou seja, k11k22 ? k212
(CRUMPTON, 1995; EDWARDS; ROGERS, 1998; AAVATSMARK, 1998).

A permeabilidade relativa (kri) dada na equação (2.3) é uma medida adimensional da
facilidade com que uma fase do fluido pode escoar na rocha porosa em presença de outras fases.
Um modelo muito utilizado na literatura é o de Brook e Corey (HELMIG, 1997), dado pela
seguinte expressão:

krw =
(

Sw ?Swi
1?Swi ?Sor

)nw
e kro =

(
1?Sw ?Sor
1?Swi ?Sor

)no
(2.5)

onde Swi é a saturação irredutível da fase água e Sor é saturação residual da fase óleo, e os
expoentes nw e no podem assumir valores diferentes (AZIZ; SETTARI, 1979; HELMIG, 1997).
Existem outros modelos como o de van Genuchten que também podem ser utilizados em
problemas que envolvem escoamentos multifásicos em meios porosos (SOUZA, 2015 apud
BASTIAN, 2003) e (SOUZA, 2015 apud FUCÍK, 2005).

Em problemas tipo pistão (piston-like), Yanosik e McCracken (1979) propuseram as
seguintes relações para calcular as permeabilidades relativas:

krw =
S2w

M(1?S2w)+ S2w
, kro = 1?krw e M =

?w

?o
(2.6)

onde M é a razão das mobilidades.



Capítulo 2. EQUAÇÕES GOVERNANTES 31

2.2 Equações de Pressão e Saturação
Utilizando as equações(2.1)-(2.3) e através de manipulações algébricas adequadas (AZIZ;

SETTARI, 1979; EWING, 1983; HELMIG, 1997; CHEN, 2007) a equação de pressão global
para escoamento bifásico é dada pela seguinte equação:

? ·~v = Q com ~v =?? K˜ (? p + ?med~g) (2.7)
onde ? p e ~v = ~vw +~vo representam o gradiente de pressão e a velocidade total do fluido,
respectivamente. A mobilidade total e a vazão volumétrica total, são denotados por ? e Q =
Qw + Qo com Qi = qi/?i, respectivamente. Além disso, ?med representa a densidade média,
ponderada pelas mobilidades (HURTADO, 2011), ou seja:

?med =
?w?w + ?o?o

?
com ? = ?w + ?o (2.8)

Um caso particular da equação (2.7) obtêm-se assumindo que os efeitos gravitacionais
são desprezíveis e que o reservatório esta saturado apenas por uma fase, implicando que a
mobilidade total é unitária (CARVALHO, 2005; SOUZA, 2015). Dessa forma, desprezando o
efeito gravitacional, podemos escrever a equação que modela o escoamento monofásico num
reservatório, como:

?? ·(K˜? p) = Q em ? (2.9)
No contexto de simulação de reservatórios, além das condições de contorno tradicionais,

podemos falar nas condições de contorno internas que podem representar poços produtores e/ou
injetores. A vazão do fluido injetado (Qin j) nos poços injetores é equivalente a condição de
contorno de Neumann, da mesma forma que a pressão (Pprod ) nos poços produtores ou injetores
é equivalente a condição de contorno de Dirichlet. No caso de toda a fronteira ser impermeável,
ou seja, contorno com fluxo nulo, a entrada e a saída de massa somente ocorre através dos
poços injetores e produtores. O contorno do domínio ? é representado por ? ?, que pode ser
considerado como a união disjunta dos diferentes tipos de contorno

? ? = ?D ??N ??in j ??prod (2.10)

onde ?in j e ?prod representam os poços injetores e os poços produtores, respectivamente (vide
Figura 1).

As condições de contorno para a equação de pressão em um reservatório são dadas por:??
?p(~x,t) = gD, em ?D~v ·~n = gN, em ?N (2.11)



Capítulo 2. EQUAÇÕES GOVERNANTES 32

Figura 1 – Domínio computacional identificando os poços injetores, produtores e os contornos
de Dirichlet (?D) e Neumann (?N )

Fonte – Produzido pelo autor

ou ??
?~v·~n = Qin j, em ?in jp(~x,t) = Pprod, em ?prod (2.12)

onde ~n é o vetor área normal unitária, gD representa a pressão prescrita no contorno de Dirichlet
e gN é o fluxo prescrito no contorno de Neumann.

A equação de saturação é obtida a partir da equação (2.3), onde as velocidades ~vw e ~vo
são multiplicadas por ?o e ?w, respectivamente. E após manipulações algébricas temos a seguinte
equação:

~vw =
?w

?
~v +

?w?o

?
K˜ (? pc +(?w ??o)~g) (2.13)

onde a pressão capilar é denotado por pc = po ? pw.
Uma vez que pressão capilar é desprezada, a equação (2.13) é substituída na equação

de conservação de massa (2.1) quando consideramos a fase água (? = w), e após manipulações
algébricas, obtêm-se:

?
? Sw
? t

=?? ·~F(Sw)+ Qw em ?×[0,t] (2.14)

Na equação anterior a função fluxo hiperbólico ~F(Sw) é definido por:

~F(Sw) = fw(Sw)~v + fw(Sw)?oK˜ (?w ??o)~g (2.15)
onde fw(Sw) = ?w/? é o fluxo fracional da fase água, que representa a fração de massa da fase
molhante no meio poroso. A equação (2.14) caracteriza-se por ser uma equação hiperbólica não
linear (AZIZ; SETTARI, 1979; EWING, 1983; HELMIG, 1997; CHEN, 2007).



Capítulo 2. EQUAÇÕES GOVERNANTES 33

Com base na equação de saturação podemos obter um modelo simplificado unidimensio-
nal denominado Modelo de Buckley-Leverett. Esse modelo é obtido considerando que a razão
de mobilidade é unitária e o tensor de permeabilidade é homogêneo e isotrópico, além disso,
os efeitos gravitacionais são desconsiderados e a velocidade de Darcy é constante (~v = cte) ao
longo do tempo, obtendo-se assim a seguinte equação:

? Sw
? t

+
1
?

?

? x
( fw(Sw)~v) = 0 (2.16)

A equação anterior é uma equação hiperbólica não linear de transporte e segundo Souza (2015
apud HELMIG, 1997) essa equação se caracteriza pela propagação da saturação da massa de
água ao longo da direção das linhas características.

Para o mesmo reservatório, as condições de contorno para a equação de saturação (2.14)
são dadas por:

Sw(x0,t) = S?w em ?in j (2.17)

onde S?w representa a saturação prescrita da fase água em um conjunto de poços injetores e a
condição inicial pode ser expressa como:

Sw(x,0) =

??
?1?Sw para x ? x0Sw para x &gt; x0 (2.18)

No início deste capítulo, as equações governantes foram obtidas a partir de várias hipóte-
ses simplificadoras. Ainda assim, obter soluções analíticas continua sendo um desafio, nestes
casos a literatura recomenda utilizar métodos numéricos que ajudem a obtermos uma solução
aproximada de tais equações. Com esse intuito, neste capítulo apresentamos a formulações
numéricas para resolver tais equações governantes. A estratégia numérica adotada para tal caso
é nomeada IMPES (IMplicit Pressure Explicit Saturation), o qual é um método segregado in-
troduzido por Sheldon e Cardwaell (1959) e Stone e Gardner (1961) que resolve o problema
pressão-saturação separadamente de maneira sequencial: essa estratégia é bastante popular na
indústria de petróleo (AZIZ; SETTARI, 1979; EWING, 1983; COATS, 2001; CHEN, 2004;
CONTRERAS, 2016), já que a implementação computacional é bastante eficiente e simples,
a desvantagem desta estratégia é a utilização de um passo de tempo pequeno para garantir a
estabilidade. Segundo Chen, Huan e Li (2004) considerar passo de tempo pequeno pode ser
prejudicial em problemas de simulação de longo tempo ou quando o domínio contínuo é dis-
cretizado por malhas muito refinadas. A estratégia IMPES consiste em, a partir de atribuir uma
distribuição inicial de saturação no reservatório calcularmos o campo de pressão de maneira
implícita e, posteriormente, calculamos o campo de velocidades, o qual utilizamos como dado
de entrada para o cálculo do campo de saturações, de tal maneira que as equações de pressão e



Capítulo 2. EQUAÇÕES GOVERNANTES 34

Figura 2 – Algoritmo da estrategia IMPES

Fonte – Souza (2015)

saturação são acopladas (fracamente) através do campo de velocidades. Com a nova distribuição
de saturação, retornamos para a equação de pressão, repetindo o processo até o instante de tempo
desejado (EWING, 1983; CARVALHO, 2005; CONTRERAS, 2016), ver figura 2.



35

3 FORMULAÇÃO NUMÉRICA DA EQUA-
ÇÃO DE PRESSÃO

As equações que regem o comportamento da dinâmica dos fluidos no interior dos
reservatórios de petróleo foram obtidas a partir das lei de conservação de massa, a lei de Darcy
e algumas equações de fechamento. Estas equações pela complexidade do fenômeno podem
não admitir soluções analíticas ou se tiver são apenas para fenômenos com condições muito
restritivas. Nesse sentido, os métodos numéricos são fundamentais já que nos permitem obter
soluções aproximadas respeitando as leis e certas condições físicas que envolve o problema.

A introdução do método dos volumes finitos (MVF) destacou a importância para aplica-
ções na indústria do petróleo para desenvolver ferramentas de simulação de reservatórios que
refletem as fortes restrições impostas pelo ambiente natural. Cronologicamente, como indicado
na introdução, uma das primeiras formulações numéricas utilizadas nas ultimas décadas na simu-
lação de reservatórios de petróleo é o método Two Point Flux Approximation (TPFA) Aavatsmark,
Barkve, Bøe e Mannseth (1998), Edwards e Rogers (1998), Aavatsmark (2002). Para este método,
o fluxo que atravessa a superfície de controle é escrito em função das pressões centradas nos
volumes de controle adjacentes a SC em questão. No entanto,sua principal desvantagem é a con-
vergência quando tratamos meios discretizados por malhas não K-ortogonais (AAVATSMARK,
1998; EDWARDS; ROGERS, 1998). Usualmente, é necessário utilizar malhas não estruturadas
na simulação de reservatórios com o objetivo de capturar de maneira adequada a representação
geológica dos reservatórios, por exemplo, as fraturas ou muitas vezes precisamos de malhas
localmente refinados próximo dos poços para poder capturar as regiões de singularidade. A
gênese de novos métodos de volumes finitos para superar as dificuldades do método TPFA foi
formulado por Crumpton, Shaw e Ware (1995). Nesse sentido, nós propormos outras novas
formulações numéricas baseadas nos diferentes método clássicos de volumes finitos formulados
pelos autores (LE POTIER, 2005; LIPNIKOV, 2007; YUAN; SHENG, 2008; BERTOLAZZI;
MANZINI, 2005; LE POTIER, 2009; SHENG; YUAN, 2011), a saber: um método de volumes
finitos não linear que preserva positividade (NLFV-PP) e outro método de volumes finitos não
linear que satisfaz o princípio do máximo discreto (NLFV-DMP) e finalmente um método de
volumes finitos linear com aproximação de fluxo por múltiplos pontos não ortodoxo (MPFA-HD).
Estas formulações satisfazem a maioria das propriedades numéricas de um método numérico
ideal, como descrito no capítulo 1.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 36

3.1 Método de Volumes Finitos Centradas no Volume de Controle
Duas componentes caracterizam o método de volumes finitos centrada no volume de

controle, que são a subdivisão do domínio espacial em volumes finitos e a sua forma integral ou
forma conservativa (WU; GAO, 2014; SHENG; YUAN, 2015; BLANC; LABOURASSE, 2015).

A primeira componente, no sentido de uma aproximação do método dos volumes finitos,
é a subdivisão do domínio espacial em volumes menores. Essa subdivisão transforma o domínio
contínuo em um domínio discretizado envolvendo superfícies de controle, centroides e volumes
de controle poligonal e/ou poligonal star-shape.

Definição 1. A discretização do domínio contínuo ? ? ?2 envolve um conjunto de poligonais
abertos, e o contorno denotado por ? ? = ?\? (o fecho de ? é denotado por ?). Uma discretiza-
ção admissível de ? envolve a composição de três superconjuntos denotado por D = (M ,E ,O),

onde:

• M =
{

L?
}

é família finita de volumes de controle, tal que:
?

L??M

L? = ?. O volume de cada

volume de controle L? ? M é representado por VL? e o cardinal do conjunto M é denotada
por |M |= n.

• E = {IJ, I é vértice de início e J é o vértice final da face em sentido anti-horário} é uma
família finita de subconjuntos de ? (chamados de faces ou superfícies de controle). Para

cada L? ? M , existe um subconjunto EL? de E tal que: ? L? =
?

IJ?EL?

IJ. Também assumimos

que para todo IJ ? E , temos que IJ ? ? ? ou IJ ? L??R?, para algum (L?,R?) ? M ×M .
O conjunto de faces internas e de contorno são representadas respectivamente pelos

conjuntos E int = E ?? e E ext = E ?? ?. Finalmente o comprimento da face em geral
calculado pela norma Euclidiana do vetor

??
IJ
(
?
??
IJ?
)

.

• O =
{

xL?
}

L??M é a família de pontos (centros da célula, não necessariamente o centro

de gravidade das células) de ?, de modo que, para todo L? ? M , xL? ? L?. Note-se que as
variáveis primarias são centrados nestes pontos.

Definição 2. Consideremos um domínio contínuo ? aberto em R2, discretizados por uma família
de polígonos M . Um volume de controle L? ? M é dito um polígono star-shape, se existe um
ponto z que pertence a L? tal que todo os pontos do polígono são visíveis a partir de ponto z. O

conjunto de pontos z de L? é chamado de Kernel, que geralmente é um polígono convexo. Em

todo o trabalho assumirmos que todo volume de controle é um polígono star-shape com respeito

ao baricentro.

A segundo característica do método de volumes finitos é a forma integrada do modelo ou
forma fraca como chamam outros autores, a qual resulta basicamente de integrar as equações



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 37

governantes. Assim, a equação de pressão (2.7) é integrado sobre o domínio ?

?
?

? ·~V dV =
?

?

QdV e ~V =?? K˜?p (3.1)
onde dV é o elemento de volume e p é a variável pressão. Essa variável (matematicamente) deve
ser uma função suave. Utilizando a propriedade das integrais sobre o conjunto M a equação
(3.1) é equivalente a

?
?

?·~V dV = ?
L??M

?
L?

? ·~V dV = ?
L??M

?
L?

QdV (3.2)

Considerando um volume de controle genérico L? de M , e aplicando o teorema de
divergência sobre este, temos:

?
L?

? ·~V dV =
?

? L?
~V ·~ndS = ?

IJ?EL?

?
IJ
~V ·~ndS =

?
L?

QdV (3.3)

onde dS é um elemento de área e ~n é o vetor normal unitário externa à ? L?. A equação anterior
((3.3)) é uma lei de conservação, o fluxo que sai do volume de controle L? é igual ao termo de
fonte/sumidouro no interior de L?.

As integrais na equação (3.3) são aproximadas utilizando o teorema de valor médio

~VIJ =
1?????IJ???

?
IJ?E

~V dS e QL? =
1

VL?

?
L?

QdV (3.4)

onde ~VIJ é a velocidade média na face IJ. O valor médio do termo de fonte ou sumidouro é dada
por QL? e o volume do elemento L? é denotado por VL?. Então, a partir das equações (3.1)-(3.4)
obtemos a seguinte definição

Definição 3. Considerando um estêncil admissível D de ?. Dizemos que o método numérico é
conservativo se existe uma família

{
~VIJ ·~NIJ

}
IJ?E

finita de fluxos numéricos de modo que:

~VIJ ·~NIJ +~VIJ ·~NJI = 0, IJ ? E (3.5)

e

?
IJ?EL?

~VIJ ·~NIJ = QL?VL?, ?L? ? M (3.6)

Na definição anterior o vetor área normal à superfície de controle IJ é denotado por ~NIJ
e ~NIJ = R

??
IJ , sendo que R é uma matriz de rotação em sentido anti-horário, ou seja:

R =

[
cos(? ) ?sin(? )
sin(? ) cos(? )

]
(3.7)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 38

onde ? é angulo de rotação desejada, no presente texto consideramos ? = ?/2.
Na equação (3.6) a vazão ~vIJ ·~NIJ pode ser aproximada utilizando algum método dos

volumes finitos. Para se obter uma aproximação numérica da vazão ~vIJ ·~NIJ , previamente
precisamos aproximar a mobilidade referente a superfície de controle em questão. Assim,
a literatura ligada à simulação numérica de reservatórios propõem varias estratégias numéricas,
por exemplo, Souza (2015) propõe várias estratégias que consiste em aproximar a mobilidade
pela média ponderada pelos volumes dos VC adjacentes à superfície de controle em questão:

?IJ =
? (SwL?)VL? + ? (SwR?)VR?

VL? +VR?
(3.8)

onde ? (SwL?) e ? (SwR?) são as mobilidades totais nos volumes de controle adjacentes à face IJ.
É notório que a mobilidade aproximada é influenciada pelo volume de controle que tem maior
volume.

A fim de manter uma aproximação mais robusta, Friis e Evje (2012) escreve a mobilidade
na face como a média aritmética das mobilidades nodais ?I e ?J

?IJ =
?I + ?J

2
(3.9)

onde as mobilidades nodais ?I e ?J são aproximadas pela média ponderada pelos volumes dos
VC na vizinhança do nó em questão, ou seja:

?i =

ni

?
k=1

? (Swk?)Vk?

ni

?
k=1

Vk?

, i = I,J (3.10)

onde ni representa o número de volumes de controle na vizinhança do nó (ou vértice) em questão.
Segundo Souza (2015), as mobilidades aproximadas na equação (3.8) produzem soluções menos
influenciadas pela orientação da malha do que as obtidas com a aproximação dada na equação
(3.9).

Outros autores como Aziz e Settari (1979), Brenier e Jaffré (1991), Kozdon, Mallison
e Gerritsen (2011), Nikitin, Terekhov e Vassilevski (2014), Lee, Efendiev e Tchelepi (2015),
utilizam uma aproximação à montante no tempo anterior para aproximar a mobilidade na face
em questão

?IJ =

??
?? (SwL?), se o fluxo sai do elemento L?

? (SwR?), caso contrario
(3.11)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 39

os autores simplesmente não justificam a escolha deste critério, na presente tese tentaremos
explicar a partir das nossas experiências numéricas.

3.2 Formulação Numérica Implícita da Equação de Pressão
Nesta seção descrevemos de maneira detalhada as formulações numéricas propostas para

resolver a equação de pressão dada em (2.9). Desde a equação (3.3) para uma face do volume de
controle arbitrário L?, temos:

?
IJ
~V ·~nIJ ds =?

?
IJ

? K˜L?? p·~nIJ ds =?
?

IJ
? ?p·(K˜&gt;L?~nIJ)ds, ?IJ ? EL? (3.12)

onde ~nIJ é o vetor normal unitário associado à face IJ, K˜L? representa o tensor de permeabilidade
no volume de controle L? e a transposta é denotado por K˜&gt;L? . Na equação anterior precisamos
aproximar os termos da integral, sendo que o valor aproximado da mobilidade ? já foi dada nas
equações (3.8), (3.9) e (3.11). O termo ? p ·(K˜&gt;L?~nIJ) é aproximado numericamente utilizando
os trabalhos clássicos de Le Potier (2005), Lipnikov, Shashkov, Svyatskiy e Vassilevski (2007),
Yuan e Sheng (2008), antes de desenvolver, precisamos enunciar um lema que nos ajude entender
a natureza do vetor K˜&gt;L?~nIJ , este vetor na literatura clássica é nomeado de vetor co-normal relativo
à face IJ.

Lema 1. Para cada face IJ ? EL?, sempre é possível encontrar dois pontos auxiliares xL?,i(IJ),
xL?, j(IJ) que não necessariamente pertence à face em questão, de modo que os vetores

??????xL?xL?,i(IJ),
??????xL?xL?, j(IJ) são não colineares, isso implica que existem duas constantes ?L?,i(IJ) e ?L?, j(IJ) associa-
dos a tais pontos auxiliares, tal que:

K˜&gt;L?~nIJ = ?L?,i(IJ)??????xL?xL?,i(IJ) + ?L?, j(IJ)??????xL?xL?, j(IJ) (3.13)
Na equação anterior os coeficientes ?L?,i(IJ) e ?L?, j(IJ) são calculados obedecendo as

seguintes condições:

• Condição 1. O ângulo formado pelos raios ??????xL?xL?,i(IJ) e K˜&gt;L?~nIJ é denotada por ? 1L?,IJ e esta
restrito ao intervalo 0 ? ? 1

L?,IJ
&amp;lt;? . E o ângulo formado pelos raios K˜&gt;L?~nIJ e ??????xL?xL?, j(IJ) é

denotado por ? 2
L?,IJ

e esta restrito ao intervalo 0 ? ? 2
L?,IJ

&amp;lt;? . Tendo assim, que a somatória
dos ângulos devem pertencer ao intervalo 0 &amp;lt;? 1

L?,IJ
+ ? 2

L?,IJ
&amp;lt;? .

Estas condições ainda não são suficientes para calcular os coeficientes, por exemplo, veja
a figura 4 a mesmo que satisfazendo condição 1 o vetor co-normal não pertence ao eixo auxiliar
em questão. Nesse sentido, introduzimos a seguinte condição.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 40

Figura 3 – As figuras representam a escolha do par de pontos que viola a condição 2 sem violar
a condição 1 (a) e a escolha do par de pontos que viola a condição 1 sem violar a
condição 2 (b)

Fonte – Produzido pelo autor

• Condição 2. O sinal do produto vetorial deve ser satisfeita ??????xL?xL?,i(IJ)×K˜&gt;L?~nIJ ?0 e K˜&gt;L?~nIJ×??????xL?xL?, j(IJ) ? 0. Na figura 3b mostramos o caso em que pode satisfazer a condição 2 sem
satisfazer a condição 1.

A estratégia para calcular os coeficientes consiste em percorrer cada par de pontos
composto por vértices ou pontos harmônicos em sentido anti-horário pertencentes ao volume
de controle em questão, e avaliar as condições 1 e 2, quando ambas condições são satisfeitas,
então o par de pontos são chamados pontos de interpolação e são aqueles que contém ao vetor
co-normal.

Os coeficientes são calculados a partir dos seguintes métodos clássicos não-lineares (LE
POTIER, 2005; LIPNIKOV, 2007; LIPNIKOV, 2009; YUAN; SHENG, 2008)

?L?,i(IJ) =

???K˜&gt;L?~nIJ
???sin(? 2L?,IJ)

sin(? 1
L?,IJ

+ ? 2
L?,IJ

)
e ?L?, j(IJ) =

???K˜&gt;L?~nIJ
???sin(? 1L?,IJ)

sin(? 1
L?,IJ

+ ? 2
L?,IJ

)
(3.14)

na equação anterior podemos observar claramente que os coeficientes são não-negativos, ou seja,
?L?,i(IJ) ? 0 e ?L?, j(IJ) ? 0, esta propriedade é essencial em método não lineares ja que contribuem
a preservar os critérios de positividade ou satisfazer o principio de máximo discreto (DMP).

Na atualidade métodos mais sofisticados propõem diferentes maneiras de calcular os
coeficientes, por exemplo, Gao e Wu (2013) e Nikitin, Terekhov e Vassilevski (2014) calcula os



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 41

Figura 4 – Pontos de interpolação que coincidem com: os vértices formando uma região Half-
Diamond (a) e os pontos harmônicos (b)

Fonte – Produzido pelo autor

coeficientes a partir de uma razão entre dois produtos mistos

?L?,i(IJ) =

(
K˜&gt;L?~nIJ,??????xL?xL?, j(IJ),~ez

)
(
??????xL?xL?,i(IJ),

??????xL?xL?, j(IJ),~ez
) e ?L?, j(IJ) =

(
??????xL?xL?,i(IJ),K˜&gt;L?~nIJ,~ez

)
(
??????xL?xL?,i(IJ),

??????xL?xL?, j(IJ),~ez
) (3.15)

onde (~a,~b,~c) é o produto misto de vetores ~a,~b e ~c, o vetor unitário que representa ao eixo z é
denotado por ~ez e é paralelo ao produto vetorial

??????xL?xL?,i(IJ)×
??????xL?xL?, j(IJ).

Em 2015 Gao e Wu propõe uma maneira diferente de calcular os coeficientes:

?L?,i(IJ) =
~nIJ K˜&gt;L? R

(
??????xL?xL?, j(IJ)

)
(
??????xL?xL?,i(IJ)

)&gt;
R
(
??????xL?xL?, j(IJ)

) e ?L?, j(IJ) = ~nIJ K˜
&gt;
L?
R
(
??????xL?xL?,i(IJ)

)
(
??????xL?xL?, j(IJ)

)&gt;
R
(
??????xL?xL?,i(IJ)

) (3.16)
onde R é uma matriz de rotação em sentido anti-horário. Nas equações (3.15) e (3.16) os
coeficientes produzem valores não-negativos.

Em nossos testes numéricos os valores dos coeficientes ?L?,i(IJ) e ?L?, j(IJ) não fazem
muita diferença em quanto robustez, além disso, em todos os casos o vetor co-normal pertence
ao mesmo eixo auxiliar quando calculado por qualquer das estratégias. Assim, os pontos de
interpolação já xL?,i(IJ), xL?, j(IJ) e xR?,i(IJ) definem a mesma região de suporte para aproximar os
fluxos laterais, veja a figuras 4. Na figura 4a, observamos que a região de suporte para calcular
dos fluxos laterais é nomeado como "Half-Diamond", já que em 3-D é similar a um diamante
dividido pela metade. E na figura 4b os pontos harmônicos influem na aproximação dos fluxos
laterais.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 42

De maneira similar para um volume de controle R? que compartilha à face IJ com o
volume de controle L?, o lema 1 pode ser escrito da forma seguinte:

K˜&gt;R?~nJI = ?R?,i(IJ)??????xR?xR?,i(IJ) + ?R?, j(IJ)??????xR?xR?, j(IJ) (3.17)
onde os coeficientes ?R?,i(IJ) e ?R?, j(IJ) são calculados respeitando as condições 1 e 2, utilizando a
seguinte equação

?R?,i(IJ) =

???K˜&gt;R?~nIJ
???sin(? 2R?,IJ)

sin(? 1
R?,IJ

+ ? 2
R?,IJ

)
e ?R?, j(IJ) =

???K˜&gt;R?~nIJ
???sin(? 1R?,IJ)

sin(? 1
R?,IJ

+ ? 2
R?,IJ

)
(3.18)

Definição 4. A derivada direcional de uma função p no ponto ~x na direção do vetor não nulo~z,

é denotador por
? p
?~z

e definida como:

? p
?~z

=
?p·~z
?~z?

(3.19)

A partir da definição anterior assumirmos que o vector ~z é substituído pelo vetor co-
normal K˜&gt;L?~nIJ na equação (3.19), logo temos:

? p

?

(
K˜&gt;L?~nIJ

)???K˜&gt;L?~nIJ
??? = ? p·(K˜&gt;L?~nIJ

)
= ?L?,i(IJ)?p·

??????xL?xL?,i(IJ)??L?, j(IJ)? p·
??????xL?xL?, j(IJ) (3.20)

e

? p

?

(
K˜&gt;R?~nJI

)???K˜&gt;R?~nJI
??? = ? p·(K˜&gt;R?~nJI

)
= ?R?,i(IJ)?p·

??????xR?xR?,i(IJ)??R?, j(IJ)?p·
??????xR?xR?, j(IJ) (3.21)

As equações anteriores são substituídas na equação (3.12)

?
IJ
~V ·~nIJ ds =?

?
IJ

?

(
?L?,i(IJ)? p·

??????xL?xL?,i(IJ)??L?, j(IJ)? p·
??????xL?xL?, j(IJ)

)
ds (3.22)

e

?
IJ
~V ·~nJI ds =?

?
IJ

?

(
?R?,i(IJ)?p·

??????xR?xR?,i(IJ)??R?, j(IJ)?p·
??????xR?xR?, j(IJ)

)
ds (3.23)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 43

Utilizando o método de diferencias finitas por expansão em series de Taylor podemos
aproximar a derivada parcial ? p, ao longo da direção dos vetores ·??????xL?xL?,i(IJ) (resp. ·

??????xR?xR?,i(IJ)) e
??????xL?xL?, j(IJ) (resp.

??????xR?xR?, j(IJ)) logo substituímos nas equações anteriores, assim temos:

?
IJ
~V ·~nIJ ds =?

?
??L?,i(IJ) pL?,i(IJ)? pL??????????xL?xL?,i(IJ)??? + ?L?, j(IJ)

pL?, j(IJ)? pL??????????xL?xL?, j(IJ)???
?
??

IJ
? ds + O(?

??
IJ?) (3.24)

e

?
IJ
~V ·~nJI ds =?

?
??R?,i(IJ) pR?,i(IJ)? pR??????????xR?xR?,i(IJ)??? + ?R?, j(IJ)

pR?, j(IJ)? pR??????????xR?xR?, j(IJ)???
?
??

IJ
? ds + O(?

??
IJ?) (3.25)

Adicionalmente a mobilidade na face IJ é aproximada utilizando o teorema de valor
médio

?IJ?
??
IJ?=

?
IJ

? dS (3.26)

logo substituindo o valor médio da mobilidade nas equações (3.24) e (3.25), temos:

?
IJ
~V ·~nIJ ds = ?IJ?

??
IJ?

?
??L?,i(IJ) pL? ? pL?,i(IJ)?????????xL?xL?,i(IJ)??? + ?L?, j(IJ)

pL? ? pL?, j(IJ)?????????xL?xL?, j(IJ)???
?
?+ O(???IJ?) (3.27)

e

?
IJ
~V ·~nJI ds = ?IJ?

??
IJ?

?
??R?,i(IJ) pR? ? pR?,i(IJ)?????????xR?xR?,i(IJ)??? + ?R?, j(IJ)

pR? ? pR?, j(IJ)?????????xR?xR?, j(IJ)???
?
?+ O(???IJ?) (3.28)

Quando ?
??
IJ??? 0 nas equações (3.27) e (3.28), obtemos os fluxos laterais aproximadas

na superfície de controle IJ correspondente ao volume de controle L?

~V L?IJ ·~NIJ = ?IJ?
??
IJ?
(

?L?,i(IJ)

(
pL? ? pL?,i(IJ)

)
+ ?L?, j(IJ)

(
pL? ? pL?, j(IJ)

))
(3.29)

onde
?L?,i(IJ) =

?L?,i(IJ)?????????xL?xL?,i(IJ)??? e ?L?, j(IJ) =
?L?, j(IJ)?????????xL?xL?, j(IJ)??? (3.30)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 44

Figura 5 – Mostramos os fluxos utilizando os vértices e os pontos harmônicos

Fonte – Produzido pelo autor

Correspondente ao volume de controle R?, temos:

~V R?IJ ·~NJI = ?IJ?
??
IJ?
(

?R?,i(IJ)

(
pR? ? pR?,i(IJ)

)
+ ?R?, j(IJ)

(
pR? ? pR?, j(IJ)

))
(3.31)

onde
?R?,i(IJ) =

?R?,i(IJ)?????????xR?xR?,i(IJ)??? e ?R?, j(IJ) =
?R?, j(IJ)?????????xR?xR?, j(IJ)??? (3.32)

podemos observar nas equações anteriores que os coeficientes ?L?,i(IJ), ?L?, j(IJ), ?R?,i(IJ) e ?R?, j(IJ)
ainda mantém a não negatividade dos seus valores desde que os outros coeficientes ?L?,i(IJ),
?L?, j(IJ), ?R?,i(IJ) e ?R?, j(IJ) são não negativos, graficamente os fluxos laterais são mostrados na
figura 5.

3.2.1 Método de Volumes Finitos Não Linear que Preserva Positividade (NLFV-
PP)

Nesta seção derivamos um método dos volumes finitos não linear inspirado nos trabalhos
clássicos dos autores Le Potier (2005), Lipnikov, Shashkov, Svyatskiy e Vassilevski (2007),
Yuan e Sheng (2008) e Queiroz, Souza, Contreras, Lyra e Carvalho (2014). O método que
apresentamos satisfaz as seguintes propriedades numéricas:

• É localmente conservativo.

• É monótono, isto é, preserva positividade da solução das soluções numéricas.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 45

• Preserva linearidade.

• Lida com malhas não estruturadas e severamente distorcidas.

• Permite tensores de permeabilidade com alta razão de anisotropia.

• Possui taxas de convergência de segunda ordem para o campo de pressão e aproximada-
mente de primeira ordem para o fluxo.

Uma das propriedades essenciais que todo método numérico deveria satisfazer é a
monotonicidade. No contexto da condução térmica anisotrópica, o método que não preservar
monotonicidade pode levar à violação das restrições de entropia da segunda lei da termodinâmica
fazendo com que o calor flua de regiões de temperatura mais baixa para temperatura mais alta.
Em regiões de grandes variações de temperatura, isso pode fazer com que a temperatura se
torne negativa. A fim de evitar a temperatura negativa, o método portanto deve ser monótono
(YUAN; SHENG, 2008). E no contexto de simulação de reservatórios de petróleo, um método
que não satisfaz a monotonicidade podem produzir com campo de pressões com oscilações
espúrias, que consequentemente podem pode gerar gás fictício em regiões do reservatório onde a
pressão cai erroneamente abaixo do ponto de bolha e esses campos de pressão estão associados a
velocidades/fluxos não físicos de Darcy (QUEIROZ, 2014). Obviamente, resultados semelhantes
enganosos podem acontecer em outras aplicações. Para os casos lineares, a monotonicidade é
equivalente ao princípio discreto máximo (DMP), isso será mostrado nos experimentos numéricos
no próximo capítulo. Contudo, para os casos gerais, o princípio do máximo discreto é mais
restritivo do que a monotonicidade (YUAN; SHENG, 2008).

Nos trabalhos clássicos o fluxo único na face IJ ? E int é expressado como combinação
convexa dos fluxos laterais dadas nas equações (3.29) e (3.31), isto é:

~VIJ ·~NIJ = wL?,IJ~V
L?
IJ ·~NIJ ?wR?,IJ~V

R?
IJ ·~NIJ (3.33)

onde os pesos wL?,IJ e wR?,IJ devem satisfazer a seguinte equação de restrição:

wL?,IJ + wR?,IJ = 1 (3.34)

A equação anterior satisfaz a condição de conservação local dada na equação (3.5).
Substituindo a expressão que representa os fluxos ~V L?IJ ·~NIJ e ~V

R?
IJ ·~NIJ em equação (3.33)

e arranjando adequadamente, temos:

~VIJ ·~NIJ = AL?,IJ pL? ?AR?,IJ pR? ?
(

wL?,IJ ?L?,IJ ?wR?,IJ ?R?,IJ
)

(3.35)

onde
A?,IJ = ?IJ?

??
IJ?w?,IJ

(
??,i(IJ) + ??, j(IJ)

)
, ? = L?,R? (3.36)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 46

e

??,IJ = ?IJ?
??
IJ?
(
??,i(IJ) pi,i(IJ) + ??, j(IJ) pi, j(IJ)

)
, ? = L?,R? (3.37)

Os coeficientes ??,i(IJ) e ??, j(IJ) na equação (3.37) já foram calculados nas equações
(3.30) e (3.32). Além disso, devemos notar que as variáveis auxiliares pi,i(IJ) e pi, j(IJ) são
interpoladas utilizando uma estratégia de interpolação, em nosso caso utilizamos a estrategia
de interpolação proposto por Gao e Wu (2011) e utilizado arduamente pelos autores Queiroz,
Souza, Contreras, Lyra e Carvalho (2014), Contreras, Lyra, Souza e Carvalho (2016).

A fim de derivar uma aproximação de fluxo consistente de dois pontos que leve a
um método que preserva positividade utilizamos as ideias introduzidos por Le Potier (2005),
Lipnikov, Shashkov, Svyatskiy e Vassilevski (2007), Yuan e Sheng (2008), nesse sentido os
pesos wL?,IJ e wR?,IJ devem ser calculados satisfazendo o seguinte sistema de equações{

wR?,IJ ?R?,IJ ?wL?,IJ ?L?,IJ =0

wL?,IJ + wR?,IJ =1
(3.38)

Resolvendo o sistema anterior, temos:

wL?,IJ =

????R?,IJ???+ ?????L?,IJ???+????R?,IJ???+ 2? e wR?,IJ = 1?wL?,IJ (3.39)
onde o valor de ? é um número muito pequeno imposto simplesmente para evitar uma divisão
por zero.

Segundo Blanc e Labourasse (2015) essa estratégia pode fazer com que a função fluxo
seja descontinua com respeito a p, para evitar esse tipo de anomalias, ele recomenda utilizar
funções de pesos que sejam continuas

wL?,IJ =

????R?,IJ???+ ? 21????L?,IJ???+????R?,IJ???+ 2? 21 e wR?,IJ = 1?wL?,IJ (3.40)
onde ?1 = max

{
?
??
IJ?, IJ ? E

}
representa um máximo global, também de maneira similar

podemos considerar um máximo local ?1 = max
{
?
??
IJ?, IJ ? E ?(EL? ?ER?)

}
, em malhas finas

este ultimo é numericamente mas relevante.
O fluxo na face correspondente ao volume de controle L? é escrito em função das pressões

centrados nos volumes de controle adjacentes à face IJ ? E int :

~VIJ ·~NIJ = AL?,IJ(p)pL? ?AR?,IJ(p)pR? (3.41)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 47

e o fluxo correspondente ao volume de controle R? é dada por:

~VIJ ·~NJI = AR?,IJ(p)pR? ?AL?,IJ(p)pL? (3.42)

veja que os fluxos anteriores satisfazem a equação de continuidade de fluxo dada na equação
(3.5). Os coeficientes AL?,IJ e AR?,IJ são definidas na equação (3.36).

O valor absoluto aplicado nas componentes das equações (3.39) e (3.40) é empregado
para forçar a positividade dos pesos wL?,IJ e wR?,IJ (LE POTIER, 2005; LIPNIKOV, 2007; YUAN;
SHENG, 2008), quando se utiliza métodos de interpolação de primeira ordem não é neces-
sário forçar a positividade, ja que pela própria construção o método de interpolação mantém
positividade, mas esto pode causar problemas de acurácia no método em geral.

3.2.1.1 Tratamento do Fluxo nas Faces de Contorno do Método NLFV-PP

Quando a superfície de controle em questão pertence ao contorno exterior IJ ? E ext ??D
do domínio ?, más explicitamente ao contorno de Dirichlet, o fluxo pode ser diretamente
expresso da equação (3.29), como:

~VIJ ·~NIJ = ~V L?IJ ·~NIJ = AL?,IJ pL? ??L?,IJ (3.43)

onde
AL?,IJ = ?IJ?

??
IJ?
(

?L?,i(IJ) + ?L?, j(IJ)

)
(3.44)

e

?L?,IJ = ?IJ?
??
IJ?
(

?L?,i(IJ)gD,i(IJ) + ?L?, j(IJ)gD, j(IJ)
)

(3.45)

na equação anterior gD,i(IJ) e gD, j(IJ) representam as pressões nos vértices que pertence à face
em questão e seus valores são diretamente fornecidos pela condição de contorno de Dirichlet.

De outra parte, quando a superfície de controle pertence ao contorno de Neumann, isto é,
IJ ? E ext ??N , as pressões nos pontos auxiliares devem ser interpoladas pela estratégia adotada
e o fluxo é fornecido pela física do problema

~VIJ ·~NIJ = gN?
??
IJ? (3.46)

onde gN representa o valor do fluxo fornecido.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 48

Figura 6 – Mostram os fluxos e faces que atuam no momento de escrever o balanço de massa

Fonte – Produzido pelo autor

3.2.1.2 Sistema Discreto do Método NLFV-PP

Tendo definido o fluxo em cada superfície de controle do domínio computacional ?
estamos na capacidade de montar o sistema de equações não lineares e logo resolver por algum
método iterativo. A partir, dos fluxos definidos nas equações (3.41), (3.42) e (3.43) podemos
obter a equação discreta de balanço de massa para cada volume de controle L?

?
IJ?? L?

~VIJ ·~NIJ = Q?L?VL?, ?L? ? ? (3.47)

A maneira de mostrar a natureza da matriz global, consideramos dois volumes de controle 1? e 2?
mostrados na figura 6, podemos desenvolver o balanço de massa dado na equação anterior como
segue:

• Volume de controle 1?: ~VIJ ·~NIJ +~VJJ1 ·~NJJ1 +~VJ1J2 ·~NJ1J2 +~VJ2I ·~NJ2I = Q?1?V1?.

e

• Volume de controle 2?: ~VIJ ·~NJI +~VIJ3 ·~NIJ3 +~VJ3J ·~NJ3J = Q?2?V2?.

Agora representamos em uma matriz, como:

?
?A 1?IJ+A1?,JJ1 +A1?,J1J2 +A1?,J2I ?A2?,IJ ?A3?,JJ1 ?A4?,J1J2 ?A5?,J2I ... ...?A

1?,JI
A

2?,JI
+A2?,IJ3

+A2?,J3J
0 0 0 ?A6?,IJ3 ?A7?,J3J ...

...
...

...
. . .

...
...

...

?
?
?
?????

p1?
p2?
p3?
p4?
p5?
p6?
p7?
...

?
????? =

?
?????????

Q?1?V1?
Q?2?V2?
Q?3?V3?
Q?4?V4?
Q?5?V5?
Q?6?V6?
Q?7?V7?

...

?
?????????

(3.48)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 49

Na matriz acima observamos que os elementos são positivos ao longo da diagonal
principal e são não positivos ao longo da diagonal secundária. Essa caraterística pode satisfazer
várias propriedades de uma “M-matrix” (LE POTIER, 2005; LIPNIKOV, 2007; YUAN; SHENG,
2008), a forma compacta da matriz é representada como:

A˜?(p)P˜ = B˜ (3.49)
Na literatura a matriz A˜? é usualmente chamada de matriz de transmissibilidade ou matriz

discreta, já que cada elemento da matriz contém informação tanto física quanto geométrica,
o vetor do campo pressão é dado por P˜ e o vetor B˜ cujos elementos são representados tanto
pelo termo de fonte/sumidouro, quanto pela informação das condições de contorno. Esta matriz
de transmissibilidade é obtida a partir da montagem de matrizes locais associadas a cada face
interior do domínio E int , assim temos:

A˜?(p)IJ =
[

AL?,IJ(p) ?AR?,IJ(p)
?AL?,IJ(p) AR?,IJ(p)

]
(3.50)

Quando a face em questão pertence ao contorno do domínio E ext , a matriz local é de
dimensão 1x1, já que somente recebe a própria contribuição do elemento do contorno, isto é;

A˜?(p)IJ = AL?,IJ(p) (3.51)
Diz-se que uma matriz A˜? é monótona para todo vetor P˜ quando A˜?P˜ ? 0, implica em

P˜ ? 0. Na solução de problemas elípticos, os métodos numéricos que resultam em matrizes
monótonas são comumente chamados de métodos monótonos. No entanto, com frequência, o
mesmo termo é usado para denotar métodos numéricos utilizados na discretização de leis de
conservação descritas por equações hiperbólicas, com sentido um pouco diferente (HIRSCH,
1990; COLELLA, 2011). No presente contexto, seguindo a literatura, quando nos referimos
aos métodos para a solução da equação elíptica de pressão, utilizaremos a expressão “método
monótono” para esquemas que resultam em matrizes monótonas, sem que, necessariamente,
ocorra a satisfação de um princípio do máximo discreto (DMP) (VIDOVIC?, 2011).

Antes de demostrar o teorema que garante a positividade do nosso método vamos
introduzir algumas definições preliminares

Definição 5. (WOOD; O’NEILL, 2004). Uma matriz A˜? de dimensão n×n com elementos Ai j é
dito uma matriz (M-matrix) se satisfaz as seguintes propriedades:

• Aii &gt; 0, para i = 1,...,n.

• Ai j ? 0, para i 6= j e i, j = 1,...,n.

• A˜? é não singular.
• A˜??1 ? 0.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 50

A próxima definição caracteriza uma matriz monótona

Definição 6. (PRICE, 1968). Seja A˜? uma matriz de dimensão n×n, A˜? é matriz monótona se
para qualquer vetor P˜, A˜?P˜? 0, implica que P˜? 0.

A matriz global A˜? dada na equação (3.49) possui as seguintes propriedades (LIPNIKOV,
2009; GAO; WU, 2015; SHENG; YUAN, 2015):

1. Todas as entradas da diagonal da matriz são positivas, i.e. Aii &gt; 0 para todo i = 1,...,n.

2. Todas as entradas fora da diagonal principal da matriz são positivos, i.e. Ai j ? 0, i 6= j para
i, j = 1,...,n.

3. A soma de cada coluna da matriz global é não negativa e existe ao menos uma coluna com
soma positiva, i.e. ?

i
Ai j ? 0 e existe ao menos j tal que ?

i
Ai j &gt; 0, para cada j = 1,...,n.

No presente trabalho foram verificadas todas essas propriedades cuidadosamente. As
propriedades anteriores implicam que a matriz global A˜? é diagonalmente dominante fraco, isto é
Aii ? ?

i 6= j

??Ai j??, para cada i = 1,...,n.
Teorema 1. Seja A˜? uma matriz diagonal dominante, isso implica que é M-matrix.

O sistema não linear da equação (3.49) pode ser resolvido por diferentes métodos
iterativos. Seguindo os trabalhos de Le Potier (2005), Lipnikov, Shashkov, Svyatskiy e Vassilevski
(2007), Yuan e Sheng (2008), Sheng e Yuan (2011) e Gao e Wu (2013), utilizamos o método de
iteração de Picard, pois este garante, que soluções inicialmente positivas sejam mantidas positivas
durante o processo iterativo. Assim, inicialmente escolhemos um valor pequeno (?tol &gt; 0) e um
vetor inicial com entradas positivas P˜0 e repeti até o método convergir.

Algoritmo 1: Geração de Solução do Sistema Não Linear
1 Calcule os coeficientes dados nas equações (3.30) e (3.32).
2 Escolha um vetor inicial P˜0 ? 0 e uma tolerância muito pequena tol.
3 Montagem da matriz global A˜?0 a partir das matrizes locais A˜?IJ dada na equação (3.44).
4 Calcule o vetor de termo fonte B˜0.
5 inicio
6 Resolve o sistema: A˜?kP˜k+1 = B˜k.
7 Montagem da matriz global A˜?k+1 a partir das matrizes locais A˜?k+1IJ dada na equação

(3.44).
8 Calcule o vetor de termo fonte B˜k+1.
9 Pare quando:

???A˜?(pk+1)P˜k+1 ?B˜(pk+1)
???? ?tol ???A˜?(p0)P˜0 ?B˜(p0)

???.
10 Caso contrário retorne a 6, com k = k + 1.
11 fin



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 51

Quando utilizamos malhas distorcidas ou meios altamente anisotrópicos o método itera-
tivo de Picard pode ter dificuldade de convergir, nesse caso Lipnikov, Svyatskiy e Vassilevski
(2010) recomenda usar uma estratégia de relaxação, o qual ajuda a melhorar a robustez do mé-
todo. Também é possível implementar métodos que ajudem acelerar a convergência do método
de Picard. Este acelerador de convergência é baseado no método Aitkin generalizado para uma
sequência de vetores e no método de extrapolação polinomial, qual inclui uma extrapolação
polinomial minima (MPE) ou uma extrapolação que reduz o intervalo (RRE). É sabido que estes
métodos não garantem satisfazer o principio de máximo de discreto (DMP).

Na literatura existem outros métodos como Newton-Raphson, os quais podem diminuir
o número de iterações consideravelmente já que possui uma convergência quadrática, mas
requer uma derivada analítica para discretização da matriz. Aproximar estas derivadas tem
levado a vários métodos tipo Newton com convergência semi-quadrático. Um método bastante
robusto foi o método Newton-Krylov que evita calcular derivadas analíticas e oferece uma
convergência rápida, sempre que se utilize algum precondicionador. Embora este método não
garanta soluções positivas em cada iteração, forçar a positividade com algumas restrições podem
deteriorar as propriedades de convergência (LIPNIKOV, 2009).No futuro Próximo estos métodos
serão implementados de maneira adequada em todos nossos métodos não lineares e comparar a
eficiência computacional.

Teorema 2. (WU; GAO, 2014; SHENG; YUAN, 2015) Seja o termo fonte Q não negativo,
considerando as condições de Dirichlet não negativas e o fluxo sobre contorno de Neumann

não positivo, pressão inicial P˜0 não negativa, além disso, temos que os coeficientes na equação
(3.41) e (3.42) são não-negativos. Então temos que para todo k ? ? e k ? 1, P˜k ? 0.
Demonstração. Primeiramente provamos que a matriz A˜? é monótona para qualquer vetor P˜ não
negativo. Em efeito, quando a matriz A˜? é diagonal dominante temos que a matriz transposta
A˜?&gt;, também é diagonal dominante o que implica que é uma M-matrix pelo teorema 1. que
todas as entradas

(
A˜?&gt;
)?1

são não negativos. A operação transposta e a inversa comutam

convenientemente
(

A˜?&gt;
)?1

=
(

A˜??1
)&gt;

, logo concluímos que as entradas da matriz A˜??1 são
todas positivos, logo a matriz A˜? é monótona, para qualquer P˜ ? 0. Pela hipótese temos que:
P˜0 ? 0, assumimos uma hipótese auxiliar P˜k?1 ? 0 para k &gt; 0, logo temos que A˜?k?1 é uma
matriz monótona, isso implica que

(
A˜?k?1

)?1
? 0. Note pela hipotese que B˜ ? 0, isto segue que

a solução de P˜k de A˜?k?1P˜k = B˜ é um vetor não negativo, ou seja, P˜k ? 0.
A fim de tornar nosso método totalmente centrado na célula precisamos interpolar as

variáveis auxiliares localizadas nos vértices do domínio computacional, na literatura existem
vários métodos de interpolação, por exemplo, os métodos não lineares clássicos utilizam métodos
de interpolação de primeira ordem como ponderados pela distancia inversa (IW), estes métodos
por serem de ordem baixa garantem a positividade dos métodos, embora perde acurácia em



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 52

malhas distorcidas ou meios altamente anisotrópicos (LE POTIER, 2005; LIPNIKOV, 2007).
Nesse sentido, Yuan e Sheng (2008) utiliza um método de interpolação de segunda ordem
proposto proposto num método linear dos volumes finitos, embora quando o método não linear
viola a positividade usa um método de interpolação de baixa ordem. Gao e Wu (2015) propõe
outra estratégia de interpolação baseada na aproximação de mínimos quadrados. Segundo os
testes esta estrategia é bastante robusta que o método de interpolação proposto pelo mesmo autor
em Gao e Wu (2011).

3.2.1.3 Estratégia de Interpolação que Preserva Linearidade (LPEW)

Na presente seção descrevemos brevemente um método de interpolação formulado por
Gao e Wu (2011) e utilizado arduamente pelos autores Queiroz, Souza, Contreras, Lyra e
Carvalho (2014), Contreras, Lyra, Souza e Carvalho (2016). Como mencionado na seção anterior,
aquelas variáveis auxiliares situadas nos vértices pertencentes à E int precisam ser interpolados
em função das variáveis primarias centradas nos volumes de controle, isto é:

pI =
nI

?
i=1

?i? pi? (3.52)

onde ?i? são os pesos atribuídos a cada volume de controle i? na vizinhança do vértice I e nI
número de volumes de controle na vizinhança do vértice I.

A estratégia de interpolação adotada escreve a pressão dos vértices como combinação de
outras pressões centradas na sua vizinhança, onde os pesos de interpolação são obtidos de maneira
explícita. Uma versão ligeiramente modificada pode ser vista em (WU; GAO, 2014). Estes pesos
são chamadas de “explícitos” para indicar que são calculados sem a necessidade de resolver
um sistema local de equações, como em outros métodos MPFA clássicos (AAVATSMARK,
2002). O calculo dos pesos explícitos na equação (3.52) é formulado utilizando a equação da
continuidade através das regiões auxiliares construídas na vizinhança de cada vértice em questão.
Na 7, apresentamos a região de iteração e alguns parâmetros físicos para a interpolação LPEW
adotada neste trabalho. Seguindo Gao e Wu (2011), os pesos explícitos podem ser calculados
como:

?i? =
?i?

nI

?
i=1

?i?

(3.53)

Na equação anterior, os coeficientes ?i? são dados por:

?i? = K
(n)
i?,1

?i?,1? (i?)+ K
(n)
i?,2

?i?,2? (i?) e ? (i?) = ?i??i? + ?i??1?i??1 (3.54)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 53

onde ?i? é a mobilidade total em cada volume de controle i?, ?i?,1, ?i?,2, K
(n)
i?,1

e K(t)
i?,1

são dadas por:

?i?,1 =
?
??
IMi?
hi?IJi

e ?i?,2 =
?
??
IMi+1?
hi?IJi+1

(3.55)

onde M é ponto médio da face em questão, e

K(t)
i?,k

=
[??

N &gt;IM? K˜ i???IM?
]
/
?????IM????2 e K(n)i?,k = [??N &gt;IM? K˜ i???N IM?

]
/
?????IM????2 (3.56)

com, ? = i? + k?1, k = 1,2. Além disso:

?i? =
K
(n)
i?

cot(?i?,2)?K
(t)
i?

K(n)ˆi?1,2 cot(? ˆi?1,2)+ K
(n)
i?,1

cot(?i?,1)?K
(t)
i?,2

+ K(t)
i?,1

(3.57)

e

?i??1 =
K
(n)
i??1 cot(?i??1,1)?K

(t)
i??1

K(n)ˆi?1,2 cot(? ˆi?1,2)+ K
(n)
i?,1

cot(?i?,1)?K
(t)
i?,2

+ K(t)
i?,1

(3.58)

onde
K
(t)
i?

=
[??

N &gt;MiMi+1 K˜ i??????MiMi+1
]
/
????????MiMi+1???2 (3.59)

K
(n)
i?,k

=
[??

N &gt;MiMi+1 K˜ i??????NMiMi+1
]
/
??MiMi+1??2 (3.60)

Os coeficientes físico-geométricos ?i?, K
(n)
i?

e K
(t)
i?

são calculados durante uma etapa de
pré-processamento. Mais detalhes sobre este método de interpolação podem ser encontrados
em Gao e Wu (2011) e (QUEIROZ, 2014), veja a figura 7 para identificar algumas contantes
geométricas.

Apesar dos pesos dados na equação (3.53) poderem admitir valores negativos (?i? &amp;lt;0),
isto não causa problemas de monotonicidade no método não linear proposto, diferentemente
de outras estratégica não-lineares encontradas na literatura. A aplicação do método LPEW em
métodos não lineares clássicos podem causar problemas de monotonicidade (QUEIROZ, 2014),
quando isto acontece, sugere-se que se utilize métodos de interpolação de baixa de ordem que
preservem a positividade, por exemplo, a interpolação ponderada pelo inverso da distância
(IDW – Inverse Distance Weighting) (LE POTIER, 2005; LIPNIKOV, 2007; QUEIROZ, 2014).
Como ja dito em seções anteriores, quando tratamos reservatórios altamente anisotrópico e/ou
discretizado por malhas severamente distorcidas os pesos de interpolação podem ter valores
negativos.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 54

Figura 7 – Região de iteração para interpolação LP

Fonte – (CONTRERAS, 2016)

Quando o vértice em questão pertence à E ext ??N , veja figura 8, a interpolação é similar
a (3.53)

pI =
1

nI

?
i=1

?i?

??
?

nI

?
i=1

?i? pi? ? ?
?=1,nI

[1 + ?? ]?
??
IM???gIM??

??
? (3.61)

onde o parâmetro físico-geométrico ?? é definido na equação

?? =

?????
????

K
(n)
i??1

cot(?1,2)?K
(t)
i?

K
(n)
i?,1

cot(?1,1)+K
(n)
i?,1

, ? = 1

K
(n)
n?I

cot(?n?I ,1)?K
(t)
n?I

K
(n)
n?I ,1

cot(?n?I ,2)+K
(n)
n?I ,1

, ? = nI + 1
(3.62)

Como consequência do método não linear proposto, surge um método dos volumes
finitos linear não ortodoxo onde a aproximação do fluxo envolve múltiplos pontos centrados nos
volumes de controle, a construção deste método consiste em utilizar os fluxos laterais definidos
nas equações (3.29) e (3.31), e logo expressa como uma combinação convexa destes, as variáveis
auxiliares são interpoladas utilizando o método LPEW descrito anteriormente, este método em
casos particulares pode recair no método TPFA.

3.2.2 Método dos Volumes Finitos Não Ortodoxo tipo MPFA

Nesta seção, combinamos alguns procedimentos numéricos a fim de se obter um método
capaz de produzir soluções aproximadas robustas para fluxos com altas relações de mobilidade
considerando tensores de permeabilidade anisotrópicos e heterogêneos, possivelmente descontí-
nuos, mesmo para malhas poligonais distorcidas e não estruturadas. Neste contexto, a equação
de pressão é discretizada por um método linear não-ortodoxo centrado nos volumes de controle



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 55

Figura 8 – Região de iteração para interpolação do nó na fronteira de Neumann

Fonte – Produzido pelo autor

tipo MPFA com um estêncil tipo Hal f ?diamond (MPFA-HD). Este método baseou-se no
método NLFV-PP e outros métodos não lineares clássicos (LE POTIER, 2005; LIPNIKOV,
2007; YUAN; SHENG, 2008). Em contraste com o método MPFA-O Aavatsmark, Barkve, Bøe
e Mannseth (1998) ou MPFA-FPS (EDWARDS; ZHENG, 2008), no método MPFA-HD, o fluxo
em cada face celular é explicitamente definido em função das pressões nos vértices (variáveis
auxiliares) não necessariamente pertencentes a mesma face compartilhada pelos volumes de
controle adjacentes. Como o método é centrado nos volumes de controle, as incógnitas auxiliares
são expressas como combinações lineares ponderadas pelas incógnitas vizinhas centradas nos
volumes de controle, de modo a reduzir o método para uma formulação completamente centrada
nos volumes de controle. No método proposto por Gao e Wu (2011), os pesos de interpolação
não dependem nem da descontinuidade nem topologia da malha e podem ser usados mesmo para
problemas com tensores completos ( f ull tensor). O que estamos propondo (MPFA-HD) satisfaz
as seguintes propriedades numéricas:

• Possui um estêncil local.

• Satisfaz o critério de preservar linearidade.

• Permite tensores com razão de anisotropia elevada.

• Lida com malhas poligonais e severamente distorcidas.

• Os pesos são explicitamente calculados.

• Possui taxas de convergência de segunda ordem para o campo de pressões e primeira
ordem para a fluxo.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 56

De maneira similar ao método NLFV-PP, o fluxo único sobre a face IJ ? E int pode ser
expressa como a combinação convexa dos fluxos laterais definidos nas equações (3.29) e (3.31)

~VIJ ·~NIJ = wR?,IJ~V
L?
IJ ·~NIJ ?wL?,IJ~V

R?
IJ ·~NIJ (3.63)

Note que a equação anterior satisfaz a equação da conservação local definida em (3.5). A
diferença dos métodos não lineares é que neste método linear os pesos wL?,IJ e wR?,IJ são definidos
tendo influência somente de parâmetros físicos-geométricos, sem envolver as variáveis auxiliares
e respeitando a equação de restrição dada em (3.34), assim:

wL?,IJ =
hR?,IJ K

(n)
L?,IJ

hR?,IJ K
(n)
L?,IJ

+ hL?,IJ K
(n)
R?,IJ

e wR?,IJ = 1?wL?,IJ (3.64)

onde hL?,IJ e hR?,IJ representam as distancias ortogonais à face IJ projetadas desde os centroides
dos volumes de controle L? e R?, respectivamente.

As projeções normais dos tensores de permeabilidade K˜L? (resp. K˜R?) sobre a face IJ são
denotados por K(n)

L?,IJ
(resp. K(n)

R?,IJ
) e dadas na seguinte equação:

K(n)
L?,IJ

=~n&gt;IJ K˜L?~nIJ e K(n)R?,IJ =~n&gt;JI K˜R?~nJI (3.65)
onde ~nIJ é o vetor normal unitário a face IJ.

A seguinte igualdade ~VIJ ·~NIJ =?~V R?IJ ·~NJI = ~V
L?
IJ ·~NIJ foi proposto por Gao e Wu (2011)

no método MPFA-D para garantir a conservação de massa, nesse caso os pesos se reduzem a
wL?,IJ = wR?,IJ = 0.5, ou seja teríamos o seguinte fluxo único na face IJ expressada como:

~VIJ ·~NIJ =
1
2
~V L?IJ ·~NIJ ?

1
2
~V R?IJ ·~NIJ (3.66)

Percebemos que a ponderação utilizada na equação anterior não toma em conta nenhum
parâmetro físico-geométrico, sendo a formulação menos robusta, nos testes numéricos vamos
mostrar o potencial da nossa formulação com respeito a outros métodos clássicos. Lembrando
que os pesos dados na equação (3.64) somente se reduzem a 0.5 quando consideramos meio
homogêneo, isotrópico e malha ortogonal.

Substituindo as equações (3.29) e (3.31) em (3.63) e manipulando algebricamente, temos:

~VIJ ·~NIJ = ?IJ?
??
IJ?

?
?AL?,IJ pL? ?AR?,IJ pR? + ?

?=i, j

(
DR?,?(IJ) pR?,?(IJ)?DL?,?(IJ) pL?,?(IJ)

)?? (3.67)
os novos coeficientes A e D são expressos como segue:

AL?,IJ = wL?,IJ
(

?L?,i(IJ) + ?L?, j(IJ)

)
, AR?,IJ = wR?,IJ

(
?R?,i(IJ) + ?R?, j(IJ)

)
, (3.68)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 57

Figura 9 – Estêncil para o calculo do fluxo utilizando os pontos interpolação centrados nos
vértices: estêncil do método MPFA-HD (esquerda) e estêncil usado pelo método
MPFA-D (direita)

Fonte – Produzido pelo autor

DL?,?(IJ) = wL?,IJ ?L?,?(IJ) e DR?,?(IJ) = wR?,IJ ?R?,?(IJ) para ? = i, j. (3.69)

onde os parâmetros ?L?,?(IJ) e ?R?,?(IJ) com ? = i, j são dados nas equações (3.30) e (3.32).
As pressões nos vértices pL?,i(IJ), pL?, j(IJ), pR?,i(IJ) e pR?, j(IJ) são interpoladas utilizando a

estratégia de interpolação LPEW descrito na seção anterior.
Na figura 9, notamos por exemplo, que o estêncil de interpolação para obter o fluxo na

superfície de controle em questão é ainda maior do que o estêncil de outros métodos MPFA clas-
sicos, como o MPFA-O (AAVATSMARK, 2002) ou MPFA-D (GAO; WU, 2011; CONTRERAS,
2016). A construção dos fluxos laterais é feita a partir de uma região que é similar a metade
de um diamante “Half Diamond” em 3-D (vide figura 4a), nesse sentido o método é nomeado
MPFA-HD.

Em casos particulares, por exemplo, quando o meio é homogêneo isotrópico e a malha é
ortogonal, o método MPFA-HD torna-se um método clássico chamado aproximação de fluxo
por dois pontos (TPFA). Para verificar esta observação consideramos a equação (3.63) sobre
uma malha ortogonal e meio homogêneo é isotrópico, a partir dos entes geométricos definidos
na figura 10 e de assumirmos que ? 2

L?,IJ
= ? 1

R?,IJ
= ?/4 então, pela equação (3.14), temos:

?L?,i(IJ) = ?L?, j(IJ) =
?~nIJ??

2
e ?R?,i(IJ) = ?R?, j(IJ) =

?~nJI??
2

(3.70)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 58

Figura 10 – Entes geométricos sobre uma malha K-ortogonal

Fonte – Produzido pelo autor

o que implica ter a seguinte expressão reduzida para os parâmetros

?L?,i(IJ) = ?L?, j(IJ) =
?~nIJ??
2?
??
xL?I?

e ?R?, j(IJ) = ?R?,i(IJ)
?~nJI??
2?
??
xR?I?

(3.71)

onde ?~nIJ?=?~nJI?= 1 já que o vetor ~nIJ é normal unitário a face IJ. E os coeficientes dados na
equação (3.71) são substituídos na expressão do fluxo dado na equação (3.67), assim temos:

~VIJ ·~NIJ =
?

2?IJ?
??
IJ?

{
wR?,IJ
?
??
xL?I?

pL? ?
wL?,IJ
?
??
xR?I?

pR? +

(
wL?,IJ

2?
??
xR?I?

?
wR?,IJ

2?
??
xL?I?

)
(pI + pJ)

}
(3.72)

Na equação (3.64) é fácil verificar que os pesos possuem o mesmo valor, ou seja, wL?,IJ =
wR?,IJ = 0.5, e também temos a seguinte igualdade ?

??
xR?I? = ?

??
xL?I?, então após manipulações

algébricas obtemos a seguinte expressão do fluxo:

~VIJ ·~NIJ = ?IJ?
??
IJ?
?

2wR?,IJ
?
??
xL?I?

{
pL? ? pR?

}
(3.73)

a expressão do fluxo anterior é descrito como função somente das pressões pL? e pR?, tornando-se
um método clássico de aproximação dos fluxos por dois pontos (TPFA).

3.2.2.1 Tratamento do Fluxo nas Faces de Contorno do Método MPFA-HD

Quando a face em questão pertence ao contorno do domínio ? ?, analisamos dois casos.
Primeiro quando aquela face IJ ? E ext ?EL? ? ?D, neste caso a variável pressão sobre os vértices
são conhecidas, portanto não precisam ser interpoladas. Desde a equação (3.29), temos:

~VIJ ·~NIJ = ~V L?IJ ·~NIJ = AL?,IJ pL? ??IJ?
??
IJ?
(

?L?,i(IJ) pL?,i(IJ) + ?L?, j(IJ) pL?, j(IJ)
)

(3.74)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 59

Figura 11 – Fluxo na face de Neumann

Fonte – Produzido pelo autor

onde
AL?,IJ = ?IJ?

??
IJ?
(

?L?,i(IJ) + ?L?, j(IJ)

)
(3.75)

Vamos fazer uma breve analise das variáveis auxiliares pL?,i(IJ) e pL?, j(IJ) quando os fluxos
estão localizados na fronteira de Dirichlet, dois casos que podem acontecer, a saber:

Se a co-normal interseta a face em questão IJ ? E ext ?EL? ? ?D, então as variáveis
auxiliares pL?,i(IJ) e pL?, j(IJ) são fornecidas pela física do problema, ou seja, pL?,i(IJ) = gD,i(IJ) e
pL?, j(IJ) = gD, j(IJ), neste caso o fluxo pode ser escrito como:

~VIJ ·~NIJ = AL?,IJ pL? ??IJ?
??
IJ?
(

?L?,i(IJ)gD,i(IJ) + ?L?, j(IJ)gD, j(IJ)
)

(3.76)

o segundo termo da igualdade a direita passa diretamente ao vetor termo de fonte como um
coeficiente conhecidos.

Quando a co-normal intersecta uma face interior composta de um vértice que pertence a
fronteira de Dirichlet e outro vértice que pertence ao interior da malha (veja figura 11), o fluxo
na face em questão IJ ? E ext ?EL? ? ?D, pode ser escrito como:

~VIJ ·~NIJ = AL?,IJ pL? ??IJ?
??
IJ??L?, j(IJ) pL?, j(IJ)??IJ?

??
IJ??L?,i(IJ)gD,i(IJ) (3.77)

onde o termo pL?, j(IJ) deve ser interpolado utilizando o método LPEW e o ultimo termo passa
diretamente ao vetor do termo de fonte.

Consideremos a face em questão IJ ? E ext ?EL? ? ?N sobre a fronteira de Neumann,
neste caso o fluxo é prescrito pela seguinte relação:

~VIJ ·~NIJ = gN?
??
IJ? (3.78)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 60

onde gN representa o valor prescrito na fronteira de Neumann. Embora as pressões nos vértices
desta face precisam ser interpolados utilizando o método de interpolação LPEW dada na equação
(3.61).

3.2.2.2 Sistema Discreto do Método MPFA-HD

Utilizando as equações (3.67), (3.74) e (3.78) sobre cada superfície de controle IJ
obtemos uma equação onde as incógnitas são pressões totalmente centradas nos volumes de
controle

?
IJ?EL?

~VIJ ·~NIJ = Q?L?VL?, ?L? ? M (3.79)

A equação anterior escrita para cada volume de controle L?, gera um sistema de equações,
escrita na forma compacta como:

A˜?P˜ = B˜ (3.80)
onde A˜? é matriz de transmissibilidade de dimensão n×n, P˜ é o vetor de pressões com dimensão
n×1 e B˜ é o vetor de dimensão n×1 cujas entradas são obtidos a partir das condições de
contorno e termos de fonte/sumidouro.

Na equação (3.80) a montagem da matriz global é feita a partir de matrizes locais
referentes as faces. Consideramos uma face interior IJ ?E int , para o qual representamos a matriz
local

A˜?IJ = [?i j]2×n` , i = L?,R? e j = S?1,S?2,...,S?n` (3.81)
onde n` ? n é número de volumes de controle presente no estêncil correspondente a face IJ, os
volumes de controle S?1,S?2,...,S?n` que conformam a vizinhança dos volumes de controle L? e R?
(incluindo eles mesmos) sem repetição são obtidos a partir da estratégia de interpolação dada na
equação (3.52).

Os componentes do vetor B˜G são calculados a partir das contribuições dos condições de
contorno e termos de fonte e/ou sumidouro, assim:

B˜i = Q?i?Vi? ?
?
? ?

IJ?E ext?Ei?

?ii + gN?
??
IJ?

?
? (3.82)

Idealmente, o sistema descrito na equação (3.80) deveria ser monótono e satisfazer o
principio de máximo discreto, isto para assegurar que as soluções sejam de livre de oscilações



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 61

espúrias, mas pela construção da estratégia de interpolação os pesos de interpolação não pre-
servam positividade, portanto o nosso método linear MPFA-HD pode violar o principio do
máximo discreto. Os autores (LE POTIER, 2005; LIPNIKOV, 2007; YUAN; SHENG, 2008)
fundamentam que qualquer método linear é propenso a produzir oscilações espúrias.

3.2.3 Método dos Volumes Finitos Não Linear que Satisfaz o Princípio do
Máximo Discreto (NLFV-DMP)

O método que apresentamos nesta seção foi concebido a partir dos métodos propostos
por Sheng e Yuan (2011) e Gao e Wu (2013), respectivamente. Este método satisfaz as seguintes
propriedades numéricas:

• É localmente conservativo.

• Satisfaz o principio de máximo discreto.

• Possui um estêncil local.

• Permite trabalhar com tensores de permeabilidade anisotrópicos.

• Possui taxas de convergência de segunda ordem para soluções suaves e primeira ordem
para o fluxo.

• Preserva linearidade.

Uma das características relevantes deste método frente a outros métodos clássicos é a
utilização de uma técnica de interpolação que é bastante robusta e faz com que o método possua
estêncil local. Os pontos de interpolação são introduzidos em cada face do volume de controle, e
na literatura são conhecidos como os pontos harmônicos (AGÉLAS, 2009; GAO; WU, 2013).
O uso dos pontos harmônicos não somente simplifica o processo de interpolação, mas também
preserva a positividade de este. Por exemplo, o estêncil em malhas triangulares é de 4 pontos,
em uma malha não estruturada quadrilateral o estêncil é de 5 pontos.

A partir das equações (3.12) até (3.32), os pontos de interpolação são substituídos pelos
pontos harmônicos, a estratégia de interpolação sobre estes pontos fornece pesos que preservam
positividade, essa condição de positividade é vantajosa no presente método, ja que é uma das
condições para satisfazer o princípio do máximo discreto.

A partir dos fluxos laterais dados nas equações (3.29) e (3.31) sobre uma face interior
IJ ? E int , podemos definir o fluxo único como uma combinação linear dos fluxos laterais, assim:

~VIJ ·~NIJ = ?L?,IJ~V
L?
IJ ·~NIJ ??R?,IJ~V

R?
IJ ·~NJI (3.83)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 62

onde os parâmetros não lineares ?L?,IJ e ?R?,IJ são definidos como:

?L?,IJ =

???~V R?IJ ·~NIJ??????~V R?IJ ·~NIJ???+???~V L?IJ ·~NIJ??? e ?R?,IJ = 1??L?,IJ (3.84)
As equações acima são definidas quando

???~V R?IJ ·~NJI???+ ???~V L?IJ ·~NIJ??? 6= 0, caso contrario
?L?,IJ = ?R?,IJ = 0.5, quando acontece este último, caso pode acontecer que

~VIJ ·~NIJ = 0, este
caso patológico será estudado nas próximas equações.

Quando a face em questão pertence ao contorno do domínio (IJ ? E ext ) o fluxo único
pode ser escrito como:

~VIJ ·~NIJ = ~V L?IJ ·~NIJ (3.85)

Substituindo os pesos dados na equação (3.84) em (3.83), temos:

~VIJ ·~NIJ =

???~V R?IJ ·~NJI??????~V R?IJ ·~NJI???+???~V L?IJ ·~NIJ???~V
L?
IJ ·~NIJ ?

???~V L?IJ ·~NIJ??????~V R?IJ ·~NJI???+???~V L?IJ ·~NIJ???~V
R?
IJ ·~NJI (3.86)

Para derivar a expressão estendida do fluxo único analisamos dois casos, este tipo de
analise foi adaptado de Sheng e Yuan (2011).

Para começar, assumirmos que
(
~V L?IJ ·~NIJ

)(
~V R?IJ ·~NJI

)
? 0, o que implica ~V L?IJ ·~NIJ ? 0

e ~V R?IJ ·~NJI ? 0 ou ~V
L?
IJ ·~NIJ ? 0 e ~V

R?
IJ ·~NJI ? 0, o que é equivalente a

???~V R?IJ ·~NJI???~V L?IJ ·~NIJ =
?
???~V L?IJ ·~NIJ???~V R?IJ ·~NJI . Logo substituindo na equação anterior,obtemos:

~VIJ ·~NIJ =
2
???~V R?IJ ·~NJI??????~V R?IJ ·~NJI???+???~V L?IJ ·~NIJ???~V

L?
IJ ·~NIJ (3.87)

e

~VIJ ·~NJI =
2
???~V L?IJ ·~NIJ??????~V R?IJ ·~NJI???+???~V L?IJ ·~NIJ???~V

R?
IJ ·~NJI (3.88)

Os fluxos laterais dados nas equações (3.29) e (3.31) são substituídos nas equações
anteriores, logo temos:

~VIJ ·~NIJ = 2?IJ
?????IJ????L?,IJ ?

?=i, j

?L?,?(IJ)

(
pL? ? pL?,?(IJ)

)
(3.89)

e
~VIJ ·~NJI = 2?IJ

?????IJ????R?,IJ ?
?=i, j

?R?,?(IJ)

(
pR? ? pR?,?(IJ)

)
(3.90)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 63

onde os coeficientes ?L?,i(IJ) e ?L?, j(IJ) (resp. ?R?,i(IJ) e ?R?, j(IJ)) são dadas na equação (3.30) (resp.
(3.32)). E as variáveis auxiliares pL?,?(IJ) e pR?,?(IJ), ? = i, j são interpoladas utilizando uma
estratégia de interpolação.

Agora vamos assumir que
(
~V L?IJ ·~NIJ

)(
~V R?IJ ·~NJI

)
&gt; 0, o que implica ~V L?IJ ·~NIJ &amp;lt;0 e

~V R?IJ ·~NJI &amp;lt;0 ou ~V
L?
IJ ·~NIJ &gt; 0 e ~V

R?
IJ ·~NJI &gt; 0 o que é equivalente a seguinte igualdade

???~V R?IJ ·~NIJ???~V L?IJ ·
~NIJ =

???~V L?IJ ·~NIJ???~V R?IJ ·~NIJ , logo substituindo na equação (3.86), obtemos:
~VIJ ·~NIJ = 0 (3.91)

Considerar fluxo nulo na nossa formulação pode causar problemas de conservação de
massa. Para evitar este tipo de problemas utilizamos o critério proposto por Sheng e Yuan (2011)
e Gao e Wu (2013), este critério consiste em dividir os fluxos laterais dados nas equações (3.29)
e (3.31):

~V L?IJ ·~NIJ = F
(1)

L?,IJ
+ F (2)

L?,IJ
e ~V R?IJ ·~NIJ = F

(1)
R?,IJ

+ F (2)
R?,IJ

(3.92)

Os fluxos parciais são expressados por:

F (1)r,IJ = (1??)?IJ
?????IJ????r,i(IJ)(pr ? pr,i(IJ)) (3.93)

e
F (2)r,IJ = ? ?IJ

?????IJ????r,i(IJ)(pr ? pr,i(IJ))+ ?IJ ?????IJ????r, j(IJ)(pr ? pr, j(IJ)) (3.94)
onde r = L?,R? e ? ? [0,1].

Neste caso os coeficientes não lineares ?L?,IJ e ?R?,IJ são definidos em função dos fluxos
parciais, isto é:

?L?,IJ =

???F (2)
R?,IJ

??????F (2)
R?,IJ

???+???F (2)
L?,IJ

??? e ?R?,IJ =
???F (2)

L?,IJ

??????F (2)
R?,IJ

???+???F (2)
L?,IJ

??? (3.95)
Notamos que os coeficientes definidos na equação acima além depender das variáveis

auxiliares pr,i(IJ) e pr, j(IJ) com r = L?,R? também dependem das variáveis primarias pL? e pR? o que
caracteriza a não linearidade do método.

Substituindo na equação (3.83) e reorganizando temos:

~VIJ ·~NIJ = ?L?,IJ F
(1)

L?,IJ
??R?,IJ F

(1)
R?,IJ

+ ?L?,IJ

?
?1?

???F (2)
L?,IJ

???
F (2)

L?,IJ

F (2)
R?,IJ???F (2)
R?,IJ

???
?
?F (2)

L?,IJ
(3.96)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 64

e

~VIJ ·~NJI = ?R?,IJ F
(1)

R?,IJ
??L?,IJ F

(1)
L?,IJ

+ ?L?,IJ

?
?1?

???F (2)
R?,IJ

???
F (2)

R?,IJ

F (2)
L?,IJ???F (2)
L?,IJ

???
?
?F (2)

R?,IJ
(3.97)

As equações anteriores pode-se expressar de maneira equivalente como:

~VIJ ·~NIJ = ?L?,IJ F
(1)

L?,IJ
??R?,IJ F

(1)
R?,IJ

+ ?L?,IJ

(
1?sgn

(
F (2)

L?,IJ
×F (2)

R?,IJ

))
F (2)

L?,IJ
(3.98)

e
~VIJ ·~NJJ = ?R?,IJ F

(1)
R?,IJ
??L?,IJ F

(1)
L?,IJ

+ ?R?,IJ

(
1?sgn

(
F (2)

L?,IJ
×F (2)

R?,IJ

))
F (2)

R?,IJ
(3.99)

onde a função sgn é denotado por:

sgn(x) =

?????
????
?1 se x &amp;lt;0

0 se x = 0

1 se x &gt; 0

(3.100)

Antes de derivar a forma reduzida dos fluxos das equações (3.98) e (3.99), introduzimos
o método de interpolação das variáveis auxiliares localizados sobre os pontos harmônicos.

3.2.3.1 Estratégia de Interpolação Utilizando Pontos Harmônicos (HP)

Consideremos dois volumes de controle L? e R? adjacentes a face IJ, com os respectivos
tensores de permeabilidades K˜L? e K˜R?, e sejam os baricentros xL? ? L? e xR? ? R?. A fim de obter
um método com estêncil pequeno possível, nos procuramos algum ponto sobre a face IJ onde a
solução naquele ponto seja uma combinação somente de pL? e pR?. Então, nesse sentido sempre é
possível escrever as co-normais K˜&gt;L?~nIJ e K˜&gt;R?~nIJ como segue:

K˜&gt;L?~nIJ = aL? (yIJ ?xL?)+ bL? (J?I) (3.101)
e

K˜&gt;R?~nIJ = aR? (xR? ?yIJ)+ bR? (J?I) (3.102)
Os coeficientes aL? e aR? são dados por:

aL? =
K(n)

L?,IJ

hL?,IJ
, aR? =

K(n)
R?,IJ

hR?,IJ
, K(n)

L?,IJ
=~n&gt;IJ K˜L?~nIJ, e K(n)R?,IJ =~n&gt;JI K˜R?~nJI (3.103)

onde hL?,IJ (resp. hR?,IJ ) são as distancias ortogonais do ponto xL?(resp. xR?) a face IJ.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 65

Subtraindo a equação (3.102) de (3.101), temos:

(
K˜&gt;L? ?K˜&gt;R?

)
~nIJ =?aR?xR? ?aL?xL? +

(
aR? + aL?

)
yIJ ?bR? (J?I)+ bL? (J?I) (3.104)

logo isolando o ponto yIJ em função dos parâmetros físicos-geométricos conhecidos, têm-se:

yIJ =
aR?xR? + aL?xL? +

(
K˜&gt;L? ?K˜&gt;R?

)
~nIJ

aR? + aL?
+

bR? (J?I)?bL? (J?I)
aR? + aL?

(3.105)

os coeficientes aL? e aR? dadas na equação (3.103) são substituídos na equação anterior, assim
temos:

yIJ =
hL?,IJ K

(n)
R?,IJ

xR? + hR?,IJ K
(n)
L?,IJ

xL? + hL?,IJ hR?,IJ
(

K˜&gt;L? ?K˜&gt;R?
)
~nIJ

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

+
hL?,IJ hR?,IJ

(
bR? ?bL?

)
(J?I)

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ
(3.106)

De outra parte, utilizando a expansão em series de Taylor, temos que:

p(yIJ)?p(xL?)?= ?p·
(
yIJ ?xL?

)
, p(xR?)?p(yIJ)?= ?p·

(
xR? ?yIJ

)
e pJ?pI ?= ? p·(J?I)

(3.107)

utilizando as equações (3.101) e (3.102), temos:

?K˜L?? p·~nIJ =??p·K˜&gt;L?~nIJ =?aL??p·(yIJ ?xL?)?bL?? p·(J?I) (3.108)
e

?K˜R??p·~nIJ =?? p·K˜&gt;R?~nIJ =?aR??p·(xR? ?yIJ)?bR?? p·(J?I) (3.109)
Integrando ambas as equações sobre a face IJ e pela equação (3.107), obtemos:

?
IJ
?K˜L??p·~nIJ dS =???IJ?(?aL? (p(yIJ)? p(xL?))?bL? (pJ ? pI)) (3.110)

e ?
IJ
?K˜R?? p·~nIJ dS =???IJ?(?aR? (p(xR?)? p(yIJ))?bR? (pJ ? pI)) (3.111)

Os fluxos definidos nas equações acima devem satisfazer a seguinte equação de continui-
dade

?
IJ
?K˜L?? p·~nIJ dS +

?
IJ
?K˜R??p·~nIJ dS = 0 (3.112)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 66

Figura 12 – Os pontos harmônicos

Fonte – Produzido pelo autor

logo substituindo as equações (3.110) e (3.111) na equação anterior e após manipulações algé-
bricas, temos:

p(yIJ) =
aL? p(xL?)+ aR? p(xR?)

aL? + aR?
+

bR? ?bL?
aL? + aR?

(pJ ? pI) (3.113)

substituindo os coeficientes aL? e aR? dada em equação (3.103), obtemos:

p(yIJ) =
hR?,IJ K

(n)
L?,IJ

p(xL?)+ hL?,IJ K
(n)
R?,IJ

p(xR?)

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

+
hL?,IJ hR?,IJ

(
bR? ?bL?

)
hL?,IJ K

(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

(pJ ? pI) (3.114)

A condição suficiente para derivar um método com estêncil local deve assumir que
bL? = bR?, logo da equação (3.106), temos:

yIJ =
hL?,IJ K

(n)
R?,IJ

xR? + hR?,IJ K
(n)
L?,IJ

xL? + hL?,IJ hR?,IJ
(

K˜&gt;L? ?K˜&gt;R?
)
~nIJ

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

(3.115)

o ponto yIJ é representado na figura 12.
E a pressão naquele ponto yIJ é obtida pela seguinte equação

pIJ =
hR?,IJ K

(n)
L?,IJ

pL? + hL?,IJ K
(n)
R?,IJ

pR?

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

, p(xL?) = pL?, p(xR?) = pR? e pIJ = p(yIJ) (3.116)

De maneira equivalente a equação acima pode ser escrita como uma combinação convexa

pIJ = wL?,IJ pL? + wR?,IJ pR? (3.117)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 67

Figura 13 – Na figura esquerda são mostrados os pontos de interpolação obtidos pela equação
(3.115) e na direita os pontos harmônicos obtidos pela equação (3.119)

Fonte – Produzido pelo autor

onde

wL?,IJ =
hR?,IJ K

(n)
L?,IJ

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

e wR?,IJ = 1?wL?,IJ (3.118)

Segundo Gao e Wu (2013) os pontos definidos em (3.115) devem satisfazer duas condi-
ções para serem chamados de pontos harmônicos. Primeiro, o ponto yIJ deve ser definida sobre
face interior da malha computacional, ou seja, IJ ?E int e segundo que

{
xL? + hL?,IJ~nIJ,xR? ?hR?,IJ~nIJ

}
?

IJ 6= ? . Esta nomeação foi inicialmente introduzida por Agélas, Eymard e Herbin (2009) num
método linear sobre malhas quadrilaterais. Quando a face em questão IJ ? E ext ponto harmônico
torna-se ponto médio de aquela face.

Devemos observar ainda que, se o ponto de interpolação dado na equação (3.115) não
pertencer à face IJ, a fórmula (3.116) ainda pode ser utilizada. Este método de interpolação
caracteriza-se por produzir soluções lineares por partes, além disso, os pesos da equação (3.118)
preservam a positividade da solução e podem ser utilizados em métodos monótonos ou que
dispõem a satisfazer o principio do máximo discreto.

A desvantagem de utilizar os pontos harmônicos é que, quando aplicado a malhas
severamente distorcidas ou reservatórios de petróleo com elevada razão de anisotropia, os
coeficientes da equação (3.18) podem se tornar negativos levando a não existência de um eixo
auxiliar tal que o vetor co-normal pertença ao mesmo. Apresentamos dois casos onde os pontos
harmônicos podem não existir:

Caso 1. Consideramos a malha dada na figura 13, patologicamente o ponto de interpola-
ção pode cair em uma projeção da superfície de controle em questão, neste caso recomendamos



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 68

Figura 14 – Na figura esquerda são mostrados os ponto de interpolação obtida pela equação
(3.115) e na direita são mostradas os pontos harmônicos considerado como ponto
médio da superfície de controle

Fonte – Produzido pelo autor

considerar

yIJ =
hL?,IJ K

(n)
R?,IJ

xR? + hR?,IJ K
(n)
L?,IJ

xL?

hL?,IJ K
(n)
R?,IJ

+ hR?,IJ K
(n)
L?,IJ

(3.119)

Caso 2. Mesmo se os pontos de interpolação forem localizados sobre a superfície de controle
IJ pode acontecer que não existe uma região que contém o co-normal, veja a figura 14, neste
caso recomendamos utilizar o ponto médio da face como ponto de interpolação. Em ambos os
casos, considerar essas estratégias de solução podem prejudicar a acurácia, embora representam
de maneira adequada a física do problema.

Caso 3. Quando consideramos meios com razão de anisotrópicos alta e heterogêneo
sobre malhas severamente distorcidas, os dois casos anteriores não são suficientes para solucionar
problemas. Neste caso, os métodos NLFV-DMP e o MPFA-H (FUHRMANN J.; ROHDE, 2014)
produzem matrizes singulares. A utilização de métodos baseados em pontos harmônicos não
recomendável para problemas em malhas distorcidas e meios com alta razão de anisotropia e
heterogênea. Neste caso ainda não temos uma solução adequada.

As equações (3.98) e (3.99) podem ainda ser reduzidas utilizando a seguinte simplificação

?L?,IJ F
(1)

L?,IJ
??R?,IJ F

(1)
R?,IJ

= ?IJ
(

pL? ? pR?
)

e ?R?,IJ F
(1)

R?,IJ
??L?,IJ F

(1)
L?,IJ

= ?IJ
(

pR? ? pL?
)

(3.120)

Em efeito, assumindo que um dos pontos de interpolação (ponto harmônico) esta definido
sobre a face em questão tanto para o volumes de controle L? quanto para o volume de controle R?,
então a pressão naquele ponto de interpolação tanto para L? quanto para R? é dada por pL?,i(IJ) =



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 69

pR?,i(IJ), logo temos que pL?,i(IJ) = pR?,i(IJ) = wL?,IJ pL? + wR?,IJ pR?, substituindo na seguinte equação

?L?,IJ F
(1)

L?,IJ
??R?,IJ F

(1)
R?,IJ

= ?IJ

?????IJ???(1??)(?L?,IJ ?L?,i(IJ)(pL? ? pL?,i(IJ))??R?,IJ ?R?,i(IJ)(pR? ? pR?,i(IJ)))
(3.121)

temos:

?L?,IJ F
(1)

L?,IJ
??R?,IJ F

(1)
R?,IJ

= ?IJ
(

pL? ? pR?
)

(3.122)

onde ?IJ = ?IJ
?????IJ???(1??)(?L?,IJ ?L?,i(IJ)wR?,IJ + ?R?,IJ ?R?,i(IJ)wL?,IJ) é um coeficiente não nega-

tivo.
Assim, as equações (3.98) e (3.99) podem ser reescritas como:

~VIJ ·~NIJ = ?IJ
(

pL? ? pR?
)
+ ?L?,IJ

(
1?sgn

(
F (2)

L?,IJ
F (2)

R?,IJ

))
F (2)

L?,IJ
(3.123)

e
~VIJ ·~NJI = ?IJ

(
pR? ? pL?

)
+ ?R?,IJ

(
1?sgn

(
F (2)

L?,IJ
F (2)

R?,IJ

))
F (2)

R?,IJ
(3.124)

Após simplificar a expressão do fluxo, agora vamos analisar alguns casos a partir da
função signo.

Quando
(

F (2)
L?,IJ

)(
F (2)

R?,IJ

)
6 0, implica que sgn(F (2)

L?,IJ
F (2)

R?,IJ
) = 0 ou sgn(F (2)

L?,IJ
F (2)

R?,IJ
) =?1,

então temos:

~VIJ ·~NIJ =

??
??IJ

(
pL? ? pR?

)
+ ?L?,IJ F

(2)
L?,IJ

ou

?IJ
(

pL? ? pR?
)
+ 2?L?,IJ F

(2)
L?,IJ

(3.125)

e

~VIJ ·~NJI =

??
??IJ

(
pR? ? pL?

)
+ ?R?,IJ F

(2)
R?,IJ

ou

?IJ
(

pR? ? pL?
)
+ 2?R?,IJ F

(2)
R?,IJ

(3.126)

Quando
(

F (2)
L?,IJ

)(
F (2)

R?,IJ

)
&gt; 0, implica que sgn(F (2)

L?,IJ
F (2)

R?,IJ
) = 1, então obtemos os fluxos

ainda mas simplificados

~VIJ ·~NIJ = ?IJ
(

pL? ? pR?
)

e ~VIJ ·~NJI = ?IJ
(

pR? ? pL?
)

(3.127)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 70

Aplicando o algoritmo proposto por Sheng e Yuan (2011), podemos fazer um resumo
geral do método:

Caso 1. Se
(
~V L?IJ ·~NIJ

)(
~V R?IJ ·~NJI

)
? 0

Caso 1.1 Se
???~V L?IJ ·~NIJ???+???~V R?IJ ·~NJI??? 6= 0
?L?,IJ =

???~V R?IJ·~NIJ??????~V R?IJ·~NIJ???+???~V L?IJ·~NIJ??? e ?R?,IJ = 1??L?,IJ .
~VIJ ·~NIJ =

2
???~V R?IJ·~NIJ???~V L?IJ·~NIJ???~V R?IJ·~NIJ???+???~V L?IJ·~NIJ??? e ~VIJ ·~NJI =

2
???~V L?IJ·~NIJ???~V R?IJ·~NJI???~V R?IJ·~NIJ???+???~V L?IJ·~NIJ???.

Caso 1.2 Se
???~V L?IJ ·~NIJ???+???~V R?IJ ·~NJI??? = 0
?L?,IJ = ?R?,IJ = 0.5.
~VIJ ·~NIJ = 2?L?,IJ~V

L?
IJ ·~NIJ e ~VIJ ·~NJI = 2?R?,IJ~V

R?
IJ ·~NJI .

Caso 2. Se
(
~V L?IJ ·~NIJ

)(
~V R?IJ ·~NJI

)
&gt; 0

Caso 2.1. Se
(

F (2)
L?,IJ

)(
F (2)

R?,IJ

)
? 0

Caso 2.1.1. Se
???F (2)

L?,IJ

???+???F (2)
R?,IJ

??? 6= 0
?L?,IJ =

???F (2)
R?,IJ

??????F (2)
L?,IJ

???+???F (2)
R?,IJ

??? e ?L?,IJ =
???F (2)

L?,IJ

??????F (2)
L?,IJ

???+???F (2)
R?,IJ

???.
~VIJ ·~NIJ = ?IJ

(
pL? ? pR?

)
+ 2?L?,IJ F

(2)
L?,IJ

e

~VIJ ·~NJI = ?IJ
(

pR? ? pL?
)
+ 2?R?,IJ F

(2)
R?,IJ

.

Caso 2.1.2. Se
???F (2)

L?,IJ

???+???F (2)
R?,IJ

??? = 0
?L?,IJ = ?R?,IJ = 0.5.
~VIJ ·~NIJ = ?IJ

(
pL? ? pR?

)
+ 2?L?,IJ F

(2)
L?,IJ

e

~VIJ ·~NJI = ?IJ
(

pR? ? pL?
)
+ 2?R?,IJ F

(2)
R?,IJ

.

Caso 2.2. Se
(

F (2)
L?,IJ

)(
F (2)

R?,IJ

)
&gt; 0

?L?,IJ =

???F (2)
R?,IJ

??????F (2)
L?,IJ

???+???F (2)
R?,IJ

??? e ?L?,IJ =
???F (2)

L?,IJ

??????F (2)
L?,IJ

???+???F (2)
R?,IJ

???.
~VIJ ·~NIJ = ?IJ

(
pL? ? pR?

)
e ~VIJ ·~NJI = ?IJ

(
pR? ? pL?

)
.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 71

Figura 15 – Fluxo no contorno de Dirichlet

Fonte – Produzido pelo autor

3.2.3.2 Tratamento dos Fluxos nas Faces de Contorno do Método NLFV-DMP

Quando a superfície de controle em questão pertence ao contorno do domínio ? ?.
Primeiramente consideramos quando a face em questão pertence ao contorno de Dirichlet, assim
o calculo do fluxo é dada por:

~VIJ ·~NIJ = ~V L?IJ ·~NIJ = ?IJ
?????IJ???

?
?AL?,IJ pL? ? ?

?=i, j

?L?,?(IJ) pL?,?(IJ)

?
? (3.128)

onde AL?,IJ = ?L?,i(IJ) + ?L?, j(IJ).
Na equação (3.74) a pressões prescritas nos vértices do contorno de Dirichlet são denota-

das por gD,i(IJ) e gD, j(IJ).
O fluxo no contorno de Neumann é dada pela seguinte expressão

~VIJ ·~NIJ = gN
?????IJ??? (3.129)

onde gN representa o valor do fluxo prescrito na face que pertence ao contorno de Neumann.
Vamos analisar o tratamento das pressões no contorno considerando quatro casos dife-

rentes:
Caso 1. Consideremos a equação (3.128), de tal maneira que um dos pontos de interpola-

ção esta localizado sobre a face IJ ? ?D ? EL? ?E
ext e o outro ponto de interpolação pertence a

face interna, veja figura 15. Sem perda de generalidade, vamos assumir que a pressão pL?,i(IJ) é
fornecida pela condição de Dirichlet, logo temos:

~VIJ ·~NIJ = ?IJ
?????IJ???(AL?,IJ pL? ??L?, j(IJ) pL?, j(IJ))??IJ ?????IJ????L?,i(IJ)gD, pL?,i(IJ) = gD (3.130)

Caso 2. Neste caso vamos assumir que a face em questão coincide com a fronteira de
Neumann IJ ? ?N ? EL? ?E

ext , o que implica que um dos pontos de interpolação esta localizado



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 72

Figura 16 – Fluxo no contorno de Neumann para o caso 1

Fonte – Produzido pelo autor

Figura 17 – Fluxo no contorno de Neumann para caso 2

Fonte – Produzido pelo autor

sobre a face IJ e o outro ponto de interpolação esta localizado sobre alguma face interna da malha
computacional, veja figura 16. Então, aquela pressão sobre a contorno de Neumann (pL?,i(IJ))
deve ser interpolado a partir da equação do fluxo. Vamos assumir que pela equação (3.128) que
~VIJ ·~NIJ = gN

?????IJ???, logo temos:
pL?,i(IJ) =

AL?,IJ
?L?,i(IJ)

pL? ?
?L?, j(IJ)

?L?,i(IJ)
pL? j(IJ)?

gN
?IJ ?L?,i(IJ)

(3.131)

Caso 3. Segundo a figura 17, temos duas fronteiras de Neumann IJ,IJ?? ?N ?EL??E
ext ,

sendo que a co-normal pertence a região formada por essas. consequentemente teríamos duas
pressões que temos que interpolar, a saber: pL?,i(IJ) = pL?, j(IJ?) = m1 e pL?,i(IJ) = pL?,i(IJ?) = m2.
Considerando fluxos definidos nas superfícies de controle IJ, IJ?

~VIJ ·~NIJ = ?IJ
?????IJ???(AL?,IJ pL? ??L?,i(IJ) pL?,i(IJ)??L?, j(IJ) pL?, j(IJ)) (3.132)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 73

Figura 18 – Fluxo no contorno de Neumann para o caso 3

Fonte – Produzido pelo autor

e
~VIJ? ·~NIJ? = ?IJ?

?????IJ????(AL?,IJ? pL? ??L?,i(IJ?) pL?,i(IJ?)??L?, j(IJ?) pL?, j(IJ?)) (3.133)
de maneira equivalente pode ser escrito como:

gN,1
?IJ

= AL?,IJ pL? ??L?,i(IJ)m1 ??L?, j(IJ)m2 (3.134)

e
gN,2
?IJ?

= AL?,IJ? pL? ??L?,i(IJ?)m2 ??L?, j(IJ?)m1 (3.135)

Das equações acima temos duas equações e duas incógnitas (m1 e m2), resolvendo o
sistema temos:

m1 =

?gN,1?L?,i(IJ?)
?IJ

+
gN,2?L?, j(IJ)

?IJ?

?L?,i(IJ?)?L?,i(IJ)??L?, j(IJ)?L?, j(IJ?)
+

?L?,i(IJ?)AL?,IJ ??L?, j(IJ)AL?,IJ?
?L?,i(IJ?)?L?,i(IJ)??L?, j(IJ)?L?, j(IJ?)

pL? (3.136)

e

m2 =

?gN,1?L?, j(IJ?)
?IJ

+
gN,2?L?,i(IJ)

?IJ?

?L?, j(IJ?)?L?, j(IJ)??L?,i(IJ)?L?,i(IJ?)
+

?L?, j(IJ?)AL?,IJ ??L?,i(IJ)AL?,IJ?
?L?, j(IJ?)?L?, j(IJ)??L?,i(IJ)?L?,i(IJ?)

pL? (3.137)

Na equação anterior foram interpolados as pressões pL?,i(IJ) = pL?, j(IJ?) = m1 e pL?,i(IJ) =
pL?,i(IJ?) = m2 sobre as fronteiras de Neumann.

Caso 4. Neste caso vamos assumir que a superfície de controle em questão pertence
ao contorno de Neumann IJ ? ?N ? EL? ?E

ext , necessariamente a pressão localizada sobre esta
superfície de controle deve ser interpolada, além disso, assumirmos que a superfície de controle
contrária está localizada sobre o contorno de Dirichlet (veja figura 18), então a pressão localizada



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 74

naquela superfície de controle é fornecida pela física do problema. Interpolamos a pressão
localizada sobre IJ ? ?N

pL?, j(IJ) =?
gN

?L?, j(IJ)
+

AL?,IJ
?L?, j(IJ)

pL? ?
?L?,i(IJ)

?L?, j(IJ)
gD (3.138)

onde gD = pL?,i(IJ).

3.2.3.3 Sistema Discreto do Método NLFV-DMP

A partir da equação (3.6), temos:

?
IJ?EL?

~VIJ ·~NIJ = QL?VL?, ?L? ? M (3.139)

Logo ~VIJ ·~NIJ é definido como:

~VIJ ·~NIJ =

??
??IJ

(
pL? ? pR?

)
+ ?L?,IJ

{
1?sgn

(
F (2)

L?,IJ
F (2)

R?,IJ

)}
F (2)

L?,IJ
, IJ ? E int

~V L?IJ ·~NIJ, IJ ? E
ext ?EL?

(3.140)

Desde equação (3.139), obtemos:

?
IJ?EL??ER??EL??E

int

?IJ
(

pL? ? pR?
)
+ ?

IJ?EL?

?L?,IJ F
(2)

L?,IJ
+ ?

IJ?EL??E
ext

?IJ?
??
IJ??L?,IJ

(
pL? ? pL?,IJ

)
= QL?VL?

(3.141)

onde

?L?,IJ =

??
??L?,IJ

{
1?sgn

(
F (2)

L?,IJ
F (2)

R?,IJ

)}
, IJ ? EL? ?ER? ? EL? ?E

int

1, IJ ? EL? ?E
ext

(3.142)

Mantendo fixo o volume de controle L? e percorrendo todas as superfícies de controle do
mesmo, além disso, utilizando as estratégia de interpolação temos:

?
R??M

AL?,R?
(

pL? ? pR?
)
+ ?IJ??

??
IJ?? ?

IJ??E ext
BL?,IJ?

(
pL? ? pIJ?

)
= QL?VL?, ?L? ? M (3.143)

onde

AL?,R? =

?????
????

?
IJ??EL??ER?

?IJ? + ?IJ?
??
IJ??wR?,IJ?

?
??L?,IJ?? ?L?,IJ? + ?

IJ?EL?,IJ
? 6=IJ

?L?,IJ ?L?,IJ

?
?, EL? ?ER? 6= ?

0, EL? ?ER? = ?
(3.144)



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 75

e

BL?,IJ? =

???
??

?
IJ?EL?

?L?,IJ ?L?,IJ, IJ
? ? EL? ?ER? e IJ 6= IJ

?

0, IJ? /? EL? ?ER?

(3.145)

Teorema 3. Assumimos que:
i). Para qualquer L? ? M , ?L?,i(IJ) e ?L?, j(IJ) são sempre não negativos.
ii). QL? = 0 e a condição de contorno é de tipo Dirichlet.
iii). A solução da equação (3.143) existe.
iv). Para cada L?,R? ?M , existem K1?,K2?,...,Kr? ?M de modo que AL?,K1? AK1?,K2?...AKr?,KR? 6= 0, além
disso, existe L? ? M e IJ? ? Eext de modo que BL?,IJ? 6= 0.

Então, umas das seguintes alternativas é verdade.

a). Para qualquer L? ? M , minIJ?Eext {pIJ}&amp;lt;pL? &amp;lt;maxIJ?Eext {pIJ}.
b). Para todo L? ? M , pL? = c e minIJ?Eext {pIJ}? pL? ? maxIJ?Eext {pIJ}.

Demonstração. A partir da hipótese, podemos concluir que AL?,R? ? 0 e BL?,IJ? ? 0 para qual-
quer L?,R? ? M , IJ? ? E ext . Suponhamos que a) não satisfeito, isto é, pL? ? maxIJ?E ext {pIJ}
para algum L? ? M . Certamente nesse caso podemos escolher L? de modo que pL? = c =
maxIJ?E ext ,R??M

{
pIJ, pR?

}
. Por ii) e equação (3.143), deduzimos que pIJ? = c para BL?,IJ? ?

0. Repetindo o argumento e usando iv) podemos provar b). Se a violação é o caso pL? ?
minIJ?E ext {pIJ} o argumento é similar, com o qual completamos a prova.

Seguindo a equação (3.143) conseguimos o sistema linear:

A˜?(p)P˜ = B˜(p) (3.146)
onde o vetor P˜ denota o vetor de pressões desconhecidos e A˜?(p) é matriz de coeficientes. o vetor
do lado direito B˜(p) é gerado pelo termo de fonte ou sumidouro e informações fornecidas a
partir das condições de contorno.

O sistema não linear (3.144) pode ser resolvido por um número de diferentes métodos.
Nós utilizamos as iterações de Picard fornecidas no algoritmo 1 na seções anteriores. Se sabe
que a cada iteração de Picard temos que resolver a seguinte equação linearizada, a qual vem
desde a equação (3.143)

?
R??M

A(k)
L?,R?

(
p(k+1)

L?
? p(k+1)

R?

)
+ ?IJ??

??
IJ?? ?

IJ??E ext
B(k)

L?,IJ?

(
p(k+1)

L?
? pIJ?

)
= QL?VL? (3.147)

onde k denota a iteração indexada não linear. Obviamente, o resultado do teorema 3 ainda serve
para esta equação. De acordo com nossas evidências numéricas as iterações de Picard sempre
convergem.



Capítulo 3. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO 76

Temos alguns fatos interessantes sobre a equação linearizada

• A equação (3.147) tem um estêncil pequeno que envolve somente o volume de controle L?
e volumes de controle que compartilham uma face comum com L? .

• Desde as definições dos pontos harmônicos, pode-se ver que os cálculos deste tipo podem
ser feitos localmente e somente a informação de uma superfície de controle ou volume de
controle é envolvida.



77

4 RESULTADOS NUMÉRICOS: ESCOA-
MENTO MONOFÁSICO

Nesta seção resolvemos alguns problemas benchmark, com o objetivo de analisar as
propriedades numéricas. Além disso, vamos comparar o nosso método MPFA-HD com outros
método lineares clássicos tipo MPFA-O e MPFA-FPS (AAVATSMARK, 1998; EDWARDS;
ZHENG, 2008). Logo comparamos os métodos não lineares NLFV-PP e o NLFV-DMP, final-
mente os método lineares com os métodos não lineares. Para avaliar os erros e taxas convergência
vamos utilizar a norma L2 e os erros numéricos são denotados por Ei, i = p,F e expressados nas
seguintes equações (EIGESTAD; KLAUSEN, 2005; LIPNIKOV, 2010):

Ep =

?
? ?

L??M

(
p?L? ? pL?

)2
VL?

?
?1/2 (4.1)

e

EF =

?
???

?
IJ?E

(
F?IJ ?FIJ

)2
AIJ

?
IJ?E

F? 2IJ AIJ

?
???

1/2

(4.2)

aqui FIJ =~v ·~n (onde ~v = ?K˜?p ) é a velocidade normal do escoamento na face IJ, a área
associado a cada face é representada por AIJ e consiste na media aritmética das áreas dos
volumes de controle adjacentes a cada face em questão. Finalmente, p? e p representam as
pressões exatas e as pressões numéricas obtidas por algum método numérico, respectivamente.
A velocidade analítica é representado por F? .

As taxas de convergência são calculados pela seguinte expressão

Ri =
log
(
E? (h2))
E? (h1))

)
log
(

h2
h1

) , i = p,F (4.3)
Na tabela 1 denotamos os acrônimos dos métodos clássicos que são utilizados para fazer

comparações com os método propostos.

4.1 Teste de Linearidade: Escoamento Monofásico com Drenagem
Oblíqua
Este problema foi adaptada de Herbin e Hubert (2008), Wu e Gao (2014) e representa

algumas situações encontrados em simulação de reservatórios. Este problema foi proposto para



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 78

Tabela 1 – Acrônimos dos métodos numéricos utilizados.

Notação Descrição dos Métodos
MPFA-O Proposto por (AAVATSMARK, 1998)
MPFA-FPS Proposto por (EDWARDS; ZHENG, 2008)
MPFA-HD Método proposto na Equação (3.67)
MPFA-H Método descrito no apêndice B
NLFV-PP Método proposto na Equação (3.41)
NLFV-DMP Método proposto nas Equações (3.123) e (3.124)

Fonte – Produzido pelo autor

analisar o critério de preservar linearidade sobre um meio heterogêneo e anisotrópico (veja figura
19b). O domínio é composto pelos seguintes subdomínios

?1 ={(x,y)? ? tal que: ?1(x,y) &amp;lt;0}

?2 ={(x,y)? ? tal que: ?1(x,y) &gt; 0, ?2(x,y)? 0}

?3 ={(x,y)? ? tal que: ?2(x,y) &gt; 0}

(4.4)

Neste caso, vamos considerar uma configuração em que a solução exata é dada por
p?(x,y) = 2?x?0.2y, para todo (x,y) ? ? e (x,y) ? ?D, o contorno exterior coincide com a
condição de contorno de Dirichlet. O tensor de permeabilidade é representada nas seguintes
equações para cada subdomínio

K˜1(x,y) = R
[

1 0
0 0.1

]
R&gt; sobre ?1 ??3 (4.5)

e

K˜2(x,y) = R
[

100 0
0 10

]
R&gt; sobre ?2 (4.6)

onde

R =

[
cos(? ) ?sin(? )
sin(? ) cos(? )

]
, ? = arctg(0.2) (4.7)

Tabela 2 – Erros entre solução exata e a solução numérica.

Erro MPFA-H MPFA-HD NLFV-PP NLFV-DMP
Ep 1.1481×10?15 9.8488×10?16 3.5372×10?12 8.2930×10?12

Niter — — 14 22
Fonte – Produzido pelo autor

Na figura 19a apresentamos o domínio e malha computacional utilizada com 100 quadri-
láteros obliquamente dispostos e na figura 19b o campo de permeabilidade. Segundo a tabela



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 79

Figura 19 – Malha quadrilateral (a) e o campo de permeabilidade (b)

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Figura 20 – Perfil do campo de pressão obtido pelo método NLFV-PP

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

2, observamos que, tanto os métodos lineares (MPFA-HD e MPFA-H), quanto os métodos não
lineares (NLFV-PP e NLFV-DMP), reproduzem exatamente a solução analítica. Por outro lado, o
número de iterações para o método NLFV-PP, foram 14 iterações de Picard para a convergência
da solução para uma tolerância de (tol = 10?13), o que acarretou num custo computacional
adicional se comparado com os métodos lineares. Enquanto o método NLFV-DMP precisou de
22 iterações de Picard para a mesma tolerânciaa. Na figura 20 observamos o perfil de pressões
obtido com o método NLFV-PP (análogo aos obtidos com os métodos lineares correspondentes).
Neste problema a propriedade de monotonicidade é equivalente a satisfazer o principio do
máximo discreto.



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 80

4.2 Teste de Convergência

4.2.1 Escoamento Monofásico num Reservatório Homogêneo Suavemente
Anisotrópico

Este problema foi adaptado de Gao e Wu (2013) com objetivo de testar numericamente a
acurácia dos métodos descritos em capítulos anteriores, quando consideramos um reservatório
homogêneo e suavemente anisotrópico com solução que não é linear. Neste exemplo o domínio é
um quadrado unitário (? = [0,1]2), discretizado por uma sequência de malhas não estruturadas
triangulares refinadas sucessivamente de modo a avaliarmos as taxas de convergência dos
métodos não lineares (NLFV-DMP; NLFV-PP) e dos métodos lineares (MPFA-HD; MPFA-H)
por meio das soluções obtidas nas diferentes malhas (veja figura 21). No método não linear,
utilizamos uma tolerância com respeito a iteração de Picard de tol = 10?14, onde a solução
analítica do problema é dada por:

p?(x,y) =
1
2

[
sin((1?x)(1?y))

sin(1)
+(1?x)3(1?y)2

]
(4.8)

onde a fronteira do domínio coincide com o contorno de Dirichlet, cujos valores da pressão no
contorno são diretamente calculados através da solução analítica.

Figura 21 – Malha triangular não estruturada (a) com 158 e (b) 576 volumes de controle

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

O tensor de permeabilidade é dado por:

K˜(x,y) =
[

1.5 0.5
0.5 1.5

]
(4.9)

Na tabela 3 observamos que todos os métodos, tanto os métodos não lineares NLFV-DMP
e NLFV-PP, quanto os métodos lineares, MPFA-HD e MPFA-H, alcançam uma acurácia de
segunda ordem no espaço para o campo de pressões. Nos casos de métodos não-lineares, também
incluímos o número de iterações de Picard necessárias para alcançarmos a convergência.



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 81

Tabela 3 – Erros e taxas de convergência do campo de pressões.

Método Erro/Taxa h = 0.125 h = 0.0625 h = 0.0313 h = 0.0156

MPFA-H
Ep 6.4408×10?4 2.1186×10?4 5.2402×10?5 1.2540×10?5
Rp — 1.6041 2.0201 2.0536

MPFA-HD
Ep 0.001 2.6447×10?4 7.1291×10?5 1.6946×10?5
Rp — 1.9233 1.89568 2.0632

NLFV-PP
Ep 0.001 2.4687×10?4 6.4178×10?5 1.5344×10?5
Rp — 2.0181 1.9483 2.0549

Niter 15 17 17 18

NLFV-DMP
Ep 6.3642×10?4 2.1060×10?4 5.0311×10?5 1.2714×10?5
Rp — 1.5954 2.0656 1.9845

Niter 42 40 54 47
Fonte – Produzido pelo autor

Tabela 4 – Erros e taxas de convergência do campo de velocidades.

Método Erro/Taxa h = 0.125 h = 0.0625 h = 0.0313 h = 0.0156

MPFA-H
EF 0.0062 0.002 9.3732×10?5 4.7137×10?5
RF — 1.6322 1.0959 0.9871

MPFA-HD
EF 0.0075 0.0024 7.7195×10?4 2.5038×10?4
RF — 1.6438 1.64023 1.6174

NLFV-PP
EF 0.007 0.0024 8.0091×10?4 2.6060×10?4
RF — 1.5443 1.5869 1.6123

Niter 15 17 17 18

NLFV-DMP
EF 0.0056 0.0018 8.4518×10?4 4.2730×10?4
RF — 1.6374 1.0906 0.98400

Niter 42 40 54 47
Fonte – Produzido pelo autor

Na tabela 4, mostramos que as taxas de convergência para as velocidades de Darcy
numéricas são próximas de 1.6 para todos os métodos propostos. Na figura 22a apresentamos o
campo de pressões obtido com o método MPFA-HD que possui um comportamento similar a
campo de pressões obtida com o método NLFV-PP (veja figura 22b).

4.3 Teste de Preservar Positividade (PP) e/ou Satisfaz o Principio
do Máximo Discreto (DMP)

4.3.1 Escoamento Monofásico Utilizando Condições de Contorno com Gradi-
ente Inclinada

Este problema foi adaptado de (GAO; WU, 2013). Neste teste as direções principais do
tensor anisotrópico são dadas de acordo com a condição de contorno e a orientação da malha. O
domínio computacional é dada por um quadrado unitário ([0,1]2), e o tensor anisotrópico é dado



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 82

por

K˜ =
[

cos(? ) ?sin(? )
sin(? ) cos(? )

][
1 0
0 10?4

][
cos(? ) sin(? )

?sin(? ) cos(? )

]
com ? = 40?. (4.10)

Para este problema o termo de fonte é zero (Q = 0). As condições de Dirichlet são
considerados, p? = gD sobre ? ? com gD um função linear continua por partes definido por

gD =

????????
???????

1, sobre (0,0.2)×0?0×(0,0.2)

0, sobre (0.8,1)×0?0×(0.8,1)

0.5, sobre (0.3,1)×0?0×(0.3,1)

0.5, sobre (0,0.7)×0?0×(0,0.7)

(4.11)

Para comparar os resultados utilizamos dois tipo de malhas, a saber: malha Kershaw
quadrilateral e malha triangular, como mostrado na figura 23.

Tabela 5 – Campo pressões máximos e mínimos obtidos pelos diferentes métodos, utilizando
malha Kershaw quadrilateral.

24×24 96×96
Método pmin pmax Niter pmin pmax Niter

MPFA-H 0.0052 0.9948 — 9.3754×10?4 0.9991 —
MPFA-HD 0.0067 0.9933 — 0.0013 0.9987 —
MPFA-O -0.0061 1.0061 — -0.0061 1.0061 —

MPFA-FPS -0.0797 1.0797 — -0.0829 1.0829 —
NLFV-PP 0.0088 0.9932 111 0.0017 0.9987 391

NLFV-DMP 0.005 0.9950 140 8.352×10?4 0.9992 551
Fonte – Produzido pelo autor

Na tabela 5 observamos que os métodos clássicos (MPFA-O e MPFA-FPS) violam o
DMP produzindo oscilações no perfil do campo de pressão, os métodos que estamos propondo

Figura 22 – Perfil do campo de pressão obtido com o método MPFA-HD (a) e NLFV-PP (b)

Fonte – Produzido pelo autor utilizando o software de visualização VisIt



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 83

Figura 23 – Malha triangular alinhada (a) e malha Kershaw quadrilateral (b)

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Figura 24 – Perfil do campo de pressões obtido sobre uma malha triangular alinhada 24x24: (a)
MPFA-O (cor de branco denota as regiões com valores negativos e a região cor de
rosa denota valores maiores que 1), (b) MPFA-HD e (c) NLFV-DMP

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

satisfazem o DMP em malha triangular alinhada (veja figura 23b).
Nas figuras 24, observamos que a solução tem característica de Z através do eixo y = x. Em figura
24a mostramos o perfil do campo de pressões obtida pelo método clássico MPFA-O sobre uma
malha triangular alinhada, percebemos que os valores das pressões são maiores que 1 e menores
que 0 violando o DMP, aquelas oscilações desaparecem quado utilizamos os métodos MPFA-HD,
NLFV-DMP (veja figuras 24b e 24c). Note que mesmo em malha estruturada uniforme os
métodos clássicos continuam com as oscilações numéricas.

Na tabela 6 observamos que os métodos clássicos (MPFA-O e MPFA-FPS) violam o
DMP produzindo oscilações no perfil do campo de pressão, os método que estamos propondo
satisfazem o DMP mesmo em malhas ligeiramente distorcidas (veja figura 23b).



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 84

4.3.2 Escoamento Monofásico em Reservatório Muito Heterogêneo e Aniso-
trópico

Este exemplo foi adotado de Queiroz, Souza, Contreras, Lyra e Carvalho (2014), com o
objetivo de avaliarmos o DMP, considerando um reservatório altamente heterogêneo e com tensor
de permeabilidade muito anisotrópico. O domínio consiste de um quadrado unitário ? = [0,1]2

com um furo no centro do domínio com dimensões [4/9,5/9], as descontinuidades do material
ocorre em x = 0.5 e as condições de contorno é puramente Dirichlet, onde a pressão no contorno
? ?ext = [0,1]? [4/9,4/9] é dada por p?ext = 0 e no contorno ? ? f uro = [4/9,4/9] é dada por
p? f uro = 2.

Os tensores de permeabilidade foram adotados dos autores Lipnikov, Shashkov, Svyatskiy
e Vassilevski (2007), Herbin e Hubert (2008)

K˜1(x,y) =
[

cos(? ) ?sin(? )
sin(? ) cos(? )

][
100 0

0 0.01

][
cos(? ) sin(? )

?sin(? ) cos(? )

]
, se x ? 0.5

(4.12)

e

K˜2(x,y) =
[

y21 + ax
2
1 ?(1?a)y1x1

?(1?a)y1x1 x21 + ay
2
1

]
com a = 103, se x &gt; 0.5 (4.13)

onde os valores dos parâmetros ? ,x1 e x2 foram adaptados de Queiroz, Souza, Contreras, Lyra e
Carvalho (2014) como segui: ? = ?/2, x1 = x + 10?3 e y1 = y + 10?3.

Neste problema utilizamos uma malha não estruturada triangular com 846 volumes de
controle e com 2730 volumes de controle, na figura 25 mostramos a malha mas refinada.
Na tabela 7 podemos observar que os valores obtidos pelos métodos NLFV-PP produz valo-

res positivos como esperado, embora viola o DMP. Enquanto o método NLFV-DMP produz
resultados no intervalo [0,2] para os dois tipos de refinamento de malha, respeitando os valores
extremos do intervalo. De outra parte, observamos que os métodos lineares propostos como

Tabela 6 – Pressões máximos e mínimos obtidos pelos diferentes métodos, utilizando malha
triangular não estruturada.

24×24 96×96
Método pmin pmax Niter pmin pmax Niter

MPFA-H 0.009 0.9910 — 0.0018 0.9982 —
MPFA-HD 0.0106 0.9894 — 0.0019 0.9981 —
MPFA-O -0.1199 1.1199 — -0.0170 1.0170 —

MPFA-FPS -0.0987 1.0987 — -0.0174 1.0174 —
NLFV-PP 0.0110 0.9894 46 0.9982 0.0021 294

NLFV-DMP 0.0085 0.9915 178 0.9979 0.0020 543
Fonte – Produzido pelo autor



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 85

Figura 25 – Malha não estruturada triangular

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Tabela 7 – Pressões máximos e mínimos obtidos pelos diferentes métodos, utilizando malha
triangular não estruturada.

846 2730
Método pmin pmax Niter pmin pmax Niter

MPFA-H -0.0694 1.965 — -0.2683 2.033 –
MPFA-HD -0.0994 1.913 — -0.0944 2.180 –
NLFV-PP 1.223×10?8 2.169 47 1.2230×10?8 3.0110 302

NLFV-DMP 1.483×10?6 1.865 180 3.1488×10?10 1.9946 643
Fonte – Produzido pelo autor

(MPFA-HD e MPFA-H) violam o DMP para ambas refinamentos das malhas não estruturadas.
Nas figuras 26 a e b podemos observar que os métodos lineares ainda conseguem representar a
física do problema, embora produzem valores negativos ou maiores que 2. Enquanto, na (figura
26c) o perfil do campo de pressão obtida pelo método NLFV-PP possui valores positivos, embora
maiores que 2, dessa forma violando o DMP. Na figura 26d o método NLFV-DMP possui valores
que respeitam o DMP tanto para malha grossa (846 volumes de controle) quanto na malha fina
(2730 volumes de controle).



Capítulo 4. RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO 86

Figura 26 – O perfil de pressão obtido pelo método: MPFA-H (a), MPFA-HD (b), NLFV-PP (c)
e NLFV-DMP (d).

Fonte – Produzido pelo autor utilizando o software de visualização VisIt



87

5 FORMULAÇÃO NUMÉRICA DA EQUA-
ÇÃO DE SATURAÇÃO

Em simulação de reservatórios de petróleo, uma maneira de discretizar o termo advectivo
que caracteriza a equação hiperbólica de saturação é utilizando o método clássico de ponderação
amontante de primeira ordem (FOU) qual é capaz de produzir soluções monótonas a baixo
custo computacional, um problema grave do método de primeira ordem, é que o excesso de
difusão numérica utilizada para eliminar as oscilações numéricas acaba por afetar sobremaneira
a precisão deste método, tornando-o de primeira ordem no espaço de todo o domínio (CARVA-
LHO, 2005). De outra parte, métodos de alta ordem produzem resultados não realísticos, com
oscilações numéricas no campo de saturação na vizinhança de choques ou descontinuidades. Por
conseguinte, é extremamente importante desenvolver esquemas monótonos, de ordem superior e
multidimensionais capazes de manusear o fluxo dos fluidos em meios porosos heterogêneos e
anisotrópicos utilizando malhas não estruturadas poligonais gerais não ortogonais.

5.1 Formulação Numérica Explícita para a Equação de Saturação
Integrando a Equação de Saturação, equação (2.14), no intervalo de tempo entre t0 e t e

no domínio ?, temos:? t
t0

?
?

? Sw
? t

dVdt =?
1
?

? t
t0

?
?

~?·~F (Sw)dVdt +
1
?

? t
t0

?
?

QwdVdt (5.1)

A integral no domínio ? pode ser representada por um somatório de integrais em cada
volume de controle L? ? M . Considerando a equação anterior para um volume de controle
genérico L? e utilizando o Teorema da Divergência de Gauss no primeiro termo do lado direito da
equação (5.1), temos:? t

t0

?
L?

? Sw
? t

dVdt =?
1
?

? t
t0

?
IJ
~F (Sw)·~nIJ dsdt +

1
?

? t
t0

?
L?

QwdVdt (5.2)

Integrando a equação acima no intervalo de tempo definido, utilizando o Teorema do
Valor Médio e uma aproximação do tipo Euler avançada para a derivada temporal, obtemos:? t

t0

?
L?

? Sw
? t

dVdt =
(

Sn+1
w,L?
?Sn

w,L?

)
VL?, (5.3)

1
?

? t
t0

?
IJ
~F (Sw)·~nIJ dsdt =

?t
?

?
IJ?EL?

~F(Sw)IJ ·~NIJ (5.4)

e
1
?

? t
t0

?
L?

QwdVdt =
Q?w?t

?
(5.5)



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 88

onde Sn
w,L?

e Sn+1
w,L?

são, respectivamente, os valores da saturação de água no volume de controle L?
nos instantes de tempo t n e t n+1. O valor médio do termo fonte ou sumidouro (poços de injeção
ou produção) es denotado por Q?w e o passo de tempo por ?t = t n+1 ?t n.

Substituindo as equações (5.3), (5.4) e (5.5) na equação (5.2), temos a equação de
saturação na forma discretizada dada pela seguinte equação:

Sn+1
w,L?

= Sn
w,L?
?

?t
?VL?

?
IJ?EL?

~FIJ ·~NIJ +
?tQ?w
?VL?

(5.6)

onde o fluxo hiperbólico é ~FIJ = fw
(
SnwIJ

)
~VIJ .

O passo de tempo ?t, deve ser calculado satisfazendo a seguinte condições de estabilidade
de Courant-Friedrich-Lewy (CFL) estabelecida por Colella (1990) e modificado para métodos
de alta ordem com processo de limitação multidimensional por Park e Kim (2012) e utilizado no
contexto simulação de reservatórios de petróleo por Souza (2015):

max
IJ?EL?

[???(? fw (Sw)/?Sw)IJ ~VIJ ·~NIJ???] ?tVL? ? C2k + 1 (5.7)
onde k é utilizado para obtenção de métodos de alta ordem, por exemplo, quando k = 0 estamos
tratando um polinômio reconstrutor de grau zero, que neste caso vai gerar naturalmente um
método de ponderação amontante de primeira ordem. Assim, o calculo de ?t deve satisfazer a
seguinte desigualdade

?t ?C
VL?

maxIJ?EL?

[???(? fw (Sw)/?Sw)IJ ~VIJ ·~NIJ???](2k + 1) (5.8)
onde C é número de CFL, (? fw (Sw)/?Sw)IJ é valor discreto de (? fw (Sw)/? Sw)IJ , e surge
naturalmente ao se definir a velocidade característica em cada face IJ do volume de controle L?
(SOUZA, 2015). Note-se que ~VIJ ·~NIJ é diretamente calculado a partir da equação de pressão,
sendo necessário apenas calcular o fluxo fracionário (veja equação (5.6)). Observe ainda que o
fluxo fracionário a ser usado deve ser calculado na superfície de controle IJ, porém o mesmo
é função da saturação conhecida apenas nos pontos de colocação dos volumes de controle
adjacentes. Desta forma, através da superfície de controle pode ocorrer uma descontinuidade da
propriedade de estado de interesse (i.e., da saturação), caracterizando um problema de Riemann
(HIRSCH, 1990).

5.1.1 Problema de Riemann e Método de Godunov

As equações (2.16), (2.17) e (2.18) definem um problema de Riemann, no qual certa
quantidade da substância é transportada de maneira descontinua através de um dado domínio



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 89

Figura 27 – Múltiplos valores para a saturação (situação não-física)

Fonte – Carvalho (2005)

(LEVEQUE, 1992; HELMIG, 1997). Devido ao caráter não convexo do fluxo fracional, as curvas
características para o problema de Buckley Leverett, apresentam tanto ondas de compressão
d f /dx?0, quanto ondas de rarefação d f /dx?0 (CARVALHO, 2005). Na figura 27 de Carvalho
(2005), mostra que, para um mesmo ponto, podem existir múltiplas soluções, devido às múltiplas
características, representando um fenômeno não-físico, pois fisicamente apenas uma solução
é aceitável. Esta intersecção de linhas características se dá porque, ao definirmos as linhas
características, não impusemos nenhuma restrição para os valores possíveis das saturações à
montante e à jusante do choque de saturações. Para selecionarmos a solução real dentre as várias
existentes, utilizamos normalmente a condição de Rankine-Hugoniot e a condição de entropia
(LEVEQUE, 1992).

Para encontrar uma solução para o problema de Riemann utilizamos um método nu-
mérico proposto por Godunov, que foi desenvolvido no contexto da dinâmica de gases, tendo
revolucionado o campo da dinâmica dos fluidos computacional devido ao fato de resolver este
problema a partir de três etapas relativamente simples, as quais mencionamos brevemente a
seguir (CARVALHO, 2005; HIRSCH, 1990):

• No tempo t k, definimos uma aproximação discreta constante da solução no interior de cada
volume de controle;

• Obtemos a solução exata local do problema de Riemann na interface de cada volume de
controle;



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 90

• Ponderamos os estados da variável transportada após um intervalo de tempo ?t (que deve
respeitar as condições de CFL) na interface para cada volume de controle.

Os fluxos através das interfaces dos volumes de controle são calculados de modo que
uma solução é conservativa e sem oscilações numéricas. Os passos 1 (etapa de projeção) e 3 são
puramente numéricos e independem do passo 2 (etapa de evolução), de caráter mais “físico”. Em
determinados casos, encontrar a solução exata do problema de Riemann se torna muito custoso,
e as soluções podem ser calculadas de forma aproximada, alterando o passo 2 (HIRSCH, 1990).
Em outros casos, os passos 1 e 3 podem ser alterados, sem necessariamente mudarmos o passo
2, substituindo aproximações constantes por partes, por aproximações lineares por partes (ou
de ordens de ordem superior), definindo esquemas mais acurados, como o método MUSCL ou
método MOOD.

5.1.2 Fluxo Numérico e Resolvedores do Problema de Riemann

Como dito na seção anterior, as estratégias que discretizam a equação de transporte
advectivos são baseadas no método de Gudonov e nos métodos numéricos centrais (SOUZA,
2015), estos métodos são caracterizados por fluxos numéricos de ponderação amontante também
chamados fluxos do tipo Upwind (VAN LEER, 1979), e aqueles fluxo do tipo Local Lax
Friedrichs (LLF) com adição de difusão numérica. Segundo Hirsch (1990) nos métodos centrais a
velocidade de propagação não sofre nenhuma preferencia devido a seu aparente estêncil simétrico
respeito ao sinal da velocidade, em quanto no método ponderação amontante a discretização é
feita seguindo a orientação da malha e o sinal da velocidade de propagação, sendo que em ambos
os casos os estados (neste caso a variável saturação) são avaliados a esquerda e a direita. Assim,
o fluxo numérico é definido na superfície de controle IJ de acordo com a estratégia adotada e a
ordem de aproximação.
As aproximações de 1a ordem, são métodos clássicos amplamente utilizados em diferentes
áreas da engenharia em particular nos simuladores comerciais da industria petrolífera. Neste
método dependendo da direção da velocidade de propagação da informação através da superfície
de controle IJ, escolhemos o valor associado a um dos volumes de controle adjacentes, L? ou
R?, como solução na descontinuidade. Método ponderação à montante de 1a ordem, foi usado
originalmente por Courant et al 1952, baseado no estudo das curvas características da equação
ut + aux = 0, em que o sinal de a prevê o sentido da propagação da informação física. Desde
1981, este resolvedor de Riemann é conhecido como fluxo de Roe (ROE, 1981) é dada pela
seguinte relação

~F RoeIJ ·~NIJ =

??
?~FIJ(Sw,L?)·~NIJ, se ?IJ ? 0~FIJ(Sw,R?)·~NIJ, se ?IJ &amp;lt;0 (5.9)

aqui Sw,L? e Sw,R? representam, os valores de saturação de água nos volumes de controle adjacentes



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 91

à superfície de controle IJ, além disso, ~FIJ(Sw,L?) e ~FIJ(Sw,R?) são os fluxos correspondentes aos
volumes de controle L? e R?, respectivamente. E a velocidade da onda na superfície de controle
(LEVEQUE, 1992; DURLOFSKY, 1993) é aproximada por:

?IJ =
(
~VIJ ·~NIJ

)
? fw
? Sw

(5.10)

onde o fluxo fracional fw é definido na equação (2.15) e ~VIJ ·~NIJ é aproximado por algum
método numérico descrita nas seções anteriores. Uma característica importante de métodos de
ponderação amontante é que ele reproduz soluções não oscilatórias, monótonas, nas regiões de
descontinuidade (HIRSCH, 1990).

Para correção de uma possível violação de entropia, quando necessário, o fluxo numérico
do tipo Local Lax Friedrichs (LLF) (LEVEQUE, 1992) é dada pela seguinte relação:

~F LLFIJ ·~NIJ =
1
2

((
~FIJ
(

Sw,L?
)
+~FIJ

(
Sw,R?

))
·~NIJ ?max

R?,L?
|?IJ|

(
Sw,R? ?Sw,L?

))
(5.11)

onde maxR?,L? |?IJ|
(

Sw,R? ?Sw,L?
)

representa a dissipação numérica artificial.
Tradicionalmente a correção de entropia foi inicialmente proposto por Shu e Osher

(1988) para problema de Buckley-Leverett o termo gravitacional. Nessa estratégia o sinal da
velocidade característica é avaliada nos estados a esquerda e à direita da superfície de controle
genérica IJ, para isso foi necessário avaliar o produto das primeiras derivas do fluxo fracional dos
estados esquerda e direita, quando aquele produto é estritamente menor que zero pode ocasionar
a violação do princípio de entropia na solução produzida. Para essa situação, utilizou o fluxo de
LLF ja que este método adiciona uma difusão numérica extra para estabilizar o método, mas
detalhes sobre esta estratégia pode-se encontrar em Souza (2015). No entanto, em problemas que
não possui o termo gravitacional a estratégia de Shu e Osher (1988) não possível aplicar, isto quer
dizer que mesmo no tendo o termo gravitacional ainda pode ocorrer a violação do princípio de
entropia (LEVEQUE, 1992; HELMIG, 1997; SERNA, 2009). No contexto de magneto-dinâmica,
Serna (2009) propos uma estratégia para correção de entropia para problemas que não possua
termo gravitacional. Segundo Souza (2015) a autora invoca o fluxo do tipo LLF para a mudança
de sinal na primeira derivada, calculado nos dois estados da superfície de controle avaliada IJ, tal
como em Shu e Osher (1988). Uma característica adicional do método é que adiciona a mudança
de sinal da segunda derivada igualmente obtida para cada estado, quando o produto das segundas
derivadas para amabos estados for menor que zero então o princípio de entropia pode ser violada,
nesse caso Serna (2009) recomenda aplicar o LLF. Assim, o fluxo numérico proposto por Serna
(2009) é adaptado ao contexto de reservatórios de petróleo por Souza (2015), e o fluxo pode ser



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 92

escrito como:

~FIJ ·~NIJ =

?????
????
~F LLFIJ ·~NIJ, se

??
?

? fw
? Sw

(Sw,L?)
? fw
? Sw

(Sw,R?) &amp;lt;0
?

2 fw
? S2w

(Sw,L?)
?

2 fw
? S2w

(Sw,R?) &amp;lt;0

~F RoeIJ ·~NIJ, caso contrário

(5.12)

5.1.3 Método TVD (Total Variation Diminishing )

A solução fraca das equações (2.16), (2.17) e (2.18) tem as seguintes propriedades em
função de t:

• Nenhum extremo local em x pode ser criado;

• um valor máximo não deve aumentar, e um valor mínimo não deve diminuir.

Segue-se desta propriedade de monotonicidade que a variação total (TV) em x de Sw é
T V (Sw) e não esta aumentado em t, assim:

T V (Sw)
m+1 ? T V (Sw)m (5.13)

o método é dito TVD (Total Variation Diminishing) se satisfaz a equação (5.13) para todo t e
onde

T V =
? ????? Sw

? x

????dx (5.14)
ou ainda no caso discreto a variação total (TV) de Sw é dada por

T V (Sw) = ?
???Sw, ˆi+1 ?Sw,i???? (5.15)

Harten (1983) mostrou que todo método numérico monótono é TVD e que todo método
TVD preserva a monotonicidade, ou seja, métodos que satisfazem a condição anterior são
livres de oscilações, uma vez que a solução inicial seja livre de oscilações. Este método tem
sido amplamente utilizado e também estendido ao conceito de métodos TVB (Total Variation
Boundary) que permitem apenas um aumento limitado da variação total. De acordo com o teorema
de Godunov: Todo método linear monótona para a equação de convecção são necessariamente
de primeira ordem (HIRSCH, 1990). Em uma dimensão, é possível construir um método de alta
ordem e que seja TVD, tentando obter uma aproximação de ordem mais alta nas regiões suaves
do escoamento e evitando oscilações numéricas nas regiões próximas de gradientes acentuados
utilizando métodos monótonos de 1a ordem. Assim, aproximações de ordem mais alta causam o
aparecimento de oscilações espúrias. Em múltiplas dimensões pode-se mostrar que todo método
TVD é necessariamente de 1a ordem e, em geral, usamos critérios menos restritivos como o LED
(Local Extremum Diminishing). Embora todo método LED é TVD, o reciproco não é verdade.



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 93

Figura 28 – Estêncil utilizado para obter uma aproximação de alta ordem

Fonte – Produzido pelo autor

A ideia central por trás da construção de um método de alta resolução e que seja TVD, é tentar
obter uma aproximação de ordem mais alta em regiões suaves do escoamento, evitando ainda
oscilações nas proximidades de gradientes acentuados, apresentando nestas regiões propriedades
similares àquelas de métodos monótonos de ordem mais baixa como os métodos de ponderação
à montante de primeira ordem. Em tais métodos a solução é, em geral, de segunda ordem em
regiões suaves da solução e de 1a ordem próximo a “descontinuidades” (SOUZA, 2015). Métodos
lineares de ordem superior, embora mais precisos para soluções suaves, não são TVD e tendem
a introduzir oscilações espúrias onde surgem descontinuidades ou choques. Para vencer estas
desvantagens, foram desenvolvidas várias técnicas não lineares de alta resolução, muitas vezes
utilizando limitadores de fluxo (VAN LEER, 1979; HIRSCH, 1990; CARVALHO, 2005).

5.1.4 Formulação Numérica de Alta Ordem tipo MUSCL de Volumes Finitos
(HOMFV)

A fim de obter um método de aproximação de segunda ordem nós utilizamos um proce-
dimento de reconstrução linear. Assim as saturações reconstruídas nas superfícies de controle
são denotadas por S+

w,L?
e S?

w,R?
calculados como (HIRSCH, 1990; LÖHNER, 2008):

S+
w,L?

= Sw,L? +
?
?
L?

4

[
(1??)??

L?
+(1 + ?)

(
Sw,R? ?Sw,L?

)]
(5.16)

S?
w,R?

= Sw,R? ?
?
?
R?

4

[
(1??)?+

R?
+(1 + ?)

(
Sw,R? ?Sw,L?

)]
(5.17)

Nas equações (5.16) e (5.17), os coeficientes ??
L?

e ??
R?
, são chamados de funções limi-

tadores (que serão detalhadas mais adiante) e “? ” é um parâmetro usado para controlar o grau
de aproximação. No presente trabalho ? = 1/3 que representa um método upwind de terceira



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 94

ordem em problemas unidimensionais (HIRSCH, 1990). Ao longo da direção
???
LR? (veja figura 28)

definimos a diferença dos operadores, denotado por ?+
R?

e ??
L?

, como:

?
?
L?
= Sw,L? ?Sw,L?? = 2

???
LR?·?Sw,L? ?

(
Sw,R? ?Sw,L?

)
(5.18)

?
+
R?
= Sw,R???Sw,R? = 2

???
LR?·?Sw,R? ?

(
Sw,R? ?Sw,L?

)
(5.19)

onde ~?Sw,L? e
~?Sw,R? representam a reconstrução dos gradientes definida com respeito aos volumes

de controle a esquerda e direita, respectivamente.
A reconstrução dos gradientes é calculada a partir dos trabalhos de (BLAZEK, 2015).

Esta reconstrução é baseada na expansão em séries de Taylor de primeira ordem para cada
volume controle conectado com o VC L?.

5.1.4.1 Processo de Limitação

Segundo a literatura é sabido que o uso de métodos estritamente de alta ordem produzem
resultados não realísticas, com overshot e/ou undershot na vizinhança de mudanças abruptas
no campo de saturação (HIRSCH, 1990). Então, é preciso utilizar limitadores para suprimir
essas oscilações não físicas, sendo que a utilização desses limitadores em regiões de gradientes
elevadas reduz a aproximação para aproximações de primeira ordem. Uma estratégia é baseada
sobre um processo de limitação sobre a face, a qual é capaz de produzir soluções limitados em
geral para muitas aplicações. Embora, o uso de um método de simples extrapolação do gradiente
com um limitador por face (DURLOFSKY, 1993) pode ser capaz de produzir soluções não
monótonas espacialmente quando utilizamos malhas severamente distorcidas ou meios altamente
anisotrópicos (CONTRERAS, 2016). A fim de suprimir esses problemas utilizamos um limitador
proposto por Wood e O’Neill (2004), ajustamos para métodos centrados na célula utilizado neste
trabalho. Utilizando este limitador junto ao limitador face derivamos um método de alta ordem
nomeado HOMFV (CONTRERAS, 2016), assim temos:

?
?
i? = ?i? ×?

i?
IJ, i? = L?,R? (5.20)

Na equação (5.20), ??
i?

é uma função que muda suavemente desde 1 (método de alta
ordem) a 0 (método de primeira ordem) na vizinhança de choques, ? i?IJ é responsável em limitar
por face as interpolações, i.e. garante que as saturações reconstruídas variam no intervalo Sw,L?,
Sw,R? e a função ?i?, a qual é definida na equação (5.21) é responsável para mudar o esquema a



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 95

primeira ordem sempre que for necessário para garantir a monotonicidade.

?i? =

???????????
??????????

1,
(
Sw,max ?Sw,min

)
? ?1

0, ?i? ? 1 ou ?i? ? 0

1, ? ? ?i? ? (1?? )

?i?/? , 0 &amp;lt;?i? &amp;lt;?(
1??i?

)
/? , (1?? ) &amp;lt;?i? &amp;lt;1

(5.21)

onde o parâmetro ?i? é definido como:

?i? =
Sw,i? ?Sw,min

Sw,max ?Sw,min
(5.22)

Nas equações (5.21) e (5.22), Sw,min e Sw,max são os valores máximos e mínimos da
saturação, considerando todos os volumes de controle que são imediatamente vizinhos ao volume
de controle i? (i.e. aqueles compartilham uma superfície de controle em comum), excluindo a
saturação no elemento em questão. Em problemas multidimensionais, a saturação é dita limitada
em cada volume de controle do domínio computacional, se satisfaz a seguinte relação, 0 ? ?i? ? 1.

O uso de métodos de segunda ordem em todo o domínio computacional, exceto onde a
equação (5.22) é aplicada nem sempre é uma estratégia segura, porque não há uma transição suave
entre o método de segunda ordem e o método de primeira ordem. Como apontado por Woodfield,
Suzuki e Nakabe (2004), uma aproximação segura consiste em introduzir um parâmetro livre ?
que pertence ao intervalo [0,0.5], tal que:

? ? ?i? ? 1?? (5.23)

Seguindo o trabalho de Woodfield, Suzuki e Nakabe (2004) na presente tese utilizamos
? = 0.2 como uma boa escolha que garante robustez e acurácia do método. Note-se que para
um valor pequeno do parâmetro, o método é menos difusivo porque o limitador tende a ligar
e desligar abruptamente, quanto maior o valor de ? produz maior difusividade devido a uma
pequena faixa dos valores de ?i? para o qual o método de segunda ordem é usado. Finalmente, a
fim de garantir os valores limitados das saturações nas superfícies de controle, nós utilizamos o
limitador de Van Albada (CARVALHO, 2005; LÖHNER, 2008; CONTRERAS, 2016):

?
L?
IJ = max

?
??0, 2??L?

(
Sw,R? ?Sw,L?

)
+ ?2

?
?
L?

2
+
(

Sw,R? ?Sw,L?
)2

+ ?2

?
?? (5.24)

?
R?
IJ = max

?
??0, 2?+R?

(
Sw,R? ?Sw,L?

)
+ ?2

?
+
R?

2
+
(

Sw,R? ?Sw,L?
)2

+ ?2

?
?? (5.25)

onde ?2 é um valor muito pequeno usado para evitar divisão por zero.



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 96

Figura 29 – Iedia do método clássico de alta ordem tipo MUSCL (acima) e ideia do MOOD
(baixo)

Fonte – Clain, Diot e Loubere (2011)

Portanto, utilizando as saturações de segunda ordem obtidas nas equações (5.16) e (5.17)
e substituindo na aproximação de primeira ordem da equação (5.12) temos:

~FIJ ·~NIJ =

?????
????
~F LLFIJ (S

+
w,L?

,S?
w,R?

)·~NIJ, se

??
?

? fw
? Sw

(S+
w,L?

)
? fw
? Sw

(S?
w,R?

) &amp;lt;0
?

2 fw
? S2w

(S+
w,L?

)
?

2 fw
? S2w

(S?
w,R?

) &amp;lt;0

~F RoeIJ (S
+
w,L?

,S?
w,R?

)·~NIJ, caso contrário

(5.26)

5.1.5 Formulação Numérica Multidimensional de Detecção Ótima Ordem
(MOOD)

Os método clássicos baseados no método de MUSCL de Van Leer (1979) utiliza um
procedimento de limitação a priori afim de reforçar a monotonicidade (BELL; SHUBIN, 1985;
DURLOFSKY, 1993; EDWARDS, 1996; PARK; KIM, 2012; CONTRERAS, 2016), veja figura
29 acima. Ao contrário dos métodos existentes, a estratégia MOOD prossegue com uma limitação
a posteriori, veja figura 29 baixo. O método MOOD consiste em que as soluções candidatos
de ordem superior são primeiramente obtidos por meio de uma formulação robusta tal como
uma extrapolação de gradiente ou um método de Galerkin descontínuo. Afim de obter uma
aproximação de segunda ordem, empregamos um procedimento de reconstrução linear por partes
(VAN LEER, 1979; HIRSCH, 1990; EDWARDS, 1996; EDWARDS, 2006). Portanto, as nossas
saturações S?w,L? e S?w,R? não limitadas linearmente reconstruídas, são calculados como:

S?w,L? = Sw,L? +
1
4

[
(1??)??

L?
+(1 + ?)

(
Sw,R? ?Sw,L?

)]
(5.27)

S?w,R? = Sw,R? ?
1
4

[
(1??)?+

R?
+(1 + ?)

(
Sw,R? ?Sw,L?

)]
(5.28)



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 97

onde ? representa um parâmetro utilizado para controla o grau de aproximação (HIRSCH, 1990;
LÖHNER, 2008; BLAZEK, 2015). Quando queremos uma aproximação de alta ordem tipo
MUSCL, os termos nas equações (5.27) e (5.28) é pre-multiplicado pela função limitadora, veja
as equações (5.16) e (5.17). Os parâmetros ??

L?
e ?+

R?
são definidos nas equações (5.18) e (5.19),

respectivamente.
Neste trabalho, o método MOOD considera, inicialmente, o grau polinomial máximo

dmax = 2 em cada volume de controle para calcular a reconstrução ilimitada na face IJ, veja as
equações (5.27) e (5.28). Para um volume de controle genérico L? ? M , os valores reconstruídos
são utilizados para o cálculo do fluxo numérico dado na equação (5.26) para se obter a seguinte
solução candidata:

S?w,L? = S
m
w,L?
?

?t
?VL?

?
? ?

IJ?EL?

~FIJ(S?w,L?)·~NIJ ?Q?wVL?

?
? para cada L? ? M (5.29)

onde S?w,L? representa o valor da saturação reconstruída sobre a superfície de controle IJ.
Através de um processo interativo decremental, determinamos o grau ótimo dL? ? dmax,

para cada L? ? M quando a solução candidato S?
w,L?

satisfaz o critério DMP, para todo r? ? ?(L?),
assim como:

min
r???(L?)

(
Sm

w,L?
,Smw,r?

)
? S?w,L? ? max

r???(L?)

(
Sm

w,L?
,Smw,r?

)
para cada L? ? M (5.30)

onde ?(L?) representa o conjuntos de todos os volumes de controle que são vizinhos imediatos a
L?.

A estratégia MOOD pode ser resumido como (CLAIN, 2011):

• Inicialização do grau polinomial do volume de controle dL? = dmax para cada L? ? M ;

• Avaliação do grau polinomial da superfície de controle dIJ , utilizando o seguinte critério:

dIJ =

????
???

min
IJ?EL??ER?

(
dL?,dR?

)
or

min
R???(L?)

(
dL?,dR?

)
• Atualizar o valor reconstruído S?w,L? e avaliar o criterio PAD para evitar valores reconstruidos

negativos, i.e., estabelecemos S?w,L? = max
(

S?w,L?,0
)

.

• Atualizar a solução candidato S?
w,L?

, para cada L? ? M , utilizando a equação (5.29).



Capítulo 5. FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO 98

• O grau polinomial é decrementado dL? = max
(
0,dL? ?1

)
, e a solução é recalculado se-

guindo os passos de 2 a 5 até satisfazer o criterio do DMP para todo volumes de controle
de M .

Então o procedimento iterativo para e Sm+1
w,L?

= S?w,L?, para todo L? ? M .



99

6 RESULTADOS NUMÉRICOS: ESCOA-
MENTO BIFÁSICO

6.1 Escoamento num Reservatório Altamente Heterogêneo
Este exemplo é uma versão adimensionalizada do problema de 1/4 de cinco-poços. Neste

caso, o domínio consiste num reservatório altamente heterogêneo isotrópico, em que o valor da
porosidade é irrelevante, uma vez que serve apenas para adimensionalizar a equação. A saturação
irredutível de água (Sriw) e a saturação residual de óleo (Sro) são dadas por Sirw = Sro = 0.
A razão de mobilidade, essencialmente a razão de viscosidade de óleo e água é dada por
M = µo/µw = 4, e utilizamos a relação de permeabilidade relativa de Brook-Corey da forma
krw = S2w e krw = (1?Sw)2. A saturação de no poço injetor é um (S?win j = 1), e a pressão no poço
produtor é zero ( pprod = 0). A injeção e os poços de produção são localizados na parte esquerdo
inferior e na parte superior direito da malha, respectivamente

k(x,y) = ?
?

4 cos(6? x)cos(6? y) K˜(x,y) = k(x,y)I˜ (6.1)
Figura 30 – Malha não estruturada triangular com 1054 volumes de controle (esquerda) e Campo

de permeabilidade (direita)

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Na figura 30 mostramos a malha não estruturada triangular e o campo de permeabilidade
utilizado para realizar nossos testes.

Para os métodos FOU, HOMFV e MOOD, o número CFL adotado foi de 0.6. Como
salientado em Chueh, Secanell, Bangerth e Djilali (2010), sempre que uma fase menos viscoso
(por exemplo, água) é injetada num reservatório heterogêneo, deslocando um mais viscoso (por
exemplo, óleo), devido à distribuição heterogênea do campo da permeabilidade, o fluido mais
móvel facilmente avança através das zonas de alta permeabilidade formando dedos viscosos



Capítulo 6. RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO 100

Figura 31 – Perfil de saturação obtido pelo método MPFA-HD acoplado a: FOU (esquerda) e
solução de referencia foi obtido com o método MPFA-O/FOU

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Figura 32 – Perfil de saturação obtido pelo método MPFA-HD acoplado a: HOMFV (esquerda)
e MOOD (dereita).

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

(fingers), como pode ser visto nas figuras 31 e 32. Nestas figuras, pode verse claramente que o
método MOOD acoplado ao método MPFA-HD é capaz de capturar os dedos viscosos com muita
mais precisão que os métodos FOU e HOMFV acoplado ao método MPFA-HD, produzindo um
perfil de saturação mais nítida com menos difusão artificial em concordância com a solução de
referencia, destacando as rápidas mudanças no campo da permeabilidade, que de alguma forma
estão escondidas por o método de baixa ordem.

Na figura 33, observamos que o excesso de difusão produzido pelos métodos propostos
acoplado ao método FOU e HOMFV provoca uma irrupção de água bastante retardado em
comparação com a curva produzida pela solução de referencia. Em contrapartida, o nossos
métodos propostos acoplado ao método MOOD, representam a física do problema de maneira
mas acurada, produzindo a curvas de irrupção de água mas aproximo a curva de referencia.



Capítulo 6. RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO 101

Figura 33 – Curvas de corte de água no poço produtor

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

6.2 Escoamento Bifásico num Meio Homogêneo com Três Poços
Este problema foi originalmente apresentado por Kozdon, Mallison e Gerritsen (2011) e

foi desenhado para investigar o impacto do GOE em frente a saturação quando começamos a
rodar a grade computacional. O domínio, que está totalmente saturado com óleo, é inicialmente
definido por um quadrado (?0.5,0.5)×(?0.5,0.5) rodado pelos seguintes ângulos definidos
com a linha horizontal: ? = 0,?/4,?/6,?/8,?/12.

Figura 34 – Domínio computacional para um problema de três poços, para ? = 0 (esquerda) e
? = ?/6 (direita). A região circular interior este me branco e o outro em cinza. O
poço superior é poço injetor, e os poços inferiores são produtores 1 (esquerda) e 2
(direita), adaptado de Kozdon, Mallison e Gerritsen (2011)

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Em todos os casos, o domínio foi discretizado com uma malha uniforme quadrilátero
51×51 (ver figura 34) e o poço de injeção está localizado no centro do domínio e dois po-
ços de produção são colocados de forma simétrica nos pontos definidos pelas coordenadas



Capítulo 6. RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO 102

(?0.3cos(?/6),?0.3sin(?/6)). A porosidade é constante em todo o domínio e o tensor de
permeabilidade é dada por K˜ = L˜ ou K˜ = 10?6I˜, onde I˜ é o segundo tensor identidade fim, de-
pendendo de se a distância do centro do domínio é menos do que 0,48 ou maior, respectivamente.
Como apontado por Keilegavlen, Kozdon e Mallison (2010) e Kozdon, Mallison e Gerritsen
(2011), essa estratégia garante o confinamento do fluxo dentro do círculo interno. A razão de
viscosidade entre as duas fases é dada por M u (µo/µ w) = 100. Neste problema as permeabili-
dades relativas de água e óleo são definidas, respectivamente como krw = S4w e kro = (1?Sw)2.
A saturação de água no poço injetor é dada por S?in jw = 1 e as pressões nos poços produtores são
p?prod = 0. Em referência Keilegavlen, Kozdon e Mallison (2010) e Kozdon, Mallison e Gerritsen
(2011), o problema foi resolvido, usando o MPFA-L (AAVATSMARK, 2002) para a solução
da equação de pressão e o método de FOU e um método amontante multidimensional. Nestas
referências, os autores indicam que a principal vantagem do sistema amontante multidimensional
usado é a redução da biasing numérica produzido pela relativa orientação do fluxo e a malha
subjacente, isto é, o GOE (Grid Orientation Effect). Neste problema, de preferência, o perfil de
saturação deve ser simétrica e invariável com os diferentes rotações da malha. Neste caso, vamos
nos restringir ao método FOU, HOFVM e MOOD apresentado.

Figura 35 – Curvas de corte de água para o problema homogêneo de três de poços, utilizando:
método NLFV-PP/FOU (esquerda); NFLV-PP/HOMFV (centro) e NLFV-PP/MOOD
(direita). As linhas tracejadas referem-se ao poço produtor 1 e as linhas continuas
referem-se ao poço produtor 2

Fonte – Produzido pelo autor utilizando o software MATLAB

Mesmo que o nosso método adotado MOOD não são "verdadeiramente multidimen-
sional", do ponto de vista dos autores (KEILEGAVLEN, 2010; KOZDON, 2011; EYMARD,
2012) sobre métodos verdadeiramente multidimensional, é evidente que os perfis de saturação
mostrado nas figuras 36 e 37 são substancialmente menos afetada pela orientação da malha
do que o método FOU mostrado na figura 38 e 39. Os perfis são mais simétrico para todos os
ângulos da malha, veja que não foi mostrado os perfis obtidos pelo método HOMFV, já que os
perfis são muito parecidos ao método MOOD. Segundo nossas experiencias o perfil de saturação
com efeito de orientação mais "patológica"é obtido com o angulo ? = ?/6 e podemos observar



Capítulo 6. RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO 103

que o método FOU antecipa claramente a romper no poço produtor 2 devido aos fenômenos
GOE, além disso, o perfil de saturação foi bastante afeta tendo um biasing numérico ao poço
produtor 1, veja figura 35 e 38 esquerda. Como pode ser visto nas figuras 35, as curvas de
corte de água são muito estreitamente embalado para o MOOD do que para o método FOU e
ligeiramente mais estreito do que o método HOMFV, atestando a superioridade sobre o método
FOU em todos os ângulos, embora as curvas de corte de água obtidas com o HOMFV e o MOOD
ainda sofrem algum espalhamento, indicando que mais melhorias podem ser obtidos se adaptar
nossa metodologia para incorporar um cálculo de fluxo verdadeiramente multidimensional no
espírito de métodos com fluxo ponderado por massa (EYMARD, 2012; LAMINE; EDWARDS,
2010; HURTADO, 2007).

Figura 36 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = 0 (esquerdo), ? = ?/12 (centro) e ? = ?/8 (esquerda) obtido com o método,
NLFV-PP/MOOD

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Figura 37 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = ?/6 (esquerdo) e ? = ?/4 (centro) obtido com o método NLFV-PP/MOOD, o
perfil da solução de referencia esta a esquerda da figura

Fonte – Produzido pelo autor utilizando o software de visualização VisIt



Capítulo 6. RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO 104

Figura 38 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = 0 (esquerdo), ? = ?/12 (centro) e ? = ?/8 (esquerda) obtido com o método,
NLFV-PP/FOU

Fonte – Produzido pelo autor utilizando o software de visualização VisIt

Figura 39 – Perfil de saturação para um problema homogêneo com três poços com angulo
? = ?/6 (esquerdo) e ? = ?/4 (centro) obtido com o método NLFV-PP/FOU, o
perfil da solução de referencia esta a esquerda da figura.

Fonte – Produzido pelo autor utilizando o software de visualização VisIt



105

7 CONCLUSÃO E TRABALHOS FUTUROS

No presente trabalho apresentamos em detalhe formulações de método dos volumes
finitos, com incógnitas completamente centrados nos volumes de controle. Utilizando estas
formulações para a solução de problemas de escoamento de fluidos incompressíveis em meios
porosos rígidos, heterogêneos e anisotrópicos. Os modelos adotados descrevem problemas
através de um sistema de equações segregadas, envolvendo uma equação de pressão e uma de
saturação, acopladas através da velocidade de Darcy. Uma estratégia tipo IMPES foi utilizada
para a solução sequencial dessas equações.

Para a resolver a equação de pressão, formulações robustas são propostas para lidar
com tensores de permeabilidade e malhas arbitrários. Essas formulações foram comparadas
com métodos clássicos dos Volumes Finitos (MPFA-O e MPFA-FPS). Conforme esperado, nos
experimentos numéricos, feitos com problemas benchmark da literatura, verificou-se que todas
as formulações propostas, são capazes de produzir soluções exatas para campos lineares de
pressão inclusive para reservatórios com permeabilidade descontínua e alta anisotropia. Para as
formulações com aproximação de fluxo por múltiplos pontos (MPFA-HD) e formulações não
lineares (NLFV-PP e NLFV-DMP), taxas de convergência de 2a ordem no campo de pressão e
ordem superior a 1 no campo de velocidade foram obtidas, mesmo para um reservatório com
tensor de permeabilidade ortotrópico, heterogêneo e utilizando malhas distorcidas.

Na avaliação da positividade das soluções em problemas com elevada razão de aniso-
tropia, conforme esperado, nenhum dos métodos clássicos como MPFA-O e MPFA-FPS foram
capaz de produzir soluções monótonas para esse problema. Embora nosso métodos propostos
como MPFA-HD e o MPFA-H foram capazes de preservar a positividade sem produzir oscilações
espúrias. As soluções obtidas com o MPFA-O e MPF-FPS apresentaram campos de pressão sem
apelo físico, que nem foram diminuindo com o refinamento da malha. No entanto, o MPFA-O
mantiveram amplitudes maiores do que as observadas para o MPFA-FPS. A aproximação linear
da pressão (com suporte triangular), característica do MPFA-O, implica em regiões em que a
pressão não é interpolada e sim extrapolada. Dessa forma, é esperado que oscilações espúrias
ocorram para problemas com elevada razão de anisotropia e malhas que não são k-ortogonais
(LIPNIKOV, 2007; CHEN, 2008; EDWARDS; ZHENG, 2008).

Por outro lado, como esperado nossos métodos não lineares como NLFV-PP respeita a
positividade do campo de pressão mesmo me meios altamente heterogêneos e anisotrópicos, mas
não respeita o critério do DMP como mostrados em nossos teste numéricos, em contrapartida
o método NLFV-DMP respeita o principio de máximo discreto mesmo em meios altamente
heterogêneos e anisotrópicos.

Para discretizar a equação de saturação hiperbólica não-linear, nós utilizamos um método
de alta ordem tipo MUSCL nomeado como HOMFV (CONTRERAS, 2016) com base num



Capítulo 7. CONCLUSÃO E TRABALHOS FUTUROS 106

mínimo de reconstrução gradiente quadrados com uma adequada estratégia de limitação, a fim
de reforçar a monotonia, esta formulação pode ser utilizada em qualquer malha poligonal, além
disso, apresentamos o método MOOD no contexto de simulação de reservatórios e comparamos o
potencial dele com o método HOMFV e o FOU. Alguns exemplos como modelo foram utilizados
para mostrar o potencial dos métodos para lidar com problemas que envolvem malhas estrutura-
das e não-estruturadas e meios altamente heterogêneas e anisotrópicos com razão de mobilidade
moderada, estas caracteristicas são comuns dos reservatórios de petróleo. Nós pudemos ver uma
clara melhoria do método MOOD em nossos resultados quando comparamos os obtidos pela
nossa formulação contra os métodos HOMFV e o clássico FOU, particularmente em termos
de resolução da frente de saturação e na mitigação do GOE, envolvendo meios heterogêneos
e anisotrópicos. Finalmente, os métodos que resolvem a equação de pressão acoplados aos
métodos HOMFV e MOOD produziram em geral resultados bastante aceitáveis em todas nossas
simulações que o método FOU. No entanto, é importante de mencionar que, mesmo quando
consideramos os métodos MPFA-HD, MPFA-H e NLFV-PP acoplado com o método FOU não
foram tão confiáveis do que os obtidos com métodos de alta ordem. No futuro próximo, preten-
demos usar a presente formulação juntos com um processo de adaptação de malha automática
para obter maior acurácia e menos computacional e inferior para melhorar a sua robustez usando
uma formulação de ordem superior num método verdadeiramente multidimensional, a fim de
minimizar ainda mais o efeito de orientação de malha, como sugerido por (HURTADO, 2007;
LAMINE; EDWARDS, 2010; LAMINE; EDWARDS, 2013).

Finalmente, os bons resultados obtidos com as formulações numéricas propostas devem
motivar a realização de pesquisas adicionais visando à extensão da formulação para problemas
mais gerais. Como extensões imediatas do nosso trabalho, podemos mencionar:

• Empregar técnicas de aproximação de baixa ordem tipo upwind multidimensional. Além
disso, método de alta resolução para o cálculo de campo de saturações que sejam verdadei-
ramente multidimensionais e que, portanto, eliminem ou minimizem efeitos de orientação
de malhas;

• Extensão do simulador para geometrias tridimensionais;

• Implementação de toda a formulação desenvolvida em computadores paralelos de memória
distribuída a fim de simular problemas complexos em geometrias tridimensionais de grande
porte;

• Aperfeiçoamento do modelo físico, introduzindo os termos de gravidade e de capilaridade;

• Aprofundamento do estudo do efeito da orientação de malhas na modelagem e na simulação
de escoamentos bifásicos em meios porosos com a metodologia apresentada no presente
trabalho;

• Implementação das seguintes metodologias:



Capítulo 7. CONCLUSÃO E TRABALHOS FUTUROS 107

“Sequencial Implícita”: Formulação segregada em que, assim como a equação de
pressão, a equação de saturação também é resolvida de maneira implícita, permitindo a
utilização de intervalos de tempo maiores;

“Totalmente implícita”: Formulação em que as equações de transporte são rearranjadas
de maneira que a pressão e a saturação são incógnitas simultâneas das mesmas equações,
permitindo a utilização de intervalos de tempo que, independente da complexidade física
do problema, são limitados apenas pela precisão da aproximação;

• Estudar e implementar outros métodos iterativos como Newton-Krylov e que preservem
monotonicidade para melhorar a eficiencia computacional dos métos NLFV-PP e NLFV-
DMP;

• Generalização do MOOD a 3-D e extensão de altissima ordem (&gt;2), o qual necessita um
procedimento de reconstrução adequado;

• Num futuro próximo nós acoplaremos o MOOD com um “Flow Oriented Method"verdadeiramente
Multidimensional para reduzir ainda mais o GOE mesmo para fluxos com altas taxas de
mobilidade.



108

REFERÊNCIAS

AAVATSMARK, I. An introduction to multipoint flux approximations for quadrilateral grids.
Computational Geosciences, Springer, v. 6, n. 3-4, p. 405–432, 2002.

AAVATSMARK, I.; BARKVE, T.; BØE, O.; MANNSETH, T. Discretization on unstructured
grids for inhomogeneous, anisotropic media. part i: Derivation of the methods. SIAM Journal on
Scientific Computing, SIAM, v. 19, n. 5, p. 1700–1716, 1998.

AAVATSMARK, I.; EIGESTAD, G.; MALLISON, B.; NORDBOTTEN, J. A compact multipoint
flux approximation method with improved robustness. Numerical Methods for Partial Differential
Equations, Wiley Online Library, v. 24, n. 5, p. 1329–1360, 2008.

AGÉLAS, L.; EYMARD, R.; HERBIN, R. A nine-point finite volume scheme for the simulation
of diffusion in heterogeneous media. Comptes Rendus Mathematique, Elsevier, v. 347, n. 11, p.
673–676, 2009.

AZIZ, K.; SETTARI, A. Petroleum reservoir simulation. [S.l.]: Chapman &amp;amp; Hall, 1979.

BAJOR, O.; CORMACK, D. A new method for characterizing the grid orientation phenomenon.
Society of Petroleum Engineers, 1989.

BASTIAN, P. Higher order discontinuous Galerkin methods for flow and transport in porous
media. [S.l.]: Springer, 2003.

BELL, J.; SHUBIN, G. Higher-order godunov methods for reducing numerical dispersion in
reservoir simulation. In: SOCIETY OF PETROLEUM ENGINEERS. SPE Reservoir Simulation
Symposium. [S.l.], 1985.

BERTOLAZZI, E.; MANZINI, G. A second-order maximum principle preserving finite volume
method for steady convection-diffusion problems. SIAM journal on numerical analysis, SIAM,
v. 43, n. 5, p. 2172–2199, 2005.

BLANC, X.; LABOURASSE, E. A positive scheme for diffusion problems on deformed meshes.
ZAMM-Journal of Applied Mathematics and Mechanics/Zeitschrift für Angewandte Mathematik
und Mechanik, Wiley Online Library, 2015.

BLAZEK, J. Computational fluid dynamics: principles and applications. [S.l.]: Butterworth-
Heinemann, 2015.

BRAND, C.; HEINEMANN, J.; AZIZ, K. The grid orientation effect in reservoir simulation. In:
SOCIETY OF PETROLEUM ENGINEERS. SPE Symposium on Reservoir Simulation. [S.l.],
1991.

BRENIER, Y.; JAFFRÉ, J. Upstream differencing for multiphase flow in reservoir simulation.
SIAM journal on numerical analysis, SIAM, v. 28, n. 3, p. 685–696, 1991.

CARVALHO, D. K. E. de. Uma Formulação do Método dos Volumes Finitos com Estrutura de
Dados por Aresta para a Simulação de Escoamentos em Meios Porosos. Tese (Doutorado) —
Universidade Federal de Pernambuco, 2005.



Referências 109

CHEN, Q.-Y.; WAN, J.; YANG, Y.; MIFFLIN, R. T. Enriched multi-point flux approximation
for general grids. Journal of Computational Physics, Elsevier, v. 227, n. 3, p. 1701–1721, 2008.

CHEN, Z. Reservoir simulation: mathematical techniques in oil recovery. [S.l.]: Siam, 2007.
v. 77.

CHEN, Z.; HUAN, G.; LI, B. An improved impes method for two-phase flow in porous media.
Transport in Porous Media, Springer, v. 54, n. 3, p. 361–376, 2004.

CHEN, Z.; HUAN, G.; MA, Y. Computational methods for multiphase flows in porous media.
[S.l.]: Siam, 2006. v. 2.

CHOI, B.-J.; ISKANDARANI, M.; LEVIN, J.; HAIDVOGEL, D. B. A spectral finite-volume
method for the shallow water equations. Monthly Weather Review, v. 132, n. 7, p. 1777–1791,
2004.

CHUEH, C.; SECANELL, M.; BANGERTH, W.; DJILALI, N. Multi-level adaptive simulation
of transient two-phase flow in heterogeneous porous media. Computers &amp;amp; fluids, Elsevier, v. 39,
n. 9, p. 1585–1596, 2010.

CLAIN, S.; DIOT, S.; LOUBERE, R. A high-order finite volume method for systems of con-
servation laws—multi-dimensional optimal order detection (mood). Journal of computational
Physics, Elsevier, v. 230, n. 10, p. 4028–4050, 2011.

COATS, K. Impes stability: The stable step. 2001.

COLELLA, P. Multidimensional upwind methods for hyperbolic conservation laws. Journal of
Computational Physics, Elsevier, v. 87, n. 1, p. 171–200, 1990.

COLELLA, P.; DORR, M. R.; HITTINGER, J. A.; MARTIN, D. F. High-order, finite-volume
methods in mapped coordinates. Journal of Computational Physics, Elsevier, v. 230, n. 8, p.
2952–2976, 2011.

CONTRERAS, F.; LYRA, P.; SOUZA, M.; CARVALHO, D. A cell-centered multipoint flux
approximation method with a diamond stencil coupled with a higher order finite volume method
for the simulation of oil–water displacements in heterogeneous and anisotropic petroleum
reservoirs. Computers &amp;amp; Fluids, Elsevier, v. 127, p. 1–16, 2016.

CRUMPTON, P.; SHAW, G.; WARE, A. Discretisation and multigrid solution of elliptic equati-
ons with mixed derivative terms and strongly discontinuous coefficients. Journal of Computatio-
nal Physics, Elsevier, v. 116, n. 2, p. 343–358, 1995.

DURLOFSKY, L. J. A triangle based mixed finite element finite volume technique for modeling
two phase flow through porous media. Journal of Computational Physics, Elsevier, v. 105, n. 2,
p. 252–266, 1993.

DURLOFSKY, L. J.; ENGQUIST, B.; OSHER, S. Triangle based adaptive stencils for the
solution of hyperbolic conservation laws. Journal of Computational Physics, Elsevier, v. 98, n. 1,
p. 64–73, 1992.

EDWARDS, M. G. A higher-order godunov scheme coupled with dynamic local grid refinement
for flow in a porous medium. Computer Methods in applied mechanics and engineering, Elsevier,
v. 131, n. 3, p. 287–308, 1996.



Referências 110

EDWARDS, M. G. M-matrix flux splitting for general full tensor discretization operators on
structured and unstructured grids. Journal of Computational Physics, Elsevier, v. 160, n. 1, p.
1–28, 2000.

EDWARDS, M. G. Higher-resolution hyperbolic-coupled-elliptic flux-continuous cvd schemes
on structured and unstructured grids in 2-d. International journal for numerical methods in fluids,
Wiley Online Library, v. 51, n. 9-10, p. 1059–1077, 2006.

EDWARDS, M. G.; ROGERS, C. F. Finite volume discretization with imposed flux continuity
for the general tensor pressure equation. Computational Geosciences, Springer, v. 2, n. 4, p.
259–290, 1998.

EDWARDS, M. G.; ZHENG, H. A quasi-positive family of continuous darcy-flux finite-volume
schemes with full pressure support. Journal of Computational Physics, Elsevier, v. 227, n. 22, p.
9333–9364, 2008.

EIGESTAD, G.; KLAUSEN, R. On the convergence of the multi-point flux approximation
o-method: Numerical experiments for discontinuous permeability. Numerical methods for partial
differential equations, Wiley Online Library, v. 21, n. 6, p. 1079–1098, 2005.

ERTEKIN, T.; ABOU-KASSEM, J. H. K.; GREGORY, R.; ERTEKIN, J. H. T.; GREGORY,
R. K. Basic applied reservoir simulation. [S.l.: s.n.], 2001.

EWING, R. E. The mathematics of reservoir simulation. SIAM, 1983.

EYMARD, R.; GUICHARD, C.; MASSON, R. Grid orientation effect and multipoint flux
approximation. In: Finite Volumes for Complex Applications VI Problems &amp;amp; Perspectives. [S.l.]:
Springer, 2011. p. 419–427.

EYMARD, R.; GUICHARD, C.; MASSON, R. Grid orientation effect in coupled finite volume
schemes. IMA Journal of Numerical Analysis, Oxford University Press, p. drs016, 2012.

FRIIS, H. A.; EVJE, S. Numerical treatment of two-phase flow in capillary heterogeneous porous
media by finite-volume approximations. Int. J. Numer. Anal. Mod, v. 9, p. 505–528, 2012.

FUCÍK, R.; ILLANGASEKARE, T. H.; MIKYŠKA, J. Evaluation of saturation-dependent flux
on two-phase flow using generalized semi-analytic solution. In: CITESEER. Proc. of the Czech
Japanese Seminar in Applied Mathematics, Prague, Faculty of Nuclear Sciences and Physical
Engineering, Czech Technical University in Prague. [S.l.], 2005. p. 23–35.

FUHRMANN J., O. M.; ROHDE, C. Finite Volumes for Complex Applications VII-Methods and
Theoretical Aspects. [S.l.]: Springer-Verlag, 2014.

GAO, Z.; WU, J. A linearity-preserving cell-centered scheme for the heterogeneous and aniso-
tropic diffusion equations on general meshes. International Journal for Numerical Methods in
Fluids, Wiley Online Library, v. 67, n. 12, p. 2157–2183, 2011.

GAO, Z.; WU, J. A small stencil and extremum-preserving scheme for anisotropic diffusion
problems on arbitrary 2d and 3d meshes. Journal of Computational Physics, Elsevier, v. 250, p.
308–331, 2013.

GAO, Z.; WU, J. A second-order positivity-preserving finite volume scheme for diffusion
equations on general meshes. SIAM Journal on Scientific Computing, SIAM, v. 37, n. 1, p.
A420–A438, 2015.



Referências 111

GAO, Z.-M.; WU, J.-M. A linearity-preserving cell-centered scheme for the anisotropic diffusion
equations. In: Finite Volumes for Complex Applications VII-Methods and Theoretical Aspects.
[S.l.]: Springer, 2014. p. 293–301.

HARTEN, A. High resolution schemes for hyperbolic conservation laws. Journal of computatio-
nal physics, Elsevier, v. 49, n. 3, p. 357–393, 1983.

HELMIG, R. Multiphase flow and transport processes in the subsurface: a contribution to the
modeling of hydrosystems. [S.l.]: Springer-Verlag, 1997.

HERBIN, R.; HUBERT, F. Benchmark on discretization schemes for anisotropic diffusion
problems on general grids. In: WILEY. Finite volumes for complex applications V. [S.l.], 2008.
p. 659–692.

HIRSCH, C. Numerical computation of internal and external flows. Computational Methods for
Inviscid and Viscous Flows, John Wiley &amp;amp; Sons, v. 2, 1990.

HURTADO, F.; MALISKA, C.; SILVA, A.; CORDAZZO, J. A quadrilateral element-based finite-
volume formulation for the simulation of complex reservoirs. In: SOCIETY OF PETROLEUM
ENGINEERS. Latin American &amp;amp; Caribbean Petroleum Engineering Conference. [S.l.], 2007.

HURTADO, F. S. V. Formulação Tridimensional de Volumes Finitos para Simulação de Reserva-
tórios de Petróleo com Malhas Não-Estruturadas Híbridas. Tese (Doutorado) — Universidade
Federal de Santa Catarina, 2011.

KEILEGAVLEN, E.; KOZDON, J.; MALLISON, B. Monotone multi-dimensional upstream
weighting on general gridsnormal access. ECMOR XII - 12th European Conference on the
Mathematics of Oil Recovery, 2010.

KEILEGAVLEN, E.; KOZDON, J. E.; MALLISON, B. T. Multidimensional upstream weighting
for multiphase transport on general grids. Computational Geosciences, Springer, v. 16, n. 4, p.
1021–1042, 2012.

KO, S.; AU, A. D. A weighted nine-point finite-difference scheme for eliminating the grid orien-
tation effect in numerical reservoir simulation. In: SOCIETY OF PETROLEUM ENGINEERS.
SPE Annual Technical Conference and Exhibition. [S.l.], 1979.

KOZDON, J. E.; MALLISON, B. T.; GERRITSEN, M. G. Multidimensional upstream weighting
for multiphase transport in porous media. Computational Geosciences, Springer, v. 15, n. 3, p.
399–419, 2011.

LAMINE, S.; EDWARDS, M. G. Multidimensional upwind convection schemes for flow in
porous media on structured and unstructured quadrilateral grids. Journal of computational and
applied mathematics, Elsevier, v. 234, n. 7, p. 2106–2117, 2010.

LAMINE, S.; EDWARDS, M. G. Higher order cell-based multidimensional upwind schemes
for flow in porous media on unstructured grids. Computer Methods in Applied Mechanics and
Engineering, Elsevier, v. 259, p. 103–122, 2013.

LE POTIER, C. Schéma volumes finis monotone pour des opérateurs de diffusion fortement
anisotropes sur des maillages de triangles non structurés. Comptes Rendus Mathématique,
Elsevier, v. 341, n. 12, p. 787–792, 2005.



Referências 112

LE POTIER, C. A nonlinear finite volume scheme satisfying maximum and minimum principles
for diffusion operators. International Journal on Finite Volumes, p. 1–20, 2009.

LEE, S.; EFENDIEV, Y.; TCHELEPI, H. Hybrid upwind discretization of nonlinear two-phase
flow with gravity. Advances in Water Resources, Elsevier, v. 82, p. 27–38, 2015.

LEVEQUE, R. J. Numerical methods for conservation laws. [S.l.]: Springer, 1992. v. 132.

LIPNIKOV, K.; SHASHKOV, M.; SVYATSKIY, D.; VASSILEVSKI, Y. Monotone finite volume
schemes for diffusion equations on unstructured triangular and shape-regular polygonal meshes.
Journal of Computational Physics, Elsevier, v. 227, n. 1, p. 492–512, 2007.

LIPNIKOV, K.; SVYATSKIY, D.; VASSILEVSKI, Y. Interpolation-free monotone finite volume
method for diffusion equations on polygonal meshes. Journal of Computational Physics, Elsevier,
v. 228, n. 3, p. 703–716, 2009.

LIPNIKOV, K.; SVYATSKIY, D.; VASSILEVSKI, Y. A monotone finite volume method for
advection–diffusion equations on unstructured polygonal meshes. Journal of Computational
Physics, Elsevier, v. 229, n. 11, p. 4017–4032, 2010.

LIPNIKOV, K.; SVYATSKIY, D.; VASSILEVSKI, Y. Minimal stencil finite volume scheme
with the discrete maximum principle. Russian Journal of Numerical Analysis and Mathematical
Modelling, v. 27, n. 4, p. 369–386, 2012.

LÖHNER, R. Applied computational fluid dynamics techniques: an introduction based on finite
element methods. [S.l.]: John Wiley &amp;amp; Sons, 2008.

NIKITIN, K.; TEREKHOV, K.; VASSILEVSKI, Y. A monotone nonlinear finite volume method
for diffusion equations and multiphase flows. Computational Geosciences, Springer, v. 18, n. 3-4,
p. 311–324, 2014.

PARK, J. S.; KIM, C. Multi-dimensional limiting process for finite volume methods on unstruc-
tured grids. Computers &amp;amp; Fluids, Elsevier, v. 65, p. 8–24, 2012.

PRICE, H. S. Monotone and oscillation matrices applied to finite difference approximations.
Mathematics of Computation, JSTOR, v. 22, n. 103, p. 489–516, 1968.

QUEIROZ, L.; SOUZA, M.; CONTRERAS, F.; LYRA, P.; CARVALHO, D. On the accuracy
of a nonlinear finite volume method for the solution of diffusion problems using different
interpolations strategies. International Journal for Numerical Methods in Fluids, Wiley Online
Library, v. 74, n. 4, p. 270–291, 2014.

RAMIREZ, G. G.; SOUZA, M. R. de A.; CARVALHO, D. K. E. de; LYRA, P. R. M. Spectral
(finite) volume method for the solution of 1-d two-phase flows in porous media. XXXIV Iberian
Latin-American Congress on Computational Methods in Engineering, p. 1–20, 2013.

ROE, P. L. Approximate riemann solvers, parameter vectors, and difference schemes. Journal of
computational physics, Elsevier, v. 43, n. 2, p. 357–372, 1981.

SERNA, S. A characteristic-based nonconvex entropy-fix upwind scheme for the ideal mag-
netohydrodynamic equations. Journal of Computational Physics, Elsevier, v. 228, n. 11, p.
4232–4247, 2009.



Referências 113

SHENG, Z.; YUAN, G. The finite volume scheme preserving extremum principle for diffusion
equations on polygonal meshes. Journal of computational physics, Elsevier, v. 230, n. 7, p.
2588–2604, 2011.

SHENG, Z.; YUAN, G. An improved monotone finite volume scheme for diffusion equation
on polygonal meshes. Journal of Computational Physics, Elsevier, v. 231, n. 9, p. 3739–3754,
2012.

SHENG, Z.; YUAN, G. A cell-centered nonlinear finite volume scheme preserving fully positivity
for diffusion equation. Journal of Scientific Computing, Springer, p. 1–25, 2015.

SHU, C.-W.; OSHER, S. Efficient implementation of essentially non-oscillatory shock-capturing
schemes. Journal of Computational Physics, Elsevier, v. 77, n. 2, p. 439–471, 1988.

SOUZA, M. R. d. A. Simulação Numérica de Escoamento Bifásico em Reservatórios de Pe-
tróleo heterogêneos e Anisotrópicos Utilizando um Método de Volumes Finitos "Verdadeira-
mente"Multidiensional com Aproximação de Alta Ordem. Tese (Doutorado) — Universidade
Federal de Pernambuco, 2015.

SWEBY, P. K. High resolution schemes using flux limiters for hyperbolic conservation laws.
SIAM journal on numerical analysis, SIAM, v. 21, n. 5, p. 995–1011, 1984.

TODD, M.; O’DELL, P.; HIRASAKI, G. Methods for increased accuracy in numerical reservoir
simulators. Society of Petroleum Engineers Journal, Society of Petroleum Engineers, v. 12, n. 06,
p. 515–530, 1972.

VAN LEER, B. Towards the ultimate conservative difference scheme. v. a second-order sequel
to godunov’s method. Journal of computational Physics, Elsevier, v. 32, n. 1, p. 101–136, 1979.

VIDOVIC?, D.; DIMKIC?, M.; PUŠIC?, M. Accelerated non-linear finite volume method for
diffusion. Journal of computational physics, Elsevier, v. 230, n. 7, p. 2722–2735, 2011.

WANG, Z. J. Spectral (finite) volume method for conservation laws on unstructured grids. basic
formulation: Basic formulation. Journal of Computational Physics, Elsevier, v. 178, n. 1, p.
210–251, 2002.

WOOD, R.; O’NEILL, M. An always convergent method for finding the spectral radius of an
irreducible non-negative matrix. ANZIAM Journal, v. 45, p. 474–485, 2004.

WOODFIELD, P. L.; SUZUKI, K.; NAKABE, K. A simple strategy for constructing bounded
convection schemes for unstructured grids. International journal for numerical methods in fluids,
Wiley Online Library, v. 46, n. 10, p. 1007–1024, 2004.

WU, J.; GAO, Z. Interpolation-based second-order monotone finite volume schemes for aniso-
tropic diffusion equations on general grids. Journal of Computational Physics, Elsevier, v. 275,
p. 569–588, 2014.

YANOSIK, J.; MCCRACKEN, T. A nine-point, finite-difference reservoir simulator for realistic
prediction of adverse mobility ratio displacements. Society of Petroleum Engineers Journal,
Society of Petroleum Engineers, v. 19, n. 04, p. 253–262, 1979.

YUAN, G.; SHENG, Z. Monotone finite volume schemes for diffusion equations on polygonal
meshes. Journal of computational physics, Elsevier, v. 227, n. 12, p. 6288–6312, 2008.



114

APÊNDICE A – MÉTODOS DOS
VOLUMES FINITOS LINEAR UTILIZANDO

PONTOS HARMÔNICOS (MPFA-H)

Nesta seção, descrevemos um método dos volumes finitos linear proposto por (GAO;
WU, 2014), este método foi proposto inicialmente para resolver numericamente problemas de
difusão em meios heterogêneos e anisotrópicos sobre malhas poligonais quaisquer. Os valores
desconhecidos são centrados nos volumes de controle e o método baseia-se no critério de
preservação da linearidade e no uso dos pontos de média harmônica localizados nas superfícies
de controle da heterogeneidade. O critério de preservação da linearidade requer que a derivação
do método seja exata sempre que a solução seja uma função linear com tensor de difusão seja
constante na malha computacional. O ponto chave na construção deste método é a discretização
do fluxo através de cada superfície de controle. Nós primeiro construímos os fluxos unilaterais
em cada célula independentemente e então, integramos os dois fluxos unilaterais em ambos
os lados da superfície de controle para obter a expressão de fluxo única. O ponto harmônico
sugerido em Agélas, Eymard e Herbin (2009) é outro fator importante na construção dos fluxos
unilaterais. Usualmente, cada superfície de controle possui um ponto harmônica associado a ele,
que permite que nossa expressão de fluxo de um lado processe um pequeno estêncil envolvendo
apenas o volume de controle em questão e os volumes de controle que têm uma face comum
com ela. Esta natureza facilita a implementação do nosso esquema em malhas poligonais não
estruturadas.

Este método satisfaz as seguintes propriedades:

• É localmente conservativo e possui um estêncil local;

• Permite tensores cheios e lida com malhas não estruturadas;

• Possui uma precisão superior a primeira ordem para soluções lisas

De maneira similar ao método NLFV-PP, o fluxo único sobre a face IJ ? E int pode ser
expressa como a combinação convexa dos fluxos laterais dadas nas equações (3.29) e (3.31)

~VIJ ·~NIJ = wR?,IJ~V
L?
IJ ·~NIJ ?wL?,IJ~V

R?
IJ ·~NIJ (A.1)

Note que a equação anterior satisfaz a equação da conservação local definida em (3.5).
A diferença dos métodos não lineares, neste método linear os pesos wL?,IJ e wR?,IJ são definidos
tendo influencia somente de parâmetros físicos-geométricos sem envolver as variáveis auxiliares



APÊNDICE A. MÉTODOS DOS VOLUMES FINITOS LINEAR UTILIZANDO PONTOS HARMÔNICOS
(MPFA-H) 115

Figura 40 – Representação do estêncil para o calculo do fluxo utilizando os pontos harmônicos:
figura esquerda é o estêncil do método MPFA-H e da direita é estêncil usando pelo
método MPFA-HD

Fonte – Produzido pelo autor

e respeitando a equação de restrição dada em (3.34), assim:

wL?,IJ =
hR?,IJ K

(n)
L?,IJ

hR?,IJ K
(n)
L?,IJ

+ hL?,IJ K
(n)
R?,IJ

e wR?,IJ = 1?wL?,IJ (A.2)

onde hL?,IJ e hR?,IJ representam as distancias ortogonais à face IJ projetadas desde os centroides
dos volumes de controle L? e R?, respectivamente.
As projeções normais dos tensores de permeabilidade K˜L? (resp. K˜R?) sobre a face IJ são denotados
por K(n)

L?,IJ
(resp. K(n)

R?,IJ
) e dadas na seguinte equação

K(n)
L?,IJ

=~n&gt;IJ K˜L?~nIJ e K(n)R?,IJ =~n&gt;JI K˜R?~nJI (A.3)
onde ~nIJ é o vetor normal unitário a face IJ.

Substituindo as equações (3.29) e (3.31) em (3.63) e manipulando algebricamente, temos:

~VIJ ·~NIJ = ?IJ?
??
IJ?

?
?AL?,IJ pL? ?AR?,IJ pR? + ?

?=i, j

(
DR?,?(IJ) pR?,?(IJ)?DL?,?(IJ) pL?,?(IJ)

)?? (A.4)
os novos coeficientes A e D são expressos como segue:

AL?,IJ = wL?,IJ
(

?L?,i(IJ) + ?L?, j(IJ)

)
, AR?,IJ = wR?,IJ

(
?R?,i(IJ) + ?R?, j(IJ)

)
, (A.5)

DL?,?(IJ) = wL?,IJ ?L?,?(IJ) e DR?,?(IJ) = wR?,IJ ?R?,?(IJ) para ? = i, j. (A.6)

onde os parâmetros ?L?,?(IJ) e ?R?,?(IJ) com ? = i, j são dadas nas equações (3.30) e (3.32).
As pressões nos vértices pL?,i(IJ), pL?, j(IJ), pR?,i(IJ) e pR?, j(IJ) são interpoladas utilizando a

estratégia de interpolação através dos pontos harmônicos. Na figura 40, notamos por exemplo,



APÊNDICE A. MÉTODOS DOS VOLUMES FINITOS LINEAR UTILIZANDO PONTOS HARMÔNICOS
(MPFA-H) 116

que o estêncil de interpolação para obter o fluxo na superfície de controle em questão é menor
do que o estêncil de outros métodos MPFA classicos, como o MPFA-O (AAVATSMARK, 2002),
MPFA-D (GAO; WU, 2011; CONTRERAS, 2016) ou até o nosso método MPFA-HD descrito
no capitulo 3.

Tratamento do Fluxo nas Faces de Contorno

Quando a face em questão pertence ao contorno do domínio ? ?.
Primeiramente consideramos quando a face em questão pertence ao contorno de Dirichlet, assim
o calculo do fluxo é dada por:

~VIJ ·~NIJ = ~V L?IJ ·~NIJ = ?IJ
?????IJ???

?
?AL?,IJ pL? ? ?

?=i, j

?L?,?(IJ) pL?,?(IJ)

?
? (A.7)

onde AL?,IJ = ?L?,i(IJ) + ?L?, j(IJ).
O fluxo no contorno de Neumann é dada pela seguinte expressão

~VIJ ·~NIJ = gN
?????IJ??? (A.8)

onde gN representa o valor do fluxo prescrito na face que pertence ao contorno de Neumann.
O analise do tratamento das pressões no contorno são completamente análogos ao do

método NLFV-DMP descrito no capitulo 3.


	Folha de rosto
	Folha de aprovação
	Dedicatória
	RESUMO
	ABSTRACT
	Lista de ilustrações
	Lista de tabelas
	Sumário
	INTRODUÇÃO
	Motivação
	Estado de Arte
	Objetivos
	Contribuições do Presente Trabalho
	Trabalhos Publicados em Artigos de Revista e Congressos

	Organização da Tese

	EQUAÇÕES GOVERNANTES
	Equação de Conservação de Massa e a Lei de Darcy
	Equações de Pressão e Saturação

	FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE PRESSÃO
	Método de Volumes Finitos Centradas no Volume de Controle
	Formulação Numérica Implícita da Equação de Pressão
	Método de Volumes Finitos Não Linear que Preserva Positividade (NLFV-PP)
	Tratamento do Fluxo nas Faces de Contorno do Método NLFV-PP
	Sistema Discreto do Método NLFV-PP
	Estratégia de Interpolação que Preserva Linearidade (LPEW)

	Método dos Volumes Finitos Não Ortodoxo tipo MPFA
	Tratamento do Fluxo nas Faces de Contorno do Método MPFA-HD
	Sistema Discreto do Método MPFA-HD

	Método dos Volumes Finitos Não Linear que Satisfaz o Princípio do Máximo Discreto (NLFV-DMP)
	Estratégia de Interpolação Utilizando Pontos Harmônicos (HP)
	Tratamento dos Fluxos nas Faces de Contorno do Método NLFV-DMP 
	Sistema Discreto do Método NLFV-DMP



	RESULTADOS NUMÉRICOS: ESCOAMENTO MONOFÁSICO
	Teste de Linearidade: Escoamento Monofásico com Drenagem Oblíqua
	Teste de Convergência
	Escoamento Monofásico num Reservatório Homogêneo Suavemente Anisotrópico

	Teste de Preservar Positividade (PP) e/ou Satisfaz o Principio do Máximo Discreto (DMP)
	Escoamento Monofásico Utilizando Condições de Contorno com Gradiente Inclinada
	Escoamento Monofásico em Reservatório Muito Heterogêneo e Anisotrópico


	FORMULAÇÃO NUMÉRICA DA EQUAÇÃO DE SATURAÇÃO
	Formulação Numérica Explícita para a Equação de Saturação
	Problema de Riemann e Método de Godunov
	Fluxo Numérico e Resolvedores do Problema de Riemann
	Método TVD (Total Variation Diminishing)
	Formulação Numérica de Alta Ordem tipo MUSCL de Volumes Finitos (HOMFV)
	Processo de Limitação

	Formulação Numérica Multidimensional de Detecção Ótima Ordem (MOOD)


	RESULTADOS NUMÉRICOS: ESCOAMENTO BIFÁSICO
	Escoamento num Reservatório Altamente Heterogêneo
	Escoamento Bifásico num Meio Homogêneo com Três Poços

	CONCLUSÃO E TRABALHOS FUTUROS
	Referências
	MÉTODOS DOS VOLUMES FINITOS LINEAR UTILIZANDO PONTOS HARMÔNICOS (MPFA-H)

</field>
	</doc>
</add>