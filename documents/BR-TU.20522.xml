<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20522</field>
		<field name="filename">4094_Coelho_AntonioCarlosDecno_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada à Faculdade de Engenharia Mecânica Como Requisito Parcial à Obtenção do Título de Mestre em Engenharia de Petróleo
ANÁLISE DE TESTES EM RESERVATÓRIOS COM VARIAÇÃO VERTICAL DE PERMEABILIDADE
Autor: Antonio Carlos Decnop Coelho
Orientador : Antonio Cláudio de França Corrêa
M | ci 4
novembro - 1991
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação “Análise de Testes em Reservatórios com Variação Vertical de Permeabilidade”, elaborada por Antonío Carlos Decnop Coelho e aprovada por todos os membros da Banca Examinadora, foi aceita pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial à obtenção do Título de Mestre em Engenharia de Petróleo.
Campinas, 11 de novembro de 1991
Antonio Cláudio de França Corrêa, Ph. D.
(Orientador,)
Alvaro Marcello Marco Peres, Ph. D.

Kelsen Valente Serra, Ph. D.
A minha esposa
Valéria
e
às minhas filhas
Marcella, Renata e Fernanda.
AGRADECIMENTOS
Ao Prof. Dr. Antonio Cláudio de França Corrêa pela orientação e estímulo.
Ao Prof. Dr. Kelsen Valente Serra pelas sugestões e Incentivo.
&gt;1
A Valéria, Marcella, Renata e Fernanda pelo apoio irrestrito em todos os momentos e pela compreensão.
Aos meus pais pela educação e boa formação que recebi.
Aos amigos que participaram do curso de mestrado, pela convivência saudável e pela amizade demonstrada, sem as quais teria sido mais difícil.
A Petróleo Brasileiro S.A. - PETROBRAS - pela oportunidade e pelo suporte financeiro para realização deste trabalho.
RESUMO
Diferentes ambientes deposi clonáis, sujeitos à variações de energia ao longo do tempo geológico, associados à diferentes processos diagenéticos, causam variações nas características das rochas sedimentares. E comum observar-se variações verticais na permeabilidade de rochas reservatório, podendo ocorrer de forma contínua ou discreta.
0 objetivo deste trabalho é apresentar um estudo sobre o comportamento de pressões e vazões em poços completados em reservatórios com variação vertical de permeabilidade, submetidos a testes de pressão, assim como avaliar técnicas para interpretação de testes em tais reservatórios.
Três tipos de reservatórios com variação vertical de permeabilidade são considerados neste trabalho:
•	reservatórios com variação contínua de permeabilidade na direção vertical,
9 reservatórios com múltiplas camadas sem fluxo cruzado e
*	reservatórios com múltiplas camadas com fluxo cruzado.
Devido à complexidade do modelo matemático associado ao caso de reservatório com variação contínua de permeabilidade, esse modelo foi considerado como um caso particular do modelo de reservatório com múltiplas camadas com fluxo cruzado.
São apresentadas as soluções matemáticas para os dois modelos básicos e discutida a influência de diversos parâmetros sobre o comportamento de pressões e vazões.
São discutidos também diversos métodos de regressão não linear e suas aplicações para interpretação automatizada de testes, incluindo-se os casos de reservatórios com múltiplas camadas.
ABSTRACT
Due to variations in the environment in which sediments were deposited and the diagenetscs process that sediments were submited in their evolution, it is very common to find reservoirs which typically show a vertical variation of permeability.
The purpose of this work is to investigate pressure and rate transient behavior in such reservoirs, in order to provide a method for characterization of the reservoir parameters through well test analysis.
Three kind of reservoirs are considered in this work:
•	reservoirs with continuous vertical variation of permeability,
•	multilayer reservoirs without formation crossflow, and
•	multilayer reservoirs with formation crossflow.
The continuous vertical variation of permeability case is treated as a special case of multilayer reservoir with formation crossflow.
Matematical solutions for the two basic model are presented and the influence of several reservoir parameters on the pressure and rate behavior are discussed.
Methods for nonlinear parameter estimation in well test analysis are also discussed.
Conteúdo
1	introdução	i
2	REVISÃO	BIBLIOGRÁFICA	6
2.1	Reservatórios com Variação Vertical de Permeabilidade.......	.	6
2.1.1	Reservatório sem Fluxo Cruzado . ...................... 6
2.1.2	Reservatório com Fluxo Cruzado......................... 8
2.2	Análise Automatizada de Testes de Pressão ..................  9
3	RESERVATÓRIOS COM VARIAÇÃO VERTICAL DE PERMEABI-
LIDADE	12
3.1	Reservatórios	com Variação Contínua de Permeabilidade .	...  14
3.2	Reservatórios	com Múltiplas Camadas sem Fluxo Cruzado	......... 16
3.3	Reservatórios	com Múltiplas Camadas com Fluxo Cruzado......  27
4	ANÁLISE AUTOMATIZADA DE TESTES DE PRESSÃO	39
4.1	Métodos Baseados em Mínimos Quadrados........................39
4.1.1	Método de Newton-Greenstadt . .......................  44
4.1.2	Método de Newton-Cholesky . ...........................45
4.1.3	Método de Gauss......................................  47
4.1.4	Método de Gauss-Marquardt..........................    47
4.1.5	Método de Gauss-Greenstadt ..........................  48
4.1.6	Método de Gauss-Cholesky. ............................ 48
4.1.7	Normalização do Sistema de Equações ...................49
4.2	Métodos Baseados em Mínimos Valores Absolutos............... 50
4.3	Otimização Restrita.......................................   52
4.4	Análise Estatística da Regressão...........................  53
5	DISCUSSÕES	55
5.2	Reservatórios com Variação Vertical de Permeabilidade ..... 70
6	CONCLUSÕES	103
7	RECOMENDAÇÕES	105
NOMENCLATURA	106
REFERÊNCIAS	110
APÊNDICE A: ALGORITMO PARA BUSCA LINEAR	116
APÊNDICE B: FATORIZAÇÃO DE CHOLESKY	117
APÊNDICE C: SOLUÇÃO PARA RESERVATÓRIO HOMOGÊNEO 120
APÊNDICE D: SOLUÇÃO PARA RESERVATÓRIO COM DUPLA
POROSIDADE	121
Lista de Figuras
1.1	Perfis de raios gama e de permeabilidade em deltas.......... 2
1.2	Esquema de reservatório sem fiuxo cruzado  ................. 3
1.3	Esquema de reservatório com fluxo cruzado.................   4
3.1	Perfil esquemático de permeabilidade ...................... 16
5.1	Gráfico log-log dos dados da Tabela 5.1.1 .........  .	58
5.2	Ajuste com o modelo ótimo ................................. 59
5.3	Evolução da função objetivo ............................... 60
5.4	Estimativas da permeabilidade x função objetivo...........  61
5.5	Estimativas do fator de película x função objetivo..........61
5.6	Estimativas do coeficiente de estocagem x função objetivo . 62
5.7	Gráfico log-log para o teste simulado em dupla porosidade.. 63
5.8	Ajuste com o modelo ótimo ................................  65
5.9	Evolução da função objetivo..............................   65
5.10	Estimativas da permeabilidade das fissuras x função objetivo..........  66
5.11	Estimativas do fator de película x função objetivo  ................... 67
5.12	Estimativas do coeficiente de estocagem x função objetivo ..............67
5.13	Estimativas de lambda x função objetivo  ..........................  .	68
5.14	Estimativas de omega x função objetivo.............................  .	68
5.15	Ajuste em dados simulados com perturbações ...........................  69
5.16	Gráfico log-log para reservatório com 3 camadas . ..................... 72
5.17	Comportamento das vazões de cada camada ............................... 72
5.18	Efeitos de fronteira e estocagem na pressão .	.......................   73
5.19	Efeitos de fronteira e estocagem na vazão............................   74
5.20	Influência de diferentes fatores de película na	pressão ............... 74
5.21	Influência de diferentes fatores de película na	inclinação m ......... 75
5.22	Influência de diferentes fatores de película na	vazão.................  76
5.23	Comportamento da pressão em reservatório com duas camadas..........  .	78
5.24	Comportamento das vazões em reservatório com duas camadas.............. 78
5.25	Comportamento típico de pressões na estática........................... 79
5.26	Influência do tempo de produção na pressão  ..........................  80
5.27	Influência do tempo de produção na vazão durante a estática.............81
5.28	Influência do efeito de película na pressão...........................  82
5.29	Influência do efeito de película na inclinação m...................  .	83
5.30	Influência do efeito de película na vazão ............................  83
5.31	Comparação do comportamento de pressões ............................... 84
5.32	Comparação do comportamento das derivadas.............................  85
5.33	Comparação do comportamento das vazões	. ............................ 86
5.34	Influência da relação fcj/ibj nas derivadas ............................87
5.35	Influência da relação kv/kk nas derivadas ............................  88
5.36	Influência da relação k^./k^ nas vazões............................  .	88
5.37	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Primeiro
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado.......... 91
5.38	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Primeiro
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado ......	92
5.39	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Segundo
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado.......... 92
5.40	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Segundo
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado.......... 93
5.41	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Primeiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado ......	95
5.42	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Primeiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado ......	96
5.43	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Segundo
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado ...... 96
5.44	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Segundo
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado....... 97
5.45	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Terceiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado....... 97
5.46	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Terceiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado....... 98
5.47	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Reservatório
Sem Fluxo Cruzado ................................................  100
5.48	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Reser-
vatório Sem Fluxo Cruzado.........................................  100
5.49	Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Reservatório
Com Fluxo Cruzado ................................................  102
5.50	Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Reser-
vatório Com Fluxo Cruzado ........................................  102
Lista de Tabelas
5.1.1	Reservatório Homogêneo - Dados de pressão e tempo equivalente............57
5.1.2	Reservatório Homogêneo - Dados complementares.........................  57
5.1.3	Reservatório Homogêneo - Comparação de Desempenho ......................59
5.1.4	Reservatório Dupla Porosidade - Dados básicos ..........................63
5.1.5	Reservatório Dupla Porosidade - Comparação de Desempenho................64
5.2.2	Dados para Gerar Exemplo de Reservatório com Duas Camadas Sem Fluxo
Cruzado............................................................     89
5.2.3	Reservatório Sem Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão .................................................      90
5.2.4	Dados para Gerar Exemplo de Reservatório com Duas Camadas Com Fluxo
Cruzado............................................................     94
5.2.5	Reservatório Com Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão....................................................    94
5.2.6	Reservatório Com Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão e na Vazão da Camada 2 . ............................  99
5.2.7	Reservatório Com Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão e de Vazão..........................................  101
CAPITULO I
INTRODUÇÃO
A qualidade de uma rocha reservatório de petróleo está diretamente relacionada com o ambiente deposicional em que a rocha foi originada e ao histórico diagenético ao qual foi submetida durante sua evolução. 0 ambiente deposicional é responsável pela estrutura e pela textura original da rocha e os processos diagenéticos, aos quais a rocha foí submetida, podem modificar drasticamente suas características iniciais tais como, porosidade e permeabilidade. De um modo geral, arenitos com boa permo-porosidade primária foram depositados em ambiente de alta energia, responsável pela boa seleção de grãos. Porém, em diversos ambientes, essa energia não é constante durante a deposição das camadas. Quando a energia decresce com o tempo, ocorre um depósito com variação vertical de permeabilidade, a qual é decrescente da base para o topo. 0 caso oposto, ou seja, energia crescente com o tempo, ocasiona um depósito com permeabilidade aumentando para o topo.
Um exemplo interessante são os reservatórios originados em paleo-deltas, que são portadores da maior parte do óleo existente em reservatórios arenítícos no planeta. Dentre os reservatórios originados em deltas, destacam-se os depósitos de canais, em geral, e os de barras depositadas em ambiente de alta energia, como reservatórios primários de boa qualidade.
Os reservatórios de barras de deltas de alta energia sao caracterizados pela presença de graos finos na base e de grosseiros no topo. Os motivos principais dessa distribuição granulométrica são o retrabalhamento por ondas e marés, e a progradação do delta. Da mesma forma, a qualidade do reservatório também deve variar no interior de urna barra, nesse caso, decrescente do topo para a base.
A Figura 1.1, obtida do trabalho de Sneider el aL [1], mostra esquemática* mente a distribuição granulométrica e os perfis de raios gama e de permeabilidade em depósitos de canais e barras de deltas.
CAKJU9 DELTAICOS
BARRA* GÍLTKICAB
• • • •
Figura 1.1: Perfis de raios gama e de permeabilidade em deltas
0 modelo físico básico considerado neste trabalho é constituído por um único poço produzindo à vazão total constante, um fluido de viscosidade constante e de pequena compressibilidade, em um reservatório com variação vertical de permeabilidade. Os efeitos gravitaclonais são considerados desprezíveis. Admitindo-se simetria radial, a equação diferencial parcial que descreve os comportamento de pressões nesse tipo de reservatório,
pode ser escrita como:
i_a r dr
onde kr ~ kr(z) é a permeabilidade na direção radial ek,~ k^z) é a permeabilidade na direção vertical.
Neste trabalho, são considerados três tipos de reservatórios com variação vertical de permeabilidade. No primeiro tipo, a permeabilidade varia continuamente com a espessura do reservatório. Esse tipo será referido como reservatório com variação contínua de permeabilidade. 0 segundo, composto de corpos permeáveis separados por camadas impermeáveis, será referido como reservatório com múltiplas camadas sem fluxo cruzado, k Figura 1.2 mostra um reservatório esquemático desse tipo.
IMPERMEÁVEL
IMPERMEÁVEL
Figura 1.2: Esquema de reservatório sem fluxo cruzado
O terceiro, composto por camadas permeáveis com diferentes características
superpostas no reservatório, será referido como reservatório com múltiplas camadas com fluxo cruzado. Um exemplo esquemático é mostrado na Figura 1.3.
	4*	F“ T«	3» *“t Jh£
			
		—	
			

SEÇÃO TRANSVERSAL
Figura 1.3: Esquema de reservatório com fluxo cruzado
Uma maneira prática e econômica de se caracterizar um reservatório de petróleo é através de testes de pressão. Os testes convencionais podem ser testes de fluxo, onde o poço é produzido à vazão constante e a pressão de fundo é medida, ou testes de estática, onde, após um período de produção à vazão constante, o poço é fechado e a pressão de fundo é registrada.
A interpretação dos dados obtidos durante os testes de fluxo ou estática permite, em alguns casos, identificar qualitativamente o tipo de reservatório e determinar quantitativamente os parâmetros característicos do reservatório.
des facilidades na identificação de sistemas pernio-porosos de maior complexidade.
Com o aumento da complexidade dos modelos utilizados, surgiu a necessidade de utilizarse métodos mais sofisticados de interpretação de testes. Entre esses métodos, o mais frequentemente utilizado é o de ajustagem automatizada de dados de pressão versus tempo a curvas típicas que, por sua vez, é baseado na estimativa de parâmetros através de regressão não linear.
A perfeita identificação e caracterização de heterogeneidades do reservatório é de fundamental importancia para o sucesso dos pro jetos de desenvolvimento e de produção de um campo de petróleo. No caso de reservatórios estratificados, a produção conjunta em camadas com diferentes características permo-porosas causará depleção diferencial entre as camadas ou, quando submetidos a métodos de recuperação suplementar por injeção de água ou de gás, haverá o aparecimento precoce desses fluidos nos poços produtores. Nas duas situações apresentadas, o conhecimento das características do reservatório, permitiria o desenvolvimento de projetos adequados de produção que proporcionariam maior recuperação final.
Para atingir-se um bom nível de qualidade nos resultados da interpretação de testes de pressão, além de utilizar-se técnicas apropriadas, é fundamental a integração de todas as informações relevantes sobre a área ou o campo em estudo, tais como: geofísica, geologia, perfis e dados de poços vizinhos.
Neste trabalho, o comportamento de pressões e vazões em reservatórios que apresentem variação vertical na permeabilidade são discutidos. São analisados, também, métodos para a interpretação de testes em tais reservatórios.
CAPITULO II
REVISÃO BIBLIOGRÁFICA
2.1	- Reservatórios com Variação Vertical de Permeabilidade
A pesquisa sobre o comportamento de pressão e vazão em reservatórios com variação vertical de permeabilidade se vem desenvolvendo acentuadamente desde a década de 60. Na bibliografia estudada, dois tipos distintos de reservatórios com variação vertical de permeabilidade são considerados: reservatório com múltiplas camadas sem fluxo cruzado e reservatório com múltiplas camadas com fluxo cruzado. Os trabalhos mais significativos são considerados a seguir.
2.1.1	- Reservatórios Sem Fluxo Cruzado
Tempelaar-Lietz [2] apresentou uma solução para o regime pseudo-permanente, em reservatórios com duas camadas com diferentes permeabilidades (&amp;amp;), com mesma espessura (ã) e mesma porosidade ($).
O primeiro estudo rigoroso sobre reservatórios estratificados sem fluxo cruzado foi desenvolvido por Leflcovlts et al. [3]. Estes autores apresentaram soluções analíticas para pressão e vazão em reservatórios estratificados (sem fluxo cruzado) limitados, onde cada camada possui diferentes características. Essas soluções, junto com as observações práticas desenvolvidas, serviram de base para muitos trabalhos que surgiram depois,
Cobb ei al, [4] utilizaram a solução de Lefkovits et al. [3], para estudar o com-
i portamento de um sistema com duas camadas, considerando principalmente a influencia do contraste de permeabilidades entre as camadas. O principal objetivo desse estudo foi verificar a aplicabilidade dos métodos clássicos de interpretação de testes de estática desenvolvidos para reservatórios homogêneos de uma só camada.
Raghavan et al. [5] estenderam o estudo da Refereência [4], analisando a influência de diferentes espessuras e do contraste de permeabilidades entre as camadas. A Referencia [5] também investigou a aplicabilidade dos métodos consagrados na interpretação de testes em reservatórios homogêneos de uma só camada.
Earlougher et al. [6] apresentaram um estudo visando analisar as características do comportamento de pressão estática em reservatórios limitados e com várias camadas independentes.
Tariq e Ramey [7] estenderam o modelo proposto por Lefkovits et al. [3], incluindo estocagem e efeito de película. A maior contribuição desse estudo foi o uso do algoritmo de Stehfest [45] para inverter numericamente a solução obtida no campo de Laplace para o campo real. Desde então, esse algoritmo tem sido amplamente utilizado em aplicações de análise de testes. Uma solução mais completa, equivalente à solução de Tariq e Ramey, é apresentada na Seção 3.2.
Larsen [8] apresentou uma solução que contempla diferentes pressões iniciais para cada camada, além das outras características consideradas pelos outros autores. Nesse trabalho, o autor fez uma boa análise sobre a influência do efeito de película.
Kucuk et al. [9] apresentaram métodos para estimar os parâmetros de cada camada individualmente, num sistema de duas camadas. Esses métodos necessitam de medições simultâneas de vazão e pressão de fundo durante o período de fluxo, e são baseados em regressão não-linear .
Raghavan [10] publicou um resumo da bibliografia existente na época sobre o assunto “Reservatórios Estratificados". Nesse artigo, o autor estudou o efeito de vários parâmetros (permeabilidade, fator de película, espessura) sobre o comportamento de pressão e vazão no poço, bem como a aplicação de métodos para a determinação de parâmetros médíos do reservatório e individuais de cada camada, para o caso de reservatórios com duas camadas.
2.1.2	- Reservatórios Com Fluxo Cruzado
Na década de 60, muitos estudos foram desenvolvidos sobre o comportamento de pressões e vazões em reservatórios estratificados com fluxo cruzado. Os primeiros trabalhos admitiam que o fluxo entre as camadas ocorria em regime transitório e baseavam-se na resolução de equações diferenciais bi-dimensionais (r-z).
Prats e Russel [11] mostraram que, para um caso de reservatório com duas camadas, o comportamento para tempo curto é idêntico ao caso de reservatório sem fluxo cruzado e, para tempo longo, o comportamento torna-se igual ao de um reservatório com uma só camada.
Prijambodo et al. [12] resolveram o problema numericamente, usando diferenças finitas, e também verificaram a existência de um “comportamento típico” para o caso de reservatórios com duas camadas. Inicialmente o comportamento é igual ao caso de reservatório sem fluxo cruzado, ocorrendo a seguir período de transição dominado pelo fluxo vertical e, por fim, um comportamento característico de reservatório de uma só camada.
Bourdet [14], por analogia ao modelo de dupla-porosidade de Warren e Root [21], propôs uma solução para um modelo de reservatório com duas camadas, incluindo efeitos de estocagem e de película. Esse modelo foi chamado de “dupla-permeabilidade”. 0 autor mostrou, também, que as soluções para vários outros modelos podem ser tratadas como casos particulares da solução do modelo proposto.
Ehlig-Economides e Joseph [15] desenvolveram uma solução completa para reservatórios com múltiplas camadas, incluindo efeitos de estocagem e de película. Propuseram, também, metodologias de testes e de interpretação baseadas na medição simultânea de pressão e vazão de fundo. Uma solução equivalente à proposta por esses autores é apresentada na Seção 3.3.
Shah et al. [16] propuseram métodos para testar e interpretar testes em reservatórios com múltiplas camadas. Esses métodos são baseados na medição simultânea de vazão e pressão de fundo em diferentes posições no poço e utilizam técnicas de regressão não linear.
Park e Horne [17], baseados na solução apresentada por Ehlig-Economides e Joseph [15], propuseram métodos de interpretação baseados em estimativa não-linear de parâmetros, utilizando também dados de pressão e vazão de fundo.
2.2	- Análise Automatizada de Testes de Pressão
A utilização de métodos de regressão não-linear para a determinação de parâmetros de reservatório não é um fato recente. A pesquisa para encontrar-se técnicas robustas de regressão não linear, que sejam eficientes para aplicações em interpretação de testes, tem aumentado consideravelmente nas duas últimas décadas. Alguns trabalhos podem ser citados.
Jahns [26], usando dados de testes de interferência, mostrou a aplicação de regressão não linear para fazer a descrição bi-dimensional do reservatório.
Coais et al. [27] apresentaram um método para caracterização do reservatório a partir do histórico de pressão. Esse método utiliza regressão linear e, também, o critério de mínimos quadrados,
Earlougher e Kersch [28] mostraram a aplicação de regressão não linear para a determinação de parâmetros do reservatório em dois casos: um teste de interferência com vários poços e um teste de “fall-off”.
Hernandez e Swift [29] apresentaram um método, usando também o critério de mínimos quadrados, que utiliza uma pseudo-linearização entre os dados medidos e os parâmetros do reservatório.
Rodgers et al. [30] mostraram a aplicação de regressão não linear para a estimativa de parâmetros em reservatórios limitados.
Rosa e Horne [34] estudaram a aplicação dos métodos de Gauss e de Gauss-Marquardt para a determinação de parâmetros em reservatório infinito homogêneo e infinito com múltiplas camadas sem fluxo cruzado. Uma contribuição importante desse trabalho foi mostrar que, tanto a solução do modelo matemático quanto seus gradientes (derivadas) em relação aos parâmetros do reservatório, podem ser obtidos por inversão numérica da solução e de suas derivadas no campo de Laplace.
Guillot e Horne [31] apresentaram um método para estimativa de parâmetros do reservatório que utiliza dados de pressão e vazão de fundo medidos simultaneamente.
Barua e Horne [32] discutiram a aplicação do método de Gauss-Marquardt na determinação de parâmetros em reservatórios submetidos a um processo térmico de recuperação suplementar, objetivando os métodos de injeção de vapor e combustão in situ.
Barua et al. [35] fizeram uma revisão sobre os métodos tipo Newton usados
em análise de testes e introduziram uma modificação no método de Newton-Greenstadt, proporcionando maior estabilidade numérica a esse processo,
Namba e Horne [36] mostraram a utilização da fatorização de Cholesky, assim como a modificação de Gill e Murray [25], nos métodos de Newton e de Gauss, e introduziram uma modificação no algoritmo de Gill e Murray, visando também uma maior robustez do método.
Rosa e Horne [39] apresentaram um método de regressão não linear que usa como critério a minímização do somatório dos valores absolutos das diferenças entre os dados medidos e os calculados.
CAPITULO III
Para 0 desenvolvimento de um modelo matemático representativo de um fenômeno físico é necessário o estabelecimento de premissas básicas, muitas vezes si.mpli.fica-doras. 0 fenômeno físico a ser estudado é a produção, à vazão constante, de um fluido de viscosidade constante e de pequena compressibilidade, através de um único poço localizado ao centro de um reservatório, cuja característica principal é a variação vertical de permeabilidades. Admite-se que o topo e a base do reservatório são fechadas por formações impermeáveis e que, inicialmente, o reservatório encontra-se igualmente pressurizado. Três situações de fronteira externa podem ser consideradas: reservatório infinito, reservatório limitado com a fronteira externa selada, e reservatório com pressão constante na- fronteira externa.
São considerados os efeitos de estocagem e de película e, desprezados os efeitos gravitacionais.
Admítindo-se simetria radial, a equação da continuidade pode ser escrita em coordenadas cilíndricas como ;
Considerando-se fluxo darciano, podemos escrever :
kr dp P dr *
(3.3)
Para fluido de pequena compressibilidade, a relação abaixo é válida :

(3.4)
onde i
» c é a compressibilidade do fluido,
• pQ é a massa específica de referência à p0.
Admitindo-se que a permeabilidade é uma função da altura, ou seja :
kr ~ kT(z),
(3.5)
(3-6)
a equação diferencial se transforma em:
, d2p krôp d2p dkzdp Á dp
(3.7)
ou:
1_0
r dr
(3-8)
3.1	- Reservatório com Variação Contínua de Permeabilildade
Devem ser estabelecidas condições auxiliares para, juntamente com a Equação
(3.8), definir totalmente o modelo matemático.
As seguintes condições são adotadas:
1	- 0 reservatório está inicialmente uniformemente pressurizado:
p(r^,í = 0)	.	(3.1.1)
2	- Fronteira lateral
2.1-0 reservatório é infinito:
=	.	(3.1.2)
2.2	- Não existe fluxo na fronteira externa:
dr
r=re
(3.1.3)
= 0 .
2.3	- A pressão é mantida constante na fronteira externa:
p(r - re, z, t) = pi .
(3.1.4)
3	- 0 reservatório é selado no topo e na base:
dz
(3.1.5)
z=(¡,fi
4	- A pressão no poço, em cada instante, é igual em qualquer posição em frente
ao reservatório:
(3.1.6)
5	- A produção se dá à vazão constante, q, e consídera-se o efeito de estocagem:
0 problema definido pela Equação (3.8) e pelas condições auxiliares (3.1,1)
a (3.1.7), não possui solução analítica conhecida. A solução para esse problema pode ser obtida numericamente ou de modo semi-analítico. Entretanto, em qualquer das duas hipóteses, torna-se necessária a discretização do reservatório. Por exemplo, um reservatório que possui o perfil contínuo de permeabilidade representado na Figura 3.1, deverá ser considerado como um reservatório com camadas superpostas e com permeabilidade constante em cada camada.
Portanto, o caso de reservatório com variação vertical contínua de permea-
bilidade será tratado como um problema de reservatório com múltiplas camadas com fluxo cruzado, com uma distribuição discreta de permeabilidade que melhor represente o problema original.
Neste trabalho, optou-se por soluções semi-analíticas, isto é, a solução analítica
Stehfest [45].
Figura 3.1: Perfil esquemático de permeabilidade
3.2	~ Reservatório com Múltiplas Camadas sem Fluxo Cruzado
Esse modelo físico é caracterizado pela falta de comunicação entre as camadas permeáveis no reservatório, ou seja, elas são separadas por lâminas ou camadas impermeáveis e a comunicação entre as camadas permeáveis só ocorre através do poço.
As seguintes hipóteses foram admitidas para estabelecimento do modelo matemático correspondente:
1.	O sistema é composto de n camadas horizontais e cilíndricas, seladas no topo e na base por camadas impermeáveis. A comunicação entre as camadas só ocorre através do poço.
2.	As camadas consistem de meios porosos homogêneos e isotrópicos, podendo possuir características diferentes entre si.
3.	Cada camada tem porosidade, permeabilidade e espessura constantes e estão saturadas com um mesmo fluído de compressibilidade pequena.
4.	A pressão inicial, p,, é a mesma em todas as camadas.
5.	A pressão instantânea no poço, é a mesma para todas as camadas.
6.	Os gradientes de pressão sao pequenos e os efeitos gravitacionais são desprezados.
7.	0 poço produz à vazão total, q, constante. Porém, a vazão de contribuição de cada camada pode ser variável.
8.	Os raios externos das camadas, rCj, podem ser diferentes.
9.	As camadas podem possuir diferentes fatores de película (S).
10.	Considerou-se o efeito de estocagem no poço.
A distribuição de pressão em cada camada é descrita pela seguinte equação diferencial :
= A r dr \ dr J \ k ) j Qt
(3.2.1)

que é um caso particular da Equação (3.8), quando K — 0 e k — kr ~ cie.
Este sistema de equações deve ser resolvido sujeito às seguintes condições de
contorno :
1 - Condição inicial:
Pj(a0)=p,- ,
(3.2.2)
j =	.
2	- Condições de contorno internas:
2.1	- A pressão no poço, pWf é igual para todas as camadas:
jPtíí(í)	Sj
onde Sj é o fator de película (skin) da camada j.
2.2	- A produção se dá à vazão total, q, constante na superfície:
qB -C
dt
(3.2.4)
onde C é o coeficiente de estocagem.
3 - Condições de contorno externas (3 possibilidades);
3.1 - Reservatório infinito:
limpai) =Pi &gt;
(3.2.5)
3.2 - Reservatório selado na fronteira externa:
dpj dr
= 0 , j = l,...,n .
3.3 - Reservatório com pressão constante na fronteira externa:
(3.2.6)


(3.2.7)
Adotando-se o sistema c.g.s. de unidades, as seguintes variáveis adímensionais
são definidas:
P3^^\Pi~PÁr,t)] ,	,
(3.2.8)
(3.2.9)
j 1, . . . , TI ,
onde :
e
- (M
3 ¿h
5
Cd ™

C
j=i
j=i
í
(3.2.10)
(3.2.11)
(3.2.12)
(3.2.13)
(3.2.14)
(3.2.15)
O sistema formado pelas Equações ( 3.2.1) a ( 3.2.7), em termos adimensí onais,
pode ser escrito como :
1 d
^td drD
5

(3.2.16)
Condição inicial:
PJI5(rp,0) = 0 ,	3 = l,...,n .
(3.2.17)
Condições de contorno internas:
rp=l
e
i = CD^a
atp
n
j=i
Condições de contorno externas:
- reservatório infinito:
- reservatório selado:
, j=	,
dPw drD

J -	.
= 0 ,
TeJD
- reservatório com pressão constante na fronteira:
drD
j =	■
Píd (rej&amp;amp;», j — 1,..., n .
As equações ( 3-2.16) a ( 3.2.22) são então transformadas para
Laplace, resultando:
Pwp —	^3
drD


rD=l
X	____ n
(3.2.18)
(3.2.19)
(3.2.20)
(3.2.21)
(3.2.22) campo de
(3.2.23)
(3.2.24)
(3.2.25)
	(3,2.26)
	(3.2.27)
Qrn	G ’	J — 1,	, r-W	
Pía (rej£¡, s) ~ 0 ,	j ~ 1,..., n ,	(3,2.28)
onde sé a variável de Laplace.
A Equação ( 3.2,23) é uma equação do tipo Bessel modificada, cuja solução
geral, para j ~ 1,..., n , é:
PK = Afa \JrD^sj + BJx}, \^rD^sj ,	(3.2.29)
onde I(j e Ko são funções de Bessel modificadas de ordem zero e Aj e Bj são parâmetros, funções da variável s, a serem determinados a partir das condições de contorno.
Derivando-se a Equação ( 3.2.29) em relação a rp, vem :
—
- AiRMfyrD) - BiRíK^Rjrv) ,
(3.2.30)

onde:
Rj — Rj (s) =
3
j — 1,..., n ,
(3.2.31)
e A e Ki são funções de Bessel modificadas de primeira ordem.
Aj ™ bj.Bj , j ~ 1,.,. ,n ,
(3.2.32)
onde, para j ~ 1,... ,n , tem-se:
í&gt;j = 0 ; para reservatório infinito,
(3,2.33)
6j — ■	para reservatório selado,
ll\Rirejo)
(3.2.34)
Kü(R;rejn)	, .
M = —----------- - paTa reservatório com pressão constante.
(3.2.35)
Usando as Equações ( 3.2.30) e ( 3.2.32) na Equação ( 3.2.24), , obtém-se:
para j
B‘ bi[UR,')-SiRiIí(Rii\-t-Ka(Rj) + SjRiKí(Rí'l '
Então, a solução geral do problema, no campo de Laplace, para j ~ 1,... ,n , é dada por:
(3.2.36)
PjB(’’D,s) =PWÍJ(®)|
+ K0(^-rg)
(3.2.37)
e
Derivando a Equação ( 3.2.37) em relação a rp e substituindo o resultado na
Equação ( 3.2.25), vem :
1
Pwr) (s) —
bjlZoCRjl-SjRj h (Rifa-K^R}AS.RjK, (RJ
onde Jlj é dado pela Equação ( 3.2.31)
Á Equação ( 3.2.38) representa, no campo de Laplace, o comportamento da pressão adimensional de um poço produzindo à vazão constante de um reservatório composto por n camadas comunicadas somente através do poço. A solução no espaço real pode ser obtida pela inversão numérica da solução no espaço de Laplace, através do algoritmo de Stehfest [45].
Note que a Equação ( 3.2.38) também é válida para o caso de um reservatório homogêneo com uma só camada produtora. Neste caso teremos n — 1 , w = 1 , k ~ 1 e R = t/s .
A expressão da vazão de cada camada produtora é dada por:
gjB =
2w(kh)j
(3.2.39)

Definindo-se ;
(3.2.40)
e usando-se pjD como definido em ( 3.2.8), podemos escrever, em termos adimensionais :
j = l,...,n .
(3,2.41)
Aplicando-se transformada de Laplace, temos :
(3.2.42)
íj» ~ PwpKj '
______WW) -
t&gt;i [UñJ - -WM)] + ^o(^) + S^k\{R.)
(3.2.43)
onde pWD(s) é definido pela Equação ( 3.2.38).
A Equação ( 3.2.43) descreve o comportamento, no campo de Laplace, da vazão de cada camada. A solução no campo real pode ser obtida através do algoritmo de Stehfest.
Solução para o período de estática
A solução para o período de estática é obtida pelo princípio da superposição,
ou seja :
“ Pw£) (^tp)	Pw£)(^p 4" At)p 4” Pw£l(ipfl) 5
(3.2.44)
onde:
e
qBfi
1
(3.2.45)
Pwyt, — Pwf{tp) •
(3.2.46)
		1 0 ,	para tD &amp;lt;tPD ,	
				(3.2.47)
		1 ,	para tD &gt; tpp .	
Â condição de contorno interna (3.2.19) pode então ser generalizada por:
Cd
dpwrj dÍD
n
J=1
ârp
- 1 - u(tD - tPV) rjj=l
(3.2.48)
onde aqui, representa tanto a solução para fluxo como para estática.
Note que o lado direito da Equação ( 3.2.48) será 1 quando t&amp;amp; &amp;lt;iPD (fluxo), e 0 (zero) quando 1$ &gt; tPD (estática).
Transformando a Equação ( 3,2.48) para o campo de Laplace, vem:
n
CdPwd S ~ 22
j=l
1 e~ríPo
s s
(3.2.49)
rp=l
As outras condições de contorno permanecem inalteradas.
Derivando a Equação ( 3.2.37) em relação a r$ e substituindo
na Equação
( 3.2.49), vem :
1 — e"*ípo
(3.2.50)
onde Rj é dado pela Equação ( 3.2.31)
PwS£l(S) Jpw£)(s)(f ® PD) )
(3.2.51)
onde a. notação pW4S£&gt; representa a solução obtida pela Equação ( 3,2.50) para tempos tais queíp &gt; iPD).
Invertendo a Equação ( 3.2.51) para o campo real, vem:
Pw«p(Í£&gt;) — Pwp(Íd) Pwd(ÍD íps) •
Definindo-se:
Atf) — ij) tpD ,
(3.2,52)
(3.2.53)
resulta:
P-iwpfópD d" — Pwd^pd d*	•	(3.2.54)
A Equação ( 3.2.54) é uma aplicação do princípio da superposição e é a solução geral para a pressão no período de estática.
A vazão adimensional de cada camada no período de fluxo é obtida pela Equação ( 3.2.41). Usando-se procedimento similar ao utilizado para se obter a solução para a pressão adimensional na estática, pode-se chegar à solução para a vazão adimensional no campo de Laplace, ou seja:
ç^(5) = ç™(s)(l - e~*tpD) .	(3.2,55)
Invertendo para o campo real, para to &gt; (estática), vem:
d"	^jd^pd *h	■	(3.2.57)
A Equação ( 3.2.57) mostra que o princípio da superposição também é válido para as vazões. Essa equação foi usada para calcular as vazões durante o período de estática.
Observar que, como o poço está fechado durante o período de estática, então, n
(3.2.58) j=i
3.3	- Reservatório com Múltiplas Camadas com Fluxo Cruzado
Nesse modelo físico, além da comunicação através do poço, ocorre a comunicação entre as camadas permeáveis no reservatório, pelo fato de tais camadas estarem em contato entre si.
As seguintes hipóteses foram admitidas para estabelecimento do modelo matemático correspondente:
1.	O sistema é composto de n camadas horizontais e cilíndricas superpostas. A comunicação entre as camadas ocorre através do poço e ao longo do reservatório.
2.	As camadas consistem de meios porosos homogêneos e isotrópicos, podendo possuir características diferentes entre si.
3.	Cada camada tem porosidade, permeabilidade e espessura constantes e estão saturadas com um mesmo fluido de pequena compressibilidade.
4.	A pressão inicial, p,-,éa mesma em todas as camadas.
5.	A pressão instantânea, no poço, pw, é a mesma para todas as camadas.
6.	Os gradientes de pressão são pequenos e os efeitos gravit acionais são desprezados.
7.	0 poço produz à vazão total, q, constante. Porém, a vazão de contribuição de cada camada pode ser variável.
8.	Os raios externos das camadas, rí?, são admitidos iguais, no caso de reservatórios limitados. Esta restrição torna-se necessária para permitir que haja fluxo ao longo de toda a interface entre duas camadas adjacentes.
9.	As camadas podem possuir diferentes fatores de película (S).
10.	Considerou-se o efeito de estocagem no poço.
O comportamento de pressões em um sistema como o definido acima é descrito pela seguinte equação diferencial :
(3.3.1)
Para resolver esse problema, usou-se o método semi-analítico proposto por Economides e Joseph [15], em analogia ao modelo de dupla-permeabilidade proposto por Bourdet [14].
Após a integração da Equação ( 3.3.1) ao longo de z, pode-se reescreve-la da seguinte forma:
+ kx
®Ei|	_ &amp;amp; Ê2il
U=«+l/2	* 8z b=z-l/2
(3.3.2)

Aplicando-se diferenças finitas no segundo e terceiro termos da Equação ( 3.3.2),
vem :
onde :


(3.3.4)
+ &amp;amp;j+i
2
(3.3.5)
Como condições auxiliares temos :
1 - Condição inicial:
p/r,0) =p{ ,	¿	.
(3.3.6)
2 - Condições de contorno internas:
e
Pwf(t) —	Sj
1
j -- 1 , r .., n ,
(3.3.7)
3.2 - Reservatório selado na fronteira externa
&amp;amp;Pi dr
= 0
5
3,3 - Reservatório com pressão constante na fronteira externa:
Pj(re,t} -pt ,	&gt; = l,...,n ,
As Equações ( 3.3.3) e ( 3.3.6) a ( 3.3.11) podem definição das seguintes variáveis e parâmetros adimensíonais :
, „ Oi.
1	4&gt;h

5
(3.3.9)
(3.3.10)
(3.3.11) normalizadas após a
(3.3.12)
(3.3.13)
(3.3.14)
(3.3.15)
(3.3.16)
2
3 =	,
(3.3.17)
onde ;
Cd ~
C
2x$hc.irl&gt;

(3.3.18)
j=i
(3.3.19)
j=l
(3.3.20)
Então, em termos adimensíonais:
(3.3.21)
Aí-lG^fP Pj-ljs) AíÚPj-Hz; Piv) »
j = l,..^n .
Condição inicial:
(3.3.22)
Condições de contorno internas:
1 * * * ? ?
(3.3.23)
1=CD
dp*&gt;D dÍD
dr&amp;amp;
rp=i
(3.3.24)
Condições de contorno externas:
reservatório infinito:
r^Pi^D^o) = $ ’	j = l,...,n ;
- reservatório selado:
&amp;amp;TD
1

reservatório com pressão constante na fronteira:
j =	•
As Equações ( 3.3.21) a ( 3.3.27) são então transformadas para o
Laplace, resultando:
k^Píd = wj%+Vl(Pá -Pi-ln) -Aj(Pj+1d ~?jp) &gt;
j -
Pwp --- Pjpí^J'®)
I .■IIM»». vpjp ÔrD


rs~l
1 ________ "
” = CpPwp a z
s	j=i
5
rjO=l
rl™JPiD(r».t0) = 0
!
J =	,
3	1,..., n ,
(3.3.25)
(3.3.26)
(3.3.27) campo de
(3.3.28)
(3.3.29)
(3.3.30)
(3.3.31)
(3.3.32)
Pw (rep í s) 0 )

(3.3.33)
onde sé a variável de Laplace.
A solução geral da Equação ( 3.3.28) é da seguinte forma [14] :
Pw ~ ¿3Kf&amp;amp;rD) + BjIo(vrD) , j = l,...,n .
(3.3.34)
Substituindo-se a Equação ( 3.3.34) em ( 3.3.28), vem :
+ (/£jít2 -WjS- - Aj)Aj + AjAj+1] +
(3.3.35) + (kj-ct3 - WjS - Aj„i ~ Aj)B; + Ay#i+1] = 0 ,
j =	.
0 sistema de equações homogêneas definido pela Equação ( 3.3.35) terá solução não trivial (isto é Aj 0 e Bj / 0) se, e somente se, sua matriz de coeficientes for singular’ (não inversível). Consequentemente, o determinante dessa matriz deve ser nulo.
Os elementos formadores da matríz tri diagonal de coeficientes são definidos da seguinte forma :
—&amp;lt;
Aj„i , para k ~j - l;j &gt; 1 ,
Kj(T2 — u?jS ~ Aj-i — Aj , para k — j Aj , para k = j + 1; j &amp;lt;n ,
0 , para k/ j - 1,;,; + 1 ,

(3.3.36)

A matriz de coeficientes, A, pode ser escrita como :
(3,3.37)
onde / é a matriz identidade e os elementos de Ae sao definidos como:
-Xj-i/Kj , para
(Wjs + Àj^j + Àj)/^ , para k~j
-Xj/xj , para k~j + l\j&lt;n , 0 , para k/j-lJJ + l ,

j ~ 1,... ,n e k = 1,.., ,n .
Então, podemos escrever :
dei(A) = dei(A{ -&amp;lt;r2J) = 0 ,
(3.3.38)
(3.3.39)
e o problema se reduz a um problema de obtenção dos auto-valores que satisfaçam a Equação ( 3.3.39).
Uma vez obtidos os n auto-valores (cr2), a solução geral para cada camada pode ser escrita como:
ãr=D4K0(aíro) + B‘It,(atrD)] , j =	(3.3.40)
*=1
As Equações ( 3.3.40) contêm 2n2 coeficientes a serem determinados. As condições de contorno internas e externas fornecem somente 2n equações. Então, as Equações ( 3.3.35) são usadas para se obter uma relação entre os coeficientes Ak e Bk. As equações (3.3.35) devem ser satisfeitas para cada auto-valor cr^, ou seja, para j = 1,... ,n e k	temos:
onde:
- ojjS -	d- AjBj+1 = 0 .
Das Equações ( 3,3,41) e ( 3.3,42), para i ~ 1,..., n, obtem-se:
(3,3.42)
(3.3.43)
(3.3.44)
(3.3.45)
(3.3.46)
A* - «Mf ,
e
B¡ =	,
Jf 1
aí = “Tfc [a(i-l,í-2)a?~2 + a*í-i,í-i)a?-i]» ¿ — 3,..
,,n .
Com isso, pode-se escrever a solução geral para cada camada como :
Piv ~	+ #1 ajlo(^rp)] , j = 1,..,,n
k=l
(3.3.47)
(3.3.48)
A condição de contorno externa fornece uma relação entre os coeficientes A* e os ou seja :
k i »
(3.3.49)
onde:
bk ~ 0 ; para reservatório infinito ,
(3.3.50)
bk =
A(&lt;?íAd)
para reservatório selado ,
(3.3.51)
e

para reservatório com pressão constante .
(3.3.52)
A condição de contorno interna ( 3.3.29) pode ser aplicada para cada par de camadas adjacentes, ou seja:
(3.3.53)
ou, usando-se a solução geral 3.3.48, vem:
Hú ¿'¡{apKoW + W„(a4) +
&lt;4u IW +	M - Wi(M)} = 0 ,	(3.3.54)
j = l,...,(n-l) .
Usando-se a solução geral ( 3.3.48) na condição { 3.3.30), vem:
ÈKi è	= Ü-ríeSd) .	(3.3.55)
j=l k=l	5
Da Equação ( 3.3.55) verifica-se que se pode obter a solução sem estocagem (Cp = 0) e, posteriormente, incluir-se tal efeito, isto é:
Pwp J,wdc£j=q(1 CdPwqS ) ,
ou rearranj ando-se:
(3.3.56)
(3.3.57)
A Equação ( 3.3.52) pode ser usada para converter qualquer solução obtida sem efeito de estocagem (Cp = 0) em solução com efeito de estocagern. Neste caso, resolve-se o sistema com Cp = 0 e faz-se a inclusão posterior do efeito de estocagem.
A Equação ( 3.3.55), excluindo-se o efeito de estocagem, fica :
Ê È Afa^fKlW -	= i •	(3.3.58)
3=1 k=l	s
Deve-se então resolver o sistema de n equações lineares formado pelas Equações
( 3.3.54), n-1 equações, e pela Equação ( 3.3.58), para obter os n coeficientes
Obtidos os coeficientes Aj, calcula-se a pressão no poço, usando-se a Equação
( 3.3.29) aplicada a uma das camadas, ou seja:
= Ê A‘a‘{K0(&lt;rt) +	- 6*7^)]} .	(3.3.59)
fa=l
A inclusão do efeito de estocagem é feita através da Equação ( 3.3.57).
Solução para o período de estática
Como para o caso de reservatório sem fluxo cruzado, as soluções para o período de estática são obtidas pelo princípio da superposição. Ver Equações ( 3.2.44) a ( 3.2.57).
CAPITULO IV
Devido a complexidade dos modelos de reservatórios com variação vertical de permeabilidade, a análise de testes de pressão realizados em tais reservatórios não é uma, tarefa simples. Tanto a operação do teste quanto a sua interpretação exigem a utilização de técnicas mais sofisticadas.
A utilização de técnicas de regressão não linear, como ferramenta de interpretação automatizada de testes de pressão, proporciona um aumento na qualidade dos resultados finais. Essas técnicas, além de evitarem a subjetividade inerente aos métodos convencionais de interpretação de testes, permite uma análise estatística para verificação da qualidade dos resultados.
4.1	- MÉTODOS BASEADOS EM MÍNIMOS QUADRADOS
Os procedimentos de regressão não-linear baseados na técnica dos mínimos quadrados têm por objetivo estimar um conjunto de parâmetros desconhecidos que minimize o somatório dos quadrados das diferenças entre os dados medidos e a resposta de um modelo matemático selecionado. Todos esses métodos aqui discutidos são variações do método de Newton.
Í=I
onde:
E(a) é a função objetivo;
a — [&lt;&gt;!, a2) - ■., é o vetor cujos np elementos são os parâmetros a serem determinados;
n é o número de medidas de pressão no teste.
Pode-se ainda atribuir pesos aos resíduos de cada medida em função de sua confiabilidade. A função objetivo ficaria então definida como:
,	(4.1.2)
í=i
onde:
0 &amp;lt;7,&amp;lt;1 c o peso atribuído a cada medida.
Note que a função objetivo E(a) é função somente dos parâmetros a serem determinados, uma vez que a variável tempo é conhecida, 0 valor da função E reflete a. proximidade entre os pontos reais e o modelo teórico.
A função objetivo definida pela Equação (4.1.1) ou pela Equação (4.1.2) considera somente os quadrados dos resíduos das pressões. Qualquer outra resposta do reservatório, vazão por exemplo, pode ser considerada na função objetivo ou, até mesmo, várias respostas podem ser consideradas em conjunto.
0 método de Newton é baseado na expansão da função objetivo em uma série de Taylor em torno de um valor estimado obtido a partir de uma solução inicial o°, truncada após os termos quadráticos:
E- =	+ EK,(«* - aj)
(4.1.3) + E&amp;amp;EE1(a&gt;-a”)(a*-aí)	.
onde np é o número de parâmetros a serem determinados.
A Equação (4.1.3) pode ser reescrita na seguinte forma compacta:
E* = E|-o 4- (Saf.g 4 ~(6a)T H(êa) ,	(4,1.4)
onde E* é a aproximação de Newton para o valor da função objetivo E, 8a = a — é o incremento a ser feito nos parâmetros desconhecidos, o sobrescrito T indica o vetor transposto, g é o gradiente da função objetivo em relação aos parâmetros desconhecidos:
(4.1.5)
e H é a matriz Hessiana:
*
U = {Ajt} =&amp;lt;
(4.1,6)
Desenvolvendo as Equações (4.1.5) e (4,1.6), vem:
e:
(4.1.7)
é)P dP
Õak datj
d2p da^da^
, j e =	.
(4.1-8)
+
O processo de ajustagexn automatizada mida-se pela obtenção do valor mínimo da função objetivo aproximada, £"*, a qual é função somente dos desvios a -&amp;lt;?’. Para isto, deve-se derivar a função E* em relação a cada um dos 6a3 e essas derivadas devem ser posteriormente igualadas a aero:
dE*
dSa
np
+	~ ^fc)
fe=i
d2E dotjdak
(4-1-9)

Então, o seguinte sistema de equações normais deve ser resolvido para obter-se
os bay:
np
d2E da,d&amp;amp;k
dE
da.
(4.1,10)
j ~ l,...,np ,

&amp;amp;E I
onde as derivadas pectivamente.
Say [30
são definidas pelas Equações (4,1.7) e (4.1.8), res-
O sistema linear definido pelas Equações (4.1.10) pode ser reescrito de modo
mais compacto:
H 6a = -g .	(4.1.11)
Uma vez resolvido o Sistema (4,1.11) e obtidos os óctj, um novo conjunto de parâmetros desconhecidos do reservatório é determinado:
+	; = l,...,np.	(4.1.12)
Para aumentar a velocidade de convergência ou até mesmo prevenir a divergencia do processo, pode-se utilizar um algoritmo de busca linear, cujo objetivo é obter-se o tamanho ideal para o passo (p). Neste caso, a atualização dos parâmetros desconhecidos deve ser feita do seguinte modo;
aj = A p; j = l,...,np.	(4,1,13)
Um algoritmo simples de busca linear é apresentado no Apéndice A,
O método de Newton, acima descrito, apresenta algumas dificuldades, A primeira delas surge da necessidade de calcular-se as derivadas segundas que aparecem na matriz Hessiana, Equação (4.1.8). Quanto mais complexo o modelo de reservatório utilizado, tanto maior será a dificuldade de obter-se essas derivadas e o esforço computacional envolvido. A segunda dificuldade vem da incerteza de que a matriz Hessiana H seja positiva definida. Consequentemente, o ponto para o qual o processo converge, quando isso ocorre, pode não ser o ponto de mínimo da função objetivo E, mas um ponto de sela ou até mesmo um ponto de máximo. Para que o valor final de E seja um ponto de mínimo, é necessário que a matriz Hessiana seja positiva definida, o que ocorre quando se está na vizinhança do ponto de mínimo. Outra dificuldade pode ocorrer quando alguns parâmetros são dependentes entre si ou o modelo é insensível a determinados parâmetros, mesmo que só durante um determinado período. Nesse caso, a matriz Hessiana H poderá se tornar extremamente mal condicionada, dificultando a resolução do sistema de equações, ou simplesmente atrasar a convergência e até mesmo divergir.
Diversos métodos alternativos foram propostos com objetivo de solucionar as dificuldades apresentadas pelo método de Newton. De um modo geral, esses métodos se baseiam em garantir que a matriz Hessiana seja positiva definida.
4.1.1	- Método de Newton-Greenstadt
A essência do método de Newton-Greenstadt [24] é a decomposição espectral
da matriz Hessíana H:
(4.1.1.1)
onde:	são os autovalores da matriz H, em ordem crescente; são os autovetores
correspondentes; e T indica o transposto do vetor.
Neste trabalho, para a obtenção dos autovalores e seus correspondentes autovetores, recorreu-se à rotinas do EISPACK [42].
Como a matriz H é simétrica, todos os seus autovalores são reais [41] e, então, a decomposição espectral permite identificar a presença de autovalores negativos, nulos ou muíto pequenos, todos indesejáveis. A presença de um autovalor negativo indica que um dos m vetores de busca está maximizando a função objetivo E na direção do seu correspondente autovetor. Um autovalor nulo ou próximo de zero indica insensibilidade do modelo a um dos parámetros, ou a urna determinada combinação deles. Isto é fácil de acontecer em aplicações de análise de testes, onde há parâmetros cujo efeito prevalece eni tempos curtos ou longos e, muitas vezes, o teste não contém informações sobre esses períodos. Se todos autovalores são positivos, a matriz H de ve ser positiva definida.
Greenstadt [24] propôs que todos os autovalores da matriz H fossem substitui-
dos por seus valores absolutos e que os valores próximos de zero substituidos por número grande positivo. Então, a matriz Hessiana modificada será:

(4.1.1.2)
onde X*k são os autovalores modificados.
Deste modo, o sistema modificado fica:
e pode ser resolvido como:
(4.1.1.3)
(4.1.1.4)
H* fa = -g ,
onde H* 1 é a inversa da matriz Hessiana modificada, que é definida por:
Barua et al [35] propuseram uma modificação no método de Newton-Greenstadt,
onde todos os autovalores menores do que um determinado valor são substituídos por um número grande positivo.
Vale lembrar que o método de Newton-Greenstadt também considera as derivadas segundas na matriz Hessiana, mantendo as mesmas dificuldades nos seus cálculos.
4.1.2	- Método de Newton-Cholesky
Como a matriz Hessiana é uma matriz simétrica, a fatorização de Cholesky pode ser aplicada:
D Lt
(4.1.2.1)
onde D é uma matriz diagonal com todos elementos positivos, e L é uma matriz triangular inferior cujos elementos da diagonal principal são unitários. Pode-se provar [38] que, se H é positiva definida, todos os elementos de D são positivos.
A Equação (4.1.2.1) é a expressão que define a técnica de eliminação de Gauss para matrizes simétricas, que é frequentemente utilizada para resolver sistemas
de equações lineares (38]. Se a matriz H, além de simétrica, for positiva definida, fica garantida a estabilidade numérica na solução do sistema de equações.
Maiores detalhes sobre a fatorização de Cholesky podem ser encontradas no Apêndice B.
Gill e Murray [25] propuseram uma modificação na fatorização de Cholesky para aplicação, também, em matrizes simétricas positivas indefinidas. Nessa modificação, se algum elemento djj da matriz diagonal D for menor do que uma certa constante pequena e positiva&amp;lt;5, então um número positivo rjj é adicionado ao elemento hjj da matriz H para que a matriz modificada H seja positiva definida:
(4.1.2.2)
onde R é uma matriz diagonal com elementos rjj. A matriz H será tão próxima quanto possível de H e, no caso em que H já seja suficientemente positiva definida, elas serão idênticas.
Namba e Horne [36] propuseram uma modificação adicional no método de Gill e Murray [25], onde o elemento d^ da matriz diagonal D é definido por:
dA ™ maxfdjj; e max |da|} ,
onde, djj são os elementos da matriz diagonal D, calculados pelo método de Gill e Murray e £ é uma constante, que no trabalho de Namba e Horne estabeleceu-se e — 0.1.
Segundo Namba e Horne, essa modificação evita alterações muito drásticas nos
parâmetros nas iterações iniciais e com isto pode evitar a divergência que ocorreria em outros métodos. Esses autores sugerem que essa modificação só deve ser adotada nas três primeiras iterações.
4.1.3	- Método de Gauss
0 método de Gauss ou de Gauss-Newton consiste simplesmente em considerar nulas as derivadas segundas que aparecem na matriz Hessíana, Equação (4.1.8). Os elementos da matriz H ficam:
hjk = -2^^
K=1 h
dP(ã,ti) dP^tj) dak daj
a°
(4.1.3.1)
Essa simplificação faz com que a matriz Hessiana seja sempre positiva definida e, além disso, nao há necessidade de se calcular as derivadas segundas, reduzindo consideravelmente os cálculos e o esforço computacional envolvido. 0 fato da matriz H ser sempre positiva definida, garante, teoricamente, que a estimativa final dos parâmetros c? seja o ponto de mínimo da função objetivo E. Contudo, na prática isso pode não ser verdade, pois a presença de parâmetros mal definidos causa mau condicionamento da matriz H e consequentemente instabilidade numérica que poderá dificultar ou impedir a convergência para os valores corretos.
Para melhorar o desempenho do método de Gauss, algumas modificações foram
propostas.
4.1.4	- Método de Gauss-Marquardt
0 método de Gauss-Mar quardt [22], também conhecido como método de Leven-berg[23]-Marquardt, é uma modificação do método de Gauss com o objetivo de superar problemas de mau condicionamento da matriz H. Essa modificação consiste em adicionar uma constante À a cada elemento da diagonal principal da matriz H, aumentando a dimensão dos autovalores de H, garantindo que estes não sejam nulos ou quase nulos. Deste modo, evita-se que a matriz H seja singular ou quase singular.
Marquardt sugere que se inicie o processo com A ~ 0.01 e, em cada iteração em que a função objetivo E seja decrescente em relação à iteração anterior, a constante A seja reduzida para um valor A/10. Em caso contrário, quando a função objetivo E aumenta, o valor de A deverá ser substituído por 10A e determina-se o tamanho do passo p para atualizar' o vetor a, tal que:
&amp;lt;E(5fc) .	(4,1,4.1)
Após algumas iterações, o valor de A tende a se tornar tão pequeno que o método de Gauss-Marquardt se aproxima do método original de Gauss.
A modificação de Marquardt ou de Levenberg pode, também, ser aplicada ao método de Newton. Neste caso, o valor de A deverá ser escolhido de modo que todos autovalores da matriz H se tornem positivos, garantindo que a matriz Hessiana seja positiva definida.
4.1.5	- Método de Gauss-Greenstadt
A proposta de Greenstadt [24] também pode ser aplicada ao método de Gauss. Neste caso, os autovalores nulos ou próximos de zero são substituídos por um número grande e positivo e, com isso, evitam-se problemas de singularidade da matriz H.
4.1.6	- Método de Gauss-Cholesky
4.1.7 - Normalização do Sistema de Equações
Antes de se utilizar qualquer dos métodos citados anteriormente, pode-se fazer &amp;amp; normalização do sistema de equações a ser resolvido. 0 objetivo dessa técnica é de. melhorar o condicionamento da matriz H e, consequentemente, diminuir os problemas de singularidade.
Dado o sistema:
H6a = -^,
(4.1.7.1)
pode-se definir a matriz normalizada Hn e o vetor normalizado g^ como:

ri.
(4.1.7.2)
9i
Então, o sistema normalizado a ser resolvido fica:
(4.1.7.3)
(4.1.7.4)
0 sistema dado pela Equação (4.1.7.4) pode ser resolvido utilizando-se uma das variações apresentadas para o método de Newton e a solução do sistema original descrito pela Equação (4.1.7.1) é obtida por:


(4.1.7.5)
4.2	- MÉTODO BASEADO EM MÍNIMOS VALORES ABSOLUTOS
Recentemente, Rosa e Horne [39] apresentaram um algoritmo para regressão não linear que tem como objetivo estimar um conjunto de parâmetros desconhecidos que minimize o somatório dos valores absolutos das diferenças entre os dados medidos e a resposta simulada.
Se os dados de pressão estão sendo ajustados, deseja-se minimizar a função objetivo E definida por:
£(5) = Êu.K)-mMi •	(«.d
Í=íl
Diferentemente dos métodos típo Newton, que baseiam-se na expansão da função objetivo em uma série de Taylor, esse método é baseado na idéia de igualar-se os dados medidos aos simulados em cada ponto, isto é:
Pw(ti) -	¿ =	(4,2.2)
As Equações (4.2.2), conhecidas como equações de condição, formam um sistema de n equações não lineares com np incógnitas. Deseja-se encontrar uma solução que satisfaça o Sistema (4.2.2) e também minimize a função objetivo (4.2.1).
Fazendo-se a expansão da função que define o modelo selecionado, em uma série de Taylor em torno de um valor estimado P(a°,ti), obtido a partir de uma solução inicial o°, truncando-a após os termos de primeira ordem e substituindo-se nas Equações
(4.2.2), vem:
Definindo-se;
wí = pw(ti) - Pfêiti) , í = l,...,n,
~ ttj -aj , j = 1, ...,np ,
e
'dP&amp;amp;ii)'
(4.2.5)
(4.2.6)
j = l,...,np,
(4.2.7)

pode-se reescrever as Equações (4.2.4) da seguinte forma:
Wi ~ ÓúqVij + ¿«2^,2 + ... + 8anpViinp , i ~ 1,..., n .	(4.2.8)
Segundo Rosa e Horne [39], esse é um problema de regressão linear múltipla sem intersecçâo. Então, o problema original pode ser resolvido iterativamente como uma sequência de problemas de regressão linear múltipla. 0 critério a ser satisfeito na solução do Sistema (4.2.8) é a minimizaçâo do somatório dos valores absolutos das diferenças entre os novos valores observados e os valores w¿ calculados no lado direito da Equação
(4.2.8). Então, em cada iteração do processo, faz-se a mínimização da seguinte função objetivo:
De acordo com Rosa e Horne [39], o problema de otimização definido pelas Equações (4.2.8) e (4.2.9) pode ser tratado como um problema de regressão linear e a rotina DRLAV da biblioteca estatística IMSL [40] pode ser usada para sua solução.
Segundo os mesmos autores, esse método é bastante robusto e mostrou-se superior aos métodos baseados em mínimos quadrados, principalmente nos casos onde a estimativa inicial é pobre ou onde existem pontos mal comportados (roídos) no conjunto dos dados medidos.
O método proposto por Rosa e Horne [39] nao foi avaliado neste trabalho.
4.3	- OTIMIZAÇÃO RESTRITA
Na prática, alguns parâmetros têm seus valores restritos a intervalos em que possuam sentido físico, por exemplo: permeabilidade &gt; 0, coeficiente de es to cagem &gt; 0, etc. Nesses casos, podem-se aplicar restrições sobre a otimização desses parâmetros e com isso direcionar a procura dos valores ótimos. Existem basicamente duas técnicas de otimização restrita. A primeira, baseada na modificação da função objetivo, é conhecida como “métodos de transformação” e a segunda, que involve a aproximação linear das restrições seguida da aplicação de um método de projeção, é consequentemente chamada de “métodos de projeção”. Os métodos de transformação incluem os métodos das funções penalidades, das barreiras eo do Lagrangeano aumentado, enquanto os métodos de projeção incluem o método de projeção direta e do Lagrangeano projetado. Neste trabalho somente será considerado o método das funções penalidades.
0 método das funções penalidades é aplicado somente quando alguma restrição é violada durante o processo de otimização. A modificação na função objetivo será tanto
mais acentuada quanto maior for a violação.
Podemos, em geral, escrever as restrições como:
&gt; 0
(4.3.1)
e as seguintes funções penalidades podem ser atribuídas;
onde é uma constante pequena e positiva.
Então, modifica-se a função objetivo, adicionando-se a ela as funções penalidades para todas as restrições:
(4.3.3)
Se a+ e são os vetores para os quais E+ e E atinjam seus mínimos respectivamente, prova-se que, sob condições favoráveis,
t *	* I
hm õF = a
Maiores detalhes sobre o método das funções penalidades podem ser encontrados no trabalho de Rosa e fíorne [34].
4.4	- ANÁLISE ESTATÍSTICA DA REGRESSÃO
valores otimizados dos parâmetros, é possível definir intervalos de confiança para cada um deles.
Rosa e Ilorne [34] e [39] mostraram um método aproximado para determinação de intervalos de confiança que, apesar de não ser um método rigoroso, é suficiente para a avaliação da qualidade dos ajustes.
Definindo-se o desvio médio quadrático como:
EAfS = -±±±_ ,	(4.4.1)
n ~~ np
onde SSR é o somatório dos quadrados dos resíduos na última iteração, n é o número de dados medidos e np é número de parâmetros otimizados, o intervalo de confiança para cada parâmetro é determinado por:
a*- — Ao' &amp;lt;ctj &amp;lt;a' 4- Ao* ,	(4.4.2)
onde üj é o valor estimado na última iteração para o parâmetro aj e:
Ao] = yjEMS hjj	•	(4.4.3)
Na equação anterior, é o elemento da diagonal principal da matriz Hessiana H, correspondente ao parâmetro aj, e tyfan-n? é ° valor da distribuição t de Student (tabelado) para nível de significancia 7 e grau de liberdade n ~ np. Um nível de significancia 7 implica em um intervalo de confiança 100(1 — 7)% . Um intervalo de confiança de 95% significa que existe 95% de probabilidade de que o valor real do parâmetro estimado esteja no intervalo definido pela Equação (4.4.2).
CAPITULO V
DISCUSSÕES
Foram construídos programas de computador para obter-se as soluções para os casos de reservatórios com múltiplas camadas sem fluxo cruzado e com fluxo cruzado, incluindo-se efeitos de estocagem e de película. Diversos outros programas complementares foram construídos para permitir comparações com outros modelos e verificar técnicas de interpretação de testes em reservatórios com múltiplas camadas. Entre esses programas, podem-se citar os seguintes: Solução para reservatórios homogêneos; Solução para reservatórios com dupla porosidade; Otimização de parâmetros em reservatórios homogêneos, de dupla porosidade, com múltiplas camadas com e sem fluxo cruzado, pelos métodos de Gauss, Gauss-Marquardt, Gauss-Greenstadt e Gauss-Cholesky.
Todos os programas foram escritos na linguagem FORTRAN e utilizados em micro-computadores PC-XT ou PC-AT, ambos com placa MOTOROLA 68020 - 20 MHz.
Inicialmente, serão apresentadas discussões sobre aplicações de métodos de regressão não linear em análise de testes para, posteriormente, discutir-se o comportamento de pressões e vazões em reservatórios com variação vertical de permeabilidade, assim como a interpretação de testes nesses reservatórios.
5.1	- ANÁLISE AUTOMATIZADA DE TESTES DE PRESSÃO
caso real de um período de estática com comportamento típico de reservatório homogêneo infinito e o segundo é um teste simulado em um reservatório com dupla, porosidade.
Nos exemplos apresentados, não foi utilizado o método das funções penalidades.
I
As soluções no campo de Laplace, para os modelos teóricos de reservatório homogêneo e de dupla porosidade, são apresentadas nos Apêndices C e D, respectivamente. Para a obtenção das pressões teóricas e dos seus gradientes em relação aos parâmetros otimizados, foi utilizado o algoritmo de Stehfest [45] para inverter as soluções apresentadas nos Apêndices CeD, Para o caso de reservatório de dupla porosidade, os gradientes foram calculados pelo método de diferenças finitas, utilizando-se um esquema de diferenças avançadas.
Nos casos onde o fator de película apresenta-se negativo, utilizou-se o conceito de raio efetivo do poço, definido por:
tó ~ rw £~s .	(5.1,1)
Reservatório Homogêneo
Os dados reais de pressão estática considerados nesse exemplo são apresentados na Tabela 5.1,1. Por se tratar de um período de estática, optou-se por utilizar o tempo equivalente de Agarwal, Ate ~ (tp.At)/tp -f- At). A Figura 5.1 mostra um gráfico log-log, da variação da pressão e da derivada logarítmica versus o tempo equivalente de Agarwal, para os dados da Tabela 5.1.1. A análise qualitativa sugere que o modelo de reservatório homogêneo infinito seja aplicável. Na Tabela 5.1.2 são apresentados, em unidades de campo, os dados adicionais relativos a esse exemplo.
Os parâmetros a serem determinados nesse caso são permeabilidade (k), fator
Ate				&lt;1	Apw,
(hora)	(psi)	(hora)	(psi)	(hora)	(psi)
.02	81.90	.61	588.64	6.92	727.56
.04	114.59	.74	605.52	7.53	729.97
.05	152.67	.83	615.44	8.40	734,49
.07	194.51	1.11	634.92	10.37	744,64
.09	245.45	1.26	643.16	11.87	750.99
,11	296.96	1.58	656.18	13.12	755,17
.18	396.59	1.97	668,28	14.55	758.99
.31	504.39	2.57	682.28	15.86	762.77
.38	533,38	3.60	698.87		
.48	563.09	5.65	718.47		
Tabela 5.1.1: Reservatório Homogêneo - Dados de pressão e tempo equivalente
h = 82 ft	= 1.41 cp
¿ = 0.18	Bo = 1.255
Ct — 11.9 x 10~6 psi-1	Qo = 1780 bbl/d
rw = 0.354 ft	
Tabela 5,1.2: Reservatório Homogêneo - Dados complementares
10 *
DADOS REAIS - ESTATICA
TEMPO DE AGARWAL - L s 0.0
W Cl
O
Tí
O
&gt;
O
O
10
o
DELTA P oosoo DEHVADA
10 1
«
o
9
o
Figura 5.1: Gráfico log-log dos dados da Tabela 5.1.1
de película (S) e coeficiente de estocagem (C).
Os desempenhos dos diversos métodos nesse problema de otimização, considerando-se diferentes valores iniciais, podem ser observados na Tabela 5.1.3. Todos os métodos, para as quatro combinações de valores iniciais, convergiram para os mesmos valores ótimos, quais sejam: C = 0.024 bbl/psi, k ~ 67 mD e S = 2.2. A Figura 5.2 apresenta o ajuste com o modelo obtido com esses valores ótimos.
Devido ao fato dos autovalores da matriz H não atingirem um valor mínimo
pré-estabelecido e, consequentemente, a matriz H permanecer inalterada, o desempenho do método de Greenstadt-Barua foi idêntico ao do método de Gauss. Exceto no Caso 4, onde o método de Gauss-Marquardt teve melhor desempenho, o método de Gauss mostrou-se superior aos outros.
Para acompanhar o comportamento de cada método durante o processo iterativo, escolheu-se o Caso 3 para uma observação mais detalhada. A Figura 5.3 mostra a
Caso	C (bbl/psi)	k (mD)	s	N° ITER.			
				G	GM	GB	GMN
1	0.02	60.	1.8	4	5	4	7
2	0.2	1000.	1.0	7	9	7	9
3	1.0	600.	- L0	7	8	7	9
4	0.2	100.	- 2.0	10	7	10	10
G Método de GAUSS GM =; Método de GAUSS-MARQUARDT GB = Método de GAUSS-GREENSTADT-BARUA GMN Método de G A USS-GILL- MURRAY- NAM BA							
Tabela 5.1.3: Reservatório Homogêneo - Comparação de Desempenho
10&gt;
Cl
ESTATICA - TEMPO DE AGARWAL - L = 0.0
OTIMiZACAO POR CAUSS-MAROUARDT - NUM. fTER. = 5
VAL. INICIAIS:	C = 0.020 bbl/psi. k = 60. mD, S ® 1.8
VAL. OTIMIZADOS: C = 0.024 bbl/psi, k = 67. mO, 5 = 2.2
35 10 G Cl '■
o
&lt;D D
10 -t
10
' 10 1 10
(Tp * Dt) / (Tp + Dt) (hora)
Figura 5.2: Ajuste com o modelo ótimo
redução da função objetivo em cada iteração.
Figura 5.3: Evolução da função objetivo
Nas Figuras 5.4, 5.5 e 5.6 são apresentados, respectivamente, os comportamentos da permeabilidade, do fator de película e do coeficiente de estocagem versus a função objetivo. Observa-se que nas três ou quatro primeiras iterações os parâmetros já atingem valores próximos dos valores ótimos. Nota-se, também, que nas iterações iniciais a função objetivo não é sensível ao fator de película, podendo causar mau condicionamento na matriz Hessiana.
Figura 5.4: Estimativas da permeabilidade x função objetivo
Figura 5.6: Estimativas do coeficiente de estocagem x função objetivo
Reservatório com Dupla Porosidade
Nesse exemplo são utilizados dados de um teste simulado em um reservatório com dupla porosidade. Os dados usados para gerar esse exemplo encontram-se na Tabela 5,1.4.
A Figura 5.7 mostra um gráfico log-log da variação de pressão e da derivada logarítmica da pressão versus o tempo de teste.
Os parâmetros selecionados para serem determinados são o coeficiente de estocagem (C)s o fator de película (S), a permeabilidade do sistema de fissuras (kj), o parâmetro de fluxo interporoso (A) e a razão de armazenamento (w).
h = 80 ft ¿ = 0.18 — 10 x IO'6 psi~* rw = 0.40 ft kj 2200 mD w = 0.07	po = 2.0 cp Bo = 1.24 Qo 1000 bbl/d CD = 51. S ~ 1.1 À = 4x 10~6
Tabela 5.1,4; Reservatório Dupla Porosidade - Dados básicos
10 *
Deita P e Derivada — (psi)
10-’
DADOS SIMULADOS - RESERVATÓRIO INFINITO COM DUPLA POROSIDADE CD - 51., S - 1.1, LAMBDA - 4.e-S, OMEGA « 0.07, kf « 2200. mO
«,*»**
&gt;»
*
O
0
a
%
\
o o o
***** DELTA P ooooo DERIVADA
D 0 O O
Ü n. $
OqO
i--r""r"T i i rrj--i.t—fr rrrrr
10 ■* w .
Tempo (hora)
-z
10
10 ~
1

Figura 5.7: Gráfico log-log para o teste simulado em dupla porosidade
foi obtida., os valores ótimos foram: C® ~ 51., S = 1.1, A ~ 4. x 10~6, w = 0.07 e kf ~ 2200. mD, os quais coincidem com os valores usados para gerar o exemplo. A Figura 5.8 mostra o ajuste obtido com esses valores. Também para esse caso, o desempenho do método de Gauss-Greenstadt-Barua foi idêntico ao do método de Gauss. O método de Gauss-Marquardt mostrou-se mais robusto, convergindo em todos os casos, e com bom desempenho geral.
Caso	CD	s	A	w	(mD)	N° ITER.			
						G	GM	GB	GMN
1	10.	5.	4. x IO"5	0.05	1000.	6	7	6	10
2	10.	5.	4. x 10"5	0.05	200.	9	10	9	11
3	1.	10.	4. x 10"7	0.03	200.	14	11	14	13
4	100.	-1.	5. x 10"8	0.03	1000.	7	9	7	9
5	1.	-1.	4. x 10"s	0.7	200.	*	10	*	14
6	100.	-2.	4. x 10"4	0.0Q7	200.	12	14	12	15
G = Método de GAUSS GM = Método de GAUSS-MARQUARDT GB = Método de GAUSS-GREENSTADT-BARUA GMN = Método de GAUSS-GILL-MURRAY-NAMBA * = Não convergiu									
Tabela 5.1.5: Reservatório Dupla Porosidade - Comparação de Desempenho
O Caso 3 foi selecionado para se fazer uma observação mais detalhada e acompanhar o comportamento de cada método. A evolução da função objetivo em cada iteração é mostrada na Figura 5.9. Nota-se que nas iterações iniciais, todos os métodos apresentam comportamento similar, mas, a partir da quarta iteração o método de Gauss-Marquardt, torna-se superior.
As Figuras 5.10 a 5.14 apresentam a variação da estimativas dos cinco parâme-
Delta P e Derivada
Figura 5.8: Ajuste com o modelo ótimo
Figura 5.9: Evolução da função objetivo
tros com a função objetivo. Observa-se que, apesar do desempenho satisfatório, o método de Ganss apresenta uma tendência à instabilidade.
Figura 5.10: Estimativas da permeabilidade das fissuras x função objetivo
Os dados de um teste real não são sempre bem comportados como esses dados simulados. Para se verificar a influência da presença de pontos mal comportados, foram introduzidas perturbações aleatórias nos dados simulados e procedeu-se a otimização com o método de Gauss-Marquardt. Os resultados e o ajuste obtido podem ser observados na Figura 5.15. Apesar da convergência ter sido alcançada em 11 iterações e do bom ajuste do modelo aos dados, os valores ótimos estimados diferem um pouco dos valores reais usados na simulação inicial dos dados.
Figura 5,11: Estimativas do fator de película x função objetivo
0.00005 5
0.000014
RESERVATÓRIO DUPLA POROSIDADE - CASO 3
0.000013
0.000012
0.000011
O.ODDOiO
0.000009
0.00 0008
*
0.000007
0.000006
0.000005
0.000004
“ VALOR HAÍAL -«a—■
0.000003
0.000002 -
0.030001
0.000000
•»1n	i r mwj ■■ v T
$****GAIJSS a&amp;amp;Mtó tóAHQUAROT GãXeCHOLESKY
rJfewf-A1 w^rriftqr^ ui
í0-*10"’W4W~’WJ!W’ 1 -10 10’ 10 4 10* 10 • FUNCAO OBJETIVO (otm2)
1 \ \ vJfc1 ¿r -A MIOAi-ji
io ~”*io	"*10 *’io "*io "”10 -*to ~’1O ’’10 ’’
Figura 5.13: Estimativas de lambda x função objetivo
no
1O~,SIO ■*1O~'1D ”10^0 -10 -*10-^10 ~*10	1 lO.IO’lO’IO’IO’lO'
FUNCAO OBJETIVO (otm2)
Figura 5.14: Estimativas de omega x função objetivo
100T
SISTEMA OE DUPLA POROSIDADE - DADOS SIMULADOS COM PERTUR&amp;amp;ACOES
EST. INICIAL: CD • 1., S • 10., LAMBDA - 4.x ICT,
OMEGA = 0.03, k, = 200, rr&gt;0
: CD = 50., S - 1.02, LAMBDA = 4.11 x ICT*,
OMEGA « 0.066, k, = 2170. mD, N. HER. = It
VAL. OH MOS
Cl
Delta P e Derivada
T~TT
T-T-rtTq-1—r-TTT-rrr¡--1—c i i i ;; 11
0.01 1 Tempo
rrrr
10
Figura 5.15: Ajuste em dados simulados com perturbações
5.2	- RESERVATÓRIOS COM VARIAÇÃO VERTICAL DE PERMEABILL
DADE
Nesta seção, será discutido o comportamento de poços produzindo em reservatórios com múltiplas camadas. Todas as curvas de pressão e vazão foram geradas usando-se o algoritmo de Stehfest [45] para inverter as soluções apresentadas nas Seções
3.1	e 3.2. Imcialmente, será discutido o comportamento para reservatórios sem fluxo cruzado e, posteriormente, será estendido para o caso de reservatório com fluxo cruzado.
Reservatórios Sem Fluxo Cruzado
Para tornar os termos utilizados mais familiares e facilitar o entendimento, será apresentado um exemplo detalhado. Seja um reservatório formado por três camadas
isoladas entre si, cujos dados básicos encontram-se na Tabela 5.2.1.
Camada	h (m)	k (uiD)		S	raio ext. (na)
1	2.0	1000	0.25	2	200
2	1.0	100	0.15	0	200
3	1.5	500	0.20	1	200
Tabela 5.2.1: Dados básicos - Reservatório com 3 camadas sem fluxo cruzado
Então, os seguintes parâmetros característicos são calculados:

=
kih,
ki hi + fejh.2 k3h$
= 0.702
&amp;amp;2^2
kjhi + ^2^2 + k3h3
= 0.035
_______&amp;amp;3&amp;amp;3_______
bi hi -j- k%h 2 + k3h3
= 0.263
U?! —		= 0.526
	+&amp;lt;$2&amp;amp;2 + $3^3	
=	^2&amp;amp;2	= 0.158
	&lt;£1^1 4" ^&gt;2^2 +&amp;lt;A&gt;3^3	
U?3 =	^3&amp;amp;3	- 0.316
	^1^1 4" $2^2 4-	
Note que:	Kl + Kj 4" ^'-3 “ 1	
e	U?i + U?2 4- ÍO3 — 1	
Considerando-se rw =	■ 0.1 m, vem:	
rej?j	200 ~ r^2 - Te^ ” 0.1	= 2000
Os parâmetros k e w de cada camada, juntamente com o fator de película (S), o ralo adimensional (re£l) e o coeficiente adimensional de estocagem (Cq) são os dados necessários para a simulação do comportamento de um reservatório com múltiplas camadas sem fluxo cruzado.
Para simular o comportamento desse reservatório, supõe-se que não exista fluxo na fronteira externa (selado), e que não há estocagem de fluido no poço (C# — 0).
Figura 5.16: Gráfico log-log para reservatório com 3 camadas
1.0
0.8
O
^0.6
C
Q 0.4 o
0.2
Reservatono limitado selada e com ires camadas sem fluxo cruzado. CD = 0., ReD = 2000,,
Koppal = 0.702, Kappa2 «= 0.035, KappaÓ » 0,263, Omegal = 0.526, 0meaa2 = 0.158, 0meaa3 ® 0.316, S1 = 2„ S2 = 0.. $3 = 1.
*-**■*-* Cornado 1 ts-e-ee-a Camodo 2 **-»-*-* Camada 3
A—-*.

---a--b——a--
-o-------»
0.0
'V"1 i MHj--f—T-rTTHTJ--1 I I !tHT|-1 I I HH»?--1 i FTTHT]-f '"1 I 1TTtrj-! TmTH
101 103 10 &amp;lt;10* 10* 10r 10* TD
Os efeitos de fronteira externa e de estocagem podem ser observados nas Figuras 5.18 (pressão no poço) e 5.19 (vazão de cada camada). O efeito de estocagem causa um atraso no início da resposta do reservatório, quando as vazões, inicialmente nulas, vão crescendo até atingir seus valores “normais” com o cessar do efeito de estocagem. A condição de fronteira externa do reservatório afeta o comportamento de longo tempo de pressões e vazões.
Figura 5.18: Efeitos de fronteira e estocagem na pressão
PwD	QDj - Qj/Qt
Figura 5.19: Efeitos de fronteira e estocagem na vazão
25-n--------------------------------------------
: Reservatório limitado selado e com duas - camadas sem fluxo cruzado.
*	A-idrA-éréx $1 5=0?	S2—0
C-------í---e—r-T-rrrq---t-1—1~ttttt|-----1--r—r	rri ri|	1 *—i—i-TTrrq-----1--r—r-rt"r&gt;r|
10*	103	10*	1OS	10*	10’
TD
Aparentemente todas as curvas apresentam linhas retas no trecho transitório, mas a Figura 5.21 mostra que isso não é verdade. Nos casos onde os fatores de película de cada camada são diferentes, a linha reta não ocorre. A explicação para a existência da linha reta no gráfico pwa versus hgtD está na Figura 5.22, ou seja: nos casos onde os fatores de película são iguais, as vazões de cada camada são aproximadamente constantes, e nos casos onde os fatores de película são diferentes, a vazão de cada camada é variável, não permitindo a caracterização da linha reta semi-log.
Larsen [8] mostrou que, para o caso de reservatório com duas camadas sem fluxo cruzado, a aproximação de curto tempo (regime transitório puro) para a pressão no poço é:
1.023£s
"(Intn +1-247) — Ina,
(5.2.1)
1.1 q-
VAZAO DA CAMADA 1 (q 1)
1.0
0.9
Reservatório limitado selado e com duas camadas ssm fluxo cruzado.
Kappa! = 0.95, Qmegal = 0.B3, CD = 0, , ReD = 2000.
0.7 -
0.6 ~—
10 2
Figura 5.22; Influência de diferentes fatores de película na vazão
onde:
3
7 = 1.2
(5.2.2)
(5.2.3)
(5.2.4)
(5.2.5)
Derivando.se a Equação ( 5.2.1) em relação a k.gí;j, vem:
dpu.-D(tp) __	/, \ -i ir;-] íi________________1.023^2	_________
Jlogip 1 '	* I [1.151(logip + 0.5416) ~ InaJ2
(5.2.6)
Observando-se a Equação ( 5.2.6), verifica-se que a inclinação m da linha reta semi-log é dependente do tempo íp e, como £2 é sempre &amp;lt;0, tem-se que m &gt; 1.151. Note na Equação (5.2.4) que, quanto maior a diferença (Si - S2), maior será o valor de E2 e, portanto, maior a influência da discrepância dos fatores de película na inclinação da linha reta semi-log. A mesma análise acontece em ln a*.
Algumas aproximações podem ser feitas na solução da vazão. Para o caso de reservatório com duas camadas e com fatores de película nulos, pode-se provar que:
- se o reservatório é infinito, isto é, para curto tempo,
= «1 e	~ «2 •
- se o reservatório é selado, para tp &gt; tppSÍ,
= wi e ç22&gt;(to) ~ u?2 .
Esse comportamento pode ser observado na Figura 5,24.
A. seguir, será discutido o comportamento de pressões e vazões durante o período de estática. Observa-se que as conclusões são bastante semelhantes às obtidas para o período de fluxo.
As Figuras 5.23 e 5.24 mostram o comportamento de pressões e vazões no período de fluxo que antecedeu a estática, objeto das próximas discussões.
Qj/Qt	PwD e TD.PwD
Figura 5,23: Comportamento da pressão em reservatório com duas camadas
1.5
1,0
Ji
O
O 0.5
0,0
104 10 ’ 10 * 107 10’ 10* 10 w 10 ” TD
Figura 5.24: Comportamento das vazões em reservatório com duas camadas
da camada mais permeável, e a queda final mostra que a pressão média do reservatório foi atingida. Pode-se notar que o tempo de fechamento necessário para que o reservatório atinja a pressão média é igual ao tempo para o reservatório alcançar totalmente o regime pseudo-permanente (iPi&gt;ÍS) durante o fluxo, ou seja, iPí&gt;33 « 2 X 108.
w *
-	Reservatório limitado selado e com duos camadas
-	sem fluxo cruzado. ESTATICA - TpD = 5.0E7.
' Kappal = 0,95, Omeaal = 0.83, S - 0.
-	CD « 0. , ReD = 2000.
O co
Z CL Ó í—
O
Q
w
£ CL
10 -
---- pws0 ----TD.PwsO'
*5.
10
10
z z z z
x
\
\
\
\
1
x
X
x
X
z
X
Figura 5.25: Comportamento típico de pressões na estática
A Figura 5.26 mostra o comportamento da pressão no poço (pW3£)), apresentada contra o logaritmo da função de Horner, [(tp +At)/At], para diversos tempos de produção (ipjj). Observa-se que, nesses casos onde o efeito de película é nulo, o aparecimento da linha reta semi-Iog correta independe do tempo de produção tPD. Nota-se, ainda, para a curva mais inferior, onde o fechamento ocorreu em pleno regime transitório (íPJ? ~ 5.0x105), que o comportamento é semelhante ao caso de reservatório homogêneo com uma só camada.
Devido a este fato, quando o poço é fechado, ocorre fluxo de uma camada para a outra através do poço. No início, para curtíssimo tempo, a camada mais permeável apresenta unia rápida elevação de pressão, injetando fluido na camada menos permeável. Porém, devido ao fato da camada mais permeável apresentar-se mais depletada, rapidamente a direção de fluxo se inverte e a camada menos permeável passa a produzir e injetar na camada mais permeável. Tal fluxo no poço cessará totalmente quando o reservatório atingir a pressão média p, ou seja, para At# =	A Figura 5.27 ilustra o fenômeno
acima descrito. Observa-se que, para um pequeno tempo de produção, correspondente ao regíme transitório puro, a circulação durante a estática tende rapidamente a zero. Quando o tempo de produção (tPD) aumenta e o fechamento do poço ocorre durante o regime transitório tardio, a vazão da estática também aumenta, até atingir um valor máximo, o qual será obtido para tempos de produção maiores do que o necessário para atingir o regime pseudo-permanente.
0.25 7
0.15
Reservatório limitada selado e com duas camadas sem fluxo cruzado. ESTATICA.
Kappa! = 0.95, Omeqal *= 0.83, S - 0.
CD = 0. , ReD - 2000.
—
QsjD - Qsj/Qft
0.05
-0,05
-0.16
A—• ---—¿i
g"---8	.
....Ã'""» &amp;amp;—■ ^¿r
TpD = 5.0e7
^ . . TgP « §.Qg5
Camodo 1
Camodo 2
-0.25
10 ’
Figura 5.27: Influência do tempo de produção na vazão durante a estática
Para o período de estática, também podem ser feitas aproximações na solução da vazão. Para o caso de reservatório com duas camadas e com fatores de película nulos, pode-se provar que:
- para. Ato&amp;lt;&lt;
~ Wí - «! e ç2íD(Aiu) = u&gt;2 - k2 ,
desde que o regime pseudo-permanente tenha sido alcançado durante o período de fluxo, isto e, tpjj 5* tp^s-s*
- para ¿\íd
Esse comportamento também pode ser observado na Figura 5.27.
A influência do efeito de película durante a estática é semelhante ao caso do fluxo. A Figura 5.28 mostra o gráfico de Horner para um reservatório corn duas camadas com várias combinações de fatores de película. Como no fluxo, linhas retas são aparentes em todos os casos, apesar de observar-se que as inclinações não são iguais. Na Figura S.29 nota-se que a linha reta só se desenvolve para os casos onde os fatores de película das duas camadas sao iguais. A variação na vazão durante a estática, mostrada na Figura 5.30, explica a não ocorrência da linha reta nos outros casos.
Reservatórios Com Fluxo Cruzado
E
2.0
1,8“
1.6 -
1.4 z
1-2 z
□jn = JL
1.0 -•
1
■ 0.95, Omegal , Re D = 2000.
S2=0
S2=0
S2=5
S2~D
Reservatório limitado selado e com duas camadas sem fluxo cruzado, ESTATiCA TpD = 1.0E6 Kappal = 0.95, Omeqal = 0.83, CD = 0.	~ ~
T y ;	( | -V.rt ? J   1 T..T l t tT
10* 103 10' (Tp + Dt) / Dt
Figura 5.29: Influência do efeito de película na inclinação ni
VAZAO DA CAMADA 1 (q$D1)
0.15 q-----------------------------------■—- -............—
' Reservatoría (imitado selado e com duos camadas - sem fluxo cruzado. ESTATICA TpD = 1.0E6
—0.05 “I--1 i 1-rrrn----r !—i ) i~rr i!-1—t—ri i t1 n----; 1—rm—rrrri—
10	IO1 '	,	103	10 +
(Tp 4* Dt) / Dt
As discussões são baseadas em reservatórios com duas camadas. Os parâmetros usados para gerar as curvas apresentadas estão indicados nas respectivas figuras,
A Figura 5,31 mostra, em um gráfico semi-log (pWo versus logtoY uma comparação entre o comportamento dos modelos de reservatório com duas camadas com fluxo cruzado, de reservatório com duas camadas sem fluxo cruzado e de um reservatório homogêneo com uma só camada equivalente (h, S, &amp;amp;), considerando-se duas combinações de fator de película. Observa-se que o comportamento da pressão no reservatório com fluxo cruzado segue três estágios distintos, ou seja: inicialmente, para curto tempo, o comportamento é idêntico ao do reservatório sem fluxo cruzado; após isso, inicia-se um período de transição, no qual o comportamento da pressão se afasta do caso de reservatório sem fluxo cruzado e se aproxima do comportamento de um reservatório homogêneo equivalente; finalmente, para longo tempo, o comportamento da pressão é similar ao de um reservatório homogêneo equivalente.
Figura 5,31: Comparação do comportamento de pressões
A comparação do comportamento das vazões relativas da camada com maior capacidade de produção é apresentada na Figura 5.33. Pode-se notar duas características interessantes. A primeira delas é que, ao contrário do que ocorre no caso sem fluxo cruzado, as vazões das camadas tornam-se constantes para tempos grandes. A segunda é que a produção da camada mais permeável do reservatório com fluxo cruzado é maior do que a produção da camada mais permeável do reservatório sem fluxo cruzado, no caso em que essa camada possui o menor fator de película, ocorrendo o contrário no caso em que a camada mais permeável possui o maior fator de película. Esse comportamento sugere que o efeito de película interfere decisivamente na direção e na magnitude do fluxo cruzado.
0 efeito do contraste entre as permeabilidades horizontais é mostrado na Fi-
TD
Figura 5.33: Comparação do comportamento das vazões
gura 5.34. Aparentemente, o aumento da relação Áq/fcj faz deslocar para a direita a concavidade na curva das derivadas, mas isto ocorre devido à definição de tD em função de kh, ou seja:
2tí kht
(5.2.7)
Observa-se, também, que a intensidade da concavidade na curva das derivadas aumenta com a relação ^/¿3.
Como foi comentado anteriormente, o comportamento de um sistema com múltiplas camadas com fluxo cruzado apresenta três estágios. Inicialmente, o comportamento é idêntico ao caso sem fluxo cruzado e, para longo tempo, torna-se similar ao de um reservatório homogêneo equivalente. Entre os dois extremos ocorre um período de transição. As permeabilidades verticais controlam os tempos de início e de fim dessa
1,0
Reservatório infinito e com duas cornadas com fluxo cruzado, Omegal « 0.5, S «= 0., CD « 0.
Figura 5.34: Influência da relação ky/k^ nas derivadas
transição. As Figuras 5.35 e 5.36 mostram o efeito da relação entre a permeabilidade vertical e a permeabilidade horizontal de cada camada, no comportamento da derivada da pressão e no comportamento da vazão relativa da camada mais permeável, respectivamente.
Observa-se, nessas duas figuras que, quanto menor as permeabilidades verticais, mais tarde ocorre a transição e, consequentemente, tanto mais tarde aparecerá a linha reta semi-Iog e a estabilização da vazão de cada camada.
A interpretação de testes convencionais em reservatórios com múltiplas camadas poderá fornecer, em alguns casos, os parâmetros médios do reservatório testado, tais como: kh e 5.
TD
Figura 5.35: Influência da relação nas derivadas
pode ser uma boa. alternativa.
Dois exemplos sintéticos, um para reservatório sem fluxo cruzado e outro para reservatório com fluxo cruzado, ambos com duas camadas, são apresentados para verificarse a utilização dos métodos de regressão não linear para interpretação de testes em reservatórios com duas camadas. 0 objetivo foi minimizar os quadrados das diferenças entre as pressões medidas e as pressões simuladas.
Os dados utilizados para gerar o exemplo do teste em reservatório com duas camadas sem fluxo cruzado são apresentados na Tabela 5.2.2.
hi = 2 m ki = 2000 mD &amp;amp; = 0.25 = 2	¿2 = 5 m k2 ” 500 mD h = 0.15 S2=l
q¡f = 300 rn3/d Bo = 1.25 Po = 1.5 cp c¡ = 200 x 10~6 (kgf/cm2')~l rw = 0.10; m C = 0	
Tabela 5.2.2: Dados para Gerar Exemplo de Reservatório com Duas Camadas Sem Fluxo
Cruzado
Foram testados os métodos de Gauss-Marquardt, de Gauss-Greenstadt-B ar uae de Gauss-Gill-Murray-Namba, para a otimização de quatro parâmetros (Âq, Sj, , fc2} 52). Devido ao mau condicionamento da matriz Hessiana, somente o método de Gauss— Greenstadt-B aru a atingiu a convergência do processo.
Os dois conjuntos de estimativas iniciais para os parâmetros, assim como os resultados otimizados obtidos, encontram-se na Tabela 5.2.3.
VALORES INICIAIS				VALORES FINAIS				NÚMERO DE ITERAÇÕES
ki mD	kt mD	S’i	$2	ki mD	ki mD	Si	Si	
1000	200	1	0,5	2014	494	2	1	6
200	2000	1	0.5	125	1247	0.54	1.47	24
Tabela 5.2.3: Reservatório Sem Fluxo Cruzado - Critério dos Mínimos Quadrados nos Dados de Pressão
Observa-se que, para o primeiro conjunto de valores iniciais que são relativamente próximos dos valores corretos, os resultados foram bons. Para o segundo conjunto de valores iniciais, os resultados foram totalmente discrepantes.
A averiguação da adequação do modelo otimizado aos dados do teste foi feita pela verificação dos ajustes com os dados de pressão no poço e com os dados da vazão da camada inferior. As Figuras 5.37 e 5.38 mostram os ajustes de pressões e vazões, respectivamente, com o modelo otimizado obtido a partir do primeiro conjunto de valores iniciais. Verifica-se um pequeno erro no ajuste das vazões.
Os ajustes para pressões e vazões, conseguidos com o modelo obtido a partir do segundo conjunto de valores iniciais, são apresentados nas Figuras 5.39 e 5.40, respectivamente.
Apesar do excelente ajuste de pressões, as vazões calculadas para a camada 2 são totalmente discrepantes, mostrando que os parâmetros calculados não estão adequados para representar os dados reais.
A má definição dos parâmetros a serem otimizados nesses casos traz como conseqüência a matriz Hessiana altamente mal condicionada, o que explica o fato de somente o método de Gauss-Greenstadt-Barua ter funcionado a contento.
A regressão não linear, efetuada sem compromisso com os dados de vazão,
100
RESERVATÓRIO COM, DUAS CAMADAS SEM FLUXO CRUZADO. CRITÉRIO DOS MÍNIMOS QUADRADOS NA PRESSÃO. MCTODO DE GAUSS-GREENSTADT-BARUA.
TEMPO (h)
***** PRESSÃO ocwo derivada
modelo ajustado
Figura 5.37: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Primeiro
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado
140
GAUS5-GREENSTADT-BARUA.
135-
&amp;amp;
i
TEMPO (h)
RESERVATÓRIO COM DUAS CAMADAS SEM FLUXO CRUZADO CRÍTERiO DOS MÍNIMOS QUADRADOS NA PRESSÃO. MÉTODO DE ------ -------------
Figura 5.38: Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Primeiro
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado
Figura 5.39: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Segundo
Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado
350 "i---——-———........................
RESERVATÓRIO COM OCAS CAMADAS SEM FLUXO CRUZADO. CRITÉRIO DOS MÍNIMOS QUADRADOS NA PRESSÃO.
MÉTODO DE GAUSS-GREENSTADT-BARUA.
300
200-
zvàAZxí MEDIDA —CALCULADA
100 "j  i 'i hi"iT|-1—i—r"»"í T"j Tf —rrTTrrq"	J i—rrrnii t—?—rr; ttt
10’’	W _i	10	1	10	102
TEMPO (h)
Figura 5.40: Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Segundo Conjunto de Valores Iniciais - Reservatório Sem Fluxo Cruzado
forneceu resultados que atendem à função objetivo considerada nesses casos. A não consideração dos dados de vazão causa um problema de não unicidade de solução.
Para gerar o exemplo do teste em reservatório com duas camadas com buxo cruzado, utilizou-se os dados apresentados na Tabela 5.2,4.
Inicialmente, foi tentada a otimização de seis parâmetros (&amp;amp;n, kr2i k^, kZ2, Fi, Sj), mas os três métodos citados anteriormente falharam, mesmo com valores iniciais muito próximos dos reais. 0 mau condicionamento da matriz Hessíana causado pela má definição dos parâmetros considerados explica a falha anterior. Partiu-se, então, para a otimização de quatro parâmetros, quais sejam: kT1, kr2¿ 5i, S^. Mais uma vez, somente o método de Gauss-Greenstadt-Barua funcionou.
hi = I m ~ 2000 mD kgi = 100 mD &amp;amp; = 0.20 Si - 3	h2 = 5 m kr2 — 200 mD = 10 mD h 0.15 S2 = 1
qo ~ 320 m3/d Bo = 1.25 po — 1.30 cp ct ~ 180 x 10~6 (kgf /em2)-1 rw = 0.10; m C = 0	
Tabela 5.2.4: Dados para Gerar Exemplo de Reservatório com Duas Camadas Com Fluxo
Cruzado
VALORES INICIAIS				VALORES FINAIS				NÚMERO DE ITERAÇÕES
kri mD	k "Tz mD	Si	s2	&amp;amp;rx mD	k?2 mD	£	s?	
500	50	3	2	2000	200	3	1	7
500	300	3	2	1061	389	2.8	1.9	12
300	300	0	0	968	408	2.9	2	16
9-5
Somente para o primeiro conjunto de valores iniciais houve a convergência para os valores reais. Nos outros dois casos, os resultados foram discrepantes. As Figuras 5,41 e 5.42 mostram o ajuste de pressões e vazões, respectivamente, com o modelo otimizado obtido a partir do primeiro conjunto de valores iniciáis.
Figura 5.41: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Primeiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado
Os ajustes para pressões e vazões conseguidos com o modelo obtido a partir do segundo conjunto de valores iniciais são apresentados nas Figuras 5.43 e 5.44, respectivamente.
As Figuras 5.45 e 5,46 mostram os ajustes para o terceiro conjunto de valores iniciais.
Os ajustes nos dados de pressão, para os doís últimos conjuntos de valores iniciais, apesar de não serem perfeitos nos tempos iniciais, podem ser considerados bons. Mas, os ajustes nos dados de vazão da camada 2 são inadimissíveís.
Mais uma vez fica evidente o problema de não unicidade da solução, quando
155
Figura 5.42: Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Primeiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado
240-
g«AT°RiO COM DUAS CAMADAS COM FLUXO CRUZADO CRITÉRIO DOS MÍNIMOS QUADRADOS NA PRESSÃO MCTOÜO DE GAUSS-GREENSTàDT-BARUA.
220-
x&gt;
&lt;200 -
o180’
&lt;
Kf
160-
a&amp;amp;aaa MEDIDA
— CALCULADA
140-
120 4—
1G ’*
A A A. .,.
AA ii ¿â zja Aôôô úí
1 '"" * ’*»&gt;«!	&gt; &gt; m-TTH---! !—r-r-rmT---1 1—&gt;■ i iri|-i ,—r-r-r-n-r
10'J	10”	í	w	102
TEMPO (h)
Figura 5.44: Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Segundo
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado
1
Figura 5.45: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Terceiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado
260
240-
C0M 0UAS CAMADAS com fluxo cruzado CRITÉRIO DOS MÍNIMOS QUADRADOS NA PRESSÃO MÉTODO DE (^SS-GREENSTWT-BARUA.
220-
O 180-
&lt;
rxt
&gt; UO-Í
MEDIDA
----- CALCULADA
140-
120 4—
10 *’
A ¿
&amp;amp;£i¿i Afi ñA AA M
T ' r"1'' ' ■ ’f &amp;lt;," '* ’ rriij-!—r r t &gt; &amp;lt;rr;-í—i—r-n-rrq-1 !—rrmi
10 "*	IO"1	1	w	1OÍ
TEMPO (h)	°
-í
Figura 5.46; Ajuste do Modelo Otimizado aos Dados de Vazão da Camada 2 - Terceiro
Conjunto de Valores Iniciais - Reservatório Com Fluxo Cruzado
se faz a regressão somente sobre os dados de pressão.
Para resolver o problema de não unicidade da solução é necessário fazer-se uso dos dados de vazão de cada camada. O comportamento das vazões de cada camada é sensível às propriedades específicas das camadas.
A determinação dos parâmetros individuais de cada camada pode ser feita através das técnicas propostas por Shah et aL [16]. Nessa técnica, a operação do teste deve consistir de medições simultâneas de pressão e vazão de fundo em diversas posições no poço. Para a interpretação das medições obtidas, usa-se um método de regressão não linear onde a função objetivo é definida por:
E = a, ‘■¡[¡míO - av.-. “)12 +
(5.2.8)
onde, Pwj(íí) é a pressão medida no tempo í„ Pw(ít-,o) é a pressão calculada por um modelo teórico, para o tempo /,• e os parâmetros ã, qw(t^ hj) é a vazão medida no tempo to na profundidade Qw(ti, hj.a) é a vazão calculada por um modelo teórico no tempo Íí, na profundidade hj e para os parâmetros 7 e ó'éo vetor que contém os parâmetros a serem otimizados.
As constantes a; e bij são pesos atribuídos às medidas de pressão e vazão, que são usados para enfatizar a qualidade das medições em cada tempo t,-. 0 peso b^ deverá ser nulo quando a vazão na profundidade hj não for medida.
Os dois exemplos sintéticos, cujos dados básicos encontram-se nas Tabelas 5.2.2 e 5.2.4, foram analisados utilizando-se regressão não linear com o critério de minimização dos quadrados dos resíduos da pressão e da vazão da camada inferior.
A Tabela 5.2.6 apresenta os resultados obtidos, usando~se o método de Gauss-Greenstadt-Barua, no exemplo de reservatório com duas camadas sem fluxo cruzado.
VALORES INICIAIS				VALORES FINAIS				NÚMERO DE ITERAÇÕES
k-í mD	kz mD	£	St	ki mD	k? mD		s2	
1000	200	1	0.5	1978	494	1.92	0.91	5
200	2000	1	0.5	1978	494	1.92	0.91	7
Tabela 5.2.6: Reservatório Com Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão e na Vazão da Camada 2
As Figuras 5,47 e 5.48 apresentam os ajustes de pressões e vazões, respectiva-
mente, com o modelo otimizado obtido, que é idêntico para os dois conjuntos de valores
iniciais.
RESERVATÓRIO COM DUAS CAMADAS SEM FLUXO CRUZADO. CRíTERiO DOS MÍNIMOS QUADRADOS NA PRESSÃO E NA VAZAO MÉTODO DE GAUSS-GREENSTADT-BARUA.
G-e-e-e—e-e-e-e—&amp;amp;~e—o o-o-O 'o-o o oo—e—o
TEMPO (h)
£
***** PRESSÃO
OXOO DERiVADA
----- MODELO AJUSTADO
Figura 5.47: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Reservatório
Sem Fluxo Cruzado
Sem Fluxo Cruzado
No exemplo de reservatório com duas camadas com fluxo cruzado, foi tentada mais uma vez a otimização de seis parâmetros (Ãrn, krt, kXl, kXJ, Si, S2), mas, apesar da inclusão dos dados de vazão na regressão, não houve sucesso. Mais uma vez, o mau condicionamento da matriz Hessiana pode explicar a falha.
Os resultados obtidos na otimização de quatro parâmetros são apresentados
na Tabela 5.2.7.
VALORES INICIAIS				VALORES FINAIS				NÚMERO DE ITERAÇÕES
kTi mD	mD	s,	St	mD	mD	Sr	St	
500	50	3	2	1999	200	3	1	7
500	300	3	2	1999	200	3	1	5
300	300	0	0	1999	200	3	1	6
Tabela 5.2.7: Reservatório Com Fluxo Cruzado - Critério dos Mínimos Quadrados nos
Dados de Pressão e de Vazão
Os ajustes de pressões e vazões, com o modelo otimizado para os três conjuntos de valores iniciais, são mostrados nas Figuras 5.49 e 5.50, respectivamente.
O método aqui aplicado a casos de reservatórios com duas camadas, pode ser facilmente estendido para casos com maior número de camadas.
Figura 5.49: Ajuste do Modelo Otimizado aos Dados de Pressão no Poço - Reservatório
Com Fluxo Cruzado
2
Com Fluxo Cruzado
CAPITULO VI
CONCLUSÕES
1.	Os métodos de regressão não linear para otimização de parâmetros são ferramentas de grande utilidade na interpretação de testes em poços. Principalmente quando utilizados para o refinamento dos resultados obtidos para modelos complexos.
2.	Não se pode afirmar sobre a superioridade de um determinado método de regressão não linear sobre os outros. As características de cada método podem ser próprias para resolver determinados problemas e inadequadas para outros.
3.	O esforço computacional requerido para essas aplicações de regressão em análise de testes é relativamente pequeno, principalmente se as estimativas iniciais são próximas dos valores finais ótimos.
4.	A utilização dos métodos convencionais (semi-logarítmicos) para a interpretação de testes em reservatórios com múltiplas camadas pode, em alguns casos, fornecer os parâmetros médios do reservatório. A presença de dano de formação pode causar a determinação de valores incorretos para esses parâmetros médios,
5.	0 regime pseudo-permanente da camada de maior capacidade de produção, em um reservatório sem fluxo cruzado, mascara o regime transitório das camadas com menor capacidade de produção, causando longa duração do período transitório tardio.
6.	O comportamento de um resevatório com múltiplas camadas com fluxo cruzado é caracterizado por três estágios. Inicialmente comporta-se como um reservatório
com múltiplas camadas sem fluxo cruzado, depois ocorre um período de transição e, finalmente, para longo tempo, o comportamento é similar ao de um reservatório homogêneo equivalente.
7,	O início e o fim do período de transição citado no item anterior são controlados pelas permeabilidades verticais. Quanto menor as permeabilidades verticais, mais tarde ocorrerá a transição.
8.	Para a determinação dos parâmetros individuais de cada camada de um reservatório com múltiplas camadas, é necessária a medição simultânea de pressões e vazões de fundo em determinadas posições no poço.
CAPITULO VII
RECOMENDAÇÕES
L Á ajustagem automatizada de modelos teóricos a dados de testes, pela técnica de regressão não linear, deve ser sempre que possível utilizada pelos intérpretes, em auxílio às técnicas convencionais. Esse procedimento garantirá melhor qualidade nas interpretações dos testes, diminuindo a subjetividade inerente aos métodos específicos.
2.	A aplicação da técnica de regressão não linear no refinamento dos resultados obtidos por outras técnicas menos sofisticadas, proporcionará maior confiabilidade nos resultados finais da interpretação do teste.
3.	Os resultados finais da interpretação, obtidos de uma regressão não linear, devem ser analisados pelo engenheiro intérprete, levando em consideração a coerência física com o modelo geológico e os intervalos de confiança de cada parâmetro estimado. Neste trabalho, não foram calculados os intervalos de confiança de cada parâmetro.
4.	Este trabalho avaliou, de modo restrito, alguns métodos de primeira ordem para regressão não linear. Torna-se necessário avaliar mais intensamente esses métodos e, também, outros nao avaliados aqui, tais como o método de Newton e suas variações e o método dos mínimos valores absolutos (LAV).
5.	Outras técnicas de avaliação de reservatórios que apresentem variação vertical de permeabilidade devem ser analisadas, objetivándose encontrar técnicas simples e que forneçam resultados confiáveis.
NOMENCLATURA
B	~	fator volume de formação
c	—	compressibilidade
Ci	~	compressibilidade total
C	~	coeficiente de estocagem
D	matriz diagonal da fatorização de Cholesky
E	=	função objetivo
g	~	gradiente do modelo	em relação aos parâmetros otimizados
h	=	espessura do reservatório
H	=	matriz Hessiana
Jo	=	função	de Bessel	modificada de ordem zero
/j	=	função	de Bessel	modificada de ordem um
Kü	=	função	de Bessel	modificada de ordem zero
Ki	~	função	de Bessel	modificada de ordem um
k	—	permeabilidade
kr	—	permeabilidade na direção radial
kg	=	permeabilidade na direção vertical
L ™ matriz triangular inferior unitária da fatorização de Cholesky
p	~	pressão
= pressão inicial
~ pressão de fluxo no poço
= pressão de fluxo no poço no instante de fechamento
~ pressão de estática no poço
= pressão teórica simulada
= vazão
—	raio
= raio do poço
= raio do reservatório
= matriz diagonal do método de Gill e Murray
= variável do espaço de Laplace
~ fator de película
= tempo
—	tempo de produção
—	função degrau unitário de Heaviside
-- profundidade
Letras gregas
—	vetor de parâmetros a serem determinadas
= porosidade
k ~ parâmetro de capacidade de produção, adimensional
À	~ parâmetro de fluxo entre dois sistemas	porosos, adimensional
p	— viscosidade do fluido
w	~ parâmetro de armazenamento,	adimensional
p	~ massa específica
Subscritos
D	= adimensional
e	~	externo
f	=	fluxo
i	=	inicial
N	=	normalizado
p	=	produção
psg	~ pseudo permanente
s	=	estática
t	~	total
w — poço
Sobrescritos
T	= tansposto de um vetor ou matriz
0	= inicial
-1	= inversa de uma matriz
Referências
[1]	Sneider, R. M., Tinker, C. N. e Meckel, L. D.: “Delatic Environment Reservoir Types and Their Characteristics”, J. Pet. Tech. (Nov. 1978) 1538-1546.
[2]	Tempelaar-Lietz, W. : “Effect of Oil Production Rate on Performance of Wells Producing From More Than One Horizon”, Soc. Pet. Eng. 3. (Mar. 1961) 26-31.
[3]	Lefkovits, H, Hazebroek, P., Allen, E. E. e Matthews, C. S.: “A Study of the Behavior of Bounded Reservoirs Composed of Stratified Layers”, Soc. Pet. Eng. J. (Mar. 1961) 43-58.
[4]	Cobb, W. M., Ramey, H. J. Jr, e Miller, F. G,: “Well-Test Analysis for Wells Producing Commingled Zones”, J. Pet. Tech. (Jan. 1972) 27-37.
[5]	Raghavan, R., Topaloglu, N., Cobb, W. M. e Ramey, H. J. Jr.: “Well-Test Analysis for Wells Producing from Two Commingled Zones of Unequal Thickness”, J. Pet. Tech. (Sep. 1974) 1035-1043.
[6]	Earlougher, R. C. Jr., Kersch, K. M. e Kunzman, W. J “Some Characteristics of Pressure Buildup Behavior in Bounded Multiple-Layered Reseroirs Without Crossflow”, J. Pet. Tech. (Oct. 1974) 1178-1186.
[7]	Tariq, S, M. e Ramey Jr, H. J. : “Drawdown Behavior of a Well With Storage and Skin Effect Communi canting With Layers of Different Radii and Other Characteristics”, paper SPE 7453, apresentado no 53rei Annual Technical Conference and Exibition, Houston, Texas, 1 a 3 de outubro de 1978.
[8]	Larsen, L. : “Wells Producing Commingled Zones With Unequal Initial Pressures and Reservoir Properties”, paper SPE 10325, apresentado no 56i/l Annual Fall Technical Conference and Exibition of the Society of Petroleum Engineers of AIME, San Antonio, Texas, 5 a 7 de outubro de 1981.
[9]	Kucuk, F,, Karakas, M. e Ayestaran, L.: “Well Test Analysis of Commingled Zones Without Crossflow”, paper SPE 13081, apresentado no 59i#* Annual Te-
[10]	Raghavan, R. : “Behavior of Wells Completed in Multiple Producing Zones”, paper SPE 14111, apresentado no SPE 1986 International Meeting on Petroleum Engineering, Beijing, China, 17 a 20 de março de 1986.
[11]	Prats, M. e Russel, D. G. : “The Practical Aspects of Interlayer Crossflow*5, J. Pet. Tech. (June 1962), 589-594.
[12]	Prijambodo, R., Raghavan, R e Reynolds, A. C.: “Well Test Analysis for Wells Producing Layered Reseroirs With Crossflow”, paper SPE 10262, apresentado no 56a Annual Fall Technical Conference and Exibitíon of the Society of Petroleum Engineers of AIME, San Antonio, Texas, 5 a 7 de outubro de 1981.
[13]	Gao C-T,: “Single-Phase Fluid Flow in a Stratified Porous Medium with Crossflow**, Soc. Pet. Eng. Journal (Fev. 1984), 97-106.
[14]	Bourdet, D.: “Pressure Behavior of Layered Reservoirs With Crossflow”, paper SPE 13628, apresentado no SPE 1985 California Regional Meeting, Bakersfield, California, 27 a 29 de março de 1985.
[15]	Ehlig-Economi des, C. A., Joseph, J. A. : “A New Test for Determination of Individual Layer Properties in a Multilayered Reservoir”, paper SPE 14167, apresentado no 60!/l Annual Technical Conference and Exibition of the Society of Petroleum Engineers, Las Vegas, 22 a 25 de setembro de 1985.
[16]	Shah, P. C., Karakas, M., Kucuk, F. e Ayestaran, L/C Estimation of the Permeabilities and Skin Factors in Layered Reservoirs Using Downhole Rate and Pressure Data”, paper SPE 14131, apresentado no SPE 1986 International Meeting on Petroleum Engineering, Beijing, China, 17 a 20 de março de 1986.
[17]	Park, H., Horne, R. N,: “Well Test Analysis of a Multilayered Reservoir With Formation Crossflow”, paper SPE 19800, apresentado no 64iil Annual Technical
Conference and Exibition of the Society of Petroleum Engineers. San Antonio, Texas, Sail de outubro de 1989.
[18]	Bourdet, D., Whittle, T. M., Douglas, A. A. e Pirard Y. M.: “A New Set of Type-Curves Simplifies Well Test Analysis”, World Oil (May. 1983), 95-106.
[19]	Bourdet, D., Ayoub, J. A. e Pirard Y. M.: “Use of Pressure Derivative in Well Test Interpretation”, paper SPE 12777, apresentado no 1984 California Regional Meeting, Long Beach, California, 11 a 13 de abril de 1984.
[20]	Corrêa, A. C, e Ramey, H. J. Jr.: “Combined Effects of Shut-In and Production: Solution with New Inner Boundary Condition”, paper SPE 15579, apresentado no 61st Annual Technical Conference and Exibition of the Society of Petroleum Engineers, New Orleans, L. A., 5 a 8 de outubro de 1986.
[21]	Warren, J. E. e Root, P. J.: “Behavior of Naturally Fractured Reservoirs”, Soc. Pet. Eng. Journal (Sept. 1983) 245-255.
[22]	Marquardt, D. W.: “An Algorithm for Least-Squares Estimation of Nonlinear Parameters”, J. SIAM (June 1963) 11, N° 2, 431-441.
[23]	Levenberg, K.: “A Method for the Solution of Certain Problems in Least-Squares”, Quart. Appl. Math. (1944) 2, 164-168.
[24]	Greenstadt, J. L.: “On the Relative Efficiencies of Gradients Methods”, Mathematics of Computation, (1967) 21, 360-367.
[25]	Gill, P. E. e Murray, W.: “Newton-Type Methods For Unconstrained and Linearly Constrained Optimization”, Mathematical Programming, (1974) vol.7, 311-350.
[26]	Janhs, H. 0.: “A Rapid Method for Obtaining a Two-Dimensional Reservoir Description From Well Pressure Response Data”, Soc. Pet. Eng. J. (December 1966), 315-327.
[27]	Coats, K. H., Dempsey, J. R. e Henderson, J. JL: “A New Technique for
Determining Reservoir Description from Field Performance Data”, Soc. Pet. Eng. J. (March 1970), 66-74.
[28]	Earlougher, R. C. e Kersch, K. M.: “Field Examples of Automatic Transient Test Analysis”, J. Pet. Tech, (October 1972), 127M277.
[29]	Hernandez, V. M. e Swift, G. W.: “A Method for Determining Reservoir Parameters From Early Drawdown Data”, paper SPE 3982, apresentado no 47u Annual Fall Meeting of the Society of Petroleum Engineers of AIME, San Antonio, Texas, 8 a 11 de outubro de 1972.
[30]	Rodgers, J. S., Coble, L. E,, Boykin, R, S. e Mokha, J. S.: “Nonlinear Well Test Analysis Reveals Reservoir Boundary Shape”, TECHNOLOGY, Oil and Gas Journal (Sept 14, 1981), 63-68.
[31]	Guillot, A. Y. e Horne, R. N.: “Using Simultaneous Downhole Flow Rate and Pressure Measurements To Improve Analysis of Well Tests”, paper SPE 12958, apresentado no 1984 European Petroleum Conference, Londres, Inglaterra, 25 a 28 de outubro de 1984.
[32]	Barua, J. e Horne, R, N.: “Computerized Analysis of Thermal Recovery Well Test Data”, SPE Formation Evaluation, (December 1987), 560-566.
[33]	Bard, Y.: “Nonlinear Parameter Estimation”, Academic Press Inc. Ltd., New York City (1974).
[34]	Rosa, A. J. e Horne, R. N.: “Automated Type-Curve Matching in Well Test Analysis Using Laplace Space Determination of Parameter Gradients”, paper SPE 12131, apresentado no 58ife Annual Technical Conference and Exibition of the Society of Petroleum Engineers, San Francisco, Califórnia, 5 a 8 de outubro de 1983.
[35]	Barua, J,, Horne, R. N., Greenstadt, J. L. e Lopez L.: “Improved Estimation Algorithms for Automated Type-Curve Analysis of Well Tests”, SPE Formation Evaluation (Mar 1988) 186-196.
[36]	Namba, T. e Horne, R. N.: “An Improved Regression Algorithm for Automated Well Test Analysis”, paper SPE 18161, apresentado no 63rd Annual Technical Conference and Exibitlon of the Society of Petroleum Engineers, Houston, Texas, 2 a 5 de outubro de 1988.
[37]	Orellana, E. N.,: “Automação de Testes de Pressão em Laboratório Usando De-convolução”, Tese de Mestrado defendida em novembro de 1990 na UNICAMP, no Departamento de Engenharia de Petróleo.
[38]	Scales, L. E.: “Introdutlon to Non-Linear Optimization”, Springer-Verlag New York Inc. (1985).
[39]	Rosa, A. J. e Horne, R. N.: “Automated Well Test Analysis Using Robust (LAV) Nonlinear Parameter Estimation”, paper SPE 22679, apresentado no 66iix Annual Technical Conference and Exibitlon of the Society of Petroleum Engineers, Dallas, Texas, 6 a 9 de outubro de 1991.
[40]	IMSL - Problem Solving Software Systems - STAT/LIBRARY - FORTRAN Subroutines for Statistical Analysis. Houston, Texas (1987).
[41]	Golub, G. H. e Van Loan, C. F.: “Matrix Computations”, The Johns Hopkins University Press, Baltimore, Maryland (1984).
[42]	Smith, B. T., Boyle, J. M., Dongarra, J. J., Garbow, B. S., Ikebe, Y., Klema, V. C. e Moler, C. B., “Matrix Eigensystem Routines - EISPACK Guide”, Lecture Notes in Computer Science, Vol. 6, Second Edition, Springer-Verlag, New York, Heidelberg, Berlin, 1976.
[43]	Bourdet, D., Ayoub, J. A., Whittle, T. M., Pirard Y. M. e Knlazeff, V.: “Interpreting Well Tests In Fractured Reservoirs”, World Oil (Oct, 1983), 77-87.
[44]	Gringarten, A, C.: “Interpretation of Tests in Fissured Reservoirs and Multilayered Reservoirs with Double Porosity Behavior: Teory and Practice”, Paper SPE 10044 apresentado no International Petroleum Exhibition and Technical
Symposium of the Society of Petroleum Engineers of AIME, Beijing, China , março de 1982.
[45]	Stehfest, H.: “Algorithm 368, Numerical Inversion of Laplace Transforms’*, D-5 Communications of the ACM, vol. 13, No.l, (Jan. 1970), 47-49.
O algoritmo de busca linear usado neste trabalho, o mesmo adotado por Namba e Horne [36] e também por Rosa e Horne [39], pode ser escrito como:
(1)	m = 0
(2)	^(1/2)”*
(3)	~ aj + pfej ; j ~ 1,..., np
(4)	if (Xj &amp;lt;ajmin ou oy &gt; aJrow , then
m = m + 1
if m &gt; 10, stop
go to (2)
else
endif
(5)	calcule £í:+1
(6)	tf &gt; Ek , then
m = m +1
if m &gt; 10, stop
go to (2)
else
endif
APÊNDICE B
FATORIZAÇÃO DE CHOLESKY
H = LDLT .	(B.l)
onde D é uma matriz diagonal com elementos não negativos e L é uma matriz triangular inferior cujos elementos da diagonal principal são unitários, Os elementos de D e de L são calculados coluna a coluna:
djj = hjj — 53^99^5 )	(^-2)
j-1
/ij = (hij — 22	,	(B.3)
«=i
i - j +
onde hij são os elementos da matriz H.
O sistema de equações a ser resolvido nos métodos de regressão não linear baseados em mínimos quadrados é;
H6a = -g,	(BA)
Usando-se a definição (B.l) em (BA), vem:
L D Lt 6a = —g ,	(B.5)
ou:
Lt^-g,	(B.6)
onde:
t - D Lt êa .	(B.7)
Então, o Sistema (B.4) pode ser resolvido fácilmente como dois sistemas triangulares de equações lineares. O primeiro definido pela Equação (B.6) e o segundo obtido da Equação (B.7);
LT	(B.8)
Do Sistema (B.6), por substituição progressiva, obtem-se o vetor f e do Sistema (B.8), por substituição regressiva, obtem-se áô.
Segundo Scales [38], se H é positiva definida, todos os elementos dJ} são positivos e o processo de fatorização é numericamente estável. Se H nao é positiva definida, a fatorização é instável. Os elementos podem assumir qualquer valor, incluindo zero, caso em que a fatorização não existe. O exame dos elementos djj proporciona uma verificação se a matriz é positiva definida ou não.
Fatorização de Cholesky modificada por GiH e Murray [25]
No método de Gill e Murray, se algum elemento djj for menor do que uma determinada constante pequena e positiva é, então um número positivo rjj é adicionado ao elemento hjj da matriz H para que a matriz modificada H seja positiva definida. Consequentemente, o elemento d3y da matriz diagonal D é alterado para;
djj — hjj + Tjj	~	•	(B.9)
9=1
Os valores d¿j são usados na Equação (B.3) para obter-se os valores modificados Z.j. Na escolha da constante Ó deve-se levar em conta o condicionamento da matriz e a precisão da máquina.
Esta técnica garante a estabilidade da fatorização da matriz modificada H:
H = LDLT.	(B.IO)
A matriz modificada H será tão próxima quanto possível da matriz original H e a relação entre elas é dada por:
H = H + R ,	(B.ll)
onde R é uma matriz diagonal com elementos não negativos No caso onde a matriz H já seja suficientemente positiva definida, elas serão idênticas, isto é: R = {0}.
APÊNDICE C
SOLUÇÃO PARA RESERVATÓRIO HOMOGÊNEO
A solução de pressão adimenslonal no poço, incluindo os efeitos de estocagem e de película, para um poço de raio finito rw produzindo à vazão constante um fluido de pequena compressibilidade e de viscosidade constante em um reservatório homogêneo e infinito, é dada no campo de Laplace por:
—________________4-	___________
P"° “ s {v'nCtv'S) + CDs [K0(y/ã) + S'/sKt(^)]} ’
onde $é a variável do campo de Laplace correspondente ao tempo no campo real, S é o fator de película, Kq e Zíj são funções de Bessel modificadas de segunda espécie e de ordem zero e um respectivamente. As variáveis adimensionais são definidas como:
(C.2)
(C.3)
(C.4)
APÊNDICE D
SOLUÇÃO PARA RESERVATÓRIO COM DUPLA POROSIDADE
A solução de pressão adimensional no poço, incluindo os efeitos de esto cagem e de película, para um poço de raío finito rw produzindo à vazão constante um fluido de pequena compressibilidade e de viscosidade constante em um reservatório infinito com comportamento de dupla-porosidade, é dada no campo de Laplace por:
~_ 1
f	f—r f&amp;lt;1	\ 7
í	MtfW I
5 \ CqS -j- i-	—r—~~-y
[	K&lt;¡ [] +SyWPú vWJ J
(D.l)
onde jéa variável do campo de Laplace correspondente ao tempo no campo real, S é o fator de película, Kü e são funções de Bessel modificadas de segunda espécie e de ordem zero e um respectivamente* As variáveis adimensionais são definidas
como:
2 7T kj h
PwD — p {Pi ~ Pwf) 7 q tf p
(D.2)
Cp =
(D.3)
t_________kft
D &amp;amp; V ^í+m p ri '
(D.4)
________c_________
2 7T V Ct)/+m h rl
5
A função f(s) é definida de diferentes formas, dependendo do tipo de fluxo entre o sistema de matriz e o sistema de fissuras. Se esse fluxo ocorre em regime pseudo-permanente [21], a função f(s) é:
,, . w(l - w)s + A
/ (* = 7;-r7T
(1 — w)s + A
(D.õ)
(D.6)
quando os blocos de matriz são placas horizontais [44], ou:
-1	,	(D.7)
para blocos esféricos de matriz [44].
As variáveis À, coeficiente de fluxo interporoso, e u&gt;, razão de armazenamento, são parâmetros característicos de reservatórios de dupla-porosidade, sendo definidos como:
(D.8)
e

(D.9)
onde a é um fator de forma.</field>
	</doc>
</add>