<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-BT.05214</field>
		<field name="filename">BTP_1974_17_3_06_Simulacao_numerica.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">PERFURAÇÃO E PRODUÇÃO
x	simulação numérica de re-
servatórios de petróleo^
Newton Reis Monteiro ((*) **)
José Kanan Marques (**)
SINOPSE — Uma equação fundamental de fluxo pode ser deduzida para cada uma das fases óleo, água e gás, presentes num reservatório, combinando-se' a Iei da conservação dã"massa, uma lei de torça” e-asT^tações termodinâmicas que descrevem o comportamento de pres-são-volume-temperatura dos fluidos.
São apresentados vários métodos comprovadamente utilizáveis na solução das^equações que simulam o comportamento multifásico nos reservatórios, como também um método iterativo de solução de matrizes de equações em diferenças finitas, para problemas anisijtrópicos..
(*) Método de Resolução utilizado no Modelo de Simulação BOSS.	n
(**) Técnico da Divisão de Produção, Departamento de Exploração e Produção (DIPRODEXPRO) — PETROBRÁS.
Newton Reis Monteiro, formado em Engenharia Mecânica pela Escola Nacional de Engenharia da Universidade do Brasil e diplomado em Engenharia de Petróleo pela Universidade da Bahia, em convênio com o CENAP-BA, concluiu o curso de Matemática Superior da Pontifícia Universidade Católica (PUC) do Rio de Janeiro, através de convênio entre essa entidade e a PETROBRÁS. Tem o titulo de Master of Science da Universidade de Stanford (U.S.A.). Trabalhou em Engenharia de Reservatório na antiga Divisão de .Reservatórios da Região de Produção da Bahia (DIVIRES/RPBA) até 1963. Transferido para o Setor de Reservatórios da Divisão de Produção do Departamento de Exploração e Produção (SEREVIDIPROjDEXPRO), é, atualmente, substituto dp Chefe do Setor. Trabalha há algum tempo no desenvolvimento de programas de computadores para análise de reservatório de petróleo, principalmente, tendo participado na elaboração do primeiro simulador numérico de reservatório desenvolvido na PETROBRÁS. Ê assessor da área de produção do Departamento de Exploração e Produção (DEXPRO) junto a este, periódico, e, na qualidade de Full Member, faz parte dos quadros do American Institute Mining Metalurgicáll. Engineers (A.I.M.E.).
José Kanan Marques, formado em Engenharia Civil pela Escola de Engenharia da Universidade Federal do Rio Grande do Sul e diplomado em Engenharia de Petróleo pela Universidade da Bahia, em convênio com o CENAP-BA, possui curso de Matemática Superior ministrado pelo Instituto de Matemática de Porto Alegre. Trabalhou em controle de Produção e controle de reservatórios exercendo a Chefia da Seção de Controle de Reservatórios do Distrito Norte da Região de Produção da Bahia, até 1966. Posteriormente trabalhou no Setor de Controle de Reservatórios, na sede da RPBA, sendo transferido em 1969 para o Setor de Reservatórios da Divisão de Produção do Departamento de Exploração e Produção (SEREV-DIPRÓ-DEXPRO), onde vem exercendo suas atividades nos estudos dos reservatórios do Campo de Mi-ranga. Em 1971 participou, como chefe da delegação da PETROBRÁS, da XI Reunião de Técnicos da ARPEL, realizada no Peru.	.
1	— PRELIMINARES
Este trabalho consiste, basicamente, na tradução detalhada e comentada dos artigos sobre simulação numérifia_de reservatórios de petróleo e métodos matemáticos de resolução de modelos matemáticos, apresentados por E. A. Breitenbach, D. H. Thurnáu, H. K. Van Poolen e J. W. Watts. Esses técnicos, cuja contribuição no campo do desenvolviménto da engenharia de reservatórios é reconhecidamente importante, colaboraram na elaboração do modelo matemático BOSS (Black Oil'Simulation System), adquirido pelo Departamento de Exploração e Produção da PETROBRÁS. .	'
2	— INTRODUÇÃO
Uma equação fundamental de fluxo pode ser deduzida para cada uma das fases presentes num-reservatório (óleo, água e gás), combinando-se, simplesmente, a lei de conservação da massa, uma lei de força e as relações termodinâmicas que descrevem o comportamento de pressão-volume dos fluidos.
A lei de conservação da massa estabelece que a soma da massa que flui para uma célula deve ser igual à variação de massa que ocorre dentro de uma célula.
A lei de. força que descreve o fluxo através de meios porosos é a Lei de Darcy, que estabelece, por hipótese, estar o fluxo dentro do regime laminar descrito pela lei em questão. As relações termodi
nâmicas usadas para descrever o comportamento dos diluídos (devido à falta de expressões analíticas precisas) são determinadas experimentalmente num estudo de PVT.
A primeira parte desse trabalho mostra como essas leis podem ser combinadas para dar as equações que descrevem o fluxo de fluido através dos meios porosos.
O próximo passo no desenvolvimento é a combinação dessas equações com equações auxiliares, de tal modo que se reduza o número de variáveis dependentes. ' O resultado é uma equação que pode ser trabalhada somente em termos da pressão na fase óleo, implicando numa solução implícita para as pressões ao novo nível de tempo. A parte desta equação de pressão, as equações de saturação são resolvidas explicitamente, usando-se as mais recentes pressões.	, x
A partir desse ponto, teremos três equações, desenvolvidas em forma final de diferenças finitas:
1)	Uma equação para a pressão;
2)	Uma equação para a saturação de óleo;
3)	Uma equação para a saturação de água.
A lógica usada na computação de todos os termos é dada na seção final deste trabalho.
Os aspectos gerais da simulação numérica do fluxo de fluido foram elaborados anteriormente em trabalho dos mesmos autores, sendo que a parte de solução numérica também foi objeto de estudo pelos supracitados técnicos.
0
8.1 — EQUAÇÕES FUNDAMENTAIS DO FLUXO
A figura 1 mostra um elemento diferencial do meio poroso. Consideremos que:
W op
1
+ Ax
x	x +Ax
Fig. 1 — Elemento Diferencial do Meio Poroso.
Seja um peso de óleo (TFo), em lb, fluindo para dentro ou para fora do elemento através de duas faces, com um Poço escoando um peso (lFOp), em lb, no centro do elemento.	'
Usámos pesos para simplificar o algebrismo, já que isso implica na hipótese de g constante.
Taxa de depléção de óleo do elemento = R$D
: 3.	K0D =	_ tjzOi + jy0J,	(1)
Onde R0D é a taxa de remoção de óleo do elemento em lb peso/dia em condições de reservatório.
Para valores suficientemente pequenos de Ax, a equação (1) pode ser escrita como:
R$D = Ax + W0P	(2)
Ox
Wo é definido normalmente como:
Wo “ ÇoR Por	(3)
Onde o subscrito, R, assinala condição dé reservatório.
Usando a definição de Bo, a equação (3) fica:
Wo =	(4).
Obs: p0R =
Então, a equação (2) pode ser reescrita como:
w - íÉ? (-^) +’»'•	®
Todavia, a taxa de depleção pode também ser considerada como a variação com o tempo do peso de
- óleo dentro do elemento. Isto é:
\
ô	Q
R0Z) =-^-(peso) = - (VsMpob)
ou = - A (»)	, (6)
Usando a regra de produto para diferenciação, a equação (6) pode ser expandida como:
A (£)
SoPo
~b7
Vb4&gt;Po dS0 B„ dt

Usando a regra de diferenciação em cadeia e a seguinte expressão para a relação porosidade-pressão:
1	A&lt;/&gt;
_ AP
ou seja:
4&gt;i — $orig{l + cf (Pt — Pong)}	(8)
A equação (7) pode ser posteriormente expandida, do seguinte modo:
■*
d-A
SoPoVb^OTÍgpf	dPg
b~0	dt
VbÍ&gt;Pa 9 So
Bg dt
(9)
Observe-se que as variáveis de PVT são tomadas como unicamente dependentes da pressão (isto é, fluxo isotérmico) e que o volume bruto de rocha Vb é constante. „
Como as dúas expressões obtidas para a taxa de depleção devem ser iguais, as equações (5) e (9) podem ser igualadas, e teremos:
R0D = JL	A® + qop p0 =
OX \ Bo /
SgPgVb^f dPo _ Vb&lt;j&gt;Po dSg Bg	dt	Bg dt
(10)
Supondo que o peso específico do óleo, em condições standard, seja , invariante ■ tanto .’em espaço como em tempo,, pode, ele ser simplificado, na. equação (10). Também, se a derivação das equações
B. téc. PETROBRÁS, Rio dé Janeiro, 17 (3) : 193-224, jul./set. 1974
QwpRswPg
(15)
Considerando novamente o outro modo de definição de R0D, teremos para o gás:
Bg
ÕSg dt
(11)
ou
definida neste relatório como a
A equação (11) é equação fundamental de fluxo para o óleo.
Analogamente, a equação fundamental para o fluxo da água pode ser escrita como:
, BwR-swPg | )
+
		Qwii
dx \ Bw )	dy \	. Bw
, d /	\ + dz \ Bw }	&amp;amp;Z ~f" Qwp	
, +	Bw	dPg	
	dt	
'	„	3	( 1 1	, dP,
+ VM U PIO	\ Bw )	' dt
w
) Ay
Ba
(16)
Aplicando, como anteriormente, a regra de diferen-. ciação para produtos, a equação (16) ganha a forma:
BwRfwPg
Bw
d dt
Vb&lt;t&gt; dSw
■ Bw dt
(12)
Obs.: O termo da compressibilidade da formação Cf, na equação da água, é suposto ser função, apenas, da pressão no óleo. Daí, então, aparecerem derivadas das pressões, no óleo e na água, em relação ao tempo.
,A equação fundamental de fluxo para gás pode ser derivada da' mesma maneira, considerando, todavia, os fluxos do gás livre, gás em solução no óleo e gás em solução na água.
Analogamente à equação (2) a taxa de depleção R0D para o gás pode ser derivada do seguinte modo:
(13),
onde a vazão em peso de gás é definida como:
Sübstituindo-se na equação (13) a equação (14),. e expandindo-se o termo da produção do poço de um módo similar à equação (14), teremos:	.

. PsPg Bo
RswPg
+ Bw
\ díM)
/ dí
(t)}

dt f
d dt
(R»wpg \
Bw )
(17)
Então, usando-se a regra de diferenciação em cadeia e a relação porosidade-pressão definida pela equação (8), a equação (17) se torna:
.	.SwBswPõ 1 dP o
Bw
Sgffspg


* RswPo d a8io)
+ Bw ~dt)
(18)
Desde que as duas taxas de depleção devam ser iguais, combinam-se as equações (15) e (18), usando-se também 3 dimensões, e considerando-se a hipótese de que a densidade do gás, nas condições standard, é constante dentro do intervalo de tempo considerado, teremos:
a
+
d
—— (= a termo) Aw + -v- (= a termo) Az dy	az
A hipótese simplificadora adotada no procedimento de solução das equações de fluxo consiste somente naquelas associadas às 3 fases (3 componentes) (comportamento das propriedades de PVT).
Decidiu-se éxperimentalmente que o método de solução seria: resolver as pressões implicitamente e as novas saturações explicitamente, com equações linearizadas para cada incremento de tempo.
Isso requer a combinação das 3 equações fundamentais de fluxo, para obter uma só equação na qual a pressão seja a única variável dependente.
Esta equação pode, então ser usada para determinar as novas pressões implicitamente (simultaneamente em todos os pontos do espaço). Então essas novas pressões podem ser substituídas nas equações individuais de fluxo, para determinar explicitamente as novas saturações.
Equações auxiliares necessárias para obter a equação final
+
(.Çgp d~ qopRa d” ÇLwp Raw) d~ ^«Aorig Ci ( Bo
So + Su&gt; + So = 1
ou
+
SoRs .
__ +
SwRaw \
Bw )
dSo , dSa , dSs
X+X+X
= 0
■j

Substituindo a equação (21) no lado direito da equação (19), temos:
I I
+
tVb sw
d&gt; Vb s„
_d_ ( R™\ dPa dPw \ Ba )&amp;lt;^t
+
R&gt;_ dSo R^_ ô-SU + Bo dt + Bw dt f

, T7 / 1 dSaA R. dS„
- *7i lx 'ãí + x X
- +
R.w d&amp;amp;A
Bw dt /
As equações (11), (12) e (19) constituem as equações fundamentais para óleo, água e gás, e foram as usadas no programa simulador MUFFS, desenvolvido pela Marathon Co.	'
Elas podem ser expandidas além desse ponto, substituindo-se ás expressões da lei de Darcy, nos termos correspondentes a qaR, qoB e qwB; essas substituições serão feitas posteriormente.	'
3.2 — COMBINAÇÃO DAS EQUAÇÕES FUNDAMENTAIS DE FLUXO
a
O problema imediato é a redução das 3 equações fundamentais de fluxo a uma forma que possa ser resolvida. .
As não-linearidades tornam impossível sua solução analiticamente, daí ser necessária a sólüçãó numérica.
ou
(19)
RHS =
A equação final para o óleo (equação 11) será multiplicada por Bo, a eq. final para a água por Bw, tal que possam ser substituídos na equação (22) os
termos —&amp;lt;j&gt;Vb
dSo ,TZ dSw	,
e —&amp;lt;i&gt;Vb -v", respectivamente. at	at
Com isso ocorre que todas as derivadas das saturações são eliminadas. Simplificando e grupando os termos a equação resultante será:
Bo\ d / qoR \ d_ / PorRo \ Bj dx \ Bo / dx \ Bo }
B. téc. PETROBRÁS, Rio de Janeiro, 17 (3) : 193-224, jul./set. 1974
são no óleo. Igualmente possível de se obter a equação em termo de pressão no gás ou na água, também como variável independente.
As relações de pressão capilar são:
Pa = Po - Peow	(25)
ou
dP„ _	dProa
dt dt dt
ou
dt dt dt
(26)
(27)
(28)
A Lei de Darcy para cada uma das fases, na direção x, por exemplo, é escrita como:
Pw
Aailtai/q-o
QoR =--------------------
Po
dh \
dx)
dP0 dt
qaR = -
dP0 dx
+ PoR
(29)
dP» [ dPt„B dx'	. dx
Substituindo-se as equaçõés (26), (28), (29), (30) e
(31)	na equação (24) obtemos:
BA ( Akkro B„ / l Bop,o
(vp0 +
(23)
+ PoaV hj j-. A+V	^V-Po+ p0A7hj j-. A
A equação (23) pode ser escrita‘numa forma mais compacta, usando-se as definições dadas pelos símbolos:
pwR Vh
.A
V, A, Ai, A2, A3 e A4; desse modo ela se torna:



+
+
+
+
-^«)a-a-
+ V	(vPo - VPCott + pwn Vá}.A
.+ V	(VP0 + VPCfl0 + pBR	.A-A1 '
dP	dP
= (A2 + A3 + A4)-^-A3 -^. .
(24)
(32)
Neste ponto,. então, usa-se a lei de Darcy e as relações de pressão capilar,: pará simplificai a equação e obter còmo Variável independente apenas a pres-
A expansão da.equação^ (32) obriga-nos a definir . um; maior númerq. de termos, de. maneira; a-simplificarmos o manuseio com a equação.
Assim definamos:
t ^dPCow dPCo„
A5 =	—
Ai
(33)
(34)
Daí, então, a necessidade de definirmos um sistema de malhas (grid) de diferenças finitas.
O processo básico constitui-se, então, em resolver um sistema de equações de diferenças finitas,, um para cada célula da malha, e uma vez para cada incremento de tempo. Um exemplo dé malha pode ser visto na figura 2.	■
Substituindo-se as equações (33) e (34) na equação
(32), teremos a equação final da pressão, ou seja:
+
(a-x)v{4^(VP-
Fig. 2 — Cadeia de Malhas Uniforme.
+
pOBV/ij| .A
(A--x)v{^r(VP&gt;-VP‘-
+
PwR	. A
+
V (R^kkr. (yPa _ vPc^ + PwbVK) }	_ A
( JPwPw
+
v (VP°+ vp'"d+•A
As equações para as saturações de óleo e de água são obtidas diretamente das equações (11) e (12).
A próxima etapa será a discretização (34-a), usando-se diferenças finitas.
4	— FORMA EM DIFERENÇAS FINITAS
A base das diferenças finitas está na substituição de todas as derivadas por diferenças.	'
Por exemplo:
d&gt;7)
-4- pode ser substituída pela diferença
dx
Pi-Po
Xí — Xo
Deste modo, uma equação que contenha derivadas poderá ser transformada em equações que contenham somente valores discretos de p, tal como pi, no caso. Isto requer que tanto o tempo como o espaço sejam divididos em intervalos discretos, de forma tal que Cada termo, individualmente, represente um ponto conhecido no tempo e no espaçò.
A économicidade do trabalho de simulação é significativamente aumentada quando temos a facilidade de mudar o tamanho da célula. Ê possível ter-se sistema de malhas como o que aparece na figura 3.	■
Fig. 3 — Sistema de Malhas Variável.
Todavia, o uso de um sistema de malhas totalmente variável, onde as linhas e colunas não são preservadas, restringe o número de técnicas de solução que podem ser utilizadas.
O modelo em questão utiliza um sistema de malhas do tipo ilustrado na figura 2. Uma vez que a mesma equação de pressão será resolvida para todas as células, podemos considerar uma única célula e as seis vizinhas imediatas, como na Fig. 4.
Fig. 4 — Indexamento para Diferenças - Finitas em
3-D.	•*
Os gradientes de potencial que decorrem da lei de Darcy devem ser obtidos a partir de aproximações em diferenças finitas. O gradiente potencial no óleo entre os pontos 0 e 1 seria aproximado por:
(Po. - Po )
Ax
+ PoR
(hi - h0)
Ax+ '
Gomo o ponto ao qual as. derivadas são empregadas está situado entre os 2 valores usados ’ (isto: é, PO0 e-poi),-- essa forma- de.diferença finita é denominada como uma diferença finita central, em espaço.
Az* = 0,5 (Az0 + Asi)
Expressões similares estão associadas com Anr, Ay*,				
Ay~, Az*, Az~.				
De modo a simplificar a notação, usamos guintes definições:	'				as se-
APi = P„,	-Po;	' : Ahi = ht -	hg	
AP; = Po, ■	-Po.	■ Ahi = h3 -	hg	
APi = P01 -	-Po;	j Ahy ” hi	hg	
. APi = P„. -	-Po;	; Ahi = h* -	hg	
APi = POj -	-Po;	; Ahi = As -	hg	
' APi = Po. -	-Po;	; Ahi = h6 —	hg	(35)
Ref.: figura n.° 4.
A próxima etapa será substituir todas as aproximações para as derivadas de pressão e elevação na equação (32)’.
Se definirmos as variáveis 'abaixo:
ção da localização, no espaço, de todas as funções da pressão e da saturação.
Expandindo-se e reorganizando-se todos os termos da equação (32), a equação resultante será:
-	(R. Ni + Nt + Rix Ni - Raw Wi
+' ~Wi + Ri„x Wi + Gi)APi
+ (R. N~x - Nx - R~s Nx + Raw Wx
-	~ Wi - R^ W~x - Gi) APi
Bg
-	(Ra Ni + Ni + Riv Ni - Raw Wi	.
+ ~ Wi + RiWy Wi + Gi) APi ng
+ (R, N~y - ~ Ni - R~Sv N~y + RSW W~y
-	~ IFí - R^y W-y - Gi) kPi
-	(Rs Ni + ~ Ni + Rk Ni - Raw Wi .	.
Bg	'
+ ~wí + r^ m + os apí
-Dg
+ (R, Ni - Ni - Ri.-Ni + Raw Wi
Bg	"
-	Wi - Rrm, Wi — Gi) APi
Bg
Onde c = 6,32867 X 10~3 (para um sistema de unidades definido com mel, pê, cp, psi).
Então, o edmponente na direção x do primeiro termo da equação 32 se torna:
’H)	;
/N* APj + IVj; pX Afíj—Nj AP; + A; p~oKx Afc|
.	(37)
Os demais termos correspondentes da equação (32) são escritos analogamente. Todos aqueles que não levam subscritos se referem à célula central, isto é, à célula 0.
Note-se que esta expansão mantém através do uso de subscritos e superseritos uma precisa defini-
Onde A7 = As + Termos de produção + Termo devido à força de gravidade + Termo devido à pressão capilar.	•
Multiplicando-se a equação (38) por Bg no ponto 0, e definindo-se o seguinte:
Oi = (Bg Rix — Rs Ba + Bo) Ni
+ (Bg RÍWx - RsaBg + Bw) Wi + Bg Gi	(39)
Á = Bg Ag	(40)
e A 9 = Bg A 7	(41)
A. equação (38) se torna:
Oi APi + O; AP; + Oi AP* + Oi APi + OjAPj
	  dp		 f- OiApi -f- Ag = As....................(42)
0 equação (39), e —— deve ser entendida como:
(P°H-p°‘o) ou (P«~p.o)
(íi - t0)	’ Aí
Desse modo, a eq. (42) é a equação final para a solução da pressão. Um detalhamento maior implicará, daí em diante, no conhecimento da técnica de solução numérica a ser utilizada.
A importância de pararmos a dedução da equação neste ponto se liga ao fato de que, se um programa » para computadores é escrito para gerar os çoeficen-tes (0’s e A's) da equação (42), esses coeficientes ■ são gerais, podendo ser utilizados para qualquer técnica de solução numérica. Este procedimento facilita expressivamente a generalização, permitindo fácil introdução de processos novos ou experimentais de solução.
O termo A na equação (42) é agora:
As = Vb&lt;l&gt;SsB0-jp-
+ (Raw - Rtwx) Wt APt^ + (RBW -
-	Wi	•
+ Bg (Gt AP$g„x + ^Pigax + Gi ^P+c00y
+ Gg AP-^ + Gt AP*gOz + Gi AP-Q}
+ {Bo (NípÍrx Ah:x + Níp~orx Ahx + N$ptBy Ahy + NhP^Rg Ah~y + NIpZr. Ahi + N~zpír, Ahi)} .
+ {Bw (WÍPwrx Azi — WipãRx Azi + WypÍRg AZy ~ WyPwRg AZy + W^R, Aht ~ W^R; Aftj)}
+ {Bb {(Rtx - R.) NípÍrx + (R%Wx .
-	Raw) WxPwrx + GÍPgRx} Aht
4- Bg {(Rtx — Ra) Nípírx + (RlWx
Rsw) 1FxPwRx 4" GxPgRx ) Ahx
+ Bs {(RÍU - R.) NtpUg + (RIw„
-	Rsw) WÍPÍRg + Gtp+gRv } Aht	.
+ Bg {(R^y — Rs) NtPtRy + {Rlwy
Rsw) WyPwRg 4“ GyPgRy } Ahy
+ S° dPg\Bg)j+ y^OriBC/
(43)
Observe-se que esses termos são devidos à ccmpres-sibilidade do óleo, água, gás e rocha, respectivamente. O termo A9 na equação (42) é agora:
Ag — (BOGOg 4“ BwQwp 4“ BgQg^
+1 v^swBw-^ (^)
- BwWtAP-CoWx 4- WiAP~Cow + WtAP-CoWx
4- W-yAP-g^ 4- WtAPÍ0Wz + W-zAIGoa)
VhóSwBg	dRSW	dP„oa
Bw	d.Pw dt
4- Bg{ (Rm - Rtwx) W+x APt0Wx 4- (Rsw ~ Riwx) Wü AP-CoWx	■ '	_
4- (Rsw —Rtwy) Wt AP)ow„ 4- (Rsw '	.
RsWy) Wy AP~C	'	.
4- Bg {(Rtz - Rs) NípÍrx 4- (RL,
- Rsw) WtptR, 4- Gip+BRX} Aht
4- Bg {(Ri, — Rs) R~zP1r, 4- (Rsw,
Rsw) WtpwRx 4- GtpgR^t A/?-,	*
(44)
As chaves { } foram colocadas para isolar os os termos que são primordialmente devidos à pro-dução/injeção, pressão capilar óleo/água, pressão capilar gás/óleo, bem como às forças de gravidade.
Devido ao fato de representar a pressão capilar uma função da saturação, sua derivada em relação ao tempo deve ser aproximada pelo intervalo de tempo prévio, e não pelo atual. Isto é motivado por razões de economia de tempo de computação:
BPcoa _ Pcnwig	Pcnwt_,	
dt	Aí0ld	
dPcao	Pcfjdfa	Pcao/__^	(45)
dt	Aíoid	
ende A/olu = í0 — í-i
A validade dessa aproximação será discutida posteriormente neste artigo.
As diferenças de pressão capilar que aparecem na equação (44) provêm das derivadas em relação ao espaço das pressões na água e nò gás.
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:------------.-----------------------------------------------------------------------------------------------------------------—
B. téc. -PETROBRÁS, Rio de' Janeiro, 17 (3) : 193-224, jul./set. 1974
£^Pcawz ~	= p	- coto~ u 0	- p x cOWq&gt;
&amp;amp;PKox -	= ’	■ PeO»o’
	= Pc003 '	- P‘"a&gt;
tNPCÍOy =	= Pc0Oi '	~ Pco°o’
AP^ =	= P^ "	~ Pc0O0&gt;
AP“ffOl =	= PcOO-ò '	~ PcO°o’
^■Pcto-. -	= Pcí°s ~	- Pcao0&gt;,
(46)
Uma vez calculadas as novas pressões, a próxima etapa será calcular as novas saturações, o que é feito explicitamente, usando-se as novas pressões. Uma, vez que temos 3 saturações a calcular, devemos . ter 2 equações distintas. A terceira saturação é obtida a partir da equação (20), isto é So + Sw + + = 1.
Existem 3 equações que poderíam ser usadas:
1)	Equação do óleo, (11);
2)	Equação da água, (12) ; e
3)	Equação do gás, (19).
Escolhemos as équações do óleo e da água para evitar a complexidade da equação do gás.
Se a equação (11) for re-deduzida sem separarmos as derivadas dos termos envolvendo as propriedades de PVT, o resultado será:
àz + qop
ÔP O
b0	dt
(47)
Desmembrando-se essa equação segundo um procedimento análogo ao usado na equação da pressão, obteremos:
àtB0. (	■	-	..
j W (AP++.p0^ A/zj) . ' •; ' ■ -
+ (APãH-Põb2 A/iJ) } ... :
+ {Aí (àPi + ptRy A/zJ) + Ny (àP-y
+ P~oRy A/z;)} + {Ni (àPi + piRs àhi)
+ Ni (APi + pírs Áhi) } — qop
_ SoVldoTieÇf	í P°‘l ~ P“lQ )
Bo	( Aí	J
RoAí J
Na equação (48) o subscrito ti indica que as novas pressões foram usadas para o cálculo das respecti-. vas variáveis. Em todos os casos cs termos em Ap se referem às novas pressões. .
Este processo de computação dos volumes de óleo novo e passado, nas pressões novas e nas passadas, cria, obviamente, um desajuste dos coeficientes na equação de solução da pressão. Em outros termos, a seção correspondente ao óleo da equação de pressão não se ajusta com a equação da saturação de óleo. Várias tentativas de dedução da equação do óleo foram tentadas e a empregada neste trabalho mostrou-se como a forma mais estável e precisa para aplicação em técnicas explícitas.
Uma opção similar não existe no manuseio da equação da água. Isto é devido ao fato de ter a pressão capilar (uma função da saturação de água) de ser conhecida no novo nível de tempo, a fim de ser possível calcular as novas pressões na água.
O cálculo explícito das novas saturações de água não é possível. Desse modo, a equação da água deve ser desmembrada exatamente dó mesmo modo como foi feito para a seção da água na equação da pressão. Então a saturação de água é calculada de:
SWl = Sw +	/ Wi çàPtx - APU
1	Vb&lt;t&gt; (.	'■
+ A/zí) + Wx (AP^ — APiaw + pwRx A/ia) + w+ (àPiy - áPi0Wy + ptBv A/4)
■ + Wy (^Põy ~ ^^Cowy + Putty ^lv)
+ Wi (àPi, - &amp;amp;PÍ0Wz + pÍRi A/z|)
+ TFí (AP;.. — APí^ + pwBz Aàl) — qwp
_ 8mV&amp;amp;c/0orig / P°ii ~ p°*o \
Bw \ Aí /
- {SwVb4&gt;
(49)
Todos os termos AP usam somente as novas pressões.
Os procedimentos usados para desenvolver as duas equações de saturação 'foram testados extensivamente.
O alto grau de linearidade do fator volume de formação da água versus pressão indica que o ajuste
Conforme se mencionou anteriormènte, o processo básico de cálculo consiste ém utilizar a equação (42) para obter as novas pressões no óleo em cada célula do sistema, após o que as equações (48) e (49) são então usadas' para determinar explicitamente as novas saturações. Desse modo os valores da pressão e da saturação são levados para o novo tempo.
Importante se torna observar que a equação (42) reverte automaticamente para fluxo de uma ou duas fases quando as demais estão ausentes. Se o processo de reversão é observado no programa de computador quando considerando cada célula, então a eficiência pode ser melhorada pela eliminação de uma das soluções de saturação.
5	— CÁLCULO DOS COEFICIENTES
A discussão prévia indicou um modo de desenvolver as equações de fluxo para serem usadas num simulador de fluxo de fluidos. Todavia, parte importantíssima ainda não foi abordada; trata-se das técnicas para o cálculo das funções que dependem de pressão/saturação.	.	.
Como não existem soluções exatas para o fluxo multifásico que possam ser usadas como elementos de comparação, por conseguinte torna-se necessário adotar conceitos, intuição e erros totais de balanço de massa, para verificar o grau de precisão de um. esquema particular.
A experiência tem mostrado que os procedimentos a seguir são necessários durante o desenvolvimento das fases experimental e de debugging.
1)	Utilização de técnicas de solução absolutamente confiáveis e que tenham encorpados esquemas para a verificação da precisão residual da solução das equações de diferenças finitas. Recomenda-se também o uso do método de eliminação de Gauss com troca de linhas e também a capacidade de iterar na precisão residual. A aplicação de qualquer outra técnica de solução de alta velocidade e única passada, tais como o ADIP ou ADEX, pode fornecer resultados enganadores.
2)	Desenvolvimento de vários pequenos problemas, nos quais pelo menos 1 (um) ponto dos resultados é ou intuitivamente óbvio ou conhecido. Exemplo: uma malha vertical em 2 dimensões, na qual originalmente tem água no topo e óleo ha bsse. O perfil final de saturação devido à pressão capilar é conhecido. O uso de simetria espacial, que requer resultados simétricos, auxilia bastante na verificação dos mesmos. Outro exemplo seria um sistema de malha contendo um par de poços com vazões de produção ou injeção iguais e locados simetricamente. Uma rotação do sistema de malhas frequentemente auxilia na localização de erros de pro- ■ gramação.
3)	Uso de precisão dupla para o caso de qualquer cálculo que possa estar sujeito a. grandes erros .de arredondamento.
4)	Insistência numa precisão máxima para o'
balanço de massa. Precisões da ordem de IO-7 por cento da fase original presente no sistema-são comuns em problemas-testes.	.
0 cálculo dos' coeficientes pode ser separado em dois tipos: os com variáveis dependentes da pressão e os com variáveis dependentes da saturação.
As variáveis dependentes da pressão são as funções dé PVT: fatores volumes de formação, viscosidades, razões, gás/óleo de solução, pesos específicos e as derivadas dessas funções. .	. •
, Elas aparecem na equação (44), tanto como valores definidos num ponto como com subscritos direcionais.
A eliminação desses subscritos aumenta a simplicidade das equações, por permitir o cancelamento de termos; todavia esse procedimento também acarreta um aumento no erro.
As funções de PVT sem subscritos são calculadas a partir- de tabelas, na pressão correspondente ao início do intervalo de tempo dentro da célula que se está calculando. Em outras palavras, se a equação em diferenças finitas para a célula (1, 2, 3) está sendo calculada, a pressão a í0 para a célula (1, 2, 3) é utilizada. Para funções com subscritos direcionais, o valor médio da função na face correspondente da célula é usado.
Como exemplo temos:
Rtx = 0,5 (R„o + R,t)
e
RrSx = 0,5 (Rso + ü.3)	-
A única exceção a esse processo é a viscosidade, considerada como uma parte integrante da mobilidade. .
O peso específico das fases líquidas do reservatório é computado como:
para unidades dadas emmd, pé, cp, psi nas equações utilizadas.
As. derivadas das funções de PVT são calculadas em cada ponto, a partir das tabelas de dados. Uma tabela é gerada e. então interpolada por processos usuais.	-	'
Desde que as funções de PVT são avaliadas nas pressões antigas, váfios erros podem ocorrer. Os mais graves aparecem quando as funções de PVT são. descontínuas, tais como na pressão de bubble point.	...	•	'
Alguns métodos para estimar com precisão qual a nova pressão no fim do intervalo de tempo tornaram-se por conseguinte necessários. .
A experiência tem indicado que problemas práticos raramente réquerem esse refinamento. Quando acontecem, a dificuldade pode ser economicamente contornada, diminuindo-se o tamanho do intervalo de tempo.	'
As variáveis dependentes da saturação são a permeabilidade relativa e a pressão capilar.
A pressão capilar é tratada analogamente à pressão no óleo, com um valor médio para cada célula. Novos valores são computados em cada intervalo de tempo, usando-se as saturações antigas (Sw, SB) em to dentro da célula.	.
Em relação ao tempo, as derivadas da pressão capilar são consideradas iguais às variações computadas no intervalo de tempo prévio, divididas por esse mesmo intervalo;
Em outras palavras, as derivadas se encontram sempre um intervalo de tempo atrasadas. Este processo está, cértamente, sujeito a apresentar erros, todavia pequenos, porque as variações de saturação são também pequenas durante um intervalo de tempo normal.
Importante se torna compreender que este erro é. fundamentalmente um retardamento nos efeitos da pressão capilar.
A iteração em cada intervalo de tempo permite uma atualização das saturações, de tal forma que os fenômenos são colocados corretamente no tempo.
Todavia os resultados de vários problemas indicaram diferenças desprezíveis entre os métodos em que valores antigos são usados e aqueles com iteração para correção.
A avaliação dos coeficientes de fluxo, exemplifi-ficados pelas equações (35) a (37), é melhor realizada pela avaliação de vários fatores.
A equação (38) envolve coeficientes tais como Ni, quê pode ser escrito como:
«- (íí (^r)&amp;lt;5i&gt;
(CA k \ +
■—) depende somente de dados de variáveis espaciais, as quais não variam com o tempo.
Tais fatores podem ser computados somente uma vez na parte de inicialização e armazenados, para uso quando necessário. O superserito (+) indica que esta qúaritidade depende de dados de duas células, célula 0 e célula 1.
Para prevenir possíveis ano'malias na geometria de sistemas de malhas e na permeabilidade, este fator é melhor calculado da seguinte maneira: ( C^k* V = c í 0,5 Arp - , - 0,5Ari \ Az /	\ Aí/oAzofczg ‘ AyiAzj/Cn /	"
O valor para a mobilidade do fluido kTtp, para o fluxo entre duas células, é selecionado como o valor da célula da qual emana o fluido. Em outras palavras, se o fluido está escoando da célula 0 para a 1, então kr é obtido da saturação existente na célula 0, e p da pressão da célula 0.
Isso requer o cálculo da queda de potencial entre células para cada fase. É fora de dúvida que os potenciais no começo do intervalo de tempo são usados. Ressaltamos novamente que a consideração imprecisa dos dados no início do intervalo de tempo pode ocasionar erro.
Por exemplo, uma seleção incorreta da mobilidade pode resultar em saturações ligeiramente menores que a residual. Todavia, usar outros esquemas tais como a permeabilidade relativa média entre duas células pode conduzir a saturações menores que zero ou maiores que um.
A seleção da mobilidade acima mencionada deve ser feita separadamente para cada fase. Isto possibilita um calculo correto do fluxo, em contra corrente quando tal fato ocorre.
Uma vez decidido o processo de seleção de mobilidade, permanece ainda, o problema da saturação. Se a saturação média da célula é usada, a solução considera, então, que os fluidos estão completamente misturados dentro da célula.
E também possível considerar ■ segregação de fluidos dentro da célula e computar a mobilidade das zonas segregadas. Dentre as- opções encontradas, consideramos de maior utilidade:
1)	completamente misturado;
2)	completamente segregado;
3)	completamente misturado entre o contato óleo/água original e o contato gás/óleo original; e
4)	qualquer fração entre os itens (2) e (3).
Este cálculo da saturação da célula pela mobilidade é baseado em simples balanço de materiais.
A saturação média da célula no início do intervalo de tempo e informações conhecidas, tais como as dimensões da célula, localização dos contatos originais gás/óleo e óleo/água na célula, constituem todos os dados necessários.
Note-se que a permeabilidade relativa é a única variável nas equações de fluxo onde uma pseudo-di-mensão aparecerá. Daí, então, incluir uma pseu-do-dimensão é simples e econômico. Vale a pena permitir várias opções para o cálculo da mobilidade, a fim de aumentar a flexibilidade do programa. Exemplo: reservatórios com um bottom water drive podem freqüentemente ser modelados com precisão em duas dimensões, e com uma pseudo-terceira usando-se a opção de cálculo da mobilidade completamente segregada.	■
Os procedimentos de cálculos apresentados são baseados em dados conhecidos no início de um intervalo de tempo. , O resultado é que as equações fundamentais de fluxo não-lineares são linearizadas
para cada intervalo de tempo, considerando-se permanecerem constantes seus coeficientes. Os resultados serão precisos para pequenos' intervalos de tempo, porém diminuirão em precisão à medida que forem os coeficientes deixando de representar o comportamento médio através’do" intervalo de tempo. Isto acarreta uma restrição no tamanho do intervalo de tempo, baseada, principalmente, ha variação de saturação, que permitirá valores práticos para o intervalo de tempo, porém aproximará ainda o problema não-linear.
Experiências realizadas com vários problemas indicaram. que se a variação máxima de saturação dentro de cada célula for inferior a 4% teremos resultados representativos.
$	Variações de saturação da ordem de 8% por
intervalo de tempo têm sido, todavia, usadas com - sucesso. Desde que a solução estrita do problema nãó-linear requeira iteração para obter coeficientes precisos, a computação necessária aumenta drasticamente.
A economia dc computação pelo uso da forma linearizada, mesmo com um intervalo de tempo por demais restringido, supera consideravelmente o pequeno erro cometido.
6	— SOLUÇÃO DAS EQUAÇÕES DE SIMULAÇÃO DE FLUXO DE
3	FLUIDOS EMISCÍVEIS
mente, coluna por coluna, linha por linha, ou mèsmo numa forma ponto por ponto, de acordo com a técni--ca de solução numérica adotada.
Um programa que possa gerar coeficientes em diferentes formas tem uma conceituação simples, porém importante, pois que ela permitirá fáceis modificações ou inserções de métodos experimentais.
i
6.2	— FORMAS FINAIS DAS DIFERENÇAS FINITAS
A equação (1), quando considerada em apenas uma dimensão, se torna:
0-^P~ + OiAPí + A10 = Au (	(2)
Usando-se o mesmo sistema de coordenadas dado anteriormente, teremos:
	2		
3	0	1	
	4		
6.1	— EQUAÇÕES EM DIFERENÇAS FINITAS, MA TRIZES E DEFINIÇÕES
A equação final em diferenças finitas que havia sido desenvolvida anteriormente para a solução da pressão era a equação (42):
01AP+ + O;AP; + OtfM* + OyàPy + OJAPt
+ O;AP; + Ag = As
e recordando as definições: .
APJ = Pi — Pq
àP^ = P3-Po	(3)’
a equação (2) se transforma em:
OlPs - (Oi + 0;) Po + OiPi + A10
— An
(4)
Consideremos para efeito de análise apenas 2 » dimensões:
OiAPi + 0;AP; + O+APJ + OyàPy
onde as pressões, tanto na equação (42) como na (1), se referem à pressão no óleo.
Contrariamente à opinião popular, a simulação econômica requer o desenvolvimento de vários métodos de solução, ao invés de se manter em um único apenas. É óbvio que isso exige um subprograms para geração dos coeficientes (A'P e 0'S), que o escreva como uma entidade distinta e separada do programa principal. Além disso, torna-se às vezes . necessário obter-se esses coeficientes automatica-
3
B. téc. PETROBRÁS, Rio de Janeiro, 17 (3) : 193-224, jul./set. 1974
Como os valores dos coeficientes 0 e A já foram computados com base nas pressões e saturações a Zo (o fim do intervalo de tempo anterior), neste ponto do processo de computação aqueles coeficientes são números reais.
A próxima etapa será colocar superseritos indicativos do nível de tempo em todas as pressões ÇP), na equação (4), para indicar quais delas necessitam ser computadas.
Se usarmos o superserito n para os valores conhecidos no fim de cada intervalo de tempo, e n + 1 para aqueles a serem computados no fim de cada intervalo de tempo, uma forma possível para a equação (4) será:
(pn-f-1   pn jT q	Jl q
OU
P^ = {oiPl - (ot + Oi
+ -^)pS + ^P? + Ao} ‘	(5)
Este método é chamado explicito, por poder ser usado para calcular uma etapa à frente em tempo, usando-se somente os valores antigos no tempo n.
A solução da equação em diferenças finitas aproxima-se da solução da equação diferencial (isto é,
converge) se
Ai (Ar)2
&amp;lt;0,5 e a superfície de pres
são for suficientemente uniforme.
Este método é correto nas derivadas espaciais até a 2a. ordem, e, quanto ao tempo, ha la. ordem.
A restrição no tamanho do intervalo de tempo é necessária para assegurar a convergência; isto faz com que o método seja pouco usado para trabalhos gerais de simulação de fluxo de fluidos. Todavia deve ser observado que o trabalho de computação requerido por esse método de solução numérica por intervalo de tempo é pequeno. Um cálculo da equação (5) é feito para cada bloco do sistema de malhas.
Para remover a restrição do intervalo de tempo, todas as pressões podem ser colocadas no novo nível de tempo, como:
(pn+X _ pn \
—.......6 * * 9.) = O;Pr1 - (Oí + Oi) P^1
+ OiP^ + Aw
ou
0-xP^~(0i + 0iA
Aí /
P^1 + 0iP’p1
AuPÔ\
Aí /
(6)
Torna-se óbvio que a eliminação total de restrição ao tamanho do intervalo de tempo é impossível, porque os coeficientes, embora linearizados ainda, são função da pressão e da saturação. Todavia, a restrição imposta à convergência foi removida. Este procedimento é denominado implícito. Enquanto que o método explícito permitia uma solução separada de uma equação por célula, o implícito exige a solução simultânea de todas as equações. Por exemplo, um sistema de malhas com 10 células exigirá solução simultânea de 10 equações para as
10 novas pressões. Este é o método geralmente usado. Posteriormente discutiremos três técnicas para determinar a solução do problema em foco.
O método implícito é correto até diferenças de 2a. ordem em espaço, e de la. ordem em tempo.
A exatidão do método implícito podería ser aumentada usando-se a chamada forma Crank-Ni-colson.
+ A io .	(7)
Ele é correto até diferenças de 2a. ordem em espaço e também de 2a. ordem em tempo no ponto í^i/a.
Um requisito frequentemente esquecido desta forma é o de um elevado grau de uniformidade da superfície-solução (p). Descontinuidades criadas por pressão capilar e rápidas mudanças nas vazões dos poços impedem sua aplicação a problemas gerais de simulação de fluxo de fluidos.
Vários outros métodos existem em disponibilidade, sendo o mais popular de todos uma combinação dos métodos explícito e implícito, quando se tratar de solucionar problemas multidimensionais.
O Procedimento Implícito em Direções Alternadas, Não-Ilerativo (ADIP ou ADI) tem, em 2 dimensões, a forma:
0;p^x/2 _	+ Qi +	P^k + OiPS1/2
— _ {rí. JO + OyPz — (Oy + Oy
- -^-)ps + o;p2}	(8)
para o cálculo de uma linha num intervalo de tempo, é:
OyP^1 - (oj + o-+ps"1 + ojpr1
= - {a 10 + o^pr1/2 - (oí + oí
-	p^- + OiPi^-}
(9)
para o cálculo de uma coluna num intervalo de tempo.
O processo consiste em calcular todos os novos valores no nível n + 1/2, num procedimento linha por linha, e, por conseguinte, os novos valores a n + 1, num procedimento coluna por coluna. Cada linha ou coluna requer uma solução implícita para todos os novos valores ao longo das mesmas. Devido ao fato de levar em conta a solução somente uma linha ou coluna de cada vez, pode ser ela realizada .de forma eficiente e rápida, usando-se o método de eliminação de Gauss.
0 método ADIP tem, todavia, duas grandes restrições quando aplicado à simulação geral de fluxo de flüidos. Primeiro, a combinação das equações (8) e (9) para um intervalo de tempo completo dá uma equação similar à forma de Crank Nicolson. O resultado das médias dos intervalos de tempo cria instabilidades na superfície de pressão nos pontos de descontinuidade, tais como aqueles criados pela, pressão capilar. Segundo, consideraram os autores e outros que problemas de fluxo multifásico em multidimensões com tamanho de célula não uniforme levam a resultados mais eficientes e confiáveis quando resolvidos por métodos iterativos.
Outro método popular é o Procedimento em Direções Alternadas 'Explicito (ADEP ou ADEM).
No caso bidimensional, ele toma a forma:
A10 + (^--Oí-O^Pg +
+ P? + O; P^1/2 + Ot Pl+ 0; p^2
(10)
para uma progressão célula por célula (da esquerda para a direita), começando no canto superior esquerdo da malha e seguindo para baixo percorrendo linha por linha. Completa-se o intervalo de tempo começando-se, de cada vez, no canto inferior, subindo-se depois até o canto superior esquerdo da malha, usando-se a seguinte equação:
a10 + -ox- pn^2 + oípr1
+ o;pri/2 + Oí-P^1 + O«P2+1/2 J
(ii)
Contrariamente à opinião popular, os autores e outros consideraram este método inferior na simulação geral de fluxo de fluidos. .
Eles acharam ser a técnica implícita, como é apresentada na equação (6), superior no caso de aplicações generalizadas. Daí, então, a razão de se aplicar somente a forma implícita a todas as discussões que serão feitas posteriormente neste trabalho.
6.3	— 0 PROBLEMA MATRICIAL
Uma malha de diferenças finitas para um pequeno problema unidimensional pode ser exemplificada como abaixo:	.
12	3	4
Para limites externos fechados, a equação implícita, no caso deste problema, seria:	,
Bloco 1:	’
+ (oi + ox + pr1 - (oytPr1
Bloco 2:
-	m a Pr1 + (
-	^)3p4n+1 = í
-	(ox)2 p?+1 + (o: + ox + pr1
-(OJ)2P^ = (^±^Í^	.
Bloco 3:
oj + os+^pr1
A10 + Ag P3 \
Aí J3
Bloco 4:
-	mi pr + (ot + o-+pr1
_ ( -^io d~ Án -P”
\ Aí
Se forem esses termos definidos como:
Oí = (O®)» ; bi =	+ Ox d—j = (O»)»&gt;
+ Aí A ’
(12)
[M]	[P]	= [rhs] ■
Observe-se que cada linha da matriz (equação 12) define uma equação separada para uma célula do sistema de malhas.
O problema unidimensional poderá ser expandido para um bidimensional e as células numeradas como a seguir:
B. tée. PETROBRÁS, Rio de Janeiro, 17 (3) : 193-224, jul./set. 1974
A representação para esse problema, em forma de matriz, assemelhar-se-ia a:
6i	—ci	0	0	—«1				
	32	■	62	—c2	0	0	—62			
							—0-	
0	—03	■ 63	—C3	0	0	—63		
0	0	—04	64	0	0	0		64	
—A	0	0	0	65	—C5	0	0		65
	—A	0	0	—06	6e.	—CO_	0	0		Ce
	—0— '•			-0—				—0—
		-/12				—012	- 612 ’	
Observe-se no caso de duas dimensões a existência de 3 diagonais centrais com duas diagonais externas (e's e fs), criadas pela extensão do sistema.de numeração para as duas dimensões.
A área dentro das diagnonais externas forma o que conyeneionalmente denominamos de banda-, .a partir do extremo noroeste ao sudeste; daí . o nome matriz
de banda. De modo análogo, a matriz para o problema tridimensional tom 7 (sete) diagonais, sendo que as duas últimas surgem corno resultado da inclusão de duas direções adicionais de fluxo (4- z e - 2).	.	■	'
A descrição dessas matrizes aparece freqüente-mente na literatura com a notação:	■
011	012	013	014 ■
C21	&lt;792	023	
dm2
				—•	' —
G-ln		P1		61
		p2	= .	&amp;amp;2
dmn		pm ■		
			 __		— 	
o-l ■ [4] [Pj = [fi]
(14)
onde o l.° subscrito indica a linha i e o 2.u a coluna j.
Desde que o número de equações seja sempre igual ao número de incógnitas, m = n, a matriz [A] é _ quadrada. Todas as entradas da matriz [A] são reais, ao invés de complexas. [A] é também diagonalmente dominante, porque:
■	| ai&gt; í | zC \aí! j|	(15)
..	3~ 1
para todos os valores i.	‘
Isto é aparente se considerarmos o problema dado como exemplo uni dimensional, onde os elementos da diagonal principal foram definidos como a soma dos elementos fora da diagonal com o termo positivo à derivada da pressão em relação ao tempo.
A medida que o termo devido ao intervalo de tempo ãecresce, ou tende para zero, a equação diferencial
toma-se cssencialmente elílipa, ao invés de parabólica. Grandes intervalos de tempo, baixas com-pressibilidadcs e valores relativamente grandes para -os O's podem dar origem a essa mudança.
A razão de levantarmos aqui o problema, prende-se ao fato de deverem as técnicas gerais de solução desenvolvidas a seguir ser aplicáveis à solução tanto de equações elíticas como de parabólicas.
A matriz [A] seria simétrica se Uj,; = aj,i .. .(16) para todos os valores de i e j. Uma evidência de que isso não acontece no caso em questão provém dos valores de O. Essencialmente, a distribuição das funções, de PVT dentro da equação é tal que os termos de fluxo entre duas células são multiplicados pelas funções de PVT avaliadas na célula em questão.
Daí então no exemplo unidimensional
(Oí)2. O resultado imediato disso é que a Matriz
[Ã] não é nem Hermitianà (obs.: uma matriz quadrada [A] tal que sua conjugada transportada [A'] = = [A] é chamada Hermitiana) nem positivamente definida (obs.: uma forma quadrática real não singular q = X'AX, jA[ 7^ 0emnvariáveiséchamada positivamente definida se seu rank for igual ao índice).
0 uso de técnicas iterativas de alta velocidade, tais como o ADIP iterative, é, por conseguinte, duvidoso.
Mas a matriz costuma ser, com freqüência, tão. próxima a uma matriz simétrica, que acaba por possibilitar o uso dessas técnicas.
6.4~ PROCESSO GERAL DE SOLUÇÃO
- O processo geral de solução constitui-se em resolver a equação matricial
[2] [P] = [B]	(17)
obtendo-se novos valores de pressão no vetor P. Antes de se proceder, porém, às técnicas individuais, torna-se necessário considerar os aspectos do hardware do computador, que será utilizado para computar qualquer solução.
Os autores, devido à experiência adquirida, consideram que a melhor maneira de atacar o problema consiste em converter a equação (17) em uma forma “residual” como: definindo ...............
B = P* + e	(18)
onde P* = valor inicial estimado para as novas pressões, e
e — erro entre o valor inicial estimado e a resposta final.
Substituindo-se a equação (18) na equação (17) teremos:
[A] [p*J + [A] ,[e] = [B],
ou
[A] [e] = B - [A] [P*J,
ou
[A] [e] = [r].	’	(19)
onde o vetor r é o erro residual.
Os valores para r são computados em precisão dupla durante a geração dos coeficientes, usando-se as pressões antigas.
Uma técnica de solução de matriz é então usada para determinar o vetor e em precisão simples. A soma final usando a equação (18) é feita então em precisão dupla. Se a precisão desejada não é obtida, novos resíduos podem ser computados e- o processo inteiro será repetido.
O resultado óbvio é uma solução que pode ser feita acuradamente além da precisão normal. Um pequeno aumento de precisão se verifica se o- processo interno é realizado usando-sé unicamente precisão -simples. O ponto aqui consiste em que se as rotinas
de solução numéricas são codificadas para trabalhar com a equação (19) ao-invés da equação (17) urna grande precisão pode ser obtida quando necessária
A próxima etapa será a seleção de inúmeras técnicas de solução numérica para programação. A primeira a ser selecionada será a Eliminação de Gauss. Ela é muito útil para a solução de pequenos, problemas, digamos,' que envolvam um máximo de 400 células e de grande ajuda na fase de depuração das técnicas mais rápidas.
Não é normalmente usada em problemas multidi-mensionais, contendo alguns milhares de células devido ao grande tempo de computação que requer..
O processo de eliminação de Gauss será discutido nas seções a seguir.
Usando-se as propriedades das matrizes que foram discutidas nos parágrafos precedentes, podemos selecionar para prohlemas multidimensionais técnicas de alta velocidade. Uma vez que a “sucessive overrelaxation” (SOR) requer essencialmente apenas que a diagonal seja dominante, para que o processo seja convergente, é um método que apresenta atrativos para seleção. Tanto a sobrerrelaxação por ponto, como em linha ou em bloco, podem ser usadas. Os autores selecionaram o processo de SOR em ponto e em linha, cada um deles de mais eficiência, dependendo do problema particular sob apreciação.
O SOR. por ponto mostra-se vantajoso quando o sistema de malhas é essencialmente uniforme.'
O “line SOR” é algo mais lento para esses casos, todavia é muito mais rápido para sistemas aniso-trópicos. Como um exemplo, o estruturamento' em malha de uma seção vertical freqüentemente resulta em grandes coeficientes na direção Z. Esse’ problema poderia ser resolvido pelo SOR por ponto, porém como os eigenvalues da matriz seriam normalmente próximos do valor 1,0, teríamos como resultado um grande número de iterações para oter-mos convergência. O mesmo problema pode ser rapidamente resolvido, com o SOR em linha, de modo tal que as linhas que são para resolver correspondam à direção Z. -Essa mesma analogia se mantém para problemas em três dimensões. Descrição mais, detalhada do SOR é'feita nas seções que seguem.
Outro método de alta velocidade e considerável valor é o ADIP iterative. Requer essencialmente uma matriz do tipo positive definite, para que a convergência seja garantida.
Infelizmente, -a forma geral da matriz [A] não é positive definite. Todavia, a expérieneia tem mostrado que . esse método é geralmente convergente quando aplicado a sistemas isotrópicos em duas dimensões; e que apresenta maior rapidez de resolução que o SOR, nesses casos. Entretanto tem sido provado que sua aplicação é antieconômica para problemas que considerem 3 dimensões ou aniso-trópicos, casos bidimensionais tais como seções verticais, etc. Mais adiante discutiremos com pormenores o ADIPIT.
Outros esquemas existem que podem ser usados • para resolver o problema de fluxo de fluidos. Todavia a experiência dos autores, resolvendo problemas de equações de simulação de fluxo de fluidos, aconselha os três métodos anteriormente descritos como apropriados para uma simulação econômica. 6.5 — A TÉCNICA DE ELIMINAÇÃO
DE GAUSS
A eliminação de Gauss é, sem sombra de dúvida, o mais confiável dos métodos numéricos que se pode escolher para resolver o problema matricial exemplificado pela equação (13).
Um caso especial da equação (13) é visto na equação (12), a matriz tridiàgonal. Essa matriz particular aparece não somente em problemas envolvendo sistemas lineares de diferenças finitas, mas também em vários outros métodos de solução, tanto iterativos como não-iterativos. Desse modo, quando se desenvolve um simulador de. fluxo de fluidos, convém ter disponível um subprográma que possa ser utilizado sempre que aparecer um problema com matrizes tridiagonais.
O algoritmo é um caso especial para tratar matrizes de banda. Ele é equivalente ao algoritmo apresentado por Peaceman e Rachfobd e será discutido a seguir.
Enquanto inexiste preocupação acerca da aplicação da eliminação de Gauss às matrizes tridiagonais, parece haver grande relutância em sua aplicação na solução de problemas multidimensionais em diferenças finitas.
O receio de que resultem grandes erros de arredondamento são as razões frequentemente apresentadas quando existem problemas de limitação da dimensão dos números; devido às características do hardware empregado.
Outra restrição feita é a de que os tempos de. solução não são razoáveis, devido à vplumosa aritmética associada com o método.
Essa- restrição, em última análise, torna-se intolerável, porém, não impede o uso desse método em pequenos problemas, ou o seu uso especial em estudos de fluxo incompressível e em outros testes com qualquer dimensão de malha.
Tanto, a velocidade como a precisão podem ser afetadas materialmente pelo modo de numeração das células de diferenças finitas e pela ordenação das equa-ções resultantes, antes de se efetuar a solução. Ê possível numerarem-se as células numa malha de diferenças finitas randomicamente.
O sistema de equações resultantes aparecería ainda como a matriz da equação (14) e seria, pelo menos em princípio, resolvível pelo método de eliminação de Gauss. Todavia, a quantidade de cálculos e erros de arredondamento é significativamente reduzida por ,um esquema mais sistemático.
Consideremos o caso de uma malha 4X7, numerada como na figura abaixo:
1	2	3	, 4	5	6	7
8	9 .	10	11	12	13	14
15	16	17	18	19	20	21
22	23	24	25	26	27	28
Se as equações de diferenças finitas forem propriamente ordenadas e atribuirmos a letra X para os coeficientes diferentes de zero teremos:
xxoooooxoooooooooooooooooooo xxxoooooxooooooooooooooooooo oxxxoooooxoooooooooooooooooo OOXXXOOOOOXOOOOOOOOOOOOOOOOO	l.a linha
oooxxxoooooxoooooooooooooooo ooooxxxoooooxooooooooooooooo oooooxxooooooxoooooooooooooo
xooooõoxxoooooxooooooooooooo
0X0	OXXXO	0X0	0	
00X0 00XXX0	0X0	0	
000X0	OXXXO	0X0	0	0	2.a . linha
0000X0	OXXXO	0X0	0	
00000X0	OXXXO	0X0	0	
ooooooxoooooxxooooooxooooooo
0	0X000000XX0 -		0X0	0	
0	0X0	OXXXO	0X0 0	0	
0	0X0	OXXXO	0X0	0	
0	'	0X0	0 OXXXO	0X0	0	3a. linha
O O OXO OXXXO 0X00 O 0X0 OXXXO 0X0 oooooooooooooxoooooxxooooooo
O	0X0 oooxxooooo
O	0X0 oxxxoooo
O	0X0 o oxxxooo
0	0	0X0	oxxxoo	■.	4a. linha
0		0X0	OXXXO	
0		oxo	-oxxx	
oooooooooooooooooooxooooooxx			
Contudo, o mesmo sistema de malhas poderia ser numerado como:
1	5-	9	13	17	21	25
2	6	10	14	18	22	26
3	' 7	■11	15	19	23	27
4	8	12	16	20	24	28
Neste caso, propriamente ordenados, os coeficientes da matriz teriam a forma:
	xxooxooooooooooooooooooooooo						
	XXX X	■ OXXX X OOXX 0 X			0	0 0 0	la. coluna	
	X	oxx	X ■	.		0		
	OX XXX		X	0	0		
	0	X XXX	X		0	2a.	coluna
	.0	X XX	0 X		0		
	0	XO XX	X			0		
	0	0 X XXX' X		0	0		
	0	X	XXX	X		0	3a.	coluna
	0	X XX 0 X			0		
	0		X -XX ’ X		0		
	0	0	X XXX : X	0	0		
	0		"V V V V	‘ * -A. AAA	.	X	0	4à.	coluna
	0		X XX 0	X	0		
	0		X XX	X	0		
	0	0	X XXX	X 1	0 0		
	' 0		X XXX	X		0	5a.	coluna
	0		X XX 0 X	0				
	0		■ X	XX	X 0		
	0	0	X	XXX	X 0		
	0			X XXX	XO ■	6a.	coluna
	0			X XX	0 X		
	0			X	XX 0		
	0	0		X	xxxo	7a.	coluna
	0			X	XXX		
y	oooooooooooooooooooooooxooxx						
Se alguém fosse tentar resolver manualmente ambas as matrizes por eliminação de Gauss (trian-gularização seguida por substituição em ordem ascendente), essa pessoa notaria um menor número de etapas aritméticas de significãncia. Note-se, então, que é a ordenação sistemática dás equações, bem como o padrão de numeração escolhido, que proporciona essa vantagem.	.
Na resolução manual de qualquer uma das matrizes do tipo banda, podemos notar, rapidamente, dois fatos: ) ’	:	'	■
1	— É totalmente desnecessário providenciar armazenamento (área na memória princi
pal) para os elementos das matrizes acima ou abaixo da banda.
2	— O número de linhas que participam do pro, cesso de triangularização para cada coluna é bastante limitado.
Especificamente, essè número de linhas é dado pela expressão:
,	&amp;amp;1 + 1 .	'
.	62 .	2	■ •
sendo bi igual ao número de colunas, representando-a largura-da banda original. Esses fatos podem-ser verificados por inspeção da forma da matriz trian-
B. tée. PETROBRÁS, Rio de Janeiro, 17(3) : 193-224, jul./set; 1974
O primeiro dos dois itens citados permite que se esboce uma versão altamente especializada da Eliminação de Gauss, em se tratando de matrizes de banda, onde a área de trabalho é retangular ,e usada
somente para conter a banda original, e, porterior-mente, a banda da matriz triangularizada. O segundo item, que trata do espaço adequado para permitir a permutação de linhas, caso necessário, combate os erros de arredondamento. Um algoritmo usando essa técnica foi publicado por um dos . autores .deste trabalho.
“VVWV
xxxxx	.
xxxxx xxxxx ' xxxxx xxxxx xxxxx xxxxx xxxxx xxxxx-xxxxx xxxxx xxxxx xxxxx ' xxxxx xxxxx xxxxx xxxxx
xxxxx xxxxx xxxxxo . xxxxx xxxx XXX ■ XX
O O O O - O
O O O O O O O O o o o o o 0 0 0
O
O
xxxxxooooooooooooooooooooooo oxxxxx
0
0
0
0
o
o
o
0
0
o
0
0
o
o
o
0
o
0
0
0
o
0
.0
o
o
ooooooooooooooooooooooooooox
Usando essa técnica juntamente com um critério apropriado de numeração das células, a tabela abaixo mostra as dimensões das áreas de trabalho necessárias para manusear vários sistemas de malhas.
Matriz Triangularizada.
Descrição da malha	N.° de equações	' bi	jj. ÁreaMe trabalho (palavras) t&amp;amp;fcM	'	-
4X7	- 28	9	252
9 X 10	90	-	19	1 710
20 X 25	. ...	500	41	20 5C0
70 X 60	4 200	121	508 200
20 X 25 X 2	1 ooo	-	81	81 000
20 X 20 X 10	4 000	401	1 604 000
Isso mostra como a necessidade de memória no computador aumenta incontroladamentè. No entanto, podemos usar o segundo item já mencionado, • e providenciar o armazenamento, em memória externa, daquelas porções, tanto da matriz original como da matriz triangularizada, as quais não estão sendo no momento utilizadas.
. A área de trabalho necessária torna-se, nesse caso, um trapézio com a seguinte descrição:
Onde o n.° real de palavras contidas é: bl + (6i - &amp;amp;2)2 /2.
Para os nossos exemplos de malha, aplica-se, então, a seguinte tabela:
.	Descrição da malha		N.° de Equações	. b;	b;	Area de trabalho (palavras)
	4X7	:	28 ’	9	5	' 35 '
	Q Y 10	-	■■	90	19	10 -	■ ■ 		145	- ’ ■
	20 X 25	Z	"	500	■ • -41 ■ ■	21	....	651
	70 X 53	.	4 203 .	121	61	5 551	.
	• • • •'"jJÕ	íiõ '-ZX" ’■sí •	- -			 ■	- - 1 030 - -	81	41.	7 501 	
	. .-2.Q. X-20. X.;10_	.	- -	4 000	• -401 -	- -201 ■ ■	• - . ..	60 501		
	■ ■■ ■ ■				
. Aqui, a necessidade de memória pode, eventualmente, passar de novo dos pontos exeqüíveis. Entretanto, constata-se facilmente que as capacidades de memória associadas às dimensões.das malhas.poderíam ser consideradas como’ adequadas para muitos problemas de simulação com vista à resolução pelo método de Eliminação de Gauss. Resumindo, podemos dizer que é o volume de cálculos que dita, sozinho, o limite superior dos problemas que podem ser eficientemente lidados com o método .de eliminação de Gauss.
. Como regra prática podemos recomendar o uso do ADIP iterativo ou do SOR, para problemas contendo mais de 400 células.
7	— SOBRERRELAXACÃO SUCESSIVA (SUCESSIVE OVERRELAXATION)
O SOR é um método iterativo que tem suas origens numa das mais antigas técnicas para resolução de sistemas de equações lineares algébricas,’ o método de Gauss-Seidel.
Ele foi estudado teoricamente, formalizado e publicado em 1954 por David Young. Discussões acessíveis sobre o SOR são apresentadas na maioria dos livros recentes sobre análise numérica. O tratamento dado por Forsythe e Wasow é recomendável, mas Varga e Wachspress são mais profundos em suas análises sobre o método e algumas de suas particularidades.
O método SOR goza de uma popularidade limitada na indústria do petróleo; Contudo ele tem-se constituído numa técnica de destaque no campo da física de reatores nucleares, onde. Varga e .Wachspress têm atuado mais .ativamente. . Razão possível liara a falta de popularidade do SOR na indústria do petróleo é devida ao fator dê sobrerrela-xação ser crítico em problemas de reservatório e à dificuldade de computá-lo economicamente. Adiante discutiremos um esquema satisfatório para estimar esse fator. A apresentação a. seguir trata principalmente dos aspectos computacionais do SOR. Os detalhes teóricos são apresentados propriamente na literatura acima citada.	.	’	■
7.1	— EQUAÇÕES DO MÉTODO SOR -
A equação (6)	.	■
o-x pr1 - (oí+o-x+Pg+1 + OpPR1
+ Oi e* -f- Oy e*)} + (w — 1) (Oy + Ox +
+ Oi + Oy +	«0
onde r0 é o resíduo para a célula 0 computada das pressões no nível de tempo anterior, como na equação (19).	,
Obs.: — Equação (19): [A] [e] = [rj. w é 0 fator de “ overrelaxaiion”, cujo valor se situa sempre na faixa- 1 &amp;lt;a &amp;lt;2; 60 e rl, respectivaníente, referem-se às estimativas das iterações k- e (k + 1)- da variação de pressão para os valores do intervalo de tempo que está sendo computado na célula 0.
Dedução da equação (20) para 0 caso umãimensional.
Seja a equação (6) previamente apresentada: o;Ps+1 - (o: + Ox +	P^1.4- Oi PR1
A^Pl \
At /
Como sabemos que todas as pressões incógnitas estão no nível de tempo, n -f- 1, retiremos o supers-crito n -f- 1 e consideremos ser a pressão calculada por um processo de iteração. Consideremos ainda que estamos justamente na. iteração fc + 1 para a célula 0, com o processo de varredura (sweep) indicado abaixo:
3	0	1
Seja de acordo com a equação (18) a pressão calculada em cada célula dada pela relação PR1 = Pi+1 + e';+1 (18); teremos:	.
Ox (P|+1 + Ê3+1) — (oí + Ox
+	(Po-1 + eãF1) + Oi {Pi Tb eí)
(I)
Fazendo-se transposição de termos teremos:
Ai/P" \
Aí /’
(oí + 0-+	= -{oíp^1
em forma residual para um sistema de malhas de diferenças finitas ém 2 dimensões é escrita para solução em SOR como:
~ (Oy + 0x + 0% + Oy  -J-j e^1 =
= w {?'o - (Oy e^1 + Oi e'V1 + .	:
- (0: + Oi +	P^1 + OÍP1
■ (II)
Chamando-se
+ (a10 + ^ps)	(III),
teremos:
-	(o* + Oz +	c^1 = r0 — Oz e3w - Oí ef
' (IV)
Somando-se e subtraindo-se ao lado direito dessa equação a expressão:
(O; + OÍ + 4j)e°	'
resíduo de iteração prévia, teremos:
-	(oi + Oi d—£o+1 = — ^Oz + Oí +
+ j 6q + -^r0 — Ox e3a — Oi 61
+ (o;+o:+^g-)eg|	(v)
Observe-se que a expressão entre colchetes representa o acréscimo dado ao valor de P por uma iteração do tipo Gauss-Seidel.
No método iterativo conhecido como Successive overrelaxation (SOR), procura-se dar um acréscimo superior ao admitido acima, e isto é feito multiplicando-se a expressão entre colchetes pelo fator de relaxação w, o qual, para a maioria dos problemas, situa-se entre 1 e 2.
Assim sendo, teremos:
-	(oz + Ox + eoi+1 = - (oz + Oí +
d—6q d- w ^r0 — c|11 — Oi ei
d- +	+	(VI)
ou fazendo transposição de termos:
-	(Oi d- Ox +	= w {r0 - (Ox e3ul +
d- OíeF1 +Oíef)}
d- (o - 1) (oz d- Oi d- 60*	(VII)
formã~unidimensional dá equação (20), previàmente citada.	-
O processo de SOR por ponto consiste, simplesmente, em percorrer a malha num modo sistemático (aqui o processo é resolvido aumentando-se x e y), resolvendo a equação (20) pára &amp;amp;F1 em cada célula. Note-se que ao ser.eF1 computado, o valor de 6o toma-se desnecessário, e seu lugar na memória pode ser usado para guardar e^1.
O processo de SOR por linha envolve o estabelecimento de equações semelhantes à equação (20) para todas as células de uma linha (ou coluna) de diferenças finitas, simultaneamente.
Por exemplo, supondo-se as linhas (direção x), as equações assemelhar-se-iam a:
Ox^1 - (Oi+Ox + Oi + Oí
+ ~-)6^ + 0^+1
= a {r0 — Oy eF1 — Oi e*} d~ fw — 1) ^Oy + Oz d- Oi d- Oi d-	6§ - Ox el - Oi 6?|	(21)
Pelo fato de eF1 relacionada a uma célula corresponder a eo+1 na célula adjacente, na direção — x, e, similarmente, a eí‘+1, na direção +x, a série de equações para uma dada linha da malha é simplesmente um sistema de equações algébricas lineares de resolução simultânea.
Sua matriz tem a forma tridiagonal ilustrada na equação (12).
Assim sendo, pode-se, rapidamente, resolver oa ei+1 em todas as células para uma dada linha.
"Uma iteração de SOR. em linha (varredura) consiste então ém tratar sistematicamente todas as linhas do modo acima descrito.
Tanto no SOR por ponto como no SOR por linha, o processo de iteração prosseguirá até que haja uma convergência satisfatória. Um teste de convergência simples, porém usuajmente apropriado, consiste em exigir que o valor máximo de | e3+1 —
—	6o | em todas as células seja menor do que uma dada tolerância.
O método SOR é facilmente adaptável para manusear problemas tridimensionais.
As equações correspondentes às equações (20) e
(21)	são, respectivamente, no caso:
—	(oí + Oz + Oz + Oi + Oi + Oi -j—-g" j eF1 =
= CO {r0 - (Oi cF1 + Oz 63i+1 + Oi eF1
+ Oi 6g 4* Oi 6i + Oi ef)}
+ (w — 1) (oi + Oz + O; + Oi + Oi + Oi
+ 4r)'s	-	(22)
+	Co1’1 + Oz^1 = *&gt; {í-o - Oye^1
4~ Ox É3*1 — Oi ej. — Oy e*}
+ (co - 1)
+ -...-£■- j ej — Oz et — Ox e| j-	(23)
Nessa última equação, as linhas ao longo das quais os ei+1 são computados simultaneamente estão orientadas na direção z. A direção da varredura (sweep) foi suposta positiva ao longo das direções coordenadas.
7.2	— TÉCNICAS DE PROGRAMAÇÃO
Ponto conveniente de se salientar é o fato, no caso específico do SOR por linha, de se tornar computacionalmente mais eficiente calcular os valores de e', que são os de “substituição direta” ou de “simples relaxação cíclica”, equivalentes aos valores de ei+1, obtidos, respectivamente, por SOR por ponto ou SOR pôr linha, das equações:
- (oí + o; + o; + o: + oí + o^ + -^-) e'o
= ro - (Oy e/1 + Ox e/1 + O~ e/1
+ "Oi es + Ox eí + Oy et)	(24)
e	'
Oã e'5— ^Oy + Ox + Ox + Ox + Ox + Oy
+ —-e'o + O te' = ro — (Oy e2 hl
+ O^ + O+et + O^et)	(25)
Os valores de ei+1 são encontrados a partir da equação que define o fator de relaxação:
e4+1 = efc qj (ez _ ei)	(26)
No SOR por ponto as equações (24) e (26) são usadas sucessivamente para cada ponto da malha. No SOR em linha, o sistema de equações definido pela equação (25) é resolvido e a equação (26) é aplicada à cada ponto da linha, antes de se passar à linha seguinte.	■	■	■	■
Outro ponto de menor importância èm técnicas numéricas é a normalização.
Economiza-se uma multiplicação por Célula e por iteração, se durante a preparação das equações para SOR elas forem normalizadas, isto é, divididas pelo valor do coeficiente de et1-1 (ou e0).
Um comentário final sobre essa técnica se prende às necessidades de armazenagem (memória) para a resolução de grandes sistemas de diferenças finitas com o SOR.
No caso de problemas bidimensionais torna-se necessário um mínimo de seis matrizes para a resolução, enquanto que para problemas em 3 dimensões mais duas matrizes são precisas. .
7.3	— CÁLCULO DE co
O problema do cálculo do valor ótimo de a é tão crítico que o SOR não teria valor para as técnicas de modelo, sem que fosse encontrado um modo de calcular economicamente co para cada intervalo de tempo. Uma modificação do Power Method de Varga foi considerada satisfatória, tanto para o SOR por ponto como para o SOR por linha, podendo ser o método descrito como se segue:
1)	Temporariamente coloque u&gt; = 1, o vetor r0 em todos os zeros e o vetor e em todos os uns.
2)	Faça um SOR sweep (varredura) correspondente a k = 1.
3)	Faça a varredura de ordem (fc + 1)-
4)	Calcule o valor máximo de (eo+1/eS), ciclicamente em todas as células. Chamemos isso de X\
5)	Analogamente calcule o mínimo de (ejpl/eo). x
Denominemos isso de pk.	-
6)	Se — X* J for suficientemente pequeno ou tenha alcançado um limite arbitrário (15, por exemplo), continue com o step 7. Caso contrário, retorne ao step 3.
7)	Calcule:
máx- (i + Vi - x*)
_ 2
(í + vr^j-
* i	2
Wmâx’ ~ fi + VL^)
M 2
COmín. = -------======
(1 + Vl — M*-1)
Agora, se | pk — Xfc | for suficientemente pequeno, co„to. e Wmtn. terão valores muito próximos do valor ótimo de co, tal que:

mín.
(27)
(28)
ín (“LJ ~ Á •+ ^f
(An.) ~ C + ~-
Além disso, se A, B, C e D forem determinados usando-se Aáx.&gt; «min., An., Para 1	&amp;lt;100,
as curvas correspondentes se intersectam num valor de &amp;amp; satisfatoriamente próximo (usualmente dentro de ± 0,01) do valor de oj ótimo.
7.4	— MÉTODO ITERATIVO IMPLÍCITO EM DIREÇÕES ALTERNADAS
Os métodos implícitos dc. direção alternada (ADI) têm sido largamente utilizados na indústria do petróleo. Do todas as técnicas apresentadas são eles, talvez, os mais aplicados, na solução de problemas de simulação. 'Todavia, sua aplicação geral não significa, necessariamente, que eles são economicamente aplicáveis a todos os problemas.
Os métodos ADI podem ser separados em duas categorias:
1)	ADI não iterativo (ou ADIP)
2)	ADI iterativo (ou ADIPIT)
O ADIP consiste num único cálculo linha por linha e depois num cálculo coluna por coluna, para obter a solução, no fim de um intervalo de tempo. As equações para esse processo foram dadas previamente (equações 8 e 9). Sua utilização - se restringe,. principalmente, a. problemas do tipo parabólico, tendo superfícies dé solução contínuas, re-gúlares, e coeficientes razoavelmente constantes.
Em termos mais práticos, esta restrição implica em sistemas bidimensionais em área, tendo razoavelmente constantes as dimensões das células e os coeficientes de fluxo. Em particular, o ADIP é aplicável a sistemas de malhas com grandes blocos, nos quais as variáveis dependentes se diversifiquem ligeiramente durante um intervalo de tempo e o sistema rocha-fluido tenha uma- compressibilidade mensurável. Para casos diferentes, a -restrição no .tamanho do intervalo de tempo torna o método iterativo mais atrativo.	■	.
Discussão detalhada- sobre esse pontó é feita por Coats e Terhune.	t
O método iterativo ADI difere profundamente do ADIP, por ser o primeiro .uma.solução iterativa de uma matriz de equações implícitas. Como tal, ele resolve a matriz sem levar em consideração a dimensão -do intervalo de tempo, a média dos coeficientes em relação ao tempo ou a rigorosidade. da equação diferencial original.	.	. u;
• Nesse sentido, ó ADIPIT muito se assemelha à Eliminação de Gauss, , por ser unia técnica de solução virbualmente ihdepéndêhte"“dõ--problema em
resolução. O ADIPIT é considèrado como o mais útil método de solução para problemas de fluxo em malhas ' horizontais bidimensionais. Ê aplicável também à reso.lução de seções verticais; todavia os autores consideram que o SOR em linha seja mais econômico nesses casos.
Desde que se trate de uma técnica iterativa, o erro residual da solução poderá ser pré-selecionado, para assegurar convergência às equações de diferenças finitas, dentro da tolerância preestabelecida.
A variante do ADIPIT a ser aqui descrita é de autoria de Peaceman e Rachford. A apresentação se concentrará principalmente na aplicação, deixando-se a prova da análise numérica envolvida para textos tais como o de Varga.
7.5	— EQUAÇÕES DO ADIPIT
Referindo-se às equações (6), (8), (9) e (19), as equações do ADIPIT para um problema de fluxo de fluidos em forma residual são:
O;Ê3M/2 _ (OÍ + O- _+Ah
' + T») eâ+1/2 + OíA/2 .
’= r0 - {o~ e* -	+ Oy
+ TT&amp;amp;t ~	4 + Oy 4 j-	(29)
para cálculo de uma linha de cada vez, e
Oy et*1 —	+ Oy +	-	e§+1 4- 0J.ê4+1
= í’o — ^Ol et*1/2 — ^01 + Os
+	eg+1/2 + Oi	Ó30)
para cálculo de uma coluna de cada vez.
Nas equações (29) e (30), r0 é definido como resíduo computado a partir das pressões no fim do intervalo de tempo anterior (ver equação 19), e como a correção necessária para obter as novas pressões, o superscrito k TeNre-se ao número de iterações (e não intervalos de tempo) e é o valor máximo dos parâmetros de iteração usados ciclicamente para aumentar a velocidade de convergência. O processo básico de solução é dado no item que se segue.	. .	-
7.6	— PROCESSO BÁSICO DE SOLUÇÃO
USANDO O ADIPIT	■	■
1)	Gerar os parâmetros de iteração. ■ •.	&amp;lt;.
'.Resolver ;.a. equação: (29) -para.- cada-, célula numa linha. Ém outras- palavras-, resolver
3)	Depois de usar a equação (29) em todas as
linhas, usar, de modo análogo, para cada coluna da malha, a equação (30).	.
4)	Completa-se, desse modo, uma iteração. O erro poderá então ser.comparado e uma nova iteração iniciada, usando-se o próximo parâmetro de iteração (isto é, passar para o
. step n.° 2).	.	.
Os steps 2 e 3 podem ser intercambiados com pequenas mudanças nos resultados.
A solução de uma única linha ou coluna, num dado espaço de tempo, poderá ser feita com extrema eficiência, usando-se o algoritmo de Eliminação de Gauss para as matrizes diagonais apresentadas na última seção deste artigo.	.
Ê a redução do problema matricial original em várias matrizes tridiagonais. que torna o ADIPIT mais útil. Tanto é reduzida a capacidade de memória do computador necessária como o número de cálculos aritméticos.
A parte mais crítica da solução pelo ADIPIT é a seleção dos parâmetros de iteração.	.
O uso de um único parâmetro ótimo resulta numa velocidade de convergência assintótica, idêntica à do SOB por ponto, ao menos para um tipo de problema. '	. .	.
Os cálculos adicionais requeridos pelo ADIPIT poderíam indicar que o SOR por ponto seria vantajoso. Todavia, a potência real do método ADIPIT aparece quando uma sequência de parâmetros de iteração é usada ciclicamente. ’ . .
Ao contrário do SOR por ponto, a seleção adequada dos parâmetros afeta substencialmente a taxa assintótica de convergência.' Existem, várias se-qüências de parâmetros disponíveis na literatura. Aqueles que a experiência tem indicado como de melhor aplicação à simulação de fluxo de fluidos são:
XmXn. .	5 o Xmáx.	'	Í31)
0^1= ’ (32)
4	1
para i = 1, 2, ........,	n.
Wi = Vfln bn = a„+i	(33)
Wi-1 = bü + VW)2 — (aj)2	.. _ .
1 =	- V/4)2 ~ W2	(34)
para. i. = 1,:2,	n/2_	■
=	n ~2,1,...	-d
onde Xmín. e Xmáx. são os eigenvalue's náínimõ e'máximo d_e-amba?--as.. matrizes --tridiagpnais.. definidas-pelas. equações; (29); ê ;(30);. -	.• ■	•.	\
■ O processo de cálculo consiste em computar a e b, e depois, então, calcular os valores de ce. A confusão normalmente gerada pelo número de super e subscritos nas equações para-geração dos valores de a&gt; está relacionada com 0 procedimento, a seguir:
1)	Calcular 0 primeiro valor de ca pela equação (33).
2)	Dos valores computados .em 1, calcular dois novos valores a partir do par de equações (34).
3)	Para cada valor de ca computado em 2, calcular mais dois valores a partir do par de equações (34).
Desse modo, 0 número de parâmetros de iteração é aumentado em potências de dois, até que 0 número desejado seja obtido.
Embora os trabalhos de análise numérica indiquem que centenas de parâmetros são freqüentemente necessários para garantir a convergência, a prática vem demonstrando que 16, 32 ou 64 são suficientes. Note-se que este processo não dá a seqüência dos parâmetros que decresceu monotonicamente. Pelo contrário, a seqüência é espalhada em valores numéricos, na forma de grandes valores, pequenos valores, grandes valores, pequenos valores, etc.
O resultado mostra-se um tanto quanto instável, porém é consideravelmente mais rápida a taxa dc convergência.
Problemas de fluxo multifásico bidimensional. com vários milhares de equações têm sido resolvidos usando-se esses parâmetros em menos do que 20 iterações. ....... .	.
Infelizmente, o sucesso desse parâmetro depende da precisão dos valores dos eigenvalues Xmdx e Xm;n.
Estimativas do limite superior Xmíx. não. são críticas para a velocidade de convergência. Daí poder ser usado o teorema de Gerschgorin:
(35),
onde i = 1, 2, .........n.° de células.
Em outras palavras, os coeficientes para cada célula no sistema são usados na equação (35), ccm a finalidade de achar qual a célula responsável pelo maior valor absoluto, quer na componente x, quer na y. O valor máximo resultante é usado, então, na equação (31).	'	,
O limite inferior Xmín. exerce, de fato, um efeito crítico na velocidade de convergência.
. Isso tem-se mostrado párticulãrmente verdadeiro quando Xmfa7—&gt; 0. ou quando, os coeficientes na direção x e y diferem substancialmenté. ■	'
Existem ■ técnicas'itérativas.- para a :obte-nção-de estimativas do dimite. inferior,’inèficientes porém, devido ao excessivo Tempo, de .c.ompúta-ção'éxigido.
Usando-se novamente os teoremas de Gerschgorin, teremos:
Xmtn.&gt;Min.&lt;{|^-|^0^	(36)
i	= 1, 2, 3,.......,	n.° de células
Esse valor mínimo é usado, então, na equação (31).
Note-se que a eqúações (35) e (36) requerem um pequeno trabalho adicional de computação, se realizado enquanto se estabelecem as equações. Daí, então, poder computar-se, economicamente, novos parâmetros de iteração para cada step de tempo.
7.7	— CRITÉRIO DE CONVERGÊNCIA
Como foi mencionado previamente, a única e verdadeira verificação de convergência está no cálculo dos resíduos.
Todavia, o fluxo de cájculos no ADIPIT não permite seguir rotineiramente esse procedimento.
Uma vez que calcular um resíduo para cada célula consome muito tempo, outros meios foram considerados. Mecanismo simples é a comparação da tolerância preestabelècida com a variação máxima de e de um intervalo a outro de tempo. Na maioria -dos casos é aplicável uma tolerância de 0,01.
Observa-se, contudo, que este esquema é rápido, embora não seja absolutamente seguro. Se for usado, a variação máxima de e deverá ser imprimida após cada iteração para inspeção.
7.8	— TÉCNICAS DE PROGRAMAÇÃO
Supondo-se que esteja sendo usada a mais eficiente construção de linguagem de computador, o próximo e grande passo será pré-processar os coeficientes das matrizes na- forma exata requerida pelo processo de iteração, antes que o mesmo seja iniciado.
O arranjo do programa não é tão óbvio, já que tanto a varredura das linhas como a das colunas são realizadas simultaneamente. Isto poderá ser feito se compreendermos que após calcular uma linha a informação obtida poderá ser usada, de imediato, para triangularizar, superiormente, a linha prévia de cada matriz, para varredura coluna por coluna. Após completar a varredura da linha, restará apenas completar a das colunas, por substituição retrógrada (back substitution). Desse modo, às soluções das colunas são feitas realmente em paralelo, ao invés de em série.
A tabela a seguir nos dá os tempos de solução típicos por intervalo de tempo para várias malhas e para os 3 métodos numéricos. A tolerância de convergência para o SOR e ADIPIT foi de 0,001 psi, o computador utilizado um Burroughs B5500, e os tempos dados em segundos.
	Malha		Método		
			Gauss	SOR	ADIPIT
3	X	5	2	5	5
3	X	5X2	5	12(**)	—
9	X	10	8	11	—
13	X	11	18	25	19
9	X	26 (*)	21	40 (**)	—
9	X	26	21	21	22
26	X	23	94	59	62
34	X	36	302	122	111
20	X	24 X 2	564	110	—
(*) Secção transversal vertical (**) SOR por linha
BIBLIOGRAFIA
Breitenbagh, E. A. — A computer simulation of gravity drainage in oil reservoirs. Stanford University, 1964 [Ph. D. Thesis].
--------- et alii — Immiscible fluid flow simulator. In: S:P.E. MEETING, Dallas, Apr. 22-23, 1968 — Preprints .(S;P.E. Preprint 2019).
------------Solution of the immiscible fluid flow simulation equations. In:S.P.E. MEETINGS, Dallas, Apr. 22-23,1968 — Preprints ... (S.P.E. Preprint 2021).
-----■------Treatment of individual wells and grids in reservoir modeling. S.P.É. MEETINGS,
Coats, K. H. &amp;amp; Turhune, M. H. — Comparison of alternating direction explicit and implicit procedures . in two-dimensional flow calculations. Society of Petroleum Engineers Journal, Dallas, Tex., 6 (4): 350, Defe. 1966.
Douglas Jr., J. — A'survey of numerical methods for parabolic differential equations. Zn: ADVANCES in computers. New York, London, Academic Press, 1961, v. 2, p. 1.
Forsythe, G. E. &amp;amp; Wasów, W. R.—Finite difference methods for partial differential equations. New York, Wiley, 1960, p. 242-71.
Larkin, B. K. — Some stable explicit difference approximations to the diffusion equation. 2IZa-. themalifls òf Computation, Providence, Rhode Island, IS (86): 196, 1964.
Peaceman, D. W. &amp;amp; Rachford Jr. H. H. — The numerical solution of parabolic and elliptic differential equations. Journal of the Society for Industrial and Applied Mathematics. Philadelphia, 3: 28, 1955.	.
Poussin, F. de la Vallèe — An accelerated relaxation algorithm for iterative solution of elli
ptic equations. SIAM J. Numer. Anal., Philadelphia, 6: 340, 1968.
Sprague, C.F. — Algorithm 17, TRDIAG. Communications of the ACM, New York, 3 (9): 508,
1960.
Stone, H. L. — Iterative solution of implicit approximations of multidimensional partial differential equations. SIAM J. Numer. Anal., Philadelphia, St 530, 1968.
Thurnau, D. H. — Algorithm 195, bandsolve. Communications of the ACM, New York, 6 (8): 441, 1963.
Varga, R. S. — Matrix iterative analysis. Englewood Cliffs, Prentice-Hall, 1962, p. 97-129; 209-47; 283-7.
Wachspress, E. L. — Iterative solution of elliptic systems ... Englewood Cliffs, N. Y., Prentice — Hall, 1966, p. 89-120; p. 104.
Young, D. M. — Iterative methods for solving partial differential equations of the elliptic type. Transactions of the American Mathematical Society, Providence, Rhode Island, 76: 92-111, 1954.
SYNOPSIS — A fundamental flow equation can be derived for each of the oil, water, and gas phases by combining the law of conservation of mass, a law of force, and thermodynamic relationships that describe the pressure-volume-temperature behavior of the fluids. Several methods that have proved useful in the solution of the multiphase reservoir simulation equations are presented. Also is presented {an iterative matrix solution method of the finite-difference equations for anisotropic problems.
(Originais recebidos em 21-VIII-73).
APÊNDICE
1	— SUMÁRIO
Frequentemente a etapa que mais tempo toma na solução de equações diferenciais parciais em duas dimensões é a solução iteratha das equações em forma de diferenças finitas.
Para o caso particular onde os limites são conhecidos (closed boundary case), esta solução torna-se difícil tratando-se de equações anisotrópicas, o que normalmente ocorre quando as dimensões da malha numa direção são muito maiores que em outra.
No desenvolvimento a seguir é utilizado um método de solução para aplicação em tais problemas. Este método mostrou-se bem rápido com relação a problemas anisotrópicos. mas não tanto quanto os métodos disponíveis quando aplicado a problemas isotrópicos. A extensão do problema envolvendo três dimensões é delineada.
2	— INTRODUÇÃO
Na solução das equações em forma de diferenças finitas decorrentes de equações elíticas ou parabólicas multidimensionais, obtém-se normalmente um conjunto de muitas equações lineares algébricas, cuja resolução deverá ser feita simultaneamente.
A etapa mais demorada na solução é a resolução ' desse sistema de equações, o que normalmente vem sendo realizado usando-se algum método iterativo.-
As equações em diferenças finitas são freqüente-mente anisotrópicas. Por anisotrópicas queremos dizer que nessas equações dois coeficientes não pertencentes à diagonal principal são muito maiores do que os outros coeficientes também não pertinentes à diagonal.
Quando tal fato ocorre, a solução se torna bem mais difícil para, o caso de closed boundary.
Até há bem pouco tempo, considerou-se o método de sobrerrelaxação sucessiva em linha (line suCessive overrelaxation) como a técnica mais eficiente para aplicar em tais situações.
Este trabalho descreve um método alternativo para aplicação em sistemas anisotrópicos.
Este método pode.ser considerado como um caso particular da técnica mais geral desenvolvida por De la Vallee Poussin.
. 0 método em si consiste numa correção aplicada em cada ponto da malha, em determinada linha, conjugada cóm o método de line successive overrelaxation.
0 método é muito rápido quando aplicado à problema anisotrópico em duas dimensões. Sua extensão para três dimensões foi delineada,. porém nenhum exemplo de cálculo é aqui apresentado.
3	— 0 MÉTODO
Consideremos o sistema físico do qual as equações em forma de diferenças finitas foram derivadas. Seja a figura 1 a representação do sistema por uma matriz de pontos da malha. .	. .	- .
J .	-—-    - . 
j + 1............................  .	, .
j.......................................
j -1.................................  •
1 . ........................... . . .
' í ’ x’r-1 *i W ’ ’ ‘ í ’
Fig. 1 — Sistema Físico e Pontos da Malha.
A equação em forma de diferenças finitas, em cada ponto da malha tem a forma:
Oi, i (U{-1, 7	Ui~x.j) d-
+ aa^Aui.i-i - Ui,j) -
CCi,j(^i,j ^í.J+1)	(1)
Ã exceção de d,-,/, os demais coeficientes são não--negativos. Se o problema for elítico (steady-state), biti é igual a zero. Comumente se escreve esta equação do seguinte modo:
at-, j 'Ui-i, j d“	-]- aa^j	-|- ccí,jUi,j+i-t~
+ bZjUi.j = di,}	(2),
onde
bij b{tj ~ d,tj c, tj aaicc,,$
Escrevendo-se essa equação para cada ponto da malha, criamos um sistema de equações simultâneas que precisa ser resolvido. A matriz formada pelos coeficientes dessas equações é geralmente simétrica.	■
Os pontos da malha mostrados na figura 1 estão dispostos de modo a formarem um quadrado. Neste
ai j ~ a j	atZj(j	ccí j *	(3)
Se esses quadrados são transformados em retângulos com a direção i sendo a maior, ou se a conduti-vidade da direção, j é superior à da direção i, teremos:
0&gt;i j CiJ &amp;lt;UCEj’j CCi J	(4)
Esta característica é denominada anisotropia.
Neste caso poderá ser considerado como estando mais ligado a	e Uíj^ do que a ít£_i,y
e Wí+i,j.
Suponhamos que o sistema de equações esteja sendo resolvido por algum procedimento iterativo successive overtaxation, Gauss-Seidel, etc.). Suponhamos também que em algum estágio na técnica de solução obteremos um conjunto de ufj's — valores naomentâneos, estimados para a solução.
Arbitremos üm ajuste aos valores do conjunto uni,j, como a seguir:
= u^j + t	•	(5)
Os termos resultantes u”j112 devem estar mais próximos da solução do que os termos u"j se os valores usados para a? foram escolhidos apropriadamente. Esses valores são determinados pelo procedimento a seguir.	.
Somando-se os j na coluna i, (equação 1):
■T	. .	.
23 {®i,3‘ (^£-1 ,i Uij) ' Cf, /	+
' 3= 1	...	_
. UG/.y (u,.y„i “ Wjtj) CCi,j (Ui j Uijj)
-	bi.jUíj - di,j} = 0	.	(6)
Aqui fazemos aa,-. i = cc,,j- = 0, devido ao closed boundary .	■	..	■ -. .■	.
23 {ai,3 (tâ-lj + t-l ~&amp;lt;/■•- 0$) ~ CiJ (unij + i=l	.	■
+ a" — «f+i.y — a:"+i) +	'	'
+ aaít/ (u?,3-1 + a-i — tij - a”) -Accíj (u* j + + a” - Wí.ai ~	~	'
-	6/,/«/ +a?) ~dij} = 0 '	••	.	(7)
Todos os termos w”,- são conhecidos. Reagrupando-se a equação (7)', teremos:
(23 ai.i} ai~i + {— 23 (bí’3 + ai.i + •
3=1	3=1	....
J
+ Ct-,y) } a” + (23 ci j} “’Ll =	.
- 3=1	.
J	.
-	23 [dij — atj (uíjj Uj,j) -|-
1 .
T a, j (u{, j	ui+i, j)	.
’	®®£ • 3'3-1 'Gy,y) d~ CCj,y (w'y,y
Wj.j+l) T ^£,3 G	(8)
O lado direito da equação (8) nada mais é do que a soma dos resíduos na coluna de ordem i da malha, onde o resíduo é definido por:	,
rnij =&amp;lt;kj - aij (u^j - u^j) + '	.
T (1Z,- , ,	^£+1,3') o&amp;amp;ij .
(«”,3-l - «£,3) + CCiJ (tâj ~ Ui J+l) +
+ bijVjj	(9)
Se a matriz for simétrica, teremos:
aatj = ca,--!	(10)
e o lado direito da equação (8) simplifica-se para:
23 {dí.3 ~ Oí,3«-1,3- «£,3) +
+ CiJ (rfj -&amp;lt;+i,y) + bijufj} .	(11)
A equação (8) é da forma:
Ai (Aj-j + Bi a7- + Ci «Ju = Di	(12)
Existe uma equação desta forma para cada coluna da malha, formando um sistema tridiagonal que pode ser facilmente resolvido pelo Método da Eliminação de Gauss.
Assim, foi desenvolvido um método que esperamos poder trazer os elementos de um vetor-solução estimado para valores próximos aos seus corretos valores. .	.
Esta correção da coluna deverá ser conjugada, de algum modo, com um método iterativo de inversão de matriz.	.	■	.
Qualquer um dos vários métodos poderia ser utilizado, porém o de sobrerrelaxação sucessiva em linha (LSOR), com as linhas orientadas ao longo das colunas de correção, parece-nos ser o mais apropriado. O procedimento escolhido, aqui denominado LSORC, baseia-se em seguir cada varredura de LSOR com uma correção na coluna. Alternada-mente, cada uma das várias varreduras do LSOR poderia ser seguida por uma correção na coluna.&amp;lt;
O número correto de varreduras de LSOR por correção de coluna depende, provavelmente, do tipo de problema a-resolver, não devendo, porém, ser grande, porque o trabalho aritmético necessário para uma correção de coluna é somente cerca de um terço do trabalho necessário para uma varredura de LSOR.
4	— RESULTADOS	- - •
Nenhuma tentativa foi. feita no sentido de analisar teoricamente o método acima descrito. Ao invés disso, foi ele testado em um problema descrito por Stone. Isto' tornou fácil comparar o LSORC com o método strongly implicit (SIP), proposto por
O problema por ele descrito é elítico com condições de contorno tipo Neumann. Consite numa malha de 961 pontos (31 X 31), onde existem três fontes e dois sumidouros cujas somas se igualam.
Dois casos foram considerados: cõndutividade isotrópica, kx= kv e cõndutividade anisotrópica, kx = 100 kv.
As comparações são feitas com base no trabalho computacional requerido.
A unidade usada é o trabalho necessário para uma iteração pelo LSOR. Isto representa, aproximadamente, dois terços do trabalho necessário para uma iteração usando-se o método LSORC, e metade do trabalho necessário para uma iteração usando-se os métodos SIP, considerando-se que o LSOR necessita, no mdximò, metade do trabalho por iteração requerido pelo ADI.
Os quatro métodos são comparados para o caso isotrópico na figura 2. Os parâmetros ótimos de sobrerrelaxação usados no LSOR e LSORC foram determinados experimentalmente, e valores achados consideram ser 1,81 para ambòs os métodos. ~
Como mostra a figura 2, para o quadrado homogêneo e isotrópico, o ADI é o melhor método, seguido, na ordem, do SIP, LSOR e LSORC.
Fig. 2 — Comparação de Convergência: kx == ky.
A mesma comparação é feita na figura 3 para o caso anisotrópico, onde o parâmetro de relaxação ótimo para o LSOR foi novamente 1,81, tomando se, porém, 1,10 para o LSORC 'com as colunas orientadas ao longo da direção x).
A figura 3 leva-nos a concluir que o LSORC é o melhor dos métodos iterativos testados.
O método SIP surge em segundo lugar, seguido do LSOR. O método ADI é tão lento que nem aparece na figura 3.
Fig. 3 — Comparação de Convergência: kx = 100 ky.
Dessa forma o LSORC não oferece nenhum atrativo para o caso isotrópico, sendo muito bom, porém, no caso anisotrópico, quando as colunas são orientadas na direção de alta cõndutividade. Isto era o esperado. Conforme já se salientou, num determinado ponto da malha de um sistema anisotrópico, a incógnita se apresenta muito mais vigorosamente ligada a seus vizinhos em uma das direções.
Quando as linhas do LSOR estão orientadas na direção da ligação mais forte, as incógnitas numa linha são determinadas por solução simultânea, e possuirão posições aproximadamente corretas em relação umas às outras, porém seu nível estará errado. Se as correções' nas colunas se encontram na mesma direção, não afetarão as posições relativas das incógnitas, porém variarão seu nível.
A correção nas colunas elimina erros grosseiros sobre o sistema como um todo.
As varreduras do LSOR atenuam erros locais.
5	— EXTENSÃO A TRÊS DIMENSÕES
Na seção precedente, mostrou-se ser o LSORC bastante rápido no caso de um problema anisotrópico bidimensional. Isso encoraja estender a técnica ao problema tridimensional, mostrando-se parti-
Em' três dimensões, a equação em diferenças finitas, num determinado ponto da malha, toma a seguinte forma:
aíjifc	^í+ifíik) +
d-	cci'jjz	V-íj+ijc) “t"
*4“ CUMLijjs (UiJ,k-l —
^i,i,k = di,i,k	(13)
Novamente, se a condutividade é mais alta ou o espaçamento é menor na direção k que nas outras duas, o sistema é anisotrópico, e os termos aáa e ccc são maiores que a, aa, c e cc.
O termo de correção se torna, então:
« = u?,jth +	(14)
As equações para a têm a forma:
Aj,;	+ Cij a-i-ti,! +
+ AAí,jO?, ;_i + CCijdi.iii +
+ Bi,; afj = Di,j	■	(15),
onde:
K
A-Í,j ~
fc=l
K
Ci 3	“ zL* GtáJt

K

k= 1
K
CCit3- — ^2 ccijik
k= 1
Bí,í = —22 (bi’i.k + a-i.í^ +	+
h= 1
+ adi,j,k + ccíj.s)
K
Bí,j =	22 (dpj.Z;	(Uí^IjjjX- Hiilík) +
4=1
+ Ci,i,k (Ui,j,k — U^k) —
' O&amp;amp;ijfk (^f,J—1,4	"P
+ CCí,y,fc ('Uij.k — «í,3+1,4) ~
— aadi,i,k (.Ui,i.k-i ~ '^i.í.k) +
+ CCCi^k M,S,k — Ui^k+l) +
+ bi,i,k Ui,;,k}
No caso bidimensional, os termos a são obtidos resolvendo-se um sistema tridiagonal de equações. Já no tridimensional, o sistema a ser resolvido é
pentadiagonal, tal comò o é o sistema para um problema bidimensional em diférenças finitas. Assim, para se chegar aos termos a, um dos "métodos itera-tivos (LSOR, LSORC, ADI, etc.) discutidos na seção anterior poderá ser usado.
No caso tridimensional é necessário maior trabalho de computação para a obtenção dos termos de correção; _ por conseguinte, talvez seja preferível fazer várias arreduras de LSOR para cada correção de coluna. Obviamente, deverá ser isto determinado de forma experimental.
6	— CONCLUSÕES
Com base nos resultados calculados, anteriormente apresentados, e também no relato apresentado, foi possível chegar às seguintes conclusões:
.1 — O método iterativo de solução de matrizes desenvolvido neste trabalho (LSORC) é bem mais rápido que outras técnicas, nos casos de problemas bidimensionais fortemente anisotrópicos.
2	— No quadrado homogêneo isotrópico, o
LSORC é mais lento que qualquer outra técnica disponível (ADI, SIP, LSOR).
3	— O LSORC pode ser facilmente estendido
para três dimensões, onde seu uso deve ser particulamente vantajoso tratando-se de problemas de reservatórios de petróleo.
NOMENCLATURA
a — Coeficiente de fluxo entre um ponto da malha e o ponto vizinho na direção decrescente de i.
A — Soma dos coeficientes de fluxo entre uma coluna da malha e a coluna vizinha na direção decrescente de i.
aa — Coeficiente de fluxo entre um ponto da malha e o ponto vizinho na direção decrescente de j.
AA — Soma dos coeficientes de fluxo entre uma coluna da malha e a coluna vizinha na direção decrescente de j.
aaa — Coeficiente de fluxo entre um ponto da malha e o ponto vizinho na direção decrescente de k.
b — Coeficiente de acumulação num ponto da malha.
B — Soma dos coeficientes de acumulação numa coluna da malha mais a soma dos coeficientes para fluxo numa coluna.
c — Coeficiente de fluxo entre um ponto da malha e o ponto vizinho na direção crescente de i.
C — Soma dos coeficientes de fluxo entre uma coluna da malha e a coluna vizinha na direção crescente de i.
CC — Soma dos coeficientes de fluxo entre uma coluna da malha e a coluna vizinha na direção crescente de j.
ccc —Coeficiente de fluxo eíitre um ponto da malha e o ponto vizinho na direção creseen-de de k.
d — Lado direito da equação num ponto da malha.
D — Soma dos resíduos numa coluna da malha.
i	—- Subscrito indicando coluna.	; .
I	— Valor máximo de i, isto é, número de colü-. nas da malha.
]	— Subscrito indicando linha.
J — Valor máximo de j, isto é, número de linhas da malha.
k — Subscrito indicando o plano em que o ponto da malha está situado.
K — Valor máximo de k, isto é, número de planos. n — Superscrito indicando'o número da iteração. u — Solução da equação em diferenças finitas.
. Fisicamente, u podería representar pressão, temperatura ou qualquer uma das várias outras quantidades regidas pela equação diferencial parcial em estudo.
a — Correção adicionada aos valores correntes estimados de u numa coluna da malha.
w — Parâmetro de relaxação usado nos métodos LSOR e LSOR.C.	.
</field>
	</doc>
</add>