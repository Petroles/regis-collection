<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06189</field>
		<field name="filename">10707_MingireanovFilho_Ivan_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNICAMP
IVAN MINGIREANOV FILHO
SEGMENTAÇAO DE IMAGENS DE ROCHAS E CLASSIFICAÇÃO DE litofAcies utilizando FLORESTA DE CAMINHOS ÓTIMOS
CAMPINAS
2013
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECAnICA E INSTITUTO DE GEOCIEnCIAS
UNICAMP
IVAN MINGIREANOV FILHO
segmentaçAo de imagens de
rochas e classificaçao de litofAçies utilizando
FLORESTA DE CAMINHOS OTIMOS
Orientador: Prof. Dr. Alexandre Campane Vidal
Co-Orientador: Prof. Dr. Alexandre Xavier Falcao
Dissertação de Mestrado apresentada ao Programa de Pós-Graduação em Ciências e Engenharia de Petroleo da Faculdade de Engenharia Mecanica e Instituto de Geociençias da Universidade Estadual de Campinas para obtençao de título de Mestre em Ciencias e Engenharia de Petroleo na area de Reservatórios e Gestão.
Este exemplar corresponde à versão final da dissertação defendida pelo aluno Ivan Mingireanov Filho e orientada pelo Prof. Dr. Alexandre Campane
FICHA CATALOGRÁFICA ELABORADA PELA
BIBLIOTECA DA ÁREA DE ENGENHARIA E ARQUITETURA - BAE - UNICAMP
M663s
Mingireanov Filho, Ivan
Segmentação de imagens de rochas e classificação de litofácies utilizando floresta de caminhos ótimos / Ivan Mingireanov Filho. --Campinas, SP: [s.n.], 2013.
Orientador: Alexandre Campane Vidal Coorientador: Alexandre Xavier Falcão.
Dissertação de Mestrado - Universidade Estadual de Campinas, Faculdade de Engenharia Mecânica e Instituto de Geociências.
1.	Processamento de imagens. 2. Reservatórios. 3. Reconhecimento de padrões. 4. Segmentação de imagens. 5. Petrofísica. I. Vidal, Alexandre Campane, 1969-. II. Falcão, Alexandre Xavier, 1966-. III. Universidade Estadual de Campinas. Faculdade de Engenharia Mecânica e Instituto de Geociências. IV. Título.
Título em Inglês: Segmentation of rock images and lithofacies classification using optimum-path forest
Palavras-chave em Inglês: Image segmentation, Reservoir, Pattern recognition, Image Segmentation, Petrophysics
Área de concentração: Reservatórios e Gestão
Titulação: Mestre em Ciências e Engenharia de Petróleo
Banca examinadora: Célio Maschio, João Paulo Papa
Data da defesa: 21-02-2013
Programa de Pós Graduação: Ciências e Engenharia de Petróleo
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECAnICA E INSTITUTO DE GEOCIEnCIAS
UNICAMP
dissertacAo de mestrado acadEmico
SEGMENTAÇAO DE IMAGENS DE ROCHAS E CLASSIFICAÇÃO DE litofAçies utilizando FLORESTA DE CAMINHOS ÓTIMOS
Orientador: Ivan Mingireanov Filho
Orientador: Prof. Dr. Alexandre Campane Vidal
Co-Orientador: Prof. Dr. Alexandre Xavier Falcao
A banca examinadora composta pelos membros abaixo aprovou esta dissertação:
DGRN/1G/UNICAMP
Dr. Célio Maschio
UNISIM/CEPETRO/UNICAMP
UNESP/BAURU
Campinas, 21 de fevereiro de 2013
Dedicatoria
JA minha mae, Katia Riccardi, dedico.
"A mente que se abre a uma nova ideia jamais voltará ao seu tamanho original."
Albert Einstein
"Todas as vitárias ocultam uma abdicação."
Simone de Beauvoir
Agradecimentos
Agradeco primeiramente a Deus, pois sem Ele nada disso faria sentido.
Agradeco aos meus pais, que me ensinaram desde pequeno a importancia da educacao e a responsabilidade do conhecimento. Dedico um agradecimento especial a minha mae Katia Riccardi, e minha irma, Tatiana Riccardi Mingireanov, que sempre estiveram ao meu lado, me apoiando e acreditando em meu potencial.
Agradeco a minha família por suas contribuicoes diretas e indiretas na minha formacao.
A minha noiva, Marcela Mendes Salazar, pelo carinho, atencao, paciencia e ate algumas correcoes e sugestões no trabalho.
Aos meus amigos e colegas de trabalho por todo apoio durante essa jornada. Em especial a Michelle Kuroda e Thiago Spina pelas grandes contributes que deram ao meu trabalho.
Ao meu orientador, Alexandre Vidal, e co-orientador, Alexandre Falcao pela oportunidade, apoio, sugestoes sempre construtivas, incetivo e amizade que surgiu ao longo dessajornada.
Aos funcionarios do Departamento de Engenharia de Petróleo (DEP) e em especial a Sonia e Michelle.
Agradeco tambem a Agencia Nacional do Petroleo pelo apoio financeiro e todo suporte.
A Universidade Estadual de Campinas (UNICAMP) por oferecer uma estrutura de excelencia para a minha formacao.
Resumo
A caracterização de reservatórios é fundamental na construção do modelo geológico para a produção do campo. O melhoramento de tecnicas matematicas, que auxiliam a interpretacao geologica, influenciam diretamente o plano de desenvolvimento e gerenciamento dos pocos. Nesse sentido, este trabalho utiliza uma aplicacao inedita na caracterizacao de reservatórios da técnica de Transformada Imagem Floresta (Image Foresting Transform - IFT) em segmentacao de imagens de rocha para a analise petrofísica. A técnica interpreta a imagem como um grafo, onde os pixels sao os nos e os arcos sao definidos por um relacao de adjacencia entre os pixels. O custo de um caminho no grafo e determinado por uma funcao que depende das propriedades locais da imagem. As raízes da floresta surgem de um conjunto de pixels escolhidos como sementes e a IFT atribui um caminho de custo mínimo das sementes a cada pixel da imagem para gerar uma Floresta de Caminhos (Ótimos (Optimum-Path Forest - OPF). Com isso, nas imagens de laminas de arenito, os graos sao segmentados em relacao ao poro e os grâos em contato sao separados entre si. Com os resultados obtidos e possível o estudo da morfologia dos graos e porosidade da amostra. O metodo consiste de dois processos principais, um totalmente automatico para segmentar a imagem e outro que utiliza uma interface grafica para permitir correcoes dos erros de classificacao gerados pelo processo automatico. A acurácia e medida comparando a imagem corrigida por interacao do usuario com a segmentada automaticamente. Outra aplicacao inedita apresentada no trabalho e a utilizacao do classificador supervisionado baseado em OPF para a classificacao de dados de perfilagem geofísica do campo de Namorado.
Palavras-chave: segmentacao de imagens, Transformada Imagem Floresta, Floresta de Caminhos (Ótimos, classificacao de litofacies, classificador OPF supervisionado, morfologia de graos.
Abstract
The reservoir characterization is fundamental in the construction process of geological model for field production. The improvement of mathematical techniques that assist the geological interpretation, has a directly influence in the development plan and management of the wells. Accordingly, this study uses a novel application in reservoir characterization, Image Foresting Forest (IFT) technique to image segmentation of rock for petrophysical analysis. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The roots of forest are a set of pixels selected as seeds and the IFT assigns a minimum path-cost to each image pixel generation an Optimum-Path Forest (OPF). The result is a segmentation of grains from pore in sandstone thin section images and the separation of the touching grains automatically. This allows the study of grain morphology and sample porosity. The method consists of two major processes: first, a totally automatic image segmentation and second an user interaction to correct misclassified grains. The accuracy is computed comparing the corrected image by the user with the image segmented automatically. Another novel application presented in the work is the use of supervised classification based on OPF for classification of geophysical logging data from Campo de Namorado.
Keywords: image segmentation, Image Foresting Transform, Optimum-Path Forest, lithofacies classication, supervised OPF classificator, grain morphology
Sumário
1	Introduçáo
1
1.1	Introdução à IFT e OPF...................................................
2
2 Lithofacies classification using Optimum-Path Forest method	7
2.1	Introdução.................................................................. 8
2.2	Metodologia................................................................ 11
2.3	Resultados................................................................. 13
2.4	Conclusões
14
2.5 Agradecimentos......................................................
16
3 Segmentation of sandstone thin section images with separation of touching grains
using optimum-path forest operators	18
3.1	Introduction............................................................ 19
3.2	Methods................................................................. 21
3.2.1	Image Foresting Transform........................................ 21
3.2.1.1	Graphs from images...................................... 21
3.2.1.2	Connectivity Functions.................................. 22
3.2.1.3	Optimum-path forest .................................... 22
3.2.1.4	Clustering by optimum-path forest....................... 24
3.2.1.5	Euclidean distance transform............................ 26
3.2.1.6	Segmentation by inverted watershed ..................... 26
3.2.2	Automatic Grain Image	Segmentation Pipeline...................... 27
3.2.3	Interactive Correction	................................. 28
3.2.4	Evaluation parameters............................................ 29
3.3	Results and discussion ................................................. 31
3.4	Conclusions ............................................................ 37
4	Aplicabilidade do método de segmentação automática em análise morfológica dos
grãos	39
4.1	Introdução............................................................. 39
4.1.1	Determinação dã forma do grão................................... 40
4.1.2	Estimativa de porosidade da rocha............................... 41
4.2	Resultados e discussão................................................. 42
4.3	Conclusões............................................................. 51
5	Referencias Bibliográficas	53
A	Imagens dos resultados da segmentacao automatica e correcoes interativas	57
B	Imagens dos contornos e eixos dos grâos	61
C	Resultados para analise dos eixos dos grãos	65
Lista de Figuras
1.1	IFT ............................................................................ 4
2.1	(a) Grafo completo ponderado nas arestas para um determinado conjunto de treinamento. (b) Árvore Geradora Mínina (MST) do grafo completo. (c) Protótipos escolhidos como sendo os elementos adjacentes de classes diferentes na MST (nos circulados). (d) Floresta de caminhos otimos resultante para a funcao de valor de caminho fmax e dois protótipos. Os identificadores (x, y) acima dos nos sao, respectivamente, o custo e o rotulo dos mesmos. Á seta indica o no predecessor no caminho ótimo. (e) Uma amostra de teste (triangulo) da classe 2 e suas conexões (linhas pontilhadas) com os nós do conjunto de treinamento. (f) O caminho otimo do prototipo mais fortemente conexo, seu rotulo 2 e o custo de classificacao 0.4 sao associados a amostra de teste. Note que, mesmo a amostra de teste estando mais proxima de um no da
classe 1, ela foi classificada como sendo da classe 2 (Papa et al., 2009b). ...	10
2.2	Perfis dos resultados da classificacao por OPF do poco NA07...................... 15
2.3	Matriz de confusao dos resultados da classificacao por OPF do	poco NA07. .	15
3.1	Sequence of image operations for grain determination............................. 20
3.2	(a) A 4-neighborhood graph with set of seeds M = {(0, 0), (2, 2)}, considering the origin (0, 0) of pixels coordinates (x, y) in top left and the numbers as arc weights. (b) An optimum-path forest P computed to the function fmax with two roots in S. The numbers inside the nodes show the optimum connectivity
map V(t) by Eq. 3.5 and the arrows indicate predecessor node P(t)............. 23
3.3	(a) Result of automatic segmentation with misclassification. (b) One grain
marker and two background markers to correct with DIFT-SC. (c) Correction segment with LWOF. (d) LM correction obtaining better delineation of grain shape......................................................................... 28
3.4	Examples of common misclassifications and their corrections. (a) The grain is split in two. The desired label is picked by a tool in the interface and the correction region is marked. (c) The two touching grains are segmented as one. The correction is analog the other, except the creation of a new label. (b)
and (d) are the results after running DIFT-SC................................... 30
3.5	(a) Sample S1 - Input image of the porous sandstone, showing irregular grains
of varied sizes and clayey matrix. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with the image of labeled grain........................................................................... 33
3.6	(a) Sample S2 - Input image of the more compact sandstone. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined
with image of labeled grain. ................................................ 34
3.7	(a) Detailed image of grain segmented from the background and others grains.
(b)	Image with misclassifications corrected by Live Markers.................. 35
3.8	(a) Details of misclassification of rock fragments by automatic segmentation.
(b) In the correction, DIFT-SC markers had a small leaking in (i) and (ii). LM
needed a little more interaction but the delineation was more precise in (iii) and (iv)....................................................................... 35
3.9	Relationship between automatic segmentation areas and interactive corrections area of sample S1 (a) and sample S2 (b).............................................. 37
4.1	Diagramas triangulares (a) as 10 classes descritivas definadas por Sneed and Folk (1958) C - Compact (Compacta), P - Platy (achatada), B - Bladed (laminada), E - Elongate (Alongada) e V - Very (Muito); (b) Isolinhas de Maxima Projecao de Esfericidade (MSP); (c) Isolinhas de índice de Oblato-Prolato.
Figuras adaptadas de Benn e Ballantyne (1993)............................... 42
4.2	(a) Resultado da segmentaçao automatica da Amostra S3. (b) Resultado da
correçao interativa da Amostra S3........................................... 43
4.3	(a) Resultado da segmentacao automatica da Amostra S6. (b) Resultado da
correcao interativa da Amostra S6.......................................... 44
4.4	Contorno dos graos e eixos das Amostras S3 (a) e S6 (b).................... 45
4.5	Diagramas de Zingg (1935) das amostras S3 (a) e S6 (b)..................... 46
4.6	Diagrama para determinacao de classes das amostras S3 (a) e S6 (b) segundo
criterio de classificacao de Sneed and Folk (1958)......................... 47
4.7	Diagrama de frequencia de Fator de Forma das amostras S3 (a) e S6 (b); Diagrama de frequencia da esfericidade das amostras S3 (c) e S6 (d)........... 48
4.8	Diagrama triangular do Indice Oblato-Prolato das amostras S3 (a) e S6 (c); Diagrama de frequencia dos respectivos índices Oblato-Prolato das amostras
S3 (b) e S6 (d)............................................................ 49
4.9	Diagrama triangular do Indice MSP das amostras S3 (a) e S6 (c); Diagrama de
frequencia dos respectivos índices MSP das amostras S3 (b) e S6 (d)........ 50
A.1 (a) Resultado da segmentacao automatica da Amostra S4 (b) Resultado da correcao interativa da Amostra S4.......................................... 58
A.2 (a) Resultado da segmentacao automatica da Amostra S5 (b) Resultado da correcao interativa da Amostra S5.......................................... 59
A.	3 (a) Resultado da segmentacao automatica da Amostra S7 (b) Resultado da
correcao interativa da Amostra S7.......................................... 60
B.	1 Contorno dos graos e eixos das amostras: (a) S1 (b) S2.................... 62
B.	2 Contorno dos graos e eixos das amostras: (a) S4 (b) S5 (c) S7............. 63
C.	1 Amostra S1 - Resultados das aplicacoes dos metodos para analise da forma
dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;amp; Folk (1958) (c) Fator de forma F (d) Esfericidade.......................... 66
C.2 Amostra S1 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do índice Oblato-Prolato
(c)	Indice MPS (d) Distribuyo do índice MPS..................................... 67
C.3 Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;amp; Folk (1958) (d) Fator de forma F (d) Esfericidade............................... 68
C.4 Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do índice Oblato-Prolato
(c) Indice MPS (d) Distribuyo do índice MPS................................ 69
C.5 Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;amp;
Folk (1958) (c) Fator de forma F (a) Esfericidade.......................... 70
C.6 Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) índice Oblato-Prolato (b) Distribuido do índice Oblato-Prolato
(c) índice MPS (d) Distribuido do índice MPS............................... 71
C.7 Amostra S5 - Resultados das aplicacoes dos metodos para analise da forma
dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;amp; Folk (1958) (c) Fator de forma F (d) Esfericidade.......................... 72
C.8 Amostra S5 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) índice Oblato-Prolato (b) Distribuido do índice Oblato-Prolato
(c) índice MPS (d) Distribuido do índice MPS............................... 73
C.9 Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma
dos graos: (a) Diagrama de Zingg (1935) (b) Diagrama triangular de Sneed &amp;amp;
Folk (1958) (c) Fator de forma F (d) Esfericidade.......................... 74
C.10 Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) índice Oblato-Prolato (b) Distribuido do índice Oblato-Prolato
(c) índice MPS (d) Distribuido do índice MPS............................... 75
Lista de Tabelas
2.1	Atributos utilizados para implementação do classificador baseado em OPF. . .	11
2.2	Descricão das classes para classificacão das rochas do Campo de Namorado
pelo metodo OPF.............................................................. 12
2.3	Distribuicão das classes por poco............................................ 13
2.4	Resultados obtidos das duas baterias de classificacão........................ 14
3.1	Comparative results after processes.......................................... 36
3.2	Evaluation parameters results................................................ 36
4.1	Descricão das equacoes para estimativa da forma do grão de acordo com os três eixos maior (a), intermediãrio (b) e menor (c). São utilizadas as relacoes
p = b/a e q = c/b............................................................ 40
4.2	Classes segundo as formas dos seixos segundo Zingg (1935)................ 41
4.3	Descricão das imagens das amostras....................................... 42
4.4	Medidas de ãcurãcia do metodo de segmentacão automãtica e correcoes.	...	44
4.5	Distribuicão dos grãos segundo criterio de classificacão de Zingg	(1935).	...	46
4.6	Distribuicão dos grãos segundo criterio de classificacão de Sneed and Folk
(1958) para as 7 amostras................................................ 47
4.7	Porosidade estimada...................................................... 50
Lista de abreviacoes
ANN - Artificial Neural Networks
BC - Bayes Classifier
CA - Cellular Automata
DIFT-SC - Differential IFT with seed competition
EDT - Euclidean Distance Transform
GIS - Geographic Information Systems
IFT - Image Foresting Transform k-NN - k-nearest neighbor
LM - Live Markers
LST - Level Sets
LWOFLive Wire On-the-Fly
MLP - Multi-Layer Perceptrons
OPF - Optimum-Path Foresting
PDE - Partial Differential Equations
PDF - Probability Density Function
SOM - Self-Organizing Maps
SRG - Seed Region Growing
USIS - User-Steered Image Segmentation
WGSE - Weight Grain Sub-division Error
WGSE-global - Weight Grain Sub-division Error - global
1	Introdução
A caracterizaçao de reservatórios e fundamental para a sua exploraçao, na qual a importancia da construçao do modelo influencia diretamente no plano de desenvolvimento e gerenciamento de um campo de petroleo ou gas (Deutsch, 2002). Para tal, e necessaria uma caracterizaçao realista das propriedades dos fluídos e das rochas que compoem o reservatório (Maschio et al., 2008) e os metodos que determinam essas propriedades estao em constante aperfeiçoamento e desenvolvimento. Dentre eles, a perfilagem geofísica e a analise petrofísica atuam somente apos a abertura do poço e escalas diferentes, permitindo assim a obtençao de testemunhos para a analise petrofísica e o deslocamento das ferramentas pelo poço para aquisiçao de dados de perfilagem (Miyoshi, 2010).
A perfilagem geofísica registra as medidas geofísicas (perfis eletricos, acrísticos, radioativos, mecanicos, termicos, etc.) realizadas por deslocamento de sensores de perfilagem em poços (Girao, 2006). A interpretaçao dos dados permite inferir sobre propriedades de formaçao (Girao, 2006) e de propriedades como tipos de facies, porosidade, permeabilidade, bem como informaçao precisa das superfícies estratigráficas e das falhas (Deutsch, 2002). O grande vies da classificaçao de litofacies e o processamento dos dados obtidos, existindo diversas tecnologias de inteligencia artificial, das quais podemos citar entre as mais difundidas e utilizadas as redes neurais artificiais (Artificial Neural Network - ANN: Self-Organizing Maps - SOM) (Haykin, 2001; Kohonen et al., 2001). Nesse sentido, foi realizado um estudo preliminar da aplicaçao do classificador baseado em Floresta de Caminhos (Ótimos (Optimum-Path Foresting - OPF) supervisionada Papa et al. (2009a) para a classificaçao de litofacies.
O capítulo 2 apresenta o estudo realizado em dados de poços do campo de Namorado com o classificador baseado em OPF proposto por Papa et al. (2009a). A aplicaçao do classificador foi realizada durante um estudo dirigido e posteriomente publicada no 12o Congresso Internacional da Sociedade Brasileira de Geofísica, em 2011.
Mudando para uma escala menor, a petrofísica esta intrinsicamente ligada a mineralogia e geologia pois a maioria do petroleo do mundo ocorre em rochas sedimentares porosas. A precisao da analise petrofísica e imprescindível para a previsao do comportamento dos fluídos na rocha (Tiab and Donaldson, 2004). Ela pode ser definida como o estudo das propriedades das rochas e suas interações com fluidos (gases, hidrocarbonetos líquidos e soluções aqu-
osas). A descrição das rochas sedimentares pode ser determinada por características do grão, como forma, esfericidade, textura, tamanho, distribuicao, orientacao e grau de compactacao. A combinacao destas variaveis podem induzir informacoes sobre os processos diageneticos e mecanismos de transporte, deposicao, compactacao e deformacao. E em alguns casos ainda e possível fornecer informacoes sobre a permeabilidade e porosidade (Tiab and Donaldson, 2004).
Desse modo, a principal motivacao deste trabalho e adaptar a Transformada Imagem Floresta (Image Foresting Transform - IFT) descrita em Falcao et al. (2004), uma tecnica eficiente de segmentacao de imagens, para automatizar e melhorar a qualidade da analise petrofísica. O estudo desse metodo aplicado a rochas de arenito e apresentado na forma de artigo submetido a revista Computer &amp;amp; Geosciences em outubro de 2012, no capítulo 3. Na sequencia, o capítulo 4 apresenta possíveis aplicacoes dos resultados em diversas tecnicas de analise da forma do grao.
1.1	Introdução à IFT e OPF
A segmentacao de imagens consiste em separar a informacao de interesse de uma imagem para torna-la compreensível e permitir a analise. As tecnicas basicamente procuram por objetos e bordas, agrupando e rotulando os pixels definidos a partir de certas características. Diversas tecnicas tem sido desenvolvidas nessa area nas ultimas decadas em diversas areas da ciencia. O maior desafio e obter metodos totalmente automaticos de segmentacao de imagens naturais, pois a maioria deles requer a intervencao do usuario em alguma etapa do processamento, por menor que seja. A limitacao e devido aos humanos serem muito superiores na tarefa de reconhecimento de objetos e os computadores muito superiores no delineamento. Uma maneira de contornar essa limitacao e o conhecimento prévio do objeto a ser segmentado, porem isso nem sempre e possível, pois os objetos nem sempre tem o mesmo padrâo de cor, formato ou de aquisicao da imagem (Falcao et al., 1998).
As tecnicas de segmentacao de graos em imagens de rochas mostram avancos significativos. Podemos citar as tecnicas desenvolvida por Van de Berg et al. (2002), Seed Region Growing - (SRG) (Choudhury et al., 2006), Level Sets - (LST) (Lu et al., 2009), Partial Differential Equations - (PDE) (Lu and Ning, 2010), Geographic Information Systems - (GIS) (Choudhury et al., 2006; Li et al., 2008; Gorsevski et al., 2012), e Cellular Automata (CA) (Gorsevski et al., 2012).
A aplicação de novas técnicas desenvolvidas em outras áreas da ciência visa reduzir as incertezas e riscos gerados pelos metodos na construcao dos modelos. A tecnica de segmentacao de imagens IFT tem se mostrado bastante eficiente, com aplicacoes em diversas areas, como medicina (Suzuki et al., 2012; Yu et al., 2012), reconhecimento facial (Chiachia et al., 2011), metalografia (Papa et al., 2012), e outras.
A IFT e uma ferramenta geral para projetar, implementar e avaliar operadores de imagens baseados em conectividade dos pixels adjacentes. O algoritmo utilizado para o calculo da IFT e basicamente uma generalizacao do algoritmo de Dijkstra (Dijkstra, 1959) para caminhos mais curtos, levemente adaptado para fontes multiplas e funcoes de custo de caminhos suaves. A imagem e interpretada como um grafo, onde os pixels sao os nos e os arcos dos grafos sao definidos por uma relacao de adjacencia entre os pixels. Grafos podem ser definidos como uma estrutura matematica utilizada para modelar relacoes entre objetos de um certo conjunto. O custo de um caminho no grafo e determinado por uma funcao que depende das propriedades locais da imagem ao longo do caminho, como cor, gradiente e posicao do pixel.
O algoritmo inicia com caminhos triviais (somente um unico pixel ligado a ele mesmo) propagando-se a partir das raízes, gerando uma competicao para conquistar os pixels remanescentes. A conquista e feita quando o custo do caminho e menor (ou maior) do pixel a raíz, ficando o pixel atribuído a essa raíz. A Figura 1.1-a e uma representacao de um grafo, onde o pixel t esta ligado pelo caminho P(t) a raíz P0(t). O processo exemplificado na Figura 1.1-b representa uma imagem 2D em escala de cinza, onde os valores sao os pixels (nos) da imagem e os três círculos maiores sao as raízes.
Figura 1.1: (a) Os elementos principais da floresta geradora. (b) Um grafo de imagem 2D com adjacência 4-conexos, onde os inteiros sao os valores I(t) da imagem. (c) Uma floresta de caminhos otimos para a funcao de custo mínimo, restritos aos tres pixels sementes representados pelos pontos maiores (Falcao et al., 2004).
As raízes da floresta surgem a partir de um conjunto de pixels escolhidos como sementes e estao representadas com círculos maiores na Figura 1.1-b. Inicialmente, a IFT atribui um caminho de custo mínimo das sementes a cada pixel da imagem para determinar as funcoes de custo mínimo, de modo que a uniao destes caminhos e uma floresta orientada se propagando pela imagem toda, ou seja, a IFT define uma floresta de caminhos de custos mínimos em um grafo. O resultado apresentado na Figura 1.1-c e denominado OPF.
O algoritmo determina como resultado três atributos a cada pixel: o pixel predecessor no caminho otimo, o custo deste caminho e a sua raíz correspondente (ou algum rotulo associado ao pixel). Uma grande variedade de operadores de imagens pode ser implementada atraves de um simples processamento local destes atributos.
A tecnica de classificacao supervisionada baseada em OPF modela as amostras como sendo um grafo completo. Os elementos mais representativos de cada classe sao denominados protótipos, e sao escolhidos nas regioes de sobreposicao e de fronteiras entre as classes, pois estas regioes sao muito mais propensas a erros de classificacao. Durante o processo de treinamento, os protótipos competem pelas amostras oferecendo o caminho de menor custo e seus respectivos rotulos, gerando uma OPF. Os benefícios dessa abordagem em relacao a outros metodos de classificacao supervisionada sao a independencia de parâmetros, permissao de tratamento nativo de problemas multiclasses e a nao dependencia da forma ou separabilidade entre as classes Papa et al. (2009a).
O objetivo da segmentacao de imagens e separar objetos da imagem para permitir sua analise. A separacao pode ser realizada utilizando a IFT para particionar a imagem em zonas de influencia, onde a zona de cada semente consiste no conjunto de pixels mais fortemente ligados a esta semente do que a qualquer outra. Estas zonas de influencia sao simplesmente as arvores da floresta definida pela IFT (Falcao et al., 2004). Um processo utilizado para este fim e denominado agrupamento - identificacao de grupos naturais de amostras de um conjunto de dados - e pode ser realizado pelo classificador OPF nao-supervisionado (Rocha et al., 2009) em amostras de pixels da imagem com seus correspondentes vetores de atributos. O problema consiste em identificar as altas concentracoes de amostras, as quais podem caracterizar os grupos relevantes para a aplicacao. Desse modo, os grupos naturais podem ser detectados e separados, pois sao caracterizados pelas altas concentracoes de amostras no espaco de atributos, formando domos da funcao de densidade de probabilidade (probability density function -PDF) (Rocha et al., 2009). A deteccao dos grupos naturais e realizada por uma busca exaustiva, calculando a pdf para uma relacao de adjacencia dos k-vizinhos proximos (k-nearest neighbor - k-nn) a partir de um kmin ate um kmax, procurando o k que otimiza a PDF, isto e, onde os pixels similares forem mais proximos, a pdf e maxima. A determinacao do melhor valor do
1. INTRODUÇÃO k considera o corte mínimo no grafo, provida pelos resultados do processo de agrupamento, considerando os pesos dos arcos entre os agrupamento e os demais.
O metodo proposto para segmentar os grâos na imagem consiste de dois processos principais, baseados em IFT: segmentacao automatica de imagem com graos em contato e correcoes interativas dos erros de classificacao.
O processo de segmentacao automatica tem como princípio separar os graos do fundo primeiramente e entao a separacao dos graos em contato entre eles mesmos. Para isso, o processo utiliza o algoritmo da IFT em três passos: no primeiro passo e feito o agrupamento baseado na similaridade de cor, o que permite gerar uma mascara de graos binaria da imagem original, ja que os graos estao nos grupos com os pixels mais claros. A mascara e utilizada para a deteccao das bordas dos graos. O segundo passo consiste em calcular a Transformada de Distancia Euclidiana (Euclidean Distance Transform - EDT) propagando para dentro do graos a partir das bordas dos graos. Isso gera uma imagem de domos cujos picos sao utilizados no terceiro passo para separar os graos com uma transformada watershed invertida.
O metodo watershed pode ser simplificado por um fechamento de bacias com volume abaixo de um threshold, e no caso watershed invertida, pode ser controlada pela abertura dos domos acima de um threshold. A separacao dos graos e feita ao permitir a competicao entre as sementes em cada domo, entendendo como distintos os grafos das sementes quando encontram o grafo de outra semente, atribuindo diferentes rotulos para cada semente, que no caso, os graos ficam rotulados e distintos. Como resultado, tem-se uma imagem de rotulos dos graos, onde o valor do pixel corresponde ao rotulo do grâo.
Apesar do processo anterior ter como objetivo a segmentacao completamente automatica, eventuais erros de classificacao ocorrem e podem ser corrigidos por uma interface grafica adaptada para este problema. A segmentacao de imagens guiada pelo usuario (user-steered image segmentation - USIS) permite as correcoes dos erros de classificacao que ocorrem em fragmentos de rocha, vazamentos de segmentacao de graos em contato com matriz, e divisao de graos maiores em outros menores ou graos pequenos serem interpretados como um grâo unico. A interface utiliza a ferramenta Live Markers baseada em IFT que trabalha apenas na regiao em que foram usados marcadores, trocando as posicoes das sementes originais do processo automatico de acordo com a decisao do especialista, gerando uma competicao apenas entre essas sementes, sendo computacionalmente muito râpido, gerando uma visualizacao do resultado quase em tempo real. Porem, a correcao de uma imagem com cerca de 500 graos demanda tempo do operador para verificar quais graos necessitam de correcoes e corrigí-las. Essa opcao da interface de correcao oferece a possibilidade de obter uma imagem tao precisa quanto seja desejado ou necessario. Outro propósito da interface e gerar uma imagem
padrão para servir de referência para medidas de acurácia do processo automático. Como dito anteriormente, o estudo realizado apresenta-se no capítulo 3.
2	Lithofacies classification using Optimum-Path Forest method
Authors: Ivan Mingireanov Filho, Alexandre Campane Vidal
Abstract
Pattern classification aims to find the label of each sample using a feature vector in dataset samples. As traditional methods usually do, the learning process distributes samples into different labels using a training subset and determines rules to decide the classification of each subset. The pattern recognition algorithm, based in Optimum-Path Forest (OPF) used here, models the problem like a graph. In this graph the nodes are the samples and the arcs are defined by some adjacency relation, the most relevant samples are called prototypes. A competition process among samples starts offering optimum-path costs to the remaining dataset samples. Using the complete graph in adjacency relation the competition becomes global, not based only in local geometry as traditional methods. The search is done finding the prototypes samples that belongs to overlap regions and boundaries between the labels in the training set. These regions are very susceptible to misclassification. The prototypes samples offer optimum-path cost computed as the maximum path arc-weight between these prototypes and the other dataset samples. These arc-weights are computed by the distance between their features vectors. The goal of this work is validate the OPF method classifying non-cored wells information set, from Campo de Namorado, in Bacia de Campos, RJ, freely available by National Petroleum Agency (ANP). The dataset is composed by 5 attributes for each depth, totaling 4732 samples, which 1950 are core samples. The results show the time spent on both, training and classification process. They were very short always less than 1 second. In crossvalidation, 87,1% of the core samples maintained their label. The average accuracy computed to each well was 64,8%, and using all core samples in training process the accuracy was 76,8%. These results suggest a new approach suitable to process a large volume dataset in a short time, being an alternative for non-cored wells classification.
2.1	Introducao
O metodo de classificacão por Floresta de Caminhos (Ótimos (OPF) e baseado na Transforma Imagem Floresta (IFT), uma ferramenta geral para modelar, implementar e avaliar operadores baseados em conexidade Falcão et al. (2004), reduzindo o problema de classificacão ao cãlculo de uma floresta de caminhos otimos em um grafo derivado do conjunto de dados das amostras. O valor de um caminho e normalmente calculado por uma funcão dependente dos atributos e da posicão do atributo ao longo do caminho do grafo (Papa et al., 2009b).
Para utilizacão do classificador baseado em OPF com aprendizado supervisionado, o mod-elamento do problema de reconhecimento de padroes e considerado como um problema de OPF em um grafo definido no espaco de atributos, onde os nos são as amostras, as quais são representadas pelos seus respectivos vetores de atributos, e os arcos são definidos de acordo com uma relacão de adjacencia pré-estabelecida. Tanto os nos quanto os arcos podem ser ponderados por alguma metrica de distãncia aplicada a seus vetores de atributos, diferente dos metodos tradicionais por não utilizar apenas a ideia de geometria do espaco de atributos, permitindo melhores resultados em bases com outliers e sobreposicão de classes. Diversas funcoes de custo podem ser empregadas para particionar o grafo em ãrvores de caminhos otimos, as quais são enraizadas pelos seus respectivos protótipos (sementes) na fase de treinamento. O rotulo de uma amostra a ser classificada e o mesmo do prototipo mais fortemente conexo a ela. A abordagem adotada utiliza o grafo completo como relacão de adjacencia. Durante a fase de treinamento, assume os elementos que pertencem ã interseccão entre as classes no conjunto de treinamento como os elementos mais representativos de cada classe (Papa et al., 2009b).
Os prototipos participam de um processo de competicão disputando as outras amostras oferecendo-lhes caminhos de menor custo e seus respectivos rotulos. Ao final deste processo, obtem-se um conjunto de treinamento particionado em ãrvores de caminhos otimos, sendo que a união das mesmas nos remete a uma floresta de caminhos otimos. Esta abordagem apresenta vãrios benefícios com relacão a outros metodos de classificacão de padroes supervisionados: (i) e livre de parãmetros, (ii) possui tratamento nativo de problemas multiclasses e (iii) não faz alusão sobre forma e/ou separabilidade das classes (Papa et al., 2009b).
O algoritmo OPF com grafo completo tem sido amplamente utilizado em diversas aplicacoes, tais como avaliacão de descritores de textura, diagnostico automãtico de patologias na laringe e classificacão de impressoes digitais (Papa et al., 2009b). Essas aplicacoes fundamentam a aplicacão em dados de pocos para classificacão da litologia.
A fase de treinamento do classificador baseado em OPF usando o grafo completo consiste em encontrar o conjunto S de protótipos, ou seja, os elementos mais representativos de cada classe. Essa escolha pode ser de varias maneiras heurísticas, inclusive, por uma escolha aleatoria de prototipos. Entretanto, tal escolha pode prejudicar o desempenho do classificador, tornando-o instavel e com um alto grau de sensibilidade com relacao aos protótipos escolhidos. Deseja-se estimar os prototipos nas regioes de sobreposicao de amostras e nas fronteiras entre as classes, visto que sao regiões muito susceptíveis a erros de classificacao. Outra tecnica que pode ser abordada e a utilizacao do grafo k-vizinhos mais proximos (k-NN), onde estima estes prototipos nos pontos de alta concentracao de amostras (Papa et al., 2009b).
Calculando uma arvore mínima geradora (MST) no grafo completo (Z1, A) (Figura 2.1a), obtemos um grafo conexo acíclico cujos nos sao todas as amostras em Z1, e os arcos sao nao direcionados e ponderados, Figura 2.1(b). Seus pesos sao dados pela distancia d entre os vetores de atributos de amostras adjacentes. Esta arvore de espalhamento e otima no sentido em que a soma dos pesos de seus arcos e mínima se comparada a outras arvores de espalhamento no grafo completo. Os prototipos a serem escolhidos sao os elementos conectados na MST com diferentes rotulos em Z1, ou seja, elementos mais proximos de classes diferentes, Figura 2.1(c). Removendo-se os arcos entre classes diferentes, tais amostras adjacentes tornam-se prototipos em S e pode-se computar uma floresta de caminhos otimos em Z1, Figura 2.1(d). Nota-se que uma dada classe pode ser representada por multiplos prototipos e deve existir pelo menos um prototipo por classe. A ideia consiste em ponderar os arcos entre amostras de diferentes classes com um valor muito alto, impossibilitando assim que os prototipos de uma classe conquistem elementos de outras classes (Papa et al., 2009b).
Para a classificacao, todos os arcos sao considerados conectando a amostra teste com as amostras do grafo original, onde na Figura 2.1(d) esta representado pelo triangulo. Considerando todos esses possíveis caminhos, desejamos encontrar o caminho otimo com a classe de seu prototipo mais fortemente conexo. Assim, a classificacao simplesmente associa a amostra a classe que satisfaz essas condicoes, Figura 2.1(e). Vale ressaltar que, embora a amostra a ser classificada esteja mais proxima de um elemento de classe bola, Figura 2.1(c), a mesma eí classificada como sendo da classe quadrado, o que demonstra que os classificadores baseados em OPF utilizam a forca de conexidade entre as amostras para a classificacao dos dados, ou seja, nao sao algoritmos baseados em conexidade local apenas como, por exemplo, os classificadores de redes neurais artificiais (ANN) (Hecht-Nielsen, 1990; Bishop, 1994) e k-vizinhos proximos (k-NN) (Papa et al., 2009b).
(c)
(d)	(e)
(f)
Figura 2.1: (a) Grafo completo ponderado nas arestas para um determinado conjunto de treinamento. (b) Arvore Geradora Mínina (MST) do grafo completo. (c) Protótipos escolhidos como sendo os elementos adjacentes de classes diferentes na MST (nos circulados). (d) Floresta de caminhos ótimos resultante para a funcao de valor de caminho fmax e dois prototipos. Os identificadores (x, y) acima dos nos sao, respectivamente, o custo e o rotulo dos mesmos. A seta indica o no predecessor no caminho otimo. (e) Uma amostra de teste (triangulo) da classe 2 e suas conexões (linhas pontilhadas) com os nos do conjunto de treinamento. (f) O caminho otimo do prototipo mais fortemente conexo, seu rotulo 2 e o custo de classificacao 0.4 sao associados a amostra de teste. Note que, mesmo a amostra de teste estando mais proxima de um no da classe 1, ela foi classificada como sendo da classe 2 (Papa et al., 2009b).
O classificador baseado em OPF com grafo completo assemelha-se ao algoritmo vizinho mais proximo (k-NN) somente no caso onde todos os elementos do conjunto de treinamento sao considerados prototipos, sendo este um caso atípico onde, certamente, o conjunto de atributos escolhido nao foi o mais adequado para a representacao do conjunto de dados. Outra diferenca a ser considerada e que os classificadores ANN e k-vizinhos mais proximos (k-NN) tomam uma decisao local para a classificacao dos dados, ao contrario dos classificadores baseados em OPF, os quais possibilitam uma solucao em ambito global, criando uma floresta
de caminhos ótimos que mapeia, para cada amostra do conjunto de dados, o caminho otimo entre ela e o seu prototipo mais fortemente conexo (Papa et al., 2009b).
O objetivo do presente trabalho foi classificar um conjunto de informacoes de pocos nao-testemunhados utilizando o metodo de classificacao supervisionada de padroes por floresta de caminhos ótimos, com validacao cruzada.
2.2	Metodologia
Foi utilizado um conjunto de informacoes de diferentes atributos referentes ao Campo de Namorado, da Bacia de Campos, RJ, disponibilizado livremente pela Agencia Nacional de Petroleo (ANP). Dentre todas as informacoes fornecidas, foram utilizados 5 atributos, de acordo com a tabela 2.1.
Tabela 2.1: Atributos utilizados para implementacao do classificador baseado em OPF.
Atributos Avaliados	Sigla	Aplicacao
Densidade	RHOB	Deteccao de raios gamas defletidos pelos eletrons pro uma fonte situada dentro de um poco
Porosidade	NPHI	Medida de quantidade de neutrons da rocha
Neutrônica		apos o bombardeio
Sonico	DT	Medida da diferenca dos tempos de transito de uma onda mecanica atraves das rochas
Inducao	ILD	Leitura aproximada da resistividade
Raio Gama	GR	Deteccao da radioatividade total da formacao geologica
O conjunto de dados contem informacoes medidas dos atributos de 7 pocos, em funcao da profundidade, no total de 4732 amostras, das quais 1950 possuem testemunho, ou seja 41,2% do total. É um conjunto privilegiado pela quantidade de testemunhos dos pocos, pois normalmente esse numero e bem menor, nao ultrapassando os 20% do total, devido ao alto custo e dificuldade de gerar os testemunhos. Para a classificacao, de acordo com o interesse do trabalho proposto, as facies foram agrupadas em quatro classes, de acordo com a tabela 2.2. Sao essas rochas sem testemunho o objetivo de classificacao pelo o metodo OPF, totalizando de 2782 amostras.
Tabela 2.2: Descrição das classes para classificação das rochas do Campo de Namorado pelo método OPF.
Classes	Descricao
1 2 3	Rochas Reservatórios Rochas Possível Reservatório Rochas Nao Reservatório Rochas Sem Testemunho
As informações foram separadas para cada um dos 7 poços, de acordo com a tabela 2.3, e foram realizadas duas baterias de classificaçao apos o treinamento do algoritmo, utilizando o algoritmo 3 - Classificador Supervisionado baseado em Floresta de Caminhos (Ótimos usando grafo completo, disponibilizado em linguagem C para utilizacao em plataforma Linux em www.ic.unicamp.br/~afalcao/LibOPF (Papa et al., 2009b).
Tabela 2.3: Distribuyo das classes por poco.
Poco	Classe	Classe	Classe	Sem	Total de
	1	2	3	Testemunho	Amostras
NA1A	4,76%	3,13%	1,75%	90,36%	799
NA02	9,26%	0,93%	6,17%	83,64%	648
NA04	25,65%	5,34%	24,61%	44,41%	581
NA07	10,59%	6,98%	29,07%	53,36%	774
NA11A	6,49%	1,40%	90,53%	1,58%	570
RJS234	1,47%	0,00%	51,54%	46,99%	747
RJS42	16,31%	2,77%	1,47%	79,45%	613
A primeira bateria foi feita apenas com as informacoes de cada poco, individualmente, utilizando metade dos dados de rochas com testemunhos do poco para treinar o classificador. Na sequencia, foram classificados os dados sem testemunhos juntos com a outra metade de dados com testemunhos, para validacao cruzada.
A segunda bateria agrupou todos os 1950 dados de rochas com testemunhos para treinamento, e classificou os dados sem testemunhos e metade dos dados com testemunhos, individualmente para cada um dos 7 pocos. Ou seja, a diferenca entre as duas baterias de classificacao foi na fase de treinamento, onde a segunda utiliza todo o conjunto de informacoes dos testemunhos, com o intuito de melhorar esta fase pela quantidade de informacoes maior, mantendo o conjunto de classificacao e de validacao cruzada.
2.3	Resultados
Os resultados obtidos foram bastante satisfatórios em ambas as baterias. Na bateria 1, a classificaçao das amostras sem testemunhos foi feita apos treinamento do algoritmo com metade das amostras com testemunhos e a outra metade com as classes agrupada com as amostras sem testemunhos. Por essa validacao cruzada, algumas dessas amostras com testemunhos foram reclassificadas, alterando a classe original, e outras se mantiveram. Os numeros absolutos e percentuais das amostras que mantiveram a classe e das amostras que foram alteradas de classe estao apresentados a seguir na 2.4.
Ainda nessa bateria, sao apresentadas as medidas de acuracia, que o proprio algoritmo determina. A acuracia utiliza em sua funcao um erro calculado quando a amostra a ser rotulada nao recebe o rotulo determinado corretamente no treinamento. Quanto menor for este erro, maior sera a acuracia.
Tabela 2.4: Resultados obtidos das duas baterias de classificação.
	Mantiveram		Bateria 1			Bateria 2 Acuraria
			Alteraram		Acuracia	
NA1A	23	60,5%	15	29,5%	59,0%	75,1%
NA02	49	92,4%	4	7,6%	69,7%	75,7%
NA04	138	85,7%	23	14,3%	71,9%	78,4%
NA07	145	80,5%	35	19,5%	66,5%	77,3%
NA11A	262	93,6%	18%	6,4%	67,6%	85,3%
RJS234	192	96,9%	6	3,1%	53,6%	75,9%
RJS42	53	84,1%	10	15,9%	65,6%	68,6%
Ja na bateria 2, foram utilizadas todas as 1950 amostras com testemunhos de todos os pocos na fase de treinamento, para realizar um treino com um banco de dados maior. A classificacao foi realizada como na bateria 1, isto e, os dados a serem classificados eram as amostras sem testemunhos agrupados com a outra metade das amostras com testemunhos. Por isso, ao analisar a validacao cruzada, nao foi detectada nenhuma alteracao nas amostras com testemunhos, pois estas amostras ja estavam contidas no conjunto de treinamento. Mas, como esperado, ao utilizar um conjunto maior de treinamento, a tendencia do elemento mais representativo da classe ser escolhido durante a competicao e maior, diminuindo o erro, aumentando significativamente a acuracia. O perfil de classificacao deste poco pode ser observado na Figura 2.2. A matriz de confusao do poco NA07 e apresentada na Figura 2.3, onde 89,75% dos rotulos foram mantidos.
Figura 2.2: Perfis dos resultados da classificação por OPF do poço NA07.
Treinamento
	1	2	3	
1	73 20.22%	1 0.28%	6 1.66%	91.3% 8.75*
2	2 0.55%	40 11.08%	11 3.05%	75.5% 24.53%
3	7 1.94%	10 2.77%	211 58.45%	92.5% 7.46%
	89.02% 10.98*	78.43% 21.57*	92.54% 7.48*	39.75%
Figura 2.3: Matriz de confusao dos resultados da classificaçao por OPF do poço NA07.
2.4	Conclusões
O metodo de classificacao supervisionada de padroes baseada em Floresta de Caminhos (Ótimos (Papa et al., 2009b) utilizado nesse trabalho para classificacao de dados de pocos, mostrou-se ser um metodo simples, rápido e eficiente.
Foram feitas duas baterias de treinamento e classificacao: a bateria 1 resultou em acurácia media de cerca de 64,8% e apresentou a manutencao de 87,1% das classes originais na validacao cruzada utilizando metade das amostras de treinamento. Na bateria 2 foi utilizado todo o conjunto de amostras com testemunhos para treinamento e a acurácia media aumentou para cerca de 76,8%.
O metodo apresenta tambem algumas qualidades interessantes, como nao necessitar de que o numero de classes das amostras seja igual. Isso pode ser confirmado ja que alguns pocos apresentavam um número muito pequeno de amostras de certa classe e em alguns casos nao possuíam nenhuma amostra.
2.5	Agradecimentos
Gostaríamos de agradecer a Agencia Nacional de Petroleo (ANP) pela disponibilizacao dos dados para estudos e pelo apoio financeiro.
3	Segmentation of sandstone thin section images with separation of touching grains using optimum-path forest operators
Authors: Ivan Mingireanov Filho, Alexandre Campane Vidal,
Alexandre Xavier Falcao, Thiago Vallin Spina
Abstract
The segmentation of detrical sedimentary rock images is still a challenge for characterization of grain morphology in sedimentary petrography. We propose a fast and effective approach that first segments the grains from pore in sandstone thin section images and separates the touching grains automatically, and second lets the user to correct the misclassified grains with minimum interaction. The method is mostly based on the image foresting transform (IFT) — a tool for the design of image operators using optimum connectivity. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The IFT algorithm transforms the image graph into an optimum-path forest and distinct image operators are designed by suitable choice of the IFT parameters and attributes of that forest. The solution involves a sequence of three IFT-based image operators for automatic segmentation and the interactive segmentation combines region- and boundary-based object delineation using two IFT operators. Tests with thin section images of two different sandstone samples have shown very satisfactory results, yielding r2 and accuracy parameters of 0.8712 and 94.8% on average, respectively. Biases were the presence of the matrix and rock fragments.
3.1	Introduction
The morphology of grains is important to the textural characterization of detritical sedimentary rocks. Grain properties such as roundness and sphericity, for instance, allow us to
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
infer information about provenance and transport. However, touching grains and the high variability of grain shapes in a single rock make the problem very challenging for automatic image analysis (Ehrlich and Chin, 1980).
Many techniques have been proposed to automate the characterization of grain morphology in sandstone thin section images. However, the accuracy of the automatic image segmentation methods (Van de Berg et al., 2002; Choudhury et al., 2006; Lu et al., 2009; Gorsevski et al., 2012) has been severely compromised by the presence of touching grains, despite the large number of distinct strategies based on: Partial Differential Equations (PDE) (Lu and Ning, 2010), Level Sets (LST) (Lu et al., 2009), Seed Region Growing (SRG) (Choudhury et al., 2006), Geographic Information Systems (GIS) using arcGIS ModelBuilder to combine images (Choudhury et al., 2006; Li et al., 2008; Gorsevski et al., 2012), and cellular automata (CA) (Gorsevski et al., 2012).
Indeed, automatic segmentation remains a challenge in most image processing applications. The absence of previous knowledge about the object under segmentation very often makes user intervention a necessity (Dengiz et al., 2005; Choudhury et al., 2006; Lu et al., 2009). We may divide the image segmentation process into two tightly coupled tasks: object recognition (location and verification) and delineation. While humans are superior than computers in recognition, computers are able to do precise delineation even when inaccurate. Therefore, the aim of semi-automatic image segmentation methods is usually to minimize the time spent by the user and amount of interaction required for delineation, while maximizing the accuracy and precision of segmentation (Falcao et al., 1998; Spina et al., 2011a).
We propose a grain image segmentation method consisting of two major components: automatic image segmentation of touching grains and interactive correction of the misclassifications using Live Markers (LM) (Spina et al., 2011b). Both parts of our method are based on the Image Foresting Transform (IFT) (Falcao et al., 2004) — a tool for the design of image operators using optimum connectivity. The IFT interprets an image as a graph, whose nodes are the image pixels, the arcs are defined by an adjacency relation between pixels, and the paths are valued by a connectivity function. The IFT algorithm transforms the image graph into an optimum-path forest and distinct image operators are designed by suitable choice of the IFT parameters and attributes of that forest.
Our strategy is first to segment the grains from the darker background and separate touching grains automatically (Figure 3.1). Our automatic grain segmentation method can be divided into three steps, each using a distinct IFT-based image operator. First, we use clustering based on color similarity to output a binary segmentation mask from the grain image, by considering the clusters with brighter pixels as representative of the grains. Then, we compute
3.	SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
Image input
Figure 3.1: Sequence of image operations for grain determination.
an Euclidean distance transform (EDT) constrained to propagate inwards from the connected grains’ boundaries. The resulting image has domes with peaks inside each grain, which are used to split the grains through a controlled inverted watershed transform (i.e., this IFT outputs an image that assigns a unique grain label to every pixel).
Live Markers is an IFT-based method for effective user-steered image segmentation (Spina et al., 2011b). LM allows fine corrections of our automatic approach result by giving the user tight control over the selection of where to do the adjustments. We also use LM to generate ground-truth images to be compared with the automatically segmented image (Choudhury et al., 2006; Falcao et al., 1998; Spina et al., 2011a). We measure the effectiveness of our method by considering our results’ accuracy with respect to the ground-truths (Papa et al., 2009b) and the amount of the user’s effort required for correction (Spina et al., 2011a).
This paper is organized as follows. We detail our method in Section 3.2. Section 3.3 presents our results and Section 3.4 states conclusion remarks.
3.2	Methods
In the folowing sections, we first describe the IFT and the image processing operators we use in our automatic grain segmentation method. Then, we describe the automatic segmentation pipeline and how to use Live Markers for interactive correction. Since we allow interactive intervention, we measure the method’s accuracy according to the measures proposed in (Spina et al., 2011a) and (Papa et al., 2009b), respectively.
3.	SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
3.2.1	Image Foresting Transform
The Image Foresting Transform (IFT) is a generalization of Dijkstra’s algorithm (Dijkstra, 1959) which handles multiple sources and more general connectivity functions Falcao et al. (2004). The IFT algorithm works by computing an optimal partition of the graph into sets of nodes (forest), where each set is a tree of optimum paths whose nodes are most strongly connected to the root of their tree (minima/maxima of the optimum connectivity map) than to any other.
The IFT algorithm starts with trivial paths for all the nodes, and propagates optimum paths from the roots by forcing them to compete for the remaining nodes of the graph. The process follows a non-decreasing order of the optimum cost (non-increasing order of connectivity values). The IFT outputs several attributes, organized as mapping functions/images, for each node in the graph that are used differently depending on the image processing operator being designed (Falcao et al., 2004) (e.g., the node’s root label, optimum-path cost, and predecessor node in the optimum-path).
3.2.1.1	Graphs from images
Formally, an image I can be defined as a pair (Dj, I), where Dj C Z2 corresponds to the image domain and I(t) determines a color vector (I^t), I2(t), I3(t)) in the RGB color space. The extraction of attributes transforms an image I = (Dj, I) into a pair F = (Dj, F), where F(t) = (F^t), F2(t),..., Fm(t)) is a vector of attributes assigned to t. In our case, we seek some lightness invariance by defining F using simply the Cb and Cr channels after converting I to the YCbCr colorspace (i.e., m = 2).
In our approach, a graph (N, A) may be created by taking a setNQ Dj of pixels as nodes and defining an adjacency relation A between the nodes of N as arcs. The notation t E A(s) or (s,t) E A indicates that a node t E N is adjacent to node s E N. The adjacency relations we use in our method are:
t e Ai(s)
if \\t — s||&amp;lt;42, Vs,t E Dj,
(3.1)
t E A2(s)
if t E N is a k-nearest neighbor
(3.2)
of s E N in the feature space.
The adjacency relation Ai is
used in the EDT and inverted watershed transform with
N = Dj, making adjacent every 8-neighbor pixel on the image domain. The other adja-
3.	SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
cency relation A2 is used by the clustering algorithm and will be detailed in section 3.2.I.4. The weights w(s, t) for all arcs (s, t) e A are computed in different ways for each IFT-based operator, sometimes using the feature vectors F and selected markers (user-drawn strokes, when the user’s correction is necessary).
3.2.1.2	Connectivity Functions
A path nt = (t1, t2,...,t) in a graph is a sequence of adjacent nodes ending at node t. The extension of a path ns by an arc (s, t) is expressed by nt = ns • (s,t), with nt = (t) denoting the trivial path. A connectivity function f assigns a value f (nt) to any path nt in a graph, which represents how strongly connected node t is to the path’s root. For example, functions fmax and fmin propagate the maximum and minimum arc weight values along the path, respectively
fmax((t))	= H (t)
fmax(ns • (s,t)) = max{fmax(ns),w(s,t)},	(3.3)
fmin((t))	= H (t)
fmin(ns • (s,t)) = min{fmin(ns), w(s,t)},	(3.4)
where H(t) is a handicap value specific to each IFT-based operator (Falcao et al., 2004; Spina et al., 2011a).
3.2.1.3	Optimum-path forest
A path nt is optimum when f (nt) &amp;lt;f (t/) for any other path Tt in (N, A). An optimum connectivity map V(t) is created by considering every possible path ending at each node t e N using the function
V(t) =	min {for	(3.5)
Vnt in (N ,A)
V (t) =	max , ,{f (nt)}.	(3.6)
An optimum path forest is computed using the IFT algorithm 1 to solve the above minimization (or maximization) problem. An OPF is an acyclic function P that assigns to every node t e N its predecessor P(t) e N in an optimum-path or a distinctive marker P(t) = nil e N, when (t) is optimum (i.e., t is said a root of the forest). Figure 3.2 rep-
3.	SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
resents an OPF computed by forcing the roots to be in the seed set M using fmax({t}) with H(t) = 0 if t E M, or H(t) = x otherwise.
Figure 3.2: (a) A 4-neighborhood graph with set of seeds M = {(0,0), (2, 2)}, considering the origin (0, 0) of pixels coordinates (x,y) in top left and the numbers as arc weights. (b) An optimum-path forest P computed to the function fmax with two roots in S. The numbers inside the nodes show the optimum connectivity map V(t) by Eq. 3.5 and the arrows indicate predecessor node P(t).
The general IFT algorithm solves the minimization (maximization) problem of Eq. 3.5 (Eq. 3.6), for a connectivity function f that satisfies certain conditions required for only optimum paths (Falcao et al., 2004). The root R(t) of each pixel t can be obtained by following its optimum path backwards in P (Figure 3.2b). However, it is more efficient to propagate R(t) on-the-fly, creating a root map.
Algorithm 1 - IFT Algorithm for fmax
Input:	Graph (N, A) and connectivity function f.
Output:	Optimum-path forest P, its connectivity value map V and its root map R.
Auxiliary:	Priority queue Q and variable tmp.
1. For each t eN, do
2
3
P(t)	nil, R(t)	t and V(t)	f ({t}).
- If V (t) = +x, then insert t in Q.
4
While Q = do
5.
6.
7.
8.
9.
10.
11.
Remove s from Q such that V(s) is minimum.
For each t e A(s), such that V(t) &gt; V(s), do Compute tmp	f (ns • {s, t}).
If tmp &amp;lt;V (t), then
If V (t) = +x, then remove t from Q.
Set P(t)	s, R(t)	R(s), V(t)	tmp.
- L Insert t in Q.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
Lines 1-3 initialize maps for trivial paths. The minima of the initial map V compete with each other and some of them become roots of the forest. They are pixels with optimum trivial-path values, which are inserted in queue Q. The main loop computes an optimum path from the roots to every node s in a non-decreasing order of path value (Lines 4-11). At each iteration, a path of minimum value V(s) is obtained in P when we remove its last pixel s from Q (Line 5). Ties are broken in Q using first-in-first-out policy. The remaining lines evaluate if the path that reaches an adjacent pixel t through s is cheaper than the current path with terminus t and update Q, V(t), R(t) and P(t) accordingly.
3.2.1.4	Clustering by optimum-path forest
Let N = Sc Dj be a set of pixels randomly sampled from the image, such that |S| « 200. The clustering process takes a set of sample pixels from I, along with their corresponding feature vectors from F, and feeds them to an OPF unsupervised classifier (Rocha et al., 2009). High concentration of samples indicates data clusters which are represented by prototypes (key nodes) of the OPF classifier. Each prototype becomes the root of an optimum-path tree (cluster), thus partitioning S into an optimum-path forest (clustering of S). The Euclidean distance d(s,t) = \\F(s) — F(t)|| between the feature vectors F(s) and F(t), of samples s, t G S, determines the arc-weights w(s, t) of the graph (S, A2). We compute graph (S, A2) according to those arc weights by considering the k nearest samples t of s when defining the arcs (s,t) G A2.
Another parameter used to weigh the nodes of the graph is the probability density function (pdf) computed according to Eq. 3.7. If a region contains a high concentration of samples, the distances between the k nearest neighbors will be smaller, thus resulting in a pdf maximum. Considering that the lowest density along a path in the graph represents its value, and that the optimum path from a pdf maximum to a sample is the one with maximum value, the pdf maxima will compete for samples s G S and each maximum will define an influence zone (optimum-path tree or cluster) composed of the samples most strongly connected to it than to any other maximum.
P(s)
1
/2na2 |A.2(s)|
exP
t€A2(s)
^—d2(s,t)^
(3.7)
where a = maxv(Sii)eA2
For such purpose, fmin is used with H(t) = p(t), if t G R c S, where R is the root
(prototype) set of the forest with one sample per pdf maximum, or H(t) = p(t) — S, with
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
6 = min(S;t)€A2|p(t)=p(s) |p(t) — p(s)|, if otherwise. The maximization of fmin using the IFT algorithm automatically defines the prototypes s e R, which are identified as samples s removed from Q in Line 5 of Algorithm 1 with P(s) = nil. This requires to initialize V(t) p(t) — 6 for all pixels t e S in Line 2, verify between Lines 5 and 6 if P(s) = nil, and then to set V(s)	p(s), C(s)	c, c c +1 (where c = 1, 2,..., |R| is a variable that assigns a
unique label c to each cluster), and finally to propagate the cluster labels in Line 11 by adding C(t) C(s).
The unsupervised learning of the OPF classifier consists of finding a suitable value for k in the adjacency relation A2 and computing an optimum-path forest in the feature space. If a pdf maximum is located on a plateau, it is necessary to make sure that only one prototype conquers the remaining samples of this maximum. This cannot be solely assured by the initialization of fmin, because A2 is not a symmetric adjacency relation. Therefore, A2 must be extended to guarantee that plateau samples are interconnected. This is accomplished by defining A3 such that if t e A(s), s / A2(t), and p(s) = p(t) then
A3(t)	A2(t) U {s}.	(3.8)
The choice of the most suitable k is done by computing the result of the algorithm on the graph (S, A3), for k = kmin, kmin + 1,..., kmax, and selecting the k*-adjacent graph (and forest) that minimizes the normalized cut (Shi and Malik, 2000).
A sample t e D/\S is classified in one of the clusters by identifying which root would offer it an optimum path. By considering the adjacent samples s e A3(t) C S, we compute p(t) using Eq. 3.7, evaluate the paths ns • (s,tj, and select the one that satisfies
V(t) = max {min{V(s),p(t)}}.	(3.9)
v(s,t)eAs
Let s* e S be the node that satisfies Eq. 3.9. The classification simply assigns C(s*) as the cluster of t.
3.2.1.5	Euclidean distance transform
In the Euclidean IFT, the path-cost function is such that the cost of a path from a seed s to a pixel t in the forest is the Euclidean distance between s and t in the image domain. The algorithm considers an 8-neighbor image-graph (Dp, Ax), derived from a binary image B, and assigns three attributes to each object pixel p: the squared Euclidean distance V(t) between t and its closest point s in the contour (forming an optimum path-value map), its closest seed
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
R(t) = s (forming a root map), and the label L(t) = L(s) of the segment that contains s (forming a root label map). The corresponding connectivity function is simply given by
feucl ((0)	= H (t)
feuci(ns • (s,t)) = (xs - xR(t))2 + (ys - yR(t))2	(3.10)
where s = (xs, ys) represents the (x, y) coordinates for a pixel s in the image, and H(t) = 0 for all samples t in a set B defined by the pixels belonging to the desired contour.
3.2.1.6	Segmentation by inverted watershed
A classical watershed transform can oversegment the image into all catchment basins of a given grayscale image I(t). The segmentation can be simplified by closing basins of I(t) with volume below a threshold (Salembier et al., 1998) (i.e., a morphological volume closing). Similarly, the inverted watershed segmentation can be controlled by opening the domes of I(t) above a certain threshold value and using the result as grayscale markers for IFT (Lotufo et al., 2002). The accomplishment of such operation via IFT requires the following parameters for segmenting a few regions within the grains. For the image graph (Dj, A1), the weight of edge (s, t) G A1 is defined as w(s, t) = I(t). We use function fmin from Eq. 3.4 with
H (t)
I(t)	if t G R,
max{VO(t) — 1,0} otherwise,
(3.11)
where R is the root set of the forest (maxima of VO(t) — 1) and VO(t) is the resulting function from morphological volume opening of I(t). Given that VO(t) &amp;lt;I(t), VO(t) — 1 is used to guarantee the roots in R will conquer all pixels in their domes. However, this requires a variant in Algorithm 1. Initially, all pixels start with H(t) = max{VO(t) — 1, 0}. When a pixel s is removed from Q in line 5 and P(s) = nil, this implies that s G R is a maximum of VO(t) — 1 and a new label l = 1,2,..., |R| must be created for s (i.e., we have the same situation during OPF clustering). By reducing H(s) to I(s) for all maxima s, the image is partitioned into an optimum-path forest with roots in R, whose result is a controlled segmentation of the image outputting a label map L(t). Note how clustering in the feature-space and watershed transformation in the image domain are closely related by the IFT algorithm.
3.	SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
3.2.2	Automatic Grain Image Segmentation Pipeline
Let C(t) be the cluster image resulting from unsupervised classification using OPF, after merging overlapping clusters (Figures 3.5-b, 3.6-b). Since the grains are brighter than the pores and the background, their cluster is selected to create a binary mask M(t) containing only the grains (Figures 3.5-c, 3.6-c).
We compute the Euclidean IFT using as roots the set of pixels B from the boundary of grains in M (t). The distance transform is further constrained to propagate inwards with respect to the boundary of the grains in the binary mask (i.e., the optimum-path forest only considers pixels t where M(t) &gt; 0). Hence, the final cost map V(t) possesses domes of bright values with maxima located near the center of the corresponding grains. Concurrently, we extract image edges by computing the gradient of the feature image F using an 8-neighbor adjacency relation, considering the stronger edge of the Cb and Cr features (Figures 3.5-d, 3.6-d). Afterwards, we combine the distance map V(t) with the edge detection result to better divide the connected domes/grains (Figures 3.5-e, 3.6-e).
The domes are automatically divided using the IFT-based inverted watershed from grayscale markers previously described, also constrained to the binary segmentation mask M(t). The final result of the inverted watershed transform is an image L(t) that assigns a label l = 0,1,..., n to every pixel representing either the background, l = 0, or a unique grain, l &gt; 0 (Figures 3.5-f, 3.6-f). Label image L(t) is ready to be used in any other program to compute petrophysical parameters as desired. Examples of automatic grain image segmentation can be seen in Figures 3.5-g, 3.6-g, 3.7-a.
3.2.3	Interactive Correction
Even though our automatic grain image segmentation method is quite effective, such task remains a great challenge. Therefore, the misclassified grains can be corrected interactively by an specialist using Live Markers (Spina et al., 2011b). LM is a hybrid tool that combines two powerful IFT-based methods, the differential IFT with seed competition (DIFT-SC) (Falcao and Bergo, 2004) and live-wire-on-the-fly (LWOF) (Falcao et al., 2000), benefiting from their best qualities. We use interactive segmentation by LM to both correct misclassifcation from our automatic approach and to generate ground-truth data.
In DIFT-SC, object delineation relies on the competition between object and background markers (seeds) selected by the user during the object recognition task. The seeds compete to conquer regions of the images using the IFT algorithm with function fmax (Falcao et al., 2004),
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
in a graph (Dj, Ax) with arc weights defined by the image edges. The object is defined by the union of optimum-path trees rooted at the object marker pixels (Figure 3.3b). The user can add or remove markers and the segmentation is recomputed differentially only for the region influenced by the altered seed.
(a)
(b)
(c)
Figure 3.3: (a) Result of automatic segmentation with misclassification. (b) One grain marker and two background markers to correct with DIFT-SC. (c) Correction segment with LWOF.
(d)	LM correction obtaining better delineation of grain shape.
A different interactive approach is used by LWOF (Falcao et al., 2000), in which delineation aims to have the user roughly guide the computer in selecting the object’s boundary. The object boundary segments are computed with constraints imposed by the user on the frontier between object and background (anchor points). Each segment is an optimum-path computed by the IFT between two adjacents anchor points, and the user guides the segmentation process while watching the optimum-path being generated on-the-fly, from the last point until the current mouse cursor position. Upon the selection of a new anchor point with a mouse click, the optimum-path segment snaps onto the boundary and is fixed throughout the delineation process.
Both of the aforementioned segmentation paradigms have complementary strengths and weaknesses, which can be exploited to reduce the user’s involvement. DIFT-SC is more effective with complex object shapes but inefficent due to leakings in regions with weak boundary information. LWOF allows to segment weak borders being able to block the leaking of DIFT-SC, despite requiring more user interaction and time. LM combines DIFT-SC and LWOF by transforming each boundary segment computed between two anchor points by LWOF into internal and external markers that block DIFT-SC leaking (Figure 3.3c).
LM’s hybrid approach allows the segmentation of the image with linear time in the first iteration and sublinear time in subsequent corrections, further reducing the required amount of the user’s time. Nevertheless, the segmentation quality strongly depends on a good estimation
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
of the arc weights for the IFT graphs (Miranda et al., 2010). The pattern classifiers based on IFT (Papa et al., 2009b; Rocha et al., 2009) are used to automatically choose the marked pixels that best help distinguish the object from the background (3.3b) (Spina et al., 2011a). The best pixels are used to compute a rich image gradient and estimate the arc weights for the DIFT-SC and LWOF graphs. This activity is naturally integrated with LM further simplifying the method’s interface, because the approach of (Spina et al., 2011a) also automatically determines where and when the arc weights can be recomputed to maintain the delineation’s accuracy.
3.2.4	Evaluation parameters
Accuracy is a parameter usually computed to validate classification processes and the proposition in Papa et al. (2009b) was adapted to evaluate the misclassification. The ground truth image is generated by user’s interactive corrections in automatic segmentation result. The accuracy parameter considers changes in the labels occurred during the segmentation correction process, generating a remapped image from the root map and the ground-truth image, identifying which grain pixels kept their labels and which were altered. The different sizes of labels after the corrections are considered. Typical and expected missclassification are shown in Figures 3.3-a, 3.4.
Let n be the number of pixels of the segmented image, and nelement(i) the number of pixels of each label i and nlabel the number of labels after corrections:
FP(i)
ei,i =-------, (i) 4 and	(3.12)
n — nelement(i)
ei,2 =
FN) nelement(i)
, i = 1,.
nlabel
(3.13)

where FP(i) is false positive and FN(i) is false negative. FP(i) is the number of samples from the other label that were classified as being from the label i in n and FN(i) is the number of samples from the class i incorrectly classified from other classes in n. The accuracy parameter is determined by Eq.3.14.
Acc = i — s‘=°(e;\+
2(nlabel)
(3.14)
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
(a)	(b)
(c)	(d)
Figure 3.4: Examples of common misclassifications and their corrections. (a) The grain is split in two. The desired label is picked by a tool in the interface and the correction region is marked. (c) The two touching grains are segmented as one. The correction is analog the other, except the creation of a new label. (b) and (d) are the results after running DIFT-SC.
Other parameters are used to quantify the corrections. Weighted Grain Subdivision Error (WGSE) is the sum of the differences between the grain area from automatic segmentation and ground-truth, weighted by the sum of the area of only the corrected grains. For example, if a grain was segmented in four grains in the automatic process, WGSE weighs each area of theses subdivisions so that the misclassification in the larger grains become more relevant. To understand the relevance of changes as a whole, Weighted Grain Subdivision Error Global (WGSE - Global) has a slight modification, being weighted by the sum of all grains area of ground-truth image. Similarly, Percentage of Grain Area (PGA) parameter gives another global view computing the area of altered grains weighted by all grains area.
3.3	Results and discussion
The tests were applied to 151 images of sandstone thin sections images, in which porosity is delineated by injection of blue-stained epoxy. In general, all grains were well segmented from the pores and almost all grains in touch were separated properly. They took ca. 35 seconds for each 8 megapixel to be processed by a computer with 2.80 GHz CPU frequency, 4GB
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
RAM and using Ubuntu OS. However, there were three groups of missclassification: 79.5% of images need a little user interaction to correct them, 11.9% need more user interaction and effort, and as expected, these misclassifications occurred during separation of touching grains and they were influenced by matrix with quartz grains and rock fragments. In the 8.6% of images, the procedure failed in the segmentation due low pore contrast, high presence of matrix between grains and higher magnification of microscope.
Two more representative samples were chosen to correct and measure the accuracy parameters. Sample S1 (Figure 3.5-a) is a weakly sorted sub-arkose, showing clayey matrix in some portions of the thin section and grain fabric resulting from low compaction and dissolution. The difficulty in segmentation is due the presence of different grain sizes and clay minerals in the fractures and cleavages of the grains. Sample S2 (Figure 3.6-a) is a less porous and better-sorted sub-lithic sandstone. Contacts between grains are more common. Despite the predominance of quartz grains, rock fragment are also present. The rock fragments and the contact between grains interfere in the automatic image segmentation.
The misclassification was characterized by two situation during separation of touching grains. The first situation occurred when the edge was not strong enough between two grains, creating just one label. The other was dark pixels in the grain fabric, creating false edges and extra domes in EDT, consequently creating different grains (Figure 3.7-a). Correction of the first situation was easy by using DIFT-SC makers to add a new label. The second situation was corrected by just using the tool to copy the label from one grain to the other (Figure 3.7-b).
Other misclassification occurred with quartz grains in the matrix that have pixels more similar to the clastic grains, smoothing the edges between them (Figure 3.7-a). The corrections were made by DIFT-SC markers, except when the matrix was darker. In this case, the LM tool was used since the similarity to pore was increased (Figure 3.7-b).
Rock fragments are texturally more heterogeneous, resulting in bright and dark pixels. The algorithm identifies the bright pixels as small grains and the dark pixels as more similar to the pores, and consequently these fragments are not interpreted as only one grain (Figure 3.8-a). To illustrate the differences between corrections of this misclassification, the corrections made in grains (i) and (ii) in Figure 3.8-b using the DIFT-SC tool required more markers than usual, whereas the corrections made in grains (iii) and (iv) in Figure 3.8-b using the LM tool required less markers and effort to obtain a precise segmentation.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
c)	d)
g)
Figure 3.5: (a) Sample S1 - Input image of the porous sandstone, showing irregular grains of varied sizes and clayey matrix. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with the image of labeled grain.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
c)	d)
g)
Figure 3.6: (a) Sample S2 - Input image of the more compact sandstone. (b) Three-cluster image, including background. (c) Grain binary mask from the brighter clusters. (d) Edges detected by stronger gradient of features Cb and Cr. (e) Combination of Euclidean IFT within grains and edges image. (f) Image of labeled grains. Each grain has its label as pixel values. (g) Original image combined with image of labeled grain.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
(b)
(a)
Figure 3.7: (a) Detailed image of grain segmented from the background and others grains. (b) Image with misclassifications corrected by Live Markers.
Figure 3.8: (a) Details of misclassification of rock fragments by automatic segmentation. (b) In the correction, DIFT-SC markers had a small leaking in (i) and (ii). LM needed a little more interaction but the delineation was more precise in (iii) and (iv).
A time-consuming process would be deleting tiny grains manually. Thus, a filter was used to delete grains with areas smaller than 10% of average grain area, which corresponded to 254 pixels in sample S1 and 333 pixels in sample S2. Almost 40% of the grains were filtered, corresponding to approximately 1% of the total grain area.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
The light of compound microscope has created a circular border effect decreasing the pixel brightness from the illuminated to shaded region, making the segmentation of the grains in the shaded region very difficult. These grains were deleted and a considerable area was excluded in the interactive correction.
The final number of grains after the interactive corrections and the ratios between the total grain areas from the ground-truth and the automatic segmentation images are shown in Table
3.1.	The corrections of rock fragments in sample S2 led to an increase in the grain-area ratio.
Table 3.1: Comparative results after processes
	Number of grains		Grains area ratio (%)	
	S1	S2	S1	S2
Automatic	825	803	-	-
Segmentation				
Interactive	409	556	96.2	102.7
corrections				
The evaluation parameters that compare label changes in the ground-truth image with the automatic segmentation results are highly satisfactory (Table 3.2). The results show the difference between the two samples, given that sample 2 has more matrix and rock fragmentes, demanding more user interaction. Accuracy was higher than 90% and WGSE global lower than 10%, indicating that label changes were few.
Table 3.2: Evaluation parameters results
	S1 (%)	S2 (%)
Accuracy	97.9	91.7
WGSE - Global	6.49	9.47
WGSE	29.1	39.1
PGA	22.3	24.2
Figure 3.9 presents comparison between the total grain areas obtained by automatic segmentation and the respective interactive corrections. If the automatic segmentation were perfect, the points would be aligned in the red line. However, the areas of 9.8% of grains in sample S1 had to be altered and 53.9% of erased grains. For sample S2, the areas of 17.3% of the grains were modified and 40.6% of grains erased. The trend line is represented in blue and R-squared computed for samples S1 and S2 were respectively 0.9365 and 0.8059.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
Figure 3.9: Relationship between automatic segmentation areas and interactive corrections area of sample S1 (a) and sample S2 (b).
3.4	Conclusions
A new application of the IFT algorithm in petrophysical image analysis is shown in this work. It proved to be a very quick and precise tool in image segmentation with the advantage of being adaptable to any kind of grain, regardless of its shape or size. An excellent distinction of grains from background and pores is obtained, generating a good binary mask.
The separation of touching grains was relatively good, but with unavoidable misclassification. The option of interactive correction was very easy to use and the effort depends on how precise the specialist wants or needs the segmentation to be. The values of the evaluation parameters comparing the automatic segmentation image with the ground-truth image were very high, proving it to be a reliable automatic process. In other words, the automatic process is an adequate option for a fast result with no need of user interaction.
3. SEGMENTATION OF SANDSTONE THIN SECTION IMAGES WITH SEPARATION
OF TOUCHING GRAINS USING OPTIMUM-PATH FOREST OPERATORS
4	Aplicabilidade do metodo de segmentação automatica em analise morfológica dos grãos
4.1	Introduçao
O principal objetivo deste capítulo é apresentar possíveis aplicações do método desenvolvido no capítulo 3.
A analise morfológica de partículas sedimentares permite inferir sobre as informacoes de origem, transporte e ambientes deposicionais de sedimentos. A morfologia do grâo pode ser determinada pela combinacao de três propriedades independentes: forma - dimensoes do grao; arredondamento - suavidade do contorno do grao; e textura - rugosidade da superfície. A fim de demonstrar as possíveis aplicacoes que podem ser desenvolvidas a partir do metodo de segmentacao automatica, descrito no capítulo 3, neste capítulo utilizamos tecnicas para determinar a forma dos grâos, na secao 4.1.1. As tecnicas utilizadas na secao foram baseadas nos estudos realizados por Aschenbrenner (1956), Barrett (1980) e Benn and Ballantyne (1993).
A porosidade da rocha na analise petrofísica e uma parâmetro de muito interesse para o planejamento da producao dos pocos de exploracao. Na secao 4.1.2 e realizada uma estimativa da porosidade da rocha baseada na segmentacao realizada na imagem.
4.1.1	Determinação da forma do grao
A forma do grao e definida pela determinacao de parâmetros como esfericidade (Wadell, 1932; Aschenbrenner, 1956; Sneed and Folk, 1958), fator de forma F (Aschenbrenner, 1956), Projecao de Esfericidade Maxima (MSP) (Sneed and Folk, 1958) e índice Oblato-Prolato (Dobkins and Folk, 1970).
Todos esses parâmetros de forma do grao podem ser determinados a partir da medida dos eixos (a) maior, (b) intermediario e (c) menor. ísso torna-se possível a partir do momento em que o metodo de segmentacao automatica proposto no capítulo 3 permite gerar uma imagem
4.	APLICABILIDADE DO METODO DE SEGMENTAÇÃO AUTOMÁTICA EM
análise morfológica dos graos
de rótulos distintos dos grãos. Uma rotina computacional analisa cada grão individualmente, detectando as bordas do grao e por sistema de coordenadas polares. Com isso sao determinados os eixos utilizando os pixels da borda. Os trabalhos de Zingg (1935), Aschenbrenner (1956), Sneed and Folk (1958) e Dobkins and Folk (1970) propoem as relacoes da Tabela 4.1 para modelar e representar a forma dos graos.
Tabela 4.1: Descricao das equacoes para estimativa da forma do grao de acordo com os três eixos maior (a), intermediario (b) e menor (c). Sao utilizadas as relacoes p = b/a e q = c/b.
Descricão	Equacao	Autor(es)
Razoes dos eixos	p = a; q = c	Zingg (1935)
Working Sphericity	i2.^/p2q	Aschenbrenner(1956)
	1+p(1+q)+6^1+p2(1+q2)	
Esfericidade de	3 rc2 y ac	Sneed and Folk (1958)
projecao maxima (MSP)		Aschenbrenner(1956)
Fator de forma F	ac b2	Aschenbrenner(1956)
Indice Oblato-prolato	10(( a— )-o.5)	Dobkins and Folk (1970)
	c a	
Indice disco-haste	a-b a- c	Sneed and Folk (1958)
Zingg (1935) propõe um diagrama cartesiano para relacionar as formas dos grãos, sendo que a relacao p = b/a e atribuída ao eixo das ordenadas e q = c/b ao eixo das abscissas. As regioes das classes sao delimitadas pelos valores p = 0.67 e q = 0.67, sendo as formas dos seixos classificadas de acordo com a Tabela 4.2.
Tabela 4.2: Classes segundo as formas dos seixos segundo Zingg (1935).
Classe	Forma dos seixos
I	Tabular, oblato ou discoidal
II	Equidimensional ou Esférico
III	Laminar ou triaxial
IV	Prolato ou bastonado
O índice de esfericidade primeiramente proposta por Wadell (1932) utiliza as medidas do volume do grao e o volume da maior esfera circunscrita no grao. Krumbein propoe uma aproximacao que utilize apenas os eixos propostos por Zingg (1935). Posteriormente, Aschenbrenner (1956) propoe uma aproximacao baseada na figura do Tetradecaedro, denominada
4. APLICABILIDADE DO METODO DE SEGMENTAÇÃO AUTOMATICA EM
ANALISE MORFOLÓGICA DOS GRAOS
'Working Sphericity', também baseada nos eixos principais e que mostra-se ser mais próxima à forma dos detritos dos clastos.
Sneed and Folk (1958) propoem um índice de esfericidade de projecao maxima (MSP), sugerindo que a esfericidade deve ser expressa para seu comportamento em um fluido, representando o arrasto e a forca gravitacional que agem em uma partícula imersa em um fluido, sendo um importante índice de comportamento de partículas transportadas ou sedimentadas em agua. É considerado um índice util no contexto hidráulico, porem nao pode ser generalizado. O diagrama de Zingg (1935) representa b/a vs c/b e permite Aschenbrenner (1956) expressar a forma dos graos em termos da 'Working Sphericity' e do Fator deforma F.
Outra proposta realizada por Sneed and Folk (1958) e um diagrama triangular para representar achatamento, alongamento e compactacao dos graos, nos vertices do triangulo. Deste modo, consegue relacionar e dividir as classes em achatado, laminado e alongado, devido a razao c/b e (a — b)/(a — c). O diagrama destaca a característica fundamental das formas e a maneira que convergem no tipo compacta (Figura 4.1-a).
Figura 4.1: Diagramas triangulares (a) as 10 classes descritivas definadas por Sneed and Folk (1958) C - Compact (Compacta), P - Platy (achatada), B - Bladed (laminada), E - Elongate (Alongada) e V - Very (Muito); (b) Isolinhas de Máxima Projecao de Esfericidade (MSP); (c) Isolinhas de Indice de Oblato-Prolato. Figuras adaptadas de Benn e Ballantyne (1993)
Os índices MPS e Oblato-Prolato permitem gerar diagramas triangulares em função de c/b (Figura 4.1-b e 4.1-c). Apesar de todos os gráficos serem gerados do mesmo conjunto de dados, i.e. a partir das dimensões dos eixos principais, uma tendencia em um diagrama pode nao necessariamente ser legitimada por outro.
4.	APLICABILIDADE DO METODO DE SEGMENTAÇÃO AUTOMÁTICA EM
análise morfológica dos graos
4.1.2	Estimativa de porosidade da rocha
Os graos de rocha nunca se encaixam perfeitamente devido a irregularidade nas formas dos graos. O espaco vazio entre os graos e denominado poro e e ocupado por fluídos. A porosidade pode ser definida por: A = Vporo , onde A e a porosidade, Vporo e o Volume do poro e Vrocha e o Volume da rocha em analise (Tiab and Donaldson, 2004). Uma estimativa da porosidade da rocha pode ser determinada analisando o número de pixels que compoe a area dos poros e a area total da imagem, levando a A = A010, onde Aporo corresponde ao numero de pixels do poro e Atotaí ao número de pixels total da imagem.
4.2	Resultados e discussao
Para analise morfologica dos graos foram utilizadas, alem das amostras S1 e S2 (apresentados no capítulo 3), mais 5 amostras de arenito para a segmentacao automatica e correcoes, denominadas de Amostra S3 a Amostra S7, respectivamente (Tabela 4.3).
Tabela 4.3: Descricao das imagens das amostras
Nome da amostras	Resolucao (megapixel)	Breve descricao
S1	14	Menos ampliada, vignetting
S2	14	Menos ampliada, vignetting
S3	14	Menos ampliada, vignetting
S4	14	Mais ampliada, graos maiores
S5	3.4	Mais ampliada, graos maiores
S6	3.4	Mais ampliada, graos maiores
S7	3.4	Mais ampliada, graos maiores
As novas amostras sao semelhantes as Amostras S1 e S2, com diferencas que S5 a S7 tem resolucao menor e S4 a S7 estao mais ampliadas, apresentando graos maiores preenchendo toda a imagem. As imagens S1 a S3 apresentam o efeito de vignetting (reducao do brilho na periferia da imagem comparado com o centro da imagem), causado pela lente na situacao de baixa ampliacao do microscopio.
As imagens das amostras S3 a S7 foram segmentadas automaticamente e corrigidas pelo metodo descrito no capítulo 3. Neste capítulo sao apresentadas os resultados apenas das imagens das amostras S3 e S6, os resultados das demais imagens sao apresentadas no Anexo A.
As Figuras 4.2-a e 4.3-a sao os resultados da segmentacao automática e as Figuras 4.2-b e 4.3-b sao as respectivas correções.
(a)	(b)
Figura 4.2: (a) Resultado da segmentacao automatica da Amostra S3. (b) Resultado da correcao interativa da Amostra S3.
(a)	(b)
Figura 4.3: (a) Resultado da segmentacao automatica da Amostra S6. (b) Resultado da correcao interativa da Amostra S6.
As medidas de acuracias realizadas de acordo com a secao 3.2.4 e estao apresentadas na Tabela 4.4. Os resultados foram bastante satisfatórios, sendo que as médias das acuracias, WGSE - Global e WGSE foram, repectivamente, 82.4%, 10.4% e 22.7%.
4.	APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRAOS
Tabela 4.4: Medidas de acuracia do metodo de segmentacao automatica e correcoes.
Nome da amostras	Acuracia (%)	WGSE - Global (%)	WGSE (%)
S1	97.9	6.49	29.1
S2	91.7	9.47	39.1
S3	90.7	9.59	19.3
S4	67.3	14.67	18.3
S5	79.9	15.13	21.3
S6	82.5	14.12	19.9
S7	79.4	3.40	11.7
Meídia	82.4	10.41	22.7
Os resultados refletem a influencia da presenca fragmentos de rocha e matriz nas amostras, levando o algoritmo de segmentacao automatica a interpretar os fragmentos de rocha como pequenos graos. A presenca da matriz faz com que seja necessaria a interpretacao do especialista para marcar os limites de alguns graos.
Como o principal objetivo deste capítulo e o estudo da morfologia dos graos, durante a correcao interativa foram descartados os graos muito diferentes da maioria com coloracao muito escura, e mantidos os graos mais semelhantes ou que conseguiam ser facilmente distinguíveis. Estes graos representam minerais diageneticos de (óxido de ferro, formados depois da deposicao, por isso nao podem ser considerados para uma analise morfologica relacionadas a processos deposicionais. Os graos utilizados na analise representam os graos de quartzo, que sao muitos semelhantes entre si e facilmente distinguíveis. Por consequencia, a area total dos graos corrigidos em relacao a area total dos graos obtidos pela segmentacao automatica variou de 2%.
Outra observacao e a independencia da necessidade do fundo escuro, presente nas Amostras S1, S2eS3. O algoritmo de segmentacao automatica foi aperfeicoado de modo a conseguir realizar o agrupamento tanto para recortes de imagens quanto imagens obtidas com maior ampliacao e para diferentes resolucoes.
Para o estudo da forma dos graos, a rotina determina os eixos maior, intermediario e menor dos graos, gerando uma imagem para verificacao dos contornos dos grâo e os eixos escolhidos. As Figuras 4.4-a e 4.4-b apresentam os resultados. Observa-se nas imagens que os graos da regiao de corte das imagens foram influenciados.
(a)	(b)
Figura 4.4: Contorno dos grãos e eixos das Amostras S3 (a) e S6 (b).
Com a determinaçao dos eixos dos graos, e possível gerar os diagramas 4.5-a e 4.5-b e classificar os graos segundo o critério de Zingg (1935). A distribuiçao das classes dos graos das 7 amostras esta apresentada na Tabela 4.5. A distribuicao das classes e uniforme entre as classes em todas as amostras.
(a)
(b)
III	&lt;♦ ♦♦
	+
	♦♦
Figura 4.5: Diagramas de Zingg (1935) das amostras S3 (a) e S6 (b).
O diagrama triangular de Sneed and Folk (1958) permite vizualizar a distribuicao dos graos pelas classes. As Figuras 4.6a e 4.6b apresentam os diagramas das amostras S3 e S6, respec-
4.	APLICABILIDADE DO METODO DE SEGMENTAÇÃO AUTOMÁTICA EM
análise morfológica dos graos
tivamente. O percentual da distribuição das classes está detalhado na tabela 4.6. Pode-se observar que a distribuiçao das classes e uniforme entre as classes em todas as amostras.
Tabela 4.5: Distribuicao dos grâos segundo criterio de classificacao de Zingg (1935).
	I	II	III	IV
Nome da	Tabular	Equidimensional	Laminar	Prolato
amostras	(%)	(%)	(%)	(%)
S1	9.0	64.2	12.7	14.1
S2	7.1	58.9	14.1	19.9
S3	4.0	67.5	2.0	26.5
S4	5.3	57.2	6.6	30.9
S5	11.1	54.7	16.7	17.5
S6	9.1	58.3	11.2	21.4
S7	6.2	60.8	11.5	21.5
Media	7.4	60.2	10.7	21.7
Desvio Padrao	2.5	4.4	4.9	5.6
Figura 4.6: Diagrama para determinacao de classes das amostras S3 (a) e S6 (b) segundo criterio de classificacao de Sneed and Folk (1958).
Os diagramas apresentam a distribuição da frequência de Fator de Forma F e do parámetro de esfericidade, obtidos para amostras S3 (Figuras 4.7a e 4.7c) e S6 (Figuras 4.7b e 4.7d), respectivamente. Apesar das imagens possuirem resoluções e ampliações diferentes, nao apresentaram diferenças significativas nas distribuicoes, pois sao do mesmo tipo de amostra.
4.	APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRAOS
Tabela 4.6: Distribuição dos grãos segundo critério de classificação de Sneed and Folk (1958) para as 7 amostras.
Nome da	C	CP	CB	CE	P	B	E	VP	VB	VE
amostras	(%)	(%)	(%)	(%)	(%)	(%)	(%)	(%)	(%)	(%)
S1	15.8	0.0	39.7	8.5	0.0	24.8	3.4	0.0	7.1	0.7
S2	16.3	0.0	36.2	7.4	0.0	27.0	3.9	0.0	8.9	0.4
S3	19.3	0.0	49.8	2.8	0.4	26.1	1.6	0.0	0.0	0.0
S4	14.5	0.0	45.4	4.6	0.7	23.7	3.9	0.0	5.9	1.3
S5	12.7	0.0	42.9	6.3	0.8	19.0	7.9	0.8	6.3	3.2
S6	17.6	0.5	35.8	5.3	0.0	25.7	7.0	0.0	8.0	0.0
S7	16.9	0.0	41.5	4.6	0.0	21.5	5.4	0.0	9.2	0.8
Media	16.2	0.1	41.6	5.7	0.3	24.0	4.7	0.1	6.5	0.9
Desvio Padrao	2.1	0.2	5.0	1.9	0.3	2.8	2.2	0.3	3.1	1.1
(a)
(b)
(c)
Amostra S6
0,2	0,3	0,4	0,5	0,6	0,7	0,8	0,9	1
Esfericidade ip'
“W
Figura 4.7: Diagrama de frequência de Fator de Forma das amostras S3 (a) e S6 (b); Diagrama de frequencia da esfericidade das amostras S3 (c) e S6 (d).
4. APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRAOS
Os diagramas triangulares na Figura 4.8 mostram a distribuyo do índice Oblato-Prolato dos graos e as respectivas isolinhas. Ao lado, encontram-se os respectivos diagramas de distribuigao de frequencia de ocorrencia dos valores para quantificacao e analise. Os resultados nas Figuras 4.8a e 4.8b sao da amostra S3 e Figuras 4.8c e 4.8d sao da amostra S6.
(a - b) / (a - c)
índice Oblato-Prolato
(a)
(a - b) / (a - c)
(c)
(b)
(d)
Figura 4.8: Diagrama triangular do índice Oblato-Prolato das amostras S3 (a) e S6 (c); Diagrama de frequencia dos respectivos índices Oblato-Prolato das amostras S3 (b) e S6 (d).
4. APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRAOS
Analogamente, a Figura 4.9 apresenta os diagramas triangulares da distribuicao do índice MSP e as isolinhas, juntamente com os diagramas de distribuicao de frequencia, das amostras S3 nas Figuras 4.9a e 4.9b, e S6 em 4.9c e 4.9d. Novamente podemos observar que nao houve discrepancia entre as amostras.
(a -1&gt;) / (a - c)
40.0
35.0
30.0
.CS
J 20.0
s O" e
15.0
10.0
5.0
0.0
Amostra S3
0.2	0.3	0.4	0.5	0.6	0.7	0.S	0.9	1
MSP
(b)
(a)
(a -1&gt;) / (a - c)
(c)
Amostra S6
0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9	1
MSP
(d)
Figura 4.9: Diagrama triangular do índice MSP das amostras S3 (a) e S6 (c); Diagrama de frequência dos respectivos índices MSP das amostras S3 (b) e S6 (d).
Os resultados obtidos quanto a forma comprovam a semelhanca entre as amostras, entretanto, a analise possibilita um estudo mais robusto conforme o grande numero de medidas realizadas. Assim, novos parâmetros podem ser obtidos, o que ocasionara a melhor describo da rocha.
4. APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRAOS
A porosidade da rocha foi estimada para as amostras S4 a S7, pois nao possuem o efeito de vignetting, ja que a regiao mais escura do fundo acabaria sendo considerada como poro. Os resultados apresentam-se na Tabela 4.7.
Tabela 4.7: Porosidade estimada.
Nome da amostra	A (%)
S4	41.8
S5	39.9
S6	43.8
S7	43.7
Os resultados de porosidade apontam as boas condicoes de reservatórios para essas amostras. As amostras sao provenientes da Formacao Botucatu, um importante aquifero da Bacia do Parana.
4.3	Conclusões
Os resultados deste capítulo demonstram algumas aplicacoes para o metodo de segmentacao automatica. Foram utilizadas mais 5 imagens de amostras semelhantes as utilizadas no capítulo 3, de laminas delgadas de rocha semelhantes. Os resultados apresentam altas medias de acuracia do metodo, reforçando aplicacao do metodo para esse fim. A presenca de fragmentos de rocha e matriz nas amostras influenciaram nos resultados, sendo a teícnica melhor aplicada para amostras com pouca matriz e mais homogenea em relacao a composicao mineralogica.
A morfologia do grao pode ser determinada por três propriedades: forma, arredondamento e textura. Neste estudo foi apresentado a utilizacao dos resultados do metodo de segmentacao automatica com o objetivo de definir a forma dos graos, uma vez que o problema de contato entre graos esta solucionado pelo metodo de segmentacao. Alem disso, o fato da técnica ser supervisionada por um especialista, permite o ajuste da imagem para realizacao das medidas dos eixos e a analise dos graos. A aplicacao mostrou-se bastante satisfatória, pois os diagramas apresentados tiveram alta coerência com a interpretacao realizada nas amostras. Houve pequena influencia da presenca de fragmentos de rocha e matriz nas amostras.
Para trabalhos futuros, a sugestao e que os graos que estejam na borda das imagens sejam eliminados para melhorar o estudo morfologico. Os graos nao foram eliminados visando manter um padrâo nas correcoes para uma uniformidade no calculo das acurâcias.
4.	APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRÃOS
Outras sugestoes sao o aperfeicoamento da estimativa da porosidade da rocha e o estudo das possibilidades de determinacao da permeabilidade a partir da porosidade, descrita em (Tiab and Donaldson, 2004), bem como a tortuosidade e conectividade dos poros.
4. APLICABILIDADE DO METODO DE SEGMENTAÇAO AUTOMÁTICA EM ANÁLISE MORFOLÓGICA DOS GRÃOS
5	Referencias Bibliográficas
Referencias Bibliográficas
Aschenbrenner, B.C., 1956. A New Method of Expressing Particle Shericity. Journal of Sedimentary Petrology Vol. 26, 15-31.
Barrett, P.J., 1980. The shape of rock particles, a critical review. Sedimentology 27, 291-303.
Benn, D.I., Ballantyne, C.K., 1993. The description and representation of particle shape. Earth Surface Processes and Landforms 18, 665-672.
Bishop, C.M., 1994. Neural networks and their applications. Review of Scientific Instruments 65, 1803 -1832.
Chiachia, G., Falcao, A., Rocha, A., 2011. Person-specific face representation for recognition, in: Biometrics (IJCB), 2011 International Joint Conference on, IEEE. pp. 1-8.
Choudhury, K.R., Meere, P.A., Mulchrone, K.F., 2006. Automated grain boundary detection by casrg. Journal of Structural Geology 28, 363-375.
Dengiz, O., Smith, A.E., Nettleship, I., 2005. Grain boundary detection in microstructure images using computational intelligence. Comput. Ind. 56, 854-866.
Deutsch, C.V., 2002. Geostatistical Reservoir Modeling. Oxford University Press, Inc., New York, New York.
Dijkstra, E.W., 1959. A note on two problems in connexion with graphs. Numerische Mathe-matik 1, 269-271.
Dobkins, J., Folk, R., 1970. Shape development on tahiti-nui. Journal of Sedimentary Petrology 4, 1167-1203.
Ehrlich, R., Chin, M., 1980. Fourier grain-shape analysis: A new tool for sourcing and tracking abyssal silts. Marine Geology 38, 219-231.
Falcao, A., Udupa, J., Miyazawa, F., 2000. An ultra-fast user-steered image segmentation paradigm: Live-wire-on-the-fly. IEEE Transactions on Medical Imaging 19, 55-62.
Falcao, A.X., Bergo, F.P.G., 2004. Interactive volume segmentation with differential image foresting transforms. IEEE Transactions on Medical Imaging 23, 1100-1108.
Falcao, A.X., Stolfi, J., Lotufo, R.A., 2004. The image foresting transform: Theory, algorithms, and applications. IEEE Transactions on Pattern Analysis and Machine Intelligence 26, 19-29.
Falcao, A.X., Udupa, J.K., Samarasekera, S., Sharma, S., Hirsch, B.E., Lotufo, R.A., 1998. User-steered image segmentation paradigms: Live-wire and live-lane. Graphical Models and Image Processing 60, 233-260.
Girao, G., 2006. Site da hydrolog, servicos de perfilagem ltda. http://geraldogirao. com/apostilas.htm/.
Gorsevski, P.V., Onasch, C.M., Farver, J.R., Ye, X., 2012. Detecting grain boundaries in deformed rocks using a cellular automata approach. Computers &amp;amp; Geosciences 42, 136142.
Haykin, S., 2001. Redes Neurais - Principios e Pratica. Bookman Companhia Ed.
Hecht-Nielsen, R., 1990. Neurocomputing. Addison-Wesley Publishing Company, Redwood City.
Kohonen, T., Schroeder, M.R., Huang, T.S. (Eds.), 2001. Self-Organizing Maps. SpringerVerlag New York, Inc., Secaucus, NJ, USA. 3rd edition.
Krumbein, W., . Measurement and geological significance of shape and roundness of sedimentary particles. Journal of Sedimentary Petrology 11, 64-72.
Li, Y., Onasch, C.M., Guo, Y., 2008. Gis-based detection of grain boundaries. Journal of Structural Geology 30, 431-443.
Lotufo, R., Falcao, A., Zampirolli, F., 2002. IFT-Watershed from gray-scale marker, in: Proceedings of XV Brazilian Symp. on Computer Graphics and Image Processing, IEEE. pp. 146-152.
Lu, B., Cui, M., liu liu liu liu, Q., Wang, Y., 2009. Automated grain boundary detection using the level set method. Computers &amp;amp; Geosciences 35, 267-275.
Lu, B., Ning, C., 2010. Pde-based grain boundary detection, in: IITA-GRS 2010 volume 2 content, pp. 170-173.
Maschio, C., Vidal, A.C., Schiozer, D.J., 2008. A framework to integrate history matching and geostatistical modeling using genetic algorithm and direct search methods. Journal of Petroleum Science and Engineering 63, 34-42.
Miranda, P.A.V., Falcao, A.X., Udupa, J.K., 2010. Synergistic Arc-Weight Estimation for Interactive Image Segmentation using Graphs. Computer Vision and Image Understanding 114, 85-99.
Miyoshi, S.d.C., 2010. Modelo Kernel PCA-Genetico para Ajuste de Historico. Master’s thesis. Pontificia Universidade Catolica do Rio de Janeiro.
Papa, J., Falcao, A., Suzuki, C., 2009a. Supervised pattern classification based on optimumpath forest. International Journal of Imaging Systems and Technology 19, 120-131.
Papa, J., Nakamura, R., de Albuquerque, V., Falcao, A., Tavares, J., 2012. Computer techniques towards the automatic characterization of graphite particles in metallographic images of industrial materials. Expert Systems With Applications .
Papa, J.P., Falcao, A.X., Suzuki, C.T.N., 2009b. Supervised pattern classification based on optimum-path forest. International Journal of Imaging Systems Technology 19, 120-131.
Rocha, L.M., Cappabianco, F.A.M., Falcao, A.X., 2009. Data clustering as an optimumpath forest problem with applications in image analysis. International Journal of Imaging Systems and Technology 19, 50-68.
Salembier, P., Oliveras, A., Guarrido, L., 1998. Antiextensive connected operators for image and sequence processing. IEEE Transactions on Image Processing 7, 555-570.
Shi, J., Malik, J., 2000. Normalized cuts and image segmentation. IEEE Transactions on Pattern Analysis and Machine Intelligence 22, 888-905.
Sneed, E.D., Folk, R.L., 1958. Pebbles in the Lower Colorado River, Texas a Study in Particle Morphogenesis. Journal of Geology 66, 114-150.
Spina, T.V., Falcao, A.X., Miranda, P.A.V., 2011a. Intelligent understanding of user interaction in image segmentation. International Journal of Pattern Recognition and Artificial Intelligence To appear.
Spina, T.V., Falcao, A.X., Miranda, P.A.V., 2011b. User-steered image segmentation using live markers, in: International Conference on Computer Analysis of Images and Patterns (CAIP), Springer-Verlag, Seville, Spain. To appear.
Suzuki, C., Gomes, J., Falcao, A., Papa, J., Hoshino-Shimizu, S., 2012. Automatic segmentation and classification of human intestinal parasites from microscopy images .
Tiab, D., Donaldson, E., 2004. Petrophysics: Theory and Practice of Measuring Reservoir Rock and Fluid Transport Properties.
Van de Berg, E., Meesters, A., Kenter, J., Schlager, W., 2002. Automated separation of touching grains in digital images of thin sections. Computers &amp;amp; Geosciences, 179-190.
Wadell, H., 1932. Volume, Shape, and Roundness of Rock Particles. Journal of Geology 40, 443-451.
Yu, C., Ruppert, G., Nguyen, D., Falcao, A., Liu, Y., 2012. Statistical asymmetry-based brain tumor segmentation from 3d mr images. Proc. of the Intl. Conf. on Bio-inspired Systems and Signal Processing (BIOSIGNALS), 527-533.
Zingg, T., 1935. Beitrag zur Schotteranalyse. Schweizerische Mineralogische und Petro-graphische Mitteilungen 15, 38-140.
A
Imagens dos resultados da segmentacão automática e correcoes interativas
(b)
(a)
(b)
(a)
B
Imagens dos contornos e eixos dos graos
(a)
(b)
Figura B.1: Contorno dos graos e eixos das amostras: (a) S1 (b) S2.
(c)
(a)
(b)
Figura B.2: Contorno dos grãos e eixos das amostras: (a) S4 (b) S5 (c) S7.
C
Resultados para análise dos eixos dos grãos
(a)	(b)
Amostra SI
Fator de Forma F
(c)
Amostra SI
Esferiddade y'
(d)
(a -1&gt;) / (a - c)
(b)
(a)
(a -1&gt;) / (a - c)
(c)
(d)
Figura C.2: Amostra S1 - Resultados das aplicações dos métodos para analise da forma dos grãos: (a) Indice Oblato-Prolato (b) Distribuiçao do Indice Oblato-Prolato (c) Indice MPS (d) Distribuiçao do Indice MPS.
(a)	(b)
Amostra S2
Fator de Forma F
(c)
(a)	(b)
(c)
Amostra S2
0.2	0.3	0.4	05	0.6	0.7	0.S	0.9	1
MSP
(d)
Figura C.4: Amostra S2 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do Indice Oblato-Prolato (c) Indice MPS (d) Distribuyo do índice MPS.
(a)	(b)
Amostra S4
Fator de Forma F
(c)
(a)	(b)
(a -1&gt;) / (a - c)
(c)
0.2	0.3	0.4	05	0.6	0.7	0.3	0.9	1
MSP
(d)
Figura C.6: Amostra S4 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuyo do Indice Oblato-Prolato (c) Indice MPS (d) Distribuyo do índice MPS.
(a)	(b)
Amostra S5
Fator de Forma F
(c)
(a)	(b)
(c)
40.0
35.0
30.0 —25.0
£ .3
I200
9
CT £
“■15.0
10.0
5.0
0.0
Amostra S5
0.2	0.3	0.4	05	0.6	0.7	0.3	0.9	1
MSP
(d)
Figura C.8: Amostra S5 - Resultados das aplicações dos métodos para analise da forma dos grãos: (a) Indice Oblato-Prolato (b) Distribuiçao do Indice Oblato-Prolato (c) Indice MPS (d) Distribuiçao do índice MPS.
(a)
Amostra S7	# ♦ ♦ ♦ ♦
1	+ +
III	*:** ♦
	*+ + **♦*
(c)
(d)
(a)
(b)
(c)
(d)
Figura C.10: Amostra S7 - Resultados das aplicacoes dos metodos para analise da forma dos graos: (a) Indice Oblato-Prolato (b) Distribuicao do Indice Oblato-Prolato (c) Indice MPS (d) Distribuicao do índice MPS.</field>
	</doc>
</add>