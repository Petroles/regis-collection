<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20537</field>
		<field name="filename">4114_Mendes_LuizCarlosCronemberger_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA DE CAMPINAS
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada à
Faculdade de Engenharia de Campinas
Como Requisito Parcial à ObtençSo do
Titulo de Mestre em Engenharia de Petróleo
ANALISE DE TESTES DE POÇOS UTILIZANDO DECONVOLUÇÃO
DE PRESSÃO E VAZÃO
"5
U Da
Autor : Luiz Carlos Cronemberger Mendes
Orientador : Martin Tygel
Co-Orientador Antônio Cláudio de França Corrêa
Março, 19Ô9
U N 1 C A M p
ce*™al
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA DE CAMPINAS
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação
" Análise de Testes de
Poços
Luiz Carlos Cronemberger
os
membros da Banca Examinadora foi aceita pela Sub—Comissão de
Pós—Graduaçao em Engenharia de Petróleo como requisito parcial à obtenção do Título de Mestre em Engenharia de
Petróleo
Campinas, 22 de março de 1986
Banca Exami nadora
Dra. Maria Cristina Cunha Bezerra
Aos meus pai s, Sí1 vi o e Isaura
AGRADECIMENTOS
Ao Dr. Antônio Cláudio de França Corrêa, e orientação permanentes.
Aos Drs. Martin Tygel e Maria Cristina pelo apoio e orientação.
A todos aqueles que, direta ou contribuíram para a realização deste trabalho.
pelo incentivo
Cunha Bezerra,
i ndi retamente,
RESUMO
A análise de testes de poços pode ser feita com maior segurança quando dados simultâneos de pressSo e vazSo na face da formaçSo sSo disponiveis. O processo de deconvoluçSo pode ser usado para encontrar a resposta de pressSo resultante caso a produçSo tivesse sido efetuada com vazSo constante. Esta resposta, com efeitos de estocagem minimizados, pode então ser interpretada usando os métodos convencionais de análise.
Neste trabalho sugerem-se dois algoritmos de deconvoluçSo, baseados em aproximaçSes dos dados de pressSo e vazSo por combinaçSes de funçóes splines lineares Cmétodo 33 e cúbicas Cmétodo 43.Usando transformadas de Laplace para estas aproximaçóes, obtém-se a resposta à vazSo constante. A inversSo para o campo real é feita utilizando algoritmos de inversSo numérica: sSo usados os métodos de Crump e Stehfest.
Estes algoritmos de deconvoluçSo nSo fazem qualquer suposiçSo acerca da natureza do reservatório. Portanto, podem ser aplicados para reservatórios homogéneos e heterogéneos, como também para diferentes geometrias de fluxo.
Compara-se estes algoritmos com outros dois métodos sugeridos na literatura, baseados em linearizações da integral de convoluçSo Cpresente no principio de Duhamel , ou teorema da superposiçSo3 .
SSo consideradas as seguintes aplicaçóes:
— Análise de testes de formaçSo ou "Drilistem tests" CDST3» quando os fluidos produzidos nSo atingem a superfície; é feita a análise simultânea dos períodos de fluxo e estática.
— Análise de testes em poços bombeados em que os dados de pressSo e vazSo de fundo sSo calculados utilizando sonolog.
- Análise de testes de buildup de pressSo, para poços produzindo com vazSo constante antes do fechamento. Apresenta-se exemplo em que houve mediçSo do “afterflow" ; o
deconvoluç£o
SSo
uso
estocagem. apresentados exemplos de campo das
apii caçSes
apr esentados
a problemas com pequenas flutuaçSes e geralmente causam
podem ser r uí dos nos
apii cados
em métodos anteriormente apresentados. Para isso, faz-se urna suavizaçSo das curvas de pressSo e vazSo vs tempo» utilizando combinaçSes de funçSes B-splines e o critério dos
quadrados mínimos.
ABSTRACT
Well test analysis can be done with more reliability when both bottomhole pressures and sandface flow rates are available. The deconvolution process can be used to obtain the pressure data that would result from production at a constant sandface rate.
In this work deconvolution
algorithms are presented,
based on
the approximation of
bottomhole pressure and
sandf ace
rate measurements
by
combi nati ons
of
linear
spli nes
functions C
method 3 D
and cubic splines functions
C method
4 2). Using
Laplace
transforms
for
these
approximations we can
obtain the
constant rate response. The
inversion is carried
out by numerical inversion algorithms:
the methods
of Crump and Stehfest are used.
These
any
assumption
with respect to the nature of reservoir system.
Therefore,
it can be applied to
ei ther
homogeneous or
heterogeneous reservoirs, as well
as to
different flow
geometries.
We compared these algorithms with two
other methods»
based on linearizations of the convolution integral.
The following applications are considered:
—ill
test analysi s
when
the produced fluids do not
fill the drillstring: in this
case
the sandface flow
rate can
be calculated from pressure
data
wi th a constant
wellbore
storage factor. Simultaneous
analysis of flow and
buildup
periods is considered.
—Analysis of acoustically derived pressure and rate data,
—Analysis of pressure buildup tests for wells producing
steadily before the shutin.
The deconvolution eliminates the
af terf1ow
effects.
Th
a. • *
in this work may be applied to
probl ems
with fluctuations
or noises in pressure
and rate
measurements. Pressure and
rate vs time curves are
smoothed
INDICE
PAGI NA
Lista de	tabelas....................................... i
Lista de	figuras...................................... ii
INTRODUÇAO............................................. 1
1.	-CAP. 1: INTRODUÇÃO A ANALISE DE TESTES
1.1-	EquaçSo da Difusividade e Métodos Convencionais
de Análise de Testes.............................. 4
1.2-	Testes de VazSo Variável e RevisSo Bibliográfica
de Métodos de DeconvoluçSo......................... Ô
2.	-CAP. 2: DESCRIÇÃO DOS MÉTODOS DE DECONVOLUÇAO
IMPLEMENTADOS
2.1-	Método 1 ........................................ 17
2.	2-Método 2......................................... 22
2.	3-Método 3......................................... 25
2.	4-Método 4......................................... 31
3.	-CAP. 3: APLICAÇÕES
3.1-	Exemplos Teóricos e Testes Simulados............. 36
3.	2-Aplicaç3es Práticas.............................. 64
CONCLUSÕES - SUGESTÕES - RECOMENDAÇÕES................ 80
NOMENCLATURA.......................................... 01
REFERENCIAS BIBLIOGRÁFICAS............................ 04
APENDICE A - ConvoluçSo e Fórmulas de Duhamel......... 07
APÊNDICE B - Método 1 em Termos	Dimensionais......... 101
APENDICE C - FunçOes B-splines e SuavizaçSo de Dados 102 APENDICE D - Listagens de Programas.................. 105
LISTA DE TABELAS
TABELA	DESCRIÇAO	PÀGINA
1.1	- Sistemas de unidades................................. 5
1.2	- Definiç3es de variáveis adimensionais................ 6
2.1	- Definição	e regras operacionais para
Transformadas de Laplace............................ 26
3.1	- Exemplo 1: Dados de excitação e resposta, e de
resultados da deconvolução.......................... 37
3.2	- Exemplo 2: Dados de excitação e resposta, e de
resultados da deconvolução.......................... 39
3.	3 — Exemplo 3: Dados de entrada e resultados da deconvolução.............................................. 42
3.4	- Exemplo 4: Parâmetros assumidos,dados de pressão
gerados e resultados da deconvolução................ 47
3.5	- Exemplo 5: Parâmetros assumidos para a geração
do comportamento de pressão da figura 3.7........... 56
3.6	- Exemplo 6: Dados do teste de buildup e resultados
da deconvolução..................................... 67
3.	7 - Exemplo 7: Dados do teste e resultados da
deconvolução........................................ 74
3.8 -	Exemplo 8: Dados	do teste.......................... 82
LISTA DE FIGURAS
FIG.	DESCRIÇÃO	PAGINA
1.1	— Efeito da estocagem Cafterf 1 ow2&gt; sobre a vazão na
face da formação..................................... 2
1.2	- Gráfico semilog de dados de pressão de fluxo
para um poço com estocagem e skin.................... 2
1.1	- Pressão adimensional incluindo estocagem CS=O2)..	IO
1.2	- Dados gerados de pressão adimensional, com e sem
estocagem, para reserv. de dupla porosidade......	16
2.1a- Função degrau unitário ou de Heaviside.............. 28
2.1b- Função "J anel a"................................... 28
3.1	- Exemplo 2: FunçSes excitaçãoCq^D ,respostaCdpwl e
"transferência" CdpsZ).............................. 40
3.2	- Exemplo 3: Comportamento da vazão adimensional
na face da formação................................. 44
3.3	- Exemplo 3:Gráfico semilog da resposta de pressão
antes e após a deconvolução......................... 45
3.4	- Exemplo 4: Comportamento da pressão de fluxo
C‘‘slug test"2)	.............. 48
3. 5 - Exemplo 4: Resultados da deconvolução.............. 50
3.6	- Exemplo 4: Gráficos semilog dos resultados da
deconvol ução....................................... 51
3.7	- Exemplo 5: DST gerado para um reservatório
verticalmente fraturado............................. 55
8	-	Exemplo 5:Comportamento	de pressSes extrapoladas	57
8 - Exemplo 5: Gráfico dos dados resultantes da
deconvolução C fluxo •+■ estática 2)................ 60
3.10-	Exemplo 5: Gráfico log x log dos resultados da
deconvolução C fluxo + estática 5................... 61
3.11-	Exemplo 5: Gráfico ApsCt2) vs Yt : fluxo linear	63
3.12-	Suavização de dados utilizando combinações de
funçSes B-splines e o critério dos quadrados
mi ni mos........................................... ^5
(í&gt;	(*&gt;
FIG.
DESCRIÇÃO
iii
PAGINA
3.13-	Exemplo 6: DefiniçSes de variáveis.................. 68
3.14-	Exemplo 6: Respostas antes e após a deconvolução
C método 3	................................... 70
3.13- Exemplo 6: Respostas antes a após a deconvolução
C método 4 2)....................................... 71
3.16-	Exemplo 6: Resultados apresentados pelos métodos	72
3.17-	Exemplo 7: Gráfico log x log mostrando o efeito
da estocagem Creta de inclinação unitária 3......... 75
3.18-	Exemplo 7: Resultados da deconvolução............... 76
3.19-	Exemplo 7: Gráfico log x log	mostrando a
minimização dos efeitos ■ da	estocagem pela
deconvol ução....................................... 77
3.20-	Exemplo 7: Gráfico semi logarítmico, indicando a
ocorrência de fluxo radial para t &gt; 35 h ........... 78
3.21-	Exemplo 7: Gráfico para análise do período de
fluxo linear........................................ 80
3.22-	Exemplo 8:	7—CP—137—SE / TFR—1 — Dados de
pressão de fluxo.................................... 83
3.23-	Exemplo 8:	7-CP-137-SE / TFR-1 - Gráfico de
Horner.............................................. 85
3.24-	Exemplo 8: Resultados da deconvolução............... 86
3.25-	Exemplo 8: Gráficos semilog dos resultados da
deconvol ução....................................... 87
C. 1	-	Função B-spline.................................. 104
INTRODUÇÃO
Algumas importantes informaçSes para a análise e previsão da performance de reservatórios podem ser obtidas através de testes transientes de pressão.
Os métodos mais comumente empregados na dos dados de pressão registrados durante de soluçSes analíticas da
interpretação estes testes
uti1i zam-se
di f usi vi dade,
constante na
equação da as quais são obtidas considerando-se face da formação como condição de
produção contorno
interna.
O procedimento mais adotado para aquisição nestes testes é o de registro de pressSes no fundo
de dados
do poço e
de vazão na superfície, procurando-se manter esta o mais próximo possível de um valor constante. Ocorre que, mesmo se a vazão na superfície for mantida em um valor absolutamente constante, o comportamento de vazão na face da formação é variável nos tempos iniciais do fluxo e da estática, devido aos efeitos de estocagem CFig. 1.1	2). Isto provoca um
afastamento entre o comportamento de pressão observado e o comportamento esperado para o caso de vazão de produção constante CFig. 1.2 2). Os efeitos de estocagem podem se prolongar por alguns minutos ou até por muitas horas, dependendo das características do poço, do reservatório e dos fluidos produzidos. A estocagem pode ocultar efeitos de heterogeneidades, ou até mesmo impossibilitar a interpretação dos dados do teste para o cálculo dos parâmetros do r eser vatór i o.
Um procedimento que traz grandes vantagens é a determinação simultânea de pressão e vazão na face da formação. A vazão pode ser medida diretamente, utilizando-se ferramentas recentemente desenvolvidas, ou inferida através
da utilização de várias técnicas C por exemplo, determinação acústica do nível de fluido 2&gt;; pode também ser calculada a
A(t)
vazão:
1
tuperficie, corrigida cond. da fundo formação
Figura 1.1- Efeito da estocagem Cafterflow^ sobre a vazSo na face da formação
l \
t
Figura 1.2- Gráfico semilog de dados de pressão de fluxo para um poço com estocagem e skin
Todos os métodos propostos para a estimativa dos parâmetros do reservatório em testes com vazão variável utilizam o Principio de Duhamel Csuperposição} . Nele, a solução da equação da difusividade para vazão variável é dada pela convolução da solução à vazão constante, ou função resposta ao degrau unitário, com a condição de contorno interna Cvazão na face da formação}. O problema inverso, determinação da função resposta à vazão constante a partir do comportamento de pressão à vazão variável, é chamado de "deconvolução".
O uso da deconvolução na análise de testes de poços tem como vantagem principal a minimização, ou até mesmo a eli mi nação dos efei tos de estocagem. Isto pode poupar tempo de teste, diminuindo seu custo, além de possibilitar uma caracterização mais segura dos parâmetros do reservatório.
No Cap. 1 faz-se uma breve exposição dos métodos mais utilizados para a análise de testes de transiente de pressão. Apresenta-se também um resumo de técnicas de deconvolução apresentadas por diversos autores.
No Cap. 2 detalham-se os aspectos teóricos dos métodos de deconvolução implementados neste trabalho.
O Cap. 3 traz diversas aplicaçSes para testes simulados e reais, comparando os métodos apresentados.
CAP. 1
INTRODUÇÃO A ANALISE DE TESTES
Neste capítulo faz-se um resumo da teoria de fluxo transiente pr.ra testes de poços e das técnicas de análise mais utilizadas:
1.13	EQUAÇÃO DA DIFUSIVIDADE E MÉTODOS CONVENCIONAIS DE
INTERPRETAÇÃO DE TESTES
A equação diferencial que descreve o escoamento de
fluidos em meios porosos resulta da combinação de:
conservação da massa Ceq. da continuidade!» equação de
lei de
estado
Ceq. da compress!bilidade! e lei de Darcy.
Com as equaçSes acima e considerando-se um
meio
poroso
isotrópico e homogéneo» escoamento horizontal
monofásico»
pequenos gradientes de pressão, fluido com
viscosidade
constante e pequena compressibilidade» efeitos gravitacionais
desprezíveis e porosidade, compressibilidade» permeabilidade
e viscosidade invariantes com
a pressão, tem-se finalmente a
equação da difusividade.
Para
modelo de fluxo radial» esta é
dada por:
onde
d2p
dr2
1
r
dp
dr
4&gt; P çt a k
dp
. .Cl.l!
empregadas C ver
p = pC r »t!
Tabelas
o depende das
uni dades
1.1
1.2 !.
Uti1i zando
variáveis
adimens!onais C definidas na
Tabela 1.2!» a
eq. Cl.l! se reduz a:
*2pn		1		dp  D
drZ		r	&amp;amp;r	Ôt
D		D	D	D
...Cl.2!
+
e
e

VARIÁVEL	SI S T E M A			
	S I	DARCY	AMERICANO	PETROBRAS
PressSo C p 2)	Pa	atm	psi	2 kg/cm
Vazão de liquido C q 2)	m9/s	a . cm /s	stb/d	m9Zd
Compr i mento C h, r , x 2)	m	cm	ft	m
Permeabilidade C k 2)	2 m	D	mD	mD
Compressibilidade C c 2&gt;	Pa-1	atm 1	. -1 psi	2 cm /kg
Tempo C t,At 3	s	s	h	h
Coef. de estocagem C C 2)	m3/Pa	cm3/atm	bbl/psi	3	2 m /kg/cm
Viscosidade C /j 2)	Pa. s	cp	cp	cp
Tabela 1.1
Sistemas de unidades
tempo C	3		oi k t	t
		0 P&amp;lt;=t	2
			r w
raio Cr D		r	
			
		A w	
queda de pressSo C	% &gt;	k h	[_	&gt;t-p]
		q B p	lF	
vazão na face da			
formação C q^	D	%	
coeficiente de estocagem		Y C	
do poço	C Cd 3		2 n&amp;lt;t&gt; c^ h	2 i r w
SISTEMA	ct	0	Y
DARCY	1.	2 n	1.
AMERICANO	0.0002637	1/141.2	5.615
PETROBRAS	0.0003484	1/19.03	1.
Tabela 1.2 - DefiniçSes de variáveis adimensionais
onde q é a vazSo constante na superfície. O fator volume de formaçSo B faz a correçSo para condiç3es de fundo do poço.
A resposta de pressSo a vazSo constante pode entSo ser expressa da seguinte forma C de C1.4) e C1.5), e usando a definiçSo de tempo adimensional3:
nC t3 + lní-------—1 + 0,809 + 2s|,...C1.63
&amp;lt;tbuc. r '	J
t V
ou:
ogCt3 + logí--------—] +O, 3513+0» 869
0uc r2
t V
ou ai nda :
PwCt3 = pih + m logCt3
COT?.
0,1832 qBu
m = — -----5—r—- ■ —
k h
Portanto, traçando-se um gráfico de pressSo de fluxo no fundo do poço versus logCt3 , pode-se obter uma linha reta com inclinaçSo m . A partir desta declividade pode-se calcular a permeabilidade da formaçSo. Efetivamente, esta reta ocorre, mas somente quando cessam os efeitos de estocagem e de dano C e se os limites do reservatório ainda nSo estiverem influenciando o comportamento de pressSo no poço 3, como pode ser vi sto na Fi g. 1.2 .
Ct3
0,1832
. ..Cl.73
...Cl.83
...C1.93
Este desvio da linha reta semilog nos tempos iniciais ocorre porque a condição de contorno interna Cvazão constante na face da formação} não é obedecida. Na análise destes dados Hf» prp^sSo, para os quais a linha reta ainda não ocorreu, utilixa-se a técnica de ajuste com curvas-tipo. £ um método menos preciso que a análise semilog, mas bastante útil neste caso (como também no caso de reservatório fraturado, por exemplo}. As curvas-tipo mais utilizadas Ccomo as de Ramey, Gringarten.etc} assumem coeficiente de estocagem constante.
A Fig. 1.1 revela uma característica do período influenciado pelo efeito de estocagem: inclinação unitária num gráfico logCp^} vs logCt^} Tal efeito cessa quando a curva 0^=0 é atingida ; como regra prática, assumimos o final da estocagem a partir de l1/^ ciclos logarítmicos após o início do desvio da reta de inclinação unitária.
No caso de testes em poços não surgentes de alta produtividade C "slug-test" }, também ocorre vazão variável na face da formação. As curvas-tipo de Ramey e Agarwal são utilizadas para analisá-los, entretanto, frequentemente encontram-se problemas de unicidade, com mais de uma curva ajustando-se bem aos dados dos testes.
Pelo exposto acima, verifica—se a importância do estudo de testes de vazão variável, o que será abordado a seguir.
1.25 ANALISE DE TESTES DE VAZÃO VARIÁVEL E REVISÃO BIBLIOGRAFICA DE METODOS DE DECONVOLUÇAO:
Em 1949 Van Everdingen e Hurst1 introduziram o uso das transformadas de Laplace no estudo do escoamento de fluidos em meios porosos, mostrando que a interpretação de dados de pressão com vazão variável pode ser feita a partir da resposta de pressão á vazão constante,utilizando-se o teorema da superposição ou Princípio de Duhamel C ver Apéndice A }.
A linearidade da equação da difusividade permite a
tD
Figura 1.1- Pressão adimensional incluindo estocagem C S=O 3. Por Wattenbarger e Ramey.
comportamento variável de
vazSo na face da formaçSo.
De
C1.53 , a queda de
pressSo
no
tempo t, devido à
vazSo
i nicial
q Ct =03 , é:
1
Ap Ct3 w
i

2 n k h
p Ct 5
SD D
onde p
* 1
) Ct ) é SD D vazSo constante.
a soluçSo da equaçSo da difusividade incluindo o
sem efeitos de estocagem e
de skin
O ef ei to
de um incremento de vazSo
em um instante
t
2
na queda de pressSo no
para
f ator
[q Ct 3-q Ct 5]
V 2 V 4
tempo t, é:
Ap w
. 2
o- K í q ct 3
2nk h	v 2
&gt; CCt-t 3 ]
SD	1 D
Considerando-se a superposiçSo dos efeitos dessas
vari a.çdes de vazSo, tem-se:
Ap CO w
o	/q CO3.p Ct 3
2nkh	SD d
íq Ct 3 —q Ct 3].p ÍCt-t 3 ]
2 V 1 J SD
1 D
+ íq Ct 3-q Ct 3]. p [Ct-t_3_] +
3 V 2 J SD
2 D
}
Tomando-se
o limite para
incrementos de
vazSo
i nf i ni tesi mai s,
resulta:
t
Ap Ct3 w
2nk h
íq C03.p Ct 3 +
[v	^SD D
I q'Cz3.p Ct -T 3.d-rl
J V	SD DD J
O
Ou ainda, como pode ser visto no Apêndice A :
t
ApCt) = -õA- íq CO3.p Ct 3 + 1 q*Ct—T3.p Ct 3. dr 1 w	SrtKn	SD D	I w	SD D	J
O
. . .Cl.113
Dividindo ambos os lados da equação acima por uma vazão constante de referência, q^ C se o poço estiver produzindo com vazão constante na superfície, considera-se q igual a r esta vazão, corrigida para condiçSes de fundo 3:
. . .Cl. 123
o que é equivalente a:
p Ct 3 = q Ct 3.p	C03 + í q CT3.p'Ct -t3.dT
WD D	WD D SD	J WD	SD D
O
...Cl.133
Então, a convolução da solução para vazão constante com a condição de contorno interna variável» resulta na solução da equação da difusividade para vazão variável. Um aspecto que deve ser ressaltado ê a necessidade de se assumir um modelo de reservatório, para realizar a convolução. Por exemplo, para fluxo radial em regime transiente,
p Ct 3 = _4— í InCt 3 + O,8OQ 1 + S
'SD D	2	1	D	I
O método de Horner, para análise de buildup durante o período transiente, usa o princípio da superposição. Para um poço produzindo com vazSo q constante durante um tempo t e com vazSo nula após o fechamento, tem-se:
Para fluxo radial, resulta:
+ +At
»
onde
Portanto, um gráfico
0,1832 qB/j
kh
vs
poderia
m
produzir uma linha reta, sendo que a permeabilidade da formação poderia ser calculada a partir da declividade,m. Ocorre que a vazSo na face da formação não cessa i medi atamente após o f echamento, como foi vi sto na seção 1.1, resultando os efeitos indesejáveis Já abordados.
A importância da determinação correta da vazão na face da formação foi ressaltada há bastante tempo. Em 1SS3, Van Everdingen e Hurst2 estimaram essa vazão da seguinte forma:
»
onde @ é uma constante positiva, determinada a partir de parâmetros do poço e do reservatório. Esta aproximação é bastante razoável quando se trata de "afterflow". Utilizando-se a expressão acima e o Princípio de Duhamel, van Everdingen e Hurst puderam calcular a pressão no poço.
Em 1955, Gladfelter apresentou um método para a determinação da permeabilidade da formação a partir de
dados de pressão e de afterflow. A deconvolução era realizada dividindo o crescimento de pressão pela mudança instantânea de vazão C os dados de afterflow foram obtidos medindo o crescimento do nivel de liquido no poço	Este método
funciona bem se a vazSo variar linearmente com o tempo C ver ref. 15
Em 1965 foi publicado um trabalho de Odeh e Jones* sobre análise de drawdown com vazão variável, fazendo uma integração numérica da integral de convolução. Uma limitação deste trabalho é que foi assumida a soluçSo logarítmica para a queda de pressão adimensional presente na integral.
Nos últimos anos, com o aparecimento de ferramentas que medem simultaneamente vazSo e pressão na face da formação, tem havido um interesse crescente pela análise de testes de vazão variável utilizando o Principio de Duhamel:
Em 1993 Stewart,Wittman e Meunier4* usaram medições de vazão e pressão na face da formação para análise de crescimento de pressão, mostrando que o método de Horner pode ser modificado de tal forma que a linha reta semilog seja atingida mais cedo, conseguindo-se diminuir os efeitos de estocagem. Os dados de vazão foram interpolados linearmente, por partes. A integral de convoluçSo é calculada diretamente, assumindo comportamento de reservatório homogéneo e infinito, com fluxo radial, o que é a maior limitação do método.
Ainda em 1993, Kuchuk e Ayestaran10 sugeriram o uso de uma combinação de funções exponenciais para aproximar o comportamento de vazão, utilizando-se das transformadas de Laplace e do teorema da convolução e encontrando um método aplicável a reservatórios heterogéneos. Sugeriram também aproximar p Ct 3 por uma série de potências de InCt d da
SD D	D
forma	p Ct ) = &gt; a..C InCt 3 )2	, tal que
SD D	£, L	D
L =l,m substituindo-se p^ na integral de convolução e resolvendo o sistema de equações resultante, encontram-se os a. ’ s e.
consequentemente, a expressão da resposta a vazSo constante. Mostraram ainda o uso do método de Hamming e da regra das trapézios, para a linearização da integral de convoluçSo.
Thompson e Reynolds Cl9845 aproximaram os dados de pressSo e de vazão linearmente em cada subintervalo de integração. O cálculo da integral de convolução é realizado através de sua linearização C ver método 1, no Cap. 2	5,
obtendo uma relação de recorrência para o cálculo de PSD-
No Cap. 2 apresenta-se quatro métodos de deconvolução: os métodos 1 e 2 utilizam linearizaçBes da integral de convolução, trabalhando no campo real; os outros dois métodos aproximam os dados de pressão e vazão através de combinaçSes de funçSes splines lineares C método 3 5 ou cúbicas C método 4 3, utilizando transformadas de Laplace para obter a resposta à vazão constante.
A Fig. 1.2 serve para se observar a importância da deconvolução:	ela mostra dados de pressão adimensional
gerados para reservatório de dupla porosidade, com e sem efeitos de estocagem. Note-se que a existência da primeira reta não seria percebida, e a caracterização da dupla porosidade seria prejudicada, devido à estocagem.
RESERVATÓRIO DE DUPLA POROSIDADE (antes e apos deconvolucao)
20.00
Pressão odimensional.Pd
»•
••
15.00 -
10.00 -
5.00 -
9
9
9
*
a
antes
*
•*

0.00
~T~i iliini}*i niiu[~'i iiiiiq i imm i rimi i nmiq i imay~11iiiuq rinui| iiuiii)
1 0 2 10 3 1 0 4 10 5 10“ 1 0 7 10 ê 10’ 10 10 10 ’’10 52
Tempo adimensional,Td
Figura 1.2 — Dados gerados de pressSó adimensional &gt; com e sem estocagem
CAP. 2
Caso p varie pouco no intervalo
p’ Cot.3	O
SD J
C t »t 3 , tal que D D
J J+l
ou caso o intervalo seja suficientemente
pequeno, a equação C2. 43 pode ser aproximada por:
. . . C2. 63
Usando—se as equaçSes C2.33 e C2. 63
resul ta:
p Ct 3=q CO3.p Ct 3 +
WD D,r&gt;	WD	SD D
como
CO3
»
equação
ser
r ear r anj ada
O primeiro valor de p r	SD
é dado por :
Kuchuk e Ayestaran10 utilizaram as equações acima
*
com 0 = 1/2 , ou seja , t = 1/2 . Ct + t 5.
r»,j	d,j D,j+i
Na verdade, a escolha de 0 é o ponto crítico deste método, Já que o valor ótimo de 0 C para o qual a linearização efetuada na integral de convolução produz um erro mínimo D varia caso a caso, como se verá nos exemplos teóricos. O programa computacional implementado neste trabalho tem como um dos dados de entrada o valor de 0.
A suposição de que q^^CCD =0 é válida para o caso de produção por abertura de válvula na superfície, mas não vale
para teste de crescimento de coluna C "sl ug-test "3 . Neste caso, Thompson, Jones e Reynolds aconselham o uso de 0=1 ,
*
ou sej a, t .=t
r», J D,J+1
Da equação C2.	, tem—se que:
p Ct J = p Ct D. fq CCD+q Ct -t &gt;-q Ct -t	+
WD D,r&gt;	SD D	^WD D D,n-1 WD D D,n J
que pede ser resumido por:
p Ct 3 - SOMA
V/D p , n_________
q C t -t	3
WD p P , n-1
. . . C2. 103
onde:
com:
Pw Ct 3
P D , 2
3
2
»
Este procedimento também foi implementado e,tanto neste como no caso anterior, utilizou—se interpolação dos dados de vazão por splines cúbicas Cver método 33. As referências citadas acima usaram interpolação linear.
As equaçSes C2. 13 a C2.73 são gerais e se aplicam também para o período de buildup. Devido ao efeito de estocagem, a vazão não cessa no instante do fechamento, como foi visto no Cap. 1 Utilizando as equações acima pode—se converter os dados de "drawdown” e de "buildup" para a queda de pressão que resultaria se a vazão fosse constante. Thompson e Reynolds apresentam um procedimento a ser utilizado quando somente dados de buildup são considerados.
Com o procedimento indicado, nenhuma restrição sobre a partição da eq.C2.23 é necessária para se ter a estabilidade do método. Na eq. C2.103,para teste de crescimento de coluna, suponhamos que tenha havido um erro £ no cálculo de P Ct ,3, O &amp;lt;k &amp;lt;n-2	. Isso provocará, um erro no valor
SD D,k	r
*
calculado de P Ct 3, e seja P Ct 3 este valor :
SD D	SD D
C
Ct .3 + £
onde:
. . . C2.113
jXk-i
c.
J+i
Subtraindo-se C2.113 de C2.1O3 e tomando-se o valor absoluto, -tem-se:
I e I = I p Ct 3 - p* Ct 3 I = I c I .	1^1
I	I	I rSD D	SD d •	• k i	i
A condição para a estabilidade é que | e | seja menor ou igual a | £	| ,ou seja,que não tenha havido amplificação do
erro. Então, o método é estável se | cfc | &amp;lt;1, V k, l&lt;k&lt;n-2, o que equivale a :
ct -t
D D
3
n— 1

&amp;lt;1
Em um teste de crescimento de coluna a
vazão tem um
comportamento decrescente com o tempo, pois a contrapressão
sobre a face da	formação	aumenta à medida que o fluido	se
move para cima.	Dai :		
q. Ct -t	3 wD D	D,r&gt;—1	&gt;	q Ct WD	D	-t t3	&gt;	q Ct -t ,	3	&gt;	O D,k	WD	D	D,k—1	,
e			
q Ct -t	3 &gt; WD	D	D,n-1	q ct -t , WD	D	D,k	3 - q Ct -t	3 &gt; 0 , l&lt;k&lt;n-2 WD	D	D,k—1	
Portanto,	1 1 &amp;lt;1	, o que garante a estabilidade	do
método.
di mensi onai s.
2.13 METODO 2
Este método lineariza a integral de convoluçSo usando a regra dos trapézios .
O intervalo
[O»t ] será dividido em subintervalos:
N+l
O &amp;lt;t&amp;lt;	t	&lt;	&lt;	t	&lt;	t
1	2			N		N+l
Da equação Cl.133» resulta:
2nkh .
------. Ap Ct 3 p-----w n+l
q CO3.p Ct 3
sd n+i
t n + 1
I q'Ct	—t3 . p Cr3.dT,
l	n+l	SD
V =0
i
OU :
Ap Ct 3 = q CO3.Ap Ct 3
W n+l	w	s n+l
t.
v+i
t
q'Ct -t3 . Ap CT3.dr, w n+i	s
onde:
	P P	Ct 3
Ap Ct3 = -	SD	D
2n k h
+
Utilizando-se a regra dos trapézios» a equação anterior
se transforma em
Ap C t 3 = q C 03 . Ap C t 3 + w n+l	w	s n+l
+ Ap Ct 3.q'Ct -t.31.
S V W n+l v J
Ct.	—1.3
i + l t
t 3. q'Ct -t.	3
t+i w n+l v+1
com n = O , 1	,2
Tem—se ent.So N+l
equaçSes,
com
incógnitas
ApsCtt3, Ap Ct 3.
Ap Ct s
3 .
N+l
N .
Em termos matriciais,
[ A ] .	[ Aps ] = [ Apu ]
onde:
[a] =
a 11	0	
a	a	o
2 1	22	
a	a	a
3 1	3 2	
a	a	a			a
N+ 1,1	N + 1,2	N+ 1,3	N+1,N+1
Os elementos da matriz sSo dados por :
a = q Ct ) = q CO?
11	w i
a. = q Ct ? + q'Ct). Í------vo t~1l
Ut	w i	w 1	2	J
r t ~t ,
a = q'Ct.-t 3. I------^5—— J
t,i w i i	2 J
a. . = q'Ct.-t.?
v-J	v-' i j
i = 2, . . . ,N+l
i = 2,. . . , N+l
J =2......N
Ap Ct 3 s i
Ap Ct ? S 2
Ap Ct ? S 3
Ap Ct 3
S N + 1
Ap Ct ? w i
Ap Ct ?
W 2
Ap Ct ?
W 8
ft . -t .
J
2
o
o
o
o

Na equação C2. 123	, vê-se a necessidade de interpolar os
valores das derivadas da vazão nos nós. Para isso, utiliza-se 22 subrotinas SPLINE e SPLINT** , em anexo Cinterpolação por splines cúbicas}.
O sistema de equaçóes lineares resultante é tal que a matriz dos coeficientes é triangular inferior, sendo facilmente resolvido por substituição direta.
Este método tem problemas quanto a estabilidade, pois existe acumulação de erros, em muitos casos.	Valores
ocasi onam uma má
imprecisos de q Ct =03 e Ap Ct =03
w i	w 1
estimativa de Ap^Ct*} , provocando um cálculo incorreto de
Ap C t 3 , etc. . .
S 2
O cálculo das derivadas da vazão nos nós também pode
levar a erros, principalmente se o
comportamento de
vazão não
for muito suave.
Quando
se aplica a regra
dos trapézios
subi nter valo
com
Ct.,t. 1 i i+i
t. -t.
VM V
,tem—se um
Ou seja
h.
estimada diferem de um
fator por h C o que mostra integração pequenos 3 pela
em cada h8. f”
, a resposta correta e
erro da ordem de
vai or
que
é dado pelo produto de
a necessi dade de
derivada segunda
um
intervalos
da função
de
em
algum ponto do intervalo
de integração.
Este ponto,
. »
»
a
entretanto, é desconhecido, daí não ser possível
se f azer uma
deconvolução.
2.35 MÉTODO 3
Aplicando-se a transformada de LaplaceC ver Tabela 2.1 5 na eq. Cl. 125, e uti1 izando-se o teorema da convoluçSo C Apêndice A 5, tem-se:
L-ip Ct = q C03. L-ip Ct	+
|^WD D I	WD	l SD D Í
t
D
+ L-f I q' Ct -t5 . p CiO.dT 1 ] I WD D	SD	Í
O
o que produz:
p Cs5 = q CO5.p Cs5 + fs.q Cs5 - q CO?l.p Cs5 . WD	WD	SD	WD	^WD J SD
Dai, tem-se que:
	p CsD WD	
SD		
	s.q Cs? WD	
. . . C2. 133
Denomi nando-se:
Ap Cs5
Ap^Cs? = -----*----
-	s. q^CsD
resulta:
p Cs5 =
SD
2rzkh
Ap CsD s
. . C2. 14?
FUNÇÃO ORIGINAL	TRANSFORMADA
	00
reto	L^fCtD = fCCsD = J êst.fCtXdt O
a. f CtO + b. f CtO	a. f Cs) + b. f CsD
1 2	1 2 -as
uCt-aD	e s
fCtD. uCt-aD	e~as. L-^fCt+a?
f'Ct2	s.fCs? - fCO D
Tabela 2.1 - Definição e regras operacionais para
Tr ansf or madas de Laplace
Os dados de pressão e vazão ser2o aproximados linearmente em cada subintervalo de mediç2o. As expressões «x os comportamentos de pressão e vazão em todo o intervalo de mediç2o são obtidas utilizando a funç2o degrau unitário C Fig. 4 3. Encontra—se então as expressões para Ap^ e *3W no campo de Laplace. Utilizando o método de Crump ou o de Stehfest para a inversão numérica de ApsCs3 , obtém-se	a
resposta ao degrau unitário no campo real.
O procedimento indicado será detalhado a seguir:
	0 »	t	&amp;lt;t
			k
uCt-t. 3 = '			
	1 ,	t	&gt; t
			t
Para o intervalo [ t
t ] : n
ÍW =
n
f.Ct3 . t
£ uCt-tt i3
- uCt-t.3 j
. . . CS. 163
Como foi dito anteriormente» é necessário expressar f no
campo de Laplace :
Ult-t,)
1
Figura 2.1a- FunçSo degrau unitário ou de Heaviside

0
t.
I-I
t.
t
Figura 2.lb- FunçSo "Janela"
ou:
fC s3
= fCs3
-1 L{ f;co
v = 2
£ uCt-t._2 - uCt-t.3 j }

. C2. 173
Dado que:
. . . C2. 183
tem—se:
13
t - t. 3
i-i
)
uC t - t. 3
v-l
}
= expC-t .s3. £
f
v- 1
S
. . . C2.193
= expC-V

r f.	+ A. . h
= expC -t . s3. I ---~~s------“
. . . C2. 203
Usando C2.193
e C2.203
em C2.173
resulta:
rcs3
s
Utilizando-se a equaçSo	acima para	os dados		de pressSo e	
vazSo, as expressões de Ap^	e q no w	campo	de	Laplace	sSo
obtidas.					
A resposta ao degrau unitário, no		campo	de	Laplace,	é
dada por					
Ap Cs2&gt; s	Ap Cs)  w				
	s. q Cs2&gt; w				
Fi nalmente, uti1i zando	o método	de Cr ump		OU O	de
Stehfest C subrotinas em anexo 3, é feita a inversão para o campo real.
O algoritmo de Stehfest limita-se À inversSo de funções contínuas, nSo funcionando quando há variações bruscas de vazSo. O algoritmo de Crump47’é mais sofisticado, utilizando-se de análise de Fourier e avaliando as funções no campo de Laplace para valores complexos do argumento s; este método de inversSo funciona satisfatoriamente mesmo quando há variações bruscas de vazSo.
2.43 MÉTODO 4
Este método utiliza o mesmo procedimento do método 3, mas os dados de pressão e vazão serão aproximados por spline cúbica em cada subintervalo de medição.
Sejam f , medi dos nos tempos
f
2 t
1
os valores
a interpolar.
»
»
f
n
&gt;
t
2
»
»
t
n
Defi ni ndo-se:
h.
V
t.-t.
V v-1
-f
i-i h.
2, n
a função "spline"
de grau
em
f Ct3 u
X. f.Ct.)
V L
I1
x.
-d
y.c
,t.
V
Ct. ,t.l 3 v-l V
xl.f Ct
J v-1	1-4
1 -x
C K.-dp.x j
+ h .
L
»
d
f

i
x

t-t.
V - 1
“TT
X

c
]
5
3
C
+

3
é :
3 +
. .C2.223
com
ao sistema
K
2
tr i di agonal :
, K	C der i vadas
n
nos nós3 satisfazendo
»
h. . K. +2.Ch,+h,	3,K.+h.. K. = 3. Ch .d.	+h.	.d)
v+l V—1	i v+4	i i v+1	v v+1 l+l V
i = 2,3.......n-1
. . . C2. 233
adi ci onais :
	2.Ki +	K = 3. d 2 2	C	f "Ct 3=0 3 , 2 1
1	K	+ 1 n-‘	2. K = 3. d	i n	r&gt;	C	f' • Ct 3=0 3 , n	r&gt;
ou				
&lt;	* 2. K +	K = 3. d 2 2	C	f' 'Ctt3=0 3 ,
		K = O n	C	f'Ct 3=0 3. n
				. . . C2. 243
A matriz	dos	coeficientes tem	algumas pr opr i edades	
especiais : é tridiagonal, simétrica e,			para	qualquer escolha
de	t &amp;lt;t &amp;lt;. . . 1 2	&amp;lt;t r»		é não—singular e diagonalmente	
domi nante. Então,	uma	solução única	,	...	,		K r&gt;
sempre existe.				
Pode ser mostrado		que	para qualquer escolha razoável	de
S		t r&gt;	a	matriz dos coeficientes é	bem
condi ci onada.				
Resolvendo-se	O	sistema	obtém—se	os	valores		das
derivadas nos nós. Utilizando—os na eq. C2.153 encontra-se a aproximação em cada subintervalo Lt^ , t ]
Pode-se reescrever a eq. C2. 223 da seguinte forma :
f CO
. . . C2. 253
onde
= K.
t-i
B. =
1 h.
- K. + 3. dj
e	C.	=	í K + K. - 2.dl .
«• h2 &amp;lt;V_1 v	VJ
i
A expressão em C2.163 vale para t e tt ,tJ. Para se obter a expressSo para a funçSo ftt) , V t e Ct^t^] , utiliza-se a funçSo degrau unitário.
Para o intervalo [ t , t ]	, pode-se escrever:
fCt3 =
fCt).
V
£ uCt-tt i5 - uCt-t¿3 j .
. . . C2. 263
Algumas propriedades importantes da interpolaçSo efetuada sSo:
a3 Em cada subintervalo tem-se um polinómio de grau 3.
b3 Existe continuidade da derivada segunda nos nós, isto é:
f' 'Ct.3 = f' ' Ct.3
L	l	V+l t
Como foi dito anteriormente, é necessário expressar f no campo de Laplace , o que é feito por:
= L{ f.Ct3
- uCt-t.3 ] } =

+ B. .Ct-t. 3 2 + C. .Ct-t. 33] . i	t-i	i	t—1 J
£ uCt-ti ±3
- uCt-t.3 j J
. . . C2. 273
i
EntSo:
lDLÍÍf +A. .Ct-t. 3+B. .Ct—t. IA	v	t-i
l-1
32+C.. Ct-t. t
expC-t. . sD
v-l
f. t-i
+ B . t2
L
* c.. t- }
expC-t .s3 £
f. L-l
S
A.
i
2. B.
V.
ã~
s
6. C
---I. . . C2. 293

+
2 S
A.. t
L
+A. Ct-t. 3+B . Ct-t. z&gt;2+c . Ct-t 3 a]. íuCt-t.oll
l-l	L	L-1	l	l-l J l	v J J

expC-t^.sS
L{
f.
l-l V
+A.. C t+h. 3 +B.. C t +h.32+C.. Ct+h.D 3
expC-t . s3
Cf. + A .h
L — 1	V l
B .h2
V V
•+
U	L


}
(
+
s
C eh* 3 V V
C A +2. B h +3. C.h® 3
L	Ll	L V
-
s
2.C B +3. C h 3
l	L L
-
s
. . . C2. 303
Substituindo C2. 293 e C2. 303 em C2. 273	»	a
expressão de	f	no campo	de Laplace é	obtida.
A subrotina		INTERP	, em anexo»	calcula os valores dos
coef i ci entes	A. , V	B. , C. V	L	&gt;	i = 2 *	...	, n .
Utilizando a subrotina INTERP, para os dados de queda de
pressão e de vazão.
e a expressão
C2. 273
encontramos as
oxpressSes de para
A resposta ao
Ap^ e	no campo de Laplace .
degrau unitário, no campo de Laplace,
é
dada por
Ap Cs3
---
Ap Cs3 = -----------
S — r
s. q Csj w
Finalmente, utilizando o método de Crump ou o de
Stehfest , é feita a inversão para o campo real.
CAP. 3
APLICAÇÕES
3.1) EXEMPLOS TEÓRICOS E TESTES SIMULADOS
Inicialmente serSo abordados alguns exemplos teóricos que possibilitam uma comparação dos métodos de deconvolução 1mplementados.
Sejam q^Ct) a função excitação aplicada a um sistema físico, dpwCt) a resposta por ele produzida e dpsCt) a "função transferência", ou resposta à função degrau unitário, obti da por deconvolução C ver Apêndi ce A ):
-&gt; dpsCt)
-&gt; dpwC t)
3.1.1) EXEMPLO 1
Sejam,por exemplo, q^Ct) = 2. t	e	dpwCt) = t2
A resposta teórica da deconvolução é :
dpsC t)
dpwCs) s. q Cs)
2
2 S
O método 1 produziu resultados corretos com o uso de Ô = 1Z2 . O método 2 também funcionou corretamente.
Os resultados apresentados pelos métodos 3 e 4 também tiveram boa precisão. Esta precisão pode ser melhorada, se o parâmetro "máximo erro relativo permitido" na inversão da Transformada de Laplace C ver Apêndice D ) for diminuído. Entretanto, quanto maior a precisão desejada, maior o tempo de computação necessário para a inversão.
Todos os resultados são apresentados na Tabela 3.1.
t	método 1 dps	método 2 dps	método 3 dps	método 4 dps
0. oo				
O. 05	0.050000			
0. 10		0.100000	0. 099313	0.092266
0. 15	0. 150000			
O. 20		0.200000	0.199433	0.202080
O. 25	0.250000			
0. 30		0.300000	0.299419	0.299449
O. 35	0.350000			
0. 40		0.400000	0.398010	O. 400160
0. 45	0.450000			
O. 50		0.500000	0.499807	O. 499977
0. 55	0.550000			
0. 60		0.600000	0.598682	0. 600026
0. 65	0.650000			
0. 70		O.700000	O.698575	0. 700017
0. 75	0.750000			
0. 80		0.800000	0.796263	O. 800020
O. 85	0.850000			
O. 90		O.900000	0.900039	O.900024
O. 95	0.950000			
1.00		1.OOOOOO	1.000028	O.999550
1.05	1.050000			
1.10		1.1OOOOO	1.100027	1.100025
1.15	1.150000			
1.20		1.200000	1.200026	1.200011
1.25	1.250000			
1.30		1.300000	1.300027	1.299989
1.35	1.350000			
1.40		1.400000	1.400027	1.399959
1.45	1.450000			
1.50		1.500000	1.500027	1.499920
1.55	1.550000			
1.60		1.600000	1.600027	1.599873
1.65	1.650000			
1.70		1.700000	1.700027	1.699815
1.75	1.750000			
1.80		1.800000	1.800026	1.799751
1.85	1.850000			
1.90		1.900000	1.900044	1.899667
1.95	1.950000			
2. 00		2.000000	2.000009	1.999585
Tabela 3.1- Exemplo 1: Resultados da deconvolução C resposta correta : dps = t D
e
- expC-t?
3.1.2? EXEMPLO 2
SeJ am
q CD = expC -t? w
dpwC t?
Cver Fig. 3.1?
A resposta teórica da deconvoluçSo é :
dpsCt?
dpwC s?
s.q Cs?
w
2
s. Cs+1?
s.
1 s+1
O uso de 6=1/2 no método 1, ao contrário do exemplo anterior, nSo produziu bons resultados neste caso. Os menores erros foram apresentados para 6=1. De fato, o valor de varia caso a caso, o que dificulta a aplicação deste método. Para testes em poços nSo surgentes, como foi visto no Cap. 2, o uso de Ô = 1 é aconselhável.
O método 2 apresentou acumulação de erros. Este é um problema crítico para a aplicação deste método, podendo causar inclusive sua instabilidade.
Os métodos 3 e 4 funcionaram satisfatoriamente, com erro quase nulo C ver Tabela 3.2 ?.
t	método CO=1D	1	método	2	método	3	método	4
	dps	i	erro	dps	erro	dps	erro |	dps	erro Cz0
1 w. x-/*-/			0.000000	0. 0				
0. 10	0. 210342	5. 17	0. 199833	-0. 08	0.199658	-0. 17	0. 199875	-0. 06
0. 20	0.420684	5. 17	0.398717	-0. 32	0.399356	-0. 16	0.399903	-0. 02
0. 30	0.631026	5. 17	0.596655	-0. 56	0.599065	-0. 16	0.599890	-0. 02
0. 40	0. 841367	5. 17	0.793652	-0. 79	0.798775	-O. 15	0.799889	-0. 01
0. 50	1.051709	5. 17	O. 989712	-1.03	0.998458	-0. 15	0.999884	-0. 01
0. 60	1.262051	5. 17	1.184840	-1.26	1.198243	-0. 15	1. 199880	-0. 01
0. 70	1.472393	5. 17	1.379041	-1.50	1.397971	-0. 14	1.399875	-0. 01
0. 80	1.682735	5. 17	1.572318	-1.73	1.597736	-O. 14	1.599871	-O. 01
O. 90	1.893077	5. 17	1.764677	-1.96	1.797488	-0. 14	1.799867	-0. 01
1.00	2. 103418	5. 17	1.956121	-2. 19	1.997173	-0. 14	1.999863	0.00
1.10	2. 313760	5. 17	2.146654	-2. 42	2. 197030	-0. 13	2. 199858	-0. 01
1.20	2. 524102	5. 17	2. 336282	-2. 65	2. 396803	-O. 13	2.399875	-0. OI
1.30	2.734444	5. 17	2. 525009	-2. 88	2. 596179	-0. 15	2.599850	-0. OI
1.40	2.944786	5. 17	2. 712838	-3. 11	2. 796013	-0. 14	2. 799846	-O. OI
1.50	3. 155128	5. 17	2. 899774	-3. 34	2. 995847	-0. 14	2.999841	-0. OI
1.60	3.365469	5. 17	3.085822	-3. 57	3. 195681	-0. 13	3.199837	-0. OI
1.70	3.575811	5. 17	3.270985	-3. 79	3. 395519	-0. 13	3.399833	0.00
1.80	3. 786153	5.17	3.455267	-4.02	3.595590	-0.12	3.599830	0. OO
1.90	3.996495	5. 17	3.638674	-4. 25	3. 795331	-0. 12	3.799825	0. OO
2. OO	4.206837	5. 17	3. 821209	-4. 47	3.994920	-0. 13	3.999827	0. OO
Tabela 3. 2 - Exemplo 2: Resultados da deconvolução
C resposta correta : dps = 2. t D
L
Figura 3.1- Exemplo 2: Funções excitaçSo	,
resposta CdpwZ) e "transferência" CdpsD
3.1.32) EXEMPLO 3
A ref. Õ traz um histórico de pressSo adimensional gerado par» o período de fluxo de um teste em poço, com estocagem e skin, produzindo com vazSo constante na superfície. Com estas condiçóes e considerando reservatório homogêneo infinito com fluxo radial, utiliza-se a soluçSo da fonte linear para se obter a expressSo da queda de pressSo adimensional no campo de Laplace, dada por:
K Cr V-s~3 + S 	 o	D p	=		 s(l ♦ S.CD(KoCrD&lt;^ ♦ s)
. . . C3.13
A vazão adimensional
na face da formaçSo
pode ser
calculada
pois assume—se um coeficiente de
estocagem
constante para gerar
através de:
. . . C3. 23
Assumindo-se C =109,	S=5, utilizando-se as	duas
D
t D	q WD	p WD	DECONVOLUÇXO	
			Ap C met.. 33 SD	Ap C met. 43 SD
io2	. OI3710	. 09929		
102- 3	. 039646	.30970	8.33081	8.17767
103	. 112090	.94100	8.85299	8.89798
103‘ 3	.294890	2.65325	9. 29820	9. 41801
10*	.637620	6.15337	9. 78920	10.03544
10*-3	.935790	9. 71998	10. 63681	10.59456
io3	.993310	11.02468	11.19125	11.13773
1	&lt;s 10 ■ 1	. 999490	12.29979	12. 32818	12.30617
3.3- Dados de entrada e resultados da deconvoluçSo
Observe-se o efeito da estocagem, fazendo com que somente para tD=10 a vazSo na face da formaçSo assuma um valor constante e igual à vazSo na superfície, corrigida para condiç3es de fundo. A estocagem provoca um afastamento do comportamento de pressSo em relaçSo à resposta teórica da formaçSo que, neste caso, seria uma linha reta semilog. Como se pode ver da Fig. 3.3 somente para t &gt;10 a resposta gerada se aproxima da linha reta semilog. Nota-se também que a deconvoluçSo utilizando os métodos 3 e 4, cujos resultados sSo apresentados na Tabela 3.3, elimina os efeitos de estocagem, apresentando a reta semilog desde o início.
Fazendo-se uma análise de regressSo para os dados resultantes da deconvoluçSo, obtém-se:
m = 1.1633
D
Ap Ct =1&gt; = 5.3248
SD D
Os dados do teste foram gerados utilizando os valores 1.1515 e 5.4045	, respectivamente. Observa-se, portanto,
um erro da ordem de 1%, que pode ser diminuido se os dados de pressSo e vazSo adimensionais forem gerados utilizando menores intervalos de tempo.
q»/qB
t.
Figura 3.2- Exemplo 3 Comportamento da vazSo adimensional na face da formaçSo
t.
Figura 3.3- Exemplo 3: Gráfico semilog da resposta de pressSo antes e após a deconvoluçSo
3.1.45 EXEMPLO 4
Este exemplo corresponde à análise do período de fluxo de um teste de formação tipo "DST*', em que os fluidos produzidos nSo atingem a superfície.
Utilizando a soluçSo encontrada por Jaeger C19565, em estudos de conduçSo de calor, Ramey e Agarwal Cref. 75 apresentaram, em 1972, a soluçSo para o "slug-test’* no campo de Laplace:
. . . C3. 35
onde:
p, - p» AP«
p	=	--------- =	------- ,
WD	p. - p	p. -p
l	o	t o
sendo K e K as funçSes de Bessel modificadas de primeira o	1
espécie.
Assumindo-se valores para C , S , p , p. e k/0uc r
Ca Tabela 3.4 mostra os parâmetros assumidos5, utilizando-se as subrotinas da ref.2O para o cálculo das funçSes de Bessel, e o algoritmo de Stehfest para a inversão da expressão C3.35, gerou-se a curva Pwf vs t apresentada na Fig. 3.4 .
Harametros utilizados para a geração dos dados de pressSo:					
p =637.7 psi O Pí=3489.7 psi k=41.6 mD			r =0.328 ft V Cf =0.0537 bbl/psi C =20498. D p=52.78 lbmZft3 h=17. ft c =8. xl0_&lt;s psi-1		
	S=+5 0=0. 16 p=l. cp				
t	pw C paO	DECONVOLUÇKO		Cpat/bbl/d2)	
CbD		método 1	método 2	método 3	método 4
. 000 . 050	657.700 726. 310	1.742	1.601 1.742	1.734	1.733
. 100	780.785	1.943	1.885	1.921	1.922
. 150	832. 761	1.999	1.972	1.978	1.981
. 200	882.857	2. 032	2. 012	2. 016	2. 019
. 250	931.372	2. 055	2. 039	2. 042	2. 043
. 300	978.488	2. 074	2. 060	2. 062	2. 063
. 350	1024. 331	2. 090	2. 077	2. 079	2. 080
. 400	1068.998	2. 104	2. 091	2. 093	2. 094
. 450	1112.562	2. 115	2. 104	2. 105	2. 106
. 500	1155.085	2. 126	2. 115	2. 116	2. 117
. 550	1196.619	2. 136	2. 124	2. 126	2.126
. 600	1237. 208	2. 144	2. 133	2. 135	2. 135
. 650	1276. 892	2. 152	2. 142	2. 143	2. 143
. 700	1315. 707	2. 160	2. 149	2. 150	2. 151
. 750	1353. 684	2. 167	2.156	2. 157	2. 158
. 800	1390. 852	2. 173	2. 163	2. 164	2.164
. 850	1427. 239	2. 179	2. 169	2. 170	2.170
. 900	1462. 868	2. 185	2. 174	2.176	2. 176
. 950	1497. 764	2. 190	2. 180	2. 181	2. 182
1.000	1531.948	2.195	2. 185	2.186	2.187
1.050	1565. 440	2. 200	2. 190	2. 191	2. 192
1. ÍOO	1598. 260	2. 205	2. 194	2.196	2.196
1.150	1630. 426	2. 209	2. 199	2. 200	2. 200
1.200	1661.955	2. 213	2. 203	2. 204	2. 205
1.250	1692. 864	2.217	2. 207	2. 208	2. 209
1.300	1723.169	2. 221	2. 211	2. 213	2. 213
1.350	1752.885	2. 225	2. 215	2. 216	2. 216
1.400	1782. 027	2. 229	2.218	2. 220	2.220
1.450	1810. 608	2. 232	2. 222	2. 223	2. 223
1.500	1838.642	2. 235	2. 225	2. 226	2. 227
1.550	1866.142	2. 239	2. 228	2. 229	2. 230
1.600	1893. 120	2. 242	2. 232	2. 233	2. 233
1.650	1919.589	2. 245	2. 235	2. 236	2. 236
1.700	1945. 560	2. 248	2. 238	2. 239	2. 239
1.750	1971.044	2. 250	2. 240	2. 241	2. 242
1.800	1996. 052	2. 253	2. 243	2. 237	2. 239
1.850	2020.594				
2400.00
2000.00
1600.00
1200.00
1.50
í'isd'1 MJ
800.00
400.00
Figura 3.4- Exemplo 4: Comportamento da pressSo de fluxo C"slug test"D
conceito de coeficiente de estocagem:
dp
q Ct)
dt
constante)
. . . C3. 45
Com os dados de Pwf e	gerados da forma acima,
fez-se a deconvoluçSo através dos quatro métodos implementados,obtendo-se o resultado apresentado na Fig. 3.5. Os gráficos semilog CFig. 3.65 indicam que a deconvoluçSo minimizou os efeitos de estocagem Clinha reta quase desde o inicio do teste}.
A interpretação é realizada da seguinte forma:
A solução do problema de vazão constante , em unidades do Sistema Americano,
é dada por:	
k w	1 üi.a ¡r	[ s	J	. . . C3. 55
Os métodos de deconvoluçSo
i mplementados
fornecem
valores de
AP Ct5 , sendo: s
ApsC t5
Ap Cs5
w_______
s. q^C s5
141.2 p

k h
Se o regime de fluxo for radial, a resposta acima será da forma:
AP Ct5 =	P = m . logCtD + cte.	. ..C3.55
s	k h	SD D
DPS (psi
t (h)
Figura 3.5- Exemplo 4.- Resultados da deconvoluçSo
DPS (psi
Figura 3.6- Exemplo 4: Gráficos semilog dos resultados da deconvoluçSo
P
•■&lt;0
+
V
. . . C3. 65
Substituindo C3.65 em C3.55 e comparando os dois lados da equação resultante, obtêm-se as expressBes para o cálculo da permeabilidade,
162,6	p m h
D
. . . C3. 75
e o efeito de película, determinado por:
. . . C3. 85
Fazendo-se uma análise de regressão para ajustar uma linha reta semilog aos dados resultantes da deconvoluçSo, observa-se que os quatro métodos apresentaram praticamente os mesmos resultados C Fig. 3.6 5, ou sejam:
m = 0,230 psi/bbl/d/ciclo ===&gt; k =41,6 mD
d
Nos métodos 3 e 4 » que envolvem as expressões de Ap^ e	no campo de Laplace» é necessário se fazer uma
extrapolação de p^ até o valor de p¿ » determinando o comportamento de pressão e» consequentemente» de vazão em todo o intervalo [o,a£&gt;. Deve-se isto á própria definição de Transformada de Laplace C Tabela 2.1 2). Se esta extrapolação não for feita» ocorre um afastamento dos últimos pontos resultantes da deconvolução» em relação à linha reta semilog. Dois tipos de extrapolação foram utilizados: linear pelos úl44"os dados de pressão ou ajustando uma curva logarítmica pelos mesmos pontos C esta última é a mais aconselhável quando o amortecimento não estiver próximo D. Os dados reais
em conjunto com os dados extrapolados são então ajustados por combinaçSes de splines lineares C método 3 2) ou cúbicas C método 4 2). Deve-se sal i entar que somente os úl ti mos pontos resultantes da deconvolução são influenciados pela extrapolação efetuada, a qual não interfere nos demais resultados e na interpretação como um todo.
3.1.53 EXEMPLO 5
üm-aspéúto importante da deconvoluçSo é a possibilidade de interpretação simultânea dos períodos de fluxo e estática, tratando-os como um único teste.
Para mostrar isto, seja o teste tipo DST da Fig. 3.7, gerado para escoamento linear, em reservatório infinito. A Tabela 3.5 apresenta os parâmetros assumidos para gerar os dados de pressão deste teste.
O método 4 foi aplicado, com o seguinte procedinento:
13 Inicial mente, foi feito um ajuste por splines • cúbicas
Ceq. 2.223 para os dados de pressão e vazão C esta, calculada com a eq. C3. 43 3 do periodo de fluxo, utilizando-se inclusive os pontos extrapolados mostrados na Fig. 3.8	, obtidos das
duas formas indicadas no exemplo 4. Desta forma encontra-se as expressSes para Ap Ct3 e q Ct3 para t &amp;lt;t
W	W	p
23 Para os dados do buildup,procede-se da mesma maneira:
O ajuste é feito pelos dados de
extrapolados, como mostrado na Fig. 3.8.
t &amp;lt;t P
é f ei ta li near mente, i mpondo-se
pressão medidos e
A extrapolação para
continuidade para a
em
+ =+
wp
dp wf
Cf
dt
extr apolação par a
mencionado no exemplo
extrapolaç3es realizadas
servem para evitar
adicionais C eq.
2. 24
splines cúbicas.
Desta
para as curvas
r~ “s
dp
ws
t=t P
Pws
4,
pí foi
dt
At=O
necessária pelo motivo
feita
1i near mente.
As
à esquerda e à
desvios provocados
3, utilizadas para
forma obtém-se um
de pressão e vazão em
direita de t
t p pel as condi ç3es
i nter polação por
comportamento suave
tempos próximos a
A MA A^SA*-^
A
»
a
. . C3. 93
t
t P
Somente estes pontos são influenciados pelas
Figura 3.7- Exemplo 3: DST gerado para um reservatório verticalmente fraturado
RESERVATÓRIO COM FRATURA VERTICAL ARTIFICIAL
xf C	comprimento da fratura 3 =	30. ft
h =	50.	ft		
k =	1OO.	mD	0 = .10	
P =	10.	cp	c = .100E-4 t	. -1 psi
Cf=	. 446	RB/psi	C = .446E-3 s	RB/psi
r = V	. 350	ft	Skin = 0.	
Pi=	1OOO.	psi	p = 100. O	psi
Tempo de produção : 9.480 h
Tempo de fechamento : 18.961 h
PressSo final de fluxo : 501.75 psi
PressSo final da estática : 782. 46 psi
Tabela 3.5- Exemplo 5: Parâmetros assumidos para a geração do comportamento de pressSo da fig. 3.7
Pw(l),psi
Figura 3.8- Exemplo S: Comportamento de pressões extr apoladas
extrapolações adotadas, sendo que nSo há comprometi mento da interpretação dos dados resultantes da deconvolução.
A interpolação é realizada por partes: inicialmente pelos dados de press2o de fluxo medidos mais os extrapolados.
e a seguir pelos dados de pressão estática C medidos e
extrapolados 3.
As expressões de Ap^Ct3 e q^Ct3 para todo o intervalo de teste [	0,t	], são obtidas com a eq. CS. 262), onde, neste
caso:
fCt3
k
f.Ct3. í uCt-t. 3
i.	l	t-l
Cfluxo3
- uCt-t3 J
n
f.Ct3 I
í uCt-t. 3
I ’--1
- uCt-tp j
C bui 1dup3
. . . C3. 103
Ct3	ou	f.Ct3	= q Ct3 , i	calculados	
pi	- P ,Ct3 wf	. t	&lt;	t =t k P
pí	- p Ct3 rws	, t	&gt;	t =t k P
Cf	dp rwf	+	&lt;	+ . =4.
	dt			k P
C . s	dp rws	♦	&gt;	t =t
	dt			k P
Para fluxo linear , em um reservatório infinito, a queda de pressão adimensional na face da formação C considerando fratura com fluxo uniforme 3 é dada por1&lt;s :
t&amp;lt;0.1
Dxf
para
a eq. acima pode ser simplificada
. . . C3. 123
Portanto, um gráfico logCpn3 vs logCt 3 apresenta uma xf
reta de declividade 1/2 .
A deconvoluçSo produziu a resposta apresentada na Fig. 3.9, que, num gráfico log x log CFig. 3.103, apresenta uma reta de declividade 1/2 desde os primeiros pontos. O efeito de estocagem é eliminado, e a caracterização do fluxo linear é feita desde o inicio do teste.
Uma vantagem desta análise simultânea de fluxo e estática é que a resposta da deconvoluçSo resulta numa curva maior, possibilitando uma análise mais segura por curvas-tipo, por exemplo.
O cálculo dos parâmetros é feito a partir da resposta da deconvoluçSo, Aps&lt;t3, a qual é dada por:
3.0
2.5

DPS (psi/bbl/d)
2.0
1.5
1.0

• » »
inicio da estática
0.5
DPS (psi/bbl/d)
ou:
âp Ct) = s
4» 064
h. xf
P___
0 ct
. Y t = m . t
D
Portanto, tem-se que:
-	c 4,064 'I2	
	1 %h J ‘	&lt;t&gt; ct
. . . C3.133
Do gráfico Ap^CtD vs Y t C Fig. 3.113 , obtém-se:
m =0,515 psi/bbl/d/h1/2
D
Com a equação acima, tem-se:
k.x2 = 249088	mD. ft2
Os dados de permeabilidade Ck=lOO mD3 e meio comprimento da fratura Cxf=50 ft3 fornecem:
k.x2 = 250000 mD. ft2
O. 4&gt;í .
DPS (psi/bbl/d)
3.2) APLICAÇÕES PRATICAS
AQUISIÇÃO DE DADOS :
Os principais procedimentos utilizados para aquisição de dados são:
a) Medição de pressão de fundo e vazão na superfície » é o mais utilizado na prática.
bO Inferição dos valores de pressão e vazão na face da for mação» para poços bombeados» a partir da determinação do nível de líquido por sonolog.
c) Medição simultânea de pressão e vazão na face da formação; procedimento muito pouco utilizado atualmente . A sofisticação dos métodos de interpretação Cpor exemplo, deconvolução de pressão e vazão)» deve—se em grande parte ao aparecimento de ferramentas capazes de realizar essas medi ç8es.
TRATAMENTO DOS DADOS :
A existência de ruídos nos dados de pressão e vazão» provocados pelos instrumentos de medição ou por erros nas leituras desses dados» pode provocar instabilidade nos métodos numéricos utilizados para a deconvolução. Então, antes de se iniciar a interpretação destes dados » deve-se inicialmente tentar eliminar esses ruídos, suavizando o comportamento das curvas de pressão e vazão vs tempo. Para isso» os dados medidos são aproximados por combinações de funções B—splines, obedecendo ao critério dos quadrados mi ni mos.
Aproximação de funcao tabelada, segundo mídíhos quadrados (usando 3 B-Splines)
Intervalos: X -&gt; ( 0.800 , 9.000 ); Y(X) -) ( 0.000 , 3.204 ) erro relativo da aproxinacao nos pontos tabelados*. 0.0402395
Figura 3.12 - Suavização de dados utilizando combinaçdes de funçSes B-splines e o critério dos quadrados mi rn mos
O programa MQBS 2* realiza esta suavizaçSo. A execuçSo deste programa é auto-explicativa, interagindo com u usuário para alteraçSo ou introduçSo de parâmetros. Hâ possibilidade de repetiçSo, utilizando diferentes números de B-splines. As saídas do programa podem ser: gráf icaCFig. 3.123 ou numérica, através de valores da aproximação calculados em pontos especificados pelo usuário.
EXEMPLOS :
3.2.1	Z&gt; EXEMPLO 6
Um teste de crescimento de pressSo pode ser analisado usando a teoria apresentada para período de fluxo, se associarmos a resposta de pressSo Ap^CO =PWSCtD-pw*xtCtD com a vazSo q^C O^^-q^C tZ), onde q^ é a vazSo de produçSo constante antes do fechamento C ver Fig. 3.13 3
Stewart, Wittmann e Meunier &amp;amp; apresentaram um teste de buildup de pressSo em que houve mediçSo simultânea de pressSo Cp Ct)) e afterflow Cq CtZ&gt;Z).O poço foi fechado na superfície» após produzir durante 96 h com uma vazSo de 9200 bbl/d , em condiç3es de fundo.
Os valores de vazSo após o fechamento foram registrados pelo flowmeter durante 1 h, quando entSo o spinner parou de girar. A partir deste instante, os autores extrapolaram o comportamento do afterflow considerando coeficiente de estocagem constante e igual ao último valor calculado C C=.Oi dCp CtZO
bblZpsi , obtido usando a eq. qc.CtZ&gt;=24. C.----------- D.
A extrapolação para o comportamento da pressSo de fluxo axL
foi realizada considerando p constante e igual ao valor registrado no instante do fechamento C1844.6 psiZ)
A Tabela 3.6 mostra os dados deste teste.
Os autores fizeram a deconvoluçSo destes dados de pressSo e vazSo utilizando um procedimento que assume
U N I C A M P
! r.íPWOTSCA CENTRAL
h=78 ft	c =20x1 o"tí	. - 1 psi	r =0.1875 ft
	1		V
ju=l cp	0=0. 2		q =9200 bbl/d
1	»xt_ PWf	PWff	=1844. 6 psi	
DADOS	DE	ENTRADA			DECONVOLUÇXO	
t , h	qC tD =q^-q^CtD	p Ct3-p ,, Ws	wf f CpsiD	método 3	método 4
	Cbbl/dD		Cpsi/bbl/d3	
0.04208	1476. 0	56. 7		
0. 10125	3452.7	142. 0	.042461	.042541
0.20958	6148.6	259. 7	. 042892	.042948
0. 31042	7647.4	326. 2	. 043364	.043333
0.40333	8388.0	361.4	.044177	.044147
0.50500	8768.8	383. 7	.045016	.045073
0.70708	9011.0	407. 2	. 046141	.046249
0.88542	9063.4	418. 1	.046841	.046881
1.04750	9090.1	424. 9	. 047226	.047257
1.24000	9132. 8	431.1	.047646	.047635
1.61130	9150. 6	439. 8	.048411	.048452
2.01710	9163. 3	446. 9	. 049058	.049059
2. 25670	9168. 8	450. 3	. 049369	.049374
2.52500	9172. 6	453. 6	.049667	.049679
2.98830	9177. 4	458. 3	.050122	.050126
3. 34330	9180. 3	461.4	.050419	.050428
3. 74080	9182. 7	464. 4	.050720	.050718
4.18540	9184.9	467. 3	. 051007	.051007
4. 68250	9186. 8	467. 6	.051296	.051296
5.14210	9188.5	472.5	.051523	.051522
6. 08540	9190. 4	476. 6	.051940	.051956
7. 90880	9192. 8	482.7	.052583	.050624
Tabela 3.6- Exemplo 6: Dados do teste de buildup e resultados da deconvoluçSo.
comportamento de fluxo radial, encontrando:
k-341,5 mD	e	S=l,814
Utilizando os métodos 3 e 4 implementados no presente trabalho, analizou-se estes mesmos dados, encontrando os seguintes resultados:
k=337. mD	e	S=l,590
Pode-se observar das Figs.3.14 e 3.15 que a deconvoluçSo diminui o tempo para o início da reta semilog 0.5 h). O gráfico convencional de p CtO-p vs logCtZ) só atinge o trecho reto semilog após 3 h de estática.
A Fig. 3.16 mostra os resultados apresentados pelos métodos 1, 3 e 4 , que diferiram somente nos pontos iniciais. O método 2 apresentou instabilidade.
DPS (psi/bbl/d)
Respostas antes e após a
Figura 3.14- Exemplo 6: decon vol uç So C método 3 2)
DPS (psi/bbl/d)
0.06 □
0.05 ¿
0.04 ¿
0.03 4
0.02 ¿
0.01 4
0.00 H-----r—
10 ~2
Figura 3.15-
deeonvoluçSo
apos deconvolucao , V**
•
+
«
*
+
* •&gt;
antes
da deconvolucao
* metodo 4
+
I—I—rm 11--1 (—t—I I "I 111-1 1—i i i I I 11
10” , x 1 10
(h)
Exemplo 6: Respostas antes e após a
C método 4 D
0.05
+
0.05
DPS (psi
0.04 ¿
0.04 -Ê
0.04
+ método 1
* método 3
o método 4
t (h)
Figura 3.16- Exemplo 6: Resultados apresentados pelos métodos
3. 2. 22) EXEMPLO 7
A ref. 11 apresenta resultados de um teste de crescimento de pressSo realizado em um poço bombeadoCPhi1ips * Oil Wel 1 N° 11, em que os dados de pressSo e vazSo sSo inferidos através do uso de um medidor de nível de líquido C sonolog d. Estes dados sSo mostrados na Tabela 3.7 .
A Fig. 3.17 mostra um gráfico tipo log-log convencional. Os dados do início do teste estSo completamente inf1uenciados pela estocagem, como se pode notar pela presença da reta de inclinaçSo unitária. Começa a haver um afastamento desta reta a partir de t=2 h. Usando-se a regra do 1 ciclo, vê-se que somente para t &gt; 65 h a linha reta semilog se desenvolve. Uti1izando—se o método de Horner, foram calculados a transmissividade e o efeito de película, resultando:
= 76,2 mD-ft/cp
e	S = -4,8
Segundo os autores, o cálculo destes parâmetros com o uso de curvas-tipo nSo foi possível, pois nSo conseguiram ”«&gt; bom ajuste dos dados.
Utilizando os dados Ap Ct2&gt;=p Ct2&gt;—p	e q Ct2&gt;=q -q Ct2&gt;
ws	wff	w	o s
da Tab. 3.7 C colunas 8 e 6 2), realizou-se a deconvoluçSo. A Fig. 3.18	mostra	resultados praticamente idênticos
apresentados pelos métodos 1»3 e 4. O método 2 apresentou i nstabi1i dade.
A Fig. 3.19 mostra o comportamento normalizado de pressSo antes e após a deconvoluçSo. Esta eliminou os efeitos de estocagem, indicando a existência de uma reta de inclinaçSo 1/2, característica de um reservatório verticalmente fraturado.
Para t &gt; 35 h , verifica-se
At» min	ni vel do 1í qui do, ft	pressão		afterflow			qo-qt RB/D	A p peí
		aupér f. peí	f undo psí	gás RB/D	llquido RB/D	total RB/D		
0	7277	40. 9	99	257	71	328	0	0
3	7269	41.3	103	229	59	288	40	4
5	7263	41.5	105	219	59	278	50	6
10	7248	42. 1	111	202	60	262	66	12
20	7219	43. 4	122	168	61	229	99	23
30	7190	44. 5	133	142	62	204	124	34
40	7161	45.6	145	122	63	185	143	46
50	7132	46. 6	156	105	64	169	159	57
60	7103	47. 6	168	91	65	156	172	69
70	7074	48. 6	180	82	65	147	181	81
80	7045	49. 5	192	72	66	138	190	93
90	7019	50. 4	202	67	61	129	200	103
100	6994	51.3	212	62	57	119	209	113
110	6970	52. 1	222	58	55	113	215	123
120	6948	52. 9	231	55	50	105	223	132
173	6851	56. 8	272	41	43	84	244	173
236	6756	60. 5	315	27	36	63	265	216
308	6665	64. O	356	19	31	50	278	257
390	6579	67. 5	395	15	26	41	287	296
583	6413	74. 3	472	9	20	29	299	373
694	6341	77. 4	505	7	16	23	305	406
814	6274	80. 4	536	6	14	20	308	437
945	6213	83. 3	564	5	12	17	311	465
1034	6155	86. 1	591	4	11	15	313	492
1234	6098	88. 5	621	3	10	13	315	522
1393	6041	90. 6	648	2	9	11	317	549
1562	5983	92. 7	674	2	9	11	317	575
1741	6926	94. 7	700	2	8	10	318	601
1929	5868	96. 6	726	1	8	9	319	627
2127	5811	98. 4	752	1	8	9	319	653
2334	5754	1OO. 3	777	0	8	8	320	678
2552	5696	102. 1	830	0	7	8	320	704
2778	5639	103. 8	828	0	6	7	321	729
3015	5582	105. 6	853	1	6	7	321	754
3180	5547	106.8	867	o	5	6	322	768
3240	5535	107. 2	873	1	5	6	322	774
3300	5523	107.6	878	1	5	6	322	779
3360	5511	108. 0	883	1	5	6	322	784
3420	5499	108. 4	888	1	5	6	322	789
3480	5488	108. 6	899	0	5	5	323	800
3540	5477	108.9	904	0	5	5	323	805
3600	5466	109.1	908	o	5	5	323	809
3660	5455	109. 3	913	0	5	5	323	814
3720	5444	109. 5	917	o	5	5	323 ,	818
3780	5434	109. 7	922	0	5	5	323	823
3840	5423	109. 9	926	o	5	5	323	827
3900	5413	11O. 1	930	o	4	5	323	831
3960	5493	11O. 4	935	0	4	4	324	836
4020	5383	110. 5	939	o		4	324	840
Tabela 3.7 - Exemplo 7: Dados do teste de buildup ,
Pws-Pwff, psi
Figura 3.17 — Exemplo 7: Gráfico log x log , mostrando o efeito de estocagem Creta de inclinação uniLáriaD
3.0
2.5 ¿
DPS (psi/bbl/d)
2.0 ¿	8 8
	8 8 8 * 4 0
1.5	8 i w-o 4- 0
1.0	O ♦ O «■ O /
0.5	
0.0^	f tr t i i i r i r~r i i i i i i i
0.0 20.0
o	método 1
*	método 3
4-	método 4
i~ n—i T i—r~ 40.0	i T i i i i | i i r i r 60.0
t (h)	
i i i r
80.0
Figura 3. 18 — Exemplo 7: Resultados da deconvoluç3o
10 q
DPS (psi/bbl/d)
1 ~
10 _1T
* apos deconvolucao + (Pws—Pwff)/Qo
+
i i 1111-1—i—r i 1111|-1—i—i i r 1111’
10 ■’ 1 10 t (h)
i—i—i ri 111]
10 i 2
Figura 3.1S — Exemplo 7: Gráfico log x log mostrando a minimizaçâo da estocagem pela deconvoluçSo
DPS (psi/bbl/d)
7Q
m =1,9 psi/bbl/d/ciclo
D
e
ApsCih?=-0,85 psi/bbl/d.
utilizando as fórmulas
3. 7
e
3. 8	, obtém-se:
f	J =85,6 mD-ft/cp
e
S=—4,7
Os autores utilizaram
o
método
apresentados contra logCtí Cgráfico MDHD, sendo obtidos resultados idênticos aos apresentados acima. A análise por curvas-tipo com os dados resultantes da deconvoluçSo também foi possivel,encontrando-se resultados praticamente idênticos
aos apresentados.
O trecho de declividade 1/2 no gráfico da Fig. 3.19 corresponde ao um trecho reto na Fig. 3.21, com
m = 0,46 psi/bbl/d/h1/z
D
Outros dados sSo:		&lt;t&gt; = 0,14 ct= 20 x IO 6 psi-1 h = 47 ft
Da eq.	C 3.13? , tem-se.-	
k	z	í 4,064	"'I	1	- 1	mD ft Z/rn
• *• -p	f	1 m h	J'&amp;lt;p c,	
Um aspecto importante da deconvoluçSo é que os dados dela resultantes identificam melhor os modelos de fluxo e do sistema, possibilitando uma melhor escolha de curvas-tipo para análise dos dados.
DPS (psi/bbl/d)
Figura 3.21 - Exemplo 7: Gráfico para análise do periodo de fluxo linear
3.8.33 EXEMPLO 8
Poço : 7—CP—137-SE
Teste : TFR-01
Interv. : 650,4-660,3 m
Data : Jan/84
A Fig. 3.28 apresenta o comportamento da pressão de fluxo registrado neste teste de crescimento de coluna. Os valores de pressão medidos estão na Tabela 3.8.
Da mesma forma que no exemplo C3. 1.43, os valores de vazão na face da formação são calculados assumindo coeficiente de estocagem C Cf D constante :
	= cr	w	z\ z * z ♦		
		dt	»	P	
		c -	2 n . r t		
			p g B		
e:					
	r = raio interno da t p ~ densidade média		tubulação, do fluido	(LI no poço.	[MJtLJ-9
g = aceleração da gravidade, [LHT3 B = fator volume de formação» adimensional
Com Ap^Ct3 = p^ - p^Ct3 e q^Ct3 calculada da forma acima, utilizou-se os métodos de deconvolução, encontrando-se a resposta de pressão a vazão constante. Este tipo de análise é bastante útil, quando a interpretação do crescimento de pressão não puder ser realizada por métodos convencionais (se houver amortecimento total do poço pelo fluido produzido}, ou não puder apresentar resultados confiáveis.
	7-CP-l37—SEZTFR—01 Canálise do fluxo2&gt;				
	DADOS DE ROCHA , POÇO			E FLUIDO :	
h	= 16.73 ft			p = 63.	lbm/ft®
	= 0.227			p = 0.65 cp	
c t	= 4. 38 x 10 ó psi 1			p = 50. 66 psi	
r V	= 0.2296 f t			Pt= 381.	81 psi
C	. = 0.00578 bbl/ft				
tub					
t	p cto	DECONVOLUÇÀO C psi/bbl/d 3			
th)	Cpsi2&gt;	método 1	método 2	método 3	método 4
. ooo	50. 66				
. 192	149. 02	2.236583	2. 227194	2. 198264	2.170454
. 384	176. 81	3.408869	2.875737	3. 066831	3.028358
. 576	193. 99	4. 185421	3.438527	3. 520450	3. 531430
. 768	211.22	4. 677310	3.840488	3. 923501	3.959749
. 960	225. 04	5. 068819	4.182115	4. 264456	4. 292462
1.152	235. 98	5.406883	4.475233	4. 553736	4.589872
1.344	245.80	5.683943	4.723500	4. 798468	4.836274
1.536	254. 93	5.906695	4.933632	5.006649	5. 046625
1.728	263. 20	6.090926	5.113409	5. 184539	5.225075
1.920	270.78	6.242812	5. 268063	5. 336357	5.377414
2.112	277.93	6. 372761	5.406325	5. 470704	5. 510259
2. 304	284.19	6. 513298	5.542943	5. 606170	5. 644293
2.496	288. 82	6. 685196	5. 684614	5.750655	5.790001
2. 688	292. 49	6.852762	5. 817831	5.885248	5.927756
2.880	296.86	6. 967284	5. 926063	5.994924	6.039569
3.072	301.93	7.039918	6. 012058	6.075989	6.119844
3. 264	306. 40	7.102634	6.084478	6.146797	6. 193931
3. 456	310. 64	7.139720	6.138298	6.223722	6.246468
3. 562	313. 59			6.278750	6.335422
t (h)
de pressáío de fluxo
método de Horner C Fig. 3.23 2) resultados :
apresentou os seguintes
	k =	4,0	mD
e	£ =	-2.
Uti1i zando-se Martin, obteve-se	as curvas-tipo de	Ramey,	Agarwal	e
	k =	1,74 mD	;	S =	-2,4	
Com os dados de pressão medidos e
de vazSo calculados
da forma indicada, foi feita a deconvolução. Os resultados
são mostrados na Tabela 3.8.
Pode-se ver na Fig. 3.24 que os métodos 2 , 3 e 4 apresentaram resultados praticamente iguais, enquanto o método 1, embora tenha se mantido estável, apresentou valores mais altos. Os gráficos semilog são apresentados na Fig. 3.25. Verifica-se uma leve ondulação nos últimos pontos, sendo
porém bem caracterizada a linha reta. A declividade da reta apresentada pelos resultados do método 1 não difere muito
daquelas dos outros trés métodos, o que leva ao cálculo de um
valor de permeabilidade sem grande
Os resultados obtidos, utilizando
C3.83 foram:
Método 1 :
m = 3,9 psi/bblzd/ciclo =&gt;
Ap^CitO = 5,1 psi/bblZd =&gt;
erro.
as equaçSes C3. 73 e
k =1,6 mD
S = -3,6
Cpol}
0.92 q
0.90 ¿
0.88 ¿
0.86 ¿
0.84 ¿
0.82 ¿
0.80 ¿
0.78
i----1--1—i—i—r i i i---1---1---r
10
C t + At 3/At P
i i T n i
10 2
DPS (psi/bbl/d)
DPS (psi/bb
3.00 ¿
2.00 ¿
1.00 - —
10 *1
i—i—i—i i i i-
t ¿h)
10
Figura 3.25 - Exemplo 8: Gráficos semilog dos resultados da deconvoluç3o
Método 2 :
m - 3. ô2 D	psi Zbblzdzci clo	=&gt;	k = 1,7	mD
Ap C ibD =	4,22 psi ZbblZd	=&gt;	S = -3,8	
Métodos 3	e 4 :			
m = ^.62 n	psi Zbbl zdZci cl o	=&gt;	k = 1,7	mD
Ap^C ih2&gt; =	4,36 psizbblzd	=&gt;	S = -3,7	
Como se pode notar,
o val or da
per meabi1i dade obti do
através da análise dos resultados
da deconvoluçSo foi
idêntico àquele apresentado pela análise de curvas-tipo, embora tenha havido diferença em relaçáo à permeabilidade
calculada pelo método de Horner. Esta diferença deve-se,
provavelmente, à grande variaçSo da vazSo durante o periodo de fluxo, o que compromete a validade do método de Horner. Outro aspecto é que nSo houve, no gráfico de Horner, uma boa
definiçào da linha reta semilog.
CONCLUSÕES - SUGESTÕES - RECOMENDAÇÕES
-	A determinação simultânea de dados de pressão e vazão na face da formação pode diminuir bastante o tempo de teste e, consequentemente, seu custo. O uso da deconvoluçSo para a análise destes dados minimiza efeitos de estocagem, identificando características difíceis de serem observadas por métodos convencionais de interpretação.
-	Os métodos de deconvolução apresentados, em particular os métodos 3 e 4 , fazem uma melhor identificação do modelo de fluxo do reservatório, o que possibilita uma escolha mais segura de curvas-tipo para análise dos dados.
-	Uma limitação destes métodos, como de qualquer método de deconvolução, é a necessidade de determinação da vazão na face da formação. Entretanto, as vantagens obtidas com o uso da deconvoluçSo devem incentivar o uso de técnicas de medição Já existentes e o desenvolvimento de outras. Para testes de buildup em poços bombeados, que representam a maior parte dos poços existentes no país, a determinação da vazão através da medição do nível de líquido por sonolog é uma técnica perfeitamente aplicável.
-	O uso da deconvoluç2o para a análise do período de fluxo de testes de formação em poços não surgentes é bastante útil, principalmente quando a análise do buildup por métodos convencionais for impraticável. O cálculo de vazão assumindo coeficiente de estocagem constante deve ser visto com reservas, embora esta suposição tenha levado a resultados coerentes em muitos testes.
-	A técnica apresentada de análise simultânea dos períodos de fluxo e estática tem a vantagem de produzir uma curva
resultante da deconvoluçáo mais prolongada, possibilitando uma • erpretaçSo mais segura através de curvas-tipo.
—	F, fundamental, para o perfeito funcionamento destes métodos, que as mediçSes de pressSo e vazão sejam as mais precisas possíveis.
-	Ruídos existentes nas mediçSes devem ser eliminados, pois podem provocar instabilidade dos métodos. Embora o método utilizado para a suavização dos dados tenha funcionado bem em muitos casos, é aconselhável fazer um tratamento estatístico destes dados. Acredita-se que desta forma a eliminaçSo de ruidos será mais efetiva e os dados resultantes mais representativos dos reais comportamentos de pressSo e vazSo do poço.
—	Os métodos apresentados nSo fazem qualquer suposiçào acerca da natureza do reservatório, podendo ser aplicados a reservatórios homogéneos ou heterogêneos, assim como para diferentes geometrias de fluxo.
-	Os métodos 3 e 4, sugestóes deste trabalho, são bastante rápidos e sempre aplicáveis, quando os ruidos nos dados sSo minimizados. Os métodos 1 e 2 mostraram-se mais susceptíveis a instabilidades, principalmente este último, que apresenta sério problema de acumulação de erros.
NOMENCLATURA
B	: Fator volume de formação
c r\	: Constante de estocagem adimensional
r~ r	■ Ccnstante de estocagem do poço no período de fluxo, [M]_1[L]“[T]2
c	: Constante de estocagem do poço no período de
	estática» [ M] _ 1 [ L] *[ TJ 2
0 '"t ub	: Capacidade da tubulaçSo por unidade de comprimento, CL]-2
C t	: Compressibi 1 idade total do sistema, [ M3 £[L][T]2
erf	: FunçSo erro
a	: AceleraçSo da gravidade, [LHTJ-2
h	: Espessura efetiva da formaçSo, CL3
k	: Permeabilidade da formaçSo, CL]2
K 0	FunçSo de Bessel modificada de primeira espécie e ordem zero
K 4	: FunçSo de Bessel modificada de primeira espécie e
ordem um
m	InclinaçSo da porçSo linear do gráfico semilog de
dados de transiente de pressSo
m^	InclinaçSo da porçSo linear do gráfico dos dados
resultantes da deconvoluçSo
pCr,t2&gt; : PressSo a uma distância r do poço, num instante t
[ M] [ L3_1[ T] ~2
p^	:	PressSo inicial do reservatório, [Ml [LJ~1[TI_Z
p	:	PressSo na face da formaçSo Cr=r D,	2
w	w
Ap^	:	Queda de pressSo no poço, [Ml [L1-1[T]-2
p	:	Queda de pressSo adimensional na face da	formaçSo ,
wu
obtida sob condiçSo de vazSo variável. C M3 [ LI _1[ T3 ~2
p^	: PressSo no período de fluxo, [ Ml [ L3_i[ TI 2
p	: PressSo no período de fechamento, CMltL] 1[T3-2
ws
■ PressSo de fluxo no poço, no instante do fechamento, [ M] [ LI-1[ T]-z
©2
Aps
P
SD
P
: Queda de pressSo normalizada no poço, para vazSo constante na face da formaçSo; inclui efeito de skin EM]-2EL]-1ET]_1
: Queda de pressSo adimensional no poço, para vazSo constante na face da formaçSo;inclui fator de skin
: VazSo na superficie, EL]3ET] 1
: VazSo na face da formaçSo, EL]3ET] 1
: VazSo adimensional
: VazSo de referência, EL]9ET] 1
Raio, ou distância ao centro do poço. EL]
: Raio do poço, EL]
: Rai o adi mensi onal
: Raio interno da tubulaçSo, CL]
: Fator de skin
: Argumento da transformada de Laplace
: Tempo, E T]
: Tempo de produçSo, ET]
Tempo adi mensi onal
: Tempo adimensional, para reservatório fraturado
: Volume por unidade de comprimento, EL]
: Meio comprimento de uma fratura vertical, ELI
: Constante exponencial de Euler C 1.781.... 2)
: Viscosidade, EM] EL]_iET]_1
Valor de &amp;amp; que produz erro mínimo na linearizaçSo da integral de convoluçSo C método 1
Densidade média do fluido no poço, EM]EL]
: Porosidade
SUBSCRITOS
D	adi mensi onal
f	fratura
L	inicial, Índice
J c*	índice . . . incluindo skin
t	total
wí	de f 1 uxo
ws	de estática
lh 'r	dado da linha reta semilog após 1 h de teste variável de integraçSo
Q4
BIBLIOGRAFIA
1-3 van Everdingen,A. F. e Hurst,W. : "The Application of the Laplace Transformation to Flow Problems in Reservoirs", Trans. Al ME Cl 9493 , V. 186, 305-24.
2.3	van Everdingen, A. F. : "The Skin Effect and Its Influence on the Productive Capacity of a Well", Trans. AlME Cl9533, V. 198, 171-76.
3.3	Gladfel ter , R. E. , Tracy,G.W. e Wilsey, L. E. : "Selecting Wells Which Will Respond to Production—Stimulation Treatment", Drill, and Prod. Prac., API C19553, 117-29.
4.3	Odeh,A. S. e Jones,L.G.	"Pressure Drawdown Analysis,
Variable Rate Case", JPT C19653 , 960-64. Trans AIME , 234.
5.3	Jargon,J.R. e van Poollen,H.K. : "Unit Response Function from Varying Rate Data" , JPT C19653, 965-69. Trans. AIME,234.
6.3	Ramey,H. J. ,Jr. " Non—Darcy Flow and Wellbore Storage
Effects in Pressure Buildup and Drawdown of Gas Wells "	.
J. Pet. Tech. CFev. ,19653, 223—233; Trans. AIME, 234
7.3	Ramey,H. J. ,Jr. e Agarwal 1,R. G. : "Annulus Unloading Rates as Influenced by Wellbore Storage and Skin Effect", Soc. Pet. Eng. J. COut. ,19723, 453-62.
8.3	Brownscombe,E. R. : "Afterflows and Buildup Interpretation on Pumping Wells", JPT C19823, 397-405.
9.3	Stewart, G. , Wittmann.M. J. e Meunier,D.	" After flow
10.2) Kuchuk,F. e Ayestaran, L. : "Analysis of Simultaneously Measured Pressure and Sandface Flow Rate in Transient Well Testing”, paper SPE 12177 Cl9833.
11-3 Fetkovich,M. J. e Vienot,M. E. : "Rate Normalization of Buildup Pressure by Using Afterflow Data" , JPT C19843, 2211-24.
12.3	Thompson,L. G. e Reynolds, A. C. :	"Analysis of
Variable-Rate Well-Test Pressure Data Using Duhamel’s Principle", paper SPE 13080 Cl9843.
13.3	'Thompson,L. G. , Jones, J. R. e Reynolds, A. C. : "Analysis of Pressure Buildup Data Influenced by Wellbore Phase Redistribution", SPEFEC19863, 435-52.
14.3	Kuchuk,F.J. "Gladfelter Deconvolution", paper SPE 16377 Cl9873.
15.3	Romboutsos,A. e Stewart,G. : "A Direct Deconvolution or Convolution Algorithm for Well Test Analysis", paper SPE 18157 COut. ,19883
16.3	Ear1ougher,Jr.,R.C. "Advances in Well Test Analysis",
Monograph Vol. 5	, Henry L. Doherty Series, SPE of Al ME ,
Dal1as, Texas, 1977.
17.3	Crump,K.S. : "Numerical Inversion of Laplace Transforms Using a Fourier Series Approximation ", Journal of tha ACM CJaneiro, 19763, Vol. 23, No. 1, 89-96
18.3	Stehfest,H. :	"Numerical Inversion of Laplace
Transforms”, Communications of the ACM CJan.,19703, Vol. 13, No. 1 , 47-49.
19.	) Corrêa, A. C. de F.	Algoritmo para InversSo de
Transformadas de Laplace Utilizando o Método de Crump , comuni cação pessoal
20.	) Press, W. H. , F1 annery, B. P. , Teukol sky, S. A. e Vetterling, W. T. " Numerical Recipes — The Art of Scientific Computing ", Cambridge University Press, 1986
21.	) Silva,M. L. F. :	" SoluçSes para Testes de Formação com
Geometrias Diversas ", Dissertação de Mestrado, Universidade Estadual de Campinas-SP, UNICAMP CMarço,1989)
22.	) Corrêa, A. C. de F. :	" Escoamento de Fluidos em Meios
Porosos",Petrobrás-Diven-Setor de Ensino da Bahia CMarçO-84)
23.	) Hamming, R. W. :	" Numerical Methods for Scientists and
Engineers ", McGraw-Hill, New York Cl973), 375-377
24.	) Santos,S. A. : Algoritmo para Aproximação de Função Tabelada Segundo Mínimos Quadrados Usando B-splines , comunicação pessoal C Dez—1987 )
25.	) Wylie,C.R. , Barrett,L.C.	” Advanced Engineering
Mathematics ", 5o. edição, McGraw-Hill, 1982.
APÊNDICE A
CONVOLUÇXO E FÓRMULAS DE DUHAMEL25
A. 1 3 TEOREMA DE CONVOLUggQ :
Sejam GC s3 e FCs3 as transformadas de Laplace de gCt3 e fCO, respectivamente. Se Ja y a convolu$So de g e f; isto é.
t
gCt-T3.fCr3.dT .
Então,
YCs3 = GCs3.FCs3
O
Observe-se que foram indicados O e t como limites de
integração , pois se f tem um impulso na origem, ele deve ser incluído no cálculo. Se g tem um impulso na origem, gCt— r3,como função de t, tem um impulso em t=r, que também deve ser considerado.
Uma aplicação prática importante do teorema acima é a possibilidade de se determinar a resposta de um sistema a uma excitação qualquer, conhecendo-se sua resposta a uma função degrau unitário, como será mostrado a seguir.
A. 23 FÓRMULAS DE DUHAMEL : DEDUÇÕES
Qualquer sistema físico capaz de responder a uma excitação pode ser imaginado como um esquema que transforma uma função de entrada Cexcitação3 gCt3 em uma função de saída C r esposta3 yC t3:
gCO
sistema físico
-&gt; yCO
Assumindo que todas as condições iniciais sâo nulas no instante em que gCt3 é aplicada ao sistema Cem testes de formação, por exemplo, a queda de pressão no reservatório é nula antes deste começar a produzir}» e resolvendo-se as equações diferenciais que descrevem o sistema por meio de tr ÃZisformadas de Laplace, obtém—se a transformada da funçSo resposta na seguinte forma :
’XyCt}&gt; = YCsZ) = -g-g ■	.....CA.1)
onde ZCs3 é uma função que depende somente de parâmetros do sistema. Pode—se representar isto através do esquema:
L-Cexci tação&gt; =GC s2&gt;
1
ZCs2&gt;
-&gt; L&lt;resposta} =YCs3
-----&gt;
A função
" ZCs3 é chamada de "função transferência".
Se uma função degrau unitário é aplicada ao sistema» então:
L&lt;yCt}&gt; =
LCuCt?&gt; ZCsD
1
s. ZCs3
Chamando de fC13
a resposta ao degrau unitário, ou seja»
LXfCt3&gt; =
1
s. ZCs3
.....CA. 23
Utilizando-se CA.23,pode-se reescrever CA. 13 na forma :
L&lt;yCt3&gt;
L&lt;gCt3&gt;
ZCs3
s. LCgCt3&gt; s. ZCs3
= s.L&lt;gCt3&gt;.L&lt;fCt3&gt;
Pelo teorema de convolução, tem-se que:
L&lt;yCt3&gt;
= s. L&lt;
t
I gCt3 . fC t-r3 . dr
O
t
= s.L&amp;lt;i gCt-T3.fCr3.dT 3
Jo
Usando a regra da derivada Ctabela 2.1 3, segue que
t
y&lt;t3 = —[ i gCr3.fCt-T3.dT 3 = — Jo
t
I gCt-T3.fCr3.dT ]
O
Realizando—se as diferenciações, resultam as seguintes fór muias equi vaientes :
t
yCt3 = I gCr3. f ’Ct-r3. dr + fCO3.gCt3	.....CA. 33
Jo
t
e	yCt3 = I g*Ct—r3. fCr3. dr + gCO3.fCt3	.....CA. 43
O
Como fCt3 é, por definição, a resposta de um sistema inicialmente passivo,a equação CA. 33 pode ser simplificada para:
t
I gCr3. f &gt;Ct-r3. ót	.....CA. 53
Jo
yCt3
1OO
Fazendo-se a mudança de variáveis o = t—t
CA. 43 e CA. 53 , tem-se, respectivamente :
nas equaçSes
t
yCt3 = g’CoD. fCt-oO. do- + gCO3.fCt3
O
.....CA. 63
t
yCt3 = I gCt-o-3. f’Co3. d&lt;r
O
.....CA. 73
As fórmulas CA. 43 a CA. 73 servem para expressar a resposta de um sistema a uma excitação qualquer gCt3, em termos da resposta do sistema a uma função degrau unitário. Elas são conhecidas como ** fórmulas de Duhamel ".
t.
J
e . t. + c i - e. D.t. j j+i	j j
onde
O&amp;lt;
APÊNDICE C
ser realizada a suavizaç2o. Spline cúbico, associada a esta partiç2o, é funç2o que:
iZ) Restrita ao subintervalo Ct ,t	O &amp;lt;i &amp;lt;m-1»
L L+l
é polinómio de grau 3.
i i 2&gt; A funç2o resultante da uni 2o destes pedaços polinomiais tem derivada segunda continua.
E possível estabelecer uma base para o conjunto das funçóes splines cúbicos; as funçóes desta base são chamadas B-splines, B&lt;tZ&gt;. Pode-se obter expressóes para BXtZ) através de mudança de variáveis da função BCxZ) , definida no intervalo padr 2o C -2,23 por
Cx+2Z)3			em	[-2,-1]
1 + 3.CX+1)	+ 3.Cx+lZ&gt;2	- 3.Cx+lZ&gt;3	em	E-l, OI
1 + 3.C1-X2)	+ 3.C1—xZ&gt;2	- 3.Cl-xZ)3	em	[ 0, 1]
C2~xZ)3			em	[ 1, 21
0	se x está	fora do intervalo		[-2, 2]
Os gráficos de BCxZ) e BXtZ) s2o mostrados na fig. C. 1 .
A suavizaç2o dos dados de press2o e vazão é feita como ,	. ,	.24
descrito a seguir
Sejam os pontos Ct,fCt33»Ct»fCt3Z&gt;» ... ,Ct ,fCt
1122	nr»
onde fCt.Z) corresponde a um valor de APw ou de qw medido no tempo t . A funç2o FCtZ&gt; será um spline cúbico com nós em V»
O &amp;lt;i &amp;lt;m. Escrita em termos da base B.CtZ),
FCtD
=	&gt; a.-BCt)
*• v
critério dos quadrados mínimos, ou seja, minimizando o residuo ao quadrado.
FCtO
i
-fct? ]*•
Demonstra-se que este problema tem soluçSo única, obtida pela condiçSo
J C FCt^-fCt.3 J2 j = O , i = 1,2, . . . ,m.
Resolvendo-se o sistema resultante, calculam-se os valores ot^’s e obtém-se a aproximaçSo suavizada da funçSo tabelada.
B(x)
Figura C. 1
FunçSo B-spline
APÊNDICE
D
LISTAGENS DE PROGRAMAS
a u u u	u u u
PROGRAM ÜECONV
IMPLICIT REAL*B(A-H,O-Z)
COMMON /LAP/T(lOO&gt;,a&lt;lOO),DPW&lt;lOO&gt;,M
OPEN(5,FILE= DECONV. DAD
ENTRADA DE DADOS DE VAZAO E DE QUEDA DE PRESSÃO, VIA TECLADO OU ARQUIVO DECONV. DAT
H'’ VRITE(*,1OO)
1OO FORMAT&lt;2x,'Opcoes pz ont.ra.da do dados : 1 - via teclado',Z, *'	2 - via arquivo deconv. dat ,Z
*,' Opcao escolhida : '&gt;
READ(*,UO&gt;L
11O FORMAT(I2)
IF(L. NE. 1. AND. L. NE. 2)00 TO BO
IF&lt;L. EQ. 1) THEN
WRITE&lt;*,12O&gt;
120 FORMAT(ZZZ,2X,'Entra com a tabela tt&lt;t),q&lt;i),dpw&lt;i)J',Z, *2x,'&lt;para encerrar.digvtar um valor de t negativo)') i=l
125 READ(*,*)t(l),q&lt;i),dpv(l)
IF(Kl). LT. O. DO) GO TO 140
l=t+l
GO TO 125
14.0 M=i—1
ENDIF
IF&lt;L. EQ. 2) THEN
i=l
145 READ(5,*)t&lt;i),q&lt;i),dpv(i)
IF&lt;t(i).LT.O. DO) GO TO 155
i=i+l
GO TO 145
155 M=i-1
ENDIF
ESCOLHA DO METODO DE DECONVOLUCAO
IcSO WRITE&lt;*,1&lt;55)
1&lt;55 FORMAT&lt;zzz,2X,'Metodos para deconvolucao :',z, *15x,'l - Hammtng',lOx,'2 - Regra doa trapezLos',z, *15x,'3 - Spline linear',4x/4 - Spline cubica'.z, *2x,'Metodo escolhido :')
READ&lt;*,17O)L
170 FORMATÍI2)
IFO,. EQ. 1)00	TO	200
IF&lt;L. EQ. 2)GO	TO	300
IF&lt;L. EQ. 3)00	TO	400
IF(L. EQ. 4)00	TO	500
200 CALL HAM		
GO TO&amp;lt;500
oon M=M-1		
	CALL TRAP GO TO&amp;lt;SOO	
• «o	CALL SPUN GO TO&amp;lt;500	
"=oo	CALL	SPL.IC
ODO
&lt;500 VRITE&lt;»,&lt;5O5)
&lt;505 FORMAT&lt;//,2X,'Outro metodo	; 2-no.o) 7')
READ&lt;*,&lt;S1O&gt;L
&lt;510 FORMATdZ!
IF&lt;L. NE. 1. AND. L. NE. 2)00 TO&amp;lt;500
IF&lt;L. EG. 1&gt; OO TO 1&lt;SO
STOP
EN'-
DECONVOLUCAO : METODO 1
SUBROUTINE HAM
IMPLICIT REAL*B(A-H,O-Z)
DIMENSION CT&lt;100),Y2&lt;100),TA&lt;100),OA&lt;100),PWD&lt;100),PSD&lt;100)
COMMON ZLAP/T&lt;1OO),Q(1OO),DPW&lt;1OO),M
OPEN«5,FILE='HAM. OUT')
WRITE&lt;*,1O)
IO FORMAT&lt;2X,'QUAL O VALOR DE TETA?')
READ!#,*)TETA
N=M-1
DO 20	1=1,M
TA&lt;I)=T&lt;I&gt;
OA&lt;I)=O&lt;I&gt;
PWD&lt;I)=DPW&lt;I&gt;
20 CONTINUE
PSD(1)=PVD&lt;2)/QA&lt;2)
CT&lt;1)=&lt;1-TETA)*TA&lt;1&gt;+TETA*TA&lt;2)
DO 50 J=2,N
SUM=O .
DO 50 I=1,J-1
R=TA&lt;J+1)-TA&lt;I&gt;
YP1=1O**3O.
YP2=1O**3O.
CALL SPLINE&lt;TA,aA,M,YPl,YP2,Y2)
CALL SPUNT&lt;TA,QA,Y2,M,R,Ra)
QR=RO
S=TA(J+l)-TA&lt;Itl)
CALL SPLINT&lt;TA,OA,Y2,M,S,RO&gt;
as=RQ
auM=suM+PSDd)*iaR-as&gt;
V=TA&lt;J+1)-TA(J)
CALL SPLINT(TA,aA,Y2,M,V,Ra)
av=Ra
CT&lt;J)=&lt;1-TETA)*TA&lt;J&gt;+TETA*TA&lt;J+1&gt;
PSD&lt;J)=(PVIXJ+l)-SUM&gt;/aV
50 CONTINUE
WRITE&lt;*,&lt;SO&gt;
WRITE«S,&lt;5O&gt;
&lt;50 FORMAT&lt;eX/T',14X/DPS')
DO 1OO J=1,N
WRITE(*,7O) CT(J),PSD&lt;J)
WRITE«S,7O) CT(J),PSD(J)
70 FORM AT&lt;2X,F13.&amp;lt;S,2X,fl3.&amp;lt;S&gt;
1OO CONTINUE
RETURN
END
n
N
n
r o d ►*
D H K PJ Z n H 0 z
X
&gt;
zs z k &gt;
•&amp;lt;N
►
zv z
3
r— r-
0
r-
1
•
P r*
* D í&gt;
T
N
n c to X 0 c H H z PI
w
X r H z d zs X
► •»
►
* •4 N
► &gt;» z s X k
r w pi
X N **»
v&gt; c to X 0
H z ► V)
X
► X &gt;
H z H PI X •o 0 r
► n ► o
■o
O
x
w *o r H z PJ
n c a H n
&gt; M
N o
n n
DECONVOLUCAO : METODO 2
SUBROUTINE TRAP
IMPLICIT REAL*B&lt;A-H,O-Z)
DIMENSION A(lClO,lOO&gt;,Da&lt;iOO&gt;,DPS(lOCl),V2(lOO) COMMON ZLAP/T&lt;iOO),Q&lt;lOO),DPV(lOO),M OPEN&lt;’’.rILE='TRAP. OUT')
C	CALCULI) DAS DERIVADAS DA VAZAO NOS NOS
DO 40 I=2,M+2
Da(i-i)=(Q&lt;i)-a(i-i»/&lt;T&lt;i&gt;-T&lt;i-i))
40 CONTINUE
C	MONTAGEM DA MATRIZ
A&lt;1,1)=O&lt;1&gt;
K=M+1
DO 1OO I=2,K
A&lt;I,I&gt;=a&lt;l)+DQ&lt;l)*&lt;T&lt;I&gt;-T(I—l»/2.
R=T&lt;I'-T&lt;1&gt;
YP1=1O**3O. YP2=1O**3O . CALI. SPLINE&lt;T,Da,K,YPl,YP2,Y2)
CALL SPLINT&lt;T,DO,Y2,K,R,Y) D&lt;J»=Y
A&lt;I,l&gt;=DQR*&lt;T&lt;2)-T&lt;l»/2.
1OO CONTINUE
DO 120 1=3,M+l
DO 11O J=2,I-1
s=t&lt;i&gt;-t&lt;j&gt;
CALL SPLINT&lt;T,DQ,Y2,K,S,Y&gt; DQS=Y
A(I,J&gt;=DaS*&lt;T&lt;Jtl&gt;-T&lt;J-l»/2.
11O continue
120 CONTINUE
IF(A&lt;1,1). EQ. O. DO) THEN
DPS&lt;1)=O. DO
GO TO 130
ELSE
DPS&lt;1)=DPW&lt;1)/A&lt;1,1)
ENDIF
130 DO 150 I=2,M+1
SOMA=DPW&lt;I.'
DO 140 J=1,I-1
140 SOMAsSOMA-A(I,J)«DPS&lt;J)
DPS&lt;I)=SOMA/A&lt;I,I&gt;
150 CONTINUE
WRITE&lt;*,155)
WRITE&lt;7,155&gt;
155 FORM AT&lt;5X,'T',14X,'DPS')
DO 200 I=1,M+1
WRITE&lt;*,1OO)T&lt;I),DPS&lt;I)
WRITE!" ,leSO)T&lt;I),DPS&lt;I)
1&lt;5O FORMAT&lt;2X,F8. 3,5X,F12.&amp;lt;S&gt;
200 CONTINUE
RETURN
END
u u u	u u u
HECONVOLUCAO : METODO 9
SUBROUTINE SPLIN
IMPLICIT REAL*8(A-H,O-Z)
COMMON /LAP/T«OO),a&lt;lOO&gt;,DPV&lt;iOt»,M
COMMON /SPL/A(1OO),B(1OO),H&lt;1OO)
EXTERNAL F
OrEN&lt;8,FILE='SPLIN. OUT')
CALCULO DOS COEFICIENTES PARA INTERPOLACAO E DE H&lt;I)=T&lt;I&gt;-T&lt;I-1&gt;
DO 5 1=2,M
5 H&lt;I)=T&lt;I&gt;-T&lt;I—1&gt;
DO IO I=2,M
A(I)=(DPW(I)-DPV(I-i»/H(I)
B&lt;I&gt;=&lt;Q&lt;I&gt;-Q&lt;I-1»ZH&lt;I&gt;
IO CONTINUE
WRITE&lt;*,«&gt;
WRITE&lt;*,*&gt;
15 WRITE&lt;*,*)'Metodos pZ inverter TL : 1-STEHF ; 2-CRUMP'
WRITEC*,*)'Mctodo escolhido
READ(»,17)L
17 FORMATÍI5)
IF&lt;L. NE. 1. AND. L. NE. 2)00 TQ 15
IF&lt;L. Ed. DTHEN
WRITE&lt;«,2O)
WRITE(B,2O)
20 FORMAT(//,2X,'Dacorivolucao ueando STEHFEST,//,
*&lt;SX/T',15X,'DPS '&gt;
DO 90 1=2,M
ST=T&lt;I&gt;
IF4ST. EO.O.DOIOO TO 90
CALL STEHF&lt;ST,FT)
WRITE&lt;*,45&gt;ST,FT
WRITE&lt;B,45&gt;S T,FT
90 CONTINUE
ENDIF
IF&lt;L. EQ. 21THEN
alpha=O. DO
err=l. D-5
WRITE(*,4O)
WRITE&lt;B,4O)
40 FORMAT&lt;//,2X,'D«convolucao ueando CRUMP',//,&lt;5X,'T',15X,'DPS')
DO 50 J=2,m
CALL CRUMP&lt;et,alpha,err,n,F,ft&gt;
WRITE&lt;»,45)et,ft
WRITE&lt;B,45&gt;St,ft
45 format(2x,flO . 5,5x,fl2.&amp;lt;5)
50 CONTINUE
ENDIF
RETURN
END
u u	uuuuuuuuuuyyuuuuuuuuuuuuuuuu
EXPRESSÃO DA RESPOSTA A VAZAO CONSTANTE NO CAMPO DE LAPLACE
SUBROUTINE F&lt;SR,SI,DR,DI)
COMPLEX*16 S,DF,DPWL,fakl,fok2,RF,OWL,ZS
REAL*B SR,SI,DR,M,A,B,T,Q,DPV,H
COMMON /LAP/T&lt;1OO),C1&lt;1OO&gt;,DPV&lt;1OO),M
COMMON ZSPL/A&lt;1OO),B«OO&gt;,H(1OO)
S=DCMPLX&lt;SR,SI)
DPVL=&lt;O. ODO,O. ODO)
QWL=&lt;O . O DO,O , ODO)
ONE=(1. ODO,O. ODO)
ZS=ONE/S
do 50 i=2,m
fakl=cdexp&lt;-t&lt;i-l)*a&gt;
f ak2=cdexp&lt;-t&lt;i)*s)
DPWL=DPWL+fakl*«a&lt;i)*ZS-f-dpv(i-l»*ZS)
DPVL=DPVL-fak2*«a&lt;i)»ZS+dpvá-l)+a&lt;i)*h&lt;i))*ZS)
QVL=QVL+taH*«b&lt;i)*ZS+q(i-l»*ZS) aVL=OWL-fak2*«b&lt;i)*ZS+q&lt;i-l)+b&lt;i)*h&lt;i»*ZS&gt; 50 CONTINUE
DPWL=DPWL+fak2*«a(m)*ZS+dpw&lt;m»*ZS&gt;
QWL=aWL+fak2*«b&lt;m)*ZS+q&lt;m))*ZS)
RF=DPWL/&lt;S «Q WL)
DR=DBLE(»F!
DI=DIMAG&lt;RF)
RETURN
END
SUBROTIN A PARA IN VERS AO NUMERICA DE TRANSFORM ADA DE LAPLACE
UTILIZANDO O METODO DE CRUMP
SUBROUTINE CRUMP &amp;lt;t, alpha, err, N, F,ft&gt;
NUMERICAL TECHNIQUE	INVERSION OF THE LAPLACE TRANSFORM USING THE CRUMP'S
(Journal of the ACM, Vol. 23, No. 1, January l£»?ó, pp. B£&gt;-&lt;*&lt;$. )
ON ENTRY
t	REAL.*6 Timo for which th® transform is to bo computed
F	DOUBLE COMPLEX EXTERNAL FUNCTION The Laplace transform to be inverted
alpha	REAL*B Maximum real valued pole of ZLAP
err	REAL*B Maximum relative error allowed.
ON OUTPUT
FT	REAL*B Computed value of the inverse Laplace transform of F
N	INTEGER** Number of terms in the Fourier series used to c.---or-oxi»—ite FT
ANTONIO CLAUDIO CORREA - STANFORD UNIVERSITY - FEBRUARY
IMPLICIT REAL»B!A-H,O-Z) REAL’S ImZ
DIMENSION E(PiJP) EXTERNAL F
DO&amp;lt;O 1 - 1, trf&gt;C&gt;
E(t&gt; = O. ODO
IO CONTINUE
NM4X = 4PP
u u u	u u u
im =&amp;lt;O. ODO.1. ODO)
TT = O. BDO * t
a = alpha - 0.5DO * DLOO(orr) Z TT
ST = O.ODO
SUM = O. ODO
SUMLST = O.ODO
pt = 4. ODO * DATANd. ODO)
DO 40 k = 1, 2*NMAX+1
argl = k*piZTT
arg2 = k * pi * t Z TT call F&lt;A,ARGl,RsZ,ImZ&gt;
ST = ST + R®Z * DCOS«xrg2) - ImZ * DSIN&lt;arg2)
#**#»#******« BEGIN EPSILON ALGORITHM ******************
Etml = O. ODO
Ei = E&lt;1&gt;
E(i&gt; = ST
IF &amp;lt;k . EQ. 1) GO TO 35
DO 30 i = 1, k-1
aux = E&lt;i+1)
dif = Eli) - El
IF 1 DABSldif) -LT. 1.OD-7O) THEN
Elt+i) = Elt)
ELSE
Eli+l) =&amp;lt;1. ODO Etml » dif) S dif
ENDIF
Etml = Ei
Ei = aux
SUM = E&lt;V+1&gt;
30	CONTINUE
TEST FOR CONVERGENCE
IF 1 kZ2«2	. NE. k &gt; THEN
erroat = DABS1SUM) - DABS1SUMLST)
arroat = DABS(erroat) z DABS1SUM)
IF 1 arraat .LT. O. l*DABS&lt;srr) ) THEN
N = k
GO TO 50
ENDIF
ENDIF
35	CONTINUE
IF 1 kZ2*2	. NE. k &gt; SUMLST = SUM
C
C **•*»•«***«*** END EPSILON ALGORITHM *******************
n n n
40 CONTINUE
50 call F(A,O. ODO,RaZ,ImZ)
FT= DEXPía * t&gt; / TT * &amp;lt;O. 500 * RcZ + SUM &gt;
RETURN
END
SUBBOTINA PARA INVERSÃO DE TRANSFORMADA DE LAPLACE UTIITZANL-O O MÉTODO DE STEHFEST
SUBROUTINE STEHF(T,FT)
IMPLICIT REAL«B(A-H,O-Z1
INTEGER M
EXTERNAL FST
DIMENSION V1&lt;1&lt;$&gt;,V(1&lt;$&gt;
DATA VIZ
*-3. ÍXSS253ÍX5S253C«SSD~OO4,2. 13373015373015p,
*-551. Ol&lt;ft5c5ci&lt;5&lt;Sd&lt;5&lt;5&lt;57OO,335OO . lcHllllllllOOOO,
*-812&lt;5&lt;S5. 111111111100000,1. OO7&lt;5ie37&lt;$&lt;$&lt;$0&lt;5&lt;S7D+OO7,
*-7. 3241382077777730+007,3. 3OO5OC532O73O15OD+OO3,
*-l. O5253O53&lt;S278571D+OOO,2. 25OO13328583333D+OOO,
*-3. 9007010844333330+000,3. 5824504617OOOOOD+OOO,
*—2. 5O14O4OeiStS&lt;$O&lt;í7D+OÚO,l. 22?04082B70&lt;$0«S7D+000,
*-9. 4273455542357140+008,4. 284181O42857143D+OO7Z
DO 327 J=l,l&lt;$
V&lt;J)=VKJ&gt;
327 CONTINUE
VAL=DLOO(2. )ZT
FT=O.
DO 40 J=l,l&lt;5
SA=VAL*J
FT=FT+V&amp;lt;J&gt;*FS T(S Al
40 CONTINUE
FT=FT*VAL
RETURN
END
C	EXPRESSÃO DA RESPOSTA A VAZAO CONSTANTE NO CAMPO DE LAPLACE,
C	QUANDO SE UTILIZAR O METODO DE STEHFEST PARA A INVERSÃO
FUNCTION FST(S)
IMPLICIT REAL*B!A-H,O-Z)
COMMON ZL AFZT41OO ,',Q(1O O ),DP WHO O &gt;,M
COMMON ZSPLZA&lt;100),B(100),H(100)
ZS=1. DOZS
DPWL-O. DO
QVL=O. DO
do 50 i=2,nt
f cücl=cdaxp&lt;-t&lt;L-l&gt;*a&gt;
f eüc2=cdexp(-t&lt;i)*a&gt;
DPVL=DPVL+fakl*«a&lt;i&gt;«ZS+dpv&lt;i-l»»ZS&gt; DPWL=DPWL-fcik2*«aá&gt;*ZS+dpw&lt;L-l&gt;+a.&lt;L&gt;*h&lt;t»*ZS&gt; aWL=aWL+fakl*«b(U*ZS+q&lt;i-4»*ZS)
QVL=aWL-fak2*«bãl«ZS+qd-l)+b&lt;i)*h(i»*ZS)
50 CONTINUE
DPWL=DPWL+fak2*«o&lt;r!^*ZS+dpv&lt;m»«ZS&gt;
QWL=QWL+f&lt;lk2*«bçm&gt;+'ZS. + qiír.&gt;&gt;*ZS&gt;
iflqwl. oq. O. dOJthwii
f st=O. do
n
inn
	4 J}	*0	•o	*0	*0
3	3 3	3	2	3	3
g	K R		LO	N	£
r-	C C	r-	P-	r-	r-
ií	li li	Tí	lí	Tí	Tí
N	p •£.	ft	N	X	a-
	r ■ r •			r	"0 «-
J¡	u	i
g	3	0
i	u&gt;	0
D	n	X		0&amp;lt;£	
m	z	P1	n	y	0
n	B	•í	H	0-	
0		c	II		r*
z		X	0		0
&lt;		z	X		
0			c		8
r			r		
c			&lt;&lt;s		
n			n		
&gt;			*		
0			0		
			t		
			r		
K					
PJ					
					
0					
0					
0					
A					
o PI
r
&gt;
x r*
►
n
n
n
n n
10	N
o	o
!*■	&gt;»■
u	o
N O
►
*
w
n s
90
0 w
»
F1
c
90
Z
K
0
90 li
90 0
. 3 ?■ ? to H b í &gt; »
* to ij to
C w m 0
&gt; w to •»
n o
s
•0
0
90
li D
&gt;* Q
90 O
II D Z w \ w
0 z w
II
0 o 0
%
o
0
0 o
0 &amp;lt;r ti o
0
0 0 b
o o o
■o r
li
c
0
0 0 b
o o o
90
W
H
c
20 SUBROTINA PARA RESOLUÇÃO DE MATRIZES TRIDIAGONAIS SUBROUTINE TRIDAG&lt;A,B,C,R.U,N&gt;
DOUBLE PRECISION A,B,C,R,U
PARAMETER&lt;NMAX=1OO&gt; DIMENSION GAM&lt;NMAX),A&lt;N),B(N&gt;,C&lt;N),R&lt;NI,U&lt;N) IF&lt;B&lt;1). EQ. O. (PAUSE
BET=B(i)
U4£&gt;=R&lt;1&gt;/BET
DO lOO J=2,N
G AM&amp;lt;J&gt;=C&lt;J-1)/B ET
BET=B(J)-A(J&gt;*GAM&lt;J)
IF(BET. EQ. O. (PAUSE
U(J)=(R(J)-A&lt;J)*U(J-i»/BET
iúü CONTINUE
DO 11O
UU)=U(J(-GAM(J+Í&gt;*U&lt;J+Í&gt;
11O CONTINUE
RETURN
END</field>
	</doc>
</add>