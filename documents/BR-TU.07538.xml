<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.07538</field>
		<field name="filename">12257_304790.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">PAULO RENATO DA COSTA MENDES
CONTROLE AVANCADO DE UM SISTEMA DE SEPARACAo TRIFASICA E TRATAMENTO DE AGUA
z
FLORIANOPOLIS 2012
UNIVERSIDADE FEDERAL DE SANTA CATARINA
PROGRAMA DE PÓS-GRADUACAo EM ENGENHARIA DE AUTOMACAO E SISTEMAS
CONTROLE AVANCADO DE UM SISTEMA DE separacAo trifAsica E TRATAMENTO DE Agua
Dissertação submetida à
Universidade Federal de Santa Catarina como parte dos requisitos para a obtenção do grau de Mestre em Engenharia de Automaçao e Sistemas.
PAULO RENATO DA COSTA MENDES
Florianópolis, Março de 2012.
Catalogação na fonte pela Biblioteca Universitária da
Universidade Federal de Santa Catarina
M538c Mendes, Paulo Renato da Costa
Controle avançado de um sistema de separação trifásica e tratamento de água [dissertação] / Paulo Renato da Costa Mendes ; orientador, Júlio Elias Normey-Rico. - Florianópolis, SC, 2012.
159 p.: il., grafs., tabs.
Dissertação (mestrado) - Universidade Federal de Santa Catarina, Centro Tecnológico. Programa de Pós-Graduação em Engenharia de Automação e Sistemas.
Inclui referências
1. Engenharia de sistemas. 2. Água - Purificação. 3. Controle preditivo. 4. Amortecimento - (Mecânica). I. Normey-Rico, J. E. (Júlio Elias). II. Universidade Federal de Santa Catarina. Programa de Pós-Graduação em Engenharia de Automação e Sistemas. III. Título.
CDU 621.3-231.2(021)
CONTROLE AVANÇADO DE UM SISTEMA DE SEPARAÇÃO TRIFASICA E TRATAMENTO DE Agua
Paulo Renato da Costa Mendes
‘Esta Dissertação foi julgada adequada para a obtenção do título de Mestre em Engenharia de Automaçao e Sistemas, Área de Concentração em Controle, Automação e Sistemas, e aprovada em sua forma final pelo Programa de Pós-Graduação em Engenharia de Automaçao e Sistemas da Universidade Federal de Santa Catarina.'
Julio Elias Normey-Riço, Dr. Orientador
Agustinho Plucenio, Dr. Coorientador
José Eduardo Ribeiro Cury, Ph.D.
Coordenador do Programa de Pés-Graduação em Engenharia de Automação e Sistemas
Banca Examinadora:
Julio Elias Normey-Riço, Dr. Presidente
Mario Cesar Mello Massa de Campos , Dr.
Daniel Juan Pagano, Dr.
Rodrigo Ivan Goytia Mejia, Dr.
O entusiasmo e a maior força da alma. Conserva-o e nunca te faltará poder para conseguires o que desejas. Napoleão Bonaparte v
AGRADECIMENTOS
Agradeço...
A minha família que sempre me incentivou e me deu forças em todos os momentos.
Ao meu orientador Julio Elias Normey-Rico pela orientação, apoio, amizade e por sempre ter ”‘alguns minutinhos”’ para ”‘trocar uma idéia”’.
Ao meu coorientador Agustinho Plucenio pelas dicas relevantes para a execucão deste trabalho.
Ao meu colega de pesquisa Rodrigo Leão Carvalho pelo companheirismo ao longo do desenvolvimento deste trabalho.
Aos meus Amigos-Colegas-Conhecidos, que estiveram presentes em todos os momentos.
Resumo da Dissertação apresentada à UFSC como parte dos requisitos necessarios para obtenção do grau de Mestre em Engenharia de Automação e Sistemas.
CONTROLE AVANÇADO DE UM SISTEMA DE SEPARAÇÃO TRIFASICA E TRATAMENTO DE Agua
Paulo Renato da Costa Mendes
Março/2012
Orientador: Julio Elias Normey-Rico, Dr.
Area de Concentração: Controle, Automação e Informática Industrial
Palavras-chave: Separação Trifásica, Tratamento de Agua, Controle Preditivo, Amortecimento de Perturbaçães Numero de Páginas: xxviii + 131
Nesse trabalho sãao abordadas táecnicas de controle pre-ditivo nãao-linear aplicadas ao controle de um sistema de se-paraçcaão e tratamento de áagua da induástria do petráoleo composto por um separador trifáasico e uma bateria de hidroci-clones. O separador trifáasico tem como funçcãoes promover a separação das três fases do fluido (água, oleo e gas) proveniente do reservatáorio de petráoleo e amortecer as perturbaçcãoes de carga atuando como tanque pulmão. Na saída de agua do separador se conecta uma bateria de hidrociclones que permitem extrair os resáduos de oáleo da áagua que áe recuperada no processo. Usualmente, os separadores industriais contam com trêes controladores SISO PI, cada um relativo a uma das fases do fluido. A utilização desse esquema de controle, apesar de ser bastante comum na induástria, tem como principal desvantagem o fato de naão amortecer as oscilacçãoes de carga. Um esquema utilizado pela Petrobras áe o controlador PI por bandas que apesar de utilizar táecnicas cláassicas de controle monovariáavel proporciona um bom amortecimento das osci-laçcãoes de carga. O processo estudado áe multivariáavel e tem uma dinêamica complexa, por isso sãao estudados neste trabalho dois tipos de modelos de prediçcãao naão-lineares, sendo eles o modelo Hammerstein e um modelo fenomenologico simplificado do separador. Dois sistemas de controle foram desenvolvidos. O primeiro, multivariáavel, se baseia no controlador preditivo pratico, conhecido como PNMPC, desenvolvido em [33] e inclui diversas funcionalidades para melhorar o desempenho do sistema separador-hidrociclones. O segundo consiste de um conjunto de controladores PI com sintonia via MPC, o qual á de grande simplicidade de implementacão.
Foram realizados ensaios de simulação onde os controladores foram testados no controle do sistema integrado funcionando em regime permanente e sob a presençca de perturbacçãoes .
Abstract of Dissertation presented to UFSC as a partial fulfillment of the requirements for the degree of Master in Automation and Systems Engineering.
ADVANCED CONTROL OF A THREE PHASE SEPARATION SYSTEM AND WATER TREATMENT
Paulo Renato da Costa Mendes
Março/2012
Advisor: Julio Elias Normey-Rico, Dr.
Area of Concentration: Control, Automation and Industrial Informatics
Keywords: Three-phase Separation, Water Treatment, Predictive Control, Disturbances Damping
Number of Pages: xxviii + 131
This work discusses techniques for nonlinear predictive control applied to the control of an oil industry separation system and water treatment which comprises a three-phase separator and a battery of hydrocyclones. The three phase separator function is to promote the three phases separation of the fluid from the oil reservoir (gas, oil and water) and act as a surge tank to attenuate load disturbances. A battery of hydrocyclones is connected to the separator water output to extract the residual oil in the water which is recovered in the process. Usually, industrial separators are controlled with three SISO PI controllers, each in one of fluid phases. This control scheme, though it is quite common in industry, has as main disadvantage that it does not damp load oscillations. A scheme used by Petrobras is the PI Band controller that uses monovariable classical techniques but provides a good damping of load oscillations. As the studied process is multiavariable and has quite complex dynamics, two types of non-linear prediction models are analyzed in this work, the Hammerstein model and a simplified phenomenological model of the separator. Using these models two control systems are developed and tuned. The first one is based on the algorith PNMPC (practical multivariable predictive controller) , developed in [33] and includes several features to improve the separator hydrocyclones system performance. The second one consists of a set of PI controllers tuned using a Zone MPC approach, which is simple to implement and use. Several simulations are presented to illustrate the use
of the proposed controllers using a complete phenomenological model of the integrated system considering the operation in steady state and in the presence of disturbances.
Sumário
1	Introdução	1
1.1	Processamento Primário de Petróleo..................... 1
1.2	Motivação.............................................. 3
1.3	Objetivos.............................................. 5
1.4	Estrutura da Dissertação............................... 6
2	Modelo dos Processos	7
2.1	Características de Alimentação do Separador Trifásico	....	7
2.2	Modelo Fenomenolágico do Separador Trifásico........... 9
2.2.1	Equações dos Balanços.............................. 11
2.2.2	Calculos Preliminares.............................. 15
2.3	Modelo Fenomenologico do Hidrociclone................. 19
2.3.1	Modelo do Escoamento .............................. 20
2.3.2	Modelo da Eficiência............................... 23
2.3.3	Modelo Hidrodinêmico............................... 25
2.4	Objetivos de Controle..................................... 26
2.4.1	Controle em Separadores ........................... 26
2.4.2	Controle em hidrociclones.......................... 27
2.4.3	Comentarios Finais................................. 28
3	Controle Preditivo	29
3.1	Introduçao ao MPC (Model Predictive Control).......... 29
3.1.1	Modelos de Prediçao................................ 31
3.1.2	Funçao Objetivo.................................... 32
3.1.3	Cálculo da Lei de Controle ........................ 33
3.2	PNMPC (MPC Prático Para Sistemas Não-Lineares)	....	33
3.2.1	Obtençao de F e Gpnmpc............................. 35
3.2.2	Obtençao da ação de controle....................... 37
3.2.3	Tratamento de erro de predição, ruído e perturbacão .	38
3.3	Controle NMPC com Restriçães.............................. 39
3.4	Controle NMPC por Zonas .................................. 43
3.4.1	Comentarios Finais ................................ 44
4	Identificação e Modelos para Predição	45
4.1	Modelo de Hammerstein....................................... 45
4.2	Identificação do Modelo de Hammerstein...................... 47
4.2.1	Estimador dos Mínimos Quadrados...................... 47
4.2.2	Procedimento de Identificaçao aplicado ao Separador
Trifásico............................................ 49
4.3	Modelo Fenomenolágico Simplificado.......................... 55
4.4	Estimador de Perturbaçães .................................. 56
4.5	Preditor de Perturbações.................................... 59
4.6	Detector de Perturbaçães.................................... 61
4.6.1	Comentarios Finais................................... 64
5	Resultados de Simulação	65
5.1	Controle do Separador Trifásico com a	presença de Golfadas .	65
5.1.1	Ensaio com PNMPC Hammerstein......................... 66
5.1.2	Ensaio com PNMPC Modelo Fenomenologico............... 69
5.1.3	Ensaio com Controlador por Bandas.................... 74
5.1.4	Análise de Desempenho dos Controladores.............. 75
5.2	Controle do Separador Trifásico com perturbaçães do tipo degrau 77
5.2.1	Ensaio com PNMPC Hammerstein......................... 78
5.2.2	Ensaio com PNMPC Modelo Fenomenolágico............... 81
5.2.3	Ensaio com Controlador por Bandas.................... 85
5.2.4	Análise de Desempenho dos Controladores.............. 86
5.3	Ensaio com Controlador PI por Bandas e PNMPC Modelo
Fenomenolágico por Zonas.................................... 88
5.4	Controle do Sistema Integrado (Separador + Hidrociclone) . .	92
5.4.1	Comentarios Finais................................... 99
6	Controlador PI com sintonia via MPC por Zonas	101
6.1	Fundamentação Teárica...................................... 101
6.2	Ensaio com PI com sintonia via MPC por Zonas............... 105
6.3	Comentarios Finais......................................... 107
7	Conclusao	109
7.1 Diretrizes para Trabalhos Futuros........................... 111
A	Parâmetros de Simulaçao	113
B Linearizaçao do	Modelo Simplificado do Separador	117
B.1	Linearizaçao do Balanco	de	Agua no Separador............. 118
B.2	Linearizacao do Balanco	de	(Oleo no Separador............ 119
B.3	Linearizacçãao do Balançco	de	Gáas no Separador ............ 120
B.4 Modelo Linearizado ......................................... 121
C	Controle PI por Bandas	123
Nomenclat ura
Separador Trifásico
Variável	Descrição	Unidade
B	base das placas paralelas	m
BSW	concentraçáo volumetrica de água na fase oleosa na alimentação	m /m
Cchic	comprimento da chicana	m
Cd	comprimento da câmara de áleo	m
Ccs	comprimento da câmara de separação	m
CONClfwcs	fracão volumetrica de áleo na fase aquosa da caâmara de separaçcãao	33 m /m
Cplaca	comprimento das placas paralelas	m
Cvmax, g	coeficiente de descarga máximo da vaálvula de gaás	Kmols/Kgf /cm2
Cvmax, l	coeficiente de descarga máaximo da	Kmols/Kgf
	vaálvula de áoleo	/cm2
Cvmax, w	coeficiente de descarga máaximo da	Kmols/Kgf
	vaálvula de áagua	/cm2
D	diâametro do separador trifáasico	m
dg	densidade especáfica do gáas	-
dl	densidade especáfica do áoleo	-
Dp	diâametro da gotácula	m
Dp50	diaâmetro correspondente a fracçãao volumáetrica de 50%	m
dw	densidade especáfica da áagua	-
EFLW	eficiâencia global de separaçcãao do oáleo da fase aquosa	-
EFWL	eficiâencia global de separacçãao do aágua da fase oleosa	-
g	aceleracçãao da gravidade	m/s2
Gin	vazao de entrada da fase gasosa	m3 /s
Gout	vazao de saída da fase gasosa	m3 /s
h	altura maxima, na entrada das placas paralelas,	m
que garante a separação das gotículas		
hchic	altura da chicana	m
hl	altura da fase oleosa na câmara de óleo	m
hplaca	distância entre as placas paralelas	m
ht	altura total de líquido na câmara de separação	m
hw	altura da fase aquosa na câmara de separação	m
K1	coeficiente de esfericidade das gotículas	-
Lin	vazão de entrada da fase oleosa	m3/s
Lout	vazão de saída da fase oleosa	m3/s
Lweir	vazãao na chicana	m3/s
MWg	peso molecular do gías	kgf/m3
p	pressãao no separador	kgf/cm2
par	parâmetro da distribuição sigmoidal	-
pcomp	pressão da unidade de compressao, apos a vólvula de gías	kgf/cm2
pjus	pressao a jusante das vólvulas de oleo e agua	kgf/cm2
Q	vazãao nas placas paralelas	m3/s
R	Constante universal dos gases	8, 31447 Jmol-1K -1
sg	Fração de abertura da vólvula de gós	-
sl	Fraçao de abertura da vólvula de óleo	-
sw	Fraçcãao de abertura da víalvula de íagua	-
T	temperatura da carga	K
TOG	concentraçcãao volumóetrica de oóleo na fase aquosa na alimentaçcaão	33 m /m
Vcl	volume da caâmara de óoleo	m3
Vcs	volume da câamara de separaçcãao	m3
V fwcs	volume da fase aquosa da caâmara de separaçcãao	m3
Vlfwcs	volume de oóleo na fase aquosa da câamara de separaçcãao	m3
vol	volume relativo ocupado pelas gotóculas	-
Vt	volume total do separador	m3
vter	velocidade terminal da gotócula	m/s
Vwflcl	volume de óagua na fase oleosa da câamara de óoleo	m3
Vwflcs	volume de aógua na fase oleosa da câamara de separaçcaão	m3
vx	velocidade da gotícula na direção x	m/s
Win	vazaão de entrada da fase aquosa	m3/s
W out	vazaão de saóda da fase aquosa	m3/s
Yi	peso especifico do oleo	kgf/m3
Yw	peso especifico da agua	kgf/m3
n	eficiencia de coleta individual da goticula	-
p	viscosidade da fase continua	kg/m/s
p	massa especifica da fase continua	kg/m3
pd	massa especifica da fase dispersa	kg/m3
pfw	massa especifica da fase aquosa	kg/m3
pfl	massa especifica da fase oleosa	kg/m3
pl	massa especifica do oleo	kg/m3
pw	massa especifica da agua	kg/m3
	esfericidade da goticula	-
Hidrociclone
Variavel a
d
Cvmax, o
Cvmax, u
Descrição
raio do orifício de saída do rejeito oleoso diâmetro das gotículas de óleo coeficiente de descarga maximo da vaivula superior
coeficiente de descarga míaximo da víalvula inferior
Unidade
m
m
Kmols/Kgf
/cm2
Kmols/Kgf
/cm2
dl	densidade específica do óleo
dw	densidade específica da ógua
efic	eficiância global de separacão do hidrociclone
f	fator de rejeito
fat	fração das gotículas de diâmetro ”‘d”’ separadas
ftr	fator de perda na alimentacão (ineficiâncias)
L	altura do trecho cânico modelado
P1
Po
Pu q
r
Rc
rela
so su
UD
V 0
W
Wo
Wu
pressão na alimentação do hidrociclone pressão na descarga da linha superior pressao na descarga da linha inferior vazao de alimentacao do hidrociclone Coordenada do sistema de coordenadas esfericas composto das coordenadas (r, 0, X) raio interno do hidrociclone na secao de alimentacao (topo do trecho conico modelado) relacao entre a area dos orificios de alimentacao e a area transversal nominal abertura da valvula superior (topo) abertura da valvula superior (fundo) velocidade de migracao da goticula velocidade do fluido no bocal de alimentacao componente da velocidade perpendicular ao tampo, dirigida para o hidrociclone vazao na linha superior do hidrociclone vazao na linha inferior do hidrociclone
m
kgf/cm2
kgf/cm2 kgf/cm2 m3/s
m
m
a	semi-angulo do trecho conico modelado
p	massa especifica do fluido (fase continua)
aiea2	parametros de ajuste do modelo da perda de carga
Coordenada do sistema de coordenadas esfericas composto das coordenadas (r, 0, X)
m/s m/s m/s m3/s m3/s
kg/m3
APo
ÁPu
diferença de pressao entre a corrente de alimentacao e a corrente de descarga superior do hidrociclone diferença de pressao entre a corrente de alimentacao e a corrente de descarga inferior do hidrociclone
kgf/cm2
kgf/cm2
Lista de Figuras
1.1	Distribuição dos fluidos Poço x Superfície. (Fonte: [8])	. . . .	2
1.2	Planta offshore para tratamento de água. (Fonte: [8])	....	4
2.1	Evolução de golfadas. (Fonte: [25]).............................. 8
2.2	Separador trifásico e seus dispositivos internos. (Fonte:	[26]) .	9
2.3	Esquema das variaveis envolvidas no separador trifásico. ...	11
2.4	Sistemas gerados no interior do separador devido à presença
da chicana. (Fonte: [8])	................................. 12
2.5	Esquema da trajetária da gotícula nas placas paralelas.......... 18
2.6	Esquema de um hidrociclone vertical para águas oleosas. (Fonte:
[47])........................................................... 20
2.7	Esquema da parte cônica do hidrociclone. (Fonte: [14]) ....	21
2.8	Esquema da hidrodinamica do hidrociclone. (Fonte: [8]) ...	25
2.9	Esquema do controle por DPR em hidrociclones. (Fonte: [8])	27
3.1	Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo. (Fonte: [29]).............................. 30
3.2	Diagrama de Blocos para o tratamento do erro de modelagem
e ruádo. (Fonte: [33]) ......................................... 38
4.1	Modelo de Hammerstein..................................... 46
4.2	Sinais PRBS .................................................... 49
4.3	Excitaçcãao em Malha Aberta	do sistema com	sinais	PRBS .	.	50
4.4	Ensaio	de Identificação e Validacao da água.................... 53
4.5	Ensaio	de Identificação e Validaçao do áleo ................... 54
4.6	Ensaio	de Identificaçcãao e Validaçcaão do gaás ............... 54
4.7	Vazães	de Alimentação Estimadas .............................. 58
4.8	Vazães	de Alimentação Preditas................................ 60
4.9	Janela movel de n pontos	de	dados cerca	do	tempo	kth	[15]	.	61
4.10	Vazãoes	de aágua e áoleo e variáavel de detecçcaão ............ 63
4.11	Vazãoes	de aágua e áoleo e variáavel de detecçcaão ............ 64
5.1	Variáveis de Processo..................................... 67
5.2	Vazoes e alimentacao e saída do separador.................... 67
5.3	Variáveis de Processo........................................ 68
5.4	Vazoes e alimentacao e saáda do separador.................... 69
5.5	Esquema de controle do PNMPC com controle local de vazão 70
5.6	Variáveis de Processo........................................ 71
5.7	Vazães e alimentacão e saáda do separador.................... 72
5.8	Variáveis de Processo........................................ 73
5.9	Vazães e alimentacão e saáda do separador.................... 73
5.10	Variáveis de Processo....................................... 74
5.11	Vazães e alimentacão e saáda do separador................... 75
5.12	Variáveis de Processo....................................... 79
5.13	Vazães e alimentacão e saáda do separador................... 79
5.14	Variáveis de Processo....................................... 80
5.15	Vazães e alimentacão e saáda do separador................... 81
5.16	Variáveis de Processo....................................... 82
5.17	Vazoes e alimentacao e saáda do separador................... 83
5.18	Variáveis	de Processo....................................... 84
5.19	Vazães e alimentacão e saáda do separador................... 84
5.20	Variáveis	de Processo....................................... 85
5.21	Vazães e	alimentacão	e	saáda do separador.................. 85
5.22	Esquema	do PNMPC	com	controle	supervisário.............. 89
5.23	Variáveis	de Processo....................................... 90
5.24	Vazães e alimentacao e saáda do separador................... 90
5.25	Variáveis	de Processo....................................... 93
5.26	Vazães e alimentacão e saáda do separador................... 93
5.27	Eficiências e concentração de áleo no underflow do hidrociclone 94
5.28	Distribuição das gotas na saáda do separador trifásico ....	95
5.29	Variáveis de Processo....................................... 96
5.30	Vazães e alimentacão e saáda do separador................... 96
5.31	Eficiências e concentraçao de áleo no underflow do hidrociclone 97
5.32	Variáveis de Processo....................................... 97
5.33	Vazães e alimentacão e saáda do separador................... 98
5.34	Eficiências e concentração de áleo no underflow do hidrociclone 98
6.1	Variáveis de Processo....................................... 106
6.2	Vazoes e alimentação e saáda do separador................... 106
Lista de Tabelas
4.1	Ordem do modelo de Hammerstein para o	nível da água ...	51
4.2	Ordem dos modelo de Hammerstein para	o nível de oleo ...	52
4.3	Ordem dos modelo de Hammerstein para	a pressao..... 52
4.4	Ordem do modelo de Hammerstein final.................... 53
4.5	Indices de Desempenho .................................. 58
4.6	Performance Indices..................................... 60
5.1	Parâmetros de Ajuste do Controlador .................... 66
5.2	Parâmetros de Ajuste do Controlador .................... 68
5.3	Parâmetros de Ajuste do Controlador .................... 70
5.4	Parâmetros de Ajuste do Controlador .................... 71
5.5	Parâmetros de Ajuste do Controlador .................... 72
5.6	Parâmetros de Ajuste do Controlador .................... 74
5.7	Indices de Desempenho .................................. 76
5.8	Parâmetros de Ajuste do Controlador .................... 78
5.9	Parâmetros de Ajuste do Controlador .................... 80
5.10	Parâmetros de Ajuste do Controlador ................... 82
5.11	Parâmetros de Ajuste do Controlador ................... 83
5.12	Indices de Desempenho ................................. 87
5.13	Indices de Desempenho - Golfadas....................... 91
5.14	Indices de Desempenho - Regime Permanente.............. 91
6.1	Parâmetros de Ajuste do Controlador ................... 105
6.2	Indices de Desempenho ................................. 107
Capítulo 1
Introdução
1.1	Processamento Primário de Petróleo
A exploração de petróleo é um processo muito complexo que exige avançados equipamentos e tecnicas para a extraçao dos fluidos das formaçães geolégicas. Um poço de petréleo é criado, basicamente, perfurando-se a rocha até atingir o reservatério e em seguida introduzindo-se dutos para transportar o fluido atée a superfécie. A construcçãao de um poco pode ocorrer em terra firme (onshore) ou sob lamina de agua (offshore).
No Brasil, grande parte da produçao de oleo e gés vem da explo-racao de poços localizados offshore. A exploracao nesses pocos exige a participaçcãao de plataformas, que saão unidades de exploraçcaão e prée-processamento de oéleo e gaés. A tecnologia de construçcãao de plataformas offshore é bastante complexa, envolvendo varias areas da engenharia. Geralmente, a produção de óleo se dé através da exploraçao de vérios poços ligados a uma unidade de processamento (plataforma).
Boa parte da complexidade dinamica do controle de processos offshore advéem de instabilidades no escoamento de éoleo e gaés provenientes dos pocos produtores de petréleo. A geometria do arranjo linha-riser muitas vezes possibilita o acumulo da fase líquida na parte inferior impedindo a passagem do gaés, o que acarreta no aparecimento das golfadas. Outro fator que pode intensificar as golfadas é a utilização de méetodos de elevaçcãao artificial do fluido, como por exemplo o uso de gas-lift. Gas-lift é uma entre as varias técnicas utilizadas para retirar hidrocarbonetos de forma artificial de pocços onde a pressãao do reserva-téorio ée insuficiente, ou economicamente inviéavel, para a exploraçcãao dos
recursos. O uso de um método de elevação artificial como o gas-lift se justifica pelo fato de que geralmente a pressão no fundo de poço tem potencial para extração de apenas 20 a 30% do total de óleo presente no reservatório, se não ó usado um metodo de elevacão artificial.
O escoamento com golfadas possui severas consequências para a operaçao da plataforma de produçao [45]: (i) dificuldade de separaçao da ógua e do oleo, comprometendo o desempenho de equipamentos ' jusante como tratadores de óleo e hidrociclones, e (ii) possível parada de emergêencia da plataforma por nóvel muito alto dos vasos separadores.
Quando os fluidos presentes nos reservatórios de petróleo são ex-traódos dos poçcos e levados atóe a superfócie, eles ascendem em diferentes padrães de escoamento e geralmente formam emulsães. As emulsães sãao geradas pelo cisalhamento de misturas óagua-óoleo ao longo do escoamento do reservatório ate a planta de processo nas plataformas [28]. A Figura 1.1 mostra a mudanca de comportamento e de fase dos fluidos que saem dos reservatóorios e sãao levados atóe a superfócie.
Figura 1.1: Distribuiçao dos fluidos Poço x Superfície. (Fonte: [8])
Segundo [8], na superfície, o óleo é a parte dos hidrocarbonetos que permanece no estado líquido. O gós produzido é composto por três partes, sendo que a primeira é proveniente dos hidrocarbonetos que, nas condições de temperatura e pressão do reservatório, jó se encontram no estado gasoso, chamado de gós livre. A segunda parte é oriunda dos hidrocarbonetos que se encontram dissolvidos no óoleo nas condiçcoães do reservatóorio e se vaporizam quando a mistura óe levada para as condiçcãoes de superfócie. A terceira, e uóltima parte, estóa relacionada com o góas que se encontra dissolvido na aógua nas condiçcãoes do reservatoório, que normalmente óe desprezóvel.
Na superfície, a primeira etapa de tratamento desse fluido proveniente dos pocos é chamada de tratamento primário e pode ocorrer em várias etapas. Em sistemas de producão offshore (produção marítima) o tratamento primário deve seguir as seguintes etapas:
•	separacão do áleo, do gás e da agua;
•	tratamento ou condicionamento do áleo para que possa ser transferido para as refinarias onde é realizado o processamento propriamente dito;
•	tratamento da agua para reinjeção no poço ou descarte no mar.
Geralmente, a primeira etapa do tratamento á composta por um sistema de separaçcãao trifáasico composto por um tanque com dimensãoes suficientes para absorver oscilações de carga. Um dos fatores críticos do sistema de separaçcãao trifáasico áe o tratamento da áagua para descarte. A legislação ambiental exige que a água deve ter no máximo 20 ppms de áleo. Para alcançar esse valor, geralmente o sistema de tratamento da aágua conta com hidrociclones conectados em sáerie ao separador tri-fáasico. Este equipamento efetua a separacçaão do áoleo disperso na áagua pela açcãao de um campo centráfugo gerado pelas suas caracterásticas construtivas. Nessa configuraçcaão, o separador precisa atingir uma eficiência tal que a água de saáda do tanque tenha ate 2000 ppms de áleo para que os hidrociclones e flotadores consigam diminuir esse valor para o exigido pela regulamentaçcãao.
Neste trabalho iremos considerar que o sistema de tratamento primáario do fluido tem como primeira etapa um sistema de separaçcãao trifáasico conectado a uma bateria de hidrociclones para tratamento da áagua. Para essa configuraçcãao, devemos dar especial atencçãao ao amortecimento das oscilaçcãoes na saáda de áagua do separador pois os hidro-ciclones são equipamentos sensáveis às pertubacães. Ao mesmo tempo, esse aspecto nãao áe tãao preocupante para a saáda de áoleo, jáa que em sáerie com esta existe um separador bifáasico que amortece as oscilaçcãoes e entrega uma vazaão constante ao tratador eletrostaático. Eá apresentado na figura 1.2 um esquema do processo estudado neste trabalho.
1.2	Motivaçao
-&gt;
Os reservatórios de petráleo contam com fluidos em tres diferentes fases: gás, oleo e água. Quando esse fluido chega a superfície ele ascende na forma de emulsãoes e deve ser tratado por um sistema de
Figura 1.2: Planta offshore para tratamento de água. (Fonte: [8])
tratamento primário que consiga separar com eficiência as três fases do fluido e também amortecer as oscilações de carga provenientes dos poços, também conhecidas como golfadas.
O tratamento primério das emulsões advindas dos poços em plantas offshore ocorre em varias etapas e tem a finalidade de deixar o éoleo que seréa transferido para as refinarias com baixo teor de impurezas e baixa concentraçõo de égua, e deixar a agua para reinjecao nos poçcos ou descarte no mar com concentraçcõao de éoleo dentro da faixa regulamentada pela legislacõo ambiental. Em um sistema convencional, o tratamento primério é composto de um conjunto de separadores gravitacionais conectados em séerie e a primeira etapa do processo de separaçcõao comecça em um separador triféasico.
Usualmente, o controle de separadores trifasicos na industria é realizado por tradicionais controladores SISO PI, cada um controlando uma das fases do fluido. Um exemplo de aplicaçcõao desta téecnica pode ser encontrado em [8]. Apesar dessa estrategia de controle ser a mais utilizada na industria, ela apresenta deficiências em relaçõo ao amortecimento de oscilacçõoes de carga e tambéem por nõao controlar a concen-tracçõao dos fluidos na saéda do separador.
Uma soluçcõao mais apropriada para o separador visando o amortecimento das oscilações causadas pelas golfadas e apresentado em [27]. Neste trabalho se implementa uma estratégia de controle por bandas ainda baseada em controladores PI. As duas soluçcõoes anteriormente mencionadas utilizam téecnicas de controle SISO, a pesar de que o separador é um sistema MIMO. Visando controlar o separador de forma
MIMO e ao mesmo tempo conseguir tratar as restrições nas diferentes variáveis envolvidas, alguns trabalhos da literatura tem proposto o uso de MPC ([26] e [40]).
As aplicações de controle citadas anteriormente são baseadas em mátodos lineares. E de amplo conhecimento que modelos lineares representam bem um processo em uma zona práxima a um ponto de equilíbrio. As perturbaçoes atuantes no processo provocam alterações no seu funcionamento, ocasionando oscilaçcoões que tendem a afastáa-lo do ponto de operação. Desta forma modelos não lineares podem representar de melhor forma o funcionamento do processo e permitindo um melhor desempenho dos controladores baseados nestes modelos. Algumas estratáegias de controle voltadas ao amortecimento de oscilacçãoes preveem o funcionamento do separador em uma faixa de operaçao ao inves de um ponto de equilíbrio fixo.
Eá abordado neste trabalho o uso de uma estratáegia de controle preditivo nao linear com base em modelo de Hammerstein e modelos fenomenolágicos simplificados. Para que haja um tratamento adequado às golfadas e seja levada em consideração a eficiência do processo, esse trabalho tem como objetivo modelar dinamicamente o sistema e projetar um sistema de controle avançcado que apresente melhores resultados que o sistema de controle tradicional no que diz respeito do atendimento das especificaçcoães de separaçcãao.
1.3	Objetivos
O objetivo deste trabalho á contribuir para o desenvolvimento de um sistema de controle que amorteça adequadamente oscilacões de carga provenientes da operaçao dos poços e linhas de alimentacão do separador, e ao mesmo tempo proporcione uma elevada eficiencia de separaçcaão nos hidrociclones. Para tanto propoãe-se a utilizaçcaão do controlador preditivo não linear desenvolvido em [33] . Sao utilizados como preditores modelos de Hammerstein e modelos fenomenoláogicos simplificados. Sãao apresentadas ferramentas que possibilitam a estimacçãao das perturbaçcãoes atuantes no processo e a utilizaçcaão dessas para realizar uma melhor predicçãao e consequentemente um melhor ajuste do controlador.
1.4	Estrutura da Dissertação
-&gt;
ARRUMAR ESTE PARAGRAFO INTRODUZINDO A PARTE DO PI VIA MPC
Na sequência à presente introdução, são apresentados no capítulo 2 os modelos fenomenológicos completos do separador trifásico e do hi-drociclone, bem como seus objetivos de controle. No capítulo 3, são apresentados os principais aspectos teíoricos das estratíegias de controle utilizadas neste trabalho. Em seguida, no capítulo 4, são abordadas tácnicas de identificaçao de sistemas nao lineares, a descricao dos modelos utilizados para a predição e as ferramentas desenvolvidas para estimacão e prediçao das perturbaçães. No capítulo 5, são apresentados e discutidos os resultados de simulaçcãao realizados primeiramente com o separador trifíasico e posteriormente com o acoplamento da bateria de hidrociclones. Finalmente, no capítulo 6, sao apresentadas as conclusãoes deste trabalho e sugestãoes para trabalhos futuros.
Capítulo 2
Modelo dos Processos
Na sequência serão apresentados os princípios de funcionamento e modelos fenomenológicos do separador trifásico e do hidrociclone. Outro assunto abordado neste capítulo e a característica da vazão dos fluidos na alimentação do separador trifásico e sua influência no processo de separação. Finalmente serão apresentados os objetivos de controle dos processos.
2.1	Características de Alimentação do Separador Trifásico
A mistura que chega ao separador á constituída de fases dispersa de áleo em agua e agua em áleo, alám do gás. De acordo com [40] as quantidades de oleo em água e de agua em áleo nas emulsães, e de gás no fluxo de entrada do separador são definidas devido às condicoes do(s) poço(s) de onde está ocorrendo a extração de petróleo e das condiçães de escoamento nos dutos, desde o(s) poco(s) até o separador.
A condicçaão do escoamento nos dutos áe responsáavel pela principal e mais preocupante perturbaçcaão na entrada do separador, o regime de golfadas severas (severe slugs) . Segundo [25], este regime á caracterizado por uma instabilidade de fluxo que pode ocorrer a certas vazãoes devido a um arranjo do conjunto linha-riser desfavoráavel, geralmente a baixas vazoães em linhas relativamente longas.
De acordo com [10], essas oscilações provocam efeitos indesejáveis no processo de produção, alterando os náveis de fluido nos separadores, o que afeta a etapa de separaçcãao e pode levar ao transbordamento.
A oscilação da pressão, causa da oscilação das vazões, promove a diminuição da vida útil e o aumento da frequência de manutenção dos equipamentos de processo, podendo inclusive reduzir a produção do poço.
E apresentado na figura 2.1 o comportamento cíclico da golfada no riser que ú dividido em quatro fases:
—	Geração da Golfada - A golfada inicia-se com baixa pressão e velocidade dos fluidos na seção de alimentação do encanamento, o liquido bloqueia o fluxo de gús no ponto-baixo do riser;
—	Produção da Golfada - Enquanto a quantidade de líquido no riser aumenta mais rapidamente que a variacçãao da pressaão entre o topo e a seçcãao de alimentaçcaão, a golfada continua crescendo;
—	Penetração da Bolha - Quando a pressao do gas na seçao de alimentaçcãao torna-se maior que o peso da coluna de lúquido no riser, ocorre a explosao, ou seja, a quantidade de líquido acumulada úe expelida para dentro do separador;
—	Produção de Gás - Apús uma grande quantidade de gas e líquido deixarem o sistema, a pressaão na secçãao de alimentacçãao diminui, reiniciando o ciclo.
Figura 2.1: Evolução de golfadas. (Fonte: [25])
2.2	Modelo Fenomenológico do Separador Trifásico
Os separadores trifásicos são equipamentos pressurizados e utilizados no processamento primário de petroleo, promovendo a separação adequada das fases misturadas (água, áleo e gás). Estes equipamentos tambem exercem a função de tanque pulmão absorvendo as flutuaçães da carga devido as características do escoamento multifasico advindo do reservatário (golfadas), e fornecendo para os equipamentos a jusante uma vazãao mais estáavel para naão comprometer sua operaçcãao.
Existem váarias concepçcoães de separadores com diferentes formas e tipos de dispositivos internos. Os separadores horizontais do tipo mostrado na Figura 2.2 sao os mais comuns e serão estudados nesse trabalho.
Figura 2.2: Separador trifásico e seus dispositivos internos. (Fonte: [26])
Devido a considerável diferença de densidade entre as fases líquidas e gasosa, a separação do gás acontece de forma relativamente simples, bastando apenas uma dispersao inicial do fluido pelo emprego de dispositivos apropriados, seguido de um tempo de separação adequado. A separação da agua do oleo apresenta-se um pouco mais complexa, embora ambos sejam imiscíveis, existe a formacão de emulsao o que dificulta bastante a separacão.
Na entrada do separador pode-se notar a presença de uma placa defletora a qual e responsavel pela fragmentação do fluido de alimentação do tanque, facilitando, assim, a saída do gás e tambám aumentando o grau de dispersão entre as fases. Apos se chocar com a placa defletora, oleo e água vao para a câmara de separação, onde ocorre parcialmente a separacao gravitacional entre os dois líquidos e o gás á expulso. De-
pendendo do tipo de áoleo pode ocorrer a formaçcãao de espuma, geradora da dispersaão de láquidos na fase gasosa.
Alám das placas defletoras, vários outros dispositivos internos, apresentados na figura 2.2, sãao utilizados para melhorar a eficiêencia da separaçao. Ligado à parte superior do tanque está o eliminador de náevoa, cuja funçcaão áe retirar da fase gasosa a dispersãao de láquido carregada pelo gás. Na saáda de gas vemos outro tipo de dispositivo interno utilizado com o mesmo objetivo. As placas paralelas, vistas na cêamara de separacçãao, ajudam na coalescêencia do áoleo presente na áagua e aumentam a eficiência de separação líquido-líquido [25].
Assim como qualquer outro processo, o processo de separacçãao tambem conta com alguns problemas de operacão. Segundo [47] os principais problemas encontrados sao:
—	Espuma - as impurezas presentes no láquido que chega no separador são as principais causadoras de espuma. Quando presente, ela dificulta o controle de nável do láquido dentro do separador, ocupa um volume que poderia estar disponável para a coleta de láquido ou para decantaçcãao, e pode ser arrastada pela corrente de gáas ou de áoleo desgaseificado. Portanto, quando for possável prever a formacçãao da espuma, o separador deve ser equipado com dispositivo interno para removêe-la, assegurando um tempo e uma superfácie coalescedora suficientes para quebráa-la.
—	Obstrução de parafinas - operaçães de separação podem ser afetadas por acuámulo de parafina. As placas coalescedoras na seçcãao láquida e os extratores de náevoa na secçãao gasosa sãao particularmente susceptáveis a estas obstruçoes. Quando a parafina á um problema real e potencial, extratores alternativos devem ser considerados e bocas de visitas e orifácios devem ser providenciados para permitir a entrada de vapor ou solvente de limpeza dos elementos internos do separador.
—	Areia - a areia que eventualmente chega com o láquido no separador causa erosãao nas vaálvulas, obstruçcaão nos elementos internos e acumula-se no fundo do separador, de onde áe removida por jatos de aágua e drenos. A melhor soluçcãao do problema áe evitar a producçaão de areia dos reservatáorios.
—	Emulsões - a emulsão que se forma na interface oleo/água pode ser particularmente problemáatica na operaçcãao de um separador. Aláem de causar problemas com o controle de nável, o acuámulo de emulsãao diminui o tempo de retencçãao efetivo, resultando em
uma redução na eficiência do processo. A adição de calor ou de produtos químicos minimiza o acUmulo de emulsão, porém estes procedimentos são preferencialmente aplicados na fase de tratamento do íoleo.
— Arraste - este é um problema típico operacional. O arraste de éleo pela corrente de gas ocorre quando o nível do líquido esté muito alto, quando existe algum dano em algum componente interno, formaçao de espuma, saída de líquido obstruída, projeto impréprio ou simplesmente porque o vaso estí operando com produção superior do projeto. O arraste de gas pelo líquido pode ser um indicativo de nível muito baixo de líquido ou falha no sistema de controle de nível.
2.2.1	Equações dos Balanços
E apresentado na figura 2.3 o esquema das variíveis envolvidas no processo e tambím uma ideia física do que elas representam. A cêmara situada entre a alimentação do tanque e a saída de ígua serí a partir daqui chamada de cêamara de separacçãao. A cêamara que comporta a saída de oleo serí chamada de camara de íleo e a barreira que separa as duas caêmaras seraí chamada de chicana.
Figura 2.3: Esquema das variáveis envolvidas no separador trifásico.
A modelagem do separador será realizada baseada em algumas simplificações e tem referência no trabalho [25] e [8]. Foram consideradas as seguintes hipóteses:
— O nível da camara de separacõo deve ser sempre maior que a altura da chicana;
—	O nível da fase oleosa na câmara de óleo deve ser menor que a altura da chicana;
—	Densidades das fases são consideradas iguais — nas condições operacionais a densidade da agua ó 965kg/cm3 e do oleo ó 855kg/cm3, apresentando uma diferenca desprezível para os calculos;
—	São desprezados os efeitos tórmicos;
—	O separador ó do tipo horizontal;
—	Os unicos dispositivos internos considerados sao as placas paralelas;
—	Não e considerada a influância dos agentes emulsificantes naturais do oleo;
—	Nao ha arraste líquido pela fase gasosa;
—	Naão hóa geracçãao de espuma;
—	Não sao consideradas as trocas de massa entre a fase líquida do óleo e a fase gasosa.
Devido a presençca da chicana a modelagem do separador óe realizada considerando que o equipamento funciona em dois sistemas distintos, conforme pode ser visto na 2.4. No primeiro sistema tem-se dois vasos, a câmara de separação e a camara de óleo, onde o primeiro verte liquido no segundo; isso ocorre quando hi &amp;lt;hchic. No segundo sistema temos um unico vaso, pois a chicana não mais influencia o escoamento; isso ocorre quando hl &gt; hchic . A mudanca de um sistema para o outro somente influenciaraó a variaçcaão temporal da altura total da câamara de separaçcãao e da altura da fase oleosa na câamara de óoleo.
Sistema 1				Sistema 2			
		|	Gout				I	Gout	
Gin	r			Gin kj			
Lin *				Lin ►			
Win	ht	I|\		Win	ht	1.	h	l
	u	hw|	|hotV[hj			„	hw|	—Ihchic	
		"i "í Wout Lout				•í "I Wout Lout	
Figura 2.4: Sistemas gerados no interior do separador devido à presença da chicana. (Fonte: [8])
O modelo fenomenológico do separador trifásico é composto pelo conjunto de equacões dos balanços de massa na câmara de separação, câmara de óleo e tambóm no espaco ocupado pelo gás, apresentadas a seguir.
Sistema 1:
—	Variação da altura total na câmara de separação
+ Lin Lweir Wout	(2 1)
~dt _	2 • Cc^h^(D — ht)	(	)
onde
Win - vazao de agua na alimentacão Lin - vazão de oleo na alimentacao Lweir - vazão na chicana
Wout - vazão na saída de agua
Ccs - comprimento da camara de separação D - diaâmetro do separador
—	Variaçcãao da altura da fase oleosa na caâmara de óoleo
dhl   Lweir Lout
~dt _ 2 • Cc^kT~(^—h)	( . )
onde
Lout - vazão na saída de óleo
Ccl - comprimento da caâmara de oóleo
Sistema 2:
—	Variaçao da altura total na câmara de separação
dht   Win + Lin Lout Wout	(2 3)
~dt _ 2 • (Ccs + Cci)Vht • (D — ht)	( . )
—	Variaçao da altura da fase oleosa na câmara de oleo
dhl	dht
- _	-	(2.4)
dt	dt
Equações comuns aos dois sistemas:
—	Variaçcãao da altura da fase aquosa na câamara de separaçcãao
dhw _ Win • (1 - TOG • EFLW) - Wout + Lin • BSW • EFWL
dt	2 • Ccs^hw • (D - hw)
(2.5) onde
BSW - concentração volumétrica de água na fase oleosa na alimentação
EFLW - eficiência global de separação do áleo da fase aquosa EFWL - eficiência global de separação da água da fase oleosa TOG - concentração volumetrica de oleo na fase aquosa na ali-mentaçcãao
— Variação do volume de água na fase oleosa da cêmara de separação
dVwflcs
dt
= Lin • BSW • (1 - EFWL) - Lweir • CONCwflcs
(2.6)
onde
CONCwflcs - fracão volumátrica de agua na fase oleosa da camara de separaçcãao
- Variacçaão do volume de áoleo na fase aquosa da caêmara de separaçcãao
dVlfwcs
dt
= Win • TOG • (1 - EFWL) - Wout • CONClfwCS
(2.7)
onde
CONCi fwcs - fraçao volumátrica de áleo na fase aquosa da cêmara de separaçcãao
- Variacão do volume de água na fase oleosa da camara de áleo
dVwflcl
dt
Lweir • CONCwflcs - Lout • CONCwflcl
(2.8)
onde
CONCwflcl - fração volumetrica de agua na fase oleosa da camara de áoleo
— Variação da pressão no vaso
dp __ (Gin +	W-in	+ Lin G out W'out	Lout)	' p	(2 9)
dt _	Vt — Vcl — Vcs	(	)
onde
Gin - vazão de gas na alimentação
Gout - vazão na saída de gas
Vcl - volume da camara de óleo
Vcs - volume da câmara de separaçao
Vt - volume total do separador
2.2.2	Cálculos Preliminares
A seguir serao apresentadas as equaçães estaticas utilizadas para o cólculo das vazães de saída e da chicana, volumes e concentraçães presentes nas equaçães dinâmicas apresentadas anteriormente.
— Vazão da Chicana
L
weir —
110, 2046
60
[Cchic - o, 2 (ht - h
chic
)] ' (ht	hchic)
1,5
(2.10)
onde
Cchic - comprimento da chicana hchic - altura da chicana
- Volumes nas câmaras de separação e de óleo
Ccs • D2
4
Cci • D2
arccos
sin
arccos
sin
arccos
arccos
(2.11)
(2.12)
0 - 2I)
- Volume da fase gasosa
Vg = Vt - Vcs - Vcl
(2.13)
— Volume da fase aquosa na câmara de separação
„	Ccs ■ D2
V fwcs  	.
4
hw
arccos 1 — 2—
hw
— sin arccos I 1 — 2 — I
■(*—2 'í)
(2.14)
— Concentraçães
CONf - (Vcf	&lt;*.*«
CONCfwcs - VfL	(2.16)
Vfwcs
CONCwfici -	(2.17)
Vcl
— Densidades das fases aquosa e oleosa
Pfw — Pw(1 — CONCifwcs) + pi • CONCifWcs	(2.18)
Pfi = Pi(1 — CONCwfics) + Pw • CONCwfics	(2.19)
onde
Pi - massa específica do oleo
Pw - massa específica do agua
— Vazoes de saída de água, óleo e gás
Wout -
Cvmaxw ■ sw \7dw (p — pjus) + Yw ■ hw + YI (ht — hw)
0,0693 ■ 60 ■ pfw
(2.20)
Lout
CVmaxl ■ Sly/di(p — pjus) + Yl ■ hl
0, 0693 ■ 60 ■ pfl
(2.21)
Gout =
Cvmaxg ' sg\/dg (p Paomp) ' (p + Paomp)
(2.22)
2,832-60-p-MWg
RT
onde
Cvmaxg - coeficiente de descarga máximo da válvula de gás Cvmaxl - coeficiente de descarga maximo da vaivula de oleo Cvmaxw - coeficiente de descarga maximo da válvula de água dg - densidade específica do gas di - densidade especáfica do áleo dw - densidade especáfica do áagua MWg - peso molecular do gás
Pcomp - pressao da unidade de compressao, apos a válvula de gás Pjus - pressao a jusante das valvulas de óleo e água
R - constante universal dos gases
T - temperatura da carga
Yl - peso especáfico do oleo
Yw - peso especáfico da agua
— Eficiência global de remoçao de oleo da fase aquosa, EFLW (ou de agua da fase oleosa, EFWL)
Para o calculo das eficiências de separação, parte-se da conside-raçao de que há transferência de oleo da fase aquosa para oleosa, mas que não ocorre a transferência de oleo da fase oleosa para aquosa. A mesma consideração á feita para água.
A eficiêencia áe calculada em funcçãao do processo de deposiçcãao de gotáculas na placa inferior (para gota de água), ou superior (para gota de oleo), quando a emulsão passa entre duas placas paralelas, separadas pela distência hplaca. Na entrada proxima às placas, as gotáculas estãao uniformemente dispersas no plano transversal ao escoamento, ou seja, todas as gotáculas têem a mesma probabilidade de se encontrar em qualquer ponto desse plano.
Parte-se da hipótese que se uma gotácula de diêmetro Dp, que chega a entrada das placas numa distência h da placa em que vai se depositar, se deposita no final destas (comprimento Cplaca), todas as gotáculas do mesmo diaêmetro que chegam numa distêancia menor se depositam na placa e as que chegam numa maior nãao se depositam, conforme esquematizado na figura 2.5.
De acordo com as formulaçães apresentadas em [25] e [8] a eficiência de separação para uma gotácula de diâmetro Dp é dada pela seguinte equaçcãao
Figura 2.5: Esquema da trajetória da gotícula nas placas paralelas.
(D-) =6n2 - 4n3
(2.23)
D*
p
onde Dp é o diâmetro de partícula cuja eficiência de separação é
50% (n = 0, 5), sendo calculado por
9 • Q • p.
D*
p
K1 • B • Cpiaca • g • (pd	P)
(2.24)
Pode-se observar que a eficiência é igual a 1 quando Dp = \/2 • D*, ou seja, são gotículas que chegam à entrada das placas justamente na altura hpiaca. Isto quer dizer que para valores superiores a este valor de Dp, a eficiência de remocão individual é igual a 1; gotículas iguais ou maiores que \/2 • D* sao separadas totalmente.
A eficiencia global de separaçao é dada pela relação entre o volume de gotículas que é coletado (vc) e o volume de gotículas que entrou no sistema (ve)
(2.25)
Vc ^global —
e
O volume de gotículas que entra (ve) é dado pela soma dos volumes associados a cada diametro de gotícula na distribuição de entrada. Foi utilizada a equação 2.26 para descrever a distribuiçao do diâmetro de gotas na entrada do separador trifasico, considerando que as gotículas da emulsao estão distribuídas de tal forma que o volume relativo ocupado por elas, ate o tamanho Dp, é descrito por uma curva sigmoidal.
(2.26)
ve (Dp)	/ „	\ par
O volume de gotículas coletado (vc) e dado pela soma dos volumes que entram para cada diâmetro de gotículas, multiplicados pelas
eficiências individuais de coleta.
vc (Dp) — ve (Dp) ' n (Dp)
(2.27)
A distribuição de tamanho das gotas de óleo na fase aquosa que sai do separador trifasico é calculada por
Vs (Dp) — Ve (Dp) • [1 - n (Dp)]
(2.28)
2.3 Modelo Fenomenológico do Hidrociclone
Segundo [40], originalmente os hidrociclones foram desenvolvidos para a separação de sólidos em líquidos e, após vários estudos modificações foram feitas para alcancar um equipamento semelhante para a separação eficiente de líquidos. De acordo com [8], o hidrociclone para águas oleosas á um dos processos de separação óleo/água mais utilizados pela industria do petróleo atualmente, dado que á importante utilizar equipamentos compactos capazes de atingir requisitos ambientais para descarte de seus efluentes.
Um hidrociclone consiste em um tubo composto de trechos cilán-dricos e cênicos justapostos, onde a entrada de um fluido, contendo uma fase dispersa de diferente densidade, á feita tangencialmente à se-çcaão transversal do tubo, formando um fluxo axial e possibilitando um movimento de rotaçcãao do fluido ao redor do eixo do equipamento, chamado de vártice. Neste tipo de equipamento, o campo centrífugo á da ordem de mil vezes maior que o campo gravitacional.
O princápio de operação deste tipo de equipamento consiste na entrada tangencial de áagua oleosa, sob pressãao, no trecho de maior diêametro do hidrociclone, sendo direcionada internamente, em fluxo espiral, em direcçãao ao trecho de menor diêametro. O contánuo decráes-cimo de diêametro faz com que este fluxo seja acelerado, gerando uma forçca centráfuga que forçca o componente mais pesado (áagua) contra as paredes. O fluxo axial reverso ocorre, na parte central do equipamento, devido ao formato cêonico do hidrociclone e ao diferencial de pressaão existente entre as paredes e o centro que se estabelece em consequêencia do campo centrífugo, associado à perda de intensidade do vártice ao longo do escoamento axial. A fase láquida central que deixa o hidro-ciclone pela parte superior (topo), contendo oáleo em maior proporçcãao, áe denominada rejeito. A saáda de aágua se localiza na parte inferior do equipamento (fundo), contendo uma certa quantidade de áleo residual. E ilustrado na figura 2.6 um exemplo esquemático do funcionamento
de um hidrociclone para águas oleosas.
Figura 2.6: Esquema de um hidrociclone vertical para águas oleosas. (Fonte: [47])
De acordo com [14], os principais fenômenos que caracterizam um hidrociclone são:
—	Campo centrífugo intenso (da ordem de mil vezes maior que o gravitacional), gerado pela entrada tangencial e a conicidade;
—	Segregação das fases na seção transversal, promovida pela aceleração centrífuga devido a diferenca das massas específicas entre as mesmas;
—	Fluxo axissimétrico longe da região de entrada;
—	Fluxo reverso, por mudança do gradiente de pressão radial num certo ponto, nas proximidades do eixo, responsíavel pela saída no overflow da corrente de menor massa específica;
—	Numero de Reynolds do escoamento muito elevado, anulando o efeito de viscosidade fora da camada limite;
—	Quebra das gotículas da fase dispersa;
—	Coalescência das gotículas da fase de menor massa específica.
2.3.1	Modelo do Escoamento
O modelo estatico para hidrociclones utilizado neste trabalho foi desenvolvido por [22] e amplamente difundido na literatura. Este modelo considera a parte cênica do hidrociclone, conforme a figura 2.7.
Apesar da figura 2.7 apenas mostrar uma entrada, por motivos de melhor visualizacçãao, hidrociclones para íagua oleosas apresentam dois
Figura 2.7: Esquema da parte cônica do hidrociclone. (Fonte: [14])
pontos de alimentação diametralmente opostos, com o intuito de manter uma razoável simetria na entrada do equipamento. Esta simetria se faz necessaria para garantir que não haja uma região de alta turbulência na entrada do hidrociclone, evitando assim a quebra das gotáculas de áleo a serem coletadas, que acarretariam numa diminuição da eficiência de separaçao das mesmas.
As equaçães de conservacão de massa e da quantidade de movimento em coordenadas esfericas (r, 6, A) levam, apás algumas considera-cães simplificadoras, a uma equação diferencial em funcão da corrente,
. sin(6) d / 1 \ d± = Vo2	(	)
dr2 r2 d6 sin(6) d6 W
As linhas de corrente sao as trajetórias do fluido ao longo do hidrociclone. O equacionamento acima, apás algumas considerações, resulta numa equacao para a velocidade tangencial qA,
pw qr d	d
RdR ( ■ qx) = dR
1 d
R dR
(R•qx)}
(2.30)
Fazendo X = X(R) = RdR (R • qx), transforma-se essa equação diferencial de segunda ordem em duas de primeira ordem. Sao elas:
onde
dX __ X pw qr
dR	/&lt;„■
dqx _ X _qx
dR	R
R
qr (R, z) _ qr (R, z)-+ qg(R, z) cos
z
qz(R,z) _ qr(R,z)cos
R qg (R,z) —
(2.31)
(2.32)
(2.33)
(2.34)
qr (R,z) _ 2Acos (+2B cos (In (g) + 2B -	(2.35)
qg(R,z) _ -2
RR
A + B ln
zz
(2.36)
Para a determinaçao do movimento radial das gotículas adota-se a equação de Stokes

vter
1
Ww
(pw	pl)
(2.37)
R
As componentes axial e radial da velocidade das gotículas são dadas por
dz Vz _ dt	(2.38)
dR VR _ n	(2.39)
Assim, pode-se estabelecer uma equação diferencial para a trajetória das gotículas dentro do hidrociclone:
dz _	qz
dR qr A vter
(2.40)
2.3.2	Modelo da Eficiência
Primeiramente serí apresentado o modelo desenvolvido por [22]. Este modelo não leva em consideracao o fenômeno da quebra de gotas. Adota-se a hipítese que na seção de topo do trecho cênico modelado a entrada da dispersão se faz na coroa circular R1 &amp;lt;R &amp;lt;Rc.
Analisando-se a trajetória da gotícula de íleo, tem-se que, se Rcrit &gt; Rc entao todas as gotículas de diametro Dp serão separadas no hidrociclone. Agora se Rcrit &amp;lt;Rc deve-se analisar dois casos:
— Se Rcrit &amp;lt;Ri, para essas gotículas de diêmetro Dp, a eficiência de separacão í nula, pois, por hipítese, não hí fluxo na seçao de topo para R &amp;lt;R1. Assim, todas as gotículas com esse diametro serão perdidas pelo underflow.
— Se Rcrit &gt; Rí, nesse caso, para essas gotículas de diâmetro Dp, somente aquelas que, saírem da seção de topo na regiao definida por Rí &amp;lt;R &amp;lt;Rc serão separadas, e as que ficarem em Rcrit &amp;lt;R &amp;lt;Rc serao perdidas no underflow.
Considera-se por hipótese que as gotáculas de diametro Dp estejam uniformemente distribuádas no trecho Rí &amp;lt;R &amp;lt;Rc, ou seja, em toda a área Aí da secão do topo do hidrociclone, onde:
Aí = n (R - Rj)	(2.41)
A area da seçao ocupada pelas gotículas de diâmetro Dp que serao separadas áe:
A2 = n (RCrit - Rl)
(2.42)
A fraçao de gotículas de diêmetro Dp que é separada é definida por
Fat = Ar
Ai
(Rcrit - R2í)
(R2 - R2)
(2.43)
A eficiência de separaçao do hidrociclone í calculada somando-se os volumes coletados de cada tamanho de gotícula e dividindo-se pelo volume total de óleo que entra.
efic _
ELiFat •Fv(i) j=i Fv(i)
onde
(2.44)
í0
(RCrit-R2)
|	(R2-R?) ’
se Rcrit &amp;lt;R1
se R1 &amp;lt;Rcrit &amp;lt;Rc
se Rcrit &gt; Rc
O aumento de F (razão de split, porcentagem da vazao total Q que sai pelo orifício de rejeito oleoso) deve ser considerado como um fator redutor da eficiêencia, visto que, se por uma lado, ao aumentar-se F tem-se uma corrente de agua tratada com menor concentração de oleo, tem-se tambem, por outro lado, uma menor vazaão de agua tratada (= (1 — F)Q) e uma maior vazão de rejeito (= FQ). A eficiência absoluta da separaçcãao, para a mesma vazãao e calculada por
eficabs = efic (1 — F)	(2.45)
Dessa forma quando F tender a 1, o que significa que quase toda a vazão esta saindo pelo overflow, embora a eficiência global seja de 100%, a eficiência absoluta tenderia a zero.
No modelo fenomenologico, quanto maior a vazãao maior a eficiência de separacão. Contudo, dados experimentais revelam que ha um ponto otimo a partir do qual a eficiêencia cai com o aumento da vazaão.
Foi desenvolvido por [14] um modelo que leva em consideração o fenêomeno de quebra de gotas, definido pela seguinte equaçcãao
Fvnovo(i) _ Fv(i) (1 — mWe'mod(i))	(2.46)
onde Wemod(i) e o numero de Weber modificado e calculado por
Wemod(i
Pcd(i)
2y
(-Q- \
nRc2
(2.47)
O modelo da quebra de gotas deve ser acoplado ao modelo de calculo das eficiêencias de separacçãao no ponto imediatamente anterior ao calculo da trajetória da gotícula. Dessa forma, as gotas sao redistribuídas com as possíveis frações volumetricas apos a quebra. Apos a obtençcãao da trajetoria, calcula-se a eficiêencia de separaçcãao levando em conta o fenêomeno da quebra de gotas.
2.3.3	Modelo Hidrodinâmico
A modelagem desenvolvida por [22] permite admitir a não dependência da eficiência em relaçao a pressão interna no equipamento. No entanto, o conhecimento da perda de carga das linhas de topo e de fundo do hidrociclone e de fundamental importência na determinação do sistema de controle de vazao do equipamento. E apresentado na figura 2.8 um esquema hidrodinêmico do hidrociclone com as variáveis envolvidas.
Pi q
Su
Figura 2.8: Esquema da hidrodinâmica do hidrociclone. (Fonte: [8])
Neste trabalho foi utilizado o modelo desenvolvido por [8] que descreve a perda de carga em hidrociclones. O modelo e constituído pelas equaçcãoes a seguir
APO = ai • Wo	(2.48)
APu = Q2 • Wu
(2.49)
As vazãoes de topo e de fundo saão calculadas atraváes das equaçcãoes das váalvulas
Cvmaxo ' So\Jdl (P1	APo Po)
0,0693 • 60 • pfl
Wu =
Cv
maxu
Su	dw (Pi - APu - Pu)
0,0693 • 60 • pfw
(2.51)
Substituindo as equações 2.48 e 2.49 nas equações 2.50, 2.51, obtêem-se equaçcãoes de segundo grau, que podem ser facilmente resol
vidas para determinação das vazões de topo (Wo) e fundo (Wu).
Com as vazães de saída do hidrociclone determinadas, pode-se calcular a concentracão de oleo na saída de agua do hidrociclone (CONCi,u), através da seguinte equação:
CONCi u = q ' CONClfwcs • (1 ~ efic)	(2.52)
’	q - Wo
2.4	Objetivos de Controle
2.4.1	Controle em Separadores
O separador trifasico apresenta três malhas de controle, pressão do vaso, nível da fase oleosa e nível da fase aquosa. As variéveis manipuladas são as aberturas das vélvulas de saída de égua, oleo e de gés e as variaveis controladas são os níveis e a pressao. As perturbaçoes atuantes no separador sãao oriundas da evoluçcãao do escoamento dos re-servatorios que alimentam o sistema de produção. Dentre os regimes de escoamento, o mais prejudicial para o funcionamento do sistema de separaçcaão, íe o regime de golfadas severas.
Usualmente, os controladores dos vasos de separaçao contam com tres controladores SISO PI (proporcional e integral), cada um relativo a uma das fases do fluido. Um deles utiliza o valor de leitura da pressão dentro do separador e controla a abertura da vílvula de gís; o segundo controlador mede o nível de íoleo da cêamara de íoleo e controla a abertura da vílvula de saída e o ultimo controlador utiliza a leitura do nível de íagua da cêamara de separacçãao e comanda a abertura da víalvula de saída de íagua.
Esse esquema de controle í bastante comum na industria mas tem como principal desvantagem o fato de nãao amortecer as oscilacçãoes de carga e nãao possuir controle sobre as concentraçcãoes dos fluidos nas víal-vulas de saída. Ao utilizar um controle que mantím os níveis das fases líquidas fixos em um determinado ponto, o sistema perde a capacidade de responder às oscilações nas vazões de entrada, oferecendo baixa rejeição às pertubaçães e tambem não controla a eficiência da separacão de cada fase.
Para esses problemas, algumas soluçcoães alternativas podem ser adotadas, entre elas, adotar a variaível controlada como sendo a con-centraçcãao de íoleo disperso na íagua e a concentraçcãao de íagua dispersa no íoleo ou mesmo fazer um controle por bandas permitindo certa os-cilaçao dos níveis dos fluidos. Neste contexto o melhor algoritmo de controle íe aquele que consegue fazer com que o separador absorva as
perturbações e obtenha uma elevada eficiência de separação.
2.4.2	Controle em hidrociclones
A principal funcão do hidrociclone e separar o õleo presente na corrente aquosa de forma a ajustar os níveis de pureza (da agua a ser descartada) exigidos pelas normas. Este equipamento necessita de uma queda de pressão para promover a separaçao das gotas de oleo da corrente aquosa. Os hidrociclones nao apresentam dinamica significativa, portanto sua modelagem e realizada considerando a operaçao em estado quase estacionario. Segundo [8], o controle normalmente utilizado baseia-se na manutencão da razao de perdas de carga (DPR)
P - po
DPR = -------=-	(2.53)
P - Pu	v
Para o hidrociclone, a relaçao entre as quedas de pressão da corrente de topo e de fundo, deve ser mantida constante, garantindo assim, uma melhor eficiência de separaçao. A corrente a ser controlada e a de saída de rejeito (WO) e a corrente secundaria e a de saída da fase aquosa (WU). Esta estrategia de controle consiste em medir a queda de pressaão da corrente secundaria e multiplica-la pela razaão desejada, para obter a queda de pressao requerida na corrente de saída de rejeito, ou seja, AP^P = R • AP^. A saída do multiplicador e o valor desejado para o controlador de AP da corrente de rejeito. Como o APu varia, o valor desejado do controlador tambem varia, para manter a razãao R constante. E apresentado na figura 2.9 um esquema da estrategia de controle utilizando DPR.
Figura 2.9: Esquema do controle por DPR em hidrociclones. (Fonte: [8])
2.4.3	Comentarios Finais
Neste capítulo foram apresentados os princípios de funcionamentos, modelos fenomenológicos e objetivos de controle do separador trifásico e do hidrociclone. Estes modelos serão utilizados para a simulação dos processos nas simulacães apresentadas no capítulo 5. Com base nestes modelos, no capítulo 4 serão apresentados modelos simplificados que serão utilizados em conjunto com controladores preditivos. No próximo capítulo será realizada uma revisão bibliográfica sobre MPC e tíecnicas utilizadas para amortecimento de perturbacçãoes.
Capítulo 3
Controle Preditivo
No capátulo 2 foram discutidos os princápios de funcionamentos e objetivos de controle do separador trifáasico e do hidrociclone. A seguir serãao apresentadas táecnicas de controle preditivo que serãao aplicadas a estes processos. Primeiramente seráa realizada uma revisaão bibliográafica sobre MPC e na sequencia apresentado a fundamentacão teorica do controlador PNMPC. Posteriormente serão apresentadas tecnicas de controle NMPC com restricçãoes e por zonas que saão uteis em processos sujeitos a açcaão de perturbaçcoães.
3.1 Introdução ao MPC (Model Predictive Control)
A aplicaçcãao de MPC surgiu nas uáltimas duas dáecadas como uma poderosa e praática táecnica de controle. Essa áe uma das poucas táecnicas avancçadas de controle que tem alcançcado impacto significante em sistemas de controle industriais. A principal razãao desse sucesso áe, talvez, a capacidade do MPC em lidar com as seguintes situações: possibilidade de aplicação em sistemas SISO (uma entrada para uma saáda) e MIMO (múltiplas entradas para multiplas saádas), a realimentação do sistema e o controle feedforward podem ser incluádos de forma direta na formulação do MPC, restriçães de entrada e saádas podem ser incluádas na formulação da lei de controle através da otimizaçao online e também ha a compensacão intránseca de atrasos de transporte [24].
Para dar uma visaão histoárica da ideia de utilizar a predicçãao em sistemas de controle, os práoprios controladores PID jáa apresentam, de
certa forma, essa propriedade. A ação derivativa do clássico controle PID utiliza uma forma de prediçao atravás da ação derivativa expressa pelo termo • O preditor de Smith [42] utiliza uma forma de predi-çcãao para a compensacçãao do tempo morto. A idáeia áe simples e intuitiva. Conhecendo o comportamento do sistema (modelo entrada-saída) á possível determinar a sequência de açães de controle a serem tomadas no futuro de forma a seguir uma trajetória desejada com o mínimo esforço [33].
O MPC não á uma estratágia de controle específica, mas á o nome dado a um conjunto muito grande de máetodos de controle que foram desenvolvidos considerando algumas ideias comuns baseadas no conceito de predição. Na Figura 3.1 mostra-se a estrutura geral de um MPC onde pode ser observado o funcionamento do algoritmo. A partir dos valores passados do controle e saáda do processo as predicçãoes futuras sãao calculadas por um modelo. O modelo de predicçãao áe o elemento mais importante dentro do controlador, dado que ele deve ser capaz de representar adequadamente a dinêamica do processo. A prediçcaão da saáda do processo pode ser separada em duas partes: a resposta livre que corresponde a predicao da saáda quando a entrada á igualada aos valores passados da entrada, e a outra, a resposta forçcada que corresponde as predicoes quando o controle á igual zero. Com os valores das prediçcoães futuras, referêencias futuras, restriçcãoes do processo e uma funçcãao objetivo, um máodulo de otimizacçãao calcula o sinal de controle a ser aplicado ao processo no práoximo passo. A finalidade da funçcãao objetivo áe minimizar o erro entre a previsãao da saáda e a referêencia desejada penalizando o esforçco de controle [2].
Figura 3.1: Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo. (Fonte: [29])
Todos os algoritmos de Controle Preditivo possuem alguns elementos em comum, são eles: o modelo de predição, a função objetivo
e um método para a obtenção da lei de controle. Os diferentes controladores encontrados na literatura se diferenciam na forma em que esses elementos são encontrados. A seguir serão apresentados de forma resumida os conceitos desses elementos que podem ser encontrados de forma mais detalhada em [2].
3.1.1	Modelos de Predição
O modelo de predição e composto pelo modelo do processo e pelo modelo das pertubaçães e e o elemento mais importante em um algoritmo de controle preditivo. Como o MPC baseia todo seu calculo da lei de controle no modelo de predição, todas as vantagens do uso de controle preditivo podem ser perdidas caso o modelo que esta sendo usado não seja fiel à dinâmica do processo.
Os modelos lineares são os mais utilizados na pratica para representar o processo e podem ser de entrada saída (resposta impulsiva, resposta ao degrau e funcão de transferância) ou de variaveis de estado. Os modelos de resposta impulsiva ou ao degrau sãao bastante utilizados na pratica por oferecerem as seguintes vantagens: (a) são intuitivos e podem ser usados em plantas multivariaveis sem acrescentar complexidade; (b) quando identificados nao precisam de conhecimento a-priori do processo e (c) descrevem de maneira simples efeitos mais complexos da dinâamica do processo como atrasos e comportamentos de fase naão mínima. Por outro lado apresentam alguns inconvenientes: (a) não podem ser usados com plantas instaveis e (b) necessitam utilizar um grande numero de parâametros para descrever o modelo, sobre tudo se o processo tiver um atraso grande [33].
Os modelos representados por funcçãoes de transferâencia tem a vantagem de poderem ser usados em plantas instaveis e tambem de precisar de poucos parâametros para descrever a dinaâmica do processo. A desvantagem desse modelo e que quando o modelo for identificado a partir de ensaios experimentais e necessario conhecer a ordem dos polinâomios do numerador e denominador a priori.
Os modelos de espacço de estado podem ser usados tanto para processos nao-lineares quanto para processos multivariaveis. Sua desvantagem e a dificuldade na visualizaçao do sistema, uma vez que geralmente muitos estados não possuem significado físico.
Os modelos nãao lineares sãao geralmente usados para descrever a dinâamica do processo quando os modelos lineares naão geram bons resultados. Modelos fenomenologicos [9], empíricos [23], redes neurais [44] ou logica nebulosa [41] podem ser usados em algumas aplicações
para determinar o modelo de predicao. O inconveniente no uso destes modelos é a maior complexidade tanto no procedimento de obtenção do modelo do processo quanto no célculo da lei de controle [33].
Para representar perturbacães determinísticas e estocésticas o modelo mais usado ée conhecido como modelo autorregressivo integrado de média mével (Auto-Regressive and Integrated Moving Average, ARIMA). Este modelo permite representar mudanças aleatorias, off-sets (desvios) e outros fenômenos normalmente encontrados no meio industrial.
3.1.2	Função Objetivo
Entre os diversos algoritmos MPC existem diferentes formas de calcular a lei de controle, cada uma considerando uma forma de descrever as funçães de custo, sendo que o objetivo mais utilizado é minimizar o erro entre a saída futura y e a referência desejada w penalizando o esforço de controle Au.
A expressãao geral para a funçcãao objetivo ée mostrada na equaçcãao 3.1.
N2	Nu
J(NbN2,Nu) = £ S(j)[y(t + j|t) -u(t+j)]2 +2X(t)[Au(t + j - 1)]2 Ni	j=1
(3.1) Em que N1 e N2 são os horizontes de prediçao mínimo e maximo enquanto Nu é o horizonte de controle. Esses índices definem os instantes em que deseja-se que a referêencia siga a saéda e onde ée importante limitar a açcaão de controle. Esses horizontes podem ser usados para compensar atrasos de transporte e fase não-ménima. Nos casos com atraso de transporte d, deve-se escolher N1 &gt; d pois nao havera resposta do sistema a um sinal de entrada u(t) antes de t = d. Em casos onde o processo não possui atraso de transporte utiliza-se N1 = 1 e N2 = N, onde N passa a ser o horizonte de prediçcaão. A variacçaão de Nu permite penalizar por mais ou menos tempo a acçãao de controle. Os coeficientes ô(t) e A(t) são as sequencias de ponderaçao do erro e do esforçco de controle e geralmente sãao escolhidas constantes ou exponenciais, dependendo se queremos considerar mais instantes iniciais ou finais da resposta.
Em alguns sistemas ée possével conhecer valores futuros da refe-rêencia, para esses sistemas o MPC pode utilizar esses dados para fazer o calculo da lei de controle e permitir que o sistema atinja mais rapidamente o novo valor desejado. Os valores de w(t + j) utilizados na
função objetivo não são necessariamente coincidentes com a referência real do sistema. Normalmente, nas aplicaçães práticas, são utilizadas estratégias para suavizar as mudancas de referência, de forma similar aos filtros utilizados nas estruturas clássicas de controle com dois graus de liberdade.
E possível ainda estabelecer restriçães para o algoritmo de mi-nimização. Como todo sistema real possui restriçães das variáveis a controlar (níveis máximos, pressão limite, etc.) e das variáveis de controle (saturacão de válvulas, potência de motores, limites de curso, etc.) esta característica se mostra uma das mais interessantes da aplicação do MPC.
3.1.3	Cálculo da Lei de Controle
Para o cálculo de Au(t + k|t) alguns passos devem ser seguidos:
1.	Cálculo do valor de y(t + k) como função dos controles futuros;
2.	Substituicão dos valores de y e w na funcão J;
3.	Minimizaçao da função J considerando-se os pesos e as restricões, se existirem.
O resultado é uma sequência de açães de controle que devem ser aplicadas ao sistema para se alcancar os objetivos definidos. E importante ressaltar o conceito de janela deslizante. A janela de controle á deslizante, ou seja, apesar da minimizaçcãao da funçcãao objetivo resultar em um vetor de controles que devem ser aplicados no tempo, na amostra seguinte ao cáalculo apenas a primeira acçãao de controle seráa aplicada e todas as açcãoes de controle serãao recalculadas de acordo com as novas informaçcãoes obtidas do sistema real.
3.2	PNMPC (MPC Pratico Para Sistemas Não-Lineares)
O controle PNMPC desenvolvido em [33], á baseado em algoritmos de controle preditivo que utilizam a representaçcãao do vetor de predicoes ao longo do horizonte p, Y, como uma função do vetor com m mudanças na açao de controle Au, conforme a equaçao 3.2.
No DMC as saídas da planta sao calculadas baseadas na resposta ao degrau unitário de cada entrada. Para um sistema de uma entrada e uma saída estavel e linear a saída pode ser descrita como na equação
3.3.
y(k) =	giAu(k - 1) + n(k),	(3.3)
i=1
onde gi são os elementos do vetor resposta ao degrau unitario na entrada e n são erros de modelagem ou perturbacães futuras.
A predição da saída no instante t no DMC pode ser descrita como nas equações 3.4 e 3.5, considerando que os erros de predições n(k + j\k) sãao todas iguais ao instante k, ou n(k).
y(k + j\k) =	gi^u(k + j - i) + f (k + j),	(3.4)
i=1
onde f (k + j) pode ser descrito como a equação 3.5, truncando o somatório em N amostras ja que 3 N tal que gN+1 « gN.
N
f (k + j) = ym(k) + ^2(gj+i - gi)Au(k - 1),	(3.5)
i=1
onde ym(k) e o valor da saída real no instante k.
O primeiro termo da equação 3.4 e conhecido como resposta forçada porque representa a mudança do processo devido às mudancas nas açcoães de controle futuras enquanto o segundo termo e conhecido como resposta livre, pois representa a saída do processo devido as entradas que ocorreram ate o período de amostragem passado.
Escrevendo-se a equaçao 3.4 expandida, considerando-se o horizonte de controle Nu e o horizonte de predicao p tem-se a expressao 3.6, que pode ser reescrita como em 3.2:
y(k + 1\k)	=	g1Au(k)	+ f (k + 1)
y(k + 2\k)	=	gzAu(k)	+ g1Au(k + 1)	+	f (k + 2)
y(k + 3\k)	=	g3Au(k)	+ g3Au(k + 1)	+	g1Au(k +	2) + f (k	+ 3)
y(k + N\k) = gNAu(k) + gN-1Au(k + 1) + ... + g*-N + 1Au(k + Nu - 1) + f (k + m)	(3.6)
A tácnica PNMPC desenvolvida em [33], segue a mesma logica do DMC, mas por ser uma tácnica não-linear ela deve atender algumas peculiaridades. Em modelos lineares á possivel calcular Y de forma simples, utilizando o princípio da superposiçao, o que não não acontece para modelos naão lineares em que áe necessáario a obtençcaão de uma aproximacao para Y.
A tácnica proposta por [33] se difere das demais tácnicas NMPC principalmente pelo fato de utilizar modelos linearizados independentes dos pontos de equilíbrio do sistema. E proposto uma forma de descrever a evolução das saádas do sistema ao longo do horizonte de predição utilizando uma representação linear das saádas em relação aos incrementos de controle futuros. Para isto nãao se utiliza o conceito de
ponto de equilíbrio, assumindo-se que as predições Yp dependem apenas
——	——
das entradas passadas u, das saádas passadas y e dos incrementos de
entradas futuros Au,
—— Yp = f (y, u, Au)	(3.7)
O Vetor com as prediçães á reescrito como	
Yp = F + Gpnmpc Au	(3.8)
onde	
f = f (y,—)	(3.9)
G	dYp GPNMPC = d Au	(3.10)
A matriz GpNMPC é o Jacobiano de Yp. Esta representação pode ser utilizada tanto para sistemas representados por modelos lineares como para aqueles representados por modelos não lineares desde que as saédas sejam conténuos e diferenciaveis em relação às entradas.
3.2.1	Obtenção de F e Gpnmpc
No controlador PNMPC o vetor de resposta livre F e a matriz G são obtidos de forma numerica. Para isso executa-se um algoritmo que calcule o vetor com as p predições Yp quando se fornece os valores das entradas e saádas passadas e o vetor com os m incrementos de entrada futura Au. Se denominarmos o conjunto de entradas passadas de upassado e as entradas atuais e passadas de ypassado então as prediçães podem ser reescritas como na expressãao 3.11.
y(k + 1)	— f (y passado,upassado, Au(k))
y(k + 2)	— f (ypassado,upassado, Au(k), Au(k A 1))
y(k + N)	f (y passado, upassado, Au(k), Au(k A 1), . . . ,
Au(k + Nu - 1))	(3.11)
Para um sistema SISO, por exemplo, a cada iteracão executa-se o seguinte procedimento:
1. Obtám-se o vetor (dimensão N x 1) executando o modelo com as entradas e saádas passadas e com Au =[0 0 ... 0]T. F = Y®.
2.
Calcula-se a primeira coluna da matriz Gpnmpc • Obtám-se o vetor Yp (dimensao N x 1) executando o modelo com as entradas
e saádas passadas e com Au = [e 0 ... 0]T, onde e á um valor muito pequeno, , por exemplo. Gpnmpc(:, 1) = p e p .
3. Calcula-se a segunda coluna da matriz Gpnmpc. Obtem-se o vetor Yp (dimensao N x 1) executando o modelo com as entradas e saádas passadas e com Au = [0 e ... 0]T. Gpnmpc (:, 2) = Y 2_____y o
__p __p
e '
4.	Prossegue-se com o cálculo das demais colunas da matriz Gpnmpc atá a ultima coluna onde obtám-se o vetor Ym executando o modelo com as entradas e saídas passadas e com Au =[0 0 ... e]T.
Y m_Y 0
Gpnmpc(:,m) = p e p .
Para a aplicação da tácnica PNMPC em sistemas multivariáveis áe necessáario montar os vetores de prediçcãao e incrementos de açcãao de controle aumentados. Assim, para um sistema de ne entradas e ns saádas teráamos os seguintes vetores.
Yp
Au
[AuiAu2... Aune]T
(3.12)
A obtenção de F e Gpnmpc acontece da mesma forma como descrito anteriormente. A diferenca é que agora a matriz Gpnmpc
passa a ter ne x ns blocos calculados como no caso SISO para cada par de entrada e saída.
3.2.2	Obtenção da ação de controle
A ação de controle visa cumprir o objetivo geral de um MPC, que é fazer com que a saída futura y siga um determinado sinal de referencia w em um determinado horizonte e, ao mesmo tempo, o esforço de controle necessario Au para fazê-lo deve ser penalizado. A expressão geral para cumprir esse objetivo é a mesma da equação 3.1 e os parêmetros Ni, N2, Nu, R e Q podem ser sintonizados de acordo com as metodologias propostas em [2] e [24].
Utilizando-se a equação 3.8 como forma de expressar as prediçães, pode-se reescrever a funçcaão objetivo dada pela equaçcaão 3.1 da seguinte forma:
J = (Yp — W)T R (Yp — W)+AuTQAu	(3.13)
ou	(3.14)
J = (F + GpnmpcAu — W)T R (F + GpnmpcAu — W) + AuTQAu
A minimizacçãao da funcçãao custo para o caso sem restriçcoães pode ser obtida igualando-se a zero o gradiente da funçcaão custo dada pela equacao 3.13, ddJu =
—— = 2Gt RGAu + 2Gt RF — 2Gt RW + 2QAu	(3.15)
dAu
Isolando-se Au obtem-se :
Au = K (W — F)
(3.16)
onde K e a primeira linha da matriz (GtRG + Q)-1GtR.
Uma vantagem do controlador PNMPC é que apesar do modelo utilizado ser não-linear, para o calculo da ação de controle não é necessario a utilizaçao de otimização nao-linear, ao contrario do caso direto.
3.2.3	Tratamento de erro de predição, ruído e perturbação
O procedimento de tratamento de erros no PNMPC é uma versão explícita da versão utilizada pelo GPC. Os algoritmos de controle preditivo GPC e DMC corrigem as predicoes com erro entre o valor medido da variéavel controlada e seu valor predito com o modelo em um instante k. Para sistemas lineares, em regime permanente, essa técnica garante erro nulo pois o esforço de controle em um instante k seré o mesmo nos instantes futuros devido a relacao linear entre a entrada e a saída. Para o PNMPC esse mesmo procedimento nao garante erro nulo em regime devido ' variação do ganho com o ponto de operação do sistema.
Em [33] um mecanismo de correcao das prediçães foi proposto e consiste em adicionar um fator de correção a cada prediçao. Este fator de correcao é calculado através da integral do erro de predição filtrado. E apresentado na figura 3.2 o diagrama de blocos da técnica proposta para a correção das predições utilizando-se o algoritmo PNMPC. A cada instante de amostragem calcula-se o erro, descrito na equaçao 3.17, entre a saéda que o preditor calcula que a variavel teria no instante k [ã(k/k — 1)] e a saéda real da variável no instante k. O valor de [ã(k/k — 1)] é o primeiro elemento do vetor de prediçães obtido no instante k 1.
e(k) = y (k) — y(k/k — 1)
(3.17)
Figura 3.2: Diagrama de Blocos para o tratamento do erro de modelagem e ruído. (Fonte: [33])
Aléem de garantir o erro nulo em regime, o tratamento do erro de modelagem deve garantir que a dinâmica do erro apresente um tempo de resposta desejado. Defini-se a função de transferância entre o erro de modelagem e o erro depois da correçcãao como
h(z) =	e(z)	=	DF(z)(1 ~ z 1)
y(k) - ySc(k)	DF(z)(1 - z-1) + z-lki
(3.18)
onde DF(z) é o denominador do filtro. Um filtro candidato á
f (z) =
1
1 - fdz-1
(3.19)
Substituindo-se 3.19 em 3.18 tem-se
h(z) =	z2 - (1 + fd)z + fd
z2 - (1 + fd - ki)z + fd
(3.20)
O fator de correcão n(k), calculado no instante de amostragem k para ser utilizado na predição k +1 ate k + N á obtido de acordo com a equacão 3.21.
n(z 1) =
1	ki
1 - fdz-1 1 - z-1
e(z-1)
(3.21)
Para sintonizar os parêametros ki e fd compara-se o polinoêmio denominador da equaçcãao 3.20 com um polinêomio desejado pd(z). Supãoe-se um polinêomio desejado de segunda ordem criticamente amortecido,
pd(z) = (z - a)2, pd(z) = z2 - 2az + a2.	(3.22)
Comparando o polinêomio denominador da equaçcaão 3.20 com o polinêomio desejado da equaçcãao 3.22, obtáem-se as igualdades,
fd = a2, ki = 1 + a2 — 2a	(3.23)
O projeto do filtro do preditor consiste em escolher o valor do parêmetro a e entao determinar fd e kj.
3.3	Controle NMPC com Restrições
O cáalculo da açcaão de controle descrito na equaçcaão 3.16 foi formulado considerando que todos os sinais do processo possuem uma faixa de valores ilimitados. Esta abordagem nãao áe muito realista porque na práatica todos os processos estãao sujeitos a restricçãoes.
Atuadores possuem um intervalo de acçãao e uma taxa de variaçcãao limitada, como áe o caso de váalvulas de controle que estãao limitados a uma posiçcãao totalmente fechada e totalmente aberta e uma máaxima
taxa de variação. Razães construtivas e/ou de seguranca, bem como uma variedade de sensores, causam limitaçcãoes nas variaáveis de processo, como no caso dos níveis nos reservatórios, fluxos em tubulações e as pressoães em depáositos [2].
Os sistemas de controle normalmente operam proáximo aos limites, o que pode acarretar violacçãoes de restriçcãao. Cabe ao controlador antecipar e corrigir essas violaçcãoes de forma que nãao aconteçcam, evitando a instabilizaçcaão do sistema. Neste contexto os controladores MPC se mostram eficazes, uma vez que possuem a capacidade de prever possá-veis violaçcãoes ao longo do horizonte de prediçcãao e incluem as restriçcãoes na soluçao do problema de otimizaçao. Essas características possibilitam que os controladores MPC evitem a ocorrêencia das mesmas.
As restriçães se classificam em restriçães hard e soft. As restricoes hard são aquelas que nunca podem ser violadas, uma vez que definem os limites físicos de uma variável do processo. Restriçães soft podem ser violadas durante um transitáorio do sistema causado por perturbaçcãoes, sendo que em regime permanente devem ser respeitadas. A seguir seraão apresentadas os máetodos para a inclusãao de restricçãoes na otimizaçcãao da função objetivo de controladores MPC.
Para a soluçcãao do problema de controle preditivo com restriçcãoes a minimizaçcãao da funçcaão custo áe realizada com a aplicacçãao de algoritmos de programação quadrática QP. Estes algoritmos resolvem problemas do tipo:
min J =	- xT Qx + cT x
(3.24)
x	2
Sujeito a : Ax &amp;lt;b
A funçao objetivo da equação 3.13 pode ser reescrita na forma de
QP:
J (Au) =	H Au + bAu + fo
onde H = 2(GT RG + Q) b = 2(F - W)TRG fo = (F - W)T(F - W)
(3.25)
Segundo [48] existem três tipos principais de restriçães frequentemente encontradas em aplicaçães práticas. Os dois primeiros tipos tratam de restriçães impostas na variável de controle u(k), e o ter-
ceiro tipo estí relacionado a restriçães na saída y(k) ou nas variíveis de estado x(k). A seguir serí apresentada a metodologia utilizada para representação de restrições hard na variavel de controle e saída.
— Restrição na variação da variível de controle (Au):
Deseja-se que a variaçcãao do sinal de controle esteja numa faixa (Aumin &amp;lt;Au &amp;lt;Aumax) onde os limites correspondem a limita-çães físicas do atuador. Essa restricao pode ser escrita como:
IAu	&lt;	Aumax 1
IAu	&lt;	Aumin1
(3.26)
onde I e a matriz identidade de dimensão m x m e 1 í um vetor de dimensao m x 1 com todos elementos iguais a 1.
— Restrição na variível de controle (u):
Deseja-se que a amplitude do sinal de controle esteja numa faixa (umin &amp;lt;u &amp;lt;umax) onde os limites correspondem a saturaçoes do atuador. Essa restriçcaão pode ser escrita como:
TAu &amp;lt;(umax — u(t — 1))1 —TAu &amp;lt;(— umin + u(t — 1))1
(3.27)
onde T íe uma matriz triangular inferior de dimensãao m x m com todos elementos naão nulos iguais a 1.
— Restrição na saída (y):
Deseja-se que a amplitude da saída esteja numa faixa (ymin &amp;lt;y &amp;lt;ymax) onde os limites correspondem limitaçoes físicas do processo. Essa restriçcãao pode ser escrita como:
GAu	&amp;lt;Vmax1	F
GAu	&lt;	Vmin1 + F
(3.28)
Todas as restriçães podem ser expressas em conjunto montando as matrizes R e C tal que RAu &amp;lt;C:
R =
I -I T -T
G -G
(u
(
C =
^umax 1 A^min1 max	u(t	1))1
min + u(t	1))1
ymax1 F
ymin 1 + F
(3.29)
(3.30)
Grandes perturbações podem ocorrer inesperadamente, forcando o sistema a um estado do qual nõo ha nenhuma maneira de mantê-lo dentro os limites especificados, sem quebrar um conjunto de restrições. Problemas de infactibilidade tambem podem ocorrer devido a erros de modelagem, especialmente para sistemas linearizados [11]. Uma estrategia sistematica para lidar com o problema de infactibilidade é utilizar restrições soft [18].
Uma forma simples de utilizar restrições soft é adicionar variaveis de folga. Uma vantagem dessa abordagem e que a otimizacçõao a ser realizada pelo controlador MPC a cada instante de tempo continua sendo uma QP. A inserçao as variaveis de folga em um problema QP pode ser realizada modificando a equaçõo 3.24. Uma penalizaçao quadrática das violaçoes de restriçõo é adicionada problema original de acordo com:
min J = - xT Qx + cT x + eT Pe + pT e	(3.31)
x,e	2
Sujeito a : Ax &amp;lt;b + e
e &gt; 0
Esta técnica permite inicialmente a violação das restrições soft e através da minimização da variavel de folga e, força a variavel controlada a retornar para dentro da faixa delimitada pela restriçao. Infor-maçcãoes adicionais para a implementaçcaão de restriçcãoes soft podem ser encontradas em [11], [18] e [34].
3.4	Controle NMPC por Zonas
Em grande parte das aplicacoes industriais, as variáveis de saáda são controladas por faixas de operacao ao invás de setpoints fixos. Esta estratágia á usualmente adotada nos casos em que o numero de saá-das controladas áe maior que o nuámero de entradas manipuladas, com a intencçãao de obter alguns graus de liberdade que permitam levar o processo a seu target ótimo, e suavizar a resposta do sistema perante perturbacçãoes [13].
Segundo [18], em muitas aplicaçães o valor exato das variáveis controladas nãao áe importante, desde que permanecçam dentro dos limites especificados ou ’’faixas”. Isso significa que as saádas somente seraão tratadas como variáaveis controladas quando os valores das pre-diçcãoes das mesmas estiverem fora dos limites definidos para as faixas correspondentes.
Depois de atingir o ponto de operaçcãao, o controlador passa a controlar uma faixa de referâencia. Esta faixa áe extremamente importante do ponto de vista da identificaçcãao do sistema, pois dentro dela háa certa liberdade para se excitar a planta e retirar dela o seu comportamento natural.
Com a finalidade de incorporar o controle por faixas ao controlador PNMPC, a funçcãao objetivo da equaçcãao 3.1 áe modificada da seguinte forma:
N2
j(Ní,N2,nu)=Y, \\y(t + j|t)-yb(t+j|t)Hl +	(3.32)
j=Ni
Nu
«Au(t + j - 1)hQ j=í
De acordo com [43], a estratáegia de controle por faixas pode ser implementada da seguinte forma. Para cada saáda i observamos sua predicão no instante t + j:
•	Se yi,min &amp;lt;yi(t + j) &amp;lt;yi¡max, a saáda yi deve ser ignorada (liberada ou removida dos cáalculos de controle) no instante . Portanto, o parâmetro da matriz R correspondente a essa saáda deve ser zero. yb(t + j) pode ser qualquer valor.
•	Se y-í (t + j) &gt; yi¡max, a saáda yi deve ser trazida para seu limite superior. Portanto, fazemos yb(t + j) = yimax. O parâmetro da
matriz R correspondente a essa saída é um parâmetro de sintonia do controlador.
• Se yi(t + j) &amp;lt;yi,min, a saída yt deve ser trazida para seu limite inferior. Portanto, fazemos yb(t + j) _ yimin. O parâmetro da matriz R correspondente a essa saída íe o mesmo do caso anterior.
3.4.1	Comentarios Finais
Neste capítulo foi realizada uma revisão bibliográfica sobre controle preditivo. Foi apresentado o controlador PNMPC desenvolvido em [33] e estratágias de controle que visam tratar o problema do amortecimento de oscilaçães de carga. No práximo capítulo serão discutidos tácnicas de identificaçao de modelos não-lineares e modelos simplificados para serem utilizados como preditores juntamente com controladores PNMPC. Tambám serão apresentadas ferramentas que visam incluir uma açao feedforward no controlador PNMPC.
Capítulo 4
Identificação e Modelos para Predição
Nos capítulos anteriores foram discutidos modelos fenomenolo-gicos dos processos e tecnicas de controle preditivo. Neste capítulo serãao discutidos modelos utilizados para prediçcãao junto ao controlador PNMPC. Primeiramente serão apresentados aspectos teíricos sobre identificaçcãao de sistemas nãao-lineares e logo apíos a aplicaçcãao destas tícnicas para a identificação de um modelo Hammerstein do separador trifísico. Tambem í apresentado um modelo fenomenolígico simplificado do separador. Posteriormente serãao apresentadas ferramentas desenvolvidas para auxiliar no tratamento das perturbacçoães e adicionar uma ação feedforward ao controlador PNMPC. São elas o estimador de perturbaçcoães, o preditor de perturbaçcoães e o detector de perturbaçcãoes.
4.1	Modelo de Hammerstein
O modelo de Hammerstein consiste de um elemento estíatico nãao-linear seguido por um sistema dinaêmico linear. Processos que possuem nãao linearidades na entrada sãao bem representados pelo modelo Hammerstein. Essa representaçcaão possui propriedades que facilitam o projeto de controladores preditivos nãao lineares, viabilizando solucçãoes analíticas para os problemas de minimizaçcãao da funçcãao custo (caso sem restricçãoes), mas principalmente, diminuindo os custos computacionais nos cílculos das leis de controle. E apresentado na figura 4.1 um diagrama de blocos do modelo.
Figura 4.1: Modelo de Hammerstein
O sinal intermediario x(t) é uma pseudo-saáda do sistema e é obtido pelo mapeamento do sinal u(t) atraves da função nao-linear estática NL.
Segundo [5], a representação do bloco de não linearidade estática por um polinómio dá-se quando não se dispãe de informações a respeito da natureza da não linearidade. Essa representação pode ser feita atravás de uma expansao polinomial finita do tipo:
x(t) = Y1 u(t) + 72 u2 (t) + ... + Ym um (t)	(4.1)
em que t á o instante de tempo, x(t) á a pseudo-saáda do bloco não linear, u(t) á a variavel de entrada, Yí (i = 1, —J) representam os coeficientes do polinómio e m á o grau de nao linearidade do modelo de Hammerstein. Normalmente considera-se y1 = 1, transferindo o ganho estatico para a parcela dinómica linear G(q_1), que pode ser representada por qualquer modelo linear. As duas parcelas do modelo podem ser obtidas separadamente ou ao mesmo tempo em um ensaio de identificaçcãao. A representaçcãao parametrica do modelo de Hammerstein pode ser escrita na forma:
A(q_1 )y(t) = B (q _1 )x(t) + e(t)	(4.2)
em que a relaçao linear entre a saáda y(t) e a pseudo-saáda x(t) á apresentada. O termo e(t) representa a diferença entre o modelo e o processo (ruádo branco).
A popularidade do modelo de Hammerstein deve-se ao fato da sua maior simplicidade em relação às outras representações de sistemas nãao-lineares, aliada a uma capacidade de representacçãao da maioria dos processos práticos [38]. Um exemplo do uso de modelos de Hammers-tein áe a aplicacçãao em processos com dinóamicas proáximas a sistemas lineares mas que tenham fortes não linearidades nos atuadores (ex. váalvulas naão lineares).
4.2	Identificacõo do Modelo de Hammers-&gt;
tein
A identificaçao de sistemas pode ser compreendida segundo [16] como uma aproximaçcaão experimental a fim de obter um modelo mate-máatico que reproduz as caracterásticas dinaêmicas do processo a partir da observacçãao das variáaveis desse processo, sendo elas: variáavel controlada y(t), variavel de controle u(t) e em alguns casos pertubaçoes v(t). Para a identificaçcãao de modelos, alguns passos devem ser seguidos, saão eles:
1.	Aquisiçcãao dos dados do processo;
2.	Práe-processamento dos dados registrados;
3.	Selecçãao da estrutura do modelo;
4.	Estimacão dos parametros do modelo;
5.	Validaçao do modelo.
Para o ajuste dos parêametros do sistema e a definiçcãao do modelo a ser identificado, existem alguns fatores que exercem forte influência, sãao eles: (i) conhecimento a priori do sistema, (ii) propriedades do modelo do sistema identificado, (iii) seleçcãao da medida do erro a ser minimizado e (iv) presençca de ruádos.
4.2.1	Estimador dos Mínimos Quadrados
Existem váarios máetodos para ajustar os parêametros de um modelo a partir de informaçcoães de entrada-saáda de um processo. Nesse trabalho foi utilizado o Estimador dos Mánimos Quadrados Recursivos.
Karl Friedrách Gauss formulou o princápio dos mánimos quadrados no final do sáeculo dezoito e usou isto para determinar as áorbitas de planetas e asteroides. Gauss declarou que, de acordo com esse princá-pio, os parêametros desconhecidos de um modelo matemáatico devem ser selecionados de tal modo que ”a soma dos quadrados da diferenca entre os valores observados e os valores calculados multiplicado por nuámeros que medem o grau de precisãao seja mánima”.
O máetodo dos mánimos quadrados recursivo áe um dos máetodos mais utilizados na estimacçãao de parêametros de sistemas, sendo ideal para aplicações on-line incluindo controle adaptativo e tambem pode
ser usado para aplicações off-line. Isso acontece pela eficiência e simplicidade do método.
O desenvolvimento matematico das equaçoes do método dos mínimos quadrados recursivo pode ser visto em [6]. Abaixo seguem os passo para a implementação do estimador dos mínimos quadrados recursivo.
1.	Medir a entrada e a saída do sistema;
2.	Atualizar o vetor de medidas;
&lt;fiT(t + 1) = [-y(t) - y(t - 1)... u(t - d)u(t - d - 1)... ] (4.3)
3.	Calcular o erro de previsão;
e(t + 1) = y(t +1) - J(t + 1)ê(t)
4.	Calcular o ganho do estimador;
K (t + 1) =
________P (t)y(t + 1)____________
1 + ^T (t + 1)P (t)&lt;fi(t + 1)
5.	Calcular o vetor de parêmetros estimados;
è(t + 1) — $(t) + K (t + 1)e(t + 1)
6.	Calcular a matriz de covariêancia.
P(t + 1) = P(t) - K(t + 1&gt;T(t + 1)P(t)
(4.4)
(4.5)
(4.6)
(4.7)
De acordo com [7], a obtenção do modelo de Hammerstein pode ser realizada por meio de um ensaio de identificação utilizando o estimador MQR. Neste caso, o vetor de medidas é formado como se estivesse tratando de um sistema SISO na forma
^T(t) = [-y(t - 1) ... - y(t - na)u(t - d) .. . u(t - d - nb)	(4.8)
u2(t - d) . .. u2(t - d - nb)um(t - d) .. . um(t - d - nb)]
com dimensãao
[na + (nb +1)mxi]	(4.9)
e o vetor de parêametros:
0 = [a,ia2 ... ana; boYibiYi ... &amp;amp;nb7i5 boY2 ... &amp;amp;nb725 •..; &amp;amp;07 m ... bnb7m]
(4.10)
4.2.2	Procedimento de Identificaçao aplicado ao Separador Trifásico
A excitaçao do processo com o sinal PRBS além de promover uma excitacão permanente no sistema, também é Util para testar a linearidade da planta. Como o sinal assume valores positivos e negativos, este ée usado para avaliar as nãao linearidades presentes, ou nãao no processo. Para sistemas naão-lineares ée comum utilizar PRBS com amplitude va-riéavel, pois atravées da aplicaçcãao deste ée possével verificar a simetria do processo e a dependência da amplitude do sinal de entrada.
O experimento foi feito excitando-se com sinal PRBS nas três véalvulas de controle do separador na faixa de operaçcãao do sistema. As simulaçcãoes foram feitas em um peréodo de 10000 segundos, sendo que a primeira metade é destinada à identificaçao dos parêmetros do modelo e a segunda metade para validaçcãao. O procedimento de validaçcãao nada mais ée do que comparar as saédas do modelo com as saédas reais da planta e verificar quãao proéximas entre si elas estãao.
Para a geraçcãao do sinal PRBS, foi utilizada um rotina automéatica que, a partir da resposta em malha aberta do sistema, define a amplitude e frequêencia ideal do sinal PRBS. A descriçcãao desse procedimento pode ser encontrado em [46].
PRBS - sw
U
1UU
2UU
3UU
4UU
5UU tempons] PRBS - sc
5UU tempo[s]
-U.U'
U
-U.U'
U
1UU
1UU
2UU
¿UU
4UU
5UU tempo[s] PRBS - sl
2UU
¿UU
4UU
Figura 4.2: Sinais PRBS
A Figura 4.2 mostra os sinais PRBS gerados para cada valvula. Nota-se que não ha a necessidade de todos terem a mesma frequência e amplitude. A dinamica do gas, por exemplo, é muito mais rápida que a dinêmica da agua e do oleo, isso justifica o fato do sinal PRBS que excita a valvula de gas ter uma frequência maior. Tambem seria possível diminuir a amplitude do sinal PRBS da valvula de gas para diminuir a pertubacçãao no sistema de controle das valvulas de agua e gas.
Depois de ter o sinal PRBS gerado, o proximo passo é excitar o sistema com essa sequência binaria. A Figura 4.3 mostra o comportamento encontrado do sistema.
0.6
■g 0.55 -
tempo [s]
0.6
— 0.55 -
10.5
tempo is
10 -
tempo [s]
Figura 4.3: Excitação em Malha Aberta do sistema com sinais PRBS
Para descobrir qual o grau dos polinoêmios que melhor representam o sistema, foi criado uma rotina em Matlab que varia o grau do polinómio A(q-1), B(q-1) e o grau da expansão polinomial x(t) para encontrar a melhor combinacao da ordem de cada polinómio. Essa rotina, varia o grau do polinómio A de 1 a 9, do polinómio B de 0 ate o grau do polinómio A — 1, e do grau da expansao de x(t) de 1 a 9 e, portanto, analisa 405 diferentes modelos e elege o melhor. As equacoes de A, B e x(t) podem ser encontradas nas equacoes 4.2 e 4.1.
Para qualificar os modelos estimados e, portanto eleger o melhor modelo, existem algumas tecnicas de validaçcãao do modelo. Para isso, sao calculados 2 índices de desempenho do modelo, equacoes 4.11 e 4.12.
Somatorio do Erro Quadrático Medio - SEQM
1 N
seqm = ^YMk) — y(k)]2	(4.11)
v k=i
Coeficiente de Correlacão Múltipla — R2
R2 = 1
ZN=Mk) — y(k)]2
N=i[y(k) — y]2
(4.12)
Os melhores resultados para a identificação dos 405 modelos citados anteriormente estão disponíveis nas tabelas 4.1, 4.2, 4.3. Para o índice SEQM, quanto mais próximo seu valor é de 0, melhor. Para o índice R2 o valor deve ser o mais próximo possível de 1. Nas tabelas, na representa o grau do polinómio A, nb do polinomio Be nh o grau do polinómio y . Os índices de desempenho foram calculados no ensaio de validaçcaão.
Tabela 4.1: Ordem do modelo de Hammerstein para o nível da água
hw					
Modelo	na	nb	nh	R2	seqm
1	1	0	2	0,7626174791	0,0000130573
11	2	0	2	0,9640319883	0,0000019784
29	3	0	2	0,9879973121	0,0000006602
74	4	2	2	0,9935706372	0,0000003537
119	5	3	2	0,9958842871	0,0000002264
173	6	4	2	0,9969365633	0,0000001685
236	7	5	2	0,9976103048	0,0000001314
317	8	7	2	0,9980210001	0,0000001089
389	9	7	2	0,9983785215	0,0000000892
Tabela 4.2: Ordem dos modelo de Hammerstein para o nível de oleo
hl					
Modelo	na	nb	nh	r2	SEQM
9	1	0	9	0,9825394706	0,0000025801
27	2	1	9	0,9919624049	0,0000011877
54	3	2	9	0,9953645874	0,0000006850
90	4	3	9	0,9966054941	0,0000005016
135	5	4	9	0,9972700863	0,0000004034
189	6	5	9	0,9975688599	0,0000003592
252	7	6	9	0,9977040061	0,0000003393
324	8	7	9	0,9977252512	0,0000003361
405	9	8	9	0,9976792302	0,0000003429
Tabela 4.3: Ordem dos modelo de Hammerstein para a pressao
p					
Modelo	na	nb	nh	r2	SEQM
9	1	0	9	0,8110426509	0,0213767446
18	2	0	9	0,8319379628	0,0190128580
36	3	0	9	0,7790087770	0,0250007367
63	4	0	9	0,7163326443	0,0320912874
99	5	0	9	0,6225973772	0,0426955581
144	6	0	9	0,5250323535	0,0537330890
198	7	0	9	0,4933199639	0,0573207116
261	8	0	9	0,4747965830	0,0594162616
333	9	0	9	0,4643143087	0,0606021213
Pelas tabelas 4.1, 4.2 e 4.3 percebemos que o melhor modelo de Hammerstein possui os índices mostrados na tabela 4.4.
Tabela 4.4: Ordem do modelo de Hammerstein final
Saída	na	nb	nh	R2	SEQM
hw	9	7	2	0,9983785215	0,0000000892
hl	8	7	9	0,9977252512	0,0000003361
P	2	0	9	0,8319379628	0,0190128580
Apés ter definido quais são os graus dos polinâmios, a próxima etapa do projeto é a aplicação do metodo dos ménimos quadrados recursivo para a identificaçao dos parâmetros do modelo de Hammerstein. O modelo final encontrado nao serâ apresentado nesse trabalho pois os vetores com os parâmetros possuem ordem elevada e não é relevante para a compreensãao do procedimento. Como o modelo do separador trifésico é MIMO com três entradas e trâs saédas, foram identificados trâs modelos MISO que relacionam as trâs entradas com cada uma das saídas.
As Figuras 4.4, 4.5 e 4.6 mostram os ensaios de identificacão da égua, oleo e gés respectivamente. Os primeiros 5000 segundos do ensaio saão utilizados para a identificaçcãao dos parâametros enquanto os uéltimos 5000 segundos saão utilizados para a validacçaão do modelo.
Figura 4.4: Ensaio de Identificação e Validação da água
Figura 4.5: Ensaio de Identificaçao e Validacao do óleo
Ensaio de identificação da pressão
Figura 4.6: Ensaio de Identificacao e Validaçao do gós
O procedimento de identificacão do modelo de Hammerstein utilizando MQR para ajuste dos parâmetros se mostrou eficiente e ofereceu boa representacao do separador trifásico. O modelo encontrado é uma simplificaçao do sistema real e, consequentemente, necessita de menos esforço computacional para ser simulado. Dessa forma, o modelo de Hammerstein passa a ser uma oátima alternativa de preditor em controladores MPC.
4.3	Modelo Fenomenológico Simplificado
Uma alternativa de modelo para ser utilizado juntamente com o controlador PNMPC áe utilizar um modelo fenomenoláogico simplificado, uma vez que o controlador permite uma fáacil implementaçcãao com este tipo de modelo. A vantagem de se utilizar um modelo simplificado áe a reduçcãao do custo computacional, fator importante para aplicaçcãoes práa-ticas. A diferencça entre o preditor e o modelo utilizado para simulaçcãao do processo, áe que este despreza os cáalculos das eficiêencias de separacçãao e o conhecimento de BSW e T OG na entrada do separador. Considerase a que a variacao do nível de água na cêmara de separação depende somente da diferençca entre a vazãao de entrada e de saáda. Este modelo á descrito pelas equacões (4.13), (4.14), (4.15) e (4.16).
dht   Win + Lin Lweir Wo/&lt;1	(4 , 3)
~dt =	2 • Ccs -y/hT- (D - ht)	( . )
dh[  	Lweir Lout
~dt = 2 • Cc[ Vh[ • (D - h[)	( . )
dhw  	Win Wout	(4 1 5)
~dT = 2 • Ccs • /hj7(D - hw)	( . )
dp	(Gin + ^^in + Lin	Gout Wout Lout} ' p
dt =	Vt - VC[ - Vcs	.	&lt;4'16&gt;
Para realizar as prediçcoães áe necessáario o conhecimento dos valores das vazoes de alimentaçao do separador. Como não á possível medir as vazãoes de alimentaçcãao de aágua, áoleo e gáas separadamente, foi desenvolvido por um estimador de perturbaçcãoes que se baseia na medida dos níveis, pressão e vazães de saída para estimar o valor atual das vazães na entrada do separador.
Geralmente em controladores preditivos o que se utiliza á considerar que as perturbaçcoães sãao constantes ao longo do horizonte de prediçcãao, poráem essa abordagem nem sempre produz o melhor resultado. A utilizaçcãao das estimativas futuras das pertubaçcãoes podem melhorar as predicçãoes e consequentemente o desempenho do sistema de controle. Foi desenvolvido um preditor de perturbaçcoães, que consiste em um modelo auto regressivo e utiliza os valores anteriores estimados das perturbaçcãoes para realizar as predicçãoes futuras das mesmas.
Dependendo do regime de funcionamento do poçco a alimentaçcãao do separador pode assumir varios regimes de escoamento entre eles
constante ou oscilatório (golfadas). Se as vazães de alimentacão são constantes a melhor alternativa íe que as variaíveis controladas sigam um setpoint fixo. Caso as vazães de alimentação forem oscilatórias a melhor estratíegia íe permitir a oscilaçcãao das variíaveis controladas dentro de uma zona príe-estabelecida. Neste contexto foi desenvolvido um detector de perturbaçcãoes, que com base no cíalculo do desvio padrãao dos dados contidos em uma janela míovel, indica a presençca de perturbaçcãoes.
4.4	Estimador de Perturbacães
-&gt;
Como não é possivel medir separadamente as vazães de ígua, íleo e gís na entrada do separador trifísico, a informação das perturbaçães de carga caracterizadas por oscilacçãoes do tipo golfada nessas vazãoes, nao pode ser utilizada por controladores clíssicos ou avancados para a rejeicão das mesmas. Com a finalidade de adicionar características feedforward ao controlador PNMPC foi desenvolvido um estimador das vazãoes de alimentacçãao do separador trifíasico.
O modelo desenvolvido por [25] depende do conhecimento das medidas de BSW e TOG, na entrada do separador, as quais se tornam difíceis de serem realizadas. O calculo das eficiencias de separacão pode apresentar incertezas pois é necessírio o conhecimento dos parâmetros da distribuiçcaão das gotas das fazes dispersar na entrada do separador. Com o intuito de eliminar os cíalculos das eficiâencias de separaçcãao e o conhecimento de BSW e TOG, o estimador foi desenvolvido baseado no modelo simplificado descrito na seção 4.3.
A vazao de ígua na entrada do separador é estimada através da manipulação da equaçao 4.15 que determina a variaçao do nível da fase aquosa na câmara de separaçao. Isolando Win, temos que a vazao de entrada de ígua estimada é dada pela equaçao 4.17.
Win = [ccs • 2 • V(D - hw) • hw] •	+ Wout	(4.17)
A vazãao de íoleo na entrada do separador íe estimada atravíes da manipulação da equação 4.13 que determina a variacão do nível total da fase líquida na câmara de separaçao. Isolando a vazao da alimentação de oleo (Lin) chega-se a equação 4.18.
Lin — Lweir + [Ccs ' 2 ' / (D — ht) ' h^ '	(4.18)
- [Ccs • 2 • /(D — hw) • hw] •
A vazao da chicana pode ser estimada através da manipulação da equação 4.14 que determina a variação do nével de oleo na cámara de oleo. Isolando a vazao da chicana (Lweir) chega-se a equação 4.19.
Lweir — [Ccl • 2 ' \/(D — hl) • k] •	+ Lout	(4.19)
A vazãao de géas na entrada do separador ée estimada atravées da manipulacão da equaçao 4.16 que determina a variacão da pressão no separador. Isolando a vazao da alimentaçao de gas (Gin) chega-se a equação 4.20.
Gin — (Vt	—	Vp	—	Vd^)	• dP —	Win	—	Lin	(4.20)
+Wout + Lout + Gout
Foi realizado um experimento com o estimador de perturbações rodando em paralelo com o controlador PNMPC e utilizando o modelo fenomenolégico do separador trifasico como processo. O estimador rodou a uma taxa de amostragem de 1 segundo, enquanto o controlador utilizou um período de amostragem de 10 segundos. Esta diferença no peréodo de amostragem deve-se ao fato de que um observador deve ter a sua dinamica répida o suficiente para convergir ao valor real da varié-vel observada e garantir a estabilidade do sistema de controle. Como o estimador ée discreto uma forma de manter sua convergáencia ée utilizar um peréodo de amostragem menor que o do controlador. Em uma im-plementacçãao préatica, por exemplo, o estimador utilizaria um peréodo de 1 segundo, enquanto o controlador calcularia a acçãao de controle a cada 10 segundos. Poréem o controlador utilizaria apenas 1 de cada 10 valores estimados devido a diferençca do peréodo de amostragem.
As vazãoes de alimentaçcaão utilizadas no teste foram obtidas por uma simulação realizada no software Olga [39]. Na figura 4.7 é apresentado o resultado da estimaçcaão das 3 vazãoes de alimentaçcãao.
tempo (segundos)
0.15
0.1
Gin
est
Gin
0.05 0	1000	2000	3000	4000	5000	6000	7000	8000	9000 10000 tempo (segundos)
Figura 4.7: Vazoes de Alimentacao Estimadas
Foi realizada uma análise dos dados estimados visando a comparação com os dados reais de vazão. Os ándices de desempenho utilizados para analisar a qualidade dos dados estimados sao Coeficiente de Corre-laçao MUltipla (R2) [6] e o FIT [17]. Os índices de desempenho obtidos encontram-se na tabela 4.5.
Tabela 4.5: Indices de Desempenho
Variaveis	FIT	R2
Winest	91.7574	0.9932
Línest	90.7616	0.9915
Gi’neit	99.8325	1
Analisando os resultados pode-se concluir que o estimador de per-turbaçcãoes pode ser utilizado em conjunto com controladores preditivos para possibilitar uma açao de controle feedforward. Os ándices apresentados na tabela 4.5 indicam que os valores estimados no ensaio são muito proximos aos valores reais das perturbaçcãoes.
4.5	Preditor de Perturbações
Estimar perturbações á muito útil do ponto de vista de controle para compensar os seus efeitos futuros sobre as variáveis do processo. Muitos problemas em sistemas de controle podem ser reduzidos quando á possivel obter estimativas futuras das perturbações. Geralmente em controladores preditivos o que se utiliza á considerar que as perturbações sao constantes ao longo do horizonte de prediçõo, porem essa abordagem nem sempre produz o melhor resultado. A utilizacõo das estimativas futuras das pertubaçcõoes podem melhorar as predicçõoes e consequentemente o desempenho do sistema de controle.
Atualmente existem muitos sistemas em que a estimativa per-turbaçõo futura á utilizada com o objetivo de melhorar o desempenho global do sistema de controle. Alguns exemplos de aplicaçcõao desta táec-nica podem ser encontrados em sistemas de controle de estufas [32] e processos de produçõo de azeite de oliva [1].
Existem inuámeras táecnicas para realizar a predicçõao de perturba-çoes futuras. Para esse fim podem ser utilizados modelos de series temporais [31], [35] , Modelos autocorrelacionados [1] e redes neurais artificiais [30]. Neste trabalho foi utilizado um modelo auto regressivo (AR) para realizar as predições dos valores futuros das vazões de ali-mentaçcõao. Este modelo áe apresentado na equaçcõao 4.21 e conta somente com na medidas passadas da variavel a ser predita.
y(k) _ — ai • y(k — 1) — a2 • y(k — 2)... — ana • y(k — na)	(4.21)
O preditor de perturbacões consiste em um modelo auto regressivo, como na equaçõo 4.21, e seus parâmetros sõo obtidos atraves do estimador dos Mínimos Quadrados. O período de amostragem utilizado foi de 10 segundos uma vez que o controlador PNMPC utiliza esta amostragem. Foram estimados 3 modelos, um para cada vazõo de alimentaçcõao. O nuámero de atrasos de cada modelo foi escolhido aproximadamente o período das golfadas. Adotou-se 250 atrasos (na _ 250) o que equivale a um período de oscilacõo de 2500 segundos. Sõo apresentados nas figuras 4.8 os resultados graáficos do ensaio de validaçcõao.
tempo (segundos)
O0	2000	4000	6000	8000	10000
tempo (segundos)
Figura 4.8: Vazões de Alimentação Preditas
Os índices de desempenho obtidos para os modelos encontram-se na tabela 4.6.
Tabela 4.6: Performance Indices
Variaveis	FIT	R2
ÍHpred	97.7077	0.9996
LÍHpred	97.6925	0.9996
Ginpred	98.6354	0.9999
Analisando os resultados tabela 4.6 pode-se verificar que os modelos possuem otimos valores dos índices de desempenho. Este fato tambem pode ser verificado analisando os resultados gráficos apresentados. De acordo com os resultados pode-se concluir que os modelos identificados estãao aptos a realizar a funçcaão de preditores de perturba-çcoães, o que possibilita melhorar as predicçãoes utilizadas nos controladores preditivos.
4.6	Detector de Perturbações
Segundo [15] o conceito de detecção de estado estacionário originou-se da teoria de filtragem de ruídos. A variância ou desvio-padrão de parámetros importantes é normalmente utilizada para indicar a difusao estatística na distribuicao de dados e pode ser usado para caracterizar variaçao aleatoria dos sinais medidos. Neste trabalho estes conceitos se-rãao utilizados para a concepçcãao de um detector de oscilaçcãoes nas vazãoes de alimentaçcãao do separador trifíasico.
Um método simples para detectar perturbaçães consiste em analisar os dados através de uma janela de tempo pré-estabelecida, onde os parámetros importantes são amostrados em intervalos regulares. Isso produz uma matriz de parametros do sistema que são continuamente atualizados e mantidos na meméria. Esta janela e ilustrada na figura 4.9.
Figura 4.9: Janela móvel de n pontos de dados cerca do tempo kth [15]
O detector calcula o desvio padrão de forma recursiva. Supõe-se que em qualquer instante k, a media das ultimas n amostras de uma sequência de dados Xi , e dado por:
1 k
Xk = -	Xí	(4.22)
n
i=k-n+1
A diferença entre duas medias das ultimas n amostras no momento atual, k, e no instante de tempo anterior, k — 1, e
1
1
Xk - Xk-1 = -
n
k
.i=k-n+1
k-1
Xi -	Xi
i=k-n
Xk-n]
n
Reorganizando, a media atual e calculado por
xk xk-1 +	[xk	xk-n]
(4.23)
n
Esta abordagem í conhecida como janela de media mível porque a media a cada instante k í baseado no conjunto dos n valores mais recentes. A variância da janela mível pode ser definida da mesma forma. A deduçao da equação 4.24 í apresentada por Ross ([37]) no capítulo 2 de seu livro.
1 k 1 k
Vk = -	(xi - Xk) =-	xf - xk
nn
i=k-n+1	i=k-n+1
vk = vk-1 + - (xl - xl-J - (xk - xk-1) n
(4.24)
(4.25)
O desvio padrãao da janela míovel íe calculado por
&amp;amp; k
(4.26)
O detector utiliza o cíalculo do desvio-padrãao da janela míovel para indicar alteraçcãoes no comportamento do sistema. Se o desvio padrãao for menor que um limite príe estabelecido significa que as vazãoes de alimentaçao são aproximadamente constantes, caso o desvio padrão ultrapasse este limite o detector indicaraí a presençca de perturbaçcãoes. A indicaçcãao da presençca de perturbacçãoes pode ser utilizada no controlador PNMPC por zonas para a alteração da largura da zona dependendo do regime de escoamento na alimentaçcãao do separador.
A escolha do limite permitido para o desvio padrãao e do tamanho da janela míovel sãao fatores determinantes para o bom funcionamento do detector. Limites muito pequenos para o desvio padrão podem acusar ruídos de mediçcaão como transitíorios nas vazoães de alimentacçãao, por outro lado limites grandes, apesar de filtrarem os ruídos, podem não acusar as oscilacães quando elas ocorrem. Um valor plausível para o tamanho de janela íe o período míedio das oscilaçcãoes, uma vez que valores pequenos forem utilizados podem induzir, a interpretaçcãao de pequenos valores de derivada existentes ao longo da perturbacçãao, como regime permanente.
Com a finalidade de calibrar os paraâmetros do detector recomendase um ensaio preliminar que consiste em capturar valores de níveis, pressãao e vazãoes de saída do separador por um longo período de tempo, e com esses dados realizar a estimacçãao das vazãoes de alimentacçãao. Um
estudo dos sinais estimados deve ser realizado a fim de obter o valor dos parámetros para o melhor funcionamento do detector.
Para a implementação do detector de perturbações foram analisadas as vazoes de alimentação de agua e óleo. Foi utilizada uma janela de 250 amostras e um limite de 0.01 para o desvio padrão. Valores de desvio padrão abaixo do limite indicam valores constantes das vazães de alimentaçcãao e valores acima indicam a presençca de golfadas. Para acusar a presençca de perturbaçcãoes óe necessaório detectar valores acima do limite para as duas vazães de alimentaçao. O ensaio foi realizado com um peróodo de amostragem de 10 segundos.
E apresentado na figura 4.10 o ensaio realizado com o detector de perturbaçoes. Nos dois primeiros gróficos sao apresentadas a vazão de ógua e oleo na entrada do separador, no terceiro grófico é apresentada a varióvel de deteccão. Analisando a figura 4.10 é possível verificar que as golfadas comecçam a ocorrer no tempo de aproximadamente 1000 segundos e o detector de perturbaçcoães acusa a existáencia das mesmas no tempo de 1370 segundos. Existe um atraso de 370 segundos na detecçcãao, poróem nãao óe significativo se comparado com o peróodo de oscilação da perturbação. Isto se deve ao fato da utilizaçao de uma janela com um grande nuómero de amostras.


s


tempo (segundos)





tempo (segundos)


Q
Q

1
tempo (segundos)

Figura 4.10: Vazoes de água e oleo e variável de detecção
Foi realizado um segundo ensaio, apresentado na figura 4.11, para verificar a robustez do detector na presença de ruído nos sinais de vazao estimados. E possivel verificar que não houve alteração no funcionamento do detector.
0.0131-
tempo (segundos)
tempo (segundos)
1
Q
Q
0
1
tempo (segundos)






Figura 4.11: Vazões de água e óleo e variável de detecção
4.6.1	Comentarios Finais
Neste capítulo foram discutidos aspectos teóricos de identificação de sistemas nao-lineares e sua aplicacao no controle NMPC de separadores trifasicos. Tambóm foi apresentado um modelo simplificado do separador para realizar as predicoes no controlador PNMPC. Por ultimo foram apresentadas ferramentas desenvolvidas com a finalidade de auxiliar controladores MPC no tratamento de perturbacoes. No próximo capítulo serão apresentados os resultados dos ensaios realizados com os controlador PNMPC utilizando as diferentes tíecnicas e modelos ate aqui discutidos.
Capítulo 5
Resultados de Simulação
Nos capítulos anteriores foram discutidos modelos fenomenológi-cos dos processos, tócnicas de controle preditivo não-linear e modelos utilizados para predição. Neste capítulo serao apresentados os resultados de simulacão obtidos nos ensaios de controle. Os modelos apresentados no capítulo 2 foram utilizados para a simulacçãao dos processos enquanto os modelos do capítulo 4 foram utilizados para predicão no controlador PNMPC. Foram realizados ensaios primeiramente só com o separador trifíasico e posteriormente com o sistema integrado incluindo uma bateria de hidrociclones na saída de ógua do separador. Os dados utilizados para a simulacçãao do modelo fenomenolíogico do separador e do hidrociclone se encontram no apêndice A. Os sinais das vazoes de alimentaçcãao utilizados nos ensaios de controle foram obtidos atravíes de uma simulação no software Olga [39]. Primeiramente são apresentados os ensaios com a presençca de golfadas na entrada do separador e posteriormente com vazãoes de alimentaçcaão com perturbaçcoães do tipo degrau.
5.1	Controle do Separador Trifásico com a presença de Golfadas
Nesta seçcaão serãao apresentados os resultados obtidos nos ensaios de controle do separador trifíasico. Sãao apresentados resultados com o controlador PNMPC utilizando o modelo de Hammerstein e o modelo fenomenolígico simplificado como preditores. Para cada um dos pre-ditores foram utilizadas duas configuraçães do controlador PNMPC.
São elas: com restrições hard e soft e por zonas. Foi realizado um ensaio de controle com o controlador PI por bandas desenvolvido por [27], com o intuito de comparar o desempenho do controlador PNMPC com o de um controlador que atualmente é utilizado em plataformas da Petrobras.
5.1.1	Ensaio com PNMPC Hammerstein
A seguir serao apresentados os ensaios com o controlador PNMPC utilizando o modelo de Hammerstein. Foi utilizado um período de amostragem de 10 segundos para simular o processo e o controlador . O sinal de controle calculado atua diretamente na abertura das valvulas de agua, oleo e gas.
— Ensaio com PNMPC Hammerstein por Zonas
O primeiro ensaio de controle do separador trifasico foi realizado utilizando a estrategia de controle PNMPC por Zonas. O ajuste dos parâmetros do controlador é apresentado na tabela 5.1. O controle por faixas foi aplicado somente aos níveis da agua e do oleo, sendo que para pressao foi utilizado setpoint fixo. O parâmetro a de todas as confi-guracçoães do controlador PNMPC foi ajustado com o valor 0, pois com esse valor segundo [33], se obtem uma melhor rejeição a perturbaçães.
Tabela 5.1: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 6]
Nu	[15; 15; 2]
R	[30; 1; 1]
Q	[100000; 20000; 10000]
a	[0; 0; 0]
E apresentada na figura 5.1 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.2 sao apresentadas as vazães de alimentação e as vazães de saída.
13
12.5
12
11
0
1
2
3
tempo (horas)


Figura 5.1: Variaveis de Processo
Figura 5.2: Vazoes e alimentação e saída do separador
— Ensaio com PNMPC Hammerstein com Restricães Hard e Soft
O segundo ensaio de controle do separador trifaásico foi realizado utilizando o controlador PNMPC com restriçcoães hard e soft. O ajuste dos parâmetros do controlador é apresentado na tabela 5.2. Foram utilizadas restriçcoães soft nas saádas e restriçcãoes hard no incremento de controle, na amplitude do sinal de controle e nas saádas.
Tabela 5.2: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 6]
Nu	[15; 15; 2]
R	[30; 1; 1]
Q	[100000; 20000; 10000]
a	[0; 0; 0]
E apresentada na figura 5.3 a resposta das variaveis de processo com seus respectivos setpoints e os limites impostos pelas restricçoães soft. Na figura 5.4 são apresentadas as vazães de alimentacão e as vazoes de saída.
Figura 5.3: Variáveis de Processo
Figura 5.4: Vazões e alimentação e saída do separador
E possível verificar nos gráficos apresentados nesta seção que o controlador PNMPC utilizando o modelo Hammerstein obteve um bom desempenho nas duas configurações propostas. Nos dois ensaios a vazão de saída de agua sofreu uma considerável reduçao da oscilacão se comparada com a vazõao de alimentacçaõo.
5.1.2	Ensaio com PNMPC Modelo Fenomenologico
A seguir serão apresentados os ensaios com o controlador PNMPC utilizando o modelo fenomenolíogico simplificado como preditor. Como o modelo de prediçcãao possui como entradas as vazoães de saída ao invíes da abertura das valvulas, o sinal de controle do controlador PNMPC passa a ser um valor de vazãao a ser implementado nas saídas do separador. Foram utilizados três controladores locais PI para implementar estas vazãoes.
Para a realizacçãao da predicçaão como modelo fenomenoloígico simplificado íe necessíario o conhecimento das vazoães de alimentacçãao do separador. Como estas naão podem ser medidas foi utilizado o estimador de perturbacões descrito no capítulo 4, que com base nos dados de níveis, pressãao e vazãoes de saída infere os valores das vazãoes de alimen-tacçaão.
Com base nos valores estimados das perturbaçcãoes íe possível considerar uma ação feedforward do controlador. Essa acao pode ser implementada atravás dos valores das perturbacões calculados no tempo t. No entanto, os valores futuros dos distuírbios podem ser disponibilizados atravíes do uso do preditor de perturbacçoães descrito no capítulo 4 deste
trabalho, sendo estas informaçoes utilizadas pela lei de controle predi-tivo para o cílculo da sequência futura das açães de controle. Neste caso prediçcãao das saídas íe calculado usando o vetor de valores futuros da acao de controle Au e perturbaçães Aq:
Y_ f (Au, Aq)	(5.1)
e a relacõo linearizada entre os valores futuros das entradas e o vetor prediçcaõo áe calculada usando o mesmo procedimento explicado no capátulo 3.
Para a realizaçcaõo destes ensaios foi utilizado um peráodo de amostragem de 1 segundo para simular o processo, os controladores PI e o estimador de perturbaçcoões e um peráodo de 10 segundos para simular o controlador PNMPC. O esquema de controle áe apresentado no diagrama da figura 5.5. Os parâametros dos controladores de vazõao saõo apresentados na tabela 5.3. O ajuste destes controladores foi realizado de forma que a vazõao de setpoint calculada pelo controlador PNMPC seja implementada antes do práoximo cáalculo do setpoint, ou seja, em menos de 10 segundos.
Win Lin G,
Figura 5.5: Esquema de controle do PNMPC com controle local de vazão
Tabela 5.3: Parâmetros de Ajuste do Controlador
Variaveis	Kc	T- j-'t
hw	20	1
hl	15	1
p	0 ,025	1
— Ensaio com PNMPC Modelo Fenomenológico com Restrições Hard e Soft
O primeiro controlador testado foi o controlador PNMPC com restricães. O ajuste dos parâmetros do controlador é apresentado na tabela 5.4. Foram utilizadas restrições soft nas saédas e restriçães hard no incremento de controle, na amplitude do sinal de controle e nas saédas.
Tabela 5.4: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 20]
Nu	[5; 5; 5]
R	[1; 1; 10]
Q	[10000000; 100000; 100]
P . 1 mm	[1; 10; 1]
P 1 max	[1; 10; 1]
a	[0; 0; 0]
E apresentada na figura 5.6 a resposta das variáveis de processo com seus respectivos setpoints. Na figura 5.7 são apresentadas as vazoes de alimentaçao e as vazães de saáda.
tempo (horas)
Figura 5.6: Variaveis de Processo
i
f
2	3
tempo (horas)


Figura 5.7: Vazões e alimentação e saída do separador
- Ensaio com PNMPC Modelo Fenomenologico por Zonas
O segundo ensaio de controle foi realizado com o controlador PNMPC por Zonas. O ajuste dos parâmetros do controlador é apresentado na tabela 5.5. O controle por faixas foi aplicado somente aos níveis da agua e do oleo, sendo que para pressao foi utilizado setpoint fixo.
Tabela 5.5: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 20]
Nu	[5; 5; 5]
R	[5; 3; 20]
Q	[1000000; 100; 1]
a	[0; 0; 0]
E apresentada na figura 5.8 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.9 são apresentadas as vazoes de alimentaçao e as vazães de saída.
12.1
12
0
1
2
3
tempo (horas)


Figura 5.8: Variaveis de Processo
Figura 5.9: Vazoes e alimentação e saída do separador
E possível verificar nos gráficos apresentados nesta seção que o controlador PNMPC utilizando o modelo fenomenoloígico simplificado obteve bons resultados. Em uma primeira aníalise comparando com os resultados da seçcaão anterior pode-se dizer que este controlador possibilitou uma vazaão de saída de íagua mais contante, destacando principalmente o desempenho do controlador PNMPC por zonas.
5.1.3	Ensaio com Controlador por Bandas
A seguir são apresentados os resultados obtidos com o controlador por bandas. Os aspectos teóricos deste controlador são apresentados no apândice C. O ajuste dos parâmetros do controlador é apresentado na tabela 5.6. O controle por bandas foi aplicado somente aos níveis da ígua e do íleo, sendo que para pressão foi utilizado setpoint fixo.
Tabela 5.6: Parâmetros de Ajuste do Controlador
	Dentro da Zona		Fora da Zona	
Variíveis	Kc	T-	Kc	T-
hw	0, 001	125	0,1	50
hl	0,01	125	0,02	50
p	0,03	50	0,03	50
Eé apresentada na figura 5.10 a resposta das variéaveis de processo com suas respectivas faixas. Na figura 5.11 saão apresentadas as vazãoes de alimentaçcaão e as vazãoes de saéda.
0	1	2	3	4	5
0
1
2
3
tempo (horas)


Figura 5.10: Variáveis de Processo
Figura 5.11: Vazões e alimentação e saída do separador
Como pode ser visto nas figuras apresentadas o controlador por bandas proporcionou um certo amortecimento na vazão de saída de agua. Se comparado com o controlador PNMPC é possivel identificar visualmente que este controlador se mostra inferior em termos de amortecimento de oscilaçães. Uma anélise comparativa completa dos resultados sera apresentada no item 5.1.4
5.1.4	Análise de Desempenho dos Controladores
A tabela 5.7 contém dados referentes as oscilacães percentuais das vazães de entrada e saída do separador trifésico e a variância das vazães de saída para cada ensaio de controle realizado. Nota-se tanto nos resultados gréficos como nos índices de desempenho, que em todos ensaios as vazães de entrada e saída de gés sao as mesmas. Isto ocorre devido à preocupaçao de manter a pressao constante no interior do separador. Em contrapartida, diferentes resultados para as vazães de íoleo e íagua foram obtidos com os diferentes controladores.
Tabela 5.7: Indices de Desempenho
Controlador	Vazão	Oscilacão (%)	Variancia
	Win	21,01	-
-	Lin	15, 29	-
	Gin	32, 45	-
	Wout	4, 57	1,2821•10-8
PNMPC Hammerstein CR	Lout	31, 91	1, 7867 • 10-6
	Gout	32, 45	2, 4828 • 10-4
	Wout	3, 97	1, 6559 • 10-8
PNMPC Hammerstein Zona	Lout	30, 70	1, 5770 • 10-6
	Gout	32, 45	2, 0830 • 10-4
	Wout	4, 31	3, 3260 • 10-8
PNMPC CR	Lout	32, 61	2, 6433 • 10-6
	Gout	32, 45	1, 4379 • 10-4
	Wout	4, 00	5, 7803 • 10-9
PNMPC Zona	Lout	31,00	2, 5111 •10-6
	Gout	32, 45	1, 4590 • 10-4
	Wout	6, 27	3, 5313•10-8
Bandas	Lout	65, 76	1,5216•10-6
	Gout	32, 45	1, 6118•10-4
Eá possável verificar que entre os controladores preditivos o maior amortecimento das oscilacçãoes na vazãao de saáda de aágua áe obtido pelo controlador PNMPC por zonas utilizando o modelo Hammerstein, obtendo um amortecimento com um fator de 5, 29 e uma variência de 1, 6559 • 10-8. Porem o controlador preditivo que obteve a menor vari-êancia da vazãao de saáda de áagua foi o controlador PNMPC por zonas utilizando o modelo fenomenoláogico simplificado, com uma variêancia de 5, 7803 • 10-9 e um amortecimento com um fator de 5, 25.
Analisando os resultados gráaficos obtidos com os dois controladores áe possável verificar que a vazãao de saáda de áagua se mantáem constante por um maior tempo com o segundo controlador, tendo variacçãoes em degrau quando nável de áagua sai para fora da zona. Poráem como primeiro controlador a vazãao varia ao longo do tempo de uma forma aproximadamente senoidal com pequena amplitude.
Levando em conta a analises dos gráficos, o fato do amortecimento obtido com os dois controladores sãao praticamente iguais e a variaência obtida como segundo controlador áe consideravelmente menor, escolheu-
se o controlador PNMPC por zonas utilizando o modelo fenomenologico simplificado como controlador mais adequado para situações onde o processo esteja sob a ação de golfadas.
Analisando os resultados gráficos e os dados da tabela 5.7 nota-se que existe uma amplificaçao das oscilaçães na vazão de saída de oleo. Este fato pode ser explicado analisando a equação da variaçao da altura total na câmara de separaçao, tendo em vista que ha um aumento da oscilaçcãao das vazãoes de entrada de oleo e agua e uma reduçcãao da oscilacão da vazão de saída de agua devido ao controle aplicado, consequentemente ocorre um aumento da vazãao da chicana o que acarreta uma perturbaçcaão maior que a ocorrida na vazãao de entrada de oleo. Para obter o amortecimento desejado na vazao de saída de agua é ne-cessaria uma oscilação do nível da agua, o que acarreta maior oscilação do nível total de líquido na câmara de separacão e consequentemente aumenta a vazaão da chicana.
E expressa nos trabalhos de ([8]; [40]; [13]; [36]) entre outros, a preocupação com o amortecimento na vazão de saída de agua, uma vez que esta alimenta a entrada dos hidrociclones e influencia diretamente do comportamento dos mesmos. Se as perturbacões forem repassadas ao hidrociclones estes terãao seu funcionamento comprometido do ponto de vista da eficiâencia de separaçcãao.
E apresentado em [28] um diagrama de uma planta trifasica de processamento primario de petróleo. Nesta existe um separador bifásico oleo/gas em serie com a saída de oleo do separador trifasico. O separador bifasico pode ser utilizado com filtro visando absorver estas oscilaçcãoes de forma a fornecer uma vazãao constante ao tratador eletros-tatico que esta em serie.
5.2	Controle do Separador Trifásico com perturbações do tipo degrau
Nesta seção serão apresentados os resultados obtidos nos ensaios de controle do separador trifasico utilizando vazães de alimentação com perturbacçoães do tipo degrau. E importante analizar este tipo de situação, porque ao longo do tempo o regime de escoamento nos poços e risers podem alternar entre golfadas e mudancas em degrau nas vazães alternando com períodos de regime permanente. Os ensaios seráo apresentados no mesmo formato da secão 5.1.
5.2.1	Ensaio com PNMPC Hammerstein
A seguir serãao apresentados os ensaios com o controlador PNMPC utilizando o modelo de Hammerstein como preditor. Foi utilizado um período de amostragem de 10 segundos para simular o processo e o controlador . O sinal de controle calculado atua diretamente na abertura das vélvulas de agua, óleo e gés.
— Ensaio com PNMPC Hammerstein por Zonas
O primeiro ensaio de controle do separador triféasico foi realizado utilizando a estratégia de controle PNMPC por Zonas. O ajuste dos parâmetros do controlador é apresentado na tabela 5.8. O controle por faixas foi aplicado somente aos néveis da agua e do éleo, sendo que para pressão foi utilizado setpoint fixo. Neste ensaio foi utilizada uma largura da zona igual a zero de forma que o controlador funciona como se utiliza-se um set point fixo.
Tabela 5.8: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 6]
Nu	[15; 15; 2]
R	[20; 1; 1]
Q	[1000; 1000; 10000]
a	[0; 0; 0]
E apresentada na figura 5.12 a resposta das variáveis de processo com suas respectivas faixas. Na figura 5.13 sao apresentadas as vazões de alimentaçõo e as vazões de saáda.





).46l
						
				
	a	10 tempo (horas)			
A	'	'	1 1			
r	nr	;				
2 4 6	a	10 tempo (horas)	12	14	16
a	10
tempo (horas)






Figura 5.12: Variáveis de Processo

1
I	Win I
I	Wout |~




T
r

I	Lin I
I	Lout|~


I	Gin I
I----Gout[


6	a	10	12
tempo (horas)
Figura 5.13: Vazões e alimentaçao e saída do separador
— Ensaio com PNMPC Hammerstein com Restrições Hard e Soft
O segundo ensaio de controle do separador trifasico foi realizado utilizando o controlador PNMPC com restricoes hard e soft. O ajuste dos parâmetros do controlador é apresentado na tabela 5.9. Foram utilizadas restrições soft nas saídas e restrições hard no incremento de controle, na amplitude do sinal de controle e nas saídas.
Tabela 5.9: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 6]
Nu	[15; 15; 2]
R	[2; 1; 2]
Q	[1000; 1000; 10000]
a	[0; 0; 0]
E apresentada na figura 5.14 a resposta das variaveis de processo com seus respectivos setpoints e os limites impostos pelas restricçãoes soft. Na figura 5.15 sao apresentadas as vazães de alimentacão e as vazães de saéda.
tempo (horas)
	2	4	6	8 10	12	14	16
			tempo (horas)			
-		!				4				1		-\- -
		f				
		4		.|	1			J	1.		1			1			1- - =
			8 10			
			tempo (horas)			
Figura 5.15: Vazões e alimentaçao e saída do separador
Eí possível verificar nos graíficos apresentados nesta secçãao que o controlador PNMPC utilizando o modelo Hammerstein obteve um bom desempenho nas duas configuracçãoes propostas. Nos dois ensaios as va-riaíveis controladas sofreram certa oscilacçãao no momento em que ocorreu a perturbaçcaão nas vazoães de alimenteçcaão poríem posteriomente essas perturbações foram rejeitadas.
5.2.2	Ensaio com PNMPC Modelo Fenomenológico
A seguir seraão apresentados os ensaios com o controlador PNMPC utilizando o modelo fenomenológico simplificado como preditor. O principio de funcionamento deste controlador foi apresentado no item 5.1.2.
— Ensaio com PNMPC Modelo Fenomenologico com Restricões Hard e Soft
O primeiro controlador testado foi o controlador PNMPC com restricçoães. O ajuste dos parêametros do controlador íe apresentado na tabela 5.10. Foram utilizadas restricoes soft nas saídas e restriçoes hard no incremento de controle, na amplitude do sinal de controle e nas saídas.
Tabela 5.10: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 20]
Nu	[5; 5; 5]
R	[20; 10; 10]
Q	[1000; 100; 100]
P . 1 mm	[1; 10; 1]
P 1 max	[1; 10; 1]
a	[0; 0; 0]
E apresentada na figura 5.16 a resposta das variáveis de processo com seus respectivos setpoints. Na figura 5.7 são apresentadas as vazoes de alimentação e as vazães de saáda.
p	hl	hw
-			4	1			1	4		--I			1				1		-
				K-/	'			
		4	1			1	4			1			1				I		
	2	4	6 8 tempo (horas)	10	12	14	16
-		!	1			1	4		.1		------ 4			!		
-			4	1-			1	4		- -1			1				1			1- - -
	24	68 tempo (horas)	10	12	14	16
1 1 1 1 1 1 1 1						
1 1 1 1 1 1 1 1						
	24	6 8	10	12	14	16
tempo (horas)
Figura 5.17: Vazoes e alimentacao e saída do separador
— Ensaio com PNMPC Modelo Fenomenologico por Zonas
O segundo ensaio de controle foi realizado com o controlador PNMPC por Zonas. O ajuste dos paraâmetros do controlador áe apresentado na tabela 5.11. O controle por faixas foi aplicado somente aos náveis da aágua e do áoleo, sendo que para pressaõo foi utilizado setpoint fixo. Neste ensaio foi utilizada uma largura da zona igual a zero de forma que o controlador funciona como se utiliza-se um set point fixo.
Tabela 5.11: Parâmetros de Ajuste do Controlador
Parâmetro	Valor
N	[20; 20; 20]
Nu	[5; 5; 5]
R	[5; 3; 20]
Q	[1000000; 100; 1]
a	[0; 0; 0]
E apresentada na figura 5.18 a resposta das variaveis de processo com suas respectivas faixas. Na figura 5.19 sao apresentadas as vazoes de alimentaçcaão e as vazãoes de saída.
12.5
12
0	2	4	6	8
tempo (horas)
12	14	16
Figura 5.18: Variáveis de Processo
tempo (horas)
----Gin ----Gout
■Z"
L
1
1
J l
8	10
tempo (horas)
1
1
1
0
0


"21
V

Figura 5.19: Vazães e alimentaçao e saída do separador
E possível verificar nos gráficos apresentados nesta seçao que o controlador PNMPC utilizando o modelo fenomenolíogico simplificado obteve bons resultados. Em uma primeira aníalise comparando com os resultados da seçcaão anterior pode-se dizer que este controlador possibilitou um melhor comportamento em regime permanente rejeitando as perturbacçoães do tipo degrau nas variaíveis controladas.
5.2.3	Ensaio com Controlador por Bandas
A seguir são apresentados os resultados obtidos com o controlador por bandas. O ajuste dos parâmetros do controlador é apresentado na tabela 5.6. O controle por bandas foi aplicado somente aos néveis da éagua e do éoleo, sendo que para pressãao foi utilizado setpoint fixo.
E apresentada na figura 5.20 a resposta das variéveis de processo com suas respectivas faixas. Na figura 5.21 sao apresentadas as vazães de alimentaçcãao e as vazãoes de saéda.
Figura 5.20: Varióveis de Processo
Figura 5.21: Vazoes e alimentaçao e saída do separador
Como pode ser visto nas figuras apresentadas o controlador por bandas controlou com dificuldades o processo de forma que a cada degrau aplicado nas vazões de alimentacão a vazao de saída de água se tornou mais oscilatária, o que pode comprometer o funcionamento dos processos a jusante. Porám as variaveis controladas nao excederam o limite da banda. Uma análise comparativa completa dos resultados será apresentada no item 5.2.4
5.2.4	Analise de Desempenho dos Controladores
A tabela 5.12 contem dados referentes a variância das variaveis controladas e a variância das vazoes de saída para cada ensaio de controle realizado.
Tabela 5.12: Indices de Desempenho
Controlador	Vazão	Variaóncia	
	Wout	5, 8616 •	10-8
PNMPC Hammerstein CR	Lout	6, 2437 •	10-8
	Gout	1,0873 •	10-4
	hw	6, 2434 •	10-5
	hl	4, 2830 •	10-4
	p	6,1686 •	10-3
	Wout	5, 6297 •	10-8
PNMPC Hammerstein Zona	Lout	6, 2395 •	10-8
	Gout	8, 2678 •	10-5
	hw	7,4913 •	10-6
	hl	7, 5026 •	10-6
	p	5, 8653 •	10-3
	Wout	6,1237 •	10-8
PNMPC CR	Lout	6, 5308 •	10-8
	Gout	6,4893 •	10-5
	hw	6, 3942 •	10-5
	hl	4, 6847 •	10-7
	p	1, 2264 •	10-4
	Wout	5, 7255 •	10-8
PNMPC Zona	Lout	6, 2849 •	10-8
	Gout	6,4872 •	10-5
	hw	5, 9366 •	10-6
	hl	3,0549 •	10-6
	p	3, 9230 •	10-6
	Wout	7, 9442 •	10-8
Bandas	Lout	1,1678 •	10-7
	Gout	6, 5061 •	10-5
	hw	4, 5637 •	10-4
	hl	2,1461 •	10-2
	p	4, 6473 •	10-5
Analizando os resultados da tabela 5.12 í possível verificar que o controlador que apresenta melhor índice na vazão de saída de agua í o controlador PNMPC por zonas utilizando o modelo hammerstein, com uma varióncia de 5, 6297 • 10-8. Por outro lado o controlador PNMPC po Zonas utilizando o modelo fenomenolígico apresentou melhores re-
sultados quanto a oscilaçcãao no nível da íagua, com uma variaência de 5, 9366 • 10-6. O segundo controlador obteve bons índices relativos a vazãao de saída de íagua, isto significa que o controlador rejeitou as per-turbaçcãoes do tipo degrau nas vazoães de alimentaçcãao e ao mesmo tempo manteve uma boa separaçcãao. O mesmo pode ser verificado nos gríaficos apresentados.
Deve-se ressaltar que o controlador PI por bandas não obteve bons resultados neste ensaio por se tratar de um controlador concebido para o amortecimento de osci^ães do tipo golfada. Sua sintonia lenta dentro da banda permite uma oscilaçcaão por um longo período de tempo quando ha uma mudança na alimentação do separador. Uma possível alternativa para melhorar o desempenho do controlar neste caso seria diminuir a banda de forma a aproximí-lo de um controlador com setpoint fixo e uma sintonia mais agressiva, como efetuado com o controlador PNMPC por zonas utilizando o modelo fenomenolígico.
Quanto menor variência nestes sinais, melhor í a separação, uma vez que o nível de ígua se mantendo príximo ao setpoint e a vazao de saída de íagua sendo constante, garantem que a distribuicçaão do volume das gotas de oíleo dispersas na corrente aquosa que alimenta a bateria de hidrociclones nãao sofra alteraçcãoes ao longo do tempo. Dessa forma o controlador alíem de garantir o bom funcionamento do separador tambíem permite que os equipamentos a jusante funcionem de forma adequada.
Levando em conta a anílises dos itens 5.1.4 e 5.2.4, escolheu-se o controlador PNMPC por zonas utilizando o modelo fenomenolíogico simplificado como controlador preditivo de melhor desempenho, e sería testado com o sistema integrado (Separador + Hidrociclone).
5.3	Ensaio com Controlador PI por Bandas e PNMPC Modelo Fenomenológico por Zonas
Eí apresentado na figura 5.22 o esquema de controle proposto, baseado no controlador PNMPC e nas estratíegias de estimaçcãao, prediçcãao e detecção de perturbaçoes, utilizado para obter um controle flexível e eficiente para o separador. Como pode ser visto na figura o controlador possui trêes níveis. No nível local, trêes controladores PI escravos sãao usados para manipular as trêes víalvulas e manter os fluxos de saída de íagua, oíleo e gías nos valores do setpoint, definidos pelo controlador mestre (PNMPC).
O PNMPC, que opera no segundo nivel, minimiza uma função objetivo que utiliza açoes feedback e feedforward. Finalmente, a funcão objetivo a ser passada para o PNMPC í computada no terceiro nível, que decide se o controlador deve trabalhar com uma faixa estreita ou larga nas especificaçães de controle. Este nível supervisor utiliza um detector de perturbaçcãoes das vazoães de alimentacçãao para definir o modo de operacçãao.
W,„	L¡„	G,
Figura 5.22: Esquema do PNMPC com controle supervisário
Dependendo do regime de funcionamento do poco ou do riser, a vazao de fluido na entrada no separador pode ser estível ou oscila-tíorio. Para uma vazãao de alimentaçcãao constante a melhor opçcaão de controle í exigir que as variíveis do processo sejam mantidas em uma faixa estreita em torno de um setpoint fixo. Para uma vazão de fluido oscilatíoria um melhor resultado íe obtido permitindo uma maior osci-laçcãao das variaíveis controladas em torno do ponto de operaçcaão, de tal forma que o separador funciona como um filtro para as perturbacçãoes.
O detector de perturbacçãao íe uma ferramenta importante para a implementaçcaão da estratíegia de controle. Portanto, a faixa em que íe permitida a variaçcaão das variíaveis controladas depende da amplitude das oscilações na entrada do separador. Esta estrategia garante o melhor desempenho de controle independentemente do regime de fluxo na alimentaçcãao do separador.
Foi realizado um ensaio com 38, 88 horas de duração onde na primeira metade o separador de foi controlado com o controlador por bandas, e a partir do tempo 19, 44 horas atíe o fim, foi utilizada a estratíegia de controle proposta. Para obter um chaveamento suave entre as duas estratíegias de controle, entre os intervalos de tempo de 13, 88 a 25, 00 horas, foi aplicada uma vazãao de alimentaçcãao constante. Entre os intervalos de 16, 66 e 22, 22 horas foi aplicado um degrau nas vazãoes de alimentaçcaão. Os parêametros dos controladores sãao os mesmos
apresentados nas tabelas 5.6, 5.5 e 5.11.
E apresentada na figura 5.23 a resposta das variaveis de processo com suas respectivas faixas e setpoints. Na figura 5.24 sao apresentadas as vazões de alimentação e as vazões de saída.
\AvAaAA/WUVVVVVVVVV\Pv/^-
0.2

0.2
i	i	i	i	i	i	r
•JVAAAWAAAAAAAAAAAPw^- - -..........——i
i i i i i v " T i
0	5	10	15	20	25	30	35
tempo (horas)
fill	■MH	 ?	
HITO uyyyi	1.111 1	
0	5	10	15	20	25	30	35
tempo (horas)
i	i	i	i	i	i	r
12.8
12.6
O. 12.4
12.2
12
i i i i L
5	10	15	20	25	30	35
tempo (horas)
0
Figura 5.23: Varióveis de Processo
0	5	10	15	20	25	30	35
tempo (horas)
0.022
tempo (horas)
25	30	35






Figura 5.24: Vazões e alimentacao e saída do separador
Sao apresentados na tabela 5.13 dados referentes às oscilacões percentuais e variancia das vazoes de saáda do separador trifasico para cada controlador. O maior amortecimento das oscilações na vazõo de saáda de água á obtido pelo controlador proposto com um fator de 7, 29
contra 3, 34 do controlador por bandas. o controlador proposto tambem apresentou uma menor variaância na mesma vazaão. E possivel verificar na figura 5.24 que, desde os instante 22, 51 horas a vazão de saída de agua permanece constante ate que o final do teste, portanto, resultando em 10, 82 horas de sem nenhuma oscilacçãao.
Tabela 5.13: Indices de Desempenho - Golfadas
Controlador	Vazãao	Oscilacão (%)	Variância
	Wout	6, 27	2, 3366 • 10-8
Bandas	Lout	65, 76	1, 5443 • 10-6
	Gout	32, 45	1, 5589 • 10-4
	Wout	2, 88	2, 5775 • 10-9
PNMPC Proposto	Lout	27, 49	2,4778•10-6
	Gout	32, 45	1, 3945 • 10-4
São apresentados na tabela 5.14 a variancia da vazão das trâs saídas do separador trifasico para cada controlador. Esta tabela contem informaçães do período do ensaio onde não houve a presença de perturbaçães atuando no processo. Os índices expostos na tabela mostram que o controlador proposto obteve melhores resultados do que o controle por bandas, alem disso, ele mantem as vazoães de sa ída mais constantes e estabiliza as variaveis de processo com menor tempo de acomodaçcãao, como pode ser observado na figura 5.23.
Tabela 5.14: Indices de Desempenho - Regime Permanente
Controlador	Vazãao	Variaância
	Wout	6, 5992 • 10-8
Bandas	Lout	1, 7679 • 10-7
	Gout	2,4218•10-5
	Wout	2,1662•10-8
PNMPC Proposto	Lout	2, 3254 • 10-8
	Gout	2,4137•10-5
De acordo com os resultados da simulaçao obtidos pode-se concluir que o uso da estrategia proposta permite um melhor amortecimento das perturbaçcãoes do que outros controladores e tambem propor-
ciona um melhor desempenho quando o processo opera em condições estáveis.
5.4	Controle do Sistema Integrado (Separador + Hidrociclone)
Nesta seçao serõo apresentados os resultados oriundos do ensaio de controle com o sistema integrado (separador + hidrociclone). Foram utilizados os mesmos controladores e sinais de vazao de alimentaçõo do separador do ensaio da seçao 5.3. Para prediçõo foram utilizados o modelo fenomenologico simplificado do separador e um modelo estático que relaciona a queda de pressõo no overflow do hidrociclone com a vazõo de saída do overflow, vide equaçao 2.48. A exemplo da seçõo
5.3,	na primeira metade do ensaio o separador foi controlado com o controlador por bandas, e a partir do tempo 19, 44 horas ate o fim, foi utilizado o controlador PNMPC.
Os parâmetros do controlador por bandas sõo os mesmos apresentados na tabela 5.6. Para o controlador PNMPC por zonas foram utilizados os parâmetros das tabelas 5.5 e 5.11. Como o modelo da diferença de pressõo no overflow do hidrociclone á um modelo estático, foram utilizados os mesmos valores para os horizontes de prediçcõao e controle sendo, N = Nu = 1.
Sao apresentados nas figuras 5.25, 5.26 e 5.27, respectivamente a resposta das variáaveis de processo, as vazõoes de alimentaçcõao e as vazõoes de saáda do separador, e as eficiâencias e concentraçcõao de áoleo no underflow do hidrociclone.
i ”06sJ''\pAAM/'AAAAAAAAAAAA/\.z'xy-Xy''x.-.

1
1
I
20
tempo (horas)
I

30
35



1
1
l
30
l
35
30
35
20
tempo (horas)




Figura 5.25: Variáveis de Processo
Figura 5.26: Vazões e alimentaçáo e saída do separador

i	i	i	i
xÂ7Ma/WWwvvvvvV\Aa^
_'___I___I____I____L_




20
tempo (horas)



â 0.68
05	0.66
x 10-6
4]------
J I I I
5	10	15	20
tempo (horas)
L
1
L
O Z 2 o o
1
1
1
I
20
tempo (horas)
L
1
1





Figura 5.27: Eficiências e concentraçao de áleo no underflow do hidrociclone
Analisando os gráficos apresentados acima é possivel verificar que apesar do controlador PNMPC fornecer uma vazãao constante por longos períodos de tempo para o hidrociclone, a eficiância de separacão deste equipamento se torna mais oscilatoria que na metade do ensaio onde atua o controle por bandas. Isso se deve ao fato que o controlador PNMPC permite uma oscilaçao do nível de agua do separador ao longo de toda faixa, o que acarreta uma variaçcãao na distribuiçcaão de gotas na saída do separador.
Na figura 5.28 sao apresentadas as distribuicoes de gotas na saída do separador em trâs instantes de tempo. Nota-se que quando o nível esta próximo ao limite inferior da faixa (tempo de 29horas) aumenta o volume de gotas de oleo na saída do separador, e quando ocorre a situacão contraria, ou seja, nível de agua proximo ao limite superior da faixa o volume de gotas de oleo diminui (tempo de 35horas). Deve-se ressaltar que para os trâes instantes de tempo que foram apresentadas as curvas de distribuiçao de gotas a vazao de alimentacão é a mesma, como pode ser visto na figura 5.26.
Figura 5.28: Distribuição das gotas na saída do separador trifasico
Com base na análise realizada anteriormente conclui-se que o ideal é assumir um compromisso entre a largura da faixa utilizada e o amortecimento das oscilacoes na vazao de saída do separador. Dessa forma acredita-se que í possível chegar a um ponto onde não haja uma varia-cão significativa na distribuyo de gotas de oleo na entrada do hidroci-clone e consequentemente a oscilacão das eficiencias e concentraçao de oleo no underflow seja mínima.
Foram realizados dois ensaios onde a largura da faixa de oscilacçãao permitida para o nível de ígua foi alterado de forma a verificar o efeito na separação do hidrociclone. Sao apresentados nas figuras 5.29, 5.30 e 5.31 os resultados gráficos obtidos utilizando uma largura de faixa igual a 0, 2m.
1
8 10
tempo (horas)
0	2	4	8	8	10	12	14	18	18
tempo (horas)










□

0	2	4	8	8	10	12	14	18	18
tempo (horas)
Figura 5.29: Variaveis de Processo
f
í
8	10	12	14	18	18
tempo (horas)



X/

Figura 5.30: Vazões e alimentação e saída do separador
0	2	4	6	8	10	12	14	16	1t
tempo (horas)
Figura 5.31: Eficiências e concentração de óleo no underflow do hidrociclone
Sao apresentados nas figuras 5.29, 5.30 e 5.31 os resultados gráficos obtidos utilizando uma largura de faixa igual a 0,1m.
tempo (horas)
Figura 5.32: Variáveis de Processo
i
f
a	10	12	14	16	18
tempo (horas)
Figura 5.33: Vazoes e alimentaçao e saída do separador
L
L
L
J I
8	10
tempo (horas)
1
l
1
066
L
L
L
J I
8	10
tempo (horas)
1
1
1
1
O
Z 1 -o o

L
L
L
J I
8	10
tempo (horas)
1
1
1
1










Figura 5.34: Eficiências e concentração de oleo no underflow do hidrociclone
Analisando os resultados apresentados anteriormente á possível verificar que a medida que a largura da faixa é reduzida, diminui o amortecimento das oscilações na vazão de saída de agua do separador, porem reduz a oscilacao das eficiências de separacao do hidrociclone e consequentemente da concentracão de oleo no underflow.
Acredita-se que uma solucçãao seja utilizar uma camada de otimi-zaçao superior que forneça ao controlador PNMPC a largura de faixa que maximize a eficiêencia de separaçcãao do hidrociclone. Porem realizar uma otimizaçcaão no modelo da eficiêencia do hidrociclone pode ser uma
5.4. Controle do Sistema Integrado (Separador + Hidrociclone)
tarefa árdua uma vez que os cálculos são de grande complexidade.
Sao apresentados em [40] e [28] correlaçães que relacionam a variação da vazão de alimentacão e da razao de split no hidrociclone com a eficiência de separacão. Porám essas correlações assumem uma curva de distribuição de gotas de áleo na entrada do hidrociclone constante. Sugere-se para trabalhos futuros o desenvolvimento de uma correlaçao que relacione a variação do nível de agua no separador, a vazão de alimentaçao do hidrociclone e a razão de split no mesmo com a eficiencia de separaçao. Acredita-se que com uma equação simplificada que possua estas características seja possível implementar a camada de oti-mizaçao proposta. Uma outra alternativa a ser estudada á a variacão do split de forma a compensar os efeitos de variaçcaão da distribuiçcaão de gotas na entrada do hidrociclone.
5.4.1	Comentarios Finais
Neste capítulo foram apresentados os resultados dos ensaios de controle realizados em um primeiro momento somente com o separador e posteriormente com o sistema integrado. Foi realizada uma análise comparativa entre os controladores visando apontar o que obteve melhor desempenho. Foram constatados problemas referentes a oscilaçcãao da eficiêencia de separacçaão do hidrociclone e propostas para resoluçcãao deste foram apresentadas. No práoximo capátulo serãao abordados aspectos teóricos e aplicaçao do controlador PI com sintonia via MPC por zonas.
100
5. Resultados de Simulaçao
Capítulo 6
Controlador PI com sintonia via MPC por Zonas
No capítulo anterior foram apresentados os resultados obtidos com os controladores PNMPC e PI por bandas. No presente capítulo se-rao apresentados os princípios teóricos do controlador PI com sintonia via MPC por zonas e experimentos praticos aplicados ao controle do separador trifasico. Este controlador foi concebido com o intuito de proporcionar as mesmas características do controle MPC por zonas a um controlador PI, desse modo é possível obter um controlador simples e eficiente.
6.1	Fundamentação Teárica
Sera apresentado nesta seção o procedimento de sintonia do controlador PI utilizando o procedimento de otimizaçcãao de um controlador MPC por zonas. De acordo com [24], é possivel obter a sintonia de controladores classicos atraves do preditor utilizado pelo algoritmo GPC. A ordem do controlador esta diretamente ligada a ordem do modelo utilizado, assim, para um modelo de primeira ordem o controlador resultante e um PI.
Para realizar este procedimento e necessario um modelo linear. Porem no controle por zonas, é permitido que o processo funcione dentro de uma faixa, ao inves de um unico ponto de equilíbrio. Neste caso
o mais apropriado é a utilização de um modelo nao linear que pode representar melhor o processo em toda sua faixa de funcionamento. Como visto o controlador PNMPC realiza o procedimento de linearização do modelo não linear a cada período de amostragem. Em uma tentativa de adicionar as características do controlador PNMPC por Zonas ao controlador PI, serão utilizados três modelos linearizados nos limites superiores e inferiores da zona e num ponto intermediíario entre os limites da zona.
De acordo com o apendice B, o modelo linearizado simplificado do separador trifíasico íe descrito por
0
K22 s
0
0
0
K33
	■ Wout ■
	GOUÍ
	Gout
(6.1)
s
sendo que o valor dos ganhos das funçães de transferências podem variar de acordo com o ponto de equilíbrio onde ocorre a linearização.
O controle por zonas e utilizado somente no nível de água e óleo, sendo que a pressaão íe mantida constante por um controlador PI de setpoint fixo. O desenvolvimento matemíatico para a sintonia do controlador PI via MPC sería demonstrado apenas para uma das funcçãoes de transferêencia da matriz de transferêencia apresentada na equacçãao 6.1.
Assume-se que o processo á descrito pela seguinte função de trans-ferêencia
G(s) = -	(6.2)
s
Discretizando tem-se
G(z) =	(6.3)
1 — z 1
Como o controlador GPC utiliza o modelo CARIMA, então o modelo íe reescrito
A(z-1)y(t) = B(z-1)z-du(t — 1) + TDZz-i)A	(6.4)
onde A = 1 — z-1, d áo atraso de transporte e e(t) á um ruído branco. Os polinêmios T(z-1) e D(z-1) representam a característica estocáastica do ruádo e como saão difáceis de serem estimados na práatica, í comum utilizar T(z-1) = 1 e D(z-1) = 1. Neste caso a equacao 6.4
pode ser reescrita como
A(z-1)y(t) = B(z-1)z-d Au(t — 1) + e(t)	(6.5)
onde A(z-1) = AA(z-1). Para o modelo da equacão 6.3 temos A(z-1) = (1 — z-1)(1 — z-1) = 1 — 2z-1 + z-2, B(z-1) = Kd = b0 e d = 0.
As predicães podem ser obtidas resolvendo seguinte equacão Di-ofantina
1= A(z-1)E3 (z-1) + z-jFj (z-1)	(6.6)
onde Ej (z-1) possui o grau j — 1 e Fj (z-1) possui o grau na.
Resolvendo recursivamente a Diofantina N vezes, onde N é o horizonte de predição, obtem-se
y(t + i|t) y(t + 2|t)	= G	Au(t) Au(t + 1)	+ H	Au(t — 1) Au(t — 2)
_ y(t + N|t) _		Au(t + N — 1)		Au(t — nb)
(6.7)
y(t|t) y(t - i|t)
y(t — na\t)
onde G, H e S são matrizes constantes com dimensães N x N, N x nb e N x na +1. Como no modelo da equação 6.5 tem-se nb = 0, as prediçcãoes nãao dependem dos valores passados de Au e H = 0.
De acordo com [24] a função objetivo a ser minimizada é descrita por
J = (Gu + Syi — w)T Qs (Gu + Syi — w) + uTQ\u	(6.8)
onde Qs e Q\ sao matrizes de ponderação diagonais com os elementos 5(j) e X(j) respectivamente.
Minimizando J em relação a u, tem-se
onde M = GTQsG + Qx e P2 = GTQs são de dimensão N x N e Po = -GTQsS possui dimensão N x nb.
Em um algoritmo de receding horizon é calculado somente o valor de Au(í), e se mea primeira linha da matriz M, Au(í) é dado por
Au(t) = mPoy1 + mP2w	(6.10)
onde mPo = [lyily2 ■ ■ ■ lyna+i] e mP2 = [ff ... fN]. Os coeficientes ly e f sao função de a¿, bj, N, 5i e A¿.
Segundo [24] a função de transferencia discreta do controlador PI e dada por
C (z) = -
lyi + iy2 z 1
1- z-1
(6.11)
O controlador da equação 6.11 pode ser representado pela seguinte equacçãao a diferençcas
u(k) = u(k — 1) + qoe(k) + qi e(k — 1)	(6.12)
onde qo = — lyi e qi = —ly2.
No controle MPC por zonas a matriz de ponderação Qs é zerada se a variavel controlada esta dentro da faixa e assume um valor ajustado se a variavel controlada sai para fora da faixa. O efeito obtido com esta tecnica e que dentro da faixa o controle fica ”‘livre”’, ou seja, em malha aberta e permite a oscilacão da variavel controlada. Fora da faixa o controlador pondera o erro sendo que o setpoint e o limite da faixa, nessa situacçãao o controle e feito em malha fechada.
Este conceito pode ser traduzido para a sintonia do controlador PI, sendo que para o modelo linearizado dentro da faixa a matriz de ponderação Qs é zerada, logo M = Q\, P2 = 0 e Po = 0, o que implica nos coeficientes ly1 = ly2 = 0 e a equacao 6.12 é reescrita como
u(k) = u(k — 1)	(6.13)
Nota-se que na equacçãao 6.13 nãao e considerado o erro entre a variavel de processo e um setpoint. Enquanto a variavel controlada estiver dentro da faixa o controle sera constante e igual ao valor anterior, o que consiste em operar o processo em malha aberta.
Para os dois modelos linearizados nos limites superiores e inferiores da faixa, o controlador obtido é o mesmo da equaçao 6.12. Neste caso o controle e realizado em malha fechada da mesma forma que o MPC por zonas. Para implementar esta estrategia de controle se faz necessario um controle supervisorio que monitora o valor da variavel
controlada e determina qual das açcãoes de controle deve ser aplicada.
6.2	Ensaio com PI com sintonia via MPC por Zonas
A seguir sãao apresentados os resultados obtidos no ensaio realizado utilizando o controlador PI com sintonia via MPC por zonas. O ajuste dos parêmetros do controlador á apresentado na tabela 6.1. Para a sintonia dos parêametros do controlador foram utilizados os mesmos horizontes e ponderações do controlador PNMPC por zonas (tabela 5.5 do capátulo 5). Esta tecnica de controle foi aplicada somente aos náveis da aágua e do áoleo, sendo que para pressãao foi utilizado um controlador PI com setpoint fixo.
Tabela 6.1: Parâmetros de Ajuste do Controlador
Variaíveis	qo	qi
Dentro da Zona		
hw	0	0
hl	0	0
p	0.124366	—0.062195
Limite superior da Zona
hw	0.018277	—0.017027
hl	0.218717	—0.135130
p	0.124366	—0.062195
Limite Inferior da Zona		
hw	0.022873	—0.017027
hl	0.182294	—0.107990
p	0.124366	—0.062195
E apresentada na figura 6.1 a resposta das variáveis de processo com suas respectivas faixas. Na figura 6.2 sao apresentadas as vazoes de alimentação e as vazões de saáda.
12.4
12.2 -
11.8o
12
1
2
3
tempo (horas)


Figura 6.1: Variaveis de Processo
Figura 6.2: Vazões e alimentacao e saída do separador
A tabela 6.2 contém dados referentes às oscilações percentuais das vazões de entrada e saída do separador trifasico e a variancia das vazões de saída para cada ensaio de controle realizado. Foram utilizados os mesmos sinais das secao 5.1 para as vazões de alimentação do separador trifasico.
Tabela 6.2: Indices de Desempenho
Controlador	Vazao	Oscilacõo (%)	Variancia
	Win	21, 01	-
-	Lin	15, 29	-
	Gin	32, 45	-
	Wout	3, 74	1,4793 • 10-10
PI via MPC	Lout	36, 06	2,2177•10-6
	Gout	32, 45	2,3666•10-4
	Wout	4, 00	5, 7803 • 10-9
PNMPC Zona	Lout	31, 00	2, 5111 •10-6
	Gout	32, 45	1,4590 • 10-4
	Wout	6, 27	3,5313•10-8
Bandas	Lout	65, 76	1,5216•10-6
	Gout	32, 45	1,6118•10-4
Através dos dados apresentados na tabela 6.2 é possível verificar que o controlador PI com sintonia via NMPC por zonas obteve ótimos resultados com amortecimento das oscilacões com um fator de 5, 6 e uma variancia de 1, 4793 • 10-10. Se comparado com os resultados dos controladores apresentados no item 5.1.4, pode-se afirmar que este foi o controlador que obteve melhor desempenho no amortecimento de oscilações de carga.
A principal vantagem deste controlador e o fato de ser de facil implementaçõo, uma vez que nao exige otimizaçao online, e pode ser implementado em dispositivos programaveis como um CLP. A desvantagem deste controlador é que este nõo trata o problema de controle atraves de uma estrategia multivariével e nõo utiliza as restrições fésicas do processo. O controlador PI com sintonia via MPC por zonas pode ser uma alternativa ao controlador PNMPC por zonas em situaçoes onde o poder computacional seja limitado.
6.3	Comentarios Finais
Neste capétulo foi discutido o desenvolvimento matematico do controlador PI com sintonia via MPC por zonas. Foi realizado um ensaio de simulaçcõao onde o controlador foi aplicado ao separador triféa-sico com o objetivo de amortecer as oscilaçcoões de carga. Os resultados dos ensaios de controle se mostraram promissores e os éndices de de
sempenho obtidos foram melhores que os dos controladores do capítulo anterior. O desenvolvimento deste controlador é uma das principais contribuições deste trabalho e mostra um grande potencial para sua aplicacão na industria do petréleo, uma vez que é de fécil implementa-cõo e baixo custo computacional.
Capítulo 7
Conclusão
Este trabalho aborda o estudo e o controle de processos de se-paraçcaõo trifaésica e tratamento de aégua presentes em uma plataforma de producçõao de petréoleo. Este processo ée composto por um separador trifésico e uma bateria de hidrociclones conectada na saída de égua do separador. Foram desenvolvidas duas estrategias de controle, sendo a primeira baseada no controlador préatico preditivo nõao-linear conhecido como PNMPC. Este controlador se difere de outros controladores preditivos nõao lineares pelo fato de realizar a linearizaçcaõo do sistema independentemente do ponto de equilébrio. Foram abordados os métodos para utilização de restrições hard e soft em controladores preditivos, bem como a implementaçao do controle por zonas. Dois tipos de modelos de predicçaõo naõo-lineares foram estudados, sendo eles o modelo Hammerstein e um modelo fenomenologico simplificado do separador. Algumas ferramentas foram desenvolvidas com a finalidade de melhorar o tratamento das perturbações pelo controlador PNMPC, sendo elas o estimador de perturbaçcõoes, o preditor de perturbaçcõoes e o detector de perturbacçõoes. A segunda estratéegia de controle utilizada neste trabalho consiste de um conjunto de controladores PI com sintonia via MPC, a qual ée de grande simplicidade de implementaçcõao.
Foram realizados ensaios de simulaçcõao visando avaliar o desempenho dos controladores com o sistema operando sob o regime de golfadas e perturbaçcõoes do tipo degrau na alimentacçõao. Os resultados obtidos foram comparados com o controlador PI por bandas que ée atualmente utilizado pela Petrobras para o amortecimento de oscilaçcõoes de carga. Verificou-se em ambos ensaios que o controlador PNMPC por zonas utilizando o modelo fenomenoléogico obteve os melhores resultados.
As principais contribuicçoães deste trabalho seraão relacionadas a seguir:
•	Aplicação de controle preditivo não linear ao controle do separador trifísico e hidrociclone;
•	Identificacão de modelos Hammerstein do separador;
•	Desenvolvimento do estimador de perturbações;
•	Desenvolvimento do controlador PI com sintonia via MPC por zonas.
Com relaçcaão a utilizaçcãao do controlador PNMPC no controle de separadores e hidrociclones deve-se destacar que nãao existe na literatura registros da aplicaçcãao de um controlador preditivo nãao-linear a este problema. Este controlador apresentou bons resultados nas diferentes configuraçcãoes propostas o que torna grande candidato a sua aplicaçcaão no meio industrial. A identificaçcãao do modelo de Hammerstein alíem de contribuir na implementacçãao do controlador PNMPC se mostra inovadora, uma vez que na literatura sãao somente encontrados modelos caixa preta lineares do separador. O desenvolvimento do estimador de perturbaçcãoes possibilitou a utilizaçcaão dos valores estimados das vazãoes de alimentaçcãao pelo controlador PNMPC, uma vez que essas grandezas nãao podem ser medidas separadamente. Com o uso do estimador foram obtidos os melhores resultados de forma a melhorar o tratamento das perturbações pelo controlador PNMPC. Uma grande contribuição deste trabalho íe o desenvolvimento do controlador PI com sintonia via MPC por zonas, o qual teve por objetivo agregar as características do controle MPC por zonas a um controlador PI. Dessa forma foram obtidos íotimos resultados referentes ao amortecimento de oscilacçãoes, comparía-veis aos do controlador PNMPC e superiores aos do controlador PI por bandas. Uma vantagem deste controlador íe a simplicidade de imple-mentaçcãao podendo ser facilmente programado em dispositivos como os CLP's, o que o torna forte candidato a aplicaçães príticas e substituto do controlador PI por bandas.
Como contribuiçcãao para o estudo de controle avançcado de processos de separacçãao em plataformas de petroíleo, este trabalho gerou as seguintes publicacçãoes:
•	P. R. C. Mendes, R. L. Carvalho and J. E. Normey-Rico. Nonlinear predictive control applied to load oscillations damping in a three phase separator. Rio Pipeline Conference &amp;amp; Exposition, 2011, Rio de Janeiro/RJ - Brasil;
•	P. R. C. Mendes, J. E. Normey-Rico, A. Plucenio and R. L. Carvalho. Disturbance Estimator based Non Linear MPC of a Three Phase Separator. International Symposium on Advanced Control of Chemical Processes, 2012, Simgapore. (aceito para publicação)
•	P. R. C. Mendes, J. E. Normey-Rico, A. Plucenio. Controle PI com sintonia via MPC por zonas. XIX Congresso Brasileiro de Automética, 2012, Brasil. (submetido)
7.1	Diretrizes para Trabalhos Futuros
Os Processos de separaçcaão estudados neste trabalho representam somente uma parte dos equipamentos existentes em plataformas de petréoleo. Existe muito trabalho a ser realizado na aérea de modelagem fenomenoléogica dos processos envolvidos na separaçcãao e tratamento de éagua, oéleo e géas. Pensando nisto, elaborou-se uma lista de posséveis temas de pesquisa a serem realizadas futuramente com o objetivo de estudar melhor o comportamento dos processos de uma plataforma de producçãao de petréoleo, simulaé los em ambiente computacional e estudar téecnicas de controle eficientes.
•	Testar o desempenho do controlador PNMPC perante a um sistema mais realéstico de tratamento de éagua apresentado em [40]. Este sistema ée composta pelo separador triféasico e por trêes tipos diferentes de hidrociclones, o BOW (Bulk Oil-Water Cyclone), o PDC (Pre Deoiler Cyclone) e o De-oiler.
•	Avançcar nos estudos de modelagem fenomenoléogica tentando adicionar ao modelo do separador triféasico os efeitos causados pelo fenêmeno de flashing. Dessa forma pode-se determinar a porcentagem de gaés que sai juntamente com a vazãao de oéleo e a quantidade de oéleo dispersa na vazãao de saéda de géas. Com esse céalculo seréa possével acoplar mais vasos separadores em séerie, possibilitando simular um esquema de separaçcãao em trêes etapas.
•	Acoplar o conjunto separador bifaésico e tratador eletrostaético na saéda de éoleo do separador triféasico e efetuar seu controle.
•	Desenvolver uma correlacçãao que relacione a variaçcãao do nével de éagua no separador com a vazãao de alimentaçcãao, a razãao de split e a eficiência de separação do hidrociclone.
•	Realizar ensaios com uma camada de otimizaçao que forneça a largura de faixa ou set-point de split para o controlador PNMPC.
•	Realizar ensaios com a presença de ruido nas variáveis controladas para verificar a robustez do estimador de perturbaçães perante a presençca de ruidos.
•	Avaliar o desempenho dos controladores propostos com os índices apresentados nos trabalhos de [12] e [49].
•	Utilizar os metodos de deteccão de estado estacionário apresentados em ([19], [20] e [21]), e comparar seu desempenho com o detector de perturbaçcãoes proposto neste trabalho.
•	Comparar o desempenho dos controladores propostos com o controlador apresentado em [4] e [3].
Apêndice A
Parâmetros de
Simulação
Separador Trifaásico
Dimensães do separador:
Ccs = 4,4m Cd = 1,0m D = 1, 8m hchic = 0, 867m Cchic 07 9m hplaca 07 0017m B = 1,4m Cplaca = 47 2m
Parâmetros fisico-quimicos:
T = 360K
MWg = 16, 48 pw = 965kg/m3 pi = 855kg/m3 dl = 0, 855 dw = 0, 965 dg = 16,4/29 Yi = 855kgf/ m3 Yw = 965kgf/m3 pw = 0, 001kg/m/s pi = 0, 0171kg/m/s
pjus = 1, 0kgf/cm2 pcomp = 8, 5kgf /cm2
Dados das vólvulas:
Cvmaxi = 44, 43 Cvmaxw = 36, 70
Cvmaxg	74, 05
sw	5
si =0, 5 sg = 0, 5
Condicões na alimentação:
BSW =0,1
TOG = 0,13
Win = 0, 0133m3/s
Lin = 0,0167 m3/ s
Gin = 0, 1300m3/s Dp$o = 100p,m par = 3
Condições iniciais: ht = 0, 9143m hw = 0,4976m hl = 0, 4931m
Vwfics = 0,0228m3
Vffwcs = 0,0002m3
Vw fici = 0,0040m3 p = 12kgf /cm2
Hidrociclone
Dimensoes do hidrociclone: Rc = 0,0175m a = 0, 0015m
L = 1, 337m rela = 0, 35
Parametros fisico-quimicos: pw = 965kg/m3 pi = 855kg/m3 di = 0, 855
dw = 0, 965 gw = 0, 001kg/m/s
Outros parametros:
ftr = 0,4
a1 = 780
a2 = 50000
Valvulas de controle:
Cvmaxo
Cvmaxu
1, 85
45
so = 0, 5
su = 0, 5
Pressoes:
Po = 1, 0kgf /cm2 Pu = 1, 0kgf/cm2 APo = 3, 5kgf/cm2 APU = 3, 5kgf/cm2
Pi = 10kgf/cm2
Valor desejado de R:
= 2, 5
116
A. Parametros de Simulaçao
Apêndice B
Linearização do Modelo
Simplificado do
Separador
Aseguir serão apresentados os passos para a linearizacao do modelo simplificado do separador trifísico. O modelo linearizado í importante para a sintonia do controlador PI com sintonia via MPC por zonas apresentado no capítulo 6. Como apresentado no item 4.3, o modelo fenomenolígico do separador trifísico í constituído pelas equaçães (B.1), (B.2), (B.3) e (B.4).
I	Lweir Wout	(b i )
~dt _ 2 • Ccs	(D - ht)	( . 1
dhw   f  	Wout	(B 2)
_ 1 _ 2 • Ccs ^h~( D - hw)	( . 1
dhl	Lweir	Lout
~dt _ f2 _ 2 • Cci • ^hi • (D - hi)	( . 1
dp	(Gin + Win + Lin	G out	Wout	^out1 ' p
dt _ f3 _
(B.4)
Vt - Vd - Vcs
Para utilizacçãao na sintonia do controlador PI com sintonia via MPC por zonas íe nessessíario somente um modelo linear que relacione as três entradas do processo, no caso as vazães de saída, com as três
saídas do processo. Este modelo é representado na equação B.5.
hw		Gii 0	0		’ Wout ’
hl	=	0	G22	0		Lout.
p		G31	G32 G33		G out
Nota-se na matriz de transferencia que o sistema possui acoplamento somente entre as três entradas com a pressao no separador. Como as vazões de saáda de água e áleo sao utilizadas á utilizada para controlar respectivamente os níveis de água e áleo, a unica entrada disponível para controlar a pressão é a vazão de saáda de gás. Portanto para fins de sintonia do controlador pode-se admitir uma simplificaçcaõo no sistema linearizado como apresentado na equação B.6.
hw		Gii	0	0		■ Wout ’
hl	=	0 G22	0		Lout
p		0	0	G33		Gout
z
B.1 Linearização do Balanço de .Agua no Separador
Nota-se que a equação B.2 apresenta três variáveis dinâmicas, ou seja, que variam com o tempo (Win, Wout, hw). Como só interessa um modelo que relacione a entrada com a saáda áe somente necessáario derivar a equacão B.2 em relacão a (Wout, hw). Assim tem-se:
dWout	2 • Ccs •	hw • (D — hw)
df1 _ —((D — 2 • hw) • (Win — Wout))	(B 8)
dhw 4 • Ccs •y/(hw • (D — hw))3	( . )
A expansao da equacão em serie de Taylor é dada por:
= fLIN = f+f	• (Wout — Wout) + f • (hw — hw) (b.9)
dt	dW out	dhw
Definindo a equação em variéveis desvio com relação a um estado
estacioníario:
' dfi '	dfi	'
fi =	■	- • Wo.t +
Separando as variaveis:
dhw	w
(B.10)
f'- dfi -h =
f 1	hw
• w' t
JL	dhw	w	dWout	out
A fim de simplificar a notação, omitiu-se o símbolo (), porém as variáveis continuam em desvio em relação ao estado estacionario. Aplicando a transformada de Laplace tem-se:
(B.11)
hw (s) • s - hw (s) •	= df1	• ^bout(s)
dhw	dWout
Rearranjando os termos em forma de funções de transferência:
(B.12)
dfi
G11 =	(b.13)
S	dhw
Ao substituir os valores de equilíbrio na equação B.13, sendo que é realizada a suposição que Win = Wout, tem-se que o termo do denominador dh1 e zerado, o que implica na seguinte função de transferência:
Gii
Kii
s
(B.14)
onde
Kii =
dfi dWout
-1
2 • Ccs • \/hw • (D	hw)
(B.15)
B.2
z
Linearização do Balanço de Oleo no
Separador
Da mesma forma como realizado na seção anterior a equação B.3 sera diferenciada em relação a (Lout, hl). Assim tem-se:
df2 =	-1 Lout	2 • Cci • \/hi • (D - hi)	(B.16)
df2	(Lout	Lweir) • (D	2 • hl) dhi	4. Cci^ V(hi -(D - hi))3	(B.17)
A expansão da equação em série de Taylor definida em variáveis desvio com relação a um estado estacionario é dada por:
,'	df2	' _ df2	'
f2 —	• hl —	' L out
dhi	dLOut
(B.18)
Aplicando a transformada de Laplace tem-se:
hi(s) • s — hi(s) •	—	• Lout(s)	(B.19)
dhl	dLout
Rearranjando os termos em forma de funçoes de transferencia:
df2
G22 =	(B.20)
- + h
Supondo Lin = Lout no equilibrio resulta a equacao B.20 é simplificada como:
G22
K22
s
(B.21)
onde
df2 _ ____________—1___________
Lout 2 • Cci • y/hi • (D — hi)
(B.22)
B.3 Linearização do Balanço de Gás no Separador
De forma análoga das seçoes anteriores a equação B.4 seré diferenciada em relacão a (Gout, p). Assim tem-se:
df~3 =_________p_______	(b 23)
dGout = Vci + Vcs - Vt	( . )
df3   (Gin + Win + Lin	G out	~Wout	Lout)
~dp _	Vt — Vci — Vcs
A expansõo da equaçõo em sárie de Taylor definida em variáveis desvio com relaçao a um estado estacionário é dada por:
dp
df3 dGout
• Gout
(B.25)
Aplicando a transformada de Laplace tem-se:
P(s) • s - p(s) •	• Gout(s)	(B.26)
dp	dGOut
Rearranjando os termos em forma de funções de transferência:
dp/dt
G33 =
dGout s . dp/dt s + dp
(B.27)
Supondo Gin = Gout no equilíbrio resulta a equacão B.27 é simplificada como:
s
(B.28)
onde
df3 dG out
p
Vcl + Vcs - Vt
(B.29)
B.4 Modelo Linearizado
O modelo linearizado completo é apresentado na equação B.30.
hw	K
hl	=	0
p0
0
K22 s
0
0
0
K33
s
	■ Wout ’
	Lout
	G Gout
(B.30)
122 B. Linearizaçao do Modelo Simplificado do Separador
Apêndice C
Controle PI por Bandas
O controle por bandas, sugerido por [27], tem a característica principal de levar em conta que os separadores de operaçcãao sofrem contínuas mudancças de estratíegia, sendo alinhados diferentes poçcos segundo as conveniências do momento. Dessa forma as vazoes de carga mudam permanentemente e isso requer mudançcas no valor desejado do sistema. Nessa proposta usa-se uma forma de inferir as perturbaçcãoes baseadas nos movimentos da vílvula de controle. Segue uma analise preliminar desse controlador por bandas.
O modelo utilizado íe
' — O - O
— Oin	O out
dt
(C.1)
sendo Qm a vazao de alimentacão e Qout a vazão de saída. Atravís da equaçcaão da víalvula obtíen-se Oout
0out u • c
v
(C.2)
Este modelo não considera o peso da coluna de líquido para um vaso (o que faz sentido em vasos sob pressão)
—h	/
C • D • — — Oin - u • Cv -JÃP dt
(C.3)
E argumentado, corretamente, que a vazão de saída deve ser igual ao valor medio da vazão de entrada. Como esta não é medida, tem que ser inferida. Essa inferência é feita através do préprio modelo, baseado nas medidas do nível e da vazãao de saída.
,	dhm
Qin = C • D • — + QXt	(C.4)
O valor médio é calculado ao longo de um certo período de tempo, que neste caso e considerado o período com que acontecem as golfadas. Calculando a transformada de Laplace da equação resultante tem-se que o valor desejado (setpoint) de um controlador que determina a vazão de saída do vaso e dado por
C • D
T
QdUs) =
• (1 _ e-Ts) • hm(s) +
(1 - e-Ts )
T- s
QZt(s)
(C.5)
Considerando que se consegue um controle perfeito
QXt(s) = QL(s) = u(s) • Cv
(C.6)
Substituindo na equação C.5, gera-se uma lei de controle que depende apenas da medição de nível.
u
C • D
T
(s) • Cv
• (1 _ e-Ts) • hm(s) +
(1 _ e-Ts)
T- s
• QXt(s)
(C.7)
Adota-se um controlador proporcional ao nível em substituição ao primeiro termo da equacão C.7 o que, em termos praticos, implica em corrigir as diferenças entre Qout e Qin por um valor proporcional ao acumulo de líquido no separador e não mais pela derivada do nível [27]. A lei de controle passa a ser
(1 _
u(s) = Kc • [hd(s) - hm(s)] +	) • u(s)	(C.8)
T • S
Isolando-se u(s), tem-se
T • s
u(s) = Kc • T------——T7 • [hd(s) - hm(s)]	(C.9)
Desta forma, valores altos de K propiciam menor filtragem do sinal de entrada (maior flutuação na vazão de saída). Por outro lado, os limites da banda são ultrapassados com menor frequência.
Uma simplificação a mais e possivel utilizando-se a aproximaçao de Pade:
2 - T • s
2 + T • s
e
—Ts
(C.10)
Substituindo (C.10) em (C.9) leva a equacão de um controle proporcional e integral em (C.11).
Kc •
T • s
T • s - 1 + e-Ts
= K • (1 +
T2. )
(C.11)
Neste caso, o tempo integral Ti é T/2. Esta aproximação da bons resultados e simplifica muito a implementaçao, uma vez que se pode utilizar o controlador de nével PID, existente em todas as plantas. Eé importante ter em mente que neste caso naão se deve limitar a integral (reset wind-up) e sua janela de atuação deve ser igual ao peréodo T.
Portanto, o sistema de controle é acrescentado de uma açao hierarquicamente superior que enquanto o nével estiver dentro da banda a sintonia do PI é ajustada de forma a permitir a oscilacão do nével dentro da banda. Quando o nével do vaso ultrapassa os limites da banda, ée assumida uma sintonia mais dréastica para o controlador PI, que se encarrega de levar o sistema ao seu valor desejado, dentro da banda. A sintonia do PI, quando o nével esté dentro da banda, é realizada de forma que a vazão de saéda seja a media dos valores da golfada na vazão de alimentacão e os parâmetros devem ser ajustados de forma que Kc = K e Ti = T/2.
126
C.	Controle PI por Bandas
Referências
B ibliográficas
[1]	C. Bordons and J. R. Cueli. Predictive controller with estimation of measurable disturbances. application to an olive oil mill. Journal of Process Control, 14:305-315, 2004.
[2]	E. F. Camacho and C. Bordons. Model Predictive Control. Springer, Berlin, 2004.
[3]	M. C. M. Campos and A. Texeira. Os benefícios e desafios da aplicacão de técnicas de controle avançado e otimização em tempo real em unidades marítimas de produçao. VI Congresso Rio Automação, 2011.
[4]	M. C. M. Campos, L. A. Costa, A. E. Torres, and D. C. Schmidt. Controle avançcado dos níveis dos separadores de plataformas de produção. I Congresso de Instrumentação, Controle e Automação da PETROBRAS, 2008.
[5]	D. S. S. Casillo. Controle Preditivo Não-Linear Baseado no Modelo de Hammerstein com Prova de Estabilidade. PhD thesis, Universidade Federal do Rio Grande do Norte, 2009.
[6]	A. A. R. Coelho and L. S. Coelho. Identificação de Sistemas Dinâmicos Lineares. Ed. UFSC, Florianópolis, 2004.
[7]	E. Eskinat, S. H. Johnson, and W. L. Luyben. Use of hammerstein models in identification of nonlinear systems. AIChE Journal, 37: 255-268, 1991.
[8]	N. G. T. Filgueiras. Modelagem, aníalise e controle de um processo de separacao Oleo/égua. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 2005.
[9]	M. J. P. Garcia, J. E. Normey-Rico, and E. Camponogara. Nonlinear model based predictive controller of a buck boost converter. Proceeding of the 16th IFAC World Congress, 1, 2005.
[10]	J. M. Godhavn, M. P. Fard, and P. H. Fuchs. New slug control strategies, tuning rules and experimental results. Journal of Process Control, 15:547-557, 2005.
[11]	S. Hovland. Soft constraints in explicit model predictive control. Master's thesis, The Norwegian University of Science and Technology, Trondheim, 2004.
[12]	S-L. Jâmsa-Jounela, R. Poikonen, and K. Halmevaara. Evaluation of level control performance. 15th IFAC Triennial World Congress, Barcelona: Spain, 2002.
[13]	D. O. Azevedo Jr. and O. A. Z. Sotomayor. Controle de escoamentos no regime de golfadas em processos de produçcaão de petroleo. Mecánica Computacional, XXIX:8447-8461, 2010.
[14]	C. A. Corrâea Junior. Desenvolvimento de modelo computacional de previsãao de quebra de gotas em simulador de separaçcãao de oleo e agua em um hidrociclone. Master's thesis, Programa de Pos-Graduacçãao em Modelage Computacional do Instituto Politecnico da Universidade do Estado do Rio de Janeiro, Rio de Janeiro, 2008.
[15]	M. Kim, S. H. Yoonand, P. A. Domanski, and W. V. Payne. Design of a steady-state detector for fault detection and diagnosis of a residential air conditioner. International Journal of Refrigeration, 31:790-799, 2008.
[16]	L. Ljung. System Identification, Theory for the User. PrenticeHall, Englewwod Cliffs, NJ, 1999.
[17]	L. Ljung and T. Glad. Modelling of Dynamical S’ystems. PrenticeHall, Englewwod Cliffs, NJ, 1994.
[18]	J. M. Maciejowski. Predictive Control with Constraints. Prentice Hall, New Jersey, 2002.
[19]	R. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Avaliaçcãao do desempenho de metodos de identificaçcaão de estado estacionario. XVIII Congresso Brasileiro de Automática, 2010.
[20]	R. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Contribuição para o ajuste automãtico de tecnicas de identificação de estado estacionãrio. XVIII Congresso Brasileiro de Automática, 2010.
[21]	R. I. G. Mejia, M. B. Duarte, and J. O. Trierweiler. Identification de estado estacionario basada en la estimativa de la autocorrelation local. Bolivian Engineering and Technology Congress - BETCON, 2010.
[22]	C A. C. Moraes. Modelo fluidodinâmico para a estimativa de eficiencia em hidrociclones para Aguas oleosas. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 1994.
[23]	O. Nelles. Nonlinear S’ystem Identification. Springer, Berlin, 2001.
[24]	J. E. Normey-Rico and E. F. Camacho. Control of Dead-Time Processes. Springer, Berlin, 2007.
[25]	G. C. Nunes. Modelagem e simulação dinâmica do separador Agua/ Oleo/ gas. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 1994.
[26]	G. C. Nunes. Design and Analysis of Multivariable Predictive Control Applied to an Oil-Water-Gas Separator: A Polynomial Approach. PhD thesis, University of Florida, 2001.
[27]	G. C. Nunes. Controle por bandas: Conceitos basicos e aplicação no amortecimento de oscilaçcãoes de carga em unidades de produçcãao de petroleo. Technical report, Comunicaçcãao Tecnica - PETROBRAS, 2004.
[28]	G. C. Nunes, J. L. Medeiros, and O. Q. F. Araújo. Modelagem e Controle na Produção de Petróleo - Aplicações em MATLAB. Blucher, Sãao Paulo, 2010.
[29]	I. D. o. Corrâa. Controle preditivo do nível de agua em um tanque pressurizado. Technical report, Projeto de Graduação - Universidade Federal do Espirito Santo, 2005.
[30]	C. Paoli, C. Voyant, M. Muselli, and M-L. Nivet. Solar radiation forecasting using ad-hoc time series preprocessing and neural networks. In De-Shuang Huang, Kang-Hyun Jo, Hong-Hee Lee, Hee-Jun Kang, and Vitoantonio Bevilacqua, editors, Emerging Intelligent Computing Technology and Applications, volume 5754, pages 898-907. Springer Berlin / Heidelberg, 2009.
[31]	A. Pawlowski, J. L. Guzmán, F. Rodríguez, M. Berenguel, and J. Sánchez. Application of time-series methods to disturbance estimation in predictive control. IEEE Symposium on Industrial Electronics, Bari: Italy, pages 409-414, 2010.
[32]	A. Pawlowski, J. L. Guzmán, F. Rodríguez, M. Berenguel, and J. E. Normey-Rico. Predictive control with disturbance forecasting for greenhouse diurnal temperature control. 18th IFAC World Congress, Milano: Italy, pages 1779-1784, 2011.
[33]	A. Plucenio. Desenvolvimento de Técnicas de Controle Não Linear para Elevaçao de Fluidos Multifésicos. PhD thesis, Programa de Pás-Graduação em Engenharia de Automaçao e Sistemas, DAS, Universidade Federal de Santa Catarina, 2010.
[34]	G. Prasath and J. B. Jorgensen. Soft constraints for robust mpc of uncertain systems. International Symposium on Advanced Control of Chemical Processes, 7, 2009.
[35]	G. Reikard. Predicting solar radiation at high resolutions: A comparison of time series forecasts. Solar Energy, 83:342-349, 2009.
[36]	C. H. P. Ribeiro. Simulaçao e avaliação de controle preditivo aplicado a sistemas de tratamento primario de petroleo. Technical report, Monografia de Graduaçao - Universidade Federal do Rio de Janeiro, 2009.
[37]	S. M. Ross. Introduction to Probability Models. Elsevier, Berkeley, California, 2007.
[38]	J. E. S. Santos. Controle Preditivo Ndo Linear para Sistemas Ham-merstein. PhD thesis, Universidade Federal de Santa Catarina, 2007.
[39]	Scandpower. Users Manual OLGA 2000. Kjeller: Norway, 2003.
[40]	M. A. C. R. Silveira. Controle de um processo de tratamento primário de petráleo. Master's thesis, COPPE/UFRJ, Rio de Janeiro, 2006.
[41]	I. Skrlanc and D. Matko. Fuzzy Predictive Controller with Adap-tative Gain. Advances in Model-Based Predictive Control. Oxford University Press, Oxford, 1994.
[42]	O. J. M. Smith. Close control of loops with deadtime. Chemical Engineering Progress, 53:217-219, 1957.
[43]	O. A. Z. Sotomayor, D. Odloak, and L. F. L. Moro. Closed-loop model re-identification of processes under mpc with zone control. Control Engineering Practice, 17:551-563, 2009.
[44]	Y. Tan and R. Keyser. Neural Network Based Predictive Control. Advances in Model-Based Predictive Control. Oxford University Press, Oxford, 1994.
[45]	L. T. A. Teixeira. Controle de oscilações em sistemas de elevação artificial de petróleo por injeção contínua de gás (gas-lift). Technical report, Trabalho de Conclusão de Curso, Departamento de Engenharia Elátrica/UFS, 2010.
[46]	F. F. Thomóe. Re-identificaçcãao de processos em malha fechada com mpc robusto. Technical report, Relatóorio de Estóagio - Universidade Federal de Santa Catarina, 2010.
[47]	J. E. Thomas. Fundamentos de Engenharia de Petróleo. Editora Interciência, Rio de Janeiro, 2001.
[48]	L. Wang. Model Predictive Control System Design and Implementation Using MATLAB. Springer, London, 2009.
[49]	J. Yu and S. Qin. Statistical mimo controller performance monitoring. part ii: Performance diagnosis. Journal of Process Control, 18:297-319, 2008.</field>
	</doc>
</add>