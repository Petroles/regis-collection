<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.24718</field>
		<field name="filename">9178_Beraldo_ValcirTadeu_D.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE ESTADUAL DE CAMPINAS

FACULDADE DE ENGENHARIA MECÂNICA

CIÊNCIAS E ENGENHARIA DE PETRÓLEO

  

 

Simulação por Linhas de Corrente com 
Compressibilidade e Variação Espacial e

Dinâmica de Composição de Óleo

Autor: Valcir Tadeu Beraldo
Orientador: Denis José Schiozer
Co-orientador: Martin Julian Blunt

01/2008



UNIVERSIDADE ESTADUAL DE CAMPINAS

FACULDADE DE ENGENHARIA MECÂNICA

DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO

Simulação por Linhas de Corrente com 
Compressibilidade e Variação Espacial e

Dinâmica de Composição de Óleo

Autor: Valcir Tadeu Beraldo
Orientador: Denis José Schiozer
Co-orientador: Martin Julian Blunt

Curso: Ciências e Engenharia de Petróleo

Tese  de  doutorado  apresentada  à  Subcomissão  de  Pós-Graduação  Interdisciplinar  de 
Ciências  e  Engenharia  de  Petróleo  (FEM  e  IG),  como  requisito  para  a  obtenção  do  título  de 
Doutor em Ciências e Engenharia de Petróleo.

Campinas , 2008
S.P. - Brasil





FICHA  CATALOGRÁFICA  ELABORADA  PELA 
  BIBLIOTECA  DA  ÁREA  DE  ENGENHARIA  E  ARQUITETURA  -  BAE  -  UNICAMP

    B45s
Beraldo, Valcir Tadeu
     Simulação por linhas de corrente com compressibilidade e 
variação  espacial  e  dinâmica  de  composição  de  óleo   /  Valcir 
Tadeu Beraldo. --Campinas, SP: [s.n.], 2008.

     Orientadores: Denis José Schiozer, Martin Julian Blunt
  Tese  (Doutorado)  -  Universidade  Estadual  de  Campinas, 
Faculdade de Engenharia Mecânica e Instituto de Geociências.

   1.  Reservatórios  (Simulação).   2.  Engenharia  de  petróleo  - 
Métodos  de  simulação.   3.  Reservatórios  -  Modelos 
matemáticos.  4. Compressibilidade.  I. Schiozer, Denis José.  II. 
Blunt,  Martin  Julian.   II.  Universidade  Estadual  de  Campinas. 
Faculdade  de  Engenharia  Mecânica.   III.  Instituto  de 
Geociências.  IV. Título.

Titulo  em  Inglês:  Streamline  based  simulation  with  compressibility  and  spatial  and 
dynamic variation of oil composition

Palavras-chave  em  Inglês:  Simulation,  Streamline,  Compressibility,  API  tracking, 
Compositional variation

Área de concentração: Reservatórios e Gestão
Titulação: Doutor em Ciências e Engenharia de Petróleo
Banca examinadora: Solange da Silva Guedes, Maria Cristina de Castro Cunha, Osvair 

Vidal Trevisan, Célio Maschio
Data da defesa: 19/03/2008
Programa de Pós-Graduação: Ciências e Engenharia de Petróleo

iii



Dedicatória

Esta tese é dedicada, com muito amor, à minha mãe, que foi quem apontou o caminho para 

eu chegar até aqui...

iv



Agradecimentos

Agradeço,  em primeiro  lugar,  à  minha  querida esposa,  Rita, por me  apoiar  em todos  os 

momentos; mesmo sendo obrigada a me “dividir com a tese” durante três anos e meio. Da mesma 

forma,  agradeço,  pela  minha  determinação,  aos  exemplos  de  meu  pai,  com  quem  tive  a 

oportunidade  de  compartilhar  momentos  inesquecíveis  nos  últimos  meses.  Agradeço  à  minha 

irmã, Sílvia, e ao Léo, assim como ao Marquinho, pelo imenso apoio. 

Agradeço  à  Petrobras,  por  proporcionar  esta  preciosa  oportunidade,  à  Unicamp  e  ao 

Departamento  de  Ciências  de  Terra  e  Engenharia  do  Imperial  College  de  Londres;  onde  fui 

extremamente bem acolhido, durante o ano em que lá permaneci.  

Aos integrantes da banca examinadora e aos meus orientadores, agradeço pela inestimável 

ajuda  na  condução  deste  trabalho.  Em  especial,  ao  Professor  Martin  Blunt,  por  apresentar 

ferramentas teóricas imprescindíveis, por autorizar a utilização de códigos de programação e por 

toda amizade e paciência demonstradas.

Na  Petrobras,  tenho  que  agradecer,  entre  muitas  outras  pessoas,  à  Maria,  do  Suporte 

Técnico, à Alba Regina e ao Juarez, da área de Recursos Humanos, e ao Bruno, dos Serviços 

Compartilhados.  Também  devo  agradecer  a  todos  os  meus  colegas  de  trabalho  e  amigos;  em 

especial: Solange, Eliane, João, Ana Augusta e Bogado, Fábio e José Roberto.

Na  Unicamp  agradeço  aos  professores,  funcionários  e  estagiários  do  Departamento  de 

Engenharia de Petróleo e a todos os colegas com quem tive oportunidade de conviver durante 

esses anos.

v



Na  Inglaterra,  fiz  grandes  amizades,  que  muito  ajudaram  a  mim  e  à  Rita,  em  nossa 

ambientação em um país estranho. Entre essas pessoas, gostaria de agradecer, em especial, ao 

Don,  à  Ruth  e à  Ran.  Também devo  lembrar,  Matthew,  Simone,  Xie,  Huiyun,  Caroline,  John 

Dennis, Daphne, Branko e Su Peneycad. 

Agradeço  à “Dona Seda”,  pelo carinho inestimável, à Mariléa, pela ajuda na revisão  do 

texto e à Liliane pelo providencial cafezinho, sempre na hora certa

vi



.

“Viva como se fosse morrer amanhã e aprenda como se fosse viver para sempre”

Mohandas Karamchand Gandhi

(Mahatma Gandhi)

vii



Resumo

BERALDO, Valcir Tadeu. Simulação por Linhas de Corrente com Compressibilidade e Variação  

Espacial e Dinâmica de Composição de Óleo. Campinas: Faculdade de Engenharia Mecânica, 

Departamento de Engenharia de Petróleo, Universidade Estadual de Campinas, 2008, 227 p. Tese 

(Doutorado).

A variação espacial da composição inicial do óleo é um fenômeno que aparece em alguns 

reservatórios  e que deve ser considerada nas  simulações. O  objetivo desta tese é implementar 

uma formulação que considera essa variação em simuladores por linhas de corrente. Esse tipo de 

simulação pode, em muitas situações, ser mais rápido que os simuladores por diferenças finitas.

Uma  das  limitações  importantes  da  simulação  por  linhas  de  corrente  é  o  tratamento  de 

compressibilidades de rocha e fluido. Por isso, foi também implementada uma formulação que 

considera compressibilidade com variação da qualidade do óleo.

Inicialmente um simulador bifásico por linhas de corrente para sistema incompressível foi 

alterado  para  trabalhar  com  dois  componentes  na  fase  óleo,  permitindo  assim  considerar  a 

variação das propriedades desta fase. Em seguida, o simulador foi modificado, incorporando a 

formulação para sistemas compressíveis com variação de qualidade de óleo. Foi necessário criar, 

nesta fase, alguns procedimentos para tornar o programa estável nas diversas situações testadas.

As implementações foram validadas através de comparações com simuladores comerciais 

por  diferenças  finitas  em  uma  série  de  modelos  que  representam  situações  normalmente 

viii



encontradas.  Os  testes  mostraram  que,  em  ambas  formulações,  foi  possível  a  reprodução 

satisfatória dos resultados, utilizando os simuladores por linha de corrente.

Na formulação para sistema compressível, foi feita uma análise de sensibilidade do tempo 

de  execução  e  da  qualidade  da  solução  a  alguns  parâmetros  de  controle  numérico  que  foram 

definidos no código computacional.

Em  modelos  de  sistemas  compressíveis  com  variação  nas  propriedades  de  óleo, 

heterogêneos  e refinados,  os  resultados  mostraram que a combinação adequada de parâmetros 

permite a simulação por linhas de corrente em tempos sensivelmente menores que a simulação 

por diferenças finitas, mantendo-se a qualidade dos resultados.

Palavras Chave:

– Reservatórios (Simulação),  Engenharia de petróleo - Métodos de simulação,  Reservatórios - 

Modelos matemáticos,  Compressibilidade.

ix



Abstract

BERALDO, Valcir Tadeu.  Streamline Based Simulation with Compressibility and Spatial  

and  Dynamic  Variation  of  Oil  Composition. Campinas:  Faculdade  de  Engenharia  Mecânica, 

Departamento de Engenharia de Petróleo, Universidade Estadual de Campinas, 2008, 227 p. Tese 

(Doutorado).

Spatial  oil  composition  variation  can  be  found  in  some  reservoirs  and  it  has  to  be 

considered in simulations. The goal of this thesis is to implement a formulation that considers this 

variation in streamline simulators, which can be, in many situations, faster than finite difference 

simulators.

One of the important restraints of streamline simulations is the treatment of rock and fluid 

compressibility. Therefore, a formulation that considers oil quality variation with compressibility 

has also been implemented.

At first, a two phase streamline simulator for incompressible system was modified to work 

with two components in the oleic phase, allowing consideration of property variations  on this 

phase. Then, the simulator was modified in order to incorporate the formulation for compressible 

system with oil quality variation.

The  implementations  have  been  validated  by  comparisons  with  a  finite  difference 

commercial simulator in several compressible reservoir models, showing good results.

x



Using the formulation for compressible systems, it has been done a sensitivity analysis of 

execution time and quality of solution with the variation of some numerical parameters that have 

been defined in the computational code.

In  models  of  heterogeneous  and  very  refined  reservoirs  with  oil  property  variation,  the 

results  showed  that  the  appropriate  combination  of  numerical  parameters  allows  running  the 

streamline simulation much faster than finite difference simulation, while keeping the quality of 

the results.

Key Words:

– Simulation, Streamline, Compressibility, API Tracking, Compositional Variation

xi



Índice

Dedicatória......................................................................................................................................iv

Agradecimentos................................................................................................................................v

Resumo..........................................................................................................................................viii

Abstract.............................................................................................................................................x

Índice..............................................................................................................................................xii

Lista de Figuras..............................................................................................................................xv

Lista de Tabelas.............................................................................................................................xxi

Nomenclatura..............................................................................................................................xxiii

Capítulo 1   ......................................................................................................................................1

Introdução.........................................................................................................................................1

1.1 Objetivos................................................................................................................................2

1.2 Estrutura da Tese....................................................................................................................3

Capítulo 2   ......................................................................................................................................5

Revisão Bibliográfica.......................................................................................................................5

2.1 Variação Composicional do Óleo...........................................................................................5

2.2 Simulação por Linhas de Corrente.........................................................................................6

2.3 Modelos Composicionais.......................................................................................................8

2.4 Compressibilidade..................................................................................................................9

2.5 Outras Propostas..................................................................................................................11

2.6 Aplicações de Simulação por Linhas de Corrente...............................................................15

Capítulo 3    ...................................................................................................................................17

Fundamentação Teórica..................................................................................................................17

3.1 Simulação por Linhas de Corrente.......................................................................................18

xii



3.2 Variação Espacial e Dinâmica das Propriedades do Óleo em Simuladores Black-Oil........20

3.3 Equações Básicas para Simulação por Linhas de Corrente.................................................22

3.4 Solução da Pressão...............................................................................................................27

3.5 Construção das Linhas de Corrente.....................................................................................29

3.6 Solução do Transporte de Massa para Sistema Incompressível...........................................32

3.7 Solução de Transporte de Massa para Sistema Compressível.............................................35

Capítulo 4   ....................................................................................................................................42

Simulador para Sistema Incompressível.........................................................................................42

4.1 Fluxograma..........................................................................................................................43

4.2 Entrada de Dados.................................................................................................................46

4.3 Determinação das Concentrações dos Componentes...........................................................47

4.4 Definição dos Poços.............................................................................................................48

4.5 Solução da Pressão...............................................................................................................48

4.6 Solução do Transporte de Massa nas Linhas de Corrente....................................................51

4.7 Gravidade.............................................................................................................................61

Capítulo 5   ....................................................................................................................................64

Simulador para Sistema Compressível...........................................................................................64

5.1 Fluxograma..........................................................................................................................66

5.2 Determinação das Concentrações dos Componentes...........................................................68

5.3 Solução da Pressão...............................................................................................................70

5.4 Solução do Transporte de Massa nas Linhas de Corrente....................................................76

5.5 Gravidade.............................................................................................................................98

5.6 Intervalo de Tempo para  Solução da Pressão......................................................................99

5.7 Correção de Intervalo de Tempo para Erros de Balanço de Massa...................................107

Capítulo 6   ...................................................................................................................................110

Aplicações.....................................................................................................................................110

6.1 Sistema Incompressível......................................................................................................111

6.2 Sistema Compressível........................................................................................................116

Capítulo 7   ..................................................................................................................................128

Resultados.....................................................................................................................................128

xiii



7.1 Sistema Incompressível.....................................................................................................128

7.2 Sistema Compressível........................................................................................................135

Capítulo 8   ..................................................................................................................................180

Conclusões e Recomendações......................................................................................................180

8.1 Conclusões.........................................................................................................................180

8.2 Recomendações..................................................................................................................187

Referências Bibliográficas............................................................................................................190

Anexo 1   ......................................................................................................................................198

Fluxograma do Código para Simulação Incompressível..............................................................198

Anexo 2   ......................................................................................................................................201

Fluxograma do Código para Simulação Compressível................................................................201

Anexo 3   ......................................................................................................................................208

Análise do Impacto da Consideração de Grau API Variável........................................................208

 Modelos..............................................................................................................................209

 Otimização dos Planos de Drenagem.................................................................................212

  Resultados.........................................................................................................................214

xiv



Lista de Figuras

Figura 3.1: Exemplo de traçado de linhas de corrente em um modelo compressível com um poço 

injetor (INJ-1) e dois poços produtores (PROD-1 e PROD-2).......................................................19

Figura 3.2: Esquema de passos de tempo para simulação por linhas de corrente..........................19

Figura  3.3:  Seção  esquematizada  de  um  reservatório  com  variação  horizontal  e  vertical  de 

qualidade de óleo (Grau API).........................................................................................................20

Figura 3.4: Componentes da velocidade de uma fase (Blunt, 2007)..............................................26

Figura 3.5: Determinação das coordenadas de saída de uma linha de corrente em uma célula.....30

Figura 3.6: Tubo de corrente associado a uma linha de corrente....................................................37

Figura 4.1: Fluxograma simplificado do código de simulação por linhas de corrente para sistema 

incompressível................................................................................................................................44

Figura  4.2:  Definição  de  nó  de  linha  de  corrente  lançada  de  um  poço  injetor.  O  primeiro  nó 

corresponde ao centro da célula injetora........................................................................................51

Figura  4.3: Linhas  de corrente  saindo  de um poço  injetor  (em  vermelho)  e  tubos  de corrente 

associados (delimitados pelas linhas tracejadas azuis)...................................................................53

Figura 4.4: Exemplo representativo do processo de regularização da linha de corrente................55

Figura 4.5: Mapeamento da saturação e da concentração. ............................................................60

Figura 5.1: Fluxograma simplificado do código de simulação por linhas de corrente para sistemas 

compressíveis..................................................................................................................................66

Figura 5.2: Comparação entre evolução do máximo erro de soma de saturações..........................74

Figura 5.3: Tipos de linhas de corrente...........................................................................................77

Figura 5.4: Exemplo mostrando linhas de corrente e tipo de células encontradas.........................78

Figura 5.5: Vazão adimensional (QsD) e Tempo de Vôo (?) ao longo de uma linha de corrente 

com grande variação de velocidade................................................................................................81

Figura  5.6:  Exemplo  simbólico  de  divisão  de  linha  de  corrente  em  região  com  vazão 

xv



adimensional inferior a 1,0x10-3....................................................................................................82

Figura 5.7: Possíveis situações em um poço produtor....................................................................92

Figura 5.8: Possíveis situações em um poço produtor com duas completações.............................95

Figura 5.9: Máximo erro de soma de saturações em uma simulação de um caso homogêneo......99

Figura  5.10:  Erro  de  soma  de  saturações  em  uma  simulação  de  um  caso  muito  heterogêneo 

derivado do Caso SPE10, com 1,2 milhões de células com passos de tempo constantes............100

Figura 5.11: Controle de passo de tempo por relação linear em modelo altamente heterogêneo 

derivado do Caso Comparativo SPE10........................................................................................101

Figura 5.12: Aplicação de uma equação de segundo grau para determinação do Máximo erro de 

soma de saturações previsto.........................................................................................................102

Figura 5.13: Controle de passo de tempo por relação linear com erro estimado por equação de 

segundo grau em modelo altamente heterogêneo derivado do Caso Comparativo SPE10..........102

Figura 5.14: Controle de passo de tempo em caso homogêneo com 1500 células através de erro 

esperado........................................................................................................................................103

Figura 5.15: Controle de passo de tempo por monitoração do  máximo erro de soma de saturações 

em modelo altamente heterogêneo derivado do Caso Comparativo SPE10.................................105

Figura 6.1: Distribuição inicial de porosidade do modelo incompressível...................................110

Figura 6.2: Distribuição da permeabilidade horizontal (direção x) do modelo incompressível...110

Figura 6.3: Curvas de permeabilidades relativas utilizadas nos casos incompressíveis...............111

Figura 6.4: Localização dos poços do modelo..............................................................................112

Figura 6.5: Distribuição inicial de Grau API de óleo do Caso Degrau Incompressível...............113

Figura 6.6: Distribuição inicial de Grau API de óleo do Caso Gradual Incompressível..............114

Figura 6.7: Distribuição inicial de Grau API de óleo do Caso Degrau Homogêneo Compressível.

......................................................................................................................................................115

Figura 6.8: Localização dos poços do Caso Degrau Homogêneo Compressível.........................116

Figura 6.9: Grau API de óleo do Caso Gradual Homogêneo Compressível.................................117

Figura 6.10: Localização dos poços do Caso Gradual Homogêneo Compressível......................118

Figura 6.11: Permeabilidade horizontal do Campo de Namorado Modificado (10-3 µm2).........119

Figura 6.12: Permeabilidade vertical do Campo de Namorado Modificado (10-3 µm2).............120

Figura 6.13: Grau API de óleo do Caso Campo de Namorado Modificado.................................121

xvi



Figura 6.14: Saturação Inicial de Água do Modelo do Campo de Namorado Modificado..........122

Figura 6.15: Distribuição inicial de porosidade do Caso Comparativo SPE10 Modificado........123

Figura 6.16: Distribuição da permeabilidade horizontal (direção x) do Caso Comparativo SPE10 

Modificado....................................................................................................................................125

Figura 6.17: Grau API de óleo do Caso Comparativo SPE10 Modificado..................................125

Figura 7.1: Comparação entre saturação de água após 3.000 dias de produção no Caso Degrau 

Incompressível..............................................................................................................................127

Figura 7.2: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso Degrau 

Incompressível..............................................................................................................................127

Figura  7.3:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Degrau 

Incompressível..............................................................................................................................128

Figura 7.4: Curvas de produções acumuladas de óleo e água (Np e Wp) e Volume de Óleo In Situ 

do Caso Degrau Incompressível...................................................................................................129

Figura 7.5: Comparação entre saturação de água após 3.000 dias de produção no Caso Gradual 

Incompressível..............................................................................................................................129

Figura 7.6: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso  Gradual 

Incompressível..............................................................................................................................130

Figura  7.7:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Degrau 

Incompressível..............................................................................................................................131

Figura 7.8: Curvas de produções acumuladas de óleo e água (Np e Wp) e Volume de Óleo In Situ 

do Caso Gradual Incompressível..................................................................................................132

Figura 7.9: Comparação entre curvas de produção de óleo e produção total dos poços dos Casos 

Gradual Incompressível e Uniforme Incompressível...................................................................133

Figura 7.10: Comparação entre saturação de água após 3.000 dias de produção no Caso Degrau 

Homogêneo Compressível............................................................................................................135

Figura 7.11: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso Degrau 

Homogêneo Compressível............................................................................................................135

Figura 7.12: Curvas de produção de óleo e produção total dos poços do Caso Degrau Homogêneo 

Compressível................................................................................................................................136

Figura 7.13: Curvas de produções acumuladas de óleo e água (Np e Wp) e volume de óleo in situ 

xvii



do Caso Degrau Homogêneo Compressível.................................................................................137

Figura  7.14:  Curvas  de  pressão  média  nas  células  dos  poços  injetores  do  Caso  Degrau 

Homogêneo Compressível............................................................................................................138

Figura 7.15: Comparação entre saturação de água, aos 25 dias de produção, na primeira camada 

do Caso Degrau Homogêneo. Simulação por linhas de corrente utilizando A = 2,0 e regularização 

por tempo de vôo..........................................................................................................................139

Figura 7.16: Comparação entre saturação de água, aos 25 dias de produção, na primeira camada 

do  Caso  Degrau  Homogêneo.  Simulação  por  linhas  de  corrente  utilizando  A  =  50,0  e 

regularização por volume de linha de corrente.............................................................................141

Figura 7.17: Curvas de pressão média nas células dos poços e curvas de corte de água do Caso 

Degrau Homogêneo Compressível...............................................................................................142

Figura 7.18: Comparação entre saturação de água após 3.000 dias de produção no Caso Gradual 

Homogêneo Compressível............................................................................................................143

Figura 7.19: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso Gradual 

Homogêneo Compressível............................................................................................................143

Figura  7.20:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Gradual 

Homogêneo Compressível............................................................................................................144

Figura 7.21: Curvas de pressão média nas células do poço injetor do Caso Gradual Homogêneo 

Compressível................................................................................................................................145

Figura 7.22: Curvas de produções acumuladas de óleo e água (Np e Wp) e Volume de Óleo In 

Situ do Caso Gradual Homogêneo Compressível........................................................................145

Figura 7.23: Comparação entre saturação de água após 3.000 dias de produção no Caso Gradual 

Heterogêneo Compressível...........................................................................................................147

Figura 7.24: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso Gradual 

Heterogêneo Compressível...........................................................................................................147

Figura  7.25:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Gradual 

Heterogêneo Compressível...........................................................................................................148

Figura 7.26: Curvas de produções acumuladas de óleo e água (Np e Wp) e volume de óleo in situ 

do Caso Gradual Heterogêneo Compressível...............................................................................149

Figura 7.27: Curvas de pressão média nas células do poço injetor do  Caso Gradual Heterogêneo 

xviii



Compressível................................................................................................................................149

Figura  7.28:  Curvas  de  pressão  média  de  todas  as  células  do   Caso  Gradual  Heterogêneo 

Compressível................................................................................................................................150

Figura 7.29: Comparação entre saturação de água após 3.000 dias de produção no Caso Gradual 

Heterogêneo  Compressível com regularização  de  linha de corrente por volume e parâmetro  A 

igual a 3,0.....................................................................................................................................151

Figura 7.30: Curvas de pressão média nas células do poço injetor do  Caso Gradual Heterogêneo 

Compressível................................................................................................................................151

Figura  7.31:  Análise  de  sensibilidade  do  Índice  de  Similaridade  e  do  Tempo  de  Execução  ao 

parâmetros M................................................................................................................................154

Figura  7.32:  Comparação  de  evolução  do  erro  máximo  de  soma  de  saturações  e  do  passo  de 

tempo com M = 0,05 e  M = 0,5...................................................................................................155

Figura 7.33: Análise de sensibilidade da qualidade e do tempo de execução em relação ao número 

de linhas de corrente lançadas na Fase 1......................................................................................157

Figura 7.34: Número de linhas de corrente lançadas na Fase 3 e tempo de simulação em função 

de número de linhas de corrente lançadas na Fase 1....................................................................158

Figura  7.35:  Análise  de  sensibilidade  da  qualidade  e  do  tempo  de  execução  em  relação  aos 

parâmetros A e B...........................................................................................................................160

Figura 7.36: Comparação  entre saturação  de água após  5.000 dias  de produção  no Campo de 

Namorado Modificado..................................................................................................................161

Figura 7.37: Comparação entre Grau API após 5.000 dias de produção no Campo de Namorado 

Modificado....................................................................................................................................162

Figura 7.38: Curvas de produção de óleo e produção total dos poços do Campo de Namorado 

Modificado....................................................................................................................................163

Figura 7.39: Curvas de  pressão na célula em poços do Campo de Namorado Modificado........164

Figura 7.40: Curvas de produções acumuladas de óleo e água (Np e Wp) e Volume de Óleo In 

Situ do Campo de Namorado Modificado....................................................................................165

Figura  7.41:  Análise  de  sensibilidade  da  qualidade  e  do  tempo  de  execução  em  relação  aos 

parâmetros A (Campo de Namorado Modificado).......................................................................167

Figura 7.42: Análise de sensibilidade da qualidade e do tempo de execução em relação ao número 

xix



de linhas de corrente lançadas de células “fonte”.........................................................................168

Figura  7.43:  Comparação  entre  saturação  de  água  após  3.000  dias  de  produção  no  Caso 

Comparativo SPE10 Modificado..................................................................................................170

Figura  7.44:  Comparação  entre  Grau  API  de  óleo  após  3.000  dias  de  produção  no  Caso 

Comparativo SPE10 Modificado..................................................................................................170

Figura  7.45:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Gradual 

Comparativo SPE10 Modificado..................................................................................................171

Figura 7.46: Curvas de pressão média nas células do poço injetor do Caso SPE10 Modificado.172

Figura 7.47: Curvas de produções acumuladas de óleo e água (Np e Wp) e Volume de Óleo In 

Situ do Caso Comparativo SPE10 Modificado............................................................................172

Figura  7.48:  Comparação  entre  saturação  de  água  após  3000  dias  de  produção  no  Caso 

Comparativo SPE10 Modificado, utilizando-se A = 1,5 e regularização com base em volume de 

linha de corrente...........................................................................................................................173

Figura  7.49:  Comparação  entre  curvas  de  produção  de  óleo  do  Caso  SPE10  Modificado  com 

diferentes compressibilidades. .....................................................................................................175

Figura  7.50:  Comparação  entre  curvas  de  produção  de  óleo  do  Caso  SPE10  Modificado  com 

diferentes compressibilidades. .....................................................................................................176

xx



Lista de Tabelas

Tabela 6.1: Permeabilidades Relativas..........................................................................................111

Tabela 6.2: Propriedades do Óleo nos .........................................................................................112

Tabela 6.3: Propriedades Extremas de Óleo dos...........................................................................116

Tabela 6.4: Cronograma de Entrada de Poços no Modelo Campo de Namorado Modificado.....124

Tabela  7.1:  Parâmetros  de  Controle  Numérico  Utilizados  nos  Casos  Degrau  Homogêneo 

Compressível e Gradual Homogêneo Compressível....................................................................135

Tabela  7.2:  Parâmetros  de  Controle  Numérico  Utilizados  no  Casos  Degrau  Homogêneo  para 

Análise da Influência da Regularização de Linha de Corrente na Pressão de Injeção.................140

Tabela  7.3:  Parâmetros  de  Controle  Numérico  Utilizados  no  Caso  Gradual  Heterogêneo 

Compressível................................................................................................................................146

Tabela 7.4: Parâmetros Fixos de Controle Numérico na Análise de Número de Linhas de Corrente 

da Fase 1 (Caso Gradual Heterogêneo Compressível).................................................................153

Tabela 7.5: Análise de Sensibilidade ao Multiplicador M da Estratégia “Gatilho” de Controle de 

Passo de Tempo de Pressão..........................................................................................................153

Tabela 7.6: Parâmetros Fixos de Controle Numérico na Análise de Número de Linhas de Corrente 

da Fase 1 (Caso Gradual Heterogêneo Compressível).................................................................156

Tabela 7.7: Análise de Sensibilidade ao Número de Linhas de Corrente Lançadas na Fase 1.....156

Tabela  7.8:  Parâmetros  Fixos  de  Controle  Numérico  na  Análise  dos  Parâmetros  A e  B  (Caso 

Gradual Heterogêneo Compressível)............................................................................................158

Tabela 7.9: Análise de Sensibilidade aos Parâmetros A e B e ao Tipo de Regularização de Linha 

de Corrente...................................................................................................................................160

Tabela  7.10:  Parâmetros  Fixos  de  Controle  Numérico  Utilizados  no  Campo  de  Namorado 

Modificado....................................................................................................................................161

xxi



Tabela 7.11: Parâmetros Fixos de Controle Numérico Utilizados na Análise de Sensibilidade ao 

Parâmetro A..................................................................................................................................166

Tabela 7.12: Análise de Sensibilidade ao Parâmetro A e ao Tipo de Regularização no Modelo 

Campo de Namorado Modificado................................................................................................166

Tabela 7.13: Análise de Sensibilidade ao Número de Linhas  de Corrente Lançadas  de Células 

“Fonte” e ao Tipo de Regularização no Modelo Campo de Namorado Modificado....................168

Tabela 7.14: Parâmetros Fixos de Controle Numérico Utilizados no Caso Comparativo SPE10 

Modificado....................................................................................................................................169

Tabela  7.15:  Parâmetros  de  Controle  Numérico  Utilizados  no  Caso  Comparativo  SPE10 

Modificado....................................................................................................................................173

Tabela 7.16: Casos Definidos para Análise de Efeito de Compressibilidade...............................174

Tabela  7.17:  Tempos  de  Execução  na  Análise  de  Efeito  da  Compressibilidade  (Caso  Gradual 

Heterogêneo Compressível).........................................................................................................174

Tabela 7.18: Comparação Entre Tempos de Processamento........................................................177

Tabela 8.1: Parâmetros de Controle Numérico Sugeridos para Novos Modelos.........................187

xxii



Nomenclatura

Símbolos

Mc concentração de massa do componente c por unidade de volume rocha (kg/m3).
F fluxo de massa por unidade de área (kg/m2s).
m? vazão mássica por unidade de volume (kg / m3s).
S saturação (adimensional).
Swi saturação de água irredutível.
Sor saturação de óleo residual.
? porosidade (adimensional).
C concentração de massa por volume de fluido (kg/m3).
Cvol concentração em volume de componente por volume de fluido (adimensional).
u velocidade aparente de fluido em meio poroso (m/s).
u módulo da velocidade aparente de fluido em meio poroso (m/s).
v módulo da velocidade intersticial de fluido em meio poroso (m/s).
??D tensor dispersão (adimensional).
??K tensor de permeabilidade (m2).
K permeabilidade absoluta (m2).
Kr permeabilidade relativa (adimensional).
? viscosidade dinâmica (Pa.s).
x distância na direção x (m).
y distância na direção y (m).
z distância na direção z (m).
s distância ao longo de uma linha de corrente (m).
t tempo (s).
? tempo de vôo em uma linha de corrente (s).
p pressão (Pa).
? massa específica (kg/m3).
g vetor aceleração de gravidade (m / s2 ).
g módulo da aceleração de gravidade (m / s2).
? mobilidade (m s / kg).
q vazão por volume de rocha (1/s).
f fluxo fracionário (adimensional)
c compressibilidade (1/Pa).
h gradiente de variação de velocidade no interior da célula (1/s).

xxiii



rd divergente (1/s).
Q vazão (m3/d).
Qflux vazão associada a uma linha de corrente (m3/d).
Qsl vazão em uma posição da uma linha de corrente (m3/d).
Qd vazão adimensional em uma posição da uma linha de corrente (adimensional).
Qpinj vazão de injeção de fase p (m3/d).
V volume (m3).
B fator de formação de volume (m3/std m3).
b inverso do fator de formação de volume (std m3/m3).
R razão de solubilidade (m3/m3).
API grau API do óleo (°).
M multiplicador para determinação do intervalo de tempo necessário para redução do 

máximo erro de soma de saturações.
A multiplicador para determinação do número de elementos da linha de corrente 

regularizada.
B parâmetro de acréscimo de número de elementos da linha de corrente regularizada em 

regiões compressíveis.

Super-escritos

° condições padrão.
c choque.
sat na pressão de saturação.
* definição modificada para compressibilidade.
n início do passo de tempo de pressão.
n+1 final do passo de tempo de pressão.
m início do passo de tempo de solução de linha de corrente.
m+1 final do passo de tempo de solução de linha de corrente.

Subscritos

c componente.
p fase.
r rocha, residual.
t transferência.
0 inicial ou na entrada de um semento.
1 final ou na saída de um segmento.
i entrada, irredutível.
e saída.
x direção x.

xxiv



y direção y.
z direção z.
s direção da linha de corrente.
w fase água.
o fase óleo.
h óleo pesado.
l óleo leve.
grav relativo à gravitacional.
cap relativo à pressão capilar.

Siglas

API American Petroleum Institute.
TOF Tempo de Vôo (Time of Flight).
VOL Volume.
IMPES Implicit Pressure Explicit Saturation
PERM Petroleum Engineering and Rock Mechanics Group.
RAM Random Acess Memory.
VOIS Volume de Óleo In Situ.
IS Indicador de Similaridade
JCG Conjugate Gradient Method
AMG Algebraic Multigrid

xxv



Capítulo 1    

Introdução

A composição inicial do óleo em muitos reservatórios não é uniforme e pode variar com a 

profundidade e a localização. Em reservatórios com grandes dimensões, essas variações podem 

ter  um  efeito  considerável  na  definição  dos  planos  de  desenvolvimento.  Por  exemplo,  a 

produtividade dos  poços  e a transmissibilidade entre poços  produtores  e  injetores  são funções 

diretas das propriedades do óleo. Além disso, a composição do óleo que chega ao poço produtor 

pode variar, podendo afetar a sua produtividade no tempo. Por tudo isso, é de se esperar que a 

consideração  de  propriedades  variáveis  de  óleo  em  um  modelo  numérico  possa  melhorar 

significativamente  a  qualidade  das  previsões  de  produção.  Alguns  simuladores  comerciais 

baseados em diferenças finitas possuem uma opção que permite esse tipo de modelagem sem a 

necessidade de uma formulação composicional.

Para  a  adequada  modelagem  de  reservatórios,  torna-se  necessária  a  caracterização 

geológica  detalhada,  com  consideração  de  heterogeneidades  de  fácies,  porosidades  e 

permeabilidades,  usando  células  de  dimensões  relativamente  pequenas.  A  combinação  de 

reservatórios extensos com a necessidade de melhor caracterização leva à utilização de malhas de 

simulação com um número muito grande de células, tendo como conseqüência o crescimento dos 

tempos de simulação e atrasos na definição de projetos de produção ou  restrição na quantidade 

de  alternativas  de  desenvolvimento  analisadas.  Os  reservatórios  extensos  são  também  os  que 

possuem maior probabilidade de apresentar variações  tridimensionais nas propriedades iniciais 

1



do óleo.

Nos últimos anos, uma nova linha de simuladores, chamada de simuladores por  linhas de 

corrente, têm surgido como tecnologia efetiva e complementar aos simuladores convencionais. A 

solução  neste  tipo  de  simulador  é  baseada  em  linhas  de  corrente  que  representam  tubos  de 

escoamento.  No  Brasil  esse  tipo  de  simulação  é  mais  conhecido,  na  área  de  petróleo,  como 

simulação  por  “linhas  de  fluxo”.  Entretanto,  nesta  tese,  foi  mantida  a  nomenclatura  que  é 

utilizada na área de mecânica dos fluidos, ou seja, “linhas de corrente”, ou streamline em inglês. 

Esses  simuladores  são  especialmente  aplicáveis,  com  grande  redução  de  tempo  de 

processamento,  à  solução  de  sistemas  de  grandes  dimensões,  heterogêneos  e  geologicamente 

complexos (Baker et al., 2001; Samier et al., 2001). Outra vantagem desses simuladores sobre os 

convencionais  é  a  redução  dos  efeitos  de  orientação  de  malha.  A visualização  das  linhas  de 

corrente  e  a  quantificação  da  relação  entre  poços  injetores  e  poços  produtores  também  são 

ferramentas  muito  úteis  para  a  definição  de  malhas  de  drenagem  e  entendimento  do 

comportamento dos reservatórios. 

Apesar  dessas  vantagens,  os  simuladores  por  linhas  de  corrente  também  possuem 

limitações.  A  eficiência  é  prejudicada  quando  variações  nas  condições  de  produção  são 

freqüentes. Isso ocorre, por exemplo, na fase de ajuste de histórico, onde as vazões são alteradas 

a cada mês, na medida que novos poços são paulatinamente acrescentados ao reservatório. Para 

sistemas em que a compressibilidade é grande, as implementações atuais desse tipo de simulação 

não são plenamente satisfatórias. Além disso, as versões comerciais não possuem nenhuma opção 

para a simulação eficiente da variação de propriedades de óleo.

1.1 Objetivos

Tendo-se  em  vista  as  dificuldades  na  modelagem  refinada  de  reservatórios  extensos  e 

heterogêneos, com variações tridimensionais nas propriedades iniciais de óleo, utilizando-se os 

simuladores  comerciais  disponíveis  atualmente,  são  propostas  neste  trabalho  modificações  em 

2



simuladores por linhas de corrente, de modo a torná-los adequados à abordagem desse tipo de 

problema, mostrando que, em sistemas incompressíveis, tais modificações não são grandes e o 

impacto no tempo de processamento é pequeno. Será também mostrado que uma abordagem para 

sistemas  compressíveis  com  variação  das  propriedades  iniciais  do  óleo  também  pode  ser 

implementada e que, ainda assim, o processo pode trazer vantagens em relação aos simuladores 

por diferenças finitas.

1.2 Estrutura da Tese

Para atingir os objetivos propostos, este texto é composto por oito capítulos. Uma revisão 

bibliográfica sobre os assuntos considerados é apresentada no Capítulo 2.

O Capítulo 3 apresenta a fundamentação teórica para os simuladores de linhas por corrente 

que foram desenvolvidos, tanto para sistemas incompressíveis, quanto compressíveis. Nos dois 

casos, também é apresentada  a solução para  a adequada caracterização da variação  espacial  e 

dinâmica das propriedades do óleo ao longo da simulação. 

Nos  Capítulos  4  e  5,  são  descritos  os  simuladores  para  sistemas  incompressíveis  e 

compressíveis  que  foram  desenvolvidos,  desde  a  discretização  das  equações  apresentadas  no 

Capítulo  3,  até  detalhes  de  programação  importantes  para  o  adequado  funcionamento  dos 

programas.  Ambos  os  códigos  foram  desenvolvidos  a  partir  de  um  programa  em  linguagem 

FORTRAN 95, disponibilizado pelo grupo de pesquisa PERM (Petroleum Engineering and Rock 

Mechanics  Group)  do  Imperial  College  London.  Este  programa  tinha,  a  princípio,  somente  a 

capacidade para simulação convencional por linhas de corrente e adaptações para simulação de 

injeção de CO2. 

No Capítulo 6, são descritos os vários casos utilizados para testes, avaliação e validação das 

implementações. Os resultados das simulações desses casos para os simuladores desenvolvidos e 

simuladores comerciais são apresentados e analisados no Capítulo 7.

3



No Capítulo 8, as conclusões  e recomendações do trabalho são listadas, destacando-se a 

possibilidade de simulação por linhas de corrente com compressibilidade e a sua aplicação real e 

vantajosa  em  casos  com  grande  número  de  células,  mesmo  quando  existe  variação  das 

propriedades do óleo ao longo do reservatório.

No Anexo 3, é apresentado um estudo que teve por objetivo a análise do impacto de uma 

caracterização inadequada em reservatórios com propriedades de óleo horizontalmente variáveis, 

justificando assim o esforço em métodos que permitam modelagens rápidas e adequadas deste 

fenômeno.

4



Capítulo 2    

Revisão Bibliográfica

A  revisão  bibliográfica  está  dividida  em  seis  seções:  uma  seção  apresentando  alguns 

trabalhos sobre o problema da variação composicional do óleo, outra  apresentando os primeiros 

trabalhos  relacionados  à  técnica  de  simulação  por  linhas  de  corrente  e  mais  quatro  seções 

relativas a modelos composicionais, compressibilidade, outras propostas e aplicações da técnica 

de simulação por linhas de corrente.

2.1 Variação Composicional do Óleo

Existem  muitas  referências  sobre  gradação  vertical  de  composição  de  óleo  em 

reservatórios.  Como  exemplos,  pode-se  citar:  Montel  e  Gouel  (1985),  Avraham  (1988), 

H?ier e Whitson (2000) e Salehirad (2005).

Behrenbruch (1995) mostrou um campo marítimo de petróleo no Vietnam, no qual foram 

analisadas  30  amostras  de  petróleo,  sendo  7  análises  PVT.  Neste  campo,  ocorrem  variações 

laterais de Grau API entre 28 a 37, de razão de solubilidade entre 89 e 196  m3  std/m3   e de fator 

de formação de volume entre 1,3 e 1, 8 m3/m3 std. Como o reservatório é muito compartimentado, 

não se pode afirmar com certeza que se trata de um caso de variação composicional no mesmo 

reservatório. 

5



Pádua  (1997)  aplicou  um  novo  modelo  computacional  de  equilíbrio  de  fases,  o  qual 

considera  gravidade  e  temperatura,  para  o  entendimento  e  avaliação  da  conectividade  de  um 

grande campo de petróleo em águas profundas na costa brasileira. Os resultados sugerem que a 

temperatura do reservatório pode ter tanta influência na variação da composição do óleo quanto a 

gravidade.  O  volume  de  óleo  in  situ do  reservatório  estudado  é  de  1,3x106 m3 std.  Quatro 

amostras PVT, obtidas a uma distância de 4 km uma da outra, apresentaram variação de Grau API 

entre 20 e 28. A variação de temperatura do reservatório (40°K) é explicada pela variação da 

profundidade de água e, conseqüentemente, da diferença de profundidades entre o reservatório e 

o leito marinho. Como o reservatório tem uma inclinação menor que o leito marinho, existe uma 

inversão no gradiente térmico, pois a temperatura é menor nas regiões em que o campo é mais 

profundo.  O  mesmo  autor  (1999)  analisa  o  problema  com  mais  profundidade  utilizando 

simulação composicional com modelos de migração de óleo e conclui que o efeito do gradiente 

inverso de temperatura acentua a segregação dos componentes pesados do óleo. Esse efeito, junto 

com gravidade, estrutura geológica, gênese e processo de acumulação, pode explicar a variação 

lateral de composição encontrada no reservatório.

Wenger  et al. (2002) mostraram que a biodegradação dos hidrocarbonetos e o resultante 

declínio na qualidade do óleo pode ser correlacionada com  a temperatura do reservatório em 

regiões onde essa temperatura é inferior a 80°C.

Gibson  (2006)  caracterizou  o  óleo  em  um  reservatório  com  variação  lateral  de 

propriedades,  através  de  uma  inicialização  não  equilibrada.  Uma  das  características  desse 

reservatório era a variação lateral da concentração de gás sulfídrico. Dois métodos baseados na 

combinação de um conjunto de pseudocomponentes foram utilizados na inicialização: um através 

de ajuste de superfície e outro por triangulação. 

2.2 Simulação por Linhas de Corrente

A primeira  descrição  das  equações  analíticas  que  definem  a  função  corrente  e  a  função 

6



potencial em domínio bidimensional para o escoamento de um fluido incompressível foi dada por 

Muskat (1937).

Higgins e Leighton (1962) usaram tubos de escoamento para modelar o escoamento 2D em 

um esquema  five-spot de drenagem. O reservatório foi dividido em "tubos", dentro dos quais o 

escoamento  bifásico  unidimensional  tinha  sua  solução  mapeada  através  da  teoria  de  Bucley-

Leverett. 

LeBlanc  e  Caudle  (1970)  mostraram,  em  reservatório  de  espessura  constante  e  fluidos 

incompressíveis, como o fluxo em um tubo de corrente pode ser representado pela velocidade na 

linha de corrente central.

Thiele (1994) fez uma revisão da literatura existente até então sobre o assunto para a área 

de petróleo e para a área de águas subterrâneas. Nesse trabalho foi estudada a utilização de tubos 

de escoamento em seções de reservatório verticais heterogêneas. A função corrente foi definida 

através da solução de um sistema de equações a partir das transmissibilidades entre as células da 

malha. Os tubos de corrente são derivados da solução da função corrente. A não linearidade do 

escoamento  foi  abordada  através  de  atualizações  periódicas  da  geometria  dos  tubos.  Foram 

estudados  exemplos  de  escoamento  de  traçadores,  escoamento  imiscível,  escoamento  com 

miscibilidade de primeiro contato e escoamento composicional bifásico. Soluções analíticas no 

interior dos tubos de escoamento foram utilizadas e comparações com as soluções tradicionais 

por diferenças finitas, mostrando reduções de duas a cinco ordens de magnitude dos tempos de 

simulação foram apresentadas.

Bratvedt  et al. (1996) mostraram como a técnica da decomposição do operador (operator  

splitting) pode ser usada para se considerar os efeitos gravitacionais em um simulador por linhas 

de corrente. Após a solução de um intervalo de tempo, a gravidade pode ser levada em conta 

através de um segundo passo convectivo com linhas de corrente verticais. Nesse trabalho também 

foram comparadas duas formas de transferência dos perfis de saturação das linhas entre um passo 

de solução de pressão e o passo seguinte. Uma forma é baseada nas saturações médias das células 

7



da malha 3D, enquanto a outra se baseia em projeções de perfis de saturação de segmentos das 

linhas anteriores em segmentos das novas linhas. Foi provado que a transferência baseada em 

segmentos  de linhas  de corrente é muito  mais  acurada que a baseada  na  saturação média  das 

células.

Batycky  et  al. (1996) e Batycky (1997)  apresentaram o desenvolvimento e aplicação em 

escala de campo de um completo simulador de duas fases, tri-dimensional, baseado em linhas de 

corrente.  O  conceito  de  linha  de  corrente  foi  associado  a  trajetórias  de  partículas  e  traz 

simplificações na abordagem matemática, quando comparado ao conceito de tubos de corrente. 

As  soluções  apresentadas  cobrem  o  caso  de  escoamento  de  traçadores,  influxo  de  água, 

deslocamento imiscível e deslocamento com miscibilidade de primeiro contato. As soluções 1D 

nas  linhas  de  corrente  foram  obtidas  tanto  analiticamente  como  numericamente.  As  soluções 

analíticas  são  extremamente  rápidas  e  livres  de problemas  de difusão  numérica,  mas  somente 

aplicáveis a um número limitado de situações. Por outro lado, a utilização de solução numérica 

permitiu  a  extensão  do  método  para  condições  dinâmicas  de  produção  dos  poços,  saturação 

inicial  variável  e  efeitos  gravitacionais.  Este  trabalho  foi  tomado  como  base  para  o 

desenvolvimento da presente tese. 

2.3 Modelos Composicionais

A extensão  de  um  simulador  por  linhas  de  corrente  para  o  caso  3D  composicional  foi 

apresentada  por  Thiele  et  al.   (1997).  Nesse  trabalho  também  é  apresentada  uma   primeira 

abordagem visando a consideração da compressibilidade de fluido e variação de volume devida a 

mistura de componentes. Esses fatores são considerados através de um processo iterativo para 

solução de uma “velocidade adimensional” ao longo da linha de corrente. A solução da pressão é 

incompressível. Dois casos em uma seção heterogênea são analisados: um de injeção de gás, com 

três componentes, e outro de quatro componentes com condensação e vaporização. Outro caso 

em três dimensões e com 518.400 células também é apresentado. A solução desse caso requere 

em torno de 3 dias de processamento. A solução por diferenças finitas de uma malha, obtida por 

8



transferência de escala, com apenas 28.800 células, tomou o mesmo tempo de processamento. As 

curvas de recuperação de óleo e fração do componente C3 obtidas com a malha de 28.800 células, 

usando-se linhas de corrente e diferenças finitas, são razoavelmente semelhantes.

Uma outra abordagem para simulação composicional por linhas de corrente é apresentada 

por Jessen (2002). A compressibilidade e a variação de volume por mistura de componentes não 

são consideradas e a solução da linha de corrente se dá por um método analítico, o que se traduz 

em  uma  solução  rápida  e  sem  dispersão  numérica.  As  curvas  de  recuperação  obtidas  não 

coincidem com as obtidas por Thiele et al.  (1997), mas podem ser consideradas como resultados 

limites.  Jessen  e  Orr  (2004)  também  apresentaram  uma  extensão  do  método  de  simulação 

composicional por linhas de corrente incluindo gravidade através do método de decomposição do 

operador  (operator  splitting).  Yan  et  al.  (2004)  mostraram  a  aplicação  de  simulação 

composicional  por  linhas  de  corrente  em  sistemas  com  três  fases,  onde  uma  fase  é  a  água, 

considerada  em  um  processo  Water  Alternating  Gas (WAG).  Algumas  diferenças  entre  a 

simulação  por  linhas  de  corrente  e  a  simulação  por  diferenças  finitas,  observadas  no  final  da 

curva de produção de óleo, são atribuídas à solução incompressível da pressão.

Não  foi  encontrada  nenhuma  referência,  exceto  Beraldo  et  al.  (2007),  que  abordasse 

especificamente a utilização de simuladores por linhas de corrente em reservatórios com variação 

espacial das propriedades do óleo. 

2.4 Compressibilidade

A  primeira  abordagem  visando  a  consideração  da  compressibilidade  de  fluido  foi  a 

apresentada por Thiele et al. em 1997. Este trabalho tinha como interesse principal a formulação 

composicional, assumindo grandes simplificações quanto a compressibilidade.

Ingebrigtsen  et  al.  (1999)  propuseram  duas  maneiras  para  contornar  o  problema  de 

compressibilidade do gás em sistemas trifásicos; ambas envolvem consideráveis simplificações. 

9



Alguns  resultados  de  comparação  com  simuladores  por  diferenças  finitas,  com  razoável 

semelhança, são apresentados para casos 2D e 3D. 

Cheng  et  al. (2005)  propuseram  outra  formulação  para  abordar  o  problema  da 

compressibilidade. A principal diferença, em relação às propostas anteriores está na consideração 

de  um  termo  relacionado  à  divergência  da  velocidade  na  solução  das  linhas  de  corrente.  O 

método proposto foi aplicado a um modelo de 30.740 células e comparado com um simulador 

comercial  por  diferenças  finitas  e  um  simulador  comercial  por  linhas  de  corrente.   Como  a 

pressão  na  simulação  foi  mantida  acima  da  pressão  de  bolha,  não  existe  fluxo  de  gás.  Os 

resultados obtidos com a nova formulação foram mais próximos aos do simulador por diferenças 

finitas, que os obtidos pelo simulador comercial por linhas de corrente. A formulação utilizada 

no simulador comercial por linhas de corrente não é de domínio público. Segundo os autores, não 

houve  nenhuma  vantagem  computacional  na  nova  formulação  em  relação  ao  simulador  por 

diferenças finitas. Cheng et al. (2006) usaram a mesma implementação em um método de ajuste 

de histórico automático baseado em simulador por linha de corrente. Foram ajustados corte de 

água  e  razão  gás-óleo  de  um  caso  sintético  tridimensional  com  9.000  células  e  25  poços 

produtores. A mesma formulação de Cheng et al.  (2005) foi estendida a reservatórios fraturados 

(dupla porosidade) em sistemas trifásicos por Koslova et al. (2006). Neste trabalho, foi simulado 

um caso com 1.122.000 células por um período de 300 dias em em aproximadamente 25 horas. 

Recentemente, Osako e Datta-Gupta (2007) estenderam a formulação original de Cheng  et al.  

(2005)  para  simulação  composicional  com  efeitos  gravitacionais,  apresentando  um  caso  de 

21x21x4 células. Os tempos de processamento foram similares aos de um simulador comercial 

por diferenças finitas. Embora  o  desenvolvimento  teórico  apresentado  nesta  tese  tenha 

semelhanças com os trabalhos de Cheng, Osako e Datta-Gupta, existem importantes diferenças 

quanto à forma de implementação, as quais tornaram possíveis os objetivos aqui propostos. Uma 

proposta de utilização de modelos analíticos de curvas de equilíbrio de fases e outras  funções 

termodinâmicas, na solução das linhas de corrente em formulação composicional, visando reduzir 

o esforço computacional, é apresentada por Podgornova et al. (2007).

Analisando-se esses trabalhos, observa-se que todos assumem alguma simplificação quanto 

10



à compressibilidade e que os únicos trabalhos que apresentam resultados para malhas de grande 

número  de  células  reportam  tempos  de  processamento  semelhantes  aos  dos  simuladores 

comerciais. Todos os trabalhos assumem que a compressibilidade da rocha é desprezível, quando 

comparada com a compressibilidade dos fluidos, o que não é real para sistemas óleo-água. Esses 

fatos levaram à extensão da proposta original desta tese para a abordagem de compressibilidade 

com variação tridimensional das propriedades do óleo.

2.5 Outras Propostas

Peddibhotla  et  al. (1997)  propuseram  melhoramentos  para  o  processo  de  simulação  por 

linhas de corrente. Trata-se de uma nova forma de transferência de perfis de saturações entre as 

linhas  de  corrente,  baseada  em  interpolação  3D  pelo  método  do  inverso  do  quadrado  das 

distâncias  sobre pontos  das  linhas  anteriores. Para  a solução numérica  ao longo das  linhas  de 

corrente,  eles  defenderam  a  utilização  do  esquema  de  alta  ordem  total  variation  diminishing 

(TVD)  como  forma  de  evitar  dispersão  numérica.  Um  exemplo  de  campo  é  apresentado 

mostrando razoável reprodução do histórico de produção de água, utilizando-se simulação por 

linhas de corrente com as modificações propostas.

Portella e Hewett (1997) apresentaram um simulador por linhas de corrente 3D para duas 

fases e efeitos gravitacionais desprezíveis, onde as linhas de corrente permanecem fixas ao longo 

da simulação e as vazões são atualizadas em função da perda de carga em cada linha.

Ponting  (1998)  propôs  uma  formulação  para  solução  de  pressão  e  fluxo  nas  linhas  de 

corrente  baseada em “densidades  molares”,  definidas  como quantidade de moles  por “volume 

poroso de referência”.

Uma idéia interessante apresentada por Gautier et al. (1999) torna os simuladores por linhas 

de corrente aptos para a solução de malhas de milhões de blocos. As células da malha refinada 

são agrupadas em uma malha grosseira, na qual se processa a solução da pressão. Em seguida a 

11



pressão é recalculada dentro de cada um dos agrupamentos, usando a condição de fluxo constante 

na fronteira obtida da primeira solução. Esse processo permitiu o traçado preciso das linhas de 

corrente e o cálculo das saturações na escala da malha refinada. O método se mostrou 8,5 vezes 

mais rápido que um simulador por linhas de corrente convencional em um modelo heterogêneo 

de  99x99x99  células,  com  células  da  malha  grosseira  formadas  por  3x3x3  células  da  malha 

refinada.  Os  resultados  foram  praticamente  os  mesmos.  Em  relação  a  um  simulador  por 

diferenças finitas, a razão entre os tempos de simulação foi da ordem de 1000.

Ruan et al. (2002) mostraram esforços na utilização de um simulador por linhas de corrente 

para duas fases e três dimensões, que utiliza um modelo de traçadores no ajuste de  histórico e 

previsão de produção do processo WAG em sistema miscível e imiscível.

Prévost  et  al., em 2002, generalizaram o método de  mapeamento  das  linhas  de corrente 

para malhas do tipo corner point estruturadas e não estruturadas.

Analisando tanto os termos alinhados, como os transversais à direção de escoamento dos 

fluidos, e propondo um algoritmo de correção para atualizar as saturações quanto ao escoamento 

transversal, Osako et al. (2003) apresentaram um método para seleção do intervalo de tempo  na 

solução de pressão que garante a estabilidade numérica.

Rodriguez  e  Kindelan  (2003)  estenderam  a  utilização  do  método  de  decomposição  do 

operador (operator splitting) para levar em conta, além da gravidade, a capilaridade dos fluidos. 

Esse mesmo método é incorporado a um simulador de linhas de corrente por Berenblyum et al. 

(2003), mostrando pequenas alterações nas trajetórias das linhas de corrente nas proximidades da 

frente de avanço da água. 

Hastings  et  al.  (2003)  utilizaram  o  conceito  de  linhas  de  corrente  para  quantificar 

rapidamente o impacto de heterogeneidades de pequena escala em uma seção de um reservatório 

sintético com características de reservatório fluvial. As linhas de corrente são traçadas com base 

na  heterogeneidade  de  maior  escala.  Em  cada  linha  de  corrente,  as  propriedades  médias  são 

12



obtidas por transferência de escala, a partir de várias imagens com variações de heterogeneidade 

de pequena escala.

Um  melhoramento  na  transferência  das  saturações  da  malha  original  para  as  linhas  de 

corrente foi proposto por Mallison et al. (2004). Eles propuseram que a saturação seja interpolada 

linearmente entre a entrada e a saída da célula atravessada pela linha de corrente, deixando de ser 

representada  por  intervalos  constantes.  Para  o  cálculo  das  saturações  das  células  a  partir  das 

linhas de corrente, foi proposto um método baseado em krigagem, que  reduz o erro de balanço 

de materiais. 

Di  Donato  et  al.  (2003)  apresentaram  um  simulador  por  linhas  de  corrente  para  a 

modelagem de injeção de água  em reservatórios  fraturados. A transferência  de fluidos  entre a 

matriz e a rocha porosa foi representada por “fontes/sumidouros” na solução de transporte 1D. 

Diferentes  formas  de  função  de  transferência  foram  estudadas.  Resultados  similares  aos  de 

simuladores por diferenças finitas para malhas de 100.000 e 1.000.000 foram obtidos, porém com 

velocidades uma ou duas ordens de grandeza maiores. Essa implementação foi posteriormente 

melhorada através da implementação de um esquema Adaptative-Implicit  (AIM) na solução das 

linhas de corrente por Thiele et al. (2004).

Obi  e  Blunt  (2006)  desenvolveram  um  simulador  por  linhas  de  corrente  bifásico  com 

modelo  de  traçador  para  modelagem  de  escoamento  de  CO2 e  água.  O  programa  considera 

escoamento da fase CO2  e dissolução do CO2  em água, além de adsorção nos poros da rocha e 

conseqüente alteração de porosidade e permeabilidade. O simulador foi utilizado para modelar 

seqüestro  de  CO2 em  um  aqüífero  salino  profundo  do  Mar  do  Norte,  utilizando  um  modelo 

altamente heterogêneo, com aproximadamente um milhão de células. Qi et al. (2007) utilizaram 

simulação por linhas de corrente para simular uma estratégia de armazenamento de CO2 baseada 

em capilaridade, onde injeta-se um volume de CO2 misturado com água salgada, seguido por um 

volume exclusivamente de água salgada. 

Matringe e Gerrritsen (2004) e Matringe et al. (2005) propuseram métodos para controlar a 

13



densidade  de  linhas  de  corrente  no  reservatório,  em  função  da  necessidade  de  solução  mais 

acurada ou não, melhorando a eficiência do processo. Eles também analisaram o erro introduzido 

na construção das linhas de corrente devido aos seguintes motivos: 

? esquema linear de interpolação de velocidade utilizado;

? critério de lançamento das linhas de corrente da célula com poço injetor e 

? imprecisão no cálculo das velocidades nas faces das células.

Para reduzir esses erros são propostos dois métodos: um baseado em refinamento adaptativo da 

célula, que tem semelhanças com o método proposto por Gautier et al. (1999) e outro baseado em 

interpolação da velocidade ao longo das faces das células. Também é proposto um novo critério 

para lançamento das linhas de corrente. Por esse critério, as linhas de corrente são lançadas a 

partir de esferas envolvendo o ponto de injeção e não das faces da célula que contém esse ponto.

Jimenez et al. (2005) também fizeram uma análise detalhada de possíveis fontes de erro no 

balanço de massa. Foram analisados erros devidos à discretização espacial das linhas de corrente, 

ou seja, associados ao número e densidade de linhas de corrente, e erros associados à solução ao 

longo  da  linha.  São  analisadas,  entre  outras  situações,  malhas  corner  point,  erros  em 

representação  de  falhas  e  em  malhas  não  estruturadas.  O  problema  do  cálculo  de  tempo  de 

trajetória de uma partícula, que está associado ao erro de solução da linha de corrente, também 

foi abordado por Hægland, et al. (2007).

Uma  formulação  térmica,  desenvolvida  para  a  simulação  de  injeção  de  água  quente  em 

sistema bifásico, é apresentada por Pasarai e Arihara (2005). Comparações com um simulador 

térmico comercial são apresentadas para casos 1D e 2D. Como se trata de um trabalho inicial, os 

resultados ainda não são perfeitos, necessitando-se de novos desenvolvimentos nessa área.

A implementação de um método de malha refinada adaptativa (AMR  ? Adaptative Mesh  

Refinement)  na  solução  da  linha  de  corrente  foi  recentemente  apresentada  por  Andrianov  e 

Bratvedt (2007).

Kippe  et al. (2007) propuseram uma correção a ser feita no tempo de trajetória de uma 

14



partícula, a qual reduziria significativamente o erro de balanço de massa. Essa correção permitiria 

simulações com uma quantidade muito menor de linhas e, conseqüentemente, muito mais rápidas, 

embora sacrificando ligeiramente a qualidade das respostas obtidas.

2.6 Aplicações de Simulação por Linhas de Corrente

Existe uma série de trabalhos, dos quais apenas alguns estão aqui citados, que apresentam 

abordagens de ajuste de histórico baseado em simulação por linhas de corrente, beneficiando-se 

do menor tempo de processamento e das características desse tipo de simulação para a escolha 

das regiões relacionadas com a produção de cada poço. Emanuel e Milliken (1998) apresentaram 

pela primeira vez a utilização do conceito de linhas de corrente em ajuste de histórico. Maschio e 

Schiozer (2004) utilizaram um simulador por linhas de corrente em conjunto com um simulador 

por diferenças finitas em um processo automático de ajuste de histórico.  A simulação por linhas 

de corrente proporcionava um método de escolha das regiões a terem suas propriedades alteradas 

automaticamente. Cheng  et al. (2006) utilizaram a formulação proposta para compressibilidade 

de  fluidos,  no  ajuste  de  histórico  de  corte  de  água  e  razão  gás-óleo.  Stenerud  et  al.  (2007) 

propuseram  a  combinação  de  malhas  multi-escaladas  com  linhas  de  corrente  em  um  método 

“rápido  e  robusto”  para  ajuste  de  histórico  de  modelos  geológicos  caracterizados  em  alta 

resolução.

Christie et al. (2002) se beneficiaram da velocidade de um simulador por linhas de corrente 

em  um  processo  de  quantificação  de  incertezas  baseado  em  imagens  geo-estatísticas.  Nesse 

trabalho, 984 imagens com mais de um milhão de células foram simuladas com um período de 

histórico de 300 dias em um total de 2,84 horas.

Maschio e Schiozer (2002) fizeram várias comparações entre um simulador comercial por 

diferenças finitas e um simulador comercial por linhas de corrente. Eles observaram que, para 

modelos homogêneos, o tempo de processamento obtido por linhas de corrente era superior ao 

obtido por diferenças finitas. Por outro lado, em modelos altamente heterogêneos, observou-se, 

15



em relação ao número de células, um crescimento exponencial no tempo de processamento para 

diferenças  finitas  e  um crescimento  linear para  linhas  de corrente,  mostrando a vantagem do 

método  de  linhas  de  corrente  em  determinadas  situações.  Ao  tentarem  utilizar  a  opção  de 

compressibilidade, disponível na versão comercial do simulador por linhas de corrente, os autores 

observaram um acréscimo no tempo de simulação por um fator de aproximadamente duas vezes e 

meia, sem uma reprodução satisfatória dos resultados obtidos por diferenças finitas. 

Ligero  et  al.  (2003)  fizeram  comparações  entre  a  utilização  de  simulação  por  linhas  de 

corrente e redução do número de células de um simulador por diferenças finitas em uma análise 

de risco aplicada a um campo de petróleo. Observou-se que a utilização de técnicas mais rápidas 

de  simulação,  incluindo-se  a  simulação  por  linhas  de  corrente,  pode  reduzir  o  esforço 

computacional, sem afetar sensivelmente os resultados desse tipo de análise. 

Guimarães et al. (2004) fizeram um exercício de utilização simultânea de simuladores por 

diferenças  finitas  e  linhas  de  corrente  na  otimização  de  campos  de  petróleo  maduros, 

aproveitando-se da facilidade que a simulação por linhas de corrente tem para a correlação entre 

poços injetores e poços produtores afetados pela injeção de cada poço injetor.

16



Capítulo 3    

Fundamentação Teórica

Na simulação por linhas de corrente, as equações são colocadas de tal forma, que o campo 

de pressão em um determinado  passo de tempo é  resolvido independentemente  da solução  da 

movimentação  de  massa.  Para  determinar  a  movimentação  de  massa,  e  conseqüentemente  as 

saturações das células, linhas de corrente são traçadas ao longo do reservatório e o escoamento é 

resolvido em cada linha, independentemente. Em seguida, a nova distribuição de massa ao longo 

das linhas é mapeada para a malha original e um novo passo de tempo é iniciado. 

Neste  trabalho,  foi  utilizada,  na  implementação  da  simulação  para  sistemas 

incompressíveis,  a  abordagem  tradicional  dada  a  simuladores  por  linhas  de  corrente  onde,  no 

cálculo da movimentação de massa, a principal variável levada em consideração é a saturação dos 

fluidos.  Essa abordagem foi aqui expandida para englobar a variação da massa específica de 

óleo.

No caso compressível, adotou-se a abordagem em termos de concentrações de massa por 

unidade de volume de rocha (Blunt, 2008). As Seções 3.6 e 3.7 se concentram na movimentação 

de fluidos para os casos incompressível e compressível, respectivamente.

17



3.1 Simulação por Linhas de Corrente

A solução dos simuladores por linhas de corrente baseia-se em alguns princípios básicos 

(Thiele, 2003) : 

1. traçado de linhas de corrente a partir da solução de pressão em uma malha 3D;

2. redefinição das  equações  de conservação de massa nas linhas  de corrente em termos  do 

tempo de percurso da partícula ou “tempo de vôo”;

3. atualização periódica das linhas de corrente;

4. solução numérica 1D do transporte de fluidos nas linhas de corrente;

5. tratamento dos efeitos gravitacionais e extensão a fluidos compressíveis.

Uma vez que o campo de pressão em um passo de tempo é calculado, pode-se determinar  o 

campo de velocidade de escoamento e, a partir do mesmo, traçar-se as  linhas  de corrente. As 

linhas de corrente podem ser resolvidas numericamente, tendo cada uma o seu próprio passo de 

tempo,  suficientemente  pequeno  para  que  haja  estabilidade  numérica.  Um  exemplo  real  de 

traçado de linhas de corrente em um modelo com um poço injetor e dois produtores, com sistema 

compressível, é mostrado na Figura 3.1. 

A Figura 3.2 ilustra o processo de  simulação por linhas de corrente no caso incompressível. 

Nesta figura, n (diagrama superior) refere-se ao passo de tempo da pressão, enquanto m refere-se 

ao passo de tempo da saturação em uma linha de corrente específica (diagrama inferior). Após a 

solução  da  saturação  nas  linhas  de  corrente,  existe  um  processo  de  mapeamento,  onde  as 

saturações são mapeadas para a malha original, iniciando-se então, um novo passo de tempo de 

pressão.

18



Figura 3.1: Exemplo de traçado de linhas de corrente em um modelo compressível com 
um  poço  injetor  (INJ-1)  e  dois  poços  produtores  (PROD-1  e  PROD-2).  Por  ser  um 
sistema compressível, algumas linhas de corrente acabam em células “sumidouro” nos 
cantos esquerdos do modelo.

Figura  3.2: Esquema de passos de tempo para simulação 
por linhas de corrente.  

19

0
100
200
300
400
500
600
700
800
900
1000

0 10
0

20
0

30
0

40
0

50
0

60
0

70
0

80
0

90
0

10
00

11
00

12
00

13
00

14
00

15
00

x (m)

y 
(m

)

INJ-1

PROD-1

PROD-2

n n+1

tempo

tempo

solução de pressão

solução de saturação

traçado
das LC

m m+k

mapeamento

n n+1

tempo

tempo

solução de pressão

solução de saturação

traçado
das LC

m m+k

mapeamento



3.2 Variação Espacial e Dinâmica das Propriedades do Óleo em Simuladores Black-Oil

Em alguns reservatórios extensos, uma variação contínua das propriedades iniciais do óleo 

em  função  da  localização  e  da  profundidade  traz  uma  nova  dificuldade  para  a  adequada 

caracterização (Figura 3.3). Até hoje, na grande maioria dos casos onde esse tipo de reservatório 

foi  encontrado,  utilizaram-se  simuladores  de  diferenças  finitas  do  tipo  Black-Oil.  Esses 

simuladores  são  geralmente  muito  lentos  para  a  solução  das  malhas  de  milhões  de  células 

necessárias em grandes modelos numéricos.  Nos principais simuladores Black-Oil a opção para a 

modelagem de variação nas propriedades de óleo é chamada API Tracking. Grau API é um escala 

desenvolvida pelo API (American Petroleum Institute) para definição de densidade relativa em 

condições  padrão  de  vários  hidrocarbonetos  líquidos  (Society  of  Petroleum  Engineers,  2004). 

Usando-se a opção  API Tracking, um campo inicial em Grau API é estabelecido e convertido em 

massas específicas. A cada passo de tempo, as massas específicas são recalculadas em função da 

movimentação de óleo no reservatório (CMG, 1999 e Geoquest Reservoir Technologies, 2002).

Em reservatórios onde é comprovada a variação das características do óleo, pode-se dispor 

das seguintes formas de modelagem (CMG, 1999 e Geoquest Reservoir Technologies, 2002):

20

Figura  3.3:  Seção  esquematizada  de  um  reservatório  com  variação 
horizontal e vertical de qualidade de óleo (Grau API).

28°

27°26°

25°24°
23°

22°

Distância

Prof.

28°

27°26°

25°24°
23°

22°

Distância

Prof.



1. adotar uma tabela PVT única para todo o reservatório;

2. dividir o reservatório em várias regiões, representadas por tabelas PVT específicas;

3. adotar a opção  API Tracking, com Grau API definido em função da profundidade;

4. adotar a opção  API Tracking, informando-se a Grau API do óleo célula a célula.

Se as variações observadas são grandes, a opção 1, que é muito utilizada, fará com que 

ocorram  desvios  nas  estimativas  do  potencial  de  produção  dos  poços,  prejudicando  as 

otimizações de planos de drenagem. O Anexo 3 apresenta um estudo, cujo objetivo foi avaliar o 

impacto dessa consideração. Isso se explica porque o espaçamento entre um poço injetor e um 

poço produtor depende da transmissibilidade do sistema, a qual depende da viscosidade do óleo. 

Quanto menor a transmissibilidade, menor deveria ser a distância entre esses poços. A opção 2 

cria descontinuidades entre células que não são desejáveis do ponto de vista numérico. A opção 3 

é adequada para reservatórios que não sejam extensos ou em casos em que esteja comprovada 

que a variação das propriedades do óleo é função apenas da profundidade. Usando-se esta opção, 

as propriedades do óleo são atualizadas em função do seu movimento, o que não ocorre na opção 

2. Nos casos de reservatórios com variação horizontal das propriedades iniciais do óleo, não é 

possível caracterizar o sistema adequadamente usando-se a opção 3, sendo necessária então, a 

definição das propriedades do óleo célula a célula, como na opção 4. Para isso, é necessária a 

inicialização  do  modelo  através  de  um  pré-processamento,  pois  os  simuladores  exigem,  neste 

caso,  que  sejam  alimentadas,  além  das  propriedades  iniciais  do  óleo,  todas  as  saturações  e 

pressões. Uma outra opção seria utilizar simuladores composicionais, o que acarretaria tempos de 

processamento excessivos.

O princípio de aplicação da opção  API Tracking é semelhante nos principais simuladores 

Black-Oil comerciais. São informadas duas ou mais tabelas PVT, às quais são associados valores 

de densidade de óleo. A distribuição inicial de propriedades pode ser estabelecida de duas formas: 

informando-se o Grau API do óleo em cada célula da simulação ou especificando-se gradientes 

verticais  para  cada  região  do  reservatório.  As  duas  tabelas  PVT,  cujo  intervalo  de  densidade 

contém  a  densidade  de  determinada  célula,  são  interpoladas  para  a  determinação  das  demais 

propriedades. Na solução, a massa específica do óleo de cada célula é mantida constante durante 

21



o intervalo de tempo. Quando ocorre a convergência da solução e são determinados os fluxos 

entre as células, o princípio de conservação de massa é utilizado para determinar as novas massas 

específicas, as quais são usadas no próximo passo de tempo. Embora essa seja uma simplificação 

do processo, a rapidez  deste  tipo  de  procedimento,  comparada  com  simulação  composicional, 

permite  que  maior  esforço  computacional  seja  utilizado  em  outros  pontos  importantes  da 

modelagem, como, por exemplo, no refinamento da malha.

Uma  opção  do  tipo  API  Tracking nos  simuladores  por  linhas  de  corrente  é  altamente 

desejável,  tendo  em  vista  as  vantagens  já  comprovadas  desse  tipo  de  modelagem.  Como  na 

simulação por linhas de corrente já existe uma etapa de mapeamento das quantidades de fluidos 

em  cada  célula  após  o  intervalo  de  tempo  convectivo,  a  implementação  da  opção  Grau  API 

variável não é tão complexa e não eleva de modo significativo o esforço computacional.

3.3 Equações Básicas para Simulação por Linhas de Corrente

A equação de conservação de massa no escoamento de um determinado componente  c é 

definida por:

? M c
? t

???Fc=m?c , (1)

onde Mc é a concentração do componente c, definida como massa por unidade de volume, Fc é o 

fluxo mássico por unidade de área (vetorial) e m?c é a vazão mássica de injeção do componente 

c por unidade de volume (Blunt, 2008). Se existe mais de uma fase fluindo em um meio poroso, 

associa-se  Mc às saturações das fases, através da concentração de massa do componente  c por 

volume da fase j (Cjc):

M c=? ?
j=1

n fases

S j C jc ,
 

(2)

onde  ? é a porosidade da rocha, Sj é a saturação da fase j.

O fluxo de massa é dado pela soma dos fluxos mássicos do componente em todas as fases:

22



Fc= ?
j=1

n fases

F jc ,  (3)

ou:

Fc= ?
j=1

n fases

?u j C jc?? S j
??D jc ? C jc?,

 
(4)

onde uj é a velocidade aparente de fase j e 
??D jc  é o tensor dispersão do componente c na fase j. 

Admitindo-se que a dispersão é desprezível, tem-se das Equações  (1) e  (4) a seguinte equação 

que descreve  o escoamento e a acumulação de cada componente:

 ??M c?
? t

??? ?
j=1

n fases

?u j C jc ?=m?c . (5)

Substituindo-se  a  Equação  (2) obtêm-se  a  mesma  equação  em  termos  de  saturação  das 

fases:

 ?
j=1

n fases ??? S j C jc ?
?t

??? ?
j=1

n fases

?u j C jc?=m?c , (6)

A equação que descreve a quantidade de massa do componente  c presente em uma única 

fase p é dada por: 

??? S p C pc ?
? t

????u p C pc ?=m? pc?m?tc ,  (7)

onde m? pc é a velocidade de injeção da massa do componente c, dissolvida na fase p, e m?tc  é 

a velocidade de transferência de massa do componente c, de todas as outras fases para a fase p. 

Por definição, a soma das concentrações de todos os componentes de uma fase é igual à 

massa específica dessa fase:

? p= ?
i=1

n comp

C pi .  (8)

Somando-se a Equação (7), definida para todos os componentes que podem compor a fase 

p, obtém-se a equação que descreve a massa de uma fase:

23



??? S p ? p ?
? t

????u p ?p ?=q p ? p?m?tp ,  (9)

onde m?tp  corresponde à velocidade de transferência de massa das outras fases para a fase p e:

q p =
m? p
?p

.  (10)

A velocidade de uma fase up é dada pela lei de Darcy, aplicada ao escoamento multifásico:

u p=?
??K K rp
? p

?? ? pp ?? p g ? ,  (11)

ou também

u p=?
??K K rp
? p

?? ? p p ?? p g ? z ? ,  (12)

onde z é a profundidade (positiva na direção descendente).

Substituindo-se a Equação  (12) na Equação  (6) obtém-se a Equação  (13) (em destaque), 

que descreve o escoamento e acumulação do componente c em função dos campos de pressão das 

fases nas quais este componente se encontra dissolvido:

?
j=1

n fases ??? S j C jc?
? t

??? ?
j=1

n fases [ ??K K rj? j ?? p j ?? j g ? z ? C jc]=m?c .
 

(13)

Substituindo-se  a  Equação  (12) na  Equação  (9),  obtém-se  a  equação  que  descreve  o 

escoamento  e acumulação da fase p em função do campo de pressão desta fase:

 

??? S p ? p ?
? t

???[ ??K K rp? p ?? p p?? p g ? z ?? p]=q p ?p?m?tp . (14)
Fazendo-se  a  somatória  das  velocidades  de  todas  as  fases  definidas  pela  Equação  (11), 

obtém-se a velocidade total do fluido:

24



ut = ?
j=1

n fases

u j = ?
??K ?

j=1

n fases

[? j ? p j ?? j ? j g ] ,  (15)

onde  a  mobilidade  da  fase  ?j é  definida  como  a  relação  entre  permeabilidade  relativa  e 

viscosidade da fase j.

Tomando-se uma das fases (p) como base e usando-se as pressões capilares entre esta fase e 

as demais, definidas por pcpj = pj – pp:                                 

ut =?
??K [ ?

j=1

n fases

?? j ? p p ?? ?
j =1

n fases

?? j ? pcpj ?? ?
j=1

n fases

?? j ? j g ?],  (16)
ou,

ut =?
??K ??t ? p p ??

??K [ ?
j=1

n fases

?? j ? pcpj ?? ?
j=1

n fases

?? j ? j g ?];
 

(17)

onde  ?t é a mobilidade total:

?t = ?
j=1

n fases

? j .  (18)

Da Equação (17) segue:

? ??K ? p p =
ut
?t

?
??K
?t [ ?j=1

n fases

?? j ? pcpj ?? ?
j =1

n fases

?? j ? j g ?].
 

(19)

Substituindo-se a Equação (19) na Equação (11) e reagrupando-se os termos:

u p=? p {? ??K ? p p}? ??K ? p ?p g ,  (20)

u p=? p{ut?t ?
??K
?t [ ?j =1

n fases

?? j ? pcpj ?? ?
j=1

n fases

?? j ? j g ?]}? ??K ? p ? p g ,  (21)
u p=

?p
?t

ut ?
??K ?

j =1

n fases

? ? p ? j?t ? p cjp?? ??K ?j=1
n fases

? ?p ? j?t ? j?g? ??K ?j=1
n fases

? ? p ? j?t ? p? g ,  (22)
u p=

?p
?t

ut ?
??K ?

j =1

n fases

? ? p ? j?t ? pcjp?? ??K ?j=1
n fases

? ?p ? j?t ?? j ?? p ??g ,  (23)
25



 
(24)

onde fp = ?p/?t é o fluxo fracionário da fase p, 

ucap p=?
??K ?

j =1

n fases

? ?p ? j?t ? pcjp?,  (25)
  ugrav p =?

??K ?
j=1

n fases

? ? p ? j?t ? ? pj?g , (26)
? ? pj=? j ?? p   e ? pcpj= p j? p p . (27)

A Equação (24) diz que a velocidade de uma fase é a soma dos três componentes ilustrados 

na Figura 3.4:

? velocidade paralela à velocidade total (fput);

? velocidade vertical devida à segregação gravitacional ( ugrav p ) e

? velocidade devida aos efeitos da pressão capilar ( ucap p ).

Na simulação por linhas de corrente, a movimentação de fluidos é calculada primeiramente 

em  linhas  de  corrente  paralelas  a  ut e  em  seguida  na  direção  vertical,  para  a  solução  do 

escoamento  gravitacional  devido  a  velocidade  ugravp.  Em  casos  onde  a  capilaridade  não  é 

significativa, ut pode ser considerado como função de um único campo de pressões.

26

Figura 3.4: Componentes da velocidade de uma fase (Blunt, 2007).

ut

fput

ugravp
ucapp
up

u p= f put?ugrav p?ucap p ;



3.4 Solução da Pressão

A  solução  por  linhas  de  corrente  usa  o  esquema  IMPES  (Implicit  Pressure  Explicit  

Saturation). As equações são arranjadas de tal forma a se obter o campo de pressões no final do 

passo  de  tempo,  independentemente  das  saturações  das  fases.  Em  seguida,  as  composições  e, 

conseqüentemente, as saturações são explicitamente movidas, usando-se os novos gradientes de 

pressão. Após o cálculo da movimentação de massa, novas propriedades de fluidos e mobilidades 

são calculadas e usadas no próximo passo de tempo.

Neste trabalho, são considerados componentes que, ao serem misturados para formar uma 

fase, não têm o seu volume alterado. Admite-se também que não existe transferência de massa 

entre as fases. Tomando-se um componente c, em um sistema com essas características, pode-se 

definir  a  “saturação”  deste  componente  (Sc)  como  a  razão  entre  o  volume  que  o  componente 

ocuparia sozinho no sistema e o espaço poroso. A concentração do componente c, Mc, pode ser 

definida tanto em termos da Equação (2) como em termos de Sc: 

M c= ? ?
j=1

n fases

S j C jc = ? S c ?c ,
 

(28)

onde  ?c é   a  massa  específica  que  o  componente  teria  nessas  condições.  Obtém-se,  então,  a 

seguinte relação:

S c ?c= ?
j=1

n fases

S j C pc .  (29)

A Equação  (13), que descreve  escoamento e acumulação de um componente, também pode ser 

escrita como:

?[? ?
j=1

n fases

? S j C jc?]
? t

??? ?
j=1

n fases [ ??K K rj?
j

? ? p j ?? j g ? z? C jc ]=m? c  (30)
e portanto:

??? S c ?c?
? t

????
j=1

n fases [ ??K K rj? j ? ? p j?? j g ? z ?C jc]=m?c .  (31)
Desmembrando-se o primeiro termo da equação:

27



? S c
?? ?c?

? t
?? ?c

?? S c?
? t

?Sc ?c
????
? t

????
j=1

n fases [ ??K K rj? j ? ? p j?? j g ? z ? C jc]=m?c ,
(32)

e dividindo-se por ?c:

? S c
1
?c

?? ?c?
? t

??
??S c?

? t
?S c

????
? t

?

?
1
?c

?? ?
j=1

n fases [ ??K K rj? j ?? p j ?? j g ? z ? C jc]=m?c?c .
 (33)

A porosidade se relaciona diretamente com a pressão através da compressibilidade da rocha:

cr =
1
?

d ?
d p

.  (34)

Considerando que um componente tem sua composição invariável e que não existe variação no 

volume  do  componente  devido  a  mistura  com  outros  componentes,  a  variação  do  volume 

específico do componente é correlacionada com a pressão através da sua compressibilidade:

cc=?
1
vc

d vc
d p

,  (35)

onde  vc é o volume específico do componente  c. O produto da massa específica pelo volume 

específico é constante igual a 1. Portanto:

d ?vc ?c? = v c d ?c??c d vc = 0 ,  (36)

 
d ?c
?c

=?
d vc
vc

(37)

e

cc=
1
?c

d ?c
d p

.  (38)

Portanto:

? Sc ?cc?cr ?
? p
? t

??
??S c?
? t

?
1
?c

???
j=1

n fases [ ??K K rj? j ? ? p j?? j g ? z ? C jc]=q c ,  (39)
onde qc é a vazão injetada do componente c.

Fazendo-se a somatória da Equação  (39) aplicada a todos os componentes e considerando 

28



que a soma das vazões de todos os componentes é igual à soma das vazões de todas as fases, 

obtêm-se a seguinte equação para a solução da pressão em um caso compressível:

?[cr ? ?
i=1

n comp

? S i ci ?] ? p? t ?? ?i=1
n comp ? S i

? t

? ?
i=1

n comp 1
?i

?? ?
j =1

n fases [ ??K K rj? j ?? p j ?? j g ? z ?C ji]= ?j=1
n fases

q j .
(40)

A somatória das variações de saturação no segundo termo poderia ser cancelada uma vez que a 

soma  das  saturações  é  igual  a  um,  por  definição.  Porém,  por  razões  numéricas,  como  será 

explicado na Seção 5.3, esse termo foi aqui mantido. 

No caso incompressível, os termos que envolvem compressibilidade devem ser eliminados, 

obtendo-se a seguinte equação para a solução da pressão:

 ? ?
i=1

n comp 1
?i

?? ?
j =1

n fases [ ??K K rj? j ?? p j ?? j g ? z ?C ji]= ?j=1
n fases

q j . (41)

Neste caso, não é necessária a manutenção do termo das variações da saturação, pois o método 

utilizado na solução convectiva garante que a somatória das saturações seja unitária.

3.5 Construção das Linhas de Corrente

Para  se  traçar  as  linhas  de  corrente  utiliza-se  o  método  de  Pollock  (Pollock,  1988). 

Discretizando-se  o  reservatório  em  células  ortogonais,  a  velocidade  do  fluido  dentro  de  uma 

célula, na direção x, pode ser aproximada linearmente por:

v x=v x ? x0 ??hx ? x?x0 ?, x0 ? x ? x0?? x ,  (42)

onde  vx é a velocidade intersticial do fluido na direção  x, x0 é a coordenada  x de uma face da 

célula e hx é o gradiente de velocidade no interior da célula (Figura 3.5).

29



Figura  3.5: Determinação das coordenadas de saída de uma linha de corrente em uma 

célula.

O  tempo  para  o  cruzamento  da  célula  na  direção  x é  determinado  pela  integração  de 

dx / vx :

? t ex=?
x i

x0?? x dx
vx

;  (43)

onde xi é a coordenada x de entrada da linha de corrente na célula. Usando-se a Equação  (42):

? t ex= ?
xi

x 0?? x

1
v x ?

dx
dv x ?dv x =

1
h x ?

xi

x 0?? x

1
v x

dv x =
1
h x

ln
v? x 0?? x?

v? xi?
, (44)

 Usando-se a Equação  (44),  os tempos necessários para cruzamento da célula nas três direções 

podem ser calculados  por:

? t ex=
1
h x

ln[ v x ? x0 ??h x ? xv x ? x0 ??h x ? xi ?x0 ? ],  (45)

30

(i-1,j)
(i+1,j)

(i,j-1)

(i,j+1)

vx0 vx+? x

vy+? y

vy0
Linha de Corrente

(i,j)

Entrada

Saída



? t ey=
1
hy

ln[ v y ? y0 ??h y ? yv y ? y0??hy ? yi? y0 ? ],  (46)
? t ez=

1
hz

ln[ vz ? z0 ??hz ? zv z ? z0 ??h z ? z i?z0 ? ].  (47)
O menor dos três tempos de cruzamento,  ?tmin, corresponde ao instante em que a linha de 

corrente atinge a face de saída da célula. Conhecendo-se  ?tmin, é possível calcular a coordenada 

de saída na direção x, utilizando-se a relação:

? t min =
1
hx

ln[ v x ? x0 ??hx ? xe? x0?v x ? x0 ??h x ? xi ?x0 ? ] = 1hx ln[
v x ? x0??hx ? xe?x0 ?

vx ? xi ? ],  (48)
onde xe é a coordenada de saída.

Isolando-se as coordenadas de saída da linha de corrente nas três direções:

xe=x0 ?
1
h x

[ v x ? xi? ehx ?t min?v x ? x0 ?],  (49)

ye= y0?
1
h y

[ v y ? yi? eh y? tmin?v y ? y 0?],  (50)

ze= z0?
1
h z

[ v z ? zi ?eh z ? tmin?vz ? z0 ?] .  (51)

Usando este conceito em todas as células atravessadas, é possível a construção da trajetória 

de uma linha de corrente. Em sistemas incompressíveis, todas as linhas se iniciam nos pontos de 

injeção de fluidos e terminam em algum ponto de produção. Quando existe compressibilidade, 

podem existir células do tipo “fonte” onde, devido à expansão dos fluidos ou contração do espaço 

poroso, as direções de escoamento são, em todas as faces, em direção ao exterior da célula. Nesse 

caso, linhas de corrente também devem ser lançadas das paredes dessas células. Também podem 

existir células do tipo “sumidouro”, onde o fluxo é, em todas as faces, em direção ao interior da 

célula e onde as linhas de corrente terminam, sem atingir um ponto de produção de fluidos.

Ao se traçarem as linhas de corrente, também é calculado o "tempo de vôo" (time of flight 

? TOF), que é definido como o tempo médio de percurso das partículas de uma linha de corrente 

31



até uma posição determinada:

?s =?
0

s
1

v s? ??
d ? = ?

0

s
??? ?
u s? ??

d ? .  (52)

onde v é a velocidade intersticial e u á a velocidade aparente. Na forma discretizada:

?s n=?
i=1

n

? t min i .  (53)

3.6 Solução do Transporte de Massa para Sistema Incompressível

Considerando-se que ao longo de uma linha de corrente não existe injeção ou produção de 

fluidos e admitindo-se que não exista transferência de massa entre as fases, a movimentação de 

massa em uma fase é descrita ela Equação (7), sem os termos de injeção e transferência de massa:

??? S p C cp?
? t

????u p C pc ?=0.  (54)

Para rocha incompressível, a equação é:

??S p C cp?
? t

?
1
?

???u p C pc?=0 .  (55)

Fazendo-se a somatória das equações de todos os componentes presentes na fase

??S p ? p?
? t

?
1
?

???u p ? p ?=0 ;  (56)

e para fluidos incompressíveis:

??S p ?
? t

?
1
?

??u p=0.  (57)

Substituindo-se a velocidade pelos seus componentes na Equação (55) e desconsiderando pressão 

capilar:

??S p C pc?
? t

?
1
?

??[? f put?ugrav p ?C pc]=0 ,  (58)
com ugrav p definido pela Equação (26). Conhecendo-se o campo de velocidades ut, essa equação 

pode  ser  resolvida  através  do  método  da  decomposição  do  operador  (operaror  splitting), 

32



introduzido  em  simulação  por  linhas  de  corrente  por  Bratvedt  et  al.  (1996).  Nesse  método,  a 

equação é resolvida seqüencialmente nas duas direções do sistema de coordenadas (s e z). 

{
??S p C pc?

? t
?

1
?

??? f p ut C pc?=0 ,

??S p C pc?
? t

?
1
?

???u grav p C pc?=0 .

 

(59)

Uma  solução  intermediária,  obtida  com  a  solução  da  primeira  equação  do  Sistema  (59),  é 

utilizada como condição inicial na solução da segunda equação.

Desmembrando-se o segundo termo da primeira equação do Sistema (59):

??S p C pc?
? t

?
1
?

??? f p ut C pc? =
??S p C pc?

? t
?

1
? [ut?? ? f p C pc?? f p C pc ??ut ] = 0 .  (60)

Como em escoamento incompressível ??ut é igual a zero, escreve-se a Equação (59) na forma:

{
? ? S p C pc?

? t
?
ut
?

?? ? f p C pc?=0 ,

??S p C pc?
? t

?
1
?

???u grav p C pc?=0 .

 

(61)

O mesmo raciocínio aplicado à Equação (57) que considera a soma de todos os componentes da 

fase leva ao sistema de equações que não envolve a concentração:

{
?? S p?

? t
?
ut
?

?? ? f p ?=0 ,

??S p ?
? t

?
1
?

???ugrav p ?=0 .
 (62)

É conveniente substituir a distância ao longo de uma linha de corrente pelo tempo de vôo. Da 

Equação (52):

d ?
ds

=
?
us

.  (63)

Como ut é paralelo à linha de corrente:

ut?? = u s
?
? s

= u s
d ?
ds

?
? ?

. (64)

33



Portanto:

ut?? = ?
?
? ?

.  (65)

A componente gravitacional de velocidade ugrav p é alinhada com a coordenada z. Os dois sistemas 

de equações do método de decomposição de operadores podem então ser expressos por:

{
??S p ?

? t
?

? ? f p ?
? ?

=0 ,

?? S p ?
? t

?
1
?

? ? u grav p ?
? z

=0 .

 

(66)

e

{
??S p C c ?

? t
?

? ? f p C c ?
??

=0 ,

??S p C pc?
? t

?
1
?

? ? u grav p C pc ?
? z

=0 .

 

(67)

onde ugrav_p é dado por [Equação (26)]:

u grav p=? K z ?
j=1

n fases

? ? p ? j?t ? ? pj? g .  (68)
O Sistema (66) é em geral resolvido numericamente para a determinação da movimentação 

das saturações. O campo de velocidades é determinado logo após a solução da pressão e usado 

tanto para o traçado das linhas como  na determinação do tempo de vôo. 

Para o tratamento de propriedades  de óleo variável, objetivo dessa tese, considerou-se o 

óleo  como  uma  mistura  de  dois  componentes.  Na  solução  das  linhas  de  corrente,  a  equação 

superior do Sistema (67) é resolvida logo após a solução da equação superior do Sistema (66). O 

mesmo procedimento é adotado no termo gravitacional com as equações inferiores dos Sistemas 

de Equações (66) e (67).

A primeira equação do Sistema (67) pode ainda ser desmembrada e simplificada, usando-se 

34



a equação superior do Sistema (66):

S p
??C c?

? t
? f p

? ?C c ?
? ?

?C c? ? S p? t ? ? f p? ? ?=0 ,  (69)
??C pc?

? t
?? f pS p ?

? ?C pc?
??

=0 .  (70)

Entretanto, essa forma  da equação  não  foi utilizada  no programa,  pois, assim, não seria 

possível um esquema de solução numérica com estrita conservação de massa, como ocorre na 

formulação do Sistema (67).

3.7 Solução de Transporte de Massa para Sistema Compressível

A saturação  está  associada  aos  volumes  das  fases,  os  quais,  no  caso  compressível,  são 

dependentes da pressão.  Por essa razão, o equacionamento da parte convectiva do problema se 

torna  mais  fácil  utilizando-se  concentração  de  massa  por  volume  de  rocha.  A solução  total  é 

dividida nas seguintes etapas:

? solução da pressão, consistente com o método IMPES;

? adequação  da  porosidade  e  das  saturações  ao  novo  campo  de  pressão,  mantendo-se 

constantes os campos de concentração de massa Mc;

? solução da movimentação de massa em termos de Mc e

? nova adequação da porosidade e das saturações ao novo campo de pressão.

Substituindo-se a velocidade pelos seus componentes na Equação (5), desconsiderando-se a 

pressão capilar e considerando que não existe injeção/produção de fluidos ao longo de uma linha 

de corrente:

??M c?
? t

? ?
j=1

n fases

??[? f j ut?ugrav p ? C jc ]=0 .
 

(71)

Aplicando-se  a  decomposição  do  operador  entre  a  direção  da  linha  de  corrente  e  a  direção 

vertical:

35



{
??M c?

? t
? ?

j =1

n fases

??? f jut C jc ?=0 ,

?? M c ?
? t

? ?
j=1

n fases

???ugrav j C jc ?=0.

 (72)

Uma das maneiras de se resolver a equação superior é desmembrando o segundo termo:

??M c?
? t

? ?
j=1

n fases

[ f j C jc ??ut?ut ? ? f j C jc ?]=0.  (73)

Aplicando-se as mesmas transformações usadas na Seção 3.6, obtém-se:

??M c?
? t

? ?
j=1

n fases

[ f j C jc r d ?? ? ? f j C jc ??? ]=0 ,  (74)
onde  rd =  ?ut, que na solução numérica pode ser obtido a partir do campo de velocidades, já 

determinado (Cheng et al., 2005).

Uma  outra  alternativa  para  solução  das  equações,  a  qual  foi  adotada  na  presente 

implementação  por  permitir  um  esquema  numérico  com  conservação  de  massa,   consiste  na 

utilização do fluxo mássico do componente c:

?
j=1

n fases

f j ut C jc=F c
s ,  (75)

onde Fc
s é a componente do fluxo mássico Fc na direção da linha de corrente s. Considerando 

que toda linha de corrente está associada a um tubo de escoamento imaginário (Figura 3.6):

F c
s =?Fc

s?=
?
j=1

n fases

Q s f j C jc

A
,

 (76)

onde Qs é vazão que cruza a área A  em determinada posição. Embora, em teoria, trate-se de um 

tubo de corrente, em termos práticos, todas as variáveis desse tubo são obtidas a partir da linha de 

corrente que o representa, não sendo necessário, portanto, o conhecimento real da sua geometria. 

A equação superior do Sistema (72) é então:

36



??M c?
? t

???Fc
s=0 .

 
(77)

Figura 3.6: Tubo de corrente associado a uma linha de 
corrente.

Aplicando-se o Teorema de Gauss a um segmento finito do tubo de escoamento:

?
?V s

? F c
s dV s =?

A

F c
s dA .  (78)

Utilizando-se (77):

??
? V s

? M c
? t

dV s=?
A

Fc
s dA .  (79)

Em uma seção do tubo de escoamento:

[ ? M c?t ]?? A F c
s ?2?? A F cs ?1
? V s

= 0 ,  (80)

onde M c é a concentração mássica média, 1 corresponde à face de entrada do escoamento e 2, 

à face de saída. Substituindo-se Fc
s, dado pela Equação (76) e considerando que a velocidade 

gravitacional, ugrav p, é alinhada com a coordenada z, obtém-se, quando o volume tende a zero, o 

37

Qs1

Tubo de Corrente



seguinte sistema de decomposição do operador, o qual substitui o Sistema  (72), originalmente 

deduzido: 

{
? M c
?t

? ?
j=1

n fases ?? Q s f j C jc ?
? V s

=0 ,

? M c
?t

? ?
p =1

n fases [? ? u grav p C pc ?? z ]=0 .

 

(81)

com ugrav_p dado pela Equação (68).

Para a solução do Sistema de Equações (81), necessita-se expressar o volume de rocha e a 

vazão total da linha de corrente em função da distância percorrida. Essas grandezas podem ser 

obtidas ao longo da linha de corrente em função do divergente  rd e do tempo de vôo  ? (Blunt, 

2008). A variação do tempo de vôo entre o início e o fim de um segmento infinitesimal de linha 

de corrente corresponde ao tempo necessário para o preenchimento do volume poroso:

d ?=
Q s

dV s ?
.  (82)

Obtêm-se, então, uma equação para a determinação do volume ao longo da linha em função de 

Qs e ?:

dV s=
Q s d ?

?
. (83)

Quando uma linha de corrente é lançada, a vazão total de injeção Qflux  no início da mesma 

é  determinada.  Em  um  escoamento incompressível,  a vazão  Qs é  constante,  igual  a  Qflux,  e  o 

tempo de vôo é proporcional ao volume poroso acumulado até uma determinada posição. Porém, 

se  o  escoamento  é  compressível,  a  vazão  varia  ao  longo  da  linha  de  corrente  e  essa 

proporcionalidade deixa de existir.

O divergente de um escoamento compressível, em um segmento infinitesimal de tubo de 

corrente, está associado com a vazão por:

38



? .ut=rd =
? Q s
? V s

 (84)

e

r d =
? Q s
??

d ?
d V s

.  (85)

Combinando-se (85) e (82) definimos uma equação que relaciona Qs e ?:

r d =
?
Q s

? Q s
? ?

.  (86)

Como  durante  a  solução  convectiva,  as  velocidades  se  mantêm  constantes  no  tempo,  pode-se 

considerar derivadas simples:

dQ
Q s

=
r d
?

d ? ,  (87)

ln Q s=ln Q flux??
0

?

rd
?

d ? .
 

(88)

Isolando-se Qs na Equação (87) e substituindo-se na Equação (83), pode-se também expressar o 

volume do tubo de corrente associado:

dV s=
d Q s
r d

.  (89)

O volume de um segmento de tubo de escoamento pode ser determinado por:

? V 12=?
Q s1

Q s2
d Q s

rd
.

 
(90)

Em um segmento no qual rd e ? são constantes:

ln Q s2=ln Q s1?
rd ? ?

?
, (91)

? V 12=
?Q s2?Q s1?

rd
. (92)

Essas  relações  são  muito  importantes  na  regularização  das  linhas  de  corrente,  na  solução 

39



numérica  e  no  mapeamento  das  novas  concentrações  de  massa  para   a  malha  de  simulação 

original.

O  tempo  de vôo entre  o primeiro nó da linha de  corrente,  correspondendo ao centro da 

célula injetora e o segundo nó, correspondendo à face da célula, deve ser o tempo necessário para 

o preenchimento do espaço poroso da célula pela vazão de injeção do poço. Pode-se determinar 

esse tempo, idealizando-se uma única linha de corrente que se inicia no centro dessa célula. Neste 

caso, obtêm-se das Equações (91)  e  (92) o seguinte sistema de equações:

{
Q s2=Q flux? rd V ijk , ,

Q s2=Q flux e
?rd ??2? ?

.

 (93)

onde  ??2 é  o  tempo  de  vôo  no  interior  da  célula  injetora,  Qs2 é  a  vazão  na  face  da  célula, 

correspondendo ao segundo nó,  Qflux é a vazão de injeção no primeiro nó de linha de corrente  e 

Vijk é o volume total da célula injetora. Desse sistema, determinamos:

? ?2=
?
rd

ln?1? r d V ijkQ flux ?.  (94)

A função exponencial da segunda equação do Sistema de Equações  (93) estabelece uma 

razão entre a vazão no ponto de injeção e a vazão na face da célula. Como todos os elementos do 

argumento da função exponencial (rd, ??2, ?) são independentes da definição da linha de corrente, 

pode-se, para qualquer número de linhas de corrente, estabelecer a seguinte relação para calcular 

a vazão no ponto de injeção, conhecendo-se a vazão na face da célula:

 
Q flux=Q s2 e

?? rd ??2? ?. (95)

O  mesmo  raciocínio  deve  ser  aplicado  para  determinar-se  o  tempo  de  vôo  dentro  da  célula 

produtora.

Para  a  solução  numérica  do Sistema  de Equações  (81),  fp,  que  é função  das  saturações, 

40



necessita  ser  freqüentemente  calculado.  Portanto,  na  implementação  desse  equacionamento,  é 

necessário definir alguma forma de equação de estado para a estimativa da saturação em função 

da pressão e da composição do fluido.  

41



Capítulo 4    

Simulador para Sistema Incompressível

O  simulador  desenvolvido  teve  como  base um  código  já  disponível,  o  qual  permite  a 

modelagem de sistemas bifásicos incompressíveis em malha tridimensional Cartesiana e regular, 

com possibilidade de definição de células inativas.

Grande parte das modificações realizadas envolveram a entrada de dados, a solução para o 

Sistema de Equações (67) e o mapeamento de propriedades para a malha de simulação. 

O programa final trabalha com as fases óleo e água. Para considerar variação da densidade 

do óleo, definiu-se a fase óleo com dois componentes. Esses componentes foram arbitrariamente 

nomeados de “óleo leve” e “óleo pesado” e devem compreender todo o intervalo de densidades 

de  óleo  encontradas  no  reservatório.  Entretanto  não  é  necessário  que  os  componentes  sejam 

estritamente  óleo  leve  ou  pesado,  como  foram  nomeados.  As  propriedades  PVT  devem  ser 

definidas para cada componente do óleo. Admite-se aqui que não existe variação de volume total 

de óleo quando os dois componentes são misturados.

Estas foram as modificações mais significativas feitas no programa:

? mudança no critério de ordenamento para pesquisa de células não atingidas por linhas de 

corrente regulares, como será explicado a seguir;

? leitura de propriedades de dois tipos extremos de óleo;

42



? leitura do campo de densidade de óleo em Grau API;

? armazenamento  do  campo  de  concentração  volumétrica  de  óleo  pesado  ( C h
vol )  com 

valores iniciais calculados em função do Grau API do óleo;

? alteração  no  processo  de  interpolação  para  cálculo  de  fluxo  fracionário,  incluindo-se 

viscosidade de óleo como função de C h
vol ;

? mapeamento de  C h
vol da malha de simulação para as linhas de corrente;

? solução de   C h
vol nas linhas de corrente;

? mapeamento de  C h
vol das linhas de corrente para a malha de simulação.

A aplicação do método de decomposição do operador em simulação por linhas de corrente 

consiste na  divisão do processo de solução do transporte de massa em duas etapas distintas:

1. solução  do  transporte  de  massa  na  direção  paralela  ao  escoamento  total  em  todo  o 

reservatório e

2. solução de movimentação vertical devida à gravidade.

A Seção 4.6 aborda a etapa de solução paralela ao escoamento total, enquanto a etapa relativa à 

gravidade é abordada na Seção 4.7.

4.1 Fluxograma

A Figura 4.1 mostra o fluxograma simplificado do programa para sistemas incompressíveis, 

apresentando as principais fases da simulação após as modificações realizadas. No Anexo 1, é 

apresentado outro fluxograma do mesmo programa, porém com um nível bem maior de detalhes. 

Embora o programa tenha, originalmente, outras opções de simulação, os fluxogramas mostrados 

se concentram na parte relativa à simulação com variação de densidade de óleo.

A  inicialização  consiste,  entre  outras  coisas,  na  leitura  dos  dados  da  simulação,  na 

numeração das células ativas e na construção da matriz de conexão entre blocos. 

43



Por não ser o foco do trabalho, não existe para a formulação incompressível um processo 

automático  de  definição  de  intervalos  de  tempo  de  solução  da  pressão.  Esses  tempos  são 

estabelecidos  através  da definição de tempo final  da  simulação,  número  de passos  desejado e 

histórico de alterações de restrições de produção e injeção.  Aumentando-se o número de passos, 

obtém-se uma solução mais acurada, devido ao tratamento explícito da saturação e do aumento da 

freqüência de soluções gravitacionais, como será explicado adiante. Por outro lado, isso acarreta 

um aumento do tempo de processamento, sendo necessário que se procure uma definição dos 

parâmetros de controle de passo de tempo que seja um bom compromisso entre velocidade de 

processamento e qualidade dos resultados.

A  solução  de  pressão  se  dá  através  de  diferenciação  da  equação  para  sistemas 

incompressíveis, obedecendo-se às restrições de operação dos poços. Após a solução da pressão, 

as velocidades de escoamento, necessárias para construção das linhas de corrente, são calculadas 

em todas as faces de células conectadas. 

Inicialmente, um conjunto de linhas de corrente regulares é lançado de todas as faces das 

células  pertencentes  aos  poços  injetores.  O  processo  de  construção  das  linhas,  regularização, 

solução numérica e mapeamento das novas propriedades para a malha de simulação é realizado 

linha a linha.

Após  o  lançamento  de  todas  a  linhas  regulares,  pode  acontecer  de  células  não  serem 

atingidas por nenhuma linha (Batycky, 1997), o que é explicado adiante com mais detalhes. Por 

essa razão, existe um processo adicional de varrimento de todas as células, procurando-se células 

não atingidas. Quando uma célula não atingida é encontrada, linhas complementares são lançadas 

desta célula, em direção contrária à velocidade, até que uma célula injetora seja encontrada. 

44



Início

Variar:
Tempo

Inicialização

Calcular Pressão

Linhas de Corrente
Complementares

Linhas de Corrente
Regulares

Mapear Sw e Ch para
malha de simulação

Resolver  Gravidade

Fim

Calcular Velocidades

Figura 4.1: Fluxograma simplificado do código de simulação 
por linhas de corrente para sistema incompressível.

45



Após o lançamento de todas as linhas regulares e complementares, os novos valores de Sw e 

C h
vol  a serem atribuídos a cada célula são calculados a partir de médias ponderadas pelo tempo 

de vôo entre as linhas que atravessam cada célula.

Finalmente, após a solução das linhas de corrente e mapeamento das propriedades na malha 

de  simulação,  existe  um  processo  de  solução  gravitacional,  realizado  em  todas  as  colunas  de 

células, de acordo com a técnica de decomposição do operador,  apresentada na Fundamentação 

Teórica (Capítulo 3).

4.2 Entrada de Dados

Devem ser informados  ao programa a geometria da malha de simulação, o número e as 

dimensões  das  células  nas  direções  x,  y e  z, podendo-se  também  informar,  porosidades, 

permeabilidades  nas  três  direções  e  indicador  de  célula  ativa  para  cada  célula  do  modelo. 

Também são informadas as propriedades da água e do óleo, permeabilidades relativas da rocha e 

saturação inicial de água. Existem alguns parâmetros adicionais que necessitam ser informados, 

destacando-se o número de linhas de corrente regulares que se deseja que sejam lançadas. 

No  caso  de  simulação  com  variação  nas  propriedades  do  óleo,  devem  também  ser 

fornecidos  valores de Grau API para cada célula do modelo.  Dois  conjuntos de propriedades 

PVT,  correspondentes  aos  componentes  do  óleo,  também  devem  ser  informados.  Para  cada 

componente  deve  ser  informado:  Grau  API,  pressão  de  saturação  (psat),  fator  de  formação  de 

volume  (Bo),  razão  de  solubilidade  (Rs)  e  viscosidade  (µ?) na  pressão  de  saturação  e  taxa  de 

variação da viscosidade com a pressão. A definição de Grau API das  células é convertida em 

concentração volumétrica de óleo pesado em condições de reservatório, como será explicado na 

próxima seção.

46



4.3 Determinação das Concentrações dos Componentes

Nas implementações realizadas, o óleo foi dividido em dois componentes: um componente 

chamado  “óleo pesado”, identificado  nas  equações  pela  letra  h, e  outro chamado  “óleo leve”, 

identificado nas equações pela letra l. 

Se  os  componentes  da  fase  óleo  são  incompressíveis,  pode-se  substituir  a  concentração 

dada em massa por volume C oh   do Sistema de Equações  (67) por concentração volumétrica 

do óleo pesado C oh
vol .

Da fórmula que define Grau API, define-se a seguinte relação numérica para o cálculo da 

massa específica do óleo em condições padrão:

??o =
141.500,0

131,5?API
(kg/m3 ).  (96)

Conhecendo-se  a  massa  específica,  a  concentração  volumétrica  de  óleo  pesado  C? h
vol   em 

condições padrão é dada por:

C? h
vol =

???o???ol ?
? ??oh???ol?

.  (97)

onde  ??ol e ??oh  correspondem às massas específicas em condições padrão dos componentes 

“leve” e “pesado”, respectivamente. O fator de formação de volume de uma mistura de óleos é 

dado por:

Bo =C? h
vol B oh??1?C? h

vol ? Bol .  (98)
Considerando-se certo volume de óleo “pesado”  Voh ? parte de um volume  Vo da fase óleo, em 

condições de reservatório ? a concentração volumétrica de óleo “pesado” é dada por:

C h
vol =

V oh
V o

=
?V? o C? h

vol ? B oh
V? o Bo

=C? h
vol b

bh
,  (99)

onde b é o inverso de Bo e pode ser calculado a partir de C h
vol por:

b=C h
vol ??1?C h

vol ?bl .  (100)

47



Usando-se  as  equações  acima,  é  possível  a  conversão  de  Grau  API  para  concentração 

volumétrica de óleo “pesado” e vice-versa.

Para a estimativa da viscosidade do óleo no reservatório, adotou-se a média aritmética dos 

inversos  das  viscosidades,  ponderada  pela  concentração  volumétrica,  o  que  é  coerente  com  a 

formulação  adotada  na  versão  comercial  do  simulador  por  diferenças  finitas  utilizado  nas 

validações:

1
?o

= C h
vol 1

?oh
? ?1?C h

vol ?
1
?ol

.  (101)

Desejando-se gerar um relatório de razão de solubilidade, a mesma pode ser calculada por:

R s=C? h
vol Rsh??1?C? h

vol ? R sl .  (102)

4.4 Definição dos Poços

Os  poços  podem  ser  controlados  por  pressão  de  fundo  ou  vazão  total  em  condições  de 

reservatório. É possível a definição de poços que atravessam várias células vizinhas alinhadas nas 

direções x, y e z.  Mais detalhes sobre as condições de contorno e produtividade dos poços podem 

ser encontrados em Batycky (1997). 

4.5 Solução da Pressão

Na solução da pressão, são consideradas somente as permeabilidades da diagonal do tensor 

de permeabilidades (Kx, Ky e Kz). A solução da pressão no simulador para sistema incompressível 

não necessita de um campo inicial de pressão, uma vez que a Equação  (41) envolve somente 

gradientes de pressão. Além disso, as propriedades de rocha e fluidos também são independentes 

da  pressão. Entretanto,  para  que  haja  uma  solução  única,  pelo  menos  um dos  poços  deve  ser 

controlado por pressão. 

48



Discretização:

Aplicando-se a Equação  (41) para o sistema óleo-água, com “óleo pesado” e “óleo leve” 

como componentes do óleo e considerando que a pressão capilar é desprezível:

?
1
?w

??[ ??K K rw?w ? ? p??w g ? z ? ?w ]?
?

1
?h

??[ ??K K ro?o ? ? p??o g ? z ? C oh]?
?

1
?l

??[ ??K K ro?o ?? p??o g ? z ?C ol ]=q o?qw .
 (103)

Por simplicidade, foi admitido no programa para sistemas incompressíveis que o efeito do 

gradiente da concentração dos componentes é insignificante na solução da pressão. Aplicando-se 

essa simplificação e a consideração da incompressibilidade dos fluidos:

???[ ??K K rw?w ?? p??w g ? z ?]???[
??K K ro

?o
?? p??o g ? z ?]=q o?qw .  (104)

Para o cálculo da pressão nas células, a discretização da Equação (104) em uma malha Cartesiana 

regular e horizontal é dada por:

1
? x { [ K x? K rw?w ? K ro?o ?]i?1 /2 ? pi?1? pi ?? x ?[ K x ? K rw?w ? K ro?o ?]i?1/ 2 ? pi? pi?1 ?? x }?
1

? y { [ K y ? K rw?w ? K ro?o ?] j?1 /2 ? p j?1? p j ?? y ?[K y? K rw?w ? K ro?o ?] j?1/ 2 ? p j? p j ?1 ?? y }?
1

? z { [ K z? K rw?w ? K ro?o ?]k?1/ 2 ? p k?1? p j ?? z ?[ K z? K rw?w ? K ro?o ?]k?1 /2 ? pk ? p k ?1 ?? z }?
1

? z { [K z g ? K rw ?w?w ? K ro ?o?o ?]k?1 /2 ? z k?1? zk ??
[ K z g ? K rw ?w?w ? K ro ?o?o ?]k?1 /2 ? z k? zk ?1 ?} = q w? ijk ? ? qo? ijk ?.

 

(105)

As vazões por unidade de volume podem ser expressas por:

49



q w ?ijk ?=
Qwinj ? ijk?

?? x ? y ? z ?
?

Q w? ijk ?
?? x ? y ? z ?

 (106)

e

q o ?ijk ?=
?Qo ?ijk ?

?? x ? y ? z ?
,  (107)

onde  Qwinj(ijk) é   a   vazão  de  água  injetada  na  célula  (i,j,k).  Qo(ijk)  e  Qw(ijk) correspondem, 

respectivamente, às vazões produzidas de óleo e água. Multiplicando-se a equação pelo volume 

da célula:

?T x?i?1/ 2 ? pi?1? pi ???T x ?i?1/ 2 ? p i? pi?1 ??
?T y ?j ?1 / 2 ? p j?1? p j ???T y? j ?1 /2 ? p j? p j?1 ??
?T z ?k?1 /2 ? pk?1? p j ???T z ?k ?1 / 2 ? pk? pk?1 ??

G k?1 /2 ? zk?1? z j ??G k?1/ 2 ? z k?z k?1 ?=
Q winj? ijk ??Qw ?ijk ??Q o ?ijk ?,

 
(108)

onde a transmissibilidade total na interface é calculada pela média harmônica entre as células:

?T x?i?1/ 2=
2

1
?T x?i

?
1

?T x ?i ?1
 (109)

e

?T x?i=[ Ax K x ??w??o ?? x ]i .  (110)
A x=? y ? z ,  (111)

?w=
k rw
?w

e ?o=
k ro
?o

. (112)

As expressões das transmissibilidades para as outras direções são análogas.

O termo de gravidade é também é calculado pela média harmônica:

G? k?1 /2? =
1

1
G k

?
1

Gk ?1

,
 (113)

onde:

G k=g [ Az K z ??gw??go ?? z ]k ,  (114)

50



?gw=
k rw ?w
?w

 e ?go=
k ro ?o
?o

(115)

A Equação  (108), aplicada a todas as células, forma um sistema linear que, no programa 

desenvolvido, é resolvido por um dos métodos iterativos: gradiente conjugado (JCG) e multigrid  

(AMG).  O  método  multigrid apresentou  maior  estabilidade  e  velocidade  de  solução,  sendo 

utilizado em todas as comparações apresentadas na Capítulo 7. Maiores detalhes sobre a solução 

do sistema linear também podem ser encontrados em Batycky, 1997.

Determinação do Campo de Velocidades:

Uma vez que as pressões foram definidas, calcula-se, pela lei de Darcy, a velocidade total 

aparente u em todas as interfaces entre células. Na direção vertical:

?u x ?k?1 /2 =
?T Z ?k ?1 / 2
? x ? y

? pk ? pk ?1 ??
?G ?k ?1/ 2
? x ? y

? zk? zk ?1 ?.
 (116)

As demais direções são análogas, porém, nas direções horizontais x e y, o termo de gravidade não 

é considerado. Para cada célula, as seis velocidades aparentes são divididas pela porosidade para 

obter-se  a  velocidade  intersticial  v que  é  armazenada  e  utilizada  na  construção  das  linhas  de 

corrente e determinação dos tempos de vôo.

4.6 Solução do Transporte de Massa nas Linhas de Corrente

As  linhas  de  corrente  regulares  são  lançadas  a  partir  das  faces  de  todas  as  células  que 

possuem  poços  injetores.  O  número  total  de  linhas  desejado  é  rateado  entre  as  faces,  em 

proporção à vazão total da face. As linhas de corrente são construídas e resolvidas uma a cada vez 

visando  economia  de  memória  RAM (Random  Access  Memory).  Em  cada  face,  os  pontos  de 

lançamento  de  linhas  de  corrente  são  distribuídos  igualmente  na  direção  horizontal  e 

aleatoriamente na direção vertical. A variação aleatória dos pontos de lançamento das linhas faz 

com  que,  no  decorrer  da  simulação,  um  número  maior  de  células  seja  atingido  por  linhas 

51



regulares, melhorando a qualidade da solução.  

Uma  vez  determinado  o ponto  de  lançamento  de  uma  linha  de  corrente,  traça-se  toda  a 

trajetória usando-se o método de Pollock, explanado na Secão 3.5, até que uma célula pertencente 

a um poço produtor seja encontrada. Ao mesmo tempo são determinados pela Equação  (53) os 

tempos de vôo em cada nó da linha de corrente. Nó significa a posição em que a linha de corrente 

passa  de  uma  célula  para  a  célula  seguinte  (Figura  4.2).  Por  definição,  em  células  com  poço 

injetor, o primeiro nó da linha de corrente corresponde ao centro da célula. O tempo de vôo entre 

o centro da célula injetora e a sua face corresponde ao tempo necessário para o preenchimento do 

volume poroso da célula pela vazão de injeção, o que assegura o balanço de massa da solução. O 

mesmo critério é aplicado ao último nó, quando se atinge o poço produtor. Além dos tempos de 

vôos, as saturações de água e concentrações de óleo pesado das células atravessadas também são 

armazenadas, estabelecendo-se assim um perfil inicial dessas propriedades como condição inicial 

para a solução da linha.

52

Figura 4.2: Definição de nó de linha de corrente lançada de 
um poço injetor. O primeiro nó corresponde ao centro da 
célula injetora.

1
2

3
4

5

6
7

8



Uma vez que a linha de corrente foi construída, os seguintes processos são executados:

1. regularização de linha de corrente em intervalos iguais de tempo de vôo;

2. solução simultânea de Sw e C h
vol ;

3. cálculo do volume de água e do componente óleo pesado transferidos ao poço produtor;

4. mapeamento entre a linha regularizada e a linha original e

5. transferência da informação de Sw e C h
vol  para a malha de simulação.

A Figura 4.3 ilustra como as linhas de corrente representam a solução de tubos de corrente 

associados. Em um sistema incompressível, a soma dos volumes dos tubos de corrente lançados 

de  todas  as  células  injetoras  corresponde  ao  volume  total  do  reservatório.  Como,  apenas  as 

trajetórias das linhas de corrente são consideradas, algumas células podem ficar sem solução após 

o lançamento das linhas regulares (células em branco na  Figura 4.3). Por esta razão existe um 

processo adicional de pesquisa de células não atingidas. Para cada célula ainda não atingida por 

uma  linha  de  corrente  que  é  encontrada,  uma  linha  complementar  é  lançada  do  centro  dessa 

célula em direção contrária à velocidade, até que uma célula de um poço injetor seja atingida. 

Quando  isso  ocorre,  a  ordem  dos  nós  da  linha  complementar  é  invertida  e  executam-se  os 

mesmos processos executados com as linhas regulares. Para melhor desempenho do programa, 

somente são mapeadas informações das linhas complementares para a malha original em células 

que  não  tenham  sido  previamente  atingidas  pelas  linhas  regulares,  evitando-se  médias  que 

envolvam tipos diferentes de linhas.

Uma  das  modificações  realizadas  no  programa  original  diz  respeito  ao  critério  de 

ordenamento  para  busca  de  células  não  atingidas.  Procurou-se evitar  a ocorrência  de  direções 

preferenciais  de  linhas  e ao  mesmo  tempo  otimizar  o  lançamento  das  linhas  complementares, 

atingindo-se um número  maior  de  blocos  em cada  linha.  O  critério  estabelecido  consistiu  em 

ordenar-se as células em função de uma distância média até as células injetoras. Essa distância 

média é calculada pela média harmônica, em unidade de número de blocos atravessados, entre 

cada  célula  do  modelo  e  todas  as  células  injetoras,  ponderadas  pelas  respectivas  vazões  de 

injeção. Assim, as células mais distantes dos poços injetores, e mais propensas a não ser atingidas 

por nenhuma linha regular, são as primeiras a serem testadas. 

53



Figura  4.3: Linhas de corrente saindo de um poço injetor 
(em vermelho) e tubos de corrente associados (delimitados 
pelas  linhas  tracejadas  azuis).  As  células  em  branco  não 
são atingidas por nenhuma linha de corrente.

Discretização:

Para a solução da saturação de água e da concentração volumétrica de óleo pesado em um 

sistema  bifásico,  as  seguintes  equações,  correspondentes  às  partes  superiores  dos  Sistemas  de 

Equações (66) e (67), devem ser resolvidas:

??S w ?
?t

?
? ? f w ?
??

=0  (117)

e

?[ S o C h
vol ]

? t
?

?[ f o C hvol ]
? ?

=0 .  (118)

Como o sistema é bifásico:

So=1?Sw  e f o=1? f w . (119)

Foi  mantido,  para  a  solução  numérica,  o  método  explícito  de  discretização  por  ponto 

simples  a  montante, utilizado  no programa  original. A equação  discretizada para  a solução  da 

54



saturação em um segmento de linha de corrente i é:

?S w ?i
m?1= ?S w ?i

m ?
? t
??

[ ? f w?im?? f w ?i ?1m ],
 

(120)

onde m é o indicador do passo de tempo, ?t é o intervalo de tempo utilizado na solução da linha 

de corrente,  ?? é o intervalo de tempo de vôo da linha de corrente após a regularização e (fw)i-1 e 

(fw)i são os fluxos fracionários de água a montante e à jusante do segmento, os quais são função 

da saturação.

Imediatamente após a determinação da saturação de água em um segmento, o produto  da 

concentração de óleo pesado pela saturação de óleo é determinado por:

?S o C h
vol ?i

m?1= ? S o C h
vol ?i

m?
? t
? ?

[?S o C hvol ?im?? So C hvol ?i ?1m ]  (121)
e a nova concentração de óleo pesado é calculada utilizando-se a nova saturação, já determinada:

?C h
vol ?i

m?1=
?S o C h

vol ?i
m?1

S o
m?1 .  (122)

Regularização das Linhas de Corrente:

Antes da solução numérica por diferenças finitas é necessário um processo de regularização 

das  linhas  de  corrente  em  intervalos  de  tempo  de  vôo  constantes.  A  Figura  4.4 representa  o 

problema da regularização. Na parte superior da figura está esquematizada uma linha de corrente 

original, com os seus segmentos correspondendo aos intervalos entre os nós. Na parte inferior 

está  esquematizada  a  linha  de  corrente  após  a  regularização.  O  segmento  regularizado  n° 3, 

destacado em vermelho, à esquerda, engloba mais de um intervalo da linha original, enquanto que 

o segmento n° 4 está todo contido dentro de um único intervalo da linha original. Quando não 

existe coincidência entre os limites dos segmentos, o intervalo de linha original é dividido, como 

pode ser observado em relação ao intervalo n° 7 da linha original.

55



Figura  4.4: Exemplo representativo do processo de regularização da 
linha de corrente. O segmento regularizado n° 3 engloba os intervalos 
n° 4, n° 5, n° 6 e parte do intervalo n° 7 da linha original. Por outro 
lado,  o  segmento  regularizado  n° 4  está  inteiramente  contido  no 
intervalo n° 7 da linha original.

O número de elementos da linha regularizada é um múltiplo do número original de nós da 

linha.  Para  problemas  incompressíveis  observa-se  que  dois  é  um  multiplicador  adequado.   A 

regularização é realizada de tal forma que haja conservação das massas das fases envolvidas na 

simulação. Quando o escoamento é incompressível, a vazão na linha é uniforme em toda a sua 

extensão. Sabemos da Equação  (83) que, neste caso, o tempo de vôo é proporcional ao volume 

poroso,  portanto  as  seguintes  expressões,  que  possuem  conservação  de  massa,  são  usadas  no 

processo de  regularização:

[??1
?2

S w d ?]regular= [??1
?2

S w d ?]irrregular ,  (123)
[??1

?2

?1?S w ?C h
vol d ?]regular = [??1

?2

?1?Sw ?C h
vol d ?]irrregular .  (124)

A saturação  de  água  e  a  concentração  de  óleo  pesado  são  obtidos  através  da  integração 

numérica das Equações (123) e (124). Na situação em que um trecho regularizado engloba vários 

nós, as médias são obtidas por:

56

Linha de Corrente Original

Linha de Corrente Regularizada

3 4 5 6 7 8

2 3 4 5



?S w ?i =
?

j
S w ?? j ?? j ?1 ?

? ?i
 (125)

e

?C h
vol ?i=

?
j

C h
vol S o ?? j ?? j?1 ?

?
j

S o ?? j?? j?1 ?
.  (126)

Quando  o  trecho  regularizado  está  contido  no  intervalo  entre  dois  nós,  a  saturação  e  a 

concentração do intervalo são simplesmente copiadas para o trecho regularizado.

O mesmo procedimento é utilizado após a solução da linha, para a transferência dos novos 

perfis de saturação e concentração das linhas de corrente para as células da malha original.

Condições de Contorno:

Necessita-se de condições de contorno para a solução das Equações (120) e (121).

As condições iniciais são dadas pelas distribuições iniciais de saturação e concentração de 

óleo pesado, que são obtidas a partir da malha de simulação no processo de regularização.

Como  se  trata  de  simulação  de  injeção  de  água,  utiliza-se  para  a  primeira  equação  as 

seguintes condições de fronteira no ponto de injeção da linha:

? f w?i=0
m =1 e ? f o C h

vol ?i=0
m =0 . (127)

Intervalo de Tempo de Solução de Linhas de Corrente:

Uma das vantagens da simulação por linhas de corrente é a possibilidade de se utilizar o 

intervalo de tempo mais adequado na solução de cada linha. A estabilidade da solução de (120) é 

obtida pelo critério de Courant-Fredrich-Lewy com  N c
sl ? 1 (Courant  et al., 1967; Batycky, 

1997):

? t sl=
N c ? ?sl

vmax
c ,  (128)

onde v max
c representa a máxima velocidade de choque esperada. Quando existe somente óleo e 

57



água, v max
c pode ser estimado a partir da curva de fluxo fracionário. Entretanto, no programa 

original, esse valor é calculado a partir do perfil de saturação da própria linha de corrente:

?vmax
c ?sat=

[? f w ?i ?? f w?i?1 ]
[?S w ?i ??S w?i?1 ]?máximo .  (129)

Como  a  concentração  é  resolvida  no  mesmo  passo  de  tempo  que  a  saturação,  o  intervalo  de 

tempo também é restrito pela velocidade da frente de concentração, a qual pode ser determinada 

por:

dC =
? C c
? t

dt ?
?C c
? ?

d ? = 0 ,  (130)

d ?
dt

=?
[ ? C c? t ]
[ ? C c?? ]

.  (131)

Usando-se a Equação (70):

?vmax
c ?=

? f o ?i
? S o?i ?máximo .  (132)

O máximo intervalo de tempo utilizado é calculado por: 

? t sl=
N c ? ?sl

máximo[?vmaxc ?sat ,?v maxc ?C ]
.  (133)

Cada linha de corrente é resolvida várias vezes, obedecendo-se o máximo intervalo de tempo para 

estabilidade, até que o intervalo de tempo utilizado na solução de pressão seja atingido (Figura

3.2).

Composição Média no Poço Produtor:

Em um passo de tempo de pressão, o fluxo fracionário de um poço produtor é calculado por 

uma média entre os fluxos fracionários das linhas de corrente que chegam a esse poço:

? f w?prod =
?
sl=1

nlin

?Q flux ?sl ? f w?sl

?
sl=1

nlin

?Q flux?sl

,  (134)

58



onde  nlin é o número de linhas de corrente que atinge a célula e  ? f w?sl é o fluxo fracionário 

acumulado na linha de corrente sl no intervalo de tempo de solução de pressão.

? f w ?sl =
?
m=1

nsol

[? t m ? f w ?i=Nm ]
? t pres

,
 (135)

onde nsol é o número de soluções internas de uma linha de corrente, N é o número de segmentos 

da linha regularizada, ?t m é  o intervalo de tempo de uma solução de linha de corrente e  ?t pres é o 

intervalo de tempo da solução de pressão.

Da mesma forma, a composição de óleo é calculada por:

 ?C h
vol ?prod =

?
sl=1

nlin

?Q flux ?sl ? f o ?sl ?C h
vol ?sl

?
sl =1

nlin

?Q flux?sl ? f o?sl

, (136)

?C h
vol ?sl =

?
m=1

nsol ?1

[ ?t m ?1 ? f o?i= Nm ?C hvol ?i= Nm ]
? f o?i= N

m ? t pres
.

 (137)

Esta forma de cálculo garante o valor correto  da composição média produzida, mesmo quando a 

solução das linhas de corrente exige muitas iterações.

Mapeamento para Malha Original:

Quando diversas linhas de corrente atravessam uma célula, é interessante a determinação da 

nova saturação e da nova concentração de óleo pesado desta célula através de média ponderada 

(Figura 4.5).  A base de ponderação para essa média é, em teoria, o volume poroso dos tubos de 

escoamento associados a cada linha dentro da célula, para o mapeamento da saturação, e volume 

de  óleo,  para  mapeamento  da  concentração  de  óleo  pesado.  Em  sistemas  incompressíveis,  o 

volume poroso associado a uma linha de corrente entre dois pontos é, por definição, igual ao 

produto  da vazão  da linha  pelo  intervalo  de  tempo  de  vôo. Para  a  saturação,  Batycky (1997) 

propõe uma média ponderada pelo “comprimento” do tempo de vôo de cada linha dentro de uma 

célula. Entretanto, as variações entre as vazões associadas a cada linha  podem alterar levemente 

o  resultado.  A  consideração  dessas  variações  não  acarreta  aumento  significativo  de  esforço 

59



computacional e, por essa razão, a saturação e a concentração média de uma célula atravessada 

por linhas de corrente são calculadas nesta implementação por:

?S w ?ijk
? n?1?inter=

?
sl

?? ?sl Q flux
sl S w

sl ?

?
sl

?? ?sl Q flux
sl ?

,  (138)

?C h
vol ?ijk

? n?1?inter =
?

sl
?? ?sl Q flux

sl S o
sl C h

vol ?

?
sl

???sl Q flux
sl S o

sl ?
.  (139)

onde  ? ?sl significa  o  intervalo  de  tempo  de  vôo  da  linha  de  corrente  sl dentro  da  célula 

calculada e (n+1)inter indica que a solução corresponde ao final do intervalo de tempo de pressão, 

porém é intermediária no processo de decomposição do operador.  No caso das linhas de corrente 

complementares, cujas vazões não são determinadas, manteve-se o critério de média ponderada 

pelo tempo de vôo:

?S w ?ijk
? n?1?inter=

?
sl

?? ?sl S w
sl ?

?
sl

?? ?sl ?
,  (140)

?C h
vol ?ijk

? n?1 ?inter =
?

sl
?? ?sl S o

sl C h
vol ?

?
sl

?? ?sl So
sl ?

.  (141)

Após a determinação dos fluxos fracionários em cada completação de um poço produtor, as 

produções de fases e componentes são somadas para a determinação dos valores totais do poço.

60



Figura 4.5: Mapeamento da saturação e da concentração. 

4.7 Gravidade

As saturações e concentrações mapeadas para a malha original, após a resolução das linhas 

de corrente, correspondem às soluções intermediárias do método de decomposição do operador. 

Após essa etapa o movimento gravitacional dos fluidos, determinado pelas equações inferiores 

dos Sistemas de Equações (66) e (67) deve ser resolvido em cada coluna de células. 

Discretização:

A discretização das equações inferiores dos Sistemas de Equações (66) e (67) é feita em um 

esquema explícito de ponto simples, de forma semelhante à resolução das linhas de corrente:

?S w ?k
n?1= ?S w ?k

? n?1?inter ?
1
?k

? t
? z [ ?u grav_w?k?1/ 2

? n?1?inter??u grav_w ?k?1/ 2
? n?1?inter ] ,

 
(142)

?S o C h
vol ?k

n?1= ? S o C h
vol ?k

? n?1?inter ?
1
?k

? t
? z [?ugrav_o C h

vol ?k?1/ 2
? n?1?inter??u grav_o C h

vol ?k?1 /2
? n?1?inter ] ,  (143)

?C h
vol ?k

n?1=
?S o C h

vol ?k
n?1

S o
n?1 .  (144)

61

Linha de Corrente 1

Linha de Corrente 2

Linha de Corrente 3

? 1a

? 2a

? 1b

? 2b

? 3a

? 3b

? ?
1
=?

1b
-? 1

a

? ? 2
=? 2b

-? 2a

? ? 1
=? 3b

-? 3a
Q1

Q2

Q3



A velocidade da água devida à gravidade é calculada pela Equação (26):

?u grav_w ?k?1/ 2=[ ? K ?w ?o ???t ? ]k ?1/ 2 ??o ??w ?k?1 /2 g .  (145)
As propriedades na interface dependem da direção de corrente (Batycky, 1997). Se o escoamento 

de  água  é  descendente  (?w &gt;  ?o),  todas  as  propriedades  relativas  ao  escoamento  de  água,  são 

tomadas na célula superior enquanto as propriedades relativas à fase óleo são tomadas na célula 

inferior. Considerando-se um sistema de coordenadas onde o eixo z aponta para baixo:

[? K ?w ?o ???t ? ]k?1 /2=[
? K ??w ? K ??o

? K ??w?? K ??o ]k?1/ 2 ,
 

(146)

[? K ?w ?o ???t ? ]k?1 /2=
? K K rw?k ? K K ro?k ?1

? K K rw?k ??o ?k?1 ? K K ro ?k?1 ??w ?k
,

 
(147)

??o??w ?k?1/ 2=??o ?k?1???w?k .  (148)
Caso o escoamento de água seja ascendente, os índices das camada devem ser trocados. Pode-se 

observar que o termo de mobilidade é o mesmo para as duas fases, o que leva à relação:

u grav_o = ?u grav_w .  (149)
A concentração de óleo pesado a ser usada na Equação (143) também irá depender da direção de 

escoamento  do  óleo.   No  caso  de água  com escoamento  descendente  e  óleo  com escoamento 

ascendente:

?C h
vol ?k ?1 / 2=?C h

vol ?k?1 ,

?C h
vol ?k ?1 / 2=?C h

vol ?k .
 (150)

Intervalos de Tempo na Solução Gravitacional:

Assim como no escoamento ao longo das linhas de corrente, o intervalo de tempo utilizado 

na solução gravitacional para garantir estabilidade é:

? t sl=
N c ? z

máximo[?vmax?sat ,?v max?C ]
,  (151)

onde as velocidades (se o  escoamento de água for descendente), são dadas por: 

?vmax?
sat=

1
?k

[?u w
grav?k ?1/ 2??uw

grav ?k?1 /2 ]
[? S w ?k?? S w ?k?1 ] ?máximo  (152)

e

62



?vmax?
C =

1
?k

?uo ?i
? S o?i ?máximo ,  (153)

onde: 

?uo?k =?[ ?uw?k ?1/ 2??uw?k ?1 / 2 ] .  (154)

Correção de Intervalo de Tempo para Erros de Balanço de Massa:

Os  mapeamentos  de  saturação  e  concentração  entre  as  células  da  malha  e  as  linhas  de 

corrente não garantem a estrita conservação de massa. Em vista disso, após a solução convectiva 

e cálculo dos novos volumes “in situ”, uma correção, do mesmo tipo da apresentada por Batycky 

(1997), é efetuada no intervalo de tempo garantindo-se balanço global de massa. O intervalo de 

tempo real é calculado pela vazão média de produção de água e variação do volume de água no 

reservatório, assegurando-se a conservação do volume desta fase:

? t corrigida
n?1 =

W 0?W inj?W p?W
n

Qw?Q winj
,  (155)

onde W0 e W n são os volumes de água no reservatório inicial e anterior ao passo de tempo, Wp e 

Winj   são  os  volumes   de  água  produzidos  e  injetados  e  Qw e  Qwinj são  as  vazões  médias  de 

produção e injeção no intervalo de tempo.

63



Capítulo 5    

Simulador para Sistema Compressível

Aplicando-se o desenvolvimento teórico apresentado no Capítulo  3, foi desenvolvido um 

simulador  por  linhas  de  corrente  para  sistemas  com  compressibilidade  de  rocha  e  fluidos  e 

variação espacial das propriedades iniciais do óleo. A construção desse programa teve por base o 

programa para sistemas incompressíveis. Porém muitas rotinas foram especialmente criadas ou 

tiveram que sofrer grandes mudanças.

Até onde chega o conhecimento do autor, os métodos utilizados na regularização e solução 

das linhas de corrente e no controle de passo de tempo de solução de pressão descritos neste 

capítulo são originais.

Como explicado na Seção 3.7, em vez da solução em termos de saturação de água, utilizada 

usualmente em simuladores por linhas de corrente para sistema incompressível, a movimentação 

de fluidos foi tratada em termos de concentrações de massa por volume de rocha. O princípio 

básico  da  simulação  por  linhas  de  corrente  com compressibilidade  aplicado  aqui  consiste  nos 

seguintes passos:

1. solução da pressão com consideração de compressibilidade, independente da solução de 

movimentação de fluidos;

2. cálculo  do  novo  campo  de  porosidades  e  saturações,  mantendo-se  o  campo  de 

concentrações de massa;

64



3. solução da movimentação de massa e

4. determinação  das  novas  saturações,  em  função  das  novas  concentrações  mássicas, 

compressibilidades e pressões das células.

Assim como na implementação para sistemas incompressíveis, são considerados as fases 

água e óleo, sendo que a fase óleo é composta por um componente “óleo pesado” (h) e outro 

“óleo  leve”  (l). Foi  admitido,  na  formulação  implementada,  que  os  componentes  do  óleo  não 

sofrem mudança de volume pelo fato de se alterar a proporção de mistura entre eles.

No  traçado  de  linhas  de  corrente  com  compressibilidade,  é  importante  observar  a 

possibilidade  da  ocorrência  de  células  “fonte”  (Blunt,  2008;  Thiele,  2003),  de  onde  linhas  de 

corrente  adicionais  devem  ser  lançadas,  e  células  “sumidouro”,  onde  todos  os  fluxos  são  em 

direção ao seu interior, interrompendo as linhas de corrente que as atingem.

Além  dos  dados  necessários  para  a  simulação  incompressível,  devem  ser  informados: 

compressibilidade  de  poros,  compressibilidade  dos  componentes  do  óleo  e  da  água,  taxas  de 

variação de viscosidade dos componentes do óleo com pressão, pressão inicial e  profundidade de 

referência. Os dois últimos dados não são necessárias na simulação de sistemas incompressíveis.

Na  simulação  com  compressibilidade  surgem  muitos  problemas  numéricos  que  não 

ocorrem em casos incompressíveis e para os quais alguns cuidados devem ser tomados em termos 

de programação. São mostradas nas seções a seguir as principais ações que foram tomadas neste 

programa  e  que  foram  essenciais  para  se  chegar  a  um  código  suficientemente  estável  para  a 

solução de casos relativamente complexos, como os que são apresentados no Capítulo 7.

O  programa  também  dispõe  de  uma  opção  para  simulação  de  sistema  incompressível, 

mantendo-se a formulação em termos de concentrações mássicas.

Como  existem  muitas  similaridades  entre  este  programa  e  o  código  para  sistemas 

incompressíveis, este capítulo aborda primordialmente as diferenças entre os dois programas.

65



5.1 Fluxograma

O fluxograma simplificado do programa para simulação em sistemas compressíveis pode 

ser  visto  na  Figura  5.1.  Um  fluxograma  detalhado  é  apresentado  no  Anexo  2.  A estrutura  do 

fluxograma  é  semelhante  à  do  programa  para  sistema  incompressível.  Em  relação  àquele,  é 

acrescentada uma etapa de cálculo de novas porosidades, logo após a solução da pressão, uma 

etapa  de  lançamento  de  linhas  de  corrente  de  células  “fonte”  e  duas  etapas  de  cálculo  de 

saturações nas células, em  função das concentrações mássicas dos componentes, uma antes e 

outra após a solução da gravidade.

Na etapa de inicialização são determinadas as relações volumétricas entre os componentes 

do óleo nas células, em função do campo de Grau API. Em seguida estabelece-se o equilíbrio 

inicial de pressão e as composições iniciais de óleo.

Logo após a solução da pressão as porosidades e as saturações são recalculadas em função 

das  novas  pressões  e  da  compressibilidade  da  rocha.  O  campo  de  porosidade  é  utilizado  na 

determinação do tempo de vôo das linhas de corrente e no cálculo dos divergentes de velocidade 

que são utilizados na solução convectiva. 

As  variáveis  referentes  à  movimentação  de  fluidos  são  as  concentrações  mássicas  por 

volume de rocha Mw, Mh e Ml. As novas concentrações mássicas são obtidas na solução das linhas 

de corrente e mapeadas para a malha de simulação.

Existem três etapas de cálculo de saturações nas células da malha de simulação. A primeira, 

logo após a solução de pressão, considera a variação devida às compressibilidades de rocha e 

fluidos e não possui impacto significativo nos resultados. As outras duas etapas de cálculo de 

saturações são importantes para a determinação das corretas mobilidades das células, antes da 

solução da gravidade e da nova solução de pressão.

66



Figura 5.1: Fluxograma simplificado do código de simulação por linhas de corrente 
para sistemas compressíveis.

67

Início

Variar:
Tempo

Inicialização

Calcular Pressão

Linhas de Corrente
Complementares

Linhas de Corrente
Regulares

Mapear Mh, Ml, Mw para
malha de simulação

Resolver  Gravidade

Fim

Calcular Velocidades

Linhas de Corrente
de Células Fonte

Calcular Saturações

Calcular Saturações

Calcular Novas
Porosidades

Final

Calcular Saturações



5.2 Determinação das Concentrações dos Componentes

As Equações (96) a (100) ainda são válidas para sistemas compressíveis. Porém os fatores 

de  formação  de  volume  dos  componentes  do  óleo,  Boh e  Bol  não  são  mais  constantes,  pois 

dependem da pressão da célula. Além disso, deve-se que trabalhar com concentrações em massa 

do componente c por volume da fase p, Cpc, e concentrações por volume de rocha, Mc. Admite-se 

aqui, como em todo o trabalho, que não existe variação de volumes em função de mistura de 

componentes.

Na formulação  que foi adotada para  sistema  compressível  define-se as  propriedades  dos 

componentes óleo pesado e óleo leve em suas pressões de saturação ? phsat e p lsat ? . A massa 
específica de gás liberado do óleo em condições padrão, ??g , também deve ser definida.

A compressibilidade isotérmica do óleo, acima da pressão de saturação, é definida por:

co=?
1
vo

dvo
dp

,  (156)

onde, vo é o volume específico. Como o volume específico é proporcional a Bo:

co=?
1
Bo

dB o
dp

.  (157)

Em  uma  determinada  pressão,  o  fator  de  formação  de  volume  de  um  componente  pode  ser 

explicitado, em função da pressão por:

Boc=B oc
sat e[?co ? p? p c

sat? ] .  (158)
Nas escalas de valores com que se trabalha em reservatórios de petróleo, o função exponencial 

pode ser substituída pelos dois primeiros termos da sua série de Taylor, sem perda significativa de 

precisão. Portanto, os fatores de formação dos dois componentes são dados por:

Boh= Boh
sat [ 1?co ? p? ph

sat ?]  (159)
e

Bol =B ol
sat [ 1?co ? p? pl

sat ?] .  (160)

68



A concentração do componente óleo pesado em condições de reservatório pode ser expressa 

por:

C oh =
? massa de óleo pesado ?

?volume de óleo?
=

V? h ??h?V? h R sh ?g
V? o B o

,  (161)

onde  V? o  significa um volume arbitrário de óleo em condições padrão.  Da relação entre os 

volumes:

C oh =
C? h

vol ???h ?Rsh ?g ?
Bo

,  (162)

onde Bo é calculado pela Equação (98), com os fatores de formação de volume dos componentes 

dados pelas Equações (159) e (160). Da mesma forma, para o componente óleo leve:

C ol =
C? l

vol ? ??l? Rsl ?g ?
Bo

.  (163)

A massa específica do óleo é dada por:

?o =C oh?C ol .  (164)
A massa específica da água é calculada em função de uma massa específica de referência ?w

ref

por:

?w=?w
ref [1?cw ? p? p

ref ?].  (165)

As concentrações dos componentes água, óleo leve e óleo pesado em função de volume de 

rocha são calculadas, respectivamente, por:

M w=? S w ?w ,    M l =??1?S w ?C ol ,  e M h=? ?1?S w? C oh .     (166)

Como essas concentrações são as variáveis resolvidas na simulação, necessita-se, para fins 

de mapas de saída, de uma relação para convertê-las em Grau API. As massas dos componentes 

do óleo podem ser expressas tanto em condições padrão, como em condições de reservatório:

mh = V? h ? ??h? R sh ?g ? = C oh V o  e ml = V? l ???l ?R sl ?g ? = C ol V o ; (167)

V? h=
C oh V o

???c? Rsc ?g ?
 e V? l =

C ol V o
? ??l? Rsl ?g ?

. (168)

A concentração volumétrica do óleo pesado em condições padrão é dada por:

69



C? h
vol =

V? h
?V? h?V? l ?

.  (169)

Das equações acima:

C? h
vol =

C h ???l ?R sl ?g ?
C h ???l? Rsl ?g ??C l ???h?R sh ?g ?

,  (170)

que também pode ser expressa em temos de Mc, devido à proporcionalidade entre as grandezas:

C? h
vol =

M h???l ?R sl ?g ?
M h ???l?R sl ?g ??M l ???h?Rsh ?g ?

.  (171)

Conhecendo-se  a  razão  volumétrica C? h
vol ,  a  dedução  do  Grau  API  é  imediata,  usando-se  as 

Equações (96) e (97).

A viscosidade do óleo é dada pela Equação  (101)  onde as viscosidades dos componentes 

são funções lineares da pressão:

?oh=?oh
sat?cvh? p? ph

sat?  e ?ol=?ol
sat?cvl ? p? pl

sat?, (172)
onde cvc é a taxa de variação da viscosidade do componente c com a pressão.

5.3 Solução da Pressão

Ao contrário do caso compressível, a solução da pressão necessita de um campo de pressão 

inicial e, neste caso, pode-se definir todos os poços controlados por vazão.

Na  implementação  que  foi  feita,  assim  como  no  caso  incompressível,  somente  as 

permeabilidades da diagonal do tensor de permeabilidades são consideradas.

Inicialização:

Uma vez que a pressão hidrostática é função da massa específica dos fluidos, a qual em 

fluidos  compressíveis  depende  da  pressão,  torna-se  necessário  um  processo  iterativo  para 

inicialização  da  simulação.  Essa  inicialização  é  feita  independentemente  para  cada  coluna  de 

células.

70



Os  valores  de  Grau  API  atribuídos  a  cada  célula  do  modelo  são  convertidos  em 

concentração volumétrica de óleo pesado em condições padrão através das Equações (96) e (97).

Para inicialização, a pressão inicial média e sua correspondente profundidade devem ser 

informadas. Essa pressão é transferida para as profundidades médias das camadas de simulação 

logo acima e logo abaixo do contato óleo-água, considerando massa específica média de óleo ou 

água,  dependendo  das  profundidades.  Em  seguida,  o  equilíbrio  em  cada  coluna  de  células  é 

estabelecido iterativamente acima e abaixo do contato óleo-água. Acima do contato, é utilizada a 

massa específica de óleo calculada pelas Equações (159) a (164). Admite-se aqui que o óleo é a 

fase contínua no meio poroso acima do contato óleo-água.

Quando a densidade inicial do óleo varia horizontalmente, existe um pequeno desequilíbrio 

entre  colunas  adjacentes.  Admite-se  que  as  propriedades  do  óleo  foram  alteradas  por  alguma 

razão  após  a  sua  migração,  não  estando  na  realidade  em  perfeito  equilíbrio  no  reservatório 

(Gibson,  2006;  Dindoruk  e  Al  Kindi,  2007).  Pode-se,  porém,  observar  por  simulações,  que  o 

tempo  necessário  para  que  esse  equilíbrio  ocorra  é  infinitamente  superior  aos  períodos  de 

produção de um campo de petróleo.

Discretização:

Apesar  de  existirem  na  formulação  IMPES  vários  métodos  para  abordar  a  variação  das 

transmissibilidades com o tempo (Aziz e Settari, 1979), adotou-se por simplicidade neste trabalho 

transmissibilidades definidas no início do passo.

Como não existe transferência de massa entre fases e como o volume dos componentes do 

óleo não se altera quando ocorre mistura, a Equação  (40) se aplica a este modelo. Aplicando-se 

esta equação para as fases água e óleo composto pelos componentes “óleo pesado” e “óleo leve” 

e considerando solução para casos onde a pressão capilar é desprezível:

71



? ct
? p
? t

??[?? S w?S h ?S l ?? t ] ?
?

1
?w

??[ ??K K rw?w ? ? p??w gg c ? z??w]?
?

1
?h

??[ ??K K ro?o ?? p??o gg c ? z ?C oh]?
?

1
?l

??[ ??K K ro?o ?? p??o gg c ? z ?C ol] = ?j=1
n fases

q j ,

 (173)

onde:

ct =cr ?S w cw?So co ,  (174)

co=C oh
vol ch?C ol

vol cl .  (175)
Ao  contrário  da  formulação  para  sistemas  incompressíveis,  na  formulação  para 

compressibilidade, os gradientes de concentração devem ser mantidos.

A  discretização  da  Equação  (173) tem  forma  similar  à  discretização  para  sistemas 

incompressíveis (108), acrescida de termos de acumulação e variação de saturações:

?V ? c t ?ijk
? t

? pin?1? pin? ?
?V ? es ?ijk

? t
?

?T x
n ?i ?1/ 2 ? pi?1

n?1? pi
n?1 ? ? ?T x

n ?i?1/ 2? pi
n?1? pi ?1

n?1? ?
?T y

n ?j ?1 / 2 ? p j?1
n?1? p j

n?1 ? ? ?T y
n ?j ?1 / 2 ? p j

n?1? p j?1
n?1 ? ?

?T z
n?k?1 /2 ? pk?1

n?1? p j
n?1 ? ? ?T z

n ?k?1 /2? p k
n ?1 ? p k?1

n?1 ? ?
G k?1 /2

n ? z k?1? z j ? ? G k?1/ 2
n ? z k? zk?1 ?=

Q winj? ijk ? ? Q w? ijk ? ? Q o? ijk ?,

(176)

onde es é o erro de soma de saturações na última solução convectiva (Trangenstein e Bell, 1989; 

Blunt, 2008).

No  cálculo  de  transmissibilidades  médias  da  presente  implementação,  foram  mantidas 

aproximações baseadas em médias harmônicas, utilizadas no programa original. As definições de 

T e  G diferem  da  definição  no  caso  incompressível  por  incluir  as  concentrações  e  as  massas 

específicas da água e do óleo:

72



?T x?i?1/ 2=?T wx ?i?1/ 2??T hx?i?1 /2??T lx?i?1 /2 ,  (177)
com:

?T wx ?i?1/ 2=
1

? ?w?i [
2

1
?T wx

* ?i
?

1
?T wx

* ?i?1 ], ?T cx ?i ?1 / 2=
1

??c?i [
2

1
?T cx

* ?i
?

1
?T cx

* ?i ?1 ], (178)
?T wx

* ?i=? Ax K x ?w ?w? x ?i , ?T cx
* ?i =? Ax K x ?o C oc? x ?i , (179)

?w=
k rw
?w

e ?o=
k ro
?o

.  (180)

Deve-se observar que, como a transmissibilidade entre as células  i e  i+1 tem os  termos 

divididos pela  ?i, Equação  (178), enquanto a transmissibilidade entre as células  i+1 e  i tem os 

termos  divididos  por  ?i+1,  a  matriz  do  sistema  de  equações  não  é  simétrica,  o  que  impede  a 

utilização de somente uma triangular na sua solução.

O termo de gravidade é calculado por:

G k?1/ 2=?Gw ?k?1 /2 ??G h?k?1/ 2??Gl ?k ?1 / 2 ,  (181)
onde:

?Gw ?k?1 /2=
1

??w ?k [
2

1
?G w

* ?k
?

1
?G w

* ?k ?1 ],  ?Gc ?k?1/ 2=
1

? ?c?k [
2

1
?Gc

* ?k
?

1
?Gc

* ?k?1 ], (182)
 

?Gw
* ?k= g [ Az K z ?w ?w

2 g
? x ]k , e ?Gc* ?k=g [

Az K z ?o ?o g C oh
? x ]k . (183)

Na  solução  convectiva,  são  calculadas  novas  concentrações  mássicas  de  água,  “óleo 

pesado” e “óleo leve” ao final do passo de tempo de pressão. Essas novas  concentrações  não 

possuem,  salvo  por  aproximações  numéricas,  erros  de  balanço  de  massa.  Com  essas 

concentrações, são calculadas, em função das compressibilidades e da pressão ao final do passo, 

saturações teóricas de água e de óleo em todas as células ( ?S c ). Para um componente c:

73



? ?S c?ijk =
?V c ?ijk
V ijk

=[? mc/?c?ijkV ijk ?ijk ]= 1?ijk
?M c?ijk
?c ? pijk ?

,  (184)

onde (Vc)ijk  é o volume do componente na célula ijk, (Vp)ijk e Vijk são os volumes poroso e total da 

célula  e  mc é  a  massa  do  componente  c.  Aplicando-se  a  Equação  (184),  obtém-se  saturações 

teóricas, que contemplam a quantidade de massa de cada componente em cada célula e as novas 

pressões  calculadas.  Entretanto,  uma  vez  que,  no  método  IMPES,  a  solução  da  pressão  e  a 

solução da movimentação de massa são independentes, não se pode assegurar que a soma das 

saturações  calculadas  pela  Equação  (184) seja  unitária  ou,  em  outras  palavras,  que  a  massa 

existente em cada célula possua, na nova pressão, um volume exatamente igual ao espaço poroso.

Para cálculos de fluxo multifásico e  relatórios de saída do programa, as saturações de óleo 

e de água são normalizadas, de modo que a soma seja 1,0:

?S w ?ijk =
? ?Sw ?ijk

? ?S w? ?Sh ? ?S l ?
,  (185)

?S o ?ijk =
? ?S h? ?Sl ?ijk

? ?S w? ?Sh ? ?S l ?
.  (186)

Calcula-se, também,  o erro de  soma de saturações  de cada célula, o qual  é  utilizado  na 

Equação (176) para solução do próximo passo de tempo:

?es ?ijk=?1? ?S w? ?S h? ?S l ?ijk .  (187)

Este  erro,  ao  ser  utilizado  no  passo  de  tempo  seguinte,  tem  o  efeito  de  compensar  a 

diferença  entre  as  soluções  de  pressão  e  de  movimentação  de  massa,  estabilizando,  assim,  a 

solução do problema (Trangenstein e Bell, 1989).   Em cada célula, pode-se calcular a diferença 

entre o volume poroso e o volume teórico que os fluidos ocupariam na nova pressão:

?V erro ?ijk = V ijk ?ijk ?V ijk ?ijk ? ?S w? ?S h? ?S l ?ijk = V ijk ?ijk ?es ?ijk .  (188)

A utilização do  erro  es na solução de pressão também pode ser imaginada como se essas 

diferenças  de  volumes  fossem  “injetadas”  ou  “produzidas”  nas  respectivas  células,  tentando, 

assim,  corrigir  a  solução  da  pressão  no  próximo  passo,  em  função  das  massas  existentes  nas 

74



células. Se essa correção não for feita, as diferenças entre volumes de fluidos e volumes porosos 

tenderão a se elevar a cada passo de tempo, levando a soluções irreais. A Figura 5.2 mostra uma 

comparação real da evolução do máximo erro de soma de saturações entre as células do modelo, 

sem a utilização do termo  es e com a utilização desse termo. Durante este teste, os  passos de 

tempo foram mantidos constantes. A simulação sem a utilização de  es foi interrompida antes de 

400 dias, devido a instabilidade numérica.

Figura  5.2: Comparação entre evolução do máximo erro de soma de saturações. 
Vermelho: sem utilização do termo es na solução da pressão. Azul: utilizando-se o 
termo es.

75

0 100 200 300 400 500
0

10

20

30

40

50

60

70

80

90

100

 Sem Termo e
s

 Com Termo e
s

M
áx

im
o 

E
rr

o 
de

 S
om

a 
de

 S
at

ur
aç

õe
s 

(%
)

Tempo (dias)



Determinação dos Campos de Velocidades e Divergentes de Velocidade:

A solução convectiva deve representar o campo de velocidades ao final do passo de tempo 

de  pressão  (n+1).  A mesma  Equação  (116),  utilizada  no  caso  incompressível,  é  utilizada  na 

determinação das velocidades aparentes nas interfaces de todas  as células  (u). Uma vez que a 

compressibilidade  de  rocha  está  sendo  considerada,  deve-se  utilizar  a  porosidade  em  n+1 na 

determinação da velocidade intersticial v para que a solução seja correta:

v = u
?n?1

.  (189)

Por essa razão, existe no programa uma etapa de atualização das porosidades logo após a solução 

de pressão. 

O divergente da velocidade pode ser calculado numericamente em cada célula por (Cheng, 

2005):

?r d ?ijk = ? ??ut ?ijk = ?? u x? x ?? u y? y ?? uz? z ?ijk ?
?u x ?i?1/ 2??ux ?i ?1 /2

? xi
?

?u y? j?1 /2?? uy ? j?1/ 2
? y j

?
?u z ?k?1/ 2??uz ?k?1/ 2

? zk
.

 (190)

Ao se traçarem as linhas de corrente, o divergente das células é utilizado no cálculo de vazões e 

volumes ao longo das linhas, como será explicado adiante.

5.4 Solução do Transporte de Massa nas Linhas de Corrente

A solução de transporte de massa para sistemas compressíveis tem características comuns 

com a solução para sistemas incompressíveis (Seção ). As principais diferenças entre os métodos 

são:

1. variação  da  vazão  total  da  linha  de  corrente  com  a  distância,  devida  ao  divergente  da 

velocidade;

2. possibilidade de interrupção da linha de corrente;

3. lançamento de linhas de corrente a partir de células “fonte”;

76



4. solução das variáveis Mw, Mh e Ml, em vez de Sw e C h
vol e

5. cálculo das saturações normalizadas, a partir de Mw, Mh e Ml.

Lançamento e Construção das Linhas de Corrente:

Quando  se  considera  compressibilidade,  as  linhas  de  corrente  não  necessariamente  se 

iniciam  em  um  ponto  de  injeção  e  terminam  em  um  ponto  de  produção,  como  em  sistema 

incompressível. Uma célula pode ter o escoamento de fluidos em direção ao exterior em todas as 

faces,  sendo portanto,  uma  célula  “fonte”,  ou  em  direção  ao  interior,  sendo então  uma  célula 

“sumidouro”  (Figura 5.3). No primeiro caso, linhas adicionais devem ser lançadas dessas células. 

No  segundo  caso,  as  linhas  que  atingem  essas  células  são  interrompidas.  No  código  que  foi 

desenvolvido existem três fases de lançamento de linhas de corrente. Nas três etapas, as linhas de 

corrente são interrompidas quando células “sumidouro” são encontradas. 

Fase 1: Nesta fase são lançadas linhas de corrente de células que possuem um poço injetor. Os 

mesmos  critérios  de  lançamento  utilizados  no  código  para  sistema  incompressível  foram 

mantidos.  No  código  desenvolvido,  esta  etapa  é  sempre  executada  e,  portanto,  existe  a 

necessidade de que pelo menos um poço injetor seja definido.

Fase 2: Na segunda fase, todas as células que não foram atravessadas por linhas de corrente 

na  primeira  fase  são  testadas.  Caso  essas  sejam  do  tipo  “fonte”,  um  número  determinado  de 

linhas de corrente é lançado dessa célula. O número de linhas por face é proporcional à vazão da 

face, com um mínimo de uma linha por face. No programa desenvolvido, o número de linhas de 

corrente a ser lançado de uma célula fonte é um parâmetro numérico que deve ser fornecido.

Fase 3: Nesta fase, uma  nova pesquisa é feita em todas as  células, em ordem inversa à 

distância média aos poços injetores, como no caso incompressível, verificando-se se as células já 

foram  cruzadas  por  alguma  linha  de  corrente  das  fases  anteriores.  Caso  negativo,  temos  uma 

célula  “perdida”  e  uma  linha  de  corrente  complementar  é  lançada  do  centro  desta  célula,  em 

direção contrária à velocidade total, até que alguma célula com poço injetor ou célula “fonte” seja 

encontrada. 

77



Figura 5.3: Tipos de linhas de corrente: 1 e 2 linhas regulares de um poço injetor a um 
poço produtor; 3 linha lançada de um poço injetor que atinge uma célula "sumidouro"; 4 
- linha lançada de uma célula "fonte" que atinge um poço produtor; 5 linha lançada de 
uma célula “fonte” que atinge uma célula "sumidouro"; 6 - linha complementar lançada 
de  uma  célula  "perdida"  em  direção  reversa  atingindo  um  poço  injetor;  7  –  linha 
complementar lançada de uma célula "perdida" em direção reversa atingindo uma célula 
“fonte”; 8 e 9 – continuações de linhas complementares (não consideradas).

Após as três fases de lançamento de linhas de corrente, pode-se classificar qualquer célula 

do reservatório em uma das seguintes categorias (Figura 5.4):

1. células “injetoras”, que possuem completação de poço injetor,

2. células “produtoras”, que possuem completação de poço produtor,

3. células “regulares da Fase 1”, atravessadas por linhas de corrente originárias das células 

injetoras;

4. células “fonte”;

5. células “regulares  da Fase 2”, atravessadas por linhas de corrente originárias de células 

“fonte”;

6. células “perdidas”;

78

Célula
“Fonte”

Célula
“Sumidouro”

Poço
Injetor Poço

Produtor

1

2

4
3

7Célula
“Perdida”

9

5

Célula
“Perdida”

8

6



7. células “regulares  da Fase 3”, atravessadas por linhas de corrente originárias de células 

“perdidas” e

8. células  “isoladas”,  onde  a  velocidade  de  escoamento  é  insignificante  e  que  não  são 

atravessadas por nenhuma linha de corrente.

Figura 5.4: Exemplo mostrando linhas de corrente e tipo de células encontradas. Neste 
exemplo não aparecem células “sumidouro” ou "isoladas".

Considerações Sobre o Lançamento das Linhas de Corrente:

Assim como no caso incompressível, o método de Pollock (Pollock, 1988) foi utilizado no 

lançamento e construção das linhas de corrente. Para resolver a forma discretizada da equação 

superior do Sistema de Equações (81), são determinados na construção da linha, além do tempo 

de  vôo  ?,  a  vazão  total  de  fluidos  Qs e  o  volume  acumulado  desde  o  ponto  de  injeção  V.  O 

primeiro nó de uma linha de corrente lançada a partir de um poço injetor corresponde ao centro 

da célula de injeção e o segundo nó à face desta célula (Figura 4.2). A vazão no segundo nó é 

igual à vazão total da face, dividida pelo número de linhas de corrente lançadas a partir desta 

79

Injetora

Regular Fase 1

Produtora

Fonte

Regular Fase 2

Perdida

Regular Fase 3



face.  O  tempo  de  vôo  do  segundo  nó  e  a  vazão  no  ponto  de  injeção  são  determinados  pelas 

Equações (94) e (95). A partir do terceiro nó, ? é calculado pela Equação (53), Qs é calculado pela 

Equação (91) e V é calculado pela Equação (92). O número de referência da célula atravessada a 

cada nó, a partir do qual as demais propriedades podem ser obtidas, também é armazenado.

Por conveniência, são armazenados no programa desenvolvido vazões adimensionais (QsD) 

em vez de vazões absolutas (Qs). As vazões adimensionais são definidas como a vazão em um 

ponto da linha de corrente, dividida pela vazão no seu primeiro nó (ponto de injeção).  Nas Fases 

1 e 2 as vazões absolutas de qualquer nó podem ser obtidas por multiplicação pela vazão absoluta 

no primeiro nó.

No processo de construção e atribuição de vazões às linhas de corrente que foi adotado, 

toda a vazão injetada no reservatório e todas as vazões que atravessam as paredes  das células 

“fonte” são distribuídas entre as origens das linhas de corrente das Fases 1 e 2:

?
linhas

Fase1

Q flux= ?
poços

n_injet.

Q wi  (191)

e

?
linhas

Fase 2

Q flux= ?
células

n cel. fonte

Q fonte ,  (192)

onde  Qflux  é a vazão total atribuída ao primeiro nó de uma linha de corrente,  Qwi  é a vazão de 

injeção de um poço em condições de reservatório, e  Qfonte é a soma das vazões totais de fluidos 

das faces  de uma célula “fonte”. Se não existem regiões estagnadas, a soma dos volumes  dos 

tubos  de  corrente,  associados  à  linhas  de  corrente  dessas  fases,  é  igual  ao  volume  total  do 

reservatório.

Na Fase 3, não é possível atribuir uma vazão à linha de corrente, a qual possibilite o cálculo 

de volumes representativos para a média ponderada. Porém, ao se discretizar a Equação  (81), a 

solução das concentrações mássicas se torna dependente da relação entre o volume e a variação 

de vazão no segmento de linha de corrente. Como esta relação depende somente do divergente na 

célula atravessada [Equação (92)], a solução da linha de corrente é, na verdade, independente dos 

80



valores absolutos dos volumes e das vazões. Por essa razão, considera-se, na Fase 3, que  a vazão 

no  primeiro  nó  em  todas  as  linhas  de  corrente  é  igual  a  1,0  m3/d,  ou  seja,  utiliza-se  o  valor 

numérico da vazão adimensional na Equação (92). 

Na fase de mapeamento das concentrações Mw, Mh e Ml das linhas de corrente das Fases 1 e 

2  para  a  malha  original,  são  utilizadas  médias  aritméticas,  ponderadas  pelo  volume  de  cada 

segmento de linha de corrente que atravessa uma célula. Os volumes dos segmentos de linhas de 

corrente são associados à vazão de entrada e de saída através da Equação (92). Como na Fase 3 

as  vazões  e,  conseqüentemente,  os  volumes  não  são  representativos  para  a  média  ponderada, 

utiliza-se  nesta  fase  média  aritmética  simples  no  mapeamento  das  concentrações.  A  média 

aritmética simples acarreta algum erro de aproximação, porém, como a Fase 3 tende a abranger 

regiões do reservatório onde o escoamento é menos significativo, a aproximação nos resultados 

globais não é impactante nos resultados.

Linhas de Corrente com Grande Compressibilidade:

Devido à compressibilidade da rocha e dos fluidos, a variação da vazão ao longo de uma 

única linha de corrente, pode ser de várias ordens de magnitude. Na Figura 5.5, são mostradas a 

vazão adimensional e o tempo de vôo de uma linha de corrente típica, que liga um poço injetor a 

um poço produtor, em função do volume da linha. A vazão adimensional tem valor inferior a 

1,0x10-3, entre  os  volumes  de  5500  m3  e  8500  m3.  O  menor  valor  de  vazão  adimensional 

encontrado  neste  exemplo  é  de  1,03x10-5.   A  variação  do  tempo  de  vôo  neste  intervalo 

corresponde a 98% do tempo de vôo total. Conclui-se que esse intervalo é uma região onde o 

escoamento é praticamente estagnado, sem variações significativas de composição de fluidos. Se 

a regularização da linha é feita com base em tempo de vôo, com multiplicação do número de 

elementos  por  2,  ocorre  um  problema  sério  de  dispersão,  pois  mais  de  10  células,  entre  os 

volumes de 0 e 5500 m3, são agrupadas em um único segmento de linha de corrente. Como esse é 

um  padrão  facilmente  encontrado  em  escoamentos  com  compressibilidade,  decidiu-se  utilizar 

uma  estratégia  especial  para  evitar  problemas  numéricos  ou  cálculos  que  aumentariam 

desnecessariamente  o  tempo  de  CPU.  Considerou-se,  para  tal,  que,  se  a  vazão  em  uma 

determinada  posição  de  linha  de  corrente  é  muito  pequena,  em  relação  à  vazão  no  ponto  de 

81



injeção, pode-se, sem prejuízo da qualidade da solução global, desconsiderar a movimentação de 

fluidos nesta posição. No código desenvolvido, as posições da linha de corrente onde a vazão é 

inferior a 0,1% (1,0x10-3) da vazão no início da linha são suprimidas, substituindo-se essa linha 

de corrente por duas novas linhas (Figura 5.6). Como mostram os resultados das validações que 

serão  apresentadas  nos  Capítulos  7  e  8,  esse  valor  de  corte  se  mostrou  adequado  para  as 

aplicações em reservatórios de petróleo.

Além  da  divisão  da  linha  de  corrente  em  regiões  com  vazão  adimensional  inferior  a 

1,0x10-3, outra estratégia teve que ser utilizada, com o objetivo de evitar problemas numéricos e 

processamento desnecessário. Para isso, a construção de qualquer linha é interrompida passando-

se para as outras fases da solução, sempre que uma vazão adimensional inferior a um limite muito 

pequeno, no caso 1,0x10-9, é calculada. Considera-se que, a partir desse ponto, o escoamento de 

fluidos não é mais significativo. A mesma estratégia é utilizada, quando se traçam as linhas de 

corrente  complementares,  a  partir  das  células  “perdidas”.  Ao  mesmo  tempo,  verifica-se  se  a 

célula a ser atravessada possui característica de célula “sumidouro”, o que também provoca a 

82

Figura 5.5: Vazão adimensional (QsD) e Tempo de Vôo (?) 
ao longo de uma linha de corrente com grande variação de 
velocidade. Cada marca corresponde a um nó da linha de 
corrente. A vazão adimensional dentro da caixa amarela é 
inferior a 1,0x10-3.

0 2000 4000 6000 8000 10000
0.0

0.2

0.4

0.6

0.8

1.0
 Qs

D
 ?

Volume a Partir da Origem (m3)

V
az

ão
 A

di
m

en
si

on
al

0

5000

10000

15000

20000

25000

Te
m

po
 d

e 
V

ôo
 (a

no
s)

 



interrupção  da  linha.  Pode-se  argumentar  que,  não  sendo  uma  célula  “sumidouro”,  a  vazão 

adimensional poderia, caso a linha não fosse interrompida, voltar a crescer algumas células após 

o  ponto  de  interrupção  e  que,  neste  caso,  uma  parte  do  reservatório  estaria  sem  solução. 

Entretanto, isto não ocorre porque as células que possuem escoamento significativo e que não 

foram atingidas pelas linhas da Fase 1 são, necessariamente, atingidas na Fase 3, ao se traçarem 

as linhas complementares.

Discretização:

A discretização  da  equação  superior  do  Sistema  de  Equações  (81) por  ponto  simples  a 

montante, para os componentes utilizados no simulador, é imediata:

M w
m?1=M w

m?? t
Q flux
? V i

[?Q sD f w ?w?im??Q sD f w ?w?i?1m ],  (193)

M h
m?1=M h

m?? t
Q flux
? V i

[?Q sD f o C oh ?im??Q sD f o C oh?i?1m ],  (194)

M l
m?1=M l

m?? t
Q flux
? V i

[?Q sD f o C ol ?im??Q sD f o C ol ?i?1m ],  (195)
onde  m é o indicador do passo de tempo na solução de linhas de corrente,  Qflux é a vazão total 

absoluta no primeiro nó e  (QsD)i é a vazão adimensional na saída do segmento  i. O cálculo dos 

83

Figura  5.6:  Exemplo  simbólico  de  divisão  de  linha  de 
corrente  em  região  com  vazão  adimensional  inferior  a 
1,0x10-3.  Somente  as  linhas  de  corrente  externas  (linha 
cheia) são utilizadas na simulação.

QsD=1,0

QsD=0,001

QsD=1,5



fluxos fracionários (fw e fo) é função das saturações, as quais dependem das concentrações, como 

será explicado adiante.

As  concentrações  por  volume  de  fluido  (Cc)  se  relacionam  com  as  concentrações  por 

volume de rocha (Mc) por:

M w=? S w ?w ,    M l =??1?S w ?C ol  e M h=??1?S w? C oh .    (166)

Estimativa das Saturações:

Para  a  solução  das  Equações  (193) a  (195) necessita-se  do  fluxo  fracionário  e, 

conseqüentemente, das saturações atualizadas em cada passo de tempo de linha de corrente (m). 

A saturação em cada segmento da linha de corrente é estimada em função das massas específicas 

e das concentrações dos componentes por:

S w=
?S w

? ?Sw ? ?S h? ?S l ?
,  (196)

onde as  pseudo saturações  dos  componentes ( ?S c ) são calculadas  dividindo-se o volume do 

fluido pelo volume poroso:

?S c=
1

?V ? ? ? V M c?c ?.  (197)
Para os componentes considerados têm-se:

?Sw=
M w
?w

* ?
,     ?S h =

M h
?h

* ?
 e  ?Sl =

M l
?l

* ?
. (198)

As massas específicas teóricas da água e dos componentes do óleo ( ?c
* ) são dadas por:

?w
* =?w

ref [1?cw ? p? p
ref ?],  (199)

?h
* =

??h?R sh ?g
Bh

,  (200)

?l
*=

??l ?R sl ?g
Bl

.  (201)

Os fatores de formação de volume dos componentes do óleo são função da pressão do segmento. 

84



A mesma  rotina  utilizada  nesta  etapa  também  é  usada  para  calcular  as  saturações  das 

células da malha de simulação, assim como os erros de soma de saturações  [Equação (187)], os 

quais são utilizados  na Equação (176) do próximo passo de tempo de solução de pressão. 

Condições de Contorno:

As  condições  de  contorno  iniciais  para  a  solução  da  linha  de  corrente  correspondem  às 

distribuições  iniciais  dos  componentes  Mh,  Ml e  Mw,  obtidas  da  malha  original  de  simulação 

através no processo de regularização que será explicado adiante.

Necessita-se, como condição de fronteira na solução da equação superior do Sistema de 

Equações  (81), conhecer o fluxo fracionário da água (fw), as concentrações dos componentes na 

fase óleo (Ch e Cl) e a concentração da água na fase água (Cw) no ponto de injeção das linhas de 

corrente.  A composição  da  água  na  fase  água  é  igual  à  sua  massa  específica,  calculada  por 

compressibilidade na pressão da célula onde se origina a linha de corrente. As composições dos 

componentes do óleo também são obtidas da célula onde se origina a linha de corrente através da 

Equação (166):

C oh=
M h

??1?S w ?
  e C ol =

M l
??1? S w?

. (202)

Quando  a  célula  onde  se  origina  a  linha  de  corrente  é  uma  célula  que  possui  um poço 

injetor, o fluxo fracionário de água é unitário. Caso contrário, o fluxo fracionário é calculado em 

função da saturação de água e das viscosidades na célula onde a linha de corrente se origina, seja 

a linha originária de uma célula fonte ou da divisão de uma linha de corrente com regiões de 

baixa velocidade de escoamento (Figura 5.6).

Regularização das Linhas de Corrente:

Assim como na simulação para sistemas incompressíveis, as linhas de corrente devem ser 

regularizadas  em  intervalos  constantes  antes  da  solução  por  diferenças  finitas  (Figura  4.4).  A 

formulação  que  foi  adotada  para  sistemas  compressíveis  permite  que  a  regularização  seja 

85



facilmente estabelecida por dois critérios diferentes: por intervalos de tempos de vôo constantes 

ou por intervalos de volume de linha de corrente constante. Utilizando-se volumes constantes, os 

problemas de dispersão da solução, associados a agrupamento de células devido a variação de 

vazão (Figura 5.5), podem ser diminuídos, porém ao se aplicar o critério de Courant-Fredrich-

Lewy  (Courant  et  al.,  1967)  para  determinação  do  passo  de  tempo  máximo,  pode-se  perder 

eficiência, pois a velocidade dos fluidos é maior nos segmentos de linha de corrente com alta 

vazão, obrigando a utilização de um reduzido passo de tempo. Por outro lado, como a relação 

entre a velocidade adimensional e o volume da linha de corrente é linear dentro de uma célula, o 

processo de regularização por volumes  não necessita de cálculo de função exponencial, o que 

pode compensar a perda de eficiência. No programa desenvolvido, é possível especificar um dos 

dois critérios de regularização através de arquivo de dados.

Mesmo  interrompendo-se  as  linhas  de  corrente  nas  regiões  onde  a  vazão  total  é 

insignificante, ainda foram observados problemas de regularização em casos em que, devido à 

compressibilidade,  ocorriam  variações  grandes  de  vazão  total  em  uma  pequena  extensão  das 

linhas. Por essa razão, foi estabelecido um critério para determinação do número de elementos da 

linha regularizada, o qual leva em conta a compressibilidade do sistema na região atravessada 

pela linha de corrente. No programa para sistema compressível o número de elementos da linha 

regularizada é estabelecido por:

n regular =[ A?B ? log10? máxima?Q sD ?mínima ?Q sD? ? ?] nirregular ,  (203)
onde nirregular é o número de intervalos entre nós da linha original, máxima(QsD) e mínima(QsD) são 

as  máximas  e  as  mínimas  vazões  adimensionais,  dentre  os  nós  da  linha  de  corrente  a  ser 

resolvida, e  A e  B são parâmetros de controle a serem fornecidos. Testes realizados mostraram 

que  a utilização de A = 1 e B = 0,5 são valores adequados para a simulação da maioria dos casos 

estudados.  Com  esses  fatores,  a  linha  de  corrente  regularizada  teria  o  mesmo  número  de 

elementos da linha original, se todas as vazões adimensionais fossem 1,0 (incompressível), e 3,0 

vezes  o número de elementos  da linha original, se a razão entre a máxima e a mínima vazão 

fosse 10.000. Estabelece-se, assim, uma espécie de refinamento adaptativo de linha de corrente, 

em função da compressibilidade  na região  atravessada. Deve-se observar que a velocidade da 

86



simulação é sensível a esses parâmetros, uma vez que, não só o número de elementos da linha 

regularizada é alterado, mas também o volume médio dos elementos, o que impacta no máximo 

passo de tempo para estabilidade da solução.

Os parâmetros necessários para a solução da linha regularizada são obtidos com as relações 

dadas entre as Equações  (88) e  (92). A vazão na saída de um segmento regularizado, localizado 

entre os pontos de entrada (1) e de saída (2), é dada por:

[Q s ]2=[ Qs ]1 e
[?

1

2 r d ?
? ]irrregular

= [ Q s ]1 e
?

j
?r d ?? ?j ,  (204)

onde j indica  intervalos contidos entre nós da linha de corrente original. As propriedades rd e ? 

são constantes entre dois nós da linha original, conhecidas através do número de referência da 

célula atravessada. Embora, no programa, os valores armazenados sejam de vazão adimensional, 

a vazão real pode ser obtida por multiplicação pela vazão no primeiro nó da linha de corrente, a 

qual é conhecida nas Fases 1 e 2 de lançamento. Na Fase 3, como foi anteriormente explicado, 

considera-se vazão unitária no primeiro nó da linha de corrente. Obtendo-se a vazão de saída, o 

volume de rocha de um segmento da linha regularizada é determinado por:

[? V ]regular =?
1

2
dQs
d r d

= ?
j

?Q s ?j ??Q s ? j?1
? rd ? j

 (205)

e o volume poroso por:

[ ?V p ]regular = ?
1

2

? dV =?
j

? j ? V j .  (206)

Os demais parâmetros necessários à solução são calculador por:

[? ]regular =
[ ? V p ]regular
[? V ]regular

,  (207)

[ S w ]regular =
1

[? V p ]regular
?
1

2

S w dV p =
?

j
?S w ?V ? ? j

[ ? V p ]regular
,  (208)

[ p] regular=
1

[ ?V p ]regular
?
1

2

p dV p =
?

j
? p ? V ?? j

[ ? V p ]regular
,  (209)

87



[ M h ]regular =
1

[? V ] regular?
1

2

M h dV =
?

j
? M h ? V ? j

[? V ]regular
,  (210)

[ M l ]regular=
1

[? V ]regular ?
1

2

M l dV =
?

j
?M l ? V ? j

[? V ] regular
,  (211)

[ M w ]regular =
1

[? V ] regular?
1

2

M w dV =
?

j
? M w ?V ? j

[? V ] regular
.  (212)

 Utilizando-se a opção de intervalos de volume de linha de corrente constantes, não existe a 

necessidade de se calcular ?V pela Equação (205). Neste caso, a vazão na saída de um segmento 

regularizado entre os pontos 1 e 2 é dada pela Equação (92):

 [Q s ]2=[ Qs ]1??
j

?? V r d ? j . (213)

Transferência da Solução da Linha de Corrente Regularizada para a Linha de Corrente 

Original:

Antes do mapeamento para a malha original, deve-se fazer a transferência dos novos perfis 

de  concentração  de  massa  das  linhas  de  corrente  regularizadas  para  as  linhas  de  corrente 

originais.  Como  existem  variações  de  porosidade  entre  as  células,  deve-se  tomar  um  cuidado 

adicional neste processo.  No caso em que  um segmento de linha de corrente engloba vários 

intervalos  entre  nós  da  linha  original,  a  nova  concentração  de  massa  por  volume  de  um 

componente Mc dos intervalos entre nós deve ser calculada, distribuindo-se a massa do segmento, 

em proporção aos volumes porosos dos intervalos:

[ M c]irregular=? 1[V ]irregular ??[ M c ]regular [ V ] regular ?
[ V p ]irregular
[ V p ]regular

,  (214)

[ M c]irregular=
[ ?]irregular
[ ?] regular

[ V ]irregular [ M c ]regular .  (215)

No  caso  em  que  os  segmentos  da  linha  regularizada  estão  contidos  entre  dois  nós  da  linha 

original os valores da porosidade são os mesmos nas duas linhas. Pode-se, portanto, generalizar a 

88



transferência dos componentes para a linha original por:

[ M c]irregular=[? ]irregular ?
i
? [ V ] regular [ M c ]regular[? ]regular ?i .  (216)

Intervalo de Tempo de Solução de Linhas de Corrente:

As  Equações  (193),  (194) e  (195) são  resolvidas  independentemente  uma  da  outra, 

utilizando-se um passo de tempo próprio para cada componente.

A velocidade de frente de avanço na equação superior do Sistema de Equações  (81), em 

volume de linha de corrente por tempo, é determinada estabelecendo-se a equação da diferencial 

de Mc e igualando a zero:

dM c =
? M
? V

dV ?? M
? t

dt = 0 .  (217)

A velocidade de uma frente com composição constante é dada por:

vc= dV
dt

=?
? ? M /? t ?
? ? M /? V ?

.
 

(218)

Aplicando-se a equação superior do Sistema de Equações (81):

vc=
? ? Q s f p C pc?/? V

? M /? V
=[ d ? Qs f p C pc?d M ]t=constante .

 
(219)

Discretizando-se essa equação, temos a velocidade média em um segmento:

?vc ?i =
?Q s f p C pc?i??Q s f p C pc ?i ?1

? M c?i?? M c?i?1
.

 
(220)

O passo de tempo mínimo para solução da linha que atende o  critério de Courant-Fredrich-Lewy 

(Courant et al., 1967)  é dado por:

? t sl
vel=? ? Vvc ??mínimo .  (221)

Substituindo-se a Equação (220) na Equação (221): 

? tsl
vel=

?? V ?i [? Mc?i??M c?i?1 ]
?Qs f p C pc ?i??Qs f p C pc?i?1?mínimo  (222)

89



Para  uma  aplicação  eficiente  do  critério  no  programa  desenvolvido,  o  termo  da  variação  das 

concentrações  com  o  tempo  nas  Equações  discretizadas  (193),  (194) e  (195) é  inicialmente 

calculado para todos os segmentos da linha de corrente:

?i=
Q flux [?Q sD f p C pc?i??Q sD f p C pc?i?1 ]

? V i
; i=2,3 , .... (223)

Em  seguida,  o  limite  de  passo  de  tempo  pelo  critério  de  velocidade  da  avanço  de  frente  é 

calculado por:

? t sl
vel=

[ ?M c?i??M c?i?1 ]
?i ?mínimo .  (224)

Se não existe diferença de concentração entre um segmento e o anterior, o passo de tempo desse 

segmento não é considerado na determinação do  mínimo.

Além da análise da velocidade de frente de avanço, é realizado um teste para verificar se a 

solução de um segmento não gera valores irreais de  Mw,  Mh e  Ml. Esta etapa é importante para 

estabelecer  um  limite  de  estabilidade  para  os  segmentos  onde  não  existe  diferença  de 

concentração em relação ao anterior. Por este critério, o passo de tempo da linha de corrente tem 

uma limitação adicional em cada segmento, a qual irá depender das atuais saturações das fases. 

Como  não  existe  uma  maneira  precisa  de  se  estabelecer  os  limites  a  serem  aplicados,  foi 

desenvolvida uma série de regras envolvendo os valores da saturação. Os limites de Mw, Mh e Ml 
são aplicados considerando a proporcionalidade entre concentração do componente e a saturação 

da fase.  Para o componente água a concentração deverá estar limitada por:

M w
min=?M w

m?i
? S w?min
? S w

m?i
,  (225)

 M w
max=?M w

m?i
? S w ?max
?S w

m?i
, (226)

onde  ?M w
m?i e  ?S w

m?i correspondem à concentração e à  saturação de água  do segmento  no 

início do passo de tempo. O seguinte critério foi estabelecido para a determinação de limites no 

caso de o valor da saturação ser superior à saturação irredutível de água Swi e inferior à saturação 

correspondente ao óleo residual (1-Sor):

90



?S w ?min=0,9 Sw i?0,1 S w
m ,  (227)

?S w ?max=0,9 ?1? So r ??0,1 S w
m .  (228)

Essas  expressões  representam  uma  média  entre  a  saturação  no  início  do passo  de  tempo  e  as 

saturações extremas, com peso 1 para a saturação no início e 9 para as saturações extremas. Caso 

a  saturação  de  água  seja  inferior  à  saturação  irredutível,  o  que  pode  ocorrer  devido  à 

expansão/contração de poros e fluidos, utiliza-se:

?S w ?min=0,9 ? S w
m?i  (229)

e, caso a  saturação de água seja superior a  (1-Sor), o que ocorre quando o óleo penetra numa 

zona abaixo do contato óleo-água:

?S w ?max= 1,0.  (230)
Para os componentes do óleo são usadas as seguintes restrições:

M c
min=?M c

m?i
? S o ?min
? S o

m?i
,  (231)

M c
max=c ? M c

m?i
? S o?max
? S o

m?i
.  (232)

Se a saturação de água estiver entre os valores da saturação irredutível de água  Swi e saturação 

residual de óleo (1-Sor):

?S o ?min=0,9 Sor? 0,1 ? S o
m?i ,  (233)

?S o ?min=0,9 ?1?Sw i??0,1 ? So
m?i .  (234)

Caso a saturação de água seja inferior à saturação irredutível:

?S o ?max=1,1 ?S o
m?i  (235)

e caso a  saturação de água seja superior a (1-Sor):

?S o ?min=0,0 .  (236)
Com os valores de concentrações máximas e mínimas determina-se um novo limite de passo de 

tempo para um segmento, utilizando-se os termos de variação das concentrações com o tempo, já 

calculados:

?? t sl
lim ?i=

[ M cmax??M cm?i ]
?i

, se ?i ? 0 ; (237)

91



?? t sl
lim ?i=

[ M cmin??M cm?i ]
?i

, se ?i ? 0 .  (238)

O limite de passo de tempo para toda a linha de corrente é dado por:

? t sl
lim=?? t sl

lim?i?mínimo .  (239)
Finalmente,  o  menor  dos  limites  de  passos  de  tempos  é  multiplicado  por  Nc,  definido  nos 

arquivos de dados e adotado na solução numérica:

? t sl= N c mínimo? ? t slvel , ? t sllim? .  (240)

Tratamento de Poços Produtores:

Em  uma  simulação  por  linhas  de  corrente  com  compressibilidade,  podem  existir  quatro 

situações básicas em relação a uma célula pertencente a um poço produtor, as quais são ilustradas 

na Figura 5.7: 

A) todas  das  linhas  de corrente que deveriam chegar à célula que possui o poço produtor 

efetivamente atingem a célula e a soma das vazões nos últimos nós das linhas de corrente 

é igual à vazão total do poço, calculada na solução da pressão;

B) somente parte das linhas de corrente que deveriam atingir a célula tem vazão significativa 

em toda a sua extensão e a soma das vazões da linhas de corrente é inferior à vazão total 

do poço;

C) todas as linhas de corrente que deveriam atingir a célula produtora, possuem algum ponto 

de baixíssima vazão, ocasionando a sua interrupção antes de atingir esta célula;

D) a célula que possui o poço produtor é uma célula isolada ou uma célula que não possui 

fluxo em direção ao seu interior em nenhuma face e, portanto, não é atingida por nenhuma 

linha de corrente. Neste caso a produção do poço deve-se primordialmente à expansão de 

fluidos ou contração do espaço poroso da própria célula que possui o poço.

Nas situações A e B, o fluxo fracionário e a composição do óleo produzido no poço podem 

ser calculado utilizando-se o mesmo procedimento da formulação para sistema incompressível, 

adaptando-se  as  Equações  (134) a  (137) para  a  determinação  de  fluxo  fracionário  e  das 

composições. Entretanto, no caso B, a vazão total a ser considerada para o poço deve ser a vazão 

92



que foi calculada na etapa de solução da pressão e não a soma das vazões das linhas de corrente. 

Nos casos A e B, a composição final da célula “produtora” é obtida automaticamente na fase de 

mapeamento da solução das linhas de corrente para a malha original.

As situações C e D necessitam ser tratadas com mais cuidado, pois não é possível utilizar 

as informações das linhas de corrente para estabelecer o fluxo fracionário e a composição do óleo 

produzido. Além disso, este é um caso especial em que, ao final da solução convectiva, existem 

células  que,  embora  possuindo  variação  importante  de  massa,  não  foram  atravessadas  por 

nenhuma linha de corrente. O procedimento adotado para contornar esse problema foi utilizar as 

saturações  e  as  concentrações  da  própria  célula  no  início  do  passo  de  tempo  (n)  para  se 

93

Figura  5.7:  Possíveis  situações  em  um poço  produtor:  A - Todas  as 
linhas de corrente atingem o poço; B - Parte das linhas que deveriam 
atingir  a  célula  são  interrompidas;  C  -  Todas  as  linhas  são 
interrompidas; D - Não existe linha de corrente chegando na célula do 
poço produtor.

Célula
“Sumi-
douro”

A B

C D

Célula
“Sumi-
douro”



determinar o fluxo fracionário e as concentrações no poço produtor:

? f w?prod = f w ??S w
n ?ijk ? ,  (241)

??w ?prod=? M w? S w ?ijk
n

,  (242)

?C oh?prod=? M h? S o ?ijk
n

,  (243)

?C ol ?prod=? M l? S o ?ijk
n

,  (244)

onde  ijk refere-se  à  célula  “produtora”.  Essas  situações  tendem  a  ocorrer  em  poços  com 

produtividade muito pequena, o que justifica a utilização de saturações e concentrações no início 

do passo de tempo de pressão.

Como não existem linhas de corrente atravessando a célula “produtora”, as variações de 

concentração  da  célula  devem  ser  estimadas  por  balanço  de  massa.  Neste  caso,  torna-se 

necessário calcular o fluxo de cada componente em cada face da célula. A variação da massa de 

água no interior da célula é calculada por:

?? mw ?ijk = ? t [ ?
face=1

6

?u A f w ?w ?face ? ?Qt f w ?w?prod].  (245)
Por definição, a velocidade aparente em cada face (uface) é positiva se o sentido de fluxo for da 

célula vizinha para a célula produtora ou negativa, em caso contrário. A massa específica e o 

fluxo fracionário da água a serem considerados na Equação (245) são definidos por:

??w ? face=??w?vizinha , se uface &gt; 0;

??w ? face=??w?ijk , se uface &amp;lt;0.
(246)

? f w? face= f w ??S w
n ?vizinha? , se uface &gt; 0;

? f w? face= f w ??S w
n ?ijk ?, se uface &amp;lt;0. 

(247)

A variação  de  massa  calculada  pela  Equação  (245) é  utilizada  na  fase  de  mapeamento  das 

concentrações  por  volume  de  rocha  da  malha  original  de  simulação.  Aplicando-se  o  mesmo 

critério para os demais componentes:

94



?? mh ?ijk = ? t [ ?
face=1

6

?u A f o C oh? face ? ?Qt f o C oh?prod],  (248)
?? ml ?ijk = ? t [ ?

face=1

6

?u A f o C ol ? face ? ?Q t f o C ol ?prod],  (249)
onde:

?C oc? face=?C oc?vizinha , se uface &gt; 0;

?C oc? face=?C oc?ijk , se uface &amp;lt;0.
(250)

Além das situações básicas apresentadas, existem mais duas situações especiais, que foram 

observadas em alguns casos, onde existem poços com completações vizinhas (Figura 5.8). Na 

situação E, nenhuma das completações recebe uma linha de corrente e a mesma abordagem das 

situações C e D é utilizada. Na situação F, essa abordagem não é adequada, pois a produção na 

completação vizinha não é pequena e as saturações e concentrações da célula vizinha variam de 

forma  significativa  durante  o  passo  de  tempo  de  solução  de  pressão.  Esse  problema  foi 

contornado assumindo-se nas Equações  (245),  (248) e  (249) que o fluxo fracionário médio e as 

concentrações médias do fluxo que cruza a faces da célula, vindo da célula vizinha, durante o 

passo de tempo de pressão, são iguais aos valores produzidos na completação daquela célula, ou 

seja:  os  valores  calculados  pelas  Equações  (134) a  (137) para  a  completação  vizinha.  Para  o 

balanço de massa da situação  F, também precisa ser levado em conta, que o volume de fluidos 

que entra na célula “produtora” através do contato com a célula vizinha pode ser muito maior que 

o próprio volume  poroso desta célula. Neste caso, não é possível tomar os  parâmetros para o 

cálculo  do  poço  produtor  no  início  do  passo  de  tempo  de  pressão,  pois  a  variação  do  fluxo 

fracionário e das concentrações no poço ao longo do passo de tempo pode ser muito grande.

95



Figura  5.8:  Seções  mostrando  possíveis  situações  em  um  poço 
produtor  com  duas  completações:  E  –  Nenhuma  linha  de  corrente 
atinge o poço; F – Uma das completações tem vazão suficiente para 
receber alguma linha de corrente.

96

POÇO

FLUXO ENTRE COMPLETAÇÕES

z

CÉLULA DE BAIXA PERMEABILIDADE

POÇO

FLUXO ENTRE COMPLETAÇÕES

z

CÉLULA DE BAIXA PERMEABILIDADE

POÇO

FLUXO ENTRE COMPLETAÇÕES

z

F

E



No programa  desenvolvido,  utilizam-se  as  propriedades  da  célula  no  início  do  passo  de 

tempo, apenas quando o volume total vindo das células vizinhas for inferior a 50% do volume 

poroso. Caso contrário, o fluxo fracionário e as concentrações do poço produtor são iguais ao 

fluxo  fracionário  e  as  composições  médias  de  todo  o  volume  de  fluidos  que  entra  na  célula 

“produtora”, vindo das células vizinhas.

Mapeamento para Malha Original:

Na formulação utilizada, as variáveis que necessitam ser transferidas, após a solução das 

linhas de corrente, para a malha de simulação são as concentrações por volume de rocha, Mw, Mh 
e  Ml.  Para as células “produtoras”, “injetoras”, “regulares de Fase 1” e “regulares da Fase 2”, 

essas concentrações são estimadas pela divisão entre a somatória das massas de todas as linhas de 

corrente que atravessam a célula pela somatória dos respectivos volumes, ou seja, atribui-se à 

célula as concentrações médias do volume pertencente aos tubos representados pelas linhas de 

corrente que atravessam essa célula:

?M c?ijk
?n ?1 ?inter =

?
sl

?? V sl M c
sl ?

?
sl

?? V sl ?
,  (251)

onde (n+1)inter indica que a solução corresponde ao final do intervalo de tempo de pressão, porém 

é intermediária no processo de decomposição do operador.

Uma vez que, na Fase 3, os volumes dos segmentos das linhas de corrente não possuem 

sentido físico, as células dos tipos “perdidas” e  “regulares da Fase 3” têm as suas concentrações 

estimadas por simples médias aritméticas das concentrações das linhas de corrente que as cortam:

?M c?ijk
?n ?1 ?inter =

?
sl

num sl

?M c
sl ?

numsl
.

 (252)

Para as células do tipo “fonte”, computa-se a variação de massa de cada componente em 

função das vazões das linhas de corrente lançadas a partir da célula:

97



?? mw ?ijk = ? ? t ?
sl

?Q flux f w ?w?sl ,  (253)

?? mh ?ijk = ? ? t ?
sl

?Q flux f o C oh?sl ,  (254)

?? ml ?ijk = ? ? t ?
sl

?Q flux f o C ol ?sl ,  (255)

onde fw, fo, ?w, Coh e Col são calculadas usando-se as concentrações da célula no início do passo de 

tempo (n). Para as células “produtoras” que não são atingidas por nenhuma linha de corrente, as 

variações  de  massa  são  dadas  pelas  Equações  (245),  (248) e  (249).  As  novas  concentrações 

dessas células são então calculadas por balanço de massa:

?M c?ijk
?n ?1 ?inter =

V ijk ?M c
n?ijk ??? mw ?ijk
V ijk

.
 

(256)

5.5 Gravidade

Após  o  mapeamento  das  concentrações  para  a  malha  original,  é  necessário  resolver  o 

movimento  gravitacional  dos  fluidos,  governado  pelas  equações  inferiores  do  Sistema  de 

Equações (81).

Discretização:

Discretizando-se a equações inferiores do Sistema de Equações (81) pelo esquema explícito 

de ponto simples, para cada componente utilizado no programa, obtém-se

?M w ?ijk
? n?1?inter=?M w ?ijk

? n?1?inter?
? t
? z [?ugrav_w ?w?k ?1

? n?1?inter??ugrav_w ?w?k
?n ?1 ?inter ] ,  (257)

?M h ?ijk
? n?1?inter=? M h ?ijk

? n?1?inter?
? t
? z [?u grav_o C oh?k ?1

?n?1?inter ?? ugrav_o C oh?k
? n?1?inter ],  (258)

?M l ?ijk
? n?1?inter =? M l ?ijk

? n?1?inter ?
? t
? z [?u grav_o C ol ?k ?1

?n ?1 ?inter ?? ugrav_o C ol ?k
? n?1?inter ] .  (259)

As  velocidades  ugrav_w e  ugrav_o são  calculadas  da  mesma  forma  que  no  programa  para  sistema 

incompressível, através das Equações (145) e (149). 

98



Intervalos de Tempo na Solução Gravitacional:

Na solução gravitacional do programa para sistema compressível, adotaram-se os  mesmos 

critérios para determinação de intervalo de tempo máximo utilizados na solução das linhas  de 

corrente para sistema compressível — Equação (240).

5.6 Intervalo de Tempo para  Solução da Pressão

Existem  algumas  propostas  com  fundamento  teórico  para  estabelecimento  de  passos  de 

tempo de solução de pressão em simulação por linhas de corrente (Osako et al, 2003; Blunt, 2008 

etc). Apesar da existência dessas propostas, optou-se neste trabalho por diferentes abordagens que 

tem como base a observação do máximo erro de soma de saturações do passo anterior:

es
max = ?e s ?ijk?máximo ,  (260)

onde (es)ijk é definido como:

?es ?ijk=?1? ?S w? ?S h? ?S l ?ijk ,  (261)
pois, entende-se que este parâmetro é um bom indicador da acuidade e da estabilidade da solução. 

Observou-se que para problemas homogêneos e relativamente pequenos (milhares de células), o 

máximo erro é estável, mantendo-se, a depender das características do problema,  menor que 1%. 

Um exemplo de um caso homogêneo com 1500 células é mostrado na Figura 5.9.

A  Figura  5.10 mostra  um  caso  de  mais  de  um  milhão  de  células,  derivado  do  Caso 

Comparativo SPE10 (Christie e Blunt, 2001), onde a heterogeneidade é muito alta. Observa-se, 

que neste caso, a manutenção dos passos de tempo não assegura a estabilidade do problema, pois 

o máximo erro de soma de saturações é sempre crescente. Logo após 200 dias de produção a 

simulação é interrompida devido a problemas numéricos, provocados por altos erros de soma de 

saturações. 

99



A primeira abordagem tentada para contornar o problema de instabilidade do máximo erro 

de soma de saturações em casos heterogêneos consiste em estabelecer-se um erro máximo “alvo” 

( es
alvo ) e definir o intervalo de tempo do próximo passo (n+1) através de uma relação linear 

com o passo concluído (n):

?? t pres?
n?1=?? t pres ?

n es
alvo

?e s
max ?n

.  (262)

A Figura 5.11 mostra um exemplo desta abordagem em um caso derivado do Caso Comparativo 

SPE10. Pode-se observar que ocorre um comportamento oscilatório e instável, o qual não permite 

a adequada solução do problema. Foi observado que a ocorrência de erros de saturação superiores 

a  50%  leva  freqüentemente  a  uma  grande  instabilidade  numérica,  com  cálculo  de  resultados 

irreais e interrupção da simulação.

100

Figura 5.9: Máximo erro de soma de saturações em uma simulação de 
um  caso  homogêneo  com  1500  células  com  passos  de  tempo 
constantes.

0 200 400 600 800 1000
0.0

0.1

0.2

0.3

0.4

0.5

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)



Figura 5.10: Erro de soma de saturações em uma simulação de um caso 
muito  heterogêneo  derivado  do  Caso  SPE10,  com  1,2  milhões  de 
células com passos de tempo constantes.

Analisando-se melhor a Figura 5.10 e a Figura 5.11, observa-se que a taxa de crescimento 

do máximo erro com o tempo não é constante, porém crescente, mesmo quando se utiliza passo 

de tempo constante. Em vista dessa observação, a próxima abordagem que foi testada, consiste 

em utilizar, na  determinação  do próximo  intervalo de tempo, não o último  erro de cálculo  de 

saturações, mas sim uma estimativa desse erro, mantendo-se o mesmo intervalo de tempo:

?? t pres?
n?1=?? t pres ?

n es
alvo

?e s
max ?previsto

.  (263)

O erro do passo de tempo seguinte é estimado considerando-se uma equação de segundo grau 

passando pelos erros dos dois últimos passos (Figura 5.12):

?es
max?previsto=?e s?

n?2 ?b x?c x2 ,  (264)
onde:

101

0 50 100 150 200
0

50

100

150

200

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)



x=?? t pres ?
n?1 ?2?? t pres ?

n  (265)
 e b e c são os coeficientes de uma equação de segundo grau que se ajusta à origem e aos últimos 

dois erros de saturação, dados por:

b =

x2
x1

y1?
x1
x2

y2

? x2?x1 ?
,

 (266)

c =

? es ?
n

x1
?

?es ?
n?1

x2
? x2?x1 ?

,
 (267)

com:

x1=?? t pres?
n?1 ,  (268)

x 2=?? t pres ?
n?1??? t pres ?

n ,  (269)

y1=?es ?
n?1?? es?

n ?2 ,  (270)

y2=?es ?
n??es ?

n?2 .  (271)

No  programa,  foi  implementado  um  esquema  onde,  para  garantir  maior  estabilidade,  a 

Equação  (264) é usada sempre que os coeficientes  b e  c são ambos maiores que zero. Em caso 

contrário,  uma  estimativa  linear  é  utilizada.  O  resultado  obtido  com  essa  abordagem  no  caso 

derivado  do  Caso  Comparativo  SE10  pode  ser  visto  na  Figura  5.13 onde,  para  efeito  de 

comparação  com  a  Figura  5.11,  as  escalas  dos  eixos  foram  mantidas.  O  método  permite  a 

simulação com maiores intervalos de tempo e menor número de passos.

102



Figura 5.11: Controle de passo de tempo por relação linear em modelo 
altamente  heterogêneo  derivado  do  Caso  Comparativo  SPE10. 
Máximo erro de soma de saturações alvo: 10%. Máximo intervalo de 
tempo permitido: 50 dias.

Figura  5.12:  Aplicação  de  uma  equação  de  segundo  grau  para 
determinação do Máximo erro de soma de saturações previsto.

103

0 200 400 600 800 1000
0

10

20

30

40

50

60

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

50

60

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)
Erro Máximo de Saturação (%)

Tempo
n-2 n-1 n n+1

( ) previstosemax

y1
y2



Observa-se também que, embora o controle dos  picos da oscilação tenha sido efetivo, o 

caráter oscilatório do controle continua a existir. Essa abordagem se mostrou mais eficiente para 

casos homogêneos (Figura 5.14), razão pela qual foi mantida como opção do programa.

0 200 400 600 800 1000
0

10

20

30

40

50

60
 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

50

60

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)

Figura  5.13: Controle de passo de tempo por relação linear com erro 
estimado  por  equação  de  segundo  grau  em  modelo  altamente 
heterogêneo derivado do Caso Comparativo SPE10. Máximo erro de 
soma  de  saturações  alvo  =  10%.  Máximo  intervalo  de  tempo 
permitido: 50 dias.

104



Figura  5.14:  Controle  de  passo  de  tempo  em  caso  homogêneo  com 
1500  células  através  de  erro  esperado.  Máximo  erro  de  soma  de 
saturações alvo = 0,35%.

Uma vez que nenhuma das estratégias de controle de intervalo de tempo apresentadas até 

este ponto foi plenamente eficiente para a solução de um caso muito heterogêneo, procurou-se 

uma nova abordagem para o problema. Como o máximo erro de soma de saturações mostrou um 

caráter  cumulativo,  a  nova  abordagem  consiste  em  manter  o  intervalo  de  tempo  constante  e 

monitorar  o  máximo  erro,  até  que  um  valor  limite  seja  atingido.  Quando  o  valor  limite  é 

superado, utiliza-se, no passo seguinte, um intervalo de tempo relativamente pequeno, visando 

criar uma grande redução na grandeza dos erros de soma de saturações. Ao se realizar este passo 

de  tempo,  fixa-se  a  condição  de  regularização  das  linhas  de  controle  para  regularização  por 

volumes  iguais  com  multiplicador  igual  a  2,0  de  modo  a  minimizar  o  efeito  de  dispersão 

provocada  por  aglutinação  de  várias  células  em  um  único  segmento  regularizado  de  linha  de 

corrente.  Essa  estratégia  de  controle  de  passo  de  tempo  é  aqui  denominada  de  “gatilho”.  Na 

implementação, o intervalo de tempo necessário para a redução do erro de soma de saturações é 

determinado em função do  critério de Courant-Fredrich-Lewy. Para a determinação deste passo 

105

0 200 400 600 800 1000
0.00

0.05

0.10

0.15

0.20

0.25

0.30

0.35

0.40

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)



de tempo, utiliza-se um múltiplo do menor dos tempos de cruzamento de célula entre todas as 

células do reservatório, calculado pela mesma equação utilizada no método de Pollock:

? t red=M { 1h l ln[ ul ,0
inter?hl ? l

u l ,0
inter ]?mínimo},  (272)

onde l, significa qualquer das três dimensões, x, y ou z, hl é o gradiente de velocidade no interior 

da  célula  e  M é  o  parâmetro  de  multiplicação  que  deve  ser  especificado  ao  se  executar  o 

programa. O menor tempo de cruzamento de célula não atende, a rigor, o critério de Courant-

Fredrich-Lewy, pois a velocidade da frente é diferente da velocidade intersticial, porém, ele ainda 

é útil como referência para a determinação do intervalo de tempo a ser utilizado. 

No programa desenvolvido, não existe nenhuma opção para se repetir um passo que tenha 

gerado  um  elevado  aumento  no  máximo  erro  de  soma  de  saturações.  Entretanto,   em 

determinadas situações, essa poderia ser uma estratégia útil.

No Capítulo 7, é apresentada uma análise de sensibilidade aoe parâmetro  M para um dos 

casos estudados. Observou-se que, se o valor de M é muito pequeno, podem ocorrer problemas na 

solução  da  pressão.  Esses  problemas,  devem-se  à  utilização  do  termo  (V?es), que  como  foi 

anteriormente explicado, corresponde a volumes que são injetados ou produzido durante o passo 

de  tempo,  visando  a  eliminação  dos  erros  acumulados.  Esses  volumes  são  independentes  do 

intervalo de tempo. A redução do intervalo de tempo corresponde, portanto, a um incremento em 

ordem inversa na vazão representada pelos volumes, o que pode acarretar cálculo de pressões 

irreais.  Por  outro  lado,  um  valor  de  M excessivamente  alto,  fará  com  que  o  passo  de  tempo 

utilizado no “gatilho” não seja suficientemente pequeno para efetivamente reduzir o máximo erro 

de soma de saturações. De modo geral, observou-se que o valor adequado de M possui ordem de 

grandeza de 10-1.

Na presente implementação, um intervalo de tempo inicial deve ser especificado. Durante 

os primeiros passos, o intervalo é sucessivamente multiplicado por 1,5 até que um valor máximo 

seja  atingido.  Então  esse  valor  de  passo  de  tempo  é  mantido.  O  máximo  erro  de  soma  de 

106



saturações é monitorado desde o início da simulação.  Observou-se que a estratégia de “gatilho” é 

eficiente. O resultado obtido com o caso derivado do Caso Comparativo SPE10 pode ser visto na 

Figura 5.15, onde fica claro como a execução de um passo de tempo, com pequeno intervalo, faz 

com que o máximo erro de soma de saturações sofra uma grande redução. Nos testes que foram 

feitos, obteve-se tempos totais de processamento da ordem de 1/3 dos tempos obtidos com as 

estratégias anteriores, mantendo-se o controle sobre o máximo erro de soma de saturações.

5.7 Correção de Intervalo de Tempo para Erros de Balanço de Massa

No capítulo sobre simulação para sistemas incompressíveis foi apresentada uma correção 

no  tempo  reportado,  proposta  por  Batycky  (1997),  que  visa  a  correção  dos  erros  inerentes  à 

107

0 100 200 300 400 500 600 700 800 900 1000
0

10

20

30

40

50

60
 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

50

60

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)

Figura 5.15: Controle de passo de tempo por monitoração do  máximo 
erro  de  soma  de  saturações  em  modelo  altamente  heterogêneo 
derivado  do  Caso  Comparativo  SPE10.  Máximo  erro  de  soma  de 
saturações  alvo  =  10%;  Multiplicador  M =  0,05;  Máximo  passo  de 
tempo = 50 dias.



simulação  por  linhas  de  corrente.  O  mesmo  tipo  de  correção  deve  ser  feito  para  sistemas 

compressíveis.  Porém,  enquanto  que,  para  sistemas  incompressíveis,  essa  correção  é  feita  em 

termos de volumes, para sistemas compressíveis ela deve ser feita em termos de massa.

Na implementação desenvolvida, é possível calcular e reportar os erros ocorridos em cada 

componente e fase. Os erros de massa relativos a cada passo de tempo para componente “óleo 

pesado”, componente “óleo leve” e as fases óleo e água são definidos, respectivamente, como:

? EBM h
passo ?n=

? mh
n?1?mh

n ???mh ?passo
n

?mh ?passo
n ,  (273)

? EBM l
passo ?n=

? ml
n?1?ml

n ???ml ?passo
n

?ml ? passo
n ,  (274)

? EBM o
passo ?n=

[? mh?ml ?
n?1?? mh?ml ?

n ]?[?mh ??? ml ?]passo
n

? mh? passo
n ??ml ?passo

n ,  (275)

? EBM w
passo ?n=

? mw
n?1?mw

n ???mw ?passo
n

?mw ?passo
n ,  (276)

mc
n  é a massa existente no reservatório no instante n e ?mc? passo

n é a massa do componente ou 

fase c produzida no passo de tempo n. Os erros acumulados são definidos por:

? EBM h
acum?n =

?mh
0?mh

n ?? ?
passo=1

n

?mh ?passo
n

?
passo=1

n

?mh?passo
n

,  (277)

? EBM l
acum?n =

?ml
0?ml

n ?? ?
passo=1

n

?ml ?passo
n

?
passo=1

n

?ml ?passo
n

,  (278)

? EBM o
acum?n =

?mh
0?ml

0?mh
n?ml

n?? ?
passo=1

n

? mh?ml ? passo
n

?
passo=1

n

? mh?ml ? passo
n

,  (279)

108



? EBM w
acum?n =

?mw
0 ?mw

n ?? ?
passo=1

n

?ml ?passo
n

?
passo=1

n

?mw ?passo
n

.  (280)

Considerando um fator F de correção do intervalo de tempo, definido de tal modo a anular 

o erro acumulado de massa de óleo, pode-se deduzir:

F =
? tcorrigida

n

? t n
.  (281)

Aplicando-se a correção sobre a massa de óleo produzida no último passo, têm-se:

mo
o ?mo

n=?
i =1

n?1

? mo?passo
i ?F ?mo?passo

n ,  (282)

F =
mo

o ?mo
n??

i =1

n?1

? mo?passo
i

?mo ?passo
n .

 (283)

de onde se define:

F =
?mh

0?ml
0?mh

n ?ml
n ???

i=1

n?1

[?mh ?passo?? ml ?passo ]
i

[? mh? passo?? ml ?passo]
n .

 (284)

O  novo  intervalo  de  tempo  a  ser  reportado  e  o  valor  das  massas  dos  componentes 

produzidas/injetadas no passo de tempo são corrigidos, multiplicando-os pelo fator F.

Foram observados erros instantâneos na maioria dos casos estudados inferiores a 2%. Uma 

vez feita a correção com base na massa de óleo, os erros  instantâneos dos demais componentes 

são em geral inferiores a 1%.

109



Capítulo 6    

Aplicações

Visando  validar  os  programas  que  foram desenvolvidos, alguns  modelos  de  reservatório 

foram  preparados  e  simulados,  tanto  nos  simuladores  por  linhas  de  corrente,  quanto  em  um 

simulador  comercial  por  diferenças  finitas  que  possui  a  opção  “API  Tracking”  (Geoquest 

Reservoir Technologies, 2002). Considera-se que a capacidade de reprodução dos resultados de 

um  simulador  comercial  por  diferenças  finitas,  o  qual  já  foi  amplamente  testado  na  área  de 

engenharia de reservatórios, é suficiente para validar as implementações. Por outro lado, uma vez 

que existe uma grande diferença entre os métodos de solução, não se espera que a reprodução dos 

resultados seja perfeita em todas as situações.

Foram feitas validações para as formulações incompressível e compressível. Uma vez que a 

formulação  compressível  tem  um  nível  de  complexidade  maior,  foram  criados  para  esta 

formulação dois modelos adicionais de grandes dimensões e grande heterogeneidade, objetivando 

aumentar a confiabilidade das validações executadas. 

A comparação entre tempos de CPU não era um dos objetivos, uma vez que o simulador 

por diferenças finitas utilizado para comparação é um programa comercial amplamente testado e 

otimizado ao longo dos anos. Entretanto, observou-se que, para casos maiores pode-se reproduzir 

os resultados da simulação por diferenças finitas utilizando-se simulação por linhas de corrente 

com um tempo de CPU sensivelmente menor.

110



6.1 Sistema Incompressível

Três modelos de reservatório hipotéticos foram utilizados para a validação da formulação 

incompressível (Beraldo  et al., 2007). Os três casos são baseados em um modelo derivado do 

segundo  conjunto  de  dados  dos  Casos  Comparativos  SPE10  (Christie  e  Blunt,  2001).  O  caso 

SPE10 original corresponde a uma malha Cartesiana que representa um bloco de 365,760 m de 

largura por 670,560 m de comprimento e 51,816 m de espessura. São definidas 85 camadas de 

simulação de 60 por 220 células, em um total de 1.122.000 células. Cada célula tem as dimensões 

horizontais  de  6,096 m  por  3,048 m,  com  espessura  de  0,610 m.  O  modelo  tem  grande 

heterogeneidade, sendo que as 35 camadas superiores representam um ambiente de progradação 

marinha sobre o sistema fluvial, representado pelas demais camadas.

No  modelo  adotado,  foram  feitas  transferências  de  escala  da  porosidade  e  da 

permeabilidade  para  uma  malha  de  20  por  55  células  na  direção  horizontal,  mantendo-se  o 

número  de  85  camadas,  em  um  total  de  93.500  células.  Visando  tornar  o  modelo  mais 

representativo  dos  campos  de  petróleo  marítimos  encontrados  no  Brasil,  o  volume  poroso  foi 

aumentado em aproximadamente nove vezes, definindo-se células de 60 x 40 x 0,5 m. O modelo 

adotado  representa,  portanto,  um  bloco  de  1200 x 2200 x 42,5 m.  A  porosidade,  após  a 

transferência  de  escala,  é  mostrada  na  Figura  6.1.  O  logaritmo  (base  10)  da  permeabilidade 

horizontal pode ser visto na Figura 6.2. O  relação entre as escalas vertical e horizontal em todas 

as figuras é igual a quatro.

As permeabilidades relativas ao óleo e à água correspondem às originais do modelo SPE10, 

multiplicadas, respectivamente,  por 0,8 e 0,5; visando melhor representar os reservatórios alvo. 

A Tabela 2 apresenta as permeabilidades relativas utilizadas. As respectivas curvas são mostradas 

na Figura 6.3.

111



112

Figura 6.1: Distribuição inicial de porosidade do modelo incompressível.

Figura  6.2:  Distribuição  da  permeabilidade  horizontal  (direção  x)  do  modelo 
incompressível.  A  escala  de  cores  corresponde  ao  logaritmo  na  base  10  da 
permeabilidade dada em 10-3 µm2 (10-3 µm2  = 1,01325 mD).  



Tabela 1: Permeabilidades Relativas

Sw(%) kro krw
0,000 1,000 0,000
0,200 0,800 0,000
0,250 0,672 0,003
0,300 0,556 0,014
0,350 0,450 0,031
0,400 0,356 0,056
0,450 0,272 0,087
0,500 0,200 0,125
0,550 0,139 0,170
0,600 0,089 0,222
0,650 0,050 0,281
0,700 0,022 0,347
0,750 0,006 0,420
0,800 0,000 0,500
1,000 0,000 1,000

0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

 K
ro

 K
rw

P
er

m
ea

bi
lid

ad
e 

R
el

at
iv

a

Sw

Figura 6.3: Curvas de permeabilidades relativas utilizadas 
nos casos incompressíveis.

113



A Tabela 2 mostra as propriedades de óleo que foram usadas nos casos incompressíveis. A 

viscosidade  e  o  fator  de  formação  de  volume  da  água  são,  respectivamente,  0,7x10-3 Pa.s  e 

1,010 m3/std m3.

Tabela 2: Propriedades do Óleo nos 

Casos Incompressíveis
API Bo

(m3/ std m3)
?o

(Pa.s)
19 1,100 6,0x10-3
31 1,200 2,0x10-3

Assim  como  no  Caso  Comparativo  SPE10,  foram  considerados  4  poços  produtores  nos 

cantos do modelo com um poço injetor no centro (Figura 6.4). Todos os poços são completados 

do topo  até  a  base.  O  poço  localizado  no  centro  tem  uma  vazão  de  injeção  em condições  de 

reservatório constante, igual a 1.000 m3/d. Os poços produtores operam com pressão de fundo de 

27.000 kPa. Foi simulado um período de três mil dias de produção. 

114

PROD2

PROD1

PROD3

PROD4

INJE1

Figura 6.4: Localização dos poços do modelo.



Uma  pequena  compressibilidade  igual  a  0,01x10-30 kPa-1  foi  utilizada  na  simulação  por 

diferenças finitas, uma vez que o simulador utilizado exige compressibilidade diferente de zero.

a) Caso Degrau Incompressível:

Este caso hipotético foi criado visando comparar as soluções obtidas por linhas de corrente 

e  por  diferenças  finitas,  quando  existem  descontinuidades  nas  condições  iniciais.  O  modelo, 

derivado do Caso Comparativo SPE10, descrito acima, foi dividido em três regiões na sua maior 

direção, portando óleo com Grau API de 20, 25 e 30 (Figura 6.5).

Figura 6.5: Distribuição inicial de Grau API de óleo do Caso Degrau Incompressível.

b) Caso Gradual Incompressível:

Este caso representa a situação mais realista, onde o Grau API do óleo varia gradualmente 

na direção de maior extensão entre Graus API de 20 e 30. Na direção vertical, a diferença entre o 

Grau API do óleo na base e no topo é três (Figura 6.6). 

115



Figura 6.6: Distribuição inicial de Grau API de óleo do Caso Gradual Incompressível.

c) Caso Uniforme Incompressível:

Visando  analisar  a  influência  da  variação  da  qualidade  do  óleo,  foi  criado  um  terceiro 

modelo,  com  as  mesmas  características  dos  anteriores, onde  o  Grau  API do óleo  é  constante, 

igual a 25, em todo o reservatório.

6.2 Sistema Compressível

Foram  utilizados  inicialmente,  na  formulação  compressível,  dois  modelos  simples  e 

homogêneos,  com  apenas  três  camadas,  para  a  análise  das  situações  de  descontinuidade  e  de 

gradação de Grau API. Em seguida foi estudado um caso heterogêneo, com o mesmo número de 

células dos casos utilizados na formulação incompressível. Além desses, foram construídos um 

caso que utiliza a malha completa do Caso Comparativo SPE10 e outro baseado em um modelo 

de  um  campo  de  petróleo  real.  Para  comparação,  todos  os  casos  foram  executados  tanto  no 

simulador por linhas de corrente, como no simulador comercial por diferenças finitas. 

O caso heterogêneo foi utilizado para análise da influência dos parâmetros de regularização 

116



e do número de linhas de corrente lançadas na Fase 1. O mesmo caso também propiciou a análise 

do efeito do parâmetro  M, o  qual controla o passo de tempo necessário para reduzir o erro de 

soma de saturações, e o efeito da compressibilidade na curva de produção simulada.

Os parâmetros relacionados à regularização das linhas de corrente também foram estudados 

com o caso baseado no campo de petróleo real, pois esta é uma situação especial onde existe 

contato óleo-água. 

a) Caso Degrau Homogêneo Compressível:

Este caso possui três camadas de 100 x 50 células com lados de 20 m e espessura de 10 m. 

A Figura 6.7 mostra a distribuição inicial de Grau API para este caso.

Figura  6.7:  Distribuição  inicial  de  Grau  API  de  óleo  do  Caso  Degrau  Homogêneo 
Compressível.

O  caso  é  homogêneo  com  permeabilidade  horizontal  de  500,0x10-3 µm2 e  vertical  de 

10,0x10-3 µm2. A porosidade é uniforme, igual a 25%.

As  compressibilidades  da  água  e  dos  poros  são,  respectivamente,  0,40x10-6 kPa-1  e 

117



1,0x10-6 kPa-1. As propriedades extremas de óleo são mostradas na Tabela 3. A última coluna da 

tabela representa a taxa de variação relativa de viscosidade com a pressão.

Tabela 3: Propriedades Extremas de Óleo dos
 Casos Degrau e Gradual Compressíveis

API Bo
 (m3/ std m3)

psat
(kPa)

c
(kPa)-1

?o
(Pa.s)

(dµ/dp)/µsat
(kPa)-1

31 1,300 15.000 0,80x10-6 2,0x10-3 0,200x10-6

19 1,100 10.000 0,60x10-6 6,0x10-3 0,333x10-6

Considera-se  topo  do  reservatório  a  2.500 m  e  pressão  inicial  de  29.000 kPa,  na 

profundidade de 2.515 m.

Visando observar a deformação da região de descontinuidade entre os óleos de diferentes 

qualidades, foram definidos dois poços injetores e dois poços produtores, em posições tais, que 

ocorresse inversão da direção de escoamento dos fluidos ao longo dessa região (Figura 6.8). Os 

poços  injetores  operam  com  vazão  em  condições  de  reservatório  de  700 m3/d  e  os  poços 

produtores, com pressão mínima de 27.000 kPa.

Injetor

Produtor

Figura 6.8: Localização dos poços do Caso Degrau Homogêneo Compressível.

118



b) Caso Gradual Homogêneo Compressível:

Em termos de reservatório, a única diferença entre este caso e o anterior é a distribuição 

inicial de Grau API do óleo, a qual é mostrada na Figura 6.9.

Foi  definido,  neste  caso,  um  poço  injetor  e  dois  poços  produtores  com  as  mesmas 

características do caso anterior. Os poços foram localizados de forma a reproduzir o efeito de 

variação da produtividade do poço em função da variação da qualidade do óleo produzido ao 

longo do tempo (Figura 6.10).

119

Figura  6.9:  Distribuição  inicial  de  Grau  API  de  óleo  do  Caso  Gradual  Homogêneo 
Compressível.



Injetor

Produtor

Figura 6.10: Localização dos poços do Caso Gradual Homogêneo Compressível.

c) Caso Gradual Heterogêneo Compressível:

Este caso possui a mesma malha do Caso Gradual Incompressível. Entretanto, as dimensões 

das células foram escolhidas de modo que as dimensões totais do modelo se aproximassem do 

Caso  Comparativo  SPE  original.  As  células  possuem  dimensões  de  18 x 12 x 0,6 m  e  as 

dimensões  totais  do  modelo  são  360 x 660 x 85 m.  A  distribuição  de  Grau  API  do  óleo  a 

configuração dos poços também é a mesma do  Caso Gradual Incompressível.

d) Campo de Namorado Modificado:

Este  caso  foi  derivado  de  um  modelo  já  existente,  o  qual  utiliza  dados  do  Campo  de 

Namorado,  disponibilizados  pela  Petrobras.  O  objetivo  deste  estudo  foi  verificar  o 

comportamento do simulador compressível, quando todas as características de um campo real são 

consideradas.  Entre  essas  características,  está  a  morfologia  externa  de  um  reservatório  real, 

caracterizada  através  da  utilização  de  células  inativas,  a  presença  de  um  contato  óleo-água  e 

grande quantidade de poços, entrando em produção segundo um cronograma específico. Deve-se 

salientar que, embora o modelo seja derivado do Campo de Namorado, ele não é representativo 

do  mesmo,  pois  importantes  características,  como  espessura  porosa,  contato  óleo-água  e 

propriedades  de  fluido  e  propriedades  de  rocha,  foram  definidas  apenas  para  efeito  de 

comparação entre a formulação por linhas de corrente e por diferenças finitas.

120



O modelo possui 80 x 45 células de 100 m de lado na direção horizontal e 79 camadas de 

5 m  de  espessura.  O  número  de  células,  após  a  desativação  de  células  para  reprodução  da 

morfologia do reservatório, é 43.323.

No modelo utilizado, existe heterogeneidade de porosidade e permeabilidade. Os campos 

de permeabilidade horizontal e permeabilidade vertical são mostrados na Figura 6.11 e na Figura

6.12, respectivamente.

121

Figura 6.11: Permeabilidade horizontal do Campo de Namorado Modificado (10-3 µm2)



Figura 6.12: Permeabilidade vertical do Campo de Namorado Modificado (10-3 µm2)

Foi  considerada  uma  distribuição  inicial  hipotética  de  Grau  API  de  óleo  que  varia 

gradualmente de 20 a 30, ao longo do maior eixo do campo (Figura 6.13).

As curvas de permeabilidades relativas utilizadas foram as mesmas dos modelos anteriores 

(Tabela 2 e Figura 6.3).

A compressibilidades de rocha considerada foi 1,0x10-6 kPa-1 e da água 0,40x10-6 kPa-1. As 

propriedades extremas de óleo são as mesmas dos casos anteriores, mostradas na Tabela 3. 

122



Figura  6.13:  Distribuição  inicial  de Grau  API de  óleo  do Caso  Campo  de  Namorado 
Modificado

O reservatório, incluindo a região abaixo do contato óleo água, está a localizado entre as 

profundidades de 2938 m e 3328 m. O modelo foi inicializado com pressão média de 29.000 kPa, 

na profundidade de 3025,5 m. Existe um contato óleo-água definido na profundidade de 3118 m. 

A  Figura  6.14,  que  mostra  a  saturação  inicial  de  água,  permite  a  visualização  do  contato  em 

relação ao reservatório.

Todos  os  poços  são  verticais  e  seus  intervalos  de  comunicação  com  o  reservatório  são 

baseados nas completações reais dos poços do Campo de Namorado. Os poços injetores operam 

com  vazão  constante  em  condições  de  reservatório  de  500 m3/d  e  os  poços  produtores,  com 

pressão  mínima  de  22.000  kPa.  Foi  implementada  no  programa  a  opção  de  fechamento 

automático dos poços produtores, quando uma vazão mínima de óleo é atingida. Neste modelo, a 

vazão mínima considerada foi de 5 m3/d.

123



A  Tabela 4 mostra o cronograma de entrada dos poços. Observa-se que o poço produtor 

NA-001 produz durante um mês no início de produção do campo, sem que haja injeção de água. 

Essa é uma situação impossível de ser simulada com um simulador onde a formulação utilizada 

não  considera  compressibilidade.  Para  simular  essa  situação  utilizando  linhas  de  corrente,  foi 

necessário, apenas, impor-se uma vazão de injeção desprezível no modelo. No caso, considerou-

se o primeiro poço injetor do cronograma (NA-06I), injetando  0,1 m3/d, durante o primeiro mês.

e) Caso Comparativo SPE10 Modificado:

Desejava-se comparar o desempenho da simulação compressível por linhas de corrente com 

a  simulação  por  diferenças  finitas  em  um  modelo  com  um  número  de  células  da  ordem  de 

milhões. Foram feitas simulações em um modelo semelhante ao Caso Gradual Incompressível, 

mantendo-se, entretanto, o mesmo número de células do Caso Comparativo SPE10, ou seja, uma 

malha de 60 x 220 x 85, num total de 1.122.000 células. As células possuem dimensões laterais 

124

Figura 6.14: Saturação Inicial de Água do Modelo do Campo de Namorado Modificado.



de  6 x 3 m, e espessura de 1 metro, o que significa que as dimensões horizontais do modelo são 

360 x 660 m e a espessura, 85 m.

Os campos originais de porosidade e permeabilidade horizontal são mostrados na  Figura

6.15 e  na  Figura  6.16.  Existem  no  modelo  original  regiões  com  grandes  contrastes  de 

permeabilidade entre células, com valores de permeabilidade de até 20 µm2, o que faz com que a 

solução numérica seja muito difícil. No modelo utilizado para o teste da simulação por linhas de 

corrente  e  comparação  com  simulação  por  diferenças  finitas,  a  permeabilidade  máxima  foi 

limitada  a  3 µm2. Visando evitar quebras  excessivas  de intervalos  de  tempo na simulação  por 

diferenças finitas foram, também, desativadas todas  células  com porosidade inferior a 10%. A 

distribuição inicial de Grau API, com visualização somente das células ativas, pode ser vista na 

Figura 6.17.

Figura  6.15:  Distribuição  inicial  de  porosidade  do  Caso  Comparativo  SPE10 
Modificado.

125



Tabela 4: Cronograma de Entrada de Poços 
no Modelo Campo de Namorado 

Modificado
Tempo(dias) Poço Tipo

0.0 NA-001 PRODUTOR
30.0 NA-006I INJETOR
60.0 NA-002 PRODUTOR
90.0 NA-009I INJETOR
120.0 NA-003 PRODUTOR
150.0 NA-018I PRODUTOR
180.0 NA-007 PRODUTOR
210.0 NA-020I INJETOR
240.0 NA-008 PRODUTOR
270.0 NA-023I PRODUTOR
300.0 NA-009 PRODUTOR
330.0 NA-024I PRODUTOR
390.0 NA-027I INJETOR
420.0 NA-010 INJETOR
450.0 NA-031I INJETOR
480.0 NA-012 PRODUTOR
510.0 NA-032I INJETOR
540.0 NA-015 PRODUTOR
570.0 NA-033I PRODUTOR
660.0 NA-024 PRODUTOR
690.0 NA-038I INJETOR
720.0 NA-025 INJETOR
750.0 NA-039I PRODUTOR
780.0 NA-026 INJETOR
840.0 NA-030 INJETOR
870.0 NA-031 PRODUTOR
900.0 NA-033 PRODUTOR
930.0 NA-034 PRODUTOR
960.0 NA-035 INJETOR
1020.0 NA-037 PRODUTOR
1050.0 NA-038 INJETOR
1080.0 NA-039 PRODUTOR
1110.0 NA-040 PRODUTOR
1140.0 NA-041 INJETOR
1170.0 NA-042 PRODUTOR
1230.0 NA-044 PRODUTOR
1260.0 NA-045 PRODUTOR
1290.0 NA-046 PRODUTOR
1320.0 NA-047 PRODUTOR
1350.0 NA-048 PRODUTOR
1380.0 NA-049 PRODUTOR
1410.0 NA-050 PRODUTOR
1440.0 NA-051 PRODUTOR

126



Figura 6.16: Distribuição da permeabilidade horizontal (direção x) do Caso Comparativo 
SPE10 Modificado.

Figura  6.17:  Distribuição  inicial  de  Grau  API  de  óleo  do  Caso  Comparativo  SPE10 
Modificado. Somente as células do modelo que não foram desativadas estão visíveis.

127



Capítulo 7    

Resultados

Neste capítulo, são mostradas comparações  entre resultados de simulações  por linhas de 

corrente e por diferenças finitas dos casos compressíveis e incompressíveis definidos no capítulo 

anterior.  Também  são  apresentados  estudos  de  sensibilidade  a  alguns  parâmetros  de  controle 

numérico da simulação por linhas de corrente.

Os melhores valores para os parâmetros de controle numérico dependem do problema a ser 

resolvido. As análises que são apresentadas neste trabalho visam mostrar o comportamento geral 

da qualidade da solução e do tempo de processamento com a alteração desses parâmetros.

7.1 Sistema Incompressível

As  simulações  por  linhas  de  corrente  realizadas  nos  casos  incompressíveis  utilizaram  a 

formulação  que  foi  apresentada  na  fundamentação  teórica  (Capítulo  3)  e  na  descrição  do 

simulador incompressível (Capítulo 4).

 Utilizou-se  uma  máquina  com  processador  duplo  e  freqüência  de  3  GHz  em  todas  as 

execuções  em  sistema  incompressível.  Em  todas  as  simulações  por  linhas  de  corrente,  foram 

lançadas 40.000 linhas na Fase 1.

128



a) Caso Degrau Incompressível:

Na  Figura 7.1, pode-se ver os resultados da distribuição de saturação de água ao final de 

3.000  dias  de  produção,  utilizando-se  tanto  o  simulador  por  linhas  de  corrente,  quanto  o 

simulador comercial. A coluna de cruzamento entre os planos verticais corresponde à localização 

do poço injetor. A mesma comparação para a distribuição final de Grau API é mostrada na Figura

7.2. Pode-se ver que os resultados são muito parecidos. Próximo ao poço injetor, a dispersão de 

saturação de água é maior na simulação por linhas de corrente. Explica-se essa dispersão pelo 

fato de que, nessa região, a velocidade dos fluidos é maior, o que faz com que várias células da 

malha original sejam englobadas em um único segmento regularizado de linha de corrente, uma 

vez que a divisão é feita em intervalos constantes de tempo de vôo (Beraldo, 2007).

Linhas de Corrente Diferenças Finitas

Figura  7.1: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Degrau Incompressível.

Linhas de Corrente Diferenças Finitas

Figura  7.2: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Degrau Incompressível.

129



As  curvas  de  produção  de  óleo  e  produção  total  de  cada  um  dos  poços,  obtidas  com 

simulação  por  linhas  de  corrente  e  com  simulação  por  diferenças  finitas,  são  mostradas  nos 

gráficos da  Tabela 7. Observa-se a coerência muito boa entre os resultados, tanto em relação a 

tempo de irrupção de água e elevação do corte de água, como em relação à produtividade dos 

poços. As  curvas  de volumes  in situ e  produções   acumuladas  são mostradas  na  Figura 7.4 e 

comprovam a reprodução dos resultados do simulador comercial.

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                               PROD2

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD3                                                                           PROD4
Figura  7.3:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Degrau 
Incompressível

Os tempos de execução foram de 48 minutos, para simulação por linhas de corrente, e 46 

minutos, para simulação por diferenças finitas.

130



0 500 1000 1500 2000 2500 3000
0

2

4

6

8

10

12

14

V
ol

um
e 

(1
06

 m
3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Figura  7.4:  Curvas  de  produções  acumuladas  de  óleo  e 
água (Np e Wp) e Volume de Óleo In Situ do Caso Degrau 
Incompressível.

b) Caso Gradual Incompressível:

As mesmas comparações feitas para o Caso Degrau Incompressível também foram feitas 

para o Caso Gradual Incompressível. As comparações entre as distribuições de saturação de água 

e de Grau API de óleo são mostradas na Figura 7.5 e na Figura 7.6. Assim como no caso Degrau, 

foi observada  maior dispersão de saturação de água, nas proximidades do poço injetor.

Linhas de Corrente Diferenças Finitas

Figura  7.5: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Gradual Incompressível.

131



Linhas de Corrente Diferenças Finitas

Figura  7.6: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Gradual Incompressível.

As comparações entre as curvas de produção dos poços são mostradas na  . O poço com 

maior produção de água é o PROD4. Neste poço, a irrupção de água, quando se utiliza linhas de 

corrente,  ocorre  aproximadamente  450  dias  antes  da  irrupção  observada  quando  se  utiliza 

diferenças finitas. As curvas de  volumes acumulados e in situ podem ser vistas na Figura 7.8. As 

mesmas  observações  feitas  sobre  os  resultados  de  Caso  Degrau  Incompressível  também  se 

aplicam ao Caso Gradual Incompressível.

Os tempos de execução foram de 49 minutos, para simulação por linhas de corrente, e 42 

minutos, para simulação por diferenças finitas.

132



0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600
V

az
ão

 (
m

3 /d
)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                               PROD2

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD3                                                                           PROD4
Figura  7.7:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Caso  Degrau 
Incompressível

133



0 500 1000 1500 2000 2500 3000
0

2

4

6

8

10

12

14

V
ol

um
e 

(1
06

 m
3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Figura  7.8:  Curvas  de  produções  acumuladas  de  óleo  e 
água  (Np  e  Wp)  e  Volume  de  Óleo  In  Situ  do  Caso 
Gradual Incompressível.  

c) Caso Uniforme Incompressível:

A Figura 7.9 mostra comparações entre as curvas de produção de óleo e total deste caso e 

do caso anterior. As diferenças observadas são explicadas pela variação na viscosidade do óleo, 

que é função do seu Grau API. Os poços PROD1 e PROD2, que se localizam na face de menor 

Grau API, têm as suas produtividades superestimadas, quando se considera propriedades de óleo 

uniformes,  ocorrendo  o  inverso  em  relação  aos  poços  PROD3  e  PROD4.  Esses  resultados 

reforçam a importância da caracterização da variação das propriedades do óleo, onde ela ocorrer.

134



0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (m

3 /d
)

Tempo (dias)

 Qoleo Gradual
 Qliq  Gradual
 Qoleo Uniforme
 Qliq  Uniforme

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (m

3 /d
)

Tempo (dias)

 Qoleo Gradual
 Qliq  Gradual
 Qoleo Uniforme
 Qliq  Uniforme

PROD1                     `                                                       PROD2

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (m

3 /d
)

Tempo (dias)

 Qoleo Gradual
 Qliq  Gradual
 Qoleo Uniforme
 Qliq  Uniforme

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

V
az

ão
 (m

3 /d
)

Tempo (dias)

 Qoleo Gradual
 Qliq  Gradual
 Qoleo Uniforme
 Qliq  Uniforme

PROD3                                                                              PROD4
Figura 7.9: Comparação entre curvas de produção de óleo e produção total dos poços dos 
Casos Gradual Incompressível e Uniforme Incompressível.

7.2 Sistema Compressível

As  simulações  por  linhas  de  corrente  realizadas  nos  casos  compressíveis  utilizaram  a 

formulação apresentada nos Capítulos 3 e 5.

Na abordagem com compressibilidade, os modelos homogêneos tiveram como objetivo a 

validação da formulação em situações simples.

Os modelos baseados no Campo de Namorado e no Caso Comparativo SPE10 validaram a 

135



formulação  em  situações  especiais  de  morfologia  de  reservatório,  contato  óleo-água,  grande 

heterogeneidade e grande número de células.

O  Caso  Gradual  Heterogêneo  Compressível,  assim  como  o  Campo  de  Namorado 

Modificado,  foram  utilizados  para  análises  de  sensibilidade  aos  parâmetros  que  controlam  a 

solução numérica por linhas de corrente. O Caso Gradual Heterogêneo Compressível também foi 

utilizado para comparações entre diferentes compressibilidades.

Utilizou-se,  nas  comparações  de  tempo  de  simulação  com  simulador  comercial,  uma 

máquina com processador duplo AMD Opteron 64, com  freqüência de 2GHz, 8 Gb de memória 

e  sistema  operacional  LINUX,  distribuição  CentOS 4.4.  Nas  análises  de  sensibilidade  a 

parâmetros de controle numérico de solução foi utilizado um processador duplo INTEL T2250, 

com  freqüência de 1,73GHz e 2 Gb de memória RAM com sistema Microsoft Windows XP.

a) Caso Degrau Homogêneo Compressível:

A Tabela 5 mostra os parâmetros de controle numérico utilizados na simulação deste caso. 

A regularização das linhas de corrente foi feita com base em tempos de vôo (TOF). A estratégia 

“gatilho” de controle de passo de tempo de pressão foi utilizada com intervalo de tempo máximo 

de 50 dias. Entretanto, devido à grande estabilidade do erro de soma de saturações para casos 

homogêneos,  o passo de tempo se torna fixo, após atingir o valor máximo. 

A Figura 7.10 e a Figura 7.11 mostram as comparações das distribuições finais de saturação 

de água e Grau API. Pode-se observar nas figuras de saturação de água uma dispersão um pouco 

maior da simulação por linhas de corrente nas proximidades dos poços injetores. 

136



Tabela 5: Parâmetros de Controle Numérico 
Utilizados nos Casos Degrau Homogêneo 

Compressível e Gradual Homogêneo Compressível
Parâmetro Valor

Tipo de Regularização TOF
Linhas na Fase 1 10.000

Linhas de Células “Fonte” 30
A 2,0
B 2,0
M 0,1

Linhas de Corrente Diferenças Finitas

Figura 7.10: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Degrau Homogêneo Compressível.

Linhas de Corrente Diferenças Finitas

Figura 7.11: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Degrau Homogêneo Compressível.

137



As comparações das produções de óleo e produção total são mostradas na  Figura 7.12. A 

diferença mais importante entre as curvas refere-se ao momento de irrupção de água. Em ambos 

os poços, a irrupção de água na simulação por linhas de corrente ocorre, aproximadamente, 200 

dias após a irrupção na simulação por diferenças finitas.

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

700

800

900

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

700

800

900

V
az

ão
 (

m
3 /d

)
Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                                   PROD2
Figura  7.12: Curvas de produção de óleo e produção total dos poços do Caso Degrau 
Homogêneo Compressível

A  Figura 7.13 mostra a comparação de volumes produzidos e de óleo  in situ. As curvas 

obtidas com os dois tipos de simulação são praticamente coincidentes.

A Figura 7.14 apresenta comparações entre as curvas de pressão nas células injetoras. As 

curvas representam uma média das pressões das células injetoras em que o poço está completado. 

No  início  da  injeção  do  poço  INJE2,  a  pressão  de  injeção  calculada  por  linhas  de  corrente  é 

800 kPa superior à pressão da simulação por diferenças finitas. Na Figura 7.15, são comparados 

mapas  de  saturação  de  água  na  segunda  camada  do  modelo  aos  25  dias  de produção/injeção. 

Observa-se nos dois poços injetores que, enquanto na simulação por diferenças finitas, existe um 

grande contraste de saturação entre a célula injetora e as células vizinhas, este contraste é muito 

menos acentuado na simulação por linhas de corrente. No poço INJE1, observa-se também uma 

assimetria no mapa de saturação, a qual não é  observada  na simulação por diferenças  finitas. 

Essas  diferenças  se  devem  ao  processo  de  regularização  das  linhas  de  corrente,  que  tende  a 

138



englobar mais de uma célula nos segmentos regularizados próximos aos poços. Quando se faz 

regularização por tempo de vôo, a junção de mais de uma célula em um único segmento ocorre 

devido à maior velocidade de escoamento, próximo aos poços injetores. Por outro lado, quando 

se usa  regularização  por volume,  a junção  ocorre devido  a redução  das  áreas  transversais  das 

linhas de corrente, quando se aproxima de algum poço produtor ou injetor.

0 500 1000 1500 2000 2500 3000
0
1
2
3
4
5
6
7
8
9

10
11
12
13
14
15

V
o

lu
m

e 
(1

06
 m

3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Figura  7.13:  Curvas  de  produções  acumuladas  de  óleo  e 
água (Np e Wp) e volume de óleo in situ do Caso Degrau 
Homogêneo Compressível.

 

A assimetria observada é explicada pela diferença entre as velocidades nas faces das células 

injetoras. Na face de maior velocidade, ocorre maior deslocamento de água, o que faz com que o 

primeiro segmento regularizado de cada linha lançada a partir desta face tenha uma saturação 

maior. No mapeamento da solução para a malha de simulação, a célula vizinha, conectada a esta 

face, acaba sofrendo uma elevação de saturação de água maior que as outras células vizinhas, 

provocando a anisotropia observada. Apesar da diferença na distribuição de saturação de água, a 

solução  ainda  é  correta,  do  ponto  da  vista  de  balanço  de  massa.  As  diferenças  entre  as 

distribuições  de  saturação  explicam  as  diferenças  de  pressão  de  injeção  observadas  na  Figura

139



7.14, pois afetam as permeabilidades relativas e, conseqüentemente, as transmissibilidades entre 

as células. 

0 500 1000 1500 2000 2500 3000
29000

30000

31000

32000

33000

34000

35000

 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)
0 500 1000 1500 2000 2500 3000

29000

30000

31000

32000

33000

34000

35000

 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)

INJE1                                                                                     INJE2
Figura  7.14: Curvas de pressão média nas células dos poços injetores do Caso Degrau 
Homogêneo Compressível

Na Figura 7.15 também pode ser observado como o efeito de orientação de malha é maior 

na  simulação  por  diferenças  finitas,  fazendo  com  que  a  região  lavada  tenha  uma  forma  mais 

próxima a um quadrado, enquanto a simulação por linhas de corrente apresenta formato circular, 

como era de se esperar.  A influência da orientação de malha nos resultados da simulação por 

diferenças finita não foi avaliada.

140



Figura 7.15: Comparação entre saturação de água, aos 25 dias de produção, na primeira 
camada do Caso Degrau Homogêneo. Simulação por linhas de corrente utilizando A = 2,0 
e regularização por tempo de vôo.

141

INJE 1

INJE 2

Diferenças Finitas

Linhas de Corrente

INJE 1

INJE 2



Para comprovar a hipótese da influência da distribuição de saturação na pressão de injeção, 

fez-se uma nova simulação, com refinamento de linhas de corrente suficiente para assegurar que 

o primeiro segmento  regularizado  de linha  estivesse sempre  contido  dentro da célula  injetora. 

Testes mostraram que a utilização de esquema de regularização de linha de corrente por volume 

(VOL),  com  parâmetro  A igual  a  50  seria  suficiente  para  atingir  esse  objetivo  neste  modelo 

(Tabela 6). Esta nova rodada teve um tempo de execução aproximadamente 20 vezes superior ao 

tempo da rodada anterior. A Figura 7.16 mostra a comparação entre o mapa de saturação de água, 

obtido  com  esta  nova  simulação  e  o  mapa  obtido  por  diferenças  finitas.  Observa-se  que  o 

fenômeno de dispersão na proximidade do poço injetor é sensivelmente reduzido, não se vendo 

mais assimetria no poço INJE1. 

Tabela 6: Parâmetros de Controle Numérico 
Utilizados no Casos Degrau Homogêneo para 

Análise da Influência da Regularização de Linha de 
Corrente na Pressão de Injeção

Parâmetro Valor
Tipo de Regularização VOL

Linhas na Fase 1 10.000
Linhas de Células “Fonte” 30

A 50
B 2,0
M 0,1

142



Figura 7.16: Comparação entre saturação de água, aos 25 dias de produção, na primeira 
camada do Caso Degrau Homogêneo. Simulação por linhas de corrente utilizando  A = 
50,0 e regularização por volume de linha de corrente.

143

INJE 1

INJE 2

Diferenças Finitas

Linhas de Corrente

INJE 1

INJE 2



As  novas  comparações  de  curvas  de  pressão  de  injeção  são  mostradas  na  Figura  7.17. 

Observa-se que a diferença entre as pressões do poço INJE2 no início da injeção desapareceu,  o 

que comprova a influência da dispersão na pressão de injeção.  Por outro lado, permanece uma 

diferença de pressão de ambos os poços entre 800 e 1400 dias, onde a pressão da simulação por 

linhas  de corrente é inferior. Essa diferença atinge um máximo de aproximadamente 400 kPa. 

Considerando que a pressão inicial do modelo é 29.000 kPa e que, neste momento,  a pressão 

média de células injetoras na simulação por diferenças finitas é 31.300 kPa, calcula-se um erro 

relativo de 17%, em relação à  pressurização da célula, a qual é de 2.300 kPa. 

0 500 1000 1500 2000 2500 3000
27000

28000

29000

30000

31000

32000

33000

34000

35000

36000

37000
 Pcel INJE1 LC
 Pcel INJE1 DF
 Pcel PROD1 LC
 Pcel PROD1 DF
 Corte de Água LC
 Corte de Água DF

Pr
es

sã
o 

(k
Pa

)

Tempo (dias)

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

 C
or

te
 d

e 
Á

gu
a

0 500 1000 1500 2000 2500 3000
27000

28000

29000

30000

31000

32000

33000

34000

35000

36000

37000
 Pcel INJE2 LC
 Pcel INJE2 DF
 Pcel PROD2 LC
 Pcel PROD2 DF
 Corte de Água LC
 Corte de Água DF

Pr
es

sã
o 

(k
Pa

)

Tempo (dias)

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

 C
or

te
 d

e 
Á

gu
a

INJE1                                                                                INJE2

Figura 7.17: Curvas de pressão média nas células dos poços e curvas de corte de água do 
Caso Degrau Homogêneo Compressível

Existem duas prováveis causas para essa diferença na resposta de pressão dos simuladores: 

diferença nos tratamentos dados às transmissibilidades entre células e efeito da diferença entre os 

tempos  de  irrupção  de  água  dos  dois  simuladores.  Na  mesma  Figura  7.17,  são  mostradas  as 

pressões  dos  poços  produtores  mais  próximos  e  as  curva  de  corte  de  água  do  poço  produtor 

correspondente.  As  curvas  sugerem forte  correlação  entre  a irrupção  de  água  e a  elevação  da 

pressão  nas  células.  Pode-se  observar  que,  para  os  dois  simuladores,  o  início  da  elevação  da 

pressão  nos  poços  produtores  e  injetores  corresponde  ao  tempo  de  irrupção  de  água  no  poço 

PROD2, aproximadamente aos 700 dias de produção na simulação por diferenças finitas e 900 

dias na simulação por linhas de corrente. Essa correlação sugere o efeito da produtividade dos 

poços produtores, quando ocorre a irrupção de água, provocando elevação da pressão em todo o 

144



modelo.

b) Caso Gradual Homogêneo Compressível:

Neste caso foram utilizados os mesmos parâmetros de controle numérico do Caso Degrau 

Homogêneo Compressível (Tabela 5). As mesmas comparações que foram inicialmente feitas no 

Caso  Degrau  Homogêneo  Compressível  são  apresentadas  para  o  Caso  Gradual  Homogêneo 

Compressível entre a Figura 7.18 e a Figura 7.22.

Linhas de Corrente Diferenças Finitas

Figura 7.18: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Gradual Homogêneo Compressível.

Linhas de Corrente Diferenças Finitas

Figura 7.19: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Gradual Homogêneo Compressível.

145



0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

700

800

900
V

az
ão

 (
m

3 /d
)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

100

200

300

400

500

600

700

800

900

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                                   PROD2
Figura  7.20: Curvas de produção de óleo e produção total dos poços do Caso Gradual 
Homogêneo Compressível

Na Figura 7.20, observa-se, tanto na simulação por diferenças finitas, quanto na simulação 

por linhas de corrente, uma elevação na produção do poço PROD2, aproximadamente 150 dias 

antes da irrupção de água. Esse poço se localiza próximo à face de óleo de menor Grau API. A 

elevação da produtividade deve-se à redução da viscosidade média do óleo, a qual é conseqüência 

do deslocamento de óleo da maior Grau API para esta região.

Na Figura 7.21 observa-se que a pressão de injeção da simulação por linhas de corrente é 

inferior  a  pressão  da  simulação  por  diferenças  finitas  em  uma  parte  considerável  do  período 

simulado.  Observa-se aqui, também,  um período de  estabilização de pressão, que  se inicia  no 

momento em que ocorre irrupção de água nos poços produtores.

Assim  como  no   Caso  Degrau  Homogêneo  Compressível,  as  curvas  de  volumes 

acumulados e in situ são praticamente coincidentes.

146



0 500 1000 1500 2000 2500 3000
0
1
2
3
4
5
6
7
8
9

10
11
12
13
14
15

V
o

lu
m

e 
(1

06  
m

3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Figura  7.22:  Curvas  de  produções  acumuladas  de  óleo  e 
água (Np e Wp) e Volume de Óleo In Situ do Caso Gradual 
Homogêneo Compressível.

147

INJE1
Figura 7.21: Curvas de pressão média nas células do poço 
injetor do Caso Gradual Homogêneo Compressível

0 500 1000 1500 2000 2500 3000
29000

30000

31000

32000

33000

34000

35000

36000

37000

38000

39000

40000

 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)



c) Caso Gradual Heterogêneo Compressível:

Nesta  execução  do  Caso  Gradual  Heterogêneo  Compressível  foram  utilizados  os 

parâmetros de controle numéricos mostrados na Tabela 7.

A  Figura  7.23 mostra  a  comparação  da  distribuição  de  saturação  de  água  ao  final  da 

simulação e a  Figura 7.24 mostra a comparação de Grau API de óleo. Observa-se que, com os 

parâmetros numéricos utilizados, a dispersão na saturação de água obtida com a simulação por 

linhas de corrente é sensivelmente maior que a dispersão obtida por diferenças finitas.

Tabela 7: Parâmetros de Controle Numérico 
Utilizados no Caso Gradual Heterogêneo 

Compressível
Parâmetro Valor

Tipo de Regularização TOF
Linhas na Fase 1 10.000

Linhas de Células “Fonte” 30
A 1,0
B 0,5
M 0,1

148



Linhas de Corrente Diferenças Finitas

Figura 7.23: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Gradual Heterogêneo Compressível.

Linhas de Corrente Diferenças Finitas

Figura 7.24: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Gradual Heterogêneo Compressível.

A execução  deste  caso  no  simulador  comercial  levou  95,0  minutos,  com  esquema  de 

solução implícito, e 25,8 minutos, com esquema IMPES. Os resultados obtidos com o esquema 

implícito e IMPES são muito similares.  Nas análises que se seguem, são utilizadas as soluções 

do esquema implícito, como base de comparação com a simulação por linhas  de corrente. Na 

mesma máquina, o tempo de execução da simulação por linhas de corrente, com os parâmetros 

apresentados na Tabela 7, foi de 21,0 minutos.

Embora a distribuição final de saturação de água tenha apresentado dispersão maior que a 

simulação por diferenças finitas, essa variação não teve, neste caso, grande impacto nas curvas de 

149



produção  dos  poços,  as  quais  podem  ser  vistas  na  Figura  7.25. A  Figura  7.26 mostra  a 

comparação  de  volumes  produzidos  e  de  óleo  in  situ.  A curva  de  pressão  média  nas  células 

injetoras pode ser vista na  Figura 7.27. A diferença máxima entre as pressões representa 9% da 

pressurização das células injetoras. A causa mais provável para essa diferença está no tratamento 

dado às transmissibilidades entre células.

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                             PROD2

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD3                                                                             PROD4
Figura  7.25: Curvas de produção de óleo e produção total dos poços do Caso Gradual 
Heterogêneo Compressível.

A  Figura  7.28 compara  as  curvas  das  pressões  médias  das  células  em  todo  o  modelo, 

ponderadas  pelo  espaço  poroso.  O  comportamento  da  pressão  média  é  semelhante  ao 

comportamento da pressão no poço injetor, apresentado na Figura 7.27. A reprodução deste tipo 

de comportamento de pressão, com variação em relação à pressão original superior a 20%, não 

150



seria  possível  em  um  simulador  para  sistemas  incompressíveis,  onde,  em  condições  de 

reservatório, a vazão de produção é igual à vazão de injeção.

0 500 1000 1500 2000 2500 3000
0.0

0.2

0.4

0.6

0.8

1.0

1.2

1.4

1.6

1.8

2.0

V
ol

um
e 

(1
06

 m
3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Figura  7.26:  Curvas  de  produções  acumuladas  de  óleo  e 
água (Np e Wp) e volume de óleo in situ do Caso Gradual 
Heterogêneo Compressível.

151

0 500 1000 1500 2000 2500 3000
30000

32000

34000

36000

38000

40000

42000

44000
 Pcel LC
 Pcel DF

P
re

s
s
ã
o

 (
k
P

a
)

Tempo (dias)

INJE1

Figura  7.27: Curvas de pressão média nas células do poço 
injetor do  Caso Gradual Heterogêneo Compressível.



0 500 1000 1500 2000 2500 3000
25000
26000
27000
28000
29000
30000
31000
32000
33000
34000
35000
36000
37000
38000
39000
40000

 Pressão Média LC
 Pressao Média DFP

re
ss

ão
 (

kP
a)

Tempo (dias)

INJE1
Figura 7.28: Curvas de pressão média de todas as células do 
Caso Gradual Heterogêneo Compressível.

Com  o  objetivo  de  comprovar  a  relação  entre  o  esquema  de  regularização  da  linha  de 

corrente  e  a  dispersão  da  saturação  de  água,  uma  nova  simulação  foi  realizada.  Nesta  nova 

execução  empregou-se  regularização  de  linhas  de  corrente  com  base  em  volume  (VOL), 

alterando-se o parâmetro  A, que controla o refinamento das linhas de corrente regularizadas, de 

1,0 para 3,0. A Figura 7.29 mostra a comparação da distribuição de saturação de água com os 

novos  parâmetros de  regularização.  O  nível  de  similaridade  com  o  simulador  comercial  é 

consideravelmente  maior  que  o  observado  na  Figura  7.23,  comprovando  a  relação  entre  a 

dispersão  e  o  esquema  de  regularização.  Enquanto  que,  na  execução  original,  o  tempo  de 

processamento foi de 20,5 minutos,  após  a alteração do parâmetro  A, o tempo passou a ser de 

43,7 minutos.

A diminuição da dispersão de água nesta execução teve o efeito de provocar uma pequena 

redução na pressão nas células injetoras, como pode ser visto ao se comparar a Figura 7.27 com a 

Figura 7.30. 

152



Linhas de Corrente Diferenças Finitas

Figura 7.29: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Gradual Heterogêneo Compressível com regularização de linha de corrente por volume e 
parâmetro A igual a 3,0.

Utilizando-se o Caso Gradual Heterogêneo Compressível, foi feito um estudo da influência 

dos parâmetros de controle numérico no tempo de processamento e no grau de similaridade entre 

as  soluções  obtidas  por  diferenças  finitas  e  por  linhas  de  corrente.  Os  parâmetros  estudados 

foram:

? multiplicador do menor tempo de cruzamento de célula para redução do erro máximo de 

153

0 500 1000 1500 2000 2500 3000
30000

32000

34000

36000

38000

40000

42000

44000
 Pcel LC
 Pcel DF

P
re

s
s
ã
o

 (
k
P

a
)

Tempo (dias)

INJE1
Figura  7.30: Curvas de pressão média nas células do poço 
injetor do  Caso Gradual Heterogêneo Compressível



soma de saturações (M) utilizado na Equação (272);

? número de linhas de corrente lançadas na Fase 1;

? tipo  de  regularização  de  linha  de  corrente  (“TOF”  para  tempo  de  vôo  /  “VOL”  para 

volume);

? relação básica entre o número de segmentos da linha de corrente regularizada e o número 

de nós da linha de corrente original (A) utilizada na Equação (203) e

? parâmetro  relacionado  ao  acréscimo  no  multiplicador  devido  à  compressibilidade  (B) 

utilizado na Equação (203).

Para possibilitar as análises, um indicador de similaridade IS entre as soluções por linhas de 

corrente e por diferenças finitas foi definido  para o Caso Gradual Heterogêneo Compressível:

IS = 1?
?

produtores
?Np poço

DF ?Np poço
LC ?? ?

injetores
?Wp poço

DF ?Wppoço
LC ?

Npcampo
DF ?Wpcampo

DF
,  (285)

onde DF significa resultado do simulador por diferenças finitas, LC significa resultado por linhas 

de corrente e Np e Wp significam produções acumuladas de óleo e água, ao final de simulação.

Todas as simulações desta análise foram feitas no esquema “gatilho” de controle de passo 

de tempo de pressão. O passo de tempo inicial foi de 10 dias e o passo de tempo máximo, 50 dias. 

O máximo erro da soma de saturações para disparo do “gatilho” foi 10%.

Inicialmente, foram mantidos constantes os parâmetros mostrados na Tabela 8, variando-se 

o  valor  do  multiplicador  M.  A  Tabela  9 apresenta  os  resultados  da  análise.  Neste  caso,  não 

ocorreu  problema  de  estabilidade,  ao se  reduzir  o  valor  de  M. Entretanto,  pode-se observar  a 

redução sensível do IS e aumento do tempo de execução, quando M é reduzido a 0,0001. 

154



Tabela 8: Parâmetros Fixos de Controle Numérico 
na Análise de Número de Linhas de Corrente  da 

Fase 1 (Caso Gradual Heterogêneo Compressível)
Parâmetro Valor

Tipo de Regularização TOF
Linhas na Fase 1 10.000

Linhas de Células “Fonte” 30
A 1,0
B 0,5
M -

Tabela 9: Análise de Sensibilidade ao Multiplicador M da Estratégia 
“Gatilho” de Controle de Passo de Tempo de Pressão

Multiplicador M Tempo de Execução
(min)

IS
 (%) 

0,0001 33,73 82,75
0,001 31,84 91,91
0,01 38,14 92,37
0,02 19,64 96,05
0,03 19,74 95,85
0,05 17,38 95,55
0,10 19,28 95,50
0,20 14,93 95,21
0,30 - *
0,50 - *
1,00 - *
2,00 - *
5,00 - *
10,00 - *

* Simulação interrompida devido instabilidade numérica.

Na  Figura  7.31 são  mostrados  os  valores  de  IS em  função  do  tempo  de  execução.  As 

melhores  situações  correspondem  aos  pontos  mais  próximos  ao  canto  superior  esquerdo  do 

gráfico,  pois  se  deseja  obter  boa  similaridade  e  baixo  tempo  de  execução.  As  duas  melhores 

opções são, neste caso, valores de M = 0,05 com tempo de execução de 17,38 s, e M = 0,20, com 

155



tempo de execução igual a 14,93 s. Nas análises apresentadas a seguir, foi adotado o valor de 

M = 0,05. É interessante observar que, se o valor de  M for excessivamente alto, a estratégia de 

“gatilho” deixa de ser efetiva, pois não ocorre redução do erro de soma de saturações. A Figura

7.32 mostra  a  evolução  do erro  ao  longo  do tempo,  para  os  valores  de  M = 0,05 e  M = 0,50. 

Analisando-se essa figura, pode-se ver como a utilização do passo de tempo reduzido deixa de ser 

efetiva para redução do máximo erro de soma de saturações, quando se usa M = 0,50.

0 5 10 15 20 25 30 35 40
80

82

84

86

88

90

92

94

96

98

100

Ín
di

ce
 d

e 
S

im
ila

ri
da

de
 IS

 (%
) 

Tempo de Execução (min)

Figura  7.31:  Análise  de  sensibilidade  do  Índice  de 
Similaridade e do Tempo de Execução ao parâmetros M.

Na análise de sensibilidade ao número de linhas de corrente a serem lançadas na Fase 1, 

todos os parâmetros da  Tabela 10 foram mantidos constantes, alterando-se apenas o número de 

linhas de corrente. A Tabela 11 e a Figura 7.33 mostram os resultados dessa análise. 

156



0 500 1000 1500 2000 2500 3000
0

10

20

30

40

50

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

50

60

70

80

90

100

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)
 

M = 0,05

0 500 1000 1500 2000 2500 3000
0

10

20

30

40

50

 Máximo Erro 
 Passo de Tempo

M
áx

im
o 

E
rr

o 
de

 S
at

ur
aç

ão
 (%

)

Tempo (dias)

0

10

20

30

40

50

60

70

80

90

100

 P
as

so
 d

e 
Te

m
po

 (d
ia

s)
 

M = 0,5
Figura  7.32:  Comparação  de  evolução  do  erro  máximo  de  soma  de 
saturações e do passo de tempo com M = 0,05 e  M = 0,5. A simulação 
com M = 0,5 foi interrompida por problema numérico antes de atingir 
2.400 dias simulados.

157



Tabela 10: Parâmetros Fixos de Controle Numérico 
na Análise de Número de Linhas de Corrente  da 

Fase 1 (Caso Gradual Heterogêneo Compressível)
Parâmetro Valor

Tipo de Regularização TOF
Linhas na Fase 1 -

Linhas de Células “Fonte” 30
A 1,0
B 0,5
M 0,05

Tabela 11: Análise de Sensibilidade ao Número de Linhas de Corrente 
Lançadas na Fase 1

Número de Linhas
na Fase 1

Número de Linhas
na Fase 3

(1° passo de tempo)

Tempo de 
Execução

(min)

IS
(%)

100 11.185 14,22 94,23
500 10.962 13,71 95,78
1000 10.702 14,21 95,74
2000 10.539 13,98 95,79
5000 10.172 14,03 95,41
10000 10.014 17,38 95,55
20000 9.917 24,77 94,55
50000 9.866 48,97 94,34

158



Figura  7.33:  Análise  de  sensibilidade  da  qualidade  e  do 
tempo  de  execução  em  relação  ao  número  de  linhas  de 
corrente lançadas na Fase 1.

Na segunda coluna da  Tabela 11 são apresentados os números de linhas automaticamente 

geradas na Fase 3 no segundo passo de tempo de pressão, quando estão em operação um poço 

produtor e um poço injetor. A  Figura 7.34 mostra como o número de linhas de corrente da Fase 

3, geradas a partir de células “perdidas”, se reduz, à medida que o número de linhas de corrente 

lançadas  da  Fase 1  é  aumentado.  Pode-se  observar  também,  nessa  figura,  que  o  tempo  de 

simulação só aumenta significativamente, quando o número de linhas de corrente é superior a 

10.000.  Esse  comportamento  é  explicado  pelo  efeito  compensador  da  geração  de  linhas  de 

corrente na Fase 3. Observa-se que, para este caso, a utilização de 2.000 linhas de corrente na 

Fase 1, destacada na Tabela 11, é a opção com melhor qualidade de resposta e, ao mesmo tempo, 

com o segundo menor tempo de execução. Considerando que o modelo possui 93.500 células e 

admitindo-se que o número ótimo de linhas de corrente da Fase 1 é proporcional ao número de 

células ativas, pode-se inferir que 2% do número de células ativas é um valor razoável, a ser 

utilizado como ponto de partida em um processo de otimização deste parâmetro.

159

0 10 20 30 40 50 60
90

91

92

93

94

95

96

97

98

99

100

Ín
di

ce
 d

e 
S

im
ila

ri
da

d
e 

IS
 (

%
) 

Tempo de Execução (min)



Figura  7.34:  Número  de  linhas  de  corrente  lançadas  na 
Fase  3  e  tempo  de  simulação  em  função  de  número  de 
linhas de corrente lançadas na Fase 1.

Após a análise de sensibilidade ao parâmetro M e ao número de linhas de corrente, foram 

feitas  execuções  utilizando-se  o  Caso  Gradual  Heterogêneo  Compressível,  em  diversas 

combinações entre os parâmetros  A e B e o tipo de regularização de linhas de corrente (TOF ou 

VOL). Nessas  rodadas, os valores de M = 0,05 e 2.000 linhas  de corrente lançadas na Fase 1 

foram mantidos fixos (Tabela 12).

Tabela 12: Parâmetros Fixos de Controle Numérico 
na Análise dos Parâmetros A e B (Caso Gradual 

Heterogêneo Compressível)
Parâmetro Valor

Tipo de Regularização -
Linhas na Fase 1 2.000

Linhas de Células “Fonte” 30
A -
B -
M 0,05

160

0 10000 20000 30000 40000 50000
9600

9800

10000

10200

10400

10600

10800

11000

11200

11400

11600

 Número de Linhas Fase 3
 Tempo de Simulação

Número de Linhas na Fase 1

N
úm

er
o 

de
 L

in
ha

s 
na

 F
as

e 
3

0

5

10

15

20

25

30

35

40

45

50

55

60

Te
m

po
 d

e 
S

im
ul

aç
ão

 (
m

in
)



A Tabela 13 e a Figura 7.35 mostram os resultados de IS e tempo de execução obtidos com 

24  combinações  dos  parâmetros.  Uma  vez  que  a  estratégia  “gatilho”  de  controle  de  passo  de 

tempo  foi  utilizada,  o  tempo  de  processamento  e  a  qualidade  da  solução  são  também 

influenciados  pelas  ocorrências  de  passos  de  redução  de  erros  de  soma  de  saturações,  o  que 

acrescenta algum grau de aleatoriedade aos resultados. Mesmo com essa aleatoriedade, algumas 

conclusões podem ser tiradas, ao se analisarem a Tabela 13 e a Figura 7.35:

? os  tempos  de  execução  são  da  mesma  ordem  de  grandeza,  quando  se  altera  o  tipo  de 

regularização (TOF ou VOL), mantendo-se os demais parâmetros;

? das 12 comparações entre tipo de regularização realizadas, a qualidade da regularização 

por volume  de linha  de corrente (VOL) só é inferior  à qualidade da  regularização  por 

tempo de vôo (VOL) em 2 casos;

? os  três  melhores  pontos  representam casos  com regularização  de  linha de corrente por 

volume (VOL);

? os tempos de processamento tendem a crescer em todos os casos, quando se aumenta o 

parâmetro A;

? de modo geral, não ocorre um acréscimo substancial de qualidade de solução, quando se 

eleva o valor do parâmetro B acima de 0,5;

? o ponto com a melhor relação entre qualidade e tempo de processamento (em negrito na 

tabela) corresponde ao ponto A = 0,5 e B = 0.5, usando regularização por volume (VOL).

d) Campo de Namorado Modificado:

Nesta  execução  do  modelo  Campo  de  Namorado  Modificado,  foram  utilizados  os 

parâmetros de controle numérico mostrados na Tabela 14.

O tempo de execução foi de 14,6 minutos, utilizando-se simulação por linhas de corrente, e 

de 1,9 minutos, utilizando-se o simulador comercial por diferenças finitas em esquema de solução 

totalmente implícito.

161



Figura  7.35:  Análise  de  sensibilidade  da  qualidade  e  do 
tempo de execução em relação aos parâmetros A e B.

162

10 12 14 16 18 20 22 24 26 28 30
94

95

96

97

98

99

100

 TOF
 VOL

Ín
di

ce
 d

e 
S

im
ila

ri
da

d
e 

IS
 (

%
) 

Tempo de Execução (min)

Tabela 13: Análise de Sensibilidade aos Parâmetros A e B e ao Tipo de 
Regularização de Linha de Corrente

Tempo de Execução 
(min)

IS
(%)

A B TOF VOL TOF VOL
0,5 0,0 12,18 12,19 95,23 95,54
1,0 0,0 15,03 14,03 95,78 96,59
3,0 0,0 25,58 27,36 96,47 96,83
0,5 0,5 15,13 13,92 96,25 96,84
1,0 0,5 15,66 13,83 96,75 96,26
3,0 0,5 24,66 25,67 96,35 96,71
0,5 1,0 15,32 13,82 95,74 95,03
1,0 1,0 14,49 14,64 96,49 96,63
3,0 1,0 25,65 24,48 96,17 96,52
0,5 3,0 15,02 15,34 95,99 96,20
1,0 3,0 15,86 16,01 96,19 96,28
3,0 3,0 26,04 24,99 96,01 96,08



A  Figura  7.36 mostra  a  comparação  da  distribuição  de  saturação  de  água  ao  final  da 

simulação. Observa, na profundidade do contato óleo-água, a tendência da simulação por linhas 

de corrente de criar maior dispersão que a simulação por diferenças finitas. A Figura 7.37 mostra 

a comparação de Grau API de óleo. A comparação de Grau API não se aplica abaixo do contato 

óleo água, uma vez que a saturação de óleo é nula nessa região. 

Tabela 14: Parâmetros Fixos de Controle Numérico 
Utilizados no Campo de Namorado Modificado

Parâmetro Valor
Tipo de Regularização VOL

Linhas na Fase 1 20.000
Linhas de Células “Fonte” 60

A 3,0
B 0,5
M 0,1

Linhas de Corrente Diferenças Finitas

Figura  7.36:  Comparação  entre  saturação  de  água  após  5.000  dias  de  produção  no 
Campo de Namorado Modificado.

163



Linhas de Corrente Diferenças Finitas

Figura  7.37:  Comparação  entre  Grau  API após  5.000 dias  de produção no Campo de 
Namorado Modificado.

A  Figura  7.38 mostra  comparações  de  curvas  de  produção  de  óleo  e  produção  total  de 

alguns dos poços existentes no campo. Apesar da diferença na dispersão de saturação de água, as 

curvas de produção total e de óleo são muito similares às obtidas por diferenças finitas na maioria 

dos poços do campo. Os gráficos de pressão média nas células injetoras, mostrados na  Figura

7.39, mostram concordância com a simulação por linhas de corrente, o que é explicado pelo fato 

de  a  maioria  das  células  injetoras  se  encontrar  abaixo  do  contato  óleo  água,  neutralizando 

possíveis diferenças de tratamento de transmissibilidades.

As curvas de volumes de óleo in situ e de produções acumuladas de óleo e de água, vistas 

na  Figura  7.40,  comprovam  que,  em  termos  de  reservatório,  os  resultados  são  praticamente 

coincidentes. 

As sensibilidades ao parâmetro  A de controle numérico, utilizado na  Equação  (203), e ao 

tipo de regularização de linha de corrente também foram analisadas com o modelo do Campo de 

Namorado Modificado.

164



0 1000 2000 3000 4000 5000
0

1000

2000

3000

4000

5000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 1000 2000 3000 4000 5000
0

1000

2000

3000

4000

5000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

NA-001                                                                                  NA-002

0 1000 2000 3000 4000 5000
0

100

200

300

400

500

600

700

800

900

1000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 1000 2000 3000 4000 5000
0

100

200

300

400

500

600

700

800

900

1000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

NA-003                                                                                  NA-007

0 1000 2000 3000 4000 5000
0

200

400

600

800

1000

1200

1400

1600

1800

2000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 1000 2000 3000 4000 5000
0

100

200

300

400

500

600

700

800

900

1000

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

NA-008                                                                                    NA-024

Figura  7.38:  Curvas  de  produção  de  óleo  e  produção  total  dos  poços  do  Campo  de 
Namorado Modificado

165



0 1000 2000 3000 4000 5000
20000

22000

24000

26000

28000

30000

32000

34000
 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)
0 1000 2000 3000 4000 5000

20000

22000

24000

26000

28000

30000

32000

34000
 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)

NA-006I                                                                            NA-009I

0 1000 2000 3000 4000 5000
20000

22000

24000

26000

28000

30000

32000

34000
 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)
0 1000 2000 3000 4000 5000

20000

22000

24000

26000

28000

30000

32000

34000
 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)

NA-018I                                                                           NA-0020I

0 1000 2000 3000 4000 5000
20000
21000
22000
23000
24000
25000
26000
27000
28000
29000
30000
31000
32000
33000
34000
35000

 Pcel LC
 Pcel DF

P
re

ss
ão

 (
kP

a)

Tempo (dias)
0 1000 2000 3000 4000 5000

20000

22000

24000

26000

28000

30000

32000

34000
 Pcel LC
 Pcel DF

P
re

ss
ão

 (k
P

a)

Tempo (dias)

NA-023I                                                                            NA-024I

Figura 7.39: Curvas de  pressão na célula em poços do Campo de Namorado Modificado.

166



0 1000 2000 3000 4000 5000
0

5

10

15

20

25

30

35

40

 

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS LC
 VOIS DF

Tempo (dias)

V
o

lu
m

e 
P

ro
d

u
zi

d
o

 (
106

 m
3 )

170

175

180

185

190

195

200

205

210

V
o

lu
m

e 
In

 S
it

u 
(1

06
 m

3 )

Figura  7.40:  Curvas  de produções  acumuladas  de  óleo  e 
água (Np e Wp) e Volume de Óleo  In Situ do Campo de 
Namorado Modificado.

No Campo de Namorado Modificado, a qualidade da solução foi quantificada em termos de 

similaridade com a solução por diferenças finitas, através de um indicador de similaridade  IS, 

definido por: 

IS = 1 ?
?Npcampo

DF ? Npcampo
LC ???Wpcampo

DF ?Wpcampo
LC ?

Np campo
DF ?Wp campo

DF ,  (286)

onde  DF significa  resultado  da  simulação  por  diferenças  finitas  e  LC significa  resultado  da 

simulação  por  linhas  de  corrente.  Visando  diminuir  o  tempo  despendido  nas  análises  de 

sensibilidade, foi considerado um tempo simulado de apenas 3.000 dias.

Empregou-se o esquema “gatilho” de controle de passo de tempo de pressão, com máximo 

passo de tempo de 200 dias. Os parâmetros numéricos mantidos fixos na análise de sensibilidade 

são mostrados na Tabela 15.

167



Tabela 15: Parâmetros Fixos de Controle Numérico 
Utilizados na Análise de Sensibilidade ao Parâmetro 

A
Parâmetro Valor

Tipo de Regularização -
Linhas na Fase 1 20.000

Linhas de Células “Fonte” 60
A -
B 0,5
M 0,1

A Tabela 16 e a Figura 7.41 apresentam os resultados da análise de sensibilidade. Observa-

se nessa tabela que a qualidade da solução é mais sensível ao parâmetro  A  de regularização da 

linha de corrente, que no Caso Gradual Heterogêneo, e que a qualidade do resultado é, em todos 

os casos, consideravelmente melhor para regularização com base em volume de linha de corrente 

(VOL). 

168

Tabela 16: Análise de Sensibilidade ao Parâmetro A e ao Tipo de 
Regularização no Modelo Campo de Namorado Modificado

Parâmetro A Tempo de Execução
(min)

IS
(%)

TOF VOL TOF VOL
0,5 10,92 10,60 79,64 83,68
1,0 11,86 11,06 89,04 92,51
3,0 15,95 14,08 96,51 99,48



Figura  7.41:  Análise  de  sensibilidade  da  qualidade  e  do 
tempo de execução em relação aos parâmetros  A (Campo 
de Namorado Modificado)

Uma vez que no primeiro mês de produção não existe injeção (Tabela 4), a solução é muito 

dependente da existência de células “fonte”. Por esta razão, o caso foi tomado para análise do 

número de linhas de corrente a serem lançadas das células fonte. A Tabela 17 e a  Figura 7.42 

mostram os resultados obtidos. Observa-se que o melhor Índice de Similaridade ocorre quando 

são usadas 30 linhas de corrente por célula “fonte”, com regularização por tempo de vôo, e 36, 

com regularização por volume. Observa-se também que, para qualquer quantidade de linhas de 

corrente lançadas das células “fonte”, a regularização por volume propicia sempre maior Índice 

de Similaridade e menor tempo de execução.

169

10 11 12 13 14 15 16 17 18 19 20
70

75

80

85

90

95

100

 TOF
 VOL

Ín
di

ce
 d

e 
S

im
ila

ri
da

d
e 

IS
 (

%
) 

Tempo de Execução (min)



Figura  7.42:  Análise  de  sensibilidade  da  qualidade  e  do 
tempo  de  execução  em  relação  ao  número  de  linhas  de 
corrente lançadas de células “fonte”.

e) Caso Comparativo SPE10 Modificado:

Os parâmetros de controle numérico utilizados na simulação por linhas de corrente neste 

caso  são  apresentados  na  Tabela  18.   Alguns  testes  iniciais  mostraram  que,  em  termos  de 

comparação com simulação por diferenças finitas, pode-se obter bons resultados neste modelo 

170

10 11 12 13 14 15 16 17 18 19 20
90

91

92

93

94

95

96

97

98

99

100

 TOF
 VOL

Ín
di

ce
 d

e 
S

im
ila

ri
da

d
e 

IS
 (

%
) 

Tempo de Execução (min)

Tabela 17: Análise de Sensibilidade ao Número de Linhas de Corrente 
Lançadas de Células “Fonte” e ao Tipo de Regularização no Modelo 

Campo de Namorado Modificado
Linhas de Corrente 
de Células “Fonte”

Tempo de Execução
(min)

IS
(%)

TOF VOL TOF VOL
6 13,37 11,47 96,28 99,12
12 13,39 11,96 95,89 99,37
30 14,74 12,45 96,4 99,67
36 14,63 12,82 95,83 99,76
42 14,92 12,95 95,75 99,66
48 15,15 13,83 96,08 99,27
60 15,95 14,08 96,51 99,48



com parâmetro A igual a 0,5.

Tabela  18: Parâmetros Fixos de Controle Numérico 
Utilizados no Caso Comparativo SPE10 Modificado.

Parâmetro Valor
Tipo de Regularização TOF

Linhas na Fase 1 200.000
Linhas de Células “Fonte” 12

A 0,5
B 0,5
M 0,1

O tempo de execução da simulação por linhas de corrente, com os parâmetros de controle 

numérico apresentados na Tabela 18, foi de 10 horas e 46 minutos (646 minutos). Nesta mesma 

máquina,  a  execução  com  o  simulador  comercial  por  diferenças  finitas  em  esquema  IMPES 

dispendeu 72 horas e 16 minutos (4.336 minutos). A execução em diferenças finitas com esquema 

totalmente implícito foi interrompida e abandonada sem conclusão após 120 horas de execução.

As  distribuições  finais  de  saturação  de  água,  obtidas  com  as  simulações  por  linhas  de 

corrente e por diferenças finitas, são mostradas na Figura 7.43. Observa-se que, apesar do baixo 

valor do parâmetro A utilizado (0,5), não se observa, visualmente, uma diferença significativa no 

nível de dispersão entre os dois tipos de simulação. Isso é explicado pelo alto grau de refinamento 

da  malha  de  simulação  (células  de  6 x 3 x 1 m).  A  Figura  7.44 mostra  a  semelhança  entre  as 

distribuições finais de Grau API, obtidas com os dois tipos de simulação.

171



Linhas de Corrente Diferenças Finitas

Figura 7.43: Comparação entre saturação de água após 3.000 dias de produção no Caso 
Comparativo SPE10 Modificado.

Linhas de Corrente Diferenças Finitas

Figura 7.44: Comparação entre Grau API de óleo após 3.000 dias de produção no Caso 
Comparativo SPE10 Modificado.

Na Figura 7.45 e na Figura 7.46 são apresentadas comparações entre as curvas de produção 

de  óleo  e  produção  total  e  comparação  das  curvas  de  pressão  médias  nas  células  dos  poços 

injetores.  As  curvas  de  volume  de  óleo  in  situ e  volumes  produzidos  de  óleo  e  de  água  são 

172



apresentadas na Figura 7.47.

Com  o  objetivo  de  analisar  o  impacto  da  alteração  dos  parâmetros  numéricos,  visando 

reduzir  o  nível  de  dispersão,  foi  executada  uma  nova  rodada  com  o  parâmetro  A =  1,5  e 

regularização de linha de corrente por volume (Tabela 19). Neste caso, o tempo de execução se 

elevou para 34,0 horas, ainda inferior às  72 horas e 16 minutos, necessárias para execução por 

diferenças finitas. A distribuição de saturação de água deste caso é comparada com a distribuição 

do simulador comercial na  Figura 7.48. Apesar da redução do nível de dispersão, os resultados 

em termos de curvas de produção e pressão de injeção são praticamente os mesmos obtidos com 

os parâmetros da Tabela 18.

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

350

400

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

350

400
V

az
ão

 (
m

3 /d
)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD1                                                                             PROD2

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

350

400

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

0 500 1000 1500 2000 2500 3000
0

50

100

150

200

250

300

350

400

V
az

ão
 (

m
3 /d

)

Tempo (dias)

 Qoleo LC
 Qliq  LC
 Qoleo DF
 Qliq  DF

PROD3                                                  PROD4

Figura  7.45: Curvas de produção de óleo e produção total dos poços do Caso Gradual 
Comparativo SPE10 Modificado.

173



0 500 1000 1500 2000 2500 3000
0.0

0.5

1.0

1.5

2.0

2.5

3.0

V
o

lu
m

e 
(1

06
 m

3 )

Tempo (dias)

 Np LC
 Wp LC
 Np DF
 Wp DF
 VOIS DF
 VOIS LC

Figura  7.47:  Curvas  de  produções  acumuladas  de  óleo  e 
água  (Np  e  Wp)  e  Volume  de  Óleo  In  Situ do  Caso 
Comparativo SPE10 Modificado.

174

0 500 1000 1500 2000 2500 3000
30000

32000

34000

36000

38000

40000

42000

44000
 Pcel LC
 Pcel DF

P
re

s
s
ã

o
 (

k
P

a
)

Tempo (dias)

INJE1

Figura  7.46: Curvas de pressão média nas células do poço 
injetor do Caso SPE10 Modificado.



Tabela  19:  Parâmetros  de  Controle  Numérico 
Utilizados no Caso Comparativo SPE10 Modificado.

Parâmetro Valor
Tipo de Regularização VOL

Linhas na Fase 1 200.000
Linhas de Células “Fonte” 12

A 1,5
B 0,5
M 0,1

Linhas de Corrente Diferenças Finitas

Figura 7.48: Comparação entre saturação de água após 3000 dias de produção no Caso 
Comparativo  SPE10  Modificado,  utilizando-se  A =  1,5  e  regularização  com  base  em 
volume de linha de corrente.

Comparações com Diferentes Compressibilidades:

Com o objetivo de comparar os resultados e os desempenhos dos simuladores, quando as 

compressibilidades são diferentes, utilizou-se modelos derivados do Caso Gradual Heterogêneo 

Compressível.

175



Além  das  compressibilidades  originais  do  Caso  Gradual  Heterogêneo  Compressível, 

referenciado  aqui  como  “Compressível”,  foi  simulado  um  caso  onde  os  valores  das 

compressibilidades  são  a  metade  das  compressibilidades  originais,  referenciado  aqui  como 

“Semi-compressível”, e outro, onde as compressibilidades originais foram divididas por 1.000 e 

referenciado aqui como “Incompressível” (Tabela 20).

Tabela 20: Casos Definidos para Análise de Efeito de Compressibilidade
(Caso Gradual Heterogêneo Compressível)

Caso

Compressibili-
dade de
Poros
(kPa)-1

Compressibili-
dade de
Água
(kPa)-1

Compressibili-
dade de

Óleo Leve
(kPa)-1

Compressibili-
dade de

Óleo Pesado
(kPa)-1

Compressível 1,00x10-6 0,40x10-6 0,80x10-6 0,60x10-6
Semi-compressível 0,50x10-6 0,20x10-6 0,40x10-6 0,30x10-6

Incompressível 1,00x10-9 0,40x10-9 0,80x10-9 0,60x10-9

A Tabela 21 mostra os tempos de processamento. Devido a problemas numéricos, não foi 

possível a execução do caso “Incompressível” no simulador por diferenças finitas. Observa-se 

que ao se dividir a compressibilidade por dois, o tempo de processamento por linha de corrente 

teve  um  acréscimo  correspondente  a  11%,  enquanto  que  o  tempo  de  processamento  por 

diferenças finitas sofreu um acréscimo de 44%.

176

Tabela 21: Tempos de Execução na Análise de Efeito da Compressibilidade 
(Caso Gradual Heterogêneo Compressível)

Caso Linhas de Corrente
(min)

Diferenças Finitas
(min)

Compressível 21,0 25,8
Semi-compressível 23,4 31,5

Incompressível 20,4 -



A  Figura  7.49 mostra  curvas  de  vazões  de  óleo  do  modelo  nos  primeiros  500  dias  de 

produção,  que  é  o  período  onde  predominam  as  diferenças  entre  as  compressibilidades.  Para 

melhor  comparação,  as  vazões  apresentadas  nessa  figura  representam  médias  dos  passos  de 

tempo  reportados. Nessa  figura,  também são  mostradas  as  curvas  de  produção  obtidas  com  o 

simulador por diferenças finitas para os casos “Compressível” e “Semi-compressível”.

0 100 200 300 400 500
0

100

200

300

400

500

 Qo Incomp. LC
 Qo Semi. LC
 Qo Comp. LC
 Qo Semi. DF
 Qo Comp. DF

V
a
zã

o
 d

e
 Ó

le
o

 (
m3 /
d

)

Tempo (dias)

Figura  7.49: Comparação entre curvas  de produção de óleo do Caso 
SPE10 Modificado com diferentes compressibilidades. 

As curvas de produções acumuladas de óleo, para os três níveis de compressibilidade, são 

mostradas na Figura 7.50. Uma vez que os primeiros anos de produção são os que possuem maior 

peso nas análises econômicas, conclui-se, da Figura 7.49  e da Figura 7.50, que a consideração da 

compressibilidade é vital para a correta avaliação de alternativas de produção em um reservatório 

de petróleo.

177



0 100 200 300 400 500
0

50

100

150

200

250

300

 Qo Incomp. LC
 Qo Semi. LC
 Qo Comp. LC
 Qo Semi. DF
 Qo Comp. DF

P
ro

d
u

çã
o

 A
cu

m
u

la
d

a 
d

e 
Ó

le
o

 (
103

 m
3 )

Tempo (dias)

Figura  7.50: Comparação entre curvas  de produção de óleo do Caso 
SPE10 Modificado com diferentes compressibilidades. 

.

Comparação Entre Tempos de Processamento

A  Tabela  22 apresenta  um  resumo  dos  tempos  de  processamento  dos  casos  mais 

importantes estudados. Essa comparação foi feita com o único objetivo de se avaliar o potencial 

do  método  de  simulação  por  linhas  de  corrente  como  uma  opção  rápida  à  simulação 

convencional.  Deve-se  ter  em  mente  que  esses  tempos  dependem  muito  dos  parâmetros 

numéricos a serem considerados, tanto na simulação por linhas de corrente, como na simulação 

por diferenças finitas, e não podem, portanto, ser tomados como base definitiva para comparação 

de velocidade de processamento entre os dois processos.

Nos  dois  casos  incompressíveis,  não  existe  diferença  significativa  entre  os  tempos  de 

processamento por linhas de corrente ou por diferenças finitas.

Na caso baseado no Campo de Namorado, a diferença de tempo foi bastante favorável à 

simulação por diferenças finitas, o que se explica pela consideração de um cronograma de entrada 

de poços  que impede  a  utilização de grandes  intervalos  de tempo  na simulação por linhas  de 

corrente.

178



Tabela 22: Comparação Entre Tempos de Processamento
Caso Células 

Ativas
Processador Diferenças 

Finitas 
(IMPES)

Diferenças 
Finitas 

(EXPLÍCITO)

Linhas 
de 

Corrente
Degrau 

Incompressível
93500 Duo 3 GHz - 48 min 46 min

Gradual 
Incompressível

93500 Duo 3 GHz - 49 min 42 min

Campo de 
Namorado 
Modificado

43323 AMD 2 GHz - 2 min 15 min

Caso 
Comparativo 

SPE10

1122000 AMD 2 GHz 72,3 h &gt; 120 h 10,8 h

Gradual 
Heterogêneo 
Compressível

93500 AMD 2 GHz 26 min 95 min 21 min

Gradual 
Heterogêneo 

Semi-
Compressível

93500 AMD 2 GHz 32 min - 23 min

Gradual 
Heterogêneo 

Incompressível

93500 AMD 2 GHz Sem 
convergência

- 20 min

O caso baseado no Caso Comparativo SPE 10 mostrou grande vantagem da simulação por 

linhas de corrente. O tempo de processamento da simulação por diferenças finitas foi superior a 7 

vezes o tempo obtido por linhas de corrente, mesmo utilizando-se formulação IMPES.

Na  comparação  entre  diferentes  compressibilidades,  observa-se  que  a  redução  das 

compressibilidades  pela  metade  fez  com  que  o  tempo  de  simulação  por  diferenças  finitas  se 

elevasse em 6 minutos, enquanto o tempo simulação por linhas de corrente se elevasse apenas 

dois  minutos.  Não  se  conseguiu  convergência  na  simulação  por  diferenças  finitas,  quando  as 

compressibilidades foram divididas por 1000.

179



Capítulo 8    

Conclusões e Recomendações

Foi  implementada  uma  formulação  para  tratar  o  problema  de  variação  espacial  das 

propriedades   iniciais  do óleo  em um código de simulação  por linhas  de  corrente  em sistema 

incompressível.  Em  seguida,  com  base  no  código  para  sistema  incompressível,  um  novo 

programa foi desenvolvido, o qual, além de tratar o problema de variação das propriedades do 

óleo, inclui a formulação para sistemas compressíveis, proposta por Blunt (2008).

Os  objetivos  propostos  para  o  trabalho  foram  atingidos,  obtendo-se  programas  que 

reproduzem os resultados de um simulador comercial, validando as formulações teóricas e suas 

implementações.

A  seguir  são  apresentadas  as  principais  conclusões  e  recomendações  para  futuros 

desenvolvimentos.

8.1 Conclusões

As conclusões estão divididas em específicas para sistema incompressível, específicas para 

sistema compressível e conclusões gerais.

Sistema Incompressível:

A formulação tradicional para simulação por linhas de corrente em sistema incompressível 

180



foi  estendida,  de  forma  bastante  simples,  para  considerar  óleo  com  propriedades  variáveis, 

utilizando dois componentes na fase oléica.

Foi observada na validação do programa uma pequena dispersão na saturação de água nas 

proximidades  dos  poços  injetores. Essa  dispersão é explicada  pela  alta  velocidade dos  fluidos 

nessa  região,  o  que  faz  com  que  várias  células  sejam  agrupadas  em  um  único  segmento 

regularizado de linha de corrente.

A distribuição de Grau API de óleo obtida com o programa, após um período significativo 

de produção, reproduz os resultados de um simulador comercial com a opção API Tracking.

Os tempos de execução de um modelo com 93.500 células foram praticamente iguais na 

simulação por linhas de corrente e na simulação por diferenças finitas.

Sistemas Compressíveis:

A formulação  que utiliza  a solução  convectiva desenvolvida em termos  de concentração 

mássica  se  mostrou  adequada  para  simulação  em  sistema  compressível,  onde  os  volumes  são 

dependentes da pressão. 

Na solução da pressão, foram assumidas duas hipóteses simplificadoras no tratamento das 

transmissibilidades: transmissibilidades definidas no início do passo e transmissibilidades entre 

células  baseadas  em  médias  harmônicas.  Essas  simplificações  não  impediram  a  validação  da 

formulação que foi proposta para simulação por linha de corrente com compressibilidade.

A  restrição  da  solução  das  linhas  de  corrente  somente  às  posições  onde  existe  fluxo 

significativo, é uma estratégia aplicável para a prevenção de problemas numéricos e redução de 

processamento desnecessário.

Na  implementação  desenvolvida  para  simulação  com  compressibilidade,  podem  existir 

células  de  poços  produtores  que  não  recebem  todas  linhas  de  corrente  que,  teoricamente, 

181



deveriam receber. Nesses casos, a soma das vazões das linhas de corrente é inferior à vazão total 

do poço, calculada na solução da pressão. Foi utilizado, nesses casos, um tratamento numérico 

especial, baseado em balanço de massa, o qual se mostrou satisfatório.

A utilização do conceito de erro de soma de saturações na solução da pressão melhora a 

estabilidade do problema. Utilizando-se esse conceito, observou-se que em modelos homogêneos, 

o máximo erro de soma de saturações é estável, enquanto que, em modelos heterogêneos, tende a 

ser crescente, podendo comprometer a solução.

Duas  estratégias  de  controle  de  passo  de  tempo  de  pressão  foram  implementadas  no 

programa.  A estratégia  “alvo”  só  é  eficiente  quando  o  máximo  erro  de  saturação  é  estável. 

Conseguiu-se,  no  entanto,  contornar  o  problema  de  crescimento  do  máximo  erro  de  soma  de 

saturações, utilizando-se a estratégia “gatilho” de controle de passo de tempo, onde a simulação 

se dá por passos de tempo constantes, até que um limite de erro máximo seja atingido. Quando 

isso ocorre, um passo com intervalo de tempo suficientemente pequeno é executado. Essa ação 

tem  o  efeito  de  reduzir  consideravelmente  o  erro  máximo,  permitindo  o  prosseguimento  da 

simulação.  No programa,  o passo  de  tempo  para  redução  do erro é  igual  ao  menor  tempo  de 

cruzamento  das  células  do  modelo,  multiplicado  por  um  parâmetro  M,  o  qual  deve  ser 

especificado. Testes mostraram que valores de M na faixa de 0,05 e 0,1 são adequados à maioria 

dos casos. Entende-se que uma estratégia, onde não ocorram grandes contrastes de intervalos de 

tempos em passos subseqüentes, poderia ser mais eficiente que a estratégia “gatilho” adotada.

A  implementação  pode  ser  estendida  a  um  número  maior  de  fases  e  componentes. 

Entretanto,  não se pode afirmar, sem que testes  sejam realizados,  que essa  extensão seja bem 

sucedida, principalmente quando a fase gás estiver presente.

Problemas de dispersão provocados pelo processo de regularização das linhas de corrente 

merecem estudos adicionais. A redução do volume dos segmentos regularizados pode diminuir a 

dispersão. Entretanto, pela natureza explícita do método de solução unidimensional nas linhas de 

corrente, essa redução acarreta um aumento considerável no número de iterações e no tempo de 

182



processamento.  A  utilização  de  um  método  implícito  de  solução  unidimensional,  mesmo 

demandando mais memória, pode ser uma opção a ser considerada.

A seguir  são  apresentadas  conclusões  obtidas  ao  se  analisar  os  casos  de  validação  da 

formulação para compressibilidade:

Caso Degrau Homogêneo Compressível:

? São observadas, no início da simulação, diferenças importantes nos mapas de saturação de 

água  nas  proximidades  dos  poços  injetores,  com  grande  dispersão  e  assimetria  na 

simulação  por  linhas  de  corrente.  A dispersão  é  explicada  pelo  fato  de  os  segmentos 

regularizados  das  linhas  de corrente abrangerem diversas  células  nas  proximidades  dos 

poços injetores.

? Também  ficam  claros  os  efeitos  de  orientação  de  malha  na  simulação  por  diferenças 

finitas.

? Foi  mostrado,  neste  caso,  que  a  dispersão  próxima  aos  poços  injetores  pode  alterar 

substancialmente  as  pressões  de  injeção.  Em  um  caso  em  que  os  poços  fossem 

controlados por pressão de fundo, esse fenômeno alteraria a vazão injetada.

? Neste caso, assim como na maioria dos casos estudados, a irrupção de água na simulação 

por linhas  de  corrente  ocorre após  a irrupção na simulação  por diferenças  finitas. Não 

foram  determinadas  as  causas  para  esse  resultado,  entretanto  o efeito  de  orientação  de 

malha, inerente à simulação por diferenças finitas, não está descartado.

? A irrupção de água nos poços produtores provoca, neste modelo, redução do índice de 

produtividade  e  conseqüente  aumento  de  pressão  em  todo  o  reservatório.  Por  isso,  a 

diferença nos tempos de irrupção com os dois tipos de simulação se reflete nas curvas de 

pressão dos poços injetores.

Caso Gradual Homogêneo Compressível:

? Este caso comprovou que o deslocamento de óleo de menor viscosidade para uma região 

do reservatório  com  óleo  de  viscosidade  maior  pode  elevar  a  produtividade  dos  poços 

dessa região. Conclui-se que o oposto também ocorre, quando óleo de maior viscosidade 

183



migra para uma região de viscosidade menor.

Caso Gradual Heterogêneo Compressível:

? A  utilização  do  parâmetro  A,  que  controla  o  refinamento  das  linhas  de  corrente 

regularizadas, igual a 0,5 permitiu a simulação por linhas de corrente em menor tempo 

que o simulador comercial. Embora a reprodução das curvas de produção e pressão de 

injeção  tenha  sido  aceitável,  os  mapas  de  saturação  de  água  mostraram  dispersão 

consideravelmente maior. Conclui-se que, em termos de análises de curvas de produção, 

podem  existir  situações  onde  seja  vantajoso  ter  uma  velocidade  maior  de  simulação 

utilizando linhas de corrente, ao custo de maior dispersão de saturação.

? A pressão de injeção na simulação por linhas de corrente foi, de modo geral, inferior à 

pressão na simulação por diferenças finitas. Essa diferença não se deve à dispersão,  pois 

manteve-se significativa em uma nova simulação onde os parâmetros foram alterados para 

se obter menor dispersão. Aparentemente, essa diferença está associada com  a diferença 

nos tempos de irrupção de água, afetando a produtividade dos poços produtores e, como 

conseqüência, a pressão em todo o modelo.

? A análise de sensibilidade ao parâmetro  M, que controla o passo de tempo para redução 

do erro máximo de soma de saturações, mostrou, neste caso, que valores inferiores a 0,02 

prejudicam o tempo de execução e a qualidade de resposta. Por outro lado, valores de M 

superiores a 0,3 fazem com que o processo de redução de erro deixe de ser efetivo. 

? Como primeiro teste de um novo modelo, recomenda-se, a partir dos resultados de análise 

de  sensibilidade,  utilizar  um  número  de  linhas  de  corrente  da  Fase  1  igual  a, 

aproximadamente, 2% do número de células ativas.

? A  diferença  entre  tempos  de  processamento  obtidos  com  regularização  de  linhas  de 

corrente por tempo de vôo ou por volume, mantendo-se constantes os demais parâmetros, 

não é substancial neste caso.

? Em  83%  das  análises  realizadas,  a  reprodução  dos  resultados  obtidos  por  diferenças 

finitas foi melhor quando se utilizou regularização por volume.

? Como era esperado, o tempo de execução das simulações  aumenta, quando o valor do 

parâmetro A é elevado.

184



? Em termos do compromisso entre tempo de execução e qualidade de resposta, a melhor 

opção de controle numérico foi a utilização do valor de 0,5, tanto para o parâmetro  A, que 

é o multiplicador usado para definição do número de segmentos da linha regularizada, 

quanto para o parâmetros B, que faz com que haja refinamento adicional em linhas de 

corrente onde existe maior compressibilidade. O melhor método de regularização foi a 

regularização por volume (VOL). 

? A utilização de valores superiores a 0,5 para o parâmetro B não apresenta vantagens.

Campo de Namorado Modificado:

? Pelo fato de os poços injetores estarem completados primordialmente abaixo do contato 

óleo-água, onde não existem efeitos de dispersão, as diferenças entre pressões de injeção 

obtidas com os dois tipos de simulação foram pequenas.

? Observou-se, neste modelo, que a qualidade das soluções é mais sensível ao parâmetro A 

e ao tipo de regularização, que no modelo Gradual Heterogêneo Compressível. Pode-se 

concluir  que  a maior  sensibilidade  se deve à existência de um contato óleo-água,  cuja 

elevação é melhor representada quando o nível de discretização é maior.

? O  número  de  linhas  a  serem  lançadas  de  células  fonte  tem  pouca  influência  nos 

resultados. Observou-se que 30 linhas é um valor adequado para este parâmetro.

? Foi comprovada a possibilidade da simulação por linhas de corrente sem nenhuma injeção 

de água, usando-se uma formulação para compressibilidade consistente.

Caso Comparativo SPE10 Modificado:

? Como  se  observara  anteriormente  em  outros  estudos  [Maschio  e  Schiozer  (2002)],  a 

vantagem da simulação por linhas de corrente se acentua quando se trabalha com casos 

maiores e mais heterogêneos. Neste caso, com 1,122 milhões de células, a simulação por 

linhas de corrente teve um tempo de execução de aproximadamente 11 horas, utilizando-

se parâmetro  A = 0,5, e 34 horas, utilizando-se  A = 1,5, enquanto o simulador comercial 

por diferenças finitas teve um tempo de processamento de mais de 72 horas.

? Este caso mostrou que, quando a malha de simulação tem um alto nível de refinamento, as 

linhas  de  corrente  podem  ter  segmentos  regularizados  englobando  diversas  células  de 

185



simulação, sem perda de qualidade na representação do campo de saturações. Por essa 

razão a utilização do parâmetro  A = 0,5 foi, neste caso, suficiente para obtenção de bons 

resultados. A elevação de A para 1,5 com regularização por volume, alterou muito pouco 

as distribuições finais de saturação e, praticamente, não alterou as respostas de produção e 

pressão.

Comparação entre Diferentes Compressibilidades:

? Ao se dividir as compressibilidades à metade, o tempo de execução por diferenças finitas 

se elevou em 45%, enquanto o tempo por linhas de corrente teve um acréscimo de 11%. 

Esse  resultado  indica  que   a  relação  entre  velocidades  de  simulação  se  torna  mais 

favorável aos simuladores por linhas de corrente, quando o sistema a ser representado é 

menos compressível.

? A alteração da compressibilidade afetou sensivelmente os primeiros 500 dias de produção.

? Nos  primeiros  seis  meses,  o  modelo  com compressibilidade  reduzida  à  metade  mostra 

uma produção acumulada de óleo 18% superior ao modelo original, enquanto o modelo 

sem compressibilidade mostra uma produção acumulada de óleo 33% superior ao modelo 

original. Essas  diferenças  podem afetar bastante  uma  análise  econômica  onde modelos 

incompressíveis sejam adotados.

Conclusões Gerais:

A Revisão Bibliográfica e o Anexo 3 comprovam que a variação das propriedades iniciais 

do óleo com a profundidade e com a posição no reservatório é uma característica importante, que 

necessita  ser  levada  em  conta  nos  estudos  de  reservatórios.  Não  foi  encontrada  nenhuma 

referência prévia a implementação dessa opção em simuladores por linhas de corrente.

Devido  à  simplicidade  da  solução  numérica  unidimensional,  a  implementação  de  outros 

modelos  de  sistemas  rocha-fluido  se  torna  consideravelmente  mais  fácil  em  simuladores  por 

linhas de corrente.

Como  não  existe  dependência  entre  as  linhas  de  corrente,  este  tipo  de  simulação  é  um 

186



candidato natural ao processamento paralelo. Nas Fases 1 e 2 de lançamento, os poços injetores  e 

as  células  “fonte”  poderiam  ser  distribuídos  entre  os  diferentes  processadores,  aumentando-se 

assim a velocidade da simulação. Na fase 3, poder-se-iam criar  estratégias de pesquisa de células 

“perdidas” específicas para diferentes regiões do modelo e atribuir cada região a um processador.

Devido ao processo de mapeamento de resultados entre as linhas de corrente e a malha de 

simulação, existe, tanto no caso incompressível, como no caso compressível, a necessidade de 

correção do tempo acumulado, para ajuste do balanço global de massa.

A simulação por linhas de corrente é hoje uma opção muito interessante, quando respostas 

rápidas sobre o reservatório são necessárias. Novos desenvolvimentos podem fazer com que esse 

tipo de simulação venha a ser, em alguns reservatórios, a principal ferramenta de estudo.

Os  resultados  que  foram  obtidos  comprovam  que  a  implementação  do  tratamento  de 

variação nas propriedades do óleo em simuladores por linha de corrente é possível e adiciona 

uma opção útil a este tipo de simulação.

Os  casos  de  validação  estudados  comprovam  que  a  formulação  proposta  para 

compressibilidade é válida e que a simulação por linhas de corrente em sistemas compressíveis é 

uma opção viável. 

Em  modelos  de  milhões  de  células,  a  simulação  por  linhas  de  corrente  em  sistema 

compressível pode ser mais rápida que a simulação por diferenças finitas, mesmo quando essa 

comparação é feita com programas comerciais testados e otimizados, por muitos anos.

8.2 Recomendações

Em  vista  dos  testes  realizados,  sugere-se  utilizar  os  parâmetros  de  controle  numérico 

mostrados na Tabela 23 na simulação inicial de um novo modelo. Em seguida, testes devem ser 

187



feitos, procurando-se otimizar esses parâmetros para o modelo específico. Sugere-se, na presente 

implementação, utilizar a estratégia “gatilho” de controle de passo de tempo de pressão, com erro 

máximo de soma de saturações de 10%. Os passos de tempo iniciais e máximos dependem do 

problema a ser resolvido.

Tabela 23: Parâmetros de Controle Numérico 
Sugeridos para Novos Modelos

Parâmetro Valor
Tipo de Regularização VOL

Linhas na Fase 1 20% do número 
de células ativas

Linhas de Células “Fonte” 30
A 1,0
B 0,5
M 0,05

Os seguintes desenvolvimentos adicionais são sugeridos para futuras implementações:

? Busca de soluções para o problema de dispersão nas regiões de alta velocidade de fluidos, 

incluindo outras formas de regularização de linhas de corrente.

? Estudo de outras possibilidades de solução numérica unidimensional, como TVD (total  

variation diminishing) e solução implícita.

? Aperfeiçoamento  do  critério  de  controle  de  passo  de  tempo  da  solução  de  pressão, 

evitando-se contraste entre intervalos de tempo de passos subseqüentes e prevendo, em 

determinadas situações, a repetição de passos para redução, do máximo erro de soma de 

saturações.

? Consideração da razão de solubilidade dos componentes do óleo, permitindo previsão de 

razão  gás-óleo  ao  longo  do  tempo,  em  função  do  Grau  API  do  óleo  produzido.  Essa 

implementação seria imediata nos códigos atuais.

? Aumento do número de fases e de componentes.

? Consideração de transferência de massa entre as fases.

188



? Consideração da variação de volume da mistura em função da sua composição.

? Utilização de malhas do tipo corner point.

? Implementação de restrição simultânea de vazão e pressão para a operação dos poços.

? Opção que permita a simulação sem a definição de nenhum poço injetor.

? Extensão  do  programa  para  sistemas  compressíveis  para  simulação  de  injeção  e 

armazenamento de dióxido de carbono, com base nas propostas de  Obi e Blunt, 2006 e 

Qi et al, 2007.

? Análises de sensibilidade ao critério utilizado para  interrupção das linhas de corrente nas 

posições onde ocorre baixíssima vazão.

Além das sugestões anteriores, os seguintes pontos são muito importantes e merecem ser 

estudados com mais profundidade:

? crescimento do máximo erro de soma de saturações nos modelos heterogêneos;

? critérios de tratamento das transmissibilidades entre células;

? aproximações das transmissibilidades no tempo;

? razão para as diferenças entre o avanço da saturação de água nos simuladores por linhas de 

corrente e nos simuladores por diferenças finitas;

? implementação de processamento paralelo na solução das linhas de corrente.

? possibilidade  de  utilização  de  fluxo  fracionário  como  função  direta  das  concentrações 

mássicas, sem necessidade de determinação das saturações, o que poderia trazer redução de 

tempo de processamento.

189



Referências Bibliográficas

1. ANDRIANOV,  N.;  BRATVEDT,  K.  Acceleration  of  Streamline  Simulation  Using 

Adaptive  Mesh  Refinement  Along  Streamlines.  In:  2007  SPE  RESERVOIR 

SIMULATION SYMPOSIUM , 2, 2007, Houston, Texas, USA. SPE 106181.

2. AVRAHAM,  H.  Role  of  Asphaltenes  in  Compositional  Grading  of  a  Reservoir's  Fluid 

Column. Journal of Petroleum Technology, v. 40, n. 1, 1, 1988. SPE 13171.

3. AZIZ, K.; SETTARI, A. Petroleum Reservoir Simulation. Essex, UK: Applied Science 

Publishers, 1979, 476p.

4. BAKER,  R.  et  al.  Full-Field  Modeling  Using  Streamline-Based  Simulation:  4  Case 

Studies.  SPE Reservoir Evaluation &amp;amp; Engineering, v. 5, n. 2, p. 126-134, abril 2002. 

(Originalmente  In:  2001  SPE  RESERVOIR  SIMULATION  SYMPOSIUM,  2,  2001, 

Houston, Texas, USA. SPE 66405).

5. BATYCKY, R. P.; BLUNT, M. J.; THIELE, M. R. A 3D Field Scale Streamline Simulator 

With  Gravity  and  Changing  Well  Conditions.  In:  1996 ANNUAL  TECHNICAL 

CONFERENCE AND EXIBITION, 10, 1996, Denver, Colorado, USA. SPE 36726.

6. BATYCKY, R. P. A Three-Dimensional Two-Phase Field Scale Streamline Simulator. 

Stanford: Dept. of Petroleum Engineering, Stanford University, 1997, 163 f. Tese (PhD)

7. BEHRENBRUCH, P. The  Significance  of Large Variations  in Oil Poperties  of the  Dai 

Hung Field, Vietnam.  In: ASIA PACIFIC OIL &amp;amp; GAS CONFERENCE, 3, 1995, Kuala 

Lumpu, Malaysia, SPE 29302.

8. BERALDO, V. T.  et al. Streamline Simulation with an API Tracking Option.  In: 2007 

SPE  EUROPEC/EAGE  ANNUAL  CONFERENCE  AND  EXHIBITION,  07,  2007, 

190



Londres, UK. SPE 107496.

9. BERENBLYUM, R. A. et al. Black Oil Streamline Simulator With Cappilary Effects. In: 

2003  SPE  ANNUAL  TECHNICAL  CONFERENCE  AND  EXIHIBITION,  10,  2003, 

Denver, Colorado, USA. SPE 84037.

10. BLUNT, M. J.  Streamline-Based Reservoir Simulation, London: Department of Earth 

Science and Engineering, Imperial College, London, UK, 2008. No prelo.

11. BRATVEDT,  F.;  GIMSE,  T.;  TEGNANDER,  C.  Streamline  Computations  for  Porous 

Media Flow Including Gravity.  Transport in Porous Media, v. 25, n. 1, p. 63-78, 10, 

1996.

12. CHENG,  H.;  OSAKO,  I.;  DATTA-GUPTA,  A.  A Rigorous  Compressible  Streamline 

Formulation for Two- and Three-Phase Black-Oil Simulation. In: 2005 SPE TECHNICAL 

CONFERENCE AND EXIHIBITION, 10, 2005, Dallas, Texas, USA. SPE 96866.

13. CHENG, H. et al. Compressible Streamline and Three-Phase History Matching. In: 2006 

SPE/DOE SYMPOSIUM ON IMPROVED OIL RECOVERY, 4, 2006, Tulsa, Oklahoma, 

USA. SPE 99465.

14. CHRISTIE, M. A. et al. Quantifying Prediction Uncertainty in Reservoir Modeling Using 

Streamline Simulation, In: 15th ASCE Engineering Mechanics Conference, 6, 2002, New 

York, NY, USA. 

15. CHRISTIE,  M.  A.;  BLUNT,  M.  L.  Tenth  SPE  Comparative  Solution  Project:  A 

Comparison of Upscaling Techniques, SPE Reservoir Evaluation &amp;amp; Engineering, v. 4, 

n. 4, p. 308-317, agosto 2001.

16. CMG  (COMPUTER  MODELING  GROUP),  IMEX  User's  Manual,  Calgary,  Alberta, 

Canada, 1999.

17. COURANT, R.; FRIEDRICHS, O, K.; LEWY, H. On the Partial Difference Equations of 

Mathematical Physics, IBM Journal, n. 11, p. 215-234, 1967.

18. DI  DONATO,  GINEBRA;  HUANG,  W.  BLUNT,  M.  Streamline-Based  Dual  Porosity 

Simulation  of  Fractured  Reservoirs.  In:  2003  SPE  ANNUAL  TECHNICAL 

191



CONFERENCE AND EXHIBITION, 10, 2003, Denver, Colorado, USA. SPE 84036.

19. DINDORUK, B.; AL KINDI, A. Dynamic  Modeling  of Multiple  Regionally Extensive 

Reservoirs  Using  a Unified Fluid  Description.   In:  2007 SPE ANNUAL TECHNICAL 

CONFERENCE AND EXHIBITION, 11, 2007, Anaheim, CA, USA. SPE 109284.

20. EMANUEL, A. S.; MILLIKEN, W. J. History Matching Finite Difference Models With 

3D Streamlines. In: 1998 ANNUAL TECHNICAL CONFERENCE AND AXHIBITION, 

9, 1998, New Orleans, Luisiana, USA. SPE 4900.

21. GAUTIER, Y.; BLUNT, M. J.; CHRISTIE, M.A. Nested Gridding and Streamline-Based 

Simultion  for  Fast  Reeservoir  Performance  Prediction.  In: 1999  RESERVOIR 

SIMULATION SYMPOSIUM, 2, 1999, Houston, Texas, USA. SPE 51931.

22. GEOQUEST  RESERVOIR  TECHNOLOGIES,  Eclipse  Technical  Manual  (2003a), 

Houston, Texas, USA. 2002.

23. GIBSON,  A.  et  al.  New  Methods  for  the  Nonequilibrium  of  Reservoir  Models  With 

Lateral and Vertical Variations in the Initial Fluid Composition.  In: 2006 ABU DHABI 

INTERNATIONAL PETROLEUM EXIHIBITION AND CONFERENCE, 11, 2006, Abu 

Dhabim UAE. SPE 101247.

24. GUIMARÃES, M. S.; MASCHIO, C.;  SCHIOZER,  D. J. Aplicação  da Simulação por 

Linhas de Fluxo no Gerenciamento de Campos Maduros.  In: 10° Brazilian Congress of 

Thermal  Sciences  and  Engineering  ?  ENCIT  2004,  12,  2004,  Rio  de  Janeiro,  Brasil. 

CIT04-0325.

25. HÆGLAND, H. et al. Improved Streamline and Time-of-Flight for Streamline Simulation 

on Irregular Grids. Advances in Water Resources, v. 30, n. 4, 2007, p. 1027-1045.

26. HASTINGS J. J.; MUGGERIDGE, A. H.; BLUNT, M. J. A New Streamline Method for 

Evaluating Uncertainty in Small-Scale, Two-Phase Flow Properties. SPE Journal, v. 8, n. 

1, 3, 2003. SPE 83671. 

27. HIGGINS, R. V.; LEIGHTON A. J. A Computer Method to Calculate Two-Phase Flow in 

Any Irregularly Bounded Porous Medium.  Journal of Petroleum Tchnology,  v. 14, p. 

192



679-683, 6, 1962.

28. H?IER, L.; WHITSON, C. H. Compositional Grading ? Theory and Practice. In: 2000 

ANNUAL TECHNICAL CONFERENCE AND EXHIBITION, 10, 2000, Dallas, Texas, 

USA. SPE 63085.

29. INGEBRIGTSEN,  L.;  BRATVEDT,  F.;  BERGE,  J.  A Streamline  Based  Approach  To 

Solution  of  Three-Phase  Flow.  In:  1999  SPE  RESERVOIR  SIMULATION 

SYMPOSIUM, 2, 1999, Houston, Texas, USA. SPE 51904.

30. JESSEN K.; ORR Jr. F. M. Compositional Streamline Simulation. In: 2002 SPE ANUAL 

TECHNICAL CONFERENCE AND EXIHIBITION, 10, 2002, San Antonio, Texas, USA. 

SPE 77379.

31. JESSEN  K.;  ORR  Jr.  F.  M.  Gravity  Segregation  and  Compositional  Streamline 

Simulation.  In:  2004  SPE/DOE  FOURTEENTH  SYMPOSIUM  ON  IMPROVED  OIL 

RECOVERY, 4, 2004, Tulsa, Oklahoma, USA. SPE 89448.

32. JIMENEZ,  E.;  DATTA-GUPTA,  A.;  KING,  M.  J.  Spatial  Error  and  Convergence  in 

Streamline  Simulation.  In:  2005  SPE  RESERVOIR  SIMULATION  SYMPOSIUM,  2, 

2005, The Woodlands, Texas, USA. SPE 92873.

33. KIPPE,  V.;  HÆGLAND,  H.;  LIE,  K.-A.  A Method  to  Improve  the  Mass  Balance  in 

Streamline Methods. In: 2007 SPE RESERVOIR SIMULATION SYMPOSIUM, 2, 2007, 

Houston, Texas, USA. SPE 106250.

34. KOSLOVA, A.  et al. A Three-Phase Compressible Dual-Porosity Model for Streamline 

Simulation.  In:  2006  SPE  ANNUAL  TECHNICAL  CONFERENCE  AND 

EXIHIBITION, 9, 2006, San Antonio, Texas, USA. SPE 102549.

35. LEBLANC,  J.L.;  CAUDLE,  B.  H.  A Streamline  Model  for  Secondary  Recovery.  In: 

NINTH BIENAL PRODUCTION TECHNIQUES SYMPOSIUM, 5, 1970, Wichita Falls, 

Texas, USA. SPE 2865.

36. LIGERO, E. L.; MASCHIO, C.; SCHIOZER, D. J. Quantifying the Impact of Grid Size, 

Upscaling, and Streamline Simulation in the Risk Analysis  Applied to Petroleum Field 

193



Development.  In:  SPE  RESERVOIR  SIMULATION  SYMPOSIUM, 2, 2003, Houston, 

Texas, USA. SPE 79677.

37. MALLISON,  B.T.;  GERRITSEN,  M.G.;  MATRINGE,  S.  F.  Improved  Mappings  for 

Streamline-Based  Simulation.  In:  2004  SPE/DOE  FOUREENTH  SYMPOSIUM  ON 

IMPROVED OIL RECOVERY, 4, 2004, Tulsa, Oklahoma, USA. SPE 89352.

38. MASCHIO, C.; SCHIOZER, D. J. Analysis of the Performance of Streamline Simulation. 

In: 2nd MEETING ON RESERVOIR SIMULATION, 5-6, 2002, Buenos Aires, Argentina.

39. MASCHIO, C.; SCHIOZER, D. J. Integration of Streamline Simulation and Automatic 

History Matching.  2004  In:  2004  SPE  ANNUAL TECHNICAL CONFERENCE  AND 

EXIHIBITION, 7, 2004, Houston, Texas, USA. SPE 89850.

40. MATRINGE, S.F.; GERRITSEN, M. G. On Accurate Tracing of Streamlines.  In: 2004 

SPE ANNUAL TECHNICAL CONFERENCE AND EXIHIBITION, 9, 2004, Houston, 

Texas, USA. SPE 89920.

41. MATRINGE,  S.F.;  GERRITSEN,  M.  G.;  MALLISON,  B.  T.  Optimizing  Streamline 

Coverage  for  Efficiency  and  Accuracy.  In:  2005  SPE  RESERVOIR  SIMULATION 

SYMPOSIUM, 2, 2005, Houston, Texas, USA. SPE 93306.

42. MONTEL, F.; GOUEL, P. L. Prediction of Compositional Grading in a Reservoir Fluid 

Column.  In:  60th  ANNUAL  TECHNICAL  CONFERENCE  AND  EXIHIBITION,  9, 

1985, Las Vegas, NV, USA. SPE 14410.

43. MUSKAT,  M.  Flow  in  Homogeneous  Fluids,  International  Human  Resources 

Development Corporation, 1937.

44. OBI, E.-O. I.; BLUNT, M. Streamline-based simulation of carbon dioxide storage in a 

North Sea aquifer, Water Resour. Res., v. 42, 2006, 13 p., W03414.

45. OSAKO,  I.;  DATTA-GUPTA,  A.;  KING,  M.  Timestep  Selection  During  Streamline 

Simulation Via Transverse Flux Correction.  In: 2003 SPE RESERVOIR SIMULATION 

SYMPOSIUM, 2, 2003, Houston, Texas, USA. SPE 79688.

46. OSAKO,  I.;  DATTA-GUPTA,  A.  A  composicional  Streamline  Formulation  With 

194



Compressibility Effects.  In: 2007 RESERVOIR SIMULATION SYMPOSIUM, 2, 2007, 

Houston, Texas, USA. SPE 106148.

47. QI, R. et al.  Design of Carbon Dioxide Storage in a North Sea Aquifer Using Streamline-

Based  Simulation.  In:  2007  ANNUAL  TECHNICAL  CONFERENCE  AND 

EXIHIBITION, 11, 2007, Anaheim, CA, USA. SPE 109905.

48. PÁDUA, K. G. O. Oil Composition Variation in a Large Deep Water Field.  In: FIFTH 

LATIN  AMERICAN  AND  CARIBBEAN  PETROLEUM  ENGINEERING 

CONFERENCE AND EXIHIBITION, 8-9, 1997, Rio de Janeiro. SPE 38948.

49. PÁDUA, K. G. O. Nonisothermal Gravitational Composition Variation in a Large Deep-

water Field.  SPE Journal, v. 4, n. 2, 6, 1999, p. 109-117. SPE 56407.

50. PASARAI, U.; ARIHARA, N. Application of Streamline Method to Hot Waterflooding 

Simulation  for  Heavy-Oil  Recovery.  In:  2005  SPE  ASIA  PACIFIC  OIL  &amp;amp;  GAS 

CONFERENCE AND EXIHIBITION, 4, 2005, Jakarta, Indonesia. SPE 93149.

51. PEDDIBHOTLA,  S.;  DATTA-GUPTA,  A.;  GUOPING  XUE.  Multiphase  Streamline 

Modeling in Three Dimensions: Futher Generalizations and a Field Application.  In: 1997 

RESERVOIR SIMULATION SYMPOSIUM, 6, 1997, Dallas, Texas, USA. SPE 38003.

52. PODGORNOVA, O.; MYASNIKOV A.; BRATVEDT, K. Thermodynamically Consistent 

Analytical  Approach  for  Streamline  Simulations  of  Multicomponent  Hydrocarbon 

Reservoirs.  In:  2007  SPE  EUROPEC/EAGE  ANNUAL  CONFERENCE  AND 

EXIHIBITION, 6, 2007, London, UK. SPE 107511.

53. POLLOCK,  D.  W.  Semianalytical  Computation  of  Path  Lines  for  Finite-Diference 

Models. Ground Water, v. 26, p. 743-750, 11-12, 1988.

54. PONTING, D. K. Hybrid Streamline Methods. In: 1998 ASIA PACIFIC CONFERENCE 

ON  INTEGRATED  MODELLING  FOR  ASSET  MANAGEMENT,  3,  1998,  Kuala 

Lumpur, Malaysia. SPE 39756.

55. PORTELLA, R. C. M.; HEWETT, T. A. Fast 3-D Reservoir Simulation and Applications 

Using Streamlines.  In: FIFTH LATIN AMERICAN AND CARIBBEAN PETROLEUM 

195



ENGINEERING  CONFERENCE  AND  EXIHIBITION,  8-9,  1997,  Rio  de  Janeiro. 

SPE 39061.

56. PRÉVOST,  M;  EDWARDS,  M.  G.;  BLUNT,  M.  J.  Streamline  Tracing  on  Curvilinear 

Structured and Unstructured Grids. SPE Journal, v. 7, n. 2, 6, 2002. SPE 78663.

57. RODRIGUEZ, P.; KINDELAN, M. Streamline Methodology Using an Efficient Operator 

Splitting  for  Accurate  Modeling  of  Capillary  and  Gravity  Effects.  In:  2003  SPE 

RESERVOIR SIMULATION SYMPOSIUM, 2, 2003, Houston, Texas, USA. SPE 79693.

58. RUAN, F. et al. An Overview of Streamline Tracer Modeling of Miscible/Imiscible WAG 

Injection  IOR.  In:  SPE/DOE  IMPROVED  OIL RECOVERY  SYMPOSIUM,  4,  2002, 

Tulsa, Oklahoma, USA.

59. SALEHIRAD, Y. Effect of Compositional Grading on Reservoir Fluid Characterization: 

Case Study. In: 2005 ANNUAL TECHNICAL CONFERENCE AND EXIHIBITION, 10, 

2005, Dallas, Texas, USA. SPE 94848.

60. SAMIER,  P.;  QUETTIER,  L;  THIELE,  M.  Applications  of  Streamline  Simulations  to 

Reservoir Studies.  In: 2001 SPE RESERVOIR SIMULATIONS SYMPOSIUM, 2, 2001, 

Hoston, Texas,  USA. SPE 66362.

61. SOCIETY OF  PETROLEUM  ENGINEERS:  The  SI  Metric  System  of  Units  and  SPE 

METRIC STANDARD, Segunda Impressão, USA, 6, 2004.

62. STENERUD, V. R.; KIPPE, V.; LIE, K., -A.; DATTA-GUPTA, A. Adaptive Multiscale 

Streamline  Simulation  and  Inversion  for  High-Resolution  Geomodels.  In:  2007  SPE 

RESERVOIR  SIMULATION  SYMPOSIUM,  2,  2007,  Houston,  Texas,  USA.  SPE 

106228.

63. THIELE,  M.  R.  Modeling  Multiphase  Flow  in  Heterogeneous  Media  Using 

Streamtubes. Stanford: Dept. of Petroleum Engineering, Stanford University, 10, 1994, 

203 f. Tese (PhD).

64. THIELE, M. R., BATYCKY, R. P &amp;amp; BLUNT, M. J. A Streamline-Based 3D Field-Scale 

Compositional  Reservoir  Simulator.  In:  1997  ANNUAL TECHNICAL CONFERENCE 

196



AND EXIHIBITION, 10, 1997, San Antonio, Texas, USA.  SPE 38889.

65. THIELE,  M.  R.  Streamline  Simulation.  In:  7th INTERNATIONAL  FORUM  ON 

RESERVOIR SIMULATION, 6, 2003, Baden-Baden, Alemanha.

66. THIELE, M. R.  et al. Extension of Streamline-Based Dual Porosity Flow Simulation to 

Realistic Geology.  In: 9th EUROPEAN CONFERENCE ON THE MATHEMATICS OF 

OIL RECOVERY, 8-9, 2004, Cannes, France. 

67. TRANGENSTEIN, J.; BELL, J. B. Mathematical Structure of the Black-Oil Model for 

Petroleum  Reservoir  Simulation.  SIAM  Journal  on  Applied  Mathematics,  06,  1989, 

v.49 , n. 3, p. 749-783.

68. WENGER,  L.  M.;  DAVIS,  C.  L.;  ISAKSEN,  G.  H.  Multiple  Controls  on  Petroleum 

Biodetration and Impact on Oil Quality.  SPE Reservoir Evaluation &amp;amp; Engineering, 10, 

2002, v.5 , n. 5, p. 375-383. SPE 80168.

69. YAN, W.  et al. Three-phase Compositional Streamline Simulation and Its Application to 

WAG. 4, 2004, Tulsa, Oklahoma, USA. SPE 89440.

197



Anexo 1   

Fluxograma do Código para Simulação Incompressível

198



199

Ler Dados

Construir conexões
entre blocos

Calcular mobilidades
entre células

Calcular mobilidades
nos poços

Calcular pressão

Calcular campo de
velocidades

Primeiro
passo de
tempo ?

Ordenar células pela
 distância média aos

poços injetores

2

Variar:
Injetor

Variar:
Tempo de
Simulação

Variar:
Camada

Atualizar restrições
de produção

Definir próximo tempo

Células em ordem
decrescente de

 distância

Já 
atingida

?

2

Traçar Linha

Variar:
Face

Variar:
Linha

1

Traçar Linha

1

Inverter Linha

Traçar Linha

4

3

Mapear Sw e Ch para
malha de simulação

Gerar campo de Ch 
a partir de API

Sim

Não

Fim

Num. injetores

Num. camadas

6

Num. linhas

Sim

Não

Início

Fim



200

Regularizar

Resolver Sw e Ch
na linha de

corrente

Definir ?tmax

1

Mapear Sw e Ch para
linha original

Mapear Sw e Ch para
malha de simulação

Somar volume de água
produzida  no

produtor

2

Variar:
Tempo

3

Calcular mobilidades
entre células

Variar: i

Variar: j

Resolver Sw e Ch
na coluna de

células

4

Transferir Sw e Ch para 
malha de simulação

?t

nx

ny

Escrever resultados do
passo de tempo

Gerar campo de API  
a partir de Ch 

Computar volume de água
produzida  no

produtor



Anexo 2   

Fluxograma do Código para Simulação Compressível

201



202

Ler Dados

Construir conexões
entre blocos

Calcular mobilidades
entre células

Calcular mobilidades
nos poços

Calcular pressão

Calcular campo de
velocidades

Número
de injetores

variou?

Ordenar células pela
 distância média aos

poços injetores

Variar:
Tempo de
Simulação

Atualizar restrições
de produção

Definir próximo tempo

3
Fim

Sim

Não

Início

Fim

Inicializar
Pressão

Calcular Porosidades
em n+1 (?n+1)

Calcular concentrações iniciais
dos componentes: Mh, Ml, Mw

Calcular campo       ?C h
vol

Recalcular Sw e C? h
vol

Calcular campo de
divergentes

1



203

5

Variar:
Poço Injetor

Variar:
Camada

Células em ordem
decrescente de

 distância

Já 
atingida

?

Variar:
Face da Célula

Variar:
Linha

4

Sim

Não

Num. injetores

Num. camadas

6

Num. linhas

Célula
Fonte

?

Variar:
Face

6

Variar:
Linha

Num. linhas

5 4

2

Não

Sim

1



204

Células em ordem
decrescente de

 distância

Já 
atingida

?

Sim

Não

7 6

2

Variar: i

Variar: j

Resolver Mw, Mh e Ml
na coluna de

células

3

Transferir Mw, Mh e Ml  para 
malha de simulação

nx

ny

Escrever resultados do
passo de tempo

Gerar campo de API  
a partir de Ch 

Calcular médias de corte de água
e concentrações nos poços

Mapear Mw, Mh e Ml  para
a malha de simulação

Calcular mobilidades
entre células

Calcular Saturações
na malha de simulação

Calcular Saturações
na malha de simulação



205

4

Variar nó até
atingir produtor:

Cortar linha após vazão
adimensional &amp;lt;0.001;
verificando do injetor

 para o produtor

vazão
adimensional

 &amp;lt;1.0E-9
?

Adicionar nó

Determinar
proximo nó

Calcular novo nó e ??

Repetiu
célula
(loop)

 ?

8

9

Cortar linha após vazão
adimensional &amp;lt;0.001;
verificando do injetor

 para o produtor

5

8

9

Cortar linha após vazão
adimensional &amp;lt;0.001;

verificando do produtor
 para o injetor

8

9

Computar volumes e massas
produzidas  no produtor

Sim

Não

Não

Sim

LINHA DE CORRENTE REGULAR



206

6

Variar nó até
atingir injetor:

vazão
adimensional

 &amp;lt;1.0E-9
?

Determinar
proximo nó

Calcular novo nó e ??

Repetiu
célula
(loop)

 ?

Célula 
Fonte

 ?

Reverter elementos
da linha

Cortar linha após vazão
adimensional &amp;lt;0.001;
verificando do injetor

 para o produtor

8

9

Sim

Sim

Sim

Não

Não

Não

7

LINHA DE CORRENTE COMPLEMENTAR



207

Regularizar

Resolver Mw, Mh e Ml
na linha de corrente

Definir ?tmax

Mapear Mw, Mh e Ml para
linha original

Computar Mw, Mh e Ml para
malha de simulação

Computar volumes e massas
produzida  no poço  produtor

9

Variar:
Tempo

?t

8

Estimar novas saturações
de água na linha

SOLUÇÃO DA LINHA DE CORRENTE



Anexo 3   

Análise do Impacto da Consideração de Grau API Variável

208



Análise do Impacto da Consideração de Grau
API Variável

Valcir Tadeu Beraldo

PRIMEIRA PARTE

Desejava-se quantificar o impacto da consideração de Grau API variável na definição de 

um projeto de explotação de petróleo. A abordagem adotada foi a de definir um caso fictício com 

reservatório  retangular,  com  parâmetros  compatíveis  com  campos  de  petróleo  reais.  Foram 

montados  três  modelos  baseados  em  um  reservatório  inclinado:  um  considerando  que  as 

propriedades  do  óleo  podem  ser  aproximadas  por  uma  PVT  única;  um  com  variação  nas 

propriedades  do  óleo,  cujo  gradiente  seria  da  direção  de  um  vértice  inferior  para  o  vértice 

superior do lado oposto e, finalmente, um modelo com gradiente contrário ao do  segundo caso.

 Modelos

Todos os modelos montados são compostos por 5 camadas de 48 x 60 células com 50 m de 

extensão  e  10 m  de  espessura  total,  definindo  um  retângulo  de  2400 m  por  3000 m.  A 

profundidade de topo varia entre 2750 m na face I = 1 até 2835 m na face I = 48, como pode ser 

visto na Figura 1.

Foi  introduzida  alguma  heterogeneidade  através  das  definições  das  espessuras  porosas, 

variando-se a opção net do gross  (NTG) aleatoriamente (distribuição uniforme), entre 0,6 e 0.9. 

Cada  valor  gerado  foi  aplicado  a  um  bloco  de  2 x 2 x  1  células  (Figura  2).  Adotou-se  uma 

permeabilidade constante, igual a 5000 mD, o que não torna o modelo homogêneo, uma vez que 

as relações NTG que entram no cálculo das transmissibilidades não são constantes.

209



Figura 1 - Malha de Simulação - Topo de Reservatório

Figura 2 - Malha de Simulação – NTG

Foram definidos dois casos: um com Grau API variável e outro com Grau API médio. Nos 

dois casos foram usadas tabelas PVT para Graus API extremos: 17,0 e 22,6. Para inicialização 

dos modelos foi construído um programa onde o Grau API de cada célula é calculada em função 

210



da sua coordenada IJK (Figura 3). Para a inicialização de pressão, parte-se da pressão inicial na 

célula  (1,1,1)  e  calcula-se  a  pressão  em  todas  as  células  com  base  em  uma  célula  vizinha, 

usando-se  a média das massas específicas em condições de reservatório. A razão de solubilidade 

(Rs) é calculada por interpolação, em função da massa específica em condições  de superfície. 

Para o caso sem variação de densidade do óleo, foi usada uma tabela interpolada para um valor 

de Fator Volume de Formação (Bo) tal que o Volume de Óleo In Situ (VOIS) não fosse alterado. 

Em todos os modelos o VOIS foi de 52,1  MMm3. 

Figura 3 - Mapa de Grau API no Topo do Reservatório – Caso RETANGULO

211



 Otimização dos Planos de Drenagem

A análise  foi  feita  através  de  otimizações  de  planos  de  drenagem  nos  dois  modelos  de 

distribuição  de  propriedades  de  óleo.  Desejava-se  testar  a  hipótese  de  que  o  modelo  de 

distribuição de propriedades de óleo pode afetar significativamente a escolha da alternativa de 

produção.

Para a drenagem do reservatório, foram colocados três pares de poços horizontais (injetor x 

produtor) com 500 m de extensão. Esses poços foram inicialmente colocados em posições que 

intuitivamente seriam adequadas para a drenagem de um reservatório com características do óleo 

constante  (Figura  4).  Os  poços  produtores  produzem com  pressão  de  fundo  fixa,  enquanto  os 

poços injetores têm sua cota automaticamente ajustada para manter a pressão média do campo em 

um  nível  desejado,  pouco  abaixo  da  pressão  original.  Para  isso  se  fez  uso  da  palavra-chave 

"GPMAINT" disponível no simulador utilizado (ECLIPSE).

Como se desejava estudar o impacto de uma caracterização inadequada em um projeto de 

produção, procurou-se uma forma de otimizar as posições desses poços nos três casos criados. 

Existem várias propostas de métodos para otimização de locações. O método que foi utilizado 

aqui parte do plano inicial de locações e se estabiliza no primeiro ponto de mínimo (ou máximo) 

de alguma função objetivo. Esse é um processo que se assemelha ao que ocorre na definição de 

um projeto: faz-se uma alteração por vez na posição de cada poço, a qual deveria melhorar os 

resultados,  e  aceita-se  essa  modificação  caso  a  melhora  realmente  ocorra.  Por  simplificação 

adotou-se aqui o critério de otimizar as posições dos poços produtores, sem alteração na posição 

dos  poços  injetores,  para  em  seguida  otimizar  as  posições  dos  injetores,  mantendo-se  os 

produtores nas posições otimizadas. O processo poderia se repetir para aprimorar a otimização, 

no entanto isto não foi feito neste estudo. Na otimização são feitos movimentos horizontais de 

duas células em cada um dos poços produtores, num total de 12 movimentos em cada ciclo (4 

direções  em  cada  poço).  Os  poços  produtores  ficaram  localizados  na  camada  superior  e  os 

injetores, na camada inferior em todas as rodadas. Em seguida, o melhor resultado das 12 rodadas 

passa a ser o centro do próximo grupo de movimentos e o processo é repetido até que não haja 

212



mais  incremento  na  função  objetivo.  Para  evitar  simulações  desnecessárias,  foi  colocada  uma 

restrição  para  que  o caso base de  um ciclo  não fosse  novamente  rodado  no  ciclo  seguinte.  A 

função objetivo utilizada foi a produção acumulada de óleo após 10 anos de produção (Np). A 

Figura  7  ilustra  o  processo  utilizado  e  a  Figura  8  mostra  o  crescimento  da  Np  durante  a 

otimização dos três casos estudados. Em média, cada rodada levou 13 minutos para ser concluída.

Figura 4: Posição Inicial dos Poços

Uma dificuldade que existe na otimização de projetos com poços horizontais é a abordagem 

simultânea da posição e da orientação desses poços. Para contornar essa dificuldade, adotou-se 

neste estudo o conceito de poços "circulares" que seriam independentes de orientação. Uma vez 

definida  as  posições  dos  poços,  a  orientação  dos  mesmos  pode  ser  definida  de  modo 

determinístico, analisando-se mapas de saturação de água. No caso presente, os poços horizontais 

são modelados através de 10 células. Os poços "circulares" foram representados por uma célula 

no centro mais 16 células que formam a trajetória do poço (Figura 5). Para minimizar alterações 

213



na produtividade modelada, usou-se a palavra-chave WPIMULT = 0.588 (10.0/17.0) nos arquivos 

de simulação.  

Figura 5: Representação Circular dos Poços

  Resultados

As Figuras 9, 10 e 11  mostram os planos de drenagem dos três casos otimizados, com os 

poços já orientados. Os resultados das simulações em termos de Np são apresentados na Tabela 1. 

A  Tabela  2  mostra  os  resultados  em  Valor  Presente  Líquido  (VPL).  Como  a  função  objetivo 

utilizada na otimização foi Np, não ocorre aumento dos valores de VPL, em relação ao caso base. 

Para a estimativa desses  valores, foi usado o programa WAPT do UNISIM, com os  seguintes 

parâmetros:

• Taxa de Atratividade: 15%

• Custo de Produção de Água: US$ 12,6 /  m3;

• Custo de Produção de Óleo: US$  37,7 / m3;

• Custo de Injeção de Água: US$ 1,9 / m3,

• Preço de venda do óleo: US$ 113,2 /m3.

214



Figura 7: Fluxograma do Processo de Otimização 

22000

23000

24000

25000

26000

27000

28000

0 50 100 150 200 250 300 350 400

Simulações

N
p 

@
 2

01
4 

(M
m

3)

RETANGULO - produtores

RETANGULO - injetores

INVERTIDO- produtores

INVERTIDO - injetores

API_MED - injetores

API_MED - produtores

Figura 8: Evolução da Np no Processo de Otimização

215

 

MONTAR CASO BASE = CASO INICIAL

RODAR

SALVAR Np

RODAR 12 VARIAÇÕES 
REGISTRANDO MÁXIMO 

(Np_max)

Np_max &gt; Np

Np = Np_max

MONTAR CASO BASE = CASO MÁXIMO

FIM

INÍCIO

SIM

NÃO



Figura 9: Plano Otimizado para o Caso RETÂNGULO - Sw com 6 anos de produção

Figura 10: Plano Otimizado para o Caso INVERTIDO - Sw com 6 anos de produção

216



Figura 11: Plano Otimizado para o Caso de Grau API_MEDIO - Sw com 6 anos de produção

Tabela 2: Resultados das Otimizaçoes  - Np
Modelo Plano de Locações Utilizado

Base
(106 m3)

Otimizado
(106 m3

RETÂNGULO 21,12 23,35
INVERTIDO 22,45 23,80
API_MEDIO 24,12 25,58

Tabela 2: Resultados das Otimizaçoes  - VPL
Modelo Plano de Locações Utilizado

Base
(106 dolares)

Otimizado
(106 dolares)

RETÂNGULO 124,2 111,8
INVERTIDO 133,1 117,7
API_MEDIO 148,9 138,7

Após esses resultados, foram feitas mais duas rodadas para exemplificar o que pode ocorrer 

quando, em um reservatório onde existe gradação da qualidade do óleo, é utilizado um modelo de 

simulação  com  PVT única.  O  plano  de  drenagem  otimizado  do  caso  com  densidade  de  óleo 

constante  foi  simulado  nos  dois  outros  modelos.  Os  resultados  em  termos  de  Np  e  VPL são 

217



mostrados  na  Tabela  3.  Observamos  que  embora  os  resultados  não  tenham  indicados  uma 

redução  significativa  na  produção  acumulada, temos  uma  redução  de  VPL de  9,8  milhões  de 

dólares no caso RETÂNGULO e de 16,9 milhões de dólares no caso invertido. Os resultados 

apontam  para  a  necessidade  de  se  repetir  o  processo,  usando  desta  vez  o  VPL como  função 

objetivo, em vez da Np. Os resultados obtidos aqui ainda não são totalmente conclusivos, mas já 

indicam que o impacto da caracterização das propriedades do óleo nos resultados pode ser muito 

importante.

Tabela 3: Resultados da aplicação do Plano Otimizado para API_MEDIO aos outros modelos - 
Np

Modelo
Np

(106 m3)
VPL

(106 dolares)

RETÂNGULO 23,71 107,9
INVERTIDO 25,54 121,8

Para descartar problemas de mínimo local, relativos ao processo de otimização utilizado, 

foi  iniciado  um  outro  processo  de  otimização,  dessa  vez  envolvendo  somente  os  poços 

produtores,  onde  são  testadas  todas  as  alternativas  possíveis  dentro  de  certos  critérios  de 

disposição  de  poços.  Para  gerar  esse  conjunto  de  planos  de  drenagem,  foi  construído  outro 

programa.  Nas  rodadas  realizadas  até  o  momento,  considerou-se  a  possibilidade  de  se  gerar 

localizações  de  centro  de  poços  com  I  variando  entre  5  e  25   e  J  variando  entre  5  e  55.  As 

posições possíveis dos poços podem variar de 10 em 10 células nas direções I ou J e a distância 

mínima  permitida  entre  dois  poços  é  de  20  células  (1000 m).  Com  essa  configuração  foram 

gerados  248  planos  possíveis,  os  quais  estão  sendo simulados  para  os  casos  RETANGULO  e 

API_MED. 

O  modelo  API_MED  também  foi  reproduzido  no  simulador  3DSL,  porém  ainda  não  se 

conseguiu adequar o nível de produção dos poços com os observados no simulador ECLIPSE. 

Nos testes realizados até o momento as rodadas têm demorado em torno de 7 minutos. A  mostra 

as linhas de corrente durante a simulação do caso API_MED, com o plano original de drenagem. 

Como os simuladores de LF têm a característica de serem mais rápidos que os convencionais, 

eles são extremamente adequados para processos de otimização como os usados aqui. Merece 

218



estudo a possibilidade de se usar resultados das linhas de corrente, tais como saturação e Tempo 

de Vôo, como subsídios a funções objetivos que seriam assim obtidas em tempos extremamente 

pequenos, permitindo grande avanço no processo de otimização.

Figura 12: Linhas de Corrente do Caso API_MEDIO

Comparando-se as produções acumuladas de óleo dos dois modelos  observamos que na 

maioria das simulações o resultado obtido com o modelo de API variável (APITRACK) é melhor 

que  o  resultado  do  mesmo  plano  no  modelo  com  Grau  API  uniforme.  Observamos  também, 

principalmente entre os planos com menores produções acumuladas, uma grande dispersão dos 

resultados, ou seja um grande erro de estimativa ao se fazer previsões com o modelo de Grau API 

uniforme.

219



SEGUNDA PARTE

Os resultados obtidos anteriormente no estudo do impacto da variação das propriedades do 

óleo  não  foram  conclusivos.  Por  esta  razão  o  estudo  foi  refeito  com  algumas  alterações  no 

processo.

          Os modelos utilizados foram exatamente os mesmos do estudo anterior, com a diferença de 

que,  desta  vez,  trabalhou-se apenas  com um modelo  de  grau  API variável  e  um  de grau  API 

uniforme. Também por simplicidade, foram utilizados nessa revisão apenas dois poços injetores, 

os quais não tiveram as suas posições otimizadas.

          A Figura 1 mostra o modelo utilizado onde pode-se observar a posição dos poços injetores.

Figura 1: Modelo Utilizado no Estudo — Propriedade: Grau API

O modelo tem as mesmas características do modelo anterior:

•        Simulador: ECLIPSE 100

220

 

  



•        48 x 60 x 5 células de 50 x 50 m e 1 m de espessura (total de 14440 células)

•        Porosidade: 28%

•        Saturação de Água Inicial: 15%

•        Permeabilidade Horizontal: 5000 md

•        NTG: distribuição uniforme entre 0,7 e 0.9

•        API: 19,9 no modelo contante e entre 17 e 22,6 no modelo variável

•        Volume Inicial de Óleo: 52,1 MM m3 std

          Um ponto que foi alterado em relação ao primeiro estudo foi a consideração de um limite 

de produção bruta para o campo, no caso de 50.000 barris por dia. A Figura 2 mostra curvas de 

produção, injeção e pressão típicas em uma rodada com este modelo.

          Observou-se  no  primeiro  estudo  que  os  resultados  não  eram  conclusivos  porque  as 

otimizações caiam em mínimos locais. Para evitar que isso ocorresse, foi desta vez empregado 

um  procedimento  em  que  todos  os  planos  de  drenagem  possíveis  dentro  de  certas  premissas 

fossem simulados. No caso trabalhou-se com posições dos poços produtores variando entre I = 6 

e I = 42, na direção x e J = 6 a J = 54, na direção y. Nas duas direções, as posições para os poços 

variaram de 12 em 12 células. Dentro dessas premissas foram gerados 1.140 planos de drenagem, 

os quais foram testados em ambos os modelos.

          Assim como no primeiro estudo, foram considerados poços "circulares" para isolar o efeito 

de orientação dos poços horizontais.

          Comparando-se as produções acumuladas de óleo dos dois modelos (Figura 3) observamos 

que, na  maioria das simulações, o resultado obtido com o modelo de API variável (APITRACK) 

221



é melhor que o resultado do mesmo plano no modelo com API uniforme. Observamos também, 

principalmente entre os planos com menores produções acumuladas, uma grande dispersão dos 

resultados, ou seja um grande  erro de estimativa ao se fazer previsões  com o modelo  de API 

uniforme.

Figura 2: Curvas de Produção e Injeção Típicas

          A mesma tendência observada na produção acumulada pode ser vista quando analisamos 

produção acumulada atualizada por uma taxa de desconto de 15% ao ano (Figura 4). Neste caso 

também observamos que o melhor resultado de um modelo não corresponde ao melhor resultado 

do outro, comprovando a hipótese de que a adequada caracterização do óleo é importante para se 

obter o melhor um plano ótimo de drenagem. Considerando um preço por barril de óleo de US$ 

20, seria escolhido, ao se utilizar o modelo de grau API constante, um plano com uma receita 71 

milhões de dólares inferior ao que seria possível neste modelo (Figura 5). 

222



Figura 3: Análise da Produção Acumulada dos Dois Modelos

Figura 4: Análise da Produção Acumulada Atualizada dos Dois Modelos

223

 

0

5000

10000

15000

20000

25000

0 5000 10000 15000 20000 25000

Np (Km3) modelo API onstante

N
P 

(k
m

3)
 n

o 
M

od
el

o 
co

m
 A

P
I T

ra
ck

in
g

0

5000

10000

15000

20000

25000

0 5000 10000 15000 20000 25000

Np (Km3) modelo API onstante

N
P 

(k
m

3)
 n

o 
M

od
el

o 
co

m
 A

P
I T

ra
ck

in
g

 

 

0

2000

4000

6000

8000

10000

12000

14000

0 2000 4000 6000 8000 10000 12000 14000

Np atual (Km3) modelo API onstante

N
P 

at
ua

l (
km

3)
 n

o 
M

od
el

o 
co

m
 A

P
I T

ra
ck

in
g

0

2000

4000

6000

8000

10000

12000

14000

0 2000 4000 6000 8000 10000 12000 14000

Np atual (Km3) modelo API onstante

N
P 

at
ua

l (
km

3)
 n

o 
M

od
el

o 
co

m
 A

P
I T

ra
ck

in
g

 



Figura 5: Detalhe das melhores Produções Acumuladas 
Atualizadas dos Dois Modelos

A Figura 6 mostra os melhores planos de drenagem obtidos com os dois modelos. Esses 

planos foram tomados como planos iniciais para uma segunda fase de otimização, onde o mesmo 

método utilizado no primeiro estudo foi adotado. Dessa forma a possibilidade de ocorrência de 

mínimos locais fica muito reduzida. Após otimização, os poços foram deslocados ligeiramente, 

chegando-se aos planos de drenagem que são mostrados na Figura 7.

Figura 6: Melhores Planos de Drenagem

224

 

11000

11200

11400

11600

11800

12000

12200

12400

12600

12800

13000

11000 11200 11400 11600 11800 12000 12200 12400 12600

Np atual (Km3) modelo API constante

N
P 

at
ua

l (
km

3)
 n

o 
M

od
el

o 
co

m
 A

PI
 T

ra
ck

in
g 123

276

US$ 70 MM

11000

11200

11400

11600

11800

12000

12200

12400

12600

12800

13000

11000 11200 11400 11600 11800 12000 12200 12400 12600

Np atual (Km3) modelo API constante

N
P 

at
ua

l (
km

3)
 n

o 
M

od
el

o 
co

m
 A

PI
 T

ra
ck

in
g 123

276

US$ 70 MM

 

 

        

              APIMEDIO                             APITRACK 



Figura 7: Melhores Planos de Drenagem após Otimização

          A Figura  8  mostra  os  mapas  de  saturação  de  água  na  camada  intermediária  dos  dois 

modelos, após cinco anos de produção, juntamente com o caso em que o melhor plano do modelo 

de  API  uniforme  é  utilizado  no  modelo  de  API  variável.  Podemos  ver  claramente  como  a 

drenagem do reservatório é prejudicada pela utilização de um modelo de caracterização de óleo 

que não é o adequado para reservatórios com variação de densidade. Observa-se que a irrupção 

de água é antecipada no poço superior e no poço central.

          Na  Tabela  1,  são  apresentados  os  resultados  das  melhores  rodadas  de  cada  caso  e  da 

utilização do melhor plano do caso uniforme no modelo de API variável. Conclui-se desta tabela 

que a utilização do modelo de API uniforme para determinar o melhor plano de drenagem de um 

campo com essas características levaria a uma perda de quase 2% no Fator de Recuperação e de 

mais de US$ 30 milhões de dólares na receita do projeto.

225

 

      

             APIMEDIO                             APITRACK 



Figura 8: Planos de Drenagem sobre Mapas de Saturação de Água
 

Tabela 1: Resultados das Otimizações 

Simulação Np(103 m3)
Np atual
(103 m3)

Receita
(106 m3)

Fator de 
Recuperaçã

o
(%)

(1) Melhor plano com API constante 21.151 12.491 1.571 40,6
(2)Melhor plano com API variável 22.239 12.939 1.628 42,7
(3) Melhor plano com API constante 
aplicado ao modelo com API variável 21.233 12.696 1.597

40,8

Perda (2) - (3) 1.006 243 31 1,9

A Figura 9 é similar à  Figura 8, com a diferença de que neste caso os poços "circulares" já 

foram substituídos por poços horizontais reais. A orientação  dos poços foi escolhida de modo a 

minimizar a perda de eficiência de varrido horizontal.

226

 

 

         QPIMEDIO                       APITRACK           APIMED-&gt;APITRACK 



Figura 9: Planos de Drenagem com Poços Reais sobre Mapas de Saturação de Água

Os  resultados  levam  à  conclusão  de  que,  em  um  reservatório  onde  exista  variação 

considerável  nas  propriedades  iniciais  do  óleo  no  espaço,  o  estabelecimento  de  um  plano  de 

drenagem sob a hipótese de propriedades uniformes, pode significar sensível perda de fator de 

recuperação e desempenho econômico inferior ao que poderia ser obtido com uma caracterização 

mais adequada.

227

 

 

    QPIMEDIO                       APITRACK           APIMED-&gt;APITRACK 


	Capítulo 1   
	1.1 Objetivos
	1.2 Estrutura da Tese

	Capítulo 2   
	2.1 Variação Composicional do Óleo
	2.2 Simulação por Linhas de Corrente
	2.3 Modelos Composicionais
	2.4 Compressibilidade
	2.5 Outras Propostas
	2.6 Aplicações de Simulação por Linhas de Corrente

	Capítulo 3	   
	3.1 Simulação por Linhas de Corrente
	3.2 Variação Espacial e Dinâmica das Propriedades do Óleo em Simuladores Black-Oil
	3.3 Equações Básicas para Simulação por Linhas de Corrente
	3.4 Solução da Pressão
	3.5 Construção das Linhas de Corrente
	3.6 Solução do Transporte de Massa para Sistema Incompressível
	3.7 Solução de Transporte de Massa para Sistema Compressível

	Capítulo 4   
	4.1 Fluxograma
	4.2 Entrada de Dados
	4.3 Determinação das Concentrações dos Componentes
	4.4 Definição dos Poços
	4.5 Solução da Pressão
	4.6 Solução do Transporte de Massa nas Linhas de Corrente
	4.7 Gravidade

	Capítulo 5   
	5.1 Fluxograma
	5.2 Determinação das Concentrações dos Componentes
	5.3 Solução da Pressão
	5.4 Solução do Transporte de Massa nas Linhas de Corrente
	5.5 Gravidade
	5.6 Intervalo de Tempo para  Solução da Pressão
	5.7 Correção de Intervalo de Tempo para Erros de Balanço de Massa

	Capítulo 6   
	6.1 Sistema Incompressível
	6.2 Sistema Compressível

	Capítulo 7   
	7.1 Sistema Incompressível
	7.2 Sistema Compressível

	Capítulo 8   
	8.1 Conclusões
	8.2 Recomendações
	 Modelos
	 Otimização dos Planos de Drenagem
	  Resultados





</field>
	</doc>
</add>