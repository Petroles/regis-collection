<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20460</field>
		<field name="filename">4017_000970352.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

ENG07053 - TRABALHO DE DIPLOMAÇÃO EM ENGENHARIA 
QUÍMICA  

 

 

 

 

 

 

S í n t e s e  d e  E s t r u t u r a s  d e  
C o n t r o l e  A u t o - O t i m i z á v e i s  

A p l i c a d a s  à  D e s t i l a ç ã o  
A t m o s f é r i c a  d e  P e t r ó l e o  

 

 

 

 

 

 

 

Autor: Gustavo Borcelli Repenning 

Orientador: Prof. Dr. Marcelo Farenzena 

 

Porto Alegre, julho de 15 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

ii 

Sumári o 
 

Sumário ii 

Agradecimentos iv 

Resumo v 

Lista de Figuras vi 

Lista de Tabelas vii 

Lista de Símbolos viii 

Lista de Abreviaturas e Siglas xii 

1 Introdução 1 

2 Revisão Bibliográfica 2 

2.1 Otimização 2 

2.2 Otimização em Tempo Real (RTO) 2 

2.3 Controle Auto-Otimizável 4 
2.3.1 Graus de liberdade para controle e otimização 6 
2.3.2 Implementação 7 
2.3.3 Seleção de variáveis controladas 7 

3 Metodologia 11 

3.1 Modelagem e otimização 11 

3.2 Controle Auto-Otimizável 11 

3.3 Metodologia proposta – Análise dos Ganhos 12 

3.4 Linearização do sistema 13 

3.5 Espaço nulo 13 

4 Formulação do Estudo de Caso 15 

4.1 Unidade de Destilação Atmosférica de Petróleo 15 

4.2 Modelagem 15 

4.3 Otimização 18 

5 Resultados 20 

5.1 Análise dos graus de liberdade 20 

5.2 Otimização do modelo não-linear 22 

5.3 Análise dos ganhos 23 

5.4 Avaliação da perda 24 

5.5 Linearização do sistema 25 

5.6 Espaço nulo 27 

6 Conclusões e Trabalhos Futuros  29 



DEQUI / UFRGS – Gustavo Borcelli Repenning iii 

7 Referências 31 

Apêndice A A1 

Apêndice B B1 

 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

iv 

A grade ci me nt os  
 

Agradeço à toda a minha família por todo o amor, suporte e educação, sem os quais 
não teria sido possível perseguir meus sonhos e atingir meus objetivos. À minha 
namorada, pela incondicional parceria, cumplicidade e carinho em todos momentos, 
muito obrigado. 

Aos meus mestres, muito obrigado por todo o conhecimento transmitido, por toda a 
dedicação, ajuda e amizade; agradeço especialmente aos professores do Departamento 
de Engenharia Química e ao meu orientador, Prof. Dr. Marcelo Farenzena, que me 
auxiliou e apoiou durante a realização deste trabalho. 

A todos aqueles que me auxiliaram na minha qualificação profissional, iniciação 
científica, intercâmbio e estágios, muito obrigado pelas oportunidades. 

Aos meus amigos, que sempre estiveram presentes desde as primeiras aulas de 
cálculo até os últimos dias de elaboração do trabalho de conclusão de curso. Vocês me 
ajudaram a trilhar esse caminho de sucesso da forma mais feliz possível, muito obrigado. 

 

 

  



DEQUI / UFRGS – Gustavo Borcelli Repenning v 

R e s umo 
 

Neste trabalho é estudada a síntese de estruturas de controle auto-otimizável (SOC) 
aplicadas a uma unidade de destilação atmosférica de petróleo. Entende-se por controle 
auto-otimizável a estratégia de controle que visa manter certas variáveis controladas no 
seu setpoint ótimo ao longo de toda a faixa de distúrbios. Sua implementação é simples e 
a resposta é na ordem de segundos, apresentando custo de instalação e manutenção 
muito inferiores a um otimizador em tempo real (RTO) usual. 

Por não ser um RTO, existe uma perda em relação ao ótimo local quando ocorrem 
distúrbios; a escolha de quais variáveis serão controladas visa diminuir essa perda até um 
valor aceitável. Por isso, o foco das pesquisas encontradas na literatura relacionadas ao 
SOC é justamente a seleção das variáveis controladas.  

Para estudar a síntese de estruturas de SOC, foi utilizado um simulador comercial, o 
Aspen Plus. Nele, foi modelado uma planta de destilação atmosférica de petróleo, em que 
uma mistura de dois petróleos são alimentados no sistema, e obtêm-se quatro produtos 
principais: diesel, nafta, querosene e gasóleo atmosférico, além de resíduo atmosférico. 

Foi desenvolvida uma metodologia heurística, baseada nos ganhos das variáveis, para 
selecionar variáveis controladas e suas variáveis manipuladas associadas. Também foi 
utilizada a linearização do sistema para fazer uma análise de varredura de diversas 
combinações de variáveis controladas, além da aplicação de uma metodologia bastante 
reconhecida na literatura, conhecida por espaço nulo. 

O método baseado na análise de ganhos obteve resultados excelentes, com perda de 
apenas 2,51% em relação ao ótimo real no modelo não-linear. As variáveis calculadas no 
modelo linear através das duas metodologias não puderam ser implementadas no 
modelo não-linear, devido à problemas de operabilidade das colunas para as variáveis 
calculadas pelo método de varredura, e devido à dificuldade de implementação da 
variável obtida pelo método do espaço nulo. 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

vi 

Li s t a de  Fi guras  
 

Figura 2.1: Hierarquia de tomada de decisões na indústria (Darby et al., 2011). ................ 3 

Figura 2.2: Hierarquia da estrutura de controle de otimização em tempo real (RTO) 
(Engell, 2007). ........................................................................................................................ 4 

Figura 2.3: Perda imposta por manter o setpoint constante (Skogestad, 2000) .................. 5 

Figura 2.4: Sensibilidade de J em função da variável controlada (Skogestad, 2000). .......... 6 

Figura 2.5: Hierarquia de implementação com otimização separada do controle 
(Halvorsen et al., 2003).......................................................................................................... 7 

Figura 4.1: Fluxograma da unidade de destilação no Aspen Plus ....................................... 15 

Figura 4.2: Curvas TBP dos petróleos e da mistura nominal............................................... 16 

Figura 5.1: Curvas de lucro para estrutura de SOC e de RTO no modelo não-linear.......... 24 

Figura 5.2: Curvas de lucro para estrutura de SOC e estrutura de controle padrã o .......... 25 

Figura 5.3: Curvas de lucro para estrutura de SOC e de RTO no modelo linear ................. 26 

Figura 5.4: Curvas de lucro para estruturas do null space e RTO ....................................... 28 

 

 

 

 

 

  



DEQUI / UFRGS – Gustavo Borcelli Repenning vii 

Li s t a de  Tabe l as  
 

Tabela 4.1: Massa específica e graus API dos petróleos e da mistura nominal.................. 16 

Tabela 4.2: Restrições de composição de cada produto .................................................... 17 

Tabela 4.3: Variáveis utilizadas para o cálculo da o lucro ................................................... 18 

Tabela 4.4: Preços das correntes utilizados no cálculo do lucro ........................................ 19 

Tabela 4.5: Equações e parâmetros para estimativa de preço dos equipamentos ............ 19 

Tabela 4.6: Distúrbios aplicados no sistema ....................................................................... 19 

Tabela 5.1: Variáveis manipuladas do sistema ................................................................... 20 

Tabela 5.2: Análise de graus de liberdade alternativa segundo Skogestad (2002) ............ 21 

Tabela 5.3: Medições disponíveis para serem controladas ................................................ 21 

Tabela 5.4: Variáveis manipuladas na restrição.................................................................. 23 

Tabela 5.5: Ganho das MVs e estruturas de controle obtidas ............................................ 24 

Tabela 5.6: Pares CV-MV obtida no model o linear ............................................................. 26 

 

 

 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

viii 

Li s t a de  Sí mbol os  
 

u – variável manipulada 

y – medição disponível 

d – distúrbio 

c – variável controlada 

J – função objetivo 

g1 – modelo do processo 

g2 – restrição de desigualdade 

L - perda 

opt – ótimo 

Nm – número de graus de liberdade para controle 

No – Número de variáveis que não afetam a função objetivo 

Nopt – número de graus de liberdade para otimização 

Nactive – número de graus de liberdade que estão na restrição 

Nopt,free – número de graus de liberdade para otimização fora da restrição 

Gb – matriz ganho em relação às variáveis manipuladas em estado estacionário 

G – subconjunto da matriz Gb 

Gdb – matriz ganho em relação aos distúrbios em estado estacionário 

Gd – subconjunto da matriz Gdb 

F – matriz sensibilidade 

H – espaço nulo à esquerda da matriz de sensibilidade 

yoptb – valores das medições y no ponto ótimo do distúrbio nominal 

ub – valores das variáveis manipuladas no ponto ótimo do distúrbio nominal 

UMP  - custo da material prima 

UE – custo da energia 

UP – custo dos produtos 



DEQUI / UFRGS – Gustavo Borcelli Repenning ix 

UFix – custo dos equipamentos 

CP – preço do petróleo 

CV – preço do vapor 

CE – preço da energia 

CN – preço da nafta 

CK – preço do querosene 

CD – preço do diesel 

CAGO – preço do gasóleo atmosférico 

CATMR – preço do resíduo atmosférico 

PF,PF – custo da fornalha da PF 

PF,CDU – custo da fornalha da CDU 

PC,PF – custo do condensador da PF 

PC,CDU – custo do condensador da CDU 

PCol,PF – custo da coluna PF 

Pcol,CDU – custo da coluna CDU 

A – fator de amortização 

r – taxa de justo 

n – anos de operação 

VP – vazão de petróleo 

VV,PF – vazão de vapor ao PF 

VV,CDU – vazão de vapor à CDU 

VV,CDU1 – vazão de vapor à ST1 

VV,CDU2 – vazão de vapor à ST2 

VV,CDU3 – vazão de vapor à ST3 

VN – vazão de nafta da PF 

VHN – vazão de nafta da CDU 

VK – vazão de querosene 

VD – vazão de diesel 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

x 

VAGO – vazão de gasóleo atmosférico 

VATMR – vazão de resíduo atmosférico 

QC,PF – calor ao condensador da PF 

QC,CDU – calor ao condensador da CDU  

QF,PF – calor à fornalha da PF 

QF,CDU – calor à fornalha da CDU 

QP1 – calor à pumparound 1 

QP2 – calor à pumparound 2 

VDest,PF – vazão de destilado na PF 

VDest,CDU – vazão de destilado na CDU  

VFundo,PF – vazão de fundo da PF 

VFundo,CDU – vazão de fundo da CDU 

VÁgua,PF – vazão de água na PF 

VÁgua,CDU – vazão de água na CDU 

VLeves,PF – vazão de leves na PF 

RPF – razão de refluxo na PF 

RCDU – razão de refluxo na CDU 

TC,PF – temperatura no condensador do PF 

Ti,PF – temperatura no prato i da PF 

Ti,CDU – temperatura no prato i da CDU 

TK – temperatura do querosene 

TD – temperatura do diesel 

TAGO – temperatura do gasóleo atmosférico 

TRes,ATM – temperatura do resíduo atmosférico 

XN – ASTM D86 95% líquido de nafta da PF 

XHN – ASTM D86 95% líquido de nafta da CDU 

XNafTot – ASTM D86 95% líquido da corrente de nafta combinada 



DEQUI / UFRGS – Gustavo Borcelli Repenning xi 

XL – ASTM D86 95% líquido de leves 

XK – ASTM D86 95% líquido de querosene 

XD – ASTM D86 95% líquido de diesel 

XAGO – ASTM D86 95% líquido de gasóleo atmosférico 

XRes,ATM – ASTM D86 95% líquido de resíduo atmosférico 

?Fundo,PF – massa específica da corrente de fundo da PF 

?Res,ATM – massa específica da corrente de fundo da CDU 

HFundo,PF – entalpia da corrente de fundo da PF 

TT,STj – temperatura do topo da stripper j 

TP1 – temperatura da corrente na pumparound 1 

TP2 – temperatura da corrente na pumparound 2 

 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

xii 

Li s t a de  A bre vi at uras  e  Si gl as  
 

RTO – Otimização em tempo real 

SOC – Controle Auto Otimizável 

CV – Variável controlada 

MV – Variável manipulada 

CDU – Unidade de destilação atmosférica 

PF – Coluna de destilação pré-flash 

AGO – Gasóleo atmosférico 

RATM – Resíduo atmosférico 

NCO – Condições necessárias de otimalidade 

ST1 – Stripper 1 onde é removido querosene 

ST2 – Stripper 2 onde é removido diesel 

ST3 – Stripper 3 onde é removido gasóleo atmosférico 



DEQUI / UFRGS – Gustavo Borcelli Repenning 1 

1 Int rodução 
 

A otimização é um recurso cada vez mais utilizado industrialmente e seu emprego 
tende a aumentar ainda mais, devido à alta competitividade do mercado, padrões 
ambientais mais rígididos e a uma maior disponibilidade de recursos computacional e 
engenheiros mais treinados para usar tais ferramentas.  

O otimizador em tempo real (RTO) é a ferramenta de otimização mais utilizada na 
indústria para otimização online de processos. Ela é capaz de unir o controle regulatório e 
a questão econômica da planta, trazendo benefícios para ambos. Entretanto, as 
ferramentas de RTO disponíveis são extremamentes dependentes dos modelos de 
processo utilizados e das medições dos distúrbios, além de operar somente quando o 
processo se encontra em estado estacionário. Ainda mais, o RTO possui um alto custo de 
implementação e manutenção, o que impulsionou pesquisas relacionadas a novas 
soluções para operar a planta próximo do ponto ótimo. 

O controle auto-otimizável (SOC) é uma estratégia de controle que visa operar o 
sistema o mais próximo possível do ótimo local. Ela é composta por simples controladores 
PID em feedback, mantendo certas variáveis controladas em seus setpoints constantes. As 
variáveis controladas devem ser escolhidas de tal forma que a perda, diferença entre o 
lucro do SOC e o lucro ótimo, seja a menor possível. 

A aplicação de controle auto-otimizável em uma planta real não é trivial devido ao 
grande número de variáveis manipuladas e medições disponíveis. Associar pares de 
variáveis manipuladas e controladas para trazer benefícios econômicos à unidade, ao 
mesmo tempo em que a estabilidade operacional da planta é mantida, é o foco deste 
trabalho. 

O objetivo deste trabalho é propor uma nova metodologia para seleção de pares de 
variáveis controladas e manipuladas para aplicação de SOC em um sistema com modelos 
não-lineares rigorosos. Tal metodologia é aplicada em uma unidade de destilação 
atmosférica de petróleo, modelada em um simulador comercial. Outras duas 
metodologias para seleção de controladas são utilizadas no modelo linearizado do 
sistema: análise de combinações de CVs e método do espaço nulo. 

O presente trabalho é dividido da seguinte forma: no segundo capítulo é apresentada 
uma revisão bibliográfica de otimização e RTO, uma revisão dos conceitos básicos do 
controle auto-otimizável, das metodologias existentes na literatura para seleção de 
variáveis controladas e apresentação de estudos de caso pesquisados. O terceiro capítulo 
apresenta a nova metodologia de análise de ganhos proposta, além de os outros dois 
métodos utilizados para seleção de variáveis. O capítulo quatro apresenta o estudo de 
caso e o cinco traz os resultados e discussões. Finalmente, no capítulo seis são feitas as 
conclusões quanto aos resultados observados e sugestões para trabalhos futuros são 
apresentados. 

 

  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

2 

2 R e vi s ão B i bl i ográfi ca 
 

Neste capítulo é apresentada uma breve revisão bibliográfica de otimização 
matemática e otimização em tempo real, e uma revisão mais aprofundada do tema 
principal deste trabalho, que é o controle auto-otimizável. 

 

2.1 O t imiza çã o 

Otimização consiste no uso de métodos específicos para determinar a solução com 
mais eficiência e melhor custo-benefício para um problema. Ela atravessa os ramos da 
ciência, engenharia e negócios. Essa técnica é uma das ferramentas quantitativas mais 
utilizadas na tomada de decisão industrial (Edgar, Himmelblau e Lasdon, 2001). 

A meta é atingir o mínimo de uma função objetivo, que no ramo da engenharia é 
usualmente o oposto do lucro ou o custo; também há casos em que a função objetivo 
pode ser minimizar emissões ou maximizar a produção de um certo produto. Um 
problema de otimização, ou programação matemática, pode ser formulado da seguinte 
forma: 

 ????  ?(?,?, ?) (2.1) 

 ?1(?, ?, ?) = 0 (2.2) 

 ?2(?, ?, ?) ? 0 (2.3) 

Onde J é a função objetivo, g1 é o modelo do processo, g2 as restrições de 
desigualdade, u as variáveis independentes, d os distúrbios e x as variáveis de estado. 

 

2.2 O t imiza çã o em Temp o Rea l (RTO )  

Uma técnica bem estabelecida na indústria para vincular o controle regulatório e a 
otimização da planta é a técnica de otimização em tempo real (Real-Time Optimization, 
RTO). O RTO é um sistema de controle de camada superior à regulatória, baseado em 
modelos rigorosos, que opera em circuito fechado e fornece os setpoints para o sistema 
de controle de nível inferior, mantendo a operação o mais próximo possível do ótimo 
econômico (Engell, 2007). 

A hierarquia padrão para controle e tomada de decisão numa planta industrial é 
mostrada na Figura 2.1. As linhas pontilhadas demonstram feedback e setpoints 
manualmente inseridos, enquanto que as linhas sólidas ocorrem em tempo real, 
automaticamente (Darby et al., 2011). 



DEQUI / UFRGS – Gustavo Borcelli Repenning 3 

 
Figura 2.1: Hierarquia de tomada de decisões na indústria (Darby et al., 2011). 

O planejamento de produção se preocupa com “o que e como”, baseado na situação 
econômica e em previsões, e responde a perguntas como quais matérias-primas comprar, 
quais produtos fabricar e quanto de cada produzir. Programação atenta em “quando 
produzir”, tratando de problemas como chegada de matérias-primas, mudanças 
operacionais e estocagem. O RTO programa as decisões comerciais em tempo real em um 
modelo não-linear, geralmente em estado estacionário, e calcula os setpoints 
economicamente ótimos das camadas inferiores a ele. O modelo de controle preditivo 
(MPC) providencia controle dinâmico minuto-a-minuto e, em alguns casos, possui certa 
capacidade de otimização. A camada mais subordinada é a do sistema de controle 
distribuído (DCS), responsável pelo controle regulatório da planta, sendo a interface 
tipicamente utilizada para monitoramento e controle operacional (Darby et al., 2011). 

A estrutura hierárquica de um RTO é exemplificada na Figura 2.2. Planejamento e 
programação fornecem os objetivos, parâmetros e restrições para o RTO, enquanto que a 
camada regulatória supre informações de todas as variáveis significantes do processo. 
Inicialmente essas informações são analisadas e, se confirmado o estado estacionário, 
novos parâmetros do modelo são recalculados. Os novos parâmetros são utilizados no 
cálculo de otimização da função objetivo, os valores obtidos são analisados pelo sistema 
supervisório (que usualmente inclui os operadores da planta) e, então, os valores são 
inseridos como setpoints das variáveis controladas (Engell, 2007). 

A estrutura combinada RTO/controle regulatório pode funcionar satisfatoriamente 
sob duas condições básicas. A primeira é que não haja mudanças significativas ocorrendo 
frequentemente no processo, pois caso essas mudanças ocorram em uma escala de 
tempo inferior ao período de amostragem do RTO, o mesmo se torna ineficaz.  A segunda 
condição é a utilização de modelos não-lineares rigorosos que representem bem a planta. 
Tal condição está mais presente nos dias atuais, pois já é comum a utilização de modelos 
na fase de projeto e em treinamentos de operadores (Engell, 2007). 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

4 

 
Figura 2.2: Hierarquia da estrutura de controle de otimização em tempo real (RTO) 

(Engell, 2007). 

Uma limitação do RTO é a utilização de um modelo de processo estacionário, e a 
otimização ser feita somente quando a planta estiver aproximadamente em estado 
estacionário. O tempo entre passos sucessivos até atingir o ótimo deve ser grande o 
suficiente para que a planta atinja um novo estado estacionário após uma modificação 
dos parâmetros do modelo ou dos setpoints. Assim, o período de amostragem deve ser 
várias vezes superior à maior constante de tempo do processo. Em processos reais, os 
períodos de amostragem variam de algumas horas até mais de um dia (Engell, 2007). 

O ganho em desempenho trazido por um sistema de controle sofisticado deve ser 
comparado com o aumento no custo devido à complexidade adicionada ao esquema. A 
adição do RTO não somente significa um alto custo de implementação; são necessárias, 
também, manutenção qualificada, profissionais especializados e investimento em 
treinamento operacional (Engell, 2007). 

  

2.3 Co n t r ole A u to -O timizável 

Segundo Dal Ri (2014), para atingir uma operação verdadeiramente otimizada, seria 
necessário um modelo perfeito, todos os distúrbios deveriam ser medidos e a otimização 
dinâmica deveria ser resolvida on-line. Como isso é irreal, métodos alternativos com 
implementação mais simples e que operam satisfatoriamente são pesquisados. Métodos 
alternativos, também chamados de otimização implícita, são ferramentas de otimização 
baseadas em medições da planta, adaptando diretamente as entradas do processo. Tais 
métodos possuem custos significativamente inferiores ao RTO usualmente aplicado em 
indústrias de processo, segundo Skogestad (2000) e Gros, Srinivasan e Bonvin (2009). 

Destes métodos, o mais proeminente na literatura é o controle auto-otimizável 
(SOC), proposto por Skogestad (2000), baseado em uma simples ideia de Morari, Arkun e 
Stephanopoulos (1980).  



DEQUI / UFRGS – Gustavo Borcelli Repenning 5 

Controle auto-otimizável é quando podemos atingir uma perda aceitável 
com valores de setpoints constantes para as variáveis controladas 
escolhidas, sem a necessidade de re-otimizar quando distúrbios ocorrem, 
transformando o complexo problema de otimização em um simples 
controle feedback (Skogestad, 2000). 

Segundo o autor, operação satisfatória é quando a perda L é a menor possível, ou 
seja, quando o valor real obtido por esse método chega próximo do ótimo global: 

 ? = ? ? ????  (2.4) 

onde J é o valor da função objetivo calculada usando controle auto-otimizável e Jopt é o 
valor da função objetivo no ponto ótimo. A Figura 2.3 exemplifica a perda ao manter 
setpoints constantes após ocorrerem distúrbios diferentes do ponto base, também 
chamado de distúrbio nominal (d*). Nesse exemplo, é preferível escolher a variável C1 a 
ser mantida constante, pois a perda é inferior quando comparada com C2. 

 
Figura 2.3: Perda imposta por manter o setpoint constante (Skogestad, 2000) 

 Segundo Skogestad (2000), ao utilizar esse método sempre haverá um erro de 
implementação, causado por erros de medida ou controle ruim. Esse erro adicional pode 
aumentar dependendo do tipo de comportamento da função objetivo em relação a 
variações nas variáveis controladas escolhidas. Conforme ilustrado na Figura 2.4, há três 
cenários diferentes, onde c denota o valor da variável controlada (Dal Ri, 2014).  

(a) Ótimo com restrição ativa: o valor mínimo do custo encontra-se na 
restrição. Nesse caso, não há perda ao manter o setpoint constante. 
Adicionalmente, a implementação nesse caso é muito fácil (p. ex. manter 
uma válvula fechada). 

(b) Ótimo sem restrição ativa com superfície “plana” (com pouca curvatura): o 
custo é insensível a mudanças na variável controlada c, e novamente a 
implementação é fácil. 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

6 

(c) Ótimo sem restrição com superfície “aguda” (com muita curvatura): o caso 
mais difícil para implementação, pois o custo é muito sensível a c. 
Aconselhável selecionar outra variável controlada. 

 
Figura 2.4: Sensibilidade de J em função da variável controlada (Skogestad, 2000). 

A estrutura de controle acima descrita é limitada por distúrbios e variações da planta 
que persistem por grandes períodos de tempo quando comparados com a dinâmica da 
planta. A inclusão de distúrbios com alta frequência e que considerem os aspectos não 
estacionários da planta ainda é uma questão em aberto (Engell, 2007). 

Para a avaliação econômica da estrutura de controle é utilizado o conceito de perda, 
conforme definido na equação 2.4. Muitos autores avaliam as estruturas de controle 
obtidas e comparam suas efetividades através da perda máxima; ou seja, o fator mais 
importante seria a maior perda ocasionada em toda a faixa de distúrbios. Para outros 
autores, e usualmente também para a indústria, porém, a perda média, ao longo de toda 
a faixa de distúrbios, é o fator mais importante. 

 

2.3.1 Graus de liberdade para controle e otimização 

De acordo com Skogestad (2000), o número de graus de liberdade para controle, Nm,é 
facilmente obtido pelo conhecimento do processo como o número de variáveis 
independentes que podem ser manipuladas por meio externos (p. ex. válvulas, 
equipamentos elétricos e mecânicos ajustáveis). Destes, somente uma parte deve ser 
considerado graus de liberdade de otimização, Nopt: 

 ???? =  ?? ?  ?? (2.5) 

onde No é o número de variáveis que não afetam a função custo J. 

A otimização é geralmente sujeita a diversas restrições e Nopt deve satisfazê-las, e, ao 
mesmo tempo, otimizar a operação. Denotando Nactive como o número de restrições 
ativas, isto é, variáveis operando na condição limite, chega-se ao número de graus de 
liberdade para otimização fora da restrição, Nopt,free: 

 ????,???? =  ???? ?  ??????? (2.6) 

 



DEQUI / UFRGS – Gustavo Borcelli Repenning 7 

2.3.2 Implementação 

A implementação do controle auto-otimizável é muito simples. Ele deve ser 
implementado em uma malha de controle feedback, conforme Figura 2.5, onde Cs é o set-
point que deve ser mantido constante, u a variável manipulada, d o distúrbio, c a variável 
controlada e n o erro de medição (Halvorsen et al., 2003). 

 

Figura 2.5: Hierarquia de implementação com otimização separada do controle 
(Halvorsen et al., 2003). 

Ainda segundo Halvorsen et al. (2003), na prática a implantação deve ocorrer da 
seguinte maneira: 

1. Um conjunto de graus de liberdade deve ser ajustado para satisfazer as condições 
de restrições ativas. 

2. Os graus de liberdade restantes devem ser ajustados para manter as variáveis 
controladas escolhidas c nos valores calculados Cs para o distúrbio nominal d*. 

 

2.3.3 Seleção de variáveis controladas 

O passo mais importante no projeto de um sistema de controle auto-otimizável é 
determinar as variáveis controladas apropriadas. Diversos métodos que envolvem a 
seleção de CVs têm sido desenvolvidos e publicados nos últimos anos, assim como 
diversos estudos de caso (Kariwala, 2007). 

De acordo com Skogestad (2000), após a formulação do problema (função objetivo e 
restrições) e análise de graus de liberdade, deve-se selecionar variáveis que não sejam 
muito afetadas pelo erro de setpoint (diferença entre o valor do setpoint e o ótimo real) e 
pelo erro de implementação (diferença entre o valor real da variável e o setpoint). Para 
diminuir esses erros, necessita-se verificar se as variáveis atendem a alguns requisitos 
básicos: 

1. O seu valor ótimo deve ser insensível a distúrbios (erro de setpoint pequeno); 
2. Deve ser fácil de medir e controlar (erro de implementação pequeno); 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

8 

3. O seu valor deve ser sensível a mudanças na variável manipulada, ao mesmo 
tempo em que o seu ótimo deve ter superfície plana frente ao distúrbio; 

4. Para casos com múltiplas variáveis controladas, elas não devem ser 
correlacionadas. 

O autor propôs combinar os quatro requisitos básicos em uma única regra. Usando 
pequenas variações, é possível linearizar a relação entre os graus de liberdade ? e as 
variáveis candidatas a serem mantidas constantes, ?: 

 ?? = ? ?? (2.7) 

Onde ? é a matriz do ganho em estado estacionário, sendo ??(?) o valor singular mínimo 
da matriz. Assumindo certas condições, deve-se escolher conjuntos de CVs para o qual 
??(?) seja maximizado. 

Ainda é apresentada pelo autor, etapas para o procedimento de determinação das 
variáveis controladas e avaliação da perda: 

1. Análise de graus de liberdade; 
2. Definição do ótimo operacional (função custo e restrições); 
3. Identificação dos principais distúrbios (p. ex. erros do modelo, distúrbios 

operacionais, erros de implementação; 
4. Otimização em d*; 
5. Identificação de candidatas a variáveis controladas. Sempre se implementam as 

variáveis controladas que possuem ótimo na restrição; 
6. Avaliação da perda para as estruturas escolhidas; 
7. Análise final e seleção (incluindo análise de controlabilidade). 
 

Arbel, Rinard e Shinnar (1996) apud Skogestad (2000), ao analisarem um estudo de 
caso de um FCC, introduziram o conceito de variável dominante e controle parcial, as 
quais seriam as variáveis de processo que tendem a dominar o comportamento do 
mesmo e que ao controlar tais variáveis, obtém-se um controle aceitável mesmo. Sendo 
assim, seriam boas candidatas para variáveis controladas. Os próprios autores afirmaram, 
porém, que “o problema de controle parcial foi discutido heuristicamente” e que 
“pesquisas mais aprofundadas se fazem necessárias”. 

Halvorsen et al. (2003) desenvolveram um método local exato e numericamente 
eficiente para avaliar a perda ao manter setpoints constantes. Essa abordagem permite 
procurar numericamente por uma combinação linear de medições para usar como 
variáveis controladas para obter o controle auto-otimizável. O método é baseado na 
expansão quadrática da função objetivo em torno do ponto nominal de operação e 
assume que as restrições ativas para a otimização não-linear não mudam com os 
distúrbios. 



DEQUI / UFRGS – Gustavo Borcelli Repenning 9 

Alstad e Skogestad (2007) propuseram o método de espaço nulo, cujo objetivo é 
obter as variáveis controladas localmente ideais, i. e.: 

 ? = ?? (2.8) 

que são combinações lineares das medições ?, e ? é uma matriz constante. O 
requerimento é que haja pelo menos a mesma quantidade de medições que graus de 
liberdade não restritos e distúrbios, que o erro de implementação possa ser 
negligenciado e que as restrições ativas não mudem com os distúrbios. O primeiro passo 
é obter a partir de um modelo de estado estacionário uma matriz sensibilidade ? em 
relação aos distúrbios. A matriz ótima ? satisfaz: 

 ? ? = 0 (2.9) 

Assim, o próximo passo é obter ? no espaço nulo à esquerda de ? e, então, ?, usando a 
equação 2.8. 

Inspirados pelas duas metodologias acima descritas, Kariwala (2007) desenvolveu um 
método para achar uma combinação ótima de variáveis para controle auto-otimizável 
local para operação em estado estacionário. O método proposto requer somente o uso 
de decomposição de valores singulares seguido pela determinação dos vetores 
característicos da matriz. 

Em todos os métodos anteriormente mencionados, a perda é calculada no pior 
cenário. Como na realidade industrial o mais importante, usualmente, é a perda média, 
Kariwala, Cao e Janardhanan (2008) propuseram um novo método baseado nesse fato, 
além de ser computacionalmente mais eficiente. É importante lembrar que minimizar a 
perda média pode nem sempre ser satisfatório, pois em certos casos pode ter um 
desempenho pífio para determinados distúrbios e erros de implementação. 

Aprimorando o método do espaço nulo, Alstad, Skogestad e Hori (2009) obtiveram 
uma expressão explícita para a matriz ?. Além disso, estenderam o método anterior para 
incluir os erros de implementação e para casos em que há medições extras, usando os 
graus de liberdade a mais para minimizar a perda causada por erros de implementação. A 
ideia central do método do espaço nulo estendido é primeiramente focar em minimizar a 
perda causada pelos distúrbios, e, em seguida, caso hajam graus de liberdade sobrando, 
minimizar a perda devido a erros de medição. Para o autor, a justificativa para reduzir 
primeiramente os distúrbios é devido à maior facilidade de reduzir os erros de medição 
posteriormente do que reduzir distúrbios, além de que a presença dos distúrbios é o 
motivo da utilização de controle feedback e otimização.  

Outra área de otimização implícita, que também considera medições para diminuir os 
erros do modelo e a influência dos distúrbios no processo, é o NCO tracking - busca de 
condições necessárias de otimalidade. François, Srinivasan e Bonvin (2005) propuseram 
metodologias para utilizar medições para corrigir as incertezas de um processo real ao 
forçar as NCO (condições necessárias de otimalidade) no processo. No mesmo trabalho, o 
autor enfatiza a importâncias das restrições ativas. 

Ye et al. (2013) propuseram a incorporação de NCO tracking ao SOC, o que 
possibilitaria atingir um ótimo local. Segundo o autor, o NCO deveria ser selecionado 
como a CV ótima, mas não é prático devido à impossibilidade de medi-lo. Então, CVs são 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

10 

selecionadas para aproximar o NCO não-medido em toda a região de operação para 
atingir operação próximo ao ótimo global.  

Há na literatura algumas aplicações de controle auto-otimizável em modelos 
rigorosos. A primeira tentativa de aplicação foi feita por Larsson et al. (2001) apud Dal Ri 
(2014) no processo Tennesse Eastman, onde os autores apresentam a dificuldade de 
utilizar controle auto-otimizável quando o processo possui um grande número de 
variáveis (12 graus de liberdade, 41 medições e 20 distúrbios). Em seu trabalho, os 
autores descrevem considerações feitas para eliminar algumas medições candidatas a 
serem mantidas constantes, como, por exemplo: 

• Eliminar variáveis que não tem influência econômica; 

• Variáveis cujo ótimo tem restrição ativa em toda a faixa de distúrbios devem 
ser utilizadas como controladas; 

• Utilizar o conhecimento do processo para eliminar candidatas; 

• Eliminar conjuntos de variáveis que são interdependentes. 

O conceito de SOC foi utilizado por Gera et al. (2013) no processo de produção de 
cumeno, onde há quatro graus de liberdade fora da restrição. As variáveis controladas 
mantidas no setpoint ótimo foram escolhidas baseadas em conhecimento do processo e 
implementadas juntamente com outras variáveis manipuladas utilizadas para controle de 
inventário em pares de malha. Apesar da estrutura não usual, ela se mostrou simples de 
operar e obteve um bom desempenho econômico. 

Dal Ri (2014) aplicou estruturas de controle auto-otimizável em dois estudos de caso: 
um evaporador a circulação forçada e na produção de cumeno, o último utilizando o 
simulador Aspen Plus. Para a seleção de CVs, dois métodos foram utilizados: método de 
varredura e método do espaço nulo. 

Araújo, Govatsmark e Skogestad, (2007) aplicaram controle auto-otimizável no 
processo de hidro-dealquilação de tolueno (HDA), utilizando o Aspen Plus para avaliar a 
aplicação da metodologia de controle. Inicialmente, as composição de saída das torres de 
destilação e as restrições ativas são controladas, o que reduz significantemente o número 
de variáveis manipuladas disponíveis para otimização. Então, uma análise linear baseada 
na decomposição do valor singular foi utilizada para fazer uma pré-seleção das variáveis, 
que então foram implementadas no modelo não-linear em estado estacionário. 

  



DEQUI / UFRGS – Gustavo Borcelli Repenning 11 

3 M e t odol ogi a 
 

Neste capítulo serão apresentadas as metodologias utilizadas para o cálculo do ponto 
ótimo e para a escolha das variáveis controladas utilizadas na estrutura de controle auto-
otimizável. 

Inicialmente serão descritos os softwares utilizados para modelagem e otimização. Em 
seguida, controle auto-otimizável será brevemente discutido e então será descrita a nova 
metodologia proposta para seleção de pares de variáveis controladas e manipuladas para 
sistemas de grande dimensão. Não há descrição de metodologias concorrentes para 
seleção de variáveis para tais sistemas, visto que não estão disponíveis na literatura. 
Então, será apresentado o processo de linearização do sistema para uma seleção 
alternativa de variáveis controladas no sistema linear, baseada na varredura de 
combinações. Por fim, é descrita a metodologia do espaço nulo (null space). 

 

3.1 Mo d ela gem e o t imiza ção  

Primeiramente, é necessário construir um modelo representativo do sistema a ser 
estudado. Para este trabalho, foi escolhido modelar e otimizar o sistema no simulador 
comercial Aspen Plus 7.2, devido à complexidade do sistema e à facilidade trazida pelo 
software. Em seguida, deve ser definida a função objetivo. Foi escolhido maximizar a 
função lucro, que considera o valor dos produtos vendidos, o custo de matérias primas, 
utilidades e energia, e a amortização do custo dos equipamentos.  

É preciso, também, impor as especificações do produto, definir quais serão as 
variáveis manipuladas e seus limites, escolher os distúrbios a serem aplicados no modelo 
e realizar a análise dos graus de liberdade para otimização, que serão o número de 
variáveis controladas em setpoints constantes. 

As variáveis escolhidas devem manter o sistema o mais próximo possível ao ótimo 
frente aos distúrbios. Os distúrbios em uma planta real podem surgir devido a variações 
naturais do processo, operação indevida, fatores ambientais e fatores externos. Neste 
trabalho, o distúrbio é a proporção da mistura de petróleos que alimentam a coluna, o 
que efetivamente modifica a composição de alimentação. O simulador trata as 
composições de petróleo como dezenas de pseudocomponentes. 

 

3.2 Co n t r ole A u to -O timizável 

A metodologia de otimização implícita utilizada foi a de controle auto-otimizável, 
proposta inicialmente por Skogestad (2000). Variáveis controladas são escolhidas para 
serem mantidas em setpoints constantes no ótimo nominal, independentemente dos 
distúrbios. 

Para analisar a efetividade das CVs escolhidas, é calculada a perda. Esta é definida 
como a diferença entre o lucro operacional mantendo-se tais CVs no setpoint constante e 
o lucro no ótimo real. Neste trabalho, para o cálculo da perda foi considerado o lucro 
médio, visto que na indústria esse é o valor frequentemente mais importante. É 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

12 

importante ressaltar que ignorar as perdas em distúrbios pontuais pode levar a uma 
escolha de CVs não apropriada, pois em algum distúrbio pode ocorrer uma perda 
econômica inaceitável. 

A síntese das estruturas de controle auto-otimizável é estudada para determinados 
distúrbios. Uma estrutura pode ser considerada excelente para um conjunto de 
perturbações, mas ter uma péssima resposta para outra. Assim, é de suma importância 
escolher os distúrbios mais importantes do sistema e definir o alcance de cada um. 

Outro elemento importante a ser considerado são quais variáveis manipuladas estão 
disponíveis para a otimização. Cada CV terá que ser associada a uma MV, logo elas devem 
ter correlação próxima. Também, elas necessitam ter seus limites de operação definidos. 
Caso uma variável manipulada esteja na restrição quando o lucro for otimizado para 
todos os distúrbios, tal MV será mantida na restrição e será um grau de liberdade 
indisponível. 

 

3.3 Met o d ologia p r op osta –  A n á lise d o s Ga n hos 

Para realizar a escolha de variáveis controladas, foi proposta uma metodologia para 
sistemas complexos não encontrada na literatura, baseada em ganhos das variáveis e nos 
quatro requisitos básicos de Skogestad (2000). Essa análise considera a importância das 
variáveis manipuladas, que muitas vezes não é mencionado na literatura de controle 
auto-otimizável. 

Uma vez formulado o problema de otimização, ele foi resolvido para o ponto base 
utilizando o algoritmo SQP, do Aspen Plus. Foram feitas, em seguida, três análises de 
sensibilidade: ??/??, ganho da função objetivo em relação às variáveis manipuladas, 
????? /??, ganho das medições (candidatas a variáveis controladas) no ponto ótimo em 
relação aos distúrbios e ??/??, ganho das medições  em relação às variáveis 
manipuladas.  

Baseado no ganho do lucro frente às variações das variáveis manipuladas, foram 
listadas as MVs que mais influenciam o mesmo. As MVs que obtiveram o maior ganho em 
relação ao lucro serão as que terão prioridade na associação com as CVs, visto que elas 
são as mais importantes para a economicidade da planta, enquanto que as MVs que não 
possuem influencia significativa no lucro serão mantidas em valores constantes. 

Analisando o ganho das variáveis otimizadas frente ao distúrbio de composição, foram 
ranqueadas da menor para a maior, pois essas são as que sofrem menor variação frente 
aos distúrbios e, por consequência, provocam uma menor variação no lucro. As 
manipuladas que possuem maior influência do lucro devem ser associadas àquelas 
variáveis que sofrem menor variação frente aos distúrbios. Para realizar essa associação, 
pode-se utilizar conhecimento do processo, juntamente com a análise do ganho das 
medições frente às variações das manipuladas. É de extrema importância que as MVs e 
CVs possuam correlação próximas, por isso utilizar o ganho de uma em relação a outra é 
altamente relevante. 



DEQUI / UFRGS – Gustavo Borcelli Repenning 13 

Finalmente, implementam-se todos os pares de manipuladas e controladas no Aspen 
Plus. A ferramenta design spec foi utilizada para manter as CVs no seu setpoint ótimo do 
distúrbio nominal, variando-se cada variável manipuladas associada individualmente. 

 

3.4 L in ea r iza çã o d o  sist ema  

Outra metodologia para encontrar as melhores CVs foi feita utilizando o Matlab 
R2009a, baseado na linearização do modelo. Primeiramente, o sistema foi linearizado no 
ponto ótimo no distúrbio nominal, aplicando-se uma pequena variação na composição e 
nas variáveis manipuladas. De posse das matrizes de ganho e dos valores das variáveis no 
ponto ótimo nominal, é possível linearizar o sistema. 

 ? ?  ????? = ?? (??  ??) + ??? (??  ??)  (3.1) 

Onde ? são as medições, ou candidatas a variáveis controladas, ????? são as medições no 
ponto ótimo base calculados no Aspen Plus, ?? a matriz de ganho ??? ?? ??, ? as 
variáveis manipuladas, ?? as variáveis manipuladas no ponto ótimo base, ??? a matriz de 
ganho ??? ?? ?, ? o distúrbio e ?? o distúrbio nominal. 

Para cada conjunto de variáveis a serem mantidas constantes no seu ótimo nominal, 
calcula-se o valor das variáveis manipuladas, utilizando um subconjunto das matrizes de 
ganho, ? e ??, as quais contem os ganhos das variáveis controladas desse conjunto.  

 ?? =  ???1  ?? ?? (3.2) 

De posse do valor das variáveis manipuladas, calcula-se o valor de cada medição e o 
lucro, para cada distúrbio. Como chute inicial, as variáveis manipuladas são mantidas 
constantes e, em seguida, a primeira manipulada é substituída por todas as outras 
medições, uma de cada vez. O melhor conjunto, que é o que obtiver o maior lucro médio, 
é escolhido. Então, é feita a varredura da segunda variável controlada e assim 
sucessivamente, até a última CV ser definida. 

Para a determinação da perda, calcula-se o ótimo ponto a ponto para toda a faixa de 
distúrbios no Matlab com a função fmincon. Por último, aplica-se o melhor conjunto de 
CVs no modelo não-linear. 

 

3.5 E sp a ç o  n u lo  

Foi feita, também, a aplicação da metodologia do espaço nulo à esquerda para 
seleção de CVs. Essa metodologia, proposta por Alstad e Skogestad (2007), baseia-se em 
obter uma variável controlada para cada distúrbio, sendo que tais variáveis são 
combinações lineares de quantas medições estiverem disponíveis.  

 ? = ? ? (3.3) 

Onde ? é uma matriz constante ??  ? ??. Definindo ? como a matriz sensibilidade: 

 ? =  ?????? ???  (3.4) 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

14 

Existe uma matriz ? no espaço nulo à esquerda de ? que respeite: 

 ? ? = ? (3.5) 

A matriz sensibilidade foi calculada numericamente no modelo-não linear, otimizando 
no distúrbio nominal e para uma pequena variação na composição. Então, a matriz ? 
pode ser calculada utilizando a função ???? no Matlab. A CV obtida deve ser mantida em 
um setpoint constante, ???? , segundo: 

 ???? = ? ???? (3.6) 

A última etapa do método consiste em manter a variável obtida nesse setpoint 
calculado no sistema linearizado. Então, compara-se o lucro obtido pelo espaço nulo com 
o ótimo local, avaliando a efetividade da escolha através da perda. 

  



DEQUI / UFRGS – Gustavo Borcelli Repenning 15 

4 Formul ação do Es t udo de  Cas o 
 

Neste capítulo será apresentado o estudo de caso utilizado para avaliar as 
metodologias de síntese de estruturas de controle auto-otimizáveis. 

 

4.1 Un id a d e d e Dest ila çã o A tmosfér ica  d e P etr óleo 

A unidade de destilação atmosférica de petróleo (CDU) é a principal unidade de 
separação do petróleo e uma das que mais possui impacto na economicidade de uma 
refinaria. É alimentado nela um petróleo que já passou por um vaso separador trifásico e 
por uma dessalinizadora, quando o petróleo tem origem marítima. 

A unidade escolhida consiste em uma torre pré-flash, com o principal objetivo de 
remover nafta e leves, e uma torre de destilação, onde nafta, querosene, diesel, gasóleo 
atmosférico (AGO) e resíduo atmosférico são obtidos como produto. Foi escolhido 
modelar uma planta sem a tradicional destilação á vácuo (VDU), pois, além de ela tornar o 
problema ainda mais complexo e dificultar a otimização e a aplicação do controle auto-
otimizável, há unidades industriais que não utilizam mais essa torre, enviando todo o 
resíduo atmosférico para craqueamento. 

 

4.2 Mo d ela gem 

Para a resolução do problema, foi escolhido utilizar o modelo termodinâmico Braun K-
10 (BK10). Este modelo termodinâmico é próprio para hidrocarbonetos pesados a 
pressões baixas, e é especialmente útil quando se utiliza pseudocomponentes, que é 
como o Aspen Plus lida com correntes de petróleo. O fluxograma do processo, 
desenvolvido no Aspen Plus 7.2, é representado pela Figura 4.1, baseado nas colunas 
estudadas por More et al. (2010). As duas colunas foram modeladas utilizando o bloco 
PetroFrac. 

 
Figura 4.1: Fluxograma da unidade de destilação no Aspen Plus 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

16 

O petróleo destilado na unidade é uma mistura de dois petróleos pesados genéricos, 
A e B. A quantidade de cada petróleo disponível foi considerada um distúrbio para a 
unidade, efetivamente alterando a composição do petróleo alimentado no sistema. A 
mistura nominal do sistema é 20% do petróleo A e 80% do B. As curvas de ponto de 
ebulição real (TBP – True Boiling Point) dos petróleos encontram-se na Figura 4.2, e suas 
massas específicas, a 15 °C, e graus API na Tabela 4.1. 

 
Figura 4.2: Curvas TBP dos petróleos e da mistura nominal 

Tabela 4.1: Massa específica e graus API dos petróleos e da mistura nominal 

  Massa específica (kg/m
3) Graus API 

Petróleo A 866,4 31,40 
Petróleo B 848,7 34,80 
Mistura com 20% de A 852,3 34,11 

 
O petróleo, cuja vazão é 100.000 bbl/d, a 93 °C e 60 psia, é inicialmente alimentado 

na fornalha da coluna pré-flash, onde ocorre a vaporização do mesmo, a qual opera a 232 
°C e 50 psia. Em seguida, é alimentado no estágio mais inferior da coluna. A coluna pré-
flash possui 10 pratos, alimentação de vapor no estágio inferior (93 °C e 60 psia), e um 
condensador parcial operando a 77 °C. A pressão no estágio inferior é de 44,7 psia, com 
uma queda de pressão de 3 psi ao longo da coluna e de 2 psi no condensador. A razão de 
refluxo é controlada, através da ferramenta design spec, para manter a nafta removida no 
topo na especificação desejada, mostrada na Tabela 4.2. Água e leves também são 
removidos no topo, ambos indesejados e sem retorno financeiro. 

O produto de fundo dessa torre é alimentado na fornalha da torre atmosférica. A 
fornalha opera em 24,2 psia e overflash volumétrico de 3%. Overflash, em colunas de 



DEQUI / UFRGS – Gustavo Borcelli Repenning 17 

destilação atmosférica de petróleo, é um volume percentual do produto de fundo que é 
vaporizado a mais na fornalha e que condensa no prato acima da alimentação. Seu 
objetivo é “lavar” componentes não voláteis que seriam carregados pelo vapor para a 
corrente de AGO, melhorando a qualidade do mesmo e ajudando a impedir que o prato 
de onde é retirado o AGO seque.  

Em seguida, alimenta-se a coluna de destilação atmosférica no 22º prato, iniciando a 
contagem a partir do topo. A coluna possui 25 pratos, com alimentação de vapor d’água 
no fundo, três saídas laterais e duas pumparounds, além um condensador total que 
remove nafta e água. 

As saídas laterais são nos pratos 6, 13 e 18. Cada uma dessas correntes alimenta uma 
stripper, que tem como produto de fundo querosene, diesel e AGO, respectivamente. As 
colunas possuem 4, 3 e 2 estágios de separação e possuem uma entrada de vapor d’água 
para remoção dos componentes leves. A corrente gasosa removida no topo retorna para 
o prato superior da coluna principal. 

A pumparound é uma bomba que retira o petróleo de um prato da coluna, resfria essa 
corrente e realimenta em um prato superior. Em uma planta industrial real, essa corrente 
é usualmente resfriada ao pré-aquecer outra corrente da unidade, realizando uma 
integração energética. Nesse estudo de caso, há duas retiradas para resfriamento e 
realimentação na coluna, nos pratos 8 com realimentação no 6, e retirada no 14 e 
realimentação no 13. A retirada de calor é feita em trocadores de calor, removendo 40 e 
15 MMBtu/h do sistema, respectivamente. 

Foram utilizadas as ferramentas tray sizing e tray rating do Aspen Plus para 
determinação do diâmetro das colunas e do tipo de bandeja, os quais encontram-se no 
Apêndice B. Essas ferramentas são importantes para saber se a coluna está operando 
normalmente ou se há problemas operacionais, como atolamento, secamento e jet flood 
(Kister, 1992). 

Para a coluna atmosférica, é utilizada a ferramenta design spec para especificar as 
correntes de diesel e de nafta no topo, segundo Tabela 4.2, manipulando  as vazões de 
saída de cada corrente. No problema original de More et al. (2010), querosene e AGO não 
foram especificados, mas para o problema de otimização neste trabalho eles serão 
especificados. 

Tabela 4.2: Restrições de composição de cada produto 
Restrições ASTM D86 95% Líquido 
Nafta &amp;lt;191 °C 
Diesel &amp;lt;330 °C 
Querosene &amp;lt;263 °C 
AGO &amp;lt;410 °C  

 

A metodologia de caracterização do petróleo utilizada neste trabalho e utilizada como 
medição de composição é a mais utilizada na indústria, dada pela norma ASTM D86. No 
teste, a amostra entra em ebulição e os vapores são coletados e condensados enquanto 
são produzidos, à pressão atmosférica. As temperaturas do vapor são, então, registradas 
como função da quantidade de líquido acumulada. É um teste muito mais rápido que 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

18 

obtenção das curvas TBP. Como nenhum refluxo é usado e há apenas um estágio de 
equilíbrio, o ponto de ebulição inicial desse ensaio é maior que a TBP, enquanto que o 
ponto final é inferior. 

Os valores das correntes no ponto nominal encontram-se no Apêndice B. 
 
4.3 O t imiza çã o 

A função objetivo a ser maximizada é o lucro, que considera o custo das correntes 
alimentadas, o custo das utilidades, a amortização dos equipamentos e o valor dos 
produtos a serem vendidos, conforme Equações 4.1 a 4.5 e Tabela 4.3, proposta por 
More et al. (2010). O código em Fortran, escrito para o cálculo dos custos no Aspen Plus, 
encontra-se no Apêndice A. 

 ??? =  ?? ?  ?? + ??? ? (??,?? +  ?? ,??? +  ?? ,???1 +  ?? ,???2 +  ?? ,???3) (4.1) 

 ?? =  ?? ? (??,?? +  ?? ,??? +  ??,?? +  ??,??? +  ??1 +  ??2 ) (4.2) 

 ?? =  ?? ? (?? +  ??? ) +  ?? ? ?? +  ?? ? ?? +  ???? ?  ???? + ????? ?  ?????  (4.3) 

 ???? =  (??,?? +  ??,??? + ??,?? +  ??,??? + ????,?? +  ????,???) ? ? ? 2 (4.4) 

 ? = (?? ? ??? ? ??) ? 362 ? ???? (4.5) 

Tabela 4.3: Variáveis utilizadas para o cálculo da o lucro 
Sigla Variável Unidade Sigla Variável Unidade 

UMP Custo da matéria prima $/dia QC,PF Calor ao condensador da PF MMBtu/dia 
UE Custo da energia $/dia QC,CDU Calor ao condensador da CDU MMBtu/dia 

UP Custo dos produtos $/dia QF,PF Calor à fornalha da PF MMBtu/dia 

UFix Custo dos equipamentos $ QF,CDU Calor à fornalha da CDU MMBtu/dia 
J Lucro $/ano QP1 Calor retirado na P1 MMBtu/dia 

CP Preço do petróleo $/bbl QP2 Calor retirado na P2 MMBtu/dia 

CV Preço do vapor $/kg VN Vazão de nafta PF bbl/dia 
CE Preço da energia $/MMBtu VHN Vazão de nafta CDU bbl/dia 

CN Preço da nafta $/bbl VK Vazão de querosene bbl/dia 

CK Preço do querosene $/bbl VD Vazão de diesel bbl/dia 
CD Preço do diesel $/bbl VAGO Vazão de AGO bbl/dia 

CAGO Preço do AGO $/bbl VATMR Vazão de resíduo atmosférico bbl/dia 

CATMR Preço do resíduo atmosférico $/bbl PF,PF Custo da fornalha da PF $ 
VP Vazão de petróleo bbl/dia PF,CDU Custo da fornalha da CDU $ 

VV,PF Vazão de vapor à PF kg/dia PC,PF Custo do condensador da PF $ 

VV,CDU Vazão de vapor à CDU kg/dia PC,CDU Custo do condensador da CDU $ 
VV,CDU1 Vazão de vapor à ST1 kg/dia PCol,PF Custo da coluna PF $ 

VV,CDU2 Vazão de vapor à ST2 kg/dia Pcol,CDU Custo da coluna CDU $ 

VV,CDU3 Vazão de vapor à ST3 kg/dia A Fator de amortização ano
-1 

 



DEQUI / UFRGS – Gustavo Borcelli Repenning 19 

Tabela 4.4: Preços das correntes utilizados no cálculo do lucro 
Nome da Corrente Nome de mercado Preço Unidade 

Petróleo Petróleo Brent 59,520 $ / bbl 
Nafta Nafta Petroquímica 1,583 R$ / l 
Querosene Querosene de aviação (QAV) 1,689 R$ / l 
Diesel Óleo Diesel S-500 1,930 R$ / l 
Gasóleo Atmosférico Óleo Combustível B-1 1,414 R$ / l 
Resíduo Atmosférico Cimento Asfáltico de Petróleo 50 70 1,096 R$ / l 
Vapor Vapor de baixa pressão 0,0055 R$ / kg 

 
Tabela 4.5: Equações e parâmetros para estimativa de preço dos equipamentos 

Variável / 
parâmetro 

Valor / expressão Unidade 

Condensadores 

Uc 0,852 (kW m
-2 K-1) 

?Tc 13,9 K 

Ac Qc / (Uc ?Tc) m
2 

Cf,c 7296 (Ac)
0,65 $ 

Fornalhas 

Uf 0,568 (kW m-2 K-1) 

?Tf 34,8 K 
Af Qf / (Uf ?Tf) m

2 

Cf,f 7296 (Af)
0,65 $ 

Colunas de destilação 
La 0,8 N m 

Cf,d 17640 D 
1,066 La 0,802 $ 

 

Utilizando a ferramenta SQP embutida no Aspen Plus, calculou-se o ótimo para o 
ponto base e para os diferentes distúrbios, vide Tabela 4.6. Foram estipulados como 
limites inferiores e superiores uma variação de 20% do valor nominal para as variáveis 
manipuladas, além dos limites de composição superiores, listados na Tabela 4.2. 
Escolheu-se não restringir as composições das correntes de nafta das colunas 
individualmente, e sim restringir a composição da corrente misturada. É esperado um 
ganho econômico ao tomar tal decisão, visto que pode ser obtida uma corrente mais 
pesada na coluna atmosférica que poderia ser compensada pela corrente de nafta da 
coluna pré-flash. 

Tabela 4.6: Distúrbios aplicados no sistema 
Distúrbio Petróleo A (%) Petróleo B (%) 

d1 0% 100% 

d2 10% 90% 
d3

* (nominal) 20% 80% 

d4 30% 70% 

d5 40% 60% 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

20 

5 R e s ul t ados  
 

Esta seção descreve o processo de otimização do sistema de destilação atmosférica de 
petróleo, seguido da aplicação de diferentes metodologias de escolha de variáveis 
controladas a serem utilizadas no controle auto-otimizável. 

 

5.1 A n á lise d o s g r aus d e lib erd ade  

O primeiro passo para realizar a otimização do sistema é determinar o número de 
graus de liberdade do sistema. Simplificadamente, o número de graus de liberdade é o 
número de válvulas, equipamentos elétricos e mecânicos que podem ser ajustados 
independentemente.  

Para este estudo de caso, há 25 variáveis manipuladas, como pode ser visto na 
Tabela 5.1. Entretanto, nem todos podem ser utilizados para a otimização, pois é 
necessário realizar o controle de inventário. Além disso, a vazão de petróleo foi mantida 
fixa. Assim, há 17 variáveis manipuladas disponíveis para otimização.  

O número de graus de liberdade disponíveis para otimização pode ser confirmado por 
uma análise alternativa, proposta por Skogestad (2002) apud de Araújo, Govatsmark e 
Skogestad (2007), na Tabela 5.2. Cada unidade de processo adiciona o número de graus 
de liberdade descrito na segunda coluna, sendo a soma desses números os graus de 
liberdade para otimização. 

Tabela 5.1: Variáveis manipuladas do sistema 
Sigla Corrente Controle Coluna 

VV,PF Vapor alimentado no PF MV para otimização PF 
VV,CDU Vapor alimentado na CDU MV para otimização CDU 

VV,CDU1 Vapor para stripping no ST1 MV para otimização CDU 

VV,CDU2 Vapor para stripping no ST2 MV para otimização CDU 
VV,CDU3 Vapor para stripping no ST3 MV para otimização CDU 

VP1 Vazão na P1 MV para otimização CDU 

VP2 Vazão na P2 MV para otimização CDU 
QP1 Calor trocado na P1 MV para otimização CDU 

QP2 Calor trocado na P2 MV para otimização CDU 

QF,PF Calor na fornalha do PF MV para otimização PF 
QF,CDU Calor na fornalha do CDU MV para otimização CDU 

TC,PF Temperatura no condensador do PF MV para otimização PF 

VDest,PF Vazão de destilado no PF MV para otimização PF 
VDest,CDU Vazão de destilado no CDU MV para otimização CDU 

VK Vazão de querosene (fundo ST1) MV para otimização CDU 

VD Vazão de diesel (fundo ST2) MV para otimização CDU 

VAGO Vazão de AGO (fundo ST3) MV para otimização CDU 



DEQUI / UFRGS – Gustavo Borcelli Repenning 21 

Continuação da Tabela 5.1: Variáveis manipuladas do sistema 
Sigla Corrente Controle Coluna 

VFundo,PF Vazão de fundo da PF Controle de nível PF 

VFundo,CDU Vazão de fundo da CDU Controle de nível CDU 

VÁgua,PF Vazão de água no PF Controle de nível de água no condensador PF 

VÁgua,CDU Vazão de água no CDU Controle de nível de água no condensador CDU 

VLeves,PF Vazão de leves no PF Controle de pressão PF 

RPF Razão de refluxo no PF Controle de nível no condensador PF 

RCDU Razão de refluxo no CDU Controle de nível no condensador CDU 

VP Vazão de petróleo Fixo - 

 
 

Tabela 5.2: Análise de graus de liberdade alternativa segundo Skogestad (2002) 
Unidades de processo Graus de liberdade para otimização 

Cada alimentação externa 1 
Splitter n - 1 (n é o número de correntes de saída) 

Mixer 0 

Compressor, turbina e bombas 1 
Tanque de flash adiabático 0 

Reator em fase líquida 1 

Reator em fase gás 0 
Trocador de calor 1 

Colunas 0 + número de saídas laterais 
 

Foram consideradas 66 variáveis controladas possíveis para o problema, as quais se 
encontram na Tabela 5.3. Existem, então, ?66

17
? = 66! (17! 49!) = ?, ?? ? ?????  

estratégias de controle possíveis, sem considerar combinações entre variáveis, o que é 
obviamente intratável.  

Tabela 5.3: Medições disponíveis para serem controladas 
Medições disponíveis 

VV,PF Vapor alimentado no PF VDest,PF Vazão de destilado no PF 

VN Vazão de nafta VL,PF Vazão de leves PF 

VÁgua,PF Vazão de água PF VFundo,PF Vazão no fundo PF 
RPF Razão de refluxo PF QC,PF Calor no condensador PF 

QF,PF Calor na fornalha do PF TC,PF Temperatura no condensador do PF 

TF,PF Temperatura da fornalha PF T2,PF Temperatura do prato 2 PF 
T3,PF Temperatura do prato 3 PF T9,PF Temperatura do prato 9 PF 

 
  



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

22 

Continuação da Tabela 5.3: Medições disponíveis para serem controladas 
Medições disponíveis 

T10,PF Temperatura de fundo PF XN ASTM D86 95% L Nafta 
XL ASTM D86 95% L Leves XFundo,PF ASTM D86 95% L Alimentação CDU 

H2OL Fração de água na Leves ?Fundo,PF Massa específica na alimentação da CDU 

HFundo,PF Entalpia na alimentação da CDU VV,CDU Vapor alimentado na CDU 
VV,CDU1 Vapor para stripping no ST1 VV,CDU2 Vapor para stripping no ST2 

VV,CDU3 Vapor para stripping no ST3 VDest,CDU Vazão de destilado no CDU 

VHN Vazão de HNafta VÁgua,CDU Vazão de água na CDU 
VK Vazão de querosene (fundo ST1) VD Vazão de diesel (fundo ST2) 

VAGO Vazão de AGO (fundo ST3) VRes ATM Vazão de resíduo atmosférico 

RCDU Razão de refluxo CDU VP1 Vazão na P1 

VP2 Vazão na P2 QP1 Calor trocado na P1 

QP2 Calor trocado na P2 QF,CDU Calor na fornalha do CDU 

QC,CDU Calor no condensador da CDU TF,CDU Temperatura da fornalha CDU 

T1,CDU Temperatura do prato 1 CDU T2,CDU Temperatura do prato 2 CDU 

T3,CDU Temperatura do prato 3 CDU T5,CDU Temperatura do prato 5 CDU 

T6,CDU Temperatura do prato 6 CDU T12,CDU Temperatura do prato 12 CDU 

T13,CDU Temperatura do prato 13 CDU T17,CDU Temperatura do prato 17 CDU 

T18,CDU Temperatura do prato 18 CDU T25,CDU Temperatura do prato 25 CDU 

Tres ATM Temperatura do resíduo atmosférico TK Temperatura do querosene 

TD Temperatura do diesel TAGO Temperatura do gasóleo atmosférico 

TT,ST1 Temperatura topo ST1 TT,ST2 Temperatura topo ST2 

TT,ST3 Temperatura topo ST3 TP1 Temperatura P1 

TP2 Temperatura P2 XRes,ATM ASTM D86 95% L Resíduo atmosférico 

XHN ASTM D86 95% L HNafta XNTotal ASTM D86 95% L NafTot 

XD ASTM D86 95% L Diesel XK ASTM D86 95% L Querosene 

XAGO ASTM D86 95% L AGO ?Res ATM Massa específica no resíduo atmosférico 

 

5.2 O t imiza çã o d o  mo delo n ã o- linea r 

O problema de otimização a ser resolvido envolve as equações 4.1 a 4.5, sendo 
aplicados os distúrbios da Tabela 4.6. O sistema foi otimizado permitindo ao software 
manipular todas as variáveis manipuladas disponíveis para otimização, presentes na 
Tabela 5.1, variando em até 20% para mais ou para menos do valor nominal. Todas as 
quatro restrições de composição foram necessariamente atendidas, vide Tabela 4.2. Os 
valores das variáveis manipuladas otimizadas em toda a faixa de distúrbios encontram-se 
no Apêndice B. 



DEQUI / UFRGS – Gustavo Borcelli Repenning 23 

5.3 A n á lise d o s g a nho s 

A primeira etapa, antes de iniciar a seleção de CVs, é verificar se alguma variável se 
manteve na restrição ao longo de toda a faixa de distúrbios. Muito provavelmente devido 
à não-linearidade do sistema, somente três variáveis se mantiveram na restrição em toda 
a faixa de aplicação do distúrbio, segundo Tabela 5.4. 

Tabela 5.4: Variáveis manipuladas na restrição 
Sigla Variável Valor Unidade Restrição 

QF,PF Calor na fornalha do PF 240 MMBtu/h Máximo 

TC,PF Temperatura no condensador do PF 136 °F Mínimo 
QF,CDU Calor na fornalha do CDU 240 MMBtu/h Máximo 

A próxima etapa foi avaliar a sensibilidade, ou ganho, do lucro frente às variáveis 
manipuladas. Através da análise do ganho foi possível identificar quatro MVs que não 
influenciam o lucro: as vazões e calores trocados nas duas bombas pumparounds (V P 1 ,  
Q P 1 ,  V P 2  e  Q P 2 ) . Assim, elas serão mantidas constantes no ponto ótimo. 

Após calcular o ganho ????? ???  das variáveis, elas foram listadas da menor variação 
para a maior. Valores pequenos de ganho das variáveis no ponto ótimo em relação aos 
distúrbios significam que elas variam menos ao longo da faixa de aplicação dos mesmos, 
permanecendo o mais próximo possível do ótimo real. Conforme metodologia proposta 
neste trabalho, essas variáveis são as mais indicadas para serem mantidas nos setpoints 
constantes. Por fim, calcula-se o ganho ??/?? para auxiliar na escolha dos pares 
manipulada-controlada e, então, as associações são feitas. Três estruturas de controle 
foram construídas, conforme mostrada na Tabela 5.5. 

Inicialmente foi criado uma primeira estrutura de controle. Ao simular esses pares no 
Aspen Plus, verificou-se um aumento ou diminuição além do permitido na alimentação de 
vapor nas stripper (VV,CDU1, VV,CDU2 e VV,CDU3); em alguns casos houve um aumento de 300% de 
alimentação de vapor, enquanto que para outros a alimentação de vapor foi zerada. Essa 
grande variação na alimentação de vapor ocorre devido ao deslocamento do perfil de 
temperatura imposta pelas mudanças de composição. A alimentação de vapor tenta 
compensar essa mudança, mas ela não é uma variável indicada para isso, pois sua vazão é 
pequena frente à alimentação de vapor principal e à alimentação de petróleo. 

Assim, um segundo grupo de CVs foi escolhido, em que a alimentação de vapor foi 
mantida no valor ótimo e as composições de diesel, querosene e gasóleo foram 
substituídas pela temperatura dos pratos de retirada. Essa substituição foi feita pois o 
ganho dessas CVs era menor que o da composição, além de que essa associação é 
operacionalmente preferível;  medições de temperaturas são mais rápidas, baratas e 
requerem menos calibração que medições de composição. Porém, também devido ao 
deslocamento do perfil de temperatura promovido pela alteração da composição, houve 
mudanças tão significativas nas vazões de saída lateral que para alguns distúrbios pratos 
da coluna secaram, e para outros atolaram. 

Então, o terceiro grupo foi selecionado, utilizando as composições dos produtos de 
saída lateral para controlar as vazões de saída. Com esse novo grupo foi possível operar a 
planta no estado estacionário, sempre mantendo as composições dentro dos limites 
estabelecidos. 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

24 

Tabela 5.5: Ganho das MVs e estruturas de controle obtidas 
MV dJ/du (%) 1º grupo de CVs 2º grupo de CVs 3º grupo de CVs 
TC,PF 104,55% Fixa - restrição Fixa - restrição Fixa - restrição 

VDest,PF 79,78% T3,PF T3,PF T3,PF 

VD 62,45% XD T13,CDU XD 

VK 34,04% XK T5,CDU XK 

VDest,CDU 18,86% T1,CDU T1,CDU T1,CDU 

VAGO 13,29% XAGO T18,CDU XAGO 

QF,PF 9,00% Fixa - restrição Fixa - restrição Fixa - restrição 

QF,CDU 4,16% Fixa - restrição Fixa - restrição Fixa - restrição 

VV,PF 1,04% T10,PF T10,PF T10,PF 

VV,CDU 0,32% T25,CDU T25,CDU T25,CDU 

VV,CDU1 0,08% T5,CDU Fixa - sem CV associável Fixa - sem CV associável 

VV,CDU2 0,04% T13,CDU Fixa - sem CV associável Fixa - sem CV associável 

VV,CDU3 0,03% T18,CDU Fixa - sem CV associável Fixa - sem CV associável 

QP1 0,01% Fixa - dJ/du pequeno Fixa - dJ/du pequeno Fixa - dJ/du pequeno 

VP1 0,00% Fixa - dJ/du pequeno Fixa - dJ/du pequeno Fixa - dJ/du pequeno 

QP2 0,00% Fixa - dJ/du pequeno Fixa - dJ/du pequeno Fixa - dJ/du pequeno 

VP2 0,00% Fixa - dJ/du pequeno Fixa - dJ/du pequeno Fixa - dJ/du pequeno 

 

5.4 A v a liaç ão d a  p er da  

O resultado da aplicação da estrutura de controle do terceiro grupo  da Tabela 5.5, é 
apresentada na Figura 5.1, juntamente com os lucros otimizados ponto a ponto, que 
seriam o resultado máximo que poderia ser obtido com um RTO perfeito. 

 

 

Figura 5.1: Curvas de lucro para estrutura de SOC e de RTO no modelo não-linear 

0.0%

0.5%

1.0%

1.5%

2.0%

2.5%

3.0%

3.5%

420.0

430.0

440.0

450.0

460.0

470.0

480.0

0 0.1 0.2 0.3 0.4

Pe
rd

a 
(%

) 

Lu
cr

o 
A

nu
al

 (
M

 U
$ 

/ 
an

o)
 

Composição (A) 

RTO SOC Perda



DEQUI / UFRGS – Gustavo Borcelli Repenning 25 

Essa estrutura de controle permitiu obter excelentes resultados, com uma perda 
média de 2,51%. Os outros dois grupos de CVs não puderam ser simulados, devido à 
secagem ou atolamento da coluna. É importante observar que a composição de nafta 
sempre se manteve dentro da especificação, mesmo sem haver um controle direto da 
mesma. Caso isso não acontecesse, seria necessário alocar uma das variáveis utilizadas no 
SOC para garantir que a composição se mantivesse dentro dos limites impostos, o que 
ocasionaria uma maior perda. 

A Figura 5.2 mostra o ganho no lucro anual quando essa mesma estrutura de controle 
auto-otimizável é usada ao invés de uma estrutura de controle padrão. As cinco 
composições dos produtos foram controladas, manipulanda a vazão das mesma 
utilizando o design spec. Devido à limitação do software, as composições são controladas 
na sua restrição, mas na prática elas poderiam ser operadas em valores abaixo da mesma, 
o que poderia resultar em maior lucro e flexibilidade operacional. 

 

 

Figura 5.2: Curvas de lucro para estrutura de SOC e estrutura de controle padrão 

 

5.5 L in ea r iza çã o d o  sist ema  

O sistema foi linearizado em torno do ponto ótimo para calcular um conjunto de CVs 
alternativo. O cálculo das matrizes G e Gd foram feitas no Aspen Plus. O sistema foi 
otimizado no ponto nominal do sistema linear para ser utilizado no cálculo das estruturas 
de controle auto-otimizáveis. 

Para determinar as melhores variáveis controladas a serem mantidas constantes, as 
CVs foram substituídas uma de cada vez por todas as medições. É necessário limitar o 
número de CVs relacionadas a cada equipamento, pois quando tal estrutura for levada 
para o modelo não-linear é necessário ter uma manipulada associada a ela. O código 
utilizado para a linearização do sistema e para a escolha das variáveis controladas 
encontra-se no Apêndice A. 

0%

10%

20%

30%

40%

50%

60%

70%

250.0

300.0

350.0

400.0

450.0

500.0

0 0.1 0.2 0.3 0.4

G
an

ho
 (

%
) 

Lu
cr

o 
A

nu
al

 (
M

 U
$)

 

Composição (A) 

Nominal SOC Ganho



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

26 

Foram selecionadas variáveis controladas segundo Tabela 5.6, as quais levaram o 
sistema a um lucro médio de 445,7 M U$/ano. Porém, os produtos ficaram fora de 
especificação para os distúrbio com valores acima do nominal. Assim, foi modificado o 
código para incluir as composições de saída das torres como variáveis controladas. Ainda 
assim, não foi possível manter as composições dentro dos limites, devido às restrições das 
variáveis manipuladas. 

Para poder calcular a perda, foi utilizado o Matlab para otimizar o sistema linear para 
toda a faixa do distúrbio, simulando um RTO perfeito. O código encontra-se no Apêndice 
A. Na Figura 5.3, é apresentado o lucro para cada estrutura de controle, onde a linha 
pontilhada representa distúrbios em que foram obtidos produtos fora de especificação. A 
presença de produtos fora de especificação explicam o porquê do SOC obter um lucro 
maior que o RTO, visto que o último sempre obteve produtos dentro dos limites 
especificados. 

 

Figura 5.3: Curvas de lucro para estrutura de SOC e de RTO no modelo linear 

A estrutura de controle calculada no modelo linear é, então, levada para o modelo 
não-linear, a fim de testar a sua efetividade em um modelo rigoroso. As variáveis 
controladas devem ser associadas a variáveis manipuladas, e para isso foram utilizados os 
ganhos  ??/?? para auxiliar na associação. Os pares encontram-se na Tabela 5.6. 

Tabela 5.6: Pares CV-MV obtida no modelo linear 
CV MV 

VN QF,PF 

VDest,PF Fixa 

T2,PF VV,PF 

TC,PF Fixa 

QF,CDU Fixa 

VV,CDU1 Fixa 

VV,CDU2 Fixa 

300.0

350.0

400.0

450.0

500.0

550.0

600.0

0 0.1 0.2 0.3 0.4

Lu
cr

o 
(M

 U
$/

an
o)

 

Composição (A) 

RTO SOC_linear



DEQUI / UFRGS – Gustavo Borcelli Repenning 27 

Continuação da Tabela 5.6: Pares CV-MV obtida no modelo linear 
CV MV 

T1,CDU QP1 

XAGO VV,CDU3 

VD Fixa 

T13,CDU VAGO 

VP1 Fixa 

VP2 Fixa 

T2,CDU VDest,CDU 

T12,CDU QP2 

TD VK 

T6,CDU VV,CDU 

 

Ao utilizar a estrutura acima proposta no modelo não-linear não foi possível simular o 
sistema, devido à secagem em pratos da coluna PF e a jet flood na coluna CDU. Mesmo 
após testar diversas variações nas MVs associadas, não foi possível simular o sistema. Isso 
ocorre devido ao fato de que as variáveis controladas calculadas no modelo linear 
possuem ganhos muito baixos em relação às variáveis manipuladas, ou seja, não são 
muito afetadas por tais MVs, dificultando o controle. Além disso, algumas CVs  
selecionados no modelo linear estão muito correlacionadas entre si. 

Devido ao insucesso de aplicação no modelo não-linear da estrutura acima descrita, 
foi utilizada a matriz de ganhos relativos (Relative gain array – RGA) para a seleção de 
pares associados, segundo Skogestad e Postlethwaite (2005). Entretanto, a mesma 
estrutura de controle foi obtida. 

 

5.6 E sp a ç o  n u lo  

A metodologia do espaço nulo também foi aplicada ao modelo linear. Inicialmente, a 
matriz sensibilidade foi calculada numericamente através do Aspen Plus. Em seguida, a 
matriz H foi obtida utilizando a função null no Matlab. A matriz H fornece diversas 
combinações lineares possíveis e deve-se escolher uma delas arbitrariamente. Por último, 
multiplica-se uma das linhas da matriz H pelas medições disponíveis, obtendo uma 
combinação linear das mesmas.  

É preciso escolher arbitrariamente quais medições serão utilizadas no método. Foram 
escolhidas dois conjuntos, um com todas as 66 medições disponíveis, e outro com apenas 
as 6 medições de temperatura da Tabela 5.6. O lucro anual de cada estrutura submetida 
aos distúrbios encontra-se na Figura 5.4. A combinação linear das medições de 
temperatura, em °F, é a seguinte: 

 ???? = 179,11 =  ? 0,217 ?2,?? + 0 ??,?? ? 0,074 ?1,??? ? 12,503 ?13,??? +
40,365 ?2,??? ? 18,962 ?12,??? + 32,335 ?6,??? (5.1) 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

28 

Como esperado, a perda foi pequena, com média de 2,26%. Surpreendentemente, o 
resultado obtido utilizando 66 variáveis foi praticamente o mesmo que usando as 6 
temperaturas. A perda com a metodologia do espaço nulo foi inferior à obtida pela 
varredura das combinações de CVs. 

 

 

Figura 5.4: Curvas de lucro para estruturas do null space e RTO 

Apesar do excelente resultado matemático, a aplicação dessa metodologia no modelo 
não-linear não é trivial e está fora do escopo deste trabalho. Sua aplicação industrial 
também é bastante limitada, devido à alta dificuldade de implementação. Manter uma 
combinação linear de variáveis em um valor constante, mantendo todas as variáveis 
dentro dos limites estabelecidos e operando a planta em condições satisfatórias, é 
praticamente utópico. Haveria, também, muita resistência por parte da operação em 
operar um sistema que não pudesse ser manipulado livremente e de difícil explicação, 
além de possível dificuldade de sintonia do controlador. Por último, seria necessário que 
todos os instrumentos funcionassem o tempo inteiro, pois se apenas um deles deixasse 
de funcionar, toda a estrutura de controle auto-otimizável estaria comprometida. 

  

300.0

350.0

400.0

450.0

500.0

550.0

600.0

0 0.1 0.2 0.3 0.4

Lu
cr

o 
($

/a
no

) 

Composição (A) 

RTO SOC - Null Space 66 variáveis SOC - Null Space 6 v ariáveis



DEQUI / UFRGS – Gustavo Borcelli Repenning 29 

6 Concl us õe s  e  Trabal hos  Fut uros  
 

Este trabalho propôs estruturas de controle auto-otimizáveis para um modelo 
rigoroso simulando uma planta de destilação atmosférica de petróleo no simulador 
comercial Aspen Plus 7.2. Para a escolha das variáveis controladas foram utilizados três 
métodos distintos: método da análise de ganhos, o qual foi proposto neste trabalho para 
aplicação em modelos complexos, análise de varredura no sistema linearizado e 
metodologia do espaço nulo, também para o sistema linearizado. 

Foi proposta uma nova metodologia heurística, baseada na análise dos ganhos das 
variáveis, para a obtenção de pares de variáveis controladas e manipuladas. Essa 
metodologia se mostrou simples e de fácil aplicação, obtendo excelentes resultados. Foi 
calculada uma perda de apenas 2,51% em relação ao ótimo, mantendo as composições 
dos produto dentro da especificação, mesmo sem um controle direto de composição da 
corrente de nafta. 

Ao linearizar o sistema foi possível a determinação do conjunto de variáveis 
controladas que levavam ao melhor lucro médio no software Matlab 2009a. Apesar de 
obter um bom lucro médio, a estrutura de controle auto-otimizável não manteve os 
produtos dentro das especificações. Também, a estrutura proposta para o modelo linear 
não foi possível de ser utilizada no modelo não-linear, visto que o modelo simplificado 
não considera diversas não-linearidades e possíveis problemas operacionais. 

A metodologia do espaço nulo foi aplicada no modelo linear, obtendo perdas médias 
bastante pequenas. Sua implementação em uma planta real e em modelos rigorosos, 
entretanto, não é trivial. 

A nova metodologia proposta é ideal para modelos complexos e plantas reais. 
Diferentemente das outras metodologias encontradas na literatura, ela tem a sua análise 
iniciada nas variáveis manipuladas, que então são associadas a controladas. Começar a 
análise pelas variáveis manipuladas permite que elas sejam associadas a controladas com 
as quais elas tenham relação próxima, proporcionando uma estrutura de controle efetiva 
e com perda média pequena. 

A utilização da metodologia proposta, porém, ainda possui alguma dificuldade de 
implementação em plantas reais. Primeiramente, é necessário haver um modelo rigoroso 
do sistema real para a obtenção dos ganhos e do ponto ótimo do sistema. Além disso, o 
alto número de medições e variáveis manipuladas disponíveis pode levar a uma estrutura 
de controle não-usual.  Por último, a estrutura de controle é projetada para uma certa 
faixa de distúrbios; não há garantias que, para distúrbios além dos limites e para 
distúrbios não considerados no estudo da síntese da estrutura, haja uma perda aceitável. 

Para trabalhos futuros, novos distúrbios podem ser considerados, assim como a 
interação entre diferentes distúrbios. Caso haja diversos distúrbios atuando ao mesmo 
tempo, a estrutura de controle não será tão facilmente determinada, pois o ganho 
????? ????  pode ser alterado significantemente, dependendo do distúrbio. 

Ainda para trabalhos futuros, é possível estudar o comportamento da estrutura de 
controle no estado transiente. O SOC pode ser considerado para transições entre grades 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

30 

e partidas de planta, visto que ele é uma estrutura de controle, algo que não pode ser 
feito para o RTO estático. 

Para ser aplicado industrialmente, seria interessante calcular o ótimo para diversos 
distúrbios utilizando o modelo não-linear e, então, modificar o setpoint das variáveis 
controladas dependendo do distúrbio, caso ele possa ser medido. Assim, seria possível 
atingir perdas menores, aproximando ainda mais o resultado econômico do controle 
auto-otimizável ao RTO usual. 

  



DEQUI / UFRGS – Gustavo Borcelli Repenning 31 

7 R e fe rê nci as  
Alstad, V.; Skogestad, S. Null Space Method for Selecting Optimal Measurement 
Combinations as Controlled Variables. Industrial &amp;amp; Engineering Chemistry 
Research, v. 46, n. 3, p. 846-853, 2007/01/01 2007. ISSN 0888-5885. 
 
Alstad, V.; Skogestad, S.; Hori, E. S. Optimal measurement combinations as 
controlled variables. Journal of Process Control, v. 19, n. 1, p. 138-148,  2009.  
 
ANP, Agência Nacional de Petróleo, Gás Natural e Biocombustíveis. Preços de 
produtores e importadores de derivados de petróleo.  2013.    
 
Arbel, A.; Rinard, I. H.; Shinnar, R. Dynamics and Control of Fluidized Catalytic 
Crackers. 3. Designing the Control System:? Choice of Manipulated and Measured 
Variables for Partial Control. Industrial &amp;amp; Engineering Chemistry Research, v. 35, 
n. 7, p. 2215-2233, 1996/01/01 1996. ISSN 0888-5885. 
  
Banco Central do Brasil. Histórico das taxas de juros. 2015. 
 
Dal Ri, C. Estudo de estruturas de controle auto-otimizáveis. 2014.  (Graduação). 
Departamento de Engenharia Química, UFRGS, Brasil. 
 
Darby, M. L.  et al. RTO: An overview and assessment of current practice. Journal 
of Process Control, v. 21, n. 6, p. 874-884,  2011.  
 
de Araújo, A. C. B.; Govatsmark, M.; Skogestad, S. Application of plantwide control 
to the HDA process. I-steady-state optimization and self-optimizing control. 
Control Engineering Practice, v. 15, n. 10 SPEC. ISS., p. 1222-1237,  2007.  
 
Edgar, T. F.; Himmelblau, D. M.; Lasdon, L. S. Optimization of Chemical Process. 2.  
McGraw-Hill, 2001.  ISBN 9780070393592. 
 
EIA, Energy Information Administration, Estados Unidos da América. Europe Brent 
Spot Price.  2015  
 
Engell, S. Feedback control for optimal process operation. Journal of Process 
Control, v. 17, n. 3, p. 203-219,  2007.  
 
François, G.; Srinivasan, B.; Bonvin, D. Use of measurements for enforcing the 
necessary conditions of optimality in the presence of constraints and uncertainty. 
Journal of Process Control, v. 15, n. 6, p. 701-712, 9// 2005. ISSN 0959-1524. 
 
Gera, V.  et al. Economic Plantwide Control of the Cumene Process. Industrial &amp;amp; 
Engineering Chemistry Research, v. 52, n. 2, p. 830-846, 2013/01/16 2013. ISSN 
0888-5885.  
 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

32 

Gros, S.; Srinivasan, B.; Bonvin, D. Optimizing control based on output feedback. 
Computers and Chemical Engineering, v. 33, n. 1, p. 191-198,  2009.  
 
Halvorsen, I. J.  et al. Optimal selection of controlled variables. Industrial and 
Engineering Chemistry Research, v. 42, n. 14, p. 3273-3284,  2003. 
 
Kariwala, V. Optimal measurement combination for local self-optimizing control. 
Industrial and Engineering Chemistry Research, v. 46, n. 11, p. 3629-3634,  2007.  
 
Kariwala, V.; Cao, Y.; Janardhanan, S. Local Self-Optimizing Control with Average 
Loss Minimization. Industrial &amp;amp; Engineering Chemistry Research, v. 47, n. 4, p. 
1150-1158, 2008/02/01 2008. ISSN 0888-5885.  
 
Kister, H. Distillation Design.   McGraw-Hill Education, 1992. 
 
Larsson, T.  et al. Self-Optimizing Control of a Large-Scale Plant: The Tennessee 
Eastman Process. Industrial &amp;amp; Engineering Chemistry Research, v. 40, n. 22, p. 
4889-4901, 2001/10/01 2001. ISSN 0888-5885.  
 
Morari, M.; Arkun, Y.; Stephanopoulos, G. STUDIES IN THE SYNTHESIS OF CONTROL 
STRUCTURES FOR CHEMICAL PROCESSES. AIChE Journal, v. 26, n. 2, p. 220-232,  
1980.  
 
More, R. K.  et al. Optimization of crude distillation system using aspen plus: Effect 
of binary feed selection on grass-root design. Chemical Engineering Research and 
Design, v. 88, n. 2, p. 121-134,  2010.  
 
Skogestad, S. Plantwide control: The search for the self-optimizing control 
structure. Journal of Process Control, v. 10, n. 5, p. 487-507,  2000.  
 
Plantwide control: Towards a systematic procedure. Proceedings of the European 
symposium on computer aided process engineering. 12: 57-69 p. 2002. 
 
Skogestad, S.; Postlethwaite, I. Multivariable Feedback Control: Analysis and 
Design.   John Wiley &amp;amp; Sons, 2005. 
 
William, L. L. Distillation Design and Control using Aspen Simulation. New York: 
John Wiley &amp;amp; Sons 2006. 
 
Ye, L.  et al. Approximating necessary conditions of optimality as controlled 
variables. Industrial and Engineering Chemistry Research, v. 52, n. 2, p. 798-808,  
2013.  
  



DEQUI / UFRGS – Gustavo Borcelli Repenning a 

A pê ndi ce  A  
 

Códi go em Fortran para o cál cul o do l ucro no As pen Pl us  

      PN=VZNAFTA+VZHNAFT 
      PK=VZKEROS 
      PD=VZDI ESEL 
      PA=VZAGO 
      PR=VZATMRES 
      PC=VZCRUDE 
       
      FS=CDUSTM+CDUSTM1+CDUSTM2+CDUSTM3+PFSTEAM 
       
      HCDU=(-CDUCOND+CDUFURN-P1HEAT-P2HEAT)*1055055*24 
      HPFL=(-PFCOND+PFFURN)*1055055*24 
       
      CTPFL=17640*((PFLD*0.3048)**1.066)*((0.80*10)**0.802) 
      CTCDU=17640*((CDUD*0.3048)**1.066)*((0.80*25)**0.802) 
      CTPFLC=7296*((-PFCOND*293.071)/(0.852*13.9))**0.65 
      CTCDUC=7296*((-CDUCOND*293.071)/(0.852*13.9))**0.65 
      CTPFLF=7296*((PFFURN*293.071)/(0.852*13.9))**0.65 
      CTCDUF=7296*((CDUFURN*293.071)/(0.852*13.9))**0.65 
       
      r=0.11 
      n=10 
      A=(r*(1+r)**n)/((1+r)**n-1) 
  
      PROD=CTCRUDE*(1.59*PN+1.37*PK+1.17*PD+1.1*PA+0.9*PR) 
      RAW=CTCRUDE*PC+CTSTM*FS 
      HEAT=(HCDU+HPFL)*4.74/(10**(6)) 
      FI XED=(CTPFL+CTCDU+CTPFLC+CTCDUC+CTPFLF+CTCDUF)*A*2 
       
      PROFI T=(PROD-RAW-HEAT)*362-FIXED 

 
Códi go para Matl ab para determi nação de SOC 

 
%Matriz ganho dy/du, 66x17 
G_base = [ ... ] 
 
%Matriz ganho dy/dd, 66x1 
Gd_base = [ ... ] 
 
%y no ponto ótimo do distúrbio nominal, 66x1 
y_opt_b = [ ... ] 
 
%u ótimo no distúrbio nominal, 66x1 
u_opt_b = [ ... ] 
 
%limite inferior de y, 66x1 
lower_y = [ ... ] 
 
%limite superior de y, 66x1 
upper_y = [ ... ] 
 
% Variáveis associadas à PF, 21x1 
CV_PF = [ ... ] 
 
% Variáveis associadas à CDU, 45x1 
CV_CDU = [ ... ] 
%Variáveis para controle de inventário, 7x1 
CV_inventario = [ ... ]; 
 
%Cálculo do lucro 

A1 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

b 

function [ lucro ] = L 
(nafta,hnafta,kerosene,diesel,ago,atmr,pfs,cdus,cdus1,cdus2,cdus3,condcdu,condpf,
forncdu,fornpf,p1heat,p2heat ) 
PFD=12.467; 
CDUD=26.246; 
CTCRUDE=59.52; 
CTSTEAM=0.00249475; 
CTNAFTA=80.004053; 
CTKEROS=85.2864582; 
CTDIESEL=97.4572532; 
CTAGO=71.3975988; 
CTATMRES=55.3317742; 
  
      PN=nafta+hnafta; 
      PK=kerosene; 
      PD=diesel; 
      PA=ago; 
      PR=atmr; 
      PC=100000; 
       
      FS=pfs+cdus+cdus1+cdus2+cdus3; 
       
     HCDU=(-condcdu+forncdu-p1heat-p2heat)*1055055*24; 
     HPFL=(-condpf+fornpf)*1055055*24; 
       
      CTPFL=17640*((PFD*0.3048)^1.066)*((0.80*10)^0.802); 
      CTCDU=17640*((CDUD*0.3048)^1.066)*((0.80*25)^0.802); 
      CTPFLC=7296*((-condpf*293.071)/(0.852*13.9))^0.65; 
      CTCDUC=7296*((-condcdu*293.071)/(0.852*13.9))^0.65; 
      CTPFLF=7296*((fornpf*293.071)/(0.852*13.9))^0.65; 
      CTCDUF=7296*((forncdu*293.071)/(0.852*13.9))^0.65; 
       
      r=0.11; 
      n=10; 
      A=(r*(1+r)^n)/(((1+r)^n)-1); 
  
      PROD=CTNAFTA*PN+CTKEROS*PK+CTDIESEL*PD+CTAGO*PA+CTATMRES*PR; 
      RAW=CTCRUDE*PC+CTSTEAM*FS; 
      HEAT=(HCDU+HPFL)*4.74/(10^(6)); 
      FIXED=(CTPFL+CTCDU+CTPFLC+CTCDUC+CTPFLF+CTCDUF)*A*2; 
       
      lucro=(PROD-RAW-HEAT)*362-FIXED; 
       
end 
 
% DETERMINAÇÃO DE SOC 
% Inicia com as MVs cte 
cv_cte = [1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 17]; 
lucro_medio_max = 0; 
lucro_max = 0; 
dist = [0 0.1 0.2 0.3 0.4]; 
% i é o número de CVs 
for i=1:17 
    % j é o número de medições 
    for j=1:66 
        % impedir duas CVs iguais 
        if any (cv_cte(:) == j) 
             
        else 
            % impedir que seja utilizado variáveis de controle de 
            % inventário 
            if any (CV_inventario(:) == j)  
                 
            else 
                % CV do PF 
                if any (CV_PF(:) == cv_cte(i)) 
                     
                    if any (CV_PF(:) == j) 
                         
                        %Matriz ganho dy/du, 17x17 

A2 



DEQUI / UFRGS – Gustavo Borcelli Repenning c 

                        G = [G_base(cv_cte(1),:); …]; 
                         
                        %Matriz ganho dy/dd, 17x1 
                        Gd = [Gd_base(cv_cte(1)); …]; 
                         
                        % Substituir o valor de G e Gd na posição i com j 
                        G(i,:) = G_base(j,:); 
                        Gd(i) = Gd_base(j); 
                         
                        lucro_soma=0; 
                         
                        for k=1:5 
                             
                        %delta_u, 17x1, calcula o valor dos disturbios 
                        delta_u(:,k) = - inv(G) * Gd * (dist(k)-dist(3)); 
                        u(:,k) = delta_u(:,k) + u_opt_b; 
 
                            % limita em upper_y e lower_y 
                            for m = 1:17 
                                if u(m,k) &gt; upper_y(m) 
                                    u(m,k) = upper_y(m); 
                                elseif u(m,k) &amp;lt;lower_y(m) 
                                    u(m,k) = lower_y(m); 
                                end 
                            end 
                             
                        %delta_y, 66x1, valor de todas medições 
                        delta_y(:,k) = G_base * (u(:,k)-u_opt_b) + Gd_base * 
(dist(k)-dist(3)); 
                        y(:,k) = delta_y(:,k) + y_opt_b; 
                             
                            for n = 1:66 
                                if y(n,k) &gt; upper_y(n) 
                                    y(n,k) = upper_y(n); 
                                elseif y(n,k) &amp;lt;lower_y(n) 
                                    y(n,k) = lower_y(n); 
                                end 
                            end 
                             
                            lucro(k)= 
L(y(34,k),y(64,k),u(9,k),u(10,k),u(11,k),y(65,k),u(1,k),u(5,k),u(6,k),u(7,k),u(8,
k),y(63,k),y(18,k),u(17,k),u(3,k),u(14,k),u(15,k)); 
                                                         
                            lucro_soma = lucro_soma + lucro(k); 
                             
                            if lucro(k) &gt; lucro_max 
                                lucro_max = lucro(k); 
                                cv_lucro_max = cv_cte; 
                                dist_lucro_max = dist; 
                            end 
                             
                        end 
                         
                        lucro_medio(j) = lucro_soma / 5; 
                         
                        if lucro_medio(j) &gt; lucro_medio_max; 
                            lucro_medio_max = lucro_medio(j); 
                            cv_cte(i) = j; 
                        end 
                         
                    end 
                    % CV da CDU 
                elseif any (CV_CDU(:) == cv_cte(i)) 
                     
                    if any (CV_CDU(:) == j) 
                         

   … 
                                                 
                    end 
                end 
            end 
        end 

A3 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

d 

    end 
end 
  
cv_cte 
lucro_medio_max 
 
 
Códi go para Matl ab para RTO 
 
%Função lucro 
function [ J ] = L_lin ( y ) 
... 
J = (PROD-RAW-HEAT)*362-FIXED; 
J = -J; 
 
%Igualdades não lineares 
function [ c, ceq ] = igualdade_nao_linear ( y ) 
c = []; 
u = [y(1);y(2); ... ]; 
 
dist = 0.2; 
  
ceq = -y+y_opt_b+G_base*(u-u_opt_b)+Gd_base*(dist-0.2); 
 
 [y, fval] = 
fmincon(@L_lin,y_nom,[],[],[],[],lower_y,upper_y,@igualdade_nao_linear) 

 
 
 
 
 
  

A4 



DEQUI / UFRGS – Gustavo Borcelli Repenning e 

A pê ndi ce  B  
 

Valores das correntes no ponto nominal.  

Resultado das correntes nominais, com os 3 design spec (nafta e diesel) 

    PETROLEO NAFTA HNAFTA QUEROSEN DIESEL AGO NAFTOT LEVES 

De     PREFLASH CDU CDU CDU CDU N+NH PREFLASH 

Para   PREFLASH N+NH N+NH           

Temperatura °C 93,3 76,7 80,1 186,1 261,0 315,5 70,7 76,7 

Pressão psia 60 39,7 15,7 21,22174 22,43913 23,3087 15,7 39,7 

Vazão volumétrica (padrão) bbl/dia 100.000 17.897 8.523 13.946 19.425 11.190 26.420   

ASTM D86 95% Líquido °C 632,0 190,6 190,6 255,5 326,7 398,3 190,0 94,1 

Vazão mássica t/dia 14942,9 2116,2 1077,2 1696,3 2282,7 1316,3 3193,3 373,7 

 

Resultado das correntes nominais, com os 3 design spec (nafta e diesel) 

    AGUA-PF AGUA-CDU OLEO-CDU RES-ATM VAP-PF VAP-CDU VAP-CDU1 VAP-CDU2 VAP-CDU3 

De   PREFLASH CDU PREFLASH CDU           

Para       CDU   PREFLASH CDU CDU CDU CDU 

Temperatura °C 76,7 80,1 227,4 340,6 204,4 204,4 204,4 204,4 204,4 

Pressão psia 39,7 15,7 44,7 24,7 60 60 60 60 60 

Vazão volumétrica (padrão) bbl/dia 280 1.210 97.239 46.786           

ASTM D86 95% Líquido °C     660,0 735,0           

Vazão mássica t/dia 47,8 206,0 12465,2 6092,0 60,0 144,0 39,6 12,0 9,6 

 

Valor das correntes no ponto ótimo 

Resultado das correntes no ponto ótimo, com as 4 restrições de composição 

    PETROLEO NAFTA HNAFTA QUEROSEN DIESEL AGO NAFTOT LEVES 

De     PREFLASH CDU CDU CDU CDU N+NH PREFLASH 

Para   PREFLASH N+NH N+NH           

Temperatura °C 93,3 57,8 85,8 190,1 265,5 325,5 57,1 57,8 

Pressão psia 60 39,7 15,7 21,22174 22,43913 23,3087 15,7 39,7 

Vazão volumétrica (padrão) bbl/dia 100.000 21.819 6.847 11.601 23.454 9.058 28.666   

ASTM D86 95% Líquido °C 632,0 177,6 200,3 248,6 326,4 386,2 187,7 70,8 

Vazão mássica t/dia 14942,9 2612,5 873,2 1402,2 2737,2 1051,7 3485,6 136,1 

 

 

 

 

B1 



Síntese de Estruturas de Controle Auto-Otimizáveis Aplicadas à Destilação Atmosférica de 
Petróleo 

f 

Resultado das correntes no ponto ótimo, com as 4 restrições de composição 

    AGUA-PF AGUA-CDU OLEO-CDU RES-ATM VAP-PF VAP-CDU VAP-CDU1 VAP-CDU2 VAP-CDU3 

De   PREFLASH CDU PREFLASH CDU           

Para       CDU   PREFLASH CDU CDU CDU CDU 

Temperatura °C 57,8 85,8 246,9 366,4 204,4 204,4 204,4 204,4 204,4 

Pressão psia 39,7 15,7 44,7 24,7 60 60 60 60 60 

Vazão volumétrica (padrão) bbl/dia 456 1.263 96.150 48.182           

ASTM D86 95% Líquido °C     663,0 734,7           

Vazão mássica t/dia 78,7 214,3 12187,7 6123,6 72,0 159,6 31,8 11,7 11,5 

 

Valores ótimos das variáveis manipuladas 

    % Petróleo A 0% 10% 20% 30% 40% 
Variável Unidade Valor nominal Ótimo Ótimo Ótimo Ótimo Ótimo 

VV,PF lb/dia 120.000 114.007 114.623 144.000 107.608 106.731 

VV,CDU lb/dia 288.000 299.844 303.646 319.120 326.824 335.631 
VV,CDU1 lb/dia 79.200 74.440 75.838 63.577 77.561 79.779 

VV,CDU2 lb/dia 24.000 23.512 23.565 23.357 23.761 23.641 

VV,CDU3 lb/dia 19.200 21.499 21.202 23.040 20.839 21.213 
VP1 bbl/dia 49.000 47.850 47.893 45.118 48.003 47.558 

VP2 bbl/dia 11.000 9.989 9.985 8.800 10.392 10.019 

QP1 MMBtu/h -40,00 -44,83 -44,54 -36,08 -42,19 -44,91 
QP2 MMBtu/h -15,00 -14,98 -14,98 -13,18 -15,01 -15,00 

QF,PF MMBTU/HR 200,0 240,0 240,0 240,0 240,0 240,0 

QF,CDU MMBTU/HR 200,0 240,0 240,0 240,0 240,0 240,0 
TC,PF F 170,0 136,0 136,0 136,0 136,0 136,0 

VDest,PF bbl/dia 20.152 22.049 21.640 22.146 21.086 20.071 

VDest,CDU bbl/dia 7.915 6.332 6.979 6.332 6.332 6.332 
VK bbl/dia 11.700 11.221 10.198 9.679 9.360 9.360 

VD bbl/dia 15.251 18.301 18.301 18.301 18.301 18.301 

VAGO bbl/dia 8.500 10.170 9.826 6.800 10.108 10.200 

VFundo,PF bbl/dia 79.899 77.893 78.311 77.816 78.884 79.910 

VFundo,CDU bbl/dia 36.528 31.872 33.012 36.705 34.786 35.720 

VÁgua,PF bbl/dia 292 384 376 450 337 324 

VÁgua,CDU bbl/dia 1.178 1.195 1.209 1.225 1.280 1.312 

VLeves,PF bbl/dia 3.674 1.605 1.590 1.502 1.539 1.589 

RPF   0,336 0,599 0,635 0,621 0,677 0,784 

RCDU   3,844 7,119 6,162 7,414 6,855 6,651 

VP bbl/dia 100.000 100.000 100.000 100.000 100.000 100.000 
 

B2 



DEQUI / UFRGS – Gustavo Borcelli Repenning g 

Valores das colunas de destilação 

Pri nci pai s  vari ávei s  das  col unas  de proj eto e no óti mo nomi nal  

    Pré-fl as h CDU 

  Uni dade Nomi nal  Óti mo Nomi nal  Óti mo 

Di âmetro da col una m 3,8 8 

Número de pratos    10 25 

Pratos    Val vul ados  (nutter float) 

Razão de refl uxo   0,339 0,620 3,553 7,414 

Cal or da fornal ha MMBtu/h 200 240 200 240 

Cal or do condens ador MMBtu/h -62,83 -93,76 -101,243 -146,78 

Pumparound 1 MMBtu/h - - -40,00 -36,08 

Pumparound 2 MMBtu/h - - -15,00 -13,18 

 

B3 


	Sumário
	Agradecimentos
	Resumo
	Lista de Figuras
	Lista de Tabelas
	Lista de Símbolos
	Lista de Abreviaturas e Siglas
	1 Introdução
	2 Revisão Bibliográfica
	2.1 Otimização
	2.2 Otimização em Tempo Real (RTO)
	2.3 Controle Auto-Otimizável
	2.3.1 Graus de liberdade para controle e otimização
	2.3.2 Implementação
	2.3.3 Seleção de variáveis controladas


	3 Metodologia
	3.1 Modelagem e otimização
	3.2 Controle Auto-Otimizável
	3.3 Metodologia proposta – Análise dos Ganhos
	3.4 Linearização do sistema
	3.5 Espaço nulo

	4 Formulação do Estudo de Caso
	4.1 Unidade de Destilação Atmosférica de Petróleo
	4.2 Modelagem
	4.3 Otimização

	5 Resultados
	5.1 Análise dos graus de liberdade
	5.2 Otimização do modelo não-linear
	5.3 Análise dos ganhos
	A próxima etapa foi avaliar a sensibilidade, ou ganho, do lucro frente às variáveis manipuladas. Através da análise do ganho foi possível identificar quatro MVs que não influenciam o lucro: as vazões e calores trocados nas duas bombas pumparounds (VP1...
	5.4 Avaliação da perda
	5.5 Linearização do sistema
	5.6 Espaço nulo

	6 Conclusões e Trabalhos Futuros
	7 Referências
	Apêndice A
	Apêndice B

</field>
	</doc>
</add>