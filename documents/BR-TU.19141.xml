<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19141</field>
		<field name="filename">26259_001065307.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

 

FUNÇÃO OBJETIVO PARA ESTIMAÇÃO DE PARÂMETROS DE 

MODELOS COM CICLO LIMITE  

DISSERTAÇÃO DE MESTRADO 

 

Leonardo Nardi Hüffner 

 

 

 

 

Porto Alegre 

2017 

  



 
 
  



 
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

 

FUNÇÃO OBJETIVO PARA ESTIMAÇÃO DE PARÂMETROS DE 

MODELOS COM CICLO LIMITE  

Leonardo Nardi Hüffner 

Dissertação de Mestrado apresentada como requisito 
parcial para obtenção do título de Mestre em 
Engenharia  

Área de concentração:  
Pesquisa e Desenvolvimento de Processos  

Linha de Pesquisa:  
Projeto, Simulação, Modelagem, Controle e 
Otimização de Processos. 

 
Orientadores: 
Prof. Dr. Jorge Otávio Trierweiler 

Prof. Dr. Marcelo Farenzena 

 
Porto Alegre 

2017 

  



 
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA QUÍMICA 

 

 

 

 

 

A Comissão Examinadora, abaixo assinada, aprova a Dissertação Função Objetivo para 
Estimação de Parâmetros de Modelos com Ciclo Limite, elaborada por Leonardo Nardi 
Hüffner, como requisito parcial para obtenção do Grau de Mestre em Engenharia. 

 

Comissão Examinadora: 

 

 

Prof. Dr. André Rodrigues Muniz - DEQUI/UFRGS 

 

Prof. Dr. Eduardo Camponogara - UFSC 

 

Profa. Dra. Viviane Rodrigues Botelho - UFCSPA 

 



 
 
 



1 
 
 
 
 

 
 
 

Resumo 
 

Muitos sistemas na natureza e na indústria são conhecidos por apresentarem 
comportamento oscilatório, como os sistemas biológicos do tipo predador-presa, 
biotecnológicos de fermentação e as golfadas na indústria de petróleo. Para fins de 
estudo de características de tais sistemas, como dinâmica, estabilidade e robustez, 
modelos matemáticos são formulados. Os parâmetros dos modelos são frequentemente 
arbitrariamente escolhidos, ou baseados em algum conhecimento prévio do sistema real 
com intuito de representar qualitativamente um comportamento desejado. No entanto, 
esta prática pode acarretar conclusões errôneas sobre a análise do sistema. Portanto, o 
objetivo deste trabalho é estudar o problema da estimação de parâmetros em sistemas 
oscilatórios, que apresentam especificamente ciclo limite.  

Em sistemas não oscilatórios, os sinais de saída possuem apenas a característica da 
forma do sinal, ou trajetória, enquanto que o sinal de saída de um sistema oscilatório 
possui, além de uma trajetória, a característica da periodicidade. A periodicidade faz com 
que o sistema repita seus valores em períodos regulares de tempo e também resulta no 
crescimento ilimitado dos índices de sensibilidade do sistema com o tempo (Lu &amp;amp; Yue, 
2012). Devido a este fato, a aplicação direta de métodos tradicionais de análise de 
sensibilidade baseados em derivada não é viável neste tipo de sistema.  

Neste trabalho, os efeitos da trajetória e da periodicidade foram desacoplados em 
três métricas que capturam características necessárias do ciclo limite: período, número 
de oscilações e somatório dos pontos médios de subida e descida dos ciclos. Através 
destas métricas, uma função objetivo é proposta para a estimação de parâmetros de 
modelos com ciclo limite. Além disso, as métricas viabilizam a análise de sensibilidade 
destes sistemas.   

Visando a obtenção de um modelo matemático para estuda do efeito da golfada em 
sistemas de produção de petróleo offshore, o estudo de caso principal deste trabalho é o 
modelo FOWM (Diehl et al., 2017). Os modelos de Lotka-Volterra e de Jöbses et al. (1986) 
também foram estudados para abordar mais ampla as métricas propostas e reforçar seu 
desempenho e aplicabilidade a outros sistemas com ciclo limite. A função objetivo 
proposta foi comparada com o método dos mínimos quadrados e com resultados 
presentes na literatura, para o modelo FOWM, através do teste de Fischer. Os resultados 
mostram a viabilidade da análise de sensibilidade com as métricas propostas e o 
desempenho superior da estimação de parâmetros utilizando a função objetivo proposta. 

 

 



2 
 
 

 
 
 

Abstract 
 

Many systems in industry and in nature are known to exhibit oscillatory behavior, 
such as the predator-prey in biological system, fermentation in biotechnological system 
and the slugs in oil industry. For purposes of studying the characteristics of such systems, 
such as dynamics, stability and robustness, mathematical models are formulated. The 
model parameters are often arbitrarily chosen, or based on some prior knowledge of the 
real system, in order to qualitatively represent a desired behavior. However, this practice 
may lead to erroneous conclusions about the system analysis. Therefore, the objective of 
this work is to study the problem of parameter estimation in oscillatory systems, which 
present limit cycle. 

In non-oscillatory systems, the output signals have only the characteristic of the shape 
of the signal, or trajectory, whereas the output signal of an oscillatory system has, in 
addition to a trajectory, the characteristic of periodicity. Periodicity means that the 
system repeats its values over regular periods of time, and also results in the unlimited 
growth of system sensitivity indices over time (Lu &amp;amp; Yue, 2012). Due to this fact, the direct 
application of traditional methods based on derivative is not feasible in this type of 
system. 

In this work, the effects of trajectory and periodicity were decoupled in three metrics 
that capture the necessary characteristics of the limit cycle: period, number of oscillations 
and sum of the average points of rise and fall of the cycles. Through these metrics, an 
objective function is proposed for the estimation of parameters of models with limit 
cycle. In addition, the metrics enable the sensitivity analysis of these systems.  

Aiming the identification of a model to describe the slug effect on the offshore oil 
production system, the main case study of this work is the FOWM model (Diehl et al., 
2017). The models of Lotka-Volterra and Jöbses et al. (1986) have also been studied to 
enable a broader approach to the proposed metrics and to reinforce their performance 
and applicability to other systems with limit cycle. The proposed objective function was 
compared with the least squares method and with results in the literature, for the FOWM 
model, through the Fischer test. The results show the feasibility of the sensitivity analysis 
with the proposed metrics and the superior performance of the parameter estimation 
using the proposed objective function. 

 

 
 
 



3 
 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

“Per aspera ad astra”. 
(-) 

 
 

  



4 
 

Agradecimentos 
 

Agradeço ao pessoal do GIMSCOP pela amizade e companhia. 

Agradeço aos orientadores Marcelo Farenzena e Jorge O. Trierweiler pelo imenso 
conhecimento compartilhado e pelo tempo investido no meu crescimento profissional. 

Agradeço ao Fábio e à Cristina, parceiros do CENPES/PETROBRAS, pelos treinamentos 
e compartilhamento contínuo de conhecimento e experiências. 

Agradeço à minha família, aos amigos, a todos aqueles que cruzaram meu caminho e 
aos que continuaram comigo. Cada um de sua forma contribuiu essencialmente para eu 
chegar até aqui. 

Por fim, agradeço à ANP pelo apoio financeiro. 

 



5 
 
  



6 
 

SUMÁRIO 
 

 Introdução ............................................................................................1 Capítulo 1 –
1.1 Objetivos do Trabalho ............................................................................................... 2 
1.2 Estrutura da Dissertação ........................................................................................... 2 

 Fundamentação Teórica ........................................................................4 Capítulo 2 –
2.1 Ciclo Limite ................................................................................................................ 4 

2.1.1 Plano de Fase ................................................................................................................... 4 
2.1.2 Bifurcação Hopf ............................................................................................................... 5 

2.2 Sistemas Biológicos e Biotecnológicos ...................................................................... 6 
2.2.1 Sistemas Biológicos .......................................................................................................... 6 
2.2.2 Sistemas Biotecnológicos ................................................................................................ 7 

2.3 Produção de Petróleo Offshore tipo Gas-lift ............................................................. 8 
2.3.1 Escoamento Multifásico .................................................................................................. 8 
2.3.2 Estrutura do Sistema de Elevação de Petróleo..............................................................10 
2.3.3 Técnica de Gas-lift .........................................................................................................11 
2.3.4 Golfadas no Sistema de Produção tipo Gas-lift .............................................................12 
2.3.5 Variáveis Medidas ..........................................................................................................14 
2.3.6 Modelagem de Sistemas de Produção de Petróleo Offshore tipo Gas-lift ....................15 

 Revisão Bibliográfica ........................................................................... 17 Capítulo 3 –
3.1 Formulação do Problema de Estimação de Parâmetros ......................................... 17 
3.2 Convexidade ............................................................................................................ 18 
3.3 Algoritmos de Otimização ....................................................................................... 19 
3.4 Estimação de Parâmetros de Modelos com Ciclo Limite ........................................ 20 
3.5 Análise de Sensibilidade de Modelos com Ciclo Limite .......................................... 22 

 Metodologia para Estimação de Parâmetros ........................................ 26 Capítulo 4 –
4.1 Formulação do Problema de Estimação de Parâmetros ......................................... 26 
4.2 Comportamento Oscilatório ................................................................................... 30 

4.2.1 Remoção do Ruído .........................................................................................................31 
4.2.2 Identificação da Frequência Fundamental do Sinal.......................................................32 

4.3 Período - ? ............................................................................................................... 33 
4.4 Número de Oscilações - ? ....................................................................................... 33 
4.5 Média - ? ................................................................................................................. 35 
4.6 Cálculo do Erro ........................................................................................................ 36 

4.6.1 Função Objetivo Proposta .............................................................................................37 
4.7 Análise de Sensibilidade .......................................................................................... 37 
4.8 Estrutura de Otimização .......................................................................................... 38 
4.9 Métricas de Desempenho das Funções Objetivo .................................................... 41 

 Aplicação dos Modelos de Lotka-Volterra e Jöbses et al. (1986) ........... 42 Capítulo 5 –
5.1 Lotka-Volterra ......................................................................................................... 42 
5.2 Jöbses et al. (1986) .................................................................................................. 43 
5.3 Análise do Plano de Fase ......................................................................................... 44 
5.4 Análise de Sensibilidade .......................................................................................... 47 

5.4.1 Análise de Convexidade .................................................................................................48 
5.5 Cenários ................................................................................................................... 52 

5.5.1 Lotka-Volterra ................................................................................................................52 
5.5.2 Jöbses et al. (1986) ........................................................................................................53 

5.6 Estimação de Parâmetros – Análise Quantitativa ................................................... 54 
5.6.1 Lotka-Volterra ................................................................................................................54 



7 
 

5.6.1.1 Cenário A ...............................................................................................................55 
5.6.1.2 Cenário B ...............................................................................................................60 
5.6.2 Jöbses et al. (1986) ........................................................................................................61 
5.6.2.1 Cenário A ...............................................................................................................61 
5.6.2.2 Cenário B ...............................................................................................................64 
5.6.2.3 Cenário C ...............................................................................................................70 

5.7 Estimação de Parâmetros – Análise Quantitativa ................................................... 72 
5.7.1 Resultados .....................................................................................................................72 

 Aplicação do Modelo de Diehl et al. (2017) .......................................... 75 Capítulo 6 –
6.1 Inicialização dos Parâmetros ................................................................................... 79 
6.2 Estudo de Caso – Poço Real .................................................................................... 80 

6.2.1.1 Análise de Sensibilidade ........................................................................................81 
5.2.1.1. Análise de Convexidade ........................................................................................82 

5.3. Estimação de Parâmetros ....................................................................................... 84 
5.3.1. Estimação de Parâmetros com pressões ???, ??? e ???? ...........................................85 
5.3.2. Estimação de Parâmetros com pressão ??? ..................................................................93 
6.2.1.2 Análise do Plano de Fase.......................................................................................96 

 Conclusões .......................................................................................... 98 Capítulo 7 –
7.1 Conclusões sobre a Função Objetivo Proposta ....................................................... 98 
7.2 Sugestões de Trabalhos Futuros ............................................................................. 99 

Referências ............................................................................................................... 100 
Apêndice A – Implementação dos Modelos ............................................................ 108 
Apêndice B – Função Objetivo ................................................................................ 112 
 
  



8 
 
  



9 
 
 

LISTA DE FIGURAS 
 
Figura 2.1: Plano de fase do modelo Van der Pol. ................................................................ 5 
Figura 2.2: Surgimento de bifurcação Hopf (Fonte: Vérri, 2013). ......................................... 6 
Figura 2.3: Padrões de fluxo vertical. (Adaptado de Jahanshahi &amp;amp; Skogestad, 2011). ......... 9 
Figura 2.4: Padrões de fluxo horizontal. (Adaptado de Jahanshahi &amp;amp; Skogestad, 2011). .. 10 
Figura 2.5: Estrutura simplificada de extração de petróleo offshore por gas-lift (Fonte: 
Gerevini, 2017). ................................................................................................................... 11 
Figura 2.6: Etapas da golfada por cabeceio anular. Líquido e gás nas cores cinza e azul, 
respectivamente (Fonte: Gerevini, 2017). .......................................................................... 13 
Figura 2.7: Etapas da golfada por onda de densidade. Líquido e gás nas cores cinza e azul, 
respectivamente (Fonte: Gerevini, 2017). .......................................................................... 14 
Figura 2.8: Etapas da golfada por acidente. Líquido e gás nas cores azul e branco, 
respectivamente (Fonte: Gerevini, 2017). .......................................................................... 14 
Figura 3.1: Conjuntos convexos e não convexos: a) convexo, b) convexo e c) não-convexo 
(Adaptado de Edgar et al., 2001). ........................................................................................ 18 
Figura 3.2: Convexidade: a) função convexa e b) função não-convexa (Adaptado de Edgar 
et al., 2001). ......................................................................................................................... 19 
Figura 3.4: Análise de sensibilidade clássica da equação de Van der Pol. .......................... 23 
Figura 4.1: Diferença de período entre dois sinais, original e alterado. ............................. 27 
Figura 4.2: Diferença de forma entre dois sinais, original e alterado. ................................ 27 
Figura 4.3: Diferença de fase entre dois sinais, original e alterado. ................................... 28 
Figura 4.4: Diferença de média entre dois sinais, original e alterado. ............................... 29 
Figura 4.5: Fluxograma simplificado da metodologia. ........................................................ 30 
Figura 4.6: Respostas oscilatórias possíveis: a) ciclo limite, b) oscilações com decaimento, 
c) oscilações caóticas e d) sem oscilações. .......................................................................... 31 
Figura 4.7: FFT das respostas oscilatórias. .......................................................................... 32 
Figura 4.8: Reconstrução de sinal com período fundamental. ........................................... 33 
Figura 4.9: Identificação de picos e vales. ........................................................................... 34 
Figura 4.10: Identificação de picos e vales com amplitude mínima  de 1,5. ...................... 35 
Figura 4.11: Identificação de zeros e remoção de média variável. ..................................... 36 
Figura 4.12: Fluxograma de otimização para a função objetivo proposta. ........................ 40 
Figura 5.1: Plano de fase para o modelo de Lotka-Volterra: a) simulação com constantes 
de reação igual a 1 e b) simulação constantes de reação igual a 2. ................................... 45 
Figura 5.2: Plano de fase para o modelo de Jöbses: a) simulação com parâmetros originais 
e b) simulação com variação de 50% nos parâmetros originais. ........................................ 46 
Figura 5.3: Índices de sensibilidade total do modelo de Lotka-Volterra. ........................... 47 
Figura 5.4: Índices de sensibilidade total do modelo de Jöbses et al. (1986). ................... 48 
Figura 5.5: Função objetivo do MMQ para: a) Lotka-Volterra e b) Jöbses et al. (1986), 
demonstrando a convexidade do problema. ...................................................................... 49 
Figura 5.6: Função objetivo proposta para: a) Lotka-Volterra e b) Jöbses et al. (1986), 
demonstrando a convexidade do problema. ...................................................................... 51 
Figura 5.7: Dados de referência do modelo Lotka-Volterra com ruído branco. ................. 53 
Figura 5.8: Perturbação na variável ??0. ............................................................................ 54 
Figura 5.9: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 1 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 55 



10 
 
Figura 5.10: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 56 
Figura 5.11: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com  o Conjunto 3 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 56 
Figura 5.12: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 4 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 57 
Figura 5.13: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com  o Conjunto 1 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 58 
Figura 5.14: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com  o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 58 
Figura 5.15: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com o Conjunto 3 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 59 
Figura 5.16: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com o Conjunto 4 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 59 
Figura 5.17: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário B com o Conjunto 4 como chute inicial. Figuras a) e b) 
apresentam os estados ? e ?, respectivamente. ................................................................ 60 
Figura 5.18: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 1 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 62 
Figura 5.19: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 62 
Figura 5.20: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 3 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 63 
Figura 5.21: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com o Conjunto 1 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 65 
Figura 5.22: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com  o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 65 
Figura 5.23: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com o Conjunto 3 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 66 
Figura 5.24: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com o Conjunto 1 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 68 
Figura 5.25: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com  o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 68 



11 
 
Figura 5.26: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com o Conjunto 3 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 69 
Figura 5.27: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário C com o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 71 
Figura 5.28: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário C com o Conjunto 2 como chute inicial. Figuras a) e b) 
apresentam os estados ?? e ??, respectivamente. ........................................................... 71 
Figura 5.29: Conjuntos de parâmetros iniciais. Conjuntos da Região A são representados 
por “×”, Região B por “?” e o conjunto ótimo por “*”........................................................ 72 
Figura 6.1: Representação do sistema Reservatório-Poço-Linha de Produção em sistemas 
offshore. (Reservatório – Preto; Poço – Verde; e Linha de Produção – Azul). .................... 76 
Figura 6.3: Índices de sensibilidade total do modelo FOWM. ............................................ 82 
Figura 6.4: Convexidade do modelo FOWM através do MMQ. .......................................... 83 
Figura 6.5: Convexidade do modelo FOWM através da FP. ................................................ 84 
Figura 6.6: Resultado da estimação de parâmetros para o Poço A utilizando BOBYQA 
através de três pressões medidas: a) pressão PDG, b) pressão TPT e c) pressão PRT. ....... 87 
Figura 6.7: Resultado da estimação de parâmetros para o Poço A utilizando DIRECT 
através de três pressões medidas: a) pressão PDG, b) pressão TPT e c) pressão PRT. ....... 89 
Figura 6.9: Resultado da estimação de parâmetros para o Poço A apresentados na 
literatura por Diehl et al. (2017) e Apio (2017): a) pressão PDG, b) pressão TPT e c) 
pressão PRT ......................................................................................................................... 92 
Figura 6.10: Resultado da estimação de parâmetros para o Poço A utilizando DIRECT 
através de uma pressão medida: a) pressão PDG, b) pressão TPT e c) pressão PRT. ......... 95 
Figura 6.2: Plano de fase do Poço A. ................................................................................... 97 
 
 
  



12 
 
  



13 
 

LISTA DE TABELAS 
 
Tabela 3.1: Comparativo entre técnicas de Análise de Sensibilidade Global (Adaptado de 
Zhang et al., 2015) ............................................................................................................... 25 
Tabela 5.1: Valores dos parâmetros do modelo de Jöbses et al. (1986). ........................... 44 
Tabela 5.2: Conjuntos de chutes iniciais para os parâmetros do modelo Lotka-Volterra. . 55 
Tabela 5.3: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário A utilizando BOBYQA. ......................................................... 57 
Tabela 5.4: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário A utilizando DIRECT. ........................................................... 60 
Tabela 5.5: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário B utilizando DIRECT. ........................................................... 61 
Tabela 5.6: Conjuntos de chutes iniciais para os parâmetros do modelo Jöbses et al. 
(1986). .................................................................................................................................. 61 
Tabela 5.7: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do 
modelo de Jöbses et al. (1986) para o Cenário A utilizando BOBYQA. ............................... 64 
Tabela 5.8: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do 
modelo de Jöbses et al. (1986) para o Cenário B utilizando BOBYQA. ............................... 67 
Tabela 5.9: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do 
modelo de Jöbses et al. (1986) para o Cenário B utilizando DIRECT. ................................. 70 
Tabela 5.10: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do 
modelo de Jöbses et al. (1986) para o Cenário C utilizando MMQ. .................................... 72 
Tabela 5.11: Índices de desempenho da função objetivo proposta. .................................. 73 
Tabela 5.12: Índices de desempenho do método dos mínimos quadrados. ...................... 73 
Tabela 6.1: Batimetria do Poço A e valores iniciais dos parâmetros a serem estimados. . 81 
Tabela 6.2: Parâmetros estimados e intervalos de confiança para o Poço A através de três 
pressões medidas utilizando BOBYQA. ............................................................................... 90 
Tabela 6.3: Parâmetros estimados e intervalos de confiança para o Poço A através de três 
pressões medidas utilizando DIRECT. .................................................................................. 90 
Tabela 6.4: Parâmetros estimados e intervalos de confiança para o Poço A encontrados 
na literatura. ........................................................................................................................ 92 
Tabela 6.5: Parâmetros estimados e intervalos de confiança para o Poço A através da 
pressão PRT. ........................................................................................................................ 96 



14 
 
  



15 
 

NOTAÇÃO E SIMBOLOGIA 
 

? Área da seção transversal do Riser 
ANM Árvore de Natal Molhada 
AMPc Monofosfato cíclico de adenosina 
? Termo de amortecimento não-linear do modelo de Van der Pol  
?? Concentração do componente chave 
??0 Concentração de alimentação do componente chave 
?? Coeficiente de vazão da válvula virtual 
???? Coeficiente de vazão da válvula de produção 
?? Concentração de produto 
??0 Concentração de alimentação do produto 
?? Concentração de substrato 
??0 Concentração de alimentação de substrato 
?? Concentração de biomassa 
??0 Concentração de alimentação de biomassa 
? Qualidade da solução 
? Variância da função objetivo 
?? Diâmetro do anular 
?? Taxa de diluição 
?? Diâmetro do Tubing 
? Componente chave 

EA Equações Algébricas 
EDO Equações Diferenciais Ordinárias 
E&amp;amp;P Extração e Produção de Petróleo 
? Função genérica 
?0 Condição inicial genérica 

FAST Análise de Sensibilidade da Amplitude de Fourier 
FFT Transformada Rápida de Fourier 

FOWM Fast Offshore Well Model   
FP Função objetivo proposta 

FPSO Floating Production Storage and Offloading 
? Aceleração gravitacional 
g Restrição temporal de igualdade 
? Restrição temporal de desigualdade 

???? Distância do leito do mar até o medidor de pressão no Tubing 
?? Comprimento do Tubing 
???? Distância do leito do mar ao ponto de injeção 
?1 Taxa de reprodução da população de presas 
?2 Taxa per capita do consumo de presas 
?3 Taxa de mortalidade dos predadores 
?4 Taxa de biomassa de presas convertida em biomassa de predadores 



16 
 

?? Coeficiente de vazão da válvula de injeção 
?? Constante de vazão do reservatório 
?? Constante de Monod 
?? Constante da válvula Venturi 
?? Coeficiente de vazão da válvula da ANM 
?? Comprimento do anular 
?? Comprimento do Tubing 
M Massa molar do gás de elevação 
?ga Massa de gás no anular 
??? Massa de gás acumulada na bolha à montante da válvula virtual 
??? Massa de gás no Riser 
??? Massa de gás no Tubing 
??? Massa de líquido no Riser 
??????? Acúmulo mínimo de massa de líquido a montante da inflexão 
??? Massa de líquido no Tubing 
?? Fator de manutenção baseado na formação de produto 
?? Fator de manutenção baseado na formação de substrato 

MMQ Método dos mínimos quadrados 
MMQP Método dos Mínimos Quadrados Ponderados 
MPSA Análise de Sensibilidade Multiparamétrica 
MSDE Erro quadrático da derivada  
MSDP Erro quadrático do período 

NA Número de avaliações 
NP Número de problemas 
?? Número de variáveis de entrada do sistema  
?? Número de parâmetros livres 
?? Número de variáveis temporais 
?? Número de variáveis de estado 
?? Número de variáveis algébricas  
? Vetor de parâmetros livres a serem estimados 
?? Vetor de limites inferiores das variáveis temporais 
?? Vetor de limites superiores das variáveis temporais 
P Produto 
??? Pressão no ponto de injeção de gás de elevação no anular 
??? Pressão no fundo do poço 
??? Pressão da bolha à montante do ponto de inflexão 
???? Pressão do PDG 

Pr Pressão no reservatório 
??? Pressão à jusante da válvula virtual 
??? Pressão no topo do Riser 
Ps Pressão no Separador 
??? Pressão no ponto de injeção de gás de elevação no Tubing 
??? Pressão na ANM (topo do Tubing) 



17 
 

PDG Permanent Downhole Gauge 
PRCC Coeficiente de Correlação de Ranque Parcial 
PRT Sensor de pressão de topo do Riser 
PS Sensor de pressão do separador 
? Constante universal dos gases 

RMSE Método da Raiz Quadrada do Erro Quadrático Médio 
?1 Constante da taxa de reação 
?2 Constante da taxa de reação 
?3 Constante da taxa de reação 
? Sensibilidade do parâmetro 
?. ?. Sujeito a 

S Substrato 
? Matriz de sensibilidade 

SVD Decomposição em valores singulares 
t Tempo 
?0 Tempo inicial 
?? Tempo final 
T Tempo computacional 

TPT Temperature and Pressure Transdutor 
? Vetor de variáveis de controle 
? Vetor de variáveis temporais 
?? Vetor de limites inferiores das variáveis temporais 
?? Vetor de limites superiores das variáveis temporais 
?? Volume do anular 
??? Volume da bolha acumulado à montante da válvula virtual 
??? Volume do gás no Tubing 
?? Volume do Riser 
?? Volume do Tubing 
X Biomassa 
??? Fluxo de massa de gás saindo através da válvula de injeção no anular 
Wg Fluxo mássico de gás através da válvula virtual; 
??? Fluxo de massa de gás entrando através da válvula de injeção no anular 
???? Fluxo de produção através da choke de produção 
?? Fluxo de produção do reservatório 
??? Fluxo mássico de produção através da ANM. 

WALS Média Ponderada da Análise de Sensibilidade Local 
?. ?. ?. Com respeito a 
? Variável algébrica genérica 
?1 Variável de estado do modelo de Van der Pol 
?2 Variável de estado do modelo de Van der Pol 
?? Variável algébrica genérica simulada 
?? Variável algébrica genérica medida 
??? Fator de rendimento da conversão de biomassa em produto 

https://pt.wikipedia.org/wiki/Decomposi%C3%A7%C3%A3o_em_valores_singulares


18 
 

??? Fator de rendimento da conversão de substrato em biomassa 
? Abertura da choke 
? Vetor de pontos médios dos ciclos 
??? Fração de gás presente no Pipeline-Riser. 
??? Fração de gás presente no Riser 
??? Fração de gás no Tubing 
??? Fração de gás no reservatório 
? Eficácia 
? Fração de gás de by-pass pela “válvula virtual” 
? Precisão do computador 
? Qualidade da solução obtida 
? Função objetivo do problema de otimização 
?0 Média da função objetivo 
? Parâmetro de penalidade da função objetivo 
? Robustez 
? Número de oscilações 
??? Massa específica do gás no anular 
?L Massa específica do óleo produzido 

????? Massa específica da mistura no reservatório 
??? Massa específica do óleo no Tubing 
? Conjunto de números reais 
? Período 
? Parâmetro de peso da função objetivo 
? Variável de estado genérica 
??? Derivada de primeira ordem 
? Eficiência 
? Fator de amortecimento responsável por identificar o ponto Hopf 
  
  
  

 

 
 
  



 
 

 Introdução Capítulo 1 –

Nos campos da biologia e da biotecnologia predominam os aparecimentos de 
comportamentos oscilatórios com ciclo limite. Um grande número de sistemas apresenta 
este tipo de comportamento, incluindo o ciclo celular (Evans et al., 1983), o ritmo 
circadiano (Dunlap, 1999), a glicólise (Hess &amp;amp; Boiteux, 1971), a produção de AMPc 
(Gerisch et al., 1975) e a fermentação (Wang et al., 2014, Daugulis et al., 1997, McLellan 
et al. 1999 e Jöbses et al. 1986). Segundo Siong (2009), apesar dos sistemas possuírem 
modelos matemáticos, metodologias de estimação de parâmetros não são comumente 
aplicadas. Enquanto alguns parâmetros são disponíveis através de medições, a maioria 
não é. Por isso, os parâmetros são frequentemente escolhidos de forma a forçar com que 
a saída do modelo capture o comportamento qualitativo dos dados experimentais. 

No campo de exploração e produção (E&amp;amp;P) de petróleo é decorrente o aparecimento 
do efeito chamado de golfada. A golfada é um efeito característico da produção de 
petróleo quando o poço é operado através da técnica de gas-lift, sendo proveniente do 
regime de escoamento multifásico do sistema através da tubulação e caracterizada pelo 
fluxo intermitente de líquido seguido de ondas de gás. As golfadas ocasionam grandes 
oscilações de pressão no sistema, afetando diretamente a produtividade, a vida útil e a 
segurança das instalações. Pequenas perturbações no sistema podem causar uma 
mudança drástica de comportamento do fluxo, levando à ocorrência de golfadas. Di 
Meglio et al. (2009) formula um modelo para capturar a dinâmica oscilatória do sistema e  
confirma a existência de ciclo limite utilizando o critério Pointcaré-Bendixson (Khalil, 
2002). Outros autores, como Jahanshahi et al. (2013), Jahanshahi &amp;amp; Skogestad (2013), 
Storkaas et al. (2003) e Diehl et al. (2017) apresentam modelos matemáticos para 
representar estruturas de produção de petróleo operadas com gas-lift. Assim como para 
sistemas biológicos e biotecnológicos, nestes casos o emprego de técnicas de estimação 
de parâmetros não é definido, sendo os parâmetros aproximados por cálculos teóricos ou 
estimados de maneira a obter uma solução oscilatória satisfatória, quando algum indício 
do procedimento de estimação de parâmetros é apresentado. 

 Portanto, na produção de petróleo offshore tipo gas-lift, a produção é operada de 
duas maneiras: 1) em regime oscilatório, ou 2) em pontos de operação de baixa eficiência 
de produção com o intuito de evitar o regime oscilatório. Este é um problema que vem 
sendo estudado ao longo do tempo e uma das soluções mais promissoras para que a 



1.1 Objetivos do Trabalho 2 
 
produção seja otimizada, sem que ocorram golfadas, é a aplicação de controle preditivo 
não-linear (Gerevini, 2017). No entanto, para que esta solução seja viável, é necessário 
que um modelo matemático representativo do sistema seja desenvolvido (Biegler, 2009). 
Neste cenário, um ponto crucial é a etapa de estimação de parâmetros do modelo, uma 
tarefa complexa dada a presença de ciclo limite.  

 A aplicação de metodologias clássicas, como o caso do método dos mínimos 
quadrados, na resolução do problema de estimação de parâmetros de modelos que 
descrevem o processo de produção de petróleo offshore tipo gas-lift é complexo. Isto 
ocorre, visto que problemas desta natureza apresentam múltiplos mínimos locais (Apio et 
al., 2017). A metodologia clássica pode vir a convergir em dois cenários: 1) há, de 
antemão, um bom conhecimento do estado inicial do sistema e do valor dos parâmetros 
a serem estimados, difícil de ocorrer na prática, ou 2) fazendo uso de algoritmos globais 
de otimização, os quais tem alto custo computacional. Além disso, dada a existência de 
ciclo limite, a análise de sensibilidade convencional não é aplicável. Portanto, uma nova 
metodologia de estimação de parâmetros deve ser desenvolvida para que o problema se 
torne menos não convexo, viabilizando a análise do sistema e a obtenção de um conjunto 
de parâmetros ótimos. Isto é feito através de uma nova função objetivo para estimação 
de parâmetros. Assim, é possível posterior aplicação do modelo para controle e 
otimização da produção de petróleo.  

1.1 Objetivos do Trabalho 
O objetivo deste trabalho é investigar e realizar, através da proposta de uma nova 

função objetivo, a estimação de parâmetros em sistemas com ciclo limite. A metodologia 
desenvolvida busca estimar os parâmetros através da redução da não convexidade do 
problema, obtida pela utilização de uma função objetivo composta por métricas que 
capturem o comportamento oscilatório do sistema. Isto possibilita a utilização de 
algoritmos determinísticos de otimização e quebra o paradigma do uso do método dos 
mínimos quadrados clássico em problemas de estimação de parâmetros. Apesar da 
motivação e estudo de caso principais serem a produção de petróleo offshore tipo gas-
lift, a metodologia é genérica e aplicável a casos gerais de sistemas que apresentam ciclo 
limite, como são os casos do modelo de fermentação (Jöbses et al., 1986) e predador-
presa (Lotka (1925) e Volterra (1926)), também abordados neste trabalho. 

1.2 Estrutura da Dissertação 
Este trabalho é dividido em seis capítulos. Na introdução, a problemática geral do 

tema foi apresentada, abrangendo a motivação para realização deste estudo, seus 
objetivos e a estrutura do trabalho. 

No Capítulo 2 são apresentados, com uma visão mais ampla, sistemas onde há 
presença de ciclo limite, abordando características, motivos de ocorrência e modelos 
matemáticos propostos. No Capítulo 3é apresentado o que tem sido estudado na 
literatura para solucionar o problema de estimação de parâmetros. Partindo-se deste 
último ponto, no Capítulo 4 é apresentada a as métricas propostas neste trabalho para 
formulação da análise de sensibilidade e da função objetivo para o problema de 
estimação de parâmetros, incluindo os critérios do modelo, o tratamento de dados, as 
propriedades do ciclo limite e a formulação do problema de otimização. 



1.2 Estrutura da Dissertação 3 
 

O Capítulo 5 é destinado à aplicação da metodologia aos modelos Lotka-Volterra e de 
fermentação. Os modelos são descritos e a metodologia é aplicada para diferentes 
cenários simulados e os respectivos resultados são apresentados. No Capítulo 6, o 
modelo FOWM (Diehl et al., 2017),  é descrito e a metodologia é aplicada.  

O Capítulo 7 apresenta as considerações finais, conclusões da pesquisa e sugestões 
para trabalhos futuros. 

  



 
 

 Fundamentação Teórica Capítulo 2 –
Este capítulo apresenta uma revisão sobre ciclo limite no que tange à caracterização e 

ocorrência, um histórico de sistemas que apresentam tal fenômeno e sua importância. 

2.1 Ciclo Limite 

Muitos processos industriais apresentam comportamento dinâmico oscilatório. A 
teoria do ciclo limite, introduzida por Henri Poincaré em 1880, tem sido utilizada para 
modelar o comportamento de determinados sistemas oscilatórios. Um ciclo limite é uma 
trajetória fechada em um plano de fase bidimensional onde ao menos outra trajetória 
espira dentro desta ao passo que o tempo tende para o infinito. Ainda, segundo Seydel 
(2010), um ciclo limite é uma solução periódica que ocorre em sistemas de equações 
diferenciais não lineares onde, depois que certo período de tempo é transcorrido, os 
valores da solução de uma órbita periódica são os mesmos. Um exemplo de sistema com 
ciclo limite é o oscilador de Van der Pol (Slotine &amp;amp; Li, 1991): 

 
??1
??

= (1 ? ?22)?1 ?  ?2 + ? (2.1) 

 
??2
??

= ?1 (2.2) 

O sistema descrito pela Equação 2.1 e Equação 2.2 representa um oscilador com um 
termo de amortecimento não-linear, ?, que é o parâmetro que governa a não linearidade 
e o amortecimento, ou em termos práticos, a característica oscilatória do sistema.  

Ciclos limite representam um papel importante em sistemas não lineares. Eles 
ocorrem em diferentes áreas da engenharia e da natureza. É importante que se saiba 
como suprimir a oscilação, ou como amplificá-la, de acordo com a necessidade. Para isso, 
é necessário que suas características sejam estudadas para posterior manipulação do 
comportamento (Slotine &amp;amp; Li, 1991). 

2.1.1 Plano de Fase 

Um plano de fase é uma representação geométrica da estrutura orbital de um sistema 
dinâmico. O plano de fase é utilizado como ferramenta para análise de propriedades 
qualitativas do sistema (Medio &amp;amp; Lines, 2001). Através dele, pode-se estudar o 
comportamento transiente do sistema no domínio do tempo, consistindo em um gráfico 
bidimensional entre duas variáveis de estado, baseado em um estado inicial e, no caso de 



2.1 Ciclo Limite 5 
 
um modelo matemático, também no valor dos parâmetros (Bequette, 1998). Portanto, é 
possível analisar a convergência do sistema em relação as suas variáveis. A Figura 2.1 
apresenta o plano de fase para o oscilador de Van der Pol. 

 

Figura 2.1: Plano de fase do modelo Van der Pol. 

Conforme ilustrado na Figura 2.1, para valores de ? iguais a 0 e 1, as espirais 
representam as fases transientes, partindo-se da condição inicial, e os estados 
estacionários finais do sistema são as órbitas fechadas, quando o ciclo limite está 
formado. Para os demais valores de ?, o sistema atinge o valor estacionário não 
oscilatório, portanto, a órbita fechada não é formada. 

2.1.2 Bifurcação Hopf 

A teoria da Bifurcação Hopf explica a ocorrência do ciclo limite. À medida que ao 
menos um parâmetro do vetor ? de parâmetros do modelo matemático do sistema 
dinâmico não linear é alterado, a estabilidade do ponto de equilíbrio pode mudar. Os 
valores destes parâmetros que provocam estas mudanças de equilíbrio são chamados de 
valores de bifurcação. A mudança quantitativa no valor dos parâmetros que leva a uma 
mudança qualitativa no comportamento do sistema é base da teoria de bifurcação 
(Slotine &amp;amp; Li, 1991). O caso específico de bifurcação, onde o sistema passa de um estado 
estacionário estável para um ciclo limite, é chamado de bifurcação Hopf (Medio &amp;amp; Lines, 
2001).  

A bifurcação Hopf ocorre quando a parte real dos autovalores, proveniente da matriz 
Jacobiana do modelo linearizado, é anulada em função de um parâmetro pertencente a 
?. Portanto, para ocorrer bifurcação Hopf, os autovalores devem necessariamente ser 
complexos, isto é, ? ± ??. Neste caso, o equilíbrio é estável para ? &amp;lt;0 e instável para 
? &gt; 0, existindo a bifurcação em ? = 0 (Apio et al., 2017). Para um parâmetro ? ? ?, 



2.2 Sistemas Biológicos e Biotecnológicos 6 
 
como mostrado na Figura 2.2, eventualmente há o surgimento de bifurcação Hopf e o 
sistema converge para um ciclo limite. 

 

Figura 2.2: Surgimento de bifurcação Hopf (Fonte: Vérri, 2013). 

Vários autores, dentre eles Guckenheimer et al. (1997), Meerbergen &amp;amp; Spence (2010), 
Elman et al. (2012), Govaerts (2000) e Apio et al. (2017), sugerem diferentes abordagens 
para o cálculo e detecção da bifurcação Hopf, além do original Teorema de Hopf (1942). 

2.2 Sistemas Biológicos e Biotecnológicos 
Nesta seção será abordada a ocorrência de ciclo limite em sistemas biológicos e 

biotecnológicos, apresentando os principais casos e os estudos existentes na literatura.  

2.2.1 Sistemas Biológicos 

A modelagem de sistemas biológicos é uma tarefa importante e muitas vezes 
complexa, devido à profunda conexão entre os processos celulares envolvidos. A biologia 
sistêmica é o ramo da biologia designada ao estudo computacional e matemático para 
modelagem de sistemas biológicos (Klipp et al., 2005; Cedersund &amp;amp; Knudsen, 2005; 
Ashyraliyev et al., 2009). Modelos matemáticos para representação destes sistemas têm 
sido formulados e estudados ao longo dos anos, como os modelos do ritmo circadiano da 
Drosophila de Goldbeter (1995) e de Tyson et al. (1999), o modelo de Tavares (2008) para 
a degradação da glicose e o modelo do processo de predação de Lotka (1925) e Volterra 
(1926), por exemplo. 

O modelo predador-presa de Lotka (1925) e Volterra (1926), também chamado de 
Lotka-Volterra, é bastante difundido na literatura por ter sido o precursor da ideia de 
investigar as relações entre predadores e presas. O modelo foi proposto para descrever 
um sistema que se auto sustentaria por tempo indeterminado gerando ciclos periódicos. 
O modelo descreve a recorrência temporal para o sistema predador-presa em tempo 
contínuo. No instante em que não há mais presa disponível, a população de predador 
começa a diminuir e só volta a aumentar ao passo que a presa se torna novamente 
disponível, levando à nova redução desta. O modelo é estudado, por exemplo, por Vérri 
(2013), onde o autor analisa a estabilidade global e a bifurcação Hopf do modelo para 
posterior aplicação dos resultados em um modelo de HIV. Battel et al. (2012) estuda 
efeitos da aplicação de inseticidas e avalia o comportamento dinâmico resultante dessa 



2.2 Sistemas Biológicos e Biotecnológicos 7 
 
aplicação em presas e predadores ou hospedeiros e parasitoides através do modelo de 
Lotka (1925) e Volterra (1926). 

Mais recentemente, Wang &amp;amp; Liu (2017) propuseram um modelo para infecção pelo 
vírus Chikungunya e realizaram um estudo de estabilidade e bifurcação Hopf, dada a 
existência de ciclo limite no sistema. 

2.2.2 Sistemas Biotecnológicos 

Na biotecnologia, a predominância de estudos relacionados à ocorrência de ciclo 
limite está nos processos de fermentação. Diehl (2009), Zhang &amp;amp; Henson (2001) e 
Gambarato &amp;amp; Oliveira (2011) estudam a fermentação alcoólica da bactéria Zymomonas 
mobilis, importante devido ao seu metabolismo único e suas eficientes características 
fermentativas na produção de etanol a partir de açúcares simples. Um fato observado em 
fermentações alcoólicas contínuas utilizando Zymomonas mobilis é a ocorrência de 
oscilações nas concentrações de substrato, biomassa e produto em certas condições de 
fermentação.  

Todos os autores supracitados estudam a multiplicidade de equilíbrio do processo de 
fermentação da Zymomonas mobilis através da análise de bifurcação do sistema. Zhang &amp;amp; 
Henson (2001) e Gambarato &amp;amp; Oliveira (2011) fazem o estudo do sistema através do 
modelo proposto por Daugulis et al. (1997), enquanto que Diehl (2009) utiliza o modelo 
proposto por Jöbses et al. (1986). Além da análise de multiplicidade de equilíbrio da 
fermentação da Zymomonas mobilis, Diehl (2009) analisa o problema de controle e 
otimização de um biorreator contínuo de síntese de etanol pela bactéria através do 
modelo de Jöbses et al. (1986).  

A fermentação da bactéria Klebsiella pneumoniae para produção de Propan-1,3-diol 
também apresenta ocorrência de oscilações nas concentrações de substrato, biomassa e 
produto. Propan-1,3-diol é uma matéria matéria-prima bastante utilizada na indústria 
química para a produção de poliésteres, poliéteres e poliuretanos. Sun et al. (2008) e 
Wang et al. (2014) investigaram o problema e propuseram modelos para análise e 
otimização do processo de fermentação da bactéria. A bactéria Saccharomyces cerevisiae 
é também alvo de muitos estudos devido à sua importância na indústria de alimentos. 
(Zamamiri et al. 2001) realiza experimentos sob diferentes condições operacionais de um 
biorreator para avaliar a influência das configurações de inicialização do biorreator no 
equilibro final do processo de fermentação da bactéria. Zhang &amp;amp; Henson (2001) estudam 
a multiplicidade de equilíbrio do processo de fermentação da Saccharomyces cerevisiae 
através da análise de bifurcação do sistema, utilizando o modelo proposto por Jones &amp;amp; 
Kompala (1999). Zhang &amp;amp; Henson (2001) apresentam ainda o mesmo estudo para o 
cultivo celular de Hibridomas, utilizadas para produção de anticorpos, utilizando o 
modelo de Guardia et al. (2000).  

De maneira geral, os referidos autores estudam a multiplicidade de equilíbrio dos 
sistemas frente à alteração de parâmetros do modelo matemático ou do processo em si, 
mostrando a complexidade de sistemas que apresentam ciclo limite e ao mesmo tempo a 
capacidade dos modelos matemáticos em representar tais sistemas. Além disso, fica 
evidente a relevância do estudo de sistemas oscilatórios que apresentam ciclo limite na 
área da biologia e da biotecnologia, tendo em vista a quantidade de processos que 
apresentam tal comportamento e a sua importância socioeconômica.  



2.3 Produção de Petróleo Offshore tipo Gas-lift 8 
 

2.3 Produção de Petróleo Offshore tipo Gas-lift 
Nesta seção é abordada de maneira específica o sistema de produção de petróleo 

offshore tipo gas-lift e a ocorrência de ciclo limite através do padrão de escoamento 
golfante. A golfada tem sido reconhecida como um problema sério na produção de 
petróleo offshore, pois o fluxo oscilatório pode causar danos operacionais nos 
separadores, devido ao excesso de líquido e alta pressão, no módulo de compressão, 
devido à carga de gás, e na curva de produção (Pedersen et al., 2015). 

No início da vida produtiva dos reservatórios de petróleo, a elevação da mistura 
multifásica (óleo, água e gás) ocorre normalmente devido à energia do próprio 
reservatório. Neste estágio, os poços são chamados de “poços surgentes”. A pressão do 
reservatório é suficiente para conduzir o fluxo multifásico até a plataforma. No entanto, 
ao longo do tempo a pressão do reservatório reduz e se torna insuficiente para promover 
a elevação. Desta maneira, é necessária a implementação de algum método de elevação 
artificial (Guo et al., 2007).  

Dentre as técnicas artificiais de elevação, a técnica de gas-lift é a mais utilizada, sendo 
aplicada em mais de 70% da produção brasileira (Filho, 2011). A técnica consiste em 
injetar gás natural à alta pressão na base da coluna de produção, diminuindo a pressão 
hidrostática da mistura, facilitando e aumentando a vazão de óleo proveniente do 
reservatório. 

2.3.1 Escoamento Multifásico  

O fluxo proveniente do reservatório é constituído principalmente de uma mistura de 
água, gás, óleo e areia. O tipo de escoamento nas tubulações é, portanto, multifásico e 
seu comportamento depende da natureza hidrodinâmica das fases envolvidas e da 
geometria do sistema (Sivertsen et al., 2010). Desta maneira, o padrão de escoamento 
depende das velocidades superficiais de líquido e gás e do sentido e inclinação do fluxo 
(horizontal ou vertical), influenciando de forma drástica a operação do processo 
produtivo. 

Escoamento Multifásico Vertical 

Existem quatro padrões de fluxo para o escoamento multifásico vertical: bolha, 
golfada, transição e anular-nevoeiro, os quais estão representados na Figura 2.3. 



2.3 Produção de Petróleo Offshore tipo Gas-lift 9 
 

 

Bolha 

 

Golfada 

 

Transição 

 

anular-nevoeiro 

Figura 2.3: Padrões de fluxo vertical. (Adaptado de Jahanshahi &amp;amp; Skogestad, 2011). 

No padrão tipo bolha, a tubulação está praticamente cheia de líquido, que é a fase 
contínua neste padrão. A fase gasosa está presente através de pequenas bolhas 
dispersas. As bolhas se movem a diferentes velocidades dependendo do seu diâmetro e o 
líquido se move a uma velocidade aproximadamente constante. O gás tem pouco efeito 
no gradiente de pressão. No padrão tipo golfada, a fase gasosa está presente em forma 
de bolhas alongadas, formando bolsões com diâmetro aproximadamente igual ao da 
tubulação. No entanto, a fase líquida continua sendo contínua. O gás se desloca para cima 
com velocidades superiores ao líquido. Tanto a fase líquida quanto a gasosa influenciam 
no gradiente de pressão. No padrão transição, a fase gasosa passa a ser contínua. As 
bolhas alongadas de gás começam a se agregar e a fase líquida intermitente que existia 
entre as bolhas se dispersam no meio do gás. A fase líquida passa a influenciar menos no 
gradiente de pressão. No padrão anular-nevoeiro, a fase gasosa permanece contínua. A 
fase gasosa sobe pelo centro da tubulação e o líquido se apresenta disperso sob a forma 
de gotículas no gás. A fase líquida tem pouco efeito no gradiente de pressão. Este regime 
de fluxo ocorre raramente em poços de petróleo (Guo et al., 2007).  

Escoamento Multifásico Horizontal 

No escoamento multifásico horizontal existem três padrões de fluxo: segregado 
(estratificado e ondulado), intermitente (bolha alongada e golfada) e disperso (bolha 
dispersa e anular-nevoeiro). Na Figura 2.4 estão representados esses seis padrões de 
fluxo. 



2.3 Produção de Petróleo Offshore tipo Gas-lift 10 
 

Segregado 
 

Segregado 
ondulado 

 

Bolha alongada 
 

Golfadas 
 

Bolhas dispersas 
 

Anular-nevoeiro 
 

Figura 2.4: Padrões de fluxo horizontal. (Adaptado de Jahanshahi &amp;amp; Skogestad, 2011). 

No padrão segregado estratificado, o líquido flui no fundo da tubulação e o gás flui 
sobre o líquido. A interface entre as fases é suave. No padrão segregado ondulado, um 
aumento na velocidade do gás causa a formação de ondas na interface estratificada. No 
fluxo intermitente tipo bolha alongada, onde a velocidade do gás é ainda maior, o líquido 
flui no fundo da tubulação, enquanto que bolhas alongadas de gás são formadas no topo, 
intercaladas com pequenas ondas de líquido. Já no padrão tipo golfada, estas ondas de 
líquido são mais acentuadas, preenchendo praticamente toda a seção da tubulação. No 
fluxo de bolhas dispersas, bolhas fluem no topo da tubulação em um fluxo contínuo de 
líquido. O gás possui velocidade parecida a do líquido. O padrão anular-nevoeiro é 
semelhante ao fluxo multifásico vertical (Guo et al., 2007). 

2.3.2 Estrutura do Sistema de Elevação de Petróleo 

Um reservatório de petróleo é uma formação rochosa porosa e permeável. Estas 
formações aprisionam grandes quantidades de hidrocarbonetos à alta pressão e quando 
localizadas ao largo da costa litorânea, ou offshore, são, além de isoladas por rochas 
impermeáveis, também isoladas por lâminas de água e camadas de acúmulo salino, como 
nos campos do pré-sal. O produto contido no reservatório é composto de uma mistura 
multifásica de hidrocarbonetos, líquidos e gasosos, água e sedimentos sem composição 
bem definida e variante no tempo (Ribeiro et al., 2016).  

Para realizar a extração do petróleo contido no reservatório, é realizada a perfuração 
das camadas de isolamento rochosas e salinas, sendo inserido um poço que conecta o 
reservatório à tubulação que fará o escoamento da mistura através da lâmina de água até 
a superfície, como indicado na Figura 2.5. 



2.3 Produção de Petróleo Offshore tipo Gas-lift 11 
 

 

Figura 2.5: Estrutura simplificada de extração de petróleo offshore por gas-lift (Fonte: 
Gerevini, 2017). 

Conforme ilustrado na Figura 2.5, um poço consiste em uma tubulação interna 
chamada de Tubing, a qual interliga o reservatório ao leito marinho, e por um 
compartimento externo que envolve o Tubing, chamado de anular. O gás de elevação 
proveniente da linha de produção é armazenado no anular e injetado no Tubing através 
da válvula de injeção. A entrada de gás e saída de produto para o leito do mar é regulada 
por uma estrutura de válvulas submarinas chamada Árvore de Natal Molhada (ANM). A 
partir desta, a produção é encaminhada para a superfície por uma tubulação flexível 
horizontal, chamada de Pipeline, e por uma tubulação flexível vertical, chamada Riser 
(Guo et al., 2007). Uma unidade de produção consiste, tipicamente, em uma série de 
poços de extração que interligam o reservatório a uma unidade de armazenamento e 
transferência chamada de FPSO (Floating Production Storage and Offloading). 

Na FPSO se encontram as facilidades de processo e separação da mistura multifásica. 
Desta maneira, a corrente multifásica é segregada em três: a água é tratada e injetada no 
reservatório ou descartada ao mar; o óleo é encaminhado para armazenamento e 
posterior exportação; e o gás é tratado e encaminhado para os módulos de compressão 
(Guo et al., 2007). 

2.3.3 Técnica de Gas-lift 

O gas-lift, ou gás de elevação, é uma técnica de elevação artificial na qual se utiliza a 
energia contida no gás comprimido para elevação da mistura multifásica proveniente do 
reservatório até a FPSO. Como todo método de elevação artificial, o gas-lift tem como 
objetivo fornecer uma pressão de fluxo no fundo do poço, tal que resulte na vazão 
desejada na válvula de produção. De todos os métodos de elevação artificial, o gas-lift é o 
que mais se aproxima de um fluxo natural e é considerado um dos métodos de elevação 



2.3 Produção de Petróleo Offshore tipo Gas-lift 12 
 
artificial mais versátil. A característica das fases envolvidas afeta o desempenho de 
técnicas “clássicas” de elevação de petróleo como o Bombeio Mecânico, o Bombeio por 
Cavidade Progressiva ou Bombeio Centrífugo Submerso. Além disso, as profundidades às 
quais os sistemas offshore estão submetidos dificultam a implementação e manutenção 
da maioria das técnicas de elevação. Frente às dificuldades, a técnica de gas-lift, apesar 
do alto valor de implantação e operação, decorrente da necessidade de um sistema de 
compressão, torna-se viável economicamente para áreas de extração com um grande 
número de poços (Petrobras, 2015; Lea et al., 2008). 

O gás de elevação é proveniente do módulo de compressão localizado na FPSO, que 
opera a pressões acima de 200 kgf/cm². O gás é distribuído para os poços através de um 
Manifold, conforme a necessidade individual de cada poço e capacidade dos trens de 
compressão. A distribuição é feita através de válvulas de controle. Como mostra a 
Figura 2.5, o gás escoa através do anular e é injetado no Tubing através de uma válvula de 
injeção, localizada próximo ao ponto de perfuração do reservatório. Esta é uma válvula de 
via única, não permitindo refluxo de produto para o compartimento de gás, acionada pela 
diferença de pressão entre o Tubing e anular. O fluxo multifásico proveniente do 
reservatório é afetado de três maneiras pelo gás injetado: a) a mistura oleosa é aerada e 
a densidade do meio é reduzida; b) a energia de expansão do gás ao entrar na coluna, que 
está a uma pressão menor, impulsiona o óleo para a superfície; e c) o gás ocasiona um 
fluxo tipo golfada (Guo et al., 2007). 

2.3.4 Golfadas no Sistema de Produção tipo Gas-lift 

Dentre os padrões de escoamento apresentados anteriormente, como mencionado, o 
mais frequente em sistemas de produção de petróleo é a golfada. Tal regime de fluxo é 
ocasionado também, além de pelo padrão de escoamento multifásico natural vertical ou 
horizontal, pela injeção de gas-lift e pelas inflexões na tubulação. Este regime é 
caracterizado por oscilações severas no fluxo e na pressão do sistema (Jahanshahi et al., 
2014). 

No sistema de produção tipo gas-lift, três padrões de escoamento são observados: a) 
casing heading, ou cabeceio anular; b) density wave, ou ondas de densidade; e c) terrain 
slug, ou golfada por acidente (Hu 2004). Os padrões são descritos a seguir. 

Golfada por Cabeceio anular 

A golfada por cabeceio anular ocorre quando a taxa de injeção de gás varia de acordo 
com a diferença de pressão entre o anular e Tubing. A oscilação provém da dinâmica de 
escoamento no compartimento anular e necessita de duas condições para ocorrer: a) a 
dinâmica do fluxo multifásico no Tubing ser dominado pela gravidade e b) a pressão no 
anular ser alta. Assim, qualquer variação na taxa de injeção de gás natural irá perturbar a 
pressão da coluna de produção e vice-versa (Hu 2004). Como ilustrado na Figura 2.6, a 
maior pressão no anular frente ao Tubing (1) provoca a injeção de gás neste, ocorrendo 
uma diminuição da massa específica da mistura e provocando uma maior redução na 
pressão do Tubing (2). A injeção de gás reduz até cessar quando a pressão do anular se 
torna menor do que a do Tubing (3). Logo, a pressão no anular volta a subir (4) pela 
entrada de gás e o processo se repete. 



2.3 Produção de Petróleo Offshore tipo Gas-lift 13 
 

 
Figura 2.6: Etapas da golfada por cabeceio anular. Líquido e gás nas cores cinza e azul, 

respectivamente (Fonte: Gerevini, 2017). 

Golfada por Onda de Densidade 

A golfada por onda de densidade acontece sob fluxo de injeção de gás crítico, ou seja, 
o fluxo de gás através da válvula de injeção é supersônico e a vazão de gás é constante e 
independente da diferença de pressão entre o anular e o Tubing. A oscilação é 
proveniente da dinâmica de escoamento no Tubing. Portanto, variações do fluxo de 
líquido vindo do reservatório alteram a massa específica da mistura multifásica. Como 
ilustrado na Figura 2.7, a fração de gás no Tubing é pequena e a diferença de pressão 
entre o fundo do poço e o reservatório é mínima, resultando em um baixo fluxo 
proveniente do reservatório (1). A injeção de gás continua e pressão do Tubing diminui 
até que a pressão do reservatório se torna maior (2). Isto facilita o escoamento de óleo 
proveniente do reservatório (3). Deste ponto em diante, a dinâmica do óleo domina o 
cenário e a produção decai até o ponto em que a produção cessa novamente e o ciclo se 
repete (4). 

 

1) 2) 

3) 4) 



2.3 Produção de Petróleo Offshore tipo Gas-lift 14 
 

 
Figura 2.7: Etapas da golfada por onda de densidade. Líquido e gás nas cores cinza e azul, 

respectivamente (Fonte: Gerevini, 2017). 

Golfada por Acidente de Terreno 

A golfada por acidente é causada pelo acúmulo de líquido em pontos baixos gerados 
por inflexões na tubulação de transporte no leito marinho, principalmente no ponto de 
transição entre o Pipeline e o Riser. Como ilustrado na Figura 2.8, há a formação de um 
bloqueio de líquido por ação da gravidade acarretando no impedimento do fluxo de gás 
(1). A pressão do gás acumulado aumenta até exceder a pressão hidrostática da coluna 
líquida (2) e a mistura é impulsionada abruptamente à superfície (3). Parte de líquido que 
retorna ao ponto baixo por ação da gravidade (4) e o ciclo se repete. 

 

Figura 2.8: Etapas da golfada por acidente. Líquido e gás nas cores azul e branco, 
respectivamente (Fonte: Gerevini, 2017). 

 

2.3.5 Variáveis Medidas 

O acompanhamento da produção dos poços é importante para o monitoramento e a 
detecção de problemas de elevação e escoamento, bem como para a otimização dos 

3) 

1) 

4) 

2) 



2.3 Produção de Petróleo Offshore tipo Gas-lift 15 
 
processos. As principais medições no acompanhamento de poços são os sensores de 
pressão de superfície à montante e a jusante da válvula de produção e na entrada do 
separador, e subsuperfície, através dos sensores de fundo de poço e da ANM. (Guo et al., 
2007). Neste trabalho o sensor à montante da válvula de produção é chamado de PRT, o 
sensor de fundo de poço é chamado de PDG e o sensor da ANM é chamado de TPT. 

Sensor PDG 

O PDG é um sensor permanente de pressão e temperatura de fundo. É instalado na 
coluna de produção, logo acima do ponto de perfuração do reservatório. Esse sensor é 
muito útil na detecção de problemas operacionais (incrustações, problemas com válvulas, 
entupimentos), na análise do escoamento multifásico e no ajuste de testes de produção. 
Devido ao posicionamento e ao tempo de resposta relativo aos demais pontos de 
medição, PDG é o principal parâmetro de monitoramento do poço. 

Sensor TPT 

O TPT é um sensor de pressão e temperatura instalado na ANM. O TPT é muito útil na 
monitoração da operação de ANMs, na solução de problemas operacionais (tais como 
hidrato), na análise do escoamento multifásico e no acompanhamento do histórico de 
produção. 

2.3.6 Modelagem de Sistemas de Produção de Petróleo Offshore tipo Gas-lift 

A modelagem da golfada é uma tarefa difícil e nenhum modelo existente até o 
momento se mostrou adequado para controle quando incertezas são contabilizadas. A 
falta de robustez pode levar a erros de simulação e a desempenho ruim de controle. A 
maioria dos modelos é baseada em equações de balanços de massa (Pedersen et al., 
2017). No entanto, através das medições de pressão existentes é possível estimar 
somente a taxa mássica total combinada e não a razão gás/óleo do sistema. Além disso, a 
medição de vazão mássica de líquido e gás é rara em plataformas offshore.  

Existem dois softwares comerciais principais para modelagem fenomenológica com 
validação por banco de dados reais presentes no mercado: OLGA e LedaFlow (Heskestad, 
2005; Bendiksen et al.; 1991; Ehinmowo &amp;amp; Cao, 2015; Leebeeck &amp;amp; Johansen, 2013; 
Jahanshahi et al., 2014; Belt et al., 2011). Estes softwares são capazes de reproduzir os 
mecanismos de golfada, mas apesar da acurácia, a complexidade associada aos modelos 
traz o ônus do elevado custo computacional, além do custo monetário relativo à 
aquisição de licenças de uso. Além disso, para a área de controle e otimização, traz 
consigo o ônus da impossibilidade de derivação de leis de controle e critérios de 
estabilidade e observabilidade (Di Meglio et al., 2011). 

Em Storkaas et al. (2003), um modelo de equações diferenciais algébricas de baixa 
dimensão é proposto para golfada severa na estrutura Pipeline-Riser baseado em balanço 
de massa. O modelo possui três estados dinâmicos e foi comparado com simulações em 
OLGA, mostrando resultados consistentes. Kaasa et al. (2008) e Di Meglio et al. (2009) 
propõem modelos com três estados dinâmicos com sete e cinco parâmetros de ajuste, 
respectivamente. O modelo de Di Meglio et al. (2009) é baseado no princípio de uma 
válvula virtual na subida do Riser para formação da golfada. Apesar da grande quantidade 
de parâmetros, ambos os modelos foram ajustados a simulações utilizado modelo 
fenomenológico simulado no software OLGA, obtendo resultados semelhantes. Eikrem et 



2.3 Produção de Petróleo Offshore tipo Gas-lift 16 
 
al. (2008) apresenta um modelo de quatro estados dinâmicos baseado no trabalho de 
Eikrem (2006). Outro modelo de quatro estados é proposto por Silva et al. (2010). Os 
modelos de Eikrem et al. (2008) e Silva et al. (2010) possuem três parâmetros de ajuste e 
apresentam resultados inferiores aos outros modelos quando ajustados aos dados 
simulados em OLGA. Jepsen et al. (2013) desenvolveram um controlador baseado no 
modelo de Eikrem et al. (2008) e concluiu que o ajuste do modelo é complexo também 
para dados reais. Jahanshahi &amp;amp; Skogestad (2011) propuseram um modelo de quatro 
estados dinâmicos com quatro parâmetros de ajuste. Jahanshahi &amp;amp; Skogestad (2011) 
concluíram que seu modelo e o modelo de Di Meglio et al. (2009) são os melhores, 
considerando a complexidade e a quantidade de parâmetros de ajuste.  

Como os modelos supracitados eram limitados à descrição do sistema Pipeline-Riser, 
Jahanshahi &amp;amp; Skogestad (2013) propõe um modelo de seis estados dinâmicos para 
modelar toda a estrutura poço-Pipeline-Riser. Apesar disso, o modelo assume a razão 
líquido/gás provinda do reservatório constante, parâmetro desconhecido na realidade. O 
modelo ainda foi comparado com simulações em OLGA e o autor conclui que o modelo 
pode ser utilizado para predizer o estado estacionário e o ponto de bifurcação com boa 
acurácia. 

Com o objetivo de obter um modelo simples para fins de controle que se adeque a 
poços de produção de petróleo offshore em regiões profundas e ultra profundas, Diehl et 
al. (2017) desenvolveram um modelo baseado na união dos modelos de Jahanshahi &amp;amp; 
Skogestad (2011) e Di Meglio et al. (2012). O modelo, desenvolvido para representar 
golfadas por cabeceio anular e por acidente, foi validado frente a simulações em OLGA e 
também a dados de dois poços reais. Como resultado, o modelo se mostrou capaz de 
representar comportamentos dinâmicos complexos, mostrando-se mais estável 
numericamente que os modelos presentes na literatura e rápido o suficiente para ser 
usado em aplicações em tempo real. 

  



 
 

 Revisão Bibliográfica Capítulo 3 –

3.1 Formulação do Problema de Estimação de Parâmetros 
Interesse deste estudo, um problema de estimação de parâmetros dinâmico pode ser 

formulado supondo um sistema descrito por EDOs como na Equação 3.1: 

 ?(?, ?(?), ?) = 0 (3.1) 

Onde ? corresponde à matriz de variáveis temporais da Equação 3.2 e ? é o vetor de 
parâmetros livres a serem estimados na otimização. 

 ?(?) = ????(?), ?(?), ?(?), ?(?)?  ?  ??? (3.2) 

 Na Equação 3.2, ? é a variável independente tempo, ? é a variável diferenciável, 
relacionada aos estados do sistema, y é a variável algébrica e ? é a variável manipulada.  

As condições iniciais do sistema são dadas pela Equação 3.3. 

 ?0(?0, ?(?0), ?) = 0 (3.3) 

 As condições iniciais são assumidas serem consistentes com o sistema, a fim de prover 
informações suficientes para que o problema seja resolvido. Assim, o problema de 
estimação de parâmetros considerado tem a forma geral da Equação 3.4. e é sujeita às 
restrições e aos limites da Equação 3.5. 

 ???? ? ??? ???0, ??, ?(?), ?? (3.4) 

 ?. ?. ?.       
? ?  ??0, ??? ?  ???, ? ?  ??0, ??? ?  ??? ,

? ?  ??0, ??? ?  ??? ,
?0  ?  ?,  ??  ?  ?, ? ?  ???

  

 ?. ?.     

?(?, ?(?), ?) = 0, ?0(?0, ?(?0), ?) =  0
?? &amp;lt;?(?) &amp;lt; ??, ?? &amp;lt;? &amp;lt; ??

???0, ??, ?(?), ?? = 0,
???0, ??, ?(?), ?? ? 0

?? ?  ??0, ???

 (3.5) 



3.2 Convexidade 18 
 

A função ? na Equação 3.4, é a função objetivo a ser minimizada, manipulando as 
variáveis de decisão ?. A minimização é feita com respeito ao tempo ? com intervalo 
definido ??0, ???. Na Equação 3.5, ? e ? são as restrições de igualdade e desigualdade, 
respectivamente e os índices subscritos ? e ? indicam os limites inferiores e superiores 
possíveis para as variáveis. 

3.2 Convexidade 
Convexidade é uma propriedade importante na área de otimização e útil no 

entendimento dos conceitos de mínimo local e mínimo global. A presença de múltiplos 
mínimos locais na região viável de busca impacta na escolha do algoritmo de otimização e 
também serve de análise para formulação da função objetivo do problema.  

Conjunto e Função Convexos 

Um conjunto convexo pode ser definido como um conjunto de pontos em um espaço 
com ? dimensões onde quaisquer pares de pontos dentro deste conjunto podem ser 
conectados por uma linha reta, que por sua vez também está contida dento do conjunto. 
O conceito é ilustrado na Figura 3.1 para um espaço bidimensional (Edgar et al., 2001).  

a)  b)  c)  

Figura 3.1: Conjuntos convexos e não convexos: a) convexo, b) convexo e c) não-convexo 
(Adaptado de Edgar et al., 2001). 

Da mesma maneira, a Figura 3.2, representa o conceito de convexidade para uma 
função dependente de uma variável. 



3.3 Algoritmos de Otimização 19 
 

a)  b)  

Figura 3.2: Convexidade: a) função convexa e b) função não-convexa (Adaptado de Edgar 
et al., 2001). 

Em um problema de estimação de parâmetros, se a função objetivo é convexa dentro 
de uma região viável de busca, o problema resultante é um problema de programação 
convexo (Figura 3.2.a). Neste caso, existe apenas um ótimo e este é chamado de mínimo 
ou ótimo global. Por outro lado, para um problema de otimização não convexo, um ponto 
pode ser ótimo apenas para uma vizinhança dentro do espaço viável de busca. Neste 
caso, este ponto é chamado de mínimo ou ótimo local. Muitos problemas reais são não-
convexos e contém múltiplos mínimos globais. Dentro de toda a região viável de busca, o 
componente que resulta em um menor valor de função objetivo é o mínimo global. A 
Figura 3.2.b apresenta uma função com três mínimos locais: A, B e C, onde B é o ótimo 
global.  

3.3 Algoritmos de Otimização 
Neste trabalho são utilizados dois algoritmos de otimização, BOBYQA (Powell, 2009), 

local, e DIRECT (Finkel, 2003), global. Os dois algoritmos são brevemente apresentados 
abaixo. 

BOBYQA (Powell, 2009) 

BOBYQA (Powell, 2009) é um algoritmo de otimização por aproximação quadrática 
sem restrições. O algoritmo resolve o problema usando o método de região de confiança 
que forma modelos quadráticos por interpolação. O algoritmo apresenta elevada 
confiabilidade, eficiência e capacidade de convergência, com a vantagem principal de não 
exigir cálculo da derivada da função objetivo, o que evita problemas numéricos e reduz a 
demanda computacional. Mais informações podem ser vistas em Powell (2009). 

DIRECT (Finkel, 2003)  

Dada uma função objetivo ?, a otimização global determinística possui os seguintes 
objetivos: 1) determinar um conjunto pL &amp;lt;p &amp;lt; pU para os parâmetros de busca e 
possíveis restrições do problema e 2) identificar soluções com boa qualidade, como 
mínimos locais próximos ao global. DIRECT (Finkel, 2003) é um algoritmo por 
amostragem. Não é necessário ter conhecimento do gradiente da função objetivo. Por 
outro lado, o algoritmo coleta informações de pontos no domínio e usa essa informação 



3.4 Estimação de Parâmetros de Modelos com Ciclo Limite 20 
 
para decidir para onde irá na próxima iteração. Como mostra a Figura 3.3, o algoritmo 
localiza, em amarelo, a região potencialmente ótima e subdivide a região em hiper-
retângulos. 

 

Figura 3.3: Divisão do espaço de busca do DIRECT (Finkel, 2003). 

Assim que atingidos critérios de parada, o algoritmo retorna os parâmetros 
correspondentes à mínima função objetivo avaliada na busca. Maiores detalhes do 
algoritmo podem ser vistos em Finkel (2003). 

3.4 Estimação de Parâmetros de Modelos com Ciclo Limite 
Por mais de 50 anos, o Método dos Mínimos Quadrados (MMQ) tem sido a métrica 

quantitativa dominante para análise comparativa de sinais. Ainda hoje permanece um 
critério padrão para comparação de qualidade e fidelidade entre sinais, inclusive na área 
de estimação de parâmetros (Wang &amp;amp; Bovik, 2009). Sendo a saída simulada do modelo ?? 
e os dados experimentais ??, a função objetivo do MMQ entre os sinais é: 

 ??? =  ? (?? ? ??)2??=1   (3.6) 

Esta métrica apresenta dificuldade para capturar o efeito da periodicidade, apenas a 
trajetória da curva, não sendo adequado para sistemas com ciclo limite como único termo 
da função objetivo. Na literatura, alguns autores vêm desenvolvendo métodos para 
estimação de parâmetros de modelos com ciclo limite baseados na detecção do ponto de 
bifurcação Hopf do modelo. Dentre os trabalhos, estão Guckenheimer et al. (1997), 
Meerbergen &amp;amp; Spence (2010), Elman et al. (2012), Cedersund &amp;amp; Knudsen (2005), Hynne et 
al. (1993), Hynne et al. (2001) e Apio et al. (2017). No entanto, ainda que os métodos 
apresentados anteriormente se mostrem teoricamente eficientes, quando se trata da 
modelagem de sistemas reais, eles são de difícil aplicação prática, pois necessitam 
linearizações de modelo e cálculo de autovalores. Além disso, um mesmo modelo pode 
apresentar diversos pontos de bifurcação, o que aumenta com o número de parâmetros a 
serem otimizados. Isto torna a metodologia complexa e computacionalmente custosa. 

Outra abordagem presente na literatura é a formulação de novas funções objetivo 
que capturem o efeito da periodicidade. No entanto esta área ainda não foi 
profundamente explorada.  



3.4 Estimação de Parâmetros de Modelos com Ciclo Limite 21 
 

Siong (2009) implementa o algoritmo de Evolução Diferencial para resolver o 
problema de estimação de parâmetros e propõe uma função objetivo baseada 
minimização do erro da fase e do período dos sinais oscilatórios. Os dados no domínio do 
tempo são convertidos em fase pelo escalonamento do tempo com o período, o que 
captura o erro da trajetória, e um termo adicional para capturar o período é adicionado. 

Diehl et al. (2017) utiliza o algoritmo PSO (Eberhart &amp;amp; Yuhui Shi, 2015) e o método de 
mínimos quadrados penalizados e divididos em janela: 

 ? = ? 1
??
?1
?
? ??(?? ? ??)2??=1 ?

?
?=1   (3.7) 

Onde ?é o número de janelas, ?? é o peso baseado no coeficiente de correlação 
normalizado de Pearson, sendo 1 correspondente à correlação perfeita, e ?? é o peso 
aplicado a cada ponto. 

No trabalho de Apio et al. (2017), os autores mescla uma função objetivo de detecção 
do ponto Hopf com o método de mínimos quadrados conforme equação abaixo: 

 ? =  ? (?? ? ??(?))2??=1 + ??(?) (3.8) 

Onde ??? representa as saídas medidas, ??? representa as saídas estimadas pelo modelo, 
? é o parâmetro de penalidade e ? é o fator de amortecimento responsável por capturar 
o ponto Hopf. Os autores utilizam o algoritmo BOBYQA (Powell, 2009) para otimização. 

Em Gerevini (2017) o autor propõe a seguinte função objetivo: 

 ? = ??? + ?
???

?
???

???
?(?)
???

?
2

?
?
?=1 [?? ? ??(?)]

2 (3.9) 

onde, o segundo termo (????) representa o erro quadrático da derivada e o terceiro 
termo (????) é o erro quadráticos do período de oscilação. A relação dada por uma 
multiplicação do período e a derivada do erro é feita a fim de manter a dimensão do 
problema. O autor utiliza o algoritmo DIRECT (Finkel, 2003) para otimização. 

Um aspecto importante que não é explicitamente abordado nos trabalhos citados é a 
inicialização do problema de estimação de parâmetros. A inicialização incorreta pode 
acarretar erros numéricos na integração do modelo. Bonilla et al. (2010) aborda o assunto 
para o sistema de Lotka-Volterra. No entanto, o trabalho sugere uma abordagem convexa 
baseada no princípio de que todos os estado do sistema são estão disponíveis. Além 
disso, como em Siong (2009), na área da biologia um conhecimento prévio dos 
parâmetros de ajuste é possível, pois podem ser obtidos de experimentos laboratoriais. 
Porém, segundo Siong (2009) técnicas de estimação de parâmetros não são comumente 
aplicadas e uma abordagem qualitativa manual é empregada. 

Na produção de petróleo, os modelos estudados dependem da condição inicial dos 
estados, informação que não está disponível por medição. Na prática, os estados iniciais 
podem ser calculados através da solução do modelo em estado estacionário. No entanto, 
todos os modelos apresentados são baseados na estrutura física do sistema, que por sua 
vez não é conhecida em detalhes. Além disso, os modelos são limitados por um grande 
número de parâmetros de ajuste. Portanto é exigido um grande esforço para ajustar o 
modelo ao sistema real. No estudo de Diehl et al. (2017), apesar dos autores 



3.5 Análise de Sensibilidade de Modelos com Ciclo Limite 22 
 
apresentarem uma função objetivo para o problema de estimação de parâmetros, a 
inicialização do problema e obtenção de comportamento oscilatório é feita de maneira 
analítica através de equações teóricas. O mesmo ocorre nos trabalhos de Jahanshahi et 
al. (2013) e Di Meglio et al. (2009), por exemplo. No entanto, maiores detalhes da 
eficiência da metodologia não são apresentados. Os demais autores citados não 
apresentam nenhum procedimento de estimação de parâmetros, se limitando a 
comentar que o ajuste foi feito de modo a obter as características oscilatórias desejadas, 
como em Jepsen et al. (2013) e Di Meglio et al. (2010). 

3.5 Análise de Sensibilidade de Modelos com Ciclo Limite 
A Análise de Sensibilidade é um estudo sistemático dos efeitos de parâmetros na 

predição de modelos matemáticos. É uma ferramenta útil para validação e avaliação do 
modelo, assim como quantificar os efeitos de incerteza e variabilidade paramétricos na 
saída do modelo (Kramer et al. 1984). O princípio da estimação de parâmetros é 
justamente variar o valor dos parâmetros de ajuste de um modelo para encontrar uma 
trajetória que melhor se adequa aos dados de referência. Portanto, a análise de 
sensibilidade é um passo importante na estimação de parâmetros.  

A matriz de sensibilidade ?(?), que descreve como a variação de um conjunto de 
parâmetros p afeta a trajetória de estados x é definida como: 

 ?(?) = ??x
?p
? (3.10) 

onde ?(?) contém informações individuais de sensibilidade de cada estado para cada 
parâmetro, ???. A maneira mais simples de calcular a matriz de sensibilidade é pelo 
Método de Diferenças Finitas, para um parâmetro ??: 

 ? ?x
???
?  ?

x??,??+ ?????x(?,??)
???

 (3.11) 

 No entanto, este método pode levar a falhas numéricas e resultados errôneos. Na 
literatura, outros métodos estão disponíveis para cálculo de sensibilidade. O Método 
Direto é uma abordagem alternativa que faz a diferenciação do sistema de EDO (Equação 
3.11) com respeito aos parâmetros ?. Outra maneira de realizar a análise de sensibilidade 
é através do Método da Função de Green, o qual resolve a diferenciação do Método 
Direto de maneira diferente: 1) o termo homogêneo é resolvido primeiro e 2) a solução 
particular para cada parâmetro é resolvida na sequência. 

 Os métodos apresentados, consolidados na literatura, no entanto, não são 
diretamente aplicáveis a sistema com ciclo limite. Como descrito, os métodos somente 
calculam a sensibilidade da trajetória do sinal de saída frente a variações nos parâmetros. 
Além disso, a sensibilidade paramétrica computada para modelos oscilatórios apresenta 
divergência ao passo que o tempo vai para o infinito, como ilustrado na Figura 2.3. 



3.5 Análise de Sensibilidade de Modelos com Ciclo Limite 23 
 

 

Figura 3.4: Análise de sensibilidade clássica da equação de Van der Pol. 

Portanto, a problemática da captura da periodicidade permanece. Os primeiros 
autores a explicitar o termo de periodicidade no cálculo de sensibilidade foram Larter et 
al. (1984) Os autores representaram o sinal oscilatório do sistema estudado através da 
Série de Fourier: 

 ??(?) =  ? ???? cos
2???
?

+  ??? sin
2???
?
???=0  (3.12) 

Onde ? e ? são os coeficientes da série. Desta maneira o período ? do sistema fica 
explicito e quando a diferenciação do sistema é feita, a matriz de sensibilidade individual 
é calculada da seguinte forma: 

 ??? =  
2??
?2

??
???

? ????? sin
2???
?
?  ???? cos

2???
?
???=0 +  ? ?

???
?

???
cos 2???

?
+  ???

?

???
sin 2???

?
???=0

 (3.13) 

O segundo termo da Equação 3.13 é responsável então pela captura da variação da 
trajetória, referente à matriz ?(?) original, e o primeiro termo é responsável pela captura 
da variação do período da oscilação. Partindo deste princípio, Zak et al. (2005) propõem o 
cálculo da matriz de sensibilidade do período através do método de SVD. Lu &amp;amp; Yue (2012) 
incluem a fase da oscilação na análise de sensibilidade. 

Em geral, há dois tipos de análise de sensibilidade: 1) local e 2) global, comentados a 
seguir. 

Análise de Sensibilidade Local 

A análise de sensibilidade local avalia mudanças na saída do modelo a partir de 
variações em um único parâmetro. Os parâmetros são tipicamente variados um por vez 



3.5 Análise de Sensibilidade de Modelos com Ciclo Limite 24 
 
com pequenos incrementos, em torno de 0,1 %, e os efeitos individuais da perturbação 
destes parâmetros na saída do modelo são calculados através de índices locais de 
sensibilidade. 

A aplicação da análise de sensibilidade local é indicada para modelos com relação 
linear entre os parâmetros e as saídas do modelo. A maior limitação da análise de 
sensibilidade local é a avaliação individual dos parâmetros, não sendo viável a análise 
simultânea da variação de parâmetros. Além disso, a interação entre os parâmetros não 
pode ser avaliada.  

Análise de Sensibilidade Global 

A análise de sensibilidade global visa contornar as limitações da análise de 
sensibilidade local. Na análise de sensibilidade global, todos os parâmetros são variados 
simultaneamente dentro de todo o espaço definido. Isto possibilita a avaliação 
simultânea relativa a contribuições de todos os parâmetros individualmente, bem como 
as interações entre os parâmetros na variância da saída do modelo. Quando os 
parâmetros não são conhecidos e o modelo não apresenta comportamento linear, a 
análise de sensibilidade global é uma abordagem indicada para avaliar o comportamento 
do sistema. 

Existem vários métodos de análise de sensibilidade global, tais como Média 
Ponderada da Análise de Sensibilidade Local (WALS, do inglês Weighted average of local 
sensitivity analysis), Coeficiente de Correlação de Ranque Parcial (PRCC, do inglês Partial 
rank correlation coefficient), Análise de Sensibilidade Multiparamétrica (MPSA, do inglês 
Multi-parametric sensitivity analysis), Análise de Sensibilidade da Amplitude de Fourier 
(FAST, do inglês Fourier amplitude sensitivity analysis) e Sobol (Zhang et al., 2015). A 
Tabela 3.1 apresenta um comparativo entre as técnicas. 



3.5 Análise de Sensibilidade de Modelos com Ciclo Limite 25 
 
Tabela 3.1: Comparativo entre técnicas de Análise de Sensibilidade Global (Adaptado de 

Zhang et al., 2015) 

Critérios WALS PRCC MPSA FAST Sobol 

Entrada discreta Sim Sim Sim Sim Sim 

Independência de 
modelo 

Não Não Não Sim Sim 

Modelo não 
linear 

Sim Sim Sim Sim Sim 

Modelo não 
monotônico 

Sim Não Sim Sim Sim 

Robustez Sim Sim Sim Sim Sim 

Reprodutibilidade Sim Sim Sim Sim Sim 

Segregação da 
variância 

Não Não Não Sim Sim 

Interação de 
ordens 

superiores 
Não Não Não Sim Sim 

Medida 
quantitativa 

Sim Sim Sim Sim Sim 

Eficiência 
computacional 

Sim Sim Sim Não Não 

 

Através da Tabela 3.1, verifica-se que os métodos FAST e Sobol são os mais indicados, 
visto que elas têm a vantagem de retornar a interação de ordem superior entre 
parâmetros pela distribuição da variância da saída. Além disso, estes métodos não têm 
dependência do modelo. FAST e Sobol são baseados em técnicas de decomposição de 
variância para fornecer uma medida quantitativa da contribuição dos parâmetros para a 
variância da saída do modelo. A maior diferença entre os dois é o algoritmo utilizado na 
integração multidimensional dos índices de sensibilidade. Enquanto que o FAST utiliza 
Séries de Fourier, Sobol utiliza o método de Monte Carlo. 

  



 
 

 Metodologia para Estimação de Capítulo 4 –
Parâmetros 

Neste capítulo, primeiramente o problema de estimação de parâmetros é formulado 
baseado nas características do sinal oscilatório que devem ser capturadas, na seção 4.1 e 
4.2. Em seguida, a metodologia é dividida em quatro partes: formulação da função 
objetivo, análise de sensibilidade, estrutura de otimização e métricas de desempenho. A 
formulação da função objetivo é composta pelas seções 4.3, que aborda o período, 4.4, 
que aborda o número de oscilações, 4.5, que aborda a média e 4.6, que aborda a função 
objetivo proposta em si. A metodologia proposta de análise de sensibilidade é abordada 
na seção 4.7. Na seção 4.8, é apresentada a estrutura de otimização. Por fim, na seção 
4.9, as métricas para cálculo de desempenho de função objetivo são apresentadas.  

4.1 Formulação do Problema de Estimação de Parâmetros 
Sistemas oscilatórios possuem duas características: forma e periodicidade. A forma 

pode ser descrita pela trajetória dos estados em um ciclo de oscilação. Sistemas não 
oscilatórios, por exemplo, possuem apenas a característica de forma, sendo o período 
infinito. A característica da periodicidade dificulta a aplicação de métodos clássicos de 
estimação de parâmetros a sistemas oscilatórios (Siong, 2009). Isto pode ocorrer, pois a 
sensibilidade paramétrica e consequentemente o gradiente da função objetivo divergem 
ao longo do tempo e, além disso, a resposta tende a convergir para o valor médio do sinal 
oscilatório (Apio et al., 2017), conforme abordado na seção 2.4.5. 

A Figura 4.1 ilustra a diferença de período entre dois sinais oscilatórios. Devido à 
diferença entre os períodos, um erro será computado entre as duas trajetórias. No 
entanto, se as trajetórias forem escalonadas pelo tempo, ambas as trajetórias têm formas 
idênticas, portanto, não possuem diferença na forma. Por isso, a única discrepância 
presente entre os sinais é a do período.  



4.1 Formulação do Problema de Estimação de Parâmetros 27 
 

 

Figura 4.1: Diferença de período entre dois sinais, original e alterado. 

A Figura 4.2, por outro lado, ilustra a diferença entre a forma de dois sinais 
oscilatórios que possuem o mesmo período de oscilação. Claramente, percebe-se que o 
único erro existente entre as trajetórias é relativo à discrepância entre as amplitudes dos 
dois sinais. Portanto, pode-se, neste cenário, equivaler à característica da forma do sinal à 
amplitude deste.  

 

Figura 4.2: Diferença de forma entre dois sinais, original e alterado. 



4.1 Formulação do Problema de Estimação de Parâmetros 28 
 

Além do período e da amplitude, a fase do sinal oscilatório também é uma 
característica importante para distinguir dois sinais. A diferença entre as fases de duas 
trajetórias é apresentada na Figura 4.3. Ambos os sinais oscilatórios possuem período e 
forma idênticos, no entanto estão deslocados no tempo, gerando discrepância na 
computação da forma dos sinais.  

 

Figura 4.3: Diferença de fase entre dois sinais, original e alterado. 

Outra característica que descreve a diferença entre dois sinais oscilatórios, relevante 
para o problema de estimação, é a média da trajetória. A média é representada na 
Figura 4.4. Duas trajetórias podem ter as mesmas características de forma e periodicidade 
e, no entanto, oscilarem com médias diferentes. 



4.1 Formulação do Problema de Estimação de Parâmetros 29 
 

 

Figura 4.4: Diferença de média entre dois sinais, original e alterado. 

Baseado nas quatro características formuladas acima é considerado, então, que um 
sinal oscilatório pode ser inteiramente representado pelo período, pela amplitude, pela 
fase e pela média. Portanto, a estratégia para cálculo da função objetivo é dividida em 
quatro passos que visam capturar estas quatro características através de métricas. No 
primeiro passo, a estimação do período é realizada. No segundo passo, uma região 
oscilatória viável é encontrada através da definição da amplitude mínima desejada e 
cálculo do número de oscilações. No terceiro passo, o cálculo da média é feito. Por fim, o 
erro entre os três termos das duas trajetórias, estimada e medida, são calculadas. A fase é 
considerada implicitamente no problema, visto que é esperado que caso as demais 
métricas sejam alcançadas, o sinal estimado estará em fase com o final medido dentro 
dos limites temporais definidos no problema de estimação de parâmetros. 



4.2 Comportamento Oscilatório 30 
 

 

Figura 4.5: Fluxograma simplificado da metodologia. 

Os passos são descritos na Figura 4.5, que ilustra o procedimento de cálculo das 
métricas: período, número de oscilações e zeros, apresentadas no próximo capítulo. 

4.2 Comportamento Oscilatório 
Na estimação de parâmetros de sistemas oscilatórios, a simulação do modelo pode 

retornar respostas com diferentes dinâmicas, dependendo do conjunto de parâmetros 
utilizados na interação atual. Dentre as possíveis respostas estão: 

1. Ciclo limite (oscilações constantes) 

2. Oscilações com decaimento  

3. Oscilações caóticas  

4. Não-oscilatórias  

A Figura 4.6 apresenta os quatro comportamentos dinâmicos listados acima. Como o 
objetivo deste trabalho é estimar parâmetros que reproduzam dados medidos com ciclo 



4.2 Comportamento Oscilatório 31 
 
limite (periodicidade e forma constante), é necessário penalizar e descartar os outros três 
comportamentos não desejados.  

a)  c)  

b)  d)  

Figura 4.6: Respostas oscilatórias possíveis: a) ciclo limite, b) oscilações com decaimento, 
c) oscilações caóticas e d) sem oscilações. 

Previamente à análise do tipo de comportamento dinâmico do sinal, é necessário que 
o sinal seja tratado. Dados medidos provenientes da indústria possuem ruídos e 
distúrbios não medidos que dificultam a análise do sinal e propagam incertezas para a 
etapa de estimação de parâmetros. Portanto, algumas etapas são necessárias: remoção 
de ruído, identificação dos picos e vales, identificação da média e remoção da média variável. 

4.2.1 Remoção do Ruído 

A identificação de picos e vales e, consequentemente, a média é dependente da 
remoção do ruído do sinal. A identificação de picos e vales em sinais suaves pode ser 
facilmente identificada pela mudança do sinal da primeira derivada, o que não é válido 
para sinais ruidosos. Dessa forma, é utilizado um filtro de Resposta ao Impulso Finita (FIR) 
para suavização do sinal. A implementação do filtro é apresentada no Apêndice B. 



4.2 Comportamento Oscilatório 32 
 
4.2.2 Identificação da Frequência Fundamental do Sinal 

Uma maneira de analisar o sinal para caracterização do tipo de comportamento é 
através da Transformada Rápida de Fourier (FFT, do inglês Fast Fourier Transform). A FFT 
(Cooley &amp;amp; Tukey 1965) promove uma análise de Fourier, um método para expressar uma 
função como um somatório de componentes periódicos e para recuperar o sinal destes 
componentes. Se a FFT de um sinal no domínio do tempo é feita, a representação da 
frequência-amplitude, também chamada de espectro de frequência, do sinal é obtida. 
Desta maneira, qualquer sinal oscilatório pode ser reproduzido pela sobreposição de 
ondas senoidais harmônicas à frequência fundamental de um sinal, com amplitudes e 
fases determinadas. Portanto, a FFT faz o caminho inverso decompondo um sinal 
oscilatório complexo nas senoidais capazes de reconstitui-lo.  

A FFT é então utilizada neste trabalho para identificar a frequência fundamental do 
sinal (suficiente para fins de estimação de parâmetros) e calcular o período do sinal. 

 

Figura 4.7: FFT das respostas oscilatórias. 

A Figura 4.7 apresenta o espectro de frequência dos sinais apresentados na seção 
anterior. Uma solução oscilatória produz um pico proeminente no espectro de frequência 



4.3 Período - ? 33 
 
(frequência fundamental), enquanto que uma solução não oscilatória produz apenas um 
pico de frequência 0 Hz (sem retirar a média do sinal) seguido de picos pequenos devido 
ao degrau presente no sinal. Sinais com amortecimento apresentam período infinito (não 
mostrado) e decaimento no perfil, enquanto que sinais com oscilação caótica possuem 
múltiplos componentes.  

4.3 Período - ? 
A FFT do sinal de saída do modelo é utilizada para cálculo do período do sistema. O 

período do sinal é estimado pelo período relativo à frequência fundamental do sinal. 
Visto que o ciclo limite possui um pico proeminente, o erro referente às frequências altas 
provenientes de ruídos não interfere significativamente. A Figura 4.8 ilustra a 
reconstrução de um sinal ruidoso, fazendo uso apenas do período fundamental. 

 

Figura 4.8: Reconstrução de sinal com período fundamental. 

Como pode ser visto na Figura 4.8, o período fundamental é uma informação 
suficiente para capturar a dinâmica do sistema. A implementação do cálculo do período é 
apresentada no Apêndice B. 

4.4 Número de Oscilações - ? 
O cálculo do número de oscilações envolve a identificação de picos e vales do sinal 

oscilatório. Os picos e vales são identificados através do cálculo da primeira derivada. 
Quando há mudança de sinal da primeira derivada, há a presença de um pico, mudança de 
sinal positivo para negativo, ou vale, mudança de sinal negativo para positivo. O número de 
oscilações é calculado como sendo igual ao número de picos do sinal. No entanto, para 
sinais ruidosos, diversos falsos picos e vales serão identificados em decorrência da 
mudança no sinal da primeira derivada causada por ruídos. Para evitar que isso ocorra, o 



4.4 Número de Oscilações - ? 34 
 
sinal deve ser previamente filtrado. A Figura 4.9 ilustra a identificação de picos e vales de 
um sinal oscilatório filtrado.  

 

Figura 4.9: Identificação de picos e vales. 

Como pode ser visto na Figura 4.9, vários falsos picos e vales são identificados, mesmo 
com o sinal filtrado. Isto ocorre, pois para a remoção de todos os picos e vales causados 
pelo ruído, seria necessário o uso de filtro de frequência de corte muito baixa, o que pode 
levar a uma suavização excessiva do sinal, descaracterizando-o.  Para evitar a suavização 
excessiva do sinal, um valor de amplitude mínima é definido como restrição para a 
identificação de picos e vales. O valor da amplitude mínima define a distância vertical 
mínima ente cada pico e vale, calculados através da primeira derivada, e objetiva 
identificar os verdadeiros picos e vales do sinal original sem a necessidade da remoção 
completa do ruído para evitar a descaracterização do sinal original. 

A Figura 4.10 ilustra o efeito do valor da amplitude mínima para identificação de picos 
e vales. 



4.5 Média - ? 35 
 

 

Figura 4.10: Identificação de picos e vales com amplitude mínima  de 1,5. 

O valor de amplitude mínima é definido com base na amplitude do sinal medido. Este 
valor é utilizado para identificação de picos e vales do sinal simulado e como condição 
para penalização do tipo de oscilação do sinal simulado do modelo através do cálculo do 
número de oscilações no problema de estimação de parâmetros. a cada interação do 
problema de estimação de parâmetros. Desta forma, é possível, através da identificação 
de picos e vales, descartar respostas que, apesar de conter o mesmo número de 
oscilações do sinal medido, não tenham o mesmo comportamento dinâmico de ciclo 
limite desejado, por terem amplitudes muito maiores ou muito menores. As 
implementações do cálculo do número de oscilações e definição da amplitude mínima 
são apresentadas no Apêndice B. 

4.5 Média - ? 
Sabendo-se a localização dos picos e vales do sinal, os pontos médios de subida e 

descida de cada ciclo podem ser facilmente identificados e representados por um vetor ?. 
Um ponto médio deve ser sempre seguido de um pico ou vale que, por sua vez, deve ser 
seguido de outro ponto médio, se houver mais de um ponto médio consecutivo, então 
existe um ponto médio causado pelo ruído. A Figura 4.11 apresenta os pontos médios dos 
ciclos do sinal oscilatório, com média variável, identificados e o sinal filtrado com a média 
variável removida. 



4.6 Cálculo do Erro 36 
 

 

Figura 4.11: Identificação de zeros e remoção de média variável. 

A partir da identificação dos pontos médios de subida e descida dos ciclos do sinal 
oscilatório, é possível traçar uma spline de ordem n entre os pontos, zero spline, na 
Figura 4.11. Através da identificação da spline, é retirada a média variável do sinal, caso 
ela exista, pela subtração entre o sinal filtrado e a spline. Com isso, a estimação de 
parâmetros é beneficiada, pois o efeito do distúrbio não medido é excluído. Por fim, o 
novo vetor ? é identificado no sinal filtrado sem média variável. As implementações da 
identificação dos pontos médios, criação da spline e retirada de média variável são 
apresentadas no Apêndice B. 

4.6 Cálculo do Erro 
O Método dos Mínimos Quadrados (MMQ) é o método mais simples de utilização em 

estimação de parâmetros. O método, apresentado na seção 2.4.4, possui variações de 
implementação, como por exemplo, o Método dos Mínimos Quadrados Ponderados 
(MMQP), utilizado para inserir pesos quando dois ou mais estados do sistema, com 
magnitudes diferentes, são considerados no cálculo. Outro método derivado do MMQ é o 
Método da Raiz Quadrada do Erro Quadrático Médio (RMSE, do inglês Root Mean 
Squared Error). Este último tem a vantagem principal de escalonamento do erro.  O MMQ 
aplicado neste trabalho consiste na mescla entre MMQP, visto que o erro quadrático de 
mais de uma variável é computado, e o método RMSE, para garantir a integridade 
estatística do resultado perante o escalonamento. A função objetivo resultante é: 

 ??? = ? ????
1
?.??

(
??????
??

)2??=1
?
?=1    (4.1) 

Onde ? é o número de variáveis medidas a serem consideradas no problema de 
estimação de parâmetros e ? o peso inserido e para ponderação de cada componente. 



4.7 Análise de Sensibilidade 37 
 

O MMQ é utilizado neste trabalho para fins de comparação de resultados entre o 
método clássico e o método proposto, apresentado na próxima seção. 

4.6.1 Função Objetivo Proposta 

A função objetivo proposta, chamada de FP, é composta por três termos. O primeiro 
termo é referente ao cálculo do erro quadrático do período (?), o segundo termo é 
referente ao cálculo do erro quadrático do número de oscilações (?) e o terceiro termo é 
referente ao cálculo da raiz quadrada do erro quadrático do somatório dos pontos médios 
de subida e descida dos ciclos (?). A equação a seguir apresenta a função proposta: 

 ?? =  ? ?(???? ? ???) + (??? ? ??? ) + ?? ?
???,????,?????????????

??
?
2

?
?=1  ?

?
?=1  (4.2) 

A diferença principal entre a abordagem clássica e a proposta, é que a clássica calcula 
o erro quadrático entre a trajetória da variável do sistema, enquanto que a abordagem 
proposta traduz a trajetória do sistema em métricas que capturam o comportamento 
oscilatório desejado. A primeira métrica captura o período de oscilação, a segunda 
métrica captura a amplitude do sinal e a terceira métrica captura a média. Portanto, o 
erro entre a métrica do sinal medido e simulado leva à captura do período, da amplitude, 
da média e também da fase do sinal, visto que a limitação do espaço temporal força o 
sistema simulado a entrar em fase com o sistema medido quando o objetivo é atingido. A 
implementação do cálculo da função objetivo é apresentada no Apêndice B. 

4.7 Análise de Sensibilidade 
Dadas as características não lineares e oscilatórias do sistema, a Análise de 

Sensibilidade Global será implementada. A análise de sensibilidade é utilizada para 
identificar os parâmetros mais influentes na saída do modelo. Como comentado no 
Capítulo 2, métodos clássicos de análise de sensibilidade não se aplicam a casos com ciclo 
limite. Para que a análise seja viável, é necessário que as características da saída do 
modelo, como periodicidade e forma, sejam capturadas. Para isso, a análise de 
sensibilidade global será feita através da função objetivo proposta. Desta forma, o 
período, a amplitude, a fase e a média são computados como saída do modelo e a análise 
da influência dos parâmetros no modelo pode ser realizada. A análise pode ser feita de 
maneira global, pela computação dos três termos simultaneamente, ou individual, 
analisando a influência dos parâmetros em cada um dos termos individualmente. A 
análise individual permite ajustar alguma das características da dinâmica do sistema pela 
estimação de parâmetros com o conjunto de parâmetros reduzido, no entanto, esta 
última etapa não será abordada neste trabalho. 

Análise de Sensibilidade Sobol 

A análise de sensibilidade Sobol, proposta por Sobol (1990), é utilizada para 
determinar o quanto da variabilidade na saída do modelo esta relacionada com a 
variabilidade de cada um dos parâmetros, tanto individualmente, quanto com a interação 
entre estes (Zhang et al., 2015). 

A implementação do método é composta por quatro passos: 1) geração do conjunto 
de parâmetros através da sequência de Sobol, 2) simulação do modelo, 3) cálculo dos 



4.8 Estrutura de Otimização 38 
 
índices de sensibilidade e 4) análise dos índices de sensibilidade de ordem total, primeira 
ordem, segunda ordem e ordens superiores. 

O cálculo das ordens de interação reflete a influência de um parâmetro 
individualmente, primeira ordem, dos pares de parâmetros, segunda ordem, e do 
conjunto de parâmetros, ordem superior.  Seja ? = [?1, … , ??] o conjunto de parâmetros. 
Cada um dos parâmetros varia em um intervalo finito de validade, podendo ser assumido 
[0, 1], depois de escalonado. A saída do modelo é considerada uma função dos 
parâmetros, ou seja, ?(?), sendo ? a função objetivo proposta. Sob a interpretação 
probabilística dos parâmetros, ?(?) é uma variável aleatória com média ?0 e variância ?: 

 ?0 = ??(?)?? (4.3) 

 ? = ??(?)²?? ? ?0² (4.4) 

O método é baseado na composição de ?  nas ordens de interação entre os 
parâmetros. Primeiramente ?(?) é decomposto: 

 ?(?) = ?0 +  ? ??(??)
?
?=1 + ? ? ??????, ???

?
??? + ? + ?1…?(?1, … , ??)

?
?=1  (4.5) 

Então ??1…?? = ??
2
?1…??

???1, … , ???????1, … , ??? é a variância de ??1…?????1, … , ????, 
chamada de variância parcial do subconjunto ???1, … , ????. O índice de sensibilidade do 
subconjunto é então definido: 

 ??1…?? =
??1…??
?

 (4.6) 

Por exemplo, ?1 =  
?1
?

 é a contribuição de primeira ordem do primeiro parâmetro na 

variância da saída do modelo e ?12 =  
?12
?

 é a contribuição de segunda ordem entre o 
primeiro e o segundo parâmetro. A ordem total é dada pelo somatório de todos os 
índices de sensibilidade ??? = ?? + ?????? + ? + ?1….?…?. 

Quanto maior o índice de sensibilidade, maior a influência do parâmetro na saída do 
modelo analisada. Neste trabalho, apenas a ordem total será analisada. 

4.8 Estrutura de Otimização 
Para desenvolvimento deste trabalho foi utilizada a linguagem de programação 

Python (Van Rossum &amp;amp; Drake, 2011) e a plataforma JModelica.org (Akesson et al., 2010). 
JModelica.org é uma plataforma open source baseada na linguagem Modelica (Modelica 
Association, 2014), utilizada para simulação, otimização e análise de sistemas complexos. 
Esta plataforma utiliza a linguagem open source Python para fazer a interface com o 
usuário. Pacotes como Numpy e Scipy (Walt et al., 2011), Matplotlib (Hunter, 2007), 
Scikit-learn (Pedregosa et al., 2012) são usados para realizar a computação numérica. A 
implementação utiliza: o integrador SUNDIALS (Hindmarsh et al., 2005); o algoritmo de 
otimização local por região de confiança sem restrições BOBYQA e o algoritmo de 
otimização global DIRECT são utilizados através do pacote NLopt (Johnson, 2015). 

A Figura 4.12 mostra o esquema da implementação da estimação de parâmetros. O 
processo de estimação de parâmetros possui um loop interno e um loop externo. O loop 
interno é regido pelo algoritmo de otimização que define o menor valor da função 



4.8 Estrutura de Otimização 39 
 
objetivo para cada avaliação realizada. O loop externo é regido por uma função erro entre 
o melhor valor definido pelo algoritmo de otimização no loop interno atual com o melhor 
valor do loop interno anterior. Visto que a função objetivo proposta tende a melhorar a 
convergência do problema de otimização, é vantajoso definir limites menores a cada 
interação do loop interno de otimização e do que um limite muito grande com apenas 
uma única interação, pois insto torna o processo mais custoso computacionalmente e 
pode levar a erros mais grosseiros na busca pelo mínimo global. 

Os dados de referência são analisados e o período, o número de oscilações e os 
pontos médios dos ciclos são armazenados para cálculo da função objetivo a cada 
interação do algoritmo de otimização. Nesta etapa também é definido o valor de 
amplitude mínima, dado de entrada para cálculo do número de oscilações dos dados 
simulados. 

A estrutura com loop interno e loop externo é valida tanto para a função objetivo 
proposta, quanto para o método dos mínimos quadrados. Além disso, todas 
configurações dos algoritmos são iguais para ambas funções objetivo. 



4.8 Estrutura de Otimização 40 
 

 

Figura 4.12: Fluxograma de otimização para a função objetivo proposta. 



4.9 Métricas de Desempenho das Funções Objetivo 41 
 

4.9 Métricas de Desempenho das Funções Objetivo  
Nesta seção, são introduzidas as métricas de desempenho que serão utilizadas para 

realizar a análise exaustiva da função objetivo proposta. A análise é composta por cinco 
métricas de desempenho. As quatro primeiras foram formuladas por Secchi (2000) e 
correspondem ao cálculo da eficácia (?), eficiência (?), robustez (?) e qualidade a solução 
obtida (?). As equações abaixo descrevem o cálculo das respectivas métricas: 

 ?? =  
1
?
?

??
?

??,?
?
?=1  (4.7) 

 ?? =  
1
?
?

???
?

???,?
?
?=1  (4.8) 

 ?? =
???
??

 (4.9) 

 ?? =
1
?

 ?
(??

?+?)

(??,?+?)
?
?=1  (4.10) 

onde ? é o algoritmo de otimização, ??,? é o seu tempo computacional para resolver o 
problema ?, ??

? é o menor tempo entre os algoritmos para resolver o problema ?, ???,? é 
o seu número de avaliações da função objetivo para resolver o problema ?, ???

? é o 
menor número de avaliações entre os algoritmos para resolver o problema ?, ??

? é a 
melhor qualidade da solução para o problema ?, ??,? é a qualidade da solução para o 
problema ? e ? é a precisão do computador. ??? é o seu número de problemas resolvidos 
e ?? é o número total de problemas. Os resultados variam entre 0 e 1. 

No entanto, assim como para a análise de sensibilidade, estas métricas não 
contabilizam a capacidade da função objetivo em conferir comportamento oscilatório ao 
sistema. Portanto, uma nova métrica é proposta para cálculo da eficiência de oscilação: 

 ?? =
1
?
? ?

?

??+???[??? ??,?]
?
?=1  (4.11) 

onde ?? é o número de oscilações desejado, ??,? é o número de oscilações da função 
objetivo para resolver o problema ? e ??? é a função que retorna o valor absoluto da 
operação matemática. Portanto, é calculado o desvio do valor ótimo da resposta 
oscilatória. O resultado varia de 0 e 1,0 (para sinais com número de oscilações desejável), 
sendo 0,5 o valor para sinais sem oscilação. 

 



 
  

 Aplicação dos Modelos de Capítulo 5 –
Lotka-Volterra e Jöbses et al. (1986) 

Neste capítulo, serão abordadas as estimações de parâmetros dos modelos de Lotka-
Volterra e de Jöbses et al. (1986). Inicialmente, serão apresentadas as formulações dos 
modelos. Posteriormente, é feita a análise de sensibilidade e os parâmetros a serem 
estimados são definidos. Após, diferentes cenários para a estimação de parâmetros de 
cada modelo é apresentada. Duas análises são feitas para avaliação do desempenho das 
funções objetivo proposta e o método de mínimos quadrados. A primeira é uma análise 
qualitativa e visual envolvendo os dois modelos, discutidos separadamente. A segunda é 
uma análise quantitativa exaustiva envolvendo apenas o modelo de Jöbses et al. (1986). 

5.1 Lotka-Volterra 
O primeiro modelo matemático elaborado para descrever a dinâmica de duas 

populações interagindo como um sistema predador-presa foi sugerido 
independentemente por A. Lotka  e V. Volterra e é dados por: 

 
??
??

= (??1. ?) + (?2. ?. ?) (5.1) 

 
??
??

= (?3. ?) ? (?4. ?. ?) (5.2) 

Neste sistema, ? &gt;  0 e ? &gt;  0 denotam os tamanhos das populações da presa e do 
predador, respectivamente. ?1 &gt; 0 é a taxa de reprodução da população de presas na 
ausência de predadores,  ?2 &gt; 0 é a taxa per capita do consumo de presas pela 
população de predadores, ?3 &gt; 0 é a taxa de mortalidade dos predadores na ausência 
das presas e ?4 &gt; 0 é a taxa de biomassa de presas que é convertida em biomassa de 
predadores. O modelo tem como base as seguintes idealizações (Vérri 2013): 

1. Na ausência de predadores, a população de presas cresce exponencialmente de 
acordo com a lei de Malthus. 

2. Se não houver presas, a população de predadores decai exponencialmente. 



5.2 Jöbses et al. (1986) 43 
 

 

3. A quantidade total de presas consumidas pelos predadores por unidade de 
tempo depende linearmente da densidade populacional de ambos, predadores 
e presas. 

4. A porção de biomassa de presas que é convertida em biomassa de predadores 
é constante. 

5. Nenhum outro fator afeta a dinâmica do sistema. 

Sendo que as condições iniciais da simulação são ? = 0,4 e ? = 1,0 e o valor dos 
parâmetros de referência igual a 1,0 para ?1, ?2 e ?3 e 0,4 para ?4.  

5.2 Jöbses et al. (1986) 
O sistema proposto por Jöbses et al. (1986) modela a fermentação contínua da 

bactéria Zymomonas mobilis. Este é um modelo não segregado e estruturado que divide a 
biomassa em dois compartimentos e introduz uma nova variável, o componente chave, 
que leva em consideração a influência da concentração de produto no meio reativo. Este 
modelo é caracterizado pela existência de ciclo limite. 

O modelo dinâmico definido em Jöbses et al. (1986) é constituído por quatro variáveis 
de estado: substrato (?), biomassa (?), produto (?) e o componente chave (?). Os estados 
são equacionados como segue: 

 
???
??

= ?? 1
???

?? ??.??
??+??

? ? ??. ?? + ??. (??0 ? ??) (5.3) 

 
???
??

= ? ??.??
??+??

? + ??. (??0 ? ??) (5.4) 

 
???
??

= (?1 ? ?2. ?? + ?3. ??2) ?
??.??
??+??

? + ??. (??0 ? ??) (5.5) 

 
???
??

= ? 1
???

?? ??.??
??+??

? + ??. ?? + ??. (??0 ? ??) (5.6) 

Onde ?? é a concentração do componente chave ? (kg/m³), ?? é a concentração de 
produto (kg/m³), ??  é a produção de substrato (kg/m³) e ??  é a concentração de 
biomassa (kg/m³). Os demais termos referem-se aos parâmetros do modelo conforme 
descrito na Tabela 5.1. 



5.3 Análise do Plano de Fase 44 
 

 

Tabela 5.1: Valores dos parâmetros do modelo de Jöbses et al. (1986). 

Parâmetro [Unidade] Descrição Valor 

??0 [kg/m³] 
Concentração de 
alimentação de 

substrato 
200,0 

??0 [kg/m³] 
Concentração de 
alimentação do 

componente chave 
0 

??0 [kg/m³] 
Concentração de 

alimentação do produto 
0 

??0 [kg/m³] 
Concentração de 
alimentação de 

biomassa 
0 

?? [h
-1] Taxa de diluição 0,07 

?? [kg/m³] Constante de Monod 0,5 

?1 [h
-1] 

Constante da taxa de 
reação 

16,0 

?2 [m³/kg.h] 
Constante da taxa de 

reação 
0,497 

?3 [m
6/kg2.h] 

Constante da taxa de 
reação 

0,00383 

?? [kg/kg.h] 
Fator de manutenção 

baseado na formação de 
substrato 

2,16 

?? [kg/kg.h] 
Fator de manutenção 

baseado na formação de 
produto 

1,55 

??? [kg/kg] 
Fator de redimento da 
conversão de substrato 

em biomassa 
0,023 

??? [kg/kg] 
Fator de rendimento da 
conversão de biomassa 

em produto 
0,05 

Sendo que as condições iniciais do sistema são ?? = 80,67 kg/m³, ?? = 1,47 kg/m³,  
?? = 0,08 kg/m³ e ?? = 58,08 kg/m³. 

5.3 Análise do Plano de Fase 
A análise do plano de fase dos modelos é utilizada para comprovação da existência de 

ciclo limite no cenário estudado. Portanto, ambos os modelos foram simulados com as 
informações de parâmetros e condições iniciais fornecidos e os planos de fase são 
apresentados na Figura 5.1.a e Figura 5.1.b os modelos de Lotka-Volterra e Jöbses et al. 
(1986), respectivamente. 



5.3 Análise do Plano de Fase 45 
 

 

a)  

b)  

Figura 5.1: Plano de fase para o modelo de Lotka-Volterra: a) simulação com constantes 
de reação igual a 1 e b) simulação constantes de reação igual a 2. 

Na Figura 5.1.a é possível identificar o ciclo limite formado no gráfico entre as duas 
variáveis de estado do modelo de Lotka-Volterra. A Figura 5.1.b mostra o plano de fase do 
modelo simulado com os valores dos parâmetros multiplicados por dois. Comparando os 



5.3 Análise do Plano de Fase 46 
 

 

dois planos de fase, é visto que uma mudança nos parâmetros do modelo provoca uma 
alteração significativa no comportamento do modelo. No entanto, o sistema permanece 
em ciclo limite.  

a)  

b)  

Figura 5.2: Plano de fase para o modelo de Jöbses: a) simulação com parâmetros originais 
e b) simulação com variação de 50% nos parâmetros originais. 



5.4 Análise de Sensibilidade 47 
 

 

O plano de fase do modelo de Jöbses et al. (1986) é apresentado na Figura 5.2.a. 
Assim como o modelo de Lotka-Volterra, o modelo de Jöbses et al. (1986) também 
apresenta formação de ciclo limite no gráfico entre as variáveis de estado. Também foi 
feita uma alteração nos parâmetros do modelo de Jöbses et al. (1986) e a mudança de 
comportamento é mostrada na Figura 5.2.b. A análise gráfica da mudança de 
comportamento sugere também que o modelo de Jöbses et al. (1986) é bastante sensível 
aos valores de seus parâmetros. 

5.4 Análise de Sensibilidade  
A análise de sensibilidade dos modelos é conduzida com o objetivo de selecionar os 

parâmetros que serão utilizados na estimação de parâmetros como variáveis de decisão 
do problema de otimização. A redução do número de parâmetros a serem estimados nos 
modelos de Lotka-Volterra e Jöbses et al. (1986) tem por objetivo viabilizar a análise de 
convexidade da função objetivo e a análise do resultado da estimação de parâmetros. 
Desta forma, serão selecionados dois parâmetros para o modelo de Lotka-Volterra e três 
parâmetros para o modelo de Jöbses et al. (1986).  

Lotka-Volterra 

A análise de sensibilidade do sistema foi feita utilizando os parâmetros ?1, ?2, ?3 e ?4. 
O modelo foi simulado com os parâmetros originais. Os estados ? e ? foram definidos 
como referência para cálculo do erro das métricas para avaliar a influência dos 
parâmetros na dinâmica do sistema. A partir dos parâmetros iniciais, os limites inferior e 
superior dos parâmetros foram definidos como sendo 10% e 190% dos parâmetros, 
respectivamente. Os resultados da análise de sensibilidade são apresentados na 
Figura 5.3. 

 

Figura 5.3: Índices de sensibilidade total do modelo de Lotka-Volterra. 

A análise de sensibilidade mostra que os parâmetros que mais influenciam na saída do 
modelo são os parâmetros ?1 e ?3. Portanto, para fins de análise de convexidade e 

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

k1 k2 k3 k4

Ín
di

ce
 d

e 
Se

ns
ib

ili
da

de
 

Parâmetros 



5.4 Análise de Sensibilidade 48 
 

 

estimação de parâmetros, estes dois parâmetros serão utilizados, mantendo os 
parâmetros ?2 e ?4 com seus valores originais. 

Jöbses et al. (1986) 

A análise de sensibilidade do sistema foi feita utilizando os parâmetros ??, ??, ?1, ?2, 
?3, ?4, ??, ??, ??? e ???. O modelo foi simulado com os parâmetros originais, presentes 
na Tabela 5.1. Assim como para o modelo de Lotka-Volterra, os estados do modelo foram 
definidos como referência para cálculo do erro das métricas para avaliar a influência dos 
parâmetros na dinâmica do sistema. A partir dos parâmetros iniciais, os limites inferior e 
superior dos parâmetros foram definidos como sendo 10% e 190% dos parâmetros, 
respectivamente. Os resultados da análise de sensibilidade são apresentados na 
Figura 5.4. 

 

Figura 5.4: Índices de sensibilidade total do modelo de Jöbses et al. (1986). 

A análise de sensibilidade do modelo de Jöbses et al. (1986) mostra que os três 
parâmetros que mais influenciam na saída do modelo são os parâmetros ???, ?? e  ??. 
Portanto, para fins de estimação de parâmetros, e para aumentar o grau de 
complexidade da estimação frente ao modelo de Lotka-Volterra, estes três parâmetros 
serão utilizados, mantendo os demais parâmetros com seus valores originais. No entanto, 
para ilustrar a análise de convexidade, apenas os dois parâmetros mais influentes serão 
considerados por questões de visualização. 

5.4.1 Análise de Convexidade 

A análise de convexidade do modelo de Jöbses et al. (1986) foi feita em função dos 
parâmetros ??? e ??, aos quais o modelo se mostrou mais sensível. Já a análise de 
convexidade do modelo de Lotka-Volterra foi feita para os parâmetros ?1 e ?3. A análise 
foi realizada para a função objetivo proposta e comparada com o método de mínimos 
quadrados. Os resultados são ilustrados na Figura 5.5 e Figura 5.6. 

0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9

1

Df Ks k1 k2 k3 k4 ms mp Ysx Ypx

Ín
di

ce
 d

e 
Se

ns
ib

ili
da

de
 

Parâmetros 



5.4 Análise de Sensibilidade 49 
 

 

a)  

b)  

Figura 5.5: Função objetivo do MMQ para: a) Lotka-Volterra e b) Jöbses et al. (1986), 
demonstrando a convexidade do problema. 

A Figura 5.5.a mostra que, quando a estimação de parâmetros do modelo de Lotka-
Volterra é realizada considerando apenas o método de mínimos quadrados, o problema é 
altamente não convexo, de modo que existem vários mínimos locais próximos ao mínimo 



5.4 Análise de Sensibilidade 50 
 

 

global. Além disso, a função objetivo não é convergente próximo ao mínimo global, assim 
como não é penalizada longe deste. Isto implica que um chute inicial distante do valor 
correto para os parâmetros pode levar a uma solução distante do ótimo global, 
inviabilizando a utilização de algoritmos locais de otimização além de dificultar a 
aplicação de algoritmos globais.  



5.4 Análise de Sensibilidade 51 
 

 

a)  

b)  

Figura 5.6: Função objetivo proposta para: a) Lotka-Volterra e b) Jöbses et al. (1986), 
demonstrando a convexidade do problema. 

No entanto, quando a metodologia sugerida neste trabalho é utilizada, Figura 5.6.a, a 
não convexidade do problema é reduzida. O problema torna-se mais convergente ao 
redor do mínimo global e regiões distantes deste são mais penalizadas. Dessa forma a 



5.5 Cenários 52 
 

 

vantagem da metodologia proposta é que mesmo para um chute inicial distante, o 
conjunto de parâmetros pode convergir com mais facilidade para valores que levam a 
simulação para próximo da região com ciclo limite. 

O mesmo ocorre para o modelo de Jöbses et al. (1986). Apesar do problema de 
otimização não ser tão não convexo quanto para o modelo de Lotka-Volterra, como pode 
ser visto na Figura 5.5.b, pode-se notar na Figura 5.6.b que regiões longe do mínimo 
global são penalizadas e o problema tende a convergir mais próximo deste. Além disso, o 
mínimo global é mais evidente. Além disso, os platôs que surgem na Figura 5.6.b não são 
críticos para algoritmos de otimização que não utilizam derivada, como os utilizados 
neste trabalho. 

5.5 Cenários 
Para avaliar a função objetivo proposta, simulações do modelo de Lotka-Volterra e de 

Jöbses et al. (1986) foram realizadas considerando diferentes cenários previamente 
definidos. Primeiramente, partindo-se do mínimo global, que é sabido de antemão, 
diferentes conjuntos de parâmetros iniciais foram definidos. Esta etapa consiste na 
estimação de parâmetros frente à discrepância paramétrica do modelo. Posteriormente, 
para o modelo de Lotka-Volterra, um ruído branco foi inserido. Para o modelo de Jöbses 
et al. (1986), foram feitas perturbações no sistema. Esta etapa posterior consiste na 
estimação de parâmetros frente à discrepância estrutural do modelo.  

5.5.1 Lotka-Volterra 

Dados de referência, ou medições experimentais, foram gerados com os parâmetros 
apresentados na Seção 4.1, levando em conta dois cenários distintos. No cenário A, 
nenhuma perturbação ou distúrbio foram considerados. No cenário B, um ruído branco 
foi inserido nas variáveis de estado do modelo, como mostrado na Figura 5.7. 



5.5 Cenários 53 
 

 

 

Figura 5.7: Dados de referência do modelo Lotka-Volterra com ruído branco. 

5.5.2 Jöbses et al. (1986) 

Dados de referência foram gerados considerando os valores de parâmetros 
apresentados na Tabela 5.1, levando em conta três cenários distintos. No cenário A 
nenhuma perturbação ou distúrbio foram considerados. No cenário B, foi inserido um a 
concentração de alimentação de substrato ??0 foi perturbada conforme ilustrado na 
Figura 5.8. No cenário C, a mesma variação na concentração de alimentação de substrato 
??0 foi inserida na estimação de parâmetros como distúrbio não medido, i.e., não levado 
em conta como entrada no modelo. 



5.6 Estimação de Parâmetros – Análise Quantitativa 54 
 

 

 

Figura 5.8: Perturbação na variável ??0. 

Embora o modelo de Jöbses et al. (1986) tenha quatro variáveis de estado, apenas 
duas variáveis de saída são consideradas medidas no problema de estimação de 
parâmetros, ?? e ?? uma vez que essas são as medidas mais factíveis de serem medidas 
em um processo de Jöbses et al. (1986) real. Além disso, a partir delas todos os demais 
estados são observáveis. 

5.6 Estimação de Parâmetros – Análise Quantitativa 
Nesta seção, são apresentados os resultados da estimação de parâmetros dos 

modelos de Jöbses et al. (1986) e Lotka-Volterra, conforme os respectivos cenários 
apresentados anteriormente, aplicando a função objetivo proposta e comparando com o 
método dos mínimos quadrados. Os parâmetros foram estimados para ajustar o modelo 
aos dados de referência, aplicando os algoritmos de otimização local BOBYQA e global 
DIRECT. Visto que os dados de referência são gerados a partir de valores conhecidos dos 
parâmetros ótimos, a acurácia da estimação de parâmetros pôde ser mensurada. Além 
disso, uma análise gráfica qualitativa dos resultados é apresentada. 

5.6.1 Lotka-Volterra 

Para o modelo de Lotka-Volterra, foram feitas dez estimações de parâmetros. A 
estimação de parâmetros possui dois parâmetros de decisão, ?1 e ?3, definidos através 
da análise de sensibilidade. 

Desvios nos valores ótimos dos parâmetros foram realizados, sendo estes usados 
como chutes iniciais na etapa de estimação de parâmetros para cada um dos cenários 



5.6 Estimação de Parâmetros – Análise Quantitativa 55 
 

 

descritos acima. A Tabela 5.2 apresenta estes valores. As duas variáveis de estado do 
modelo de Lotka-Volterra são consideradas medidas no problema de estimação de 
parâmetros. 

Tabela 5.2: Conjuntos de chutes iniciais para os parâmetros do modelo Lotka-Volterra. 

Parâmetro 
[Unidade] 

Conjunto 1 Conjunto 2 Conjunto 3 Conjunto 4 

?1 [-] 0,5 1,5 2,0 3,5 
?3 [-] 0,5 1,5 2,0 3,5 

 

5.6.1.1 Cenário A 

A Figura 5.9, Figura 5.10, Figura 5.11 e Figura 5.12 comparam a simulação utilizando 
os parâmetros ótimos encontrados para cada conjunto de chutes iniciais, contidos na 
Tabela 5.2, através do algoritmo BOBYQA, para o Cenário A. Os parâmetros estimados são 
mostrados na Tabela 5.3 com os correspondentes erros absolutos frente aos valores 
originais.  

a)  b)  

Figura 5.9: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 1 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 56 
 

 

a)  b)  

Figura 5.10: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

a)  b)  

Figura 5.11: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com  o Conjunto 3 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 57 
 

 

a)  b)  

Figura 5.12: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando BOBYQA para o Cenário A com o Conjunto 4 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

Utilizando o algoritmo local, os parâmetros estimados através do MMQ apresentaram 
bons resultados apenas para os chutes iniciais do Conjunto 1 e 2, Figura 5.9 e Figura 5.10, 
respectivamente. Para o Conjunto 3 e 4, Figura 5.11 e Figura 5.12, respectivamente, os 
parâmetros estimados levaram o sistema para uma região não oscilatória. O erro 
calculado dos parâmetros estimados ficou acima de 40% para os quatro conjuntos de 
parâmetros no Cenário A, Tabela 5.3. A estimação de parâmetros empregando a função 
objetivo proposta apresentou bons resultados para todos os conjuntos de chutes iniciais, 
sendo que para o Conjunto 1, o erro ficou abaixo de 5%. No entanto para os demais 
conjuntos apresentou também erro acima de 40%. Apesar dos resultados com altos erros, 
em todas as estimações a função objetivo proposta estimou um conjunto de parâmetros 
que conferiu comportamento oscilatório ao sistema.  

Tabela 5.3: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário A utilizando BOBYQA. 

 ?1 estimado ?3 estimado Erro ?1 Erro ?3 
MMQ Conjunto 1 0,483  0,489 51,690 51,074 

FP Conjunto 1 0,945  1,006 5,466 0,667 
MMQ Conjunto 2 1,423 0,563 42,303 43,668 

FP Conjunto 2  1,515 0,522 51,514 47,730 
MMQ Conjunto 3 3,773 0,000 277,366 100,000 

FP Conjunto 3 1,828 0,417 82,878 58,228 
MMQ Conjunto 4 3,773 0,000 277,363 100,000 

FP Conjunto 4 1,812 0,433 81,243 56,658 

 



5.6 Estimação de Parâmetros – Análise Quantitativa 58 
 

 

A Figura 5.13, Figura 5.14, Figura 5.15 e Figura 5.16 compara a simulação utilizando os 
parâmetros ótimos encontrados para cada conjunto de chutes iniciais, contidos na 
Tabela 5.2, através do algoritmo DIRECT, para o Cenário A. Os parâmetros estimados são 
mostrados na Tabela 5.4 com os correspondentes erros absolutos frente aos valores 
originais.  

a)  b)  

Figura 5.13: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com  o Conjunto 1 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

a)  b)  

Figura 5.14: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com  o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 59 
 

 

a)  b)  

Figura 5.15: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com o Conjunto 3 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

a)  b)  

Figura 5.16: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário A com o Conjunto 4 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

Utilizando o algoritmo global, o erro absoluto entre os parâmetros estimados e os 
parâmetros originais é menor em comparação ao erro apresentado pelo algoritmo local, 
como mostrado na Tabela 5.4. Os parâmetros estimados através do MMQ novamente 
apresentaram bons resultados, como mostra a Figura 5.14, Figura 5.15 e Figura 5.16. 
Exceto para o Conjunto 1, onde a Figura 5.13.a mostra que o estado estimado, apesar de 
oscilatório, não tem a mesma dinâmica que o sistema medido. O erro calculado dos 
parâmetros estimados ficou acima de 10% para o Conjunto 1, 2 e 4 de parâmetros no 
Cenário A, como mostra a Tabela 5.4. Apenas a estimação de parâmetros partindo do 
Conjunto 3 apresentou erro menor que 10%. A estimação de parâmetros empregando a 



5.6 Estimação de Parâmetros – Análise Quantitativa 60 
 

 

função objetivo proposta apresentou novamente bons resultados, agora para todos os 
conjuntos de parâmetros com erro absoluto abaixo de 2%, conforme Tabela 5.4. 

Tabela 5.4: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário A utilizando DIRECT. 

 ?1 estimado ?3 estimado Erro ?1 Erro ?3 
MMQ Conjunto 1 0,425 0,709 57,407 29,012 

FP Conjunto 1 0,999 0,999 0,001 0,012 
MMQ Conjunto 2 1,053 0,888 5,281 11,134 

FP Conjunto 2 0,999 0,999 0,013 0,036 
MMQ Conjunto 3 0,968 1,089 3,155 8,916 

FP Conjunto 3 0,987 1,002 1,293 0,196 
MMQ Conjunto 4 1,153 0,748 15,279 25,191 

FP Conjunto 4 1,000 1,000 0,007 0,019 
 

5.6.1.2 Cenário B 

Para avaliar o efeito do ruído, a estimação de parâmetros foi repetida utilizando os 
dados com ruído branco do Cenário B. A Figura 5.17 apresenta o resultado da estimação 
de parâmetros utilizando o algoritmo DIRECT para o Conjunto 4. 

a)  b)  

Figura 5.17: Resultados da estimação de parâmetros do modelo de Lotka-Volterra 
utilizando DIRECT para o Cenário B com o Conjunto 4 como chute inicial. Figuras a) e b) 

apresentam os estados ? e ?, respectivamente. 

A estimação de parâmetros através do MMQ apresentou erro absoluto de 
aproximadamente 50% para ambos os parâmetros, conforme Tabela 5.5. O erro absoluto 
foi maior do que o apresentado no Cenário A, mostrando que a influência que o MMQ 



5.6 Estimação de Parâmetros – Análise Quantitativa 61 
 

 

sofre com ruídos é significativa. No entanto, sistema resultante ainda apresenta 
oscilações. 

Utilizando a FP, apesar do erro absoluto também ser maior em comparação ao 
Cenário A, esta foi capaz de estimar os parâmetros com erro absoluto inferior a 4%. Visto 
que a função objetivo proposta utiliza apenas a frequência fundamental do sinal para 
cálculo do período, o ruído branco, de frequência alta, não interfere no cálculo. 

Tabela 5.5: Valores estimados e erros absolutos dos parâmetros ?1 e ?2 do modelo de 
Lotka-Volterra para o Cenário B utilizando DIRECT. 

 ?1 estimado ?3 estimado Erro ?1 Erro ?3 
MMQ Conjunto 4 0,518 0,476 48,214 52,342 

FP Conjunto 4 0,995 1,035 0,507 3,544 
 

5.6.2 Jöbses et al. (1986) 

Para o modelo de Jöbses et al. (1986), foram feitas trinta e seis estimações de 
parâmetros. A estimação de parâmetros possui três parâmetros de decisão, ??, ?? e 
???, definidos através da análise de sensibilidade. 

Desvios nos valores ótimos dos parâmetros foram realizados, sendo estes usados 
como chutes iniciais na etapa de estimação de parâmetros para cada um dos cenários 
descritos acima. A Tabela 5.6 apresenta estes valores. 

Tabela 5.6: Conjuntos de chutes iniciais para os parâmetros do modelo Jöbses et al. 
(1986). 

Parâmetro [Unidade] Conjunto 1 Conjunto 2 Conjunto 3 

?? [kg/kg.h] 1,08 3,240 5,400 
?? [kg/kg.h] 0,775 2,325 3,875 
??? [kg/kg] 0,025 0,075 0,125 

5.6.2.1 Cenário A 

A Figura 5.18, Figura 5.19 e Figura 5.20 comparam a simulação utilizando os 
parâmetros ótimos encontrados para cada conjunto de chutes iniciais, contidos na 
Tabela 5.6, através do algoritmo BOBYQA, para o Cenário A. Os parâmetros estimados são 
mostrados na Tabela 5.7 com os correspondentes erros absolutos frente aos valores 
originais. 



5.6 Estimação de Parâmetros – Análise Quantitativa 62 
 

 

a)  b)  

Figura 5.18: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 1 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

a)  b)  

Figura 5.19: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 63 
 

 

a)  b)  

Figura 5.20: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário A com o Conjunto 3 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

Os resultados para ambas as funções objetivo, MMQ e proposta, apresentaram erros 
acima de 15% frente aos valores originais, como mostra Tabela 5.7. No entanto, como 
apresentado na Figura 5.18, Figura 5.19 e Figura 5.20, os parâmetros estimados através 
da FP conferiram comportamento oscilatório ao sistema, para ambos os estados medidos, 
o que não ocorreu para o caso dos parâmetros estimados através do MMQ, que 
convergiram o sistema para uma região não oscilatória. 



5.6 Estimação de Parâmetros – Análise Quantitativa 64 
 

 

Tabela 5.7: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do modelo 
de Jöbses et al. (1986) para o Cenário A utilizando BOBYQA. 

 
??? 

estimado 
?? 

estimado 
?? 

estimado 
Erro ??? 

[%] 
Erro ?? 

[%] 
Erro ?? 

[%] 
MMQ 

Conjunto 
1 

0,043 0,886 1,284 13,282 42,841 40,577 

FP 
Conjunto 

1 
0,063 1,309 1,232 5,891 15,532 42,938 

MMQ 
Conjunto 

2 
0,042 0,805 1,351 16,618 48,037 37,449 

FP 
Conjunto 

2 
0,059 1,235 1,197 19,896 20,313 44,599 

MMQ 
Conjunto 

3 
0,040 0,7168 1,378 19,953 53,753 36,198 

FP 
Conjunto 

3 
0,058 1,186 1,244 17,498 23,501 42,383 

 

Para o Cenário A, através do algoritmo global de otimização DIRECT, os resultados 
para ambas as funções objetivo, MMQ e FP, apresentaram ótimos resultados, com erro 
de aproximadamente 0% para todos os conjuntos de parâmetros. 

5.6.2.2 Cenário B 

Para estudar o efeito do distúrbio medido, a estimação de parâmetros foi repetida 
com perturbação em ??0, Figura 5.8, a qual é informada como entrada no modelo. A 
Figura 5.21, Figura 5.22 e Figura 5.23 comparam as simulações utilizando os parâmetros 
ótimos encontrados para cada conjunto de chutes iniciais, contidos na Tabela 5.6, através 
do algoritmo BOBYQA, para o Cenário B. Os parâmetros estimados são mostrados na 
Tabela 5.8 com os correspondentes erros absolutos frente aos valores originais. 



5.6 Estimação de Parâmetros – Análise Quantitativa 65 
 

 

a)  b)  

Figura 5.21: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com o Conjunto 1 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

a)  b)  

Figura 5.22: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com  o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 66 
 

 

a)  b)  

Figura 5.23: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário B com o Conjunto 3 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

Utilizando o algoritmo local, os parâmetros estimados através do MMQ apresentaram 
bons resultados apenas para o Conjunto 2, onde o sistema apresenta dinâmica 
oscilatória, Figura 5.22. Para o Conjunto 1, Figura 5.23, o sistema convergiu para uma 
região não oscilatória, enquanto que para o Conjunto 3, apesar de o sistema apresentar 
comportamento oscilatório, o erro dos parâmetros chega a 150%, como mostra a 
Tabela 5.8. A estimação de parâmetros empregando a FP apresentou bons resultados 
para o Conjunto 1, com erro abaixo de 2%. No entanto, para os demais conjuntos 
apresentou erro acima de 25%, chegando também a 150% para o Conjunto 3. 



5.6 Estimação de Parâmetros – Análise Quantitativa 67 
 

 

Tabela 5.8: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do modelo 
de Jöbses et al. (1986) para o Cenário B utilizando BOBYQA. 

 
??? 

estimado 
?? 

estimado 
?? 

estimado 
Erro ??? 

[%] 
Erro ?? 

[%] 
Erro ?? 

[%] 
MMQ 

Conjunto 
1 

0,049 0,879 0,989 0,045 43,247 54,184 

FP 
Conjunto 

1 
0,049 1,519 2,141 1,078 1,963 0,869 

MMQ 
Conjunto 

2 
0,043 1,863 3,054 12,996 20,211 41,432 

FP 
Conjunto 

2 
0,063 1,156 0,928 27,658 25,355 56,994 

MMQ 
Conjunto 

3 
0,124 2,294 5,610 148,630 48,010 159,749 

FP 
Conjunto 

3 
0,112 2,132 5,377 125,380 37,593 148,957 

  

A Figura 5.24, Figura 5.25 e Figura 5.26 comparam as simulações utilizando os 
parâmetros ótimos encontrados para cada conjunto de chutes iniciais, contidos na 
Tabela 5.6, através do algoritmo DIRECT, para o Cenário B. Os parâmetros estimados são 
mostrados na Tabela 5.9 com os correspondentes erros absolutos frente aos valores 
originais. 



5.6 Estimação de Parâmetros – Análise Quantitativa 68 
 

 

a)  b)  

Figura 5.24: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com o Conjunto 1 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

a)  b)  

Figura 5.25: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com  o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 



5.6 Estimação de Parâmetros – Análise Quantitativa 69 
 

 

a)  b)  

Figura 5.26: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário B com o Conjunto 3 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

Utilizando o algoritmo global, os parâmetros estimados através do MMQ não 
apresentaram bons resultados. Para todos os conjuntos de chutes iniciais, os parâmetros 
estimados levaram o sistema a convergir para uma região não oscilatória. A estimação de 
parâmetros empregando a FP apresentou bons resultados para todos os conjuntos, com 
erros abaixo de 4% para o Conjunto 1, como mostrado na Tabela 5.9. Apesar dos 
resultados com altos erros, entre 10% e 40%, para o Conjunto 2 e 3, em todas as 
estimações a função objetivo proposta estimou um conjunto de parâmetros que conferiu 
comportamento oscilatório ao sistema, capturando a dinâmica dos dados medidos, como 
é apresentado na Figura 5.24, Figura 5.25 e Figura 5.26. 



5.6 Estimação de Parâmetros – Análise Quantitativa 70 
 

 

Tabela 5.9: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do modelo 
de Jöbses et al. (1986) para o Cenário B utilizando DIRECT. 

 
??? 

estimado 
?? 

estimado 
?? 

estimado 
Erro ??? 

[%] 
Erro ?? 

[%] 
Erro ?? 

[%] 
MMQ 

Conjunto 
1 

0,025 0,079 2,040 50,015 94,871208 5,55 

FP 
Conjunto 

1 
0,049 1,505 2,079 0.007 2,88828 3,726 

MMQ 
Conjunto 

2 
0,025 0,768 3,240 49,994 50,390 50,020 

FP 
Conjunto 

2 
0,057 1,304 1,397 15,432 15,843 35,322 

MMQ 
Conjunto 

3 
0,041 1,284 2,214 17,378 17,123 2,537 

FP 
Conjunto 

3 
0,042 1,758 3,016 16,768 13,435 39,650 

5.6.2.3 Cenário C 

Para estudar o efeito do distúrbio não medido, a estimação de parâmetros foi 
repetida sem informar a variação em ??0  ao modelo. A Figura 5.27 e Figura 5.28 
comparam a simulação utilizando os parâmetros ótimos encontrados apenas para o 
Conjunto 2 de chutes iniciais, contido na Tabela 5.6, através dos algoritmos BOBYQA e 
DIRECT, respectivamente. 

 



5.6 Estimação de Parâmetros – Análise Quantitativa 71 
 

 

a  b)  

Figura 5.27: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando BOBYQA para o Cenário C com o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

a)  b)  

Figura 5.28: Resultados da estimação de parâmetros do modelo de Jöbses et al. (1986) 
utilizando DIRECT para o Cenário C com o Conjunto 2 como chute inicial. Figuras a) e b) 

apresentam os estados ?? e ??, respectivamente. 

Visto que os dados medidos passam por um tratamento de dados para cálculo da 
função objetivo proposta, o que inclui a retirada da média variável do sinal, a estimação 
de parâmetros através da função objetivo proposta não sofreu influência da perturbação. 
Os conjuntos de parâmetros ótimos encontrados tanto para o algoritmo local, quanto 
para o global foram, portanto, iguais aos do Cenário A.  

A estimação de parâmetros empregando o MMQ, no entanto, não apresentou bons 
resultados, pois levou o sistema a uma região não oscilatória. Os parâmetros estimados 
através do algoritmo local são mostrados na Tabela 5.10. Os resultados da estimação pelo 



5.7 Estimação de Parâmetros – Análise Quantitativa 72 
 

 

MMQ não são iguais para o Cenário B, como ocorreu para a estimação pela FP, visto que 
o MMQ não despreza o distúrbio não medido. 

Tabela 5.10: Valores estimados e erros absolutos dos parâmetros ??, ?? e YPX do 
modelo de Jöbses et al. (1986) para o Cenário C utilizando MMQ. 

 
??? 

estimado 
?? 

estimado 
?? 

estimado 
Erro ??? 

[%] 
Erro ?? 

[%] 
Erro ?? 

[%] 
BOBYQA 0,028 0,748 3,240 43,992 51,707 50,020 
DIRECT 0,045 0,867 1,210 9,018 44,049 43,977 

 

5.7 Estimação de Parâmetros – Análise Quantitativa 
Nesta seção, uma análise exaustiva do modelo de Jöbses et al. (1986) é realizada para 

elucidar a performance da função objetivo proposta frente à metodologia clássica. A 
análise foi feita para o Cenário A, com 32 conjuntos de parâmetros iniciais aleatórios, 
inseridos em dois raios diferentes de distância dos respectivos parâmetros ótimos. Os 
índices de desempenho, apresentados na Metodologia, foram calculados para cada par 
de funções objetivo e algoritmo de otimização. 

5.7.1 Resultados 

Para avaliação do desempenho da função objetivo proposta frente à metodologia 
clássica, os conjuntos de parâmetros iniciais do problema de otimização foram divididos 
em duas regiões, uma mais próxima do conjunto de parâmetros ótimos, Região A, e outra 
mais afastada, Região B, como mostra a Figura 5.29. 

 

Figura 5.29: Conjuntos de parâmetros iniciais. Conjuntos da Região A são representados 
por “×”, Região B por “?” e o conjunto ótimo por “*”. 



5.7 Estimação de Parâmetros – Análise Quantitativa 73 
 

 

A Região A contém 21 conjuntos de parâmetros iniciais e a Região B 11 conjuntos. 
Para cada região, foram calculados os índices de desempenho através da função objetivo 
proposta e do método de mínimos quadrados, utilizando o algoritmo de otimização local 
BOBYQA e o algoritmo global DIRECT. Os resultados da função objetivo proposta estão 
contidos na Tabela 5.11 e os resultados do método dos mínimos quadrados na 
Tabela 5.12. 

Tabela 5.11: Índices de desempenho da função objetivo proposta. 

 
BOBYQA Região 

A 
BOBYQA Região 

B 
DIRECT Região A DIRECT Região B 

Eficácia 0,293 0,374 0,191 0,074 

Eficiência 0,400 0,481 0,259 0,075 

Robustez 1,000 1,000 0,859 1,000 

Qualidade ??? 0,106 0,215 0,150 0,094 
Qualidade ?? 0,120 0,327 0,108 0,120 
Qualidade ?? 0,094 0,350 0,119 0,151 

Oscilação 0,851 0,825 0,819 0,967 

 

Tabela 5.12: Índices de desempenho do método dos mínimos quadrados. 

 
BOBYQA Região 

A 
BOBYQA Região 

B 
DIRECT Região A DIRECT Região B 

Eficácia 0,250 0,235 0,699 0,132 

Eficiência 0,364 0,338 0,066 0,136 

Robustez 1,000 0,909 0,714 1,000 

Qualidade ??? 0,077 0,308 0,112 0,004 
Qualidade ?? 0,100 0,139 0,099 0,145 
Qualidade ?? 0,044 0,304 0,091 0,126 

Oscilação 0,591 0,656 0,711 0,775 

 

Para o algoritmo local, a comparação entre a Tabela 5.11 e a Tabela 5.12, mostra que 
a função objetivo proposta apresenta melhor desempenho frente ao método de mínimos 
quadrados tanto para a Região A, quanto para a Região B. Apesar de ambas as funções 
objetivo apresentarem robustez igual a 1 e as diferenças entre os demais índices não ser 
grande, o índice de oscilação mostra que a função objetivo proposta é mais adequada 
para sistemas com ciclo limite. Isto ocorre, dado que os conjuntos de parâmetros 
estimados através da função objetivo proposta levam o sistema a apresentar 
comportamento oscilatório. 

Para o algoritmo global, a comparação entre a Tabela 5.11 e a Tabela 5.12, mostra 
que, para a Região A, o método de mínimos quadrados apresenta melhor resultado frente 
à função objetivo proposta para o índice de eficácia. No entanto, apesar da eficácia ser 



5.7 Estimação de Parâmetros – Análise Quantitativa 74 
 

 

maior, o método de mínimos quadrados é menos robusto e, novamente, apresenta índice 
de oscilação menor. Para a Região B, ambas as funções objetivo apresentam robustez 
igual a 1 e o método de mínimos quadrados é mais eficiente e mais eficaz que a função 
objetivo proposta. No entanto, a qualidade da solução do parâmetro ??? é muito baixa, 
refletindo no índice de oscilação do método de mínimos quadrados, muito menor do que 
o índice de oscilação da função objetivo proposta, que é próximo a 1. 

Os valores baixos apresentados pelos índices, tanto para o método de mínimos 
quadrados quanto para a função objetivo proposta, reiteram a complexidade de 
problemas de otimização envolvendo sistemas com ciclo limite.  

 



 
  

 Aplicação do Modelo de Diehl Capítulo 6 –
et al. (2017) 

O modelo de Diehl et al. (2017), denominado FOWM (do inglês, Fast Offshore Well 
Model) tem como objetivo modelar poços de produção de petróleo offshore em regiões 
profundas e ultra profundas. O modelo compreende a estrutura completa de produção, 
sendo elas o reservatório, o poço (anular e Tubing) e a linha de produção (Pipeline e 
Riser), mostradas na Figura 6.1. 

A modelagem do sistema começa no reservatório. A pressão do reservatório (??) é 
assumida constante por apresentar uma dinâmica lenta frente ao processo de produção. 
O fluxo de produção do reservatório (??) depende da energia disponível no reservatório 
(??), da energia da coluna de produção (???) e é calculado pela equação de (Vogel 1968): 

 ?? = ??. (1 ? ?0,2.
???
??
? ? ?0,8. ???

??
?
2

) (6.1) 

onde, ??? é a pressão de fundo do poço e ?? é o coeficiente de fluxo do reservatório.  



76   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 
Figura 6.1: Representação do sistema Reservatório-Poço-Linha de Produção em sistemas 

offshore. (Reservatório – Preto; Poço – Verde; e Linha de Produção – Azul). 

O poço é modelado por três equações diferenciais ordinárias. Estas equações 
representam o balanço de massa no anular e no Tubing. Visto que no anular há apenas 
gás, a variação de massa (?ga) dada por: 

 
????
??

= ??? –  ??? (6.2) 

Onde ???  é o fluxo de gás de elevação injetado no anular, ???, é o fluxo de gás de 
elevação injetado no Tubing. No Tubing ocorre a mistura do gás de elevação injetado 
(???) com o fluxo de produção do reservatório (??). O balanço de massa é individual para 
a fase gasosa (???) e para a fase líquida (???), dados respectivamente pelas equações: 

 
????
??

= (??. ???) + ??? – (???. ???) (6.3) 

 
????
??

= ???. ?1 ? ?????– [???. (1 ? ???)] (6.4) 



77   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

Onde ???  e ???  são as frações mássicas de gás no reservatório e no Tubing, 
respectivamente e ??? é a vazão mássica de produção na ANM. A fração de gás no 
Tubing é dada por:  

 ???  =
???

???+???
 (6.5) 

A Linha de Produção é modelada por outras três equações diferenciais ordinárias que 
representam o balanço de massa entre a ANM e a descarga de produção na plataforma. O 
ponto de inflexão entre o Pipeline e o Riser é modelado através do artifício matemático 
proposto por Di Meglio et al. (2009), chamado de válvula virtual, mostrado na Figura 6.1. 
O balanço de massa na válvula virtual é dado por: 

 
????
??

= (1??). (???. ???)– ?? (6.6) 

Onde, ??? é a massa de gás acumulada na bolha à jusante da válvula virtual, ? é a 
fração de gás que passa por fora da válvula virtual e  ?? é o fluxo mássico de gás através 
da válvula virtual. A válvula virtual, representada no detalhe da Figura 6.1, modela o 
acúmulo de gás e líquido é responsável por gerar a golfada no ponto de inflexão. Os 
balanços de massa de gás e líquido no Riser são: 

 
????
??

= ?. (???. ???) + ?? ? (????. ???) (6.7) 

 
????
??

= [???. (1 ? ???)]– ?????. ?1 ? ????? (6.8) 

Onde ???? é o fluxo de produção através da válvula choke de produção , mgr e ??? 
são as massas de gás e líquido no Riser e ??? é a fração de gás presente na linha de 
produção: 

 ???  =
???

???+???
 (6.9) 

A função max, que seleciona o maior valor entre o calculado e 0, é utilizada para evitar 
fluxo reverso e problemas relacionados à convergência numérica nos cálculos de fluxo. Na 
válvula virtual, a relação entre fluxo e diferença de pressão é considerada linear 
(escoamento laminar), visto que o fluxo é monofásico: 

 ?? = ??. ??? (0, (??? ? ???)) (6.10) 

Onde ??? é a pressão da bolha de gás à montante da válvula virtual, ??? é a pressão à 
jusante da válvula virtual e ?? é a coeficiente de vazão da válvula virtual. Os demais fluxos 
têm relação não linear com a diferença de pressão: 

 ?? = ?? ? ?1 ? ?0,2.
???
??
? ? ?0,8. ???

??
?
2
? (6.11) 



78   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 ??? = ??. ????. ????0, (??? ? ???)? (6.12) 

 ??? = ??. ???. ??? (0, (??? ? ???)) (6.13) 

 ???? = ????. ?. ???. ??? (0, (??? ? ??)) (6.14) 

Onde ??? é a pressão no ponto de injeção de gas-lift no anular, ??? é a pressão no 
ponto de injeção de gás de elevação no Tubing, ??? é a pressão na ANM – topo do Tubing, 
??? é a pressão no topo do Riser, à montante da válvula de produção; ??? é a massa 
específica do gás no anular, ?? é a massa específica do óleo produzido; ??, ?? ? ???? são 
os coeficientes de fluxo das válvulas de injeção, da ANM e de produção, respectivamente; 
e ? é a abertura da choke de produção. As pressões e as massas específicas são dadas 
pelas equações, assumindo-se gás ideal: 

 ??? = ?
?.?
??.? 

+ ?.??
?? 
? . ??? (6.15) 

 ??? =
?.???
?.?

  (6.16) 

 ??? =
???
???

. ?.?
? 

 (6.17) 

 ??? =
???+???

??
  (6.18) 

 ??? =
???.?.?
?.???  

  (6.19) 

Onde, R é a constante universal dos gases, M é a massa molar do gás de elevação; g é 
a constante gravitacional, T é a temperatura do sistema, ?? e ?? são o comprimento e o 
volume do anular, respectivamente, ??? é o volume de gás no Tubing, ?? é o volume do 
Tubing e ??? é o volume da bolha acumulado à jusante da válvula virtual. A partir destas, 
é possível calcular as demais pressões do poço: 

 ??? = ???? + ???. ?. (?? ? ????) (6.20) 

 ???? = ??? + ?????. ?. (???? ? ????) (6.21) 

 ??? = ??? + ???. ?. ???? (6.22) 

Onde, ?? é o comprimento do Tubing, ???? é a distância do leito do mar até o 
medidor de pressão PDG, ???? é a distância do leito do mar até o ponto de injeção de gás 
de elevação no Tubing. 

Para garantir a ocorrência da golfada em decorrência da válvula virtual é necessário 
um acúmulo mínimo de líquido à montante da inflexão (??,?????). Desta forma, esta 
condição deve ser levada em consideração para o cálculo das pressões no Riser: 



79   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 ??? = ??? +
(???+???????).?.???(?)

?
  (6.23) 

 ??? =
???.?.?

??.????
???+???????

 ??
 ?  

  (6.24) 

Onde, ?? e ? são o volume e a área da seção transversal do Riser; ?? é a massa 
específica do líquido no Riser, ??,????? é a massa mínima de líquida no Riser, e ? é a 
inclinação do ponto de inflexão do Riser. Os cálculos geométricos são dados por: 

 ?? =
??.?.??2

4
 (6.25) 

 ??? = ?? ?
???
??

  (6.26) 

 ?? = ??. ? (6.27) 

 ? = ?.??
2

4
 (6.28) 

Onde, ??e ?? são os diâmetros equivalente do anular e do Tubing, respectivamente. 

Resumindo, o modelo de Diehl et al. (2017) é composto por seis estados dinâmicos 
(??? , ???, ???, ???, ???, ??? ) e vinte e uma equações algébricas. A partir de quatro 
entradas de processo (???, ?, ?? ? ??) e vinte e cinco parâmetros é possível predizer sete 
diferentes pontos de pressão ao longo do processo. Destas, ????, ??? ? ???? são variáveis 
medidas. Dentre os parâmetros do modelo, nove parâmetros devem ser estimados para 
ajustar a dinâmica do modelo à dinâmica das pressões medidas: ??,?????, ??, ????,  ??, 
?? , ??, ?, ??? e ??. 

6.1 Inicialização dos Parâmetros  
Os valores iniciais dos nove parâmetros de podem ser calculadas através das 

dimensões do poço e variáveis estimadas a partir de dados reais do modelo. Esta etapa é 
importante para garantir a convergência numérica do modelo, para realizar a análise de 
sensibilidade e para inicialização do problema de estimação de parâmetros. 

O parâmetro ?? de Vogel (1968) é proporcional ao fluxo de produção do reservatório 
para o Tubing. Quando a pressão ???? está disponível, a pressão ??? pode ser estimada 
pela Equação 6.20, com aproximação de ?mt por ?L. Assumindo a pressão do reservatório 
?? constante e conhecida, usando o fluxo real de produção do reservatório ??, é possível 
estimar o ?? através da equação: 

 ?? =
??

1??0,2.
???
??

???0,8.
???
??

?
2 (6.29) 

O coeficiente de fluxo ?? entre o anular e o Tubing é estimado pela equação: 



80   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 ?? =
???

????.(???????)
 (6.30) 

O fluxo ??? pode ser aproximado pelo fluxo ??? se um período de tempo longo é 
considerado, pois a média entre os dois fluxos deve ser a mesma. A pressão ??? pode ser 
estimada pela soma da pressão do ponto de suprimento de gás com a coluna de gás entre 
a plataforma e o anular. A pressão no ponto de injeção de gas-lift no Tubing ??? pode ser 
aproximada pela pressão ???? menos a pressão da coluna até a válvula de injeção. A 
massa específica ??? é dada pela Equação 6.16. 

O coeficiente de fluxo na ANM ?? é dado pela equação: 

 ?? =
????+????
???.(???????)

 (6.31) 

Negligenciando os efeitos de perda de carga por atrito, a pressão ??? pode ser 
aproximada pela pressão ??? menos a pressão hidrostática da coluna. A massa específica 
do líquido ?? é conhecida.  

O valor máximo de ??? é aproximado através da equação: 

 ??? =
?.?.?2

4
. (1 ? ??) (6.32) 

Onde ?? é a fração do volume total da tubulação da linha de produção e Riser 
correspondente ao Riser. O parâmetro ?, sendo uma fração, pode ser definido como 0,5. 
Segundo Di Meglio et al. (2009), um valor típico para o parâmetro ??  pode ser  
10-4kg.s/m. O volume do ?? é aproximado por: 

 ?? =
?.?.?2

4
. (??) (6.33) 

A valor máximo de ??,????? pode ser calculada pela equação: 

 ??,????? = ??. ?? (6.34) 

Por fim, uma maneira de obtenção do coeficiente de fluxo da válvula de produção 
???? é utilizar a informação fornecida pela empresa que fabrica a válvula. Outra maneira é 
através da equação:  

 ???? =
????

?.???.(??????)
 (6.35) 

6.2 Estudo de Caso – Poço Real 
Um poço real de produção é considerado, denominado de Poço A. A batimetria do 

Poço A e os valores iniciais dos parâmetros são apresentados na Tabela 6.1. 



81   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

Tabela 6.1: Batimetria do Poço A e valores iniciais dos parâmetros a serem estimados. 

Parâmetro [Unidade] Valor 

??? [-] 0,0188 

?? [m] 0,140 

?? [m] 0,150 

? [m/s2] 9,81 

????[m] 916 

??[m] 1279 

????[m] 1117 

?? [m] 1118 

?? [m] 1639 

?[kg/kmol] 18 

??[Pa] 2,25e+06 

?? [Pa] 1013250 

? [m3Pa/kmol.K] 8314 

??[kg/m
3] 987,45 

?????[kg/m
3] 891,9523 

? [K] 298 

? [rad] ?/4 

? [-] 0,84 
??? [kg/s] 1,4 

??????? [kg] 1,21e+03 
?? [m

-1] 1e-04 
???? [m

-1] 1,838e-02 
??? [m

-3] 44,88 
? [-] 0,5 

?? [m
-1] 1,52e-04 

?? [m
-1] 2,73e-04 

?? [m
-3] 2,07e+02 

?? [m
-1] 8,22e+01 

 

6.2.1.1 Análise de Sensibilidade 

O modelo FOWM foi simulado com os parâmetros da Tabela 6.1. As pressões ????, ??? 
e ??? simuladas definidas como referência para cálculo do erro das métricas da análise de 
sensibilidade para avaliar a influência dos parâmetros na dinâmica do sistema. A partir 
dos parâmetros iniciais, os limites inferior e superior dos parâmetros foram definidos 



82   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

como sendo 10% e 190% dos parâmetros, respectivamente. Os resultados da análise de 
sensibilidade são apresentados na Figura 6.2. 

 

Figura 6.2: Índices de sensibilidade total do modelo FOWM. 

A análise de sensibilidade do Poço A mostra que os parâmetros ??? e ?? são os que 
mais influenciam a saída do modelo. Estes são seguidos pelos parâmetros: ?, ??, ?? e 
????, com índices de sensibilidade semelhantes. Por último, os parâmetros  ??, ??,????? e 
?? apresentam índices de sensibilidade bastante baixos em comparação aos demais 
parâmetros, indicando de não influenciam muito na saída do modelo. Portanto, três 
conjuntos de parâmetros foram identificados com a análise de sensibilidade. No entanto, 
todos os parâmetros serão levados em conta na estimação de parâmetros para fins de 
validação do resultado obtido pela análise de sensibilidade.  

5.2.1.1. Análise de Convexidade 

Através da análise de sensibilidade foram definidos os dois parâmetros mais 
influentes na dinâmica do sistema: ??? e ??. Estes dois parâmetros foram utilizados para 
fazer a análise de convexidade. Apesar de não ser possível uma visualização global do 
sistema, visto que o modelo é dependente de nove parâmetros, a análise através destes 
dois parâmetros ilustra a complexidade do problema. A Figura 6.3 mostra a convexidade 
utilizando MMQ e a Figura 6.4 mostra a convexidade do problema utilizando a FP. 

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

mlstill Cg Cout Veb E Kw Ka Vr Kr

Ín
di

ce
 d

e 
Se

ns
ib

ili
da

de
 

Parâmetros 



83   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 

Figura 6.3: Convexidade do modelo FOWM através do MMQ. 

A Figura 6.3 mostra que, quando a estimação de parâmetros é realizada considerando 
apenas o método de mínimos quadrados, o problema não é convergente para o mínimo 
global, assim como não é penalizada longe deste. Isto implica que um chute inicial 
distante do valor correto para os parâmetros pode levar a uma solução distante do ótimo 
global, inviabilizando a utilização de algoritmos locais de otimização além de dificultar a 
aplicação de algoritmos globais.  



84   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 

Figura 6.4: Convexidade do modelo FOWM através da FP. 

No entanto, quando a metodologia sugerida neste trabalho é utilizada, Figura 6.4, o 
problema torna-se convergente ao redor do mínimo global e regiões distantes deste são 
penalizadas. Dessa forma a vantagem da metodologia proposta é que mesmo para um 
chute inicial distante, o conjunto de parâmetros converge para valores que levam a 
simulação para próximo da região com ciclo limite, desejada, visto que não há um platô 
na superfície, a qual apresenta decaimento, formando um vale. 

5.3. Estimação de Parâmetros 
Nesta seção, são apresentados os resultados da estimação de parâmetros do modelo 

FOWM aplicando a função objetivo proposta e sua comparação com o método dos 
mínimos quadrados. Além disso, os resultados obtidos serão comparados com os 
resultados de Diehl et al. (2017) e Apio (2017). Os parâmetros foram estimados para 
ajustar o modelo aos dados de referência do Poço A, através dos algoritmos de 
otimização local BOBYQA e global DIRECT. Visto que os dados de referência são gerados a 
partir de dados medidos de pressões Ptt, Prt e Ppdg do processo real, não há valores de 
parâmetros de referência para mensurar a acurácia da metodologia, como feito na seção 
anterior. Portanto, será aplicado o Teste de Fischer para cálculo do intervalo de confiança 
dos parâmetros estimados. 

A estimação de parâmetros é dividida em duas partes. Na primeira parte, a estimação 
de parâmetros é realizada com as três pressões disponíveis. Na segunda, a estimação de 
parâmetros é conduzida apenas com a pressão ???.  



85   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

5.3.1. Estimação de Parâmetros com pressões ???, ??? e ???? 

Nesta seção, a estimação de parâmetros é realizada considerando as três pressões do 
sistema real, Ptt, Prt e Ppdg, medidas. Portanto, o erro entre as três pressões estimadas e 
as três respectivas pressões medidas são minimizados através das métricas no problema 
de otimização.  

A Figura 6.5 compara a simulação utilizando os parâmetros ótimos encontrados para 
o conjunto de chute inicial, contidos na Tabela 6.1, através do algoritmo BOBYQA.  



86   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

a)  

b)  



87   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

c)  

Figura 6.5: Resultado da estimação de parâmetros para o Poço A utilizando BOBYQA 
através de três pressões medidas: a) pressão PDG, b) pressão TPT e c) pressão PRT.  

A Figura 6.6 compara a simulação utilizando os parâmetros ótimos encontrados para 
o conjunto de chute inicial, contidos na Tabela 6.1, através do algoritmo DIRECT. 



88   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

a)  

b)  



89   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

c)  

Figura 6.6: Resultado da estimação de parâmetros para o Poço A utilizando DIRECT 
através de três pressões medidas: a) pressão PDG, b) pressão TPT e c) pressão PRT. 

Utilizando o algoritmo local, os parâmetros estimados apresentaram bons resultados 
para a função objetivo proposta. O sistema convergiu para uma região não oscilatória 
para o MMQ. 

Utilizando o algoritmo global, os parâmetros estimados através do MMQ levaram o 
sistema a convergir novamente para uma região não oscilatória. No entanto, os 
parâmetros estimados através da função objetivo proposta conferiram comportamento 
oscilatório ao sistema. A Tabela 6.2 mostra o valor dos parâmetros estimados através do 
algoritmo local e a Tabela 6.3 através do algoritmo global, junto dos respectivos 
intervalos de confiança. 



90   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

Tabela 6.2: Parâmetros estimados e intervalos de confiança para o Poço A através de três 
pressões medidas utilizando BOBYQA. 

Parâmetro FP BOBYQA MMQ BOBYQA 

??????? 484,469 ± 1,838e+04 1937,876 ± 1,503e+06 
?? 6,958e-04 ± 0,039 8,080e-04 ± 7,687 
???? 7,360e-03 ± 0,012 1,839e-02 ± 3,028 
??? 71,800 ± 18,068 44,900 ± 8,355e+03 
? 0,200 ± 0,194 0,500 ± 1,317e+03 
?? 1,520e-04 ± 5,492e-05 6,080e-05 ± 1,266e-03 

?? 1,090e-04 ± 2,126e-04 2,730e-04 ± 4,098e-03 

?? 3,330e+02 ± 294,021 2,080e+02 ± 1,268e+03 
?? 82,300e ± 25,483 82,300 ± 59,786 

 

Tabela 6.3: Parâmetros estimados e intervalos de confiança para o Poço A através de três 
pressões medidas utilizando DIRECT. 

Parâmetro FP DIRECT MMQ DIRECT 

??????? 1,210e+03 ± 4,335e+03 2358,518 ± 3,643e+05 
?? 5,080e-04 ± 6,023e-03 3,437e-04 ± 4,281 
???? 7,360e-03 ± 5,523e-03 2,685e-03 ± 2,789e-02 
??? 71,800 ± 4,540 11,800 ± 3020,401 
? 0,100 ± 0,126 2,960e-02 ± 1,521e+05 

?? 2,740e-04 ± 5,141e-05 7,850e-05 ± 4,519e-04 

?? 2,750e-04 ± 1,735e-04 1,170e-04 ± 6,329e-04 

?? 83,200 ± 53,517 2,950e+02 ± 5,258e+03 
?? 1,320e+02 ± 23,502 1,000e+02 ± 65.571 

 

Através das Tabela 6.2 e Tabela 6.3, é visto que a função objetivo proposta apresenta 
desempenho superior ao método dos mínimos quadrados. O intervalo de confiança de 
todos os parâmetros é menor utilizando a função objetivo proposta, tanto para a 
otimização local, quanto para a global. Entre os algoritmos, a otimização global apresenta 
menores intervalos de confiança para a função objetivo proposta em relação ao algoritmo 
local para todos os parâmetros. Estes resultados corroboram os resultados gráficos da 
Figura 6.5 e da Figura 6.7. 

A Figura 6.8 apresenta os resultados apresentados na literatura por Diehl et al. (2017) 
e Apio (2017) para o mesmo estudo de caso. 



91   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

a)  

b)  



92   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

c)  

Figura 6.8: Resultado da estimação de parâmetros para o Poço A apresentados na 
literatura por Diehl et al. (2017) e Apio (2017): a) pressão PDG, b) pressão TPT e c) 

pressão PRT 

Os valores dos parâmetros encontrados por Diehl et al. (2017) e Apio (2017) são 
apresentados na Tabela 6.4, junto aos respectivos intervalos de confiança. 

Tabela 6.4: Parâmetros estimados e intervalos de confiança para o Poço A encontrados 
na literatura. 

Parâmetro Diehl et al. (2017) Apio (2017) 

??????? 71,800 ± 9611.547 62,221 ± 12865,150 
?? 1,330e-03 ± 7,552e-02 1,137e-03 ± 0,344 
???? 3,970e-03 ± 6,075e-04 2,038e-03 ± 1,699e-03 
??? 70,500 ± 20,588 60,978 ± 20,484 
? 0,209 ± 0.099 0,154 ± 0,177 
?? 5,941e-04 ± 2,768e-04 6,876e-04 ± 2,032e-04 
?? 4,240e-05 ± 5,422e-06 2,293e-05 ± 2,469e-05 
?? 1,530e+02 ± 36,027 126,962 ± 113,498 
?? 2,470e+02 ± 72,021 227,166 ± 91,964 

 
A Figura 6.8 apresenta os resultados da estimação de parâmetros de Diehl et al. 

(2017) e Apio (2017). Tanto para a Ptt e Ppdg, percebe-se que, apesar do resultado obtido 



93   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

capturar a dinâmica oscilatória do sistema, há diferença entre o período frente aos dados 
medidos. No entanto, para o resultado apresentado na Figura 6.6, o resultado da 
estimação de parâmetros tem maior aderência aos dados medidos. Analisando os valores 
dos intervalos de confiança, na Tabela 6.3 e Tabela 6.4, é visto que o melhor resultado 
obtido neste trabalho, utilizando a função objetivo proposta e o algoritmo global, 
apresenta menores intervalos de confiança para cinco parâmetros: mL,still, Cg, Veb, Kw  e 
Kr. Diehl et al. (2017) apresenta menores intervalos de confiança para os quatro 
parâmetros restantes: Cout,  Ka, , Vr e ?. Além disso, os resultados do intervalo de 
confiança estão de acordo com os resultados obtidos na análise de sensibilidade. Os 
parâmetros mL,still  e Cg  são os parâmetros menos influentes do modelo e por 
consequência são os parâmetros que apresentam os maiores intervalos de confiança 
frente aos valores estimados. Além disso, a estimação através da metodologia proposta 
apresenta menor intervalo de confiança para o parâmetro Veb, mais influente no modelo.  

5.3.2. Estimação de Parâmetros com pressão ??? 

Na maioria dos casos, as três medições de pressão, ??? , ???  e ???? , não estão 
disponíveis ao mesmo tempo. Devido às condições inóspitas e agressivas de operação, a 
medição da pressão ????, eventualmente, é perdida. Visto que o custo de manutenção 
submarina é muito alto, os poços frequentemente operam sem toda a instrumentação 
funcional (Grimstad and Foss, 2014). Considerando estes fatos, é desejável que o modelo 
possa estimar variáveis não medidas do processo. 

Diehl et al. (2017) faz a estimação das pressões ??? e ???, a partir da medição ????. No 
entanto, a pressão ???? é a variável desejável, visto que esta medição é perdida. A 
pressão ???, por ser localizada na plataforma, é de fácil manutenção e sua operação é 
garantida. Portanto, a pressão ???  é utilizada para estimação da pressão ???  e, 
principalmente, da ????.  O resultado é apresentado na Figura 6.9.  



94   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

a)  

b)  



95   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

c)  

Figura 6.9: Resultado da estimação de parâmetros para o Poço A utilizando DIRECT 
através de uma pressão medida: a) pressão PDG, b) pressão TPT e c) pressão PRT. 

 O resultado apresentado na Figura 6.9 mostra a viabilidade de estimação da 
dinâmica do sistema utilizando a função objetivo proposta de forma satisfatória. A PRT 
apresenta comportamento mais estável (amplitude de ciclo mais constante) do que os 
resultados apresentados anteriormente. Isto se deve ao fato do problema de otimização 
se tornar menos complexo com a utilização de apenas uma variável medida, pois isto 
facilita a minimização do erro relativo à função objetivo. Os parâmetros estimados são 
apresentados na Tabela 6.5. 



96   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

Tabela 6.5: Parâmetros estimados e intervalos de confiança para o Poço A através da 
pressão PRT. 

Parâmetro FP DIRECT 

??????? 283,900 ± 12487,227 
?? 1,343e-04 ± 5,452e-03 
???? 3,301e-03 ± 1,016e-03 
??? 66,812e+01 ± 23,899 
? 0,486 ± 0,153 
?? 4,164e-03 ± 3,040e-2 
?? 1,532e-04 ± 2,097e-04 
?? 3,201e+02 ± 141,458 
?? 2,100e+02 ± 66,003 

 

Os valores do intervalo de confiança, apresentados na Tabela 6.5, são menores que os 
valores de Apio (2017) para os parâmetros mL,still , Cg , Cout  e Kr . Para os demais 
parâmetros, a estimação de parâmetros deste trabalho apresenta os maiores intervalos 
de confiança perante todas as estimações apresentadas. Porém, em Diehl et al. (2017), os 
resultados da estimação mostram que a pressão PRT não tem boa aderência aos dados 
medidos quando a estimação de parâmetros é feita somente com a pressão PDG. No 
entanto, as pressões PGD e TPT são estimadas de forma satisfatória através da PRT e 
utilizando a função objetivo proposta.  

6.2.1.2 Análise do Plano de Fase 

O plano de fase, que ilustra a formação do ciclo limite, não foi construído utilizando os 
dados medidos do Poço A, visto que as variáveis de estados do sistema não são medidas 
no processo real. Portanto, o plano de fase foi construído a partir dos estados estimados 
através do modelo identificado na seção anterior.  O plano de fase do poço é mostrado na 
Figura 6.10.  



97   Aplicação do Modelo de Diehl et al. 
(2017) 
 

 

 

Figura 6.10: Plano de fase do Poço A. 

Como pode ser analisado na Figura 6.10, há a formação de um ciclo limite na forma de 
uma elipse. 

 



 
  

 Conclusões  Capítulo 7 –
Neste capítulo, serão apresentadas as conclusões a respeito da aplicação da função 

objetivo proposta para estimação de parâmetros de modelos com ciclo limite. As 
conclusões estão divididas entre a estimação de parâmetro utilizando a função objetivo 
proposta e a aplicação desta nos modelos estudados, na seção 6.1. A continuidade do 
trabalho está apresentada na seção 6.2. 

7.1 Conclusões sobre a Função Objetivo Proposta 
Diante da necessidade inicial, as métricas propostas neste trabalho capturam 

informações necessárias para representação de sistemas com ciclo limite: período, 
amplitude, fase e média. As métricas foram propostas e utilizadas para realizar de 
maneira adequada: 1) a análise de sensibilidade e 2) a estimação de parâmetros de 
modelos com ciclo limite. Os modelos de Lotka-Volterra, Jöbses et al. (1986) e FOWM, 
foram utilizados para validação da função objetivo proposta.  

Através dos modelos de Lotka-Volterra e Jöbses et al. (1986), foram realizadas 
análises qualitativas, através de gráficos, e quantitativas, através de métricas de 
desempenho, com das experimentais simulados. Comparações entre o desempenho da 
função objetivo proposta e o desempenho do método clássico de estimação de 
parâmetros, o método dos mínimos quadrados, foram feitas. Foi mostrado que a função 
objetivo proposta apresenta desempenho superior, condicionando o sistema a adquirir 
comportamento oscilatório desejado, enquanto que o método dos mínimos quadrados 
acaba por levar o sistema a convergir para um valor médio, e não oscilatório, das 
variáveis de estado. Apesar da proximidade dos parâmetros iniciais afetar o desempenho 
da estimação de parâmetros, este fator afeta menos a estimação de parâmetros 
utilizando a função objetivo proposta.  

O modelo FOWM possibilitou a análise da função objetivo proposta em um caso real. 
Os resultados foram comparados com dados da literatura e, novamente, com o método 
dos mínimos quadrados. Também foram realizadas análises qualitativas, através de 
gráficos, e quantitativas, através do teste de Fischer. Os resultados obtidos neste trabalho 
mostraram melhor aderência do período e da fase pela análise qualitativa. Os intervalos 
de confiança calculados são melhores para cinco parâmetros, dentre os nove estimados. 
Estes resultados confirmam também a assertividade dos resultados da análise de 



99   Conclusões 
 

 

sensibilidade, que mostra que os parâmetros mL,still e Cg são os que menos influenciam o 
modelo e, por isso, apresentam maiores intervalos de confiança.  

Além disso, foi mostrado que mesmo com a utilização de algoritmos locais de 
otimização, é possível atingir o comportamento dinâmico desejável através da função 
objetivo proposta. Isto ocorre pelo fato da função objetivo proposta diminuir a 
complexidade do problema, frente ao método clássico, como mostrado através das 
análises de convexidade.   

Por fim, é mostrada a viabilidade da estimação da pressão PDG através do modelo 
FOWM, utilizando somente dados da pressão de topo.  Visto que este é um problema que 
afeta muitos poços de produção de petróleo offshore, o resultado é de grande valia. 

7.2 Sugestões de Trabalhos Futuros 
Os próximos passos envolvem a alteração da estrutura do problema de otimização. O 

objetivo será identificar, através da análise de sensibilidade, os parâmetros que mais 
influenciam em cada uma das três métricas propostas. Com isto, a estimação de 
parâmetros poderá ser segmentada e o problema de otimização se tornará menos 
complexo. Isto permite também melhorar a aderência do modelo aos dados medidos de 
maneira sequencial à estimação de parâmetros com todos os parâmetros. 

Outra proposta é o desenvolvimento de um sensor virtual de estimação da pressão 
PDG para viabilizar a modelagem de poços que não disponham de medições do sensor 
PDG. 

  



 
  

Referências 

Akesson, J. et al., 2010. Modeling and Optimization with Optimica and JModelica.org- 
languages and tools for solving large-scale dynamic optimization problems. 
Computers and Chemical Engineering, 34, pp.1737–1749. 

Apio, A., 2017. Estimação de Parâmetros em Modelos com Ciclo Limite. Universidade 
Federal do Rio Grande do Sul. 

Apio, A., Botelho, V.R. &amp;amp; Trierweiler, J.O., 2017. Parameter Estimation of Models with 
Limit Cycle based on the Reformulation of the Objective Function. Computers &amp;amp; 
Chemical Engineering, p. Available at: 
https://www.sciencedirect.com/science/article/pii/S0098135417304106. 

Ashyraliyev, M. et al., 2009. Systems biology: parameter estimation for biochemical 
models. FEBS Journal, 276(4), pp.886–902. Available at: 
http://dx.doi.org/10.1111/j.1742-4658.2008.06844.x. 

Battel, A.P.M.B., Moral, R.A. &amp;amp; Godoy, W.A.C., 2012. Modelos matemáticos predador-
presa e aplicações ao manejo integrado de pragas. Oecologia Australis, 16(1), pp.43–
62. 

Belt, R. et al., 2011. Comparison of commercial multiphase flow simulators with 
experimental and field databases. 15th International Conference on Multiphase 
Production Technology, pp.413–427. 

Bendiksen, K.H. et al., 1991. The Dynamic Two-Fluid Model OLGA: Theory and Application. 
SPE Production Engineering, 6(2), pp.171–180. 

Bequette, B.W., 1998. Process Dynamics: Modeling, Analysis, and Simulation, Available at: 
http://books.google.com.sg/books?id=b4wvAQAAIAAJ&amp;amp;source=gbs_slider_cls_meta
data_9_mylibrary. 

Biegler, L.T., 2009. Technology Advances for Dynamic Real-Time Optimization. In R. M. de 
Brito Alves, C. A. O. do Nascimento, &amp;amp; E. C. B. T.-C. A. C. E. Biscaia, eds. 10th 
International Symposium on Process Systems Engineering: Part A. Elsevier, pp. 1–6. 
Available at: 
http://www.sciencedirect.com/science/article/pii/S1570794609702202. 



101   Referências 
 

 

Bonilla, J. et al., 2010. An automatic initialization procedure in parameter estimation 
problems with parameter-affine dynamic models. Computers and Chemical 
Engineering, 34(6), pp.953–964. 

Cedersund, G. &amp;amp; Knudsen, C., 2005. Improved parameter estimation for systems with an 
experimentally located Hopf bifurcation. IEE Proceedings - Systems Biology, 2(3), 
pp.161–168. 

Cooley, J.W. &amp;amp; Tukey, J.W., 1965. An algorithm for the machine calculation of complex 
Fourier series. , pp.297–301. 

Daugulis, A., Mclellan, P.J. &amp;amp; Li, J., 1997. Experimental Investigation and Modeling of 
Oscillatory Behavior in the Continuous Culture of Zymomonas mobilis, 

Diehl, F.C., 2009. Análise , Controle e Otimização Operacional de um Reator de 
Zymomonas mobilis com Multiplicidade de Equilíbrios Análise , Controle e Otimização 
Operacional de um Reator de Zymomonas mobilis com Multiplicidade. Universidade 
Federal do Rio Grande do Sul. 

Diehl, F.C. et al., 2017. Fast Offshore Wells Model (FOWM): A practical dynamic model for 
multiphase oil production systems in deepwater and ultra-deepwater scenarios. 
Computers &amp;amp; Chemical Engineering, 99, pp.304–313. Available at: 
http://dx.doi.org/10.1016/j.compchemeng.2017.01.036. 

Dunlap, J.C., 1999. Molecular bases for circadian clocks. Cell, 96(2), pp.271–290. 

Eberhart &amp;amp; Yuhui Shi, 2015. Particle swarm optimization: developments, applications and 
resources. Proceedings of the 2001 Congress on Evolutionary Computation (IEEE Cat. 
No.01TH8546), 1(February), pp.81–86. Available at: 
http://ieeexplore.ieee.org/document/934374/. 

Edgar, T.F., Himmelblau, D.M. &amp;amp; Lasdon, L.S., 2001. Optimization of chemical processes, 
Available at: http://www.lavoisier.fr/notice/frKWO6A26A2OWLOO.html. 

Ehinmowo, A.B. &amp;amp; Cao, Y., 2015. Stabilizing slug flow at large valve opening using active 
feedback control Stabilizing slug flow at large valve opening using active feedback 
control. International conference on automation and computing, (SEPTEMBER), 
pp.1–6. 

Eikrem, G.O., 2006. Stabilization of Gas-Lift Wells by Feedback Control, 

Eikrem, G.O., Aamo, O.M. &amp;amp; Foss, B., 2008. On Instability in Gas Lift Wells and Schemes 
for Stabilization by Automatic Control. SPE Production &amp;amp; Operations, 23(2), pp.268–
279. Available at: http://www.onepetro.org/mslib/servlet/onepetropreview?id=SPE-
101502-PA%5Cnhttps://www.onepetro.org/journal-paper/SPE-101502-PA. 

Elman, H. et al., 2012. Lyapunov Inverse Iteration for Identifying Hopf Bifurcations in 
Models of Incompressible Flow. SIAM Journal on Scientific Computing, 34(3), 
pp.A1584–A1606. 



102   Referências 
 

 

Evans, T. et al., 1983. Cyclin: A protein specified by maternal mRNA in sea urchin eggs that 
is destroyed at each cleavage division. Cell, 33(2), pp.389–396. 

Filho, H. dos S.R., 2011. A Otimização de Gás Lift na Produção de Petróleo: Avaliação da 
Curva de Performance do Poço. , p.92. 

Finkel, D.E., 2003. DIRECT optimization algorithm user guide. Center for Research in 
Scientific Computation, North Carolina State University, 2, pp.1–14. 

Gambarato, B.C. &amp;amp; Oliveira, S.C. de, 2011. Estudo de modelo matemático do 
comportamento oscilatório em processos contínuos de fermentação alcoólica com 
Zymomonas mobilis. Cadernos UniFOA, 17, pp.89–94. 

Gerevini, G.G., 2017. Atenuação de golfadas em sistemas de elevação de petróleo em 
ambiente offshore. Universidade Federal do Rio Grande do Sul. 

Gerisch, G. et al., 1975. Control of cell-contact sites by cyclic AMP pulses in differentiating 
Dictyostelium cells. Nature, 255(5509), pp.547–549. 

Goldbeter, A., 1995. A model for circadian oscillations in the Drosophila period protein 
(PER). Proceedings of the Royal Society of London. Series B: Biological Sciences, 
261(1362), p.319 LP-324. Available at: 
http://rspb.royalsocietypublishing.org/content/261/1362/319.abstract. 

Govaerts, W.J.F., 2000. Numerical Methods for Bifurcations of Dynamical Equilibria, 
Society for Industrial and Applied Mathematics. 

Grimstad, B. &amp;amp; Foss, B., 2014. A nonlinear, adaptive observer for gas-lift wells operating 
under slowly varying reservoir pressure, IFAC. Available at: 
http://dx.doi.org/10.3182/20140824-6-ZA-1003.00994. 

Guardia, M. et al., 2000. Cybernetic Modeling and Regulation of Metabolic Pathways in 
Multiple Steady States of Hybridoma Cells, 

Guckenheimer, J., Myers, M. &amp;amp; Sturmfels, B., 1997. Computing Hopf Bifurcations I. SIAM 
Journal on Numerical Analysis, 34(1), pp.1–21. 

Guo, B., Lyons, W.C. &amp;amp; Ghalambor, A., 2007. Petroleum Production Engineering. In 
Petroleum Production Engineering. pp. 181–206. 

Heskestad, K.L., 2005. Field Data Analysis Using the Multiphase Simulation Tool 
OLGA2000. Norges teknisk-naturvitenskapelige universitet Studieprogram. 

Hess, B. &amp;amp; Boiteux,  a, 1971. Oscillatory phenomena in biochemistry. Annual review of 
biochemistry, 40(October 1970), pp.237–258. 

Hindmarsh, A.C. et al., 2005. SUNDIALS: Suite of Nonlinear and Differential/Algebraic 
Equation Solvers. ACM Transactions on Mathematical Software, 31(3), pp.363–396. 
Available at: 



103   Referências 
 

 

http://doi.acm.org/10.1145/1089014.1089020%5Cnhttp://dl.acm.org/ft_gateway.cf
m?id=1089020&amp;amp;type=pdf. 

Hu, B., 2004. Characterizing gas-lift instabilities. Norwegian University of Science and 
Technology. 

Hunter, J.D., 2007. Matplotlib: A 2D Graphics Environment. Computing in Science &amp;amp; 
Engineering, 9(3), pp.90–95. 

Hynne, F., Danø, S. &amp;amp; Sørensen, P.G., 2001. Full-scale model of glycolysis in 
Saccharomyces cerevisiae. Biophysical Chemistry, 94(1–2), pp.121–163. 

Hynne, F., So/rensen, P.G. &amp;amp; Mo/ller, T., 1993. Complete optimization of models of the 
Belousov–Zhabotinsky reaction at a Hopf bifurcation. The Journal of Chemical 
Physics, 98(1), pp.219–230. 

Jahanshahi, E. et al., 2014. A comparison between Internal Model Control, optimal PIDF 
and robust controllers for unstable flow in risers. IFAC Proceedings Volumes (IFAC-
PapersOnline), 19(March 2016), pp.5752–5759. 

Jahanshahi, E. &amp;amp; Skogestad, S., 2013. Comparison between nonlinear model-based 
controllers and gain-scheduling Internal Model Control based on identified model. 
Proceedings of the IEEE Conference on Decision and Control, pp.853–860. 

Jahanshahi, E. &amp;amp; Skogestad, S., 2011. Simplified dynamical models for control of severe 
slugging in multiphase risers. IFAC Proceedings Volumes (IFAC-PapersOnline), 
18(PART 1), pp.1634–1639. 

Jahanshahi, E., Skogestad, S. &amp;amp; Grøtli, E.I., 2013. Anti-Slug Control Experiments Using 
Nonlinear Observers *. , (7491), pp.1058–1064. 

Jepsen, K. et al., 2013. Emulation and control of slugging flows in a gas-lifted offshore oil 
production well through a lab-sized facility. Proceedings of the IEEE International 
Conference on Control Applications, pp.906–911. 

Jöbses, I.M.L. et al., 1986. Fermentation kinetics ofZymomonas mobilis at high ethanol 
concentrations: Oscillations in continuous cultures, 

Johnson, S.G., 2015. The NLopt nonlinear-optimization package, 

Jones, K.D. &amp;amp; Kompala, D.S., 1999. Cybernetic model of the growth dynamics of 
Saccharomyces cerevisiae in batch and continuous cultures. Journal of 
biotechnology, 71(1–3), pp.105–131. 

Kaasa, G.-O. et al., 2008. Attenuation of Slugging in Unstable Oil Wells by Nonlinear 
Control. IFAC Proceedings Volumes, 41(2), pp.6251–6256. Available at: 
http://www.sciencedirect.com/science/article/pii/S1474667016399475. 

Khalil, H., 2002. Nonlinear Systems - Third Edition. Journal of Climate J Clim Vol 18, 18(16), 



104   Referências 
 

 

p.750. Available at: http://ci.nii.ac.jp/ncid/BA55223176. 

Klipp, E. et al., 2005. Systems Biology in Practice Concepts, Implementation and 
Application, 

Kramer, M.A., Rabitz, H. &amp;amp; Calo, J.M., 1984. Sensitivity oscillatory analysis sys terns. , 8, 
pp.328–340. 

Larter, R., Rabitz, H. &amp;amp; Kramer, M., 1984. Sensitivity analysis of limit cycles with 
application to the Brusselator. The Journal of Chemical Physics, 80(9), p.4120. 
Available at: http://link.aip.org/link/JCPSA6/v80/i9/p4120/s1&amp;amp;Agg=doi. 

Lea, J.F., Nickens, H. V. &amp;amp; Wells, M.R., 2008. Chapter 11 - Gas Lift. In Gas Well 
Deliquification. pp. 331–359. 

Leebeeck, A. De &amp;amp; Johansen, S.T., 2013. Simulation of hydrodynamic slug flow using the 
LedaFlow slug capturing model. , (m), pp.365–383. 

Lotka, A.J., 1925. Elements of Physical Biology, Williams &amp;amp; Wilkins Company. Available at: 
https://books.google.com.br/books?id=lsPQAAAAMAAJ. 

Lu, B.-Y. &amp;amp; Yue, H., 2012. Developing objective sensitivity analysis of periodic systems: 
case studies of biological oscillators. Zidonghua Xuebao/Acta Automatica Sinica, 
38(7). 

McLellan, Daugulis &amp;amp; Li, 1999. The incidence of oscillatory behavior in the continuous 
fermentation of zymomonas mobilis . Bioprocess Biosyst Eng, 15(4), pp.667–680. 
Available at: 
http://pubs3.acs.org/acs/journals/doilookup?in_doi=10.1021/bp990070d%5Cnpape
rs2://publication/doi/10.1021/bp990070d. 

Medio, A. &amp;amp; Lines, M., 2001. Nonlinear Dynamics: A Primer, Cambridge University Press. 
Available at: https://books.google.com.br/books?id=tL8WMsh3UvIC. 

Meerbergen, K. &amp;amp; Spence, A., 2010. Inverse Iteration for Purely Imaginary Eigenvalues 
with Application to the Detection of Hopf Bifurcations in Large-Scale Problems. SIAM 
Journal on Matrix Analysis and Applications, 31(4), pp.1982–1999. 

Di Meglio, F. et al., 2012. Model-based control of slugging: Advances and challenges. IFAC 
Proceedings Volumes (IFAC-PapersOnline), 1(PART 1), pp.109–115. 

Di Meglio, F. et al., 2010. Reproducing slugging oscillations of a real oil well. Proceedings 
of the IEEE Conference on Decision and Control, pp.4473–4479. 

Di Meglio, F. et al., 2011. Slugging in multiphase flow as a mixed initial-boundary value 
problem for a quasilinear hyperbolic system. American Control Conference (ACC), 
(August 2011), pp.3589–3596. 

Di Meglio, F., Kaasa, G.O. &amp;amp; Petit, N., 2009. A first principle model for multiphase slugging 



105   Referências 
 

 

flow in vertical risers. Proceedings of the IEEE Conference on Decision and Control, 
pp.8244–8251. 

Modelica Association, 2014. Modelica® - A Unified Object-Oriented Language for Systems 
Modeling Language Specification Version 3.3 Revision 1. Available at: 
https://www.modelica.org/documents/ModelicaSpec33Revision1.pdf. 

Pedersen, S., Durdevic, P. &amp;amp; Yang, Z., 2017. Challenges in slug modeling and control for 
offshore oil and gas productions: A review study. International Journal of Multiphase 
Flow, 88, pp.270–284. 

Pedersen, S., Durdevic, P. &amp;amp; Yang, Z., 2015. Review of slug detection, modeling and 
control techniques for offshore oil &amp;amp; gas production processes. IFAC-PapersOnLine, 
28(6), pp.89–96. 

Pedregosa, F. et al., 2012. Scikit-learn: Machine Learning in Python. Journal of Machine 
Learning Research, 12, pp.2825–2830. Available at: 
http://dl.acm.org/citation.cfm?id=2078195%5Cnhttp://arxiv.org/abs/1201.0490. 

Petrobras, 2015. A cada desafio, novas tecnologias. Tecnologias pioneiras do PRÉ-SAL. 

Powell, M., 2009. The BOBYQA algorithm for bound constrained optimization without 
derivatives. NA Report NA2009/06, p.39. Available at: 
http://www6.cityu.edu.hk/rcms/publications/preprint26.pdf. 

Ribeiro, C.H.P. et al., 2016. Model Predictive Control with quality requirements on 
petroleum production platforms. Journal of Petroleum Science and Engineering, 137, 
pp.10–21. Available at: 
http://linkinghub.elsevier.com/retrieve/pii/S0920410515301704. 

Van Rossum, G. &amp;amp; Drake, F.L., 2011. An Introduction to Python, Network Theory Limited. 
Available at: https://books.google.com.br/books?id=8-qkuAAACAAJ. 

Secchi, A.R., 2000. Métricas de Desempenho para Funções Objetivo. 

Seydel, R., 2010. Practical Bifurcation and Stability Analysis, New York, NY: Springe. 
Available at: http://link.springer.com/10.1140/epjb/e2013-40570-
8%5Cnhttp://arxiv.org/abs/1406.6401%5Cnhttp://arxiv.org/abs/1204.1475%5Cnhtt
p://link.aps.org/doi/10.1103/PhysRevLett.91.058302%5Cnhttp://arxiv.org/abs/nlin/
0111059%5Cnhttp://link.aps.org/doi/10.1103/PhysRe. 

Silva, M. da C., Dessen, F. &amp;amp; Nydal, O.J., 2010. Dynamic Multiphase Flow Models for 
Control. Available at: https://www.onepetro.org/conference-paper/BHR-2010-F2. 

Siong, A.K., 2009. Parameter Estimation of Oscillatory Systems. 

Sivertsen, H., Storkaas, E. &amp;amp; Skogestad, S., 2010. Small-scale experiments on stabilizing 
riser slug flow. Chemical Engineering Research and Design, 88(2), pp.213–228. 



106   Referências 
 

 

Slotine, J.-J.E. &amp;amp; Li, W., 1991. Applied Nonlinear Control, Englewood Cliffs, New Jersey: 
Prentice Hall. 

Sobol, I.M., 1990. Sensitivity analysis for nonlinear mathematical models. 
Matematicheskoe Modelirovanie, 2(1), pp.112–118. Available at: 
http://www.mathnet.ru/eng/mm2320. 

Storkaas, E., Skogestad, S. &amp;amp; Godhavn, J., 2003. A low-dimensional dynamic model of 
severe slugging for control design and analysis. 11th International Conference on …, 
pp.117–133. Available at: 
http://www.nt.ntnu.no/users/skoge/publications/2003/storkaas_multiphase03/Stor
kaasMultiphase03.pdf?origin=publication_detail. 

Sun, Y.Q. et al., 2008. Mathematical modeling of glycerol fermentation by Klebsiella 
pneumoniae: Concerning enzyme-catalytic reductive pathway and transport of 
glycerol and 1,3-propanediol across cell membrane. Biochemical Engineering Journal, 
38(1), pp.22–32. 

Tavares,  a. C., 2008. Modelagem matemática da degradação da glicose, com produção de 
hidrogênio, em um reator anaeróbio de leito fixo. Teses e Dissertações, p.85. 

Tyson, J.J. et al., 1999. A simple model of circadian rhythms based on dimerization and 
proteolysis of PER and TIM. Biophysical Journal, 77(5), pp.2411–2417. Available at: 
http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1300518/. 

Vérri, J.A., 2013. Estabilidade Global e Bifurcação de Hopf em um Modelo de HIV baseado 
em Sistemas do Tipo Lotka-Volterra Estabilidade Global e Bifurcação de Hopf em um 
Modelo de HIV baseado em Sistemas do Tipo Lotka-Volterra. Universidade Estadual 
Paulista. 

Vogel, J. V, 1968. Inflow Performance Relationships for Solution-Gas Drive Wells. Journal 
of Petroleum Technology, 20(1), pp.83–92. 

Volterra, V., 1926. Variazioni E Fluttuazioni Del Numero D’individui In Specie Animali 
Conviventi, 

Walt, S. van der, Colbert, S.C. &amp;amp; Varoquaux, G., 2011. The NumPy Array: A Structure for 
Efficient Numerical Computation. Computing in Science &amp;amp; Engineering, 13(2), pp.22–
30. 

Wang, H. et al., 2014. Optimization of a continuous fermentation process producing 1,3-
propane diol with Hopf singularity and unstable operating points as constraints. 
Chemical Engineering Science, 116, pp.668–681. Available at: 
http://dx.doi.org/10.1016/j.ces.2014.05.024. 

Wang, Y. &amp;amp; Liu, X., 2017. Stability and Hopf bifurcation of a within-host chikungunya virus 
infection model with two delays. Mathematics and Computers in Simulation, 138, 
pp.31–48. Available at: http://dx.doi.org/10.1016/j.matcom.2016.12.011. 



107   Referências 
 

 

Wang, Z. &amp;amp; Bovik, A.C., 2009. Mean Squared Error?: Love It or Leave It?? IEEE Signal 
Processing Magazine, 26(January), pp.98–117. Available at: 
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4775883. 

Zak, D.E., Stelling, J. &amp;amp; Doyle, F.J., 2005. Sensitivity analysis of oscillatory (bio)chemical 
systems. Computers and Chemical Engineering, 29(3), pp.663–673. 

Zamamiri, A.Q.M., Birol, G. &amp;amp; Hjortsø, M.A., 2001. Multiple stable states and hysteresis in 
continuous, oscillating cultures of budding yeast. Biotechnology and Bioengineering, 
75(3), pp.305–312. 

Zhang, X. et al., 2015. Sobol Sensitivity Analysis?: A Tool to Guide the Development and 
Evaluation of Systems Pharmacology Models. , (February), pp.69–79. 

Zhang, Y. &amp;amp; Henson, M.A., 2001. Bifurcation analysis of continuous biochemical reactor 
models. Biotechnology Progress, 17(4), pp.647–660. 

 

 



 
  

Apêndice A – Implementação dos Modelos 
Neste apêndice são apresentados os códigos de implementação dos modelos de Diehl 

et al. (2017), Jöbses et al. (1986) e Lotka-Volterra. Os modelos matemáticos foram 
implementados na linguagem Modelica. Os modelos são compilados através da 
integração entre a Plataforma JModelica.org e a linguagem de programação Python. 

Diehl et al. (2017) 

%%file FOWM.mop  
model FOWM 
        //BATIMETRIA E PARÂMETROS DO POÇO 
            parameter Real Rol     = 900; 
            parameter Real R       = 8314; 
            parameter Real T       = 298; 
            parameter Real M       = 18; 
            parameter Real g       = 9.81; 
            parameter Real teta    = 3.141592653589793/4; 
            parameter Real Pr      = 2.25e7; 
            parameter Real Ps      = 1013250; 
            parameter Real ALFAgw  = 0.0188; 
            parameter Real Romres  = 891.9523; 
            parameter Real L       = 4497; 
            parameter Real Lt      = 1639; 
            parameter Real La      = 1118; 
            parameter Real D       = 0.152; 
            parameter Real Dt      = 0.150; 
            parameter Real Da      = 0.140; 
            parameter Real Hvgl    = 916; 
            parameter Real Hpdg    = 1117; 
            parameter Real Ht      = 1279;    
        // CÁLCULO DAS GEOMETRIAS 
            parameter Real A       = D*D*3.141592653589793/4; 
            parameter Real Vt      = Lt*Dt*Dt*3.141592653589793/4; 
            parameter Real Va      = La*Da*Da*3.141592653589793/4;     
        //PARÂMETROS DE AJUSTE 
            parameter Real mlstill = 1957.031302138902;  
            parameter Real Cg      = 0.000205390205;  
            parameter Real Cout    = 0.019677777778;  
            parameter Real Veb     = 83.5090666667;  
            parameter Real E       = 0.571431327160;  
            parameter Real Kw      = 0.000867943572;  



109   Implementação dos Modelos 
 

 

            parameter Real Ka      = 0.000159061894;  
            parameter Real Vr      = 620.364197531;  
            parameter Real Kr      = 131.313519772;  
        //PARAMETROS DE ENTRADA  
            input Real z; 
            input Real Wgc; 
        //CONDIÇÕES INICIAIS       
            parameter Real x1_0    = 8955; 
            parameter Real x2_0    = 5286; 
            parameter Real x3_0    = 33373; 
            parameter Real x4_0    = 2197; 
            parameter Real x5_0    = 1776; 
            parameter Real x6_0    = 11211;  
        //SAIDAS  
            //ESTADOS 
            Real x1(fixed=true,start=x1_0);  
            Real x2(fixed=true,start=x2_0);  
            Real x3(fixed=true,start=x3_0);  
            Real x4(fixed=true,start=x4_0);  
            Real x5(fixed=true,start=x5_0); 
            Real x6(fixed=true,start=x6_0);   
            //RISER + PIPELINE 
            Real Peb, Prt, Prb, ALFAg, ALFAl, Wout, Wlout, Wgout, Wg;     
            //TUBING       
            Real Vgt, ROgt, ROmt, Ptt, Ptb, Ppdg, Pbh, ALFAgt, Wwh, Wwhg, Wwhl, Wr;     
            //ANULAR 
            Real Pai, ROai, Wiv; 
        equation 
            //RISER + PIPELINE 
            Peb = x1*R*T/(M*Veb); 
            Prt = x2*R*T/(M*(Vr-(x3+mlstill)/Rol)); 
            Prb = Prt + (x3 + mlstill)*g*sin(teta)/A; 
            ALFAg = x2/(x2 + x3); 
            ALFAl = 1 - ALFAg;       
            Wout = Cout*z*sqrt((Rol*max(0,(Prt - Ps)))); 
            Wlout = ALFAl*Wout; 
            Wgout = ALFAg*Wout; 
            Wg = Cg*max(0,(Peb - Prb));     
            //TUBING         
            Vgt = Vt - x6/Rol;    
            ROgt = x5/Vgt;  
            ROmt = (x5 + x6)/Vt;         
            Ptt  = ROgt*R*T/M; 
            Ptb  = Ptt + ROmt*g*Hvgl; 
            Ppdg = Ptb + Romres*g*(Hpdg-Hvgl); 
            Pbh    = Ppdg + Romres*g*(Ht-Hpdg);         
            ALFAgt = x5/(x6 + x5);         
            Wwh = Kw*sqrt(Rol*max(0,(Ptt - Prb))); 
            Wwhg = Wwh*ALFAgt; 
            Wwhl = Wwh*(1 - ALFAgt); 
            Wr   = Kr*(1-0.2*Pbh./Pr-0.8*(Pbh./Pr).^2);     
            //ANULAR 
            Pai  = ((R*T/(Va*M)) + (g*La/Va))*x4;       
            ROai = M*Pai/(R*T);                            
            Wiv  = Ka*sqrt(ROai*max(0,(Pai - Ptb)));     
            //ODE 



110   Implementação dos Modelos 
 

 

            der(x1) = (1 - E)*(Wwhg) - Wg;                    
            der(x2) = E*(Wwhg) + Wg - Wgout;                 
            der(x3) = Wwhl - Wlout;                            
            der(x4) = Wgc - Wiv;                               
            der(x5) = Wr * ALFAgw + Wiv - Wwhg;                
            der(x6) = Wr * ( 1 - ALFAgw ) - Wwhl; 

        end FOWM; 

Jöbses et al. (1986) 

%%file jobses.mop 
model jobses 
        //PARAMETROS 
            parameter Real Cpo=0; 
            parameter Real Ceo=0; 
            parameter Real Cxo=0; 
            parameter Real Ks=0.5; 
            parameter Real k1=16.0; 
            parameter Real k2=0.497; 
            parameter Real k3=0.00383; 
            parameter Real ms=2.16; 
            parameter Real mp=1.55; 
            parameter Real Ysx=0.02339905; 
            parameter Real Ypx=0.05; 
            parameter Real Df=0.07; 
        //ESTADOS 
            Real Cs(fixed=true, start=80.67); 
            Real Cx(fixed=true, start=1.47); 
            Real Ce(fixed=true, start=0.08); 
            Real Cp(fixed=true, start=58.08); 
        //ENTRADAS 
            input Real Cso; 
    equation 
        //ODE 
            der(Cs) = (-1/Ysx)*((Cs*Ce)/(Ks+Cs))-ms*Cx+Df*(Cso-Cs); 
            der(Cx) = ((Cs*Ce)/(Ks+Cs))+Df*(Cxo-Cx); 
            der(Ce) = (k1-k2*Cp+k3*Cp^2)*((Cs*Ce)/(Ks+Cs))+Df*(Ceo-Ce);                    
            der(Cp) = (1/Ypx)*((Cs*Ce)/(Ks+Cs))+mp*Cx+Df*(Cpo-Cp); 
end jobses; 

Lotka-Volterra 

%%file LV.mop 
model LotkaVolterra  
        //PARAMETROS 
            parameter Real k1=1; 
            parameter Real k2=1; 
            parameter Real k3=1; 
            parameter Real k4=0.1; 
            parameter Real x_init=0.4; 
            parameter Real y_init=1; 
        //ESTADOS 
            Real x(fixed=true, start=x_init); 
            Real y(fixed=true, start=y_init); 
    equation 
        //ODE 



111   Implementação dos Modelos 
 

 

            der(x) = (-k1 * x) + (k2 * x * y); 
            der(y) = (k3 * y) - (k4 * x * y);                   

        end LotkaVolterra; 

Simulação dos Modelos Matemáticos 

Os modelos matemáticos são simulados através do integrador CVoed, da biblioteca 
SUNDIALS, semelhante ao integrados ODE15s (Simulink/MATLAB). 

def sim_model(p,0): 
    meas_var 
    ft=time[-1] 
    st=time[0] 
    # Inicialização do modelo 
    init_model.reset() 
    # Inicialização dos parâmetros de estimação 
    init_model.set(['parâmetros do modelo'], p) 
    # Opções do integrador 
    opts = init_model.simulate_options() 
    opts['ncp'] = time.size-1 
    opts['CVode_options']['verbosity'] = 50 
    opts['CVode_options']['atol'] = 1e-10 
    opts['CVode_options']['rtol'] = 1e-10 
    opts['result_handling'] = 'memory'  
    # Simulação do modelo 
    res_seg = init_model.simulate(start_time=time[0],final_time=time[-1], 
                                                            input=(['variáveis de entrada do modelo'],u_traj),options=opts) 
    # Variável simulada/estimada 
    est_var = res_seg['Ppdg'] 
    return est_var, meas_var 

 
 



 
  

Apêndice B – Função Objetivo 
Neste apêndice são apresentadas as implementações dos cálculos das funções 

objetivo pelo método de mínimos quadrados e da função objetivo proposta. São 
apresentados os pacotes utilizados para a programação da metodologia, a função de 
simulação dos modelos matemáticos, a função de cálculo do termo do período, a função 
de cálculo do termo de número de oscilações, a função de cálculo do termo da média e 
por fim, a implementação do cálculo das duas funções objetivo. 

Pacotes 

São utilizadas bibliotecas, ou pacotes, básicas da linguagem de programação Python 
para computação científica, como como falado na Seção 4.8, e pacotes de integração 
entre a plataforma Jmodelica.org e a linguagem Python. 

# Pacotes utilizados 
import pandas as pd 
import nlopt  
from pymodelica import compile_fmu 
from datetime import timedelta,time 
from sklearn.preprocessing import scale 
import numpy as np 
import matplotlib.pyplot as plt 
from scipy import signal 
from pyfmi import load_fmu 
import scipy.interpolate as inter 
from scipy import stats 
from sklearn.metrics import mean_squared_error 
import oscilation as osc 
from scipy import fftpack  
import variable_average_signal as vas 
import tau_calcclass 
from IPython.display import clear_output 
from numpy import absolute, arange, NaN, Inf, isscalar, asarray, array 
from scipy.signal import kaiserord, lfilter, firwin, freqz, find_peaks_cwt 
from numpy import NaN, Inf, arange, isscalar, asarray, array 
import sys 

Cálculo do Período  

Implementação do procedimento descrito na Seção 4.3. 



113   Função Objetivo 
 

 

class tau_calc(object): 
    def __init__(self, est_var, meas_var, time): 
        # Transformada Rápida de Fourier 
        self.F_sim, self.mask1 = self.__FFT__(est_var, time) 
        self.F_meas, self.mask2 = self.__FFT__(meas_var, time) 
        self.d={'PDG_sim':abs(self.F_sim[self.mask1])/time.size, 
                      'PDG_meas':abs(self.F_meas[self.mask2])/time.size} 
        self.Freqa = pd.DataFrame(self.d) 
        self.MaxF_sim = self.Freqa.PDG_sim.sort_values(ascending=False) 
        self.freq_sim = self.MaxF_sim.index[0] 
        self.MaxF_meas = self.Freqa.PDG_meas.sort_values(ascending=False) 
        self.freq_meas = self.MaxF_meas.index[0] 
        # Cálculo do período dos dados medidos 
        self.meas_tau = 1. / self.freq_meas 
        # Cálculo do período dos dados estimados 
        self.est_tau = 1. / self.freq_sim 
        return meas_tau, est_tau 
    def __FFT__(self, y, time): 
        # Transformada Rápida de Fourier 
        self.N = y.size 
        self.T = float(time[-1] - time[0]) 
        self.f_s = (self.N / self.T) 
        self.delta_f = (self.f_s / self.N) 
        self.B = self.f_s / 2 
        self.f_t = self.y - (np.mean(y)) 
        self.F = fftpack.fft(self.f_t) 
        self.ff = fftpack.fftfreq(self.N, 1.0/self.f_s) 
        self.mask = np.where(self.ff &gt;= 0) 
        return self.F, self.mask 

Cálculo do Número de Oscilações  

Implementação do procedimento descrito na Seção 4.4. 

class oscilation_detection(object): 
    def __init__(self, y, sample_time = None, a = 80.0, b = 3.0, c = 10.0, d = 1.0, delta = 10000): 
        # Validação de dados 
        if sample_time is None: 
            sample_time = arange(len(y)) 
            y = asarray(y) 
        if len(y) != len(sample_time): 
            sys.exit('Input vectors y and time must have same length') 
        if not isscalar(delta): 
            sys.exit('Input argument delta must be a scalar') 
        if delta&amp;lt;= 0: 
            sys.exit('Input argument delta must be positive') 
        self.delta = delta  
        self.sample_rate = sample_time.size 
        #------------------------------------------------ 
        # Definição de filtro FIR 
        #------------------------------------------------ 
        # Frequencia de Nyquist 
        self.nyq_rate = self.sample_rate / a 
        # Banda do sinal 
        self.width = b/self.nyq_rate 
        # Atenuação do sinal 



114   Função Objetivo 
 

 

        self.ripple_db = c 
        # Cálculo da ordem e do parâmetro de Kaiser para o filtro 
        self.N, self.beta = kaiserord(self.ripple_db, self.width) 
        # Frequencia de corte do filtro 
        self.cutoff_hz = d 
        # Filtro passa baixa 
        self.taps = firwin(self.N, self.cutoff_hz/self.nyq_rate, window=('kaiser', self.beta)) 
        self.filtered_y = lfilter(self.taps, 1.0, y) 
        # Chamada da função de identificação de picos e vales 
        self.__peak_valley_detection__(self.filtered_y[10::], delta, sample_time[10::])        
    # Função de identificação de picos e vales     
    def __peak_valley_detection__(self, y,  delta, sample_time): 
        self.peak = [] 
        self.valley = [] 
        self.valley_time = [] 
        self.peak_time = [] 
        self.scatter_peak = [] 
        self.scatter_valley = [] 
        self.mn, self.mx = Inf, -Inf 
        self.mnpos, self.mxpos = NaN, NaN 
        self.lookformax = True 
        for i in arange(len(y)): 
            this = y[i] 
            if this &gt; self.mx: 
                self.mx = this 
                self.mxpos = sample_time[i] 
            if this &amp;lt;self.mn: 
                self.mn = this 
                self.mnpos = sample_time[i] 
            if self.lookformax: 
                if this &amp;lt;self.mx-delta: 
                    self.peak.append((self.mx)) 
                    self.peak_time.append((self.mxpos)) 
                    self.scatter_peak.append((self.mxpos, self.mx)) 
                    self.mn = this 
                    self.mnpos = sample_time[i] 
                    self.lookformax = False 
            else: 
                if this &gt; self.mn+self.delta: 
                    self.valley.append((self.mn)) 
                    self.valley_time.append((self.mnpos)) 
                    self.scatter_valley.append((self.mnpos,self.mn)) 
                    self.mx = this 
                    self.mxpos = sample_time[i] 
                    self.lookformax = True 
        # Cálculo do número de oscilações do sinal 
        self.osc_num = array(self.valley).size - 1         
        print "Number of oscilations: ", self.osc_num 
        return array(self.peak), array(self.valley) 

Cálculo do Número de Oscilações  

Implementação do procedimento descrito na Seção 4.5. 

class find_zeros(object): 
    def __init__(self, y, sample_time, peak, valley, peak_time, valley_time, order): 



115   Função Objetivo 
 

 

        # Validação dos dados 
        if sample_time is None: 
            sample_time = arange(len(y)) 
            y = asarray(y) 
        if len(y) != len(sample_time): 
            sys.exit('Input vectors y and time must have same length') 
        if len(peak) != len(peak_time): 
            sys.exit('Input vectors peak and peak_time must have same length') 
        if len(valley) != len(valley_time): 
            sys.exit('Input vectors valley and valley_time must have same length') 
        if not isscalar(order): 
            sys.exit('Input argument order must be a scalar') 
        if order&amp;lt;= 0: 
            sys.exit('Input argument order must be positive') 
        # Chamada da função de identificação de pontos médios de subida e descida    
        self.__calculate_zeros__(y, sample_time, peak, valley, peak_time, valley_time, order) 
    # Função de identificação de pontos médios de subida e descida         
    def __calculate_zeros__(self, y, sample_time, peak, valley, peak_time, valley_time, order): 
        self.indexp = [] 
        self.indexp_cor = self.indexp 
        for i in range(sample_time.size): 
                for h in range(array(peak_time).size): 
                    if (sample_time[i] == peak_time[h]): 
                        self.indexp.append(i)  
        self.pico = inter.spline(peak_time,peak,sample_time[self.indexp[0]:self.indexp[-1]],order = order) 
        self.indexv = [] 
        for i in range(sample_time.size): 
            for h in range(array(valley_time).size): 
                if (sample_time[i] == valley_time[h]): 
                    self.indexv.append(i)  
        self.vale = inter.spline(valley_time,valley,sample_time[self.indexv[0]:self.indexv[-1]],order = order) 
         
        if array(valley_time).size&amp;lt;= array(peak_time).size: 
            if valley_time[0] &gt; peak_time[0]: 
                self.peak_time_cor = array(np.delete(array(peak_time),0)) 
                self.peak_cor = array(np.delete(array(peak),0)) 
                self.indexp_cor = array(np.delete(array(self.indexp),0)) 
            try: 
                if valley_time[-1] &amp;lt;peak_time[-1]: 
                    self.peak_time_cor = array(np.delete(array(self.peak_time_cor),-1)) 
                    self.peak_cor = array(np.delete(array(self.peak_cor),-1)) 
                    self.indexp_cor = array(np.delete(array(self.indexp_cor),-1)) 
            except:  
                if valley_time[-1] &amp;lt;peak_time[-1]: 
                    self.peak_time_cor = np.delete(array(peak_time),-1) 
                    self.peak_cor = np.delete(array(peak),-1) 
                    self.indexp_cor = np.delete(array(self.indexp),-1) 
        self.zeroy = [] 
        for i in range(array(self.peak_cor).size): 
            self.zeroy.append(mean([self.peak_cor[i], valley[i]])) 
            self.zeroy.append(mean([self.peak_cor[i], valley[i+1]])) 
        if array(self.indexp).size != array(self.indexp_cor).size: 
            self.indexp_cor = [] 
            for i in range(sample_time.size): 
                for h in range(array(self.peak_time_cor).size): 
                    if (sample_time[i] == self.peak_time_cor[h]): 



116   Função Objetivo 
 

 

                        self.indexp_cor.append(i)  
            self.pico = inter.spline(self.peak_time_cor,self.peak_cor, 
                                                     sample_time[self.indexp_cor[0]:self.indexp_cor[-1]],order = order) 
            self.__approximate_zeros__(self.zeroy, self.indexv, self.indexp_cor, y,  
                                                                 sample_time, self.pico, self.vale, order) 
        else: 
            for i in range(sample_time.size): 
                for h in range(array(peak_time).size): 
                    if (sample_time[i] == peak_time[h]): 
                        self.indexp.append(i)  
            self.pico = inter.spline(peak_time,peak,sample_time[self.indexp[0]:self.indexp[-1]],order = order) 
            self.__approximate_zeros__(self.zeroy, self.indexv, self.indexp, y,  
                                                                 sample_time, self.pico, self.vale, order) 
    def __find_nearest__(self, array, value): 
        self.idx = (np.abs(array-value)).argmin() 
        return array[self.idx] 
    def __approximate_zeros__(self, zeroy, indexv, index_p, y, sample_time, pico, vale, order): 
        self.med = []     
        self.time_med = [] 
        self.j = 0 
        for i in range(array(zeroy).size): 
            if i%2 == 0: 
                self.seg = y[indexv[i/2]:index_p[i/2]] 
                self.segt = sample_time[indexv[i/2]:index_p[i/2]] 
                self.med.append(self.__find_nearest__(self.seg, zeroy[i])) 
                for h in range(self.seg.size): 
                    if self.seg[h] == self.med[-1]: 
                        self.time_med.append(self.segt[h]) 
            else:  
                self.seg = y[index_p[self.j]:indexv[i-self.j]] 
                self.segt = sample_time[index_p[self.j]:indexv[i-self.j]] 
                self.med.append(self.__find_nearest__(self.seg, zeroy[i])) 
                self.j = self.j + 1 
                for h in range(self.seg.size): 
                    if self.seg[h] == self.med[-1]: 
                        self.time_med.append(self.segt[h]) 
        self.indexz = [] 
        for i in range(sample_time.size): 
            for h in range(array(self.time_med).size): 
                if (sample_time[i] == self.time_med[h]): 
                    self.indexz.append(i) 
        self.zeros = inter.spline(self.time_med,zeroy,sample_time[self.indexz[0]:self.indexz[-1]],order = order) 
        self.__return_curves__(self.zeros, indexv, index_p, self.indexz, sample_time, pico, vale) 
    # Função que retorna a curva que passa pelos pontos medidos de subida e descida 
    def __return_curves__(self, zeros, indexv, indexp_, indexz, sample_time, pico, vale): 
        self.ar1 = np.zeros((indexp_[0])) 
        self.ar2 = np.zeros((sample_time.size - indexp_[-1])) 
        self.ar1[:] = pico[0] 
        self.ar2[:] = pico[-1] 
        self.peak_spline = np.append(self.ar1,pico) 
        self.peak_spline = np.append(self.peak_spline,self.ar2) 
        self.ar1 = np.zeros((indexv[0])) 
        self.ar2 = np.zeros((sample_time.size - indexv[-1])) 
        self.ar1[:] = vale[0] 
        self.ar2[:] = vale[-1] 
        self.valley_spline = np.append(self.ar1,vale) 



117   Função Objetivo 
 

 

        self.valley_spline = np.append(self.valley_spline,self.ar2) 
        self.ar1 = np.zeros((indexz[0])) 
        self.ar2 = np.zeros((sample_time.size - indexz[-1])) 
        self.ar1[:] = zeros[0] 
        self.ar2[:] = zeros[-1] 
        self.zeros_spline = np.append(self.ar1,zeros) 
        self.zeros_spline = np.append(self.zeros_spline,self.ar2) 
        return (self.peak_spline, self.valley_spline, self.zeros_spline) 

Cálculo da Função Objetivo 

Implementação do procedimento descrito na Seção 4.6. 

def objective_function(p,0): 
    # Simulação do modelo 
    est_var, meas_var = sim_model(p,0) 
    # Cálculo do método dos mínimos quadrados 
    mse = np.sqrt((1./meas_var.size)*(np.sum(np.square((np.mean(meas_var) – 
                                                                   np.mean(est_var))/np.mean(meas_var))))) 
    # Inicialização dos termos da função objetivo 
    global no, tau 
    mean = no = tau = 0 
    # Definição dos vetores de variáveis 
    var = {'est_var':est_var, 'meas_var':meas_var} 
    var2 = [['est_var', 'meas_var']] 
    # Loop de cálculo 
    for i, j in (var2): 
        # Amplitude mínima 
        delta1: (np.max(meas_var)-np.min(meas_var))*0.8 
        # Cálculo do período dos sinais estimado e medido 
        tau_calc(var[i], var[j], time) 
        # Dados medidos 
        # Identificações de picos e vales dos dados medidos 
        A1_meas = osc.oscilation_detection(var[j], time, a=80.0, b=3, c=10, d=1, delta=delta1) 
        # Cálculo do número de oscilações dos dados medidos 
        meas_no = A1_meas.osc_num 
        # Identificação de pontos médios de subida e descida dos ciclos dos dados medidos 
        B1_meas = vas.find_zeros(var[j], time, A1_meas.peak,  
                                                        A1_meas.valley, A1_meas.peak_time, A1_meas.valley_time,2) 
        zero_meas = np.array(B1_meas.zeroy) 
        # Dados estimados 
        try:   
            # Identificações de picos e vales dos dados estimados 
            A1_sim = osc.oscilation_detection(var[i], time,  a=80.0, b=3, c=10, d=1, delta=delta1) 
            # Cálculo do número de oscilações dos dados estimados 
            est_no = A1_sim.osc_num 
            # Identificação de pontos médios de subida e descida dos ciclos dos dados estimados 
            B1_sim = vas.find_zeros(var[i], time, A1_sim.peak, A1_sim.valley,  
                                                         A1_sim.peak_time, A1_sim.valley_time,2) 
            zero_sim = np.array(B1_sim.zeroy) 
        # Penalização de regiões não-oscilatórias 
        except: 
            zero_sim = -zero_meas 
            est_no = pen 
        if len(zero_sim) &gt; len(zero_meas): 
            n = len(zero_sim) - len(zero_meas) 



118   Função Objetivo 
 

 

            zero_meas = np.concatenate((zero_meas,np.zeros((n)))) 
        if len(zero_sim) &amp;lt;len(zero_meas): 
            n = abs(len(zero_sim) - len(zero_meas)) 
            zero_sim = np.concatenate((zero_sim,np.zeros((n)))) 
        # Cálculo dos termos da função objetivo proposta 
        mean = np.sqrt(np.sum(np.square((zero_meas - zero_sim)/np.mean(var[j])))) + mean 
        no = np.sqrt(((np.square(no_meas - no_sim)))) + no 
        tau = np.sqrt(((np.square(est_tau - meas_tau)))) + tau 
        clear_output() 
    # Função objetivo proposta e método dos mínimos quadrados    
    return tau + mean + no, mse 
 


	Capítulo 1 – Introdução
	1.1 Objetivos do Trabalho
	1.2 Estrutura da Dissertação

	Capítulo 2 – Fundamentação Teórica
	2.1 Ciclo Limite
	2.1.1 Plano de Fase
	2.1.2 Bifurcação Hopf

	2.2 Sistemas Biológicos e Biotecnológicos
	2.2.1 Sistemas Biológicos
	2.2.2 Sistemas Biotecnológicos

	2.3 Produção de Petróleo Offshore tipo Gas-lift
	2.3.1 Escoamento Multifásico
	Escoamento Multifásico Vertical
	Escoamento Multifásico Horizontal

	2.3.2 Estrutura do Sistema de Elevação de Petróleo
	2.3.3 Técnica de Gas-lift
	2.3.4 Golfadas no Sistema de Produção tipo Gas-lift
	Golfada por Cabeceio anular
	Golfada por Onda de Densidade
	Golfada por Acidente de Terreno

	2.3.5 Variáveis Medidas
	Sensor PDG
	Sensor TPT

	2.3.6 Modelagem de Sistemas de Produção de Petróleo Offshore tipo Gas-lift


	Capítulo 3 – Revisão Bibliográfica
	3.1 Formulação do Problema de Estimação de Parâmetros
	3.2 Convexidade
	Conjunto e Função Convexos

	3.3 Algoritmos de Otimização
	BOBYQA (Powell, 2009)
	DIRECT (Finkel, 2003)

	3.4 Estimação de Parâmetros de Modelos com Ciclo Limite
	3.5 Análise de Sensibilidade de Modelos com Ciclo Limite
	Análise de Sensibilidade Local
	Análise de Sensibilidade Global


	Capítulo 4 – Metodologia para Estimação de Parâmetros
	4.1 Formulação do Problema de Estimação de Parâmetros
	4.2 Comportamento Oscilatório
	4.2.1 Remoção do Ruído
	4.2.2 Identificação da Frequência Fundamental do Sinal

	4.3 Período - ?
	4.4 Número de Oscilações - ?
	4.5 Média - ?
	4.6 Cálculo do Erro
	4.6.1 Função Objetivo Proposta

	4.7 Análise de Sensibilidade
	Análise de Sensibilidade Sobol

	4.8 Estrutura de Otimização
	4.9 Métricas de Desempenho das Funções Objetivo

	Capítulo 5 – Aplicação dos Modelos de Lotka-Volterra e Jöbses et al. (1986)
	5.1 Lotka-Volterra
	5.2 Jöbses et al. (1986)
	5.3 Análise do Plano de Fase
	5.4 Análise de Sensibilidade
	Lotka-Volterra
	Jöbses et al. (1986)
	5.4.1 Análise de Convexidade

	5.5 Cenários
	5.5.1 Lotka-Volterra
	5.5.2 Jöbses et al. (1986)

	5.6 Estimação de Parâmetros – Análise Quantitativa
	5.6.1 Lotka-Volterra
	5.6.1.1 Cenário A
	5.6.1.2 Cenário B
	5.6.2 Jöbses et al. (1986)
	5.6.2.1 Cenário A
	5.6.2.2 Cenário B
	5.6.2.3 Cenário C

	5.7 Estimação de Parâmetros – Análise Quantitativa
	5.7.1 Resultados


	Capítulo 6 – Aplicação do Modelo de Diehl et al. (2017)
	6.1 Inicialização dos Parâmetros
	6.2 Estudo de Caso – Poço Real
	6.2.1.1 Análise de Sensibilidade
	5.2.1.1. Análise de Convexidade

	5.3. Estimação de Parâmetros
	5.3.1. Estimação de Parâmetros com pressões ,?-??., ,?-??. e ,?-???.
	5.3.2. Estimação de Parâmetros com pressão ,?-??.
	6.2.1.2 Análise do Plano de Fase


	Capítulo 7 – Conclusões
	7.1 Conclusões sobre a Função Objetivo Proposta
	7.2 Sugestões de Trabalhos Futuros

	Referências
	Apêndice A – Implementação dos Modelos
	Diehl et al. (2017)
	Jöbses et al. (1986)
	Lotka-Volterra
	Simulação dos Modelos Matemáticos

	Apêndice B – Função Objetivo
	Pacotes
	Cálculo do Período
	Cálculo do Número de Oscilações
	Cálculo do Número de Oscilações
	Cálculo da Função Objetivo


</field>
	</doc>
</add>