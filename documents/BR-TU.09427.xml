<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09427</field>
		<field name="filename">14403_tde.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
CARLOS ROBERTO PORFÍRIO

IMPLANTAÇÃO DE UM CONTROLADOR MULTIMODELOS EM

UMA COLUNA DEPROPANIZADORA INDUSTRIAL

Dissertação apresentada à Escola
Politécnica  da  Universidade  de
São Paulo para obtenção do título
de Mestre em Engenharia.

SÃO PAULO
Outubro/2001



CARLOS ROBERTO PORFÍRIO

IMPLANTAÇÃO DE UM CONTROLADOR MULTIMODELOS EM

UMA COLUNA DEPROPANIZADORA INDUSTRIAL

Dissertação apresentada à Escola
Politécnica  da  Universidade  de
São Paulo para obtenção do título
de Mestre em Engenharia.

Área de Concentração:
Engenharia Química

Orientador:
Prof. Dr Darci Odloak

SÃO PAULO
Outubro/2001



        Porfírio, Carlos Roberto
     Implantação de um Controlador Multimodelos em uma Coluna

Depropanizadora Industrial.
        São Paulo, 2001.

      130p.

      Dissertação (Mestrado) – Escola Politécnica  da  Universidade  de
São Paulo. Departamento de Engenharia Química.

1. Controle de Processo     2. Controle Preditivo   3. Coluna
Depropanizadora  4.  Controle Multimodelos

I. Universidade de São Paulo.  Escola Politécnica. Departamento de
Engenharia Química II. T



i

A todos os meus mestres, que ao longo de minha
vida me mostraram o valor da educação, e a Deus
por me dar forças para conseguir superar todas as
dificuldades enfrentadas nesta jornada.



ii

AGRADECIMENTOS

Ao Prof. Dr. Darci Odloak pela orientação e dedicação, tornando possível a realização

deste trabalho.

À minha esposa e filho, Ronilda e Gabriel, pela compreensão e incentivo durante a

realização deste trabalho.

Ao engenheiro Euclides Almeida Neto pela paciência, apoio e incentivo nas

intermináveis discussões durante a realização deste trabalho.

À Petrobras, em nome do engenheiro Antônio Maylinch Teruel, por permitir e

incentivar  a realização desta especialização profissional.

Ao colega Dr. Oscar Rotava pelas sugestões e revisão  final do trabalho.

Ao colega Dr. Marco Antônio Rodrigues pela ajuda na preparação das transparências

para a apresentação final deste trabalho.

A meu pai Onofre Porfírio e meus irmãos Maurício, Elcio, Beatriz, Rodrigo e Júnior

pelo incentivo durante toda minha vida acadêmica e também pela amizade, carinho e

convivência.

Aos Operadores da Unidade de Craqueamento Fluido da RPBC pelo auxílio durante os

diversos testes realizados na unidade durante a elaboração deste trabalho.



iii

SUMÁRIO

INTRODUÇÃO ................................................................................................................ 1

1.1 - Apresentação da problemática de controle de colunas de pureza elevada............ 1

1.2 - Revisão bibliográfica ............................................................................................ 2

1.3 - Objetivo do trabalho ............................................................................................. 6

PROBLEMA DE CONTROLE DA COLUNA DEPROPANIZADORA ........................ 8

2.1 - Especificações dos produtos ................................................................................. 8

2.1.1 - Especificações do PROPANO ........................................................................... 8

2.1.2 - Especificações do BUTANO ............................................................................. 9

2.2 - Descrição do processo........................................................................................... 9

2.3 - Variáveis operacionais ........................................................................................ 10

2.3.1 - Vazão de carga ................................................................................................. 11

2.3.2 - Temperatura da carga....................................................................................... 11

2.3.3 - Composição da carga ....................................................................................... 11

2.3.4 - Pressão da coluna............................................................................................. 11

2.3.5 - Vazão de refluxo .............................................................................................. 12

2.3.6 - Vazão do fluido de aquecimento para refervedor ............................................ 12

2.3.7 - Temperatura de topo ........................................................................................ 12

2.4 - Fatores de desempenho do sistema ..................................................................... 13

2.5 - Limitações do processo....................................................................................... 13

2.6 - Estratégias de controle da coluna depropanizadora ............................................ 13

2.6.1 - Temperatura de retorno do refervedor  - vazão de refluxo de topo ................. 14

2.6.2 - Vazão do fluido de aquecimento do refervedor  - vazão de refluxo de topo ... 15

DESCRIÇÃO SUMÁRIA DO HYSYS™.......................................................................17

SIMULAÇÃO ESTÁTICA DA DEPROPANIZADORA .............................................. 19

4.1 –  Etapas da construção do modelo estático .......................................................... 19

4.1.1 – Definição das bases de simulação ................................................................... 19

4.1.2 – Caracterização da carga do sistema................................................................. 21

4.1.3 – Definição das operações unitárias envolvidas no processo............................. 22



iv

4.1.4 – Especificação dos graus de liberdade do sistema............................................ 24

4.1.5 – Validação do modelo estático ......................................................................... 25

4.1.6 – Definição dos estudos da simulação estática................................................... 27

SIMULAÇÃO DINÂMICA DA DEPROPANIZADORA ............................................. 29

COMPORTAMENTO DO PROCESSO ........................................................................ 34

6.1 – Região de Operação e Ganhos do Processo ....................................................... 35

IDENTIFICAÇÃO DOS MODELOS DO SISTEMA .................................................... 43

7.1 – Algoritmo de identificação de modelos na forma analítica................................ 44

7.2 – Modelos de Processo Identificados .................................................................... 49

ALGORITMOS DE CONTROLE .................................................................................. 57

8.1 – MPC com modelo não-paramétrico ................................................................... 58

8.1.1 – Cálculo das predições das variáveis controladas............................................. 58

8.1.1.1 – Efeito da última ação de controle................................................................. 58

8.1.1.2 – Correção das predições com as leituras da planta ........................................ 60

8.1.1.3 – Translação da predição corrigida ................................................................. 63

8.1.2 – Cálculo das ações de controle ......................................................................... 64

8.1.2.1 – Trajetória de referência das variáveis controladas ....................................... 65

8.1.2.2 – Cálculo dos erros das variáveis controladas................................................. 67

8.1.2.3 – Algoritmo de controle preditivo................................................................... 68

8.1.2.3.1 – Algoritmo DMC ........................................................................................ 69

8.1.2.3.2 – Algoritmo QDMC ..................................................................................... 70

8.1.2.3.2.1 – Restrições de movimentos...................................................................... 72

8.1.2.3.2.2 – Restrições de limites .............................................................................. 72

8.2 – MPC com modelo de ordem reduzida................................................................ 74

8.2.1 – Modelo de função de transferência ................................................................. 74

8.2.2 – Predição com modelos paramétricos............................................................... 78

8.2.3 – Cálculo das predições das variáveis controladas............................................. 82

8.2.3.1 – Efeito da última ação de controle................................................................. 83

8.2.3.2 – Correção das predições com as leituras da planta ........................................ 84

8.2.3.3 – Translação da predição corrigida ................................................................. 86

8.2.4 – Cálculo das ações de controle ......................................................................... 89

8.2.4.1 – Trajetória de referência das variáveis controladas ....................................... 89



v

8.2.4.2 – Cálculo dos erros das variáveis controladas................................................. 90

8.2.5 – Algoritmo de controle preditivo...................................................................... 92

8.2.5.1 – MMPC (Multi-Model Predictive Control) ................................................... 92

8.2.5.1.1 – Algoritmo MMPC ..................................................................................... 93

8.2.5.1.2 – Representação de incertezas do sistema.................................................... 94

APLICAÇÃO DO MPC À COLUNA DEPROPANIZADORA .................................... 96

9.1 –  Comparação QDMC vs MMPC ........................................................................ 98

9.1.1 – Ajuste sintonia dos controladores ................................................................... 99

9.1.2 – QDMC e MMPC com sintonias ajustadas .................................................... 102

9.1.3 – Alteração no modelo da planta...................................................................... 105

9.2 – Implantação do controlador MMPC na planta industrial ................................. 109

9.2.1 – SICON - Sistema de Controle (da Petrobras)................................................ 118

CONCLUSÕES E SUGESTÕES ................................................................................. 122

10.1 – Conclusões ..................................................................................................... 122

10.2 – Sugestões........................................................................................................ 123

REFERÊNCIAS BIBLIOGRÁFICAS .......................................................................... 125

APÊNDICE A - FUNÇÃO DE TRANSFERÊNCIA DOS MODELOS

IDENTIFICADOS......................................................................................................... 129



vi

LISTA DE FIGURAS

Figura 2.1 – Esquema de produção de GLP em refinarias de petróleo ............................. 8

Figura 2.2 – Fluxograma de processo da coluna depropanizadora.................................10

Figura 4.1 – Fluxograma de processo da simulação ....................................................... 22

Figura 4.2 – Fluxograma de processo coluna simulada .................................................. 23

Figura 5.1 – Esquema de controle da coluna depropanizadora. ...................................... 30

Figura 5.2 – Diagrama em blocos da malha fechada. ..................................................... 33

Figura 6.1 – Dualidade das qualidades dos produtos da coluna...................................... 34

Figura 6.2 – Região de operação das variáveis manipuladas .......................................... 37

Figura 6.3 – Ganhos do C3- versus a vazão de refluxo................................................... 38

Figura 6.4 – Ganhos do C3- versus Vazão de GOP ........................................................ 39

Figura 6.5 – Ganhos do C4
+  versus vazão de refluxo ..................................................... 39

Figura 6.6 – Ganhos do C4
+ versus vazão de GOP ......................................................... 40

Figura 6.7 – Ganhos da Temperatura de Topo versus vazão de Refluxo........................ 40

Figura 6.8 – Ganhos da Temperatura de Topo versus vazão de GOP............................. 41

Figura 7.1 – Região de operação do processo ................................................................. 49

Figura 7.2 –Modelos de resposta ao degrau nas manipuladas. O modelo da planta real é

o FD......................................................................................................................... 51

Figura 7.3 – Modelos de resposta ao degrau nas perturbações. O modelo da planta real é

o FD................................................................................................................... ......52

Figura 9.1.a – Comparação QDMC( - - - ) x MMPC( ––– ) com mesma sintonia ....... 100

Figura 9.1.b – QDMCsupr = 0.001(- - -) QDMCsupr = 0.5(–––) ................................. 101

Figura 9.1.c – Alteração do “set-point” do teor de C3
- QDMC( - - - )  MMPC( –– ) ... 103

Figura 9.1.d – Alteração da faixa de controle da Ttopo QDMC( - - - )  MMPC( –– ).. 104

Figura 9.1.e – Aplicação de degrau na vazão de carga QDMC( - - - )  MMPC( –– ) ... 104

Figura 9.1.f – Aplicação de degrau na TGOP QDMC( - - - )  MMPC( –– ) ................. 105

Figura 9.1.g – Mudança p/ modelo 1 no instante 20 QDMC( - - - )  MMPC( –– )....... 106

Figura  9.1.h - Mudança modelo p/ 2 no instante 20 QDMC( - - - )  MMPC( –– ) ...... 107

Figura 9.1.i - Mudança modelo para 3 no instante 20 QDMC( - - - )  MMPC( –– )..... 107

Figura 9.1.j - Mudança modelo para 4 no instante 20 QDMC( - - - )  MMPC( –– )..... 108

Figura 9.1.k - Mudança modelo p/ 5 no instante 20 QDMC( - - - )  MMPC( –– ) ....... 109



vii

Figura 9.2.a1 – Variáveis controladas em operação típica............................................ 113

Figura 9.2.a2 – Variáveis manipuladas em operação típica .......................................... 113

Figura 9.2.a3 – Variáveis perturbadoras em operação típica ........................................ 113

Figura 9.2.b1 – Variáveis controladas teste 1 ............................................................... 114

Figura 9.2.b2 – Variáveis manipuladas teste 1.............................................................. 114

Figura 9.2.b3 – Variáveis perturbadoras teste 1 ............................................................ 114

Figura 9.2.c1 – Variáveis controladas teste 2................................................................ 115

Figura 9.2.c2 – Variáveis manipuladas teste 2.............................................................. 115

Figura 9.2.c3 – Variáveis perturbadoras teste 2 ............................................................ 116

Figura 9.2.d1 – Variáveis controladas teste 3 ............................................................... 117

Figura 9.2.d2 – Variáveis manipuladas teste 3.............................................................. 117

Figura 9.2.d3 – Variáveis perturbadoras teste 3 ............................................................ 117

Figura 9.2.e - Interfaces de controle.............................................................................. 118

Figura 9.2.f – Tela de configuração/sintonia do controlador ........................................ 120

Figura 9.2.g – Tela de configuração/sintonia de variável controlada............................ 120

Figura 9.2.h - Tela de configuração/sintonia de variável manipulada .......................... 121

Figura 9.2.i - Tela de Configuração de Variável Perturbadora ..................................... 121



viii

LISTA DE TABELAS

Tabela 4.1 – Componentes puros considerados .............................................................. 20

Tabela 4.2 – Condições da carga..................................................................................... 21

Tabela 4.3 – Composição da carga.................................................................................. 21

Tabela 4.4 – Especificações da simulação ...................................................................... 25

Tabela 4.5 – Resultados da simulação ............................................................................ 26

Tabela 4.6 – Variáveis manipuladas ............................................................................... 27

Tabela 4.7 – Restrições do processo ............................................................................... 27

Tabela 5.1 – Dados geométricos dos equipamentos ....................................................... 30

Tabela 5.2 – Parâmetros de configuração dos controladores .......................................... 31

Tabela 5.3 – Parâmetros de sintonia dos controladores .................................................. 31

Tabela 6.1 – Parâmetros dos modelos das inferências .................................................... 36

Tabela 6.2 – Ganhos do processo em relação à vazão de refluxo ................................... 41

Tabela 6.3 – Ganhos do processo para a vazão de GOP. ................................................ 42

Tabela 6.4 – Ganhos do processo para a vazão de carga ................................................ 42

Tabela 6.5 – Ganhos do processo para a temperatura do fluido de aquecimento ........... 42

Tabela 7.1 – Pontos de operação dos modelos do processo............................................ 50

Tabela 9.1 – Ganhos dos modelos identificados ............................................................. 99

Tabela 9.2: Características dos controladores utilizados ................................................ 99

Tabela 9.3 – Parâmetros de sintonia dos controladores para figura 9.1.a ..................... 100

Tabela 9.4 – Parâmetros de sintonia dos controladores para figura 9.2.a ..................... 101

Tabela 9.5 – Sintonia dos controladores para item 9.1.2 .............................................. 102

Tabela 9.6 – Parâmetros de sintonia do controlador industrial ..................................... 112

Tabela A1 – Parâmetros da função de transferência para o modelo 1 .......................... 129

Tabela A2 – Parâmetros da função de transferência para o modelo 2 .......................... 130

Tabela A3 – Parâmetros da função de transferência para o modelo 3 .......................... 130

Tabela A4 – Parâmetros da função de transferência para o modelo 4. ......................... 131

Tabela A5 – Parâmetros da função de transferência para o modelo 5..........................131

Tabela A6 – Parâmetros da função de transferência para modelo da planta industrial 132



ix

LISTA DE ABREVIATURAS

C3
- % propano e componentes com pesos moleculares mais baixos

C4
+ % de iso-butano e componentes de maior peso molecular

CV1 Variável controlada 1

CV2 Variável controlada 2

DDE Dynamic Data Exchange

DEA Di-Etanol amina

Det(Kp) Determinante da matriz de ganhos do processo

DMC Dynamic Matrix Control

FCC Craqueamento catalítico flúido

FC Controlador de vazão

FIR Finite Impulse Response

GLP Gás Liqüefeito de Petróleo

GPC Generalized Predictive Control

HYSYS? Software de simulação de processo da empresa Hyprotech Inc

ISE Integral do erro quadrático

LDMC Linear Dynamic Matrix Control

LC Controlador de Nível

LMI Linear Matrix Inequality

LP Programação linear

LREB Nível de fundo da coluna

L/V Relação molar líquido e vapor no estágio da coluna

MAC Model Algorithmic Control

Matlab? Software Matemático da empresa Mathworks Inc

Mdl Modelo

MMPC Multi-Model Predictive Control

MPC Controlador preditivo multivariável

MPHC Model Predictive Heuristic Control

MV1 Variável manipulada 1

MV2 Variável manipulada 2

NC Número de componentes do sistema



x

OLE Object Link Embeding

OP Saída do controlador

PCOND Pressão no condensador

PI™ Software de supervisão do processo Plant Information

PID Controlador proporcional integral e derivativo

PV Variável de processo

P#24 Pressão no estágio 24

Qcond Calor absorvido na condensação

QDMC Quadratic Dynamic Matrix Control

QP programação quadrática

QREB Carga térmica do refervedor

REFAP Refinaria Alberto Pasqualini

REPLAN Refinaria de Paulínia

REVAP Refinaria do Vale do Paraíba

RPBC Refinaria Presidente Bernardes de Cubatão

SDCD Sistema Digital de Controle Distribuído

SICON Sistema de Controle da Petrobras

SISO Sistema monovariável

SP Setpoint

SQP Programação quadrática sucessiva

TC Controlador de temperatura

TGOP Temperatura do gasóleo pesado

TTOPO Temperatura de topo da coluna

UA Coeficiente global de troca térmica

UFCC Unidade de Craqueamento Catalítico Fluido

UGAV Unidade de Gasolina de Aviação

USP Universidade de São Paulo

VBUTANO Vazão de butano

VCARGA Vazão de carga

VGOP Vazão de gasóleo pesado

VPROPANO Vazão de propano

VPP Vazão de propano



xi

VFR Vazão de Refluxo de Topo



xii

LISTA DE SÍMBOLOS

a Termos do denominador do modelo do processo

b Termos do numerador do modelo do processo

c Parâmetro do modelo dependente do tempo

c0 Parâmetro do modelo independente do tempo

C Matriz dos parâmetros do modelo dep. do tempo

C Matriz diag. dos parâm. do modelo dep. do tempo

C0 Matriz dos parâmetros do modelo indep. do tempo

d Coef. de atualização dos parâmetros do modelo

D Matriz de coef. de atualização dos parâmetros

det Determinante de uma matriz

E(t) Erro no instante t

e Erro na controlada antes do controle

e Vetor de erros nas controladas após o controle

ek+? Erros das controladas no estado estacionário 

F Vazão do fluido

FD Modelo da planta industrial

f(t) Função exponencial do modelo do processo

g(s) Função de transferência contínua do processo

Iny Matriz diagonal de dimensão ny

Jk Função objetivo do controlador preditivo

K Matriz de correção da predição da saída

Kc Ganho do controlador PID

KMPC Matriz de ganhos do controlador preditivo

Kp Ganho do processo

L Número de modelos alternativos do processo

M Matriz de transição de estado

m Horizonte de controle

n Instante de amostragem futuro n = 1, 2, …

na Número de pólos do processo



xiii

np Horizonte de predição

nu Número de variáveis manipuladas

ny número de variáveis controladas

N Matriz de correção do erro

nr Horizonte de otimização

Nr Matriz de predição para controle

N
~

Matriz de propagação dos setpoints das saídas

Np Matriz de repetição das ações de controle

n0 Número de translações contínuas das predições

nh Número de instantes esparsos das predições

OP saída do controlador em percentagem

OPSS Saída do controlador no estado estacionário inicial

p0 Parâmetro de predição da saída indep. do tempo

p Parâmetro de predição da saída dep. do tempo

pi Vetor de parâmetros indep. de predição das saídas

pt Vetor de parâmetros dep. de predição das saídas
c
ip Parâmetro indep. corrigido de predição da saída

c
gjip ,, Parâmetro dep. corrigido de predição da saída

r Raiz do modelo do sistema

s Resposta ao degrau unitário  

S Matriz de resposta ao degrau unitário

Sm Matriz dinâmica do sistema

T Período de amostragem

t Instante de tempo

u Valor da entrada  (variável manipulada)

w Desvio da predição em relação à planta

Wk Vetor de perturbação no estado do sistema

yd Resposta ao degrau unitário

y Valor da saída (variável controlada)

y Vetor da predição da saída

y? Valor de medida da saída



xiv

cy Predição corrigida da variável controlada

y% Vetor de predição da saída para controle

y Vetor de predição da saída após ação de controle

ysp Setpoint da controlada

ysp Vetor de setpoints das controladas

Símbolos Gregos

? Incremento de uma variável

?D  Tempo derivativo do controlador PID

?I Tempo integral do controlador PID

? Tempo morto

? Peso que pune o desvio

? Fator de supressão da manipulada

? Fator de importância da controlada

? Fatores de supressão das manipuladas

? Matriz dos fatores de importância das controladas

? Função objetivo do QDMC

? Matriz de predição das saídas

? Resíduo da função objetivo do problema de NLP



xv

RESUMO

As colunas depropanizadoras existentes nas refinarias de petróleo têm como

função a separação entre as correntes de propano e butano. O objetivo de controle nestas

colunas é a especificação de um teor máximo de iso-butano e mais pesados (C4
+) na

corrente de propano e do teor máximo de propano e mais leves (C3
-) na corrente de

butano. Controladores multivariáveis tradicionais, que normalmente são implementados

nas colunas depropanizadoras, apresentam grande dificuldade para manter os produtos

dentro de suas especificações, isto se deve ao fato de que  este processo apresenta um

comportamento bastante não-linear ao longo de toda sua região de operação.

Neste trabalho temos como objetivo estudar as dificuldades encontradas no

projeto de controle para esse tipo de sistema e implantar na planta industrial um

controlador multivariável utilizando múltiplos modelos para controle da coluna. Para

realizarmos este estudo utilizamos o simulador de processos HYSYS? para

verificarmos o comportamento estático e dinâmico do processo. Os modelos utilizados

para representar o processo são aqueles obtidos durante o estudo do comportamento

dinâmico.  Para implantação do controlador na unidade industrial é utilizado o SICON

(Sistema de Controle da Petrobras) sendo algumas de suas rotinas modificadas para

permitir a inclusão dos múltiplos modelos. Durante o estudo são comparadas as

performances dos controladores QDMC e MMPC (Multi-Model Predictive Control)

resolvido através de um algoritmo para NLP (Non Linear Programming).

O controlador multimodelos (MMPC) é apresentado na forma de variáveis de

estado podendo controlar sistemas de grande porte, inclusive sistemas com dinâmicas

lentas e rápidas. Esta formulação permite prever as variáveis controladas em instantes de

tempo esparsos e diferentes para cada controlada. O MMPC é capaz de tratar problemas

de controle não-linear usando modelos lineares, introduzindo o conceito de robustez

com a utilização do conjunto de modelos. O MMPC exige um menor esforço de sintonia

que o QDMC sendo adequado para uma região mais ampla de operação.



xvi

ABSTRACT

Depropanizer columns are used in oil refineries for the separation of the propane

stream from the butane stream. The control objective of these columns is the

specification of a maximum content  of  iso-butane and heavier components (C4+) in the

propane product and the maximum content of propane and lighter components (C3-) in

the butane product. Multivariable controllers usually implemented in depropanizer

columns frequently present great difficulty to maintain the products inside their

specification ranges. This deficiency is due to the fact that the process presents a quite

non-linear behavior along its operating window.

The objective of the present work is to study the difficulties found in the design

of the control system for the aforesaid process, and to implement in an industrial plant a

multivariable controller using multiple models for the control of the separation column.

To accomplish this study we used the HYSYS? process simulator  to verify the static

and dynamic behavior of the process. The models used to represent the real process in

the controller are those obtained during the study of the dynamic behavior. The

controller implementation in the industrial unit was done with SICON (Control System

of Petrobras), which had some of its routines modified to allow the inclusion of multiple

models. Along the work, performances of  QDMC and MMPC(Multi-Model Predictive

Control) controllers were compared. MMPC was solved through an algorithm for NLP

(Non Linear Programming).

The Multi-Model  (MMPC) controller was implemented using a state space

formulation which allows for the implementation of very large systems and besides,

systems with simultaneous slow and fast dynamics. This formulation allows to foresee

the controlled  variables at sparse sample instants, that can be distinct for each

controlled variable. MMPC is able to handle non-linear control problems using linear

models by introducing the robustness concept with the use of a set of models. MMPC

demands a smaller tuning effort than QDMC, and can be adapted to a wide range of

operating conditions.



1

1

INTRODUÇÃO

1.1 - Apresentação da problemática de controle de colunas de pureza elevada

As colunas depropanizadoras presentes nas refinarias de petróleo da Petrobras

estão localizadas nas unidades de Craqueamento Catalítico Fluido (UFCC’s). Estas

colunas são utilizadas para permitir a separação das correntes de propano e butano. No

caso da RPBC (Refinaria Presidente Bernardes Cubatão) o propano é enviado para o

pool de GLP (gás liquefeito de petróleo) e o butano é enviado para a unidade de gasolina

de aviação (UGAV).

A estratégia de controle regulatório existente na coluna depropanizadora é feita

no SDCD (Sistema Digital de Controle Distribuído) e consiste nos seguintes

controladores principais: controlador de vazão de carga (sendo este cascateado pelo

controlador de nível do vaso de carga), controlador de pressão da coluna (controla a

pressão no estágio 24, manipulando  a vazão de retirada de produto de topo (propano)),

controlador de nível de fundo (manipula a vazão de retirada de produto de fundo

(butano)), controlador de temperatura de fundo (manipula a entrada de fluído de

aquecimento (gasóleo pesado) para o refervedor) e por último o controlador de vazão de

refluxo (tem a possibilidade de ser cascateado pela temperatura de topo). A atuação do

operador para controle da qualidade dos produtos é feita preferencialmente manipulando

o set-point do controlador de vazão de refluxo e o set-point do controlador de

temperatura de fundo da coluna.

O controlador preditivo proposto neste trabalho tem a seguinte estrutura: duas

variáveis controladas que são o teor de C4+ (componentes mais pesados que o propano)

no propano (ou a temperatura de topo) e o teor de C3- (componentes mais leves que o

propano) no butano, duas variáveis manipuladas que são o set-point da vazão de refluxo

e o set-point da vazão de fluido de aquecimento do refervedor e duas variáveis

perturbadoras que são a vazão de carga e a temperatura do fluido de aquecimento. A

prática mostra que a utilização do teor de C4+ como variável controlada não é adequada,

devido ao modelo (inferência) atualmente disponível para cálculo da mesma não



Capítulo 1 - Introdução 2

apresentar resultados satisfatórios. Assim, neste trabalho, optou-se por utilizar a

temperatura de topo da coluna como feito normalmente na planta industrial. No entanto,

os modelos de processo levantados para o controlador contemplam as duas variáveis.

 Tradicionalmente o projeto do controlador preditivo, consiste em definir

inicialmente o problema de controle e as funções do controlador, além da escolha das

variáveis manipuladas, controladas e perturbações. Uma vez definidas as funções de

controle, identifica-se o processo através de testes em degrau nas variáveis manipuladas

e perturbações medidas, em um determinado ponto de operação do processo. Em

seguida, constrói-se o controlador configurando e customizando a sua programação.

Finalmente, sintoniza-se o controlador fazendo uso de simulação para definir os

melhores valores dos parâmetros de sintonia. Uma alternativa para se fazer a sintonia de

forma sistemática para sistemas quadrados pode ser encontrada em Trierweiler et al.

(2001). A etapa final consiste na interligação do controlador preditivo aos controladores

PID do processo, através de um sistema digital, normalmente SDCD (Sistema Digital de

Controle Distribuído).

Com o objetivo de estudar melhor os problemas de controle desta natureza,

podemos utilizar simuladores estáticos e dinâmicos rigorosos. Com esta ferramenta,

podemos efetuar um estudo detalhado do problema de controle, determinando na região

de operação das variáveis manipuladas, os ganhos do processo e suas dinâmicas nos

diversos pontos de operação. Com este estudo, podemos determinar os limites do

sistema quanto à sua capacidade de controle.

1.2 - Revisão bibliográfica

Os controladores preditivos (MPC´s) são uma classe de algoritmos de controle

que calculam uma série de ações das variáveis manipuladas com a finalidade de otimizar

o comportamento futuro da saída da planta. As primeiras aplicações industriais foram

implementadas nas unidades de processo das refinarias de petróleo.

Os primeiros algoritmos MPCs  aplicados industrialmente surgiram nos meados

da década de 70, sendo a primeira aplicação industrial apresentada por Richalet em 1976

e reportada em 1978 (Richalet et al., 1978). O controlador foi implementado em uma

coluna fracionadora de FCC e também em um sistema de geração de vapor. Este



Capítulo 1 - Introdução 3

algoritmo ficou conhecido como MPHC (Model Predictive Heuristic Control) e também

como MAC (Model Algoritmic Control). Paralelamente Cutler e Ramaker

desenvolveram o controlador DMC (Dynamic Matrix Control) sem restrições,

apresentado em 1979 (Cutler e Ramaker, 1979). Em 1980, Prett e Gillette descreveram

uma aplicação do algoritmo DMC sem restrições num conjunto reator/regenerador de

FCC (Craqueamento Catalítico). Esta foi a primeira aplicação do controlador preditivo

em dois níveis. O primeiro nível consta de um algoritmo de programação linear (LP),

que resolve um problema de otimização no estado estacionário sujeito às restrições do

processo. O segundo nível recebe os valores ótimos das entradas e os setpoints das

saídas e resolve o problema através do controlador DMC sem restrições.

Os controladores MAC e DMC  apresentavam dificuldade de incorporar as

restrições nos problemas de controle. Este fato levou ao surgimento de uma nova classe

de controladores preditivos. O problema foi resolvido com a utilização dos algoritmos

QDMC (Quadratic Dynamic Matrix Control) e LDMC (Linear Dynamic Matrix

Control), nos quais as restrições aparecem explicitamente dentro do problema de

otimização. Em 1985 Morshedi, Cutler e Skrovanek descreveram o algoritmo LDMC e

em 1986, Garcia e Morshedi descreveram o algoritmo QDMC e apresentaram os

resultados de uma aplicação em um forno de pirólise. Na abordagem do LDMC e

QDMC, foi introduzido o controle por faixa, onde se controla o processo através de uma

janela de operação.

Neste estágio de desenvolvimento dos controladores preditivos, a Petrobras

decidiu implantar seus próprios controladores, sendo os mesmos desenvolvidos em

conjunto com o departamento de engenharia química da Escola Politécnica da USP.

Assim, surgiu a primeira aplicação em um forno de resíduo atmosférico da unidade de

destilação da Refinaria Presidente Bernardes de Cubatão - RPBC (Zanin e Odloak,

1992), onde se utilizou o controlador LDMC em uma camada. Em seguida surgiram

outras aplicações de mesma natureza, como os controles da coluna debutanizadora da

REPLAN, da coluna atmosférica da REPLAN (Magalhães e Odloak, 1995) e da coluna

de destilação à vácuo da REPLAN (Almeida et al., 1996). Além destas aplicações,

surgiram outras nas unidades de craqueamento catalítico fluido, onde se utilizou o

controlador DMC em duas camadas. Dentre eles, temos o controle do conversor do FCC

da Refinaria do Vale do Paraíba - REVAP (Moro e Odloak, 1994, Moro e Odloak,



Capítulo 1 - Introdução 4

1995) e do conversor do FCC da REPLAN (Spandri et al., 1995). A partir destas

aplicações, estes controladores foram amplamente difundidos nas unidades da Petrobras,

incluindo unidades de gasolina de aviação, coqueamento retardado, recuperação de

aromáticos e outras.

Os controladores DMC, LDMC e QDMC  já estavam consolidados em meados

da década de 80. A partir daí despertou-se o interesse dos pesquisadores pela análise da

robustez dos mesmos, isto é, a utilização da estrutura de controle junto à planta, onde

existem incertezas nas medidas e nos modelos utilizados pelo controlador. Uma série de

trabalhos exploraram este assunto, dentre eles podemos destacar Garcia e Morari (1982,

1985); Rouhani e Mehra (1982); Morari e Doyle (1986) e Morari e Zafirou (1989).

Neste ponto surgiram algumas propostas de análise de estabilidade dos MPC´s, entre

elas uma abordagem paramétrica dos MPCs, denominado GPC (Generalized Predictive

Control) proposto por Clarke et al. em 1987. Esta abordagem estimulou uma

uniformização dos MPCs sob a forma de variáveis de estado. Li et al. (1989) apresentam

uma descrição bem detalhada do MPC em variáveis de estado, explicando as suas

propriedades e apresentando melhorias em relação ao DMC, como a utilização do filtro

de Kalman para modelar as perturbações não medidas.

Morari e Lee (1991) propuseram soluções de controle para sistemas de grande

porte, onde se utilizou a representação do sistema em espaço de estado, e o modelo da

perturbação através do filtro de Kalman e incluiu-se a análise de robustez no projeto do

controlador.

Odloak (1995), apresentou o controlador DMC em variáveis de estado, com

possibilidade de analisar o sistema de controle em malha fechada, isto é, a resposta do

processo às ações de controle é equacionada juntamente com o controlador. Esta

abordagem permite a verificação da estabilidade da malha fechada sem realizar as

simulações do sistema. Isto possibilita o estudo da estabilidade do controlador diante

dos parâmetros de sintonia e de possíveis configurações do controle.

A utilização do controlador MPC tradicional em variáveis de estado tem a

dimensão do estado correspondente ao número de coeficientes da resposta ao degrau do

modelo do DMC. Assim, as principais limitações do DMC (Lundström et al., 1995),

como o esforço computacional para controladores de grandes dimensões, e processos

com dinâmicas muito lentas, continuaram sendo restrições ao uso desta abordagem.



Capítulo 1 - Introdução 5

Com objetivo de resolver este tipo de problema, foram apresentadas algumas propostas

de truncamento do modelo de resposta ao degrau, entre elas (Hovd et al., 1993), que não

teve porém muita aceitação. Outra abordagem é a compactação do controlador através

da redução da ordem do modelo. Lee et al. (1994) propuseram uma redução do estado

através da construção de um filtro ótimo (filtro de Kalman), cujo ganho é resolvido

através da equação de Riccati. Neste último trabalho foi realizada uma conexão desta

abordagem com o controlador DMC, porém os autores não conseguiram manter

exatamente a forma original do DMC e QDMC.

Com a necessidade de se aplicar os MPC´s para sistemas de grande porte (um

único controlador para toda uma unidade de processo) ou sistemas com dinâmicas

lentas, e diante das dificuldades de apresentação do controlador DMC em sua

formulação original em espaço de estado e de forma reduzida, Odloak (1996) apresentou

uma forma eficiente do controlador em espaço de estado de ordem reduzida. Nesta

formulação, o modelo do processo é apresentado de forma analítica, através de modelos

paramétricos contínuos ou discretos. Isto possibilitou a manutenção da forma original do

DMC e a utilização de parâmetros contínuos, tais como, tempos mortos fracionários, a

possibilidade da utilização de instantes de predição esparsos, podendo até utilizar

períodos de amostragem diferentes para cada variável controlada, o que é interessante

quando num mesmo controlador temos variáveis que apresentam dinâmicas lentas e

outras rápidas. Esta formulação também permitiu a análise de estabilidade dos MPCs

sem muito esforço computacional (Gouvêa e Odloak, 1997).

Diante da necessidade de resolver os problemas de controle não-lineares, como o

controle de colunas de destilação de alta pureza que é um caso típico em unidades

petroquímicas, algumas alternativas de controladores não-lineares foram propostas,

onde podemos utilizar modelos fundamentais (baseados em equações diferenciais de

conservação de massa e energia e equações constitutivas), modelos empíricos, obtidos

através de identificações não-lineares e modelos híbridos, podendo-se até utilizar

modelos por redes neurais. Além disso, podemos resolver o problema de controle

através de otimização não-linear ou até mesmo a linearização do modelo no ponto de

operação e usar um controlador linear. Estas abordagens são descritas por Henson

(1998) e Morari e Lee (1999).



Capítulo 1 - Introdução 6

A utilização de controladores multi-modelos é uma alternativa  interessante para

resolvermos os problemas onde o processo é variante no tempo e no estado. Nesta

abordagem resolvemos o problema de controle que satisfaz a todos os possíveis modelos

lineares do processo. Este problema de controle pode ser resolvido através do algoritmo

LMI (Linear Matrix Inequality). Esta técnica foi motivada por recentes

desenvolvimentos na teoria e aplicações em problemas de controle, e na utilização de

otimização através de LMI (Boyd te al., 1994). Kothare et al. (1996) apresentaram uma

solução de controle MPC usando LMIs, porém não apresentando os modelos

alternativos diretamente no problema de controle.

Odloak tem estudado a utilização de MMPCs (Multi-Model Predictive Control),

sendo que o conjunto de modelos e a equação de Riccati aparecem inclusas no problema

de controle. Neste caso o controlador é projetado com garantia de estabilidade

(Rodrigues e Odloak, 1999). Almeida, Rodrigues e Odloak (2000) apresentam uma

aplicação de multiplos-modelos utilizando-se LMI’s  para controle de uma coluna

debutanizadora.

1.3 - Objetivo do trabalho

Este trabalho tem como objetivos estudar o sistema de controle de uma coluna

depropanizadora e implantar em uma unidade industrial um controlador preditivo

multivariável com múltiplos modelos (MMPC) sendo este resolvido através de um

algoritmo de programação não linear (NLP).

Neste trabalho procuramos fazer um estudo mais detalhado do sistema.

Primeiramente, procuramos estudar o comportamento estático do processo utilizando

modelos rigorosos, através de simulador. Nesta etapa, define-se a região de operação do

sistema e o comportamento das variáveis controladas ao longo desta região. Depois,

determinam-se os ganhos do processo ao longo da região de operação, sendo que nesta

etapa avaliamos as não-linearidades do sistema. Como resultado desta etapa, avaliam-se

as propriedades da matriz de ganhos do processo na região de operação obtida. As

propriedades analisadas estão ligadas às características de interações entre as variáveis,

condicionamento e determinantes das matrizes de ganhos do processo. A etapa seguinte

corresponde à construção do modelo dinâmico no simulador HYSYS? e à identificação



Capítulo 1 - Introdução 7

do processo em vários pontos ao longo da região de operação. A identificação é feita

utilizando-se procedimento proposto por Odloak (1996) onde os modelos são obtidos na

forma analítica. Após a  identificação dos modelos construímos o controlador no

Matlab? e fazemos a simulação considerando um dos modelos como sendo o modelo

da planta. Com o controlador construído, fazemos a conversão de todas as rotinas para a

linguagem FORTRAN, pois o controlador industrial será montado utilizando-se esta

linguagem. Com o controlador na linguaguem FORTRAN poderemos fazer a integração

do mesmo com o SICON (Sistema Integrado de Controle) que é uma estrutura para

montagem dos controladores preditivos desenvolvida pela Petrobras (veja item 9.2.1). A

seguir o controlador é colocado em operação no modo de simulação para se fazerem os

ajuste preliminares na sintonia do mesmo. Após esta etapa de simulação o controlador é

colocado em operação com atuação ativa sobre as variáveis da unidade industrial. A

seguir, são realizados testes para verificar a performance de operação do controlador.



8

2

PROBLEMA DE CONTROLE DA COLUNA

DEPROPANIZADORA

As colunas depropanizadoras são utilizadas em refinarias para se fazer a

separação das correntes propano e butanos. Na RPBC a corrente propano é enviada para

o pool de GLP e a corrente de butanos enviada para a unidade de gasolina de aviação

(UGAV).

O esquema de produção é ilustrado na figura 2.1.

Figura 2.1 – Esquema de produção de GLP em refinarias de petróleo

2.1 - Especificações dos produtos

As correntes de propano e butano fracionadas na coluna depropanizadora

possuem especificações que devem ser obedecidas rigorosamente.

2.1.1 - Especificações do propano:

   Uma das especificações mais importantes do propano é o teor de C4+

(componentes mais pesados que o propano) e deverá ter um valor de 3% no máximo. O

objetivo é a minimização das perdas de iso-butano para o pool de GLP, cuja perda é

compensada por importação, com o correspondente custo adicional.



Capítulo 2 - Problema de controle da torre depropanizadora 9

2.1.2 - Especificações do butano

   No caso da corrente de butano, o teor de C3-  (componentes mais leves que o

butano) é uma de suas principais especificações e deverá ter um valor de 3% no

máximo, sendo o objetivo evitar  perda de controle operacional na unidade de gasolina

de aviação (UGAV) devido à presença de componentes leves no processo e por questões

de segurança no armazenamento da corrente de butanos.

2.2 - Descrição do processo

A coluna depropanizadora estudada pertence à unidade de craqueamento

catalítico da Refinaria Presidente Bernardes (RPBC), sendo sua carga (GLP)

proveniente da seção de tratamento. O tratamento do GLP é feito em duas etapas, ou

seja, dois processos diferentes que são: tratamento DEA, no qual uma solução de DEA

(Dietanolamina) é utilizada para remoção de contaminantes tais como CO2, CO, H2S;

após este processo temos o tratamento Merox, que consiste na remoção de compostos de

enxofre (mercaptans) que são transformados em dissulfetos pela ação de um catalisador

em presença de soda caústica. O tratamento tem como finalidade eliminar a

corrosividade do GLP.

O GLP após a seção de tratamentos é enviado ao vaso V-01, do qual é bombeado

para a coluna depropanizadora  T-01, sendo sua vazão controlada através do FC-01, o

qual é cascateado pelo controle de nível do V-01. Antes de entrar na coluna, o GLP é

pré-aquecido no trocador de calor E-1 trocando calor com a nafta proveniente do fundo

da debutanizadora. A temperatura do GLP é mantida constante através da manipulação

da vazão de nafta através do trocador E-01. O GLP entra na coluna no estágio 16 (a

coluna é composta de 31 pratos valvulados).

Esta carga é destilada sendo os vapores de topo totalmente condensados e

subresfriados no E-02 e enviados para o vaso de topo (V-02). Neste vaso, a corrente

líquida é dividida em duas sendo uma o refluxo de topo e a outra retirada como

destilado para pool de GLP.



Capítulo 2 - Problema de controle da torre depropanizadora 10

Parte  do refluxo interno que atinge o fundo da coluna é vaporizado no

refervedor (E-03) e outra parte é retirado como produto de fundo sendo resfriado no E-

04 e depois enviado para unidade de gasolina de aviação.

Figura 2.2 – Fluxograma de processo da coluna depropanizadora

2.3 - Variáveis operacionais

 A coluna depropanizadora separa os componentes voláteis no destilado

(propano/propeno) e os componentes pesados no produto de fundo (butanos).

Para garantirmos a especificação dos produtos as seguintes variáveis devem ser

observadas:

1-Vazão de carga da coluna;

2-Temperatura da carga da coluna;

3-Composição da carga;

4-Pressão da coluna;

5-Vazão de refluxo;

6- Vazão de fluido de aquecimento para refervedor;

7-Temperatura de topo da coluna.



Capítulo 2 - Problema de controle da torre depropanizadora 11

2.3.1 - Vazão de carga

A vazão de carga não pode ser manipulada diretamente pelo operador, pois esta

vazão é resultado do controle de nível do vaso de carga.

Um aumento da vazão de carga provoca o aumento da vazão de fluido de

aquecimento do refervedor e um conseqüente aumento da vazão de refluxo para manter

a qualidade dos produtos.

2.3.2 - Temperatura da carga

Conforme indicado na figura 2.2, existe um controlador de temperatura da carga

da coluna no nível regulatório. O set-point desse controlador pode ser manipulado

diretamente pelo operador. No entanto é mantido sempre em um valor fixo. Assim, não

é uma variável utilizada para controle da coluna.

2.3.3 - Composição da carga

A composição da carga não pode ser manipulada diretamente pelo operador, pois

a distribuição de componentes na carga é função da natureza da carga introduzida na

seção de conversão da unidade e das variáveis operacionais desta seção.

Um aumento da fração de leves na carga, provoca um aumento no rendimento da

corrente de propano e conseqüentemente  aumento da vazão de refluxo para manter a

qualidade dos produtos.

2.3.4 - Pressão da coluna

A pressão da coluna também é controlada no nível regulatório e o

comportamento dessa malha é muito bom o que leva a hipótese de que essa variável

possa ser considerada como constante, só devendo ser alterada quando o resultado

desejado não puder ser obtido pela manipulação de outras variáveis.



Capítulo 2 - Problema de controle da torre depropanizadora 12

Um aumento na pressão da coluna, provoca um aumento de dificuldade na

separação entre os leves e pesados. Para que esta separação ocorra de forma adequada,

deve-se aumentar a vazão de fluido de aquecimento do refervedor e a vazão de refluxo

de topo.

2.3.5 - Vazão de refluxo

A vazão de refluxo é uma das variáveis mais importantes a serem manipuladas

para garantir a especificação dos produtos. Para cada nível de fracionamento desejado

há uma razão de refluxo adequada (relação entre a vazão de refluxo e a vazão de

destilado).

Um aumento da vazão de refluxo provoca uma redução da quantidade de frações

pesadas no destilado. Portanto para manter a qualidade do produto de fundo, é

necessário  aumentar a vazão de fluido de aquecimento do refervedor.

O limite inferior da vazão de refluxo está ligado à qualidade da separação  e o

limite  superior está ligado às capacidades do refervedor, do condensador, da bomba de

refluxo e à hidráulica da coluna.

2.3.6 – Vazão de Fluido de Aquecimento para refervedor

A vazão e a qualidade da corrente de propano dependem da quantidade de

vapores condensados no sistema de topo, que por sua vez, depende da vazão de fluido

de aquecimento para o refervedor.

Um aumento da vazão de fluido de aquecimento do refervedor ocorrerá um

aumento da vaporização e conseqüentemente a necessidade de aumento da vazão de

refluxo de topo.

2.3.7 - Temperatura de topo

Uma variável alternativa à vazão de refluxo é a temperatura de topo, que quando

utilizada manipulará a vazão de refluxo.



Capítulo 2 - Problema de controle da torre depropanizadora 13

Neste caso, um aumento nesta temperatura provoca um aumento da quantidade

de frações pesadas no destilado. Portanto para manter a qualidade do produto é

necessário diminuir a vazão de fluido de aquecimento do refervedor.

2.4 - Fatores de desempenho do sistema

Para otimização da coluna depropanizadora devemos manipular a vazão de

refluxo de topo e a vazão de fluido de aquecimento para o refervedor, observando

sempre as restrições do processo.

Em termos econômicos as variáveis manipuladas devem ser utilizadas no sentido

de se introduzir o mínimo de energia no refervedor e operar com o mínimo de refluxo

interno da coluna.

Os limites de especificação dos produtos são as principais restrições do processo

que deverão ser impostas ao sistema de controle.

Assim, o problema de otimização tem a seguinte formulação:

Minimizar:                  - Vazão de refluxo de topo e

- Vazão de fluido de aquecimento do refervedor

Sujeito a restrições de:

- % máxima de C4+ no propano

- % máxima de C3- no butano

2.5 - Limitações do processo

A coluna depropanizadora não apresenta limitações físicas para especificação

dos produtos, conseguindo a mesma fracionar toda a produção de GLP da UFCC e

também correntes de GLP de outras unidades.

2.6 - Estratégias de controle da coluna depropanizadora

Uma coluna de fracionamento com separação de produto de topo e fundo com

condensador total e tambor de topo inundado, tem 4 graus de liberdades e portanto 4



Capítulo 2 - Problema de controle da torre depropanizadora 14

variáveis devem ser especificadas. Note que a vazão de carga é manipulada em função

do nível do vaso carga (V-01) e portanto não fornece nenhum grau de liberdade

adicional

A forma de utilizar estes graus de liberdade é colocando controladores para

especificar estes itens. Há uma série de alternativas de arranjos para o sistema de

controle usando os graus de liberdade do sistema. A escolha do melhor arranjo leva em

consideração a sensibilidade do processo, a linearidade do comportamento na região de

operação e o seu comportamento dinâmico.

Os graus de liberdade são utilizados pelos controladores do nível regulatório e

cujos “set-points” dão origem às variáveis manipuladas.

As malhas do nível regulatório normalmente especificadas nesta coluna são:

1. Pressão da coluna (estágio 24).

2. Vazão de refluxo de topo da coluna.

3. Temperatura de retorno do refervedor (cascateando a vazão do fluido

de aquecimento para o refervedor).

4. Nível do fundo da coluna.

As perturbações mais importantes deste sistema são:

1. Composição da carga.

2. Vazão de carga da coluna.

3. Temperatura do fluido de aquecimento.

Normalmente, a pressão da coluna é mantida no valor de projeto e o nível de

fundo é controlado no nível regulatório. Assim, restam dois graus de liberdade para

serem utilizados no controle da coluna. Quando em operação manual, o operador fixa a

vazão de refluxo e a temperatura de saída do refervedor. Uma outra alternativa seria

especificar uma vazão do fluido de aquecimento para o refervedor em vez da

temperatura de saída do refervedor.

2.6.1 - Estratégia temperatura de retorno do refervedor  - vazão de refluxo de topo



Capítulo 2 - Problema de controle da torre depropanizadora 15

Nesta configuração a temperatura de retorno do refervedor para coluna é

utilizada para especificar principalmente o teor de C3-  no butano, e a vazão de refluxo

de topo para especificar preferencialmente o teor de C4+  no propano.

A especificação mais rigorosa é o teor de C3- no butano, pois existe a

preocupação com o armazenamento desta corrente e também com a possível perda de

controle operacional na unidade de gasolina de aviação caso tenhamos um teor de C3-

acima dos limites. O controlador de temperatura deveria eliminar as possíveis

perturbações do processo para manter a qualidade do butano.

Assim, nesta configuração colocamos os seguintes controladores para utilizar os

graus de liberdade como mostra a figura 2.2:

1. Controlador de pressão no estágio 24 manipulando a válvula de

retirada de destilado (propano).

2. Controlador de nível de fundo da coluna manipulando a válvula de

retirada de butano.

3. Controlador de temperatura de retorno do refervedor manipulando a

vazão de fluido de aquecimento.

4. Controlador de vazão de refluxo de topo manipulando a válvula de

refluxo de topo.

Esta é a configuração utilizada no controle regulatório normal (feito pelo SDCD)

e não será objeto de estudo deste trabalho.

2.6.2 – Vazão de fluido de aquecimento para refervedor  - vazão de refluxo

Nesta configuração colocamos os seguintes controladores como mostra a figura

2.2:

1. Controlador de pressão no estágio 24 manipulando a válvula de

retirada de destilado (propano). Tendo em vista o projeto da unidade

que considera o tambor de topo inundado (sem interface líquido-

vapor), essa é a única configuração possível.



Capítulo 2 - Problema de controle da torre depropanizadora 16

2. Controlador de nível de fundo da coluna manipulando a válvula de

retirada de butano.

3. Controlador de teor de C3-  no butano (AI2), podendo manipular a

vazão de refluxo ou a vazão de fluido de aquecimento.

4. Controlador do teor de C4+  no propano (AI1) ou da temperatura de

topo, podendo manipular a vazão de refluxo ou vazão de fluido de

aquecimento.

Visto que a sintonia do controlador da temperatura de retorno do refervedor não

é trivial pois depende das condições operacionais, que podem tornar a malha muito

lenta, para o estudo desta coluna, optou-se por adotar, no nível regulatório, uma

estratégia onde é manipulada a vazão de fluido de aquecimento para o refervedor.



17

3

DESCRIÇÃO SUMÁRIA DO HYSYS

A crescente demanda por produtos com qualidades cada vez mais rigorosas, tem

levado as unidades industriais a operarem seus processos cada vez mais próximos de

suas restrições. Isto faz com que a engenharia de controle necessite cada vez mais de

modelos em estado-estacionário e dinâmico mais realistas para analisar melhor a

estabilidade, robustez e performance dos sistemas de controle dos processos químicos.

Diante deste quadro a utilização de um simulador de processo se torna

fundamental, sendo o HYSYS™  (Hyprotech Ltd) um simulador de processos que

combina a operação no estado-estacionário com o dinâmico no mesmo ambiente. Ele

possibilita passar facilmente do regime estacionário para o dinâmico e no sentido

contrário.

O simulador foi desenvolvido em ambiente Windows e orientado à objetos e

eventos, com compatibilidade OLE (Object Link Embeding) onde permite-se que o

simulador execute funções de outros programas. O programa também disponibiliza os

serviços DDE (Dynamic Data Exchange) onde se pode transferir dinamicamente dados

para outros programas, como Matlab™ , e no sentido contrário.

Isto permite ao engenheiro criar aplicações customizadas que acessam partes do

HYSYS™  ou construir interfaces customizadas.

Além destas características, possibilita a utilização de pacotes customizados, tais

como:

• Controladores

• Cinéticas de reações

• Modelos de colunas extratoras, filtros e etc.

• Pacotes de propriedades

• Outros

Estas customizações podem ser criadas a partir de programas escritos em

linguagem FORTRAN ou C/C++, e utilizando Visual Basic como inferface.

As operações unitárias são modulares e utilizam modelos rigorosos, onde são

combinadas com algoritmo de solução não-sequencial. Neste algoritmo as informações



Capítulo 4 – Simulação estática da depropanizadora 18

são processadas e os resultados de alguns cálculos são automaticamente propagados no

fluxograma para frente e para trás.

A estrutura modular das operações unitárias significa que podem ser calculadas

em ambas direções, utilizando informações de uma corrente de saída para calcular as

condições de entrada.

O simulador dinâmico permite verificar o comportamento do processo fora do

estado-estacionário, analisando os casos servo e regulatório. Desta forma, o modelo

dinâmico pode ser utilizado para fazer estudos de controle de processos.

Assim um controlador preditivo pode ser utilizado junto ao modelo do processo

disponibilizado pelo simulador.

O simulador de processos é um ambiente de engenharia que se destina às

seguintes aplicações:

• Projeto conceitual de processos químicos

• Projeto básico de processos

• Projeto detalhado de plantas

• Projeto de sistemas de controle

• Otimização de processos

• Treinamento de operadores

• Análise de processos

• Monitoração de performance do processo

Em nosso trabalho utilizamos o HYSYS PROCESS 1.2, versão 1.2.4 de outubro

de 1997.



19

4

SIMULAÇÃO ESTÁTICA DA DEPROPANIZADORA

Neste capítulo apresentamos os detalhes da montagem do modelo estático do

processo a ser utilizado no estudo de controle. Apresentamos as bases de simulação, a

caracterização da carga, a montagem das operações unitárias, convergência da

simulação, validação do modelo estático e as definições dos estudos da simulação

estática.

Para a montagem do modelo dinâmico do processo no  HYSYS?, inicialmente é

necessário construir o modelo em estado estacionário. Tendo o modelo em estado

estacionário, é possível estudarmos o comportamento do processo. Desta forma é

possível determinar a região de operação, isto é, as possíveis combinações das variáveis

independentes que correspondem às situações reais de operação do sistema. Podemos

também avaliar as não-linearidades dos ganhos do processo, que são importantes para

uma melhor avaliação do comportamento do sistema de controle.

4.1 –  Etapas da construção do modelo estático

Os seguintes aspectos devem ser verificados quando da elaboração do modelo

estacionário a ser analisado:

ü Definição das bases de simulação;

ü Caracterização da carga do sistema;

ü Definição das operações unitárias envolvidas no processo;

ü Especificação dos graus de liberdade do sistema;

ü Validação do modelo estático;

ü Definição dos estudos da simulação estática.

Nos próximos itens apresentamos a seqüência para construção do modelo

estático de acordo com os itens acima.

4.1.1 – Definição das premissas da simulação



Capítulo 4 – Simulação estática da depropanizadora 20

Nos simuladores, inicialmente definimos as bases de simulação que consiste em

definir o conjunto de equações para os cálculos de equilíbrio, propriedades físico-

químicas e termodinâmicas, e o conjunto de componentes químicos que serão utilizados

na simulação.

Na definição do modelo de propriedades das substâncias envolvidas no sistema

em estudo, especificamos a natureza química dos componentes químicos da simulação.

Para o nosso caso onde os  hidrocarbonetos são apolares, o modelo termodinâmico pode

ser representado por equações de estado. Neste trabalho foi utilizado o modelo

desenvolvido por Peng e Robinson (1976), que prevê com boa precisão as propriedades

para estes tipos de hidrocarbonetos.

Com o modelo de propriedades das substâncias envolvidas na simulação

definido, caracterizamos os componentes presentes no sistema. Para a depropanizadora,

as correntes envolvidas no sistema são constituídas basicamente de hidrocarbonetos

puros.

Os componentes utilizados na simulação podem ser caracterizados através de

cromatografia gasosa e estão listados na tabela 4.1

Componente Símbolo Fórmula
Ponto de

ebulição (oC)

Massa

molecular

metano C1 CH4 -161.52 16.04

etileno C2= C2H4 -103.75 28.05

etano C2 C2H6 -88.60 30.07

propeno C3= C3H6 -47.75 42.08

propano C3 C3H8 -42.10 44.10

iso-butano i-C4 C4H10 -11.73 58.12

iso-Buteno i-C4= C4H8 -6.85 56.11

1,3-butadieno 13C4= = C4H6 -4.45 54.09

n-butano n-C4 C4H10 -0.50 58.12

trans-buteno tr2-C4= C4H8 0.88 56.11

iso-pentano i-C5 C5H12 27.88 72.15

n-pentano n-C5 C5H12 36.06 72.15

n-hexano n-C6 C6H14 68.73 86.18

      Tabela 4.1 – Componentes puros considerados



Capítulo 4 – Simulação estática da depropanizadora 21

4.1.2 – Caracterização da carga do sistema

Com as bases de simulação definidas passamos para a fase de caracterização da

carga do sistema. Esta etapa consiste em definir as condições de processo, como

pressão, temperatura e vazão, bem como a sua composição.

Na planta industrial não é possível caracterizar a carga da coluna

depropanizadora diretamente. Assim,  a caracterização da carga é feita a partir dos

produtos da coluna. Os produtos são analisados separadamente e anotam-se as suas

respectivas vazões volumétricas. Portanto, a carga (GLP) é composta da combinação das

correntes propano e butano. Serão utilizadas duas composições de carga distintas,

retratando perfis de conversão diferentes no sistema de conversão da unidade. As

condições operacionais (temperatura, pressão e vazão) da carga serão as mesmas para os

dois perfis de composição.

A carga foi composta nas seguintes condições, a partir de dados da planta:

Corrente Vazão Temp. Pressão
Carga 2500 m3/d 75 oC 19.00 kgf /cm

2 _man
    Tabela 4.2 – Condições da carga

A composição da carga foi obtida através da cromatografia dos dois produtos

como mostra a tabela a seguir:

Componente % Vol. carga 1 % Vol. carga 2
metano 0.8921 0.9357
etileno 0.4956 0.4678
etano 0.4956 0.4678
propeno 24.1975 28.4370
propano 14.8409 15.5408
iso-butano 16.2137 13.4214
iso-buteno 18.5411 19.6506
1,3-butadieno 0.4654 0.8243
n-butano 9.7452 7.0021
trans-buteno 13.7693 13.1535
iso-pentano 0.2861 0.0210
n-pentano 0.0286 0.0781
n-hexano 0.0289 0.0000

    Tabela 4.3 – Composição da carga



Capítulo 4 – Simulação estática da depropanizadora 22

4.1.3 – Definição das operações unitárias envolvidas no processo

Com a carga do sistema caracterizada, iniciamos a construção das operações

unitárias e das correntes envolvidas no sistema como mostrado na figura 4.1.

Figura 4.1 – Fluxograma de processo da simulação

Após aquecimento no trocador de calor M20, a corrente de carga é introduzida

no sistema à 75oC e 19 kgf/cm2man. O trocador de calor é do tipo casco e tubo em

contra-corrente, onde a corrente de carga troca calor com a corrente nafta de fundo da

coluna debutanizadora (estabilizadora de gasolina). A perda de carga adotada é no casco

de 0.10 kgf/cm2man e nos tubos de 0.14 kgf/cm2man.

As temperaturas de entrada e saída do lado do casco, e saída do lado dos tubos

são conhecidas. As vazões envolvidas também são conhecidas. O UA do trocador é

calculado e apresenta um valor de 3.5 x 104 kcal/ (oC/h) (o valor de projeto do trocador é

de 11 x 104 kcal/( oC/h)).

A carga aquecida é introduzida no estágio 16 da coluna N-2406, como mostra a

figura 4.2.



Capítulo 4 – Simulação estática da depropanizadora 23

Figura 4.2 – Fluxograma de processo coluna simulada

A coluna tem 31 estágios de equilíbrio com 80 % de eficiência de Murphree

levantada experimentalmente. A perda de carga na coluna é de 0.63 kgf/cm2man, com

pressão no topo de 18.70 kgf/cm2man e no prato 24 de 19.18 kgf/cm2man. As pressões

são manométricas cuja unidade é; kgf/cm2man.

O perfil de temperatura tem os seguintes pontos básicos: a temperatura do

estágio de topo da coluna é 47 oC, do fundo de 106oC.

O condensador da coluna é total, ou seja, os vapores do topo são condensados e

subresfriados a 32 oC, não apresentando corrente gasosa como produto de topo. As

correntes de saída do condensador são: o propano (destilado) e o refluxo de topo. Além

destas duas correntes materiais, temos uma corrente de energia que é o calor absorvido

na condensação (QCond). Nestas condições a vazão de refluxo de topo é de 4000 m3/d.

Este condensador de topo, na realidade é um conjunto condensador e vaso.

No fundo da coluna, temos um refervedor onde parte do líquido do fundo é

vaporizado para fornecer energia ao processo de separação. O líquido do último estágio

é introduzido todo no refervedor. A parte vaporizada volta para a  coluna abaixo do



Capítulo 4 – Simulação estática da depropanizadora 24

último estágio, sendo a fase líquida removida como produto de fundo. O líquido do

último estágio é vaporizado à 106oC através do calor cedido (Qreb) de 7.85 x106 kcal/h

que corresponde a uma vazão de fluido de aquecimento de 2090 m3/d.

Nas colunas industriais, a corrente líquida de produto de fundo não passa pelo

refervedor. Entretanto considerar que este líquido participa do equilíbrio não representa

uma diferença perceptível em relação ao processo real. Portanto, esta é uma

simplificação que não causa desvios nos resultados da simulação.

Foi utilizada uma outra operação unitária M23 que é uma simulação do

refervedor para obtermos os valores de vazão do fluido de aquecimento (gasóleo

pesado). Dentro do ambiente de simulação da coluna calculamos a fração de chave

pesado do propano, que corresponde a quantidade de componentes de 4 átomos de

carbono ou mais, chamado de C4+, e também o chave leve do butano, que corresponde a

componentes de 3 átomos de carbono ou menos, chamado C3-.

Neste estudo o C4+ é composto de:

65544444 3,14 nCiCnCtransCCiCnCiCC +++++++= ====
+

Para o C3- temos:

122333 CCCCCC ++++= ==
?

4.1.4 – Especificação dos graus de liberdade para simulação do sistema

Como já visto, para tornar o modelo do sistema unívoco em termos de condições

operacionais, devemos especificar os graus de liberdade do sistema. Inicialmente

devemos especificar as características da carga como: temperatura, pressão e

composição da carga. Ao passar pelo pré-aquecedor de carga, temos que especificar a

perda de calor pelas paredes do trocador de calor (no caso é zero) e o produto UA do

trocador ou as temperaturas das correntes. Além disso devemos especificar as perdas de

carga no casco e nos tubos, ou as pressões das correntes. A carga pré-aquecida entra na

coluna de destilação.



Capítulo 4 – Simulação estática da depropanizadora 25

A coluna depropanizadora no estado estacionário apresenta dois graus de

liberdade além da pressão, que devem ser especificados conforme as variáveis

manipuladas da estratégia de controle. Para simulação da coluna, adota-se a seguinte

simplificação: a água de refrigeração para o condensador é manipulada visando manter

constante a temperatura de subresfriamento do líquido que sai do condensador. Neste

caso, especificamos esta temperatura na simulação. Outras variáveis manipuladas

especificadas são: a carga térmica do refervedor e a vazão de refluxo de topo. Como

visto, além dessas especificações, devemos definir o perfil de pressões da coluna. Na

tabela 4.4 apresentamos as especificações para o caso base.

Operação unitária

ou corrente

Especificação Valor

M-20 Perda de calor (MMcal/h) 0.00

Temp. ent. casco (oC) 42

Temp. sai casco (oC) 75

?emp. sai tubos (oC) 103

?P no casco (kgf/cm
2) 0.1

?P nos tubos (kgf/cm
2) 0.14

N – 2406 Subresfriam.cond. (oC) 32

Carga térm. reb (MMcal/h) 7.85

Vazão refluxo topo (m3/d) 4000

?P condensador (kgf/cm
2) 0.07

Pressão topo (kgf/cm2man) 18.63

Pressão fundo (kgf/cm2man) 19.33

?P refervedor (kgf/cm
2) 0.0

Tabela 4.4 – Especificações da simulação

4.1.5 – Validação do modelo estático

Com o caso base convergido, devemos validar o modelo construído. Para

validarmos o modelo devemos fazer as seguintes verificações:

ü Verificação do balanço material



Capítulo 4 – Simulação estática da depropanizadora 26

ü Verificação do perfil de temperaturas

ü Verificação da qualidade dos produtos

ü Verificação das cargas térmicas do condensador e refervedor

No ajuste do modelo, elegemos os parâmetros a serem manipulados, tais como,

eficiências dos estágios, modelo de equilíbrio, composição da carga, entre outros. Na

tabela 4.5 apresentamos os resultados do ajuste do modelo para o caso base.

Variável Valor real Valor simulado

Vazão de carga 2500 m3/d 2500 m3/d

Vazão de propano 1012.5 m3/d 1041 m3/d

Vazão de butano 1487.5 m3/d 1459 m3/d

Temperatura carga aquecida 75. oC 75 oC

Temperatura de refluxo 32 oC 31.8 oC

Temperatura de topo 47 oC 46.4 oC

Temperatura de fundo 106oC 106.4 oC

C4+ no propano 2.51 %vol. 2.45 %vol.

C3- no butano 0.50 %vol. 0.46 %vol.

Vazão de refluxo 4000 m3/d 4000 m3/d

Carga térmica do refervedor 7.85 MMcal/h 7.85 Mmcal/h

 Tabela 4.5 – Resultados da simulação

A vazão de propano para o caso base ficou em 1041 m3/d e a de butano em 1459

m3/d. Na planta industrial, temos uma vazão de propano de 1012.5  m3/d e de butano de

1487.5 m3/d. Tal diferença pode ser uma decorrência de problemas de calibração dos

instrumentos de medição e não é motivo de preocupação pois os perfis de composição e

temperatura estão em bom acordo com os dados da planta.

Uma boa medida para o desempenho do processo de separação é a verificação do

perfil de temperaturas ao longo da coluna. No entanto, a medição da temperatura em

todos os estágios na planta industrial não é economicamente viável, portanto colocam-se

sensores de temperatura somente nos pontos importantes. Na coluna depropanizadora,

os pontos importantes são a temperatura de topo e do fundo da coluna, que apresentaram

valores bastante coerentes com os da planta (cf. tabela 4.5).



Capítulo 4 – Simulação estática da depropanizadora 27

Quanto à qualidade dos produtos na simulação do caso base, obtivemos um

propano com um teor de C4+ de 2.45 %vol., e para o butano o teor de C3- ficou em 0.46

%vol., sendo estes valores bastante coerentes com os valores da planta industrial.

4.1.6 – Definição dos estudos da simulação estática

Com a simulação estática ajustada, poderemos dar início ao estudo de casos.

Neste estudo procuramos determinar a região de operação da coluna em função das suas

variáveis independentes, sujeitas às restrições de operação, tais como qualidade dos

produtos, hidráulica da coluna e outras.

Em nosso estudo foram manipuladas a vazão de refluxo e a carga térmica do

refervedor. As restrições observadas foram o teor de C4+  no propano, teor de C3- no

butano, temperatura máxima e mínima no topo e fundo da coluna e o limite de

convergência do processo. Nas tabelas 4.6 e 4.7 apresentamos estes valores.

Variável independente Limite mínimo Limite máximo Passo

Vazão refluxo 2300 m3/d 4000 m3/d 20 m3/d

C. term. refervedor 5.00 MMcal/h 8.0 MMcal/h 0.02 MMcal/h

    Tabela 4.6 – Variáveis manipuladas

Restrição Limite mínimo Limite máximo

Teor de C4+ 0 5 %vol.

Teor de C3- 0 5 %vol.

Temperatura topo 44 ºC 51 ºC

Temperatura fundo 103.5 ºC 107.5 ºC

C. term. condensador Não tem 10.95 MMcal/h

C. term. refervedor Não tem 8.32 MMcal/h

    Tabela 4.7 – Restrições do processo

A sensibilidade do processo é avaliada nesta etapa do estudo de casos, sendo

utilizado para isto a avaliação dos ganhos estáticos do processo. Também, podemos



Capítulo 4 – Simulação estática da depropanizadora 28

analisar o comportamento do processo, verificando as não-linearidades do processo,

bem como avaliarmos as suas variáveis importantes. No capítulo 6 faremos uma

descrição do estudo de casos e comportamento do processo analisado.



29

5

SIMULAÇÃO DINÂMICA DA DEPROPANIZADORA

A construção do modelo dinâmico no HYSYS? é uma etapa realizada após a

simulação estática, ou seja, uma vez que o modelo físico-químico estático esteja

representando a realidade da planta, é necessário adicionar outras variáveis e operações

que afetam a dinâmica do processo, além das variáveis da simulação estática (que requer

somente composições, temperatura, vazões, etc.).

Assim, para realizar a simulação dinâmica, é necessário definir os “holdups”

(acúmulos) dos equipamentos, as dimensões das válvulas de controle e os controladores

do nível regulatório.

Há uma  série de etapas a serem cumpridas na construção do modelo dinâmico

do HYSYS?, onde as seguintes são particularmente importantes:

ü Obtenção da solução do modelo estático;

ü Estabelecimento do esquema de controle para o processo;

ü Definição das características dinâmicas das operações unitárias;

ü Definição dos controladores e válvulas de controle do sistema;

ü Chaveamento da simulação do modo estático para o dinâmico.

A seguir apresentaremos as etapas da construção do modelo dinâmico de acordo

com a seqüência acima descrita. Na estrutura dos simuladores, inicialmente devemos

solucionar o problema de simulação estática. Para isto, devemos seguir o procedimento

descrito no capítulo anterior.

Uma vez obtido o modelo estático, devemos definir as variáveis manipuladas e

perturbações (independentes) e as variáveis controladas (dependentes) do esquema de

controle do sistema, na forma de controle multimalhas. Deve-se tomar o cuidado de

manter a coerência entre as especificações na simulação estática e as especificações das

variáveis manipuladas dos controladores para a simulação dinâmica. Também é

necessário definir as características dinâmicas das operações unitárias envolvidas na

simulação. Por exemplo os acúmulos de líquidos, incluindo volumes dos pratos da

coluna, dos vasos, trocadores de calor e  também o “set-point” do nível fundo da coluna.

Assim, para a simulação aqui estudada, definimos as características apresentadas na

tabela 5.1.



Capítulo 5 - Simulação dinâmica da depropanizadora 30

Equipamento Característica Valor

Coluna Diâmetro da coluna 3.050 m

N-2406 Comprimento do vertedor 2.52 m

Altura do vertedor 0.08 m

Volume mínimo 0.58 m3

Condensador M2422A/C Volume do condensador 18.44 m3

O-2407 Volume do vaso 16.22 m3

Refervedor Volume de fundo da torre e refervedor 8.66 m3

M-2423 SP do nível de fundo 50 %

    Tabela 5.1 – Dados geométricos dos equipamentos

Após definirmos os parâmetros geométricos do sistema, devemos estabelecer as

estruturas de controle e as características dos controladores. Isto significa definir as

variáveis manipuladas e controladas de cada malha de controle e os seus parâmetros de

configuração e de sintonia.

Temos a seguinte estrutura representada na figura 5.1.

  

Figura 5.1 – Esquema de controle da coluna depropanizadora.



Capítulo 5 - Simulação dinâmica da depropanizadora 31

O controlador FC-151 é um controlador de carga térmica do refervedor.

A tabela 5.2 mostra os parâmetros dos controladores e válvulas para a estratégia

de controle adotada.

Malha Variável controlada Variável manipulada Ação

Nome Min. Max. No

me

Min. Max.

FC-54 VRF 0 7000 m
3/d VRF 0 7000 m

3/d Reversa

PC-81 P#24 7 25 kgf/cm2man VPP 0 3000 m
3/d Direta

FC-151 QREB 0 10 MMcal/h QRE

B

0 10 MMcal/h Reversa

LC-29 LREB 0 100 % VBU

TANO

0 3000  m3/d Direta

FC-52 vCARGA 0 100 % vCA

RGA

0 5000 m3/d Direta

  Tabela 5.2 – Parâmetros de configuração dos controladores

Sendo:

VRF – Vazão de refluxo de topo;

P#24    – Pressão no estágio 24;

QREB       – Carga térmica do refervedor;

LREB    – Nível de fundo da coluna;

VBUTANO – Vazão de butano;

VPP         – Vazão de propano;

VCARGA    – Vazão de GLP;

Malha Parâmetros de sintonia
Kc ?i ?d

FC-54 0.75 0.25 0.0

PC-81 0.35 1.35 0.0

FC-151 0.8 0.1 0.0

LC-29 1.0 0.2 0.0

FC-52 1.0 0.1 0.0

              Tabela 5.3 – Parâmetros de sintonia dos controladores



Capítulo 5 - Simulação dinâmica da depropanizadora 32

O sistema de controle do HYSYS? pode ser representado pela estrutura da

malha fechada na figura 5.2. A equação do controlador (apresentada na seção 13.4.3

página 425 do manual de referência na sua versão 1.0) tem a seguinte forma:

( ) ( ) ( ) ( )
dt

tdE
KdttE

K
tEKOPtOP DC

I

C
CSS ??

+++= ? (5.1)

sendo:

OP(t) - Saída do controlador no instante t

OPSS - Saída do controlador no estado estacionário inicial

E(t) - Erro no instante t

KC - Ganho proporcional do controlador

?I - Tempo integral do controlador

?D - Tempo derivativo do controlador

O erro deve ser definido tendo como referência a ação reversa do controlador, ou

seja, se a PV ultrapassa o SP para cima, a saída do controlador (OP) deve decrescer.

Portanto, neste caso:

( ) ( ) ( )tPVtSPtE ?= (5.1a)
sendo:

SP - Setpoint da variável controlada

PV - Variável de processo da variável controlada

No equacionamento do bloco de elemento final de controle da figura 5.2,

devemos aplicar o modelo da válvula para a fase líquida ou vapor, conforme o caso. A

equação da válvula de controle para a fase líquida é dada por:

( ) minminmax100
%

FFF
OP

F +?= (5.1b)

sendo:

F - Vazão através da válvula de controle

OP% - saída do controlador em percentagem

Fmax - Vazão máxima através da válvula de controle



Capítulo 5 - Simulação dinâmica da depropanizadora 33

Fmin - Vazão mínima através da válvula de controle

Figura 5.2 – Diagrama em blocos da malha fechada.

Nessa etapa a simulação dinâmica está quase concluída, restando apenas chavear

a simulação do modo estático para o dinâmico. Esta operação é simples, e consiste do

simulador resolver o problema correspondente ao estado estacionário do modo dinâmico

utilizando os valores das variáveis independentes e as propriedades iniciais da

simulação estática. Como o conjunto de equações é ligeiramente diferente do utilizado

no modo estático, este fato faz com que tenhamos ligeiras diferenças entre os estados

estacionários dos dois modos.

Estando no modo dinâmico podemos iniciar os testes para obtenção dos modelos

do processo.



34

6

COMPORTAMENTO DO PROCESSO

A coluna depropanizadora tem como restrições especificar o teor do componente

chave pesado no propano, representado pelo C4
+, e o componente chave leve do butano,

representado pelo teor de C3
-. O objetivo neste caso é limitar a quantidade de frações

pesadas no propano para termos o mínimo de perda de butanos. Avaliaremos a variação

destas especificações em toda a região de operação das variáveis manipuladas.

A característica básica do controle dual é a especificação dos produtos de topo e

fundo da coluna, sendo que, no processo de separação a qualidade do produto de topo

está ligada à do fundo através do fracionamento da coluna. O fracionamento é definido

principalmente pela relação L/V, que é estabelecido externamente pela vazão de refluxo

e a carga térmica do refervedor. A figura 6.1 apresenta a relação entre as qualidades dos

dois produtos para diferentes valores de QReb e L/V. Vemos que, para um dado QReb, a

relação entre as duas saídas é razoavelmente linear em grande parte do diagrama. Isto

indica que as duas saídas nessa região são lineares em relação a L/V. Entretanto, para

valores de C3
-  e C4

+ abaixo de 3%, esse comportamento deixa de ser linear, e a não-

linearidade aumenta acentuadamente na região indicada na figura.

Quando a carga térmica do refervedor aumenta, estamos aumentando o

fracionamento da coluna, que é representado pelas curvas mais a esquerda da figura.

Figura 6.1 – Dualidade das qualidades dos produtos da coluna



Capítulo 6 - Comportamento do processo 35

As variáveis manipuladas pelo controle supervisório terão especial atenção no

estudo, pois afetam diretamente a qualidade dos produtos. No próximo item

apresentamos o comportamento do processo para as duas variáveis de controle

regulatório consideradas neste estudo.

6.1 – Região de operação e ganhos do processo:

A região de operação foi levantada considerando-se as seguintes variáveis no

controle preditivo:

• Variáveis Controladas

ü Teor de C4
+ no propano (C4

+)[%]

ü Temperatura de topo (Ttopo) [kPa], esta é uma variável redundante em

relação ao teor de C4
+. Esta variável será utilizada em substituição ao teor

de C4
+, pois a inferência utilizada atualmente para cálculo deste teor não

apresenta resultados satisfatórios.

ü Teor de C3
-  no butano (C3

-) [%]

Os modelos de inferência para o teor de C4
+ e C3

-, são baseados em correlações

multilineares utilizando-se dados de análise cromatográfica das correntes de propano e

butano e variáveis operacionais da planta industrial. Para obtenção das correlações,

normalmente utiliza-se o método dos mínimos quadrados para ajuste dos parâmetros das

correlações. Esta metodologia apesar de em alguns casos apresentar resultados

satisfatórios a nível industrial, não é a mais recomendada principalmente nos casos em

que os produtos têm pureza relativamente elevada como no caso da coluna

depropanizadora. Assim, a utilização de outras metodologias deve ser testada

principalmente aquelas que levem em conta modelos fundamentais do equilíbrio

líquido-vapor.  Os modelos utilizados atualmente para o teor de C4
+ e C3

- são

apresentados a seguir:

fxexdxcxxxxxbxaC ++++?+=? 9876543213 ***)*/()(***

( ) exdxcxbxaC ++++=+ 432
2

14 ****



Capítulo 6 - Comportamento do processo 36

PARÂMETROS PARA TEOR DE C3
- PARÂMETROS PARA TEOR DE C4

+

Coeficientes Variáveis Coeficientes Variáveis

a = -0.6586 x1 = temp. fundo a = 0.3714 x1 = temp. topo

b = -1.6912 x2 = vazão GOP b = 0.6198 x2 = pressão estágio 24

c = -0.0239 x3 = temp. GOP c = -19.8385 x3 = temp. topo

d = 0.02027 x4 = temp. fundo d = -0.04781 x4 = temp. refluxo

e = 0.1720 x5 = vazão carga e = 464.19 -

f = 50.80 x6 = temp. carga - -

- x7 = temp. estágio 24 - -

- x8 = pressão estágio 24 - -

- x9 = temp. saída

refervedor

- -

Tabela 6.1 – Parâmetros dos modelos das inferências.

• Variáveis manipuladas

ü Vazão de refluxo de topo  (VRF)  [m
3/d]

ü Carga térmica do refervedor  (QREB) [MMcal/h] , o controlador preditivo

manipulará a vazão de fluido  de aquecimento (gasóleo pesado -  VGOP)

para o refervedor.

• Variáveis perturbadoras (são variáveis independentes e que são medidas)

ü Vazão de carga (VFD)  [m
3/d]

ü Temperatura do fluido de aquecimento (TGOP)  [ºC]

Como temos uma série de restrições a serem obedecidas, as variáveis

manipuladas não poderão assumir valores quaisquer. A região delimitada por

estas condições é chamada de região de operação do sistema. No nosso caso a

região de operação pode ser definida pelas seguintes restrições:

ü Existe um estado estacionário, isto é, há líquido em todos os estágios da

coluna;

ü Quantidade máxima de C4
+ no propano em função da perda de componentes

nobres (iso-butano). A perda elevada de iso-butano na corrente de propano

irá implicar na necessidade de importação deste componente para suprir as



Capítulo 6 - Comportamento do processo 37

necessidades da unidade de gasolina de aviação. O valor máximo

considerado de butanos ( C4
+ ) foi de 5%.

ü Quantidade máxima de C3
- no butano, a presença de componentes leves na

corrente de butano irá implicar na perda de controle operacional na unidade

de gasolina de aviação, ocasionando a queima de produtos nobres no sistema

de tocha da refinaria. O valor máximo considerado de C3
- foi de 5%.

O sistema apresenta folgas de projeto em relação às cargas térmicas do

condensador e refervedor, não apresentando restrições quanto à vazões de

refluxo ou de fluído de aquecimento para o refervedor. A hidráulica da coluna

também apresenta folga, sendo possível processar todo o GLP produzido na

unidade bem como correntes provenientes de outras unidades.

Diante das restrições acima, temos a região de operação mostrada na figura

6.2, onde vemos que há uma série limitada de pares de valores das variáveis

manipuladas onde o processo é viável. Para levantamento da região de operação,

as variáveis perturbadoras são mantidas constantes.

           

            Figura 6.2 – Região de operação das variáveis manipuladas

Uma maneira eficiente para se observar o comportamento do processo é avaliar

as curvas de ganhos do processo. Esses ganhos são estimados utilizando-se a derivada

em vários pontos ao longo da região de operação, por exemplo para o teor de C3
- em



Capítulo 6 - Comportamento do processo 38

relação à vazão de refluxo teríamos:

sendo:

?
i3,KpC - ganho estático para o teor de C3

- no ponto de operação atual.

   ?i3,C  - teor de C3
- no ponto de operação atual.

   ? ?1i3,C  - teor de C3
- no ponto de operação anterior.

   iRF,V  - vazão de refluxo no ponto de operação atual.

   1iRF,V ?  - vazão de refluxo no ponto de operação anterior.

Estes ganhos estão representadas nas figuras 6.3 a 6.8. Nas figuras podemos

observar que os ganhos do C3
- com a VRF (vazão de refluxo) variam de 0.001 a 0.17

%vol/(m3/d), do C3
- com a VGOP (vazão de GOP) variam de –0.25 a –0.0015 %vol/(

m3/d), do teor de C4
+ com VRF  variam de –0.07 a –0.0005 %vol/( m

3/d) e com a VGOP

variam de 0.0010 a 0.150, da temperatura de topo com a VRF variam de -0.015 a -0.0450

ºC/(m3/d) e com a VGOP variam de 0.030 a 0.13 ºC/(m
3/d). Isto mostra que, para um

dado par (manipulada e controlada),  os ganhos do processo variam muito, o que leva a

crer que a utilização de um único modelo para o controlador preditivo, poderá levar a

uma performance não adequada do sistema.

    Figura 6.3 – Ganhos do C3- versus a vazão de refluxo

( ) ( )1iRF,iRF,1i3,i3,i3, VV/CCKpC ?? ??? ??=



Capítulo 6 - Comportamento do processo 39

 

  Figura 6.4 – Ganhos do C3- versus Vazão de GOP

 Figura 6.5 – Ganhos do C4
+  versus vazão de refluxo



Capítulo 6 - Comportamento do processo 40

Figura 6.6 – Ganhos do C4
+ versus vazão de GOP

 Figura 6.7 – Ganhos da temperatura de topo versus vazão de refluxo



Capítulo 6 - Comportamento do processo 41

 Figura 6.8 – Ganhos da temperatura de topo versus vazão de GOP

Diante dos valores apresentados, podemos concluir que o controle preditivo

linear encontrará dificuldades para manter a qualidade dos produtos. Este fato é coerente

com a observação do que ocorre em outras colunas de destilação nas plantas industriais,

onde verifica-se que com esse tipo de variações no ganho do modelo o controlador tem

reação muito lenta em determinadas condições e oscila excessivamente em outras

condições de operação. Além disso, quando realizamos o teste em degrau na planta, em

determinadas regiões de operação, as respostas das variáveis controladas são diferentes

dependendo se aplicamos degraus positivos ou negativos e dependendo da amplitude do

degrau. Isto é evidenciado nas tabelas 6.2 e 6.3, onde variamos o degrau de 1 a 5% nas

variáveis manipuladas para cima e para baixo em torno do “caso base”.

Degrau (%) Kp C3
- Kp C4

+ Kp Ttopo

-5.0 8.44E-04 -3.71E-02 -2.43E-02
-3.0 1.09E-03 -3.90E-02 -2.61E-02
-1.0 2.04E-03 -5.10E-02 -3.58E-02

1.0 5.54E-02 -2.94E-02 -2.75E-02
3.0 1.23E-01 -1.02E-02 -2.65E-02

Tabela 6.2 – Ganhos do processo em relação à vazão de refluxo.



Capítulo 6 - Comportamento do processo 42

Degrau (%) Kp C3
- Kp C4

+ Kp Ttopo

-3.0 -6.49E-01 2.10E-02 9.60E-01
-1.0 -1.36E-01 5.79E-02 5.70E-02

1.0 -5.22E-03 1.14E-01 7.91E-02
3.0 -8.97E-03 2.61E-01 1.73E-01
5.0 -2.32E-03 8.07E-02 5.23E-02

                   Tabela 6.3 – Ganhos do processo para a vazão de GOP.

Nas  tabelas 6.4 e 6.5 são apresentados os ganhos para as variáveis perturbadoras

que serão utilizadas no controlador. Aqui também é possível observar a grande variação

do ganho em função do degrau aplicado e do sentido (aumento ou redução da variável)

do mesmo.

Degrau (%) Kp C3
- Kp C4

+ Kp Ttopo

-10.0 0.00192 -0.01709 -0.01216
-5.0 0.00155 -0.01782 -0.01255
-3.0 0.00128 -0.01567 -0.01089
-1.0 0.00096 -0.01284 -0.00859

1.0 0.00266 -0.01525 -0.01104
3.0 0.00671 -0.01350 -0.01026
5.0 0.01355 -0.00923 -0.00798
10.0 0.02007 -0.00478 -0.00566

                  Tabela 6.4 – Ganhos do processo para a vazão de carga .

Degrau
(ºC)

Kp C3
- Kp C4

+ Kp Ttopo

-3.6 -3.42742 0.34303 0.73712
-1.6 -2.09024 0.75228 0.78103
-0.6 -0.48027 1.58481 1.18692

0.6 -0.11253 2.00225 1.42429
1.6 -0.05985 1.39626 0.95874
3.6 -0.04473 1.22596 0.82054

            Tabela 6.5 – Ganhos do processo para a temperatura do fluido de aquecimento.



43

7

IDENTIFICAÇÃO DOS MODELOS DO SISTEMA

Podemos dizer que a identificação do modelo do processo é uma das etapas mais

importantes no projeto e análise de um controlador, pois caso se utilize um modelo

inadequado, a performance do controle ficará prejudicada e sua análise será incorreta.

Assim, devemos ter em mente uma série de considerações sobre os modelos a serem

utilizados, tais como:

• Que tipo de modelo o controlador utiliza?

Para responder esta pergunta devemos considerar uma série de características do

sistema, como: se o modelo deve ser linear ou não-linear, fenomenológico ou

empírico, invariante ou variante no tempo.

• Qual a forma de apresentação do modelo?

Devemos responder se o modelo deve ser apresentado na forma de função de

transferência, ou resposta ao degrau ou impulso. Se apresentarmos o modelo na

forma de função de transferência, devemos definir se o modelo será apresentado

no domínio de tempo contínuo ou discreto. Se o modelo estiver na forma de

resposta ao degrau ou impulso, podemos apresentá-lo na forma de série temporal

ou na forma analítica.

• Qual a necessidade de se utilizar mais de um modelo do processo?

Para sistemas variantes no tempo, muitas vezes um único modelo não atende à

performance desejada em toda a região de operação do sistema. Isto ocorre

quando o processo altera suas características, por exemplo, alteração da natureza

da matéria-prima, ou degradação do processo por desgaste do equipamento,

como colunas de destilação cuja eficiência do estágio cai por vazamento nas

bandejas. Neste caso, devemos decidir se iremos utilizar um conjunto de

modelos pré-definidos ou se adaptaremos algum parâmetro do modelo do

processo, por exemplo o seu ganho estático.

No caso da coluna depropanizadora temos regiões de fortes  não-linearidades nos

ganhos, que devem ter, portanto, grandes alterações na sua dinâmica, e temos regiões



Capítulo 7 - Identificação dos modelos do sistema 44

onde os modelos obtidos são incompatíveis sob o aspecto de utilização em controle

preditivo.

7.1 – Algoritmo de identificação com modelos na forma analítica

Neste trabalho utilizaremos um conjunto de modelos convenientemente

escolhidos sendo apresentados na forma de resposta ao degrau analítico no domínio do

tempo contínuo. Esta representação pode ser visualizada através das seguintes equações:

( ) ji
na

g
gjigjijinji

jinji

nTnTfccs

nTs

,
1

,,,,0,,,,

,,, 0

?

?

??+=

??=

?
=

(7.1)

sendo:

i - i-ésima variável de saída (controlada)

j - j-ésima variável de entrada (manipulada e perturbação)

?i,j - tempo morto do par de variáveis i,j

n - instante de amostragem

( )

( ) ( )

( )

f t

f t e r

f t t r

i j

i j g
r t

i j g

i j g i j i j g

i j g i j

, ,

, , , ,

, , , , ,

, , ,

0 1

0

0

=

= ? ?

= ? ? =

??

?

O comportamento dinâmico da maioria dos processos pode ser representado por

equações diferenciais de primeira ou segunda ordem. No caso de processos em série,

como por exemplo “n” estágios de equilíbrio, a função de transferência resultante tem a

ordem correspondente à multiplicação das várias funções de transferência. Felizmente

os processos químicos de ordens elevadas têm normalmente comportamento que pode

ser razoavelmente aproximado por um modelo de ordem menor. Os controladores em

malha fechada podem adicionar raízes complexas ou zeros às funções de transferências.

Além disso, sistemas com funções de transferência em paralelo, podem adicionar zeros

no processo resultante, gerando por exemplo, resposta inversa.

Diante deste comportamento, podemos dizer que a maioria dos processos podem

ser representados pela seguinte função de transferência:



Capítulo 7 - Identificação dos modelos do sistema 45

( ) ?se
sasa

sbb
sG ?

++
+

=
2

21

10

1
(7.2)

Considerando o modelo sem a componente do tempo morto, temos:

( )
2

21

10

1 sasa
sbb

sG
++

+
= (7.3)

Considerando a aplicação de um degrau unitário ao sistema temos:

( ) ( )
s

sGsyd
1

×= (7.4)

substituindo a equação (7.3) em (7.4), temos:

( )
ssasa

sbb
syd

1
1 221

10 ×
++

+
=

fatorando yd(s), temos:

( )
( )( )sss

sbb
syd 11 21

10

++
+

=
??

ou

( )
sss

sbb
syd

??
?

?
??
?

?
+??

?

?
??
?

?
+

+
=

21

10

21 11
1

??
??

Portanto as raízes do denominador são:

0;
1

;
1

3
2

2
1

1 =?=?= rrr ??

Então a resposta ao degrau do sistema pode ser representada por:

( )
( )( )srsrs

sbb
rrsyd

21

10
21 ??

+
=

Separando a resposta ao degrau em frações parciais, temos:



Capítulo 7 - Identificação dos modelos do sistema 46

( )
2

2

1

10

rs
c

rs
c

s
c

syd ?
+

?
+=

sendo:

00 bc =

12

1
1

0

1
21

110
21 11

1

rr

b
r

b
cou

rr
rbb

rc
?

+
=

?
+

=

21

1
2

0

2
12

210
12 11

1

rr

b
r

b
cou

rr
rbb

rc
?

+
=

?
+

=

Passando a resposta ao degrau para o domínio do tempo e incluindo o termo do

tempo morto, teremos:

( ) ( ) ( )?? ?? ++= trtrd ececcty 21 210 (7.5)

No caso de um sistema SISO, podemos escrever a equação da predição da saída

para um instante qualquer, na seguinte forma paramétrica:

[ ] [ ] ( )??+= ?
=

jTfppy g
na

g
kgkj

1
0 (7.6)

[ ] [ ] 10100 ?? ?+= kkk ucpp            (7.7)

[ ] [ ] 11 ?? ?+= k
Tr

g
Tr

kgkg
uecepp gg

sendo:

g = 1, 2, …, na

?
?
?

?
?
?

++= 1int
T

kj
?

sendo que:

k = 1, 2,…, ns-?/T-1

? - tempo morto

 T - período de amostragem

ns - horizonte da predição

int() - valor inteiro



Capítulo 7 - Identificação dos modelos do sistema 47

na - número de pólos do processo

A identificação dos modelos do processo consiste na determinação dos

parâmetros cg, rg e ? para g = 0, 1, 2, …, na da equação (7.6). Este ajuste de parâmetros

é efetuado através de um procedimento de busca não-linear. Normalmente na

identificação do processo, os modelos são apresentados na forma discreta. Neste

trabalho, os modelos serão apresentados na forma contínua.

A identificação do processo consiste das seguintes etapas:

1 – Assumir os valores iniciais para os parâmetros:

Considerando o modelo definido pela equação (7.2), a predição da saída que é

dada pela equação (7.6), fica:

[ ] [ ] ( ) [ ] ( )?? ?? ++= jTrkjTrkkj epeppy 21 210
sendo:

[ ] [ ] 11111 11 ?? ?+= k
TrTr

kk uecepp (7.8)

[ ] [ ] 12122 22 ?? ?+= k
TrTr

kk uecepp (7.9)

Os parâmetros a serem ajustados, para os quais devemos assumir valores iniciais,

são: c1, c2, r1, r2 e ?. Além disso, inicialmente assumimos que o processo esteja no

estado estacionário, portanto:

[ ] 110 yp =
[ ] 011 =p
[ ] 012 =p

sendo:

y1 – Valor inicial da saída

2 – Calcular as predições da saída:

Nesta etapa calculamos as predições da saída nos instantes k = 1, 2,…, ns-?/T-1

com os parâmetros calculados através das equações (7.7) a (7.9).

3 – Calcular o resíduo da predição através do critério quadrático:



Capítulo 7 - Identificação dos modelos do sistema 48

( )?
+=

?=
sn

Tj
jjj yyISE

1

2ˆ
?

?

sendo:

jy  - valor medido da saída no instante j

jy?  - valor da predição da saída no instante j

j?  - peso que pune o desvio no instante j

4 – Executar o procedimento de otimização dos parâmetros do modelo, formulando o

problema da seguinte forma:

ISE
rrcc ?,,,, 2121

min

sujeito à:

?
=

?=
na

g
g cc

1
0 (7.10)

A restrição apresentada pela equação (7.10) garante que o sistema seja

estritamente próprio. Os parâmetros cg e rg do modelo podem ser complexos e o

parâmetro c0 é um número real. No caso do modelo utilizado neste trabalho, a equação

(7.10) fica:

210 ccc +=?

Como a predição da saída é uma função exponencial, devemos utilizar um

algoritmo da programação não-linear.

No processo de identificação foram efetuados testes que consistiram na aplicação

de degraus nas variáveis manipuladas e perturbadoras individualmente, ou seja, aplicou-

se um degrau em uma dada entrada, aguardou-se o processo atingir o estado estacionário

e em seguida se aplicou um degrau na variável seguinte. A escolha dos pontos de

operação onde os testes foram executados levou em conta as faixas de ganhos do

processo e a região de operação em que o controlador deverá operar.

No próximo item apresentamos os resultados da identificação dos modelos do

processo para as duas composições de carga utilizadas.



Capítulo 7 - Identificação dos modelos do sistema 49

7.2 – Modelos de processo identificados:

Foram aplicados degraus nas seguintes variáveis manipuladas e perturbadoras do

controle supervisório:

ü Vazão de refluxo de topo (VRF) [m
3/d]

ü Vazão de fluido de aquecimento (VGOP) [m
3/d]

ü Vazão de carga (VCARGA) [m
3/d]

ü Temperatura do fluido de aquecimento (TGOP)  [ºC]

Foram efetuados testes em 5 pontos da região de operação do sistema. Na figura

7.1, vemos os pontos escolhidos assinalados de 1 a 5, que correspondem aos números

dos modelos identificados. Os modelos de 1 a 3 são referentes à composição de carga 1

e os modelos 4 e 5 se referem à composição de carga 2. O ponto FD corresponde a um

modelo obtido através de teste realizado na planta industrial, o teste consistiu na

aplicação de degraus nas variáveis manipuladas e perturbadoras, sendo o modelo obtido

também na forma analítica como os demais.

Figura 7.1 – Região de operação do processo.



Capítulo 7 - Identificação dos modelos do sistema 50

Os pontos foram escolhidos visando obter modelos que representem as diversas

condições do processo de forma a termos um politopo onde os vértices seriam

representados através deste conjunto de modelos. A idéia é então representar qualquer

modelo correspondente à  outra condição operacional através de uma combinação

convexa deste conjunto de modelos.

Os modelos obtidos estão representando bem a região de operação do

controlador. Na tabela 7.1 apresentamos os pontos de operação com suas principais

características.

Modelo VRF

(m3/d)

VGOP

(m3/d)

Ttopo

(oC)

C4
+

(%)

C3
-

(%)

1 4000 2104 47.74 4.30 0.38
2 3160 1731 49.34 6.55 0.88
3 2300 1331 47.82 4.60 4.81
4 2240 1115 47.08 3.00 3.01
5 3532 1837 44.35 0.08 4.35

                     Tabela 7.1 – Pontos de operação dos modelos do processo

A figura 7.2 mostra o conjunto de modelos para resposta às variáveis

manipuladas e a 7.3 mostra o conjunto de modelos para as perturbações. Observa-se que

há modelos de naturezas muito distintas, com ganhos e dinâmicas bem diferentes. Nas

figuras, não apresentamos os modelos relativos do teor C4
+  para a planta industrial,

devido à não confiabilidade da inferência utilizada para medição desta variável.  



Capítulo 7 - Identificação dos modelos do sistema 51

 Figura 7.2 – Modelos de resposta ao degrau nas manipuladas. O modelo da planta real é

o FD.



Capítulo 7 - Identificação dos modelos do sistema 52

 Figura 7.3 – Modelos de resposta ao degrau nas perturbações. O modelo da planta real é

o FD.



Capítulo 7 - Identificação dos modelos do sistema 53

A seguir apresentamos os parâmetros dos modelos identificados, na forma de

resposta ao degrau unitário analítica, conforme apresentado anteriormente. No Apêndice

A, apresentamos os modelos na forma de função de transferência

Para o modelo 1:

( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-.(-i)ee-.-e-.(-.ty 1146100054500114610005450011 50800642490250800642490200044980 ?+ +++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e. (i)ee-.-e-.(.-ty 1214410176960121441017696012 478296372081478296372081003440 ?+ ++++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-. (-i)ee-.e-.(-e-.ty 121340198701213401987013 33327033333033327033333000466666 ?+ ?+++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-. (i)ee-.-e-.(e-.-ty 108130067101081300671014 23858029787023858029787000295741 ?+ +++=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 107280057101072800571021 00996001483000996001483000296622 ?+ +++=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(-i)e..(-e-.ty 106500067201065000672022 03379003803003379003803000260577 ?+ ?+++=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 108900078701089000787023 008128000880100081280008801000276031 ?+ +++=

( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 106500067201065000672024 00510005700051000570141 ?+++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)ee-.e-.(i)ee-.-e-.(.-ty 1054500065900105450006590031 034803670348036701530 ?+ +++=

( )   )(  t - .-  )(  t - .- e. e..ty 1062100119840232 051800009005100 ?+=

( )   )(  t - .-  )(  t - .- e. e..-ty 10731018517133 011500002001120 +?=

( )   )(  t - .-  )(  t - .- e.e..ty 106215011984234 777500132076430 ?+=

Para o modelo 2:

( )   )(  t - .-  )(  t - .- e.-e..ty 1169400149080111 002092000042000167130 +=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)e.. (i)e.-.(.-ty 13263025197013263025197012 0033700060114000337000601140012020 ?+ +++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)e..(-i)e..(-.ty 113020104801130201048013 00174000093310001740000933100018660 ?+ ?+++=

( )   )i)(  t - ..(-  )i)(  t - ..(- i)e.. (i)e.-.(e-.-ty 108560066101085600661014 01136002028001136002028000205534 ?+ +++=

( )  )( t - .- )( t - .- e.e.e-.-ty 10864016492021 05670000512000215775 +?=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(-i)e..(-e-.ty 109080063401090800634022 01807003854001807003854000270757 ?+ ?+++=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.ty 110100067801101000678023 00691001313000691001313000262562 ?+ +++?=

( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 109080063401090800634024 230500230500990 ?+++=



Capítulo 7 - Identificação dos modelos do sistema 54

( )   )(  t - .-  )(  t - .- e. e..-ty 1124700194770131 02600001002610 ++=

( )   )(  t - .-  )(  t - .- e. e..ty 1112400172290032 06490009900550 ?+=

( )   )(  t - .-  )(  t - .- e. e..-ty 10938017390033 017700006001700 +?=

( )   )(  t - .-  )(  t - .- e.e..ty 11124017229034 834301269070740 ?+=

Para o modelo 3:

( )   )(  t - .-  )(  t - .- e.- e..ty 10823011090111 018980002180016790 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 10660012742012 055050011870043170 +?=

( )   )(  t - .-  )(  t - .- e.- e..ty 10733014900013 023060001630021430 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 10660012742014 54000120004300 +?=

( )  )( t - .- )( t - .- e.e..-ty 10871012653021 05308000748004560 +?=

( )  )i)( t - .-.(- )i)( t - ..(- i)e..(i)e..(.ty 107120126301071201263022 0536003282005360032820065640 ??++?+= +

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e..(.ty 107650114701076501147023 0011710000869000117100008690017370 ?+ ++?+?=

( )  )i)( t - ..(-)i)( t - .+.(- i)e.-.(-i)e..(-.ty 107120123601071201236024 530320530320650 ?+++=

( )   )(  t - .-  )(  t - .- e. e..-ty 11391012625031 020500021002260 ++=

( )   )(  t - .-  )(  t - .- e. e..ty 11089017869132 048800009004570 ??=

( )   )(  t - .-  )(  t - .- e. e..-ty 11021017822033 010900001001100 ++=

( )   )(  t - .-  )(  t - .- e. e..ty 11089017869134 442100086045060 ??=

Para o modelo 4:

( )   )(  t - .-  )(  t - .- e.- e.e-.ty 10704019176011 0083090000759000355017 +=

( )   )(  t - .-  )(  t - .- e. e.e-.-ty 10417012187012 02422000381000204022 +?=

( )   )(  t - .-  )(  t - .- e.- e.e-.ty 10585014526013 01129000105000202391 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 10417012187014 230040200 +?=

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e.-.(e-.-ty 104160075501041600755021 03019002960003019002960000291935 ?+ +++=

( )  )i)( t - .-.(- )i)( t - ..(- i)e..(-i)e..(-.ty 104340052101043400521022 070640055320070640055320110 ?+++= +

( )  )i)( t - ..(- )i)( t - ..(- i)e..(i)e..(e-.ty 104770048401047700484023 01679002010001679002010000202014 ?+ ++?+?=
( ) )i)( t - .-.(-)i)( t - .+.(- i)e..(-i)e..(-.ty 104340052101043400521024 680530680530061 ?+++=



Capítulo 7 - Identificação dos modelos do sistema 55

( )   )(  t - .-  )(  t - .- e. e..-ty 11078017790031 028500010002950 ++=

( )   )(  t - .-  )(  t - .- e. e..ty 10482018120032 072600025007510 ??=

( )   )(  t - .-  )(  t - .- e. e..-ty 10361018516133 026600003002630 +?=

( )   )(  t - .-  )(  t - .- e. e..ty 10482018120034 694300237071800 ??=

Para o modelo 5:

( )   )(  t - .-  )(  t - .- e.-e.e-.ty 11154017011011 0089590001979000397956 +=

( )   )(  t - .-  )(  t - .- e. e.e-.-ty 11136012281012 03551001706000284451 +?=

( )   )(  t - .-  )(  t - .- e.-e.e-.ty 10876018127013 01084000131000353119 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 11136012281014 480230250 +?=

( )  )( t - .- )( t - .- e.e.e-.-ty 10648011042121 04132000133000299853 +?=

( )  )( t - .- )( t - .- e.e.e-.ty 10709012536022 03551001706000251937 +?=

( )  )( t - .- )( t - .- e.e.e-.ty 10578012987023 03374000721000265352 +??=

( )  ))( t - .-))( t - .- e.e..ty 10709012536024 321300021 ?+=

( )   )(  t - .-  )(  t - .- e. e..-ty 11001010675131 019300001001930 +?=

( )   )(  t - .-  )(  t - .- e. e..ty 10751013439232 045300008004610 ??=

( )   )(  t - .-  )(  t - .- e. e..-ty 10595019223033 014200003001390 +?=

( )   )(  t - .-  )(  t - .- e. e..ty 10779015952134 600800161061690 ??=

Para o modelo da planta industrial:

( )   )(  t - .-  )(  t - .- e.- e.e-.ty 11780013169311 0010830000125000458199 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 11584015403212 003881000027120003610 +?=

( )   )(  t - .-  )(  t - .- e.- e..ty 12657011164113 005046000149500034870 +=

( )   )(  t - .-  )(  t - .- e. e..-ty 1009200108398014 088710000490089230 ++=

( )   )(  t - .-  )(  t - .- e. e..-ty 10625015755131 0123000023220012530 ++=

( )   )(  t - .-  )(  t - .- e. e..ty 10271014027232 03192000047810031440 ?+=

( )   )i)(  t - .-.(-  )i)(  t - ..(- i)e..(i)e.-.(.-ty 116261162611162611626133 0080270007228000802700072280014550 +++= +



Capítulo 7 - Identificação dos modelos do sistema 56

( )   )i)(  t - ..(-  )i)(  t - .-.(- i)e..(i)e..(.ty 118870300701188703007034 5133033370513303337066750 +??++?+=

Nas equações acima  yij(t) representa uma resposta da saída i no instante t para um

degrau unitário aplicado na entrada  j no instante 0, onde:

 i = 1 - representa a concentração de C3
- na corrente de fundo da coluna.

 i = 2 - representa a concentração de C4
+ na corrente de topo da coluna.

 i = 3 - representa a temperatura de topo da coluna.

 j = 1 - representa a vazão de refluxo de topo da coluna.

 j = 2 - representa a vazão de fluido de aquecimento para o refervedor da coluna.

 j = 3 - representa a vazão de carga para a coluna.

 j = 4 - representa a temperatura do fluido de aquecimento para refervedor.



57

8

ALGORITMOS DE CONTROLE

As principais características dos controladores preditivos inicialmente

desenvolvidos por Cutler e Ramaker (1979), Prett e Gillette (1980) e Richalet et al.

(1978) são as seguintes:

• Embora na engenharia de controle clássico, o modelo do processo seja

definido por um modelo de estado ou função de transferência, nos

controladores preditivos, as saídas futuras são previstas usando modelos de

resposta ao degrau ou impulso.

• Diante das incertezas no modelo identificado, variações da planta e

perturbações não medidas, introduziu-se o termo de correção da predição

como a diferença do valor estimado e o valor medido.

• As ações de controle minimizam um índice de performance definido pelo

usuário. Normalmente é minimizada a diferença quadrática entre a trajetória

desejada e a trajetória prevista.

• As ações de controle são normalmente calculadas através de um algoritmo de

otimização, onde incluímos pesos e restrições ao problema de controle.

• O algoritmo de controle calcula a trajetória futura das entradas, porém

somente a primeira ação de controle será implementada na planta.

Nos controladores preditivos industriais as funções são executadas em um ciclo

de amostragem pré-definido onde temos as seguintes etapas:

• Leitura das entradas e saídas da planta;

• Cálculo das predições das saídas;

• Cálculo do erro em relação à trajetória desejada;

• Cálculo das ações de controle;

• Implementação das ações de controle na planta.

A seguir apresentaremos a forma de evolução do MPC onde serão abordados os

seguintes pontos:



Capítulo 8 - Algoritmos de controle 58

• MPC com modelo não-paramétrico;

• MPC com modelo de ordem reduzida;

• MPC com multi-modelos;

• Solução do algoritmo MPC com SQP.

8.1 – MPC com modelo não-paramétrico

Neste tipo de algoritmo é utilizado um modelo FIR (finite impulse response) ou um

modelo de resposta ao degrau para representar o comportamento dinâmico do processo. O

modelo é obtido como uma seqüência de coeficientes numéricos que relaciona as entradas

com as saídas. Por exemplo, no caso do modelo FIR temos a saída i relacionada com a

entrada  j da seguinte forma:

( ) ( )nubky j
nb

n
i,j,ni

i,j

?=? ?
=1

Sendo:

nbi,j - número de coeficientes do modelo

bi,j,n - corresponde ao n-ésimo coeficiente da resposta ao pulso unitário

8.1.1 – Cálculo das predições das variáveis controladas

As predições das variáveis controladas são baseadas no modelo do sistema e nas

ações de controle já aplicadas ao processo.

O cálculo das predições tem as seguintes etapas:

• Cálculo do efeito da última ação de controle;

• Correção da predição através das leituras da planta real;

• Translação da predição corrigida.

8.1.1.1 – Efeito da última ação de controle



Capítulo 8 - Algoritmos de controle 59

No caso de um processo estável em malha aberta, podemos representar a

predição da variável controlada como a composição de duas parcelas, uma parte

corresponde aos efeitos das entradas passadas e a outra parte referente à contribuição da

última ação de controle, esta predição pode ser representada da seguinte forma:

[ ] [ ]y y s ui k n k
k

i k n k
k

i j n j k
j

nu

, , , , ,+
?

+ ?
?

?
=

= + ?
1

1
1

1
1

? (8.1)

sendo:

n - instante futuro n = 1, 2, …

[ ]y i k n k
k

, + ?
?

1
1

- predição da variável controlada i no instante futuro k+n

  calculada no instante k-1 com informações do processo até k-1.

[ ]yi k n k
k

, +
?1

- predição da variável controlada i no instante futuro k+n

  calculada  no instante k com informações do processo até k-1.

si j n, , - coeficiente correspondente ao instante n da resposta ao degrau

   da variável controlada i com  a  variável manipulada j

?u u uj k j k j k, , ,? ? ?= ?1 1 2

u j k, ?1 - valor da variável manipulada j aplicada no instante k-1.

u j k, ?2 - valor da variável manipulada j aplicada no instante k-2.

Usando (8.1) para calcular as predições de todas as variáveis controladas, temos:

[ ] [ ]y y S uk n k
k

k n k
k

n k+
?

+ ?
?

?= +
1

1
1

1? (8.2)

Sendo:

[ ] [ ] [ ]y y yk n k
k

k n k
k

ny k n k
k

T

+ ?
?

+ ?
?

+ ?
?

=
?
??

?
??

1
1

1 1
1

1
1

, ,L [ ]yk n k
k

ny
+ ?

?

×? ?1
1

1

[ ] [ ] [ ]y y yk n k
k

k n k
k

ny k n k
k

T

+
?

+
?

+
?

=
?
??

?
??1 1 1 1, ,

L [ ]yk n k
k

ny
+

?

×? ?
1

1

[ ]? ? ?u u uk k nu k
T

? ? ?=1 1 1 1, ,L ?uk
nu

?
×? ?1

1



Capítulo 8 - Algoritmos de controle 60

?
?
?

?

?

?
?
?

?

?

=

nnunynny

nnun

n

ss

ss
S

,,,1,

,,1,1,1

L
MM

L
Sn

ny nu? ? ×

sendo, nu o número de variáveis de entrada (manipuladas e perturbações) e ny o número

de variáveis de saída (controladas)

No enfoque convencional as predições das variáveis controladas são feitas em

instantes seqüênciais defasados de um período de amostragem até o maior horizonte de

estabilização dos modelos, ou seja:

( )ji
ji

nh ,
,

maxnp =  

Assim, as predições das variáveis controladas em todos os instantes desejados,

podem ser apresentadas da seguinte forma:

[ ] [ ]y y S uk
k

k
k

k
?

?
?

?= +
1

1
1

1? (8.3)

sendo:

[ ] [ ] [ ] [ ]
T

T
npk

T
k

T
k

k
k

k
kk

k
k

k
yyyy ??

?
??
?=

?
??

?
?

? +++?
?

1
11

1
1

1 211
1 L

[ ] [ ] [ ] [ ]
T

T
npk

T
k

T
k

k
k

k
kk

k
k

k
yyyy ??

?
??
?=

???
+++?

111
21

1
L

[ ]? ? ?u u uk k nu k
T

? ? ?=1 1 1 1, ,L

[ ]TTnpTT SSSS L21=

8.1.1.2 – Correção das predições com as leituras da planta

Diante das incertezas em relação aos modelos da planta e perturbações não

medidas, é necessário acrescentar um termo  de correção das predições das variáveis

controladas.

Com os efeitos das ações de controle calculados, devemos corrigir as predições

através da leitura das variáveis controladas. As predições dessas variáveis, no primeiro

instante deveriam corresponder aos valores lidos das variáveis controladas (se os



Capítulo 8 - Algoritmos de controle 61

modelos fossem perfeitos). Para o cálculo dessa correção, utilizamos  apenas os termos

correspondentes ao instante k+1 do vetor de predições, ou seja:

[ ] [ ]y N yk k
k

k
k

+
? ?

=1
1 1

(8.4)

sendo:

[ ] [ ] [ ] [ ]y y y yk k
k

k k
k

k k
k

ny k k
k

T

+
?

+
?

+
?

+
?

=
?
??

?
??1 1 1 1 1 2 1 1 1 1, , ,

L

N =

?

?

?
?
?
?

?

?

?
?
?
?

1 0 0 0 0
0 1 0 0 0

0 0 1 0 0

L L
L L

M M O M M M
L L

; npnynyN .×??

Considerando a leitura da variável controlada i representada por $ ,yi k , podemos

calcular o desvio da predição em relação à leitura da planta como

[ ]w y yi k i k i k k
k

, , ,$= ? +
?

1
1

Para todas as variáveis controladas, obtemos:

[ ]W y yk k k k
k

= ? +
?

$ 1
1

(8.5)

sendo:

[ ]
[ ]Tknykk

T
knykk

yyy

wwW

,,1

,,1

ˆˆˆ L

L

=

=
1

1

ˆ ×

×

??

??
ny

k

ny
k

y

W

Substituindo (8.4) em (8.5), temos:

[ ]W y N yk k k
k

= ?
?

$
1

(8.6)

A correção deste desvio é normalmente propagada para todas as predições

futuras. A lei de propagação da correção adotada neste trabalho é apresentada como:



Capítulo 8 - Algoritmos de controle 62

[ ] [ ] ki
k

knki
k

k
c

nki wyy ,
1

,
1

, +=
?

+
?

+

sendo:

[ ]yi k nc k
k

, +
?1

- predição corrigida da variável controlada i no instante futuro

k+n calculado no instante k com informações do processo em

k-1.

Podemos escrever as predições corrigidas para todas as variáveis controladas e

todos os instantes futuros escolhidos, assim temos:

[ ] [ ]y y KWc k
k

k
k

k
? ?

= +
1 1

(8.7)

sendo:

K =

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

1 0 0
0 1 0

0 0 1
1 0 0

0 0 1

1 0 0

0 0 1

L
L

M M O M
L
L

M M M
L

M M M
L

M M M
L

Substituindo as equações (8.3) e (8.6) em (8.7), temos:

[ ] [ ] [ ]y y S u K y N y S uc k
k

k
k

k k k
k

k
?

?
?

? ?
?

?= + + ? +
?
?
? ?

?
???

?
?
?
?1 1 1 1 1 1 1

? ?$

Agrupando os termos, temos:

[ ] ( )[ ] ( )y I KN y Ky I KN S uc k
k

k
k

k k
?

?
?

?= ? + + ?
1

1
1

1$ ? (8.8)



Capítulo 8 - Algoritmos de controle 63

sendo:

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

ny

ny

ny

I

I
I

I

L
MOMM

L
L

00

00
00

; I ny np ny np? ? ×. .

?
?
?
?

?

?

?
?
?
?

?

?

=

100

010
001

L
MOMM

L
L

nyI ;
nyny

nyI
×??

8.1.1.3 – Translação da predição corrigida

As predições das variáveis controladas estão atualizadas e corrigidas para o

instante k. Isto significa que:

[ ]yi kc k
k

, +
?

2
1
 - corresponde ao instante atual k+1

[ ]yi kc k
k

, +
?

3
1
 - corresponde ao instante futuro k+2

      M

[ ]
1

1,
?

++
k

k
c

npkiy  - corresponde ao instante futuro k+np

Portanto, dentro da filosofia dos controladores preditivos, que apresentam um

horizonte móvel, é necessário fazer a translação de um período de amostragem em todo

vetor de predições e para todas as variáveis controladas.



Capítulo 8 - Algoritmos de controle 64

[ ] [ ]

[ ] [ ]
[ ] [ ]

[ ] [ ]

[ ] [ ]

[ ] [ ]
1

,1,

1
,11,1

1
3,2,

1
3,12,1

1
2,1,

1
2,11,1

?
+?+

?
+?+

?
++

?
++

?
++

?
++

=

=

=

=

=

=

k
k

c
npkny

k
knpkny

k
k

c
npk

k
knpk

k
k

c
kny

k
kkny

k
k

c
k

k
kk

k
k

c
kny

k
kkny

k
k

c
k

k
kk

yy

yy

yy

yy

yy

yy

M

M

M

M

Para sistemas estáveis, assume-se que np é suficientemente grande tal que:

[ ] [ ]
1

,,
?

=
k

k
c
npi

k
knpi yy

Vetorialmente, podemos representar a translação da seguinte forma:

[ ] [ ]
1?

=
k

k
c

k
k yMy (8.9)

sendo:

?
?
?
?
?
?

?

?

?
?
?
?
?
?

?

?

=

ny

ny

ny

ny

I
I

I
I

M

L
L

MOMMM
L
L

000
000

000
000

; M ny np ny np? ? ×. . (8.10)

Substituindo a eq. (8.8) na eq. (8.9), obtemos a seguinte expressão para as

predições das variáveis controladas.

[ ] ( )[ ] ( )y M I KN y MKy M I KN S uk
k

k
k

k k= ? + + ??
?

?1
1

1
$ ? (8.11)

8.1.2 – Cálculo das ações de controle



Capítulo 8 - Algoritmos de controle 65

O algoritmo de controle preditivo calcula as ações de controle segundo as

seguintes etapas:

• Recebe a trajetória referência para as variáveis controladas em determinados

instantes futuros. O número de instantes é denominado  horizonte de

predição (np).

• Calcula os erros das variáveis controladas em relação ao setpoint ou a uma

faixa de operação, onde o erro é nulo quando a predição está dentro dos

limites estabelecidos para as variáveis.

• Calcula os valores das ações de controle nos instantes futuros de modo a

minimizar os erros das variáveis controladas em certos instantes futuros.

A seguir serão descritas estas etapas.

8.1.2.1 – Trajetória de referência das variáveis controladas

Calculadas as predições das variáveis controladas, utilizam-se estas mesmas no

cálculo das ações de controle. Na forma tradicional de cálculo do controlador preditivo

o horizonte de predição (np) corresponde aos instantes futuros até o maior tempo de

estabilização dos modelos do processo. O horizonte de otimização (nr) é relativo aos

instantes futuros em que o controlador irá minimizar os erros.

Para o cálculo das ações de controle, utilizamos apenas os termos

correspondentes até o instante k+nr do vetor de predições, pois comumente não é

interessante calcularmos as ações de controle considerando todos os instantes até o

estado estacionário. Desta forma, podemos escrever:

[ ] [ ]
k

kr
k

k yNy =~

sendo:

[ ] [ ] [ ] [ ]
T

T
nrk

T
k

T
kk

k
k

k
k

k
k

k
yyyy ??

?
??
?= +++ L21

~



Capítulo 8 - Algoritmos de controle 66

?
?
?
?

?

?

?
?
?
?

?

?

=

00100

00010
00001

LL
MMMOMM

LL
LL

rN
nynpnynr

rN
.. ×??

As predições das variáveis controladas são alteradas ao aplicarmos as ações de

controle em cada instante. Os controladores preditivos têm a característica de poder

calcular mais de uma ação de controle, que fornece mais graus de liberdade para o

controlador preditivo. Quando aumentamos o número de ações calculadas, permitimos

ao controlador distribuir de forma mais conveniente as suas ações. Desta forma, quando

aplicamos “m” ações de controle, temos:

[ ] [ ]
[ ] [ ]

[ ] [ ]

[ ] [ ] 1111

1111

11222

111

?++?+?++

?++?++

+++

++

?++?+?+=

?++?+?+=

?+?+=

?+=

mkmnrknrknr
k

knrk
k

knrk

mkkmkm
k

kmk
k

kmk

kk
k

kk
k

kk

k
k

kk
k

kk

uSuSuSyy

uSuSuSyy

uSuSyy

uSyy

L
M

L
M

Na forma vetorial, temos:

[ ] [ ] uSyy mkkkk ?+=
~

sendo:

[ ] [ ]T
k

knrkmkkkk
k yyyyy ++++= LL21

[ ]Tmkk uuu 1?+??=? L

?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?

?

?

=

+??

?

11

11

12

1

0
00

mnrnrnr

mm
m

SSS

SSS

SS
S

S

L
MMM

L
MMM

L
L



Capítulo 8 - Algoritmos de controle 67

8.1.2.2 – Cálculo dos erros das variáveis controladas

Tendo a trajetória prevista das variáveis controladas, podemos calcular os erros

em relação aos respectivos setpoints. Assim, para a variável controlada i no instante

futuro j, o erro é definido como:

[ ] [ ]e y yi k j k
k

sp i k j k
k

i, ,+ +
= ?

sendo:

isp
y  - é o setpoint correspondente à variável controlada i

Podemos então definir um vetor de setpoints dado por:

[ ] [ ]e I y yk j k
k

ny sp k j k
k

+ += ?

sendo:

[ ] [ ]T
k

kjknyjk
k

kjk eee +++ = ,,1 L ; [ ]ek j k
k

ny
+

×? ? 1

[ ] [ ]T
k

kjknyjk
k

kjk yyy +++ = ,,1 L ; [ ]yk j k
k

ny
+

×? ? 1

[ ]y y ysp sp sp Tny= 1 L ; ysp ny? ? ×1

Para todos os instantes de predição futuros, temos:

[ ] [ ]
k

kspk
k yyNe ~

~
?= (8.12)

sendo:

[ ] [ ]Tnrkkkkk eeee +++= L21

[ ]y y ysp sp sp Tny= 1 L



Capítulo 8 - Algoritmos de controle 68

?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

=

10

01

10

01
10

01

~

L
MOM

L
MM

L
MOM

L
L

MOM
L

N ; nynr.nyN
~ ×??

8.1.2.3 – Algoritmo de controle preditivo

Os controladores de forma geral têm como principal objetivo minimizar os erros

das variáveis controladas com os menores movimentos das variáveis manipuladas.

No caso do controlador preditivo o objetivo é minimizar a seguinte função:

[ ] [ ] uueeJ T
k

k
T

k
kk ???+?= (8.13)

sendo:

[ ] [ ] uSee mkkkk ??= (8.14)

            [ ] [ ]Tnrkkkkk eeee +++= L21

?   é uma matriz de pesos para os erros nas variáveis controladas

?   é uma matriz de pesos para os movimentos das variáveis manipuladas

?
?
?
?

?

?

?
?
?
?

?

?

?

?
?

=?

L
MOMM

L
L

00

00
00

; nrnynrny .. ×???

? =

?

?

?
?
?

?

?

?
?
?

?

?

1 0

0

L
M O M

L ny

; ? ? ? ×ny ny



Capítulo 8 - Algoritmos de controle 69

?
?

?
=

?

?

?
?
?

?

?

?
?
?

L
M O M

L

0

0
; numnum .. ×???

?
?
?

?

?

?
?
?

?

?

=?

nu?

?

L
MOM

L

0

01
; nunu×???

Para solucionar o problema, devemos desenvolver o equacionamento da função

objetivo do controlador. Desta forma, podemos substituir a equação (8.14) em (8.13),

resultando em:

[ ]( ) [ ]( ) uuuSeuSeJ TmkkTmkkk ???+?????=
[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk

T
m

T

k
k

T

k
kk ??+??+???????=     (8.15)

Os algoritmos de controle preditivo convencionais se diferenciam na forma de

minimizar a função objetivo.

Como exemplo descreveremos os algoritmos: DMC, QDMC e MMPC

8.1.2.3.1 – Algoritmo DMC

O algoritmo DMC é o de abordagem mais simples, e se baseia no método dos

mínimos quadrados.

Sua função objetivo é dada pela eq. (8.15):

[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk
T
m

T

k
k

T

k
kk ??+??+???????=

Como os termos são todos escalares, podemos dizer que

[ ] [ ] uSeeSu m
T

k
k

k
k

T
m

T ??=??



Capítulo 8 - Algoritmos de controle 70

portanto:

[ ] [ ] [ ] ( ) uSSueSueeJ mTmTkk
T
m

T

k
k

T

k
kk ??+??+????= 2

O valor mínimo da função objetivo corresponde ao ponto onde a derivada da

função em relação ao ?u é zero, isto é:

?
?

J
u
k

?
= 0

Portanto:

[ ] ( ) uSSeS
u

J
m

T
mk

k
T
m

k ??+?+??=
?

22
?
?

como 
?
?

J
u
k

?
= 0 , portanto:

[ ] ( ) uSSeS mTmkk
T
m ??+?+??= 220

Isolando o termo em ?u, temos:

( ) [ ]
k

k
T
mm

T
m eSSSu ??+?=?

?1

Podemos escrever a equação do controlador na forma

[ ]?u K eMPC k k=

sendo:

( ) ??+?= ? TmmTmMPC SSSK
1

(8.16)

8.1.2.3.2 – Algoritmo QDMC

O algoritmo QDMC utiliza o método de otimização de programação quadrática

(QP) para encontrar a melhor solução para o problema de controle.

De forma compacta podemos representar o problema da programação quadrática

da seguinte maneira:



Capítulo 8 - Algoritmos de controle 71

Minimizar x Hx C x

sujeito a Ax b
x

u

T T

?
? = +

?
?

1
2

0

Para resolvermos o controlador por QP, partimos da função objetivo básica,

resultando numa forma equivalente à eq.(8.15):

[ ] [ ] [ ] ( ) uSSuuSeeeJ mTmTmT kkkk
T

k
kk ??+??+????= 2

O termo [ ] [ ]e ek
k

T
k

k
?  na função objetivo Jk é uma constante escalar. Neste caso,

podemos eliminar este termo da função sem alterar a sua solução final. Também

podemos dividir a função objetivo por 2 sem alterar a sua solução.

Assim, a função objetivo do QDMC pode ser apresentada da seguinte forma:

( ) [ ] uSeuSSu mT kkm
T
m

T ?????+??=?
2
1

(8.17)

De forma simplificada podemos representar ? como:

? ? ? ?= +
1
2

u H u C uT T

sendo:

?+?= m
T
m SSH

[ ] m
T

k
k

T SeC ??=

Na programação quadrática, podemos incluir restrições do tipo:

A u b? ?

Neste caso, pode-se incluir as seguintes restrições:



Capítulo 8 - Algoritmos de controle 72

1. Restrições de movimento das variáveis manipuladas

2. Restrições de limites das variáveis manipuladas

8.1.2.3.2.1 – Restrições de movimentos

Estas restrições podem ser apresentadas da seguinte forma:

maxmax uuu jk ?????? +

Para o caso ? ?u uk j+ ? max com  j = 1, 2, …, m, temos

max. uNuI unum ???

sendo:

?
?
?

?

?

?
?
?

?

?
=

nu

nu

u

I

I
N M ; nunumuN

×?? .

Para o caso ? ? +? ?u uk jmax  temos

? ?+? ?u uk j max

max. uNuI unum ????

compondo as duas condições, temos:

?
?

?
?
?

?
?
?

???
?

?
?
?

?
? max

max

.

.

uN
uN

u
I

I

u

u

num

num

8.1.2.3.2.2 – Restrições de limites

As restrições de limites podem ser apresentadas da seguinte forma:



Capítulo 8 - Algoritmos de controle 73

u u umin max? ?

como:

u
u

u

I
I I

I I I

u
u

u

u
u

u

k

k

k m

nu

nu nu

nu nu nu

k

k

k m

k

k

k

+

+ ?

+

+ ?

?

?

?

?

?

?
?
?
?

?

?

?
?
?
?

=

?

?

?
?
?
?

?

?

?
?
?
?

?

?

?
?
?
?

?

?

?
?
?
?

+

?

?

?
?
?
?

?

?

?
?
?
?

1

1

1

1

1

1

1

0 0
0

M

L
L

M M O M
L

M M

?
?

?

ou

1?+?= ku uuNu

Para o caso u u? max

max1 uuuN ku ?+? ?

1max ???? ku uuuN

Para o caso u umin ?

1min ?+?? ku uuNu

min1 uuuN ku ???? ?

compondo as duas condições, temos:

?
?

?
?
?

?
?
?

???
?

?
?
?

?
? ?

?

min1

1max

uu
uu

u
N

N

k

k

u

u

compondo todas as restrições, temos:

?
?
?
?

?

?

?
?
?
?

?

?

?
?

?
?

??

?
?
?
?

?

?

?
?
?
?

?

?

?

?

?

?

min1

1max

max

max

.

.

uu
uu

uN
uN

u

N
N

I
I

k

k

u

u

u

u

num

num

Portanto:

A u b? ?

sendo:



Capítulo 8 - Algoritmos de controle 74

?
?
?
?

?

?

?
?
?
?

?

?

?

?
=

u

u

num

num

N
N

I
I

A .
.

;

?
?
?
?

?

?

?
?
?
?

?

?

?
?

?
?

=

?

?

min1

1max

max

max

uu
uu

uNu

uNu

b

k

k

8.2 – MPC com modelo de ordem reduzida

Os MPC´s convencionais necessitam de todos os estados do processo até o

estado estacionário, para poder representar corretamente as previsões das variáveis

controladas. Algumas tentativas de reduzir a quantidade de estados foram apresentadas

por Hovd et al. (1993), que propõem truncar o modelo de convolução antes de atingir o

estado estacionário e Li et al. (1989) que transformam um modelo não paramétrico em

um modelo em espaço de estado.

Entretanto, uma solução inovadora de redução de ordem do modelo foi proposta

por Odloak (1996) e Gouvêa e Odloak (1997), na qual o modelo de estado é obtido a

partir de um modelo de função de transferência.

8.2.1 – Modelo de função de transferência

Os modelos do processo, originalmente eram representados através das respostas

das variáveis controladas a degraus nas variáveis de entrada (manipuladas e

perturbações medidas). Obtinham-se estes modelos através do ajuste dos dados de um

teste na planta a um modelo do tipo FIR (Finite Impulse Response).

Os processos químicos contínuos quando próximos de suas condições normais

de projeto são normalmente bem representados por modelos lineares do tipo função de

transferência. Conforme Ljung (1987) seria interessante fazer uma representação do

processo através de modelos paramétricos de ordem reduzida. Portanto, para um sistema

multivariável, a relação dinâmica entre a i-ésima variável controlada (ou saída) e a j-

ésima variável manipulada (ou entrada), pode ser colocada na forma:

( )
( )

( )
jie

sa

sb
sG

ji

ji
ji

,s

,

,
, 1

??

+
=



Capítulo 8 - Algoritmos de controle 75

sendo:

( ) ji,
,

nb
nb,,1,,0,,, sbsbbsb jijijijiji +++= L

( ) ji
ji
sasasa jijiji

,

,

na
na,,1,,, ++= L

?i,j - tempo morto

nbi,j - ordem do polinômio bi,j(s)

nai,j - ordem do polinômio ai,j(s)

Os parâmetros relativos aos polinômios ai,j(s) e bi,j(s) podem ser agrupados.

Desta forma, podemos representar os parâmetros do modelo da seguinte forma:

[ ]
j,ina,j,i2,j,i1,j,ij,i

aaaa L=

[ ]
j,inb,j,i1,j,i0,j,ij,i

bbbb L=

O sistema na forma multivariável, tem genericamente ny variáveis controladas e

nu variáveis manipuladas e o modelo do sistema completo pode ser representado pela

seguinte matriz de transferência:

( ) ( ) ( )susGsy ?? =
sendo:

( ) ( ) ( )[ ]Tsysysy
ny

???
1

L=

( ) ( ) ( )[ ]Tnu sususu ??? 1 L=

( )
( ) ( )

( ) ( )
G s

G s G s

G s G s

nu

ny ny nu

=

?

?

?
?
?

?

?

?
?
?

1 1 1

1

, ,

, ,

L
M

L

No caso multivariável, é conveniente agrupar todos os parâmetros do modelo da

seguinte forma:

 ( )
( ) ( )

( ) ( )?
?
?

?

?

?
?
?

?

?

=
ss

ss
s

nu,ny1,ny

nu,11,1

aa

aa
a

L
M

L
; ( )

( ) ( )

( ) ( )?
?
?

?

?

?
?
?

?

?

=
ss

ss
s

nu,ny1,ny

nu,11,1

bb

bb
b

L
M

L



Capítulo 8 - Algoritmos de controle 76

( )
( ) ( )

( ) ( )
?

? ?

? ?
s

s s

s s

nu

ny ny nu

=

?

?

?
?
?

?

?

?
?
?

1 1 1

1

, ,

, ,

L
M

L

Os algoritmos de controle aqui utilizados, usam internamente modelos de

resposta ao degrau em malha aberta. Portanto, aplicando um degrau unitário em ?u(s),

para cada par ij, temos:

( ) ( ) ( )susGsy jjid ji ?=? ,,
sendo:

( )?u s
sj

=
1

Na forma explícita, temos a seguinte função correspondente à resposta ao degrau

unitário:

( ) ( )
ji

ji

s

na
najiji

nb
nbjijiji

d e
sasas

sbsbb
sy ,

,

,,1,,

,,1,,0,,

1
??

+++

+++
=?

L

L

Assumindo que o denominador não tenha raízes múltiplas, o que é razoável, pois

em processos químicos dificilmente temos sistemas com constantes de tempo repetidas.

Por conveniência, as raízes de 1+ai,j(s) são representadas como:

[ ]r r ri j i j i j na
T

, , , , ,= 1 L
1

,
×? najir C

A resposta ao degrau do sistema pode então ser fatorada, obtendo-se a seguinte

expressão:

( )
( )

( )( ) ( )
ji

ji
e

rsrsrss

b
sy

najijiji

ji
d

,

,

s?

,,2,,1,,

,

s

s ?
???

=
L



Capítulo 8 - Algoritmos de controle 77

O termo repetido em “s” indica a presença de características integradoras no

processo.

Separando a resposta ao degrau unitário em frações parciais, temos:

( ) jijijiji
ji

snajis

naji

najis

ji

jisji
d e

s

c
e

rs

c
e

rs

c
e

s

c
sy ,,,,

, 2
,,

1,,

1,,

1,,

1,,0,, ???? ??

?

??? +
?

++
?

+= L

sendo:

( ) ( )( )( ) ( )na,j,i2,j,i1,j,i
j,i

g,j,ig,j,i
g,j,i

lim
rsrsrss

sb
rsc

rs ???
?=

? L

Transformando a expressão da resposta ao degrau para o domínio do tempo

temos a seguinte forma geral:

( ) ( ) ( ) ( )jinajitrnajitrjijid tcececcty jinajijijiji ,,,1,,1,,0,, ,1,,,1,,, ?
?? ?++++= ???

?? ?L

(8.18)

Simplificando a expressão (8.18), temos:

( ) ( ) ( )jinaji
na

g

tr
gjid tcecty

jigji

ji ,,,

1

0
,,

,,,

,
?? ?+= ?

?

=

??
(8.19)

Os coeficientes da resposta ao degrau do sistema podem ser obtidos a partir da

eq. (8.19):

( ) ji
na

g
gjigjijinji

jinji

nTnTfccs

nTs

,
1

,,,,0,,,,

,,, 0

?

?

??+=

??=

?
=

(8.20)

sendo:

n - instante de amostragem

( )
( ) ( )

( ) 0
0

1

,,,,,

,,,,

0,,

,,,

=??=

??=

=
??

gjijigji

gji
tr

gji

ji

rttf

retf

tf
jigji

?

?



Capítulo 8 - Algoritmos de controle 78

Para o sistema multivariável é conveniente agrupar os parâmetros do modelo da

seguinte forma:

?
?
?

?

?

?
?
?

?

?

=

0,,0,1,

0,,10,1,1

0

nunyny

nu

cc

cc
C

L
MM

L
C ny nu0 ? ?

× (8.21)

?
?
?

?

?

?
?
?

?

?

=

nunyny

nu

cc

cc
C

,1,

,11,1

L
MM

L
nanunyC .×? C (8.22)

                                                               ]...[ naj,i,j,2i,j,1i,ji, cccc =

r0

0 0

0 0
=

?

?

?
?
?

?

?

?
?
?

L
M M

L
r ny nu0 ? ?

× (8.23)

?
?
?

?

?

?
?
?

?

?

=

nunyny

nu

rr

rr
r

,1,

,11,1

L
MM

L
nanunyr .×? C (8.24)

                                                              ]...[ naj,i,j,2i,j,1i,ji, rrrr =

A resposta ao degrau é representada por:

?
?
?

?

?

?
?
?

?

?

=

nnunynny

nnun

n

ss

ss
S

,,,1,

,,1,1,1

L
MM

L
Sn

ny nu? ? ×

8.2.2 – Predição com modelos paramétricos

Para um processo qualquer, podemos representar a predição da variável

controlada da seguinte forma:

[ ] [ ]y y s ui k n k
k

i k n k
k

i j n j k
j

nu

, , , , ,+
?

+ ?
?

?
=

= + ?
1

1
1

1
1

? (8.1)



Capítulo 8 - Algoritmos de controle 79

Podemos substituir si,j,n  da eq. (8.20) na equação (8.1), obtendo:

[ ] [ ] ( )y y c f nT ui k n k
k

i k n k
k

i j g i j g j k
g

na

j

nu

, , , , , , ,+
?

+ ?
?

?
==

= + ??
1

1
1

1
01

?

Separando os termos independentes dos dependentes do tempo, temos:

[ ] [ ] ( )y y c u c f nT ui k n k
k

i k n k
k

i j j k
j

nu

i j g i j g j k
g

na

j

nu

, , , , , , , , , ,+
?

+ ?
?

?
=

?
==

= + +? ??
1

1
1

0 1
1

1
11

? ?

(8.25)

A equação (8.25) nos induz a supor que a equação da predição pode ser reescrita

da seguinte forma:

[ ] [ ] [ ] ( )? ?
= = ?

?
?

?
?

+ +=
nu

j
gji

na

g k
kgji

k
ki

k
knki nTfppy

1
,,

1 1
1,,

1
1

1
,   (8.26)

? &gt;n nT
i

ij| max?

sendo:

[ ] [ ]p e pi k
k

i j g k
k

?
? ? ?

1
1 1 1

, ,   os parâmetros dessa nova representação.

Considerando apenas sistemas não integradores e usando a definição de fi,j,g em

(8.26), temos:

[ ] [ ] ( )? ??
= =

?
=

?
?

?++
?

+ ?+?+=
nu

j

na

g
kjgji

Tr
gji

nu

j
kjji

k
knki

k
knki unTfecucyy

gji

1 1
1,,,,,

1
1,0,,

1
11,

1
,

,,

(8.27)

como:

[ ] [ ] [ ] ( )( )? ?
= = ?

?
?

?
?

?++ ++=
nu

j
gji

na

g k
kgji

k
ki

k
knki Tnfppy

1
,,

1 1
1,,

1
1

1
11, 1

ou



Capítulo 8 - Algoritmos de controle 80

[ ] [ ] [ ] ( )? ?
= = ?

?
?

?
?

?++ +=
nu

j
gji

Tr
na

g k
kgji

k
ki

k
knki nTfeppy

gji

1
,,

1 1
1,,

1
1

1
11,

,, (8.28)

substituindo (8.28) na equação (8.27) , temos:

[ ] [ ]

[ ] ( )? ?

?

= =
?

?
?

=
?

?
?

?
+

?
?
??

?
? ?++

+?+=

nu

j

na

g
gjikj

Tr
gji

Tr

k
kgji

nu

j
kjji

k
ki

k
knki

nTfuecep

ucpy

gjigji

1 1
,,1,,,

1
1,,

1
1,0,,

1
1

1
,

,,,,

(8.29)

Daí a eq. (8.29) pode ser reescrita como:

[ ] [ ] [ ] ( )? ?
= = ?

??
+ +=

nu

j
gji

na

g k
kgji

k
ki

k
knki nTfppy

1
,,

1 1
,,

11
,

sendo:

[ ] [ ] ?
=

?
?

?
?

?+=
nu

j
kjji

k
ki

k
ki ucpp

1
1,0,,

1
1

1
(8.30)

[ ] [ ] 1,,,
1

1,,
1

,,
,,,,

?
?

?
?

?+= kj
Tr

gji
Tr

k
kgji

k
kgji uecepp

gjigji

fazendo  d ei j g
r Ti j g

, ,
, ,= , temos:

[ ] [ ] 1,,,,,
1

1,,,,
1

,, ?
?

?
?

?+= kjgjigji
k

kgjigji
k

kgji udcpdp (8.31)

As equações (8.30) e (8.31) são as equações que atualizam os parâmetros da

equação (8.26), que foi proposta para a predição das variáveis controladas.

Vamos procurar agora uma forma vetorial para a equação (8.26), que pode ser

escrita como:

[ ] [ ] [ ] ( ) [ ] ( ){ }?
= ??

??
+ +++=

nu

j
i,j,na

k
ki,j,nai,j,

k
ki,j,

k
ki

k
kni,k nTfpnTfppy

1 1
111

1
11

L

[ ] [ ] [ ] ( ) [ ] ( ){
[ ] ( ) [ ] ( )}nTfpnTfp

nTfpnTfppy

nanui
k

knanuinui
k

knui

nai
k

knaii
k

ki
k

ki
k

knki

,,
1

,,1,,
1

1,,

,1,
1

,1,1,1,
1

1,1,
11

,

??

????
+

+++

+++++=

L

LL

(8.32)



Capítulo 8 - Algoritmos de controle 81

Escrevendo a eq. (8.32) para i = 1, 2,…,ny, temos:

[ ] [ ] [ ] ( ) [ ] ( )

[ ] ( ) [ ] ( )

[ ] [ ] [ ] ( ) [ ] ( )

[ ] ( ) [ ] ( )
?
?
?+++

?
?
? +++++=

?
?
?+++

?
?
? +++++=

??

????
+

??

????
+

nTfpnTfp

nTfpnTfppy

nTfpnTfp

nTfpnTfppy

nanu,ny,nanu,ny,nu,1ny,nu,1ny,

nany,1,nany,1,ny,1,1ny,1,1nynkny,

nanu,1,nanu,1,nu,11,nu,11,

na1,1,na1,1,1,1,11,1,11nk1,

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

1k
k

L

LL

M

L

LL

Vetorialmente temos:

[ ] [ ] [ ]
111 ???

+ += kk
t

nk
k

i

k
knk ppy ? (8.33)

sendo:

[ ] [ ] [ ]
T

k
knkny

k
knk

k
knk yyy ??

?
??
?=

?
+

?
+

?
+

1
,

1
,1

1
L [ ] 1

1

×

?
+ ??

ny

k
knky

[ ] [ ] [ ]
T

k
kny

k
k

k
k

i ppp
??
?

??
?=

??? 11
11

L [ ] 1
1

×

?
?? ny

k
k

ip

[ ] [ ] [ ] [ ] [ ]

[ ] [ ] [ ] [ ] [ ] 1..
11

,,
1

1,,
1

,1,
1

1,1,

1
,,1

1
1,,1

1
,1,1

1
1,1,11

×

?????

?????

????
?

??
?=

nanuny

k
k

t
T

k
knanuny

k
knuny

k
knany

k
kny

k
knanu

k
knu

k
kna

k
k

k
k

t

ppppp

ppppp

LLL

LLLL

( )
( )

( )

? n

ny

f n
f n

f n

=

?

?

?
?
?
?
?

?

?

?
?
?
?
?

1

2

0 0
0 0

0 0

L
L

M M O M
L

; ? n
ny ny nu na? ? × . . (8.34)

sendo

( ) ( ) ( ) ( ) ( )[ ]f n f n f n f n f ni i i na i nu i nu na= , , , , , , , ,1 1 1 1L L L     nyi ,,2,1 L=

Escrevendo a eq. (8.30) para i = 1, 2,…,ny, temos:



Capítulo 8 - Algoritmos de controle 82

[ ] [ ] 1111 ???? ?+= kokk
i

k
k

i uCpp (8.35)

Analogamente, a eq. (8.31) para i = 1, 2,…,ny, leva à seguinte relação:

[ ] [ ] 1111 ???? ?+= kpkk
t

k
k

t uCDNpDp (8.36)

sendo:

( )D d d d d d d d dna nu nu na ny ny na ny nu ny nu na= 1 1 1 1 1 1 1 1 1 1 1 1, , , , , , , , , , , , , , , ,L L L L L L L
D ny nu na ny nu na? ? ×. . . .

( )C c c c c c c c cna nu nu na ny ny na ny nu ny nu na= 1 1 1 1 1 1 1 1 1 1 1 1, , , , , , , , , , , , , , , ,L L L L L L L
nanunynanunyCC .... ×?

N
J

J
Jp

ny

i=

?

?

?
?
?

?

?

?
?
?

=

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?

1

1 0 0

1 0 0
0 1 0

0 1 0

0 0 1

0 0 1

M

L
M M M

L
L

M M M
L

M
L

M M M
L

J

N

i
nu na nu

p
ny nu na nu

? ?

? ?

×

×

.

. .

8.2.3 – Cálculo das predições das variáveis controladas

Para que a ordem do modelo seja reduzida é necessário que se reduza o número

de estados utilizados para o cálculo das predições das variáveis controladas.

Para modelos paramétricos, o vetor de predições tem duas partes com

características diferentes. A primeira parte é idêntica ao caso em que se usa modelos de

convolução (item 8.1) e a segunda parte que utiliza o modelo paramétrico em instantes



Capítulo 8 - Algoritmos de controle 83

previamente definidos, que normalmente estão distribuídos em instantes de tempo

esparsos.

Uma vantagem direta desta abordagem é a redução substancial das dimensões do

vetor da predição e da matriz de transição de estado (M), onde, também podemos incluir

instantes bem distantes e as predições no estado estacionário.

As mesmas etapas utilizadas para o cálculo das predições com modelos não

paramétricos, feitas no parágrafo 8.1.1, são utilizadas no cálculo das predições com

modelos paramétricos. Nos próximos itens apresentaremos as alterações feitas nos

cálculos das predições com a utilização de modelos de ordem reduzida.

8.2.3.1 – Efeito da última ação de controle

O vetor das predições das variáveis controladas é composto de duas partes:

1)  Parte referente ao tempo morto, onde a variável controlada não sofre o efeito

do ?uk -1, ou instantes em que se deseja intervalos de tempo sucessivos acima

do tempo morto, ou seja:

s nTi j n i j, , ,= ? ?0 ?

A parte do vetor de predições das saídas, dentro do tempo morto, tem a mesma

estrutura que o caso convencional apresentada em (8.1).

2)  Parte onde ?uk -1 afeta os valores das predições, que pode ter uma estrutura

diferente, por exemplo, considerando instantes de tempo esparsos.

Na definição dos instantes das predições deve-se considerar a existência dessas 2

partes. Assim, os instantes até o maior tempo morto mais um período de amostragem

devem ser seqüenciais, ou seja:

?
?
?

?
?
?

?
?
?

?
?
?= Tn

ji

ji

,

,
0 intmax

?



Capítulo 8 - Algoritmos de controle 84

Após o instante n0, as predições podem ser calculadas em instantes esparsos.

Entretanto, em todos os instantes desejados, elas podem ser corrigidas com a última

ação de controle da seguinte forma:

[ ] [ ]y y S uk
k

k
k

k
?

?
?

?= +
1

1
1

1? (8.37)

sendo:

[ ] [ ] [ ] [ ] [ ] [ ]
T

T
nk

T
nk

T
nk

T
k

T
kk

k
k

kh
k

k
k

kk
k

k
k

yyyyyy ?
?
?

?
?
?

=
?

?
?

?
?

??
?

?
? +++++?

?
1

1
1

11
1

101
1

1
1 211

1 LL

[ ] [ ] [ ] [ ] [ ] [ ]
T

T
nk

T
nk

T
nk

T
k

T
kk

k
k

kh
k

k
k

kk
k

k
k

yyyyyy ?
?
?

?
?
?

=
?????

+++++?
11

1
1

0
11

211
LL

[ ]? ? ?u u uk k nu k
T

? ? ?=1 1 1 1, ,L

[ ]TTTTTT
hnnn

SSSSSS LL
101

2=

sendo:

np - número de instantes de predição

np = n0 + h

n0  - números de instantes seqüenciais

h  - número de instantes esparsos

8.2.3.2 – Correção das predições com as leituras da planta

Com o efeito da última ação de controle calculado, devemos corrigir as predições

através da leitura das variáveis controladas. Para o cálculo dessa correção, utilizamos

apenas os termos correspondentes ao instante k+1 do vetor de predições da mesma

forma da abordagem utilizada na predição com modelos não paramétricos, porém as

dimensões da matriz N são diferentes, ou seja:

[ ] [ ]y N yk k
k

k
k

+
? ?

=1
1 1

(8.38)



Capítulo 8 - Algoritmos de controle 85

sendo:

N =

?

?

?
?
?
?

?

?

?
?
?
?

1 0 0 0 0
0 1 0 0 0

0 0 1 0 0

L L
L L

M M O M M M
L L

; ( )nanunpnynyN .1++×??

Para as predições através de modelos paramétricos, as correções das predições

com as leituras da planta são efetuadas da seguinte forma:

[ ] [ ] [ ] ( ) i,k
nu

j
i,j,g

na

g k
ki,j,g

k
ki

k-
k

c wnTfppy
ni,k

++= ? ?
= = ?

?+
1 1 1

11

como wi,k não é função do tempo, a correção só é aplicada ao valor de [ ]
1k

kip
?

.

Portanto, a correção dos parâmetros fica da seguinte forma:

 [ ] [ ] i,k
nu

j
j,ki,j,

k
ki

k
k

c
i wucpp ++= ?

=
?

?
?

?
1

10
1

1
1

?

[ ] [ ] 1
1

1
1

? ?
?

?
?

+= j,k
Tr

i,j,g
Tr

k
ki,j,g

k
k

c
i,j,g uecepp

i,j,gi,j,g

Como no controlador convencional, podemos corrigir o desvio da predição em

relação à leitura da planta utilizando uma matriz K com dimensões relativas ao novo

vetor de predições, portanto a nova correção é apresentada como:

[ ] [ ] kkkkk
c KWyy +=

?? 11
(8.39)

sendo:



Capítulo 8 - Algoritmos de controle 86

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

=

000

000

100

001

100

001
100

010
001

L
MMM

L
MMM

L
MMM

L
MMM

L
MMM

L
L

MOMM
L
L

K

8.2.3.3 – Translação da predição corrigida

As predições das variáveis controladas estão atualizadas e corrigidas para o

instante k. Isto significa que:

[ ]yi kc k
k

, +
?

2
1
 - corresponde ao instante atual k+1

[ ]yi kc k
k

, +
?

3
1
 - corresponde ao instante futuro k+2

      M

[ ]yi k nc k
k

k, + +
?

1
1
 - corresponde ao instante futuro k+nk

Portanto, dentro da filosofia dos controladores preditivos, que apresentam um

horizonte móvel, é necessário fazer a translação de um instante de tempo em todo vetor

de predições e para todas as variáveis controladas.



Capítulo 8 - Algoritmos de controle 87

[ ] [ ]

[ ] [ ]
[ ] [ ]

[ ] [ ]

[ ] [ ]

[ ] [ ]
1

1

1
111

1
32

1
3121

1
21

1
2111

k-
k

c
nny,k

k
knny,k

k-
k

c
n,k

k
kn,k

k-
k

c
ny,k

k
kny,k

k-
k

c
,k

k
k,k

k-
k

c
ny,k

k
kny,k

k-
k

c
,k

k
k,k

yy

yy

yy

yy

yy

yy

kk

+++

+++

++

++

++

++

=

=

=

=

=

=

M

M

M

M

para     n ?  no

sendo: no ?  máx ?i,j

Para n &gt; no usamos a eq. (8.33), assim temos:

[ ] [ ] [ ]
k

k
t

k
k

i

k
k1nk ppy 1n+++ ?+=

Para os instantes esparsos temos:

[ ] [ ] [ ]
[ ] [ ] [ ]

[ ] [ ] [ ]
k

k
t

k
k

i

k
knk

k
k

t

k
k

i

k
knk

k
k

t

k
k

i

k
knk

ppy

ppy

ppy

k

2

1

1n

1n

1n

k

2

1

++

++

++

?+=

?+=

?+=

M

Para os parâmetros da predição não temos a operação de translação, ou seja:

[ ] [ ]
k

k
c

gj,i,
k

kgj,i, pp =

[ ] [ ]
k

k
c
i

k
ki pp =           

na  ,. . 1,.  g
nu  ,. . 1,. j 
ny  ,. . . 1,  i

=
=
=



Capítulo 8 - Algoritmos de controle 88

Juntando as operações de translação, efeito da última ação de controle e correção

da predição temos:

[ ] [ ] KWuSyMy k
1-k

1-k
k

k +?+= ?1 (8.40)

sendo:

 [ ]
[ ] [ ] [ ] [ ] [ ]

[ ] [ ] [ ] [ ]

T

k
k

t
k

k
i

k
knk

k
knk

k
knkk

knk
k

k1nk
k

k2k
k

k1k

k
k

ppyy

yyyyy

y
h2

1

?
?
?

?

?

?
?
?

?

?
=

++

++?+++

L

L

....

...

[ ] ( ) 1nu.na1npny
k

ky
×++??

sendo  np = n0 + h

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

=

+

+

+

+

D
I
I

I
I
I

I

I
I

M

ny

nny

nny

nny

nny

ny

ny

ny

h

000000000
000000000

00000000

00000000
00000000
00000000

000000000

000000000
000000000

1

1

1

1

2

1

0

LL
LL
LL

MMMOMMMMOMMM
LL
LL
LL
LL

MMMOMMMMOMMM
LL
LL

?

?
?
?

( ) ( )M ny np nu na ny np nu na? ? + + × + +1 1. .

[ ]TpTTnTnTnTnTnTT CDNCSSSSSSSS k 0111132 2100 ++++= LL
( )S ny np nu na nu? ? + + ×1 .

A matriz M fornece a translação para instantes de tempo seqüências e esparsos.



Capítulo 8 - Algoritmos de controle 89

8.2.4 – Cálculo das ações de controle

O algoritmo de controle preditivo com modelo paramétrico calcula as ações de

controle da mesma forma descrita anteriormente, alterando apenas a construção das

matrizes envolvidas. As etapas do algoritmo passam a ter a seguinte forma:

8.2.4.1 – Trajetória referência das variáveis controladas

Com a utilização dos modelos de estado (paramétrico), é necessário calcular as

predições somente nos instantes em que o controlador irá minimizar o erro. Neste caso,

o horizonte de predição (np) se confunde com o horizonte de otimização (nr).

Com as predições em tempos esparsos, os instantes de predição podem ser

diferentes para cada uma das variáveis controladas. Isto é, se tivermos k instantes

esparsos, o vetor de instantes esparsos para a variável j pode ser dado por:

[ ]t t t tj j j j k= , , ,1 2 L

A predição transferida de um instante de amostragem para outro é da forma:

[ ] [ ]
k

k
Tti

nhknknkkkk
k ppyyyyyy +++++= LL 1021  (8.41)

sendo:

[ ]y y yk i k i ny k i
T

+ + += 1, ,L

n0   - número de instantes de predição seqüenciais.

h   - número de instantes esparsos das predições ( np – n0 )

As predições das variáveis controladas são alteradas pelas ações de controle em

cada instante futuro. Desta forma, quando aplicamos “m” ações de controle, temos:



Capítulo 8 - Algoritmos de controle 90

[ ] [ ]
[ ] [ ]

[ ] [ ]

[ ] [ ]
[ ] [ ] 10100

1111

1111

11222

111

?++

?++?+?++

?++?++

+++

++

?++?+?+=

?++?+?+=

?++?+?+=

?+?+=

?+=

mkkkk
k

i

k
k

i

mkmnkknkknk
k

knpk
k

knkk

mkkmkm
k

kmk
k

kmk

kk
k

kk
k

kk

k
k

kk
k

kk

uCuCuCpp

uSuSuSyy

uSuSuSyy

uSuSyy

uSyy

L

L
M

L
M

Vetorialmente, temos:

[ ] [ ] uSyy m
k

k
k

k ?+=

sendo:

[ ] [ ]T
k

k
i

nkkmk2k1k
k

k pyyyyy ++++= LL

[ ]Tmuuu ??=? L1

?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?

?

?

=

+??

?

000

1mnk1nknk

11mm

12

1

m

CCC
SSS

SSS

0SS
00S

S

L
L

MMM
L

MMM
L
L

sendo:

m - número de ações de controle futuras calculadas pelo controlador,

  conhecido como horizonte de controle

8.2.4.2 – Cálculo dos erros das variáveis controladas

Como visto para o MPC com modelo não paramétrico, no cálculo dos erros em

relação aos respectivos setpoints, temos:



Capítulo 8 - Algoritmos de controle 91

[ ] [ ]
k

kjksp
k

kjk yye ++ ?=

 Na eq. (8.41), o vetor de predições inclui os parâmetros pi e pt da equação de

predição (8.26). Assim, o vetor ysp deve incluir os valores correspondentes aos setpoints

desses parâmetros. Pela eq. (8.26), se o sistema for estável em malha aberta, então:

[ ] [ ]
1

1
1

lim
?

?
?

+
??

=
k

k
i

k
knk

n
py

Assim, para pi o setpoint é o mesmo das variáveis controladas.

Resumindo, podemos representar o erro nas variáveis controladas e parâmetros

como:

[ ] [ ]
k

ksp
k

k yNye ?= (8.42)

sendo:

[ ] [ ]Tknknknk2k1kkk eeeeeee k1 ?++++++= LL

[ ]
k

k
ipye spk ?=?+

[ ]y y ysp sp sp Tny= 1 L
[ ] [ ]Ttinknknkkk

k
k ppyyyyyy

k+++++
= LL

121



Capítulo 8 - Algoritmos de controle 92

N =

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?
?

1 0

0 1
1 0

0 1

1 0

0 1
1 0

0 1
0 0

0 0

L
M O M

L
L

M O M
L

M M
L

M O M
L
L

M O M
L
L

M O M
L ;

( )N ny np nu na ny? ? + + ×1 .

8.2.5 – Algoritmo de controle preditivo

No caso do controlador preditivo multivariável (MPC)  com modelos de ordem

reduzida, temos para o erro após as ações a mesma expressão que foi usada no item 8.1.2.3:

[ ] [ ] uSee mkkkk ??= (8.14)

porém os vetores [ ]
k

ke , e [ ]
k

ke  e a matriz Sm são definidas de forma diferente conforme

apresentada na seção anterior.

Os algoritmos de controle apresentados anteriormente podem também utilizar essa

nova formulação.

8.2.5.1 – MMPC (Multi-Model Predictive Control)



Capítulo 8 - Algoritmos de controle 93

Descreveremos agora uma nova formulação do controlador preditivo onde vários

modelos do processo são simultaneamente considerados. O problema de controle resultante

é então resolvido usando a formulação da programação não-linear (NLP) utilizando o

algoritmo tipo SQP (sequential quadratic programming) proposto por K. Schittkowski

(1985).

Os controladores multi-modelos procuram resolver o problema de controle preditivo

com sistemas variantes no tempo e no estado, isto é, têm uma faixa de operação mais ampla

do que os controladores convencionais, em função das não-linearidades presentes no

processo. O problema de controle é resolvido através da utilização de um conjunto de

modelos, onde se descreve os diversos comportamentos do processo ao longo da região de

operação do controlador.

8.2.5.1.1 – Algoritmo MMPC

O MMPC foi desenvolvido por Almeida Neto (1999) utilizando uma formulação

baseada em LMI’s (Linear Matrix Inequalities). Entretanto, não temos disponível nenhum

pacote computacional para implementar essa solução em sistemas industriais. Assim, neste

trabalho foi desenvolvida uma solução que possa ser implementada com os pacotes de

programação não-linear disponíveis. Para tal considere a função objetivo do controlador

representada pela equação (8.15):

[ ] [ ] [ ] [ ] ( ) uSSuuSeeSueeJ mTmTmT kkkk
T
m

T

k
k

T

k
kk ??+??+???????=    (8.15)

Considerando que Jk seja sempre menor do que um limite positivo ?, podemos

representar o objetivo  na forma:

J k ? ? ou ? ? ?J k 0

ou

[ ] [ ] [ ] [ ] ( ) 0???+?????+??+?? uSSuuSeeSuee mTmTmT kkkk
T
m

T

k
k

T

k
k?



Capítulo 8 - Algoritmos de controle  94

Dai, o problema que o MPC resolve pode ser colocado na forma:

                         (8.43)

que é um problema de otimização com função objetivo linear e restrições quadráticas,

portanto um problema não-linear, que não pode ser resolvido com os pacotes

computacionais de programação linear (LP) ou quadrática (QP).

8.2.5.1.2 – Representação de incertezas do sistema

Em geral, o modelo do processo varia ao longo do tempo, pois características como:

vazão de carga e produtos, composição da carga e produtos, pressão de operação, sujeira de

trocadores de calor variam no tempo. Estas incertezas podem ser incorporadas ao problema

de controle através da utilização de vários modelos, sendo estes modelos colocados como

novas restrições a serem obedecidas pelo controlador, estas novas restrições seriam da

forma:

[ ] [ ] [ ] [ ] ( )
[ ] [ ] [ ] [ ] ( )

[ ] [ ] [ ] [ ] ( ) 0

0

0

2222

1111

???+?????+??+??

???+?????+??+??

???+?????+??+??

uSSuuSeeSuee

.

.

uSSuuSeeSuee

uSSuuSeeSuee

m,L
T
m,L

T
m,L

T

k
k

k
k

T
m,L

T

k
k

T

k
k

m,
T
m,

T
m,

T

k
k

k
k

T
m,

T

k
k

T

k
k

m,
T
m,

T
m,

T

k
k

k
k

T
m,

T

k
k

T

k
k

?

?

?

onde Sm,1 . . . . Sm,L  correspondem aos modelos obtidos em diferentes condições

operacionais.

L – é o número de modelos alternativos do processo

[ ] [ ] [ ] [ ] ( )

0
0

0

0

max

min

???
???

?

???+?????+??+??

+?

?

?

uu
uu

uSSuuSeeSueea:sujeito

u
Minimizar

m
T
m

T
m

T

k
k

k
k

T
m

T

k
k

T

k
k

,

?

?

?
?



Capítulo 8 - Algoritmos de controle 95

Nessa formulação, o problema do MMPC pode ser representado na seguinte forma:

(8.44)

Observe que o problema acima tem função objetivo linear e restrições quadráticas e

portanto é um problema de NLP. Na planta industrial o controlador MMPC definido pelo

problema é resolvido com um solver comercial baseado em SQP (K. Schittkowski , 1985).

Neste trabalho não se buscou investigar qual seria o solver mais adequado para o problema

do MMPC, que tem uma estrutura particular e talvez não a mais adequada para algoritmo

tipo SQP. Em sistemas de grande porte essa consideração pode se tornar importante.

[ ] [ ] [ ] [ ] ( )
[ ] [ ] [ ] [ ] ( )

[ ] [ ] [ ] [ ] ( )

[ ] [ ] [ ] [ ] ( )

0
0

0

0

0

0

0

max

min

2222

1111

???
???

?

???+?????+??+??

???+?????+??+??

???+?????+??+??

???+?????+??+??

?

+?

?

uu
uu

uSSuuSeeSuee                    

 .                    
 .                    

uSSuuSeeSuee                    

uSSuuSeeSuee                     

uSSuuSeeSueea:sujeito

,u
Minimizar

m,L
T
m,L

T
m,L

T

k
k

k
k

T
m,L

T

k
k

T

k
k

m,
T
m,

T
m,

T

k
k

k
k

T
m,

T

k
k

T

k
k

m,
T
m,

T
m,

T

k
k

k
k

T
m,

T

k
k

T

k
k

m
T
m

T
m

T

k
k

k
k

T
m

T

k
k

T

k
k

?

?

?

?

?

?
?



96

9

APLICAÇÃO DO MPC À COLUNA DEPROPANIZADORA

O algoritmo DMC em sua formulação tradicional apresenta algumas limitações

que devem ser consideradas durante o projeto de controle. As limitações básicas são:

ü Utilização de modelos de convolução discretos, que se constituem de uma seqüência

de coeficientes que correspondem aos valores da resposta ao degrau unitário em

instantes de amostragem sucessivos. Este fato faz com que o número de coeficientes

da resposta ao degrau leve a uma limitação computacional devido à dimensão do

problema, quando temos dinâmicas do processo muito lentas. Podemos contornar o

problema utilizando algumas opções como: forçar o modelo a estabilizar no

horizonte desejado, o que provoca um desvio em relação à planta; truncar o modelo

do processo, tendo um modelo incompleto em relação à resposta da planta; ou

aumentar o período de amostragem, podendo perder alguma informação importante

entre duas amostragens sucessivas. Além disso fica muito difícil conciliar modelos

com dinâmicas rápidas e lentas com o mesmo número de coeficientes da resposta ao

degrau.

ü Com a limitação do número de coeficientes do modelo, a resposta ao degrau pode

ser semelhante à de uma variável integradora quando a constante de tempo do

processo for muito elevada. Isto faz com que o controlador tenha mais dificuldade

em resolver o problema de controle, porque o controlador preditivo não lida com

sistemas integradores diretamente.

ü Utilização de modelos lineares invariantes no tempo. Assim, não são adequados para

resolver problemas de controle onde o processo tem comportamento não-linear ou

onde o modelo do sistema se altera ao longo do tempo. O modelo utilizado é

identificado em um ponto específico da região de operação do sistema. Daí o

controlador é projetado para operar numa região onde o processo tem um dado

comportamento. Isto resulta em incertezas nos ganhos e constantes de tempo do

processo e conseqüentemente em perda de desempenho do controlador, quando

operando em outras regiões.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 97

Para contornar estas limitações, neste trabalho modificamos o controlador

convencional. As modificações testadas foram:

ü Uso do controlador em espaço de estado com modelos de resposta ao

degrau analítico no domínio de tempo contínuo;

ü Utilização de um controlador com múltiplos modelos, formulando o

problema de controle como um problema de Programação não-linear

(MMPC).

Foram comparadas as performances de duas estratégias de controle. A  primeira,

que podemos chamar  de convencional, foi representada pelo QDMC. A segunda, que

podemos chamar de robusta, ou que pelo menos tenta enfocar o problema de

estabilidade do sistema para incertezas no modelo, representada pelo MMPC proposto

neste trabalho. Na segunda, foram utilizados os 5 modelos levantados no simulador e

também o modelo levantado na planta industrial.

 Os controladores foram avaliados através da observação da capacidade dos

mesmos em manter o sistema em malha fechada estável, tanto para as variáveis

controladas como as manipuladas, bem como a comparação das  performances dos

controladores, considerando os efeitos dos seus parâmetros de sintonia.

 A avaliação da performance de um sistema de controle, pode ser feita através do

estabelecimento de algum padrão de comportamento para o mesmo. Este padrão pode

estar ligado ao estado estacionário do sistema, ao comportamento no regime transiente,

à sensibilidade do sistema aos parâmetros do controlador e aos efeitos das não-

linearidades do sistema.

As avaliações das performances dos controladores realizadas neste trabalho

foram feitas de forma qualitativa para o caso servo e regulador. Inicialmente foram

comparadas as performances do QDMC e MMPC para alguns pontos de operação

considerando os mesmos parâmetros de sintonia para os dois controladores. Após o

ajuste da sintonia foram aplicados degraus nas variáveis controladas e perturbações,

sendo verificada a estabilidade dos dois controladores. Em seguida, foi avaliada a

performance de cada controlador quando sujeito a alterações no modelo da planta,

mantendo-se a mesma sintonia do item anterior. Finalmente o controlador MMPC foi



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 98

avaliado em operação na planta industrial, considerando-se a melhor sintonia obtida

durante a simulação do controlador.

9.1 –  Comparação QDMC e  MMPC

Como já vimos, o controlador tem a seguinte configuração:

Variáveis manipuladas:
               MV1  :  vazão de refluxo de topo (VRF)
               MV2  :  vazão de fluido de aquecimento (VGOP)
 Variáveis controladas:
               CV1  : C3

- do butano (%vol.) (C3
-)

               CV2  :  temperatura de topo da coluna (ºC) (Ttopo)
Variáveis perturbadoras:
               DV1  :  vazão de Carga (VFD)
               DV2  :  temperatura do fluido de aquecimento (TGOP)

Os controladores QDMC E MMPC utilizados têm uma série de parâmetros que

são comuns. Durante o estudo foi utilizado um período de amostragem de 1 minuto que

é o valor desse parâmetro usado na unidade industrial. O horizonte de controle (m) foi

adotado igual a 2 em todas as simulações. No caso da utilização do MMPC o valor

desse parâmetro deve ser o menor possível já que, como vimos no item 8.2.5.1.2, o

problema de controle recai em um problema de NLP cujo tempo de computação

depende do horizonte de controle. Entretanto, as conclusões não se alteram se um valor

de (m) maior for utilizado.

No ajuste do controlador, o modelo nominal utilizado na predição das variáveis

controladas foi um modelo obtido através de uma combinação de todos os modelos.

Essa combinação consistiu na aplicação da média aritmética para todos os parâmetros

(ganho e dinâmica) para os modelos obtidos através do simulador e também aquele da

planta industrial. Para o modelo da planta utilizamos o modelo da planta industrial. No

cálculo da ação de controle utilizamos o “modelo combinado” para o algoritmo QDMC,

e os modelos 1, 2, 3, 4, 5 para o algoritmo MMPC. Além disso foram utilizados fatores

de importância (?) de 1 tanto para o C3
- no butano como para a Ttopo. O C3

-  é

controlado no “set-point” e a Ttopo numa faixa de 1ºC entre os valores máximo e

mínimo, já que sua especificação não é tão rigorosa, Almeida et al (1996) apresenta uma



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 99

descrição de como implementar o controle por faixas.  Os instantes de amostragem

utilizados para o cálculo da predição das variáveis controladas foram 1, 2, 5, 7, 10, 15,

20, 25, 30, 35, 40, 45, 50, 60, 70 para os dois controladores.

Nesta fase, comparamos a performance do MMPC e QDMC. Esta fase foi

dividida em três etapas; sendo que na primeira fizemos o ajuste da sintonia do

controlador (principalmente fator de supressão das manipuladas), na segunda etapa foi

avaliada a performance dos controladores sujeitos a variações nas variáveis controladas

e perturbações e por último os dois controladores foram avaliados quando sujeitos a

alterações no modelo utilizado para a planta.

Na tabela 9.1, apresentamos os ganhos dos modelos utilizados nos controladores:

Mdl VRF VGOP C3
- Ttopo

Kp C3
-

(VRF)

Kp Ttopo

(VRF)

Kp C3
-

(VGOP)

Kp Ttopo

(VGOP)
Det(Kp)

1 4000 2104 0.38 47.74 4.498e-4 -0.0153 -0.003441 0.0510 -3.01e-5

2 3160 1731 0.88 49.34 1.6713e-3 -0.0261 -0.012018 0.0550 -2.22e-4

3 2300 1331 4.81 47.82 1.6792e-2 -0.0226 -4.3175e-2 0.0457 -2.08e-4

4 2240 1115 3.01 47.08 7.5501e-3 -0.0295 -2.0402e-2 0.0751 -3.48e-5

5 3532 1837 4.35 44.35 6.9795e-3 -0.0193 -1.8445e-2 0.0461 -3.42e-5

FD 3800 1970 0.69 50.2 9.5821e-4 -0.01253 -3.61e-3 0.03144 -1.51e-5

Tabela 9.1 – Ganhos dos modelos identificados

9.1.1 –  Ajuste de sintonia dos controladores:

Como mencionado acima, nesta primeira etapa foi feito o ajuste dos parâmetros

de sintonia dos controladores, sendo o principal ajuste feito no fator de supressão das

manipuladas. Para as demais etapas foi mantido o melhor ajuste alcançado nesta etapa.

Na tabela 9.2, apresentamos as principais características dos dois controladores:

Controlador Modelo nominal Modelo planta Modelo de cálculo

da ação de controle

QDMC Combinação dos modelos: 1

2 3 4 5 FD
FD (planta industrial) Modelo nominal

MMPC Combinação dos modelos: 1

2 3 4 5 FD
FD (planta industrial) Modelos: 1 2 3 4 5

Tabela 9.2: Características dos controladores utilizados



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 100

Na figura 9.1.a apresentamos os dois controladores com a mesma sintonia

conforme tabela 9.3. Este caso corresponde a um ponto dentro da região mais freqüente

de operação. Podemos observar nessa figura que o controlador MMPC é estável e o

QDMC é instável, para um mesmo fator de supressão das manipuladas. Note na figura,

que o QDMC vai aumentando a sua amplitude de oscilação à medida que o tempo passa,

ao passo que no MMPC rapidamente chegamos a uma condição de estabilidade. Os

números na abscissa de todos os gráficos representam o tempo decorrido em minutos.

PARÂMETRO QDMC MMPC

Período de amostragem 1 min 1 min

Instantes de cálculo da

predição

1 2 5 7 10 15 20 25 30 35 40 45 50

60 70

1 2 5 7 10 15 20 25 30 35 40 45

50 60 70

Horizonte de controle 2 2

Peso das controladas 1 para as duas CV’s 1 para as duas CV’s

Supressão das manipuladas 0.001 para as duas MV’s 0.001 para as duas MV’s

Tabela 9.3 – Parâmetros de sintonia dos controladores para figura 9.1.a

Figura 9.1.a –  Comparação QDMC( - - - ) x MMPC( ––– ) com mesma sintonia.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 101

Na figura 9.1.b apresentamos o QDMC com dois fatores de supressão diferentes,

veja sintonia na tabela 9.4, onde pode se observar que para o controlador se estabilizar é

necessário utilizar um fator de supressão 500 vezes maior que aquele utilizado para o

MMPC, no entanto este fator apesar de ser maior que o utilizado para o MMPC não

chega a ser um valor tão elevado.

PARÂMETRO QDMC QDMC

Período de amostragem 1 min 1 min

Instantes de cálculo da

predição
1 2 5 7 10 15 20 25 30 35 40 45 50 60 70

1 2 5 7 10 15 20 25 30 35 40 45

50 60 70

Horizonte controle 2 2

Peso das controladas 1 para as duas CV’s 1 para as duas CV’s

Supressão das

manipuladas
0.001 para as duas MV’s 0.5 para as duas MV’s

Tabela 9.4 – Parâmetros de sintonia dos controladores para figura 9.2.a

 Figura 9.1.b – QDMCsupr = 0.001(- - -) QDMCsupr = 0.5(–––)..



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 102

9.1.2 –QDMC e MMPC com sintonias ajustadas :

Nesta etapa foi avaliada a performance dos dois controladores frente a alterações

nos set-points das variáveis controladas e também variações nas variáveis perturbadoras.

Repete-se aqui a estrutura dos controladores apresentada na tabela 9.2. Na tabela 9.5

apresentamos a sintonia utilizada para os controladores.

PARÂMETRO MMPC QDMC

Período de Amostragem 1 min 1 min

Instantes de cálculo da

predição
1 2 5 7 10 15 20 25 30 35 40 45 50 60 70

1 2 5 7 10 15 20 25 30 35 40 45

50 60 70

Horizonte de controle 2 2

Peso das controladas 1 para as duas CV’s 1 para as duas CV’s

Supressão das

manipuladas
0.001 para as duas MV’s 0.5 para as duas MV’s

Tabela 9.5 – Sintonia dos controladores para item 9.1.2

Na figura 9.1.c apresentamos o comportamento do controlador quando alteramos

o set-point do teor de C3
- . Podemos observar que os dois controladores têm

praticamente a mesma performance, ou seja, atingem o novo “set-point” proposto com a

mesma facilidade.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 103

 Figura 9.1.c – Alteração do “set-point” do teor de C3
- QDMC( - - - )  MMPC( –– ).

Na figura 9.1.d apresentamos o comportamento do controlador quando alteramos

a faixa de controle da Ttopo em -1 ºC no instante 20. Aqui no entanto, a performance do

controlador MMPC é superior à do QDMC, o que pode ser constatado através da

observação do tempo necessário para que a variável alcance a nova faixa de controle e o

teor de C3
-  retorne para o “set-point”. Com o MMPC o tempo de estabilização é em

torno de 600 minutos ao passo que para o QDMC este tempo é superior a 1000 minutos.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 104

Figura 9.1.d – Alteração da faixa de controle da Ttopo QDMC( - - - )  MMPC( –– ).

Na figura 9.1.e apresentamos a performance dos controladores quando aplicamos

variações em degrau na vazão de carga para a coluna, que é uma variável perturbadora

do processo. O degrau aplicado foi de 50 m3/d no instante 30 min. Neste caso, podemos

observar que os dois controladores conseguem manter as variáveis controladas no “set-

point” e faixa de controle respectivamente, sem grandes dificuldades.

Figura 9.1.e – Aplicação de degrau na vazão de carga QDMC( - - - )  MMPC( –– ).



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 105

Na figura 9.1.f apresentamos a performance dos controladores quando aplicamos

variações em degrau na temperatura do fluido de aquecimento para o refervedor, que é

uma variável perturbadora do processo. O degrau aplicado foi de 5 ºC no instante 30

min. Neste caso, podemos observar que os dois controladores conseguem manter as

variáveis controladas no “set-point” e faixa de controle respectivamente, sem grandes

dificuldades.

Figura 9.1.f – Aplicação de degrau na TGOP QMDC( - - - )  MMPC( –– ).

9.1.3 – Alteração do modelo da planta:

Nesta etapa analisamos a performance dos controladores frente a alterações no

modelo utilizado para a planta. As avaliações consistiram em colocar o controlador em

operação tendo como modelo da planta aquele da planta industrial e no instante 20 min.

o modelo da planta era alterado para um novo modelo. Os modelos utilizados foram

todos aqueles levantados através do simulador, ou seja, 1, 2, 3, 4 e 5. Em todos os casos

analisados, sempre partimos com o teor de C3
-  acima do “set-point”. A sintonia do



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 106

controlador permaneceu a mesma do item anterior (veja tabela 9.5). Os casos analisados

são apresentados nas figuras 9.1.g, 9.1.h, 9.1.i, 9.1.j e 9.1.k. A seguir analisamos a

performance para a alteração de cada modelo.

Na figura 9.1.g apresentamos o comportamento dos controladores quando

mudamos o modelo da planta para o modelo 1. Podemos observar que o MMPC

consegue levar o teor C3
-  para o “set-point” apesar de levar um tempo maior do que

quando não temos alteração no modelo da planta (veja figura 9.1.c). Já o QDMC não

consegue levar o teor de C3
-  para o “set-point” apresentando assim um “off-set”. O

mesmo ocorre com a Ttopo.

Figura 9.1.g – Mudança p/ modelo 1 no instante 20 min., QDMC( - - - )  MMPC( –– ).

Na figura 9.1.h apresentamos o comportamento dos controladores quando

mudamos o modelo da planta para o modelo 2. Novamente aqui temos um

comportamento semelhante ao apresentado quando alteramos o modelo da planta para o

modelo 1. No entanto, o tempo de estabilização para o MMPC é superior àquele quando

não temos alteração do modelo da planta (figura 9.1c). O QDMC neste caso também

apresenta “off-set” para as variáveis controladas.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 107

Figura  9.1.h - Mudança p/ modelo 2 no instante 20 min., QMDC( - - - )  MMPC( –– ).

Na figura 9.1.i apresentamos o comportamento dos controladores quando

mudamos o modelo da planta para o modelo 3. Neste caso o comportamento do MMPC

é semelhante àquele apresentando na figura 9.1.c. No entanto, o QDMC apresenta um

ligeiro “off-set” para o teor de C3
- o que não chega a comprometer sua performance.

Figura 9.1.i - Mudança para modelo 3 no instante 20 min., QMDC( - - - )  MMPC( –– ).



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 108

Na figura 9.1.j apresentamos o comportamento dos controladores quando

mudamos o modelo da planta para o modelo 4. Aqui no entanto, os dois controladores

apresentaram “off-set” para o teor C3
-, sendo que para o MMPC o “off-set” é menor do

que aquele apresentado pelo QDMC. Para a Ttopo somente o QDMC apresentou “off-

set” sendo que o MMPC levou a Ttopo para seu limite máximo.

Figura 9.1.j - Mudança para modelo 4 no instante 20min., QDMC( - - - )  MMPC( –– ).

Na figura 9.1.k apresentamos o comportamento dos controladores quando

mudamos o modelo da planta para o modelo 5. Temos neste caso um comportamento

semelhante ao apresentado quando alteramos o modelo da planta para o modelo 2, ou

seja, o MMPC consegue levar o teor de C3
- para o “set-point” e a Ttopo para seu limite

superior, o que não ocorre com o QDMC, que apresenta “off-set” para as duas variáveis

controladas.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 109

 Figura 9.1.k - Mudança modelo p/ 5 no instante 20 min., QDMC( - - - )  MMPC( –– ).

De forma geral, podemos constatar que o QDMC necessita de fatores de

supressão superiores ao MMPC para estabilizar o sistema de controle. Após

sintonizado, o QDMC apresentou, em alguns casos, comportamento semelhante ao

MMPC (figuras 9.1.c, 9.1.e, 9.1.f) quando o modelo da planta não se alterava. No

entanto, quando tivemos alteração no modelo da planta, o que no processo real equivale

a termos alteração do ponto de operação, o QDMC se mostrou ineficaz em controlar o

processo, apresentando “off-set” na maioria das situações simuladas (figuras 9.1.g,

9.1.h, 9.1.i, 9.1.k). Assim, podemos concluir que o QDMC não seria adequado para

controle do nosso processo, ao passo que o MMPC se mostrou mais adequado,

apresentando melhor performance que o QDMC.

Tendo em vista que o controlador MMPC se mostrou mais eficiente que o

QDMC, o mesmo foi implementado para controle da planta industrial. No próximo item

apresentamos a performance do MMPC em operação na unidade industrial.

9.2 – Implantação do controlador MMPC na planta industrial

O controlador MMPC entrou em operação na planta industrial no dia 14 de

fevereiro de 2001, e tem operado continuamente demonstrando uma grande aceitação



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 110

por parte dos operadores da unidade. Para implantação do controlador na planta

industrial foi utilizado o SICON ( Sistema Integrado de Controle da Petrobras ). Este

sistema é descrito no item 9.2.1. As subrotinas do SICON tiveram que ser adaptadas

para permitir a montagem do controlador na forma paramétrica apresentada no item

8.2.1, principalmente na parte de leitura dos modelos. Também foram implementadas

novas subrotinas no sistema para permitir o cálculo das ações de controle através do

SQP.

Para verificação da performance do controlador em operação na planta industrial,

foram coletados dados com o controlador em operação sujeito às variações normais da

planta tais como: variáveis perturbadoras medidas (vazão de carga e temperatura do

fluído de aquecimento) e variáveis perturbadoras não medidas (composição da carga,

variações ambientais etc.). Também foram realizados testes para verificação da operação

do controlador frente à alterações no  “set-point” das variáveis controladas.

As figuras apresentadas abaixo foram obtidas através da interface gráfica do PITM

(Plant Information) da Oil System Inc, que é o sistema de gerenciamento de dados de

processo existente na RPBC. Este sistema consiste de uma interface de leitura dos dados

do SDCD enviando-os para um servidor onde fica a base de dados. Esta base de dados

pode ser acessada para gerar gráficos através da interface gráfica do próprio programa e

também através da planilha eletrônica ExcelTM da Microsoft, permitindo uma análise

detalhada de todas as variáveis operacionais do processo.

Para um melhor entendimento das figuras apresentaremos a seguir uma descrição

de cada item constante das mesmas:

ü Geral para todas as figuras:

• campo superior esquerdo: é uma descrição da variável

• o número abaixo dos “tag’s” é o valor da variável de processo (PV) no

caso das variáveis controladas e perturbadoras, e o “set-point” (SV) no

caso das manipuladas. Este é o valor real lido do SDCD e se refere ao

instante de tempo apresentado no lado direito inferior da figura.

• parte inferior: são apresentados os instantes inicial e final do período de

tempo em que a variável é observada.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 111

• a escala que aparece do lado esquerdo dos gráficos representa a faixa de

operação atual das variáveis.

ü Variável controlada teor de C3
- :

• AI2430 é o “tag” da variável de processo (PV).

• AI2430MN é o “tag” do limite mínimo da variável para controle.

• AI2430MX é o “tag” do limite máximo da variável para controle.

ü Variável controlada Ttopo:

• TC2483 é o “tag” da variável de processo (PV).

• TC2483MN é o “tag” do limite mínimo da variável para controle.

• TC2483MX é o “tag” do limite máximo da variável para controle.

ü Variável manipulada Vrefluxo:

• FC2454SV é o “tag” do “set-point” (SV) da variável.

• FC2454SMN é o “tag” do limite mínimo do “set-point”  (SV) para

controle.

• FC2454SMX é o “tag” do limite máximo do “set-point”  (SV) para

controle.

• FC2454MD é o modo da variável manipulada no SDCD. Informa se a

variável está liberada para ser utilizada pelo controle supervisório. A

opção RCAS (cascata remota) indica que o “set-point” está sendo

fornecido pelo controle supervisório.

ü Variável manipulada VGOP:

• FC24151SV é o “tag” do “set-point” (SV) da variável.

• FC24151SMN é o “tag” do limite mínimo do “set-point”  (SV) para

controle.

• FC24151SMX é o “tag” do limite máximo do “set-point”  (SV) para

controle.

• FC24151MD é o modo da variável manipulada no SDCD. Informa se a

variável está liberada para ser utilizada pelo controle supervisório. A



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 112

opção RCAS (cascata remota) indica que o “set-point” está sendo

fornecido pelo controle supervisório.

ü Variáveis perturbadoras (Vcarga e TGOP):

• FC2452SV ou TI24154 são os  “tags” das variáveis perturbadoras

medidas, que são utilizadas no controle.

Na tabela 9.6 apresentamos os parâmetros de sintonia utilizados no controlador

utilizado na planta industrial.

PARÂMETRO VALOR

Período de amostragem 1 min

Instantes de cálculo da predição 1 2 5 7 10 15 20 25 30 35 40 45 50 60 70

Horizonte de controle 2

Peso das controladas 1 para as duas CV’s

Supressão de movimentos 0.01 para as duas MV’s

Modelo nominal Combinação  dos modelos: 1  2  3  4  5 FD

Modelos para cálculo da ação de

controle
1  2  3  4  5

Tabela 9.6 – Parâmetros de sintonia do controlador industrial

A seguir analisaremos os gráficos referentes aos casos estudados com o

controlador em operação na planta industrial.

O primeiro conjunto de gráficos (figuras 9.2.a1 a 9.2.a3) representa um período

de operação do controlador onde não temos alteração do “set-point” das variáveis

controladas. O teor de C3
- é controlado no “set-point”, (AI2430MN = AI2430MX = 0.9

%vol.), enquanto que a Ttopo é controlada dentro de uma faixa (TC2483MN=49ºC e

TC2483MX=50ºC), as variáveis manipuladas têm seus limites bastante amplos (vazão

de refluxo de 2000 a 4300 m3/d, vazão de GOP de 500 a 2300 m3/d). Estes limites das

variáveis manipuladas fazem com que o controlador tenha ampla liberdade para atuar no

controle do processo. Podemos observar nessas figuras que o controlador consegue

manter as variáveis controladas nas suas especificações (“set-point” para o C3
- e faixa de

controle para a Ttopo), mesmo quando temos variações significativas nos valores das



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 113

variáveis perturbadoras. Veja que em alguns momentos a vazão de carga (Fig. 9.2.a3)

chega a variar 250 m3/d em um curto intervalo de tempo.

Figura 9.2.a1 – Variáveis controladas em operação típica.

Figura 9.2.a2 – Variáveis manipuladas em operação típica.

Figura 9.2.a3 – Variáveis perturbadoras em operação típica.

No próximo conjunto de gráficos (figuras 9.2.b1 a 9.2.b3) apresentamos dados

relativos a um teste (teste 1), realizado para observar a performance do controlador

frente a alterações no “set-point” do teor de C3
- no butano. O degrau aplicado foi de 0.3

%vol., passando de 1.2 para 1.5 %vol.. Podemos observar que o novo patamar de “set-

point” é atingido em aproximadamente 30 minutos. Observe que não ocorre violação da



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 114

faixa de controle da temperatura de topo mesmo com severas variações nas variáveis

perturbadoras como a vazão de carga que variou quase 200 m3/d durante o período de

teste.

Figura 9.2.b1 – Variáveis controladas teste 1.

Figura 9.2.b2 – Variáveis manipuladas teste 1.

Figura 9.2.b3 – Variáveis perturbadoras teste 1.

O segundo teste realizado na planta (teste 2), é descrito pelas figuras 9.2.c1 a

9.2.c3. Ele consistiu novamente na alteração do “set-point” do teor de C3
- no butano. O

degrau aplicado foi de 0.3 %vol., só que desta vez no sentido contrário ao anterior,



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 115

passando o “set-point” 1.2 %vol. para 0.9 %vol. Observe que quase simultaneamente à

aplicação do degrau no “set-point” tivemos uma grande variação na vazão de carga da

coluna sendo que a mesma saiu de um patamar de 2050 m3/d baixou para 1800 m3/d, e

depois foi elevada para 2500 m3/d e finalmente retornou para o patamar de 2000 m3/d.

Estas variações ocorreram durante um período de aproximadamente 4 horas. Observe

que tivemos também uma alteração no patamar da temperatura do fluido de

aquecimento passando a mesma de 259ºC para em torno de 261ºC. Veja que durante a

ocorrência dessas perturbações o teor de C3
- oscilou entre um máximo a 1.6 %vol. e um

mínimo de 0.7 %vol.. A Ttopo violou 1ºC acima do limite máximo de controle. Observe

que as variáveis manipuladas variaram bastante para manter as variáveis controladas

dentro de suas especificações durante a ocorrência das perturbações, permanecendo o

tempo todo ligadas (RCAS).

Figura 9.2.c1 – Variáveis controladas teste 2.

Figura 9.2.c2 – Variáveis manipuladas teste 2.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 116

Figura 9.2.c3 – Variáveis perturbadoras teste 2.

O terceiro teste (teste3), corresponde às figuras 9.2.d1 a 9.2.d3. Ele consistiu na

aplicação de um degrau nos limites da temperatura de topo (Ttopo), permanecendo o

“set-point” do C3
- no mesmo valor. O degrau aplicado foi de 0.5ºC nos limites da Ttopo,

passando o máximo de 50ºC para 49.5ºC e o mínimo de 49ºC para 48.5ºC. Observe que

o controlador em poucos minutos leva a Ttopo para dentro na nova faixa permanecendo

o C3
- no “set-point” especificado. Veja que o patamar da vazão de refluxo muda da faixa

de 2800 m3/d  para um patamar de 2950 m3/d sendo que a vazão de fluido de

aquecimento sofre um ligeiro acréscimo. Após a estabilização inicial da temperatura na

nova faixa de controle, observamos que as variáveis manipuladas mudam de patamar,

passando a vazão de refluxo de 2950 m3/d para 3100 m3/d e a vazão de fluido de

aquecimento de 1900 m3/d para 2050 m3/d. Esta mudança de patamar provavelmente

ocorreu devido à alteração principalmente nas variáveis perturbadoras não medidas

sendo a mais importante delas a qualidade da carga para a coluna. As variáveis

perturbadoras medidas não tiveram alterações significativas no período. Esta mudança

no patamar das variáveis manipuladas foi necessário para que as variáveis controladas

mantivessem suas especificações.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 117

Figura 9.2.d1 – Variáveis controladas teste 3.

Figura 9.2.d2 – Variáveis manipuladas teste 3.

Figura 9.2.d3 – Variáveis perturbadoras teste 3.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 118

9.2.1 - SICON - Sistema Integrado de Controle ( da Petrobras )

Para que possamos implementar o controlador apresentado nos itens anteriores

na planta industrial é necessário termos um conjunto integrado de softwares e

computadores para execução dos algoritmos de forma segura. No caso da Petrobras este

conjunto pode ser representado esquematicamente através da figura 9.2.e onde temos

três interfaces descritas a seguir.

Figura 9.2.e - Interfaces de controle

1 -  Interface de operação:  esta interface é constituída pelas telas gráfica do SDCD

(Sistema Digital de Controle Distribuído), onde os operadores atuam para colocar/retirar

o programa de operação, alterar os limites de máximo/mínimo das variáveis quando for

necessário, colocar/retirar variáveis do controle e monitorar o comportamento do

programa e das variáveis.

2 - Interface leitura de dados: esta interface é constituída pelo programa PI (Plant

Information? da Oil Systems) sendo a base de dados utilizada para leitura dos valores

das variáveis utilizadas pelo programa de controle.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 119

3 - Interface de engenharia: esta interface é constituída de duas plataformas, sendo uma

plataforma de engenharia e um computador de processo. A plataforma de engenharia é

constituída basicamente por um computador PC com Windows, comunicando-se em

rede com outros computadores. Nesta plataforma são executadas várias aplicações que

permitem ao engenheiro de controle realizar as atividades de construção, sintonia,

comissionamento e monitoramento das variáveis dos controladores através de uma

interface gráfica adequada. O ambiente do Computador de Processo provê todos os

serviços necessários à execução de aplicações de controle, como por exemplo, a

aquisição de valores de processo do SDCD, validação destes valores para utilização pelo

controlador, a execução dos algoritmos de controle, o envio das ações de controle de

volta ao SDCD e a comunicação com a plataforma de engenharia. É importante notar

que as aplicações de controle são executadas nesta plataforma e não dependem da

plataforma de engenharia. A partir desta plataforma é feita a escrita dos valores de

controle para o SDCD através da interface de comunicação Centap-plus? da Yokogawa.

Nas figuras 9.2.f a 9.2.i, apresentamos as telas de configuração relativas à

interface de engenharia, nestas telas temos os principais parâmetros de configuração e

sintonia do controlador e das variáveis manipuladas, controladas e perturbadoras.

Basicamente estas telas de configuração apresentam os seguintes campos de informação:

ü Descrição: apresenta uma descrição do controlador ou da variável correspondente.

ü Tags de entrada: são os valores lidos do SDCD ou fixados em um determinado

valor.

ü Tags de saída: são valores que serão enviados para o SDCD ou PI.

ü Entradas: são parâmetros de configuração do controlador ou das variáveis que são

preenchidos pelo engenheiro de controle.

ü Saídas: são informações fornecidas pelo programa a respeito da performance do

controlador ou variável.

ü Faixa de validade: são os limites aceitáveis para as variáveis, fora destes limites a

variável será desligada automaticamente pelo controlador.

ü Range da variável: normalmente são os limites mínimo e máximo de leitura das

variáveis.

ü Auxiliares: são fatores de configuração adicionais que permitem a possibilidade de

customização diferenciadas para cada controlador ou variável.



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 120

Figura 9.2.f – Tela de configuração/sintonia do controlador

Figura 9.2.g – Tela de configuração/sintonia de variável controlada



Capítulo 9 – Aplicação do MPC à coluna depropanizadora 121

Figura 9.2.h - Tela de configuração/sintonia de variável manipulada

Figura 9.2.i - Tela de configuração de variável perturbadora



122

10

CONCLUSÕES E SUGESTÕES
10.1 – Conclusões

Este trabalho é a primeira aplicação industrial de um controlador preditivo

baseada no modelo de variáveis de estado montado a partir de resposta ao degrau

analítica (ROSSMPC). As vantagens desse enfoque são:

ü Controlar sistemas com dinâmicas muito lentas, sem necessidade de

memorizar vetores e matrizes de grandes dimensões.

ü Controlar sistemas com dinâmicas lentas e rápidas no mesmo controlador;

ü Prever as variáveis controladas em instantes de tempo diferentes para cada

uma delas;

ü Controlar sistemas de grandes dimensões, ou seja, grande número de

variáveis manipuladas e controladas. Isto possibilita controlar unidades de

processo inteiras, sem grande esforço computacional.

ü Fazer adaptação dos ganhos e até mesmo dos parâmetros das dinâmicas sem

grandes dificuldades.

Também nesse trabalho temos a descrição da primeira aplicação de um

controlador baseado em múltiplos modelos onde o problema de otimização recai em

um problema tipo min-max., ou seja, o controlador escolhe uma ação de controle que

minimiza o erro para o pior modelo. Alguns autores argumentam que esse controlador

seria demasiadamente conservativo no caso de modelos bastante diferentes. Este é o

caso da aplicação aqui estudada onde os modelos têm características bastante

diferentes. Por exemplo, o ganho do teor de C3
- em relação à vazão de refluxo para o

modelo 1 é de 4.498E-4 e para o modelo 3 é de 1.679E-2, portanto 37 vezes maior.

Assim, esperava-se um comportamento não muito eficiente do controlador

MMPC para a coluna depropanizadora. Entretanto, os resultados mostram que a

performance, em termos de velocidade de resposta e tempo de estabilização , é

perfeitamente compatível com as exigências práticas. Portanto, conseguiu-se um

controlador com uma faixa de estabilidade bastante ampla e uma performance

adequada.



Capítulo 10 - Conclusões e sugestões 123

Este controlador exige um esforço na sintonia menor do que o QDMC e esta

sintonia é mais adequada numa região de operação mais ampla do que a correspondente

do QDMC. Embora o esforço computacional do MMPC seja maior que para o QDMC

essa desvantagem não é importante para o caso estudado. No computador de controle de

processo (Alpha 1000 server da Digital de 400 mhz com 512 mb de memória ram) o

tempo de computação do MMPC não chega a 1 segundo, portanto não significativo em

comparação com o período de amostragem.

Tendo em vista estes resultados, espera-se que a utilização do MMPC se torne

um padrão dentro da Petrobras.

Outro aspecto importante do trabalho foi a utilização do simulador de processos

para levantamento do conjunto de modelos. Esta utilização se mostrou bastante

interessante, pois através dela temos uma redução da necessidade de realização de testes

na planta industrial, o que seria demorado e dispendioso. Além, de podermos pesquisar

uma região mais ampla do processo, o que dificilmente seria conseguido na planta

industrial.

10.2 – Sugestões

Em função de uma série de dificuldades e restrições do estudo, podemos sugerir

alguns pontos para trabalhos futuros.

Os componentes do conjunto de modelos e o modelo nominal para predição

foram escolhidos procurando abranger os diferentes pontos de operação do sistema e em

função dos determinantes das matrizes de ganhos nestes pontos. Estes critérios são

necessários, mas não suficientes, sendo que poderíamos incluir os critérios de

estabilidade dos controladores na seleção dos modelos.

Neste estudo não incluímos a análise de estabilidade do sistema no projeto de

controle. Sugerimos então que se inclua a análise de estabilidade no projeto de controle,

até mesmo estudar algum algoritmo que otimize os parâmetros do controlador segundo

os critérios de estabilidade.



Capítulo 10 - Conclusões e sugestões 124

Também pode-se estudar alguma forma eficiente de incluir os critérios de

estabilidade no cálculo da ação de controle. Isto poderia ser feito incluindo os critérios

de estabilidade de Lyapunov no problema de controle.

No sentido de aumentar a estabilidade do controle, pode-se estabelecer algum

critério de normalização das variáveis manipuladas, perturbações, controladas e modelos

de forma a condicionar adequadamente o sistema de controle, desacoplando-o da melhor

forma possível.

Em relação ao sistema estudado, o ideal seria que controlássemos efetivamente a

contaminação de componentes pesados no topo da coluna através da medição do teor de

C4
+. Para isto seria necessário desenvolver uma inferência com qualidade superior ao da

existente atualmente, que se baseia em correlação multilinear.

Outro aspecto que poderia ser desenvolvido seria a implementação de uma

camada de otimização no controlador, isto permitiria um ganho em economia de

energia, o que em uma coluna de fracionamento representa um grande incentivo, já que

o processo de separação se baseia  na introdução de energia para permitir a separação

dos produtos.



125

REFERÊNCIAS BIBLIOGRÁFICAS

ALMEIDA, E. 1999. Controle preditivo multimodelos de uma torre debutanizadora.

200p. Dissertação (Mestrado) - Escola Politécnica da Universidade de São Paulo.

ALMEIDA, E.; RODRIGUES, M. A.; ODLOAK D. (2000) Robust predictive control of

a gasoline debutanizer column. Brazilian Journal of Chemical Engineering, v.17,

nº 04-07, p.967-977

ALMEIDA, E.; ZANIN, A. C.; ODLOAK, D. (1996). Advanced control and

optimization of a crude vacuum unit. XI Congresso Brasileiro de Automática, - I

Simpósio de Automática Aplicada, Anais p.23-28, São Paulo

ASTM-D86 (1970). Part 17, Petroleum Products-Fuels, Solvents, Burner Fuel Oils,

Lubrificating Oils, Cutting Oils, Lubrificating Greases, Hydraulic Fluids. American

Soc. For Testing &amp;amp; Materials, Philadelphia, PA, p.8-20.

BOYD, S.; GHAOUI, L. E.; FERON, E.; BALAKRISHNAN, V. (1994). Linear

Matrix Inequalities in System and Control Theory. SIAM, Philadelphia

CLARKE, D. W.; MOHTADI, C.; TUFFS, P.S. (1987). Generalized predictive control–

Part I: the basic algorithm. Automatica, v.23, n.2, p.137-148

CLARKE, D. W.; MOHTADI, C.; TUFFS, P.S. (1987). Generalized predictive control–

Part II: extensions and interpretations. Automatica, v.23, n.2, p.149-160

CUTLER, C. R.; RAMAKER, B. L. (1979). Dynamic matrix control – a computer

control algoritm. AIChE 86th National Meeting, Houton, TX

GARCIA, C. E.; MORARI, M. (1982). Internal model control – Part 1: A unifying

review and some new results. Ind. Eng. Chem. Proc. Des. Dev., v.21, p.308-323

GARCIA, C. E.; MORARI, M. (1985). Internal model control – Part 2: Design

procedure for multivariable systems. Ind. Eng. Chem. Proc. Des. Dev., v.24, p.472-

484

GARCIA, C. E.; MORARI, M. (1985). Internal model control – Part 3: Multivariable

control law computation and tuning guidelines. Ind. Eng. Chem. Proc. Des. Dev.,

v.24, p.484-494

GARCIA, C. E.; MORSHEDI, A. M. (1986). Quadratic programing solution of dynamic

matrix control (QDMC). Chem. Engng Commun., v.46, p.73-87



Referências bibliográficas 126

GOUVÊA, M. T.; ODLOAK, D. (1997). ROSSMPC: A new way of representing and

analysing the predictive controllers. Trans IchemE, v.75, Part A, p.693-708

HENSON, M. A. (1998). Nonlinear model predictive control: Current status and fucture

directions. Computers Chem. Engng, v.23, n.2, p.187-202

HOYD, M.; LEE, J. H.; MORARI, M. (1993). Truncated step response model predictive

control. Journal of Process Control, v.3, n.2, p.67-73

KOTHARE, K. V.; BALAKRISHNAN, V.; MORARI, M. (1996). Robust constrained

model predictive control using linear matrix inequalities. Automatica, v.30, n.10,

p.1361-1379

LEE, J. H.; MORARI, M.; GARCIA, C. E. (1994). State space interpretation of model

predictive control, Automatica, v.30, n.4, p.707-717

LI, S.; LIM, K. Y.; FISHER, D. G. (1989). A state space formulation for model

predictive control, AIChE Journal, v.35, n.2, p.241-249

LJUNG, L. (1987). System Identification: Theory for the user. Prentice-Hall,

Englewood Cliffs, NJ

LUNDSTRÖM, P.; LEE, J. H.; MORARI, M.; SKOGESTAD, S. (1995). Limitations of

dynamic matrix control. Computers Chem. Engng, v.19, n.4, p.409-421

MAGALHÃES, M. V. O.; ODLOAK, D. (1995). Multivariable quality control of a

crude oil frationator. DYDORD’95, IFAC Conference, Dynanics and Control of

Chemical Reactors, Distillation Columns and Batch Processes, p.583-488,

Copenhagen

MIQUEL, J.; CASTELLS, F.(1993). Easy characterization of petroleum fractions,

Hydroc. Processing, December 1993, p.101-105

MORARI, M.; DOYLE, J. (1986). A unifying frameworks for control system design

under uncertainty and its implications for chemical process control. Proceedings of

Chemical Process Control - CPC III, p.5-52

MORARI, M.; LEE, J. H. (1991). Model predictive control: The good, the bad, and the

ugly. Proceedings of Chemical Process Control - CPC IV, San Padre Island, TX,

p.410-444

MORARI, M.; LEE, J. H. (1999). Model predictive control: past, present and future.

Computers Chem. Engng, v.23, p.667-682



Referências bibliográficas 127

MORARI, M.; ZAFIRIOU, E. (1989). Robust process control. Prentice-Hall,

Englewood Cliffs, NJ

MORO, L. F. L.; ODLOAK, D. (1994). Controle de conversores de craqueamento

catalítico em leito fluido, I - Modelagem dinâmica. Boletim Técnico da Petrobras,

v.37, n.1, p.3-12

MORO, L. F. L.; ODLOAK, D. (1994). Controle de conversores de craqueamento

catalítico em leito fluido, II – Controle preditivo multivariável com restrições.

Boletim Técnico da Petrobras, v.37, n.2, p.111-124

MORO, L. F. L.; ODLOAK, D. (1995). Constrained multivariable control of fluid

cracking converters. Journal of Process Control, v.5, n.1, p.29-39

MORSHEDI, A. M.; CUTLER, C. R.; SKROVANEK, T. A. (1985). Optimal solution

of dynamic matrix control with linear programming techniques (LDMC). Proc. Am.

Control Conf., Boston, MA, p.199-208

NESTEROV, Y.; NEMIROVSKY, A. (1994). Interior-point polynomial methods in

convex programming. SIAM, Philadelphia

ODLOAK, D. (1995). Stability analysis of the dynamic matrix controller, Braz. Jour.

Chem. Engng, v.12, n.1, p.50-64

ODLOAK, D. (1996). A new state-space approach to model predictive control, Braz.

Jour. Chem. Engng, v.13, n.3, p.152-167

PENG, D.Y.; ROBINSON, D.B. (1976). A new two constant equation of state. Ind.

Eng. Chem. Fundamen., v.15, p.59-64

PRETT, D. M.; GILLETTE, R. D. (1979). Optimization and constrained multivarible

control of catalytic cracking unit, AIChE 86th National Meeting, Paper 51-C,

Houton, TX

PRETT, D. M.; GILLETTE, R. D. (1980). Optimization and constrained multivarible

control of a catalytic cracking unit, Proc. Automatic Control Conf., San Francisco,

CA, Paper WP5-C

RICHALET, J.; RAULT, A.; TESTUD, J. L.; PAPON, J. (1978). Model predictive

heuristic control: application to industrial processes. Automatica, v.14, n.5, p.413-

428

RODRIGUES, M. A.; ODLOAK, D. (2000). Output feedback MPC with guaranteed

robust stability. Journal of Process Control, v.10, p. 557-572.



Referências bibliográficas 128

ROUHANI, R.; MEHRA, R. K. (1982). Model algorithmic control (MAC): basic

theoretical properties, Automatica, v.18, p.401

SCHITTKOWSKI, K. (1985/6). A Fortran Subroutine Solving Constrained NonLinear

Programming Problems, Annals of Operations Research, vol. 5, p. 485-500

SPANDRI, R.; MORO, L. F. L.; ODLOAK, D. (1995). Constrained multivariable

control of fluid catalytic cracking converters, a practical application. AIChE,

Spring National Meeting, Paper 84b, Houston, TX

TRIERWEILER, J. O.; FARINA, L. A.; DURAISKI R. G. (2001). RPN Tuning strategy

for model predictive control. DYCOPS, p.283-289, Jejudo Island, Korea

ZANIN, A. C.; ODLOAK, D. (1992). Advanced control of an atmospheric resid heater.

Proceedings of the First International Instrumentation, Systems and Industrial

Automation Meeting, p.33-42, Salvador, BA



129

APÊNDICE  A

FUNÇÃO DE TRANSFERÊNCIA DOS MODELOS

IDENTIFICADOS

Nas tabelas A1 a A6 apresentamos na forma de função de transferência os

modelos identificados no capítulo 7. Os parâmetros da tabela obedecem seguinte

equação:

( ) ?se
asas

sbb
sG ?

++
+

=
21

2
10

MODELO CV MV/DV b0 b1 a1 a2 ?

1 C3
- VRF 0.1094e-4 0.4227e-4 0.1090 0.0243 1

VGOP -0.3824e-4 -1.2055e-4 0.1342 0.0111 1

Vcarga 0.5668e-2 -0.0945e-2 0.3975 0.0850 1

TGOP -0.21740e-3 -0.6856e-3 0.1342 0.0111 1

C4
+ VRF -0.2539e-3 -0.2445e-3 0.1142 0.0086 1

VGOP 0.6641e-3 0.7159e-3 0.1343 0.0087 1

Vcarga -0.2482e-3 0.0617e-3 0.1573 0.0141 1

TGOP 0.0996e-1 0.1074e-1 0.1343 0.0087 1

TTOPO VRF -0.1116e-3 -0.0873e-3 0.1317 0.0073 1

VGOP 0.0070 0.0013 2.2605 0.1366 1

Vcarga -0.0015 -0.0004 1.9247 0.1353 1

TGOP 0.1044 0.0194 2.2605 0.1366 1

Tabela A1 – Parâmetros da função de transferência para o modelo 1



Apêndice A - Descrição sumária do HYSYS? 130

MODELO CV MV/DV b0 b1 a1 a2 ?

2 C3
- VRF 0.4220e-3 -0.2722e-3 1.6602 0.2525 1

VGOP -1.405e-4 -2.1828e-4 0.1322 0.0117 1

Vcarga 0.0521e-3 0.1503e-3 0.2097 0.0279 1

TGOP -0.4740e-3 -0.7365e-3 0.1322 0.0117 1

C4
+ VRF -0.2891e-2 -0.1572e-2 0.7355 0.0561 1

VGOP 0.0946e-2 0.1605e-2 0.1268 0.0123 1

Vcarga -0.3885e-3 -0.3830e-3 0.1355 0.0148 1

TGOP 0.1216e-1 0.2064e-1 0.1268 0.0123 1

TTOPO VRF -0.0063 -0.0034 2.0724 0.2428 1

VGOP 0.0045 0.0002 0.8352 0.0812 1

Vcarga -0.0012 -0.0012 0.8328 0.0693 1

TGOP 0.0575 0.0020 0.8352 0.0812 1

Tabela A2 – Parâmetros da função de transferência para o modelo 2

MODELO CV MV/DV b0 b1 a1 a2 ?

3 C3
- VRF 0.1532e-2 -0.0860e-2 1.1913 0.0912 1

VGOP -0.7811e-3 -0.3770e-3 0.3402 0.0181 1

Vcarga 0.7698e-3 0.8929e-3 0.5633 0.0359 1

TGOP -0.7701e-2 -0.3716e-2 0.3402 0.0181 1

C4
+ VRF -0.1053e-2 -0.2637e-2 0.3524 0.0231 1

VGOP 0.1335e-2 0.0474e-2 0.2471 0.0203 1

Vcarga -0.3299e-3 -0.2002e-3 0.2293 0.0190 1

TGOP 0.1316e-1 0.0467e-1 0.2471 0.0203 1

TTOPO VRF -0.0008 -0.0034 0.4017 0.0365 1

VGOP 0.0089 0.0064 1.8959 0.1946 1

Vcarga -0.0009 -0.0012 0.8844 0.0799 1

TGOP 0.0877 0.0634 1.8959 0.1946 1

Tabela A3 – Parâmetros da função de transferência para o modelo 3



Apêndice A - Descrição sumária do HYSYS? 131

MODELO CV MV/DV b0 b1 a1 a2 ?

4 C3
- VRF 0.4881e-3 -0.1107e-3 0.9881 0.0646 1

VGOP -0.1862e-3 -0.1763e-3 0.2605 0.0091 1

Vcarga 0.2710e-3 0.1854e-3 0.5111 0.0265 1

TGOP -0.1781e-2 -0.1686e-2 0.2605 0.0091 1

C4
+ VRF -0.0440e-2 -0.1955e-2 0.1510 0.0074 1

VGOP 0.5084e-3 -0.3732e-3 0.1041 0.0046 1

Vcarga -0.1856e-3 -0.3426e-3 0.0967 0.0046 1

TGOP 0.4862e-2 -0.3570e-2 0.1041 0.0046 1

TTOPO VRF -0.0025 -0.0039 0.8868 0.0840 1

VGOP 0.0029 0.0055 0.8602 0.0392 1

Vcarga -0.0018 -0.0004 1.8877 0.0669 1

TGOP 0.0281 0.0527 0.8602 0.0392 1

Tabela A4 – Parâmetros da função de transferência para o modelo 4

 

MODELO CV MV/DV b0 b1 a1 a2 ?

5 C3
- VRF 0.5647e-3 -0.3536e-3 0.8165 0.0809 1

VGOP -0.4780e-3 -0.1427e-3 0.3417 0.0259 1

Vcarga 0.6786e-3 -0.1149e-3 0.9003 0.0712 1

TGOP -0.6481e-2 -0.1935e-2 0.3417 0.0259 1

C4
+ VRF -0.2862e-2 -0.1206e-2 1.1691 0.0716 1

VGOP 0.1352e-2 0.1303e-2 0.3245 0.0180 1

Vcarga -0.4581e-3 0.2032e-3 0.3565 0.0173 1

TGOP 0.1833e-1 0.1767e-1 0.3245 0.0180 1

TTOPO VRF -0.0021 -0.0019 1.1676 0.1069 1

VGOP 0.0081 0.0053 2.4190 0.1761 1

Vcarga -0.7616e-3 -0.5323e-3 0.9818 0.0549 1

TGOP 0.0766 0.0725 1.6731 0.1242 1

Tabela A5 – Parâmetros da função de transferência para o modelo 5



Apêndice A - Descrição sumária do HYSYS? 132

MODELO CV MV/DV b0 b1 a1 a2 ?

FD C3
- VRF 0.5656e-3 -0.2218e-3 3.4948 0.5902 1

VGOP -0.001452 0.00007413 2.6987 0.4023 1

Vcarga 0.0001125 -0.0001138 0.4559 0.03227 1

TGOP -0.01642 -0.01324 1.438 0.184 1

C4
+ VRF - - - - 1

VGOP - - - - 1

Vcarga - - - - 1

TGOP - - - - 1

TTOPO VRF -0.001235 -0.001135 1.6380 0.09852 1

VGOP 0.0020 -0.0003 2.4298 0.0651 1

Vcarga -0.0003829 0.0001715 0.2295 0.02632 1

TGOP 0.006970 0.001998 0.1731 0.01045 1

Tabela A6 – Parâmetros da função de transferência para o modelo da planta industrial


	IMPLANTAÇÃO DE UM CONTROLADOR MULTIMODELOS EM UMA COLUNA DEPROPANIZADORA INDUSTRIAL
	AGRADECIMENTOS
	SUMÁRIO
	RESUMO
	ABSTRACT
	1.INTRODUÇÃO
	1.1 - Apresentação da problemática de controle de colunas de pureza elevada
	1.2 - Revisão bibliográfica
	1.3 - Objetivo do trabalho

	2. PROBLEMA DE CONTROLE DA COLUNA DEPROPANIZADORA
	2.1 - Especificações dos produtos
	2.2 - Descrição do processo
	2.3 - Variáveis operacionais
	2.4 - Fatores de desempenho do sistema
	2.5 - Limitações do processo
	2.6 - Estratégias de controle da coluna depropanizadora

	3. DESCRIÇÃO SUMÁRIA DO HYSYS
	4. SIMULAÇÃO ESTÁTICA DA DEPROPANIZADORA
	5. SIMULAÇÃO DINÂMICA DA DEPROPANIZADORA
	6. COMPORTAMENTO DO PROCESSO
	7. IDENTIFICAÇÃO DOS MODELOS DO SISTEMA
	7.1 – Algoritmo de identificação com modelos na forma analítica
	7.2 – Modelos de processo identificados

	8. ALGORITMOS DE CONTROLE
	8.1 – MPC com modelo não-paramétrico
	8.2 – MPC com modelo de ordem reduzida

	9. APLICAÇÃO DO MPC À COLUNA DEPROPANIZADORA
	9.1 – Comparação QDMC e MMPC
	9.2 – Implantação do controlador MMPC na planta industrial

	10. CONCLUSÕES E SUGESTÕES
	10.1 – Conclusões
	10.2 – Sugestões

	REFERÊNCIAS BIBLIOGRÁFICAS
	APÊNDICE A

</field>
	</doc>
</add>