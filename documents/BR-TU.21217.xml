<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.21217</field>
		<field name="filename">4933_Vieira_PauloMarcosFernandes_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada à, Faculdade de Engenharia Mecânica Como Requisito Parcial à Obtenção do Título de Mestre em Engenharia de Petróleo
ANÁLISE AUTOMATIZADA DE TESTES DE PRESSÃO

Autor : Paulo Marcos Fernandes Vieira A"1 Orientador : Adalberto José Rosa
Dezembro de 1992
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA MECÂNICA
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação ’’Análise Automatizada de Testes de Pressão’" elaborada por Paulo Marcos Fernandes Vieira e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial para a obtenção do Título de Mestre em Engenharia de Petróleo.
Campinas, 17 de dezembro de 1992.
Banca Examinadora
Maria Cristina de Castro Cunha, Ph.D.
” Confie no Senhor de todo o seu coração, nunca pense que a sua própria capacidade é suficiente para vencer os problemas. ”
Provérbios 3:5 * A Bíblia Viva.
À minha esposa Ana Cristina, às minhas filhas Beatriz e Márcia e à minha mãe Yolanda.
Ao meu orientador Adalberto José Rosa pela presteza e dedicação com que conduziu o presente trabalho.
A Professora. Maria Cristina pelo apoio e sugestões dadas durante o decorrer do desenvolvimento desta dissertação.
Aos colegas, funcionários e professores do mestrado em Engenharia de Petróleo da UNICAMP pelo companheirismo com que compartilharam estes dois anos comigo.
A PETROBRAS pela oportunidade de aprimorar-me tecnicamente, dando o suporte financeiro para participar do Curso de Mestrado em Engenharia de Petróleo.
Resumo
A análise automatizada de testes de pressão em poços de petróleo tem como objetivo obter os parâmetros da formação através da utilização de técnicas de regressão não linear aplicadas aos dados de pressão de fundo versus tempo obtidos durante o período do teste.
Neste trabalho foram analisadas e comparadas as performances de vários métodos de regressão não linear aplicados a dados de testes de pressão. Alguns dos métodos considerados baseiam-se na minimização da norma L2, tais como: mínimos quadrados e decomposição em valores singulares. Outros minimizam a norma LR como mínimos valores absolutos (MVA), mínimos valores absolutos modificado (MVAM), método combinado MVAM-MVA e o método de Nelder-Mead.
Uma nova função penalidade foi proposta para o caso de otimização restrita em métodos que se baseiam na resolução de sistemas de equações lineares quadrados. Além disso, para métodos que se baseiam na solução de sistemas de equações lineares sobredeterminados, para os quais não se aplicam as funções penalidade convencionais, foram propostas mudanças nos domínios dos parâmetros com o objetivo de restringir a minimização a regiões física e matematicamente possíveis.
Concluiu-se que o método de mínimos valores absolutos modificado (MVAM) e o método combinado (MVAM-MVA) tem melhor desempenho do que os demais no que se refere ao número de iterações, à convergência a partir de estimativas iniciais pobres ou à robustez em relação a regiões onde o problema físico-matemático é mal posto.
Doís modelos de reservatório foram analisados: reservatório homogêneo infinito e reservatório de dupla porosidade infinito.
Foram comparados os resultados das regressões efetuadas com dados de pressão, com dados da derivada logarítmica da pressão e com o conjunto desses dados. Concluiu-se que o uso do conjunto de dados de pressão e de derivada torna os métodos mais robustos.
Diversos exemplos utilizando dados sintéticos ou reais foram discutidos neste trabalho.
Abstract
The objective of an automated well test analysis is to obtain formation parameters by using nonlinear regression techniques applied to bottom hole pressure versus time data collected during the test period.
In this work several nonlinear regression methods were analysed and their performances compared. Some of the methods considered are based on the L2-norm minimization, as the least squares and the singular value decomposition. Other methods minimize the Ll-norm, such as the least absolute values (LAV), modified least absolute values (MLAV), the combination (MLAV-LAV) and the Nelder-Mead’s method.
A new form of penalty-function was proposed to constrain the optimization in methods based on the solution of squared linear systems of equations. For methods based on the solution of overdetermined linear systems of equations, for which conventional penalty-functions can not be applied, changes in the domains of the unknown parameters were proposed in order to restrict the minimization to feasible (physically and mathematically) regions.
The modified least absolute values (MLAV) and the combined method (MLAV-LAV) presented the best performance among all methods considered in the study, concerning number of iterations, convergence from poor initial estimates or robustness with respect to infeasible regions.
Two reservoir models were analysed: infinite homogeneous reservoir and infinite double-porosity reservoir.
The results of the nonlinear parameter estimation using either pressure data, pressure derivative or pressure and derivative data were compared. The use of both pressure and derivative as the model function yielded better performance than using only pressure or pressure derivative data.
Various examples with synthetic and field data were discussed.
Conteúdo
1	INTRODUÇÃO	1
2	REVISÃO BIBLIOGRÁFICA.	3
3	MODELOS DE RESERVATÓRIO	ESTUDADOS.	5
3.1	Reservatório Homogêneo Infinito com Estocagem e Efeito de Película. ...	5
3.2	Reservatório Homogêneo de Dupla Porosidade Infinito com Estocagem e
Efeito de Película..........................................   7
3.2.1	Fluxo Pseudo-Permanente Matriz-Fratura................. 7
3.2.2	Fluxo Transiente Matriz-Fratura........................ 8
4	MÉTODOS DE REGRESSÃO NÃO LINEAR.	9
4.1	Métodos Baseados na Norma L2..............................    9
4.1.1	Mínimos Quadrados (MQ). ..............................  9
4.1.2	Decomposição em Valores Singulares (DVS). ............ 11
4.2	Métodos Baseados na Norma LI.............................    12
4.2.1	Método dos Mínimos Valores Absolutos (MVA). .......... 13
4.2.2	Método dos Mínimos Valores Absolutos Modificado (MVAM). ... 15
4.2.3	Método Combinado: Mínimos Valores Absolutos Modificado - Mínimos
Valores Absolutos (MVAM-MVA)..........................  15
4.2.4	Método de Nelder-Mead (NM). . ......................  .	16
4.3	Características dos Métodos..............................    19
4.3.1	Otimização Restrita...............................     19
4.3.2	Análise Estatística da Regressão. .  ................. 21
4.3.3	Distribuições Probabilísimas de Gauss e de Laplace...  22
4.3.4	Inversão Numérica da Transformada de Laplace. .......... 23
5	COMPARAÇÃO ENTRE OS MÉTODOS E DISCUSSÃO DOS RESULTADOS.	24
5.1	Análise de Casos de Reservatórios com Comportamento Homogêneo Infinito. 24
5.2	Análise de Casos de Reservatórios com Comportamento de Dupla Porosi-
dade Infinito. . .........................................    84
6	CONCLUSÕES e RECOMENDAÇÕES.	112
A ALGORITMO DE PROCURA LINEAR.	119
B DERIVADAS ANALÍTICAS DA QUEDA DE PRESSÃO EM RELAÇÃO AOS PARÂMETROS DE REGRESSÃO PARA RESERVATÓRIO HOMOGÊNEO INFINITO.	120
C ESQUEMA DE OBTENÇÃO NUMÉRICA DA DERIVADA DA QUEDA DE PRESSÃO PARA RESERVATÓRIO DE DUPLA POROSIDADE EM RELAÇÃO AOS PARÂMETROS DE REGRESSÃO.	122
D ESQUEMA DE OBTENÇÃO NUMÉRICA DA DERIVADA DA QUE-
DA DE PRESSÃO EM RELAÇÃO AO LOGARÍTMO DO TEMPO. 123
E LISTAGENS DE PROGRAMAS EM FORTRAN.
124
Lista de Figuras
4.1
4.2
4.3
4.4
4.5
4.6
5.1
5.2
5.3
5.4
5.5
5.6
5.7
5.8
5.9
5.10
5.11
5.12
5.13
5.14
5.15
Método de Nelder-Mead. Reflexão do ponto P..........................  17
Método de Nelder-Mead. Extensão da reflexão do ponto P............... 18
Método de Nelder-Mead. Contração da reflexão do ponto P...............18
Método de Nelder-Mead. Encolhimento do triâgulo original. ........... 18
Exemplificação de otimização restrita com intervalo fechado...........20
Exemplificação de otimização restrita com intervalo aberto........... 20
Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão nos dados de pressão. Caso 1...............................   32
Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão nos dados de pressão, Caso 1, , ..........................    32
Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão nos dados da derivada. Caso 1................................ 33
Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão nos dados da derivada. Caso 1. ................... . 33
Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 1.........34
Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 1.	......	35
Comportamento da média dos resíduos ao quadrado ao longo das iterações.
Caso 1. . ........................................................    36
Comportamento da média dos valores absolutos dos resíduos ao longo das iterações. Caso 1. ...... .......................................     37
Comportamento da permeabilidade ao longo das iterações. Caso 1........38
Comportamento do fator de película ao longo das iterações. Caso 1.....39
Comportamento do coeficiente de estocagem ao longo das iterações. Caso 1. 40
Variação dos parâmetros ao longo das iterações no plano k-S para os vários métodos. Caso 1. ...... .......................................  .	41
Variação dos parâmetros ao longo das iterações no plano k-C para os vários
métodos. Caso 1. . . ...........................................    42
Variação dos parâmetros ao longo das iterações no plano S-C para os vários
métodos. Caso 1. ...... ........................................    42
Curvas de nivele superfície geradas pela norma L2 para C — 0.00847 bbl/psi
, Caso 1. ........ .............................................    44
5.16
5.17
5.18
5.19
5.20
5.21
5.22
5.23
5.24
5.25
5.26
5.27
5.28
5.29
5.30
5.31
5.32
Ampliação das curvas de nível e superfície geradas pela norma L2 para
C = 0.00847 bbl/psi. Caso 1.................................................45
Curvas de nível e superfície geradas pela norma LI para C ~ 0.00842 bbl/psi
. Caso 1...............................................................     46
Ampliação das curvas de nível e superfície geradas pela norma LI para
C = 0.00842 bbl/psi . Caso 1............................................    47
Curvas de nível e superfície geradas pela norma L2 para k = 15.16 mD .
Caso 1. ........ .......................................................... 48
Ampliação das curvas de nível e superfície geradas pela norma L2 para k — 15.16 mD . Caso 1...................................................    49
Curvas de nível e superfície geradas pela norma LI para k = 13.47 mD .
Caso 1................................................................      50
Ampliação das curvas de nível e superfície geradas pela norma LI para k = 13.47 mD. Caso 1......................................................  51
Curvas de nível e superfície geradas pela norma L2 para S - 14.38 . Caso 1. 52 Ampliação das curvas de nível e superfície geradas pela norma L2 para
S	= 14.38 . Caso 1. ..... ................................................ 53
Curvas de nível e superfície geradas pela norma LI para 8 = 11.97 . Caso 1. 54 Ampliação das curvas de nível e superfície geradas pela norma LI para
S	= 11.97 . Caso 1.................................................      .	55
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados de pressão usando o método MQ. Caso 1. 57
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados de pressão usando o método MVA. Caso 1. 57
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados da derivada usando o método MQ. Caso 1. 58
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados da derivada usando o método MVA.
Caso 1. . ...............................................................      58
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MQ. Caso 1.................................................    59
Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MVA. Caso 1. ...... .........................................  59
5.33	Pr es síÍo e Derivada da Pressão versus Tempo em escala log-log, para re-
gressão no conjunto de dados de pressão e da derivada. Caso 2.	........64
5.34	Pressão e Derivada da Pressão versus Tempo em escala semi-log, para re-
gressão no conjunto de dados de pressão e da derivada. Caso 2.	........... 64
5.35	Variação dos parâmetros ao longo das iterações no plano k-S para os vários
métodos. Caso 3......................................................  71
5.36	Variação dos parâmetros ao longo das iterações no plano k-C para os vários
métodos. Caso 3. . ..............................................    .	72
5.37	Variação dos parâmetros ao longo das iterações no plano S-C para os vários
métodos. Caso 3. . ...............................................     72
5.38	Pressão e Derivada da Pressão versus Tempo em escala log-log, para re-
gressão no conjunto de dados de pressão e da derivada. Caso 3..........73
5.39	Pressão e Derivada da Pressão versus Tempo em escala semi-log, para re-
gressão no conjunto de dados de pressão e da derivada. Caso 3.	...... 74
5.40	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão nos dados de pressão usando o método MQ. Caso 3. 74
5.41	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão nos dados de pressão usando o método MVA. Caso 3. 75
5.42	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão nos dados da derivada usando o método MQ. Caso 3. 75
5.43	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão nos dados da derivada usando o método MVA. Caso 3. . . . .............................................................   76
5.44	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MQ. Caso 3..................................................  76
5.45	Comparação entre a distribuição real dos erros e as distribuições de Gauss
e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MVA. Caso 3.................................................  77
5.46	Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 4.	..... 81
5.47	Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 4.................81
5.48	Pressão e Derivada de Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 5.................90
5.49	Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 5.	...... 91
5.50	Comportamento da média dos resíduos ao quadrado ao longo das iterações.
Caso 5. . . .....................................................  91
5.51	Comportamento da média dos resíduos absolutos ao longo das iterações.
Caso 5. ..... ..................................................   92
5.52	Comportamento da permeabilidade ao longo das iterações. Caso 5.	.... 92
5.53	Comportamento do fator de película ao longo das iterações. Caso 5. . . , . 93
5.54	Comportamento do coeficiente de estocagem ao longo das iterações. Caso 5. 93
5.55	Comportamento do coeficiente de fluxo interporoso A ao longo das iterações.
Caso 5.......................................................      94
5.56	Comportamento da razão de armazenamentou» ao longo das iterações. CasoS. 94
5.57	Variação dos parâmetros ao longo das iterações no plano k-S para os vários
métodos. Caso 5. ....... ......................................... 95
5.58	Variação dos parâmetros ao longo das iterações no plano k-C para os vários
métodos. Caso 5..................................................  95
5.59	Variação dos parâmetros ao longo das iterações no plano k-A para os vários
métodos. Caso 5. ..............................................    96
5.60	Variação dos parâmetros ao longo das iterações no plano k-w para os vários
métodos. Caso 5. ........ ......................................   96
5.61	Variação dos parâmetros ao longo das iterações no plano A-w para os vários
métodos. Caso 5. ...............................................   97
5.62	Variação dos parâmetros ao longo das iterações no plano S-w para os vários
métodos. Caso 5. ..............................................    97
5.63	Pressão e Derivada de Pressão versus Tempo em escala log-Iog, para regressão no conjunto de dados de pressão e da derivada. Caso 6.	...... 98
5.64	Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 6......  .	99
5.65	Pressão e Derivada de Pressão versus Tempo em escala log-Iog, para regressão no conjunto de dados de pressão. Caso 7. .................104
5.66	Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão nos dados de pressão. Caso 7. ..... ....................  107
5.67	Pressão e Derivada de Pressão versus Tempo em escala log-Iog, para regressão nos dados de pressão e da derivada. Caso 7............., . , , . 107
5.68	Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 7...  108
Lista de Tabelas
4.1	Proposta de modificação dos domínios dos parâmetros. ..........  ,	21
5.1	D ¿idos de reservatório para os casos 1 e 2..................    .	24
5.2	Dados de pressão versus tempo para o caso 1......................  25
5.3	Comparação do desempenho de vários métodos de regressão para os dados
do caso 1. . ...................................................   28
5.4	Estimativas iniciais utilizadas para vários métodos de regressão para os
dados do caso 1 e do caso 2. .......... .........................  30
5.5	Resultados dos vários métodos de regressão, Caso 1, Estimativas iniciais
da tabela 5.4..............................................        31
5.6	Ruídos introduzidos nos dados de pressão. Caso 2. . . .............56
5.7	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 2. . . . ........................................      61
5.8	Resultados dos Vários Métodos de Regressão. Caso 2. Estimativas iniciais
na tabela 5.4 .	............................................... 63
5.9	Dados de Teservatório para o caso 3............................    65
5.10	Dados de pressão versus tempo para o caso 3. ................ 66
5.11	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 3................................................      67
5.12	Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os
dados do caso 3...............................................     69
5.13	Resultados dos Vários Métodos de Regressão. Caso 3. Estimativas iniciais
na tabela 5.12 .	................................................. 70
5.14	Dado3 de reservatório para o caso 4............................... 77
5.15	Dados de pressão versus tempo para o caso 4......................  78
5.16	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 4. . . . ............................................  80
5.17	Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os
dados do caso 4. ............ ...................................  82
5.18	Resultados dos Vários Métodos de Regressão. Caso 4. Estimativas iniciais
na tabela 5.17 .	................................................. 83
5.19	Dados de reservatório para os casos 5 e 6. ....  ................  84
5.20	Dados de pressão versus tempo para o caso 5.  ...................  85
5.21	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 5...................................................... 86
5.22	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 5. ........ . .............................. ..........	87
5.23	Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os
dados do caso 5 e do caso 6..............................  ........	88
5.24	Resultados dos Vários Métodos de Regressão. Caso 5. Estimativas iniciais
na tabela 5.23. ................................................    89
5.25	Ruídos introduzidos nos dados de pressão. Caso 6. ....... .........99
5.26	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 6. . . ..............................................  100
5.27	Comparação do Desempenho de Vários Métodos de Regressão para os da-
dos do caso 6....................................................  101
5.28	Resultados dos Vários Métodos de Regressão. Caso 6 . Estimativas iniciais
na tabela 5.23................ ....................................102
5.29	Dados	de reservatório para o caso 7...............................104
5.30	Dados	de pressão versus tempo para o caso 7. ...................  105
5.31	Dados	de pressão versus tempo para o caso 7. ..................  106
5.32	Pontos de mínimos locais e mínimo absoluto para os dados do caso 7 quando
submetidos às normas L1 e L2...................................    109
5.33	Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os
dados do caso 7. . . ............................................  110
5.34	Resultados dos Vários Métodos de Regressão. Caso 7 . Estimativas iniciais
na tabela 5.33 .	..................................................111
1	INTRODUÇÃO
Os métodos automatizados de determinação de parâmetros de reservatórios com auxílio de computador estão recebendo especial atenção atualmente. Podemos listar algumas razoes para isto:
•	Os métodos automatizados permitem uma análise estatística da qualidade da estimativa dos parâmetros, calculando-se, por exemplo, intervalos de confiança.
•	Testes em que certas condições necessárias para permitir o uso de métodos convencionais não são satisfeitas (exemplo: longos períodos de teste para atingir determinado regime de fluxo) podem ser analisados através de métodos automatizados.
•	Testes com vazão variável, múltiplos fluxos seguidos de crescimento de pressão ou testes de injeção podem ser analisados utilizando técnicas apropriadas de superposição.
•	Os históricos completos de pressão e vazão do teste podem ser utilizados em programas de ajuste automatizado se necessário, ao invés de um pequeno histórico antes do fluxo ou crescimento como é feito nos métodos convencionais. Este procedimento fornece parâmetros de reservatório mais consistentes com os dados de teste, bem como permite uma melhor avaliação da escolha do modelo de reservatório.
•	Reservatórios com geometrias complexas podem, em princípio, ser simulados utilizando soluções já existentes, o que, no caso dos métodos convencionais ou daqueles baseados em curvas-tipo, exigiria a construção de inúmeras curvas para que se pudesse efetuar o ajustamento.
« 0 aumento do uso de computadores com alta capacidade de memória e baixo custo implicam na possibilidade de se utilizarem programas mais complexos e distribuí-los para as locações remotas. A grande vantagem deste procedimento é ter uma ferramenta poderosa para a análise na própria locação exploratória, o que pode ajudar o engenheiro no projeto e na simulação de testes, no monitoramento do progresso do teste e na aquisição e avaliação dos dados na boca do poço.
0 tipo de automatização discutido neste trabalho se restringe à utilização de métodos de regressão não linear aplicados a dados de testes de pressão em poços de petróleo.
podemos verificar um considerável aumento na pesquisa de métodos mais robustos de regressão não linear na última década.
0 principal objetivo de tais métodos é estimar os parâmetros do reservatório a partir de quaisquer que sejam as estimativas iniciais, dentro de seus respectivos domínios, de tal forma que o processo convirja para os valores corretos.
Neste trabalho serão comparados os desempenhos de vários métodos de regressão não linear aplicados a dois modelos de reservatório: radial infinito homogêneo e radial infinito de dupla porosidade.
Os principais métodos aqui discutidos serão aqueles baseados na norma L2 (mínimos quadrados através do método de Gauss-Newton modificado por Levenberg-Marquardt e decomposição em valores singulares) e aqueles baseados na norma L1 (mínimos valores absolutos, mínimos valores absolutos modificado e método de Nelder-Mead). Serão também propostas modificações destes métodos com o intuito de torná-los mais robustos e garantir o significado físico dos parâmetros estimados.
2	REVISÃO BIBLIOGRÁFICA.
A maior parte dos métodos de regressão não linear apresentados na literatura se baseia no método de Newton, onde a função a ser minimizada, o somatório dos quadrados dos residuos, é aproximada por urna séríe de Taylor truncada no termo quadrático. Tais métodos, além de requererem a obtenção da segunda derivada da função em questão, ge.ralm.ente de difícil cálculo, não terão garantia de convergência se a estimativa inicial dos parâmetros estiver muito longe dos valores corretos, pois a matriz Hessiana pode não ser positiva definida longe do valor correto. Somente próximo aos valores corretos os resíduos tendem a valores bem pequenos e são estes residuos que multiplicam as segundas derivadas, tornando portanto estes termos desprezíveis. Devido a este problema é que cada vez mais se procura robustecer estes métodos através de modificações.
Posteriormente ao trabalho de Newton, Gauss propôs uma modificação, atualmente conhecida com método de Gauss-Newton, onde, para simplificar o cálculo, se desprezava o termo que inclui as segundas derivadas. Uma outra vantagem do método de Gauss-Newton é que ele produz uma matriz Hessiana positiva definida. A modificação de Gauss, no entanto, como era de se esperar, tomou o método mais sensível às estimativas iniciais. A justificativa para a aproximação de Gauss-Newton, como já mencionado acima, é que próximo aos valores corretos os resíduos tendem a valores bem pequenos e como são eles que multiplicam as segundas derivadas, tornam estes termos desprezíveis garantindo a característica de positiva definida à matriz Hessiana.
Levenberg [1] e posteriormente Marquardt [2] propuseram que, para melhorar o condicionamento da matriz Hessiana (matriz que contém as derivadas da função do método de Gauss-Newton em relação aos parâmetros de regressão), se adicionasse uma constante positiva à diagonal desta matriz. Com tal modificação, o método de Gauss-Newton modificado por Levenberg-Marquardt tornou-se mais robusto.
A aplicação destes métodos à análise de testes de pressão em poços de petróleo já tem um histórico considerável, podendo ser mencionados os seguintes trabalhos:
Jahns [3] elaborou um procedimento automatizado para a descrição bidimensional de um reservatório aplicando uma combinação de simulação e análise de regressão utilizando dados de testes de interferência.
Coais, Dempsey e Henderson [4] apresentaram um método de caracterização de reservatórios, similar ao de Jahns, onde empregaram uma combinação do método de mínimos quadrados e de programação linear aplicados a um histórico de pressões.
Thomas, Hellums e Reheis [5] aplicaram os métodos propostos por Jahns e por Coats, Dempsey e Henderson em dois reservatórios, um de gás e um de óleo.
Earlougher e Kersh [6] apresentaram os resultados da regressão não linear para determinação de parâmetros de reservatório aplicadas a dois casos: um teste de interferência e um teste de ^fall-ofP,
Hernández e Swift [7] aplicaram o método de mínimos quadrados utilizando uma pseudo-linearização entre os dados medidos e os parâmetros de reservatório.
Rodgers et alü [8] utilizaram a regressão não linear para estimativa de parámetros de reservatórios limitados.
Rosa e Horne [9] estudaram a aplicação do método de Gauss-Newton. modificado por Levenberg-Marquardt, bem como o método de Gauss-Newton original, a reservatórios homogêneos infinitos e reservatórios infinitos com múltiplas camadas sem fluxo cruzado. Urna grande contribuição deste trabalho foi mostrar que as derivadas da pressão em relação aos parâmetros de regressão podem ser obtidas no campo de Laplace, com posterior inversão numérica.
Barua, Kucuk e Gómez-Angulo [10] aplicaram o método de mínimos quadrados a reservatórios de dupla porosidade.
Barua ei alii [11] compararam vários métodos tipo Newton aplicados a dados de reservatórios homogêneos e de dupla porosidade.
Nanba e Home [12] analisaram o método de Newton, o método de Gauss-Newton, a modificação proposta por Levenberg-Marquardt e a fatorização de Cholesky com e sem a modificação introduzida por Gill e Murray [13].
Rosa e Horne [14] apresentaram os resultados da comparação entre os métodos mínimos quadrados e mínimos valores absolutos aplicados à regressão não linear em dados de reservatórios homogêneos e de dupla porosidade.
Coelho [15] aplicou o método desenvolvido por Greeenstadt [16] a reservatórios estratificados com e sem fluxo cruzado.
Carvalho et alii [17] analisaram um novo procedimento para a aplicação do método de mínimos valores absolutos que, segundo estes autores, utiliza algoritmos desenvolvidos para o método de mínimos quadrados.
3	MODELOS DE RESERVATÓRIO ESTUDADOS.
Neste capítulo serão apresentados os modelos matemáticos dos reservatórios estudados neste trabalho, bem como as definições dos parâmetros estimados.
3.1	Reservatório Homogêneo Infinito com Estocagem e Efeito de Película.
0 problema aqui analisado tem as seguintes hipóteses básicas:
• reservatório radial, horizontal, infinito, isotrópico, isotérmico e homogêneo.
• poço com raio finito igual a rw.
• finido de compressíbilidade pequena e constante, e viscosidade constante.
• efeito de película infinitesimal.
• estocagem constante.
A equação diferencial em variáveis adimensionais que rege o fluxo no reservatório pode ser escrita como:
_1_d f dpD\ _ dpo
rDdrD \drDj 9tD
1 &amp;lt;rD &amp;lt;&lt;x)	; tD &gt; 0
com as seguintes condições inicial e de contorno:
lim pd(td,ío) — 0	;	&gt; 0
1 &amp;lt;rs &amp;lt;oo
Cd
dtD
tD &gt; 0
to &gt; 0
(3.1)
(3.2)
(3.3)
(3.4)
(3-5)
Pd(Hj,0) -0
As variáveis adimensionais são definidas como;
Po(ro, *d) =
ÍW&gt;(M = Pd(Cíd) s
kh
(3.7)
(3.8)
0.894(7 r^Ztct
0.000263í¿¿
(3.10)
onde utilizamos as unidades de campo inglesas e p é a pressão, ç é a vazão medida em condições de superfície, h é a espessura do reservatório, /: é a permeabilidade, Béo fator volume de formação, p é a viscosidade de fluido, C é o coeficiente de estocagem, r é a distância radial, p é a porosidade, cj é a compressibilidade total do sistema, t é o tempo e S é o fator de película.
Aplicando a transformada de Laplace à equação diferencial e às condições de contorno e resolvendo o problema, chegamos à seguinte solução no campo de Laplace:

Pwd(u) =
1
Ki(y/ty
(3-11)
Ki(TS)	1
onde Kq e K\ são funções de Bessel modificadas de ordem zero e ordem um respectivamente e u é o argumento no campo de Laplace.
O desenvolvimento de tal solução pode ser encontrado na referência [18].
As derivadas da queda de pressão em relação aos parâmetros da regressão foram obtidas analiticamente e sua dedução está apresentada no apêndice B. Estas derivadas, como será mostrado adiante, são nescessárias na aplicação de alguns métodos de regressão não linear.
Os parâmetros que serão obtidos através da regressão não linear para este tipo de reservatório são a permeabilidade (k), o fator de película (S) e o coeficiente de estocagem (C). Os demais parâmetros necessários para o cálculo da queda de pressão são considerados conhecidos.
3.2	Reservatório Homogêneo de Dupla Porosidade Infinito com Estocagem e Efeito de Película.
0 problema aqui analisado tem as mesmas hipóteses básicas do item anterior, com exceção do acoplamento entre a matriz e as fraturas.
A solução para a queda de pressão adímensional no poço para este tipo de reservatório, no campo de Laplace, é dada por [19]:


As variáveis adímensionais também são as mesmas definidas no item anterior, sendo utilizados a permeabilidade da fratura, e	a estocabilidade do
sistema fratura-matriz, nas definições das equações 3,6, 3.7, 3.9 e 3,10.
A função /(u) representa o tipo de acoplamento entre a matriz do reservatório e as fraturas. Neste trabalho examinaremos dois casos, fluxo pseudo-permanente e fluxo transiente.
Nestes casos os parâmetros obtidos pela regressão não linear são a permeabilidade da fratura (&amp;amp;/r), o fator de película (S'), o coeficiente de estocagem (C), a razão de armazenamento (w) e o coeficiente de fluxo interporoso (À).
3.2.1	Fluxo Pseudo-Permanente Matriz-EYatura.
Warren e Root [19] propuseram este tipo de formulação para acoplar a matriz às fraturas do reservatório. Neste caso a função f(u) é dada por:
w(l ~w)u + À (l-w)u + X
onde:
+ (d’VCí)m]
__ arlkm
A kt
&amp;amp;jr
(3.13)
(3.14)
(3.15)
o - fator de forma.
3.2.2	Fluxo Transiente Matriz-Fratura.
De Swaan [20] propôs um acoplamento entre a matriz e as fraturas modelando a matriz como sendo um conjunto de esferas homogeneamente distribuídas numa rede de fraturas. Através deste modelo, De Swaan chegou à seguinte função de acoplamento:
onde u? e A são os mesmos definidos anteriormente.
Esta solução é, em termos práticos, equivalente àquela encontrada modelando a matriz e as fraturas como placas horizontais paralelas, cuja equação pode ser escrita como:
/íu) = w +
(3.17)
4	METODOS DE REGRESSÃO NÃO LINEAR.
Os métodos de regressão analisados neste trabalho foram basicamente dois: os que utilizam a norma Ll, ou seja, minimizam o somatório dos valores absolutos ou módulos das diferenças entre as pressões medidas em campo e as calculadas pelos modelos e os métodos baseados na norma L2, onde o qne é minimizado é o somatório das diferenças ao quadrado.
Neste capítulo serão apresentadas as formulações matemáticas de cada método, seja ele baseado na norma LI ou L2. Também serão discutidas as modificações efetuadas em cada método para melhorar sua robustez bem como para garantir um significado físico aos parâmetros por eles determinados. Paralelamente será analisada uma maneira aproximada de determinar os intervalos de confiança dos parâmetros e serão apresentadas as formas das distribuições probabilísticas de Gauss e de Laplace associadas às normas LI e L2 respectivamente.
4.1	Métodos Baseados na Norma L2.
Os métodos de regressão baseados na norma L2 foram os que tiveram aplicação mais acentuada a dados de testes de pressão. Quase todos eles baseiam-se no método doa mínimos quadrados, onde se procura minimizar o somatório dos quadrados das diferenças entre os valores obtidos em campo e os valores da função calculados nos pontos dados para um determinado vetor ã de parâmetros estimados. Outro método baseado na minimização da norma L2 é a decomposição em valores singulares.
4.1.1	Mínimos Quadrados (MQ).
A função-objetivo a ser minimizada no método de mínimos quadrados é:
£2(5)= Efr.-íXa*.)!2	(4i)
onde npon é o número de pontos dados, x é a variável independente, Fea função que representa o modelo matemático e y é o valor de F medido.
Este método consiste em se minimizar a função-objetivo acima através da aproximação da função por uma série de Taylor. No caso do método de Newton, a série de Taylor é truncada no termo quadrático, dando um caráter parabólico à função E^i aproximação de E-^ o que, em princípio, garantiría um ponto de mínimo. Então:
npar
E2-(ã) = E2(õy +£(«*- aj) fc=l
onde npar é o número de parâmetros e o0 uma estimativa inicial para o vetor a a ser estimado.
Como queremos minimizar E^ derivamos a expressão anterior em relação a (üj — Qj), que denominamos :
W
npar
i=l
d2E2 \
(4-3)
j - 1,2,...,npar
Como desejamos um mínimo, então dE^/d^j ~ 0. Daí:
npar
Temos portanto um sistema de npar equações com npar incógnitas em onde:
np&amp;amp;rt
“2 52 “ ^(“0’ x*)3 í=i
(4.5)
dF dF dotj ôetk
+ [pi - F(a0,3q)]
(4.6)
Podemos então escrever a equação 4.4 como:
onde H é conhecida como matriz Hessiana e u é o vetor que contém os resíduos.
Uma vez resolvido o sistema acima e determinado o vetor /?, achamos os novos parâmetros através de:
aj = a“ + pdj
(4-8)
onde p é um fator de relaxação.
Uma das dificuldades do método de Newton é que o valor para o qual a solução converge pode não ser um mínimo. Isto pode ocorrer se a superfície tiver pontos de sela ou de máximo, o que, infelizmente, é muito comum nas aplicações em análise de testes. Para o valor final de E? ser um mínimo, a matriz Hessiana deve ser positiva definida. Ela sempre é positiva definida nas vizinhanças de um mínimo, mas pode não ser em pontos distantes. 0 método de Newton sempre converge se a estimativa inicial estiver próxima de mínimo, mas pode não convergir caso contrário, geralmente divergindo quando isto ocorre.
Gauss propôs uma modificação no método de Newton no qual desprezam-se os termos da matriz Hessiana representados pela segunda derivada, que geralmente são de difícil cálculo. Porém tal procedimento tem um preço em termos de robustez do método, tornando-o mais sensível às estimativas iniciais.
Posteriormente Levenberg [1] e Marquardt [2] propuseram uma alteração no método de Gauss-Newton na qual, para melhorar o condicionamento da matriz Hessiana, soma-se a ela uma matriz diagonal D cujos elementos são iguais a uma constante positiva de valor Xl-m- Após o cálculo da função resíduo na etapa n +1, se esta for menor que na etapa anterior, modifica-se o valor de Xl-m para Á¿_,u/10, caso contrário para
4.1.2	Decomposição em Valores Singulares (DVS).
Outra maneira de formular o problema é escrever o desenvolvimento de uma série de Taylor até o primeiro termo em cada ponto X{ ao redor de uma estimativa ou seja:
yi ~ Fía^Xi) + (ax - a?)
+ (a2 - a$)
i — l,npon

Como temos npon equações e npar incógnitas ( npon &gt;&gt;&gt; ripar ) , temos um sistema sobredeterminado (ou retangular) que pode ser resolvido através da decomposição em valores singulares. Este método resolve o problema de forma similar aos mínimos quadrados, ou seja, ele minimiza a função x2 abaixo:
E&gt;(3) = X2 = IA.0-	(4.10)
onde:
A é o Jacobiano da função F em relação aos parâmetros a em cada ponto xt, é o vetor incógnita.
Ò é composto dos resíduas em cada ponto xí, ou seja,
.12
b = yi~ F(a0,xi).
A demonstração da afirmação acima pode ser encontrada na referência [21] .
A decomposição em valores singulares, como o próprio nome já Índica, decompõe a matriz A em tres outras matrizes, a saber:
/
A
\ /
U
/ \
W2
	/	\
		
	\	/
(4.11)
onde UeV são matrizes ortonormais, ou seja, a multiplicação de U por UT e de V por V? é igual à matriz identidade. A matriz W é uma matriz diagonal com elementos positivos ou de valor igual a zero.
Na referência [21] é demonstrado que se A é uma matriz do sistema A . ¡3 ~ b, com a sua decomposição podemos obter d através de:
£ = V [diag (1/wj)] (17Tb)	(4.12)
onde a matriz diagíl / w-j) é uma matriz diagonal composta pelos inversos dos valores da matriz diagonal W.
4.2	Métodos Baseados na Norma Ll.
A norma Ll baseia-se na mimmização da seguinte função objetivo:
£i(o) ~ E	(4.13)
i=sl
Apesar da minimização do somatório dos módulos das diferenças entre os valores medidos em campo e os calculados analiticamente ser a primeira idéia que ocorre na determinação de parâmetros não lineares, tal procedimento não teve desenvolvimento imediato devido à dificuldade de se manipular a função módulo analiticamente, pois tal função não tem uma derivada contínua.
Se fizermos um pequeno raciocínio sobre este método, notaremos que nos casos em que os erros experimentais forem grandes em apenas alguns pontos, o que normalmente ocorre, este método deve ter melhor desempenho que o de mínimos quadrados, pois este último tende a dar peso maior (o resíduo é elevado ao quadrado) a pontos com grande afastamento da curva, desviando a curva em direção a eles.
4.2.1	Método dos Mínimos Valores Absolutos (MVA).
Rosa e Horne [14] utilizaram em seu trabalho um algoritmo que minimizava a soma dos módulos numa regressão linear múltipla. Para aplicá-lo numa regressão não linear, estes autores propuseram a metodologia apresentada abaixo.
Desenvolvamos em série de Taylor até o primeiro termo um determinado ponto da função-modelo F:
yi ~ F(aQ, Xi) + (ttj - aj)
4" ■ • ■ 4* ( íiripdr
i = 1,... ¡npon,
(4.14)
Rearranjando o sistema acima, temos:
yi - F(a0, Xi) ~ (oti - a?)
/	o J \
+ . , . + (Ctnpar anpar) I	I
K^npar/^-t = 1,... ,npon
onde o problema agora é de uma regressão linear. Conforme discutido por Rosa e Horne [14], pode ser feita uma regressão linear múltipla nas equações 4.15 minimizando não mais o somatório das diferenças ao quadrado, mas sim o somatório dos módulos das diferenças.
A equações 4.15 podem ser reescritas da seguinte maneira:
Wi — ¿31	+ $2^í,2 + ' • - + finparVi,npaT !	2 — 1,... , npon
onde:
Wi ~yi~ F(oo, aq) ; i = l,npon
Pj =	; j = 1, npar
dF(ã, Xi) daj
i — 1,npon ; j = 1,npar
«0
A cada iteração da regressão linear múltipla aplicada à equação 4.16, após o cálculo de ¿3, obtemos os novos valores de a , ou seja:
- a* + £	(4.20)
Outra maneira de se minimizar a soma dos módulos dos resíduos foi proposta em 1979 por El-Attar, Vidyasagar e Dutta [23] e utilizada recentemente por Carvalho et alii [17], Segundo estes últimos autores, este método tem a vantagem de utilizar algoritmos de regressão não linear baseados na norma L2. Tal procedimento é baseado na minimização da seguinte função:
npcm ........
Ei (o) = jr y/rl+E	(4.21)
onde Ff são os resíduos e e é um número suficientemente pequeno. EI-Attar, Vidyasagar e Dutta [23] mostraram que a equação 4.21 é minimizada para valores decrescentes de £ e a solução a* para a, qual a sequência converge quando t —+ 0 é uma solução para a norma Ll. Em outras palavras, a equação 4.21 pode ser reescrita em termos de uma norma L2 equivalente, ou seja:
npon
£1(5) = E P2i&amp;lt;4-22) 1=1
onde:
Pí = (^ + c)1/4	(4.23)
As vantagens de tal procedimento, segundo Carvalho et alii [17], são: i) as derivadas parciais da equação 4.22 são obtidas facilmente e são válidas em todo o domínio; ii) os algoritmos de solução da norma L2 são de domínio público e podem ser aplicadas a este problema.
Este método não será analisado no presente trabalho, porém cabe aqui comentar que o segundo argumento a favor deste procedimento não é mais válido pois já existem vários pacotes de rotinas matemáticas que dispõem de algoritmos para solução de regressões baseadas na norma Ll, bem como o método MVAM que também se utiliza de rotinas da norma L2 para resolver um problema baseado na norma Ll.
4.2.2	Método dos Mínimos Valores Absolutos Modificado (MVAM).
Uma outra maneira de se obter o mínimo da função somatório dos módulos dos resíduos é utilizar uma modificação no método de mínimos quadrados acrescentando-se um peso a cada ponto. Este peso é proporcional ao inverso do módulo do resíduo naquele ponto na iteração anterior. Em outras palavras, a nova função objetivo pode ser escrita como:
èí
onde n representa o número da iteração.
Esta forma da função objetivo já foi utilizada anteriormente por Schlossmacher
[24], aplicada a problemas lineares.
Como podemos notar através da fórmula acima, quanto mais nos aproximamos dos valores corretos, mais o termo do somatório tende ao valor de módulo do resíduo, ou seja, estamos minimizando, no limite, a norma Ll.
Um problema que pode ocorrer neste método é a instabilidade numérica devida à presença de resíduos muito pequenos. Tal problema foi resolvido neste estudo desprezando-se os resíduos menores que um certo valor mínimo. 0 valor utilizado neste trabalho foi de 10~9 quando se utilizam os valores de pressão em atm. Este valor foi determinado partindo-se do valor 10~3 e diminuindo-o até que não houvesse modificação nos resultados, tanto em termos de número de iterações como nos valores determinados.
Outra pequena inconveniência que este método geralmente apresenta é a necessidade de um grande número de iterações para se alcançar a convergência.
4.2.3	Método Combinado: Mínimos Valores Absolutos Modificado - Mínimos Valores Absolutos (MVAM-MVA).
Para aproveitar as vantagens dos dois métodos acima descritos, podemos combiná-los. Esta combinação foi proposta por llosa [22]. Naquele trabalho o autor usou o método MVAM durante as cinco primeiras iterações, passando a seguir para o método MVA, aproveitando a robustez do MVAM em relação à convergência a partir de estimativas Iniciais distantes da solução. Neste trabalho a troca de um método para outro é feita quando as variações dos parâmetros entre duas iterações consecutivas é menor que um valor limite prefixado. Esta troca é vantajosa pois, quando o método converge, o MVA é muito mais rápido que o MVAM.
Neste trabalho foi utilizado ainda outro critério para troca do MVAM para o MVA, o qual se baseava na variação do resíduo ao invés das variações dos parâmetros. Tal procedimento não se mostrou o melhor devido a problemas de divergência em alguns
casos, e foi abandonado.
4.2.4	Método de Nelder-Mead (NM).
Este método, cuja descrição pode ser encontrada na referência [25], não é propriamente uma norma Ll, pois através dele podemos minimizar qualquer norma pré-estabelecida.
Neste trabalho testaremos a aplicação deste método à análise automatizada de testes.
0 método NM utiliza o método simplex para localizar um mínimo local de uma função de várias variáveis. Para melhor exemplificar examinemos o caso de uma função de duas variáveis. Neste caso o simplex é um triângulo, onde o procedimento do método NM compara o valor da função em cada vértice do triângulo (já neste ponto notamos uma grande diferença em relação aos outros métodos, pois ele necessita de um número de estimativas iniciais igual ao número de parâmetros da regressão mais um). 0 pior vértice do triângulo é rejeitado e um novo ponto é calculado. Através deste procedimento um novo triângulo é gerado e o algoritmo de procura reinicia. Este processo gera uma sequência de triângulos (que devem ter diferentes formas) em cujos vértices a função se toma cada vez menor. Finalmente o tamanho dos triângulos é diminuído e o mínimo é encontrado.
Para melhor entendermos este exemplo, utilizemos uma função /(x,j/) a ser minimizada. Para começarmos o processo necessitamos de tres vértices para montar o triângulo; H	fe = 1,2,3. A função	é então avaliada em cada um
destes tres pontos, %k =	k = 1,2,3. Os subscritos são então reordenados para
que Zi &amp;lt;z% &amp;lt;*3 - Usemos então a seguinte notação:
£ = (zi^i) ^ = (^2,^) ^=(^3,^3)
para tornar o exemplo mnemónico: E é o vértice excelente, B é o bom e P é o pior.
0 processo de construção do novo triângulo utiliza o ponto médio do segmento que une E a B. Ele é encontrado através da média das coordenadas, ou seja:
M =
E d- B
2
=(
(4.25)
Sj +32
2
yi +?2\
2 )
A função diminui quando nos movemos no lado do triângulo inicial de P para E e também diminui quando nos movemos de P para B. Então é fácil raciocinar que a função também diminuirá quando caminharmos para longe de P em direção ao lado oposto da linha que une E a B, Escolhemos então o ponto R “refletindo" o triângulo através do lado EB. Então para determinarmos R, primeiro determinamos M, o ponto médio entre E e B, desenhamos um segmento de reta de P a M determinando seu comprimento d.
Estendemos este último segmento uma distância d a partir de M para localizar o ponto
R (ver figura 4.1). Vetorialmente o ponto R é calculado por:
R = M + (M - P) = 2M - P	(4.26)
Se o valor da função no ponto R for menor que o valor da função no ponto P estamos nos movendo na direção correta para encontrarmos o mínimo, Se além disso o valor da função em R for menor do que em E, podemos então estender o triângulo EBR para o triângulo EBF, onde F é encontrado movendo-se uma distância d adicional ao longo da reta MR a partir de R (ver figura 4.2 ). Se o valor da função em F for menor que em R, achamos então um vértice melhor. O cálculo vetorial de F é:
(4-27)
Figura 4.1: Método de Nelder-Mead. Reflexão do ponto P.
Se, por outro lado, o valor da função em R for igual ou maior que em P, necessitamos encontrar outro ponto. Geralmeute o valor de M é menor, mas não podemos escolhe-lo pois necessitamos de um triângulo. Consideremos então o ponto C que é o ponto médio entre M e R. Se o valor da função em C for menor que em P, temos um novo triângulo (ver figura 4,3 ).
Em último caso, se o valor da função em C for maior que em P, devemos encolher o triângulo original ao redor de E, trocando o ponto P pelo ponto médio de EP, agora chamado de S, e o ponto B por M (que é o ponto médio de EB) (ver figura 4,4 ).
Este processo continua até que a diferença entre os valores da função nos pontos P e E seja menor que uma determinada tolerância.
A grande vantagem deste método é a não necessidade de cálculos de derivadas (quando estas são possíveis, o que não é o caso da função módulo), porém geralmente este método é bem lento, necessitando de grande número de iterações para convergir .
Figura 4.2: Método de Nelder-Mead. Extensão da reflexão do ponto P.
Figura 4.3: Método de Nelder-Mead. Contração da reflexão do ponto P.
Figura 4.4: Método de Nelder-Mead. Encolhimento do t-riágulo original.
4.3	Características dos Métodos.
Nesta seção serão analisadas algumas características específicas de cada método, bem como modificações introduzidas por este trabalho para melhorar o desempenho e a velocidade daqueles métodos.
4.3.1	Otimização Restrita.
Quando é feita uma regressão não-linear, não há, a princípio, qualquer limitação aos valores que os parâmetros de regressão irão assumir no decorrer das iterações, sendo que os domínios destes parâmetros, do ponto de vista da regressão, são constituídos pelo universo dos números reais. Mas em geral a regressão é feita em cima de um modelo físico-matemático onde os parâmetros a serem determinados tem um domínio limitado, como por exemplo a permeabilidade que sempre deve ser maior que zero.
Na literatura tem sido utilizado o seguinte procedimento para introdução desses limites no processo de regressão. Adiciona-se à função objetivo uma nova função que tenda a zero dentro do domínio do parâmetros e tenda a valores muito grandes fora dele. Como estamos querendo minimizar a função objetivo, este procedimento irá, automaticamente, tender a afastar o parâmetro da região não desejada.
Tomemos como exemplo uma função de uma variável mostrada na figura 4.5. Suponhamos que o domínio físico do parâmetro em questão, no caso a variável a, seja que a tem que ser maior que um certo a0. Então se somarmos à função original f uma nova função pen dada por:
peníu) ~------- (4.28)
a — aQ
onde S é um número pequeno, a nova função objetivo será:
/’(a) = /(a) 4-pen(&lt;i)	(4.29)
Note na figura 4.5, que quando o valor de u tende a a$ pela direita, a função f* tende a infinito.
Um problema com este tipo de procedimento é que se o valor de a em determinada iteração estiver no lado esquerdo de «o (neste exemplo), a regressão tenderá a colocar o valor de u em &amp;amp;ã, pois este é o ponto de mínimo da função /*, além de geralmente causar problemas matemáticos.
Este tipo de função penalidade é de uso interessante no caso em que o parâmetro em questão tenha um domínio fechado do ponto de vista físico-matemático, como é o caso da permeabilidade neste trabalho, pois trabalhamos com a raiz quadrada de seu valor.

Figura 4.5: Exemplificação de otimização restrita com intervalo fechado.
Neste trabalho será proposta uma nova forma de função penalidade para alguns parâmetros, como por exemplo o fator de película. Esta forma proposta não tende para infinito no limite do intervalo, mas para valores muito grandes fora do domínio do parâmetro. Tal função é:
Figura 4.6: Exemplificação de otimização restrita com intervalo aberto.
A vantagem de se utilizar tal função é que a regressão não é interrompida se os valores dos parâmetros caírem fora do domínio pré-estabelecido.
Convém lembrar que este tipo de otimização só pode ser utilizado quando estamos trabalhando com problemas que minimizam um somatório, como é o caso do MQ e MVAM, sendo impossível sua utilização nos métodos DVS, MVA e NM.
mudança de domínio nos parâmetros de regressão. Por exemplo, no caso da permeabilidade, trocamos o seu valor pelo seu logaritmo natural. A tabela 4.1 mostra as funções testadas para mudança de domínio ao caso de reservatório homogêneo.
parâmetro	domínio	parâmetro modificado	domínio
k	fc &gt; 0	ln(Âr)	-—00 a 00
0	c &gt; 0	ln(C)	—oc a 00
S	-7 &amp;lt;S &amp;lt;25	tan _ |]	—00 a 00
A	À &gt; 0	ln(A)	— CO tí 00
íu	0 &amp;lt;w &amp;lt;1	tan Ijtuj —	—com 00
Tabela 4.1: Proposta de modificação dos domínios dos parâmetros.
A modificação de domínio que melhores resultados gerou foi a troca da permeabilidade pelo seu logaritmo natural. A troca do coeficiente de estocagem pelo seu logaritmo natural também resultou em resultados satisfatórios, porém a transformação no fator de película não deu bons resultados, sendo abandonada. A troca do coeficiente de fluxo interporoso pelo seu logaritmo e a transformação no parâmetro de armazenamento não trouxeram resultados muito bons como era esperado, Para o método de Nelder-Mead estas modificações seriam extremamente necessárias, porém a última modificação proposta (no parâmetro de armazenamento) se mostrou infrutífera, levando o método a convergir para valores incorretos. Pode-se explicar este comportamento analisando a curva da função tangente. Quando seu argumento tende a valores próximos a sr/2 ela tende a infinito rapidamente. Consequentemente, nesta região grandes variações no valor da função não correspondem a variações significativas no valor do argumento, que no caso é o nosso parâmetro de regressão. Em vista disto tal modificação foi abandonada no decorrer do desenvolvimento deste trabalho.
4.3,2	Análise Estatística da Regressão.
Numa regressão não linear é desejável que se determinem além dos valores dos parâmetros os intervalos de confiança destes na forma de limites superior e inferior. Estes intervalos são função da qualidade dos pontos experimentais e do seu número. Se definirmos 7 como "nível de significancia”, podemos dizer que *‘o valor de a (parâmetro estimado) está dentro do intervalo calculado” com probabilidade (1 - 7) de estar correto. O intervalo é denominado como intervalo de confiança de 100(1 — 7) %.
De acordo com Hartley [26], é possível determinar com exatidão estes intervalos de confiança nas regressões não lineares, porém tal procedimento via de regra é muito dispendioso em termos de cálculo. Como nos interessa apenas uma aproximação destes intervalos, Dogru, Dixon e Edgar [27] apresentaram um método simples de estimá-los.
Definamos o erro médio quadrático como:
EMQ =
SQR
npon — npar
(4.31)
onde SQR é a soma dos quadrados dos resíduos.
O intervalo de confiança de cada parâmetro pode então ser calculado como:
a* - Aa*&amp;lt;	&amp;lt;o* + Aa*	(4.32)
onde o* é a estimativa de otj da última iteração, e:
; npon™ npar	(4.33)
onde hjj é o elemento da diagonal da inversa da matriz Hessiana correspondente ao elemento oq e ty^inpon-npar é o valor da distribuição t de Student para um nível de sig-nificância 7 e grau de liberdade npon — nparr Como comentado acima, um nível de significância 7 implica em um intervalo de confiança de 1Ü0 (1 — 7) %. Neste trabalho utilizamos um nível de significância de 5 %, o que significa que os parâmetros estimados tem 95 % de probabilidade de estarem corretos dentro do intervalo calculado.
4.3.3	Distribuições Probabilísticas de Gauss e de Laplace.
A análise destas duas distribuições em questão é interessante pois elas estão intimamente ligadas às normas LI e L2. Pode ser demonstrado que se os erros ou resíduos estão distribuídos de acordo com uma Gaussiana, o melhor tipo de regressão a utilizar é a norma L2, Se, por outro lado, os resíduos se distribuem de acordo com uma exponencial alongada, o melhor tipo de regressão a se utilizar é a norma Ll.
A curva Gaussiana ou distribuição probabilística de Gauss pode ser definida como:
EXP
2v3
(4.34)
onde n é a função densidade, x é o valor onde queremos calcular o valor da função densidade, ip é a. média dos valores amostrados e&amp;lt;7 é o desvio padrão, ou seja:
(4.35)
Este tipo de distribuição é admitido nos métodos MQ e DVS.
Já a distribuição probabilística de Laplace ou exponencial alongada tem sua função densidade definida como;
n(zw&lt;y) = ~ EXP
(T
(4.36)
Este tipo de distribuição é admitido nos métodos MVA, MVAM, MVAM-MVA
e NM.
4.3,4	Inversão Numérica da Transformada de Laplace.
Como foi demonstrado por Rosa e Horne [9], podemos obter as derivadas da função em questão no campo de Laplace e posteriormente inverte-las através do algoritmo de Stehfest [28]. Esta proposição tornou tal procedimento extremamente prático, pois obter a resposta de um determinado modelo no campo de Laplace é, em geral, um problema de solução razoavelmente fácil. Recentemente Burgeoues e Horne [29] propuseram que a regressão seja feita inteiramente no campo de Laplace. No presente trabalho, no entanto, a estimativa dos parâmetros foi feita no campo real após a inversão das derivadas pelo algoritmo de Stehfest.
5	COMPARAÇÃO ENTRE OS MÉTODOS E DISCUSSÃO DOS RESULTADOS.
Neste capítulo serão apresentados os resultados da aplicação dos diversos métodos de regressão não linear aos dois modelos de reservatório já apresentados anteriormente.
5.1	Análise de Casos de Reservatórios com Comportamento Homogêneo Infinito.
No caso do modelo de reservatório homogêneo infinito serão discutidos quatro casos, sendo que os dois primeiros são do mesmo teste, porém no segundo foram acrescentados ruídos propositalmente.
Os dados de reservatório do primeiro caso estão mostrados na tabela 5.1 e na tabela 5.2 estão os dados de pressão versus tempo. Estes dados foram obtidos da referência [14].
Na tabela 5.3 estão os resultados comparativos de sete métodosfMQ, MQ mod., MVAM, MVA, MVAM-MVA, DVS e NM) aplicados aos dados de pressão, aos dados da derivada logarítmica da pressão em relação ao tempo e ao conjunto destes dois dados. Também foram testadas as modificações nos domínios dos parâmetros para o método MQ, que neste caso foi chamado de MQ mod.
Podemos observar que, em termos práticos, os parâmetros obtidos por qualquer um dos métodos são equivalentes se aplicados aos dados de pressão ou ao conjunto de dados de pressão mais derivada, existindo uma discrepância no valor determinado para o fator de película quando foram utilizados os dados da derivada para efetuar as regressões. É nitida, no entanto, a diferença em termos de intervalos de confiança, onde os métodos baseados na norma LI se mostraram muito melhores.
Vazão de Teste	= 252.0 STB/d
Raio do Poço	= 0.23 pés
Porosidade	= 0.039
Espessura	— 69.0 pés
Viscosidade	= 0.90 cp
Compressibilidade Total	= 6.7 x 10~6 1/psi
Fator Volume de Formação	= 1.325 bbl/STB
Tabela 5.1: Dados de reservatório para os casos l e 2.
Tempo de Teste (horas)	Queda de Pressão (psi)	Tempo de Teste (horas)	Queda de Pressão (psi)
0.0167	26.0	2.0000	849.0
0.0330	53.0	2.5000	859.0
0.0500	78.0	3.0000	864.0
0.1000	148.0	3.5000	869.0
0.1500	210.0	4.0000	874.0
0.2000	267.0	4.5000	877.0
0.3000	369.0	5.0000	882.0
0.4000	454.0	6.0000	887.0
0.5000	519.0	7.0000	893.0
0.6000	572.0	8.0000	897.0
0.8000	654.0	10.000	905.0
1.0000 1.5000	719.0 804.0	12.000	911.0
Tabela 5.2: Dados de pressão versus tempo para o caso 1.
O número de iterações requerido por cada método variou bastante, sendo que, como já comentado no capítulo anterior, o método NM necessita de um número excessivo de iterações para convergir. Aparentemente este elevado número de iterações tem um custo relativamente alto em termos de tempo de processamento. Também já era esperada urna certa lentidão no método MVAM, embora bem menor que no método NM, pois Rosa [22] já havia comentado em seu trabalho esta característica. Para a combinação dos métodos MVAM e MVA, é necessário se estabelecer um limite para troca de método. Neste caso estabeleceu-se que quando a variação dos parámetros entre duas iterações for menor que 10% troca-se o método. Nos métodos MQ, MVAM e MVAM-MVA foram utilizadas funções-penalidade dadas pela equação 4.28, sendo que para o fator de película foi utilizada a função penalidade proposta por este trabalho (equação 4.30), pois esta função nao interrompe o processamento quando o parâmetro recebe valores fora do seu domínio.
Outro fato interessante é que a regressão efetuada no conjunto de dados de pressão mais derivada, neste caso, não melhorou a regressão em termos de número de iterações e somente em alguns métodos houve alguma melhora em termos de intervalos de confiança. Tal fato pode ser explicado neste caso devido aos ruídos introduzidos pelo método de se obter a derivada logarítmica da pressão, pois os dados originais praticamente não continham ruído. O procedimento utilizado para a obtenção numérica da derivada a partir dos dados de campo está descrito no apêndice D.
Para melhor esclarecer as diferenças entre as regressões efetuadas nos tres conjuntos de dados, estão definidas abaixo as tres funções-objetivo analisadas.
Funções baseadas nos dados de pressão:
^i(a) = L	(5-1)
F2(o) = [Apí - Ap(o,h)]2	(5.2)
Funções baseadas nos dados da derivada:
A(&lt;5) = ¿ ÍA?í - Ap'(o, tí)|	(5.3)
npon
W)= £[Ap'- A/(a,M]2	(5.4)
i —1
Funções baseadas no conjunto de dados de pressão mais derivada:
(9*9)
Wv - ;&lt;fvl d + J(?? Wv - ?&lt;*V] 3 - (^)z3
uadu	uMu
Mét.	Tipo Dados	k			S +/-%	(1)	C +/- %	MQR (psi2 /ponto )	MRA (psí /ponto)	Ite,
		(mD)	+/- %							
MQ	P	15.16	15.79	14.38	23,26	8,48	1.53	13.67	2.72	08
MQ	D	11.08	15.00	9,58	24.55	8.61	4.50	59.46	5,12	08
MQ	P+D	13.01	17,69	11.51	28.11	8.68	2.70	104.70	8,07	08
MQ(2)	P	15.16	—	14,38	—	8.48	—	13.67	2.72	23
MQ(2)	D	11,08	—	9.58	—	8.61	—	59.46	5.12	09
MQ(2)	P+D	13.01	—	11,51	—	8.68	—	104.70	8.07	09
DVS	P	15.16	—	14.38	—	8.48	—-	13.67	2.72	09
DVS	D	11.08	—	9.58	—	8.61	—	59,46	5.12	08
DVS	P+D	13,30		11.74	—	8,68	—-	129.54	7.17	09
MVAM	P	13.47	1.53	11.97	2.43	8.42	0.07	16.81	2.67	50*
MVAM	D	10,21	0.06	8.37	0.54	8,62	0.44	65.24	4.65	16
MVAM	P+D	12.47	1.01	10.61	1.65	8.43	0.51	127.77	6.95	22
MVA	P	13.47	0.85	11,97	1.34	8.42	0.05	16.83	2,67	09
MVA	D	10,21	0.14	8.37	0.25	8,62	0.02	65,24	4.65	09
MVA	P+D	12.50	0.06	10.65	0.98	8.43	0.72	125,86	6,95	15
(3)	P	13.47	1.34	11.97	2.11	8.42	0.08	16,83	2,67	08
(3)	D	10.21	0.12	8.37	0.21	8.62	0.02	65.24	4.65	07
(3)	P+D	12.50	0.61	10.65	1,03	8.43	0.76	125.89	6.95	16
NM	P	12.08	—	10.01	—•	8.42	—	25.57	2.89	90
NM	D	10.21	—	8.37	—	8.62		65.21	4.65	174
NM	P+D	12.50	—	10.65	—	8,43	—	125.64	6.95	252
Tipo de conjunto de dados utilizados.
P - dados de pressão.
D - dados da derivada,
P+D - dados de pressão e da derivada.
(1)	- 10-3 bbl/pai
(2)	- modificação no domínio,
(3)	- MVAM-MVA.
MQR - média dos quadrados dos resíduos. MRA - média dos resíduos absolutos.
Estimativas Iniciais: k = 50.0 mD
S = 5.0
C = 0.01 bbl/psi
* parada por número máximo de iterações.
Tabela 5.3: Comparação do desempenho de vários métodos de regressão para os dados do caso 1.
Na tabela 5,5 comparamos o desempenho dos varios métodos aplicados às diferentes estimativas iniciais apresentadas na tabela 5.4. Neste caso também foi testada a modificação proposta por este trabalho nos dominios dos parâmetros. É interessante notar a similaridade de comportamento dos métodos MVA e DVS. No caso do método DVS a modificação proposta não obteve bons resultados pois o método DVS não funcionou com ela. Não foi feita tal modificação no método MVAM-MVA pois este método é urna combinação dos métodos testados anteriormente. No caso do método NM. esta modificação se mostrou imprescindível, já que o método necessita intri.nsicanien.te de domínios sem limites, pois para o seu funcionamento normal é necessário que as reflexões efetuadas pelo método tenham liberdade de movimento, o que seria impossível se alguns dos parâmetros de regressão tivessem domínio restrito.
Pode-se também concluir que os métodos MQ e MVAM-MVA mostraram-se superiores aos demais principalmente em termos de número de iterações necessárias para a convergência. Outra conclusão interessante é que a modificação no domínio dos parâmetros não surtiu o efeito desejado nos métodos DVS e MVA, que seria de introduzir uma otimização restrita a estes métodos, porém como já comentado acima, ela é imprescindível ao método NM.
Com relação à melhor escolha de função-objetivo (equações 5.1 a 5.6) para se efetuar a regressão, para este caso pode-se concluir que o melhor conjunto de dados depende do tipo de método. Para os métodos MQ, MVAM, MVAM mod., MVA, MVA mod. e MVAM-MVA, o melhor conjunto de dados é o de dados de pressão, Já para os métodos MQ mod., DVS e NM os melhores resultados foram obtidos com o conjunto de dados de pressão e da derivada.
Com relação aos dados da derivada é interessante notar que houve casos em que só se conseguiu convergência para este conjunto de dados. Isto poderia ser futuramente aproveitado para inicialmente se efetuar a regressão nos dados da derivada e utilizar os parâmetros assim obtidos como estimativas iniciais para uma nova regressão aplicada a outro conjunto de dados.
Uma explicação para este comportamento seria o melhor caráter que a curva da derivada tem comparada à curva de pressão.
Nas figuras 5.1 a 5.6 estão mostrados os dados de campo e as curvas de pressão e da derivada geradas pelos resultados das regressões. Podemos notar que, como já comentado anteriormente, estes resultados são, em termos práticos, equivalentes. Outro fato interessante é que quando efetuamos as regressões nos dados da derivada, os pontos finais da pressão tendem a se distanciar dos pontos de campo, porém uma análise visual mostra que a ’’qualidade” da reta semi-log gerada, ou seja, sua declividade e consequentemente o valor da permeabilidade é razoavelmente próxima à declividade da reta gerada pelos dados de campo.
Estim. Inicial	k (mD)	s	C (bbl/psi)
A	500.	1.	0,010
B	100.	1.	0.010
C	10.	25.	0.010
D	10.	-5.	0.010
E	10.	10.	0.100
F	10.	10.	0.001
G	1.	1.	0.010
H	1000.	25.	0.050
Tabela 5.4: Estimativas iniciais utilizadas para vários métodos de regressão para os dados do caso 1 e do caso 2,
(1)	Método	N.Iter e Tipo de Dados			(O	Método	N.Iter e Típo de Dados		
		P	D	P+D			P	D	PTD
A	MQ	10	11	12	B	MQ	08	11	09
	MQ(2)	50*	13	16		MQ(2)	13	(3)	08
	MVAM	28	33	31		MVAM	29	50*	34
	MVAM(2)	(3)	22	(3)		MVAM(2)	(3)	24	42
	MVA	(3)	(3)	(3)		MVA	(3)	08	25
	MVA(2)	(3)	(3)	(3)		MVA(2)	(3)	(3)	(3)
	(4)	11	10	17		(4)	09	11	17
	DVS	14	(3)	13		DVS	(3)	11	(3)
	NM	300*	191	137		NM	86	164	193
C	MQ	09	10	09	D	MQ	11	09	11
	MQ(2)	23	(3)	13		MQ(2)	11	11	09
	MVAM	50*	14	39		MVAM	30	15	36
	MVAM(2)	25	50*	40		MVAM(2)	48	25	50*
	MVA	08	18	13		MVA	(3)	09	(3)
	MVA(2)	(3)	(3)	(3)		MVA(2)	(3)	10	50*
	(4)	07	07	16		(4)	12	09	18
	DVS	08	(3)	06		DVS	10	09	10
	NM	300*	167	160		NM	216	133	147
E	MQ	08	10	07	F	MQ	08	09	08
	MQ(2)	17	10	08		MQ(2)	15	09	07
	MVAM	28	50*	42		MVAM	22	50*	32
	MVAM(2)	32	21	46		MVAM(2)	28	26	50*
	MVA	(3)	(3)	(3)		MVA	09	09	50*
	MVA(2)	(3)	(3)	(3)		MVA(2)	10	09	16
	(4)	07	10	15		(4)	07	09	16
	DVS	(3)	(3)	(3)		DVS	09	09	08
	NM	143	157	97		NM	81	110	91
G	MQ	10	09	09	H	MQ	13	11	10
	MQ(2)	09	09	10		MQ(2)	(3)	(3)	(3)
	MVAM	30	14	48		MVAM	50*	26	27
	MVAM(2)	45	50*	50*		MVAM(2)	(3)	50*	17
	MVA	(3)	(3)	(3)		MVA	12	10	16
	MVA(2)	(3)	10	(3)		MVA(2)	(3)	14	(3)
		11	11	11		(4)	10	10	16
	DVS	(3)	(3)	(3)		DVS	14	11	13
	NM	272	156	140		NM	139	150	174
(1) - estimativa inicial- (2) - modificação no domínio dos parâmetros.
(3) - não convergiu. (*) - parada por número máximo de iterações.
(4)	- MVAM-MVA
Tabela 5.5: Resultados dos vários métodos de regressão. Caso 1. Estimativas iniciais da tabela 5.4 .
Figura 5.1: Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão nos dados de pressão. Caso 1.
ooooo Pr essso - Dedos de Campo.
— MO ou DVS.
----- NH. MVA, MVAM ou oanoa&amp;amp;ar !.socfô - Dadcg
-- MO ou DVS.
-- NM. MVA, MVAM cu
1000,00
800.00"
MVAM-MVA,
*
MV AM- MV A. Co Conçpc ,
tn
60S.00-
■400.00
200.00
Delta T (horas)

Figura 5.2: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão nos dados de pressão. Caso 1.
e.si	0.1	i	ia
Delta T (horas)
Figura 5.3: Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão nos dados da derivada. Caso 1.
Delta T (horas)
Figura 5.4: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão nos dados da derivada. Caso 1.
i...r.r i—r~i'"T"n. i---1	1—i—’í '*r' i' r' ■j-r—**——■—¡—r-rry
0.1 1 10
Delta T (horas)
Figura 5.5: Pressão e Derivada da Pressão versus Tempo em escala log-Iog, para regressão no conjunto de dados de pressão e da derivada. Caso 1.
Delta T (horas)
Figura 5-6: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 1.
Na figura 5.7 está mostrada a evolução da média dos resíduos ao quadrado ao longo das iterações. Nela podemos observar que no método MVAM após um determinado instante os resíduos evoluem lentamente para o valor mínimo. É interessante citar que os métodos que seguem a norma LI tem o valor dos resíduos a princípio diminuído, porém no final ele cresce ligeiramente.
Comportamento semelhante é observado na figura 5.8 onde está mostrada a evolução da média dos valores absolutos dos resíduos ao longo das iterações. Interessante notar que o valor desta média, no método MVAM, praticamente não muda após a décima iteração, mas o método demora a convergir.
Nas figuras 5.9 a 5.11 pode-se analisar a evolução dos valores dos parâmetros de regressão ao longo das iterações. Nestas regressões foi utilizado o conjunto de dados de pressão mais derivada. Nestas figuras novamente fica clara a dificuldade que o método MVAM tem para convergir e a extrema lentidão do método NM. Os gráficos foram truncados antes da última iteração do método NM para melhor visualização, pois este método exigiu neste caso 172 iterações para convergir.
Iterações
®	®	s&gt;	—
®	®	—
Q	-~
(o4uod/grsd) bdW
Figura 5.8; Comportamento da média dos valores absolutos dos resíduos ao longo iterações. Caso 1.
Cl
g
¡-TTTT- Q	-TTT-7%T S&gt;
Q	Q
O	LO
s LO

O
CX1
s
O	Q	o	Q	S&gt;
d	O	Q	Q	s&gt;
\r	01	C\I		
(am) JI
O
C
O
CD
-..tuP
Um fato muito interessante notado nas figuras 5.12 a 5.14 é que os métodos MQ, MVAM e NM, apesar de minimizarem normas diferentes, caminham durante as Iterações ao longo de curvas semelhantes nos planos k-S (permeabilidade x fator de película); k C (permeabilidade x estocagem); e S C (fator de película x estocagem). Igualmente os métodos DVS e MVA também caminham nestes planos ao longo de curvas semelhantes. E bom lembrarmos que as semelhanças entre estes métodos também aparecem (exceção ao método NM) na forma da matriz que eles utilizam, sendo quadrada nos métodos MQ e MVAM e retangular nos métodos M VA e DVS. Finalmente, também foram piolados os resultados do método MQ com domínio modificado.
As estimativas iniciais utilizadas para a construção das figuras 5.12 a 5.14 foram as seguintes:
k — 50,Ü inD
S	= 0.0
C — 0.015 bbl/psi.
Figura 5.12; Variação dos parâmetros ao longo das iterações no plano k-S para os vários métodos. Caso 1.
~r~l~r~r?r?757~'r'l"l"T "r"1"
~ - ovs. fivAn.
*** ri va . sweee HVAH- HVA. onotto Ntl.
I4O( 1) .
0.0400
0.0300-
0.0200
0.0000
Mudança d« Dnimnio".
Vl I' 17’1
50	60
0. 01 00 -f
Figura 5.13: Variação dos parâmetros ao longo das iterações no plano k C para os vários métodos. Caso 1.
S
Com os dados do caso 1 foram geradas as figuras 5.15 a 5.26, onde pode-se observar como sao as superficies das funções-objetivo baseadas nos dados de pressão e analisadas fixando-se um dos parâmetros de regressão (no valor correto para cada norma). Quando analisamos as superfícies geradas pela norma L2, notamos que estas tem mais caráter que aquelas geradas pela norma Ll. Isto explicaria a baixa velocidade de convergência dos métodos MVAM e NM, Outro ponto que deve ser ressaltado é a existência de regiões em que as superfícies são praticamente planas, o que contribuiria para a não convergência do método naquelas regiões.
Por outro lado, quando fixamos o valor da permeabilidade notamos que tanto a superfície gerada pela norma Ll como a gerada, pela norma L2 tem dois mínimos bem. diferentes, o que explica os casos em que houve divergência nos métodos, pois um dos mínimos está numa região (valor do fator de película menor que -7.0) onde não há significado físico. Também foram geradas as ampliações destas superfícies em regiões próximas aos mínimos para melhor entender a baixa velocidade de convergência do método MVAM. Como pode ser visto nestas ampliações, as superfícies geradas pela norma Ll são extremamente planas em regiões próximas aos mínimos.
/pg S&amp;amp;jziá /tes/dua# (psi
4.6’7 6’. 06	7.45

Santa &amp;amp;uad.
Soma Res.Abs.(psí)
12.5
12.3
12.2
12. t
12.0
? 3.9
I	t
H .7
II	.6
11.5
•'r
¿n
rd
&lt;2
¡23
m
i&gt;	O
n	&lt;r
r-&gt;	&lt;t
r¿	f¿
LO	4
c¿	ri
T‘.	®
rr	rí
o	s
ri	t
cí
10®.¡3
90.0
60.0
50,0
40.0
•30.0
20.3
10,0
0.0
as©
U&gt;	4D	tí)
ü3	í&gt;
i—i—[—i—i—r
100.0
90.0
SJ3.0
70,0
60,0
50.0
40h0
30.0
20,®
10.0
0.0
Log Soma Quad, Res.(psi**2)
Soma Quad. Res.(psi**2)
Soma Ees.Abs.(psí)
Figura 5.22: Ampliação das k ~ 13.47 mD. Caso 1.
curvas de nível e superfície geradas pela norma L1 para
¿qg- Sama Quad. fífSá\/'psd
Soma Quad. Res.(psi**2)
Figura 5.24: Ampliação das curvas de nível e superfície geradas pela norma L2 para S — 14.38 . Caso 1.
Log Soma Quad. Res.(psi**2)
2.B5 3.74
«Tn J726:^AmplmÇaO das CUrW3 de nível e werfície geradas pela norma Li para —* II.Í7Í „ kjá¡SO 1.
Outra análise efetuada com os dados deste caso foi a comparação entre a distribuição de erros real e as distribuições correspondentes de Gauss e de Laplace. Como podemos observar nas figuras 5.27 a 5.32, neste caso nao ficou claro, qualitativamente falando, qual das distribuições tem maior semelhança com a distribuição real de erros. Isto pode ser explicado pelo pequeno número de pontos amostrado. Apesar deste problema, a existência de valores de erros distantes da média, como pode ser observada nas referidas figuras, indica que a distribuição de Laplace pode ser a mais indicada.
Para melhor avaliar o desempenho dos vários métodos de regressão, foi acrescentado aleatoriamente algum ruído aos dados de pressão do caso 1. Estes ruídos estão mostrados na tabela 5.6 e serão denominados de caso 2.
Tempo de Teste (horas)	Queda de Pressão Real (Psi)	Queda de Pressão Modificada (psi)
0.0167	26.0	11.0
0.0330	53,0	65.0
0.0500	78.0	70.0
0.1000	148.0	100.0
0.4000	454.0	510.0
0.5000	519.0	550.0
0.6000	572.0	650.0
4.5000	877.0	880.0
5.0000	882.0	881.0
6.0000	887.0	892.0
Tabela 5.6: Ruídos introduzidos nos dados de pressão. Caso 2.
Figura 5.27: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados de pressão usando o método MQ. Caso 1.
Figura 5.29: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados da derivada usando o método MQ. Caso L
Figura 5,31; Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MQ. Caso 1.
Novamente foram comparados inicialmente os mesmos sete métodos testados no caso 1 (MQ, MQ mod., MVAM, MVA, MVAM-MVA, DVS e NM). Os resultados desta comparação estão na tabela 5.7. Pode-se notar que a interpretação baseada somente nos dados da derivada sofreu uma mudança sígnifiçátiva, o que é facilmente explicado pela amplificação de ruído que o algoritmo de diferenciação utilizado neste trabalho causa nos dados. Porém tanto na interpretação dos dados de pressão como no conjunto de dados de pressão mais derivada tal diferença não foi muito grande. Outro fato interessante é que os intervalos de confiança do método MQ na presença de ruídos cresceu de valores aceitáveis (de até 28 %) para valores muito altos (de até 84 %), enquanto que nos métodos MVAM, MVA e MVAM-MVA o maior intervalo para os dados do caso 2 foi de 8 % (era de 2 % no caso 1).
Met.	Tipo Dados	k		s		(Q	c +/-%	MQR (psi2 /ponto )	MRA (psi ! panto)	Ite.
		(mD)	+/- %		+/-%					
MQ	P	15.62	84.20	15.01	122.9	7.92	8.35	415.68	13.64	08
MQ	D	8.17	44.80	6.18	87.0	6.20	.18,93	1031.90	23.27	07
MQ	P+D	11.37	4:4 &gt;4: t	9.15	77.0	7.61	8.22	925.01	20.86	09
MQ(2)	P	15.65	—	15.05	—	7.92	—	415.68	13.64	26
MQ(2)	D	8.16	—	6.17	—	6.20	—	1031.90	23.28	07
MQ(2)	P+D	11.36	—	9.14	—	7.66	—	925.04	20.86	12
DVS	P	15.65	—	15.05		7.92	—	415.68	13.64	08
DVS	D	8.16		6.17	—	6.20	—	1031.90	23.28	09
DVS	P+D	11.36	—	9.14	—.	7.66	—	925.04	20.86	07
MVAM	P	15.56	2.24	14.96	3.33	8.48	0.33	524.32	12.25	50*
MVAM	D	9.54	0.17	7.77	L10	6.76	1.96	1081.69	22.03	42
MVAM	P+D	10.43	0.88	7,73	1.62	7.84	0.21	962.30	19.79	25
MVA	P	15.56	5.17	14.96	7.63	8.48	0.37	524.36	12.25	08
MVA	D	9.44	3.40	7.97	6.09	6.14	2.79	1067.21	22.03	05
MVA	P+D	10.43	0.77	7.73	1.42	7.84	0.16	.962.30	19.79	08
(3)	P	15.56	5.64	14.96	8.33	8.48	0.41	524.36	12.25	08
(3)	D	9.44	0.57	7.97	0.99	6.14	0.19	1067.21	22.03	10
(3)	P+D	10.43	0.30	7.73	0.55	7.84	0.05	962.30	19.79	08
NM	P	15.56	—	14.96	—	8.48	—	524.36	12.25	274
NM	D	9.44	—	7.97	—	6.14	—	1067.21	22.03	128
NM	P+D	10.43	—	7.73	—	7.84	—	962.30	19795	126
(1)	10 3 bbl/psi		istimativas Iniciais:
(2) modificação no domínio	k = 50.0 mD	
(3) MVAM-MVA	S — 5.0	
P - dados de pressão.	C = 0.01 bbl/psi	
D - dados da derivada.		
P+D * dados de pressão e da derivada.	3	* parada por n. max, iterações.
MQR - média dos quadrados do resíduos.		
MRA - média dos resíduos absolutos.		
Tabela 5.7: Comparação do Desempenho de Vários Métodos de Regressão para os dados do caso 2.
Na tabela 5.8 são apresentados os comportamentos dos diversos métodos quando submetidos às estimativas iniciais da tabela 5.4. Quando comparamos estes resultados com os da tabela 5.5, onde estão mostrados os resultados dos mesmos métodos aplicados aos dados sem ruídos, foi notada uma pequena melhora em termos de número de iterações necessárias para a convergência nos métodos baseados na norma Ll, porém tal melhora não pode ser considerada conclusiva. Analisando qual método teve melhor desempenho chega-se à conclusão que para este caso o método MVAM-MVA teve um comportamento melhor. Novamente nota-se que a modificação no domínio dos parâmetros não surtiu o efeito desejado, sendo que quando aplicada ao método MVA mostrou-se muito ruim, causando a divergência na maior parte das vezes.
	Método	N.Iter e Tipo de Dados			(1)	Método	N.Iter e Tipo de Dados		
		P	D	P+D			P	D	P+D
A	MQ	13	09	15	B	r MQ	09	09	08
	MQ(2)	50*	(3)	12		MQ(2)	17	(3)	08
	MVAM	24	50*	13		MVAM	50*	50*	38
	MVAM(2)	50*	(3)	31		MVAM(2)	(3)	30	25
	MVA	23	(3)	(3)		MVA	26	12	(3)
	MVA(2)	(3)	(3)	(3)		MVA(2)	(3)	09	(3)
	(4)	11	16	16		(4)	11.	09	09
	DVS	(3)	(3)	(3)		DVS	(3)	11	(3)
	NM	74	(3)	300*		NM	300*	.118	83
C	MQ	11	11	13	D	MQ	11	09	10
	MQ(2)	24	(3)	12		MQ(2)	24	09	09
	MVAM	18	50*	33		MVAM	31	50*	26
	MVAM(2)	50*	50*	38		MVAM(2)	50*	23	33
	MVA	08	17	07		MVA	15	09	10
	MVA(2)	(3)	(3)	(3)		MVA (2)	(3)	07	(3)
	(4)	07	09	08		(4)	11	11	13
	DVS	08	(3)	06		DVS	12	07	12
	NM	170	247	274		NM	300*	155	209
E	MQ	08	11	07	F	MQ	08	10	07
	MQ(2)	18	09	08		MQ(2)	16	07	07
	MVAM	46	4.1.	22		MVAM	50*	17	39
	MVAM(2)	50*	10	21		MVAM(2)	50*	16	39
	MVA	(3)	(3)	(3)		MVA	08	09	08
	MVA(2)	(3)	(3)	(3)		MVA(2)	12	08	08
	(4)	10	09	06		(4)	08	09	08
	DVS	(3)	(3)	(3)		DVS	08	08	08
	NM	300*	129	110		NM	88	99	185
G	MQ	09	09	11	H	MQ	15	14	15
	MQ(2)	11	09	09		MQ(2)	(3)	(3)	(3)
	MVAM	26	23	25		MVAM	24	35	38
	MVAM(2)	-50*	30	27		MVAM(2)	(3)	(3)	(3)
	MVA	(3)	13	(3)		MVA	12	11	10
	MVA(2)	(3)	12	(3)		MVA(2)	(3)	12	(3)
	(4)	10	12	10		(4j	11	09	10
	DVS	(3)	(3)	(3)		DVS	12	14	12
	NM	295	186	113		NM	186	151	300*
(1) - estimativa inicial. (2) - modificação no domínio dos parâmetros.
(3) - não convergiu. (*) - parada por número máximo de iterações.
(4) - MVAM-MVA
Tabela 5.8: Resultados dos Vários Métodos de Regressão. Caso 2. Estimativas iniciais na tabela 5.4 .
Nas figuras 5,33 e 5.34 estão mostrados os resultados das regressões baseadas na norma LI (MVAM, MVA, MVAM-MVA e N Mi e na norma L2 (MQ, MQ mod. e DVS) aplicadas ao conjunto de dados de pressão e da derivada do caso 2.
Figura 5,33: Pressão e Derivada da Pressão versus Tempo em escala iogdog, para regressão no conjunto de dados de pressão e da derivada. Caso 2.
■00.00^
200.£50
10
Delta T (horas)
0,00 -f—
0,85
600,00J

Figura 5.34: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 2.
Outro caso analisado, denominado de caso 3, foi obtido de um teste num poço da Bacia de Campos. Os dados de reservatório e de fluidos estão na tabela 5.9 e os de pressão versus tempo estão na tabela 5.10. Como se trata de um período de estática optamos por analisar o teste com o tempo equivalente de Agarwal:
Ai * tp % Aí + tp
(5.8)
Também neste caso avaliamos os mesmos sete métodos básicos (MQ, MQ mod., MVAM. MVA, MVAM-MVA, DVS e AM). Na tabela 5.11 pode-se analisar alguns fatos interessantes. Como será visto nas figuras 5,38 e 5.39, está sendo analisado um teste com pequeno coeficiente de estocagem., porém esta varia nos primeiros instantes do teste. Esta variação pode ser melhor avaliada analisando os intervalos de confiança dos parâmetros de regressão, que nos métodos baseados na norma L2 sâo afetados por este mau condicionamento do modelo físico-matemático, no que se refere ao coeficiente de estocagem. Já para os métodos baseados na norma Ll, este mau condicionamento só é refletido no intervalo de confiança do coeficiente de estocagem, não afetando os outros intervalos. Novamente, como nos casos anteriores, os resultados baseados somente nos dados da derivada são discrepantes dos baseados nos dados de pressão ou dos baseados no conjunto de dados de pressão mais derivada.
Tempo de Produção	= 30.70 horas
Vazão de Teste	= 646.5 STB/d
Raio do Poço	= 0,354 pés
Porosidade	= 0.175
Espessura	= 50,86 pés
Viscosidade	- 1.08746 cp
Compressibilidade Total	12.0 x 10“6 1/psi
Fator Volume de Formação	= 1.3266 bbl/STB
Tabela 5.9: Dados de reservatório para o caso 3,
Tempo de Teste (horas)	Queda de Pressão (psi)	Tempo de Teste (horas)	Queda de Pressão (psi)	Tempo de Teste (horas)	Queda de Pressão (psi)
0.0095	91.39	0.5092	2096.41	2.8425	2288.27
0.0175	469.80	0,5925	2104,82	3.0092	2295.09
0,0258	890.81	0.6342	2112.58	3.1758	2303,01
0.0342	1357.97	0.6758	2119,86	3.3425	2307.82
0.0425	1570.91	0.7175	2126.74	3.5092	2313.65
0,0508	1674.90	0.7592	2133,14	3.6758	2319.40
0.0592	1737,40	0.8017	2139.36	3.8425	2324.68
0,0675	1776.94	0.8425	2145.13	4.0092	2329.85
0.0758	1806.15	0.9258	2155.89	4.1758	2334.74
0.0842	1828.81	1.0092	2165,82	4.3425	2339.37
0.0925	1848.93	1,0925	2174.98	4.5092	2343.93
0.1008	1865.86	1.1758	2183.54	4.6758	2348.28
0.1092	1880.21	1.2592	2191.49	4.8425	2352.49
0.1175	1892.84	1.3425	2198.90	5.0092	2356,50
0.1258	.1904,75	1.4258	2206.08	5.1758	2360.39
0,1442	1926.16	1.5092	2212.67	5.3425	2364.19
0.1592	1940.69	1.5925	2218.99	5.5092	2367.79
0.1758	1954.75	1.6758	2225,06	5.6758	2371.37
0.1925	1967.20	1.7592	2230.75	5.8425	2374.75
0.2092	1977.93	1.8425	2236.21	6.0092	2378.08
0.2425	1996.86	1.9258	2241.40	6.1758	2381,38
0.2770	2013,58	2.0092	2246.56	6.3425	2384.37
0.3092	2027.06	2.0925	2251.54	6.5092	2387.54
0.3425	2039.32	2.1758	2256.00	6.6758	2390.38
0.3758	2051.29	2.2595	2260.54	6,8425	2393.30
0.4092	2061.77	2.3425	2265,10	7.0092	2396.04
0.4425	2071.07	2.5092	2273.20		
0.4675	2077.51	2,6758	2280.96		
Tabela 5,10: Dados de pressão versus tempo para o caso 3,
Met.	Tipo	k		S		C		MQR / ponto }	MRA / ponto )	Ite.
		(mD)	+/- %		+A%	(1)	+/-%			
MQ	P	14.32	16.01	6.98	27.11	5.447	10.90	5597.	38.64	08
MQ	D	12.26	16.68	10.42	22.52	2.652	14.42	5849.	37.00	10
MQ	P +D	14.31	14.48	6.99	24.30	5.352	9.32	9759.	46.84	12
MQ(2)	P	14.3.1	—-	6.97	—	5.745	—	5597.	38.61	09**
MQ(2)	D	12.25	—	10.43	—	2.647	—	5849.	36.94	12
MQ(2)	P+D	14.31	—	6.99	—	5.351	—	9759.	46.85	12
DVS	P	14.31	—	6.98	—	5.746	—	5597.	38.62	11
DVS	D	12.25	—	10.43	—	2.647		5849.	36.94	.10
DVS	P+D	13.56	—	6.34	—	5.491	—	9865.	44.34	06**
MVAM	P	11.65	0.88	4.74	1.68	3.733	6.34	10269.	25.40	50*
MVAM	D	10.92	0.53	9.54	0.41	2.193	1.05	6799.	28.60	44
MVAM	P+D	11.50	0.77	4.62	1.63	4.069	3.89	12568.	32.29	50*
MVA	P	11.65	0.61	4.74	1.28	3.717	5.94	10356.	25.40	14**
MVA	D	10.89	0.42	9.54	2.00	2.181	2.44	6829.	28.59	09
MVA	P+D	11.50	0.38	4.62	0.79	4.044	3.37	12665.	32.29	37**
(3)	P	11.65	0.63	4.74	1.32	3.717	6.15	10356.	25.40	17
(3)	D	10.89	0.19	9.55	1.14	2.181	1.31	6829.	28.59	10
(3)	P+D	11.50	0.39	4.62	0.80	4.044	3.42	12665.	32.29	39
NM	P	11.65	—	4.74	—	3.717	—	10357.	25.40	117
NM	D	10.89	—	9.54	—	2.181	—	6829.	28.59	144
NM	P+D	11.50	—	4.62	—	4.047	•—	12653.	32.29	111
(1)
(2)
(3)
IO~4 bbl/psi modificação no domínio.
MVAM-MVA
P - dados de pressão.
D - dados da derivada.
P+D - dados de pressão e da derivada. MQR - média dos quadrados dos resíduos. MRA - média dos resíduos absolutos.
Estimativas Iniciais: k -= 50 mD
S = 5.0
C = 0.01 bbl/psi
* parada por n. max. de iterações.
** parada por falha no algoritmo procura Linear,
Tabela 5.11: Comparação do Desempenho de Vários Métodos de Regressão para os dados do caso 3.
Para melhor avaliar os desempenhos dos vários métodos, estes foram submetidos às estimativas iniciais da tabela 5.12. 0 resultado está mostrado na tabela 5.13.
Notam-se alguns fatos interessantes neste caso. Com o aumento do número de pontos observados, neste caso 82, todos os métodos tem melhor performance, o que leva a sugerir que quando se estiver analisando determinado teste de pressão utilizando regressão não linear, deve-se ler o maior número de pontos possível na carta de pressão analisada. Observa-se também que a utilização do conjunto de dados de pressão mais derivada melhora a interpretação se existirem ruídos nos dados e/ou o modelo matemático admitido não se adaptar inteiramente ao problema analisado, como acontece neste caso.
0 melhor método de regressão em termos de robustez foi o MQ, porém, quando convergiu, o DVS teve melhor desempenho em termos de menor número de iterações necessário para a convergência. Existiram situações onde o método MVAM-MVA teve desempenho pior que o método MVA, como no caso do conjunto de estimativas iniciais A para dados da derivada e de pressão mais derivada, no conjunto C para dados de pressão (devido a não convergência do método MVAM) e no conjunto E para dados de pressão e de pressão mais derivada (devido às dificuldades de convergência do MVAM). 0 método NM só divergiu em um único conjunto de estimativas iniciais, porém isto provavelmente poderá ser corrigido futuramente através da modificação no algoritmo de composição das quatro estimativas iniciais (este método requer npar 1 estimativas iniciais). Neste trabalho foi utilizado o seguinte procedimento para obtenção das estimativas iniciais:
Leia	ki , 5’i e C;
=logAq
k2 = ki + 0.5
¿3 = ki + 1.0
= kl "r 0.5
Se	(Si &amp;lt;15.0) então
52	= 5X + 5.0
53	= S'1 - L0
54	=	+ 5.0
Senão
52	= 5i - 5.0
53	- Si - 1.0
54	= 5i — 5.0
Fim do Se
Ci=logCi
C2 = Cl
C3 = Ci c4 = Cl + LO
Também neste caso a modificação no domínio dos parâmetros não surtiu o efeito desejado, pois várias vezes os métodos modificados divergiram.
Estim, Inicial	k (niD)	s	C (bbl/psi)
A	1.	1.	0.0001
B	0.1	1.	0.0001
C	10.	’5.	0.0010
D	100.	10.	0.0010
E	100.	10.	0.0100
F	500.	25.	0.0010
G	10.	10.	0.1000
H	1000.	50.	0.0100
Tabela 5.12: Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os dados do caso 3.
(1)	Método	N.Iter e Tipo de Dados			(1)	Método	N.Iter e Tipo de Dados		
		P	D	P1D			P	D	P+D
A	MQ	10	09	12	B	MQ	14	14	15
	MQ(2)	14	10	15		MQ(2)	13	18	19
	MVAM	28	30	30		MVAM	46	35	47
	MVAM(2)	50*	23	50*		MVAM(2)	50*	33	50*
	MVA	50*	08	25		MVA	50*	(3)	28
	MVA(2)	50*	08	50*		MVA(2)	50*	13	50*
	(4)	19	09	42		(4)	23	13	30
	DVS	08	08	09		DVS	14	17	17
	NM	247	139	11.6		NM	195	149	172
C	MQ	10	12	14	D	MQ	11	09	12
	MQ(2)	(3)	14	(3)		MQ(2)	(3)	12	15
	MVAM	(3)	43*	50*		MVAM	39	46	50*
	MVAM(2)	(3)	32	49		MVAM(2)	50*	46	50*
	MVA	50*	19	42		MVA	50*	(3)	50*
	MVA(2)	(3)	(3)	50*		MVA(2)	(3)	(3)	50*
	(4)	(3)	11	4.1		(4)	50*	10	34
	DVS	09	(3)	09		DVS	11	10	07
	NM	127	157	113		NM	173	143	151
E	MQ	12	.11	09	F	MQ	14	13	13
	MQ(2)	23	13	21		MQ(2)	(3)	17	38
	MVAM	50*	39	50*		MVAM	50*	34	50*
	MVAM(2)	48	40	50*		MVAM(2)	(3)	(3)	50*
	MVA	17	13	40		MVA	50*	50*	40
	MVAÍ2)	50*	(3)	50*		MVA(2)	(3)	(3)	(3)
	(4)	50*	11	43		(4)	50*	15	43
	DVS	10	12	06		DVS	11	(3)	08
	NM	182	260	189		NM	191	167	111
G	MQ	14	17	13	H	MQ	40	37	40
	MQ(2)	10	(3)	13		MQ(2)	(3)	(3)	(3)
	MVAM	34	50*	50*		MVAM	50*	50*	50*
	MVAM(2)	20	(3)	30		MVAM(2)	48	50*	37
	MVA	(3)	(3)	(3)		MVA	19	11	34
	MVA(2)	(3)	(3)	(3)		MVA(2)	(3)	(3)	(3)
	(4)	21	14	43		(4)	50*	09	43
	DVS	(3)	(3)	(3)		DVS	11	12	09
	NM	111	221	91		NM	(3)	(3)	(3)
(1) - estimativa inicial. (2) - modificação no domínio dos parâmetros.
(3)	- não convergiu. (*) - parada por número máximo de iterações.
(4)	- MVAM-MVA
Tabela 5.13: Resultados dos Vários Métodos de Regressão. Caso 3. Estimativas iniciais na tabela 5.12 .
Nas figuras 5.35 a 5.37 pode-se novameiite observar a. semelhança ei.it re os caminhos seguidos pelos métodos MVA e DVS e, por outro caminho, pelos métodos restantes. Nota-se também que o método MQ modificado tem um caminho bem próximo ao caminho do método MQ, somente sendo diferente nas primeiras iterações. Outro fato que deve-se destacar é que as maiores mudanças ocorrem nas duas primeiras iterações, seja qual for o método analisado, sendo as variações seguintes bem menores.
As estimativas iniciais utilizadas para a construção das figuras 5.37 a 5.39 foram as seguintes;
k = 50.0 niD
S - 15.0
C 0.0050 bbl/psi.
Figura 5.35: Variação dos parâmetros ao longo das iterações no plano k S para os vários métodos. Caso 3.
Figura 5.36; Variação dos parâmetros ao longo das iterações no plano k C para os vários métodos. Caso 3.
9. 0050-,
'íía.ga:®-
x&gt;
@928'
CJ
0. 09?í3;
-----ríQ mo o'. sWrWr* hVAH GseeoriVA BEeear^AM-riVA
_A././..\A |)VS
■w-w-i- Ní-1

O. @903	; 1 , r r—T-.-r—T-—, —r-~.   —ü :—t! ;
■0	:0	39
s
Figura 5.37: Variação dos parâmetros ao longo das iterações nu plano SC para os vários métodos. Caso 3.
Nas figuras 5.38 e 5,39 estão apresentados os dados de campo de pressão e da derivada versus tempo em escala log-log e semi-Iog, bem como as curvas de pressão e da derivada geradas com os parâmetros determinados pelos métodos baseados nas normas LI e L2 aplicados ao conjunto de dados de pressão mais derivada, Fica bem clara a capacidade dos métodos baseados na norma LI de atribuir menores pesos a dados com ruídos ou onde o modelo matemático se aplica parcialmente, como neste caso onde os pontos iniciais tem um comportamento que indica que o coeficiente de estocagem varia. Neste caso, a curva da derivada gerada com os parâmetros determinados com os métodos baseados na norma LI está razoavelmente distante dos pontos iniciais da curva da derivada dos dados de campo, porém à medida que o tempo cresce, e consequentemente o coeficiente de estocagem deixa de variar, o ajuste desta curva torna-se melhor que aquele obtido com parâmetros determinados com métodos baseados na norma L2.
0.01
CCCCC Pra $ s em ~ Ur d o s da Camoü.
-----	na. na mo d ovs.
....	NVA, nvAn-rwA nm.
DâH.y ada - D» d o s á e Cs rrp o *
----	MQ, MQ rtiO d o íJ DVS»
....	MV Ari, MV A, MVAM’MVA ou MM.
T-q-r—---1---!——r------------------i—;	i j . , -
0.1	,	1	íO
( h )
Figura 5.38: Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 3.
Nas figura 5.40 a 5.45 estão mostrados os histogramas dos erros entre os pontos observados em campo e as curvas geradas pelos parâmetros avaliados pelas normas L1 e L2 para as regressões efetuadas nos tres conjuntos de dados, bem como as distribuições probabilísticas de Gauss e Laplace correspondentes às médias e desvios padrões de cada par (conjunto de dados)-(tipo de norma). Neles pode-se melhor avaliar a congruência entre as distribuições reais (histogramas) e a de Laplace, Tal semelhança nao está baseada na densidade de probabilidade da média, pois estas densidades são muito próximas seja na distribuição de Gauss, seja na de Laplace, mas sim na existência de valores de erros com densidades de probabilidade relativamente altas longe dos valores das médias, o que não é admissível na distruibição de Gauss,
te&lt;! (h)
Figura 5.39: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 3.
ÍD
TS ^,4**5-
&lt;ts :

/
/
&amp;amp; .	3
■\

f ;
//
/ / //
J

0,0»-
u&gt;
Resíduo (psi)
Figura 5.40: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados de pressão usando o método MQ, Caso 3.
D ( 8 t i GoU 5 8 Iâ n (5 . Dls L d © Ls p í 13 o * * O&amp;amp;ddô cf© Cwo.
- ¡¿e-	-
Resíduo (psi)
e.eet -
Figura 5.41: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados de pressão usando o método UVA. Caso 3.
0.0S0-1

Ím&gt;
’d s,aôé
A
4



8. *300
--30&amp;lt;2^	100	4£&amp;amp; GGtf
Resíduo (psi)
Figura 5.42: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados da derivada usando o método MQ. Caso 3-
A seguir foi analisado um período de estática de um teste de pressão obtido da referência [30b Novamente por se tratar de um período de estática foi utilizado o tempo equivalente de Agarwall. Os dados de reservatório estão na tabela 5.14 e os de pressão versus tempo na tabela 5.15.
-t
4
4
4
-j
çT\	
	
i a \\	
h \\	
	
/ y	
/7 i	l\
í'	: 7	j	\ \\
-7 i /	\
/ ::	
----- D i y t,	(;$ u 5 $ l a íí ô . ---- £):sç_	LíípiQCfír ---- Dados d 9 Cí iTD o ,

-200	-&gt;2í:	¿	t¿0	2Ó0 dÓ0
Residuo (psi)
"É/£r
Figura 5.43: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão nos dados da derivada usando o método MVA. Caso 3.
e, ose -í
~í
* f
í •.
£. -

Da des
UC5 ti S ís t 3 * ô
ÇÍ4? Lap t ÍJ
dis	&gt;
*0 3.303
£

0,301 -

•;

//
i

ti
■i
V
g ® 8
Q	=L&gt;
A	íF
ÍS	S	«3
&amp;amp;	s	s
2 b
Resíduo (psi)
Figura 5.44: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MQ. Caso 3.
0.004 -
q;
T5 0 &gt; 003
i’ n
0.08?
/

/
0.000 '4r
à
o-
ía
•a íS&gt;
Residuo (psi)
Figura 5.45: Comparação entre a distribuição real dos erros e as distribuições de Gauss e de Laplace. Regressão no conjunto de dados de pressão e da derivada usando o método MVA. Caso 3.
Tempo de Produção	= 3912.0 horas
Vazão de Teste	= 36.0 STB/d
Raio do Poço	~ 0.400 pés
Porosidade	= 0.170
Espessura	= 165.0 pés
Viscosidade	= 0.5058 cp
Compressibilidade Total	= 5.0 x I0~s 1/psi
Fator Volume de Formação	= 1.333 bbl/STB
Tabela 5.14; Dados de reservatório para o caso 4.
Tempo de Teste (horas)	Queda de Pressão (psi)	Tempo de Teste (horas)	Queda de Pressão (ps*)
35.00	22.85	1157.20	380.80
40.00	26.31	1421.00	432.72
45.00	28.90	1747.00	482.85
50.00	31.51	2146.00	532.00
55.00	34.09	2634.00	577.93
60.00	36.68	3240.00	616.86
65.00	39.26	3982.00	646.66
70.00	41.85	4892.00	674.00
75.00	44.42	7387.00	704.50
80.00	47.00	7494.00	704.17
90.00	52.16	7602.00	704.14
100.00	57.29	77.12.00	704.65
110.00	62.43	7938.00	705.74
120.00	67.56	8053.00	706.08
130.00	72.69	8169.00	706.53
147.00	81.38	8408.00	707.58
181.00	98.72	8653.00	708.50
223,00	119.72	8778.00	708.83
274.00	143.92	9053.00	708.63
336.00	171.29	9166.00	708.90
413.00	202.49	9433.00	709.48
507.00	234.60	9570.00	709.85
624.00	262.57	9707.00	710.17
766.00 941.00	294.61 333.42	9849.00	710.58
Tabela 5.15: Dados de pressão versus tempo para o caso 4.
Estes dados quando analisados através dos mesmos sete métodos básicos referidos anteriormente (MQ, MQ mod., MVAM, MVA, MVANf-MVA, DVS e NM) tem como resultados aqueles mostrados na tabela 5,16. Ao analisar esta tabela fica claro que somente os resultados das regressões que foram efetuadas sobre o conjunto de dados de pressão mais derivada estão corretos. Esta afirmação se torna ciara quando observa-se que existe uma grande separação entre as curvas de pressão e da derivada (ver figuras 5.46 e 5A7), caracterizando um fator de película de valor alto. Este não é o resultado obtido pelas regressões efetuadas somente nos dados de pressão, que mostram um pequeno valor negativo para o fator de película. Por outro lado, como já comentado anteriormente, os resultados das regressões efetuadas sobre os dados da derivada não tem a confiabilidade dos resultados obtidos quando se efetua a regressão sobre os outros dois conjuntos de dados.
Vale a pena ressaltar que a utilização de métodos convencionais neste caso se mostraria infrutífera, pois a figura 5.46 mostra que não houve tempo suficiente para a existência de uma reta semi-log, o que impossibilitaria este tipo de análise.
Met.	Tipo Dado	k		S		C		MQR (psi2 /ponto )	MRÁ O* /ponto)	Ite.
		(mD)	+/-%		+/-%	(1)	+ /- %			
MQ	P	0.234	19.51	-0.16	924.1	3.496	3.85	42.77	5.38	11
MQ	D	0.822	25.44	18.69	36.20	4.436	5.57	126.9	8.39	07
MQ	P+D	0.517	22.85	9.22	42.75	3.980	3.19	130.9	8.30	07
MQ(2)	P	0.236	—	-0.08	—	3.502	—	42.80	5.39	50*
MQ(2)	D	0.822	—	19.45	—	4.438	—	126.9	8.32	14
MQ(2)	P+D	0.513		9.07	—	3.980	—	130.9	8.31	29
DVS	P	0.231	—	-0.23	—	3.489	—	42.77	5.38	11
DVS	D	0.822	—	19.45		4.438	—	126.9	8.32	12
DVS	P+D	0.513	—	9.07	—	3.977	—	130.9	8.31	10
MVAM	P	0.217	0.14	-0.72	1.18	3.272	0.01	66.98	4.80	29
MVAM	D	0.692	4.75	15.65	6.70	4.141	1.58	141.9	8.14	32
MVAM	P+D	0.517	1.11	9.13	2.13	3.921	0.41	133.3	8.14	31
MVA	P	0.2.17	0.13	-0.72	1.22	3.272	0.03	66.98	4.80	09
MVA	D	0.815	2.45	19.59	3.34	4.347	0.33	129.6	8.12	11
MVA	P+D	0.517	0.68	9.13	1.29	3.921	0.11	133.3	8.14	10
(3)	P	0.217	0.07	-0.72	0.64	3.272	0.02	66.98	4.80	09
(3)	D	0.815	2.60	19.59	3.54	4.347	0.35	.129.6	8.12	.14
(3)	P+D	0.517	0.09	9.13	0.17	3.921	0.02	133.3	8.14	12
NM	P	0.217	—	-0.72	—	3.272	—	66.98	4.80	248
NM	D	0.778	—	18.41	—	4.300		131.1	8.13	136
NM	P+D	0.517	—	9.15	—	3.922	—	133.2	8.14	116
(1) - bl	+ /psi					Estimativas Iniciais:				
(2)	- modificação no domínio.						k = 0.5 mD				
(3) - MVAM-MVA						S = 1.0				
P -	dados de pressão.					C = 1.0 bbl/psi				
D -	dados da derivada.									
P+D - dados de pressão e da derivada.						* parada por n		. max. de iterações.		
MQR - média dos quadrados dos resíduos.										
MRA * média dos resíduos absolutos.										
Tabela 5.16: Comparação do Desempenho de Vários Métodos de Regressão para os dados do caso 4.
Figura 5.46: Pressão e Derivada da Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 4.
Figura 5.47: Pressão e Derivada da Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 4.
Para efetuar uma comparação do desempenho dos vários métodos frente a diferentes estimativas iniciais foram elaboradas as tabelas 5.17 e 5.18. Na primeira estão os oíto conjuntos de estimativas iniciais e na segunda os resultados das regressões quando utilizamos aquelas estimativas. Ao analisar esta última tabela nota-se que o método com maior robustez é o NM, que só falhou em um caso, sendo que para o conjunto de estimativas iniciais F aplicado aos dados da derivada ele é o único que converge. O método MVAM-MVA também demonstrou boa performance, pois só divergiu tres vezes e nas outras tentativas não teve problemas com o algoritmo de procura linear, o que ocorreu frequentemente com os métodos MQ e MVAM mod.. Para estes dados as regressões efetuadas no conjunto de dados de pressão mais derivada mostraram-se muito eficientes, em termos de redução no número de iterações, em relação às regressões efetuadas somente sobre os dados de pressão ou somente sobre os dados da derivada.
Estim. Inicial	k (m.D)	s	C (bbl/psi)
A	1.	5.	1.00
B	0.1	10.	1.00
C	10.	5.	1.00
D	1.	5.	10.0
E	1.	25.	0.10
F	10.	25.	0.10
G	0.1	-5.	1.00
H	10.	-5.	0.01
Tabela 5.17; Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os dados do caso 4.
U)	Método	N.Iter e Tipo de Dados			(1)	Método	N.Iter e Tipo de Dados		
		P	D	P+D			P	D	P+D
A	MQ	11	07**	06**	B	MQ	12	08**	07**
	MQ(2)	04**	27	19		MQ(2)	08	12	29
	MVAM	26	50*	43		MVAM	50*	50*	34
	MVAM(2)	08**	13**	10**		MVAM(2)	14**		19**
	MVA	11	11	10		MVA	06	08	08
	MVA(2)	10	12**	12		MVA(2)	07	06**	07**
	(4)	12	14	10		(4)	10	12	08
	DVS	11	11	10		DVS	09	08	08
	NM	212	300*	65		NM	294	92	181
c	MQ	27	09**	19	D	MQ	08**	05**	08
	MQ(2)	50*	(3)	08		MQ(2)	(3)	10	09
	MVAM	50*	45**	50*		MVAM	28	50*	36
	MVAM(2)	20**	36**			MVAMi2)	(3)	12**	10**
	MVA	(3)	19	(3)		MVA	07	10	08
	MVA(2)	(3)	(3)	(3)		MVA(2)	09	08**	05**
	(4)	14	14	10		(4)	13	08	07
	DVS	(3)	(3)	(3)		DVS	09	08	08
	NM	98	300*	248		NM	263	140	145
E	MQ	15	(3)	10**	F	MQ	19	(3)	15
	MQ(2)	08	(3)	33		MQ(2)	(3)	(3)	23
	MVAM	37	37	42		MVAM	45	(3)	36
	MVAM(2)		50*	19**		MVAM(2)	(3)	(3)	12**
	MVA	(3)	15	(3)		MVA	(3)	(3)	10
	MVA(2)	(3)	(3)	12		MVA(2)	(3)	(3)	(3)
	(4)	17	18	22		(4)	13	(3)	23
	DVS	(3)	15	11		DVS	(3)	(3)	(3)
	NM	100	.166	215		NM	300*	175	216
G	MQ	08**	07**	08**	H	MQ		17**	15**
	MQ(2)	11	28	29		MQ(2)	(3)	(3)	(3)
	MVAM	50*	31**	43		MVAM	50*	(3)	(3)
	MVAM(2)	(3)		(3)		MVAM(2)	17**	(3)	17**
	MVA	08	11	08		MVA	(3)	(3)	(3)
	MVA(2)	10	11**	12		MVA(2)	(3)	(3)	(3)
	(4)	10	11	12		(4)	15	(3)	(3)
	DVS	10	09	09		DVS	(3)	(3)	(3)
	NM	178	180	215		NM	300*	173	(3)
(1)	- estimativa Inicial.		(2)-	modificação		no domínio c	os parâmetros.		
(*) - parada por número máximo de iterações. (**) - parada por falha no alg. proc. linear.
(3)	- não convergiu.
(4)	- MVAM-MVA
Tabela 5.18: Resultados dos Vários Métodos de Regressão. Caso 4. Estimativas iniciais na tabela 5.17 .
5.2	Análise de Casos de Reservatórios com Comportamento de Dupla Porosidade Infinito.
Nesta seção serão discutidos ires casos de testes de pressão, dois elaborados a partir de dados sintéticos e um caso de campo.
Para o primeiro caso, denominado caso S, foi gerada uma curva de pressão versus tempo para um período de fluxo a partir dos seguintes parâmetros: k = 163 niD, S = -2.45. C = 0.00233 bbl/psi. A = 3.47 * 10“5 eu? = 0.21; os demais dados necessários para o cálculo são aqueles mostrados n.a tabela 5.19. O resultado deste procedimento pode ser visto na tabela 5.20 onde estão listados os dados de pressão versus tempo. O modelo de acoplamento entre a matriz e a fratura utilizado para a construção da curva de pressão versus tempo foi o de Warren-Root.
Vazão de Teste	= 240.0 STB/d
Raio do Poço	= 0.375 pés
Porosidade	= 0.150
Espessura	= 24.0 pés
Viscosidade	= 5.2000 cp
Compressibilidade Total	= 75.0 x 10”6 1/psi
Fator Volume de Formação	= 1.478 bbl/STB
Tabela 5.19: Dados de reservatório para os casos 5 e 6.
Nas tabela 5.21 e 5.22 pode-se analisar o comportamento dos métodos MQ, DVS, MVAM, MVA, MVAM-MVA e MM. Nota-se que os métodos baseados na norma L2 (MQ e DVS) tiveram maior dificuldade de convergência, principalmente quando analisados perante o conjunto de dados de pressão mais derivada, enquanto que os métodos baseados na, norma LI (exceção ao método NM) convergiram facilmente para os valores corretos, mesmo na presença de ruídos introduzidos pelo cálculo da derivada. E importante frisar que os intervalos de confiança obtidos pelos métodos baseados na norma Ll. são, neste caso, muito melhores que os obtidos pelos métodos baseados na norma L2. No caso do método NM, quando se efetuou a regressão no conjunto de dados de pressão mais derivada, utilizou-se a seguinte função para minimização:
Ei(S) = 52 {2* |l°gApí-log Ap(a,tí)| + ]log A'pi - log	(5.9)
í'=i
Tempo de Teste (horas)	Queda de Pressão (psi)	Tempo de Teste (horas)	Queda de Pressão (.Psi)
.000500	2.9100	10.0000	275.2119
.001000	5.5049	15.0000	287.7672
.001500	7.9069	30.0000	308.0365
.005000	21.6002	50.0000	321.5469
.010000	35.9859	73.0000	330.4958
.015000	47.0334	98.0000	336.7446
.030000	69.9369	147.000	344.3399
.050000	89.0082	300.000	356.0063
.080000	107.1769	500.000	365.0756
.170000	135.9872	700.000	372.3069
.330000	160.3380	1000.00	381.3315
.500000	175.1263	1500.00	393.1086
.750000	189.2815	3000.00	415.4199
1.00000	199.1892	5000.00	432.4122
1.30000	208.1410	7000.00	443.6251
3.00000	236.2064	10000.0	455.5044
5.50000	256.0953	15000.0	469.0040
7,00000	263.8778	50000.0	509.0896
Tabela 5.20: Dados de pressão versus tempo para o caso 5.
escolhida para melhor ponderar as diferenças entre as curvas de pressão dos dados de campo e dos dados de pressão calculados quando comparadas às diferenças dos dados da derivada obtida com os dados de campo das obtidas analiticamente. Esta ponderação foi necessária pois os valores de pressão chegam a ser 17 vezes maiores que os valores da derivada, afetando consequentemente na mesma escala os valores das diferenças. Portanto a utilização do logaritmo da pressão e do logaritmo da derivada normaliza esta diferença de escala.
Met	Tipo Dado	k		s +/“ %		(1)	C +/- %	A	
		(mD)	+/- %					(2)	+/-%
MQ	P	147.8	1.05	-3.03	1.88	2.16	10.35	15.14	4.83
MQ	P+D	160.8	0.23	-2.52	0.56	2.27	1.90	3.92	1.44
DVS	P	163.0		-2.45	—	2.23	—	3.47	—
DVS	P+D	160.5	—	-2.53	—	2.28	—	4.03	—
MVAM	P	163.0	&lt;0,01	-2.45	&lt;0,01	2.23	&lt;0.01	3.47	&lt;0.01
MVAM	P+D	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	0.01	3.47	0.01
MVÃ	P	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	&lt;0.01	3.47	&lt;0.01
MVA	P+D	163.0	0.01	-2.45	0.02	2.23	0.06	3.47	0.06
(3)	P	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	&lt;0.01	3.47	&lt;0.01
(3)	P+D	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	&lt;0.01	3,47	0.01
NM	P	155.1	—	-2.47	—	2.18	—~	3.66	—
NM	P+D	133.9	—	-3.57	—	2.17	—	2.18	. —
(1)	- 10 3 bbl/psi	Estimativas Iniciais;
(2) - 10~5	k = 100. mD
(3) - MVAM MVA	S = 1.0
P - dados de pressão.	C = 0.01 bbl/psi
D - dados da derivada.	A = 10~5
P+D - dados de pressão e da derivada.	w = 0.05
Tabela 5.21: Comparação do Desempenho de Vários Métodos de Regressão para os dados do caso 5.
Método MQ MQ	Dados P P+D			MQR (psi2 /ponto} 26.065 5.171	MRA (psi /ponto} 3.960 1.640	Iterações 09 10
		0.114 0.195	+A % 6.43 1.56			
DVS	P	0.210	—	&lt;0.0001	&lt;0.0001	17
:dvs	P+D	0.193		5.165	1.633	30
MVAM	P	0.210	&lt;0.01	&lt;0.0001	&lt;0.0001	13
MVAM	P+D	0.210	0.01	5.504	1.381	17
MVA	P	0.210	&lt;0.01	&lt;0.0001	&lt;0.0001	14
MVA	P+D	0.210	0.06	5.504	1.381	16
(1)	P	0.210	&lt;0.01	&lt;0.0001	&lt;0.0001	11
(1)	P+D	0.210	&lt;0.01	5.504	1.380	14
NM	P	0.236	—	0.00097	0.0250	772
NM	P+D	0.198	—	0.00237*	0.0082*	237
(1)	- MVAM MVA
MQR * média dos quadrados dos resíduos. MRA - média dos resíduos absolutos.
* - função objetivo modificada.
Tabela 5.22: Comparação do Desempenho de Vários Métodos de Regressão para os dados do caso 5.
8S
Na tabela 5.24 estão mostrados os resultados do desempenho dos vários métodos frente às estimativas iniciais listadas na tabela 5.23. Nesta tabela fica bem clara a supremacia do método MVAM que só não convergiu para a estimativa F aplicada aos dados de pressão. Nota-se também que o método MVAM-MVA é muito bom, divergindo apenas para a estimativa inicial F aplicada aos dois conjuntos de dados. Interessante que neste último caso, quando o método MVAM foi trocado pelo MVA (aplicado ao conjunto de dados de pressão mais derivada) o método MVAM-MVA não convergiu apesar do MVAM convergir neste caso. Também deve-se ressaltar a dificuldade que o método NM teve quando aplicado a este modelo de reservatório. Pode-se notar que o método convergia para valores razoavelmente corretos dos parâmetros k, S e C, porém não teve capacidade de determinar bem os valores dos parâmetros A ew.
Estim. Inicial	k (inD)	S	C (bbl/psi)	A	LU
A	10.	-5.	0.01	l*10“5	0.10
B	1.	1.	0.01	l*10“5	0.10
C	500.	1.	0.01	U10 5	0.25
D	100.	15.	0.01	l*10~7	0.50
E	100.	1.	0.10	PIO"5	0.10
F	100.	1.	0.01	5*10—1	0.10
G	1000.	1.	0.001	piQ-7	0.01
H	50.	õ.	0.01	l*10"T	0.01
Tabela 5.23: Estimativas Iniciais Utilizadas para. Vários Métodos de Regressão para os dados do caso 5 e do caso 6.
(1)	Método	N.Iter e Tipo de Dados		(1)	Método	N.Iter e Tipo de Dados	
		P	P+D			P	P+D
A	MQ	16	12	B	MQ	19*	18
	MVAM	21	22		MVAM	27	28*
	MVA	37	(2)		MVA	17	(2)
	(3)	14	16		(3)	19	21
	DVS	(2)	(2)		DVS	26*	(2)
	NM	415	249		NM	(2)	(2)
C	MQ	(2)	(2)	D	MQ	15*	15*
	MVAM	20	24*		MVAM	23	10*
	MVA	(2)	(2)		MVA.	13	13
	(3)	27	21		(3)	15	17
	DVS	(2)	14		DVS	19	22
	NM	(2)	(2)		NM	(2)	(2)
E	MQ	11*	13*	F	MQ	(2)	(2)
	MVAM	20*	21		MVAM	(2)	39
	MVA	30	17		MVA	(2)	(2)
	(3)	10	14		(3)	(2)	(2)
	DVS	22*	22*		DVS	(2)	14
	NM	(2)	373		NM	(2)	(2)
G	MQ	15	16*	H	MQ	18*	16*
	MVAM	23	28		MVAM	21	22
	MVA	11	11		MVA	15	15
	(3)	19	18		(3)	15	19
	DVS	14	20*		DVS	18	14
	NM	(2)	(2)		NM	(2)	(2)
(1)	- estimativa inicial
(2)	- não convergiu.
(3)	- MVAM-MVA
(*) - falha alg. proc. linear.
Tabela 5.24: Resultados dos Vários Métodos de Regressão. Caso 5. Estimativas iniciais na tabela 5.23.
Nas figuras 5.48 e 5.49 estão plotados os dados de pressão e derivada lo* garítmica versus tempo em escalas log-log e semi-log bem como as curvas geradas pelos resultados das regressões. Pode-se observar que os resultados obtidos por quaisquer um dos métodos, excetuando-se o NM, são, visualmente falando, equivalentes. Na figura 5.50 observa-se a evolução da média dos resíduos ao quadrado (MQR) ao longo das iterações, onde os valores finais são equivalentes (5.171 psz2 p/ a norma L2 e 5.504 psi2 p/ a norma Ll). Já na figura 5.51 está plotada a evolução da média dos resíduos absolutos versus o número de iterações, onde novamente os valores finais são equivalentes (1.640 psi e 1.381 psi respectivamente).
TrrtTr i TTTHT!? ‘■'■‘■“-'rrTTTq ^’rrq-rrTn i i	i s i ivrq p , ¡ i	---
£1,001 0,1 ? 10 100 1000 10000
Delta T (horas)
Figura 5.48: Pressão e Derivada de Pressão versus Tempo em escala log-log, para regressão no conjunto de dados de pressão e da derivada. Caso 5.
Nas figuras 5.52 a 5.56 pode-se analisar a evolução dos cinco parâmetros de regressão (k, S, C. A eu; ) com o decorrer das iterações. As diferenças nos valores finais são mais perceptíveis nos casos dos parâmetros X e ijj (ver figuras 5.55 e 5.56). Já nas figuras 5.57 a 5.62 analisa-se a evolução ou caminho percorrido pelos parâmetros nos planos k-S, k-C, k-A, k-u;, A-u; e S-u;, A semelhança de comportamento observada no modelo de reservatório anterior entre os métodos MQ e MVAM e entre os métodos DVS e MVA, não fica tão clara neste caso, somente aparecendo nos planos k-C, k-u; e S-u;. Todas estas figuras foram elaboradas com as regressões efetuadas sobre os dados de pressão mais derivada.
•600.0©
S^500.&amp;amp;3
— MVAM,
coijoo Dn&amp;lt;j c? i
----~ MQ cu
.J
/
f—i
£3 330.00
a*
Delta T (horas)
Figura 5.49; Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão no conjunto de dados de pressão e da derivada. Caso 5.
MQ
Dy$
$0 W HVAM Mses WA a&amp;amp;4»*A rWAM-MVA
Iterações
Figura 5.51: Comportamento da média dos resíduos absolutos ao longo das iterações. Caso 5.
Figura
5.53: Comportamento do fator de película ao longo das iterações. Caso 5.
Figura 5.54: Comportamento do coeficiente de estocagem ao longo das iterações. Caso 5.
Figura 5.55: Comportamento do coeficiente de fluxo interporoso À ao longo das iterações. Caso 5.
Figura 5.57: Variação dos parâmetros ao longo das iterações no plano k-S para os vários métodos. Caso 5.
Figura 5.59: Variação dos parâmetros ao longo das iterações no plano k-A para os vários métodos. Caso 5.
9, B0 "
VFT
1
no
fl-aa a ft DVS
MV AM
mva jiAfra* MV AM- MV A
0.20-J
Lambda
Figura 5.61: Variação dos parâmetros ao longo das iterações no plano A-cv para os vários métodos. Caso 5,
0 resultado desta análise está, mostrado nas tabelas 5.26 e 5.27, onde novamente fica clara a dificuldade que os métodos baseados na norma L2 tem de lidar com dados contendo ruído, seja sua origem intrínseca à obtenção dos dados, seja por posterior procedimento de cálculo.
Para comparar a robustez destes métodos frente às estimativas iniciais da tabela 5-23, foi elaborada a tabela 5.28. Nela observa-se novamente a melhor robustez do método MVA.M comparado aos outros métodos, pois ele só divergiu duas vezes. Nota-se também que o método MVA. quando converge, não tem problemas com o algoritmo de procura linear, o que é comum nos métodos MQ, MVAM e DVS. Novamente o método NM não teve bom desempenho, convergindo somente em seis das dezesseis tentativas.
Nas figuras 5.63 e 5.64 pode-se observar o comportamento da pressão e da derivada em função do tempo em escalas log-Log e semi-log. Nota-se que os resultados dos métodos baseados tanto na norma LI como na norma L2 são equivalentes, porém. Conforme comentado acima, no entanto, os métodos baseados na minimização da, norma L2 convergiram com menor frequência do que aqueles baseados na norma LI.
Figura 5.63: Pressão e Derivada de Pressão versus Tempo em escala Iog-fog, para regressão no conjunto de dados de pressão e da derivada. Caso 6.
Campe
OOOOO Ga tio s 'Snttbíft-
--------MO&amp;lt;jy
^500.301
a 308,003
Delta T (horas)
- rwt.

Figura 5.64: Pressão e Derivada de Pressão versus Tempo em escala semi-Iog, para regressão no conjunto de dados de pressão e da derivada. Caso 6.
Tempo de Teste (horas)	Queda de Pressão Real (psi)	Queda de Pressão Modificada (psi)
Ü.Ü1OO	35.986	27.000
0.0500	89.008	95.000
1.0000	199.189	189.000
50,000	321.547	330.000
150.00	393.109	382.000
Tabela 5.25: Ruídos introduzidos nos dados de pressão. Caso 6.
Met.	Tipo Dado	k		s +/-%		(1)	C +/-%	À (2) +/- %	
		(mD)	+/- %						
MQ MQ	P P+D	160.9 158.6	0.66 0.61	-2.45 -2.64	1.57 1.37	2.22 2.25	5.24 5.08	3.72 4.60	4.12 3.46
DVS	P	162.0	—	-2.50		2.26	—	3.20	—
DVS	P+D	158.4	—	-2.65	—	2.19	—	4.54	—
MVAM	P	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	0.01	3.47	0.01
MVAM	P+D	162.5	0.09	-2.47	0.23	2.24	0.72	3.64	0.03
MVA	P	163.0	0.01	-2.45	0.01	2.23	0.06	3.47	0.04
MVA	P+D	163.0	0.01	-2.45	0.01	2.23	0.05	3.47	0.04
(3)	P	163.0	&lt;0.01	-2.45	&lt;0.01	2.23	0.01	3.47	0.01
(3)	P+D	163.0	&lt;0.01	-2.45	0.01	2.23	0.03	3.47	0.03
NM	P	152.1	—	-2.86	—	2.10	—	9.18	—
NM	P+D	151.0	—	-2.87	—	2.18	—	9.06	—
(1)	- 10 3 bbl/psi	Estimativas Iniciais:
(2) - 10“5	k = 100. mD
(3) - MVAM-MVA	S = 1.0
P - dados de pressão.	C = 0.01 bbl/psi
D - dados da derivada.	À = K&lt;5
P+D - dados de pressão e da derivada.	o? = 0.05
Método	Dados			MQR ( ps'12 /ponto)	MRA ( psi /ponto)	Iterações
			+/- %			
MQ	P	0,189	4.30	10.814	1.718	10
MQ	P+D	0.164	3.97	34.098	3.765	09
DVS	P	0.210	—	11.4041	1.803	11
DVS	P+D	0.1.64	—	34,024	3.733	19
MVAM	P	0.210	0.01	11.537	1.242	13
MVAM	P+D	0.210	0.53	35.407	3.450	09
MVA	P	0.210	0.04	11.537	1.243	13
MVA	P+D	0.210	0.04	35.550	3.405	13
(1)	P	0.210	0.01	11.537	1.242	12
(i!	P+D	0.210	0.03	35.550	3.405	13
NM	P	0.132	—	15.760	2.960	345
NM	P+D	0.123	—	14.937*	1.837*	255
(1) - MVAM- MVA
MQR - média dos quadrados dos resíduos. MRA - média dos resíduos absolutos.
* - função objetivo modificada.
.102
(1)	Método	N.Iter e Tipo de Dados		(1)	Método	N.Iter e Tipo de Dados	
		P	P+D			P	P+D
A	MQ	12	27	B	MQ	14	22*
	MVAM	15	17		MVAM	22	14*
	MVA	37	16		MVA	(2)	(2)
	(3)	14	21		(3)	18	17*
	DVS	20	(2)		DVS	25	(2)
	NM	576	292		NM	(2)	155
C	MQ	(2)	(2)	D	MQ	13*	16*
	MVAM	(2)	31*		MVAM	17	20*
	MVÂ	(2)	(2)		MVA	.1.1	11
	(3)	(2)	27		(3)	12	21
	DVS	(2)	18		DVS	(2)	(2)
	NM	528	198		NM	(2)	(2)
E	MQ	09*	14*	F	MQ	(2)	(2)
	MVAM	11*	15*		MVAM	(2)	28*
	MVA	15	14		MVA	(2)	(2)
	(3)	11	12		(3)	(2)	26
	DVS	19*	14*		DVS	32*	13*
	NM	(2)	356		NM	(2)	(2) ■
G	MQ	12*	16*	H	MQ	16*	14*
	MVAM	31*	20*		MVAM	15	19*
	MVA	11	11		MVA	14	15
	(3)	17*	22		(3)	15	18
	DVS	20*	15*		DVS	12	19*
	NM	(2)	(2)		NM	(2)	(2)
(1)	- estimativa iniciaL
(2)	- não convergiu.
(3)	- MVAM-MVA
(*) - falha alg. proc. linear.
Tabela 5.28: Resultados dos Vários Métodos de Regressão. Caso 6 . Estimativas iniciais na tabela 5.23.
A seguir foi examinado o comportamento dos métodos frente a uni caso real de dupla porosidade. Este caso foi obtido da referência [32], Trata-se de um período de estática após um fluxo de 23.55 horas. Novamente foi utilizado o tempo equivalente de Agarwal para analisar os dados. Nas tabelas 5.29 e 5.30 estão tabulados os dados de reservatório e os de pressão versus tempo, respectivamente.
E interessante notar que neste caso existiu convergência para mais de um mínimo, existindo dois mínimos quando foi efetuada regressão somente nos dados de pressão, tanto para a norma LI como para a norma L2. Já para a regressão efetuada no conjunto de dados de pressão mais derivada, a norma LI apresentou apenas 2 mínimos e a norma L2 quatro. Os valores para os quais cada tentativa convergiu podem ser observados na tabela 5.32, A seguir testamos a robustez dos métodos aqui analisados (MQ, MVAM, MVA, MVAM-MVA, DVS e NM) frente às estimativas iniciais mostradas na tabela 5.33. Os resultados desta análise estão mostrados na tabela 5.34. Através desta tabela, pode-se concluir que a dificuldade encontrada pela maioria dos métodos em convergir deve-se em parte a dois fatores: um tempo de estática não longo o suficiente para se atingir o conportamento radial infinito (ou a segunda reta no semi-log) e provavelmente uma correlação imperfeita entre os dados e o modelo de reservatório admitido (Warren e Root, pois quando se optou pelo modelo transiente não houve convergência). Outro fato interessante é que existiu uma estimativa inicial (E) na qual só houve convergência para o método MVAM-MVA aplicado aos dados de pressão. Este fato a princípio pode parecer estranho, pois o MVAM não convergiu quando aplicado aos dados de pressão e o método combinado sim. No entanto, para se conseguir a convergência, optou-se por deixar o programa trocar de método (do MVAM para o MVA) mesmo que houvesse falha no algoritmo de procura linear durante o período em que se utilizou o MVAM, e foi o que aconteceu neste caso. Também deve-se ressaltar que o método DVS só convergiu duas vezes e o NM só uma. Foram consideradas convergências bem sucedidas somente os casos em que os métodos convergiram para os pontos A1P, AIPD, A2P e A2PD (vide tabela 5.32),
Nas figuras 5.65 e 5.66 estão mostrados os resultados das regressões efetuadas sobre os dados de pressão com os métodos baseados nas norma L1 e L2 comparados aos dados de campo, enquanto que nas figuras 5.67 e 5.68 estão os resultados dos mesmos métodos quando aplicados ao conjunto de dados de pressão mais derivada.
.104
Tempo de Produção	~ 23.55 horas
Vazão de leste	=: 830.0 STB/d
Raio do Poço	=; 0.290 pés
Porosidade	=■■ 0.050
Espessura	7.0 pés
Viscosidade	== 0.3000 cp
Coinpressibilidade 'lotai	= 20.0 x 10_íi 1/psí
Fator Volume de Formação	- 1.500 bbl/STB
Tabela 5.29: Dados de reservatório para o caso 7.
Tempo	Queda de	Tempo	Queda de	Tempo	Queda de
de Teste	Pressão	de Teste	Pressão	de Teste	Pressão
(horas)	(psi)	(horas)	(psi)	(horas)	(psi)
.000621	.970000	.019874	30.500000	.069570	5'1.420
.001247	2,740000	.021115	31.410000	.072667	52.130
.001862	4.650000	.021741	31.920000	.075775	52.920
.002488	6.410000	.022356	32.330000	.078884	53.330
.003103	7.930000	.022982	33.000000	.081992	54.010
.003729	9.970000	.024223	33.740000	.085100	54.530
.004344	11.290000	.025464	34.620000	.088823	55.080
.004970	12.530000	.026705	35.370000	.091305	55.490
.005585	13.680000	.027946	36.170000	.094413	56.010
.006211	14.720000	.029198	36.990000	.097521	56.550
.006837	15.620000	.030439	37.580000	.100618	56.850
.007452	16.400000	.031680	38.400000	.103726	57.340
.008078	17.320000	.032921	38.970000	.106834	57.740
.008693	18.190000	.034162	39.680000	.111798	58.480
.009319	18.930000	.035403	40.150000	.116148	58.890
.009934	19.820000	.036644	40.880000	.120810	59.520
.010561	20.590000	.037885	41.430000	.125472	59.840
.011175	21.370000	.039126	41.900000	.130437	60.450
.011802	22.120000	.040378	42.490000	.134786	60.900
.012428	22.950000	.041619	43.000000	.139750	61.260
.013043	23.690000	.043475	43,750000	.144099	61.650
.013669	24.540000	.045342	44.490000	.153423	62.380
.014284	25.080000	.047210	45.040000	.162737	63.080
.014910	25.800000	.049066	45.880000	.173291	63.870
.015525	26.420000	.050933	46.320000	.181374	64.460
.016151	26.980000	.053415	47.310000	.190687	64.930
.016766	27.570000	.055897	48.000000	.200001	65.360
.017392	28.120000	.059005	48.970000	.209325	65.780
.018018	28.730000	.061487	49.750000	.218638	66.200
.018633 .019259	29.360000 29.790000	.063980 .066462	50.110000 50.750000	.227951	66.640
Tempo	Queda de	Tempo	Queda de	Tempo	Queda de
de Teste	Pressão	de Teste	Pressão	de Teste	Pressão
(horas)	(psi)	(horas)	(psi)	(horas)	(psi)
.237276	67.04	.908096		5.305700	81.80
.246589	67.40	.945360	75.61	5.585210	81.81
.255902	67.71	.982624	75.92	5.864710	82.12
.265227	68.00	1.019900	75.98	6.144220	82.24
.274540	68.35	1.057160	75.78	6.423730	82.49
.293178	68.91	1.113070	76.22	6.703240	82.63
.311804	69.13	1.168970	76.58	6.982750	82.82
.330442	69.70	1.224870	76,81	7.262260	83.04
.349079	70.10	1.280780	76.65	7.541770	83.17
.358393	70.40	1.336680	76.98	7.914410	83.38
.367706	70.53	1.392580	77.16	8.287160	83.70
.386343	70.95	1.485740	77.25	8.659800	83.70
.404981	71.35	1.578920	77.95	9.032440	83.87
.423607	71.59	1.672090	77.77	9.405190	84.09
.442245	71.94	1.765250	78.14	9.777830	84.39
.460883	72.21	1.858430	78.21	10.150500	84.44
.479509	72.42	1.951600	78.39	10.523200	84.76
.498147	72.32	2.137940	78.66	10.895900	84.80
.516784	72.47	2.324270	78.93	11.454900	85.18
.535411	72.73	2.510610	79.23	12.013900	85.32
.554048	72.92	2.696960	79.55	12.573000	85.59
.572686	73.21	2.883290	79.63	13.132000	85.78
.609950	73.70	3.069630	79.82	13.691000	86.10
.647214	73.75	3.349140	80.19	14.250000	86.20
.684489	73.81	3.628650	80.37	14.809000	86.55
.721754	74.39	3.908150	80.37	15.368000	86.46
.759018	74.76	4.187660	80.79	15.927100	86.72
.796293	75.05	4.467170	81.09	16.486100	86.79
.833557	75.32	4.746680	81.23	17.045100	87.17
.870821	75.11	5.026190	81.46	17.605900	87.23
Figura. 5.66: Pressão e Derivada de Pressão versus Tempo em escala semi-log, para regressão nos dados de pressão. Caso 7.
Figura 5.67: Pressão e Derivada de Pressão versus Tempo em escala log log, para regressão nos dados de pressão e da derivada. Caso 7.
Figura 5.68: Pressão e Derivada de Pressão versus ’Jeinpo em escala semrlog, para regressão no conjunto de dados de pressão e da derivada. Caso 7.
Ponto	k (mO)	S	c (bbl/psi)	À 10~5		MQR (psi2 / ponto)	MRA (psz ¡ponto)
A1P	361.9	-5.200	0.0161	74.06	0.0658	0.140	0.283
B1P	837.2	-0.127	0.0240	3.010	0.0210	2.300	1.267
AIPD	403.9	-4.848	0.0173	26.69	0.0738	0.605	0.573
B1PD	795.8	-0.555	0.0243	7.889	0.0083	3.139	1.461
A2P	379.2	-5.050	0.0164	49.80	0.0711	0.130	0.294
B2P	771.0	-0.731	0.0231	13.56	0.0546	2.118	1.322
A2PD	397.7	-4.920	0.0171	30.73	0.0719	0.592	0.578
B2PD	504.0	-3.742	0.0197	2.785	0.1590	0.941	0.766
C2PD	542.7	-3.320	0.0205	0.739	0.1630	2.452	1.390
D2PD	743.3	-0.990	0.0235	18.36	0.0379	2.938	1.495
			intervalos de Confiança				
Ponto	k (+/-	%) S (+/- %) C (+/- 9					(+/- %)
A1P	0.08		0.05	0.08	0.16		0.21
B1P	0.08		5.49	0.36	25	.32	23.61
AIPD	0.1.1		0.10	0.11	0.18		0.28
B1PD	0.09		1.32	0.17	8.92		9.02
A2P	0.23		0.18	0.23	0.36		0.61
B2P	0.26		2.66	0.80	61.13		24.61
À2PD	0.17		0.15	0.18	0.33		0.54
B2PD	0.20		0.30	0.15	0.56		0.75
C2PD	0.20		0.30	0.15	0.79		0.81
D2PD	0.16		1.11	0.29	13.96		8.96
1	- norma LI
2	- norma L2
P - dados de pressão.
P.D - dados de pressão e da derivada.
Tabela 5.32: Pontos de mínimos locais e mínimo absoluto para os dados do caso 7 quando submetidos às normas Ll. e L2,
Estim. Inicial	k (mD)	s	C (bbi/psí)	À	u?
A	100.	1.	0.001	l*10“6	0.01
B	100.	.15.	0.10	i*w~6	0.01
C	100.	1.	0.01	rio-6	0.01
D	100.	1.	0.01	l*10~4	0.01
E	100.	1.	0.01	l*10“r	0.25
F	250.	1.	0.01	rio-3	0.50
G	10.	1.	0.02	l*10~6	0.05
H	1.	1.	0.005	5*10~6	0.10
I	250.	-5.	0.015	i*l(T4	0.10
J	100.	*5.	0.01	piQ-5	0.50
K	100.	1.	0.01	rio~6	0.01
Tabela 5.33: Estimativas Iniciais Utilizadas para Vários Métodos de Regressão para os dados do caso 7.
(1)	Método	N.Iter e Típo de Dados		(1)	Método	N.Iter e 'Pipo de Dados	
		P	P+D			P	P+D
A	MQ		08	B	MQ	**	
	MVAM	22	12		MVAM	07	
	MVA	**	**		MVA		**
	(2)	16	13		(2)	15	
	DVS				DVS	•¥*	
	NM		**		NM	:$csj;	
C	MQ	13	13	D	MQ		
	MVAM	12.	17		MVAM	17	
	MVA				MVA		
	(2)	15	15		(2)	.1.2	•¿X
	DVS				DVS	3*; x	X £
	NM	ijc^í	?k;k		NM		íjtX
E	MQ	jfciiC	jfc jff	F	MQ	15	X x
	MVAM		x &amp;amp;		MVAM	09	
	MVA	* «			MVA	ífcjiç	
	(2)	22	jicsís		(2)		
	DVS		ipífc		DVS		**
	x\TM	**	iff^í		NM		A:
G	MQ		24	H	MQ	18	
	MVAM	19	15		MVAM		20
	MVA	**			MVA	Jàt	íáí*
	(2)	12	15		(2)	19	**
	DVS	**			DVS		
	NM		■* *		NM	jit X	
I	MQ	08	07	J	MQ	* Tií	
	MVAM	16	12		MVAM	05	07
	MVA		**		MVA	**	10
	(2)	09	12		(2)	05	13
	DVS	18			DVS	14	X X
	NM	258	a&amp;lt;4&lt;		NM	X ;■&lt;	**
K	MQ	Sc	07				
	MVAM	06	16				
	MVA	ifCJSC	24				
	(2)	12	15				
	DVS						
	NM						
(1)	- estimativa inicial.
(2)	- MVAM-MVA (**) - não convergiu.
Tabela 5.34: Resultados dos Vários Métodos de Regressão. Caso 7 . Estimativas iniciais na tabela 5.33 .
6	CONCLUSÕES e RECOMENDAÇÕES.
1.	Os métodos de regressão não linear permitem obter os parâmetros da formação através da análise de testes de pressão em poços de petróleo em casos onde a análise convencional não obtém bons resultados.
2.	Os métodos baseados na norma LI se mostraram capazes de definir subconjuntos de pontos onde o modelo físico-matemático não se aplica ou se aplica parcialmente, atribuindo menor peso a estas regiões e/ou pontos durante a estimativa dos parâmetros,
3.	A análise estatística dos resultados demonstrou que os métodos baseados na norma Li obtém menores intervalos de confiança quando comparados com os resultados obtidos pelos métodos baseados na norma L2.
4.	A utilização da função penalidade proposta neste trabalho, quando possível, evitou, para algumas estimativas iniciais, problemas com divergência,
5.	A mudança no domínio dos parâmetros proposta neste trabalho só trouxe melhores resultados no caso do método de Nelder-Mead, onde se mostrou imprescindível para os parâmetros k (permeabilidade), C (coeficiente de estocagem) e A (coeficiente de fluxo interporoso), porém para os outros dois parâmetros, S (fator de película) e új (razão de armazenamento), não se mostrou eficaz,
6.	Dentre os métodos analisados, o método de mínimos valores absolutos modificado (MVAM) e o método combinado (MVAM-MVA) mostraram-se mais robustos em relação ao número de iterações e principalmente quanto à convergência a partir de estimativas iniciais pobres,
7.	0 método de decomposição em valores singulares, apesar de ser recomendado na literatura para minimização da norma L2 em problemas mal condicionados, não se mostrou eficiente,
8.	0 método de Nelder-Mead. devido à sua fácil implementação, seria recomendável para problemas em que a função objetivo fosse complexa e/ou não apresentasse derivadas analíticas, porém necessita de um estudo mais aprofundado para acelerar a sua convergência.
9.	A aplicação da regressão não linear sobre o conjunto de dados de pressão mais derivada garante maior robustez aos métodos, principalmente quando já existe algum ruído nos dados de pressão.
10.	O uso de somente os dados da derivada numa regressão não produz bons resultados,
11.	O uso da curva da derivada, apesar de fornecer resultados piores que aqueles fornecidos pela curva de pressão ou pelo conjunto de pressão mais derivada, apresenta melhor performance no que diz respeito à robustez frente a estimativas iniciais ruins,
12.	No caso de modelo de reservatório de dupla porosidade, o problema se mostrou mal condicionado causando dificuldades de convergência. Quando foi analisado urn caso real, foram encontrados mais de um mínimo na superfície analisada (tanto na norma LI como na L2). Esta dificuldade de convergência pode ser explicada pela influência de alguns parâmetros somente na transição entre as duas retas semi-log.
13.	0 modelo de dupla porosidade mostrou-se pouco sensível ao parâmetro de coeficiente de fluxo interporoso (A).
14.	Sugere-se o estudo de novas funções para mudança de domínio, com o objetivo de restringir a otimização a regiões onde os parâmetros apresentem significado fisicomatemático. Estas novas funções teriam aplicabilidade imediata aos métodos de decomposição em valores singulares (DVS), de mínimos valores absolutos (MVA) e de Nelder-Mead (NM).
NOMENCLATURA
B — fator volume de formação, RB/STB (m3/m3std).
c = compressibilidade. psi~A (PaM).
C ~ coeficiente de estocagem, bbl/psi (m3/Pa).
D = matriz diagonal.
DV S = decomposição em valores singulares. £1 = função objetivo para a norma Ll, psi (Pa).
E? “ função objetivo para a norma L2, psi2 (Pa2).
F = solução analítica da função analisada. h — altura do reservatório, pés (m).
H ~ matriz Hessiana.
Kq — função de Bessel modificada de ordem zero.
Â'i = função de Bessel modificada de ordem um. k permeabilidade absoluta, mD (m2).
MQ = mínimos quadrados.
MQll = média dos quadrados dos resíduos, psi2/ponto (Pa2/ponto).
MV A ----- mínimos valores absolutos.
MV AM — mínimos valores absolutos modificado.
Aí RA ~ média dos resíduos abolutos, psi ¡ponto (Pa/ponto), n = função densidade.
NM = Nelder Mead.
npar = número de parâmetros. npon = número de pontos.
p = pressão, psi (Pa),
q = vazão nas condições de superfície, ST B/d (m3/s).
r = distância radial, pés (m).
S	~ fator de película, adiniensional.
t = tempo, horas (5).
u = variável no espaço de Laplace.
V = volume, ft3 (m3).
x = variável genérica, exemplo t y — variável dependente genérica , exemplo p
Letras gregas
a = vetor de parâmetros a serem determinados.
= diferença entre os parâmetros das iterações n e n+1.
A = coeficiente de fiuxo interporoso, adimensional, p — viscosidade , cp (Pa.s).
p = média.
u; = parâmetro de armazenamento, adimensional.
&lt;p — porosidade, fração (fração).
p — parâmetro de relaxação, adimensional.
&lt;r = desvio padrão.
Subscritos
D = adimensional.
eq = equivalente.
f ~ fluxo.
fr = fratura.
í = inicial.
L-M — Levenberg-Marquardt. m = matriz.
mod. = modificado.
p = produção, t total.
w — poço.
0 = inicial.
Sobreescritos
0 = inicial.
Transformações de Unidades bbl / dí a — 0.159	m3/ di a
psi = 1.395 * 108 Pa pe = 0.3048 m
mD = 0.897 * 10”12 m2 cp — IO”3 Pa. 3 bblfpsi = 1.211 * 10"9 m?/Pa pol = 0.0254 m
Referências
[1]	Levenberg, K.: A Method For The Solution Of Certain Problems In Least Squares”, Quart. Appl. Math., 2 (1944), pp. 164-168.
[2]	Marquardt, D. W.: ”An Algorithm For Least-Squares Estimation Of Nonlinear Parameters”, J, Soc. Indust, Appl. Math., Vol. 11, n.2, June, 1963,
[3]	Janhs. H. 0.: "A Rapid Method For Obtaining A Two-Dimensional Reservoir Description From Well Pressure Response Data.” . Soc. Pet. Eng. J. (December 1966), 315-327,
[4]	Coats, K. H., Dempsey, J. R. e Henderson, J. FL: ”A New Technique For Determining Reservoir Description From Field Performance Data,’', Soc. Pet. Eng. J. (March
1970)	, 66-74.
[5]	Thomas, L. K., Heliums. L. J. e Rebels, G. M.: ”A Nonlinear Automatic History Matching Technique For Reservoir Simulation Models.”, Soc. Pet. Eng. J, (October
1971)	, 508-514.
[6]	Earlougher, R, C. Jr, Kersch, K. M.: ’’ Field Examples Of Automatic Transient Test Analysis.”, J. Pet. Tech. (October 1972) 1271-1277.
[7]	Hernandez, V. M. e Swift, G. W.: ” A Method For Determining Reservoir Parameters From Early Drawdown Data.11, paper SPE 3982, 47iJ1 Annual Fall Meeting of the Society of Petroleum Engineers of AIME, San Antonio, Texas, October 8-11 1972.
[8]	Rodgers, J. S., Coble, L. E., Boykin, R. S. e Mokha, J. S.: ’’Nonlinear Well Test Analysis Reveals Reservoir Boundary Shape.”, TECHNOLOGY, Oil and Gas Journal (September 14, 1981) 63-68.
[9]	Rosa, A. J. e Horne, R, N.: ’’Automated Type-Curve Matching In Well Test Analysis Using Laplace Space Determination Of Parameter Gradients.”, paper SPE 12131, ■58ià Annual Technical Conference of the Society of Petroleum Engineers of AIME, San Francisco, California, October 5-8, 1983.
[10]	Barua, J., Kucuk, F. e Gomez-Angulo, J.: ’’Application Of Computers In The Analysis Of Well Tests From Fractured Reservoirs.”, paper SPE 13662, California Regional Meeting. Bakerfield, California, March 27-29, 1985.
[11]	Barua, J.. Horne, R. N., Greenstadt, J. L. e Lopez, L.t ’’Improved Estimation Algorithms For Automated Type-Curve Analysis Of Well Tests.”, paper SPE 1.4225, Annual Technical Conference of the Society of Petroleum Engineers of AIME, Las Vegas, Nevada, September 22-25, 1985.
[12]	Namba, T. e Horne, R, N.: ”An Improved Regression Algorithm For Automated Well Test Analysis?1, paper SPE 18161, 63iil Annual Technical Conference of the Society of Petroleum Engineers of AIME. Houston, Texas, October 2-5, 1988.
[13]	Gill, P. E, e Murray, W,: ” Newton-Type Methods For Unconstrained And Linearly Constrained Optimization,”, Mathematical Programming, (1974) vol.7, 311-350.
[14]	Rosa, A. J, e Horne, R. N.: ’’Automated Well Test Analysis Using Robust (LAV) Nonlinear Parameter Estimation?, paper SPE 22679, 66ih Annual Technical Conference of the Society of Petroleum Engineers of AIME, Dallas, Texas, October 6-9, 1991,
[15]	Coelho, A, C. D,: ’’Análise De Testes Em Reservatórios Com Variação Vertical De Permeabilidade”, Tese de Mestrado - UNICAMP - Departamento de Engenharia de Petróleo, Campinas, São Paulo, Novembro - 1991,
16] Greenstadt, J, L.: ”On The Relative Efficiences Of Gradient Methods?1, Mathematics Of Computation, 21, 360-367, 1967
[17]	Carvalho, R.S.; Redner, R.A.; Thompson, L.G, e Reynolds, A.C.: ’’Robust Procedures For Parameter Estimation By Automated Type-Curve Matching?’, paper SPE 24732, 67tó Annual Technical Conference of the Society of Petroleum Engineers of AIME, Washington, DC, October 4-7, 1992.
[18]	Agarwal, R, G., Al-Hussainy e R,, Ramey, H, J. Jr.: ”An Investigation Of Wellbore Storage And Shin Effect In Unsteady Liquid Flow: L Analytical Treatment?’, Soc, Pet, Eng, J, (September 1970) 279-290.
[19]	Warren, J. E. e Root, P, J.: ’’Behavior Of Naturally Fractured Reservoirs?’, Soc, Pet, Eng. J. (September 1963) 245-255.
[20]	De Swaan, A. 0.: ’’Analytic Solutions For Determining Naturally Fractured Reservoir Properties By Well Testing?1, paper SPE 5346, 45ifl Annual California Regional Meeting of the Society of Petroleum Engineers of AIME, Ventura, California, April 2-4, 1975.
[21]	Press, W. H., Flannery, B, P., Teukolsky, S. A. e Vetteding, W, T.: ’’Numerical Recipes?’, Cambridge University Press, Cambridge, 1988.
[22]	Rosa, A, J.: ’’Automated Type Curve Matching In Well Test Analysis?’, Tese de Mestrado - Stanford University, Stanford, California, Março - 1983.
[23]	El-Attar, R.A., Vidyasagar, M. e Dutta, S.R.K.: ” An Algorithm for Ll-Norm Minimization With Application To Nonlinear Ll Approximation.”, SIAM J. Num, Anal, (February 1979), 16, N, 1, 70-86,
[24]	Schlossmacher, E. J.: ’’An. Iterative Technique For Absolute Deviations Curve Fitting.”, Journal of the American Statistical Association, December 1973, Volume 68, Number 344.
[25]	Mathews, J.N.: ’’Numerical Methods For Mathematics, Science And Engineering.”; Prentice-Hall International, Inc.; New Jersey; 1992.
[26]	Hartley, H.O.: ’’Exact Confidence Regions For The Parameters In Nonlinear Regressions Laws.”, Biometrica (1964), vol. 51, 347.
[27]	Dogru, A.N., Dixon, T.N. e Edgar, T.F.; ’’Confidence Limits On The Parameters And Predictions Of Slightly Compressible, Single-Phase Reservoirs.”, Soc. Pet. Eng. J. (February 1977), 42-56.
[28]	Stehfest, H.: ’’Numerical Inversion Of Laplace Transforms. ”, Communications Of The A.CM. (January 1970), 13, N.I, Algorithm 368.
[29]	Bourgeouis, M.J. e Horne, R.N.: ’’Well Test Model Recognition Using Laplace Space.”, paper SPE 22682, 66iA Annual Technical Conference of the Society of Petroleum Engineers of A IVIE, Dallas, Texas, October 6-9, 1991.
[30]	Ramey Jr, H.J.: ’’Advances In Practical Well-Test Analysis”, JPT (June 1992).
[31]	Rosa, A. J.: ’’Reservoir Description By Well Test Analysis Using Cyclic Flow Rate Variation.”, Tese de Doutorado - Stanford University, Stanford, California, September - 1991.
[32]	Bourdet, D., Ayoub, J.A., Whitle, T.M., Pirard, Y.M. e Kniazeff, V.: ’’Interpreting Well Tests In Fractured Reservoirs.”, World Oil, Oct. 1983 (77-87).
[33]	Bourdet, D., Ayoub, J.A. e Pirard, Y.M.: ’’Use Of Pressure Derivative In Well Test Interpretation.”, SPEFE (Jun 1989).
A ALGORITMO DE PROCURA LINEAR.
Neste apéndice será apresentado o algoritmo de procura linear utilizado neste trabalho.
Através des te algoritmo evita-se que os métodos caminhem através de regiões onde os parâmetros de regressão não tem significado físico-matemático ou que os novos pontos determinados a cada iteração tenham resíduos maiores que os dos pontos anteriores. Este algoritmo pode ser resumido como:
m = 0
A p = 0.5™
cq'+i = af + p * 8i (í ~ 1, npar}
Se &gt; limite^ então (i — l,npar)
m = m + 1
Se m &gt; 10 PARE
va para A
Fim do Se
Calcule Residuon+1
Se Residuo™'*1 &gt; Residuo™, então
m = m + 1
Se m &gt; 10 PARE
va. para A
Fim do Se
B DERIVADAS ANALÍTICAS DA QUEDA DE PRES SÃO EM RELAÇÃO AOS PARÂMETROS DE REGRESSÃO PARA RESERVATÓRIO HOMOGÊNEO INFINITO.
Neste apêndice está demonstrada a obtenção analítica das derivadas da queda de pressão em relação aos tres parâmetros de regressão.
A expressão para	é dada pela equação 3.11.
Definindo:
D =	(B.I)
c-2 = ^hjp.	(B.2)
a =	(8.3)
3 = C2&amp;amp;/27T	(B.4)
então:


QsaVhÍKifei y/u/k)	¡
....  y	".r... i *	...
Definindo:
AUXV
AUXi = KQ(c1^)+c1Syfi/kK.(c1^)
podemos escrever:
(B.5)
(B.6)
(B.7)
Apw/(ã,u) ~
(B.8)
Então a derivada em relação a k é:
onde:
dXpwf _ qB AUX4.AUX2 ~ AUXlAUX^ dk ~ u	AUXl,AUX3
.aux2
AUXz =
(B.9)
(B.10)
(B.ll)
(B.12)
As outras derivadas são:
dXp^.f __ qBczka2 [A'iíAyüj2
~~dS~~ " AUXs.AUXt
dApwf qB dC “ Aí/Xg
(B.13)
(B.14)
C ESQUEMA DE OBTENÇÃO NUMÉRICA DA DERIVADA DA QUEDA DE PRESSÃO PARA RESERVATÓRIO DE DUPLA POROSIDADE EM RELAÇÃO AOS PARÂMETROS DE REGRESSÃO.
Para se obter as derivadas deste modelo, optou-se por um esquema numérico devido à complexidade da solução analítica. Este esquema pode ser descrito como:
Se parí 0 então
Senão
Fim do Se
Calcule Fun(par + Aaq,! = 1,/jpar)
dFuTi __ Fwi(par+&amp;amp;Si’)—Fun(par)
Am
(i = 1. npar)
D ESQUEMA DE OBTENÇÃO NUMÉRICA DA DERIVADA DA QUEDA DE PRESSÃO EM RELAÇÃO AO LOGARITMO DO TEMPO.
Para se obter a derivada logarítmica utilizou-se do procedimento apresentado na referência [33]. Este procedimento pode ser descrito como:
Faça i ~ 2 a npon ~ 1
Se log(/i/ii) &amp;lt;0,1 então
Senão
Se [Iog(tnpm/^) &gt; 0.1] então
J “ '£ 4" 1
Faça enqto [log(íj/tj &amp;lt;0.1]
j ” j + 1
Fim do enqto
AUX2 = ti
AUXi = Ápj -- Api
j = i~l
Faça enqto [log(íi/íj) &amp;lt;0.1] j = j ~ 1
Fim do enqto
AUXx = ti-tj
AU X3 — Api — Ap,
—	(AUXt+AUXi)
= ti * AUX
Senão
ÊAe. =	* é? Ap,
31ní 1 tnpon”£i
Fim do Se
Fim do Se
Fim do faça
Extrapole para i — 1 e i — upon
E LISTAGENS DE PROGRAMAS EM FORTRAN.
C************************************ ******************** *************** C**** PROGRAMA PROGl.FOR	*******
C***i*i ******************************************************* **********
Ç**** c**** c** **
0**** c**** c****
Regressão nao linear cora minimos quadrados utilizando o ******* método de Gauss para um modelo de reservatório radial ******* infinito	*******
******* *******
*******
c
c
10
20
100
101
c
c
c
300
IMPLICIT REAL*8 (A-H,O“Z)
PARAMETER (NPON-150,NPAR—3)
CHARACTER*12 ARQUIVO
DIMENSION TESP(NPON) ,TEST(NPON) , B (NPON,NPAR) , FUN(NPON) ,RES(2*NPON)
DIMENSION A(NPAR,NPAR+1) ,DELTA(NPAR) , AS (NPAR, NPAR+1) ,PEN(NPAR) ,
*	DP(NPON),Bl(NPON,NPAR)
COMMON /STE/ V(50)
DADOS DE RESERVATÓRIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),
Q(STB/D), BO(BBL/STB)
WRITE(*,*) 'ENTRE COM O ARQUIVO DE DADOS'
READ(*,*) ARQUIVO
open(4,file-ARQUIVO,status-'unknown')
open(7,file='SAIMQ.DAT',status='unknown')
open(8,file='RESMQ,DAT',status^'unknown')
open(9,file='LIXO.DAT',status='unknown')
READ (4,10) RESH, RESVIS, RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5)
READ(4,20) NP
FORMAT(T32,13)
DO 100 1=1,NP
READ(4,*) TEST(I),TESP(I)
CONTINUE
IF(TPROD.NE.0.DO) THEN
DO 101 I = 1,NP
TEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)
CONTINUE
ENDIF
VARIAVEIS DE CONTROLE PARA O ALGORITMO DE STHEFEST COM 8 CTES
M = 0
N = 8
CONSTANTE INICIAL PARA O ALGORITMO DE GAUSS-MARQUARDT
RLAM = 0.1D0
TRANSFORMAÇÕES DE UNIDADE
RESCT = RESCT*14.7D0
RESQ = RESQ*RESBO*1.84D0
RESRW = RESRW*2.54DO
RESH = RESH*30.48D0
DO 300 I = 1,NP
TEST(I) = TEST(I)*3.6D3
TESP(I) = TESP(I)/14.7D0
CONTINUE
WRITE(6,*) WRITE(6,*) WRITE{6,*) WRITE(6,*)
'QUAL A FUNCAO A MINIMIZAR
'1 - PRESSÃO.'
'2 - DERIVADA.'
'3 - DERIVADA + PRESSÃO.'
READ(5,*) IOPT
CALL DPDT(TEST,TESP,NP,DP)
WRITE(6,*)
*	'ENTRE COM OS VALORES INICIAIS DE K(D),
READ(5,*) OESTK,OESTS,OESTC
S E C(CM3/ATM)
f
105
110
111
WRITE(9,*)
WRITE(9,*) 'ARQUIVO :ARQUIVO
WRITE(9/*)
WRITE(9/*) 'METODO DE MINIMOS QUADRADOS.'
WRITE(9,*)
WRITE(9,105) OESTK*1.D+3,OESTS,OESTC*4. 2784409E-7
WRITE(8,105) OESTK*l.D+3,OESTS,OESTC*4.2784409E-7 FORMAT(3X,'ESTIMATIVAS INICIAIS'//
*	IX,'K	=',F10.5/
*	IX,'S	=',F10.5/
*	IX,'C	=',E10.3)
IF (OESTS,LT.0.DO) THEN
RESRWE = RESRW*DEXP(-OESTS)
SKIN = 0.D0
ELSE
RESRWE = RESRW
SKIN » OESTS
ENDIF
SSROLD = 0.D0
SAV = O.DO
IF (IOPT.NE.3) THEN
FII = 1.0D0
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	OESTK,SKIN,OESTC,TEST,N,M,NP,B,FUN,IOPT)
DO 110 I = 1,NP
IF (IOPT.EQ.1) THEN RES(I) = FUN(I) - TESP(I)
ELSE
RES(I) = FUN(I) ~ DP(I)
ENDIF
SSROLD = SSROLD + RES(I)*RES(I) AUX1 - DABS(RES(I))
SAV - SAV + AUX1
CONTINUE
ELSE
FII - 2.ODO
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	OESTK,SKIN,OESTC,
*	TEST,N,M,NP,
*	B,FUN,1)
DO 111 I » 1,NP
RES(I) « FUN(I) - TESP(I)
SSROLD = SSROLD + RES(I)*RES(I)
AUX1 = DABS(RES(I))
SAV = SAV + AUX1
A
★
*
CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, OESTK,SKIN,OESTC,
TEST,N,M,NP,
Bl,FUN,2)
DO 112 I = I,NP
RES(I+NP) = FUN(I) - DP(I)
SSROLD = SSROLD + RES(I+NP)*RES(I+NP)
AUX1 = DABS(RES(I+NP))
SAV = SAV + AUX1
112
CONTINUE
ENDIF
SSROLD-- SSROLD/(FII*NP)
410
420
430
440
500
505
C
C
C
c
510
520
C
560
570
550
ITMAX = 51
TOL = l.D-4
TOLK = 1.D0
TOLS = 1.D0
TOLC = l«D0
ITER - 0
MM - 0
DO WHILE((TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.
*	ITMAX.AND.MM.LT.10)
ITER = ITER + 1
DO 420 I = 1,NPAR
DO 410 J = 1,NPAR+1 A(I,J) » 0.D0
CONTINUE
CONTINUE
DO 500 K » 1,NP
DO 440 I = 1,NPAR
DO 430 J = 1,NPAR
A(I,J) = A(I,J) + B(K,I)*B(K,J)
IF(IOPT.EQ.3) A(I,J) = A(I,J) + BI(K,I)*B1(K,J) CONTINUE
A(I,NPAR+1) = A(I,NPAR+1) + RES(K)*B(K,I)
IF (I0PT.EQ.3)
*	A(I,NPAR+1) = A(I,NPAR+1) + RES(K+NP)*B1(K,I) CONTINUE
CONTINUE
DO 505 I = 1,NPAR
A(I,NPAR+1) = ~A(I,NPAR+1)
CONTINUE
INCLUINDO AS FUNCOES PENALIDADES
K &gt; 0
-7 &amp;lt;S &amp;lt;20
C &gt; 0
PEN(l) ® 2.D-5/OESTK**3
PEN(2) » l.D-2*( DEXP(-0ESTS-7.DO) + DEXP(-2.Dl+OESTS) )
PEN(3) « 2. D1/OESTC**3
DO 510 I « 1,NPAR
PEN(I) - PEN(I)*NP*FII*SSR0LD/2.D0
A(I,I) = A(I,I) + PEN(I)
CONTINUE
PEN(l) = l.D-5/OESTK**2
PEN(2) = l.D-2*( DEXP(-OESTS“7.DO) - DEXP(-2.Dl+OESTS) )
PEN(3) = l.Dl/OESTC**2
DO 520 I = 1,NPAR
PEN(I) ® PEN(I)*NP*FII*SSROLD/2.DO
A(I,NPAR+1) = A(I,NPAR+1) + PEN(I)
CONTINUE
ESCALONANDO A MATRIZ A
DO 570 I = 1,NPAR
DO 560 J = 1,NPAR AS(I,J) = A(I,J)/DSQRT(A(I,I)*A(J,J)) CONTINUE
710
DELS = DELTA(2)/DSQRT(A(2,2))
DELC = DELTA(3)/DSQRT(A(3,3))
MM « 0
MMM = 0
RO = .5D0**MM
ESTK - OESTK + RO*DELK
ESTS = OESTS + RO*DELS
ESTC = OESTC + RO*DELC
IF (ESTK.LE.O.DO.OR.ESTC.LT.0.DO) THEN
MM = MM t 1
WRITE(*,*) 'SOMA POR LIMITE'
IF (MM.GT.10) THEN
WRITE(*,*) 'FALHA POR LIMITE'
GO TO 402
ENDIF
402
GO TO 710
ENDIF
IF (ESTS.LT.0.DO) THEN
RESRWE = RESRW*DEXP(-ESTS)
SKIN = 0.D0
ELSE
RESRWE « RESRW
SKIN » ESTS
ENDIF
SSR = 0.D0
SAV = 0.D0
113
*
*
A
*
*
*
IF (I0PT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS ,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP, B,FUN,IOPT)
DO 113 I = 1,NP
IF (I0PT.EQ.1) THEN RES(I) = FUN(I) - TESP(I)
T?r CJ’E’
IZjLjOXj
RES(I) = FUN(I) - DP(I)
ENDIF
SSR = SSR + RES(I)*RES(I)
AUX1 « DABS(RES(I))
SAV = SAV + AUX1
CONTINUE
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP,
B,FUN,1)
DO 114 I = 1,NP
RES(I) = FUN(I) - TESP(I)
SSR = SSR + RES(I)*RES(I) AUX1 = DABS(RES(I))
SAV = SAV + AUX1
CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC, TEST,N,M,NP,
Bl,FUN,2)
iyi iis; T —1 MP
115
401
615
620
SAV = SAV + AUX1
CONTINUE
ENDIF
SSR= SSR/(FII*NP)
SAV = SAV/(FII*NP)
IF (SSR.GT.SSROLD) THEN
MMM - 1
MM = MM + 1
WRITE(*,*) 'SOMA POR RESIDUO'
IF (MM.GT.10) THEN
WRITE(*,*) 'FALHA POR RESIDUO'
GO TO 401
ENDIF
GO TO 710
ENDIF
WRITE(8,615) ITER,SSR*14.7*14.7,SAV*14.7,0.0,
*	ESTK*1.D+3,ESTS,ESTC*4.2784409E”7,MM+1
FORMAT(IX,13,6(IX,Ell.5),1X,I2)
IF (MMM.NE.0) THEN
RLAM = REAM*10.DO
ELSE
RLAM « RLAM/10.DO
ENDIF
TOLK « DABS(DELK/OESTK)
TOLS = DABS(DELS/OESTS)
TOLC = DABS(DELC/OESTC)
WRITE(*,600) ITER
WRITE(*,*) SSROLD*216.09,SSR*216.09
WRITE(*,610) DELK*1.D3,DELS,DELC*4.2784409E-7
WRITE(*,610) ESTK*1.D3,ESTS,ESTC*4.2784409E-7 OESTK - ESTK
OESTS = ESTS
OESTC » ESTC
SSROLD = SSR
PAUSE
ENDDO
IF (IOPT.EQ.1) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,
*	TEST,N,M,NP,
*	B,RES,2)
DO 620 I = 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7DO,FUN(I)*14.7 DO,
*	DP(I)*14.7DO,RES(I)*14.7D0
CONTINUE
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,
*	TEST,N,M,NP,
*	B,RES,1)
DO 635 I - 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,
*	DP(I)*14.7D0,FUN(I)*14.7D0
ITER
SSR*216.09,SAV*14.7
ESTK*1.D3,DELK,ESTS,DELS,
ESTC*4.2784409E-7,DELC
600
610
645
650
660
WRITE(*,600)
WRITE(*,650)
WRITE(*,660)
*
WRITE(9,*)
IF(IOPT.EQ.l) THEN
WRITE(9,*) ’REGRESSÃO
ELSE IF(IOPT.EQ.2) THEN
WRITE(9,*) 'REGRESSÃO
ELSE
WRITE(9,*) 'REGRESSÃO
ENDIF
WRITE(9,600) ITER
WRITE(9,650) SSR*216.09,SAV*14.7
WRITE(9,660) ESTK*1.D3,DELK,ESTS,DELS,ESTC*4.2784409E-7, DELC FORMAT(/,IX,'N. ITERACOES =',I4)
FORMAT(1X,'K = ',F15.6/IX,'S = ',F15.6/IX,'C = ',E15.6) FORMAT(IX,5(E15.7)) FORMAT(IX,'SSR
*	IX,'SAV FORMAT(IX,'K »
*
*
END
**********************************************************************
NOS	DADOS	DE
NOS	DADOS	DA
NOS	DADOS	DA
PRESSÃO,'
PRESSÃO E DA DERIVADA.'
IX,'S = IX,'C =
=',F15.5,2x,/
=',F15.5,2x,) ,F15.6,' ,F15.6,' ,E15.6,'
+/~',F6.2t' %'/ +/-'tF&amp;amp;t2,' %*/ +/-',F6.2,' %')
&gt; t
SUBROUTINE LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	ESTK,ESTS,ESTC,
*	TEST,N,M,NP,
*	B,FUN,IOPT)
IMPLICIT REAL * 8 (A-H,O-Z)
PARAMETER (NPON=150,NPAR=3)
DIMENSION G(50), H(25),TEST(NPON),B(NPON,NPÃR),FUN(NPON) COMMON /STE/ V(50)
DLOGTW = 0.69314718056D0
PI = 4.DO*DATAN(1.DO)
IF (N .EQ, M) GOTO 17
M = N
NH - N/2
C	FATORIAIS FICAM EM G
G(l) - 1.D0 DO 1 I = 2, N
G(I) = G(I-l) * I
1	CONTINUE
H(l) = 2.DO / G(NH-l)
DO 6 I = 2, NH
FI = I
IF (I-NH) 4,5,6
4	H(I) = FI**NH*G(2*I)/(G(NH-T)*G(I)*G(I-1)) GOTO 6
5	H(I) - FI**NH*G(2*1)/(G(I)*G(1-1))
6	CONTINUE
SN = 2*(NH-NH/2*2)-1
DO 7 I = 1, N
V(I) = 0.D0
Kl - (I+1J/2
9
8
12
11
13
14
10
7
17
15
500
IF(I-K) 11,14,11
V(I) = V(I) + H(K)/(G(I~K)*G(2*K~I))
GOTO 10
V(I) = V(I) + H(K)/G(I-K)
GOTO 10
V(I) = V(I) + H(K) / G(2*K - I)
CONTINUE
V(I) « SN*V(I)
SN = -SN
CONTINUE
CONTINUE
Cl = DSQRT(RESPHI*RESVIS*RESCT)*RESRW
C2 = 2.D0*PI*RESH/RESVIS
TEMPS = DSQRT(ESTK)
DO 500 J = 1,NP
B(J,1) = 0.D0
B(J,2) = 0*D0
B(J,3) « 0.D0
FUN(J) = 0.00
A « DLOGTW / TEST(J)
DO 15 I = 1, N
ARG « A*I
IF(IOPT*EQ.1) THEN
AL = 1.0D0
ELSE
AL = ARG
ENDIF
TEMPS = DSQRT(ARG)
TEMPI = C1*TEMP5/TEMP6
TEMP2 = BESSKO(TEMPI)
TEMP3 = BESSK1(TEMPI)
TEMP4 = -(TEMP3/TEMP1+TEMP2)
AUX1 = C1*C2*TEMP5*TEMP6*TEMP3
AUX2 ® TEMP2 + ESTS*TEMP1*TEMP3
AUX3 = (AUX1/AUX2 + ESTC*ARG)**2
AUX4 = TEMP6*TEMP3 - C1*TEMP5*TEMP4
AUX4 = AUX4*C1*C2*TEMP5/(2.DO*ESTK)
AUX5 = TEMP6*TEMP3 + C1*TEMP5*TEMP4
AUX5 - ESTS*AUX5/ESTK**2
AUX5 = TEMP3/(ESTK*TEMP6) - AUX5
AUX5 = Cl*TEMP5*AUX5/2.DO
B(J,1) = B(J,1) ~ V (I) *AL* (RESQ/ARG) * (AUX4*AUX2-AUX1*AUX5) /
*	(AUX3*AUX2**2)
B(J,2) = B(J,2) + V(I)*AL*RESQ*C1**2*C2*TEMP3**2/
*	(AUX3*AUX2**2)
B(J,3) = B(J,3) ~ V(I)*AL*RESQ/AUX3
FUN(J) = FUN (J) + V(I) *AL*RESQ/(ARG*(AUX1/AUX2 + ESTC*ARG) ) CONTINUE
IF (I0PT.EQ.1) THEN
B(J,1)	-	B(J,1)	*	A
B(J,2)	«	B(J,2)	*	A
ENDIF
CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE DPDT(TEST,TESP,NP,DP)
IMPLICIT REAL * 8 (A-H,O-Z)
DIMENSION TEST(l),TESP(I),DP(1)
1 = 2
AUX = DLOGIO(TEST(I)/TEST(1))
DO WHILE (AUX.LT.0.1500)
I = I 4- 1
AUX = DLOGIO(TEST(IJ/TEST(1))
ENDDO
AUX2 = TEST(I) - TEST(l)
AUX4 = TESP(I) - TESP(l)
DP(1) = TEST(1)*AUX4/AUX2
DO 100 I=2,NP-1
J = I + 1
AUX = DLOGIO(TEST(J)/TEST(I))
DO WHILE (AUX.LT.O.15D0.AND.J.LT.NP)
J = J 4- 1
AUX = DLOGIO(TEST(J)/TEST(I))
ENDDO
AUX2 = TEST(J) - TEST(I)
AUX4 = TESP(J) - TESP(I)
J = I - 1
AUX = DLOGIO(TEST(I)/TEST(J))
DO WHILE (AUX.LT.0.15D0.AND.J.GT.1)
J = J - 1
AUX = DLOGIO(TEST(I)/TEST(J)) ENDDO
AUX1 = TEST(I) - TEST(J)
AUX3 = TESP(I) - TESP(J)
DP(I) = ( AUX2*AUX3/AUX1 4- AUX1*AUX4/AUX2 )/(AUXl 4- AUX2) DP(I) “ TEST(I)*DP(I)
100 CONTINUE
DP(NP) = DP(NP-l)
RETURN
END
C***********************************************************************
SUBROUTINE GAUSS(A,X,N)
PARAMETER (NPAR=3)
INTEGER*4 N
REAL*8 A (NPAR, NPAR4-1) , X (NPAR)
CALL DIAGONAL(A,N)
CALL RESOLVE(A,X,N)
RETURN
END
**********************************************************************
SUBROUTINE DIAGONAL(A,N)
PARAMETER (NPAR=3)
INTEGER*4 N,NI,NJ,IAUX,II
REAL*8 A(NPAR,NPAR4-1) ,AUX(NPAR4-1) ,M
DO 600 NI=1,N
XX = A(NI,NI)
DO 200 II = NI4-1,N
IF (DABS(A(II,NI)).GT.DABS(A(NI,NI))) THEN
DO 100 IAUX=NI,N4-1
AUX(IAUX) = A(NI,IAUX)
A(NI,IAUX) = A (II,IAUX)
A(II,IAUX) = AUX(IAUX)
100	CONTINUE
ENDIF
200	CONTINUE
IF (A(NI,NI).EQ.O.DO) THEN
WRITE(6,3OO)
300	FORMAT(//IX,'SISTEMA SEM SOLUCAO'//)
STOP
ENDIF
DO 500 IAUX » NI+1,N
IF (A(IAUX,NI).NE.O.DO) THEN
M = A(IAUX,NI)/A(NI,NI)
DO 400 NJ = 1,N+1
A(IAUX,NJ) = A(IAUX,NJ) - M*A(NI,NJ)
400	CONTINUE
ENDIF
500	CONTINUE
600 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE RESOLVE(A,X,N)
PARAMETER (NPAR-3)
INTEGER*4 N,NI,NJ
REAL*8 A(NPAR,NPAR+1),X(NPAR),AUX
X(N) = A(N,N+1)/A(N,N)
DO 200 NI=N“1,1,-1
AUX - 0.D0
DO 100 NJ=NI+1,N
AUX = AUX + A(NI,NJ)*X(NJ)
100	CONTINUE
X(NI) = ( A(NI,N+1) - AUX )/A(NI,NI)
200 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE MATINV (A,AINV,NN)
PARAMETER (NPAR-3)
REAL*8 A(NPAR,NPAR+l), Al NV (NPAR, NPAR),AUX(NPAR*NPAR,NPAR*NPAR+1)
REAL*8 B(NPAR*NPAR),C(NPAR*NPAR)
INTEGER*4 NN
N = NPAR
DO 100 1=1,N*N
B(I) = 0.D0
100 CONTINUE
DO 110 I=1,NN*NN,NN+1
B(I) = 1.D0
110 CONTINUE
DO 130 1=1,N*N
DO 120 J = 1,N*N+1
AUX(I,J) = 0.D0
120	CONTINUE
130 CONTINUE
DO 150 I = 1,NN
DO 140 J « 1,NN
DO 135 K = 1,NN
AUX(I+(K-1)*NN,J+(K-1)*NN) » A(I,J)
135	CONTINUE
140	CONTINUE
150 CONTINUE
DO 160 I = 1,NN*NN
AUX(I,NN*NN+1) = B(I)
160 CONTINUE
CALL GAUSS(AUX,C,NN*NN)
K « 1
DO 175 J = 1,NN
DO 170 I - 1,NN
AINV(I,J) = C(K)
K ” K + 1
170	CONTINUE
175 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE INTERV(A,DEL,WSSR,NP)
PARAMETER (NPAR=3,NPON-150)
IMPLICIT REAL*8 (A-H,O-Z)
DIMENSION A(NPAR,NPAR+1),DEL(NPAR),AINV(NPAR,NPAR)
CALL MATINV (A,AINV,NPAR)
TDIS = TDISTR(NP-NPAR)
DO 100 1=1,NPAR
DEL(I) = TDIS*DSQRT(NP*WSSR*AINV(I,I)/(NP-NPAR))
100 CONTINUE
RETURN
END
**********************************************************************
FUNCTION TDISTR(NDF)
IMPLICIT REAL*8 (A-H,O-Z)
DIMENSION TABLE(50)
DATA TABLE / 12.706,4.303,3.182,2.776,2.571,2.447,2.365,
*	2.306,2.262,2.228,2.201,2.179,2.160,2.145,
*	2.131,2.120,2.110,2.101,2.093,2.086,2.080,
*	2.074,2.069,2.064,2.060,2.056,2.052,2.048,
*	2.045,2.042,2.040,2.037,2.035,2.032,2.030,
*	2.028,2.026,2.024,2.023,2.021,2.020,2.018,
*	2.017,2.015,2.014,2.013,2.012,2.011,2.010,
*	2.009/
IF (NDF.LE.50) THEN
TDISTR = TABLE(NDF)
ELSEIF(NDF.LE.6O) THEN
TDISTR = 2.009
ELSEIF(NDF.LE.SO) THEN
TDISTR = 2.000
ELSEIF(NDF.LE.120) THEN
TDISTR « 1.990
ELSEIF(NDF.LE.240) THEN
TDISTR = 1.980
ELSE
TDISTR = 1.970
ENDIF
RETURN
END
**********************************************************************
DOUBLE PRECISION FUNCTION BESSKO(X)
IMPLICIT REAL*8 (A-H,O-2)
DATA P1,P2,P3,P4,P5,P6,P7/-0.57721566D0,0.42278420D0,0.23069756DO,
*	0.3488590D-1,0.262698D-2,0.10750D-3,0.74D-5/
DATA 01,02,03,04,05,06,07/1.2533141400,-0.78323580-1,0.21895680-1,
*	-0.1062446D-1,0.587872D-2,-0.2515400-2,0.53208D-3/
BESSKO=(-DLOG(X/2.0) *BESSI0 (X) ) 4- (Pl+Y* (P2+Y* (P3 +
*	Y*(P4+Y*(P5+Y*(P6+Y*P7))))))
ELSE
Y=(2.0/X)
BESSK0=(DEXP(-X)/DSQRT(X))*(Ql+Y*(Q2+Y*(Q3+
*	Y* (Q4+Y*(Q5+Y*(Q6+Y*Q7))))))
ENDIF
RETURN
END
C***********************************************************************
DOUBLE PRECISION FUNCTION BESSKl(X)
IMPLICIT REAL*8 (A-H,O~Z)
DATA Pl(P2fP3,P4,P5,P6,P7/1.ODO,0.1544314400,-0.67278579D0f
*	-0.18156897D0,-0.19194020-1,-0.1104040-2,-0.46860-4/
DATA QI, Q2,Q3,Q4,Q5,Q6,Q7/1.25331414D0,0.2349861900,-0.3655620D-1,
*	0.1504268D-1,-0.780353D-2,0.3256140-2,-0.682450-3/
IF (X.LE.2.0) THEN
¥=X*X/4.0
BESSK1=(DLOG(X/2.0)*BESSI1(X)) + (1.0/X)*(Pl+Y*(P2+
*	Y* (P3+Y* (P4+Y* (P5+Y* (P6+Y*P7) ) ) ) ) )
ELSE
Y-2.0/X
BESSK1=(DEXP(-X)/DSQRT(X))*(Ql+Y*(Q2+Y*(Q3 +
*	Y*(Q4+Y*(Q5+Y*(Q6+Y*Q7))))))
ENDIF
RETURN
END
C***********************************************************************
DOUBLE PRECISION FUNCTION BESSIO(X)
IMPLICIT REAL*8 (A-H,O-Z)
DATA Pl,P2,P3,P4,P5,P6,P7/1.ODO,3.515622900,3.089942400,1.20674920
*0,
*	0.265973200,0.3607680-1,0.458130-2/
DATA QI,Q2,Q3,Q4,Q5,Q6,Q7,Q8,Q9/0.3989422800,0.13285920-1,
*	0.225319D-2,-0.157565D-2,0.9162810-2,-0.2057706D-1,
*	0.26355370-1,-0.16476330-1,0.3923770-2/
IF (DABS(X).LT.3.75) THEN
Y=(X/3.75)**2
BESSIO=P1+Y*(P2+Y*(P3+Y*(P4+Y*(P5+Y*(P6+Y*P7)))))
ELSE
AX-DABS(X)
¥=3.75/AX
BESSIO=(DEXP(AX)/DSQRT(AX))*(Ql+Y*(Q2+Y*(Q3+Y*(Q4
*	+Y*(Q5+Y*(Q6+Y*(Q7+Y*(Q8+Y*Q9))))))))
ENDIF
RETURN
END
C***********************************************************************
DOUBLE PRECISION FUNCTION BESSIl(X)
IMPLICIT REAL*3 (A-H,O-Z)
DATA Pl,P2,P3,P4,P5,P6,P7/0.500,0.8789059400,0.51498869D0,
*	0.1508493400,0.26587330-1,0.3015320-2,0.324110-3/
DATA QI,Q2,Q3,Q4,Q5,Q6,Q7,Q8,Q9/0.3989422800,-0.39880240-1,
*	-0.3620180-2,0.1638010-2,-0.10315550-1,0.2282967D-1,
*	-0.28953120-1,0.17876540-1,-0.420059D-2/
¥=3.75/AX
BESSI1=(DEXP(AX)/DSQRT(AX))*(Ql+Y*(Q2+Y*(Q3+Y*(Q4+ *	Y*(Q5+Y*(Q6+Y*(Q7+Y*(Q8+Y*Q9))))))))
ENDIF
RETURN
END
PROGRAMA PR0G4.F0R ******* as rotinas laplace, gauss e interv e as funcoes de Bessel******* sao as mesmas do programa PRGO1.FOR *******
C********************í***************************ii*********i****i*ii*** c****
C * *r * *
c****
C*»***********************************ik*****i*********i****************i
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NPON»150,NPAR==3)
CHARACTER*12 ARQUIVO
DIMENSION TESP(NPON) ,TEST(NPON) , B(NPON, NPAR) , FUN(NPON) , RES (2*NPON)
DIMENSION A(NPAR,NPAR+1) ,DELTA(NPAR),PEN(NPAR) , PESO (2*NP0N) ,
*	AS(NPAR,NPAR+1) , DP(NPON) , BI (NPON, NPAR)
COMMON /STE/ V(50) CON1 = 1000.
CON2 = 4.2784409E-7
CON3 =14.7
C0N4 = 216.09
DADOS DE RESERVATÓRIO
c c
H(PES), VIS(CP), PHI(PURO), CT(PSI-l), Q(STB/D), BO(BBL/STB), RW(POL)
ARQUIVO DE DADOS.'
10 c
20
20D
201
C
c
c
300
WRITE(*,*) 'ENTRE COM O
READ(*,*) ARQUIVO
OPEN (4,FILE=ARQUIVO,STATUS»'UNKNOWN')
OPEN(7 , FILE='SAIMLAV.DAT',STATUS»'UNKNOWN') OPEN (8,FILE»'LIXO.DAT',STATUS»'UNKNOWN') OPEN(9,FILE»'RESMLAV.DAT',STATUS»'UNKNOWN') READ (4,10) RESH, RESVIS, RESPHI, RESCT,RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5) NUMERO DE PONTOS
READ(4,20) NP FORMAT(T32,13) DO 200 I = 1,NP
READ(4,*) TEST(I),TESP(I) CONTINUE
IF (TPROD.NE.0.DO) THEN
DO 201 1=1,NP
TEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)
CONTINUE
ENDIF VARIAVEIS DE CONTROLE PARA O ALGORITMO DE STHEFEST COM 8 CTES M = 0 N » 8 CONSTANTE INICIAL PARA 0 ALGORITMO DE GAUSS-MARQUARDT REAM = 0.1D0
TRANSFORMACOES DE UNIDADE
RESCT = RESCT*14.7D0 RESQ = RESQ*RESBO*1,84D0 RESRW = RESRW*2.54D0 RESH = RESH*30.48D0 DO 300 I «
TEST(I)
TESP(I) CONTINUE WRITE(6,*) WRITE(6,*) WRITE(6,*) WRITE(6,*)
READ(5,*) I OPT CALL DPDT(TEST,TESP,NP,DP) LENDO AS ESTIMATIVAS INICIAIS WRITE(6,100)
FORMAT(IX,'ENTRE COM OS VALORES INICIAIS DE K(D) , S E C(CM3/ATM)')
1,NP
= TEST(I)*3.6D3 - TESP(I)/14.7D0
'QUAL A FUNCAO A SER MINIMIZAR ?' '1 - PRESSÃO.'
'2 - DERIVADA.'
'3 - DERIVADA+PRESSÃO.'
c
110
400
410
420
READ(5,*) OESTK,OESTS,OESTC
WRITE(8,*)
WRITE(8,*) 'ARQUIVO :',ARQUIVO
WRITE(8,*)
WRITE(8,*) 'METODO DE MINIMOS VALORES ABSOLUTOS MODIFICADO.' WRITE(8,*)
WRITE(8 f110) C0N1*OESTK,OESTS,C0N2*0ESTC
WRITE(9,110) CONI*0ESTK,OESTS,C0N2*0ESTC
FORMAT(3X,'ESTIMATIVAS INICIAIS'//
*	IX,'K “',F10.5/
*	IX,'S =*,F10.5/
*	IX,'C ~',E10.3)
SAVOLD - 0.D0
SSR = O.DO
DO 400 I = 1,2*NP
PESO(I) = O.DO
CONTINUE
IF (I0PT.NE.3) THEN
FIX - 1.0D0
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST, N,M,NP,B,FUN,IOPT)
IF(IOPT.EQ.l) THEN
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) ELSE
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) ENDIF
CALL CALCPESO(RES,PESO,NP,0)
ELSE
FII = 2
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0)
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,NP)
CALL CALCPESO(RES,PESO,NP,0)
CALL CALCPESO(RES,PESO,NP,NP)
ENDIF
SSR = SSR/(FII*NP)
SAVOLD = SAVOLD/(FII*NP)
WSSROLD = SAVOLD
WRITE(9,615) 0,C0N4*SSR,CON3*SAVOLD,0.0,CONI*0ESTK,OESTS,
*	C0N2*0ESTC,0
ITMAX = 101
TOL = l.D-4
ITER = 1
TOLK -l.DO
TOLS ® l.DO
TOLC - l.DO
TOLR = l.DO
MM = 0
DO WHILE((TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL.OR.
*	TOLR.GT.TOL).AND.ITER.LT.ITMAX,AND.MM.LT.10)
DO 420 I = 1,NPAR
DO 410 J = 1,NPAR+1
A(I,J) » O.DO
CONTINUE
CONTINUE
DO 500 K = 1,NP
DO 440 I » 1,NPAR
430
440
500
505
C
C
c c
510
520 C
560
570
550
710
A(I,NPAR+1) = A(I,NPAR+1) + PESO(K)*RES(K)*B(K,I)
IF (IOPT.EQ.3)
A(I,NPAR+1) = A(I,NPAR+1) +
PESO(K+NP)*RES(K+NP)*B1(K, I) CONTINUE
CONTINUE
DO 505 I « 1,NPAR
A(I,NPAR+1) = -A(I,NPAR+1)
CONTINUE
INCLUINDO AS FUNCOES PENALIDADES
K &gt; 0
-7 &amp;lt;S &amp;lt;20
C &gt; 0
PEN(l) = 2.D-5/OESTK**3
PEN(2) = l.D-2*( DEXP(-0ESTS-7,D0) + DEXP(OESTS ~ 2.Dl) )
PEN(3) = 2.D1/OESTC**3
DO 510 I = 1,NPAR
PEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO
Afljl) = A(I,I) + PEN(I)
CONTINUE
PEN(l) = l.D-5/OESTK**2
PEN(2) « l.D~2*( DEXP(-OESTS-7.DO) - DEXP(OESTS - 2.Dl) )
PEN(3) = l.Dl/OESTC**2
DO 520 I = 1,NPAR
PEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO
A(I,NPAR+1) = AfljNPAR+l) + PEN(I)
CONTINUE
ESCALONANDO A MATRIZ A
DO 570 I=1,NPAR
DO 560 J « 1'NPAR
AS(IfJ) = A(I,J)/DSQRT(A(I,I)*A(J,J))
CONTINUE
AS(I,NPAR+1) = A(I,NPAR+1)/DSQRT(A(I,I))
CONTINUE
DO 550 I = 1,NPAR
AS(I,I) = AS (I, I) +RLAM
CONTINUE
CALL GAUSS(AS,DELTA,NPAR)
DELK = DELTA(l)/DSQRT (A(l,l))
DELS = DÊLTA(2)/DSQRT(A(2,2))
DELC = DELTA(3)/DSQRT(A(3,3))
MM = 0
RO = 0.5D0**MM
ESTK » OESTK + RO*DELK
ESTS = OESTS + RO*DELS
ESTC = OESTC + RO*DELC
IF(ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN
MM = MM + 1
WRITE(*,*) 'SOMA EM MM POR LIMITE'
IF (MM.GT.I0) THEN
WRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402
ENDIF
GO TO 710
ENDIF
403
605
IF (ESTS.LT.0.DO) THEN
RESRWE = RESRW*DEXP(-ESTS)
SKIN = O.DO
ELSE
RESRWE = RESRW
SKIN = ESTS
ENDIF
SAV = O.DO
SSR = O.DO
WSSR = O.DO
IF (IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)
IF(IOPT.EQ.1) THEN
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) pr Ct?
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,0)
ENDIF
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0)
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN, 2)
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)
ENDIF
SSR » SSR/(FII*NP)
WSSR = WSSR/(FII*NP)
SAV = SAV/(FII*NP)
IF (SAV.GT.SAVOLD) THEN
MM = MM + 1
WRITE(*,*) 'SOMA EM MM POR RESIDUO'
IF (MM.GT.10) THEN
WRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-RESIDUO'
GO TO 403
ENDIF
GO TO 710
ENDIF
IF(IOPT.NE.3) THEN
CALL CALCPESO(RES,PESO,NP,0)
ELSE
CALL CALCPESO(RES,PESO,NP,0)
CALL CALCPESO(RES,PESO,NP,NP)
ENDIF
IF (WSSR.GT.WSSROLD) THEN
RLAM = RLAM*10.DO
ELSE
RLAM = RLAM/10.DO
ENDIF
WRITE(*,600) ITER
WRITE(*,605) CON3*SAVOLD,CON3*SAV,CON3*WSSR,CON4*SSR
FORMAT(T10,'SAVOLD',T24,'SAV',T38,'WSSR',T52,'SSR'/
*	4(2X,F12.4))
WRITE(9,615) ITER,CON4*SSR,CON3*SAV,0.0,
*	CON1*ESTK,ESTS,CON2 *ESTC,MM+1
C
WSSROLD = WSSR
SAVOLD = SAV
OESTK = ESTK
OESTS - ESTS
OESTC = ESTC
WRITE(*,610) CON1*ESTK,ESTS,CON2*ESTC
PAUSE
210
220
600
610
645
650
660
ITER = ITER + 1
ENDDO
ITER = ITER - 1
IF (I0PT.EQ.1) THEN
CALL LAPLACE (RESPHI, RESVIS, RESCT, RESRWE, RESH, RESQ,
*	ESTK,SKIN,ESTC,
*	TEST,N,M,NP,
*	B,RES,2)
DO 210 I = 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,
*	DP(I)*14.7D0,RES(I)*14.7D0
CONTINUE
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,
*	TEST,N,M,NP,
*	B,RES,1)
DO 220 I = 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,
*	DP(I)*14.7D0,FUN(I)*14.7D0
CONTINUE
ENDIF
Nil =
CALL '
DELK ■■
DELS
DELC ;
WRITE(8,*)
IF(IOPT.EQ.l) THEN
WRITE( 8, *)	"REGRESSAO
ELSE IF(IOPT.EQ.2) THEN
WRITE(8,*) "REGRESSAO ELSE
WRITE(8,*) ’REGRESSAO ENDIF
WRITE(8,600)
WRITE(8,650)
WRITE(8,660)
WRITE(*,600)
WRITE(*,650)
WRITE(*,660)
FORMAT(/,IX,"N
FORMAT(1X,'K = ",F15.6/1X,
FORMAT(IX,5(E15.7))
FORMAT(IX,"WSSR
*	IX,"SSR
*	IX,"SAV FORMAT(IX,"K =
*
*
= FII*NP
INTERV (A,DELTA,WSSR,Nil) = 100.D0*DELTA(1)/ESTK = 100.D0*DELTA(2)/ESTS = 100.D0*DELTA(3)/ESTC
NOS	DADOS	DE
NOS	DADOS	DA
NOS	DADOS	DA
PRESSAO.'
PRESSAO E DA DERIVADA."
DERIVADA DA PRESSAO."
ITER
CON3*WSSR,COM4*SSR,CON3 *SAV
CON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC ITER
CON3 *WSSR,CON4 *SSR,CON3 *SAV
CONI*ESTK,DELK,ESTS,DELS,C0N2*ESTC,DELC ITERACOES =",I4)
",F15.6/1X,"C = ",E15.6)
z
IX,"S = "
IX,"C = '
,F15.5,2X,/
,F15.5,2x,/ ,F15.5,2x,) ,F15.6,"	+/-',
,F15.6,"	+/-",
,E15,6,"	+/-S
_. i
"S =
= 1
r
END
**********************************************************************
SUBROUTINE CALCPESO(RES,PESO,NP,IN)
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NPO.N=150)
DIMENSION RES(l),PESO(I)
DO .100 1=1, N.P
AUX = DABS(RES(I+IN))
IF(AUX.LT.l.D-9) THEN
PESO(I+IN) = 0»D0
ELSE
PESO(I+IN) = 1.DO/AUX
ENDIF
100 CONTINUE
RETURN
END
*****iii*'tii*il****ii**i**i***************ii*i**i****ii****i[***i*****iHt*
SUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,IN) IMPLICIT REAL*8 (A-HfO~Z)
PARAMETER (NPON=150)
DIMENSION FUN(l),TESP(1),RES(1),PESO(1)
DO 100 1=1,NP
RES(I+IN) = FUN(I) - TESP(I)
SSR = SSR + RES(I+IN)*RES(I+IN)
WSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)
SAV = SAV + DABS(RES(I+IN))
100 CONTINUE
RETURN
END
**********************************************************************
c c
C
10 c
20
200
201
C
c
Regressão nao linear com minimos quadrados utilizando o método de Gauss para um modelo de reservatório radial infinito
Utiliza a rotima RLLAV da biblioteca IMSL.
in * it it k k * ******* ******* ******* ******* *******
IMPLICIT REAL*8 (A~H,O~Z)
PARAMETER (NPON=150,NPAR=3)
DIMENSION X¥ (2*NPON, NPAR+5) , BETA(NPAR) ,WK(2*NPAR+4) ,IWK(2*NPON)
DIMENSION TESP(NPON) ,TEST(NPON) ,B(NPON,NPAR) ,FUN(NPON) ,DP(NPON) , *	PESO(2*NPON) , A (NPAR, NPAR+1) ,RES(2*NPON) ,Bl(NPON,NPAR)
CHARACTER*12 ARQUIVO
COMMON /STE/ V(50)
CONI = 1000.
CON2 = 4.2784409E-7
CON3 =14.7
CON4 = 216.09
DADOS DE RESERVATORIO
H(PES), VIS(CP), PHI(PURO), CT(PSI-l), Q(STB/D) , BO(BBL/STB), RW (POL) ARQUIVO DE DADOS.•
WRITEf*,*) 'ENTRE COM O
READ(*,*) ARQUIVO
OPEN(4 tFILE=ARQUIVO,STATUS='UNKNOWN')
OPEN(7 ,FILE=•SAILAV.DAT',STATUS='UNKNOWN')
OPEN(8,FILE='LIXO.DAT',STATUS='UNKNOWN')
OPEN(9,FILE='RESLAV.DAT',STATUS^'UNKNOWN')
PARAMETROS DE RESERVATORIO
READ(4,10) RESH,RESVIS,RESPHI,RESCT,RESRW,RESQ,RESBO,TPROD FORMAT(T25,FIO.5)
NUMERO DE PONTOS
READ(4,20) NP
FORMAT(T32,13)
DO 200 I = 1, NP
READ(4,*) TEST(I),TESP(I)
CONTINUE
IF (TPROD.NE.0.DO) THEN
DO 201 1=1,NP
TEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)
CONTINUE
ENDIF
VARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES
M = 0
N = 8
TRANSFORMADOES DE UNIDADE
RESCT
RESQ =
RESRW
RESH ;
DO 300 I =
TEST(I)
TESP(I)
CONTINUE
WRITE(6,*)
WRITE(6,*)
WRITE(6,*)
WRITE(6,*)
READ(5,*)
; RESCT*14.7D0
RESQ*RESBO*1.84D0
RESRW*2.54D0
RESH*30.48D0
1,NP
= TEST(I)*3.6D3 = TESP(I)/14.7D0
c
WRITE(8,*) 'ARQUIVO ARQUIVO
WRITE(8,*)
WRITE(8,*) 'METODO DE MINIMOS VALORES ABSOLUTOS.'
WRITE(8,*)
WRITE(8 ,110) CON1*OESTK,OESTS,CON2*OESTC
WRITE(9,110) CON1*OESTK,OESTS,CON3 *OESTC
110 F0RMAT(3X,'ESTIMATIVAS INICIAIS'//
*	IX,'K	=',F10.5/
*	IX,'S	=',F10.5/
*	IX,'C	=',E10.3)
SAVOLD = 0.D0
WSSROLD = 0.D0
SSR = O.DO
DO 400 I = 1,2*NP PESO(I) = O.DO
400 CONTINUE
IF(IOPT.NE.3) THEN
FII =1.0
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,IOPT) IF(IOPT.EQ.1) THEN
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0 ) ELSE
CALL RESIDUO(FUN,DP,RES,PESO, SSR,WSSROLD,SAVOLD,NP,0 ) ENDIF
CALL CALCPESO(RES,PESO,NP,0)
ELSE
FII =2.0
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,0) CALL CALCPESO(RES,PESO,NP,0) CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSROLD,SAVOLD,NP,NP) CALL CALCPESO(RES,PESO,NP,NP)
ENDIF
SSR = SSR/(FII*NP)
SAVOLD = SAVOLD/(FII*NP)
WRITE(9,615) 0,CON4*SSR,CON3*SAVOLD,0.0,
*	CON1*OESTK,OESTS,CON2*OESTC,0
ITMAX = 101
TOL = l.D-3
ITER = 1
TOLK = 1.D0
TOLS = 1.D0
TOLC = 1.D0
DO 130 I = 1,FII*NP DO 120 J = l,NPAR+5
XY(I,J) - O.DO
120	CONTINUE
130 CONTINUE
MM = 0
DO WHILEf(TOLK.GT.TOL.OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.
*	ITMAX.AND.MM.LT.10)
405
410
411
420
430
440
500
710
402
DO 410 K = 1,NP
DO 405 I = 1,NPAR
XY(K,I) = B(K,I)
IF (I0PT.EQ.3) XY(K+NP,I) = B1(K,I)
CONTINUE
XY(K,NPAR+1) = RES(K)
IF (IOPT.EQ.3) XV(K+NP,NPAR+1) = RES(K+NP) CONTINUE
NII = FII*NP
CALE RLLAV (XY,2*NPON, NI I,NPAR,1,BETA,SUMRE,11,IRANK,IWK,
*	WK,IER)
DELE = BETA(l)
DELS = BETA(2)
DELC = BETA(3)
DO 420 I = lfNPAR
DO 411 J = 1,NPAR+1
A(I,J) = 0.D0
CONTINUE
CONTINUE
DO 500 K = 1,NP
DO 440 I = 1,NPAR
DO 430 J = 1,NPAR A(I,J) = A(I,J) + PESO(K)*B(K,I)*B(K,J) IF(IOPT,EQ.3)
*	A(I,J) = A(I,J) + PESO(K+NP)*B1(K,I)*B1(K,J) CONTINUE
CONTINUE
CONTINUE
MM = 0
RO = 0.5D0**MM
ESTK = OESTE + ROLDELE
ESTS = OESTS + RO*DELS
ESTC = OESTC + RO*DELC
IF(ESTK.LE.0.DO.OR.ESTC. LT. O . DO) THEN
MM = MM + 1
WRITEf*,*) 'SOMA EM MM POR LIMITE'
IF (MM.GE.10) THEN
WRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402
ENDIF
GO TO 710
ENDIF
IF (ESTS.LT.0.DO) THEN
RESRWE = RESRW*DEXP(-ESTS)
SKIN - 0.D0
I?T CD
Xí&gt;-Ljo Je*
RESRWE = RESRW
SKIN = ESTS
ENDIF
SSR = 0.D0
SAV = O.DO
WSSR = 0.DO
IF{IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)
IF(IOPT,EQ.1) THEN
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) ELSE
403
605
615
210
ELSE
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0)
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)
ENDIF
SSR = SSR/(FII*NP)
WSSR « WSSR/(FII*NP)
SAV = SAV/(FII*NP)
IF (SAV.GT.SAVOLD) THEN
MM = MM + 1
WRITE(*,*) 'SOMA EM MM POR RESIDUO'
IF (MM.GE.10) THEN
WRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-RESIDUO' GO TO 403
ENDIF
GO TO 710
ENDIF
IF(IOPT.NE.3) THEN
CALL CALCPESO(RES,PESO,NP,0)
ELSE
CALL CALCPESO(RES,PESO,NP,0)
CALL CALCPESO(RES,PESO,NP,NP)
ENDIF
WRITE(*,600) ITER
WRITE(*,605) CON3*SAVOLD,CON3*SAV,CON4*SSR
FORMATfTlO,'SAVOLD',T24,'SAV',T38,'SSR'/
*	4(2X,F12.4))
WRITE(9,615) ITER,CON4 *SSR,CON 3 *SAV,0.0,
*	CON1*ESTK,ESTS,CON2 *ESTC,MM+1
FORMATflX,13,6(IX,Ell.5),IX,12)
SAVOLD = SAV
TOLK = DABS(DELK/OESTK)
TOLS = DABS(DELS/OESTS)
TOLC = DABS(DELC/OESTC)
OESTK = ESTK
OESTS = ESTS
OESTC = ESTC
WRITE(*,610) CON1*ESTK,ESTS,CON2 *ESTC
ITER = ITER + 1
ENDDO
ITER = ITER - 1
IF(IOPT.EQ.1) THEN
CALL * LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,RES,2)
DO 210 I = 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,
*	DP(I)*14.7D0,RES(I)*14.7D0
CONTINUE
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,RES,1)
DO 230 X = 1,NP
WRITE(7,645) TEST(I)/3.6D3,TESP(I)*14.7D0,RES(I)*14.7D0,
*	DP(I)*14.7D0,FUN(I)*14.7D0
600
610
645
650
660
DELK = 10Ü.D0*BETA(l)/ESTK
DELS = 10 0. DCHBETA ( 2) / ESTS
DELS - 100.D0*BETA(3)/ESTC
WRITE(8,*)
IF(IOPT.EQ.l) THEN
WRITE(8,*) 7REGRESSAG
ELSE IF(IOPT.EQ.2) THEN
WRITE(8,*)	7REGRESSÃO
ELSE
WRITE(8,*) 7REGRESSÃO
ENDIF
WRITE(8/600)
WRITE(8,650)
WRITE(8,660)
WRITE(9,600)
WRITE(9,650)
WRITE(9,660)
WRITE(*,600)
WRITE(*,650)
WRITE(*,660)
FORMAT(/,IX,7N. ITERACOES
FORMAT(IX,7K = 7,F15.6/IX,7S
FORMAT(IX,5(E15.7))
FORMAT(IX,7 SSR
*	1X,'SAV
FORMAT(IX, 7K =
*	IX,7S =
*	IX,7c =
END
NOS	DADOS	DE
NOS	DADOS	DA
NOS	DADOS	DA
PRESSÃO.7
PRESSÃO E DA DERIVADA.7
ITER
COM4 *SSR,CON3 *SAV
CON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC
ITER
CON4*SSR,CON3*SAV
CON1*ESTK,DELK,ESTS,DELS,CON2*ESTC,DELC ITER
CON4*SSR,CON3*SAV
CON1*ESTK,DELK,ESTS,DELS,CON2 *ESTC,DELC ,14)
= 7,F15.6/1X,7C = 7,E15.6)
= 7,F15.5,2X,/ =7,F15.5,2X,)
7,F15.6,7
7,F15.6,7
',E15.6,7
+/-7,F6.2,7 V/ +/-írF6,2r' %f/ +/-7,F6.2, 7 V)
**********************************************************************
— /
SUBROUTINE CALCPESO(RES,PESO,NP,IN)
IMPLICIT REAL*8 (A-H,O~Z) DIMENSION RES(1),PESO(1) DO 100 1=1,NP
AUX = DABS(RES(I+IN))
IF(AUX.LT.1.D-9) THEN
PESO(I+IN) = O.DO
ELSE
PESO(I+IN) = 1.D0/AUX
ENDIF
100 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WS SR,SAV,NP,IN) IMPLICIT REAL*8 (A-H,O~Z)
DIMENSION FUN(l),TESP(1),RES(1),PESO(1)
DO 100 1=1,NP
RES(I+IN) = TESP(I) - FUN(I)
SSR = SSR + RES(I+IN)*RES(I+IN)
WSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)
SAV = SAV + DABS(RES(I+IN))
100 CONTINUE
RETURN
END
**********************************************************************
IMPLICIT REAL*8 (A-H,O-Z) PARAMETER (NPON=150,NPAR=3)
CHARACTER*^ ARQUIVO
LOGICAL MUD
DIMENSION XY(2*NPON,NPAR+5) ,BETA(NPAR) ,WK(2*NPAR+4) ,IWK(2*NPON) DIMENSION TESP(NPON) jTESTCNPON) , B(NPON, NPAR) ,FUN(NPON) ,RES(2*NPON) DIMENSION A(NPAR,NPAR+1),DELTA(NPAR),PEN(NPAR),PESO(2*NPON),
*	AS(NPAR,NPAR+1),Bl(NPON,NPAR),DP(NPON)
COMMON /STE/ V(50)
CONI = 1000.
CON2 ~ 4.2784403E-7
COM3 =14.7
CON4 = 216.09
C DADOS DE RESERVATORIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),
C	Q(STB/D), BO(BBL/STB)
WRITE(*,*) 'ENTRE COM 0 ARQUIVO DE DADOS.'
READ(*,*) ARQUIVO
OPEN(4,FILE=ARQUIVO,STATUS=’UNKNOWN')
OPEN(7 , FILE='SAIMLLAV.DAT*,STATUS=*UNKNOWN *)
OPEN(8,FILE= * LIXO.DAT * tSTATUS= * UNKNOWN *)
OPEN(9,FILE= * RESMLLAV.DAT*,STATUS=1 UNKNOWN *)
READ(4,10) RESH,RESVIS , RESPHI,RESCT,RESRW,RESQ,RES BO, TPROD
10	FORMAT(T25,F10.5)
C	NUMERO DE PONTOS
READ(4,20) NP
20	FORMAT(T32,13)
DO 200 I = 1,NP
READ(4,*) TEST(I),TESP(I)
200	CONTINUE
IF (TPROD.NE.0.DO) THEN
DO 201 I = 1,NP
TEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)
201	CONTINUE
END IF
C	VARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES
M = 0
N = 8
C	CONSTANTS INICIAL PARA 0 ALGORITMO DE GAUSS-MARQUARDT
RLAM = 0.1D0
C	ZERANDO A MATRIZ AUXILIAR PARA O METODO LAV
DO 130 I = 1,NP
DO 120 J = l,NPAR+5 XY(I,J) = 0.D0
120	CONTINUE
130 CONTINUE
C VARIAVEL DE CONTROLE PARA MUDANCA DE METODO MUD = .FALSE.
C	TRANSFORMACOES DE UNIDADE
'QUAD A FUNCAO A MINIMIZAR ?'
'1 ~ PRESSAO.'
'2 - DERIVADA.'
'3 - PRESSÃO + DERIVADA.' IOPT
c
100
110
400
CONTINUE
WRITE(6?
WRITE(6,*)
WRITE(6,*)
WRITE(6,*)
READ(5,*)
CALL DPDT(TEST,TESP,NP,DP)
LENDO AS ESTIMATIVAS INICIAIS
WRITE(6,100)
FORMAT(IX,'ENTRE COM OS VALORES INICIAIS DE K(D) , S E C(CM3/ATM)') READ(5,*) OESTK,OESTS,OESTC
WRITE(8,*)
WRITE{8, *) 'ARQUIVO :',ARQUIVO
WRITE(8,*)
WRITE(8,*) 'METODO DE MIN. VAL. ABS. MODIFICADO - MIN. VAL. ABS. ' WRITE(8,*)
WRITE(8,110) CON1*OESTK,OESTS,CON2 *OESTC
WRITE(9,110) CON3*OESTK,OESTS,CON2*OESTC FORMAT(3X,'ESTIMATIVAS INICIAIS'//
*	IX,'K	=',F10,5/
*	IX,'S	=',F10.5/
*	IX,'C	=',E10.3)
SAVOLD = 0.D0
WSSROLD = 0.D0
SSR = 0.DO
DO 400 I = 1,2*NP
PESO(I) = 0.DO
CONTINUE
IF (IOPT.NE.3) THEN
FIX = 1.0
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST, N, M,NP, B,FUN,IOPT)
IF (IOPT.EQ.1) THEN
CALL RESIDUO (FUN, TESP, RES, PESO, SSR, WSSROLD, SAVOLD, NP, 0 )
ELSE
CALL RESIDUO (FUN, DP, RES, PESO, SSR, WSSROLD, SAVOLD, NP, 0)
ENDIF
CALL CALCPESO(RES,PESO,NP,0)
ELSE
FXI ’
CALL
*
CAUL)
CALL
*
: 2.0
LAPLACE (RESPHI , RESVIS, RESCT, RESRW, RESH, RESQ,
OESTK,OESTS,OESTC ,TEST,N,M,NP,B,FUN,1)
RESIDUO (FUN, TESP, RES, PESO, SSR, WSSROLD, S AVOLD, NP, 0) LAPLACE (RESPHI, RESVIS, RESCT, RESRW, RESH , RESQ,
OESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2)
RESIDUO (FUN, DP, RES , PESO, SSR, WSSROLD, SAVOLD, NP, NP) CALCPESO(RES ,PESO,NP,0)
CALCPESO(RES,PESO,NP,NP)
CALL
CALL
CALL
ENDIF
SSR = SSR/(FII*NP)
SAVOLD = SAVOLD/(FII*NP)
ITMAX =51
TOL = l.D-3
410
420
430
440
500
405
411
505
C
C c
c
510
520
C
MM - 0
*	ITMAX.AND.MM.LT.10)
DO 420 I = 1,NPAR
DO 410 J = 1/NPAR+l
A(I,J) = 0. DO
CONTINUE
CONTINUE
DO 500 K = 1,NP
DO 440 I = 1,NPAR
DO 430 J = 1,NPAR
A(I,J) = A(I,J) + PESO(K)*B(K,I)*B(K,J)
IF(IOPT.EQ.3)
*	A(I,J) = A(I,J) + PESO(K+NP)*B1(K,I)*B1(K,J) CONTINUE
A(I,NPAR+1) = A(I,NPAR+1) + PESO(K)*RES(K)*B(K,I)
IF (IOPT.EQ.3)
*	A(I,NPAR+1) = A(I,NPAR+1) + PESO(K+NP)*RES(K+NP)*
*
CONTINUE
CONTINUE
IF(MÜD) THEN
DO 411 K = 1,NP
DO 406 I = 1,NPAR
XY(K,I) = B(K,I)
IF (IOPT.EQ.3) XY(K+NP,I) = B1(K,I)
CONTINUE
XY(K,NPAR+1) = -RES(K)
IF(IOPT.EQ.3) XY(K+NP?NPAR+1) = -RES(K+NP)
CONTINUE
NII = FII*NP
CALL RLLAV (XV, 2*NPON,NII,NPAR,1,BETA,SUMRE,II,IRANK,IWK,
*	WK,IER)
DELK = BETA(l)
DELS ® BETA(2)
DELC = BETA(3)
ELSE
DO 505 I = 1,NPAR
A(I,NPAR+1) = -A(I,NPAR+1)
CONTINUE
INCLUINDO AS FUNCOES PENALIDADES
K &gt; 0
-7 &amp;lt;S &amp;lt;20
C &gt; 0
PEN(l) = 2.D~5/OESTK**3
PEN(2) = l.D-2*( DEXP(-OESTS-7.DO) + DEXP(OESTS-2.Dl) )
PEN(3) = 2.D1/OESTC**3
DO 510 I = 1,NPAR
PEN(I) = PEN(I)*NP*FII*WSSROLD/2.DO
A(I,I) = A(I,I) + PEN(I)
CONTINUE
PEN(l) = 1.D-5/OESTK**2
PEN(2) = l.D-2*( DEXP ('-OESTS-7 . DO) - DEXP (OESTS-2 . Dl) )
s60
570
550
710
402
DO 560 J = L,NPAR AS (I , J) = A (I / J) / DSQ.RT (A (I, I) *A (J} J) ) CONTINUE
AS(I,NPAR+1) = A(I,NPAR+1)/DSQRT(A(I, I) )
CONTINUE
DO 550 I ~ 1,NPAR AS(I,I) = AS(I,I)+RLAM
CONTINUE
CALL GAUSS(AS,DELTA,NPAR)
DELK = DELTA(1)/DSQRT(A(1,1))
DELS = DELTA(2)/DSQRT(A(2,2))
DELC = DELTA(3)/DSQRT(A(3,3))
ENDIF
MMM = 0
MM - 0
RO = 0.5D0**MM
ESTK » OESTK + RO*DELK
ESTS = OESTS + RO*DELS
ESTC ~ OESTC 4- RO*DELC
IF(ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN
MM = MM + 1
WRITE(*,*) 'SOMA EM MM FOR LIMITE' IF (MM.GE.10) THEN
WRITE(*,*) 'FALHA NO ALGORITMO DE PROCURA LINEAR-LIMITE' GO TO 402
ENDIF
GO TO 710
ENDIF
IF (ESTS.LT.0.DO) THEN
IF(ESTS.LT.-7,DO) ESTS = ~7 . DO
RESRWE = RESRW*DEXP(-ESTS)
SKIN = 0,00
ELSE
RESRWE = RESRW
SKIN = ESTS
ENDIF
SAV « 0.DO
WSSR = 0. DO
SSR = 0.D0
IF(IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT) IF(IOPT.EQ.1) THEN
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) ELSE
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,0) ENDIF
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)
CALL RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV,NP,0) CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)
CALL RESIDUO(FUN,DP,RES,PESO,SSR,WSSR,SAV,NP,NP)
ENDIF
SAV = SAV/(FII*NP)
WSSR = WSSR/(FII*NP)
SSR = SSR/(FII*NP)
IF (SAV.GT.SAVOLD) THEN
403
CALCPESO(RES,PESO,NP,0)
CALCPESO(RES , PESO,NP,0) CALCPESO(RES,PESO,NP,NP)
605
*
*
615
*
MM = MM + 1
WRITE(*,*) 'SOMA EM MM FOR RESIDUO'
IF (MM,GE.10) THEN
GO TO 403
ENDIF
GO TO 710
ENDIF
IF(IOPT.NE.3) THEN
CALL
ELSE
CALL
CALL
ENDIF
IF (MMM.EQ.l) THEN
RLAM = RLAM*10.DO
ELSE
RLAM = RLAM/10.D0
ENDIF
WRITE(*,600) ITER
WRITE(*,605) CON3*SAVOLD,CON3*S AV,CON3 *WSSR,CON4*SSR FORMAT(T10,'SAVOLD',T24,'SAV',T38,'WSSR',T52,'SSR'/ 4(2X,F12.4))
WRITE(9,615) ITER,CON4 *SSR,CON3 *SAV,0.0, CON1*ESTK,ESTS,CON2*ESTC,MM+1
FORMAT(IX,13,6(IX,Ell.5),1X,I2)
WSSROLD = WSSR
SAVOLD = SAV
TOLK = DABS(DELK/OESTK)
TOLS = DABS(DELS/OESTS)
TOLC = DABS(DELC/OESTC)
IF (TOLK.LE.O.1.AND.TOLS.LE.0.1.AND.TOLC.LE.0.1.AND..NOT.MUD. AND.ITER.GT.2) THEN
MUD
WRITE(*,*)
WRITE(*,*)
WRITE(*,*)
WRITE(*,*)
WRITE(*, *)
ENDIF
WRITE(*,610) CONI*ESTK,ESTS,CON2*ESTC
OESTK = ESTK
OESTS = ESTS
OESTC = ESTC
PAUSE
ITER = ITER + 1
ENDDO
ITER = ITER
IF
.TRUE.
****************	*************** &gt;
•*************** MUDOU ***************' * ***************	***************z
f * * * ** it * * ** * * if* ** * * * * * * * * ** * ** * * * ***** ** *
C
1
(IOPT.EQ.1) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N tM , NP,B,RES,2)
*
DO

CONTINUE
ENDIF
220
: FII*NP
INTERV(A,DELTA,WSSR,Nil) = 100.DO*DELTA(1)/ESTK = 100.D0*DELTA(2)/ESTS = 100.D0*DELTA(3)/ESTC
600
610
640
650
660
Nil ■■
CALL
DELK
DELS
DELC
WRITE(8,*)
IF(IOPT.EQ.l) THEN
WRITE(8 , *) •REGRESSÃO
ELSE IF(IOPT.EQ.2) THEN
WRITE(8 , *)	'REGRESSÃO
ELSE
WRITE(8,*) 1 REGRESSÃO
ENDIF
WRITE(8,600)
WRITE(8,650)
WRITE(8,660) WRITE(*,600)
WRITE(*,650)
WRITE(*,660)
FORMAT(/,IX,'N. ITERACOES FORMAT(1X,'K = ',F15.6/1X FORMAT(IX,5(E15•7))
FORMAT(1X,'WSSR
*	1X,'SSR
*	IX,'SAV FORMAT(1X,'K =
*
*
END
NOS DADOS DE PRESSAO.'
NOS DADOS DA DERIVADA DA PRESSAO.'
NOS DADOS DA PRESSAO E DA DERIVADA.'
ITER
CON4*SSR,CON3*SAV
CON1*ESTK,DELK,ESTS,DELS,CON2*ESTC,DELC
ITER
CON3 *WSSR,CON4 *SSR,CON3 *SAV
CON 1*ESTK, DELK,ESTS, DELS, CON2*ESTC, DELC
,14)
,'S = ',F15.6/1X,'C = ',E15.6)
—. f
IX,'S » • IX,'C = »
— f
f /
,F15Z.6, ' ,F15.6,' ,E15.6,'
,F15.5,2X,/
,F15.5,2x,/
F15.5,2x,)
+/-',F6.2,' V/
+/-•,F6.2,’ %'/
+/-',16.2t' %')
**********************************************************************
SUBROUTINE CALCPESO(RES,PESO,NP,IN)
IMPLICIT REAL*8 (A-H,O-Z)
DIMENSION RES(l),PESO(1)
DO 100 1=1,NP
AUX = DABS(RES(I+IN))
IF(AUX.LT.1.D-9) THEN
PESO(I+IN) = 0.D0
ELSE
PESO(I+IN) ® 1.D0/AUX
ENDIF
100 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE RESIDUO(FUN,TESP,RES,PESO,SSR,WSSR,SAV, NP, IN) IMPLICIT REAL*8 (A-H,O-Z)
DIMENSION FUN(1),TESP(1) ,RES(1),PESO(1)
DO 100 1=1,NP
RES(I+IN) = FUN(I) - TESP(I)
SSR ~ SSR + RES(I+IN)*RES(I+IN)
WSSR = WSSR + PESO(I+IN)*RES(I+IN)*RES(I+IN)
SAV = SAV + DABS(RES(I+IN))
100 CONTINUE
RETURN
END
A ★ ir x &amp;amp; st	x
G*********************************************************************** c**** Utiliza as bilbilotecas de resolução de sistemas de equações c**** sobredeterminado (Decomposição em valores singulares) da c**** biblioteca Numerical Recipes.
IMPLICIT REAL*8 (A-H,O~Z) PARAMETER (NPCN=150,NPAR=3) CHARACTER*12 ARQUIVO DIMENSION TESP(NPON),TEST(NPON),B(NPON,NPAR),FUN(NPON),
*	DELTA(NPAR),U(2*NPON,NPAR),W(NPAR),VI(NPAR,NPAR)
*	DP(NPON),BI(NPON,NPAR),RES(2*NPON)
COMMON /STE/ V(50)
CON1 = 1000.
COM2 = 4.2784409E-7
CON3 =14.7
COM4 = 216.09
DADOS DE RESERVATÓRIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l)t
Q(STB/D) , BO(BBL/STB)
WRITE(*,*) "ENTRE COM O ARQUIVO DE DADOS"
READ(*,*) ARQUIVO
open(4,fi1 e» ARQUIVO,status®" unknown")
open(7 ffile®"SAISVD.DAT",status®"unknown')
open (8, file="RESSVD.DAT", status®"unknown")
READ(4,10) RESH,RESVIS ,RES PHI,RESCT,RESRW,RESQ,RESBO,TPROD
FORMAT(T25,F10.5)
READ(4,20) NP
FORMAT(T32,13) DO 100 1=1,NP
READ(4,*) TEST(I),TESP(I)
CONTINUE
VARIAVEIS DE CONTROLE PARA 0 ALGORITMO DE STHEFEST COM 8 CTES M = 0 N = 8 TRANSFORMAÇÕES DE UNIDADE
RESCT = RESCT*14.7D0
RESQ = RESQ*RESBO*1.84DO
RESRW
RESH =
DO 300 I =
TEST(I)
TESP(I) CONTINUE
WRITE(6,*)
WRITE(6,*)
WRITE(6, *)
WRITE(6,*)
READ(5,*) IOPT
CALL DPDT(TEST,TESP,NP,DP)
LENDO AS ESTIMATIVAS INICIAIS
WRITE(6,*)
*	"ENTRE COM OS VALORES INICIAIS DE K(D), S E C(CM3/ATM)" READ(5,*) OESTK,OESTS,OESTC
WRITE(8,105) CON1*OESTK,OESTS,CON2*OESTC
FORMAT(3X,"ESTIMATIVAS INICIAIS"//
*	IX,"K	=
*	ix,"S
*	IX, " C	=
c c
10
20
100 c
C
300
■ RESRW*2.54D0
RESH*30.48D0
1,NP
= TEST(I)*3.6D3 = TESP(I)/14.7DO
"QUAL	A FUNCAO A	SER	MINIMIZADA ?"
"	1	-	PRESSÃO."
•	2	-	DERIVADA."
"	3	-	DERIVADA +	PRESSÃO."

c
***** ******* *******
rs &gt;
— Z
,F10.5/
,FIO.5/
,E10.3)
IF(IOPT.NE.3) THEN Nil = 1 CALL LAPLACE (RESPHI, RES VIS , RESCT , RESRW, RESH, RESQ ,
*	OESTK,OESTStOESTC,TEST,NtM,NP, B tFUN,IOPT) IF(IOPT.EQ.l) THEN
DO 110 I = 1,NP RES(I) - TESP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(X) AUX1 = DABS(RES(1)) SAV = SAV + AUX1
110	CONTINUE
ELSE
DO 111 I = 1,NP RES(I) = DP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(I) AUX1 = DABS(RES(I)) SAV = SAV + AUX1
111	CONTINUE
ENDIF SSROLD = SSROLD/NP SAV = SAV/NP
ELSE
Nil = 2
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,B,FUN,1)
DO 112 I = 1,NP RES(I) = TESP(I) - FUN(I) SSROLD = SSROLD + RES(I)*RES(I) AUX1 = DABS(RES(I)) SAV = SAV + AUX1
112	CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRW,RESH,RESQ,
*	OESTK,OESTS,OESTC,TEST,N,M,NP,Bl,FUN,2) DO 113 I - 1,NP
RES(I+NP) = DP(I) - FUN(I) SSROLD = SSROLD + RES(I+NP)*RES(I+NP) AUX1 = DABS(RES(I+NP))
SAV = SAV + AUX1
113	CONTINUE
SSROLD = SSROLD/NP/2.0 SAV = SAV/NP/2.0
ENDIF
WRITE(8,615) 0,CON4 *SSROLD,CON3 *SAV,0.0,
*	CON1*OESTK,OESTS,CON2*OESTC,0
ITMAX = 51
TOL = l.D-3
TOLK = 1.D0
TOLS = 1.D0
TOLC = 1.D0
ITER = 0
MM = 0
DO WHILE((TOLK.GT.TOL&lt;OR.TOLS.GT.TOL.OR.TOLC.GT.TOL).AND.ITER.LT.
*	itmax.and.mm.lt.10)
410
420
CONTINUE
CONTINUE
710
502
400
401
*
*
MM = 0
RO = .5D0**MM
ESTK = OESTK + RO*DELK
ESTS = OESTS + RO*DELS
ESTC = OESTC + RO*DELC
IF (ESTK.LE.0.DO.OR.ESTC.LT.0.DO) THEN
MM « MM + I
WRITE(*,*) 'SOMA POR LIMITS'
IF (MM.GT.20) THEN
WRITE(*,*) 'FALHA POR LIMITE'
GO TO 502
ENDIF
GO TO 710
ENDIF
IF (ESTS.LT.0.DO) THEN
RESRWE = RESRW*DEXP(-ESTS)
SKIN = 0.DO
ELSE
RESRWE = RESRW
SKIN = ESTS
ENDIF
SSR = 0 . DO
SAV =0.00
IF(IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,IOPT)
IF(IOPT.EQ.l) THEN
DO 400 I = 1,NP
RES(I) = TESP(I) - FUN(I)
AUX1 = DABS(RES(I))
SSR = SSR + RES(I)*RES(I)
SAV = SAV + AUX1
CONTINUE
ELSE
DO 401 I = 1,NP
RES(I) = DP(I) - FUN(I)
AUX1 = DABS(RES(I))
SSR = SSR + RES(I)*RES(I)
SAV = SAV + AUX1
CONTINUE
ENDIF
SSR = SSR/NP
SAV = SAV/NP
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ, ESTK,SKIN,ESTC,TEST,N,M,NP,B,FUN,1)
DO 402 I = 1,NP
RES(I) = TESP(I) - FUN(I)
AUX1 = DABS(RES(I))
SSR = SSR + RES(I)*RES(I)
SAV = SAV + AUX1
CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,FUN,2)
DO 403 I = 1,NP
RES(I+NP) = DP(I) - FUN(I) AUX1 = DABS(RES(I+NP))
SSR = SSR + RES(I+NP)*RES(I+NP)
SAV = SAV + AUX1
403	CONTINUE
SSR = SSR/NP/2.0
SAV = SAV/NP/2.0
ENDIF
IF (SSR,GT.SSROLD) THEN
MM = MM + 1
WRITE(*,*) 'SOMA POR RESIDUO'
IF (MM.GT.10) THEN
WRITE(*,*) 'FALHA POR RESIDUO'
GO TO 501
ENDIF
GO TO 710
ENDIF
501	WRITE(8,615) ITER,CON4*SSR,CON3*SAV,0.0,
*	CON1*ESTK,ESTS,CON2*ESTC,MM+1
615	FORMAT(1X,13,6(1X,E11.5),1X,I2)
TOLK = DABS(DELK/OESTK)
TOLS = DABS(DELS/OESTS)
TOLC = DABS(DELC/OESTC)
WRITE(*,600) ITER
WRITE(*,*) CON4*SSROLD,COM4*SSR
WRITE(*,610) CONI*DELK,DELS,CON2*DELC
WRITE(*,610) CON1*ESTK,ESTS,CON2*ESTC
OESTK = ESTK
OESTS = ESTS
OESTC = ESTC
SSROLD = SSR
ENDDO
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	ESTK,SKIN,ESTC,TEST,N,M,NP,Bl,RES,2) DO 620 I = 1,NP
WRITE(7,640) TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,
*	DP(I)*14.7,RES(I)*14.7
620 CONTINUE
WRITE(*,600) ITER
WRITE(*,*) CON4*SSR,CON3*SAV
WRITE(*,610) CONI*ESTK,ESTS,CON4*ESTC
600	FORMAT(/,IX,'N. ITERACOES =',I4)
610	FORMAT(2(IX,F15.6/),1X,E15.6)
640 FORMAT(1X,5(E15.7))
END
*********************************************************************
Regressão nao linear com o método de Nelder-Mead's para ******* um modelo de reservatório radial infinito	*******
*******
£* * * * Citi * C*** * q**** Q-iklekit
c c
10
20
1G0
101
c
c
300
*******
*******
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NP0N=150,NPAR=3)
CHARACTER*12 ARQUIVO
DIMENSION RESVAR(NPAR,NPAR+1) ,SAV(NPAR+1) , RMED(NPAR) ,R(NPAR)
DIMENSION DPl(NPON),PARKED(NPAR)
COMMON COMMON COMMON CONI = CON 2 = CON 3 = CON 4 =	/STE/ V(50),M,N /DADOS/ RESH, RESVIS , RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON) 1000. 4.2784409E-7 14.7 216.09
TOL = 1.0-7
IMIN = 10
IMAX =300
IT = 0
WRITE(*,*) 'ENTRE COM 0 ARQUIVO DE DADOS'
READ(*,*) ARQUIVO
open(4,file=ARQUIVO,status='unknown')
open(7,file='SAINM.DAT',status='unknown')
open(8,file='RESNM.DAT',status='unknown')
DADOS DE RESERVATORIO - H(PES), VIS(CP), PHI(PURO), CT(PSI-l),
Q(STB/D), BO(BBL/STB)
READ (4,10) RESH, RESVIS, RESPHI, RESCT, RESRW, RESQ, RESBO, TPROD FORMAT(T25,F10.5)
READ(4,20) NP
FORMAT(T32,13)
DO 100 1=1,NP
READ(4,*) TEST(I),TESP(I)
CONTINUE
CALL DPDT(TEST,TESP,NP,DP)
IF(TPROD,NE.0.DO) THEN
DO 101 I = 1, NP
TEST(I) = TEST(I)*TPROD/(TEST(I)+TPROD)
CONTINUE
ENDIF
VARIAVEIS DE CONTROLS PARA 0 ALGORITMO DE STHEFEST COM 8 CTES
M = 0
N = 8
TRANSFORMAÇÕES DE UNIDADE
RESCT = RESCT*14.7D0
RESQ = RESQ*RESBO*1.84DO
RESRW = RESRW*2.54D0
RESH = RESH*30.48D0
DO 300 I =
TEST(I)
TESP(I)
DP(I) = CONTINUE WRITE(6,*) WRITE(6, *) WRITE(6,*)
1,NP
= TEST(I)*3.6D3
= TESP(I)/14.7DO
DP(I)/14.7D0
'QUAL A FUNCAO A MINIMIZAR ?' ' 1 - PRESSÃO,'
' 2 - DERIVADA.'
WRITE(*,*) 'ENTRE AS ESTIMATIVAS INICIAIS DE K, S E C.1
DERIVADA + PRESSÃO.!
READ(*,*) A,B,C		
RESVAR(1,1) =	DLOGIO(A)	
RESVAR(1,2) =	RESVAR(1,1) +	0.5
RESVAR(1,3) =	RESVAR(1,1) +	1.0
.RESVAR(1,4) =	RESVAR(1,1) +	0.5
RESVAR(2,1) =	B	
IF(RESVAR(2,1)	.LT.15.0) THEN	
RESVAR(2,2)	= RESVAR(2,1)	+ 5.0
RESVAR(2,3)	= RESVAR(2,1)	- 1.0
RESVAR(2,4)	= RESVAR(2,1)	+ 5.0
ELSE		
RESVAR(2,2)	= RESVAR(2,1)	- 5.0
RESVAR(2,3)	= RESVAR(2,1)	- 1.0
RESVAR(2,4)	= RESVAR(2,1)	- 5.0
ENDIF		
RESVAR(3,1) =	DLOGIO(C)	
RESVAR(3,2) =	RESVAR(3,1)	
RESVAR(3,3) =	RESVAR(3,1)	
RESVAR(3,4) =	RESVAR(3,1) +	1.0
DO 105 J = 1,NPAR+1		
IF(RESVAR(2,J).LT.O.DO) THEN
RESRWE = RESRW*DEXP(-RESVAR(2,J))
SKIN = 0.D0
ELSE
RESRWE = RESRW
SKIN = RESVAR(2,J)
END IF
IF(IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,IOPT)
SAV(J) = 0.D0
DO 110 I = 1,NP
IF(IOPT.EQ.1) THEN
RES = FUN(I) - TESP(I)
ELSE
RES = FUN(I) - DP(I)
ENDIF
AUX1 = DABS(RES) SAV(J) = SAV(J)+ AUX1
110	CONTINUE
SAV(J) = SAV(J)/NP ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,1)
SAV(J) =0.00
DO 111 I = 1,NP
RES = FUN(I) - TESP(I)
AUX1 = DABS(RES)
SAV(J) = SAV(J)+ AUX1
111	CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,2)
DO 112 I = 1,NP
RES = FUN(I) - DP(I)
112
105
302
301
303
880
890
900
AUX1 = DABS(RES)
SAV(J) = SAV(J)+ AUX1 CONTINUE
SAV(J) «- SAV(J)/(2*NP) ENDIF
CONTINUE
CALL ORDER(SAV,ILO,ILI,IHI, IHO)
DO 301 I = 1,NPAR+T
WRITE(*,302) CON1*10.DO**RESVAR(1,I),RESVAR(2,I),
*	CON2*10.D0**RESVAR(3,I),CON3*SAV(I) FORMAT(3(1X,E12.5),' FUN= ',E12.5)
CONTINUE
WRITE(*,*)
DO WHILE( (SAV(IHI).GT.SAV(ILO)+TOL.AND.IT.LT.IMAX).OR.
*	(IT.LT.IMIN) )
CALL NEWPOINTS(RESVAR,IHI,RMED,R,SAVLIN,NP,IOPT)
CALL IMPROVE(RESVAR,SAVtRMED,RfSAVLIN,ILO,ILI,IHO,IHI,NP,IOPT) CALL ORDER(SAV,ILO,ILI,IHI,IHO)
DO 303 I = 1,NPAR+1
WRITE(*,302) CON1*10.D0**RESVAR(1,I),RESVAR(2,I),
*	CON2 *10.DO * *RESVAR(3,1),CONS *SAV(I) CONTINUE
WRITEf*,*) WRITE(8,880) IT,CON3*SAV(ILO),CON1*10.D0**RESVAR(1,ILO),
*	RESVAR(2,ILO),CON2*10.D0**RESVAR(3,ILO) FORMAT(IX,13,4(E16.8))
IT = IT 4- 1
ENDDO
WRITE(*,302) CON1*10.DO**RESVAR(1,ILO),RESVAR(2,ILO),
*	CON2*10.D0**RESVAR(3,ILO),CON3 *SAV(ILO)
IF(RESVAR(2,ILO).LT.0.DO) THEN
RESRWE = RESRW*DEXP(-RESVAR(2,IL0))
SKIN = 0.D0
ELSE
RESRWE = RESRW
SKIN = RESVAR(2,ILO)
ENDIF
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,ILO),SKIN,RESVAR(3,ILO),TEST,NP,FUN,1)
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,ILO),SKIN,RESVAR(3,ILO),TEST,NP,DPI,2) SSR » 0.D0
IF(IOPT.EQ.l) THEN
DO 890 I = 1,NP
SSR « SSR + (FUN(I)-TESP(I))**2
CONTINUE
SSR « SSR/NP
ELSE IF(IOPT.EQ.2) THEN
DO 900 I = 1,NP
SSR - SSR + (DPI(I)-DP(I))**2
CONTINUE
SSR = SSR/NP
ELSE
DO 920 I = 1,NP
SSR - SSR + (FUN(I)-TESP(I))**2
SSR = SSR + (DPI(I)~DP(I))**2
CONTINUE
SSR - SSR/(2*NP)
ENDIF
WRITE(*,910) IT,CON3*SAV(ILO),CON4*SSR
910	FORMAT(IX,'ITER	-',13/
	*	IX,'SAV	=',E12.6/
	*	IX,'SSR	=',E12.6)
	DO 400 I ® 1,NP	
	WRITE(7,500)	TEST(I)/3.6D3,TESP(I)*14.7D0,FUN(I)*14.7D0,
	*	DP(I)*14.7,DPI(I)*14.7
500	FORMAT(IX,5E15.7)	
400	CONTINUE	
	END	
*4*4**44*44***444*4******4*4A44**4*4444************444**44**4444444444
SUBROUTINE ORDER(Y,ILO,ILI,IHI,IHO)
IMPLICIT REAL*8 (A-H.O-Z)
PARAMETER (NPAR=3)
DIMENSION Y(l)
ILO = 1
IHI - 1
DO 100 J = 2,NPAR+1
IF(Y(J).LT.Y(ILO)) ILO ~ J
IF(¥(J).GT.Y(IHI)) IHI = J
100 CONTINUE
ILI = IHI
IHO - ILO
DO 200 J » 2,NPAR+1
IF(J.NE.ILO.AND.¥(J).LT.Y(ILI)) ILI = J IF(J.NE.IHI.AND.Y(J).GT.Y(IHO)) IHO = J
200 CONTINUE
RETURN
END
**********************************************************************
SUBROUTINE NEWPOINTSfRESVAR,IHI,RMED,R, SAVLIN,NP, IOPT)
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NPON=150,NPAR=3)
COMMON /STE/ V(50),M,N
COMMON /DADOS/ RESH,RESVIS,RESPHI,RESCT,RESRW, RESQ,RESBO,TPROD
COMMON /PRES/ TEST(NPON) ,TESP(NPON) , FUN(NPON) , DP(NPON) DIMENSION RESVAR(NPAR,NPAR+1) ,RMED(1) ,R(1) , DELTA (NPAR)
DO 200 K=^1,NPAR
S - O.DO
DO 100 J=1,NPAR+1
S = S + RESVAR(K,J)
100	CONTINUE
RMED(K) - (S - RESVAR(K,IHI))/NPAR
DELTA(K) = RMED(K) - RESVAR(K,IHI)
200 CONTINUE
DO 400 I~1,NPAR
R(I) = RMED(I) + DELTA(I)
400 CONTINUE
MM « 1
DO WHILE ( (R(2) .LT.-10.0.OR.R(2) .GT.30.0) .AND.MM.LT.il ) RHO = 0.5**MM
DO 440 I = 1,NPAR
R(I) = RMED(I) + RHO*DELTA(I)
440	CONTINUE
MM ~ MM + 1
IF(MM.GT.IO) THEN
IF(R(2).LT.-10.0) R(2) « -10.0
IF(R(2).GT.30.0) R(2) - 30.0
ENDIF
END EX)
IF(R(2).LT.O.DO) THEN
RESRWE - RESRW*DEXP(-R(2))
SKIN = O.DO
ELSE
RESRWE = RESRW
SKIN = R(2)
ENDIF
IF(IOPT.NE.3) THEN
CALL LAPLACE(RESPHI , RESVIS, RESCT, RESRWE, RESH, RESQ,
*	R(l),SKIN,R(3),TEST,NP,FUN,IOPT)
SAVLIN = O.DO
DO 110 I = 1,NP
IF(IOPT.EQ.1) THEN
RES = FUN(I) - TESP(I)
ELSE
RES » FUN (I) - DP(I)
ENDIF
AUX1 « DABS(RES)
SAVLIN = SAVLIN+ AUX1
110	CONTINUE
SAVLIN = SAVLIN/NP
ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	R(l),SKIN,R(3),TEST,NP,FUN,1)
SAVLIN = O.DO
DO 111 I = 1,NP
RES = FUN(I) - TESP(I)
AUX1 = DABS(RES)
SAVLIN = SAVLIN+ AUX1
111	CONTINUE
CALL LAPLACE (RESPHI,RESVIS, RESCT,RESRWE,RESH, RESQ,
*	R(l),SKIN,R(3),TEST,NP,FUN,2)
DO 112 I = 1,NP
RES = FUN(I) - DP(I)
AUX1 = DABS (RES)
SAVLIN = SAVLIN+ AUX1
112	CONTINUE
SAVLIN « SAVLIN/(2*NP)
ENDIF
RETURN
END
**********************************************************************
SUBROUTINE SHRINK(RESVAR,SAV,ILO,NP,IOPT)
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NPON-150,NPAR=3)
DIMENSION RESVAR(NPAR,NPAR+1),SAV(1)
COMMON /STE/ V(50),M,N
COMMON /DADOS/ RESH, RESVIS, RES PHI, RESCT, RESRW, RESQ, RESBO,TPROD
COMMON /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON)
DO 200 J = 1,NPAR+1
IF(J.NE.ILO) THEN
DO 100 K = 1,NPAR
RESVAR(K,J) = ( RESVAR(K,J) + RESVAR(K, ILO) )/2.D0
100	CONTINUE
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,IOPT) DO 110 I = 1,NP
IF(IOPT.EQ.1) THEN
RES = FUN(I) - TESP(I) ELSE
RES - FUN (I) - DP (I) ENDIF
SAV(J) = SAV(J) + DABS(RES)
110	CONTINUE
SAV(J) = SAV(J)/NP
ELSE
CALL LAPLACE (RESPHI,RESVIS,RESCT, RESRWE, RESH, RESQ,
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,1)
DO 111 I = 1,NP
RES = FUN(I) - TESP(I)
SAV(J) ~ SAV(J) + DABS(RES)
111	CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	RESVAR(1,J),SKIN,RESVAR(3,J),TEST,NP,FUN,2)
DO 112 I = 1,NP
RES = FUN(I) - DP(I)
SAV(J) = SAV(J) + DABS(RES)
112	CONTINUE
SAV(J) = SAV(J)/(2*NP)
ENDIF
ENDIF
200 CONTINUE
RETURN
END **********************************************************************
SUBROUTINE IMPROVE(RESVAR,SAV,RMED,R,SAVLIN,ILO,ILI,IHO,IHI,
*	NP,IOPT)
IMPLICIT REAL*8 (A-H,O-Z)
PARAMETER (NPON=150,NPAR=3)
DIMENSION RESVAR(NPAR,NPAR+1) ,SAV(1) ,RMED(1) ,R(1) ,E(NPAR)
COMMON /STE/ V(50),M,N
COMMON /DADOS/ RESH,RESVIS,RESPHI,RESCT,RESRW,RESQ,RESBO,TPROD COMMON /PRES/ TEST(NPON),TESP(NPON),FUN(NPON),DP(NPON) IF(SAVLIN.LT.SAV(IHO)) THEN
IF(SAV(ILI) . LT.SAVLIN) THEN
DO 100 I = 1,NPAR
RESVAR(I,IHI) = R(I)
100	CONTINUE
SAV(IHI) = SAVLIN
ELSE
DO 110 I=1,NPAR
E(I) - R(I) + R(I) “ RMED(I)
110	CONTINUE
MM ~ 1
DO WHILE ( (E(2)-LT.-10.0.0R.E(2).GT.30.0) .AND.MM.LT.il ) RHO = 0.5**MM
DO 440 I « 1,NPAR
E(I) - R(I) + RHO*( R(I) - RMED(I) )
440	CONTINUE
MM = MM + 1
IF(MM.GT.10) THEN
IF(E(2).LT.-10.0) E(2) =
30.0
120
121
122
130
140
IF(E(2).GT.30.0) E(2) =
ENDIF
IFfDABS (RESVAR(2,1) -RESVAR(2,2) ).LT.1.D5
*	.AND. DABS(RESVAR(2,2)-RESVAR(2,3)) .LT.1.D5
*	.AND. DABS(RESVAR(2,3)-RESVAR(2,4)).LT.1.D5)
*	RESVAR(2,1) = 0.5*RESVAR(2,l)
ENDDO
IF(E(2).LT.O.DO) THEN
RESRWE = RESRW*DEXP(-E(2))
SKIN = O.DO
ELSE
RESRWE ~ RESRW
SKIN = E(2)
ENDIF
IF(I0PT.NE.3) THEN
CALL LAPLACE(RESPHI,RES VIS r RESCT tRESRWE,RESH,RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,IOPT)
SAVLI1 = O.DO
DO 120 I = 1,NP
IF(IOPT.EQ.l) THEN
RES - FUN(I) - TESP(I)
ELSE
RES = FUN(I) - DP(I)
ENDIF
SAVLI1 = SAVLI1 + DABS(RES)
CONTINUE
SAVLI1 = SAVLI1/NP
ELSE
CALL LAPLACE(RESPHI,RESVIS, RESCT,RESRWE,RESH,RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,1)
SAVLI1 “O.DO
DO 121 I = 1,NP
RES = FUN(I) - TESP(I)
SAVLI1 = SAVLI1 + DABS(RES)
CONTINUE
CALL LAPLACE (RESPHI,RESVIS, RESCT, RESRWE, RESH, RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,2)
DO 122 I = 1,NP
RES = FUN(I) - DP(I)
SAVLI1 = SAVLI1 + DABS(RES)
CONTINUE
SAVLI1 = SAVLI1/(2*NP)
ENDIF
IF (SAVLI1.LT.SAV(ILI)) THEN
DO 130 I = 1,NPAR
RESVAR(I,IHI) « E(I)
CONTINUE
SAV(IHI) - SAVLI1
ELSE
DO 140 I ® 1,NPAR RESVAR(I,IHI) = R(I)
CONTINUE
SAV(IHI) = SAVLIN
SAV(IHI) « SAVLIN
ENDIF
DO 160 I=1,NPAR
E(I) = (RESVAR(I, IHI) + RMED(I))/2.DO
160	CONTINUE
IF(E(2).LT.O.DO) THEN
RESRWE = RESRW*DEXP(-E(2))
SKIN = O.DO
ELSE
RESRWE = RESRW
SKIN = E(2)
ENDIF
IF(IOPT.NE.3) THEN
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,IOPT)
SAVLI1 = O.DO
DO 170 I = 1,NP
IF(IOPT.EQ.1) THEN
RES = FUN(I) - TESP(I)
ELSE
RES = FUN(I) - DP(I)
ENDIF
SAVLI1 = SAVLI1 + DABS(RES)
170	CONTINUE
SAVLI1 - SAVLI1/NP ELSE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,1)
SAVLI1 « O.DO
DO 171 I - 1,NP
RES - FUN(I) - TESP(I)
SAVLI1 = SAVLI1 4- DABS (RES)
171	CONTINUE
CALL LAPLACE(RESPHI,RESVIS,RESCT,RESRWE,RESH,RESQ,
*	E(l),SKIN,E(3),TEST,NP,FUN,2)
DO 172 I » 1,NP
RES = FUN(I) - DP(I)
SAVLI1 = SAVLI1 + DABS(RES)
172	CONTINUE
SAVLI1 = SAVLI1/(2*NP)
ENDIF
IF (SAVLI1.LT.SAV(IHI)) THEN
DO 180 I = 1,NPAR
RESVAR(I,IHI) « E(I)
180	CONTINUE
SAV(IHI) = SAVLI1
ELSE
CALL SHRINK(RESVAR,SAV,ILO,NP,IOPT)
ENDIF
ENDIF
RETURN
END
C***********************************************************************
SUBROUTINE LAPLACE (RESPHI, RESVIS,RESCT,RESRW,RESH,RESQ,
*	ESTK,ESTS,ESTC,TEST,NP,FUN,IOPT)
IMPLICIT REAL * 8 (A~H,O-Z)
DIMENSION G(50), H(25),TEST(1),FUN(l)
COMMON /STE/ V(50),M,N
VARI = 1O.DO**ESTK
VAR2 = ESTS
c
1
4
5
6
9
8
12
11
13
14
10
7
17
15
VAR3 “ 10.DO**ESTC
DLOGTW = 0.69314718056D0
PI = 4.DO*DATAN(1.DO)
IF (N .EQ. M) GOTO 17
M = N
NH = N/2
FATORIAIS FICAM EM G
G(l) = 1.D0
DO 1 I = 2, N
G(I) * G(I-l) * I
CONTINUE
H(l) = 2.DO / G(NH-l)
DO 6 I = 2, NH
FI = I
IF (I~NH) 4,5,6
H(I) » FI**NH*G(2*I)/(G(NH-I)*G(I)*G(I-1)) GOTO 6
H(I) = FI**NH*G(2*I)/(G(I)*G(I-1))
CONTINUE
SN = 2*(NH-NH/2*2)-1
DO 7 I = 1, N
V(I) = 0.D0
KI = (I+l)/2
K2 = I
IF(K2-NH) 8,8,9
K2 « NH
DO 10 K = Kl, K2
IF(2*K - I) 12,13,12
IF(I-K) 11,14,11
V(I) = V(I) + H(K)/(G(I-K)*G(2*K~I)) GOTO 10
V(I) = V(I) + H(K)/G(I-K)
GOTO 10
V(I) «= V(I) + H(K) / G(2*K » I)
CONTINUE
V(I) = SN*V(I)
SN » -SN
CONTINUE
CONTINUE
Cl = DSQRT(RESPHI*RESVIS*RESCT) *RESRW
C2 - 2.DO*PI*RESH/RESVIS
TEMPS = DSQRT(VARl)
DO 500 J - 1,NP
FUN(J) = 0.D0
A - DLOGTW / TEST(J)
DO 15 I = 1, N
ARG = A* I
TEMPS « DSQRT(ARG)
TEMPI - C1*TEMP5/TEMP6
TEMP2 ■» BESSKO (TEMPI)
TEMPS - BESSK1(TEMPI)
AUX1 = C1*C2*TEMP5*TEMP6*TEMP3
AUX2 « TEMP2 + VAR2*TEMP1*TEMP3
IF(IOPT.EQ.1) THEN
FUN(J) « FUN(J)+V(I)*RESQ/(ARG*(AUX1/AUX2 + VAR3*ARG)) ELSE
IF(IOPT.EQ.2) THEN
FUN(J) = TEST(J) * FUN(J) ENDIF
IF(FUN(J).LE.O.DO) THEN
WRITE(*,*) 'ATENCAO, PRESSAO NEGATIVA NA INVERSAO' ENDIF
500 CONTINUE
RETURN
END
2***********************************************************************
SUBROUTINE DPDT(TEST,TESP,NP,DP)
IMPLICIT REAL * 8 (A-H,O-Z)
DIMENSION TEST(l),TESP(1) ,DP(1)
1	= 2
AUX « DLOG1O(TEST(I)/TEST(1))
DO WHILE (AUX.LT.0.15D0)
1 = 1 + 1
AUX = DLOGIO(TEST(I)/TEST(1))
ENDDO
AUX2 = TEST(I) - TEST(l)
AUX4 = TESP(I) - TESP(l)
DP(1) = TEST(1)*AUX4/AUX2
DO 100 I=2,NP-1
J = I + 1
AUX = DLOGIO(TEST(JJ/TEST(I))
DO WHILE (AUX.LT.0.15D0.AND.J.LT.NP)
J = J + 1
AUX - DWG10 (TEST (JJ/TEST (I)) ENDDO
AUX2 ~ TEST(J) - TEST(I)
AUX4 = TESP(J) - TESP(I)
J = I - 1
AUX = DLOGIO(TEST(I)/TEST(J))
DO WHILE (AUX.LT.0.15D0.AND.J.GT.1)
J = J - 1
AUX = DLOGIO(TEST(I)/TEST(J)) ENDDO
AUX1 = TEST(I) - TEST(J)
AUX3 = TESP(I) - TESP(J)
DP(I) = ( AUX2*AUX3/AUX1 + AUX1*AUX4/AUX2 )/(AUXl + AUX2) DP(I) = TEST(I)*DP(I)
100 CONTINUE
DP(NP) = DP(NP-l)
RETURN
END
************************************************************************</field>
	</doc>
</add>