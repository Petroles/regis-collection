<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.07916</field>
		<field name="filename">12666_arquivo2222_1.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

 

  

UNIVERSIDADE FEDERAL DE PERNAMBUCO 

CURSO DE PÓS-GRADUAÇÃO EM ENGENHARIA MECÂNICA 

 
 

                                                                                                                                                                        
 
 
 
 
 
 
 
 

TÉCNICAS DE OTIMIZAÇÃO POR APROXIMAÇÃO 
SEQUENCIAL APLICADAS A AJUSTE DE HISTÓRICO NA 

SIMULAÇÃO DE RESERVATÓRIOS 
 

 
 

 

 

DISSERTAÇÃO SUBMETIDA À UNIVERSIDADE FEDERAL 

DE PERNAMBUCO PARA OBTENÇÃO DE GRAU DE MESTRE 

EM ENGENHARIA MECÂNICA 

 

 

 

ANDRÉA LEITE DO CARMO 

 

Recife, Agosto de 2010 



i 

 

Técnicas de Otimização por Aproximação Sequencial 
Aplicadas a Ajuste de Histórico na Simulação de Reser-

vatórios 
 

 

 

 

Andréa Leite do Carmo  

 

 

 

Dissertação de Mestrado submetida ao Corpo Docente do Curso 
de Pós-Gradução em Engenharia Mecânica da Universidade Federal de Pernam-

buco, como parte dos requisitos necessários à obtenção do 
grau de Mestre em Ciências em Engenharia Mecânica. 

 
 
 
 
 
 
 

Área de Concentração: Mecânica Computacional 
 
 
 
 
 

Ramiro Brito Willmersdorf, D.Sc 
Orientador 

Silvana Maria Bastos Afonso 
Co-orientadora 

 
 
 

Recife, Pernambuco, Brasil 
Andréa Leite do Carmo, Agosto de 2010



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Catalogação na fonte 

Bibliotecário Marcos Aurélio Soares da Silva, CRB-4 / 1175 

 

C287t Carmo, Andréa Leite do. 

Técnicas de otimização por aproximação sequencial aplicadas a 

ajuste de histórico na simulação de reservatórios / Andréa Leite do 

Carmo. - Recife: O Autor, 2010. 

xiv, 111 folhas, il., gráfs., tabs. 

 

Orientador: Profº Dr.. Ramiro Brito Willmersdorf. 

Dissertação (Mestrado) – Universidade Federal de Pernambuco. 

CTG. Programa de Pós-Graduação em Engenharia Mecânica, 2010. 

Inclui Referências. 

 

1. Engenharia Mecânica. 2.Otimização Aproximada Sequencial 

(ASO). 3.Simulação Numérica. 4. Simulação de Reservatórios. I. 

Wilmersdorf, Ramiro Brito (orientador).  II. Título. 

      

     UFPE 

621   CDD (22. ed.)   BCTG/2011-075 



 



iii 

 

Agradecimentos 
 

 

Aos professores Ramiro Brito Willmersdorf  e Silvana Afonso pelos ensi-

namentos transmitidos e pela sua valiosa orientação para a realização desta pes-

quisa. 

 

A minha filha Júlia Maria, pela compreensão que os momentos de ausên-

cia, são necessários para o meu crescimento profissional e pessoal. 

 

A meus pais por me prepararem para a vida com muito amor e sacrifício, 

me ensinando o caminho do bem e da verdade.  

 

A minha irmã pelo amor e a força.  

 

A todos os meus amigos por sempre acreditarem nas minhas empreita-

das, que me dão tanta força em todos os momentos. 

 

A minha amiga de curso Jane, que me motivou neste período, e dividiu 

comigo seus conhecimentos em assuntos que não são de minha área de atuação.  

 

Aos amigos da UFPE, Gisele, Helder, Dásio, Jeferson, Leonardo, entre 

outros pelo convívio e ajuda no período do curso. 

 

E a DEUS por guiar sempre o meu caminho. 



iv 

 

Resumo 

 

O principal problema do uso de otimização com simulações em projetos 

de engenharia de petróleo se deve a extensiva demanda computacional requerida, 

devido principalmente à grande quantidade de simulações numéricas realizadas 

durante o processo. Neste trabalho é apresentada uma alternativa para superar tal 

dificuldade, utilizando-se funções substitutas - através da construção de modelos 

substitutos (metamodelos) - que são menos custosas de serem realizadas, no qual 

amenizam o esforço computacional gerado durante o processo de otimização exis-

tente para esta classe de aplicação. Desta maneira, torna-se viável a utilização de 

um algoritmo de otimização, sem a necessidade de executar o simulador numérico 

de uma forma intensiva.  

A simulação numérica permite a obtenção de uma previsão do comporta-

mento do reservatório com base em um modelo numérico, previamente construído 

a partir de diversos parâmetros gerados durante a caracterização do campo de 

petróleo. 

Após a construção de um modelo numérico a sua validação com histórico 

de produção é feita através do ajuste de histórico onde o modelo de reservatório é 

corrigido para que os resultados obtidos pelo simulador reproduzam os resultados 

observados, sendo através desse processo gerado uma boa caracterização de 

reservatório de petróleo e consequentemente uma boa previsão de produção. 

Isto posto, este trabalho buscou desenvolver uma metodologia para auto-

matizar o processo de ajuste de histórico de produção por um ajuste assistido, em 

simulação numérica de reservatório de petróleo, através da minimização matemá-

tica de uma função-objetivo utilizando-se de um método de otimização baseado na 

estratégia de Otimização Aproximada Sequencial (SAO). 



v 

 

Para o desenvolvimento do sistema foram implementadas rotinas em OC-

TAVE, posteriormente integradas ao DAKOTA e ao simulador IMEX, permitindo o 

funcionamento da metodologia através da troca de dados entre esses programas. 

Como resultado desse trabalho obteve-se, através da simulação numérica 

de reservatória, dados para avaliar o processo de ajuste de histórico, utilizando-se 

de técnicas de otimização por aproximação sequencial, visando encontrar um mo-

delo ajustado que será utilizado para realizar previsões futuras do reservatório, 

provendo subsídios para uma explotação mais confiável. 

 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Palavras-chaves: Ajuste de Histórico, Otimização por Aproximação Se-

quencial, Simulação de Reservatórios



vi 

 

Abstract 

 
The main problem about using optimization with simulation in projects of oil 

engineering is the extensive computational processing required, mainly due to 

large amount of numerical simulations carried out during the process. In this work 

is proposed an alternative to overcome that difficulty, using the replacement func-

tions - through the construction of surrogate models (metamodels) - that are less 

costly to be carried out and ease or eliminate the shortcomings of optimization me-

thods that exist for this application class. Thus, it becomes feasible to use an opti-

mization algorithm without the need to run the simulator numerically-intensive. 

The numerical simulation allows obtaining a prediction of the reservoir’s 

behavior based on a numerical model, previously constructed from a variety of pa-

rameters generated during the characterization of the oil field. 

After the construction of a numerical model its validation with production 

history is made by history matching of the reservoir where the model is corrected 

for the results obtained by the simulator to reproduce the observed results being 

achieved through this process of reproduction of sound reservoir characterization 

of oil and therefore a good prediction of production. 

That said, this work intended to develop a methodology to automate the 

process of history matching of production assisted by an adjustment, in numerical 

simulation of oil reservoir, by minimizing a mathematical objective-function using 

an optimization method based the strategy for Sequential Approximate Optimiza-

tion (SAO). 

To develop the system were implemented routines in OCTAVE, which 

were later integrated with DAKOTA and IMEX simulator, allowing the functioning of 

the methodology through the exchange of data between these programs. 

As result of this work were obtained, through numerical simulation of re-

servoir, data to evaluate the process of history matching, using techniques for se-

quential approximate optimization, aiming to find a adjusted model that will be used 



vii 

 

for the reservoir's future forecasts, providing subsidies for a more reliable exploita-

tion. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Key-words: History Matching, Sequential Approximate Optimization, Reservoir Si-

mulation 



viii 

 

Lista de Símbolos 

Romanos 
 

Escalares:  

( )f? x  Função aproximada 

( )f x  Função-objetivo 

,i j  Índices das coordenadas dos vetores 

k  Índice das coordenadas dos vetores 

Observodo
COP  Dados observados da série de dados 

Calculado
COP  Dados Calculados da série de dados 

( ),x ?LLLL  Função Lagrangeana 

m  Tamanho da amostra 

n  
Número das variáveis de projeto; número de intervalos da vari-
ável aleatório  

,p q  Tamanho das restrições de desigualdade e igualdade 

z  Número da iteração SAO 

tol  Tolerância da estratégia SAO 

c
n  Número de coeficiente 

1 2,  x x  Coordenadas dos pontos x  

1 2,  y y  Coordenadas dos pontos y  

1 2,  b b   Comprimentos de correlação 

r
N  Número de realizações 

Vetores:  

d  Direção de busca 

( )g x  Função restrição de desigualdade 



ix 

 

( )h x  Função restrição de igualdade 

( )g x)
 Função aproximada da restrição de desigualdade 

( )h x
)

 Função aproximada da restrição de igualdade 

u  Deslocamento 

x  
Variáveis de projeto 

*
0 ,x x  

Variáveis de projeto no ponto inicial e ótimo de projeto, respec-
tivamente 

c
x  Variáveis de projeto no ponto central da região de confiança 

,L Ux x  
Limites inferiores e superiores das variáveis de projeto, respec-
tivamente 

( )N x  Polinômio de regressão 

0, ,, , ,i j kc c c c  Coeficientes polinomiais 

?f  
Derivada da função objetivo com relação às variáveis de proje-
to 

Matrizes  

K  
Núcleo 

NNNN  Modelo de regressão 

H  Hessiana 

S  Amostra 

C  Covariância 

E  Matriz dos auto-vetores de C  

Gregos 

Escalares:  

?
 

Tamanho do passo da direção de busca; Correção aditiva    

?  Correção multiplicativa 

?  Termo de aceitação 

?  Tamanho da região de confiança 



x 

 

E
?  Desvio padrão 

Vetores:  

?  Coeficientes de regressão incógnitos 

?  Variáveis aleatórias 

?  Multiplicadores de Lagrange; autovalor de C  

?  Autovetor de C  

Matrizes:  

?  Matriz diagonal de autovalores de C  

Matemáticos 

?  Operador Nabla 

? Pertencente 

?  Derivada parcial 

? Somatório 

? Produtório 

?  Conjunto ou espaço dos números reais 

, ,= ? ?  Igual; diferente; aproximadamente igual 

, ,&gt; ? ?  Maior que; maior ou igual à; muito maior que 

,&amp;lt;?  Menor que; menor ou igual à 

? Integral 

 



xi 

 

I. Sumário 

LISTA DE FIGURAS .................................................................................................................................. XIII 

LISTA DE TABELAS ................................................................................................................................. XIV 

1 INTRODUÇÃO ........................................................................................................................................... 15 

2 FUNDAMENTAÇÃO TEÓRICA .............................................................................................................. 19 

2.1 OTIMIZAÇÃO ............................................................................................................................................ 19 
2.1.1 Introdução ..................................................................................................................................... 19 
2.1.2 Programação Quadrática Sequencial - SQP .................................................................................. 22 

2.2 SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS ........................................................................................... 25 

3 APROXIMAÇÕES ...................................................................................................................................... 28 

3.1 INTRODUÇÃO ........................................................................................................................................... 28 
3.2 FUNÇÕES SUBSTITUTAS BASEADAS NO MODELO FUNCIONAL.................................................................. 30 

3.2.1 Método de Superfície de Resposta ................................................................................................ 30 
3.2.2 Técnicas de Amostragem .............................................................................................................. 32 
3.2.3 Modelo de Regressão Polinomial ................................................................................................. 37 
3.2.4 Otimização por Aproximação Sequencial (SAO) ......................................................................... 39 

4 AJUSTE DE HISTÓRICO ......................................................................................................................... 47 

4.1 SELEÇÃO DAS VARIÁVEIS DE PROJETO .................................................................................................... 48 
4.2 PROBLEMA INVERSO ................................................................................................................................ 49 
4.3 AJUSTE MANUAL E ASSISTIDO ................................................................................................................. 50 
4.4 SELEÇÃO DOS ALGORITMOS DE OTIMIZAÇÃO .......................................................................................... 52 
4.5 FORMULAÇÃO DO PROBLEMA .................................................................................................................. 54 

4.5.1 Função-Objetivo ........................................................................................................................... 54 
4.5.2 Variáveis de Projeto ...................................................................................................................... 55 
4.5.3 Restrições de Limite ..................................................................................................................... 55 

5 IMPLEMENTAÇÃO COMPUTACIONAL ............................................................................................. 56 

5.1 FERRAMENTAS ......................................................................................................................................... 56 
5.1.1 IMEX ............................................................................................................................................ 56 
5.1.2 DAKOTA ..................................................................................................................................... 58 

5.1.2.1 Estratégia de Otimização no DAKOTA ............................................................................. 60 
5.1.2.2 Implementação da Estratégia de Otimização Aproximada Sequencial (SAO) no DAKOTA
 ........................................................................................................................................................ 62 

5.1.3 OCTAVE ...................................................................................................................................... 64 
5.2 METODOLOGIA ........................................................................................................................................ 64 
5.3 SCRIPTS - PROGRAMAS ADICIONAIS ........................................................................................................ 68 

6 APLICAÇÕES ............................................................................................................................................. 71 

6.1 DESCRIÇÃO DO CENÁRIO ......................................................................................................................... 71 
6.2 CASOS PROPOSTOS PARA ESTUDO ............................................................................................................ 72 

6.2.1 Ajuste A ........................................................................................................................................ 73 
6.2.1.1 Ajuste A - Caso 1: Uma variável de projeto; Contraste de permeabilidade 1:3 ................. 78 
6.2.1.2 Ajuste A - Caso 2: Três variáveis de projeto ...................................................................... 82 
6.2.1.3 Ajuste A - Caso 3: Uma variável de projeto; Permeabilidade constante no reservatório ... 86 

6.2.2 Ajuste B ........................................................................................................................................ 90 
6.2.2.1 Ajuste B - Caso 1: Uma variável; Permeabilidade constante no reservatório ............................ 93 



xii 

 

6.2.2.2 Ajuste B - Caso 2: Uma variável de projeto .............................................................................. 95 
6.2.2.3 Ajuste B - Caso 3: Duas variáveis de projeto ............................................................................ 98 

6.3 PREVISÃO FUTURA................................................................................................................................. 100 

7 CONCLUSÃO ........................................................................................................................................... 104 

7.1 CONSIDERAÇÕES FINAIS ................................................................................................................ 104 

7.2 SUGESTÕES PARA TRABALHOS FUTUROS ................................................................................. 106 

8 REFERÊNCIAS ........................................................................................................................................ 108 

 



xiii 

 

LISTA DE FIGURAS 
 
Figura 1 - Método Quase-Monte Carlo – QMC. ................................................................................................ 33 
Figura 2 - Método Latin Centroidal Voronoi Tesselation – LCVT. ..................................................................... 34 
Figura 3 - Método Latin Hypercube Sampling – LHS. ....................................................................................... 34 
Figura 4 - Divisão em cinco intervalos do domínio de duas variáveis aleatórias (a) distribuição normal (b) 
distribuição uniforme (Penna, 2009). ............................................................................................................... 35 
Figura 5 - Valores sorteados para cada variável (Penna, 2009). ...................................................................... 36 
Figura 6 - Representação bi-dimensional de uma possível amostragem por LHS (Penna, 2009). .................... 36 
Figura 7 - Fluxograma da SAO. ......................................................................................................................... 40 
Figura 8 - Evolução do esquema SAO no problema de otimização [11]. .......................................................... 44 
Figura 9 - Etapas do Ajuste de Histórico (Leitão, 1997). ................................................................................... 53 
Figura 10 - Arquivos de entrada e saída do IMEX. ............................................................................................ 57 
Figura 11 - Interface entre o DAKOTA e o Simulador (Dakota Version 5.0 User’s Manual). ............................ 60 
Figura 12 - Esquema do ajuste de histórico assistido implementado neste trabalho. ..................................... 68 
Figura 13 - Fluxograma dos Scripts. ................................................................................................................. 69 
Figura 14 - Regiões de Permeabilidade Horizontal. .......................................................................................... 74 
Figura 15 - Curva de Produção Acumulada de Óleo Observada – Caso C1. ..................................................... 76 
Figura 16 - Curva de Produção Acumulada de Óleo Observada – Caso C2. ..................................................... 76 
Figura 17 - Curva de Produção Acumulada de Óleo Observada – Caso C3. ..................................................... 77 
Figura 18 - Curva de Produção Acumulada de Óleo Observada – Caso C4. ..................................................... 77 
Figura 19 - Ajuste da Produção de Óleo – Caso C1. .......................................................................................... 80 
Figura 20 - Ajuste da Produção de Óleo – Caso C2. .......................................................................................... 80 
Figura 21 - Ajuste da Produção de Óleo – Caso C3. .......................................................................................... 81 
Figura 22 - Ajuste da Produção de Óleo – Caso C4. .......................................................................................... 81 
Figura 23 - Ajuste da Produção de Óleo – Caso C1. .......................................................................................... 84 
Figura 24 - Ajuste da Produção de Óleo – Caso C2. .......................................................................................... 85 
Figura 25 - Ajuste da Produção de Óleo – Caso C3. .......................................................................................... 85 
Figura 26 - Ajuste da Produção de Óleo – Caso C4. .......................................................................................... 86 
Figura 27 - Ajuste da Produção de Óleo – Caso C1. .......................................................................................... 88 
Figura 28 - Ajuste da Produção de Óleo – Caso C2. .......................................................................................... 89 
Figura 29 - Ajuste da Produção de Óleo – Caso C3. .......................................................................................... 89 
Figura 30 - Ajuste da Produção de Óleo – Caso C4. .......................................................................................... 90 
Figura 31 - Campo base. ................................................................................................................................... 93 
Figura 32 - Campo de permeabilidade constante inicial. ................................................................................. 94 
Figura 33 - Ajuste da Produção de Óleo. .......................................................................................................... 95 
Figura 34 - Ajuste da Produção de Óleo. .......................................................................................................... 97 
Figura 35 - Campo com ajuste de histórico. ..................................................................................................... 98 
Figura 36 - Ajuste da Produção de Óleo. .......................................................................................................... 99 
Figura 37 - Campo com ajuste de histórico. ................................................................................................... 100 
Figura 38 - Previsão futura - Ajuste A – Caso 2 (C1) ....................................................................................... 101 
Figura 39 - Previsão futura - Ajuste A – Caso 2 (C2). ...................................................................................... 102 
Figura 40 – Previsão futura - Ajuste B – Caso 3. ............................................................................................. 103 

 



xiv 

 

LISTA DE TABELAS 
 
Tabela 1 – Etapas do algoritmo SQP (Silva, 2009). ........................................................................................... 25 
Tabela 2 – Procedimentos da estratégia SAO (Silva, 2009). ............................................................................. 43 
Tabela 3 - Termo de aceitação no esquema da região de confiança [11] . ...................................................... 46 
Tabela 4 – Controles independentes do método NPSOL. .................................................................................. 61 
Tabela 5 – Controles dependentes do método NPSOL...................................................................................... 62 
Tabela 6 – Controles SAO no DAKOTA. ............................................................................................................. 62 
Tabela 7 – Controle da Região de Confiança no DAKOTA. ............................................................................... 63 
Tabela 8 - Descrição e parâmetros de entrada do script de pré-processamento. ............................................ 70 
Tabela 9 – Descrição e parâmetros de entrada do script de pós-processamento. ........................................... 70 
Tabela 10 – Restrição no poço. ......................................................................................................................... 72 
Tabela 11 - Resumo das características do modelo base. ................................................................................ 74 
Tabela 12 - Resultado da Otimização- C1. ........................................................................................................ 79 
Tabela 13 - Resultado da Otimização- C2. ........................................................................................................ 79 
Tabela 14 - Resultado da Otimização- C3. ........................................................................................................ 79 
Tabela 15 - Resultado da Otimização- C4. ........................................................................................................ 79 
Tabela 16 - Resultado da Otimização – C1. ...................................................................................................... 83 
Tabela 17 – Resultado da Otimização – C2. ..................................................................................................... 83 
Tabela 18 – Resultado da Otimização – C3. ..................................................................................................... 83 
Tabela 19 – Resultado da Otimização – C4. ..................................................................................................... 83 
Tabela 20 - Resultado da Otimização- C1. ........................................................................................................ 87 
Tabela 21 - Resultado da Otimização- C2. ........................................................................................................ 87 
Tabela 22 - Resultado da Otimização- C3. ........................................................................................................ 87 
Tabela 23 - Resultado da Otimização- C4. ........................................................................................................ 87 
Tabela 24 - Resultado da Otimização. .............................................................................................................. 94 
Tabela 25 - Resultado da Otimização. .............................................................................................................. 96 
Tabela 26 - Resultado da Otimização. .............................................................................................................. 99 

 



15 

 

1 Introdução 

Nos últimos anos, o crescente desenvolvimento da área de simulação 

computacional tem transformado esse recurso em uma ferramenta de uso rotinei-

ro. Esta ferramenta pode fornecer informações que irão auxiliar nas decisões de 

gerenciamento de reservatório durante todo seu ciclo de vida.  

A função da simulação de reservatórios é auxiliar os engenheiros no en-

tendimento do comportamento de um reservatório e, conseqüentemente, predizer 

as taxas de produção em função do tempo. A previsão da produção auxilia os ge-

rentes a decidir sobre a viabilidade do projeto, quando expressa em termos de 

rendimentos e comparada com custos e investimentos. 

A complexidade dos reservatórios de petróleo e a consequente dificuldade 

em modelar o problema com precisão, através de modelos analíticos, fazem com 

que seja necessária a utilização da simulação numérica, a qual permite a obten-

ção de uma previsão do comportamento do reservatório com base em um modelo 

numérico, previamente construído a partir de diversos parâmetros gerados durante 

a caracterização do campo de petróleo. 

No entanto, construir um modelo de simulação que incorpore adequada-

mente a caracterização geológica do reservatório (permeabilidades absolutas e 

relativas, porosidades, compressibilidades, etc.) e reproduza satisfatoriamente as 

informações dinâmicas disponíveis (vazões, pressões, saturações) continua sendo 

uma tarefa árdua. Trata-se de um processo demorado, cuja execução é dividida 

em quatro etapas principais: i) caracterização do campo; ii) definição e construção 

do modelo de simulação; iii) ajuste de histórico de produção; e iv) previsão de pro-

dução. 

Inicialmente, a caracterização do reservatório possui todas as informações 

disponíveis que são utilizadas para conceber modelos geológicos e de fluxo que 

representem adequadamente o campo em estudo. Com estes dados, geram-se 



16 

 

informações sobre a geometria do sistema, propriedades dos fluidos e da rocha, 

assim como distribuições iniciais de pressões e saturações. 

O passo seguinte é a definição e construção de um modelo de simulação 

que contenha adequadamente as características do campo. Nesta etapa são defi-

nidos parâmetros como número de fases (monofásico, bifásico ou trifásico), geo-

metria (retangular, radial, etc.), número de blocos e de camadas e tipo de modelo 

(Black-Oil, composicional, etc.). 

Após a confecção do modelo, pode-se considerá-lo como eficiente se este 

for capaz de desempenhar adequadamente os objetivos do estudo com uma me-

nor quantidade possível de recursos. Geralmente, isto pode ser obtido, desconsi-

derando soluções demasiadamente complexas e que requeiram informações não 

disponíveis. 

Na etapa de ajuste de histórico são realizadas mudanças no modelo de 

simulação de modo que os resultados obtidos por meio da simulação se tornem 

bem próximos dos dados reais de produção do campo. O modelo criado é utilizado 

para realizar previsões futuras do reservatório, provendo subsídios para uma ex-

plotação mais confiável. A qualidade do comportamento da previsão futura será 

tanto melhor quanto maior for o conhecimento do reservatório, obtido através de 

sua melhor caracterização e representação.  

A motivação para este trabalho surgiu da necessidade de desenvolver 

uma metodologia para automatizar o processo de ajuste de histórico de produção 

por um ajuste assistido, em simulação numérica de reservatório de petróleo, atra-

vés da minimização matemática de uma função-objetivo utilizando-se de um mé-

todo de otimização baseado na estratégia de Otimização Aproximada Sequencial 

(SAO). 

A estratégia SAO decompõe o problema original em vários subproblemas 

de otimização, onde cada subproblema é confinado a uma pequena região do es-

paço de projeto [15] [17]. O esquema iterativo de atualização da região de confi-



17 

 

ança proposto por Alexandrov e Dennis foi adotado para obtenção do novo espaço 

de projeto em cada iteração [4].  

Para solução do problema de ajuste de histórico foram empregados o fra-

mework DAKOTA, o simulador IMEX e a linguagem OCTAVE, que trabalharão 

integrados com programas adicionais, com o objetivo de complementar a estrutura 

do sistema computacional através de rotinas necessárias à solução do problema. 

Para cálculo da função-objetivo foram utilizadas as informações históricas 

da produção do reservatório, aqui denominadas “produção observada”, juntamente 

com um histórico de produção obtido através da simulação computacional, aqui 

denominado “produção calculada”. Os valores da produção calculada serão gera-

dos durante a simulação e capturados em um programa específico. Durante o ci-

clo SAO, o otimizador procura encontrar por meio de suas técnicas a solução óti-

ma do problema. 

A dissertação está dividida em sete capítulos: no primeiro capítulo, é apre-

sentada uma breve introdução sobre o tema e uma descrição sumária da solução 

proposta. No segundo capítulo, para um melhor entendimento sobre o assunto, é 

exposta uma breve revisão sobre a otimização, o algoritmo de otimização SQP 

(Sequential Quadratic Programming) e a simulação numérica de reservatório. 

As aproximações são descritas no terceiro capítulo, onde serão definidas 

as metodologias para construção do modelo substituto (metamodelo).  Foram con-

sideradas as funções substitutas da forma funcional baseadas no ajuste de pontos 

(Data Fitting), especificamente usando o método dos mínimos quadrados (MMQ) 

aliado à estratégia da superfície de resposta; assim como as técnicas de amostra-

gens (Design of Experiments - DOE) e o modelo de regressão polinomial. Será 

também apresentada neste capítulo a definição da estratégia de Otimização Apro-

ximada Sequencial (SAO), juntamente com a implementação do esquema da regi-

ão de confiança, necessária para a atualização do espaço de projeto de cada sub-

problema do SAO.   



18 

 

No quarto capítulo é apresentado o conceito de ajuste de histórico e suas 

principais características, bem como a seleção dos algoritmos de otimização. 

Também será abordada a formulação do problema, definindo a função-objetivo, as 

variáveis de projeto e as restrições de limite.   

O quinto capítulo trata da implementação computacional, apresentando o 

conceito das ferramentas utilizadas na solução do problema de ajuste de histórico 

(DAKOTA, IMEX e OCTAVE), bem como a metodologia proposta neste trabalho e 

os programas adicionais integrados ao DAKOTA e ao IMEX. 

O sexto capítulo contém a descrição física e numérica dos modelos de re-

servatório utilizados nas aplicações; a apresentação dos dois ajustes propostos 

para estudo, representados por um campo de permeabilidade com três regiões 

distintas e um campo de permeabilidade estocástico; e a avaliação do comporta-

mento da previsão futura da produção. 

No sétimo capítulo serão resumidas as abordagens feitas nesta disserta-

ção. As conclusões obtidas através dos diversos resultados serão também descri-

tas e discutidas, assim como sugestões que poderão ser estudadas em trabalhos 

futuros. 

A bibliografia consultada é apresentada no final desta dissertação. 

 

 

 

 



19 

 

2 Fundamentação Teórica 

Neste capítulo serão revistos os conceitos básicos associados a alguns 

temas importantes que serão abordados no decorrer da dissertação, por exemplo, 

otimização e simulação computacional. 

2.1 Otimização 

2.1.1 Introdução 

Em um projeto de engenharia está envolvido, normalmente, um grande 

número de variáveis. Cabe ao projetista encontrar uma combinação para estas 

variáveis que resulte em um projeto o mais eficiente e idealmente o mais econô-

mico possível. Normalmente, a determinação desta melhor configuração para os 

parâmetros de projeto depende fundamentalmente da experiência e da intuição do 

projetista. Técnicas de otimização podem ser utilizadas para auxiliar o projetista na 

determinação do projeto ótimo. O objetivo da otimização é encontrar, de acordo 

com o critério escolhido, a melhor solução entre as diversas combinações possí-

veis para as variáveis de projeto, mantendo a viabilidade do projeto, que está as-

sociada a restrições que devem ser satisfeitas [3].  

Uma vez construído um modelo matemático do problema, a formulação do 

problema de otimização pode ser descrita matematicamente pela seguinte expres-

são: 

 

 

 

 



20 

 

Minimize     ( )f x  
Sujeito à:    ( ) 0j ?g x        1j p= K  
                    ( ) 0k =h x        1k q= K  
                  

l u

i i i
? ?x x x

     
1i n= K                                  (2.1) 

                               

onde x , ( )xf , ( )g x , ( )h x , xL e xU  representam, respectivamente, o vetor das 

variáveis de projeto, a função-objetivo, os vetores das restrições de desigualdade 

e igualdade, os limites inferiores e superiores dos vetores das variáveis de projeto. 

Além disto, p , q  e n  representam, respectivamente, o número das restrições de 

desigualdade e igualdade e das variáveis de projeto, e  j , k  e i  os respectivos 

índices das coordenadas dos vetores. 

O vetor x  representa o conjunto das variáveis de projeto cujos valores 

procuramos especificar através do processo de otimização. De maneira genérica, 

se o vetor  x  possui  n  variáveis reais, dizemos que x nR? . 

A próxima entidade presente na Equação (2.1) é a chamada função-

objetivo (.)f , que representa o índice de desempenho do sistema, cujo valor, por 

convenção, queremos minimizar para atingirmos o desempenho ótimo. 

Para simplificar a tarefa de elaborar a teoria matemática de otimização, i-

remos manter a convenção de sempre formular um problema de otimização como 

um problema de minimização. Nos casos em que desejamos fazer uma maximiza-

ção, devido ao significado do índice de desempenho escolhido, basta minimizar-

mos a função que se deseja maximizar multiplicada por -1.  

A otimização procura encontrar por meio de suas técnicas a melhor solu-

ção, no qual o vetor ótimo *x  é igual ao argumento da função (.)f  que faz com 

que essa função atinja seu mínimo valor. 

Para finalizar a formulação contida na Equação (2.1), ainda falta entender 

o significado da igualdade e da desigualdade as quais está sujeito o resultado da 



21 

 

otimização. Essas são as chamadas restrições do problema, que são descritas 

pelas expressões: 

( ) 0?g x   

 ( ) 0=h x  

As restrições do problema significam o conjunto de requisitos que o resul-

tado do projeto deve atender para ser admissível enquanto solução.  

Para concluir este tópico, definimos a seguinte nomenclatura, relacionada 

às restrições: 

• Região Viável: Conjunto de pontos do espaço nR  que satisfaçam, simulta-

neamente, a todas as restrições (tanto de desigualdade quanto de igualda-

de).  

• Região Inviável: Conjunto dos pontos do espaço nR , que deixam de satisfa-

zer (ou seja, violam) pelo menos uma das restrições do problema. 

• Ponto Viável: Ponto pertencente à região viável. 

• Ponto Inviável: Ponto pertencente à região inviável. 

• Restrição Violada: Cada uma das componentes do vetor ( )g x  que apresen-

tar valor positivo, ou cada uma das componentes do vetor ( )h x  que apre-

sentar valor não-nulo será chamada de restrição violada no ponto x . 

 

O processo de otimização é realizado através da implementação de algo-

ritmos, cujo objetivo é determinar as soluções do problema (Equação (2.1)).  Es-

ses algoritmos irão requerer a avaliação da função-objetivo e de restrição, deven-

do, entretanto fazer estas avaliações um menor número de vezes que for possível.  

A função-objetivo do nosso problema será definida como a norma da dife-

rença entre um histórico de produção observado e um histórico de produção obti-

do através da simulação computacional e como candidatas as variáveis de projeto, 

teremos as permeabilidades absoluta, que devem ser escolhidas de forma a en-

contrar a melhor solução entre as diversas configurações possíveis. 



22 

 

2.1.2 Programação Quadrática Sequencial - SQP 

Nesta dissertação o problema apresentado na Equação (2.1) será solucio-

nado utilizando o algoritmo de programação quadrática sequencial (SQP) aplicada 

a problema de otimização não linear. 

A programação quadrática sequencial pode ser considerada como o resul-

tado da aplicação do método de Newton à minimização de uma aproximação qua-

drática da função Lagrangeana do problema [29]. 

O algoritmo SQP usado neste trabalho utiliza um método baseado num 

esquema de procura unidimensional e envolve dois processos iterativos - um in-

terno e outro externo. No processo iterativo interno resolve-se um subproblema 

quadrático para determinar a direção de busca. Uma vez encontrada, o processo 

iterativo externo calcula uma nova aproximação da Hessiana da função de La-

grange, que é atualizada com a aproximação Quasi-Newton BFGS (Broyden-

Fletcher-Goldfarb-Shanno) [32].  

A seqüência de aproximações geradas pelo processo iterativo externo 

converge para um ponto que verifica as condições de primeira ordem ou KKT (Ka-

rush-Kunn-Tucker) : 

1. Viabilidade: 

( )
( )

*

*

0,        1, ,

0,        1, ,

j

k

g j p

h k q

? = …

= = …

x

x
                                                                                       (2.2) 

 
 

2. Estacionaridade:  

( ) ( ) ( ) ( )* * * * * * *
1 1

, 0
p q

x j j k k

j k

L f g h
= =

? = ? + ? + ? =? ?x ? x ? x ? x
                           

 (2.3)      

 
 

onde ( )* *,L x ?  é a função Lagrangeana dada pela expressão a seguir: 



23 

 

( ) ( ) ( ) ( )* * * * * * *
1 1

,
p q

j j k k

j k

L f g h
= =

= + +? ?x ? x ? x ? x                  (2.4) 
 

onde *? é o vetor com os multiplicadores de Lagrange associados às restrições de 

igualdade e desigualdade no ponto *x . 

 

3. Complementaridade: 

( )* 0,         1j jg j p= = …? x                                                                 (2.5) 
 

 

4. Positividade: 

0, 1, ,
j

 j p? = …?                                                                                                 (2.6)      
 
Para determinadas classes de problemas de programação matemática as 

condições KKT são suficientes para a determinação de solução ótima global. 

No algoritmo de otimização é fornecido um ponto inicial 0x  e o projeto é 

então atualizado modificando x  através da equação (2.7). 

1t t t??= +x x d                                                                                             (2.7)

    

onde 

 
t

x  é o ponto atual  na iteração t  

  t  é o índice que indica o número da iteração 

 [ ]T1 2, , , nd d d=d K é o vetor que indica a direção de busca e a direção viável 

para qual o valor de ( )f x decresce 

 ? é o tamanho do passo na direção de d  

 Uma sequência de subproblemas quadráticos é resolvida no algoritmo SQP 

e a função-objetivo é uma aproximação quadrática da Lagrangeana. 



24 

 

O algoritmo SQP utiliza a informação de segunda ordem da função a oti-

mizar, sendo assim a função ( )f x  é expandida até a segunda ordem, ou seja, a 

expansão de Taylor em x , de acordo com:  

( ) ( ) ( ) ( )T 2
1

2
f f f L= + ? + ?Tx x d x d x d                                                      (2.8)

onde = ?d x x  é a direção de busca e ( )f? x  é o vetor gradiente de f  em x , de 

quem os elementos são definidos por: 

i

i

f
f

x

?
? =

?
                                                                                                                     (2.9) 

 

e ( )2L? x  é a Hessiana da função de Lagrangeana ( )* *,L x ?  (Equação  (2.4)) que 
é atualizada a cada iteração: 

( ) ( ) ( ) ( )2 * * 2 * * 2 * * 2 *
1 1

,
p q

j j k k

j k

L f g h
= =

? = ? + ? + ?? ?x ? x ? x ? x                      (2.10) 

 

Na Tabela 1 são apresentadas as principais etapas envolvidas no algorit-

mo SQP convencional [38]. 

 

 

 

 

 

 

 

 

 

 

 

 

 



25 

 

Tabela 1 – Etapas do algoritmo SQP (Silva, 2009). 

Etapa Descrição 

SQP 1. Estabelecer uma solução inicial  0x ; 

SQP 2. 
Configurar uma aproximação inicial para a matriz Hessiana dos termos 
quadráticos da função-objetivo; 

SQP 3. Resolver o subproblema para encontrar a direção de busca d; 

SQP 4. 
Realizar uma busca linear para determinar o tamanho do passo ?  na 
direção d; 

SQP 5. Atualizar a solução, remetendo-a para a posição indicada; 

SQP 6. Verificar a convergência do algoritmo SQP: 

 6.1. Se o mínimo local for encontrado: o processo termina. 

 6.2. 
Caso contrário: atualiza-se a matriz Hessiana via o esquema BFGS e 
volta para o passo SQP 3. 

 

2.2 Simulação Numérica de Reservatórios 

A importância da indústria do petróleo vem crescendo desde a segunda 

metade do século XIX, quando o primeiro poço entrou em produção, em Titusville, 

Pensilvânia, sob o comando do coronel Drake. Desde então, verificou-se uma acir-

rada corrida em busca da descoberta de novos campos. A indústria do petróleo 

tem um papel importante no cenário mundial. A participação do óleo e gás natural 

na matriz energética mundial indica uma forte dependência desta forma de energia 

não renovável [43]. Considerando que somente uma parte do petróleo existente no 

mundo pode ser produzida economicamente, se faz necessária uma busca contí-

nua dos meios para aumentar sua recuperação. Para tanto, é importante um co-

nhecimento cada vez melhor dos mecanismos de produção que afetam a recupe-

ração de petróleo com impacto nas previsões de produção. Estas, em última aná-

lise, afetam diretamente a economicidade dos projetos, viabilizando projetos de 

desenvolvimento de campos petrolíferos. 



26 

 

A engenharia de reservatórios é responsável pelo estudo do escoamento 

dos fluidos dentro do meio poroso, cálculo das reservas, definição dos métodos de 

recuperação secundária e terciária, esquemas de desenvolvimento do campo, en-

tre outros. 

A simulação numérica é uma das mais poderosas ferramentas para guiar 

decisões de gerenciamento de reservatório em todos os estágios de vida de um 

reservatório de petróleo. Um simulador numérico contendo informações corretas 

pode simular o comportamento de um reservatório, predizendo sua produção sob 

condições de operação corrente, ou a reação dele mediante alteração dessas 

condições. 

A função da simulação do reservatório é auxiliar os engenheiros a enten-

der o comportamento de um reservatório e conseqüentemente predizer as taxas 

de produção como uma função do tempo. A previsão da produção futura, quando 

expressa em termos de rendimentos e comparada com custos e investimentos, 

auxilia os gerentes a decidirem sobre a viabilidade do projeto. 

Os princípios que fundamentam a simulação numérica são bastante sim-

ples. Em primeiro lugar, princípios fundamentais como a conservação de massa e 

energia, leis constitutivas e equações de estado são usadas para determinar os 

sistemas de equações diferenciais parciais que regem o escoamento do fluido em 

meios porosos. Com o emprego de uma técnica de discretização, como o método 

das diferenças finitas ou de volumes finitos, por exemplo, o sistema de equações 

diferenciais parciais é transformado em um sistema de equações algébricas que 

pode ser resolvido diretamente em um computador digital.   

No processo de discretização, o volume do reservatório é tratado com um 

conjunto numerado de blocos e o período de produção do reservatório é dividido 

em um numero finito de etapas de tempo.  

Existem vários simuladores que possuem uma variedade de característi-

cas e eles em geral se encaixam em duas categorias principais. Na primeira cate-

goria estão os simuladores “black-oil”, para reservatórios contendo água, gás e 



27 

 

óleo. Na segunda categoria estão os simuladores térmicos e composicionais, para 

reservatórios que requerem descrição mais detalhada da composição do fluido.  

Nesta dissertação será usado o simulador IMEX (IMplicit EXplicit black oil 

simulator), que é um programa de simulação de reservatórios bastante conhecido 

no mundo e, em particular, muito usado pela Petrobras. Este software desenvolvi-

do pela CMG (Computer Modelling Group Ltd.) é um simulador trifásico que utiliza 

o modelo “black-oil”, e suporta malhas cartesianas, malhas cilíndricas, malhas re-

gulares com profundidade e espessura variáveis, e malhas de vértices (corner-

point), com configurações em duas ou três  dimensões [08]. 



28 

 

3 Aproximações 

3.1 Introdução 

Dentro da atividade de Engenharia de Petróleo, onde há uma busca cons-

tante por projetos otimizados e eficientes na produção e desenvolvimento de re-

servas de petróleo, modelos aproximados (metamodelos) estão sendo bem utili-

zados. 

O uso de ferramentas de otimização com simulações em projetos de en-

genharia de petróleo, às vezes, torna-se inviável, devido a soluções que tomam 

muito tempo para serem encontradas por resultarem em simulação complexa e/ou 

demoradas. Esse elevado custo computacional é devido principalmente a grande 

quantidade de simulações numéricas realizadas durante o processo, uma vez que 

este procedimento requer sucessivas avaliações das funções e suas derivadas. 

Neste capitulo é apresentado uma alternativa para este tipo de problema 

de otimização. Isto é feito utilizando-se funções substitutas - que são menos cus-

tosas de serem realizadas, no qual amenizam o esforço computacional gerado 

durante o processo de otimização existente para esta classe de aplicação. Desta 

maneira, torna-se viável a utilização de um algoritmo de otimização, sem a neces-

sidade de executar o simulador numérico de uma forma intensiva.  

As funções substitutas têm sido utilizadas objetivando uma resposta com-

putacional rápida, e também para se obter um comportamento mais suave e/ou 

simplificada das funções caras computacionalmente (alta fidelidade), isto é, livres 

de ruído numérico, que é um problema típico de funções avaliadas a partir de um 

procedimento numérico. O fator essencial na aproximação é substituir as funções 

de alta fidelidade (custosas) por funções mais simples de serem calculadas (fun-

ções substitutas) e usar essas funções durante o processo de otimização. 



29 

 

As aproximações podem ser classificadas, segundo o seu intervalo de a-

plicabilidade no espaço de projeto. Consequentemente, três grupos distintos po-

dem ser definidos [5]: 

1. Aproximações locais: São válidas apenas em uma vizinhança próxima 

de onde as funções foram criadas.   Durante o processo da otimização 

os resultados da função real são comparados a cada iteração com os 

da função aproximada, resultando em uma consistência entre os dois 

modelos. Este tipo é mais apropriado quando se faz o uso do processo 

iterativo.  Esta estratégia de otimização é comumente referida na litera-

tura como Sequential Approximation Optimization (SAO) [15], aqui tra-

duzida como Otimização Sequencial Aproximada; 

2. Aproximações globais: Ocorre quando é necessário obtermos uma i-

déia geral da função investigada em todo o espaço de projeto. Tais a-

proximações serão criadas construindo uma superfície de resposta 

global utilizando modelo por ajuste de pontos (Data Fitting); 

3. Aproximações de médio-alcance: Tenta dar um aspecto global para as 

aproximações do tipo locais, ou seja, é a combinação entre ambos os 

tipos. 

As aproximações podem assumir as seguintes formas [28]: 

1. Funcional: a aproximação da função real é obtida pela interpolação de 

valores conhecidos da função-objetivo; 

2. Física: os modelos são criados a partir de modelos físicos simplifica-

dos; 

3. Híbrido: modelos resultantes da combinação entre os modelos físico e 

funcional. 

 No presente trabalho apenas as funções substitutas baseadas no modelo 

funcional serão utilizadas e esta técnica será discutida com mais detalhes a se-

guir. 



30 

 

3.2 Funções Substitutas baseadas no Modelo Funcional  

A forma funcional pode ser baseada em séries numéricas (baseadas em 

expansão por série de Taylor) ou superfícies de respostas obtidas através do ajus-

te de pontos.  

Apenas as funções substitutas da forma funcional baseadas no ajuste de 

pontos (Data Fitting), especificamente usando o método dos mínimos quadrados 

(MMQ) aliado à estratégia da superfície de resposta serão abordado neste traba-

lho. As técnicas de ajuste de pontos são geralmente selecionadas quando um mo-

delo físico simplificado não é possível de ser obtido. A forma funcional aqui estu-

dada é em termos de funções aproximadas que podem ser escritas com uma ex-

pressão matemática dependente de parâmetros calculados por técnicas de ajuste 

de superfícies.  

3.2.1 Método de Superfície de Resposta 

O método de Superfície de Resposta (SR) foi desenvolvido por Box e Wil-

son em 1951 [6]. Este método descreve a função resposta em termos de uma su-

perfície, buscando ajustar um polinômio à função-objetivo, que é obtido a partir do 

modelo de regressão. 

Observa-se que tal modelo é preciso apenas quando uma pequena região 

do espaço do projeto é investigada. Entretanto, esta técnica é largamente utilizada 

nas mais diversas áreas, devido à fácil aplicação e simplicidade na obtenção do 

modelo aproximado [38]. 

A otimização gerada a partir da SR possui uma grande vantagem em 

comparação com os demais métodos por não necessitar do cálculo dos gradientes 

das funções do modelo de alta precisão (custosas), como também possibilita a 



31 

 

suavização dos resultados provenientes das análises e/ou experimentos ao se 

utilizar regressões de baixa ordem (lineares, quadráticas, ou cúbicas). 

O método dos mínimos quadrados (MMQ) é um dos métodos de ajuste de 

pontos bastante empregado. Usando este método (MMQ), expressões analíticas 

são formuladas e usadas em substituição às funções do modelo de alta precisão. 

Para construir uma forma analítica aproximada é necessário gerar uma 

amostra representativa do espaço de projeto através de técnicas de amostragem 

(Design of Experiments - DOE) e um modelo de regressão, que serão apresenta-

dos com mais detalhes nas próximas sessões.  

Para um vetor de entrada x  a função aproximada considerando a estraté-

gia da superfície de resposta terá o modelo de regressão descrito abaixo [38]: 

( ) ( )
1

ˆ
k

T

SR j j

j

f N?
=

= =?x N x ?                                                                        (3.1)

onde ( )N x  representa um vetor do modelo de regressão a ser escolhido:  

( ) ( ) ( )1 kN N= ? ?? ?N x x xL                                                                                    (3.2) 

?  é o vetor dos coeficientes do modelo de regressão a ser determinado, 

que é formulado na equação abaixo: 

 T
S
?f ?NNNN                                                                                                                      (3.3)

onde:  

 [ ]0 1
T

k
? ? ?=? L                                                                                                       (3.4)

 k   é o número de elementos em ?  e ( )N x  

  
S

f  é um vetor de tamanho m  que contém os resultados da função real ava-

liados nos pontos de uma amostra [ ]1 m=S x xL :  

 ( ) ( ) ( )1S mf f f= = ? ?? ?f S x xL  
 m  é a dimensão da amostra 

 Considerando a amostra S , os termos da forma polinomial de regressão 

constroem uma matriz NNNN  formada por m  linhas e k  colunas, dada por [38]:

      

 



32 

 

 

( ) ( )

( ) ( )

1 1 1

1

k

m k m

N N

N N

? ?
? ?

= ? ?
? ?? ?

x x

x x

L

M O M

L

NNNN                                                                       (3.5)

Os termos do vetor ?  são a solução do problema de regressão, definido pela E-

quação (3.3), o qual é resolvido usando o método dos mínimos quadradas definido 

abaixo [38], 

( )
1

T T

S

?
=? fN N NN N NN N NN N N                                                                                                       (3.6) 

onde para que o termo 
T

N NN NN NN N  exista, é necessário que as linhas da matriz NNNN  se-

jam linearmente independentes. Sendo assim, ao substituirmos o vetor  ?  na E-

quação (3.1), podemos calcular o valor aproximado da função 
S?R
f  em qualquer 

ponto do espaço de projeto.  

3.2.2 Técnicas de Amostragem  

O primeiro passo para construção de metamodelos por ajuste de pontos é 

gerar um conjunto de pontos (amostra) que sejam únicos e limitados pelo limite 

inferior e superior do espaço de projeto. Estas técnicas são conhecidas na literatu-

ra como Design of Experiments (DOE) [18][14], aqui traduzida como técnica de 

amostragem.  

A técnica de amostragem é uma técnica estatística para planejar, executar 

e analisar experimentos, ou seja, para definir quais dados, em que quantidade e 

em que condições devem ser coletados durante um determinado experimento, 

buscando, basicamente, satisfazer dois grandes objetivos: a maior precisão esta-

tística possível na resposta  e o menor custo. 

Como a localização dos pontos da amostra pode influenciar o modelo cri-

ado, pois em cada ponto da amostra a função real é avaliada, para se obter um 



33 

 

bom modelo substituto a seleção da amostra é uma importante etapa, especial-

mente quando o tempo da análise para um único experimento é longo. Portanto 

deve-se obter uma amostra “representativa” do espaço de projeto com um menor 

número possível de amostras, que assegure a precisão do modelo aproximado 

com relação ao modelo real. Tal amostra pode ser obtida a partir de diversos mé-

todos disponíveis, dos quais podemos citar: Hipercubo Latino (Latin Hypercube 

Sampling (LHS)), Vetor Ortogonal (Orthogonal Array (OA)), Ladrilhamento de Vo-

ronoy Latinizado (Latinized Centroidal Voronoi Tessellation (LCVT)), Quasi Monte 

Carlo (QMC), Amostragem Randômica Simples (Simple Random Sampling (SRS)) 

[11]  

As figuras abaixo demonstram a distribuição de três diferentes amostras 

contendo 20 pares ordenados (x,y). 

0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75
0.25

0.3

0.35

0.4

0.45

0.5

0.55

0.6

0.65

0.7

0.75
QMC - Sampling

 
Figura 1 - Método Quase-Monte Carlo – QMC. 

 



34 

 

0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75
0.25

0.3

0.35

0.4

0.45

0.5

0.55

0.6

0.65

0.7

0.75
CVT - Sampling

 
Figura 2 - Método Latin Centroidal Voronoi Tesselation – LCVT. 

 

0.25 0.3 0.35 0.4 0.45 0.5 0.55 0.6 0.65 0.7 0.75
0.25

0.3

0.35

0.4

0.45

0.5

0.55

0.6

0.65

0.7

0.75
LHS - Sampling

 
Figura 3 - Método Latin Hypercube Sampling – LHS. 

 

 

As amostras LCVT e LHS resultaram em uma melhor distribuição. No en-

tanto, apenas amostras do tipo LHS serão consideradas neste trabalho, porque 

resultado de estudos anteriores realizado por trabalho de pesquisa [07] para avali-

ação das amostras LHS, LCVT e QMC, demonstraram melhor resultado ao utilizar 

este tipo de amostra. 

No método de amostragem hipercubo latino (LHS), desenvolvido por Mc-

Kay, Conover, e Beckman em 1979, o domínio de cada variável aleatória 
k
x  é di-



35 

 

vidido em n  intervalos ( )1ikx n? L , de igual probabilidade
1

n
 [27], onde 1k m= L  e  

m  número total de pontos da amostra. 

 
Figura 4 - Divisão em cinco intervalos do domínio de duas variáveis aleatórias (a) distribui-

ção normal (b) distribuição uniforme (Penna, 2009). 
 

Na Figura 4 são apresentadas duas variáveis aleatórias, uma tendo distri-

buição normal e outra, distribuição uniforme. Neste exemplo, o domínio de cada 

variável foi dividido em cinco intervalos. 

O número de intervalos n deve ser igual ao tamanho da amostra desejada. 

Para cada intervalo é amostrado apenas um valor i
k
x , que para um valor i  qual-

quer, são obtidos pela resolução da Equação (3.7) [33]: 

( ) 1i ik k
i

x
n

? +
=

R
F                                                                                                        (3.7) 

Onde:  

 
k

F  é a função de distribuição de probabilidade 

 
i

R  representa uma distribuição uniforme no intervalo [0,1] 

 1i n= L  

A amostragem é realizada utilizando a transformada inversa da função de 

distribuição de probabilidade em questão, conforme: 

( ) 1 1i ik k
i

x
n

? ? +? ?= ? ?
? ?

R
F                                                                                  (3.8) 



36 

 

Para um melhor entendimento sobre o LHS, suponha uma distribuição bi-

variada, onde uma variável tem distribuição normal e a outra uniforme. Na Figura 5 

são apresentados os cincos valores sorteados para cada uma das variáveis, sen-

do que foi sorteado um valor para cada intervalo. 

 

 
Figura 5 - Valores sorteados para cada variável (Penna, 2009). 

 

Depois de obtidos os n  valores para cada variável 
k
x , esses devem ser 

emparelhados de forma aleatória com os valores das demais variáveis. Dessa 

forma, são formados n  vetores de dimensão m . A seleção aleatória do i-ésimo 

valor para cada variável é realizada mediante a permutação aleatória dos inteiros 

1 nL .  Na Figura 6 é apresentada uma possível amostra de cinco pontos gerados 

utilizando a amostra LHS do exemplo anterior. 

 
Figura 6 - Representação bi-dimensional de uma possível amostragem por LHS (Penna, 

2009). 



37 

 

Observa-se que a amostra de n  pontos da amostra do tipo LHS de di-

mensão m  contém apenas um ponto em cada intervalo de cada uma das m  vari-

áveis. 

3.2.3 Modelo de Regressão Polinomial 

Regressão Polinomial, Kriging, Processo Gaussianos (GP), Redes Neurais 

Artificiais (ANN), Multivariate Adaptive Regression Splines (MARS), dentre outros, 

são métodos utilizados para construção de modelos substitutos (metamodelos) por 

ajuste de pontos, que são aproximações do tipo global que buscam aproximar o 

comportamento global da função. Neste estudo foram realizados testes com os 

métodos de Regressão Polinomial, Kriging e Processo Gaussianos. O modelo de 

Regressão Polinomial foi selecionado porque apresentou o melhor resultado em 

comparação com os outros dois. 

Estatisticamente, usa-se o método de análise de regressão quando o pro-

blema envolve uma única variável dependente (resposta do modelo polinomial), 

considerada relacionado a duas ou mais variáveis independentes (variáveis do 

projeto), cujos valores são conhecidos, para prever os valores da variável depen-

dente selecionada [10]. 

O modelo de regressão polinomial é uma extensão da regressão linear, ou 

seja, ocorre quando se adiciona termos polinomiais ao modelo básico de regres-

são linear.  

Utiliza-se este modelo em duas situações:  

1. Quando a função de resposta curvilínea verdadeira é realmente uma função 

polinomial. 

2. Quando a função de resposta curvilínea verdadeira é desconhecida (ou 

complexa), porém, uma função polinomial é uma boa aproximação para a 

função verdadeira.  



38 

 

Neste projeto tem-se a segunda opção. Um perigo no uso de regressão 

polinomial é que sua extrapolação pode ser imprevisível, ou seja, pode assumir 

direções não esperadas quando extrapolados além do intervalo observado. 

De acordo com a ferramenta de otimização (DAKOTA) utilizada neste tra-

balho, os modelos polinomiais podem ter a forma linear (primeira ordem), quadrá-

tico (segunda ordem) e cúbico (terceira ordem) [11]. 

Os modelos polinomiais, em geral, podem ter a forma linear (primeira or-

dem), quadrático (segunda ordem), cúbico (terceira ordem) ou de ordem “n” [11]. 

A forma do modelo polinomial linear é:   

( ) 0
1

ˆ
n

i i

i

f
=

= + ?x c c x                                                                                      (3.9)

 Na forma do modelo polinomial quadrático teremos: 

( ) 0
1 1

ˆ
n n n

i i ij i j

i i j i

f
= = ?

= + +? ??x c c x c x x                                                                (3.10)

 E a forma do modelo polinomial cúbico é: 

( ) 0
1 1 1

ˆ
n n n n n n

i i ij i j ijk i j k

i i j i i j i k j

f
= = ? = ? ?

= + + +? ?? ???x c c x c x x c x x x                                       (3.11) 

Em todos os modelos polinomiais, ( )f? x  é a resposta do modelo polinomi-

al; os termos i j, kx , x , x  são os componentes dos valores do parâmetro de projeto 

(variáveis preditoras) n-dimensionais; os termos 0, ,, , ,i j kc c c c são os coeficientes 

polinomiais, e n  é o número de parâmetros de projeto.  

O número de coeficientes 
c
n , depende da ordem do modelo polinomial e 

do número de parâmetros de projeto. Para o polinômio linear temos: 

1
clinear
n n= +  

Para o polinômio quadrático temos: 

( )( )1 2
2

cquad

n n
n

+ +
=  

E para o polinômio cúbico: 



39 

 

( )3 26 11 6
6

ccubico

n n n
n

+ + +
=  

A utilidade dos modelos polinomiais decorre de duas fontes: sobre uma 

pequena parcela do espaço de parâmetro, um modelo de baixa ordem polinomial 

é frequentemente uma aproximação exata às tendências dos dados verdadeiras e 

quando o procedimento dos mínimos quadrados fornece um ajuste de superfície 

que suaviza o ruído nos dados. Por esta razão, a estratégia de otimização basea-

da em aproximação muitas vezes é bem sucedida quando utiliza modelos polino-

miais, particularmente o modelo quadrático [11]. 

3.2.4 Otimização por Aproximação Sequencial (SAO) 

São aproximações do tipo local, que só são válidas em uma vizinhança 

próxima de onde as funções foram criadas. Serão consideradas como função 

substituta as funções baseadas no ajuste de pontos criado a partir do método da 

superfície de resposta. 

Na otimização por aproximação sequencial, o algoritmo de otimização vai 

operar sobre um modelo substituto, de baixo custo computacional, ao invés de se 

fazer uso das respostas obtidas da simulação real, necessárias em diversas cha-

madas no processo de otimização. A construção deste modelo substituto implica 

em uma menor quantidade de chamada do simulador. 

A Figura 7 descreve o fluxograma da estratégia de otimização por aproxi-

mação baseadas no ajuste de pontos, onde inicialmente será gerada uma amostra 

(conjunto de pontos) num espaço de projeto através da técnica de amostragem 

(Design of Experiments - DOE). Durante o processo de simulação será construído 

o modelo substituto (metamodelo) de acordo com o número de amostras definida 

inicialmente, e em seguida será iniciado o ciclo SAO que vai buscar minimizar a 



40 

 

função-objetivo da Equação (4.1). O capítulo 5 fornece maiores informações acer-

ca deste processo. 

 

Técnicas de Amostragem (DOE)
Selecionar conjuntos de pontos 
numa sub-região do espaço de 

projeto 

Simulação
Sistema adicionais usando 
métodos computacionais

Metamodelos
Construção do modelo matemático 

aproximado

Otimização
Encontrar a solução ótima 

aproximada

Esquema da Região de 
Confiança

Atualizar uma nova sub-região do 
espaço de projeto  

Figura 7 - Fluxograma da SAO. 
 

   

O problema original de otimização é decomposto em uma sequência de 

subproblemas na metodologia SAO, que é limitada dentro de uma sub-região do 

espaço do projeto. A estratégia da Região de Confiança (RC) ou Trust Region é 

usada para controlar o processo de otimização a manter a exatidão aceitável entre 

o modelo substituto e o real (cara computacionalmente), onde as variáveis do pro-

jeto são atualizadas em cada subproblema (iteração SAO) [2]. 

 Matematicamente cada subproblema de otimização pode ser descrito por: 



41 

 

 

Minimize     ( )zf x
)

 

Sujeito à:    ( ) 0zj ?g x
)

       1j p= K  

                    ( ) 0zk =h x
)

         
1k q= K

 

                  
z z

l l u u
? ? ? ?x x x x x

                                        
(3.12) 

 

onde       
2

z

z z

l c

?
= ?x x  

     
2

z

z z

u c

?
= +x x                                                                                                               (3.13)

 Os termos  ( )zf x
)

, ( )zjg x
)

 e ( )zih x
)

 da Equação (3.12) são respectivamente 

a função substituta da função objetivo, da restrição de desigualdade e da restrição 

de igualdade. 

onde: 

 z
c

x  = ponto central da região de confiança 

 z?  = tamanho da região de confiança 

 z
l

x = limites inferiores da região de confiança 

 z
u

x = limites superiores da região de confiança 

 z = número da iteração SAO 

 

Durante o processo SAO em cada iteração z  é definido um subproblema 

descrito nas equações (3.12) e (3.13). Na primeira iteração SAO ( 1z = ) é calcula-

do inicialmente o tamanho da região de confiança ( z? ), onde os limites iniciais da 

RC assumem um percentual do espaço do projeto, definido pelos limites inferiores 

e superiores da variável do projeto, já o ponto central da região de confiança ( z
c

x ) 

assume o valor do ponto inicial da variável de projeto. 

 Ao resolver a Equação (3.12), um ponto ótimo aproximado *
zx  é encontra-

do. Em seguida, é calculada a função real no ponto ótimo encontrado. A conver-

gência é então verificada de acordo com os critérios adotados, se alcançada a 



42 

 

solução ótima é obtida e o processo é finalizado com sucesso. Caso contrário, o 

processo SAO continua com uma próxima iteração ( 1z z= + ) e a atualização de 

uma nova sub-região, através do esquema da região de confiança. Na próxima 

iteração é necessário determinar o próximo ponto central 1z
c

+x  e o novo tamanho 

1z+?  para a nova sub-região, esses valores são determinados através de uma 

comparação entre os valores do ponto central z
c

x  e o ótimo *
zx  da iteração corren-

te, conforme será descrito na Tabela 2. 

Antes de começar a nova iteração 1z + , pode-se impor um fator de corre-

ção entre o modelo real e aproximado de modo à melhor a precisão do modelo 

substituto. O procedimento é então repetido até que o procedimento encontre a 

convergência do processo ou atinja-se o número máximo de iterações permitido 

[38]. 

Na Tabela 2 são apresentados os principais procedimentos implementa-

dos na estratégia SAO [38]. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



43 

 

 

Tabela 2 – Procedimentos da estratégia SAO (Silva, 2009). 

Etapas Descrição 

SAO 1. Assumir o tamanho e ponto inicial da região de confiança; 

SAO 2. 
Computar as funções objetivo e restrições reais no ponto central da 
sub-região; 

SAO 3. 
Construir as funções substitutas (aproximadas) localmente para as fun-
ções objetivo e restrições; 

SAO 4. 
Otimizar o problema usando as funções aproximadas, onde as variá-
veis de projeto são limitadas pelas fronteiras da sub-região; 

SAO 5. 
Recalcular as funções objetivo e restrições reais no ponto ótimo encon-
trado; 

SAO 6. Verificar os critérios de convergência internos do otimizador: 

 6.1. 
Se alcançada: o problema da iteração z  está resolvido, continue com o 
processo. 

 6.2. 
Caso contrário: a função aproximada não é adequada, o processo é 
finalizado. 

SAO 7. 
Manter/reduzir/aumentar a nova sub-região de acordo com o esquema 
da região de confiança; 

SAO 8. 
Impor (fator de correção) a consistência entre o modelo real e o substi-
tuto; 

SAO 9. Verificar os critérios de convergência global da estratégia SAO: 

 9.1. 
Se alcançada: o projeto ótimo é obtido, o processo é finalizado com 
sucesso. 

 9.2. Caso contrário: voltar para o passo SAO 3. 

 

A figura abaixo ilustra um problema de otimização utilizando o processo i-

terativo e sequencial do esquema SAO. Os quadrados denotam uma sub-região 

de cada subproblema resolvido durante a iteração SAO. Os pontos dentro de cada 

sub-região são caracterizados pela amostras de dados, que são usadas para ge-

rar um modelo substituto, no qual o algoritmo de otimização vai operar sobre um 

modelo substituto, ao invés do problema original [11].  

 



44 

 

 
Figura 8 - Evolução do esquema SAO no problema de otimização [11]. 

 

Como já foi citado anteriormente, durante o processo SAO, pode ser esta-

belecida uma correção entre o modelo real e aproximado, que assegure a igual-

dade entre o modelo real e aproximado no ponto central de cada região de confi-

ança de modo a melhorar a precisão do modelo substituto.  Este procedimento 

assume a correção do tipo aditiva, multiplicativa ou função de correção combina-

da, sendo cada uma associada a diferentes níveis de correção, ou seja, de ordem 

zero, primeira ordem ou segunda ordem. 

A cada subproblema (nova iteração SAO) será corrigido a partir da esco-

lha de um nível de correção. O termo de correção será expresso por procedimen-

tos baseados na expansão na série de Taylor. 

Cada nível de correção será obtido a partir das considerações ou não dos 

termos da série de Taylor, ou seja, a ordem zero será apenas considerada o termo 

constante da série de Taylor, a primeiro ordem é obtido a partir da ordem zero adi-

cionado o termo da primeira derivada e a segunda ordem a partir da primeira or-

dem adicionado o termo da segunda derivada. 

A correção de modelo substituto com o fator de correção aditiva e multipli-

cativa assume a seguinte forma: 

( ) ( )( )f f ?= +x x x
)

                                                                                 (3.14)    

  ( ) ( )( )f f ?=x x x
)

                                                                                (3.15)

onde: 



45 

 

  ( )? x   = Correção aditiva    

 ( )? x  = Correção multiplicativa 

De forma geral, ( )? x  e ( )? x  podem ser calculados por aproximação na 

série de Taylor de primeira ou segunda ordem, conforme mostrado nas equações                    

(3.16) e (3.17), respectivamente. 

 

( ) ( ) ( ) ( )Tc c cA A? = + ? ?x x x x x  

( ) ( ) ( ) ( ) ( ) ( )( )2
1
2

T T

c c c c c c
A A A? = + ? ? + ? ? ?x x x x x x x x x x                    (3.16)

    ( ) ( ) ( ) ( )Tc c cB B? = + ? ?x x x x x  

( ) ( ) ( ) ( ) ( ) ( )( )2
1
2

T T

c c c c c c
B B B? = + ? ? + ? ? ?x x x x x x x x x x                    (3.17)  

onde: 

 ( ) ( ) ( )A f f= ?x x x
)

 

 ( )
( )
( )

f
B

f
=

x
x

x
)  

 ( )f x   = função real  

 ( )f x
)

 = função substituta 

 

As correções de primeira ordem, tanto a aditiva como a multiplicativa, ne-

cessitam da primeira derivada, ou seja, dos gradientes, para a construção do mo-

delo substituto, enquanto que as correções de segunda ordem necessitam do cál-

culo da segunda derivada, ou seja, da matriz Hessiana. 

Conforme citado anteriormente durante o processo SAO, o esquema da 

região de confiança é necessário para atualizar o novo espaço de projeto em cada 

sub-região. Após cada iteração z  do SAO, uma aproximação dá forma à relação 

da região da confiança através do termo de aceitação da função-objetivo z? , que 



46 

 

mede a melhoria real em relação à prevista durante a otimização do modelo subs-

tituto.  

( ) ( )
( ) ( )

*

*

z z

cz

z z

c

f f

f f
?

?
=

?

x x

x x
) )                                                                                  (3.18) 

 Onde: 

  z  = índice da iteração SAO   

 z?  = termo de aceitação da função-objetivo  

 z
c

x  = ponto central da sub-região z  

 *
zx  = ponto ótimo da sub-região z   

Uma vez calculado o termo z? , o seu valor pode ser usado para definir a 

aceitação e o tamanho da próxima sub-região 1z+?  de acordo com os critérios 

descrito na Tabela 3. O termo de aceitação z?  pode assumir um valor onde a re-

gião de confiança pode ser mantida, reduzida ou aumentada.  

 
Tabela 3 - Termo de aceitação no esquema da região de confiança [11] . 

z?  
Precisão da Função 
Substituta 

Resultado 
da Iteração 

Tamanho da Região 
de Confiança 

0z? ?  
Imprecisa Rejeitar Reduzir 

0 0.25z?&amp;lt;?  
Razoavelmente preci-
sa 

Aceitar Reduzir 

0.25 0.75 ou 1.25z z? ?&amp;lt;&amp;lt;&gt;  
Moderadamente preci-
sa 

Aceitar Manter 

0.75 1.25z?? ?
 

Precisa Aceitar Aumentar 

 

O novo ponto central  1z
c
x

+  da nova sub-região é também determinado em 

função do termo de aceitação e segue os critérios descritos pela Equação (3.19) 

abaixo: 

  1 *    se  0
z z z

c
?+ = ?x x   

1    se  0z z z
c c

?+ =&amp;lt;x x                                                                                  (3.19) 



47 

 

4 Ajuste de Histórico 

O ajuste de histórico, no contexto do presente trabalho, consiste numa 

técnica que busca validar o modelo numérico de caracterização e escoamento 

usado num campo de petróleo já em produção. Seu principal objetivo é ajustar o 

modelo existente para que ele seja útil nas previsões de comportamento futuro e 

capaz de obter resultados coerentes com o histórico de produção do campo. Uma 

vez ajustado, esse modelo pode ser usado com maior confiabilidade na previsão 

de produção.  

A técnica do ajuste de histórico dá-se por meio da simulação, a partir da 

qual o comportamento observado do reservatório obtido através de dados do 

campo, é comparado com o comportamento previsto para este reservatório prove-

niente da simulação computacional. Por meio desse processo, é possível melhorar 

o modelo computacional, uma vez que a comparação permite identificar a consis-

tência dos dados e sugerir as mudanças necessárias. O ajuste de histórico pode 

ser uma ferramenta bastante útil na melhoria da caracterização do reservatório, 

possibilitando uma maior confiabilidade à fase de previsão de produção. 

É comum os reservatórios de petróleo apresentarem limitações para a 

previsão de produção durante a fase de caracterização. Isso porque, nesse mo-

mento, diversas incertezas se fazem presentes, o custo para obter as informações 

é bastante elevado, e normalmente ocorre perda delas quando da passagem dos 

dados da escala geológica para a escala de simulação. Assim, o ajuste de históri-

co tem-se mostrado uma solução eficaz no contorno dessas dificuldades, ou seja, 

um mecanismo necessário. 

 

 

 



48 

 

4.1 Seleção das Variáveis de Projeto 

Na maioria das vezes, a implantação do ajuste de histórico é difícil e traba-

lhosa, principalmente na fase inicial de exploração dos campos, quando ainda há 

poucos dados de produção disponíveis, o que aumenta as incertezas do processo. 

Nessa fase a confiabilidade do modelo ajustado diminui e o número de soluções 

possíveis aumenta. Por isso, fazem-se necessárias uma caracterização bem deta-

lhada do campo e a obtenção de dados geológicos cada vez mais precisos. 

Um dos problemas do ajuste de histórico é o grande número de simula-

ções necessárias para calibrar um modelo numérico. Isso porque muitas variáveis 

críticas, que afetam diretamente os resultados, estão envolvidas no procedimento.  

Este estudo serviu como experimento da metodologia desenvolvida e ba-

seou-se num problema simples, que teve como principal objetivo estudar e avaliar 

as técnicas e os resultados gerados durante o processo de ajuste de histórico de 

produção, por este motivo que o critério de seleção das variáveis de projeto foi 

baseado em experiências anteriores.  

Depois de selecionadas as variáveis de projeto, o próximo passo é estabe-

lecer seus limites de variação (limite inferior e superior). Dessa forma, entre uma 

infinidade de combinações possíveis, o ajuste de histórico deve ser capaz de con-

duzir a um conjunto de parâmetros, dentro dos limites antes instituídos, que repro-

duz, de forma razoável, a maneira como o reservatório se comporta. 

Neste estudo o parâmetro (propriedades do modelo a serem modificadas) 

escolhido foi a permeabilidade absoluta. 

Caso o ajuste utilize mais de um parâmetro, pode-se estabelecer uma or-

dem dos parâmetros a serem modificados. Um dos métodos de priorização consis-

te em promover uma separação em termos do grau de incerteza das variáveis. 

Como variáveis com baixo grau de incerteza, podem ser consideradas, por exem-

plo, as propriedades dos fluidos — como a razão de solubilidade do componente 

gás na fase óleo, a viscosidade, etc. — e a pressão do ponto de bolha, se for utili-



49 

 

zado um processo de amostragem confiável. Já as propriedades da formação do 

reservatório, como permeabilidade e porosidade, normalmente possuem maior 

grau a de incerteza [19].  

Mas essa não é uma regra geral. Os parâmetros considerados com maior 

grau de incerteza devem ser escolhidos caso a caso. Quando eles são variados 

individualmente dentro de seus limites, é possível escolher os parâmetros incertos 

e realizar uma análise de sensibilidade para examinar o comportamento do mode-

lo. Esse exercício é capaz de indicar os parâmetros responsáveis por uma maior 

variação na resposta da simulação, além de indicar por onde o ajuste de histórico 

deve ser iniciado. 

Portanto, é importante lembrar: ainda que o ajuste seja satisfatório para 

determinados parâmetros, não se pode considerar o modelo ajustado como o mo-

delo real do reservatório. Vale ressaltar ainda que o ajuste de histórico não tem 

solução única, ou seja, mais de um conjunto de dados de entrada podem reprodu-

zir o comportamento de um campo de petróleo, incluindo valores fisicamente in-

consistentes. 

4.2 Problema Inverso 

O ajuste de histórico de produção é considerado um problema inverso, por 

meio do qual um conjunto de propriedades é determinado. O problema é conside-

rado inverso porque o efeito é conhecido (parâmetros ajustados – vazão, pressão 

e saturação) e as causas são desconhecidas (propriedades dos modelos a serem 

modificada – permeabilidade, porosidade, etc.). Essas propriedades devem repro-

duzir satisfatoriamente as informações dinâmicas disponíveis, como vazões, pres-

sões e saturações. 

A maior dificuldade do ajuste, como de todo problema inverso, é a multipli-

cidade de soluções. Afinal, um grande número de combinações de parâmetros 



50 

 

pode fornecer respostas parecidas entre si, principalmente quando seu grau de 

incerteza é elevado.  

Quando o período de histórico é pequeno, esse problema tende a se a-

gravar ainda mais. Apesar de diferentes soluções confirmarem razoavelmente as 

observações registradas, qualquer uma delas poderia gerar uma previsão diferen-

te e conduzir a uma faixa com distintas respostas.  

Para minimizar esse problema, seguem algumas regras: 

1. Durante a fase de caracterização do reservatório, antes de construir o mo-

delo de simulação, obter o máximo de informações. 

2. Definir limites de variação para todos os parâmetros. 

3. Não variar os parâmetros além dos limites de variação preestabelecidos. Se 

esse procedimento for indispensável, refazer toda a análise para o parâme-

tro em questão.  

4.  Variar primeiro os parâmetros com menor grau de confiabilidade. 

4.3 Ajuste Manual e Assistido 

Normalmente, os ajustes de produção são feitos por meio de tentativas e 

erros, em que os parâmetros a serem utilizados são escolhidos com base na ex-

periência de ajustes anteriores. Caso o ajuste não atinja um resultado satisfatório, 

o processo é reiniciado com a escolha de outro parâmetro. Após diversas repeti-

ções, espera-se chegar a um ajuste aceitável.  

Há duas formas para proceder a um ajuste: a manual e a assistida. Em 

geral, o chamado ajuste manual é mais trabalhoso para o profissional envolvido no 

processo. Isso porque todas as tarefas, tais como execução das simulações, alte-

rações do modelo de simulação e análise dos resultados, são realizadas manual-

mente, exigindo do profissional mais esforço, maior interação com o processo e 

mais tempo de trabalho. Já o chamado ajuste assistido utiliza-se da automatização 

das tarefas manuais, sendo menos trabalhoso e, ao mesmo tempo, mais confiável, 



51 

 

pois investiga melhor o espaço de soluções. Essa forma de ajuste aproveita a ex-

periência do profissional e possibilita a sua interação com o processo, permitindo-

lhe proceder ao ajuste por etapas. Além disso, para se encontrar a melhor combi-

nação de parâmetros (variáveis do projeto) que minimize a função-objetivo, utiliza-

se um algoritmo de otimização.  

Nas décadas de 1970 e 1980, propuseram-se inúmeros trabalhos que vi-

savam à automatização do ajuste de histórico de produção [34]. Apesar disso, o 

uso generalizado dessa ferramenta não se difundiu como o esperado. Para expli-

car esse comedimento, algumas razões podem ser apontadas, tais como: a multi-

plicidade de soluções (mau-condicionamento), comum nos problemas inversos; o 

comportamento altamente não-linear da função-objetivo, ou seja, problemas em 

que não há uma relação direta entre as variáveis de entrada (variáveis do projeto) 

e a variável de saída (função-objetivo), o que dificulta a convergência dos métodos 

de otimização ou a torna bastante lenta; a ocorrência de oscilações da função-

objetivo, que podem provocar a interrupção prematura do cálculo dos parâmetros 

em pontos de “mínimo local” que não satisfazem às exigências do problema; a 

existência de longos vales quando variáveis de pequena sensibilidade são incluí-

das no processo; o grande esforço computacional requerido, que inviabiliza a utili-

zação do processo em estudos de grande porte; etc [19].  

Assim, o ajuste assistido foi abandonado por algum tempo até que, recen-

temente, com o avanço dos computadores, de técnicas de computação paralela, 

técnicas de otimização e construção de modelo matemático aproximado, ele tem 

ressurgido, sendo largamente utilizado. Diversos trabalhos que utilizam esse mo-

delo têm como proposta a automatização de várias etapas do ajuste, resultando 

em um processo mais rápido, menos frustrante e com melhores resultados. 

 

 

 



52 

 

4.4 Seleção dos Algoritmos de Otimização 

No ajuste de histórico, os algoritmos de otimização são utilizados para se 

buscar a melhor combinação de parâmetros, ou seja, a que minimize a função-

objetivo relacionada com o erro entre o valor observado e calculado. Vários méto-

dos e algoritmos de otimização têm sido usados, pois é difícil haver um único mé-

todo ou algoritmo que funcione bem em todos os casos. 

Existem duas categorias básicas de algoritmos geralmente usados no a-

juste de histórico de produção. A primeira é baseada no método de gradientes, 

que consiste no cálculo das derivadas da função-objetivo e restrições. Sua princi-

pal limitação diz respeito à quantidade de variáveis possíveis de serem estudadas, 

que normalmente é bastante reduzida. Isso porque esse método demanda alto 

custo computacional, em termos de tempo de CPU, e apresenta certa limitação de 

desempenho para funções-objetivos muito irregulares, além disto, muitos simula-

dores não fornecem gradientes. A segunda categoria são os algoritmos de busca 

direta, que não requerem o cálculo de gradientes, já que utilizam apenas valores 

das funções. Esses métodos normalmente indicados para situações em que a su-

perfície da função-objetivo não é suave (derivadas descontínuas) ou quando o 

cálculo numérico de derivadas exige um grande esforço computacional. 

É necessário chamar a atenção para o fato de o algoritmo ser tão somente 

uma ferramenta auxiliar no ajuste de histórico. Ele á capaz de automatizar e agili-

zar as etapas mais repetitivas do processo, mas não pode ser encarado como 

uma rotina capaz de obter o ajuste de forma totalmente automática.  

Por isso, se pouco ou nenhum progresso estiver sendo obtido na redução 

da função-objetivo, é importante que o engenheiro acompanhe constantemente o 

processo e julgue-o, a fim de definir as possíveis alterações de rumo. Nesses ca-

sos, as variáveis do problema ou os seus limites de variação devem ser cuidado-

samente revistos. Uma vez executando essas tarefas, o profissional pode excluir 

propriedades de pequena sensibilidade ou incluir novas variáveis que ainda não 



53 

 

haviam sido consideradas. Além disso, pode rever as tolerâncias usadas no pro-

cesso. 

Se a função-objetivo é reduzida a um limite abaixo da tolerância preesta-

belecida e/ou se o modelo ajustado atende aos objetivos do estudo, a solução é 

considerada satisfatória. Por outro lado, mínimos locais ou falhas específicas dos 

algoritmos de otimização costumam provocar soluções insatisfatórias. 

A qualidade do ajuste pode ser influenciada de diversas formas: por meio 

da redução da função-objetivo, do número de simulações, da incerteza envolvida 

no processo de caracterização e do número de propriedades. 

A Figura 9 ilustra as etapas do ajuste de histórico apresentadas no decor-

rer deste capítulo.  

 

 
Figura 9 - Etapas do Ajuste de Histórico (Leitão, 1997). 

 

 

 



54 

 

4.5 Formulação do problema 

A função-objetivo, as variáveis de projetos e restrições são elementos que 

constituem um problema de otimização. Para cada elemento será apresentado o 

seu papel e significados mais gerais abordados no problema aqui proposto, bem 

como a metodologia utilizada no processo do ajuste de histórico de produção. Es-

ses elementos estão descritos adiante. 

4.5.1 Função-Objetivo 

O primeiro passo a ser realizado em qualquer processo de ajuste de histó-

rico de produção é definir o que será ajustado (por exemplo, dados de pressão e 

produção do poços). Depois de definido, é possível compor a função-objetivo, que 

expressa matematicamente a diferença entre os dados calculados e observados. 

Para ajustar as produções de óleo, água ou gás, a seguinte função-

objetivo é definida [16]: 

 
 (4.1)  

 
 
 
 
onde: 

 ObservodoPA  = Produção acumulada dos dados observados da série de dados 

(por exemplo, dados de produção de óleo, água ou gás dos poços) ao longo do 

tempo  

 CalculadoPA  = Produção acumulada dos dados Calculados da série de dados 

(por exemplo, dados de produção de óleo, água ou gás dos poços) ao longo do 

tempo 

 n   = Número de dados Observados e Calculados de cada série de dados 

2

1

( ) log
Observadon
j

Calculado
j j

PA
f

PA=

? ?? ?
= ? ?? ?

? ?? ?? ?? ?
?x



55 

 

4.5.2 Variáveis de Projeto 

Uma vez definida a função-objetivo, o passo seguinte consiste da seleção 

de um conjunto de variáveis a serem alteradas no modelo para obtenção do ajuste 

desejado. De modo geral, qualquer propriedade ou “conjunto” de propriedades 

(por exemplo, toda a malha de permeabilidades) pode ser considerado como pa-

râmetro.  

Em princípio, devem-se escolher apenas as variáveis que apresentem for-

te influência sobre a função-objetivo, pois a inclusão de incógnitas desnecessárias 

torna o processo mais lento e ineficiente. 

A permeabilidade absoluta é a variável de projeto selecionada para o pro-

blema tratada nesse estudo. 

Os estudos foram aplicados a dois ajustes de características distintas, re-

presentados por um campo de permeabilidade com três regiões distintas e um 

campo de permeabilidade estocástico. 

4.5.3 Restrições de Limite 

Além de identificar as variáveis a serem consideradas no processo, é pre-

ciso estimar limites máximos e mínimos associados a cada uma ( )l ui i i? ?x x x . Es-

tes limites delimitam o espaço do projeto, assim como evita que os algoritmos de 

otimização forneçam resultados fisicamente incorretos, tais como valores negati-

vos ou muito diferentes dos esperados para o campo. 

Para obter tais limites, foi realizado um estudo paramétrico para encontrar 

os dados que representam uma maior confiabilidade no modelo numérico do re-

servatório. 



56 

 

5 Implementação Computacional 

5.1 Ferramentas 

Neste capítulo serão apresentadas as ferramentas utilizadas no presente 

trabalho. A estrutura do sistema é formada por programas complementares im-

plementados, utilizando o software OCTAVE, que irão trabalhar integrados ao fra-

mework DAKOTA e simulador IMEX. 

5.1.1 IMEX  

O IMEX [08] foi programado em FORTRAN 77 e pode ser executado sob 

diferentes plataformas: mainframes IBM, CDC, CRAY, Honeywell, DEC, Prime, 

Gould, Unisys, Apollo, SUN, HP, FPS, IBM-PC 486, e família Intel Pentium. 

O simulador IMEX possui três solvers distintos: explícito, implícito ou a-

daptativo. Estes referem-se à forma como são resolvidas as equações não-

lineares dos modelos de fluxo. No caso de modo explícito, o passo de tempo utili-

zado deve ser sempre menor que o máximo valor de passo que mantenha a esta-

bilidade do sistema. No modo implícito, é necessário resolver um sistema de e-

quações não lineares a cada passo, podendo ser escolhidos passos maiores  e o 

modo adaptativo permite escolher entre a solução implícita ou explícita segundo a 

característica das variações dos estados do sistema.  

No IMEX a comunicação com o usuário pode ser efetuada através de ar-

quivos de entrada e saída. O usuário deve criar um arquivo texto de entrada (for-

mato .DAT) que contém: a configuração da malha, informação geológica, tipo de 

fluxo de óleo, condições iniciais, métodos numéricos, lista de poços, entre outras 



57 

 

informações. O simulador, após a execução, fornece os valores de saída em um 

grupo de arquivos, tal como indicado na Figura 10. 

.DAT

IMEX

.RRF.MRF.IRF.OUT

.DAT = Conjunto de dados

.IRF = Índice de resultados

.OUT = Arquivo de saída

.MRF = Arquivo de resultados principais

.RRF = Resultados recorrentes (opcional)

 

Figura 10 - Arquivos de entrada e saída do IMEX. 
 

O Arquivo .DAT é imprescindível, uma vez que este arquivo contém todas 

as informações que definem a configuração completa do reservatório a ser simu-

lado.  A informação contida no arquivo .DAT está classificada em 7 tipos de dados: 

 

1. Dados de controle de Entrada e Saída 

2. Dados de descrição do reservatório 

3. Propriedades dos componentes 

4. Dados de Rochas e Fluidos 

5. Condições Iniciais 

6. Informação sobre os métodos numéricos 

7. Informação dos poços e dados recorrentes. 

 

Os arquivos .MRF e .IRF contêm os resultados globais da simulação, isto 

é, valores das vazões de óleo, gás, água etc. O arquivo .IRF contém o índice dos 



58 

 

resultados e o arquivo .MRF armazena os resultados numéricos em si. O arquivo 

.OUT armazena resultados escolhidos pelo usuário, no formato ASCII. 

O comando *INCLUDE permite ao simulador quebrar a leitura sequencial 

do arquivo de entrada .DAT primário para começar a leitura de um arquivo secun-

dário. Uma vez finalizada a leitura do segundo arquivo, continua-se com a leitura a 

partir da linha seguinte a que continha o comando *INCLUDE. O formato do co-

mando é o seguinte:  

 

*INCLUDE ‘arquivosec’ 

 

Este comando facilita a alteração de algumas partes do arquivo .DAT sem 

afetar o resto, ou seja, se num arquivo secundário estiverem os dados referentes 

as definições dos poços (tipo de poços, locações, geometria, parâmetros físicos, 

restrições, cronograma), caso haja necessidade de alteração dessas definições 

apenas ele precisaria ser modificado. Com esta estratégia, as mudanças referen-

tes ao processo de ajuste de histórico serão fornecidas em um arquivo pequeno, 

ao invés de se precisar criar arquivos .DAT completos 

5.1.2 DAKOTA 

O DAKOTA (Design Analysis Kit for Optimization and Terascale Applicati-
ons) foi um projeto iniciado em 1994 como uma investigação interna e atividade de 

desenvolvimento no laboratório Sandia Nacional em Albuquerque, Novo México. O 

objetivo original deste projeto era fornecer um conjunto comum de ferramentas de 

otimização para um grupo de engenheiros que estavam resolvendo análise estru-

tural e projeto de vários problemas [11]. 

O DAKOTA é um framework que fornece uma interface flexível e extensiva 

entre seu código de simulação e uma variedade de estratégias e métodos iterati-

vos. Este sistema inicialmente foi concebido como uma interface de uso fácil entre 



59 

 

os códigos de simulação e algoritmos de otimização. No entanto versões mais re-

centes foram expandidas para implementar interfaces com outros tipos de méto-

dos de análise iterativos tais como, a quantificação de incertezas com métodos 

não determinísticos de propagação, estimativa de parâmetros com o método dos 

mínimos quadrados,  análise de sensibilidade/variância em projetos de experimen-

tos de aplicações gerais,  e  estudos paramétricos. Estas potencialidades podem 

ser usadas em seus próprios blocos ou em blocos construídos com estratégias 

mais sofisticadas tais como, otimização híbrida, otimização baseada em aproxi-

mação, programação linear e não-linear, ou otimização sob incerteza [11].  

O DAKOTA foi desenvolvido sob o paradigma da orientação a objetos, 

com a finalidade de utilizar abstrações dos componentes chaves requeridas para 

análise iterativa do sistema. 

Entretanto, uma das vantagens que o DAKOTA oferece é o acesso a uma 

escala muito abrangente de potencialidades iterativas que podem ser obtidas atra-

vés de uma única interface relativamente simples entre o DAKOTA e o código do 

simulador fornecido pelo usuário. Esta interface é descrita como uma “caixa-preta” 

porque o DAKOTA não necessita do acesso ao código fonte do sistema de simu-

lação. A troca de informações entre o DAKOTA e o simulador é realizada através 

da leitura e escrita em um arquivo de dados. Para a utilização de um tipo diferente 

de método ou de estratégia iterativa com o simulador, faz-se necessário apenas a 

mudança de alguns comandos de entrada no DAKOTA e dar início a uma nova 

análise. Esta interface é descrita na figura a seguir: 

 



60 

 

 
Figura 11 - Interface entre o DAKOTA e o Simulador (Dakota Version 5.0 User’s Manual). 

 

 
Uma dos passos do esquema do ajuste de histórico aqui desenvolvido é a 

configuração do arquivo de entrada (script) do DAKOTA, que contém os parâme-

tros necessários para o funcionamento do processo, tais como estratégia, variá-

veis, interface, métodos e modelos. A seguir serão apresentados os principais 

controles do DAKOTA utilizados neste trabalho no processo do ajuste de histórico. 

5.1.2.1 Estratégia de Otimização no DAKOTA 

O problema de otimização será solucionado através do algoritmo SQP, 

que é identificado no arquivo de entrada do DAKOTA através do método np-

sol_sqp, que pertence ao pacote externo NPSOL, onde é implementado pela clas-

se NPSOLOptimizer. 

O NPSOL foi criado por Philip Gill, Walter Murray, Michael Saunders e 

Margaret Wright [32]. Foi construído com um conjunto de subrotinas em Fortran 



61 

 

77, projetado para resolver problemas de otimização não linear, onde as funções 

devem ser suaves, mas não necessariamente convexas. O NPSOL são métodos 

baseados na programação quadrática sequencial. Este algoritmo SQP apenas 

necessita das primeiras derivadas - quando estas não são fornecidas podem ser 

estimadas por algum procedimento numérico para análise de sensibilidade.  

No DAKOTA, há dois tipos de controles: os independentes e os dependen-

tes do método NPSOL. Nas Tabelas 4 e 5 são apresentados alguns destes contro-

les. 

Tabela 4 – Controles independentes do método NPSOL. 
Controle Descrição 
max_iterations Limita o número máximo das iterações do SQP 

max_function_evaluations Limita o número máximo de avaliações de função que podem ser execu-
tadas durante a otimização 
 

constraint_tolerance Define como as funções de restrições são satisfeitas na convergência. O 
valor padrão é dependente da precisão da plataforma da máquina em 
uso, mas geralmente é da ordem de 1e-8. Valores extremamente peque-
nos para constraint_tolerance podem não ser atingidos 

convergence_tolerance Define a tolerância de otimalidade interna do NPSOL que é usada na 
avaliação se uma iteração satisfizer as condições de Kuhn-Tucker de 
primeira ordem para um mínimo. A magnitude da tolerância à convergên-
cia, especifica aproximadamente o número de dígitos significativos da 
precisão desejada na função objetivo final (por exemplo, convergen-
ce_tolerance=1e-6 irá resultar em aproximadamente 6 dígitos de precisão 
na função objetivo final) 

output verbosity 
 (silent | quiet | verbose | 
debug) 

 

 

Controla a quantidade de informação gerada em cada iteração principal 
SQP. As configurações silent e quiet resultam em apenas uma linha de 
saída de diagnostico para cada iteração principal e imprime a solução da 
otimização final. As configurações verbose e debug adicionam informação 
sobre a função objetivo, restrições e variáveis em cada iteração principal 

 

 
 
 
 
 
 
 
 
 
 



62 

 

Tabela 5 – Controles dependentes do método NPSOL. 
Controle Descrição 
verify_level Controla instruções NPSOL para executar verificação de diferença finita no 

componente do gradiente fornecido pelo usuário 

function_precision Fornece uma estimativa da precisão para a qual as funções do problema po-
dem ser calculadas 

linesearch_tolerance Controla a precisão da busca linear. Quanto menor o valor (entre 0 e 1), mais 
precisamente o NPSOL irá tentar calcular um mínimo preciso ao longo da dire-
ção de busca 

5.1.2.2 Implementação da Estratégia de Otimização Aproximada Sequencial 

(SAO) no DAKOTA 

A estratégia de Otimização Aproximada Sequencial (SAO) é identificado no 

arquivo de entrada do DAKOTA através do método surrogate_based_local, que é 

implementado pela classe SurrBasedLocalMinimizer. 

No arquivo de entrada do DAKOTA o usuário pode controlar o método sur-

rogate_based_local através dos controles abaixo: 

 

Tabela 6 – Controles SAO no DAKOTA. 
Controle Descrição 
approx_method_pointer Ponteiro do método aproximado do subproblema minimizado 
Approx_method_name Nome do método aproximado do subproblema minimizado 
max_iterations Número máximo de iterações do SÃO 
convergence_tolerance Tolerância usada em avaliações internas da convergência do SAO 
soft_convergence_limit Controle suave da convergência para as iterações do SAO, que limita 

número de iterações consecutivas com menos melhoria que a tolerância 
da convergência 

truth_surrogate_bypass Flag para ignorar todos os níveis inferiores da aproximação ao executar 
verificações reais em um nível superior da aproximação 

 

O usuário tem a opção de controlar a região de confiança através da es-

pecificação do grupo identificado pela palavra chave trust_region. Esses controles 

podem ser visualizados com maiores detalhes na tabela abaixo. 

 

 

 



63 

 

 Tabela 7 – Controle da Região de Confiança no DAKOTA. 
Controle Descrição 
initial_size Tamanho inicial da região de confiança (relativo ao limite)  
minimum_size Tamanho mínimo da região da confiança 
contract_threshold Fator de contração do tamanho da região de confiança que é usado quando o 

modelo substituto esta sendo impreciso. Caso a relação da região de confiança 
esteja abaixo deste valor, a região de confiança é contraída 

expand_threshold Fator de expansão do tamanho da região da confiança que é usado quando o 
modelo substituto esta sendo preciso. Caso a relação da região de confiança 
esteja acima deste valor, a região de confiança é expandida    

contraction_factor Fator de contração da região de confiança 
expansion_factor Fator de expansão da região de confiança 

   

Os comando contraction_factor  e expansion_factor são relacionados ao 

que é chamado a razão da região da confiança, que é a real diminuição (decrés-

cimo) no modelo real  pelo decréscimo que foi previsto no modelo real na atual 

região de confiança. O comando contract_threshold ajusta o valor mínimo aceitá-

vel para a relação da região de confiança, isto é, valores abaixo deste ponto inicial 

causam o encolhimento da região de confiança para a próxima iteração do SAO. 

O comando  expand-threshold determina o valor acima da região da confi-

ança, que região de confiança expandirá para a próxima iteração do SAO. 

Na estratégia SAO o fator de correção entre o modelo real e aproximado é 

identificado no arquivo de entrada do DAKOTA através da palavra chave correcti-

on, que pode assumir o valor additive ou multiplicative ou combined, associados a 

zeroth_order ou first_order ou second_order.  O comportamento padrão é que ne-

nhum fator de correção seja aplicado, mas na nossa implementação foi seleciona-

do o valor additive com zeroth_order. 

O método de regressão polinomial da forma quadrática será identificado 

no DAKOTA pela palavra chave polynomial quadratic. 

 

 

 

 



64 

 

5.1.3 OCTAVE 

O OCTAVE [22] é uma linguagem de programação de alto nível, destinada 

ao tratamento de problemas para computação numérica. É uma aplicação desen-

volvida utilizando uma filosofia OpenSource (software livre). 

O OCTAVE pode efetuar cálculos aritméticos com reais, escalares, com-

plexos e matrizes; resolver sistemas de equações algébricas; integrar funções so-

bre intervalos finitos e infinitos e integrar sistemas de equações diferenciais ordi-

nárias e diferenciais algébricas. 

O OCTAVE é em grande parte compatível com o MATLAB. É uma ferra-

menta desenvolvida para o sistema operacional Linux, sendo atualmente distribuí-

da com as principais versões deste sistema operacional. A sua utilização no ambi-

ente Windows é igualmente possível através da utilização da ferramenta CYGWIN, 

a qual fornece um ambiente de emulação da plataforma Linux sobre Microsoft 

Windows. 

5.2 Metodologia 

A metodologia proposta neste trabalho consiste em desenvolver um me-

canismo para automatizar o processo de ajuste de histórico de produção em simu-

lação numérica de reservatório por um ajuste assistido, através da minimização 

matemática de uma função-objetivo por um método de otimização baseada em 

aproximação Sequencial (SAO). 

De acordo com o número de variáveis de projeto, será gerada uma amos-

tra de dados para o cálculo da função-objetivo, representando a função real que 

será a base para construção do modelo substituto.  

Para a geração das amostras foi utilizada a técnica de amostragem (De-

sign of Experiments – DOE) Hipercubo Latino (LHS). 



65 

 

Será utilizada uma estratégia de aproximação, no qual o algoritmo de oti-

mização vai operar em um modelo substituto, de baixo custo computacional, ao 

invés da simulação do modelo envolvendo a física complexa. A função aproxima-

da foi construída utilizando o modelo de regressão polinomial quadrática. 

Uma vez que o modelo substituto é construído, um modelo barato para as 

respostas obtidas será usado ao invés de se fazer uso das respostas obtidas da 

simulação real, necessárias em diversas chamadas no processo de otimização. 

Para a minimização matemática da função-objetivo, que representa a 

norma da diferença entre um histórico de produção observado e um histórico obti-

do através da simulação computacional, será adotada uma estratégia SAO (Se-

quential Approximation Optimization). 

O período de produção do reservatório é dividido em um número finito de 

etapas de tempo. Como o simulador só encerra a execução quando encontra o 

primeiro critério de parada, o tempo pode variar de acordo com o modelo selecio-

nado. Para solucionar este problema, foi necessário encontrar o valor da produção 

observada e calculada no mesmo período de tempo utilizados no cálculo da fun-

ção-objetivo. Primeiramente foram gerados 192 pontos entre o tempo inicial e o 

final da produção observada. Os 192 números de pontos foram baseados numa 

média de tempo total de produção de cada arquivo de saída gerado durante o pro-

cesso de simulação. O valor destes pontos (tempo de produção) foi utilizado para 

encontrar a produção.  

Para encontrar o valor da produção nestes pontos utilizou-se uma interpo-

lação por spline cúbica, através da função abaixo: 

( )spline=yy x, y, xx  

onde: 

 yy  - valor da produção em relação ao tempo xx  

 x   – tempo da produção  

 y   – valor da produção  

 xx  – valor do tempo aonde se deseja a produção      



66 

 

Uma spline cúbica é uma curva suave construída passando através do 

conjunto de pontos.  A curva entre cada par de pontos é determinada por um poli-

nômio do terceiro grau, que é calculado para fornecer uma curva suave entre os 

pontos. 

As splines são excelentes curvas interpoladoras, devido ao fato de serem 

bastante suaves e, além disso, são bastante viáveis computacionalmente porque 

não exigem a resolução de sistemas lineares muito grandes e também evitam cer-

tas oscilações indesejadas, que é o que ocorre quando se utilizam polinômios de 

graus maiores para efetuar a interpolação. 

No modelo numérico de campos de petróleo construído serão testadas as 

diferentes situações de restrições de poço. Em cada uma das quatro situações as 

restrições no Water CUT (corte de água) e/ou BHP (pressões de fundo de poço) 

são ativadas ou não.  

A estrutura do sistema é formada pelo desenvolvimento de programas uti-

lizando a linguagem OCTAVE, que irão trabalhar integrados ao DAKOTA e IMEX. 

Esses programas adicionais tem como finalidade prover uma interface entre o 

DAKOTA e o IMEX, realizando um tratamento prévio das informações fornecidas 

pelo DAKOTA para manipulação pelo IMEX, e vice-versa. Além disso, foram de-

senvolvidos também programas com finalidades específicas, a exemplo do cálculo 

da função-objetivo, geração do arquivo de entrada do IMEX e outros.  

A Figura 12 apresenta o esquema do ajuste de histórico assistido. Para 

um melhor entendimento, descrevemos abaixo a seqüência de passos desse fluxo 

de execução:  

1. INICIO – O fluxograma do ajuste de Histórico inicia-se com a execução de 

um arquivo de entrada do DAKOTA; 

2. Arquivo de Entrada do DAKOTA - É um arquivo de configuração (.in) para 

entrada no DAKOTA com informações tipo:  estratégia, variáveis, interface, 

métodos e modelos;  



67 

 

3. Arquivo de Parâmetros do DAKOTA - É um arquivo gerado pelo DAKOTA 

com informações que serão usadas pelo conjunto de programas da rotina 

de Pré-Processamento para a geração do arquivo de entrada no IMEX; 

4. Programa OCTAVE Pré-Processamento - O programa analisador (principal) 

irá executar uma rotina em OCTAVE chamada de pre-processador, que tem 

a função de criar o arquivo de entrada do IMEX a partir da leitura de um ar-

quivo de TEMPLATE e dos parâmetros gerado pelo DAKOTA; 

5. Arquivo de Entrada do IMEX – Arquivo gerado pelo programa pré-

processado a partir do arquivo de TEMPLATE; 

6. Arquivo de Saída do IMEX – É um arquivo resultante da execução do arqui-

vo de entrada do IMEX no programa analisador, onde nele constam os va-

lores da produção acumulada da superfície (óleo, água e gás); 

7. Programa OCTAVE Pós-Processamento - É uma rotina em OCTAVE que é 

executada pelo programa analisador, que terá a função de ler o arquivo de 

saída do IMEX para obter o valor da produção acumulado da superfície ao 

longo do tempo. Com estes dados o programa irá calcular a função-

objetivo; 

8. Arquivo de Resultado do DAKOTA - É um arquivo contendo os valores do 

ajuste de histórico de produção calculados pelos programas de Pós-

Processamento. 

9. FIM – O fluxograma finaliza sua execução quando o DAKOTA encontrar a 

solução ótima do problema.  

 

O cálculo da função-objetivo é feito através da Equação (4.1) descrita no 

item 4.51. Durante a execução, será construído o modelo substituto de acordo 

com o número de amostras definidas no arquivo de entrada e será iniciado o ciclo 

SAO (Sequential Approximation Optimization) que vai procurar por um ponto ótimo 

aproximado. O ciclo é repetido diversas vezes, até que o ajuste de histórico de 

produção seja considerado satisfatório, ou outro critério de convergência tenha 



68 

 

sido satisfeito. Se convergir, o processo é encerrado e o último ponto ótimo obtido 

é considerado como solução ótima do problema; caso contrário, será iniciada uma 

nova iteração a partir da geração de novos parâmetros.  

 

 
Figura 12 - Esquema do ajuste de histórico assistido implementado neste trabalho. 

 

5.3 Scripts - Programas Adicionais 

Para o funcionamento do esquema do ajuste de histórico foram desenvol-

vidos programas adicionais na linguagem OCTAVE. Esses scripts têm como obje-

tivo complementar a estrutura do sistema através de rotinas especifica necessá-

rias à solução do sistema, além de prover uma interface entre o DAKOTA e o I-

MEX, realizando um tratamento prévio das informações fornecidas pelo DAKOTA 

para manipulação pelo IMEX, e vice-versa. 

Os scripts são executados a partir de um programa principal analysisDri-

ver.m,  demonstrado na figura abaixo: 



69 

 

 
Figura 13 - Fluxograma dos Scripts. 

 

 Os scripts estão divididos em dois grupos:  

• Pré-Processamento  

• Pós-Processamento 

O primeiro tem a função de criar o arquivo de entrada do IMEX a partir da 

leitura de um arquivo de TEMPLATE e dos parâmetros gerados pelo DAKOTA, e o 

segundo a função de ler o arquivo de saída do IMEX para obter o valor da produ-

ção acumulado ao longo do tempo e calcular a função-objetivo.  

Nas tabelas abaixo podem ser visualizadas as descrições e os parâmetros 

de entrada dos scripts de pré-processamento e pós-processamento: 

 

 

 

 

 

 

 



70 

 

Tabela 8 - Descrição e parâmetros de entrada do script de pré-processamento. 
Scripts Descrição Parâmetro de Entrada 

analysisDriver.m Programa principal que chama 
os outros scripts 

 

readDakotaParam.m Lê arquivo de parâmetro do 
DAKOTA, seleciona e grava o 
nome e o valor da variável em 
um vetor  

paramFile - Nome do arquivo de 
parâmetro do DAKOTA 

processFilesN.m Copia o arquivo de TEMPLATE 
para um arquivo de entrada do 
IMEX, substituindo o valor da 
variável contido no parâmetro 
de entrada Tags pela variável 
indicada no TEMPLATE 

TemplateFile – Nome do arquivo de 
TEMPLATE 
Output – Nome do arquivo de saída 
do IMEX 
Tags – Vetor com o nome e valor da 
variável 
Marker – Delimitador de variável 

 
 

Tabela 9 – Descrição e parâmetros de entrada do script de pós-processamento. 
Scripts Descrição Parâmetro de Entrada 

posProcessadorImex.m Recupera o tempo e a produção 
acumulada do arquivo de saída 
do IMEX, que serão utilizados 
no cálculo do ajuste de histórico 

dakotaResponseFile – Nome do 
arquivo que contém os dados do 
tempo e da produção calculada 
simOutputFile – Nome do arquivo de 
saída do IMEX 
realFile – Nome do arquivo que 
contém os dados do tempo e da 
produção observada 

cleanup.m Remove todos os arquivos tem-
porários criados em cada avali-
ação de função 

runDir – Diretório onde a aplicação 
esta sendo executada 
imexFile – Nome do arquivo do I-
MEX 

 



71 

 

6 Aplicações 

Neste capítulo serão apresentados a descrição física e numérica dos mo-

delos de reservatório usados nas aplicações de ajustes de histórico utilizando a 

metodologia proposta. Dois casos serão estudados, onde o reservatório é repre-

sentado respectivamente por um campo de permeabilidade com três regiões dis-

tintas e um campo de permeabilidade estocástico. A avaliação do comportamento 

da previsão futura da produção é também apresentada. 

6.1 Descrição do Cenário 

O cenário aqui proposto visa validar os resultados do procedimento de a-

juste de histórico, em simulação numérica de reservatório de petróleo, juntamente 

com técnicas de otimização por aproximação sequencial.  

Dois modelos de reservatório foram utilizados. No primeiro, o valor da 

permeabilidade foi definido em três regiões distintas, apresentando características 

mais simples com objetivo de estudar e avaliar as técnicas e os resultados gera-

dos durante o processo de ajuste de histórico de produção. O segundo, com ca-

racterísticas mais complexas, envolve um campo de permeabilidades estocástico, 

caracterizando a incerteza numa das variáveis de entrada no modelo. 

As técnicas para estudos do processo de ajuste de histórico de produção 

apresentadas foram aplicadas no caso de um reservatório de petróleo com injeção 

de água (waterflooding - WF). A injeção de água é um método de recuperação 

secundária capaz de garantir manutenção da pressão do reservatório em níveis 

desejáveis, além de propiciar o deslocamento dos hidrocarbonetos dos poros para 

os poços produtores.   

A informação retirada do arquivo de resultado do simulador (saída) para 

calcular o ajuste de histórico é a produção acumulada nas condições de superfície 



72 

 

(óleo, água e gás) do campo de petróleo. Diferentes situações foram aplicadas no 

modelo de reservatório, nas quais as restrições no corte de água (Water Cut) e/ou 

pressões de fundo de poço (BHP) estiveram ativadas ou não nos poços produto-

res. Foram selecionadas quatro situações, denominadas aqui como “Casos C1 à 

C4” e detalhadas na tabela abaixo. 

 

Tabela 10 – Restrição no poço. 
Casos Restrição no poço 

C1 Sem restrições de BHP e WCUT  
C2 Com Restrição apenas no BHP  
C3 Com Restrição apenas no WCUT  
C4 Com Restrição no BHP e WCUT  

 

No caso C1, não houve qualquer restrição para os poços produtores. No 

caso C2, os poços produtores foram configurados para restrição de BHP mínimo 

(ajustado para 180 Kgf/cm²). No caso C3, os poços produtores foram configurados 

para restrição de Water Cut máximo (ajustado para 95%). No caso C4 foram con-

sideradas as restrições tanto para BHP como para WCUT, ou seja, combinação 

dos casos C2 e C3 respectivamente.  

Para construção do modelo aproximado, através do modelo de regressão 

polinomial, foi necessário gerar um conjunto de pontos (amostra) pela técnica de 

amostragem LHS.  A quantidade de pontos da amostra variou de acordo com o 

número de variáveis de projeto. 

O parâmetro selecionado para o ajuste foi o valor de permeabilidade, a 

partir do qual geraram-se dados para análise. Os ajustes realizados foram feitos 

para a produção acumulada de óleo do campo. 

6.2 Casos propostos para estudo 

O objetivo principal deste estudo foi tentar identificar as dificuldades reais 

e potenciais inerentes à aplicação do processo de ajuste de histórico de produção 



73 

 

em simulação numérica de reservatório de petróleo; bem como tentar encontrar o 

melhor caminho para solucionar os problemas. 

Este estudo foi aplicado a dois ajustes de características distintas. Cada 

um dos casos possui particularidades definidas no que se refere à complexidade 

do modelo de reservatório.  

6.2.1 Ajuste A 

O primeiro ajuste apresentou geometria simples e características fáceis de 

controlar. O valor da permeabilidade foi definido em três regiões do modelo, con-

forme a Figura 14. A região próxima ao poço injetor (I-1), ilustrada pela cor verde, 

possui valores da permeabilidade igual ao valor de base, ou seja, 100 mD. A outra 

região, próxima ao poço produtor P-1, ilustrada pela cor azul, possui permeabili-

dade inferior ao valor de base. A região próxima ao produtor P-2, ilustrada pela cor 

vermelha, possui valores superiores à permeabilidade base. A razão entre a per-

meabilidade da região do poço P-2 e a do poço P-1 representa o contraste de 

permeabilidade. Trabalhou-se com um contraste de permeabilidade de 3:1, a partir 

do uso dos valores de permeabilidade de 50mD próximo ao poço P-1, e 150mD na 

região do poço P-2. 

 



74 

 

 
Figura 14 - Regiões de Permeabilidade Horizontal.  

 

O modelo utilizado é baseado no trabalho de [26], possui 51x51x1 células 

e apresenta as propriedades resumidas na Tabela 11. 

 

Tabela 11 - Resumo das características do modelo base.  
Propriedade Dados 
Malha de Simulação 51(510m)x51(510m)x1(4m) 
Porosidade 30% 

Permeabilidade horizontal média ( hK ) 
100 mD 

Permeabilidade vertical (
v

K ) 10% de hK  

Compressibilidade da Rocha @ 200 kgf/cm² 5.10
-5

 (kgf/cm²)
-¹
 

Contatos entre Fluidos Sem contatos WOC e GOC 

Pressão de Saturação (
sat
P ) 273 kgf/cm² 

Viscosidade @ 
res
T , 

sat
P  0.97 cP 

Razão Gás-Óleo de Formação (
F

RGO ) 115.5 m³/m³std 

 



75 

 

A geração do modelo de reservatório foi baseada nas informações mos-

tradas na Tabela 11. Este possui um poço injetor de água (I-1) e dois poços produ-

tores de óleo (P-1 e P-2), que são poços verticais completados em uma única ca-

mada do modelo. 

Os poços produtores são restringidos por uma vazão máxima de líquido 

de 30m3/dia e o poço injetor é controlado apenas pela vazão máxima de água inje-

tada, definida em 44m3/dia. Esse valor foi adotado buscando a manutenção da 

pressão média do reservatório. As vazões dos poços são apresentadas a cada 

passo de tempo. O intervalo de produção pode variar de acordo com a restrição 

de poço imposta. 

A aplicação possui um tempo total de produção de 16 anos (01/01/2006 a 

01/12/2021). Neste exemplo, as vazões dos dois poços produtores de óleo (P-1 e 

P-2) foram ajustadas ambas em 20m³/dia no período de produção. O limite à va-

zão de líquido foi fixado em 40m³/dia, refletindo a máxima vazão diária de produ-

ção capaz de ser tratada pela unidade. 

Nesta primeira etapa a variável permeabilidade horizontal ( hK ) adotou o 

valor base de 100mD . 

O modelo de simulação base foi utilizado para geração dos dados da pro-

dução observada. Durante a simulação e otimização, com a alteração da variável 

do projeto, foram gerados os dados da produção calculada.  Com o resultado do 

histórico de produção observado e calculado é calculada a função-objetivo do 

nosso problema utilizando a Equação (4.1). 

Após a simulação do modelo base foram geradas as curvas de produção 

acumulada do óleo observada (modelo base) no decorrer do tempo e em relação 

aos quatros tipos de restrições de poços apresentados na Tabela 10. Tais produ-

ções estão ilustradas nas Figuras 15 a 18. 

 



76 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C1 - Sem restrições de BHP e WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

 
Figura 15 - Curva de Produção Acumulada de Óleo Observada – Caso C1. 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C2 - Com Restrição apenas no BHP

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

 
Figura 16 - Curva de Produção Acumulada de Óleo Observada – Caso C2. 



77 

 

0 500 1000 1500 2000 2500 3000 3500
0

2

4

6

8

10

12
x 10

4 Caso C3 - Com Restrição apenas no WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

 
Figura 17 - Curva de Produção Acumulada de Óleo Observada – Caso C3. 

 

0 500 1000 1500 2000 2500 3000 3500 4000
0

2

4

6

8

10

12
x 10

4 Caso C4 - Com Restrição no BHP e WCUT 

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

 
Figura 18 - Curva de Produção Acumulada de Óleo Observada – Caso C4. 

 

Esses dados servirão como base de comparação entre os próximos casos 

propostos deste ajuste, estabelecendo condições para avaliar o resultado final. 

 



78 

 

6.2.1.1 Ajuste A - Caso 1: Uma variável de projeto; Contraste de permeabili-

dade 1:3 

Este primeiro caso foi representado por uma variável de projeto (permea-

bilidade horizontal - hK ).  

Para iniciar o processo de ajuste, foi realizado um estudo paramétrico com 

o intuito de assegurar que a produção inicial iria partir de um ponto diferente da 

produção observado e, posteriormente, avaliar a sensibilidade do modelo a partir 

da variação da permeabilidade. A resposta analisada é a produção acumulada do 

óleo. Como resultado deste estudo as seguintes condições foram aplicadas: 

? Permeabilidade inicial = 25 mD
Inicialh

k =  

? Restrições de limite = 16 200 mD
h
k? ?   ( 100 mD

Baseh
k = ) 

O processo de ajuste de histórico de produção foi obtido através da simu-

lação, juntamente com um método de otimização baseada em aproximação se-

quencial (SAO), cuja meta foi reduzir a função-objetivo. Abaixo são apresentados 

os principais controles com seus respectivos valores do SAO utilizado no DAKO-

TA: 

max_iterations = 50 
convergence_tolerance = 1e-3 
soft_convergence_limit = 2  
trust_region 
     initial_size = 0.10 
     minimum_size =  1.0e-3 
     contract_threshold = 0.25 
     expand_threshold = 0.75 
     contraction_factor = 0.50 
     expansion_factor = 1.50 

 

A iteração SAO, a permeabilidade horizontal (
h

K ) e a função-objetivo (
o

F ) 

gerados durante a otimização dos casos C1 à C4 estão apresentados respectiva-

mente nas Tabelas 12 a 15. 

 



79 

 

 

 

Tabela 12 - Resultado da Otimização- C1. 
Caso C1 

Iteração SAO 
h

K  
o

F  

1 25 15.828 
11 99.6675737 0.0229062 

 

Tabela 13 - Resultado da Otimização- C2. 
Caso C2 

Iteração SAO 
h

K  
o

F  

1 25 40.2334 
18 100.0046106 0.0021255 

 
Tabela 14 - Resultado da Otimização- C3. 

Caso C3 
Iteração SAO 

h
K  

o
F  

1 25 19.8729 
13 99.94335353 0.00437011 

 
Tabela 15 - Resultado da Otimização- C4. 

Caso C4 
Iteração SAO 

h
K  

o
F  

1 25 48.6368 
13 99.8098551 0.0429445 

 
 

O caso C2 (com restrição apenas no BHP) apresentou o menor valor da 

função-objetivo, que em contrapartida obteve o maior número de iterações SAO; 

porém o caso C1 (sem restrições de BHP e WCUT) obteve o menor número de 

iterações SAO, atingindo um bom ajuste. No entanto, concluímos que podemos 

utilizar o modelo numérico deste caso para obtenção de uma previsão do compor-

tamento do reservatório.  

Nas figuras abaixo estão apresentados os gráficos das curvas de produ-

ção acumulada do óleo observada, inicial e calculada no decorrer do tempo, em 

relação aos quatros tipos de restrições de poços apresentados na Tabela 10.  

 

 



80 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C1 - Sem restrições de BHP e WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 19 - Ajuste da Produção de Óleo – Caso C1. 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C2 - Com Restrição apenas no BHP

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 20 - Ajuste da Produção de Óleo – Caso C2. 

 



81 

 

0 500 1000 1500 2000 2500 3000 3500 4000
0

2

4

6

8

10

12
x 10

4 Caso C3 - Com Restrição apenas no WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

Produção Inicial

 
Figura 21 - Ajuste da Produção de Óleo – Caso C3. 

 

0 500 1000 1500 2000 2500 3000 3500 4000
0

2

4

6

8

10

12
x 10

4 Caso C4 - Com Restrição no BHP e WCUT 

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 22 - Ajuste da Produção de Óleo – Caso C4. 

 

 
Os quatros tipos de restrições de poços mostraram-se bastante sensíveis 

ao resultado da otimização, ou seja, houve a redução da função-objetivo e, como 



82 

 

pode ser visualizada, a curva final (produção calculada) apresentou-se bastante 

próxima dos dados observados. 

6.2.1.2 Ajuste A - Caso 2: Três variáveis de projeto 

O segundo caso é uma extensão do primeiro, com a inclusão de dois pa-

râmetros adicionais. Neste ajuste cada variável de projeto foi representada por 

uma região do modelo, conforme mostrado na Figura 14; ou seja, além do primeiro 

parâmetro, correspondente à região próxima ao poço injetor I-1, são considerados 

também um parâmetro representado pela região próxima ao produtor P-2 e o outro 

pela região próxima ao poço produto P-1. 

Neste caso, o contraste de permeabilidade não assumiu mais um percen-

tual de 150% e 50% da permeabilidade horizontal ( hK ) como no Ajuste A - Caso 

1. Os valores foram atribuídos a dois parâmetros que foram modificados dinami-

camente durante o processo de otimização. 

Como no Ajuste A, para dar início ao processo de ajuste foi realizado um 

estudo paramétrico com o intuito de assegurar que a produção inicial iria partir de 

um ponto diferente da produção observado. 

O ajuste parte inicialmente de um modelo observado. Os valores das per-

meabilidades usados no caso base, no ponto inicial bem como os seus limites uti-

lizados no procedimento de otimização, estão indicados abaixo: 

 

? Permeabilidade base = 1 100 mDBasehk =  

           2 150 mDBasehk =  

             3 50 mDBasehk =  

? Permeabilidade inicial =  1 50 mDInicialhk =  

            2 75 mDInicialhk =  



83 

 

              3 25 mDInicialhk =  

? Restrições de limite =    116 150 mDhk? ?  

                   220 200 mDhk? ?  

                   310 100 mDhk? ?  

Os resultados da otimização para este exemplo estão fornecidos nas Ta-

belas 16 a 19 respectivamente para cada condição de restrição de poço indicada 

na Tabela 10. 

Tabela 16 - Resultado da Otimização – C1. 
Caso C1 

Iteração SAO 
h1K   h2K  h3K  oF  

1 50 75 25 4.25297 
7 84.3375 107.7791808 58.54182322 0.384337 

 

Tabela 17 – Resultado da Otimização – C2. 
Caso C2 

Iteração SAO 
h1K   h2K  h3K  oF  

1 50 75 25 15.6682 
11 95.21158769 155.1360883 49.04427832 0.308472 

 
Tabela 18 – Resultado da Otimização – C3. 

Caso C3 
Iteração SAO 

h1K   h2K  h3K  oF  
1 50 75 25 5.45307 
16 66.08401248 150.1020359 52.2184962 0.191019 

 
Tabela 19 – Resultado da Otimização – C4. 

Caso C4 
Iteração SAO 

h1K   h2K  h3K  oF  
1 50 75 25 19.2074 
11 91.80478821 148.55824 50.3874516 0.276534 

 

 

O caso C3 (com restrição apenas no WCUT) apresentou o menor valor da 

função-objetivo, mas, em contrapartida, obteve o maior número de iterações SAO; 

porém o caso C1 (sem restrições de BHP e WCUT) obteve o menor número de 

iterações SAO, atingindo um bom ajuste. Entretanto, concluímos que podemos 



84 

 

utilizar o modelo numérico deste caso para obtenção de uma previsão do compor-

tamento do reservatório.  

Nas figuras a seguir estão apresentados os gráficos das curvas de produ-

ção acumulada do óleo nas diferentes situações: observada, inicial e calculada no 

decorrer do tempo para cada um dos casos apresentados na Tabela 10.  

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C1 - Sem restrições de BHP e WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 23 - Ajuste da Produção de Óleo – Caso C1. 

 



85 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C2 - Com Restrição apenas no BHP

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

Produção Inicial

 
Figura 24 - Ajuste da Produção de Óleo – Caso C2. 

 

0 500 1000 1500 2000 2500 3000 3500 4000
0

2

4

6

8

10

12
x 10

4 Caso C3 - Com Restrição apenas no WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 25 - Ajuste da Produção de Óleo – Caso C3. 

 



86 

 

0 500 1000 1500 2000 2500 3000 3500 4000
0

2

4

6

8

10

12
x 10

4 Caso C4 - Com Restrição no BHP e WCUT 

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada
Produção Inicial

 
Figura 26 - Ajuste da Produção de Óleo – Caso C4. 

 

Os quatros tipos de restrições de poços mostraram-se bastante sensíveis 

ao resultado da otimização, ou seja, houve a redução da função-objetivo e, como 

pode ser visualizado, a curva final (produção calculada) apresentou-se bastante 

próxima dos dados observados. 

6.2.1.3 Ajuste A - Caso 3: Uma variável de projeto; Permeabilidade constante 

no reservatório 

O terceiro caso também é uma extensão do primeiro, com a diferença que 

o valor da permeabilidade no modelo do reservatório durante a produção simulada 

foi considerado constante em todo o campo de petróleo. Entretanto, a produção 

observada é a mesma dos casos anteriores onde existe um contraste de permea-

bilidade 1:3, com os valores já especificados na descrição do exemplo no início da 

seção 6.2.1 e também na seção 6.2.1.2. 



87 

 

O valor inicial da variável de projeto bem como os seus limites utilizados 

no procedimento de otimização está abaixo indicado: 

? Permeabilidade inicial = 25 mD
Inicialh

k =  

? Restrições de limite =       16 200 mD
h
k? ?  ( 100 mD

Baseh
k = ) 

Os resultados da otimização para todas as condições de restrição de poço 

(casos C1 à C4) estão apresentados nas Tabelas 20 a 23 respectivamente. 

 

Tabela 20 - Resultado da Otimização- C1. 
Caso C1 

Iteração SAO 
h

K  
o

F  

1 25 13.4646 
13 76.94136024 0.589944 

 

Tabela 21 - Resultado da Otimização- C2. 
Caso C2 

Iteração SAO 
h

K  
o

F  

1 25 39.19 
9 97.42763311 2.26126 

 
Tabela 22 - Resultado da Otimização- C3. 

Caso C3 
Iteração SAO 

h
K  

o
F  

1 25 17.0637 
9 71.8063238 0.60334 

 
Tabela 23 - Resultado da Otimização- C4. 

Caso C4 
Iteração SAO 

h
K  

o
F  

1 25 47.3676 
8 97.50770404 2.76959 

 

De acordo com os resultados, observa-se que, apesar de considerar a 

permeabilidade constante, a curva de produção calculada continua próxima dos 

dados observados, ou seja, para este caso “simples” tem-se sempre um bom ajus-

te de histórico. 

Este caso serviu para avaliar o comportamento do modelo de simulação 

decorrente desta situação. Entretanto, o Ajuste A baseou-se num problema sim-



88 

 

ples, que teve como principal objetivo estudar e avaliar as técnicas e os resultados 

gerados durante o processo de ajuste de histórico de produção. A partir deste a-

juste outras situações poderão ser implementadas, desde que não haja alteração 

do contexto da aplicação. 

Nas figuras a seguir estão apresentados os gráficos entre a curva de pro-

dução acumulada do óleo observada e calculada no decorrer do tempo, em rela-

ção aos quatros tipos de restrições de poços apresentados na Tabela 10.  

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C1 - Sem restrições de BHP e WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

 
Figura 27 - Ajuste da Produção de Óleo – Caso C1. 

 



89 

 

0 1000 2000 3000 4000 5000 6000
0

2

4

6

8

10

12
x 10

4 Caso C2 - Com Restrição apenas no BHP

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

 
Figura 28 - Ajuste da Produção de Óleo – Caso C2. 

 

0 500 1000 1500 2000 2500 3000 3500 4000 4500 5000
0

2

4

6

8

10

12
x 10

4 Caso C3 - Com Restrição apenas no WCUT

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

 
Figura 29 - Ajuste da Produção de Óleo – Caso C3. 

 



90 
 

[Os resultados desta seção foram trabalhados em conjunto com o aluno Dásio Lira] 
 

0 500 1000 1500 2000 2500 3000 3500 4000 4500
0

2

4

6

8

10

12
x 10

4 Caso C4 - Com Restrição no WCUT e BHP

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Produção Observada

Produção Calculada

 
Figura 30 - Ajuste da Produção de Óleo – Caso C4. 

 

 

Como pode ser verificado, pequenas divergências ocorreram. As maiores 

diferenças ocorreram para o caso C4, seguido do caso C2. 

6.2.2 Ajuste B 

Este ajuste foi baseado no trabalho de [20], possui um modelo de reserva-

tório com característica mais complexa. O seu objetivo é fazer um ajuste de histó-

rico considerando o campo de permeabilidade para o reservatório anteriormente 

descrito como um campo estocástico, caracterizando a incerteza numa das variá-

veis de entrada no modelo. 

Neste trabalho o campo estocástico será representado através de uma 

expansão de Karhunen-Loeve, que é uma expansão em termos dos autovalores e 

autovetores da matriz de covariância espacial do campo, e de variáveis aleatórias 

normais padrão. Está técnica permite representar campos aleatórios estacionários 



91 

 

e os fracamente estacionários com o conhecimento explícito de funções de cova-

riância. Sendo assim, um campo aleatório pode ser representado como uma série, 

envolvendo um conjunto de funções determinísticas com seus respectivos coefici-

entes aleatórios, como apresentado por  [35]. 

Quando um campo de permeabilidade é considerado como um campo es-

tocástico, existem infinitas realizações igualmente possíveis para as propriedades 

petrofísicas deste campo. Neste trabalho as realizações foram criadas a partir de 

uma função de covariância conhecida, conforme a equação abaixo [20]: 

 

                     ( )
( ) ( )1 1 2 2

1 2cov ,
x y x y

b b

E
x y e?

? ?
? ?

=                                                   (6.1) 

 

onde ( )1, 2x x  e ( )1, 2y y  são as coordenadas dos pontos x  e y , 1b  e 2b  são compri-

mentos de correlação e 
E

?  é o desvio padrão. 

Considerando 
k

y  um conjunto de realizações discretas centradas (média 

zero) condicionadas ou não condicionadas de um campo estocástico, com  

( )1, CNr kk N R= ?yL , a matriz de covariância das realizações pode ser calculada 
com a seguinte expressão, de acordo com [37]: 

 

  
1

1 Nr T
j j

jr

y y
N =

= ?C                   (6.2) 

onde 
r

N  é o número de realizações e 
c

N  o número de células no reservatório. 

A expansão de Karhunen-Loeve discreta, usada para gerar novas realiza-

ções com a matriz de covariância C conhecida é apresentada em [35] tal como 

segue: 

  1 2=y E? ?                   (6.3) 

 



92 

 

onde E  é a matriz dos auto-vetores da matriz de covariância C , ? é a matriz dia-

gonal de autovalores de C , e ?  é um vetor de variáveis aleatórias não correlacio-

nadas. 

A matriz C é do tamanho 
c c

N N× . O tamanho máximo de E  como também 

de ?  é 
c c

N N× , sendo o vetor ?  de tamanho 1
c

N × . 

A Equação (6.3) permite descrever o campo estocástico em termos de um 

conjunto finito de variáveis aleatórias normais padrão ( ? ). Estas variáveis podem 

então ser empregadas como variáveis do projeto em um procedimento de otimiza-

ção. É interessante observar que, usualmente, a magnitude dos autovalores da 

matriz de covariância cai muito rapidamente e poucos termos do somatório implíci-

to na Equação (6.3) são necessários para uma representação adequada do cam-

po [35]. 

Neste trabalho, foi empregada a técnica de matriz núcleo para redução do 

esforço computacional no cálculo dos autovalores e auto-vetores da matriz de co-

variância [35][37]. 

O Ajuste B é derivado do Ajuste A, com a diferença que no modelo de re-

servatório temos um valor de permeabilidade para cada célula, ou seja, o campo 

de permeabilidade será considerado como um campo estocástico. Foi considerada 

restrição apenas no BHP em cada poço. 

No modelo base o campo de permeabilidades foi escolhido como uma das 

realizações aleatórias geradas a partir da função de covariância dada na Equação 

(6.1). O histórico de produção gerado pela simulação computacional com este 

campo de permeabilidade será usado como o dado observado para o ajuste de 

histórico. 

 Abaixo é ilustrado o campo de permeabilidade base (observado) aleató-

rio: 



93 

 

 
Figura 31 - Campo base. 

 

6.2.2.1 Ajuste B - Caso 1: Uma variável; Permeabilidade constante no reser-

vatório 

No primeiro caso foi realizado um ajuste considerando um campo de per-

meabilidade constante em todo campo de petróleo. Este ajuste foi representado 

por uma variável de projeto. 

O valor inicial e os seus limites utilizados no procedimento de otimização 

são abaixo indicados: 

? Permeabilidade inicial = 10 mD
Inicialh

k =  

? Restrições de limite = 10 80 mD
h
k? ?  100 mDhBasek =   

Na Figura 32 é ilustrado o campo de permeabilidade inicial: 

 



94 

 

 

 
Figura 32 - Campo de permeabilidade constante inicial. 

 
 

Os resultados da otimização estão apresentados na Tabela 24. 

 

Tabela 24 - Resultado da Otimização. 
Iteração SAO 

h
K  

o
F  

1 10 115.448 
9 24.97716787 7.25348 

 

Com o resultado da otimização foi gerado o gráfico da curva de produção 

acumulada do óleo calculada no decorrer do tempo tal como indicado na Figura 

33. Nesta figura, esta também plotado a produção acumulada do óleo para as si-

tuações observada e inicial. 



95 

 

 

 
Figura 33 - Ajuste da Produção de Óleo. 

 
 

De acordo com os resultados apresentados na Tabela 24 e Figura 33, ob-

serva-se que a curva de produção inicial partiu de ponto distante da produção ob-

servada e, durante a otimização aproximou-se dos dados observados, como pode 

ser visto através da redução da função-objetivo. Entretanto, a curva final (produ-

ção calculada) apresentou-se com necessidade de um melhor ajuste, pois uma 

extrapolação no tempo certamente aumentará a diferença entre as produções.  

6.2.2.2 Ajuste B - Caso 2: Uma variável de projeto 

No segundo caso foi realizado um ajuste de histórico com expansão de 

Karhunen-Loeve (K-L), considerando um campo de permeabilidade como um 



96 

 

campo estocástico. Neste caso o vetor de variáveis aleatórias (coeficiente da ex-

pansão K-L do campo estocástico) é a variável de projeto selecionada.  

Este ajuste utilizou apenas uma componente principal, assumindo uma va-

riável do ajuste com limite em 8. O valor inicial bem como os limites da variável é: 

? Componente inicial =  1 0.1inicial? =  

? Restrições de limite = 12 8?? ? ?   

O resultado da otimização está apresentado na Tabela 25. Na Figura 34 

são apresentadas as produções acumuladas de óleo para as três situações: inici-

al, observada e calculada. 

 

Tabela 25 - Resultado da Otimização. 
Iteração SAO Coeficiente K-L 

o
F  

1 0.1 44.7107 
8 5.0734 2.7925 

 

De acordo com o resultado, observa-se que a curva de produção inicial 

partiu de ponto distante da produção observada e, durante a otimização aproxi-

mou-se dos dados observados, e, como consequência, a curva final (produção 

calculada) apresentou-se com um ajuste satisfatório. 

A distribuição das permeabilidades da solução K-L para o coeficiente oti-

mizado é indicada na Figura 35. 

 



97 

 

 

 
Figura 34 - Ajuste da Produção de Óleo. 

 
 

 



98 

 

 
Figura 35 - Campo com ajuste de histórico. 

 

6.2.2.3 Ajuste B - Caso 3: Duas variáveis de projeto 

O terceiro caso é uma extensão do anterior, no qual se utilizou dois com-

ponentes principais e, portanto duas variáveis de projeto. Os respectivos valores 

iniciais e limites estão abaixo indicados: 

? Componente inicial =  1 0.1inicial? =  

                                    2 0.1inicial? =  

? Restrições de limite = 12 8?? ? ?   

                                    22 8?? ? ?  

 

O resultado da otimização está apresentado na Tabela 26. Na Figura 36 

são apresentadas as produções acumuladas de óleo para as três situações: inici-

al, observada e calculada. 



99 

 

Tabela 26 - Resultado da Otimização. 
Iteração SAO  1° Coeficiente K-L   2° Coeficiente K-L  

o
F  

1 0.1 0.1 44.7107 
28 4.5595 1.4213 1.5807 

 

Comparando com o resultado do caso anterior, observa-se que com o 

aumento de mais uma variável (componente principal) houve uma maior redução 

da função-objetivo, ou seja, um melhor ajuste dos dados. 

Não foi necessário gerar novos casos com o aumento do número de vari-

áveis, visto que o ajuste já foi satisfatório com duas variáveis de projeto. 

A distribuição das permeabilidades da solução K-L para o coeficiente oti-

mizado é indicada na Figura 37. 

 

 

 
Figura 36 - Ajuste da Produção de Óleo. 

 

 

 



100 

 

 

 

 
Figura 37 - Campo com ajuste de histórico. 

 

6.3 Previsão Futura 

A previsão do comportamento futuro do reservatório é a quarta e última 

etapa do processo de construção de um modelo de simulação. Uma vez conse-

guido um bom ajuste de histórico, sua análise fornece melhores subsídios para 

obter uma previsão de produção para o campo. Assim sendo, o modelo final (ajus-

tado) é utilizado para realizar previsões futuras do reservatório, provendo subsí-

dios para uma explotação mais confiável. 

Nesta dissertação, os modelos de reservatório ajustados foram extrapola-

dos por um período adicional de 8 anos, totalizando num período de produção de 

24 anos (01/01/2006 a 01/12/2029), para comparar a previsão de produção dos 



101 

 

modelos obtidos no Ajuste A – Caso 2 e no Ajuste B – Caso 3, assim como com-

parar com os resultados da previsão do modelo de referência (observado).  

Primeiramente foi avaliado a previsão do caso 2 do Ajuste A. 

A estratégia de recuperação utilizada no processo de previsão é manter as 

condições de operações dos poços até o final do período de ajuste, por isto só 

foram consideradas a restrição C1 (sem restrições de BHP e WCUT) e C2 (com 

restrição apenas no BHP), visto que o período de produção das outras duas restri-

ções (C3 e C4) foram interrompidas antes do período final, pelo encerramento da 

produção ao encontrar a restrição no WCUT.  

A seguir serão apresentados os gráficos com a extrapolação dos modelos 

com a previsão de produção acumulado do óleo do campo em relação ao Ajuste A 

– Caso 2 nas restrições de poços C1 e C2 apresentadas na Tabela 10. 

 

0 1000 2000 3000 4000 5000 6000 7000 8000 9000
0

2

4

6

8

10

12
x 10

4 Sem restrições de BHP e WCUT - 01/01/2006 a 01/12/2029

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Modelo de Referência

Ajuste A

 
Figura 38 - Previsão futura - Ajuste A – Caso 2 (C1) 

 



102 

 

0 1000 2000 3000 4000 5000 6000 7000 8000 9000
0

2

4

6

8

10

12
x 10

4 Com Restrição apenas no BHP - 01/01/2006 a 01/12/2029  

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Modelo de Referência

Ajuste A

 
Figura 39 - Previsão futura - Ajuste A – Caso 2 (C2). 

 
 

 

Observa-se que a previsão de produção de óleo está bem próxima do mo-

delo de referência nos dois casos, significando que ambos apresentam uma previ-

são do comportamento futuro confiável. 

A seguir será apresentado o gráfico com a extrapolação do modelo com a 

previsão de produção acumulado do óleo do campo em relação ao Ajuste B – Ca-

so 3. 

 



103 

 

0 1000 2000 3000 4000 5000 6000 7000 8000 9000
0

2

4

6

8

10

12

14

16
x 10

4 Previsão Futura - 01/01/2006 a 01/12/2029  

Tempo (Dias)

P
ro

d
u
ç
ã
o
 A

c
u
m

u
la

d
a
 d

e
 Ó

le
o
 (

m
3
/d

ia
)

Modelo de Referência

Ajuste B

 
Figura 40 – Previsão futura - Ajuste B – Caso 3. 

 

Observa-se também que neste caso, a previsão de produção de óleo está 

bem próxima do modelo de referência, significando também uma previsão do 

comportamento futuro confiável. 

 



104 

 

7 Conclusão 

7.1 Considerações Finais 

Visando a diminuição da grande quantidade de simulações numéricas a-

tualmente necessárias para calibrar um modelo numérico, neste trabalho foi apre-

sentada uma estratégia de otimização por aproximação sequencial aplicada a a-

juste de histórico, no qual o algoritmo de otimização vai operar em um modelo 

substituto, de baixo custo computacional, ao invés da simulação do modelo envol-

vendo a física complexa. 

Este trabalho descreveu uma metodologia de integração do ajuste de his-

tórico ao SAO, na qual os principais objetivos são melhorar a confiabilidade da 

previsão do comportamento de campos de petróleo e reduzir o número de simula-

ções. Isto posto, o estudo realizado para o problema proposto neste trabalho ge-

rou as seguintes conclusões: 

1. A utilização do SAO no processo de ajuste de histórico foi aceitável, 

visto que o ajuste alcançou seu objetivo ao minimizar (aproximar de 

zero) a função-objetivo, atingindo assim o desempenho ótimo.  

2. A metodologia desenvolvida fornece informações que podem auxiliar 

os profissionais da área de engenharia de reservatórios nas decisões 

de gerenciamento, como o planejamento de estratégias que podem 

ser implantadas em campos de petróleo;  

3. A implantação do ajuste de histórico pode ser um processo difícil, 

longo e trabalhoso devido às particularidades e complexidade dos re-

servatórios de petróleo, por este motivo torna-se difícil definir uma ú-

nica metodologia. Entretanto, se mostrou ser possível atingir um bom 

ajuste ao seguir algumas regras, que entre as principais, podemos ci-

tar: 



105 

 

• Durante a fase de caracterização do reservatório, antes de 

construir o modelo de simulação, obter o máximo de informa-

ções; 

• Escolha correta dos parâmetros (usando a experiência e análi-

se de sensibilidade); 

• Escolha correta dos limites de variação para todos os parâme-

tros, evitando rodar o processo sem ganho significativo e sem 

ultrapassar os limites físicos possíveis; 

• Não variar os parâmetros além dos limites de variação pré-

estabelecidos. Se esse procedimento for indispensável, então 

se deve refazer toda a análise para o parâmetro em questão.  

• Variar primeiro os parâmetros com menor grau de confiabilida-

de; 

• Rever a estratégia sempre que possível e avaliar constante-

mente o comportamento da função-objetivo; por exemplo, o 

avanço da minimização matemática da função-objetivo e a 

causa desse avanço no ajuste da curva. 

4. A metodologia desenvolvida pode ser automatizada com o uso de 

programas adicionais integrados ao framework DAKOTA e ao simula-

dor IMEX. Uma vez selecionados os parâmetros a serem utilizados, 

durante o processo de otimização a ferramenta foi capaz de determi-

nar automaticamente uma combinação destas variáveis que propor-

cione o ajuste da(s) curva(s) selecionada(s). Consequentemente, o 

tempo empregado em estudos de reservatórios pode ser sensivel-

mente reduzido, já que os recursos disponíveis (homens e máquinas) 

podem ser utilizados de forma mais eficiente. 

5. Para os quatro tipos de restrições de poços, apresentados na Tabela 

10, a função-objetivo apresentou valores próximos do ótimo com dife-

rentes números de iterações SAO, indicando que o bom ajuste pode 



106 

 

ser obtido para diferentes configurações contendo diferentes restri-

ções no poço. 

6. Para os diferentes ajustes utilizados, representados por um campo de 

permeabilidade com três regiões distintas e um campo de permeabili-

dade estocástico, verificou-se que a função-objetivo se comporta de 

maneira regular, dando uma maior confiabilidade à ferramenta. 

7. A metodologia proposta trabalhou apenas com ajuste de produção, 

mas acredita-se que todo o procedimento aqui apresentado pode ser 

estendido para outros tipos de ajustes (função-objetivo). 

8. Após o ajuste de histórico foi possível atingir a reprodução de uma 

boa caracterização do reservatório de petróleo, através de um modelo 

numérico; e, consequentemente, uma boa previsão de produção, au-

xiliando os gerentes a decidir sobre a viabilidade do projeto. 

 

7.2 Sugestões para Trabalhos Futuros 

Muitos pontos podem ser acrescentados e aperfeiçoados de modo a me-

lhorar a qualidade das soluções apresentadas pela metodologia desenvolvida nes-

te trabalho. 

A seguir serão indicadas algumas alternativas que poderão ser estudadas 

em trabalhos futuros. 

• Buscar uma melhor caracterização do reservatório a partir de técni-

cas geoestatística.  

•  Aplicar as estratégias aproximadas para a otimização multiobjetivo; 

• Empregar uma estratégia global de otimização para o problema tra-

tado nesse estudo 

• Utilizar a ferramenta desenvolvida neste trabalho em problemas mais 

complexos da engenharia. 



107 

 

• Considerar as incertezas no processo de otimização. 

 

 

 

 



108 

 

8 Referências 

 
1. AFONSO, SILVANA M. B.; HOROWITZ, B.; SILVA, M. F. Application of approximation 

based strategies for structural design optimization. Computers and Structures Journal, 
2008. 
 

2. AFONSO, SILVANA M. B ; HOROWITZ, BERNARDO ; SILVA, MARCELO FERREIRA DA ; 
SIQUEIRA, GILHENDRIK COSTA DE . Utilização de metamodelos para projeto ótimo de 
estruturas. In: CONEM2006- IV Congresso Nacional de Engenharia Mecânica, 2006, Reci-
fe.  

 
3. ALBUQUERQUE, THIAGO M. MUNIZ. Análise e otimização de problemas térmicos e es-

truturais bidimensionais através do método da base reduzida. Dissertação de Mestrado – 
Recife 2005.  
 

4. ALEXANDROV, N.; DENNIS, J. E. J.; LEWISAND, R. M.; TOREZON, V. A Trust Region 
Framework for Managing the Use of Approximation Models in Optimization. NASA/CR-
201745. Hampton, VA. 1997. Technical Report No. 97-50. 
 

5. BARTHELEMY, J. F. M.; HAFTKA, R. T. Approximation concepts for optimum structural 
design - a review. Structural Optimization, v. 5, p. 129-144, 1993. 
 

6. BOX, G. E. P.; WILSON, K. B. On the Experimental Attainment of Optimum Conditions 
(with discussion). Journal of the Royal Statistical Society Series B, v. 13, n. 1, p. 1-45, 
1951. 

 

7. CARMO, ANDRÉA; CUNHA, JANE; LIRA, DÁSIO. Modelos substitutos baseados em apro-
ximação de função. Trabalho de Pesquisa – Agosto 2008. Recife-PE. UFPE. 
 

8. COMPUTER MODELLING GROUP Ltd;  Imex 2005.10 User‘s Guide. Manual de Referên-
cia; 2005.  
 

9. CUERVO, CARLOS HERNÁN VARGAS. Otimização do Cáculo de Parâmetros no Proceso 
de Ajuste de Históricos de Produção usando PVM. Campinas: Faculdade de Engenharia 
Mecânica, Universidade Estadual de Campinas, Mar, 1997.  Dissertação (Mestrado). 
 

10. DILLON, W.R.; GOLDSTEIN, M. Multivariate analisys: methods and applications. Wiley, 
New York: 1984. 

 
11. ELDRED MICHAEL S., ADAMS, BRIAN M.,  GAY, DAVID M, SWILER, LAURA P.,  

BOHNHOFF, WILLIAM J., EDDY, JOHN P., HART, WILLIAM E., WATSON, JEAN-PAUL, 
GRIFFIN, JOSH D., HOUGH, PATTY D., KOLDA, TAMMY G., WILLIAMS PAMELA J. AND 
MARTINEZ, MONICA L.. DAKOTA, A Multilevel Parallel Object-Oriented Framework for 
Design Optimization, Parameter Estimation, Uncertainty Quantification, and Sensitivity 
Analysis : Version 5.0 User’s Manual, Sandia National Laboratories, USA, 2009. 



109 

 

 

12. ERTEKIN, T.; ABOU-KASSEM, J. H.; KING, G. R. Basic Apllied Reservoir Simulation. 
Richardson, TX: Society of Petroleum Engineers, 2001. 
 

13. FANCHI, JOHN R. Principles of Applied Reservoir Simulation. 3rd Edition, Elsevier GPP, 
2006.     
 

14. FORRESTER, A.; SOBESTER, A.; KEANE, A. Engineering Design Via Surrogate Model-
ling: A Practical Guide. Chichester: Wiley, 2008. 228 p. ISBN 0470060689. 
 

15. GIUNTA, A. A.; ELDRED, M. S. Implementation of a Trust Region Model Management 
Strategy in the DAKOTA Optimization Toolkit. 8th AIAA/USAF/NASA/ISSMO Symposium 
on Multidisciplinary Analysis and Optimization, AIAA-2000-4935. Long Beach, CA. 2000. 

 

16. GUIMARÃES, LEONARDO; HOROWITZ, BERNARDO; AFONSO, SILVANA M. B. Global 
Optimal Solutions for Reservoir Engineering Applications. Conferência Internacional de O-
timização em Engenharia – EngOpt 2008. Rio de Janeiro, Brasil. 
 

17. JACOBS, J. H.; ETRNAN, L. F. P.; ROODA, J. E.; VAN KEULEN, F. An object-oriented 
framework for sequential approximate optimization. 9th AIAA/ISSMO Symposium on 
Multidisciplinary Analysis and Optimization, AIAA-2002-5635. Atlanta, GA. 2002.  
 

18. KEANE, A. J.; NAIR, P. B. Computational Approaches for Aerospace Design: The pursuit of 
Excellence. Hoboken: John Willey &amp;amp; Sons Inc., 2005. 602 p. ISBN 0470855401. 
 

19. LEITÃO, HÉLIO CHAGAS. Ajuste de histórico automatizado através de otimização multiva-
riada e paralelização externa. Campinas: Faculdade de Engenharia Mecânica, Universida-
de Estadual de Campinas, 1997.  Dissertação (Mestrado).   

 

20. LIRA, JOSÉ DÁSIO JR; WILLMERSDORF, RAMIRO; HOROWITZ, BERNARDO. Propaga-
ção de Incertezas em Reservatórios de Petróleo usando a Expansão de KARHUNEM-
LOÈVE no Ambiente DAKOTA. In: CONEM2010- VI Congresso Nacional de Engenharia 
Mecânica, 2010, Campina Grande - Paraíba.  
 

21. MACHADO, A. VIEIRA. Análise de sensibilidade aplicada a ajuste de histórico de produção 
usando o PVM. Campinas: Faculdade de Engenharia Mecânica, Universidade Estadual de 
Campinas, 1997. Dissertação (Mestrado). 

 

 

22. MARQUES, NUNO CAVALHEIRO; MORGADO, CARMEM. Octave: Guia de Estudo Dis-
ponível em:   
http://ssdi.di.fct.unl.pt/pce/0405-1/material/aulas_praticas/octave/guia/guia_octave.html A-
cesso em 05 Fev. 2010. 
 

23. MASCHIO, CÉLIO, VIDAL, COMPANE ALEXANDRE. E  SCHIOZER, JOSÉ DENIS. Inte-
gração do processo de ajuste de histórico com a modelagem geoestatística em reservató-
rios de petróleo. Revista Brasileira de Geociências, Mar, 2008. 



110 

 

 
24. MASCHIO, CÉLIO E SCHIOZER, JOSÉ DENIS. Ajuste de Histórico Assistido Usando Mé-

todos de Otimização de Busca Direta. Rio Oil &amp;amp; Gas Expo and Conference 2004, Out. 4-7, 
2004, Rio de Janeiro, Brasil. IBP06204.  
 

25. MEZZOMO, CRISTIMA C. Otimização de Estratégias de Recuperação para Campos de 
Petróleo. Campinas: Faculdade de Engenharia Mecânica, Universidade Estadual de Cam-
pinas, 2001.  Dissertação (Mestrado).  

 
26. OLIVEIRA, DIEGO F. BARBOSA. Técnicas de Otimização da Produção para Reservatórios 

de Petróleo: Abordagens Sem Uso de Derivadas para Alocação Dinâmica das Vazões de 
Produção e Injeção. Dissertação de Mestrado – Recife 2006 

 
27. PENNA, DÉBORA DIAS JARDINS. Definição da Árvore de Cenários de Afluências para 

Planejamento da Operação Energética de Médio Prazo. Universidade Católica do Rio de 
Janeiro, Julho de 2009. Tese (Doutorado).  

 
28. PIETROBOM, HILTON CLEBER. Otimização Utilizando Funções Substitutas e Extração de 

Regras Difusas.Tese de Doutorado. 2002. São Paulo. ITA. 
 

29. Programação matemática – Princípios básicos. PUC- RIO. Certificação digital n° 
0025018/CA. Disponível em: http://www.maxwell.lambda.ele.puc-rio.br/3332/3332_3.PDF.  
Acesso  em 01 Fev. 2010. 

 
30. RISSO, VALMIR F. Ajuste de Histórico Utilizando Planejamento Estatístico e Combinação 

de Dados de Produção,Pressão e Mapas de Saturação. Campinas: Faculdade de Enge-
nharia Mecânica, Universidade Estadual de Campinas, 2007. Dissertação (Mestrado). 
 

31. RISSO, VALMIR F. E  SCHIOZER, JOSÉ DENIS. Ajuste de Modelos Numéricos de Cam-
pos de Petróleo Combinando Dados de Produção com Sísmica 4D. Rio Oil &amp;amp; Gas Expo 
and Conference 2006, Set. 11-14, 2006, Rio de Janeiro, Brasil. IBP1285_06. 
 

32. RODRIGUES, HELENA SOFIA FERREIRA. Problema de otimização com restrições de 
complementaridade: uma aplicação ao mercado de energia elétrica. Portugal: Universidade 
do Minho, Out 2005. Dissertação (Mestrado). 
 

33. SALIBY, E.; e PACHECO, F.(2002) An empirical evaluation of sampling methods in risk 
analysis simulation: Quasi-Monte Carlo, descriptive sampling, and latin Hypercube sam-
pling. Proceedings of the 2002 Winter simulation Conference. IEEE.  

 
34. SANTOS, J. PEDRO. Determinação de metodologia de ajuste automatizado de histórico. 

Campinas: Faculdade de Engenharia Mecânica, Universidade Estadual de Campinas, 
2000. Dissertação (Mestrado). 

 
35. SARMA, P., DURLOSFKY, L. J., AZIZ, K., 2008,  Kernel Principal Component Analysis for 

Efficient Differentiable Parameterization of Multipoint Geostatistics. Math Geosci 40:3-32.  
Stanford University, Stanford, CA. 

 



111 

 

36. SCHIOZER, DENIS JOSÉ. Computação paralela aplicada à simulação numérica de reser-
vatórios. Campinas: Faculdade de Engenharia Mecânica, Departamento de Engenharia de 
Petróleo, UNICAMP, 1997. 84 p. Dissertação (Livre Docência).  

 
37. SCHOLKOPF, B., SMOLA, A, MULLER K., 1996, Nonlinear Component Analysis as a Ker-

nel Eigenvalue Problem, Technical Report No. 44, Max-Planck Institut für biologische Ky-
bernetik, Arbeitsgruppe Bülthoff. 

 
38. SILVA, MARCELO FERREIRA DA. Estratégias de Aproximação para Otimização Estrutu-

ral. Dissertação de Mestrado – Nov 2009. Recife-PE. UFPE. 
 

39. Tópicos sobre regressão linear múltipla. Disponível em: 
http://www.inf.ufsc.br/~ogliari/arquivos/topicossobreregressaolinearmultipla.ppt. Acesso em 
05 Marc. 2010.  

 

40. TOROPOV, V. V. Simulation approach to structural optimization. Structural Optimization, v. 
1, p. 37-46, 1989. 

 
41. T.W. SIMPSON, J.D. PEPLINSKI, P.N. KOCH, AND J.K. ALLEN. Metamodels for computer 

based Engineering Design: Survey and recommendations. Engineering with Computers 
Vol. 17:129-150, (2001). 

 
42. WATTS, J. W. Reservoir Simulation: past, present and future. Society of Petroleum Engi-

neers. Paper 38441. In: 1997 SPE RESERVOIR SIMULATION SYMPOSIUM. Dallas, 8-11 
de junho de 1997. 
 

43. YERGIN, D. O Petróleo: Uma História de Ganância, Dinheiro e Poder. Tradução de Leila 
Marina U. Di Natale, Maria Cristina Guimarães, Maria Christina L. de Goes. São Paulo: 
Scritta, 1993. Título original: The prize: the epic quest for oil money and power.  
 

Conferência Internacional de Otimização em Engenha-
ria  

 

 

 

 

 

 


	1
	2
	3
	4
	Dissertacao_Andrea_V16

</field>
	</doc>
</add>