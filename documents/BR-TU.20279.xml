<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20279</field>
		<field name="filename">3750_291658.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA

PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA MECÂNICA

Fernando Sandro Velasco Hurtado

FORMULAÇÃO TRIDIMENSIONAL DE VOLUMES FINITOS PARA

SIMULAÇÃO DE RESERVATÓRIOS DE PETRÓLEO COM

MALHAS NÃO-ESTRUTURADAS HÍBRIDAS

Florianópolis

2011



Fernando Sandro Velasco Hurtado

FORMULAÇÃO TRIDIMENSIONAL DE VOLUMES FINITOS PARA

SIMULAÇÃO DE RESERVATÓRIOS DE PETRÓLEO COM

MALHAS NÃO-ESTRUTURADAS HÍBRIDAS

Tese submetida ao Programa de Pós-Graduação

em Engenharia Mecânica da Universidade

Federal de Santa Catarina para a obtenção do

grau de Doutor em Engenharia Mecânica.

Orientador: Clovis Raimundo Maliska, Ph.D

Florianópolis

2011



!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!
 

Catalogação na fonte pela Biblioteca Universitária 
da 

Universidade Federal de Santa Catarina 
 
 
!
!
!
!
!
!
!
!
!
!
!
!
!
!
!

!!!!!!!!!
"!

!
!

         

!!!!!!!!!!
!!!!
!#$%&amp;amp;'!!#()*+,-.!/0)1+1,-!2+1,)-!304+56-!
!!!!!!!!!!!/-)7(4+89-!*):,:7015:-1+4!,0!;-4(705!':1:*-5!&lt;+)+!5:7(4+89-!
!!!!!!!!,0!)050);+*=):-5!,0!&lt;0*)=40-!6-7!7+4&gt;+5!19-?05*)(*()+,+5!!
!!!!!!!!&gt;@A):,+5!B*050C!D!/0)1+1,-!2+1,)-!304+56-!#()*+,-!E!!
!!!!!!!!-):01*+,-).!F4-;:5!G+:7(1,-!H+4:5I+"!?!/4-):+1=&lt;-4:5.!2F.!
!!!!!!!!JKLL"!!
!!!!!!!!!!!L&amp;amp;M!&lt;"N!:4".!O)+'5"!
!
!!!!!!!!!!!P050!Q,-(*-)+,-R!?!S1:;0)5:,+,0!/0,0)+4!,0!2+1*+!F+*+):1+.!
!!!!!!!!F01*)-!P061-4=O:6-"!T)-O)+7+!,0!T=5?U)+,(+89-!07!V1O01&gt;+):+!
!!!!!!!!H06W1:6+"!
!!
!!!!!!!!!!!X164(:!)0'0)Y16:+5!
!
!!!!!!!!!!!L"!V1O01&gt;+):+!706W1:6+"!J"!G050);+*=):-5!?!HZ*-,-5!
!!!!!!!!,0!5:7(4+89-"!["!HZ*-,-!,-5!;-4(705!':1:*-5"!X"!H+4:5I+.!
!!!!!!!!F"!G"!QF4-;:5!G+:7(1,-R"!XX"!S1:;0)5:,+,0!/0,0)+4!,0!
!!!!!!!!2+1*+!F+*+):1+"!T)-O)+7+!,0!T=5?U)+,(+89-!07!V1O01&gt;+):+!
!!!!!!!!H06W1:6+"!XXX"!P@*(4-"!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!F\S!%JL!
!
!
!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!



Fernando Sandro Velasco Hurtado

FORMULAÇÃO TRIDIMENSIONAL DE VOLUMES FINITOS PARA

SIMULAÇÃO DE RESERVATÓRIOS DE PETRÓLEO COM

MALHAS NÃO-ESTRUTURADAS HÍBRIDAS

Esta tese foi julgada aprovada para a obtenção do título de "Doutor em Engenharia

Mecânica", e aprovada em sua forma final pelo Curso de Pós-graduação em Enge-

nharia Mecânica.

Florianópolis, 05 de abril de 2011

Prof. Eduardo Alberto Fancello, D. Sc.
Coordenador

Prof. Clovis Raimundo Maliska, Ph. D.
Orientador

Banca examinadora:

Prof. Clovis Raimundo Maliska, Ph. D.
Presidente

Prof. Francisco Marcondes, Dr. Eng.
Relator



Prof. Álvaro Luiz Gayoso de Azeredo Coutinho, Dr.

Prof. Eduardo Alberto Fancello, D. Sc.

Prof. António Fábio Carvalho da Silva, Dr. Eng.



A minha mãe Gueisa e

a minha tia Arminda



Agradecimentos

Ao professor Clovis R. Maliska, pela orientação, motivação e apoio cons-

tante. Expresso minha eterna gratidão pela oportunidade de trabalhar sob

sua orientação no laboratório SINMEC.

Ao professor Fábio C. da Silva, pelos conselhos e as discussões que

enriqueceram o conteúdo do trabalho.

Aos colegas e amigos Carlos N. Donatti, Gustavo G. Ribeiro e Aymar B.

V. Pescador Jr. pela importante ajuda nos aspectos computacionais.

Ao pesquisador visitante Axel Dihlmann e a nossa secretária Tatiane

C. Martins pelo auxílio e colaboração constantes em nossas atividades co-

tidianas no laboratório SINMEC.

Ao Programa de Pós-graduação em Engenharia Mecânica da Univer-

sidade Federal de Santa Catarina pela oportunidade de realizar o curso de

doutorado.

Ao Programa de Recursos Humanos da Agência Nacional do Petróleo,

Gás Natural e Biocombustíveis (PRH-ANP), pela bolsa de estudos.

À Rede Temática de Simulação e Gerenciamento de Reservatórios, pa-

trocinada pela empresa Petrobras S. A., pelo incentivo às pesquisas que

motivaram a realização do presente trabalho.

À empresa Engineering Simulation and Scientific Software (ESSS), pelo

apoio técnico e por permitir a utilização do aplicativo Kraken para o pós-

processamento e visualização de resultados.

A toda minha família, pelo carinho e apoio que recebo a pesar da

distância.



Sumário

Lista de figuras iv

Lista de símbolos x

Resumo xiv

Abstract xv

1 Introdução 1
1.1 Escopo e contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6

1.2 Organização do trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

2 Aspectos geométricos da discretização 9
2.1 Malhas não-estruturadas híbridas . . . . . . . . . . . . . . . . . . . . 9

2.2 Especificação de uma malha não-estruturada . . . . . . . . . . . 14

2.3 Topologia dos elementos . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.3.1 Tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.3.2 Hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

2.3.3 Prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.3.4 Pirâmide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2.4 Entidades duais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

2.4.1 Construção das faces . . . . . . . . . . . . . . . . . . . . . . . . 25

2.4.2 Construção dos subelementos . . . . . . . . . . . . . . . . . 28

2.4.3 Entidades duais compostas . . . . . . . . . . . . . . . . . . . 29

2.5 Malhas de contorno . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

i



3 Aspectos numéricos básicos 37
3.1 Características gerais de um método de volumes finitos ba-

seado em elementos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

3.2 Convenções relativas à notação . . . . . . . . . . . . . . . . . . . . . . 40

3.3 Transformação de coordenadas . . . . . . . . . . . . . . . . . . . . . . 44

3.3.1 Matriz jacobiana . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

3.3.2 Funções de forma . . . . . . . . . . . . . . . . . . . . . . . . . . 46

3.4 Integração numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

3.4.1 Aproximação de integrais de volume . . . . . . . . . . . . . 50

3.4.2 Aproximação de integrais de superfície . . . . . . . . . . . 52

3.5 Aproximação do gradiente de uma variável . . . . . . . . . . . . . 56

3.6 Esquemas de interpolação espacial . . . . . . . . . . . . . . . . . . . 58

4 Discretização de uma equação de conservação 61
4.1 Equação de conservação genérica . . . . . . . . . . . . . . . . . . . . 61

4.2 Discretização . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

4.2.1 Termo de transporte advectivo . . . . . . . . . . . . . . . . . 63

4.2.2 Termo de transporte difusivo . . . . . . . . . . . . . . . . . . 64

4.2.3 Integração temporal . . . . . . . . . . . . . . . . . . . . . . . . . 65

4.3 Montagem do sistema de equações . . . . . . . . . . . . . . . . . . . 68

4.4 Inclusão de condições de contorno . . . . . . . . . . . . . . . . . . . 72

4.4.1 Condição de fluxo prescrito . . . . . . . . . . . . . . . . . . . 72

4.4.2 Condição de Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . 73

5 Aplicação a um modelo de escoamento em reservatórios 77
5.1 Modelo de escoamento bifásico . . . . . . . . . . . . . . . . . . . . . . 77

5.2 Discretização do modelo . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

5.2.1 Equação da pressão . . . . . . . . . . . . . . . . . . . . . . . . . 82

5.2.2 Equação da saturação . . . . . . . . . . . . . . . . . . . . . . . . 83

5.2.3 Esquemas de interpolação espacial . . . . . . . . . . . . . . 85

5.3 Algoritmo de solução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

5.4 Representação discreta dos poços . . . . . . . . . . . . . . . . . . . . 91

5.5 Modelo de poço . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

6 Exemplos de aplicação 105
6.1 Problemas de difusão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106

6.1.1 Problema 1-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108

ii



6.1.2 Problema 1-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

6.1.3 Problema 1-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123

6.2 Problema 2: advecção não-linear . . . . . . . . . . . . . . . . . . . . . 124

6.3 Verificação do modelo de poço . . . . . . . . . . . . . . . . . . . . . . 131

6.3.1 Problema 3-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136

6.3.2 Problema 3-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

6.3.3 Problema 3-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140

6.4 Problema 4: deslocamento bifásico . . . . . . . . . . . . . . . . . . . 142

7 Conclusão 152

Referências bibliográficas 156

A Parâmetros geométricos 165
A.1 Determinação do vetor área de face . . . . . . . . . . . . . . . . . . . 165

A.2 Baricentro das faces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168

A.3 Cômputo do volume de um subelemento . . . . . . . . . . . . . . 170

iii



Lista de figuras

1.1 Exemplo de um reservatório discretizado por uma malha

corner point. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

1.2 Exemplo de uma malha de Voronoi aplicada a discretiza-

ção de um reservatório . . . . . . . . . . . . . . . . . . . . . . . . . . 3

1.3 Malha híbrida com geometria radial ao redor dos poços . . 4

1.4 Exemplo de uma malha não-estruturada de triângulos em-

pregada no método de volumes finitos baseado em ele-

mentos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.5 Malha de prismas para a representação discreta de fratu-

ras em um meio poroso . . . . . . . . . . . . . . . . . . . . . . . . . . 6

2.1 Entidades básicas em uma malha tridimensional . . . . . . . 10

2.2 Exemplos de situações que não satisfazem as condições

de conformidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

2.3 Exemplos de transição conforme entre hexaedros e tetrae-

dros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

2.4 Exemplo da especificação dos vértices de uma malha . . . . 15

2.5 Exemplo da especificação dos elementos de uma malha . . 17

2.6 Topologia do tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.7 Topologia do hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.8 Topologia do prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2.9 Topologia da pirâmide . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

2.10 Entidades primárias e entidades duais em nível de elemento 24

2.11 Construção das faces no tetraedro, no hexaedro e no prisma 26

2.12 Construção das faces no elemento piramidal . . . . . . . . . . 27

iv



2.13 Faces e subelementos no tetraedro . . . . . . . . . . . . . . . . . 28

2.14 Faces e subelementos no hexaedro . . . . . . . . . . . . . . . . . 29

2.15 Faces e subelementos no prisma . . . . . . . . . . . . . . . . . . . 30

2.16 Faces e subelementos na pirâmide . . . . . . . . . . . . . . . . . . 30

2.17 Volume de controle em uma malha tridimensional mista . 31

2.18 Corte de um volume de controle . . . . . . . . . . . . . . . . . . . 32

2.19 Entidades primárias e entidades duais compostas . . . . . . 33

2.20 Exemplo da especificação de uma malha de contorno . . . 34

2.21 Subdivisão dos elementos de contorno . . . . . . . . . . . . . . 35

2.22 Volume de controle adjacente a um contorno . . . . . . . . . . 36

3.1 Características fundamentais dos métodos de volumes fi-

nitos baseados em elementos . . . . . . . . . . . . . . . . . . . . . 39

3.2 Notação de entidades e conjuntos de entidades (parte 1). . 41

3.3 Notação de entidades e conjuntos de entidades (parte 2). . 42

3.4 Notação de entidades e conjuntos de entidades associa-

das à malhas de contorno. . . . . . . . . . . . . . . . . . . . . . . . . 43

3.5 Tetraedro no espaço transformado . . . . . . . . . . . . . . . . . . 47

3.6 Hexaedro no espaço transformado . . . . . . . . . . . . . . . . . . 48

3.7 Prisma no espaço transformado . . . . . . . . . . . . . . . . . . . . 49

3.8 Pirâmide no espaço transformado . . . . . . . . . . . . . . . . . . 50

3.9 Orientação absoluta do vetor área de face . . . . . . . . . . . . 54

3.10 Orientação do vetor área de face, relativa aos volumes de

controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

3.11 Interpolação upwind de um ponto . . . . . . . . . . . . . . . . . . 60

4.1 Volume de controle em um escoamento . . . . . . . . . . . . . . 63

4.2 Equação discretizada para um volume de controle . . . . . . 68

4.3 Contribuições de um elemento no sistema de equações

discretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

4.4 Contribuições de uma face no sistema de equações dis-

cretizadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

4.5 Redução do sistema de equações pela imposição de uma

condição de Dirichlet . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

5.1 Variação típica das funções dependentes da saturação e

suas derivadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

v



5.2 Variante do algoritmo de solução IMPES . . . . . . . . . . . . . 89

5.3 Representação discreta de um poço . . . . . . . . . . . . . . . . . 92

5.4 Volume de controle associado a um nó no poço . . . . . . . . 95

5.5 Grandezas envolvidas em um modelo de poço convencional 98

5.6 Problema auxiliar para a determinação do índice de poço

em duas dimensões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

5.7 Problema auxiliar para a determinação do índice de poço

em três dimensões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

6.1 Especificação do problema 1-A . . . . . . . . . . . . . . . . . . . . 108

6.2 Malhas de 20×20×20 hexaedros, apresentando diferente
amplitude de distorção dos elementos . . . . . . . . . . . . . . . 110

6.3 Convergência da pressão no problema 1-A, para malhas

de hexaedros com diferente amplitude de distorção . . . . . 111

6.4 Convergência do gradiente da pressão no problema 1-A,

para malhas de hexaedros com diferente amplitude de dis-

torção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111

6.5 Convergência dos fluxos no problema 1-A, para malhas de

hexaedros com diferente amplitude de distorção . . . . . . . 111

6.6 Índice de deformação dos elementos para diferentes am-

plitudes de distorção . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113

6.7 Projeção de uma faceta arqueada sobre o plano médio . . . 114

6.8 Índice de arqueamento dos elementos para diferentes am-

plitudes de distorção . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

6.9 Divisão de um hexaedro em tetraedros, prismas ou pirâ-

mides . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

6.10 Convergência da pressão no problema 1-A, para malhas

de tetraedros com diferente amplitude de distorção . . . . . 116

6.11 Convergência do gradiente da pressão no problema 1-A,

para malhas de tetraedros com diferente amplitude de dis-

torção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116

6.12 Convergência dos fluxos no problema 1-A, para malhas de

tetraedros com diferente amplitude de distorção . . . . . . . 116

6.13 Convergência da pressão no problema 1-A, para malhas

de prismas com diferente amplitude de distorção . . . . . . . 117

vi



6.14 Convergência do gradiente da pressão no problema 1-A,

para malhas de prismas com diferente amplitude de dis-

torção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117

6.15 Convergência da pressão no problema 1-A, para malhas

de pirâmides com diferente amplitude de distorção . . . . . 118

6.16 Convergência do gradiente da pressão no problema 1-A,

para malhas de pirâmides com diferente amplitude de dis-

torção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118

6.17 Três malhas híbridas utilizadas nos testes de convergência 119

6.18 Comparação da convergência da pressão no problema 1-A

em malhas hexaédricas, tetraédricas e híbridas . . . . . . . . 120

6.19 Comparação da convergência do gradiente da pressão no

problema 1-A em malhas hexaédricas, tetraédricas e hí-

bridas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

6.20 Comparação da convergência dos fluxos no problema 1-A

em malhas hexaédricas, tetraédricas e híbridas . . . . . . . . 120

6.21 Especificação do problema 1-B . . . . . . . . . . . . . . . . . . . . 121

6.22 Convergência da pressão no problema 1-B em malhas de

diferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122

6.23 Convergência do gradiente da pressão no problema 1-B

em malhas de diferente topologia . . . . . . . . . . . . . . . . . . 122

6.24 Convergência dos fluxos no problema 1-B em malhas de

diferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122

6.25 Especificação do problema 1-C . . . . . . . . . . . . . . . . . . . . 123

6.26 Convergência da pressão no problema 1-C em malhas de

diferentes topologias . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125

6.27 Convergência do gradiente da pressão no problema 1-C

em malhas de diferentes topologias . . . . . . . . . . . . . . . . . 125

6.28 Convergência dos fluxos no problema 1-C em malhas de

diferentes topologias . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125

6.29 Especificação do problema 2 . . . . . . . . . . . . . . . . . . . . . . 126

6.30 Função fluxo fracionário e perfil de saturação analítico para

o problema 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127

6.31 Variação temporal da norma do erro da saturação no pro-

blema 2, para três malhas de hexaedros regulares . . . . . . . 129

vii



6.32 Convergência do erro da saturação para malhas hexaédri-

cas regulares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129

6.33 Convergência do erro da saturação para malhas hexaédri-

cas apresentando diferente amplitude de distorção . . . . . 130

6.34 Campos de saturação correspondentes à solução analítica

e a soluções numéricas obtidas em malhas com diferentes

amplitudes de distorção . . . . . . . . . . . . . . . . . . . . . . . . . 132

6.35 Convergência do erro da saturação para malhas regulares

de diferente topologia . . . . . . . . . . . . . . . . . . . . . . . . . . . 133

6.36 Especificação da geometria do domínio e do poço . . . . . . 133

6.37 Estrutura da malha M-1 . . . . . . . . . . . . . . . . . . . . . . . . . . 134

6.38 Estrutura da malha M-2 . . . . . . . . . . . . . . . . . . . . . . . . . . 135

6.39 Tensor permeabilidade para os problemas 3-A, 3-B e 3-C . 136

6.40 Comparação dos campos de pressão para o problema 3-A

resolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 137

6.41 Comparação dos resultados de vazão no poço para o pro-

blema 3-A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

6.42 Comparação dos campos de pressão para o problema 3-B

resolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 139

6.43 Comparação dos resultados de vazão no poço para o pro-

blema 3-B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139

6.44 Comparação dos campos de pressão para o problema 3-C

resolvido nas malhas M-1 e M-2 . . . . . . . . . . . . . . . . . . . . 141

6.45 Comparação dos resultados de vazão no poço para o pro-

blema 3-C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

6.46 Malha não-estruturada para o problema 4 . . . . . . . . . . . . 142

6.47 Propriedades físicas associadas às camadas do reservató-

rio no problema 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

6.48 Geometria dos poços e condições de operação prescritas

pra o problema 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144

6.49 Campo de pressão em três instantes de tempo . . . . . . . . . 145

6.50 Campo de saturação em três instantes de tempo . . . . . . . 147

6.51 Campo de saturação em duas seções transversais do do-

mínio, para três instantes de tempo . . . . . . . . . . . . . . . . . 148

6.52 Vazões ao longo dos poços produtores, em três níveis de

tempo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149

viii



6.53 Variação temporal das vazões completas no poço P-1 . . . . 150

6.54 Variação temporal das vazões completas no poço P-2 . . . . 150

6.55 Corte de água nos dois poços produtores . . . . . . . . . . . . . 151

6.56 Volume de óleo produzido nos dois poços produtores . . . . 151

A.1 Transformação de coordenadas para o cômputo do vetor

área de uma face quadrangular . . . . . . . . . . . . . . . . . . . . 166

A.2 Coordenadas locais dos baricentros das faces do tetraedro 169

A.3 Coordenadas locais dos baricentros das faces do hexaedro 169

A.4 Coordenadas locais dos baricentros das faces do prisma . . 170

A.5 Coordenadas locais dos baricentros das faces da pirâmide 170

A.6 Coordenadas locais dos baricentros e volume dos subele-

mentos do tetraedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171

A.7 Coordenadas locais dos baricentros e volume dos subele-

mentos do hexaedro . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171

A.8 Coordenadas locais dos baricentros e volume dos subele-

mentos do prisma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172

A.9 Coordenadas locais dos baricentros e volume dos subele-

mentos da pirâmide . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172

ix



Lista de símbolos

Grandezas físicas

C Condutância genérica

F Função fluxo fracionário

g Magnitude da aceleração da gravidade LT?2

g Vetor aceleração da gravidade LT?2

G Função potencial associada à gravidade L2 T?2

K Tensor permeabilidade absoluta L2

k r Permeabilidade relativa

m? Fluxo de massa MT?1

M Massa M

P Pressão ML?1 T?2

r Vetor posição de um ponto L
r Coordenada radial L

q Vazão L3 T?1

s Saturação

S Vetor área L2

t Tempo T

u Coordenada na direção axial de um poço L

v Vetor velocidade LT?1

V Volume L3

WI Índice de poço L3

x , y , z Coordenadas cartesianas L

? Fluxo genérico através de uma fronteira
? Mobilidade M?1 LT

x



µ Viscosidade dinâmica ML?1 T?1

? Fluxo parcial associado ao termo da gravidade L5 T?2

$ Vazão entre poço e reservatório L3 T?1

$? Vazão por unidade de comprimento de poço L2 T?1

? Pressão na interface entre poço e reservatório ML?1 T?2

? Termo fonte na equação genérica de conservação

? Densidade ML?3

? Produto da mobilidade total e a densidade média L?2 T

? Porosidade

? Densidade de fluxo genérica
? Grandeza escalar genérica
? Tempo adimensional

? Função auxiliar associada ao termo da gravidade M?1 LT
? Coordenada na direção da gravidade L

?,?,? Coordenadas locais L

Subíndices

adm Admissível

aux Auxiliar

M Médio

max Máximo

min Mínimo

o Fasea óleo

ref Referido ao nível de referência

w Fase água

wo Dependente de ambas as fases, água e óleo

T Total

? Fase genérica

Entidades geométricas

B Malha superficial associada a um contorno
e Elemento

E Conjunto de elementos

xi



f Face
?f Baricentro de uma face
F Conjunto de faces
` Nó (vértice) quando referido a um elemento

M Malha volumétrica
n Nó (vértice)

N Conjunto de nós
p Nó (vértice) quando associado a um volume de controle

s Subelemento
?s Baricentro de um subelemento
S Superfície de controle
V Volume de controle
W Malha unidimensional associada a um poço
be Elemento de contorno
bE Conjunto de elementos de contorno
bf Face de contorno
bF Conjunto de faces de contorno
we Elemento de poço
wE Conjunto de elementos de poço
? Domínio
?? Contorno

Grandezas associadas à discretização

A Matriz de coeficientes de um sistema de equações lineares
A Coeficiente de uma equação linear. Amplitude da distorção

de uma malha

b Vetor de termos independentes de um sistema de equações
lineares

b Termo independente de uma equação linear

D Matriz de derivadas parciais das funções de forma
h Comprimento representativo dos elementos de uma malha

I Tensor identidade
J Matriz jacobiana da transformação de coordenadas
nB( f ) Nó (volume de controle) localizado atrás da face f , de

acordo com a orientação absoluta

xii



nC(bf ) Nó (volume de controle) associado à face de contorno bf

nF( f ) Nó (volume de controle) localizado a frente da face f , de

acordo com a orientação absoluta

N Função de forma
N en Número de nós (vértices) do elemento e

N Me Número total de elementos da malha M
N Mn Número de nós (vértices) da malha M
Nt Número de níveis de tempo discretos

? Coeficiente associado a um esquema de interpolação local

em um elemento

? Operador associado à aproximação do fluxo difusivo através
de uma face

? Componente do operador associado à aproximação do fluxo

difusivo através de uma face

?S Vetor área associado a uma entidade geométrica da malha
?t Intervalo de tempo
?V Volume de uma entidade geométrica da malha
? Norma do erro associado a uma aproximação numérica

? Parâmetro auxiliar que fornece o sinal apropriado para o

vetor área de face em relação a um volume de controle

Outros símbolos

??? Derivada parcial da variável ? em relação à variável inde-
pendente ?

?? Gradiente da variável escalar ?
?·? Divergente da variável vetorial ?
?? Valor médio da variável ?
?? Valor nodal da variável ?
?? Vetor de valores nodais da variável ?
??

e
Vetor de valores nodais da variável ? no elemento e

b?cm Valor da variável ? no nível de tempo m
AT Transposta da matriz A
A?1 Inversa da matriz A
A?T Inversa da transposta da matriz A

xiii



Resumo

A simulação numérica é uma das ferramentas mais poderosas que auxi-

liam a tomada de decisões nos processos de produção de reservatórios

de petróleo. Entretanto, atualmente há uma defasagem entre a qualidade

da descrição física e geométrica dos reservatórios disponível e a capaci-

dade dos métodos numéricos empregados para resolver os modelos de

escoamento multifásico nos simuladores comerciais. O grande desafio é

incorporar essa informação detalhada em modelos numéricos de modo a

incrementar a precisão e a confiabilidade das simulações obtidas. Uma

das alternativas para tanto, analisada neste trabalho, é a utilização de ma-

lhas não-estruturadas híbridas como base geométrica para a discretização

das equações que modelam o escoamento nos reservatórios. As malhas

tridimensionais consideradas podem estar formadas, no caso mais geral,

por quatro tipos de elementos: tetraedros, hexaedros, prismas e pirâmi-

des. Uma vez que cada um desses tipos de elementos se adapta melhor

à discretização de determinados tipos de geometrias, a possibilidade de

utilizá-los do modo unificado em uma mesma formulação confere a ela

um alto grau de flexibilidade geométrica. O método de volumes finitos

baseado em elementos é considerado para a discretização das equações

diferenciais que descrevem o escoamento multifásico nos reservatórios.

Uma das principais características do método, de importância fundamen-

tal na simulação de reservatórios, é a conservação estrita das grandezas

físicas no nível discreto. Mediante experimentos numéricos empregando a

formulação apresentada, diversas características da metodologia são ava-

liadas neste trabalho.

xiv



Abstract

Numerical simulation is a powerful tool for predicting the production per-

formance of petroleum reservoirs. However, it is evident an increasing

gap between the quality of the geologic models currently available and the

capacity of numerical models in reservoir simulators. The incorporation of

such detailed geometrical and physical information in flow numerical mo-

dels, in order to increase accuracy and reliability, is a big challenge today.

An option for that, analyzed in this work, is the use of hybrid unstructured

grids as geometrical basis for the discretization of differential equations.

The three-dimensional grids considered are formed by tetrahedra, hexahe-

dra, prisms, and pyramids, in the most general case. A numerical formu-

lation treating those elements in a unified way achieves a high degree of

flexibility for dealing with complex domains. In order to achieve that, the

element-based finite volume method is considered for the discretization of

the multiphase flow differential equations. The strict conservation of phy-

sical quantities at discrete level is one of the main features of the method,

and a fundamental one for reservoir simulation. By means of numerical

experiments, several properties of the described numerical formulation

are evaluated in this work.

xv



CAPÍTULO

1
Introdução

A simulação de reservatórios de petróleo tem como meta final a previsão

da produção de hidrocarbonetos de um reservatório sob diferentes estra-

tégias de operação. Para tanto, modelos matemáticos do escoamento de

fluidos no reservatório devem ser aproximados numericamente e resolvi-

dos com auxílio de equipamentos computacionais. Todo modelo numé-

rico está baseado em aproximações numéricas das equações governantes,

associadas a uma representação discreta do domínio de solução, a deno-

minada malha computacional.

Nos primórdios da simulação de reservatórios consideravam-se ma-

lhas extremamente simples para representar a geometria de um reservató-

rio. Isso, por uma parte, permitia simplificar o modelo numérico a ponto

de permitir a solução das equações resultantes com os recursos computa-

cionais disponíveis na época. Além do mais, o conhecimento da estrutura

física dos reservatórios, que a tecnologia da época permitia determinar, era

também bastante limitado. Contudo, essa situação tem mudado significa-

tivamente em anos recentes, em que modelos geológicos tridimensionais

bastante detalhados podem ser obtidos, graças a avanços sustanciais em

disciplinas tais como a geofísica, a petrofísica e a geoestatística. Os mo-

delos geológicos disponíveis atualmente contêm muita mais informação

1



INT RO DUÇÃO 2

sobre a estrutura física dos reservatórios da que pode ser utilizada na si-

mulação dos escoamentos associados [29].
Na atualidade, a maioria dos simuladores comerciais empregam as

denominadas malhas corner point [13, 19], para a representação geomé-
trica dos reservatórios. Essas malhas são formadas por hexaedros, os quais

estão organizados mantendo a mesma estrutura lógica das malhas carte-

sianas. No entanto, como nas malhas corner point é possível especificar as

coordenadas dos vértices dos hexaedros, estas podem ser não-ortogonais.

Graças a isso é possível conformar as faces dos volumes com algumas su-

perfícies do modelo geológico, tais como os horizontes que separam ca-

madas de diferente material rochoso ou falhas geológicas. Contudo, como

a malha deve manter uma estrutura lógica rígida, a representação de algu-

mas dessas características geométricas do reservatório pode ser bastante

grosseira. A figura 1.1 mostra um exemplo de uma malha corner point

representando a geometria de um reservatório.

Volume de controle

Figura 1.1 – Exemplo de um reservatório discretizado por uma malha cor-
ner point.

Em certas aplicações pode ser necessária a representação mais acu-

rada da geometria de componentes críticos do modelo físico de um re-

servatório, como falhas, fraturas ou poços. Uma alternativa, para tanto,

é o uso de malhas não-estruturadas, as quais são amplamente utilizadas

em outras disciplinas, por exemplo, CFD 1, análise estrutural, eletromag-

1 Computational fluid dynamics.



INT RO DUÇÃO 3

netismo e outras. Nesse tipo de malhas, o domínio de solução é dividido

em entidades de geometria simples, as quais não precisam ser arranjadas

de acordo a uma estrutura predeterminada. Graças a essa característica, as

malhas não-estruturadas podem representar geometrias altamente com-

plexas de modo preciso e eficiente. O presente trabalho está dedicado ao

desenvolvimento de uma formulação numérica de volumes finitos, capaz

de resolver problemas de escoamento multifásico em reservatórios discre-

tizados por meio de malhas não-estruturadas tridimensionais.

Uma das primeiras tentativas de aplicação de malhas não-estruturadas

à simulação de reservatórios tridimensionais deu-se no início da década de

noventa, com as denominadas malhas de Voronoi 2 [29, 30, 48, 79]. Nessas
malhas, as interfaces entre volumes de controle vizinhos são perpendicu-

lares aos segmentos que unem os pontos em que as variáveis são aproxi-

madas e, além disso, cortam esses segmentos no ponto médio. Graças a

tal propriedade, ilustrada na figura 1.2, o fluxo em uma interface pode ser

aproximado considerando apenas valores correspondentes aos dois pon-

tos vizinhos à interface. Essa simplificação, contudo, somente é válida se o

meio poroso representado for isotrópico.

Volume decontrole 

Face perpendicularà reta entre nós vizinhos  
Figura 1.2 – Exemplo de uma malha de Voronoi aplicada a discretização de

um reservatório.

Apesar de ter sido desenvolvida uma extensão das malhas de Voronoi

para casos anisotrópicos, as denominadas malhas kPEBI [29], sua apli-

2 Mais conhecidas na área como malhas PEBI (perpendicular bisection).



INT RO DUÇÃO 4

cação era limitada a baixos níveis de anisotropia. Além disso, como no

exemplo da figura 1.2, na maioria das discretizações aplicando malhas de

Voronoi a malha era não-estruturada apenas no plano horizontal. Mais

recentemente foram propostas técnicas para construção de malhas híbri-

das baseadas em uma generalização dos diagramas de Voronoi [5, 21, 55].
Nessas malhas híbridas, um exemplo das quais é mostrado na figura 1.3, a

maior parte do reservatório é discretizado por uma malha estruturada cor-

ner point, a vizinhança dos poços por malhas cilíndricas adaptadas à tra-

jetória dos poços e as regiões de transição por malhas com características

semelhantes às malhas de Voronoi. O intuito desse tipo de discretização

é a representação acurada da trajetória de poços direcionais. O modelo

numérico para o escoamento mantém, entretanto, as mesmas limitações

que nas malhas corner point e Voronoi quanto à representação de meios

anisotrópicos.

Malha ao redorde um poço

Figura 1.3 – Malha híbrida com geometria radial ao redor dos poços (repro-
duzida da referência [21]).

Na literatura, a maioria das aplicações de malhas não-estruturadas

mais gerais à simulação de reservatórios correspondem a formulações bi-

dimensionais, em que o reservatório é representado por uma malha de tri-

ângulos [17, 22, 26, 28], de quadriláteros [38, 70] ou uma mistura de triân-
gulos e quadriláteros [12, 24, 34]. Todas as publicações recém citadas em-
pregam variantes do denominado control-volume finite element method

(CVFEM), para a discretização das equações do modelo de escoamento.

Nesse método, as variáveis são aproximadas nos vértices da malha e os vo-



INT RO DUÇÃO 5

lumes de controle são construídos como entidades duais dos vértices, com

contribuições de diferentes elementos. Não existe, como em formulações

utilizadas com malhas de Voronoi, nenhum requisito de ortogonalidade

para a construção dos volumes de controle. Um volume de controle típico

do método é mostrado na figura 1.4, além de um exemplo de uma malha

não-estruturada de triângulos.

A derivação das equações discretizadas segue as diretrizes do método

de volumes finitos, em que cada equação representa o balanço de alguma

grandeza física em um volume de controle. Nesses balanços, os fluxos nas

interfaces entre volumes de controle podem ser determinados mediante

aproximações numéricas restritas aos elementos da malha. Devido a essas

características, neste trabalho prefere-se empregar para esse tipo de abor-

dagem o nome de método de volumes finitos baseado em elementos [45]. A
formulação numérica apresentada nos capítulos subsequentes segue esse

enfoque básico e o estende a malhas tridimensionais híbridas, formadas

por tetraedros, hexaedros, prismas e pirâmides.

Volume decontrole

Elemento
Figura 1.4 – Exemplo de uma malha não-estruturada de triângulos (repro-

duzida da referência [28]) e da construção de um volume de
controle no método de volumes finitos baseado em elementos.

Algumas formulações empregando malhas não-estruturadas tridimen-

sionais têm sido publicadas em anos recentes, a maioria delas voltadas à

simulação de reservatórios fraturados [25, 33, 50, 53, 58, 68]. Nessas for-
mulações, as fraturas são representadas de forma discreta, segundo ilus-

tra a figura 1.5, aproveitando a flexibilidade geométrica das malhas não-

estruturadas.



INT RO DUÇÃO 6

Fracturas
Figura 1.5 – Malha de prismas para a representação discreta de fraturas em

um meio poroso (reproduzida da referência [33]).

1.1 Escopo e contribuições

O objetivo principal deste trabalho é desenvolver uma extensão para três

dimensões do método de volumes finitos baseado em elementos, apta para

ser aplicada à simulação de reservatórios. De forma semelhante ao caso

bidimensional, em que é possível tratar de forma unificada malhas não-

estruturadas de triângulos e/ou quadriláteros, a formulação apresentada
considera malhas que podem estar constituídas por elementos de formas

diferentes. As malhas tridimensionais consideradas podem estar formadas

por hexaedros, tetraedros, prismas, pirâmides ou uma mistura de todos

esses elementos. É possível antever o grande potencial da aplicação de

malhas híbridas, formadas por esses tipos de elementos, para a represen-

tação de detalhes geométricos importantes dos reservatórios de petróleo.

A possibilidade de considerar diferentes elementos na discretização de um

domínio físico confere um grau adicional de flexibilidade a uma formula-

ção numérica para malhas não-estruturadas.

A descrição da formulação é realizada de forma sistemática, abordando

inicialmente os aspectos puramente geométricos da metodologia, para de-

pois apresentar as aproximações numéricas associadas, em ordem cres-

cente de complexidade. Alguns aspectos importantes que nem sempre

são descritos adequadamente na literatura, por exemplo, a especificação



INT RO DUÇÃO 7

de malhas não-estruturadas, são abordados com certo detalhe. Especial

ênfase é dada a definição de uma notação completa e consistente para

associar as aproximações numéricas a entidades geométricas das malhas

computacionais.

Para a apresentação da formulação numérica adotou-se um enfoque

que vai do geral ao particular de forma gradual. Inicialmente são descritas

as aproximações numéricas básicas de modo geral, sem qualquer parti-

cularização específica aos modelos de escoamentos em reservatórios de

petróleo. Por uma parte, isso facilita a apresentação, pois permite focar a

descrição nos aspectos numéricos relevantes sem que detalhes específicos

a um dado modelo tornem as equações mais complexas do necessário. Por

outro lado, essa abordagem permitirá que o trabalho sirva de base para

futuros trabalhos visando aplicar a metodologia apresentada a outro tipo

de problemas físicos.

Após consolidadas as bases geométricas e numéricas da metodologia,

ela é aplicada à discretização de um modelo de escoamento bifásico em re-

servatórios. Um dos componentes chave para uma formulação aplicada à

simulação de reservatórios é a modelagem do escoamento entre os poços e

o reservatório. Para a discretização na vizinhança dos poços é considerada

uma abordagem similar à proposta em [5, 21], com malhas de geometria
cilíndrica acompanhando a trajetória dos poços. Entretanto, diferente-

mente das malhas consideradas nas referências citadas, com a formulação

de volumes finitos baseada em elementos não existe qualquer restrição de

ortogonalidade para a discretização dos reservatórios. Complementando

esse tipo de representação geométrica, é considerado um procedimento

especial para determinar os denominados índices de poço, os quais são

empregados para modelar o escoamento entre um poço e o reservatório.

1.2 Organização do trabalho

Este trabalho está dividido em 7 capítulos, incluindo a presente introdução

e a conclusão. Os restantes capítulos são sintetizados a seguir.

O capítulo 2 apresenta os conceitos relativos à geometria da discre-

tização em um método de volumes finitos baseado em elementos. Esses

conceitos serão aplicados nos capítulos subsequentes na descrição siste-

matizada da formulação numérica. Espacial atenção é dada aos aspectos



INT RO DUÇÃO 8

construtivos das entidades duais que determinam os volumes de controle,

dada a importância dessas entidades na metodologia adotada.

No capítulo 3 são apresentados os ingredientes básicos de uma for-

mulação numérica de volumes finitos baseada em elementos. As aproxi-

mações numéricas descritas neste capítulo possuem caráter geral, pois

podem ser aplicadas à discretização de equações que modelam um amplo

espectro de processos físicos, além daqueles encontrados na simulação

de reservatórios. O esquema de notação proposto para a metodologia é

descrito no início do capítulo.

No capítulo 4, os conceitos apresentados no capítulo 3 são aplicados

à discretização de uma equação de conservação de uma grandeza escalar

genérica. Essa equação é o protótipo das equações que compõem diversos

modelos de escoamentos, não apenas no âmbito da simulação de reser-

vatórios. Por esse motivo, o conteúdo desse capítulo, assim como o dos

capítulos precedentes, pode ser utilizado em outras formulações numéri-

cas aplicando a metodologia. A descrição da discretização da equação de

conservação genérica é realizada passo a passo até a fase final do processo,

que é a inclusão das condições de contorno do problema no sistema de

equações discretizadas.

No capítulo 5, o procedimento de discretização descrito em capítulos

precedentes é aplicado a um modelo de escoamento bifásico imiscível.

Além de descrever adequadamente diversos processos de deslocamento

em reservatórios, esse modelo e o suficientemente simples como para per-

mitir uma descrição detalhada do processo de discretização das equações.

Na parte final do capítulo é descrita a forma como o escoamento entre um

poço e o reservatório é modelado na formulação.

Por fim, o capítulo 6 é dedicado a apresentar resultados de alguns

exemplos de aplicação da formulação desenvolvida. No intuito de verifi-

car a convergência das soluções numéricas, problemas simplificados são

resolvidos em sequências de malhas com refinamento progressivo. Para

tanto, domínios de geometria simples e malhas de estrutura topológica

fixa são consideradas, a fim de manter sob controle a forma em que o refi-

namento das malhas é realizado. Considerando outro tipo de problemas,

é realizada a verificação do modelo de poço proposto no capítulo 5. Na

parte final do capítulo é apresentado um problema demonstrativo em um

reservatório sintético tridimensional.



CAPÍTULO

2
Aspectos geométricos
da discretização

2.1 Malhas não-estruturadas híbridas

De uma forma geral, uma malha computacional é um conjunto de entida-

des geométricas que constituem a representação discreta de um domínio

espacial. O propósito de uma malha é proporcionar o suporte geométrico

ao processo de discretização das equações governantes de um problema

físico definido nesse domínio. Assim, em um método numérico, a repre-

sentação discreta das variáveis do problema sempre está associada a de-

terminadas entidades da malha computacional.

Uma malha é composta, em geral, por entidades geométricas de dife-

rente dimensão. Em uma malha definida em Rn coexistem entidades de
dimensão d = 0, . . . , n , com relações de interdependência entre elas. As
entidades de dimensão n são as entidades principais da malha, pois são

as porções finitas em que o domínio é dividido. Neste trabalho, como na

maior parte da literatura, essas entidades são denominadas de elementos.

9



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 10

EmR3, os elementos são corpos poliédricos, geralmente de forma simples,
sendo os mais comuns os tetraedros e os hexaedros.

Cada entidade de uma malha é limitada por entidades de dimensão

menor. Assim, em malhas tridimensionais, os elementos encontram-se li-

mitados por entidades de dimensão 2, as quais recebem o nome de facetas.1

As facetas, por sua vez, são limitadas por entidades de dimensão 1, as

arestas. Por fim, nas duas extremidades de uma aresta encontram-se os

vértices, que são entidades de dimensão 0. A figura 2.1 ilustra todas as

entidades mencionadas, em uma porção de malha tridimensional.

Elemento
Aresta

Vértice

Faceta
Figura 2.1 – Entidades básicas em uma malha tridimensional.

A seguir são formalizadas algumas definições referidas à malha com-

putacional.

Definição 2.1. M é uma malha do domínio fechado ?, se satisfaz as se-
guintes condições [23]:

C1: Todo elemento e de M possui um interior não-vazio.
C2: A interseção do interior de dois elementos em M é o

conjunto vazio.

C3: ?=
?

e?M e .

1 Na literatura, o nome mais comum para essas entidades é face, porém, neste trabalho
essa denominação é reservada para as entidades que limitam os volumes de controle, os quais
serão definidos mais adiante.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 11

Definição 2.2. A conectividade de uma malha é a definição das conexões
entre seus vértices [23].

Definição 2.3. Uma malha não-estruturada é uma malha cuja conectivi-
dade é irregular e, portanto, deve ser definida explicitamente.

Diferentemente, a conectividade de uma malha estruturada pode es-

tar definida de forma implícita, por exemplo, por um mapeamento entre

seus vértices e os elementos de uma matriz. Entretanto, tal mapeamento

requer uma organização rígida de elementos e vértices, o qual dificulta a

geração desse tipo de malhas em domínios de geometria complexa. Ao

contrário, as malhas não-estruturadas possuem uma extraordinária flexi-

bilidade geométrica, uma vez que vértices e elementos podem estar dis-

tribuídos de modo quase arbitrário. Devido a isso, a melhor alternativa

para a discretização espacial de domínios de geometria complexa são as

malhas não-estruturadas. A conveniência deste tipo de malhas é ainda

maior quando se requer soluções mais precisas em determinadas regiões

do domínio, pela facilidade de realizar refino localizado nessas regiões.2

Definição 2.4. Uma malha mista ou híbrida é uma malha que possui ele-
mentos de diferente forma geométrica.3

As malhas híbridas proporcionam um grau de flexibilidade adicional

em relação às malhas não-estruturadas de um único tipo de elemento. O

objetivo da utilização de malhas híbridas é o melhor aproveitamento das

características de cada tipo de elemento em diferentes regiões do domínio.

Em aplicações de CFD em três dimensões, as malhas não-estruturadas

mais comuns são as malhas de tetraedros, principalmente porque os al-

goritmos de geração desse tipo de malhas são mais robustos e sofisticados,

permitindo discretizar virtualmente qualquer geometria de forma automá-

tica ou com pouca intervenção do usuário [8, 57]. Entretanto, os elementos
hexaédricos produzem malhas mais compactas4 e apresentam caracte-

rísticas geométricas mais favoráveis do ponto de vista numérico, espe-

cialmente quando é necessário utilizar elementos com razão de aspecto

2 Isto é, reduzir o tamanho médio dos elementos nessas regiões do domínio.
3 Em alguns textos, a denominação de malha híbrida é atribuída a malhas mistas que

apresentam regiões estruturadas e não-estruturadas [23, 73]. Entretanto, neste trabalho não
será considerada essa distinção e as duas denominações serão utilizadas como equivalentes.

4 Mais compactas no sentido de possuir menos elementos para um dado número de
vértices. Dependendo do tipo de implementação, isto pode gerar uma importante economia
de recursos computacionais.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 12

grande.5 Porém, preencher um domínio tridimensional arbitrário conside-

rando apenas elementos hexaédricos é uma tarefa que envolve um enorme

grau de dificuldade. Nesse sentido, nenhum algoritmo desenvolvido para

geração de malhas de hexaedros se equipara aos algoritmos existentes para

geração de malhas tetraédricas [15, 52, 57].
A utilização conjunta de tetraedros e hexaedros em malhas híbridas

é uma alternativa promissora para a discretização de domínios tridimen-

sionais complexos. De uma forma geral, a ideia central para a construção

dessas malhas é discretizar as regiões mais importantes do domínio com

hexaedros, deixando os tetraedros para preencher as regiões de geometria

mais intrincada ou de menor importância, ou, inclusive, as porções onde

for necessário considerar refino localizado. Contudo, a transição entre

hexaedros e tetraedros requer a introdução de elementos adicionais, tais

como prismas e pirâmides, a fim de garantir a conformidade da malha. A

conformidade é uma condição necessária para vários métodos numéricos,

entre eles o método de volumes finitos baseado em elementos.

Definição 2.5. A malha M é uma malha conforme se satisfaz as condições
da definição 2.1, além da condição:

C4: A interseção de dois elementos em M é o conjunto vazio,
um vértice, uma aresta ou uma faceta [23].

A modo de ilustração, a figura 2.2 apresenta alguns casos típicos de

não-conformidade, em que as condições da definição 2.5 não são satisfei-

tas. Em todos esses casos, o procedimento de construção dos volumes de

controle em um método de volumes finitos baseado em elementos pro-

duz volumes anômalos, em que a superfície de controle não é fechada.

Portanto, inclusive a ocorrência de apenas uma única situação de não-

conformidade na malha utilizada pode tornar inconsistente o modelo nu-

mérico obtido com o método.

Como mencionado anteriormente, malhas híbridas que compreen-

dem apenas tetraedros e hexaedros não satisfazem as condições de con-

formidade. A situação usual nesse caso é como a mostrada na figura 2.2(d),

em que a faceta quadrangular de um hexaedro coincide com as facetas

5 Um exemplo tipico é a discretização de reservatórios de petróleo, em que a dimensão
vertical é geralmente muito menor que as outras dimensões. Essa situação obriga a utilizar
elementos de razão de aspecto grande, a fim de manter reduzido o número global de
elementos da malha.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 13

Superposiçãode elementos Contatoparcial de facetas

Contatoparcial de arestas
Faceta em contato commais de uma faceta

(a)

(d)

(b)

(c)
Figura 2.2 – Exemplos de situações que não satisfazem as condições de

conformidade.

triangulares de dois tetraedros vizinhos. Em uma malha conforme, a fa-

ceta de um elemento deve coincidir exatamente com a faceta de um ele-

mento vizinho. Para isso ser possível em uma malha misturando hexaedros

e tetraedros, devem ser utilizados elementos de transição que possuam

tanto facetas triangulares como quadrangulares. Os elementos mais sim-

ples com essa característica geométrica são a pirâmide de base quadrada e

o prisma de base triangular. A fim de garantir a conformidade, uma faceta

triangular desses elementos deve coincidir sempre com a faceta de um te-

traedro, enquanto que uma faceta quadrangular deve fazê-lo com a faceta

de um hexaedro. A figura 2.3 ilustra exemplos de transições conformes

entre hexaedros e tetraedros.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 14

Hexaedro

Hexaedro

Pirâmide

Prisma

Tetraedro

Tetraedro

(a)

(b)
Figura 2.3 – Exemplos de transição conforme entre hexaedros e tetraedros.

2.2 Especificação de uma malha não-estruturada

A construção de uma malha a partir da geometria de um domínio tridi-

mensional é uma operação que envolve um alto nível de complexidade.

Essa tarefa é realizada, em geral, por softwares especializados que execu-

tam algoritmos sofisticados a fim de garantir que as malhas geradas aten-

dam os requerimentos de uma dada formulação numérica. Apesar de os

procedimentos de geração de malha não serem abordados aqui, pois não é

o objeto do presente trabalho6, é importante descrever, ainda que de ma-

6 Diferentes métodos e algoritmos para geração de malhas não-estruturadas tridimensio-
nais são descritos em detalhes, por exemplo, nas referências [23, 52, 57, 74, 75, 81]



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 15

neira sucinta, a forma de especificação das malhas não-estruturadas. Este

conhecimento é necessário para poder interpretar em um código compu-

tacional as malhas vindas de um software de geração e também para esta-

belecer uma estrutura de dados adequada para manipulá-las no código.

Existem diversas alternativas para a especificação de uma malha não-

estruturada. Na maioria delas, o ponto de partida é a especificação dos

vértices da malha, estabelecendo a localização de todos eles em relação

a um sistema de coordenadas, usualmente cartesiano. Para uma iden-

tificação unívoca, a cada vértice deve estar associado um índice único,

estabelecendo-se dessa forma um esquema de numeração global para os

vértices da malha, conforme ilustrado na figura 2.4 para um caso simples.

1 2 3 4 5
6 7 8 9

10
11

12
13

14

1516 18
19

20

26

21

22

23
24 17

25
z

x y Coordenadas dos vértices
1 2,104 5,203 7,3052 1,596 7,002 8,3043 2,697 8,987 7,0124 3,003 9,345 6,232

x y zVértice

Figura 2.4 – Exemplo da especificação dos vértices de uma malha.

As restantes entidades da malha podem ser definidas com base nos

vértices já especificados. Neste ponto é possível considerar diferentes pos-

sibilidades. Por exemplo, pode ser empregada uma descrição hierárquica



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 16

[23] em que as arestas são especificadas com base nos vértices, as face-
tas são especificadas com base nas arestas e, por fim, os elementos são

especificados com base nas facetas. Essa abordagem, na qual é definido

um esquema de numeração global próprio para cada tipo de entidade da

malha, é demasiado geral para a maioria dos métodos numéricos, em que

não todas as entidades possuem a mesma importância. Em métodos em

que a maioria das operações é realizada em nível de elemento, como no

método clássico de elementos finitos e também no método de volumes fi-

nitos baseado em elementos, é suficiente a especificação da conectividade

dos elementos para completar a definição de uma malha. Nessa aborda-

gem, arestas e facetas ficam determinadas de forma implícita e podem ser

acessadas localmente em cada elemento, se necessário.

A lista dos vértices associados a um dado elemento, ordenada segundo

algum esquema convencional, é suficiente para definir a conectividade

desse elemento. Nessa lista, os vértices devem ser identificados mediante

os índices globais especificados no passo prévio. Conforme ilustra a figura

2.5, um índice próprio é atribuído também a cada elemento para poder

identificá-lo posteriormente. Além disso, nas malhas híbridas pode ser

necessário indicar explicitamente a forma geométrica de cada elemento,

caso essa informação não possa ser inferida a partir do número de vértices

especificado para o elemento. A ordenação convencional dos vértices para

todos os tipos de elementos considerados neste trabalho é indicada na

seção seguinte.

A lista de vértices especificada para definir a conectividade de um

elemento determina de forma indireta um esquema numeração local para

seus vértices. Assim, por exemplo, no elemento 1 da malha mostrada na

figura 2.5, o vértice com índice global 3 pode ser identificado localmente

como vértice 1, o vértice 5 como vértice local 2, o vértice 21 como vértice

local 3, e assim por diante. A especificação da conectividade de um ele-

mento pode ser vista também como a definição de um esquema de conver-

são global/local para a indexação dos vértices. Essa conversão possui um
papel fundamental nos métodos numéricos baseados em elementos, pois

o resultado de muitas operações que são realizadas em nível de elemento

deve ser depois utilizado de forma global e vice-versa. Como será visto

na próxima seção, com base na numeração local dos vértices é possível

também fazer a descrição completa da topologia dos diferentes tipos de

elementos.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 17

1119
22

1 3
5

6
10

13
1821

24

2
4

7 8 9
12

14

151620

26

23

Elemento 1 Elemento 2

Conectividade dos elementos
17

25

1 3 5 21 17 6 1 24 252 13 10 5 18 - - - -3 5 3 17 21 16 - - -

Eleme
nto

1º vért
ice

2º vért
ice

3º vért
ice

4º vért
ice

5º vért
ice

6º vért
ice

7º vért
ice

8º vért
ice

z
x y

Figura 2.5 – Exemplo da especificação dos elementos de uma malha.

2.3 Topologia dos elementos

A topologia de um elemento tridimensional pode ser completamente des-

crita em termos de suas facetas, arestas e vértices [23]. Por sua vez, as
facetas e arestas podem ser definidas com base nos vértices do elemento,

ordenados segundo algum esquema convencional. Consequentemente, a

descrição completa da topologia de um elemento pode ser realizada em

termos dos vértices, após ser estabelecida a referida convenção para a or-

denação dessas entidades. Nesta seção é descrita a topologia dos qua-

tro tipos de elemento considerados neste trabalho: tetraedros, hexaedros,

prismas e pirâmides. A descrição da topologia é realizada com base na

convenção usual para a ordenação de vértices em cada tipo de elemento.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 18

2.3.1 Tetraedro

O tetraedro é um elemento de quatro facetas triangulares, seis arestas e

quatro vértices. Os vértices do tetraedro são numerados convencional-

mente utilizando a regra da mão direita [84]. O intuito é garantir que
o volume do tetraedro, calculado mediante determinantes, seja sempre

positivo. Para tanto, posiciona-se a mão direita em uma faceta qualquer

do elemento com o polegar apontando para o vértice oposto. Numeram-

se, então, os vértices da faceta escolhida no sentido indicado pelos quatro

dedos restantes, conforme ilustrado na figura 2.6. O último vértice a nu-

merar é o vértice oposto à faceta considerada.

2
3

1

4

Arestas
1 1 22 2 33 3 14 1 45 2 46 3 4

Aresta 1º vért
ice

2º vért
iceFacetas

1 1 3 22 1 4 33 1 2 44 2 3 4

Faceta 1º vért
ice

2º vért
ice

3º vért
ice

Figura 2.6 – Topologia do tetraedro.

Na figura 2.6 é indicada também a definição local de facetas e arestas,

conforme a referência [23]. É importante notar que implícita nessa defi-
nição encontra-se uma dada orientação para essas entidades. Assim, as

arestas podem ser consideradas como segmentos dirigidos, com orienta-

ção do primeiro ao segundo vértice. De modo semelhante, na definição



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 19

das facetas, a ordenação dos vértices determina um sentido de rotação

que, pela regra da mão direita, induz uma orientação positiva apontando

sempre para fora do elemento.

Como é lógico, quando a conectividade de um elemento tetraédrico

for especificada, a ordenação dos vértices deverá respeitar a convenção

anteriormente citada. Deve-se notar, no entanto, que um mesmo ele-

mento pode ser especificado de múltiplas formas equivalentes. Assim,

por exemplo, se a conectividade de um dado elemento for especificada

pela lista de vértices (a , b , c , d), o mesmo elemento poderá ser definido
também pelas listas (b , c , a , d) e (c , a , b , d), as quais cumprem do mesmo
modo a regra da mão direita. De fato, existem em total doze permutações

na lista de vértices de um tetraedro que satisfazem essa regra, todas sendo

representações válidas da conectividade desse elemento.

2.3.2 Hexaedro

O hexaedro é um elemento que possui seis facetas quadrangulares, doze

arestas e oito vértices. Ele é topologicamente equivalente a um cubo, ape-

sar de que, em um caso geral, suas facetas podem não ser planas. A figura

2.7 ilustra a convenção para a numeração dos vértices de um hexaedro,

assim como uma possível definição de suas facetas e arestas com base nos

vértices.

A numeração dos vértices do hexaedro segue uma convenção seme-

lhante à descrita para o tetraedro. Primeiro são numerados os vértices de

uma faceta do elemento, seguindo o sentido de rotação positivo dado pela

regra da mão direita. Para tanto, posiciona-se a mão direita sobre a faceta

em questão, com o polegar apontando para a faceta oposta, como mostra

a figura 2.7. Seguidamente são numerados os vértices da faceta oposta,

começando pelo vértice oposto ao primeiro vértice da faceta já numerada

e seguindo o mesmo sentido de rotação considerado nela.

A especificação da conectividade de um hexaedro deve levar em conta

a convenção descrita acima para a ordenação dos vértices. Caso contrá-

rio, podem surgir ambiguidades, por exemplo, no cálculo das grandezas

geométricas associadas ao elemento. Entretanto, igual que no caso do

tetraedro, a especificação de um hexaedro não é única, sendo que dife-

rentes listas de vértices satisfazem o critério de ordenação descrito e são,

portanto, especificações válidas para o elemento.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 20

2

6
4

8

3
1

5

Arestas
1 1 22 2 33 3 44 4 15 5 66 6 77 7 88 8 59 1 510 2 611 3 712 4 8

Aresta 1º vért
ice

2º vért
ice

Facetas
1 1 4 3 22 1 5 8 43 1 2 6 54 5 6 7 85 2 3 7 66 3 4 8 7

Faceta 1º vért
ice

2º vért
ice

3º vért
ice

4º vért
ice

7

Figura 2.7 – Topologia do hexaedro.

2.3.3 Prisma
O prisma triangular, ou simplesmente prisma, é um elemento que pos-

sui duas facetas triangulares opostas, separadas por três facetas de forma

quadrangular. Além disso, o prisma possui nove arestas e seis vértices.

Apesar de existirem facetas de forma diferente, a configuração topológica

em todos os vértices do prisma é idêntica.7 Isto é, em qualquer um dos seis

vértices do prisma confluem três arestas e três facetas, das quais duas são

sempre quadrangulares e uma triangular.

7 No tetraedro e no hexaedro se produz também este tipo de simetria. Isso é mais
evidente nesses elementos pelo fato de todas as facetas serem triângulos ou quadriláteros,
respectivamente.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 21

A figura 2.8 mostra a numeração convencional dos vértices do prisma,

além da definição das arestas e facetas em função da numeração local dos

vértices. Para tal numeração, consideram-se inicialmente os vértices de

uma das facetas triangulares, os quais são numerados segundo o sentido

positivo dado pela mão direita, com o polegar apontando para a faceta

triangular oposta. Depois são numerados os vértices nessa faceta oposta,

seguindo o mesmo sentido e começando no vértice oposto ao primeiro

vértice numerado.

2

5
3

6
1

4

Arestas
1 1 22 2 33 3 14 4 55 5 66 6 17 1 48 2 59 3 6

Aresta 1º vért
ice

2º vért
ice

Facetas
1 1 3 2 -2 4 5 6 -3 1 4 6 34 1 2 5 45 2 3 6 5

Faceta 1º vért
ice

2º vért
ice

3º vért
ice

4º vért
ice

Figura 2.8 – Topologia do prisma.

2.3.4 Pirâmide

O elemento piramidal considerado em malhas híbridas é uma pirâmide

de base quadrangular. Ele possui, portanto, cinco facetas, das quais qua-

tro são triangulares e uma quadrangular. O número de arestas é oito e

o número de vértices cinco. Nos quatro vértices da base quadrangular



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 22

convergem três arestas e três facetas. O vértice oposto à base, porém,

apresenta uma configuração topológica diferente, já que nele confluem

quatro arestas e as quatro facetas triangulares da pirâmide. Esse vértice

é comumente chamado de ápice.

O esquema de numeração considerado para os vértices da pirâmide é

ilustrado na figura 2.9. Sempre são numerados primeiro os vértices da base

quadrangular, seguindo o sentido positivo da mão direita com o polegar

apontando para o ápice. O último vértice a numerar é, precisamente, o

ápice. A figura 2.9 apresenta também a definição local das arestas e das

facetas da pirâmide.

2
41

5

3 Arestas
1 1 22 2 33 3 44 4 15 1 56 2 57 3 58 4 5

Aresta 1º vért
ice

2º vért
iceFacetas

1 1 5 4 -2 1 2 5 -3 2 3 5 -4 3 4 5 -5 1 4 3 2

Faceta 1º vért
ice

2º vért
ice

3º vért
ice

4º vért
ice

Figura 2.9 – Topologia da pirâmide.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 23

2.4 Entidades duais
As malhas e entidades descritas nas seções anteriores serão denominadas,

neste trabalho, malhas primárias e entidades primárias, respectivamente.

Elas determinam a representação discreta da região do espaço onde o pro-

blema físico a resolver está definido. É possível associar, entretanto, uma

entidade dual a cada entidade primária. A união das entidades duais forma

a que será denominada de malha dual, a qual pode ser considerada como

uma partição alterna do domínio de solução. As entidades duais têm um

papel fundamental em um método de volumes finitos baseado em ele-

mentos, pois os volumes de controle, com base nos quais são construídas

as equações em nível discreto, são formadas por entidades duais, como se

verá mais adiante.

A primeira entidade dual que pode ser definida é a entidade dual do

elemento, que é um ponto interior a ele. Tal ponto é localizado conven-

cionalmente no baricentro dos vértices do elemento. Embora se trate de

uma escolha aparentemente arbitrária, essa localização possui várias van-

tagens, conforme será discutido posteriormente. Quanto às restantes en-

tidades duais, elas podem ser definidas primeiro em nível de elemento e

depois generalizadas mediante composição.

Uma entidade dual pode ser definida considerando entidades duais

de menor dimensão, estabelecendo-se dessa forma uma estrutura hierár-

quica semelhante à das entidades primárias. Assim, em um elemento, a

entidade dual de uma faceta é um segmento unindo a entidade dual do

elemento com um ponto sobre a faceta. Por sua vez, a entidade dual de

uma aresta é um polígono limitado pelas entidades duais das facetas adja-

centes à aresta mais dois segmentos construídos sobre essas facetas. Neste

trabalho, as entidades duais das arestas, definidas em nível de elemento,

são denominadas de faces. Finalmente, a entidade dual de um vértice é um

poliedro limitado por certo número de faces e polígonos construídos sobre

as facetas adjacentes ao vértice. Essa entidade dual é denominada aqui de

subelemento. A forma de construção das entidades duais será abordada

com maiores detalhes nas subseções seguintes.

A figura 2.10 mostra de forma esquemática as estruturas hierárquicas

das entidades primárias e duais em nível de elemento. Algumas caracte-

rísticas importantes devem ser ressaltadas. Em primeiro lugar, se d = k é
a dimensão de uma dada entidade primária, a dimensão da entidade dual



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 24

Entidades primárias Entidades duais

Subelemento (d = 3)Vértice (d = 0)

Elemento (d = 3) Baricentro (d = 0)

Aresta (d = 1)
Face (d = 2)

Faceta (d = 2) Segmento (d = 1)

Figura 2.10 – Entidades primárias e entidades duais em nível de elemento.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 25

correspondente é d = 3?k . Esta particularidade não é casual, já que deriva
de uma propriedade dos complexos celulares estudados na topologia al-

gébrica,8 dos quais as malhas aqui consideradas são casos particulares

[51, 76]. Outro aspecto a destacar é a correspondência de um para um
entre uma entidade primária e uma entidade dual. Isto implica que, na

prática, para identificar uma entidade dual pode ser utilizado o índice da

entidade primária correspondente e vice-versa.

2.4.1 Construção das faces

O processo de construção geométrica das faces é idêntico em todos os

elementos considerados, exceto na pirâmide, a qual possui algumas par-

ticularidades comentadas mais adiante. Como mostra a figura 2.11, no

tetraedro, no hexaedro e no prisma as faces são quadriláteros, determina-

dos por quatro pontos, denotados por M, R, C e L. Desses quatro pontos,

o ponto C, único interior ao elemento, é comum a todas as faces. Esse

ponto trata-se, em realidade, da anteriormente referida entidade dual do

elemento que, convencionalmente, é localizada no baricentro dos seus

vértices. A posição desse ponto, portanto, é dada pelo vetor 9

r
C
=

1

Nv

Nv
?

k=1

r?k , (2.1)

em que Nv é o número de vértices do elemento e r?k (k = 1, . . . , Nv) é o vetor
posição de cada um desses vértices.

A equação (2.1) mostra a conveniência de localizar o ponto C no bari-

centro dos vértices do elemento. Como se pode observar, a posição desse

ponto está influenciada exatamente da mesma forma pela posição de to-

dos os vértices do elemento. Isto torna tal posição invariante em rela-

ção à numeração desses vértices. Lembre-se que, na especificação da co-

nectividade de um elemento, diferentes permutações na lista de vértices

determinam um mesmo elemento. Ora, se a posição do ponto C fosse

dada por uma expressão em que a posição de cada vértice tivesse uma

8 A topologia algébrica é uma parte da matemática que estuda as propriedades topológicas
dos espaços associando-os com estruturas algébricas apropriadas [51]. Muitos conceitos
e resultados desta disciplina podem ser aplicados para a sistematização do tratamento de
malhas computacionais [7].

9 Note-se que o ponto C é localizado no baricentro dos vértices do elemento e não no
baricentro do próprio elemento. Apenas no tetraedro ambos os pontos coincidem sempre.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 26

ponderação diferente, para cada permutação na lista de vértices ter-se-

ria uma posição diferente para tal ponto. Esta situação seria altamente

inconveniente, pois se tratando de um mesmo elemento, o ponto C deveria

ter a mesma posição em todos os casos.

(a) (b)

(c)

M Ponto médio da arestaL, R Baricentros dos vértices associados às facetasadjacentes à arestaC Baricentro dos vértices do elemento

C

C

C
M

M

M
L

L

L
R

R

R

Figura 2.11 – Construção das faces no tetraedro, no hexaedro e no prisma.

No mais, o ponto M é um ponto localizado sobre a aresta da qual

a face em questão é a entidade dual. Além disso, os pontos R e L são

pontos localizados sobre as facetas adjacentes a essa aresta. Pelos mesmos

argumentos expostos no caso do ponto C, os pontos R e L são localizados

convencionalmente nos baricentros das respectivas facetas. Mais preci-

samente, são localizados nos baricentros dos vértices associados a essas

facetas, cuja posição é determinada por expressões análogas à equação

(2.1). De forma equivalente, o ponto M é considerado coincidente com o

ponto médio da aresta em questão.

A forma de construção geométrica descrita, denominada baricêntrica

[77], garante que as faces resultantes serão quadriláteros planos, se todas
as facetas quadrilaterais do elemento também forem planas. No tetraedro,



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 27

o qual possui somente facetas triangulares, as faces resultantes sempre são

planas. Entretanto, se o mesmo esquema de construção fosse empregado

também na pirâmide, algumas das faces resultantes não seriam planas,

mesmo se a base do elemento fosse plana [58]. Ainda que tal situação
não seja tão séria do ponto de vista numérico,10 neste trabalho preferiu-

se adotar um esquema de construção modificado.

Nesse esquema, o ponto comum a todas as faces é o ponto B, locali-

zado no baricentro dos vértices da base da pirâmide. Com essa variação

garante-se que todas as faces em uma pirâmide de base quadrada serão

planas. Conforme será visto no capítulo 3, uma pirâmide qualquer pode

ser mapeada em um pirâmide de base quadrada, mediante uma transfor-

mação de coordenadas adequada. A figura 2.12(a) ilustra a construção das

faces adjacentes às arestas que convergem no ápice da pirâmide. Essas

faces encontram-se determinadas pelos pontos M, R, B e L, os quais, com

exceção do ponto B, estão definidos da forma já descrita para os outros

elementos. As quatro faces restantes, aquelas adjacentes às arestas que

limitam a base da pirâmide, resultam faces triangulares. Conforme mos-

trado na figura 2.12(b), cada uma dessas faces está determinada pelo ponto

M, o ponto médio da aresta adjacente, o ponto B, o baricentro dos vértices

da base, e o ponto L, que é o baricentro dos vértices da faceta triangular

contígua.

(a) (b)
B

M L
R BM

L

Figura 2.12 – Construção das faces no elemento piramidal.

10 Nas faces devem ser aproximadas integrais de superfície e mesmo em faces quadran-
gulares não-planas é possível realizar essa aproximação de forma consistente, conforme é
mostrado no apêndice A.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 28

2.4.2 Construção dos subelementos

O conjunto das faces em um elemento gera uma subdivisão deste em certo

número de porções. Cada uma dessas porções é o que neste trabalho é

chamado de subelemento.11 Como mencionado anteriormente, os subele-

mentos podem ser considerados entidades duais dos vértices do elemento.

Existe, portanto, uma correspondência biunívoca entre vértices e subele-

mentos, de forma equivalente à correspondência entre arestas e faces.

As figuras 2.13, 2.14, 2.15 e 2.16 ilustram a subdivisão do tetraedro,

do hexaedro, do prisma e da pirâmide, respectivamente. Pode-se obser-

var que as faces subdividem também as facetas dos elementos em três ou

quatro porções quadrilaterais. Se as facetas dos elementos tridimensio-

nais fossem interpretadas como elementos bidimensionais, essas porções

seriam subelementos bidimensionais. Em relação à malha tridimensional,

porém, esses subelementos podem ser interpretados como faces externas.

Essas entidades são úteis na discretização dual do contorno dos domínios

tridimensionais, conforme se verá na seção 2.5.

(a)
(b)

Figura 2.13 – (a) As seis faces e (b) os quatro subelementos no tetraedro.

Todos os subelementos, exceto aquele associado ao ápice da pirâmide,

encontram-se limitados por três faces e três das faces externas antes ci-

tadas. Tratam-se de corpos hexaédricos, que possuem, além disso, uma

11 O nome subvolume de controle [45, 67] é também utilizado para essa entidade.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 29

(a)
(b)

Figura 2.14 – (a) As doze faces e (b) os oito subelementos no hexaedro.

propriedade adicional. No espaço transformado associado a cada tipo de

elemento,12 os subelementos possuem o mesmo volume. Com a divisão

baricêntrica gera-se, portanto, a distribuição mais equilibrada possível do

volume de um elemento. A exceção novamente é a pirâmide, na qual o

subelemento adjacente ao ápice, além de ser de forma octaédrica, possui

um volume maior que os restantes subelementos no correspondente es-

paço transformado.

2.4.3 Entidades duais compostas

As entidades duais definidas em nível de elemento podem ser reunidas

para formar entidades duais compostas. Assim, a entidade dual composta

de um vértice da malha é a reunião dos subelementos associados ao vér-

tice, em todos os elementos que o compartilham. Uma vez que, nos méto-

dos de volumes finitos baseado em elementos, as equações de conservação

são integradas nessas entidades compostas, elas são denominadas volu-

mes de controle, seguindo a nomenclatura clássica do método de volumes

finitos.

12 Em cada tipo de elemento é considerada uma transformação local de coordenadas que
auxilia em algumas aproximações numéricas. Essa transformação de coordenadas é descrita
na seção 3.3.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 30

(a)
(b)

Figura 2.15 – (a) As nove faces e (b) os seis subelementos no prisma.

(a)
(b)

Figura 2.16 – (a) As oito faces e (b) os cinco subelementos na pirâmide.

Como ilustração, a figura 2.17 apresenta um volume de controle em

uma malha mista. Nesse exemplo específico, elementos das quatro formas

consideradas contribuem na formação do volume mostrado. O volume de

controle resultante da união de subelementos é um corpo poliédrico, em

geral, bastante irregular. Sua forma depende da configuração específica da

malha primária em torno ao vértice interior. Quanto maior for o número

de elementos que confluam nesse vértice, mais complexa será a forma do

volume. Por construção, no interior de cada volume de controle existe um

vértice da malha, conforme mostra a figura 2.18. O volume de controle é,



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 31

precisamente, a entidade dual composta do vértice interior. Tal caracterís-

tica permite que, em um método numérico que considere essas entidades,

o volume de controle seja identificado pelo mesmo índice global do vértice

interior.

Volume decontroleMalhaprimária

Figura 2.17 – Volume de controle em uma malha tridimensional mista.

Os esquemas de construção geométrica das entidades duais, descritos

ao longo desta seção, dão origem a volumes de controle que preenchem o

mesmo espaço tridimensional que a malha primária, sem se superpor ou

deixar vazios. Em conjunto, os volumes de controle e as restantes enti-

dades duais formam uma malha alternativa para o domínio discretizado

pela malha primária. Trata-se de uma malha, em geral, de geometria mais

complexa que a malha original, pelo fato dos volumes de controle serem

corpos poliédricos usualmente mais irregulares que os elementos primá-

rios. Apesar dessa maior complexidade e das inúmeras formas que os

volumes de controle podem adquirir, sua manipulação é facilitada pelo

fato de estarem formados por componentes de geometria simples e bem

determinada.

Essa é, precisamente, uma das características fundamentais de um

método de volumes finitos baseado em elementos. Em vez de se lidar



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 32

Vértice central

Figura 2.18 – Corte de um volume de controle, mostrando o vértice central.

diretamente com os volumes e superfícies de controle, opera-se com suas

entidades componentes em nível de elemento. Como se viu nas subseções

prévias, o número de formas possíveis para essas entidades, os subelemen-

tos e as faces, é bastante reduzido. Isto torna sua manipulação em um

código computacional extremamente simples. Equações e outros entes

matemáticos associados aos volumes de controle são obtidos seguindo o

mesmo processo de construção destes, isto é, mediante composição das

contribuições associadas às entidades componentes em nível de elemento.

De resto, podem ser associadas também entidades duais compostas às

arestas e facetas da malha primária. Assim, reunindo as faces associadas

a uma aresta em todos os elementos que a compartilham, obtém-se uma

face composta. Por outro lado, unindo os dois segmentos duais a uma fa-

ceta, correspondentes aos dois elementos adjacentes, obtém-se a entidade

dual composta dessa faceta. A figura 2.19 ilustra esquematicamente essas



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 33

entidades compostas. Elas são mencionadas aqui por questões de com-

pleteza, já que não cumprem um papel importante no método abordado

neste trabalho. A superfície de controle, a qual limita um volume de con-

trole, poderia ser considerada como a união de faces compostas. Porém,

na maioria dos casos é mais conveniente considerar que tal superfície está

formada diretamente por faces simples.

Vértice (d = 0)

Entidades primárias Entidades duais

Volume decontrole (d = 3)

Facecomposta(d = 2)

Segmentocomposto(d = 1)

Aresta (d = 1)

Faceta (d = 2)
Figura 2.19 – Entidades primárias e entidades duais compostas.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 34

2.5 Malhas de contorno
A especificação completa de um problema deve incluir informação acerca

da solução nas fronteiras do domínio de solução, mediante as condições de

contorno. A fim de incluir essas condições no problema discretizado, pode

ser necessária a existência de uma representação discreta dos contornos

nos quais elas são especificadas. A forma mais direta para tal representa-

ção é aquela integrada pelas facetas coincidentes com os contornos. Pode-

se considerar que essas facetas são elementos bidimensionais que formam

uma malha superficial para cada contorno do domínio de solução. Tais

elementos serão denominados aqui elementos de contorno e a malha que

formam malha de contorno. Para o tipo de discretização considerado neste

trabalho, os elementos de contorno são triângulos e/ou quadriláteros.
Uma vez que os elementos de contorno coincidem com as facetas

da malha volumétrica, para especificar uma malha de contorno pode ser

empregada uma forma compacta como a mostrada na figura 2.20. Nela,

especificam-se em uma lista os elementos volumétricos adjacentes e as

z
x y

1 33 22 71 13 19 1

Eleme
nto

 de con
torno Eleme
nto 

volum
étrico Faceta

Malha de contorno

Especificação da malha de contorno

Elementovolumétrico

Faceta

Figura 2.20 – Exemplo da especificação de uma malha de contorno.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 35

facetas nesses elementos que coincidem com o contorno. Para tanto pode-

se empregar a numeração global dos elementos, definida na especificação

da conectividade da malha volumétrica, junto com a numeração local das

facetas em cada elemento.

Com ajuda da conectividade dos elementos da malha volumétrica é

possível determinar de forma indireta toda a informação relativa a uma

malha de contorno associada. Assim, por exemplo, é possível estabelecer

quais são o os vértices localizados sobre o contorno e também todas as

relações de vizinhança entre entidades de contorno e volumétricas. Entre-

tanto, em algumas situações particulares, para implementar uma condição

de contorno pode-se precisar apenas uma lista dos vértices pertencentes

ao contorno. Nesse caso pode-se dispensar a especificação completa de

uma malha de contorno e especificar apenas tal lista.

Conforme visto na seção 2.4.2, a subdivisão de um elemento volu-

métrico em subelementos estabelece simultaneamente uma partição das

facetas do elemento. Isso implica também uma partição dos elementos de

contorno, já que coincidem com as facetas da malha volumétrica. Como

mostra a figura 2.21, essa partição é realizada por segmentos que unem o

baricentro dos vértices do elemento (C) com os pontos médios das suas

arestas (M).13 Produto da subdivisão, resultam três polígonos no triângulo

e quatro polígonos no quadrilátero. Esses polígonos são chamados aqui

C M

C M
Faces de contorno

(a)

(b)
Figura 2.21 – Subdivisão dos elementos de contorno.

13 Trata-se de uma subdivisão baricêntrica para elementos bidimensionais, equivalente à
descrita na seção 2.4.2 para elementos tridimensionais.



A SPECTO S G EO M ÉT R ICO S DA DI SCR ET I Z AÇ ÃO 36

faces de contorno e podem ser interpretados como as entidades duais dos

vértices em nível de elementos de contorno.

As faces de contorno fecham as superfícies de controle dos volumes

adjacentes aos contornos, como ilustra a figura 2.22. Conforme se observa

nessa figura, uma característica adicional desses volumes de controle é que

o vértice associado encontra-se situado sobre o contorno. Diferentemente,

nos volumes internos o vértice associado sempre é localizado no interior

dos volumes.

Malha de contorno

Malha volumétrica

Face de contorno

Figura 2.22 – Volume de controle adjacente a um contorno.



CAPÍTULO

3
Aspectos numéricos básicos

3.1 Características gerais de um método de volumes
finitos baseado em elementos

Um método de volumes finitos se caracteriza pela aplicação de equações

integrais de conservação a volumes de controle discretos. Em um método

de volumes finitos baseado em elementos, os volumes de controle são

as entidades duais dos vértices da malha primária de elementos. Como

visto no capítulo anterior, essas entidades preenchem completamente o

domínio de solução determinado pela malha primária, sem deixar espaços

vazios ou se superpor. Além de satisfazer esse requisito básico dos métodos

de volumes finitos [20], por construção, as interfaces entre volumes de
controle são polígonos localizados no interior dos elementos da malha

primária. Isto permite que os fluxos que atravessam essas interfaces se-

jam determinados mediante aproximações locais da variação da variáveis

em cada elemento. De fato, praticamente todas as operações necessárias

no processo de construção das equações discretas pode ser realizado em

nível de elemento. Depois, mediante um procedimento de montagem se-

melhante ao empregado ordinariamente no método de elementos finitos,

obtêm-se as equações de balanço referidas aos volumes de controle.

37



A SPECTO S N UM ÉR ICO S BÁ SICO S 38

Em um método de volumes finitos baseado em elementos, a represen-

tação discreta de uma variável em um dado nível de tempo é um conjunto

de valores, cada um dos quais encontra-se associado a um vértice da malha

primária. Seguindo a nomenclatura tradicional, os pontos onde valores

das variáveis são aproximados são denominados nós. No tipo de método

descrito neste trabalho, portanto, os nós estão localizados nos vértices da

malha de elementos. Devido à dualidade entre vértices e volumes de con-

trole, o número de nós e o número de volumes de controle em uma malha

conforme sempre será o mesmo. Uma vez que as equações discretas são

referidas aos volumes de controle e os valores discretos de uma variável são

referidos aos nós, o produto da discretização de uma equação diferencial

em uma variável é sempre um sistema fechado de equações algébricas.

Isto é, um sistema no qual o número de equações é igual ao número de

incógnitas. Modelos de várias equações diferenciais em várias variáveis

normalmente conduzem também a sistemas fechados de equações.

As características básicas de um método de volumes finitos baseado

em elementos, citadas acima, encontram-se ilustradas esquematicamente

na figura 3.1. Quanto à aproximação local das variáveis em função dos

valores nodais em um elemento, diversas alternativas podem ser conside-

radas. Em princípio, não existe impedimento para a utilização de diferen-

tes tipos de aproximações na discretização dos diferentes termos de uma

equação de conservação. Assim, por exemplo, nos temos de trasporte ad-

vectivo é possível utilizar aproximações do tipo upwind, que representam

de forma adequada esse tipo de transporte.

Em geral, a aproximação numérica do gradiente de uma variável, ne-

cessária na discretização dos termos de transporte difusivo, é uma das

operações mais laboriosas em um método numérico. A escolha mais óbvia

em um método de volumes finitos baseado em elementos é a diferencia-

ção de expressões analíticas que aproximem a variação das variáveis nos

elementos. Para tanto, utilizam-se as funções polinomiais empregadas

habitualmente no método de elementos finitos. Nesse caso, a noção de

elemento transcende o papel puramente geométrico, ao serem associadas

a cada tipo de elemento funções polinomiais compatíveis com sua forma,

as quais são utilizadas para a interpolação das variáveis. Essas funções são

comumente denominadas funções de forma. Apesar de existirem outras

alternativas para a aproximação numérica dos termos de transporte difu-

sivo, neste trabalho são utilizadas funções de forma. Nas restantes seções



A SPECTO S N UM ÉR ICO S BÁ SICO S 39

z
x y

Fluxos e outras grandezas determinados mediante aproximações locais em função dos valores nodais em um elemento

Valores discretos das variáveis associadosaos vértices da malha primária (nós)

Equações discretas associadas às entidades duais dos vértices da malha (volumes de controle)

Figura 3.1 – Características fundamentais dos métodos de volumes finitos
baseados em elementos.



A SPECTO S N UM ÉR ICO S BÁ SICO S 40

deste capítulo são apresentados os ingredientes básicos do método de vo-

lumes baseado em elementos, aplicado no presente trabalho à simulação

de reservatórios.

3.2 Convenções relativas à notação
Conforme visto no capítulo 2, na especificação da malha primária são es-

tabelecidos implicitamente esquemas de indexação global para vértices e

elementos. Dado que tais esquemas permitem identificar univocamente

essas entidades, as restantes entidades envolvidas no processo de discre-

tização são normalmente referidas a elementos ou vértices relacionados

com elas. Contudo, já que no método considerado nós e vértices coinci-

dem na mesma localização geométrica, em vez de se referir aos vértices,

a notação fará referência aos nós. Isto porque a noção de nó tem uma

conotação mais ampla que a de vértice, no contexto do método numérico.

Seja ? uma dada grandeza envolvida na descrição do problema consi-
derado. Para denotar o valor dessa grandeza associada ao nó p , escrever-

se-á ??p . Quando se fizer referência ao valor nodal em um nó ` localizado
no elemento e , escrever-se-á ??e

`
. Nesse contexto, ` pode ser interpretado

como o índice local que identifica o nó no elemento, isto é, `?
¦

1, 2, . . . , N e
n

©

,

onde N e
n

é o número de nós associados ao elemento em questão.

A notação para a associação com outras entidades segue uma conven-

ção similar. Assim, por exemplo, ?ef indica que a grandeza ? está associada
à face f , localizada no elemento e . Por outro lado, ?es indica que a gran-
deza está associada ao subelemento s do elemento e . Em geral, faces e

subelementos são indexados apenas localmente nos elementos. Portanto,

nas grandezas associadas a essas entidades o sobrescrito e frequentemente

será omitido, a fim de simplificar a notação. Note-se, por outro lado, que

apenas as grandezas associadas aos nós, por sua relevância nas equações

discretizadas, levam o sinal diacrítico (?).
Muitas das operações relativas à discretização das equações envolvem

diversos conjuntos de entidades. Por exemplo, todas as equações de con-

servação discretas estão referidas aos volumes de controle e às superfí-

cies que os limitam, os quais, como indicado no capítulo 2, são formados

por subelementos e faces, respectivamente. Logo, um volume de controle

pode ser definido como um conjunto de subelementos e sua superfície de

controle como a união de um conjunto de faces e um conjunto de faces



A SPECTO S N UM ÉR ICO S BÁ SICO S 41

de contorno. A fim de facilitar a escrita das equações discretizadas, neste

trabalho é utilizada uma notação especial para esses e outros conjuntos de

entidades. A definição desses conjuntos, assim como a notação empregada

para eles, encontra-se indicada com exemplos nas figuras 3.2 e 3.3, para

entidades da malha volumétrica, e na figura 3.4, para entidades das malhas

de contorno. Os esquemas que ilustram cada definição correspondem

a malhas bidimensionais, para permitir uma visualização mais clara das

entidades envolvidas.1

Nó p

Elemento e Elemento e

Subelemento do elemento adjacente ao nó p e

Conjunto dos nós associadosao elemento e Conjunto das faces no interiordo elemento e

Conjunto das faces no interior doelemento e, associadas ao nó p 
Nó p

Elemento e Elemento e

Figura 3.2 – Notação de entidades e conjuntos de entidades (parte 1).

1 As porções de malha mostradas nos esquemas podem ser interpretadas também como
cortes transversais de uma malha tridimensional.



A SPECTO S N UM ÉR ICO S BÁ SICO S 42

Nó p

Conjunto dos elementosque compartilham o nó p

Nó p

Nó pNó p

Volume de controleao redor do nó p

Esténcil associadoao nó p Conjunto das faces ao redor do nó p

Figura 3.3 – Notação de entidades e conjuntos de entidades (parte 2).

Na notação empregada, as entidades e conjuntos de entidades referi-

das às malhas de contorno se distinguem daquelas da malha volumétrica

pela anteposição do índice b . Assim, por exemplo, um elemento de con-

torno é denotado por be e uma face de contorno por bf . Outros exemplos

dessa notação são apresentados na figura 3.4. Note-se que nessa figura,

uma superfície de controle foi definida como a união do conjunto das faces

internas à malha associadas a um volume de controle, Fp , e do conjunto
das suas faces de contorno, bFp . Para um volume de controle interno, isto
é, não adjacente a um contorno, bFp é um conjunto vazio e, portanto, sua
superfície de controle é simplesmente Fp .



A SPECTO S N UM ÉR ICO S BÁ SICO S 43

Nó p Nó p

Conjunto dos elementos decontorno que compartilhamo nó p Conjunto das faces no elemento de contorno     , adjacentes ao nó p                   
Elemento decontorno

Conjunto de todas as faces de contorno adjacentes ao nó p
Superfície de controle associada ao volume

Nó p Nó p

Figura 3.4 – Notação de entidades e conjuntos de entidades associadas à
malhas de contorno.

Dado que a formulação apresentada está destinada maiormente a pro-

blemas em regime transiente, para a discretização considerar-se-á uma

partição finita do intervalo de tempo, t 0 &amp;lt;t 1 &amp;lt;t 2 &amp;lt;. . . &amp;lt;t m &amp;lt;. . . &amp;lt;t Nt .

Cada um desses níveis de tempo discretos pode ser interpretado como um

nó em uma malha unidimensional na linha do tempo. Nessa malha, ?t m
denota um intervalo de tempo particular, definido por ?t m ? t m ?t m?1.

Para denotar o valor de uma grandeza ?, dependente do tempo, no
nível t = t m , escrever-se-á b?cm . Sempre que for possível, o índice m será



A SPECTO S N UM ÉR ICO S BÁ SICO S 44

omitido a fim de simplificar a notação das expressões discretizadas. Nesse

caso, ficará implícito que qualquer grandeza dependente do tempo estará

associada ao nível de tempo t = t m . Apenas quando tal prática possa gerar
expressões ambíguas serão utilizados os índices apropriados relativos ao

tempo.

3.3 Transformação de coordenadas
A estratégia comumente adotada para se lidar com a distorção geométrica

dos elementos em uma malha não-estruturada é o denominado mapea-

mento [35, 84]. Trata-se de uma correspondência biunívoca entre os pon-
tos de um elemento no espaço físico e os pontos de um elemento regu-

lar com a mesma topologia, no denominado espaço transformado. Tal

mapeamento implica a existência de equações de transformação entre o

sistema de coordenadas global, no qual está definida a malha no espaço

físico, e um sistema de coordenadas local em cada elemento. A vantagem

desta transformação é que várias das operações necessárias para a discre-

tização das equações podem ser expressas de forma genérica, e geralmente

mais simples, no sistema local de coordenadas.

A maneira mais conveniente de expressar a transformação de coor-

denadas em um elemento é mediante funções de forma. As funções de

forma para elementos tridimensionais são funções contínuas e deriváveis

das coordenadas locais ?, ? e ?, que possuem algumas propriedades es-

peciais, citadas mais adiante. Com ajuda dessas funções, as equações de

transformação das coordenadas locais às coordenadas cartesianas globais,

para um ponto no interior ou no contorno de um elemento, podem ser

escritas como [84]
?

?

?

?

?

?

?

?

?

?

?

?

?

x =
?

`?N e
N`(?,?,?) x? e` ,

y =
?

`?N e
N`(?,?,?) y? e` ,

z =
?

`?N e
N`(?,?,?) z? e` .

(3.1)

Nestas equações, N`(?,?,?), para ` ? N e =
¦

1, 2, . . . , N e
n

©

, são funções

de forma adaptadas à topologia do elemento em questão, enquanto que

x? e
`

, y? e
`

e z? e
`

são as coordenadas globais dos nós associados a ele.



A SPECTO S N UM ÉR ICO S BÁ SICO S 45

O número de funções de forma diferentes que podem ser definidas

em um elemento é igual ao número de nós associados a ele. Para todos

os elementos considerados neste trabalho, as expressões matemáticas das

funções de forma utilizadas são apresentadas na subseção 3.3.2. Todas

essas funções satisfazem algumas propriedades básicas. Assim, por exem-

plo, elas variam sempre no intervalo [0, 1], no interior e sobre o contorno
de um elemento. No ponto coincidente com o nó de índice local a , a

função de forma Na adquire o valor 1, enquanto todas as restantes funções
se anulam. Além disso, os valores das funções de forma em um ponto

qualquer do elemento constituem uma partição da unidade [84], isto é,
satisfazem a relação

?

`?N e
N`(?,?,?) = 1 . (3.2)

3.3.1 Matriz jacobiana

Várias expressões matemáticas relativas a discretização, quando expressas

em coordenadas locais, incluem a denominada matriz jacobiana. Para

uma transformação como a dada pelas equações (3.1), essa matriz é de-

finida por [82]

J (?,?,?) ?

?

?

?

?

??x ??x ??x

??y ??y ??y

??z ??z ??z

?

?

?

?

, (3.3)

Nesta expressão, ??x , por exemplo, é uma notação reduzida para a

derivada parcial ?x/??. Todas as derivadas parciais incluídas na matriz

jacobiana podem ser obtidas explicitamente diferenciando as equações

(3.1). Assim, por exemplo, para a derivada parcial ??x , tem-se

??x =
?

`?N e
??N` · x? e` . (3.4)

Substituindo expressões equivalentes para todas as derivadas parciais

na definição da matriz jacobiana, obtém-se

J =

?

?

?

?

?

??N` · x? e`
?

??N` · x? e`
?

??N` · x? e`
?

??N` · y? e`
?

??N` · y? e`
?

??N` · y? e`
?

??N` · z? e`
?

??N` · z? e`
?

??N` · z? e`

?

?

?

?

. (3.5)



A SPECTO S N UM ÉR ICO S BÁ SICO S 46

Esta expressão pode ser reescrita de um modo mais conveniente para

o cômputo da matriz jacobiana, como

J =

?

?

?

?

x? e1 x?
e
2 . . . x?

e
Nn

y? e1 y?
e

2 . . . y?
e

Nn

z? e1 z?
e
2 . . . z?

e
Nn

?

?

?

?

?

?

?

?

?

?

?

??N1 ??N1 ??N1
??N2 ??N2 ??N2

...
...

...

??NN en ??NN en ??NN en

?

?

?

?

?

?

?

. (3.6)

Para uso nesta expressão, as derivadas parciais das funções de forma

em relação às coordenadas locais podem ser obtidas explicitamente me-

diante diferenciação das equações que as definem em cada tipo de ele-

mento. A matriz que contém essas derivadas participa também em outras

expressões, motivo pelo qual será definida formalmente como

D(?,?,?) ?

?

?

?

?

?

?

?

??N1 ??N1 ??N1
??N2 ??N2 ??N2

...
...

...

??NN en ??NN en ??NN en

?

?

?

?

?

?

?

. (3.7)

3.3.2 Funções de forma

A seguir são detalhadas as funções de forma consideradas neste trabalho.

Elas são compatíveis com as geometrias dos elementos e com a localização

definida para os nós. É fácil comprovar que satisfazem todas as restrições

indicadas anteriormente para as funções de forma.

As funções de forma para o tetraedro são funções lineares nas coorde-

nadas locais, definidas por

?

?

?

?

?

?

?

?

?

N1(?,?,?) = 1??????,

N2(?,?,?) = ?,

N3(?,?,?) = ?,

N4(?,?,?) = ?.

(3.8)

A figura 3.5 mostra o elemento tetraédrico no espaço transformado,

junto com as coordenadas locais dos seus vértices. Qualquer tetraedro em

uma malha, sem importar quão deformado se encontrar, se aplicará no



A SPECTO S N UM ÉR ICO S BÁ SICO S 47

tetraedro regular da figura 3.5, quando for considerarada a transformação

dada pelas equações (3.1), com as funções de forma dadas pelas equações

(3.8). No tetraedro transformado, as coordenadas locais variam nos inter-

valos 0¶?¶1????, 0¶?¶1???? e 0¶?¶1????.

2 3
1
4

Coordenadas locaisdos vértices
1 0 0 02 1 0 03 0 1 04 0 0 1

Vértice
Figura 3.5 – Tetraedro no espaço transformado.

As funções de forma para o elemento hexaédrico são as oito funções

trilineares
?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

N1(?,?,?) = (1??) (1??) (1??),

N2(?,?,?) = ? (1??) (1??),

N3(?,?,?) = ?? (1??),

N4(?,?,?) = (1??)? (1??),

N5(?,?,?) = (1??) (1??)?,

N6(?,?,?) = ? (1??)?,

N7(?,?,?) = ???,

N8(?,?,?) = (1??)??.

(3.9)

Com uma transformação de coordenadas empregando essas funções

de forma, um hexaedro qualquer é mapeado em um cubo de dimensões

unitárias, segundo mostra a figura 3.6. Nesse elemento hexaédrico trans-

formado, os intervalos de variação das coordenadas locais são 0 ¶?¶ 1,
0 ¶?¶ 1 e 0 ¶ ?¶ 1, respectivamente. Qualquer uma das funções de
forma do hexaedro se reduz a uma função linear sobre as três arestas que



A SPECTO S N UM ÉR ICO S BÁ SICO S 48

confluem no vértice cujo índice local coincide com o da função, anulando-

se nas restantes arestas. Além disso, nas facetas adjacentes ao vértice, a

função de forma se reduz a uma função bilinear, idêntica à considerada

em um elemento quadrilátero bidimensional.

Coordenadas locaisdos vértices
1 0 0 02 1 0 03 1 1 04 0 1 05 0 0 16 1 0 17 1 1 18 0 1 1

Vértice
2

6
4

8
1

5

7

3
Figura 3.6 – Hexaedro no espaço transformado.

As funções de forma consideradas para o prisma são as seguintes

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

N1(?,?,?) = (1????) (1??),

N2(?,?,?) = ? (1??),

N3(?,?,?) = ? (1??),

N4(?,?,?) = (1????)?,

N5(?,?,?) = ??,

N6(?,?,?) = ??.

(3.10)

O prisma no espaço transformado é mostrado na figura 3.7. Nele, os

intervalos de variação das coordenadas locais são 0¶?¶1??, 0¶?¶1??
e 0 ¶ ? ¶ 1. De modo semelhante ao caso do hexaedro, as funções de
forma do prisma se reduzem a funções lineares em três arestas e se anu-

lam nas restantes. Nas facetas triangulares, as funções tornam-se lineares,

enquanto que nas facetas quadrangulares se reduzem a funções biline-

ares em duas coordenadas. Isto garante a compatibilidade das funções

de forma do prisma com as do tetraedro e as do hexaedro. Ou seja, em



A SPECTO S N UM ÉR ICO S BÁ SICO S 49

uma faceta triangular comum a um tetraedro e a um prisma, a variação

das funções de forma é idêntica para ambos os elementos. Uma situação

equivalente acontece em uma faceta quadrangular compartilhada por um

hexaedro e um prisma.

Coordenadas locaisdos vértices
1 0 0 02 1 0 03 0 1 04 0 0 15 1 0 16 0 1 1

Vértice
2

5
3

6
1

4

Figura 3.7 – Prisma no espaço transformado.

Finalmente, as funções de forma consideradas para a pirâmide são

?

?

?

?

?

?

?

?

?

?

?

?

?

N1(?,?,?) = (1??) (1??) ? 14? + (??
1
2
) (?? 1

2
)?/(1??),

N2(?,?,?) = ? (1??) ? 14? ? (??
1
2
) (?? 1

2
)?/(1??),

N3(?,?,?) = ?? ? 14? + (??
1
2
) (?? 1

2
)?/(1??),

N4(?,?,?) = (1??)? ? 14? ? (??
1
2
) (?? 1

2
)?/(1??),

N5(?,?,?) = ?.

(3.11)

Estas funções de forma diferem das dos outros elementos na presença

de um termo racional em quatro delas. Conforme [83], esse termo é ne-
cessário para garantir a compatibilidade com as funções de tetraedros e

hexaedros e para evitar a singularidade da matriz jacobiana.2 De fato, é

possível comprovar que as funções da equação (3.11) se reduzem a funções

lineares sobre as facetas triangulares e a funções bilineares sobre a base

quadrangular, como requerido para a transição com os outros elementos.

2 As funções da equação (3.11), no entanto, diferem das apresentadas em [83] nos interva-
los de variação das coordenadas locais. Variou-se esses intervalos a fim de compatibilizá-los
com os considerados nas funções de forma dos outros elementos, sempre entre 0 e 1.



A SPECTO S N UM ÉR ICO S BÁ SICO S 50

O elemento piramidal no espaço transformado encontra-se representado

na figura 3.8. Os intervalos de variação admissíveis para as coordenadas

locais são ?
2
¶?¶1? ?

2
, ?

2
¶?¶1? ?

2
e 0¶?¶1.

Coordenadas locaisdos vértices
1 0 0 02 1 0 03 1 1 04 0 1 05 ½ ½ 1

Vértice

2
41

5

3
Figura 3.8 – Pirâmide no espaço transformado.

3.4 Integração numérica
Em geral, um método de volumes finitos é baseado na aproximação nu-

mérica da forma integral das equações de conservação. Portanto, uma

das operações mais importantes do método é a aproximação de integrais.

Ordinariamente, dois tipos de integrais precisam ser aproximadas em uma

equação de conservação: integrais de volume, cujo domínio são os volumes

de controle, e integrais de superfície, cujo domínio são as superfícies de

controle que limitam esses volumes.

3.4.1 Aproximação de integrais de volume

A forma mais simples de aproximação de uma integral de volume é o pro-

duto do valor médio do integrando no domínio de integração pelo volume

desse domínio. No contexto do método de volumes finitos, o valor médio

do integrando pode ser aproximado pelo seu valor nodal, correspondente

ao nó interior do volume de controle. Pode-se, portanto, escrever para essa

aproximação
?

Vp

? dV ? ??p ?Vp , (3.12)



A SPECTO S N UM ÉR ICO S BÁ SICO S 51

em que ??p é o valor nodal do integrando e ?Vp é o volume do volume de
controle, ambos associados ao nó p .

Quando o nó p estiver localizado no baricentro do volume de controle

Vp , como aconteceria em uma malha cartesiana regular, a aproximação
(3.12) terá precisão de segunda ordem [20]. Nos volumes de controle polié-
dricos construídos sobre uma malha não-estruturada irregular, entretanto,

raramente o nó interior estará localizado no baricentro do volume. Nesses

casos, a precisão da aproximação (3.12) se reduz a primeira ordem. Ape-

sar disso, em um método de volumes finitos é comum utilizar esse tipo

de aproximação, especialmente no termo transiente de uma equação de

conservação.

No contexto de um método de volumes finitos baseado em elemen-

tos, a aproximação de uma integral de volume pode ser feita também em

nível de subelementos. Uma vez que um volume de controle encontra-se

formado por certo número de subelementos, é possível escrever

?

Vp

? dV =
?

e?Ep

?

s ep

? dV . (3.13)

Cada uma das integrais definidas sobre os subelementos pode ser en-

tão aproximada, resultando a expressão

?

Vp

? dV ?
?

e?Ep

?e?sp ?V
e

sp
, (3.14)

onde ?e?sp é o valor do integrando, avaliado no baricentro do subelemento

s ep , enquanto que ?V
e

sp
é o volume de tal subelemento. No caso de não

existir uma expressão explícita para o integrando em função de coordena-

das espaciais, pode ser necessário o uso de esquemas de interpolação para

relacionar o valor de ?e?sp com valores nodais.

Como no espaço transformado os subelementos possuem uma forma

mais regular, seu volume pode ser determinado mais facilmente mediante

integração nesse espaço. O fator de escala entre o volume de um elemento

diferencial no espaço físico e o correspondente volume no espaço transfor-

mado é dado pelo determinante da matriz jacobiana |J| da transformação
[84]. Portanto, para determinar o volume de um subelemento, pode ser
utilizada a expressão integral



A SPECTO S N UM ÉR ICO S BÁ SICO S 52

?V esp =

?

s ep

|J| dV ??? , (3.15)

na qual, dV ??? é o elemento diferencial de volume no espaço transfor-

mado. Isso implica que a integração é realizada nesse espaço. Os detalhes

das técnicas de integração empregadas neste trabalho para o cálculo da

integral na equação (3.15) são apresentados no apêndice A.

Encontrando-se disponíveis os volumes dos subelementos, o volume

de um volume de controle completo, necessário na equação (3.12), pode

ser obtido mediante a soma

?Vp =
?

e?Ep

?V esp . (3.16)

3.4.2 Aproximação de integrais de superfície

As integrais de superfície em uma equação de conservação representam

os fluxos advectivos e/ou difusivos atravessando a superfície de controle.
O fluxo total através de uma superfície de controle pode ser expresso por

uma integral da forma
?

Sp
? · dS , onde ? é a densidade de fluxo e dS um

elemento diferencial de área, sendo ambas as grandezas vetoriais. O vetor

dS é normal à superfície de controle em qualquer ponto, com orientação
apontando para o exterior do volume de controle.

Uma vez que uma superfície de controle encontra-se formada, em

geral, por um conjunto de faces internas à malha e um conjunto de faces

de contorno, pode-se então escrever

?

Sp

? · dS =
?

Fp

? · dS +
?

bFp

? · dS . (3.17)

Considerando inicialmente a integral sobre Fp , ela será igual à soma
das integrais definidas sobre as faces individuais f que pertençam a Fp .
Ou seja,

?

Fp

? · dS =
?

f ?Fp

?

f

? · dS . (3.18)

Ainda, dado que essas faces encontram-se distribuídas nos elementos

que contribuem na formação do volume de controle, a última equação

pode ser reescrita de forma equivalente como



A SPECTO S N UM ÉR ICO S BÁ SICO S 53

?

Fp

? · dS =
?

e?Ep

?

f ?F ep

?

f

? · dS . (3.19)

Cada face f é um quadrilátero o um triângulo localizado no interior

de um elemento e . A integral em uma dessas faces pode ser aproximada

pela regra do ponto médio [20], isto é, pelo produto escalar do integrando,
avaliado no baricentro da face, e o vetor área da face em questão.3 Intro-

duzindo essa aproximação na equação (3.19), obtém-se, finalmente,

?

Fp

? · dS ?
?

e?Ep

?

f ?F ep

??f ·?S f , p . (3.20)

Nesta expressão, ??f é o valor da densidade de fluxo no baricentro da
face f , enquanto que ?S f , p é o vetor área da referida face, com orientação
positiva relativa ao volume de controle Vp .

O vetor área é o produto da área de uma face pelo vetor unitário na

sua direção normal.4 Quanto à orientação desse vetor, pode-se definir uma

orientação absoluta e uma orientação relativa aos volumes de controle que

a face separa.

Definição 3.1. A orientação absoluta do vetor área de uma face é idêntica
à orientação da aresta associada à face.

Na seção 2.3, quando foi descrita a topologia dos elementos, definiu-

se a orientação das arestas em função da ordenação em que são especi-

ficados os vértices.5 Convencionalmente, a definição 3.1 estabelece que

uma face e uma aresta, que são entidades duais em nível de elemento,

possuem a mesma orientação. Isso é mostrado esquematicamente na fi-

gura 3.9. Nessa figura é indicada também uma notação para os dois nós

nas extremidades de uma aresta, a qual esta relacionada com a orientação

da face.

3 Essa aproximação é equivalente ao emprego de uma quadratura de Gauss [35, 84] com
um único ponto de integração sobre a face.

4 O cômputo do vetor àrea é descrito no apêndice A, considerando inclusive o caso da face
ser um quadrilátero não plano.

5 Conforme se definiu na seção 2.3, a orientação positiva de uma aresta é aquela que vai
do primeiro ao segundo vértice especificado.



A SPECTO S N UM ÉR ICO S BÁ SICO S 54

Face f

Aresta
  (1° nó)

 (2° nó)
Figura 3.9 – Orientação absoluta do vetor área de face.

Entretanto, as expressões aproximadas para os fluxos nas faces, como

a da equação (3.20), devem ser escritas considerando a orientação das

faces relativa aos volumes de controle adjacentes.

Definição 3.2. O vetor área de uma face possui orientação positiva em
relação a um volume de controle adjacente se aponta para o exterior do

volume.

Neste trabalho, o vetor área associado à face f , quando considerado

com orientação absoluta, é denotado como ?Sf . No entanto, quando for
necessário especificar a orientação relativa a um volume de controle adja-

cente, o vetor será denotado como ?S f , p , sendo p o nó interior ao volume
referido. Conforme ilustra a figura 3.10(a), ?S f , p coincide com?Sf quando
p é o nó localizado no lado oposto ao apontado por?Sf . No caso contrário,
o mostrado na figura 3.10(b), tem-se que ?S f , p =??Sf .

Do ponto de vista da implementação computacional é mais vantajoso

expressar os fluxos nas faces considerando a orientação absoluta do vetor

área. Dessa forma, um fluxo é calculado uma única vez em uma dada face.

Quando tal fluxo deva ser adicionado nas equações de conservação dos

volumes de controle adjacentes, ele terá sinal positivo para um volume

e negativo para o outro.6 A diferença no sinal é originada pela diferente

orientação relativa do vetor área da face em relação aos dois volumes.

6 Isto é, o fluxo que abandona um volume de controle por uma dada face é o mesmo fluxo
que ingressa no volume vizinho, por essa face. Essa é uma das características fundamentais
de um método de volumes finitos, a consistência dos fluxos nas interfaces entre volumes de
controle [45, 59].



A SPECTO S N UM ÉR ICO S BÁ SICO S 55

,nB =Face f

Volume decontrole
,nF =

(a)

(b)
Figura 3.10 – Orientação do vetor área de face, relativa aos volumes de

controle.

Uma forma prática de expressar a aproximação de uma integral de

superfície em função de ?Sf é mediante a definição do parâmetro

?f , p =

¨

1 se p = nB(f ) ,

?1 se p = nF(f ) ,
(3.21)

onde nB(f ) e nF(f ) são os nós localizados atrás e a frente da face f , respec-

tivamente, segundo a notação indicada nas figuras 3.9 e 3.10. Com esse

parâmetro, tem-se que ?S f , p =?f , p ?Sf , com o qual a equação (3.20) pode
ser reescrita na forma final

?

Fp

? · dS ?
?

e?Ep

?

f ?F ep

?f , p ??f ·?Sf . (3.22)

Voltando novamente à aproximação das integrais em uma superfície

de controle, na equação (3.17) resta aproximar a integral definida sobre
bFp , para os volumes adjacentes a contornos. A aproximação dessa integral
pode ser escrita de forma análoga à aproximação da integral sobre Fp .
Tem-se então,



A SPECTO S N UM ÉR ICO S BÁ SICO S 56

?

bFp

? · dS ?
?

be?bEp

?

bf ?bF bep

?b?f ·?Sbf , (3.23)

onde ?b?f é o valor da densidade de fluxo no baricentro da face de contorno,
enquanto que ?Sbf é o vetor área correspondente a essa face. Os vetores
?Sbf são construídos de modo que sempre apontem para o exterior do
domínio. Em consequência, neste caso não há necessidade de distinguir

entre orientação absoluta e relativa aos volumes de controle, como no caso

das faces internas, porque ambas as orientações sempre coincidem.

3.5 Aproximação do gradiente de uma variável

O transporte difusivo de uma grandeza física é dependente do gradiente

dessa grandeza. Logo, toda vez que for necessário aproximar numerica-

mente o termo de transporte difusivo em uma equação de conservação,

será necessário aproximar gradientes ou componentes desses gradientes

em determinadas direções.

Na formulação de volumes finitos baseada em elementos apresentada

neste trabalho, considerar-se-á a abordagem tradicional, determinando os

gradientes mediante diferenciação de aproximações baseadas nas funções

de forma. Isto é, para efeito do cômputo do gradiente, a variação de uma

grandeza ? em um elemento será aproximada pela expressão

?(?,?,?) ?
?

`?N e
N`(?,?,?) ??e` , (3.24)

na qual, N`(?,?,?) são as mesmas funções de forma consideradas no ma-
peamento dos elementos 7 e ??e

`
são os valores nodais da grandeza.

A aplicação da aproximação (3.24) à definição do gradiente de uma

função dependente das coordenadas cartesianas,

?? ?

?

?

?

?

?x?
?y ?
?z?

?

?

?

?

, (3.25)

7 Esta é uma característica, na nomenclatura do método de elementos finitos, dos elemen-
tos isoparamétricos [35, 84].



A SPECTO S N UM ÉR ICO S BÁ SICO S 57

dá origem à expressão

?? ?
?

`?N e

?

?

?

?

?x N`
?y N`
?z N`

?

?

?

?

??e
`

. (3.26)

No entanto, uma vez que as funções de forma são definidas em relação

às coordenadas locais, as derivadas parciais na equação (3.26) não podem

ser obtidas diretamente. Para obtê-las, deve-se fazer uso da regra da cadeia

para derivação de funções compostas. Dessa forma, por exemplo, para a

derivada ??N` pode ser obtida a expressão

??N` = ??x · ?x N` + ??y · ?y N` + ??z · ?z N` . (3.27)

Relações equivalentes podem também ser obtidas para as derivadas

parciais ??N` e ??N` . As três expressões podem ser reunidas para formar
a equação matricial

?

?

?

?

??N`
??N`
??N`

?

?

?

?

=

?

?

?

?

??x ??y ??z

??x ??y ??z

??x ??y ??z

?

?

?

?

?

?

?

?

?x N`
?y N`
?z N`

?

?

?

?

. (3.28)

A matriz presente no lado direito desta última equação é a transposta

da matriz jacobiana, conforme se pode comprovar observando a definição

dessa matriz, na equação (3.3). Logo, a equação (3.28) pode ser reescrita

como
?

?

?

?

??N`
??N`
??N`

?

?

?

?

= JT

?

?

?

?

?x N`
?y N`
?z N`

?

?

?

?

, (3.29)

da qual se deduz
?

?

?

?

?x N`
?y N`
?z N`

?

?

?

?

= J?T

?

?

?

?

??N`
??N`
??N`

?

?

?

?

, (3.30)

em que J?T é uma notação reduzida para a inversa da transposta da matriz
jacobiana.

A equação (3.30) pode agora ser substituída na equação (3.25), obtendo-

se então a expressão



A SPECTO S N UM ÉR ICO S BÁ SICO S 58

?? = J?T
?

`?N e

?

?

?

?

??N`
??N`
??N`

?

?

?

?

??e
`

, (3.31)

a qual pode ser reescrita na forma matricial equivalente

?? = J?T

?

?

?

?

??N1 ??N2 ··· ??NN en
??N1 ??N2 ··· ??NN en
??N1 ??N2 ··· ??NN en

?

?

?

?

?

?

?

?

?

?

?

??e1
??e2

...

??eNn

?

?

?

?

?

?

?

. (3.32)

Na segunda matriz do lado direito desta equação é possível reconhe-

cer a transposta da matriz D, definida anteriormente na equação (3.7).
Definindo, ainda, o vetor de valores nodais da variável ? como

??
e
?

?

?

?

?

?

?

?

??e1
??e2

...

??eNn

?

?

?

?

?

?

?

, (3.33)

é possível escrever a expressão final, mais compacta, para a aproximação

do gradiente em um ponto qualquer de um elemento

??(?,?,?) = J?TDT??
e

. (3.34)

3.6 Esquemas de interpolação espacial
Na discretização de uma equação de conservação é necessário também

aproximar valores de uma variável em locais diferentes aos dos nós. Uma

vez que a forma fechada das equações discretizadas apenas pode conter

valores nodais das variáveis, torna-se necessário o emprego de esquemas

de interpolação, para relacionar valores em pontos específicos dos elemen-

tos, geralmente localizados sobre as faces, com os valores nodais.

O caso mais importante surge na aproximação do fluxo advectivo em

uma equação de conservação. O fluxo advectivo na superfície de um vo-

lume de controle é representado matematicamente por uma integral de

superfície como a considerada na seção 3.4.2. Nessa integral, a densidade

de fluxo é usualmente dada por ?=?v?, onde ? e v são a densidade do
fluido e a velocidade do escoamento que transporta a grandeza intensiva



A SPECTO S N UM ÉR ICO S BÁ SICO S 59

?, respectivamente. Quando a essa integral é aplicada a aproximação dada
pela equação (3.22), torna-se evidente a necessidade de aproximar valores

de variável nos baricentros das faces, isto é, valores de ??f .
Em um método de volumes baseado em elementos, um esquema de

interpolação é geralmente restrito aos valores nodais associados a um ele-

mento. Assim, a expressão mais geral para um esquema de interpolação

para o valor de uma variável no baricentro de uma face é

??f ?
?

`?N e
?ef,`??

e
`

, (3.35)

em que ?ef,` são coeficientes escalares que ponderam a influência de cada

valor nodal sobre o valor interpolado na face. O número de coeficientes

necessários para esta interpolação é igual ao número de nós associados

ao elemento e onde a face se encontra. Por exemplo, em um esquema

de interpolação equivalente à aproximação empregada para o cômputo

do gradiente, os valores dos coeficientes de interpolação seriam iguais aos

valores das funções de forma nos baricentros das faces, isto é,
?

?ef,`

?

forma
= N`(??f ,??f ,??f ) , (3.36)

em que ??f ,??f e ??f são as coordenadas locais do baricentro da face f .

Embora seja possível empregar este tipo de interpolação na aproxi-

mação do termo advectivo, sua utilização não é aconselhável. Essa prática

é equivalente ao uso de esquemas de diferenças centrais em formulações

convencionais de volumes finitos, portanto, usualmente dá origem a coefi-

cientes negativos na forma final das equações discretizadas [67]. Conforme
é relatado extensamente na literatura [42, 44, 45, 59, 60], problemas de
monotonicidade e de oscilações espúrias são comumente consequência

direta da presença desses coeficientes.

O esquema de interpolação mais empregado para os termos advec-

tivos, na simulação de reservatórios, é o esquema upwind de um ponto

[3] ou esquema donor cell [44]. Nesse esquema, o valor nodal localizado
a montante de uma interface, levando em conta o sentido do escoamento

que a atravessa, é atribuído integralmente como valor interpolado nessa

interface. Essa aproximação possui precisão de primeira ordem e preserva

a monotonicidade de soluções discretas inicialmente monotônicas [78].
Portanto, produz soluções fisicamente coerentes, embora apresentando

forte difusão numérica [45].



A SPECTO S N UM ÉR ICO S BÁ SICO S 60

No contexto de um método de volumes finitos baseado em elementos,

o esquema upwind de um ponto, denotado daqui em diante com a sigla

SPU,8 pode ser definido matematicamente pela expressão

?

??f
?

SPU
=

¨

??nB(f ) se (?v)?f ·?Sf &gt; 0 ,
??nF(f ) se (?v)?f ·?Sf &amp;lt;0 ,

(3.37)

na qual, igual que na equação (3.21), nB(f ) e nF(f ) é uma notação para os

nós localizados detrás e a frente da face f , de acordo com a orientação

absoluta da face. Além disso, (?v)?f ·?Sf é a vazão que atravessa a face,
da qual somente é considerado seu sinal. Os dois casos considerados na

equação (3.37) encontram-se ilustrados esquematicamente na figura 3.11.

Todos os coeficientes ?ef,` associados ao esquema SPU são nulos, exceto

aquele associado ao nó a montante, o qual adquire um valor unitário.

ArestaNó a montante

Nó a montante

(a)

(b)

Face f

Figura 3.11 – Os dois casos na interpolação upwind de um ponto (SPU).

8 Do inglês Single Point Upwind.



CAPÍTULO

4
Discretização de uma equação
de conservação

4.1 Equação de conservação genérica
A fim de mostrar de forma objetiva a aplicação das aproximações numéri-

cas apresentadas no capítulo anterior, neste capítulo será descrita, passo a

passo, a discretização de uma equação de conservação genérica. A equa-

ção de conservação de uma grandeza escalar é considerada aqui um pro-

tótipo das equações que formam parte dos diferentes modelos de escoa-

mento em reservatórios de petróleo. Após ser descrita a obtenção da forma

discretizada dessa equação, será abordado o procedimento de montagem

do sistema linear de equações resultante da discretização em todos os vo-

lumes de controle de uma malha. A descrição detalhada desses procedi-

mentos, aplicados a uma equação simples como a equação de conserva-

ção de uma grandeza escalar, servirá como fundamento para a posterior

aplicação a um modelo de escoamento multifásico em reservatórios de

petróleo.

61



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 62

A forma diferencial da equação de conservação de uma grandeza es-

calar ?, associada ao escoamento de um fluido e expressa por unidade de
massa, pode ser escrita de forma genérica como [20]

? (??)
?t

+? · (??v) = ? · (K??) +? . (4.1)

Nesta equação, ? é a densidade do fluido, v é a sua velocidade e K
o coeficiente de difusividade da grandeza ?, expressa como um tensor
de segunda ordem.1 A equação 4.1 representa um balanço da grandeza

? em um volume de controle infinitesimal. O primeiro termo do lado
esquerdo representa a variação temporal da grandeza genérica no volume.

O segundo termo representa o transporte advectivo através da superfície

do volume infinitesimal. O primeiro termo no lado direito representa o

transporte difusivo através da mesma superfície. Por fim, o termo ? é

o termo fonte da equação, o qual leva em conta qualquer mecanismo de

geração, conversão ou transporte da grandeza ? não considerado explici-
tamente nos outros termos da equação.

O ponto de partida para a aplicação de um método de volumes finitos

é geralmente a forma integral de uma equação de conservação. Para a

equação (4.1), a forma integral equivalente é [20]

?

?t

?

V

?? dV +

?

S

??v · dS =
?

S

K?? · dS +
?

V

?dV . (4.2)

Esta equação corresponde ao balanço em um volume de controle V ,
limitado por uma superfície fechada S , fixo em uma região do espaço pela
qual escoa um fluido [8]. Tal como ilustra a figura 4.1, dS é um vetor
diferencial de área sobre a superfície S , dirigido na direção normal a ela
e apontando para o exterior do volume.

Existe uma correspondência termo a termo entre as equações (4.1) e

(4.2). Entretanto, a forma diferencial é mais restritiva no sentido de não

admitir soluções apresentando descontinuidades, tais como ondas de cho-

que ou interfaces entre fluidos imiscíveis [8, 44]. Uma vez que a forma in-
tegral não possui restrições em relação a descontinuidades, ela é preferida

como base da maioria das formulações numéricas [8].

1 Em uma equação de conservação associada à descrição de um escoamento em um
reservatório, K representaria a permeabilidade do meio.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 63

Figura 4.1 – Volume de controle em um escoamento.

4.2 Discretização

A equação (4.2) pode ser aplicada diretamente a um volume de controle

poliédrico como os obtidos com os procedimentos descritos na seção 2.4.

Neste caso, conforme a notação apresentada na seção 3.2, considerar-se-

á um volume de controle Vp , limitado pela superfície Sp . Nas subseções
seguintes será descrita a discretização dos diferentes termos da equação

integral de conservação, aplicando as aproximações apresentadas ante-

riormente no capítulo 3.

4.2.1 Termo de transporte advectivo

Para a aproximação numérica dos termos de transporte, inicialmente será

considerado um volume de controle localizado no interior do domínio, ou

seja, um volume que não possui faces de contorno (bFp = ;). A contribui-
ção das faces de contorno será considerada posteriormente como parte

das condições de contorno do problema.

A aplicação da equação (3.22), com ? = ?v?, da origem à seguinte
aproximação para o termo advectivo na forma integral da equação de con-

servação
?

Sp

??v · dS ?
?

e?Ep

?

f ?F ep

?f , p (??v)?f ·?Sf . (4.3)



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 64

Ainda, após definir o fluxo de massa pela face como m? f ? (?v)?f ·?Sf ,
a aproximação pode ser escrita na forma mais compacta

?

Sp

??v · dS ?
?

e?Ep

?

f ?F ep

?f , p m? f ??f . (4.4)

A forma final da aproximação do termo advectivo é obtida substituindo

a expressão utilizada para interpolar os valores da variável nas faces, em

função de valores nodais. Aqui será empregada a expressão geral dada pela

equação (3.35), com a qual obtém-se

?

Sp

??v · dS ?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p m? f ?

e
f,`??

e
`

. (4.5)

4.2.2 Termo de transporte difusivo

Aplicando desta vez a equação (3.22) com ? = K??, obtém-se a seguinte
expressão aproximada para o termo difusivo da equação de conservação

?

Sp

K?? · dS ?
?

e?Ep

?

f ?F ep

?f , p (K??)?f ·?Sf . (4.6)

A fim de aproximar o fluxo difusivo em cada face da superfície de con-

trole, pode-se agora substituir a expressão aproximada para o gradiente,

dada na equação (3.34). Além disso, para facilitar a posterior manipula-

ção algébrica, o produto escalar que determina o fluxo pode ser escrito

utilizando a representação alternativa a · b = a Tb , obtendo-se a relação
aproximada

(K??)?f ·?Sf ?
?

K?f J
?T
?f

DT?f ??
e
?T
?Sf . (4.7)

Uma vez que a aproximação da integral de superfície na face requer

que o gradiente seja avaliado no baricentro da face, tanto a matriz jaco-

biana J como a matriz D são avaliadas nesse ponto. Além disso, K?f é o
coeficiente de difusividade no mesmo ponto.2

2 Na simulação de reservatórios, K representa a permeabilidade absoluta, uma propri-
edade do meio poroso no qual acontece o escoamento. Na representação discreta da
variação espacial dessa grandeza, é conveniente associar a cada elemento um valor único
de permeabilidade, a fim de evitar descontinuidades nas faces.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 65

Já que o produto escalar de dois vetores é comutativo, isto é, a Tb =
b Ta , a equação (4.7) pode ser rescrita como

(K??)?f ·?Sf ? ?S
T
f K?f J

?T
?f

DT?f ??
e

. (4.8)

Esta forma da aproximação do fluxo difusivo em uma face permite

definir o operador
?

?ef

?T
? ?STf K?f J

?T
?f

DT?f , (4.9)

com o qual o fluxo em uma face pode ser escrito como

(K??)?f ·?Sf ?
?

?ef

?T
??

e
=
?

`?N e
?ef,`??

e
`

, (4.10)

onde ?ef,` são as componentes do operador
?

?ef

?T
, o qual é um vetor de

dimensão igual ao número de nós do elemento ao qual a face em ques-

tão pertence. Introduzindo essa aproximação na equação (4.6), resulta a

expressão final para a aproximação do termo difusivo

?

Sp

K?? · dS ?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p ?

e
f,` ??

e
`

. (4.11)

4.2.3 Integração temporal

Para completar a discretização da equação integral (4.2), resta aproximar

os termos representados por integrais de volume. Após aplicar a aproxima-

ção dada na equação (3.12) para ambas as integrais e substituir, além disso,

as aproximações dos termos de transporte advectivo e difusivo, obtém-se

a equação

?

?t

?

Mp??p
?

+
?

e?Ep

?

f ?F ep

?

`?N e
?f , p m? f ?

e
f,`??

e
`
=

?

e?Ep

?

f ?F ep

?

`?N e
?f , p ?

e
f,` ??

e
`
+ ??p ?Vp ,

(4.12)

na qual tem-se introduzido o parâmetro Mp ? ?p ?Vp , o qual representa
a massa de fluido contida no volume de controle.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 66

A equação (4.12) deve ser ainda integrada no tempo para poder ser

obtida a versão final da equação em nível discreto. Após levar o termo de

fluxo advectivo para o lado direito da equação e integrar todos os termos

entre nos níveis discretos de tempo t m?1 e t m , chega-se a

Mp??p
?

?

t m
t m?1

=

? t m

t m?1

?

?

?

?

e?Ep

?

f ?F ep

?

`?N e
?f , p

?

?ef,`?m? f ?
e
f,`

?

??e
`
+ ??p ?Vp

?

?

?
dt .

(4.13)

A integral do lado direito deve agora ser aproximada numericamente

em função de valores nos níveis de tempo t m e/ou t m?1. Nesta operação
qualquer uma das abordagens empregadas ordinariamente em métodos

convencionais de volumes finitos pode ser considerada [8, 20, 45]. Como
exemplo, a seguir será considerada a abordagem totalmente implícita [45],
na qual a integral é aproximada avaliando o integrando no nível de tempo

t m e multiplicando-o pelo intervalo ?t m ? t m ?t m?1. Ou seja

bMp cmb??p cm ? bMp cm?1b??p cm?1 =
?

?

?

?

e?Ep

?

f ?F ep

?

`?N e
?f , p

?

?ef,`?bm? f ?
e
f,`c

m
?

b??e
`
cm + b??p cm?Vp

?

?

?
?tm .

(4.14)

Esta equação pode ser rearranjada convenientemente, levando todos

os termos associados a valores nodais da variável no nível de tempo t m ao

lado esquerdo e todos os restantes termos ao lado direito. Isto é

bMp cmb??p cm ? ?tm
?

e?Ep

?

f ?F ep

?

`?N e
?f , p

?

?ef,`?bm? f ?
e
f,`c

m
?

b??e
`
cm =

bMp cm?1b??p cm?1 + b??p cm?Vp ?tm .
(4.15)

Assumiu-se que o termo fonte da equação de conservação independe

da variável ?. Caso exista essa dependência mediante uma relação não-
linear, pode ser necessário realizar uma linearização do termo fonte, con-

forme explicado em [45, 59].
A equação (4.15) é a forma fechada da equação discretizada de conser-

vação, uma vez que apenas contém valores nodais da variável incógnita.

Os nós que participam desta equação são somente aqueles associados aos



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 67

elementos que contribuem na formação do volume de controle. Esses nós

formam o denominado estêncil ou molécula computacional [8, 20] N p da
equação, na qual apenas os coeficientes associados a incógnitas nesses nós

apresentarão valores não-nulos. A equação (4.15) pode ser escrita também

na forma mais usual em um método de volumes finitos,

A pb??p cm +
?

n?N p
n 6=p

A nb??n cm = b p , (4.16)

na qual, A p é o coeficiente central da equação, associado ao nó localizado

no interior do volume de controle, o qual reúne contribuições de todos

os elementos ao redor. Além disso, A n são os coeficientes associados aos

restantes nós no estêncil da equação, que envolvem contribuições dos ter-

mos de fluxo. Finalmente, b p é o termo independente que, para a equação

(4.16), inclui as duas parcelas do lado direito.

A figura 4.2 ilustra a estrutura da equação (4.16), mediante um exem-

plo em uma malha bidimensional simples. As equações em malhas tri-

dimensionais apresentam exatamente a mesma estrutura, porém, geral-

mente com estênceis envolvendo maior quantidade de nós. Quando reu-

nidas as equações de todos os volumes de controle em uma malha, obtém-

se um sistema de equações, o qual pode ser expresso de forma geral como

Ab??cm = b , (4.17)

onde A é a matriz de coeficientes, b é o vetor de termos independentes
e b??cm o vetor de valores nodais da variável para o nível de tempo t m .
Conforme mostra a figura 4.2, as componentes da matriz e dos vetores

no sistema de equações estão organizados segundo os índices globais que

identificam aos nós e volumes de controle na malha. Após incluir a repre-

sentação discreta das condições de contorno do problema sendo resolvido,

o sistema de equações permite determinar uma aproximação do campo

associado à variável ? no nível de tempo t m .
A solução transiente da equação (4.2) pode ser obtida resolvendo uma

sequência de sistemas de equações, cada sistema associado a um nível de

tempo discreto, mediante um procedimento de marcha [45]. Caso existam
não-linearidades e/ou acoplamento com outras equações, poderá ser ne-
cessário considerar um nível iterativo adicional em cada nível de tempo,

conforme explicado em [20, 45].



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 68

1
2

3
4 5

6
7

8
9 10

11
12

13 14

Sistema de equações discretizadas

Equação parao volume 7

=
1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14

Figura 4.2 – Estrutura da equação discretizada para um volume de controle
em uma malha simples.

4.3 Montagem do sistema de equações
A montagem dos sistemas de equações discretizadas pode ser sistemati-

zado a fim de tornar mais eficiente sua implementação computacional. A

seguir é descrito um dos procedimentos possíveis, com base na equação

(4.15). O procedimento envolve duas etapas, uma relativa às contribuições

dos termos de fluxo e outra relacionada aos restantes termos.

Quanto aos termos de fluxo, sua representação na equação (4.15) su-

gere um procedimento de montagem em que, para cada volume de con-

trole p , devem ser visitados os elementos e ? Ep , as faces f ? F ep e os nós
locais `? N e . Entretanto, isto implica que um mesmo elemento deva ser



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 69

visitado várias vezes, dado que contribuirá na formação de vários volumes

de controle, possivelmente repetindo-se vários cálculos de forma desne-

cessária. Para a implementação computacional da montagem do sistema

de equações é mais vantajoso um procedimento em que, cada vez que um

elemento é visitado, todas as contribuições associadas a ele sejam calcula-

das e adicionadas em posições adequadas da matriz de coeficientes.

A figura 4.3 ilustra, de modo esquemático, a contribuição de um ele-

mento quadrilátero nos coeficientes das equações discretizadas associa-

das aos quatro volumes de controle dos quais forma parte.3 De acordo à

numeração global considerada no exemplo, o elemento contribui às equa-

ções dos volumes ao redor dos nós 3, 6, 7 e 9, cujos coeficientes devem

estar localizados, respectivamente, nas linhas 3, 6, 7 e 9 da matriz de coe-

ficientes. Em cada uma dessas equações existirão coeficientes associados

aos valores nodais da variável no elemento em questão. Isto quer dizer que

haverá contribuições nos coeficientes localizados nas colunas 3, 6, 7 e 9,

uma vez que os coeficientes nessas colunas multiplicam, respectivamente,

os valores nodais ??e3 , ??
e
6 , ??

e
7

e ??e9 .

É importante notar, no entanto, que as contribuições de um elemento

aos termos de fluxo provêm, em realidade, de contribuições das faces no

interior do elemento. Conforme a figura 4.4 mostra esquematicamente,

uma face contribui nas equações dos dois volumes adjacentes. Essa situa-

ção acontece tanto em elementos bidimensionais quanto tridimensionais,

pois uma face sempre separa dois volumes. Um algoritmo que percorra as

faces de um elemento para fazer a montagem dos coeficientes da matriz A
pode aproveitar essa característica e atribuir diretamente o sinal correto às

contribuições. Esse sinal, que na equação (4.15) está dado pelo parâmetro

?f , p , será sempre positivo para um dos volumes adjacentes a uma face e

negativo para o outro. Um algoritmo dessa natureza é esboçado a seguir:

1: para todos os elementos e ? M
2: para todas as faces f ? F e

3: para todos os nós `? N e

4: c ? (?ef,`?bm? f ?
e
f,`c

m)?tm
5: A nB(f ), g(`)? A nB(f ), g(`) + c
6: A nF(f ), g(`)? A nF(f ), g(`) ? c

3 A situação é completamente equivalente para um elemento tridimensional, apenas com
maior número de volumes de controle e nós envolvidos.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 70

Sistema de equações discretizadas

=
1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14

1
2

3
4 5

6

7

8
9 10

11
12

13 14

Figura 4.3 – Contribuições de um elemento no sistema de equações discre-
tizadas.

Neste algoritmo, assume-se que os valores dos fluxos de massa e dos

operadores ?ef,` e ?
e
f,` encontram-se disponíveis e com eles é calculada a

contribuição c de uma face. Essa contribuição é adicionada no coeficiente

A nB(f ), g(`) , correspondente ao nó localizado atrás da face, e subtraída do

coeficiente A nF(f ), g(`) , correspondente ao nó localizado à frente da face.

No contexto do algoritmo anterior, nB(f ) e nF(f ) são funções que forne-

cem os índices globais dos nós (ou volumes de controle) atrás e à frente

da face f , considerando sua orientação absoluta, conforme discutido na

seção 3.4.2. Esses índices indicam a linha da matriz onde as contribuições

devem ser acrescidas ou subtraídas. Já a localização da coluna na matriz é

dada pelo índice global do nó considerado no ciclo sobre os nós locais do

elemento. Na notação empregada, esse índice é dado pela função g(`), que



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 71

Sistema de equações discretizadas

Face

=
1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14

1
2

3
4 5

6
8

9 (      ) 10
11

12
13 147 (      )

Figura 4.4 – Contribuições de uma face na matriz de coeficientes.

deve extrair essa informação da definição da conectividade dos elementos

da malha.

Para concluir a montagem do sistema de equações discretizadas, resta

ainda acrescentar as contribuições do termo fonte e do termo temporal.

Para tanto é necessário realizar um ciclo percorrendo todos os nós da ma-

lha, uma vez que essas contribuições dependem apenas de grandezas re-

lativas aos nós ou aos volumes de controle associados, como mostra a

equação (4.15). O ciclo pode ser implementado como esboçado a seguir:

1: para todos os nós p ? M
2: A g(p), g(p)? A g(p), g(p) + bMp cm

3: b g(p)?b g(p) + bMp cm?1b??p cm?1 + b??p cm?Vp ?tm



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 72

4.4 Inclusão de condições de contorno

A fim de completar a especificação da formulação numérica para um pro-

blema físico, a condição inicial e as condições de contorno devem ser in-

cluídas no sistema de equações discretizadas. A condição inicial para um

problema transiente descrito por uma equação como a (4.1) consiste na

distribuição espacial da variável em t 0, a qual é utilizada no primeiro in-

tervalo de tempo para aproximar a derivada temporal em cada volume de

controle. Na imposição das condições de contorno, a seguir serão descritos

sucintamente os procedimentos adotados em duas situações possíveis.

4.4.1 Condição de fluxo prescrito

A situação em que o valor do fluxo que atravessa uma fronteira é conhe-

cido, ou pode ser determinado em função de valores conhecidos, é a mais

simples do ponto de vista operacional. A equação semidiscretizada corres-

pondente a um volume de controle adjacente a uma fronteira desse tipo

adquire a forma

?

?t

?

Mp??p
?

+
?

e?Ep

?

f ?F ep

?

`?N e
?f , p m? f ?

e
f,`??

e
`
+
?

be?bEp

?

bf ?bF bep

?bf =

?

e?Ep

?

f ?F ep

?

`?N e
?f , p ?

e
f,` ??

e
`
+ ??p ?Vp ,

(4.18)

que é a mesma equação correspondente a um volume interno,4 exceto

pela inclusão do termo correspondente ao fluxo na porção da superfície de

controle coincidente com a fronteira. Nesse termo, ?bf é o fluxo total, isto
é, o fluxo envolvendo advecção e difusão, através de uma face de contorno
bf . Em concordância com a convenção anteriormente estabelecida, ?bf
é positivo quando abandona o volume de controle. A inclusão de fluxos

dessa natureza no sistema de equações discretizadas, pode ser realizado

com o seguinte procedimento simples:

1: para todos os elementos de contorno be ? B fluxo

2: para todas as faces de contorno bf ? be
3: b nC(bf )?b nC(bf ) ??bf

4 Compare-se, por exemplo, com a equação (4.12).



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 73

No procedimento esboçado, percorrem-se todos os elementos de con-

torno sobre a fronteira em questão (B fluxo), visitando-se em cada um deles
todas faces de contorno incluídas. Como se considera que o fluxo pres-

crito ?bf independe das incógnitas, ele é acrescido no termo independente
da equação correspondente, com sinal negativo.5 O índice do volume de

controle associado à face de contorno é dado pela função nC(bf ), que deve

extrair essa informação a partir da conectividade da malha de contorno.

Em certas situações, o termo de fluxo através da fronteira na equação

(4.18) pode ser modelado como sendo proporcional à diferença entre o

valor nodal da variável e um valor de referência conhecido. Ou seja,6

?

be?bEp

?

bf ?bF bep

?bf = C? p (??p ??ref ) , (4.19)

em que C? p seria a condutância da porção de fronteira associada ao volume.

Esse tipo de condição pode ser facilmente implementada por um procedi-

mento da forma seguinte:

1: para todos os nós p ? B conv

2: A g(p), g(p)? A g(p), g(p) + C? p
3: b g(p)?b g(p) + C? p ?ref

Desta vez apenas é necessário percorrer os nós sobre a fronteira em

questão (B conv), uma vez que todos os parâmetros necessários são referen-
tes aos nós ou aos volumes de controle associados.

4.4.2 Condição de Dirichlet

Existem descritas na literatura diversas técnicas para impor condições de

Dirichlet em formulações numéricas com nós localizados nos vértices da

malha. Uma particularidade deste tipo de malha é a existência de nós

sobre as fronteiras do domínio, como ilustra a figura 2.22. Uma vez que em

uma condição de Dirichlet valores da variável da equação são conhecidos

em uma fronteira, os valores nodais em nós localizados sobre essa fonteira

deixam de ser incógnitas do problema discreto.

5 O sinal negativo provém da transposição do termo de fluxo na fronteira ao lado direito
da equação.

6 O fluxo proveniente de poços, em reservatórios de petróleo, é normalmente modelado
por uma expressão desse tipo.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 74

Uma das formas usuais para incluir uma condição de Dirichlet no

sistema de equações é o denominado método da penalidade [84], o qual
visa evitar a alteraração da estrutura do sistema de equações resultante da

montagem previamente descrita. Operacionalmente, esse método equi-

vale a impor uma condição de fluxo da forma dada na equação (4.19) com

um valor da condutância várias ordens de grandeza maior que os restantes

coeficientes da equação e um valor de referência igual ao valor prescrito.

Como efeito dessa operação, o valor nodal depois de resolvido o sistema de

equações se aproxima do valor estipulado na condição de Dirichlet. Outra

técnica comum é a substituição das equações discretizadas dos volumes

adjacentes às fronteiras com condição de Dirichlet por equações da forma

??p = ?Dirichlet , em que o valor nodal correspondente é diretamente igua-
lado ao valor prescrito na condição. Para tanto é necessário alterar todos

os coeficientes e o termo independente das equações associadas a esses

volumes.

Uma técnica alternativa, utilizada nas implementações computacio-

nais realizadas neste trabalho,7 é a eliminação das equações discretizadas

correspondentes aos volumes adjacentes a uma fronteira com condição de

Dirichlet. O procedimento está ilustrado mediante um exemplo na figura

4.5. Nele, os coeficientes das linhas e colunas cujos índices coincidem com

os índices dos nós com condição de Dirichlet são eliminados da matriz. De

forma similar, no vetor de incógnitas e no vetor de termos independentes

são retiradas as componentes com os mesmos índices. Dessa forma, as

equações completas dos volumes associados a esses nós estão sendo eli-

minadas do sistema de equações. Os coeficientes eliminados nas colunas

da matriz, que no sistema original multiplicavam os valores nodais nos

nós com condição de Dirichlet, devem ser multiplicados pelos respectivos

valores prescritos e subtraídos dos termos independentes, a fim de não

alterar as equações discretizadas remanentes. Como resultado desse pro-

cesso, obtém-se um sistema de equações reduzido, cujas incógnitas são

apenas valores nodais de nós internos e de nós localizados em fronteiras

com outro tipo de condição, como mostra a figura 4.5.

7 A escolha dessa técnica está relacionada com a utilização do método multigrid de
correções aditivas [39], considerada neste trabalho para resolver os sistemas de equações re-
sultantes da discretização. Observou-se que as alterações na matriz de coeficientes realizadas
com as outras técnicas deterioram o desempenho desse método.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 75

1
2

3
4 5

6
7

8
9 10

11
12

13 14

Redução do sistema de equações após a montagem
Nós com condiçãode Dirichlet

Valores prescritos

Valores provenientesdas colunas eliminadas

Sistema de equações reduzido

1234567891011121314 1 2 3 4 5 6 7 8 9 10 11 12 13 14

=

=
Figura 4.5 – Redução do sistema de equações pela imposição de uma con-

dição de Dirichlet.



DISC R ET IZ AÇÃO DE UM A EQUAÇ ÃO DE CO NSERVAÇÃO 76

Uma das principais vantagens dessa prática é que o sistema de equa-

ções a ser resolvido é menor que o original. Entretanto, dado que geral-

mente deve ser utilizado algum esquema de armazenamento compacto

para matrizes esparsas [71], alterações na estrutura da matriz de coeficien-
tes podem ser muito complexas e demandar um tempo de computação

adicional considerável. A fim de evitar essas dificuldades, na implementa-

ção realizada neste trabalho efetua-se já de início a montagem da matriz de

coeficientes reduzida, introduzindo algumas modificações no algoritmo

de montagem esboçado na seção 4.3.

É importante notar que embora sejam eliminadas do sistema de equa-

ções, as equações de conservação dos volumes adjacentes a fronteiras com

condição de Dirichlet continuam sendo válidas. Essas equações podem ser

empregadas para determinar os fluxos totais que atravessam essas frontei-

ras, após ser resolvido o sistema de equações e estarem disponíveis todos

os valores nodais da variável incógnita. Nessa situação, o termo
?

be

?

bf ?bf
torna-se a incógnita da equação (4.18) associada a todos os volumes con-

tíguos a fronteiras com condição de Dirichlet. Consequentemente, essa

equação pode ser utilizada para determinar o valor dessa incógnita a pos-

teriori. Dessa forma, a conservação da grandeza ? é sastisfeita mesmo
nos volumes de controle cujas equações foram eliminadas do sistema de

equações.



CAPÍTULO

5
Aplicação a um modelo de
escoamento em reservatórios

5.1 Modelo de escoamento bifásico

Para aplicação da formulação numérica desenvolvida à simulação tridi-

mensional de reservatórios de petróleo, optou-se por um modelo de es-

coamento bifásico imiscível. Este modelo permite desacoplar de forma

simples as equações discretizadas, facilitando desse modo a sua solução

por meio de um método segregado. Quanto ao tratamento dos aspec-

tos geométricos da discretização, que é o foco da formulação apresen-

tada neste trabalho, modelos de escoamento mais sofisticados requere-

rão, em geral, uma abordagem idêntica à mostrada aqui para o modelo

bifásico. Entretanto, aspectos intrínsecos à modelagem física introduzem

acoplamentos e não-linearidades adicionais, os quais tornam a descrição

da discretização mais complexa, porem, sem agregar aspectos novos, pelo

menos do ponto de vista geométrico. É importante notar, contudo, que o

método de discretização apresentado é totalmente apto para ser aplicado

a modelos de escoamento mais complexos.

77



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 78

Uma das equações fundamentais em qualquer modelo macroscópico

de escoamento em reservatórios é a expressão matemática da lei de Darcy.

A forma comumente adotada para escoamento multifásico é [3]

v? = ??? K (?P ??? g ) , ?= w ,o . (5.1)

Nesta expressão, v?, ?? e ?? são, respectivamente, a velocidade média
ou velocidade de Darcy, a mobilidade e a densidade, associadas à fase

genérica ?. No modelo considerado, as duas fases são identificadas como

água (w) e óleo (o). Ainda na equação (5.1), ?P é o gradiente da pressão e
g é a aceleração devida à gravidade. Considera-se uma pressão única pois
assume-se que a influência da pressão capilar na escala considerada nas

simulações é pouco significativa. Por fim, K é o tensor permeabilidade. A
metodologia adotada neste trabalho é apta para lidar de forma consistente

com tensores simétricos completos, isto é,

K =

?

?

?

?

K x x K x y K x z
K x y K y y K y z
K x z K y z K z z

?

?

?

?

, (5.2)

em que todas as componentes podem ser não-nulas.

Do ponto de vista da discretização, é vantajoso expressar a aceleração

da gravidade como o gradiente de um potencial escalar G , dado por

G ? g x x + g y y + g z z , (5.3)

em que g x , g y e g z são as componentes cartesianas do vetor g , enquanto
que, como é habitual, x , y e z são as coordenadas cartesianas de um dado

ponto. A partir da definição em (5.3) é trivial mostrar que g =?G , com o
qual, a equação (5.1) transforma-se em

v? = ??? K (?P ? ???G ) , ?= w ,o. (5.4)

A mobilidade que figura nas equações (5.1) e (5.4) é definida por

?? ?
k r?
µ?

, ?= w ,o . (5.5)

onde k r? e µ? são, respectivamente, a permeabilidade relativa e a viscosi-

dade da fase. A permeabilidade relativa é usualmente dada na forma de



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 79

uma curva, que descreve sua dependência em relação à saturação de uma

das fases. Note-se que a definição da mobilidade na equação (5.5) difere

da usual [3, 60] por não incluir a permeabilidade absoluta, a qual, ao ser
considerada aqui um tensor completo, é escrita de forma independiente

da mobilidade.

A outra equação essencial em um modelo de escoamento multifásico

é a equação de balanço de massa. Assume-se aqui que cada fase é in-

compressível e está formada por um único componente, logo a equação

de conservação pode ser escrita, para cada fase, na forma [60]

? (?s ?)
?t

+ ? · v? = 0 , ?= w ,o . (5.6)

Nesta equação, s ? é a saturação da fase, isto é, a fração do volume

poroso ocupada pela referida fase. Além do mais, ? é a porosidade do

meio, ou seja, a fração do um volume representativo do meio poroso não

ocupada pela matriz sólida.1

O modelo é completado pela denominada equação de restrição volu-

métrica
s w + so = 1 , (5.7)

a qual é consequência da hipótese que as duas fases consideradas ocupam

todo o espaço poroso disponível.

As equações diferenciais do modelo de escoamento bifásico, escri-

tas acima, podem ser combinadas algebricamente para dar origem a um

conjunto de equações equivalente. Para o caso considerado, em que as

fases possuem densidade constante, essas equações alternativas adquirem

uma forma simples que facilita, em alguma medida, o processo de discre-

tização. Assim, por exemplo, a combinação das equações (5.6) e (5.7) dá

origem à equação de balanço global

? · vT = 0 , (5.8)

na qual, vT é a denominada velocidade total [60], a qual é definida como a
soma das velocidades das duas fases consideradas, isto é,

vT ? vw + vo . (5.9)

1 Posteriormente, o escoamento entre o reservatório e os poços nele contidos será intro-
duzido como condições de contorno para a equação (5.6).



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 80

Uma expressão relacionando a velocidade total com o gradiente de

pressão pode ser obtida somando-se as duas instâncias da equação (5.4),

correspondentes às duas fases consideradas no modelo. Dessa forma chega-

se à relação

vT = ??T K (?P ? ?M?G ) , (5.10)

Nesta expressão foram introduzidas duas novas propriedades. A pri-

meira é denominada mobilidade total, definida por

?T ? ?w + ?o . (5.11)

A outra propriedade é a densidade média ponderada pela mobilidade,

definida pela expressão

?M ?
?w ?w + ?o ?o
?w + ?o

. (5.12)

A substituição da equação (5.10) no balanço global, dado na equação

(5.8), origina a equação diferencial da pressão,

?? · (?T K?P ) +? · (?M ?T K?G ) = 0 . (5.13)

A fim de completar a forma alternativa do modelo de escoamento bi-

fásico é usual considerar a equação de conservação da fase água, expressa

em função da velocidade total anteriormente definida. Essa forma especí-

fica, conhecida como forma de Buckley-Leverett da equação da saturação

[60], pode ser obtida combinando as equações (5.4) e (5.6), expressas para
a fase água, com a equação (5.10). Seguindo esse procedimento, chega-se

à equação

? (?s)
?t

+ ? · (Fw vT ) + ? · (?wo ??wo K?G ) = 0 . (5.14)

Por conveniência, nesta equação a saturação da fase água denotou-se

simplesmente como s . Por outro lado, Fw é a denominada função fluxo

fracionário [60] para a fase água, definida pela razão de mobilidades

Fw ?
?w

?T
. (5.15)

De forma similar, ?wo é uma função também dependente das mobili-
dades das fases, dada por



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 81

?wo ? ?o Fw =
?o ?w

?T
. (5.16)

No modelo bifásico considerado, as mobilidades são funções apenas

da saturação de uma das fases, via as permeabilidades relativas. Conse-

quentemente, Fw e ?wo são também funções apenas da saturação, uma
vez que são dadas por combinações das mobilidades.

Por fim, na equação (5.14), ??wo simboliza a diferença entre as densi-
dades das duas fases, isto é,

??wo = ?w ??o . (5.17)

Para fins do processo de discretização posterior, é conveniente ex-

pressar as equações de conservação apresentadas na sua forma integral

equivalente. Para a equação da pressão, tem-se

?
?

S

?T K?P · dS +
?

S

?T K?G · dS = 0 , (5.18)

onde, a fim de simplificar a expressão, foi introduzido o coeficiente ?T ,

dado por
?T ? ?M ?T = ?w ?w + ?o ?o . (5.19)

Finalmente, a forma integral da equação da saturação considerada é

?

?t

?

V

?s dV +

?

S

Fw vT · dS +
?

S

?wo ??wo K?G · dS = 0 . (5.20)

5.2 Discretização do modelo
Nesta seção é descrita a discretização das equações do modelo matemático

para escoamento bifásico, aplicando os conceitos e procedimentos apre-

sentados nos capítulos precedentes. Considera-se que o domínio de so-

lução é um reservatório tridimensional, discretizado por uma malha não-

estruturada formada, no caso mais geral, pelos quatro tipos de elementos

descritos no capítulo 2.

As duas variáveis fundamentais do modelo bifásico considerado são a

pressão e a saturação. Embora ambas as variáveis estejam presentes nas

duas equações de conservação, na forma apresentada na seção anterior,



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 82

cada equação possui uma variável dominante. Graças a essa característica,

na discretização dessas equações, é possível desacoplá-las mediante uma

escolha apropriada do nível de tempo em que cada equação é aproximada.

Dessa forma, torna-se possível a utilização de um esquema de solução se-

gregado para a obtenção da evolução temporal das variáveis no problema

em questão, que é o objetivo da simulação.

5.2.1 Equação da pressão

A aproximação numérica das integrais na equação da pressão, na forma

dada pela equação (5.18), dá origem à expressão discreta

?
?

f ?Fp

?f , p
?

?T K?P
?

?f
·?Sf +

?

f ?Fp

?f , p
?

?T K?G
?

?f
·?Sf = 0 . (5.21)

A forma fechada da equação é obtida após introduzir a aproximação

dos fluxos difusivos em função dos valores nodais das variáveis, dada de

forma genérica pela equação (4.10). Fica evidente agora a conveniência de

representar a aceleração da gravidade como o gradiente do potencial G ,

pois ambos os termos da equação (5.21) podem ser aproximados empre-

gando os mesmos operadores.

A fim de facilitar a escrita das equações, e também simplificar sua

implementação, é conveniente definir os fluxos parciais

?f ? (K?G)?f ·?Sf ?
?

`?N e
?ef,`G?

e
`

, (5.22)

que independem do tempo e, portanto, podem ser calculados uma única

vez no início do processo. Após introduzir essa definição na equação (5.21),

além de aproximações locais dos fluxos dependentes do gradiente de pres-

são, chega-se a

?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p (?T)?f ?

e
f,` P?

e
`
+
?

e?Ep

?

f ?F ep

?f , p (?T)?f ?f = 0 . (5.23)

Embora a equação da pressão não possua um termo temporal como

a equação da saturação, certamente os coeficientes (?T)?f e (?T)?f variam
com o tempo, pois eles dependem da saturação. Consequentemente, para



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 83

completar a aproximação numérica, a equação (5.22) deve ser associada a

um nível discreto de tempo, como feito a seguir

?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p

j

(?T)?f
km
?ef,`bP?

e
`
cm +

?

e?Ep

?

f ?F ep

?f , p
j

(?T)?f
km
?f = 0 .

(5.24)

Supondo que no nível de tempo t m estiver disponível uma aproxima-

ção do campo de saturação, valores de (?T)?f e (?T)?f poderão ser calcula-
dos nesse nível de tempo e, portanto, as únicas incógnitas restantes na

equação (5.24) serão os valores nodais da pressão. Essa é, precisamente,

a abordagem considerada em um algoritmo de solução sequencial para a

obtenção da evolução temporal do escoamento. Nessa situação, o proce-

dimento de montagem do sistema de equações apresentado na seção 4.3

pode ser empregado sem qualquer alteração, dando lugar ao sistema

AbP? cm = b , (5.25)

cuja solução deve fornecer uma aproximação discreta do campo de pres-

são no nível de tempo t m .

5.2.2 Equação da saturação

Na equação integral da saturação podem ser empregadas aproximações

numéricas semelhantes às consideradas na discretização da equação da

pressão. Entretanto, como essa equação possui uma derivada temporal, é

necessário considerar também uma integração no tempo, como mostrado

na expressão a seguir, obtida a partir da equação (5.20)

?p ?Vp s?p
?

?

t m+1
t m
+

? t m+1

t m

?

?

?

?

f ?Fp

?f , p
?

Fw vT
?

?f
·?Sf

?

?

?
dt

+

? t m+1

t m

?

?

?

?

f ?Fp

?f , p
?

?wo ??wo K?G
?

?f ·?Sf

?

?

?
dt = 0 .

(5.26)

Diferentemente do exemplo considerado na seção 4.2.3, desta vez os

fluxos serão aproximados no nível de tempo inicial do intervalo, t m . Isto



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 84

caracteriza uma aproximação explícita [20, 45], cuja estabilidade é con-
dicional, conforme se verá mais adiante. Procedendo da forma indicada,

obtém-se

?p ?Vpbs?p cm+1 ? ?p ?Vpbs?p cm + ?tm+1
?

f ?Fp

?f , p
j

?

Fw vT
?

?f

km
·?Sf

+ ?tm+1
?

f ?Fp

?f , p
j

?

?wo ??wo K?G
?

?f

km
·?Sf = 0 .

(5.27)

Neste ponto é conveniente definir a vazão volumétrica total em uma

face, originada na velocidade total vT . Isto é,

qf ? (vT)?f ·?Sf . (5.28)

Os valores das vazões totais no nível de tempo t m podem ser determi-

nados, após resolver o sistema de equações da pressão, mediante a expres-

são

bqf c
m = ?

j

(?T)?f
km ?

`?N e
?ef,`bP?

e
`
cm +

j

(?T)?f
km
?f . (5.29)

Esta última expressão é obtida substituindo a equação (5.10) na defi-

nição dada em (5.28) e depois aplicando as mesmas aproximações numé-

ricas consideradas na discretização da equação da pressão.2

Introduzindo na equação (5.27) as vazões definidas nas equações (5.22)

e (5.28), obtém-se

?p ?Vpbs?p cm+1 ? ?p ?Vpbs?p cm + ?tm+1
?

f ?Fp

?f , p
j

qf (Fw)?f
km

+ ?tm+1
?

f ?Fp

?f , p
j

(?wo)?f
km
??wo ?f = 0 .

(5.30)

A rigor, a única incógnita nesta última equação é o valor nodal bs?p cm+1,
pois, dado que foi considerada uma aproximação explícita, os valores de

todos os restantes termos devem encontrar-se disponíveis ou podem ser

determinados mediante esquemas de interpolação espacial apropriados.

Logo, a equação (5.30) pode ser empregada como equação evolutiva para

2 A forma discretizada da equação da pressão pode ser escrita alternativamente como
?

f ?Fp ?f , p qf = 0, a qual é uma aproximação discreta da equação (5.8), que é precisamente a
equação que deu origem à equação diferencial da pressão.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 85

a saturação, pois permite determinar os valores nodais dessa variável em

um novo instante de tempo sem ser necessário resolver um sistema simul-

tâneo de equações. Para tanto, pode ser conveniente rearranjar a equação

na forma

bs?p cm+1 = bs?p cm ?

?tm+1
?p ?Vp

¨

?

e?Ep

?

f ?F ep

?f , p

?

j

qf (Fw)?f
km
+
j

(?wo)?f
km
??wo ?f

?

«

(5.31)

5.2.3 Esquemas de interpolação espacial

Para que a discretização das equações do modelo de escoamento esteja

completa, devem ser especificados ainda esquemas de interpolação a ser

empregados para determinar valores de grandezas nas faces dos volumes

de controle.

Na equação (5.24) são necessários valores de ?T e ?T , ambas as pro-

priedades dependentes da saturação. Em geral, a escolha do esquema de

interpolação para essas propriedades não tem consequências negativas

sobre a estabilidade do método, dada a natureza elíptica da equação da

pressão [66, 80]. Conforme sugerido em [80], um esquema de segunda or-
dem é uma escolha adequada nesse caso, pois reduz em alguma medida o

efeito de orientação de malha [37]. No contexto de um método de volumes
finitos baseado em elementos isso é conseguido realizando a interpolação

via funções de forma, ou seja,

(?T)?f ?
?

`?N e
N ,??f (??T)

e
`

, (5.32)

(?T)?f ?
?

`?N e
N ,??f (??T)

e
`

, (5.33)

onde N`,?f é uma notação reduzida para N`(??f ,??f ,??f ), isto é, os valores das
funções de forma avaliadas nos baricentros das faces.

A interpolação das propriedades para a equação da saturação requer

um maior cuidado. Uma vez que se trata de uma equação hiperbólica

[60], se os coeficientes oriundos da discretização não satisfizerem crité-
rios de positividade, valores não físicos e/ou oscilações poderão surgir nas
soluções numéricas obtidas [69]. O esquema mais simples que atende
esses critérios é o esquema upwind de um ponto (SPU) [41], cuja forma



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 86

adaptada às malhas não-estruturadas foi descrita na seção 3.6. Para a

função fluxo fracionário, a forma correspondente a esse esquema é

(Fw)?f =

(

(F?w)nB(f ) se qf &gt; 0 ,
(F?w)nF(f ) se qf &amp;lt;0 ,

(5.34)

na qual o valor nodal a montante é determinado analisando o sinal da

vazão total na face, qf . Dado que Fw é uma função não-linear da variável

da equação, a rigor, na equação (5.34) deveria ser analisado o sinal do

produto da derivada dFw /ds pela vazão qf .
3 Contudo, como essa derivada

é positiva em todo o intervalo de variação da saturação, ela não altera o

critério considerado para selecionar o valor nodal a montante.

A função?wo , entretanto, é uma função não-monotônica, como ilustra
a figura 5.1 para um caso típico. A derivada d?wo/ds apresenta, portanto,
uma mudança de sinal no intervalo de variação da saturação. Isto indica

que é imprescindível a consideração do sinal dessa derivada na determi-

nação do nó a montante para a interpolação de ?wo . Para tanto, uma
aproximação numérica do valor da derivada na face é suficiente, como

mostrado nas expressões seguintes

(?wo)?f =

(

(??wo)nB(f ) se ?f ?f &gt; 0 ,
(??wo)nF(f ) se ?f ?f &amp;lt;0 ,

(5.35)

onde

?f ? sgn ??wo · sgn
?

(??wo)nB(f )? (??wo)nF(f )
s? nB(f )? s? nF(f )

?

, (5.36)

em que a função sinal está definida por

sgn x ?

?

?

?

1 se x &gt; 0 ,

0 se x = 0 ,
?1 se x &amp;lt;0 .

(5.37)

3 Segundo a teoria das equações hiperbólicas não-lineares [44], a solução da equação
da saturação, em ausência do termo da gravidade, pode ser considerada como uma su-
perposição de ondas se deslocando com velocidade (dFw /ds)vT . Na situação oposta, se o
termo ? · (Fw vT ) fosse nulo na equação (5.14), a velocidade de propagação seria dada por
(d?wo/ds)??wo K?G . A fim de garantir a positividade dos coeficientes, essas duas situações
extremas são consideradas na interpolação upwind nos respectivos termos da equação da
saturação.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 87

Por questão de generalidade, o sinal de ??wo foi também incluído
porque, dependendo dos valores das densidades das fases, essa diferença

pode ser positiva ou negativa.

0 0.2 0.4 0.6 0.8 10
0.2
0.4
0.6
0.8

1

Saturação normalizada 0 0.2 0.4 0.6 0.8 10
1
2
3
4

Saturação normalizada

0 0.2 0.4 0.6 0.8 10
2
4
6
8 x 10-3

Saturação normalizada 0 0.2 0.4 0.6 0.8 1
-0.04
-0.02

0
0.02

Saturação normalizada

Função Derivada

Função Derivada

Figura 5.1 – Variação típica das funções dependentes da saturação e suas
derivadas.

5.3 Algoritmo de solução

A abordagem considerada na seção 5.2 para a aproximação temporal é

normalmente empregada a fim de desacoplar parcialmente as equações

discretizadas e poder utilizar o algoritmo IMPES 4 [3, 49]. Neste algoritmo
são resolvidas de forma sucessiva as equações da pressão e da saturação

para avançar no tempo essas duas variáveis de modo segregado. Trata-se

de um dos algoritmos mais simples para o tipo de modelo considerado,

contudo, sua estabilidade é condicionada ao uso de passos de tempo que

satisfaçam o denominado critério CFL [11].

4 Implicit pressure–explicit saturation.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 88

O critério de estabilidade para o algoritmo IMPES é geralmente muito

restritivo, e na prática isso provoca que os tempos de computação cresçam

de forma exagerada, especialmente quando se consideram malhas com

algum tipo de refino. Uma das alternativas para remediar esse problema

seria considerar uma aproximação implícita dos fluxos, o qual daria lugar a

um sistema de equações não-lineares em que pressão e saturação estariam

fortemente acopladas. Nessa situação o passo de tempo estaria condi-

cionado apenas pelas não-linearidades e pela precisão, no entanto, seria

necessária a utilização de métodos de solução de sistemas de equações

não-lineares, como o método de Newton-Raphson, por exemplo.

A fim de reduzir os tempos de computação utilizando o algoritmo

IMPES, neste trabalho foi considerada uma variante em que uma estra-

tégia de passos de tempo diferenciados é empregada a fim de acelerar a

execução dos processos de solução transiente. A variante considerada foi

estudada previamente [9, 36], concluindo-se que reduções significativas
no tempo de computação podem ser obtidas com essa estratégia, sem

introduzir um erro numérico adicional importante. Os passos principais

do algoritmo são descritos a seguir.

De forma prévia ao início de processo de avanço no tempo, os valores

dos parâmetros que independem do tempo são computados. Entre esses

parâmetros encontram-se, por exemplo, os operadores ?ef , definidos na
equação (4.9), e os fluxos relativos à gravidade, ?f , definidos na equação

(5.22). Para iniciar o processo iterativo, os valores nodais da saturação são

inicializados com valores correspondentes à condição inicial prescrita para

o problema.

Na figura 5.2 estão representadas de forma esquemática as operações

fundamentais do algoritmo, em um dado nível de tempo durante o pro-

cesso de avanço no tempo. No nível de tempo m , valores nodais do campo

de saturação devem estar disponíveis, provenientes do nível de tempo an-

terior ou da condição inicial do problema. Com esses valores de saturação,

valores nodais de ?T e ?T são computados em todos os nós da malha, a

partir das propriedades especificadas para os fluidos e das curvas de per-

meabilidade relativa. Em seguida, utilizando o esquema de interpolação

escolhido, são determinados valores de ?T e ?T nas faces dos volumes de

controle, necessários para construir as equações discretizadas da pressão.

Após realizada a montagem do sistema de equações da pressão e incluídas



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 89

as condições de contorno e as condições de operação dos poços,5 uma

aproximação discreta do campo é obtida no nível de tempo m , resolvendo

para tanto o referido sistema de equações. Esse é o passo 1 representado

esquematicamente na figura 5.2.

t

t

Montagem e solução do sistema de equações da pressão

Cômputo das vazões nas faces
1
2

t3

Passo de tempo para a pressão
Passo de tempopara a saturação

Avanço explícitoda saturação(n vezes)

Figura 5.2 – Variante do algoritmo IMPES, com escalas de tempo diferentes
para pressão e saturação.

Os valores nodais da pressão obtidos, junto com os valores de ?T e ?T
interpolados nas faces, permitem determinar as vazões totais qf para todas

5 A representação dos poços nas equações discretizadas é descrita na seção seguinte.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 90

as faces internas da malha, utilizando para tanto a equação (5.29). Esse é o

passo 2 na figura 5.2.

Após calcular as vazões nas faces, os valores nodais da saturação no

próximo nível de tempo podem ser calculados mediante a equação (5.31).

Na forma convencional do algoritmo IMPES, seguidamente se retornaria

ao passo 1, para determinar um novo campo de pressão. Entretanto, na

variante apresentada aqui, repete-se o avanço temporal da saturação certo

número de vezes, com os mesmos valores das vazões qf , antes de atualizar

o campo de pressão novamente. Essa prática, ilustrada no passo 3 da

figura 5.2, implica que a evolução temporal da pressão e da saturação é

determinada com escalas de tempo diferentes. O passo de tempo para a

saturação é sempre menor, porque deve satisfazer a restrição imposta pelo

critério CFL, a fim de garantir a estabilidade. Por outro lado, o intervalo

de atualização do campo de pressão é incrementado o mais possível com

o intuito de reduzir o tempo de computação, pois a montagem e a solução

do sistema de equações da pressão são as operações mais custosas de todo

o processo.

Para completar a descrição do algoritmo de solução, resta especificar

um esquema automático para gerenciar o passo de tempo para a atualiza-

ção da pressão e, consequentemente, das vazões nas faces. Um esquema

adequado deve estipular passos de tempo em que a variação das vazões

seja uniforme ao longo da simulação. Isto é, estipular passos de tempo

maiores quando as vazões variarem pouco em todo o domínio e passos

progressivamente menores quando as vazões começarem a variar forte-

mente em alguma região. A razão para associar o tamanho do passo de

tempo à variação das vazões nas faces é óbvia pois, no algoritmo descrito,

os valores dessas vazões são mantidos constantes em cada um desses in-

tervalos de tempo.

Na implementação realizada, o passo de tempo para a pressão é de-

terminado pela expressão

?t m+nP =?t
m

P

?bQ adm
b?bQ maxcm

, (5.38)

em que ?t m+nP é o novo passo de tempo, equivalente a n passos de tempo
da saturação, determinado com base no passo anterior, ?t mP . Além disso,
b?bQ maxcm é um parâmetro normalizado, indicador da máxima variação
das vazões em toda a malha durante o intervalo de tempo ?t mP . Por fim,



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 91

?bQ adm é o valor estipulado para essa variação, isto é, o valor alvo que o
esquema deve manter aproximadamente uniforme durante a simulação.

O parâmetro associado à variação máxima das vazões no intervalo

?t mP é computado com base nos volumes de controle, mediante a relação

b?Q maxcm ? max
p?M

?

?

?

?

?

f ?Fp

?

?

?bqf c
m ?bqf c

m?l
?

?

?

?p ?Vp

?

?

?

?

, (5.39)

na qual, como indicado, é necessário percorrer todos os volumes de con-

trole da malha M a fim de determinar o valor máximo da expressão entre
parênteses. Nessa expressão, bqf c

m?l é o valor de uma vazão no nível de

tempo imediatamente anterior a t m , na escala de tempo da pressão. É im-

portante notar que na equação (5.38), b?bQ maxcm é um valor normalizado
do parâmetro definido na equação (5.39). O fator de normalização é o valor

do próprio parâmetro no primeiro intervalo de tempo do processo de so-

lução, assumindo-se que em t = 0 todas as vazões são nulas. Experimentos
numéricos indicam que valores de ?bQ adm na ordem de 10?2 conduzem a
soluções transientes sem apreciável erro que possa ser atribuído à variante

no algoritmo e com significativamente menor tempo de computação que

usando o algoritmo IMPES convencional.

5.4 Representação discreta dos poços
Dado que, em geral, o maior interesse em uma simulação numérica está

focalizado no escoamento na vizinhança dos poços, é de fundamental im-

portância considerar uma representação acurada da trajetória dos poços.

Diferentemente de outras características geométricas do reservatório, das

quais geralmente só existem descrições aproximadas, as trajetórias dos

poços são conhecidas com suficiente precisão e podem incluídas de forma

detalhada em um modelo numérico. É precisamente na representação dis-

creta dos poços que mais se pode aproveitar a flexibilidade geométrica das

malhas não-estruturadas, especialmente quando os poços são direcionais

ou multilaterais.

A figura 5.3 ilustra, de modo esquemático, a abordagem considerada

neste trabalho para a representação dos poços no modelo numérico. Nela,

o poço está constituído por uma sequência de elementos unidimensionais,

os quais devem coincidir com arestas da malha volumétrica que representa



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 92

z
x y

Nível de referênciapara o poço,

Poço

Nó Porção de malhaem torno do poço

Elemento depoço
Figura 5.3 – Representação discreta de um poço.

o reservatório. Dessa forma garante-se que nós da malha, onde serão de-

terminados valores das variáveis relevantes do problema, estejam localiza-

dos sobre a trajetória do poço. Note-se, entretanto, que na representação

discreta não é considerado o raio real do poço, pois o poço é reduzido a

uma linha. A informação do raio é considerada no chamado modelo de

poço, introduzido para aproximar a relação entre a vazão que atravessa a

superfície de uma porção do poço e os valores nodais de pressão de poço e

reservatório.6 A malha volumétrica na vizinhança do poço pode ser gerada

6 O modelo de poço empregado é descrito na seção 5.5.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 93

com geometria cilíndrica, a qual pode capturar com mais fidelidade a es-

trutura predominantemente radial do escoamento nessa região [21]. Essa
abordagem é uma extensão tridimensional das malhas polares em torno

dos poços, utilizadas em alguns modelos areais de reservatórios [27, 65].
Duas condições de operação dos poços são as mais comuns em pro-

blemas de reservatórios, em relação às grandezas estipuladas como dados

de entrada [3]. Em uma delas é conhecida a pressão em alguma seção de
referência no interior do poço, enquanto que na outra é estipulada a vazão

total que escoa do reservatório para o poço ou vice-versa. A inclusão das

condições de operação dos poços na formulação requer, em geral, algum

tipo de modelagem do escoamento no interior do poço, a fim de determi-

nar a variação da pressão na interface entre poço e reservatório. A modo de

exemplo, a seguir é descrito o procedimento considerando que a pressão

no interior do poço tem variação hidrostática. Logicamente, poderiam ser

considerados modelos de escoamento mais completos, como os apresen-

tados em [56], incluindo variações de pressão causadas por atrito, entrada
de massa, interação entre fases etc.

Seja ? a pressão média em uma seção do poço e ? a direção vertical,
em que atua a gravidade. A variação dessa pressão, considerando apenas a

influência da gravidade, é dada por

?
d?
d?
+ ??g = 0 , (5.40)

onde ?? é a densidade média da mistura de fluidos escoando pelo poço e g

a magnitude da aceleração devida à gravidade.

Integrando a equação (5.40) entre um nível de referência, aqui consi-

derado como o nível do primeiro nó do poço, e o nível de um nó qualquer

p na trajetória do poço, tem-se

?
?

?p ??ref
?

+

? ?p

?ref

??g d? = 0 . (5.41)

A integral nesta equação pode ser aproximada em cada elemento de

poço, pela regra do ponto médio [20], após o qual pode ser obtida a se-
guinte expressão para a pressão no interior do poço, no nível do nó p

?p ? ?ref +
?

we?wEp -ref

??we g ??we , (5.42)



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 94

em que wEp -ref é o conjunto de elementos de poço entre os níveis de re-
ferência e o do nó p . Além disso, ??we = ?p 2 ??p1 é o comprimento da
projeção do elemento de poço na direção vertical e ??we =

1
2

?

??p1 +??p 2
?

é a densidade média da mistura nesse elemento. Como mostrado na fi-

gura 5.3, p 1 e p 2 são os nós nas duas extremidades do elemento de poço

em questão, we . Por sua vez, a densidade da mistura em cada nó, pode

ser aproximada como uma média ponderada das densidades das fases,

levando em conta a quantidade de cada fase na porção do poço associada.

A figura 5.4 mostra um volume de controle da malha do reservatório

que contém um nó de poço. Conforme se observa, um desses volumes

envolve a metade de dois elementos de poço adjacentes.7 Como é lógico,

a vazão entre o volume de controle e essas porções de elementos de poço

deve ser levada em conta nas suas equações de balanço. Assim, por exem-

plo, na equação da pressão, que provém de um balanço global das duas

fases, ter-se-ria

?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p (?T)?f ?

e
f,` P?

e
`
+
?

e?Ep

?

f ?F ep

?f , p (?T)?f ?f + $p = 0 , (5.43)

em que o termo adicional $p é a vazão total entre poço e volume de con-

trole, positiva se abandona o volume e negativa no caso contrário.8 Se-

guindo a prática normal em simulação de reservatórios, essa vazão é rela-

cionada com a diferença entre a pressão nodal Pp e a pressão no interior

do poço ?p , por meio de uma expressão da forma

$p = (?T)p WIp
?

P?p ??p
?

. (5.44)

Nesta relação, WIp é o denominado índice de produtividade do poço

ou, simplesmente, índice de poço [10, 61], para a porção de poço em con-
tato com o volume considerado. A determinação de valores de WIp apro-

priados à discretização considerada neste trabalho é descrita na seção 5.5.

A fim de se obter uma expressão final para a equação da pressão para

volumes em contato com poços, a equação (5.42) pode ser substituída em

(5.44) e o resultado substituído ainda em (5.43), chegando-se então a

7 No entanto, se o nó em questão estiver localizado em uma extremidade do poço, o
volume de controle estará em contato apenas com a metade de um elemento de poço.

8 A equação (5.43) provém da equação (5.24). Os índices correspondentes ao nível de
tempo foram omitidos a fim de simplificar a notação.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 95

Volume decontrole

Poço

Nó

Vazão do volumeao poço:
Figura 5.4 – Volume de controle associado a um nó sobre o poço.

?
?

e?Ep

?

f ?F ep

?

`?N e
?f , p (?T)?f ?

e
f,` P?

e
`
+
?

e?Ep

?

f ?F ep

?f , p (?T)?f ?f +

(?T)p WIp
?

P?p ??ref ???p -ref
?

= 0 ,

(5.45)

em que ??p -ref é uma notação compacta para o somatório da equação
(5.42), ou seja

??p -ref ?
?

we?wEp -ref

??we g ??we . (5.46)

A equação (5.45) é válida para todos os volumes de controle associados

a nós a longo da trajetória de um poço produtor ou injetor. No caso em

que o valor da pressão de referência ?ref for estipulado como condição
de operação do poço, nenhuma incógnita adicional será acrescentada na



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 96

equação da pressão pela inclusão do termo associado à vazão para o poço.

Isto porque valores de ??p -ref podem ser avaliados diretamente com a
equação (5.46).9

Quando o valor estipulado for a vazão total que ingressa ou abandona

o poço, ?ref é uma incógnita adicional nas equações da pressão de todos
os volumes de controle em contato com o poço. Logo, precisa-se de uma

equação adicional para que o sistema de equações da pressão possa ser

resolvido. Essa equação provém do balanço global para o poço completo,

o qual pode ser escrito como

$W ?
?

p?W

$p = 0 , (5.47)

onde $W é o valor estipulado para a vazão total que ingressa ou abandona

o poço, segundo se trate de um poço injetor ou produtor. O sinal de $W é

positivo no primeiro caso e negativo no segundo. Substituindo a expressão

para as vazões individuais em cada volume de controle, dada na equação

(5.44), obtém-se

$W ?
?

p?W

(?T)p WIp
?

P?p ??ref ???p -ref
?

= 0 . (5.48)

Esta equação possui como incógnitas todos os valores nodais da pres-

são ao longo do poço, além do valor da pressão do poço no nível de referên-

cia. Uma equação desse tipo deve ser acrescentada no sistema de equações

da pressão, para cada poço em que um valor da vazão total seja estipulado.

Por outro lado, a equação da saturação correspondente aos volumes

em contato com um poço deve incluir também um termo adicional. Uma

vez que essa equação representa um balanço da fase água, o termo adi-

cional é dado por (Fw)p$p , que é fração da vazão entre volume de con-
trole e poço que corresponde à fase água. Independentemente de qual

for a condição de operação estipulada para o poço, a vazão $p pode ser

computada com a equação (5.44), após resolver o sistema de equações da

pressão. Dado que no nível de tempo t m , ao qual correspondem todos os

termos analisados, encontram-se disponíveis valores nodais da saturação,

o valor de (Fw)p pode ser facilmente computado também.

9 Entretanto, modelos mais detalhados do escoamento no interior do poço podem intro-
duzir não-linearidades e acoplamentos adicionais que requeiram um tratamento especial no
processo de solução.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 97

5.5 Modelo de poço
Uma das principais características do escoamento na vizinhança de um

poço é a forte variação da pressão e, consequentemente, da velocidade

nessa região. Mesmo representando de maneira precisa a trajetória do

poço na malha, como descrito na seção anterior, para captar de forma

adequada os fortes gradientes de pressão seria necessário também refinar

extremamente a malha adjacente ao poço na direção radial. Uma vez que

o diâmetro típico de um poço e várias ordens de grandeza menor que as

dimensões normais de um reservatório, um refino dessa natureza é geral-

mente impraticável, pois aumentaria excessivamente o número de incóg-

nitas do modelo numérico. A dificuldade torna-se mais crítica porque a

vazão entre o reservatório e um poço deveria ser normalmente computada

com os gradientes de pressão na sua vizinhança. Logo, se com a malha uti-

lizada não fosse possível captar adequadamente esses gradientes, um erro

de magnitude inaceitável seria introduzido na solução numérica, devido à

importância trascendental da vazão desde ou para os poços.

Para contornar ese tipo de dificuldades, desde os primórdios da si-

mulação de reservatórios são empregados os denominados modelos de

poço [10, 61]. O intuito desses modelos é desvincular o cômputo da vazão
da aproximação numérica do gradiente de pressão adjacente aos poços.

Isto geralmente é conseguido introduzindo hipóteses adicionais quanto à

natureza do escoamento na vizinhança imediata aos poços.

Para um escoamento monofásico, o modelo de poço é normalmente

dado pela expressão

$ =
WI

µ

?

Pp ??
?

, (5.49)

onde, como ilustrado na figura 5.5 para um caso bidimensional, $ é a va-

zão entre o reservatório e o poço, Pp é a pressão nodal associada ao volume

onde o poço se encontra e ? é a pressão na superfície do poço. A equação
(5.49) pode ser considerada a definição do índice de poço WI, o qual é um

parâmetro que depende apenas da permeabilidade e das geometrias do

poço e da malha na região adjacente ao poço. De fato, a questão chave de

um modelo de poço é a determinação do valor de WI adequado para uma

dada configuração geométrica do poço em relação à malha circundante.

A extensão da equação (5.49) para escoamentos multifásicos é direta,

sendo necessário apenas introduzir a permeabilidade relativa, do mesmo



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 98

VazãoNó com pressão
Poço de raio W Pressão

x
y

Figura 5.5 – Grandezas envolvidas em um modelo de poço convencional.

modo que é realizado para aplicar a lei de Darcy a várias fases. Essa forma

do modelo de poço pode ser escrita de modo compacto como

$? = ??WI
?

Pp ??
?

, (5.50)

em que $? e ?? são, respectivamente, a vazão e a mobilidade 10 da fase

genérica ?. Admite-se que o valor do índice de poço WI na equação (5.50)

é o mesmo que o da equação (5.49) para escoamento monofásico. Por

tal razão, os valores dos índices de poço são determinados usualmente

considerando escoamentos monofásicos, mesmo que sua aplicação final

seja em problemas multifásicos [10].
A primeira derivação de uma expressão analítica para calcular o índice

de poço foi feita por Peaceman [61], para modelos numéricos baseados em
malhas cartesianas regulares. Diversas extensões e generalizações foram

realizadas posteriormente na correlação de Peaceman [14, 62–64], as quais
são amplamente utilizadas em simuladores comerciais. Infelizmente, es-

quemas analíticos desse tipo não podem ser aplicados diretamente a uma

formulação em malhas não-estruturadas, devido ao forte enraizamento

desses esquemas na configuração geométrica simples das malhas estru-

turadas.

10 Conforme mostra a equação (5.5), a permeabilidade relativa está envolvida na definição
da mobilidade.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 99

Neste trabalho é considerada uma abordagem diferente à convencio-

nal, baseada na metodologia proposta por Aavastmark e Klausen em [1].11

Essa metodologia é suficientemente geral como para ser aplicada com ma-

lhas tanto estruturadas como não-estruturadas e em duas ou três dimen-

sões. O delineamento geral do método pode ser mais facilmente descrito

considerando inicialmente uma situação bidimensional, e depois ser es-

tendido a casos tridimensionais, como feito a seguir.

Considere-se o problema esboçado na figura 5.6(a), em que um poço

produtor de raio rW encontra-se localizado na origem de um domínio bi-

dimensional infinito. No regime estacionário, um escoamento monofásico

incompressível dirigido na direção do poço pode ser descrito pelas equa-

ções

? · v = 0 , (5.51)

v = ?
K

µ
?P , (5.52)

sujeitas às seguintes restrições na interface entre poço e reservatório

P |r=rW = ?, (5.53)
?

r=rW

v · dS = $. (5.54)

Neste modelo simples, o meio é considerado homogêneo, porém, com

possibilidade de ser anisotrópico. A solução do problema descrito acima

pode ser determinada analiticamente e é dada por uma função contínua

P(x , y ), para qualquer ponto exterior ao poço.12 Nessa solução analítica,
a pressão varia de forma logarítmica e as isolinhas são elipses com semi-

eixos nas direções principais do tensor permeabilidade. À medida que se

afastam do poço, porém, as isolinhas tendem a tornar-se circulares.

Na metodologia considerada, para determinar um índice de poço asso-

ciado a uma dada malha, o problema monofásico descrito deve ser resol-

vido numericamente. Para tanto, deve ser considerada uma porção da ma-

lha que inclua o poço e um número adequado de elementos. No problema

11 Apesar de não ser citada em [1], uma metodologia semelhante tinha sido esboçada
previamente por Morita et al. [54].

12 A obtenção da solução P(x , y ) é descrita em detalhes no apêndice C da referência [62],
para o caso em que K é dado por um tensor diagonal. A solução para um tensor K completo
requer a diagonalização do tensor como passo prévio.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 100

Condição de Dirichleta partir de

Nó do poço

Solução analítica:

(a) Especificação do problema (b) Enfoque numérico

Figura 5.6 – Problema auxiliar para a determinação do índice de poço em
duas dimensões.

numérico auxiliar, conforme ilustra a figura 5.6(b), a fronteira externa do

domínio é sujeita a condições de Dirichlet, com valores determinados a

partir da solução analítica P(x , y ). Para tanto, são considerados valores
arbitrários da vazão $, da pressão do poço ? e da viscosidade µ. A per-
meabilidade K deve ser considerada com o valor tensorial especificado
no problema original para os elementos no subdomínio auxiliar. Existe

a restrição, entretanto, que esse valor deve ser único para todos esses ele-

mentos, a fim de respeitar a hipótese de meio homogêneo considerada na

solução analítica. Por fim, para completar a especificação do problema

auxiliar, no volume de controle que inclui o poço é considerada a vazão $,

com o mesmo valor considerado na solução analítica. A pesar de não ser

estritamente necessário, no esquema considerado neste trabalho um nó

sempre coincide com a localização do poço. Como é logico, para resolver

o problema numérico auxiliar deve ser considerada a mesma discretiza-

ção que irá ser utilizada depois no modelo numérico para o reservatório

completo.

Idealmente, a solução numérica do problema auxiliar deveria ser pró-

xima à solução analítica, pois em ambos os casos o problema resolvido é o

mesmo. No entanto, em geral, com as malhas utilizadas normalmente não



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 101

é possível capturar a forte variação da pressão na região adjacente ao poço,

por não serem refinadas o suficiente. Na fronteira do subdomínio auxiliar

ambas as soluções coincidirão, pela imposição das condições de Dirichlet

a partir da solução analítica. Porém, à medida que os pontos se aproxima-

rem do poço, a discrepância entre ambas as soluções aumentará, em geral,

de forma acentuada. Desse modo, a discrepância se torna máxima no nó

da malha coincidente com o poço.13 A diferença entre a pressão Pp nesse

nó e a pressão ? pode ser considerada como uma medida da insuficiência
da formulação numérica para capturar a variação exata da pressão na vizi-

nhança do poço. O papel do modelo de poço é, precisamente, compensar

essa insuficiência relacionando o valor exato da vazão com essa diferença

de pressões. Como mostra a equação (5.49), o índice de poço é definido

como fator de proporcionalidade entre essa duas grandezas.

No procedimento descrito, após ser resolvido o problema numérico

auxiliar, o valor correspondente ao índice de poço pode ser determinado

pela expressão seguinte, derivada da equação (5.49),

WI =

?

µ$

Pp ??

?

aux

. (5.55)

O valor do índice de poço assim computado pode ser aplicado depois

à solução de problemas na malha completa do reservatório. Uma vez que

a infuência das condições em outros poços ou nos contornos sobre o esco-

amento na vizinhança imediata de um poço é mínima [1, 54], assume-se
que o valor do índice de poço não estará influenciado de forma signifi-

cativa por essas condições. Além disso, dada linearidade da relação entre

velocidade e gradiente de pressão na lei de Darcy, o valor do índice de poço

deverá manter-se inalterado quando forem utilizados valores de vazão ou

pressão diferentes aos considerados no problema auxiliar descrito.

Por outro lado, da mesma forma que nas correlações de Peaceman,

o valor do índice de poço obtido pela equação (5.55) carrega informação

geométrica da malha circundante ao poço, além da permeabilidade nessa

região. Entretanto, no procedimento descrito acima essa informação é

introduzida de modo indireto, na discretização do problema auxiliar. É

por tal razão, que resulta imprescindível que essa discretização inclua o

13 Nessa análise é desconsiderado o raio do poço, cujo valor é, em geral, insignificante
quando comparado com o tamanho dos elementos da malha.



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 102

mesmo tipo de aproximações para os fluxos difusivos que a discretização

do problema completo.

O mesmo enfoque descrito pode ser utilizado em situações tridimen-

sionais, fazendo-se algumas considerações adicionais. A diferença mais

importante é que em três dimensões existem vários nós ao longo de um

poço. Em consequência, a cada um desses nós deve ser associado um

índice de poço que permita calcular a vazão para o volume de controle

correspondente. A fim de determinar os valores desses índices de poço,

cada elemento de poço deve ser considerado de forma separada. Em três

dimensões, soluções analíticas simples somente podem ser determinadas

considerando um poço reto de comprimento infinito em um meio ho-

mogêneo infinito.14 Logo, para cada elemento de poço é associado um

problema auxiliar equivalente ao descrito para o caso bidimensional, con-

siderando que o poço se estende indefinidamente na direção do elemento

em questão.

A situação descrita encontra-se ilustrada de modo esquemático na

figura 5.7. Para resolver numericamente o problema auxiliar é conside-

rada uma porção da malha com certo número de elementos ao redor do

segmento de poço. Experimentos numéricos mostram que duas ou três

camadas de elementos ao redor do segmento são adequados para obter

resultados suficientemente precisos para o índice de poço. No contorno

externo da submalha auxiliar é prescrita a condição de Dirichlet, com valo-

res determinados por meio da solução analítica. As outras duas fronteiras

são consideradas impermeáveis e pelo segmento de poço considera-se que

atravessa uma vazão uniforme $.

Depois de resolver o problema auxiliar, valores nodais da pressão es-

tarão disponíveis para os nós p 1 e p 2 , localizados nas extremidades do

elemento de poço. A cada um desses nós deve ser associado um valor de

índice de poço proveniente do problema auxiliar. Na discretização desse

problema, a vazão $é repartida em partes iguais entre os dois volumes de

controle associados aos nós p 1 e p 2 . Logo, para cada um desses nós é pos-

sível escrever expressões análogas à equação (5.55), porém, considerando

a vazão $/2. Isto é,

WI
we
p1 =

1

2

?

µ$

Pp1??

?

aux

, (5.56)

14 A solução analítica considerada neste trabalho é a derivada por Aavatsmark e Klausen
em [1].



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 103

WI
we
p2 =

1

2

?

µ$

Pp2??

?

aux

. (5.57)

Poço

Vazão ao elemento            de poço:
Condição de Dirichleta partir da solução analítica 

Nó

Nó

Figura 5.7 – Submalha no problema auxiliar para a determinação do índice
de poço em três dimensões.

Os índices de poço nas equações (5.56) e (5.57) carregam o índice we

porque são valores parciais referidos apenas ao elemento de poço consi-

derado no problema auxiliar. Segundo mostra a figura 5.4, todo volume de

controle em contato com um poço, exceto os dois nas duas extremidades,

envolve as metades de dois elementos de poço. O valor do índice de poço

dado pela equação (5.56) ou pela equação (5.57) corresponde a uma dessas

metades. Para todos os nós de poço, menos os das extremidades, o valor

a ser utilizado para o volume de controle completo deve ser a soma dos

valores parciais correspondentes às duas metades associadas ao nó. De



A PLI CAÇÃO A UM M O DELO DE ESCOA M ENTO EM R ESERVATÓ R IO S 104

forma simbólica, pode-se escrever

WIp =
?

we?wEp

WI
we
p , (5.58)

onde wEp é o conjunto de elementos de poço associados ao nó p . Esse
conjunto terá dois elementos para todos os nós de um poço, exceto os das

extremidades, que somente terá um.



CAPÍTULO

6
Exemplos de aplicação

Neste capítulo são apresentados diversos problemas resolvidos aplicando

a formulação numérica descrita nos capítulos precedentes. Os problemas

apresentados foram escolhidos de modo que fosse possível testar diferen-

tes aspectos das soluções numéricas. Na maioria dos casos, tratam-se de

situações físicas descritas por equações diferenciais simplificadas, as quais

apresentam algumas características comuns com as equações do modelo

de escoamento bifásico considerado no capítulo 5. Além de considerar

equações simplificadas, são considerados também domínios de geometria

regular, a fim de tornar possível a obtenção de soluções analíticas exatas,

com as quais as soluções numéricas são comparadas. Em alguns casos

faz-se uso da técnica denominada das soluções manufaturadas [72], na
qual propõe-se a solução exata para uma equação diferencial e, por meio

de diferenciação, determina-se a expressão matemática do termo fonte

correspondente à equação. Esses diversos problemas com soluções conhe-

cidas permitem testar, de forma separada, as características fundamentais

do modelo numérico empregado para a simulação de reservatórios.

De posse da solução exata para um problema, é possível determinar

a magnitude do erro de discretização de uma solução numérica para o

problema. Isto permite, por sua vez, analisar o comportamento do erro de

discretização à medida que as malhas são refinadas e determinar a ordem

105



EX EM P LO S DE AP LIC AÇ ÃO 106

de convergência da discretização, isto é, a taxa de diminuição desse erro

quando o tamanho médio dos elementos da malha é reduzido. Sempre que

possível, uma análise de convergência desse tipo é realizada nos proble-

mas apresentados neste capítulo. Quando pertinente, é analisada também

a influência de algumas características das malhas e/ou do problema sobre
a ordem de convergência.

O modelo de poço considerado neste trabalho é também objeto de

verificação em um dos problemas deste capítulo. Entretanto, nesse caso a

obtenção de uma solução exata apresenta maior dificuldade e por tal razão

optou-se por utilizar uma solução numérica como solução de referência

para realizar as comparações. Nessa malha, a superfície e a vizinhança do

poço são discretizadas com um grau de refino suficiente para dispensar o

uso de um modelo de poço.

Um problema de recuperação secundária de óleo em um reservatório

de geometria complexa é considerado na parte final deste capítulo. Dado

que a obtenção da solução exata para um problema dessa natureza está

fora de questão, alguns aspectos da solução numérica desse problema são

apresentados apenas com caráter ilustrativo, sem qualquer comparação

ou verificação.

Todos os resultados apresentados neste capítulo foram obtidos com

códigos implementados na linguagem C ++, com a auxílio das bibliotecas

EFVLib e ACMLib. A biblioteca EFVLib [47], cujo objetivo é a sistemati-
zação da implementação de formulações de volumes finitos baseadas em

elementos, foi desenvolvida com a fundamentação teórica apresentada

neste trabalho. Já a biblioteca ACMLib [46] permite a solução dos sistemas
de equações lineares, oriundos do processo de discretização, pelo método

multigrid de correções aditivas [18, 39]. Para todos os problemas apre-
sentados neste capítulo, os sistemas de equações lineares foram resolvidos

com o referido método, iterando-se até a norma L 2 dos resíduos do sistema

ser menor que 10?8.

6.1 Problemas de difusão

Nesta seção são considerados problemas descritos pela equação diferen-

cial elíptica

?? · K?P = ?(x , y , z) em ?, (6.1)



EX EM P LO S DE AP LIC AÇ ÃO 107

em que o domínio ? é o cubo unitário 0 ¶ x ¶ 1; 0 ¶ y ¶ 1; 0 ¶ z ¶ 1. O
contorno ?? desse domínio é sujeito à condição de Dirichlet

P = P Dir(x , y , z) em ??. (6.2)

A equação (6.1) pode ser considerada um protótipo da equação da

pressão em uma formulação de escoamento multifásico. A representação

discreta de um termo diferencial de segunda ordem da forma que aparece

nessa equação é um dos ingredientes fundamentais de qualquer formu-

lação numérica para simulação de reservatórios. O propósito dos testes

apresentados aqui é verificar a ordem de convergência para uma variável

eliptica para os diferentes tipos de elementos considerados. Além disso,

procura-se identificar se a distorção dos elementos da malha ou a variação

espacial do tensor K têm alguma influência sobre a convergência.
Os testes realizados seguem as diretrizes de um exercício comparativo

proposto no 5th International Symposium on Finite Volumes for Complex

Applications [31]. A forma adimensional da norma L 2 do erro para a variá-
vel da equação foi computada pela expressão

?P =

?

?

?

?

p?M

?

P(x p , yp , z p)?P?p
?2
?Vp

?

p?M

?

P(x p , yp , z p)
?2
?Vp

?

?

?

1/2

, (6.3)

em que P(x p , yp , z p) é o valor correspondente à solução exata no ponto
coincidente com o nó p , enquanto que P?p é o valor obtido na solução

numérica para o mesmo nó.

Por analogia com a expressão da norma do erro da variável da equa-

ção, foi definida a seguinte norma para o erro na aproximação do seu gra-

diente

??P =

?

?

?

?

?

f ?M

?

?

??P(x?f , y?f , z?f )??P??f
?

?

?

2
?Sf

?

f ?M

?

?

??P(x?f , y?f , z?f )
?

?

?

2
?Sf

?

?

?

?

1/2

. (6.4)

Uma vez que nas equações discretizadas o gradiente é aproximado no

baricentro das faces, a norma do gradiente foi definida com base nessas

aproximações, denotadas na expressão (6.4) como ?P??f . Nessa expressão,
?P(x?f , y?f , z?f ) é o valor exato do gradiente no baricentro da face, obtido por
diferenciação da solução analítica. Além disso, ?Sf é a área da face em
questão.



EX EM P LO S DE AP LIC AÇ ÃO 108

Entretanto, na aproximação do fluxo difusivo em uma face, apenas

participa a componente normal à face do produto K?P . Devido a isso,
decidiu-se comparar o valor da aproximação numérica dessa componente

com o valor determinado a partir da solução analítica no baricentro das

faces. Para tanto, definiu-se a norma para o erro nos fluxos

?q =

?

?

?

?

?

f ?M

h

K?P(x?f , y?f , z?f ) ·?Sf ?K
e?P??f ·?Sf

i2

?

f ?M

h

K?P(x?f , y?f , z?f ) ·?Sf
i2

?

?

?

?

1/2

, (6.5)

em que K?P(x?f , y?f , z?f ) é computado com o valor exato do gradiente no
baricentro de uma face e o valor do tensor K avaliado no mesmo ponto,
quando for variável espacialmente. No entanto, na aproximação numérica,

Ke é o valor associado ao elemento em que a face se encontra, avaliado no
baricentro do elemento, quando K for uma função da posição.1

6.1.1 Problema 1-A

No problema 1-A, a permeabilidade é dada por um tensor identidade, por-

tanto, trata-se de um problema de difusão em um meio isotrópico. O termo

fonte da equação está definido na figura 6.1. Conforme indicado na mesma

figura, um valor nulo é prescrito para a variável no contorno do domínio.

x 1 1

1

z

y

Domínio Permeabilidade
Termo fonte
Valor prescrito no contorno

Figura 6.1 – Problema 1-A.

1 Uma vez que em problemas de simulação de reservatórios a variação espacial da per-
meabilidade é aproximada associando um valor constante a blocos da malha, na formulação
implementada esses valores são atribuídos aos elementos da malha primária.



EX EM P LO S DE AP LIC AÇ ÃO 109

Para as condições especificadas, a solução exata da equação (6.1) é

P = sin(2?x)sin(2?y )sin(2?z). (6.6)

Na solução numérica do problema foram consideradas sequências de

malhas com nível de refinamento progressivamente maior, mantendo exa-

tamente a mesma estrutura sempre que possível. O intuito foi verificar a

redução do valor das normas dos erros definidas anteriormente e estimar

para cada caso a taxa de convergência. Além disso, analisar a influência da

distorção dos elementos da malha sobre a convergência.

Inicialmente são apresentados os resultados com malhas formadas

somente por elementos hexaédricos. A primeira sequência de malhas está

formada por malhas regulares igualmente espaçadas. Mediante desloca-

mento dos vértices internos dessas malhas obtiveram-se sequências de

malhas com elementos distorcidos. Para tanto, aplicaram-se as relações

matemáticas
?

?

?

?

?

?

?

?

?

x ?p = x p +?p ,

y ?p = yp +?p ,

z ?p = z p +?p ,

?p = A sin(2?x p)sin(2?yp)sin(2?z p) .

(6.7)

Nestas expressões, x p , yp e z p são as coordenadas dos vértices na

malha-base regular, enquanto que x ?p , y
?
p e z

?
p são as coordenadas dos

vértices na malha com elementos distorcidos. Estipulando diferentes va-

lores para a amplitude A controla-se o grau de distorção das sequências

de malhas.2 Nos experimentos numéricos realizados foram consideradas

sequências de malhas distorcidas obtidas com amplitudes 0.04, 0.08 e 0.12.3

Para ilustrar, a figura 6.2 mostra as malhas resultantes após a distorção,

considerando uma malha-base de 20×20×20 hexaedros regulares.
Nas figuras 6.3, 6.4 e 6.5 são apresentados gráficos da variação das nor-

mas dos erros definidos nas equações (6.3), (6.4) e (6.5), respectivamente,

em relação ao comprimento representativo dos elementos da malha. Neste

2 Este tipo de distorção senoidal das malhas de hexaedros é uma extensão tridimensional
da distorção considerada em [6] para malhas quadriláteros.

3 É fácil comprovar que uma amplitude maior a 0.012 desloca alguns vértices para fora do
domínio do problema e produz também elementos anômalos.



EX EM P LO S DE AP LIC AÇ ÃO 110

(a)  A = 0 (base)

(c)  A = 0.08

(b)  A = 0.04

(d)  A = 0.12
Figura 6.2 – Malhas de 20 × 20 × 20 hexaedros, apresentando diferente

amplitude de distorção dos elementos.

e todos os casos apresentados mais adiante, esse comprimento caracterís-

tico é determinado pela expressão [32]

h =
?

V ?/N Me
?

1
3 , (6.8)

em que V ? é o volume do domínio e N Me é o número total de elementos

volumétricos da malha M que discretiza tal domínio.
Nos gráficos apresentados, cada ponto representa o valor da norma

de um dos erros, determinada na solução numérica em uma dada malha.

Nas malhas de hexaedros consideraram-se sequências de malhas em que

a malha mais grosseira possui 10 × 10 × 10 elementos e a mais refinada
143×143×143 elementos. Para cada sequência de malhas, apresentam-se
também ajustes dos pontos a expressões da forma ? = a h b , cujas repre-
sentações na escala logarítmica são as linhas retas presentes nos gráficos.

O expoente do ajuste indica a taxa de convergência observada, na norma

L 2 considerada, da variável da equação, do gradiente ou dos fluxos.



EX EM P LO S DE AP LIC AÇ ÃO 111

0.01 0.1

10
-3

10
-2

10
-1

 

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

2.010~ 9.88 h

2.009~ 10.32 h

2.009~ 11.43 h

2.011~ 12.66 h

Figura 6.3 – Convergência da pressão no problema 1-A, para malhas de
hexaedros com diferente amplitude de distorção.

0.01 0.1

10
-2

10
-1

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

0.999~ 1.27 h

0.998~ 1.39 h

0.997~ 1.71 h

0.998~ 2.24 h

Figura 6.4 – Convergência do gradiente da pressão no problema 1-A, para
malhas de hexaedros com diferente amplitude de distorção.

0.01 0.1
10

-5

10
-4

10
-3

10
-2

10
-1

 

 

 

 

 
 

 

 
 

A = 0

A = 0.01

A = 0.04

A = 0.08

A = 0.12

2.124~ 0.71 h

1.093~ 0.11 h

1.036~ 0.37 h

1.018~ 0.80 h

1.005~ 1.43 h

Figura 6.5 – Convergência dos fluxos no problema 1-A, para malhas de
hexaedros com diferente amplitude de distorção.



EX EM P LO S DE AP LIC AÇ ÃO 112

Conforme se pode observar nas figuras 6.3 e 6.4, a acurácia é de se-

gunda ordem para P e de primeira ordem para ?P , independentemente
da distorção considerada para as malhas. No caso de P , a influência da

distorção é mínima e os ajustes obtidos para as sequências de malhas estão

quase superpostos. No caso da norma do erro nos fluxos, cuja conver-

gência é mostrada na figura 6.5 é observado um fenômeno particular. A

convergência dessa norma para as malhas regulares acontece a uma taxa

levemente maior a segunda ordem, enquanto que para todas as malhas

distorcidas observa-se uma taxa de primeira ordem. Já que no problema

1-A a permeabilidade é isotrópica, isso significaria que para malhas de

hexaedros regulares a aproximação da componente normal às faces con-

verge a uma taxa maior que a aproximação do próprio gradiente. Na li-

teratura, quando o erro de uma aproximação numérica em um ponto se

reduz a uma taxa maior do que no entorno, diz-se que a aproximação é

superconvergente nesse ponto [84]. Pelos resultados obtidos, os baricen-
tros das faces apresentam superconvergência em malhas regulares, para

a aproximação da componente do gradiente normal à face. Infelizmente,

apenas uma leve distorção nos elementos já causa uma redução significa-

tiva na taxa de convergência. Como mostra a figura 6.5, uma amplitude de

distorção de 0.01, que na prática apenas pode distinguir-se visualmente,

reduz a taxa de convergência a um valor próximo á unidade.

Os resultados apresentados até agora mostram que a distorção dos

elementos hexaédricos não influência de modo significativo a taxa de con-

vergência, pelo menos para os erros associados à variável da equação e ao

gradiente. Contudo, é importante quantificar de alguma forma a distorção

nas malhas consideradas até agora. Uma medida usualmente utilizada

para quantificar a deformação de elementos hexaédricos é a razão entre

o mínimo e o máximo valor do jacobiano da transformação de coordena-

das, definida previamente na equação (3.1) [2, 43]. Aqui foi considerado o
seguinte índice de deformação para os elementos hexaédricos

I edef = 1?
minp?N e |J|p
maxp?N e |J|p

, (6.9)

o qual será nulo quando o hexaedro for regular e tenderá a 1 á medida que

aumentar a deformação do elemento.4

4 Se minp?N e |J|p for negativo atribui-se diretamente um valor unitário a I edef



EX EM P LO S DE AP LIC AÇ ÃO 113

Os histogramas da figura 6.6 ilustram a distribuição de valores do ín-

dice de distorção definido na equação (6.9), para as malhas mostradas na

figura 6.2. Conforme se pode observar, nas malhas com amplitudes de

distorção A = 0.08 e A = 0.12 existe uma grande porcentagem de elementos
com valor significativamente alto do índice de deformação.

0
25
50
75

100 A = 0A = 0.04A = 0.08A = 0.12

Índice de deformação

Porcen
tagem

 de ele
mento

s

0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0
Figura 6.6 – Índice de deformação dos elementos para diferentes amplitu-

des de distorção, nas malhas de 20×20×20 hexaedros.

Devido ao deslocamento dos vértices, as facetas das malhas distor-

cidas devem ter adquirido curvatura e deixado de ser planas. Como es-

perado, esse fenômeno não teve incidência sobre a taxa de convergência,

porém, é importante também quantificar o grau de arqueamento que so-

freram as facetas no processo de distorção das malhas. Baseado na proje-

ção de uma faceta quadrangular sobre um plano médio, na referência [2] é
definido o seguinte índice de arqueamento

I arq =
2?

p

A proj
. (6.10)

O procedimento de cômputo do índice e o significado dos parâmetros

envolvidos estão ilustrados na figura 6.7. Inicialmente é determinado um

vetor normal médio para a faceta, mediante o produto vetorial de suas

diagonais. Com ajuda desse vetor determina-se um plano médio passando

pelo baricentro dos vértices da faceta. O comprimento ? na equação (6.10)

é a distância de um dos vértices ao referido plano médio. Por construção,

essa distância é a mesma para os quatro vértices. Finalmente, A proj é a área

do quadrilátero projetada no plano médio. O índice de arqueamento para



EX EM P LO S DE AP LIC AÇ ÃO 114

um elemento hexaédrico será o máximo valor dos índices determinados

pela equação (6.10), entre todas as facetas do elemento [2].

A

B

C
D

Projeção noplano médio(área         ) (a) (b)
Figura 6.7 – Projeção de uma faceta arqueada sobre o plano médio.

Os histogramas da figura 6.8 apresentam a distribuição de valores do

índice de arqueamento definido previamente, para as malhas mostradas

na figura 6.2. Na malha com amplitude de distorção A = 0.12, os valores
máximos do índice de arqueamento atingem 0.2. Apesar desse valor não

ser especialmente alto, pode-se observar que a porcentagem de elementos

com facetas nâo-planas nessa malha é próximo a 75%.

0
25
50
75

100 A = 0A = 0.04A = 0.08A = 0.12

Índice de arqueamentoP
orcent

agem d
e elem

entos

0.00 0.04 0.08 0.12 0.16 0.20
Figura 6.8 – Índice de arqueamento dos elementos para diferentes ampli-

tudes de distorção, nas malhas de 20×20×20 hexaedros.

A fim de determinar o comportamento dos erros com elementos de

outras formas, o problema 1-A foi resolvido com sequências de malhas for-



EX EM P LO S DE AP LIC AÇ ÃO 115

madas por tetraedros, prismas e pirâmides. Para manter controle sobre a

estrutura dessas malhas ao serem refinadas, elas foram obtidas por divisão

das malhas de hexaedros descritas anteriormente. Cada elemento dessas

malhas foi dividido em tetraedros, prismas ou pirâmides, da forma ilus-

trada na figura 6.9. As malhas de tetraedros e prismas possuem o mesmo

número de vértices que as correspondentes de hexaedros, porém, maior

quantidade de elementos. Já as malhas de pirâmides, além de possuir

mais elementos que as de hexaedros, possuem também mais vértices, pela

adição de um vértice central em cada hexaedro, como mostra a figura 6.9.

Hexaedro

6 tetraedros

6 pirâmides

2 prismas

Figura 6.9 – Divisão de um hexaedro em tetraedros, prismas ou pirâmides.

Nas figuras 6.10, 6.11 e 6.12 são apresentados gráficos que mostram

a redução das normas dos erros ?P , ??P e ?q , respectivamente, com ma-

lhas de tetraedros obtidas da forma descrita acima. Como nas malhas de

hexaedros, nesses gráficos compara-se a convergência para sequências de

malhas apresentando diferente amplitude de distorção. Para distorcer as

malhas empregou-se o mesmo procedimento sintetizado na equação (6.7).

A taxa de convergência da pressão é praticamente de segunda ordem

para as malhas sem distorção. O incremento do erro e a diminuição da taxa

de convergência ao distorcer as malhas são mais acentuados que no caso

dos hexaedros, porém, mesmo assim são pouco significativos. A influência

da distorção no erro do gradiente é ainda menor, podendo-se afirmar que

a convergência é de primeira ordem em todos os casos. A convergência do



EX EM P LO S DE AP LIC AÇ ÃO 116

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

1.998~ 12.05 h

1.975~ 13.05 h

1.94~ 17.33 h

1.93~ 28.47 h

TETRA+

0.01 0.1
10

-4

10
-3

10
-2

 

Figura 6.10 – Convergência da pressão no problema 1-A, para malhas de
tetraedros com diferente amplitude de distorção.

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

0.99~ 6.23 h

0.987~ 6.34 h

0.987~ 6.91 h

0.996~ 8.65 h

P1 TETRA+++

0.01 0.1
10

-2

10
-1

Figura 6.11 – Convergência do gradiente da pressão no problema 1-A, para
malhas de tetraedros com diferente amplitude de distorção.

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

0.987~ 5.96 h

0.982~ 5.97 h

0.978~ 6.43 h

0.988~ 8.35 h

P1 TETRA+++

0.01 0.1
10

-2

10
-1

Figura 6.12 – Convergência dos fluxos no problema 1-A, para malhas de
tetraedros com diferente amplitude de distorção.



EX EM P LO S DE AP LIC AÇ ÃO 117

erro dos fluxos é praticamente idêntica à do erro do gradiente, diferente-

mente do fenômeno observado nas malhas de hexaedros.

As figuras 6.13 e 6.14 apresentam os resultados obtidos para a conver-

gência da pressão e do gradiente, respectivamente, nas malhas de prismas.

Resultados equivalentes obtidos nas malhas de pirâmides são mostrados

nas figuras 6.15 e 6.16. A convergência dessas grandezas em ambos os

casos é qualitativamente semelhante áquela observada nas malhas de te-

traedros, sendo que a taxa de convergência para a pressão é próxima a 2,

enquanto que para o gradiente é próxima de 1. Como nos outros tipos de

elementos já examinados, não é observada uma influência significativa da

distorção das malhas nos valores dessas taxas de convergência.

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

1.998~ 8.37 h

1.999~ 9.49 h

1.985~ 12.08 h

1.942~ 15.07 h

P1 PRISM+++

0.01 0.1
10

-4

10
-3

10
-2

10
-1

 

Figura 6.13 – Convergência da pressão no problema 1-A, para malhas de
prismas com diferente amplitude de distorção.

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

0.999~ 2.91 h

0.993~ 3.01 h

0.985~ 3.39 h

0.978~ 4.04 h

P1 PRISM+++

0.01 0.1
10

-2

10
-1

Figura 6.14 – Convergência do gradiente da pressão no problema 1-A, para
malhas de prismas com diferente amplitude de distorção.



EX EM P LO S DE AP LIC AÇ ÃO 118

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

2.009~ 17.61 h

2.007~ 18.78 h

2.001~ 22.10 h

1.99~ 27.31 h

P1 PYRA+++

 

0.01 0.1
10

-4

10
-3

10
-2

10
-1

 

Figura 6.15 – Convergência da pressão no problema 1-A, para malhas de
pirâmides com diferente amplitude de distorção.

 

 

 
 

 

 
 

A = 0

A = 0.04

A = 0.08

A = 0.12

1.001~ 2.59 h

1.0~ 2.78 h

0.998~ 3.31 h

0.999~ 4.18 h

P1 PYR+++

0.01 0.1
10

-2

10
-1

Figura 6.16 – Convergência do gradiente da pressão no problema 1-A, para
malhas de pirâmides com diferente amplitude de distorção.

Para finalizar esta seção são apresentados resultados obtidos em uma

sequência de malhas híbridas. A estrutura das malhas híbridas utilizadas

no teste pode ser evidenciada na figura 6.17, a qual mostra as três malhas

mais grosseiras da sequência. Todas as malhas têm uma porção central

cúbica formada por elementos hexaédricos regulares, cuja dimensão é 40%

da dimensão do domínio. A porção externa é formada por elementos te-

traédricos, existindo entre ela e a porção central uma região de transição

formada por pirâmides.

Os resultados correspondentes à convergência das três normas ana-

lisadas são apresentados nas figuras 6.18, 6.19 e 6.20, respectivamente.

Para fins de comparação, os gráficos incluem resultados já apresentados,



EX EM P LO S DE AP LIC AÇ ÃO 119

(a) Hexaedros: 27
Pirâmides: 54

Tetraedros: 2754

(b) Hexaedros: 64
Pirâmides: 96

Tetraedros: 6395

(c) Hexaedros: 343
Pirâmides: 294

Tetraedros: 38811

Figura 6.17 – Três malhas híbridas utilizadas nos testes de convergência.

correspondentes às malhas regulares de hexaedros e tetraedros. No caso

da convergência dos erros da pressão, os valores obtidos para a norma

desses erros nas malhas híbridas são levemente maiores que os obtidos

nas malhas de hexaedros e tetraedros. A taxa de convergência também

é levemente menor, contudo, os três valores são bastante próximos entre

si. No caso da convergência do gradiente e dos fluxos, os valores obtidos

para as normas dos erros nas malhas híbridas são intermediários entre os

das malhas hexaédricas, que sempre são menores, e os das malhas tetraé-

dricas. No caso da norma dos erros para os fluxos, os valores nas malhas

de hexaedros são significativamente menores e a taxa de convergência é

maior, pelo fenômeno de superconvergência comentado previamente. Os

valores dessa norma e a taxa de convergência nas malhas híbridas conside-

radas são mais próximos dos valores obtidos com as malhas tetraédricas.

6.1.2 Problema 1-B

No problema de difusão 1-B, descrito também pelas equações (6.1) e (6.2),

é considerado um tensor permeabilidade cujas componentes são funções

das coordenadas espaciais. O objetivo deste problema é determinar como

esse tipo de anisotropia influencia a convergência da solução numérica

obtida com a formulação proposta.

O tensor permeabilidade e a solução exata para o problema 1-B estão

especificados na figura 6.21. Neste caso empregou-se a técnica das solu-



EX EM P LO S DE AP LIC AÇ ÃO 120

 

 

 

 

 

 

Hexaedros

Tetraedros

Híbrida

2.010~ 9.88 h

1.998~ 12.05 h

1.932~ 11.51 h

0.01 0.1
10

-4

10
-3

10
-2

10
-1

 

Figura 6.18 – Comparação da convergência da pressão no problema 1-A,
em malhas hexaédricas, tetraédricas e híbridas.

0.01 0.1

10
-2

10
-1

 

 

 

 

 

Hexaedros

Tetraedros

Híbrida

0.999~ 1.27 h

0.99~ 6.23 h

1.064~ 4.87 h

Figura 6.19 – Comparação da convergência do gradiente da pressão no
problema 1-A em malhas hexaédricas, tetraédricas e híbridas.

 

 

 

2.124~ 0.71 h

0.987~ 5.96 h

1.201~ 6.12 h

0.01 0.1

10
-5

10
-4

10
-3

10
-2

10
-1

 

 

 

 

 

 

 

 

 

Hexaedros

Tetraedros

Híbrida

Figura 6.20 – Comparação da convergência dos fluxos no problema 1-A,
em malhas hexaédricas, tetraédricas e híbridas.



EX EM P LO S DE AP LIC AÇ ÃO 121

ções manufaturadas [72]. Isto é, substituindo a solução exata na equação
diferencial, obteve-se o termo fonte ?(x , y , z) correspondente. O referido
termo fonte foi obtido com auxílio de um software de matemática simbó-

lica e incorporado diretamente ao código em C ++ implementado para ob-

ter a solução numérica. Além disso, os valores prescritos como condição de

Dirichlet no contorno do domínio, para a obtenção da solução numérica,

foram determinados a partir da própria solução exata.

x 1 1

1

z

y

Domínio Permeabilidade

Solução analítica

Figura 6.21 – Problema 1-B.

Da mesma forma que no problema 1-A, foram consideradas sequên-

cias de malhas progressivamente refinadas para analisar a convergência

das três normas, ?P , ??P e ?q . No entanto, neste caso unicamente foram

empregadas malhas regulares, sem nenhuma distorção, a fim de isolar o

efeito da anisotropia do tensor K. Os resultados obtidos são apresentados
nas figuras 6.22, 6.23 e 6.24. Nos gráficos são comparadas as normas dos

erros nas malhas regulares de hexaedros, tetraedros, prismas e pirâmides,

e também nas malhas híbridas empregadas no problema anterior.

No caso da norma do erro associado à pressão, nas malhas regulares

novamente observa-se convergência de segunda ordem. Já nas malhas

híbridas, a taxa de convergência é menor, embora os valores da norma do

erro não sejam muito diferentes do que nas outras malhas. No caso das

normas dos erros relativos ao gradiente e aos fluxos, as taxas de convergên-

cia encontram-se em quase todos os casos próximas de primeira ordem. A

exceção é o caso da norma dos fluxos nas malhas híbridas, que apresenta

uma taxa de convergência ligeiramente maior.



EX EM P LO S DE AP LIC AÇ ÃO 122

 

 

 

 
 

 

 

 

 

 

Hexaedros

Tetraedros

Prismas

Pirâmides

Híbrida

2.008~ 5.41 h

1.978~ 11.85 h

1.993~ 9.25 h

1.999~ 9.37 h

1.781~ 4.84 h0.01 0.1

10
-3

10
-2

10-1

 

Figura 6.22 – Convergência da pressão no problema 1-B em malhas de
diferente topologia.

0.01 0.1
10

-2

10
-1

 

 

 
 

 

 

 

 

 

Hexaedros

Tetraedros

Prismas

Pirâmides

Híbrida

1.021~ 2.09 h

0.993~ 6.34 h

1.007~ 3.63 h

1.006~ 4.06 h

1.047~ 6.34 h

Figura 6.23 – Convergência do gradiente da pressão no problema 1-B em
malhas de diferente topologia.

0.01 0.1

10
-2

10
-1

 

 

 
 

 

 

 

 

 

Hexaedros

Tetraedros

Prismas

Pirâmides

Híbrida

1.077~ 1.19 h

0.985~ 7.74 h

0.98~ 3.84 h

1.005~ 2.96 h

1.119~ 8.27 h

Figura 6.24 – Convergência dos fluxos no problema 1-B em malhas de
diferente topologia.



EX EM P LO S DE AP LIC AÇ ÃO 123

6.1.3 Problema 1-C

No problema 1-C considera-se um tensor permeabilidade descontínuo.

Conforme mostra a figura 6.25, a descontinuidade se encontra localizada

no plano x = 1
2

, que divide o domínio em duas regiões.5 Para x ¶ 1
2

a per-

meabilidade é dada pelo tensor identidade, enquanto que na outra região

é dada por um tensor com duas direções principais rotacionadas 45? em

relação aos eixos x e y , e a terceira coincidente com o eixo z . Os autovalo-

res desse tensor são {1,", 1}, sendo " um parâmetro que permite controlar
o nível de anisotropia na região x &gt; 1

2
. Nos resultados apresentados nesta

seção considerou-se "= 10?4.

x 1 1

1

z

y

Domínio

x = 
Permeabilidade

Solução analítica

Figura 6.25 – Problema 1-C.

A solução analítica considerada para o problema, especificada na fi-

gura 6.25, satisfaz a condição de fluxo contínuo através da superfície de

descontinuidade, como requerido na equação diferencial (6.1). A densi-

dade de fluxo nessa superfície é dada por

?K?P · un
?

?

x= 1
2
= ?1

2

?

(1+")sin y +(1?")cos y
?

, (6.11)

5 O problema 1-C é uma generalização do problema 4.4 apresentado na referência [32].



EX EM P LO S DE AP LIC AÇ ÃO 124

em que un =(1, 0, 0) é o vetor unitário normal à superfície x =
1
2

.

Mediante substituição da solução analítica na equação diferencial (6.1),

determina-se o termo fonte correspondente, o qual é dado por

? =

?

?

?

1
2

?

x ? 1
2

?

h

(1+") sin y +(1?") cos y
i

+ sin y se x ¶ 1
2

?(1?") e x?
1
2 cos y se x &gt; 1

2
.

(6.12)

Como nos problemas anteriores, para o problema 1-C são apresen-

tados a seguir resultados da convergência das normas dos erros ?P , ??P
e ?q . Esses resultados encontram-se nos gráficos das figuras 6.26, 6.27 e

6.28, respectivamente. Para a obtenção das soluções numéricas, os valores

prescritos no contorno como condição de Dirichlet foram determinados a

partir da solução analítica do problema.

No problema 1-C somente foram consideradas as sequências de ma-

lhas regulares de hexaedros, tetraedros, prismas e pirâmides, utilizadas

para os problemas anteriores. Neste caso, os valores observados para as ta-

xas de convergência coincidem quase exatamente com os valores teóricos,

independentemente da topologia dos elementos da malha. Isto é, segunda

ordem para os erros na pressão, e primeira ordem para os erros no gra-

diente e nos fluxos. Apesar dessa regularidade nas taxas de convergência,

observa-se diferenças pronunciadas nos valores das normas dos erros para

diferentes tipos de elementos considerados.

6.2 Problema 2: advecção não-linear

Nesta seção é considerado o problema de advecção descrito pela equação

?s

?t
+ ? · (Fw v) = 0 em ?, (6.13)

em que Fw(s) é uma função não-linear e v é o vetor velocidade. No pro-
blema considerado, o domínio ? é o cubo unitário 0¶x ¶1; 0¶y ¶1;
0¶z ¶1.

A equação (6.13) é uma forma simplificada da equação da saturação,

que forma parte do modelo de deslocamento bifásico descrito no capítulo

5. No caso mais simples, em que o vetor v é constante, é possível obter uma
solução analítica exata para a equação (6.13). Com auxilio dessa solução é



EX EM P LO S DE AP LIC AÇ ÃO 125

 

 

 
 

 

 
 

Hexaedros

Tetraedros

Prismas

Pirâmides

1.987~ 0.0047 h

1.996~ 0.0326 h

2.004~ 0.0152 h

2.001~ 0.0412 h

0.01 0.1

10
-6

10
-5

10
-4

 

Figura 6.26 – Convergência da pressão no problema 1-C em malhas de
diferentes topologias.

 

 

 
 

 

 
 

Hexaedros

Tetraedros

Prismas

Pirâmides

1.0~ 0.098 h

1.0~ 0.538 h

1.0~ 0.363 h

1.0~ 0.277 h

0.01 0.1

10
-3

10
-2

Figura 6.27 – Convergência do gradiente da pressão no problema 1-C em
malhas de diferentes topologias.

 

 

 
 

 

 
 

Hexaedros

Tetraedros

Prismas

Pirâmides

1.0~ 0.057 h

0.997~ 0.204 h

0.999~ 0.122 h

1.0~ 0.140 h

0.01 0.1

10
-3

10
-2

Figura 6.28 – Convergência dos fluxos no problema 1-C em malhas de
diferentes topologias.



EX EM P LO S DE AP LIC AÇ ÃO 126

possível analisar a convergência de soluções numéricas para o problema

advectivo, de forma semelhante ao feito nos problemas de difusão apre-

sentados anteriormente.

Conforme mostra a figura 6.29, para os experimentos numéricos foi

estipulada uma velocidade igual a ux , isto é, uma velocidade unitária na
direção x . Isso implica que o deslocamento acontece somente nessa dire-

ção. A superfície de entrada do escoamento é o plano x = 0 e a superfície de
saída o plano x = 1. As outras superfícies de contorno não são atravessadas
pelos fluidos. A condição de contorno na superfície de entrada é estipulada

como
s = 1 em x = 0 ; t &gt; 0 . (6.14)

Para completar a especificação do problema, prescreve-se a condição

inicial
s = 0 em ?; t = 0 . (6.15)

x

z

y

Entrada (x = 0)
Saída(x = 1)

Velocidade
Função fluxo fracionário

Domínio

Figura 6.29 – Problema 2.

O problema especificado é uma descrição simplificada de um pro-

cesso de deslocamento água-óleo. O óleo, que inicialmente preenche o

domínio, é deslocado gradualmente pela água que ingressa por x = 0.
A equação diferencial considerada ignora qualquer influência da gravi-

dade, da pressão capilar ou da compressibilidade. Unicamente com essas

simplificações é possível determinar uma solução analítica simples para o

problema, a denominada solução de Buckley-Leverett [16].
Na descrição matemática do problema, a forma em que a água des-

loca o óleo durante o processo depende da função fluxo fracionário. Para

os experimentos numéricos foi considerada a função indicada na figura



EX EM P LO S DE AP LIC AÇ ÃO 127

6.29, a qual corresponde corresponde às curvas de permeabilidade relativa

dadas por k rw = s 2 e k ro =(1?s)2, e uma razão de viscosidades µo/µw = 4.
A figura 6.30 mostra a representação gráfica da função fluxo fracionário

considerada.

Perfil de saturaçãoFunção

0 0.2 0.4 0.6 0.8 10
0.2
0.4
0.6
0.8

1

0 0.5 1 1.5 2 2.50
0.2
0.4
0.6
0.8

1

0.447

Figura 6.30 – Função fluxo fracionário e perfil de saturação analítico para o
problema 2.

A equação 6.13 pode ser transformada em uma equação diferencial

ordinária, introduzindo a nova variável independente ? = x/t . Portanto, a
solução da equação é auto-similar, ou seja, apesar de evoluir no tempo, seu

formato geométrico permanece inalterado. A representação da solução

analítica para o problema 2, em relação à variável independente x/t , é

mostrada também na figura 6.30. Para o tipo de problema físico conside-

rado, essa curva é usualmente denominada perfil de saturação. A referida

solução analítica foi obtida segundo o procedimento descrito em [4]. Note-
se que o perfil apresenta uma descontinuidade, a qual é típica em equações

hiperbólicas não-lineares como a equação 6.13.

A fim de analisar a convergência de soluções numéricas para o pro-

blema 2, considerou-se a norma L 1 do erro na aproximação discreta do

campo de saturação. Essa norma, mais adequada para soluções que apre-

sentam descontinuidades [44, 85], é dada por

?s =
?

p?M

?

?s (x p , yp , z p)? s?p
?

??Vp . (6.16)

Note-se que neste caso não é considerada nenhuma normalização,

pois os valores da saturação estão restritos sempre ao intervalo [0, 1].



EX EM P LO S DE AP LIC AÇ ÃO 128

Para a obtenção das soluções numéricas, empregou-se uma imple-

mentação simplificada da formulação de escoamento bifásico apresentada

no capítulo 5. Considerou-se um esquema explícito para o avanço da so-

lução no tempo, além de interpolação upwind de um ponto para aproxi-

mar o fluxo fracionário nas faces dos volumes de controle. A condição de

contorno dada na equação (6.14) não foi implementada como condição de

Dirichlet, isto é, não se forçou que os valores nodais na fronteira de entrada

adquiram o valor s = 1. Em vez disso, como é costumeiro em formulações
de volumes finitos, introduziu-se esse valor na equação de balanço para

os volumes adjacentes, como parte do fluxo advectivo ingressando pelas

faces coincidentes com a fronteira. O fluxo através de uma dessas faces é

dado por (Fw|s=1)v ·?Sbf , no entanto, como Fw|s=1 = 1, o fluxo prescrito se
reduz a v ·?Sbf .

Uma dificuldade adicional para a análise de convergência no problema

2 é a dependência da solução com o tempo. Entretanto, o propósito prin-

cipal da análise é verificar a convergência da solução numérica ao refinar

progressivamente as malhas. Como uma forma de isolar o efeito do refina-

mento espacial, o passo de tempo foi mantido fixo durante todo o processo

transiente e para todas as malhas. O valor do passo de tempo utilizado foi

?t = 0.001, o qual satisfaz o critério CFL em todas as malhas consideradas
nos testes.

A fim de se obter uma percepção inicial do comportamento da norma

do erro da saturação, a figura 6.31 mostra a variação dessa norma com

o tempo, para soluções em três malhas estruturadas igualmente espaça-

das, formadas por elementos hexaédricos. Segundo se observa, as cur-

vas apresentam um crescimento oscilatório na parte inicial. Uma vez que

na equação (6.16) apenas são considerados valores discretos da solução

analítica, a posição exata da descontinuidade nessa solução, em um dado

instante de tempo, não pode ser percebida pela norma considerada. Além

disso, a maior parte dos erros se concentram na vizinhança da desconti-

nuidade. Essas duas particularidades explicam o comportamento oscilató-

rio na parte inicial das curvas. Ao redor de t = 0.6, a descontinuidade aban-
dona o domínio e a partir desse instante observa-se uma redução nos valo-

res da norma do erro. Uma vez que, como já mencionado, o erro encontra-

se concentrado principalmente em torno a descontinuidade, grande parte

dele é advectado para fora do domínio quando a descontinuidade atra-

vessa a fronteira de saída.



EX EM P LO S DE AP LIC AÇ ÃO 129

 ×Malha 100 100 100×

×Malha 40 0 04 ×4

×Malha 10 10 10×

0.0 0.2 0.4 0.6 0.8 1.0
10

-3

10
-2

10
-1

t

Figura 6.31 – Variação temporal da norma do erro na saturação no pro-
blema 2, para três malhas de hexaedros regulares.

No intuito de analisar a taxa de convergência das soluções numéricas,

foram selecionados quatro instantes de tempo: t = {0.25, 0.5, 0.75, 1}. Nos
dois primeiros, a descontinuidade se encontra ainda no interior do domí-

nio, enquanto que nos dois últimos, ela já atravessou a fronteira de saída.

Os valores determinados para a norma do erro, em malhas hexaédricas

regulares, encontram-se representados na figura 6.32, versus o tamanho

representativo dos elementos. Da mesma forma que para os problemas

difusivos, os gráficos incluem ajustes dos valores obtidos a expressões da

forma "s = a h b .

 

 

 
 

 

 
 

t = 0.25

t = 0.50

t = 0.75 

t = 1.0

0.682~ 0.36 h

0.687~ 0.46 h

0.855~ 0.33 h

0.852~ 0.27 h

0.01 0.1

10
-2

10
-1

 

Figura 6.32 – Convergência do erro da saturação em 4 instantes de tempo,
para malhas hexaédricas regulares.

Para t = 0.25 e t = 0.5, a taxa de convergência observada é de aproxi-
madamente 0.68. Este valor é inferior à taxa de primeira ordem que seria



EX EM P LO S DE AP LIC AÇ ÃO 130

esperada para uma formulação em que é utilizada interpolação upwind,

cuja acurácia é formalmente de primeira ordem [78]. Entretanto, a partir
de considerações teóricas é possível mostrar que, em presença de descon-

tinuidades, a ordem de acurácia de um esquema numérico de primeira

ordem pode ser reduzida à metade [85]. Para os outros dois instantes de
tempo considerados, t = 0.75 e t = 1, a taxa de convergência observada é
de aproximadamente 0.85 em ambos os casos. Como para esses tempos

não há mais descontinuidade no domínio, a solução é suave e, portanto,

era de se esperar uma taxa de convergência mais próxima de 1. Porém, em

nenhum dos muitos casos testados, inclusive com perfis de saturação sem

qualquer descontinuidade, obtiveram-se valores da taxa de convergência

maiores aos apresentados aqui.

A seguir são apresentados resultados com malhas distorcidas de ele-

mentos hexaédricos, do tipo considerado anteriormente nos problemas de

difusão. A convergência da norma do erro para essas malhas, no instante

t = 0.5, encontra-se representada na figura 6.33. Nota-se pouca influência
da distorção das malhas sobre a forma como o valor da norma do erro

é reduzida. Os valores da taxa de convergência obtidos nos ajustes para

as malhas distorcidas é ligeiramente maior que no caso da malha regular.

Apesar disso, os valores da norma dos erros para essas malhas são ainda

levemente maiores do que na malha regular.

 

 

 
 

 

 
 

0.687~ 0.46 h

0.716~ 0.55 h

0.727~ 0.55 h

0.732~ 0.56 h

 

0.01 0.1

10
-2

10
-1

 

A = 0

A = 0.04

A = 0.08

A = 0.12

Figura 6.33 – Convergência do erro da saturação em t = 0.5, para malhas
hexaédricas apresentando diferente amplitude de distorção.

A fim de se obter uma visão alternativa da influência da distorção

das malhas sobre a solução numérica, na figura 6.34 são comparados os



EX EM P LO S DE AP LIC AÇ ÃO 131

campos de saturação correspondentes à solução analítica e às soluções

numéricas nas malhas com distorção. Os campos para as soluções numé-

ricas correspondem, de forma aproximada, ao plano y = 0.25 das malhas
de 21 × 21 × 21 elementos hexaédricos. Esse é um dos planos em que a
distorção das malhas é máxima.

Uma das primeiras particularidades a ser notada na figura 6.34 é o

aparente adiantamento da descontinuidade nas soluções numéricas. Em

realidade, devido ao caráter difusivo dos erros, a descontinuidade encontra-

se espalhada em uma espessura equivalente a dois ou três elementos. Isso

causa uma leve variação da saturação diante do que seria a posição exata

da descontinuidade, dando a impressão de ser a própria descontinuidade

na solução numérica. Por outro lado, a deformação da geometria da des-

continuidade não é tão severa quanto a deformação da malha. Devido

ao caráter senoidal da distorção das malhas, a deformação da descon-

tinuidade adquire também formato senoidal. Provavelmente por causa

disso é que erros adicionais no campo de saturação se cancelam e, como

resultado, não há um incremento apreciável na norma do erro para as

malhas distorcidas.

Para finalizar a apresentação de resultados relativos ao problema 2, na

figura 6.35 é comparada a convergência do erro da saturação para malhas

formadas por outros tipos de elementos. Os resultados correspondem ao

instante t = 0.5, para malhas regulares de hexaedros, tetraedros, prismas
e pirâmides. Em cada um desses tipos de malhas, a taxa de convergência

observada é similar à previamente obtida para o problema 2.

6.3 Verificação do modelo de poço
Na seção 5.5 foi apresentado um modelo de poço adequado para uso em

malhas não-estruturadas. Nesta seção procura-se verificar essa aborda-

gem, mediante comparação de resultados obtidos utilizando o modelo com

resultados de uma solução de referência. Infelizmente não foi possível

encontrar uma situação para a qual seja possível determinar uma solução

exata para um problema envolvendo um poço. A situação na qual é factível

obter uma solução analítica para o escoamento em torno a um poço já

é empregada como parte do procedimento de determinação dos índices

de poço, portanto, não é adequada para verificar o modelo. Considerou-

se como solução de referência, por tal razão, uma solução numérica em



EX EM P LO S DE AP LIC AÇ ÃO 132

t = 0.05
A = 0

A = 0.
04

A = 0.
08

A = 0.
12

 t = 0.25  t = 0.50
S

. 
A

N
A

L
Í
T

I
C

A

S
A

T
U

R
A

Ç
Ã

O

S
O

L
U

Ç
Ã

O
 

N
U

M
É

R
I

C
A

0
0.5
0.25
0.75
1

Figura 6.34 – Campos de saturação no plano y = 0.25 correspondentes à
solução analítica e a soluções numéricas obtidas em malhas
com diferentes amplitudes de distorção.



EX EM P LO S DE AP LIC AÇ ÃO 133

 

 

 
 

 

 
 

0.687~ 0.46 h

0.651~ 0.59 h

0.675~ 0.51 h

0.742~ 0.63 h

Hexaedros

Tetraedos

Prismas

Pirâmides

0.01 0.1

10
-2

10
-1

 

Figura 6.35 – Convergência do erro da saturação em t = 0.5, para malhas
regulares de diferentes topologias.

uma malha extremamente refinada na vizinhança do poço, com a qual é

possível dispensar o uso de um modelo de poço.

A geometria dos problemas considerados está especificada na figura

6.36. Trata-se de um domínio paralelepipédico que contém um poço reto

de raio 0.1 m, inclinado em relação às fronteiras.6 Em todos os problemas

apresentados a seguir, o escoamento ingressa ao domínio pela fronteira

x = 0 e o abandona através do poço. Todas as restantes fronteiras são
consideradas impermeáveis.

(1000,500, 250)

(150,100,50)

(850, 400, 200)

x

O

yz Entrada
Poço de raio 0.1 m

Figura 6.36 – Geometria do domínio e do poço.

6 Todas as coordenadas indicadas na figura 6.36, as quais determinam a geometria do
problema, estão em metros.



EX EM P LO S DE AP LIC AÇ ÃO 134

Duas malhas não-estruturadas foram empregadas para os experimen-

tos numéricos nesta seção. A primeira malha, denominada malha M-1, é

utilizada para obter a solução de referência. Nela, a superfície do poço,

isto é, a interface entre o poço e o meio circundante, é discretizada com

elementos de contorno triangulares. No modelo numérico para a solução

de referência, portanto, essa superfície é considerada como uma fronteira

do domínio. Conforme ilustra a figura 6.37, a malha volumétrica está for-

mada exclusivamente por elementos tetraédricos. Dado que o raio do poço

é várias ordens de grandeza menor que as dimensões do domínio, foi ne-

cessário considerar uma redução gradual do tamanho dos elementos até

a superfície do poço, conforme mostra a referida figura. Esse refinamento

permite discretizar adequadamente a superfície do poço e captar com sufi-

ciente precisão na solução numérica o forte gradiente de pressão adjacente

ao poço. Entretanto, esse tratamento exige um número desproporcional

de elementos em relação a magnitude do problema considerado, mais de

5 milhões de elementos, como indica a figura 6.37.

Poço

Malha de tetraedrosNúmero de elementos: 5 106 860Número de vértices: 875 919
Figura 6.37 – Malha M-1: superfície do poço discretizada com elementos

de contorno triangulares.

A segunda malha considerada é a malha M-2, mostrada na figura 6.38.

Nesta malha o poço é representado de forma discreta como uma sequência



EX EM P LO S DE AP LIC AÇ ÃO 135

de elementos unidimensionais. Ao redor do poço, a malha volumétrica

possui formato cilíndrico, como mostrado no detalhe da figura 6.38, com

uma camada de prismas e duas camadas de hexaedros. A porção restante

do domínio é discretizada com elementos tetraédricos, além de alguns

elementos piramidais na região de transição. Note-se que o número total

de elementos e o número de vértices na malha M-2 são duas ordens de

grandeza menores que na malha M-1.

Malha do poço

Número de tetraedros: 27 535Número de hexaedros: 336Número de prismas: 168Número de pirâmides: 192Número de vértices: 5 779Submalha cilíndrica
Malha mista

Figura 6.38 – Malha M-2: poço discretizado com elementos de poço unidi-
mensionais.

No domínio mostrado na figura 6.36 foram resolvidos três problemas

de escoamento monofásico incompressível em regime estacionário. A equa-

ção diferencial considerada para descrever tal tipo de escoamento é

?? ·
K

µ
?P = 0 , (6.17)

que provém da substituição da velocidade de Darcy na equação de conser-

vação de massa, a qual, para o caso considerado, reduz-se a?· v = 0. Para
simplificar ainda mais a análise, desconsiderou-se também a influência da

gravidade sobre o escoamento.

A especificação matemática do problema é completada pelas condi-

ções de contorno
P = 1000 bar em x = 0 , (6.18)



EX EM P LO S DE AP LIC AÇ ÃO 136

P = 1 bar em ??W , (6.19)

onde ??W é a superfície do poço. Conforme mencionado previamente, as
restantes fronteiras do domínio são consideradas impermeáveis.

A rigor, a condição (6.19) somente é considerada quando o problema

é resolvido numericamente na malha M-1. Quando a solução é obtida na

malha M-2, emprega-se o modelo de poço, definido pela equação (5.49).

Nessa equação considera-se ? = 1 bar ao longo de todo o poço, isto é,
o mesmo valor de pressão considerado na malha M-1 como pressão na

superfície do poço. Os valores dos índices de poço para todos os volumes

de controle em contato com o poço são determinados segundo o procedi-

mento descrito na seção 5.5.

A seguir são apresentados resultados de três casos, os quais diferem no

tensor permeabilidade, o qual é uniforme em todo o domínio. Na figura

6.39 estão especificados os tensores permeabilidade considerados. Nos

três casos o valor da viscosidade do fluido é 10?3 Pa ·s .

Problema 3-AMeio homogêneo de permeabilidade K
Problema 3-B
Problema 3-C

Figura 6.39 – Tensor permeabilidade para os problemas 3-A, 3-B e 3-C.

6.3.1 Problema 3-A

No problema 3-A, a permeabilidade é um tensor esférico e o meio poroso é,

portanto, isotrópico. Os campos de pressão obtidos nas malhas M-1 e M-2

são comparados na figura 6.40. Os gráficos mostram a varição do campo

nas fronteiras externas, assim como algumas superfícies de valor constante

ou isosuperfícies. Observa-se uma proximidade notável no formato das



EX EM P LO S DE AP LIC AÇ ÃO 137

isosuperfícies, considerando que a malha M-2 é muito mais grosseira do

que a malha M-1. As isosuperfícies apresentam um formato aguçado na

vizinhança do poço por causa do elevado gradiente nessa região.

P
R

E
S

S
Ã

O
  

[bar]
1000

1000

1000

750

750

500

500

250

250

175

175

500.5
750.25
250.25
1

(a)

(b)

S
O

L
U

Ç
Ã

O
 N

A
-

M
A

L
H

A
 M

1
S

O
L

U
Ç

Ã
O

 N
A

-
M

A
L

H
A

 M
2

Figura 6.40 – Comparação dos campos de pressão para o problema 3-A
resolvido nas malhas M-1 e M-2.

No problema especificado, o valor de pressão na interface entre poço

e reservatório é mantido constante ao longo do poço. Nessa circunstância,

o resultado relevante para o poço é a vazão. A vazão que ingressa em um

poço não é uniforme e, em geral, apresenta variação significativa ao longo

do seu comprimento. Se u for a coordenada ao longo do poço, a vazão total

que abandona o reservatório pelo poço será dada por

$W =

?

W

$? du , (6.20)



EX EM P LO S DE AP LIC AÇ ÃO 138

em que a derivada $? = d$/du pode ser aproximada, no problema dis-
creto, por

$? ? $p /?up . (6.21)

Esta aproximação é adequada para a solução na malha M-2, sendo $p
a vazão para um volume de controle associado ao poço e ?up a dimensão
desse volume na direção axial do poço. A figura 6.41 apresenta a varia-

ção de $? ao longo do poço no problema 3-A, determinada em ambas as

malhas. Para determinar os valores na malha M-1, a superfície do poço

foi dividida em 100 fatias do mesmo comprimento, somaram-se os valores

da vazões através de todos os elementos de contorno em cada fatia e o

resultado foi dividido pelo comprimento da respectiva fatia. Conforme

se pode observar na figura 6.41, a concordância entre os resultados em

ambas as malhas é notável, tanto na variação de $?, quanto no valor total

da vazão.

0 300 600 9000.000
0.002
0.004
0.006
0.008
0.010

x

y
u

z

 Solução na malha M-1Solução na malha M-2

Malha M-1Malha M-2 Erro: 0.2%2.4222.428
Vazão total 

Figura 6.41 – Comparação dos resultados de vazão no poço para o pro-
blema 3-A.

6.3.2 Problema 3-B

No problema 3-B, as direções principais do tensor K coincidem com as
direções coordenadas, entretanto, a permeabilidade na direção z é um

décimo da permeabilidade nas outras direções. As figuras 6.42 e 6.43 apre-

sentam os resultados correspondentes a este problema.



EX EM P LO S DE AP LIC AÇ ÃO 139

P
R

E
S

S
Ã

O
  

[bar]

1000
1000

1000

800

800

600

600

500

500

400

400

500.5
750.25
250.25
1

(a)

(b)

S
O

L
U

Ç
Ã

O
 N

A
-

M
A

L
H

A
 M

1
S

O
L

U
Ç

Ã
O

 N
A

-
M

A
L

H
A

 M
2

Figura 6.42 – Comparação dos campos de pressão para o problema 3-B
resolvido nas malhas M-1 e M-2.

Malha M-1Malha M-2 Erro: 5.8%1.2171.146
Vazão total 

u
0 300 600 9000.000

0.001
0.002
0.003
0.004
0.005  Solução na malha M-1Solução na malha M-2

Figura 6.43 – Comparação dos resultados de vazão no poço para o pro-
blema 3-B.



EX EM P LO S DE AP LIC AÇ ÃO 140

Conforme se pode evidenciar na figura 6.42, as isosuperfícies apre-

sentam um formato achatado na direção z , pelo fato da permeabilidade

ser menor nessa direção. Em geral, em problemas como o resolvido, a

componente maior do gradiente de pressão está orientada na direção da

menor permeabilidade e, portanto, as isosuperfícies tendem a ser perpen-

diculares a essa direção.

Dos três problemas considerados aqui para verificar o modelo de poço,

o problema 3-B é o que maior discrepância apresenta entre os resultados

nas malhas M-1 e M-2. Isso é mais evidente nos resultados da vazão no

poço, mostrados na figura 6.43. A causa mais provável para essa discrepân-

cia encontra-se no procedimento de determinação dos índices de poço.

Quando o problema numérico é resolvido em uma porção de malha ao

redor de um elemento de poço, como a ilustrada na figura 5.7, assume-

se que a vazão pelas fronteiras transversais é desprezível. Essa hipótese

é aceitável quando o meio for isotrópico, situação em que o escoamento

será radial na vizinhança imediata do poço e, portanto, o gradiente de

pressão apontará sempre na direção radial. Em um meio anisotrópico, no

entanto, pode existir uma componente importante do gradiente na direção

axial, pelo fato comentado previamente do gradiente tender a orientar-se

na direção de menor permeabilidade. A omissão da vazão axial induzida

por essa componente pode estar causando um desvio no valor dos índices

de poço calculados, o qual, por sua vez, estaria provocando a maior discre-

pância observada no problema 3-B.

6.3.3 Problema 3-C

A permeabilidade especificada para o problema 3-C é dada por um tensor

cheio, isto é, um tensor com todas as componentes não-nulas. Os valores

principais do tensor são 10?14, 10?13 e 10?15 m 2, associados aos autove-

tores (0.873,?0.436,?0.218), (0,?0.447, 0.894) e (?0.488,?0.781,?0.390),
respectivamente. Os resultados relevantes para este problema estão resu-

midos nas figuras 6.44 e 6.45.

Uma das características destacáveis dos resultados do problema 3-C

é a vazão quase nula na porção inicial do poço.7 Como se pode deduzir

da figura 6.44, a maior variação da pressão está concentrada na região

7 Inicial em relação à coordenada u que, como mostrado na figura 6.45, tem sua origem
no topo do poço.



EX EM P LO S DE AP LIC AÇ ÃO 141

P
R

E
S

S
Ã

O
  

[bar]

1000
1000

1000

800

800

600

600

200

200

100

100

50

50

400

400

500.5
750.25
250.25
1

(a)

(b)

S
O

L
U

Ç
Ã

O
 N

A
-

M
A

L
H

A
 M

1
S

O
L

U
Ç

Ã
O

 N
A

-
M

A
L

H
A

 M
2

Figura 6.44 – Comparação dos campos de pressão para o problema 3-C
resolvido nas malhas M-1 e M-2.

 Solução na malha M-1Solução na malha M-2

u
0 300 600 9000.0000

0.0005
0.0010
0.0015
0.0020

Malha M-1Malha M-2 Erro: 1.9%0.25860.2636
Vazão total 

Figura 6.45 – Comparação dos resultados de vazão no poço para o pro-
blema 3-C.



EX EM P LO S DE AP LIC AÇ ÃO 142

próxima à fronteira de entrada. No outro extremo do domínio, a pressão

é praticamente constante, o que implica um gradiente nulo nessa região. A

vazão nula na parte superior do poço é concordante com essa distribuição

espacial da pressão. Por outro lado, é possível observar que as isosuperfí-

cies de pressão tendem a se posicionar perpendicularmente ao autovetor

(?0.488,?0.781,?0.390), o qual está associado ao menor autovalor do ten-
sor permeabilidade.

6.4 Problema 4: deslocamento bifásico
Para finalizar este capítulo são apresentados alguns resultados correspon-

dentes a um problema em que o escoamento é descrito pelo modelo de

deslocamento bifásico apresentado no capítulo 5. Trata-se do processo

de recuperação secundária de óleo em um reservatório tridimensional, no

qual existem três poços injetores e dois poços produtores. Um esboço da

geometria e da malha considerada é mostrado na figura 6.46.

z xy -Poço I 1
-Poço P 1

-Poço I 2
-Poço P 2

-Poço I 3
Malha
Domínio

Número de tetraedros: 35286Número de hexaedros: 544Número de prismas: 544Número de pirâmides: 576Número de vértices: 8073

Dimensão máxima em x: 200 mDimensão máxima em y: 200 mDimensão máxima em z: 130 m

Figura 6.46 – Malha não-estruturada para o problema 4.

O reservatório possui três camadas de diferentes rochas, as quais apre-

sentam propriedades físicas diferentes. A geometria das camadas e os

valores das propriedades correspondentes são apresentados na figura 6.47.



EX EM P LO S DE AP LIC AÇ ÃO 143

Camada 1Camada 2Camada 3
z xy

Camada 1
Camada 2
Camada 3

Figura 6.47 – Propriedades físicas associadas às camadas do reservatório
no problema 4.

Os três poços injetores são poços verticais que atravessam integral-

mente a espessura do reservatório. Já os dois poços produtores são poços

direcionais, cuja geometria é mostrada de forma esquemática na figura

6.48. Conforme indicado nessa figura, a vazão de água injetada em todos os

poços injetores é de 0.005 m 3/s . Por outro lado, a pressão de referência para

ambos os poços produtores é de 10 bar. Para o problema considerado, essa

pressão corresponde à pressão interna na seção onde cada poço atravessa

à fronteira superior do reservatório. Em torno a cada um dos poços a malha

volumétrica tem formato cilíndrico, acompanhando a trajetória da linha

que representa o poço no modelo discreto. A porção restante da malha do

reservatório está formada por tetraedros e algumas pirâmides, na transição

com as porções de geometria cilíndrica ao redor dos poços.



EX EM P LO S DE AP LIC AÇ ÃO 144

z xy
-I 1-I 1

-I 2-I 2

-P 1
-P 1

-P 2-I 3-P 2-I 3

z xy

- -Poços produtores P 1, P 2
- - -Poços injetores I 1, I 2, I 3 Raio [m] Condição de operação

Figura 6.48 – Geometria dos poços e condições de operação prescritas para
o problema 4.

O processo de deslocamento água-óleo no reservatório foi simulado

considerando as curvas de permeabilidade relativa dadas por k rw = s 2

e k ro = (1 ? s)2, para as fases água e óleo, respectivamente. Os valores
de viscosidade considerados para essas fases foram µw = 0.001 Pa ·s e
µo = 0.01 Pa ·s , respectivamente. Além disso, os valores da densidade das
fases foram fixados em ?w = 1000 kg/m 3 e ?o = 800 kg/m 3, respectiva-
mente. A aceleração devida à gravidade especificada foi g =(9.8, 0, 0) m/s 2.
Finalmente, como condição inicial para o processo, considerou-se s = 0
em todo o domínio de solução. Todas as fronteiras do reservatório são

impermeáveis.

A seguir são apresentados alguns resultados numéricos relevantes, ob-

tidos para o problema com a formulação proposta. Os resultados mostra-

dos têm apenas caráter ilustrativo, pois, para um problema dessa enver-

gadura é extremamente difícil determinar uma solução de referência para

fins de comparação.

A figura 6.49 mostra algumas isosuperfícies de pressão em três está-

gios do processo transiente. Os níveis de tempo correspondem ao ins-



EX EM P LO S DE AP LIC AÇ ÃO 145

P
R

E
S

S
Ã

O
 
 
[bar]

155.1
85.0
120.0
50.0
14.9

P
R

E
S

S
Ã

O
 
 
[bar]

197.4
107.2
152.3
62.1
17.0

P
R

E
S

S
Ã

O
 
 
[bar]

773.6
398.4
586.0
210.8
23.2

  = 0

  = 1 VPI

  = 2 VPI

Figura 6.49 – Campo de pressão em três instantes de tempo.



EX EM P LO S DE AP LIC AÇ ÃO 146

tante inicial do processo,8 e depois de terem-se injetado volumes de água

equivalentes a 1 e 2 volumes porosos do reservatório. Na simulação de

processos de recuperação secundária de óleo é usual definir como tempo

adimensional o volume poroso injetado (VPI) que é, precisamente, a fração

do volume poroso do reservatório equivalente ao volume de água injetada

até um dado nível de tempo. Matematicamente, tem-se

? =

?

W inj??

? t

0
$W dt

?

?
? dV

, (6.22)

onde a soma no numerador se estende a todos os poços injetores no domí-

nio. Em todos os resultados apresentados nesta seção, a grandeza adimen-

sional definida na equação (6.22) substitui a variável tempo.

A figura 6.50 ilustra a evolução do campo de saturação mediante iso-

superfícies, em três estágios iniciais do processo de deslocamento. Em es-

tágios posteriores do processo, a geometria das isosuperfícies de saturação

torna-se bem mais intrincada, o qual dificulta sua visualização. De forma

complementar, a figura 6.51 mostra a configuração do campo de saturação

em dua seções obtidas cortando o domínio com dois planos verticais.

Geralmente, os resultados mais importantes na simulação de um pro-

cesso de recuperação são referidos aos poços produtores. Para o problema

considerado, a figura 6.52 apresenta a variação das vazões por unidade de

comprimento, determinadas segundo indica a equação (6.21), em três ní-

veis de tempo selecionados e para os dois poços produtores. Essa variação

é representada em relação às coordenadas curvilíneas u 1 e u 2, definidas ao

longo dos poços P-1 e P-2, respectivamente. A origem desses sistemas co-

ordenados está localizada na seção em que esses poços atravessam a fron-

teira superior do reservatório. Complementando os gráficos da figura 6.52,

as figuras 6.53 e 6.54 apresentam a variação temporal das vazões completas

de óleo, água e a soma de ambas, para os poços P-1 e P-2, respectivamente.

Nessas figuras pode-se evidenciar que a frente de água chega primeiro

ao poço P-1 do que ao poço P-2, em um estágio bastante inicial do pro-

cesso. Essa frente de água procede do poço injetor I-1, o qual se encon-

tra localizado bastante próximo da parte inicial do poço P-1. Uma visão

8 Uma vez que no modelo considerado os fluidos são incompressíveis, após um infinité-
simo de tempo do processo de injeção ter-se iniciado, um campo de pressão estabelece-se
em todo o domínio. Esse é o campo mostrado na figura 6.49, para ?= 0.



EX EM P LO S DE AP LIC AÇ ÃO 147

S
A

T
U

R
A

Ç
Ã

O

1
0.5
0.75
0.25
0

Isosuperfíciesrepresentadas0.30.450.60.750.9

  = 0.2 VPI

  = 0.4 VPI

  = 0.6 VPI

Figura 6.50 – Campo de saturação em três instantes de tempo, na parte
inicial do processo transiente.



EX EM P LO S DE AP LIC AÇ ÃO 148

S
A

T
U

R
A

Ç
Ã

O

1
0.5
0.75
0.25
0

  = 0.25 VPI

  = 1 VPI

  = 2 VPI

Figura 6.51 – Campo de saturação em duas seções transversais do domínio,
para três instantes de tempo.



EX EM P LO S DE AP LIC AÇ ÃO 149

0 10 20 30 40 50 60 700.0
1.5 x10-4
3.0 x10-4
4.5 x10-4
6.0 x10-4

0 10 20 30 40 50 60 700.0
1.5 x10-4
3.0 x10-4
4.5 x10-4
6.0 x10-4

0.0
1.5 x10-4
3.0 x10-4
4.5 x10-4
6.0 x10-4

0 10 20 30 40 50 60 70

0 10 20 30 40 50 60 700
10-4

2 x10-4
3 x10-4

0 10 20 30 40 50 60 700
10-4

2 x10-4
3 x10-4

0 10 20 30 40 50 60 700
10-4

2 x10-4
3 x10-4

1 2

1 2

1 2

P O Ç O P - 1 P O Ç O P - 2

Óleo  Água  Total

   = 0.05 VPI

   = 0.5 VPI

   = 1 VPI

Figura 6.52 – Vazões ao longo dos poços produtores em três níveis de
tempo.



EX EM P LO S DE AP LIC AÇ ÃO 150

0.0 0.5 1.0 1.5 2.0

0.000

0.004

0.008

0.012

Vazão de óleo

Vazão de água

Vazão total

P O Ç O P - 1

Figura 6.53 – Variação temporal das vazões completas no poço P-1.

Vazão de óleo

Vazão de água

Vazão total

P O Ç O P - 2

0.0 0.5 1.0 1.5 2.0

0.000

0.002

0.004

0.006

Figura 6.54 – Variação temporal das vazões completas no poço P-2.

mais abrangente do desempenho qualitativo dos poços produtores pode

ser obtida com o gráfico de corte de água. O corte de água é definido

como a razão entre a vazão de água e a vazão total produzida por um poço.

O gráfico do corte de água para os poços P-1 e P-2 é mostrado na figura

6.55. Nele evidencia-se mais claramente que não apenas a água chega

mais rapidamente ao poço P-1, como ele produz proporcionalmente mais

água durante todo o processo simulado. Apesar disso, o volume de óleo

produzido por esse poço é maior que o produzido pelo poço P-2, conforme

mostra a figura 6.56. Esse aparente paradoxo pode ser explicado exami-

nando novamente as figuras 6.53 e 6.54, as quais mostram que a vazão total

produzida em um dado tempo pelo poço P-1 é mais do dobro da vazão

total produzida pelo poço P-2. Assim, a vazão de óleo produzido pelo poço

P-1 é proporcionalmente menor, em relação à vazão total produzida por



EX EM P LO S DE AP LIC AÇ ÃO 151

esse poço, porém, ainda assim é maior do a que vazão de óleo produzida

pelo poço P-2, em termos absolutos.

0.0 0.5 1.0 1.5 2.0

0.0

0.2

0.4

0.6

0.8

1.0

Poço P-1

Poço P-2

Co
rt

e 
de

 á
gu

a

Figura 6.55 – Corte de água nos dois poços produtores.

0.0 0.5 1.0 1.5 2.0

0

10
4

2 x10
4

3 x10
4

4 x10
4

5 x10
4

Poço P-1

Poço P-2

Pr
od

uç
ão

 d
e 

ól
eo

 

Figura 6.56 – Volume de óleo produzido nos dois poços produtores.



CAPÍTULO

7
Conclusão

Neste trabalho foi apresentada uma formulação numérica tridimensional,

aplicando o método de volumes finitos baseado em elementos a um mo-

delo de deslocamento de fluidos em reservatórios de petróleo. A formu-

lação admite a utilização de malhas não-estruturadas híbridas formadas

por hexaedros, tetraedros, prismas e pirâmides. Além de proporcionar

uma maior flexibilidade para a representação geométrica de reservatórios

tridimensionais, a formulação é conservativa no nível discreto, caracte-

rística fundamental de todo método de volumes finitos. Por construção,

todas as aproximações numéricas são restritas aos elementos da malha

empregada para representar o reservatório, o qual facilita de forma signifi-

cativa a implementação computacional do método. A formulação admite,

além disso, que a permeabilidade de um meio anisotrópico esteja repre-

sentada por um tensor completo, quando as direções principais do tensor

não coincidirem com os eixos coordenados. Reservatórios heterogêneos

podem ser representados com permeabilidade e porosidade variando de

um elemento a outro da malha.

Os resultados apresentados no capítulo 6 permitem estabelecer al-

gumas conclusões quanto ao desempenho de diferentes aspectos da for-

mulação. Para os testes nesse capítulo, adotou-se um enfoque em que as

152



CO NCLU SÃO 153

partes componentes da formulação são testadas de forma separada. Esse

enfoque é comum com modelos numéricos de certa complexidade, pela

dificuldade de se obter soluções analíticas, para comparar os resultados

numéricos, envolvendo a formulação como um todo.

Em problemas puramente difusivos, a taxa de convergência observada

para a variável da equação foi de segunda ordem. Essa taxa de convergên-

cia foi a mesma em malhas formadas por hexaedros, tetraedros, prismas

ou pirâmides. Em um tipo especial de malha híbrida considerado em um

dos experimentos numéricos, o valor da taxa de convergência observada

foi ligeiramente menor a 2. Entretanto, a causa para essa redução pode

estar na diferente estrutura topológica da porção tetraédrica para diferen-

tes níveis de refinamento, pois na geração das malhas não se teve controle

sobre essa estrutura. Por outro lado, nos testes realizados com malhas

formadas por um único tipo de elemento, o valor da taxa de convergência

manteve-se praticamente inalterado mesmo quando os elementos das ma-

lhas foram distorcidos. Resultados semelhantes foram obtidos com per-

meabilidade constante e isotrópica quanto com permeabilidade variável e

anisotrópica.

Nos mesmos experimentos numéricos foi evidenciada uma taxa de

convergência de primeira ordem para a aproximação do gradiente da va-

riável e para a aproximação dos fluxos nas faces dos volumes de controle. A

notável exceção foram as soluções nas malhas regulares de hexaedros, nas

quais a norma do erro associado aos fluxos nas faces diminui a uma taxa

levemente maior a 2, quando a permeabilidade é isotrópica.

Em um problema advectivo não-linear, determinado pela equação de

Buckley-Leverett, observaram-se taxas de convergência com valores infe-

riores ao valor teórico de primeira ordem associado ao tipo de aproxima-

ções numéricas consideradas para o termo advectivo. Esse valor teórico,

contudo, corresponde a casos em que a solução é suave, sem desconti-

nuidades. Entretanto, a solução para o problema considerado apresenta

uma descontinuidade que avança com velocidade constante. Os valores

observados para a taxa de convergência em instantes de tempo em que

a descontinuidade se encontra no domínio são levemente menores aos

correspondentes a instantes posteriores a sua saída.

Em outro conjunto de problemas, o modelo de poço considerado neste

trabalho foi testado considerando diferentes tensores permeabilidade. Ante

a carência de uma solução exata para os problemas considerados, solu-



CO NCLU SÃO 154

ções numéricas em malhas extremamente refinadas foram consideradas

como ponto de comparação para as soluções em malhas grosseiras em

que o modelo de poço era utilizado. O grau de concordância observado

entre essas soluções testemunha o desempenho satisfatório da abordagem

proposta neste trabalho para a modelagem dos poços no modelo numé-

rico. A maior discordância observada nos casos anisotrópicos pode ser

atribuída à hipótese de vazão nula em superfícies transversais ao poço,

considerada no subproblema auxiliar para a determinação dos índices de

poço. Acredita-se que eliminando essa hipótese e calculando essas vazões

a partir da solução analítica do subproblema auxiliar, os resultados possam

melhorar e se equiparar aos do caso isotrópico.

O último problema apresentado no capítulo 6 permitiu mostrar um

pouco do potencial da formulação numérica em aplicações mais realísti-

cas. Um domínio tridimensional contendo poços direcionais foi discreti-

zado por uma malha híbrida, formada principalmente por elementos te-

traédricos. Nesse caso, uma malha relativamente grosseira permitiu de-

terminar uma aproximação numérica detalhada de grandezas associadas

ao escoamento nos poços produtores, os quais apresentavam trajetória

curva no problema considerado. O enfoque considerado para os poços na

formulação é promissor para casos em que a representação da trajetória

dos poços no modelo numérico seja de importância crítica. Obviamente

que, quando necessário, maiores detalhes podem ser introduzidos na mo-

delagem, especialmente no referido à descrição do escoamento no interior

dos poços.

É previsível que no futuro malhas não-estruturadas tridimensionais

sejam adotadas na simulação de reservatórios em aplicações específicas

que requeiram uma descrição acurada de detalhes geométricos. A possibi-

lidade de considerar malhas com elementos de diferentes topologias e de

refinar facilmente nos locais de maior interesse, tornam as malhas não-

estruturadas híbridas uma excelente alternativa para a aproximação da

geometria dos reservatórios. Como visto ao longo deste trabalho, métodos

de volumes finitos baseados em elementos são uma opção que oferece

múltiplas vantagens. Além de permitir a utilização de elementos de dife-

rente topologia de modo unificado e simples em uma mesma formulação,

garante a conservação no nível discreto, tanto global como localmente,

como todo método de volumes finitos. A aproximação consistente dos

fluxos para tensores permeabilidade completos, um problema de longa



CO NCLU SÃO 155

data na simulação de reservatórios com malhas convencionais, é uma ca-

racterística intrínseca da forma do método apresentada neste trabalho.

Certamente a adoção de malhas não-estruturadas para a representa-

ção de reservatórios de petróleo ainda requer um longo processo de ade-

quação. O modelo físico de um reservatório, que é utilizado como base

para a simulação dos escoamentos, é resultado de um trabalho multidisci-

plinar envolvendo uma série de operações para interpretar dados de campo

e de laboratório. Muitos desses procedimentos estão fortemente enrai-

zados em representações geométricas dos reservatórios mediante malhas

cartesianas ou corner point. Consequentemente, a adaptação a uma re-

presentação discreta com malhas não-estruturadas não envolve apenas a

formulação numérica para resolver os escoamentos, mas todo o conjunto

de ferramentas computacionais empregadas na construção do modelo fí-

sico do reservatório.

Com alguns desenvolvimentos complementares, contudo, seria possí-

vel viabilizar a adoção de malhas não-estruturadas em situações particula-

res. Esses desenvolvimentos poderiam incluir, por exemplo, procedimen-

tos de upscaling para transferir a informação referente às propriedades

físicas em modelos convencionais para as malhas não-estruturadas. Além

disso, podem ser desenvolvidos procedimentos especiais de geração de

malha para, apenas nas regiões de maior interesse, substituir alguns blocos

de uma malha convencional corner-point por porções mais refinadas de

malha não-estruturada que acompanhem a geometria de componentes

importantes do reservatório. Dessa forma, a maior parte do modelo físico

já existente para um reservatório poderia ser aproveitada e apenas nas

regiões discretizadas com malha não-estruturada seria necessário realizar

upscaling das propriedades físicas. O intuito, logicamente, seria incremen-

tar a precisão da simulação nessas regiões de maior interesse.

Seja qual for o cenário futuro para o uso de malhas não-estruturadas

na simulação de reservatórios, o presente trabalho tem procurado contri-

buir apresentando uma formulação numérica apta para o uso dessas ma-

lhas em problemas tridimensionais. Pelos motivos previamente expostos,

a formulação será uma alternativa apropriada para ser adotada, quando as

condições forem propícias para a adoção de malhas não-estruturadas na

simulação de reservatórios.



Referências bibliográficas

[1] AAVATSMARK, I., KLAUSEN, R. A. Well index in reservoir simulation
for slanted and slightly curved wells in 3D grids. SPE Journal, v. 8, n. 1,
pp. 41–48, 2003.

[2] ANSYS. Theory reference for ANSYS and ANSYS Workbench Release
12.0. ANSYS Inc., Canonsburg, USA, 2009.

[3] AZIZ, K., SETTARI, A. Petroleum reservoir simulation. Applied
Science Publishers Ltd., London, England, 1979.

[4] BARENBLATT, G. I., ENTOV, V. M., RYZHIK, V. M. Theory of fluid flow
through natural rocks. Kluwer Academic Publishers, Dordrecht, The
Netherlands, 1990.

[5] BENNIS, C., BOROUCHAKI, H., FLANDRIN, N. 3D conforming power
diagrams for radial LGR in CPG reservoir grids. Engineering with
Computers, v. 24, pp. 253–265, 2008.

[6] BERNDT, M., LIPNIKOV, K., MOULTON, J. D., SHASHKOV, M. Con-
vergence of mimetic finite difference discretizations of the diffusion
equation. East-west Journal of Numerical Mathematics, v. 9, n. 4,
pp. 253–316, 2001.

[7] BERTI, G. Generic software components for scientific computing.
Ph.D. Thesis, Faculty of Mathematics, Computer Science, and Natural

Science, Cottbus, Germany, 2000.

[8] BLAZEK, J. Computational fluid dynamics: principles and applicati-
ons. Elsevier Science Ltd., Oxford, UK, 2001.

156



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 157

[9] CHEN, Z., HUAN, G., LI, B. An improved IMPES method for two-phase
flow in porous media. Transport in Porous Media, v. 54, pp. 361–376,
2004.

[10] CHEN, Z., HUAN, G., MA, Y. Computational methods for multiphase
flows in porous media. Society for Industrial and Applied Mathematics,
Philadelphia, USA, 2006.

[11] COATS, K. H. IMPES stability: selection of stable timesteps. SPE
Journal, v. June 2003, pp. 181–188, 2003.

[12] CORDAZZO, J. Simulação de reservatórios de petróleo utilizando
o método EbFVM e multigrid algébrico. Tese de doutorado, De-
partamento de Engenharia Mecânica, Universidade Federal de Santa

Catarina, Florianópolis, Brasil, 2006.

[13] DING, Y., LEMONNIER, P. Use of corner point geometry in reservoir
simulation. In International Meeting on Petroleum Engineering , Beijing,
China, 1995.

[14] DING, Y., RENARD, G., WEILL, L. Representation of wells in nume-
rical reservoir simulation. SPE Reservoir Evaluation &amp;amp; Engineering , v.
February 1998, pp. 18–23, 1998.

[15] DOUGLASS, R. W., CAREY, G. F., WHITE, D. R., HANSEN, G. A., KAL-
LINDERIS, Y., WEATHERILL, N. P. Current views on grid generation:
summaries of a panel discussion. Numerical Heat Transfer, Part B, v.
41, pp. 211–237, 2002.

[16] DULLIEN, F. A. L. Porous media fluid transport and pore structure.
Academic Press Inc., London, England, 1979.

[17] DURLOFSKY, L. J. A triangle based mixed finite element - finite vo-
lume technique for modeling two phase flow through porous media.
Journal of Computational Physics, v. 105, pp. 252–266, 1993.

[18] ELIAS, S. R., STUBLEY, G. D., RAITHBY, G. D. An adaptive agglo-
meration method for the additive correction multigrid. International
Journal for Numerical Methods in Engineering , v. 40, pp. 887–903, 1997.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 158

[19] FARMER, C. L. Geological modelling and reservoir simulation. In
ISKE, A., RANDEN, T., editors, Mathematical methods and modeling

in hydrocarbon exploration and production. Springer-Verlag, Berlin,

Germany, 2005.

[20] FERZIGER, J. H., PERIC?, M. Computational methods for fluid dyna-
mics, third edition. Springer-Verlag, Berlin, Germany, 2002.

[21] FLANDRIN, N., BOROUCHAKI, H., BENNIS, C. 3D hybrid mesh ge-
neration for reservoir simulation. International Journal for Numerical
Methods in Engineering , v. 65, n. 10, pp. 1639–1672, 2005.

[22] FORSYTH, P. A. A control-volume, finite-element method for local
mesh refinement in thermal reservoir simulation. SPE Reservoir Engi-
neering , v. November 1990, pp. 561–566, 1990.

[23] FREY, P. J., GEORGE, P. L. Mesh generation: application to finite
elements. Hermes Science Publications, Paris, France, 2000.

[24] FROLKOVIC, P., SCHEPPER, H. Numerical modelling of convection
dominated transport coupled with density driven flow in porous me-
dia. Advances in Water Resources, v. 24, n. 1, pp. 63–72, 2000.

[25] FU, Y., YANG, Y. K., DEO, M. Three-dimensional, three-phase
discrete-fracture reservoir simulator based on control volume finite
element formulation. In SPE Reservoir Simulation Symposium, Hous-
ton, USA, 2005.

[26] FUNG, L. S. K., HIEBERT, A. D., NGHIEM, L. X. Reservoir simulation
with a control-volume finite-element method. SPE Reservoir Enginee-
ring , v. August 1992, pp. 349–357, 1992.

[27] FUNG, L. S. K., BUCHANAN, L., SHARMA, R. Hybrid-CVFE method
for flexible-grid reservoir simulation. SPE Reservoir Engineering , v.
August 1994, pp. 188–194, 1994.

[28] GEIGER, S., ROBERTS, S., MATTHÄI, S. K., ZOPPOU, C., BURRI, A.
Combining finite element and finite volume methods for efficient
multiphase flow simulations in highly heterogeneous and structurally
complex geologic media. Geofluids, v. 4, pp. 284–299, 2004.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 159

[29] HEINEMANN, G. F., HEINEMANN, Z. E. Gridding concept for the
third generation of reservoir simulators. In 6th International Forum
on Reservoir Simulation, Schloss Fuschl, Austria, 2001.

[30] HEINEMANN, Z. E., BRAND, C. W., MUNKA, M., CHEN, Y. M. Mode-
ling reservoir geometry with irregular grids. SPE Reservoir Engineering ,
v. May 1991, pp. 225–232, 1991.

[31] HERBIN, R., HUBERT, F. Benchmark on the discretization schemes
for anisotropic diffusion problems on general grids. In 5th Internati-
onal Symposium on Finite Volumes for Complex Applications, Aussois,

France, 2008.

[32] HERMELINE, F. A finite volume method for approximating 3D
diffusion operators on general meshes. Journal of Computational
Physics, v. 228, pp. 5763–5786, 2009.

[33] HOTEIT, H., FIROOZABADI, A. An efficient numerical model for
incompressible two-phase flow in fractured media. Advances in Water
Resources, v. 31, pp. 891–905, 2008.

[34] HUBER, R., HELMIG, R. Node-centered finite volume discretizations
for the numerical simulation of multiphase flow in heterogeneous
porous media. Computational Geosciences, v. 4, pp. 141–164, 2000.

[35] HUGHES, T. J. R. The finite element method. Prentice-Hall, Inc., New
Jersey, USA, 1987.

[36] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C. A variable timestep
strategy for accelerating the IMPES solution algorithm in reservoir si-
mulation. In XXVII Iberian Latin American Congress on Computational
Methods in Engineering – CILAMCE 2006, Belém, Brazil, 2006.

[37] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C. On the factors
influencing the grid orientation effect in reservoir simulation. In
19th International Congress of Mechanical Engineering – COBEM 2007 ,

Brasilia, Brazil, 2007.

[38] HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C., CORDAZZO,
J. A quadrilateral element-based finite-volume formulation for the



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 160

simulation of complex reservoirs. In X Latin American and Caribbean
Petroleum Engineering Conference – LACPEC 2007 , Buenos Aires, Argen-

tina, 2007.

[39] HUTCHINSON, B. R., RAITHBY, G. D. A multigrid method based on
the additive correction strategy. Numerical Heat Transfer, v. 9, pp. 511–
537, 1986.

[40] KAPLAN, M. A., POPETTI, R. A. A note on quadrilateral interpola-
tion. Journal of the Association for Computing Machinery, v. 18, n. 4,
pp. 576–585, 1971.

[41] KOZDON, J., MALLISON, B. T., GERRITSEN, M. G. Robust multi-D
transport schemes with reduced grid orientation effects. Transport in
Porous Media, v. 78, pp. 47–75, 2009.

[42] KUZMIN, D., MÖLLER, M. Algebraic flux correction I: Scalar con-
servation laws. In KUZMIN, D., LÖHNER, R., TUREK, S., editors, Flux-
corrected transport: Principles algorithms and applications. Springer-

Verlag, Berlin, Germany, 2005.

[43] KWOK, W., CHEN, Z. A simple and effective mesh quality metric for
hexaedral and wedge elements. In Proceedings of the 9th International
Meshing Roundtable, p. 325–333, New Orleans, USA, 2000.

[44] LEVEQUE, R. J. Finite volume methods for hyperbolic problems.
Cambridge University Press, Cambridge, UK, 2002.

[45] MALISKA, C. R. Transferência de calor e mecânica dos fluidos
computacional, segunda edição. LTC Editora S.A., Rio de Janeiro, Brasil,
2004.

[46] MALISKA, C. R., HURTADO, F. S. V., DONATTI, C. N., PESCADOR, A.
V. B., SILVA, A. F. C. Desenvolvimento da biblioteca ACMLib – Conclu-
são. Relatório técnico SIGER–4, parte 2, Laboratório SINMEC/UFSC,
Florianópolis, Brasil, 2009.

[47] MALISKA, C. R., HURTADO, F. S. V., DONATTI, C. N., PESCADOR, A.
V. B., SILVA, A. F. C. Desenvolvimento da biblioteca EFVLib – Conclu-
são. Relatório técnico SIGER–4, parte 1, Laboratório SINMEC/UFSC,
Florianópolis, Brasil, 2009.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 161

[48] MARCONDES, F. Solução numérica usando métodos adaptativos-
implícitos e malha de Voronoi de problemas de reservatórios de pe-
tróleo. Tese de doutorado, Departamento de Engenharia Mecânica,
Universidade Federal de Santa Catarina, Florianópolis, Brasil, 1996.

[49] MATTAX, C. C., DALTON, R. L. Reservoir simulation. Society of
Petroleum Engineers Inc., Richardson, USA, 1990.

[50] MATTHÄI, S. K., MAZENTEV, A., BELAYNEH, M. Control-volume
finite-element two-phase flow experiments with fractured rock repre-
sented by unstructured 3D hybrid meshes. In SPE Reservoir Simulation
Symposium, Houston, USA, 2005.

[51] MATTIUSSI, C. A reference discretization strategy for the numerical
solution of physical field problems. Advances in Imaging and Electron
Physics, v. 121, pp. 143–279, 2002.

[52] MIN, W. Generating hexahedron-dominant mesh based on shrink-
ing mapping method. In 6th International Meshing Roundtable, p. 171–
182, Park City, USA, 1997.

[53] MONTEAGUDO, J. E. P., FIROOZABADI, A. Control-volume model
for simulation of water injection in fractured media: Incorporating
matrix heterogeneity and reservoir wettability effects. SPE Journal, v.
September 2007, pp. 355–366, 2007.

[54] MORITA, N., SINGH, S. P., CHEN, H. S., WHITFILL, D. L. Three-
dimensional well model pre-processors for reservoir simulation with
horizontal and curved inclined wells. In 65th Annual Technical Confe-
rence and Exhibition of the SPE, New Orleans, USA, 1990.

[55] MOUTON, T., BENNIS, C., BOROUCHAKI, H. Hybrid mesh genera-
tion for reservoir flow simulation in CPG grids. In CLARK, B. W., editor,
Proceedings of the 18th International Meshing Roundtable, pp. 415–427.

Springer-Verlag, 2009.

[56] OUYANG, L. B., ARBABI, S., AZIZ, K. A single-phase wellbore-flow
model for horizontal, vertical, and slanted wells. SPE Journal, v. June
1998, pp. 124–133, 1998.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 162

[57] OWEN, J. O. A survey of unstructured mesh generation technology.
In 7th International Meshing Roundtable, Dearborn, USA, 1998.

[58] PALUSZNY, A., MATTHÄI, S. K., HOHMEYER, M. Hybrid finite
element-finite volume discretization of complex geologic structures
and a new simulation workflow demonstrated on fractured rocks.
Geofluids, v. 7, pp. 186–208, 2007.

[59] PATANKAR, S. V. Numerical heat transfer and fluid flow. Hemisphere
Publishing Corporation, New York, USA, 1980.

[60] PEACEMAN, D. W. Fundamentals of numerical reservoir simulation.
Elsevier Scientific Publishing Company, Amsterdam, The Netherlands,

1977.

[61] PEACEMAN, D. W. Interpretation of well-block pressures in nume-
rical reservoir simulation. SPE Journal, v. June 1978, pp. 183–194, 1978.

[62] PEACEMAN, D. W. Interpretation of well-block pressures in nume-
rical reservoir simulation with nonsquare grid blocks and anisotropic
permeability. SPE Journal, v. June 1983, pp. 531–543, 1983.

[63] PEACEMAN, D. W. Representation of a horizontal well in numerical
reservoir simulation. SPE Advanced Technology Series, v. 1, n. 1, pp. 7–
16, 1993.

[64] PEACEMAN, D. W. A new method for calculating well indexes
for multiple wellblocks with arbitrary rates in numerical reservoir
simulation. In SPE Reservoir Simulation Symposium, Houston, USA,
2003.

[65] PEDROSA, O. A., AZIZ, K. Use of a hybrid grid in reservoir simulation.
SPE Reservoir Engineering , v. November 1986, pp. 611–621, 1986.

[66] POTEMPA, T. Mobility weighting in numerical reservoir simulation.
SPE Journal, v. August 1985, pp. 565–572, 1985.

[67] RAW, M. A new control-volume based finite element procedure for
the numerical solution of the fluid flow and scalar transport equati-
ons. PhD Thesis, University of Waterloo, Canada, 1985.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 163

[68] REICHENBERGER, V., JAKOBS, H., BASTIAN, P., HELMIG, R. A mixed-
dimensional finite volume method for two-phase flow in fractured
porous media. Advances in Water Resources, v. 29, n. 7, pp. 1020–1036,
2006.

[69] ROE, P. L., SIDILKOVER, D. Optimum positive linear schemes for
advection in two and three dimensions. SIAM Journal of Numerical
Analysis, v. 29, n. 6, pp. 1542–1568, 1992.

[70] ROZON, B. J. A generalized finite volume discretization method for
reservoir simulation. In Reservoir Simulation Symposium, Houston,
USA, 1989.

[71] SAAD, Y. Iterative methods for sparse linear systems, second edition.
Society for Industrial and Applied Mathematics, Philadelphia, USA,

2003.

[72] SALARI, K., KNUPP, P. Code verification by the method of manu-
factured solutions. Technical report SAND2000–1444, Sandia National
Laboratories, Albuquerque, USA, 2000.

[73] SHAW, J. A. Hybrid grids. In THOMPSON, J. F., SONI, B. K.,
WEATHERILL, N. P., editors, Handbook of grid generation, ch. 23. CRC

Press, Boca Raton, USA, 1999.

[74] SHIMADA, K. Current trends and issues in automatic mesh gene-
ration. Computer-Aided Design &amp;amp; Applications, v. 3, n. 6, pp. 741–750,
2006.

[75] THOMPSON, J. F., SONI, B. K., WEATHERILL, N. P., editors. Handbook
of grid generation. CRC Press, Boca Raton, USA, 1999.

[76] TONTI, E. A direct discrete formulation for the wave equation.
Journal of Computational Acoustics, v. 9, n. 4, pp. 1355–1382, 2001.

[77] TONTI, E. A direct discrete formulation of field laws: the Cell
method. Computer Modeling in Engineering &amp;amp; Sciences, v. 2, n. 2,
pp. 237–258, 2001.

[78] VAN LEER, B. Upwind and high-resolution methods for compressi-
ble flow: from donor cell to residual-distribution schemes. Communi-
cations in Computational Physics, v. 1, n. 2, pp. 192–206, 2006.



R EFER ÊNCIA S BIB LIO GR ÁF ICA S 164

[79] VERMA, S. K. Flexible grids for reservoir simulation. PhD Disser-
tation, Department of Petroleum Engineering, Stanford University, Palo

Alto, USA, 1996.

[80] VINSOME, P. K., AU, A. D. K. One approach to the grid orientation
problem in reservoir simulation. In 54th Annual Fall Technical Confe-
rence and Exhibition of the SPE, Las Vegas, USA, 1979.

[81] WADA, Y., YOSHIMURA, S., YAGAWA, G. Automatic mesh generation
of hexahedral elements using intelligent local approach. Annual
report ADV 99–1, School of Engineering, University of Tokio, Japan, 1999.

[82] WEISSTEIN, E. W. Concise encyclopedia of mathematics. CRC Press,
Boca Raton, USA, 1999.

[83] ZGAINSKI, F. X., COULOMB, J. L., MARÉCHAL, Y., CLAEYSSEN, F.,
BRUNOTTE, X. A new family of finite elements: the pyramidal ele-
ments. IEEE Transactions on Magnetics, v. 32, n. 3, pp. 1393–1396, 1996.

[84] ZIENKIEWICZ, O. C., TAYLOR, R. L. The finite element method,
Volume 1: the basis, fifth edition. Butterworth-Heinemann, Oxford, UK,
2000.

[85] ZOPPOU, C., ROBERTS, S. Behaviour of finite difference solution
of the advection equation. Technical report MRR 062–96, School
of Mathematical Sciences, Australian National University, Camberra,

Australia, 1996.



APÊNDICE

A
Parâmetros geométricos

A.1 Determinação do vetor área de face
Um dos parâmetros geométricos mais importantes em um método de vo-

lumes finitos é a área das faces que limitam os volumes de controle. No

método de volumes finitos baseado em elementos considerado, as faces

são quadriláteros ou triângulos localizados no interior dos elementos. A

seguir é descrito o procedimento para a determinação do vetor área das

faces quadrilaterais.

A figura A.1(a) mostra uma face quadrangular convexa, cujos vértices

C, L, M e R podem ser não-coplanares no espaço físico. A face pode ser

mapeada em um quadrado unitário plano, mostrado na figura A.1(b), me-

diante a transformação de coordenadas
?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

?

x =
4
?

k=1

Nk (?,?) x k ,

y =
4
?

k=1

Nk (?,?) yk ,

z =
4
?

k=1

Nk (?,?) z k .

(A.1)

165



PA R Â M ET RO S G EO M ÉT R ICO S 166

C

C

L

L
R

R

M

M
Face f

(a) (b)
z

x y
Figura A.1 – Transformação de coordenadas para o cômputo do vetor área

de uma face quadrangular.

Na transformação da equação (A.1) são consideradas as funções de

forma bilineares
?

?

?

?

?

?

?

?

?

N1(?,?) = (1??) (1??),

N2(?,?) = ? (1??),

N3(?,?) = ??,

N4(?,?) = (1??)?.

(A.2)

Além disso, na equação (A.1), x k , yk e z k , k ? {1, 2, 3, 4}, são as coor-
denadas dos vértices da face no espaço físico. Convencionalmente, ape-

nas para uso na equação (A.1), considera-se a seguinte equivalência entre

a numeração dos vértices e a notação indicada para eles na figura A.1:

{C, L, M, R} ? {1, 2, 3, 4}. Para a orientação absoluta do vetor área de face
coincidir com a orientação da aresta associada, como definido na seção

3.4.2, os vértices da face devem ser ordenados de acordo a regra da mão di-

reita. Isto é, quando o polegar da mão direita apontar no sentido atribuído

à aresta, os outros dedos indicarão o sentido na ordenação dos vértices.

Considerando a transformação bilinear definida, o vetor área de face

pode ser determinado mediante integração no plano transformado, em-

pregando a expressão seguinte [82]

?Sf =

? 1

0

? 1

0

??r ×??r d? d?, (A.3)

em que r = x ux + y uy + z uz é o vetor posição de um ponto pertencente
ao quadrilátero, no espaço físico. Os vetores ??r e ??r são tangentes à su-



PA R Â M ET RO S G EO M ÉT R ICO S 167

perfície da face no ponto correspondente e, portanto, ??r ×??r é um vetor
normal à face. Além disso, o módulo desse produto é um fator de escala

entre as áreas de elementos diferenciais sobre a superfície, no espaço físico

e no plano transformado.

Realizando a integração indicada na equação (A.3), obtém-se a se-

guinte expressão para o cômputo do vetor área de uma face

?Sf =
1
2

?

(y C ?y M)(z L ?z R)?(y L ?y R)(z C ?z M)
?

ux +
1
2
[(z C ?z M)(x L ?x R)?(z L ?z R)(x C ?x M)]uy +

1
2

?

(x C ?x M)(y L ?y R)?(x L ?x R)(y C ?y M)
?

uz .

(A.4)

Esta expressão é válida para quadriláteros planos e não-planos. O

módulo do vetor é numericamente igual à área do quadrilátero definido

pelos quatro vértices. No caso dos vértices não se encontrarem em um

mesmo plano, a área corresponde a uma porção do hiperboloide de uma

folha [40], definido pela transformação bilinear (A.1). Para uma face plana,
?Sf é perpendicular ao plano da face. Para uma face não-plana, a direção
de ?Sf é a direção média das normais à superfície da face.

É interessante notar que a equação (A.4) pode ser escrita na forma

compacta
?Sf =

1
2

??
CM×??LR . (A.5)

onde
??
CM e

??
LR são vetores coincidentes com as diagonais da face quadran-

gular.

Outro fato a destacar é que a aproximação numérica da integral da

equação (A.3) pela quadratura de Gauss [84] com um único ponto, isto é,
? 1

0

? 1

0

??r ×??r d? d? ?
?

??r ×??r
?

?= 1
2

,?= 1
2

, (A.6)

conduz à expressão exata para o vetor ?Sf , dada na equação (A.4). A
quadratura de Gauss de um ponto é equivalente à regra do ponto médio

[20], mencionada na seção 3.4.2.
A equação (A.4) pode ser empregada em todas as faces quadrangula-

res, inclusive as da pirâmide.1 Já o vetor área para as faces triangulares

desse elemento pode ser determinado mediante o método convencional

1 Para manter consistência com a notação empregada na seção 3.4.2, para as faces da
pirâmide o índice C deve ser substituído pelo índice B na equação (A.4).



PA R Â M ET RO S G EO M ÉT R ICO S 168

do cálculo da área de um triângulo em três dimensões. Assim, para a face

triangular de vértices B, L e M, o vetor área pode ser determinado pela

expressão

?Sf =
1
2

??
BL×??BM. (A.7)

onde
??
BL e

??
BM são vetores coincidentes com dois lados da face triangular.

A.2 Baricentro das faces

Na seção 3.4.2 foi vista a aproximação numérica de integrais de superfície.

Uma integral desse tipo, restrita à superfície de em uma face, pode ser ex-

pressa também considerando a transformação bilinear definida na seção

anterior. Dessa forma resulta

?

f

? · dS =
? 1

0

? 1

0

? · (??r ×??r) d? d?. (A.8)

O lado direito da equação pode ser aproximado por uma quadratura

de Gauss de um ponto, com o qual obtém-se

?

f

? · dS ?
h

? · (??r ×??r)
i

?= 1
2

,?= 1
2

. (A.9)

Como mencionado na seção anterior, a avaliação do produto ??r ×??r
no ponto médio de uma face quadrilateral conduz a expressão exata para

o vetor área. Logo, pode-se escrever

?

f

? · dS ? ?
?

?

?= 1
2

,?= 1
2
·?Sf . (A.10)

Consequentemente, a densidade de fluxo ? deve ser avaliada no ponto
cujas coordenadas no plano transformado são ? = 1

2
e ?= 1

2
. Esse ponto

é o baricentro dos vértices da face, cuja posição no espaço físico é dada

pela média aritmética das coordenadas dos vértices da face. A menos que

a face seja um retângulo, a posição do baricentro dos vértices será diferente

da posição do baricentro da própria superfície da face. Entretanto, já que,

pelos argumentos prévios, a aproximação numérica de uma integral na

face requer avaliar o integrando sempre no baricentro dos vértices da face,



PA R Â M ET RO S G EO M ÉT R ICO S 169

por simplicidade, esse ponto sempre é referido neste trabalho como bari-

centro da face e denotado como ?f . As figuras A.2, A.3, A.4 e A.5 apresen-
tam as coordenadas que determinam a posição do baricentro das faces do

tetraedro, do hexaedro, do prisma e da pirâmide, respectivamente. Essas

coordenadas estão referidas ao sistema local definido em cada elemento.

1 17/48 7/48 7/482 17/48 17/48 7/483 7/48 17/48 7/484 7/48 7/48 17/485 7/48 17/48 17/486 17/48 7/48 17/48
Face

2
31

4
5 6

Figura A.2 – Coordenadas locais dos baricentros das faces do tetraedro.

1 1/2 1/4 1/42 3/4 1/2 1/43 1/2 3/4 1/44 1/4 1/2 1/45 1/2 1/4 3/46 3/4 1/2 3/47 1/2 3/4 3/48 1/4 1/2 3/49 1/4 1/4 1/210 3/4 1/4 1/211 3/4 3/4 1/212 1/4 3/4 1/2

Face

2 3

9
110 4
5

6
11

127
8

Figura A.3 – Coordenadas locais dos baricentros das faces do hexaedro.



PA R Â M ET RO S G EO M ÉT R ICO S 170

1 5/12 1/6 1/42 5/12 5/12 1/43 1/6 5/12 1/44 5/12 1/6 3/45 5/12 5/12 3/46 1/6 5/12 3/47 5/24 5/24 1/28 7/12 5/24 1/29 5/24 7/12 1/2

Face

7

2
3

9
1

4 5 6

8

Figura A.4 – Coordenadas locais dos baricentros das faces do prisma.

1 1/2 2/9 1/92 7/9 1/2 1/93 1/2 7/9 1/94 2/9 1/2 1/95 17/48 17/48 7/246 31/48 17/48 7/247 17/48 31/48 7/248 31/48 31/48 7/24

Face
7

2 3
1 4

5
6 8

Figura A.5 – Coordenadas locais dos baricentros das faces da pirâmide.

A.3 Cômputo do volume de um subelemento
Conforme visto na seção 3.4.1, o volume de um subelemento pode ser

determinado mediante integração no espaço transformado, empregando

a expressão

?Vs =

?

s

|J| dV ??? . (A.11)

Neste trabalho, o valor da integral foi computado por uma quadratura

de Gauss de um ponto, isto é

?Vs ? |J|?s ?V
???

s , (A.12)



PA R Â M ET RO S G EO M ÉT R ICO S 171

em que?s é o baricentro dos vértices do subelemento e ?V
???

s é seu volume

no espaço transformado. A equação (A.12) fornece um valor exato para os

subelementos do tetraedro e aproximado para outros elementos.

Para utilização na equação (A.12), as coordenadas locais dos baricen-

tros dos subelementos, além dos volumes no espaço transformado, são

indicados nas figuras A.6, A.7, A.8 e A.9, respectivamente, para o tetraedro,

o hexaedro, o prisma e a pirâmide.

1 17/96 17/96 17/96 1/242 15/32 17/96 17/96 1/243 17/96 15/32 17/96 1/244 17/96 17/96 15/32 1/24
Subel.

2 31
4

Figura A.6 – Coordenadas locais dos baricentros e volume dos subelemen-
tos do tetraedro.

1 1/4 1/4 1/4 1/82 3/4 1/4 1/4 1/83 3/4 3/4 1/4 1/84 1/4 3/4 1/4 1/85 1/4 1/4 3/4 1/86 3/4 1/4 3/4 1/87 3/4 3/4 3/4 1/88 1/4 3/4 3/4 1/8

Subel.

2 3
1 4

5
6 7

8

Figura A.7 – Coordenadas locais dos baricentros e volume dos subelemen-
tos do hexaedro.



PA R Â M ET RO S G EO M ÉT R ICO S 172

2 3
1
4

5 6 1 5/24 5/24 1/4 1/122 11/24 5/24 1/4 1/123 5/24 11/24 1/4 1/124 5/24 5/24 3/4 1/125 11/24 5/24 3/4 1/126 5/24 11/24 3/4 1/12

Subel.

Figura A.8 – Coordenadas locais dos baricentros e volume dos subelemen-
tos do prisma.

2 3
4

5 1 29/96 29/96 7/48 1/182 67/96 29/96 7/48 1/183 67/96 67/96 7/48 1/184 29/96 67/96 7/48 1/185 1/2 1/2 13/24 1/9

Subel.

1

Figura A.9 – Coordenadas locais dos baricentros e volume dos subelemen-
tos da pirâmide.


</field>
	</doc>
</add>