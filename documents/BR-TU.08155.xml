<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08155</field>
		<field name="filename">12949_001091705.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UFRGS
UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL
UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL
ESCOLA DE ENGENHARIA
DEPARTAMENTO DE ENGENHARIA QUÍMICA
ENG07053 - TRABALHO DE DIPLOMAÇÃO EM ENGENHARIA QUÍMICA
A
dEQui
DEPARTAMENTO DE ENGENHARIA QUÍMICA
Análise de Séries Temporais: Comparação entre modelos preditivos em estudo de caso
Autor: Thomaz Ochoa Favarini
Orientador: Jorge O. Trierweiler
Porto Alegre, dezembro de 18
Agradecimentos
Registro meus agradecimentos aos meus pais, Paulo Eduardo Reus Favarini e Mariza Ochoa Favarini por terem me transmitido seus valores e me concedido as oportunidades necessárias para a conclusão do curso de Engenharia Química na Universidade Federal do Rio Grande do Sul
Agradeço à UFRGS, que me acolheu e abriu as portas para que eu pudesse ter uma educação de excelência.
Registro meu reconhecimento ao orientador Prof. Dr. Jorge O. Trierweiler pelo auxílio na busca de meus objetivos e por me guiar durante a elaboração deste trabalho.
À Alina da Cunha El Jundi por seu companheirismo e compreensão ao longo da jornada acadêmica e profissional.
Por fim, agradeço às minhas avós Claire e Jacira, por todos os exemplos fornecidos ao longo dos anos e pela confiança em mim depositada.
Resumo
A grande disponibilidade de dados disponíveis permite aos mais diversos setores da economia obter maior volume de informação sobre os seus processos. Dentro deste contexto, a análise de séries temporais possibilita aos mesmos uma maneira de aproveitar esta disponibilidade de informação de maneira mais eficiente, criando modelos que permitem maximizar o entendimento em relação às séries temporais e ainda estabelecer relações que permitam inferir o comportamento futuro acerca de determinado conjunto de dados. Este trabalho, abordou metodologias que utilizam somente variáveis endógenas para representar as características determinísticas de uma série temporal e desta forma obter melhor conhecimento acerca do comportamento dos dados e realizar simulações preditivas. Para tanto foram utilizadas as metodologias SARIMA, Decomposição da série temporal, e Suavização exponencial. Estas técnicas foram aplicadas a três séries temporais: Evolução da concentração de CO2 na atmosfera; Evolução da variação de pressão em um adsorvedor de umidade de poço de petróleo offshore; Evolução da cotação da ação BRKM3. Através de comparação entre as previsões realizadas por cada um dos modelos pode-se verificar que a natureza dos processos geradores do conjunto de dados tem grande influência na capacidade preditiva dos modelos, sendo a série da evolução da concentração de CO2 na atmosfera a que obteve melhor predição do comportamento dos dados originais, apresentando R2 = 0,98. Quanto às metodologias de previsão, aquela que possuiu melhor desempenho para representar os comportamentos das três séries temporais estudas foram os modelos SARIMA.
Palavras-chave: Séries temporais. SARIMA. Suavização exponencial.
Lista de Ilustrações
Figura 1 - Metodologia utilizada para elaborar as previsões das séries temporais .......................................................................12
Figura 2 - Método B, aplicado na realização de forecast via decomposição das séries temporais.......................................................13
Figura 3- Método A, aplicado na realização de forecast via decomposição das séries temporais.......................................................13
Figura 4 - Evolução da concentração de CO2 em ppm de 1974 a 1985... 21
Figura 5 - Autocorrelação e autocorrelação parcial da evolução da concentração de CO2.................................................................21
Figura 6 - Comparação da concentração de CO2 Medida (linha azul) com a concentração prevista com o modelo obtido através da metodologia A (linha laranja)...............................................................22
Figura 7 - Autocorrelação e autocorrelação parcial dos resíduos gerados pelo método A...............................................................23
Figura 8 - Comparação da concentração de CO2 Medida em ppm (linha azul) com a concentração prevista com o modelo SARIMA(2,1,0)(0,1,1,12) (linha laranja). .......................................................................24
Figura 9 - Autocorrelação e autocorrelação parcial dos resíduos do modelo gerado pelo modelo SARIMA(2,1,0)(0,1,1,12).............................24
Figura 10 - Comparação da concentração em ppm de CO2 Medida (linha azul) com a concentração prevista pelo modelo de suavização exponencial (linha laranja)...............................................................25
Figura 11 - Autocorrelação e autocorrelação parcial dos resíduos do modelo gerado pelo modelo de suavização exponencial tripla....................26
Figura 12 - Evolução da diferença de pressão em adsorvedor com amostras de intervalo de 10 minutos................................................27
Figura 13 - Autocorrelação e autocorrelação parcial do delta P até o lag 50.. 28
Figura 14 - Comportamento sazonal da série temporal identificado pela Transformada Rápida de Fourier utilizando 10 harmônicas..................29
Figura 15 - Comparação da diferença de pressão medida (linha azul) do conjunto de teste com a diferença de pressão prevista pela utilização do método B de decomposição (linha laranja)......................................... 29
Figura 16 - Autocorrelação e autocorrelação parcial do delta P dos resíduos até o lag 50.29
Figura 17 - Histograma dos resíduos indicando que estes não seguem distribuição normal em torno de 0........................................30
Figura 18 - Comparação da diferença de pressão medida (linha azul) do conjunto de teste com a diferença de pressão prevista pela utilização do modelo SARIMA (2,0,1)(0,1,0,25) (linha laranja).................................31
Figura 19 - Autocorrelação e autocorrelação parcial dos resíduos gerado pelo modelo de SARIMA (2,0,1)(0,1,0,25) na base de treino.....................31
Figura 20 - Figura evidenciando a variação dos coeficientes AR1, AR2 e MA1 nas 60 simulações realizadas.............................................32
Figura 21 - Evolução da cotação da BRKM3 em intervalo diário minutos, conjunto de treino.......................................................33
Figura 22 -Autocorrelação e autocorrelação parcial do preço da ação até o lag 50.......................................................................33
Figura 23 - Comparação da cotação medida (linha azul) do conjunto de treino com a cotação prevista pelo modelo ARIMA (2,1,3) (linha laranja).........35
Figura 24 - Comparação da cotação medida (linha azul) do conjunto de treino com a cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja)........35
Figura 25 - Autocorrelação e autocorrelação parcial dos resíduos do modelo até o lag 50.................................................................36
Figura 26 - Comparação de 7 dias da cotação medida do conjunto de teste (linha azul) com a cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja) . 37
Figura 27 - Comparação entre a primeira derivada do modelo preditivo ARIMA(29,1,9) e a primeira derivada da ação do conjunto de teste.........37
Figura 28 - Comparação de 53 dias da cotação medida do conjunto de teste (linha azul) com a cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja). 38
Figura 29 - Comparação da cotação do conjunto de teste (linha azul) com a cotação prevista pelo modelo de suavização exponencial dupla (linha laranja). . 39
Lista de Tabelas
Tabela 1: Valores médios determinados para cada unidade de tempo do ciclo de 12 meses.........................................................22
Tabela 2	- Valores determinados dos coeficientes do modelo
SARIMA(2,1,0)(0,1,1,12).............................................23
Tabela 3 - Coeficientes determinados para o método da exponenciação tripla
....................................................................25
Tabela 4 - Representação do range utilizado na otimização do AIC....30
Tabela 5	- Valores determinados das constantes do modelo
SARIMA(2,0,1)(0,1,0,25)................................................31
Tabela 6 - Representação do range utilizado na otimização do AIC....34
Tabela 7 - Valores determinados dos coeficientes do modelo ARIMA (29,1,9).
.....................................................................36
Tabela 8 - Coeficientes determinados pelo método da exponenciação dupla.38
Lista de Símbolos
Lista de Símbolos séries temporais
xt : Valor observado na série temporal no instante t
Tt : Estimador da tendência da série temporal no instante t
St : Estimador da sazonalidade da série temporal no instante t
Ct : Estimador do componente cíclico da série temporal no instante t
Et : Estimador dos resíduos da série temporal no instante t
Bm : Parâmetro do ajuste polinomial de ordem m
Estimador médio de tendência de ordem g no instante t
Xt-k: Valor observado na série temporal no instante t - k
Wt-k: Parâmetro ponderador do instante t - k
xtj : Valor observado na série temporal no ciclo í e posição j
Tij : Estimador de tendência da série temporal no ciclo í e posição j
Stj : Estimador de sazonalidade da série temporal no ciclo í e posição j
Etj : Estimador dos resíduos da série temporal no ciclo í e posição j
m : É o total de observações em um ciclo completo, é o período da sazonalidade aj : É o parâmetro obtido pelo método de regressão para a posição j dtj : Conjunto de variáveis periódicas (Seno, cosseno)
k : Frequência do sinal periódico, onde: 0 &amp;lt;k &amp;lt;N - 1
N: Total de observações na amostra
Lista de símbolos Processos Estacionários
h : número de defasagens da série temporal
ph: Autocorrelação defasada em h instantes, onde: -1 &amp;lt;ph &amp;lt;1
g : Média da amostra
ah: autocorrelação parcial defasada h instantes, onde:-1&amp;lt;ah&lt;1
a2 : Variância característica de um ruído branco
x( : Primeira diferenciação da série temporal
R2: Coeficiente de determinação
xt_m: Variável x no instante t - m
Lista de Símbolos Decomposição de séries temporais
I: Total de ciclos que uma posição j participou
Lista de Símbolos Suavização exponencial
a: Fator de suavização
Ft: Previsão da série temporal para o instante t
Xt+1: Previsão da série temporal para o instante t + 1
ft: Fator de suavização da tendência
y: Fator de suavização da sazonalidade
Lista de Símbolos Modelos ARIMA e SARIMA
0p: Coeficiente autoregressivo de ordem p
0q: Coeficiente de médias móveis de ordem q
Xt: Previsão da série temporal para o instante t
k: Intercepção média
Adx: Série temporal diferenciada d vezes
&amp;amp;SD :Série temporal diferenciada D vezes sazonalmente Ôq : Coeficiente de médias móveis sazonal de ordem P 0P: Coeficiente autorregressivo sazonal de ordem Q cf2: Variância residual
yt: Dados originais
yt: Valor médio do conjunto de dados originais
yt: Valores gerados pelo modelo
k: Número total de parâmetros a serem estimados
T: Número total de parâmetros a serem estimados
Lista de Abreviaturas e Siglas
ADF -Augmented Dickey-Fuller
AIC - Akaike's Information Criterion
AR - Autoregressive
ARIMA - Autoregressive Integrated Moving Average
ARMA - Autoregressive Moving Average
Corr - Correlação
DFT - Discrete Fourier Transform
FFT - Fast Fourier Transform
I	- Integrated
LSE - Least Squares Estimation
MA - Moving Average
MIN - Minimize function
SARIMA - Seasonal Autoregressive Integrated Moving Average
SSE - Sum Squared Error
Sumário
Agradecimentos	ii
Resumo	iii
Lista de Ilustrações	iv
Lista de Tabelas	vii
Lista de Símbolos	viii
Lista de Abreviaturas e Siglas	xi
Sumário	xii
1	Introdução	1
2	Revisão Bibliográfica	3
2.1	Tendência	3
2.1.1	Tendência polinomial	4
2.1.2	Suavização	4
2.1.2.1	Média móvel (MA)	4
2.1.2.2	Média móvel ponderada (WMA).	5
2.2	Sazonalidade	6
2.2.1	Método de regressão	6
2.2.2	Transformada rápida de Fourier	7
2.3	Processos estacionários	7
2.3.1	Outros métodos de estacionarização	9
2.3.1.1	Diferenciação	9
2.3.1.2	Diferenciação sazonal	9
3	Metodologia	11
3.1	Pré-tratamento das séries temporais	11
3.2	Visualizar as séries temporais	12
3.3	Definir e aplicar modelos de previsão	12
3.3.1	Decomposição de séries temporais	12
3.3.1.1	Método A	13
3.3.1.2	Método B	14
3.3.2	Suavização exponencial	14
3.3.2.1	Suavização exponencial simples.	15
3.3.2.2	Suavização exponencial de Holt	15
3.3.2.3	Suavização exponencial tripla	16
3.3.3	Modelos ARIMA e SARIMA	16
3.3.3.1	Modelos autoregressivos	16
3.3.3.2	Modelos de média móvel	17
3.3.3.3	Modelos autoregressivos e de média móvel ARMA17
3.3.3.4	Modelos ARIMA	17
3.3.3.5	Modelos SARIMA	18
3.4	Critérios de avaliação dos resultados obtidos	18
4	Estudo de Caso	20
4.1	Evolução da concentração de CO2	20
4.1.1	Pré-tratamento da série temporal	20
4.1.2	Visualizar a série temporal	21
4.1.3	Definir e aplicar modelos de previsão	21
4.1.3.1	Decomposição da série temporal, Método A	22
4.1.3.2	SARIMA	23
4.1.3.3	Suavização exponencial tripla	25
4.1.4	Avaliar resultados obtidos	26
4.1.5	Previsões de longo prazo	26
4.2	Diferença de pressão em um adsorvedor	27
4.2.1	Pré-tratamento da série temporal	27
4.2.2	Visualizar a série temporal	27
4.2.3	Definir e aplicar modelos de previsão	28
4.2.3.1	Decomposição da série temporal, Método B	28
4.2.3.2	SARIMA	30
4.2.4	Avaliar resultados obtidos	32
4.2.5	Avaliação da dinâmica da série temporal	32
4.3	Evolução	da	cotação	da ação	BRKM3	32
4.3.1	Pré-tratamento da série temporal	32
4.3.2	Visualizar a série temporal	33
4.3.3	Definir e aplicar modelos de previsão	34
4.3.3.1	SARIMA	34
4.3.3.2	Suavização exponencial dupla	38
4.3.4	Avaliar resultados obtidos	39
5	Conclusões	e Sugestões para Trabalhos Futuros	40
Referências	42
Apêndice A	44
1	Introdução
Uma série temporal pode ser definida como a sequência de observações sucessivas tomadas ao longo do tempo (BOX; JENKINS; REINSEL, 2008) estas séries são encontradas nas mais variadas áreas como na engenharia, medicina, negócios, economia e ciências sociais, alguns exemplos de observações no tempo são: medição da pressão encontrada em poços de petróleo offshore tomada de hora em hora, apurações mensais das temperaturas médias de Porto Alegre, vendas mensais de petróleo, índices diários da bolsa de valores e assim sucessivamente.
A análise das séries temporais, por sua vez, também possui importantes aplicações que se estendem em todos os setores onde há a ocorrência das séries temporais. Alguns dos objetivos destas análises podem ser: Investigar o mecanismo gerador da série temporal; obter melhor entendimento sobre o comportamento da série; estimar funções de transferência (relacionando entradas e saídas), analisar os efeitos de eventos não usuais em um sistema; controle de processos; e realizar previsões dos valores futuros das séries temporais (BOX; JENKINS; REINSEL, 2008), que é o foco do presente trabalho.
Em um cenário altamente competitivo a busca pelo aumento de eficiência e produtividade é fundamental para a sobrevivência das organizações. Um dos meios para atuar neste quesito é entender de maneira mais clara quais serão os eventos futuros aos quais a empresa ou os setores estarão submetidos e, de posse deste conhecimento, agir de maneira antecipava para obter o melhor aproveitamento. Isto é valido para inúmeras situações, por exemplo: decidir o melhor período para realizar a substituição/otimização de um equipamento; aumentar ou diminuir a utilização da capacidade produtiva fabril; otimizar estoques; decidir qual o melhor momento para adquirir ou vender um ativo; obter melhor entendimento dos fenômenos, interpretando situações que diferem da prevista; entre outras.
A realização de previsões em relação a eventos futuros das séries temporais utiliza a característica de dependência entre as sucessivas observações ao longo do tempo (BOX; JENKINS; REINSEL, 2008). Deste modo, o conhecimento da estrutura internas das séries temporais e o estabelecimento de técnicas para capturar e entender esta dependência são fundamentais.
Este trabalho tem como objetivo comparar três métodos de previsão de séries temporais, utilizando somente variáveis endógenas, em três conjuntos de dados distintos. A avaliação da qualidade do modelo será feita visualmente pela comparação gráfica dos valores previstos pelos realizados, quantitativamente através do indicador do coeficiente de determinação e realizando avaliação dos resíduos, por meio da utilização do teste Aumented Dickey Fuler e das funções de autocorrelação e autocorrelação parcial para verificar se os resíduos seguem modelo estacionário.
A estrutura do texto é dividida em seis capítulos: o Capítulo 1 é a introdução, que apresenta a definição de série temporal, as motivações e os objetivos do trabalho; O Capítulos 2 aborda revisão bibliográfica, o tema central é a representação e identificação dos componentes de uma série temporal; o Capítulo 3 aborda as metodologias utilizadas para realizar a previsão de séries temporais; no Capítulo 4 são apresentadas e analisadas as séries temporais e o resultado dos modelos é avaliado. No Capítulo 5 são sintetizadas as principais conclusões do trabalho e são feitas recomendações para a realização de trabalhos futuros.
2	Revisão Bibliográfica
Uma série temporal é composta por uma ou mais das seguintes estruturas internas:
= Tt + St + Ct + Et
•	Tendência (Tt): é o movimento de aumento ou diminuição da variável observada ao longo do tempo.
•	Sazonalidade (St): são movimentos periódicos e repetitivos presentes em uma série temporal.
•	Componente cíclico (Ct): são movimentos periódicos menos frequentes que a sazonalidade e podem não apresentar um período de variação fixo (PAL; PRAKASH, 2017).
•	Resíduos (Et): Este componente não é dependente do tempo e representa a porção irredutível da função que o modelo não consegue contabilizar (PAL; PRAKASH, 2017) segundo BROCKWELL e DAVIS (1996), este resíduo deve se comportar conforme um ruído branco.
Onde xt representa a variável x no instante de tempo t.
2.1	Tendência
Tendência é o movimento de incremento ou decréscimo do valor da função ao longo do tempo. Esta característica das séries temporais pode ser percebida analisando visualmente os dados através de um gráfico da variável observada em função do tempo (PAL; PRAKASH, 2017). Como uma definição quantitativa, pode-se definir a tendência como sendo a mudança de longo prazo na média da função temporal (CHATFIELD, 2000).
Há vários métodos para realizar a estimação da função de tendência Tt (MORETTIN; TOLOI, 2006) e estes se dividem em dois grupos principais:
•	Regressão paramétrica: Ajustar uma série temporal utilizando uma função descrita utilizando parâmetros finitos. Como uma função polinomial, exponencial modelos ARMA, ARIMA e SARIMA.
•	Regressão não paramétrica: Neste tipo de regressão não é necessário realizar estimativa de parâmetros para realizar a regressão. São exemplos dessa classe a média móvel, Regressão kernel, regressão polinomial local, regressão splines, wavelet, entre outras.
Neste trabalho a tendência será estimada utilizando os seguintes métodos:
•
Polinomial;
• Média móvel;
• Média móvel ponderada.
2.1.1	Tendência polinomial
Ao realizar uma estimação por tendência polinomial, o objetivo é modelar a série temporal utilizando um polinómio que terá seus coeficientes determinados através do ajuste por mínimos quadrados (LSE). Desta forma, é identificado o polinómio que melhor se adequa aos dados que estão sendo utilizados (BROCKWELL; DAVIS, 1996).
LSE = MIN
n
- W
t=1
2
Tt = Bo+ Bit + —F Bmtm
Onde Bm é o parâmetro de ordem m determinado por LSE.
2.1.2	Suavização
Ao representar a tendência por um polinómio são utilizadas todas as observações para elaborar a função que representará a tendência durante todo o intervalo de tempo. Uma outra alternativa consiste na utilização apenas de um conjunto de dados próximos, dentro de uma janela menor de dados. A ideia é que em um instante t a tendência será estimada usando-se as observações Zs ao redor de t (MORETTIN; TOLOI, 2006). Enquadram-se nessa categoria os métodos de Média Móvel (“moving average”, MA) e Média Móvel Ponderada (“weighted moving average”, WMA), os quais serão apresentados nas próximas subseções.
2.1.2.1	Média móvel (MA)
A realização da média móvel tem como efeito suavizar a série temporal, reduzindo o seu ruído.
T(g)t =	Xt-k + Xt-k+1 1	+Xt + Xt+k-1 + Xt+k 2k+ 1
Onde a tendência média é representada por T(g)t, o intervalo considerado é t ± k e k equivale ao alcance da média. A ordem da média móvel é calculada como g = 2k + 1.
A ordem da média móvel pode ser ímpar (simétrica) ou par (assimétrica), para tornar a série simétrica é necessário realizar a média duas vezes.
r(2)t =	_xt-1 + xt ’ 2
, V f(2) -	_ 1	+ 2Xt + Xt+1
' 2 2( 2
É importante apontar que a repetição da média móvel causa uma ponderação, aumentando o peso dos valores mais recentes (Xt)(PAL; PRAKASH, 2017). Em séries onde a sazonalidade é presente para eliminá-la basta considerar o período da sazonalidade na ordem e repetição da média móvel, ou seja, para dados com sazonalidade anual a remoção da sazonalidade é feita realizando a seguinte média móvel 2%Tt	, em dados com sazonalidade semanal a remoção dessa sazonalidade
(7)
é realizada com a média Tt .
2.1.2.2	Média móvel ponderada (WMA).
Segundo PAL e PRAKASH (2017) pode-se optar por utilizar a média móvel ponderada uma vez que esta suaviza a série temporal considerando maior peso para os dados mais próximos do valor calculado.
Representação matemática da média móvel ponderada:
T = Xt-kWt-k + Xt-k+1Wt-k+1 +---+XtWt + Xt+k-iWt+K-1 + Xt+kWt+K
Onde:
Wt-fc + Wf-fc+1 +-+	+ ^t+K-1 + Wf+K = 1
Apesar da média móvel e a média móvel ponderada serem boas ferramentas para visualizar e identificar a tendência de maneira mais clara, segundo BROCKWELL e
DAVIS (1996) elas não são úteis para elaboração de modelos preditivos uma vez que elas levam em consideração tantos valores passados quanto futuros.
2.2	Sazonalidade
Sazonalidade refere-se a movimentos periódicos repetitivos presentes em séries temporais e que podem ser modelados como a soma de ondas senoidais de período conhecido. Uma característica das séries sazonais é a alta autocorrelação que estas apresentam em lags sazonais, isto é, em lags múltiplos do período m. Um bom procedimento de captura da sazonalidade deve ser capaz de remover grande parte desta correlação (MORETTIN; TOLOI, 2006).
Uma série temporal pode ser representada da seguinte forma:
xij = T[j + Sij + Eij
Onde os índices í e j representam a quantidade de ciclos e a posição dentro de um ciclo respectivamente. Se o padrão sazonal não variar muito ao longo dos anos, a equação é simplificada para:
Dentre os métodos utilizados para estimar a sazonalidade, deve-se citar o método de regressão, o método das médias móveis e o da transformada rápida de Fourier.
Neste trabalho será abordado o método de regressão e o da transformada rápida de Fourier.
2.2.1	Método de regressão
Estes modelos são utilizados quando a periodicidade da sazonalidade é conhecida, ou seja, nas séries às quais devido ao seu comportamento constante da sazonalidade, permitem prever a sazonalidade com base nos meses anteriores (MORETTIN; TOLOI, 2006).
Considerando que a série não apresente componente de tendência:
m
jdjt
j=1
Onde djt são as variáveis periódicas (senos, cossenos ou variáveis sazonais).
Como foi considerada sazonalidade constante, aj independe de t. Desta maneira,
temos que, para t correspondente a uma posição específica j dentro do ciclo, djt é igual a 1 e 0 caso contrário.
Dessa maneira, utilizando o método dos mínimos quadrados é possível determinar o vetor dos m valores de a (MORETTIN; TOLOI, 2006), onde m representa o total de observações dentro de um ciclo completo.
2.2.2	Transformada rápida de Fourier
Esta metodologia é baseada na possibilidade do componente sazonal poder ser representado como um sinal periódico em um tempo discreto e com a utilização de uma série de Fourier converter em uma combinação linear de harmônicos de uma dada frequência fundamental (MARTELOTTE, 2014).
Para calcular a transformada discreta de Fourier é utilizada a seguinte equação:
N
Onde k representa a frequência de 0 a N - 1, n é o índice de tempo,N representa o número de observações na amostra DFT(x) é a transformada discreta de Fourier (DOWNEY, 2016).
Neste trabalho, a transformada de Fourier será calculada através do algoritmo da Transformada Rápida de Fourier, o qual reduz significativa o tempo para computar conversões do domínio do tempo para da frequência (STREMLER, 1990, apud LEWIS; HERBERT; BELL, 2003).
2.3	Processos estacionários
Se uma série temporal pode ser prevista exatamente pelos valores passados, esta é classificada como determinística. No entanto, na maioria dos casos, a maior parte das séries temporais apresentam uma parcela significativa com características estocásticas, e nestas somente parte do futuro é determinado pelos valores passados (CHATFIELD, 2000).
Ao representar uma série temporal pela adição das parcelas determinísticas, através das funções dos componentes internos (tendência, sazonalidade, componente cíclico), e subtrair estes componentes das observações medidas, é obtido resíduo não nulo devido às características estocásticas da série temporal.
Deste modo, um bom modelo de previsão deve ser capaz de gerar um resíduo que se comporte como uma sequência de variáveis aleatórias não correlacionadas, com média zero e variância a2. Este tipo de sequência temporal é conhecido como ruído branco (BROCKWELL; DAVIS, 1996), veremos no próximo parágrafo que o ruído branco devido à sua média e variância é também classificado como estacionário (BROCKWELL; DAVIS, 1996), característica importante que indica boa modelagem da parte determinística da série temporal.
Neste trabalho, foi considerada estacionária toda função que possui média e variância constantes e finitas (GUIDOLIN; PEDIO, 2018).
Devido à dificuldade de identificar se estas variáveis são constantes ao longo da série temporal, são utilizadas outras ferramentas para analisar se o conjunto de dados é ou não estacionário. Três ferramentas comumente utilizadas são as funções de autocorrelação, autocorrelação parcial e o teste Augmented Dickey-Fuller- ADF (MACKINNON, 2010).
A função autocorrelação reflete o grau de dependência linear de uma série temporal em diferentes tempos, ou ainda, indica a correlação da série temporal com ela mesma defasada em h instantes de tempo. Dada uma amostra de N observações da variável x a autocorrelação (ph) pode ser calculada utilizando a seguinte equação (GUIDOLIN; PEDIO, 2018):
EtN=h+i(xt - Q)(xt_h - u)
StN=h+i(Xt - u)2
Na qual a média, u , da amostra é representada por:
N
u=N-y
t=i
A função autocorrelação parcial entre um instante xt ext_h é a autocorrelação entre estas variáveis condicionado às interações xt-1,xt_2, ...,xt_h+1, isto é, a autocorrelação depois de removida a relação entre a variabilidade já explicada entre os instantes xt-1e xt_h+1. Formalmente a autocorrelação parcial é descrita pela seguinte equação (GUIDOLIN; PEDIO, 2018):
ah = Corr(xt,xt_h|xt_1,^,xt_h+i)
De acordo com teste ADF na presença de autocorrelação, a diferenciação de primeira ordem de uma série temporal xt pode ser representada como uma regressão linear de instantes de tempo anteriores e dos diferenciais de primeira ordem até um atraso (lag) de índice m. A regressão pode ser descrita pela seguinte equação (PAL; PRAKASH, 2017):
xt = yxt-i + Pixt-i + - + Phxí-h + Et
h
Y = (-l +	0 )
i=1
Se a série for não estacionária ela apresentará raiz unitária (y = (-1 + ^í=1 0í ) = 0) e a hipótese nula será aceita. Caso contrário a série é dita estacionária e a hipótese nula é rejeitada (PAL; PRAKASH, 2017).
Como será exemplificado no decorrer do trabalho na seção 3.3.1,0 são os coeficientes de regressão do modelo.
2.3.1	Outros métodos de estacionarização
Quando a remoção de tendência e da sazonalidade não são suficientes para transformar a série temporal em estacionária dois métodos são comumente aplicados:
2.3.1.1	Diferenciação
A ideia fundamental da diferenciação é realizar a diferença entre dois pontos sucessivos de uma série temporal de maneira que a diferença tenha média e variância constantes e, desta forma, a série temporal poder ser tratada como estacionária.
x( = xt — xt-1 = c + Et
Nos casos em que a primeira diferenciação não tornar a série estacionária, podem ser realizadas sucessivas diferenciações (PAL; PRAKASH, 2017).
2.3.1.2	Diferenciação sazonal
A diferenciação sazonal é utilizada quando a série temporal apresenta caráter sazonal e o período, m, da sazonalidade é conhecido. Desta forma o conjunto de observações pode ser convertido em estacionário realizando a diferenciação entre xt e xt-m.
x
rm t
= Xt
xt-m = Et
Onde Et representa o erro e x'tm, a diferenciação sazonal, que deve comportar-se como um ruído branco (PAL; PRAKASH, 2017).
3	Metodologia
A metodologia utilizada na elaboração do trabalho está ilustrada na Figura 1. As simulações foram realizadas utilizando os pacotes Pandas, Numpy e Statsmodels da programação em Python.
3.1	Pré-tratamento das séries temporais
Em um primeiro momento, é preciso obter as bases de dados que serão analisadas. Como na maioria dos casos são utilizados dados que foram gerados com outros objetivos, cinco etapas se tornam necessárias:
•	Definir tamanho da amostra: Nas análises de séries temporais deste trabalho são feitos estudos sobre intervalos discretos. Portanto, a correta amostragem é fundamental para que possa ser realizada uma boa simulação dos dados. Quando a base de dados obtida possui tamanho superior ao desejado, comumente se agrupa a série temporal em valores médios de um conjunto de observações (visando a remoção de oscilações que influenciariam como ruídos) ou se remove uma quantidade de pontos da amostra em intervalos de tempo constante, ou seja, se efetua uma re-amostragem.
•	Remover vazios: A remoção dos dados nulos (ou not-a-number) também é fundamental, uma vez que grande parte dos modelos não simulam de maneira adequada quando estes estão presentes.
•	Remover outliers: Para que a visualização e as previsões não sejam prejudicadas é importante realizar a remoção de outlier. Para tanto, podem ser utilizados diferentes métodos como filtros por frequência das observações ou por filtros em percentil elevado. Devido ao escopo estes métodos não serão focados ao longo deste trabalho.
•	Definir coluna de tempo: Para realizar as simulações é importante que a coluna dos dados cronológicos que são utilizados no eixo das abscissas seja de fácil entendimento sendo frequentemente necessário converter ao formato desejado.
•	Segmentar os dados em conjuntos de treino e teste: Para construir o modelo é importante separar a base que será usada para a elaboração do modelo (base de treino) e a que será utilizada para verificar se a predição obteve bons resultados (base de teste).
Figura 1- Metodologia utilizada para elaborar as previsões das séries temporais
3.2	Visualizar as séries temporais
Nesta etapa os componentes internos (tendência, sazonalidade, componente cíclico) das séries temporais são identificados e também são obtidos os valores das funções de autocorrelação e autocorrelação parcial. Este procedimento é fundamental para definição dos modelos de previsão que serão utilizados.
3.3	Definir e aplicar modelos de previsão
Neste trabalho foram abordados os seguintes modelos visando a estimação de valores futuros para as séries temporais:
•	Decomposição das séries temporais;
•	Suavização exponencial;
•	Modelos ARIMA e SARIMA.
3.3.1	Decomposição de séries temporais
Estes modelos têm como principal característica decompor as séries temporais em seus principais componentes: tendência, sazonalidade e erro e a partir das funções determinadas construir um modelo de previsão.
Neste trabalho foram construídos modelos de previsão por decomposição das séries temporais realizando os seguintes procedimentos em dois métodos distintos, conforme ilustrado na Figura 2 e na Figura 3.
Figura 3- Método A, aplicado na realização de forecast via decomposição das séries temporais
Figura 2 - Método B, aplicado na realização de forecast via decomposição das séries temporais
3.3.1.1	Método A
Considerando que na série temporal não haja componente cíclica, a sua equação pode ser representada por:
— Tt + St + Et
A tendência Tt é determinada utilizando um dos procedimentos apresentados no capítulo 2.1.
Em seguida, é realizada a remoção da tendência conhecida da série original.
xt	— St + Et
Os resíduos (sazonalidade e erro) são agrupados com base no período m da sazonalidade. Desta maneira terá um valor característico para cada uma das observações dependendo com a posição dele referente à curva de sazonalidade.
Ao utilizar este método, assume-se que a sazonalidade é constante e não tem sua amplitude alterada ao longo dos anos.
Deste modo a sazonalidade característica de cada um dos instantes dentro do período m é representada pela seguinte equação:
i
i=i
Onde j = 1,2, ...,m em que m representa o período da sazonalidade,/ representa o total de ciclos em que um determinado j participou e í representa um ciclo completo.
Por fim o modelo é então definido como:
3.3.1.2	Método B
Considerando que na série temporal não exista componente cíclica, a sua equação pode ser representada por:
— Tt + St + Et
A tendência Tt e a sazonalidade St são determinadas utilizando um dos procedimentos apresentados no Capítulo 2.1 e 2.2 respectivamente.
Por fim ambos as equações são adicionadas e a previsão é realizada utilizando a seguinte equação:
xt — Tt+ St
3.3.2	Suavização exponencial
Nestes modelos os dados passados de uma série temporal são utilizados de maneira ponderada a fim da realização de previsões. Segundo MORETTIN E TOLOI (2006), técnicas específicas deste tipo assumem que os valores extremos da série representam aleatoriedade e que através de suavizações desses extremos é possível identificar um padrão básico.
3.3.2.1	Suavização exponencial simples.
O modelo atua de maneira similar à média móvel ponderada, porém a ponderação é feita de maneira exponencial e somente os dados do passado são utilizados, permitindo a elaboração de modelos preditivos (BROCKWELL; DAVIS, 1996):
xt+1 = axt + a(1 — a)xt-i + a(1 — a)2xt_2 + —
Onde a é o fator de suavização e varia de 0 a 1. Para a realização da previsão é utilizada a seguinte equação.
Fi = xi
F2 = axi + (1 — a)Fi
Ft+i = axt + (1 — a)Ft_i
Nesta equação, Ft representa o valor da previsão. Quando a = 1 Ft+i = xt e quando a = 0, Ft+i = Ft-i. Ou seja, quanto maior alfa menor é o peso para os dados mais antigos e maior é para os mais recentes (PAL; PRAKASH, 2017).
3.3.2.2	Suavização exponencial de Holt
Quando a série temporal apresenta tendência, a suavização exponencial simples não representará a série de maneira adequada. Para contornar este problema, é utilizada a suavização de Holt na qual é adicionada uma segunda constante que tem como funcionalidade representar a tendência da série temporal (MORETTIN; TOLOI, 2006).
Neste modelo a previsão da série temporal é representada como a soma do nível e da tendência (PAL; PRAKASH, 2017).
xt+i = Ft + Tt
Onde Ft representa o nível e Tt a tendência:
Ft = axt + (1 — a)(Ft-i + Tt_i)
Tt=P(Ft — Ft_i) + (1—p)(Tt_i)
Nesta equação ft representa o fator de suavização da tendência.
3.3.2.3	Sua vização exponencial tripla
A suavização exponencial tripla permite à simulação incorporar o nível, a tendência e a sazonalidade (PAL; PRAKASH, 2017), para tanto, a seguinte equação é utilizada:
Ft = a(xt - St-L) + (1 - a)(Ft_i + Tt_i)
St representa a sazonalidade e é calculada utilizando a seguinte equação (HYNDMAN; ATHANASOPOULOS, 2018):
St = Y(xt - Ft) + (1 - Y)(St_m)
Onde y representa o fator de suavização da sazonalidade.
3.3.3	Modelos ARIMA e SARIMA
Em essência, estes modelos utilizam de regressões entre as observações passadas das séries temporais para elaborar modelos preditivos (PAL; PRAKASH, 2017).
3.3.3.1	Modelos autoregressivos
Segundo Chatfield (2000), se uma série temporal é dita autoregressiva de ordem p então ela é uma soma linear ponderada dos p valores passados adicionados a um termo de característica aleatória.
Nestes modelos a regressão da série é realizada com o lag da série temporal. Este modelo autoregressivo é definido como AR(p) onde o p refere-se à ordem do componente AR (PAL; PRAKASH, 2017).
Um modelo AR(1) é descrito pela seguinte função(HYNDMAN; ATHANASOPOULOS, 2018):
Xt = K + 0xt_i + Et
Um modelo de ordem p AR(p) é descrito pela seguinte função:
Xt = K + 0iXt_i + 02Xt_2 + ••• + 0pXt_p + Et
Neste modelo Et representa o termo de característica aleatória, que se a modelagem for perfeita, deverá ser equivalente a um ruído branco, em um instante t, e 0 é o coeficiente de regressão do modelo.
3.3.3.2	Modelos de média móvel
Os modelos com média móvel utilizam a dependência temporal entre os erros residuais para prever valores futuros. Este modelo auxilia no ajuste de séries onde ocorreram eventos inesperados como a ruptura de um equipamento.
Um modelo MA(1) é descrito pela seguinte função:
Xt = K + 0Et-i + Et
Um modelo de ordem q AR(q) é descrito pela seguinte função(HYNDMAN; ATHANASOPOULOS, 2018):
Xt = K + 0iEt-i + 02Et-2 +---1 0qEt-q + Et
Netas equações q representa a ordem do modelo e k representa a intercepção média.
3.3.3.3	Modelos autoregressivos e de média móvel ARMA
Estes modelos capturam a característica de regressão da própria série temporal dos modelos AR e, também, incorporam o modelo de média móvel dos erros dos modelos MA (PAL; PRAKASH, 2017).
Um modelo ARMA(1,1) é descrito pela seguinte função:
Xt = K + 0iEt-i + 0iXt-i + Et
Um modelo ARMA(p,q) de ordem p,q é descrito pela seguinte função (DURBIN; KOOPMAN, 2001):
Xt = K + 0iEt-i + 0iXt-i +---1 0qEt-q + 0pXt-p + Et
3.3.3.4	Modelos ARIMA
É uma generalização dos modelos ARMA incluindo um componente de integração que tem como função converter a série em estacionária. O componente de integração é responsável por diferenciar a série uma ou mais vezes, diminuído caráter não estacionário da mesma (HYNDMAN; ATHANASOPOULOS, 2018).
Para diferentes valores de integração (d) a resposta muda da seguinte forma:
d = 0 : xt = xt
d = 1 : xt = xt — xt-i
d = 2 : xt = (xt — xt-i) — (xt-i — xt-2) = xt — 2xt-i + xt-2
Desta maneira um modelo de ordem autoregressiva p, de integração d e de média móvel q, ARIMA(p,d,q) pode ser representado da seguinte maneira:
^dxt — K +0p^dxt-p + 01^dxt-1 + "’ + ®1Et-1 + ®qEt-q + Et
3.3.3.5	Modelos SARIMA
Estes modelos consideram um componente sazonal para a autorregressão, para a média móvel e para a diferenciação (HYNDMAN; ATHANASOPOULOS, 2018), com o objetivo de realizar previsão mais acertada quando a série temporal apresentar sazonalidade característica.
Um modelo SARIMA(p,d,q) (P,D,Q,s) pode ser representado pela seguinte equação, onde as variáveis P,D,Q e s representam a ordem da autoregressão sazonal, da diferenciação sazonal, da média móvel sazonal e do tamanho do ciclo, respectivamente (SEABOLD; PERKTOLD, 2010).
K +0P0pA^A^Xf-p + 0101AdADXt-1 + ••• + 0101£'f-1 + Sç^q-Éf-q + £f
3.4 Critérios de avaliação dos resultados obtidos
O primeiro ponto avaliado ao verificar a qualidade de uma previsão de série temporal é justamente a capacidade do modelo em representar o comportamento dos dados de maneira visual.
Além disso, neste trabalho, o critério de AIC (Akaike’s Information Criterion) é utilizado para auxiliar na escolha do melhor modelo SARIMA, o critério de Akaike é calculado utilizando a seguinte equação:
4ZC = ln(&lt;72) + —
Onde T é o tamanho da amostra,&amp;lt;7 é a variância residual do modelo e k é o número total de parâmetros a serem estimados (GUIDOLIN; PEDIO, 2018).
Para a comparação de diferentes metodologias de estimação foram utilizados os indicadores que também auxiliam no ajuste dos dados e que são usados para determinar a qualidade de um modelo (FACCHIN, 2005, apud MOTKE, 2018, p. 16).O principal destes é o da soma quadrática do erro (SSE), que mede os desvios dos dados previstos pelo modelo e os dados originais da série temporal, aliado a variância dos dados (Syy), obtém-se a expressão final do cálculo do coeficiente de determinação, R2. As equações abaixo demonstram o cálculo destes índices:
N
SSE = ^(yi - yi)2
i=i
N
^yy =	— yi)2
i=i
R2 = 1 —
SSE
S °yy
Onde yi são os valores gerados pelo modelo, yi os dados originais utilizados para elaboração do modelo e y o valor médio do conjunto de dados originais.
Ainda, foram realizados testes para verificar se os modelos implementados tornaram os resíduos em estacionários. Para esta análise, foram utilizadas as funções autocorrelação e autocorrelação parcial e o teste Augmented Dickey-Fuller (ADF).
Neste trabalho os gráficos de autocorrelação e autocorrelação parcial foram plotados com intervalo de confiança de 95%. Se uma função for estacionária, então, 95 % da amostra da autocorrelação deveria estar dentro do intervalo de confiança (BROCKWELL; DAVIS, 1996).
4	Estudo de Caso
Neste trabalho são abordadas três séries temporais distintas de maneira a possibilitar a análise de quais modelos possuem melhor desempenho em cada uma das aplicações. Para tanto, foram selecionados os seguintes dados:
•	Medida de concentração em partes por milhão (ppm) mensal de CO2 no ar de 1974 a 1987.
•	Evolução da cotação diária da ação da Braskem, BRKM3, de fevereiro de 2017 a 2018.
•	Medida a cada minuto da diferença de pressão de um leito de adsorção de umidade de uma unidade desumidificadora em uma plataforma de extração de petróleo durante 30 mil minutos.
A escolha das séries temporais reside na natureza de cada uma das mesmas. A concentração de C02 apesar de apresentar tendência possui oscilações mais demoradas e padronizadas, desta forma, deve apresentar maior facilidade de predição.
A série da cotação da Braskem é bastante volátil devido à natureza “nervosa” do mercado de ações. Espera-se que previsibilidade para este conjunto de dados seja inferior aos demais.
Os dados da unidade de adsorção são industriais pertencendo a um sistema mais fechado que os demais, no entanto, as variações abruptas de diferença de pressão e o caráter de variância não estacionária devem aumentar a dificuldade na predição dessas séries.
4.1	Evolução da concentração de CO2
Os dados disponíveis são médias mensais da concentração de CO2 na atmosfera em ppm (TANS; KEELING, 2018) entre o período de maio de 1974 a setembro de 1987.
4.1.1	Pré-tratamento da série temporal
Para a elaboração das previsões foram utilizados os dados até fevereiro de 1985 (conjunto de treino) e a partir daí se realizou a previsão comparando com o restante dos dados disponíveis (conjunto de teste).
4.1.2	Visualizar a série temporal
Seguindo a metodologia, é plotada a série temporal, as funções de autocorrelação e autocorrelação parcial, para obter melhor entendimento acerca dos dados e identificar a presença e as características dos componentes internos dos dados, conforme indicado na Figura 4.
Figura 4 - Evolução da concentração de CO2 em ppm de 1974 a 1985
Figura 5 - Autocorrelação e autocorrelação parcial da evolução da concentração de CO2.
Fonte: Elaborado pelo autor.
Desta maneira é perceptível a presença de tendência e, a partir da análise dos picos do gráfico de autocorrelação, se permite estimar a sazonalidade em 12 meses.
Nota-se a existência de forte autocorrelação entre os dados da série temporal e elevada autocorrelação parcial até o lag 2.
4.1.3	Definir e aplicar modelos de previsão
Devido à presença de tendência e sazonalidade bem definidas e constantes serão utilizados os seguintes modelos:

Decomposição da série temporal, Método A;
•	Suavização exponencial tripla;
•	SARIMA.
4.1.3.1	Decomposição da série temporal, Método A
A partir da regressão linear realizada, foi identificada a seguinte equação para a tendência:
yt = 329,419 + 0,122xt
Foi removida a tendência da série original a fim de determinar a sazonalidade. O valor determinado para as variações sazonais são os seguintes:
Tabela 1: Valores médios determinados para cada unidade de tempo do ciclo de
12 meses.
Mês	jan	fev	mar	abr	mai	jun	jul	ago	set	out	nov	dez
Média	-0.07	0,58	1,54	2,69	3,07	2,48	0,87	-1,27	-3,17	-3,29	-2,15	-0,90
Fonte: Elaborado pelo autor.
O modelo desenvolvido foi extrapolado para o restante de 1985, para os anos de 1986 e 1987 e comparado com os valores medidos no mesmo período.
Figura 6 - Comparação da concentração de CO2 Medida (linha azul) com a concentração prevista com o modelo obtido através da metodologia A (linha laranja).
As funções de autocorrelação e autocorrelação parcial foram aplicadas aos resíduos para verificar se ainda há correlação entre os dados remanescentes. Conforme indicado pela Figura 7, verifica-se que apesar da autocorrelação para lags
maiores terem reduzido, ainda há correlação significativa entre os instantes mais próximos, indicando dependência entre os resíduos.
10
0.5
0.0
LOO
0.75
0.50
0.25
0.00
-0.25
Figura 7 - Autocorrelação e autocorrelação parcial dos resíduos gerados pelo método A. ACF
1

* * * 1 *	1—1	*—1	*—1 1 1 1 1 [
PACF
			
		1#••#1 I-#■f f	
-111	1	[	í			S	•	’
			
Ò	5	1Ò	15	20	25			
Fonte: Elaborado pelo autor.
Apesar disto o valor de R2 obtido foi de 0,969 e o teste Augmented Dickey-Fuller (ADF) apresentou valor de 0,0236, indicando um bom modelo de previsão e que os resíduos são estacionários.
4.1.3.2	SARIMA
Para identificar a ordem do modelo, aliado aos gráficos de PACF e ACF e análise visual, foram realizadas otimização simulando todas as constantes (p,d,q,P,D,Q) de 0 a 3 de modo a reduzir o valor de AIC. Este valor foi obtido para um modelo SARIMA (2,1,0) (0,1,1,12).
As constantes obtidas com o modelo são apresentadas na Tabela 2. 01 é a constante autorregressiva no lag 1, 02 é a constante autorregressiva no lag 2, ()1 é a constante de média móvel sazonal no lag 12 (um ciclo completo).
Tabela 2 - Valores determinados dos coeficientes do modelo SARIMA(2,1,0)(0,1,1,12).
Coeficiente	Valor
01	-0.4513
02	-0.0982
01	-0.6065
Fonte: Elaborado pelo autor.
A Figura 8 representa a comparação da concentração de CO2 medido contra os dados previstos pelo modelo SARIMA.
Figura 8 - Comparação da concentração de CO2 Medida em ppm (linha azul) com a concentração prevista com o modelo SARIMA(2,1,0)(0,1,1,12) (linha laranja).
Fonte: Elaborado pelo autor.
As funções de autocorrelação e autocorrelação parcial foram aplicadas aos resíduos para verificar se ainda há correlação entre os dados remanescentes. Conforme indicado pela Figura 9, verifica-se que a autocorrelação foi bem capturada pelo modelo, indicando baixa dependência temporal entre os resíduos.
Figura 9 - Autocorrelação e autocorrelação parcial dos resíduos do modelo gerado pelo modelo SARIMA(2,1,0)(0,1,1,12).
Fonte: Elaborado pelo autor.
Os valores de R2 e do teste ADF são respectivamente 0,980 e 0,000, indicando um bom modelo e confirmando que os resíduos são estacionários.
4.1.3.3	Sua vização exponencial tripla
Devido à presença de tendência a de sazonalidade foi realizada exponenciação sazonal tripla. Os parâmetros foram obtidos de modo a minimizar o erro da predição e estão representados na Tabela 3.
Tabela 3 - Coeficientes determinados para o método da exponenciação tripla.
Coeficiente	Valor
a	0,56
p	1,54. 10 8
Y	0,31
Fonte: Elaborado pelo autor.
A figura 10 representa a comparação da concentração de CO2 medido contra os dados previstos pelo modelo de exponenciação tripla.
Figura 10 - Comparação da concentração em ppm de CO2 Medida (linha azul) com a
concentração prevista pelo modelo de suavização exponencial (linha laranja).
Fonte: Elaborado pelo autor.
As funções de autocorrelação e autocorrelação parcial foram aplicadas aos resíduos para verificar se ainda há correlação entre os dados remanescentes. Conforme indicado pela Figura 11, verifica-se que a autocorrelação foi bem capturada pelo modelo, indicando baixa dependência temporal entre os resíduos.
Figura 11 - Autocorrelação e autocorrelação parcial dos resíduos do modelo gerado pelo modelo de suavização exponencial tripla.
Fonte: Elaborado pelo autor.
Os valores de R2 e do teste ADF são respectivamente 0,978 e 0,000, indicando um
bom modelo e confirmando que os resíduos são estacionários.
4.1.4 Avaliar resultados obtidos
Os modelos que apresentaram melhores resultados, devido às características estacionárias dos resíduos, ao coeficiente de determinação e à capacidade de representar visualmente a série temporal original, foram os de suavização exponencial tripla e o modelo SARIMA(2,1,0)(0,1,1,12).
4.1.5	Previsões de longo prazo
Os dois modelos que apresentaram os maiores R2 foram estendidos para localizar em qual período a concentração média mensal alcançaria 400 ppm pela primeira vez, está é uma importante posição visto que o incremento de CO2 na atmosfera gera diversos impactos na flora e fauna.
Segundo o modelo SARIMA e o de Suavização exponencial tripla esta marca seria atingida somente em abril de 2023, no entanto, em abril de 2014 foi registrada média mensal de 401 ppm, demonstrando que a característica de tendência da série temporal, no decorrer do tempo, incrementou seu carácter exponencial (TANS; KEELING,2018).
4.2	Diferença de pressão em um adsorvedor
Os dados utilizados foram medidos em intervalo de um minuto totalizando 32.700 minutos de operação de um adsorvedor operando com intuito de reduzir a umidade de água a 1 ppm em uma corrente de gás de uma plataforma de petróleo.
4.2.1	Pré-tratamento da série temporal
Devido ao elevado número de pontos, optou-se por se utilizar uma amostragem de 10 minutos, ou seja se pegou 1 ponta de cada 10 amostragens operacionais, tendo-se o cuidado de se pegar o início do ciclo para evitar defasagens decorrentes do processo de re-amostragem.
Para o conjunto de treino, foi utilizada a amostra do intervalo de 0 a 26.100 minutos de operação. O conjunto de teste foi realizado comparando a previsão desenvolvida com as amostras dos minutos 26.100 ao 32.700.
4.2.2	Visualizar a série temporal
Para obter melhor entendimento acerca dos dados e identificar a presença e as características dos componentes internos da série temporal, foi plotado o conjunto de treino, Figura 12, e calculadas as funções de autocorrelação e autocorrelação parcial, Figura 13.
Figura 12 - Evolução da diferença de pressão em adsorvedor com amostras de intervalo de 10
Fonte: Dados de adsorvedor de umidade em planta plataforma de extração de petróleo.
Figura 13 - Autocorrelação e autocorrelação parcial do delta P até o lag 50.
ACF
1	llr,	. u I í'	¡ÍTt	 r r T1 í 1
			* H1111! I! U ‘
PACF
		L t 1 t t r r t t T				  .	. . .	-
1 i i 1 1 1 1	1 1 1 1 1 L		
0	10	20	30	40	50
Fonte: Elaborado pelo autor.
Nota-se a presença de tendência, a partir da análise dos picos do gráfico de autocorrelação permite-se estimar a sazonalidade em 25 amostras ou 250 minutos. Ainda, destaca-se forte autocorrelação entre os dados e elevada autocorrelação parcial até o lag 2.
4.2.3	Definir e aplicar modelos de previsão
Devido às características observadas na etapa de visualização da série temporal, foram utilizados os seguintes modelos:
•	Decomposição da série temporal, Método B;
•	SARIMA.
4.2.3.1	Decomposição da série temporal, Método B
A tendência foi capturada realizando regressão polinomial, a equação identificada está representada abaixo.
yt = 0,163 + 3,27 x¡
Foi então removida a tendência da série original a fim de determinar a sazonalidade através da utilização do método da FFT. Para tanto, foi selecionado um ciclo de adsorção que foi considerado representativo, sem ocorrências operacionais espúrias, e o resultado (Figura14) identificado foi replicado aos demais períodos.
Figura 14 - Comportamento sazonal da série temporal identificado pela Transformada Rápida de Fourier utilizando 10 harmônicas.
Fonte: Elaborado pelo autor.
Os componentes sazonais e de tendência foram adicionados e o modelo foi extrapolado para realizar a comparação com o conjunto de teste:
Figura 15 - Comparação da diferença de pressão medida (linha azul) do conjunto de teste com a diferença de pressão prevista pela utilização do método B de decomposição (linha laranja).
Fonte: Elaborado pelo autor.
Os valores de R2 e do teste ADF são respectivamente 0,782 e 0,000, indicando modelo razoável e que os resíduos são estacionários. No entanto, as funções de ACF, PACF e a distribuição dos resíduos apontam que há comportamentos determinísticos que não foram capturados pelo modelo.
Figura 16 - Autocorrelação e autocorrelação parcial do delta P dos resíduos até o lag 50.
Fonte: Elaborado pelo autor.
Figura 17 - Histograma dos resíduos indicando que estes não seguem distribuição normal em torno de 0.
Fonte: Elaborado pelo autor.
4.2.3.2	SARIMA
Para identificar a ordem do modelo foram realizadas otimização simulando as constantes (p,d,q,P,D,Q) conforme indicado na Tabela 4 de modo a identificar quais modelos obtêm menor AIC.
Tabela 4 - Representação do range utilizado na otimização do AIC
	P	d	q	P	D	Q
Início	0	0	0	0	0	0
Fim	13	1	5	3	2	3
Fonte: Elaborado pelo autor.
Uma vez identificados os coeficientes que minimizam o valor de AIC, eles foram utilizados na realização de simulações e foram avaliadas visualmente a qualidade das previsões produzidas por estes modelos. O modelo escolhido foi o SARIMA (2,0,1)(0,1,0,25)
As constantes obtidas com o modelo são apresentadas na Tabela 5. 0X é a constante autorregressiva no lag 1, 02 é a constante autorregressiva no lag 2, 0X é a constante de média móvel sazonal no lag 1 e a é a intercepção média no eixo das ordenadas.
Tabela 5 - Valores determinados das constantes do modelo SARIMA(2,0,1)(0,1,0,25).
	01	01	61	
Valor	0,4308	0,1376	0,1295	0,0003
Fonte: Elaborado pelo autor.
A Figura 18 representa a comparação da diferença de pressão medida no conjunto de teste contra os dados previstos pelo modelo de SARIMA(2,0,1)(0,1,0,25).
Figura 18 - Comparação da diferença de pressão medida (linha azul) do conjunto de teste com a diferença de pressão prevista pela utilização do modelo SARIMA (2,0,1)(0,1,0,25) (linha laranja).
Evolução DeltaP em Adsorvedor
Tempo de operação (min)
Fonte: Elaborado pelo autor.
As funções de autocorrelação e autocorrelação parcial foram aplicadas aos resíduos para verificar se ainda há correlação entre os dados remanescentes. Conforme indicado pela Figura 19, verifica-se que a autocorrelação foi bem capturada pelo modelo, indicando baixa dependência temporal entre os resíduos.
Figura 19 - Autocorrelação e autocorrelação parcial dos resíduos gerado pelo modelo de
SARIMA (2,0,1)(0,1,0,25) na base de treino.
Fonte: Elaborado pelo autor.
Os valores de R2 e do teste ADF são respectivamente 0,762 e 0,000, indicando modelagem razoável e confirmando que os resíduos são estacionários.
4.2.4	Avaliar resultados obtidos
O modelo que apresentou melhor resultado, devido às características estacionárias dos resíduos, ao coeficiente de determinação e à capacidade de representar visualmente a série temporal original, foi o SARIMA (2,0,1)(0,1,0,25).
4.2.5	Avaliação da dinâmica da série temporal
Para obter melhor entendimento em relação à dinâmica da operação do adsorvedor, foram realizadas 60 simulações do modelo SARIMA(2,0,1)(0,1,0,25) com intervalos constantes de 75 observações, porém, variando o início de 0 a 2585 com passo de 25 observações e o fim do intervalo de 75 a 2610, também com passo de 25.
Uma vez formada a matriz dos intervalos com os coeficientes p1,p2 e q1 foi avaliada a existência de algum padrão ou tendência para os resultados determinados. No entanto, as simulações se mostraram inconclusivas devido à característica aleatória dos coeficientes conforme indica a Figura 20.
Figura 20 - Figura evidenciando a variação dos coeficientes AR1, AR2 e MA1 nas 60 simulações
4.3 Evolução da cotação da ação BRKM3
Os dados disponíveis são de fevereiro de 2017 a novembro de 2018 e representam a cotação diária das ações da Braskem, BRKM3, na bolsa de valores do Brasil.
4.3.1	Pré-tratamento da série temporal
Para a elaboração e avaliação dos modelos as bases foram divididas em dois períodos. Para o conjunto de treino foram empregados os dados de fevereiro de 2017 a 13 de agosto de 2018. Com a base treino foram definidos os modelos que melhor
desempenham na previsão da série temporal, além de realizar a avaliação dos resíduos.
A base teste, necessária para realizar a comparação com os dados de previsão gerados pelo modelo, inicia no dia 14 de agosto e termina em 01 de novembro.
4.3.2	Visualizar a série temporal
Foi plotada a série temporal para obter melhor entendimento acerca dos dados e identificar a presença e as características dos componentes internos da série temporal.
Figura 21 - Evolução da cotação da BRKM3 em intervalo diário minutos, conjunto de treino.
Fonte: Bolsa de valores do Brasil (B3, 2018), dados do fechamento da ação BRKM3.
Figura 22 -Autocorrelação e autocorrelação parcial do preço da ação até o lag 50.
ACF
	II	llinillílllíniiiiinnnni	r
		
PACF
		
* • w	i i	w 1	1	• • * 4	w	1 w	*		
0	10	20	30	40	50
Fonte: Elaborado pelo autor.
A visualização da série temporal e das funções de ACF e PACF indicam que apesar da grande volatilidade dos dados, há presença de tendência para a cotação da Braskem apesar da ausência de sazonalidade.
Ainda, Nota-se elevada de autocorrelação parcial até o lag 2, e elevada autocorrelação parcial até o lag 27.
caso
4.3.3	Definir e aplicar modelos de previsão
Devido à presença de tendência, à tendência irregular, à inexistência de sazonalidade e à elevada autocorrelação serão utilizados os seguintes modelos:
•	ARIMA;
•	Suavização exponencial dupla.
4.3.3.1	SARIMA
Para identificar a ordem do modelo foram realizadas otimização simulando as constantes (p,d,q) conforme indicado na Tabela 6, de modo a identificar quais modelos obtêm menor AIC.
Tabela 6 - Representação do range utilizado na otimização do AIC.
	P	d	q
Início	0	1	0
Fim	29	2	10
Fonte: Elaborado pelo autor.
Os valores que minimizavam o AIC foram utilizados na realização de simulações e estas foram avaliadas visualmente em relação à qualidade das previsões produzidas. Apesar dos modelos de ordem mais baixa produzirem resultados de AIC similares aos de elevada ordem, a simulação gráfica indica melhor capacidade de representar o comportamento da série temporal para os coeficientes de maior ordem. Esta avaliação gráfica é representada nas Figuras 23 e 24.
O melhor valor de AIC obtido na otimização foi de 1.024 para o modelo ARIMA (2,1,3), a comparação será feita com o modelo ARIMA (29,1,9) que demonstrou melhor aderência aos dados originais mesmo tendo apresentado AIC de 1.042.
Figura 23 - Comparação da cotação medida (linha azul) do conjunto de treino com a cotação prevista pelo modelo ARIMA (2,1,3) (linha laranja).
Fonte: Elaborado pelo autor.
Figura 24 - Comparação da cotação medida (linha azul) do conjunto de treino com a cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja).
Fonte: Elaborado pelo autor.
Os coeficientes obtidos para o modelo ARIMA (29,1,9) estão representados na
Tabela 7.
Tabela 7 - Valores determinados dos coeficientes do modelo ARIMA (29,1,9).
	01	02	03	04	05	06	07	08	09	01O	011	012
	0,	-	0,	-	-	0,	0,	-	0,	0,	0,	-
Valor	2711	0,3961	0888	0,1163	0,0886	0493	2520	0,3384	7471	0292	1621	0,0936
	013	014	015	016	017	018	019	02O	021	022	023	024
	-	0,	-	0,	-	0,	-	-	-	0,	-	0,
Valor	0,1411	2561	0,0271	0480	0,0896	0545	0,0207	0,0391	0,1349	1535	0,1054	0872
	025	026	027	028	029	01	02	03	04	05	06	07
	-	0,	0,	0,	-	-	0,	-	0,	-	0,	-
Valor	0,1145	1165	0220	0409	0,0758	0,4122	3464	0,0164	0872	0,0227	0889	0,3829
	08	69	K									
	0,	-	0,									
Valor	4327	0,8796	0318									
Fonte: Elaborado pelo autor.
A avaliação dos resíduos é realizada através das funções de autocorrelação
parcial, autocorrelação, Figura 25, e do teste ADF.
Figura 25 - Autocorrelação e autocorrelação parcial dos resíduos do modelo até o lag 50.
O valor apresentado para o teste ADF foi 0, isto alinhado às funções ACF e PACF indicam que os resíduos são estacionários.
A Figura 26 representa a comparação da cotação da BRKM3 do conjunto de teste contra os dados previstos pelo modelo ARIMA(29,1,9).
Figura 26 - Comparação de 7 dias da cotação medida do conjunto de teste (linha azul) com a cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja).
Fonte: Elaborado pelo autor.
Pode-se inferir que apesar dos valores previstos não corresponderem aos da cotação realizada o modelo conseguiu capturar parcialmente o comportamento da série temporal em um intervalo de tempo não muito distante. Capturando a tendência de alta e baixa das ações, conforme representado na Figura 27.
Figura 27 - Comparação entre a primeira derivada do modelo preditivo ARIMA(29,1,9) e a
primeira derivada da ação do conjunto de teste.
Fonte: Elaborado pelo autor.
Figura 28 - Comparação de 53 dias da cotação medida do conjunto de teste (linha azul) com a
cotação prevista pelo modelo ARIMA (29,1,9) (linha laranja).
Fonte: Elaborado pelo autor.
A Figura 28 mostra que conforme se estende o período da previsão, a qualidade da representação do comportamento da série temporal pelo modelo decai significativamente.
Em virtude do distanciamento entre o valor previsto e o valor realizado, o coeficiente de determinação não foi quantificado como um dos métodos de avaliação da qualidade do modelo para esta série temporal.
4.3.3.2	Sua vização exponencial dupla
Devido à presença de tendência foi realizada exponenciação sazonal dupla. Os parâmetros foram obtidos de modo a minimizar o erro da predição e estão representados na Tabela 8.
Tabela 8 - Coeficientes determinados pelo método da exponenciação dupla.
	a	
Valor	0,79	0
Fonte: Elaborado pelo autor.
A Figura 29 representa a comparação da cotação do conjunto teste contra os dados previstos pelo modelo de suavização exponencial dupla.
Figura 29 - Comparação da cotação do conjunto de teste (linha azul) com a cotação prevista pelo modelo de suavização exponencial dupla (linha laranja).
Fonte: Elaborado pelo autor.
Devido à característica “nervosa” da série temporal e tendência variável, o modelo de suavização exponencial, que utiliza parâmetros para ponderar os valores passados da série, não consegue representar a previsão da cotação da ação de maneira adequada.
4.3.4	Avaliar resultados obtidos
O modelo que melhor conseguiu representar os dados da cotação da Braskem, BRKM3, foi o ARIMA (29,1,9). Apesar de não ser exato na previsão, este modelo auxiliou na identificação do comportamento dos valores futuros desta série temporal conforme representado na Figura 26 e na Figura 27.
O aumento do período da previsão piora significativamente a previsão devido à característica “nervosa” dos dados, conforme ilustrado na Figura 28.
40 Análise de Séries Temporais: Comparação entre modelos preditivos em estudo de caso
5	Conclusões e Sugestões para Trabalhos Futuros
Neste trabalho, os comportamentos de três conjuntos de dados temporais de natureza diferente foram analisados e através de modelos preditivos foram realizadas previsões para os próximos pontos destas séries temporais. Para tanto, foram abordados três conjuntos de técnicas de previsão: As de decomposição dos componentes internos, as de suavização exponencial e as técnicas do grupo SARIMA.
A decisão de quais modelos seriam aplicados em cada uma das séries temporais ocorreu após a análise e entendimento do comportamento dos conjuntos de dados e de modo a aplicar modelos que conseguiriam representar da maneira mais adequada cada uma das três séries temporais.
Desta forma, observou-se que para os dados de CO2 os três modelos testados conseguiram simular de maneira satisfatória o comportamento da série com destaque ao SARIMA (2,1,0) (0,1,1,12) e ao de Suavização exponencial tripla. Verificou-se também que a tendência de aumento do CO2 na atmosfera foi intensificada após o período estudado neste trabalho.
Para representar o comportamento da unidade adsorvedora de umidade nos ciclos de adsorção e dessorção optou-se pela utilização dos modelos SARIMA e de regressão linear com a utilização de séries de Fourier para representar a sazonalidade. A representação gráfica dos valores futuros e os resíduos indicaram que o modelo SARIMA (2,0,1) (0,1,0,25) capturou a parte determinística de maneira superior ao método de decomposição. Ainda, foram realizadas simulações dos coeficientes do modelo SARIMA em intervalos variados da série temporal para tentar identificar algum padrão ou alteração na série temporal, porém, este estudo foi inconclusivo.
O modelo que melhor conseguiu representar os dados da cotação da Braskem, BRKM3, foi o ARIMA (29,1,9). Apesar de não ser exato na previsão, este modelo auxiliou na identificação do comportamento dos valores futuros desta série temporal. Também foi avaliada a dificuldade de se ter um valor preciso para os dados da BRKM3 conforme o aumento da distância da previsão, devido à característica “nervosa” dos dados.
Por fim, respondendo ao segundo questionamento, o modelo que melhor conseguiu representar o comportamento futuro das séries temporais em geral foi o
SARIMA. Este fato explica-se pela capacidade dos modelos SARIMA de inserir em suas equações padrões de comportamento passados e utilizá-los para realizar as previsões.
Para futuros trabalhos, afim de melhorar o entendimento acerca do comportamento do adsorvedor, sugere-se que a avaliação do mesmo seja realizada utilizando a razão entre a raiz quadrada da diferença de pressão e a vazão de entrada no equipamento. Ainda, recomenda-se que as simulações dos coeficientes do modelo SARIMA em intervalos variados da série temporal sejam realizados utilizando não valores de periodicidade constantes, de início e término das simulações, mas com a utilização de funções que indiquem a posição de início e término exato de cada ciclo.
Em relação às metodologias de previsão, poderiam ser adotados modelos que levem em consideração não somente variáveis endógenas, mas também as exógenas como os modelos SARIMAX, permitindo utilizar maior volume de informação sobre o fenômeno que se deseja realizar previsão.
Referências
BOX, George E. P.; JENKINS, Gwilym M.; REINSEL, Gregory C. Time Series Analysis. Forecasting Control. 4. ed. Hoboken: John Wiley &amp;amp; Sons, 2008.
BROCKWELL, Peter J.; DAVIS, Richard A. Introduction to Time Series and Forecasting. 3. ed. New York: Springer, 1996.
CHATFIELD, Christopher. Time-series forecasting. Boca Raton: CRC Press, 2000. ISBN 1-58488-063-5.
DOWNEY, Allen B. Think DSP: Digital Signal Processing in Python. 1. ed. Sebastopol (CA): O'Reilly Media, 2016.
DURBIN, J.; KOOPMAN, S. J. Time series analysis by state space methods. New York: Oxford University Press, 2001.
GUIDOLIN, Massimo; PEDIO, Manuela. Essentials of time series for financial applications. Academic Press/Elsevier, 2018.
HYNDMAN, Rob J.; ATHANASOPOULOS, George. Forecasting: Principles and Practice. 2. ed. OTexts, 2018. Disponível em:&amp;lt;https://otexts.org/fpp2/&gt;. Acesso em: 18 nov. 2018
LEWIS, Bruce G.; HERBERT, Ric D.; BELL, Rod D. The Application of Fourier Analysis to Forecasting the Inbound Call Time Series of a Call Centre. Proceedings of the International Congress on Modeling and Simulation MODSIM03, Townsville, pp. 1281-1286, 2003. Disponível em:&amp;lt;https://www.mssanz.org.au/MODSIM03/Volume_03/B10/06_Lewis.pdf&gt;.
Acessoem: 22 ago. 2018.
MACKINNON, James G. Critical values for cointegration tests. Queen's Economics Department Working Paper, n. 1227, 2010. Disponível em:&amp;lt;https://www.econstor.eu/bitstream/10419/67744/1 /616664753.pdf&gt;. Acesso em: 20 set. 2018
MARTELOTTE, Marcela Cohen. Projeto de filtros para ajuste sazonal robustos a variações na sazonalidade. 2014. 298 f. Tese (Doutorado em Engenharia Elétrica). Pontifícia Universidade Católica do Rio de Janeiro. Departamento de Engenharia	Elétrica.	2014.	Disponível	em:
&lt;http://www02.smt.ufrj.br/~eduardo/teses/marcela-cohen-doutorado.pdf&gt;. Acesso em: 03 nov. 2018
MORETTIN, Pedro A.; TOLOI, Clélia M. C. Análise de séries temporais. 2. ed. São Paulo: EgargBlucher, 2006.
MOTKE, Mateus Berno. Predição de pressão de fundo em poços de petróleo via redes neurais. 2018. 32 f. Trabalho de conclusão (Graduação). Universidade Federal do Rio Grande do Sul. Escola de Engenharia. Curso de Engenharia Química,	Porto Alegre, BR-RS, 2018. Disponível em:
&lt;http://www.bibliotecadigital.ufrgs.br/da.php?nrb=001074436&amp;amp;loc=2018&amp;amp;l=d2f335 d2100a49ec&gt;. Acesso em: 17 nov. 2018
PAL, Avishek; PRAKASH, PKS. Practical Time Series Analysis: Master Time Series Data Processing, Visualization, and Modeling using Python. Birmingham: Packt Publishing, 2017.
SEABOLD, Skipper; PERKTOLD, Josef. Statsmodels: Econometric and Statistical Modeling with Python. Proceedings of the 9th Python in Science Conference, Austin, v. 57. pp 57-61, 2010.
TANS, Pieter; KEELING, Ralph. Scripps Institution of Oceanography - Trends in Atmospheric Carbon	Dioxide.	Disponível	em:
&lt;https://www.esrl.noaa.gov/gmd/ccgg/trends/data.html&gt;Acesso em: 12 nov. 2018.
B3,	2018 Disponível em:&amp;lt;http://www.b3.com.br/pt_br/market-data-e-
indices/servicos-de-dados/market-data/cotacoes/&gt; Acesso em: 20 nov. 2018
Apêndice A
Simulação da série temporal da ação BRKM3
In [1]: inport os inport pandas as pd *matplotlib inline frcm matplotlib import pyplot as pin from statsmodels. graphics. tsaplots i^x&gt;rt plot_acf, plot_pacf from future_____________iaport print_function
import nunpy as np inport seaborn as sns from statsmodels. tsa. arma_nodel inport ARZHA inport statsmodels. api as sn iiqaort statsmodels.tsa.api as sntsa from statsnodels. tsa inport stattools from statsmodels. tsa. holtvlnters inport ExpcnentialSmoothing
In [2]: ##Inportando os dados
data - pd.read_excel(•C:/Users/Tb.caaa2/Docu»ent3/ENQ/2018_02/TCC/Dados/Bovespa Historical Data4_trai n.xlsx', sheet_name-•p2‘)
In [3]! # 5OMENTE PARA AJUSTAR A BD
In [4]: data.tail(12)
Out[41: ________________________________________
	Data	Bov	BRKM3	ano mes
321	2018-07-26	79405 34	50.60	2018707
322	2018-07-27	79866.10	51 43	2018/07
323	2018-07-30	80275.59	51.49	2018/07
324	2018-07-31	79220.43	52 98	2018/07
325	2018-08-01	79301.65	51.60	2018/08
326	2018-08-02	79636.69	51 10	2018/08
327	2018-08-03	81434 98	53 20	2018/08
328	2018-08-06	81050 76	53 20	2018/08
329	2018-08-07	80346 52	53 99	2018/08
330	2018-08-08	79151 70	53 50	2018/08
331	2018-08-09	78767 99	52 30	2018438
332	2018-08-13	77496 45	52 00	2018/08
In [5]: data.index - data.Data
In [6]: data.headf)
Out[6]: ______________________
	Data	Bov	BRKM3	anomes
Data				
2017-02-17	2017-02-17	67748 42	31 00	2017/02
2017-02-20	2017-02-20	6853286	31 48	2017/02
2017-02-21	2017-02-21	69052 03	31 40	2017/02
2017-02-22	2017-02-22	68589 54	31 00	2017/02
2017-02-23	2017-02-23	67461 39	31 00	2017/02
VISUALIZAR A SÉRIE
In [9]: #Plotar grafico.pode ser necessário alterar os eixos.
plt.figure(figsize=(13.5, 3.5))
data [' BR?M3' ].pior(color='b')
plt.title('Evolução diaria do preço de fechamento da ação BRKM3') plr. xlabel('Terço') plt.ylabel('RS') pit .xticlcs (rotation=50)
0ut[9]: (array([736361., 736420., 736481., 736542., 736603., 736664., 736726., 736785., 736846., 736907.]),&amp;lt;a list of 10 Text xtlcklabel objects»
In [10]: fig, axarr = pit.subplots(2, sbarex=True)
fig.set_size_inches(13.5, 3.5)
plot_pacf(data['BRJW3'], ax=axarr[1], lags=5j) axarr[1].set_title('PACT')
plot_acf(data['BRKM3'], ax=axarr[0],lags=50) axarr[0).set_title('ACF')
OutflO]: Text(0.5,1,'ACE')
10
os oo -o,
10
os
00
Arr
ARIMA
Mantenho como texto devido à demora para realizar a otimização.
a»c\aia(] for d m rangei 1for mi in range&lt;0.29) for mai r rangeíO. 10): try anma.obj = sm tsa SARfMAXrdatartrt'] toástt).
orderaian.d maj) dynamc=Tme) arima_ofs_frt-anma_obf fitf) aciol apçeod'[ari d. ma|. anma_ob(_W ac]( ercept iatieError pa»
In {13}: ffaicVal
In 114}: data.info()
•class "pandas.core.fzaae.DataFraae’e
DatetiseIndex: 333 entries. 2017-02-17 to 2019-08-13
Sata colusns (total 4 coltms):
Data	333	ncn-null	dateti»e44[ns]
Bov	333	non-null	float&lt;4
S»3U	333	non-null	float€4
antees	333	non-null	object
dtypes: datetine€4tns](I), float«4(2). tbject(l) nemcry usaje: 13.0» KB
In 115]: model - sB.tsa.SARIJax«JataI"Ba»n"],or&lt;íer-(:9,l,9),trend-"c")
results ■ model.fit()
print (results. strssary ())
-------------------------------------------------------O--------------------------------------------------------

Simutaçjc dinámica
in Í17j:
Out[17]:
Text (J,0,5. "Cttacao Ri")
X X x
r&gt;L* i
data ["Forecast Wifft"] - results -predict (start - 30?, end- 332, aynamic-Tçue :
data ([1 BR?X 51," Forecast ÀÀ2FH' ] ] [300: 3 32 ] -plot (f igsue- (13.5,3. St, title-' Evoloçáo da eotaçld Eíffll ’) pit. xlabelf"Dias')
pit./label("Cotacao Hi")
In [21]: fig, axarr • pit.subplots(2, sharex-True) fig.set_sire_inches(13.5, 3.5)
plot_pacf(results.resid, ax-axarr[1],lags»50) axarr[ 1].set_title('PACF*)
plot_acf (results.resid, ax-axarr[0],lags-50) axarr[ 0 J.set_titie('ACF')
Out[21]: Text(0.5,1,'ACF')
ACF
In [22]: #Run ADF test on the irregular variations adt_result - stattools.adfuller(results.resid, autolag-’AIC') print)'p-val of the ADF test on irregular variations in employment data:', adf_result[l])
p-val of the ADF test on irregular variations in er.p 1: •,r.er.t data: 0.0
teste = pd.read_excel(*C:/Users/Thanas/Documents/EllQ/2018_02/TCC/Dado3/brk2_teste.xlsx']
In [29]: ¿Verificar qualidade do modelo
teste['Forecast ARIMA’] * results.predict(start «332, end= 385, dynamic=True)
teste[[’Cotação Real’,'Forecast ARIMA’]][332:305].plot(figsize=(13.5,3.5), title*'Evolução da cotaçã o BRK3')
pit. xlabelC Dias')
plt.ylabel('Cotacao W)
C:\U3er8\Thoma2\Anaconda3\llb\9ite-paclCBges\stat3models\t3a\base\tsajnodel.py:531: Valuewarning: No supported index is available. Prediction results will be given with an integer index beginnin g at "start*.
ValueWarning)
Out[29]: Text(0,0.5,'Cotacao R;')
Evolução da cotacâo BRIG
370
In [45]: dif_Forecast_ARIMA -np.diff (teste ['Forecast ARIMA’]) dlf_Cotação_Real -np.diff(teste['Cotação Real’))
350
In [70): ax - pit. subplot (111)
pit.plot(dif_Cotação_Real,label-*dif_Cotação_Real') pit. plot (dif_Forecast_ARIMA, labeldif_Fo rec as t_ARIMA') pit.xlim(332?350) plt.ylim(-l.5,3)
pit.ylabel('Diferencial de preço')
pit.xlabel('tempo')
ax.legend()
-i o
Out[70]
:&amp;lt;matplotlib.legend.Legend at 0x273a€29fdd8&gt;
--- CíX^íoRmi
Forecó’t AHJVA
3&amp;amp;3
Diat
-0.5
aí_cocdçao_3eai df -x«cast ZRIMA
1 5 J-
332
SUAVIZACAO EXPONENCIAL
In [103]: ## Criar modelo utiiizando a base de treino
modem - smtsa.ExponentialSB&gt;oothlng(data['BRKM3'] ,trend-'mul') .fit () pred = modelH.predict(start-320, end=332)
C:\Users\Thcinaz\Anaccnda3\lib\site-package3\statsmodels\tsa\base\t3a_model.py:225: ValueWarning: A date index has been provided, but it has no associated frequency information and so will be ig noted when e.g. forecasting.
' ignored when e.g. forecasting.', ValueWarning)
In [104]: pit.plot(pred.index, pred, label-* Holt-Winters')
pit.plot(pred.index, data('BRKM3'][320:333], label-'Medldo') pit.legend(loc-'best')
Out[104): -matplotllb.legend.Legend at 0xlb740ela960&gt;
In [105]: »» Exibir pa rime tros
mode1H.params
Out[105]: ('damping slope': nan,
• imtlalZlevel': 31.04375457544968,
'imtlal_seasons': array([), dtype-float64l, 'lnitlal_slope': 1.0012824161866694,
'lands': None,
'remove_bias': false,
'smoothing_level': 0.7885396833992049,
' smoothing_seasc-nal': nan,
' 3moothing_s lope': 0.0,
'use_boxcox': False]
Simulação da série temporal do adsorvedor
pit.figure(figsize=(15.5, 3.5)) plt.plot(df2[’df’]) plt.xlabel(’Time’)
pit.ylabel(’DeltaP’)
pit.title(’Evolucao DeltaP no Adsorvedor’) plt.show()
figj axarr = pit.subplots(2, fig.set_size_inches(19J 5.5)
plot_pacf(df[’df'], ax=axarr[1],lags=5Q) axarr[1].set_title('PACF') plot_acf(df['df'], ax=ax« axarr[01.set title('ACF’)
	lllt	,rl	I	¡I	I H r■ r H I	II
					
		r		r r r	r r T T T T	.		
TTT		1 1	1 1 1	ill			
MODELO SARIMA
Realizar otimização do AIC
aicVal=|] for d in range{0,1): for arí in range{0, 13): for ma] in range(0,5): for ARI in range (0,3): for D in range (0,2): for MAJ in range (0,3): try: arimaobj smlsa.SARIMAX(dfdr|.tolist(), order=(ari,d,maj),seasonal_order=(ARI,D,MAJ125)) arima_obj_fit=arirna_obj.fit() aicVal.append([ari, d, maj, ARI, D, MAJ, arima_obj_fit.aic]) except ValueError: pass
# ModeLar a função
model = sm.tsa.SARIMAX(df['df']Jorder=(2,0Jl)Jseasonal_order=(0JlJ0J25)Jtrend= 'c', dynamic=True)
results = model.fit()
print(results.summary())
results.resid.plot()
&lt;matplotlib.axes.-Subplots.AxesSubplot at 0xl2cdb5d2a20&gt;
results.resid.plot(kind='kde')
Cmatplotlib.axes._subplots.AxesSubplot at 0xl2cdbd5el60&gt;
fig, axarr = plt.subplots(2, sharex=True) fig.set_size_inches(13.5, 3.5)
plotpacf(results.resid, ax=axarr[l],lags=50) axarr[l].set_title('PACF')
plotacf(results.resid, ax=axarr[0],lags=50) axarr[0].set_title(’ACF')
Text(0.5,l,'ACF')
ACF
from statsmodels.tsa import stattools
#Run ADF test on the irregutar variations
adf_result = stattools.adfuller(results.resid, autolag='AIC') print(’p-val of the ADF test on irregular variations in employment data:', adf_result[l])
p-val of the ADF test on irregular variations in employment data: 3.1828347674678043e-24
Ler Arquivos gerados
teste = pd .read_excel('C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/book.xlsx')
Delta P Medido Forecast
#Verificar quaLidade do modeLo
teste['Forecast‘] = results.predict(start =2611, end= 3271, dynamic=True)
teste[[ Delta P Medido','Forecast']][2611:3271].plot(figsize=(13.5,3.5),title='Evolução DeltaP em Adsorvedor') pit.xlabelf1 Tempo de operação (10 x min)')
pit.ylabel('DeltaP')
C:\Users\Thomaz\Anaconda3\lib\site-packages\statsmodels\tsa\base\tsa_model.py:531: ValueWarning: No supported index is availabl e. Prediction results will be given with an integer index beginning at 'start'.
ValueWarning)
Text(©,0.5,'DeltaP')
Evolução DeltaP em Adsorvedor
2900	3000
Tempo de operação (10 x min)
040
035
030
o. 0.25
□ 0.20
0.15
010
0.05
Aplicando o Método B
Regressão Linear - capturar tendência T|
from sklearn.linearjnodel import LinearRegression
trendmodel = LinearRegression(normalize=True, fit_intercept=True)
trend_model.fit(np.arange(df.shape[0]).reshape((-l,l)),df['df'])
LinearRegression(copy_X=True, fit_intercept=True, n_jobs=l, normalize=True) print('Trend model coefficient^} and intercept={}'.format(trend_model.coef_[0],
trendmodel.intercept-) ) ’
Trend model coefficient=3.2658430951974774e-05 and intercept=0.16345646911062195
def fourierExtrapolation(x, npredict):
n = x.size
n_harm =10
t = np.arange(0, n)
p = np.polyfit(t, x, 1)
x_notrend = x
xfreqdom • fft.fft(xnotrend)
f = fft.fftfreq(n)
indexes.sort(key = lambda i: np.absolute(f[i]))
t = np.arange(0, n + n_predict)
restoredsig = np.zeros(t.size)
for i in indexes[:l +■ n_harm * 2]:
ampli = np.absolute(x_freqdom[i]) / n
pha se • np.angle(x_freqdom[i])
restoredsig += ampli * np.cos(2 * np.pi • f[i] * t + phase) return restored_sig
x = np.array(df['dt'][195:220].values)
n_predict • 3246
extrapolation = fourierExtrapolation(x, npredict)
fig, axarr = plt.subplots(l, sharex=True)
fig.set_size_inches(15.5, 5.5)
plt.plot(np.arange(0, 105), df['dt'][195:300], 'b‘, label - 'x', linewidth - 3) plt.plot(np.arange(0, extrapolation.size), extrapolation, 'r', label = 'extrapolation') plt.legend()
testef[’Delta P MedidoForecast Decomposição']][0:220].plot(figsize=(13.5,3.5),title=’Evolução DeltaP em Adsorvedor’) plt.xlabel(’Tempo de operação (min)’)
pit.ylabel('DeltaP')
Text(0,0.5,’DeltaP’)
Evolução DeltaP em Adsorvedor
-0 05
0	50	100	150	200
Tempo de operação (min)
teste.to_excel(’C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/fourier.xlsx’)
fft = pd.read_excel('C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/fourier_cc.xlsx')
fft[['Delta P Medido't 'Forecast Decomposição']][2611:3271].plot(figsize=(13.5,3.5),title='Evolução DeltaP em Adsorvedor') pit.xlabel('Tempo de operação (10 x min)’)
pit.ylabel('DeltaP')
Text(0,0.5,'DeltaP')
Evolução DeltaP em Adsorvedor
Tempo de operação (10 x mini
Simulação da série temporal do CO2
##Importando os dados
datac = pd.read_excel(,C:/Users/Thomaz/Documents/ENQ/2018_02/TCC/Dados/Monthly_CO2_Concentrations.xlsx')
datac.índex = datac.Date
CRIAR BASE PARA DESENVOLVER O MODELO
## Base para treinar o modeLo
data = datac[:130]
## Base para testar o modeLo
teste = datac[130:]
fig, axarr = pit.subplots(2, sharex=True) fig.set_size_inches(12.5, 3.5)
plotpacf(data[’C02'], ax=axarr[l],lags=24) axarr[1].set_title('PACF')
plotacf(data[' C02'], ax=axarr[0],lags=24) axarr[0].set title('ACF')
Text(0.5,l,'ACF')
ACF
PRIMEIRO MODELO - REGRESSÃO LINEAR
from sklearn.linear_model import LinearRegression
trend_model = LinearRegression(normalize=True, fit_intercept=True)
trend_model.fit(np.arange(data.shape[0]).reshape((-1,1))data['C02'])
LinearRegression(copy_X=True, fit_intercept=Truej n_jobs=l, normalize=True)
print('Trend model coefficient={} and intercept={}'.format(trend_model.coef_[0],
trendmodel.intercept)
)
Trend model coefficient=0.12158633874557882 and intercept=329.4191426893717
residuals = np.array(data['C02']) - trend_model.predict(np.arange(data.shape[0]).reshape((-l,l)))
tm = trend_model.predict(np.arange(data.shapefO]).reshape(-ljl))
tm = trend_model.predict(np.arange(data.shape[0]).reshape(-ljl))
data['tmT ] = tm
residuals = data['CO2'J - tm
data['Residuals'] = residuals
monthwise_avg = data.groupby(by=['Month'])['Residuals'].aggregate(['mean'])
data['media'] = data.Month.map(monthwise_avg['mean'])
irrvar = data['CO2'J - dataf'tm'] - data['media']
from statsmodels.tsa import stattools
data['F_RL'] = dataf'media']+ data['tm']
adf_result = stattools.adfuller(data['iv'], autolag='AIC')
print('p-val of the ADF test:', adf_result[l]) tfUnidade do indicador
p-val of the ADF test: 0.023578883820030202
MODELO SARIMA
aicVal=[]
for d in range(1,2):
for ari in range(0, 3):
for maj in range(0,3):
for ARI in range (0,3):
for D in range (0,2):
for MAJ in range (0,3):
try:
arima_obj = sm.tsa.SARIMAX(data['C02'].tolist(), order=(ari,d,maj),seasonal_order=(ARI,D,MAJ,12)) arima_obj_fit=arima_obj.fit()
aicVal.append([ari, d, maj, ARI, D, MAJ, arima_obj_fit.aic])
except ValueError:
pass
model = sm.tsa.SARIMAX(data[ 'C02' ],order=(2,l,0),seasonal_order=(0,l,l,12)) results = model.fit()
print(results.summary())
data['forecast'] = results.predict(start = 50, end= 134) data[['C02‘,’forecast’]].plot(figsize=(13.5,3.5))
results.resid.plot(kind=’kder, xlim=(-50,50))
#Run ADF test on the irreguLar variations
adf_result = stattools.adfuller(results.resid, autolag= 'AIC1)
print('p-val of the ADF test on irregular variations in employment data:', adf_result[l])
p-val of the ADF test on irregular variations in employment data: 0.0
COMPARAR SARIMA vs BASE ORIGINAL
from pandas.tseries.offsets import DateOffset
future_dates = [data.index[-1] + DateOffset(months=x) for x in range(0,620)]
future_dates_df = pd.DataFrame(index=future_dates[l:],columns=data.columns)
future_df = pd.concat([data,future_dates_df])
X = np.array(datac['C02']) future_df['C02Medido'] = X
F = future_df['C02'],dropna()
future_df['forecast'] = results.predict(start = 130, end = 900, dynamic= True)
HOLT WINTERS MODEL
## Criar modeio utilizando a base de treino
modelH = smtsa.ExponentialSmoothing(data['C02']J seasonal=’addT, trend=’add’J seasonal_periods=12).fit() pred = modelH.predict(start=data['C02’].index[0], end=data['C02'].index[-1])
pit.plot(pred.index, pred, label=’Holt-Winters')
pit.plot(pred.index, data['CO2'J, label='Medido')
pit.legend(loc=‘best')
## Exibir parâmetros modelH.params
future_df['HW-Forecast1]= modelH.predict(start=130, end=900)
# PACF e ACF dos resíduos
fig, axarr = plt.subplots(2, sharex=True) ■fig.set_size_inches(15.5, 5.5)
plotpacf(modelH.resid, ax=axarr[l],lags=50) axarr[l].set_title('PACF')
plot_acf(modelH.resid, ax=axarr[0],lags=50) axarr[0].set_title('ACF')</field>
	</doc>
</add>