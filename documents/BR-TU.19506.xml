<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19506</field>
		<field name="filename">2864_Branco_CelsoCesarMoreira_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA MECÂNICA
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada à
Faculdade de Engenharia Mecânica
Coiro Requisito Parcial à Obtenção do
Título de Mestre em Engenharia de Petróleo
SIMULADOR COMPOSICIONAL DE RESERVATÓRIOS
COM FORMULAÇÃO IMPLÍCITA EM PRESSÃO E SATURAÇÕES E
SEMI IMPLÍCITA EM COMPOSIÇÕES
(xfe £ry■ Cfefe Mbtóu. Bíuoco ■fxr&gt;
Autor: Celso Cesar Moreira Branco
Orientador: Fernando, Rodríguez de La Garzaf-'
Julho de 1991
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA MECÂNICA
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A
dissertação
"Simulador
Composicional
de
Reservatórios com Formulação Implícita em Pressão e Saturações e Semi Implícita em Composições", elaborada por Celso Cesar Moreira Branco e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comissão de Pós-Graduação como requisito parcial para a obtenção do título de Mestre em Engenharia de Petróleo.
Campinas, 19 de Julho de 1991.
Banca Examinadora
Fernando Rodríguez de La Garza,PhD.
Sidney Stuckenbruck,PhD.
AGRADECIMENTOS
Agradeço ao Criador pela fé.
À PETROBRÁS, pela oportunidade.
Agradeço ao Professor Fernando Rodríguez, meu orientador, pelo suporte técnico durante os momentos difíceis da elaboração deste trabalho. Da mesma maneira sou grato ao Professor Antônio Cláudio de França Corrêa meu iniciador na área de simulação de reservatórios.
Aos colegas do CENPES, Valter A. M. Branco, Pedro Wilson Teixeira, Luciane Bonet e Sérgio L. P. F. Coelho pelo apoio durante a redação da tese.
A Osvaldo Pedrosa Jr., que como gerente e técnico soube compreender as dificuldades decorrentes deste trabalho.
Agradeço particularmente a Farid Salomão Shecaira cujos comentários foram essenciais para o bom têrmo deste empreendimento.
Aos meus pais. A Célia e Ana Luiza.
RESUMO
Apresenta-se um modelo composicional isotérmico, bidimensional do escoamento em reservatórios, implícito na pressão e nas saturações de fluidos e semi implícito nas variáveis composicionais. Apenas os termos de fluxo das equações de transporte são tratados de forma explícita, e somente nas variáveis dependentes das composições dos fluidos. Nas células na região de uma fase a variável primária saturação de gás é substituída por uma variável composicional, que passa a receber tratamento totalmente implícito. A formulação concebida permite a redução da matriz jacobiana original a uma matriz blocada de três por três semelhante àquelas obtidas em simuladores do tipo "black-oil” totalmente implícitos.
Outras características do modelo incluem a consideração de efeitos capilares e gravitacionais e o cálculo dos termos fonte levando em conta as condições de separação de fluidos na superfície. As relações de equilíbrio e as densidades das fases são resolvidas através da equação de estado de Peng e Robinson.
A validação do modelo, baseada na teoria do escoamento bifásico em regime permanente, indicou perfeito ajuste entre resultados teóricos e simulados.
Apresentam-se aplicações a testes de formação, depleção e produção através de injeção de gás, tanto para reservatórios de óleo volátil quanto de gás retrógrado. As conclusões mostram os efeitos da permeabilidade relativa na deposição de condensado bem como a importância da análise de reservatórios através das produções mássicas dos componentes. 0 desempenho computacional é reportado em todos os casos.
ABSTRACT
This work presents an isothermal, two-dimensional, compositional reservoir model implicit in pressure and saturations and partially explicit in compositions. Only the flow terms are treated explicitly in the compositional variables. In the single phase cells the primary variable gas saturation is substituted by one compositional variable which is then treated as fully implicit. This formulation was conceived in order to simplify the jacobian matrix since its initial configuration can be reduced to a 3x3 block matrix similar to those achieved in fully implicit black-oil simulators.
Capillary and gravitational effects are considered. Fluids separation conditions at surface are taken into account in the calculation of the source terms. Fluid phase equilibria and densities are computed through the Peng-Robinson equation of state.
The validation of the model was conducted through the steady state two phase flow theory. Analytical and simulated results obtained showed excellent agreement.
Applications to pressure tests in wells, reservoir depletion and gas injection in reservoirs are presented. Conclusions show the effects of the relative permeability curves in deposition of liquid in gas condensate reservoirs and also the importance of the reservoir analysis based on component mass production. Computacional performance are reported in all studied cases.
ÍNDICE
1	Introdução	1
2	Revisão Bibliográfica	6
3	Modelo Matemático	11
3.1	Equações do Escoamento em Meio Poroso.,........... 11
3.2	Equações do Equilíbrio Líquido Vapor.............  15
3.3	Equações de Pressões Capilares...................  16
3.4	Equações Restritivas...........................    17
3.5	Condições de Contorno............................  17
3.6	Condição Inicial............................       18
4	Solução Numérica do Sistema de Equações	19
4.1	Discretização das Equações de Fluxo................ 19
4.2	Linearização do Sistema de Equações ~ Metodologia
Proposta.....................................      35
4.3	Equações Matriciais para a Formulação Implícita em
Pressão e Saturações e Semi Implícita em Composições. 40
4.4	Tratamento de Células com Fase Única............   49
4.5	Tratamento dos Termos Fonte....................    54
4.6	Inicialização da Malha de Simulação.... — ......... 61
5	Propriedades de Rocha e Fluidos	68
5.1	Pressões Capilares..............................   68
5.2	Permeabilidades Relativas........................  69
5.3	A Equação de Estado de Peng e Robinson—..........  71
5.4	Cálculo das Densidades—.......................   —	. 75
5.5	Cálculo	das Fugacidades........................    77
5.6	Cálculo	das Viscosidades........................   78
5.7	Cálculo	de Pressões de Saturação................   83
5.8	Cálculo	de Liberação Instantânea '’Flash”......... 89
6	Estrutura Lógica do Modelo Computacional	96
7	Validação do Modelo	106
7.1	Teoria do Escoamento Bifásico em Regime Permanente 106
7.2	Comparação dos Resultados Analíticos com os da
Simulação.................... — .................. 111
8	Aplicações do Modelo e Discussão de Resultados	124
8.1	Simulação de Testes de Pressão em Poços........... 124
8.2	Simulação de Depleção em Reservatórios...........  131
8.3	Simulação de Produção de Reservatórios com Ciclagem
de Gás.......................................      139
9	Conclusões e sugestões para Trabalhos Futuros	147
Referências Bibliográficas	150
Apêndice A ~ Dedução das Equações do Equilíbrio de Fases 155 Apêndice B ~ Derivadas das Equações de Fluxo e de Equilí-
brio Liquido Vapor	162
Apêndice C	-	Derivadas	das	Densidades e	do	Fator	Z	176
Apêndice D	-	Derivadas	das	Fugacidades	181
Apêndice E	-	Derivadas	das	Viscosidades	188
Apêndice F	-	Propriedades dos Pseudo Componentes	e Tabelas
de Pressões Capilares	193
Lista de Tabelas
7.1	Composição inicial dos fluidos......................   113
7.2	Dados dos reservatórios simulados para validação...... 116
7.3	Parâmetros de produção dos poços para validação........	116
7.4	Parâmetros de simulação para validação........	117
7.5	Dados de desempenho computacional das simulações
para validação....................................     123
8.1	Parâmetros de simulação para testes de formação....... 126
8.2	Dados de desempenho computacional das simulações
de teste de formação.............................      131
8.3	Dados de reservatório e de produção para as simula-
ções de depleção. .................................    133
8.4	Dados de desempenho computacional das simulações de
depleção........................................       138
8.5	Composição dos gases injetados nas ciclagens.......... 139
8.6	Dados de reservatório e de produção para as simula-
ções de ciclagem...................................    142
8.8	Dados de desempenho computacional nas simulações de
ciclagem....................................-......... 146
Lista de Figuras
4.1	Esquema da matriz jacobiana para uma malha de Nx=4
e Nz =3. .........................................      41
4.2	Disposição dos elementos não nulos da célula i,k na
matriz jacobiana.................................       43
4.3	Esquema representativo da equação matricial (M5)....... 45
7.1	Fração molar na fase líquida x pressão para o gás
do poço 3-RNS-90d...............................       114
7.2	Fração molar da fase vapor x pressão para o óleo
Volátil ...........................................    114
7.3	Curvas de permeabilidade relativa gás óleo............ 115
7.4	Vazões de óleo e gás e pressão de fluxo no poço pro-
dutor x tempo (caso a, reservatório linear de gás).... 11S
7.5	Vazão de óleo e pressão de fluxo no poço produtor x
tempo (caso b, reservatório radial de gás)............ 118
7.6	Razão de mobilidades das fases óleo e gás e relação
das frações molares L/V x pressão (casos a e b)....... 119
7.7	Constantes de equilibrio dos pseudo componentes P1
e P3 x pressão (casos a e b).........................  119
7.8	Vazões de óleo e gás e pressão de fluxo no poço pro-
dutor x tempo (caso c, reservatório linear de óleo),.. 121
7.9	Vazão de gás e pressão de fluxo no poço produtor x
tempo (caso d, reservatório radial de óleo)..........  121
7.10	Razão de mobilidades das fases óleo e gás e relação
das frações molares L/V x pressão (casos c e d )..— . 122
7.11	Constantes de equilibrio dos pseudo componentes P1
e P3 x pressão (casos C e d)........................   123
8.1	Pressão de fluxo x tempo, testes de formação em po-
ços de gás retrógrado..............................    128
128
8.2	Saturação de óleo x tempo, testes de formação em po-
ços de gás retrógrado.............................
8.3	Pressão de fluxo x tempo, testes de formação em poços de óleo volátil...............................     129
8.4	Saturação de gás x tempo, testes de formação em poços de óleo volátil. . ............................    130
8.5	Vazão de óleo e razão gás óleo x tempo, depleção em
reservatório de gás retrógrado.....................   134
8.6	Vazão de gás e pressão de fluxo x tempo, depleção em
reservatório de gás retrógrado....................    134
8.7	Produção mássica acumulada dos pseudo componentes P1
e P3-f", depleção em reservatório de gás retrógrado... 135
8.8	Vazão de óleo e razão gás óleo x tempo, depleção em
reservatório de óleo volátil.......................   137
8.9	Vazão de gás e pressão de fluxo x tempo, depleção em
reservatório de óleo volátil......................    137
8.10	Produção mássica acumulada dos pseudo componentes PI
e P3+, depleção em reservatório de óleo volátil....... 138
8.11	Vazão de óleo e razão gás óleo x tempo, ciclagem em
reservatório de gás retrógrado......................  143
8.12	Produção mássica acumulada dos pseudo componentes P3+,
ciclagem em reservatório de gás retrógrado.........   143
8.13	Vazão de óleo e razão gás óleo x tempo, ciclagem em
reservatório de óleo volátil......................... 144
8.14	Vazão de gás x tempo, ciclagem em reservatório de
óleo volátil.....................................     145
8.15	Produção mássica acumulada dos pseudo componentes P3+, ciclagem em reservatório de óleo volátil.............. 145
Nomenclatura
Símbolos
a	-	constante da equação de Peng e Robinson, [Pa.m6/Kg mol2]
A	-	(1) Capítulo 3 : área, [m2]
-	(2) Capítulo 5 : constante da equação de Peng e Robinson
b	-	constante da equação de Peng e Robinson, [m3/Kg mol]
by	-	inverso do fator volume de formação da água, [m3/m3]
B	-	constante da equação de Peng e Robinson
c	-	correção do volume molar na equação de Peng e Robinson
,	,	3
modificada, [m /Kg mol]
-	compressibilidade do volume poroso, [Pa’1]
D	-	profundidade, [m]
ê	-	vetor unitario
f	~	fugacidade do componente	m,	[Pa]
f - fugacidade do componente m na fase f, [Pa]
F	~	função genérica
g	-	aceleração da gravidade,	[m/s2]
G	-	energia livre	de Gibbs, [J]
G	-	energia livre	molar parcial	de	Gibbs, [J/Kg mol]
h f ~	profundidade de referência,	[m]
H	-	entalpia, [J]
-	comprimento do reservatório na direção x, [m]
H - comprimento do reservatório na direção y, [m] y
-	comprimento do reservatório na direção z, [m] IP - índice de produtividade de poço, [m3]
J - elemento genérico de matriz jacobiana
-	permeabilidade relativa à fase f, [fração]
&amp;amp;rog ~ Permeabüidade relativa ao óleo em ambiente contendo gás e óleo móveis, [fração]
k - permeabilidade relativa ao óleo em ambiente contendo I* O tó
água e óleo móveis, [fração]
. . 2
K	-	permeabilidade absoluta, [m ]
K	~	tensor de permeabilidades absolutas
K	~	constante de equilíbrio do componente m
L	-	fração molar na fase líquida, [fração]
n	-	número de moles total da fase f, [Kg mol]
nf	-	número de moles do componente m na fase	f, [Kg mol]
n - vetor normal a uma superfície
Nm	- número de células na malha ao longo da direção x ou r
Nz	- número de células na malha ao longo da direção z
p - pressão, [Pa]
Pf
Pref
Pwf
P
c
P CEO
p c g o e
P c g o m
P c no
P
c w o e
P
c yom
PM
~ pressão na fase f, [Pa]
-	pressão de referência, [Pa]
-	pressão de fluxo no poço, [Pa]
-	pressão crítica, [Pa]
-	pressão
-	pressão
-	pressão
~ pressão
~ pressão
-	pressão
-	peso molecular volumétrica da volumétrica da
molar do componente
calor, [J]
capilar capilar capilar capilar capilar capilar
gás óleo, [Pa]
gás óleo de entrada, [Pa] gás óleo máxima, [Pa] água água água
óleo, [Pa]
de entrada, [Pa]
máxima, [Pa]
óleo
óleo
~ vazão
-	vazão
-	vazão
fase
fase
,	3
f em reservatório, [m /s] f na superfície, [m /s]
m, [Kg mol/s]
%
Q
Q ~ vazão molar do componente m na face a, [Kg mol/s] is
a	&lt;	3
Q - vazão volumétrica da água na face a, [m /s] w
a
Q - vazão molar total de hidrocarbonetos no reservatório, t h
[Kgmol/s]
O - vazão molar total de hidrocarbonetos em condições de ths
separação de fluidos na superfície, [Kgmol/s]
r	- direção radial ou coordenada ao longo da direção r, [m]
r	- raio externo de reservatório cilíndrico, [m]
e
r - raio do nó de uma célula com poço em malha radial, [m] 0
- raio de poço, [m]
R	-	constante	universal dos gases	[Pa.m3/Kg mol.°K]
S	~	entropia,	[J/°K]
S	-	saturação	da fase f, [fração]
f
S	~	saturação de	água	irreducível, [fração]
w í
t	-	tempo, [s]
T	”	temperatura,	[°K]
Tc	- temperatura crítica, [°K]
T	- temperatura reduzida
r
u - vetor velocidade da fase f, [m/s] f
ü	-	energia interna, [J]
v	-	volume molar, [m3/Kg mol]
v	-	volume molar corrigido, [m3/Kg mol]
V	—	(X) Capítulo 3 : volume, [m3]
~ (2) Capítulos 5 e 7	: fração molar na fase vapor,
[fração]
V	- volume crítico, [m /Kg mol]
c	3
V	-	volume poroso, [m ]
w	-	fator acêntrico
- fração molar do componente m na fase aquosa, [fração]
W	~	trabalho, [J]
x	-	direção x ou	coordenada ao	longo da direção x, [m]
x	-	fração molar	do componente	m na fase líquida, [fração]
X	-	variável genérica
y	-	fração molar	do componente	m na fase vapor, [fração]
y	-	direção y ou	coordenada ao	longo da direção y, [m]
z	-	direção z ou	coordenada ao	longo da direção z, [m]
z	~	fração molar	global do componente m num fluido, [fração]
IB
Z ~ fator de compressibilidade
Z ~ fator de compressibilidade da fase f f
Letras gregas
a - fator geométrico da face a, [m3]
ê - coeficiente de interação binária dos componentes m e j áX - vetor de diferenças finitas no vetor de variáveis X ât	-	intervalo de passo de	tempo, [s]
ê	~	vetor de tolerância
$	-	porosidade, [fração]
&gt;	~	potencial da fase f,	[Pa]
f	3
?	~ peso específico da fase f, [N/m ]
—	.	3
y	-	peso específico médio de um fluido, [N/m ]
X	-	mobilidade da fase f, [Kg mol/m3.Pa.s]
3
p	~	densidade molar, [Kg mol/m ]
p	-	densidade molar da fase f, [Kg mol/m3]
f	,	3
p - densidade molar da fase f na superfície, [Kg mol/m ] í s
Ç ~ potencial químico do componente m, [J/Kg mol]
Li	- viscosidade dinâmica da fase f, [Pa.s]
Í2	- constante da equação de Peng e Kobinson
a
Q - constante da equação de Peng e Robinson
b
Subescritos
c - relativo a componente ou a propriedades críticas
f	-	fase
9	”	fase gás
h	-	relativo	a	hidrocarboneto
í - relativo à direção x ou radial
j	-	identificador de componente
k	-	relativo	à	direção z
i	~	fase líquida
m	-	identificador	de	componente
n - índice de passo de tempo ou identificador de componente
o	-	fase óleo
r	-	índice para a	direção	radial
s - condições de pressão e temperatura de superfície
t	~	índice de tempo
v	-	fase vapor
w	-	fase água
x	-	índice para	a	direção	x
z	-	índice para	a	direção	z
v	-	índice de iteração
Sobrescritos
f	-	número total de fases
k	-	índice de fase
i	-	fase ou fase líquida
v	-	fase vapor
t - indicador de vetor transposto
1. INTRODUÇÃO
A Industria do Petróleo, atividade de inegável importância na Economia das Nações, compreende um amplo e diversificado espectro de ramos da Engenharia. Suas ações na área de produção desenvolvem-se desde a perfuração exploratória, passam pela avaliação e delimitação das jazidas culminando com a definição, implementação e acompanhamento de estratégias racionais de sua explotação.
Nesse contexto, a uma disciplina - Engenharia de Reservatórios ~ compete papel essencial. Seu ob j etivo, em sentido amplo, é o de maximizar a recuperação econômica de hidrocarbonetos através da seleção, entre diferentes alternativas, dos métodos mais adequados ao desenvolvimento de
um campo de petróleo em particular. Algumas importantes questões são investigadas como, por exemplo, a definição do número e disposição ótima dos poços, intervalos a serem completados, métodos de elevação dos fluidos produzidos, dados laboratoriais de rocha e fluidos, análise da viabilidade do
emprego de técnicas especiais de recuperação, injeção de água e gás, e, em especial, previsões de produção que servem de base para as estimativas de investimentos, despesas e receitas.
Esses estudos têm sido desenvolvidos com o auxílio de
modelos que procuram reproduzir o comportamento
físico sob observação. Os primeiros modelos
basearam-se na análise das curvas de declínio [1],
do sistema
empregados
metodologia
de alto grau de empirismo, que leva em conta apenas a
histórica da produção dos poços. Num segundo
passaram-se a utilizar os assim chamados modelos de
evolução
estágio
dimensão
zero ou de balanço de materiais [2]. Nesse caso a jazida passou
a ser encarada como um tanque, desconsiderando-se sua geometria externa, porém com propriedades físicas semelhantes às obtidas em laboratório para a rocha e fluidos reais. Finalmente, na década de 60, surgem os chamados simuladores de reservatórios, que se tornaram possíveis devido ao avanço na tecnologia dos computadores digitais.
Uma definição simples desses algoritmos é dada por Coats [3]. Segundo esse autor, um simulador de reservatórios é um conjunto de equações de diferenças, escritas para cada uma das células em que o sistema físico - o reservatório - é subdividido, e que representam as leis de conservação de massa, de energia e de quantidade de movimento, esta última aproximada pela lei empírica de Darcy que rege o escoamento de fluidos em meios porosos. Constitui-se, destarte, um sistema de equações que tem como característica importante o fato de muitas vezes estas serem não lineares, o que impõe a utilização de métodos numéricos iterativos para sua solução [4].
Os primeiros simuladores foram concebidos levando em conta as três fases normalmente presentes no reservatório -gás, óleo e água - permitindo uma representação adequada dos quatro mecanismos básicos de recuperação de hidrocarbonetos, quais sejam, a expansão de fluidos, seu deslocamento por força da injeção de um segundo fluido, drenagem gravitacional e embebição capilar. Esses modelos, conhecidos por ’'black-oil1', são ainda amplamente empregados na indústria.
tía década de 70, período da primeira crise do petróleo, cresce o interesse pelos chamados métodos especiais de recuperação. A então nascente tecnologia tinha por objetivo mobilizar ou acelerar a recuperação do óleo residente no reservatório, através da utilização de agentes externos. A
aplicação desses agentes - academicamente classificados, de acordo com seu mecanismo de ação em térmicos, químicos e miscíveis ~ exigiam uma cuidadosa análise de viabilidade, dados os altos custos de implantação e operação envolvidos. Essa nova
demanda levou ao desenvolvimento de simuladores de propósito
particular uma vez que os complexos processos físicos e
químicos não eram levados em conta nos tradicionais **black"oiln. Como um dos produtos dessa evolução tecnológica são criados os modelos ditos composicionais, que responderam
ainda necessidade da indústria de estudar, com
maior detalhe,
reservatórios de óleo volátil e
de gás
e condensado
Concentrar-se-á, daqui por diante, a
discussão
nesse
tipo de
modelo
Novamente citando Coats
[3],
um
simulador
composicional é
indicado naquelas situações em que o
comportamento termodinâmico dos fluidos, em termos de suas
relações de pressão, volume e temperatura (PVT), não pode ser adequadamente descrito pelos métodos convencionais. Assim, as fases hidrocarbonetos não são mais consideradas como de composição fixa como nos "black-oilM, outrossim são agora representadas como uma mistura de n^ componentes que pode variar ao longo do espaço e do tempo. Resolve-se, portanto, de
forma rigorosa a transferência de massa entre as fases líquida e vapor de acordo com o comportamento de fase especificado para cada componente. Processos que dependem fortemente da
composição dos fluidos como o escoamento miscivel por injeção de dióxido de carbono (C02), revaporização de óleo residual por injeção de gás pobre, depleção natural de reservatórios de óleo volátil e de gás e condensado, entre outros, são mais acuradamente reproduzidos através de técnicas composicionais.
Uma característica importante desse tipo de modelo é o grande número de equações envolvidas, por célula da malha, se comparado com os demais. Diferentes abordagens matemáticas para a solução desse sistema de equações podem ser adotadas. São muito comuns na área de simulação o emprego do método das diferenças finitas para a discretização das equações diferenciais parciais que descrevem o escoamento dos fluidos, e do processo iterativo de Newton-Raphson para sua solução [4]. Baseados nos procedimentos citados acima, diversas formulações têm sido propostas diferindo no maior ou menor grau de implicitude adotado. Esse último conceito está ligado ao número de variáveis, dentre o total, que são tratadas de forma prioritária no procedimento de Newton-Raphson. Num extremo estão os métodos explícitos, onde apenas a pressão é variável primária, reduz-se o esforço computacional requerido mas, em contrapartida, a solução é menos estável [4]. Noutro extremo se situa o processo totalmente implícito onde todas as variáveis são primárias. A solução é incondicionalmente estável porém o esforço dispendido é substancialmente maior.
Outro aspecto relevante diz respeito à condução dos cálculos volumétricos e de equilíbrio entre as fases. No passado foram usados dados tabelados ou correlações para a geração de constantes de equilíbrio. Atualmente dá-se preferência às equações de estado [5] por se acreditar que estas provêm maior consistência nos cálculos de propriedades e de equilíbrio de fases, particularmente quando as composições destas se aproximam da região crítica [6],
O presente trabalho apresenta um modelo totalmente composicional, trifásico, isotérmico, implícito nas variáveis pressão e saturações de fluidos e com tratamento explicito das
variáveis composicionais nos termos de fluxo das equações de transporte, A equação de estado de Peng e Robinson [7] é empregada nos cálculos de propriedades e equilíbrio de fases. Esse esquema procura aliar as vantagens do procedimento implícito ao mesmo tempo em que, gerando equações matriciais semelhantes às obtidas nos modelos ”black-oil", busca uma redução no esforço computacional requerido. Tal virtude foi a principal motivação do estudo ora apresentado.
2, REVISÃO BIBLIOGRÁFICA
Conceitualmente, um simulador composicional é um algoritmo que permite o acompanhamento da movimentação de fluidos num reservatório ao longo do espaço e do tempo, bem como resolve as condições de equilíbrio entre as fases presentes. Sua formulação matemática é, em geral, constituída de um conjunto de n equações de balanço molar para os n c	c
componentes hidrocarbonetos; e uma adicional, de balanço volumétrico, para a água. São as chamadas equações de fluxo. Além dessas compõem o sistema outras equações de equilíbrio de fases; duas relações de pressão capilar; uma expressão restritiva relativa às saturações e duas outras para as frações molares nas fases líquida e vapor. Assim, dispõe-se, por bloco da malha de simulação, de um total de 2nc+6 equações para 20^+6 variáveis, quais sejam, pressões e saturações nas fases óleo, gás e água e 2n^ frações molares no líquido e vapor.
Os primeiros simuladores composicionais de aplicação geral foram desenvolvidos por Kazemi &amp;amp; Vestal [8] em 1978 e por Fussel &amp;amp; Fussel [9] em 1979. De forma resumida, o procedimento usado em ambas as referências consiste na combinação linear das n +1 equações de fluxo em uma única, por bloco da malha, que é c então derivada em relação à variável primária pressão, usando dados das demais variáveis obtidos no passo de tempo prévio, o sistema de equações assim formado é disposto em uma matriz, conhecida como matriz jacobiana, sendo então resolvido de forma iterativa. Atingida convergência na solução, as demais incógnitas, saturações e composições, são recalculadas usando os novos valores de pressão. Prossegue-se então para um novo passo de tempo. Essa técnica, descrita acima em Linhas gerais,
caracteriza o procedimento de Ncwton-Raphson. o tratamento explícito dos termos de fluxo ínterblocos - não são desenvolvidas derivadas em relação às saturações e composições - identifica o que se convencionou chamar de método IMPES. Essa alternativa se por um lado é económica em termos de demanda computacional, por outro impõe limitações no tamanho do passo de tempo visto que ela não possui estabilidade absoluta [4],[6]. Kazemí &amp;amp; Vestal [8] apresentaram ainda uma interessante discussão a respeito da inicialização dos dados nos blocos da malha bem como propuseram um método para contemplar as condições de separação de fluidos na superfície ao longo da simulação. Fussel &amp;amp; Fussel [9], por sua vez, introduziram um algoritmo de solução otimizado conhecido como MVNR (’’Mínimum Variable Newton-Raphson") . Esses autores foram ainda os primeiros a empregar uma equação de estado nos cálculos de propriedades e de equilíbrio entre as fases, no caso a de Redlich &amp;amp; Kwong [10], já que Kazemi &amp;amp; Vestal utilizaram dados tabelados e correlações na determinação das constantes de equilíbrio.
Em 1979 Coats [6] apresentou uma formulação totalmente implícita para o problema, igualmente baseada no método de Newton-Raphson. Essa opção tem como grande vantagem a garantia da estabilidade incondicional da solução, fato que viabiliza intervalos maiores de passo de tempo. Não obstante, têm como desvantagens a possibilidade de custo mais acentuado de esforço computacional quando comparado ao do método IMPES, bem como o risco de maiores erros de truncamento, relacionado ao uso de passos de tempo muito dilatados.
Nghiem, Fong &amp;amp; Aziz [11] em 1981, em trabalho discutido por Mansoori [12] e replicado por Nghiem [13],
derivaram uma variante do método de Kazemi &amp;amp; Vestal [8] ainda implícito apenas na pressão, mas empregando equação de estado no estudo do comportamento PVT dos fluidos. Nesse mesmo trabalho, os autores, seguindo os passos de Coats [6], implementaram uma metodologia para a correção de dados laboratoriais de permeabilidade relativa e de pressão capilar gás-óleo de forma a contemplar os efeitos da tensão interfacial dependente da composição das fases. Outra proposta sugerida por eles foi o uso de ponderação com dois pontos a montante para os termos das equações de fluxo avaliados na interface das células. Um estudo semelhante ao de Nghiem, Fong &amp;amp; Aziz foi publicado em 1989 por Schiozer [14].
Em 1983 Watts [15], baseando-se em idéia concebida por Acs, Doleschall &amp;amp; Farkas [16], apresentou uma formulação substancialmente diferente das anteriores. Seu método, dito sequencial implícito, procurou combinar aspectos positivos da formulação IMPES com as vantagens inerentes a uma de maior implicitude. Dessa forma, seu modelo, num primeiro estágio, resolve o sistema de equações apenas para a variável pressão, operação que é seguida por um cálculo implícito nas saturações. A técnica de construção da equação da pressão é baseada na premissa de que o volume de fluidos ocupando um bloco deve ser igual ao espaço disponível, ou seja o volume poroso deste bloco. Através da expansão de ambos esses termos em uma série de Taylor de primeira ordem deduz-se uma expressão relacionando variações nos volumes porosos e nos volumes das fases causadas por alterações na pressão. Este tipo de formulação foi qualificada por seu autor como "muito eficiente". Wong et alii. [5], no entanto, ressaltam não haver reportada na literatura nenhuma aplicação a casos práticos.
Em artigos publicados em 1985 e em 1986 Coats [17] e
Coats &amp;amp; Smart [18] foram responsáveis por novas e importantes contribuições em temas ligados à simulação composicional. No
primeiro deles Coats criou um método de
componentes, que ficou conhecido como
objetivando reduzir o número de elementos
grupamento de
*’pseudoizaçãoM t
necessários
à
representação de um fluido, com consequente redução do esforço computacional requerido quando de sua simulação. Nesse mesmo trabalho o autor estudou a depleção de reservatórios de gás e condensado concluindo existir situações onde a modelagem composicional é imperiosa e outras onde a aproximação ’’black-oil" modificada é suficiente. Num estudo posterior Coats &amp;amp; Smart [18] introduziram o uso da regressão não linear
multivariada com o fito de ajustar alguns dos parâmetros de equações de estado, de forma a que estas possibilitassem a reprodução dos dados gerados em laboratório com maior grau de fidelidade. Esta técnica permitiu um avanço no emprego dessas equações por lhes conferir maior confiabilidade em regiões de pressão, temperatura e composições não investigadas previamente em laboratório.
Em 1987 Wong et alii. [5], dando sequência a relatório de Nutakki et alii. [19], realizaram um estudo comparativo entre algumas das formulações composicionais descritas na literatura. Nessa ocasião os autores fizeram uma tentativa de classificação das mesmas tomando por critério o modo como as condições de equilíbrio de fase eram tratadas, bem como estudaram métodos de adaptação de modelos composicionais para o caso de simulação "black-oil".
Concluindo esta revisão cumpre mencionar o modelo de Quandalle &amp;amp; Savary [20], apresentado em 1989 dando continuidade
a um artigo anterior do próprio Quandalle e de Sabathier [21]. Esses autores derivaram uma formulação implícita em pressão e saturações tendo, portanto, grau de implicitude intermediário entre o IMPES e o totalmente implícita. A rigor, o método de Quandalle &amp;amp; Savary possui dois grupos de variáveis primárias a depender do número de fases hidrocarbonetos presentes numa célula. Para as de duas fases, são variáveis primárias pressão e saturações, enquanto nas de fase única, pressão, saturação de água e uma incógnita composicional são consideradas prioritariamente. Além das três variáveis apontadas acima são também calculados outros n -2 dados composicionais com as n +1 c	c
equações de fluxo. Ao final de um passo de tempo é feito então um cálculo de liberação instantânea (“flash1’) de forma a se obter as restantes n^ + l ou n^+2 incógnitas composicionais, a depender do número de fases existentes no bloco.
A investigação de Quandalle &amp;amp; Savary serviu de base para uma formulação semelhante, originalmente concebida por Garza [22], que foi implementada no presente trabalho. Nesse modelo, que serás visto adiante em detalhes, combinam-se alguns aspectos do tratamento totalmente implícito de Coats com as idéias de Quandalle &amp;amp; Savary no que concerne à implicitude em pressão e saturações e no tratamento das células de uma ou duas fases.
3. MODELO MATEMÁTICO
A modelagem matemática do escoamento multifásico em um reservatório, adotando-se uma abordagem composicional, compreende o seguinte sistema de equações :
+1 equações de escoamento em meio poroso, urna para cada componente do sistema. Note-se que alguns compostos não hidrocarbonetos usualmente encontrados nos petróleos em pequenos teores, como CO e H S, serão aqui igualmente referidos como "componentes hidrocarbonetos”;
-nc equações de equilíbrio termodinâmico entre as fases hidrocarbonetos líquido e vapor;
-duas expressões de pressão capilar que relacionam as pressões nas fases água, hidrocarboneto liquido (óleo) e hidrocarboneto vapor (gás), estas duas últimas doravante referidas como fases líquida e vapor;
-uma expressão restritiva quanto à soma de saturações; -duas expressões restritivas quanto à soma das frações molares nas fases líquida e vapor.
3.1	Equações do Escoamento em Meio Poroso
0	escoamento	de	fluidos	em	meio	poroso	é
matematicamente modelado através de equações			que	combinam	os
princípios de conservação	de massa	e de	quantidade		de
movimento. Este último é	aproximado	pela	lei	empírica	de
Darcy, admitida como válida	sob certas	condições,		quais sejam:	
-escoamento isotérmico e laminar;
-meio poroso homogêneo, isotrópico, mecânica e
quimicamente inerte em relação aos fluidos que o percolam.
Isto posto, as equações de balanço de massa, na sua forma integral sobre o volume V, podem ser expressas por [23] :
Onde m=l,2,....n , n +1,* sendo o componente n +1 relativo à c C	c
água*
Aplicando o teorema da divergência de Gauss no lado esquerdo da equação (3.1), transforma-se a integral em volume em uma de superfície:
*
f	*4	-4	-4 1 -4 _
x p u + y p u + wpu ,n dA =
J	moo	m gg n « wj
*	(3-2)
« Ar ^íxpS+ypS + W p S I I dV + q
J o t L l moo m g g m w w J J	m
V
Introduzindo agora a expressão da lei de Darcy para o escoamento de uma fase f:
. k f
uf= “ K	V «f	(f - o,g,w)	(3.3)
Onde o gradiente do potencial de fluxo da fase f é
por:
7 *f = vpf " pfg VD
definido
(3.4)
Substituindo a
equação (3.3)
na
expressão (3.2) obtém-se:
A
K
3
. 8 t
V
X p
m e

k
+ ¿X	o
0
/
Vs
GO
Admitindo
Yapa m g
+ y p
k
__rj
ú s
k
Ví + w p —— g m w ¡1
w
-&gt; S + m g g
W p S m w w
]]av

agora que
não
hidrocarbonetos na fase água nem
ocorre nas fases líquida
e vapor,
Ví
w
+
7
Sm
m
existem
tampouco
o
geram-se
as
n dA
(3.5)
componentes
componente água
relações:
m=l/2,....n
Ú
(3.6)
+i n +1 c
z = w
1
(3.7)
x -
n m
«7
m-1.2..&lt;♦
c
(3.8)
X «• n +1 c
X = w
0
(3.9)
0
Onde (f = i,v) é
o
m-1 &gt; 2 &gt; * * *»n
c
(3.10)
(3.11)
número total de moles
da
fase f e nf é o m
número de moles do componente m na fase f.
Substituindo as relações de (3,6) a (3.11)
obtém-se:
A
.n dA =
(3.12)
[ U x p S + yps lldv+q Jõt L I rn C 0 mg g J J	m
V
Sendo que o termo fonte q é dado por: ni
(3.13)
Onde ai® 1, 2
n e ainda: c
/
K
Para m
k
b vt w p w w
14)
n +1, ou seja para a água.
Em (3.14) o balanço
de
massa foi substituído por um balanço de volume em
condição
de
A
superfície através de:
Onde p^s é a massa específica da água em condições de superfície (constante) e b* é o inverso do fator volume de
formação da água.
3.2	Equações do Equilibrio Líquido Vapor
Uma hipótese adotada no modelo composioional ora descrito diz respeito à existência de equilibrio instantâneo entre as fases líquida e vapor. Ou seja, em qualquer ponto do reservatório, sob quaisquer niveis de pressão, temperatura e composições de fases, admite-se que liquido e vapor alcançam o equilibrio de forma Imediata. Essa hipótese foi também considerada nos demais modelos revisados na literatura [5], [6], [8], [11], [14], [15], [20].
A clássica dedução das relações termodinâmicas que governam o equilíbrio de fases [24] é detalhada no Apêndice A. Em síntese, a condição de equilíbrio que é imposta se traduz na igualdade das fugacidades de cada um dos n componentes da mistura, em todas as fases presentes no sistema. Neste trabalho consideram-se apenas duas fases, quais sejam hidrocarboneto líquido e vapor. Assim sendo a equação do equilíbrio de fases tem a seguinte expressão:
= Para 10 = 1'2'................'nr (3.15) m l m v c
Onde, por definição, o ente termodinâmico fugacidade de um componente m em uma mistura, escrito como função de temperatura, volume e frações molares, é dado por [24]:
(3-16)
Com o uso de uma equação de estado, que relaciona as
a expressão (3.16) levando-a a uma forma mais trabalhável.
3.3	Equações de Pressões Capilares
0 conceito de pressão capilar, longamente discutido
por Leverett [25], traduz os efeitos da tensão interfacial existente quando do contato entre dois fluidos imisciveis. Em
meios porosos a magnitude
dessa
variável
torna-se
particularmente importante. Entre os fatores que a afetam estão
os seguintes:
-tensão interfacial entre os fluidos;
-características de molhabilidade da rocha;
-geometria dos poros em termos de suas dimensões e formas;
-histórico de saturações do meio, uma vez que a pressão capilar tem comportamento com histerese;
Para sistemas óleo e água admite-se, usualmente, que o
fluido preferencialmente molhante é a água. Expressa-se portanto a pressão capilar água-óleo por:
(3.17)
Já em sistemas gás e óleo, este último é admitido
como fluido molhante; a pressão capilar gás-óleo é dessa forma definida como:
3.4	Equações Restritivas
As seguinte expressões, derivadas das definições
de
saturação de fluidos
e de frações molares, complementam
o
modelo matemático sob
análise:
S +
9
S
w
+ S
o
1
(3.19)
n e
E x
m»1
1
(3.20)
n c
£ y
1
(3.21)
Nota-se que a simples explicitação de uma variável em função das demais permitirá, através de (3.19), (3.20) e (3.21), a redução em três variáveis e em três incógnitas do sistema de equações do modelo matemático.
3.5	Condições de Contorno
Admite-se que o reservatório objeto da simulação é fechado nos seus limites. Tal situação é traduzida matematicamente pela condição de contorno de Neumann [4], que no caso de fluxo bidimensional num reservatório retangular é expressa por:
dl&gt;				
f	= 0	e	f	=	0
âx	x = 0	ÕZ	z=0	
	X = H		Z=H	
	X		z	
Onde f = o,g,w; e H	e H	são s	X	z		os limites		externos do
reservatório ao longo dos eixos x e z.
A interação do reservatório com o exterior foi simulada através de tenros fonte nas equações de fluxo, o tratamento desses termos será detalhado mais adiante.
3.6	Condição Inicial
As pressões e saturações no reservatório no tempo zero são determinadas a partir de valores fornecidos em um ponto de referencia. Admite-se a existência de equilíbrio capilar e gravitacional. A composição inicial do fluido é sempre considerada conhecida.
4. SOLUÇÁO NUMÉRICA DO SISTEMA DE EQUAÇÕES
Neste capítulo será descrito o método de solução empregado ao modelo matemático apresentado anteriomente. Do conjunto de equações que o compõe, aquelas chamadas de equações de fluxo se encontram em forma diferencial caracterizada por fortes não linearidades. Assim sendo, para sua resolução adotou-se uma representação dicretizada do continuuuit o que gerou um sistema algébrico de equações não lineares, Este sistema foi resolvido pelo método numérico de Newton-Raphson.
4.1 Discretização das Equações de Fluxo
As equações
(3.12)
(3.14) do
escoamento dos
componentes em meio poroso são
constituídas
de três
parcelas
usualmente chamadas de termos de acumulação,
termos de
fluxo e
e
termos
fonte. Mais especificamente são eles


( x p S + m o o
ypS 1 ]
« 9 9 ) J
8
a t
dv
v
Termos
de acumulação = -
X.
Termos
de fluxo = ■
k
ro
P~r~
y P
&lt;r g
k
-Lã ví
9
-4 „ n dA
a
8
t

b S
w w
j dV

V
/
A
/

K
Vo U
O
+
0
9
/
x
K
b
w
k r w
—
w
Ví
w
j
n dA
A
Termos
Onde m=l,2,..... ,n . c
Adotando-se um procedimento de diferenças finitas implícito no tempo, a dicretização dos termos de acumulação, a menos dos erros de truncamento, é desenvolvida através da seguinte aproximação:
rn-1						
a a t	0 xpS 4“ y ps nro o	mgg		)]	ik	a r At t [	*(va+ va) ]ik
						(4.1)
3 3 t		n+1 é b S 1	= 1	" ' Jlk At	M	0	b S ] W	ik	(4.2)
Onde o operador de diferenças finitas no tempo é definido por:
A X = X^1~ X"	(4.3)
t
Onde X é uma variável ou produto genérico, e os sobrescritos n+1 e n se referem a dois níveis consecutivos no tempo. Usando as definições em (4.1) e (4,2) as formas discretizadas finais dos termos de acumulação ficam:
n+1
. A [*(v.s.+ vssj	(va + v,s,)].k
V
(4.4)
n*1
Em (4.4) e (4.5) admite-se que as variáveis
dependentes de pressões, saturações e composições, que ocorrem no nó de uma célula genérica de volume V da malha de simulação, sâo valores médios para esta célula, de forma tal a permitir a integração desenvolvida em (4.4) e (4.5). Como se observa a aproximação por diferenças finitas dos termos de acumulação não depende de forma direta da geometria da célula.
Já a discretização dos termos de fluxo é fortemente
dependente da geometria da malha.
Para qualquer
sistema de
coordenadas em duas
dimensões os termos
de
fluxo são
aproximados por:
*		rr+ 1
	r	k	k	
K	X a —L2 Ví + y p —--9 Ví	.n dA
	m o ¡1	o	mg ¡1	g	
A	&lt;3	9 k	*	J	ik
(4.6)
Qn + 1	+ Qn + 1	+Qn+1	+ cT’	m=l,2, .. .n
í -1/2	mí+1/2	mk-1/2	k+1/2	c
e para a água:
•		n+ 1
	k	1	
K	b	(r/	,n dA = Q	+ Q	+ Q	+ Q
	w M	g 1	w	J	w	w	w	w i-1/2	i+1/2	k-1/2	k+1/2
A		(4.7)
fluxo do componente m (m=l,2
representam
o
n ,n ._ ) no nível n+1 de c c+1=w
tempo através das faces de uma célula genérica i,k
(de
geometria qualquer).
Para una malha retangular, bidimensional e em sistema de coordenadas cartesiano, as integrações indicadas em (4.6) e (4.7) são desenvolvidas tomando por base que:
-os eixos principais do tensor de permeabilidade K coincidem com as direções x e z.
-a operação de gradiente de potencial de uma fase f é dada pelo vetor:
	35	35
V5 =	f	- ê + 	 ê
T	ax	x	az
Assim para a face i+1/2
do bloco tem-se que
dz
Logo o produto abaixo,
que aparece em
(4.6) e (4.7), fica:
S*f
K Vi . n = K —-1	X 3x
fD
3x
3x
onde f=o,g,w
e assim o termo Q
m
fica:
/ 2
Q = Ay
Wi+V2
1 /2
K
x
z k-1 /2
Ôí
o
3x
35
X ----*
9 ôx
dz
(4.8)
Onde a mobilidade
de uma
fase f
(f-o,g)
definida por:
í +1
/
x
m
x
0
n
ê
X

K
X

d ?

+

J
é


(4.9)

i +1 / 2
0
K
x
Resolvendo a integral em (4.8) obtém-se:
(2 : í+1/2
íx A I
(mo)
i +1 / 2
ÔX
aí
9
ax
AyAz*
(4.10)
Onde Az,
k
Zk+1/2	Zk-1/2*
Admitindo agora que
a vazão
permanece constante
ao longo
de um intervalo de tempo At
Q"I.,,2
e que a permeabilidade
absoluta
K* é apenas função de x, a
integrada entre x. e x fornecendo:
equação (4.10) pode ser
i+1/2
AyAzk.
1
dx
K
x
(4.11)
As integrais que aparecem em (4.11) são avaliadas por:
		» Aí	= p,	- P, - 7,	D. - D. f .	.	f.	1. .	I + 1	5
i+1	i	1 í + 1 /2	1 + 1 1 1+1/2
(4.12)
X •* x
dx _	i+1/2	i
K	K
X	X ,
1/2
Usando
os
resultados (4.12) e (4.13) em (4.11)
obtém-se:

X
Para o
x í+1/2
i +1/ 2

X. - X. 1+1/2	i
K
x.
i
AyAz
k
5 + 1

"Xi + 1/2
K
x - .
i +1
*
(4.14)
f

í+1/2
' X.
í
o
- í
■ . ° . 1+1 1
+ í y X ]
t m 9 Jí + V2
f
*
i
Si + 1 9í
J
- $ i +1
caso de malha
Ax
i
X. = —=-i	2
e assim
«i+1/2
Kote~se
de blocos centrados tem-se que:
e
X. , ~ X. , ,
1+1 1+1/2
Ax
2
define-se o fator geométrico
a- . i + 1
da face i+1/2 por:
Xi+1/2 Xí
K x. i
*y¿2k
Xi+1."'Xi+V2
K
Xí+1
+
Ax
“K“
X
3
+
Ax. , i + i
K
* i +1
(4.15)
que em (4.15)
já se está
considerando
um valor médio
para a permeabilidade
absoluta ao
longo de x, no caso uma média
harmônica. Substituindo (4.15) em
(4.14) obtém-se:
Q = ± a
&lt;n.	1+1/2
1+1/2
o
X Aí 1
9	9 Jí+1/2
Expressão que
pode
ser
reescrita
como:
Q = íx T ffi.	I B O
1+1/2 k
Ai + o

T Ai I
3 8J í+1/2
Em (4.16) a
definida
por:
T
f .
t + 1 i 2
( « xf ]
(4.17)
i + 1 / 2
De
forma análoga
( r? = -é ) obtém-se o termo X
de fluxo
Q
m i - 1 / 2
da
face i-1/2 :
í-1/2

X m
T
O
AS + y
O	ffl
T
9
Sjl í-1/2
(4.18)
cu jo
fator
geométrico
a
i *
é calculado por:
1/2
“í-1/2
AyAz
______________ k______________
x. - X. , X, , „ - x. , i 1*1/2	i-1/2	i-1
K
x.
1

K
Xí + 1
Ax.
i
K x i

Ax
i -1 K
* i - 1
(4.19)
A diferença finita de potencial
AS
f
i *
é
definida de forma
1 /2
semelhante ao feito em (4.12)
, OU
seja:
AS
f i - 1 / 2
Pf “ Pf i
■ {
i-1	i-1/2'b
D.
i
- dU
(4.20)
Da mesma
forma
os termos Q
“i ±1/2
são expressos por:
Q = ± w
aí±1/2

b k w rw
w
X
J
AS
¡±1/2 Mj±1/2
± í T AS I
l “ W ' i ± 1 / 2
(4.21)
Para a face k+1/2, malha retangular, usa-se
procedimento semelhante ao aplicado na face
i+1/2. Considera-se
que em
k+1/2:
n - e
z
dA = H dX
y
= Ay dx
Usando
Q
®k+V2
K ,n
â$
K ------
* az
as relações anteriores
obtém-se
que:
*1+1/2
/
Ay
K z
x
X
O
as
0
+

Xi-1/2

dz
líl
X
9
9
dz

dx
que resulta em:
Q
%1/2
K
z

3$
o
+
dz
k+1/2
m
X
9

aí
9
1
k+1/2
dz

AyAx.
(4.22)
Onde Ax
1
Xi+1/2
Xi-V2
Novamente
admite-se
que
a vazão
Qn,
k + 1 / 2
permanece
constante ao longo
de uni passo de
tempo At, bem como
K
z
é
apenas função de
z.
Integrando-se (4.22) entre z
e
Z k+1
obtém-se, para malha de blocos centrados, a expressão
para o
fator geométrico ak+ :
a
k+ 1 /2
AyAx.
Zk*1 /2	Zk+-1	Zk+1/2
~""~K-------- + ---------K
zk	zk+l
2AyAx. Ãz k
T™
Zk
+
Az
k + 1 K
* k + 1
(4.23)
Fórmula semelhante é gerada para o

fator geométrico
z ~ z k k-1/2 , ----_--------- +
Z k
AyAx.
Zk-1/2~ 2 k-1 K
Zk-1
Az. k
zk
2AyAx.
ÀZk - i
K
+
Zfc - 1
(4.24)
Também aqui os
fatores
geométricos
respondem pela
média
das permeabilidades absolutas entre
duas células
contiguas. Usando (4.23) e (4.24)
obtém-se a
expressão geral
para os termos de fluxo Q
mk± 11 2
À
O
Aí
8 ' k±1/2
Ou ainda:
Q
mk±1/2

íx T Aí + y T Aí I [mo o m g SJ
(4.25)
Aqui as diferenças
(finitas) de potencial são escritas como:
face	k+1/2:	Aí	= f	$ -	»f - p, - p,	+ r	(D - d ) 'k+1	k/
		k+1/2	k+1	k	k*1	k	k+1/2
					(4.27)
face	k-1/2:	Aí	$ -	», “ P, * Pf	+ \	&lt;Dk'Dk-l)
		k- 1 / 2	k	k-1	k	k	-1	k-1/2
(4.28)
Num sistema de coordenadas cilindricas usa-se a mesma
metodologia aplicada antes às coordenadas cartesianas. As
seguintes considerações
fundamentam a dedução
0 vetor
gradiente de potencial da
fase f,
para geometria bidimensional,
é definido por:
Ví
f
aí
T
ar
Sí
+ ----1
az
Admite-se também
gue
os
eixos
principais do tensor
de
permeabilidades absolutas coincidem
com r
e z. Assim para
as
faces i±l/2 tem-se
que
K Ví = K
f	r
Ôí
ar
Usando as relações
acima
as
vazões
ficam:
Zk+1/2
'■
i±1/2
± 2k
aí
o
4-
Zk-V2
ar
y A ni g
aí
9
1
dz
ar
ê
r
ê z
Q
iil / 2
r
K
r
x m
X
0

(4.29)
integrando a expressão (4.29) acima e admitindo-se então que a vazão permanece constante ao longo de um passo de tempo At e que é apenas função de r, duas novas integrações, desta vez
ao longo de r. até r i	i +1			e de r	, , até r. i - 1	1	, fornecem finalmente
que:					
Q	= ± 8,-;±i/2	(x.	T Ai + y o	o	m	* T Ai g	gj	i±1/2	(4.30)
Onde 18=1,2.. .n
c
Da mesma forma para a água obtém-se:
± a , í±1/2	r b k 1 w	rw	A5	= + ... _ Wí±1/2 t±1/2	T Aí l w « J
	k	w	J		
i ± i / 2
Note-se que as equações
(4.31)
(4,30)	e (4.31) acima são idênticas às
anteriores (4.16), (4.18) e (4.21) deduzidas
para um sistema de
coordenadas cartesiano. A diferença
de
geometria
está contemplada nos fatores geométricos que
aqui
se
escrevem
como:
2 n Az k
a. .
1+1/2
1 K
F
1
ln
r
i+1/2
r
i
+ m
r i+1
r. ,
r
i+1/2
(4.32)
&amp;amp;. 1,,
i-V2
TI Az. k
1 K
rí-1
+ -4-ln
í “1	r
1
(4.33)
As diferenças de potencial são idénticas
às
expressas
2
r
5
em (4.12) e (4.20).
Usando raciocínio semelhante ao apresentado acima
obtém-se as equações para
as vazões
k±1 / 2
em
coordenadas
cilindricas:
Q
k±1/2
9
(4.34)
e para
o componente
agua:
f
Q
W k±V 2
i Oí k±V2
b w
k
r
w

± Í
Wk±W2	'
k ±7/2
Ai
T w
Ai 1
* 'k±1/2
(4.35)
Em (4.34) e
(4.35)
OS
fatores geométricos são calculados por:
2

(
~í\
K
1 k
(4.36)
ak*V2
+
2 tt | r2 ,
(	i+1/2
A z k
K
Z k

Na implementação da malha de
simulação em
coordenadas cilindricas adotou-se urna
distribuição
(4.37)
sistema de
exponencial
das dimensões das células ao longo do
eixo r. Assin
admitiu-se
a seguinte transformação de escala:
Onde reo raio do poço de produção associado à
malha
cilíndrica e r um ponto qualquer ao longo do eixo r. Para uma
malha com N* células ao longo do eixo r tem-se que:
r m e
Onde r é o raio externo do e
reservatório.
As distâncias
das
interfaces de uma célula
i,k genérica em relação
face do
à
poço são calculadas por:
r = r exp (i âp) 1*1/2 w r

e
As posições dos pontos de malha (’’centros dos blocos”) na malha cilíndrica foram calculadas admitindo a existência de regime permanente de escoamento no interior das células, como desenvolvido por Pedrosa [23]. Esse critério fornece que:
r.= r. , exp
1 1-1/2
J3Z-1
1/2
1/2
ln 0-----------1_.
í
A forma discretizada final das equações de fluxo incorpora as parcelas referentes aos termos de acumulação dados em (4.4) e (4.5) e aos termos de fluxo escritos de forma completa em (4.6) e (4.7) e detalhados em (4.16), (4.18), (4.21), (4.25) e (4.26), para geometria cartesiana, e em
(4.30), (4.31), (4.34) e (4.35) para geometria cilíndrica. Obviamente, em cada caso de geometria de malha aplicam-se os fatores geométricos específicos.
Isto posto, as equações de fluxo em diferenças finitas
ficam, para m = 1,2,
'V
n + 1	n + 1
Aí |	+ AÍ T y Aí 1
°'ík	(	9 m sJik
n *
1
(00
Xm + ^P.yJ
B 9 S Bl I . , ' i k
+
Vi k k	*	#• *
n + 1
- e
X
L
P S nr o ■■
o
+
YPS n g
9

1
J i k
(4.38)
e para a água:
a(t Aí ) w wj
v _	i t k At	p	n+1 (♦ b.s,) -	n " b S ] W W í	4-
i k		k	/	
3,
n+ 1
' b I ‘w WJ -b
7 ik
(4.39)
Em (4.38) e (4.39) o
operador
de diferenças
finitas no
espaço A, em duas dimensões, é definido como
âÍ T A *f 1
' i k
ATA í + A TA « 1 xxxf	Z Z Z f I . ,
K	y 1 k 4
4-
1
k-1/2
Onde f = o,g,w.
A definição anterior
do operador
de diferenças
finitas
implica
em que
existirão para
uma célula
qualquer i,k
termos
como:
(h
^[v,b[-v
►
í±1/2 mj k±V2
*
7
Ou seja termos dependentes de propriedades nas interfaces das
células. Sua avaliação foi feita empregando-se o chamado esquema de ponderação com um ponto a montante consoante descrito em [4]. Assim, por exemplo, avaliar-se-à x	por:
m i + i / 2
-fluxo ocorre da célula i para a i+1 : x = x
?+V2	1
-fluxo ocorre da célula i+1 para ai: x = x
mi+-i/2
E assim por diante com as demais variáveis de interface, a menos dos pesos específicos 7	e 7.	(f=o,g,w) que
í ± 1 í 2	k ± 1 / 2
foram calculados pelo valor médio de	entre duas células
contíguas.
Concluindo, algumas das variáveis que aparecem nas equações de fluxo dicretizadas (4.38) e (4.39) podem ser substituídas por combinações de outras, de forma a reduzir o número de incógnitas do sistema. Usam-se para tanto as relações restritivas do modelo matemático. No presente estudo foram feitas as seguintes considerações:
-As pressões nas fases gás p e água p forma eliminadas usando
9	W
as relações de pressões capilares dadas em (3.17) e (3.18):
(4.40)
(4.41)
p — p + P g	o	ego
p = p - P w	0	cwo
“A saturação de óleo Sq foi eliminada usando a relação (3.19):
S = 1 - s - S
(4.42)
-A porosidade no nivel de tempo n+1,
é dada [4] pela
relação abaixo, em função da compressibilidade c
admitida como constante:
da rocha
$
fV-1
[ 1 + cr
(4.43)

-As frações molares x e y
c
são substituídas por:
(4.44)
y
	Fi C	
1	-£ m=1	y ** m
usando-se as restrições mostradas em (3.20) e (3.21).
Com as considerações acima as incógnitas do sistema passam a ser a pressão na fase óleo p°, as saturações de gás Sg e de água S* e as frações molares no líquido x	; e as frações molares no vapor y f
c
y ....... ,y . Tem-se portanto a cada passo de tempo n+l e em 3	n
c
cada nó i,k da malha de cálculo um conjunto de 2nc+l incógnitas e equações. Como já comentado na revisão bibliográfica, existem diferentes métodos para solução desse sistema de equações. A contribuição deste trabalho consiste na proposição de um novo procedimento, cujos detalhes são apresentados nas próximas seções.
4.2 Linearização do Sistema de Equações - Metodologia Proposta
Nesta seção apresenta-se uma nova formulação cuj o objetivo é permitir a simulação composicional de problemas em que os métodos sequenciais [15] podem se mostrar instáveis, e onde procedimento totalmente implícito [6] se configure como excessivamente dispendioso.
O método proposto neste trabalho, em princípio semelhante ao de Quandalle et. al. [20], baseia-se na seguinte aproximação:
-Tratamento totalmente implícito nas variáveis pressão p° e saturações de fluidos S e S ;
g w
-Tratamento explícito nas variáveis composicionais x e y , (para m = l,2,....,n ) nos termos de fluxo das equações de transporte (4.38) e (4.39). Note-se que em todos os demais termos das equações de transporte - termos fonte e de acumulação - bem como nas equações de equilíbrio líquido vapor (3.15) o tratamento é ainda totalmente implícito em relação às composições.
O tratamento explícito dos termos de fluxo em relação às variáveis composicionais está representado, para a fase óleo, como mostrado abaixo:
A Xn+1 T p ,S ,S ,X ,x
ffl	o I o g w 1	2
n +1
x^ ,x2
1
A^’ o
0 termo de fluxo da fase gás é escrito da mesma maneira:
n + 1
¿ y
X n + 1
,yn|	«
"J S
A&lt;r1
9
Para m = 1,2,e onde o nível 1 será mais adiante definido.
Uma vez estabelecidas as aproximações mostradas acima, o sistema de equações do problema é resolvido através do método iterativo de Newton-Raphson. Seu procedimento é revisto abaixo. Considere-se um sistema F de equações algébricas nâo lineares em n incógnitas X , X X :
(4,46)
Onde i = 1,2,....,n. Deseja-se	&gt; encontrar	o	vetor	X	que seja
solução do sistema em (4.46).	Para tanto	se	cria	um	processo
iterativo onde o sistema F. é 1	expandido	em	torno	do	vetor Xu
até os termos de primeira ordem, pela fórmula de Taylor:
j
0
(4.47)
Para i,j=l,2,..
n e onde o termo JV. i j
significa:
j
x = x
(4.48)
A matriz constituída por todos os elementos Ju é i J
conhecida como matriz jacobiana. Usando a igualdade a direita
da
equação (4.47)
obtém-se:
£JV ÔXU+
n J
(4.49)
1
0
Da
expressão (4.49) gera-se
o sistema linear se equações:
£ JU ÔXU+ 1 ’J J
(4.50)
Da
expressão (4.50)
uma nova estimativa
determina-se o vetor ÔX^4"1 a partir do qual
_7J + j	•
X da solução do sistema é encontrada;
xu+1
xv + ôxu+1
(4.51)
0 processo descrito
se repete
até que:
e/ou:
&amp;lt;e
(4.52)
I
Onde e é um vetor tolerância.
A convergência do método está
em
parte ligada à qualidade da estimativa inicial da solução, seja o vetor Xí0&gt;
Podem mesmo ocorrer situações
onde não
ou
se
obtém convergência
ou esta se aproxima de uma
solução "não
física'’ do sistema
de equações. Este último caso
é frequente,
por exemplo, nos cálculos de equilíbrio líquido vapor (cálculos
de liberação "flash”) fato que impõe o uso de algoritmos mais
robustos. Voltar-se-á a esse tema nos itens referentes aos
cálculos de equilíbrio de fases.
No caso particular do modelo em desenvolvimento, o sistema F de equações é composto, para cada célula i,k da malha de simulação, por:
-n +1 equações de fluxo discretizadas, definidas a partir de
(4,38) e (4.39):
F"*’ = 4	Ít1 XU 1Aí pn+1t^2 Az	1 t Ít1 yv ]a	p0*1*?"* Az ]
m i , k	(	0	ffi J	O	0		1 S	9	J
	f	i n + 1
1 + CAP.J	x p S + y p S 1 moa	m g g	+
Onde m = 1,2....... Note-se que o nível 1 indica tratamento implícito em pressão e saturações e explícito em composições. Para o componente água a função de resíduos é:
-n equações de
b b S
( w w
(4.54)
equilíbrio
líquido vapor,
definidas sobre
n
i k
0
(3.15):
k
j.rw-1 f .
idL
- f^1 = o para m = 1,2
(4-55)
n c
As funções de resíduo em (4.53), (4.54) e (4.55) sâo
dependentes das seguintes variáveis:
onde W ~
S
w
'V
'\l'W
c
i , k *
1
,y2,y3
k
i - 1 , k
' í
k - 1
i , k 1	' f 1 ,

0
Observe-se que nas expressões (4.53) e (4.54), que se referem às equações de fluxo discretizadas, a dependência funcional envolve variáveis da célula i,k sendo considerada e também das células vizinhas a ela, quais sejam a i-l,k; i+l,k; ifk“l e i,k+l. Já as equações de equilíbrio (4.55) contemplam apenas variáveis da célula i,k considerada.
Na formulação ora proposta a linearização do sistema de equações, através do método de Newton-Raphson, considera as variáveis x , T , 7 , y , T , 7 , nos termos de fluxo de m a o m	a	9
(4.53), no nível l=u de iteração (em relação às composições). Ou seja, admite~se que essas variáveis dependem implicitamente de pressão e de saturações porém são funções explícitas em relação às composições. Assim, no cálculo dos elementos da
matriz jacobiana tem-se que:
ôT	0T		3T	ÔT	
	e 		* 0	porém	T 	f - n	(4.56)
				u	
0	asf		ôx m	3y m	
Onde f =	o,g,w.	A diferença	desse	modelo em	relação ao
totalmente implícito reside, portanto, no tratamento das variáveis de interface: neste os termos de fluxo também são avaliados de forma implícita em relação à composição.
A razão de ser da nova formulação se deve ao fato de que o tratamento proposto leva a uma matriz jacobiana cuja estrutura, bastante particular, é suscetível de redução a uma matriz blocada de 3 por 3 semelhante àquelas obtidas em formulações do tipo "black-oil” trifásicas totalmente implícitas. Este é o tema do próximo item.
4.3 Equações Matriciais para a Formulação Implícita em Pressão
e Saturações e Senti Implícita em Composições
Considerando a formulação descrita no item (4.2) e adotando-se:
-as variáveis primárias p ,S ,S ,xífx^,... ,x .,7_,7_, ... ,7 ;
c	o s v 1	2	n-1	2	3	n
c	c
-escoamento bidimensional, esquema de cinco pontos;
-ordenação convencional das equações;
-termos de interface das equações de fluxo avaliados pela
técnica de ponderação com um ponto a montante;
Conclui-se que a estrutura da matriz jacobiana será pentadiagonal por blocos de 2n+1 por 2n+l; assim para uma c	c
malha com Nx por N? blocos seu número total de linhas será
de
NxNz(2nc+l). A figura 4.1 apresenta um esquema jacobiana para uma malha de Nx =	4 e Nz =	3.
da matriz
As áreas
hachuradas indicam as posições dos elementos
não nulos.
Figura 4.1: Esquema da matriz jacobiana para uma malha de
Nx = 4 e Nz — 3
No Apêndice B constam exemplos das expressões dos elementos do jacobiano, derivadas das equações de fluxo e de equilíbrio líquido vapor em relação às variáveis primárias.
A figura 4.2 detalha a disposição das entradas não nulas na matriz jacobiana para uma célula i,k genérica. Considerando as submatrizes definidas nesta figura é possível escrever as equações matriciais (Ml) e (M2) abaixo:
Eu ÔXu 4- Ciu ãXu. , 4 + Au. 5Xu. , +
i , k ?-1fk	i , k ifk-t	t , k í,k
(Ml)
Aru.
1
5X1	+ Blu ÔXu. ,	+ Dlu.
k uk	1 , k i tk+1	i
, SXu k
i+1,k
At i, i , 1	SXu + ArL f 3XL , = Rl k	i,k	i, k	i , k	?,k		(M2)
Onde	âXu -	5p, «S, ÔS, Sx^ 5x2 , . . . .	...ax 2 f	
e	ÒXi = ( 5x	, ôy , õy ,......6y 1	n - 1	i.	5	n	c J r	
c	c
Da equação (M2) obtém-se que:
SXl = Ãrl?\ f Rl - Ãll. áXu. 1	(M3)
i.k	i,k (	1(k	t,k i,kj
Substituindo (M3) em (Ml):
Elu , êXu. ,	+ Ciu. bSXu. b , +
i , k	k	’/k t , k * i
+ ÍÃíu. , - Ãru. Ãrl'\ All. J SXu. . +	(M4)
l i,k	),k i.k i,kj i,k
+ Blu. áXu.	+ Dlu. ÔXu.
i , k í, k + 1	i, k 5+1
k
— Aru Ar l. &gt;,k i ,

*
3	I - ■■
X	X
o	1
Figura 4.2: Disposição dos elementos
não nulos da
célula i,k na
matriz jacobiana
Definindo-se as seguintes matrizes:
Aru Ari ! ,k i ,
Usando as relações acima na equação (M4) obtém-se:
Elu. SXu. , , + Clu. ôXu. t , + Alu. b5Xu .	+
i , k i - 1,k	i , k i , k-1	t , k	i , k
(M5)
4- Blu „ SXu. 4- Dlu . ÔXu,	= Ru ,
i ,k í, k+1	i ,k !+1,k	s
k
A equação matricial (M5) acima está
esquematizada na figura
4.3 onde novas submatrizes são definidas particionando-se as anteriores Êtu, Clu, Ãiu, Biu, Dtu e Ru. Com estas partições as seguintes equações matriciais são possíveis:
Elul ÔXul. , , 4- Clul. ÔXul. t , + Atui. . ÔXul, i,k	i-1,k	i,k i,k-1	i.k	i.k
(M6)
+ Atu2 ÔXu2. 4- Blul. ôXul.
i, k i,k	i.k i,k+1
+ Dlul SXul = RuJ ,
i,k	i+l,k	i,k
Elu3, ,5Xu1. , , + Ctu3. ÔXul. . . t Alu3, ÔXul 4-i,k	1-1,k	i,k i,k-1	i,k	i,k
(M7)
—w *
4- Alu4
1
ôXu2, + BluS, ÔXul.
k í,k	i,k i,k+1
4- Díú3 ÔXul. , ,= Ru2, , i,k	i+1,k	i,k
Onde
e
Figura 4.3: Esquema
			JC
--w- £	fe fe fe		£ a:
		II	J£
+ 	 3	K K K	M — — “ “ M	*- "* vs 9
X vO			X
O	0
K M X fe K K X K fe	fe 1— -W	*4H fe fe ~ —. ■—	fe fe	— fe
	
fe fe X				
	
0	0
fe fe fe K fe fe fe X fe	M— -	— ■*—	M fe fe — — — -—-	fe
	
X ve fe	fe— 	 “*■ “X
	
x fe fe 1 i i i í 1 i i 1 i t 1 M K X	t	1 1	1 1	! 1	i X — — — — K
X fe fe X fe M X fe fe	fe	■— ’— ‘— fe fe —. —	* fe X -*- ■*"	' —• fe
	
X fe M	X-— — 	 — fe
	
O	0
X fe M fe X X K K fe	fe— *—	—■	4*4 fe fe	—4-	. —* fe if *- — •— — fe.
	
fe W fe	fe *“ — *-	fe
	
O	o
***** fe fe X |C fe fe	X *»	-*	—	fe « —■	—	—*• *H*	fe fe	«4	w,	fe
representativa da equagáo patricial (M5)
Isolando o vetor SXu2 i ( k
na equação (M7):
ÒXu2. , = Alu4,\ í Ru2. , - Elu3 . , ôXul , , — Clu3 , ÔXu1	4
i,k	i,k	i,k	i ,k	k	i ,k	i , k-1
- A l u3 S Xu1 .
i,k i,k
- Blu3 1
i ,k
ÔXul	— Dl «3 áXul
i , k+1	i ,k
1 + 1 , k

(M8)
Substituindo (M8)
em (M6)
obtém-se
- A l u 2 . , A l u4 . \
i , k i,k
____________4-______
Ê.
»A
Elu3. ,
i A _________i

7
5Xu1. k
1-1,k
4-
f

K
l
Clu1 - Alu2 Alu^*1 Clu3
i,k	i,k j ,k	i ,k
______________________4-________________l
c. „
« A

7
5Xu1. u ,
1 ,k-1

(
-1
+
__ * __________ * ~ *
Alu1 — Alu2 , Alu4 Alu3 i, k	i, k i ,k	i fk
___________________________________________I
Ã.
1 ,k
6Xu1
i,k
4
ÔXul 4 t,k+1
„ _ * — * -1 —
Dlu1 “Alu2H Aiu4. Dlu3.
1 , k	i , k 1 ,k	i,k
1_______________________4_____________________!
Rui - Aku2. ,AtÍ4 Ru2. u
i , k	i ,k i, k
1_____________4___________________1
(M9)
E. SXul
i, k
i-1,k
+ C 5Xu1. ,
i.k i,k
+ A ô Xu 1 i,k	i,k
+ D. ÔXu1 .	= R
ifk	5 +1,k	i ,k
(MIO)
Cada
uma
das
submatrizes resultantes, E , i , k
Ci,k'
A , B e T , k	i , k
D. .
i , k
tem
dimensão 3 por 3, enquanto os vetores
3 elementos. 0 conjunto das equações (MIO),
uma para cada célula da malha, formará
para geometria
bidimensional e ordenamento convencional das equações- um
sistema pentadiagonal por blocos de 3 por 3
elementos,
semelhante
aos obtidos em modelos
’’black-oil”
trifásicos
totalmente
implícitos
A
solução do	si sterna	de
equações
do modelo
composicional apresentado envolveu,
portanto, os seguintes
passos para cada
célula da malha:
-Cálculo das
submatr i zes	E i u ,
i,k'
c,ul.k'
Al“í,k'
Ar“í,k'
e Diu , onde i=l,2,...Nx e k=l,2...Nx; 1 f K
-Redução das submatrizes acima para a forma mostrada na equação (MIO), usando as partições definidas na figura 4.3.
T -Solução do sistema no vetor incógnita SXui= . Empregou-se nessa etapa a rotina NSPIV [26], baseada em técnica para matrizes esparsas?
-Cálculo das demais incógnitas do sistema, que constam do vetor
SXu2 = x^x^
através expressão (M8)
depende
da solução 8Xui obtida anteriormente. Calcula-se a seguir o vetor Ix^ ,, ,y2,y3 ,... ,yn usando agora a equação (M3) ;
"Verificação da convergência da solução e, conforme o caso, execução de nova iteração ou passo de tempo ao longo da simulação.
A implementação computacional do processo descrito acima procurou otimizar o consumo de memória através do armazenamento permanente, por célula da malha, e a cada iteração newtoniana, apenas das submatrizes necessárias para a resolução das equações (M3), (MS) e (MIO) . Todas as demais matrizes e vetores envolvidos têm existência ’’temporária", ou seja, são usadas áreas comuns de memória independentemente da célula sendo considerada na montagem do sistema de equações.
Finalizando este item cumpre observar que o desenvolvimento mostrado até aqui é aplicável àquelas células que se encontram na chamada região de duas fases, onde óleo e gás coexistem em equilíbrio termodinâmico. Entretanto podem haver situações, na realidade muito frequentes, em que apenas uma fase hidrocarboneto está presente, só líquido ou só gás. Nesses casos o sistema de equações se reduz visto que perdem sentido as relações de equilíbrio de fases, permanecendo apenas as n +1 equações de transporte. 0 tratamento desses casos c
particulares está detalhado no item 4.4 a seguir.
4.4 Tratamento de Células com Fase Única
A discussão do modelo composicional até agora tem-se baseado num sistema de 2nc+l equações por célula da malha de simulação, sendo n de para o escoamento dos componentes e n c	c
gue impõem a condição de equilíbrio entre as fases hidrocarbonetos. Subjacente a esse modelo está consideração da existência dessas duas fases numa dada célula. Entretanto, sob certas condições termodinâmicas, uma das fases pode não estar presente. Tal situação ocorre quando um fluido estás sujeito a uma pressão acima de sua pressão de saturação, ou seja, apenas a fase líquida existe para um óleo acima de sua pressão de bolha e apenas a fase vapor está presente num gás com pressão acima da de orvalho. A ocorrência de um ou outro caso reduzirá o sistema de equações às expressões de transporte, visto que perderão o sentido as relações de equilíbrio de fases.
Um simulador composicional deve, portanto, estar equipado para identificar o número de fases presentes em cada célula bem como adaptar seu algoritmo de solução a essa situação. A verificação do número de fases coexistentes pode ser feita através do cálculo da pressão de saturação, admitindo-se como conhecido o fluido inicialmente presente; operação que é desenvolvida a cada passo de tempo ou, preferencialmente, a cada iteração newtoniana. Esta última opção foi a adotada no simulador desenvolvido. A adaptação do procedimento de solução, por sua vez, serviu~se de conveniente manipulação dos elementos do bloco diagonal principal da matriz jacobiana nas células de fase única.
O esquema abaixo mostra a disposição dos elementos no
bloco diagonal principal para urna célula com duas fases:
3Fw	3Fw	3Fw
Sp	ÔS	dS
g	w
3F1	3F1	8Fl
ap	as	as
g	w
8F2	8F2	ÔF2
ap	as	as
c	g	w
óFn ___c ap
3Fn ãs“
s
ÓFn
___c
as
w
dFfi
3P
o o
art 2 ap
o
3Ff
n
_____c
Sp
0
o
3F w . . dx~ 1	. . 8Fw ’ 3x , ! n -2 i c 1 1	3Fw ÔX . n-1 c	3F w . . . %	... 3Fh	I dy n c
3F1 . .	. . 3Fl 1	3Fl	3Fl ...	... 3Fl
ÔXH 1	3X	1 n-2 i c 1 1	ax n-1 c	%	ay n c
ôF2 . .	. . 3F2	1	ÔF2	ÔF2 . . .	.. . 5F2
ax i * • • •	ax	! .%2 t • ! * •	i •	ÕX n-1 c * » « «	% 4 * ♦	5y n •	c • • •
* * 3Fn	1 * :	i -	i ÔFn	.	* * ÔFn	* b • 8Fn	■ « « • SFn
c *	. .	c 1	c	c • •	
3x	ax „ 1 n-2 i c ( i	Ôx n-1 c	%	ay n c
3Ff 1 .	1 ».3Fft 1	SFfl	3Ffl ..	... SFfl
ôxd 1	8x „ 1 n-2 ( c * í	ax n-1 c	%	3y J n c
aFf 2 .	,.8FfZ !	ÔFf 2	3Fí2 ..	. . . ÔFf 2
ex1 a « • •	áx 1 . Vi • 1 • * ! • : 1	ax n* 1 » c » * * • *	% • • « » * •	*	c • • • *
• ■ • 3Ff	: i •	t « •	í 3Ff ,	« • • • » 3Ff	« • ■ » 3Ff	• • * 3Ff
n	, * *	n '	n	n	. &amp;lt;- 4	n
e	c 1	c	c	c
ax.	ax . n-2 1 c 1	8x n-1 c	ay2	ay n c
3p
ás
g
as
w
3X1
sy2
?y5
*
•
11
w
*
3y n
Na matriz acima as n +1 linhas superiores mostram as derivadas c
das n +1 equações de fluxo em relação às 2n +1 incógnitas, enquanto as nc linhas inferiores indicam as derivadas das nc relações de equilíbrio em relação a essas mesmas incógnitas.
No caso de uma célula contendo apenas a fase óleo, admite-se que a saturação de gás (Sg) é nula deixando, portanto, de ser incógnita. Da mesma forma as	variáveis
relativas às frações molares na fase vapor (y1 a y ) perdem o c
sentido e o sistema se reduz a n^+1 equações de transporte em n +1 variáveis (p ,S ,x,,x ,.....,x J. Visando não alterar a
C	o w 1	2	n *1
c
montagem das submatrizes definidas no item 4.3 a seguinte relação é introduzida:
ss
9
ôx
n-1
c
Com essa nova equação o bloco diagonal principal de uma
célula
com fase única líquida fica:
3Fw Sp	0	aFw as w	0	..... 0	o
3F1		ÔFl	6F1	.... 3F1	8F1
ap	0	as w	ax.	ÔX „ n -2 c	ôx n - 1
ÔF2		SF2	aF2			 SF2	ÔF2
ap	0	as	ÔX	dX n n - 2	ax 1 n - 1
			*	, c • •	,c •
8Fn	SFn	SFn	8Fn	1	1 SFn
c «	c	c «	• •	Cl	1 c
ap	as w	ax. 1	ax , ; n - 2 c	1	ôxn 1 ‘	n * i 1
— 			 		— — — —	— — —		L _ _ ™
0 -1	0	0 . . .	. . . 0	* 1
i
0
0
0
0
0
1
0*0 0
(
0		Ôp
0		ss 9
0		3S w
		ãx.
0		áx „ n-2 c
„		_ —	i
0		ÔX n -1 c
0		ay2
		?y3
1		áy n L	c J
0 0
0 0
Complementa-se o artifício estendendo-se o tratamento totalmente implícito a uma variável composicional, no caso à variável x , de forma a manter o esquema de implicitude c
total em três das variáveis do problema. Aliás isto é recomendado por Quandalle e Savary [20] na sua formulação.
As operações matriciais introduzidas no item 4.3 permanecem válidas, obtendo-se ao final uma matriz de blocos de 3 por 3, Obviamente as correções áy2,Sy3,.... ,áy^ serão sempre c nulas visto que não existe a fase vapor.
Procedimento semelhante foi aplicado para as células identificadas como contendo apenas a fase vapor. Nesse caso admite-se que a saturação de gás corresponde ao complemento da saturação de água, deixando de ser incógnitas S ,x.xn,—,x .
g 1	4	n
c
As seguintes relações adicionais são criadas visando não alterar o esquema padrão de montagem das submatrizes:
ÔS - áy„
3	2
sx1 = ãy3
áx2 = áy4
áx = Sy n c	c
O novo algoritmo inclui ainda um tratamento totalmente implícito em uma variável composicional, no caso em y2, mantendo o esquema de implicitude total em três das variáveis [20], Usando as relações mostradas logo acima o bloco diagonal
principal de urna
célula com fase
única vapor é reescrito como:
ÔFw	)	ÔFw		. 0
ap		ãs” 0		
		w		
«n 0 ap		3F1	0		n
		as 0 H		
a?2	"4	9F2		. 0
ap		as	0		
		w		
SFn		SFn		
- 0 Sp		ãr 0		. 0
		w		
0 0		0 0	... 0	0
0 -1		0 0		0	0
0 (	)	0 -1			0	0
0	í	)	0 0	.. .-1	0
0 0		0 0	... 0	-1
1 1 o 1	ôFw .... sy2	... 5Fw ay n c		ãp
1 0 i !	ÔFl .... ay,	. .. SF1 c		ÔS g
! f	0 í	SF2 .... ay2	. . . SF2 * c		as w
i	* í	* 1	’ 1	ôFn e « • •	ÔFn		ÔX, 1
				Sx n-2 e
1 u 1		ay2	1 ¡ 1 •&amp;lt;l*&gt;3 J			
! 1 í	0 		0 0		ÔX i rrl C
&amp;lt;0 1	1 .....	0 0		*y2
1	0 t	; 1	*	0 		0 0		ãy3 •
i i	0 ]	0 .....	1 0		c
1 o	0 * »* *«	0 1		ôy n
1		J		c
Como
no caso anterior,
as
operações
matriciais
desenvolvidas no Ítem 4.3 mantém sua validade obtendo-se ao
final uma matriz jacobiana reduzida de blocos de 3 por 3. As correções ,Ôxn1 serão aqui necessariamente nulas.
Durante as diversas aplicações do modelo, que serão comentadas oportunamente, a evolução dos processos simulados normalmente partiu de uma situação de fase única para uma de duas fases. Não obstante, nada impede que o contrário ocorra,
identificando-se o desaparecimento de uma fase através da obtenção de saturações de gás nulas ou iguais (ou maiores) que o complemento da saturação de água.
4.5 Tratamento dos Termos Fonte
A interação do reservatório com o exterior, fisicamente associada aos poços, foi modelada através da inclusão de termos fonte nas equações de transporte (4»38) e (4,39), nas células definidas como contendo um poço. O método foi implementado de forma genérica permitindo a alocação de poços em qualquer célula da malha. Nas simulações do tipo seção transversal, geometrias radial ou cartesiana, admitiu-se ainda a possibilidade de poços completados em mais de uma camada, ou seja, é possível haver um ou mais blocos contribuindo para um
mesmo poço.
As vazões de produção obtidas	do reservatório foram
consideradas a nível de superfície,	melhor dizendo,	nas
condições de pressão e temperatura de	separação dos fluidos
especificadas em superfície. A correspondência entre as vazões
em reservatório com as resultantes em	superfície, para cada
poço, partiu da hipótese de que a	vazão molar total de
hidrocarbonetos em reservatório (Qth) é	igual à	vazão molar
total de hidrocarbonetos no separador (Qths) . Deprezaram-se, portanto, os efeitos de estocagem nos poços. A hipótese acima é traduzida por:
Qth = Qths
A vazão Qths pode ser reapresentada como:
Qths =
(4.58)
Em (4.58) o subescrito s indica valores obtidos em superfície, para as densidades molares de óleo (Po,) e gás (pg&gt;) e vazões volumétricas de óleo (q ) e gás (q ). Introduzindo agora os
0 5	£J S
conceitos de fração molar líquida Ls e vapor Vs, em condições de separação, e empregando ainda a idéia admitida em (4.57), a expressão (4.58) pode ser desmembrada em:
q p -- Ls Qths = Ls Qth	(4.59)
os os
q p = Vs Qths - Vs Qth	(4.60)
gs gs
n + n
Onde Ls + Vs = —!~™—~ = 1.
n
A vazão molar total de hidrocarbonetos no
reservatório, Qth, por sua vez, é composta pelas parcelas:
Qth
(4.61)
Onde kí e kf indicam as camadas inicial e final (contínuas) abertas ao fluxo no poço considerado. Substituindo a equação (4.61) nas anteriores (4.59) e (4.60) obtém-se as expressões que relacionam as vazões de reservatório com as de superfície:
kf
bs £
k=Ki
(4.62)
(4.63)
A lei de Darcy serviu para o cálculo das vazões
volumétricas dos fluidos no reservatório:
(4.64)
Onde f = o,gfw e p é a pressão de fluxo na camada k. Os wf k
índices de produtividade IPfc podem ser fornecidos ou
calculados. Para esse último caso adotou-se o modelo de
Peaceman [27] que propõe:
IP = k
2 H K Az,
k
(4.65)
Onde r é o raio do poço e Az é a espessura da célula que W	K.
contém o poço. Para geometria radial tem-se ainda que:
K : permeabilidade absoluta na direção radial;
r^: raio do nó da célula que contém o poço.
Já para geometria cartesiana essas varáveis significam:
K : média geométrica das permeabilidades horizontal e vertical
da célula que contém o poço;
para 1/2&amp;lt;&amp;amp;&amp;lt;2
A expressão (4.64) é dependente das pressões de fluxo
onde k - ki a w. Além disso as equações que relacionam
as vazões de reservatório com suas resultantes
de superfície,
(4.62) e (4.63), dependem ainda da composição
e propriedades
dos fluidos em superfície. A solução a ser
empregada será
função do tipo de condição de contorno imposta
ao problema.
Duas possibilidades existem:
a)A pressão de fluxo na célula base (k
kí)
das camadas
completadas é fornecida. Kesse caso tem-se uma
produção (ou
injeção, inclusive de água) à pressão constante, tornando o
cálculo das vazões volumétricas em reservatório
direto.
Conhecida a pressão na base, as pressões de fluxo nas
camadas
abertas acima dela, obviamente
se estas existirem, são
obtidas
por [11]:
k&gt;
Hk
(4.66)
Onde H, . = 0 k i
demais
Hk
são dados por:
Onde
j+1/2
Hk
k-1
J-kí j+1/2
ZJ
&lt;r q + 7 q + T q I
l 0 0	99 w H w
(4.67)
(4.68)
; os
k
(
(f = o,g,w)
Os yf
são os pesos específicos das fases.
obtém-se as vazões em reservatório qf
Conhecidos os p
k
(f~o,g,w) gue serão usadas nas equações de fluxo do simulador.
Ao final de cada passo de tempo calculam-se então as vazões dos hidrocarbonetos produzidos a juzante do separador através das equações (4.62) e (4.63). As informações sobre as frações e densidades molares geradas em superfície são providas através de um cálculo de liberação instantânea (“flash") para as condições de separação; usando a composição global z (10=1,2,. ... , n ) dos fluidos como estes se apresentam em
poço
reservatório, que é igual à composição global z que chega
&amp;amp;
ao separador. Esta composição global é definida por [8]:
z = z = m	m
poço s
(4.69)
b)Num segundo caso a pressão de fluxo varia com a produção que se mantém constante. Nessa situação a pressão p é obtida a k
partir das equações (4.62), para vazão de óleo especificada na superfície, ou (4.63) caso uma vazão de gás constante seja imposta. A expressão para o cálculo da pressão de fluxo é
deduzida, usando como exemplo	O C	aso	de vazão	de	óleo q 0 s
constante, substituindo-se a	lei	de	Darcy,	em	(4.64), na
equação (4.62):					
q p	kf	T	í			k	(		
os os ~ v ip	n	ro	p -	D	+ o	rs	P	~ p	1
Ls A- k L k=Ki	*-	o	k	J	ps			f JJk
(4.70)
Admitindo-se agora que as diferenças de pressão nas fases óleo e gás em relação à pressão de fluxo são constantes em todas as camadast ou seja:
P _ P , = p " P, = âp = constante o,	wf,	g wf
k	k	k	k
Reescreve-se a expressão (4.70) gerando-se a equação para a
determinação da pressão de fluxo:
Como se observa em (4.71) e (4.72) a pressão de fluxo, necessária à determinação dos termos fonte, é dependente da composição e propriedades dos produtos, fases óleo e gás, gerados em superfície. Estes, por sua vez, são função da
composição das fases em equilibrio no reservatório, que é justamente o que se está tentando calcular de forma iterativa a cada passo de tempo na simulação. Assim o problema a ser resolvido é não linear. Um tratamento totalmente implícito para sua solução demandaria um considerável esforço computacional fato que levou à adoção de uma aproximação explícita, na iteração prévia, para as funções dependentes das variáveis composicionais de superfície (Ls, Vs, P(js e Pgs)* Ou seja, as informações sobre composição e propriedades das fases ao nível do separador são determinadas, via cálculo "flash”,
usando-se a composição global dos
fluidos no
reservatório,
calculadas por (4.69), resultantes da iteração
imediatamente
anterior a em andamento. Ao fim da
cada passo de
tempo as
vazões volumétricas qos e q reportadas devem ser corrigidas para seus valores corretos, podendo ocorrer pequenas diferenças
em relação à vazão estipulada inicialmente como constante.
As derivadas dos termos fonte em relação às variáveis primárias do modelo composicional são exemplificadas no Apêndice B com as demais derivadas das equações de fluxo.
4.6 Inicialização das Variáveis da Malha de Simulação
A discussão sobre a solução do sistema de equações do modelo composicional se completa neste item onde são apresentados os principais dados necessários ao problema e a maneira como estes são associados aos valores iniciais das variáveis de cada célula da malha de simulação. Três diferentes configurações iniciais de reservatório foram previstas, podendo ou não conter aquífero subjacente. São elas:
-reservatório de óleo com gás em solução;
-reservatório de óleo com capa de gás;
-reservatório de gás;
O tratamento da condição inicial do reservatório exige uma série de informações sobre a geometria do reservatório e de propriedades da rocha e fluidos nela contidos. Sua decrição detalhada seria tediosa e desnecessária, ao menos para os objetivos presentes. Assim sendo, listam-se abaixo apenas os principais dados empregados nessa etapa:
-dimensões e cotas de referência do reservatório, entre elas as profundidades dos contatos água/óleo (hcwo) e óleo/gás (h • -fase em que se encontra o fluido inicialmente presente no reservatório, se líquida (óleo) ou vapor (gás);
-composição inicial desse fluido, z^ para m ~ l,2,....,n ; -pressão Pref existente numa profundidade de referência href»* -saturação de água irreducível (S*.);
-curvas de pressões capilares água/hidrocarboneto C^CMO)
(água/óleo ou água/gás) e óleo/gás (P ) *
A associação das informações anteriores às variáveis do problema, que se segue ao lançamento da malha - ou seja a determinação das coordenadas de cada célula - admitiu a existência de equilíbrio capilar e gravitacional dos fluidos no interior do reservatório. Assim sendo, o seguinte procedimento foi implementado:
a)Cálculo da pressão de saturação do fluido inicial no reservatório bem como das composições das fases hidrocarbonetos em equilíbrio nessa pressão (líquida x e vapor y	para
S a t	sat
m ~ 1,2 f.... n ) ;
c
b)Cálculo da pressão na fase óleo em cada célula usando-se a pressão e profundidade de referência fornecidas. No caso de reservatório de óleo em que o contato óleo/gás está presente admitiu-se que a pressão de bolha, recém calculada na etapa a, ocorre na profundidade do contato, passando então a servir de ponto de referência. O algoritmo de cálculo das pressões iniciais na malha partiu da equação do equilíbrio hidrostático:
‘P dp =
P ref
‘h
7(p) dh
Usando o teorema do valor acima gera:	médio,	a	integração	da	expressão
P = Pref	+ 7 (p)		href]		(4.73)
Onde pé a pressão média	entre p	rtf	e a pressão	P,	na cota h,
que se pretende calcular.
Sendo a equação (4.73) não linear, na
sua solução empregou-se
o método de Newton-Raphson
já
discutido anteriormente.
Assim, partindo-se da equação
da
pressão média:
p + p
ref
2
ou seja
P - 2P - Pref
Substituindo
(4.73) na expressão acima
obtém-se a função
de
resíduo F :
r
- = 0
F
r
cuja derivada em relação a variável p é:		
dFr	(		dz
r - 2 - I h -	h J	
dp	1	ref J	dp
Isto posto, calcula-se a pressão p por
procedimento iterativo
onde:
v +
— v+ i ~ p = P
k
- F
r
dFp/dp
A
As iterações se interrompem
quando
o módulo da correção na
pressão âp tornar-se menor
que um
valor de tolerância ou seja:
/

F r
áFr/dp
&amp;lt;tolerância

Calculado p obtém-se facilmente a pressão p procurada.
c)Verificação da existência de aquífero no reservatório e, se for o caso, determinação da pressão na fase hidrocarboneto p h c (óleo ou gás, conforme o tipo de reservatório) no contato água/hidrocarboneto. Calcula-se então a pressão na fase água p no contato água/hidrocarboneto, que servirá de referência para outras determinações de pressão na água:
p ~ pu - P
wc	hc cwoe
Onde P é a pressão capilar água/hidrocarboneto de entrada, c w o e
Existindo aquífero determina-se	ainda	a	pressão	capilar	
água/hidrocarboneto máxima P c w o m	cujo	valor		corresponde a
saturação de água irreducivel S&gt;(.				
d)Verificação da existência de capa de		gás	no	reservatório.
Nesse caso a pressão na fase óleo	no contato		gás	óleo p	será
o c
igual à pressão de bolha calculada em b. Calcula-se então a pressão na fase gás pg e nessa posição, que servirá de referência para outras determinações de pressão na fase vapor:
Onde P	é a pressão capilar óleo/gás de entrada. Existindo
e so e
capa de gás define-se ainda a pressão capilar óleo/gás máxima
p que corresponde a uma saturação de óleo residual.
c som
e)Caso o reservatório contenha capa de gás e/ou aquífero calculam-se ainda, uma a uma e para cada célula da malha, as
pressões nas fases água p e gás p . Conclui-se o processo analisando-se a posição de cada bloco em relação aos contatos e a magnitude das pressões capilares nele existentes. Em função dos resultados as variáveis saturação de água S^, de gás	e
composições das fases líquida x e vapor y (m = lr2,) ia	m	c
da célula recebem diferentes valores iniciais. Assim para:
1)	Célula em região de água, ou seja seu topo é inferior ao contato água/hidrocarboneto, as variáveis ficam:
S = 1	; S ~0	; x = 0 e y = 0
w	g	m	m
2)	Célula na zona de transição água/hidrocarboneto: aqui a pressão capilar água/hidrocarboneto P = P - P no centro da célula será inferior à pressão capilar água/hidrocarboneto máxima P . Nesse caso a saturação de água S será obtida da
C H 0 III	W
curva de pressão capilar água/hidrocarboneto com valor que corresponde à Pcwo determinada para esse bloco. As demais variáveis ficam:
e
reservatório de gás
x
ffl
Y„
Hl
s = 1 - s 9
w
0
z m
0
e
reservatório de óleo:
ym
S = 0 s
x m
Verifica-se ainda, como recomendado
por
Kazemi
[83, se a
pressão do bloco é superior à
certificando-se assim da presença
pressão de saturação
de uma única fase
hidrocarboneto.
3)Célula se encontra totalmente em região de óleo, isto é, seu topo está abaixo do contato óleo/gás e sua base está acima do contato água/óleo e da zona de transição água/óleo (ou seja sua P &gt; P ). Nesse caso tem-se:
c w o c w o m
S = S .	; S = 0	; x = z e y = 0
nus	9	mm	m
Verifica-se também se a pressão do bloco é maior que a pressão de bolha.
4)	Célula está na região de gás, em reservatório de óleo, porém dentro da zona de transição óleo/gás: nesse caso a pressão capilar óleo/gás P = p - p do bloco é menor que a pressão
r	c g o	g	a
capilar gás óleo máxima P . Com P	obtém-se a S
r	3	cgom	ego	g
correspondente e as demais variáveis são iniciadas com:
S = S .	; x = x	e y ~ y
w wi	m ia	ffl m
s a t	sat
5)	Célula totalmente contida em região de gás:
em reservatório de óleo:		S = 1 9	; x « 0 m	e y = y m	m sat
em reservatório de	gás :	S = 1 9	í X ~ 0 ÍTi	e y = z J m	m
Aqui a pressão do	bloco	deve	ser maior	que a pressão de
orvalho, visto que apenas a fase gás existe.
A iniciação das variáveis da malha, como descrita até aqui, não levou em conta a existência de uma possível variação composicional no fluido com a profundidade por ação gravitacional. Esse fenômeno, que pode ser significativo em reservatórios muito espessos e para fluidos com elevado teor de frações leves, foi apontado por Wheaton [28] em recente trabalho. Esse autor apresenta uma técnica de iniciação de variáveis para modelos composicionais que contempla esse efeito, que, todavia, não foi implementada na presente versão do modelo.
5, PROPRIEDADES DE ROCHA E FLUIDOS
As equações do modelo composicional sob estudo incorporam variáveis que respondem pelas propriedades da rocha reservatório e pelo comportamento PVT dos fluidos nela contidos. Neste capitulo serão descritas as técnicas usadas na obtenção e utilização racional dessas propriedades. Enfatiza-se a aplicação da equação de estado de Peng-Robinson na geração de dados volumétricos e de equilíbrio entre as fases hidrocarbonetos.
5.1	Pressões Capilares
Os dados de pressão capilar água/hidrocarboneto e gás/óleo, cujas definições são apresentadas no item 3.3, foram fornecidos ao modelo através de tabelas em função da saturação de água (P = f(S )) e de gás (P ~ f(S )). Alguns c w o	w	ego	g
comentários sobre a aplicação dessas informações são desenvolvidos a seguir.
As curvas de pressão capilar usadas nos modelos de reservatório são, geralmente, obtidas a partir de análises petrofísicas de laboratório. Nesses ensaios são empregadas amostras de meio poroso e de fluidos que de alguma maneira possam ser consideradas representativas do sistema físico real,
isto é,	o reservatório	de	petróleo.	Em alguns casos de	
simulação	composicional,	no	entanto,	podem ocorrer	fortes
variações	nas composições	dos	fluidos que	, por sua vez,	alteram
os valores de tensão interfacial e de pressões capilares. Como exemplo pode-se citar os processos misciveis de recuperação.
Nesses casos os dados de laboratório deixam de ter validade
absoluta e servem apenas como uma
referência
Visando
considerar esse efeito alguns autores
métodos, cujo embasamento é fortemente
[6]t [11] propuseram
empírico , obj etivando
corrigir os valores de pressão capilar de forma a contemplar as variações da tensão interfacial. No presente trabalho esse tipo de correção não foi implementado porque julgou-se que os
modelos disponíveis apresentavam pequeno substrato teórico,
aliás como admitido por seus próprios autores.
Outra observação importante se refere a conhecida dependência da pressão capilar em relação ao histórico de saturações do meio poroso. Normalmente nos ensaios de laboratório as curvas de pressão capilar são construídas
através de processo de drenagem, onde um fluido não molhante
desloca outro molhante. Esses dados devem ser compatíveis com o
processo sendo simulado. Por exemplo, na simulação da depleção de um reservatório de gás e condensado, onde a fase líquida surge como consequência da despressurização do sistema (fenômeno de condensação retrógrada) devem ser empregados dados de pressão capilar gás/óleo gerados por técnica de embebição. Tal análise não é rotineiramente efetuada em laboratório sendo, portanto, difícil considerá-la em algumas situações.
5.2	Permeabilidades Relativas
As informações sobre permeabilidades relativas foram fornecidas ao modelo a partir de dados tabelados, como estes são normalmente gerados em laboratório.
razões
Por
experimentais - cuja discussão foge ao escopo deste trabalho -a caracterização do comportamento de fluxo de uma rocha, é, na maioria das vezes, obtida em ambiente bifásico. Ou seja, geralmente dois experimentos independentes são realizados em laboratório: num deles a amostra de rocha é analisada quanto ao escoamento de água e óleo (K^/K^) enquanto num segundo coexistem as fases gás e óleo (K^/K^) (este último quase sempre na presença de uma saturação de água irreducível). No reservatório real, entretanto, o escoamento pode ocorrer em ambiente trifásico com fluxo concomitante das três fases. Para contornar esse problema, algumas correlações empíricas [4] tem sido propostas, onde "correções" aos dados usuais de laboratório são feitas de forma a reproduzir a situação trifásica. No presente trabalho adotou-se o modelo II de Stone [4] que aproxima a permeabilidade relativa ao óleo k na r o presença de gás e de água por:
k = í k	+k)ík	+ k 1	- í k	+ k 1	(5.1)
r o ( row	rwj ( rog	cgj ( rw	rgj
Em (5-1) k e k são as permeabilidades relativas ao óleo e % r O H TN
à água obtidas em ambiente água/óleo e k e k são as permeabilidades relativas ao óleo e ao gás geradas na presença desses fluidos e sob saturação de água irreducível. Note-se que
a expressão (5.1) convergirá	para os valores	de	laboratório
desde que em:			
-ambiente bifásico água/óleo:	k	= 1, k	=0 r o s	r 9	logo	k = k r o	row
-ambiente bifásico gás/óleo :	k	- 1, k =0 r ou	r H	logo	k	- k r o	rog
A equação (5.1) implica em que k = r o
f(Sw,Sg)í
consequentemente admite~se que as permeabilidades relativas ás
fases gás e água são dependentes apenas de suas próprias
saturações, ou seja:
k = f (S ) r w	w
Como já comentado no item anterior sobre pressões capilares, aqui também podem ocorrer variações nos valores de permeabilidade relativa decorrentes de mudanças na composição dos fluidos. Pelas razões apontadas antes, esse efeito foi mais uma vez desconsiderado, apesar da existência de propostas empíricas [6], [11] de tornar as curvas de Kg/KQ dependentes da tensão interfacial.
O histórico de saturações, que como visto no item 5.1 afeta o comportamento capilar da rocha, também pode influenciar as curvas de permeabilidade relativa do tipo Kg/KQ. Assim sendo, nas simulações de reservatórios portadores de fluidos do tipo gás e condensado deve-se procurar empregar dados de K3/Ko obtidos por processo de embebição sempre que disponíveis.
5.3	A Equação de Estado de Peng e Robinson
Uma equação de estado pode ser definida, conforme Firoozabadi [29], como uma equação algébrica que permite a descrição das relações entre pressão, volume e temperatura tanto para uma substância pura quanto para misturas, nos
estados sólido, líquido ou gasoso. Sua aplicação permite a determinação direta de propriedades volumétricas (densidades), térmicas e das funções de fugacidade que, por sua vez, possibilitam os cálculos de equilíbrio de fases. Dentre as diferentes famílias de equações de estado propostas na literatura [24], as do tipo cúbicas ganharam maior aceitação na área de Simulação de Reservatórios [29] por sua maior precisão nos cálculos de equilíbrio de fases para as complexas misturas normalmente encontradas nas jazidas de petróleo. Entre as
cúbicas as mais comumente usadas são as de Redlich e Kwong [10] e sua variante de Soave [30], a de Peng e Robinson [7] e, mais recentemente, a de Schmidt e Wenzel [31]. Uma comparação das peculiariedades de cada uma delas foi desenvolvida por Firoozabadi [29].
No presente trabalho adotou-se a equação de estado de
Peng e Robinson, tanto por
ser ela frequentemente usada
em
simuladores composicionais
como também por apresentar melhor
desempenho em termos de
capacidade preditiva
de dados
volumétricos [29] quando comparada às variantes da
equação
de
Redlich e Kwong. A expressão matemática da equação
de Peng
Robinson é mostrada a seguir:
a(T)
v(v+b) + b(v-b)
(5-2)
R T
p	------
v - b
Onde pé a pressão,
Ré a constante universal dos
gases, v
e
é
o volume molar e T é
a temperatura absoluta. Os outros dois
parâmetros são obtidos a partir de duas propriedades criticas
fluido, geralmente temperatura
pressão,
sendo
depende ainda
temperatura
parâmetro
( * )
variável
ü , 5	C, 5 \
a(Tr,w) = 1 + m^ 1 ~ Tr J
(5.5)
m = 0,37464 + 1,54226 W+ 0,26992 w2
(5.6)
Em (5.5) T = T/T é a temperatura reduzida e em (5.6) w é o r c
chamado fator acêntrico, constante característica do fluido ou de cada um de seus componentes. Para misturas as seguintes regras são ainda usadas no cálculo dos parâmetros a e b:
		n c
	c	
a		£ a . x x.
		.	.	m,j	m	j
		J s 1
onde a	= í 1 - 6 1 a0'5 a0'5
mfj (	m,jj m j
n c b “ r b x , mm
(5.7)
(5.8)
Originalmente Q = 0,42747 e Í1 = 0,08664 porém, por vezes, tais a	b
valores são alterados quando esses parâmetros são usados como
variáveis em processos de regressão não linear visando ajustar a equação de estado a dados PVT obtidos em laboratório [18].
Os termos 5	. = 5. que aparecem na expressão (5.7)
m , j	J , m
são os chamados coeficientes de interação binária, utilizados em misturas, de forma a melhorar o desempenho da equação de estado [32]. Esses coeficientes são particularmente importantes guando m corresponde a um componente leve e j a componente de
maior peso molecular. Como os 0^ considerados variáveis primárias
e Q , os á	são também
b	m t j
[18] quando do emprego de
regressão não linear para ajuste de equação de estado.
Uma forma alternativa da equação de Peng e Robinson é
derivada a partir da definição do fator de compressibilidade Z:
P v
Z = ------
R T
(5.9)
Substituindo (5.9) na expressão original (5.2) e após conveniente rearranjo dos termos obtém-se uma equação cúbica em Z, equivalente à equação de Peng e Robinson dada em (5.2):
(5.10)
Onde:
A =
a p
b p
(5.12)
R T
5.4	Cálculo das Densidades
A determinação das densidades molares (p) das fases hidrocarbonetos, através de equação de estado, baseia-se na definição do fator de compressibilidade Z mostrada em (5.9). Assim tem-se que:
P
p =	= -------- (5.13)
Z R T
Onde Zé a raiz da equação cúbica (5.10). Para um fluido na região de duas fases a solução de (5.10) gerará mais de uma raiz, sendo que a maior corresponderá à fase vapor (Z^) e a menor (positiva) será associada à fase líquida (Zp .
Apesar do melhor desempenho da equação de Peng e Robinson na previsão de dados volumétricos, quando comparada às variantes da de Redlich e Kwong, este tipo de cálculo continua sendo, segundo Firoozabadi [29], um ponto fraco das equações de estado cúbicas. Tendo em vista esse aspecto, Peneloux et. alii. [33] e mais tarde Jhavery et. al.	[34 ], introduziram um
parâmetro adicional na equação de Peng e Robinson, de tal forma a promover uma ’’translação” no volume molar calculado procurando aproximá-lo para um valor mais próximo do real. Ou seja:
n
c
v ~ v - c	onde c = £ cx	(5.14)
mm
Onde v e v são os volumes molares corrigido e original e c é a translação. As constantes são próprias de cada componente da
mistura. Jhavery et. al. [34] indicam métodos para a determinação dos , alguns deles dependentes de informações de laboratório, o que torna as vezes difícil sua aplicação. Na falta dos c* a equação (5.14) retorna à forma original proposta por Peng e Robinson [7]. É importante realçar que a correção mostrada não altera as equações de fugacidade, usadas nos cálculos de equilíbrio líquido vapor, como demonstrado nas referências [33] e [34].
Na implementação do modelo composicional o cálculo das densidades de ambas as fases hidrocarbonetos foi desenvolvido com a equação de Peng e Robinson, apesar dos valores de densidade da fase líquida serem considerados de menor qualidade que os da fase vapor [31]. Não obstante existir uma correlação para o cálculo de densidade de óleo [35], ainda assim optou-se pelo uso da própria equação de estado por ser essa a solução empregada na maioria dos simuladores citados na literatura e pelo fato da correlação mencionada ser bastante antiga (1960). Incorporou-se ainda a possibilidade do uso do terceiro parâmetro comentada acima, que, todavia, não pode ser testada no presente trabalho por falta dos dados necessários à caracterização dos c . As massas específicas da fase água, por sua vez, foram fornecidos ao modelo como função da pressão.
Conhecida a densidade molar, de qualquer das fases, seu peso específico é facilmente calculado por:
n c
? = p g PM onde PM =	£ x PM	(5.15)
m= 1
Onde PM é o peso molecular do componente m. No Apêndice C são
apresentadas as derivadas da densidade molar e do fator de
compressibilidade Z em relação à pressão e à composição.
5.5	Cálculo das Fugacidades
0 conceito de fugacidade foi introduzido no item
3.2
quando da apresentação das condições de equilíbrio de fases. Na ocasião, resultou como a principal dessas condições a imposição de igualdade entre as fugacidades de cada componente do sistema nas fases líquida e vapor, ou seja:
A relação acima é usada em todas as etapas da simulação composicional, ora fazendo parte do próprio sistema de equações do modelo matemático, ora sendo usada quando dos cálculos auxiliares de pressão de saturação e de liberação ’’flash”. Não é difícil concluir-se, portanto, que o conceito em questão desempenha extraordinária importância na modelagem composicional.
Como já mostrado, a expressão que define a fugacidade em termos de pressão, volume, temperatura e composição é dada por:
ln
RT
R T J
V
Onde m,j « 1,2,
,n . Usando a equação de Peng e Robinson,
que relaciona as variáveis PVT, torna-se
possível a integração
da expressão
acima
obtendo-se:
ln
f ,
ml
2
n=1
ln
Z + 2,414 B '
ln
P xm m
f


(
Z - B j +
A
n c
E
x a n n, m
b
m

f
2 V 2 B
b
a
/
k

Z - 0,414 B
(5.17)
, b, A ,
B e Z
Os parâmetros
a,
definidos no
b
item
5.4 anterior.
que
aparecem em (5,17) foram
expressão (5.17) está
A
escrita em termos das frações molares do óleo o que
permite,
portanto, o cálculo da fugacidade do componente m
na fase
frações molares
Para a fugacidade
mesma, naturalmente
x por y .
m	m
As derivadas das equações de
da fase vapor
(f ) mv
que substituindo-se
fugacidade
em relação
as
a
à
pressão e ã composição, cujas deduções não são
apresentadas no Apêndice D. Essas derivadas
triviais, são
comporão os
elementos das n linhas inferiores de cada uma das submatrizes
c
diagonais principais da matriz jacobiana.
5.6	Cálculo das Viscosidades
As viscosidades da fase água foram fornecidas ao modelo era tabela, como função da pressão; já as das fases hidrocarbonetos foram calculadas pela correlação de Lohrenz et.
alii. [36]. Duas razões fundamentaram a escolha desse método: o primeiro diz respeito a sua aceitação por outros autores de formulações composicionais, entre eles Coats [6] e Nghiem et. alii. [11]. 0 segundo, e mais importante, está ligado a sua forma de apresentação, qual se j a, expressões matemáticas facilmente deriváveis e de simples implementação num algoritmo computacional. 0 mesmo não se pode dizer da correlação de Carr et.alii. [37] - aplicável apenas a fase vapor ~ cujos dados são dispostos em gráficos. Uma terceira correlação, a de Lee et. al. [38] - constituída de um conjunto de equações, porém concebida apenas para gases - chegou a ser testada. Seus resultados, porém, foram semelhantes aos obtidos pelo método de Lohrenz et. alii. Optou-se assim pelo último que é aplicável para líquidos e gases.
0 procedimento de Lohrenz et. alii. descreve a viscosidade como dependente da pressão, temperatura e da composição do fluido. Conhecidas essas variáveis, o método consiste das seguintes etapas:
a)Determinação das viscosidades (p*) dos componenetes puros a baixa pressão e na temperatura de interesse: para cada fração calculam-se:
M = 34xl0'5 T0'94	para T &amp;lt;1,5	(5.18)
m m	rm	rui
5/8
p* t = 17,78x10 514,58T	- 1,67| para T &gt; 1,5	(5.19)
m m	(	nti	)	rm
Onde T « T/T é a temperatura reduzida do componente m. 0 r si	c m
parâmetro auxiliar Ç em (5.18) e (5.19) ffl
&gt;*	.....	CHI
■ ' pm’/2f¿!
ir cm
é definido por:
(5.20)
Em (5.20) a pressão crítica P deve ser dada em atmosferas e a c m
temperatura crítica Tc|n em graus Kelvin (a mesma unidade da
temperatura T do sistema).
*
b)Cálculo da viscosidade da mistura (u ) a baixa pressão e na
temperatura de interesse: usando os valores obtidos na etapa
anterior determina-se:
★
M “

n
*
X M m m
ZpJF
n?
(5.21)
Onde aqui os x^ são as
frações molares dos componentes do
fluido (seja ele líquido ou gasoso).
Na sua versão original,
a correlação de
Lohrenz et.
alii. [36] propõe, ao final
da etapa b,
procedimentos
diferentes para
o cálculo de
viscosidades de
gases e de
líquidos. Para
misturas gasosas os autores
sugerem a
determinação do
valor da viscosidade a partir
de gráficos
propostos por Baron et. alii. [39]. Para líquidos Lohrenz et, alii. desenvolvem um método próprio, baseado na densidade do fluido, que será detalhado a seguir. Segundo argumentação de Lohrenz et. alii., a razão de ser desses procedimentos diversos se deve apenas à dificuldade de obtenção de valores precisos de densidades da fase gás, existente na época da publicação da sua correlação (1964). Removido esse impedimento a metologia para líquidos e gases poderia ser a mesma [36]. Assim sendo, no presente trabalho adotaram-se procedimentos idênticos para o cálculo das viscosidades das fases líquida e vapor, uma vez que os dados de densidade do gás, obtidos via equação de estado de Peng e Robinson, podem ser considerados de boa qualidade. Essa opção também foi seguida por Coats [6] e Nghiem et. alii. [11] em seus modelos composicionais. Isto posto, o método de Lohrenz et. alii. prossegue na sua etapa c:
c)	Cálculo da densidade da mistura (p) na pressão e temperatura de interesse: como comentado anteriomente, esse dado é provido pela equação de estado de Peng e Robinson. Observação importante é a de que p deve ser usado com unidade do sistema inglês, qual seja libra mol por pé cúbico (lbmol/pé3).
d)	Cálculo da densidade reduzida da mistura, definida por:
(5.22)
Onde p', densidade pseudocrítica da mistura, e V' são definidos
camo:
(5.23)
Onde é o volume crítico do componente m
(em pé3/lbmol).
e)Cálculo da viscosidade da mistura na pressão e temperatura de interesse: nessa etapa, a última, determina-se a viscosidade p, em centipoise, corrigindo-se o valor de ¡1* obtido antes por:
[	2	3	4 ) 4
a + a p + a p + a p + ap - a
* + l 0	1 r 2 r 3r 4 r J 5
C
Na expressão (5.24) constantes iguais a:	os	parâmetros	&amp;amp;	(j =	0,1,..,5) São
aQ -	0,1023000	;	ai =	0,0233640	;	a2 «	0,0585330
a3 = -0,0407580	a4 =	0,0093324	;	a5 =	0,0001000
O parâmetro auxiliar Ç, denominador em (5.24),
é definido como:
(5.25)
As expressões das derivadas da viscosidade em relação à pressão e composição são desenvolvidas no Apêndice E.
5.7 Cálculo de Pressões de Saturação
A pressão de saturação é definida como sendo a pressão, a una dada temperatura, onde um fluido inicialmente monofásico passa a coexistir com uma segunda fase. Estendendo essa idéia definem-se ainda a pressão de bolha, aquela onde um líquido passa a coexistir com uma quantidade infinitesimal da fase vapor, e pressão de orvalho, aquela em que um gás passa a coexistir com uma quantidade infinitesimal da fase líquida.
0 conceito de pressão de saturação é importante na simulação composicional pois através dele pode-se identificar o número de fases presentes numa célula e, consequentemente, o conjunto de equações aplicáveis. No item 4.4 foi detalhado o tratamento dispensado ao modelo matemático de forma a contemplar as situações de células com fase única e células na região de duas fases.
O cálculo da pressão de saturação, baseando-se na sua definição, consiste na determinação da pressão em que as fases líquida e vapor estarão em equilíbrio, sob temperatura conhecida, quando sujeitas às seguintes condições:
-para a pressão de bolha :
x ; m
-para a pressão de orvalho:
V - 1 logo z
m
» y ;
ffi
Onde m=l,2,....,nc, LeV líquida e vapor (L + V = 1)
são as frações
molares
nas fases
z é a
IH
fração molar
global do
e
componente m, definida por:
onde
z = Lx + Vy m	m	m
n c
E Z = 1
Ml m
(5.26)
O problema posto acima é
modelado
através
das
relações de equilibrio:
f - f » o mi	mv
(5.27)
E das equações restritivas:
n		n	
c		c	
E x. =1	ou	Z ym = 1	(5.28)
m - 1		■ ,ti m= 1	
Onde as nc+ 1 incógnitas são a pressão de saturação e as composições da fase, dita '"ausente*', em equilibrio com a predominante, Ou seja, para um liquido calculam~se a pressão de bolha e a composição da fase vapor (y ). Para um gás s a t
determinam-se a pressão de orvalho e a composição da fase liquida (x ).
sat
A solução do sistema composto por (5.27) e por urna das equações em (5.28), aparentemente simples, é na realidade bastante complexa devido a forte não linearidade em (5.27) e a dificuldade de representação do comportamento de fases, através de equações de estado, em região próxima ao ponto crítico. Dois métodos de solução, ambos	iterativos,	são normamente
empregados: um deles é conhecido por substituição sucessiva (SS) e o outro é baseado no procedimento de Newton-Kaphson. o método SS, rotineiramente citado nos compendios sobre Termodinâmica Clássica [24], tem as	vantagens de ser
extremamente simples e possuir menor sensibilidade à estimativa inicial do vetor solução; apresenta, porém, a desvantagem de uma baixa velocidade de convergência. 0 segundo
método, introduzido num excelente artigo por Fussel e Yanosik [40], possui rápida convergência, entretanto, é roais sensível à qualidade da estimativa inicial. Este problema se agrava quando a pressão de saturação do fluido se encontra próxima da
região critica. Nesse caso é muito comum obter-se uma				solução
trivial para o sistema em		(5.27), ou seja:		
x =		para m =1,2..... ,n		
m	ÍT)			
que apesar de ser raiz	do	sistema, não caracteriza	uma	solução
física para o problema	•			
Considerando	as	características dos dois		métodos,
Nghiem et. alii. [41] desenvolveram um processo híbrido que, iniciando as iterações no método SS e concluindo o cálculo, se necessário, por uma variante do método de Newton-Raphson, combinou as vantagens inerentes a cada um dos procedimentos originais.
No presente trabalho adotou-se a idéia de Nghiem et. alii. adaptando seu algoritmo de forma a executar um número fixo de iterações do tipo SS seguido do número necessário de iterações com o método de Newton-Raphson. Essa solução permitiu contornar muitas situações onde o procedimento Newton-Raphson de forma isolada convergiria para a resposta trivial. Ambos os métodos são detalhados a seguir, iniciando-se pelas etapas do cálculo SS:
a)Entrada dos dados de temperatura, tipo de fluido (liquido ou gás) e sua composição, e estimativas iniciais da pressão de saturação e da composição da fase ausente;
b)Cálculo das constantes de equilíbrio K (m ~	l,2,...,n )
através da expressão [24]:		
* £ ' v -	mt	[ P Y, ]	f y  »t *■»
m PXm	f ÍHV	'	3•¿y y f	X mv m
Onde y e x são as composições das fases; na primeira iteração R IR
usam-se os dados fornecidos na etapa a e nas demais os valores originais da fase predominante e os corrigidost como descrito a seguir, da fase ausente.
cJFazendo uso da definição de constante de equilíbrio
[24]:
Zü
X m
K
m
(5.30)
calculam-se então
os valores corrigidos da composição
da fase
ausente através dos K recém determinados na etapa m
b,
ou seja:
-no cálculo da pressão de bolha, a fase líquida x
não
muda e a
vapor é a ausente, logo:
yU+1 = K x
m	m
m
(5.31)
-no cálculo da pressão
de orvalho, a fase vapor
não se
altera e a líquida é a
ausente logo:

xu+1 = y /K
m	m m
(5.32)
d)	Verifica-se a convergência do processo; para a pressão de bolha:
n
| 1 “ r	| &amp;lt;tolerância e j yu+1- yu | &amp;lt;tolerância
* »i	* In	m 1
»SS t
(5.33)
e para a pressão de orvalho:
Fí
C
I 1 "I x^1 I &amp;lt;tolerância e I xu+1~ xv I &amp;lt;tolerância
’	, m '	1 tn	m f
m= 1
(5.34)
Atendidas as exigências em (5.33) ou (5.34) as iterações se u+i	u+1
encerram ex = x ouy = y , conforme o caso. Caso m	m	m	m
sat	s a t
contrário segue-se para a etapa e.
e)	Ajuste da pressão: um critério empírico que foi adotado consiste em:
	n							
-para	r,	U+ 1 E xm m= 1	ou	« m m- 1	&gt;	1 , conforme	o caso,	a nova	pressão
será	n + 1 P	cpu	onde C &gt;	1	(entre 1,05 e	1,50);		
	n c		n c					
-para	£	ou		&lt;	1 , conforme	o caso,	a nova	pressão
	m-1		m= 1					
será	-	CPU	onde C&amp;lt;	1	(entre 0.80 e	0.98).		
	Retorna-		-se então	para a etapa b		ou segue-se		para o
algoritmo de Newton-Raphson caso tenham se esgotado o número máximo de iterações SS estipuladas. A aplicação deste segundo procedimento, cujo teoria foi descrita no item 4.2, baseou-se nas equações (5.27); eliminando-se uma variável composicional
através das retrições em (5.28). Assim no cálculo de pressão de
bolha fez-se:
y1
1
n c
E Ym
m = 2 •
e para a pressão de orvalho:
1
X n
c
n - 1 c
E \
■ -1
As funções de resíduo
e os elementos da matriz
F
m
jacobiana J , serão: m , j
-Para a pressão de bolha:
f m v
f m l
3f
mv
3f«
e
J
J 1
m, 1
Ôf mv
m , }
Onde m =
-Para a
onde m =
ôp
ôp
9y
j
1,2,...,n e
c
pressão de
3f..
ap
1,2,... ,n
c
2,3,.
orvalho:
Ô£
mv
af ml
ap
ÔX.
1
e 1 — 1,2,****n
-1.
c
J
m , 1
j
-
c
F = f m	m l
f
ffi V
e
J . ,
m , j + 1
Na análise
da convergência do processo, além das
verificações usuais
nas correções da pressão ôp e das frações
molares Sx ou ôy, um critério adicional é usado, qual seja:
&amp;lt;tolerância
5.8 Cálculo de Liberação Instantânea "Flash*'
Uma liberação "flash*' pode ser definida como sendo um processo de separação de um fluido, decorrente de uma variação na pressão ou na temperatura do sistema, mantendo-se sua massa constante. 0 cálculo "flash", por sua vez, é o procedimento matemático que, a partir da composição inicial do fluido e das novas condições de pressão e temperatura a que ele passa a estar sujeito, permite a determinação das composições das fases em equilíbrio bem como as frações molares nas fases líquida (L) e vapor (V) resultantes da liberação.
0 cálculo "flash" implementado no presente trabalho baseou-se na combinação dos métodos de substituição sucessiva SS [24] com uma variante do de Kewton-Raphson, proposta por Fussel e Yanosik [40]. Ou seja, o processo se inicia com um número fixo de iterações do tipo SS passando a seguir, caso não se alcance até então convergência, para o procedimento de Newton-Raphson. Como visto no item 5.7, essa solução objetiva conjugar a simplicidade do método SS, apesar de sua lenta convergência, com a robusteza do procedimento de Newton-Raphson, ainda que dispendiosa em termos de esforço computacional.
o modelo matemático para uma liberação "flash" é composto pelas seguintes equações, para m = 1,2,....,n:
f , - f -- 0	(5.35)
ml	m v
Z = 1X + Vy	(5.36)
m	ift	ín
L + V = 1
(5.37)
Sendo z^ a fração molar global e L e fases líquida e vapor. Complementa
V as frações molares nas
o modelo
uma
das três
restrições a seguir:
n c
E z
(5.38a)
(5.38b)
(5.38c)
equilíbrio
constante
y /x
(5.40)
£
E y
I Y
definida
acima
A expressão
como
serç
ser igual a zero:
í(L)
0
teoricamente, deve
E x
Usando o conceito
equações (5.36)
Fazendo agora (5.38b)-(5.38c) e substituindo
na diferença,
obtém-se:
n c
n c
As expressões (5.39), (5,40) e (5.41) deduzidas acima são importantes no método SS, cujas etapas são descritas a seguir:
a)Entrada dos dados de pressão e de temperatura da liberação e da composição global da mistura. Estimativas das frações molares L, V, x e y também devem ser fornecidas, mesmo que de baixa qualidade;
b)Cálculo das constantes de
equilibrio K
m
(m
1/2,*..,nç)
através da expressão [24]:
f	i		í P y
m 1		m
p X		f mv J
(5.42)
c)Calculam-se a seguir, usando os da etapa b, a função í(L), expressa em (5.41), e a derivada í'(L) de 5(L) em relação a L. Com estes dados determina-se um novo valor para L:
Í(L)
í'(L)
(5.43)
Ou seja, Lu+1 é obtido através da técnica de Newton-Raphson em que se faz uma única iteração. Caso Lu+1 &amp;lt;0 este assume o valor de Lv/2, se Lu+1 &gt; 1 admite-se que Lu+1 = (Lu + l)/2;
d)Calculam-se então os novos valores das composições das fases líquida xv+1 e vapor yu+1 através das equações (5.39) e (5.40), m	m
usando os K recém determinados na etapa b e o Lv+1 obtido no
passo c;
e)Verifica-se a convergência do processo através de:
( $(L)	| &amp;lt;tolerância	(5.44)
| xu+1 - xu | &amp;lt;tolerância	(5,45)
1 m	m *	'	'
I yU+1 ~ yU I &amp;lt;tolerância	(5.46)
’ fft	m 1	'
Atendidas as condições em (5.44), (5.45) e (5.46) as iterações se encerram. Caso contrário retorna-se a etapa b ou passa-se para o algoritmo de Newton-Raphson, caso tenham se esgotado o número máximo de iterações SS prestabelecidas.
A implementação do procedimento Newton-Raphson seguiu estritamente o preconizado por Fussel e Yanosik [40]. Esses autores conceberam uma variante do método original, denominada de “mínimum variable Newton-Raphson - MVNR'*. Em essência o procedimento consiste na redução do número de variáveis e de equações, ditas primárias, que são efetivamente desenvolvidas segundo a técnica de Newton-Raphson. As demais incógnitas do problema, as secundárias, são determinadas em função das anteriores através de equações secundárias. Dois grupos de variáveis primárias são definidos:
-grupo I0C, indicada para fluido predominantemente vapor, constituído por L e x„ a x ; as demais variáveis (V, x. e y. a ir	2	n	1	J 1
c
y ) são secundárias;
J n '
c
-grupo VY, indicada para fluido predominantemente liquido, composto por V e y? a ; as demais variáveis (L, y^ e xi a
c
x ) são secundárias;
n
c
As equações primárias, para ambas as classes acima, são as de
equilíbrio liquido vapor mostradas em (5.35); as restantes, (5.36), (5.37) e (5.38b) ou (5.38c), são as secundárias. Ao fim de cada iteração newtoniana as variáveis secundárias são atualizadas em função dos valores recém determinados para as primárias, usando aquelas equações tratadas de forma secundária. As funções de resíduo e os elementos do jacobiano para os dois grupos definidos acima são deduzidos a seguir:
-Para o grupo LX: as
funções de resíduo são
as próprias
relações de equilíbrio,
ou seja F = f - f . Os elementos da m	mi	m v
matriz são obtidos por:
% ôf
I-----—
j = z 5y
3y j
ÔL
(5.47)
sy.
Em (5.47) o termo -------i
3L
é obtido através das relações (5.36)
(5.37) :
e
logo
(5.48)
j

J
Substituindo (5.48) em (5.47) obtém-se:
n c
I
j = 2
3f
mv
(5.49)
Os demais elementos da matriz
jacobiana são definidos por:
J
ôf ôf ay.
ml _ ______mv j
ax.	ay.	ax.
j	j j
(5.50)
ayj
Em (5.50) a derivada ---------
ôx.
3
é
obtida coei o auxilio de
(5.36):
%
8
ÔX
i
ÔX. J
z. - Lx.s
J—1
1 - L '
L
V
(5.51)
Substituindo
(5.51) em (5.50)
obtém-se finalmente:
J m , j
ôf mi t
----- 4-
ax.
i
L Ôf
mv
v ay.
(5.52)
Onde m = 1.2,...,n e j = 2,3,....n
c '	c
-Para o grupo VY: as funções de residuo
são
as mesmas
do grupo
LX; os elementos
da matriz são:
3 í
j « ------------ f
ns, 1	(	m l
m l
- f 1
mv)
ôx. }
SV
% Sf ,
j « 2 ÔX.
j
Sx
3V
Onde em (5.53) a
ÔX.
derivada -----
ÔV
(5.53)
é obtida empregando as relações
(5.36) e (5.37):
z. - Vy. j
3
1 - V
logo
Ôx
SV
Substituindo
(5.54) em (5.53)
1
J „ — ffi , 1	T
JLi
n c
E
j = 2 ÔX. J
Sf ml
h ■ yj
x. - y. j j
L
(5.54)
obtém-se:
(5.55)
Os demais elementos da matriz jacobiana ficam:
	8 f	1	.	ÔX	3f	
t		 -f	_ -f |		ml	J	mv	
	j	g ( Ml	ffivj J 3	ÕX. J	ay J	%	1 O « Ju
		ôx.	V		
Em	(5.56) a derivada		- 		- é	obtida	diretamente de
		ay. 3	L		
(5.51). Usando esse resultado em (5.56) chega~se a:
V	df	3f
J	T Xj	mi	mv
	3X. J	%
(5.57)
Onde m = 1,2,...,n e j ~ 2,3,....n .
c	c
Como feito
no cálculo da
pressão de saturação,
verificação da convergência das
iterações contou com
um
a
critério adicional qual seja
n	-
f
fn = 1	*■ mv
x 2
&lt;
tolerância
Concluindo essa exposição é importante observar que é recomendável, por vezes, dividir um processo de liberação em estágios intermediários quando as condições inicial e final do sistema são muito distantes. É o caso, por exemplo, da simulação da liberação de um fluido da condição de reservatório diretamente para a de superficie. 0 cálculo pode apresentar problemas de convergência, em especial quando não se tem uma estimativa ao menos razoável do vetor solução.
6. ESTRUTURA LÓGICA DO MODELO COMPUTACIONAL
Este capítulo destina-se a
comentar, ainda que
sem
muitos detalhes, o desenvolvimento
da estrutura
lógica
do
modelo computacional implementado.
Essa análise
teia
sua
importância pois, apesar de não trazer novidades
quanto
ao
tratamento do problema em si, demonstra como o conjunto
de
conceitos e hipóteses - substrato
do modelo matemático
sob
estudo - foi resumido e combinado
de uma forma objetiva e
lógica .
Na concepção do programa
computacional, escrito em
linguagem FORTRAN, priorizaram-se dois aspectos:
-Máxima modularidade visando facilitar sua
teste, manutenção e eventual extensão;
-Otimização da demanda de memória, meta que foi
não comprometimento da eficiência em termos de
processamento. Esses itens sâo particularmente
implementação,
balizada pelo
velocidade de
importantes na
simulação composicional dado o elevado número de equações
envolvidas.
Isto posto, serão descritos a seguir os módulos funcionais incorporados no sistema computacional, cada qual composto por uma ou mais unidades de subprogramas, A ordem de exposição guarda absoluta correspondência com a efetivamente implantada. Assim tem-se:
1)Leitura dos dados de entrada: basicamente constituídos pelas características geométricas, petrofísicas e de temperatura do reservatório, dados sobre os poços de produção e/ou injeção, condições de separação de fluidos na superfície, parâmetros de
simulação, composição e propriedades dos componentes do fluido original e do eventualmente injetado no reservatório e dados PVT da fase água.
2)	Tratamento das unidades dos dados de entradat uniformizando-as para o sistema Internacional.
3)	Lançamento da malha de simulação, tarefa composta pelo cálculo das posições e cotas dos pontos de malha, volume dos blocos e fatores geométricos das interfaces das células. Leva-se em conta, obviamente, o tipo de discretização da malha a ser usado, se radial ou cartesiano.
4)	Cálculo dos índices de produtividade dos poços, caso estes não sejam fornecidos diretamente como dados de entrada.
5)	Cálculo dos parâmetros da equação de estado de Peng e Robinson dependentes apenas das propriedades criticas dos componentes. Ou seja, variáveis que não se alteram durante a simulação.
6)	Inicialização das variáveis pressão, saturações de fluídos e composições para cada célula da malha. Segue-se procedimento discutido em detalhes no item 4.6. Nesta unidade cria-se ainda uma matriz auxiliar (matriz de ponteiros) que servirá para identificar o número de fases hidrocarbonetos presentes na célula. Para as de fase única registra-se também o tipo de fase existente, se líquida ou vapor. Essa matriz, de extrema importância no controle da montagem da matriz jacobiana, é atualizada a cada iteração como será descrito futuramente.
7)Determinação dos volumes porosos originais dos blocos usando
as porosidades corrigidas para o efeito da pressão de sobrecarga através da constante de compressibilidade da rocha.
8)Cálculo da reserva mássica (em Kg moles) de cada um dos componentes hidrocarbonetos no reservatório.
9)Determinação dos parâmetros composicionais iniciais das fases
hidrocarbonetos líquida e vapor nas condições de separação dos
fluidos
frações
molares Ls e V«. Este cálculo consiste de
’’flash"
sobre o fluido inicial,
desde a condição de
pressão e
temperatura de reservatório até
o estágio final de
separação.
0 procedimento é executado em
etapas uma vez que não se
dispõem ainda de boas estimativas desses parâmetros. Ao final
os resultados são armazenados pois servirão como estimativa inicial para o próximo cálculo iterativo dessas variáveis.
10)Montagem das matrizes auxiliares necessárias ao uso da rotina NSPÍV [26] de resolução de sistema esparso de equações.
lljlmpressão de controle, em arquivo auxiliar, dos dados de
entrada e das variáveis iniciais das células.
12)Inicialização de variáveis auxiliares de controle da
execução	da	simulação		como f	por exemplo,	contadores	de
iterações	e	de passos	de	tempo,	de acumulação	de tempo e	de
controle	de	impressão	de	resultados.			
	Ao	fim da	etapa 12		concluem-se	os procedimentos	
preliminares da simulação. As próximas etapas, que se repetem a cada passo de tempo e dentro deles a cada iteração, constituem o processo de simulação propriamente dito.
13)Ponto de retorno ao finí de um passo de tempo bem sucedido;
incrementa-se o	contador de passos de tempo e reinicia-se com
zero o contador	de iterações.
14)Ao inicio de	cada novo passo de tempo as variáveis de cada
célula da malha	assumem os valores daquelas recém determinadas
no passo de tempo anterior (ou dos valores iniciais no caso do
primeiro passo). 		f	. Ou seja, para todo par i,k: TT n + 1 f 1 Jnr	X? ft A „	« A i , k	i,k T
Onde X, = p , i , k	[ c	%' SH' xr	xn	y2,	yn J. C	€7
Os sobrescritos	n+1,1 e n indicam, respectivamente, a primeira
iteração do passo de tempo n+1 e iteração final do passo de tempo n. Atualizam-se ainda os volumes porosos dos blocos.
15)Controle do número de fases em cada célula e atualização da matriz de ponteiros através de:
a) determinação da pressão de saturação nas células de fase única usando a técnica descrita no item 5.7. 0 objetivo é o de verificar se esta célula se manteve nessa condição, fase única, ou se as eventuais alterações ocorridas na composição e/ou na pressão do bloco levaram ao surgimento de uma segunda fase. Duas situações são possíveis [6], [9], [11]:
-a pressão do bloco é maior que a pressão de saturação calculada: nesse caso a célula permanece com fase única. A matriz de ponteiros não se altera e os resultados de pressão de saturação e de composição da fase ’’ausente” são armazenados para uso como estimativa inicial num próximo cálculo de pressão de saturação;
~a pressão do bloco é menor que a pressão de saturação calculada: nesse caso a célula entra na região de duas fases. A matriz de ponteiros passa a refletir essa nova situação. Como recomendado por Jones et. al. [42] executa-se a seguir um cálculo ’’flash” de maneira a se determinar as composições das duas fases em equilíbrio; obtém-se ainda uma estimativa da saturação de gás através de:
s = s
b)nas células com das saturações de de uma das fases.
-se Sg s 0 calcula-se a pressão de bolha do sistema que é então comparada com a pressão do bloco como descrito acima. Concluindo-se pelo desaparecimento da fase gás atualiza-se a matriz de ponteiros que passará a indicar a presença de fase única líquida. A composição da fase gás, agora ausente, e da pressão de bolha são armazenadas para uso como estimativa inicial no cálculo da mesma na próxima iteração. Se for negativo ajusta-se seu valor para zero;
L/p V/p o	'g
1
fases verifica-se, através
ocorreu
evolução
desaparecimento
-se S + S ^la fase líquida deve ter desaparecido.
Verifica-se através do cálculo da pressão de orvalho do sistema
e pela comparação desta com a pressão do bloco. Obtida resposta
conclusiva a matriz de ponteiros passa a indicar a presença da fase única vapor; a composição da fase líquida, agora ausente, e da pressão de orvalho são retidas para uso futuro como estimativa inicial num próximo cálculo semelhante. Caso ocorra
gue Sg+ s* &gt; 1 ajusta-se para =
1
s
w
16)Para cada célula da malha calculam~se a seguir as densidades
molares das fases liquida e vapor (p e p ) e de suas 0 8
derivadas em relação à pressão (ap^/ôp e õp /ôp) e em
relação
à composição (ap /ax, para j = l,2,...,n -1 e ap /ay para í 0 J	c	8 J
2,3,...,n ), Usam-se como insumos os valores de pressão p e C	(J
composições x e y (m =	1,2,..... n	) da iteração em
ÍR	KJ	C	*
desenvolvimento. Caso esta seja a primeira iteração de um passo
de tempo associa-se ainda:
Pf = onde f " °'g
Visando não duplicar esforço na resolução da equação de Peng e Robinson, ao final do cálculo das densidades e de suas derivadas verifica-se, através de teste com a matriz de ponteiros, se a célula em questão está na região de duas fases. Caso positivo aproveitam-se os dados recém obtidos dos fatores de compressibilidade e Z^, bem como de suas derivadas, e determinam-se as fugacidades dos componentes em ambas as fases (f , e f ) e suas derivadas. Esses valores são então dispostos nos elementos das submatrizes Au e Ari e
1 , K í , k
do vetor Ri. . definidas no item 4.3. Estas submatrizes fazem i , k'
parte da matriz diagonal principal correspondente à célula i,k da matriz jacobiana total. Nas células de fase única as submatrizes Au e Ari são montadas como descrito no item 4.4 e o vetor Ri é anulado.
Resumindo, o módulo descrito acima além de prover os dados de densidade e de suas derivadas que serão necessários quando do cálculo das equações de fluxo e dos termos fonte, é ainda responsável pela montagem das partições da matriz jacobiana referentes às relações de equilíbrio líquido vapor.
17)	Determinação, para cada célula da malha, das propriedades petrofísicas, permeabilidades relativas e pressões capilares e de suas derivadas era relação às saturações de água e de gás. Empregou-se a técnica de interpolação linear em tabelas.
18)	Determinação das propriedades PVT da água ~ peso especifico, inverso do fator volume de formação e viscosidade - para cada célula da malha. Novamente usou-se o método de interpolação linear.
19)Cálculo	das viscosidades	0	eu	e 9	de	suas	derivadas	em
relação à	pressão e à	composição.		Segue-se		procedimento	
descrito no itera 5.6.							
20)Cálculo	dos termos fonte	q o	e q e 9	de	suas	derivadas	em
relação à	pressão, saturações		de gás e	de	água e	em relação	às
composições. Esses dados são então armazenados em matrizes auxiliares com indexação ligada às coordenadas das células definidas como contendo um poço. O método de cálculo, detalhado no itera 4.5, é dependente do tipo de condição de contorno imposta. Para o caso de vazão especificada na superfície são realizados cálculos "flash" de forma a se obter os parâmetros composicionais do fluido produzido.
21)Montagem do sistema de equações, o procedimento, executado célula a célula, é composto pelas seguintes etapas:
-cálculo das diferenças de potencial e de suas derivadas;
-cálculo das transmissibilidades e de suas derivadas;
-determinação das frações molares nas fases líquida e vapor nas interfaces da célula (com um ponto a montante). Usam-se para tanto dados de x e y da iteração em desenvolvimento;
-cálculo das equações de fluxo e construção do vetor Ru . os i , k
termos fonte são acrescidos às equações caso a célula possua poço;
-determinação das derivadas das equações de fluxo em relação às variáveis primárias, considerando-se também as dos termos fonte se for o caso. Os valores obtidos são dispostos nas submatrizes Auí. , , Aru. , f Elu. . f Ciu, ,Biu. , e Diu. , definidas	no
item 4.3. Verifica-se, ao longo dos cálculos, se a célula em questão e as suas vizinhas possuem uma ou mais fases visto que o tratamento nas variavais S e y ou x pode se alterar em s 2	n * 1
c
função do número de fases presentes em cada célula. Os detalhes do método foram vistos no item 4.4.
-execução das operações matriciais deduzidas no item 4.3 obtendo-se ao final as partições referentes ao bloco i,k da matriz jacobiana e do vetor termo independente reduzidos. Nessa etapa usam~se também as submatrizes Au. , e Ari. , e o vetor &gt; , k	i , k
Ri construídos conforme mostrado na etapa 16 deste roteiro.
i . k
-armazenam-se finalmente as submatrizes necessárias	à
determinação das incógnitas camposicionais da célula que, como visto no item 4.3, serão obtidas em função da solução gerada a partir da matriz jacobiana reduzida (etapa 22).
22)	Solução do sistema de equações composto pela matriz jacobiana e vetor termo independente reduzidos, gerando-se as correções Jôp^, ôSg ou Sxn1 ou 6y2, ssj para cada célula da malha. Como citado, empregou-se nessa etapa a rotina otimizada NSPIV [26].
23)	Atualização das variáveis primárias seguida da determinação dos valores das demais incógnitas através das equações
matriciais deduzidas no item 4.3. Ao mesmo tempo verifica-se a convergência da solução e comparam-se as magnitudes das correções ôx com valores limites, fornecidos como dados de entrada. Essa verificação objetiva impedir que as incógnitas assumam valores absurdos, fato que pode ocorrer caso a solução do problema fique instável. Dectetado o problema o passo de tempo em andamento é interrompido e reiniciado com um incremento de tempo At reduzido.
24)	Obtida convergência segue-se para a etapa 25; caso contrário incrementa-se o contador de iterações e retorna-se à etapa 15. Caso o número de iterações acumuladas no passo de tempo em andamento ultrapasse um valor limite, este é recusado e reiniciado com um incremento de tempo At reduzido.
25)	Cálculo das produções mássicas acumuladas por componente a partir dos resultados de vazão e de At usados na simulação. Kepete-se esse cálculo, desta vez por balanço de materiais.
26)	Controle de impressão de resultados e, se for o caso, gravação dos mesmos em arquivos de saída. As vazões de superfície são reavaliadas como mencionado no item 4.5.
27)	Controle do passo de tempo At para o próximo passo. Esta operação pode manter o At ou aumentá-lo conforme se tenha:
-o número de iterações acumuladas do passo recém concluído é menor que um valor limite prestabelecido;
-as máximas variações ocorridas nas variáveis ao longo do passo recém concluído se mostrem inferiores a limites prefixados.
28)	Controle do período de simulação: esta pode se encerrar ou prosseguir em um novo passo de tempo retornando-se à etapa 13.
Finalizando este capítulo, merece ser observado que a etapa crítica do processo é a 15 - controle do número de fases por célula - uma vez que esta verificação é determinante quanto a montagem do sistema de equações.
7. VALIDAÇÃO DO MODELO
A validação do modelo desenvolvido baseou-se na teoria do escoamento bifásico era regime permanente, em particular no tratamento dado a esse problema por Chopra et. al. [43]. A mesma técnica foi posteriormente aplicada por Jones et. al. [42] na validação de um simulador composicional para o estudo da resposta de poços de gás e condensado durante testes de pressão. Antes da apresentação dos resultados propriamente ditos, a teoria citada acima será revista seguindo a metodologia concebida por seus autores.
7.2 Teoria do Escoamento Bifásico em Regime Permanente
As equações de balanço de massa para um sistema
bifásico constituído de nc componentes hidrocarbonetos, capilares,
desconsiderando os efeitos
gravitacionais e de
dispersão,
são escritas por:

a
K X x
o m
(
+ K X y I Vp - q*
8 in I	m
at
?o
S	x + p S y I o m	g g m J j

(7.1)
Onde
m —*■ 1,2 ......n . A f r	’ c
parcela
dada
em termos de vazão
molar
fonte q*
m
por unidade
na
de
equação
acima é
volume de
rocha
Sabendo-se que
n c
s y.
m = 1
1,
a soma
das
n c
expressões
n c
T. x*
m=1
(7.1) fornece a equação de balanço global:
d
3t [ H PA + PA ) ]
(7.2)
No regime permanente não existe acumulação de massa ao longo do reservatório, logo:
--- [ 0 í p S x + p S y ll=o
8t L l ° 0 m 9 3 m J J
Para m =	. Da mesma forma tem-se:
M p.S. + PsSs ) ] - 0
(7.3)
(7.4)
Não havendo produção de massa ao longo do reservatório a não ser no poço, representado pelo termo fonte em (7.1), essa equação, escrita para o regime permanente, numa região onde não exista poço, fica:
V. K X X + K X y 7p = 0	(7.5)
(	o m	9 m J
A expressão (7.5) implica em que o argumento do divergente é um
vetor constante, ou seja:
K X x + K A y 1 Vp = u	(7-6)
D íb	s m j	ÍH
Onde u é o vetor fluxo molar do componente m (constante).	0
m i&amp;amp;esmo raciocínio é	aplicado à equação (7.2), isto é:				
V. J K X	+ K X o	g	] Vp	= 0		(7-7)
Logo:					
(K t	+ K Xg j	Vp =	Uh		(7.S)
Onde u é o vetor h	fluxo	molar	global	de	hidrocarbonetos,
igualmente constante.
Os produtos escalares dos vetores em (7.6) e (7.7) por
um vetor unitário ê geram:
[(
4-
ê - u ,ê m
(7.9)
Dividindo (7.9)
por
(7.10)
u . ê ui
u .ê
h
Onde z
m t
fluxo no
Vp j .ê
■+
u . e h
(7.10)
obtém-se:
+
g nr
2 ,
ffi f
(7.11)
é fração molar global do
componente ra na
mistura em
reservatório. Segundo Chopra et. al. [43]
esta fração
é aquela que seria obtida caso se
analisa-se a
corrente de
fluido em movimento. Esse
autor
observa ainda que esta
K
K
A x o
X
O
m
+
K
K 1 vp
S nr )
X g
X x
0 IS


A + A o g
composição difere daquela que
seria
encontrada caso a análise
fosse efetuada em uma amostra
de testemunho preservado desse
reservatório. As frações molares globais neste último caso,
estático, são definidas por:
p S
o o
+ p s
9 9
Z = m
(7.12)
Considera-se agora o caso de um reservatório cujo limite externo apresente pressão acima da de saturação, isto é, o fluido ali existente é monofásico. Nessa região do reservatório não ocorrerão variações na composição do fluido em movimento, que será igual à composição do fluido original z , assim:
ffl o
(7-13)
Admitindo agora um escoamento em regime permanente, observa-se, através da equação (7.11), que a composição global da corrente fluida, z . não varia com a posição. Ora se z é m f	’	if
igual az no trecho monofásico e não havendo alteração de z mo	mf
com a posição conclui-se que a afirmação em (7.13) é sempre válida, apresente-se o fluido como mono ou bifásico, desde que exista o regime permanente. Essa importante conclusão é a base da técnica usada na validação do modelo composicional. Não obstante, o raciocínio pode ainda ser estendido.
Adotando a costumeira hipótese de que as fases em movimento no reservatório se encontram em equilíbrio termodinâmico, a expressão (7.11) pode ser reescrita como:
f
À x	+ A y
o m g m
A	+ A
o	g
y
m
Onde:
Lí =
A o
A 4- A o g
«Lf x + Í1 - Lr
(7.14)
(7.15)
A
9
e
A + A o g
Um experimento de expansão à composição
constante no
fluido original do reservatório geraria as fases
liquida e
vapor cujas composições, x e y , são por definição relacionadas com a composição global do fluido por:
Z - Le X + Í1 - Lei y	(7.16)
mo	«io (	J mo
Onde Le e Ve = (1	- Le) são as frações molares das fases
líquida e vapor num estágio qualquer de pressão e temperatura da expansão.
A equação (7.13), válida para o regime permanente, impõe que z = zmo* Logo pode-se afirmar que as frações molares das fases líquida e vapor na corrente fluida, x e y , m	m
serão iguais as suas correspondentes x e y do fluido momo
original desde que ambos os fluidos estejam sujeitos às mesmas condições de temperatura e pressão. Escreve-se portanto que:
X	~ X	e	y	= y
m	m o		m	mo
(7.17)
A expressão (7.17) pode ainda
ser traduzida em termos das
constantes de equilíbrio:
K = m
(7.18)
Considerando agora as relações em (7.17) e a equação (7.13), as
expressões (7.14) e (7.16) podem ser igualadas:
	X		X
2 =	0	X	+ ■	g
	X + A	m o	A + A
	o	9		0	9
y = z " Le X +	1 - Le y
mo	mo	mol	Jmo
Rearranjando a equação acima
obtém-se:
	À 0	- Le	X	+ m o		X 9
	X t X				X + X
L	0	9				0	9
Apenas no ponto crítico se tem x^ç de temperatura e pressão a equação
(7.19)
= y , nas demais condições
(7.19) impõe que:
20)
Dividindo a primeira pela segunda das relações (7.20) acima
obtém-se finalmente que:
	k p ro o		
X		Le	
			(7.21)
			
X	k p	1 - Le	
s	rs 9		
			
Revisando as igualdades deduzidas em (7.17) conclui-se
que os termos na equação (7.21) devem ser avaliados como
funções de:				
k , r o		M = 0	f ^x para m ~ 1,2,.	....,n ; p; T c
k ,		M =	f y para m = 1,2,.	. . . . , n ; p; T
r g		9		c
Le	= f	[x__,	y para m = 1,2,...	, ,.,n ; p; t]
A equação (7.21) implica que a relação de mobilidades das fases líquida e vapor, fluindo em regime permanente ao longo do reservatório, deve ser igual à relação entre as frações molares das fases líquida e vapor do fluido original, com ambos os sistemas submetidos a idênticas condições de temperatura e pressão.
7.2 Comparação dos Resultados Analíticos e da Simulação
O processo de validação consistiu da comparação dos resultados de razão de mobilidade, gerados pelo modelo em regime permanente, com informações obtidas em uma simulação de um experimento de expansão à composição constante em célula PVT do fluido original. Ou seja, ambas as relações presentes na igualdade em (7.21) foram determinadas, via procedimentos independentes, e então cotejadas.
As simulações do reservatório produziram dados para quatro diferentes situações:
a)	reservatório de gás retrógrado com geometria linear;
b)	reservatório de gás retrógrado com geometria radial;
c)	reservatório de óleo volátil com geometria linear;
d)	reservatório de óleo volátil com geometria radial;
A condição de escoamento em regime permanente foi alcançada através da produção do reservatório acompanhada da injeção simultânea do fluido original, sob pressão constante e igual à inicial, na extremidade oposta a do poço produtor.
A composição do gás usado nos casos a e b foi obtida a partir de análise cromatográfica do fluido produzido no poço 3~RNS~90d, Campo de Pescada (PETROBRÁS) [44]. A representação desse fluido para efeito de simulação contemplou o fracionamento de sua fração mais pesada, C11+, em dois pseudo componentes, seguida do reagrupamento das frações do sistema em seis pseudo componentes. A composição do óleo volátil, usado nas simulações c e d, foi adotada como sendo aquela da fração líquida em equilíbrio com o gás citado acima, na sua pressão de orvalho à temperatura original do reservatório (422°K).
A tabela (7.1) apresenta a composição original e agrupada ("pseudoizada”) do gãs estudado; nessa mesma tabela consta ainda a composição do óleo volátil- o Apêndice F contém as propriedades dos pseudo componentes. A figura (7.1) mostra a curva de depósito de líquido condensado desse gás, expressa pela fração molar da fase líquida como função da pressão. A figura (7.2), por sua vez, apresenta dados de fração molar na
fase vapor para diferentes pressões, obtidos numa expansão à composição constante para o óleo volátil.
Componente	Fração no Gás Original	Pseudo Componente	Fração no Gás Retrógrado	Fração no Óleo Volátil
CH, 4	0,60390 0,00780	PI	0,61170	0,45941
CA CO 2	0,14330 0,00340	P2	0,14670	0,13716
C H 3 8 C4 C5	0,09590 0,05360 0,02160	P3	0,17110	0,19540
C6 C7 C8 C9 CIO	0,01250 0,01260 0,01340 0,00760 0,00470	P4	0,05080	0,09065
Cll	0,01396	P5	0,01396	0,05383
C12+	0,00574	P6	0,00574	0,06355
Tabela 7.1: Composição inicial dos fluidos
Nas simulações desenvolvidas empregaram-se dois conjuntos de curvas de permeabilidade relativa gás óleo. Para os reservatórios de gás retrógrado, casos a e b, foram usados dados, obtidos por processo de embebição, constantes da referência [45]. Nos casos c e d, reservatórios portadores de óleo volátil, utilizaram-se curvas determinadas em laboratório por Branco et. al. [46] com amostras de rocha do próprio Campo de Pescada. Os dois conjuntos de curvas estão representados na figura (7.3). Dados de permeabilidade relativa água óleo foram desnecessários uma vez que admitiu-se a água como imóvel.
Figura 7.1: Fração molar na fase liquida x pressão para o gás do poço 3-RNS~90d
Figura 7.2: Fração molar na
fase vapor x pressão para o óleo
volátil
Como se nota na figura (7.1), o gás estudado apresenta um comportamento típico do fenômeno de condensação retrógrada.
Sg ÇfracQO}
Figura 7.3: Curvas de permeabilidade relativa gás-óleo
Os dados de pressão capilar nos sistemas água óleo e gás óleo, usados apenas nas simulações de reservatórios de óleo, estão tabelados no Apêndice F.
Complementando as informações usadas nas simulações para efeito de validação, a tabela (7.2) apresenta algumas das características dos reservatórios estudados. Já as tabelas (7.3) e (7.4) mostram os dados de produção e de injeção dos poços e os parâmetros de simulação empregados.
Parâmetro	Unidade	Geometria do Reservatório	
		Radial	Linear
Extensão na direção x	m	500	1200
Extensão na direção z	m	20	20
Extensão na direção y	m	2nr e	50
Topo do Reservatório (horizontal)	m	-2490,00	-2490,00
Pressão Inicial do	MPa	31,03 a	34,47 a
Reservatório		-2500,00 m	-2500,00 m
Temp. do Reservatório	°K	422	422
s , w í	fração	0,20	0,20
c r	Pa"1	0,44x10 *	0,44x10"*
0	fração	0,15	0,15
Permeabilidade Horiz.	2 m	9,87xl0'15	9,87x10 15
Permeabilidade Vert.	2 m	9,87x1o"15	9,87x10 15
Tabela 7.2: Dados dos reservatórios simulados para validação
Parâmetro	Unidade	Geometria do Reservatório	
		Radial	Linear
Raio dos poços	m	0,10	0,10
Vazão de gás q máx. ~	?	[S casos a,b	m*/dia	100,00x10*	150,00x10*
Vazão de óleo q máx. -	OS casos c^d	m3/dia	70,00	50,00
Pressão de fluxo p mínima na produção w	MPa	6,89	6,89
Pressão (constante) no poço de injeção	MPa	31,03	34,47
Temperatura de separação na superfície	°K	288,71	288,71
Pressão de separação na superfície	KPa	101,35	101,35
Tabela 7.3: Parâmetros de produção dos poços para validação
Parâmetro	Unidade	Geometria do Reservatório	
		Radial	Linear
Células na direção x	-	Nx=8	Nx = 16
Células na direção z	-	Nz-1	Ni = l
Coordenadas dos poços de produção/injeção	-	(1,1)/(8,1)	(1,1)/(16,1)
At inicial	dia	1,00x10'3	0,25
At máximo	dia	5,00	10,00
ât mínimo	dia	1,00x10 4	1,00x10'2
Tolerância na pressão	Pa	1378,95	1378,95
Toler. nas saturações	fração	5,00x10'4	5,00x10'4
Tolerância nas frações molares	fração	1,00x10 6	1,00x10"7
Tolerância nas eqs. de equilíbrio	fração	1,00x10"7	1,00x10"7
No. máx. de iterações por passo de tempo	—	5	5
Variação máxima permitida na pressão	KPa	689,48	1034,21
Variação máxima permitida nas saturações	fração	5,00x10’2	5,00x10'2
Tabela 7.4: Parâmetros de simulação para validação
Os resultados das simulações são apresentados a seguir. A figura (7.4) mostra as vazões de produção em superfície de óleo e de gás, além da pressão de fluxo no poço produtor, para o caso a, reservatório linear de gás. A figura (7.5) apresenta os mesmos dados para o caso b, reservatório radial de gás (aqui a vazão de gás permaneceu constante durante todo o período simulado). Ambos os gráficos demonstram que a condição de regime permanente de escoamento foi atingida após um período inicial onde ocorreu queda seguida de ascenção nas vazões de produção.
Qgs (md/dra)
Figura 7.4: Vazões de óleo e gás e pressão de fluxo no poço
produtor x tempo (caso a, reservatório linear de gás)
Figura 7.5: Vazão de óleo e pressão de fluxo no poço produtor x tempo (caso b, reservatório radial de gás)
Uma vez alcançado o regime permanente, os dados de mobilidade das fases óleo (X ) e gás (X ) e de constantes de o	a
equilíbrio K (m = l,2,,....,n ) obtidos ao longo das células m	c
da malha de simulação, nos casos a e b, foram usados para a confecção das figuras (7.6) e (7.7). No gráfico (7.6) confrontam-se, para diferentes pressões, as relações de mobilidades X /X ao longo reservatório com as razões entre as o 9
frações molares das fases liquida e vapor (L/V), geradas via expansão à composição constante (ECC) do gás original. O excelente ajuste obtido entre esses dados demonstra, a luz da equação (7.21), a validade do modelo desenvolvido. Esta afirmação é reiterada na figura (7.7) onde as constantes de equilíbrio e (componentes PI e P3) da simulação mostram absoluta correspondência com suas congêneres geradas via ECC no gás original, como previsto na equação analítica (7.18).
Figura 7.6: Razão de mobilidades das fases óleo e gás e relação das frações molares L/V x pressão (casos a e b)
4.00
3.50 -
£ : 0 3.00 -fO
V
2.50 -
2,00 -
1.50 -
Linear de Gas Radial de Gas Gas Original
caçoo Reserv. iiúià Rsserv. ------ ECC do
1.00 -
K3 «—.o. a.o
0.50
0.00
0.00
nni'ti rniitmiHiiiiiii i iiiiittiii n 1111	qrrTmTrrj
5.00	10.00	15.00	20.00	25.00	30.00	35.00
Pressao (MPa)
Figura 7.7: Constantes de equilíbrio dos pseudo componentes Pl
e P3 x pressão (casos a e b)
Os resultados de vazão em superfície e de pressão de fluxo no poço produtor para as simulações dos reservatórios portadores de óleo volátil, casos c (linear) e d (radial), são apresentados nas figuras (7.8) e (7,9). Em ambos os casos atinge-se o regime permanente após um período inicial em que as vazões mostram alguma oscilação. Esse fato jã era esperado uma vez que a ação do poço injetor, operando à pressão constante e igual à original do reservatório, só pode se fazer sentir a
medida que a jazida experimenta um certo nível de depleção.
Como feito anteriormente, as razões de
mobilidade
em regime permanente, casos radial foram comparadas com as
relações L/V obtidas para
e linear,
di ferentes
pressões no experimento
simulado de ECC do óleo original. A
figura (7.10) ilustra o
perfeito ajuste entre esses dados,
validando o modelo para
a simulação de reservatórios de óleo.
60.00
50.00
9.00E+D04
“8.00E+&amp;amp;04
77.00E+004
6.COE+D04
-5.00E+D04
4.00E+004
3.00E+004
2.00E+DD4
-1.00E+004
Pwf
TTi'i TT r~r i rn-t i1 i~i rr i v'r&gt; r rci-rr^-pr-FO.OOE-t-OOO ,00	2000.00	3000.00	4000.00
Tempo (dia»)
10.00 -«i
0.00 ■
0.
r-rl.OOE+DOS
Figura
produtor x tempo (caso c, reservatório linear de ó
2.28E+004
2.2ÔE+004 -
2.28E+004 ¿

30.00
2.28E+004 -í
,S 2.28E+004 ¿ ■c	:
K&gt; 2.28E+004 3
É
2.28E+004
éj 2.28E+004 ¿
2.28E+004
2.28E+004
2.28E+004
2.28E+004


«- Qgs
•29.50
■29.00
Pwf (MPa)	»	°	Q9’
tlr
4-
-&lt;Sr- Pwf
■28.50
0.00
rrrrmrnTiTrrrtt rrr t nn 11 i| rri rii nrfrrn n"rrr p &gt; rn i ttt
50.00	100.00	1 50.00	200.00	250.00	32 2
Tempo (dias)
-28.00
300.00
Figura 7.9: Vazão de gás e pressão de fluxo no poço produtor x
tempo (caso d, reservatório radial de óleo)
Figura 7.10: Razão de mobilidades das fases óleo e gás e relação das frações molares L/V x pressão (casos c e d)
Finalizando a apresentação dos resultados para as simulações de validação, a figura (7.11) mostra as constantes de equilíbrio dos componentes PI e P3 obtidas a partir das composições das fases hidrocarbonetos nas células da malha. Como se nota elas reproduzem exatamente aquelas geradas na ECC do óleo original, como era de se esperar.
Concluindo este item, introduz~se a tabela (7.5) que contém dados inerentes ao desempenho computacional das simulações até agora descritas. Em todos os casos o computador utilizado foi um IBM 3090 instalado no Centro de Pesquisas da PETROBRÁS. 0 objetivo da exposição dessas infoormações é o de fornecer subsídios para - possíveis - futuras comparações com formulações composicionais alternativas à ora em análise.
Figura 7.11: Constantes de equilibrio dos pseudo componentes P1 e P3 x pressão (casos c e d)
Variável	Caso a	Caso b	Caso c	Caso d
Tempo de processamento	3,947 min	26,236 min	3,528 min	10,773 min
Período simulado (dias)	5000	200	5000	260
No. de passos de tempo acumulados	826	13598	898	5292
No. de iterações acumuladas	2931	21354	2776	10097
No. médio de iterações por passo	3,548	1,570	3,091	1,908
Passo de tempo At médio	6,06 dias	21,18 min	5,57 dias	70,75 min
Tabela 7.5: Dados de desempenha computacional das simulações
para validação
S. APLICAÇÕES DO MODELO E DISCUSSÃO DE RESULTADOS
A descrição do modelo composicional desenvolvido se encerra neste capitulo onde são apresentados alguns exemplos de aplicações práticas. Os casos estudados estão divididos em três grupos, a saber:
-simulação de testes de pressão em poços; ^simulação de depleção de reservatório;
^simulação de produção de reservatório com ciclagem de gás.
Em todas as situações acima os fluidos presentes nos diversos tipos de reservatório simulados são os mesmos usados nos casos de validação, suas composições são mostradas na tabela (7.1). Da mesma maneira, as curvas de permeabilidade relativa gás óleo empregadas são idênticas	àquelas
representadas na figura (7.3). Pressões capilares, usadas apenas nos reservatórios de óleo, constam do Apêndice F. Os demais dados, propriedades de reservatório e parâmetros de produção e de simulação, serão expostos caso a caso.
8.1 Simulação de Testes de Pressão em Poços
Este conjunto de simulações compreendeu a análise do comportamento da pressão de fluxo e das saturações de óleo e gás em reservatórios cilíndricos, discretizados de forma exponencial, drenados por um único poço central. Nos cinco casos estudados as seguintes variáveis foram investigadas: -fluido inicialmente presente no reservatório, gás ou óleo; -curva de permeabilidade relativa gás óleo (Kg/Ko) empregada; -existência de dano de formação no poço.
Os casos de reservatório portadores de gás retrógrado, discretizados em malha de Nx = 12 e Ni = 1, são discriminados abaixo:
el)poço sem dano, simulado com curva de permeabilidade relativa gás óleo obtida por drenagem [46];
e2)poço sem dano, simulado com curva de permeabilidade relativa gás óleo obtida por embebição [45];
e3)poço com dano, simulado com curva de permeabilidade relativa gás óleo obtida por embebição [45],
0 dano no poço, caso e3, foi modelado através da redução das permeabilidades absolutas horizontal e vertical das duas primeiras células da malha de 9,87x10’15 m2, usada nos demais blocos, para 2,18x10’ m . Considerando o esquema exponencial de construção dos blocos, malha de 12x1, raio do poço de 0,10 m, conclui-se que o raio de dano será igual a 0,414 m, correspondendo a um fator de película S igual a 5 [47]. Nos casos el e e2 as permeabilidades são constantes e iguais a 9,87x10" 15.
Os testes de formação simulados compreenderam um período inicial de fluxo de 24 horas, seguido de uma estática de 48 horas. As características do reservatório são as mesmas já apontadas na tabela (7.2), geometria radial, a menos das alterações nas permeabilidades comentadas acima. A vazão de teste, constante, para os três casos foi de 2OO,OOxlO3 m3/dia; os demais dados de produção são os mesmos mostrados na tabela (7.3). Os parâmetros de simulação, por sua vez, sofreram algumas modificações em relação aos anteriormente usados na validação. A tabela (8.1) apresenta seus novos valores.
Parâmetro	Unidade	Valor usado
Células na direção x	-	Nx=12
Células na direção z		Nz=l
At inicial	dia	1,00x10"3
At máximo	dia	1,00x10'1
At mínimo	dia	1,00x10"4
Tolerância na pressão	Pa	1378,95
Toler* nas saturações	fração	5,00x10'4
Tolerância nas frações molares	fração	1,00x10"7
Tolerância nas eqs. de equilibrio	fração	l,00xl0"7
No. máx. de iterações por passo de tempo		5
Variação máxima permitida na pressão	KPa	689,48
Variação máxima permitida nas saturações	fração	5,00x10'2
Tabela 8*1: Parâmetros de simulação para testes de formação
As principais alterações se referem aos valores inicial, máximo e minimo do passo de tempo At. Estes foram reduzidos para se obter uma melhor definição das incógnitas no curto período simulado (teste de duração total de 3 dias).
Os resultados dos três casos são apresentados nas figuras (8.1), pressão de fluxo em função do tempo, e (8.2), saturação de óleo na célula 1,1 contra o tempo. As pressões de fluxo mostraram o comportamento esperado: no poço danificado a queda foi mais acentuada, nos demais o declínio foi pouco influenciado pela fato de terem sido usadas curvas diferentes de Kg/Ko. Já a evolução da saturação de óleo, que uma vez
estabelecida não chegou a desaparecer com o fechamento do poço, demonstrou maior dependência em relação à permeabilidade relativa, em especial no período de crescimento de pressão. Assim foi que no caso el, curva de Kg/Ko por drenagem, a saturação de óleo experimentou um significativo acréscimo nessa etapa, indicando que o fluido presente na célula 1,1, originalmente um gás, sofreu profunda alteração na sua composição a ponto de passar a comportar-se como um líquido. Nos outros dois casos, curva de Kg/Ko por embebição, esse fenônemo ocorreu de forma muito discreta no poço sem dano e não se manifestou no poço danificado. Essas conclusões são importantes pois demonstram a possibilidade de mudança radical na composição do fluido nas proximidades do poço, fato que pode acarretar erros de avaliação de reservatórios quando estes se basearem em amostragens - impróprias - desse fluido. Não
obstante, comprovou~se ainda que o fenômeno em questão
depende
fortemente das conclusão que caracterização
características confere maior da rocha nos
de fluxo do importância estudos de
meio poroso, à correta simulação de
reservatórios. Os resultados obtidos comprovam ainda o já
conhecido problema de potencial perda de produtividade em poços de gás retrógrado, decorrentes do dano induzido pela deposição de líquido no reservatório.
Em outros dois testes de formação analisaram-se reservatórios portadores de óleo volátil, ambos simulados com a
curva de Kg/Ko obtida por drenagem [46j, considerando que:
-caso fl, poco sem dano;
-caso f2, poço danificado com fator de película S igual a 5 modelado de forma semelhante à comentada anteriormente.
35,00
T--,—J I J y"J I ■ j	t T T-r*T*T~T~TT~rT r
Kg/Kp drenagem sem dano ***** Kg/Ko embebicQO sem dano ®1MMWa Kg/Ko embebicao com dano S-5
r-r-r-fr"! 'T'~r
3.00
2.00
Tempo (dias)
Figura 8.1: Pressão de fluxo x tempo, testes de formação
em
poços de gás retrógrado
Figura 8.2: Saturação de óleo x tempo, testes de formação
em
poços de gás retrógrado
Os demais parâmetros de reservatório, de produção e de simulação são os mesmos mostrados nas tabelas (7.2), (7.3) e (8.1) respectivamente.
A figura (8.3) mostra os resultados de pressão de fluxo contra o tempo. Obteve-se a resposta esperada, qual seja, uma maior queda de pressão no poço danificado. 0 comportamento da pressão governou a evolução da saturação de gás com o tempo, cujos valores para a célula 1,1 são apresentados na figura (8.4). Como se observa nesse gráfico, o poço com dano permitiu o surgimento de uma saturação de gás superior àquela gerada no poço sem dano. Após o fechamento dos poços o gás livre desapareceu indicando que a pressão atingida superou a pressão de bolha do líquido.
Figura 8.3: Pressão de fluxo x tempo, testes de formação em
poços de óleo volátil
Figura 8.4: Saturação de gás x tempo, testes de formação em
poços de óleo volátil
Concluindo este item, a tabela (8.2) apresenta algumas variáveis para avaliação do desempenho computacional das cinco simulações descritas acima, todas desenvolvidas no computador IBM 3090 do Centro de Pesquisas da PETROBRÁS. Observe-se que os resultados de passo de tempo médio, que se mostraram bastante reduzidos, estão influenciados pela limitação de 0,1 dia (144 minutos) imposta ao At máximo e pelo fato das simulações terem sido iniciadas com um At de apenas 0,001 dia (1,44 minutos). Apesar dessas considerações, o rendimento nas simulações em geometria radial parece, a primeira vista, pouco satisfatório em relação às que envolvem geometria cartesiana. Entretanto não é possível avaliar essa questão de forma definitiva uma vez que não se dispõe de dados comparativos.
Variável	Caso el	Caso e2	Caso e3	Caso fl	Caso f2
Tempo de processamento (min)	3,921	3,940	5,719	4,290	7,474
Período simulado (dias)	3	3	3	3	3
No. de passos de tempo acumulados	1107	1035	1534	1175	2045
No. de iterações acumuladas	2701	3219	5881	4635	8090
No. médio de iter. por passo	2,440	3,110	3,834	3,945	3,956
Passo de tempo At médio (min)	3,915	4,188	2,825	3,691	2,123
Tabela 8.2: Dados de desempenho computacional das simulações
de teste de formação
8.2 Simulação de Depleção de Reservatórios
As simulações descritas a seguir objetivaram submeter o modelo à análise de ura mesmo problema físico porém representado por diferentes configurações de malha de simulação. Dois casos foram estudados:
g)	reservatório linear de gás retrógrado, discretizado em malhas com pares (Nx,Nz) de (16x4), (16x2) e (8x4);
h)	reservatório linear de óleo volátil, discretizado era malhas
com pares (Nx,Nz) de (16x4) ,	(16x2) e (8x4) ;
Em ambos os casos a produção ocorreu por um único poço localizado numa das extremidades dos reservatórios. Os intervalos abertos ao fluxo foram equivalentes, ou seja, duas camadas (as inferiores) nas malhas de Ni = 4 e uma camada nas malhas de Nz = 2 (a inferior) . Nos casos de gás retrógrado
usou-se a curva de permeabilidade relativa gás óleo obtida por embebição [45] e nos de óleo volátil a de drenagem [46]; ambas sâo mostradas na figura (7.3). Admitiu-se ainda a fase água como imóvel.
Os dados de reservatório e de produção são reapresentados na tabela (8.3), apesar de diferirem muito pouco em relação aqueles usados nos casos de validação em geometria linear. Os parâmetros de simulação são os mesmos usados anteriormente nos casos de validação (tabela 7.4) a menos no que concerne às dimensões da malha, comentada acima.
Os resultados para o caso g, reservatório de gás, são apresentados a seguir. A figura (8.5) contém os dados de vazão de óleo e de razão gás óleo (RGO) ,* o gráfico (8.6) mostra a vazão de gás e a pressão de fluxo na base das camadas abertas. Finalmente, a figura (8.7) apresenta as produções mássicas acumuladas, em termos de número de moles, para o componente PI e para a soma dos componentes de P3 a P6 (apenas para malha de 16x4). Neste último gráfico registram-se tanto os dados obtidos pela acumlação, ao longo do tempo, do produto da vazão molar pelo incremento de tempo, referidos como "dados da simulação", quanto os resultantes de um balanço de materiais nas células da malha. A perfeita concordância entre esses resultados demonstra uma vez mais a validade do modelo implementado.
Como se observa nas figuras mencionadas acima, a variação nas dimensões da malha não provocou alterações importantes na resposta do simulador. A evolução das variáveis vazões em superfície de gás e de óleo mostram o comportamento esperado, o mesmo ocorrendo com as produções mássicas acumuladas e com a pressão de fluxo.
Parâmetro	Unidade	Fluido Inicial no Reservatório	
		Gás Retrógrado	Óleo Volátil
Extensão na direção x	m	800	800
Extensão na direção z	m	20	20
Extensão na direção y	m	200	200
Topo do reservatório (horizontal)	m	-2490,00	-2490,00
Pressão inicial do reservatório	MPa	34,47 a -2500,00 m	34,47 a -2500,00 m
Temp. do reservatório	°K	422	422
s .	fração	0,20	0,20
c r	Pa'1	0,44x10 3	0,44x10 3
0	fração	0,15	0,15
Permeabilidade horiz.	mz	9,87x10'15	9,87x10'15
Permeabilidade vert.	m2	9,87x10'15	9,87x10"15
Raio dos poços	m	0,10	0,10
Vazão máxima de produção	m3/dia	80,00x10* (gás)	50,00 (Óleo)
Pressão de fluxo p mínima na produção w	MPa	6,89	6,89
Temperatura de separação na superfície	°K	288,71	288,71
Pressão de separação na superfície	KPa	101,35	101,35
Tabela 8.3: Dados de reservatório e de produção para as
simulações de depleção
50.00
prmTTTrrrTn riTft j rri i irm-p i nrri i rr8000,00
+5.00
+0.00
20.00
15.00
10.00 -
5.00
0.00 -
0.00
malho aa+aa malho oanoo molha
Nx=16 Nz“4-Nx=16 Nz-2 Nx*8 Nz»=4
de de de
irri i rrrn 'rrrrrrrTt fnTrr-n i i"i rrrr 200.00 +00.00 600.00
Tempo (dias)
-6000.00
4000.00 .2
Figura 8.5: Vazão de óleo e razão gás óleo x tempo, depleçao em
reservatório de gás retrógrado
(Djp/ÇLU) SI
1.006+004
9.00E+004 q
S.OOÊ+O04
7.00E+004
6.00E+004
5.00E+004
2.00E+004
4.00E+004 ej*
Ô 3.006+004
20.00
doo»»*» malha de Nx*=16 : aaaaa malha de Nx-16 : anoan malha de Nx=8
O.OOE+O0O - -n
0.00
-0.00
200.00	+00.00	600.00 BOOÍOO 1000.00	1200.00
Tempo (dias)
Figura 8.6: Vazão de gás e pressão de fluxo x tempo, depleçao em reservatório de gás retrógrado
Z00E+O06 □
o
E 1.75E+006
CT iC
1.50E+OG6
3 'Ñ -g 1.25E+006
£
~ 1.00E+006
XJ o 3 7.5DE+005 E
□
5.00E-+005
O
4Z&gt;
W 0 Z
2.50E+005
O.OOE+OOO
0.Ó0	200.00
oeee© dados do simulacao . -àâAAâ dados ds bal. de motoriais-
11; i l i rri’111 rirrniri t irnH rtmni uniu ♦00.00	600.00	B00.00	1 000-00 1200.00
Tempo (dias)
TTTT
Figura 8.7: Produção mássica acumulada dos pseudo componentes
Pl e P3+, depleção em reservatório de gás retrógrado
As simulações do caso h, reservatório de óleo, são resumidas nas figuras (8.8), (8.9) e (8.10). No gráfico (8.8) são mostrados os dados de vazão de óleo e de razão gás óleo como função do tempo. Nesta figura nota-se nitidamente o efeito provocado pelo uso de diferentes malhas de simulação, efeito este que se acentua quando a variação ocorre no número de camadas verticais. Com efeito, a RGO na malha de 16x2, apresenta valores muito superiores aos das demais malhas, 16x4 e 8x4, estes semelhantes entre si. Essa diferença de comportamento pode ser atribuida ao menor grau de segregação gravitacional que ocorre na malha com apenas duas camadas, fato que leva a uma produção mais acelerada do gás gerado ao longo da depleção do reservatório, observe-se que a vazão de óleo
também sofre com a perda prematura do gás: seu declínio torna-se mais agudo em relação aos demais casos. A figura (8.9) ilustra a afirmação anterior, nela são mostradas a vazão de gás e a pressão de fluxo com o tempo.
Por fim, o gráfico (8.10) apresenta as produções mássicas acumuladas do componente PI e da soma dos componentes P3 a P6 (apenas para a malha de 16x4). Como no caso anterior -reservatório de gás - aqui também se atingiu uma perfeita coerência entre os dados obtidos a partir das vazões molares ao
longo do tempo (”dados da simulação”) com aqueles gerados por balanço de materiais nas células da malha.
Finalizando, a tabela (8.4) apresenta uma síntese das
variáveis que retratam o desempenho computacional
dos casos
simulados neste item. O computador usado foi o
IBM 3090 disponível no Centro de Pesquisas
já mencionado
da PETROBRÁS.
Observe-se que o rendimento aqui alcançado, operando em
geometria cartesiana, foi muito superior ao conseguido antes em simulações com geometria radial.
RGO (m3/dia / m3/dia)
Figura 8.8: Vazão de óleo e razão gás óleo x tempo, depleçâo em reservatório de óleo volátil
1.50E+005
O.OOE+OOO
1.25E+005
2.50E+004 -
o&gt;
° 5.00E+004
C&gt;1.00E+005 -U
E 7.50E+004 -
Qgs
malha de Nx»=16 Nz=4 **■*★&amp;lt;malha de Nx=16 Nz=2
malha de Nx«==8 Nz=4
Pwf
40.00
■50.00
“20.00
10.00
0.00
0.Ô0
ri.inrr|,(,rTTTn,t ; , | ) | t | i fi-r i 'i t i ; ittt! i i rr -------------- 800.00 1200.00 1 600.00 Tempo (dias)
400.00
D £L 2
*
Q.
Figura 8.9: Vazão de gás e pressão de fluxo x tempo, depleçâo
em reservatório de óleo volátil
Figura 8.10: Produção mássica acumulada dos pseudo componentes
PI e P3+, depleção em reservatório de óleo volátil
Variável	Malha	Caso g Reserv. de gás	Caso h Reserv. de óleo
Tempo de	16x4	5,753	10,069
processamento	16x2	1,599	2,995
(min)	8x4	1,737	3,289
	16X4	1033	1200
Período simulado	16x2	1034	1200
(dias)	8x4	1041	1200
Número de passos	16x4	203	346
de tempo	16x2	148	259
acumulados	8x4	130	240
Número de	16x4	780	1361
iterações	16x2	540	1004
acumuladas	8x4	481	905
Passo de tempo	16x4	5,087	3,487
ât médio	16x2	6,987	4,663
(dias)	8x4	8,005	5,035
Tabela 8.4: Dados de desempenho computacional das simulações
de depleção
8.3 Simulação de Produção de Reservatórios com Ciclagem de Gás
As últimas aplicações do modelo destinaram-se ao estudo do comportamento de reservatórios de gás retrógrado e de óleo volátil com produção assistida por injeção de gás. Visando isolar os efeitos deste método de recuperação, seus resultados foram comparados com os que seriam obtidos em uma depleção natural equivalente. Consideraram-se as seguintes situações:
i)	reservatório de gás retrógrado sujeito à injeção de gás com duas composições diferentes, referidas como gás 1 e gás 2;
j)	reservatório de óleo volátil submetido à injeção do gás 2?
A composição dos gases 1 e 2 é apresentada na tabela (8.5). A formulação do gás 1 é idêntica a da fase vapor, gerada nas condições de pressão e de temperatura de separação em superfície, a partir do gás retrógrado original. A formulação do gás 2, por sua ves, foi adotada como sendo a do efluente rejeitado de um processo (hipotético) de extração das frações mais ricas do gás produzido.
Pseudo Componente	Fluido Injetado	
	Gás 1	Gás 2
P1	0,652424	0,880000
P2	0,156151	0,120000
P3	0,178949	0,000000
P4	0,012473	0,000000
P5	0,000003	0,000000
P6	0,000000	0,000000
Tabela 8.5: Composição dos gases injetados nas ciclagens
A curva de permeabilidade relativa gás óleo obtida por embebição [45] foi usada nas simulações de reservatórios de gás. Nos de óleo empregou-se a curva de Kg/Ko por drenagem [46] (figura (7.3)). Admitiu-se a fase agua como imóvel.
As malhas de simulação foram construídas com 12 células ao longo do eixo x e com 3 camadas na direção z. Os poços de produção e de injeção, posicionados nas extremidades da jazida, admitiram fluxo pelas células (1,1) e (12,3), respectivamente. Os outros parâmetros de simulação repetem os usados nas simulações de validação (linear) e de depleção -tabela (7.4) - a menos das dimensões da malha. Os dados de reservatório e de produção são mostrados na tabela (8.6).
Os resultados de vazão de óleo na superfície e de razão gás óleo (RGO) para o caso i, reservatório de gás, são mostrados na figura (8.11). Como se observa, a injeção dos gases 1 e 2 proporcionou desempenhos muito semelhantes, com pequena vantagem para o gás 2, o de composição mais pobre. Os resultados da depleção equivalente também são mostrados na figura (8.11), servindo como ponto de referência.
A figura (8.12) apresenta a produção mássica acumulada da soma dos pseudo componentes de P3 a P6 em função do tempo, ainda para o reservatório de gás (caso i) . Como feito anteriormente nos casos de depleção, registram-se nesse gráfico tanto os "dados da simulação" quanto os obtidos por balanço de materiais, conseguindo-se, novamente, um perfeito ajuste entre ambas as metodologias. Observe-se ainda que os valores ali mostrados são "líquidos*', ou seja, descontam a massa dos componentes que tenham sido eventualmente reinjetados no reservatório. A interpretação dos resultados leva a conclusões
até certo ponto surpreendentes, apesar de válidas apenas para o período simulado de 600 días, relativamente curto. A ciclagem com o gás 1, por exemplo, mostrou o pior rendimento, facilmente
justificável pelo fato de que a composição desse fluido contém teores razoáveis do componente P3. Assim, parte da massa produzida de P3 não pode ser contabilizada uma vez que é reintroduzida na jazida. A ciclagem com o gás 2, que não contém componentes nobres em sua formulação, apresentou a melhor
eficiência
comportamento,
superior depleção equivalente. Esse
vista anômalo, mostra
vazões
mais expressivas
ciclagem,
relação
depleção, não são
suficientes para sustentar uma produção mássica muito superior à alcançada nesta última, ou seja, a maior vazão de gás fornecida na depleção consegue, ao menos no curto prazo, gerar quase a mesma quantidade de produtos nobres. Esse julgamento certamente se modificaria, a favor da ciclagem, num tempo de explotação da jazida maior que o simulado. Essas observações levam a importante conclusão de que as avaliações econômicas dos métodos de recuperação, ao menos para reservatórios de gás retrógrado e de óleo volátil, devem basear-se preferencialmente nas produções mássicas. Aliás esta é uma das próprias razões de ser da simulação composicional.
Os resultados para o caso j, reservatório de óleo volátil, estão ilustrados nas figuras (8.13), (8.14) e (8.15). 0 gráfico (8.13), que apresenta a vazão de óleo e a RGO em função do tempo, não deixa dúvidas quanto ao melhor desempenho, ao menos em termos de volume de óleo produzido, do reservatório
sujeito à injeção de gás.
Parâmetro	Unidade	Fluido Inicial no Reservatório	
		Gás Retrógrado	Óleo Volátil
Extensão na direção x	m	1200	1200
Extensão na direção z	m	20	20
Extensão na direção y	m	200	200
Topo do reservatório (horizontal)	m	-2490,00	-2490,00
Pressão inicial do reservatório	MPa	34,47 a -2500,00 m	31,03 a -2500,00 m
Temp. do reservatório	°K	422	422
s , W 1	fração	0,20	0,20
c r	Pa'1	0,44x10'3	0,44x10 3
0	fração	0,15	0,15
Permeabilidade horiz.	2 m	9,87x10'15	9,87x10'15
Permeabilidade vert.	2 m	9,87x10'15	9,87x10"15
Paio dos poços	m	0,10	0,10
Vazão máxima de produção	m3/dia	80,00xl03 (gás)	60,00 (óleo)
Vazão de injeção de gás (constante)	m /dia	40,00xl03	30,00xl03
Pressão de fluxo p mínima na produção w	MPa	6,89	6,89
Temperatura de separação na superfície	°K	288,71	288,71
Pressão de separação na superfície	KPa	101,35	101,35
Tabela 8.6: Dados de reservatório e de produção para as
simulações de ciclagera
50.00
45.00
40.00
20.00
§ 25.00
74000.00
3000.00
RGO
1000.00
RGO
Das
rZOOO.OO
15.00
w.oo
Õ.ÓÜ
ciclogem com gas 1
***** cíclagem com gas 2 deplecao equivalente
ttttttiití i i i vr-i'n'Ti till rr 400.00	-----
Tempo (dias)
T'V j .s .¥ r.r1„TTT.T
200.00
600.00
—rpO-OO
800.00
Figura 8.11: Vazão de
óleo e razão
gás óleo x tempo, ciclagem
em reservatório de gás
retrógrado
Figura 8.12: Produção mássica acumulada dos pseudo componentes
P3+, ciclagem em reservatório de gás retrógrado
A figura (8.14), por sua vez, mostra a vazão de gás em função do tempo. Finalmente, o gráfico (8.15) contém os resultados de produção mássica acumulada da soma dos pseudo componentes de P3 a P6 (obtidos na simulação e por balanço de materiais). Como se observa, o desempenho do reservatório sob ciclagem mantém-se abaixo do obtido na depleção natural por um longo período de tempo. Entretanto, quando sua vazão de gás passa a crescer, a produção dos componentes ricos ganha novo impulso terminando por superar, com grande vantagem, aquela gerada no reservatório depletivo. Esse comportamento reforça a conclusão formulada logo acima quanto a importância da análise das produções mássicas.
80,00
TTTTTTTTTTTTTTTTTTTTTTTTTTTTTpmnnnrrTTprTTTTTTTTp80&lt;X&gt;,00
70.00
i i e,o o »■&amp;amp;■■■* ooe»e&lt;?o&amp;amp;
60.00
30.00
20.00
10.00
ímhhh&gt; ciclagem de $ os ***** deplecao equivalente
0.00 ~
O.i
■a'o-e"■e-o o-oo-O'"»
RGO Qcs Qos
; c 'TTTTTTTTTrTTTTTTTTT'frrTT'TTTI
,00	500.00	1000.00	15
Tempo (dias)
RGO
6000.00
4000.00 o
K)
E
2000.00
0.00
TTTTTTTTT 00	250Ò.00
o o {Z
Figura 8.13: Vazão de óleo e razão gás óleo x tempo, ciclagem
em reservatório de óleo volátil

Vazão de gás x tempo.
Figura 8.14:
ciclagem em reservatório de
óleo volátil
TTTTTTTTT
57 1 .OOE+OT6 -
*R 8.00E4005
k.
6.0ÜE+005 -
O
3
E 4.00E+005 -
□
£ -
1.20E+006
| 2.00E+005 -o	I
2
ciclagem
depíecao
O.OOE+OOO
dados da simulacao ¿¿¿¿¿ dados de bal. de materiais
rn"T't"'i 11 i ¡ r"rrrT7'TTTi'TTTTT,rTrTTT'r'r,T',rT,rrr7‘r,r!''T'r'r'r',rr
0.00	500.00	1000.00	1500.00	2000.00	2500.00
Tempo (dias)
Figura 8.15: Produção mássica acumulada dos pseudo componentes
P3+, ciclagem em reservatório de óleo volátil
Conclui-se a apresentação dos casos de ciclagem com o relato dos dados de desempenho computacional, expostos na tabela (8.7). O computador usado, como nos demais casos, foi o IBM 3090 instalado no Centro de Pesquisas da PETROBRÂS.
Variável	Caso i: Reservatório de Gás Retrógrado			Caso j: Reservatório de óleo	
	Injeção do gás 1	Injeção do gás 2	Depleção equiv.	Injeção do gás 2	Depleção equiv.
Tempo de processamento (min)	8,851	7,576	1,023	19,157	3,436
Período simulado (dias)	600	600	600	2000	2000
No, de passos de tempo acumulados	496	411	76	1219	274
No. de iterações acumuladas	2093	1993	287	5150	918
No. médio de iter. por passo	4,220	4,849	3,776	4,225	3,350
Passo de tempo ât médio (dias)	1,211	1,462	7,977	1,641	7,325
Tabela 8.7: Dados de desempenho computacional nas simulações
de ciclagem
É interessante
observar na tabela
acima a queda de
rendimento da simulação
nos casos em que há
injeção de gás.
Isto se deve ao maior
esforço dispendido
na
resolução das
equações de equilíbrio de fases, uma vez
que
as variações
composicionais nos fluidos são mais intensas
nos
casos em que
há injeção de gás.
9. CONCLUSÕES E SUGESTÕES PARA TRABALHOS FUTUROS
O trabalho apresentado descreve um modelo de reservatórios com tratamento composiciona1 do escoamento e do equilíbrio de fases dos fluidos presentes em meio poroso. A solução do sistema de equações, baseada no método de Newton Raphson, adotou uma abordagem implícita na pressão e nas saturações de fluidos e explícita nas variáveis composicionais, ainda que apenas nos termos de fluxo das equações de transporte. Esse procedimento se altera nas células cujo fluido se encontre na chamada região de fase única, passando a totalmente implícito em uma variável composicional e deixando de considerar a saturação de gás como incógnita.
A razão de ser dessa formulação está ligada ao fato de que a matriz jacobiana resultante, de estrutura bastante particular, é suscetível de redução a uma matriz blocada de três por três semelhante àquelas obtidas em simuladores do tipo Mblack-oilH trifásicos totalmente implícitos.
Nos cálculos de equilíbrio	e de	densidades	das	fases	
hidrocarbonetos utilizou-se a equação		de estado	de	Peng	e
Robinson modificada por Jhavery e	Youngren. A concepção				do
modelo, porém, é geral, permitindo	sua	adaptação	ao	uso	de
qualquer outra equação de estado.
A implementação do modelo, escrito para geometrias cartesiana e cilíndrica em até duas dimensões, contemplou os efeitos capilares e gravitacionais mas desconsiderou os fenômenos de natureza difusiva. Uma hipótese importante admitida diz respeito ao estabelecimento instantâneo de equilíbrio termodinâmico entre as fases líquida e vapor
geradas. Em outra simplificação aceitou-se que a fase aquosa, apesar de móvel, não desenvolve interação em termos de solubilidade com as demais fases hidrocarbonetos.
O tratamento dos termos fonte, parcialmente explícito, considerou os fluidos produzidos a nível de superfície e permitiu a existência de poços operando por mais de uma camada.
A validação do modelo, baseada na teoria do escoamento bifásico em regime permanente, demonstrou perfeito ajuste entre os resultados teóricos e simulados, tanto para reservatórios de gás retrógrado quanto de óleo volátil, e em geometrias cartesiana e radial.
As aplicações a testes de pressão em poços apontaram a importância dos dados de permeabilidade relativa no sistema físico estudado. Com efeito, essa variável influencia a deposição de condensado nos reservatórios de gás retrógrado, fato que pode gerar profundas alterações na composição do fluido nas vizinhanças dos poços. Os distúrbios provocados chegam a descaracterizar o fluido inicial, um gás, a ponto deste passar a se comportar como um líquido volátil. São notáveis as consequências do fenômeno na avaliação de poços. Poços danificados foram igualmente estudados, obtendo~se as respostas de pressão de fluxo esperadas.
Nas demais aplicações, relacionadas à depleçâo natural e assistida por injeção de gás (ciclagem), estudaram-se os efeitos da discretização da malha e da composição do gás injetado na resposta do simulador. Entre as conclusões obtidas a mais interessante indicou a relevância da análise das produções mássicas dos componentes. Esses dados se mostraram tão ou mais importantes que os de vazão volumétrica para uma
correta avaliação econômica de jazidas de gás retrógrado ou de óleo volátil.
Os resultados de desempenho computacional, fornecidos para toda as simulações, demonstraram valores muito diferentes para os casos de geometria cartesiana, considerados satisfatórios, em relação aos de geometria cilíndrica onde o rendimento, a primeira vista, mostrou-se menos eficiente. Conclusões definitivas, entretanto, não são possíveis uma vez que não se dispõe de parâmetros para comparação. De toda forma, pode-se concluir que a formulação concebida nesse trabalho mostrou-se plenamente viável e satisfatória no seu desempenho global.
Uma primeira sugestão para extensão do trabalho ora desenvolvido, decorrente dos comentários feitos acima, é o de se cotejar os desempenhos desta formulação com os de uma totalmente implícita e implícita na pressão (do tipo IMPES).
Outra importante sugestão de estudo se refere a otimização dos métodos numéricos de cálculo de equilíbrio de fases, quais sejam, de liberação “flash” e de pressão de saturação. Esse problema, apesar de muito explorado na 1iteratura, ainda não pode ser considerado resolvido, em especial quando a condição de pressão e de temperatura do fluido em questão é próxima ao ponto crítico. A aproximação adotada neste trabalho, um procedimento híbrido entre os métodos de substituição sucessiva e de Newton Raphson, se por um lado mostrou algumas virtudes, por outro é passível de muitas melhorias visando torná-lo mais robusto.
REFERÊNCIAS BIBLIOGRÁFICAS
[1]	Arps,J.J./’Analysis of Decline Curves”, Trans,,AIME (1945), 160,228-47.
[2]	Amix,J.W., Bass,D.M. &amp;amp; Whiting,R.L,,Petroleum Reservoir Engineering-Physical Properties, Rev York, McGraw Hill Book Company,1960.
[3]	Coats,K.H,,"Reservoir Simulation: state-of-the-Art”,Society of Petroleum Engineers, SPE 10020, 1982.
[4]	Aziz,K. &amp;amp; Settari,A.,Petroleum Reservoir Simulation,London, Applied Science Pub., 1979.
[5]	Wong,T.W. et alii.,"A Comparison of Two Approaches to Compositional and Black oil simulation”,Society of Petroleum Engineers, SPE 15999, 1987.
[6]	Coats,K.H.,"An Equation of State Compositional Model”,Soc.
Pet, Eng, J.,(outubro 1980) 363-376.
[7]	Peng,D.Y. &amp;amp; Robinson,D.B.,"A New Two-Constant Equation of
State”,I.&amp;amp;E,c. Fundamentals, (1976), 15, No.l, 59-64.
[8]	Kazemi,H, &amp;amp; Vestal,C.R. ,”An Efficient Multicomponent Numerical Simulator",Society of Petroleum Engineers,SPE 6890, 1977.
[9]	Fussel,L.T. &amp;amp; Fussel,D.D. ,"An Iterative Technique for Compositional Reservoir Simulator”, Society of Petroleum Engineers, SPE 6891,1979.
[10]	Redlich,O.	&amp;amp; Kwong,J.N.S.	,"On the Thermodinamics of
Solutions V. An Equation of State. Fugacities of Gaseous Solutions”,Chem. Rev,,(1949) 44-233.
[11]	Nghiem,L.X.,Fong,D.K. &amp;amp; Aziz,K./'Compositional Modeling
With an Equation of State",Soc. Pet. Eng. J.,(dezembro 1984) 687-698.
[12]	Mansoori, J., ‘'Discussion of Compositional Modeling With an Equation of State", Soc. Pet. Eng. J.,(abril 1982) 202-203.
[13]	Nghiem,L.X.,"Author's Reply to Discussion of Compositional Modeling an With Equation of State", Soc, Pet. Eng. J.,(abril 1982) 204.
[14]	Shiozer,D.J., "Estudo de urn Modelo Composicional para Simulação de Reservatórios", Tese de Mestrado, Universidade Estadual de Campinas, Campinas, junho 1989.
[15]	Watts,J.W.,"A Compositional Formulation of the Pressure and Saturation Equation",Society of Petroleum Engineers,SPE 12244, 1983.
[16]	Acs,G., Doleschall,S.	&amp;amp; Farkas,E., "General Purpose
Compositional Model",Soc. Pet. Eng.
[17] Coats,K.H. /‘Simulation of
J. ,(agosto 1985) 543-533.
Gas Condensate Reservoir
Performance",J.
Pet. Tech.,(outubro
1985) 1870-1886.
(18] Coats,K.H.
&amp;amp; Smart,G.T.,"Application of a
Regression-Based
EOS PVT Program
to Laboratory Data",Soe, Pet.
Eng.
R. E. , (maio
1986) 277-299.
[19] Nutakki,R.
"Development
Of
General Purpose
Simulators.
Part 2: Use of
Equations of
State to Calculate
Derivatives
Required in
Compositional
Models", Stanford
et alii.,
University,
Stanford, California, julho 1985.
[20]	Quandalle,P. &amp;amp; Savary,D.,"An Implicit in Pressure and
Saturations Approach to Fully Compostional Simulation",Society
of Petroleum Engineers,SPE 18423,1989.
[21]	Quandalle,P. &amp;amp; Sabathier,J.C.,"Typical Features of a New
Multipurpose Reservoir Simulator",Society of Petroleum
Engineers,SPE 16007,1987.
[22]	Garza, F.R., ’’Notas de Aula da Cadeira de Comportamento de Reservatório”, Curso de Mestrado em Engenharia de Petróleo, Universidade Estadual de Campiñas, Campinas, setembro 1989,
[23]	Pedrosa,o.,"Use of Hybrid Grid Reservoir Simulation”, Tese de Doutorado,Universidade de Stanford,Stanford,dezembro 1984.
[24]	Edminster,w,C.	&amp;amp; Lee,B.I., Applied Hydrocarbon
Thermodinamics, Houston,Gulf Publishing Co.,1984.
[25]	Leverett,M.c.t"Capillary Behaviour in Porous Solids”,Trans AIME(1941) 142-152.
[26]	Sherman,A.H., "NSPIV, A Fortran Subroutine for Sparse Gaussian Elimination With Partial Pivoting, ACH Trans. Hath, Software.
[27]	Peaceman, D.W., Fundamentals of Numerical Reservoir Simulation, Amsterdam, Elsevier, 1977.
[28]	Wheaton,R. J., ’’Treatment of Variations of Composition with Depth in Gas Condensate Reservoirs”,Society of Petroleum Engineers,SPE 18267,1988.
[ 29] Firoozabadi,A., "Reservoir-Fluid Phase Behavior and Volumetric Prediction With Equations of state”, J. Pet. Tech. ,(abril 1988] 397-405.
[30]	Soave, G.,"Equilibrium Constants From a Modified Redlich
Kwong Equation of State",Chemical Eng. Science, (1972)	27
1197-1203.
[31]	Firoozabadi,A. et. alii., "EOS Predictions of Compressibility and Phase Behavior in Systems Containing Water, Hydrocarbons and C02",Soc. Pet. Eng. R. E. , (maio 1988) 673-684.
[32]	Katz,D.L. &amp;amp; Firoozabadi,A.,"Predicting Phase Behavior of Condensate/Crude-Oil Systems Using Methane Interaction Coefficients", J. Pet. Tech., (novembro 1978) 1649-1655.
[33]	Peneloux,A., Rauzy,E. &amp;amp; Freze,R.,"A Consistent Correction for Redlich-Kwong-Soave Volumes", Fluid Phase Equilibria, (1982) 8 7-23.
[34]	Jhavery,B.S. &amp;amp; Youngren,G.K.,"Three-Parameter Modification of the Peng-Robinson Equation of State to Improve Volumetric Predictions”,Society of Petroleum Engineers,SPE 13118,1984.
[35]	Alani,G.H. &amp;amp; Kennedy,H.T.,"Volume of Liquid Hydrocarbons
at High Temperatures and Pressures",Trans. ,AIME(1960)	219
288-292.
[36]	Lohrenz,J., Bray,B.G. &amp;amp; Clark,C.R., "Calculating Viscosities of Reservoir Fluids From Their Compositions",J. Pet. Tech.,(agosto 1964) 1171-1176.
[37]	Carr,N.L., Kobayashi,K. &amp;amp; Burrows,D.B.,"Viscosity of
Hydrocarbons Gases Under Pressure",Trans.,(AIME) (1954)	201,
270.
[38]	Lee,A.L. &amp;amp; Gonzalez,M.H.,"The Viscosity of Natural Gases”,J. Pet. Tech. ,(agosto 1966) 997-1000.
[39]	Baron,J.D., Roof,J.G. &amp;amp; Wells,F.W.,"Viscosity of Nitrogen, Methane, Ethane and Propane at Elevated Temperature and Pressure",Jour. Chem. Eng. Data, (1959) 4, 283.
[40]	Fussel,D.D. &amp;amp; Yanosik,J.L.,"An Iterative Sequence for Phase-Equilibria Calculations Incorporating the Redlich-Kwong Equation of State", Soc. Pet. Eng. J.,(junho 1978) 173-182.
[41]	Nghiem,L.X., Aziz,K. it Li,¥.K.,"A Robust Iterative Method for Flash Calculations Using the Soave-Redlich-Kwong or the Peng-Robinson Equation of State", Soc. Pet. Eng. J.,(junho 1983) 521-528.
[42]	Janes,J.R. &amp;amp; Raghavan,R., "Interpretation of Flowing Well
Response in Gas-Condensate Wells”,Soc, Pet. Eng. F. E. , (setembro
1988) 578-594.
[43]	Chopra,A.K. &amp;amp; Carter,R.D., "Proof of the Two-Phase
Steady-State Theory for Flow Through Porous Media",Soc. Pet.
Eng. F.E. , (dezembro 1986) 603-608.
[44]	Gomes,H.P.,"Modelo Composicional com Formulação Totalmente
Implícita", Tese de Mestrado, Universidade Estadual de
Campinas, Campinas, novembro 1990.
[45]	Chopra, A.K.,"Transient and Steady-State Aspects of Gas
Condensate Well Performance”, Pet. Soc. of CIM
Prepint Paper
no. 88-39-42
[46] Branco,C.C.M. &amp;amp;
Coelho,S.L.P.F.,"Testes de
Permeabilidade
Relativa Água-Óleo,
Gás-Óleo e Óleo-Gás em
Amostras de
Testemunho do Poço
3-RNS-85 Campo de
Pescada", PETROBRÁS,
CENPES, Comunicação Técnica DIGER-091/87,
[47] Hawkins, M. F.,"A Note on the Skin
novembro 1987
Effect", Trans. ,AIME
(1956) 356-357.
Neste apêndice apresentam-se os detalhes da clássica dedução [24] das condições termodinâmicas que regulam o equilíbrio de fases. Partindo-se de um sistema homogêneo fechado, a primeira lei da termodinâmica na sua forma diferencial enuncia que:
dU = dQ + dW	(A.l)
A variação infinitesimal de trabalho reversível dW pode ser
expressa por:
dW = -pdV	(A.2)
A segunda lei da termodinâmica - processo reversível - por sua vez, fornece:
dQ = TdS
(A.3)
Combinando (A.2) e (A.3) em (A.l) obtém-se:
dU= TdS - pdV
(A.4)
Por definição a entidade entalpia H é:
H = U + pV
(A.5)
A diferencial de (A.5) leva a:
dH « dU + pdv +Vdp
(A. 6)
Substituindo (A.4) em (A.6) obtém-se:
dH = TdS + Vdp
(A.7)
Define-se ainda a energia livre de Gibbs G por:
G = H - TS	(A.8)
Cuja diferencial fica:
dG = dH - TdS - SdT	(A.9)
Usando (A.7) em (A.9) obtém-se:
dG = -SdT + Vdp	(A.10)
As importantes relações (A.4), (A.7) e (A.10), obtidas para um sistema homogêneo fechado, podem ser reescritas para um sistema homogêneo aberto como abaixo:
n c dU = TdS - pdV + £
(A.11)
n c dH = TdS + Vdp -4- £ m = 1
(A. 12)
n c dG = -SdT + Vdp + £
m = 1
(A.13)
componente m na mistura.
Onde n é
o número de moles do
potencial
químico Ç do componente m:
(A.14)
Combinando as equações (A.4), (A.10), (A,11) e (A.13) prova-se que o potencial químico também pode ser definido por:
(A.15)
Um sistema heterogêneo fechado, que no caso representaria um volume de controle no reservatório, pode ser encarado como um conjunto de subsistemas homogêneos abertos ou fases. Na situação de equilíbrio do sistema total não existem diferenças de potencial que induzam fluxo de massa ou de energia através das suas interfaces internas e assim cada um dos subsistemas passa a se comportar como sendo homogêneo fechado. O critério que contempla essa afirmação pode ser deduzido a partir das equações (A.11), (A.12) ou (A.13). Supondo que existam F fases e nc componentes e usando~se a expressão (A.11) escreve-se:
¿dsk = o k=1 £dVK - 0 k=1		(A.16) (A.17)
F		
£ dn = 0	m=l,2,, —n c	(A.18)
As relações anteriores valem, visto que não ocorrem mudanças de propriedades no sistema total quando no estado de equilíbrio, ou seja, as somas de variações de entropia, volume e de número de moles de cada componente são nulas. Assim as equações (A.16), (A.17) e (A.18) podem ser rearranjadas para se
isolar as variações numa fase 1 particular em função das
alterações ocorridas nas demais:
ds2= W k« 1 ,k*l
dV2= £ dVk
k«1,k*2
(A.19)
(A.20)
1	F	k dn =	£ dn m	m	m=l, 2,..	.. -n c	(A.21)
k = 1, k*l			
Escrevendo-se agora a equação (A.11) para o sistema total de F fases onde uma delas - a fase 1 - está escrita em função das demais obtém-se:
dU = T2dS2 + £ TkdSk j - j p^dV1 + £ pkdVk j +
k*2	k*1
(A.22)
+	£ f É1 dn1 + £ Çk dnk 1	= 0
m = 1 v	k = 1	*
k*2
Substituindo (A.19), (A,20) e (A.21) em (A.22) obtém-se:
dU = £ ÍTk- T1] dSk -	F E !	Ípk-P7] dVk	+ E £ (&amp;lt;-	£2]	dnk » 0 flj
k» t *•	'	k= 1 :	(.	j	®=1 k=o		
k*l	k*2		k*l		
					(A.23)
Os termos	referentes ã		fase k	são	linearmente
independentes já que	os	da fase 2,	admitida	couto	dependente,
foram escritos em função daqueles. Assim para que se verifique a condição de equilíbrio posta em (A.23), qual seja de variação
nula da energia interna total do sistema, todos
OS
termos em
(A.23) devem ser identicamente nulos;
logo:
T1=
_,2 T =
(A.24)
logo:
logo:
~2 ç =
ffi 01
As
pk" PJ » 0
(A.25)
m=l
(A.26)
equações (A.24), (A.25) e (A.26) são os
critérios
para a existência de equilíbrio de fases.
Introduzindo agora o conceito de fugacidade
componente m em
f de um m
uma mistura, definido, para temperatura
constante, por:
dG = RT dlnf m	m
(A.27)
Conceito que está
sujeito à condição:
p+Q
lim
(A.28)
= TF
2 P
f = p
çk “ ç1 = 0 m
= c
. .n
c
Ou seja, em baixas pressões a fugacidade se confunde com a pressão parcial do componente, o termo G na equação (A.27) denota uma propriedade molar parcial, no caso a energia livre
molar parcial de Gibbs, definida por:
G m
l ô n J
= e. m T.p.n.
j,
(A.29)
Conceito que equivale ao de potencial químico apresentado em
(A.14) e (A.15). Voltando à equação (A.27), esta pode ser
integrada, à pressão e temperatura
constantes, ao longo de n ~1 IR
(componente puro)
até um número n
m
de moles qualquer:
m
A
G
dG
tn
ff
m
RT dlnf
m
A
J f
m
Que resulta em:
RT jln
ln
(A.30)
A
Onde G
apenas da pressão e da temperatura
A	A
Logo, sendo G e f constantes, e ■ mm
expressa em (A,26) qual seja:
são propriedades
do
componente puro,
e independentes
como no equilibrio
funções
de fase.
a condição
G m
A
G m
y
e
A f m
Ç = €Z= m m
- c
m
-&amp;lt;n c
0 que implica em:
G1
m
j»*2
G
= gf
m
Pois G é igual
a potencial químico
M, de onde se
obtém em
conjunto com a
equação (A.30)
que:
fF
m=l,2,....n
c
(A.31)
f = f
n	m
1,2, . .
, .n
Ç
Assim a igualdade de
fugacidades de um componente m em
uma mistura em cada uma das
F fases de um sistema é uma
condição alternativa àquela vista em (A,26) para o equilíbrio de fases.
Finalizandof a fugacidade de um componente m em uma mistura, definida em (A.27) e (A.28), pode ainda ser escrita, como função de temperatura, volume e frações molares, através da equação [24]:
(A.32)
LÍQUIDO VAPOR
Neste Apêndice serão apresentadas algumas das derivadas das equações que compõem o modelo composicional e que constituem, portanto, os elementos da matriz jacobiana do sistema de equações. Por sua maior simplicidade iniciar-se-á com as expressões do equilíbrio liquido vapor, mostradas no item 3.2. Para uma célula genérica i,k elas são:
(B.l)
Onde m = 1,2,......n ; f , e f são as fugacidades nas fases líquida e vapor do componente m. Como visto nos itens 4.3 e 4.4 essa equação só faz parte do sistema nas células na região de duas fases.
A expressão (B.l) será derivada apenas em relação ao vetor de variáveis primárias da própria célula i,k, ou seja:
■x ., y„ í y,, n -1' -t2í Jí3' c
visto que a equação (B.l) não é dependente das variáveis das
células vizinhas. Com o tratamento totalmente implícito
adotado, as derivadas dessas equações são calculadas por:
	af	df	
3 f.	f )	ml . .  ’&lt;k 	i,k	(B.2)
ap	1	" &gt; °i, k	’ ' k	3P0 i,k	ap 0	
3	!		L	
f , - f	f , - f	= 0	(B.3)
as	1	j	liA	3S 1 -l	’ ’A	
9íA	"í.k		
t.
8f mL
i,k
ÕX.
para j=l,2,... ,n -1
c
(B.4)
sy. 1
\k
f IW
Ôf mv
i,k
6y
para j=2,3,*„,, n
c
(B.5)
Note-se que
em
(B.4) e (B.5)
índice m se refere
equação
do
componente m enquanto j indica
a variável independente sobre
qual se está derivando. As
expressões das derivadas
da
a
8x í

f
1
5 i,k
o
à
a
fugacidade em relação à pressão e composição, obtidas
via
equação de estado de Peng e
Robinson, estão detalhadas
no
Apêndice D.
As equações de fluxo
discretizadas dos
componentes
hidrocarbonetos, como mostrado
no item
4.1, para
uma célula
genérica
i,k, tem a seguinte forma:

A í ct xu
xü
5
A 2»
Vp. t
i , k At
[ bMhX8"*’
íxn pn
m o
sn + yn Pn sn ] 1	+ í q p X
O j « 9 s J J .	( ° o «
i ,k
(B.6)

+

+
•. U + 1
g g m
Onde m=l,2,.....,n . Além das equações acima, completa o modelo c
uma equação de balanço volumétrico para o componente água. Esta não será aqui considerada visto que suas derivadas são semelhantes às que serão demonstradas a seguir para os
componentes hidrocarbonetos. Fazendo uso da definição
operadores de
diferenças finitas no espaço
"abre-se"
dos
a
expressão (B.6)
que adquire a - extensa - forma abaixo:
T ,
ox2
pot ,
ox2
i+1/2tk
(-----------------
p - p + L .	0 ■
L i + i	i
4
+
k
T
ox1
pot oxl
M/2,k
I
[ Po - P. +
1 j	Í - 1
T'
r íz.~ z. 1 1
Vv2l ’	-‘U J

k
T „
9x2
pot .
gx2
r

+
w.
í+V2,k
ps ' ps +
“l+t "&lt;
g . , „I 1 + 1 t+1/2v


k
+
T 5 9*1
r~4- i
[“ ÀJy’
m
- i-1/2,k
T o z2
a A íx
l «) •
J i.k+1/2
(continua na próxima página)
POtsx1


k
pot „
’&lt;
1
v, ZJ ]
k + 1/2k	J
+
i
pot
011
T , S x 2		pot9IZ
	r	t	 1
(“ xJy«	[ í , k+1/2	p. ■ p9 + r. k.r ZJ 8k +1	8 k	8 k *1/ 2 »	J J
Acum
!----
v?í
At
Fix +c A p l ix p S + y p S 1 “ fx p S + y p s jl
II	rtoj^moo	m s 8 J Imoo	m g g J j
4-k
Fonte
----------------------
+ q p y s g Bl
3 V+t
h ,k
(B.7)
Onde em (B.7) tem-se que:
pf krf
p = p + P	e	À = -------- (f=o#g)
*g *0	ego	f	Pf	'	J
Durante o desenvolvimento de (B.7) foram indicadas variáveis auxiliares com o objetivo de facilitar a derivação. Elas representam as diferenças de potencial potf t e transmissibilidades T,, (onde f^O/g; i=x,z e n=l,2), termo de T l n
acumulação «Acum* e termos fonte *'Fonte". Fazendo uso dessa nova notação a expressão (B.7) ganha um aspecto mais compacto:
Ít	,	x	pot	1	~	Ít	x	pot 1	+
1	*L	ox2 i ,	I	oxi	m.	,	„	oxi I
v	1+1/2	'k v	í-1/2	'k
+	|T	„	y	pot	1	-	|T	V	pot I	+
l 9X2	mí+1/2	Sx2Jk	t	sxl	V	8xlJfc
+	~	\	POtnj	+
&amp;lt;012	W	ox^í	t	oz1	Vi/2	0Z1Jí
*	|TnI?	Ym	POtni?l	“	ÍT«1	Xn	pOto,ll	= ACUÍ[l + FOnte
l SZ2	mfc+1/2	gz2j.	t	gzl	mfc	gzlj.
(B.8)
Na construção da matriz jacobiana, para geometria bidimensional e esquema de cinco pontos, a expressão (B.8) é derivada em relação a cada uma das variáveis dos seguintes vetores de incógnitas:
( \&lt;,,t • V&gt; ■	■ s,.k., - X,.,.» )
(B.9)
onde X -í p S S ,x,.x2..............x„.,-y2'y3..........yn )
Observar que, por característica da formulação proposta, as derivadas das parcelas de fluxo (lado direito da equação (B.8)) em relação às variáveis composicionais são nulas nas células de duas fases. 0 tratamento passa a totalmente implícito na variável x	_ nas células de fase única líquido, e em y	nas
n “ i	z
c
de fase única vapor.
0 desenvolvimento neste Apêndice de todas as expressões das derivadas de (B.8) em relação às variáveis em (B.9) seria extremamente repetitivo. Assim sendo apresenta-se abaixo, como exemplo, a derivada da equação de fluxo (B.8) da célula i, k (F ) em relação à pressão p° .As demais derivadas são facilmente deduzidas a partir da técnica exposta a seguir. Assim:
f
SF
i ,k
3p
X
x2
3pot
L ox2
SP
0 -
i , k
ST
pot ,-----
°X 3Po
i A
0X1
4-
x2
4-
y"? z2
apot
oxi
3p
0 i , k
ôpot
9 x í
5x2 ap
0 i , k
Spot
9 x1
g xl
oz2
oz1
4*
4’
*z1
L.
3p
0 - L i , k
8P0toz2
8p0
i , k
apot .
o z 1
ap o .
í f k
5POt9z2
apot„1
T
sx1 ap °í,k
ap
° i , k
4-
3T
pot ------^1.
P 0X1 ap
°i,k
pot
ai „ 9x2 8X2 ap °i,k
3T
Sxl
pot , 8x1 ap
°i,k
ÔT „
*.	O X 2
pot -----------
0x2 ôp °i,k
ÔT ,
,	o z 1
pot-“V“
°i ,k
pot -
912
5T , sii
pot
ap
°í,k
4-
4-
(B.10)
i,k
8Acum
ôFonte
apo
i.k
ap
°i,k
X m
x 1
x 1
X
z 2
X
Z 1

V
f

/

/
L


r

/
T

T
T
T
T
T


+

+
/

/

7



y
+
+
+
4-
+

z
T
»z2
+
ST „
9 í2



y

Em (B.10) aparecem termos, denotados por x e y onde i=x,z, ai	** m	r r
In	l n
n~l, 2 e W“l,2,....,n ; que indicam as frações molares nas fases líquida e vapor nas interfaces da célula. Como já comentado no item 4.1, tais variáveis foram avaliados pela técnica de ponderação com um ponto a montante. Além desses, a equação (B.10) contém termos relativos às derivadas de diferença de potencial, transmissibilidades, termos de acumulação e fonte. Algumas dessas expressões são exemplificadas a seguir:
Spot
ox2
0P O. .
T tK
--------- [ p - p + r íz. - z l 1 ap L °í+1	5+1 d Jk
°i, k

(
-1
(B.ll)
derivada
do
peso específico na interface
de célula,
, única f ♦ 1 / 2 , k
média ponderada
propriedade de
dos valores
contíguas (e
não
por ponderação
obtida por:
5ro
°i»V2,k
3pn
*,k
0P.
i , k
interface que é calculada pela
que
com
w y + 11-
x. . o. t l 1*1 1+1 v
õ?
ap
,k
Onde em (B.ll) e (B.12) o fator w
esta assume nas células
um ponto a
montante), foi
(B.12)
de
ponderação depende da
A
7
o
5

w x
1
+11 1
k
geometria da malha (para cartesiana
de diferença de potencial são obtidas de forma semelhante.
As derivadas das transmissibilidades são calculadas
segundo o exemplo:
ST ,
cxl
ap
— M ■
ap V j-1/2,k o
irk
Ôp o.
i,k
p k
o ro

' 1 - 1 /2,k
(B.13)
Como descrito no Ítem
4.1,
os
termos
p0, k
e M são avaliados
0
com ponderação cora um
ponto a
montante. A derivada em (B.13)
dependerá
portanto do
sentido
de fluxo. Assim tem-se que:
F 0
-fluxo de
Ô c p k '
— “-vH
		0	i , k	
i ,k	í,k			(B.14)
8p	p
t&gt;	o
Ôp	M2
0	o
dp
Q
Sp
r c
	r i	sp	1	5p J	
= T , oxi k		o SP.	o	0 8p	i ,k
-fluxo de i-1 para i: nesse caso os valores de p , p e de k serão iguais aos da célula i-1 e a derivada em relação a p
°i,k
será nula. T terá derivada não nula em relação à p
o x 1	O .	,	.
i , k
Continuando com as derivadas indicadas em (B.10), a do
termo de acumulação fica:
&amp;amp;Acum
ap
0 í ,k
ap
[W. + W,J +
n
- [w.+ wj ],
(continua)
a
ÔAcum	
ôp	At
°f,k	
U+1
c xpS + y p S I +Í1
+ y S mg
ap9
SíV
1
+c A p r to
X S ■ m ü
SPo&amp;lt;5p
o
(B.15)
+
k
Como se observa as derivadas dos tensos do passo de tempo n são nulas uma vez que eles são constantes durante o andamento das iterações do passo de tempo n+1.
Por sua particular importânciat desenvolvem-se a seguir as derivadas do termo de acumulação em relação às variáveis saturações de gás e de água e frações molares nas fases líquida e vapor (que, obviamente, não farão parte de
(B.10)
mas que aparecerão nas derivadas das equações de fluxo
quando
estas forem derivadas em relação a
essas variáveis).
Assim:
âAcum
ÔS
8 i,k
Vp Pi,k
At
íl+c A p Uy p - y S -----~
l r * r» 8	8
9
ÔP ego
as
9
V+ 1
“ XP 1 m o)
J i ,k
(B.16)
SAcum
as
f ,k
VP. „ i ,k
At
U + 1
(1+Cr\pJ ( * V.)
(B.17)
SAcum
3p
Jfjc
V+1
sx.
1 i ,k
At
íl+c A p I íx S
l r t oj l » o 5x
J
+ p S S . | O o » , J J
-H,k
SAcum
m

Vp
yi,k
At
3p	17+1
í 1+c Ap 1 íy S --------+ p s Ô 1
l r 1 CJ l * 9 ôy 0 0 m, ¡J
1 j
Onde em (B.18) e (B.19) o índice m na
indica que esta corresponde à equação
(no caso sendo derivada em relação ao
S .
. i
cuja fração molar
dependerá da identificação
de m
é
expressa em
(B.19)
adotado que:
X n c
1
n c
- J&gt;,
W = 1
e
líquida e q =
Sx m
ax. j
ax
m
ou
âx
¡
SX
8X.
i,k
vari ável auxiliar Acum
de fluxo do
componente
e de j além
função da dos
n c
y, -1 -1 y.
m =2
n c
1 para a fase vapor) obtém-se os
ôy
m
OU ------
ay. j

%
5 m ,
ou
sy m
%
Retornando
componente m
j).	0 termo
do componente
demais. Foi
para a fase
m , j
s.,¡ “ 1 Para » ' 3
e m # q;
j
-1 para m = g e
j qualquer;
5	. = 0 para m * j e m * q
w , j
às derivadas indicadas em (B.10), restam
por determinar as dos termos fonte. Em relação à pressão:
aponte
d
õp	ôp
®	»	t,	® -	1,
i , k	i ,k
f + lu+1
w.+ w. J, k
1
(B.20)
Operando a derivada era (B.20) obtém-se:
8F o nte
x
m
i , k
(B.21)
As derivadas dos terraos fonte era relação as demais variáveis do problema são obtidas de forma semelhante.
Era (B.21) resta determinar as derivadas das vazões
volumétricas a nível de reservatório qf (f=o,g). Seu cálculo, visto em detalhe no item 4.5, emprega a expressão:
(B.22)
Onde o diferencial de pressão Apfe depende da condição de contorno imposta. Assim a derivada das vazões em (B.21) terá expressões diferentes em função do tratamento dado à pressão de fluxo. Duas situações são possíveis:
l)Para pressão de fluxo na base (k=kí) das camadas abertas p especificada:
(B.23)
Sendo H
0. Em (B.23) tem-se que:
'wi/2
(B.24)
Neste primeiro caso, as derivadas da vazão qf foram implementadas adotando em (B.23) de forma explícita (na
iteração
prévia) e desconsiderando diferenças de pressão entre
as fases
óleo, gás e
água. Ou seja, admite-se que p = p ~ p e o S w
que
é constante
em qualquer k. Logo:
(B.25)
As considerações quanto ao tratamento do termo Hk descritas acima foram motivadas pela complexidade que um tratamento totalmente implícito deste termo geraria na montagem da matriz jacobiana.
2)Para vazão especificada a nível de separação de fluidos em
superfície
demonstrou-se no item 4.5 que Apk é obtido
por:
1
Ápt
q P cs os “T¡
kf	f k
s p.-r
k=ki	k	o
k	.
+	1
9	!k
(B.26)
Para vazão
de óleo especificada; já para
vazão de gás
usa-se a
expressão:
q p gs gs
Apfc
Vs
IIP&gt; (+ p )k
Neste caso as	derivadas de qf	foram calculadas admitindo:		
-Tratamento	explícito das	variáveis	composicionais	de
superfície (L$	, V , p	e p ) S	os	gs	, As razões	desta hipótese	são
discutidas em detalhe no item 4.5;
-Desconsiderando as derivadas do termo em somatório em (B.26) e (B.27) em relação a quaisquer variáveis que não sejam as da própria célula ifk sob consideração. Adotou-se essa aproximação visando simplificar a montagem da matriz jacobiana;
-Diferença de pressão Apfc ~ Ap constante para qualquer k.
Definindo-se agora as variáveis auxiliares:
	q P ■^OS OS	q p 9$	9$
C		
		
	Ls	Vs
conforme tenha-se	q	ou q os	gs	especificado; e:
T	kf	, - E k=kí	k	k	x a	ro + n	t» |
		Po p	Pg M J&amp;lt;?	g f k
A derivada da vazão q em relação à pressão fica:

3
IP
3
IP
r IP k , r f	r Ap	Sp	c 	.	-I-	ÔT	
-		apo	T2	ap	
(B.28)
k
Em (B.28) a derivada da variável t é obtida por:
ÔT	a	k f £ iPfc k» k i	í p kro	k + n	r9	
ap l.k	0 ■ 1, it k		lp»	S	¡1 9	Jk
- k	ôp	pn		k		ap			
ro	0	0	0	+		9	g	s	
tf 0	ôpn		ap			ÔPn	p	ap	1 &gt;
	0 k	0	0 J			0 k	9	0 J	
(B.29)
As derivadas da vazão em relação as demais variáveis do problema (saturações e frações molares) são calculadas de forma semelhante.
As derivadas das propriedades densidade molar (p), peso específico (r) e viscosidade (p)t que aparacem indicadas ao longo das equações deste Apêndice, são deduzidas nos Apêndices C (p e y) e E (p) respectivamente.
Revisando o item 5.4, as expressões para o cálculo das densidades molares das fases líquida po e vapor pg incorporando um terceiro parâmetro [34] na equação de estado são:
		1	n c	
v,			= v,	- r c x
				
1		p	1	¿'mm
		0		
(C.l)
	1	n c
V = -		= V ~ £ c y
9	P9	g	, m ffi m-i
(C.2)
Onde v (com índice i ou v)
é o volume molar dado por:
Z R T
v = -------
P
(C.3)
As expressões (C.l) e (C.2) são idênticas, a menos da fração molar que ora assume valores da fase óleo ora da fase gás. 0 mesmo ocorre com as expressões das derivadas em relação à pressão, escrita genericamente como:
3p	-V	' 1	8Z	1	
ap	í v r	. Z	3p	P	J
(C.4)
As derivadas em relação à composição, por sua vez,
dependerão da identificação do componente cuja fração molar é expressa em função da dos demais. No caso da fração líquida este componente é o último, para o gás é o primeiro. Assim:
Identificar-se-á a seguir esse componente, que não é variável
primária, com
o índice q ;
para a fase líquida
q = 1 para a
fase vapor.
ainda a derivada
em
genérica x.,
valores do liquido ora do gás, dependendo
relação à uma
fração molar
que ora assumirá
os
da situação. Isto
posto, a derivada
da densidade em
relação à
composição fica:
ap
-1
ôx
J
H2
az
----- ~ c
J
ôx.
j
(C.5)
R T
P

+ c
q
j
e
Onde j = 1,2,.....,n -1 para a fase líquida e j =	2,3,___n
c	c
para a fase vapor.
Conhecidas as derivadas da densidade molar, o cálculo das derivadas do peso específico é feito de forma direta a partir das anteriores.
As expressões para as derivadas do fator de compressibilidade Z em relação à pressão e à composição são apresentadas a seguir. Revisando sua equação tem-se:
(C.5)
onde:
b p
B = ------
R I
a P
„ 2 —,2 R T
e
Os parâmetros a e b, calculados por componente e depois combinados através de regras de mistura, foram definidos no
item 5.3 quando se apresentou a equação de estado de Peng e Robinson. Derivando-se a equação (C.6) em relação a uma variável genérica Xf que poderá ser a pressão p ou uma fração
molar x ou y , obtém-se: «	rí
? az
3Z -----
ax
2Z 1
£Z
ÔX
oB
+ z2 —
ax
A - 3B2 - 2B
az
----- +
ax
f	SA	SB	ÔB	.	(	SB	5A
+ z		- 6B 		- 2	‘ A 	 + B	
1	SX	ax	ax	'	( ax	8X
ÕB
---- +
ax
- B
j
+
ôB
- 3B2 ----- = 0
ax
(C.7)
az				
Isolando-se em (C.7) o termo 				e rearranj ando	os demais
		ax		
obtém-se a	expressão	genérica	da derivada do	fator	de
compressibilidade:

ÔZ
ax
Ôfí
ÔX

(C.S)
Para completar a procedimento resta determinar as derivadas dos
parâmetros A e B em relação â pressão e à composição. Sendo os
parâmetros a e b independentes da pressãot obtém-se:
3A	3	í ap 1 _	a	A		(C.9)
3p	ôp	1 R2 T2 &gt;	2 2 R T	P		
3B	8	í 8 P 1 -	b	B		(C.10)
Sp	&amp;lt;R T '	R T	P		
As	expressões	das derivadas de A e B		em	relação à
composição	estão escritas abaixo em função de uma fração molar				
genérica, no caso x. ,		que tanto pode indicar		fase	vapor ou
líquida:					
3A	õ	a p	P	3a		(C.ll)
õx. j	j	[ r2 t2 J	2 2 R T	ôx. j		
ÔB	8	í b p ] -	p	3b		(C.12)
sx. j	¡	1 R T	R T	ax J		
As derivadas indicadas em (C.ll)
e (C.12) serão dadas novamente
em função do componente q cuja fração molar é expressa em
função da dos demais. Logo:
db
âx.
d
ôx.
j
b x +	+
11 2 2
+ b x I n n j c c7
Substituindo na expressão anterior a fração molar do componente
n c q por x = 1 - £ X m= 1
e operando a derivada indicada obtém-se:
ab
— = b ÔX.	J
J
- b q
onde q = nc para liquido e q = 1 para vapor
(C.13)
Para
3a
---- usa-se o mesmo procedimento obtendo-se:
3x
ôa	d	f n	n c	c Ela xx 1 ffl=1 n=1	J	=2 4 *4		
ax. j	dx i				(C.14)
Onde q	= 1 para a fase vapor e q - n para a c				fase líquida» Os
passos	intermediários para a		obtenção	de	(c.14) são muito
extensos - o duplo somatório precisa ser ’’aberto*' - e, portanto, não estão aqui documentados. Aponta-se apenas as importantes relações abaixo, essenciais para a obtenção de
(C.14):
-a = constante
APÊNDICE D - DERIVADAS DAS FUGACIDADES
A equação da fugacidade, integrada através da
equação
de estado de Peng e Robinson, é revista abaixo:
ln
A
2 /T B
b m
b
n c	'*1
2 r x a	b
,	n n,m	m
	
a	b
ln
Z + 2,414 B
Z - 0,414 B
A expressão acima indica a fugacidade do componente m na fase líquida. A expressão para a fase vapor (f ) bem como a de suas m v
derivadas serão idênticas, sendo que nestas as frações molares a serem usadas são as da fase vapor. Isolando-se a fugacidade na equação anterior obtém-se:
1
P x -&gt;--------r
Pt ’ B ]
-A
Onde:	D = ---------
1	2/~2" B
' Z + 2,414B	1
Z - O,414B 1 J		exp
n		
c		
2 E X	a	b
		m
n=1		
a		b
y
(D.2)
(D.l)
Definindo-se agora as seguintes variáveis auxiliares:
“ K - b]
0.
' Z + 2,414B
Q =	--------------
1	Zt - 0,414B J
(0.3)
(D.4)
&amp;amp;{ = exp
b	f
—
b	'•
z í
(D.5)
Usando (D.3), (D.4) e (D,5)
era
(D.l) obtém-se a expressão
compacta
fml
P Xm
-----— w fi
( pl
el
{D.6)
Derivando-se
agora a
equação (D.6)
em relação
à
pressão:
Sf , m l
X

5p
ei
A * P\
e
J ap
+

ôíd^
+
wi

Rearranjando a
expressão

5p
el
ôp
acima obtém-se
af , ml
P X
m
1
1
ae 1
ap
ei
L
P

ap ,
Wt0t 4- /3
ôwi
1 ap
+

o — ap
(D.7)
Resta
agora
determinar
as
derivadas apenas indicadas
em (D.7).
Assim:

a
az
SB
(D,8)
ap
ap
ap
ap

8
' Z + 2,414B 1

ap
ap
Z - 0,414B
Dl
k
' Z + 2,414B ?
V1
Zt - 0,414B j

(D.9)
Note-se que a variável auxiliar D ,
definida em
(D.2)
não
depende da pressão. En (D.9) o termo I
i
dado por;
/

ap
d
---- .
Ôp
' ÕZ	ÔB 1
+ 2z414-^~
-..
-£zi+2,414bJ
^-0,4148^

exp
b , rí*'
•&lt;
1
J
Ô
1 Sp
L.

b
= 3. —
b
SZ
Sp
As expressões
das derivadas
de
Z
e
dos
foram mostradas no Apéndice
C;
a
e
' az
”ãp	0,414gp-
h----------------
ÔB
(D.10)
b
m
b


(D.ll)
parâmetros
A e B já
b não dependem da
pressão.
As derivadas em relação à composição, que serão desenvolvidas a seguir, estão indicadas em termos de uma fração molar genérica x^, que poderá assumir valores da fração líquida ou da fração vapor conforme o caso. Outra observação diz respeito ao componente cuja fração molar está expressa em função da dos demais (logo não é variável primária). Adotou-se no simulador composicional o seguinte procedimento:
n	n
e	c
x = 1 - £ x	e	y. » 1 - £ y
n	. m
€	m = 1	m = 2
Daqui por diante este componente será indicado pelo índice q; onde q = nc para o liquido e q - 1 para o vapor. Isto posto a
derivada da fugacidade em relação à composição,
baseando-se na
equação {D.6),
fica
af f
rei
ax.
9X. J
8.
P
— Wl	+
H t t
Sl
a
Px_ ÍR
w fí
LP l
el
(D.12)
Onde
&gt;1,2,
...,n -1
c
que
são os índices
das
frações molares
a
p
X m

B

/

*
variáveis primárias para a fase líquida {
aqui
q
n ) ; e c
&gt;2,3,.« .. ,n para a fase vapor ( aqui q
i)
; e finalmente
m***! f 2 f » • . • ,
nc que são os índices das equações de fugacidade. Em
vale:
dx
m
ax
. = 1 para » =
e m * q;
dx
m
j qualquer;
3x
j
õx
&lt;n
dx. j
. - 0 para m * j
Continuando o desenvolvimento de
(D.12)
obtém-se:
3f , ml
ax
í
el
w fi 3 . -ll m,j
aei 1
0i
dx
i
dx
J
30 /
UL-----
ax
3J
5 m ,
p
/
5
3
i
e
3
ffi f
X m

x
m
3
e m * q

i
+
(D.13)
Resta agora determinar as derivadas apenas indicadas em (D.13)
Elas são obtidas por:
88
3x,
1
ôx.
J
(v
ÔZt
ÔX
ÔB
ôx
i
(D.14)
A derivada de
(definido em
(D,4)) em relação
a composição:
aw
r Z + 2,414B
contém termos, Z
composição
ôx.
j
ÔX.
J
Z, - 0,414B
(definido em
(D.2)), que
são funções da
Logo a derivada
acima é
do tipo:
3

w t
8

e D
t
Sendo u e v funções de x. Logo obtém-se:
Dt-1
8u) 1	- Dt	z.	+ 2,414B ’	1	3	í Z + 1	2,414B '
ÔX. i		z	~ 0,414B j	ÔX . J	L \ -	0,414B J
+ 2,414B 1
-A
+ u( ln
Z - 0,414B
ÔX
J
2'/~2 B
n
c
2 E x a , n n , m n= 1

8


a
b
m
b
(D.15)
A notação dos índices em (D.15) é um tanto complexa, merecendo assim um breve comentário. Em (D. 15) m indica o número da equação de fugacidade que se está derivando (in=l,2,... ,n ) ; j indica a variável independente sobre a qual se está derivando
(j-1,2,.—,nc sendo j*q) ; n é o índice auxiliar no somatório
e, finalmente, i indica que
a fase considerada no exemplo é a
liquida. Era (D.15)
faltara
ser escritas
as
derivadas apenas
indicadas

d
Z + 2,414B '
ax
j
Z ~ 0,414B j
^-0,4148^
X-
' sz
dx j
3B 1
2	¿14—----
' 3x
J
1
Zt+2,414B
az	3B ’
a5T " °'414~aSr
1
^-0,4148^
+
f
(D.16)
“A
n
c
2 £ a x , n,m n n=d
ex. i
2/~2 B
(D.17)
a
r
V
a
b
m
b

J
IIt + IIIt
onde era (D.17) os termos II e III sao:
•*A
III — -------
1	2&lt;"2 B
a
3x j
j
(D.18)
(D.19)
-A
2^~2 B
-2	r %	i	9a	2	a	r n	&gt; c	b	3b
		Xa x	-	 •+			?a x	+	—
a2	lns1	J	dX. i	a	dx. j	n'm n	b2	3x.
b
b

Na expressão (D.19) as derivadas dos parâmetros a
relação à composição foram determinadas no Apêndice C.
e b em
Quanto a
derivada
do somatório
indicada
em (D.19) tem-se que:
8X.
}
Z n c
E,a'
a.
j,m
3, q,m
(D.20)
pois
3x.
J
1;
ax q
-1
3x
m
ax. j
dx
J
ax j
0 para m * j e
m * q.
Concluída
a derivada
de
do
termo restante é
dada por
"i
8X
I
ax
j
- exp
1 ax.
-b
m
b2
ab
b
Hl
az
i
ax. j
ax. i
(D.21)
d

x n

r

e
a
8&amp;amp;í

a

b
b

[z

4*
1
J
b
► = 3
)
a
J u
b í
" (z.
b
Conclui-se assim o cálculo das derivadas da fugacidade em relação à composição. Sua fórmula genérica foi mostrada em (D.13) e suas parcelas estão desenvolvidas em (D.14), (D.15) composta das expressões de (D.18) a (D.20), e de (D.21) logo acima.
APÊNDICE E - DERIVADAS DE VISCOSIDADE
Como visto no item 5.6, o cálculo das viscosidades pela correlação de Lohrenz et. alii. [36], após uma série de etapas intermediárias, conduz ao final ã expressão (5.24), reproduzida abaixo:
M = p* +
aA + a p + apz + a,p3 + 0	r r	2 r	3 r

(E.l)
Usar-se-á a equação acima como
ponto de partida para as
derivações da viscosidade.
Assim,
derivando (E.l)
em relação
à
pressão obtém-se:
ôp
4
ap
(a + a p + a p^ 0 V r 2Hr
3 a p
3 r
+
c
,	4 V QP,
+ a4Pr -------
' Sp
* ( a! + 2a2Pr + 3a3Pr
4az)
(E.2)
*
Note-se que em (E.l) nem p
(definido
em (5.18) e
(5.19)) nem
(dado em
(5.25)) dependem da pressão.
Resta apenas determinar
derivada
de p^ indicada em (E.2):
5pr
ôp
ap
ap
Pc
ôp
(E.3)
4-
C
a
8
1
O cálculo da derivada da densidade em relação à pressão, indicado em (E.3), já foi visto no Apêndice C. observe-se que, por imposição do método de Lohrenz et. alii., esta derivada deve ser calculada em lbmol/pé!
As derivadas da viscosidade em relação à composição dependerão do componente cuja fração molar é dada em função da dos demais. No modelo composicional em questão adotou-se:
Esse componente será identificado daqui em diante pelo índice q (q = nc para a fase líquida e q = 1 para o vapor). As derivadas serão expressas em relação a uma fração molar genérica x^, que poderá indicar as frações molares no líquido ou vapor, conforme o caso. Derivando (E,l) em relação à composição obtém-se:
- 3

---- «r ------- +
ax.	sx.
j	j
ax
(E.4)
C
Note-se que y* (definido em (5.18) e (5.19)) e Ç (definido em
(5.25)) dependem da composição. Em (E.4) introduz-se uma variável auxiliar 0 definida como:
p =	ía„ + a,p + ap2 + a_p3 + a p4 ] - a 1 0	fr	2 r	3 r	fr )	5	(E.5)
Resta operar determinadas	as derivações indicadas em (E.4). a seguir:	Elas serão
Continuando na equação (E.6):
/ /~pm~
q	q

J
n c
I
m= 1
*1 2


j
X p* /PM j m m	m J
n E' (x.
m = 1 k
/'pjF
m
A derivada de $ en relação
a

a
n 2
x. será: j
(E.7)
ax. j
ax. j
[% + a
A+
«2 a,p 2 r
4-
3 ,	4 1
a o + a o - ar
3 r	4^r J	5
4
|a„ + a o + ( o r r
2
a,P
2 r
+
a.

+ \PÍ)
Onde en
apr
ax, j
(ai+ 2a2pr + 3a3p’
+ 4a p3 |
4 r J
apr
5x
j
(E.8)
(E.8)
a
Sx
3
E	[
Ht=1	'&gt;
a derivada
(pv. ]
x v j m em )
de
a
ax. j
ap
&lt;9x j
Pr é expressa por:
n
p L í m=1 1
X V I m ero J
+ P

- V 1 cq }
(E.9)
Em (E.9) a derivada de p em relação à composição já foi vista no Apêndice C. Note-se que aqui ela deve ser usada em unidades de Ibmol/fraçâo.
Resta somente a derivada de C, que é deduzida abaixo:
ac	&amp;amp;		/	n	v c £ X T m cm			1/6	
ax.	ôx. j	j	% 1 £ x PM m m L 1 *n='t	J		1/2	r n	) c Z x P m cm 1m=1	J		2/3
		s n	\		1/6*1	
SU	a		c		
			£ x T		
					
8x. j	8x 1		m cm 1 m=1	J		
í T . - T { ej	cq J	f n	x c £x T m c m 1	J	- S/6
6		
	(E.12)	
av
ax
8x.
1
	f n	1 c	&gt;w 1/2
	£ X PM ■‘"'mm	
	1	J	
PM. - PM^ j
2
- 1/2
8
(E.13)
3w	8
8x.	3x
J	1
Compondo os
mostrada em
f	n	1 c	2/3'
£ x P , m cm	
J	
' 1/3
termos em (E.12),
composição
n c
(E.14)
(E.13) e (E.14)
segundo
a
regra
(E.11) obtém-se a derivada de Ç
em relação à
PRESSÕES CAPILARES
As propriedades dos pseudo componentes que constituem o gás retrógrado e o óleo volátil usados nas simulações são apresentadas no quadro abaixo:
Variável	Pseudo Componente					
	PI	P2	P3	P4	P5	P6
Peso molecular	16,19	30,39	52,03	108,54	184,41	340,88
Fator acêntrico	0,0084	0,1009	0,1773	0,3758	0,5060	0,8290
Temperatura crítica-°K	190,41	305,70	400,09	555,18	742,39	915,79
Pressão crítica-MPa	4,625	4,951	4,001	2,620	2,203	1,363
Fator Z critico	0,2897	0,2859	0,2782	0,2652	0,2490	0,2297
Os coeficientes e da equação de Peng e Robinson
estão individualizados por componente na tabela abaixo:
Pseudo Componente	£1 a	£7 b
PI	0,45609774	0,07777048
P2	0,45717847	0,07809970
P3	0,46444995	0,07891221
P4	0,46980425	0,07945527
P5	0,45723553	0,07779607
P6	0,45723553	0,07779607
Os coeficientes de interação binária 5	entre os
«i f J
pseudo componentes m e j são dados na matriz abaixo:
Pseudo Comp.	PI	P2	P3	P4	P5	P6
PI	0,00000	0,00001	-0,00250	0,03069	0,04647	0,05519
P2	0,00001	0,00000	-0,00081	0,00987	0,00987	0,00987
P3	-0,00250	-0,00081	0,00000	0,00236	0,002 3 6	0,00236
P4	0,03069	0,00987	0,00236	0,00000	0,00000	0,00000
P5	0,04647	0,00987	0,00236	0,00000	0,00000	0,00000
P6	0,05519	0,00987	0,00236	0,00000	0,00000	0,00000
Finalmente, as tabelas a seguir apresentam os dados de pressão capilar agua óleo (P ) como função da saturação de água e de pressão capilar gás óleo (P ), função da saturação de gás.
			11 s w (fração)	P C W 0 (KPa)
0,180	68,9476
0,225	38,6101
0,250	26,8896
0,300	16,5474
0,350	7,9290
0,400	6,8948
0,450	4,4816
0,500	3,1026
0,600	1,3790
0,700	1,0342
0,800	0,6895
1,000	0.0000
s 9 (fração)	P ego (KPa)
0,000	0,000
0,100	0,130
0,200	0,270
0,300	0,450
0,400	0,710
0,500	1,020
0,600	1,500
0,700	2,100
0,730	2,150
0,820	2,150
Como comentado nos capítulos 7 e 8, os dados de pressões capilares foram empregados apenas nas simulações de reservatórios de óleo.</field>
	</doc>
</add>