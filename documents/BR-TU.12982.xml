<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.12982</field>
		<field name="filename">18794_arquivo7658_1.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
  

UNIVERSIDADE FEDERAL DE PERNAMBUCO 
CURSO DE PÓS-GRADUAÇÃO EM ENGENHARIA MECÂNICA 

 
 
 
 
 
 
 
 
 
 
 
 

ACELERAÇÃO DE CÁLCULOS E VISUALIZAÇÃO DE PROPRIEDADES 
TERMODINÂMICAS 

 
 
 
 
 
 
 
 
 
 

DISSERTAÇÃO SUBMETIDA À UNIVERSIDADE FEDERAL DE PERNAMBUCO 
PARA A OBTENÇÃO DO GRAU DE MESTRE EM ENGENHARIA MECÂNICA 

 
 
 
 
 
 
 
AUTOR:    ROGÉRIO SOARES DA SILVA 
ORIENTADOR(A):  PROF.ª ANA ROSA MENDES PRIMO, PhD 
CO-ORIENTADOR:  PROF. RICARDO LESSA AZEVEDO, DR 

 
 
 
 
 
 
 
 
 
 
 
 

RECIFE – PERNAMBUCO – BRASIL 
FEVEREIRO – 2004 



  

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

S586c        Silva, Rogério Soares da. 
                         Aceleração de cálculos e visualização de propriedades  
                     termodinâmicas / Rogério Soares da Silva . _ Recife : O Autor , 
                     2004. 
                         xii, 55 folhas : il. ; fig. e tabelas. 
 
                         Dissertação (mestrado) – Universidade Federal de Pernam- 
                     buco . CTG. Engenharia Mecânica, 2004. 
 
                         Inclui bibliografia e apêndices. 
 
                         1. Propriedades termodinâmicas – Software . 2. Diagramas  
                     termodinâmicos. 3. Processos e sistemas térmicos. I. Título. 
 
                                                                                                                  UFPE 
                         621                 CDD (21.ed.)                              BCTG/2004-12 
 



  



  

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

ACELERAÇÃO DE CÁLCULOS E VISUALIZAÇÃO DE PROPRIEDADES 
TERMODINÂMICAS 



iv 

  

AGRADECIMENTOS 
 
 
 
 

MEUS PAIS ARLETE E SÉRGIO 
 
 

PROF.ª ANA ROSA M. PRIMO 
 
 

PROF. WILHELM TEGETHOFF 
 
 

ANTÔNIO CLAUDENÊ CORREIA 
 
 

PETERSON CAVALCANTE 
 
 

CAPES 
 
 

DEMEC 



v 

  

ACELERAÇÃO DE CÁLCULOS E VISUALIZAÇÃO DE PROPRIEDADES 
TERMODINÂMICAS 

 
 

Autor: Rogério Soares da Silva 
 
 

 
Orientadora: Profª. Ana Rosa Mendes Primo, Ph.D 
Co-Orientador: Prof. Ricardo Lessa Azevedo, Dr 

 
 

RESUMO 
 
 

Este trabalho apresenta o desenvolvimento de um software para aceleração de cálculos 
de propriedades termodinâmicas por meio de interpolação linear de dados previamente 
calculados por equações de estado de múltiplos parâmetros, com pressão e entalpia como 
argumentos de entrada. A precisão dos valores interpolados encontra-se dentro dos 
parâmetros pré-estabelecidos. O programa incorpora a construção de um diagrama 
termodinâmico pressão-entalpia para a visualização de isotermas, isocóricas e isentrópicas, 
assim como fornece de forma imediata o valor da temperatura, densidade, entropia e título.  

É indiscutível a importância do conhecimento das propriedades termodinâmicas em 
qualquer projeto de sistema térmico ou equipamento de refrigeração. Tendo como precursora 
a equação de estado de van der Waals, passando pelas equações cúbicas e viriais, chegou-se à 
fonte mais precisa de dados de propriedades termodinâmicas: as equações empíricas de estado 
de múltiplos parâmetros. Se bem desenvolvidas, estas são capazes de representar propriedades 
termodinâmicas tão precisamente quanto os mais precisos dados experimentais. Quando isso 
acontece, tais equações tornam-se equações de referência para várias substâncias, não 
havendo necessidade de recorrer a dados experimentais ou tabelas. 

As equações de estado de múltiplos parâmetros só puderam evoluir graças à crescente 
capacidade de processamento dos computadores. Na simulação de sistemas térmicos, há a 
necessidade de se obter dados precisos e imediatos ao longo de um ciclo termodinâmico. Uma 
simulação de uma unidade térmica pode exigir centenas de dados de várias propriedades 
termodinâmicas aplicadas a vários componentes de um ciclo, tais como: compressor, bomba, 
evaporador, condensador, caldeira, etc, com um consumo de tempo considerável, implicando, 
assim, em um custo adicional ao trabalho/hora gasto por um profissional.  

As equações de estado de múltiplos parâmetros são originalmente desenvolvidas em 
função da temperatura e densidade. Em aplicações de engenharia, pressão e entalpia ou 
temperatura e entropia são largamente empregadas como argumentos de entrada. Assim, estas 
equações passam a utilizar processos iterativos que consomem um tempo maior. Este trabalho 
propõe uma forma de reduzir este tempo a ponto de se obter propriedades termodinâmicas em 
um tempo bastante inferior ao consumido pelas equações de estado. 



vi 

  

CALCULUS ACCELERATION AND VISUALIZATION OF 
THERMODYNAMIC PROPERTIES 

 
 

Author: Rogério Soares da Silva 
 
 

 
Supervisor: Profª. Ana Rosa Mendes Primo, PhD 
Co-Supervisor: Prof. Ricardo Lessa Azevedo, Dr 

 
 

ABSTRACT 
 
 

 This work presents a software to accelerate the calculus of thermodynamic properties 
using linear interpolation of data, which were previously calculated by multiparameter 
equation of state with pressure and enthalpy as input arguments. The basic accuracy criteria 
were achieved. Furthermore, the aim of this work is to build a thermodynamic diagram 
pressure-enthalpy to visualize isotherms, isochorics and isentropics, as well as to provide any 
thermodynamic property value immediately. 
 The importance of thermodynamic properties in any design of thermal system or 
refrigeration equipment is undoubtedly. After the equation of state of van der Waals and the 
cubic and virial equations, the state-of-art of equation of state are the empirical 
multiparameter equation of state. If properly designed they are able to describe 
thermodynamic properties of a certain substance within the accuracy of the most accurate 
experimental data. Thus, these equations become reference equations and there is no need to 
search data in thermodynamic tables. 
 The multiparameter equations of state grew as a result of the increasing capacity of 
computer processing. In refrigeration or thermal systems simulations there is the necessity to 
get fast and accurate data. A simulation can require hundreds of data of many thermodynamic 
properties applied to many project devices such as: compressor, pump, evaporator, condenser, 
boiler etc. All this spends much time, resulting in an additional cost to work/time spent for an 
engineer. 
 Theses equations have been originally developed in function of temperature and density. 
In engineering applications, pressure and enthalpy or temperature and entropy are widely used 
as input arguments. Therefore, these equations need to use iterative methods that spend more 
time and this work offer a way to reduce the time spent and to get any property as faster than 
real-time.  



vii 

  

SUMÁRIO 
 
Agradecimentos .............................................................................................................. 
* iv

Resumo ........................................................................................................................... 
* v

Abstract .........................................................................................................…….......... 
* vi

Lista de símbolos ............................................................................................................. 
* ix

Lista de figuras ............................................................................................................... 
* x

Lista de tabelas ................................................................................................................ 
* xii

1. Introdução ................................................................................................................... 
* 1

2. Revisão de literatura ................................................................................................... 
* 4

2.1 Equações de estado ................................................................................................... 
* 4

2.1.1 Equação dos gases perfeitos ................................................................................... 
* 4

2.1.2 Equação de van derWaals ...................................................................................... 
* 4

2.1.3 Equações cúbicas ................................................................................................... 
* 4

2.1.4 Equação de Benedict-Webbin-Rubin (BWR) ....................................................... 
* 5

2.1.5 Equação virial ......................................................................................................... 
* 6

2.1.6 Equações de estado de múltiplos parâmetros ......................................................... 
* 6

2.2 Métodos de aceleração de cálculos ........................................................................... 
* 9

3. Método da grade de pontos ........................................................................................ 
* 12

3.1 Introdução ................................................................................................................. 
* 12

3.2 Geração da grade de pontos ....................................................................................... 
* 12

3.3 Passos para a geração da grade de pontos ................................................................. 
* 13

3.4 Método de Busca ....................................................................................................... 
* 15

3.5 Método de interpolação ............................................................................................. 
* 17

3.6 Cálculos no ambiente MATLAB ........................................................................….. 
* 19

3.7 Usando C++ ............................................................................................................... 
* 20

4. Método da malha ........................................................................................................ 
* 21



viii 

  

4.1 Introdução .................................................................................................................. 
* 21

4.2 Triangulação Delaunay ............................................................................................. 
* 21

4.3 MATLAB/C++ ......................................................................................................... 
* 22

4.4 Pontos gerados em função do calor específico – Método do cp ................................ 
* 25

5. Método da grade de pontos modificada ...................................................................... 
* 28

6. Visualização ................................................................................................................. 
* 29

6.1 Visualização da interface gráfica .............................................................................. 
* 29

6. 2 A carta psicrométrica ................................................................................................. 
* 31

7. Resultados e análises .................................................................................................. 
* 32

7.1 Método da grade de pontos no MATLAB ............................................................... 
* 32

7.1.1 Testes realizados .................................................................................................... 
* 32

7.1.2 Vantagens do método …........................................................................................ 
* 34

7.1.3 Desvantagens do método ........................................................................................ 
* 35

7.1.4 Comentários ............................................................................................................ 
* 35

7.2 Método da malha ........................................................................................................ 
* 35

7.2.1 Vantagens ……...................................................................................................... 
* 37

7.2.2 Desvantagem .……………...................................................................................... 
* 37

7.3 Método da grade de pontos modificada ..................................................................... 
* 37

8. Conclusões e propostas para futuros trabalhos ........................................................... 
* 40

9. Referências bibliográficas ........................................................................................... 
* 42

APÊNDICE A: ................................................................................................................. 
* 45

APÊNDICE B: ................................................................................................................. 
* 49

APÊNDICE C: ............................................................................................................... 
* 51

APÊNDICE D: ................................................................................................................ 
* 53

APÊNDICE E: ................................................................................................................ 
* 55



ix 

  

LISTA DE SÍMBOLOS 
 
a Energia livre de Helmholtz 

 
cp Calor especifico a pressão constante 

 
cv Calor especifico a volume constante 

 
d Expoente de densidade  

 
EOS Equação de estado 

 
F(p,T) Função termodinâmica genérica (em função de p e T) 

 
h Entalpia 

 
p Pressão 

Expoente de densidade na função exponencial 
 

R Constante do gás perfeito 
 

s Entropia 
 

T Temperatura 
 

t Expoente  temperatura  
 

v Volume especifico 
 
LETRAS GREGAS 
 
????    Energia de Helmholtz reduzida 

 
????    Densidade reduzida inversa 

 
????    Densidade 

 
????    Temperatura reduzida inversa 

 
?  

  

 

Parâmetro de temperatura reduzida 
 

 



x 

  

LISTA DE FIGURAS 
 
Figura 1.1 Ciclo de refrigeração combinado em cascata (Van Wylen, p.291). ................ 
* 

1

Figura 1.2 Diagrama p-h para o R22 (CoolPack). .......................................................... 
* 

2

Figura 3.1 Malha 2D. ...................................................................................................... 
* 

13

Figura 3.2 Malha 3D. ..................................................................................................... 
* 

13

Figura 3.3 Definição do domínio p-h. ............................................................................. 
* 

14

Figura 3.4 Divisão do domínio em subdomínios. ........................................................... 
* 

15

Figura 3.5 Quadrilátero onde estará contido o ponto p-h. ............................................... 
* 

16

Figura 3.6 Divisão do quadrilátero. ................................................................................ 
* 

16

Figura 3.7 Ponto contido no triângulo: P está à direita de todos os vetores. ................... 
* 

17

Figura 3.8 Teste dos vetores para detectar a posição do ponto considerado: ponto fora 
do triângulo. 
 

17

Figura 3.9 Os pontos AOB definem um plano no espaço. .............................................. 
* 

18

Figura 3.10 Grade de pontos. .......................................................................................... 
* 

19

Figura 3.11 Ponto de vista de uma malha. ....................................................................... 
* 

19

Figura 3.12 Apresentação de todo o domínio construído. ............................................... 
* 

20

Figura 3.13 Resultado do critério de cálculos utilizando a convergência: todas colunas 
convergem para um único ponto: o ponto crítico. 
 

20

Figura 4.1 Malha gerada para o diagrama pressão-entalpia do refrigerante CO2 usando 
um ?h fixo. 
 

22

Figura 4.2 Malha gerada para o diagrama pressão-entalpia do refrigerante CO2 usando 
o método do cp. 
 

23

Figura 4.3 Esquematização do algoritmo usado para calcular uma propriedade 
termodinâmica ao longo da malha. 
 

24

Figura 4.4 Fluxograma para a geração de pontos da malha através do método do cp. .... 
* 

26

Figura 5.1 Esquema de organização dos dados de uma região qualquer. ........................ 
* 

28

Figura 6.1 Interface gráfica voltada para o usuário avançado. ........................................ 
* 

29

Figura 6.2 Erro relativo para densidade. 
 

30

Figura 6.3 Área com refinamento 30



xi 

  

Figura 6.4 Interface gráfica voltada para o usuário final exibindo linhas de 
temperatura, densidade, entropia e título constante. 
 

30

Figura 6.5 Tabela para cálculo de propriedades termodinâmicas. .................................. 
* 

31

Figura 7.1 Gráfico do erro percentual para a densidade no método da grade de pontos. 
 

33

Figura 7.2 Gráfico do erro percentual para a temperatura no método da grade de 
pontos. 
 

33

Figura 7.3 Variação da densidade com a entalpia ao longo de isobáricas. ..................... 
* 

34

Figura 7.4 Variação da temperatura com a entalpia. ....................................................... 
* 

34

Figura 7.5 Erro percentual para a densidade pelo método da malha. .............................. 
* 

36

Figura 7.6 Erro percentual para a temperatura pelo método da malha. .......................... 
* 

36

Figura 7.7 Trecho qualquer da malha indicando na linha tracejada o caminho 
percorrido pelo cursor. 
 

37

Figura 7.8 Erro percentual para a temperatura pelo método da grade modificada. ......... 
* 

38

Figura 7.9 Erro percentual para a densidade pelo método da grade modificada. ........... 
* 

38

Figura B.1 (a) é uma triangulação Delaunay e (b), não o é. ........................................... 
* 

49

Figura B.2 Fronteira da malha em destaque. .................................................................. 
* 

49

Figura B.3 Lista circular duplamente encadeada. ........................................................... 
* 

50

Figura D1 kPap 250=?  kgkJh /20=? . ...................................................................... 
* 

53

Figura D2 kPap 150=?  kgkJh /20=? . ....................................................................... 
* 

53

Figura D3 kPap 50=?  kgkJh /20=? . ........................................................................ 
* 

53

Figura D4 kPap 250=?  kgkJh /15=? . ...................................................................... 
* 

53

Figura D5 kPap 250=?  kgkJh /10=? . ...................................................................... 
* 

54

Figura D6 kPap 250=?  kgkJh /5=? . ........................................................................ 
* 

54

Figura D7 kPap 250=?  kgkJh /10=?  , kPap 250=?  kgkJh /5=? (refino). ........... 
* 

54

Figura E.1 Interface criada para construir carta psicrométrica. .................................... * 55

 



xii 

  

LISTA DE TABELAS 
 

 
Tabela 2.1 Parâmetros para equações de estado cúbicas .................................................. 
* 

5

Tabela 3.1 Limite dos subdomínios utilizados ................................................................ 
* 

13

Tabela 4.1 Propriedades calculadas ao longo da linha de saturação ............................... 
* 

23

Tabela 7.1 Relação de tempo entre interpolação e equações de estado .......................... 
* 

32

Tabela 7.2 Comparação dos tempos consumidos pelas EOS e o método da malha ........ 
* 

37

Tabela 7.3 Comparação dos tempos consumidos pelas EOS e o método da grade de 
pontos modificada 
 

39

Tabela A.1 Definição de propriedades e suas relações com ? ......................................... 
* 

45

Tabela A.2 Derivadas da Equação 2.28 .......................................................................... 
* 

47

Tabela A.3 Derivadas da Equação 2.30 .......................................................................... 
* 

48

Tabela D1 Definição dos passos de pressão e entalpia para o CO2 ................................. 
* 

54

 



1 

  

1. INTRODUÇÃO 
 

O conhecimento das propriedades termodinâmicas é fundamental nos projetos de 
sistemas térmicos e de refrigeração, seja no correto dimensionamento de componentes ou na 
otimização do sistema como um todo. A figura 1.1 mostra um ciclo de refrigeração 
combinado em cascata. Este sistema é utilizado quando há uma grande diferença de 
temperatura entre o espaço refrigerado e o meio. Em tal sistema, como em qualquer outro 
dispositivo térmico, as propriedades do fluido de trabalho ou refrigerante são indispensáveis 
ao dimensionamento do equipamento. 

 

Figura 1.1 – Ciclo de refrigeração combinado em cascata (Van Wylen, p.291). 
 

Propriedades termodinâmicas de substâncias são requeridas em simulações numéricas 
de processos industriais. Essas simulações podem ser usadas no projeto de processo e controle 
e análise de segurança. Propriedades como temperatura, densidade, entalpia e pressão são 
constantemente requeridas em diferentes condições de processo. 

Os algoritmos convencionais para cálculo de propriedades termodinâmicas geralmente 
consistem em muitos processos iterativos, incluindo chamadas de funções complexas e 
interpolação em tabelas baseadas em dados teóricos e experimentais. Os algoritmos iterativos 
são lentos e inviáveis, por exemplo, em simulação de processos dinâmicos, que devem ser 
executados em tempo real. Métodos baseados em tabelas e interpolação linear são rápidos, 
mas na prática limitados a duas ou três variáveis de entrada. 

O presente trabalho propõe uma forma rápida e eficiente de obtenção de propriedades 
termodinâmicas (temperatura, densidade, entropia e titulo) ágil o bastante para sua utilização 
em simulações que exijam dados em tempo real. 
A aceleração dos cálculos é feita por interpolação linear de dados fornecidos por tabelas pré-
calculadas. Para construir tais tabelas foi usado um programa de computador, onde foi 
desenvolvida uma plataforma de simulação escrita em C++ no qual estão implementadas as 
equações de estado. As equações usadas nesta plataforma são conhecidas como equações de 
estado de múltiplos parâmetros e são baseadas na energia livre de Helmholtz e desenvolvidas 
por R. Span (2000). Estas são consideradas uma das equações de estado mais precisas que 
existem atualmente e são capazes de representar com bastante precisão as regiões de líquido, 
vapor e a região de equilíbrio líquido-vapor e serão discutidas no capítulo 2. 

O objetivo inicial neste trabalho é utilizar como dados de entrada dois pares de 
propriedades independentes: pressão-entalpia e temperatura-entropia. Essas propriedades são 



2 

  

de extremo interesse em aplicações de engenharia. As equações de estado de múltiplos 
parâmetros foram desenvolvidas de forma a utilizar temperatura e densidade como parâmetros 
de entrada para fornecer de forma direta as demais propriedades. Dessa forma, pressão-
entalpia e tempertura-entropia são argumentos que necessitam de métodos iterativos para 
fornecer os dados de saída e estes métodos consomem um tempo além do máximo desejado 
para certas aplicações de engenharia.  

A construção do banco de dados usado nas interpolações foi feita visando gerar 
arquivos de tamanho reduzido e mantendo a precisão dos resultados dentro de uma faixa de 
erro aceitável ao longo de todo o domínio. Tal faixa de erro é fornecida pelo usuário final. 

Esse trabalho também trata da visualização de propriedades termodinâmicas. Essa 
visualização se refere à construção de diagramas termodinâmicos com isolinhas de 
temperatura, densidade, entropia e titulo assim como a visualização de ciclos.  

A figura 1.2 mostra um diagrama pressão-entalpia com isolinhas de temperatura (linhas 
vermelhas), volume específico (linhas verdes) e entropia (linhas azuis) que são largamente 
usados nos cálculos de projeto. É referente ao ciclo mostrado na figura 1.1. O diagrama da 
figura 1.2 refere-se ao uso do R22. A figura foi obtida do programa Cool Pack 
(www.et.du.dk/CoolPack). 

O uso dos diagramas é importante na construção de ciclos termodinâmicos, pois pode se 
visualizar o caminho que o fluido percorre, possibilitando, assim, uma rápida aproximação 
das propriedades termodinâmicas em pontos de relevância do mesmo, tais como: entrada e 
saída de um compressor, de um trocador de calor, de uma bomba, de uma válvula ou de uma 
turbina. Entretanto, dependendo das exigências de precisão, os diagramas não permitem uma 
avaliação muito precisa das propriedades termodinâmicas. 

As tabelas termodinâmicas são uma alternativa ao uso de diagramas e são mais precisas. 
Podem ser construídas através de dados experimentais ou de equações de estado que 
procuram representar com exatidão o comportamento p-v-T da substância em questão para 
vários estados. Propriedades termodinâmicas não mensuráveis como entalpia, entropia e calor 
específico, por exemplo, são obtidas aplicando-se definições matemáticas ou relações 
termodinâmicas a tais equações. Isso obriga estas equações a apresentarem um formato que 
facilite as diferenciações exigidas na determinação destas propriedades. Porém, os resultados 
são sempre grandes equações que obrigam o uso de computadores para viabilizar seu uso. 

 

Figura 1.2 – Diagrama p-h para o R22 (CoolPack). 
 



3 

  

 A motivação inicial desse trabalho foi prover uma plataforma de simulação de circuitos 
termodinâmicos de uma ferramenta de cálculo de propriedades termodinâmicas precisa e 
rápida. Essa plataforma está sendo desenvolvida no Instituto de Termodinâmica (IFT) da 
Universidade de Braunschweig, Alemanha, em cooperação com o departamento de 
engenharia mecânica da UFPE. Os resultados de visualização e aceleração de cálculo de 
propriedades termodinâmicas serão utilizados no desenvolvimento da referida plataforma de 
simulação. 



4 

  

2. REVISÃO DE LITERATURA 
 
 Neste capítulo serão comentadas as principais maneiras utilizadas para o cálculo de 
propriedades termodinâmicas. 
 
2.1 Equações de estado 
 
 As equações de estado são de extrema importância nos cálculos de projetos em diversos 
campos da engenharia e nas ciências exatas. No presente trabalho, as equações 
desempenharam um papel importante na construção de um banco de dados para os cálculos de 
interpolação, que será discutido mais adiante. A seguir, são apresentadas, de forma sucinta, 
algumas das mais importantes equações de estado já publicadas e com especial interesse as 
equações de estado de múltiplos parâmetros. 
 
2.1.1 Equação dos gases perfeitos 
 

De origem empírica, a primeira equação de estado obtida para relacionar pressão, 
densidade e temperatura é representada por: 
 

RTpv =  2.1
 
onde R é a constante do gás. Os gases só se aproximam dessa relação para regiões de baixa 
pressão. 
 
2.1.2 Equação de van der Waals 
 

No final do século XIX, surge a primeira formulação que descreve de forma 
qualitativamente correta os estados de vapor, líquido, supercrítico e bifásico líquido-vapor: a 
equação de van der Waals (1873). 
 

2v
a

bv
RT

p ?
?

=  2.2

 
A equação de van der Waals é uma equação de estado do tipo generalizada e é uma 

alteração semiteórica da equação dos gases perfeitos. Os parâmetros a e b têm por objetivo 
corrigir os efeitos das forças intermoleculares e o volume ocupado pelas moléculas, 
respectivamente. Ambas são funções das constantes críticas da substância em questão. 

 
2.1.3 Equações cúbicas 
 

As equações cúbicas compõem uma classe que inclui muitas equações bastante usadas 
na indústria. São aproximações que descrevem de forma razoável o comportamento pvT de 
algumas substâncias. A primeira equação desta classe foi proposta originalmente por van der 
Waals. As equações cúbicas de estado podem ser expressas na forma geral: 
 

))((
)(

2 ??
??
++?

?
?

?
=

vvbv
V

bv
RT

p  2.3

 
onde b, ?, ? e ? são parâmetros que dependem da temperatura e podem ser obtidos a partir de 
ajustes de dados experimentais ou através de uma relação com ponto crítico. A tabela 2.1 lista 
os parâmetros desenvolvidos para algumas equações. 



5 

  

Devido à sua simplicidade, essa equação não é suficientemente precisa para descrever 
as propriedades termodinâmicas para uma larga faixa de temperatura e pressão. Em particular, 
propriedades derivadas, tais como o calor específico e a velocidade do som no estado de 
líquido comprimido, apresentam um erro considerável (McLinden et al, 1997). Entretanto, as 
equações cúbicas de estado podem ser usadas com boa precisão nos cálculos de propriedades 
de misturas e em relação ao equilíbrio de fases. 
 

Tabela 2.1 – Parâmetros para equações de estado cúbicas 
Autor Ano ? ? ? ?? 

van der Waals 1873 a b 0 0 
Clausius 1880 a/T b 2c c2 
Berthelot 1899 a/T b 0 0 
Redlich-Kwong 1949 Ta /  b b 0 
Soave 1972 ?S(T) b b 0 
Lee-Erbar-Edmister 1973 ?L(T) ?(T) b 0 
Peng-Robinson 1976 ?PR(T) b 2b -b

2 

Patel-Teja 1981 ?PT(T) b b+c -cb 
 

Rearranjando a equação 2.2 em função do fator de compressibilidade, surge uma função 
polinomial de grau 3 (daí o nome equação cúbica de estado) fica: 
 

0)()23()1( 32223 =?????+?? BBABZBBAZBZ  2.4
 
onde 

22TR
ap

A =  2.5

e 

RT
bp

B =  2.6

 
2.1.4 Equação de Benedict-Webbin-Rubin (BWR) 
 

Originada como uma modificação da equação de Beattie-Bridgeamn, a primeira 
equação de estado capaz de descrever uma larga faixa de estado qualitativamente correta foi 
proposta em 1940 por Benedict, Webb e Rubin, e é representada pela seguinte expressão:  
 

( ) )exp()1( 2
2

23
632

2
0

00 ??
???

????? ?
+

++?+?
?

?
?
?

?
??+=

T
c

aabRT
T
C

ARTBRTp  2.7

 
Esta equação é formada por 8 constantes empíricas A0, B0, C0, a, b, c, ? e ?. Para regiões de 
baixa densidade, a substância se aproxima do comportamento de um gás perfeito e é 
representada pelo primeiro termo da equação, enquanto que os demais termos tendem a zero. 
Os dois termos seguintes são análogos ao segundo e terceiro coeficientes viriais. Os dois 
últimos termos são empíricos e a função exponencial é usada para ajustar as isotermas no 
estado de líquido comprimido. 

Desde sua publicação, a equação de Benedict-Webb-Rubin, também conhecida como 
equação BWR, é usada na sua forma original ou modificada. Das formas modificadas, podem 
ser destacadas algumas, como as de: Martin-Hou (1955), Strobridge (1962), Jabobsen e 
Stewart (1973), Lee-Kesler (1975) e Younglove e McLinden (1994). A mais notável equação 



6 

  

é a de Jocobsen e Stewart e é conhecida como “a equação modificada BWR”, a qual pode ser 
considerada como o primeiro exemplo bem sucedido de uma equação de referência de estado. 
A equação MBWR expressa a pressão como uma função explícita da temperatura e da 
densidade molar, apresentando-se na forma: 

??
=

?

?
?
?
?

?
?
?
?

?
?+=

15

10

172
9

1
2

2

exp
i

i
i

i c

i
i aap ??

?
?  2.8

 
onde os coeficientes ai são funções da temperatura resultante de um total de 32 parâmetros 
ajustáveis. A equação de estado MBWR tem sido aplicada a uma larga  variedade de fluidos, 
incluindo hidrocarbonos, líquidos criogênicos e refrigerantes. Esta é a base para a atual 
padronização internacional das propriedades do R123 e reproduz dados experimentais com 
um desvio médio absoluto de 0,04% para a densidade, 0,05% para pressões de vapor e de 
0,75% para o calor específico. 
 
2.1.5 Equação virial 
 

Em 1901, Kamerlich Onnes introduziu a equação de estado virial. Trata-se de uma 
equação teórica deduzida a partir da teoria cinética e da termodinâmica estatística e é 
representada por uma série de potências: 
 

?++++= 32 )()()(1
),(

???
?

?
TDTCTB

RT
Tp

 2.9

 
onde B(T), C(T) e D(T) são o segundo, terceiro e quarto coeficientes viriais, respectivamente. 
Todos os coeficientes são funções apenas da temperatura e estão relacionados às interações 
intermoleculares. Por exemplo, B(T) é uma função de interação entre duas moléculas, C(T) 
entre três moléculas e assim por diante. Teoricamente, a equação virial pode ser usada para 
descrever com precisão moderada as propriedades termodinâmicas de um fluido para todos os 
estados. Entretanto, descrever o comportamento de fluidos densos requer termos de ordens 
mais altas e estes podem não ser obtidos de forma satisfatória pela teoria ou por medidas 
experimentais. Dessa forma, a equação é geralmente truncada no quarto termo e é aplicada 
apenas às propriedades na fase de vapor de gases não polares até uma vez e meia a sua 
densidade crítica. Para fluidos polares, tais como os refrigerantes HFC, a região de 
aplicabilidade é reduzida. 
 
2.1.6 Equações de estado de múltiplos parâmetros 
 

Considerada a fonte mais precisa para dados de propriedades termodinâmicas, a 
equação de estado de múltiplos parâmetros é capaz de representar valores de propriedades 
termodinâmicas de certas substâncias com a mesma precisão dos mais precisos dados 
experimentais. Isso a torna uma equação de referência, podendo-se desprezar dados 
experimentais. Por essa razão, o presente trabalho utiliza as equações de estado de múltiplos 
parâmetros como referência para todos os dados termodinâmicos aqui utilizados. Essas 
equações foram desenvolvidas e implementadas por terceiros e fazem parte de uma 
plataforma de simulação para otimização de ciclos de refrigeração. Esta plataforma foi 
largamente usada tanto para criar o banco de dados como avaliar a precisão dos dados finais. 
A seguir, será dada uma maior ênfase a este tipo de equação, do que às demais, por motivos já 
comentados. 

Atualmente, estas equações são geralmente formuladas em função da energia livre de 
Helmholtz, com temperatura e densidade como variáveis independentes. Esta escolha faz com 



7 

  

que os algoritmos para o cálculo das propriedades e o desenvolvimento das equações sejam 
mais sistemáticos. A formulação das equações de estado segue o seguinte raciocínio: 
 
• define-se uma formulação para a energia de helmholtz em função de T, ? e a(T, ?); 
• utiliza-se relações termodinâmicas para se obter as propriedades desejadas, como 

mostram as equações 2.10 a 2.13, entre outras; 

pressão: 
Tv

a
p ?

?

?
?
?

?

?
?

?=  2.10

 

energia interna/entropia
vT

a
sTsau ?

?

?
?
?

?

?
?

?=?+=  2.11

 
entalpia: pvuh +=  2.12

 

calor especifico: 
p

p T
h

c ?
?

?
?
?

?

?
?

?=  2.13

 
As equações de Helmholtz são geralmente formuladas na forma reduzida 
 

RT
Ta ),(

),(
?

??? =  2.14

 
com: 

T
Tr=?  2.15

e 

r?
?

? =  2.16

 
Esta, por sua vez, é dividida em uma parte que descreve o comportamento de um gás 
perfeito 0?  e em outra parte que descreve o comportamento residual r? de um fluido real, a 
uma dada temperatura e densidade. Sua forma geral é: 
 

),(),(),( 0 ????????? r+=  2.17
 

A grande vantagem da equação 2.17 é que qualquer propriedade termodinâmica pode 
ser obtida derivando-a. O apêndices A contem listas com algumas propriedades 
termodinâmicas e como estas podem ser calculadas por meio das derivadas da equação 2.17. 

A parte ideal, ),(0 ??? , pode ser determinada relacionando-a com o calor especifico do 
gás perfeito a volume constante, )(0 Tcv . Pela definição da energia de Helmholtz, temos: 
 

Tsua ?=  2.18
 
e das relações de Maxwell 
 

s
T
a

p

?=?
?

?
?
?

?

?
?

 2.19



8 

  

 
de 2.18 e 2.19, tem-se: 
 

vT
a

Tau ?
?

?
?
?

?

?
?

?=  2.20

 
Substituindo a por ?, tem-se: 
 

vvv T
RT

T
RT

TRT
T
a

Tau ?
?

?
?
?

?

?
?

?=?
?

?
?
?

?

?
?

?=?
?

?
?
?

?

?
?

?=
??

? 2
)(

 2.21

 
Pela definição de cv, tem-se: 

 

v
v T

u
c ?

?

?
?
?

?

?
?

=  2.22

 
Derivando 2.21 em relação a T e igualando a 2.22, tem-se:  

 

vv
v T

RT
T

RTc ??
?

?
??
?

?

?
?

??
?

?
?
?

?

?
?

?=
2

2
22

??
 2.23

 
Substituindo T por ? e v por ? nas derivadas, tem-se: 

 

??
???
?
?

?
?
?

?

?
?

?=?
?

?
?
?

?

?
?

rv TT

2

 e 
??

?
??

?
???

??
?

?
??
?

?

?
?

+?
?

?
?
?

?

?
?

=??
?

?
??
?

?

?
?

2

2

2

4

2

3

2

2

2
rrv TTT

 2.24

 
Assim, o calor específico a volume constante, apresenta-se como: 

 

?
?

?

?

?
?

?

?
??
?

?
??
?

?

?
?

+??
?

?
??
?

?

?
?

?=??
?

?
??
?

?

?
?

?=
???

?
?

?
?

?
?
?

? 2
2

2

02
2

2

2
2

r

v RRc  2.25

 
e o 0vc , tem a forma: 
 

?
?
?

? ??
?

?
??
?

?

?
?

?= 2
02

20 Rcv  2.26

 
O calor especifico do gás perfeito a volume constante, 0vc , pode ser definido na sua forma 
reduzida como um somatório de termos polinomiais e um somatório de termos exponenciais: 
 

??
== ?

++=
PE

k

kPOL
i

K

k
kk

I

i

t
i

v

e
e

mnn
R

c
1

2
2

1
0

0

)1(
)(

)(
??

??

???
?

 2.27

 
O segundo termo da equação 2.27 é conhecido como função de Planck-Einstein e representa a 
vibração interna das moléculas. Finalizando a primeira parte, ),(0 ???  é obtido pela 
integração dupla da equação 2.26. 



9 

  

? ? ??
?

?
?
?
?

?
+??

?

?
?
?
?

?
?=

0
2

0
0 ln),(

?
?

??
?

??? dd
R
cv  2.28

A maior dificuldade em desenvolver as equações de estado de múltiplos parâmetros é 
encontrar uma formulação para a parte residual ?r(?,?). Geralmente tal formulação é escrita 
como uma soma de termos polinomiais e exponenciais, como: 
 

??
+

+==

?+=
exp

11

)exp(),(
II

Ii

pdt
i

I

i

dt
i

r
pol

pol

iii

pol

ii nn ????????  2.29

 
Atualmente, não há nenhuma teoria que descreva ?r com precisão suficiente para toda 

faixa de estados de um fluido. Assim, o desenvolvimento de formulações para  ?r é 
determinado por uma representação empírica de dados experimentais. Span (2000) descreve 
como as formulações para a energia residual de Helmholtz podem ser desenvolvidas baseadas 
em dados para diferentes propriedades termodinâmicas. No apêndice A, encontram-se  
definições para várias propriedades termodinâmicas em termos da energia livre de Helmholtz 
(tabela A.1) assim como as derivadas necessárias (tabela A.2 e tabela A.3). 
 
2.2 Métodos de aceleração de cálculos 
 

Em várias aplicações de engenharia existe um grande interesse em se obter de forma 
rápida e precisa dados de propriedades termodinâmicas. Alguns programas usados em 
simulações de ciclos ou processos precisam ser rápidos o bastante para fornecer, em tempo 
real ou de forma on line, as propriedades termodinâmicas exigidas com a precisão desejada. 
Uma grande número de combinações de propriedades independentes como: p,T; p,?; T,?; p,h 
e T,s são utilizadas, mas a maioria dos algoritmos que descrevem as equações de estado 
necessitam de complexos e demorados processos iterativos. Müller (1994) cita como exemplo 
programas que fazem análise termohidráulica na área de segurança de reatores nucleares. 
Estas análises são feitas em computadores velozes e consomem horas de cálculos. A maior 
parte deste tempo é consumida calculando-se as propriedades termodinâmicas da água e do 
vapor, e em alguns casos chega a consumir até 50% do tempo total. 

Para contornar esse problema, existem dois caminhos que podem ser seguidos: 
 
• Desenvolvimento de equações simplificadas ou funções de aproximação com precisão 

adequada e que representem determinadas faixas da região de um problema particular. 
• Geração de tabelas para posterior interpolação de dados. 
 

A primeira estratégia consiste em desenvolver formulações simples, que descrevem as 
propriedades para várias e pequenas faixas de pressão, temperatura ou volume especifico. 
Alguns trabalhos abordando esta metodologia são mostrados a seguir. 

Em Pátek (1994) foi desenvolvido um conjunto de onze equações com precisão 
suficiente para aplicações industrias e que descreve as propriedades termodinâmicas da água 
na região de vapor superaquecido desde a temperatura de saturação até 600ºC, para uma faixa 
de pressão variando de 0,001 até 30MPa. Ele desenvolveu as seguintes funções 
termodinâmicas: v(p,T), h(p,T), s(p,T), T(p,h), v(p,h), h(p,s), T(p,s), v(p,s), p(h,s) e T(h,s). 
Todas essa funções foram desenvolvidas na seguinte forma polinomial: 
 

kk mn
N

k
ka ??? ?

=

=
1

 2.30

 



10 

  

onde ),,( yxzf=? , )( xg=?  e )( yh=? . 
 

Pátek (1995) desenvolveu cinco equações usando a mesma estrutura da equação 2.1 
para descrever propriedades de equilíbrio líquido-vapor para um sistema amônia-água. Todos 
os parâmetros usados nas equações foram obtidos por ajuste de dados experimentais ou de 
dados provenientes de equações de estado confiáveis.  

Garland e Hand (1989) desenvolveram funções de aproximação para representar as 
regiões de líquido comprimido e vapor superaquecido para a água em função da pressão e da 
temperatura. Suas funções foram obtidas através do truncamento no segundo termo da série 
de Taylor. Considerando uma propriedade termodinâmica arbitrária ),( TpFF =  suas 
representações para a região de líquido comprimido e vapor superaquecido são 
respectivamente 

 

)]([)(),( Tpp
p
F

TFTpF s
T

f ??
?

+=  2.31

e 

][)(),( s
p

g TTT
F

pFTpF ?
?
?

+=  2.32

 
Os autores usaram técnicas de regressão linear e não-linear para desenvolver suas 

formulações, os resultados são mostrados no apêndice C. Garlan e Hand (1989) consideram o 
uso de tabelas para interpolação uma desvantagem, pois consome uma grande quantidade de 
memória. Entretanto, este problema não se aplica aos computadores atuais, onde memória 
passou a ser um recurso abundante e barato. 

A segunda estratégia consiste em desenvolver tabelas de dados de propriedades 
termodinâmicas para posterior interpolação. 

No trabalho de Kretzschmar (1995) é proposto um algoritmo para a geração de uma 
tabela de dados de interpolação com densidade de dados otimizada através do uso de 
transformação de coordenadas. Segundo Kretzschmar, a transformação de coordenadas 
aumenta a precisão da interpolação e reduz o número de dados necessários. Como exemplo, 
calcula a pressão de saturação por meio de interpolação linear com e sem transformação de 
coordenadas. Sem transformação, obtém um erro de 0,3% e com a transformação ln(ps) e 1/T, 
o erro cai para 0,008%. As vantagens da interpolação por ele citadas são:  
 
• Operações matemáticas simples. 
• Fácil aplicação  de cálculos a outros fluidos, outras funções ou outras faixas de estado 

simplesmente substituindo a tabela de dados de interpolação. 
• Interpolação de funções termodinâmicas diretas e inversas tais como T=f(h,p) e 

h=f(T,p), com alta consistência numérica requerida na modelagem de processos. 
 

Swesty (1996) apresentou um método para construir tabelas termodinamicamente 
consistentes por meio de interpolação em uma malha retangular no plano T - ?. Cada ponto 
Ti,?j corresponde a um valor da energia livre de Helmholtz (Fij), assim como a primeira e 
segunda derivadas. Com estas derivadas é possível calcular a pressão e a entropia de acordo 
com as relações de Maxwell. A sua grande preocupação foi garantir que F interpolado tenda a 
Fij quando (T, ?) se aproxima de um ponto da malha, ou 

 
),( jiTFF ??  2.33

 



11 

  

quando ),(),( jiTT ?? ? . O mesmo acontece com a primeira e segunda derivadas em relação 
à temperatura  e densidade. 

 
),( jiTFF ??  2.34

ijT
F

T
F

?
?

?
?
?

 e 
ij

T
F

T
F

2

2

2

2

?
?

?
?
?

 2.35

 

ij

FF
?? ?
?

?
?
?

 e 
ij

FF
2

2

2

2

?? ?
?

?
?
?

 2.36

 
Swesty não trata do espaçamento entre os pontos da malha necessário à precisão dos 

dados interpolados, pois alega que esta decisão depende da equação de estado a ser usada e de 
quem utilizará tal método. O resultado é uma função de interpolação bi-quintic com 36 termos 
e 8 coeficientes, que são mostrados no apêndice C. 



12 

  

3. MÉTODO DA GRADE DE PONTOS 
 
3.1 Introdução 
 

As equações de estado usadas pela plataforma de simulação são equações de múltiplos 
parâmetros baseadas na energia livre de Helmholtz e descritas na obra de R. Span (2000). Tais 
equações utilizam as propriedades independentes temperatura e densidade como argumentos 
para calcular de forma direta qualquer outra propriedade. Caso contrário, um ou mais métodos 
iterativos são aplicados, consumindo muito tempo. Portanto, conseguir uma forma rápida e 
precisa de calcular propriedades termodinâmicas que não tenham temperatura e densidade 
como argumentos surgiu dessa necessidade. A grade de pontos foi a primeira idéia nesse 
sentido. Este trabalho dividiu-se em duas etapas: 
 
• geração da grade de pontos e armazenamento dos mesmos em arquivo. 
• leitura de arquivo, leitura de dados de entrada, busca e interpolação. 
 
3.2 Geração da grade de pontos 
 

Diagramas termodinâmicos são bastante usados nos projetos de simulação de sistemas 
térmicos. Dois tipos são aqui destacados: os diagramas p-h e T-s. O diagrama pressão-entalpia 
foi o primeiro a ser utilizado nos testes. O princípio de acelerar os cálculos está em ter uma 
certa quantidade de pontos distribuídos obedecendo a uma certa ordem, em um domínio pré-
estabelecido, e associados a estes algumas propriedades pré-calculadas. A obtenção de novos 
valores é feita por meio de uma interpolação linear em três dimensões (x, y, z) que é uma 
função extremamente simples, se comparada a uma equação de estado de múltiplos 
parâmetros No caso das propriedades, por exemplo, x e y seriam pressão e entalpia e a 
terceira propriedade a ser calculada seria a temperatura ou densidade. As figuras 3.1 e 3.2 
ilustram grade de pontos bi e tri dimensionais. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Figura 3.1 – Malha 2D.    Figura 3.2 – Malha 3D. 
 

O domínio é dividido em m linhas e n colunas. Os limites laterais do mesmo são 
definidos por isotermas e os limites superior e inferior por isobáricas. O domínio é dividido 
em linhas paralelas horizontais, cada uma com o mesmo número de divisões (isobáricas). 
Uma matriz armazena os pontos p-h (M1) e duas outras temperatura e densidade (M2 e M3) 
respectivamente. Como esta é sempre dividida em linhas horizontais, para economizar 



13 

  

memória, a primeira coluna da matriz M1 armazena apenas os valores de pressão e as outras, 
os valores de entalpia. A matriz M1 tem dimensões m x n + 1 e as demais, m x n. 
 

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

m

m

mnmm

hhp
hhp

hhp

M

111

221

2

1

1
2

?

?

????

?

 

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

n

n

mnmm

TTT
TTT

TTT

M

11211

22221

21

2

?

?

????

?

 

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

n

n

mnmm

M

11211

22221

21

3

???
???

???

?

?

????

?

 

 
A maneira mais apropriada de armazenar e de manipular os dados foi usando uma 

matriz, por ser uma estrutura de dados de acesso rápido aos seus elementos. Os passos 
utilizados na geração da grade de pontos serão mostrados a seguir. Semelhante metodologia 
foi aplicada para construção do diagrama p-h. 
 
3.3 Passos para a geração da grade de pontos 
 
• Definir um domínio. 
 

A definição do domínio no diagrama p-h é feita através dos limites máximo e mínimo 
de pressão e temperatura, assim como mostra a figura 3.3. 
 
• Dividir o domínio em subdomínios. 
 

Quatro subdomínios foram definidos: líquido sub-resfriado, vapor superaquecido, 
bifásico e crítico, como mostra a figura 3.4. Estas divisões foram feitas com o intuito de 
facilitar o armazenamento dos dados após a geração e no momento da interpolação, assim 
como para respeitar os limites entre regiões de fases diferentes. 
 
• Geração de pontos e cálculo das propriedades termodinâmicas. 
 
A tabela 3.1 mostra os limites de cada subdomínio. 
 

Tabela 3.1 – Limite dos subdomínios utilizados. 
Subdomínio Limite inferior Limite superior Limite 

esquerdo 
Limite direito 

Líquido 
comprimido 

pmin pcrit Isoterma, Tmin Linha de líquido 
Saturado 

Vapor 
superaquecido 

pmin pcrit Linha de vapor 
saturado 

Isoterma, Tmax 

Acima da pcrit pcrit pmax Isoterma, Tmin Isoterma, Tmax 
Líq. + Vap. Pontos abaixo da linha de saturação. 

 
O roteiro a seguir, exemplifica os cálculos para a região de vapor superaquecido, 

definida na figura 3.4. 
 
Dados de entrada 
p_step passo da pressão 
h_step passo da entalpia 
p_Max limite superior 
p_Min limite inferior 
T_Max limite direito 



14 

  

T_Min limite esquerdo (linha de vapor saturado) 
número de isobáricas (número de linhas da matriz) 
m = (p_Max – p_Min)/p_step + 1 
número de divisões das isobáricas (número de colunas da matriz) 
n = (h_Max – h_Min)/h_step + 1 
 
for i = 1:m 

Maxp
m

MinpMaxpi
p _

1
)__)(1(
+

?
??

=  

T = T(p)       define o limite esquerdo 
rho = rho(p,T) 
h_left = h(T,rho) 
rho = rho(p,T_Max)     define o limite direito 
h_right = h(T_Max,rho) 
M1(i,1) = p; 
for j = 1:n 

Maxh
n

MinhMaxhj
h _

1
)__)(1(
+

?
??

=  

T_rho = T_rho(p,h) 
M1(i,j+1) = h; 
M2(i,j) = T; 
M3(i,j) = rho; 

end 
end 
 
funções que acessam as equações de estado de múltiplos parâmetros: 
T(p)   -&gt; temperatura de saturação 
rho(p,T) -&gt; densidade em função de T e p 
h(T,rho) -&gt; entalpia em função de T e rho 
T_rho  -&gt; retorna T e rho em função de p e h (demorada) 

Figura 3.3 – Definição do domínio p-h. 
 

Os limites h_Max e h_Min são definidos sobre a linha de pressão constante onde 
apresentarem a maior diferença absoluta. Esta escolha é feita analisando o diagrama p-h e o 
subdomínio em questão. Por exemplo, no caso da região de vapor superaquecido, a maior 
difença entre h_Max e h_Min ocorre sobre a linha de pressão critica. Onde h_Max = 
f(p_Max,T_Max) e h_Min = f(pcrit, Tcrit). Vale lembrar que o valor fornecido para o passo 



15 

  

da entalpia é usado apenas uma vez para definir o passo máximo e o número de divisões das 
isobáricas. Cada isobárica possui um passo diferente para a entalpia, pois os limites laterais 
não são paralelos. 

Figura 3.4 – Divisão do domínio em subdomínios. 
 
• Armazenamento dos dados 
 

O armazenamento dos pontos da grade e de suas respectivas propriedades é o último 
passo desta primeira etapa. Ao longo dos testes realizados, tais dados foram gravados em 
arquivos com extensão .txt e .bin. 
 
3.4 Método da Busca 
 

Após concluída  a construção da grade, o próximo passo é acessar os dados e calcular 
novos valores de T e ?  para um dado ponto p-h. O acesso aos dados é feito criando-se uma 
matriz vazia para cada subdomínio (líquido, vapor, bifásico ou crítico) e carregado-a com  
informações gravadas em arquivo. Em seguida, faz-se uma busca para identificar o 
subdomínio ao qual pertence o ponto p-h. Tal escolha é muito simples. Se p for maior do que 
a pressão crítica então o subdomínio crítico é o correto. Se não, um dos três restantes é o 
correto. Para saber qual destes, compara-se o valor de h com os valores de entalpia de líquido 
e vapor saturado para a linha de pressão p. Se h for menor que a entalpia de líquido saturado 
p-h está na região de líquido comprimido. Se h for maior que a entalpia de vapor saturado, p-h 
está na região de vapor superaquecido. Caso contrário, está na região bifásica. 

Identificado o subdomínio, o passo seguinte é fazer uma busca pelos três pontos mais 
próximos de p-h. Para isso, deve-se encontrar a menor linha de pressão i mais próxima de p e 
em seguida a coluna j da linha i com a menor entalpia mais próxima de h. Os valores de 
pressão correspondem à primeira coluna da matriz M1, pi = Mi,1, e os valores de entalpia ao 
restante da matriz deslocada de uma coluna, hi,j = Mi,j+1. 
 
• passo da pressão é fornecido por: ?p = |p1 - p2| 

 

11 ?
?
?

=
p
pp

i  3.1

 
onde i corresponde à menor isobárica mais próxima de p. 
 



16 

  

• passo da entalpia é fornecido por: ?h = |hi,1 - hi,2. Esta é constante para cada isobárica. 
 

1,1 ?
?
?

=
h
hh

j i  3.2

 
Onde j corresponde à entalpia mais de próxima h. Encontrados i e j, o ponto p-h estará contido 
no quadrilátero formado pelos nós: 
 
• nó1: i,j 
• nó2: i,j+1 
• nó3: i+1,j 
• nó4: i+1,j+1 
como indica a figura 3.5. 

Figura 3.5 – Quadrilátero onde estará contido o ponto p-h. 
 

O quadrilátero é dividido ao meio em dois triângulos como mostra a figura 3.6. Em um 
destes estará contido o ponto p-h. Entretanto, como a malha não é uniforme, a entalpia j+1 da 
linha i+1 não necessariamente coincide com a entalpia j da linha i. 

Figura 3.6 – Divisão do quadrilátero. 
 
Logo, o mesmo procedimento deve ser feito para encontrar a posição J da coluna na linha 
i+1. Para: 

?h = |hi+1,1 - hi+1,2| 
 



17 

  

11,1 ?
?
?

= +
h
hh

J i  3.3

 
Para averiguar a localização do ponto considerado foram utilizados vetores. Se o ponto 

estiver à direita de todos os vetores (vetores no sentido horário) ou estiver à esquerda de todos 
(sentido anti-horário), o mesmo estará contido no triângulo, conforme mostra as figuras 3.7 e 
3.8. Tal teste era feito calculando-se o produto vetorial entre um vetor formado por dois 
pontos do triângulo e o vetor formado por um ponto deste vetor e o ponto P. 
 
Condição: 

se ?&gt;×
??

0ba  ponto está a esquerda 

se ?&lt;×
??

0ba ponto esta à direita 

Figura 3.7 – Ponto contido no triângulo: P está a direita de todos os vetores. 

Figura 3.8 – Teste dos vetores para detectar a posição do ponto considerado: ponto fora do 
triângulo. 

 
3.5 Método de interpolação 

 
A função de interpolação, como já foi comentada anteriormente, deve ser uma função 

bastante simples, pois o objetivo é otimizar o tempo gasto. A mesma é uma equação do plano 
onde três pontos são suficientes para defini-lo. Na figura 3.9, os pontos OAB definem um 
plano. 
 



18 

  

 
Figura 3.9 – Os pontos AOB definem um plano no espaço. 

 
Da geometria analítica extrai-se a seguinte definição: se n é um vetor perpendicular ao 

plano OAB, então o produto interno de n por um vetor contido no plano será zero. Os pontos 
A,O e B têm as seguintes coordenadas: 
 

),,(
),,(
),,(

OOO

BBB

AAA

ThpO
ThpB
ThpA

=
=
=

 3.4

 

definindo os vetores 
?

OA , 
?

OB  
 

),,(

),,(

OBOBOB

OAOAOA

TThhppOB

TThhppOA

???=

???=
?

?

 3.5

 
e em seguida o vetor perpendicular ao plano 
 

)OBOBOB
OAOAOA

TThhpp
TThhpp

kji
OBxOAn

???
???==

???
 3.6

 

))(())((
))(())((

))(())((

OAOBOBOAT

OAOBOBOAh

OAOBOBOAp

hhpphhppn
ppTTppTTn

hThhTThhn

?????=
?????=

?????=

 3.7

 

onde np, nh e nT são as coordenadas do vetor 
?
n nas direções p, h e T, respectivamente. Se P é 

um ponto contido no plano OAB e  
 

),,( OpOpOp TThhppOP ???=
?

 
então, 

0=?
??

OPn  3.8
 
onde P = (p,h,T). As propriedades independentes são dadas por p e h e T é a propriedade a ser 
encontrada, resultando na equação seguinte: 



19 

  

 
0)()()( =?+?+? TOphOppOp nTTnhhnpp  3.9

Finalmente, 
 

O
T

hPOpPO
P Tn

nhhnpp
T +

?+?
=

))()((
 3.10

 
Dessa forma, apenas equações simples são necessárias para o cálculo de uma 

propriedade termodinâmica. Como foi indicado anteriormente, cada ponto possui quatro 
propriedades (p,h,T,?). Para o cálculo da densidade segue-se o mesmo raciocínio, mudando 
apenas a variável T para ?.  
 
3.6 Cálculos no ambiente MATLAB 
 

O MATLAB (versão 6.0) foi a primeira ferramenta de programação utilizada para os 
cálculos de interpolação. Por ter sido o primeiro passo na construção de um algoritmo de 
aceleração de cálculos de propriedades termodinâmicas, alguns problemas só foram 
descobertos e resolvidos na passagem para a linguagem C++, como será discutido mais 
adiante. Equações de estado de múltiplos parâmetros desenvolvidas para o CO2 nos limites de 
interesse: Tmin = -40ºC, Tmax = 250ºC, pmin = 1Mpa e pmax = 30Mpa. Aqui, apenas pressão, 
entalpia, temperatura e densidade eram necessárias. Foram exigidas as seguintes funções: T = 
f(p,h), ? = f(p,h) e T = f(p,?). Seguindo os passos de construção da grade de pontos já 
mencionados, as figuras 3.10 e 3.11 ilustram o aspecto da mesma construída. 

Figura 3.10 – Grade de pontos   Figura 3.11 – Malha segundo o item 3.3. 
segundo o item 3.3 

 
A figura 3.10 representa a região de líquido comprimido e possui uma pequena restrição 

no limite inferior onde todas as colunas convergem para um único ponto. Isto acontece porque 
a pressão de saturação para Tmin é ligeiramente superior à pressão mínima estabelecida, logo a 
primeira foi escolhida como mínima.  A figura 3.12 indica todo o domínio construído. O 
mesmo inclui as regiões de líquido sub-resfriado, bifásica, vapor superaquecido e gás. 

Outra restrição, semelhante àquela da região de líquido subresfriado, foi aplicada à 
região bifásica na linha de pressão crítica onde, a fim de respeitar o número de colunas da 
matriz que armazena os dados desta região, a mesma converge para um ponto: o ponto crítico. 
A figura 3.13 detalha graficamente o resultado do critério adotado. 



20 

  

Figura 3.12 – Apresentação de todo o domínio construído. 
 

Figura 3.13 – Resultado do critério de cálculos utilizando a convergência: todas colunas 
convergem para um único ponto: o ponto critico. 

 
3.7 Usando C++ 
 

O real interesse em criar uma ferramenta computacional que acelerasse o cálculo de 
propriedades termodinâmicas foi o de conectá-la a uma plataforma de simulação já escrita em 
C++. Nesta mudança de linguagem, o código foi escrito de forma mais elaborada e didática, 
facilitando a leitura para futuros usuários. A restrição imposta à região de líquido comprimido 
(Fig. 3.11) no MATLAB, onde havia uma convergência de pontos para a linha de pressão 
mínima, foi retirada tornando-a mais abrangente. Porém, a restrição ao ponto crítico na região 
bifásica permaneceu. Permaneceu ainda o uso de um arquivo para cada região. O método de 
busca e interpolação continuou o mesmo. No restante, nenhuma outra mudança significativa 
foi feita. 



21 

  

4. MÉTODO DA MALHA 
 
4.1 Introdução 
 
 Este capítulo aborda outro método para definir o domínio pressão-entalpia. O método da 
malha se assemelha ao método da grade de pontos apenas em um aspecto: todos os pontos 
foram calculados ao longo de isobáricas. Entretanto, neste método, cada isobárica recebeu 
dois tratamentos na determinação da quantidade de pontos: 

 
• Primeiro foi usado um passo fixo ?h para cada região e este definia o número de pontos 

de acordo com a extensão da isobárica. Por exemplo, para o CO2, na região de líquido 
comprimido, a uma pressão de 5MPa e uma variação de temperatura de –40ºC até a 
temperatura de saturação, a diferença de entalpia seria em torno de 100kJ/kg. 
Considerando um h?  arbitrário de 10kJ/kg o número de pontos é determinado pela 
equação 4.1: 

 

1+??
?

?
?
?
?

?

?
?

=
h
hh

n esqdir  4.1

 
onde: 
 
hdir = entalpia do extremo direito 
hesq = entalpia do extremo esquerdo 
 
O resultado indicaria 11 pontos. Quando o resultado é fracionário utiliza-se o maior inteiro 
mais próximo.  
 
• O segundo tratamento dado foi utilizando a definição do calor especifico, aqui chamado 

de método do cp, o qual será discutido no item 4.4. 
 

A liberdade de poder definir a densidade de pontos em cada isobárica foi a principal 
motivação em aperfeiçoar o trabalho, o que levou ao uso de um gerador de malhas. 
Entretanto, isso só foi possível após abandonar o uso das matrizes e adotar uma estrutura de 
dados mais sofisticada e complexa: a lista encadeada (apêndice B). 

O cálculo de interpolação continuou sendo o mesmo usado no método da grade de 
pontos: três pontos definindo um triângulo no espaço. Os pontos que compõem o domínio são 
usados em uma técnica de geração de malha conhecida como triangulação Delaunay 
(apêndice B). Com essa técnica, o domínio é dividido em triângulos cujos vértices, ou nós, 
são pontos previamente calculados. O algoritmo de busca foi completamente remodelado para 
atender à nova forma de manipulação dos dados. Testes com a triangulação Delaunay foram 
realizados no ambiente MATLAB e C++. O MATLAB foi utilizado inicialmente porque já 
possui funções preparadas de geração e visualização de malha, tornando o trabalho mais 
rápido. A linguagem C++, que é a linguagem de interesse desse trabalho, foi utilizada em 
seguida, pois era necessário criar uma interface gráfica e implementar todo o código de 
geração de malha e busca. 

 
4.2 Triangulação Delaunay 
 

A forma encontrada de fazer uso dos benefícios da lista encadeada e de facilitar os 
cálculos de interpolação foi o uso de um método de triangulação conhecido como triangulação 
Delaunay. Após os nós serem calculados e armazenados na lista, estes são manipulados pelo 



22 

  

algoritmo de triangulação e uma matriz de elementos n x 3 é criada, onde n representa o 
número total de elementos criados e 3 o número de colunas com os índices dos vértices de 
cada triângulo. Este método foi escolhido porque o tipo de interpolação usada trabalha com 
três pontos não colineares. Assim, a triangulação Delaunay definia os triângulos baseados nos 
pontos calculados e facilitava a busca e interpolação dos dados de entrada. Uma abordagem 
mais detalhada sobre este método de triangulação é discutida no apêndice B. 
 
4.3 MATLAB/C++ 

 
A construção dos pontos que formam a malha segue em parte o mesmo raciocínio usado 

pelo método da grade de pontos. O domínio é dividido em linhas horizontais igualmente 
espaçadas (isobáricas), cada uma possuindo uma certa quantidade de pontos.  

No MATLAB foi criada e visualizada a malha. A figura 4.1 representa a malha gerada 
no MATLAB para o CO2 usando um ?h fixo para cada região. A figura 4.2 mostra a malha 
usando o método do cp. 

Figura 4.1 – Malha gerada para o diagrama pressão-entalpia do refrigerante CO2 usando um 
?h fixo. 

 
As equações de estado de múltiplos parâmetros do C++ geraram os nós da malha. O 

único teste realizado com o MATLAB foi para avaliar a precisão dos dados interpolados.  
Para averiguar se a malha podia fornecer dados interpolados satisfazendo às exigências 

de precisão, um ponto arbitrário no interior de cada elemento triangular foi introduzido para 
simular um dado de entrada. Este ponto foi o baricentro do mesmo. Em seguida, os dados 
interpolados foram comparados com os valores obtidos através das equações de estado de 
múltiplos parâmetros e calculado o erro percentual. 

Em relação à velocidade dos cálculos interpolados, não foi possível proceder a esta 
averiguação no ambiente MATLAB, pois seria necessário comparar com o tempo consumido 
pelas equações de estados que estão implementadas em C++. Além disso, o MATLAB usa 
uma linguagem interpretada, enquanto que o C++ usa uma linguagem compilada. Esta ultima 
é mais rápida que a primeira, pois todo o código implementado é traduzido uma única vez 
para a linguagem de máquina antes de ser executado. No MATLAB, cada linha de código é 
traduzida toda vez que executada. Logo, não se deve comparar tempo consumido por cálculos 
realizados em uma linguagem interpretada com uma compilada. 



23 

  

Figura 4.2 – Malha gerada para o diagrama pressão-entalpia do refrigerante CO2 
usando o método do cp. 

 
Uma observação importante a ser feita aqui é que tanto no método da grade de pontos 

quanto neste método a visualização da malha não tem nenhuma finalidade visual para o 
usuário final, ou seja, a este só interessa os resultados provenientes da interpolação e a 
visualização das isolinhas e da curva de saturação. A malha serve apenas ao usuário avançado 
que está criando o banco de dados para avaliar a precisão dos dados interpolados. 

O cálculo de propriedades termodinâmicas na região bifásica como a densidade, 
temperatura e entropia podem ser calculadas de uma forma bem mais rápida e sem o auxílio 
de uma malha. A técnica usada foi dividir a região em isobáricas até o ponto critico. Para cada 
linha foram calculadas e salvas em arquivo as seguintes propriedades: pressão e temperatura 
de saturação e os valores de líquido e vapor saturado para a densidade, entalpia e entropia. A 
tabela 4.1 mostra essa organização. Para calcular dados nessa região uma matriz foi usada, 
pois o acesso aos seus dados é direto. Os valores da pressão são ordenados variando de uma 
pressão mínima p1 até a pressão crítica da substância. A temperatura de saturação é função 
apenas da pressão e as demais propriedades são funções da temperatura. Como os dados de 
entrada são pressão e entalpia, recorre-se à tabela para identificar o índice i que representa a 
menor pressão mais próxima do argumento p. Em seguida, usa-se uma interpolação linear 
para calcular as propriedades de saturação para aquela pressão, usando as equações 4.2 a 4.8.  

Com estas equações são calculadas as propriedades de líquido e vapor saturado da 
temperatura, densidade, entalpia e entropia para as linhas de pressão i e i+1. As isobáricas pi e 
pi+1 compreendem a pressão de entrada p. Em seguida, densidade, entropia e título podem ser 
calculados por meio das equações 4.9, 4.10 e 4.11.  

O procedimento para iniciar os cálculos usando todo o domínio seguiu o mesmo 
algoritmo tanto no MATLAB quanto em C++. A figura 4.3 apresenta o algoritmo utilizado 
para calcular uma propriedade termodinâmica ao longo da malha. 

 
Tabela 4.1 – Propriedades calculadas ao longo da linha de saturação. 

Propriedades termodinâmicas de saturação 
i Psat Tsat hl hv ?l ?v sl sv 
1 p1 T1 h11 hv1 ?11 ?v1 s11 sv1 
2 p2 T2 h12 hv2 ?12 ?v2 s12 sv2 
… … … … … … … … … 
n pcrit Tcrit h1= f(Tcrit) hv= f(Tcrit) ?crit ?crit s1= f(Tcrit) sv= f(Tcrit) 



24 

  

Figura 4.3 – Esquematização do algoritmo usado para calcular uma propriedade 
termodinâmica ao longo da malha. 

 
A temperatura de saturação é rapidamente calculada através da equação 4.2. 

 

i
ii

iii
sat

isat

i

ii

ii T
pp

ppTT
T

TT
pp

TT
pp

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.2

 
Usa-se o mesmo raciocínio para calcular as propriedades de líquido e vapor saturado para: 
 
Densidade 
líquido saturado: 

iL
ii

iiLiL
L

iLL

i

iLiL

ii

pp
pppppp

?
??

?
????

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.3

 
vapor saturado: 

iV
ii

iiViV
V

iVV

i

iViV

ii

pp
pppppp

?
??

?
????

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.4

 
Entalpia 
líquido saturado: 



25 

  

iL
ii

iiLiL
L

iLL

i

iLiL

ii h
pp

pphh
h

hh
pp

hh
pp

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.5

 
vapor saturado: 

iV
ii

iiViV
V

iVV

i

iViV

ii h
pp

pphh
h

hh
pp

hh
pp

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.6

 
Entropia 
líquido saturado: 

iL
ii

iiLiL
L

iLL

i

iLiL

ii s
pp

ppss
s

ss
pp

ss
pp

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.7

 
vapor saturado: 

iV
ii

iiViV
V

iVV

i

iViV

ii s
pp

ppss
s

ss
pp

ss
pp

+
?

??
=?

?
?

=
?
?

+

+

+

+

1

1

1

1 ))((  4.8

 
O segundo passo consiste em calcular o título em função do dado de entrada, h. 
 
Título 

LV

L

hh
hh

x
?
?

=  4.9

 
Densidade interpolada: 

?
?
?

?
?
?
?

? ?
+

=

VL

VL

L

x
??
??

?

?
1

1
 

4.10

 
Entropia interpolada: 

)( LVL ssxss ?+=  4.11
 

4.4 Pontos gerados em função do calor específico – Método do cp 
 

Inicialmente, os espaçamentos dos valores de entalpia para as isobáricas eram 
constantes e fornecidos como dados de entrada, ou seja, um ?h era fornecido para cada 
região. Dois motivos levaram ao desenvolvimento de uma nova forma de distribuição de 
pontos:  
 
• Tentar reduzir o máximo possível o número de pontos e, conseqüentemente, gerar um 

arquivo menor; 
• Adotar um critério não arbitrário na determinação do espaçamento entre dois pontos 

consecutivos;  
 

Como o problema envolve encontrar intervalos de entalpias ao longo de isobáricas, 
então a definição do calor específico se mostrou bastante apropriada, pois, como mostra a 
equação 4.11, o cp é uma relação entre entalpia e temperatura à pressão constante. 

O procedimento explicando como esta relação foi aplicada para determinar cada ?h será 
detalhado a seguir. 

 



26 

  

Figura 4.4 – Fluxograma para a geração de pontos da malha através do método do cp. 
 

p
P T

h
c ?

?

?
?
?

?

?
?

=  4.12

 
Para uma linha de pressão p qualquer: 
 
• Calcular os valores extremos de entalpia (hesq e hdir) assim como as temperaturas 

correspondentes (Tesq e Tdir) para a isobárica em questão. 
• Calcular o cp sempre em função dos parâmetros do lado esquerdo 
• Calcular cp’ = (hdir - hesq)/(Tdir - Tesq) 



27 

  

• calcular o erro: ??
?

?
??
?

? ?
=

cp
cpcp

e
'

100  

• se e for maior que a tolerância: 
2

esqdir
dir

hh
h

+
=  

• se e for menor ou igual a tolerância: diresq hh = , dirh = entalpia do extremo direito 
 
 A figura 4.4, mostra um fluxograma com os passos mais relevantes para a compreensão 
do método usado para o cálculo de cada ?h.  

Na região de líquido comprimido, as linhas de temperatura são quase verticais. Em 
certos momentos, ocorriam problemas de convergência. Uma pequena variação de entalpia 
implica uma grande variação de temperatura. Dessa forma, o erro e não ficava menor que a 
tolerância. Para resolver esse problema, junto ao teste do erro, adicionou-se um critério que 
estipulava um numero máximo de iterações. O erro e e o número de iterações passaram a ser 
os critérios pra encerrar o ?h atual e passar para o cálculo do ?h  seguinte. 

Para indicar o fim dos cálculos em uma isobárica e passar para uma seguinte foi usado 
como critério a diferença entre a entalpia do extremo direito e a entalpia da esquerda (hesq). 
Esta última tem a tendência de se aproximar da entalpia do extremo direito. Se esta diferença 
ficar abaixo de um valor estipulado, iniciam-se os cálculos em uma nova isobárica.  
 



28 

  

5. MÉTODO DA GRADE DE PONTOS MODIFICADA 
 
 Este método representa a terceira tentativa em criar um programa que pudesse realizar 
cálculos rápidos de interpolação de propriedades termodinâmicas com o uso de um reduzido 
banco de dados. A velocidade de acesso aos dados usados no método da grade de pontos foi 
associada com o uso de arquivos pequenos usados no método da malha. A interpolação linear 
continuou a mesma usada nos dois métodos anteriores. Temperatura, densidade e entropia são 
as propriedades calculadas de saída, além do título, quando p-h situar-se na região bifásica. A 
geração dos pontos que formam o banco de dados é a mesma utilizada no método da malha e 
baseada no método do cp, explicado no capítulo 4.  
 Resultados obtidos com o método da malha levaram ao desenvolvimento deste método. 
Por um lado, o método da malha mostrou-se satisfatório. Por outro lado não representou 
nenhuma modificação significativa em relação às equações de estado de múltiplos 
parâmetros. O capítulo 7 trata dos resultados dos métodos apresentados neste trabalho. 
 A única e grande modificação no método da grade de pontos modificada está 
relacionada à forma como os dados são manipulados durante os cálculos de interpolação. 
Todo o código de gerenciamento de malha foi substituído. A idéia adotada foi dividir todo o 
domínio em três grandes regiões: líquido comprimido, vapor superaquecido e supercritico. 
Cada uma dessas regiões possui um vetor que representa as isobáricas. Cada posição deste 
vetor possui o valor da pressão correspondente e “aponta” para quatro outros vetores que 
representam as propriedades h, T, ? e s. A figura 5.1 ilustra  essa organização de dados. Em 
relação à região bifásica, foi adotado o mesmo critério de cálculo apresentado no capítulo 4. 
 Dessa forma, houve um ganho de tempo muito significativo em relação à busca dos 
dados que são usados na interpolação. O algoritmo de busca segue o mesmo principio 
mostrado na figura 4.4. Quando o ponto ph cai fora da região bifásica, por exemplo, na região 
de líquido comprimido, primeiro são encontradas de forma direta as isobáricas i e i+1 que 
contêm p. Isso é possível porque as linhas de pressão são igualmente espaçadas.  A seguir, por 
não possuir espaçamentos constantes, uma busca binária é utilizada para encontrar as 
entalpias j e j+1 que contêm h.  

 

Figura 5.1 – Esquema de organização dos dados de uma região qualquer. 



29 

  

6. VISUALIZAÇÃO 
 

A visualização de propriedades termodinâmicas é um dos objetivos desse trabalho e visa 
a construção de um diagrama termodinâmico p-h com isolinhas de temperatura, densidade, 
entropia e título. Além disso, a visualização permite analisar graficamente os erros dos dados 
interpolados. 
 
6.1 Visualização da interface gráfica 
 

Outro ponto abordado neste trabalho trata da visualização de propriedades 
termodinâmicas. Uma interface gráfica foi desenvolvida em ambiente Windows para 
visualizar o diagrama pressão entalpia e isolinhas de temperatura, densidade, entropia e título, 
como mostra a figura 6.1. 

Figura 6.1 – Interface gráfica voltada para o usuário avançado. 
 

Na primeira parte deste trabalho, a visualização esta incorporada a uma plataforma que 
fornece as propriedades termodinâmicas de várias substâncias por meio de uma equação de 
estado de múltiplos parâmetros. A geração da tabela de dados, os procedimentos de 
interpolação e a exibição do diagrama estão presentes em um único programa. Este programa 
visa o usuário avançado e tem como objetivo construir a base de dados com a precisão e as 
dimensões de domínio exigidas pelo usuário final. Com esta parte do programa é possível 
determinar visualmente a precisão obtida pela interpolação. Por exemplo, caso seja exigida 
uma precisão de 0,1% na interpolação para temperatura e densidade no domínio pressão-
entalpia para uma faixa de pressão variando de 1MPa até 12MPa e uma faixa de temperatura 
variando de –40ºC até 150ºC, para o CO2, são geradas várias tabelas e para cada uma é 
analisado o erro em relação à densidade, como mostram as figuras 6.2 e 6.3. 

Assim que os pontos da tabela são calculados, uma malha triangular 2D sobre o 
domínio p-h é criada e o baricentro de cada triângulo de coordenadas h x p serve como 
argumento de entrada para o cálculo das propriedades. Em seguida, os valores das 
temperaturas e densidades interpoladas são comparados aos fornecidos pelas equações de 
estados e os erros são exibidos por meio de uma escala de cores. Essa escala pode ser ajustada 
de modo que o diagrama mostre as regiões onde a precisão requerida foi atingida. As regiões 
com erro superior ao exigido ficam em preto. À medida que os dados são refinados, as áreas 



30 

  

em preto vão diminuindo como mostram as figuras 6.2 e 6.3. A região abaixo da linha de 
saturação sempre fica em negro porque não há pontos suficientes para descrevê-la. Nesse caso 
a densidade e a entropia são calculadas por meio do título e das propriedades da linha de 
saturação. A temperatura é obtida interpolando os dados da mesma. Mais figuras 
demonstrativas dos erros podem ser vistas no apêndice D. 

Figura 6.2 – Erro relativo para densidade   Figura 6.3 – Área com refinamento 
 

Há duas formas de gerar a base de dados: fornecer um passo fixo de pressão e entalpia 
para cada região (líquido comprimido, vapor superaquecido e crítico) ou através do método 
do cp visto no capítulo 4. Essa escolha atualmente é feita fazendo uma pequena alteração no 
código do programa. 

A segunda parte consiste de uma interface construída visando o usuário final, aquele 
que deseja apenas as propriedades calculadas em tempo hábil e a visualização das isolinhas.  

Figura 6.4 – Interface gráfica voltada para o usuário final, exibindo linhas de 
temperatura, densidade, entropia e título constante para o CO2. 

 



31 

  

Os valores das propriedades termodinâmicas são calculados e exibidos acompanhando o 
movimento do cursor sobre o diagrama p-h. A posição do cursor sobre o diagrama tem 
coordenadas h,p e estas são utilizadas como propriedades independentes para o cálculo das 
demais. Temperatura, densidade, entropia e título são as propriedades calculadas, assim com 
suas isolinhas. As propriedades calculadas são exibidas na parte superior esquerda. A figura 
6.6 mostra a interface voltada ao usuário final. 

Figura 6.5 – Tabela para cálculo de propriedades termodinâmicas. 
 

Internamente, o programa trabalha com números inteiros para representar pixels ou a 
própria posição do cursor. Este fato faz com que não se obtenha  na tela todos os valores ph 
desejados por motivo de erro de arredondamento, já que estes são números reais.  Por outro 
lado, o diagrama mostra-se muito útil do ponto de vista prático. O programa dispõe de uma 
tabela (Figura 6.5) onde é possível entrar com valores de pressão e entalpia impossíveis de 
serem visualizados sobre o diagrama. Caso o usuário entre com pontos específicos de um 
ciclo de refrigeração, ainda se pode visualizar o mesmo sobre o diagrama. 

 
6.2 A carta psicrométrica 
 

Em paralelo ao presente trabalho foi desenvolvido um outro programa para cálculo e 
visualização de propriedades de uma mistura ar e água. Este programa constrói uma carta 
psicrométrica e age de forma similar ao anterior. Dados podem ser obtidos com o movimento 
do mouse sobre o diagrama. A grande diferença está na forma como os cálculos são 
realizados. O cálculo do volume específico, da temperatura de bulbo seco e bulbo úmido, da 
umidade relativa e da entalpia utiliza equações simples e estas são usadas de forma direta sem 
tornar o programa lento. Em condições ambientes, o ar seco e o vapor de água estão a uma 
baixa pressão e isso permite que se use a equação dos gases perfeitos sem comprometer os 
resultados.  

Além disso, não houve necessidade de criar uma tabela para posterior interpolação dos 
dados. Outras equações foram obtidas (ASHRAE 1997) por meio de ajuste de dados 
experimentais tais como a temperatura de ponto de orvalho e a pressão de saturação. 

O programa permite construir cartas psicrométricas em função da pressão atmosféricas 
ou da altitude. Todos os procedimentos necessários à construção da mesma foram baseados na 
obra de J. R. Simões Moreira, 1999. O apêndice E mostra os resultados assim como as 
equações usadas. 



32 

  

7. RESULTADOS E ANÁLISES 
 
 Neste capítulo são apresentados e discutidos os resultados obtidos com os métodos da 
grade de pontos, da malha e da grade de pontos modificada. São indicadas as vantagens e as 
desvantagens de cada método, assim como gráficos do cálculo dos erros percentuais para a 
densidade e a temperatura. São também apresentadas tabelas comparativas do tempo de 
cálculo entre os métodos. 
 
7.1 Método da grade de pontos no MATLAB 

 
7.1.1 Testes Realizados 

 
A avaliação da velocidade dos cálculos interpolados apresentou resultados bastante 

satisfatórios. Exigia-se que os cálculos de interpolação consumissem um tempo menor que 
1/10 do tempo consumido pela equação de estado (EOS). A tabela 7.1 mostra o que foi obtido 
em um computador equipado com um processador Atlhon 1.1GHz, 198MB RAM, Windows 
98. Nesta tabela foram realizados cálculos ao longo de três isobáricas em uma faixa de 
temperatura variando de –30ºC a 200ºC. Na segunda coluna está a relação entre o tempo 
consumido pelos cálculos de interpolação pelas equações de estado. 

 
Tabela 7.1 – Relação de tempo entre interpolação e equações de estado. 

(-30ºC&lt;T&lt;200ºC) interpolação/EOS 

p = 2,5MPa 0,016 
p = 5MPa 0,016 
p = 10MPa 0,062 

 
Como atesta a tabela 7.1, a relação ficou em torno de 10 vezes menor que o máximo 

desejado. A relação de tempo para a linha de pressão de 10MPa ficou um pouco maior em 
relação às outras duas porque a função de interpolação trabalha com uma quantidade muito 
grande de dados nesta região. Estes são copiados de uma função para outra, resultando em um 
consumo extra de tempo. 

No quesito precisão, foi exigido um erro percentual de %5,0±  para pressões abaixo de 
2,5MPa e acima de 20MPa e de %1,0±  para uma faixa de pressão entre 2,5MPa e 20MPa. As 
figuras 7.1 e 7.2 mostram o erro percentual para a densidade e temperatura, respectivamente 
Foram calculados pontos ao longo de 10 linhas de pressão com 20 pontos cada, com uma 
variação de temperatura de –30ºC até 250ºC. Para cada linha de pressão foi calculado 

),º30( pCTfhmín ?==  e ),º250( pCTfhmáx ?== . Este intervalo foi dividido de forma a 
conter 20 pontos.  

Nas figuras 7.1 e 7.2 o erro para a densidade ficou entre %4,0±  enquanto que o erro 
para temperatura ficou entre %1,0± . Os resultados para a densidade não foram tão precisos 
quanto os da temperatura porque, para uma linha de pressão p qualquer, a derivada da 
densidade em relação à entalpia é mais acentuada do que a derivada da temperatura em 
relação à entalpia. A densidade é mais sensível à variação de entalpia do que a temperatura. 
Como uma mesma linha de pressão cruza as regiões de líquido e vapor, a densidade apresenta 
valores altos na fase de líquido comprimido e valores menores na fase de vapor 
superaquecido, enquanto que com a temperatura essa variação é bem menor, como mostra os 
gráficos das figuras 7.3 e 7.4.  

Para a mesma faixa de entalpia (de 100 à 500kJ/kg) a temperatura varia de –40 até 
100ºC e a densidade de 200 até 1100kg/m3. A variação de densidade é em torno de 7 vezes 
maior que a de temperatura. 



33 

  

Logo, embora uma certa distribuição de pontos forneça uma boa aproximação para a 
temperatura interpolada, não implica em resultados satisfatórios para a densidade como 
mostra a explicação dada para as figuras 7.3 e 7.4. Uma forma de superar esse problema é o 
refino localizado. Ou seja, áreas que apresentam erros além do permitido receberiam uma 
concentração maior de pontos a fim de melhor representar os dados interpolados. Tal tarefa se 
torna muito trabalhosa usando a forma atual de armazenamento de dados. 

Figura 7.1 – Gráfico do erro percentual para a densidade no método da grade de pontos. 
 

Figura 7.2 – Gráfico do erro percentual para a temperatura no método da grade de pontos. 
 



34 

  

Figura 7.3 – Variação da temperatura com a entalpia ao longo de isobáricas. 

Figura 7.4 – Variação da densidade com a entalpia ao longo de isobáricas. 
 

7.1.2 Vantagens do método 
 
• Rápido acesso aos pontos de interpolação. 
• Fácil implementação do algoritmo. 
 



35 

  

7.1.3 Desvantagens do método 
 
• Uso de mais de um arquivo para o mesmo refrigerante, onde o ideal seria apenas um. 
• Concentração desnecessária de pontos em certas partes do domínio. 
• Dificuldade de refino local. 
• Grade distorcida na região próxima ao ponto crítico ocasionando erros consideráveis de 

interpolação. 
 

7.1.4 Comentários 
 

Conseguir uma quantidade mínima de pontos para satisfazer às exigências de precisão 
da função de interpolação foi uma tarefa demorada com o MATLAB, pois o refino  era 
aplicado a toda região, de uma forma arbitrária, o que implicou em uma grade de pontos 
muito grande, com grandes arquivos (todos com mais de 1MB), que consumiram muito tempo 
para serem carregados posteriormente. Isto se deve a uma construção não eficiente do 
algoritmo e ao fato do MATLAB usar uma linguagem interpretada e não compilada. 
Diante dessas dificuldades, antes de concluir o diagrama p-h, pensou-se em fazer o contrário: 
construir uma grade de pontos temperatura versus densidade e calcular as propriedades 
entalpia e pressão, o que seria uma tarefa bem mais rápida. 
 Como era de se esperar, a construção da grade inteira foi muito rápida e levou menos 
tempo que a construção da menor parte do diagrama p-h. Mas antes de fazer a interpolação é 
necessário fazer uma busca pelo argumento p-h através da grade e escolher os pontos certos 
para interpolar. Justamente nesse ponto a tentativa de usar um diagrama T-? fracassou. O 
tempo consumido para fazer tal busca  era praticamente o mesmo usado pela equação de 
estado para calcular uma propriedade e o principal objetivo deste trabalho é exatamente 
acelerar os cálculos das propriedades termodinâmicas e dispensar o uso de tais equações. 
Assim, esta tática foi abandonada e a anterior foi levada adiante. 

Mesmo sendo a melhor forma encontrada até então, os resultados obtidos não eram 
muito confiáveis, devido ao modo como o algoritmo trabalhava. Além disso, o tamanho dos 
arquivos inviabilizou esse tipo de estratégia.  

Assim, o uso do MATLAB na construção de uma grade de pontos e posterior 
interpolação de propriedades termodinâmicas, serviu como experiência, conferindo mais 
importância ao uso do C++. 

Trabalhando com C++, muitos erros cometidos no MATLAB foram corrigidos e o 
programa final apresentou resultados bem melhores. O resultado final foi um código 
otimizado e amigável ao usuário, com rapidez na geração e refino da grade. Graças a esses 
fatores, apenas o trabalho feito na linguagem C++ foi escolhido para se fazer os testes de 
velocidade de cálculo em relação às equações de estado e de precisão dos dados interpolados. 
Outro fator importante foi descobrir que os dados interpolados eram mais precisos quando o 
refino da grade era feito com a entalpia. Isto implicou em arquivos menores se comparados 
com os do MATLAB e, conseqüentemente, mais rápidos de serem lidos. 

 
7.2 Método da Malha 
 

Este método, a principio, pareceu ser a proposta final para resolver os cálculos de 
interpolação das propriedades termodinâmicas, pois vários problemas haviam sido superados 
como a melhor distribuição de pontos e a possibilidade de refino local. Os resultados dos 
dados interpolados foram satisfatórios como mostra as figuras 7.5 e 7.6. 

A avaliação do tempo consumido pelo método da malha apresentou um bom resultado 
quando os valores das propriedades são visualizados pela interface gráfica, apresentada na 



36 

  

figura 6.1. Nesta interface, as propriedades termodinâmicas são interpoladas e exibidas na 
parte superior quando o cursor passa sobre a região. O mesmo é representado por uma cruz.  

Fig 7.5 – Erro percentual para a temperatura pelo método da malha. 

Fig 7.6 – Erro percentual para a densidade pelo método da malha. 
 
Os cálculos são rápidos o suficiente para acompanhar o movimento deste. Isto se deve 

ao fato de que a posição do cursor é identificada no algoritmo de busca como sendo sempre 
um elemento vizinho da posição anterior. A figura 7.7 mostra um trecho qualquer da malha 
com a trajetória percorrida pelo cursor. Apenas os elementos em vermelho participam dos 



37 

  

cálculos. A localização dos elementos é muito rápida e isso facilita os cálculos de 
interpolação. Entretanto, se valores aleatórios de pressão e entalpia são fornecidos a este 
algoritmo, o tempo de busca torna-se alto o bastante a ponto de se igualar ou até mesmo 
ultrapassar o tempo gasto pelas equações de estado. Em um teste de comparação de tempo 
foram usados 10166 pontos p-h. Seus resultados são mostrados na tabela 7.2. 

Em média, as EOS levaram 10.36s e o método da malha 35.92s. O que torna as EOS 
quase três vezes e meia mais rápidas que o método da malha. Por esse motivo, este método 
não satisfez por completo os objetivos desejados. 
 
7.2.1 Vantagens 
 
• Utilização de um único arquivo por refrigerante. 
• Melhor distribuição de pontos. 
• Facilidade para refinamento localizado. 
• Resultados mais precisos. 
• Arquivo de menor tamanho quando comparado aos do primeiro método (cerca de seis 

vezes menor). 
 
7.2.3 Desvantagem 
 
• Praticamente o mesmo tempo consumido pelas equações de estado. 

 
Tabela 7.2 – Comparação entre tempo consumido pelas EOS e pelo método da malha. 

 Tempo em segundos 
Número de testes EOS Método da malha 

1º 10.40 34.8 
2º 10.24 36.12 
3º 10.41 36.20 
4º 10.40 36.22 
5º 10.43 36.27 

 

Figura 7.7 – Trecho qualquer da malha indicando o caminho percorrido pelo cursor. 
 

7.3 Método da grade de pontos modificada 
 

Associando a facilidade e rapidez no acesso de dados do primeiro método e a 
distribuição mais equilibrada dos mesmos por toda região do segundo método, o método da 
grade de pontos modificada apresentou os melhores resultados. Os resultados de precisão 



38 

  

ficaram tão bons quanto os do método da malha (vide Fig. 7.9 e 7.10). Em relação ao tempo 
consumido nos cálculos, os dois últimos métodos se igualam durante a visualização das 
propriedades por meio da interface gráfica. Quando comparados com as equações de estado o 
método da grade de pontos modificada leva uma grande vantagem. Na tabela 7.3 pode ser 
verificado o tempo consumido para calcular 10166 pontos pelas equações de estado e pelo 
método da grade modificada. Em média, o novo método é 115 vezes mais rápido do que as 
equações de estado de múltiplos parâmetros. 

Fig 7.8 – Erro percentual para a temperatura pelo método da grade modificada. 

Fig 7.9 – Erro percentual para a densidade pelo método da grade modificada. 



39 

  

Tabela 7.3 – Comparação do tempo consumido pelas EOS e peloo método da grade de 
pontos modificada. 

 Tempo em segundos 
Número de testes EOS Método da malha 

modificada 
1º 10.315 0.09 
2º 10.355 0.091 
3º 10.525 0.091 
4º 10.315 0.09 
5º 10.225 0.09 

 



40 

  

8. CONCLUSÕES E PROPOSTAS PARA FUTUROS TRABALHOS 
 
 Neste capítulo são relatadas algumas conclusões retiradas das experiências na 
elaboração do presente trabalho (principais conclusões) bem como as conclusões finais do 
deste trabalho referentes ao método da grade de pontos modificada. Ao final são apresentadas 
propostas para continuação do presente trabalho. 
 
8.1 Principais conclusões: 
 
• O método da grade de pontos serviu apenas como uma experiência introdutória na 

tentativa de criar uma forma rápida de calcular dados por meio de interpolação linear de 
dados pré-calculados. A geração de arquivos muito grandes tornou inviável a utilização 
deste método apesar da rapidez dos cálculos. 

 
• A uso da lista circular como estrutura de dados permitiu gerar pontos sobre o domínio 

p-h de forma muito mais equilibrada eliminado o problema da concentração 
desnecessária de pontos. Foi reduzido drasticamente o tamanho da memória necessária. 
Todas as informações foram condensadas em um único arquivo. Uma lista 
simplesmente encadeada também possibilitaria tal resultado. 

 
• O uso da triangulação Delaunay facilitou a interpolação por já definir os elementos 

triangulares usados na interpolação linear. Os cálculos são bastante rápidos apenas 
quando é usada a interface gráfica, ou seja, quando as coordenadas do cursor são 
convertidas em pressão e entalpia, pois estas fazem parte da trajetória percorrida pelo 
mesmo. Para calcular pontos aleatórios o tempo de resposta recai drasticamente, 
igualando-se ao tempo consumido pelas equações de estado. 

 
• O método da grade de pontos modificada foi o melhor método testado. Associou os 

arquivos pequenos obtidos com a lista circular e ao primeiro método. Graças à estrutura 
isobárica dos dados, foi possível indexar tais isolinhas e tornar o acesso aos dados muito 
mais rápido. Apesar dos pontos de entalpia não serem separados por um passo 
constante, o uso de uma busca binária não se mostrou, como se esperava um entrave tão 
sério, em relação ao tempo gasto. 

 
• A construção de uma grade de pontos usando o método de cp não apresentou nenhuma 

vantagem em relação ao anterior onde o passa da entalpia era informado diretamente. 
Os arquivos tinham quase os mesmos tamanhos e o método do cp consumia mais tempo 
para gera-los. 

 
• A possibilidade de refinar localmente apenas certas áreas ajudou a poupar memória. 
 
• A curvatura da linha de saturação próxima ao ponto critico produz elementos 

distorcidos diminuindo a proximidade dos pontos interpolados e levando, dessa forma, a 
erros significativos.  Porém, tal situação não compromete o programa pois, em geral, 
nas simulações nenhum componente é projetado para trabalhar próximo ao ponto 
crítico. 

 
• A visualização atendeu às expectativas. É possível visualizar as isolinhas de todas as 

propriedades calculadas assim como o percurso de um ciclo termodinâmico qualquer. 
Para esse último, bastando apenas fornecer os pontos relevantes do mesmo. 

 



41 

  

8.2 Conclusões finais 
 
• O método da grade de pontos modificada é o melhor para realizar cálculos rápidos de 

propriedades termodinâmicas, devido à estrutura de dados usada e ao rápido acesso a 
qualquer informação contida no arquivo. 

 
• O tamanho dos arquivos (um por substância é menor que 600kB) é outro ponto positivo 

do método da grade de pontos modificada. 
 
8.3 Proposta para futuros trabalhos: 
 
• Realizar trabalho semelhante para a construção de um diagrama T-s. Não foi possível 

concluir tal tarefa no presente trabalho. 
 
• Utilizar outras técnicas de interpolação a fim de se obter resultados mais precisos, 

porém sem tornar os cálculos demasiadamente lentos. 
 
• Acrescentar outras propriedades termodinâmicas como cp, cv, ou qualquer uma de 

interesse em simulações. 
 
• Realizar cálculos em função de outras variáveis de entrada como: p-T, p-v, T-v e h-s. 
 
• Desenvolver uma interface de comunicação a fim de receber dados de um dispositivo 

eletrônico de medição e obter de forma rápida outras propriedades termodinâmicas. 



42 

  

9. REFERÊNCIAS BIBLIOGRÁFICAS 
 
ASHARE HandBook, PSYCHROMETRICS. Chapter 6, 1997. 
 
BEJAN, A. Advanced Engineering Thermodynamics. p171-187, 1998. 

 
CHURAKOV, S.; GOTTSCHANK, M. Thermodynamic properties of natural fluids at high 
temperatures and pressures, Journal of Conference Abstracts, Vol. 5, p310, 2000. 
 
DIN, F. Thermodynamic functions of gases Vol. 1 Ammonia, Carbon dioxide and Carbon 
Monoxide. p1-31, 1956. 
 
EDISON, T.A; SENGERS, J.V. Thermodynamic properties of ammonia in the critical 
region. International Journal of Refrigeration 22, p365-378, 1999. 
 
GARLAND, W. J. Simple functions for the fast approximation of light water thermodynamic 
properties. Nuclear Engineering and Design 113, p21-34, 1989. 
 
GARLAND, W. J.; WILSON R. J., Extension to the approximation functions for fast 
calculation of saturated water properties. Nuclear Engineering and Design 136, p515-520, 
1992. 
 
GREGOROWICZ, J.; O'CONNELL J. P.; PETERS C.J. Some characteristics of pure fluid 
properties that challenge equation-of-state models. Fluid Phase Equilibria 116, p94-101, 
1996. 
 
INTERNATIONAL JOURNAL OF HEATING, VENTILATING, AIR-CONDITIONING 
AND REFRIGERATING RESEARCH. Vol 8, No 3, p311-333, 2002 
 
INTERNATIONAL THERMODYNAMIC TABLES OF THE FLUID STATE CARBON
DIOXIDE. IUAPAC, Vol 3, p37-67, 1973 
 
KRETZSCHMAR, H. J.; STÖCKER, I.; NABEL, M.; DITTMANN, A. A Method for 
Generating Interpolation Tables With Optimized Data Density For Fast Interpolations of 
Thermodynamic Properties in Process Modeling. Presented at the 1995 ASME International 
Mechanical Engineering Congress &amp;amp; Exposition, San Francisco, California. 
 
LASZLO, M. J. Computational Geometry and Computer Graphics in C++. p163-164, 1996. 
 
McFEE, D.G.; MUELLER, K.H.;  LIELMEZS, J. Comparison of benedict-webb-rubin, 
starling and lee-kesler equations of state for use in P-V-T calculations. Thermochimica Acta 
54, p9-25, 1982. 
 
McLINDEN, M.; LEMMON, E., JACOBSEN, R. Thermodynamic properties for the 
alternative refrigerants. International Journal of Refrigeration, Vol. 21, No. 4, p322-338, 
1997. 
 
MONTE, F. DE Calculation of thermodynamic properties of R407C and R410A by the 
Martin-Hou equation of state - part I: theoretical development. International Journal of 
Refrigeration 25, p306-313, 2002. 
 
MOREIRA, J. R. S. Fundamentos e aplicações da psicrometria. p21-86, 1999. 



43 

  

 
MÜLLER, C. W. Fast and accurate water and steam properties programs for two-phase flow 
calculation. Nuclear Engineering and Design 149, p 449-458, 1994. 
 
OLIVA, W. M. Vetores e Geometria.p80, 1973. 
 
PÁTEK, J.; KLOMFAR, J. Simple functions for fast calculation of selected thermodynamic 
properties of ammonia-water system. International Journal of Refrigeration, Vol. 18, p228-
234, 1995. 
 
PÁTEK, J.; SIFNER, O. Fast calculation of the properties of superheated steam from 
saturation curve up to 600ºC and 30MPa, Nuclear Engineering and Design 148, p515-520, 
1994. 
 
REIS, G. L., SILVA, V. V. Geometria Analítica, p107-109, 1996. 
 
SANDLER, S. I. Chemical and engineering thermodynamics, p147-149,181-183, 1989. 
 
SPAN, R. Multiparameter Equations of State. p2-58, 2000. 
 
SPAN, R.; WAGNER, W.; LEMMON, E. W.; JACOBSEN, R. T. Multiparameter equations 
of state – recent trends and future challenges. Fluid Phase Equilibria, p183-184, 2001. 
 
SWESTY, D. F. Thermodynamically Consistent Interpolation for Equation of State Tables. 
Journal of Computational Physics 127, p118-127, 1996. 
 
THE INTERNATIONAL ASSOCIATION FOR THE PROPERTIES OF WATER AND 
STEAM. Supplementary Realese on Backward Equations for Pressure as a Function of 
Enthalpy and Entropy p(h,s) to the IAPWS Industrial Formulation 1997 for the 
Thermodynamic Properties of Water and Steam, Gaithersburg, Maryland, USA, 2001. 
 
VAN DER WAALS, J. D. The equation of state for gases and liquids. Nobel Lecture, 
December 12, 1910. 
 
VASSERMAN, A. A.; SLYNKO, A. G., BODYUL, S. V. Thermophysical Databank for 
technically importante gases and liquids, Artigo apresentado no Fourteen Symposium on 
Thermophysical Properties, Boulder, Colorado, USA, Junho 25-30, 2000. 
 
WANG, S.; XIANG, H The modification and generalization of BWR equation, Fluid Phase 
Equilibria 181, p71-82, 2001. 
 
WEATHERILL, N. P. A method for generating irregular computational grids in multiply 
connected planar domains, Int.. Journal. for Numerical Methods in Fluids. Vol. 8, p182-186, 
1988. 
 
WYLEN, V. G. Fundamentos da Termodinâmica. p306-344, 4ºedição, 1997. 
 
ZHANG, H.; SATO, H.; WATANABE, K. A new three-parameter cubic equation of state for 
refrigeration engineering calculations. International Journal of  Refrigeration, Vol. 20, No. 6, 
p421-440, 1997. 
 



44 

  

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

APÊNDICES 



45 

  

APÊNDICE A 
 

Tabela A.1 
Propriedade e definição Relação com ? e suas derivadas 
  
Pressão 

Tv
a

Tp ?
?

?
?
?

?

?
?

?=),( ?  

 

r

RT
p

????
+= 1  

Entalpia 
h(T, p) = u + pv 
 

rr

RT
h

??? ????? +++= )(1
0  

Entropia 

vT
Ts ?

?

?
?
?

?

?
?

?=
?

?),(  

 

rr

R
s

????? ?? ??+=
00 )(  

Energia Interna 
TsaTu +=),( ?  

 
)( 0 r

RT
u

?? ??? +=  

Calor especifico à pressão 
constante 

p
p T

h
pTc ?

?

?
?
?

?

?
?

?=),(  

 

rr

rr
rp

R
c

???

???
???? ????

?????
???

2

2
02

21
)1(

)(
++
?+

++?=  

Calor especifico à volume 
constante 

v
v T

u
Tc ?

?

?
?
?

?

?
?

?=),( ?  

 

)( 02 rv
R
c

???? ??? +?=  

Coeficiente de Joule-Thomson 

h
p
T

pT ??
?

?
??
?

?

?
?

=),(µ  

 
)21)(()1(

)(
2022

2

rrrrr

rrr

R
??????????

?????

????????????
???????

?µ
?+???+

++?
=

Velocidade do som 

s

p
pTw ??

?

?
??
?

?

?
?

=
?

),(  

 
)(

)1(
21

02

2
2

2

r

rr
rr

RT
w

????

???
??? ???

?????
????

+
?+

?++=  

Energia de Gibbs 
TshpTg ?=),(  

 

rr

RT
g

????? +++=
01  

Derivadas da pressão 

?

?

?
?

?
?
?

?

?
?

??
?

?
??
?

?

?
?

T
p

p

T  
)1(

)21( 2

rr

rr

T

R
T
p

RT
p

???
?

???

??????

????
?

?+=?
?

?
?
?

?

?
?

++=??
?

?
??
?

?

?
?

 

 



46 

  

 
Tabela A.1 (continuação) 

Coeficiente e definições Regras de cálculo 
  
Coeficiente de estrangulamento isotérmico 

T
T p

h
pT ??

?

?
??
?

?

?
?

=),(?  

 

rr

rr

T
???

???

????
?????

??
221

1
1

?+
?+

?=  

Coeficiente de expansão isotérmica 

T
T v

p
p
v

pTk ?
?

?
?
?

?

?
?

?=),(  

 
T

T
p

p
k ??

?

?
??
?

?

?
?

?=
?

?
 

Coeficiente de expansão isentrópica 

s
s v

p
p
v

pTk ?
?

?
?
?

?

?
?

?=),(  

 
p
w

k s
2?

=  

Coeficiente de Expansão volumétrica 

p
v T

v
v

pT ?
?

?
?
?

?

?
?

=
1

),(?  

 
???

? ?
?

?
?
?

?

?
?

??
?

?
??
?

?

?
?

=
T
pp

T
v

1
 

Coeficiente de compressibilidade isotérmica 

T
T p

v
v

pT ??
?

?
??
?

?

?
?

?=
1

),(?  

 
p

kp T
T

T =??
?

?
??
?

?

?
?

?=
?1

1
??

?  

Coeficiente de compressibilidade isentrópica

s
T p

v
v

pT ??
?

?
??
?

?

?
?

?=
1

),(?  p
k

w
s

s == 2
1

?
?  

 



47 

  

Derivadas da Equação 2.28 
 

Tabela A.2 
Derivadas Dependência da 

densidade 
Constantes e dependência da temperatura 

  
0?   

 
=0?      )ln(?  ??

=

?

=

?+++++
PE

k

pol

i

K

k
k

I

i

t
i

III emcccc
11

0 )1ln()ln(
?????  

?
?
?

??
?

?
??
?

?

?
? 0

 

 

=0??      ?
1

 + 0 

?
?
?

??
?

?
??
?

?

?
? 0

 

 

=0???    2
1
?

?  + 0 

?
?
?

??
?

?
??
?

?

?
? 0

 

 

=0???      0 + 0 

?
?
?

??
?

?
??
?

?

?
? 0

 

 

=0??       0 ??
=

?
=

?
?
?

?
?
?

? ?
?

++++
PE

k

pol

i

K

k
kk

I

i

t
ii

I

e
mtc

c
c

11

10 1
1

1
?????

?  

?
?
?

??
?

?
??
?

?

?
? 0

 

 

=0???      0 ??
=

?

?

=

?
?
?
?

?
?
?
?

?

?
??+?

PE

k

kpol

i

K

k
kk

I

i

t
iii e

e
mttc

c
1

2

1

2
2
0

1
)1( ??

??

??
?

 

 



48 

  

Derivadas da Equação 2.30 
 

Tabela A.3 
Derivadas, abreviações e formulações em termos de ? e ? 

  

=r?  
 ??

+

+==

?+
exp

11

)exp(
II

Ii

p
i

td
i

I

i

td
i

pol

pol

iii

pol

ii nn ??????  

==??
?

?
??
?

?

?
? r

r

?
?

?
?
?

 

 
??
+

+=

?

=

? ??+
exp

1

1

1

1 )exp()(
II

Ii

p
i

tp
iii

d
i

I

i

td
ii

pol

pol

iiii

pol

ii pdndn ????????  

==??
?

?
??
?

?

?
? r

r

??
?

?
?
?

2

2

 

 ?

?

+

+=

?

=

?

?????

+?

exp

1

222

1

2

)exp())1)(((

)1(

II

Ii

p
i

tp
ii

p
iii

p
iii

d
i

I

i

td
iii

pol

pol

iiiiii

pol
ii

ppdpdn

ddn

??????????

??
 

==??
?

?
??
?

?

?
? r

r

?
?

?
?
?

 

 
??
+

+=

?

=

? ?+
exp

1

1

1

1 )exp(
II

Ii

p
i

td
ii

I

i

td
ii

pol

pol

iii

pol

ii tntn ??????  

==??
?

?
??
?

?

?
? r

r

??
?

?
?
?

2

2

 

 
??
+

+=

?

=

? ??+?
exp

1

2

1

2 )exp()1()1(
II

Ii

p
i

td
iii

I

i

td
iii

pol

pol

iii

pol

ii ttnttn ??????  

==??
?

?
??
?

?

??
? r

r

??
?

?
??

?2
 

 
??
+

+=

?

=

?? ???+
exp

1

1

1

11 )exp()(
II

Ii

p
i

tp
iii

d
ii

I

i

td
iii

pol

pol

iiii

pol

ii pdtntdn ????????  

==??
?

?
??
?

?

??
? r

r

??????
?

2

3

 ?

?

+

+=

??

=

??

????

+?

exp

1

21

1

21

)exp()()1(

)1(

II

Ii

p
i

tp
iii

d
iii

I

i

td
iiii

pol

pol

iiii

pol
ii

pdttn

ttdn

??????

??
 

 



49 

  

APÊNDICE B 
 
Triangulação Delaunay 
 
Definição: Seja P = {p1, p2, p3,..., pn} um conjunto finito de pontos. É considerada uma 
triangulação Delaunay se as seguintes condições forem satisfeitas:  
 
• Caso haja apenas três pontos estes não podem ser colineares; 
• Se houver um mínimo de quatro pontos estes não podem ser cocirculares; 
• A circunferência que circunscreve um triângulo só pode conter os vértices do mesmo.    
• Não é permitido nenhum ponto no interior da circunferência; 
• Arestas de triângulos não podem se cruzar; 

 
A figura B.1 mostra um pequeno exemplo de uma triangulação Delaunay. Os nós são 

interligados uns aos outros formando triângulos mas obedecendo às definições acima. 

Figura B.1 – (a) é uma triangulação Delaunay e (b), não o é. 
 
Teorema: Supondo o mesmo conjunto P de n pontos acima e que i seja o número de pontos da 
fronteira (Figura B.2), a triangulação de P contém exatamente n + i - 2 triângulos.   

Figura B.2 – Fronteira da malha em destaque. 
 
 A triangulação Delaunay é única para o mesmo conjunto de pontos. Algoritmos 
diferentes devem apresentar resultados idênticos. Essa definição é importante porque permitiu 
que testes fossem realizados por geradores de malha diferentes usando o mesmo conjunto de 
pontos. Dessa forma, malhas obtidas usando as funções do MATLAB ou implementadas em 



50 

  

C++ são idênticas se a distribuição de pontos for a mesma. Com isso, não houve nenhuma 
alteração de informação na passagem de uma linguagem para outra. 

Testes de geração de malha usando a triangulação Delaunay foram realizados 
primeiramente no ambiente MATLAB e, em seguida, usando a linguagem C++. O MATLAB 
foi usado inicialmente porque já possui uma função de geração de malha e a visualização da 
mesma pode ser feita de forma rápida. 
 
Estrutura de Dados – Lista circular duplamente encadeada 

 
Diferente de um vetor ou de uma matriz, que tem um tamanho fixo, a lista é uma 

estrutura de dados dinâmica, que cresce à medida que se precisa armazenar novos elementos e 
diminui à medida que se precisa retirar elementos armazenados anteriormente. Cada 
elemento(ou nó) da lista armazena a informação e dois apontadores: um para o antecessor e 
outro para o sucessor. Não é possível acessar um nó diretamente como ocorre com um vetor. 
Para acessar um nó é preciso percorrer todos os nós que o antecedem ou sucedem. A lista 
duplamente encadeada é um tipo de lista bastante versátil, pois é possível percorre-la em 
ambos os sentidos a partir de um ponteiro para qualquer elemento. Nos testes realizados, a 
informação contida de cada nó era composta por: pressão, entalpia, temperatura e densidade. 
A figura B.3 mostra uma lista circular duplamente encadeada. 

Figura B.3 – Lista circular duplamente encadeada. 



51 

  

APÊNDICE C 
 
1. Funções desenvolvidas por Garlan e Hand (1988) para representar algumas 
propriedades termodinâmicas em função de p e T para água. Para a região de líquido 
comprimido foram obtidas: 
 

)(2.0
375

170
))((),( ssf ppT

TpTp ??
?

?
?
?

? ?
?

+= ??  C.1

 

)(
369

169
4.1))((),( ssf ppT

TphTph ??
?

?
?
?

?

?
?+=  C.2

 

)(
370

325.0
0004.0))((),( ssf ppT

TpsTps ??
?

?
?
?

?

?
?+=  C.3

 
Os termos ?f, hf e sf  são funções da pressão de saturação e são descritos por meio da 
expressão C.4. 
 

db
sf cApF ][ +=  C.4

 
A expressão C.4 é definida para várias faixas de pressão assim como seus parâmetros A, b, c e 
d.  
 
Para a região de vapor superaquecido foram obtidas 
 

)(
)8(1096.1

]00106.0)100/(12.0[000466.0
)(),(

248

1.0

sg TT
pT

pT
p

pvTpv ?
?
?

?

?

?
?

?

?

?+×
?+

?+=
?

 C.5

 
 

)(225.2
100

28.0
104529.7
5.4

)(),( )162(008.0
236.0 s

T
g TTT

e
pT

p
phTph ?

?
?

?

?

?
?

?

?
??+

?×
+= ??

?
 C.6

 

(0053.010125.4
00006.0

)46(10025.3
004.0

)(),( 6
2511

2.1

g T
ppT

p
psTps

?
?

?

?

?
?

?

?
+×?+

?+×
+= ?

?
C.7

 
O subscrito g indica a propriedade na linha de vapor saturado. Cada uma das funções vg, hg e 
sg é definida para várias faixas de pressão, porém não se baseiam na expressão C.4. 



52 

  

2. Função de interpolação bi-quintic usada por Swesty (1996) para calcular a energia livre 
de Helmholtz em função da temperatura e densidade. 
Função de interpolação bi-quintic. 
 

Definição dos coeficientes da função bi-quintic. 



53 

  

APÊNDICE D 
 

A base de dados usados na interpolação é determinada observando-se o comportamento 
do erro por todo o domínio p-h. Os ajustes são feitos alterando-se os passos da pressão e/ou da 
entalpia. As figuras de 1 a 7 e a tabela D1 ilustram tal procedimento. É possível notar que a 
diminuição do passo da pressão exerce pouca influência na precisão (Figuras D1,D3 e D5) 
enquanto que a redução no passo da entalpia se torna bastante evidente (Figuras D2,D4 e D6). 

   Figura D1       Figura D2 
kPap 250=?  kgkJh /20=?     kPap 150=?  kgkJh /20=?  

 

        Figura D3       Figura D4 
      kPap 50=?  kgkJh /20=?     kPap 250=?  kgkJh /15=?  

 
Na figura D6, foi necessário reduzir o passo para 5 kJ/kg e conseguir uma redução 

significativa do erro. Porém, regiões que já estavam bem definidas receberam uma quantidade 
de informações além do necessário, aumentando assim o tamanho do arquivo. A figura D7 
mostra que o refino pode poupar alguma memória. Apenas as regiões onde o erro excedia o 
máximo tolerado tiveram o passo reduzido para 5kJ/kg. 



54 

  

          Figura D5        Figura D6 
kPap 250=?  kgkJh /10=?     kPap 250=?  kgkJh /5=?  

 

Figura D7 
kPap 250=?  kgkJh /10=?  

kPap 250=?  kgkJh /5=? (refino) 
 

Tabela D1 – Definição dos passos de pressão e entalpia para o CO2. 
Figura ?p (kPa) ?h (kJ/kg) 

D1 250 20 
D2 150 20 
D3 50 20 
D4 250 15 
D5 250 10 
D6 250 5 
D7 

Refino
250 
250 

10 
5 

 



55 

  

APÊNDICE E 
 
A figura E.1 mostra a interface criada para construir a carta psicrométrica em função da 
pressão atmosférica ou altitude. 

Figura E.1 – Interface criada para construir carta psicrométrica. 
 

À direita estão as propriedades que são calculadas em função da temperatura de bulbo seco 
(TBS) e da umidade absoluta (?). Sobre a carta, a linhas vermelhas são isoentalpicas, as 
linhas verdes isocóricas e as azuis são linhas de umidade relativa constante. A notação usada 
aqui é: 
 
TBS  = temperatura de bulbo seco 
TBU = temperatura de bulbo úmido 
Tov  = temperatura de ponto de orvalho 
?  = umidade relativa 
?  = umidade absoluta 
h  = entalpia específica 
v  = volume específico 
pv  = pressão parcial de vapor 
pa  = pressão parcial do ar seco 
psat  = pressão de saturação 
 
As equações foram obtidas em ASHARE, 1997, capítulo 6. 
 
pressão de saturação:   TCTCTCTCCTCp s ln/)ln( 13

3
12

2
111098 +++++=  

 
pressão em função da altitude: p = 101.325(1-2.25577x10-5Z)5.2559 
 


</field>
	</doc>
</add>