<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08469</field>
		<field name="filename">13307_Dissertacao_Mestrado_OLCarrapico.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 
 
 

OSWALDO LUIZ CARRAPIÇO 
 
 
 
 
 
 
 
 
 
 
 
 

CONTROLE PREDITIVO DE HORIZONTE INFINITO PARA  
 

PROCESSOS INTEGRADORES COM TEMPO MORTO 
 
 
 
 
 
 
 

Dissertação apresentada à Escola 

Politécnica  da  Universidade  de  

São Paulo para obtenção do título 

de Mestre em Engenharia. 

 
 
 
 
 
 
 
 
 
 
 
 

São Paulo 

Outubro de 2004 



 
 
 

OSWALDO LUIZ CARRAPIÇO 
 
 
 
 
 
 
 
 
 
 
 
 

CONTROLE PREDITIVO DE HORIZONTE INFINITO PARA  
 

PROCESSOS INTEGRADORES COM TEMPO MORTO 
 
 
 
 
 

Dissertação apresentada à Escola 

Politécnica  da  Universidade  de  

São Paulo para obtenção do título 

de Mestre em Engenharia. 

 

Área de Concentração: 

Engenharia Química 

 

Orientador: 

Prof. Dr Darci Odloak 

 
 
 
 
 

São Paulo 

Outubro de 2004 



 
São Paulo 

Outubro de 2004 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
 
 
 
 
 
        Carrapiço, Oswaldo Luiz 

Controle Preditivo de Horizonte Infinito para Processos    
Integradores com Tempo Morto 

        São Paulo, 2004. 
102p. 
 
Dissertação (Mestrado) – Escola Politécnica  da  Universidade  de             
São Paulo. Departamento de Engenharia Química. 

 
1. Controle de Processos    2. Controle Nominal  3. Horizonte Infinito 
4. Processo Integrador       5. Tempo Morto         6. Reciclo 
I. Universidade de São Paulo.  Escola Politécnica. Departamento de  
Engenharia Química II. t 

 



Agradecimentos 
 
 
 
Ao Prof. Dr. Darci Odloak pela orientação dada na condução deste trabalho 
 
À minha esposa Elisa pelo enorme incentivo dado nessa caminhada, principalmente nos 
momentos mais difíceis e que não foram poucos... 
 
À Petrobras pela viabilidade de educação continuada concedida aos seus profissionais 
 
À Refinaria Presidente Bernardes RPBC, representada pelo Gerente Setorial Antonio 
Maylinch Teruel e pelo Gerente de Otimização Fernando José Novaes, por permitir e 
acreditar na realização dessa especialização 
 
Ao engenheiro Euclides Almeida Neto pelas contribuições feitas ao longo da trajetória 
profissional de nossas carreiras 
 
Aos colegas do setor, pelo incentivo 
 
Aos meus pais, Fernanda e Antônio, pelo que representam.... 
 
Aos meus avós Brígida, Felismina (em memória), Armindo (em memória) e Remízio (em 
memória) que mostraram o caminho... 
 
Ao engenheiro e professor Oscar Rosé Filho (em memória), pela inspiração da boa 
formação de engenharia química quando aluno... 
 
E em especial à Deus, sem ele não seria possível...    



SUMÁRIO 

Lista de Figuras i 

Lista de Tabelas iii 

Lista de Símbolos iv 

Capítulo 1 Introdução e revisão da literatura 1 

1.1 Introdução 1 

1.2 Características integradoras com tempo morto em processos químicos 2 

1.3 Desenvolvimento dos controladores preditivos baseados em modelo (MPC’s) 3 

Capítulo 2 Modelo em variáveis de estado para sistemas integradores 6 

2.1 Introdução 6 

2.2 Representação de modelos em variáveis de estado 6 

2.3 Modelo em variáveis de estado para sistemas integradores sem tempo morto 7 

2.4 Exemplo 14 

Capítulo 3 Controlador IHMPC para sistemas integradores sem tempo morto 16 

3.1 Introdução 16 

3.2 Controlador de horizonte infinito para sistemas integradores sem tempo morto 16 

3.2.1 Lei de controle 16 

3.2.2 O controlador IHMPC estendido de Rodrigues e Odloak (2003) 21 

3.2.3 Nova extensão para o IHMPC 24 

3.2.4 Controlador IHMPC em duas camadas 28 

3.3 Exemplos 30 

Capítulo 4 IHMPC estendido para sistemas integradores com tempo morto 34 

4.1 Introdução 34 

4.2 Modelo em variáveis de estado para sistemas integradores com tempo morto 34 

4.2.1 O ROSSMPC de Gouvêa e Odloak (1997) 34 

4.2.2 Extensão do ROSSMPC para sistemas integradores com tempo morto 36 

4.3 Desenvolvimento do controlador IHMPC-E de modelo nominal 38 

4.4 Observador de estados para o IHMPC-E 52 

4.5 Aplicação do IHMPC-E a uma coluna de destilação 54 

4.5.1 Descrição sumária do processo analisado 54 

4.5.2 Representação da coluna em variáveis de estado 57 

4.5.3 Filtro de Kalman para a coluna 59 

4.5.4 Desempenho do IHMPC-E 60 

4.5.4.1 Caso Nominal 60 

4.5.4.2 Desempenho do IHMPC-E  para incertezas no modelo da planta 67 



Capítulo 5 Aplicação do IHMPC-E no controle de um sistema industrial complexo 73 

5.1 Descrição sumária do processo de óxido de eteno e seu problema de controle 73 

5.2 Modelo em variáveis de estado em sistemas integradores com tempos mortos diferentes 76 

5.3 Conceitos de observabilidade de um sistema 79 

5.4 Controle do sistema industrial de óxido de eteno com modelos aproximados 81 

Capítulo 6 Conclusões e Recomendações 92 

6.1 Conclusões 92 

6.2 Sugestões para trabalhos futuros 93 

Referências Bibliográficas 94 

Apêndice A 96 

A.1 Montagem matricial da predição das saídas ao longo do horizonte np  96 

A.2 Função Custo do Problema P4.1 na forma quadrática 99 

A.3 Função Custo do Problema P4.2 na forma quadrática 100 

A.4 Função Custo do Problema P4.3 na forma quadrática 101 

 



i 

Lista de Figuras 
 

Figura 3.1- Resposta do sistema com os controladores I e II 

Figura 3.2- Funções custo dos problemas P3.3 e P3.4b (controladores I e II) 

Figura 4.1- Esquema de controle convencional da coluna deisobutanizadora 

Figura 4.2- Tela gráfica operacional da coluna deisobutanizadora no SDCD 

Figura 4.3- Auto-valores da matriz [ ]( )FI K C A?  

Figura 4.4- Controladas 1y e 3y  com IHMPC-E  

Figura 4.5- Manipuladas 1u e 2u  com IHMPC-E 

Figura 4.6- Função custo do caso servo em 1y e 3y com IHMPC-E  

Figura 4.7- Controladas 1y e 4y  com IHMPC-E  

Figura 4.8- Manipuladas 1u e 2u com IHMPC-E 

Figura 4.9- Função custo do caso servo em 1y e 4y  com IHMPC-E  

Figura 4.10- Controladas 1y e 3y  em função da perturbação 1du  com IHMPC-E  

Figura 4.11- Manipuladas 1u e 2u  em função da perturbação 1du  com IHMPC-E 

Figura 4.12- Função custo do caso regulador com perturbação 1du  com IHMPC-E  

Figura 4.13- Controladas 1y e 3y  com IHMPC-E e incerteza nos ganhos  

Figura 4.14- Manipuladas 1u e 2u  com IHMPC-E e incerteza nos ganhos 

Figura 4.15- Controladas 1y e 3y  com IHMPC-E e incerteza nas constantes de tempo  

Figura 4.16- Manipuladas 1u e 2u  com IHMPC-E e incerteza nas constantes de tempo  

Figura 4.17- Controladas 1y e 3y  com IHMPC-E e incerteza no tempo morto  

Figura 4.18- Manipuladas 1u e 2u  com IHMPC-E e incerteza no tempo morto  

Figura 5.1- Auto-valores da matriz [ ]( )FI K C A?  

Figura 5.2- Variação na composição do gás de reciclo : setpoints 1y e 2y  

Figura 5.3- Manipuladas para o caso servo em 1y e 2y  

Figura 5.4- Função custo do caso servo em 1y e 2y  

Figura 5.5- Efeito do peso das variáveis de folga no desempenho do IHMPC-E 

Figura 5.6- Variação na temperatura de óleo térmico : setpoint 3y  

Figura 5.7- Manipuladas para o caso servo em 3y  



ii 

Figura 5.8- Função custo do caso servo em 3y  

Figura 5.9- Variação na pressão do gás de reciclo : setpoint 4y  

Figura 5.10- Manipuladas para o caso servo em 4y  

Figura 5.11- Perturbação na vazão de oxigênio: variáveis controladas 

Figura 5.12- Perturbação na vazão de oxigênio: variáveis manipuladas 

 
 



iii 

Lista de Tabelas 
 

Tabela 3.1 – Parâmetros de sintonia dos controladores I e II  

Tabela 4.1 – Parâmetros de sintonia do IHMPC-E nominal  

Tabela 4.2 – Parâmetros de sintonia do IHMPC-E de modelo incerto  

Tabela 5.1 – Parâmetros de sintonia do IHMPC-E de modelo incerto  

 



iv 

Lista de Símbolos 
 

A  matriz característica do modelo incremental em malha aberta 
*A  matriz A  modificada que limita predições das saídas no infinito 

A%  matriz característica do modelo posicional em malha aberta 
~

AB  matriz auxiliar em função de A , B  e m  

B  matriz de distribuição das entradas do modelo incremental em malha aberta 

B%  matriz de distribuição das entradas do modelo posicional em malha aberta 
C  matriz das saídas do modelo incremental 

fC  matriz auxiliar da função objetivo dos problemas de programação quadrática 

C%  matriz das saídas do modelo posicional 
C  matriz auxiliar em função de A , C  e np  

C
==

 matriz auxiliar em função de A , B , C , m  e np  

c  gradiente da função objetivo dos problemas de programação quadrática 
0D  matriz dos ganhos de regime permanente 
0
mD  matriz 

0D  estendida ao longo do horizonte de controle 

iD  matriz dos coeficientes dos pólos integradores 
i
mD  matriz 

iD  estendida ao longo do horizonte de controle 

dD  matriz dos resíduos de regime permanente 

D%  matriz auxiliar em função de 0D , iD , m  e t?  
e  erro entre uma dada saída y qualquer e seu valor de referência spy  

F  matriz incremental do regime transiente do sistema 

uF  matriz auxiliar em função de 
dD , F  e N  

xF  matriz auxiliar em função de F  

G  matriz auxiliar em função de 0D , iD , F  e N  

G  matriz auxiliar em função de 0D , iD , ? , F  e N  

( )G s  matriz das funções de transferência entre as saídas e as entradas 

, ( )i jG s  função de transferência entre uma saída i  e uma entrada j  

H  matriz Hessiana da função objetivo dos problemas de programação quadrática 



v 

I  matriz identidade 
* ( )I t  matriz referente a parcela dinâmica associada aos pólos integradores 

I  matriz auxiliar das variáveis de folga sk?  ao longo do horizonte de controle 

J  matriz auxiliar em função de nu  e na  

k  instante qualquer de tempo discreto 

FK  ganho do observador de estados (Filtro de Kalman) 

L  matriz auxiliar em função de ? e F  

L  matriz L  estendida ao longo do horizonte de controle   

m  horizonte de controle das variáveis manipuladas 

N  matriz auxiliar usada na resposta do sistema ao degrau 

,i jna  número de pólos da função de transferência entre a saída iy  e a entrada ju  

nd  número de estados  

np  horizonte de predição finito das variáveis controladas 

nu  número de entradas (variáveis manipuladas) 

ny  número de saídas (variáveis controladas) 

P  matriz auxiliar do Filtro de Kalman em função de A , C , V  e W  

Q  matriz de Lyapunov 

Q  matriz de ponderação das variáveis controladas 

Q%  matriz Q  estendida ao longo de um horizonte definido m ou np  
R  matriz de supressão das variáveis manipuladas 

R%  matriz R  estendida ao longo do horizonte de controle 
r  pólo de uma função de transferência 

s  coeficiente da resposta ao degrau 

kS  matriz dos coeficientes da resposta ao degrau referente ao instante de tempo k  

1S  matriz de ponderação das variáveis de folga 
s
k?  

2S  matriz de ponderação das variáveis de folga 
i
k?  

t  tempo 

T  matriz auxiliar das variáveis de folga ik?  ao longo do horizonte de controle 

u  vetor das variáveis manipuladas 

U  espaço da região viável de solução das variáveis manipuladas 



vi 

V  matriz de sintonia do filtro de Kalman 

kV  função custo do algoritmo de controle num dado instante de tempo k  

x  vetor de estados do modelo, 
Ts d ix x x x? ?= ? ?  

[ ] / 1k kx ? vetor de estados no instante k  com informações da planta do instante anterior 

[ ] /k kx   vetor atualizado dos estados com informações da planta do instante atual 
sx  vetor de estados integradores gerado pela forma incremental do modelo 
dx  vetor de estados estáveis do modelo 
ix  vetor de estados integradores do modelo 

y  vetor das variáveis controladas 

spy  vetor de referência (setpoints) das variáveis controladas 

1
spy  vetor estendido de setpoints das variáveis controladas 

p
ky  vetor de saídas da planta medidas no instante k  

W  matriz de sintonia do filtro de Kalman 

 

Símbolos Gregos 
 

?  operador diferença 

t?  período de amostragem do controlador preditivo 

( )t?  matriz da parcela dinâmica associada aos estados transientes 

* ( )t?  matriz * ( )I t generalizada para integradores com diferentes tempos mortos 

?  matriz auxiliar para a atualização dos estados 

?  autovalores de uma matriz quadrada 

?  constante de tempo de um sistema de primeira ordem (domínio de Laplace) 

?  matriz dos tempos mortos do sistema 

,i j?  tempo morto entre uma saída i  e uma entrada j  

s
k?  variáveis de folga num dado instante de tempo k , relacionadas aos pólos   

            integradores criados pela forma incremental do modelo 
i
k?  variáveis de folga num dado instante de tempo k , relacionadas com os pólos  

            integradores do sistema 



vii 

Siglas 

 

ARX  Auto-Regressive with eXogenous inputs 

DCS  Digital Control System 

DMC  Dynamic Matrix Control 

FCC   Fluid Catalytic Cracking 

IHMPC Infinite Horizon Model Predictive Control 

IHMPC-E Extended Infinite Horizon Model Predictive Control 

LDMC  Linear Dynamic Matrix Control 

LP   Linear Programming 

MIMO  Multi-Input Multi-Output 

MPC  Model Predictive Control 

NLP  Non-Linear Programming 

OPOM  Output Prediction Oriented Model 

QDMC Quadratic Dynamic Matrix Control 

QP  Quadratic Programming 

ROSSMPC Reducer Order State Space MPC 

SISO  Single-Input Single-Output 

SQP  Sequential Quadratic Programming 

 

 

 

Sobrescritos 

 

T operação de transposição de uma matriz. 

 



 

RESUMO 

 

Na literatura de controle, os controladores preditivos disponíveis apresentam 

aplicações limitadas em processos com características integradoras. Uma dessas 

limitações está relacionada às propriedades estabilizantes que surgem da lei de controle 

quando o sistema é colocado em malha fechada. O principal objetivo dessa dissertação é 

desenvolver um algoritmo de controle preditivo, nominalmente estável, baseado num 

horizonte de predição infinito das saídas do sistema. Para essa finalidade, uma 

representação existente em variáveis de estado é analisada e estendida para ser capaz de 

ser aplicável para processos estáveis e integradores, com tempo morto. 

 

Dois métodos distintos que garantem a estabilidade de sistemas integradores 

foram desenvolvidos com um MPC de horizonte infinito. Para o caso de realimentação 

de estado, a estabilidade nominal do MPC proposto foi provada para os dois métodos e 

a eficiência dos controladores foi verificada através de exemplos da literatura de 

controle. Um dos controladores foi também aplicado em um processo de destilação de 

uma refinaria de petróleo. O algoritmo desenvolvido foi estendido para o caso de 

realimentação das saídas com a inclusão do filtro de Kalman para a estimativa dos 

estados do modelo. 

 

A aplicação do controlador em um sistema com diferentes tempos mortos entre 

as variáveis integradoras foi também estudada. 

 

 

 

 

 

 

 

 

 

 



 

ABSTRACT 

 

In the control literature, the available predictive controllers show limitations to 

be applied in processes that have integrating behavior. One of these limitations is related 

to the stabilizing properties of the resulting control law when the system is in closed 

loop. The main objective of this work is to develop a nominal stable control algorithm 

based on infinite prediction of system outputs. For this purpose  an existing state space 

representation is explored and extended in order to be able to be applied to stable and 

integrating process with dead time.  

 

Two distinct methods to assure stability of integrating systems were developed 

for the infinite horizon MPC. For the case of state feedback, nominal stability of the 

resulting MPC was proved for the two methods and the efficiency of the controllers was 

verified through examples of the control literature. One of the controllers was also 

applied to an industrial distillation process of a petroleum refinery. The developed 

algorithm was extended to the output feedback operation with the inclusion of a Kalman 

filter for estimation of the model states.  

 

The application of the controller to a system with different dead times between 

integrating variables was also studied. 

 



 1 

Capítulo 1 

Introdução e revisão da literatura 

 

1.1 Introdução 
 

Dois importantes aspectos a serem observados em um determinado controlador 

preditivo multivariável são a sua aplicabilidade em sistemas que apresentam tempo 

morto entre as entradas e as saídas e a capacidade de tratar sistemas com pólos 

integradores e/ou estáveis. Esses comportamentos combinados contemplam uma grande 

parcela dos processos químicos industriais e foi essa a principal motivação no 

desenvolvimento dessa dissertação, na qual propõe-se um controlador nominalmente 

estável  e que possua a capacidade de combinar todas essas características. 

 

Os primeiros algoritmos de controle preditivo multivariável baseado em modelo 

(MPC) surgiram no final da década de 70 com o chamado DMC (Dynamic Matrix 

Control) proposto por Cutler e Ramaker (1979). O método era baseado em horizonte de 

predição finito e em coeficientes de resposta ao degrau e ao impulso. Esses coeficientes 

armazenados em uma matriz, são em grande número coletados até a completa 

estabilização do sistema. Para sistemas de grande porte, exigia-se um grande esforço 

computacional para a época. A sua aplicação é bastante satisfatória para sistemas 

estáveis mas possui limitação para uso em sistemas instáveis ou integradores. Em 1986, 

Garcia e Morshedi desenvolveram o controlador QDMC baseado em programação 

quadrática para uso nas restrições lineares das variáveis manipuladas. 

 

A partir daí, diversas proposições de abordar o problema de controle preditivo 

podem ser vistas na literatura ao longo do tempo. A primeira delas foi de representar o 

modelo não mais em coeficientes de resposta, mas sim em variáveis de estado. Como 

decorrência natural dessa representação, tem-se duas maneiras de se tratar as entradas 

nesse modelo, ou seja, de forma posicional ou de forma incremental. Um outro aspecto 

investigado na literatura foi o horizonte de predição das variáveis controladas. Os 

primeiros MPC’s (convencionais) tiveram a sua formulação baseada em horizonte finito 

para as predições, o qual é parte integrante da lei de controle, tornando-se um parâmetro 

de sintonia do controlador e influenciando a performance do mesmo.



Capítulo 1 – Introdução e revisão da literatura       2 

 

1.2 Características integradoras com tempo morto em processos químicos  
 
 

O sistema integrador mais conhecido em processos químicos é o inventário em 

fase líquida de um determinado equipamento (nível em vasos, reatores, fundos de 

colunas de fracionamento, etc.). Normalmente essa dinâmica vem acompanhada de 

algum tempo morto, elevado ou não, conforme a particularidade de cada sistema. 

 

Em relação a um processo como um todo, onde tem-se vários equipamentos 

interligados, a característica integradora aparece pelo fato de haver uma ou mais 

correntes de reciclo em algum ponto do processo.  

 

Moro e Odloak (1995) descrevem que o conversor de uma unidade de 

craqueamento catalítico em leito fluido (FCC), que existe na maioria das refinarias de 

petróleo, torna-se integrador quando a temperatura do reator é usada como variável 

manipulada pelo MPC. 

  

Recentemente, Wu et al (2003) descreveram processos com características 

integradoras com tempo morto (reator interligado com reciclo de uma coluna de 

destilação) e estabeleceram algumas estratégias de controle para esses casos, mas sem 

ser considerado um controle preditivo. Nesse trabalho observa-se que há inúmeras 

referências anteriores citadas, por exemplo, Luyben et al (1999), que apresentam 

estudos sobre a interação entre processos integradores e estratégias de controle. 

Percebe-se então que existe uma linha de pesquisa desse assunto na literatura ainda 

aberta e com poucas publicações. 

 

Assim, efetivamente um algoritmo de controle terá que ser analisado sob 

aspectos da teoria de controle, e também, com relação à capacidade de interagir com a 

dinâmica dos processos químicos, particularmente os integradores com tempo morto. 

 



Capítulo 1 – Introdução e revisão da literatura       3 

 

1.3 Desenvolvimento dos controladores preditivos baseados em modelo (MPC’s)  
 

O controlador preditivo multivariável é um algoritmo de controle em tempo 

discreto que incorpora internamente um modelo do processo que permite prever para 

instantes futuros a resposta do mesmo. Em cada instante de amostragem, a lei de 

controle (sequência discretizada de ações das variáveis manipuladas) é obtida a partir da 

otimização de uma função objetivo, a qual é formulada ao longo de um horizonte de 

otimização. Somente a primeira ação de controle é implementada. No instante de 

amostragem seguinte todo o procedimento é repetido. 

 

Com relação à forma de representação do modelo em variáveis de estado, a 

maioria dos trabalhos disponíveis em literatura usam a forma posicional. Sob o ponto de 

vista de aplicação industrial, a forma posicional não é implementável em função de 

perturbações naturais no processo, que não são medidas e que podem levar o sistema a 

vários estados estacionários desconhecidos ao longo do tempo.  

 

A representação de um MPC em variáveis de estado apareceu primeiramente 

formulada por Li e Fisher (1989) que explicam suas propriedades e mostram a 

utilização do filtro de Kalman para estimar o estado e perturbações não medidas do 

processo. Lee et al (1994) também desenvolveram um MPC em variáveis de estado. 

 

Lee e Xiao (2000), Lee e Cooley (2000) apresentam abordagens em variáveis de 

estado na forma incremental.  

 

Odloak (1996) apresenta um desenvolvimento original para a forma incremental 

denominado OPOM (Modelo Orientado à Predição da Saída) e utilizado por Rodrigues 

e Odloak (2003), o qual é aqui estendido para aplicação em diversos tipos de processos, 

estáveis ou integradores, incorporando ou não tempo morto. A característica principal 

desse método é que a predição passe a ser obtida de forma analítica ao invés da maneira 

convencional, que armazena todos os valores de resposta em forma de um vetor.  

 



Capítulo 1 – Introdução e revisão da literatura       4 

Rodrigues (2001) considerou o OPOM para sistemas estáveis e instáveis, não 

abordando o caso de sistemas com tempo morto. 

 

Cano (2001) utilizou o OPOM em sistemas integradores puros sem tempo morto 

no desenvolvimento de um algoritmo de controle robusto. Uma das proposições citadas 

para futuros trabalhos era a extensão do método para sistemas com pólos integradores e 

estáveis, incorporada agora nesta dissertação a qual é também estendida para a inclusão 

de tempo morto. 

 

Com relação ao horizonte de predição, Rawlings e Muske (1993) mostraram que 

para sistemas estáveis quando o estado é medido e o horizonte de predição tende a 

infinito, então o MPC é inerentemente estável independentemente dos parâmetros de 

sintonia utilizados pelo controlador. Neste caso, fica implícita também a hipótese de que 

o modelo do processo seja perfeito, isto é, não contenha erros de modelagem. Esse caso 

é definido como nominal. O algoritmo de controle é denominado IHMPC (Controle 

Preditvo baseado em Modelo de Horizonte Infinito) e é formulado em variáveis de 

estado na forma posicional. Ele é restrito a sistemas estáveis em malha aberta. A 

estratégia principal desse método consiste em converter o horizonte de predição infinito 

para um estado terminal equivalente cujo peso é obtido pela equação discretizada de 

Lyapunov. 

 

Rodrigues e Odloak (2000), usando o OPOM, desenvolveram uma formulação 

alternativa para o MPC de horizonte infinito (IHMPC) em relação ao convencional. 

Essa nova formulação tem várias vantagens sobre a anterior. A principal delas é que se 

aplica a sistemas não quadrados (número de manipuladas diferente do número de 

controladas), o que não acontece com o controlador de Rawlings e Muske (1993). A 

formulação porém, não contemplava na época os sistemas integradores.  

 

Esta dissertação está dividida em seis capítulos incluindo este introdutório.  

 

No Capítulo 2 apresentamos a representação de sistemas em variáveis de estado, 

dando ênfase à forma incremental, mostrando a evolução do OPOM desde seu início até 

incorporar sistemas estáveis e integradores sem tempo morto.  



Capítulo 1 – Introdução e revisão da literatura       5 

No Capítulo 3 apresentamos o desenvolvimento de um algoritmo de controle 

preditivo de horizonte infinito, nominalmente estável, para sistemas integradores sem 

tempo morto, baseado no OPOM. O método é uma extenção do utilizado por Rodrigues 

e Odloak (2003) o qual fornece a estabilidade para o caso nominal para condições de 

processo mais amplas do que em métodos anteriores. Sua característica principal é a 

eliminação do conflito entre as restrições das variáveis manipuladas e as restrições de 

igualdade que surgem para anular o efeito dos modos integradores ao final do horizonte 

de controle. A formulação da lei de controle é a definida em Cano e Odloak (2003) que 

contempla sistemas estáveis e integradores. 

 

No Capítulo 4 é desenvolvida a extensão do controlador de horizonte infinito 

nominalmente estável para sistemas integradores com tempo morto. A correção dos 

estados é feita através de um observador, sendo utilizado o filtro de Kalman para essa 

finalidade. Apresentaremos a aplicação desse controlador em um processo de destilação 

de hidrocarbonetos leves, típico de uma refinaria de petróleo.  

 

No Capítulo 5 apresentamos os resultados do controlador de horizonte infinito 

aqui desenvolvido para um sistema que possua tempos mortos diferentes entre as 

variáveis integradoras. Nessa aplicação, é verificada a performance de rastreabilidade 

em relação aos ‘setpoints’ e a rejeição de perturbações. O processo analisado é um 

reator catalítico com reciclo de uma corrente em fase vapor oriunda de coluna de 

absorção. Esse sistema foi apresentado por Cano (2001) e Rodrigues e Odloak (2003), 

porém sem a presença de tempos mortos e também com estrutura de controle diferente 

da que apresentaremos aqui. 

 

No Capítulo 6 apresentamos as conclusões finais sobre a proposição desse novo 

algoritmo de controle.  

 



 6 

Capítulo 2 

Modelo em variáveis de estado para sistemas integradores   

 

2.1 Introdução 
 

O objetivo deste capítulo é apresentar o modelo que será utilizado no 

desenvolvimento do MPC de horizonte infinito para sistemas com dinâmica estável e 

integradora simultaneamente, sem a presença de tempo morto, o qual será visto no 

capítulo seguinte. 

O modelo estudado está na forma de variáveis de estado e, como veremos, com 

características bastante adequadas para a interpretação física dos estados, o que facilita a 

dedução das condições necessárias para a garantia da estabilidade da malha fechada. 

 

2.2 Representação de modelos em variáveis de estado 
 

Em sistemas discretos lineares invariantes no tempo, a representação em 

variáveis de estado de um sistema qualquer aparece na literatura de duas formas gerais. 

A primeira delas é a chamada forma posicional e pode ser colocada na seguinte forma : 

 

[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x
+

= +

=

% % %
%%

 
 

(2.1) 

onde 

[ ]
k

x  é o vetor de estados no instante de amostragem k 

nu
ku ?% R  é o vetor de entradas manipuladas, que implicitamente corresponde à  

               diferença entre o valor real da entrada e o valor correspondente ao  

               estado estacionário : k k SSu u u= ?%  
ny

ky ?% R  é o vetor de saídas controladas.  
               Analogamente, entende-se que k k SSy y y= ?%  

            A% , B% e C%  são matrizes de dimensões adequadas



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 7 

            A segunda forma é a incremental, assim chamada porque a entrada manipulada é 

definida como a diferença entre instantes consecutivos. A representação geral desse 

modelo é dada por   

 

[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
 

(2.2) 

onde 

-1-k k ku u u? =    , sendo k  o instante de amostragem. 

 

As dimensões das matrizes A , B  e C  serão diferentes das suas correspondentes 

A% , B%  e C%  do modelo posicional.  
 

Será usada nesta dissertação, apenas a representação de sistemas em variáveis de 

estado na forma incremental. Essa abordagem traz vantagens em relação à forma 

posicional, pois, não há necessidade do conhecimento prévio do estado estacionário do 

processo e permite portanto, a consideração de perturbações não medidas no sistema.  

 
Apresentaremos a seguir, a descrição do modelo aqui utilizado até chegarmos à 

sua formulação mais geral possível, que será usada no capítulo 3, na proposição de um 

controlador preditivo de horizonte infinito para sistemas estáveis integradores sem 

tempo morto. No capítulo 4, esse mesmo modelo será estendido para sistemas estáveis e 

integradores com tempo morto. 

 
 
2.3 Modelo em variáveis de estado para sistemas integradores sem tempo morto    
 

Para entender o desenvolvimento desse modelo, faremos a sua dedução passo a 

passo inicialmente com um sistema SISO, para o qual se tenha a seguinte função de 

transferência no domínio de Laplace (é assumido que o processo não tenha raízes 

repetidas) : 

 

( )
( ) ( 1)

y s K
u s s s

=
? +  

 

(2.3) 

 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 8 

A resposta ao degrau unitário correspondente é dada por 

( )
t

S t K K e K t
?

?= ? ? + ? +  
 

Essa função pode ser colocada na seguinte forma genérica : 

 

0( )
t

d iS t d d e d t
?

?= + +  
 

(2.4) 

onde 

        0d , dd  e id  são constantes.  

 

Discretizaremos o sistema representado em (2.3) considerando um intervalo de 

amostragem t? e seguindo o seguinte procedimento : 

 

1) Admitamos que no instante de amostragem k, a saída do sistema possa ser 

representada por uma função similar à da resposta ao degrau dada pela Eq.(2.4), na 

seguinte forma 

 

[ ( )] [ ] [ ] [ ]
t

s d i
k k k ky t x x e x t

?
?= + +  

 

(2.5) 

onde 

       [ ]s kx , [ ]
d

kx , e [ ]
i

kx  são parâmetros da trajetória da saída do sistema 

 

2) Em seguida consideremos o efeito da ação de controle ku?  

[ '( )] [ ( )] ( )k k ky t y t S t u= + ?  
 

3) Fazemos então a translação ao instante de amostragem seguinte k+1 e recalculamos 

a trajetória da saída usando esse instante como nova origem de tempo 

 

1[ ( )] [ '( )] [ ( )] ( )k k k ky t y t t y t t S t t u+ = + ? = + ? + + ? ?  
(2.6) 

 

Substituindo a  Eq.(2.4) e Eq.(2.5) na Eq.(2.6) obtém-se  



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 9 

( ) / 0 ( ) /
1[ ( )] [ ] [ ] [ ] ( ) ( ( ))

s d t t i d t t i
k k k k ky t x x e x t t d d e d t t u

? +? ? ? +? ?
+ = + + + ? + + + + ? ?  

                                                                                                                                   (2.7) 

 

4) Reescrevemos a Eq.(2.7) na seguinte forma adequada 

1 1 1 1[ ( )] [ ] [ ] [ ]
t

s d i
k k k ky t x x e x t

?
?

+ + + += + +  
onde 

0
1[ ] [ ] [ ] ( )

s s i i
k k k kx x t x d td u+ = + ? + + ? ?  

(2.8) 

 

1[ ] [ ]
t t

d d d
k k kx e x d e u

? ?
? ?

? ?
+ = + ?  

 

(2.9) 

 

1[ ] [ ]
i i i

k k kx x d u+ = + ?  
(2.10) 

 

Pela Eq.(2.5), a saída do sistema no instante de amostragem k  é dada por  

 

[ ] [ (0)] [ ] [ ]s dk k k ky y x x= = +  
(2.11) 

 

As equações (2.8), (2.9), (2.10) e (2.11) podem ser agrupadas de maneira 

conveniente e assim sendo, representadas na forma de variáveis de estado 

 

1[ ] [ ]k k kx A x B u+ = + ?  
(2.12) 

 

[ ] [ ]k ky C x=  
(2.13) 

 

onde 

 

[ ]
s

d
k

i
k

x
x x

x

? ?
? ?

= ? ?
? ?
? ?      

1 0

0 0
0 0 1

t

t

A e
?? ?

?? ?
? ?
? ?=
? ?
? ?? ?       

0 i

t
d

i

d d t

B d e
d

?? ?

? ?+ ?
? ?
? ?=
? ?
? ?
? ?       [ ]1 1 0C =  



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 10 

Essa formulação apresenta um aspecto importante que é a capacidade da 

predição de toda a trajetória das saídas a partir do instante de amostragem k 

 

[ ( )] ( )[ ]k ky t C t x=  
onde  

          ( ) [1 ]
t

C t e t
? ?=  

 

Nessa representação, o estado sx  corresponde aos pólos integradores 

relacionados à forma incremental do modelo. O estado dx corresponde aos pólos 

estáveis do sistema. O estado ix  corresponde aos pólos integradores do próprio sistema. 

Esses pólos aparecem nos elementos da diagonal da matriz A . 

 

Para um sistema multivariável com nu entradas e ny saídas, um procedimento 

análogo ao caso do sistema SISO pode ser aplicado para a construção do modelo em 

variáveis de estado. Consideremos que para cada saída iy  e entrada ju  exista uma 

função de transferência dada por  

 
2

, ,0 , ,1 , ,2 , ,
, 2

, ,1 , ,2 , ,

( )
(1 )

nb
i j i j i j i j nb

i j na
i j i j i j na

b b s b s b s
G s

a s a s a s s

+ + + +
=

+ + + +
L

L
 

 

(2.14) 

onde  { }, | 1na nb nb na? &amp;lt;+¥   
 

Admitindo que os pólos do sistema não sejam repetidos, a resposta ao degrau 

pode ser escrita na seguinte forma 

 

0
, , , ,

1
( ) [ ] l

na r td i
i j i j l i j

l
S t d d e d t

=
= + +?  

 

(2.15) 

onde  

        lr , l =1, 2, ..... , na são os pólos não-integradores do sistema  

        0 , ,...,d di nad d d , 
id  são os coeficientes obtidos pela expansão em frações      

                                      parciais da função de transferência ,i jG . 

 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 11 

Combinando os efeitos de todas as entradas, no instante de amostragem k a 

predição da trajetória da saída iy  pode ser formulada na seguinte forma contínua 

 

[ ] , ,, ,
1 1

( ) [ ] [ ] [ ]         1, ,i j l
nu na r ts d i

i i k i j l k i kk
j l

y t x x e x t i ny
= =

= + + =? ? …  
(2.16) 

 

Para esse sistema, os estados sx , dx  e ix são definidos por  

 

0
1

1 1
[ ] [ ] [ ] [ ] [ ] ,       1, ,

nu nu
s s i i
i k i k i k ij j k ij j k

j j
x x t x d u t d u i ny+

= =
= + ? + ? + ? ? =? ? …

 

(2.17) 

 

, , , ,
1[ ] [ ] [ ] i = 1, ... , ;   j = 1, ... , ;    l = 1, ... ,

i j l i j lr t r td d d
ijl k ijl k ijl j kx e x d e u ny nu na

? ?
+ = + ?

 

(2.18) 

 

1
1

[ ] [ ] [ ] ,       1, ,i i ij
nu

i i i
k k j k

j
x x d u i ny+

=
= + ? =? …

 

(2.19) 

 

Reescrevendo as equações acima em notação matricial, temos  

 
0

1[ ] [ ] [ ] ( )
s s i i

k k k kx x t x D tD u+ = + ? + + ? ?  
(2.20) 

 

1[ ] [ ]
d d d

k k kx F x D FN u+ = + ?  
(2.21) 

 

1[ ] [ ]
i i i

k k kx x D u+ = + ?  
(2.22) 

 

onde 

 

1 2[ ] [ ]
s s s s T

nyx x x x= L ,     1 2[ ] [ ]
i i i i T

nyx x x x= L  
 

1,1,1 1,1, 1, ,1 1, , ,1,1 ,1, , ,1 , ,[ ] [ ]
d d d d d d d d d T

na nu nu na ny ny na ny nu ny nu nax x x x x x x x x= L L L L L L L
 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 12 

0 0
1,1 1,

0

0 0
,1 ,

nu
ny nu

ny ny nu

d d
D

d d

×

? ?
? ?= ?? ?
? ?? ?

L
M O M ¡

L
; 

1,1 1,

,1 ,

i i
nu

i ny nu

i i
ny ny nu

d d
D

d d

×

? ?
? ?= ?? ?
? ?? ?

L
M O M ¡

L
 

 

( ),1,1 ,1, , ,1 , ,1,1,1 1,1, 1, ,1 1, ,diag ny ny na ny nu ny nu nana nu nu na r t r t r t r tr t r t r t r t nd ndF e e e e e e e e ×? ? ? ?? ? ? ?= ?L L L L L L L £
 

( )1,1,1 1,1, 1, ,1 1, , ,1,1 ,1, , ,1 , ,diagd d d d d d d d d nd ndna nu nu na ny ny na ny nu ny nu naD d d d d d d d d ×= ?L L L L L L L £
 

1

2 nd nu

ny

J
J

N

J

×

? ?
? ?

= ?? ?
? ?
? ?? ?

¡M            
.

1 0 0 0
1 0 0 0

1 0 0 0
0 1 0 0
0 1 0 0

0 1 0 0

0 0 0 1
0 0 0 1

0 0 0 1

nu na nu
iJ

×

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?= ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?

L
L

M M M L M
L
L
L

¡M M M L M
L

M
L
L

M M M L M
L

                                     (2.23) 

onde  

. .nd ny nu na=  

 

A eq.(2.16) pode ser utilizada para obter-se a expressão da saída do sistema no 

instante de amostragem k , ou seja, 

 

, ,
1 1

[ ] [ (0)] [ ] [ ]         1, ,
nu na

s d
i k i k i k i j l k

j l
y y x x i ny

= =
= = + =? ? …

 

 

(2.24) 

 

As equações (2.20),(2.21),(2.22) e (2.24) escritas na forma de variáveis de 

estado ficam na seguinte forma  

1[ ] [ ]k k kx A x B u+ = + ?  
(2.25) 

 

[ ] [ ]k ky C x=  
(2.26) 

 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 13 

onde 

1

[ ]k
ny k

y
y

y

? ?
? ?=
? ?
? ?? ?

M
         

[ ]

s

nxd
k

i

x
x x

x

? ?
? ?= ?
? ?
? ?? ?

£
        

0
0 0
0 0

ny ny
nx nx

ny

I t I
A F

I

×

?? ?
? ?= ?
? ?
? ?? ?

£
                   

 

           

0 i

nx nud

i

D tD
B D F N

D

×

? ?+ ?
? ?= ?
? ?
? ?? ?

C                                                                         (2.27) 

 

. .

1 0 0 1 1 1 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0 0

0 0 1 0 0 0 1 1 1 0 0 0

ny nynu na nu na

C

? ?
? ?
? ?
? ?=
? ?
? ?
? ?
? ?

64748 64748 64748 64748
L L L L
L L L LLM M L M M M L M M M L M M M L M
L L L L

 
       com 2nx ny nd= +   

 

A trajetória das saídas dada pela Eq. (2.16) escrita na forma matricial será dada 

por 

 

[ ] [ ]( ) ( )k ky t C t x=  
(2.28) 

 

onde 

 

*( ) [ ( ) ( )] ny nxC t I t I t ×= ? ? £  
(2.29) 

 

1

2

( ) 0 0
0 ( ) 0

( )

0 0 ( )

ny nd

ny

t
t

t

t

×

?? ?
? ??? ?? = ?
? ?
? ?

?? ?? ?

L
L

£M M O M
L

 

 

(2.30) 

 

,1,1 ,1, , ,1 , ,( ) [ ] i = 1, 2,..., i i na i nu i nu na
r t r t r t r t nd

i t e e e e ny? = ?L L L £
 

(2.31) 

 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 14 

*
1

*
* 2

*

( ) 0 0

0 ( ) 0
( )

0 0 ( )

ny ny

ny

f t

f t
I t

f t

×

? ?
? ?
? ?

= ?? ?
? ?
? ?
? ?? ?

L
L ¡

M M O M
L

 

 

(2.32) 

onde * ( )if t t=  se existir pólo integrador associado à saída i ,  

         caso contrário,  * ( ) 0if t = . 

 

A resposta ao degrau para o sistema multivariável fica representada por 

 
0 *( ) ( ) ( )d iS t D t D N I t D= + ? +  (2.33) 

 

 

 

2.4 Exemplo     
 

Para ilustrar o desenvolvimento apresentado na seção anterior, tomemos para 

exemplo um sistema multivariável 2x2 (duas variáveis controladas com duas variáveis 

manipuladas) e o representemos em variáveis de estado na forma incremental. Esse 

sistema foi estudado por Rodrigues e Odloak (2003) sendo parte de um processo 

químico de um reator catalítico de oxidação de etileno. 

 

A matriz de funções de transferência é dada abaixo : 

  

1,1 1,2

2,1 2,2

0,19 1, 7
( ) ( ) 19, 5 1

( ) ( ) / ( )
( ) ( ) 0, 763 0, 235

31, 8 1

G s G s s s
G s y s u s

G s G s
s s

? ?? ?
? ?? ? +
? ?= = =? ? ?? ?? ?
? ?+? ?

 

 

Considerando por exemplo, um intervalo entre amostragens de 1 mint? =  e 

usando a Eq.(2.2) obtemos a seguinte caracterização em variáveis de estado na forma 

incremental : 

 



Capítulo 2 – Modelo em variáveis de estado para sistemas integradores 15 

 

[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
 

(2.2) 

 

1 1

2 2

1 1

2 2

1 1

2 2

( 1) ( )1 0 0 0 1 0 0,1
( 1) ( )0 1 0 0 0 1
( 1) ( )0 0 0, 9500 0 0 0

0 0 0 0,9690 0 0( 1) ( )
0 0 0 0 1 0( 1) ( )
0 0 0 0 0 1

( 1) ( )

s s

s s

d d

d d

i i

i i

x k x k

x k x k

x k x k

x k x k

x k x k

x k x k

? ? ? ?+ ?? ?? ? ? ?
? ?? ? ? ?+
? ?? ? ? ?
? ?+? ? ? ?

= +? ?? ? ? ?
+ ? ?? ? ? ?

? ?? ? ? ?+ ? ?? ? ? ?
? ?? ?? ? ? ?+? ? ? ?

900 1, 7000
-0,7630 0,2350

0 1,6150
0,7394 0
-0,1900 0

0 0,2350

ku

?? ?
? ?
? ?
? ?

?? ?
? ?
? ?
? ?
? ?? ?

 

 

1

2

1 1

2 2

1

2

( )

( )

( ) ( )1 0 1 0 0 0
( ) 0 1 0 1 0 0 ( )

( )

( )

s

s

d

d

i

i

x k

x k

y k x k
y k x k

x k

x k

? ?
? ?
? ?
? ?

? ? ? ? ? ?
=? ? ? ? ? ?

? ?? ? ? ?
? ?
? ?
? ?
? ?  

 

onde 

 

1
-1

2

( )
-

( )k k k
u k

u u u
u k

?? ?
? = = ? ??? ?

 

 

[ ] 1
2

( )
( )k

y k
y

y k
? ?

= ? ?
? ?

 

 

[ ]

1

2

1

2

1

2

( )
( )

( )
( )

( )
( )

( )
( )
( )

s

s
s

d
d

dk
i

i

i

x k
x k

x k
x k

x x k
x k

x k
x k
x k

? ?
? ?
? ?? ?
? ?? ?

= = ? ?? ?
? ?? ?

? ? ? ?
? ?
? ?? ?

 



 16 

Capítulo 3 

Controlador IHMPC para sistemas integradores sem tempo morto  

 

3.1 Introdução 
 

O objetivo de um MPC qualquer é determinar uma sequência de ações de 

controle futuras para que a predição das saídas da planta (variáveis controladas), dentro 

de um horizonte de predição (finito ou infinito), estejam o mais próximo possível de 

seus valores de referência (‘setpoints’) de acordo com alguma função custo pré-

estabelecida que leve em conta os desvios em relação aos mesmos com o menor esforço 

possível nas ações das variáveis manipuladas.  

 

Do ponto de vista da aplicação industrial, da sequência de ações de controle 

determinadas, somente é implementada a primeira ação de controle. No período de 

amostragem seguinte, todo o procedimento é repetido usando a última medida da planta. 

Esta estratégia, conhecida como horizonte móvel, permite compensar os erros de 

modelagem ou perturbações futuras do sistema com as leituras da planta. 

 

 
 
3.2 Controlador de horizonte infinito para sistemas integradores sem tempo morto 
 

3.2.1 Lei de controle 
 

Levando em consideração o peso nas variáveis controladas e as ações nas 

manipuladas, propõe-se a função custo do MPC de horizonte de predição infinito para 

sistemas discretos dada por :  

 

1

1,
0 0

( ) ( ) ( ) ( )
m

T T
k

j j

V e k j Q e k j u k j R u k j
? ?

= =

= + + + ? + ? +? ?
 

 

(3.1) 

onde 

         ny nyQ ×? ¡  é uma matriz definida positiva  
         nu nuR ×? ¡  é uma matriz semi-definida positiva  



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 17 

        ( ) ( ) spe k j y k j y+ = + ?   é o erro de predição das variáveis controladas no  

                                                instante de amostragem ‘k+j’ incluindo o efeito  

                                                das futuras ações de controle. 

        spy é a trajetória de referência das variáveis controladas. 

        m  é o horizonte das ações de controle.  

 

Para que as predições das saídas sejam limitadas no infinito e por consequência 

o próprio valor da função custo 1,kV  dada pela Eq.(3.1), impomos a anulação do efeito 

dos estados s
k m

x
+

? ?? ?  e 
i

k m
x

+
? ?? ? no instante k m+ . Essa mesma proposição foi usada por 

Rawlings e Muske (1993). 

 

Relacionando o estado s
k m

x
+

? ?? ? em função de 
s

k
x? ?? ? e o estado 

i

k m
x

+
? ?? ? em função 

de i
k

x? ?? ?  temos as seguintes restrições de igualdade  

 
0

2,( ) ( ) 0
s i

m me k D D u+ ? ? =  (3.2) 

 

1,( ) 0
i i

mx k D u+ ? =  (3.3) 

 

onde 

 

( ) ( )s s spe k x k y= ?  

0 0 0 0[ ]

m

mD D D D=
644474448

L .ny m nu×? ¡  

1, [ ]

m

i i i i
mD D D D=

6447448
L  .ny m nu×? ¡  

2, 0 ( 1)
i i i

mD t D m t D? ?= ? ? ?? ?L  
.ny m nu×? ¡  

 

.

( )

( 1)

m nu

u k
u

u k m

?? ?
? ?? = ?? ?
? ?? + ?? ?

M ¡  



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 18 

Considerando as condições definidas pelas equações (3.2) e (3.3) na Eq.(3.1), a 

função custo torna-se 

 
1 1

1,
1 0

( ) ( ) ( ) ( ) ( ) ( )
m m

T d T d T
k

j j
V e k j Q e k j x k m Q x k m u k j R u k j

? ?

= =
= + + + + + + ? + ? +? ?

 

onde 
__

Q  é obtida pela solução da seguinte equação discreta de Lyapunov  

 

T T TQ F QF F Q F? = ? ?  
 

 

Pela Eq.(2.12) e Eq.(2.13) obtemos de forma recursiva as predições entre o 

instante k e o instante k+m  

 

( ) ky Lx k G u= + ?  
 

onde 

 

( 1) ( 2) ( )
TT T Ty y k y k y k m? ?= + + +? ?L             (1) (2) ( )

TT T TL L L L m? ?= ? ?L     
( ) jny nyL j I F j t I? ?= ? ?? ?  

1,1

2,1 2,2 0
,

,1 ,2 ,

0 0
0

; ( )i j l d ij l

m m m m

G
G G

G G D t D F D FN j l t D

G G G

?

? ?
? ?
? ?= = + ? + ? + ? ?
? ?
? ?
? ?? ?

L
O

M M O M
L

   

  

 

O estado dx  no instante k+m obtido em função do instante k é dado por 

 

( ) ( )d x ux k m F x k F u+ = + ?  

onde 

0 0mx nd ny nd nyF F× ×? ?= ? ?         
1d m d m d

uF D F N D F N D FN
?? ?= ? ?L  



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 19 

A função custo é então escrita sob a seguinte forma : 

 

1, 1 ,12
T T

k fV u H u C u c= ? ? + ? +   (3.4) 

onde 

1
T T

u uH G QG F QF R= + +% %  

,1 ( ( )) ( )
TTsp T T

f x uC I y L x k QG x k F QF? ?= ? + +? ?
%  

ny

ny

I
I

I

? ?
? ?

= ? ?
? ?
? ?

M

  
( . )m ny nyI ×? ¡  

[ ( )] [ ( )] ( ) ( )sp T sp T Tx xc I y L x k Q I y L x k x k F QF x k= ? ? +%  

[ ]
m

Q diag Q Q=
64748

% L  

[ ]
m

R diag R R=
64748

% L  
 

Assim, o MPC de horizonte infinito para sistema integradores sem tempo morto 

pode ser resolvido através de um problema de otimização, formulado a seguir. 

 
 
 
Problema P3.1 

 

             A Função Custo do Problema P3.1 a ser minimizada é a Eq. (3.4) sem a parcela 
escalar c  dessa equação que é uma constante e não afeta a solução do problema : 

 

1 ,1min 2
T T

f
u

u H u c u
?

? ?? ? + ?? ?  

s. a.  
0

2,( ) ( ) 0
s i

m me k D D u+ ? ? =  (3.2) 

 

1,( ) 0
i i

mx k D u+ ? =  (3.3) 

 

( ) ,   0u k j j? + ? ?U  (3.5) 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 20 

 

onde 

max max

min max

0

( )
( ) ( ) 0;

( 1) ( ) ; 0,1, , 1
j

i

u u k j u
u k j u k j j m

u u k u k i u j m
=

? ?
? ??? ? ? + ? ?? ?? ?

= ? + ? + = ?? ?
? ?

? ? + ? + ? = ?? ?
? ?? ?

? L
U:

 
 

 Apresentaremos a seguir o teorema e a sua demonstração, no qual é garantida a  
convergência do sistema em malha fechada do Problema P3.1 enquanto o mesmo for 
viável : 
 

Teorema 1 : Se o Problema P3.1 for viável no instante k , a aplicação da solução ótima  
                     para esse problema  em um  processo sem perturbações  em malha fechada, 
                     levará as saídas do sistema aos seus valores de referência (‘setpoints’). 
 
Prova  :  
 Para essa demonstração, seguiremos o caminho usual para a prova da 
estabilidade de controladores de horizonte infinito, isto é, vamos provar que a função 
custo 1,kV  definida pela Eq.(3.1) é positiva e decrescente, ou seja, é uma função de 
Lyapunov. 
  
 Notamos inicialmente que a matriz hessiana 1H  é positiva definida ( 1 0H &gt; ). 
Desde que a hessiana seja positiva definida, o Problema P3.1 terá uma única solução 
ótima que satisfaz às restrições nos estados e nas entradas, desde que o problema seja 
viável. Para haver solução, as restrições dadas pelas equações (3.2) , (3.3) e (3.5) 
também tem que ser atendidas. 
 
 Assim, se o problema P3.1 for viável em k, existirá uma única solução ótima que 
obedecerá todas essas restrições. Seja essa solução representada por : 
 

* * * *[ ( ) ( 1) ... ( 1) ]T T T Tk ku u u k u k u k m? = ? = ? ? + ? + ?  
 
e o valor da função custo correspondente à solução ótima designado por *1,kV  
 

Supõe-se agora que a ação de controle * ( )u k?  seja implementada na planta e 
que seja feita a translação para o instante 1k + , onde o problema P3.1 é resolvido 
novamente. 

 
Seguindo a proposição sugerida por Rawlings e Muske (1993), consideremos a 

seguinte sequência de ações de controle : 
 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 21 

* * *
1 [ ( 1) ... ( 1) 0]

T T T
ku u k u k m+? = ? + ? + ?  que é viável e tem uma função custo 

associada '1, 1kV +  
 
Agora é fácil verificar que a essa função custo é dada por :  
 

' * * *
1, 1 1, ( ) ( ) ( ) ( )

T
k kV V e k Q e k u k R u k+ = ? ? ? ?  

 
Sendo as matrizes Q  positiva definida ( 0Q &gt; ) e R  positiva semi-definida 

( 0R ? ), teremos assim 
 

´ *
1, 1 1,k kV V+ &amp;lt;  . Portanto, como 

* '
1, 1 1, 1k kV V+ +?  , então 

* *
1, 1 1,k kV V+ ?  sendo a função custo 

decrescente. ? 
                                                                                          

 

Apesar da estabilidade do problema P3.1, na prática o mesmo torna-se inviável 
com facilidade, pois, ocorre conflito entre as restrições de igualdade dadas pelas 
equações (3.2) e (3.3) e a Eq.(3.5). Isso acontece por exemplo, quando o controlador é 
submetido a grandes variações nos ‘setpoints’, ou, quando o sistema sofre perturbações 
de amplitudes significativas. 

 

 Para aumentar a faixa de viabilidade do controlador, Rodrigues e Odloak (2003) 
apresentaram para sistemas estáveis, uma abordagem que insere uma variável de folga 
na função custo, a qual relaxa a solução da restrição de igualdade dada pela Eq. (3.2). 
 

 

 

3.2.2 O controlador IHMPC estendido de Rodrigues e Odloak (2003)  
 

A função custo com a variável de folga proposta é a seguinte : 
 

1

2, 1
0 0

[ ( ) ] [ ( ) ] ( ) ( )
m Ts T s T s s

k k k k k
j j

V e k j Q e k j u k j R u k j S
? ?

= =

= + ? ? + ? ? + ? + ? + + ? ?? ?  
 

(3.6) 

onde 

          sk?
ny? ¡  é o vetor das variáveis de folga que permite maior grau de               

liberdade para a solução do problema dentro da região viável U . 
          1S é uma matriz de pesos, positiva definida.  

 

A restrição dada antes pela Eq.(3.2) passa agora a ser representada por : 

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 22 

0
2 ,( ) ( ) 0

s s i
k m me k D D u+ ? + ? ? =  (3.7) 

Uma vez que sk?  não é limitada, a restrição dada pela Eq.(3.7) poderá ser 

atendida por qualquer sequência de ações de controle a qual também  atenderá a 

Eq.(3.5) ou qualquer condição de operação que apareça no termo ( )se k . Com essa nova 

variável de folga sk? , a função custo do  problema de controle escrita em notação 

matricial terá a seguinte forma : 

 

2, 2 ,22
TT s T

k k fs s
k k

u u
V u H C c

? ?? ? ? ?? ?= ? ? + +? ? ? ?? ?? ? ? ?? ? ? ?
 

 

(3.8) 

 

onde 

2
1

T T T
u u

T T

G QG F QF R G QI
H

I QG I QI S

? ?+ +
= ? ?

+? ?? ?

% %
% %  

 

(3.9) 

 

,2 ( ( )) ( ) [ ( )]
T

Tsp T T sp T
f x uC I y L x k QG x k F QF I y L x k QI? ?? ?= ? + + ? +? ?? ?

% %  

[ ( )] [ ( )] ( ) ( )sp T sp T Tx xc I y L x k Q I y L x k x k F QF x k= ? ? +%  

( ) ( ) ( ) ( )
Ts T d T i Tx k x k x k x k? ?= ? ?  

 

Assim, podemos definir o problema representado por : 

 

Problema P3.2 

 

2 ,2
,

min 2
s
k

TT s T
k fs su k k

u u
u H C

? ?

? ?? ? ? ?? ?? ? +? ? ? ?? ?? ? ? ?? ? ? ?
 

(3.10) 

s.a. 

1,( ) 0
i i

mx k D u+ ? =  (3.3) 

 

( ) ,   0u k j j? + ? ?U  (3.5) 
 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 23 

0
2 ,( ) ( ) 0

s s i
k m me k D D u+ ? + ? ? =  (3.7) 

 A convergência das saídas aos seus valores de referência com o sistema em 
malha fechada com o controlador definido no Problema P3.2 é assegurada pelo seguinte 
teorema : 
 
Teorema 2 : Para um sistema sem perturbações, com pólos estáveis e integradores,                                
                      se o Problema P3.2 for viável no instante k , então, será viável para os 
                      instantes consecutivos 1k + , 2k + , ..., e além disso, as saídas do  
                      sistema em malha fechada com a lei de controle formulada no problema 
                      P3.2 irão convergir assintoticamente aos valores de referência. 
 
Prova  :  

Seguiremos o caminho feito no Teorema 1, ou seja, provaremos a convergência 
do MPC mostrando que a função custo é positiva e decrescente no tempo. 

 
            Se o Problema P3.2 for viável no instante k , existe uma solução única                         
representada por 
 

* * * *[ ( ) ( 1) ... ( 1) ]T T Tk ku u u k u k u k m? = ? = ? ? + ? + ?    e 
*s s

k k? ?=  
 
             Supondo que a ação de controle * ( )u k?  seja implementada na planta e                         
que nos transladamos para o instante ‘ 1k + ’, onde o Problema P3.2 é                         
resolvido novamente. É fácil mostrar que no instante ‘ 1k + ’, para um sistema sem 
perturbações, uma solução viável do Problema P3.2 é dada por 
 

* *
1 [ ( 1) ... ( 1) 0]

T T T
ku u k u k m+? = ? + ? + ?    e  

*
1

s s
k k? ?+ =  

 
              Agora, é fácil mostrar que a função custo correspondente é  
 

* ** * *
2, 1 2, [ ( ) ] [ ( ) ] ( ) ( )

s T s T
k k k kV V e k Q e k u k R u k? ?+ = ? ? ? ? ? ?  

 
              Assim, a função custo será estritamente decrescente se um dos termos                         
com sinal negativo da equação acima for não-nulo. ? 
 
 
 Para o caso regulador, o controlador definido no Problema P3.2 será viável para 
uma região maior de estados iniciais e/ou perturbações do que o controlador definido no 
Problema P3.1. Da mesma forma, para o caso de rastreabilidade nos valores de 
referência, o Problema P3.2 será viável para mudanças maiores nos valores de 
‘setpoints’ do que o controlador definido no Problema P3.1. Entretanto, dependendo do 
tamanho das perturbações ou das variações dos valores de referência, ainda poderá 
haver conflito entre a restrição de igualdade dada pela Eq. (3.3) e a região viável 
definida na Eq. (3.5). 
 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 24 

 Para contornar essa limitação, usaremos uma extensão na função custo, 
adicionando uma segunda variável de folga para sistemas com pólos integradores, 
conforme apresentado em Cano e Odloak (2003). 

 

 

3.2.3 Nova extensão para o IHMPC 
 

Seguindo a mesma sequência da formulação do problema anterior, a função 

custo com as duas variáveis de folga apresentará a seguinte forma : 

 

3,
0

1

1 2
0

( ( ) ) ( ( ) )

( ) ( )

s i T s i
k k k k k

j

m T TT s s i i
k k k k

j

V e k j j t Q e k j j t

u k j R u k j S S

?

=

?

=

= + + ? + ? ? + + ? + ? ? +

? + ? + + ? ? + ? ?

?

?
 

 

 

(3.11) 

 

onde   2
ny nyS ×? ¡  é uma matriz positiva definida  

           ik?  é o segundo vetor de variáveis de folga 

 

A restrição dada antes pela Eq.(3.3) passa agora a ser representada por : 

 

1,( ) 0
i i i

k mx k D u+ ? + ? =  (3.12) 

 

No entanto, a solução da função custo pela Eq.(3.11) sujeita às restrições dadas 

pelas equações (3.5) , (3.7) e (3.12) não assegura que o valor da função seja decrescente. 

Isso é decorrente do fato que no instante ‘ 1k + ’, a solução mostrada abaixo não é viável 

porque não atende a Eq.(3.12) : 

 

 
* *

1 ( 1) ( 1) 0
TT T

ku u k u k m+ ? ?? = ? + ? + ?? ?L  

 
*

1
s s
k k? ?+ =   

 
*

1
i i
k k? ?+ =   

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 25 

 Assim, uma estratégia diferente é necessária para se obter um controlador 
estável que seja baseado na minimização da função custo definida pela Eq. (3.11). Para 
essa finalidade, propõe-se uma função custo secundária , positiva, dada por : 
 

 , 2
Ti i

l k k kV S? ?=   
 

Consideremos ainda que a seguinte restrição seja incluída na solução do 

problema do controlador preditivo : 

 

, , 1l k l kV V ?&amp;lt;%  
(3.13) 

 

onde  

 , 1 1 2 1
Ti i

l k k kV S? ?? ? ?= % %%  
            , 1l kV ?%  é calculado com 1ik? ?% , o qual é obtido por : 
 

1 1, 1( 1)
i i i
k m kx k D u? ?? = ? ? ? ?% %  (3.14) 

 

( 1) ( ) ( 1)i i ix k x k D u k? = ? ? ?%  (3.15) 

 

Para um sistema sem perturbações, tem-se : 

 

 ( 1) ( 1)
i ix k x k? = ?%       

1 1
i i
k k? ?? ?=%  

 

 Consequentemente, à medida que as entradas do sistema no ponto de equilíbrio 

estejam dentro da região viável U , a Eq.(3.13) será atendida para qualquer max 0u? ?  e 

,l kV  será decrescente.  

 

Em sistemas com perturbações, a determinação do estado no instante 1k ?  

usando a Eq.(3.15) tornará a Eq.(3.13) sempre viável.  

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 26 

Com isso, colocamos a função custo da Eq.(3.11) na forma matricial e podemos 

definir o seguinte problema :   

 

Problema P3.3 
 

3 ,3
, ,

min 2
s i
k k

T TT s i s T s
k k k f k

u
i i
k k

u u

u H C
? ? ?

? ?? ? ? ?
? ? ? ?? ?? ? ? ? + ?? ? ? ?? ?? ? ? ? ? ?? ?? ? ? ?

 

s.a. 

 

( ) ,   0u k j j? + ? ?U  (3.5) 
 

0
2 ,( ) ( ) 0

s s i
k m me k D D u+ ? + ? ? =  (3.7) 

 

1,( ) 0
i i i

k mx k D u+ ? + ? =  (3.12) 

 

, , 1l k l kV V ?&amp;lt;%  (3.13) 

 

onde 

 

3 1

2

T T T T
u u

T T T

T T T

G QG F QF R G QI G QT

H I QG I QI S I QT

T QG T QI T QT S

? ?+ +
? ?

= +? ?
? ?

+? ?? ?

% % %
% % %
% % %

    
 

 

2
ny

ny

ny

t I
t I

T

m t I

?? ?
? ??? ?=
? ?
? ?

?? ?? ?

M
 

 

,3 ( ( )) ( ) [ ( )] [ ( )]
T

Tsp T T sp T sp T
f x uC I y L x k QG x k F QF I y L x k QI I y L x k QT? ?? ?= ? + + ? + ? +? ?? ?

% % %
 

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 27 

A convergência do problema P3.3 é assegurada pelo seguinte teorema :  

 

Teorema 3:  Para sistemas com pólos estáveis e integradores, cujas entradas referentes  

                     ao estado estacionário pertençam à região viável U ,  a sequência das ações  
                     de controle produzidas pela solução sucessiva do problema P3.3 levará as  

                     saídas do sistema assintoticamente aos seus valores de referência. 

 

Prova  : 

 Consideremos os casos regulador e o de rastreabilidade das saídas, ambos sem 

perturbações. Nestes casos, se as entradas do sistema correspondentes ao estado 

estacionário pertencem à região viável U , o problema P3.3 será viável no instante k  e 
permanecerá viável nos instantes de amostragem seguintes.  

 

Assim, a função ,l kV  convergirá a zero. Com essa função convergida, a restrição 

dada pela Eq.(3.3) torna-se viável e se manterá nos instantes seguintes. Com isso, o 

problem P3.3 se reduz ao problema P3.2 e a convergência das saídas do sistema é 

assegurada pelo teorema 2.? 

 

 

A implementação prática dos controladores definidos pelos problemas P3.2 e 

P3.3 é feita seguindo os seguintes passos : 

 

 

- no instante k  verifica-se a existência de solução viável definida entre a Eq.     

(3.3) e a Eq.(3.5) 

 

 

- se existir, resolve-se o problema P3.2 e implementa-se a ação de controle 

resultante referente ao instante k . Caso contrário, resolve-se o problema 

P3.3 e implementa-se a ação de controle correspondente. 

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 28 

 

3.2.4 Controlador IHMPC em duas camadas  
 

De forma alternativa, em cada instante de amostragem, o mesmo problema pode 

ser resolvido em duas camadas, resolvendo-se dois problemas de maneira sequencial, 

que definiremos como problema P3.4 mostrado a seguir. 

 
 
Problema P3.4 
 

Problema P3.4a 

,
4 , 2 , ,

,
min
i

a kk

Ti i T
a k k k a k a k

u
V S u R u

?
? ?

?
= + ? ?

 
s.a. 

( ) ,   0au k j j? + ? ?U  (3.5) 
 

1 ,( ) 0
i i i

k m a kx k D u+ ? + ? =  (3.12) 

 

onde  

        ,
( ) ( 1) ( 1)

TT T T
a k a a au u k u k u k m? ?? = ? ? + ? + ?? ?L   

        R  é uma matriz positiva definida 

 

 

Seja então a solução ótima do problema P3.4a designada por :  ( )* *,,ik a ku? ?   
 

A ação incremental total correspondente é dada por :  

 
1

* *

0

( 1) ( 1) ( )
m

a
j

u k m u k u k j
?

=

+ ? ? ? = ? +?
 

 

(3.14) 

 

Essa entrada incremental ótima é repassada ao segundo problema mostrado a 

seguir, o qual é resolvido no mesmo instante de amostragem: 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 29 

Problema P3.4b: 

,

, ,
4 , , 2 ,2

,
min 2

s
b k k

T b k b kT s T
b k b k k fs su k k

u u
V u H C c

? ?

? ?? ? ? ?? ?= ? ? + +? ? ? ?? ?? ? ? ?? ? ? ?  
s.a. 

( ) ,   0bu k j j? + ? ?U  (3.5) 
 

,

0
2,( ) ( ) 0b

s s i
k m m ke k D D u+ ? + ? ? =  (3.7) 

 
1

*

0

( 1) ( 1) ( )
m

b
j

u k m u k u k j
?

=

+ ? ? ? = ? +?  
(3.14) 

onde  

       ,
( ) ( 1) ( 1)

TT T T
b k b b bu u k u k u k m? ?? = ? ? + ? + ?? ?L  

 

Para a lei de controle obtida pela solução sequencial dos problemas P3.4a e 

P3.4b a convergência das saídas do sistema aos seus valores de referência é garantida 

pelo seguinte teorema : 

  

Teorema 4: Para um sistema com pólos estáveis e integradores, se no instante de  

                    amostragem k  o problema P3.4a for viável, então o problema P3.4b   

                    também será viável. Acrescentado a isso, a lei de controle resultante da  

                    solução sucessiva dos dois problemas levará as saídas do sistema aos  

                    respectivos valores de referência. 

 

Prova  :  

Consideremos o sistema sem perturbação e que no instante k  o problema P3.4a 

seja viável. Designamos o valor ótimo da função custo do problema P3.4a como *4 ,a kV .  

O incremento total das entradas é repassado ao problema P3.4b como restrição 

de igualdade dado pela Eq. (3.14). No problema P3.4b o decréscimo da função custo 

não pode ser garantido a priori. Entretanto, o uso da variável de folga sk?  garante que 

existe solução viável, que satisfaz as restrições das equações (3.5), (3.7) e (3.14).  



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 30 

Denominamos a solução ótima do Problem P3.4b por ( )* *, , sb k ku? ? .A primeira 
ação de controle * ( )bu k?  é implementada na planta e nos transladamos ao instante 

seguinte ‘ 1k + ’.  

 

Nesse instante, a seguinte sequência é solução viável do problema P3.4a : 

 

* *
, 1 ( 1) ( 1) 0

TT T
a k b bu u k u k m+ ? ?? = ? + ? + ?? ?L   ,   

*
1

i i
k k+? = ?  

 

Consideremos agora que R  seja desprezível em relação a S2. O valor da função 

custo do problema P3.4a é ainda *,a kV . Consequentemente, a solução ótima do problema 

P3.4a no instante ‘ 1k + ’ será * *4 , 1 4 ,a k a kV V+ ? . Uma vez que selecionamos 2R S&lt;&amp;lt;, a 

função custo do problema P3.4a irá convergir a zero, que corresponde a ( ) 0i ikx k = ? = .  

 

Como decorrência da convergência do problema P3.4a, temos que o problema 

P3.4b fica equivalente ao problema P3.2, que é agora viável. Após convergência, a 

solução do problema P3.4a se reduz a solução trivial 0ik? = . Sendo assim, a 

convergência das saídas do sistema aos valores de referência através da aplicação 

sucessiva das sequências de ações produzidas pela solução dos problemas P3.4a e P3.4b 

é assegurada pelo teorema 2.? 

 

 

3.3 Exemplos 
 

Nesta seção, veremos algumas aplicações do controlador IHMPC proposto para 

sistemas integradores sem tempo morto. Tomemos como exemplo o sistema 

apresentado no capítulo anterior (seção 2.4) dado por : 

1,1 1,2

2,1 2,2

0,19 1, 7
( ) ( ) 19, 5 1

( ) ( ) / ( )
( ) ( ) 0, 763 0, 235

31, 8 1

G s G s s s
G s y s u s

G s G s
s s

? ?? ?
? ?? ? +
? ?= = =? ? ?? ?? ?
? ?+? ?

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 31 

Observa-se que as saídas 1y  e 2y  são integradoras em relação a uma das 

variáveis manipuladas e estáveis em relação à outra.  

 

O sistema será simulado usando-se dois controladores. O primeiro será 

constituído pela solução do problema P3.3 e o segundo, de duas camadas, pela solução 

sequencial dos problemas P3.4a e P3.4b. 

 

Os parâmetros de sintonia para ambos controladores estão representados pela 

tabela a seguir : 

 

  m             Q              R          1S         2S       maxu?  

   3 2 2[10 ,10 ]diag ? ?  2 2[10 ,10 ]diag ? ?  [10,10]diag  3 3[10 ,10 ]diag    [0, 2 , 0, 2]  

 

         Tabela 3.1 – Parâmetros de sintonia dos controladores I e II 

 

 

Para efeito de comparação entre os controladores I e II, o sistema será simulado 

para o caso regulador e para o caso de rastreabilidade dos ‘setpoints’. Para o primeiro 

caso, consideremos por exemplo, um estado inicial dado por [0 0]s Tx = ; 

[0 0]d Tx = ; [0, 4 0, 4]i Tx = ?  com ‘setpoints’ constantes [0 0]sp Ty = . Para o 

segundo, consideramos que no instante 100k = sejam alterados os valores de referência 

para [2 2]sp Ty = . 

 

A figura 3.1 a seguir apresenta a resposta do sistema para os controladores I e II. 

Observa-se uma equivalência entre os controladores, uma vez que no caso regulador 

(instantes de 0k = até 100k = ) o controlador II apresenta uma resposta das saídas 

relativamente melhor do que o controlador I, mas para o caso de rastreabilidade nos 

‘setpoints’ ( instantes 100k &gt; ), os controladores praticamente se equivalem. 

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 32 

 

 
Figura 3.1-  Resposta do sistema com os controladores I e II 

 



Capítulo 3 – Controlador IHMPC para sistemas integradores sem tempo morto 33 

A figura 3.2 a seguir apresenta o valor da função custo 3,kV do problema P3.3 

obtida pelo controlador I, a qual é comparada à função 4 ,b kV do problema P3.4b do 

controlador II.  

 

Observa-se que a função custo 4 ,b kV do controlador II não decresce no início do 

caso regulador. Isso ocorre enquanto 4 , 0a kV ?  no problema P3.4a o que significa que o 

problema P2 não seria viável, não havendo assim, garantias no decréscimo da função 

custo.  

 

Na medida em que 4 ,a kV  converge à zero, os problemas P3.2 e P3.4b tornam-se 

equivalentes e a função 4 ,b kV  é decrescente. 

 

 
Figura 3.2- Funções Custo dos Problemas P3.3 (controlador I) e P3.4b (controlador II) 
 
 
 
 
 



 34 

Capítulo 4 

IHMPC estendido para sistemas integradores com tempo morto 

 

4.1 Introdução 
 

Neste capítulo, faremos a extensão do controlador nominal preditivo com 

horizonte de predição infinito apresentado no capítulo anterior, considerando agora a 

existência de tempo morto. Denominaremos esse controlador de IHMPC-E 

(Controlador Preditivo baseado em Modelo; de Horizonte Infinito, Estendido ) . 

Usaremos a formulação do modelo baseado em variáveis de estado na forma 

incremental, contemplando agora características integradoras, estáveis ou ambas, com a 

existência ou não de tempos mortos.  

 

 
4.2 Modelo em variáveis de estado para sistemas integradores com tempo morto 
 

Gouvêa e Odloak (1997) desenvolveram para o caso de sistemas estáveis com 

tempo morto uma representação de modelo em variáveis de estado na forma incremental 

denominado ROSSMPC. Utilizaremos essa mesma formulação, agora estendida para 

sistemas mistos (estáveis/integradores) com tempo morto e a aplicaremos no 

controlador IHMPC-E. 

 
 
4.2.1 O ROSSMPC de Gouvêa e Odloak (1997) 
 

Em sistemas estáveis com existência de tempo morto , o ROSSMPC considera 

que tem-se um horizonte de predição adequado, de forma que ele englobe todos os 

tempos mortos do processo, ou seja :     

 

{ },int max( / )i jnp m t?? + ?                                                                                                    (4.1) 
 
onde, 
 
          m  é o horizonte de tempo das ações de controle 
         ,i j?  é o tempo morto entre uma saida i  e uma entrada j   
         t?  é o intervalo de amostragem do controlador 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 35 

A matriz de tempos mortos para o caso multivariável é dada por : 
 

1,1 1,
,

,1 ,

nu
ny nu

ny ny nu

? ?
?

? ?

? ?
? ?

= ?? ?
? ?? ?

L
M O M

L
R                                                                                   (4.2) 

 
 

O modelo ROSSMPC na sua forma original desenvolvido para pólos estáveis é 
dado por : 
 
[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
                                                                                             (2.2) 

 
Os vetores e matrizes do ROSSMPC possuem as seguintes dimensões :  
, 1nex ? £ ; ,ne neA ? £ ; ,ne nuB ? £ ; ,ny neC ? ¡ , sendo ne  o número de estados dado por 
.( 1 . )ne ny np nu na= + + . 

 

[ ] 1 2
TT TT T T s d

k k k npx y y y x x+ + +? ?= …? ?
                                                           (4.3) 

 
ny  é o número de variáveis controladas, nu  é o número de variáveis manipuladas  e 
na  é a ordem máxima das funções de transferência do sistema 
 
[ ]y ny? R  
 

( )

0 0 0 0 0
0 0 0 0 0

0 0 0 0 0
0 0 0 0 [ 1 ]
0 0 0 0 0
0 0 0 0 0

ny

ny

ny

ny

ny

I
I

A I
I np t
I

F

? ?
? ?
? ?
? ?
? ?

= ? ?
? ?? + ?
? ?
? ?
? ?? ?

L
L

M M M O M M M
L
L
L
L

                                                (4.4) 

 

 

2

3

1
0

np

np

d

S
S

B S
S
D

D FN

+

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?

M
=                                                                                                          (4.5) 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 36 

0 ... 0nyC I? ?= ? ?                                                                                               (4.6) 

 
A resposta ao degrau para cada instante no sistema multivariável é obtida pela 

seguinte equação :  
 
 

( )

1,1, 1,2, 1, ,

2,1, 2,1, 2, , 0 ,

,1, ,2, , ,

i i nu i

i i nu i d ny nu
i

ny i ny i ny nu i

s s s
s s s

S D t D N

s s s

? ?
? ?
? ?= = + ? ?
? ?
? ?
? ?? ?

 

L
L

¡M M O M
L

                              (4.7) 

 
 

 
 
4.2.2 Extensão do ROSSMPC para sistemas integradores com tempo morto 
 

Para essa extensão do modelo ROSSMPC, podemos incluir nessa formulação a 
representação vista no capítulo 2 para sistemas integradores, chegando-se na forma  
representada abaixo : 

 
[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
                                                                                             (2.2) 

 

onde 

[ ] 1 2
TT T TT T T s d i

k k k npx y y y x x x+ + +? ?= …? ?
                                               (4.8) 

 

( ) ( )*

0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 [ 1 ] [ 1 ]
0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

ny

ny

ny

ny

ny ny

ny

I
I

I
A

I np t I np t
I I t

F
I

? ?
? ?
? ?
? ?
? ?
? ?= ? ?? + ? + ?
? ?

?? ?
? ?
? ?
? ?? ?

L
L

M M M O M M M M
L
L
L
L
L

                                (4.9) 

 

0
2 3 1 [ ] [ ] [ ]...

T
i d TT T T T T i

np D F NB S S S D t D D+? ?? ?= + ?                         (4.10)   

 

0 ... 0nyC I? ?= ? ?                                                                                               (4.11) 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 37 

Na matriz de estado aparece a função ( )t?  que tem a forma : 

 

? =

?

?

?
?
?
?

f f f f f f
f f f f

na na n na

na

u nu1 11 11 2 1 1 1 2 1 1 2 1

2 1 1 2 1 2 2 1 2 2 1

1 1 1 2 1

2 1

0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0

, , , , , , , , , , , ,

, , , , , , , ,

, , ,

,

L L L L L
L L L L L

M M L M M L M L M M M L M M L
L L L L L

 

 

  

... ... ... ... ... ... ...

... ... ... ... ... ... ...

... ... ... ... ... ... ...

... ... ... ... ... ...

, , , , , ,

, , , , , , , , , ,

, ,

, ,

0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0

0 0 0 0

2 2 2 1 2

11 12 1 2 1 2

2 2 2

1

f f f

f f f f f

na n n na

n n n na n n na

u u nu

y y y ny y y ny

M M M M M M M M M M M
2 1

... ..., , , , ,f fn n n n nay u y u ny nu

?

?

?
?
?
?
?

                  
                                                                                                                     (4.12) 
onde  
 

, , ,( )
, , ( )

i j g i jr t
i j gf t e

??
=  
 

 

 Consideremos como hipótese para o modelo que para cada saída exista o mesmo 

tempo morto em todas as entradas que sejam integradas. Essa consideração é 

representada na função * ( )I t  no instante de tempo ( 1)np t+ ?  da seguinte forma : 

 

1

* 2

( 1) 0 0

0 ( 1) 0
[( 1) ]

0 0 ( 1)

u

u
ny ny

u
ny

np t

np t
I np t

np t

×

? ?+ ? ? ?
? ?
? ?+ ? ? ?

+ ? = ?? ?
? ?
? ?

+ ? ? ?? ?? ?

L
L ¡

M M O M
L

 

                                                                                                                     (4.13) 

onde 
 

u
i?  é o tempo morto associado ao pólo integrador da saída iy  

 

 

 A resposta ao degrau para o sistema multivariável é dada por : 

 
0 *( ) ( ) ( )d iS t D t D N I t D= + ? +                                                                                (2.33) 

 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 38 

4.3 Desenvolvimento do controlador IHMPC-E de modelo nominal 
 

O problema de otimização que definirá a lei de controle será o de minimizar uma 

função que pondere os erros das predições das saídas e os movimentos nas variáveis 

manipuladas. Propõe-se então, a função custo dada pela Eq.(3.1) : 

 

[ ] [ ]
1

1,
0 0

( ) ( ) ( ) ( )
m

T T
k

j j

V e k j Q e k j u k j R u k j
? ?

= =

= + + + ? + ? +? ?                              (3.1) 
 
onde 
 

( ) spk je k j y y++ = ?  é o erro entre a predição das saídas e seus valores de referência 

                                 com ( )e k j+ ny? ¡  
Q e R são matrizes positivas definidas que ponderam relativamente as variáveis  
           controladas e manipuladas, respectivamente 
 

 
Desdobrando a primeira parcela de 1,kV  , temos : 

 
1

1,
0 1 0

( ) ( ) ( ) ( ) ( ) ( )
np m

T T T
k

j j j

V e k j Q e k j e k np j Q e k np j u k j R u k j
? ?

= = =

= + + + + + + + + ? + ? +? ? ?
 

1
(1) (2)

1,
0

( ) ( )
m

T
k k k

j

V V V u k j R u k j
?

=

= + + ? + ? +?  
 
 
Agruparemos adequadamente os termos  (1)kV  e 

(2)
kV  na forma matricial. 

 
 

Para isso, calculamos inicialmente de forma recursiva as predições de saídas 

entre o instante atual até o horizonte de predição finito np , chega-se na seguinte 

equação (ver dedução no apêndice A1 ) : 

                             

[ ]

1
2

2

1 2

1
1

1

1 2

0 0
0 ( )

( 1)
. .

.
. .

.
( 1)

k

k

m m
k

m m
np

k np
np

k np np np np mk

CB
y CA

CAB CB u k
y CA

u k
x CA B CA B CB

CA B CA B CAB
y CA

u k m
y CA

CA B CA B CA B

+

+

? ?

?
?

+ ?

+ ? ? ?

? ?
? ? ? ? ? ? ?? ? ? ? ? ?
? ? ? ? ? ? ? +
? ? ? ? ? ?

= +? ? ? ? ? ?
? ? ? ? ? ?
? ? ? ? ? ?
? ? ? + ?? ? ? ?

? ?? ? ? ?? ? ? ?? ?

L
L

M M O M
L
L

M M O M
L

? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?

    



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 39 

       a qual pode ser representada em forma compacta matricial :    
 

[ ] [ ]
__

kk k
y C x C u

==

= + ?                                                                                               (4.14) 
 
onde   
 
__

C  . , . 2 . .np ny ny np ny ny nu na+ +? £  
 

C
==

. , .np ny m nu? ¡  
 
 
 
 Substituindo-se a Eq.(4.14) na expressão de (1)kV  abaixo temos : 
 
 

__ __~
(1)

1 1( / ) ( / )
T

sp sp
k k kV C x k k C u y Q C x k k C u y

== ==? ? ? ?
= + ? ? + ? ?? ? ? ?? ? ? ?

                               (4.15) 

 
onde 
 

[ ]
~

( ... )Q diag Q Q Q= . , .np ny np ny? ¡  
 

1 [ ... ]
T T Tsp sp sp sp Ty y y y= .np ny? ¡  

 

 
 Colocaremos agora o termo (2)kV  dado abaixo na forma matricial : 
 

(2)

1

( ) ( )Tk
j

V e k np j Q e k np j
?

=

= + + + +?                                                               
 
onde    
 

/( )
sp

k np j ke k np j y y+ ++ + = ?  
 
 
 
Fazendo uso da Eq.(2.2) e escrevendo recursivamente as predições de saídas do 

elemento k npy +  do vetor de estados no instante 1k m+ + e seguintes, temos : 
 

1
(( 1) ) ( 1)s d ik np nyk m k m k m k my x np t x np t I x+ + + + + +? ? ? ? ? ?? ? = + ? + ? + + ?? ? ? ? ? ? ? ?  

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 40 

2 1 1 1
(( 1) ) ( 1)s d ik np nyk m k m k m k my x np t x np t I x+ + + + + + + + +? ? ? ? ? ?? ? = + ? + ? + + ?? ? ? ? ? ? ? ?  

{ }. (( 1) ) ( 1)s i d iny ny nyk m k m k m k mI x I t x np t F x np t I x+ + + +? ? ? ? ? ? ? ?= + ? + ? + ? + + ?? ? ? ? ? ? ? ?
            { }(( 1) ) . ( 1)s d iny nyk m k m k mx np t F x I t np t I x+ + +? ? ? ? ? ?= + ? + ? + ? + + ?? ? ? ? ? ?  
 
  M  
 

{ }(( 1) ) ( 1)s j d ik np ny nyk m j k m k m k my x np t F x I j t np t I x+ + + + + +? ? ? ? ? ?? ? = + ? + ? + ? + + ?? ? ? ? ? ? ? ?  
 
 

Observa-se que para as predições de saídas serem limitadas no infinito e por 
consequência o próprio termo (2)kV , temos que impor a anulação do efeito dos estados 

s

k m
x

+
? ?? ? , 

i

k m
x

+
? ?? ? no instante k m+ .  

 
Isso pode ser feito através da matriz modificada *A , originada da matriz A  da 

Eq. (2.2) anulando-se os termos correspondentes aos pólos integradores : 
 
 

                      
( )( ) ( )( )

*
*

0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 1 1

0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

ny

ny

ny

ny

I
I

I
A

I np t I np t

F

? ?
? ?
? ?
? ?
? ?
? ?= ? ?? + ? + ?
? ?
? ?
? ?
? ?
? ?? ?

0 0

0

L
L

M M M O M M M M
L
L
L
L
L

          (4.16) 

 
 
assim, em qualquer instante j  as predições das saídas são obtidas por :       
 
 

[( 1) ] [ ]j d Tk np k mk m jy np t F x+ ++ +? ? = ? + ?? ?  

 
 
nessas condições , os estados nos instantes posteriores a k np+  serão : 
 
 

[ ] [ ]( )* np j mk np j k mx A x
+ ?

+ + +
=                                                                                      (4.17) 

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 41 

com o estado [ ]
k np j

x
+ +

 substituído na predição das saídas temos :  

 

[ ] [ ] [ ]( )* np j mk np j k np j k my C x CA x
+ ?

+ + + + +
= =                                                          (4.18) 

 
Substituiremos agora a Eq.(4.18) na expressão de ( 2 )kV  e a colocaremos na forma 

matricial através do seguinte vetor de ‘setpoints’ : 
 

2 ... 0 0
TT T T Tsp sp sp sp sp T Ty y y y y? ?=

? ?
. 2 . .np ny ny ny nu na+ +? R  

 
 
teremos assim , 
 

(2)

1

( / ) ( / )
Tsp sp

k
j

V y k np j k y Q y k np j k y
?

=

? ? ? ?= + + ? + + ?? ? ? ??  
 

(2)
2 2

1

[ ] [ ]
Tsp sp

k k np j k np j
j

V C x C y Q C x C y
?

+ + + +
=

? ? ? ?= ? ?? ? ? ??  

                        [ ] [ ]
1

T T
k m j k m j

j

e C QC e
?

+ + + +
=

= ?                                                          (4.19) 
 
usando a eq.(4.16) tem-se : 
 

 [ ] ( )* [ ]np j m k mk np je A e
+ ?

++ +
=  

 

[ ]{ } [ ]{ }( ) ( )(2) * *
1

Tnp m j np m jT
k k m k m

j

V A e C Q C A e
?

? + ? +

+ +
=

= ?  

    [ ] [ ]( ) ( )* * * *
1

T Tnp m j j np mT T
k m k m

j

e A A C Q CA A e
?

? ?

+ +
=

? ?
= ? ?

? ?
?  

 

definindo a matriz 
__

* *

1

Tj jT

j

Q A C Q CA
?

=

= ?  e pré-multiplicando e pós-multiplicando 
__

Q  

por *
T

A e *A , respectivamente, e subtraindo da própria 
__

Q , obtemos então a equação de 
Lyapunov : 
 

                           
__ __

* * * *T T TA Q A Q A C QCA? = ?  
 
finalmente, chega-se na expressão finita do termo (2)kV  : 
 

[ ] [ ]
__

( ) ( )(2) * *
Tnp m np mT

k k m k m
V e A Q A e

? ?

+ +
=                                                                  (4.20) 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 42 

A Eq.(4.20) pressupõe a validade de  duas restrições de igualdade atendidas : 
 
  
                          ( ) 0s spx k m y+ ? =                                                                          (4.21) 
 
                          ( ) 0ix k m+ =                                                                         (4.22) 
 
 

Determinaremos agora ( )sx k m+  em função de ( )sx k  para uso na Eq. (4.21). 
Entre os instantes k até k m+  podemos escrever de forma recursiva : 
 
 

( )0( 1) ( ) ( ) ( )s s i ix k x k t x k D t D u k+ = + ? + + ? ?  
 

( )0( 2) ( 1) ( 1) ( 1)s s i ix k x k t x k D t D u k+ = + + ? + + + ? ? +  
 
 
mas ( 1) ( ) ( )i i ix k x k D u k+ = + ?  que substituído acima resulta 
                            
 

( ) ( )0 0( 2) ( ) 2 ( ) 2 ( ) ( 1)s s i i ix k x k t x k D t D u k D t D u k+ = + ? + + ? ? + + ? ? +  
 
      M  
 

0 0 0

( )
( 1)

( ) ( ) ( ) ( 1) ...

( 1)

s s i i i i

u k
u k

x k m x k m t x k D m t D D m t D D t D

u k m

?? ?
? ?? +? ?? ?+ = + ? + + ? + ? ? + ?? ? ? ?
? ?
? + ?? ?

M

 
substituindo na Eq.(4.21) tem-se : 
 
 

( ) ( ) 0s sp i kx k y m t x k D u? + ? + ? =%                                                                         (4.23) 
 
onde 
 
 

0 0 0[ ( 1) ... ]i i iD D m t D D m t D D t D= + ? + ? ? + ?%  
 

( )
( 1)

( 1)

k

u k
u k

u

u k m

?? ?
? ?? +? ?? =
? ?
? ?
? + ?? ?

M
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 43 

Determinaremos agora ( )ix k m+  em função de ( )ix k  para uso na restrição de 
igualdade dada pela Eq. (4.22). 
 

Entre os instantes k até k m+  podemos escrever de forma recursiva , 
 
           ( 1) ( ) ( )i i ix k x k D u k+ = + ?  
 
           ( 2) ( 1) ( 1)i i ix k x k D u k+ = + + ? +  
                          ( ) ( ) ( 1)i i ix k D u k D u k= + ? + ? +  
                   
                  M  

           

( )
( 1)

( ) ( ) ...

( 1)

i i i i i

u k
u k

x k m x k D D D

u k m

?? ?
? ?? +? ?? ?+ = + ? ? ? ?
? ?
? + ?? ?

M
 

 
 

1,( ) 0
i i

m kx k D u+ ? =                                                                                                (4.24) 
                                                          
  onde 
 

1, ...
i i i i

mD D D D? ?= ? ?  

 
 

Obtemos agora o estado completo [ ]k mx +  em função de [ ]kx  para uso em 
(2)

kV . 
 

Entre os instantes k até k m+  podemos escrever , 
 
             [ ] [ ]1 ( )k kx A x B u k+ = + ?  
 
             [ ] [ ]2 1 ( 1)k kx A x B u k+ += + ? +  
                       [ ]2 ( ) ( 1)kA x AB u k B u k= + ? + ? +  
 
             [ ] [ ]3 2 ( 2)k kx A x B u k+ += + ? +  
                        [ ]3 2 ( ) ( 1) ( 2)kA x A B u k AB u k B u k= + ? + ? + + ? +  
 
                M  
 

              
[ ] [ ] 1 2 3( ) ( 1) ( 2)

... ( 1)

m m m m
k m k

x A x A B u k A B u k A B u k

B u k m

? ? ?
+

= + ? + ? + + ? + +

+ ? + ?
 

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 44 

Na forma matricial temos :                  
 

[ ] [ ] 1 2
( )

( 1)
...

( 1)

m m m
k m k

u k
u k

x A x A B A B B

u k m

? ?
+

?? ?
? ?? +? ?? ?= + ? ? ? ?
? ?
? + ?? ?

M
 

 
ou ainda : 
 

[ ] [ ]
~

m
kk m k

x A x AB u
+

= + ?        
 

[ ] [ ]
~

m
kk m k

e A e AB u
+

= + ?                                                                                          (4.25) 
 
 

Substituindo a Eq. (4.25) na Eq. (4.20) , temos : 
 
 

[ ]{ } [ ]{ }~ ~(2) *
T

m m
k k kk k

V A e AB u Q A e AB u= + ? + ?                                                       (4.26) 

 

onde   
__( ) ( )* * *

Tnp m np m
Q A Q A

? ?
=  

 
 
Substituindo (1)kV  e 

(2)
kV  na Função Custo do Controlador, chega-se na 

expressão matricial que determina o valor escalar de kV  :  
 
 

__ __~

1 1[ ] [ ]
T

sp sp
k k k k kV C x C u y Q C x C u y

== ==? ? ? ?
= + ? ? + ? ?? ? ? ?? ? ? ?

  

           [ ]{ } [ ]{ }~ ~*
T T

m m T
k k k kk k

A e AB u Q A e AB u u R u+ + ? + ? + ? ?%                      (4.27) 

  
 
 A expressão acima pode ser colocada convenientemente na forma quadrática 
mostrada abaixo (ver dedução no apendice A2), a qual é minimizada no seu valor em 
função da sequência ótima de controle *ku?  : 
 
 
     2 TTk k k f kV u H u C u c= ? ? + ? +                                                                        (4.28) 
 
 
 Assim, o MPC de horizonte infinito para sistemas integradores com tempo 
morto, pode ser resolvido pelo problema de otimização, formulado a seguir. 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 45 

Problema P4.1 
 

1 ,1 1min 2
T T
k k f k

u
u H u C u c

?
? ?? ? + ? +? ?  

 
               s. a.       ( ) ( ) 0s sp i kx k y m t x k D u? + ? + ? =%             (4.23)

                                                 1( ) 0
i i

m kx k D u+ ? =             (4.24)

                               ( ) ,   0u k j j? + ? ?U                                            (4.29) 

                        

max max

min max

0

( )
( ) ( ) 0;

( 1) ( ) ; 0,1, , 1
j

i

u u k j u
u k j u k j j m

u u k u k i u j m
=

? ?
? ??? ? ? + ? ?? ?? ?

= ? + ? + = ?? ?
? ?

? ? + ? + ? = ?? ?
? ?? ?

? L
U:  

sendo , 

          
~ ~

*
1

T T

H C Q C AB Q AB R
== ==

= + +% %  
          [ ] [ ]

~
*

,1 1

TT TT sp m
f k k

C x C Q C y Q C e A Q AB
== ==

= ? +% %  
          [ ] [ ] [ ] [ ] [ ]*1 1 11 2

T T TT TT sp sp sp m m
k k k k k

c x C QC x y QC x y Qy e A Q A e= ? + +% % %  
 
 
 O teorema a seguir garante a convergência do sistema em malha fechada do 
Problema 4.1 enquanto o mesmo for viável. 
 
 
Teorema 4.1 : Se o Problema P4.1 for viável no instante k , a aplicação da solução  
                        ótima para esse problema em um processo sem perturbações em                                 
                        malha fechada, levará as saídas do sistema aos seus valores de   
                        referência ( ‘setpoints’ ). 
 
Prova : A prova desse teorema é similar e segue os mesmos passos apresentados no   
              teorema 1 do capítulo anterior. 
              
 O teorema acima garante a convergência do sistema em malha fechada, 
enquanto o Problema P4.1 for viável. Entretanto, na prática, esse problema torna-se 
inviável com facilidade, pois, ocorre conflito entre as restrições de igualdade dadas 
pelas Eq. (4.23) e Eq. (4.24) com a Eq. (4.29). 
  
 Isso acontece, a exemplo do controlador do problema P3.1 visto no capítulo 
anterior, quando o controlador é submetido à grandes variações nos ‘setpoints’, ou, 
quando o sistema recebe perturbações de grandes amplitudes. 
 
 Para aumentar a faixa de viabilidade do controlador, faremos uso da variável de 
folga na função custo, a qual relaxa a solução da restrição de igualdade dada pela Eq. 
(4.23). 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 46 

Seguindo a mesma sequência da formulação do problema de controle sem tempo 

morto apresentado no capítulo anterior, definimos a seguinte função custo : 

 
1

2,
0 0

1

( ) ( ) ( ) ( )
mTs s T

k k k
j j

Ts s
k k

V e k j Q e k j u k j R u k j

S

? ?

? ?

? ?

= =

? ? ? ?= + ? + ? + ? + ? +? ? ? ?

+

? ?
        (4.30) 

 
 

Os termos (1)kV  e 
(2)

kV  neste caso serão dados por : 

 
 

(1)
1 1[ ( / ) ] [ ( / ) ]
sp s T sp s

k k k k kV Cx k k C u y I Q Cx k k C u y I? ?
== ==

= + ? ? ? + ? ? ?%  
 

(2)

1

[ ( ) ] [ ( ) ]s T sk k k
j

V e k m j Q e k m j? ?
?

=

= + + ? + + ??  
 
 

Para que o termo (2)kV  seja limitado, impomos : 
 
 

( ) 0s sp skx k m y ?+ ? ? =                                                                                          (4.31) 
 

( ) 0ix k m+ =                                                                                         (4.22) 
 
 
 

Por analogia à Eq.(4.23), a Eq.(4.31) resulta em 
 
 
 

( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                                                 (4.32) 
 
 
 

Por analogia à Eq.(4.27) temos : 
 
 

[ ] [ ]2, 1 1
T

sp s sp s
k k k k kk k

V C x C u y I Q C x C u y I? ?
== ==? ? ? ?= + ? ? ? + ? ? ?? ? ? ?? ? ? ?

%  

[ ]{ } [ ]{ }~ ~* 1
T T

Tm m T s s
k k k k k kk k

A e AB u Q A e AB u u R u S? ?+ + ? + ? + ? ? +%    (4.33) 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 47 

Problema P4.2  
 

Analogamente ao caso em que não temos tempo morto, o controlador passa a ser 

definido pelo seguinte problema : 

 

2 ,2 2
,

min 2
s

T k kT s T
k k fs su

k k

u u
u H C c

?
?

? ??

? ?? ? ? ?? ?? ?? ?? + +? ? ? ?? ?? ?? ? ? ? ? ?? ?? ? ? ?? ?
 

 
                s. a.  
 
                         ( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                       (4.32) 
 
   1( ) 0

i i
m kx k D u+ ? =                                                          (4.24) 

 
   ( ) ,   0u k j j? + ? ?U                                                                     (4.29) 

                         

max max

min max

0

( )
( ) ( ) 0;

( 1) ( ) ; 0,1, , 1
j

i

u u k j u
u k j u k j j m

u u k u k i u j m
=

? ?
? ??? ? ? + ? ?? ?? ?

= ? + ? + = ?? ?
? ?

? ? + ? + ? = ?? ?
? ?? ?

? L
U:  

sendo , 
 
                 

               

~ ~
*

2

1

T T T

T T

C Q C AB Q AB R C QI
H

I Q C I QI S

== == ==

==

? ?
+ + ?? ?=

? ?
? +? ?? ?

% %%
% %

 

 
 

               [ ] [ ] [ ]
~

*
,2 1 1

T TT T TT sp m T sp
f k k k

C x C Q C y Q C e A Q AB x C QI y QI
== ==? ?= ? + ? +? ?? ?

% % % %  
 
 

                   [ ] [ ] [ ] [ ] [ ]{ }*1 1 12 1 2 T T TT TT sp sp sp m mk k k k kc c x C QC x y QC x y Qy e A Q A e= = ? + +% % %  
 
 
 A convergência das saídas aos seus valores de referência com o sistema em 
malha fechada com o controlador definido no Problema P4.2 é assegurada pelo seguinte 
teorema : 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 48 

Teorema 4.2 : Para um sistema sem perturbações, com pólos estáveis e integradores,                                
                        se o Problema P4.2 for viável no instante k , então, será viável para os 
                        instantes consecutivos 1k + , 2k + , ..., e além disso, as saídas do sistema 
                        em malha fechada com a lei de controle formulada no Problema P4.2                      
                        irão convergir assintoticamente aos valores de referência. 
 
Prova : A prova desse teorema é feita seguindo os mesmos passos apresentados no  
             teorema 2, visto no capítulo anterior.  
 
 
 Para o caso regulador, da mesma forma analisada no Problema P3.2 do capítulo 
anterior, o controlador do Problema P4.2 será também viável para uma região maior de 
estados iniciais e/ou perturbações do que o controlador do Problema P4.1. 
 
 Para o caso de rastreabilidade nos valores de referência, o Problema P4.2 será 
também viável para mudanças maiores nos valores de ‘setpoints’ do que o controlador 
do Problema P4.1. 
 
 Ainda assim, poderá haver conflito entre as restrições de igualdades dadas pelas 
Eq. (4.32) e Eq. (4.24) dependendo do tamanho das perturbações ou das variações dos 
valores de referência. 
 
 Usaremos aqui a mesma extensão na função custo, apresentada anteriormente, 
adicionando-se a segunda variável de folga para sistemas com pólos integradores, 
conforme Cano e Odloak (2003) surgindo então a definição do Problema P4.3 a seguir. 
 
 
 
 
Problema P4.3 

 

Seguindo a mesma sequência da formulação do problema anterior, a função 

custo da Eq.(4.33) é estendida agora pelo uso da segunda variável de folga : 

 
1

3,
0 0

1 2

( ) ( ) ( ) ( )
mTs i s i T

k k k k k
j j

T Ts s i i
k k k k

V e k j j t Q e k j j t u k j R u k j

S S

? ? ? ?

? ? ? ?

? ?

= =

? ? ? ?= + ? ? ? + ? ? ? + ? + ? +? ? ? ?

+ +

? ?
                    

                                                                                                                               (4.34) 
 
onde  
 
 

1S  e 2S  são matrizes positivas definidas que ponderam as variáveis de folga 
s
k? e  

             ik? , respectivamente. 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 49 

Os termos (1)kV  e 
(2)

kV  serão dados por : 
 

[ ] [ ](1) 1 1
T

sp s i sp s i
k k k k k k kk k

V C x C u y I T Q C x C u y I T? ? ? ?
== ==? ? ? ?= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?

%  
 

(2)

1

[ ( ) ] [ ( ) ]s i T s ik k k k k
j

V e k m j j t Q e k m j j t? ? ? ?
?

=

= + + ? ? ? + + ? ? ??  
 
onde  

                 
2

ny

ny

ny

t I
t I

T

np t I

?? ?
? ??? ?=
? ?
? ?

?? ?? ?

M
. ,np ny ny? R              

ny

ny

ny

I
I

I

I

? ?
? ?
? ?=
? ?
? ?
? ?? ?

M
. ,np ny ny? R  

 
 
Para o termo (2)kV  ser limitado impomos : 
 

( ) 0s sp skx k m y ?+ ? ? =                                                                                          (4.31) 
 

( ) 0i ikx k m ?+ + =                                                                                        (4.35) 
 

( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                                                 (4.32) 
 

1( ) 0
i i i

m k kx k D u ?+ ? + =                                                                                           (3.12) 
 
 

[ ] [ ]3, 1 1
T

sp s i sp s i
k k k k k k kk k

V C x C u y I T Q C x C u y I T? ? ? ?
== ==? ? ? ?= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?

%  

             
[ ]{ } [ ]{ }~ ~*

1 2

T T
m m

k kk k

T TT s s i i
k k k k k k

A e AB u Q A e AB u

u R u S S? ? ? ?

+ + ? + ?

+ ? ? + +%
                                                 (4.36) 

 
 
 A minimização da função custo 3,kV  sujeita às restrições de igualdade da Eq. 
(4.32) e Eq. (3.12), não produz uma lei de controle que garanta que a função seja 
decrescente no tempo. Tal fato decorre que no instante 1k +  as expressões abaixo não 
atenderão a Eq. (3.12) : 
 
                * *1 [ ( 1) ... ( 1) 0]

T T T
ku u k u k m+? = ? + ? + ?     

               
*

1
s s
k k? ?+ =  

                  
*

1
i i
k k? ?+ =  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 50 

 Assim, usaremos a estratégia do capítulo anterior para a obtenção de um 
controlador estável que seja baseado na minimização da função custo dada pela Eq. 
(4.37). Dessa forma, propõe-se a função custo secundária, positiva, já vista 
anteriormente dada por : 
 
 

, 2

Ti i
l k k kV S? ?=                                                                                                                                

 
 
 Consideremos ainda a mesma restrição do capítulo anterior à ser incluida no 
problema de otimização : 
 

, , 1l k l kV V ?&amp;lt;%                                                                                                                 (3.13) 
 
onde  
 

, 1 2

Ti i
l k k kV S? ?? = % %%   

 
 

O escalar , 1l kV ?% é calculado com 1ik? ?%  , o qual é obtido da seguinte maneira : 
 

1 1, 1( 1)
i i i
k m kx k D u? ?? = ? ? ? ?% %  (3.14) 

 

( 1) ( ) ( 1)i i ix k x k D u k? = ? ? ?%  (3.15) 

 

Para um sistema sem perturbações, tem-se : 

 

 ( 1) ( 1)
i ix k x k? = ?%       

1 1
i i
k k? ?? ?=%  

 
 
 Assim, à medida que as entradas do sistema no ponto de equilíbrio estejam 
dentro da região viável U , a Eq. (3.13) será atendida para qualquer max 0u? ? e ,l kV  será 
decrescente. 
 
 Como já apresentado anteriormente, a Eq. (3.13) será sempre viável com a 
determinação do estado no instante 1k ?  usando a Eq. (3.15). 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 51 

 Com isso, a proposição do controlador preditivo nominal de horizonte infinito 
para sistemas estáveis e/ou integradores com existência ou não de tempo morto será 
formulado pela função custo do Problema P4.3, partindo da Eq. (4.36), na forma 
quadrática ( ver dedução no apêndice A4 ) sujeito ao conjunto de restrições de igualdade 
dadas pelas Eq. (4.32) , Eq. (3.12) e pelas restrições de desigualdade dadas pelas  Eq. 
(4.29) e Eq. (3.13). 
 
 

3 ,3 3, ,
min 2s i

k k

T TT s i s T s
k k k k f ku

i i
k k k

u u

u H C c
? ?

? ? ? ?

? ?
?

? ?? ? ? ?? ?
? ?? ? ? ?? ?? ?? + +? ? ? ?? ?? ? ? ? ? ?? ?

? ? ? ?? ?? ? ? ?? ?

  

              s.a.   
 
                      ( ) ( ) 0s sp i sk kx k y m t x k D u ?? + ? + ? ? =%                                       (4.32)      
 
           1,( ) 0

i i i
m k kx k D u ?+ ? + =                                           (3.12) 

                       , , 1l k l kV V ?&amp;lt;%                                                                                   (3.13) 
 
             ( ) ,   0u k j j? + ? ?U                                                                    (4.29) 

                       

max max

min max

0

( )
( ) ( ) 0;

( 1) ( ) ; 0,1, , 1
j

i

u u k j u
u k j u k j j m

u u k u k i u j m
=

? ?
? ??? ? ? + ? ?? ?? ?

= ? + ? + = ?? ?
? ?

? ? + ? + ? = ?? ?
? ?? ?

? L
U:  

onde  
 

   

11 12 13

3 12 22 23

13 23 33

T

T T

H H H

H H H H

H H H

? ?
? ?

= ? ?
? ?
? ?

 

  
~ ~

*
11

T T

H C Q C AB Q AB R
== ==

= + +% %         12
T

H C QI
==

= ? %               13
T

H C QT
==

= ? %  

12
T TH I Q C

==

= ? %                                       22 1TH I QI S= +%             23 TH I QT= %  

13
T TH T Q C

==

= ? %                                       23
T TH T QI= %                 33 2TH T QT S= +%  

 

[ ] [ ] [ ]
~

*
,3 1 1 1

T T T TT T TT sp T m T sp T sp
f kk k k

C x C Q C y Q C e A Q AB x C QI y QI x C QT y QT
== ==? ?= ? + ? + ? +? ?? ?

% % % % % %

 

 [ ] [ ] [ ] *3 12
T TT T sp T m m

k kk k k
c x C QC x y QC x e A Q A e= ? +% %  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 52 

4.4 Observador de estados para o IHMPC-E 
 

Quando o modelo do sistema que está representado dentro do controlador 

preditivo está na forma de variáveis de estado, temos que necessariamente usar um 

observador de estados que faça a atualização dos mesmos em função dos erros entre as 

saídas previstas pelo modelo e as saídas reais, medidas da planta.  

 

Com a utilização do observador de estado, a Eq. (2.2) assume a seguinte forma : 

 

/ 1 1/ 1 1[ ] [ ]k k k k kx A x B u? ? ? ?= + ?               (4.37) 

{ }/ / 1 / 1[ ] [ ] [ ]pk k k k F k k kx x K y C x? ?= + ?              (4.38) 
 

onde 

 
p
ky  - vetor de saídas da planta real, medidas no instante k. 

FK  - matriz de ganho do observador. 

/ 1[ ]k kx ? - vetor dos estados no instante k , com informações da planta do instante anterior 

/[ ]k kx    - vetor atualizado dos estados, com informações da planta do instante atual 

 

substituindo a Eq. (4.37) na Eq. (4.38) : 

 

/ 1/ 1 1[ ] [( ) ] [ ] [( ) ]
p

k k F k k F k F kx I K C A x I K C B u K y? ? ?= ? + ? ? +                                   (4.39) 

 

Nos controladores preditivos convencionais usa-se a correção de estados do 

DMC que corresponde a somar o erro da saída atual da planta a todas as predições 

futuras. Essa estratégia corresponde no caso da nossa representação em variáveis de 

estado a um filtro dado por                      

 

 

0

ny

F
ny

I

K
I

? ?
? ?
? ?=
? ?
? ?
? ?

M
    1np +  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 53 

Entretanto, quando o sistema é integrador pode-se verificar que o filtro usado 

pelo DMC não estabiliza os pólos integradores, ou seja, o modelo de predição mais o 

observador torna-se um sistema instável. 

 

Assim, utilizaremos como observador de estados no IHMPC-E o filtro de 

Kalman que fará a correção dos estados com as saídas da planta. 

 

Para garantir a estabilidade do controlador em malha fechada, o ganho do 

observador, FK , deverá ser tal de modo que todos os auto-valores da matriz 

[( - ) ]FI K C A estejam dentro do círculo unitário, o que corresponderá a obtenção de 

pólos estáveis do sistema em malha fechada. 

 
Pode-se demonstrar (Astrom e Wittenmark, 1990) que para um instante k 

suficientemente grande, o ganho do filtro de Kalman é definido pelas seguintes 

equações : 

 

( ) 1T TFK APC V CPC
?

= +              (4.40) 

 
1T T T TP APA APC V CPC CPA W

?
? ?= ? + +? ?            (4.41) 

 

onde 

 

V  e W  são matrizes de sintonia do filtro de Kalman 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 54 

4.5 Aplicação do IHMPC-E a uma coluna de destilação 
 
 
4.5.1 Descrição sumária do processo analisado 
 

O sistema industrial proposto abaixo para análise em malha fechada com o 

controlador IHMPC-E, possui características integradoras e tempos mortos em algumas 

funções de transferência.  

 

Nesse processo é feita a separação em coluna de destilação entre Isobutano + 

Butenos leves (produto de topo) e n-Butano + Butenos pesados (produto de fundo) a 

partir de uma alimentação denominada de Carga Olefínica constituída de Isobutano,    

1-Buteno, 2-Buteno, cis-2-Buteno, trans-2-Buteno, n-Butano e n-Pentano. 

 

As funções de transferência a seguir foram obtidas a partir de testes de 

identificação na planta utilizando a rotina ARX (Auto-Regressive with eXogenous 

inputs) do software Matlab : 

 

7

7

2, 3 0, 7

4,7409 1, 4
9, 32 1 6,83 1

( )
1, 04 0,1354

17, 06 1 6,83 1

7, 04 1,8
20, 2 1 4,14 1

s

s

s s

s s
G s

e
s s

e
s s

?

?

?? ?
? ?
? ?
? ?
? ?+ +
? ?=

?? ?
? ?+ +
? ?
? ?? ?
? ?+ +? ?? ?

 sendo ( ) ( ) / ( )G s y s u s=  , ( )y s ?  R 4   e   ( )u s  ?  R 2 

 
Variáveis Controladas 

     y 1 Nível no Vaso de Topo        % 

     y 2 Temperatura da Bandeja 68 da coluna        
o C 

     y 3 Relação Isobutano/Olefinas no produto de topo        v/v 

     y 4 Teor de Isobutano no produto de fundo       % (vol.) 

 

Variáveis Manipuladas 

     u 1 Vazão de Vapor no Refervedor secundário da coluna        ton/h 

     u 2 Vazão de Refluxo de topo       km
3/d  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 55 

A figura abaixo apresenta um fluxograma de processo simplificado do sistema 

com as malhas de controle convencionais implementadas no SDCD (sistema digital de 

controle distribuído). 

 

Figura 4.1 – Esquema de controle convencional da coluna deisobutanizadora 

 

Em se tratando de coluna de destilação convencional (uma única alimentação 

com produtos de topo e de fundo) com 2 variáveis manipuladas, fica fácil perceber que 

tem-se 2 graus de liberdade. Controlando-se y1 (nível no vaso de topo) com objetivo de 

fechamento dinâmico de balanço material na coluna, restará uma especificação para 

escolha da outra variável controlada, entre as 3 possíveis (y2,y3,y4). 

 

Controlando-se uma dessas saídas, as outras 2 serão dependentes da controlada 

que foi escolhida, que serão informações complementares da resposta do processo em 

malha fechada. Nesse caso, as variáveis y3 e y4 são inferências calculadas em tempo real 

a partir das condições de operação do sistema ( vazões, pressões, temperaturas ), mas 

poderiam ser lidas, por exemplo, a partir de um analisador de processo instalado para 

essa medição. Assim, quando houver indisponibilidade de leitura dessas informações 

(exemplo: perda de algum instrumento necessário para o cálculo ou manutenção no 

analisador de processo), a temperatura da bandeja 68 (variável y2) poderá ser escolhida 

como variável controlada. 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 56 

O destilado, que é uma das alimentações ao reator da unidade, deve ter uma 

especificação adequada de 3y  (relação Isobutano/Olefinas) próxima do valor 

estequiométrico para as reações que se processam no mesmo. Assim, essa coluna 

chamada de deisobutanizadora, tem a função de remover Isobutano da carga para o 

destilado, porém, com uma relação Isobutano/Olefinas no produto de topo que não 

comprometa o reator que existe nessa unidade o qual recebe o destilado como carga. O 

conhecimento desse processo, mostra que esse sistema possui 2 graus de liberdade para 

o uso de um controlador preditivo. Assim, um conjunto de controladas desejadas seria 

1y  e 3y , ou um outro possível, tal como 1y  e 4y , ou ainda 1y  e 2y .  

 

Em processos com grande número de variáveis controladas, essa análise tende a 

ser mais complexa, para evitar que ocorram incoerências tanto nos pesos relativos das 

controladas bem como na escolha incorreta das mesmas. 

 

A figura a seguir apresenta a tela gráfica operacional desse sistema no SDCD 

com valores típicos do processo em tempo real : 

 
 

Figura 4.2- Tela gráfica operacional da coluna deisobutanizadora no SDCD 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 57 

4.5.2 Representação da coluna em variáveis de estado 
 

 

Considerando um intervalo entre amostragens de 1mint? = , horizonte de 

controle 2m = , horizonte de predição 10np =  e usando a Eq.(2.2) para sistemas 

integradores com tempo morto, apresentada na seção 4.2.2, obtém-se a seguinte 

representação do modelo em variáveis de estado na forma incremental : 

 

[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
                                                                                             (2.2) 

 

onde 

 

[ ] 1 2 10
TT T TT T T s d i

k k kx y y y x x x+ + +? ?= …? ?
56? R                                           (4.8) 

 

( ) ( )

4

4

4
*

4

4 4

4

0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 [ 11 ] [ 11 ]
0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

I
I

I
A

I t I t
I I t

F
I

? ?
? ?
? ?
? ?
? ?
? ?=
? ?? ? ?
? ?

?? ?
? ?
? ?
? ?? ?

L
L

M M M O M M M M
L
L
L
L
L

56,56? R                    (4.9) 

0
2 3 11 [ ] [ ] [ ]...

T
i d TT T T T T iD F NB S S S D t D D? ?? ?= + ?

56 , 2? R        (4.10)   
 

[ ]4 0 ... 0C I= 4 , 56? R                                                                                   (4.11) 
 

4 ([1 1 1 1])I diag=  
4 , 4? R  

( )

0 0 0 0 0 0 0 0
0 0 0,3072 0, 3560 0 0 0 0

[ 11 ]
0 0 0 0 0, 7910 0,1998 0 0
0 0 0 0 0 0 0,8204 0, 0702

t

? ?
? ?
? ?? ? =
? ?
? ?
? ?

4 , 8? R  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 58 

*

11 0 0 0
0 11 0 0

[(11) ]
0 0 4 0
0 0 0 4

I t

? ?
? ?
? ?? =
? ?
? ?
? ?

                                                                              (4.13) 

 

([0 0 0,8983 0,9104 0,9431 0,8638 0,9517 0, 7854])F diag= 8 , 8? R  
 

0 0
4, 7409 1, 4

1, 04 0,1354
7, 04 1,80

oD

? ?
? ?
? ?=
? ??
? ?

? ?? ?

                        

2, 3 0, 7
0 0
0 0
0 0

iD

?? ?
? ?
? ?=
? ?
? ?
? ?

 

 

1 0
0 1
1 0
0 1
1 0
0 1
1 0
0 1

N

? ?
? ?
? ?
? ?
? ?
? ?=
? ?
? ?
? ?
? ?
? ?
? ?? ?

 

 

([0 0 4, 7409 1, 4 1, 04 0,1354 7, 04 1,8])dD diag= ? ? ?  

 

2 11S SL  são os coeficientes de resposta ao degrau obtidos através da Eq.(2.33) 
correspondentes aos instantes de tempo discretos 2, ,11k = L  
 
 

2

4, 6 1, 4
0,9156 0, 2397

0 0, 0344
0 0, 6896

TS

?? ?
? ?
? ?=
? ?
? ?

?? ?

        . . .    11

25, 3 7, 7
3, 2845 0,9016
0, 2174 0,1083
1, 2647 1, 6737

TS

?? ?
? ?
? ?=
? ??
? ?
? ?? ?

 

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 59 

4.5.3 Filtro de Kalman para a coluna 
 
 

 Para garantir a estabilidade do controlador em malha fechada, o filtro de Kalman 

( K F ) foi adotado para as correções dos estados com a leitura da planta, conforme a Eq 

(4.38). Isso foi necessário para que todos os auto-valores da matriz [( - ) ]FI K C A fossem 

posicionados dentro do círculo unitário, o que resulta em pólos estáveis do sistema em 

malha fechada. 

 

 Apresentamos na figura 4.3 os auto-valores da matriz [( - ) ]FI K C A obtidos com 

o uso do filtro de Kalman para o sistema da coluna apresentado na seção anterior 

fazendo uso das matrizes A  e C   : 

 

 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

 

Figura 4.3- Auto-valores da matriz [( - ) ]FI K C A  

 
 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 60 

4.5.4 Desempenho do IHMPC-E  
 
 
4.5.4.1 Caso Nominal  
 

Apresentamos a seguir a resposta do processo em malha fechada em função da 

variação em ‘setpoints’ nas variáveis controladas 1y  e 3y  com o seguinte conjunto de 

parâmetros de sintonia : 

 

 horizonte de controle   2m =   e  4m =  
 supressão das manipuladas   ( [0 0] )R diag=  
 peso das controladas   [ ]( 1 1 )Q diag=  
 peso das variáveis de folga s?    [ ]1 ( 800 800 )S diag=  
 peso das variáveis de folga i?    [ ]2 ( 5 5 )S diag=  

 
              Tabela 4.1 – Parâmetros de sintonia do IHMPC-E nominal 
 
 
 
 

As condições iniciais e restrições consideradas foram as seguintes : 
 
 

[ ]50 % 1, 2 /inicialy vol vol=  
 

34 / 2 /inicialu ton h km d? ?= ? ?  

 
3

max 4,15 / 2, 6 /u ton h km d? ?= ? ?  

 
3

min 3,85 / 1, 4 /u ton h km d? ?= ? ?  

 
3

max 0, 04 / / min 0, 04 / / minu ton h km d? ?? = ? ?  

 
 

 As figuras 4.4 e 4.5 a seguir mostram um bom comportamento do sistema em 

malha fechada para o caso servo nas controladas 1y (mudança de 50% para 55%) e 

3y (mudança de 1,2 para 1,15 v/v) com o IHMPC-E de modelo nominal (planta = ao 

modelo usado internamente no controlador). 

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 61 

Figura 4.4- Controladas 1y  e 3y  com IHMPC-E 
 
 
 

Figura 4.5- Manipuladas 1u  e 2u  com IHMPC-E ( caso servo em 1y  e 3y ) 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 62 

Vemos na figura 4.4 um aparente offset na variável controlada 3y  para um 

horizonte de controle 2m = . Na mesma figura, vemos que quando esse horizonte é 

aumentado o offset é eliminado. 

 

 Na figura 4.6 representamos o comportamento ao longo do tempo da função 

custo 3,kV  dada pela Eq.(4.37). Vemos que no instante 10 min, quando ocorre a variação 

no ‘setpoint’ de 1y , 3,kV  assume valores muito altos os quais estão relacionados à 

necessidade do controlador ter que usar as variáveis de folga s? e i?  para manter-se 

viável. A partir desse 3,kV  decresce monotonicamente até o instante 200 mint =  quando 

é introduzida a variação no ‘setpoint’ de 3y . Nesse ponto, 3,kV  obviamente volta a 

aumentar, mas o aumento é tão pequeno que nem pode ser observado na figura. Isso 

indica que o controlador não precisou incluir variáveis de folga que levam a um grande 

aumento em  3,kV . 

Figura 4.6- Função custo do caso servo em 1y  e 3y  com IHMPC-E  
 

Vamos considerar agora a substituição no IHMPC-E da variável controlada 

3y (relação Isobutano/Olefinas no topo) pela controlada 4y (teor de Isobutano no fundo 

da torre). 

 As figuras 4.7 e 4.8 mostram que também nessa configuração o controlador 

IHMPC-E de modelo nominal com as mesmas restrições nas variáveis manipuladas do 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 63 

caso anterior e mesma sintonia se comporta satisfatoriamente para o caso servo nas 

controladas 1y (mudança de 50% para 55%) e 4y (mudança de 8% para 7,5%).  

Figura 4.7- Controladas 1y  e 4y  com IHMPC-E  
 

Figura 4.8- Manipuladas 1u  e 2u  com IHMPC-E ( caso servo em 1y  e 4y ) 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 64 

A figura 4.9 mostra que a função 3,kV tem para esse caso um comportamento 

similar ao comportamento do caso em que as controladas eram 1y  e 3y . Essa função 

atinge valores muito próximos de zero a partir do instante 50 min indicando que a partir 

desse ponto as variações de folga s? e i?  não são mais necessárias. 

 

Figura 4.9- Função custo do caso servo em 1y  e 4y  com IHMPC-E  

 
 

Em seguida consideramos o caso em que os valores de referência das 

controladas são mantidos fixos no tempo e que há alguma perturbação no processo.  

 

Suponhamos por exemplo que ocorra uma perturbação instantânea na 

temperatura de vapor no refervedor secundário da coluna, causada por um descontrole 

qualquer na rede de distribuição de vapor da unidade. Nesse caso, as funções de 

transferência consideradas para essa análise incluindo essa perturbação que no caso é 

medida, foram também identificadas através de testes na planta e são dadas pela 

seguinte matriz ( )dG s  : 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 65 

 
3

0, 2

0,396
11, 48 1

( )
0,1295

17, 06 1
1,176

33, 9 1

d s

s

s
G s

e
s

s

?

? ?
? ?
? ?
? ?
? ?+
? ?=

?? ?
? ?+
? ?

?? ?
? ?+? ?? ?

   onde    ( ) ( ) ( ) ( ) ( )d dy s G s u s G s u s= +  

 
Variáveis Controladas 

     y 1 Nível no Vaso de Topo        % 

     y 2 Temperatura da Bandeja 68 da coluna        
o C 

     y 3 Relação Isobutano/Olefinas no produto de topo        v/v 

     y 4 Teor de Isobutano no produto de fundo       % (vol.) 

 

Variáveis Manipuladas 

     u 1 Vazão de Vapor no Refervedor secundário da coluna        ton/h 

     u 2 Vazão de Refluxo de topo       km
3/d  

  

Variáveis Perturbação 

     1du  Temperatura de fluido quente no refervedor secundário        ºC 

 
 

Para análise do desempenho de rejeição de perturbações do IHMPC-E, 

consideremos, para cenário de simulação, que no instante 20k = , por exemplo, a 

temperatura de fluido quente no refervedor secundário aumente de forma brusca de 

90,1 oC  para  91, 3 oC . 

 
As figuras 4.10 e 4.11 a seguir apresentam os resultados dessa simulação 

combinando ‘setpoints’ fixos em 1y  e 3y (caso servo) e perturbação em 1du  (caso 

regulador). Vemos que para esse tipo de perturbação e com a sintonia escolhida, existe 

uma clara preferência pelo controle de 1y  que retorna ao seu ‘setpoint’ em menos de 10 

min, enquanto que 3y  só atinge o valor desejado após cerca de 60 min. É claro que um 

comportamento diferente poderia ser obtido alterando-se a sintonia do controlador, 

particularmente a relação entre os pesos das variáveis controladas. 

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 66 

Figura 4.10- Controladas 1y  e 3y  em função da perturbação 1du  com IHMPC-E  
 
 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.11- Manipuladas 1u  e 2u  em função da perturbação 1du  com IHMPC-E  



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 67 

Na figura 4.12 vemos o valor da função custo 3,kV  que também é 

monotonicamente decrescente a partir do instante 20 min, quando entra a perturbação 

no vapor. O aumento abrupto que ocorre nesse instante, mostra que o controlador tem 

que lançar mão das variáveis de folga para se manter viável. A partir do instante 35 min 

as variáveis de folga não são mais necessárias. 

Figura 4.12- Função custo do caso regulador com perturbação 1du  com IHMPC-E 

 
4.5.4.2 Desempenho do IHMPC-E  para incertezas no modelo da planta 
 

Tomemos como exemplo, incertezas da ordem de 25 % nos ganhos, taxas 

integradoras, constantes de tempo e tempo morto em relação ao modelo identificado na 

planta das saídas 1y  e 3y  com as entradas 1u  e 2u . Do ponto de vista industrial, esse 

nível de incerteza já pode ser considerado elevado para esse tipo de coluna de 

destilação. 

incerteza nos ganhos e nas taxas integradoras : 

                                        25 % abaixo do nominal             25 % acima do nominal 

                                  
7

1,84 -0,56

( )
-0,832 0,10832
17, 06 1 6,83 1

Ia s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

           
7

2,875 -0,875

( )
-1, 3 0,16925

17,06 1 6,83 1

Ib s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 68 

incerteza nas constantes de tempo : 

                                         25 % abaixo do nominal             25 % acima do nominal 

                                  
7

2, 3 -0, 7

( )
-1, 04 0,1354

13, 648 1 5, 464 1

Ia s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

         
7

2.3 -0.7

( )
-1.04 0.1354

21.325 1 8.5375 1

Ib s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

 

incerteza no tempo morto : 

                                         25 % abaixo do nominal             25 % acima do nominal 

                                  
5,6

2, 3 -0, 7

( )
-1, 04 0,1354
17, 06 1 6,83 1

Ia s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

            
8,75

2, 3 -0, 7

( )
-1, 04 0,1354
17,06 1 6,83 1

Ia s

s s
G s

e
s s

?

? ?
? ?
? ?=
? ?
? ?+ +? ?

 

 
Variáveis Controladas 

     y 1 Nível no Vaso de Topo        % 

     y 3 Relação Isobutano/Olefinas no produto de topo        v/v 

 

Variáveis Manipuladas 

     u 1 Vazão de Vapor no Refervedor secundário da coluna        ton/h 

     u 2 Vazão de Refluxo de topo       km
3/d  

 

Apresentamos a seguir a resposta do processo em malha fechada em função da 

variação em ‘setpoints’ nas variáveis controladas 1y  e 3y  com o seguinte conjunto de 

parâmetros de sintonia : 

 horizonte de controle   2m =   
 supressão das manipuladas   ( [100 100] )R diag=  
 peso das controladas   [ ]( 1 1 )Q diag=  
 peso das variáveis de folga s?    [ ]1 ( 800 800 )S diag=  
 peso das variáveis de folga i?    [ ]2 ( 5 5 )S diag=  

 
                  Tabela 4.2 – Parâmetros de sintonia do IHMPC-E de modelo incerto 
 

 

Vemos que em relação aos parâmetros da Tabela 4.1, apenas os pesos nas 

variáveis manipuladas foram substancialmente aumentados para acomodar as incertezas 

no modelo. Isso foi necessário para tornar o controlador mais cauteloso uma vez que as 

incertezas não são explicitamente consideradas. 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 69 

As condições iniciais e restrições consideradas foram as seguintes : 
 
 

[ ]50 % 1, 2 /inicialy vol vol=   
 

34 / 2 /inicialu ton h km d? ?= ? ?  

 
3

max 4,15 / 2, 6 /u ton h km d? ?= ? ?   

 
3

min 3,85 / 1, 4 /u ton h km d? ?= ? ?  

 
3

max 0, 04 / / min 0, 04 / / minu ton h km d? ?? = ? ?  

 
 

 As figuras 4.13 e 4.14 mostram que com essa sintonia o controlador apresenta 

uma performance bastante satisfatória para o caso servo com variações nos ‘setpoints’ 

das controladas 1y (mudança de 50% para 55%) e 3y (mudança de 1,2 para 1,15 v/v) 

para incertezas de 25 % nos ganhos e nas taxas integradoras :  

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.13-  Controladas 1y  e 3y  com IHMPC-E e incertezas nos ganhos 
 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 70 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.14- Manipuladas 1u  e 2u  com IHMPC-E e incertezas nos ganhos 
                     
 

Analogamente, as figuras 4.15 e 4.16 mostram o comportamento do sistema em 

malha fechada para as mesmas variações nos ‘setpoints’ de 1y  e 3y  com o IHMPC-E 

com incertezas de 25 % nas constantes de tempo. Para essas incertezas, a performance 

do controlador é também bastante satisfatória. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.15- Controladas 1y  e 3y  com IHMPC-E e incertezas nas constantes de tempo 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 71 

                     
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.16- Manipuladas 1u  e 2u  com IHMPC-E e incertezas nas constantes de tempo 
                     
 

Um comportamento similar foi observado para o caso de incertezas no tempo 

morto presente no sistema. As figuras 4.17 e 4.18 mostram o comportamento do sistema 

em malha fechada para o caso servo nas controladas 1y  e 3y  com o IHMPC-E com 

incertezas de 25 % no tempo morto entre a controlada 3y  e a manipulada 1u  : 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.17- Controladas 1y  e 3y  com IHMPC-E e incerteza no tempo morto 



Capítulo 4 – IHMPC estendido para sistemas integradores com tempo morto 72 

                    
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figura 4.18- Manipuladas 1u  e 2u  com IHMPC-E e incertza no tempo morto  
                    
 
 
 

Como resultado final desse exemplo, observamos pelas figuras apresentadas, que 

tanto para o caso nominal como também para os casos de incertezas no modelo, o 

IHMPC-E pode ser aplicado a coluna deisobutanizadora e apresenta um bom 

desempenho tanto para o caso servo como para o caso regulador.  

 

Observamos também que o procedimento de escolha dos parâmetros de sintonia 

do controlador é convencional, praticamente não exigindo esforço de muitas tentativas 

no sentido de obter-se uma performance satisfatória. 

 
 



 73 

 Capítulo 5 

Aplicação do IHMPC-E no controle de um sistema industrial complexo 

 

Um dos fatores motivantes deste trabalho foi o estudo do controle do sistema de 

produção de óxido de eteno já estudado em trabalhos anteriores por Cano (2001) e por 

Rodrigues e Odloak (2003). Esse sistema tem a característica de apresentar um grande 

número de pólos integradores ao lado de pólos estáveis. 

 

Uma alteração na estrutura do sistema de controle que havia sido estudado 

anteriormente por Rodrigues e Odloak (2003) levou ao aparecimento de tempos mortos 

nas várias funções de transferência, tanto nas integradoras como nas estáveis. 

 

A seguir faremos uma breve descrição desse sistema antes de apresentar a 

configuração de controle que será estudada, bem como as funções de transferência 

obtidas experimentalmente. 

 

 
5.1 Descrição sumária do processo de óxido de eteno e seu problema de controle 
 
 

O processo é dividido em três áreas principais integradas entre si, através de uma 

corrente de reciclo ao reator, que são as áreas de reação, de purificação do óxido de 

eteno e a de remoção de CO2. Maiores detalhes do processo podem ser vistos em Cano 

(2001) e em Rodrigues e Odloak (2003). 

 

A reação principal é a oxidação do etileno em fase vapor  catalisada por óxido de 

prata, representada pela seguinte equação química : 

2
2 4 2 2 4

1
2

Ag OC H O C H O+ ????  

 

Uma reação secundária e indesejável é a combustão completa do etileno : 

2 4 2 2 23 2 2C H O CO H O+ ??? +



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 74 

Oxigênio de alta pureza, nitrogênio, inibidor de combustão (DCE, dicloroetano) 

e etileno são misturados com o gás de reciclo e enviados ao reator catalítico. Como as 

reações são altamente exotérmicas, a temperatura de reação é controlada resfriando-se o 

reator com fluido térmico, com a geração de vapor d`água de média pressão. O efluente 

do reator é resfriado, aquecendo a corrente de reciclo que entra no reator. Em seguida, o 

efluente do reator em fase vapor é enviado a uma coluna de absorção onde o óxido de 

eteno é absorvido em água. O gás remanescente é então comprimido e reciclado ao 

reator.  

 

Para evitar o acúmulo de CO2 no sistema, uma parte do gás de reciclo é enviada 

a um sistema de remoção de CO2, onde o dióxido de carbono é absorvido quimicamente 

por uma solução de carbonato de potássio. Na sequência, o CO2 é removido da solução 

com vapor de processo, que é purgado para a atmosfera juntamente com o dióxido de 

carbono. Para evitar o acumulo de inertes (Ar, N2 e C2H6) presentes no gás de reciclo, 

uma pequena purga de gás, isento de óxido de eteno é feita. 

 

A figura 5-1 a seguir apresenta um fluxograma simplificado do processo, 

conforme Rodrigues e Odloak (2003). 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.1- Fluxograma simplificado do processo de oxidação catalítica de etileno  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 75 

O controlador IHMPC-E a ser analisado, terá na sua estrutura 4 variáveis 

controladas e 5 variáveis manipuladas. Apresentamos a seguir, com base em testes de 

identificação executados na planta conforme Rodrigues et al (2004) sobre projeto de 

desenvolvimento de controladores avançados para reator de óxido de etileno, a matriz 

de funções de transferência entre as variáveis, ( )pG s  :  

4 3 3 2 2 2 6

2 2 2

4 3 4 8 3 2

2

10 ( 95 1) 2,3 10 3,2 10 ( 1) 3,5 10 ( 0,14 1) 7,5 10
32,16 4,65 1 64,55 8,83 1 73,23 6,74 1

1,69 10 2,1 10 1,9 10 (1,47 1) 5,47 10 ( 1)
9,67 13,55 1

s s s

s s

s e s e s e
s s s s s s s s

e e s s e
s s s s

? ? ? ? ? ? ? ?

? ? ? ? ? ?

? ? + ? × ? × ? + ? × ? + ? ×
+ + + + + +

? × × ? × + ? × +
+ +

6 4

2

3 4 5 15 3 2 4 3 10

2 2 2

5 4 5 8

1,07 10
3,91 10,31 1

8,1 10 ( 0,02 1) 5,5 10 9,6 10 ( 1) 0,13( 2,66 1) 2,53 10
52,45 11,92 1 54,42 6,58 1 55,11 7,84 1 25 1

3,9 10 5,7 10 1,4 1

s

s s s s s

s s

s s s

s e e s e s e e
s s s s s s s s

e e
s s

? ?

? ? ? ? ? ? ? ? ?

? ? ? ?

? ×
+ +

× ? + ? × × + ? + ? ×
+ + + + + + +

? × × ? × 3 2 6 5 6
2 2

0 ( 1) 4,39 10 ( 1) 7,6 10
8,67 14,48 1 7,79 43,41 1

s ss s e e
s s s s s

? ? ? ? ?

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?+ ? × + ×? ?
? ?+ + + +? ?

 

                                                                                                                                   (5.1) 

sendo ( ) ( ) / ( )pG s y s u s=  , ( )y s ?  R 4   e   ( )u s  ?  R 5 

Variáveis Controladas 

     y 1 Teor de O2 no Gás de Reciclo na entrada do reator         % 

     y 2 Teor de C2H4 no Gás de Reciclo na entrada do reator          % 

     y 3 Temperatura do Óleo Térmico na entrada do reator 
           o C 

     y 4 Pressão do Gás de Reciclo na entrada do reator      kg/cm
2g 

 

Variáveis Manipuladas 

     u 1 Vazão de O2 ao reator      kg/h 

     u 2 Vazão de C2H4 ao reator      kg/h 

     u 3 Abertura da válvula pequena de Óleo Térmico         % 

     u 4 Abertura da válvula grande de Óleo Térmico         % 

     u 5 Vazão de N2 ao reator      kg/h 

 

Como podemos verificar no modelo apresentado em (5.1), a variável controlada 

1y  é integradora sem tempo morto em relação às manipuladas 2u  e 5u . No entanto, a 

controlada 2y  é integradora em relação às manipuladas 1u , 2u  e 5u  com tempos mortos 

diferentes entre si. O mesmo fato repete-se para a controlada 4y (integradora com 1u , 2u  

e 5u ). 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 76 

5.2 Modelo em variáveis de estado em sistemas integradores com tempos mortos 
diferentes 
 
 

 Para o modelo nominal, consideramos que para cada saída exista o mesmo 

tempo morto em todas as entradas que eram integradoras. Agora, de uma maneira mais 

genérica, vamos considerar que existam tempos mortos diferentes entre cada saída e as 

entradas que são integradoras. Tomando como exemplo, consideremos uma saída 1y  

que tenha tempos mortos diferentes com duas entradas 1u  e 2u , conforme a seguinte 

função de transferência : 

 

1,1 1,2
1,1 1,2

1 1 2
1,1,1 1,1,2 1,2,1 1,2,2

( ) ( )
( )( ) ( )( )

s sk e k e
y u s u s

s s r s r s s r s r

? ?? ?

= +
? ? ? ?

 

 

assim, as respostas ao degrau de 1y  em relação às entradas 1u  e a 2u  são dadas por  

 

1,1,1 1,1 1,1,2 1,1( ) ( )0
1,1 1,1 1,1,1 1,1,2 1,1 1,1( ) ( )

r t r td d iS t d d e d e d t? ? ?? ?= + + + ?  

 

1,2,1 1,2 1,2,2 1,2( ) ( )0
1,2 1,2 1,2,1 1,2,2 1,2 1,2( ) ( )

r t r td d iS t d d e d e d t? ? ?? ?= + + + ?  

 

a trajetória da saída 1y  é então representada da seguinte forma : 

 

1,1,1 1,1 1,1,2 1,1 1,2,1 1,2 1,2,2 1,2( ) ( ) ( ) ( )
1 1 1 2 3 4

1 1,1 2 1,2

( ) [ ] [ ] [ ] [ ] [ ]

[ ] ( ) [ ] ( )

r t r t r t r ts d d d d
k k k k k

i i
k k

y t x x e x e x e x e

x t x t

? ? ? ?

? ?

? ? ? ?= + + + + +

+ ? + ?
 

 

Dessa forma, a atualização dos estados sx  , dx  e ix  seguindo as equações 

(2.20), (2.21) e (2.22) apresentadas no capítulo 2 é a seguinte : 

 
0 0

1 1 1 1,1 1 1,2 2 1,1 1 1,2 2[ ] [ ] ( ) ( ) ( ) ( )
s s i i

k kx x d u k d u k td u k td u k+ = + ? + ? + ? ? + ? ?  

 

1,1,1 1,1,1
1 1 1 1,1,1 1[ ] [ ] ( )

r t r td d d
k kx e x d e u k

? ?
+ = + ?  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 77 

1,1,2 1,1,2
2 1 2 1,1,2 1[ ] [ ] ( )

r t r td d d
k kx e x d e u k

? ?
+ = + ?  

 

1,2,1 1,2,1
3 1 3 1,2,1 2[ ] [ ] ( )

r t r td d d
k kx e x d e u k

? ?
+ = + ?  

 

1,2,2 1,2,2
4 1 4 1,2,2 2[ ] [ ] ( )

r t r td d d
k kx e x d e u k

? ?
+ = + ?  

 

1 1 1 1,1 1[ ] [ ] ( )
i i i

k kx x d u k+ = + ?  

 

2 1 2 1,2 2[ ] [ ] ( )
i i i

k kx x d u k+ = + ?  

 

Observa-se por esse exemplo que o estado ix  para uma saída 1y  é igual ao 

número de entradas. 

 

 Para o caso multivariável, a generalização é feita na função * ( )I t  no instante de 

tempo ( 1)np t+ ?  modificando a Eq. (4.13) vista anteriormente : 

 

11 1

21 2*

1 .

0 0 0 0 0 0
0 0 0 0 0 0

( )

0 0 0 0 0 0

nu

nu

ny ny nu

n t n t
n t n t

n t

n t n t

? ?
? ?

? ?

? ? ? ?? ?
? ?? ? ? ?? ?? ? =
? ?
? ?

? ? ? ?? ?? ?

L L L L
L L L L

M L M M L M O O O M L M
L L L L

 

                                                                                                                      (5.17) 

onde *[( 1) ]np t? + ? , .ny nu ny? R  
 

Daí, a representação generalizada em variáveis de estado, é representada na 

seguinte forma : 

 
[ ] [ ]
[ ] [ ]

1 kk k

k k

x A x B u

y C x

?
+

= +

=

 
                                                                                             (2.2) 

onde 

[ ] 1 2
TT T TT T T s d i

k k k npx y y y x x x+ + +? ?= …? ?
                                               (5.18) 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 78 

( ) ( )*

.

0 0 0 0 0 0
0 0 0 0 0 0

0 0 0 0 0 0
0 0 0 0 [ 1 ] [ 1 ]

ˆ0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0

ny

ny

ny

ny

ny

ny nu

I
I

I
A

I np t np t

I I t
F

I

? ?
? ?
? ?
? ?
? ?
? ?= ? ?? + ? ? + ?
? ?

?? ?
? ?
? ?
? ?? ?

L
L

M M M O M M M M
L
L
L
L
L

                    (5.19) 

 

0
2 3 1 [ ] [ ] [ ]...

T
i d i TT T T T T

np D F N D NB S S S D t D+? ?? ?= + ?                (5.20)   

 

0 ... 0nyC I? ?= ? ?                                                                                                (5.21) 

 

.

1 1 0 0 0 0 0 0
0 0 1 1 0 0 0 0ˆ

0 0 0 0 0 0 1 1
ny nu ny

I

×

? ?
? ?
? ?=
? ?
? ?
? ?

L L L L
L L L L

M L M M L M O O O M L M
L L L L

 

 

nu

nu

nu

I
I

N

I

? ?
? ?
? ?=
? ?
? ?
? ?? ?

M      ny          

 

( )1,1 1, 2,1 2, ,1 ,i i i i i i inu nu ny ny nuD diag d d d d d d? ?= ? ?L L L L  
 

 

Com isso, o modelo descrito acima descreverá rigorosamente qualquer sistema 

com integradores e tempos mortos. Entretanto, pode-se verificar que esse modelo não é 

detectável, ou seja, nem todos os estados conseguirão ser detectados pelas saídas.  

 

Da literatura de controle (Sontag,1998), define-se como sistema detectável 

aquele para o qual é possível determinar um observador de estado tal que todos os auto-

valores da matriz [( - ) ]FI K C A estejam dentro do círculo unitário.  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 79 

Pode-se demonstrar que um sistema observável é também detectável e existem 

critérios simples para verificar a observabilidade de um sistema. A seguir passaremos a 

apresentar uma breve revisão sobre o assunto. 

 
 
5.3 Conceitos de observabilidade de um sistema  
 
 

Um sistema é dito observável , se cada estado (0)x  puder ser determinado a 

partir das saídas ( )y t  em um intervalo finito de tempo 0 ft t? ? .Para um sistema ser 

observável, a seguinte matriz deve ter seu rank igual ao número de estados do sistema :  

 
2 1( ) ( )T T T T T T nd TC A C A C A C?? ?? ?L                                                         (5.22) 

 
Tomemos como exemplo inicial dessa análise o modelo integrador  apresentado 

no capítulo 2, seção 2.4 cuja matriz de funções de transferência é dada abaixo : 

1,1 1,2

2,1 2,2

0,19 1, 7
( ) ( ) 19, 5 1

( ) ( ) / ( )
( ) ( ) 0, 763 0, 235

31, 8 1

G s G s s s
G s y s u s

G s G s
s s

? ?? ?
? ?? ? +
? ?= = =? ? ?? ?? ?
? ?+? ?

 

 

temos nesse caso 6nd = (estados), obtendo-se a seguinte matriz resultante da Eq.(5.22): 

 
2 3 4 5( ) ( ) ( ) ( )T T T T T T T T T T TC A C A C A C A C A C? ? =? ?  

1 0 1 0 1 0 1 0 1 0 1 0
0 1 0 1 0 1 0 1 0 1 0 1
1 0 0,95 0 0,9025 0 0,8574 0 0,8145 0 0, 7738 0
0 1 0 0,969 0 0,939 0 0,9099 0 0,8816 0 0,8543
0 0 1 0 2 0 3 0 4 0 5 0
0 0 0 1 0 2 0 3 0 4 0 5

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?
 cujo rank é 6. 

 

Portanto, esse sistema é observável, ou seja, todos os estados podem ser 

determinados a partir das saídas ( )y t . 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 80 

Consideramos agora para análise um sistema que possua integradores de tempos 

mortos diferentes para uma dada saída em relação às entradas. Seja por exemplo um 

tempo morto de 1 minuto para a saída 1y  com a entrada 1u  no seguinte sistema : 

 

1,1 1,2

2,1 2,2

0,19 1, 7
( ) ( )

( ) ( ) / ( )
( ) ( ) 0, 763 0, 235

31, 8 1

se
G s G s s sG s y s u s
G s G s

s s

?? ?? ?
? ?? ?
? ?= = =? ? ?? ?? ?
? ?+? ?

 

 

Para um intervalo de amostragens de 1 mint? = , horizonte de controle 1m = , 

horizonte 2np =  e usando a Eq.(2.2) para sistemas integradores com tempo morto, 

apresentado no capítulo 4, seção 4.2.2, obtem-se as seguintes matrizes A  e C  do 

modelo : 

 

0 0 1 0 0 0 0 0 0 0 0 0
0 0 0 1 0 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0 0 0 2 0
0 0 0 0 0 1 0 0 0,91 0 0 3
0 0 0 0 1 0 0 0 0 0 1 0
0 0 0 0 0 1 0 0 0 0 0 1
0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0,969 0 0 0
0 0 0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 0 0 1

A

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?= ? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?? ?

 , 1 0 0 0 0 0 0 0 0 0 0 0
0 1 0 0 0 0 0 0 0 0 0 0

C
? ?

= ? ?
? ?

 

teremos nesse caso 12nd = (estados) com a seguinte matriz resultante da Eq.(5.22) : 

2 3 11( ) ( ) ... ( )T T T T T T T T TC A C A C A C A C? ?? ?
1 2 , 2 4? R  cujo rank é 9, sendo então 

esse sistema não observável, ou seja, nem todos os estados podem ser determinados a 

partir das saídas ( )y t . 

 

Assim, não será possível aplicar um controlador MPC nominal de horizonte 

infinito para o sistema de óxido apresentado pela Eq.(5.1), pois o modelo apresenta 

alguns estados não-detectáveis em função de pólos integradores com tempos mortos 

diferentes. Assim, há a necessidade de se usar um modelo aproximado que seja 

detectável. 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 81 

5.4 Controle do sistema industrial de óxido de eteno com modelos aproximados  
 

 

Para a aplicação do IHMPC-E em sistemas integradores com tempos mortos 

diferentes, faremos a aproximação das dinâmicas integradoras com diferentes tempos 

mortos por dinâmicas de primeira ordem. Essa aproximação consiste em aproximar a 

resposta em rampa de cada integrador para uma perturbação em degrau até instantes 

próximos de 400 minutos. Esse tempo foi escolhido a priori para que o sistema em 

malha fechada não apresente respostas muito rápidas, por conveniência desse tipo de 

processo químico. Obviamente outros tempos poderiam ser escolhidos. Qualquer que 

seja a aproximação adotada, o controlador não terá a sua estabilidade garantida, pois, o 

mesmo não será mais o do caso nominal, visto no capítulo anterior.  

 

Com essa abordagem, as restrições de igualdade dada pela Eq.(3.12) e de 

desigualdade dada pela Eq.(3.13) deixam de existir, ficando o problema de controle do 

tipo quadrático cuja solução é feita por programação quadrática (QP), resolvida mais 

rapidamente ao invés de um problema do tipo programação não-linear (NLP) 

solucionado por programação quadrática sucessiva (SQP).  

 

Apresentamos então a matriz de funções de transferência, ( )mG s que será usada 

como modelo no controlador : 

 
4 3 2 2 2

2 2 2

3 8 3

2

10 ( 95 1) 0,0117 3,2 10 ( 1) 3,5 10 ( 0,14 1) 0,0047
32,16 4,65 1 385 1 64,55 8,83 1 73,23 6,74 1 425 1

0,082 0,1155 1,9 10 (1,47 1) 5,47
300 1 400 1 9,67 13,55 1

s s s

s s

s e s e s e
s s s s s s s s

e e s
s s s s

? ? ? ? ? ?

? ? ?

? ? + ? ? × ? + ? × ? + ?
+ + + + + + + +

? ? × + ? ×
+ + + +

2 6

2

3 4 15 3 2 4 3 10

2 2 2

4

10 ( 1) 0,0589
3,91 10,31 1 400 1

8,1 10 ( 0,02 1) 0,0303 9,6 10 ( 1) 0,13( 2,66 1) 2,53 10
52,45 11,92 1 400 1 54,42 6,58 1 55,11 7,84 1 25 1

0,0205 0
400 1

s

s s s s s

s

s e
s s s

s e e s e s e e
s s s s s s s s

e
s

? ?

? ? ? ? ? ? ? ?

?

+ ?
+ + +

× ? + ? × + ? + ? ×
+ + + + + + + +

?
+

8 3 2 6 6

2 2

,0314 1,4 10 ( 1) 4,39 10 ( 1) 0,0418
400 1 8,67 14,48 1 7,79 43,41 1 400 1

s s se s s e e
s s s s s s

? ? ? ? ?

? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?
? ?? × + ? × +? ?
? ?+ + + + + +? ?

 

 

 

A figura 5.1 apresenta os auto-valores da matriz [( ) ]FI K C A?  usando o filtro de 

Kalman, FK , como observador de estados para a correção dos estados do modelo com a 

leitura das saídas da planta : 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 82 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.1- Auto-valores da matriz [( ) ]FI K C A?  

 

 

Vamos estudar a resposta do processo em malha fechada para alguns casos de 

rastreabilidade nos valores de referência das variáveis controladas e de rejeição de 

perturbação, com o seguinte conjunto de parâmetros de sintonia : 

 

 horizonte de controle   5m =  e 10m =   
 supressão das manipuladas   310 nuR I

?=  
 peso das controladas   nyQ I=  

 peso das variáveis de folga s?    41 10 nyS I=  
 
             
                     Tabela 5.1 – Parâmetros de sintonia do IHMPC-E de modelo incerto 

 
 
As condições iniciais e restrições consideradas foram as seguintes : 

 
 

0 2
2 2 46, 5 % 20 % 251 19, 5 /

inicialy O C H C kg cm? ?= ? ?   

 
[ ]2 2 4 26300 / 5100 / 50 % 30 % 60 /inicialu kg h O kg h C H kg h N=  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 83 

[ ]max 2 2 4 26900 / 5700 / 100 % 30, 02 % 95 /u kg h O kg h C H kg h N=  
 

[ ]min 2 2 4 25700 / 4500 / 0 % 29, 98 % 25 /u kg h O kg h C H kg h N=  
 

[ ]max 25 / / min 25 / / min 2 % / min 0, 01 % / min 10 / / minu kg h kg h kg h? =  
 
 

As figuras 5.2 e 5.3 apresentam a ‘resposta’ do processo para uma mudança na 

composição do gás de reciclo, subindo o teor de 2O  de 6, 5 %  para 6,8 %  ( 1
spy ) e 

reduzindo o teor de 2 4C H de 20 % para 19, 7 %  ( 2
spy ). Observa-se um desempenho 

similar para horizontes de controle 5m =  e 10m = . Notamos que a utilização de 

aproximações para as funções de transferência integradoras por funções de transferência 

estáveis torna a malha fechada bastante lenta, sendo necessário cerca de 300 min para 

que as controladas se aproximem dos valores desejados.  

 

Figura 5.2- Variação na composição do gás de reciclo : setpoints 1y  e 2y  

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 84 

Figura 5.3- Manipuladas para o caso servo em 1y  e 2y  

 

 

A figura 5.4 apresenta a função custo referente à mudança citada na composição 

do gás de reciclo.  

 

Observa-se pela figura que a função não é mais decrescente no tempo, pois, o 

modelo deixou de ser o nominal. Para enfatizar o comportamento não monotônico da  

função custo do controlador, são apresentadas duas figuras com escalas diferentes para 

3,kV . Vemos que embora essa função tende para zero para valores altos de tempo, em 

instantes intermediários ela passa por máximos e mínimos.  

 

Fica claro então que o IHMPC-E com modelos aproximados perde a propriedade 

de estabilidade. 

 

 

 

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 85 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
 
 
Figura 5.4- Função custo do caso servo em  1y  e 2y  
 

 

Para verificar o efeito do peso das variáveis de folga no desempenho do 

controlador IHMPC-E, mostramos na figura 5.5 para horizonte de controle 5m = , a 

comparação dos valores da matriz 1S  adotada originalmente, 
4

1 10 nyS I=  , com uma 

nova matriz 1S  dada por 1 800 nyS I= . Pode-se observar que o desempenho é bem 

parecido.  

 

Embora valores mais altos no peso, tendem a melhorar ligeiramente a 

performance do controlador, essa melhora não é suficiente para tornar o controlador 

mais rápido.  

 

 

 

 

 

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 86 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.5- Efeito do peso das variáveis de folga no desempenho do IHMPC-E 

 

 

A seguir, apresentamos nas figuras 5.6 e 5.7 as respostas do sistema com o 

IHMPC-E para uma mudança na temperatura do óleo térmico na entrada do reator. O 

valor de referência dessa variável passa de 251 oC  para 251, 5 oC  ( 3
spy ), mantendo os 

‘setpoints’ das demais controladas nos valores originais, ou seja, 1 6, 5 %
spy = , 

2 20 %
spy =  e 24 19, 5 /

spy kg cm= .  

 

Observamos novamente, um comportamento muito lento do controlador e 

semelhante aos casos anteriores, tanto para 5m =  como 10m =   : 

 

 

 

 

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 87 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.6- Variação na temperatura de óleo térmico : setpoint 3y  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.7 Manipuladas para o caso servo em 3y  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 88 

A figura 5.8 apresenta a função custo referente à mudança na temperatura do 

óleo térmico na entrada do reator. Observa-se novamente que a função não é mais 

decrescente no tempo, pois, o modelo deixou de ser o nominal :  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.8- Função custo do caso servo em 3y  

 

 

 

Nas figuras 5.9 e 5.10 são apresentadas as respostas do processo para uma 

alteração no ‘setpoint’ da pressão do gás de reciclo na entrada do reator. O valor de 

referência é alterado de 219, 5 /kg cm  para 220 /kg cm  ( 4
spy ), mantendo as demais 

controladas nos ‘setpoints’ originais, ou seja, 1 6, 5 %
spy = , 2 20 %

spy =  e 

3 251
sp oy C= . O desempenho do controlador continua semelhante aos casos anteriores. 

 

 

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 89 

Figura 5.9- Variação na pressão do gás de reciclo : setpoint 4y  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.10- Manipuladas para o caso servo em 4y  



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 90 

Faremos agora uma análise da performance do IHMPC-E de modelo 

aproximado para a rejeição de uma perturbação na vazão de oxigênio que tem a seguinte 

forma : em um dado instante, por uma necessidade qualquer de processo, a variável 

manipulada 1u  (vazão de 2O ) é desligada do controle preditivo, sendo a mesma 

aumentada em 200 /kg h , permanecendo nessa situação por 15  minutos. Após esse 

tempo, a variável 1u  é recolocada novamente como manipulada do controlador. É 

interessante notar que o cenário acima é operacionalmente equivalente a manter a 

variável 1u  sempre ligada no controle, mas com seus limites de máximo e mínimo, 

max
1u  e 

min
1u , alterados simultaneamente para um mesmo valor. 

 

As figuras 5.11 e 5.12 apresentam as variáveis controladas e manipuladas, 

mostrando que o controlador é capaz de rejeitar a perturbação. Apenas a pressão tem um 

comportamento demasiadamente lento mas ainda aceitável. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.11- Perturbação na vazão de oxigênio : variáveis controladas 

 

 



Capítulo 5 – Aplicação do IHMPC-E no controle de um sistema industrial complexo 91 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Figura 5.12- Perturbação na vazão de oxigênio : variáveis manipuladas 

 

 

 

  

 

 

 

 

 



 92 

Capítulo 6 

Conclusões e Recomendações 

 

6.1 Conclusões 
 

Os controladores preditivos existentes na literatura apresentam limitações de uso 

em processos integradores, os quais exibem resposta não-estacionária nas saídas frente 

ao degrau nas entradas. Um dos contornos para essa limitação é o truncamento da 

resposta ao degrau após um número finito de instantes. Essa abordagem, no entanto, 

acarreta um erro que pode instabilizar o processo em malha fechada. 

 

O presente trabalho teve seu enfoque principal no desenvolvimento de um 

algoritmo de controle preditivo de horizonte de predição infinito, nominalmente estável, 

para contemplar os processos que apresentam características integradoras. Esse 

algoritmo está baseado na representação em variáveis de estado na forma incremental 

das entradas, cuja abordagem também é bem escassa na literatura. Adicionalmente 

enfocou-se o caso real onde temos a presença de tempos mortos na função de 

transferência do processo. 

 

Demonstrou-se que o IHMPC-E é estável, independente da sintonia, para o caso 

nominal em sistemas observáveis. 

 

A aplicação do controlador de horizonte infinito para sistemas integradores foi 

ilustrada para dois processos industriais. O primeiro, uma coluna desisobutanizadora 

típica de uma refinaria de petróleo, foi simulado para o caso nominal e também para 

incertezas no modelo da planta. O segundo processo, um reator de oxidação catalítica de 

etileno, que exibe diferentes tempos mortos para as variáveis integradoras foi também 

estudado. Nesse caso, verificou-se que o modelo perfeito do processo não é observável 

e foi necessária a utilização de um modelo aproximado. Em ambos os casos foi usado o 

filtro de Kalman no controlador. 

 



Capítulo 6 – Conclusões e recomendações 
 
93 

O controlador IHMPC-E teve um bom desempenho no caso nominal da coluna 

deisobutanizadora como também nos casos incertos da coluna. Os resultados com o 

sistema de óxido de eteno foram apenas razoáveis. A escolha dos parâmetros de sintonia 

do IHMPC-E mostrou-se relativamente simples, praticamente não exigindo nenhum 

esforço adicional em relação aos parâmetros dos MPC’s convencionais de horizonte de 

predição finita existentes na literatura. 

 
 
6.2 Sugestões para trabalhos futuros 
 

Uma extensão natural deste trabalho seria o desenvolvimento de um MPC 

robusto para processos integradores com incerteza no modelo. Usando as idéias aqui 

apresentadas, acreditamos que o trabalho de Cano e Odloak (2003) possa ser estendido 

para sistemas que associem dinâmicas estáveis e integradoras, além da presença de 

tempos mortos. 

 

Uma sugestão adicional refere-se à necessidade de se desenvolver um ‘solver’ 

ou aperfeiçoar os solvers existentes para tratar com o problema de NLP específico desse 

controlador.  

 

Observamos que a rotina fmincon do MATLAB, utilizada nesse trabalho, tem 

uma performance insatisfatória tanto sob o aspecto de tempo computacional como sob o 

aspecto de confiabilidade, gerando frequentemente ‘ruídos’ dados por soluções 

indesejáveis sem significado físico algum, ou seja, entre instantes consecutivos, o solver 

chaveia sistematicamente algumas restrições ativas mesmo quando a função custo está 

bem próxima de zero, isto é, perto da condição estacionária do sistema em malha 

fechada. 

 

 

 



 94 

 

Referências Bibliográficas 
 

Astrom, K.J. e Wittenmark, B. (1990). Computer controled systems. Theory and Design 

Prentice-Hall  

Cano, R.A.R. e Odloak, D. (2003). Robust model predictive control of integrating 

processes. Journal of Process Control, v.13, p.101-114. 

Cano, R.A.R. (2001). Controle Robusto de Processos Químicos Integradores. 

Dissertação de Mestrado. EPUSP, São Paulo. 

Cutler, C. R. e Ramaker, B. L. (1979). Dynamic matrix control – a computer control 

algorithm. AIChE 86th  National Meeting, Houston, TX. 

Garcia, C. E. e Morshedi, A. M. (1986). Quadratic programing solution of dynamic 

matrix control (QDMC). Chem. Engng Commun., v.46, p.73-87. 

Gouvêa, M. T. e Odloak, D. (1997). ROSSMPC: A new way of representing and 

analysing the predictive controllers. Trans IchemE, v.75, Part A, p.693-708. 

Lee, J. H.; Morari, M. e Garcia, C. E. (1994). State space interpretation of model 

predictive control. Automatica, v.30, n.4, p.707-717. 

Lee, J. H. e Cooley, B. L. (2000). Min-Max Predictive control Techniques for a Linear 

State Space System with a Bounded Set of Input Matrices. Automatica, v.36,  

p.463-473. 

Lee, J. H. e Xiao, J. (2000). Use of two-stage optimization in model predictive control 

of stable and integrating systems. Computers Chem. Engng, v.24,  p.1591-1596. 

Li, S.; Lim, K. Y. e Fisher, D. G. (1989). A state space formulation for model predictive 

control. AIChE Journal, v.35, n.2, p.241-249. 

Luyben, W.L.; Tyreus, B.D.; e Luyben, M.L. (1999). Plantwide process control.            

Mc Graw-Hill.  

Moro, L. F. L. e Odloak, D. (1995). Constrained multivariable control of fluid cracking 

converters. Journal of Process Control, v.5, n.1, p.29-39. 

Odloak, D. (1996). A new state-space approach to model predictive control, Brazilian 

Journal of Chem. Engng, v.13, n.3, p.152-167. 

Rawlings, J.B e K.R Muske (1993). The stability of constrained multivariable receding 

horizon control. IEEE Trans. Autom. Cont., 38, p.1512-1516. 



Referências bibliográficas 
 
95 

 

Rodrigues, M. A. (2001). Estabilidade Robusta de Controladores Preditivos. Tese de 

Doutorado. EPUSP, São Paulo. 

Rodrigues, M. A. e Odloak D. (2000). Output feedback MPC with guaranteed robust 

stability. Journal of Process Control, december, v.10, n.6, p. 567-572. 

Rodrigues, M. A. e Odloak D. (2003). An infinite horizon model predictive control for 

stable and integrating processes. Computers Chem. Engng, v.27, p. 1113-1128. 

Rodrigues, M. A; Carrapiço,O.L.; Odloak D. e Moraes,R. (2004). Relatório do Projeto 

de Desenvolvimento de Controladores Avançados para Reator de Óxido de Etileno. 

Escola Politécnica da USP, abril. 

Sontag, E. D. (1998). Mathematical control theory. Springer-Verlag. 

Wu, K.L.; Yu, C.C.; Luyben, W.L. e Skogestad,S. (2003). Reactor/Separator Processes 

with recycles-2. Design for composition control Computers Chem. Engng,  v.27,  

n. 3 , p.401 - 421. 



 96 

Apêndice A 
 

A.1 Montagem matricial da predição das saídas ao longo do horizonte np  

 

Escrevendo as predições de forma recursiva até o instante de controle m , temos : 

 

èinstante 1k +   :   [ ] [ ]1 1k ky C x+ +=  
 
                                                  [ ]{ }( )kC A x B u k= + ?  
 
                                                  [ ] ( )kCA x CB u k= + ?  
 
 
èinstante 2k +   :   [ ] [ ]2 2k ky C x+ +=  
 
                                                  [ ]{ }1 ( 1)kC A x B u k+= + ? +  
 

                                                  [ ]{ }( ) ( 1)kC A A x B u k B u k? ?= + ? + ? +? ?  
 
                                                  [ ]2 ( ) ( 1)kCA x CAB u k CB u k= + ? + ? +  
 
 
èinstante 3k +  :   [ ] [ ]3 3k ky C x+ +=  
 
                                         [ ]{ }2 ( 2)kC A x B u k+= + ? +  
 
                                         [ ]{ }1 ( 1) ( 2)kC A A x B u k B u k+? ?= + ? + + ? +? ?   
 

                                         [ ]( ){ }( ) ( 1) ( 2)kC A A A x B u k B u k B u k? ?= + ? + ? + + ? +? ?   
 
                                         [ ]3 2 ( ) ( 1) ( 2)kCA x CA B u k CAB u k CB u k= + ? + ? + + ? +                                 
 
 
generalizando então até o horizonte de controle m , temos : 
 
èpara instantes de tempo j m?  : 
 
    [ ] [ ] 1 2( ) ( 1) ....... ( 1)j j jk j ky CA x CA B u k CA B u k CB u k j

? ?
+

= + ? + ? + + + ? + ?  

 



Apêndice A 97 

Para instantes acima do horizonte de controle, m j np&amp;lt;? , não existe mais ações 
de controle. Escrevendo recursivamente teremos : 
 
 
èinstante 1k m+ +  :  [ ] [ ]1 1k m k my C x+ + + +=   
 
       mas, com [ ] [ ]1 k mk mx A x ++ + =  temos 
 
      [ ] [ ]{ }1 21 ( ) ( 1) ... ( 1)m m mk m kx A A x A B u k A B u k B u k m? ?+ + = + ? + ? + + + ? + ?  
                   [ ]1 1( ) ( 1) ... ( 1)m m mkA x A B u k A B u k AB u k m

+ ?= + ? + ? + + + ? + ?  
 
       substituindo acima obtem-se : 
     
  [ ] [ ]1 11 ( ) ( 1) ... ( 1)

m m m
k m k

y CA x CA B u k CA B u k CAB u k m+ ?
+ +

= + ? + ? + + + ? + ?  
 
 
 
èinstante 2k m+ +  :  [ ] [ ]2 2k m k my C x+ + + +=   
 
       mas, com [ ] [ ]2 1k m k mx A x+ + + +=  temos 
 
    [ ] [ ]{ }1 12 ( ) ( 1) ... ( 1)m m mk m kx A A x A B u k A B u k AB u k m+ ?+ + = + ? + ? + + + ? + ?  
                 [ ]2 1 2( ) ( 1) ... ( 1)m m mkA x A B u k A B u k A B u k m

+ += + ? + ? + + + ? + ?  
 
       substituindo acima obtem-se : 
 
[ ] [ ]2 1 22 ( ) ( 1) ... ( 1)

m m m
k m k

y CA x CA B u k CA B u k CA B u k m+ +
+ +

= + ? + ? + + + ? + ?  
 
M  
 
 
èinstante k np+  :  [ ] [ ]

k np k np
y C x

+ +
=   

 
 
[ ] [ ] 1 2( ) ( 1) ... ( 1)np np np np m

k np k
y CA x CA B u k CA B u k CA B u k m? ? ?

+
= + ? + ? + + + ? + ?  

 
 
 
fazendo agora a generalização para instantes m j np&amp;lt;?  obtem-se : 
 
[ ] [ ] 1 2( ) ( 1) ... ( 1)j j j j mk j ky CA x CA B u k CA B u k CA B u k m

? ? ?
+

= + ? + ? + + + ? + ?  

 



Apêndice A 98 

 
Juntando as duas parcelas generalizadas da predição e representando na forma 

matricial, teremos :      

 

[ ]

1
2

2

1 2

1
1

1

1 2

0 0
0 ( )

( 1)
. .

.
. .

.
( 1)

k

k

m m
k

m m
np

k np
np

k np np np np mk

CB
y CA

CAB CB u k
y CA

u k
x CA B CA B CB

CA B CA B CAB
y CA

u k m
y CA

CA B CA B CA B

+

+

? ?

?
?

+ ?

+ ? ? ?

? ?
? ? ? ? ? ? ?? ? ? ? ? ?
? ? ? ? ? ? ? +
? ? ? ? ? ?

= +? ? ? ? ? ?
? ? ? ? ? ?
? ? ? ? ? ?
? ? ? + ?? ? ? ?

? ?? ? ? ?? ? ? ?? ?

L
L

M M O M
L
L

M M O M
L

? ?
? ?
? ?
? ?
? ?
? ?
? ?? ?

 

 

ou de forma compacta : 

 

[ ] [ ]
__

kk k
y C x C u

==

= + ?  

 

onde , 

 
__

2 TnpC CA CA CA? ?= ? ?L       ? R  np.ny  , ny+ne 

 

1 2

1

1 2

0 0
0

m m

m m

np np np m

CB
CAB CB

C CA B CA B CB
CA B CA B CAB

CA B CA B CA B

==
? ?

?

? ? ?

? ?
? ?
? ?
? ?
? ?

= ? ?
? ?
? ?
? ?
? ?? ?

L
L

M M O M
L
L

M M O M
L

 ? R  np.ny  ,  m.nu 

 

( )y k   ? R  np.ny                    
 

( / )x k k   ? R  (ny+ne)          
 

[ ]ku? ? R  m.nu  



Apêndice A 99 

A.2 Função Custo do Problema P4.1 na forma quadrática 

 

[ ] [ ]
__ __

1 1

T
sp sp

k k kk k
V C x C u y Q C x C u y

== ==? ? ? ?
= + ? ? + ? ?? ? ? ?? ? ? ?

%  

           [ ]{ } [ ]{ }~ ~*
T T

m m T
k k k kk k

A e AB u Q A e AB u u R u+ + ? + ? + ? ?%             

 
abrindo o primeiro termo da função custo : 

             

                 [ ] [ ]
__ __

1 1

T
sp sp

k kk k
C x C u y Q C x C u y

== ==? ? ? ?
+ ? ? + ? ? =? ? ? ?? ? ? ?

%  

                                 

[ ] [ ] [ ] [ ]

[ ]

[ ]

__ __ __ __

1

__

1

__

1 1 1 1

T T T
T T T sp

kk k k k

T T T
T T T sp

k k k kk

T T Tsp sp sp sp
kk

x C Q C x x C Q C u x C Qy

u C Q C x u C Q C u u C Qy

y Q C x y Q C u y Qy

==

== == == ==

==

= + ? ?

+ ? + ? ? ? ?

? ? ? +

% % %

% % %

% % %
                  

 
 
abrindo o segundo termo da função custo : 

 

                [ ]{ } [ ]{ }~ ~*
T T

m m T
k k k kk k

A e AB u Q A e AB u u R u+ ? + ? + ? ? =%  

                                                        

[ ] [ ] [ ]

[ ]

~
* *

~ ~ ~
* *

T TT Tm m m
kk k k

T T
T Tm

k k kk

T
k k

e A Q A e e A Q AB u

u AB Q A e u AB Q AB u

u R u

= + ?

+ ? + ? ?

+ ? ?%
 

 
 
Agrupando de forma adequada os termos, obtem-se : 
 
 

1
T

k k kV u H u= ? ?   ,12 f kC u+ ?      1c+  
 
onde 
 

          matriz Hessiana     
~ ~

*
1

T T

H C Q C AB Q AB R
== ==

= + +% %  

         [ ] [ ]
__ ~

*
,1 1

T
TT Tsp m

f k k
C x C Q C y Q C e A Q AB

== ==

= ? +% %  

         [ ] [ ] [ ] [ ] [ ]
__ __ __

*
1 1 11 2

T
T T TT Tsp sp sp m m

k k k k k
c x C Q C x y Q C x y Qy e A Q A e= ? + +% % %  

 



Apêndice A 100 

A.3 Função Custo do Problema P4.2 na forma quadrática 

 

[ ] [ ]
__ __ __ __

1 1

T
sp s sp s

k k k k kk k
V C x C u y I Q C x C u y I? ?

== ==? ? ? ?
= + ? ? ? + ? ? ?? ? ? ?? ? ? ?

%  

[ ]{ } [ ]{ }~ ~* 1
T T

Tm m T s s
k k k k k kk k

A e AB u Q A e AB u u R u S? ?+ + ? + ? + ? ? +%  

 
abrindo o 1º Termo : 

                [ ] [ ]
__ __ __ __

1 1

T
sp s sp s

k k k kk k
C x C u y I Q C x C u y I? ?

== ==? ? ? ?
+ ? ? ? + ? ? ? =? ? ? ?? ? ? ?

%  

[ ] [ ] [ ] [ ] [ ]

[ ]

[ ]

[ ]

__ __ __ __ __ __

1

__ __

1

__ __

1 1 1 1 1

__ __

T T T T
T T T Tsp s

k kk k k k k

T T T T
T T T Tsp s

k k k k k kk

T T T Tsp sp sp sp sp s
k kk

T
T Ts s

k kk

x C Q C x x C Q C u x C Qy x C Q I

u C Q C x u C Q C u u C Qy u C Q I

y Q C x y Q C u y Qy y Q I

I Q C x

?

?

?

? ?

==

== == == == ==

==

= + ? ? ?

+ ? + ? ? ? ? ? ?

? ? ? + +

? ?

% % % %

% % % %

% % % %

% __ __ __ __
1

T T T
T Ts sp s s

k k k kI Q C u I Qy I Q I? ? ?
==

? + +% % %

                  

 
 
abrindo o 2º Termo : 

[ ]{ } [ ]{ }~ ~* 1
T T

Tm m T s s
k k k k k kk k

A e AB u Q A e AB u u R u S? ?+ ? + ? + ? ? + =%  

                                                        

[ ] [ ] [ ]

[ ]

~
* *

~ ~ ~
* *

1

T TT Tm m m
kk k k

T T
T Tm

k k kk

TT s s
k k k k

e A Q A e e A Q AB u

u AB Q A e u AB Q AB u

u R u S? ?

= + ?

+ ? + ? ?

+ ? ? +%
 

 
Agrupando de forma adequada os termos :  
 

2 ,2 22 2
T k kT s

k k k fs s
k k

u u
V u H C c?

? ?

? ? ? ?? ?
? ?= ? + +? ? ? ?? ? ? ? ? ?? ? ? ?

 

onde  
 

matriz  Hessiana :             

__~ ~
*

2
__ __ __

1

T T T

T T

C Q C AB Q AB R C Q I
H

I Q C I Q I S

== == ==

==

? ?
+ + ?? ?= ? ?

? ?? +? ?

% %%

% %
 

[ ] [ ] [ ]
__ __ __ __~

*
,2 1 1

T T
T TT T Tsp m sp

f k k k
C x C Q C y Q C e A Q AB x C Q I y Q I

== ==? ?
= ? + ? +? ?

? ?
% % % %  

[ ] [ ] [ ] [ ] [ ]
__ __ __

*
1 1 12 1 2

T
T T TT Tsp sp sp m m

k k k k k
c c x C Q C x y Q C x y Qy e A Q A e

? ?? ?
= = ? + +? ?

? ?? ?
% % %  



Apêndice A 101 

A.4 Função Custo do Problema P4.3 na forma quadrática 

 

[ ] [ ]
__ __ __ __ __ __

1 1

T
sp s i sp s i

k k k k k k kk k
V C x C u y I T Q C x C u y I T? ? ? ?

== ==? ? ? ?
= + ? ? ? ? + ? ? ? ?? ? ? ?? ? ? ?

%  

[ ]{ } [ ]{ }~ ~* 1 2
T T

T Tm m T s s i i
k k k k k k k kk k

A e AB u Q A e AB u u R u S S? ? ? ?+ + ? + ? + ? ? + +%

 
 
 
 
abrindo o 1º Termo : 
 

[ ] [ ]
__ __ __ __ __ __

1 1

T
sp s i sp s i

k k k k k kk k
C x C u y I T Q C x C u y I T? ? ? ?

== ==? ? ? ?
+ ? ? ? ? + ? ? ? ? =? ? ? ?? ? ? ?

%  
 

[ ] [ ] [ ] [ ] [ ] [ ]

[ ]

[ ]

__ __ __ __ __ __ __ __

1

__ __ __

1

__

1 1 1 1

T T T T T
T T T T Tsp s i

k k kk k k k k k

T T T T T
T T T T Tsp s i

k k k k k k k kk

T T Tsp sp sp sp
kk

x C Q C x x C Q C u x C Qy x C Q I x C Q T

u C Q C x u C Q C u u C Qy u C Q I u C Q T

y Q C x y Q C u y Qy y

? ?

? ?

==

== == == == == ==

==

= + ? ? ? ?

+ ? + ? ? ? ? ? ? ? ?

? ? ? + +

% % % % %

% % % % %

% % %

[ ]

[ ]

__ __

1 1

__ __ __ __ __ __ __ __

1

__ __ __ __ __ __ __ __

1

T Tsp s sp i
k k

T T T T T
T T T T Ts s s sp s s s i

k k k k k k k kk

T T T T T
T T T T Ti i i sp i s i i

k k k k k k k kk

Q I y Q T

I Q C x I Q C u I Qy I Q I I Q T

T Q C x T Q C u T Qy T Q I T Q T

? ?

? ? ? ? ? ? ?

? ? ? ? ? ? ?

==

==

+

? ? ? + + +

? ? ? + + +

% %

% % % % %

% % % % %
   
 
 
 
 
abrindo o 2º Termo : 
 

[ ]{ } [ ]{ }~ ~* 1 2
T T

T Tm m T s s i i
k k k k k k k kk k

A e AB u Q A e AB u u R u S S? ? ? ?+ ? + ? + ? ? + + =%

 
                                  

                                                 

[ ] [ ] [ ]

[ ]

~
* *

~ ~ ~
* *

1 2

T TT Tm m m
kk k k

T T
T Tm

k k kk

T TT s s i i
k k k k k k

e A Q A e e A Q AB u

u AB Q A e u AB Q AB u

u R u S S? ? ? ?

= + ?

+ ? + ? ?

+ ? ? + +%
 

 
 



Apêndice A 102 

Agrupando de forma adequada os termos na forma quadrática :  
 
 

11 12 13

12 22 23 ,3 33

13 23 33

2

k k

T T TT s i s s
k k k k k f k

T T i i
k k k

u uH H H

V u H H H C c

H H H

? ? ? ?

? ?

? ? ? ?? ?? ?
? ? ? ?? ?? ?= ? + +? ? ? ?? ?? ? ? ? ? ?? ?

? ? ? ? ? ?? ? ? ?

 

 
 
onde 
 
 

~ ~
*

11

T T

H C Q C AB Q AB R
== ==

= + +% %               
__

12

T

H C Q I
==

= ? %                
__

13

T

H C Q T
==

= ? %  
__

12

T
TH I Q C

==

= ? %                                      
__ __

22 1

T

H I Q I S= +%               
__ __

23

T

H I Q T= %  
__

13

T
TH T Q C

==

= ? %                                      
__ __

23

T
TH T Q I= %                   

__ __

33 2

T

H T Q T S= +%  
 
 
 

[ ] [ ] [ ]
~

*
,3 1 1 1

T T T TT T TT sp T m T sp T sp
f kk k k

C x C Q C y Q C e A Q AB x C QI y QI x C QT y QT
== ==? ?= ? + ? + ? +? ?? ?

% % % % % %

 
 

 [ ] [ ] [ ] *3 12
T TT T sp T m m

k kk k k
c x C QC x y QC x e A Q A e= ? +% %  

 

 

 
 

 




</field>
	</doc>
</add>