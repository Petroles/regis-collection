<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20454</field>
		<field name="filename">4011_001009344.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL 

ESCOLA DE ENGENHARIA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

ENG07053 - TRABALHO DE DIPLOMAÇÃO EM 
ENGENHARIA QUÍMICA  

 

 

 

 

 

 

A n á l i s e  d e  e s t r u t u r a s  d e  
c o n t r o l e  a n t i g o l f a d a s  

a p l i c a d a s  à  p r o d u ç ã o  d e  
p e t r ó l e o  offshore  

 

 

 

 

 

 

 

Autora: Bárbara Isabel Santarossa 

Orientador: Prof. Dr. Marcelo Farenzena 

 

 

 

Porto Alegre, dezembro de 16 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore ii 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa iii 

Su má r i o  

1 Introdução 1 

2 Revisão Bibliográfica 2 

2.1 Elevação e produção de petróleo 2 

2.2 Golfadas 3 

2.2.1 Ciclo de golfadas severas 4 

2.3 Controle de golfadas 4 

2.4 Otimização em tempo real (RTO) 5 

2.5 Controle auto-otimizável 6 

2.5.1 Implementação do controle auto-otimizável 8 
2.5.2 Seleção de variáveis controladas 9 
2.5.3 Método do espaço nulo 9 

3 Metodologia 11 

3.1 Modelo simplificado 11 

3.2 Estruturas e estratégias de controle 13 

3.3 Controle auto-otimizável 15 

4 Resultados e discussões 17 

4.1 Sintonia do controlador 17 

4.1.1 Pressão de fundo pr,b como variável controlada 17 
4.1.2 Pressão de topo pr,t como variável controlada 19 
4.1.3 Massa específica média da mistura ??como variável controlada 21 
4.1.4 Fração de gás no riser ?g 23 

4.2 Otimização da produção de líquido 24 

4.2.1 Pressão de fundo pr,b 24 
4.2.2 Massa específica ?? 25 

4.3 Efeito da abertura da válvula choke 26 

4.4 Controle auto-otimizável (SOC) 29 

5 Conclusões e Trabalhos Futuros 31 

Referências 32 

Apêndice A 34 

  

 

 

 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore iv 

A gra d e c i me nto s  

Agradeço a meus pais por todo apoio que me deram para que eu chegasse até esta 
etapa. Por terem me incentivado em minhas escolhas e lutado para me oferecer as 
melhores condições. Por serem a estrutura sólida com quem posso sempre contar. 

Aos amigos que tornaram esta trajetória mais leve. 

Agradeço também à Universidade Federal do Rio Grande do Sul, sobretudo aos 
professores do Departamento de Engenharia Química, por terem me proporcionado uma 
formação de qualidade, apesar das dificuldades enfrentadas em nosso país. Meu 
agradecimento especial vai ao professor Marcelo Farenzena por ter me orientado na 
realização deste trabalho, por ter tido paciência e por sempre estar disponível a transmitir 
seu conhecimento e sanar dúvidas que surgiram ao longo do semestre. 

Por fim, agradeço a todos que de alguma forma me influenciaram a seguir adiante para 
concluir o curso.  

   

 

 

 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa v 

Re s u mo  

Os processos de extração de petróleo em alto mar apresentam um problema comum 
no escoamento multifásico das tubulações de transporte: o surgimento de golfadas. São 
ciclos intermitentes de produção geradores de instabilidade e que causam danos à 
plataforma, limitando sua produção.  

Visando estabilizar o fluxo num sistema de elevação simulado e otimizar a produção de 
petróleo, este trabalho trata do teste de estruturas de controle para o regime de golfadas. 
São avaliadas quatro estruturas de controle clássicas e uma estrutura de controle auto-
otimizável (SOC). Tal método emprega uma variável controlada cujo setpoint é mantido 
constante e mantém o sistema operando próximo ao ótimo, sem necessidade de reotimizar 
o processo na ocorrência de distúrbios. 

O controle de golfadas com parâmetros otimizados mostrou-se eficaz para duas 
variáveis controladas: a pressão de fundo do riser e a massa específica de saída. Foram 
obtidos incrementos de abertura de choke de 40% (ponto de bifurcação) a 
aproximadamente 100% em malha fechada, com operação estável, para ambos os casos. 
Já para o controle auto-otimizável nenhum resultado expressivo foi obtido, sendo 
necessário um aprimoramento no caso. 

 

 

 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore vi 

Li sta  d e  F i gu ra s  

Figura 2.1 : Estrutura de elevação de petróleo em alto mar. Adaptado de MEGLIO, DI et al. 
(2012). .................................................................................................................................... 3 

Figura 2.2: Mecanismo das golfadas em risers. Adaptado de HAN; GUO (2015). ................ 4 

Figura 2.3: Hierarquia de tomada de decisões numa planta industrial (DARBY et al., 2011)6 

Figura 2.4: Perda imposta por manter o setpoint constante para a variável controlada. 
Baseado em SKOGESTAD (2000). .......................................................................................... 7 

Figura 2.5: Implementação das variáveis controladas (SKOGESTAD, 2000). ........................ 8 

Figura 2.6: Diagrama de blocos do controle auto-otimizável. Adaptado de JOHANNES 
(2013). .................................................................................................................................... 8 

Figura 3.1: Descrição dos fluxos no riser proposto (MEGLIO, DI et al., 2012). ................... 11 

Figura 3.2: Diagrama de blocos da estrutura de controle implementada no caso em que a 
pressão de fundo pr,b é a variável controlada. .................................................................... 13 

Figura 3.3: Diagrama de blocos para a implementação do SOC em malha aberta. ............ 15 

Figura 4.1: Simulação das golfadas para a estrutura em malha aberta para uma abertura 
de 80% da válvula choke. .................................................................................................... 18 

Figura 4.2: Atuação do controlador PI sobre as golfadas, mostrando o impacto sobre a 
produção de líquido (acima), abertura da choke como MV (abaixo) e pr,b como CV (meio).
 ............................................................................................................................................. 19 

Figura 4.3: Simulação das golfadas em malha aberta, com 80% de abertura da válvula 
choke. .................................................................................................................................. 20 

Figura 4.4: Comportamento observado após a sintonia do controlador com pressão de 
topo como variável manipulada. ......................................................................................... 21 

Figura 4.5: Golfadas observadas para simulação em malha aberta com abertura de 80% da 
válvula de saída. .................................................................................................................. 22 

Figura 4.6: Resposta à ação do controlador em malha fechada para massa específica 
?mcomo variável controlada............................................................................................... 23 

Figura 4.7: Comportamento do sistema com fração mássica de gás como CV em malha 
aberta para abertura de 80% da choke. .............................................................................. 24 

Figura 4.8: Variáveis de saída com parâmetros otimizados, com saída de líquido (topo), CV 
(meio) e MV (abaixo). .......................................................................................................... 25 

Figura 4.9: Desempenho com parâmetros otimizados para massa específica como CV. ... 26 

Figura 4.10: Início das golfadas (ponto de bifurcação) para a produção de líquido (acima) e 
para a pressão de fundo (abaixo) em função da abertura da válvula. ................................ 28 

Figura 4.11: Ponto de bifurcação para a produção de líquido (acima) e massa específica 
(abaixo) em função da abertura da válvula. ........................................................................ 29 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa vii 

Li sta  d e  Ta b e l a s  

 
Tabela 3.1: Parâmetros de ajuste do modelo adaptados de MEGLIO, DI et al. (2012). ..... 14 

Tabela 4.1: Parâmetros de ajuste do controlador PI. .......................................................... 18 

Tabela 4.2: Parâmetros de ajuste do controlador PI. .......................................................... 20 

Tabela 4.3: Parâmetros de ajuste do controlador............................................................... 22 

Tabela 4.4: Valores otimizados para o sistema controlando pr,b. ....................................... 24 

Tabela 4.5: Resultados da otimização para o sistema com ?mcomo CV. ........................... 26 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore viii 

Li sta  d e  Sí mb o l o s  

 

a – abertura da válvula choke 

A – área da seção transversal da tubulação, m2 

c – combinação linear de variáveis 

Cg – constante linear da válvula virtual, m.s 

Cout – constante linear da válvula choke, m2 

cs – setpoint para a combinação linear de variáveis 

d – distúrbios 

F – matriz sensibilidade ótima 

f – restrições de igualdade 

g – aceleração da gravidade, m/s² 

g – restrições de desigualdade 

h – altura do riser, m  

H – matriz de constantes com os coeficientes das combinações lineares 

J – função custo 

Jopt – valor ótimo da função custo 

L – perda econômica  

M – massa molar do gás, kg/mol  

mg,eb – massa de gás na bolha alongada, kg  

mg,r – massa de gás no riser, kg 

ml,r – massa de líquido no riser, kg 

ml,still – massa mínima de líquido que permanece no riser, kg 

nu – número de graus de liberdade 

peb – pressão de gás na bolha alongada, Pa 

pr,b – pressão de escoamento no orifício da base da tubulação, Pa  

pr,t – pressão do gás no topo da coluna de elevação, Pa  

ps – pressão da estação separadora das fases, Pa 



DEQUI / UFRGS – Bárbara Isabel Santarossa ix 

Pw – pressão do reservatório, Pa  

R – constante universal dos gases,  J/(mol.K)  

T – temperatura do sistema, K 

u – variáveis independentes 

Veb – volume da bolha alongada, m³  

Vg,r – volume do gás no riser, m³  

Vr – volume total do riser, m3  

wg – taxa mássica de gás saindo da bolha alongada, kg/s  

wg,in – taxa mássica de gás proveniente do reservatório, kg/s  

wg,out – taxa mássica de gás saindo pela válvula choke, kg/s  

win – taxa mássica da mistura proveniente do reservatório, kg/s  

wl,in – taxa mássica de líquido proveniente do reservatório, kg/s 

wl,out – taxa mássica de líquido saindo pela válvula choke, kg/s  

wout – taxa mássica de produção na válvula choke, kg 

x – variáveis de estado 

y – variáveis disponíveis 

?g – fração mássica de gás no riser, adimensional 

? – fração de gás que entra, adimensional 

? – ângulo de inclinação da tubulação de elevação, adimensional 

?l – massa específica do líquido, kg/m3 

?m – massa específica da mistura líquido-gás, kg/m3 

 

 

 

 

 

 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore x 

Li sta  d e  A b re vi at u ra s  e  Si gl a s  

 

BPD – Barris de petróleo por dia  

CV – Variável controlada 

EDO – Equação diferencial ordinária 

GOR – Gas-oil ratio (razão entre gás e óleo do reservatório) 

IP – Índice de produtividade 

MPC – Model predictive control 

MV – Variável manipulada 

NCO – Necessary conditions of optimality 

PI – Proporcional/integral 

PID – Proporcional/integral/derivativo 

RTO – Otimização em tempo real (real-time optimization) 

SOC – Controle auto-otimizável (self-optimizing control) 

SP – setpoint 

 

 

 

 

 

 

 



DEQUI / UFRGS – Bárbara Isabel Santarossa 1 

1 Int ro d u çã o  

A demanda de petróleo está intimamente ligada à atividade econômica. Quanto maior 
a atividade econômica, mais crescerá a demanda, assim como a redução da atividade 
econômica implica menor demanda. Nesta perspectiva, o preço do barril de petróleo pode 
ser impulsionado a baixar e sua produção necessitará ser otimizada e ter seus custos 
reduzidos (KHAN, M. I. et al., 2017).  

No Brasil, a extração e produção de petróleo é feita em alto mar. O objetivo primordial 
de uma plataforma de petróleo é manter elevada ou aumentar a produção de petróleo. 
Todavia, um dos grandes problemas no sistema de elevação é o escoamento multifásico de 
petróleo nas tubulações. Isso pode ocasionar, dependendo das características do sistema 
de elevação e da mistura, um fenômeno indesejável: o escoamento em golfadas, marcado 
por oscilações de pressão e de produção de líquido dos sistemas de elevação. Tal fluxo 
intermitente acarreta limitação de produtividade, redução da segurança de operação e 
risco às instalações da plataforma. O controle antigolfadas é uma necessidade irrefutável 
para contornar tais problemas e evitar que mais perdas surjam a longo prazo.  

Buscam-se na engenharia soluções para maximizar a lucro da atividade petrolífera e 
obter o retorno do investimento realizado em pouco tempo. Com essa motivação, são 
propostas neste trabalho cinco estruturas de controle para um sistema de elevação de 
petróleo onde o fenômeno das golfadas é observado. Tal estudo é baseado em um modelo 
simplificado que representa a dinâmica do escoamento, cujo objetivo principal é a 
supressão do escoamento por golfadas, as quais são causadoras de instabilidade no 
sistema. Em conjunto com a estabilização do escoamento, uma rotina de otimização é 
implementada visando maximizar a saída de líquido, o que será responsável por determinar 
a lucratividade em um caso real. 

O estudo será estruturado em 5 capítulos. No Capítulo 2, é realizada uma revisão 
bibliográfica acerca dos assuntos abordados ao longo do trabalho referentes à extração de 
petróleo, problemas do escoamento nas tubulações, otimização e controle auto-
otimizável. No Capítulo 3, são apresentadas as metodologias utilizadas para chegar à 
solução do problema proposto. No Capítulo 4 são apresentados os resultados obtidos no 
controle de golfadas por otimização do processo. Por fim, no Capítulo 5, as conclusões 
referentes aos resultados observados e sugestões para trabalhos futuros são apresentados. 

 

 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 2 

2 Revi s ã o  B i b l i o g ráf i ca  

Este capítulo é destinado à compreensão dos conceitos de elevação de petróleo, o 
fenômeno das golfadas, seu controle e a otimização de tais processos. 

2.1 Elevação e produção de petróleo  

O petróleo é uma mistura de hidrocarbonetos de fase líquida que existe em 
reservatórios subterrâneos naturais. Os reservatórios que o contêm são chamados de 
armadilhas geológicas: o líquido é mantido sob pressão nessa formação geológica 
permeável e porosa com capacidade de armazenar fluidos (TZIMAS; GEORGAKAKI, 2005). 

A produtividade de um reservatório de petróleo ao longo do tempo está relacionada à 
manutenção de sua pressão. Naturalmente, ela tende a reduzir devido à aeração do 
reservatório causada pelos processos de extração e, quanto menor a pressão dentro do 
reservatório, mais comprometida estará sua produtividade. A perda de produtividade se 
torna crítica quando a pressão do reservatório cai a valores inferiores à pressão do ponto 
de bolha do líquido ali contido, pois o gás dissolvido no líquido não terá energia suficiente 
para expandir e impulsioná-lo e será necessário injetar artificialmente outro fluido que 
reduza a pressão do reservatório para realizar a extração (HUSSEIN K. ABDEL-AAL; 
MOHAMED A. AGGOUR, 2003). 

A extração de petróleo conta com três principais técnicas: extração primária, 
secundária e terciária, não necessariamente aplicadas nesta ordem. 

Na extração primária, o óleo escoa até a superfície por mecanismos naturais, utilizando-
se da energia do gás, da água ou de ambos. Os três principais mecanismos são: 
deslocamento pela camada de gás natural na parte superior do reservatório, em que a 
pressão resultante da expansão de gás natural impulsiona o fluido até a superfície; 
deslocamento pela expansão do gás dissolvido no petróleo; e deslocamento ascendente da 
água que se encontra abaixo da coluna de óleo. As técnicas de extração primária são 
aplicadas nas fases iniciais da produção de um reservatório e possuem uma recuperação 
de 5 a 10% da capacidade do poço (TZIMAS; GEORGAKAKI, 2005). 

Na extração secundária, que é empregada quando a extração primária não é mais viável 
(devido à queda na produtividade do reservatório), faz-se a injeção de fluidos – água, gás 
natural, dióxido de carbono, entre outros –  com o intuito de aumentar a pressão do 
reservatório e por conseguinte aumentar a produção. A recuperação média de petróleo 
para a extração secundária é entre 30 e 50%, mas foi relatado um fator próximo a 70% de 
recuperação no mar nórdico, conforme TZIMAS; GEORGAKAKI (2005). 

A extração terciária é feita no fim do ciclo de vida de um reservatório para manter a 
produção e gerar de 5 a 15% a mais da capacidade inicial do poço. Consiste em alterar as 
propriedades do óleo cru, por exemplo sua viscosidade, e as interações entre as rochas e o 
óleo do reservatório (TZIMAS; GEORGAKAKI, 2005). 

Na extração de petróleo em alto mar, uma mistura multifásica de óleo, gás e água é 
transportada dos reservatórios até o solo marinho através de poços de extração, cujos 
comprimentos podem atingir desde centenas de metros a quilômetros. A mistura 
multifásica de diversos poços é distribuída por oleodutos, conhecidos como flowlines, os 
quais se estendem por quilômetros ao longo do solo marinho em todo o campo de extração 
e ligam os poços ao riser de elevação. A mistura multifásica ascende à plataforma de 



DEQUI / UFRGS – Bárbara Isabel Santarossa 3 

superfície, onde será separada e tratada, através do riser, que também apresenta 
comprimento variando desde 100 metros a um quilômetro (JAHANSHAHI; SKOGESTAD; 
HELGESEN, 2012). Uma estrutura típica de elevação de petróleo offshore é representada 
na  Figura 2.1: 

 

Figura 2.1 : Estrutura de elevação de petróleo em alto mar. Adaptado de MEGLIO, DI et 
al. (2012). 

O comportamento do fluxo multifásico é bastante afetado pela geometria das 
tubulações, que adquirem a forma das irregularidades do solo marinho. Quando uma 
tubulação descendente é seguida de um riser, é provável a ocorrência de golfadas severas, 
assim chamadas devido à intensidade da projeção do líquido que sai da tubulação (HAN; 
GUO, 2015). 

2.2 Golfadas 

O regime de golfadas é um fluxo bifásico (ou trifásico) intermitente que ocorre 
predominantemente em reservatórios de petróleo maduros. É causado pela distribuição 
não homogênea das fases líquida e gasosa nas tubulações. Bolhas alongadas percorrem a 
tubulação, separadas por slugs (golfadas) de líquido, responsáveis por causar amplas 
variações de vazão e pressão na tubulação. Devido à diferença de massa específica e de 
viscosidade das fases líquida e gasosa, estas não têm a mesma velocidade de escoamento 
na tubulação, o que causa o fenômeno (MEGLIO, DI et al., 2012). 

Nas tubulações de transporte, a fase líquida tende a acumular em pontos de baixa 
elevação, devido à irregularidade do terreno, o que pode bloquear a passagem de gás. Em 
baixas vazões, esse bloqueio leva à formação de um regime de golfadas chamado “golfadas 
de terreno”. Se o ponto de baixa elevação se localiza próximo à base do riser e o tamanho 
das golfadas tem dimensão comparável ao tamanho do riser, têm-se as “golfadas severas” 
ou riser-slugging, caracterizadas por variações oscilatórias na pressão e vazão 
(JAHANSHAHI; SKOGESTAD; HELGESEN, 2012).  

Além das golfadas severas, existem outros tipos de golfadas, como as hidrodinâmicas, 
de cabeceio de anular (casing-heading) e as transientes (JAHANSHAHI, 2013) porém este 
estudo será direcionado às golfadas severas por serem mais impactantes que as golfadas 
hidrodinâmicas. 

Como consequências indesejáveis das golfadas, destacam-se: o dano causado aos 
equipamentos de extração devido às variações de vazão e pressão; na saída, longos 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 4 

períodos sem produção de líquido ou gás seguido de picos de fluxo quando a golfada de 
líquido está sendo gerada, o que é uma problemática no processo de separação; 
desligamento de emergência da plataforma devido ao alto nível de líquido nos 
separadores; inundações, corrosão e danos aos equipamentos; altos custos de 
manutenção. Todos esses problemas causam perdas elevadas na indústria petrolífera 
(SAUSEN, A.; SAUSEN, P.; CAMPOS, 2012). 

2.2.1 Ciclo de golfadas severas 

O ciclo das golfadas severas consiste em quatro etapas: formação de golfadas, 
produção ou transporte ao separador, descarga de gás e recuo de líquido, as quais são 
ilustradas na Figura 2.2 juntamente com suas variações de pressão no riser. Na etapa 1 
(formação), a ação da gravidade faz com que o líquido se acumule no ponto de mínimo do 
sistema tubulação-riser e a velocidade de gás e líquido é baixa, o que permite esse tipo de 
acúmulo. Na etapa 2, denominada produção, o líquido bloqueia o fluxo de gás e uma 
golfada contínua de líquido é produzida no riser e, a menos que a coluna hidrostática de 
líquido no riser aumente mais rápido que a queda de pressão no sistema tubulação-riser, a 
golfada continua a aumentar. Na etapa 3 (descarga de gás) a golfada é expelida do sistema, 
porque a diferença de pressão ao longo do riser supera a coluna hidrostática de líquido no 
riser. Na etapa 4 (recuo de líquido) a velocidade do gás não é mais alta o suficiente para 
arrastar o líquido para cima e então o líquido retorna ao riser, reiniciando o processo de 
acúmulo de líquido (SAUSEN, A.; SAUSEN, P.; CAMPOS, 2012). 

 
Figura 2.2: Mecanismo das golfadas em risers. Adaptado de HAN; GUO (2015). 

2.3 Controle de golfadas  

Uma vez que o comportamento oscilatório do regime de golfadas é indesejável nas 
tubulações de transporte de petróleo offshore, convém a implementação de uma solução 
para o fenômeno. Segundo JAHANSHAHI; SKOGESTAD; HELGESEN (2012), soluções usuais 
são a manipulação da abertura da válvula de produção e a instalação de slug catchers – 
unidades onde as golfadas são armazenadas, permitindo ao gás expandir-se e reduzir a 
velocidade do líquido – após a válvula de produção. O controle da válvula de produção é a 
estratégia recomendada, a qual é chamada de controle antigolfadas. Nesse sistema de 
controle, medidas como pressão, vazão ou massa específica do fluido são tipicamente as 
variáveis controladas e a abertura da válvula de topo é a variável manipulada. 



DEQUI / UFRGS – Bárbara Isabel Santarossa 5 

Na prática, os sistemas atuais de controle antigolfadas não são robustos e mesmo com 
a malha fechada é comum que o comportamento instável continue. Isso se deve à 
ocorrência de distúrbios no fluxo de entrada das tubulações e também por mudanças na 
planta (JAHANSHAHI; SKOGESTAD; HELGESEN, 2012). 

Em JAHANSHAHI; SKOGESTAD (2011), o controle em malha feedback é suficiente para 
prevenir as golfadas e utiliza-se um modelo dinâmico simplificado com quatro estados, o 
qual foi comparado com os resultados de controlabilidade de outros cinco modelos 
disponíveis na literatura. É sugerido combinar a pressão de fundo e a vazão de saída de 
líquido para obter melhor performance e robustez.  

Um sistema de elevação por gas-lift é analisado em JAHANSHAHI; SKOGESTAD; HANSEN 
(2012), para o caso de golfadas do tipo casing-heading. A análise de controlabilidade é feita 
para diferentes candidatas a variável controlada (pressão de fundo, pressão de topo, fração 
volumétrica de líquido e taxa mássica de líquido na saída) e duas variáveis manipuladas 
(abertura da válvula de produção e abertura da válvula de entrada de gas-lift), sendo a 
pressão de fundo a variável controlada que produziu melhores resultados de 
controlabilidade, porém ela não é diretamente medida: é estimada por medições de topo. 
A adição de uma segunda variável manipulada, a válvula de entrada de gas-lift, não 
melhorou a estabilidade do sistema. 

Em termos de controlabilidade, observou-se que a pressão de fundo do sistema de 
elevação foi a melhor variável a ser escolhida, porém esta em alguns casos não é 
diretamente medida. A alternativa, com resultados expressivos no controle de golfadas, foi 
controlar a pressão de topo do sistema. As candidatas a variável controlada foram a vazão 
mássica do gás de elevação, a pressão de topo do reservatório de gas-lift, a pressão de topo 
da coluna de produção, a vazão mássica de produto, a massa específica da mistura na saída 
da coluna e a fração volumétrica de líquido na coluna. 

A pressão de fundo do sistema de elevação também é controlada em AAMO et al. 
(2005), mas não é diretamente medida. Ela é estimada por equações do modelo com base 
em medições de pressão do topo da tubulação, dispensando a instalação de sensores no 
fundo da tubulação. 

Em SAUSEN, A.; SAUSEN, P.; CAMPOS (2012), é sugerido o controle do nível do 
separador das fases líquida e gasosa , o qual está localizado na saída do riser. Esta solução 
conta com um modelo de cinco EDOs, também fazendo uso da válvula de saída como 
variável manipulada. A estratégia de controle foi capaz de atenuar as variações do fluxo em 
golfadas. É proposto como pesquisa futura manipular simultaneamente mais de uma 
válvula no sistema de elevação. 

2.4 Otimização em tempo real (RTO) 

Uma estrutura típica da hierarquia de decisões numa planta é evidenciada na 
Figura 2.3, onde cada bloco representa uma camada de controle. As variáveis controladas 
interligam as camadas de controle, através das quais a camada superior processa o valor 
da variável controlada a ser implementado na camada inferior (SKOGESTAD, 2000). 

O planejamento decide “o que e como fazer”; a programação decide “quando fazer”; 
RTO é a otimização em tempo real; MPC é o controle preditivo baseado em modelo e o 
controle regulatório é a principal interface para controlar e monitorar o processo. As 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 6 

camadas inferiores - RTO, MPC e controle regulatório - operam em malha fechada, 
representada pela linha cheia, e em tempo real; já no planejamento e programação a 
atualização dos modelos não é automática e é efetuada de forma descontínua, 
representada por linhas tracejadas (DARBY et al., 2011). 

 

Figura 2.3: Hierarquia de tomada de decisões numa planta industrial (DARBY et al., 2011) 

A operação economicamente ótima está vinculada a uma estrutura que utiliza um 
modelo online: a otimização em tempo real, RTO. O sistema de RTO é operado em malha 
fechada e é responsável por criar uma conexão entre o controle regulatório e o MPC, onde 
a cada distúrbio ocorrido os setpoints das variáveis controladas são atualizados para que a 
unidade opere em seu ponto ótimo (ENGELL, 2007; DARBY et al., 2011). 

A RTO é constituída de um modelo não linear estático. Esse modelo é atualizado a cada 
ciclo para minimizar o desvio entre as variáveis do modelo e as medidas da planta, 
juntamente com o ajuste dos parâmetros do modelo. É através da RTO que se atinge a 
operação verdadeiramente ótima. 

A principal razão para a RTO ser implementada é a variabilidade do ponto de operação 
ótimo, causada por mudanças nas condições de operação, diferentes matérias-primas, 
restrições variáveis e mudanças de preço de matérias-primas e produtos. Se a variabilidade 
for pequena, não há necessidade de implementar uma rotina de RTO, e em tal caso pode 
ser utilizada uma rotina offline, já que o custo da RTO é considerável (DARBY et al., 2011). 

O tempo entre duas iterações sucessivas da RTO deve ser tal que garanta o estado 
estacionário da planta (DARBY et al., 2011). Para realizar esse tipo de otimização, é preciso 
ter um modelo estacionário do processo com boa precisão. Caso contrário, o resultado da 
otimização pode não ser o ponto ótimo verdadeiro. Outro ponto a ser abordado é que o 
sistema de otimização não atua nos períodos de transição entre dois pontos de operação 
estacionários, configurando uma perda enquanto o ponto ótimo não é atingido (SCHULTZ, 
2015). 

2.5 Controle auto-otimizável 

SKOGESTAD (2000) criou o conceito do “controle auto-otimizável”, definido como um 
controle em que valores constantes de setpoints das CVs são implementados baseados em 
critérios econômicos, sem a necessidade de reotimizar o processo quando distúrbios 
ocorrerem. Essa nova ideia se apresenta como uma alternativa à otimização em tempo real 



DEQUI / UFRGS – Bárbara Isabel Santarossa 7 

(RTO), pois para atingir o ótimo operacional verdadeiro é necessário um modelo perfeito, 
todos os distúrbios devem ser medidos e o problema de otimização, dinâmico, deve ser 
resolvido online. A proposta é uma estratégia de fácil implementação e de operação 
satisfatória, ainda que admita uma perda. 

A perda econômica L é definida pela equação (2.1) e ilustrada na Figura 2.4, sendo J a 
função custo,  ????  o valor ótimo de J, isto é, o custo minimizado da operação, que advém 

da solução do RTO e d* o distúrbio no ponto nominal de operação: 

 L=J-Jopt (2.1) 

 

Figura 2.4: Perda imposta por manter o setpoint constante para a variável controlada. 
Baseado em SKOGESTAD (2000). 

Um aspecto a ser observado é que no controle auto-otimizável sempre haverá um erro 
de implementação, causado por erros de medição. Além do erro de implementação, é 
possível que haja uma perda adicional causada pela superfície de otimização. Assim sendo, 
os problemas de otimização podem ser classificados em três classes quanto à sua 
implementação, segundo SKOGESTAD (2000), demonstrados na Figura 2.5: 

? Otimização com restrições: não apresenta perda por manter o setpoint da 
variável controlada constante e igual ao seu valor mínimo ou máximo. Nesse 
caso implementar uma restrição ativa é uma tarefa fácil, como manter uma 
válvula fechada, por exemplo. 

? Ótimo sem restrições com superfície plana: o valor da variável controlada não 
afeta o custo, ou seu impacto é pequeno, e a implementação é fácil. 

? Ótimo sem restrições com superfície aguda: o valor da variável controlada afeta 
o custo, e a implementação é difícil. Para este caso sugere-se outra variável 
controlada em que a superfície do ótimo seja a mais plana possível. Quanto mais 
abrupta a superfície do ponto ótimo, maior será o erro de implementação. 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 8 

 

Figura 2.5: Implementação das variáveis controladas (SKOGESTAD, 2000). 

Segundo SKOGESTAD (2000), manter uma função c no setpoint cs manipulando as 
variáveis u para os distúrbios d significa que o processo está operando no estado 
estacionário ideal. 

O esquema de funcionamento da estrutura de controle auto-otimizável é ilustrado na 
Figura 2.6, onde está evidenciado o uso de uma malha feedback. H é uma matriz ótima para 
os distúrbios do processo e sua forma de obtenção será esclarecida na Seção 2.5.3. 

 

Figura 2.6: Diagrama de blocos do controle auto-otimizável. Adaptado de JOHANNES 
(2013). 

2.5.1 Implementação do controle auto-otimizável 

A implementação da operação ótima segue duas etapas (JOHANNES, 2013): 

? Controle das variáveis correspondentes às restrições ativas em seus pontos de 
operação ótimos. 

? Controle de variáveis auto-otimizadas para os graus de liberdade 
remanescentes. 

Através de um controlador simples, como PI ou PID em malha fechada, implementa-se 
o SOC. Isso não configura nenhum custo adicional para o processo, já que a maioria das 
indústrias dispõe de sistemas de controle e não será necessária a aquisição de softwares 
adicionais para realizar a otimização. O controlador atua continuamente, mesmo no regime 
transiente, rejeitando os distúrbios que venham a surgir, o que é uma vantagem em relação 
à RTO estática. Nesta, dependendo da dinâmica do sistema, a RTO pode passar longos 



DEQUI / UFRGS – Bárbara Isabel Santarossa 9 

períodos sem atuar e isso faz com que a unidade opere longe do ponto ótimo (SCHULTZ, 
2015). 

2.5.2 Seleção de variáveis controladas 

As variáveis controladas ideais são aquelas que, ao ser mantido o setpoint constante, 
minimizam a perda do processo na ocorrência de distúrbios. Há quatro requisitos para a 
escolha de variáveis controladas (SKOGESTAD, 2000): 

? O valor ótimo da variável não deve ser sensível a distúrbios do processo, a fim 
de que a perda L seja minimizada. 

? A variável deve ser fácil de medir e de controlar, de modo a reduzir o erro de 
implementação. 

? A variável deve ser sensível a mudanças no valor da variável manipulada, 
apresentando um grande ganho em relação à CV. A superfície do ótimo deve 
ser plana em relação à CV. 

? Para o caso de duas ou mais variáveis controladas, elas devem ser 
independentes. 

Há sete etapas para a implementação do controle auto-otimizável: 

1. Identificação do número de graus de liberdade; 

2. Definição da função custo e restrições; 

3. Identificar os principais distúrbios, que podem ser erros de otimização, distúrbios 
durante a operação e erros de implementação das CVs; 

4. Otimização: resolver o problema de otimização e gerar uma tabela com os pontos 
nominais ótimos para outras variáveis além de u; 

5. Identificar candidatas a variável controlada; 

6. Avaliar a perda em relação à operação verdadeiramente ótima, a qual exige um 
modelo perfeito, que seria obtida pela RTO; 

7. Análise e seleção de CVs. 

2.5.3 Método do espaço nulo 

O Método do Espaço Nulo proposto por ALSTAD; SKOGESTAD  (2007) define a existência 
de nu combinações lineares de c que não variam na presença de distúrbios d. Combinando 
um número de variáveis igual ao número de graus de liberdade, a variável c representa as 
combinações lineares das medições y e é definida como: 

 c = Hy (2.2) 

 c ? Rnu  (2.3) 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 10 

onde H é a matriz ótima obtida para os distúrbios e a função sensibilidade ótima F em 
relação aos distúrbios: 

 F=
?yopt

?d
 (2.4) 

em que y representa as candidatas a variáveis de controle e yopt seu valor ótimo. A matriz 
ótima H deve satisfazer: 

 HF=0 (2.5) 

H é obtida no espaço nulo à esquerda de F e posteriormente obtém-se c na equação 
(2.2). Controlar c =Hy  resulta em uma operação ótima com perda aproximadamente nula, 
com o valor ótimo para c independente em relação a d e considerando o erro de 
implementação negligenciável. 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa 11 

3 Meto d o l o gi a  

Neste capítulo é apresentado o modelo tido como base para a representação do 
escoamento no sistema de elevação e a metodologia utilizada para o controle de golfadas. 

3.1 Modelo simplificado 

As golfadas foram reproduzidas utilizando-se o modelo dinâmico estudado por 
MEGLIO, DI et al. (2012) no riser de elevação. O modelo considera uma seção de tubo, 
sujeita a um fluxo bifásico de gás e de líquido, conforme ilustrado na Figura 3.1: 

 

Figura 3.1: Descrição dos fluxos no riser proposto (MEGLIO, DI et al., 2012). 

No modelo estudado são consideradas constantes as entradas de líquido e de gás, wl,in 
e wg,in respectivamente, de forma a torná-lo menos complexo. Entretanto, visando tornar 
o modelo mais realista e permitir que o incremento de produção fosse considerado, neste 
trabalho entendeu-se que tais vazões são melhor representadas de acordo com 
JAHANSHAHI; SKOGESTAD; HANSEN (2012): 

 wg,in=GOR.win (3.1) 

 ??,?? = (1 ?  ???). ??? (3.2) 

 ??? = ??. max (?? ?  ??,?, 0) (3.3) 

onde GOR é a razão mássica entre gás e óleo, IP o índice de produtividade do reservatório, 
?? a pressão do reservatório e ??? a taxa mássica total que entra no riser. 

A saída é controlada pela válvula choke. Além disso, nesse modelo é proposta uma 
válvula virtual, através da qual é possível modelar a irregularidade do fluxo de gás, o qual 
pode acumular e formar uma bolha alongada. Esta bolha ocasiona um aumento de pressão 
e gera um fluxo instável conhecido como golfada. 

As equações diferenciais do balanço de massa que descrevem o modelo do riser são 
descritas a seguir: 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 12 

 m?g,eb(t) = (1-?)wg,in- wg(t)  (3.4) 

 m?g,r(t) = ?wg,in + wg(t) - wg,out(t) (3.5) 

 m?l,r(t) = wl,in- wl,out(t) (3.6) 

As variáveis de estado são a massa de gás na bolha alongada ??,??, a massa de gás no 

riser ??,? e a massa de líquido no riser ??,?. Ainda, ??,?? e ??,?? representam as massas de 

entrada de gás e de líquido no riser e ??,??? e ??,??? as massas de saída de gás e de líquido, 

respectivamente. ?? é a massa de gás saindo da bolha alongada e entrando no riser. A 

fração de gás que entra no volume de controle é denotada ?, podendo assumir valores de 
0 a 1; o complementar dessa fração fica aprisionado no fundo do riser como ??? (volume 
da bolha alongada), causando incremento de pressão. 

As pressões ao longo do sistema, ???, ??,? e ??,? representam a pressão da bolha 
alongada, pressão no topo do riser e a pressão de fundo, respectivamente, e são calculadas 
considerando que o gás nesse sistema se comporta como gás ideal.  

 peb= 
mg,ebRT

MVeb
 (3.7) 

 pr,t= 
mg,rRT

M(Vr-(ml,r+
ml,still

?l
))

 (3.8) 

 pr,b= pr,t+ (ml,r+ ml,still)
gsin?

A
 (3.9) 

onde M é a massa molar do gás, ?? o volume do riser (??=A.L), ml,still a massa mínima de 
líquido que permanece no riser, ?? a massa específica de líquido, ? a inclinação média da 
tubulação, L o comprimento do riser e A a área da seção transversal. Assume-se 
temperatura constante em toda tubulação. 

As massas de gás, de líquido e total são calculadas como wg, wg,out, wl,out e wout: 

 wg= Cgmax (0,(peb-pr,b)) (3.10) 

 wout =  Couta ??mmax (0, pr,t ? ps) (3.11) 

 wl,out= 
ml,r

ml,r+ mg,r
 wout?  wout (3.12) 

 wg,out =   
mg,r

ml,r+ mg,r
 wout ?   

mg,r

ml,r
wout (3.13) 

onde ?? é a massa total de gás que passa pela válvula virtual e ??é a constante desta 

válvula, assumida constante; ???? é a massa total que passa pela válvula choke, cuja 
constante é dada por ???? e abertura a. Em ambas equações, não é admitido refluxo para 
o sistema, fazendo-se o uso da função máximo nas vazões. ??, constante, é a pressão no 
separador de fases. 



DEQUI / UFRGS – Bárbara Isabel Santarossa 13 

3.2 Estruturas e estratégias de controle 

O conjunto de equações foi simulado através de uma s-function em ambiente Simulink 

do MATLAB®. Inseriu-se um controlador PI, cujos parâmetros de ajuste foram obtidos na 
estrutura em malha aberta, sendo o setpoint para a variável controlada calculado como a 
média entre os valores máximo e mínimo de golfada para todo o intervalo de simulação, 
utilizando a função média do MATLAB. A inserção de um controlador PID seria inviável, pois 
o ruído na leitura de medições é elevado em instalações marinhas. A variável manipulada 
é a abertura da válvula choke e quatro variáveis controladas foram testadas: a pressão de 
fundo do riser ??,?, a massa específica média da mistura ??, a pressão de topo ??,?, e a 
fração mássica de gás no riser ?g. A outra saída do sistema dinâmico é a taxa mássica de 
líquido ??,???.  

A escolha das variáveis controladas baseia-se nos estudos de JAHANSHAHI; 
SKOGESTAD; HANSEN (2012), sendo pr,t e pr,b medidas diretamente no topo e na base do 
riser, respectivamente. ?? e ?g são calculadas indiretamente, sendo o controle na prática 
feito pela combinação de variáveis de topo da coluna (pressão, temperatura e volume). No 
estudo mencionado, pr,b é a CV que resulta em melhor performance, pois apresentou 
elevado ganho em estado estacionário. 

Para representar o modelo estudado, foram inseridas duas entradas para a s-function, 
entre elas a taxa de gas-lift que seria injetado no reservatório de petróleo. Todavia essa 
influência não foi avaliada, mantendo-a no valor absoluto zero em todas as simulações, 
conforme ilustra a Figura 3.2, onde a cópia da tela do Simulink é mostrada. 

A abertura da válvula choke deve assumir valores entre 0 e 1 e para garanti-lo foi 
inserido um bloco de saturação. Por tratar-se de um sistema rígido, todas as simulações 
foram realizadas com o integrador implícito ODE23S. Foi assumido bias=0,15 baseando-se 
em GEREVINI (2014). 

 

Figura 3.2: Diagrama de blocos da estrutura de controle implementada no caso em que a 
pressão de fundo pr,b é a variável controlada. 

Os parâmetros de simulação utilizados para representar o modelo do riser encontram-
se na Tabela 3.1: 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 14 

Tabela 3.1: Parâmetros de ajuste do modelo adaptados de MEGLIO, DI et al. (2012). 

Parâmetro Descrição Valor Unidade 

R Constante dos gases ideais 8,314 J/mol.K 

T Temperatura do reservatório 363 K 

M Massa molar do gás 0,022 kg/mol 

?l Massa específica do líquido 900 kg/m3 

g Aceleração da gravidade 9,81 m/s2 

? Ângulo de inclinação do riser ?/4 rad 

D Diâmetro do tubo 0,15 m 

A Área da seção transversal 1,77x10-2 m2 

ps Pressão da estação de separação 6,6x105 Pa 

L Comprimento do riser 5200 m 

? Fração de gás na entrada 0,78 - 

Cout Constante da válvula choke 2,8x10-3 m2 

Cg Constante da válvula virtual 10-4 m.s 

Veb Volume da bolha alongada 48 m3 

ml,still Massa mín. de líquido no riser 3,73x10-4 kg 

Pw P do reservatório 1,8x107 Pa 

GOR Razão gás/líquido 0,0652 kgg/kgl 

IP Índice de produção do reservatório 1,09x10-5 kg/Pa.s 

 

Objetivando maximizar a produção de líquido wl,out, foi resolvido um problema de 
otimização cujas variáveis de decisão são os parâmetros de ajuste do controlador e seu 
setpoint, sujeito a uma operação não golfante. Foi resolvido um problema de busca local 
sem restrições, usando-se a função fminsearch do MATLAB. A função objetivo é a produção 
de líquido, cuja direção de busca é o máximo. Para detalhes do código utilizado, o leitor 
deve consultar o Apêndice A. 

A função objetivo utilizada é representada por: 

 FO= média(wl,out)+0,1variância(wl,out) (3.14) 

onde o peso da variância permite chegar em regiões não golfantes durante a rotina de 
otimização e teve ajuste manual, o qual foi selecionado a partir de simulações com 
diferentes pesos a fim de avaliar qual permitiria chegar na região desejada, não golfante. 

Para o cálculo dos parâmetros do controlador utilizados como chute inicial no problema 
de otimização, utilizou-se a estrutura em malha aberta e aplicou-se um degrau de 
magnitude pequena na abertura da válvula choke, em operação não-golfante, isto é, entre 
0 e 40% de abertura. Escolheu-se o método de Síntese Direta para o ajuste, por ser de fácil 
implementação, com ganho Kc dado por pela equação (3.15). Kp é o ganho do processo e a 
constante de tempo integral (?I), igual à constante de tempo do processo, é o tempo 
necessário para atingir 63% da resposta final na resposta ao degrau (? do processo). 

 Kc=
4

Kp
?   (3.15) 



DEQUI / UFRGS – Bárbara Isabel Santarossa 15 

3.3 Controle auto-otimizável 

A implementação do controle auto-otimizável consistiu em obter um conjunto de 
combinações lineares c para obter os setpoints cs das variáveis controladas: 

 c = Hy (3.16) 

em que H é uma matriz constante e y as medições disponíveis. 

Foi criado um diagrama de blocos no Simulink para implementar o controle auto-
otimizável, representado na Figura 3.3: 

 

Figura 3.3: Diagrama de blocos para a implementação do SOC em malha aberta. 

Conforme definição do método, foi assumido estado estacionário e que os distúrbios 
afetam a operação apenas no estado estacionário. Também se assumiu que não há erro de 
implementação devido à ação integral do controlador. Escolheram-se variáveis controladas 
fáceis de serem medidas e controladas como a pressão de topo, pressão de fundo e massa 
específica da mistura, além de serem sensíveis à abertura da choke, variável manipulada. 
A pressão de fundo é medida por um sensor instalado na base do riser e a pressão de topo 
por um sensor no topo do riser, mas a massa específica é calculada obtendo-se 
previamente valores de pressão e temperatura no topo do sistema de elevação. 

Para obter H, foi preciso previamente obter a matriz de sensibilidade F. Ela foi obtida 
numericamente realizando pequenas perturbações nos distúrbios, e yopt é o valor ótimo 
das medições das saídas: 

 ?yopt= yopt(d+?d)-yopt(d) (3.17) 

 F=
?yopt

?d
 (3.18) 

 F = 

[
 
 
 
 
?y1

opt

?d1
…

?y1
opt

?dnd
… … …

?yny
opt

?d1
…

?yny
opt

?dnd ]
 
 
 
 

 (3.19) 

Com F gerada, obteve-se a matriz H pela função Null do MATLAB® e as combinações 
lineares foram calculadas pela equação (3.16). Elas devem ser mantidas num valor fixo cuja 
base são os valores ótimos das candidatas a CV pressão de fundo e massa específica, sendo 
a MV a abertura da choke. Assim, o setpoint para o sistema é dado por: 

 copt=Hyopt (3.20) 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 16 

onde ???? é uma matriz constituída por valores em que as saídas representadas na 

Figura 3.3 têm valores estabilizados para uma pequena abertura da válvula choke. 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa 17 

4 Re s u l ta d o s  e  d i s c u s s õ e s  

Neste capítulo serão apresentados os resultados referentes às estruturas de controle 
para supressão das golfadas no sistema de elevação. O capítulo está dividido em três 
partes:  

? Sintonia do controlador: são apresentados os ajustes em malha aberta que 
serão utilizados como chutes iniciais para o problema de otimização;  

? Otimização da produção de líquido utilizando variáveis controladas tradicionais; 

? Análise de estrutura de Controle auto-otimizável (SOC). 

4.1 Sintonia do controlador   

A fim de avaliar a possibilidade de controlar outra variável de saída além da pressão de 
fundo proposta por MEGLIO, DI et al. (2012), foram realizadas três tentativas de mudança 
da variável controlada: pressão de topo, massa específica da mistura e fração de gás no 
riser. Tais variáveis já haviam sido estudadas como CVs em JAHANSHAHI; SKOGESTAD; 
HANSEN (2012) . Para isso, a saída foi alterada na s-function de cada uma delas e a estrutura 
de controle permaneceu análoga à da Figura 3.2.  

Os ajustes em malha aberta foram feitos com um pequeno degrau aplicado na abertura 
da válvula choke, compreendido no intervalo de aberturas que antecedem a ocorrência de 
golfadas, isto é, de 0 a 40% de abertura.  

4.1.1 Pressão de fundo pr,b como variável controlada 

Para uma abertura da válvula choke de 80% em malha aberta, obteve-se o 
comportamento das golfadas tanto para pressão de fundo como para a produção de 
líquido. Além disso, conforme será mostrado na Seção 4.3, existe uma abertura de choke a 
partir da qual o escoamento se dá por golfadas e o valor de abertura usado está 
compreendido nesta faixa. 

A partir do gráfico da pressão de fundo da Figura 4.1, calculou-se o setpoint para o 
controlador: 1,674x107 Pa. Observa-se que os picos de produção de líquido estão 
associados à queda repentina de pressão de fundo do riser, pois o gás que é descarregado 
impulsiona o líquido, conforme explicado na Seção 2.2. 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 18 

 

Figura 4.1: Simulação das golfadas para a estrutura em malha aberta para uma 
abertura de 80% da válvula choke.  

 A Tabela 4.1 mostra os parâmetros de sintonia do controlador PI aplicados à estrutura 
em malha fechada e utilizados como chute inicial no problema de otimização. Já a 
Figura 4.2: retrata a resposta em malha fechada do sistema utilizando-se esses parâmetros, 
avaliando a produção de líquido, sendo a CV pressão de fundo e a MV abertura da choke. 
Nota-se que a pressão de fundo é uma variável que respondeu ao ajuste e apresenta boa 
característica servo, com variância de 2,71x10-4 Pa2 entre o setpoint e o valor convergido. 
A taxa mássica de produção de líquido ficou estabilizada em 13,75 kg/s. 

Tabela 4.1: Parâmetros de ajuste do controlador PI. 

Parâmetro Valor Unidade 

Kc -3,68x10-6 Pa-1 

?I 150 s 

Setpoint 1,67x107 Pa 

 



DEQUI / UFRGS – Bárbara Isabel Santarossa 19 

 

Figura 4.2: Atuação do controlador PI sobre as golfadas, mostrando o impacto sobre a 
produção de líquido (acima), abertura da choke como MV (abaixo) e pr,b como CV (meio). 

4.1.2 Pressão de topo pr,t como variável controlada 

A segunda variável a ser estudada é a pressão à montante da choke (pr,t), cuja 
disponibilidade é maior que a pressão de fundo. Foi feita a simulação em malha aberta para 
esta nova variável controlada e obteve-se o setpoint para o controlador: 6,97x105Pa. A 
resposta em malha aberta é ilustrada na Figura 4.3, onde se verifica padrão de golfada 
distinto em relação a pr,b: a pressão de topo é medida logo antes da válvula choke, então 
quanto maior a pressão nesse ponto mais líquido passará pela válvula.  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 20 

 

Figura 4.3: Simulação das golfadas em malha aberta, com 80% de abertura da válvula 
choke. 

Os parâmetros utilizados na sintonia do controlador são mostrados na Tabela 4.2. 
Como observado na Figura 4.4, a pressão de topo mostrou-se uma variável de difícil 
controle, visto que não eliminou as golfadas.  

Tabela 4.2: Parâmetros de ajuste do controlador PI. 

Parâmetro Valor Unidade 

Kc -3,72x10-6 Pa-1 

?I 830 s 

Setpoint 6,97x105 Pa 

 



DEQUI / UFRGS – Bárbara Isabel Santarossa 21 

 

Figura 4.4: Comportamento observado após a sintonia do controlador com pressão de 
topo como variável manipulada. 

4.1.3 Massa específica média da mistura ??como variável controlada 

Novamente, para uma abertura de 80% da válvula choke a estrutura em malha aberta 
foi simulada utilizando-se agora a massa específica ??, a qual foi calculada como: 

 ?m=
mg,r+ml,r

Vr
=[

kg

m3
] (4.1) 

O comportamento desta variável em malha aberta está ilustrado na Figura 4.5. 
Observa-se padrão de golfadas semelhante à estrutura com a CV pr,b da Seção 4.1.1: 
enquanto a massa específica aumenta, a taxa de produção de líquido se mantém em valor 
mínimo e atinge o máximo quando ?? tem seu menor valor, pois é quando ocorre a 
descarga de gás no riser. 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 22 

 

 Figura 4.5: Golfadas observadas para simulação em malha aberta com abertura de 
80% da válvula de saída. 

 A partir da resposta a um degrau de pequena magnitude na variável manipulada, 
foram ajustados os parâmetros do controlador, conforme a Tabela 4.3. O resultado pode 
ser visto na Figura 4.6. 

Apesar da choke apresentar uma abertura elevada, de 98,1%, onde seria mais suscetível 
a ocorrência de golfadas, a variável controlada e a taxa de produção de líquido mantiveram-
se estabilizadas em 39,4 kg/m3 e 14,88 kg/s respectivamente. 

Tabela 4.3: Parâmetros de ajuste do controlador. 

Parâmetro Valor Unidade 

Kc -0,19 m3/kg 

?I 200 s 

Setpoint 39,4 kg/m3 



DEQUI / UFRGS – Bárbara Isabel Santarossa 23 

 

Figura 4.6: Resposta à ação do controlador em malha fechada para massa específica 
?mcomo variável controlada. 

4.1.4 Fração de gás no riser ?g 

Também foi simulada em malha aberta a estrutura com a fração de gás no riser como 
CV, conforme a Figura 4.7. 

 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 24 

 

Figura 4.7: Comportamento do sistema com fração mássica de gás como CV em malha 
aberta para abertura de 80% da choke. 

Após provocar um degrau de pequena magnitude na abertura da válvula choke, não 
houve resposta ao degrau e não foi possível calcular os parâmetros do controlador. Esta CV 
teve de ser desconsiderada, já que não seria possível controlá-la. 

4.2 Otimização da produção de líquido 

O objetivo principal de uma plataforma de petróleo é maximizar a produção de líquido. 
Desta forma, buscou-se maximizar a saída de líquido, wl,out, já que o retorno financeiro é 
diretamente proporcional a esta variável. 

O referido problema foi resolvido para as três variáveis controladas previamente 
descritas, porém apenas para pressão de fundo e massa específica o desempenho do 
controlador foi satisfatório, isto é, houve supressão efetiva das golfadas. Portanto serão 
exibidos apenas os resultados para essas variáveis controladas, já que para a pressão de 
topo não foram obtidas soluções significativas, com performance similar à estrutura em 
malha aberta. 

4.2.1 Pressão de fundo pr,b 

Foi entregue ao otimizador como chute inicial os parâmetros Kc, ?I e setpoint da 
Tabela 4.1 e os parâmetros otimizados são mostrados na Tabela 4.4. 

Tabela 4.4: Valores otimizados para o sistema controlando pr,b. 

Parâmetro Valor Unidade 

Kc -3,91x10-6 Pa-1 

?I 151 s 

Setpoint 1,663 x107 Pa 

Wl,out 13,99 kg/s 

 



DEQUI / UFRGS – Bárbara Isabel Santarossa 25 

O comportamento do sistema frente aos valores otimizados é evidenciado na 
Figura 4.8. Observa-se um comportamento adequado das saídas frente à ação do 
controlador. A abertura da choke convergiu para 0,98 e a pressão de fundo para 
1,663x107 Pa, com variância de 754,83 Pa2 entre o setpoint e o valor convergido. O valor da 
abertura da válvula próximo a 1 gera um maior diferencial de pressão entre reservatório e 
superfície e acarreta maior saída de líquido, o que é benéfico para uma plataforma de 
petróleo.  

 

Figura 4.8: Variáveis de saída com parâmetros otimizados, com saída de líquido (topo), CV 
(meio) e MV (abaixo). 

Verificou-se manualmente o valor mínimo possível de setpoint de pressão que 
resultasse numa operação livre de golfadas. Obteve-se o valor de 1,663x107 Pa, que resulta 
na produção de 13,96 kg/s de líquido (equivalente a 8864 BPD), apresentando pouca 
diferença (0,21%) em relação ao valor obtido por otimização, que é 13,99 kg/s (equivalente 
a 8882 BPD). 

4.2.2 Massa específica ?? 

Considerando a massa específica da mistura, o problema de otimização foi resolvido 
utilizando-se os valores de Kc, ?I e setpoint da Tabela 4.3 como chute inicial, obtendo-se os 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 26 

valores da Tabela 4.5 . A variância do setpoint na faixa estabilizada é 1,03x10-5 (kg/m3)2 e a 
média do setpoint 39,15 kg/m3. Conforme a Figura 4.9, apesar da válvula encontrar-se 
próxima à abertura máxima, o sistema mantém-se estável no tempo de simulação 
considerado. Todavia o sistema estudado é bastante sensível a distúrbios e na 
eventualidade de sua ocorrência prevê-se o surgimento de golfadas. 

Tabela 4.5: Resultados da otimização para o sistema com ?mcomo CV. 

Parâmetro Valor Unidade 

Kc -0,12   m3/kg 

?I 196,28   s 

Setpoint 39,15 kg/m3 

Wl,out 14,01 kg/s 

 

 

Figura 4.9: Desempenho com parâmetros otimizados para massa específica como CV. 

4.3 Efeito da abertura da válvula choke 

A abertura da válvula choke é a principal responsável pelo aumento da produção de 
líquido e também pelo escoamento oscilatório, aqui representado por golfadas. Sua 
abertura causa aumento da diferença de pressão entre a base do riser e o reservatório, 



DEQUI / UFRGS – Bárbara Isabel Santarossa 27 

impulsionando a saída de fluidos. Desta forma, buscou-se avaliar o comportamento da 
variável controlada em função da abertura da válvula para cada um dos quatro sistemas de 
controle, bem como a influência da abertura na taxa de saída de líquido, considerando a 
operação sob a atuação do controlador PI, em comparação com o sistema em malha 
aberta. 

O comportamento das variáveis controladas pressão de fundo e massa específica e a 
saída de líquido correspondente a cada uma delas são plotados na Figura 4.10 e na 
Figura 4.11, respectivamente. Elas foram construídas ponto a ponto, sendo os valores 
máximo, mínimo e médio obtidos nas estruturas em malha aberta, em que foram 
fornecidos os valores de abertura de válvula do intervalo de 0 a 1. Os valores otimizados 
da variável controlada e produção de líquido obtidos na estrutura em malha fechada, 
representados pela linha tracejada, são a resposta otimizada de ajuste do controlador, 
conforme já apresentado na Figura 4.8 e na Figura 4.9. 

No sistema com a pressão de fundo como CV, cujo diagrama de bifurcação é mostrado 
na Figura 4.10, observa-se o surgimento do ponto de bifurcação para uma abertura de 
válvula de aproximadamente 40%, a partir do qual passa a haver produção por golfadas, 
representadas pelo desprendimento das linhas azuis e por sua média na linha vermelha. Já 
a atuação do controlador sobre o escoamento em golfadas é evidenciada pela linha 
tracejada; a válvula inicia a simulação totalmente aberta (vide Figura 4.8) e é 
repentinamente fechada a 40% sob a atuação do controlador, ponto que foi considerado 
aqui para a demonstração do resultado obtido. 

A solução com controlador fornece uma taxa menor de produção contra a taxa média 
por golfadas a partir de uma abertura de 48% (14 kg/s a 17 kg/s, respectivamente), então 
neste caso é mais vantajoso operar com o regime em golfadas do que em malha fechada, 
mas será necessário dispor de slug catchers para o armazenamento do líquido após a 
passagem pela choke. Para a faixa de abertura de 40% a 48%, é preferível operar o sistema 
em malha fechada, pois a saída de líquido é constante e maior que a taxa média de 
produção em golfadas (13 kg/s contra 11 kg/s aproximadamente).  

 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 28 

Figura 4.10: Início das golfadas (ponto de bifurcação) para a produção de líquido (acima) 
e para a pressão de fundo (abaixo) em função da abertura da válvula. 

Os diagramas de bifurcação para a CV massa específica são ilustrados na Figura 4.11. 
Nota-se o surgimento do ponto de bifurcação para uma abertura de 30% da válvula, a partir 
do qual ocorrem as golfadas. Também são representados os picos máximo e mínimo de 
produção, a média das golfadas e o comportamento frente à atuação do controlador com 
parâmetros otimizados. 

Em termos comparativos, no modelo simplificado de JAHANSHAHI; SKOGESTAD; 
HELGESEN (2012), o ponto de bifurcação surge a partir de uma abertura de 5% da válvula 
choke, o que significa que o escoamento está mais comprometido pelas golfadas do que 
nesta situação. Já no modelo de MEGLIO, DI et al. (2012) a abertura máxima da choke para 
um escoamento livre de golfadas é 27%. Em ambos está sendo considerada a pressão de 
fundo como CV. 

Analisando a Figura 4.11, verifica-se que a solução controlada apresentou maiores 
valores de massa específica a partir de uma abertura de válvula de aproximadamente 67%, 
implicando menor taxa de produção de líquido comparada à produção média por golfadas: 
14,5 kg/s e 19 kg/s aproximadamente. Este último é o valor médio máximo que pode ser 
atingido, com válvula totalmente aberta.  

Portanto, para aberturas de válvula compreendidas na faixa entre 30% e 57%, 
aproximadamente, convém utilizar o sistema controlado, pois verificou-se uma saída maior 
de líquido em relação à operação em golfadas. A partir da abertura de 57%, opta-se pela 
produção em golfadas com a condição de que um slug catcher esteja posicionado na saída 
da choke da mesma forma que para a pressão de fundo como variável controlada. 



DEQUI / UFRGS – Bárbara Isabel Santarossa 29 

Figura 4.11: Ponto de bifurcação para a produção de líquido (acima) e massa específica 
(abaixo) em função da abertura da válvula. 

4.4 Controle auto-otimizável (SOC) 

A implementação do SOC implicou no uso de três saídas: pressão de fundo, pressão de 
topo e massa específica. O distúrbio estudado foi a pressão do reservatório Pw. Para síntese 
da estrutura SOC, utilizou-se o conceito do espaço nulo, sendo que a matriz de sensibilidade 
foi computada para as três variáveis controladas já estudadas, por perturbação. Essa 
escolha de distúrbio reside no fato de que um dos fatores que mais influenciam na queda 
da produtividade de um reservatório de petróleo ao longo do tempo é a queda da pressão 
do reservatório causada pelos processos de extração. 

O distúrbio foi aplicado até o surgimento das golfadas. Assim, a matriz F obtida foi: 

 F= [
-1,01998 x 10-5

-1,566 x 10-5

-2,83 x 10-6
] (4.2) 

 A partir de F obteve-se uma combinação linear c das quatro variáveis como CVs, 
conforme a equação (4.3), gerando o setpoint de 1,41 ? 107. 

 c = [
-0,8285
0,55422
-0,0806

] [

 pr,b
 ?m
 pr,t

] (4.3) 

A aplicação deste setpoint não gerou a supressão das golfadas e foi refeita a 
estrutura de controle usando apenas duas saídas: as CVs que apresentaram melhor 
desempenho da Seção 4.1. 

As novas matrizes obtidas F e c foram: 



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 30 

 F= [
-1,01998 x 10-5

-1,566 x 10-5
] (4.4) 

 c = [
-0,8379
0,5458

] [
 pr,b
 ?m

] (4.5) 

O novo setpoint calculado da mesma forma foi 1,47x107. Não ocorreu estabilização 
do fluxo, mesmo com a otimização do ganho, constante de tempo e setpoint calculados 
na estrutura em malha aberta. Desta forma, conclui-se que o SOC não foi uma solução 
eficaz e a estrutura de controle simples foi superior a este método para o caso avaliado. 
Isso pode ter ocorrido por um distúrbio não identificado ou um ajuste equivocado na 
linearização do sistema, ou mesmo por limitação do método para o modelo estudado.  

 
 

  



DEQUI / UFRGS – Bárbara Isabel Santarossa 31 

5 C o n c l u s õ e s  e  Tra b a l h o s  F u t u ro s  

Neste trabalho foram propostas soluções de controle para o problema do escoamento 
em golfadas em uma estrutura de elevação de petróleo. Em quatro malhas feedback com 
um controlador PI, com variável manipulada sendo a abertura da válvula choke e variável 
controlada pressão de fundo, pressão de topo, massa específica da mistura e fração de gás 
no riser, cada sistema foi simulado individualmente. Outro sistema de controle envolveu o 
SOC, onde as saídas foram acopladas. Para a geração do escoamento em golfadas, serviu-
se de um modelo simplificado disponível na literatura. 

O controle de golfadas para a malha feedback em que as CVs foram massa específica e 
pressão de fundo foi eficiente tanto para evitar o surgimento de tal oscilação quanto para 
manter uma saída de líquido considerável, de 14 kg/s para ambos os casos. Nos casos em 
que as CVs foram pressão de topo e fração mássica de gás no riser, o mesmo 
comportamento não foi observado e as golfadas não foram suprimidas. Desta forma, estas 
duas últimas variáveis não podem ser aplicadas como CVs separadamente. 

Foi comparada a operação em malha fechada com a operação em malha aberta, 
golfante, para as duas CVs em que o controle foi eficiente. A operação em malha fechada 
mostrou-se vantajosa apenas em uma faixa de abertura da válvula choke. Para a CV massa 
específica foi possível manter a saída de líquido mais elevada que a produção em golfadas 
manteria por um intervalo maior de abertura de válvula que para o caso da CV pressão de 
fundo. Logo elege-se a massa específica como variável a ser controlada, sendo possível 
trabalhar com aberturas elevadas da choke e alternando entre produção em malha fechada 
e por golfadas, contanto que haja equipamentos adicionais tão logo a mistura passe pela 
válvula. 

O controle auto-otimizável não forneceu resultados significativos. A variável controlada 
não se manteve no setpoint calculado e as golfadas não foram suprimidas. 

Para trabalhos futuros, outros modelos para as golfadas podem ser testados, como o 
também simplificado modelo de JAHANSHAHI; SKOGESTAD (2011) e compará-lo com o 
modelo adotado neste trabalho. Outras variáveis podem ser manipuladas, como a válvula 
de fundo da tubulação do riser e a massa de líquido que entra no volume de controle. 
Podem ser testadas outras variáveis controladas, como fração e vazão de líquido na 
corrente de saída, combinadas ou não. Outros distúrbios além da pressão do reservatório 
podem ser estudados, como a razão gás-óleo (GOR) e o ruído de medição.  

 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 32 

Refe rê n c i a s  

AAMO, O. M. et al. Observer design for multiphase flow in vertical pipes with gas-lift - 
theory and experiments. Journal of process control, 2005. v. 15, n. 3.  

ALSTAD, V.; SKOGESTAD, S. Null space method for selecting optimal measurement 
combinations as controlled variables. Industrial and engineering chemistry research, 2007. 
v. 46, n. 3, p. 846–853.  

DARBY, M. L. et al. Rto: an overview and assessment of current practice. Journal of 
process control, 2011. v. 21, n. 6, p. 874–884.  

ENGELL, S. Feedback control for optimal process operation. Journal of process control, 
2007. v. 17, n. 3, p. 203–219.  

GEREVINI, G. Análise e controle da dinâmica de escoamento em poços de petróleo por 
gas-lift .Trabalho de conclusão de curso. Departamento de Engenharia Química. UFRGS. 
2014. 

HAN, P.; GUO, L. Numerical simulation of terrain-induced severe slugging coupled by 
hydrodynamic slugs in a pipeline–riser system. International journal of heat and fluid flow, 
2015. v. 56, p. 355–366.  

HUSSEIN K. ABDEL-AAL, MOHAMED A. AGGOUR, M. A. F. Petroleum and gas field 
processing. [S.l.]: [s.n.], 2003.  

JAHANSHAHI, E. Control solutions for multiphase flow: linear and nonlinear approaches 
to anti-slug control. Norges teknisk-naturvitenskapelige universitet, Fakultet for 
naturvitenskap og teknologi, Institutt for kjemisk prosessteknologi, 2013. Disponível em: 
&lt;https://brage.bibsys.no/xmlui/handle/11250/248592&gt;. Acesso em: 21 nov. 2016.  

JAHANSHAHI, E; SKOGESTAD, S. Simplified dynamical models for control of severe 
slugging in multiphase risers. Ifac proceedings volumes, 2011. v. 44, n. 1, p. 1634–1639.  

JAHANSHAHI, E; SKOGESTAD, S ; HANSEN, H. Control structure design for stabilizing 
unstable gas-lift oil wells. Ifac proceedings volumes, 2012. v. 45, n. 15, p. 93–100.  

JAHANSHAHI, E; SKOGESTAD, S.; HELGESEN, A. H. Controllability analysis of severe 
slugging in well-pipeline-riser systems. Ifac proceedings volumes, 2012. v. 45, n. 8, p. 101–
108.  

JÄSCHKE, J.; SKOGESTAD, S. Nco tracking and self-optimizing control in the context of 
real-time optimization. Journal of process control, 2011. v. 21, n. 10, p. 1407–1416.  

JOHANNES, J. Using process data for finding self-optimizing controlled variables ?. 
2013. p. 451–456.  

KHAN, M. I. et al. 2014 oil plunge: causes and impacts on renewable energy. Renewable 
and sustainable energy reviews, 2017. v. 68, p. 609–622.  

MEGLIO, F. DI et al. Stabilization of slugging in oil production facilities with or without 
upstream pressure sensors. Journal of process control, 2012. v. 22, n. 4, p. 809–822. 
Disponível em:&amp;lt;http://dx.doi.org/10.1016/j.jprocont.2012.02.014&gt;.  



DEQUI / UFRGS – Bárbara Isabel Santarossa 33 

SAUSEN, A.; SAUSEN, P.; CAMPOS, M. De. The slug flow problem in oil industry and pi 
level control. 2012. Disponível em:&amp;lt;http://cdn.intechopen.com/pdfs-wm/40523.pdf&gt;.  

SCHULTZ, Eduardo dos Santos. A importância do ponto de operação nas técnicas de 
self-optimizing control. 2015. 128 f. Tese (Mestrado em Engenharia Química) – 
Departamento de Engenharia Química, Universidade Federal do Rio Grande do Sul. 2015. 

SKOGESTAD, S. Plantwide control: the search for the self-optimizing control structure. 
Journal of process control, 2000. v. 10, n. 5, p. 487–507.  

TZIMAS, E.; GEORGAKAKI, A. Enhanced oil recovery using carbon dioxide in the 
european energy system. [S.l.]: [s.n.], 2005.  

VAZQUEZ, O.; FURSOV, I.; MACKAY, E. Automatic optimization of oilfield scale inhibitor 
squeeze treatment designs. Journal of petroleum science and engineering, 2016. v. 147, 
p. 302–307. Disponível em:&amp;lt;http://dx.doi.org/10.1016/j.petrol.2016.06.025&gt;. 

  



Análise de estruturas de controle antigolfadas aplicadas à produção de petróleo offshore 34 

A p ê n d i c e  A  

Neste apêndice consta o código utilizado na otimização dos parâmetros do controlador 
e da produção de líquido para a variável manipulada massa específica da mistura. Para as 
demais CVs foi utilizada a mesma rotina, apenas mudando as variáveis de decisão do 
problema. 

function vr = varprod5(param) 

  
%maximizar a vazao de líquido 
assignin('base','Kc',param(1)) 
assignin('base','Ti',param(2)) 
assignin('base','sp',[0 param(3)]) 

  
sim('modelomegliodensidade',20000) 

  
vr = -mean(vazao.signals.values(1000:end)) + 

0.1*var(vazao.signals.values(1000:end)); 
end 

 

%%[z fval] = fminsearch(@varprod5,[Kc Ti sp(2)]) 


</field>
	</doc>
</add>