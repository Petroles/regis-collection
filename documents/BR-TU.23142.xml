<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.23142</field>
		<field name="filename">7220_Dissertacao_ALVARO_MARCELO_ACEVEDO_PENA.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
ALVARO MARCELO ACEVEDO PEÑA 

 

 

 

 

 

 

 

Avaliação de técnicas de decomposição para a otimização em tempo real de 

uma unidade de produção de propeno 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

São Paulo 

(2015) 



ALVARO MARCELO ACEVEDO PEÑA 

 

 

 

 

 

 

 

Avaliação de técnicas de decomposição para a otimização em tempo real de 

uma unidade de produção de propeno 

 

 

 

 

 

 

Dissertação apresentada à Escola 
Politécnica da Universidade de São Paulo 
para obtenção do título de Mestre em 
Ciências 
 
 
 
Orientador: Prof. Dr. Galo Carrillo Le Roux 

 

 

 

 

São Paulo 

(2015) 



ALVARO MARCELO ACEVEDO PEÑA 

 

 

 

 

 

 

 

Avaliação de técnicas de decomposição para a otimização em tempo real de 

uma unidade de produção de propeno 

 

 

 

 

 

 

Dissertação apresentada à Escola 
Politécnica da Universidade de São Paulo 
para obtenção do título de Mestre em 
Ciências 
 
 
Área de Concentração: Engenharia 
Química 
 
 
Orientador: Prof. Dr. Galo Carrillo Le Roux 

 

 

 

São Paulo 

(2015) 



 

 

Este exemplar foi revisado e corrigido em relação à versão original, sob 

responsabilidade única do autor e com a anuência de seu orientador. 

 

São Paulo,      de janeiro de 2015. 

 

 

Assinatura do autor   ____________________________ 

 

 

Assinatura do orientador   _______________________ 

 

 

 

 

 

 

 

 

 

 

 

 

Catalogação-na-publicação 

  
 
 
Acevedo Peña, Alvaro Marcelo 

Avaliação de técnicas de decomposição para a otimização 
em tempo real de uma unidade de produção de propeno / A.M. 
Acevedo Peña. – versão corr. -- São Paulo, 2015. 

117 p. 
 

Dissertação (Mestrado) - Escola Politécnica da Universidade   
de São Paulo. Departamento de Engenharia Química. 
 

1.Tempo real (Otimização) 2.Otimização econômica 3.Técni- 
cas de decomposição 4.Refinarias de petróleo I.Universidade de 
São Paulo. Escola Politécnica. Departamento de Engenharia 
Química II.t. 

 



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A minhas avós, Yolanda (in memoriam) e 

Juana, que contribuíram diretamente na 

minha formação como pessoa, sempre 

com amor incondicional, e que sempre 

torceram pela realização de meus 

objetivos.   Vocês estão no meu coração. 



AGRADECIMENTOS 

 

Aos meus pais, Carlos e Gioconda, pelo carinho, amor e dedicação  durante todos 

os anos da minha vida e que sempre me deram exemplos de honestidade, 

responsabilidade e amor. Sem vocês nada disto teria sido possível. Agradeço 

também aos meus irmãos, Gonzalo e Carlos, pelo apoio incondicional. 

Ao Prof. Galo Carrillo Le Roux, pela orientação deste trabalho, por acreditar no meu 

potencial como profissional e pela  oportunidade de participar do projeto RTO. 

Agradeço a José Luís, Gabriela, Nicole, Eliana e Lourdes, minha família no Brasil, 

por todo o apoio e por me fazer sentir em casa. 

A Gabriela Burgulla, pelo apoio, companheirismo e sobretudo pela paciência, força e 

amor que me dá dia a dia para superar os todos os obstáculos. 

A Bruno Faccini, pela revisão de português desta dissertação e a José Otavio e 

David, pelos conselhos na redação. 

Aos professores Ardson dos Santos, Darci Outloak, Jorge Gut e doutores Marcel 

Joly, Antonio Carlos Zanin e Lincoln Moro pela dedicação na leitura da dissertação e 

pelas sugestões de melhorias dadas tanto durante o exame de qualificação quanto 

durante a defensa. 

E por último, mas não por isso menos importante, agradeço a todos meus amigos do 

laboratório e da Bolívia pelos conselhos, risadas e momentos incríveis que fizeram 

destes dois anos momentos inesquecíveis.    

 

 



1 
 

RESUMO 

 

Estratégias de otimização em tempo real (RTO: Real Time Optimization) são 

utilizadas para avaliar e determinar as condições ótimas operacionais de uma planta 

em estado estacionario, maximizando a produtividade econômica do processo 

sujeita a restrições operacionais. Esse problema de otimização engloba toda a 

planta e pode ser resolvido utilizando um só modelo para todo o processo que 

maximize o lucro bruto operacional considerando os preços de mercado das 

correntes de entrada e saída do processo. No entanto, na prática, essa abordagem 

centralizada muitas vezes não pode ser aplicada, devido ao tamanho e 

complexidade do problema de otimização, a que é muito difícil que todas as 

unidades da planta estejam em estado estacionário ao mesmo tempo e a que as 

unidades de processo não estão sincronizadas já que em muitos processos não 

existe armazenamento intermediário. Uma solução é utilizar uma estrutura 

distribuída, na qual o problema de otimização deve ser decomposto em 

subproblemas com reduzida complexidade numérica. Tal decomposição, no entanto, 

exige que o preço das correntes de entrada e saída de cada subproblema sejam 

adequadamente determinados. Com este proposito, neste trabalho, serão aplicadas 

técnicas de decomposição em uma unidade de produção de propeno da refinaria 

REPLAN (Refinaria de Paulínia, São Paulo) da PETROBRAS. Essa unidade será 

modelada, simulada e otimizada no software orientado a equações EMSO 

(Environment for Modeling, Simulation and Optimization). Com o objetivo de testar as 

técnicas de decomposição, a unidade será decomposta em três divisões que são: 

depropanizadora, deetanizadora e C3 splitter. Mostra-se que duas técnicas 

tradicionais chamadas de relaxação Lagrangiana e  Lagrangeano aumentado não 

conseguem convergir em uma solução devido a duas causas. A primeira causa é 

que o processo estudado contém divisões indiferentes, o que significa que não 

existe dependência linear entre a função objetivo e as restrições complicadoras. A 

segunda causa é que os subproblemas de otimização que representam cada uma 

das divisões da unidade têm funções objetivos lineares, neste caso, a restrição ativa 

de cada subproblema irá ser sempre a capacidade de produção máxima ou mínima 

de cada divisão e não uma vazão intermediária. Uma técnica alternativa, Pricing 

Interprocess Streams Using Slack Auctions, também foi aplicada ao processo 

estudado. Essa técnica define uma folga de recurso entre as correntes 



2 
 

intermediárias das divisões e utiliza leilões para ajustar o preço dos produtos 

intermediários. Mostra-se que esse último abordagem também apresenta problemas 

na sua aplicação, porque todas as divisões estudadas têm dois produtos diferentes, 

isso significa que a técnica produzirá sempre a vazão máxima do produto final 

(vazão que tem preço de mercado) de cada divisão e não assim do produto 

intermediário (vazão que vai de uma divisão para outra). Identificados os problemas 

nessas técnicas de decomposição, é proposta uma modificação do algoritmo de 

relaxação Lagrangeana.  Para o qual é considerada uma nova variável denominada 

limite de produção disponível (LPD) e uma restrição para as vazões de carga de 

cada uma das divisões, a qual será atualizada a cada iteração. Essa modificação no 

algoritmo consegue superar os problemas apresentados para a resolução do 

problema de otimização para a unidade estudada considerando uma estrutura 

distribuída.  

Palavras-Chave: Otimização em tempo real. Otimização econômica. Técnicas de 

decomposição. Refinaria de petróleo. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



3 
 

ABSTRACT 

 

Real time optimization strategies (RTO) are used to evaluate and determine the 

optimum operating conditions of a plant, maximizing the economic productivity of the 

process which is subject to operational constraints. This optimization framework 

encompasses the entire plant, and can be solved using one model for the entire 

process that maximizes the operating gross profit considering the market prices of 

input and output stream`s process. However, in practice this centralized approach 

often cannot be applied due to the size and complexity of the optimization problem. 

One solution is to use a distributed structure, in which the optimization problem must 

be broken into sub-problems with reduced numerical complexity. Such 

decomposition, however, requires that the price of input and output stream of each 

sub-problem should be adequately  determined. With this purpose, in this work, 

decomposition techniques is applied in a propylene production unit at the refinery 

REPLAN (Refinaria de Paulínia, São Paulo) owned by PETROBRAS. This unit is 

modeled, simulated and optimized in an equation oriented software EMSO 

(Environment for Modeling, Simulation and Optimization). In order to test the 

decomposition techniques, the unit is decomposed into three divisions, which are 

depropanizer, deethanizer and C3 splitter. It is shown that two traditional techniques 

called Lagrangian relaxation and augmented Lagrangian cannot converge on a 

solution due to two causes. The first cause is that the studied process contains 

indifferent divisions, which means that there is no linear dependence between the 

objective function and the complicating constraints. The second cause is that the 

optimization sub-problem that represent each divisions has linear objective functions, 

in this case, the active constraint of each sub-problem will always be the maximum or 

minimum production capacity of each division and not an intermediate flow rate. An 

alternative technique Pricing Interprocess Streams Using Slack Auctions was also 

applied to the studied process. This technique defines a resource slack between the 

intermediary streams and use auctions for adjusting the price of intermediary 

products. It is shown that this technique also presents problems in its applications 

because all divisions studied has two different products, this means that this 

technique will always produce the maximum flow rate of the final product (flow rate 

that has a market price) of each division, and not  the intermediate product (flow rate 

that goes from one division another). Identified problems in these decomposition 



4 
 

techniques, the proposed approach extended the Lagrangian relaxation algorithm, in 

which a new variable called "available production limit" (LPD) and a restriction to the 

feed flow rate from each divisions are considered, which will be updated at every 

iteration. This change in the algorithm can overcome the issues presented for solving 

the optimization problem for the unit studied considering a distributed structure. 

Keywords: Real time optimization. Economic optimization. Decomposition 

techniques. Petroleum Refinery. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



5 
 

LISTA DE ILUSTRAÇÕES 

 

Figura 2.1 – Hierarquia de atividades no refino de petróleo......................... 18 

Figura 2.2 – Tipos de decisões a serem tomadas numa refinaria................ 21 

Figura 2.3 – Estrutura e o mecanismo clássico de atuação dos sistemas 

RTO........................................................................................... 23 

Figura 2.4 – Otimização modular para divisões independentes da planta.. 28 

Figura 2.5 – Divisões da planta interagem pelas correntes intermediárias 

entre processos........................................................................ 28 

Figura 2.6 – Divisões da planta necessitam conhecer os preços das 

correntes intermediarias........................................................... 29 

Figura 2.7 – Otimização centralizada vs distribuída..................................... 33 

Figura 3.1 – Interpretação geométrica para a dependência linear dos 

gradientes.................................................................................. 40 

Figura 3.2 – Interpretação geométrica para a dependência linear dos 

gradientes.................................................................................. 42 

Figura 3.3 – Fluxograma de resolução de problemas de otimização pelo 

método de decomposição Lagrangeana................................... 55 

Figura 3.4 – Fluxograma de resolução de problemas de otimização pelo 

método de Lagrangeano aumentado........................................ 63 

Figura 3.5 – Definição impropria das correntes intermediarias entre 

processos.................................................................................. 66 

Figura 3.6 – Remodelando o microcadeia de suprimento usando recursos 

de folga...................................................................................... 67 

Figura 3.7 – Fluxograma de resolução de problemas de otimização pelo 

método de Slack Aunctions....................................................... 70 

Figura 4.1 – Fluxograma simplificado da unidade de produção de 

propeno..................................................................................... 72 

Figura 5.1 – Fluxograma simplificado da unidade de produção de propeno 

decomposta em três subproblemas.......................................... 80 

Figura 5.2 – Problema de convergência da decomposição Lagrangeana.. 85 

Figura 5.3 – Dependência linear dos gradientes........................................... 86 

Figura 5.4 – Dependência linear dos gradientes para o problema 87 



6 
 

estudado.................................................................................... 

Figura 5.5 – Vazão Corrente intermediaria 5S1-5S2.................................... 88 

Figura 5.6 – Vazão Corrente intermediaria 17S2-17S3................................ 89 

Figura 5.7 – Pricing interprocess streams using slack auctions aplicado ao 

processo de produção conjunta - função objetivo dos 

subproblemas............................................................................ 94 

Figura 5.8  Fluxograma simplificado da unidade de produção de propeno 

-algoritmo proposto................................................................... 95 

Figura 5.9  Fluxograma do algoritmo proposto......................................... 96 

Figura 5.10  Convergência do algoritmo proposto..................................... 100 

Figura 5.11  Vazão da corrente intermediaria 5S1 - 5S2 utilizando o 

algoritmo proposto..................................................................... 101 

Figura 5.12  Vazão da corrente intermediaria 17S2 - 17S3 utilizando o 

algoritmo proposto..................................................................... 102 

    

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



7 
 

LISTA DE TABELAS 

 

Tabela 4.1 – Composição da carga (GLP) para a seção da 

Depropanizadora..................................................................... 73 

Tabela 4.2  – Resultados da simulação e a otimização do processo 

estudado.................................................................................. 78 

Tabela 5.1 – Respostas da relaxação Lagrangeana.................................... 84 

Tabela 5.2 – Respostas pricing interprocess streams using slack 

auctions.................................................................................... 92 

Tabela 5.3 – Respostas da proposta de modificação do algoritmo de 

relaxação Lagrangeana........................................................... 99 

Tabela 5.4 – Respostas do problema considerando uma estrutura 

centralizada e distribuída......................................................... 102 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



8 
 

LISTA DE ABREVIATURA E SIGLAS 

 

RTO Real Time Optimization 

PID Process and Instrumentation Diagram 

MCP Model Predictive Control 

LPD Limite de Produção Disponível 

EMSO Environment for modeling, simulation and optimization 

IPOPT Interior Point OPTimizer 

GLP Gás Liquefeito de Petróleo 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



9 
 

LISTA DE SIMBOLOS 

 

v Contador das iterações 

? Diferencia aceitável entre os multiplicadores de Lagrange de duas 

iterações consecutivas 

x Variável de decisão 

y Variável dual 

z Função objetivo 

h(x) Restrições de igualdade 

g(x) Restrições de desigualdade 

? Função dual 

?i
(v) 

Multiplicador de Lagrange das restrições de igualdade 

? Multiplicador de Lagrange das restrições de desigualdade 

L Função Lagrangeana 

? Vetor dos multiplicadores de Lagrange 

s
(v)

 Subgradiente na iteração v 

K Tamanho de passo na direção s
(v)

 

Di Demanda de recursos da corrente i 

S Oferta total de recursos 

Pi
(v) 

Preço da vazão i na iteração v 

E
(v)

 Excesso de demanda na iteração v 

T-i Coluna de destilação i 

SRi Splitter de refluxo 

SBi Splitter de reboiler 

SC1 Splitter do compressor 

S-i Divisão de processo i 

Pri Preço do produto i 

Pc Preço da corrente de carga 

Cops-i Custo operacional da divisão i 

CIu,d Corrente intermediária de upstream e downstream  

LPDi
(v) 

Limite de produção disponível i na iteração v 

  

 



10 
 

SUMÁRIO 

 

1 INTRODUÇÃO........................................................................................ 12 

1.1 MOTIVAÇÃO.......................................................................................... 12 

1.2 OBJETIVOS............................................................................................ 15 

1.3 ESTRUTURA DA TESE......................................................................... 16 

2 REVISÃO BIBLIOGRÁFICA................................................................... 17 

2.1 HIERARQUIA DAS DECISÕES NA INDÚSTRIA DE REFINO DE 

PETRÓLEO............................................................................................ 17 

2.2 OTIMIZAÇÃO EM TEMPO REAL (RTO)................................................ 21 

2.3 OTIMIZAÇÃO DO PROCESSO - OTIMIZAÇÃO ECONÔMICA............. 27 

2.4 DECOMPOSIÇÃO DE PROBLEMAS DE OTIMIZAÇÃO....................... 31 

3 TÉCNICAS DE DECOMPOSIÇÃO NA OTIMIZAÇÃO DE 

PROCESSOS......................................................................................... 36 

3.1 TÉCNICAS DE RELAXAÇÃO E DECOMPOSIÇÃO.............................. 36 

3.2 RELAXAÇÃO LAGRANGEANA E DUALIDADE.................................... 38 

3.2.1 Condições de Otimalidade..................................................................... 38 

3.2.2 Dualidade................................................................................................ 44 

3.3 DECOMPOSIÇÃO LAGRANGEANA...................................................... 51 

3.3.1 Atualização do Multiplicador de Lagrange.............................................. 55 

3.3.1.1 Método do Subgradiente........................................................................ 56 

3.3.1.2 Cutting Plane Method............................................................................. 57 

3.3.1.3 Bundle Method........................................................................................ 57 

3.3.1.4 Trust Region Method.............................................................................. 59 

3.4 LAGRANGEANO AUMENTADO............................................................ 60 

3.5 PRICING INTERPROCESS STREAMS USING SLACK AUCTIONS... 64 

4 APRESENTAÇÃO DO PROCESSO ESTUDADO................................. 71 

4.1 DESCRIÇÃO DO PROCESSO ESTUDADO.......................................... 71 

4.2 MODELAGEM, SIMULAÇÃO E OTIMIZAÇÃO DO PROCESSO 

ESTUDADO (EMSO).............................................................................. 75 

5 APLICAÇÃO DAS TÉCNICAS DE DECOMPOSIÇÃO AO 

PROCESSO ESTUDADO...................................................................... 79 



11 
 

5.1 TÉCNICAS DE DECOMPOSIÇÃO APLICADAS AO PROCESSO 

ESTUDADO............................................................................................ 79 

5.1.1 Decomposição Lagrangeana aplicada ao processo estudado............... 81 

5.1.2 Pricing interprocess streams using slack auctions aplicada ao 

processo estudado................................................................................. 90 

5.1.3 Proposta modificação do algoritmo de relaxação Lagrangeana 
94 

6 CONCLUSÕES E SUGESTÕES PARA TRABALHOS FUTUROS........ 104 

 REFERÊNCIAS BIBLIOGRÁFICAS....................................................... 107 

  
 



12 
 

1. INTRODUÇÃO 

 

Desde a revolução industrial, os processos produtivos pelos quais a humanidade 

obtém os seus bens e produtos de consumo vêm experimentando um avanço 

considerável. Diversos são os fatores que levam os processos produtivos a se 

desenvolverem tão velozmente. O aumento da demanda de produtos impelido pelo 

crescimento da população mundial, a forte concorrência pelo mercado, os elevados 

custos de produção, a escassez de recursos naturais para a produção de energia e 

matéria-prima e a conscientização sobre a preservação do meio ambiente obrigaram 

as indústrias a aprimorar seus processos produtivos, levando estes a operar mais 

próximos ao limite de sua capacidade. Em uma época em que se exigem produtos 

reunindo conceitos tão antagônicos como mais qualidade e menor preço, nenhuma 

indústria pode desperdiçar matéria-prima e energia, ou gerar rejeitos industriais sem 

restrições sob pena de ser aniquilada, seja pela legislação vigente, seja pela 

concorrência. 

Este conjunto de fatores faz com que os processos industriais se tornem mais 

complexos devido à necessidade de integração mássica e energética, tornando seus 

comportamentos menos intuitivos e com maior dificuldade de prever qual a melhor 

condição operacional. Por essa razão, tecnologias de otimização vêm sendo 

aplicadas aos processos químicos há várias décadas, na busca contínua da máxima 

exploração do potencial das unidades de processo. Grande parte destes métodos, 

consolidados em ferramentas de otimização, controle e automação de processos, 

foram destinados ao setor de petróleo e petroquímica. 

 

1.1. MOTIVAÇÃO 

 

A elevada competitividade dos processos na indústria do refino de petróleo, 

definidos por características como elevada variabilidade no mercado, exigentes 

restrições dos produtos, elevados custos operacionais e constantes mudanças nos 

preços dos produtos, impõe a constante necessidade de implantar estratégias e 

métodos mais sofisticados de controle e otimização de processos industriais. Tais 

estratégias e métodos de otimização são desenvolvidos na busca contínua da 

máxima exploração do potencial das unidades que compõem a refinaria. A obtenção 



13 
 

de melhores resultados econômicos em uma refinaria depende, em grande medida, 

de tomar as decisões certas no momento certo (Hartmann, 1998). Essas decisões 

são geralmente tomadas em diferentes níveis hierárquicos (controle avançado de 

processo, otimização em tempo real, programação da produção, planejamento da 

produção e planejamento estratégico) e em diferentes horizontes de tempo 

(segundos, minutos, horas, dias, semanas, meses e anos). A justificativa para que 

estes métodos sejam aplicados na indústria do petróleo é a elevada escala de 

produção: o grande volume de produtos gerados, o elevado consumo de energia e 

insumos fazem com que pequenas melhorias na eficiência dos processos se 

traduzam em ganhos expressivos no lucro operacional (Carvalho, 2007). Neste 

contexto, a otimização em tempo real (RTO: Real Time Optimization) torna-se uma 

importante ferramenta no incremento da rentabilidade da empresa. O principal 

objetivo da RTO é poder operar a planta, em cada instante de tempo, o mais 

próximo possível das condições ótimas operacionais (Sequeira et al., 2002). O ciclo 

clássico da RTO inclui múltiplas etapas entre as quais estão a detecção do estado 

estacionário, tratamento de erros grosseiros, reconciliação de dados e estimação de 

parâmetros, otimização econômica e implementação dos pontos ótimos no sistema 

de controle (White, 1997). 

Os problemas de otimização que surgem neste contexto baseiam-se essencialmente 

em modelos matemáticos do processo estudado e em algoritmos de otimização 

através dos quais busca-se determinar o ponto operacional que melhor satisfaça o 

critério de desempenho econômico do processo produtivo. A busca de descrições 

mais completas e precisas dos processos ou sistemas a serem otimizados leva à 

concepção de modelos matemáticos de complexidade crescente, tornando a 

atividade de otimização de processos também crescentemente complexa. Isto leva a 

problemas de elevado número de restrições e variáveis, o que pode torna-los 

inviáveis computacionalmente devido à dimensão, comprometendo a utilidade do 

modelo (Carvalho, 2007). Além disso, mesmo que o poder de computação disponível 

seja suficiente para resolver estes problemas, muitas vezes para modelar e operar 

diferentes unidades de uma mesma refinaria são utilizados softwares de empresas 

diferentes e incompatíveis, fazendo com que a integração e centralização das 

unidades de uma refinaria seja ainda mais difícil (Jose e Ungar, 2000). 



14 
 

No entanto, considerando que o problema de otimização engloba toda a refinaria, 

uma única unidade ou divisão otimizada cobre apenas um subconjunto do problema 

e como tal, não necessariamente fornece uma resposta válida. Ainda assim, a 

modelagem de uma refinaria completa é muito complexa de ser feita, então é mais 

vantajoso utilizar otimizações locais (modelos para cada divisão) que conseguem 

atingir (em seu conjunto) um lucro similar ao de toda a refinaria considerando só um 

modelo (Friedman, 1995). Para este propósito podem-se utilizar técnicas de 

decomposição para problemas de otimização em que são determinados 

adequadamente os preços das correntes intermediarias que permitam maximizar o 

lucro de toda a refinaria.  

A ideia geral das técnicas de decomposição é relaxar as restrições globais, que 

conectam duas ou mais partes relativamente independentes de um problema de 

otimização. Para este fim, existem diversas formas de se realizar esta tarefa. O 

mecanismo base em todos os princípios de decomposição é decompor o problema 

original em subproblemas menores, que são coordenados por um problema mestre 

em que um procedimento iterativo é usado para buscar a convergência para uma 

solução global (Gunnerud, 2010). 

Estratégias de decomposição para problemas de otimização são um campo maduro 

em pesquisa operacional em que, baseadas nas funções dual e primal, destacam-se 

duas alternativas: relaxação Lagrangeana e o Lagrangeano aumentado (Neiro, 

2004). Além disso, também existem abordagens alternativas de decomposição, 

capazes de resolver problemas que essas técnicas clássicas apresentam, mas sua 

aplicabilidade depende da estrutura do problema em questão (Jose e Ungar, 2000).  

O presente trabalho centra-se no estudo e avaliação de técnicas de decomposição 

para problemas de otimização que podem ser ligados a um sistema RTO, com este 

propósito, será considerada uma estrutura distribuída da unidade de produção de 

propeno (escala industrial) da refinaria REPLAN da PETROBRAS. Essa unidade é 

composta por três colunas de destilação: depropanizadora, deetanizadora e a 

fraccionadora de propeno. As três divisões serão modeladas, simuladas e 

otimizadas em EMSO "Environment for Modeling, Simulation and Optimization" 

(Soares e Secchi, 2003), que é um software de modelagem orientado a equações 

(EO). A escolha deste software foi realizada levando-se em conta suas vantagens 



15 
 

como a eficiência de cálculo, boa flexibilidade na especificação de graus de 

liberdade para a simulação, uma interface mais natural e numericamente adequada 

para os problemas de otimização e uma maior autonomia para criar e manipular o 

modelo (Mendoza et al., 2013). Este trabalho é uma contribuição ao projeto 

“Desenvolvimento de Solução em Tempo Real Utilizando uma Abordagem Orientada 

a Equações com Implantação em Unidade Industrial” que visa ao desenvolvimento, 

como projeto de pesquisa, de tecnologia básica de RTO. 

 

1.2. OBJETIVOS 

 

De acordo com a discussão da seção anterior sobre a otimização dos processos da 

indústria petroleira, mais concretamente do refino do petróleo, o principal objetivo do 

presente trabalho é o de avaliar, aplicar e interpretar economicamente as técnicas de 

decomposição mais relevantes para problemas de otimização que possam ser 

acopladas num sistema de RTO, considerando uma unidade de processamento a 

escala industrial como uma estrutura descentralizada. Para que dessa forma, seja 

possível decompor eficientemente o problema original em subproblemas que sejam 

resolvidos separadamente por meio da relaxação das restrições complicadoras, que 

são coordenados por um problema mestre que garante uma solução global. 

Com este fim, o trabalho foca-se nos seguintes objetivos específicos: 

? Estudar técnicas de decomposição clássicas e alternativas para problemas de 

otimização que possam ser aplicadas a processos industriais de grande porte, 

reduzindo a complexidade e o tempo computacional consumido na sua 

resolução e que gerem preços dos produtos intermediários adequados para 

tomada de decisões. 

? Modelar, simular e otimizar a unidade de produção de propeno da refinaria 

REPLAN da PETROBRAS, utilizando o ambiente orientado a equações 

EMSO. O modelagem e simulação deste processo servirá como plataforma 

para que as técnicas posam ser aplicadas e testadas. 

? Dirigir um estudo de avaliação e aplicação das técnicas de decomposição 

para a unidade de produção de propeno, no qual sejam mostrados os 

problemas de eficácia que essas técnicas, clássicas e alternativas, 

apresentam. 



16 
 

? Propor uma modificação no algoritmo de resolução das técnicas de 

decomposição que consiga superar os problemas de eficácia encontrados na 

aplicação destas técnicas. 

 

1.3. ESTRUTURA DO DOCUMENTO  

 

Este texto é composto de seis seções. Na segunda seção é apresentada uma 

revisão bibliográfica geral da RTO e sua relação com a decomposição de problemas 

de otimização. A seção 3 apresenta uma revisão sucinta das técnicas de 

decomposição, que podem ser aplicadas para gerar uma estrutura distribuída de 

problemas de otimização de grande porte encontradas na industria petroleira. Na 

seção 4 é detalhado o processo considerado como caso de estudo, que é a unidade 

de produção de propeno composta por suas 3 divisões (depropanizadora, 

deetanizadora e fraccionadora de propeno). A unidade será modelada, simulada e 

otimizada no software EMSO. Na seção 5 é apresentado um estudo das técnicas de 

decomposição que são aplicadas na unidade de produção de propeno na qual são 

explicadas as razões pelas quais essas técnicas são ineficazes para resolver o 

problema de otimização do processo estudado. Nesta seção também é apresentada 

uma proposta de modificação no algoritmo de resolução da relaxação Lagrangeana, 

essa modificação é testada e consegue resolver os problemas que as técnicas de 

decomposição descritas na seção 3 apresentam. A seção 6 resume as conclusões e 

apresenta propostas de continuação de trabalho. 



17 
 

2. REVISÃO BIBLIOGRÁFICA 

 

Numa operação industrial, além da segurança operacional é necessário também 

fazer com que sua rentabilidade atinja o máximo possível. Isto é alcançado somente 

quando por meio de algum método ou algoritmo a partir do qual se determinam as 

condições operacionais ótimas do processo. Nesta seção será discutida a 

fundamentação teórica relevante em que se evidencia que a otimização em 

sequência dos processos de refino de petróleo é de vital importância para a 

aplicação de uma ferramenta de RTO nessa indústria. 

 

2.1. HIERARQUIA DAS DECISÕES NA INDÚSTRIA DE REFINO DE PETRÓLEO 

 

Em função da grande complexidade da estrutura de refino, o emprego da otimização 

(do ponto de vista econômico) na indústria do petróleo é realizado em vários níveis, 

como mostra a figura 2.1 baseada em Edgar et al., (2001), Romagnoli e Sánchez 

(2000), Guerra e Le Roux (2011) e Kreipl e Pinedo (2004). Nesta figura, as 

operações da planta podem ser divididas em cinco camadas hierárquicas: 

? Planejamento Estratégico. 

? Planejamento da Produção. 

? Programação da Produção. 

? Otimização de Unidades de Processo. 

? Controle e Monitoramento do Processo. 

As cinco camadas trabalham em conjunto de forma integrada. A tarefa para cada 

camada é diferente, mas todas são parte de um controle de forma decrescente 

composto de um objetivo, que é o de maximizar o desempenho econômico da 

planta, mantendo um produto de qualidade e gerando o maior lucro possível. As 

camadas se comunicam, transmitindo a informação de forma crescente. 

De acordo com Kreipl e Pinedo (2004), a interação entre os diferentes níveis da 

hierarquia em refinarias pode ser complicada, principalmente porque os modelos de 

hierarquia superior abrangem horizontes de tempo muito maiores do que aqueles 

considerados nos modelos de nível inferior. Por outro lado, à medida que a ordem 

hierárquica das decisões é aumentada, diminui a informação disponível e o lucro 



18 
 

(ganho) é aumentado com menor esforço na modelagem de níveis hierárquicos que 

consideram maiores horizontes de tempo e, portanto, espera-se que os esforços 

computacionais sejam menores (Guerra e Le Roux, 2011). Isto faz com que os 

resultados de um modelo de elevada ordem hierárquica (planejamento da produção) 

sejam menos confiáveis do que aqueles de modelos de menores ordens 

(programação da produção), conforme mostra a figura 2.1. 

 

Figura 2.1 - Hierarquia de atividades no refino de petróleo 

 
Fonte: Elaboração própria, baseada em Edgar et al., (2001), Romagnoli e Sánchez (2000), Guerra e 

Le Roux (2011) e Kreipl e Pinedo (2004). 

 

Baseado em Carvalho (2007), Moro et al. (1998) e Guerra e Le Roux (2011) é 

apresentada a seguir uma breve descrição dos níveis que compõem a hierarquia de 

decisões em refinarias de petróleo.  

Planejamento Estratégico 

Essa atividade é realizada no nível administrativo das empresas e se baseia em 

cenários de médio e longo prazo, revistos a cada um ou dois anos. O problema 

principal do planejamento estratégico é determinar quais são as oportunidades ou 

necessidades de investimento prioritárias, levando em consideração definições 

estratégicas, tendências mercadológicas, alterações em legislações, cenários 

políticos e disponibilidade de capital. A partir dessa avaliação de oportunidades pode 



19 
 

ocorrer a construção ou aquisição de novas plantas ou unidades de processo, 

ampliações, incorporação de novas tecnologias, etc. 

Planejamento da produção 

O planejamento da produção tem metas econômicas e se dá em dois níveis. No 

nível corporativo, decisões são tomadas considerando toda a estrutura da empresa 

(logística, distribuição, transporte e produção), projeções de demanda e preços de 

produtos, disponibilidade e custo de matéria-prima. É nesse nível que são definidos 

os volumes e tipos de petróleo a serem comprados no mercado para posterior refino, 

aproveitando-se da escolha para obter melhores preços. As ferramentas de 

otimização utilizadas neste nível baseiam-se em modelos simplificados (em geral 

lineares) do processo, em função do elevado grau de complexidade do problema. O 

planejamento neste nível considera, tipicamente, horizontes de seis meses com 

atualização mensal. Já no nível operacional das plantas de petróleo (por exemplo, 

refinarias), o mesmo problema é resolvido em escala menor. Neste caso, o modelo 

contempla apenas os processos da unidade em questão e a parte da cadeia 

logística utilizada pela mesma. A previsão de demanda é mais precisa que no caso 

corporativo e busca-se refinar a estratégia prevista no planejamento corporativo para 

maximizar os lucros. Muitas ferramentas especializadas de otimização são 

oferecidas no mercado (PIMS™ Aspen Technology, RPMS® Honeywell Process 

Solutions, etc.) para solucionar os problemas de planejamento de produção. 

Programação da Produção 

O problema de programação da produção é de grande complexidade já que tem 

como objetivo produzir um agendamento viável das operações, sendo resolvido no 

nível das unidades de uma empresa. Seu objetivo é programar as operações a 

serem realizadas, de forma a atender às demandas no prazo, minimizando o 

armazenamento de matéria-prima e produtos. Assim, a programação de produção 

consiste em um problema dinâmico que define tempos e volumes envolvidos em 

cada operação. Normalmente em refinarias, o horizonte considerado para 

programação varia de dois a sete dias, com atualização diária. Atualmente, as 

ferramentas disponíveis comercialmente ou citadas na literatura para programação 

da produção baseiam-se em modelos bastante complexos, que podem ser lineares 

ou não, envolvendo variáveis discretas e contínuas simultaneamente. Em função da 



20 
 

complexidade do problema, essas ferramentas podem não ser utilizadas para 

determinar a solução ótima do ponto de vista matemático, mas auxiliam o usuário a 

chegar à uma programação viável. As atividades de planejamento e programação da 

produção são realizadas com estreita relação entre si, pois o modelo de 

planejamento fornece informação (plano de produção) para o modelo de 

programação (este modelo define o programa de produção). Se os resultados do 

modelo de programação de produção não são compatíveis com o plano de 

produção, devem-se revisar os dados de produção como disponibilidade de 

matérias-primas e disponibilidade de unidades. Esse procedimento é repetido até 

que haja coerência entre os resultados dos dois modelos. 

Otimização de unidades de processo 

No nível das unidades de processo, o objetivo da otimização é determinar o valor 

apropriado para as variáveis do processo que proporcionam máximo desempenho, 

dentro do perfil de produção definido pelas camadas superiores. Embora esta 

decisão possa ser tomada a partir da experiência e conhecimentos dos técnicos 

responsáveis pela operação da unidade, muitas vezes a determinação do ponto 

ótimo de operação exige a utilização de ferramentas de apoio. Entre as ferramentas 

mais sofisticadas para a otimização de unidades de processo estão os sistemas de 

RTO. Esta técnica baseia-se na associação de modelos matemáticos rigorosos do 

processo a algoritmos de otimização, que  buscam continuamente a determinação 

do ponto operacional que gere o maior lucro possível para a empresa. 

Controle Preditivo Multivariável 

A implementação de um ponto ótimo operacional definido por um sistema de RTO 

não pode, em geral, ser realizada de forma instantânea. Variações drásticas 

poderiam levar a unidade de processo a oscilações indesejáveis ou mesmo à 

instabilidade. Frequentemente, a solução do problema dinâmico de como conduzir o 

processo ao novo ponto operacional com segurança e confiabilidade é deixada a 

cargo dos controladores preditivos multivariáveis. Uma vez implementado o ponto 

ótimo, o controlador deverá ainda rejeitar eventuais perturbações, tomando ações 

que minimizem as flutuações do processo em torno do ponto ótimo definido. A 

atuação do Controle Preditivo Multivariável sobre o processo é feito através do envio 

de set-points às malhas de controle regulatório da unidade de processo. 



21 
 

Feita uma breve descrição dos níveis hierárquicos das decisões nas refinarias, na 

figura 2.2 (Hartmann, 1998) mostra-se em resumo o tipo de decisões a serem 

tomadas em uma refinaria, assim como o tipo de modelo utilizado para auxiliar a 

tomada de decisões e os objetivos usados para avaliar as diferentes opções 

disponíveis. Neste trabalho vamos focar na otimização de unidades de processo, 

onde, de acordo com a figura 2.2, a decisão é feita em termos de  “como operar” e 

“como produzir”. Para este propósito tem que ser feito um modelo para a operação, 

considerando uma função objetivo econômica para a otimização das unidades de 

processo, a principal ferramenta de apoio utilizada é o RTO que será descrita a 

seguir.   

 

Figura 2.2 Tipos de decisões a serem tomadas numa refinaria 

 
Fonte: Adaptado de Hartmann (1998). 
 

2.2. OTIMIZAÇÃO EM TEMPO REAL (RTO) 

 

A camada de otimização de um processo industrial surgiu com o avanço e o 

crescimento das estruturas de controle. Primordialmente, o controle de processos 

procura manter o processo funcionando através de um controle regulatório 

responsável por enviar ações de controle a atuadores simples baseadas nos 



22 
 

objetivos (set-points) especificados para níveis, pressões e temperaturas dos 

processos. Isto não é o suficiente, pois exige dos operadores um trabalho 

considerável para, baseados nestas variáveis de controle, tomar decisões para 

manter a qualidade dos produtos. 

Eis que surge então o conceito de controle supervisório. O controle supervisório veio 

complementar a automação dos processos industriais no sentido de tornar as 

tomadas de decisão em relação às variáveis controladas mais intuitivas e visíveis ao 

operador. Com este advento passou-se a controlar diretamente os objetivos finais 

dos processos como, por exemplo, a especificação dos produtos. O controle 

supervisório articula-se com o controle regulatório sendo uma malha de controle 

superior a este na ordem hierárquica. 

Contudo, uma nova necessidade surgiu no âmbito industrial em termos dos objetivos 

finais de se controlar um processo. Certamente é desejável que se tenham produtos 

sobre especificados sendo gerados dentro do processo, mas seria este o objetivo 

final de uma empresa como uma entidade econômica? Na verdade, um dos fins de 

qualquer empresa é inegavelmente o lucro, e entre se ter produtos sobre 

especificados e lucro existe um gap conceitual. Nem sempre um produto 

especificado é sinônimo de lucro e um esforço adicional se torna necessário neste 

sentido. Por este motivo tornou-se necessário desenvolver uma camada de 

otimização que não trabalhasse somente com modelos lineares, mas sim com 

modelos mais completos e não-lineares do processo, capazes de descrever com 

maior precisão o comportamento da unidade industrial em um dado instante. Surgiu 

assim o conceito de RTO (Duraiski, 2009). 

Por tudo isso, a atualização permanente dos parâmetros deste modelo é 

fundamental para que a determinação do ótimo seja eficaz. Portanto, o termo RTO é 

usado para designar o algoritmo capaz de avaliar e alterar continuamente as 

condições de operação do processo, enviando objetivos ótimos automaticamente 

para o controle avançado, de modo que a produtividade econômica do processo seja 

maximizada sujeita a restrições operacionais (Jang et al., 1987). 

A aplicação clássica de uma ferramenta de RTO utiliza a otimização em estado 

estacionário para obter as condições operacionais que gerem o maior lucro possível 

para a indústria. Os benefícios que Latour (1979) destaca de uma otimização em 

estado estacionário, são: 



23 
 

? Melhor qualidade e rendimento do produto. 

? Redução do consumo de energia e dos custos. 

? Aumento da capacidade dos equipamentos. 

? Menores custos de manutenção das equipes do processo. 

? Menores custos de processo para projetos que incluem um sistema RTO. 

 

As ferramentas de otimização em tempo real baseiam-se na associação de um 

modelo matemático do processo a um algoritmo de otimização que periodicamente 

determina o ponto ótimo operacional a ser perseguido. Porém, para assegurar a 

confiabilidade dos resultados, as aplicações industriais de RTO envolvem uma série 

de etapas preliminares antes do equacionamento do problema de otimização 

econômica propriamente dito. A figura 2.3 ilustra a estrutura e o mecanismo clássico 

de atuação dos sistemas RTO. Baseado em Naysmith et al., (1995) e Hanmandlu et 

al., (1985) é apresentada a seguir uma breve descrição dos componentes clássicos 

de um sistema RTO. 

 

Figura 2.3 - Estrutura e o mecanismo clássico de atuação dos sistemas RTO. 

 
 Fonte: Naysmith et al., (1995) 

 

 



24 
 

Detecção do estado estacionário: 

A implementação de um procedimento para determinar se o processo está 

suficientemente próximo do estado estacionário torna-se necessária já que a 

realização de simulações baseadas em dados obtidos durante o transiente pode 

levar a resultados inconsistentes (Jiant et al., 2003). Em geral define-se um intervalo 

de tempo do passado a ser analisado (imediatamente anterior ao do início do 

procedimento de otimização), em que são coletados dados referentes aos sinais de 

um conjunto de variáveis de processo selecionadas para representar a condição 

estacionária do mesmo. A partir destes dados, a variabilidade das variáveis em 

questão é quantificada e comparada com parâmetros previamente definidos por 

meio de testes estatísticos ou heurísticos que definem se o processo pode ou não 

ser considerado estacionário (Carvalho, 2007). 

 
Reconciliação de dados e detecção de erros grosseiros: 

Todos os valores medidos estão sujeitos a erros que podem comprometer a precisão 

da solução do problema de otimização. A reconciliação de dados consiste em um 

procedimento de otimização através do qual um conjunto de dados é confrontado 

com um modelo matemático considerado confiável – em geral um modelo 

fenomenológico baseado nas leis de conservação de massa, energia e quantidade 

de movimento e modelos rigorosos para a descrição de fenômenos como o equilíbrio 

de fases e o mecanismo de sistemas reacionais. Com base nos valores estimados 

para as variáveis através deste procedimento e análise estatística prévia da sua 

variabilidade típica, verifica-se se os valores fornecidos pelos instrumentos de 

medição são aceitáveis dentro de certo grau de probabilidade. O problema de 

otimização decorrente caracteriza-se por uma função objetivo que leva em 

consideração os desvios entre os valores medidos e estimados (pelo modelo) para 

as variáveis de processo, tendo como variáveis de decisão as variáveis 

independentes do modelo. Contudo, erros de predição podem surgir ainda se o 

modelo do processo não tiver condições de representá-lo com a precisão 

necessária. Frequentemente, o processo sofre alterações em seu comportamento 

(por exemplo, em função de alterações na composição da carga de uma unidade ou 

da desativação de um catalisador), e torna-se necessário corrigir parâmetros do 

modelo matemático para garantir resultados satisfatórios (Carvalho, 2007). Assim, a 



25 
 

detecção dos erros grosseiros toma ações corretivas adequadas para corrigir 

eventuais erros encontrados nas medições do processo, ajustando-as a partir dos 

dados da planta para depois enviá-las para a próxima etapa.  

Estimação de Parâmetros: 

A estimação de parâmetros é também realizada através de um problema de 

otimização. Aqui as variáveis de decisão são os parâmetros do modelo e a função 

objetivo geralmente representa os desvios entre valores medidos e estimados para 

as variáveis dependentes. A natureza dos modelos rigorosos permite o ajuste de 

seus parâmetros para compensar perturbações não medidas e mudanças no 

desempenho do processo provocadas por diversos fatores. O ajuste dos parâmetros 

do modelo corresponde à correção do mesmo através da ação de retroalimentação 

do processo (Camolesi et al., 2008). 

Tanto a reconciliação de dados como o ajuste de parâmetros consistem em 

problemas de otimização que podem ser resolvidos separadamente ou de forma 

simultânea. Embora a solução integrada dos dois problemas seja considerada mais 

eficiente, há implementações em que a reconciliação de dados é resolvida primeiro 

utilizando-se modelos mais simples (por exemplo apenas os balanços de massa e 

energia) e os valores reconciliados das variáveis de processo (vazões, 

temperaturas) são então utilizados na estimação de parâmetros. Com isto, reduz-se 

a magnitude e a complexidade dos problemas de otimização a serem resolvidos. 

Outro recurso frequentemente utilizado para este fim é selecionar apenas um 

subconjunto de todos os parâmetros e variáveis possíveis para reconciliação e/ ou 

estimação em tempo real (Arora e Biegler, 2001). 

Modelo de Processo: 

O modelo matemático do processo deve representar o sistema em uma ampla faixa 

de operações e com elevado grau de precisão, de forma que, quando utilizado pelo 

otimizador, não sejam violadas as restrições do processo e a sua lucratividade 

potencial seja obtida (Camolesi et al., 2008). 

O modelo de processo utilizado na RTO deve representar mudanças nas variáveis 

independentes do processo, fornecendo assim os pontos de ajuste atualizados que 

são calculados pelo algoritmo de otimização.  O efeito das variáveis independentes 



26 
 

sobre as variáveis dependentes, que são geralmente aquelas que estão nas 

restrições, deve ter um impacto econômico significativo. Basicamente em todos os 

casos práticos, o modelo é não-linear e é simulado em estado estacionário.  

No trabalho de Mendoza et al. (2013) mostra-se que um modelo implementado em 

um ambiente orientado a equações é adequado para a otimização de aplicações em 

tempo real, devido à sua robustez, convergência rápida e capacidade de representar 

o processo real. A análise do modelo permite uma melhor compreensão do processo 

e do estabelecimento de limites para processar as especificações e os parâmetros 

atualizados no ciclo RTO.  

Otimização Econômica: 

Neste trabalho a atenção será focada no problema de otimização econômica em 

uma aplicação de RTO, que consiste na determinação do ponto operacional que 

melhor satisfaça um determinado critério de desempenho de uma planta. Este 

critério é expresso matematicamente através de uma função objetivo que pode 

representar, por exemplo, o lucro bruto operacional de uma unidade de processo  

(valor dos produtos finais menos os custos operacionais e das matérias-primas) o 

rendimento de um produto, ou mesmo uma combinação de diferentes objetivos. O 

espaço de busca do ponto ótimo é normalmente limitado por restrições. Essas 

restrições em geral representam limites de segurança ou capacidade de 

equipamentos, especificações de qualidade de produtos, restrições ambientais, etc. 

A relação entre as variáveis utilizadas para definir o ponto ótimo operacional e as 

variáveis que expressam as respostas do processo a estímulos externos é dada por 

um modelo matemático do processo. 

A classificação dos problemas de otimização pode ser feita de diversas maneiras, 

considerando as características das variáveis, das funções objetivo e das restrições 

impostas ao problema. Biegler e Grossmann (2004) apresentam de forma 

abrangente as inúmeras alternativas possíveis. Aplicações em tempo real para a 

indústria do petróleo em geral baseiam-se em variáveis contínuas, e, por 

conseguinte os problemas típicos decorrentes são de Programação não-linear 

(NLP). Esta etapa será desenvolvida com mais detalhes na subdivisão 2.4. 

 



27 
 

Implementação da solução ótima 

A implementação na planta do ponto ótimo operacional obtido como solução do 

problema de otimização não pode, em geral, ser feita de forma instantânea. Se 

houver diferença significativa entre o estado vigente das variáveis de processo e 

aquele proposto, a implementação instantânea da nova solução poderia gerar uma 

severa perturbação sobre o processo. Para evitar que isso ocorra, a implementação 

do ponto ótimo é geralmente feita através de controladores preditivos multivariáveis, 

que realizam a implementação de forma suave, distribuindo-a ao longo de certo 

horizonte de tempo, levando em consideração (através de seu próprio modelo 

matemático) as restrições vigentes e a eventual ocorrência de perturbações. Na 

ausência de controladores preditivos, pode-se ainda utilizar algoritmos simples para 

implementação suave dos valores ótimos como set-points do sistema de controle 

regulatório (Carvalho, 2007).  

O conjunto de set-points encontrados para o processo pelo otimizador é enviado de 

volta para a planta. Uma vez que a planta atingiu o estado estacionário, um outro 

ciclo do RTO é realizado, para mantê-la operando da forma mais eficiente possível. 

 

2.3. OTIMIZAÇÃO DO PROCESSO - OTIMIZAÇÃO ECONÔMICA 

 

A otimização econômica aplicada a um problema RTO consiste na determinação do 

ponto operacional que melhor satisfaz um determinado critério econômico da planta. 

Num problema de otimização de processos, normalmente, são consideradas as 

divisões independentemente, no qual são levados em conta o custo da alimentação, 

o custo operacional e as receitas de vendas de produtos. Os custos fixos, tais como 

o custo de capital e os salários, estão excluídos da função objetivo, uma vez que 

não se pode modificar esses custos por meio da otimização das variáveis 

operacionais (Carvalho, 2007).  

Só que, considerando que o problema de otimização engloba toda a refinaria, uma 

única unidade otimizada cobre apenas um subconjunto do problema e como tal, não 

necessariamente fornece uma resposta válida para toda a refinaria. Se as divisões 

da planta são todas independentes, então é comum resolver o problema de 

otimização da planta usando uma abordagem distribuída como é mostrado na figura 



28 
 

2.4, em que a solução de toda a planta x* é simplesmente o conjunto das soluções 

de todas as divisões (x1*, x2*, x3*, x4*). 

 

Figura 2.4 - Otimização modular para divisões independentes da planta. 

 
          Fonte: Jose e Ungar (2000). 

 

No entanto, em uma refinaria, isso seria um caso raro, pois as divisões em uma 

planta não são independentes, elas interagem umas com as outras através de fluxos 

entre processos (ver figura 2.5).  

 

Figura 2.5 - Divisões da planta interagem pelas correntes intermediárias entre processos.  

 
 Fonte: Jose e Ungar (2000). 

 

Ainda assim a principal razão para fazer otimizações locais (modelos reduzidos) é 

que, fazer só um modelo de toda a refinaria é uma tarefa complexa de ser feita e 



29 
 

praticamente intratável devido ao elevado número de variáveis e equações que tem 

que ser levados em conta, e ao alto consumo de tempo computacional na sua 

resolução, por essa razão que é importante considerar uma estrutura distribuída na 

qual, cada divisão busque atingir o ponto operacional que gere o máximo lucro 

possível da refinaria como um todo. 

Como o objetivo de cada divisão é maximizar o seu próprio lucro, então cada divisão 

deve conhecer os preços dos fluxos intermediários (ver figura 2.6). Uma vez que os 

preços dos produtos intermediários (que estão em função da qualidade e também de 

considerações na programação da produção) sejam conhecidos, a otimização 

individual de cada divisão poderia maximizar o lucro de toda a refinaria (Friedman, 

1995). 

 

Figura 2.6 - Divisões da planta necessitam conhecer os preços das correntes intermediárias. 

 
Fonte: Jose e Ungar (2000). 

 

Os preços de produtos e insumos incorporados à função objetivo de problemas de 

otimização são parâmetros fundamentais para RTO, pois definem a forma da função 

e norteiam a solução a ser obtida.  

Então, é pertinente definir um preço de transferência que é um valor estabelecido em 

termos monetários para registrar as transferências de bens e serviços realizadas 

entre as divisões de uma empresa ou entre empresas de um mesmo grupo (Anthony 

e Govindarajan, 2002). Este conceito pode ser ampliado para tratar, em termos 

monetários, as transferências das correntes intermediárias entre as divisões dentro 

de uma mesma unidade de uma refinaria.     



30 
 

Atkinson e Anthony (2000) diz que as empresas adotam diferentes métodos para 

determinar o preço de transferência, os mais importantes são:  

? Baseado no mercado. 

? Baseado em custos. 

 

Os preços baseados no mercado externo são bases mais apropriadas para estimar o 

valor das mercadorias ou serviços transferidos entre as divisões de uma empresa. O 

preço de mercado provê uma estimativa independente do produto ou serviço 

transferido e indica como cada centro de lucro contribui para o total ganho pela 

empresa na transação. Por exemplo, a divisão de vendas, em vez de transferir a 

mercadoria internamente, poderia vendê-la externamente. De modo semelhante, a 

divisão de compras poderia comprar externamente em vez de receber a 

transferência interna (Atkinson, 2000). Se os preços de mercado não estão 

disponíveis, os preços de transferências internas podem ser definidos com base nos 

custos. As abordagens baseadas no custo para transferir bens e serviços são 

incompatíveis com a ideia de que o mecanismo da transferência de valor forneça 

apoio ao cálculo da receita da unidade. Jordan, Neves e Rodrigues (2003) afirmam 

que tendo por base os custos, as formas mais usadas de fixar os preços de 

transferência interna são: custo real, custo padrão e preço sombra (shadow price). 

O custo real pressupõe a determinação do preço em função dos custos efetivamente 

dispendidos para produzir o bem ou o serviço. Porém, podem existir situações em 

que um preço de transferência interno baseado no custo real não deva ser utilizado, 

pois existe uma dificuldade ao ratear os custos de vários produto de uma mesma 

divisão, isso implica que o preço de transferência baseado em custo real pode levar 

a decisões prejudiciais para a empresa e à sub-otimização de determinada divisão, 

já que todas as ineficiências de uma unidade podem ser passadas para outra 

unidade em forma de preço (Beuren et al., 2008). 

Para o custo-padrão, segundo Martins (2003), o objetivo é o de fixar uma base de 

comparação entre o que ocorreu em termos de custo e o que deveria ter ocorrido. 

Esta afirmação leva a visualizar o custo-padrão como uma técnica auxiliar da 

contabilidade de custos e não outro método ou critério de contabilização dos custos 

e tomada de decisões respeito a um problema de otimização. 



31 
 

Já o preço sombra, conhecido internacionalmente como shadow price, utiliza o 

problema de otimização para cada divisão, no qual, identifica o valor econômico 

(preço) de uma unidade de recurso para cada restrição, ou seja, quanto a função 

objetivo (maximizar lucro) aumentará se for relaxar uma restrição de desigualdade 

em uma unidade (Beuren et al., 2008). Então pode-se dizer que a decisão feita em 

base ao preço sombra gere o maior lucro possível para cada divisão, na qual, vai ser 

relaxada uma restrição de escassez de produto disponível para ser processado e 

não assim uma restrição de consistência.    

Então, resumindo, o principal critério para atribuir um preço a um produto 

intermediário é a existência de preço de mercado para esse produto, porém, se não 

houver preço de mercado para o mesmo, ele pode ser estimado com base nos 

custos do processo a partir da programação matemática (preços sombra). Os preços 

sombra e preços de mercado são os dois principais recursos para estimar os preços 

das correntes intermediárias para garantir decisões que gerem o maior lucro para a 

divisão (Li, 2000). 

Considerando que o problema de especificar os preços das correntes intermediárias 

possa ser resolvido por meio dos métodos explicados anteriormente, ainda resta um 

outro problema ainda mais importante que é a coordenação que tem que existir 

entre as divisões da refinaria, para que garantam uma solução que considere toda a 

refinaria. Já que o ponto operacional de melhor desempenho de uma divisão é 

determinado independentemente, não corresponde necessariamente ao maior lucro 

possível que uma refinaria pode gerar considerando todas suas divisões 

simultaneamente. Para resolver este problema, tem que ser considerados os 

critérios de técnicas de decomposição para problemas de otimização que garantam 

que o lucro obtido utilizando uma estrutura distribuída possa atingir um valor muito 

próximo ao da otimização de todas as unidades consideradas juntas e como 

consequência do uso das técnicas possa-se precificar adequadamente as correntes 

intermediarias. 

 

2.4. DECOMPOSIÇÃO DE PROBLEMAS DE OTIMIZAÇÃO 

 

Atualmente, otimizadores on-line têm sido implementados em várias unidades nas 

refinarias, operando o mais perto possível de suas restrições, para que o processo 



32 
 

seja mais rentável. No entanto, o otimizador implementado em uma única unidade só 

considera a economia dessa unidade, ao invés de levar em conta a situação de toda 

a planta. É improvável que a otimização de uma única unidade gere uma solução  

compatível com os dados de uma otimização de toda a refinaria. Isso significa que a 

solução da otimização em uma única unidade pode não ser consistente com a 

estratégia de operação ideal para toda a refinaria (Li, 2000). 

Naysmith e Douglas (1995) apresentam duas estruturas para fazer a otimização de 

uma refinaria: a primeira é a otimização com estrutura centralizada, esta é a forma 

mais comum de otimização encontrada na literatura, considerando só um modelo 

para toda a planta. A segunda forma considera uma estrutura distribuída, 

decompondo o problema de otimização em subproblemas com o objetivo de reduzir 

a complexidade que apresenta a estrutura centralizada. A figura 2.7 mostra uma 

comparação de uma otimização centralizada versus uma otimização distribuída. A 

abordagem distribuída quebra a otimização centralizada em várias otimizações 

locais, que são coordenados por um modelo coordenador (mestre). O objetivo da 

abordagem é distribuído porque decompõe a planta de grande escala em 

subsistemas, reduzindo assim a complexidade do problema de otimização original. A 

abordagem distribuída também é referida como otimização modular ou hierárquica. 

Darby e White (1988) afirmam que uma abordagem de otimização distribuída pode 

ter as seguintes vantagens: 

? As otimizações locais podem ser feitas em paralelo, reduzindo assim o 

gasto de tempo computacional. 

? Poder ser realizada como maior frequência do que a abordagem de 

otimização centralizada. 

? Os otimizadores locais podem modelar os subsistemas de forma mais 

precisa e completa do que um otimizador centralizado, também podem ter 

níveis diferentes de otimização. 

? O otimizador local permite a incorporação da estimação de parâmetros 

on-line mais facilmente. 

? Podem-se utilizar diferentes softwares de otimização para cada uma das 

divisões. 



33 
 

? O otimizador local é mais fácil de manter, é menos complexo e mais fácil 

de entender do que um otimizador com estrutura centralizada. 

? Se acontecer algum problema com um otimizador local, este pode ser 

desligado (off-line) enquanto o resto dos otimizadores continuam 

trabalhando. O otimizador centralizado tem que ser completamente 

interrompido para ser reestruturado. 

 

Figura 2.7 - Otimização centralizada vs distribuída. 

 
 Fonte: Naysmith e Douglas (1995). 

 

Bailey et al. (1993) encontram duas grandes dificuldades para a otimização 

distribuída: 

? A informação passada entre as restrições dos otimizadores das unidades 

para evitar conflitos não é tão eficaz como em uma abordagem 

centralizada. 

? É possível encontrar inconsistências dos parâmetros quando só uma 

parte do processo é considerada. 



34 
 

Zhang e Zhu (2000) apresentam uma metodologia para determinação do ponto 

ótimo global de uma planta. Inicialmente, os autores mostram que a otimização 

neste nível é feita a partir de modelos simplificados baseados em modelos de 

rendimentos, já que a modelagem rigorosa levaria a imensas dificuldades práticas. 

Esta simplificação leva a resultados limitados, embora tenha a grande vantagem de 

levar em consideração a utilização integrada das unidades de processo. Por outro 

lado, as diferentes divisões podem ter seu ponto ótimo local determinado a partir de 

modelos rigorosos, capazes de determinar o ponto ótimo da divisão com grande 

precisão. Contudo, o ponto ótimo encontrado pode não corresponder àquele que 

leva ao máximo desempenho da planta.  

Outra dificuldade está no fato de que as divisões em geral possuem como cargas ou 

produtos correntes intermediárias cujos preços podem ser difíceis de definir (Hui, 

2002). Para determinar o ponto ótimo global da planta, os autores propõem uma 

metodologia que se baseia na decomposição do problema em duas camadas. No 

início do processo iterativo é realizada a otimização da planta a partir do modelo 

simplificado, gerando como saídas adicionais os custos marginais das correntes do 

processo. Estes valores são repassados à segunda camada, composta pelos 

problemas de otimização baseados em modelos rigorosos.  

A otimização de cada unidade é computada e no ponto ótimo operacional de cada 

uma são determinados novos coeficientes de rendimentos que são repassados à 

primeira camada. O processo é repetido até que haja convergência dos custos 

marginais e coeficientes de rendimento. Desta forma, seria obtida uma solução ótima 

para a planta em perfeita sintonia com o ponto ótimo de cada unidade, explorando 

ao máximo a sinergia entre as unidades. Como exemplo para teste da metodologia, 

foi utilizada uma refinaria contendo unidades de craqueamento catalítico fluído, 

destilação atmosférica e a vácuo, coqueamento retardado, hidrotratamento e 

blending, entre outras. Os resultados obtidos no exemplo sugerem a possibilidade 

de ganhos significativos.  

Em 2006, Zhang e Zhu propuseram uma evolução desta metodologia, em que o 

algoritmo de otimização que integra as duas camadas foi modificado, novos critérios 

de convergência foram propostos e outros aspectos práticos foram considerados, 

como a existência de possíveis correntes de reciclo (e como tratá-las dentro da 



35 
 

estratégia de decomposição). Novamente utilizou-se uma refinaria de petróleo como 

exemplo ilustrativo (Carvalho, 2007). 

A otimização se preocupa, de forma geral, em aumentar o lucro da unidade 

produtiva. No entanto, nem sempre a quantificação do lucro é algo palpável, pois 

uma unidade industrial encontra-se sempre introduzida em um contexto mais amplo, 

composto por várias unidades industriais e o lucro global nem sempre é 

representado pelo lucro local. Os objetivos da otimização podem ser variados, de 

acordo com o que a programação de produção determina. Exemplos de objetivos 

comuns de otimização de unidades industriais podem ser, além do lucro, o mínimo 

consumo de energia, a máxima conversão de um produto ou vários, a máxima 

seletividade, a máxima ou mínima especificação, entre outros (Duraiski, 2009). 

As técnicas de decomposição clássicas baseiam-se em algoritmos iterativos para 

que os problemas de otimização possam ser decompostos e resolvidos 

separadamente, realizando atualizações do multiplicador de Lagrange para as 

restrições das correntes intermediarias das divisões, em que para fins econômicos 

os multiplicadores de Lagrange representariam os preços sombra desses produtos 

intermediários. Essas técnicas de decomposição vêm sendo estudadas pelo grupo 

de pesquisa com intuito de ser aplicadas no projeto de desenvolvimento de soluções 

RTO para a unidade de produção de propeno da refinaria REPLAN da 

PETROBRAS.  



36 
 

3. TÉCNICAS DE DECOMPOSIÇÃO NA OTIMIZAÇÃO DE PROCESSOS 

 

Métodos de decomposição são usados principalmente para resolver problemas de 

otimização de grande escala que apresentam uma estrutura de subsistemas inter-

relacionados. Reduzir a dimensão não é a única motivação, outro aspecto é que 

sejam tomadas decisões localmente e que os cálculos para resolver estes 

subsistemas sejam feitos em paralelo com diferentes processadores e/ou softwares.  

As técnicas clássicas de decomposição em programação matemática podem ter 

uma estrutura baseada no preço (price-directive decomposition) ou baseada no 

recurso (resource-directive decomposition). Em ambas estruturas, ter conhecimento 

das condições de otimalidade e de dualidade é fundamental para entender o 

conceito de decomposição e da resolução iterativa dos problemas (Mahey, 2002).  

Assim, a ideia geral das técnicas de decomposição é relaxar as restrições globais 

(restrições complicadoras), que conectam duas ou mais partes decomponíveis de 

um problema de otimização, o que pode ser alcançado de diversas formas.  

 

3.1. TÉCNICAS DE RELAXAÇÃO E DECOMPOSIÇÃO 

 

A otimização é "a ciência do melhor" no sentido de que ela ajuda a tomar não 

apenas uma decisão viável, mas sim a melhor decisão sujeita a certas restrições que 

descrevem o domínio dentro do qual a mesma tem que ser feita. Modelos de 

programação matemática fornecem o quadro apropriado para abordar essas 

decisões de otimização de forma precisa e formal. Portanto, um problema de 

programação matemática, é representado por uma estrutura de decisão de 

otimização, apresentada abaixo: 

    Max  Função Objetivo 

    sujeito a:      Restrições  

Muitos problemas derivados de situações concretas apresentam determinadas 

estruturas descentralizadas. Portanto, um problema de programação matemática 

associada ao modelo de otimização descentralizado pode apresentar a seguinte 

estrutura (Conejo et al. 2006): 



37 
 

Max    Objetivo1  + Objetivo2 

Sujeito a:   Restrições1   

      Restrições2 

                     Restrições Comuns1,2 

 

 

 

 

Neste exemplo o bloco de restrições "restrições 1" está relacionado com o primeiro 

termo da função objetivo "objetivo 1" e corresponde ao subproblema 1, enquanto 

que o segundo bloco de restrições "restrições 2" está relacionado com a segunda 

parte da função objetivo "objetivo 2" e corresponde ao subproblema 2. No entanto, o 

bloco de restrições comuns afeta os dois subproblemas (são restrições de fronteira) 

e complica a solução do problema, pois evita que os subproblemas associados com 

os dois blocos sejam resolvidos separadamente. Por causa das considerações 

acima, as restrições comuns são denominadas restrições complicadoras. 

Finalmente, nota-se que teria sido possível considerar qualquer número de blocos 

com diferentes estruturas de fronteira, em vez de apenas dois (Conejo et al. 2006). 

Já um problema de programação matemática que envolve variáveis inteiras 

apresenta a seguinte estrutura: 

  Max   Objetivo1  + Objetivo2 

  Sujeito a:  Restrições1  &amp;amp; Restrições Comuns1,2 (Inteiras) 

    Restrições2 &amp;amp; Restrições Comuns1,2 (Inteiras) 

A parte comum de ambos os blocos das restrições estão relacionada com decisões 

inteiras enquanto as partes não comuns estão relacionadas com as decisões 

contínuas. Tratar variáveis inteiras é muito mais complicado do que tratar as 

variáveis contínuas, por isso  tais problemas são denominados como problemas com 

variáveis complicadoras. Além disso, nota-se que uma vez que as decisões das 

variáveis inteiras forem feitas, o subproblema resultante decompõe-se por blocos, o 

que pode facilitar consideravelmente a sua solução.  

O problema estudado neste trabalho apresenta uma topologia descentralizada, que 

é uma estrutura adequada para algumas estratégias de decomposição. As variáveis 

consideradas no problema são contínuas e as restrições das operações são não-

lineares, portanto devem ser consideradas técnicas adequadas para problemas de 

decomposição com restrições complicadoras. Os métodos clássicos sugeridos por 

Conejo et al. (2006) são os de relaxação Lagrangeana e Lagrangeano aumentado, 



38 
 

mas, pelas características do problema estudado, Jose e Ungar (2000) sugerem 

uma técnica alternativa que é Pricing Interprocess streams Using Slack Auctions já 

que as técnicas clássicas podem apresentar uma serie de problemas na sua 

aplicação. Na próxima seção serão apresentados detalhes das técnicas 

mencionadas. 

 

3.2. RELAXAÇÃO LAGRANGEANA E DUALIDADE 

 

Para poder entender os métodos de decomposição é importante repassar os 

conceitos de condições de otimalidade e dualidade, o que é apresentado nas 

próximas subseções. 

 

3.2.1. Condições de Otimalidade 

 

Conceitos básicos das condições de otimalidade podem ser encontrados em 

Bazaraa et al. (2006), Winston (1995) e Conejo et al. (2006).  De acordo com Pinto e 

Gut (2005), um problema de otimização pode ser classificado em: problema de 

otimização sem restrições, problema de otimização com restrições de igualdade, 

problema de otimização com restrições de desigualdade e por ultimo problema de 

otimização com restrições de igualdade e desigualdade. A seguir são explicitadas 

cada uma destas classificações. 

a) Problema de otimização sem restrições: 

Seja o problema de otimização 

  Min   ƒ(x) 

  sujeito a:  x ? R
n
    

com ƒ(x) ? C
2
 (Conjunto das funções que podem ser diferenciadas duas vezes). 

A condição necessária para um mínimo local é: 

Teorema 3.1: se ƒ(x) possui um extremo em x* (máximo ou mínimo), então este é 

um ponto estacionário: 

? ƒ(x*) = 0 



39 
 

O que constitui um sistema com n equações e n incógnitas, que pode ser resolvido 

por qualquer método de resolução de equações algébricas não-lineares. 

As condições suficientes para um mínimo local são: 

Partindo da expansão da série de Taylor para um ponto extremo x*: 

ƒ(x) =ƒ(x*+ ?x) = ƒ(x*) + ?
T
 ƒ(x*).?x + ½.(?x

T
). ?

2
 ƒ(x*).?x + ... 

onde ?x é uma perturbação a partir do ponto extremo: x = x* + ?x. 

Desprezando os termos de ordem superior da série e sabendo que ?f(x*) = 0, temos: 

ƒ(x*+ ?x) - ƒ(x*) = ½.(?x
T
). ?

2
 ƒ(x*).?x 

Então, para que x* seja um mínimo local forte: 

ƒ(x*+ ?x) - ƒ(x*) &gt; 0, ? ?x ?  ?x
T
. ?

2
 ƒ(x*).?x &gt; 0  

ou seja, a matriz Hessiano H(x) ?  ?
2
 ƒ(x*) deve ser positiva definida em x = x*. 

Se H(x) for positiva semidefinida, pode haver múltiplos mínimos, já que ƒ(x*+ ?x) - 

ƒ(x*)  ? 0. 

Propriedades: 

? H(x) é positiva definida ? autovalores de H são positivos. 

? ƒ(x) é estritamente convexa ? H(x) é positiva definida ? x. 

? Se ƒ(x) é estritamente convexa e possui um ponto estacionário, então este 

ponto é um mínimo global. 

b) Problema de otimização com restrições de igualdade 

Seja o problema de otimização: 

  Min   ƒ(x)     

  sujeito a:  hm x 1 (x) = 0 com  ƒ(x), h(x) ? C
2
 

    x ? R
n
  

Condições necessárias para um mínimo local são: 



40 
 

Teorema 3.2: se ƒ(x) possui um extremo com restrições em x, de modo que as 

equações hj(x) = 0, j = 1,2,...,m são válidas, então ?ƒ(x) e ?hj(x) são linearmente 

dependentes neste extremo:  ?0. ?ƒ?x? +	? ?j. ?hj(x)
?
??? ,		com pelo menos um ?j não 

nulo. 

A figura 3.1 apresenta como exemplo uma interpretação geométrica para a 

dependência linear entre ?ƒ(x) e ?hj(x) no ponto mínimo x*. A linha pontilhada sobre 

o cone representa a região viável do problema. 

 

Figura 3.1- Interpretação geométrica para a dependência linear dos gradientes. 

 
 Fonte: Pinto e Gut (2005). 

 

Considerando sem perda de generalidade que ?0 = 1, então ?ƒ(x) = - ? ?j. ?hj(x). 

Neste caso, ?ƒ(x) e ?hj(x) são colineares. 

As seguintes condições: 

?ƒ(x) + ? ?j. ?hj(x) = 0 

hj (x) = 0 

são na verdade as condições estacionárias da função Lagrangeano, L: 

L(x,?) = ƒ(x) + ? ?j. hj(x) 

ou seja, estas condições equivalem a: 



41 
 

?L (x,?) = 0  ?  ?

??

??
= ?ƒ(x)	+	? ?j. ?hj(x)???? 	

??

??
= h?x? = 0

?  

Esta equação constitui um sistema com n + m equações e n +m incógnitas e sua 

solução fornece o extremo x* e os respectivos multiplicadores de Lagrange, ?j. 

A condição suficiente para um mínimo local é que, Realizando uma análise 

semelhante ao caso anterior, temos que a matriz Hessiano do Lagrangeano H(x,?) = 

?
2
L(x,?) deve ser positiva definida em x = x*. 

c) Problema de Otimização com Restrições de Desigualdade 

Seja o problema de otimização: 

  Min   ƒ(x) 

  sujeito a:  gr x 1 (x) ? 0 com  ƒ(x), g(x) ? C
2
 

    x ? R
n
  

Teorema 3.3: Se ƒ(x) possui um extremo restrito em x, de modo que gj (x) ? 0 (j = 

1,2,...,r) então ? ?j ? 0 (j= 1,2,...,r) tal que: 

 1) ?0. ?ƒ(x)	+	? ?j. ?gj(x)
?
??? = 0 ? depêndencia linear dos gradientes 

 2) ?j.gj(x) = 0 ? condição de complementaridade 

As restrições de desigualdade podem ser classificadas como: 

? Ativas (fortemente)  gj(x*) = 0 ?  ?j ? 0 

? Ativas (fracamente) gj(x*) = 0 ?  ?j = 0 

? Inativas   gj(x*)&amp;lt;0 ?  ?j = 0 

A figura 3.2 mostra um exemplo em que g1 e g2 são restrições ativas ( ?1,  ?2 &gt; 0) e 

g3 é uma restrição inativa (?3 = 0). Neste caso a dependência linear dos gradientes é 

expressa como:  

?0. ?ƒ(x) +  ?1. ?g1(x) +  ?2. ?g2(x)  = 0 

Nota-se que o gradiente de ƒ aponta na direção de ƒ crescente e que o gradiente de 

gj aponta na direção de ampliação da região viável. 

 



42 
 

Figura 3.2 - Interpretação geométrica para a dependência linear dos gradientes. 

 
 Fonte: Pinto e Gut (2005). 

 

Admitindo ?0 = 1, temos as seguintes condições: 

?ƒ(x) + ? ?j. ?gj(x) = 0 

?j.gj (x) = 0 

em que ?j ? 0 (j = 1,2,...,r) são os multiplicadores de Karush Kuhn-Tucker 

Nota-se que como  ?j = 0 para as restrições inativas, temos condições semelhantes 

àquelas obtidas para o problema de otimização com restrições de igualdade, ou 

seja, condições estacionárias de Lagrangeano: 

L(x,?) = ƒ(x) + ? ?j. gj(x) ? ?L(x,	?) = 0 

A dificuldade encontra-se na identificação das restrições ativas e inativas. 

O significado de multiplicadores de Karush Kuhn-Tucker é o seguinte:  

?ƒ(x)	+	? ?j. ?gj(x)???? = 0 

Seja uma direção p, tal que: 

?ƒ = p
T
.	?ƒ(x) é a variação de ƒ na direção p. 

?gj = p
T
.	?gj (x) é a variação de gj na direção p. 

Multiplicando a equação de condição estacionária acima por p
T
, temos: 



43 
 

p
T
.	?ƒ(x) + ? ?j. ?gj(x) = 0  ?  ?ƒ + ? ?j.	?gj = 0 

 

Assumindo que ?gj (j = 1,2,...,r, com j? i), ou seja que a restrição gi sofre a variação: 

?ƒ + ? ?i.	?gi = 0 ? ?i = - ?
?ƒ

???
?
?????,?? ?

  

Portanto, o multiplicador de Karush  Kuhn-Tucker, ?i, representa a sensibilidade da 

função objetivo frente a uma alteração na restrição gi(x), considerando constantes 

todas as outras restrições. 

? Considere uma alteração inviável ?gi &gt; 0 (aumento de gi e consequentemente 

ampliação da região viável). Com ?i &gt; 0, obtemos ?ƒ &amp;lt;0, ou seja, o valor da 

função objetivo é reduzido (favorável à minimização). 

? Considere uma alteração viável ?gi &amp;lt;0 (redução de gi). Como ?i &gt; 0, obtemos 

?ƒ &gt; 0 (aumento em ƒ). 

d) Otimização com restrições de igualdade e desigualdade 

Seja o problema de otimização: 

  Min    ƒ(x) 

  sujeito a:  hm x 1 (x) = 0 com  ƒ(x), h(x), g(x)  ? C
2
  

    gr x 1 (x) ? 0  

    x ? R
n
  

A condição necessária para um mínimo local é satisfação das condições de Karush  

Kuhn-Tucker. Estas condições equivalem à obtenção do ponto estacionário da 

função Lagrangeano, obtida combinando restrições de igualdade e desigualdade e 

assumindo ?0 = ?0 = 1 

L(x,?,?) = ƒ(x) + ? ?j. hj(x) + ? ?j. gj(x) ? ?L( x,?,?)	= 0 

? Dependência linear dos gradientes 

?ƒ?x? +	? ?j. ?hj?x????? +	? ?j. ?gj(x)
?
??? = 0 

 ?j : multiplicadores de Lagrange 



44 
 

 ?j : multiplicadores de Karush Kuhn-Tucker 

? Viabilidade das restrições 

    hj (x) = 0  1 ? j ? m 

    gj (x) = 0  1 ? j ? r 

? Condições de Complementaridade 

    ?j. gj (x) = 0  1 ? j ? r 

    ?j ? 0 

Condições de Karush Kuhn-Tucker resultam em um sistema não-linear de n + m + r 

equações e incógnitas. Como solução obtemos um ponto estacionário chamado 

ponto de Karush Kuhn-Tucker. 

A condição suficiente para um mínimo local: 

O Hessiano do Lagrangeano H(x,?,?) = ?
2
 L(x,?,?) deve ser positivo definido em x = 

x*. 

Se ƒ (x) é convexa e a região viável F é também convexa então, para um mínimo 

local x*: 

x* é também um mínimo global, e, as condições de otimalidade de Karush Kuhn-

Tucker são necessárias e suficientes para o mínimo global. 

 

3.2.2. Dualidade  

 

Baseado em Conejo et al. (2006) são apresentados a seguir os conceitos de 

dualidade, que podem ser divididos em dualidade para programação linear e 

dualidade para programação não-linear. 

a) Dualidade em Programação Linear 

Dado o seguinte problema de programação linear em que a variável de decisão é x: 

  Min   z = c
T
.x   (3.1) 

  Sujeito a: 

 



45 
 

    A.x ? b   (3.2) 

    x ? 0 

tem-se o seguinte problema dual: 

  Max   z = b
T
.y   (3.3) 

  Sujeito a: 

    A
T
.y ? c   (3.4) 

    y ? 0 

em que y = (y1, y2,..., ym)
T
 são chamadas de variáveis duais. 

Podemos identificar o primeiro problema como o problema primal, e o segundo como 

sua contraparte dual. Nota-se que os mesmos elementos (a matriz A, e os vetores b 

e c) determinam ambos problemas. No entanto, o problema primal não está no 

formato padrão, mas este formato nos permite ver mais claramente a simetria entre 

o problema primal e seu correspondente problema dual como mostra o seguinte 

teorema: 

Teorema 3.4: A dualidade tem uma relação simétrica com o problema primal, se o 

problema D é o problema dual de P, então P também é o dual de D. 

Como se pode observar, cada restrição do problema primal tem variáveis duais 

associadas com ele, os coeficientes da função objetivo do problema primal são os 

termos do segundo membro das restrições do problema dual e vice-versa, e a matriz 

de coeficientes das restrições do problema dual é a transposta da matriz de 

restrições do problema primal. O problema primal é de minimização, mas seu dual é 

um problema de maximização. 

Para obter um problema dual a partir de um problema primal em sua forma padrão, é 

usada a definição de dualidade para o seguinte teorema: 

Teorema 3.5: O problema primal na forma padrão  

  Min  z = c
T
.x   (3.5) 

  Sujeito a: 

    A.x = b   (3.6) 

    x ? 0  

tem o seguinte problema dual: 



46 
 

  Max   z = b
T
.y 

  sujeito a: 

    A
T
.y ? c 

    y ? 0 

A importância da relação primal-dual é estabelecida nos teoremas que se seguem. 

Lema 3.1 (Lema de dualidade fraca). Seja P o problema de programação linear 

eq.(3.1) - (3.2), e D dual eq.(3.3) - (3.4). Seja x uma solução viável de P e y uma 

solução viável de D. Portanto 

b
T
.y ? c

T
.x (3.7) 

Corolário 3.1. Seja b
T
.y = c

T
. x para alguns vetores particulares x	e y, viável para P e 

D, respectivamente, então as soluções ótimas dos problemas duais e primais são y 

e x, respectivamente. Além disso, se x é uma solução ótima para o problema primal, 

então, existe uma solução ótima y para o problema dual, e o valor da função objetivo 

ótima de ambos os problemas coincide com o valor comum b
T
. y = c

T
. x. Caso 

contrário, um ou ambos os conjuntos de soluções viáveis estão vazios.  

O Corolário 3.1 afirma que ambos problemas, o primal P e o dual D, admitem 

soluções ótimas simultaneamente.  

Em resumo, uma das duas declarações seguintes é afirmativa: 

? Ambos os problemas têm solução ótima e seus valores ótimos coincidem.  

? Um problema não tem limites para o ótimo e o outro tem uma região viável 

vazia. 

Em geral, as variáveis duais (multiplicadores de Lagrange) estão associados ao 

preço sombra de uma restrição, já que mostram a alteração do valor ótimo da função 

objetivo por unidade de mudança no valor do lado direito da restrição, assumindo 

que todos os outros valores de parâmetros do problema permanecem inalterados. 

Para muitas aplicações de programação linear os preços sombra são, pelo menos, 

tão importantes quanto à solução do problema em si; eles indicam se certas 

mudanças no uso das capacidades produtivas podem afetar o valor da função 

objetivo. Os preços sombra podem ser obtidos diretamente a partir da solução do 

problema primal ou determinada pela formulação e resolução do problema dual. 



47 
 

b) Dualidade em programação não-linear 

Nesta seção os resultados obtidos para os problemas de programação linear são 

generalizados para problemas de programação não-linear. Considere o seguinte 

problema geral primal não-linear: 

  Minx   zP = f (x)  (3.8) 

  Sujeito a: 

    h(x) = 0  (3.9) 

    g(x) ? 0 

em que f: R
n
 ? R, h: R

n
 ? R

l
, g: R

n
 ? R

m
 

O problema dual requer a introdução da função dual definida como: 

? (?,?) = Infx { f(x) + ?
T
.h(x) + ?

T
.g(x)}  (3.10) 

em que ?*, ?* são os multiplicadores associados com as restrições de igualdade e 

desigualdade para a solução ótima do problema x* eq.(3.8) - (3.9).  

O problema dual do problema primal eq.(3.8) - (3.9) é então definido como se segue: 

  Max ?,?   zD = ? (?,?)  (3.11) 

  Sujeito a: 

     ? ? 0   (3.12) 

Usando a função Lagrangeana 

 L(x, ?, ?) = f(x) + ?
T
.h(x) + ?

T
.g(x)    (3.13) 

pode-se reescrever o problema dual como: 

  Max ?,?; ? ? 0    [Infx  L(x, ?, ?)]    (3.14) 

Um exemplo da aplicação do uso da função Lagrangeana no problema dual pode 

ser encontrada em Conejo et al. (2006). 

Observação: assumimos que f, h, e g são tais que o ínfimo da função Lagrangeano é 

sempre alcançado em algum x, de maneira que a operação de "ínfimo" nos 

problemas eq.(3.10) e (3.14) pode ser substituída pela operação de "mínimo". Então, 

o problema eq.(3.14) é referido como o problema dual max-min. Nesta situação, 



48 
 

denotamos por x (?, ?) um ponto em que o mínimo dos Lagrangeanos é atingido 

(considerado como uma função dos multiplicadores), podemos escrever 

? (?,?) =  f(x(?,?)) + ?
T
.h(x(?,?)) + ?

T
.g(x(?,?)) 

Por outro lado, sobre a hipótese de convexidade de f e g, a função Lagrangeana é 

convexa em x, e, portanto, no mínimo o seu gradiente deve desaparecer 

?? (?,?) =  ?f(x(?,?)) + ?
T
.	?h(x(?,?)) + ?

T
.	?g(x(?,?)) = 0  (3.15) 

A última identidade pode ser utilizada para derivar uma expressão para o gradiente 

da função dual, bem como para seu Hessiano. Mais explicitamente, de acordo com a 

regra da cadeia 

??? (?,?) =  [?f(x(?,?)) + ?
T
.	?h(x(?,?)) + ?

T
.	?g(x(?,?))]

T
 . ??x (?,?) + g(x (?,?))  (3.16) 

e pela condição eq.(3.15) 

     ?? (?,?) =  g(x (?,?))  (3.17) 

É preciso tomar cuidado no uso da expressão eq.(3.17) por causa da 

descontinuidade de expressão eq.(3.16) em relação a ?. No entanto, isto não é um 

problema na prática. 

Do mesmo modo, obtém-se 

    ?? (?,?) =  h(x (?,?))    (3.18) 

Note-se que a gradiente da função dual é o vetor de desajustes das restrições 

correspondentes.  

Em relação ao Hessiano, note que por condições diferenciáveis eq.(3.17) e (3.18) 

com respeito à ? e ?, respectivamente, obtemos 

??
2
 ?(?,?) = ?xg(x(?,?)) ??x(?,?) 

e 

??
2
 ?(?,?) = ?xh(x(?,?)) ??x(?,?) 

Para obter uma expressão para ?? x (?, ?) e ?? x (?, ?), derivamos a expressão 

(3.15) em relação à ? e ?, respectivamente. Os resultados são 



49 
 

?x
2
 L(x(?,?), ?,?)  ?? x(?,?) + ?x g(x(?,?)) = 0 

e uma equação semelhante trocando ? por ? e h por g, isto é, 

?x
2
 L(x(?,?), ?,?)  ?? x(?,?) + ?x h(x(?,?)) = 0 

Substituindo estas equações em (4,69) e (4,70), respectivamente, obtém-se 

??
2
 ?(?,?) = - ?x g(x(?,?)) [?x

2
 L(x(?, ?), ?, ?]

-1
 ?x g(x(?,?))  

e de igual forma para ??
2
 ?(?,?) tem-se 

 ??
2
 ?(?,?) = - ?x h(x(?,?)) [?x

2
 L(x(?, ?), ?, ?]

-1
 ?x h(x(?,?)) 

Finalmente, se estamos interessados nas segundas derivadas parciais mistas    ? ? ?
2
 

?(?,?). 

Cálculos semelhantes conduzem a 

? ? ?
2
 ?(?,?) = - ?x g(x(?,?)) [?x

2
 L(x(?, ?), ?, ?]

-1
 ?x h(x(?,?)) 

e similarmente 

? ? ?
2
 ?(?,?) = - ?x h(x(?,?)) [?x

2
 L(x(?, ?), ?, ?]

-1
 ?x g(x(?,?)) 

O que mostra que a definição de um problema dual na programação não-linear é 

equivalente à definição de dualidade apresentada para problemas de programação 

linear. 

Assim, qualquer valor da função objetivo do problema dual é um limite inferior do 

valor ótimo da função objetivo do problema primal. Isto pode ser utilizado para 

terminar cálculos em um algoritmo iterativo em que estes valores estão disponíveis, 

como mostra o teorema de dualidade fraco explicado a seguir. 

Teorema 3.6: Dualidade fraca. 

Para qualquer solução x viável do problema primal eq.(3.8) - (3.9) e para qualquer 

solução viável, ?, ?, do problema dual eq.(3.11) - (3.12), vale a seguinte relação: 

    f(x) ? ?(?, ?)     (3.19) 



50 
 

Se as regiões viáveis de ambos os problemas, primal e dual, são não vazias, a 

expressão eq.(3.19) implica que supremo (?) e o ínfimo (f), ambos, sobre suas 

respectivas restrições, são finitos. Certamente, nem o supremo nem o ínfimo 

precisam ser atingidos em qualquer ponto viável. Se o resultado gerado da 

expressão eq.(3.19), tanto o primal quanto o dual são viáveis, então, ambos têm 

soluções ótimas.  

Corolário 3.2 Otimalidade no problema primal e dual. 

a) A seguinte relação sempre é mantida: 

sup {??(?,?)|? ? 0} ? inf {??(x|h(x) =0, g(x) ? 0}  (3.20) 

b) Se f (x*) = ? (?*, ?*) para alguma solução viável x* do problema primal eq.(3.8)-

(3.9) e para algumas soluções viáveis (?*, ?*) do problema dual eq.(3.11)-(3.12), 

então x* e (?*, ?*) são as soluções ótimas dos problemas primal e dual, 

respectivamente. Esta solução define um ponto de sela do Lagrangeano 

correspondente a um máximo com relação a ? e ? e um mínimo em relação a x. 

c) Se sup{ ?(?, ?) : ? ? 0} = +	?  , então, o problema prima não tem uma solução 

viável. 

d) se inf{ f(x) : h(x) = 0, g(x) ? 0} = - ? , então, ?(?, ?) = - ?  para todo ? ? R
l
 e ? ? 0. 

A prova para este corolário pode ser encontrada em Bazaraa et al. (1993).  

Se o resultado gerado na eq.(3.19), não é de igualdade, então acontece um gap da 

dualidade, esse gap é de muito interesse para o estudo das técnicas de 

decomposição para problemas de otimização.  

A diferença: 

   sup{ ?(?, ?) : ? ? 0} - inf{ f(x) : h(x) = 0, g(x) ? 0} 

é definida como gap da dualidade dos problemas primal eq.(3.8) - (3.9) e dual 

eq.(3.11) - (3.12) 

Se um vetor multiplicador resolve o problema dual e não gera um gap da dualidade, 

ou seja, se a relação eq.(3.20) é estritamente satisfeita, então as soluções do 

Lagrangeano associado a este vetor multiplicador são soluções ótimas do problema 



51 
 

primal. Esse resultado apresenta uma maneira de resolver o problema primal por 

meio da resolução do problema dual. O resultado principal consiste em obter 

condições que garantam a inexistência de um gap da dualidade. 

Teorema 3.7: Teorema de Dualidade para problemas convexos 

Considere um problema de programação matemática convexa como eq.(3.8) - (3.9). 

Se x* é a solução do problema primal, então, o vetor associado dos multiplicadores é 

(?*, ?*) que são solução do problema dual, e (?*)
T
g(x*) = 0. Por outro lado, se (?*, ?*) 

é solução do problema dual, existe uma solução, x*, do Lagrangeano associada com 

este vetor de multiplicadores tal que (?*)
T
g (x*) = 0, então x* é uma solução ótima do 

problema primal. 

 

3.3. DECOMPOSIÇÃO LAGRANGEANA 

 

Como já foram mencionadas anteriormente, as técnicas de decomposição baseiam-

se em algoritmos iterativos para que os problemas de otimização possam ser 

relaxados (considerando conceitos de otimalidade) e resolvidos separadamente, 

atualizando os multiplicadores de Lagrange (considerando conceitos de dualidade), 

a partir de um problema mestre.  

Para fins econômicos, os multiplicadores de Lagrange representariam os preços 

sombra dos produtos intermediários e assim, poderia ser otimizada uma divisão de 

uma refinaria buscando gerar o maior lucro para toda a refinaria. 

O problema de otimização deve ter a seguinte estrutura para ser decomposto: 

  Minx           f(x)     (3.21) 

  sujeito a: 

    a(x) = 0    (3.22) 

    b(x) ? 0     

    c(x) = 0     

    d(x) ? 0     

em que f(x) : R
n
 ? R, a(x): R

n ? 
R

na
, b(x): R

n
 ? R

nb
, c(x): R

n
  ? R

nc
, d(x): R

n
 ? R

nd
, 

e na, nb, nc e nd são escalares e vamos supor que as restrições complicadoras são 

c(x) = 0 e d(x) ? 0. Se relaxarmos as restrições complicadoras, a resolução do 



52 
 

problema é simplificada drasticamente. A função Lagrangeana do problema de 

otimização é definida como: 

   L(x, ?, ?) = ƒ(x) + ?
T
 .c(x) + ?

T
.d(x)   (3.23) 

em que ? e ? são os vetores dos multiplicadores de Lagrange e as restrições 

complicadoras c(x) e d(x) são relaxadas. Sob a  hipótese de regularidade e 

convexidade, a função dual é definida como: 

   ?(?, ?) = Minx L(x, ?, ?) 

   sujeito a: 

     a(x) = 0  

     b(x) ? 0 

A função dual é côncava e em geral não diferenciável. Este é um fato fundamental 

para ser explorado nos algoritmos de resolução de problemas explicados mais para 

frente. 

O problema dual é definido como: 

  Max ?, ? ?(?, ?) 

  sujeito a: 

    ? ? 0  

A decomposição por relaxação Lagrangeana é um procedimento atrativo quando a 

função dual é facilmente avaliada para determinados valores ?,? dos vetores dos 

multiplicadores ?, ?, respectivamente. Em outras palavras, é chamado fácil de 

resolver se o problema primal é relaxado fornecendo os valores de ?	e	?. Então o 

problema fica da seguinte forma: 

  Minx  L(x, ?	,?) 

  sujeito a: 

    a(x) = 0  

    b(x) ? 0 

que pode ser decomposto em subproblemas: 

  Min??; i=1,...,n ? L
?
???  (xi, ?,	,?)  

  sujeito a: 



53 
 

    ai (xi) = 0;  i=1,...,n  

    bi (xi) ? 0;  i=1,...,n 

A decomposição facilita a resolução deste problema e normalmente permite que 

sejam realizadas interpretações físicas e econômicas. O problema é denominado 

primal decomposto. Então, obtém-se n subproblemas que podem ser resolvidos em 

paralelo. Sob hipóteses de convexidade, o teorema da dualidade diz que: 

ƒ(x*) = ? (?*, ?*) 

em que x* é a solução da minimização do problema primal e (?*, ?*) é a solução da 

maximização do problema dual. 

Num caso não convexo, dada uma solução viável para o problema primal, x, e uma 

solução viável para o problema dual, (?, ?), a dualidade fraca implica que: 

ƒ(x*) ? ? (?*, ?*) 

No caso convexo, a solução do problema dual fornece a solução do problema primal. 

No caso não convexo, o valor da função objetivo na solução ótima do problema dual 

fornece o limite inferior do valor da função objetivo na solução do problema primal. A 

diferença entre os valores ótimos da função objetivo do problema primal e dual é 

chamada de gap da dualidade como explicado anteriormente. Um exemplo ilustrativo 

pode ser encontrado em Conejo et al. (2006).  

O algoritmo de resolução de problemas de otimização de processos por 

decomposição Lagrangeana é apresentado à continuação: 

Passo 0: Inicialização 

Considerando um problema de minimização, o algoritmo inicia dando um valor para 

o contador de iterações v: 

v = 1 

Também têm que ser fornecidos os valores iniciais dos multiplicadores (?
0
,?

0
) para a 

primeira iteração como mostrado a seguir:   

?
(v)

 = ?
0
 e ?

(v)
 = ?

0
 

É importante fornecer ?, uma diferença aceitável entre os valores dos multiplicadores 

de iterações consecutivas para o critério de convergência do algoritmo. 



54 
 

Passo 1: Solução do problema primal relaxado 

Resolver os n subproblemas gerados a partir da relaxação das variáveis 

complicadoras do problema primal, para i=1,...,n 

  Min??   L (x?
(?)

,?
(v)

, ?
(v)

) 

  sujeito a: 

    ai (xi) = 0;   

    bi (xi) ? 0;   

Passo 2: Atualização dos multiplicadores  

Para atualizar os multiplicadores podem-se utilizar um dos seguintes procedimentos, 

que são resolvidos desde um problema mestre, fora dos modelos dos subproblemas 

e que na verdade, coordena os subproblemas para que se possa atingir o ótimo do 

problema primal, esses procedimentos, listados a seguir, serão desenvolvidos na 

próxima subseção: 

a) Método do subgradiente. 

b) Cutting Plane Method. 

c) Bundle Method. 

d) Trust Region Method. 

Passo 3: Critério de convergência 

O critério de parada do algoritmo tem que satisfazer as seguintes equações: 

   ??(?? ?) ? ??(?)?? ? 	?   e ??(?? ?) ? ??(?)??	? 	?   

em que ? é definido no passo 0. Se essas equações são respeitadas, então o 

algoritmo tem que parar, a solução ótima foi encontrada e então x* = x
(v)

. Caso 

contrário, o algoritmo deve continuar v ? v +1 e retorna-se para o passo 1. Para 

ilustrar o algoritmo de solução de problemas por decomposição Lagrangeana, na 

figura 3.3 é apresentado um fluxograma com os passos do algoritmo explicado 

anteriormente. 

A diferença entre o valor da função objetivo do problema primal (minimização) é o 

valor da função objetivo do problema dual (maximização) é chamada de gap da 

dualidade. Uma vez que a solução do problema dual é alcançada, a solução 

associada ao problema primal poderia não ser viável e, portanto, são necessários 

procedimentos de viabilidade. O procedimento utilizado para encontrar uma possível  



55 
 

Figura 3.3 - Fluxograma de resolução de problemas de otimização pelo método de decomposição 
Lagrangeana. 
 
 
 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

Fonte: Elaboração própria baseada em Conejo et al. (2006). 

 

solução quase ótima do primal altera ligeiramente os valores obtidos dos 

multiplicadores num problema mestre para alcançar a viabilidade do problema 

primal. Procedimentos de subgradientes são geralmente utilizados (Zhuang e 

Galiana, 1988). Em muitos problemas práticos, o método dos subgradientes é eficaz 

para alcançar viabilidade em algumas poucas iterações e sem alterar 

significativamente o valor da função objetivo do problema dual de maximização. 

 

3.3.1. Atualização do Multiplicador de Lagrange 

 

Muitos procedimentos para atualizar o multiplicador são apresentados e comparados 

na literatura, nesta seção, vão ser apresentados os mais destacados e utilizados. 

sim não 

Passo 0: Inicialização 

v = 1; ?(v) = ?(0); ?(v) = ?(0); 

a; b; ? 

 

Passo 1: Resolução dos n subproblemas, com i = 1,...,n. 

min??  L (xi
(v),?(v), ?(v))  

sujeito a: 
 ai (xi) = 0;   
 bi (xi) ? 0; 
 

Passo 2: Atualizar os 

multiplicadores, de  ?(v), ?(v) 

para ?
(v+1)

, ?
(v+1)

. 

Problema mestre: Métodos: 

Subgradient Method; Cutting Plane 

Method; Bundle Method; Trust 

Region Method. 

Passo 3: Critério de Convergência: 

??(?? ?) ? ??(?)?? ? 	?   e ??(?? ?) ? ??(?)??	? 	? 

Solução encontrada: 

xi* = x1
(v) v ? v + 1

 



56 
 

Daqui para frente, para facilitar a notação, os vetores dos multiplicadores ? e ? são 

renomeados como ? = (?, ?). 

O vetor coluna das restrições complicadoras c(x
(v)

) e d(x
(v)

) na iteração v, constitui 

um subgradiente da função dual (Bazaraa et al. 1993) como mostra-se a seguir: 

s
(v)

 =  [c(x
(v)

), d(x
(v)

)] 

Mais detalhes sobre o método de subgradiente pode ser encontrados em Conejo et 

al. (2006). 

 

3.3.1.1. Método do Subgradiente 

 

O vetor do multiplicador é atualizado de acordo com: 

?(v+1) = ?(v) + K(v) 
?(?)

???(?)??
 

em que 

lim
?? ?

K(?) ? 0 

e 

? K(?) ? ?

?

???

 

Uma seleção típica que satisfaz os requisitos anteriores é: 

K
(v)

 = 
?

?? ?.?
 

em que a e b são escalares. Em outras palavras, K define o passo de atualização 

dos multiplicadores, seja incrementando ou diminuindo o valor dos multiplicadores 

de uma seguinte iteração, isso dependendo do sinal do subgradiente (s). 

Normalmente os valores dos parâmetros a e b são constantes, na literatura podem 

ser encontrados diferentes critérios para a assinação destes valores (Polyak, 1987). 

O método do subgradiente é simples de implementar e tem um gasto computacional 

pequeno. No entanto, o progresso deste é lento para chegar ao ótimo, devido à 



57 
 

oscilações nas atualizações. Isto é uma consequência da não-diferenciabilidade da 

função dual. Além disso, o comportamento oscilatório faz com que seja muito difícil 

elaborar um apropriado critério de parada do algoritmo.  Normalmente o critério de 

parada também pode ser feito de acordo a um número especifico de iterações. 

Exemplos ilustrativos podem ser encontrados em Conejo et al. (2006) e Guignard 

(2003). 

 

3.3.1.2. Cutting Plane Method 

 

A atualização do vetor do multiplicador é obtida pela resolução de um problema de 

programação linear como se mostra a seguir: 

  Max z, ? ? C   z 

  sujeito a: 

     z ? ?
(k)

 + s(?)
?
 ( ? - ?

(k)
);  k= 1,...,v, 

em que C é um conjunto convexo e compacto. Este é composto pelas faixas de 

variação dos multiplicadores C = {?, ?dow ? ? ? ?
up

}. Deve ser notado que as 

restrições do problema linear mostrado acima, representam os semi-espaços no 

espaço do multiplicados. Valores ?dow e ?
up

 são, em geral, fáceis de ser obtidos das 

propriedades físicas ou econômicas do sistema que é modelado. 

O número de restrições do problema de otimização linear para atualizar o 

multiplicador cresce à medida que se aumenta o número de iterações, isto faz que 

tenham um elevado custo computacional. O critério de parada deste algoritmo é 

quando a norma da diferença entre o vetor multiplicador de duas iterações 

sucessivas é inferior a um limite pré-determinado. Mais detalhes deste método 

podem ser encontrados em Conejo et al. (2006) e Guignard (2003). 

 

3.3.1.3. Bundle Method 

 

A atualização do vetor do multiplicador é obtida resolvendo o problema de 

programação dual quadrático relaxado mostrado a seguir: 

 



58 
 

  Max z, ? ? C  z - ?
(v)

 ??? ? 	?(?)??
2
 

  sujeito a: 

     z ? ?
(k)

 + ?(?)
?
 (? - ?

(k)
)   k=1,...,v, 

Em que ? é um parâmetro de penalidade, ??. ?? é a norma-2 e ?, "o centro de 

gravidade", é um vetor do multiplicador centralizado na região viável, de modo que 

as oscilações sejam evitadas. Deve-se notar que o número de restrições do 

problema de otimização deste método cresce com o numero de iterações. 

O centro de gravidade é atualizado em cada iteração da seguinte forma: 

se     ? (?
(v)

) - ? (?
(v-1)

) ? m.?
(v-1)

 

então     ?
(v)

 = ? 
(v)

 

se não    ?
(v)

 = ?
(v-1)

 

em que m é um parâmetro com um valor que está entre 0 e 1, e ?
(v)

 é o crescimento 

nominal que representa  a diferença entre o valor da função objetivo do problema 

dual relaxado na iteração (v) e o valor da função objetivo do problema dual nessa 

mesma iteração. Este valor pode ser calculado da seguinte forma: 

    ?
(v)

 = z
(v)

 - ?
(v)

 ???
(?)

? ?(?)??
2
 - ?(?

(v)
) 

Se v = 1, o valor do centro de gravidade é considerado como o valor inicial do vetor 

do multiplicador, ?
(0)

. 

O Bundle method é um método plano cortante, em que o procedimento de subida é 

limitado por uma penalidade na função objetivo. A meta é centralizar o método de 

plano cortante na região de interesse. No entanto, a fim de centrar o método na 

região de interesse, é necessário tomar cuidado com a penalidade e outros 

parâmetros. O critério de parada é quando a diferença entre duas iterações 

sucessivas do vetor multiplicador se torna inferior a um limite pré-determinado. 

Critérios de parada mais sofisticados são possíveis (Conejo et al. 2006). 

 

 

 



59 
 

3.3.1.4. Trust Region Method 

 

A atualização do vetor do multiplicador é obtida resolvendo o seguinte problema de 

programação linear dual relaxada: 

  Max z, ? ? C
(v)

  z  

  sujeito a:   

     z ? ?
(k)

 + ?(?)
?
(? - ?

(k)
);  k=1,...,n; n ? ?, 

em que ? é o máximo número de restrições consideradas quando o problema é 

resolvido, e C
(v)

 é atualizado dinamicamente, definindo a região viável dos 

multiplicadores (Redondo e Conejo, 1999). Se o número de iterações for maior que o 

número máximo especificado de restrições consideradas, as restrições excedentes 

são eliminadas como é indicado a seguir. Na iteração v a diferença entre todos os 

hiperplanos avaliados no vetor do multiplicador atual e o valor atual da função 

objetivo para o vetor do multiplicador atual (residual) é calculado como: 

?i = ?
(i)

 + ?(?)
?
(?

(V)
 - ?

(i)
) - ?

(v)
 ; ?i = 1,...,n. 

Assim que n se torna maior que ?, o hiperplano "mais distante" não é considerado, 

então o numero de hiperplanos fica constante e igual a ?. Deve-se notar que o 

resíduo ?i é sempre positivo porque a reconstituição do plano cortante da função 

dual sobre-estima a função dual atual. Esta técnica que limita o numero de 

hiperplanos considerados tem se provado computacionalmente eficiente.  

O método trust region é um método de plano cortante em que o procedimento de 

subida é dinamicamente limitado por ampliar e diminuir a região de viabilidade sobre 

uma base de coordenadas. Isto é possível porque a região de viabilidade é simples, 

são os limites de cada multiplicador. Através deste procedimento de 

ampliação/diminuição é possível centrar o algoritmo na área de interesse, o que 

resulta em elevada eficiência. O procedimento de ampliação/redução não depende 

do problema em questão e envolve heurísticas simples. O critério de parada deste 

algoritmo é quando a diferença entre o vetor multiplicador de duas iterações 

sucessivas se torna inferior a um limite pré-especificado. Uma diferença 



60 
 

suficientemente pequena entre um limite superior e um limite inferior do ótimo do 

problema dual também é um critério de parada apropriado (Conejo et al. 2006). 

 

3.4. LAGRANGEANO AUMENTADO 

 

Lembrando que c(x) é a restrição complicadora de igualdade e d(x) é a restrição 

complicadora de desigualdade do problema eq.(3.21) - (3.22), a função do 

Lagrangeano aumentado (LA) deste problema tem a seguinte forma: 

LA(x, z, ?, ?, ?, ?) = f(x) + ?
T
 c(x) + ½ ? ?c??(x)?

2
 + ? [

??
??? ?i (di(x) + zi

2
)  

+ ½ ?(di(x) + zi
2
)
2
]         (3.24) 

Em que os parâmetros de penalidade ? e ? são escalares grandes o suficiente para 

garantir a convexidade local (os valores destes parâmetros podem ser encontrados 

em Conejo et al. 2006)  e zi (i = 1, ..., nd) são variáveis adicionais para transformar 

restrições de desigualdade em restrições de igualdade. Deve-se notar que os termos 

quadráticos permitem que a função do Lagrangeano aumentado tenha boas 

propriedades de convexidade (Luenberger, 1984). Por conveniência, definimos vi = 

zi
2
 (i = 1, ..., nd), portanto a função Lagrangeana aumentada escrita acima é 

equivalente a 

LA(x, z, ?, ?, ?, ?) = f(x) + ?
T
 c(x) + ½ ? ?c??(x)?

2
 + ? [

??
??? ?i (di(x) + vi)  

+ ½ ?(di(x) + vi)
2
]          (3.25) 

O procedimento de decomposição do Lagrangeano aumentado envolve a 

minimização da eq.(3.25). Note-se que esta minimização em relação a v pode ser 

realizada analiticamente de forma decomposta, levando a um problema que envolve 

apenas a minimização em relação a x. A minimização da eq.(3.25) em relação a vi é 

Min????  pi = ?i(di(x) + vi) + ½ ?(di(x) + vi)
2
   (3.26) 

em que as variáveis vi devem ser não negativas.  

Este problema pode ser facilmente resolvido. A derivada da função objetivo acima 

em relação a vi é ?i + ?(di(x) + vi). Se vi &gt; 0, a derivada deve ser igual a zero, o que 



61 
 

implica vi =-di (x) - ?i / ?. Se vi = 0, isso significa que di(x) é satisfeita como uma 

igualdade, o que implica que ?i &gt; 0, e a derivada deve ser não negativa. Portanto, 

vi = Max {0, - di(x) - ?i / ?}; i = 1, ..., nd 

Em seguida, a função objetivo do problema eq.(3.26) é avaliada da seguinte forma: 

pi = ?

?

?	?
	[(??+ 	?d?(x))

? ? 	??
?]	se		v? = 0	

?
?

?	?
	??

?																			se			v? = ? d?(x) ? 	??/?
? 

Estes resultados podem ser combinados na fórmula: 

pi = 
?

?	?
	[(Max{0,??+ 	?d?(x))

? ? 	??
?] 

Finalmente, podemos substituir a expressão de pi (i = 1, ..., nd) em (5.50), para obter 

uma expressão explícita da função do Lagrangeano aumentado, 

LA(x, z, ?, ?, ?, ?) = f(x) + ?
T
 c(x) + ½ ? ?c??(x)?

2
 + 

?

?	?
	[(Max{0,??+ 	?d?(x))

? ? 	??
?]  

Como alternativa, um tratamento de ponto interior não-linear com restrições de 

desigualdade pode ser usado (Wu et al., 1994). Essa técnica requer a adição de 

variáveis de folga para as restrições de desigualdade em eq.(3.24) para convertê-las 

em restrições de igualdade. Tais variáveis de folga são, então, incorporadas à 

função objetivo através de termos de barreira logarítmica para garantir a sua 

positividade. 

O algoritmo de decomposição baseado no Lagrangeano aumentado é semelhante 

ao processo de decomposição por relaxação Lagrangeana indicado na seção 

anterior. A diferença básica é que os termos quadráticos no Lagrangeano 

aumentado tornam o problema primal relaxado em não decomponível. Para que este 

possa ser decomposto, dois procedimentos são utilizados principalmente. O primeiro 

é linearizar os termos quadráticos da função do Lagrangeano aumentado e fixa os 

valores (mínimos) das variáveis de uma iteração prévia. O segundo procedimento é 

fixar diretamente na função do Lagrangeano aumentado os valores (mínimos) das 

variáveis de uma iteração prévia. Para mais detalhes pode ser consultado o trabalho 

de Cohen (1980) e exemplos de aplicações podem ser encontrados em Conejo et al. 

(2006). 



62 
 

O algoritmo para a resolução de problemas de otimização por Lagrangeano 

aumentado é o seguinte: 

Passo 0: Inicialização. 

Inicializar com multiplicadores ? e ?, parâmetros de penalidade ? e ?. Também é 

importante fornecer ?, que é uma diferença aceitável entre os valores dos 

multiplicadores de duas iterações consecutivas para o critério de convergência do 

algoritmo. 

Passo 1: Solução do problema primal relaxado.  

Resolver os subproblemas gerados a partir do problema primal, para isto deve ser 

aplicado um procedimento para que o problema primal possa ser decomposto (ver 

Conejo et al. 2006).  

Passo 2: Atualização do multiplicador.  

De acordo com Luenberger (1984), Bertsekas (1995) e Bertsekas (1982) uma regra 

apropriada para atualizar multiplicadores ? (para as restrições de igualdade) é: 

?
(v+1)

 = ?
(v)

 + ?.c(x
(v)

) 

Para os multiplicadores ? (das restrições de desigualdade) que são não negativos, a 

atualização segue a forma: 

?
(v+1)

 = Max {0, ?i
(v)

 + ?.di(x
(v)

)};  i = 1, ..., nd 

Os parâmetros de penalidade ? e ? também pode ser atualizados com o número de 

iteração, de modo que a convexidade seja mantida e evitando um mau 

condicionamento numérico. 

Passo 3: Verificação de convergência. 

O critério de parada do algoritmo tem que satisfazer as seguintes equações: 

  ??(?? ?) ? ??(?)?? ? 	?  e ??(???) ? ??(?)??	? 	?    

em que ? é definido no passo 0. Se essas equações são satisfeitas, então o 

algoritmo pode parar e a solução ótima foi encontrada, x* = x
(v)

. 



63 
 

Caso contrário, o algoritmo deve continuar, v ? v +1 e retorna-se para o passo 1. 

Para ilustrar o algoritmo de solução de problemas por decomposição do 

Lagrangeano aumentado, na figura 3.4 é apresentado um fluxograma com os 

passos do algoritmo explicado anteriormente. 

 

Figura 3.4 - Fluxograma de resolução de problemas de otimização pelo método de Lagrangeano 

aumentado. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Fonte: Elaboração própria baseada em Conejo et al. (2006). 

 

Exemplos ilustrativos de decomposição de problemas de otimização, tanto para a 

técnica de relaxação Lagrangeana como para o Lagrangeano aumentado podem ser 

encontrados em Conejo et al. (2006). 

 

 

não sim 

Passo 0: Inicialização 

v = 1; ?
(v)

 = ?
(0)

; ?
(v)

 = ?
(0)

; 

? , ? e ? são definidos 

Passo 1: Resolução dos n subproblemas, com i = 1,...,n gerados a partir do primal. 

min??  LA(x, z, ?, ?, ?, ?) = f(xi) + ?
T
 c(xi) + ½ ? ?c??(x?)?

2
 + 

?

?	?
	?(max{0,??+ 	?d?(x?))

? ? 	??
??  

sujeito a: 
 ai (xi) = 0;   
 bi (xi) ? 0; 

Passo 2: Atualizar os 

multiplicadores, de  ?(v), ?(v) 

para ?(v+1), ?(v+1). 

Problema mestre:  

Para ? : ?(v+1) = ?(v) + ?.c(x(v)); 

Para ?: ?
(v+1)

 = max {0, ?i
(v)

 + ?.di(x
(v)

)};  

i = 1, ..., nd 

Passo 3: Critério de Convergência: 

  ??(?? ?) ? ??(?? ?)?? ? 	?  e ??(?? ?) ? ??(?? ?)??	? 	?    

Solução encontrada: 

xi* = x1
(v) 

v ? v + 1 



64 
 

3.5. PRICING INTERPROCESS STREAMS USING SLACK AUCTIONS 

 

Esta é uma técnica alternativa proposta por Jose e Ungar (2000), cujos autores 

argumentam que a otimização da planta deve ser decomposta em subproblemas 

com uma complexidade numérica menor, nos quais cada divisão busca maximizar 

seu lucro. Para que isto aconteça, é necessário conhecer os preços das correntes 

intermediárias entre as divisões. A melhor forma de busca-los é definindo uma folga 

entre as correntes do processo das divisões, de forma que essas correntes possam 

ser precificadas utilizando leilões. Esses leilões terminam quando os preços das 

correntes estão em equilíbrio, ou seja,  quando existe um equilíbrio entre a demanda 

e a oferta de recursos das divisões, indicando que toda a planta estaria globalmente 

otimizada. 

Este método (leilões de folga) está relacionado as técnicas de decomposição e pode 

resolver problemas comuns apresentados na prática, em que técnicas clássicas de 

relaxamento podem apresentar problemas. 

A ideia desse método baseia-se no conceito de cadeia de suprimentos que se 

originou na fabricação e pesquisa operacional como uma forma de gestão dos fluxos 

de recursos entre empresas (Axelsson e Easton, 1992; Vollmann et al., 1997). 

Gerenciamento da cadeia de suprimentos em todos os seus detalhes pode envolver: 

a previsão de demandas das empresas, decisões sobre quais são os produtos a 

produzir, quando fazê-los, e como enviá-los a seus clientes. A cadeia de 

suprimentos típica abrange muitas empresas e vários setores. No entanto, uma 

cadeia de suprimentos também pode ser definida sobre as divisões em uma única 

fábrica de produtos químicos. Neste caso as denominamos como microcadeias de 

suprimentos para distingui-las a partir da variedade padrão. 

Ao ver uma planta como uma microcadeia de suprimentos, as interações entre as 

divisões de plantas podem ser consideradas como uma competição pelos recursos 

limitados. Matematicamente, todos os recursos estão associados com restrições da 

forma: 

    D1 + ... + Dn ? S,   (3.27) 



65 
 

em que Di é a demanda de recursos da divisão i e S é a oferta total dos recursos. 

Divisões em uma cadeia de suprimentos interagem quando a soma de suas 

demandas de recursos excede a oferta disponível. Essa interação pode ser 

gerenciada pela forma com que os recursos são enviados para as divisões, baseada 

na quantidade de recursos que elas precisam. Preços elevados reduzem a demanda 

das divisões, enquanto os preços baixos as incentiva a produzir maiores 

quantidades. Quando a divisão i é abastecida com base na quantidade de recursos 

que ele usa, o seu objetivo é resolver o seguinte problema de otimização: 

 

  Max ??   ƒi (xi) - p.Di(xi) 

  sujeito a: 

    Restrições das Divisões 

em que xi é a variável de decisão, ƒi (xi) é a função objetivo nominal, p é um vetor de 

preços dos recursos, e Di(xi) é a demanda de recursos da divisão i. Devem ser 

respeitadas as seguintes condições de equilíbrio 

? D???? i ? S      

? p???? j.(Dj - Sj) = 0,    (3.28) 

pj ? 0  j ? {1, ... , m},   (3.29) 

em que se tem m divisões com m correntes intermediarias. 

A fim de aplicar esta abordagem orientada a preço para problemas de otimização em 

toda a planta, deve-se definir os recursos adequados ao longo dos fluxos entre 

processos. Embora isto pareça trivial, não é. O principal problema é que os recursos 

em uma microcadeia de suprimentos são diferentes daquelas em uma cadeia típica. 

Na situação padrão, cada empresa é livre para comprar a quantidade que desejar, já 

em uma microcadeia de suprimentos isso é impossível. A divisão da planta não pode 

dispor dos recursos enviados a ela por meio de correntes intermediarias não tem 

escolha senão aceitar o recurso, independentemente de quanto é realmente exigido. 

Fluxos de correntes intermediárias não podem realmente ser vistos como recursos. 

Matematicamente, o problema é que as restrições das correntes entre processos 

não são como as restrições de recursos, na verdade são restrições de consistência 

essencialmente física como: 



66 
 

CIu = CId 

em que CIu é a corrente intermediária da divisão de upstream e CId é a corrente 

intermediaria da divisão de downstream. Ou seja, a restrição impõe que a vazão de 

saída de uma unidade de upstream deve ser a mesma que a vazão de entrada da 

unidade de downstream. Isso é irrelevante para efeitos da definição de recursos e 

também dificulta a precificação dos fluxos entre os processos. A aparente forma de 

precificação dos fluxos entre processos em que as unidades de dowstream têm que 

pagar pelo recurso enviado desde a unidade de upstream (ver figura 3.5) é intuitiva, 

mas o raciocínio por trás disso é errado, porque as unidades de dowstream não 

podem dispor da quantidade de recurso do upstream que é enviado para eles. Isso 

significa que não há nenhuma noção de demanda de recursos a serem utilizados na 

divisão de dowstream. Sem uma noção de demandas dos recursos, não pode haver 

preços de equilíbrio. 

 

Figura 3.5 - Definição imprópria das correntes intermediárias entre processos. 

 
 Fonte: Jose e Ungar (2000). 

 

As dificuldades em definir preços para fluxos entre processos ocorrem porque os 

recursos não estão bem definidos nesse caso. Uma maneira de superar isso é 

remodelar a microcadeia de modo que as restrições dos recursos sejam explícitas.  

Considerando a restrição de consistência: 

CIu = CId 

Que pode ser reescrita de modo que se tenha a forma de uma restrição de recurso: 

CIu - CId = 0 

|CI?	 ?
?CI?	|

? ? 0 



67 
 

½|CI?	 ?
?CI?	|

? + ½|CI?	 ?
?CI?	|

? ? 0  (3.30) 

    Du      Dd 

O primeiro membro da eq.(3.31) pode ser interpretado como uma demanda 

agregada por recursos, sendo Du a demanda da divisão de upstream e Dd a 

demanda para a divisão de downstream, enquanto o segundo membro pode ser 

interpretado como uma oferta de recursos. Dado que |CIu - CId| é a quantidade de 

folga na eq.(3.31), podemos chamar esses novos recursos como recursos de folga. 

Em geral, eq.(3.31) pode ser escrita como: 

½|CI?	 ?
?CI?	|

? + ½|CI?	 ?
?CI?	|

? ? S 

em que S&gt;0, de modo que S pode ser considerada como uma folga de 

abastecimento entre as correntes intermediárias. Estes recursos de folga alteram a 

estrutura da microcadeia de suprimentos de toda a planta. Em vez de considerar 

uma divisão como vendedora e outra compradora, ambas são compradoras e, quem 

define a folga entre as correntes intermediarias é, em certo sentido, um 

administrador da planta (ver Figura 3.6). 

 

Figura 3.6 - Remodelando a microcadeia de suprimentos usando recursos de folga. 

 
 Fonte: Jose e Ungar (2000). 

 

Colocar uma folga entre os recursos intermediários é a forma adequada de ver as 

correntes da microcadeia de suprimentos, porque capturam a ideia da demanda de 

recursos, a oferta de recursos e a escassez de recursos. Um recurso se torna 

escasso, quando a demanda excede a oferta ou seja, existe uma folga entre as 



68 
 

correntes intermediarias (folga de abastecimento) maior à especificada, isto 

acontece quando as divisões de upstream e downstream tem diferentes valores da 

corrente intermediaria. A folga de abastecimento é essencialmente a tolerância da 

planta entre os diferentes valores de CIu e CId. A demanda e a oferta entre duas 

divisões pode ser controlada fornecendo às divisões (com base na folga 

especificada entre suas correntes intermedirias) preços adequados, que podem ser 

encontrados usando leilões de recursos. 

O objetivo de qualquer leilão é encontrar os preços dos recursos com respeito a um 

conjunto de compradores (tais como as divisões em uma planta). Um leiloeiro ajusta 

os preços dos recursos até que as condições de equilíbrio eq. (3.28) - (3.30) sejam 

satisfeitas. Quando os recursos são vendidos a preços de equilíbrio, eles são 

perfeitamente alocados no sentido de que a soma dos objetivos das divisões é 

maximizada. 

Considere a folga da demanda da divisão de upstream 

Du = ½|CI?	 ?
?CI?|

? 

e da divisão de downstream 

Dd = ½|CI?	 ?
?CI?|

? 

Para que a divisão do upstream calcule essa demanda, é preciso saber o valor do 

CId. Portanto, quando um leiloeiro anuncia preços, também deve anunciar algum 

valor de referência da CId para que seja usado pela divisão de upstream. 

Denotaremos esta referência como CId
0
 e é chamado de polo de folga da divisão de 

upstream. Dado um polo de folga e um preço p, o problema de otimização da divisão 

de upstream para calcular a folga da demanda pode ser expresso da seguinte forma: 

  Max ???    ƒu (CIu) - p. ½?CI?	 ?
?CI?

???  

  Sujeito a: 

     Restrições da divisão de Upstream 

De maneira similar, para a divisão de downstream o problema de otimização fica: 

 

                 Max ???    ƒd (CId) - p. ½|	CI? ?
?CI?

?|?  



69 
 

  Sujeito a: 

   Restrições da divisão de Downstream 

O algoritmo iterativo para resolver a decomposição de problemas de otimização pelo 

método de leilão da folga é o seguinte:  

Passo 0: Inicialização. 

Fornecer valores iniciais para o preço (p
0
), os valores iniciais das variáveis CI?

?, CI?
?, a 

folga entre os recursos (S) e o numero de iteração (v = 1) 

Passo 1: Resolver os subproblemas: 

     Max ???    ƒu (CIu) - p
(v)

. ½?CI?	 ?
?CI?

???  

  Sujeito a: 

     Restrições da divisão de Upstream 

e 

  Max ???    ƒd (CId) - p
(v)

. ½|	CI? ?
?CI?

?|?  

  Sujeito a: 

     Restrições da divisão de Downstream 

Obtendo como resultado os valores ótimos CI?* e CI?* 

Passo 2: Critério de Convergência. 

Se |CI?
? ? ?CI?

?|? ? S, então a solução foi encontrada, caso contrário passa-se ao passo 

3. 

Passo 3: Atualizar os valores de referência. 

CI?
? ? CI?* 

CI?
? ? CI?* 

Ajustar o preço p
(v)

 calculando o excesso da demanda E
(v)

 da seguinte forma: 

E
(v)

 = CI?* - CI?* 



70 
 

Se o excesso de demanda é negativo, então diminuir o preço p
(v)

, se o excesso de 

demanda é positivo, incrementar o preço p
(v) 

(Jose e Ungar, 1998)  e voltar para o 

passo 1. Na figura 3.7 mostra-se o fluxograma do algoritmo.  

 

Figura 3.7 - Fluxograma de resolução de problemas de otimização pelo método de Slack Auctions. 

 

 

 

 

 

 

 

  

 

 

 

 

Fonte: Elaboração própria com base em a Jose e Ungar (2000). 

 

Exemplos ilustrativos e mais detalhes deste método podem ser encontrados em 

Jose e Ungar (2000). 

não sim 

Passo 0: Inicialização. 

Fornecer valores iniciais para p, 

CI?
?, CI?

? e a tolerância S. 

Passo 1: Resolução os subproblemas. 

Maximizar???   ƒu (CIu) ? p. ½?CI?	 ?
?CI?

???  

Sujeito a: 

  Restrições da divisão de Upstream 

e 

Maximizar???   ƒd (CId) ? p. ½|	CI? ?
?CI?

?|?  

Sujeito a: 

 Restrições da divisão de Downstream 

Passo 2: Critério de Convergência. 

Se |CI?
? ? ?CI?

?|? ? S 

Passo 3: Atualizar os valores de referencia e o 

preço. 

CI?
? ? CI?* ; CI?

? ? CI?* 

Ajustar o preço p. 

CI?
? = 	CI?

? 

Solução encontrada: 



71 
 

4. APRESENTAÇÃO DO PROCESSO ESTUDADO 

 

O processo estudado é a unidade de produção de Propeno da refinaria REPLAN da 

PETROBRAS S.A. que foi projetada para produzir 53.000 t/ano de propeno de alta 

pureza com grau polímero (99.5 % molar no mínimo). A unidade é formada por uma 

seção de carga, uma seção de tratamento cáustico e três diferentes divisões de 

destilação que são: a Depropanizadora, a De-etanizadora e a Fracionadora de 

Propeno (Depropenizadora). No processo estudado serão consideradas as divisões 

de destilação formadas por três colunas para que seja feita a otimização em 

sequência como mostra a figura 4.1, na qual pode-se observar um diagrama 

simplificado da unidade de produção de propeno. Por razões de confidencialidade 

uma escala arbitraria de  vazões e preços foi utilizada. 

 

4.1. DESCRIÇÃO DO PROCESSO 

 

A corrente de carga da unidade de produção de propeno é o GLP proveniente da 

unidade FCC (Fluid Catalytic Cracking), que é bombeada, após tratamento para a 

primeira divisão de destilação (Depropanizadora). 

O GLP da unidade FCC alimenta a Coluna depropanizadora (T-1) contém 10 

componentes dos quais os principais são o propano e propeno. A composição 

detalhada desta corrente de carga está apresentada na tabela 4.1.  

Divisão Depropanizadora 

A coluna Depropanizadora está equipada com 51 pratos. O produto de fundo da 

coluna é parcialmente evaporado por meio do vapor aquecido pelo reboiler da 

depropanizadora (RB1), depois este produto é esfriado no cooler (HX1) e enviado 

para o splitter do produto de fundo (SP1) em que 70% do produto vai para a Unidade 

de MTBE e o resto vai para a venda Industrial.  A especificação do produto de fundo 

(C4
+
) é de no máximo 1,0% molar dos componentes leves (etano, propeno e 

propano). O vapor de topo da T-1 passa pelo condensador total da depropanizadora 

(HX2). 



 

 

F
ig

u
ra

 4
.1

 -
 F

lu
x
o

g
ra

m
a

 s
im

p
lif

ic
a
d

o
 d

a
 u

n
id

a
d

e
 d

e
 p

ro
d

u
ç
ã

o
 d

e
 p

ro
p
e

n
o

. 

  

72 

F
o

n
te

: 
E

la
b

o
ra

ç
ã

o
 p

ró
p

ri
a

 e
m

 b
a

s
e

 a
 d

a
d

o
s
 d

o
 p

ro
je

to
. 



73 
 

O líquido condensado é enviado para o splitter do refluxo, onde a maior parte é 

bombeada pela B1 (bomba de refluxo da depropanizadora), como refluxo para a 

coluna T-1 e a parte menor, chamada de produto intermediário C3, é bombeada pela 

B2 (bomba do produto intermediário C3) para a segunda divisão de destilação (De-

etanizadora). A especificação do produto de topo da coluna T-1 é de no máximo 

0,1% molar de hidrocarbonetos pesados (C4
+
). Os limites de operação para a vazão 

de carga para a T-1 são, no máximo de 23804 kg/h e no mínimo de 17312 kg/h. 

  

Tabela 4.1 - Composição da carga (GLP) para a seção da Depropanizadora. 

Componente Fração Molar 

Etano 0.0245 

Propileno 0.3712 

Propano 0.1353 

Isobutano 0.1197 

1-Buteno 0.0640 

1,3-Butadieno 0.0021 

Butano 0.0531 

Trans-2-Buteno 0.0724 

Cis-2-Buteno 0.0483 

Isobuteno 0.1026 

      Fonte: Dados da planta. 

 

Divisão De-etanizadora 

O produto intermediário C3 da coluna Depropanizadora vai para a Coluna De-

etanizadora (T-2).  A T2 está equipada com 61 pratos. O produto do topo da T-2 é 

condensado no HX3 (condensador de topo da de-etanizadora). Esse condensado, é 

enviado para o splitter do refluxo da De-etanizadora (SR2) onde parte deste produto,  

composto majoritariamente por etano, é enviado para as unidades de FCC da 

refinaria, para posterior processamento, e o restante é bombeado pela B3  (bomba 

de refluxo da de-etanizadora), como refluxo para a T-2.  

O produto de fundo da coluna é enviado para o splitter do reboiler da T-2 (SB2) onde 

a parte que vai para o reboiler é evaporada por meio do vapor aquecido do reboiler 

do De-etanizador (RB2) e depois retorna à coluna. A parte restante do produto de 

fundo (produto intermediário) é enviada como corrente de alimentação para a 

Fracionadora de Propeno. A especificação do produto de fundo é de no máximo 120 



74 
 

ppm molar de etano. Os limites de operação para a vazão de carga para a T-2 são, 

no máximo de 10866 kg/h e no mínimo de 4939 kg/h.  

Divisão Fracionadora de Propeno (Depropenizadora) 

O produto de fundo da coluna De-etanizadora, contendo C4 (propano e propeno), é 

enviado para a fracionadora de propeno (T-3). A T-3 está equipada com 197 pratos. 

O calor necessário para separar o propeno do propano é cedido à fracionadora de 

propeno pelo produto de topo através dos refervedores. Esses refervedores são 

divididos em duas unidades semelhantes em paralelo. O produto de fundo que 

contém principalmente o propano é enviado para o splitter do reboiler (SB3), onde 

parte é enviada para o reboiler (RB3) e o restante é armazenado como produto final 

para venda no mercado. A especificação do produto de fundo é de no máximo 5% 

molar de propeno.  

O vapor de topo da T-3 é misturado com o vapor do tanque de refluxo TA1 e é 

conduzido para o Compressor (bomba de calor) de propeno C1. O C1 aumenta a 

pressão de vapor até 14,8 kgf/cm
2
, condição em que a condensação no reboiler RB3 

se torna possível. Após a compressão, no splitter SC1 o vapor é dividido em duas 

partes, a parte maior vai para o RB3, onde essa corrente condensa-se a 35
o
C, e 

depois é enviada para a válvula V5. A outra parte é enviada para o condensador 

HX4, onde essa corrente é condensada até 35
o
C e depois é enviada para a válvula 

V4. A condensação deste vapor mantém a pressão da T-3 sobre controle.  

O líquido a partir do RB3 e do HX4 é flasheado nas válvulas V5 e V4 

respectivamente, depois estas correntes são misturadas no mixer M2 e enviadas 

para o tanque de refluxo TA1. O vapor do tanque de refluxo é enviado para a válvula 

V6 e o líquido é bombeado pela B4 (bomba na saída do tanque TA1) para o splitter 

de refluxo SR3. Nesse splitter a corrente é dividida em duas partes, a maior parte 

regressa ao T-3 como refluxo e o resto constitui o produto desejado que neste caso 

é o propeno com grau polimero.  

A especificação do produto de topo é de 99,5% molar em mínimo de propileno. Os 

limites de operação para a vazão de carga para a T-3 são no máximo de 10062 kg/h 

e no mínimo de 4574 kg/h. 

 



75 
 

4.2. MODELAGEM, SIMULAÇÃO E OTIMIZAÇÃO DO PROCESSO ESTUDADO 

 

Para o desenvolvimento de uma ferramenta de otimização em tempo real, é 

necessário um modelo matemático que seja capaz de representar a operação da 

unidade estudada. O modelo deve ser flexível para ajustar o comportamento real 

dentro de uma ampla faixa nas operações de processo (Chachua et al., 2009).  

O modelo do processo foi baseado no trabalho publicado por Mendoza et al. (2013) 

de uma fracionadora de propeno. Este foi implementado em um ambiente orientado 

a equações, utilizando o software EMSO (Environment for Modeling, Simulation and 

Optimization) de Soares e Secchi (2003). 

O EMSO é um software orientado a equações, com as características adequadas 

para a implementação de um sistema RTO, já que este software tem rotinas para 

solucionar problemas algébrico-diferenciais, calcula as derivadas por diferenciação 

automática, faz uma análise automática dos graus de liberdade e contém módulos 

de otimização e de estimação de parâmetros, entre outras características 

importantes. 

O modelo foi desenvolvido com as seguintes características: 

? O modelo termodinâmico utilizado é o de Peng-Robinson (Mendoza et al. 

2013), disponível no pacote termodinâmico do EMSO (VRTECH, 2008). 

? As correntes de entrada têm uma vazão de 440.16 kmol/h, a uma 

temperatura de 343.15 K, e uma pressão de 22.264 atm. A corrente tem 10 

componentes com a composição mostrada na tabela 4.1 desta seção. 

? A primeira coluna (Depropanizadora) tem 51 pratos e a alimentação é feita no 

prato número 26. A pressão no topo da coluna é de 19.2 atm e pressão de 

saída do produto intermediário (P3) é de 32.912 atm. A razão de refluxo 

desta coluna (SR1) obedece à equação (SRA1 = fluxo 4 / fluxo 3) e é de 

0.676.  O splitter do rebiler (SB1) corresponde à  equação (SB1 = fluxo 7 / 

fluxo 6),  especificada com um valor de 0.772. A queda de pressão foi 

admitida constante em cada prato e o perfil foi linearizado entre a pressão de 

topo e de fundo, onde a pressão de fundo é de 19.445 atm. 

? A segunda coluna (De-etanizadora) é composta por 61 pratos e a corrente de 

alimentação proveniente da T-1 está no prato número 7. A pressão no prato 



76 
 

número 1 é de 30.5 atm e a pressão no fundo da coluna é de 31 atm. A razão 

de refluxo desta coluna (SR2) obedece à equação (SRA2 = fluxo 13 / fluxo 

12) é de 0.944.  O splitter do reboiler (SB2) corresponde à equação (SB2 = 

fluxo 16 / fluxo 15), especificada com um valor de 0.72. A queda de pressão 

foi admitida constante em cada prato e o perfil foi linearizado entre a pressão 

de topo e de fundo 

? A terceira divisão (Fracionadora de Propeno) tem 197 pratos, esta coluna é 

de alta pureza, a corrente de alimentação, proveniente da T-2, está no prato 

número 157. A pressão no topo da coluna é de 9.67 atm. Esta seção possui 

uma destilação com recompressão de vapor (VRD) para o qual utiliza-se um 

compressor (bomba de calor). A razão de refluxo desta coluna (SR3) 

obedece à equação (SRA3 = fluxo 26 / fluxo 24) e é de 0.07648. O splitter na 

saída do compressor (SC1) corresponde à  equação (SC1 = fluxo 22 / fluxo 

20),  especificada com um valor de 0.209. O compressor trabalha com uma 

pressão de 1550 kPa. 

?  As válvulas consideradas são de expansão adiabática. 

? Trocadores de calor sem perda de carga. 

Para a simulação, foram utilizadas 13620 variáveis, 13574 equações, sendo 46 

variáveis especificadas. As variáveis especificadas foram estabelecidas de acordo 

com o sistema de controle adotado na refinaria. Foi utilizado um computador Intel 

core 2 QUAD CPU Q9550 @ 2.83 GHz x 4. 

Já para a otimização desta unidade foram considerados os custos operacionais 

(dados da planta) entre os quais estão o consumo energético (0.55 $/KW), o 

consumo de vapor para os reboilers das colunas T-1 e T-2 (147 $/Ton), o consumo 

de água de resfriamento (24.228 $/Ton) e a corrente de carga da T-1 (1.6 $/kg). A 

função objetivo é o lucro operacional bruto (Receita - Custos de Operação - Custo da 

corrente de Carga), e as restrições de operação da unidade são lineares e não-

lineares. Para otimizar se utilizou o solver para otimização não linear IPOPT- Interior 

point OPTimizer (https://projects.coin-or.org/Ipopt.), disponível no EMSO.  

As variáveis de decisão para a otimização na primeira coluna foram a razão de 

refluxo (SR1) e a razão do reboiler (SB1), a restrição de pureza do produto de topo é 

de 0.1% molar no máximo hidrocarbonetos pesados (C4
+
) e da pureza do produto do 



77 
 

fundo é de 1.0% molar no máximo dos componentes leves (etano, propeno e 

propano). O produto de fundo tem dois destinos finais, 70% vai para a Unidade de 

MTBE (P1) a um preço de 1.6063 $/Kg e o restante vai para a venda Industrial (P2) 

a um preço de 2.424 $/Kg. Já o produto do topo é enviado como produto 

intermediário para a T-2. 

Na segunda divisão (De-etanizadora), as variáveis de decisão são a razão de refluxo 

(SR2) e a razão de Reboiler (SB2). O produto de topo (P3) é enviado para a unidade 

FCC (Fluid Catalytic Cracking) a um preço de mercado de 2.736 $/Kg. Já o produto 

de fundo é enviado para a seção onde se encontra a fracionadora de propeno. A 

restrição de pureza desta corrente é de 120 ppm molar no máximo de etano. 

Na T-3 as variáveis de decisão foram a razão de refluxo (SR3) e a razão de caudal 

que fornece calor para o reboiler na saída do compressor (SC1). Os produtos desta 

seção são comercializados no mercado, o propeno (P5) a um preço de 6.273 $/Kg e 

o propano (P4) a um preço de 1.6063 $/Kg. As restrições de pureza destes produtos 

são de 99.5% molar no mínimo de propeno para o P5, e de 5% molar no máximo de 

propeno na vazão do produto P4. 

Na tabela 4.2, os resultados da simulação e a otimização são apresentados, 

comparando-se as variáveis de decisão, as vazões dos produtos finais e o lucro 

operacional bruto obtido na unidade de produção de propeno.  

Nessa otimização foram consideradas 13640 variáveis, 13634 equações, 6 graus de 

liberdade e 22 restrições de desigualdade. Pelas características e pelas dificuldades 

que apresenta o software EMSO referente ao arquivo de dados iniciais (não é 

automática a atualização desse arquivo) para à otimização, o tempo computacional 

na resolução do problema de otimização não será considerado neste trabalho. 

Nesta tabela pode-se observar que o lucro bruto operacional vai de 68947.75 ($/h) 

para 71622.92 ($/h) o que significa, que considerando uma estrutura centralizada, 

com a otimização o processo incrementará seu lucro bruto operacional em 3.88%, 

esse incremento se deve ao cambio de pontos de operação.  

 

 



78 
 

Tabela 4.2 - Resultados da simulação e a otimização do processo estudado. 

Função Objetivo  
Max Lucro = Preço dos Produtos – Custo 

Vazão de Carga – Custos de Operação  

Coluna Variáveis  Simulação (Projeto)  Otimização  

T-1 

Vazão do Produto P1 (Kg/h) 8181.74 8158.40 

Vazão de Produto P2 (Kg/h) 3506.46 3496.46 

Vazão da Corrente 5 (Kg/h) 9919.08 9952.42 

Splitter de Refluxo SR1  0.676000 0.671093 

Splitter de Reboiler SB1 0.772000 0.770792 

T-2 

Vazão do Produto P3 (Kg/h) 742.850 351.064 

Vazão da Corrente 17 (Kg/h) 9176.22 9601.36 

Splitter de Refluxo SR2 0.949000 0.976064 

Splitter de Reboiler SB2 0.720000 0.707796 

T-3 

Vazão do Produto P5 (Kg/h) 6542.86 6921.86 

Pureza do Produto P5 (Propeno % 
molar)  

0.999900 0.995001 

Vazão do Produto P4 (Kg/h) 2633.36 2679.5 

Pureza do Produto P4 (Propeno % 
molar)  

0.028100 0.023879 

Splitter de Refluxo SR3 0.076480 0.080226 

Splitter SC1 0.209030 0.213737 

Lucro ($/h) 68947.75 71622.92 

Fonte: Dados da planta e resultados obtidos. 

 

Devido aos preços de mercado os produtos P1 e P2 diminuem suas vazões de 

8181.74 (kg/h) e 3506.46 (kg/h) para 8158.4 (kg/h) e 3496.46 (kg/h) 

respectivamente. Como consequência, a corrente intermediária 5 é incrementada de 

9919.08 (kg/h) para 9952.42 (kg/h). Já na coluna T-2 o produto P3, também devido 

ao seu preço de mercado, diminui sua vazão de 742.85 (kg/h) para 351.064 (kg/h). A 

corrente intermediaria 17 incrementa sua vazão de 9176.22 (kg/h) para 9601.36 

(kg/h). Na coluna T-3 tanto a vazão do produto P5 (propeno) e P4 (propano) são 

incrementados. Esse incremento se deve a que o preço de mercado de propeno é 

favorável (maior), então, na otimização tentara produzir a maior vazão possível de 

propeno o que significa que a restrição de pureza tem que bater no limite inferior 

(99.5%) que é como acontece neste processo estudado. Estes valores obtidos serão 

utilizados para ser comprados com os valores das vazões e o lucro bruto operacional 

a ser obtidos considerando uma estrutura distribuída.  



79 
 

5. APLICAÇÃO DAS TÉCNICAS DE DECOMPOSIÇÃO AO PROCESSO 

ESTUDADO 

 

Nesta seção é apresentada a aplicação das técnicas mais promissoras para resolver 

o problema de decomposição para a otimização da unidade de produção de propeno 

descrita na seção anterior. São analisadas as respostas e discutidos os problemas 

que apresentam essas técnicas.  

 

5.1. TÉCNICAS DE DECOMPOSIÇÃO APLICADAS AO PROCESSO ESTUDADO 

 

O problema pode ser decomposto em subproblemas para cada uma das divisões, 

sendo S-1 para a divisão da Depropanizador, S-2 para a divisão da De-etanizadora 

e S-3 para a divisão da fracionadora de propeno. Na figura 5.1 pode-se observar 

uma estrutura que pode ser decomposta em três subproblemas, no entanto é preciso 

adicionar e/ou substituir novas variáveis e equações ao modelo descrito na seção 4. 

Estas variáveis correspondem aos produtos intermediários de cada uma das 

divisões.  

Então o problema de otimização para o processo estudado tem a seguinte estrutura: 

Maximizar    Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3   

sujeito a: 

  Restrições de Operação da Divisão S-1 

  Restrições de Operação da Divisão S-2 

  Restrições de Operação da Divisão S-3 

    5S1 = 5S2 

            17S2 = 17S3 

Onde Pr1, Pr2, Pr3, Pr4 e Pr5 são os preços de mercado dos produtos P1, P2, P3, P4 e 

P5 respectivamente. Pc é o custo da vazão de carga F e Cops-1, Cops-2 e Cops-3 são 

os custos operacionais das divisões S-1, S-2 e S-3 respectivamente. 

 

 



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

F
ig

u
ra

 5
.1

 -
 F

lu
x
o

g
ra

m
a

 s
im

p
lif

ic
a
d

o
 d

a
 u

n
id

a
d

e
 d

e
 p

ro
d

u
ç
ã

o
 d

e
 p

ro
p
e

n
o
 d

e
c
o

m
p

o
s
ta

 

e
m

 t
rê

s
 s

u
b

p
ro

b
le

m
a

s
. 

80 

F
o

n
te

: 
E

la
b

o
ra

ç
ã

o
 p

ró
p

ri
a

 e
m

 b
a

s
e
 a

 d
a

d
o
s
 d

o
 p

ro
je

to
. 



81 
 

Na aplicação desta técnica foram utilizados os mesmos valores da otimização com 

estrutura centralizada descrita na seção 4 para: os preços de mercado dos produtos 

finais, a vazão de carga da T-1, o consumo energético, o consumo de água de 

resfriamento e o consumo de vapor para os reboilers. 

As variáveis 5S1 e 5S2 representam a corrente intermediária entre S-1 e S-2 

respectivamente, e 17S2 E 17S3 e 17S3 são as vazões da corrente intermediaria 

entre S-2 e S-3 como mostra a figura 5.1. 

Por meio das técnicas de decomposição, o problema primal foi decomposto em três 

subproblemas correspondentes a cada uma das divisões. Pretende-se atingir o 

maior lucro possível da unidade de produção de propeno, otimizando 

separadamente cada uma das divisões. 

 

5.1.1. Decomposição Lagrangeana aplicada ao Processo Estudado 

 

De acordo com esta técnica, identificadas as restrições complicadoras, o problema 

primal é relaxado, levando as restrições complicadoras para a função objetivo. Como 

existem duas restrições complicadoras, e por conceitos de dualidade serão 

adicionados dois multiplicadores de Lagrange,  ?1 para a restrição 5S1 = 5S2 e ?2 

para a restrição 17S2 = 17S3. 

A função Lagrangeana fica: 

L= Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3 

     +?1.(5S1-5S2) + ?2.( 17S2-17S3) 

Então o problema de otimização relaxado fica: 

Max   Pr1.P1 + Pr2.P2 - Pc.F + Pr3.P3 + Pr4.P4 + Pr5.P5 - Cops-1 - Cops-2 - Cops-3             

+ ?1.(5S1-5S2) + ?2.( 17S2-17S3) 

sujeito a: 

        Restrições de Operação da Divisão S-1 

        Restrições de Operação da Divisão S-2 

        Restrições de Operação da Divisão S-3 



82 
 

Assim, seguindo o algoritmo mostrado no capitulo 3 da técnica de decomposição por 

relaxação Lagrangeana, considerando três subproblemas para cada seção da 

unidade, têm-se: 

Passo 0: Inicialização 

  v = 1 

  ?1
(v)

 = ?1
0
 = 1.62 $/kg 

  ?2
(v)

  = ?2
0
 = 2.52 $/kg 

  a = 1 

  b = 0.1 

  ? = 0.01 

Os valores de ?1
0
 e ?2

0
 foram designados arbitrariamente com base nos preços de 

mercado dos co-produtos da seção S-1 e S-2. Para os parâmetros a e b, foram 

considerados valores sugeridos pela literatura (Conejo et al., 2006). A diferença 

aceitável entre os multiplicadores de duas iterações consecutivas é de 0.01. 

Passo 1: Resolver o problema primal relaxado decomposto em três subproblemas 

como se mostra a seguir: 

Subproblema para a divisão da deporpanizadora (S-1): 

  Max   Pr1.P1 + Pr2.P2 - Pc.F - Cops-1 + ?1
(v)

.5S1
(v)

    

  sujeito a: 

    Restrições de Operação da Divisão S-1 

Subproblema para a divisão da De-etanizadora (S-2): 

  Max   Pr3.P3 - Cops-2 - ?1
(v)

.5S2
(v)

 + ?2
(v)

.17S2
(v)

    

  sujeito a: 

    Restrições de Operação da Divisão S-2 

Subproblema para a divisão da fracionadora de propeno (S-3): 

  Max  Pr4.P4 + Pr5.P5 - Cops-3  - ?2
(v)

.17S3
(v)

    

  sujeito a: 

    Restrições de Operação da Divisão S-3 



83 
 

cujas soluções serão denotadas como: 5S1
(v)

, 5S2
(v)

, 17S2
(v)

, 17S3
(v)

. 

Passo 2: Atualização do Multiplicador. 

Para atualizar o multiplicador, será utilizado o método do sub-gradiente, 

provavelmente a sugestão mais clássica da literatura. 

Fazendo  k
(v)

 = 
?

?? ?.?
  onde k é a constante de relaxação. 

Para primeiro multiplicador ?1 
(v+1)

  

?1
 (v+1)

 = ?1
 (v)

 + k
(v)

 
??

(?)

????
(?)??

 

em que 

S1
(v)

 = 5S2
(v)  

- 5S1
(v)

 

Para segundo multiplicador ?2 
(v+1)

  

?2
 (v+1)

 = ?2
 (v)

 + k
(v)

 
??

(?)

????
(?)??

 

em que 

S2
(v)

  = 17S3
(v) 

- 17S2
(v)

 

Passo 3: Revisão de Convergência (Critério de parada). 

Neste passo, se: 

|?1
 (v+1)

 - ?1
 (v)

 | ? ? 

e 

|?2
 (v+1)

 - ?2
 (v)

 | ? ? 

então as desigualdades estão satisfeitas e pode-se parar o algoritmo já que a 

solução ótima foi encontrada, neste caso, a solução é: 5S1*= 5S1
(v)

, 5S2*= 5S2
(v)

, 

17S2*= 17S2
(v)

, 17S3*= 17S3
(v)

. Caso contrário, voltar ao passo 1. 

Para a aplicação desta técnica foram modeladas, simuladas e otimizadas as três 

divisões de forma separada e com as mesmas características do computador citados 

na seção 4. A divisão da Depropanizadora para a otimização conta com 2393 



84 
 

variáveis, 2391 equações de igualdade e 8 equações de desigualdade pelo que esta 

divisão tem 2 graus de liberdade. As duas variáveis de decisão são o splitter do 

refluxo (SR1) e o splitter do reboiler (SB1).  

A divisão da De-etanizadora, para a otimização são utilizadas 2746 variáveis, 2743 

equações de igualdade e   10 equações de desigualdade, pelo que esta divisão tem  

3 graus de liberdade. As três variáveis de decisão são a corrente de carga da 

segunda divisão (5S2), o splitter do refluxo (SR2) e o splitter do reboiler (SB2). 

A terceira divisão (fracionadora de propeno) para a otimização foram utilizadas 8510 

variáveis, 8507 equações de igualdade e 10 equações de desigualdade, pelo que 

este problema de otimização tem 3 graus de liberdade. As três variáveis de decisão 

são a corrente de alimentação para a T-3 (17S3), o splitter do refluxo (SR3)   o 

splitter que esta na saída do compressor (SC1). 

Os resultados das iterações da decomposição por relaxação Lagrangeana são 

mostrados na seguinte tabela: 

 

Tabela 5.1 - Respostas da relaxação Lagrangeana. 

Iteração # ?1 ?2 
5S1 

(kg/h) 
5S2 

(kg/h) 
17S2 
(kg/h) 

17S3 
(kg/h) 

P5 
(kg/h) 

1 1.620 2.520 9885.44 10772.40 10061.80 10061.80 7261.30 

2 3.256 2.520 9964.36 4939.00 4613.64 10061.80 7261.30 

3 1.756 4.020 9885.48 10772.50 10061.80 10061.80 7261.32 

4 3.141 4.020 9964.62 10429.28 10061.80 10061.80 7261.32 

5 4.427 4.020 9963.90 4939.00 4766.86 10061.80 7261.32 

6 3.227 5.220 9964.76 10429.32 10061.80 4573.60 3300.30 

7 4.352 4.095 9964.76 4939.02 4767.00 10061.80 7262.76 

8 3.293 5.154 9964.54 10429.26 10061.80 4573.60 3299.06 

9 4.293 4.154 9964.74 4939.00 4766.98 10061.80 7262.80 

10 3.346 5.101 9964.74 10429.26 10061.80 4573.60 3300.44 

Fonte: Elaboração própria em base as respostas obtidas. 

 

Nesta técnica, com os valores iniciais de ?1 e ?2, os subproblemas podem ser 

resolvidos separadamente para determinar os valores das correntes intermediárias 

5S1, 5S2, 17S2 e 17S3. Os multiplicadores de Lagrange são ajustados 

repetidamente até que a restrição de consistência seja satisfeita. Embora esta seja 

uma técnica amplamente empregada, não pode resolver este problema específico: 

não há ?1 e ?2 capazes de garantir que a restrição complicadora de consistência  



85 
 

seja satisfeita, pelo que tem um comportamento oscilatório (ver Figura 5.2) e não 

consegue convergir. 

 

Figura 5.2 - Problema de convergência da decomposição Lagrangeana. 

 
 Fonte: Elaboração Própria. 

 

Só foram realizadas 10 iterações já que estas são suficientes para mostrar o 

comportamento oscilatório dos valores dos multiplicadores de Lagrange e das 

vazões de carga das divisões S1 e S2, este comportamento acontece devido as 

seguintes causas (Jose e Ungar, 2000): 

Causa 1: Divisões indiferentes. 

Quando uma ou mais divisões são indiferentes ao valor de um estado de fluxo entre 

processos, a substituição de Lagrange falhará. Esta falha pode ser explicada 

utilizando o método dos multiplicadores de Lagrange. Considere o seguinte 

problema de otimização 

  Maxx1,x2  ƒ(x1,x2)  

  sujeito a:   

     Restrições x1 

     Restrições x2 

     g(x1,x2) &amp;lt;0 

A solução para este problema pode ser encontrada através da representação gráfica 

da restrição g(x) = 0 e os conjuntos de nível de f(x) em um único gráfico. A solução 

1.0

2.0

3.0

4.0

5.0

1 2 3 4 5 6 7 8 9 10

M
u
lt
ip

lic
a
d
o

re
s
 d

e
 L

a
g
ra

n
g
e

Iteração #

?1

?2



86 
 

ocorre onde a função objetivo é tangente à curva da restrição no ponto ótimo, o que 

significa que neste ponto, os gradientes da função objetivo e da restrição são 

linearmente dependentes. Uma ilustração desse fato está apresentada na figura 5.3, 

em que x1 e x2 são as variáveis independentes, f(x) é a função objetivo, C1, C2 e C3 

são os valores da função objetivo com C1 &amp;lt;C2 &amp;lt;C3 e g(x) é a restrição ativa de 

desigualdade. Esta condição de dependência linear pode ser definida como: 

?ƒ(x*) = ?.	?g(x*) 

em que ? é o multiplicador de Lagrange e x* é a solução ótima. 

 

Figura 5.3 - Dependência linear dos gradientes. 

 
 Fonte: Jose e Ungar (2000). 

 

Agora, considerando um problema similar, mas menos complexo que o problema 

estudado, tem-se: 

  Maxx1,x2  ƒ(x1,x2)  

  sujeito a: 

     Restrições x1 

     Restrições x2 

     h(x1,x2) =  0 

Fazendo um gráfico para a restrição x1 - x2 = 0 e os conjuntos de nível da função 

objetivo, como mostra a figura 5.4, pode-se observar que os conjuntos de nível da 

função objetivo e as restrições nunca são tangentes. A condição ?f = ?.?h 

(dependência linear) é verdadeira apenas quando ?f = 0 e ? = 0. Esta pode ser a 

resposta correta para o problema antes que ele seja decomposto, mas depois da 



 

decomposição um multiplicador de Lagrange igual a

multiplicador desse tipo implica que a restrição de consistê

Assim, a decomposição por relaxação Lagrangeana não pode ser aplicada neste 

tipo de problema. 

 

Figura 5.4 - Dependência

 Fonte: Jose e Ungar (2000).

Causa 2: Divisões com objetivos lineares

Considere o seguinte problema de otimização

  Maxx1,x2  

  Sujeito a: 

     

     

     

em que k1, k2 ? 0 e x1, x2  

Lagrangeana obtém-se os seguintes 

  Maxx1   

  Sujeito a: 

     

e 

  Maxx2   

  Sujeito a:  

     

um multiplicador de Lagrange igual a zero é inútil

implica que a restrição de consistência pode ser ignorada

decomposição por relaxação Lagrangeana não pode ser aplicada neste 

Dependência linear dos gradientes para o problema estudado

 
gar (2000). 

 

ivisões com objetivos lineares. 

Considere o seguinte problema de otimização 

 k1.x1 + k2.x2 

 Restrições da divisão 1 

 Restrições da divisão 2 

 x1 = x2 

  ? R. Aplicando a técnica de decomposição por relaxação

os seguintes subproblemas 

 k1.x1 + ?.x1 

 Restrições da divisão 1 

 k2.x2 - ?.x2 

 

 Restrições da divisão 2 

87 

zero é inútil, pois um 

ncia pode ser ignorada. 

decomposição por relaxação Lagrangeana não pode ser aplicada neste 

linear dos gradientes para o problema estudado. 

de decomposição por relaxação 



88 
 

Se ? &gt; - k1, a divisão 1 propõe o seu valor máximo possível de x1; se ? &amp;lt;- k1, a 

divisão 1 propõe a seu mínimo valor possível. Da mesma forma, se ? &gt; k2, a divisão 

2 propõe seu valor mínimo possível de x2; se ? &amp;lt;k2, a divisão 2 propõe o seu valor 

máximo possível.  Uma vez que, em geral, todas estas possíveis propostas são 

diferentes, não há um ? capaz de garantir que a restrição x1 = x2 seja satisfeita. 

Assim, o problema de decomposição por relaxação Lagrangeana não irá convergir. 

A resposta obtida do caso estudado é mostrada nas seguintes figuras. 

Pode-se observar na figura 5.5 que as vazões, dependendo do valor do multiplicador 

de Lagrange, são dadas por um limite de capacidade. Para o subproblema da T-1 

(5S1) não existe muita variação já que a corrente de entrada é fixada e também por 

que os limites de pureza de topo e fundo são muito fortes (99.9 % e 1% molar 

respectivamente). 

 

Figura 5.5 - Vazão corrente intermediária 5S1-5S2. 

 
     Fonte: Elaboração própria. 

 

Na figura 5.6 mostra-se que a causa do valor do multiplicador de Lagrange (?2) para 

a corrente intermediaria 17S3 é mantida constante no limite máximo de capacidade 

operacional da coluna T-3 durante as 5 primeiras iterações, isso se deve a que o 

valor de ?2 é menor ao preço de mercado do produto P5 o que significa que essa 

divisão consegue gerar lucro e por conseguinte processará a máxima vazão 

possível. 

4000

5000

6000

7000

8000

9000

10000

11000

1 2 3 4 5 6 7 8 9 10

V
a
z
ã
o

Iteração #

5D_1

5D_2

Estruc. Cent.



89 
 

De acordo com o valor do multiplicador e os preços de mercado dos coprodutos, há 

oscilações entre uma produção máxima ou mínima.  Portanto, como a corrente de 

entrada da T-1, é fixada as vazões de carga das colunas T-2 e T-3 tem que 

convergir num ponto intermediário e não em um máximo ou mínimo de capacidade, 

então o problema de decomposição por relaxação Lagrangeana não irá convergir.   

 

Figura 5.6 - Vazão corrente intermediaria 17S2-17S3. 

 

     Fonte: Elaboração própria. 

 

Devido a não existir convergência dos multiplicadores de Lagrange devido às causas 

apresentadas, a decomposição pelo método de relaxação Lagrangeana não é 

recomendada para este tipo de problemas.  

Como o método de Lagrangeano aumentado é baseado no método de relaxação 

Lagrangeana, este também vai apresentar os mesmos problemas pelo que não será 

realizada a aplicação desta técnica. 

 

5.1.2. Pricing Interprocess Streams Using Slack Auctions Aplicada ao 

Processo Estudado 

 

De acordo com esta técnica, uma vez identificadas as restrições complicadoras, o 

problema de otimização global é relaxado, colocando assim as restrições 

complicadoras multiplicadas pelo preço (p). Como existem duas restrições 

4000

5000

6000

7000

8000

9000

10000

11000

1 2 3 4 5 6 7 8 9 10

V
a
z
ã
o

Iteração #

17D_2

17D_3

Estruc. Cent.



90 
 

complicadoras, serão adicionados dois multiplicadores : p1 para a restrição 5S1 = 

5S2 e p2 para a restrição 17S2 = 17S3. 

Então seguindo o algoritmo mostrado na seção 3 da técnica de decomposição por 

pricing interprocess streams using slack auctions, considerando três subproblemas 

para cada seção da unidade, tem-se: 

Passo 0: Inicialização. 

Fornecer valores iniciais para 

v = 1 

p
(v)

1 =  1.62 $/kg 

p
(v)

2 =  2.52 $/kg 

5S1
0
 = 9919 kg/h 

5S2
0
 = 9919 kg/h 

17S2
0
 = 9176.22 kg/h 

17S3
0
 = 9176.22 kg/h 

S1 = 0.01 kg/h (Folga de recursos Restrição complicadora 1) 

S2 = 0.01 kg/h (Folga de recursos Restrição complicadora 2) 

Passo 1: Resolver os subproblemas. 

O subproblema para a divisão da depropanizadora (S-1): 

 Max   Pr1.P1 + Pr2.P2 – p1
(v)

.½ .|5S1
(v) 

– 5S2
0
| - Prc.F - CopS-1    

 sujeito a: 

   Restrições de Operação da Divisão S-1 

O subproblema para a divisão da De-etanizadora (S-2): 

 Max  Pr3.P3 – p1
(v)

.| 5S2
(v)

 – 5S1
0 

| - p2
(v)

.|17S2
 (v) 

– 17S3
0
| - CopS-2

    

 sujeito a: 

   Restrições de Operação da Divisão S-2 

O subproblema para a divisão da Fracionadora de Propeno (S-3): 

 Max   Pr4.P4 + Pr5.P5  – p2
(v)

.| 17S3
 (v) 

– 17S2
0
| - CopS-3    



91 
 

 sujeito a: 

   Restrições de Operação da Divisão S-3 

em que as soluções serão denotadas como: 5S1
(v)

, 5S2
(v)

, 17S2
(v)

, 17S3
(v)

. 

Passo 2: Critério de Convergência. 

Se |5S1
(v)

 – 5S2
(v)

| ? S1 , e, |17S2
(v)

, 17S3
(v)

| ? S2 então a solução foi encontrada, 

caso contrário passa-se ao passo 3. 

Passo 3: Atualizar os valores de referência. 

  5S1
0
  ? 5S2

(v)
 

  5S2
0
  ? 5S1

(v)
 

  17S2
0
 ? 17S3

(v) 

  17S3
0
 ? 17S2

(v)
 

Para ajustar os preços de p1
(v)

 e p2
(v)

 por leilão é utilizado o excesso de demanda 

E1
(v)

 e E2
(v)

:  

Se E1
(v) 

= 5S2
(v)

 - 5S1
(v)

 &amp;lt;0 então p1
(v)

 tem que baixar seu valor de preço, se E1
(v) 

= 

5S2
(v)

 - 5S1
(v)

 &gt; 0 então p1
(v)

 tem que incrementar seu valor de preço. 

Se E2
(v) 

= 17S3
(v)

- 17S2
(v)

 &amp;lt;0 então p2
(v)

 tem que baixar seu valor de preço, se E1
(v) 

= 

17S3
(v) 

- 17S2
(v)

 &gt; 0 então p2
(v)

 tem que incrementar seu valor de preço. 

E por ultimo voltar para o passo 1. 

Os resultados das iterações desta técnica são mostrados na tabela 5.2. Na 

otimização com estrutura distribuída utilizando este método de decomposição foram 

considerados, para a divisão S-1, 2393 variáveis, 2391 equações e 6 restrições de 

desigualdade, o que significa que essa divisão tem 2 graus de liberdade. Na divisão 

S-2 foram utilizadas 2746 variáveis, 2743 equações e 10 restrições de desigualdade, 

dando lugar a 3 graus de liberdade para essa divisão. Já na divisão S-3 foram 

utilizadas 8510 variáveis, 8507 equações e 10 restrições de desigualdade. Essa 

divisão tem 3 graus de liberdade.  

Na tabela pode-se observar que a um preço (p1) de 7.02 $/kg atinge-se a maior 

vazão do produto intermediário 5S1, já que a restrição de pureza de topo é ativa 

(0.1% molar dos produtos pesados C4
+
) e a restrição de pureza de fundo é inativa já 



92 
 

que se procura produzir mais C3 como produto intermediário. Isto acontece porque o 

peso na função objetivo para reduzir a diferença das vazões das correntes 

intermediárias entre as duas divisões (S-1 e S-2) é maior do que o preço dos 

coprodutos P1 e P2. O preço adotado no leilão não tem sentido econômico concreto, 

já que é muito elevado, sendo inclusive maior do que o preço do produto principal 

(propeno) na S-3.  

Tabela 5.2 - Respostas pricing interprocess streams using slack auctions. 

Iteração 
# 

p1 
($/kg) 

p2    
($/kg) 

5S1   
(kg/h) 

5S2   
(kg/h) 

17S2 
(kg/h) 

17S3 
(kg/h) 

P5   
(kg/h) 

1 1.62 2.52 9880.1 9686.62 9046.68 10061.8 7259.84 

2 3.42 4.32 9885.56 10772.92 10061.16 10061.8 7259.84 

3 5.22 6.12 9952.32 10773.54 10061.74 10061.8 7259.84 

4 7.02 7.92 9962.44 10405.92 9890.08 10061.8 7259.82 

5 7.02 9.72 9960.80 10615.50 10061.80 10061.34 7259.52 

Fonte: Elaboração própria em base as respostas obtidas. 

 

A seguir mostra-se a formulação do problema de otimização para esta divisão. 

 Max   Pr1.P1 + Pr2.P2 – p1
(v)

.½ .|5S1
(v) 

– 5S2
0
| - Prc.F - CopS-1    

 sujeito a: 

   Restrições de Operação da Divisão S-1 

Em que Pr1 e Pr2  são os preços de mercado dos produtos finais da S-1 que são 

1.6063 e 2.424 $/kg respectivamente, Prc é o preço da vazão da carga (1.6063 $/kg) 

e CopS-1 é o custo operacional desta seção. Como se pode observar, o algoritmo 

sempre vai tentar zerar a diferença |5S1
(v) 

– 5S2
0
| colocando um peso p1

(v)
, fazendo 

com que o preço do produto intermediário não tenha um significado econômico 

válido. 

Já na seção S-2 acontece o mesmo problema, já que para os valores apresentados 

nos preços de leilão, que são superiores ao preço de mercado do propeno, sempre 

tenta-se produzir a maior vazão possível de etano. Isso fazcom que a restrição de 

topo da T-2 seja ativa (35% molar de propano e propeno), o que significa que 

existiria demasiado produto principal (propeno) saindo na vazão do etano. O 

problema de otimização para esta seção é mostrado a seguir: 

 Max   Pr3.P3 – p1
(v)

.| 5S2
(v)

 – 5S1
0 

| - p2
(v)

.|17S2
 (v) 

– 17S3
0
| - CopS-2

  



93 
 

sujeito a: 

   Restrições de Operação da Divisão S-2 

Em que Pr3 é o preço de mercado do produto final da S-2 (etano) que é de 2.736 

$/kg, CopS-2 é o custo operacional desta seção. A situação é análoga à anterior, com 

as diferenças | 5S2
(v)

 – 5S1
0 

| e |17S2
 (v) 

– 17S3
0
| no qual o algoritmo sempre tenta 

zerar essas diferenças. 

Na seção S-3, o problema que apresenta é muito parecido à técnica de relaxação 

Lagrangeana, isto devido a que os produtos finais tem um preço elevado, então 

sempre vai tentar produzir a maior quantidade possível. A única forma de se ter uma 

produção com uma quantidade intermediária é elevando o preço do leilão, mas se 

este preço é maior do que os dos produtos finais então a divisão teria um prejuízo 

por causa da corrente intermediária. O problema de otimização para esta divisão é 

mostrado a seguir: 

 Max   Pr4.P4 + Pr5.P5  – p2
(v)

.| 17S3
 (v) 

– 17S2
0
| - CopS-3    

 sujeito a: 

   Restrições de Operação da Divisão S-3 

Em que Pr4 e Pr5  são os preços de mercado dos produtos finais da S-3 que são 

1.6063; 6.273 $/kg respectivamente e CopS-3 é o custo operacional desta seção. 

Desta vez apenas a diferença | 17S3
 (v) 

– 17S2
0
| é que tende a ser zerada através de 

um peso p2
(v)

. 

Nesta técnica os valores iniciais para o leilões dos preços são incrementados até 

encontrar convergência entre as correntes intermediárias, ou seja, que a diferença 

entre estas correntes seja menor a uma folga determinada no inicio do algoritmo. 

Contudo, considerando que é um processo com uma entrada e duas saídas 

(produção conjunta), esta técnica tenta maximizar a vazão de saída do produto final 

de cada seção e não do produto intermediário, perdendo assim a sensibilidade da 

produção com respeito ao preço. Isto ocorre porque ao colocar um peso (preço de 

leilão) para a restrição complicadora, tenta-se zerar a diferença entre as correntes 

intermediárias das duas divisões (ver figura 5.7). 

 

 



94 
 

Figura 5.7 - Pricing interprocess streams using slack auctions aplicado ao processo de produção 
conjunta - função objetivo dos subproblemas. 

 

 

 

 

 

 

 

 

 

 

 

Fonte: Elaboração própria. 

 

Feita a análise da aplicação deste método pode-se determinar que não é eficaz para 

o tipo de problema estudado, ou seja, os preços de leilão apresentados não fazem 

sentido econômico para problemas com produção conjunta, ou seja onde existam 

coprodutos. Normalmente este método é aplicado a processos que só tenham uma 

entrada e uma saída, fazendo com que não exista a escolha de vazões de produtos 

finais entre duas divisões. 

 

5.1.3. Proposta modificação do algoritmo de relaxação Lagrangeana 

 

Depois de fazer uma analise dos problemas que apresentam as técnicas de 

decomposição estudadas, foi desenvolvida uma proposta de modificação do 

algoritmo a ser avaliada para resolução de problemas de decomposição na 

otimização da unidade de produção de propeno (figura 5.8) que é apresentada a 

continuação: 

 

 

Pr2*P3 

 

T?1 - Prc*F 

 - p1
(v)

* ½ *|5S1
(v) 

– 5S2
0
| 

Pr1*P1 

Pr2*P2 

- p1
(v)

*| 5S2
(v)

 – 5S1
0 
|  

 

T?2 

- p2
(v)

*|17S2
 (v) 

– 17S3
0
| 

– p2
(v)

*| 17S3
 (v) 

– 17S2
0
| 

 

T?3 

Pr5*P5 

Pr4*P4 



95 
 

Figura 5.8 - Fluxograma simplificado da unidade de produção de propeno - algoritmo proposto. 

 

 

 

 

 

 

 

 

 

 

 

 

 
Fonte: Elaboração própria. 

 

Para ilustrar a modificação no algoritmo de resolução de problemas por 

decomposição Lagrangeana, mostrado na figura 5.9 é apresentado um fluxograma 

com os passos do algoritmo que serão explicados a continuação: 

Passo 0: Inicialização. 

Considerando que o problema é de maximização, o algoritmo inicia dando um valor 

para o contador de iterações v: 

v = 1 

Os valores iniciais dos multiplicadores (?1
0
, ?2

0
) são fornecidos para a primeira 

iteração como é mostrado a seguir: 

?1
(v)

 = ?1
(0)

; ?2
(v)

 = ?2
(0) 

onde ?1
0
 = 1.62 $/kg e ?2

0
 = 2.52 $/kg. Estes valores foram atribuídos arbitrariamente 

com base nos preços de mercados dos produtos finais em cada divisão. 

Além de fornecer valores iniciais para os multiplicadores, é preciso fornecer valores 

iniciais para os limites de produção disponível, estes valores iniciais são a 

capacidade máxima de produção de cada divisão. 

 

 

T?1 - Prc*F 

 ?1*5S1
(v) 

 

Pr1*P1 

Pr2*P2 

-?1*5S2
(v)

  

 

T?2 

Pr2*P3 

?2*17S2
 (v)

 

-?2*17S3
 

 

T?3 

Pr5*P5 

Pr4*P4 



96 
 

Figura 5.9 - Fluxograma do algoritmo proposto. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Fonte: Elaboração própria. 

 

Onde: 

LPD1
(0)

 = Capacidade de produção da T-2 = 10772 kg/h. 

LPD2
(0)

 = Capacidade de produção da T-3 = 10061 kg/h. 

5S1(V) 

17S2(V) 

Passo 0: Inicialização 

v = 1; ?1
(v) = ?1

(0); ?2
(v) = ?2

(0); a; b; ? é definido; 

LPD1
(v)

 = LPD1
(0)

; LPD2
(v)

 = LPD2
(0)

;  

 

Passo 2: Atualizar os multiplicadores: 

de  ?1
(v)

, ?2
(v)

 para ?1
(v+1)

, ?2
(v+1)

; 

Atualizar os limites de produção 

disponível: 

de  LPD1
(v), LPD 2

(v) para LPD 1
(v+1), LPD 2

(v+1); 

 

Problema mestre: Método do 

Subgradiente: 

?1
(v+1) = ?1

(v) + 
?

?	? 	?.?
 . 
(???(?)? ???(?))

????(?)? ???(?)?
 

?2
(v+1)

 = ?2
(v)

 + 
?

?	? 	?.?
 . 
(????(?)? ????(?))

?????(?)? ????(?)?
 

Para os limites de produção disponível: 

LPD1
(v+1)

 ? 5S1
(v)

; 

LPD2
(v+1)

 ? 17S2
(v)

; 

 

Passo 3: Critério de Convergência: 

???
(?? ?)

? ??
(?)

?	? ? ; ???
(?? ?)

? ??
(?)

?	? ? 

Solução encontrada: 

5S1* = 5S1
(v)

; 5S2* = 5S2
(v)

 

17S2* = 17S2(v); 17S3* = 17S3(v) 

v ? v + 1 
sim não 

LPD1
(0)

 ? Capacidade Máxima de S2; 

LPD2
(0) ? Capacidade Máxima de S3; 

 

Passo 1: Resolução dos 3 subproblemas. 

Max    Pr1.P1 + Pr2.P2 + ?1.5S1
(v) – Prc.F – Cops?1 

sujeito a: 
 Restrições de S?1 

Max    Pr3.P3 + ?2.17S2
(v) ? ?1.5S2

(v) – Cops?2 
sujeito a: 
 Restrições de S?2 
 5S2 ? LPD1

(v) 

Max    Pr4.P4 + Pr5.P5 – ?2.17S3
(v) – Cops?3 

sujeito a: 
 Restrições de S?3 
 17S3 ? LPD2

(v) 



97 
 

Esse limite de produção disponível (LPD) é a modificação realizada no algoritmo, 

com essas restrições já existe um sentido de disponibilidade (escassez) do produto a 

ser processado. 

É importante fornecer ?, uma diferença aceitável entre os valores dos multiplicadores 

de iterações consecutivas para o critério de convergência do algoritmo. Para este 

problema, tanto para |?1
(v+1)

 - ?1
(v)

| como para |?2
(v+1)

 - ?2
(v)

|, o valor atribuído para  ? é 

de 0.01. 

Passo 1: Solução do problema primal relaxado. 

Resolver os 3 subproblemas gerados a partir da relaxação das variáveis 

complicadoras do problema primal. 

Subproblema para a divisão da depropanizadora (S-1): 

  Max   Pr1.P1 + Pr2.P2 + ?1
(v)

.5S1
(v) 

- Prc.F - CopS-1    

  sujeito a: 

    Restrições de Operação da Divisão S-1 

Subproblema para a divisão da De-etanizadora (S-2): 

  Max   Pr3.P3 + ?2
(v)

.17S2
(v) 

- ?1
(v)

.5S2
(v)

 - CopS-2   

  sujeito a: 

    Restrições de Operação da Divisão S-2 

    5S2 ? LPD1
(v)

 

Subproblema para a divisão da fracionadora de propeno (S-3): 

  Max   Pr4.P4 + Pr5.P5  - ?2
(v)

.17S3
(v)

 - CopS-3   

  sujeito a: 

     

Restrições de Operação da Divisão S-3 

    17S3 ? LPD2
(v)

 

cujas soluções serão denotadas como: 5S1
(v)

, 5S2
(v)

, 17S2
(v)

, 17S3
(v)

. Também 

foram adicionadas as restrições de produção disponível para a corrente de carga 

das divisões S-2 e S-3, isto para garantir que o produto a ser processado esteja 

disponível. 



98 
 

Passo 2: Atualização do multiplicador  

Para atualizar o multiplicador pode-se utilizar um dos seguintes procedimentos: 

método do subgradiente, cutting plane method, bundle method e thrust region 

method. A atualização do multiplicador é feita desde um problema mestre, que está 

fora dos subproblemas e que na verdade, coordena os subproblemas para que 

possa-se atingir o ótimo do problema primal. O método utilizado neste caso é o de 

subgradiente, isto por que é um dos métodos mas utilizados na literatura de 

problemas de decomposição e que apresenta bons resultados. O procedimento 

clássico do método subgradiente é: 

?1
(v+1)

 = ?1
(v)

 + 
?

?	? 	?.?
 . 

(???(?)? ???(?))

????(?)????(?)?
 

?2
(v+1)

 = ?2
(v)

 + 
?

?	? 	?.?
 . 

(????(?)? ????(?))

?????(?)?????(?)?
 

 

onde os valores dos parâmetros a e b são 1 e 0.1 respectivamente. Esses valores 

foram obtidos da literatura (Conejo et al. 2006). 

 

Também tem que ser atualizado o limite de produção disponível (LPD) da seguinte 

forma: 

LPD1
(v)

 ? 5S1
(v)

; 

LPD2
(v)

 ? 17S2
(v)

; 

Essa atualização garante que a vazão a ser processada esteja disponível, ou seja 

que a corrente de carga da T-2 e T-3 não pode ser maior as correntes dos produtos 

intermediários 5S1 E 17S2 respectivamente. 

Passo 3: Critério de convergência 

O critério de parada do algoritmo tem que satisfazer as seguintes equações: 

|?1
(v+1)

 - ?1
(v)

| ? 	? 

|?2
(v+1)

 - ?2
(v)

| ? 	? 

em que ? é definido no passo 0. Se essas equações de desigualdade são 

respeitadas, então o algoritmo tem que parar e a solução ótima foi encontrada, então 

5S1* = 5S1
(v)

, 5S2* = 5S2
(v)

, 17S2* = 17S2
(v)

, 17S3* = 17S3
(v)

. Caso contrário, o 

algoritmo deve continuar, com v ? v +1 e retornar para o passo 1.  



99 
 

Os resultados das iterações da modificação no algoritmo da decomposição por 

relaxação Lagrangeana são mostrados na tabela a seguir: 

 

 

Tabela 5.3 - Respostas da proposta de modificação do algoritmo de relaxação Lagrangeana. 

Iteração # ?1 ?2 
5S1 

(kg/h) 
5S2 

(kg/h) 
17S2 
(kg/h) 

17S3 
(kg/h) 

P5 
(kg/h) 

1 1.620 2.520 9885.44 10772.40 10061.80 10061.80 7261.30 

2 3.256 2.520 9964.36 4939.00 4613.64 10061.80 7261.30 

3 1.756 4.020 9885.48 9964.36 9619.60 4613.64 3329.02 

4 3.141 2.635 9964.68 4939.00 4613.64 9619.60 6941.70 

5 1.855 3.921 9964.68 9964.68 9609.36 4613.64 3331.38 

6 1.855 2.721 9964.68 9964.68 9603.00 9609.36 6942.94 

7 1.855 3.846 9964.68 9964.68 9606.24 9603.00 6942.08 

8 1.855 2.787 9964.68 9964.68 9606.24 9606.24 6940.20 

9 1.855 2.787 9964.68 9964.68 9606.24 9606.24 6940.20 

Fonte: Elaboração própria em base ás respostas obtidas. 

 

 

Com a modificação no algoritmo de resolução da relaxação Lagarangeana, 

fornecendo os valores iniciais para ?1, ?2, LPD1 e LPD2 os subproblemas podem ser 

resolvidos separadamente determinando assim as vazões das correntes 

intermediárias 5S1, 5S2, 17S2 e 17S3. Os multiplicadores de Lagrange e os limites 

de produção disponível são ajustados a cada iteração até que o critério de 

convergência seja cumprido. Como se pode observar, o critério de convergência é 

cumprido após 9 iterações, isto significa que a modificação do algoritmo consegue 

resolver os problemas que apresenta a técnica clássica. como é mostrado na figura 

5.10. 

As duas causas pelas que a técnica de relaxação Lagrangeana é ineficaz foram 

superadas ao modificar o algoritmo de resolução. A primeira causa que é a 

existência de divisões indiferentes, é superada já que ao momento de incrementar 

uma restrição desigualdade "limite de produção disponível" faz que exista um ponto 

no qual o gradiente da função objetivo e o gradiente da restrição de desigualdade 

(limite de produção disponível) sejam linearmente dependentes quando essa 

restrição é ativa, cumprindo assim as condições de otimalidade mencionadas na 

seção 3. 

 
 



100 
 

Figura 5.10 - Convergência do algoritmo proposto. 

 
     Fonte: Elaboração Própria. 

 

Já a segunda causa que é a existência de objetivos lineares, na qual a restrição de 

capacidade operacional máxima ou mínima de cada subproblema sempre é ativa, foi 

superada devido a que a restrição de "limite de produção disponível" é atualizado a 

cada iteração, garantindo que a restrição de capacidade operacional seja variável 

conforme a disponibilidade de produto a ser processado, assim, a restrição de limite 

de produto disponível será ativa sempre que os preços de mercado sejam 

favoráveis, se os preços de mercado são muito baixos para um determinado produto 

a restrição ativa será a capacidade mínima que pode ser processada em cada 

divisão, garantindo assim que será maximizada a vazão do produto com maior preço 

de mercado como é mostrado nas figuras 5.11 e 5.12. 

Pode-se observar na figura 5.11 que as vazões da corrente intermediaria entre as 

divisões da coluna T-1 (5S1) e T-2(5S2), dependendo do valor do multiplicador de 

Lagrange, são dadas por um limite operacional de capacidade ou de disponibilidade 

de produto. Para o subproblema da T-1 (5S1) não existe muita variação já que a 

corrente de entrada é fixada e também por que os limites de pureza de topo e fundo 

são muito fortes (0.999 e 0.001% molar respectivamente). Já a vazão de carga da 

coluna 2 consegue convergir a partir da iteração numero 5, nesta figura pode se 

observar que os valores das vazões intermediarias 5S1 e 5S2 (9964.68 kg/h) 

alcançam um valor similar ao da vazão da corrente intermediara 5 considerando a 

otimização com estrutura centralizada (9952.42 kg/h).   

1.5

2

2.5

3

3.5

4

4.5

1 2 3 4 5 6 7 8 9

M
u

lt
ip

lic
a

d
o

r 
d

e
 L

a
g

ra
n

g
e

Iteração #

?1

?2



101 
 

Figura 5.11 - Vazão da corrente intermediária 5S1-5S2 utilizando o algoritmo proposto. 

 

     Fonte: Elaboração Própria. 

 

Na figura 5.12 mostra-se que a vazão da corrente 17S2 sofreu uma variação no 

limite máximo da vazão do produto de fundo da T-2, isto a causa que a corrente de 

entrada da coluna T-2 também sofreu uma variação no  limite máximo de carga 

(5S2) para essa coluna. A vazão de carga da coluna T-3 também atualizo o limite de 

produto disponível a ser processado, com estas modificações pode se observar que 

se alcança convergência após 9 iterações. 

 
Figura 5.12 - Vazão da corrente intermediária 17S2-17S3 utilizando o algoritmo proposto. 

 

 Fonte: Elaboração Própria. 

4300

5300

6300

7300

8300

9300

10300

11300

1 2 3 4 5 6 7 8 9

V
a

z
ã

o

Iteração #

5D_1

5D_2

Estruc. Cent. 

4300.000

5300.000

6300.000

7300.000

8300.000

9300.000

10300.000

11300.000

1 2 3 4 5 6 7 8 9

V
a

z
ã

o
 (

k
g

/h
)

Iteração #

17D_2

17D_3

Estruc. Cent.



102 
 

Devido a que existe convergência dos multiplicadores de Lagrange, com a 

modificação do algoritmo de resolução pelo método de relaxação Lagrangeana se 

conseguiu decompor eficazmente o problema estudado. Considerando a otimização 

uma estrutura centralizada se conseguiu um lucro de 71622.92 $/h, já considerando 

uma estrutura distribuída, decompondo o problema em três subproblemas que 

podem ser resolvidos independentemente, se obteve um lucro de 71754.71 $/h, o 

que significa que existe uma diferença de 0.184 % no lucro das duas estruturas de 

problemas de otimização consideradas no problema (tabela 5.4). 

 

Tabela 5.4 - Respostas dos problemas considerando uma estrutura centralizada e distribuída. 

 
Função Objetivo 

Max Lucro = Preço dos Produtos – 
Custo Vazão de Carga – Custos de 

Operação 

Coluna Variáveis 
Simulação 
(Projeto) 

Otimização 
Algoritmo 
Proposto 

T-1 

Vazão do Produto P1 (Kg/h) 8181.74 8158.40 8149.8 

Vazão de Produto P2 (Kg/h) 3506.46 3496.46 3492.6 

Vazão da Corrente 5 (Kg/h) 9919.08 9952.42 9964.72 

Splitter de Refluxo SR1 0.676000 0.671093 0.676971 

Splitter de Reboiler SB1 0.772000 0.770792 0.774288 

T-2 

Vazão do Produto P3 (Kg/h) 742.85 351.064 358.48 

Vazão da Corrente 17 (Kg/h) 9176.22 9601.36 9606.24 

Splitter de Refluxo SR2 0.949000 0.976064 0.973200 

Splitter de Reboiler SB2 0.720000 0.707796 0.693593 

T-3 

Vazão do Produto P5 (Kg/h) 6542.86 6921.86 6940.20 

Pureza do Produto P5 (Propeno % 
molar) 

0.999900 0.995000 0.995001 

Vazão do Produto P4 (Kg/h) 2633.36 2679.5 2666.04 

Pureza do Produto P4 (Propeno % 
molar) 

0.028100 0.023879 0.015298 

Splitter de Refluxo SR3 0.076480 0.080226 0.074642 

Splitter SC1 0.209030 0.213737 0.204296 

 
Lucro Operacional Bruto ($/h) 68947.75 71622.92 71754.71 

Fonte: Elaboração própria em base ás respostas obtidas. 

 

Essa diferença entre o lucro bruto operacional da estrutura centralizada e distribuída 

se deve a que o problema estudado é altamente não linear, o que significa que as 

respostas encontradas são consideradas como ótimos locais, ou seja, pode ter 

acontecido ao resolver os subproblemas tenha-se encontrado melhores ótimos 



103 
 

locais que na resolução do problema considerando uma estrutura centralizada, como 

é mostrado na tabela 5.4 na qual pode-se observar que as respostas obtidas a partir 

de uma estrutura distribuída apresenta um pequeno incremento nas correntes 

intermediarias e por consequência um incremento nas vazões dos produtos finais e 

no lucro bruto operacional da unidade. Outras das razões pelas quais pode existir 

essa pequena diferencia é que no cálculo do software, foram consideradas 

diferentes tolerâncias fazendo que exista uma diferencia de decimas como é nosso 

caso.  

Para a otimização utilizando essa proposta de estrutura distribuída foram utilizadas 

na divisão S-1, 2393 variáveis, 2391 equações e 6 restrições de desigualdade, essa 

divisão tem 2 graus de liberdade. Na divisão S-2 foram utilizadas 2746 variáveis, 

2743 equações e 11 restrições de desigualdade, o que significa que a divisão S-2 

tem 3 graus de liberdade. Já na divisão S-3 foram utilizadas 8510 variáveis, 8507 

equações e 11 restrições de desigualdade, dando lugar a 3 graus de liberdade. 

Pelo explicado anteriormente, pode-se concluir que a modificação no algoritmo de 

resolução do método de relaxação Lagrangeana é eficaz para resolver o problema 

de otimização com estrutura distribuída do processo apresentado no seção 4 deste 

trabalho. 



104 
 

6. CONCLUSÕES E SUGESTÕES PARA TRABALHOS FUTUROS 

 

Neste trabalho descrevemos como a otimização de toda a unidade de produção de 

propeno da REPLAN - Petrobrás poderia ser decomposta em subproblemas 

utilizando técnicas de decomposição e como consequência do uso dessas técnicas, 

os preços das correntes intermediárias podem ser determinados adequadamente, 

considerando assim uma estrutura distribuída. Para este propósito foram estudadas 

as principais técnicas de decomposição para problemas de otimização, estas são a 

relaxação Lagrangeana e o Lagrangeano Aumentado. Além dessas técnicas 

clássicas, foi estudada uma outra técnica alternativa que é Pricing Interprocess 

Streams Using Slack Auctions. O principal objetivo destas é decompor o problema 

original em subproblemas menores coordenados por um problema mestre, 

atualizando o multiplicador de Lagrange que, nestes casos, é considerado como o 

preço sombra da corrente intermediária. Estas três técnicas foram fundamentadas 

teoricamente, fazendo-se uma análise e explicação dos seus algoritmos para 

aplicação na decomposição de problemas de otimização de divisões posicionadas 

em série, em que o procedimento iterativo é usado para garantir a convergência para 

uma solução global. 

Essas técnicas foram aplicadas a um problema de otimização de grande porte, que é 

toda a unidade de produção de propeno da refinaria REPLAN – Petrobrás. Essa 

unidade é composta por três divisões: Depropanizadora, De-etanizadora e a 

Fracionadora de Propeno. A estratégia é a redução da complexidade na resolução 

do problema de otimização com estrutura centralizada para geração dos preços dos 

produtos intermediários adequados, determinado pelas técnicas de decomposição 

para a tomada de decisões de produção e também para a obtenção dos set-points.  

Com este fim, numa primeira etapa (seção 4 da dissertação) foram consideradas as 

três divisões num só modelo (baseado no trabalho de Mendoza et al., 2013), para 

assim poder simular e otimizar a unidade completa, obtendo os set-points requeridos 

pelo RTO. Os resultados obtidos mostram que a otimização da unidade pode 

incrementar (comparada com as condições atuais) em 3.88% no lucro da toda a 

unidade, o que significa 2675.17 $/h. O principal problema encontrado na 

modelagem foi a necessidade do EMSO de um arquivo de inicialização viável, o que 

fez com que a construção do modelo fosse trabalhoso. Em relação à simulação do 



105 
 

processo, o software apresenta as características de um ambiente orientado a 

equações, como velocidade na convergência, robustez e flexibilidade nas 

especificações das variáveis do processo. 

Numa segunda etapa foram modeladas, simuladas e otimizadas separadamente as 

três divisões que formam parte da unidade de produção de propeno (seção 5 da 

dissertação). A construção dos modelos  apresentou menor complexidade do que a 

modelagem da unidade com estrutura centralizada, já que cada uma dessas divisões 

possui menor número de variáveis e equações, mas os mesmos problemas e 

características do software mencionados anteriormente se fizeram presentes. Pelas 

características do EMSO, neste trabalho não será desenvolvida uma análise do 

gasto computacional na resolução dos problemas de otimização mas, pelo menor 

número de variáveis e equações, a otimização feita em paralelo das três divisões 

consideradas separadas, deveria poder ser resolvida num menor tempo 

computacional. 

A aplicação das técnicas de decomposição mencionadas anteriormente ao processo 

estudado apresentou uma série de problemas (mencionado na seção 5 da 

dissertação). Nas técnicas da relaxação Lagrangeana e Lagrangeano Aumentado os 

problemas encontrados foram os seguintes: existência de divisões indiferentes, ou 

seja, casos em que não existe dependência linear entre a função objetivo e as 

restrições complicadoras das divisões estudadas; também encontraram-se 

problemas com objetivos lineares das divisões, ou seja, a restrição de 

processamento máximo ou mínimo das divisões S2 e S3 sempre serão ativas 

fazendo com que não exista convergência do problema mestre com qualquer valor 

do multiplicador de Lagrange. 

A técnica de Pricing Interprocess Streams Using Slack Auctions também apresentou 

problemas. Nessa técnica, é a colocação de um peso na função objetivo tentando 

minimizar a diferença entre as vazões das restrições complicadoras, mas esta 

técnica não considera a produção conjunta, já que se não houver um preço de leilão 

suficientemente alto, sempre tenta-se produzir a maior vazão do coproduto e não da 

corrente intermediária, fazendo que o preço do leilão não tenha um significado 

econômico válido para este tipo de processos, isso porque os preços dos produtos 

intermediários seriam maiores que os preços de mercado dos produtos finais.   



106 
 

Também foi realizado uma proposta de mudança no algoritmo de resolução de 

problemas de otimização por relaxação Lagrangeana, demonstrando que essa 

proposta garante uma solução global para o problema de otimização considerando 

uma estrutura distribuída, atingindo assim um ótimo geral para todo o processo, 

mas, como o problema estudado é não linear e foram consideradas tolerâncias 

diferentes nos cálculos do software, existe uma diferença entre de 0.184% entre a 

otimização centralizada (ótimo de 71622.92 $/h) e a otimização distribuída (71754.71 

$/h) da unidade. 

Então é importante que a aplicação de técnicas de decomposição para problemas 

de otimização de unidades em série sejam tomadas em conta para ser acopladas a 

um sistema de otimização em tempo real, já que assim os novos pontos 

operacionais encontrados com o RTO sejam sensíveis a mudanças nos preços dos 

produtos finais e intermediários, garantido assim uma solução global considerando 

uma estrutura distribuída. 

Como sugestões para trabalhos futuros, a proposta sugerida deve ser testada em 

outras unidades de processo, com produção conjunta de dois ou mais produtos. 

Outros métodos de atualização dos multiplicadores de devem ser utilizados, para 

analisar se é possível alcançar a convergência em um menor número de iterações. 

Já para a otimização do processo, é preciso desenvolver uma plataforma 

computacional para o EMSO e assim possa ser feita uma análise do gasto 

computacional requerido na resolução dos problemas de otimização, tanto para a 

otimização considerando uma estrutura centralizada como para uma estrutura 

distribuída.  Também seria interessante utilizar softwares comerciais diferentes como 

Aspen e ROMeo para poder implementar as técnicas de decomposição nas 

unidades que atualmente utilizam estas plataformas computacionais, visando 

alcançar soluções que abarquem toda a refinaria. 



107 
 

REFERÊNCIAS BIBLIOGRÁFICAS 

 

ANTHONY, R. N.; GOVINDARAJAN, V. Sistemas de controle gerencial, São 

Paulo, 2002. 

ARORA, N.; BIEGLER, L. T. Redescending estimators for data reconciliation and 

parameter estimation. Computers &amp;amp; Chemical Engineering, v. 25, n. 11, p. 1585–

1599, 2001. 

ATKINSON, A. A.; CHENOY CASTRO, A. O. M. DU. Contabilidade gerencial. [S.l: 

s.n.], 2000. 

AXELSSON, B.; EASTON, G. Industrial networks: a new view of reality, 

Routledge, New York, 1992. 

BAILEY, J.K.; HYRMAK, A.N.; TREIBER, S.S.; HAWKINS R.B. Nonlinear 

optimization of a hydrocracker fractionation plant. Computers &amp;amp; chemical 

engineering, v. 17, n. 2, p. 123–138, 1993. 

BAZARAA, M. S.; SHERALI, H. D.; SHETTY, C. M. Nonlinear programming theory 

and algorithms. John Wiley &amp;amp; Sons, New York, 1993. 

BERTSEKAS, D. P. Constrained optimization and Lagrange multiplier methods. 

Computer Science and Applied Mathematics, Boston: Academic Press, v. 1, 

1982. 

BERTSEKAS, D. P. Nonlinear programming. Athena Scientific, Belmont MA, 1995. 

BEUREN, I.; GRUNOW, M. A.; HEIN, N. Métodos de preço de transferência interna 

utilizados nas maiores indústrias do Brasil. Congresso USP, São Paulo, Brasil, 

2008.  

BIEGLER, L. T.; GROSSMANN, I. E. Retrospective on optimization. Computers &amp;amp; 

Chemical Engineering, v. 28, n. 8, p. 1169–1192, 2004. 

CAMOLESI, V. J.;; MORO, L. L. F.; ZANIN, A. C. Implantação de um otimizador em 

tempo real (RTO) no conversor de uma unidade de craqueamento catalítico. Sba: 

Controle &amp;amp; Automação Sociedade Brasileira de Automatica, v. 19, n. 2, p. 128–

137, 2008. 

CARVALHO M. Otimização sequencial por aproximações: Uma aplicação em 

tempo real para o refino de petróleo. Tese (Doutorado em coordenação de 

programas de pós-graduação em engenharia elétrica) - Universidade Federal do Rio 

de Janeiro, 2007. 

CHACHUAT, B.;; SRINIVASAN, B.; BONVIN, D. Adaptation strategies for real-time 

optimization. Computers &amp;amp; Chemical Engineering, v. 33, n. 10, p. 1557–1567, 

2009. 



108 
 

COHEN, G. Auxiliary problem principle and decomposition of optimization problems. 

Journal of optimization Theory and Applications, v. 32, n. 3, p. 277–305, 1980. 

CONEJO, E.; CASTILLO, R.; MINGUEZ R.; GARCIA-BERTRAND, R. 

Decomposition Techniques in Mathematical Programming: Engineering and 

Science Applications. [S.l.]: Springer, 2006.  

DARBY, M. L.; WHITE, D. C. On-line optimization of complex process units. 

Chemical Engineering Progress, v. 84, n. 10, p. 51–59, 1988. 

DURAISKI, R. G. Otimização dinâmica em tempo real utilizando modelos não-

lineares simplificados. Tese de Doutorado - Universidade Federal do Rio Grande 

do Sul, 2009. 

EDGAR, T.F.; HIMMELBLAU, D. M.; LASDON, L.S. Optimization of chemical 

processes, McGraw-Hill, New York, 2001. 

FRIEDMAN, Y. Z. What’s wrong with unit closed loop optimization? Hydrocarbon 

Processing-Section 1, v. 74, n. 10, p. 107–116, 1995. 

GUERRA, O. J.; LE ROUX, G. A. C. Improvements in Petroleum Refinery Planning: 

1. Formulation of Process Models. Industrial &amp;amp; Engineering Chemistry Research, 

v. 50, n. 23, p. 13403–13418, doi:10.1021/ie200303m, 2011. 

GUIGNARD, M. Lagrangean relaxation. Top, v. 11, n. 2, p. 151–200, 2003. 

GUNNERUD, V.; FOSS, B. Oil production optimization—A piecewise linear model, 

solved with two decomposition strategies. Computers &amp;amp; Chemical Engineering, v. 

34, n. 11, p. 1803–1812, 2010.. 

HANMANDLU, M.;; PURKAYASTHA, P.; PAL, J. K. On the use of nonlinear 

programming in real time control in process industries. Annual Review in Automatic 

Programming, v. 13, p. 71–78, 1985. 

HARTMANN, J. C. M. Distinguish between scheduling and planning models. 

Hydrocarbon processing, v. 77, n. 7, p. 93–100, 1998. 

HUI, C.-W. Determining marginal values of intermediate materials and utilities using a 

site model. Computers &amp;amp; Chemical Engineering, v. 24, n. 2, p. 1023–1029, 2000. 

JANG, S.;; JOSEPH, B.; MUKAI, H. On?line optimization of constrained multivariable 

chemical processes. AIChE journal, v. 33, n. 1, p. 26–35, 1987. 

JIANT T.; CHEN, B.; HE, X.; STUART, P. Application of steady-state detection 

method based on wavelet transform. Computers &amp;amp; chemical engineering, v. 27, n. 

4, p. 569–578, 2003. 



109 
 

JORDAN, H.;; NEVES, J. C.; RODRIGUES, A. O controle de gestão: ao serviço 

da estratégia e dos gestores. [S.l: s.n.], 2003. 

JOSE, R. A.; UNGAR, L. H. Auction-driven coordination for plantwide optimization. 

Proc. Foundations of Computer-Aided Process Operation FOCAPO, 1998. 

JOSE, R. A.; UNGAR, L. H. Pricing interprocess streams using slack auctions. 

AIChE journal, v. 46, n. 3, p. 575–587, 2000. 

KREIPL, S.; PINEDO, M. Planning and scheduling in supply chains: an overview of 

issues in practice. Production and Operations management, v. 13, n. 1, p. 77–92, 

2004. 

LATOUR, P. R. ONLINE COMPUTER OPTIMIZATION. 2. BENEFITS AND 

IMPLEMENTATION. Hydrocarbon Processing, v. 58, n. 7, p. 219–223, 1979. 

LI, X. Refinery-wide optimization. PHD Dissertation. Texas Technical University, 

2000. 

LUENBERGER, D.G. Linear and nonlinear programming. Addison Wesley, 

Reading, MA, 1984. 

MAHEY, P. Decomposition methods for mathematical programming. Handbook of 

applied optimization, p. 337–351, 2002. 

MARTINS, E. Contabilidade de custos. São Paulo: Atlas, 2003. 

MENDOZA, D. F.; PALACIO, L. M.; GRACIANO, J. E. A.; et al. Real-Time 

Optimization of an Industrial-Scale Vapor Recompression Distillation Process. Model 

Validation and Analysis. Industrial &amp;amp; Engineering Chemistry Research, v. 52, n. 

16, p. 5735–5746, 2013. 

MORO, L. F. L.;; ZANIN, A. C.; PINTO, J. M. A planning model for refinery diesel 

production. Computers &amp;amp; Chemical Engineering, v. 22, p. S1039–S1042, 1998. 

NAYSMITH, M. R.; DOUGLAS, P. L. Review of real time optimization in the chemical 

process industries. Developments in Chemical Engineering and Mineral 

Processing, v. 3, n. 2, p. 67–87, 1995. 

NEIRO, S. M. S. Integrated planning of production-distribution in petroleum 

supply chains. . [S.l.]: Ph. D. Thesis, University of São Paulo, SP, Brazil, 2004. 

PINTO, J. M.; GUT, J. A. W. Otimização de processos químicos. Apostila do curso 

PQI5779-Otimização de Processos Químicos IUniversidade de São Paulo, São 

Paulo, 2005. 

POLYAK, B. T. Introduction to optimization. Optimization Software, Inc., New 

York, 1987. 



110 
 

REDONDO, N. J.; CONEJO, A. J. Short-term hydro-thermal coordination by 

Lagrangian relaxation: solution of the dual problem. Power Systems, IEEE 

Transactions on, v. 14, n. 1, p. 89–95, 1999. 

ROMAGNOLI, J.A.; SANCHEZ, M.C. Data processing and reconciliation for 

chemical process operations, first ed. Academic Press Inc., San Diego, USA, 

2000. 

SEQUEIRA, S. E.;; GRAELLS, M.; PUIGJANER, L. Real-time evolution for on-line 

optimization of continuous processes. Industrial &amp;amp; engineering chemistry 

research, v. 41, n. 7, p. 1815–1825, 2002. 

SOARES, R. P.; SECCHI, A. R. EMSO: A new environment for modelling, simulation 

and optimisation. Computer Aided Chemical Engineering, v. 14, p. 947–952, 2003. 

SOARES, R. P. User’s and programming manual; http://www.enq. 

ufrgs.br/alsoc/download/emso/docs/Manual.pdf (accessed Sept 27, 2013). 

VOLLMANN, T.;; CORDON, C.; RAABE, H. Supply chain management. The 

complete MBA companion, Pitman, London, 1997. 

VRTECH. VRTherm manual do usuário. www.vrtech.com.br (accessed Sept 27, 

2013). 

WHITE, D. C. Online optimization: what, where and estimating ROI: Process 

optimization: Process control and instrumentation. Hydrocarbon Processing, v. 76, 

n. 6, p. 43–51, 1997. 

WINSTON, W.L. Introduction to mathematical programming: Applications and 

algorithms, 2
nd

 ed, Duxbury Press, California, 1995. 

WU, Y.-C.;; DEBS, A. S.; MARSTEN, R. E. A direct nonlinear predictor-corrector 

primal-dual interior point algorithm for optimal power flows. Power Systems, IEEE 

Transactions on, v. 9, n. 2, p. 876–883, 1994. 

ZHANG, J.;; ZHU, X. X.; TOWLER, G. P. A simultaneous optimization strategy for 

overall integration in refinery planning. Industrial &amp;amp; engineering chemistry 

research, v. 40, n. 12, p. 2640–2653, 2001. 

ZHANG, N.; ZHU, X. X. A novel modelling and decomposition strategy for overall 

refinery optimisation. Computers &amp;amp; Chemical Engineering, v. 24, n. 2, p. 1543–

1548, 2000. 

ZHANG, N.; ZHU, X. X. Novel modelling and decomposition strategy for total site 

optimisation. Computers &amp;amp; chemical engineering, v. 30, n. 5, p. 765–777, 2006. 

ZHANG, Y.; FRASER FORBES, J. Extended design cost: a performance criterion for 

real-time optimization systems. Computers &amp;amp; Chemical Engineering, v. 24, n. 8, p. 

1829–1841, 2000. 



111 
 

ZHUANG, F.; GALIANA, F. D. Towards a more rigorous and practical unit 

commitment by Lagrangian relaxation. Power Systems, IEEE Transactions on, v. 

3, n. 2, p. 763–773, 1988. 


</field>
	</doc>
</add>