<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.07574</field>
		<field name="filename">12295_Guedes_SolangedaSilva_D.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">TT1\ITA7TTT?CTTA A TA 17 VQTAr^TIAT &gt;^17 A A/f TTTIVT A Q
LJ 1A I V JtL JtvoXJL^/AJLÍlL 1S0 X/A.XXLJ/AX^ JLzJlj V^/A1VJLjl XlAzAo
FACULDADE DE ENGENHARIA MECÂNICA
Uma Abordagem Multiescala na Simulação Numérica de Reservatórios
Autora: Solange da Silva Guedes
Orientador: Prof. Dr. Denis José Schiozer
03/98

q&gt;?
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA
Uma Abordagem Multiescala na Simulação Numérica de Reservatórios
Autora: Solange da Silva Guedes
Orientador: Prof. Dr. Denis José Schiozer
Curso: Engenharia de Petróleo
Tese de doutorado apresentada à comissão de Pós-Graduação da Faculdade de Engenharia Mecânica, como requisito para a obtenção do título de Doutor em Engenharia de Petróleo
Campinas, 1998
S.P.- Brasil
I «ftuc
i C tí F6
UM0ADÍÍ.„_ .JPCí
.IV CHXAX :
i	AMAgiT’i
:.	0 XJ
p;, ‘- V’X.X
. OfC4- : 04
N? CPD '	■
CM-Oül13103-4
FICHA CATALOGRÁFICA ELABORADA PELA BIBLIOTECA DA ÁREA DE ENGENHARIA - BAE - UNICAMP
Guedes, Solange da Silva
G934a	Uma abordagem multiescala na simulação numérica de
reservatórios. / Solange da Silva Guedes.—Campinas, SP: [s.n.], 1998.
Orientador: Denis José Schiozer.
Tese (doutorado) - Universidade Estadual de Campinas, Faculdade de Engenharia Mecânica.
1. Métodos de simulação. 2. Modelos matemáticos. 3. Reservatórios: 4. Diferenças finitas^ I. Schiozer, Denis José. II. Universidade Estadual de Campinas. Faculdade de Engenharia Mecânica. III. Título.
TESE DE DOUTORADO
Uma Abordagem Multiescala na Simulação Numérica de Reservatórios
Autora: Solange da Silva Guedes
Orientador: Prof. Dr. Denis José Schiozer
Banca Examinadora:
i 0 H
-------------£-----
Universidade Estadual de Campiñas
;	l)
Petróleo Brasileiro S/A
...' ¿ . 'Z"-- ..............
Dr. Regís Kruel Romeu Petróleo Brasileiro S/A
/
/
------------------------------------------
Dr. Luiz Carlos Nascimento Amado Schlumberger/GeoQ^çst Reservoir Technologies
\
________________|_____..........
Prof. Dr Osvair Vidal Trevisan
Universidade Estadual de Campinas
Agradecimentos
À PETROBRAS pelo apoio financeiro concedido durante a realização deste trabalho.
Ao professor Denis Schiozer pelo apoio e orientação desta tese.
Ao apoio imprescindível de Janice e Fátima.
Especificamente agradeço a Mauro Miaguchi e Luciane Bonet, ambos da PETROBRAS, pelo apoio no uso do programa PSEUDO. Agradeço também a Douglas W. Corbishley (TECSIN) pela ajuda na preparação dos dados e apoio durante o uso do simulador ECLIPSE. Agradeço ainda a Júlio Syrio e a Mauro Dantas, ambos da PETROBRAS, e Giselle Palermo, da UNICAMP, pelo apoio operacional.
A David Hicks da Schlumberger, Henley-on-Thames, Oxon, Inglaterra, pelas discussões e pela geração de alguns resultados do PSEUDO, para o caso THOR, apresentados no capítulo 3 deste trabalho.
Um agradecimento particular é devido a Régis Kruel Romeu, do Centro de Pesquisas da PETROBRAS, pela motivação inicial do assunto abordado, pelas discussões e também pelo apoio.
Finalmente, um agradecimento especial a Virgílio, pelo seu apoio incondicional expresso sob diferentes formas.
A Virgilio, Paula e ao meu nene.
Resumo
Os avanços atuais na área de caracterização de reservatórios são capazes de fornecer descrições de reservatórios que resultam em malhas de discretização com centenas de milhares a dezenas de milhões de blocos. Durante a simulação numérica de fluxo multifásico, estas informações podem ser consideradas através de técnicas de mudança de escala. O procedimento usual considera pseudo-funções multifásicas e o método proposto por Kyte e Berry (1975) é largamente utilizado. Esta tese apresenta um modelo computacional multiescala para fluxo multifásico que trata o processo de mudança escala de forma implícita e sem o uso das pseudo-funções. Na metodologia proposta, uma sequência de problemas locais são resolvidos em subdomínios da malha fina, obtendo assim uma melhor aproximação na malha grossa, mas com um custo computacional menor do que a resposta da malha fina. A principal vantagem deste novo procedimento de mudança de escala é tornar tal tarefa um processo implícito durante a etapa de solução do problema, contornando alguns problemas de ordem prática durante aplicações das pseudo-funções tradicionais. Os resultados apresentados tratam problemas bidimensionais em meios homogêneos e heterogêneos e duas fases: óleo e água. Alguns exemplos são utilizados para comparar este procedimento e o programa PSEUDO, um módulo de mudança de escala baseado em pseudo-funções e disponível no simulador comercial ECLIPSE.
Palavras-chave:
Fluxo multifásico
Mudança de escala
Simulação Numérica
Abstract
Advances in petroleum reservoir descriptions have provided an amount of data that can not be handled directly during numerical simulations. This detailed geological information must be incorporated into a coarser model during multiphase fluid flow simulations by means of some upscaling technique. The most used approach is the pseudo relative permeabilities and the more widely used is the Kyte and Berry method (1975). In this work, it is proposed a multi-scale computational model for multiphase flow that implicitly treats the upscaling without using pseudo functions. By solving a sequence of local problems on subdomains of the refined scale it is possible to achieve results with a coarser grid without expensive computations of a fine grid model. The main advantage of this new procedure is to treat the upscaling step implicitly in the solution process, overcoming some practical difficulties related the use of traditional pseudo functions. Results of bidimensional two phase flow simulations considering homogeneous and heterogeneous porous media are presented. Some examples compare the results of this approach and the commercial upscaling program PSEUDO, a module of the reservoir simulation software ECLIPSE.
Keywords:
Multiphase flow
Upscaling
Numerical Simulation
índice
Lista de Figuras
Lista de Tabelas...................................................................................    xiii
Capítulo 1 - Introdução.............................................................................      1
Capítulo 2 - Revisão Bibliográfica......................................................................  g
2.1	Introdução.................................................................................  8
2.2	Escalas Associadas ao Fluxo Multifásico em Meios
Porosos.......................................................................................     g
2.3	Procedimentos de Mudança de Escala em Fluxo Multifásico
Baseados em Pseudo-Funções................................................................	12
2.4	Procedimentos de Mudança de Escala Baseados em Elementos de
Simulação Numérica............................................................................... 24
Capítulo 3 - Pseudo-Funções........................................................................................ 27
3.1	Introdução...........................................................................................	27
3.2	Processo de Obtenção das Pseudo-Funções.............................................................  29
3.3	Propriedades das Pseudo-Funções...................................................................    31
3.4	Método de Kyte e Berry......................................................................	34
3.4.1	Derivação das expressões......................................................................  35
3.4.2	Aplicações...................................................................................	39
3.5	Método Ponderado pelo Volume Poroso..............................................................     41
3.6	Método de Stone................................................................................       44
3.7	Outros Métodos Baseados na Mobilidade Total..................................	46
3.8	Exemplo de Aplicações dos Métodos.................................................................    49
3.9	Considerações Finais................................................................................  52
4.1	Introdução..................................................................................  55
4.2	Solução de uma Malha Refinada...............................................................  55
4.3	Objetivos e Características da Simulação Multiescala........................	60
4.4	Esquema Geral do Modelo Computacional.........................................	62
4.5	Transferência de Informações entre as Escalas de Simulação...........	67
4.6	Tratamente dos Subdomínios no Simulador Multiescala.....................	71
4.7	Custo Computacional..........................................................................	73
Capítulo 5 - Modelagem do Escoamento em Meios Porosos.........................	77
5.1	Introdução.................................................................................        77
5.2	Modelo Matemático..............................................................................    77
5.2.1	Equações de fluxo na forma diferencial.............................	78
5.2.2	Relações auxiliares......................................................................	81
5.3	Condições de Contorno.................................................................    ..	85
5.4	Modelo Numérico.........................  ..................................................	86
5.4.1	Discretização das equações................................................................  87
5.4.1.1	Discretização dos termos de acumulação.............................	87
5.4.1.2	Discretização dos termos de fluxo........................................	87
5.4.1.3	Discretização dos termos fonte......................................................  89
5.4.1.4	Equações em termos de diferenças finitas...........................	91
5.4.2	Solução do sistema de equações não lineares..............................................   92
5.4.2.1	Linearização do sistema de equações..................................	92
5.4.2.2	Solução do sistema de equações lineares.............................................  94
Capítulo 6 - Procedimentos do Modelo Computacional Multiescala.......... 95
6.1	Introdução..
95
6.2	Processos Multiescala.............	96
6.2.1	Geração da malha de simulação ................................................	96
6.2.2	Mudança de escala das permeabilidades absolutas....................	97
6.2.3	Solução dos subdomínios...................................................................  100
6.2.3.1 Com condição de contorno tipo Dirichlet...............................	100
6.2.3.2 Com condição de contorno tipo Neumann............................	104
6.2.4.1	Modificação das equações de fluxo para a malha grossa..... 107
6.2.4.2	Ajuste dos termos de fluxo entre blocos - F^..........,..,...,....,.	109
6.2.4.3 Ajuste dos termos de fluxo nos poços - F^...........................	114
Capítulo 7 - Exemplos Numéricos...................................................................	116
7.1	Introdução.......................................................................................	116
7.2	Descrição dos Casos ........................................................................	117
7.2.1	Caso HERA.................................................................................	119
7.2.2	Caso ZEUS..................................................................................	120
7.2.3	Caso AJAX..........................................................................	121
7.2.4	Caso THOR.....................................................................................  122
7.2.5	Caso LOKI...................................................................................	123
7.2.6	Caso ISIS....................................................................................	123
7.2.7	Caso ARES.....................................................................................  124
7.2.8	Caso JUNO..................................................................................	124
7.2.9	Caso ODIN..................................................................................	125
7.3	Desempenho das Opções de Tratamento do SCALE.......................................................... 125
7.3.1	Formas de consideração das condições de contorno tipo
Dirichlet...........................................................................................      126
7.3.2	Formas de obtenção das saturações para ajuste das
transmissibilidades ..............................................................................	130
7.3.3	Grau de redução de escala..........................................................	143
7.4	Influência de Diferentes Características de Rocha e Fluidos..............	147
7.4.1	Compressibilidade dos fluidos......................................................	147
7.4.2	Densidade dos fluidos.........................................................................  150
7.4.3	Heterogeneidade do meio.,...,..,......,............................................	151
7.4.4	Ajuste dos termos fonte.............................................................155
7.4.5	Curvas de permeabilidades relativas...........................................................  157
7.5	Influência das Condições de Produção Especificadas para os
Poços.........................................................................
7.6	Comparação com PSEUDO..............................................................	163
7.7	Discussão dos Resultados................................................................	166
8.1	Conclusões.................................................................................. 171
8.2	Recomendações..............................................................................  174
Referências Bibliográficas............................................................................... 179
Anexo I - Simulador SCALE.............................................................................	188
1.1	Descrição do Código.....................................................................      188
1.1.1	Alocação dinâmica de memória....................................................	188
L 1.2 Métodos iterativos de solução.......................................................	189
1.2	Principais Fluxogramas......................................................................  191
1.3	Validação...............................................................................      193
1.3.1	Caso SPE...................................................................................,	193
1.3.2	Casos AJAX e ZEUS..,.....,............................................................ 194
Anexo II - Algoritmo Multimalhas........................................................................  196
11.1	Descrição da Técnica Multimalhas...........................	196
11.1.1	Operadores de transferência entre malhas..................................	199
II. 1.2 Métodos de relaxação................................................................   200
11.2	Aplicação na Área de Fluxo de Fluidos em Meios Porosos.................	200
11.3	Desenvolvimento e Implementação de um Algoritmo Multimalhas
num Simulador de Fluxo.......................................................................      204
H.3.1 Algoritmo......................................................................	205
11.3.2	Componentes multimalhas...........................................................	206
11.3.2.1	Soluções no nível grosseiro....................................................  206
11.3.2.2	Refinamento de malhas.......................................................    206
11.3.2.3 Relaxação.......................................................................  206
11.3.2.4	Injeção dos resíduos e interpolação das correções..............	207
IL3.2.5 Não linearidades...............................................................    208
IL3.2.6 Avanço no tempo... ........ ....... ..... ... ....... .... .... ...... . .. ..	209
11.4	Exemplos.................................................................................... 210
11.4.1 Exemplo 1.....................................................................210
11.4.2	Exemplo 2....................................................................................	213
Lista de Figuras
3.1	- Região da malha fina utilizada na simulação numérica para obtenção das pseudo- 30
funções
3.2	-	Representação de dois blocos genéricos da malha grossa, refinados	35
3.3	-	Solução da malha fina e simulações usando 100 e 200 pseudo-curvas de 40
permeabilidades relativas
3.4- Solução da malha fina e simulações usando 100 e 200 pseudo - curvas de 42 permeabilidades relativas
3.5	- Caso THOR - Localização dos poços, da buffer-zone e distribuição das pseudo- 43
curvas de permeabilidades relativas direcionais
3.6	-	Pseudo-curvas de permeabilidades relativas	49
3.7	-	Comparação de corte de água entre malha fina e modelos de mudança de escala	51
3.8	-	Comparação entre as soluções da malha fina e do método de Kyte e Berry	52
4.1	-	Decomposição do domínio inicial O em dois subdomínios Q( e CL e	as	57
respectivas interfaces Ti e r2
4.2	-	Escalas envolvidas no processo multiescala	63
4.3	-	Esquema do modelo computacional multiescala	66
4.4	-	Representação da obtenção do termo de ajuste de/Lv sem o uso da pseudo-função	69
4.5	-	Representação da obtenção de Sp' para as fases água e óleo	70
4.6	-	Distribuição dos fluxos ao longo da faces externas dos subdomínios	71
4.7	-	Subdomínios segundo a técnica de decomposição de domínios	72
4.8	-	Subdomínios segundo o procedimento multiescala	73
4.9	-	Comparação do número de operações entre solução do procedimento mutiescala	e	75
solução da malha fina, considerando solução do sistema linear por método iterativo
5.1-	Volume arbitrário no domínio do fluxo	79
5.2	-	Ponto genérico da malha e as locações dos pontos num sistema de	coordenadas	89
Cartesianas
6.1	-	Esquema de um subdomínio, blocos adjacentes e pontos auxiliares	101
6.2	-	Esquema para interpolação da pressão, considerado no método SLRT	102
6.3	-	Esquema de dois blocos da malha grossa com representação dos sub-blocos	e	da	111
região de fluxo
6.4	- Esquema de obtenção de segundo o critério FACE, para um bloco genérico 114
ij
7.1-	Curvas de Permeabilidades Relativas	118
7.2	-	Caso	HERA - Representação da malha fina e poços	119
7.3	-	Caso	ZEUS - Representação da malha fina 12x12x1, dos	poços	e da	distribuição	120
das permeabilidades, em mD
7.4	-	Caso	ZEUS ~ Representação da malha fina 20x20x1, dos	poços	e da	distribuição	121
das permeabilidades, em mD
7.5	- Caso AJAX - Representação da malha fina, dos poços e da distribuição das 122
permeabilidades, em mD
7.6	- Caso THOR - Representação da malha fina 12x12x1, dos poços e da distribuição 122
das permeabilidades, em mD
7.7	-	Caso ISIS - Representação da malha fina e poços	123
7.8	-	Caso ARES - Representação da malha fina e poços.	124
JA 1 - Caso AJAX - kr n=l -Comparação entre tratamentos das condições de contorno 127 tipo Dirichlet
7.12	- Caso ARES - kr n=l,5 -Comparação entre tratamentos das condições de contorno 128 tipo Dirichlet
7.13- Caso ARES - Pressões nos pontos auxiliares do contorno do subdomínio	129
7.14	- Esquemas a montante do fiuxo considerados no cálculo da saturação equivalente,	131
num subdomínio 5x5
7.15	- Pesos atribuídos aos blocos selecionados num subdomínio 3x3, segundo critério 131
GEO05-AREAI
7.16- Caso HERA - kr n= 1,5 - Vazão de água no poço produtor para diferentes formas 132 de obtenção das saturações representativas em cada subdomínio
7.17	- Caso ZEUS - kr «=2.0 - Vazão de água no poço produtor para diferentes 133
esquemas de pesos atribuídos ao critério GEO
7.18	- Caso ZEUS - kr n=1,5 - Vazão de água no poço produtor para diferentes formas 134
de obtenção das saturações nos subdomínios
7.19	- Caso ODIN - kr «=1,5 - Vazão de água no poço produtor para diferentes formas 135
de ponderação das saturações nos subdomínios
7.20	- Caso HERA - kr «=1,5 - Vazão de água no poço produtor - Comparação entre 136
criterios de seleção de suportes para as saturações representativas para os subdomínios
7.21- Caso ZEUS - 2 poços - kr n=1,5 - Vazão de água no poço produtor - Comparação 137 entre critérios de seleção de suportes para as saturações representativas para os subdomínios
7.22	- Caso AJAX - kr «=1,5 - Vazão de água no poço produtor - Comparação entre 138
criterios de seleção de suportes para as saturações representativas para os subdomínios
7.23	- Caso ZEUS - 3 poços - kr n= 1,5 - Vazão de água no poço produtor ~ Comparação 139
entre critérios de seleção de suportes para as saturações representativas para os subdomínios
7.24	- Caso ISIS - kr n=l,5 - p0 &amp;lt;pw - Vazão de água no poço produtor - Comparação	140
entre critérios de seleção de suportes para as saturações representativas para os subdomínios
7.25	- Caso ODIN - kr n= 1,5 - pn = pw ~ Vazão de água no poço produtor - Comparação 141
entre critérios de seleção de suportes para as saturações representativas para os subdomínios
7.26	- Esquema dos 4 subdomínios do caso ODIN e representação das conexões A e B.	142
7.27	- Caso ODIN - kr «=1,5 - po = pw ~ Fluxo de massa nas conexões externas do	142
subdomínio que comporta o poço produtor
7.28- Caso ODIN - kr «=1,5 - po = pw - Fluxo de massa nas conexões externas do 142 subdomínio que comporta o poço injetor
7.29	- Caso ZEUS - kr «=1,5 - Fluxo fracionário de óleo para diferentes discretizações 144
nos subdomínios
7.30	- Caso ZEUS - Comparação dos mapas de saturação de agua para t—35 anos	145
7.31	- Caso ISIS - kr n= 1,5 - Fluxo fracionário de óleo para diferentes discretizações nos 146
subdomínios
7.32	- Fluxo fracionário de óleo para o caso HERA, fluido incompressível e diferentes 148
razões de mobilidade
7.33	- Fluxo fracionário de óleo para o caso HERA, fluido compressível - kr n-1,5	149
7.34	- Fluxo fracionário de óleo para o caso ARES para diferentes relações de densidade	150
entre o óleo e a água - kr n~ 1,5
7.35	- Fluxo fracionário de óleo para o caso ODIN para diferentes relações de densidade 151
entre o óleo e a água - kr n= 1,5
7.36	-	Caso AJAX - Vazão de óleo e água no poço produtor	152
7.37	-	Caso THOR - Vazão de óleo e água no poço produtor	153
7.38	-	Caso LO Kl - Vazão de óleo e água no poço produtor	154
7.39	-	Caso JUNO - Vazão de óleo e água no poço produtor	156
7.40	-	Caso ODIN - Vazão de óleo e água no poço produtor	156
7.41	-	Caso HERA	- kr n=\ e n^2~ Fluxo fracionário de óleo	158
7.42	-	Caso ZEUS	- kr n=l e n~2~ Fluxo fracionário de óleo	158
7.43	~	Caso AJAX	- kr n=l e n=2- Fluxo fracionário de óleo	159
7.44	-	Caso JUNO	- Fluxo fracionário de óleo	159
7.45	- Vazão de água e óleo para o caso ARES para diferentes vazões de injeção de água
-	krn=L5	161
7.46	- Vazão de água e óleo para o caso JUNO para diferentes vazões de injeção de água
-	krn=l,5	"	162
7.47	-	Caso HERA -	Comparação entre SCALE e PSEUDO	164
7.48	-	Caso AJAX -	Comparação entre SCALE e PSEUDO	165
7.49	-	Caso THOR -	Comparação entre SCALE e PSEUDO	166
7.50“	Esquema dos	passos executados pelo algoritmo multiescala, a cada passo de 168
tempo
1.1	- Vetores e ponteiros utilizados para armazenamento dos dados no SCALE	189
1.2	- Ciclo de iterações v durante solução da malha grossa ou dos subdomínios, num
passo de tempo At	191
1.3	- Fluxograma principal do simulador SCALE	192
1.4	-	Caso SPE - Produção acumulada de gás	193
1.5	~	Caso SPE - Pressão de fundo dos poços	194
1.6-	Caso AJAX - Comparação da vazão de água no poço produtor	195
I.	7 -	Caso ZEUS - Comparação da razão água-óleo no	poço produtor	195
II.	1 -	Esquema do algoritmo multimalhas para 3 níveis	(nlev=2)	207
Lista de Tabelas
7.1-	Dados PVT para água, óleo e gás	118
7.2	-	Descrição dos casos e das condições de operação	126
7.3	-	Viscosidade dos fluidos e razões de mobilidade (M)	147
II. 1 -	Definição dos casos e parâmetros da solução CB - Exemplo 1 - Pentium 90	MHz	211
11.2	-	Parâmetros das soluções por MG - Exemplo 1 - Pentium 90 MHz	211
11.3	-	Comparação entre os métodos de solução MG e CB - Exemplo 2 - Estação SUN	213
Nomenclatura
Letras Romanas
A A b B c,	C d,	D frF Fb Fw fa g G h J k k	Área Termos de acumulação das equações de balanço de massa Bloco da malha Fator volume de formação Trechos do contorno de um subdomínio Profundidade do ponto central do bloco Fluxo de massa Termos de fluxo entre blocos nas equações de balanço de massa Termos fontes das equações de balanço de massa Fluxo fracionário de óleo Aceleração da gravidade Malha Espessura Matriz Jacobiana Permeabilidade absoluta Tensor diagonal de permeabilidades absolutas Tensor de permeabilidade total
kref m m N NO M P PC q R R r REV S s	Permeabilidade relativa Refinamento dos subdomínios numa direção Massa Número médio de elementos por linha de uma matriz esparsa Número de incógnitas Número de operações por iteração Razão de mobilidade Pressão Pressão capilar Fluxo volumétrico por unidade de volume Fluxo volumétrico Vetor resíduo Razão de solubilidade Raio Volume elementar representativo Saturação Razão de dano adimensional
S* t, T TW U V	Saturação representativa da distribuição de saturações do subdomínio T ransmissibilidade Coeficiente de transmissibilidade Velocidade de Darcy Vetor velocidade superficial
V y, V W WI X	Volume Volume poroso Função peso Índice numérico de produtividade do poço Fração mássica
Letras Gregas
Q P 8 P 0 r	Domínio Viscosidade Tolerância Massa específica Potencial Limites de um domínio
0 T À	Porosidade Interface entre domínios Mobilidade
Õ V A	Contorno da malha Operador gradiente Variação de uma propriedade
Subscritos
0, m. g c geo GF /, J Í’.Á ms 0. w. g P t vv	Componentes óleo, água e gás Componente Geométrico Malha Fina índice dos blocos da malha grossa índice dos blocos da malha fina Multiescala Fases óleo, água e gás Fase Total Poço
X	Eixos Cartesianos
Sobrescritos
H h c	Espaçamento da malha grossa Espaçamento da malha fina Malha composta Variáveis definidas para a malha grossa
Capítulo 1
Introdução
O aparecimento de técnicas de mudança de escala ocorreu quando a simulação numérica de reservatórios começou a se difundir na indústria de petróleo. No final dos anos 60, teve início o desenvolvimento de técnicas de modelagem de reservatório tridimensionais. No entanto, a simulação de fluxo muItifásico utilizando esta modelagem tridimensional ainda não era suportada pelos recursos computacionais da época, motivando então o desenvolvimento de metodologias que permitissem efetuar mudança de escala. Coats et al. (1967) propuseram um procedimento que permitisse a redução de modelos tridimensionais em modelos equivalentes em duas dimensões com o objetivo de contornar o custo computacional e o tempo gasto na preparação de dados, mas que pudesse levar em consideração os efeitos da modelagem vertical. O propósito dos primeiros trabalhos apresentados nesta área, no entanto, era apenas o de reproduzir os principais mecanismos físicos presentes no meio poroso, uma vez que os reservatórios eram usualmente considerados homogêneos ou estratificados.
Apesar do advento de processadores mais ágeis, a necessidade de redução de modelos numéricos ainda se faz presente e o uso de técnicas associadas a mudança de escala permanece em evidência. Nos anos 80, o enfoque das aplicações de técnicas de mudança de escala sofreu alterações e a metodologia passou a estar intrinsecamente associada ao desenvolvimento de técnicas de descrição geoestatísticas de reservatórios. Atualmente muita ênfase tem sido dada ao estudo das distribuições de fácies ao longo do reservatório e sua
2 influência nos processos de recuperação de petróleo. Os algoritmos desenvolvidos na área de caracterização de reservatórios são capazes de fornecer descrições de distribuição de porosidades e permeabilidades absolutas que resultam em malhas de discretização com centenas de milhares a dezenas de milhões de blocos. Se forem associadas um sem número de realizações a estas descrições, é possível ter idéia do volume de dados petrofísicos disponíveis para uma determinada área em estudo. Uma simulação numérica de fluxo que utilize a representação destas variações de propriedades dos reservatórios, pode se tornar, na maioria dos casos, impraticável. Surge então novamente a necessidade de adequar esta descrição para os modelos de fluxos, que comportam atualmente centenas de milhares de blocos.
Se por um lado a técnica de mudança de escala permite, em algumas situações, reduzir modelos e, em outras, incorporar informações detalhadas do meio poroso na etapa de simulação de fluxo, por outro lado, as soluções obtidas representam apenas aproximações daquela resposta que seria obtida caso o problema fosse resolvido com todos os dados disponíveis. Na maioria das aplicações, no entanto, esta resposta aproximada representa uma significativa melhora, em termos de precisão, em relação a não adoção da técnica. A obtenção, por exemplo, de tempos de irrupção dos fluidos injetados nos poços produtores com maior precisão, constitui uma importante informação que pode ser obtida pelos estudos de reservatórios.
A forma mais simples de mudança de escala trata situações de fluxo monofásico, onde apenas a permeabilidade absoluta é considerada. Nesta área, as pesquisas apresentam uma grande variedade de técnicas que estão bem estabelecidas. Esta questão tem sido tratada sob diferentes perspectivas que vão desde métodos baseados em médias de potência n. em equações de balanço de massa associadas a lei de Darcy, na teoria da homogeneização, na teoria da percolação e em fractais. Na presença de fluxo multifásico. no entanto, demonstrase claramente que apenas a mudança de escala das permeabilidades absolutas não é capaz de caracterizar o deslocamento relativo das fases. Outras funções de fluxo têm que ser definidas para capturar adequadamente o fluxo das fases. Com este objetivo, foram introduzidas as pseudo-funções multifásicas para permitir a passagem de uma escala mais refinada para outra
Os primeiros métodos de cálculo de pseudo-funções, desenvolvidos a partir de conceitos formais e com o objetivo de reduzir as dimensões dos modelos numéricos de simulação, baseiam-se na hipótese de equilíbrio vertical. Coats et al. (1971) propuseram pseudo-curvas para reservatórios onde a velocidade de segregação vertical é rápida quando comparada com o deslocamento horizontal. Para contornar as limitações desta categoria de pseudo-curvas, Jacks et	introduziram as pseudo-curvas dinâmicas. A técnica
tradicional para geração das pseudo-funções dinâmicas envolve a simulação de fluxo de regiões ou seções da malha fina, onde as relações originais de permeabilidade relativa e pressão capilar são consideradas. A partir dos fluxos nesta escala fina, e através de processos de ponderação, são obtidas as pseudo-curvas que emulam o comportamento de fluxo numa malha menos refinada. Com este procedimento são combinados os efeitos da dispersão numérica e das heterogeneidades.
A partir de Jacks et al.(\973} inúmeros trabalhos têm sido apresentados com o objetivo de aprimorar e acrescentar considerações a esta formulação. Dentre estes trabalhos o que mais se destaca é o método proposto por Kyte e Berry (1975) que se tornou referência nesta área, sendo largamente utilizado, apesar de apresentar algumas dificuldades e problemas em aplicações práticas, como demonstrado por Guzman et al. (1996).
Apesar da variedade dos procedimentos desenvolvidos para efetuar a transferência das propriedades petrofísicas, desde a escala de descrição (modeladas numa malha fina) até a escala de simulação (modeladas numa malha bem menos refinada), nenhum suporte teórico encontra-se totalmente estabelecido para definir as bases das técnicas de mudança de escala. Todo o desenvolvimento tem sido alcançado através de comparações e resultados numéricos.
O principal problema relacionado a qualquer procedimento de mudança de escala baseado em pseudo-funções é a dependência destas curvas às condições para as quais elas foram geradas, isto é, sua utilização é restrita aos ranges de fluxos e parâmetros próximos aqueles para os quais elas foram construídas. A falta de adaptabilidade desta técnica, quando novas situações passam a estar presente no modelo numérico, constitui sua principal desvantagem. Em busca de procedimentos mais flexíveis para a tarefa de mudança de escala alguns desenvolvimentos recentes (Durlofsky et al. (1995) e Verdiere e Thomas (1996)) têm procurado obter o mesmo efeito das pseudo-funções, mas não através do cálculo explícito destas curvas.
Além das limitações inerentes às propriedades das pseudo-funções, outras desvantagens estão associadas às ferramentas atualmente disponíveis quando se deseja efetuar mudança de escala durante uma simulação numérica de reservatórios. Uma etapa anterior à simulação de fluxo na malha menos refinada deve ser executada com o objetivo de construir as pseudo-funções para cada bloco. Estas pseudo-curvas, por sua vez, passam por algum tratamento de obtenção de valores médios que permitam reduzir o número de curvas e facilitar o manuseio dos dados. Este passo intermediário leva necessariamente a uma perda de precisão pelo excesso de manipulações que são executadas, além de um dispendioso trabalho não computacional.
Outro aspecto a ser considerado são as escalas envolvidas. A geração das pseudo-funções é realizada, na maioria dos métodos, através de uma única etapa. Se o objetivo for, por exemplo, a obtenção de curvas de permeabilidades relativas para serem aplicadas a blocos de simulação de fluxo, tem-se que considerar a escala de laboratório, na qual tal função foi obtida. No caso de diferentes escalas de heterogeneidades estarem definidas pela caracterização do reservatório, o ideal é a execução de uma seqüência de passos de tal forma que estas diferentes escalas possam ser incorporadas. Este procedimento seqüencial, denominado método da renormalização, foi proposto por King (1989) e reúne rapidez e precisão nos resultados ao substituir o passo único de mudança de escala por uma série de passos, agrupando poucos blocos durante a passagem de uma escala para outra. Este método
foi aplicado por Christie et al. (1995), que utilizou pseudo-funções tradicionais para transferir informações de uma escala para outra.
A simulação multiescala proposta e desenvolvida neste trabalho constitui-se numa abordagem que incorpora a mudança de escala ao processo de solução, que é executado durante a simulação numérica de fluxo, mas sem utilizar os conceitos de pseudo-funções multifásicas. Basicamente, esta forma de abordar o problema unifica estas etapas num procedimento único, tomando a mudança de escala apenas uma opção durante a solução de um modelo numérico de simulação de reservatórios. Para permitir esta incorporação, tanto a escala fina, onde as propriedades petrofísicas são descritas, quanto a escala de simulação estão presentes no modelo computacional. Utilizando subdomínios definidos na escala fina, os efeitos da natureza heterogênea do reservatório podem ser incorporados pela malha menos refinada. Além de executar a tarefa de mudança de escala de forma implícita pelo código computacional, eliminando a etapa de geração das pseudo-funções, a principal vantagem desta nova metodologia é permitir que alterações no modelo de simulação, tais como variações das vazões e mudança na localização dos poços, possam ser consideradas de forma automática.
A denominação multiescala decorre do fato deste procedimento poder ser incluído dentro de processos recursivos, como proposto pelo método da renormalização citado anteriormente. A implementação atual deste modelo no entanto, aborda somente uma etapa de mudança de escala, onde apenas duas escalas são consideradas.
O simulador multiescala desenvolvido neste trabalho trata problemas bifásicos óleo-água, formulação Black-Oil, modelagem bidimensional, com e sem os efeitos gravitacionais e não considera a pressão capilar. Uma das premissas que nortearam o desenvolvimento destes procedimentos numéricos de mudança de escala foi facilitar a inclusão de tais processos num esquema convencional de simuladores de reservatórios. Desta forma, o resultado final foi a geração de etapas que são facilmente incorporadas em códigos computacionais existentes. Sob este aspecto, este desenvolvimento possui um caráter mais geral do que outros esquemas que se baseiam em duas malhas de simulação, como por exemplo o Dual Mesh Method
proposto por Verdiere e Thomas (1996) que considera apenas fluxo incompressível e não inclui o tratamento de poços.
A seguir é descrita a seqüência dos tópicos apresentados neste trabalho.
O Capítulo 2 contém uma revisão bibliográfica referente à mudança de escala, onde é apresentada uma evolução dos métodos baseados nas pseudo-funções multifásícas e também dos métodos que não utilizam o conceito de pseudo-funções e adotam apenas elementos de simulação numérica para efetuar a mudança de escala. Este segundo grupo está diretamente relacionado ao procedimento proposto neste trabalho e, por isto, foi destacado em uma seção própria.
Na seqüência, o Capítulo 3 discute particularmente as pseudo-funções, onde suas propriedades são apresentadas e algumas formas de obtenção de pseudo-curvas são descritas: as propostas por Kyte e Berry (1975), uma variação deste método denominada ponderação pelos volumes porosos, o método proposto por Stone (1991) e finalmente algumas formulações baseadas na mobilidade total dos fluidos. Algumas aplicações destes métodos são apresentadas com o objetivo de enfatizar as características das pseudo-funções de tornar possível a avaliação das comparações entre o modelo multiescala desenvolvido e as técnicas baseadas em pseudo-funções apresentadas nos capítulos finais.
A filosofia do modelo multiescala é descrita no Capítulo 4, onde os objetivos são definidos, e uma visão geral do procedimento é apresentada. Nesse capítulo também é feita uma introdução aos mecanismos de transferência de informações entre as escalas de descrição e simulação. Uma distinção entre os processos executados no modelo multiescala e no método de decomposição de domínios é apresentada, de forma breve, ao final do capítulo, sendo seguida por uma análise teórica dos custos computacionais envolvidos no procedimento proposto.
principais características do código computacional construído a partir destas modelagens, denominado SCALE, são apresentadas no Anexo I, acompanhadas de alguns exemplos que mostram a validação do simulador numérico.
Após a apresentação do problema, cada urna das etapas envolvidas no modelo computacional multiescala são tratadas de forma detalhada no Capítulo 6. Este capítulo aborda a solução do problema em regiões da malha ñna, a solução na escala de simulação e as correções efetuadas nas equações descritas nesta escala de forma a realizar a mudança de escala pretendida.
No Capítulo 7 são descritos os casos utilizados para a etapa de testes e são discutidos o desempenho das diversas opções implementadas nos processos apresentados no Capítulo 6. O resultado da metodologia desenvolvida é então analisada para diferentes situações de deslocamento tendo como solução de referência aquela obtida na escala de descrição do problema. Algumas situações são também comparadas com o módulo PSEUDO do simulador comercial ECLIPSE.
Finalmente, no Capítulo 8, são apresentadas as principais conclusões deste trabalho e são feitas algumas recomendações em relação à continuidade das pesquisas dentro do tema e da linha de pesquisa abordados, as quais podem ajudar a reforçar e estender a viabilidade da formulação desenvolvida.
Os dois anexos apresentados após as referências bibliográficas estão relacionados ao desenvolvimento do simulador multiescala SCALE. O modelo computacional está descrito e validado no Anexo L enquanto o Anexo II apresenta um método alternativo de solução de sistema de equações desenvolvido durante a elaboração do simulador e que é baseado em técnicas multimalhas.
Capítulo 2
Revisão Bibliográfica
2.1	Introdução
A revisão bibliográfica apresentada neste capítulo aborda inicialmente as escalas presentes na descrição e modelagem do fluxo multifásico em meios porosos e a necessidade de se realizar a mudança de escala. A transferência de escala consiste em representar os parâmetros do reservatório, que são normalmente adquiridos em diferentes escalas, para a escala da simulação numérica, representada pela malha de simulação que é introduzida na etapa de modelagem numérica do problema.
Ao longo dos itens seguintes é apresentada a evolução do tema, onde estão relacionados e são discutidos, de forma breve, alguns dos trabalhos mais importantes que tratam do problema de mudança de escala, no âmbito de fluxo de fluidos em meios porosos. A ênfase será dada às formulações envolvendo fluxo multifásico, uma vez que, no que concerne a mudança de escala envolvendo apenas permeabilidade absoluta, vasta bibliografia encontra-se referenciada em Durlofsky (1991), Mansoori (1994), Durlofsky et al. (1995) e Ribeiro (1996). Uma revisão atualizada sobre as técnicas de cálculo de permeabilidade equivalente pode ser encontrada em Renard e Marsily (1997). Além de apresentarem uma visão geral sobre métodos heurísticos, determinísticos e estocásticos, estes autores discutem também as circunstâncias de aplicabilidade da maioria destes métodos.
Estes trabalhos são divididos propositadamente em dois tópicos distintos: aqueles baseados em pseudo-funções multifásicas e aqueles baseados em elementos de simulação numérica, como forma de caracterizar bem duas linhas distintas que possuem características próprias dentro do problema de mudança de escala.
Alguns procedimentos e métodos de mudança de escala mencionados neste capítulo serão descritos com mais detalhes e discutidos em capítulos posteriores, por serem considerados de relevância para as comparações que serão feitas ao longo deste trabalho.
2.2	Escalas Associadas ao Fluxo Multifásico em Meios Porosos
As escalas relacionadas ao processo de descrição e simulação numérica de fluxo multifásico em meios porosos são: a escala de poros (10-500 pm), a escala de laboratório (1-10 cm), a escala do contínuo (1-50 m) e a escala de campo (100-10000 m). Cada uma destas escalas participa de diferentes formas no processo de descrição do meio poroso. A escala de poros possui importância pois nela se manifestam as forças capilares e os mecanismos de deslocamentos. A grande maioria de medições experimentais, como aquelas que determinam as relações constitutivas, é feita na escala de laboratórios. Na escala do contínuo estão incluídas as simulações multifásicas, uma vez que utilizam escalas de discretizações desta ordem. A escala de campo representa a ordem de comprimento de alguns problemas práticos de campo, que podem se estender sobre centenas de metros e, por isto, os simuladores devem ser capazes de solucionar problemas também nesta escala.
As equações que descrevem o fenômeno de transporte em meios porosos, colocadas sob a forma de princípios de conservação, são formuladas sob o ponto de vista da hipótese do contínuo. Segundo Bear (1972), na aplicação da hipótese do contínuo à dinâmica de fluidos, é preciso introduzir coeficientes, ou parâmetros macroscópicos, para ajustar os fenômenos observados e permitir a passagem do nível microscópico para o nível contínuo, agora macroscópico. O problema de representação destes parâmetros estará sempre em determinar as dimensões do volume poroso representativo. A mudança de escala, da escala de poros para
escala do contínuo, é geralmente explicada usando o conceito de Volume Elementar Representativo (Representative Elenientary Volume, ou REV). De acordo com este conceito, as propriedades do meio poroso são progressivamente ponderadas sobre volumes cada vez maiores, até convergir para um valor estável, acima de certo volume mínimo. Propriedades na escala do contínuo são definidas como médias sobre volumes maiores do que este volume mínimo. O volume elementar representativo possui dimensões tais que o efeito de adicionar ou subtrair um ou vários poros não produz alteração no valor de um determinado parâmetro.
Uma vez que é impossível, do ponto de vista prático, a descrição a nível molecular, cabe então adequar a escala de descrição à escala de observação, que pode ser de uma ordem de grandeza muito maior do que a escala a nível de poros. As equações de balanço de massa conservam a mesma forma em qualquer escala, acima da escala do contínuo. No entanto, muitas das medições de propriedades do meio poroso são feitas na escala de laboratório, e algumas propriedades geológicas, por exemplo, exibem variações significativas em escalas de comprimentos entre 5 cm e 10 m. Esta descrição, para um problema de campo, pode requerer um número de blocos da ordem 106 a 107. Portanto, definir a escala das equações governantes na escala do laboratório requer um enorme esforço computacional. Dadas as limitações de tal modelagem, a alternativa é utilizar escalas de discretização maiores e o problema passa a ser a determinação dos parâmetros efetivos para cada bloco, uma vez que tais propriedades passam a ser definidas em escalas muito maiores do que foram medidas.
No caso das relações constitutivas, elas precisam ser definidas numa escala nas quais as variáveis primárias, pressão e saturação, são definidas. Estas relações são medidas em escalas de laboratório e suas definições são portanto, restritas a esta escala. Usando blocos maiores, a questão passa a ser como definir as equações constitutivas, medidas numa escala menor, na escala do bloco da malha.
necessitam então da descrição de propriedades localmente uniformes na escala dos blocos da malha de diferenças finitas.
A transferência de escala consiste basicamente em representar os diversos parâmetros, adquiridos em diferentes escalas, na escala da simulação numérica. Não existem métodos exatos, descritos formalmente, para alteração de escala em problemas de fluxo multifásico. Uma dificuldade adicional é que a descrição das propriedades ao longo dos reservatórios geralmente é feita em termos estatísticos. Por estas razões, o problema tem sido tratado de forma heurística e regras gerais têm sido desenvolvidas empiricamente.
No caso das variáveis aditivas a tarefa de mudança de escala é trivial. Conceitos de médias em geral são empregados com resultados adequados. A porosidade de um bloco, por exemplo, pode ser obtida através de uma média aritmética dos sub-blocos que o compõe. O volume poroso é obtido somando-se os valores dos volumes porosos dos sub-blocos. No grupo das variáveis não aditivas estão a permeabilidade absoluta e as relações constitutivas. Nestes casos, o problema passa a ser mais complexo, e técnicas distintas são empregadas para obtenção de parâmetros equivalentes.
Para as permeabilidades absolutas, segundo Ribeiro (1996), ‘'obter uma permeabilidade equivalente, significa substituir um meio heterogêneo, onde a permeabilidade varia no espaço, por um meio homogêneo, onde a permeabilidade é uniforme, de tal modo que a substituição seja equivalente para certas finalidades e/ou para certas situações”. Os critérios de equivalência neste caso podem estar associados a uma igualdade de fluxos ou uma igualdade de dissipação de energia. Neste segundo critério, o que se busca é igualar a potência consumida pelas forças de viscosidade ao longo do escoamento.
No caso de fluxo multifásico, os parâmetros a serem alterados são também as relações constitutivas. A abordagem mais tradicional é aquela que utiliza pseudo-funções multifásicas, ou pseudo-curvas. Esta técnica consiste na substituição das funções reais, que descrevem, por exemplo, uma relação entre permeabilidade relativa e saturação, por falsas curvas. Estas, por sua vez, passam a ser utilizadas na etapa de simulação do reservatório, com o objetivo de
transladar resultados de uma escala mais refinada para a escala de simulação. Estas curvas são construídas para os blocos de uma malha grossa, a partir de simulações multifásicas em cada um destes blocos, considerando as informações na escala mais refinada. Pode-se classificar as pseudo-funções em duas categorias: as baseadas na hipótese de equilíbrio vertical e as dinâmicas. A origem e as principais características de algumas delas serão apresentadas na próxima seção.
Outras abordagens alternativas, ligadas a mudança de escala em fluxo multifásico, procuram contornar as limitações das pseudo-funções e serão apresentadas no final deste capítulo. O que se pretende com estas técnicas alternativas é capturar os efeitos das heterogeneidades diretamente da simulação numérica em determinadas regiões de um modelo refinado e através de alguns parâmetros de fluxo promover a equivalência entre este modelo e a malha de simulação.
2.3	Procedimentos de Mudança de Escala em Fluxo Multifásico Baseados em Pseudo-Funções
O processo de mudança de escala, a partir do uso de pseudo-curvas, depende, entre outros fatores, do mecanismo físico que atua durante o deslocamento que está sendo simulado. Estes mecanismos são dominados pela força da gravidade quando a diferença dos pesos específicos das fases é alta. A capilaridade, por sua vez, atua no sentido de definir a molhabilidade da rocha. As forças viscosas atuam em processos onde as velocidades são altas. Dependendo da razão entre estas três forças, o resultado da mudança de escala pode fornecer diferentes grupos de pseudo-curvas.
Quando o fluxo é dominado pela gravidade ou pelas forças capilares, ou a combinação das duas, a distribuição de fluidos na direção vertical pode ser determinada assumindo equilíbrio estático entre as forças capilar e graviracional. Para o caso onde as fases estão segregadas, sob gravidade, as pseudo-funções baseadas no equilíbrio vertical podem ser calculadas como descrito por Coats et al. (1971). A premissa de equilíbrio vertical pode ser justificada quando existe uma boa comunicação vertical no reservatório, as velocidades de
Considerando que a premissa de boa comunicação vertical nem sempre pode ser satisfeita, Heam (1971) desenvolveu um outro procedimento para determinar pseudo-permeabilidades relativas, considerando o mecanismo de injeção de água em reservatórios estratificados. Sua abordagem considera que forças viscosas e não as forças capilar e gravitacional determinam a distribuição dos fluidos na direção vertical. Outras considerações feitas foram fluxo incompressível e deslocamento tipo pistão ao longo das camadas. Posteriormente, Hawthome (1974) mostrou como o modelo de Heam poderia ser modificado para incluir os efeitos de pressão capilar.
Emanuel e Cook (1974) estenderam o conceito de pseudo-permeabilidade relativa para ajustar a performance de poços, utilizando uma técnica similar a desenvolvida até então para fluxo na formação. Igualando a produção obtida no modelo de uma seção transversal, onde o poço possui várias completações, e a produção do modelo areal, e assumindo aproximações para as pressões nos dois modelos chega-se a uma formulação para obtenção de pseudo permeabilidades relativas para o poço no modelo areal. Através de exemplos, utilizando diferentes esquemas de completação de poços, distribuídos numa seção transversal, os autores mostraram a diferença entre resultados obtidos por um modelo unidimensional equivalente, quando se utiliza as curvas originais de permeabilidades relativas, as pseudo-curvas propostas por Heam (1971) em todo o reservatório e o esquema proposto, onde as pseudo-curvas para poços foram consideradas. Exceto em esquemas de completações particulares, este último esquema apresentou melhor desempenho.
Os modelos de Coats et al, (1971) e Heam (1971), derivados para ajustar o fluxo entre os blocos, deixam de ser válidos quando existem grandes variações de vazões e as forças viscosas adquirem importância no escoamento. É neste contexto que se aplicam as pseudo-funções denominadas dinâmicas, por dependerem também do espaço e do tempo. Esta classe de pseudo-funções não assume, a priori, nenhuma hipótese sobre o tipo de mecanismo físico
que age durante o deslocamento e são usadas principalmente quando o principal mecanismo físico são as forças viscosas,
Com o objetivo de estender ainda mais o conceito das pseudo-curvas, Jacks et al. (1973) propuseram uma metodologia baseada em simulações de seções verticais, que gera diretamente um conjunto de pseudo-permeabilidades relativas para cada coluna vertical do modelo de malha fina, em situações onde o equilíbrio vertical não poderia ser adotado. Segundo os autores, esta nova abordagem permite obter funções válidas para um intervalo maior de vazões e saturações iniciais de fluidos, e, pelo fato de dependerem do espaço e do tempo foram denominadas pseudo-funções dinâmicas. O uso destas novas funções resolveu a limitação de baixas vazões dos métodos de equilíbrio vertical. A principal desvantagem e fonte de imprecisão do método está na obtenção de uma única curva, que é resultado de processos usuais de média.
Um dos métodos mais difundidos para o cálculo das pseudo-permeabilidades relativa dinâmicas foi proposto por Kyte e Berry (1975). Estes autores apresentaram um procedimento que se baseia na lei de Darcy para o cálculo das pseudo-funções, e pode ser considerado uma extensão da proposta de Jacks et al. (1973). Nesta extensão, além de incluir as pseudo-curvas de pressão capilar, as simulações das seções verticais passaram a considerar apenas um bloco na direção vertical. Diferentemente da proposta de Jacks et al. (1973), este método calcula o gradiente de pressão através da simulação da malha fina e as pseudo-funções são então obtidas num passo seguinte. Uma derivação do método de Kyte e Berry (1975) utiliza pressões das fases ponderadas pelo volume poroso, mas basicamente mantém toda a formulação original do método. Este procedimento, disponível no módulo PSEUDO do simulador ECLIPSE, melhora o desempenho do método em relação a geração de pseudo-curvas de pressão capilar, mas não altera os problemas que podem surgir nas curvas de permeabilidade relativa. Num estudo comparativo realizado por Barker e Dupouy (1996). que analisou cinco diferentes processos dinâmicos de obtenção de pseudo curvas de permeabilidades relativas, o método ponderado pelos volumes porosos foi o que melhor reproduziu a solução da malha fina, com o menor número de inconsistências nas pseudo curvas geradas.
Davies e Haldorsen (1987) mostraram que, em problemas onde heterogeneidades estão presentes em todos os blocos da malha fina, a utilização do método de Kyte e Berry (1975) não apenas atua no sentido de corrigir a dispersão numérica como também efetua a mudança de escala relativa a estas heterogeneidades.
Outra forma de obtenção das pseudo permeabilidades relativas, disponível no PSEUDO, é a média ponderada das permeabilidades relativas. Neste método as pseudo curvas são obtidas efetuando-se uma média das permeabilidades relativas dos blocos finos situados na face de saída do bloco grosseiro, ponderadas pelas transmissibilidades destes blocos finos. O resultado é a obtenção de curvas monotônicas e situadas no intervalo [0,1], mas sem nenhum compromisso quanto a reprodução da solução da malha fina.
Starley (1988) apresentou um método baseado em balanço de materiais para derivar pseudo-funções entre blocos, numa aplicação específica para esquema de injeção de água. Seu método baseia-se em expressões bastantes similares as apresentadas por Jacks et al. (1973). O método concentra-se num ajuste de fluxo de fluidos entre conexões correspondentes dos blocos de um modelo fino, referencial, e dos blocos do modelo grosseiro. Ao forçar um ajuste de fluxos nestes conexões correspondentes, a mobilidade total dos fluidos é ajustada entre os modelos. Este método acopla um esquema de ponderação da mobilidade da fase água com o desenvolvimento, propriamente dito, das pseudo-funções. O objetivo deste acoplamento é fazer com que estas funções e o esquema de controle de dispersão operem em conjunto para minimizar os efeitos de orientação de malha e dispersão numérica. As limitações deste esquema estão associadas ao fato de que a derivação das equações considerou um tratamento específico de dispersão numérica, o qual depende de um esquema de ponderação de difícil quantificação.
Outras metodologias de cálculo de pseudo-funções dinâmicas utilizam equações para fluxo total para tentar ajustar potenciais ou gradientes de pressões na malha grossa. Elas utilizam o parâmetro mobilidade total média que é obtido a partir de simulações da malha fina. Stone (1991) foi o primeiro a utilizar o parâmetro mobilidade total média, com o objetivo de evitar os problemas associados com a estimativa de pressões da malha grossa do
método de Kyte e Berry (1975). Da forma como foi proposta por Stone (1991), esta metodologia permite obter as pesudo-permeabilidades relativas a partir da mobilidade total e do fluxo fracionário, desde que os efeitos gravitacionais sejam desprezados. A introdução do conceito de fluxo fracionário assegura um ajuste preciso dos fluxos volumétricos das fases através da conexões dos blocos da malha grossa. O método de Stone (1991) mostrou-se aplicável mesmo no caso de camadas não comunicantes.
Outros métodos também baseados em diferentes formas de se calcular a mobilidade total foram propostos por Hewett e Berhens (1991) e Beier (1992). Todas estas metodologias são consideradas mais robustas, pois evitam o aparecimento de valores de pseudo-permeabilidades relativas negativas, ou maiores que 1, como pode ocorrer com a proposta original de Kyte e Berry (1975). Beier (1992), após comparar os procedimentos baseados em mobilidade total, apresentou um método para calcular pseudo-permeabilidades relativas que funciona bem para baixas razões de mobilidade, onde, segundo Beier, o método de Hewett e Berhens falha. Neste método, uma média das permeabilidades relativas, ponderada pelo produto entre a permeabilidade absoluta e o gradiente de pressão locais, ou seja, os fluxos locais, permite obter uma expressão para a pseudo-função.
Lasseter et al. (1986), a partir da formulação apresentada por Kyte e Berry (1975), apresentaram uma extensão ao conceito tradicional do uso de pseudo-funções em reservatórios heterogêneos. Foram também os primeiros autores a apresentar um esquema multiescala para obtenção das pseudo-funções. Baseando-se em heterogeneidades que se desenvolvem em pequena, média e grande escala, eles propuseram um procedimento seqüencial que tem início nas curvas de laboratório e, indo da menor para a maior escala, constróem as pseudo-curvas de permeabilidade relativa e pressão capilar, através de sucessivas simulações numéricas. Diferentemente de Kyte e Berry (1975), utilizam um método algébrico para mudança de escala das permeabilidades absolutas.
elas são eficientes na correção dos efeitos da dispersão numérica, atrasando o tempo de irrupção de uma das fases.
Kossack et al. (1989) descrevem outro procedimento de geração de pseudo-funções de permeabilidade relativa, em três passos, envolvendo três padrões de heterogeneidades: homogêneo, aleatório e estratificado. Para cada modelo geológico foi verificada a eficácia das pseudo-funções para um intervalo de valores da razão de mobilidades, das forças viscosas e gravitacionais e das forças viscosas e capilares. O objetivo foi estender o trabalho de Lasseter (1986) e analisar os efeitos destas várias escalas de heterogeneidades, em diferentes disposições geológicas, nas pseudo-funções. No cálculo das pseudo-curvas, foram utilizadas as equações de Kyte e Berry (1975) através do uso do software PSEUDO. Neste trabalho, Kossack et al. (1989) procuraram também determinar que tipo de distribuição de heterogeneidades (homogêneo, estratificado, aleatório), combinadas com quais padrões de fluxo de fluidos (identificados por parâmetros adimensionais baseados nas razões entre forças capilares, gravitacionais e viscosas), levam a necessidade ou não de mudança de escala. Verificou-se com esta investigação que, em certas condições especiais, as pseudo-funções são muito similares às funções reais e o processo de mudança de escala pode ser desnecessário, ou seja, o uso das pseudo-funções dever ser justificado adequadamente antes de sua aplicação. Esta observação é relevante principalmente se forem consideras todas as incertezas e erros associados à própria metodologia.
King (1989) formulou a teoria da renormalização para obter a permeabilidade média efetiva para reservatórios heterogêneos. O autor tratou a malha fina como uma rede de resistores elétricos e agrupou conjuntos de 2x2 blocos usando a Lei de Kirchoff para calcular uma permeabilidade renormalizada. Após repetidos passos de renormalização a permeabilidade média tende a um valor estacionário. King (1989) apresentou resultados para fluxo monofásico e bifásico. Alguns autores como Hewett e Berhens (1990) e Yamada e Hewett (1995) têm enfatizado alguns erros introduzidos pelo tratamento das condições de contorno impostas a cada bloco, a cada etapa da renormalização, conforme proposto por King.
Alabert e Corre (1991) apresentaram um desenvolvimento interessante que foi denominado pelos autores como “urna nova técnica para obtenção de ponderação de permeabilidades relativas e pressão capilar”. Embora o procedimento apresentado esteja baseado em elementos de simulação numérica, seu produto final são pseudo-curvas para serem utilizadas numa posterior simulação da malha grossa. As etapas de solução têm início com a descrição de Kh, K,. e curvas de permeabilidades relativas para cada bloco da malha fina. Para cada par de fluidos (água-óleo e gás-óleo) uma região refinada é simulada em cada direção do espaço, gerando soluções em termos de pressões e saturações para cada bloco que compõe a região, a cada instante. Estes valores são armazenados, sendo as saturações utilizadas para obter o tensor de permeabilidades efetivas para cada bloco, através da curva original de permeabilidade relativa. Com estes resultados é possível efetuar a mudança de escala das permeabilidades efetivas de cada fase, através de uma simulação de fluxo monofásico em regime permanente, sendo a região considerada com um bloco. A mudança de escala de saturações é feita de forma usual, através da média ponderada pelos volumes porosos. Uma vez determinados os valores de saturação, permeabilidade efetiva e permeabilidade absoluta de cada bloco, a permeabilidade relativa é obtida de forma direta. Segundo Barker e Dupouy (1996), os métodos que adotam a solução permanente para obter as permeabilidades efetivas, limitam a aplicabilidade a problemas de deslocamento onde as frentes de saturações são suaves.
No trabalho de Alabert e Corre (1991), a pressão capilar efetiva, para um dado par de fluidos, a uma saturação especificada, é obtida pela média da pressões dos fluidos, no instante em questão, considerada sobre todos os blocos finos. Ao final deste processo são obtidas curvas dependentes do tempo, para cada par de fluidos e para cada direção desejada.
No caso particular onde as forças capilares são dominantes, as pseudo-curvas podem ser calculadas através da mudança de escala da permeabilidade de cada fase e sua posterior normalização pela permeabilidade absoluta, após esta sofrer mudança de escala, como foi descrito em Lemouzy, Romeu e Morelon (1993). Estes autores optaram por um método algébrico para efetuar a mudança de escala, tanto das permeabilidades das fases quanto das permeabilidades absolutas. Alabert e Corre (1991) apresentam uma variação deste método.
onde o tensor de permeabilidades efetivas é obtido através da simulação de fluxo monofásico permanente, considerando o refinamento dentro de cada bloco.
Considerando uma abordagem analítica, como nos modelos de Coats et al. (1971) e Hearn (1971), Rubín et al. (1993) efetuaram a mudança de escala em um problema envolvendo fluxo composicional mu lti-dimensional instável, finge ring viscoso, em reservatórios homogêneos, permitindo sua solução através de um modelo unidimensional, com o uso pseudo-funções para a mobilidade total e o fluxo dos componentes.
Com o objetivo de explicar a inconsistência de alguns resultados obtidos durante o processo de mudança de escala quando se utiliza as pseudo-funções de Kyte e Berry (1975), Soedanno et al. (1994) utilizaram o conceito de dependência da escala para explicar estas discrepâncias, que teriam como justificativa o comportamento não constante das velocidades de saturações na simulação da malha fina. Por isto propõem um procedimento LDP ( Length-dependent Pseudofunctionf que se baseia em diagramas x-r, ou curvas características, geradas a partir de resultados da simulação na malha fina. Nestas curvas são identificados trechos lineares e geradas pseudo-funções para cada um destes trechos, que representam pontos com velocidades de saturações constantes. Seus resultados mostraram a possibilidade de usar menos blocos e obter melhores resultados do que Kyte e Berry (1975).
As pseudo-propriedades multifásicas derivadas tanto pelo método de Kyte e Berry (1975) quanto pelo método de Stone (1991) consideram fluxo numa única direção. Segundo Pickup e Sorbie (1994), as pseudo-funções em meio heterogêneo são de uma forma geral altamente anisotrópicas e por isto os métodos de geração de pseudo-curvas devem ser aplicados em diferentes direções. Um exemplo disto são as iterações de heterogeneidades presentes em pequenas escalas e pressões capilares, que causam efeitos direcionais. Para que as curvas de pseudo-permeabilidades relativas possam refletir os efeitos de fluxo cruzado, por exemplo, estes autores propuseram o uso de um tensor de pseudo-permeabilidades relativas na mudança de escala, em fluxo bifásico. No entanto, as técnicas adotadas para cálculo destas pseudo-curvas foram as mesmas presentes em Kyte e Berry (1975) ~ blocos considerados para calcular o fluxo entre os blocos da malha grossa - , Stone (1991) - uso de fluxo fracionário -
Um processo alternativo para definir pseudo-funções é a utilização de métodos numéricos aproximados baseados em linhas de fluxo. A solução para a função de fluxo é inicialmente obtida pela solução da equação de Laplace, com vazões médias atribuídas aos poços. A geometria das linhas de fluxo são obtidas calculando-se incrementos iguais para a função de fluxo. Estes contornos representam os limites das linhas de fluxo, que são paralelos às velocidades locais, No caso de deslocamentos de fluidos com razão de mobilidade unitária e injeção a vazão constante, o fluxo volumétrico de cada linha de fluxo é igual. Para razões de mobilidade maiores que 1, o campo de velocidades varia continuamente e o método precisa ser ajustado através de uma ponderação dos volumes de fluxo através da mobilidades média dos fluxos em cada linha de fluxo. Assim como nas demais metodologias, este método se baseia numa distribuição espacial fixa para os poços. Qualquer mudança na configuração dos poços requer o cálculo das linhas de fluxo, utilizando novos valores de mobilidades. Além disto, os métodos baseados em linhas de fluxo não são adequados para modelos de depleção primária, uma vez que se baseiam em fluxo incompressível. Também mecanismos de produção com forte influência do componente gravitacional não são adequadamente reproduzidos pelo método. Hewett e Behrens (1990) apresentaram uma aplicação do método onde inicialmente uma mudança de escala, utilizando diferenças finitas, é aplicada a uma seção transversal de um modelo tridimensional. Esta simulação fornece os elementos suficientes para a aplicação do procedimento baseado em linhas de fluxo para o modelo no plano xy. Este método híbrido foi aplicado a deslocamentos miscíveis e imiscíveis em meios heterogêneos.
trabalho estendeu, para o caso tridimensional, o trabalho de Hales (1983) que abordou apenas seções transversais verticais e fluxo bifásico. Nestes casos a obtenção de curvas suaves, monotônicas é assegurada, bem como a reprodução da solução da malha fina. No entanto a determinação do número de conjuntos de curvas de permeabilidades relativas a serem utilizados na malha grossa e a não unicidade do processo são dificuldades descritas nesta forma de mudança de escala. Além disto outra desvantagem reside no fato do ajuste ser obtido apenas nos poços e não necessariamente entre os blocos desta malha.
Em todos estes métodos de cálculo de pseudo-funções tem-se que definir inicialmente qual a parte do modelo fino irá ser considerada no detalhamento do padrão de fluxo, numa determinada região, sem que seja necessária a solução completa do modelo finamente descrito.
Thibeau et al. (1995) propuseram a técnica alternativa, denominada Dual Scale Simulation (DSS), na qual um refinamento dentro e ao redor de um determinado bloco da malha grossa, para o qual se pretende gerar pseudo-curvas, é acrescido à malha grossa. As simulações de fluxo são então realizadas utilizando-se esta malha irregular, gerando assim as pseudo-curvas para o bloco especificado. Este procedimento tenta aproximar as condições reais nas quais o bloco da malha grossa estaria sujeito na simulação de toda a malha. Este desenvolvimento foi aplicado a simulação de fluxo composicional, onde além de ajustar o fluxos das fases, foi implementado um fator para corrigir o fluxo de cada componente dentro de cada fase. As pseudo-funções utilizadas foram semelhantes às funções apresentadas por Kyte e Bcn y (1975), mas expressas em termos de fluxo molar e não em termos de fluxo volumétrico. Segundo as conclusões destes autores, o uso da técnica DSS permite obter pseudo-funções mais representativas do que as outras abordagens, que consideram apenas parte do domínio com alto grau de resolução. De qualquer forma, as condições de contorno simuladas para os blocos da malha grossa somente são válidas para um determinado tempo; se elas sofrem grandes alterações com o tempo é necessário recalcular as pseudo-funções.
viscosas. Da mesma forma que Kossack et aL (1989), estes autores se ativeram ao fato de que a mudança de escala das funções multi fásicas passa necessariamente pela escala de laboratório e apresentaram também uma metodologia baseada numa seqüência de etapas, considerando várias escalas de heterogeneidades - escala de laboratório (amostra), escala de litofácies, escala do modelo geológico e escala da simulação de reservatórios. No primeiro passo deste processo, as permeabilidades relativas medidas em laboratórios, passam a ser representadas na escala a nível das litofácies. As permeabilidades relativas efetivas resultantes são definidas em blocos do modelo geológico e, finalmente, um conjunto de curvas é definido para cada bloco do modelo de simulação. Para cada etapa de mudança de escala das permeabilidades relativas, os autores apresentam três métodos de cálculo: o primeiro, baseado em simulação numérica, bifásica, em regime permanente, calcula pseudo-permeabilidades relativas e pseudo pressão capilar e é mais adequado em casos onde o fluxo é dominado pelas forças capilares: o segundo, baseado num procedimento analítico que se aplica aos casos onde as escalas de comprimento são tão grandes que as forças capilares perdem importância, como ocorre na etapa de passagem da escala do modelo geológico para o modelo de simulação; o terceiro, baseado também em simulação numérica com apenas duas corridas de um simulador bifásico: uma com fluxo fracionário igual a 1 e outra com fluxo fracionário igual a 0, para determinar os pontos finais das curvas de permeabilidades relativas. Este terceiro método tem aplicação em escalas intermediárias de heterogeneidades e onde existe alguma iteração entre forças capilares e heterogeneidades.
Uma formulação baseada na utilização de fluxo fracionário, como em Stone (1991), foi apresentada por Zhang e Sorbie (1995), com aplicações em deslocamentos miscíveis e imiscíveis, com qualquer razão de mobilidade. Nesta técnica de mudança de escala, a viscosidade efetiva é tratada de forma explícita com o objetivo de adaptar o método tanto para deslocamentos imiscíveis quanto para deslocamentos miscíveis. As diferenças entre este método e o de Stone é a utilização de informações de deslocamento de fluidos com razão de mobilidade unitária e o tratamento da viscosidade efetiva. Para deslocamentos miscíveis a viscosidade efetiva é derivada das mobilidades das fases e é uma função da saturação. Para deslocamento miscível, é uma função da concentração do solvente. Como nos métodos já citados o uso do fluxo fracionário permite o ajuste dos fluxos volumétricos das fases.
enquanto a mobilidade total, ponderada pela transmissibilidade. assegura o ajuste das propriedades dos fluidos que são função apenas da pressão. O método foi testado num modelo bidimensional, num esquema de injeção de um quarto de five spot, em deslocamentos com razões adversas de mobilidade, e apresentou um bom desempenho em termos de recuperação. Estes resultados numéricos utilizaram uma malha fina de 100 x 100, enquanto a malha grossa correspondente era de 25 x 25 blocos.
Com relação ao ajuste dos fluxos entre poços entre duas malhas de diferentes discretizações, um avanço foi apresentado por Ding (1995), cuja formulação para mudança de escala nas vizinhanças de poços considera o regime de fluxo radial. Neste trabalho, a mudança de escala longe das regiões de poços considera padrão de fluxo linear com condições de fluxo nulo nas bordas e pressão constante nas faces de entrada e saída dos fluidos nos blocos. A simulação do bloco fino nas regiões de poços considera padrão de fluxo radial e os parâmetros ajustados são a transmissibilidade e o índice de produtividade dos poços. Estes parâmetros são obtidos através da simulação da região refinada em regime permanente, que é estabelecido através de poços auxiliares, além do poço em questão, distribuídos de forma uniforme ao redor deste poço. Testes, considerando um meio heterogêneo, mostraram que a condição imposta nestes poços auxiliares têm pouca influência na obtenção destes parâmetros equivalentes, e que eles podem ser considerados como intrínsecos para aquela descrição de heterogeneidades.
Assim como Coats et al. (1971). Heam (1971) e Rubin et al. (1993), Lee et al. (1995) adotaram uma abordagem analítica para obter tensores de permeabilidades absolutas e permeabilidades relativas efetivas. No caso de fluxo bifásico, o método assume fluxo permanente sob condições de equilíbrio entre forças viscosas e capilares para obter expressões para as permeabilidades efetivas. Simulações numéricas mostraram que um mesmo campo de heterogeneidades pode resultar em diferentes propriedades efetivas de fluxos, dependendo da direção do fluxo.
2.4	Procedimentos de Mudança de Escala Baseado em Elementos de Simulação Numérica
Com o objetivo de contornar o fato de que, qualquer que seja o método adotado para o cálculo das pseudo-funções, elas são altamente dependentes do processo e condições segundo as quais elas foram geradas, alguns trabalhos têm apresentado procedimentos que proporcionam um maior grau de generalidade à tarefa de mudança de escala.
Partindo de testes realizados por Ramé e Killough (1992), que apresentaram um método de interpolação de pressões de uma malha grossa para outra mais refinada, Guérillot, Thomas e Verdiére desenvolveram um esquema de mudança de escala baseado no uso de uma malha grossa para solução da equação da pressão e outra refinada para solução da equação da saturação. O desenvolvimento deste esquema, denominado Dual Mesh Method (D MM), ocorreu em duas etapas: a primeira etapa, descrita por Guérillot e Verdiére (1995), investigou o processo de solução apenas da equação da pressão numa malha de baixa resolução ( menos refinada) e a interpolação dos resultados para outra malha refinada, levando em consideração meio heterogêneo; a segunda etapa, descrita por Verdiére e Thomas (1996), permitiu o desenvolvimento de um algoritmo no qual, após a solução da equação de transporte numa escala menos refinada, uma seqüência de problemas locais são resolvidos, considerando blocos refinados, com condições de contorno do tipo Neumann, obtendo assim a distribuição de saturações em cada uma das regiões refinadas. Toda a metodologia baseia-se na hipótese de fluido incompressível e os poços foram representados apenas pelas condições de contorno nos blocos.
Uma das metodologias que mais se aproxima do esquema proposto neste trabalho foi abordado por Celia et al. (1993) num artigo especulativo sobre o tratamento de diversas escalas em simulação de reservatórios de petróleo. Baseando-se estritamente nas escalas de medições de parâmetros, principalmente nas relações constitutivas, estes autores descreveram um processo de solução no qual, a cada bloco da malha de diferenças finitas está associado um simulador na escala de poros, cuja função seria construir as curvas constitutivas efetivas para cada um destes blocos. A cada iteração Newtoniana. as propriedades não lineares seriam
Durlofsky et al. (1995) apresentaram uma seqüência de procedimentos com o objetivo de compor um método mais geral, que considera reservatórios heterogêneos, com descrição tridimensional. Nesta seqüência, o primeiro passo é a geração de uma malha grossa não-uniforme, onde regiões mais refinadas são introduzidas nos pontos de altas taxas de fluxo. Estes pontos são identificados através de simulação simplificada, adotando-se fluxo monofásico. Na parte relativa a descrição das propriedades do reservatório, a mudança de escala é baseada na teoria da homogeneização, cujas bases e conceituação podem ser encontradas nos trabalhos de Bourgeat (1984) e Amaziane (1993). Um pressuposto inicial e básico desta teoria é que o campo de permeabilidades, na escala mais refinada, varia segundo dois comprimentos de escala distintos. O fato de nem sempre as descrições geológicas satisfazerem esta condição da teoria da homogeneização, é compensada, segundo o autor, pela adoção da malha não uniforme, gerada segundo o critério de presença de regiões de altas permeabilidades.
A teoria da homogeneização gera um conjunto de equações diferenciais parciais, que resolvidas para cada bloco, ou região da malha grossa, fornece um tensor de permeabilidades efetivas, que será usado em substituição às permeabilidades da malha fina. Outro procedimento apresentado, que também é derivado da teoria da homogeneização, está na utilização da curva original de permeabilidades relativas, sem a necessidade de geração de pseudo-curvas.
tensores de permeabilidades, proposto por Pickup e Sorbie (1994), como uma forma de diminuir o número de blocos da malha grossa. Também os métodos baseados em renormalização, como o descrito em Christie (1995), que divide o processo de mudança de escala em uma série de passos, indo da malha fina para outra ligeiramente menos refinada, até que a malha final, bastante mais grosseira seja alcançada, pode permitir a redução do número blocos. A menção a estes dois últimos trabalhos é devida ao fato dos mesmos serem tentativas de obter pseudo-funções mais independentes do processo, do que normalmente são as outras formas de cálculo.
Capítulo 3
Pseudo-Funções
3.1	Introdução
Simulações numéricas de reservatórios que consideram modelos tridimensionais ou uma série de refinamentos locais são exemplos de situações que requerem um elevado número de blocos da malha de discretização. Um modelo extremamente refinado pode sofrer tanto limitações de custo quanto limitações de recursos computacionais. É por esta razão que a origem das pseudo-funções está relacionada a pesquisa por técnicas que permitissem a consideração da escala tridimensional em simuladores de reservatórios, nos anos 60. O uso de pseudo-funções é um recurso que procura representar as propriedades de rocha, definidas em blocos de pequenas dimensões, em blocos maiores, através de técnicas específicas. O conjunto destes blocos maiores formam então o que se denomina malha grosseira, assim denominada por comparação com aquela escala onde as propriedades petrofísicas são descritas.
No caso particular de fluxo multifásico é necessário construir pseudo-curvas de permeabilidades relativas e pseudo-curvas de pressão capilar e incorporá-las ao modelo numérico da malha grossa. Dois conceitos de permeabilidades relativas modificadas são encontrados normalmente na literatura: a permeabilidade relativa efetiva, que representa os efeitos das heterogeneidades em processos de fluxo e a pseudo permeabilidade relativa, que incorpora também os efeitos de dispersão numérica.
Embora a origem destas pseudo-curvas esteja ligada a problemas de redução de dimensionalidade (3D para 2D, por exemplo) e correção de dispersão numérica, atualmente o enfoque está direcionado para a redução do número de blocos, com ou sem redução da dimensionalidade. Este fato está intrinsecamente ligado aos avanços das técnicas geoestatísticas de caracterização, que conseguem descrever fmamente o meio poroso, gerando contudo um volume de informações que não pode ser tratado diretamente pelos simuladores convencionais.
Um ponto extremamente importante que deve ser enfatizado em relação a esta técnica é que este processo leva necessariamente a uma perda de informações e somente soluções aproximadas podem ser obtidas. A sua aplicação é restrita portanto a situações onde a simulação numérica com uma malha refinada é impraticável e se requer uma melhor precisão do que aquela fornecida pela malha de simulação com blocos maiores. De qualquer forma um certo grau de aproximação e incerteza está sempre associado ao processo de mudança de escala, seja através de pseudo-funções ou outro procedimento qualquer.
No caso específico das pseudo-funções existe uma série de limitações na técnica. Teoricamente as pseudo-funções dinâmicas funcionam apenas para as exatas condições para as quais elas foram geradas. O que se procura nas diversas abordagens que foram apresentadas no capítulo anterior é aperfeiçoar e dar maior robustez ao processo de mudança de escala via pseudo-funções, tentando minimizar as limitações e ampliar sua representati v idade.
Uma revisão geral do uso de pseudo-funções, suas propriedades e limitações, pode ser encontrada no trabalho de Barker e Thibeau (1996). Além desta revisão, uma comparação entre cinco métodos dinâmicos de mudança de escala foi apresentada por Barker e Dupouy (1996) e uma investigação sobre a confiabilidade de algumas pseudo-funções foi realizada porGuzman et al. (1996).
3.2	Processo de Obtenção das Pseudo-Funções
Como foi introduzido no capítulo anterior, os efeitos das heterogeneidades presentes na escala mais refinada podem ser incluídas no modelo considerado grosseiro, através do uso de curvas fictícias que passam a substituir as curvas reais. Em modelos Black-Oil, utiliza-se as curvas de permeabilidades relativas e pressão capilar; em deslocamentos miscíveis, as funções fluxo fracionário e mobilidade total; nos modelos composicionais, os fatores a, denominados coeficientes de transporte, que têm como função corrigir o fluxo dos componentes dentro de cada fase (Thibeau et aL (1995)). A geração de pseudo-curvas consiste basicamente em obter parâmetros associados à malha grossa a partir dos quais seja possível construir uma nova relação entre, por exemplo, permeabilidade relativa e saturações médias dos blocos.
Modelos simplificados, analíticos ou numéricos, podem ser utilizados para obtenção destas pseudo-funções. Os métodos analíticos são válidos em situações onde algumas hipóteses bastantes simplificadoras, relativas ao mecanismo de produção ou à estrutura do reservatório, são atendidas. Exemplos destas condições idealizadas são a consideração de equilíbrio vertical (Coats et aL (1971)) e a seqüência de camadas não comunicantes (Heam. (1971)).
Os métodos numéricos tradicionais utilizam, de uma forma eeral. simulações de fluxo, em regiões do modelo refinado para construir as pseudo-funções, conforme ilustrado pela Fig.
3.1.	Elas irão representar o conjunto de blocos desta região numa discretização menos refinada. Estas pseudo-funções dinâmicas, diferentemente daquelas geradas pelos métodos analíticos, consideram simultaneamente iterações das forças viscosas, gravi taci onais e capilares. A este conjunto de blocos aplica-se uma diferença de potencial constante (ou fluxo constante) numa determinada direção e as vazões na face de saída são obtidas em função das saturações médias. As pseudo-funções dinâmicas são então calculadas a partir destes efluentes, aplicando-se diferentes formulações, como as apresentadas a seguir, e passam a representar um único bloco na malha grossa.
^entrada
Osaída
Q...Q
Fig. 3.1 - Região da malha fina utilizada na simulação numérica para obtenção das pseudo-funções
Não existe, durante o processo de geração destas pseudo-curvas, nenhum procedimento padrão sobre como selecionar as regiões da malha fina a serem simuladas, e algumas opções têm sido investigadas, A parte do reservatório a ser considerada pode coincidir com a célula da malha grossa, pode ser formada por um conjunto de blocos da malha grossa na direção vertical ou horizontal, pode englobar a célula da malha grossa e seus blocos vizinhos ou ainda considerar toda a malha grossa, mas com refinamento apenas na região do bloco para o qual se deseja construir as pseudo-curvas (Thibeau et al. (1995)).
Não é difícil imaginar a série de implicações decorrentes desta forma de obtenção das pseudo-curvas. Existem algumas propriedades inerentes a estas curvas, que as diferem sobremaneira das funções originais, as quais serão discutidas em detalhe no próximo item deste capítulo. Na seqüência, as equações envolvidas no cálculo das pseudo-funções dinâmicas serão apresentadas: as do método proposto por Kyte e Berry (1975), uma variação deste método, a formulação proposta por Stone (1991) e outros métodos baseados na mobilidade total dos fluidos. Finalmente, na Seção 3.8 serão apresentadas aplicações destes métodos. A bibliografia na qual se baseiam estas descrições são os artigos originais dos autores - Kyte e Berry(1975) e Stone (1991) - além de PSEUDO (1994) e Aziz (1994).
3.3	Propriedades das Pseudo-Funções
Embora exista pouca diferença entre formas e nomenclaturas envolvidas nas curvas de permeabilidade relativa e nas pseudo-curvas de permeabilidade relativa, a conceituação e propriedades de cada uma mostram a larga distância que as separam. É importante salientar as características de uma e de outra, para a perfeita compreensão do que ambas representam.
Na ausência do fenômeno da histerese, as curvas originais, tanto a permeabilidade relativa quanto de pressão capilar, são funções únicas das saturações das fases. Estas funções dependem apenas das propriedades da rocha reservatório, daí serem denominadas “funções de rocha” o que não ocorre com as pseudo-funções por serem dependentes de um grupo maior de variáveis.
A função primordial das curvas de permeabilidade relativa durante a simulação numérica de reservatórios é permitir a determinação da taxa de fluxo de cada fase que atravessa as fronteiras de cada bloco da malha de discretização. Estas funções relacionam a taxa de fluxo ao gradiente de pressão entre um bloco e seus blocos vizinhos, fornecendo uma saturação média para cada bloco da malha. Desta forma, para obter pseudo-curvas de permeabilidades relativas é necessário determinar a distribuição de saturação dentro de um bloco da malha, para um dado valor de saturação média. Em situações onde as forças viscosas assumem importância na descrição do escoamento dos fluidos, a distribuição de saturação passa a não ser mais determinada de forma única pela saturação média, dependendo também de outros parâmetros.
Enquanto as saturações das fases em cada bloco determinam de forma inequívoca sua permeabilidade relativa e pressão capilar, o mesmo não ocorre com as pseudo-curvas. Uma vez que estas funções, para um determinado bloco da malha grossa, foram geradas considerando uma distribuição de saturação, as quais por sua vez vão originar um conjunto de valores de permeabilidade relativa, não existe uma relação de caminho único entre um grupo e outro. Existem múltiplas combinações de valores de saturações que fornecem um
mesmo valor da pseudo-função. Por esta razão, cada pseudo-função está intrinsecamente associada ao bloco que lhe deu origem. Desta forma elas dependem:
a)	das condições iniciais do bloco: A dependência das condições iniciais pode ser explicada da seguinte forma. Se parte do reservatório, num fluxo bifásico água-óleo por exemplo, encontra-se inicialmente com saturações de água conata numa parte e outra parte com saturações iniciais maiores, haverá diferentes velocidades de saturações, perfeitamente definidas pela malha refinada. Ao se efetuar a mudança de escala, o valor da saturação equivalente, num determinado bloco da malha grossa, pode ser bastante diferente do valor obtido se este bloco tivesse sido inicializado com saturação de água conata. De uma forma geral, pode-se afirmar que as pseudo-funções funcionam bem em situações onde cada saturação se move a uma velocidade constante. Foi inclusive, baseado nesta hipótese, que Soedarmo et al, (1994) propuseram o uso de curvas características, nas quais se pudesse identificar pontos com velocidades constantes.
b)	da natureza do deslocamento: a utilização de pseudo-curvas derivadas de um tipo de deslocamento (água deslocando óleo, óleo deslocando água, solvente deslocando óleo e água, etc.) em uma situação diversa pode acarretar erros em grande escala como demonstrado por Hewett e Behrens (1990).
c)	das posições e vazões dos poços: as mesmas vazões e posições dos poços devem ser consideradas na região da malha fina e na malha grossa. Para cada simulação da malha grossa que incorpore mudanças, sejam nas vazões, sejam nas posições dos poços, novas pseudo-funções têm que ser geradas. Qualquer nova situação que altere as linhas de fluxos, segundo as quais as pseudo-funções foram geradas, contribui fortemente para aumentar sua não unicidade. Isto pode ocorrer, por exemplo, quando um poço é incluído ou excluído do modelo de simulação, ou até mesmo um simples fechamento de poço pode ocasionar tal efeito.
d)	da posição relativa dos blocos utilizados na obtenção das pseudo-funções dentro da malha fina: uma vez que cada região da malha fina possui um histórico diferente de
saturações, que é função de sua posição relativa aos poços, não é possível pelo menos em termos teóricos, utilizar pseudo-funções obtidas para um bloco particular da malha grossa em todos os outros blocos desta malha. Apesar desta observação, o procedimento mais apurado encontra limitações em termos práticos. A mudança de escala é aplicada justamente em situações onde a simulação da malha fina é impraticável. Ao mesmo tempo, para um problema que considera um número excessivo de blocos, é praticamente inviável calcular pseudo-funções para cada um destes blocos.
e) da presença das heterogeneidades: ao se agrupar um conjunto de blocos com permeabilidades absolutas diferentes, o problema recai nas técnicas de obtenção de permeabilidades equivalentes. A equivalência de meios não é uma questão trivial e constitui-se numa das principais fontes de erro dos processos de mudança de escala. Além disto, no caso das heterogeneidades presentes na malha fina contribuírem significativamente para a ocorrência de fluxo cruzado e/ou quando definirem sentido e direções preferenciais de fluxo é necessário considerar pseudo-curvas direcionais. Determinadas situações podem requerer inclusive um tratamento tensorial das permeabilidades das fases, como proposto por Pickup et al. (1994).
As características das pseudo-curvas que foram citadas anteriormente traduzem em dificuldades práticas que surgem durante os procedimentos de mudança de escala. Uma destas dificuldades é que nem sempre é possível associar uma pseudo-curva a cada bloco da malha grossa. É necessário agrupar vários blocos da malha grossa e associar apenas uma pseudo-função a cada grupo. Alguns métodos pressupõem a montagem e execução do modelo numérico na malha mais refinada como forma de geração das pseudo-curvas. Ocorre, no entanto, que estes modelos são, na maioria das vezes, impossíveis de serem tratados pelos recursos computacionais disponíveis. Além disto, a necessidade de reconstrução das pseudo-funções a cada alteração de locação ou inclusão de poços constitui uma relevante restrição prática.
permeabilidade relativa. Em todas as metodologias considera-se que a pressão capilar não será maior que a da malha fina, uma vez que a importância desta função diminui à medida que a escala aumenta. Verifica-se nestes casos que, quando há necessidade de efetuar mudança de escala através de pseudo-funções dinâmicas, as forças viscosas são no mínimo iguais às forças capilares, mesmo considerando a escala do bloco da malha. No entanto, nos casos em que a descrição das heterogeneidades ocorre em diferentes escalas - escala de laboratório, de litofáceis, de simulação numérica as forças capilares assumem importância nas escalas menores. Então quando tais escalas são consideradas, como demonstra Saad et al. (1995), há necessidade de efetuar um procedimento unificado, alterando tanto as curvas de permeabilidades relativas quanto as de pressão capilar.
3.4	Método de Kyte e Berry
As pseudo-funções dinâmicas que foram propostas por Kyte e Berry (1975) tiveram por objetivo aproximar o comportamento tridimensional de um reservatório para um correspondente problema bidimensional. Seu procedimento fundamenta-se num processo de transferência dos efeitos das variações verticais das propriedades do reservatório, das pressões dos fluidos e das saturações diretamente de uma seção transversal para um modelo no plano xy. Sua principal característica é basear-se nos fluxos individuais de cada fase durante os cálculos das pseudo-funções.
A construção das pseudo-funções para um determinado bloco é realizada efetuando-se uma simulação multifásica num modelo onde a malha fina é composta por um bloco e seu refinamento, além de alguns biocos que são acrescidos a montante e a jusante do fluxo para evitai' efeitos de bordas. As condições de contorno são injeção numa extremidade e produção na outra, segunda uma determinada direção, enquanto as demais fronteiras são consideradas seladas.
capilar é obtida a partir das pressões da malha grossa que, por sua vez. são estimadas em função das pressões nos blocos da malha fina.
3.4.1	Derivação das expressões
Nesta seção será descrita de que forma alguns parâmetros da malha grossa são obtidos. Todas as variáveis que recebem um traço superescrito representam as variáveis definidas para a malha grossa.
Seja um bloco I,J,K qualquer da malha de simulação, para o qual existem informações em n sub-blocos. A Hg. 3.2 apresenta um bloco genérico da malha grossa, seu bloco vizinho,	e o refinamento 3x3x2 em cada um deles, ou seja n=18. Também a malha
refinada segue uma numeração seqüencial segundo os índices minúsculos ij e k. Nesta descrição será considerado apenas fluxo na direção x.
Fig. 3.2 - Representação de dois blocos genéricos da malha grossa, refinados
O volume poroso do bloco da malha grossa é definido como a soma dos valores desta propriedade nos n sub-blocos, ou seja:
/=!
(3.1)
onde / é o índice do somatório dos sub-blocos em cada bloco LJ,K.
As saturações de cada fase são obtidas pela média ponderada das saturações desta fase em cada subloco, pelo volume poroso, isto é:
(3.2)
onde p significa as fases o, w ou g. De forma análoga, as densidades, viscosidades e profundidades dos blocos na malha grossa são obtidas, respectivamente, por
(3.3)
(3.4)
e
_ S(vAd),
A/&gt; =	’	(3.5)
onde pp e são a massa específica e a viscosidade da fase p, D é a profundidade do ponto central do bloco grosseiro e d a profundidade de cada sub-bloco que compõe o refinamento.
nbj'
— . \ f p	Jhhmí P ) .
ou, em termos de pseudo propriedades:
(3.6)
(3.7)
onde T são as transmissibilidades da malha grossa, obtidas através da média harmônica das transmissibilidades da malha fina, considerando apenas alguns blocos. Neste cálculo a média é efetuada sobre as transmissibilidades situadas em planos paralelos, localizados entre os pontos médios dos dois blocos, considerados na direção do fluxo. Desta forma, a transmissibilidade Tx entre os blocos IJ.K ena direção x , considerando a Fig. 3.2, será dada por:
(3.8)
A Eq. (3.7) pode ser rearranjada para calcular kip e toma a forma:
nbf
¿ÁU),
TAOp
(3.9)
onde a diferença de potencial da fase p é estimada por:
Pp.m. = Pp +pr&gt;g(D~d') ■
(3.11)
As pressões das fases em cada bloco grosseiro podem então ser obtidas por:
Pp„...)
(3*12)

Nesta expressão o somatório é tomado sobre um plano central, normal a direção do fluxo, e considera os nx sub-blocos sobre este plano. A expressão kr0Kh é uma função peso W e tem por objetivo refletir a contribuição de cada sub-bloco na direção segundo a qual o fluxo está sendo computado. A expressão geral para esta função peso assume a forma:
(3.13)
Na formulação de Kyte e Berry (1975), a pseudo pressão capilar é obtida como a diferença entre as pressões das fases no bloco grosseiro, ou seja:
Pelo fato de serem derivadas unicamente através de manipulações aritméticas e não estarem associadas a nenhum processo físico real, as pseudo-curvas podem apresentar algumas inconsistências. Uma delas é o aparecimento de valores negativos para as curvas de permeabilidade relativa. Tal fato pode ocorrer, por exemplo, numa situação onde o fluxo total de uma fase possui o mesmo sinal da diferença de potencial para esta mesma fase, ou seja:
(3.15)
Também no caso onde	for igual a zero, o valor da permeabilidade relativa, obtida
através da Eq. (3.9), tende a infinito. Tanto uma como outra situação pode ocorrer, e estes são exemplos de problemas que freqüentemente aparecem no método de Kyte e Berry (1975).
Com uma escolha apropriada dos blocos da interface usados na ponderação das pressões das fases, de tal forma que coincida com posições adequadas da malha grosseira, é possível reproduzir o efeito de redução de dispersão numérica que o tratamento de ponderação a montante, na consideração das permeabilidades relativas, produz nos simuladores Black-Oil.
3.4.2 Aplicações
Aplicações deste método podem ser encontradas em Guzman et aL (1996), cujo trabalho avaliou o desempenho de algumas pseudo-funções dinâmicas. Um dos resultados apresentados naquele trabalho mostra diferentes formas de consideração das funções de Kyte e Berry (1975) quando aplicadas a uma seção transversal modelada com uma malha grossa com 10x1x10 blocos, a partir de uma malha fina de 20x1x40 blocos. Neste exemplo foram utilizados diferentes conjuntos de curvas de pseudo-permeabilidades relativas para cada um dos 100 blocos da malha grossa. Na Fig. 3.3 são apresentadas, além da resposta da malha fina, algumas soluções obtidas com o módulo PSEUDO do ECLIPSE, quais sejam:
Solução /: Método de Kyte e Berry e mudança de escala das permeabilidades absolutas através de uma seqüência de médias aritméticas e harmônicas.
Solução 2: Igual ao caso anterior mas considerando pseudo-curvas de permeabilidades relativas direcionais (neste caso o número de pseudo-funções é 200).
Solução 3: Método de Kyte e Berry e mudança de escala das permeabilidades absolutas através da solução de fluxo monofásico em cada bloco da malha grossa.
Solução 4: Pseudo permeabilidades relativas direcionais com permeabilidade absoluta obtida através da solução de fluxo monofásico em cada bloco da malha grossa.
Solução 5: Curvas de permeabilidades relativas originais e permeabilidade absoluta obtida através da solução de fluxo monofásico.
Fig. 3.3 - Solução da malha fina e simulações usando 100 e 200 pseudo-curvas de permeabilidades relativas (Guzman et aL (1996))
A diferença no instante de irrupção de água é razoável em todos os métodos e é possível verificar a grande influência da forma de obtenção das permeabilidades absolutas equivalentes. A resposta mais próxima, Solução 5, aquela que reproduz ao menos em termos qualitativos a resposta da malha fina, foi obtida exatamente pelo procedimento que não utiliza as pseudo-funções. Uma observação em relação aos resultados obtidos é o grande número de pseudo-funções utilizadas: 100 e 200, no caso de pseudo-funções direcionais. O procedimento mais comum quando estes métodos são utilizados na prática é a aplicação de algum processo de média como forma de reduzir o número de curvas no modelo de
simulaçao. Obviamente os resultados podem ser ainda piores com tal redução do número de pseudo-curvas.
3.5	Método Ponderado pelo Volume Poroso
Este método é uma pequena alteração no método de Kyte e Berry (1975), onde a pressão média é obtida como uma média ponderada pelos volumes porosos para todos os blocos da malha grossa. Esta modificação melhora a formulação uma vez que faz com que as pseudo-pressões capilares sejam as mesmas para todas as direções de fluxo e zero se não existe pressões capilares. A única alteração portanto é na Eq. (3.12) que passa a ser representada por:
(3.16)
Os resultados apresentados a seguir ilustram uma aplicação deste método.
Neste trabalho foi elaborado um caso que representa um quarto de um esquema five-spot de injeção, com distribuição de permeabilidades tal que caracteriza canalizações direcionais entre o poço injetor e poço produtor, denominado caso THOR (ver descrição no Capítulo 7), Este exemplo representa uma seção plana modelada com uma malha fina de 12x12x1 blocos e a malha grossa com 4x4x1 blocos. Utilizando também o PSEUDO foi possível obter diferentes soluções para este caso, apresentadas em termos de produção de água no poço produtor na Fig. 3.4. As pseudo-curvas de permeabilidades relativas foram obtidas utilizando-se o método denominado Pore Volume Weighted Pseudos para gerar pseudo-curvas para os blocos e o método proposto por Emanuel e Cook (1974) para gerar as pseudo-curvas para os poços. A obtenção destas curvas foi feita através da simulação completa da malha fina.
Fig. 3.4 - Soluções para o caso THOR - malha fina e malha grossa com pseudo-funções de Kyte e Berry modificadas
Na Fig. 3.4 estão representados:
Solução A: Mudança de escala das permeabilidades absolutas através de uma seqüência de médias aritméticas e harmônicas e geração de 1 pseudo-curva de permeabilidade relativa para cada bloco e cada poço, num total de 18 curvas, com exclusão dos pontos que tornam a função não monotônica e valores maiores que I.
Solução B: Curvas de permeabilidades relativas originais e permeabilidades absolutas obtidas através do Método de Le Loc'h.
Solução C: Igual a solução A, mas sem exclusão de pontos das pseudo-curvas.
Solução D: Utilização de permeabilidades relativas direcionais, num total de 27 curvas, segundo o esquema da Fig. 3.5. Durante a geração das pseudo-curvas foi acrescida uma buffer-zone na direção y como forma de permitir melhores condições para o método gerar as pseudo-curvas para os blocos dos poços, uma vez que eles estão situados nas bordas da malha.
A
V
--------&gt;
X
										
Origina	,21-		-10.22				11.23	■			1	2.24 0	
										
• y c 	bfò	 Q	17-..		-7,-U			-S,-l-9-			9,20	
										
										
Origina	U3		.4,14			-50			6,16	
										
... -Origin : *	al—	- -l,Orig		mal.	...2,	Origi	ial-	.3,0	rigin	al...
Original										
										
ki\, krv
Fig. 3.5 - Caso THOR - Localização dos poços, da buffer-zone e distribuição das pseudo-curvas de permeabilidades relativas direcionais
Estes resultados mostram os efeitos da utilização das permeabilidades relativas direcionais e da inclusão de tabelas de permeabilidades relativas não monotonicamente crescentes e com valores maiores que 1. Ao obrigar o simulador ECLIPSE aceitar tais tipos de tabelas, melhora bastante a obtenção do instante de irrupção da água no poço produtor, mas ainda resulta numa diferença significativa na produção da água injetada. Um ajuste melhor só foi obtido ao considerar ao mesmo tempo as permeabilidades relativas direcionais e urna buffer-zone que permitisse ao método obter melhores pseudo-curvas na direção y.
Este caso mostra a grande variação que o método pode apresentar, pelo menos em algumas situações particulares, que são função de considerações que podem ou não ser feitas pelo usuário durante aplicações práticas, com o agravante que nos casos reais não existe a solução de referência da malha fina para balizar a qualidade das soluções obtidas.
3.6	Método de Stone
O modelo proposto por Stone (1991) utiliza a mobilidade total como forma de contornar alguns problemas associados à estimativa de pressão média que pode ocorrer no método de Kyte e Berry (1975), Neste método considera-se que o fluxo volumétrico que atravessa a interface da malha grossa é igual à soma dos fluxos dos sub-blocos que compõem esta interface. No caso da direção x e considerando um domínio tridimensional, esta igualdade pode ser expressa como:
.	V "1 ^""1 / X
j £
Os blocos considerados são os que possuem maior índice i no plano yz dos sub~blocos do bloco de menor índice I da malha grossa.
O fluxo volumétrico total é definido como o somatório dos íluxos totais, com a contribuição de todas as fases, ou seja:
j k
(3.18)
onde o índice t pressupõe somatórios sobre todas as fases, A partir desta definição define-se que os fluxos fracionários de cada fase que atravessam as conexões da malha grossa são obtidos através de:
J k
(3.19)
Desta forma é possível obter os fluxos fracionários da malha grossa em função dos resultados da simulação na malha fina. O fluxo fracionário da fase p, entre dois blocos da malha grossa, é obtido pela média ponderada dos fluxos fracionários desta fase pelos fluxos totais, ambos da malha fina. Esta equação traduz o fato de que, para que o fluxo de uma determinada fase numa conexão do bloco grosseiro seja igual a soma dos fluxos das conexões do bloco refinado, basta calcular a média ponderada dos fluxos totais pelas frações das fases no bloco fino.
A mobilidade total é obtida como uma média ponderada pelas transmissibilidades, isto
e:
(3.21)
Esta média considera todos os blocos finos situados na borda do bloco grosseiro. A partir da igualdade que se estabelece entre os termos de fluxo volumétrico, para cada fase, pode-se obter expressões do tipo:
(3.22)
para cada fase p. A substituição deÃí nesta expressão, mostra porque no método de Stone não é necessário calcular a diferença de potencial de forma explícita. O valor é calculado durante a simulação da malha grossa e pode ser considerado como uma média ponderada das diferenças de potencial, onde o peso é a transmissibilidade multiplicada pela mobilidade total.
kr„ = A./X
(3.23)
é utilizada para obter a pseudo permeabilidade relativa para o bloco.
Do mesmo modo que no método de Kyte e Berry (1975), as pseudo permeabilidades relativas calculadas pelo método de Stone (1991) podem apresentar valores negativos ou maiores que 1. Um valor negativo surge se o fluxo fracionário f for negativo, como pode ocorrer em fluxo contra a corrente de óleo e gás, devido à força da gravidade.
Guzman et al. (1996) mostrou através de exemplos que este método é inconsistente quando gravidade e pressão capilar são considerados. No entanto, para casos de vazões muito baixas com grande influência da gravidade, ele tem um desempenho superior ao método de Kyte e Berry (1975).
3.7	Outros Métodos Baseados na Mobilidade Total
Fayers e Hewett (1992) observaram que a forma de obtenção da mobilidade total do método de Stone (1991) despreza os efeitos das variações de permeabilidade e mobilidade total a montante do fluxo, além de incluir valores de permeabilidades absolutas a jusante. Estas características podem ser um fator limitante em problemas com grandes variações de heterogeneidades a montante do fluxo ou se as mobilidades a montante variam muito rapidamente, como ocorre em processos de deslocamento de gás. Neste caso a mobilidade poderia ser obtida através da solução da equação de Laplace:
(3.24)
Definiram então outra forma de consideração da mobilidade total, apresentando a seguinte expressão:
J k J
(3.25)
sendo obtida diretamente de parâmetros da solução da malha fina.
Os métodos de Stone (1991) e Hewett e Berhens (1991) podem ser considerados equivalentes em relação a capacidade de reproduzir os fluxos entre poços, para um determinado valor de potencial. Na região entre os poços, no entanto, o método Stone (1991) reproduz o pseudo potencial, enquanto Hewett e Berhens (1991) reproduz o potencial médio de fluxo. Nenhum destes métodos possui procedimentos próprios para tratar termos capilares e gravitacionais.
Beier (1992), ao realizar um estudo comparativo entre o uso de pseudo-funções e a técnica das linhas de fluxo, avaliou também formas de obtenção da mobilidade total. Beier (1992) refere-se de forma equivocada à Eq. (3.23) como sendo de Kyte e Berry (1975) e compara tal equação com
(3.26)
que é uma versão do método de Stone. Esta forma de cálculo de mobilidade total foi apresentada por Beier (1992), que considerou ponderação pelo fluxo na sua dedução. Utilizando um problema de deslocamento miscível em reservatórios carbonáticos, Beier (1992) concluiu que a Eq. (3.24) apresenta valores erráticos, enquanto a Eq. (3.23) produz mobilidades mais suaves e consegue reproduzir recuperações de óleo com razoável precisão, exceto para razões de mobilidade próximas a 0.1 ou menores.
Christie et al. (1995) apresentaram também uma definição para a mobilidade total, agora num procedimento que inclui os efeitos da gravidade. Na expressão
A,	= -V-	(3.27)
A
NÀ e K representam valores médios para a malha grossa, obtidos através da solução preliminar da equação de pressão monofásica, a equação de Laplace. Através da solução da equação quadrática
GÂib.” — {it{ + GÂf ^Áts. 4-	— 0,	(3.28)
que representa a solução exata da equação de Darcy para a malha grossa, na ausência de pressão capilar, obtém-se as raízes . Na Eq. (3.27) G representa:
G = *Xp»-P..)-	(3.29)
Os valores para o fluxo fracionário fw e para velocidade total de Darcy são obtidos através da simulação do bloco refinado. Com valores de e Âír as pseudo permeabilidades relativas são obtidas por:
C = AÂ
k'« = a,(7-V)
(3.30)
Embora este último método não garanta a reprodução dos resultados da malha fina e nem a obtenção de pseudo-curvas bem comportadas, monotônicas e com valores situados no intervalo [0,1], ele efetua menos simplificações que métodos como Kyte e Berry (1975) e Stone(1991).
3.8	Exemplos de Aplicações dos Métodos
Para ilustrar as propriedades destes métodos, Barker e Dupouy (1996) e Guzman et al. (1996) reproduziram o exemplo apresentado por Stone (1991) comparando seus resultados com outros métodos e também com a solução analítica. O problema consiste numa seção transversal com duas camadas não comunicantes, com o óleo sendo deslocado pela água, e a malha fina composta por 50x1x2 blocos. As curvas de permeabilidade relativas apresentadas na Fig. 3.6 representam a solução analítica (linha pontilhada) e a solução numérica (linha tracejada) para a região dos blocos (40,1,1) e (40,1,2) da malha fina.
Fig. 3.6 - Pseudo-curvas de permeabilidades relativas (Barker e Dupouy (1996))
Na Fig. 3.6 o método de mobilidade total apresentado refere-se ao proposto por Christie et al, (1995). As formas pouco usuais e valores presentes nestas curvas são situações bastante comuns de serem encontradas durante a utilização destes métodos e ilustram seu c ompo rtame n to.
Todos os métodos citados neste capítulo foram propostos para obter pseudo propriedades de fluxo numa única direção. No caso de meios heterogêneos anisotrópicos é necessário aplicar estes métodos em diferentes direções. Um exemplo é o caso particular de um meio poroso com laminações, onde as pseudo-funções diferem se durante sua geração o fluxo for aplicado a duas direções ortogonais diferentes. O que ocorre em alguns tipos de heterogeneidades é que seus efeitos não são capturados totalmente pela permeabilidade absoluta; as permeabilidades relativas têm seus pontos finais afetadas pelo óleo trapeado nas zonas de alta permeabilidade. Pickup e Sorbie (1994), que defendem a inclusão de tensores de permeabilidades como forma de capturar os efeitos de fluxo cruzado durante a etapa de mudança de escala, exemplificam tal situação através de uma seção com camadas inclinadas a 45°, onde são alternadas permeabilidades de 500 e 50 mD, o fluxo é incompressível e a redução de escala é feita de 82x1x80 para 12x1x10 blocos. Estes autores consideraram tensores de permeabilidade total de uma fase p como sendo:
k =
k.&gt;-
(3.31)
Na Fig. 3.7, além da malha fina e do método de Kyte e Berry (1975), são apresentadas soluções para diferentes tratamentos de tensores de permeabilidades. Para isto o código computacional foi desenvolvido de tal forma a considerar tensores de permeabilidades bifásicos. Com o objetivo de avaliar a importância dos termos fora da diagonal, as seguintes hipóteses foram analisadas:
♦	tensor completo: onde os termos kpvv e k/?vv são diferentes de 0;
•	tensor com os termos fora da diagonal obtidos como uma razão fixa dos termos diagonais da seguinte forma:
(3.32)
onde kxx, k^, kyx&gt; kyy representam permeabilidades absolutas direcionais,
♦ tensor considerando apenas os termos diagonais, isto é, os termos e kpvT são iguais a 0.
Apesar do melhor desempenho do tratamento que considera o tensor de permeabilidade com todos os termos, principalmente em relação à obtenção do instante de início da produção de água, é nítida a ausência de qualquer tratamento que apresente um bom ajuste com os resultados da malha fina, Neste exemplo, o método de Kyte e Berry (1975) considera pseudo-permeabilidades relativas direcionais.
Fig. 3.7 - Comparação de corte de água entre malha fina e modelos de mudança de escala (Pickup e Sorbie (1994))
Outro exemplo de aplicação do método de Kyte e Berry (1975) pode ser encontrado em Soedarmo et al. (1994) onde ele considera uma seção transversal com uma malha fma de 100x1x10 blocos. A malha grossa é composta por 50x1x1 blocos e foram utilizadas 50 pseudo-curvas de permeabilidades relativas durante mudança de escala. Este exemplo, que não considera os efeitos da gravidade e das forças capilares, constitui numa seção com 10
camadas não comunicantes, com deslocamento do óleo pela água, diferentes vazões de injeção em cada camada e uma razão de mobilidade igual a 20. Além disso, diferentes curvas de permeabilidades relativas foram consideradas nas camadas da malha fina.
Parte dos resultados apresentados por Soedarmo et. aL (1994) estão reproduzidos na Fig. 3.8. Este exemplo mostra uma recuperação final menor do que a obtida pela malha fina quando o método de Kyte e Berry (1975) é aplicado. A particularidade deste problema é que existem diferentes condições iniciais e grandes diferenças de pressões entre as camadas. Esta comparação evidencia a deficiência do método proposto por Kyte e Berry em tratar tais sistemas.
Fig, 3.8 - Comparação entre as soluções da malha fina e do método de Kyte e Berry (Soedarmo et aL (1994))
3.9	Considerações Finais
Através de análises da iteração entre regimes de fluxos e tipos de heterogeneidades, Kossack et aL (1989) mostrou que somente sob condições especiais pode-se dispensar a determinação de pseudo-funções durante a mudança de escala. Quando tal procedimento é indispensável, no entanto, é necessário conhecer as limitações inerentes aos métodos utilizados. De uma forma geral, verifica-se que mesmo aplicando as pseudo-funções
dinâmicas para as mesmas condições para as quais elas foram geradas, isto não garante uma resposta próxima à da malha fina, podendo inclusive, em alguns casos, as simulações com a malha grossa se situarem bem distantes daquela resposta. Situações com variações substanciais entre as respostas foram ilustradas neste capítulo, mostrando que a possibilidade de ocorrer erros, associada à incapacidade de prever quando estes erros irão ocorrer, torna o uso das pseudo funções pouco confiável.
Além das incertezas associadas ao uso das pseudo-curvas, a maioria dos métodos geram pseudo-funções que apresentam comportamento inconsistente com o processo físico que está sendo modelado: por exemplo, valores maiores do que 1 ou negativos e curvas de permeabilidades relativas não monotônicas. Isto impede a utilização direta destas curvas em simuladores numéricos tradicionais que não são capazes de tratar tal comportamento. Surge então outra limitação desta metodologia de mudança de escala: a necessidade de um processamento das pseudo-funções antes de sua inclusão nos simuladores numéricos. Este processamento inclui não só a eliminação das inconsistência citadas aqui, mas principalmente a redução do número de pseudo-curvas, o que por um lado toma mais tratável grandes problemas de mudança de escala, por outro colabora fortemente para diminuir a qualidade dos resultados.
É dentro deste contexto que está situada a proposta deste trabalho: uma metodologia na qual seja possível estabelecer um controle sobre a qualidade das soluções obtidas e que trata o procedimento de mudança de escala de forma implícita durante o processo de solução do problema em questão. A motivação principal para o desenvolvimento da simulação multiescala é estabelecer procedimentos confiáveis para efetuar a mudança de escala, usando apenas elementos da simulação numérica, sem a necessidade de gerar pseudo-funções. Tal desenvolvimento facilita muito a tarefa de mudança de escala, ao mesmo tempo que toma o processo mais robusto. Nesta proposta estão incluídas, de forma automática, algumas considerações que podem alterar significativamente a resposta do modelo reduzido, como exemplificado neste capítulo.
É importante salientar que, embora a forma de execução da mudança de escala tenha sido alterada neste desenvolvimento, o problema ainda continua sendo a obtenção de respostas aproximadas para um problema cuja solução numérica numa malha refinada é impraticável. Numa e noutra forma de abordar o problema, a solução da malha grossa continua representando apenas uma aproximação. As bases e as premissas da formulação desenvolvida são apresentadas no capítulo a seguir.
Capítulo 4
Modelo Multiescala
4.1	Introdução
Os capítulos anteriores forneceram uma visão geral da evolução da técnica de mudança de escala, do uso de pseudo-funções, suas propriedades e limitações. Este capítulo apresenta a principal contribuição desta tese - o procedimento multiescala. Este procedimento tem por objetivo estabelecer uma metodologia, e o correspondente modelo computacional, que permita realizar mudança de escala em problemas de fluxo multifásico em meios porosos sem o uso de pseudo-funções. Ao longo do capítulo serão apresentados o esquema geral, cada um dos processos envolvidos e. ao final, uma análise do desempenho da metodologia sob o ponto de vista de custo computacional.
4.2	Solução de uma Malha Refinada
A definição da malha de simulação em um problema de escoamento em reservatórios de petróleo é função de uma série de restrições relativas ao número de blocos a serem utilizados para a discretização do domínio do problema. Estas restrições vão desde aspectos práticos relacionados a localização atual e futura de poços produtores e injetores, presença de falhas e custo computacional, ate precisão requerida em algumas regiões ou em toda a extensão do reservatório.
Se durante a definição do modelo computacional estiver disponível a descrição geológica do reservatório, o ideal seria efetuar a simulação de fluxo na mesma escala desta descrição. No entanto, estas descrições são normalmente estabelecidas em malhas muito refinadas, tomando proibitiva a sua utilização diretamente na escala em que foram geradas. Para evitar a solução completa da malha fina, mas buscando maior precisão nos resultados, algumas opções podem ser consideradas. O refinamento local de apenas alguns blocos não é a alternativa mais adequada para obter unia resposta representativa da descrição das propriedades em todo o reservatório. A menos que exista uma concentração destas variações em regiões bem definidas, esta opção não é capaz de fornecer uma resposta com uma precisão razoavelmente próxima daquela da malha fina. Duas alternativas podem então ser consideradas:
/. Decomposição em subdomínios
Os conceitos de decomposição de domínios estão relacionados a uma ciasse de algoritmos que permitem a redução de um problema de grande dimensões numa série de problemas menores. Um exemplo de aplicação desta técnica na simulação numérica de reservatórios pode ser encontrada em Nacul (1991). onde, no entanto, só foi utilizada para solução de casos com refinamento local.
A técnica consiste basicamente na divisão de um domínio Q, contínuo e suave, numa série de subdomínios Q¡. Seja, por exemplo, o domínio do problema Q. representado na Fig. 4.1. formado por:
Í4 —
e os limites e interfaces destes domínios definidos por:
ímo. r, -an,, r2 = d&amp;amp;2
e
onde H são os limites externos e Tj as interfaces de cada subdomínio i. Em cada um destes subdomínios a solução deve satisfazer à equação diferencial proposta para o domínio inicial, acrescido da exigência de continuidade nas interfaces entre os subdomínios. Esta continuidade deve ser atendida pela solução, bem como pelas suas derivadas.
Fíg. 4.1 - Decomposição do domínio iniciai Í1 em dois subdomínios e Q2e as respectivas interfaces Ti e t2
Ao estabelecer estes novos domínios o problema inicial deve ser definido através de condições iniciais e de contorno apropriadas, em cada um deles. As condições de contorno nas interfaces r podem ser do tipo Dirichlet ou Neumann. A especificação de uma ou outra condição de contorno depende das informações disponíveis e segundo Nacul (1991). a eficiência numérica do método é muito sensível a esta escolha.
Para construir a solução completa do problema no domínio inicial. considerando a união da solução em cada um dos subdomínios. duas abordagens diferentes, que dependem no nível de iteração onde a técnica é implementada, são consideradas: decomposição a nível da matriz e decomposição a nível de reservatório. A principal vantagem da decomposição a nível de reservatório é a decomposição de domínios irregulares em domínios quase regulares.
Os pontos sensíveis da metodologia de decomposição em subdomínios são o tratamento das ligações geométricas entre subdomínios de diferentes refinamentos, a escolha das condições de contorno na interface r. artificialmente inserida no problema e principalmente a taxa de convergência das iterações entre os subdomínios. além da escolha do próprio critério de convergência. Quando o domínio é dividido em muitos subdomínios, o número de iterações necessárias para obter convergência entre os subdomínios pode ser excessivamente alto. Em função disto, Nacul (1991) testou também a eficiência de algumas técnicas de aceleração da taxa de convergência entre as quais relaxação, superposição parcial dos subdomínios e precondicionadores. Em resumo, esta alternativa permite obter uma solução com a mesma precisão da malha fina completa, mas a um alto custo computacional, por vezes até superior ao custo da solução da malha fina.
II,	Mudança de es cala u ti l i zando pse u d o -fu n ções
Esta alternativa consiste basicamente na mudança de escala das propriedades descritas, adotando-se uma escala de simulação menos refinada, na qual propriedades equivalentes e pseudo-funções substituem os dados originais. O processo de geração das pseudo-funções tem início com a simulação numérica de regiões da malha fina e o cálculo das pseudo-funções para cada uma destas regiões. Uma vez geradas funções para cada bloco da malha grossa, elas são. numa segunda etapa, incorporadas à malha de simulação. Apesar do baixo custo computacional associado à solução do problema na malha grossa, esta alternativa possui duas desvantagens evidentes: pré-processamento dispendioso e limitações das pseudo-funções.
A sequência de simulações a serem executadas pelo usuário na geração das pseudo-curvas constitui numa tarefa dispendiosa, principalmente se for considerado que os problemas a serem tratados com mudança de escala são necessariamente de grandes dimensões. Como o problema que esta sendo tratado aqui é como obter uma resposta que considere uma descrição geológica detalhada, não é possível considerar apenas algumas regiões do domínio como representativas para toda a malha, como forma de reduzir o trabalho de geração de pseudo-funções. Além disto, as pseudo-funções têm a grande desvantagem de estarem sempre associadas às condições dos blocos para as quais foram geradas, isto é. vazões dos poços, saturações iniciais, etc. Toda vez que alguma alteração é feita nestas condições, é necessária a reconstrução das pseudo-curvas. Este tipo de alteração é bastante comum, por exemplo, em projetos de desenvolvimento de campos e a geração de novas curvas para cada alteração no projeto é inviável em termos práticos.
Pelo que foi exposto no Capítulo 3, que trata das características das pseudo-funções, observa-se claramente a falta de generalidade e a inexistência de um processo de mudança de escala contínuo, que envolva apenas uma única etapa durante a simulação numérica de reservatórios. Numa aplicação prática, além das heterogeneidades, é necessário associar pseudo-funções para blocos com poços e sem poços e também aprimorar o tratamento dado a mudança de escala das permeabilidades absolutas, muitas vezes tratada por simples procedimentos algébricos. Atualmente, poucas versões comerciais de simuladores de reservatório incorporam algum tipo de tratamento de mudança de escala e, quando o fazem, isto ocorre através de pseudo-funções. O simulador comercial ECLIPSE possui um módulo, denominado PSEUDO, que permite a construção de pseudo-curvas para blocos através dos métodos apresentados no Capítulo 3 e também pseudo-funções multifásicas para poços pelo método proposto por Emanuel e Cook (1974). Por incorporar um método de construção de pseudo-funções bastante difundido, este módulo do simulador tem sido bastante utilizado na indústria do petróleo.
necessidade de reconstrução das curvas, esta alternativa fornece uma resposta aproximada, mas a um custo computacional bastante reduzido.
4.3	Objetivos e Características da Simulação Multiescala
O objetivo deste trabalho é desenvolver uní modelo computacional que permita realizar mudança de escala em problemas de fluxo multifásico em meios porosos, seni o uso de pseudo-funções multifásicas, e que seja executada em conjunto com a simulação numérica na malha grossa. O que se propõe com a simulação multiescala é obter soluções na malha grossa que incorporem informações de regiões da malha fina, mas resolvendo o problema apenas na malha de simulação menos refinada.
Na metodologia proposta neste trabalho, em nenhum instante são geradas pseudo-curvas, e as curvas originais de permeabilidade relativa são mantidas no modelo numérico de simulação. A principal motivação de evitar o uso direto das pseudo-curvas é a necessidade de sua reconstrução. Como a simulação multiescala unifica os processos de solução e mudança de escala, alterações no modelo numérico não levam à necessidade de preparação de novos dados de entrada, eliminando a tarefa de geração de novas pseudo-curvas.
Ao eliminar as pseudo-funções, alguns mecanismos têm que ser incorporados no modelo numérico, de forma que sejam realizados os ajustes antes executados por estas curvas nos procedimentos tradicionais de mudança de escala. Estes mecanismos estão representados por uma sequência de troca de informações entre a malha grossa e regiões da malha fina. Estas informações são responsáveis pelos ajustes que irão aumentar a precisão da resposta na malha grossa, uma vez que elas estão associadas à distribuição dos fluidos na malha mais refinada. A idéia central do modelo computacional multiescala é a utilização de duas malhas: a malha grossa de simulação e a malha fina de descrição das propriedades. Durante a evolução da simulação na escala mais grosseira, informações são transferidas entre as escalas de forma a estabelecer o ajuste necessário à correção do fluxo das fases através dos blocos da malha de simulação. Esta transferência ocorre tanto no sentido malha grossa-malha fina quanto no sentido inverso, de tal forma que exista um acoplamento entre as duas escalas.
Uma característica importante desta troca de informações é que ela dá ao processo de mudança de escala um caráter adaptativo, por ser executada a cada passo de tempo da simulação numérica. Além disso, todas estas tarefas são realizadas de forma implícita pelo código computacional, sem nenhuma interferência do usuário. Com tal metodologia é possível evitar o custo computacional da malha fma e contornar algumas das limitações das pseudo-funções.
Uma das premissas que norteia este trabalho é a busca de compatibilidade com os códigos computacionais existentes na área de simulação de reservatórios, os quais utilizam métodos e formulações consagrados, dentre os quais, o método das diferenças finitas e a linearização das equações através do método de Newton-Raphson. Foram portanto desenvolvidos procedimentos que pudessem ser implementados em simuladores já existentes, através do menor número possível de alterações. Para isto foi desenvolvido um simulador convencional, com estas características padrões, baseado na formulação Black-Oil. cuja modelagem numérica é apresentada no Capítulo 5 e a descrição encontra-se no Anexo L A partir deste simulador, denominado SCALE, foram implementados os procedimentos de mudança de escala.
Resumindo, esta proposta consiste numa alternativa de solução para uni problema definido numa malha refinada, que baseia-se em mudança de escala e que possui um custo computacional menor do que a técnica de decomposição de domínios. Se for considerado apenas o tempo de simulação, este desenvolvimento é mais oneroso do que as técnicas de mudança de escala que utilizam as pseudo-funções tradicionais, mas ao eliminar a necessidade de reconstrução das curvas, esta metodologia reduz bastante as tarefas a serem
executadas e. conseqüentemente. o tempo total despendido num trabalho de mudança de escala.
4.4	Esquema Geral do Modelo Computacional
Nesta seção será feita uma descrição geral do modelo computacional com ênfase nos procedimentos que devem ser estabelecidos para ajustar os fluxos das fases através das conexões dos blocos da malha grossa. A inovação proposta aqui é a utilização de parâmetros obtidos através da simulação numérica de fluxo, em algumas regiões refinadas preestabelecidas (onde são consideradas as propriedades físicas originais do meio), como forma de procurar uma equivalência entre a malha de simulação e uma malha mais fina. Desta forma estarão sempre presentes no modelo numérico de simulação mais de uma escala, daí a denominação multiescala. Estas escalas são:
Malha Fina: É a escala de descrição das propriedades, ilustrada na Fig, 4.2.a. Todos os dados deste nível são informados, mas em nenhum instante procura-se obter a solução completa neste nível. Inicialmente considera-se que o número de blocos desta malha seja tal que a simulação numérica considerando todos os blocos seja inviável do ponto de vista de capacidade computacional ou que o custo para obtenção da solução seja proibitivo.
Malha Grossa: É a escala de simulação, onde a solução do problema é obtida, que pode ser visualizada na Fig. 4.2.b. Apenas o número de blocos nas diferentes direções são informados ao simulador multiescala. Todos os valores necessários para inicialização da malha, referentes a geometria, conexões e parâmetros são derivados dos dados informados ao nível da malha fina.
entre a malha fina e a malha grossa. Como cada bloco deste sub domínio é exatamente um bloco da malha fina, suas propriedades são aquelas informadas para a malha fina.
a) Malha Fina
c) Subdomínios
Fig. 4.2 - Escalas envolvidas no processo multiescala
Embora esta proposta de solução utilize uma malha grossa e regiões refinadas associadas a cada bloco da malha grossa, existem diferenças substanciais entre esta forma de trabalho, refinamento local e decomposição de domínios. Enquanto no segundo, na maioria das técnicas de solução, o refinamento substitui o bloco da malha grossa e a solução é estabelecida na região refinada, no procedimento desenvolvido as duas escalas estão presentes numa mesma região e não se procura obter soluções precisas para os subdomínios.
mas apenas informações que sejam suficientes para o ajuste do fluxo das fases na malha grossa. A diferenciação com decomposição de domínios reside em não se procurar convergência entre subdomínios vizinhos, uma vez que. apesar da existência de interfaces comuns, aqui eles são tratados como unidades independentes.
De forma sequencial, são descritos a seguir, os principais procedimentos executados, num passo de tempo, pelo modelo computacional multiescala.
I	“ Inicialização da malha grossa
Compreende uma sequência de procedimentos que tem por objetivo agrupar blocos da malha fina em subdomínios. estabelecendo assim cada bloco da malha grossa. Uma vez geometricamente definida, a tarefa seguinte é efetuar a mudança de escala das permeabilidades absolutas e associar os demais parâmetros a cada bloco da malha grossa.
II	- Seleção dos subdomínios a serem considerados
A cada bloco da malha grossa está associado um subdomínio. e. à princípio, todos os subdomínios são considerados durante a solução da malha grossa. Neste trabalho, embora tenham sido investigados critérios de seleção de subdomínios de forma a solucionar apenas alguns subdomínios a cada passo de tempo, o procedimento padrão adotado considera todos os subdomínios.
III	- Solução de uma seqüência de problemas locais
Nesta etapa, que tem o objetivo de obter informações relativas ao fluxo das fases na malha fina, os subdomínios são resolvidos como um problema local definido por condições de contorno tipo Dirichlet e condições iniciais iguais às do passo de tempo anterior. As conexões dos subdomínios que coincidem com os limites externos da malha grossa assumem as condições de contorno especificadas para o problema, normalmente fluxo nulo.
IV	- Ajuste dos termos de fluxo entre blocos da malha grossa
O ajuste dos fluxos da malha grossa se dá por meio de alterações nas transmissibilidades das conexões entre os blocos dessa malha. Com a finalidade de ajustar estas transmissibilidades, nesta etapa são obtidos valores representativos para as saturações em cada subdomínio, baseando-se na distribuição de saturações obtida na etapa III.
V	- Ajuste dos termos fonte para a malha grossa
Consiste no ajuste de termos de índice de produtividade dos poços e das transmissibilidades das fases nas conexões bloco-poço, utilizando também as informações obtidas na etapa III.
VI	- Solução da malha grossa
Esta etapa corresponde à solução do problema de forma tradicional, para o passo de tempo especificado. sendo que diferentemente da forma usual, aqui os fluxos das fases são corrigidos de acordo com as transmissibilidades ajustadas nas etapas IV e V.
VII	- Distribuição dos fluxos das conexões da malha grossa entre as conexões dos subdomínios
Após o ajuste dos fluxos das fases nas conexões da malha grossa, estes fluxos são distribuídos entre as conexões externas dos subdomínios associados a cada bloco.
VIII	- Ajuste entre malha grossa e subdomínios
Os subdomínios são novamente resolvidos, mudando apenas as condições de contorno das conexões externas, consideradas agora tipo Neumann. utilizando-se os fluxos distribuídos na etapa VIL O objetivo desta etapa é atualizar a malha fina a partir dos resultados de fluxos da malha grossa, permitindo uma evolução coerente das duas escalas. Para obter tal efeito, os subdomínios são aqui reinicializados, ou seja, não é considerada a solução da etapa III; uma nova distribuição de saturações é encontrada em função da condição de contorno, estabelecida agora em termos de fluxos prescritos.
A Fig. 4.3 apresenta um fluxograma dos processos enumerados anteriormente. Neste esquema estão em destaque as etapas de simulação que foram introduzidas no processo convencional de simulação numérica de reservatórios e que representam, portanto, as modificações a serem inseridas num código computacional já existente.
Fig. 4.3 - Esquema do modelo computacional multiescala
4,5	Transferência de Informações entre as Escalas de Simulação
Inicialmente, no simulador multiescala. o problema é definido através de dados relativos às distribuições de porosidades e permeabilidades absolutas, tipos de rochas, curvas de permeabilidades relativas, de pressão capilar, dimensões, dados de fluidos, poços e condições de contorno. Esta etapa é idêntica em todos os procedimentos convencionais de simulação numérica de reservatórios. No caso do processo multiescala, deve ser informada também uma razão de agregação, a partir da qual será gerada a malha de simulação. Uma vez definidas as malhas fina e grossa e os subdomínios, a mudança de escala pode ser realizada de forma implícita pelo código computacional, através de uma seqüência de troca de informações. Esta seção aborda os mecanismos de transferência implementados.
A obtenção de soluções equivalentes entre diferentes malhas refere-se. neste trabalho, a descrições do escoamento tais que os fluxos das fases através das faces dos blocos de simulação e nos poços sejam semelhantes. No caso de mudança de escala, a solução na malha de simulação deve ter uma precisão semelhante a de uma malha mais refinada, sem no entanto obter a solução completa nesta malha fina. Para alcançar estes resultados, no tratamento multiescala, dois mecanismos de transferência de informações são considerados a cada passo de tempo:
/. Ajus re dos 1 e rmos de trun sn i iss i b i l i dueles nas con exõ es dos blocos da malha g rossu
O elemento chave desta formulação, ao não utilizar as pseudo-curvas de permeabilidades relativas, é tentar obter o mesmo efeito das pseudo-curvas, mas não necessariamente construindo uma pseudo-função. O comportamento das frentes de deslocamento depende das formas e da magnitude relativa dos lermos de fluxos presentes na formulação matemática do problema. Estes termos contêm as propriedades de transporte permeabilidade absoluta e permeabilidades relativas e é portanto por meio de ajustes destas propriedades que se obtém uma equivalência entre diferentes escalas.
O objetivo primário neste desenvolvimento é ajustar o fluxo dos fluidos através de interfaces i equivalentes em ambas as escalas, em função do tempo, ou seja:
¿■■i j malha. í?7'.-)wa z-i a J malha fina	s j-,
fluxo\,	~	.	(4,4)
Para realizar este ajuste é necessário determinar valores de transmissibilidades das fases entre os blocos da malha grossa que tenham a capacidade de reproduzir o fluxo destas fases nas conexões da malha fina.
A transmissibilidade de uma fase p é composta pelos termos:
TP =	&lt;4-5)
onde:
fo^ representa os termos que dependem de fatores geométricos, tais como dimensões e permeabilidade absoluta:
representa os termos que dependem da saturação da fase p; e
representa os termos que dependem da pressão.
Uma forma de ajuste possível poderia ser a utilização das transmissibilidades Tr diretamente de uma escala para outra. No entanto, os termos fr . diferentes em cada escala, deixariam de ser influenciados pelas variações dos valores das pressões na malha grossa. A opção de ajuste, assim como ocorre quando se utilizam as pseudo-funções, é realizada apenas através dos termos de que dependem da saturação da fase p, ou seja, permeabilidades relativas e pressão capilar. Neste ponto, estabelece-se a principal diferença entre a metodologia proposta neste trabalho e o uso das pseudo-curvas. Como os fluxos das fases entre os blocos da malha grossa são funções das distribuições das saturações e não apenas dos valores médios destas saturações, é mais efetivo avaliar estas distribuições e utilizá-las diretamente nos cálculos das transmissibilidades. Por esta razão, neste trabalho, optou-se por utilizar direlamente a variável primária saturação e não parâmetros derivados desta variável.
Desta forma, antes da solução da malha grossa, é necessário definir valores para as saturações das fases, S/? . conforme ilustrado na Fig. 4.5, tais que as transmissibilidades reproduzam, na malha grossa, o fluxo das fases da malha fina. Para obter tais valores, uma seqüência de problemas locais é resolvida nos subdomínios, para os quais são estabelecidas condições de contorno tipo Dirichlet. Este tratamento dado às condições de contorno justifica-se pela necessidade de se conhecer a distribuição das saturações nos subdomínios, sem passar para o nível fino a imprecisão dos fluxos da malha grossa.
F (Sw)

Pseudo-função
F '(S H- J
í
l
i
i
I
f
/
Função
Sw
Fig. 4.4 - Representação da obtenção do termo de ajuste de/sv sem o uso da pseudo-função
A necessidade de obter soluções nos domínios refinados fundamenta-se no fato de que. em simulação de reservatórios, as respostas em termos de pressões apresentam um comportamento mais suave do que as saturações, resultando daí a importância em descrever as frentes de saturação de forma mais precisa, uma vez que a descrição desta distribuição irá
definir a correção a ser feita nas equações definidas no nível mais grosseiro. Além disto, este tratamento refinado reduz a dispersão numérica.
(Sf , 5/ )
----&gt;
Fig. 4.5 - Representação da obtenção de S/ para as fases água e óleo
Um ponto importante que deve ser destacado em relação a estas saturações S/; é sua utilização restrita à obtenção dos termos dependentes das saturações durante o cálculo das transmissibilidades. A evolução das saturações na malha grossa é totalmente independente deste parâmetro, ou seja, em nenhum momento as saturações das fases nos blocos grosseiros são substituídas pelos valores de Sr . Este parâmetro é apenas um instrumento de ajuste das transmissibilidades das fases da malha grossa e não substitui a variável primária Sz&gt; na etapa de solução do problema. Além disso, uma vez que Sp tem aplicação restrita ao ajuste das transmissibilidades. que é obtida através de uma melhor representação da distribuição dos fluidos na malha grossa, este parâmetro assume diferentes valores para diferentes direções de fluxo.
II. Ajuste dos subdomínios de acordo com o fluxo das fases na malha grossa
Considerando que o mecanismo de ajuste dos termos de transmissibilidade seja efetivo na tarefa de ajustar o fluxo através das faces dos blocos da malha grossa, é necessário efetuar também um ajuste entre os subdomínios e a malha grossa. Esta etapa é necessária porque a resposta deste nível é utilizada como condição inicial para o passo de tempo seguinte e também porque a distribuição de saturações nos subdomínios tem que corresponder aos fluxos ajustados da malha grossa. Além disso, caso tal acerto não seja efetuado, as variáveis primárias em dois subdomínios adjacentes podem evoluir de forma tão distinta que passam a comprometer a obtenção de valores realistas para as saturações nos
subdomínios. num passo de tempo posterior. Para que tal correspondência entre as escalas seja alcançada, outra sequência de problemas locais é novamente resolvida, considerando agora condições de contorno tipo Neumann. Os valores prescritos em cada subdomínio são obtidos a partir de uma adequada distribuição dos fluxos ajustados nos blocos grosseiros correspondentes, conforme ilustrado na Fig. 4.6, Este acerto produz um ajuste na distribuição das pressões e saturações e possui um custo computacional bastante reduzido quando comparado com a busca de convergência entre subdomínios no método de decomposição de domínios. Por outro lado, este procedimento não garante aos subdomínios a obtenção de soluções precisas, mas apenas aproximadas.
Ao utilizar estes dois mecanismos de ajuste, observa-se que a solução do problema evolui de forma aproximada no nível fino, com a solução do problema descrito apenas na malha grossa e que existe troca de informações entre as duas escalas durante todo o tempo.
Fig. 4.6 - Distribuição dos fluxos ao longo das faces externas dos subdomínios
4.6	Tratamento dos Subdomínios no Simulador Multiescala
No início deste capítulo foram apresentados os conceitos tradicionais associados ao método de decomposição de domínios, O modelo computacional multiescala também utiliza o conceito de subdomínios, mas sua definição e tratamento no simulador multiescala difere daquele da técnica de decomposição de domínios. Nesta seção será feita uma breve diferenciação entre estes dois tratamentos.
malha Gk , tal que u GÁ= G\ conforme ilustrado na Fig. 4.7. Desta forma, os subdomínios constituem partes complementares do dominio inicial.
No procedimento mu Riese ala cada subdo minio é definido como G = b~ . com contorno dGh e blocos b/! I u b/? = Gh. A Fig. 4.8 representa um bloco i,j da malha grossa. O subdomínio neste procedimento coincide com cada bloco selecionado da malha grossa, e seu refinamento é função do grau de mudança de escala que esteja sendo efetuada. O tratamento das condições de contomo é feito da mesma forma que na técnica de decomposição de domínios, e, por isto, todas as dificuldades reportadas no trabalho de Nacul (1991) são extensivas ao problema tratado neste trabalho.
Malha composta G" em Q
Subdomínio&amp;lt;7i com malha (.7 Subdomínio O2 com malha G'
Fig. 4.7 - Subdomínios segundo a técnica de decomposição de domínios
Ou seja, enquanto na abordagem da decomposição de domínios cada subdomínio é considerado uma parte que foi desmembrada do domínio Q inicial, no procedimento multiescala cada subdomínio é tratado como um refinamento de uma determinada parte do domínio, mas existindo os dois modelos associados a esta região do domínio: o modelo grosseiro e o modelo refinado. A principal diferença entre estes dois esquemas é que no procedimento multiescala não se busca a convergência entre os subdomínios, isto é. não se
Malha Composta G" cm
Subdomínío C? relativo ao bloco bH i,j
Fig, 4.8 - Subdomínios segundo o procedimento multiescala
4.7	Custo Computacional
O custo computacional do modelo multiescala pode ser analisado do ponto de vista teórico calculando-se o número de operações executadas por iteração durante a solução do sistema linear de equações, usando um método do tipo gradiente conjugado. De acordo com Bittencourt (1996). este método requer M2m+4) operações por iteração, onde /V é o número de incógnitas e ni o número médio de elementos por linha na matriz esparsa. Como no caso de problemas de grandes dimensões a etapa de solução do sistema de equações representa a quase totalidade de esforço despendido na solução, o cálculo do esforço relativo a esta etapa é representativo na avaliação do custo computacional requerido. Uma comparação entre o procedimento multiescala e a solução completa da malha fina permite avaliar de forma relativa os custos computacionais envolvidos.
Seja unia malha fina, num problema bidimensional, com / x j blocos, onde j é a menor dimensão. Para esta situação, o número de equações para problemas bifásicos é 2ij e a largura de banda da matriz 2/. Neste caso o número de operações (NO), por iteração, será:
NOGl. - 8ij(j +1)	(4.6)
No procedimento multiescala. a malha grossa é definida através dos parâmetros krej\ e krejN gerando subdomínios com número de blocos igual a krefx x krefx. Desta forma, a malha grossa terá / x ./ blocos onde l=i/krefx e J=j/kref\. Considerando que neste procedimento, a cada passo de tempo, a malha grossa é resolvida 1 vez e cada subdomínio 2 vezes, tem-se. para o caso onde todos os subdomínios são resolvidos, o seguinte número de operações por iteração:
= 877(7 + 1) + 2/J(8A7z£&amp;lt;&amp;amp;efv + 1))	(4.7)
A Fig. 4.9 apresenta a razão entre o número de operações executadas durante a solução de um determinado problema pelo procedimento SCALE e pela simulação convencional numa malha fina. (NO^/NO^-k para 4 diferentes dimensões de malha fina (144. 400, 3600 e 10000 blocos). Esta razão é apresentada como função da dimensão /?.. de subdomínios ux/z, considerados na solução pelo SCALE.
Algumas observações são relevantes ao se fazer este tipo de comparação. Primeiro, a qualidade da solução obtida pelos dois métodos de solução é diferente, conforme apresentado nos exemplos testados com a metodologia multiescala e apresentados no Capítulo 7. Em qualquer situação, o processo multiescala apresenta uma aproximação para a solução numérica ótima para o problema, considerada como sendo aquela obtida utilizando-se a malha fina. Segundo, os custos computacionais envolvidos no processo multiescala. além daqueles despendidos na solução do sistema linear' de equações, são proporcionalmente maiores do que na forma tradicional de simulação, envolvendo apenas a malha de simulação. Estes custos extras são devidos aos processos de geração de malhas, seleção de subdomínios e troca de informações entre escalas, processos estes não existentes quando se resolve a malha fina de forma completa.
Fig. 4.9 - Comparação do número de operações entre solução do procedimento mutiescala e solução da malha fina, considerando solução do sistema linear por método iterativo
Apesar destas restrições a esta forma de comparação, pode-se observar claramente que o procedimento é atrativo do ponto de vista do custo computacional. A Fig. 4,9 mostra que soluções obtidas pelo SCALE que considerem um determinado range de discretizações dos subdomínios toma este custo muito menor do que o da solução deste mesmo problema com a malha refinada. Observa-se, para unia mesma malha fina, que a partir de uma certa dimensão n. à medida que a discretização dos subdomínios cresce, diminui o número de blocos a ser considerado na malha grossa, isto é, maior é a redução de escala, e os custos computacionais aumentam. Existe portanto, para cada malha fina, uma redução de escala ótima em termos de custos computacionais e a tendência mostrada, para as malhas consideradas na Fig. 4.9. é que o intervalo ótimo de dimensões de subdomínios está situado entre 2 e 4.
Outros fatores não considerados nesta avaliação de custo computacional são a aplicação de técnicas de computação paralela e a seleção dinâmica de subdomínios. claramente aplicáveis a este modelo. Nas duas etapas de solução dos subdomínios. evidencia-se a oportunidade de utilização de computação paralela ao invés de seqüencial. uma vez que as condições de contorno não dependem de parâmetros obtidos no passo de tempo em questão, Outro fator que facilita a paralelização da solução dos subdomínios é o fato de não se buscar a convergência entre eles, o que caracteriza tarefas realmente independentes. O que deve-se analisar, no entanto, é o fato de que a existência de tamanhos ótimos de subdomínios. de pequenas dimensões, pode não compensar o tempo de trânsito das informações entre diferentes unidades de processamento.
Também a consideração de uma seleção dinâmica dos subdomínios a serem resolvidos a cada passo de tempo, constitui um fator de otimização do código computacional. Diversas situações de fluxo podem levar a não necessidade de resolver todos os subdomínios a cada passo de tempo. Critérios de seleção devem ser investigados com o objetivo de otimizar o binômio qualidade da solução versus tempo de resposta.
Capítulo 5
Modelagem do Escoamento em Meios Porosos
5.1	Introdução
Neste capítulo serão descritos os modelos matemático e numérico utilizados no simulador Black-Oil desenvolvido neste trabalho, a partir do qual foi implementado o procedimento multiescala. As equações para fluxo isotérmico são obtidas pela combinação das equações de conservação, aplicadas a um volume de controle, com a lei de Darcy. A estas equações são acrescidas outras relações empíricas como as relações PVT e as relações constitutivas. O problema, quando associado a condições iniciais e de contorno adequadas, encontra-se posto de forma matemática. Esta descrição contínua do reservatório é então expressa de forma discreta para permitir a solução de problemas mais gerais, como os modelos multidimensionais e multifásicos. O sistema de equações derivados da discretização pode ser resolvido por técnicas numéricas aproximadas para obter a descrição do comportamento do reservatório para um conjunto especificado de condições de operação. Estas etapas finais constituem os modelos matemático e computacional construídos para obter a solução aproximada para o modelo matemático.
5.2	Modelo Matemático
diferenciais parciais não-lineares que são obtidas pela aplicação do princípio físico das leis de conservação de massa e algumas relações empíricas.
A princípio, dadas as equações diferenciais, aplicadas a cada componente e a cada fase, mais as relações constitutivas e condições de contorno, um sistema matemático pode ser formulado para qualquer fluxo no meio. No entanto, é preciso definir a representação da menor geometria microscópica associada a estas equações. Passa a ser válido então a definição do contínuo para uma escala macroscópica, tal que um ponto dentro do meio poroso esteja associado a um volume elementar representativo (Representative Elementary Volume - REV). Este volume pode ser definido como grande quando comparado com as dimensões dos poros, mas pequeno quando comparado com as dimensões do meio poroso. O REV é definido como um volume abaixo do qual as flutuações de qualquer propriedade primária são consideradas representativas (Lake (1989)).
5.2.1	Equações de fluxo na forma diferencial
Na derivação das expressões a seguir será considerado um sistema com nc componentes, np fases, ausência de reações químicas, dispersão e difusão desprezíveis. Seja um volume de controle arbitrário V, maior ou igual ao REV, mas menor ou igual as dimensões do meio poroso macroscópico. A este volume V está associada uma área A, conforme ilustrado na Fig. 5.1.
O balanço de massa aplicado a um componente c do fluxo que atravessa este volume é dado por:
Fig. 5.1 - Volume arbitrário no domínio do fluxo
A primeira parcela do lado esquerdo da Eq. (5.1) representa a vazão mássica de fluxo do componente c que atravessa a superfície A . num sentido de fluxo oposto a direção do vetor normal unitário, definido pelo cosseno diretor unitário n-cosai +sena j . A segunda parcela representa a razão de injeção de massa do componente c no volume de controle V. Este segundo termo é considerado positivo se a variação de massa é decorrente de uma fonte pontual e negativo no caso de sumidouros, ou seja, positivo para produção e negativo para injeção. O termo do lado direito da Eq. (5.1) representa a variação da massa total do componente c no volume de controle V, ou seja a acumulação do componente c em todas as fases do sistema.
Para um volume de controle estacionário, isto é, um volume invariante no tempo /, a integral do termo do lado direito da Eq. (5.1) pode ser expressa como:
(5.2)
Aplicando o teorema da divergência ao primeiro termo do lado esquerdo da Eq. (5,1) obtém-se:
p=l	p^i
A relação entre a velocidade superficial da fase p e o gradiente de potencial é obtida através da generalização da lei de Darcy:
Kãf, _
V, =--------VO	(5.4)
onde:
VOp = Vpr, + ppgVD.	(55)
Nas expressões anteriores kq) é a permeabilidade relativa, y,p a viscosidade, d&gt;p o potencial, p. a pressão, g a aceleração da gravidade, D a profundidade e Ké o tensor diagonal de permeabilidades absolutas do meio poroso, na forma:
I

__
onde os termos diagonais representam permeabilidades absolutas definidas segundo o eixo principal do sistema de coordenadas estabelecido para o problema.
Substituindo as Eqs. (5.2) e (5.3) em (5.1) tem-se:
ou
(5.7)
Como a expressão (5.8) é válida para qualquer volume de controle V, então os termos entre colchetes devem ser idênticos a zero, isto é:
= (5-9)
que é a forma diferencial para a equação de conservação para cada componente, aplicável a qualquer ponto dentro do meio poroso.
Apesar do desenvolvimento aqui apresentado, a forma discretizada da equação de conservação será obtida diretamente a partir da Eq. (5.1). A equação de balanço de massa apresentada sob a forma diferencial, Eq. (5.9), no entanto têm diversas aplicações, como por exemplo, na análise de erros de truncamento (Palagi (1992)),
Substituindo a Eq. (5.4) na Eq. (5.9) é possível obter:
ftp (	LLr	A n.,	□
S V ■ Xpp Pp	+ Pp^D) j - ¿X Pp ~q¡&gt; -	Pp SpP) = 0,	(5.10)
para cada componente c=l,2,....nc.
5.2.2	Relações auxiliares
O modelo Black-Oil generalizado considera três fases: a fase do hidrocarboneto líquido, denominada o, a fase do hidrocarboneto gasoso, denominada g e a fase aquosa, denominada nv Apenas três pseudo-componentes são considerados: óleo (õ), água (w) e gás (g). Neste trabalho só são consideradas as fases o e h:, os componentes õ e w e as considerações de fluxo isotérmico e que o óleo e a água são imiscíveis e não trocam massa.
2np+nc(np~l) relações devem ser estabelecidas para a completa descrição do problema. As relações auxiliares a serem consideradas são:
•	uma equação de restrição para as saturações;
♦	n/; equações de restrição para as frações mássicas;
♦	np-\ equações de capilaridade;
*	) equações de equilíbrio de fases.
Inicialmente uma restrição em termos de fluidos que ocupam os espaços porosos pode ser imposta através da relação:
IX	=1.	(5-11)
Outra restrição relativa ao balanço das massas dos componentes em cada fase é expressa por:
A.» ““A	(5.12)
i ?—&amp;lt;7
para cada fase p.
As relações empíricas envolvendo pressões capilares são definidas por:
P&lt;,,„ = P.. - P.	(5.13)
onde a pressão capilar pi: é função conhecida da saturação de água, isto é:
Av»-	.	(5.14)
As equações de equilíbrio de fases na formulação Black-Oil podem ser substituídas por relações envolvendo propriedades das fases como densidades das fases, fator volume de formação, solubilidade e frações mássicas (Aziz (1994)). Estas propriedades são baseadas em volumes medidos em condições padrão, que são mais fáceis de obter do que concentrações em condições de laboratórios ou de campo (Palagi (1992)).
A densidade da fase p é a razão entre a massa de todos os componentes nesta fase e o volume que esta fase ocupa em condições especificadas em termos de pressão, p, e temperatura, T. De outra forma.
(5.15)
v p
que pode ser expressa em termos de outras propriedades Black~Oil como
Pp =	’	(5-16)
onde p/é a densidade do componente c nas condições padrão, Ríp a solubilidade do componente c na fase p, a uma dada condição especificada.
O fator volume de formação de uma fase p (Bp) é definido por:
(5.17)
onde Vp é o volume da fase p. a pressão e temperatura especificadas, enquanto V- é o volume, em condições padrão, do componente p dissolvido na fase p a mesma pressão e temperatura.
A solubilidade do componente c na fase p. (Rcp) é definido como a razão entre o volume deste componente na fase p, em condições normais, e o volume do componente associado com a fase p, também nas condições normais, ou seja.
mep / P/
nllJPPBP p~
(5.18)
= 1
= c -0-
(5.19)
(5.20)
As frações mássicas de um componente c, na fase p, podem ser expressas também em termos de propriedades Black-Oil:
(5.21)
que é outra forma de apresentação da relação final definida pela Eq. (5.20).
Finalmente, as viscosidades das fases (/p,) são obtidas através de dados PVT e são funções da pressão da fase:
Pp = PP(PP)
As últimas relações constitutivas a serem consideradas são as relações entre as permeabilidades relativas e as saturações das fases, consideradas funções monotônicas. Num sistema bifásico óleo-água, onde a água é considerada preferencialmente como a fase molhante, estas relações são estabelecidas como:

(5.23)
(5.24)
Uma vez estabelecido o sistema de 2np + nc.np equações e incógnitas os próximos passos são estabelecer as condições iniciais e de contorno e, através de algum procedimento numérico, efetuar a discretização do sistema de equações.
5.3	Condições de Contorno
•	Condição de Contorno Tipo Dirichlet
Esta condição de contorno é definida matematicamente como condição do primeiro tipo, no qual o valor especificado no contorno é o valor da incógnita. Em simulação de reservatórios, ela ocorre quando a pressão ou potencial de fluxo é especificado nos limites externos do domínio onde as equações diferenciais foram aplicadas ou face das formações, no caso de poços, ou seja:
pp(x,y,t) = fl(t)	5)
para p=l,2,...,/ip.
•	Condição de Contorno Tipo Neumann
Esta condição de contorno é definida matematicamente como condição do segundo tipo, e neste caso o valor especificado no contorno é a derivada da incógnita. Para o caso das equações da pressão, esta condição expressa fluxos especificado através do contorno e pode ser usada para especificar produção, influxo conhecido (de um aqüífero, por exemplo) ou fluxo de uma parte do reservatório situado fora do domínio simulado. A forma geral para esta condição é:
Ç;.ã) = f:(7)	(5.26)
p=\
para c=L2....,/ic.
A forma do tratamento de condições de contorno esta associada ao tipo de construção de malha adotada no processo de discretização, ou seja, se bloco centrado, bloco distribuído, ponto distribuído, Voronoi, etc.
5.4	Modelo Numérico
A substituição da Eq. (5.4) em (5.1) fornece a equação integral para o fluxo multifásico de cada componente c do sistema, através do volume representativo V:
(5.27)
A forma discretizada da Eq. (5.27) pode ser obtida pela aproximação por diferenças finitas. Com este tratamento o que se pretende é encontrar valores aproximados para a solução em um conjunto de pontos discretos no interior do domínio. Cada um deles é denominado ponto da malha, e a equação integral é substituída por um conjunto de equações algébricas que relacionam as incógnitas a cada um dos pontos da malha. O processo de discretização acarreta necessariamente em erro de truncamento ou erro de discretização local, pelo fato de se desprezar alguns termos na passagem entre o nível contínuo e o nível discreto, durante a expansão das funções por Séries de Taylor. Uma discussão mais detalhada sobre técnicas de discretização e erros de truncamento pode ser encontrada em Aziz (1994), Aziz e Settari (1979) e Peaceman (1977).
As aproximações de cada termo da Eq. (5.27) apresentados a seguir consideram apenas o caso particular de uma malha cartesiana, bidimensional, e a construção desta malha segundo a técnica de bloco centrado. Estas foram as opções implementadas no simulador construído neste trabalho. No caso de outras geometrias ou sistemas de coordenadas diferentes, informações mais detalhadas podem ser encontradas em Nacul (1991) e Palagi (1992).
5.4.1	Discretização das equações
5.4.1.1	Discretização dos termos de acumulação
O termo de acumulação, lado direito da Eq. (5.27), pode ser aproximado, para um bloco genérico i,j de volume z, num intervalo de tempo Ar, por:
(5.28)
Na expressão (5.28) o operador At representa a variação do operando no intervalo de tempo Ar, dado por:
(5.29)
onde o sobrescrito n representa o nível de tempo. Desta forma, o termo de acumulação é avaliado no início e no final do intervalo de tempo, ou seja:
		(	x"
pP sp	-	Pp SP
V ?=1	J		k	J
(5.30)
5.4.1.2	Discretização dos termos de fluxo
A aproximação dos termos de fluxo, primeira parcela do lado esquerdo da Eq. (5.27), por diferenças finitas, é representada por:
V/ .
/=1
(5.31)
onde l representa cada uma das nconex conexões da área A, num sistema bidimensional, e Fcj são os fluxos de massa do componente c que atravessam cada conexão L A consideração de conexões de forma direta e não de interfaces entre blocos, como considerado neste trabalho, seguindo a proposta de Lim. Schiozer e Aziz (1995), proporciona uma maior simplicidade na montagem do sistema de equações. Este tratamento utiliza vetores de conectividade para gerenciar as transferências entre blocos, sendo particularmente útil em problemas onde os
88 blocos da malha possuem um número de conexões arbitrário, como ocorre em refinamento localizado.
O gradiente do potencial da fase p na Eq. (5.31), no sistema de coordenadas Cartesianas, é definido por:
V0&gt;
p
-*l&gt;
3	3. J ’
âx	cy
(5.32)
assumindo a seguinte expressão, quando colocado em termos de diferenças finitas:
AO/? = Ap/; + ppgAD
Considerando que na direção x, n - i , o fluxo de massa do componente nesta direção, através de uma conexão arbitrária l=i+1/2, é:
(5.34)
ou
p=l
para c-l,2,...,nt e onde Kx é a permeabilidade absoluta na direção x e os elementos geométricos estão definidos na Fig. 5.2. Desta forma, é possível explicitar o coeficiente de transmissibilidade na direção x. para urna determinada fase p como sendo:
(5.36)
onde:
A
01/2
(5.37)
sendo Á/+i/2 a área da seção transversal normal a direção x, na interface z+1/2 do bloco ij.
Fig. 5.2 - Ponto genérico da malha e as locações dos pontos num sistema de coordenadas Cartesianas
Para o caso bidimensional o mesmo procedimento é aplicado na direção y. obtendo equações equivalentes para esta direção.
5.4,1,3	Discretizaçâo dos termos fonte
Da mesma forma que os fluxos entre os blocos, o termo fonte da Eq. (5.27), segundo termo do lado esquerdo, pode ser aproximado por:
, ftF	W
““ Jv xcp Pp dV — — pp q p , p-\	p-i
(5.38)
Darcy pode ser aplicada ao fluxo das fases na face da formação, numa determinada direção i, pode-se expressar o fluxo volumétrico da fase p, qp , como sendo:
Tratando os termos do somatório da Eq. (5.38) de forma similar a que foi feita para os fluxos entre os blocos, tem-se:
y Pwfp} ’
(5.40)
onde TWcpi.j é o coeficiente de transmissibilidade da conexão entre o poço e o bloco i,j da malha e pwíp a pressão da fase p no fundo do poço. TWcpij é dada por:
(5.41)
onde WI íj é o índice do poço para a conexão entre o poço e o bloco ij, que no caso do sistema de coordenadas Cartesianas assume a seguinte expressão:
Wíi
2nKAz
(5.42)
(	r	&gt;
| in^ + 5 I k C	)
Nesta expressão K -	, rw é o raio do poço, 5 a razão de dano adimensional do
poço e ro é denominado raio equivalente por expressar a posição radial na qual a pressão de fluxo é igual a pressão do bloco i,j, Este conceito de raio equivalente foi apresentado por Peaceman (1978) e diferentes expressões são definidas para diferentes geometrias, as quais podem ser encontradas em Abou-Kassem e Aziz (1985), Babu et al. (1991). Uma extensa discussão sobre tratamento de poços pode ser encontrada em Palagi (1992), onde são propostos um modelo analítico simplificado para reservatórios homogêneos e heterogêneos.
além de modelos exatos para malha tipo Voronoi. Neste trabalho foi adotada expressão proposta em Peaceman (1983) para meios anisotrópicos, qual seja:
|N	Ar2 +			Av’
				
(543)
5.4.L4 Equações em termos de diferenças finitas
Substituindo as Eqs. (5.30), (5.31) e (5.38), em (5.27) a aproximação de diferenças finitas para a equação de fluxo tem a seguinte forma final:
¿(aT^A®,,). =Xfo Ppqp\ ,	P,’ S.~	’	&lt;5-44&gt;
p=l	’J	( p=l.	J ;
v	z l-.J
onde:
(AT Ad&gt; )	= T . ÍaO . . - AO ) + 7' iJ.Ad&gt; ... - AO ),	(5,45)
\ CP P ,// j cpx-í/2\ pi-l	pi f tpa+Í/2 y	H	pi f ’
representa a diferença entre os fluxos que atravessaram o bloeo genérico i,j através das faces /-1/2 e Z+I/2.
A formulação Black-Oil é obtida substituindo-se o produto x(:ppf)_ obtido na Eq. (5.21), na Eq. (5.44), ou seja:
(5.46)
onde os coeficientes de transmissibilidade também sofrem alteração, passando a ser expressos por:
(5.47)
5.4.2	Solução do sistema de equações não lineares
5.4.2.1	Linearização do sistema de equações
O sistema de equações é formado pelo conjunto de expressões obtidas ao se escrever a Eq. (5.44), para cada bloco da malha de discretização. Para o caso particular onde apenas os componentes óleo e água estão presentes no modelo, as formas residuais para cada bloco i.j são dadas por:
•	Componente óleo (&lt;r):
W = (AT-,A0(, + Á7i„.A4&gt;, +	1 ( -
P„ q„ + x,7„ p„&amp;lt;/„. + xSep.qX -	(5.48)
\ ... .. /¡^
-X - X) + pA +	PA)],.. = o
•	Componente águaivr):
/v . - (.A'Ç AO. + A7‘, AO + A/;7 A&lt;b .)	-
(x*„ P„&amp;lt;?„ + Xr* P.&amp;lt;?„ + x„ p, q,). , -	(5.49)
\olx. p„ (1 - S„. - S„) +	p„5„. + p, 5,)} . = 0
Além do sistema de equações descrito acima, outras equações são adicionadas para considerar o tratamento de poços. Neste trabalho, estão sendo consideradas apenas as variáveis no fundo dos poços e dos blocos do reservatório, não incluindo a queda de pressão devido a fluxo multifásico dentro dos poços e as variáveis na superfície. As equações adicionais se referem então apenas as restrições impostas ao poço na face da formação, ou seja, pressões de fundo ou vazões especificadas.
No primeiro caso, onde a pressão de fundo é especificada. pwfp = pwfp , a uma determinada profundidade, o fluxo de cada fase p pode ser calculado diretamente através da Eq. (5.39), nas situações consideradas neste trabalho que tratam apenas fluxo bidimensional e poço completado apenas em um bloco. No segundo caso, quando a vazão é especificada, é necessário então introduzir uma equação extra ao sistema expresso pela Eq. (5.44) que considere o somatório dos componentes c, em todas as fases especificadas. A equação residual para o poço tem a seguinte forma:
zíí? np
C=í P=l
p/
(5.50)
J
= 0
onde qt é o fluxo especificado do componente c e pP determina a fase: assume valor 1 para fases especificadas e 0 para fases não especificadas.
O sistema não linear, formado pelas Eqs. (5.48), (5.49) e (5.50). será representado por uma única equação vetorial:
R(x) = 0,	(5.51)
onde R representa o resíduo do sistema de equações.
Aplicando-se à Eq. (5.51) o processo de linearização do método de Newton-Raphson. que utiliza as Séries de Taylor, obtém-se o sistema linear:
J(x)v (£x)‘' =-R(x)^	(532)
onde
(Sxf^x^-x'	(5.53)
representa a variação do vetor de incógnitas x sobre a iteração v e J, a matriz Jacobiana de R(x), que contém as derivadas parciais de todos os componentes da função R(x) em relação a cada componente de x. Cada um de seus elementos podem ser obtidos por diferenciação numérica ou analítica.
5.4.2.2 Solução do sistema de equações lineares
Na solução do sistema de equações lineares foi adotado o esquema totalmente implícito e processos iterativos, aplicados a Eq. (5.52), para encontrar x tal que o sistema descrito na Eq. (5.51) seja satisfeito, de acordo com uma tolerância preestabelecida. Foram estabelecidos dois critérios para o processo de convergência:
I. Máxima variação das variáveis primárias
absolutos,
(5.54)
quando a
(5.55)
tolerância
adimensional especificada.
Para as saturações, foi estabelecido que a máxima variação, em termos deveria ser menor que a tolerância especificada, ou seja:

Para as pressões o processo de convergência é considerado satisfatório seguinte condição é alcançada:
Sp„
Pmedia

onde Pmedia &amp;amp; a pressão média do domínio onde se efetua a solução e a
//. Máxima variação do vetor resíduo
Ao final de cada iteração é verificado se o maior valor entre todos os componentes do vetor resíduo R é menor que uma tolerância adimensional especificada, ou seja:
/wr-UsVf?
(5.56)
Capítulo 6
6.1	Introdução
Os capítulos anteriores introduziram o modelo computacional multiescala, apresentando as motivações, os objetivos e as características da metodologia desenvolvida. A modelagem numérica e computacional dos problemas considerados neste trabalho foram também apresentadas. Após esta introdução, cada um dos processos envolvidos neste procedimento será tratado, neste capítulo, de forma mais detalhada.
Seja a simulação do comportamento de um reservatório, descrito numa determinada escala, para a qual deseja-se conhecer a evolução de algumas propriedades até um determinado instante. Âo se adotar o procedimento multiescala. a solução deste problema é conduzida numa escala menos refinada, mas utilizando informações provenientes de soluções aproximadas obtidas em regiões definidas dentro da escala fina. As etapas deste processo de solução podem ser esquematizadas no seguinte algoritmo:
Etapa 1: Estabelecer malha de simulação, subdomínios e relações hierárquicas entre as escalas.
Etapa 2: Efetuar mudança de escala das permeabilidades absolutas.
Etapa 3: Fazer/7=1 até tempo final.
Etapa 3a: Identificar os blocos da malha grossa onde será necessário detalhar a distribuição de saturações.
Etapa 3h: Estimar soluções dos sistemas de equações associados a cada subdomínio selecionado, com condições de contorno tipo Dirichlet especificadas,
Etapa 3c: Obter saturações representativas para as fases em cada subdomínio.
Etapa 3d: Solucionar sistema de equações associado a malha grossa, até convergência Newtoniana.
Etapa 3e: Solucionar sistemas de equações associados a cada subdomínio selecionado com condições de contorno tipo Neumann especificadas, até c o n ve rgênc ia N e w to niana.
Etapa 4: Finalizar
6.2	Processos Multiescala
6.2.1	Geração da malha de simulação
Na Etapa 1 a malha de simulação e construida a partir de informações fornecidas sobre a escala na qual pretende-se obter a solução do problema. A inicialização desta malha é feita de tal forma que as variáveis primárias em cada bloco assumem valores médios, ponderados pelos volumes porosos dos blocos finos que compõem a sua discretização. A geração desta malha ocorre em sentido oposto aos procedimentos adotados em refinamento local de malha. No caso de refinamento local, uni bloco, ou uni conjunto de blocos, dá origem a sub-blocos mais refinados, enquanto neste trabalho, um conjunto de blocos são agrupados para dar origem a um único bloco da malha grossa.
A implementação desta etapa requer uma estrutura de dados que facilite o relacionamento entre os blocos e as conexões dos dois níveis, do mesmo modo que refinamento local, A similaridade com as técnicas de refinamento local é total neste aspecto, Para um gerenciamento adequado dos dois níveis e das relações entre eles, deve-se estabelecer esquemas de numeração dos blocos nas duas malhas, bem como para os subdomínios, definir as relações hierárquicas entre os blocos da malha grossa e seu refinamento, além das relações entre as conexões nas diversas escalas. A estrutura de dados aqui adotada é semelhante àquelas apresentadas por Ding e Lemonnier (1993) e também na proposta por Ferragut et til. (1994) em seus trabalhos sobre refinamento local dinâmico.
Nesta etapa são definidos vetores de dimensões dinâmicas, que são relativos a cada bloco da malha grosseira, considerados como blocos-pai. A cada vetor é associado um conjunto de blocos da malha fina, que compõem o refinamento do bloco da malha grossa, e que constituem os blocos-filhos de cada bloco-pai. A numeração das duas malhas segue o esquema seqüencial, sendo independente para cada nível. Esta forma tradicional de numeração foi adotada porque em nenhum instante considera-se a malha composta, mas sim um conjunto de malhas regulares e independentes.
Em relação às propriedades de cada bloco, o procedimento adotado considera o volume poroso do bloco-pai como sendo a soma dos volumes porosos dos blocos-filhos, definindo assim as porosidades dos blocos da malha grossa. As pressões e saturações dos blocos pais são obtidas através da média ponderada pelos volumes porosos dos valores destas variáveis em cada bloco fino,
6.2.2	Mudança de escala das permeabilidades absolutas
O cálculo das permeabilidades absolutas equivalentes, que representem a distribuição desta propriedade nos blocos menores que dão origem a cada bloco da malha grossa, é urna tarefa complexa. Este tópico tem sido objeto de extensas pesquisas e devido ao fato de não ser uma propriedade aditiva, como a porosidade, têm-se utilizado técnicas das mais variadas para sua obtenção, que vão desde médias simples a soluções analíticas, passando por métodos
numéricos, técnicas de perturbação, simulação estocástica e chegando até a teoria da percolação e fractais. O estado da arte, com ênfase na descrição de estimadores analíticos e métodos numéricos, pode ser encontrado ern Ribeiro (.1996). Este autor aponta as limitações dos procedimentos analíticos, com principal ênfase no método que envolve uma combinação das médias Aritmética-Harmônica e Harmônica-Aritmética, conhecido como método de Le Loc’h (Le Loc’h (1987)). Assim como os demais métodos analíticos, sua principal característica é a simplicidade de cálculo, produzindo aproximações aceitáveis em uma grande variedade de casos. No entanto, existem casos especiais onde seu desempenho é bastante ruim. E o caso dos sistemas constituídos por sistemas arenito-argila, onde a argila está presente ern todos os canais paralelos ao fluxo, mas com distribuição tal que permite a existência de fluxo, Neste caso todas as médias harmônicas são zero e o procedimento não tem a capacidade de fornecer sequer uma aproximação. De modo geral, seus resultados são exatos para meios estratificados ou isotrópicos com distribuição de permeabilidade log-normal e fluxo uniforme.
Os métodos numéricos constituem unia forma muito mais geral para cálculo das permeabilidades absolutas equivalentes. De acordo com as discussões apresentadas por Renard e Marsily (1997), exceto para casos especiais como distribuição log-normal de permeabilidades ou meio estratificado, sempre é preferível utilizar métodos numéricos durante o procedimento de mudança de escala. Pickup et ul. (1994) comparam a precisão e robustez de vários métodos numéricos e concluem que todos apresentam resultados bastante próximos e que a especificação de condições de contorno periódicas conduz a urna maior precisão nos resultados da permeabilidade equivalente.
No tratamento numérico, para efetuar a mudança de escala em diversas regiões da malha fina, emprega-se a solução numérica das equações diferenciais parciais, as equações de difusividade. buscando a solução do campo de pressões e velocidades no meio heterogêneo, sob condição de contorno de fluxo nulo. Normalmente considera-se fluxo monofásico, sendo que a maioria dos autores consideram também o regime permanente e não o regime transiente. Após a solução do sistema de equações, e adotando-se um determinado
procedimento de equivalência, calcula-se ou o fluxo ou a energia dissipada no meio, levando a obtenção da permeabilidade equivalente.
Apesar das técnicas analíticas serem muito mais limitadas do que os métodos numéricos, os quais podem ser usados em qualquer campo de permeabilidades, elas são menos dispendiosas em termos de espaço de memória e custo computacional. Também as dimensões do problema podem dificultar o uso de técnicas numéricas. Neste caso podem-se adotar técnicas aproximadas ou heurísticas, como a renormalização, proposta por King (1989) e Christie (1995). onde um algoritmo recursivo é utilizado, com uma grande redução de blocos a cada iteração,
Na Etapa 2 do processo multiescala. durante a inicialização da malha grossa, é necessária a descrição da permeabilidade equivalente para cada bloco. Para tanto foram implementadas duas opções: um método aritmético, o proposto por Le Loc’h (1987). e um método numérico baseado na solução do sistema de equações para fluxo monofásico aplicado a cada bloco da malha grossa. O procedimento numérico implementado baseia-se em rotinas da biblioteca HOMLIB {Homagenizatüm Libraryp do projeto multicliente PROFIT do Centro de Computação da Noruega, desenvolvidas em 1994. e cedidas peia Petrobras. Foi utilizado especificamente o módulo EFFPERM. que agrupa rotinas de cálculo de permeabilidades equivalentes. O estudo ^Scaling and Represen ratina of Absolme Permeability\ que deu origem a esta biblioteca, é descrito por .HoIden et al. (1.994). Estas rotinas foram validadas por Ribeiro (1996), cujas conclusões indicam a utilização da média aritmética entre as duas permeabilidades fornecidas por estas rotinas: uma obtida pelo esquema usual de diferenças finitas e a outra pelo método dos elementos finitos. A comparação entre estes dois métodos de cálculo da permeabilidade absoluta equivalente é apresentada no Capítulo 7. em aplicações do procedimento multiescala a meios heterogêneos.
6.2.3	Solução dos subdomínios
Neste ponto identifica-se o uso potencial para computação paralela pois, na maioria dos casos, os subdomínios são tratados de forma independente e, a depender do número e das dimensões dos mesmos, pode-se usar este recurso para obter uma redução dos tempos computacionais.
6.2.3.	/ Com condição de contorno tipo Dirichlet
No início de cada passo de tempo (Etapa 3 b) é preciso descrever a distribuição de saturações dentro de cada subdomínio, bem como os fluxos em cada conexão. Esta descrição é necessária para realizar o ajuste dos fluxos das fases entre os blocos da malha grossa, conforme descrito anteriormente. Tal ajuste é obtido através do acerto dos termos das transmissibilidades entre as duas malhas que dependem das saturações, quais sejam: permeabilidade relativa e pressão capilar. Para obter esta distribuição de saturações cada subdomínio selecionado é resolvido, de forma aproximada, com condições de contorno tipo Dirichlet, sendo as condições iniciais e de contorno especificadas a partir da solução da malha grossa. Ao se especificar, nesta etapa, pressões no contomo e não fluxos nas conexões externas dos subdomínios, procura-se evitar a transferência para os subdomínios de valores da malha grossa ainda não corrigidos no passo de tempo em questão.
Como exemplo, seja o esquema apresentado na Fig, 6.1 para um subdomínio genérico ij formado por 9 blocos da malha fina e com interface com 4 blocos da malha grossa.
h 1 ,y-F I 9			ÍJ+1			•	
				* *	$		
		*					
VI,/		*				*	e	01 j
						*	
			*	*	V		
	•						•
				q-i			A-l.y-1
Fig. 6.1 - Esquema de um subdomínio, blocos adjacentes e pontos auxiliares
O símbolo ♦ representa o ponto central de cada bloco da malha grossa, enquanto o símbolo * representa pontos auxiliares, onde as condições de contorno do subdomínio i,j são especificadas.
Qualquer que seja a forma de obtenção das condições de contorno para cada subdomínio. as condições iniciais são sempre os valores das variáveis primárias. em cada subdomínio, consideradas no passo de tempo anterior. Esta consideração baseia-se em trabalhos que tratam transferência de parâmetros entre malhas de diferentes refinamentos, como Rodrigues (1994), que afirma ser este um procedimento que evita problemas de convergência, Além disso, em todas as situações, consideram-se as saturações dos blocos da malha grossa como sendo os valores prescritos nos pontos auxiliares esquematizados na Fig.
6.1.
Em relação às condições de contorno em termos de pressões, duas formas de obtenção de valores para os pontos auxiliares foram implementadas, conforme descrito a seguir:
/, Pressão da malha grossa interpolada
Hermitte e Guerillot (1993), paia o tratamento de blocos refinados e não refinados e aplicado a refinamento local. O esquema SLRT utiliza a continuidade de fluxo nas interfaces para obter pressões nas interfaces dos blocos e uma aproximação linear para obter a pressão em pontos auxiliares. No caso de meios heterogêneos, esta aproximação passa a ser ponderada pelas permeabilidades dos blocos da região refinada. A versão implementada neste trabalho utiliza valores de pressões no ponto • do bloco da malha grossa, considerados no passo de tempo anterior.
O esquema, para o caso particular onde os subdomínios possuem unia discretização de 9 blocos, num arranjo 3x3. é ilustrado pela Fig. 6.2. Os passos a seguir descrevem a obtenção das condições de contorno relativas às conexões a esquerda do bloco Lj . estabelecidas nos pontos auxiliares i-2/3 . j+k/3. onde k = ~ 1.0.1.
Fig. 6.2 - Esquema para interpolação da pressão, considerado no método SLRT
Hermitte e Guerillot (1993) apresentaram as seguintes expressões para obtenção de
pressões nos pontos auxiliares i-l,j±U3:				
	2/,	y Ã	4" [)	f i	
		3		(6.1)
onde:				
	X,., A'-.,.,-,,	"/	1J.H +	,		
				(6.2)
	k,	Av	!l	+ É		
e Ky a permeabilidade absoluta na direção y.
A extensão aplicada a este trabalho considera as mesmas expressões acima, mas devido ao fato de todos os blocos da malha grossa estarem associados a uma discretização, as heterogeneidades têm que ser consideradas em todas as interpolações feitas para a obtenção dos valores de pressão nos pontos auxiliares.
A seqüência de passos para obter valores extrapolados de pressão para cada ponto * é:
1	- Aplica-se tratamento similar ao utilizado para obter as Eqs. (6.1) e (6.2) aos blocos ò1J e
ij, considerando distâncias e permeabilidades na direção x. obtendo p/u/e./ £ Pmo. r
2	- Repete-se o procedimento agora para os blocos	e i,j±l. Desta forma, obtêm-se os
valores p?u/2,/±i e Prca.ao
3	- A partir dos valores p;-..-&gt;/.v e	e aplicando-se novamente o procedimento,
considerando agora distâncias e permeabilidades na direção y. calculam-se valores para p/_
2a #1/2*
4	- Finalmente, uma interpolação linear utilizando-se os valores pm/AAzv leva a obtenção de
valores de pressões para os pontos auxiliares z-2/3 f j+k/3, onde A=-l,0,l.
Este processo é repetido para todas as conexões do bloco ij.
O objetivo desta extensão é obter um procedimento capaz de fornecer valores interpolados na malha fina a partir da solução da malha grossa. Estes valores interpolados sobrepõem, na verdade, valores existentes obtidos durante a solução dos subdornínios. No entanto, estas soluções nos subdornínios representam apenas aproximações da distribuição das pressões na escala fina. Através de testes numéricos verificou-se o desempenho da utilização de, por exemplo, valores de pressões dos subdornínios adjacentes, considerados no passo de tempo anterior, como condição de contorno para cada subdomínio. Os resultados mostraram que valores baseados na solução da malha grossa são mais adequados do que estas aproximações.
//. Pressão da malha grossa não interpolada
Cada ponto * assume os valores de pressão exatamente iguais aos do ponto ♦ do bloco da malha grossa comum a estes dois pontos. A pressão considerada é a do passo de tempo anterior.
Esta segunda forma de prescrever pressões no contorno dos subdornínios foi implementada após uma série de testes apresentarem problemas de convergência nos subdornínios com a utilização da opção /. O desempenho destas duas opções é analisado, através de exemplos, no Capítulo 7. onde também é discutida a robustez de cada procedimento.
6.2.3,2	Com condição de contorno tipo Neumann
.Ao final de cada passo de tempo, após a solução da malha grossa, é realizado um ajuste entre os subdornínios e a malha grossa (Etapa. 3e). O objetivo deste ajuste é efetuar uma redistribuição de saturações nos subdornínios, que esteja associada aos fluxos da malha grossa, agora corrigidos, promovendo o acerto entre as duas malhas. A diretriz para esta redistribuição é fornecida pelos valores dos fluxos da malha grossa, que são distribuídos e especificados nas interfaces de cada subdomínio. A finalidade deste acerto é permitir que
durante o avanço da solução no tempo, exista sempre uma equivalência de solução entre as duas escalas, definida em termos do íluxo da malha grossa.
Para permitir uma descrição concisa do tratamento dado a distribuição dos fluxos através das conexões dos blocos na malha grossa, entre suas conexões correspondentes nos subdomínio, será introduzida neste ponto uma simbologia específica. Nesta simbologia G refere-se a qualquer domínio, que é especificado em função do sobrescrito: H para malha grossa e h para os subdomínios, enquanto b refere-se aos blocos da discretização associados a cada nível. O contorno de cada domínio é representada por 3G. enquanto Ce c referem-se a trechos deste contorno, respectivamente na malha grossa e no subdomínio. Os índices a e p representam as faces externas dos blocos grosseiros e dos subdomínios. definidos no sentido anti-horário, iniciando do lado direito. Desta forma a malha grossa é denominada GH. com contorno riGH e blocos bH i' u bH = GH . Da mesma forma, cada subdomínio G]i- bH. com contorno riG!i e blocos b11 I u b11 = G[1.
A seguir serão descritas as formas implementadas para distribuição do fluxo total de oGh sobre cada trecho de cG1,.
/. Distribuição ponderada pelas transmissibilidades
Para reconstrução dos fluxos nas interfaces externas dos subdomínios o primeiro critério adotado distribui os fluxos da malha grossa de fornia ponderada pelas transmissibilidades das fases nos blocos do subdomínio. situados a montante do fluxo.
Seja Cn.a e CG1' tal que so CHjx - 5G . para a malha grossa, onde o=l...,4 para o caso bidimensional. Da mesma forma seja ch.ií e cGb tal que u ckK - 5G‘\ para cada refinamento de um bloco da malha grossa. No caso bidimensional, /?== 1 &amp;amp;reí,,. ...4-	onde é o grau de
H	1’1
refinamento do bloco b \ relação válida para blocos situados fora de cG .
í'i.B ,	(6.3)
1
‘'¡■i,
onde r»e tw representam as transmissibilidades das fases óleo e água, respectivamente.
Os fluxos das fases na malha grossa. Fp. relativos as conexões CH.a são então
distribuídos sobre o contorno dos subdomínios, cíhp . obedecendo a relação:
X 'n.íi
onde p~o.w e para todo ciLirc: CH,U.‘
//. Distribuição ponderada pelo produto transmissibilldade-gradiente de pressão
Esta metodologia é similar à anterior apenas considerando na ponderação dos fluxos o gradiente de pressão definido por:
Ap/; = /A...., ~~ phh,	(6.5)
onde b e b-1 são blocos adjacentes e Gn, j b n b-1 - ch44. Desta forma, a distribuição dos fluxos da .malha grossa é feita de acordo com:
Esta opção de distribuição dos fluxos da malha grossa foi implementada com o objetivo de investigar também o efeito da consideração do gradiente de pressão como fator de ponderação nos cálculos. Particularmente nos testes efetuados com subdomínios mais refinados este foi um dos pontos investigados na busca de um melhor desempenho do algoritmo desenvolvido.
A influência desta duas formas de distribuição dos flu,xos interblocos da malha grossa entre as conexões das faces externas dos subdomínios é comentada no Capítulo 7,
6.2,4	Solução da malha grossa
Na Etapa 3d do processo multiescala, o sistema de equações definido para a malha grossa é ajustado a partir de informações transferidas para esta escala, as quais baseiam-se nas distribuições de saturações obtidas na primeira solução dos subdomínios. Ao mesmo tempo, ao final da solução da malha grossa, informações em termos de fluxos ajustados através das faces dos blocos da malha grossa são transferidas para a escala fina. Esta seção aborda as modificações e os procedimentos de ajuste das equações da malha grossa.
6.2.4,1	Modificação das equações de fluxo para a malha grossa
Com o objetivo de efetuar o ajuste dos fluxos na malha grossa, a partir de informações obtidas na solução dos subdomínios, algumas alterações são feitas nas equações de fluxo para a malha grossa. Na aproximação por diferenças finitas da equação de fluxo de fluidos, apresentada no Capítulo 5. o sistema final de equações é definido pela Eq. (5.44). ou seja:
Í7=l	‘Aí
' l J
para cada componente	e para cada fase p. Para o caso particular de fluxo bifásico
óleo-água, surgem dois termos que dependem índiretamente da saturação das fases. Estes termos são a transmissibilidade do componente c na fase p. Tcp . e o potencial da fase /?.&amp;lt;t&gt;z, Ao expressar estas equações para fase água, na malha grossa, o termo de que depende da saturação da fase água /Xvi. definido por:
A. =Ç,,(X.)	&lt;6.8)
é substituído por:
Da mesma forma, a pressão pw, que depende da pressão da fase óleo e da pressão capilar óleo-água, tem sua relação original.
PY.: =	(6.10)
modificada para
p.. = p, ~ p (500').	(6.11)
• i .I L !,&gt; X í;}1' ■	- '
Consequentemente, o vetor das equações de resíduos, expresso em termos de seus componentes para a malha grossa, definido pela Eq, (5.51) no Capítulo 5, passa a ser colocado, para fluxo bifásico óleo-água, sob a forma
R = F* (	) + F " (/p) - A (/ç,,	)
(6.12)
onde: Fb representa o fluxo de massa entre os blocos,
FVv o fluxo de massa nos poços e
A os termos de acumulação nos blocos.
Os termos da matriz Jacobiana, que são formados pelas derivadas parciais do vetor resíduo em relação a saturação da fase água, expressos por:
a r; d Fq ar a a dó.. 9S,, + dsíy
(6.13)
passam a ser aproximados por:
a r
a a
(6.14)
com )-L2,..,oib e j=L2,...xib. onde nb é o número de blocos da malha grossa,
Para os problemas considerados neste trabalho, fluxo bifásico óleo-água, desenvolvimento semelhante aplica-se para a fase óleo, onde o ajuste é realizado através do parâmetro 5(, . Para estes parâmetros é válida a relação:
(6.15)
Estas alterações surgem à partir da consideração de que as transmissibilidades das conexões da malha grossa não variam em função da saturação da fase na malha grossa, uma vez que o parâmetro Sr permanece fixo durante o passo de tempo considerado, Estas mudanças, incorporadas às equações de fluxo para a malha grossa, podem ser consideradas como condições de contorno extras, especificadas em cada conexão da malha grossa.
Na seqüência do capítulo são apresentados os ajustes efetuados nos termos de fluxo do vetor de resíduos, expresso pela Eq. (6.12).
6.2.4.2	Ajuste dos termos de fluxo entre blocos - F/?
O termo de fluxo entre blocos, F' , é composto por termos que dependem da geometria, da pressão e da saturação nos blocos da malha grossa. A permeabilidade absoluta equivalente, obtida na etapa inicial do algoritmo através de processo de mudança de escala, é aqui utilizada para ajustar o termo da geometria da malha de simulação. O termo de pressão, que depende apenas das pressões dos blocos, não sofre nenhum tipo de acerto, sendo obtido diretamente da evolução das pressões na malha grossa. Já o termo de saturação será aquele que efetivamente permitirá o ajuste dos fluxos das fases na malha de simulação, promovendo uma maior aproximação entre a sua solução e a de uma malha mais refinada.
6.2.4.2.1	Obtenção de S,;
Os próximos tópicos descrevem procedimentos adotados para definir quais blocos considerar dentro de cada subdomínio e como as saturações destes blocos devem ser tratadas durante o cálculo de Sp . Inicialmente serão descritos os suportes adotados, isto é. as regiões definidas dentro dos subdomínos para obtenção de e logo em seguida os pesos associados aos blocos destas regiões.
Suportes
Valores representativos para a variável SP são calculados de forma a gerar transmissibilidades das conexões e não transmissibilidades dos blocos. Estes valores, que representam uma espécie de mudança de escala para a variável saturação, devem ser definidos então para cada conexão.
O gradiente de pressão calculado dentro do termo de fluxo entre blocos, Fe é aproximado por um gradiente médio entre os pontos centrais de dois blocos adjacentes, Mantendo uma consistência com este processo, a saturação Sp , e por conseguinte, a transmissibilidade da respectiva conexão, deve também considerar regiões entre estes pontos médios, aqui denominadas suportes, Dentre as várias formas possíveis de se estabelecer tais regiões, foram definidas duas opções que são descritas a seguir.
krefx e dentro de cada bloco é considerado uni sistema de coordenadas local (/.m). que assume, no ponto central, os valores /-I e m=0.
A região sombreada apresentada na Fig. 6.3 representa uma das opções definidas neste trabalho e define os blocos a serem considerados no cálculo da transmissibilidade da conexão entre o bloco ij, e o bloco /+I.J. Sua geometria triangular foi inferida a partir de casos bidimensionais, onde um bloco genérico ij possui fluxos através de todas as suas quatro faces, e considera somente aqueles sub-biocos que mais contribuem para o fluxo saindo do bloco i.j, em direção ao bloco i+lj. As outras opções implementadas consideram uma ou mais colunas de blocos imediatamente a montante do fluxo.
Fig. 6.3 - Esquema de dois blocos da malha grossa com representação dos sub-blocos e da região de fluxo
Desta forma foram definidas as seguintes opções de seleção de blocos dentro de cada subdomínio:
• apenas os blocos da face de saída do bloco, ou seja, todos os blocos com coordenada 1=3, no critério denominado FACE;
•	todos os blocos de unia região triangular, que vai desde o centro do subdomínio até a conexão considerada, no critério denominado AREAL conforme ilustrado pela Fig. 6.3:
•	todos os blocos com coordenadas /=1 a 3. no critério denominado AREA2.
Pesos
A variável Sp é obtida, para cada interface da malha grossa, através de uma média ponderada dos valores das saturações dos blocos dos subdomínios. situados num determinado suporte, por uma função ponderação VF. Uma expressão geral, para qualquer razão de refinamento de blocos, e que considera um número qualquer de blocos na região de fluxo, pode ser colocada sob a forma:
: kreJJ2~\	J
X „ ^W{m)Sp(Lm)
l-[ 1
''	Po&lt;t/2l	J	’
y ~ ^W(m) Oi ?i&gt;-i l-hKref,.,, :
, w,
onde: Kref\ = ...
rir/,
/ significa o número de colunas que serão consideradas dentro da região de fluxo.
o símbolo L J significa o maior inteiro menor do que o argumento.
e o símbolo I significa o menor inteiro maior que o argumento.
A função ponderação fF representa o peso que cada sub-bloco tem no cálculo de saturação 5Z? do bloco da malha grossa, e consequentemente nas transmissibilidades obtidas para este bloco. As fornias de obtenção desta função ponderação implementadas neste trabalho, aplicáveis a todos os suportes definidos, FACE, AREAI e AREA2. são descritas a seguir.
Pesos baseados na mobilidade total
+
W(J ) ~ k(J.)
ajo
(6,17)
M,(0
Esta função pode ser denominada condutância e é capaz de refletir a real contribuição de cada bloco refinado, situado na interface entre dois blocos da malha grossa, no fluxo total que atravessa esta conexão. A inclusão da permeabilidade absoluta K(i) neste critério tem por objetivo considerar o efeito das heterogeneidades nos pesos relativos a cada bloco i.
Pesos predefinidos
Este critério para definição da função peso é totalmente heurístico pois considera uma definição a príorí do peso com que cada bloco fino contribui durante a obtenção de S/s*. Este esquema foi incluído nos testes para permitir a verificação do desempenho de uma forma mais simples de ponderação quando comparada com o esquema de ponderação do item anterior.
No caso particular onde é considerada a fase água, a face cc=l do bloco ij da malha grossa, a direção a\ o sentido de fluxo como saindo do bloco e apenas os blocos da face da região de fluxo, como ilustrado na Fig. 6.4. todos com pesos iguais, a Eq, (6,16) fica reduzida a:

(6.18)
				sq3.2)
				SW(3J.)
				Sw(3.0)
				
				SO-VC.)
Região refinada referente ao bloco /,/
Fig. 6.4 - Esquema de obtenção de 5„.*, segundo o critério FACE, para um bloco genérico Lj
O desempenho dos critérios descritos nesta seção, tanto para definição do suporte a ser considerado dentro dos subdomínios. quanto para estabelecer a forma de ponderação, é analisado através de resultados numéricos apresentados e discutidos no Capítulo 7.
6.2A.3 Ajuste dos termos defluxo nos poços - F*
Da mesma forma que os termos de fluxo entre blocos, o termo de fluxo nos poços F\ presente na Eq. (6.12). é composto por fatores que dependem da geometria, da pressão e da saturação. Os fatores de geometria referem-se ao índice de produtividade, enquanto os de saturação referem-se às transmissibilidades das fases das conexões entre os poços e os blocos da malha grossa. Durante o processo de mudança de escala é necessário ajustar estes fatores entre as malhas consideradas e diferentes abordagens são descritas por diversos autores. O trabalho de Emanuel e Cook (1974) utiliza o mesmo conceito de pseudo-permeabilidade relativa desenvolvida para blocos para obter pseudo curvas específicas para os poços. Neste sentido apenas as funções dependentes das permeabilidades relativas são ajustadas. White e Horne (1987), ao proporem um procedimento para avaliar os fluxos nas interfaces dos blocos de uma malha grosseira através do cálculo dos coeficientes de transmissibilidades, estenderam a metodologia para os blocos com poços, mas não trataram da alteração do índice de produtividade. Ding (1995) utilizou transmissibilidades e índice de produtividade equivalentes obtidos através de simulações de fluxo permanente na região do poço, considerando condição de fluxo radial.
O ajuste considerado neste trabalho propõe alterações nas transmissibilidades das fases através das conexões entre poço e bloco e também no índice numérico de produtividade dos poços e tem a mesma filosofia da metodologia descrita para ajustar as fases através dos blocos, ou seja, através de alterações nos termos de geometria e saturação. No termo de geometria considera-se a permeabilidade absoluta do bloco da malha fina onde o poço encontra-se completado. O raio equivalente de Peaceman, r0, definido no Capítulo 5, Eq. (5.43). não sofre alteração, uma vez que as pressões consideradas são aquelas dos blocos da malha grossa.
Neste trabalho considera-se que. no caso de poços injetores, as saturações são iguais à saturação do fluido injetado, sendo que apenas uma fase é considerada no processo de injeção. Deste modo, nenhum acerto é necessário em função de mudança de escala. Já no caso de poços produtores, as saturações dependem dos valores dos blocos onde os poços são completados. Deste modo, de forma análoga ao tratamento considerado para as permeabilidades absolutas, as saturações consideradas são as do bloco refinado que contém a completação destes poços.
Capítulo 7
Exemplos Numéricos
7.1	Introdução
Este capítulo trata das aplicações práticas do modelo computacional mui descaía implementado, denominado SCALE. Com o objetivo de verificar o desempenho desta modelagem quando aplicada a diversas situações de deslocamento em meios porosos, uma seqüência de exemplos foi elaborada de forma a contemplar vários casos. Esta análise será feita comparando-se a solução do SCALE com duas soluções de referência: a obtida na escala fina (GF) e a obtida na escala mais grosseira considerando apenas mudança de escala das permeabilidades absolutas, quando for o caso (GG). Esta segunda solução de referência justifica-se pelo fato do simulador SCALE resolver os problemas nesta mesma discretização, mas acrescentando os passos da mudança de escala para fluxo mui ti fásico. Esta fornia de apresentação permite visualizar os efeitos dos procedimentos que foram incorporados ao simulador convencional.
Inicial mente será feita a descrição dos principais dados dos casos utilizados nos testes e. a seguir, será analisado o desempenho das opções implementadas em algumas etapas do algoritmo apresentado no início do Capítulo 6 e detalhadas ao longo daquele capítulo. Estas opções referem-se:
•	à forma de obtenerlo de valores representativos para as saturações em cada bloco da malha grossa, após a solução dos subdornínios com condição de contorno Dirichlet apresentadas na Seção 6.2 (Etapa 3c): e
♦	à influência da razão de redução da escala.
Após a solução da malha grossa (Etapa 3d'p é necessário efetuar a distribuição dos fluxos interblocos deste nível entre as conexões das faces dos subdornínios para a solução dos subdornínios com condição de contorno tipo Neumann (Etapa 3e). Nesta etapa foram testadas as duas possibilidades de reconstrução descritas na Seção 6.2 do Capítulo 6: a média ponderada pelas transmissibilidades e a média ponderada pelo produto transmissibilidade-gradiente de pressão. Como em todos os casos a primeira alternativa teve desempenho superior à segunda, não serão apresentados resultados comparativos entre elas e todos os casos mostrados consideram a primeira forma de distribuição.
Os itens subsequentes analisam a influência das características dos fluidos, da descrição do meio poroso e do tipo de rocha nos resultados obtidos pelo modelo multiescala. Estas análises abordam os seguintes aspectos:
•	efeito da compressibilidade e da densidade dos fluidos;
•	influência das heterogeneidades:
•	influência do tipo de curva de permeabilidade relativa.
Na sequência será verificada a influência das condições de produção especificadas para os poços, e alguns resultados serão comparados com o módulo PSEUDO do simulador comercial ECLIPSE, que baseia-se nas pseudo-funções multifásicas. Finalmente, será apresentada uma discussão a respeito da aplicabilidade e desempenho do SCALE.
7.2	Descrição dos Casos
Tabela 7.1 » Dados PVT para água, óleo e gás
Pressão ( MPa)	Bo (m7stnf)	Vise. Óleo (IO’’5 Pas)	Rsgo (stm7 stm’)	Bw (m7stm')	Vise. Agua (103 Pas)	Bg (inVstnf)	Vise. Gás (10 ' Pas)
0.101	1.062	1.040	0J78	1,041	0,31	0.166666	0,0080
1.823	1,150	0.975	16.919	1,0403	0.31	0.012093	0,0096
3.546	1.207	0.910	32.057	1.0395	0.31	0.006274	0.0112
6.991	1.295	0.830	66.073	1.0380	0.31	0.003197	0.0140
13.881	1.435	0.695	113,268	1.0350	0,31	0,001614	0,0189
17.326	1.500	0.641	138.023	1.0335	0.31	0.001294	0.0208
20.771	1.565	0,594	165.627	1.0320	0.31	0.001080	0.0228
62.111	1.436	0.870	165.627	1.0130	0.31	0.000386	0.0470
As curvas de permeabilidades relativas utilizadas nos testes são curvas analíticas do tipo Corey, onde:
5, -S,.. n	a /
=5,.. A	k,... Ml-S..,. Ó,
¡I,	I::	X ?l! ■
(7.2)
A Fig. 7.1 apresenta as funções da Eq. 7.2 de forma gráfica, para valores de n=L n=l.5 e n.~2. versus a saturação 5vt. todos considerando 5M1~Sf;í.-0.2.
Fíg. 7.1 - Curvas de Permeabilidades Relativas
Em todos os exemplos as condições iniciais são iguais para todos os blocos, quais sejam: pressão inicial igual a 33,07 MPa (4800 psia) e saturação inicial Swi igual a 0.2. Inicialmente a maioria dos resultados apresentados referem-se à curva de permeabilidade relativa com potência n=l,5. Ao final do capítulo serão apresentados resultados para outros conjuntos de curvas de permeabilidades relativas. As condições de operação dos poços serão especificadas em termos de vazão constante nos poços injetores e pressão constante nos poços produtores. Esta situação permite investigar o comportamento do SCALE em relação ao fluxo das fases nos poços produtores.
Os sub-ítens a seguir descrevem inicialmente os exemplos de seção plana, no plano xy -casos HERA. ZEUS. AJAN. THOR e LO Kl - e. ao finai, os exemplos de seção transversal, no plano vz - casos IS IS, ARES. JUNO e ODIN. Estes dois grupos de casos representam situações sem e com consideração do efeito gravitacional. respectivamente.
7,2.1 Caso HERA
Este caso representa um fluxo unidirecional no plano xv. meio homogêneo, com permeabilidade absoluta kx=kv=700 mD. A malha fina é formada por 45 blocos, numa configuração 15x3x1. conforme Fig. 7.2. As dimensões de cada bloco são: 304,8 m (lOOOft) x 304,8 m (lOOOft) x 30.48 m (l(X)ft). A mudança de escala será feita agrupando-se blocos em subdornínios 3x3x1. Neste caso são considerados dois poços: uni poço injelor de água localizado na posição (2,2,1)e um poço produtor na posição (14,2,1).
700 mD
Fig. 7.2 - Caso HERA - Representação da malha fina e poços
Este exemplo tem por objetivo verificar o desempenho do simulador SCALE no tratamento da dispersão numérica, através de comparações das respostas entre a malha de simulação 5xLxl e a malha mais fina, 15x3x1.
7.2.2 Caso ZEUS
Este caso representa uma seção no plano xy. meio heterogêneo, com permeabilidade absoluta distribuída segundo esquema da Fig. 7.3.
50 mD 100 mD
120 ml)
150 mD
180 mD 200 mD
Fig. 7.3 - Caso ZEUS - Representação da malha fina 12x12x1, dos poços e da distribuição das permeabilidades, em mD
A malha fina é formada por 144 blocos, numa configuração 12x12x1. com as mesmas dimensões do caso HERA. Neste caso, a discretização de cada subdomínio é também de 9 blocos. Inicialmente são considerados dois poços: um poço injetor de água localizado na posição (1 LI 1.1) e um poço produtor localizado na posição (2.2.1). conforme mostrado na Fig. 7.3.
O mesmo problema descrito pelo caso ZEUS é também tratado com outra malha de discretização, apresentada na Fig. 7.4.
Fig. 7,4 - Caso ZEUS - Representação da malha fina 20x20x1, dos poços e da distribuição das permeabilidades, em mD
Estas variações de malha têm o objetivo de avaliar a influência da discretização dos subdomínios na resposta do problema. Nas duas configurações a malha de simulação considerada pelo SCALE é 4x4x 1, o que representa uma redução de escala de 9 e 25 vezes.
7.2.3 Caso AJAX
Este caso representa também um fluxo bidimensional em meio heterogêneo no plano XV. mas com uma distribuição de permeabilidades que segue um padrão aleatório, com valores razoavelmente próximos, sem nenhum efeito de valores extremos, conforme apresentada na Fig. 7.5. A redução de escala considerada, os parâmetros geométricos e de poços são os mesmos do caso ZEUS.
Além de avaliar o comportamento do processo de mudança de escala proposto para meios heterogêneos, este exemplo foi incluído nos testes com o objetivo de investigar também a influência do método de mudança de escala da permeabilidade absoluta na resposta do SCALE.
Fig. 7,5 - Caso AJAX - Representação da malha fina, dos poços e da distribuição das
permeabilidades, em mD
7.2.4 Caso THOR
Este e o próximo exemplo são variações do caso AJAX e representam ocorrências de dois importantes tipos de heterogeneidades principais: canais e barreiras. Neste caso é caracterizado um caminho preferencial de fluxo dentro da malha fina devido a presença de uma região com geometria canalizada com permeabilidades bastante superiores ao restante do reservatório, conforme esquema da Fig. 7.6,
	7	^^7
	/	/
50 mD
HjO mD
L50 mD 200 mD 250 ml)
300 mD
350 mD 800 mD
O objetivo deste caso e testar a habilidade do método em tratar subdomínios com grandes variações de permeabilidade e também na presença de regiões entre poços que representem um caminho preferencial de deslocamento para o fluido injetado,
7.2.5	Caso LOKI
O caso LOKI é outra variação do caso AJAX, agora considerando blocos com permeabilidades extremamente reduzidas. Neste exemplo os blocos (7.6,1), (8,5,1), (9.4,1) e (10.3,1) da Fig. 7.5. assumem valores de permeabilidades iguais a 0,00001 mD. Esta distribuição representa uma situação onde o subdomínio relativo aos três primeiros blocos anteriores passa a não permitir fluxo em nenhuma direção, fato que ocorre. por exemplo, nos casos de barreiras de transmissibilidades praticamente nulas,
7.2.6	Caso ISIS
Este caso representa uma seção transversal homogênea com permeabilidade absoluta kx=kz=400 mD. A malha fina é formada por 100 blocos, conforme Fig. 7.7. numa configuração 20x1x5. com dimensões de 91 m x 15.2 m x 15,2 m(300 ft x50ft x50 ft). Neste caso o poço injetor de água está localizado na posição (18,1.4) e o poço produtor na posição (3,1,1), e a redução de escala considerada nos exemplos é de 25 vezes, uma vez que os blocos serão agrupados em subdomínios de 5x1x5.
Fig. 7.7 - Caso ISIS - Representação da malha fina e poços
7.2.7 Caso ARES
400 ml)
♦z
Fig. 7.8 - Caso ARES - Representação da malha fina e poços
X
Diferentemente do caso 1 SIS. neste exemplo os subdo minios têm uma configuração
3x1x6 e. consequentemente, a mudança de escala considerada é de 18 vezes.
72.8 Caso JUNO
Este caso representa uma seção transversal heterogênea com distribuição de permeabilidade absoluta conforme esquema da Fig. 7.9. Neste caso a malha fina é formada por 36 blocos, numa configuração 12x1x3, com dimensões de 122 m x 152 m x 15,2 m (400 ft x50ft x50 ft). O poço injetor está localizado na posição (12,12) e o poço produtor
I 2	3	4	5	6	7	8	9	10	11
50 mD
7.2,9 Caso ODIN
Este caso representa também uma seção transversal heterogênea com distribuição de permeabilidade absoluta conforme Fig. 7.10 e as mesmas dimensões e posições dos poços do caso JUNO. A diferença deste caso é que ele representa outra configuração de distribuição de permeabilidades onde um caminho preferencial de fluxo atua no mesmo sentido das forças gravitad onais,
Fig. 7.10 - Caso ODIN - Representação da malha fina, dos poços e da distribuição das permeabilidades, em ml)
Ao longo das próximas seções, os casos descritos neste item serão utilizados como exemplos nos testes realizados para verificar algumas das opções implementadas no simulador SC ALE. bem como seu comportamento frente à particularidade que cada um destes casos representa. A menos que seja especificado, todos os dados considerados são os informados nesta seção.
A Tabela 7.2 resume as principais características de cada caso e apresenta as condições de operação prescritas para os poços, na maioria dos exemplos.
7.3	Desempenho das Opções de Tratamento do SCALE
saturações das fases que irão ajustar as transmissibilidades das fases nas conexões da malha grossa e da influência do grau de redução de escala a ser realizada.
Tabela 7.2 - Descrição dos casos e das condições de operação
	CASO	Descrição Malha Fina	Pressão Especificada	Vazão Especificada (mVd)/(bbl/d)
	HERA	Homogêneo	20.67	3179.6
	(incompressivel)	i5x3x1	3000	20000
	HERA	Homogêneo	31.00	1589.8
	(compressivel) 	 		15x3x1	4500	10000
Seções	ZEIS	Heterogêneo 12x12x1	27.56 4000	2384.7 15000
Planas	AJAX	Heterogêneo 12x12x1	20.67 3000	2384.7 15000
	THOR	Heterogêneo 12x12x1	31.00 4500	1589.8 10000
	LOKI	Heterogêneo 12x12x1	20.67 3000	2384.7 15000
	ISIS	Homogêneo 201x5	27.56 4000	158.9 1000
Seções	ARES	Homogêneo 12x1x6	27.56 4000	158.9 1000
Transversais	JIJNO	Heterogêneo 12x1x3	27.56 4000	158.9 1000
	ODIN	Heterogêneo 12x1x3	27.56 4000	158.9 1000
7.3.1	Formas de consideração das condições de contorno tipo Dirichlet
Durante a solução dos subdomínios com condição de contorno tipo Dirichlet (Etapu 3b)„ é necessário especificar pressões no contorno dos subdomínios a partir de valores de pressão da malha grossa, no passo de tempo anterior. Os valores associados a cada um dos pontos auxiliares do contorno (Hg 6.1 do Capítulo 6) podem ser considerados iguais à pressão da malha grossa ou podem ser obtidos por interpolação utilizando-se a extensão do esquema SLRT descrita no Capítulo 6.
Fig, 7.11 - Caso AJAX - kr n=l -Comparação entre tratamentos das condições de contorno tipo
Dirichlet
Outro exemplo da consideração de interpolação ou não de pressões pode ser visualizado na Fig. 7,12. que apresenta soluções para o caso ARES e onde é possível verificar que as pressões não interpoladas apresentam um desempenho ligeiramente melhor.
A consideração de condições de contorno baseadas na solução da malha grossa foi a melhor opção entre as várias testadas. Este tratamento evita problemas de convergência em situações onde todas as pressões são bastante próximas, ou seja, um fluxo quase permanente, associado a passos de tempo grandes. Desta forma, além de apresentar melhores resultados em termos de vazões nos poços produtores, a consideração de valores sem interpolação mostrou-se também mais robusta do que os valores interpolados, em termos de condição de
contorno.
Fig. 7.12 - Caso ARES - kr n=l,5 -Comparação entre tratamentos das condições de contorno tipo Dirichlet
A Fig. 7.13 exemplifica o comportamento das pressões com e sem interpolação para os 6 pontos auxiliares do contorno do subdomínio do caso ARES, representado no esquema abaixo. O resultado em termos de vazão de água no poço produtor é apresentado na Fig. 7.12.
✓	z	Z
		b
		
		
		
		
	o		Jz
64
52
40
28
16
Subdomínio 3x6
t (dias)
Fig. 7.13 - Caso ARES - Pressões nos pontos auxiliares do contorno do subdomínio
Um dos maiores desafíos na elaboração do algoritmo do processo multiescala foi a obtenção de condições de contorno robustas, em termos de pressões. Uma discussão sobre este tipo de condições de contorno dentro do contexto deste trabalho deve abordar os seguintes tópicos:
•	a confiabilidade dos esquemas de interpolação de pressões entre malhas diferentes.
•	a aplicabilidade destas interpolações ao procedimento multiescala.
A interpolação de pressões entre malhas diferentes é tratada nos trabalhos de Ranié e Killough (1992) e Guérillot e Verdiere (1995), No primeiro trabalho são apresentados métodos de interpolação baseados em splines, enquanto o segundo faz uma tentativa de considerar o problema físico e as heterogeneidades do meio para dar maior sustentação ao processo de interpolação. No entanto, ao discutir sobre a confiabilidade dos esquemas de interpolação de pressões. Ramé e Killough (1992) comentam que existem dificuldades em tais desenvolvimentos. Em situações de fluxo compressível. por exemplo, uma pequena diferença de pressões na malha fina é responsável por alterações na distribuição das fases nos blocos que podem comprometer a utilização dos valores interpolados. Embora esta análise seja restrita à utilização de interpolação quando comparada aos valores corretos da malha fina, ela mostra que os efeitos de valores aproximados de pressão acarretam imprecisão em termos de distribuição das fases dentro da região refinada considerada.
Para avaliar de forma adequada o desempenho da interpolação de pressões no contexto deste trabalho é necessário enfatizar o objetivo desta etapa dentro do algoritmo desenvolvido, qual seja. determinar valores de saturações que possam ajustar as transmissibilidades das fases nas conexões da malha grossa. Embora a interpolação baseada no esquema SLRT seja um mecanismo eficiente de interpolação de valores entre malhas com diferentes refinamentos, para o qual foi concebido, ele não apresenta, neste trabalho, melhor desempenho do que a opção de pressões constantes, enquanto condições de contorno. Uma justificativa para tal comportamento é o fato do esquema SLRT utilizar a continuidade de fluxo nas interfaces dos blocos da malha grossa como elemento básico de sua formulação. Esta premissa é adequada para os casos de refinamento local, mas neste trabalho o que se busca nesta etapa é justamente alterar este fluxo nas interfaces da malha grossa. A especificação de uma condição de contorno que não esteja comprometida, quer seja de forma explícita ou implícita, com estes fluxos, produzirá melhores resultados em termos do ajuste das transmissibilidades, que é o que se pretende com a simulação em diferentes escalas.
7.3.2	Formas de obtenção das saturações para ajuste das transmissibilidades
No Capítulo 6 foram descritos os procedimentos do modelo computacional multi escala. A Etapa 3 c do algoritmo apresentado naquele capítulo trata da obtenção de um valor de saturação para cada fase, para cada subdomínio. que represente a distribuição de fluidos definida pela solução dos sub domínios na Etapa 3b. Este item avalia o desempenho das diversas formas de obtenção destas saturações e que são usadas para ajustar as transmissibilidades das conexões. Como todos os problemas são relativos ao deslocamento de óleo por água, os parâmetros calculados e utilizados no ajuste das transmissibilidades serão a saturação da fase água, ófo e a saturação da fase óleo. S().
A obtenção destas saturações representativas depende:
subdomínio (AREAI) ou colunas de blocos situados a montante do fluxo que atravessa a face de saída do subdomínio (AREA2 ou FACE), conforme ilustrado pela Fig. 7.14,
AREAI	AREA2	FACE
direção do fluxo através da face selecionada
Fig, 7.14 - Esquemas a montante do fluxo considerados no cálculo da saturação equivalente, num subdomínio 5x5
• do tipo de ponderação a ser aplicada aos valores das saturações dos blocos do subdomínio situados dentro de um determinado suporte, ou seja, atribuem-se pesos diferentes a cada bloco da região selecionada como forma de definir uma maior contribuição dos blocos situados mais próximos da interface selecionada. Este critério pode basear-se na mobilidade total de cada bloco (MOB) ou em pesos predefinidos (GEO). Na aplicação do critério MOB. a ponderação é feita somando-se o produto permeabilidade absoluta-mobilidade total dos blocos selecionados e calculando-se o peso como sendo a fração de cada bloco. Esta ponderação é denominada tipo V. Um exemplo do critério GEO, associado à região AREAL denominado GEO05 está representado na Fig. 7.15, onde os números representam pesos associados a cada bloco. As outras variações do critério GEO que aparecem ao longo do texto representam apenas diferentes pesos associados ao bloco central do subdomínio.
	-		1
	0.5	1
		1
A
Inicialmente serão discutidos os tipos de ponderação aplicados às saturações dos blocos dos subdomínios (MOB ou GEO) e. na seqüência. será analisado o desempenho dos diferentes suportes testados para o cálculo das saturações equivalentes nos subdomínios. apresentados na Fig. 734.
A Fig. 7.16 apresenta resultados em termos de vazão de água no poço produtor para o caso HERA, considerando diferentes formas de obtenção de e S(! para cada um dos 5 subdomínios 3x3 considerados neste exemplo Além dos resultados do simulador SC ALE. obtidos com uma malha de simulação 5x1. estão representados também a solução completa da malha fina 15x3 (GF) e a solução convencional da malha grossa 5x1 (GG).
Fig. 7.16 - Caso HERA - kr n=l,5 - Vazão de água no poço produtor para diferentes
formas de obtenção das saturações representativas em cada subdomínio
Para fluxo unidirecional numa seção plana, representado por este exemplo, a seleção apenas dos blocos situados na face de saída do fluxo, esquema FACE, consiste na melhor metodologia de obtenção das saturações representativas em cada subdomínio. Quanto ao critério de ponderação, observa-se que a mobilidade total dos blocos, associadas a definição dos pesos pelo critério V. MOBV. tem melhor desempenho do que pesos especificados de forma fixa, como é o caso do procedimento GEO05. Embora não representado na Fig. 7.16.
observou-se que. para um mesmo suporte, quanto maior o peso associado ao bloco central do subdomínio 3x3, maior a produção de água e, obviamente, mais distantes os resultados se situam em relação à resposta da malha fina. Verifica-se. portanto, neste caso uma boa concordância do conjunto de critérios FACE-MOBV com a solução da malha lina em relação à obtenção do instante de irrupção da água, que ocorre quase 4 anos mais cedo quando a solução é obtida pela malha grossa sem os ajustes do procedimento multiescala.
Uma observação importante em relação a esta etapa de obtenção de saturações que irão ajustar as transmissibilidades das conexões da malha grossa c a sua grande influência na qualidade dos resultados. Diferentemente de outras etapas do algoritmo multiescala, esta etapa é mais sensível que as demais em relação às opções de cálculo implementadas e constitui, portanto, o ponto mais importante de investigação em busca de melhores respostas para o processo de mudança de escala proposto.
Os dois gráficos a seguir. Fig, 7.17 e Fig. 7.18. apresentam resultados, em termos de vazão de água no poço produtor, para o caso ZEUS com dois poços, cujas locações são as representadas na Fig. 7.3. e para curva de permeabilidade relativa com n-2.0.
Inicialmente a Fig. 7.17 apresenta resultados para diferentes esquemas de pesos segundo o criterio GEO, para um mesmo suporte, evidenciando que tal critério produz resultados bastante distintos, que dependem dos valores predefinidos, podendo ocorrer situações com problema de convergência como no caso GEO05.
A Fig. 7,18 apresenta os resultados para este mesmo caso mas considerando curva de permeabilidade n-1,5 e outras formas de obtenção de saturações representativas para os subdomínios.
Fig. 7.18 - Caso ZEUS - kr ri—1,5 - Vazão de água no poço produtor para diferentes
formas de obtenção das saturações nos subdomínios
Analisando-se a Fig. 7.18 observa-se que o critério de ponderação no qual o peso associado ao bloco central do subdomínio 3x3 assume valor 0.5 e os demais blocos assumem o valor 1.0. GEO05. apresentou bom ajuste quando comparado com a solução de referência na malha fina, enquanto o critério GEO2 obtém um desempenho inferior. Se forem comparados estes resultados com os apresentados na Fig. 7.17. verifica-se uma variação no desempenho dos esquemas baseados em pesos predefinidos quando aplicados a diferentes situações. Este comportamento justifica-se pelo fato destes pesos não considerarem, de forma dinâmica, as contribuições de cada bloco dos subdomínios e não se
basearem em informações relativas aos caminhos de fluxo dentro do domínio do problema. Esta característica dificulta a generalização de critérios baseados neste tipo de ponderação predefinida.
A opção que baseia-se em pesos definidos pela mobilidade total dos blocos está representada na Fig. 7.18 apenas em conjunto com o esquema AREAI. Diferentemente dos resultado para o caso HERA, apresentados na Fig, 7.16, não foram obtidos, neste exemplo, bons resultados quando a seleção de blocos é feita considerando apenas os blocos da face de saída (FACE). O critério MOBV-FACE não foi incluído nos resultados apresentados na Fig.
7.18	porque, neste caso, não é capaz de ajustar, nem de forma razoável, as transmissibilidades das fases nas conexões dos blocos da malha grossa e o processo de solução do sistema de equações na malha grossa passa a não convergir. Já na opção MOBV-AREAL que considera o suporte AREAI para todos os blocos e a definição dos pesos baseados na mobilidade de cada bloco, é possível obter um ajuste muito bom entre o resultado do SCALE. obtido com uma malha de simulação com 16 blocos e a solução da malha fina com 144 blocos.
Fig. 7.19 - Caso ODIN - kr «=1,5 - Vazão de água no poço produtor para diferentes
formas de ponderação das saturações nos subdomínios
De uma forma geral, pode-se afirmar que o critério de ponderação que utiliza a mobilidade total de cada bloco do subdomínio para o cálculo das saturações a montante do fluxo em cada subdomínio é mais geral e tem um melhor desempenho quando comparado com o critério de pesos fixos e predefinido,
Os próximos resultados apresentados nesta seção abordam o desempenho dos 3 suportes apresentados na Fig. 7.14 quando aplicados a diferentes situações. Os três gráficos a seguir. Fig, 7.20, Fig. 7.21 e Fig. 7.22. representam soluções para os casos HERA. ZEUS e AJAX. respectivamente, e consideram apenas ponderação das saturações segundo o critério MOBV.
Fig. 7.21 - Caso ZEUS - 2 poços - kr n=l,5 - Vazão de água no poço produtor -
Comparação entre critérios de seleção de suportes para as saturações representativas para os subdomínios
Estes três exemplos mostram que existe uma variação do desempenho dos esquemas para cada tipo de problema. Enquanto o suporte representado pelo esquema FACE funciona melhor para o caso HERA, o suporte AREAI funciona muito bem para o caso ZEUS e o suporte AREA2 é o melhor para o caso AJAX. Desta forma, não é possível generalizar um esquema único para os problemas que tratam seções planas. Isto ocorre porque neste tipo de problema, não existe uma geometria de linhas de fluxo bem definida, uma vez que elas são definidas pela geometria do problema e pela distribuição das permeabilidades.
Fig, 7.22 - Caso AJAX - kr ~ Vazão de água no poço produtor -
Comparação entre critérios de seleção de suportes para as saturações representativas para os subdomínios
A influência da geometria de linhas de fluxo no desempenho destes esquemas pode ser observada solucionando-se novamente o caso ZEUS, mas alterando a distribuição dos poços, considerando agora dois poços injetores. nas posições (2,2,1) e (11.2,1) e um poço produtor, em (5.1.1). A Fig. 7.23 representa soluções para este problema segundo os suportes AREAI e FACE, ambos considerando pesos baseados na mobilidade total dos blocos destas regiões.
A comparação entre as Fig. 7.21 e 7.23 mostra que as linhas de fluxo influenciam no esquema a ser adotado e que. apesar do bom ajuste dos resultados em relação à produção de água, ainda faltam elementos suficientes para estabelecer um procedimento geral para obtenção de uma saturação representativa em cada subdomínio. Embora a maioria dos testes apontem para uma predominância de um bom desempenho do suporte FACE para casos com fluxo apenas numa direção e AREAI para os demais casos, quando se trata de seções planas, é necessário ainda investigar critérios adaptad vos. que possam considerar a influência verificada neste trabalho.
Fig. 7.23 - Caso ZEUS - 3 poços - kr n=l,5 - Vazão de água no poço produtor -
Comparação entre critérios de seleção de suportes para as saturações representativas para os subdomínios
Diferentemente das seções planas, para as seções transversais, onde a força de gravidade atua juntamente com as forças viscosas para definir as linhas de fluxo ao longo do reservatório, uni único tipo de esquema considerado no cálculo das saturações representativas para cada subdomínio apresentou um bom comportamento. Os casos LSIS e O DIN apresentados a segui iç solucionados de acordo com as condições de operação descritas na Tabela 7.2, representam duas situações de seções transversais, homogêneo e heterogêneo, respectivamente, onde o esquema denominado AREA2FACE apresentou um bom desempenho. Este esquema combina os suportes AR.EA2 e FACE da seguinte forma:
•	AREA2 nas conexões dos subdomínios onde a distribuição de fluxos é regida pelas forças gravitacionais; e
•	FACE nas conexões dos subdomínios onde a distribuição de fluxos é regida pelas forças viscosas.
conexão é obtida considerando o suporte AREA2: se não. são escolhidos apenas blocos do suporte FACE.
As opções testadas e mostradas nas Fig. 7.24 e 7.25 mostram que o critério MOBV-AREA2FACE tem um comportamento bastante próximo da solução da malha fina (GF). principalmente em termos de ajuste da água produzida após o instante de irrupção no poço produtor. Este bom ajuste torna-se ainda mais relevante se for considerado o grau de mudança de escala do caso homogêneo ISIS. de 25 vezes, e o grau de heterogeneidade representado pelo caso OD1N.
Comparação entre critérios de seleção de suportes para as saturações representativas para os subdomínios
Urna vez discutido o desempenho dos principais procedimentos implementados para obtenção de saturações representativas nos subdomínios após a etapa de solução destes subdomínios com condição de contorno Dirichlet, as análises apresentadas nas próximas seções irão apenas considerar valores de pressão não interpolados como condição de contorno, blocos da FACE para os casos unidimensionais, blocos situados na região definida pelo critério AREAI nos casos bidimensionais no plano xy e a combinação de AREA2 e
FACE para as seções transversais. Em todos os casos o peso atribuído a cada bloco da região será definido pelo produto permeabilidade absoluta-mobilidade total do bloco, segundo o critério MOBV.
Fig. 7,25 - Caso ODIN - kr n=1,5 - p() = pw - Vazão de água no poço produtor -Comparação entre critérios de seleção de suportes para as saturações representativas
para os subdomínios
A etapa discutida neste item, de como obter as saturações em cada subdomínio. é crucial no ajuste que se pretende obter entre a malha de simulação e uma malha mais refinada. Os resultados obtidos na malha grossa, quando se utiliza o procedimento multiescala. ficam mais próximos da solução de uma malha mais refinada quanto maior for a capacidade desta metodologia em obter estas saturações para cada um dos subdomínios. Um procedimento bem ajustado é aquele que leva à obtenção do fluxo de cada fase p através das faces dos subdomínios, e consequentemente, através das faces dos blocos grosseiros, o mais próximo possível dos fluxos através das conexões equivalentes na malha fina. Os gráficos a seguir. Fig. 7.27 e Fig. 7.28. fazem unia comparação entre a resposta aproximada obtida pelo SCALE numa malha 4x1 e a solução da malha fina (GF) 12x3 para o caso ODIN. Estes gráficos representam o fluxo de massa da fase água através das conexões das faces A e B dos subdomínios que comportam os poços, segundo o esquema representado na Fig. 7.26, que representa cada um dos subdomínios 3x3 considerados:
1-------------------F”
1
1
i	?
f-------------------r
!
§
i-------------------r
í	§
!
Fig. 7.26 - Esquema dos 4 subdomínios do caso ODIN e representação das conexões A eB
Fig. 7.27 - Caso ODIN - kr «=1,5 - po = pw - Fluxo de massa nas conexões externas do
subdomínio que comporta o poço produtor
¡dias:
Fig. 7.28 - Caso ODIN - kr n=l ,5 - p(, = pw - Fluxo de massa nas conexões externas do
As Fig, 7.27 e 7.28 mostram que a evolução do fluxo de massa da fase água nas três conexões dos subdomínios fica bastante próxima da solução da malha fina, principalmente em termos do fluxo total que sai/entra em cada subdomínio. A diferença maior existe na distribuição destes valores entre as 3 interfaces de saída/entrada em cada um deles.
7.3.3	Grau de redução de escala
A mudança de escala é uma técnica geralmente empregada em situações onde se requer a redução das dimensões do problema em grandes proporções. Tal redução pode ser feita em um único passo ou através de várias etapas, como discutido a seguir. Neste trabalho apenas uma etapa de mudança de escala é considerada. O comportamento do simulador SCALE quando diferentes reduções da malha fina são empregadas é apresentado neste item. Inicialmente o caso ZEUS e solucionado considerando malhas finas de 144 e 400 blocos, que sofrem mudança de escala através de subdomínios com 9 e 25 blocos, respectivamente, dando origem a malha grossa de 16 blocos.
A Fig. 7.29 mostra os resultados, em termos da razão entre a vazão de óleo e a vazão total na superfície, denominada fluxo fracionário e representada por f}. versus o tempo adimensional tn (número adimensional de volumes porosos de água injetados), obtidos pelo simulador SCALE usando uma discretização 4x4x1. As outras curvas representam as soluções convencionais das malhas finas 20x20x1 e 12x12x1. além da malha grossa sem tratamento de mudança de escala. Neste caso a razão de refinamento de cada subdomínio em cada direção e 3 e 5, respectivamente (Fig. 7.3 e Fig. 7.4).
condição de contorno tipo Neumann. Nesta etapa é efetuada uma distribuição dos fluxos da malha grossa que foram ajustados na etapa anterior, no mesmo passo de tempo. Quanto maior o número de interfaces externas do subdomínio. função da sua discretização. maior é a dificuldade em realizar esta distribuição. Como os critérios de distribuição implementados neste trabalho estão associados a parâmetros que dependem da pressão nos subdomínios e estes valores são aproximações, esta imprecisão se reflete na eficiência desta distribuição e, consequentemente, no ajuste dos subdomínios.
Fig, 7.29 - Caso ZEUS - kr n=l,5 -Fluxo fracionário de óleo para diferentes discretizações nos subdomínios
A Fig. 7.30 apresenta, para o mesmo problema, uma comparação, em termos de saturação da fase água, entre a resposta dos 16 subdomínios 3x3 considerados no SCALE e a solução da malha fina. É importante observar que. embora mostrados de forma contínua na Fig. 7.30a, estes subdomínios não representam uma malha contínua como a malha fina.
acerto não é executado buscando-se a convergência entre os subdomínios, como ocorre com a solução pelo método de decomposição de domínios, a solução neste nível é intermediária entre a opção de nenhum ajuste e a técnica de decomposição de domínio.
a - Subdomínios 3x3 do SCALE
b - Malha Fina 12x12
Fig. 7.30 - Caso ZEUS - Comparação dos mapas de saturação de água para t=35 anos
Para o caso das seções transversais, são apresentadas, na Fig. 7.31, soluções para o caso IS IS obtidas numa malha 4x1x1. mas considerando as mesmas razões de redução de escala do exemplo anterior: 9 e 25 vezes,
O desempenho do SCALE para diferentes díscretizações dos subdomínios mostra que a precisão cresce com o refinamento do subdomínio e é compatível com a respectiva solução da malha fina. Para o caso particular da seção plana, existe uma pequena perda de precisão para subdomínios com maior refinamento, independente desta diferença de precisão entre os resultados, o simulador SCALE tem seu desempenho em termos de custo computacional dependente do tamanho dos subdomínios. Esta observação é relevante quando se analisa o problema de mudança de escala sob o ponto de vista da teona da renormalização.
tD
Fig. 7.31 - Caso ISIS - kr «=1,5 - Fluxo fracionário de óleo para diferentes discretizações nos subdomínios
O método da renormalização proposto por King (1989) constitui num processo recursivo que substitui o passo único na tarefa de mudança de escala, numa seqüência de passos para ir de uma malha fina para outra bem mais grosseira. A passagem entre duas escalas passa então por uma série de malhas intermediárias cada vez menos refinadas. Por envolver simulações de baixo custo computacional, o método da renormalização pretende associar rapidez e precisão ao processo de mudança de escala. Nas aplicações do método, como em Christm et aL (1995), as pseudo-funções são utilizadas para transmitir informações entre os diferentes níveis de refinamento. Embora todo o desenvolvimento apresentado nesta tese envolva apenas a mudança direta entre duas escalas, o procedimento multiescala proposto pode, da mesma forma que as pseudo-funções, ser usado em cada um dos vários passos de uni processo recursivo. Neste caso, o processo trataria sempre de obter saturações representativas de um conjunto de blocos que seriam transferidas entre diferentes níveis de subdomínios até chegar ao nível menos refinado, O mesmo procedimento no sentido inverso permitiria o ajuste de cada nível de subdomínios. partindo da distribuição de fluxos do nível imediatamente anterior. Este processo permite, obviamente, contornar as desvantagens das pseudo-funções, uma vez que, como citado por Barker e Thibeau (1996), “a repetição de mudança de escala das permeabilidades relativas compõem as
dificuldades deserdas (para as pseudo-funções), e podem limitar a aplicabilidade do método da renormalização neste contexto".
7.4	Influência de Diferentes Características de Rocha e Fluidos
7.4.1	Compressibilidade dos fluídos
A consideração de compressibilidade dos fluidos altera diretamente a formulação do problema de transporte de fluidos em meios porosos. O sistema de equações, no caso de fluidos incompressíveis. é não-linear apenas em relação à variável saturação, o que torna possível desacoplar o sistema de equações gerando uma equação para a pressão e outra equação que envolve apenas os termos de saturação. Esta foi a abordagem adotada por Verdiere e Thomas (1996). o que acarreta em maior simplicidade no emprego de duas malhas durante a solução do problema: uma malha menos refinada associada à solução da equação da pressão e outra mais refinada associada à solução da equação da saturação. Neste trabalho, a solução para a hipótese de fluido incompressível foi obtida apenas considerando parâmetros de fluidos invariantes com a pressão e foram testadas três situações com diferentes razões de mobilidade, descritas na Tabela 7.3. onde:
V. C,&lt;A,,.) h». rjsa
Tabela 7.3 - Viscosidade dos fluidos e razões de mobilidade (M)
Viscosidade do óleo	Viscosidade da água	Razão de mobilidade
(cp)	(cp)	M
0.87	0,17	5J 1
0.47	0.47	1
0.30	0,47	0.64
Para testar esta influencia foram realizadas simulações com o exemplo de seção plana unidimensional, caso HERA. onde o problema é resolvido numa malha grossa com discretização 5x1x1.
A Fig. 7.32 apresenta os resultados comparativos entre o SC ALE e a solução da malha fina em termos de fluxo fracionário de óleo em função do tempo adimensional L. para fluido incompressível e para as razões de mobilidades definidas na Tabela 7.3. Neste caso foi dispensada a comparação com a malha grossa pelo bom ajuste dos resultados com a malha fina e por aqueles resultados se situarem muito distantes dos demais apresentados.
1 .20
Caso HEHA
Fig. 7.32 - Fluxo fracionário de óleo para o caso HERA, fluido incompressível e diferentes
razões de mobilidade
SCALE
SCALE
SCALE íM~0.54j


Os mesmos dados são comparados na Fig. 7.33. mas considerando os dados de fluidos
apresentados na Tabela 7.1 e a curva de permeabilidade relativa com valor de n-1.5.
Fig. 7.33 » Fluxo fracionario de oleo para o caso HERA, fluido compressivel - kr //=L5
Os resultados mostrados na Fig. 7.32 para diferentes razões de mobilidade mostram o excelente desempenho do SCALE para o caso unidimensional testado. A comparação entre os resultados da hipótese de fluido incompressível e compressível mostra o melhor desempenho do método em situações onde apenas os parámetros dependentes da saturação são considerados. Apesar da não-linearidade do sistema de equações possuir características bastante distintas nos dois casos, os procedimentos incluídos pelo SCALE durante o processo de solução destes sistemas são influenciados por esta diferença de comportamento dos fluidos.
A primeira influência no SCALE ocorre durante a solução dos subdomínios. onde é eliminado qualquer erro nas aproximações para o campo de pressões, na consideração de fluido incompressível. Também durante a solução da malha grossa verifica-se a influência desta consideração. No procedimento implementado, os termos dependentes da saturação, que compõem as transmissibilidades entre os blocos, permanecem constantes durante o passo de tempo em questão, enquanto os termos que dependem das pressões da malha grossa são alterados durante o processo de convergência. Apenas no caso de fluido compressível existe a influência da evolução das pressões na malha grossa. Embora não sendo os únicos
determinantes para a qualidade da solução obtida pelo SCALE. estas diferenças de consideração têm forte influência nos resultados.
Estes exemplos estão limitados a casos de fluidos de baixa compressibilidade. A análise de fluxo trifásico, com a presença da fase gás. não foi objeto deste trabalho e estudos posteriores terão que ser realizados para analisar efeitos desta natureza.
7.4.2	Densidade dos fluidos
Esta seção apresenta, apenas para as seções transversais, o desempenho do método multiescala para diferentes relações entre a densidade do óleo e da água. Para os casos ARES (Fig. 7.34) e ODIN (Fig. 7.35) são apresentadas respostas em termos de fluxo fracionário do óleo para a situação onde a densidade do óleo é maior do que da água e na situação inversa, quando a densidade do óleo é menor. Nos dois casos os valores de massa específica são aqueles informados na Seção 7.1 e as condições de operação são as reportadas na Tabela 7,2.
a - po &gt; pH
b - po &amp;lt;pw
Fig. 734 - Fluxo fracionário de óleo para o caso ARES para diferentes relações de
a - po &gt;	b - po &amp;lt;pw
Fig. 7.35 - Fluxo fracionário de óleo para o caso ODIN para diferentes relações de
densidade entre o óleo e a água - kr «=1,5
Tanto para o caso homogêneo (ARES) quanto para o caso heterogêneo (ODIN) o método apresentou melhor ajuste com a resposta da malha fina em situações onde a densidade da água é maior, o que caracteriza situação de fluxo mais estável, Nesta situação a influência de diferentes discretizações é maior e a metodologia tem melhor desempenho.
7.4.3	Heterogeneidade do meio
O procedimento de mudança de escala implementado no simulador SCALE permite a consideração dos efeitos da variação das permeabilidades no deslocamento dos fluidos. Ao associar subdomínios a cada bloco da malha grossa, a formulação possui a capacidade de captar estes efeitos e de transmiti-los para a malha mais grossa através dos termos dependentes da saturação, presentes no cálculo das transmissibilidades. Além do ajuste destes termos, a mudança de escala das permeabilidades absolutas também atua no sentido de ajustar os termos geométricos destas transmissibilidades.
Fig. 7.36 - Caso AJAX - Vazão de óleo e água no poço produtor
Em lodos estes casos heterogêneos foram consideradas curvas de permeabilidades relativas com n~l,5 e analisadas as respostas obtidas com os dois métodos de mudança de escala de permeabilidade absoluta implementados: método de Le Loc'h e solução do problema de fluxo monofásico na região do subdomínio. Devido à similaridade dos resultados, apenas para o caso LOKI são apresentadas as soluções pelos dois métodos.
O resultado da Fig. 7.36 mostra que o nível de heterogeneidade representado pelo caso AJAX não acarretou perda de precisão ao se efetuar a redução de escala. Isto pode ser observado quando se compara a solução do SCALE com a da malha 9 vezes mais refinada (GF). Verifica-se no entanto, neste exemplo, uma oscilação na resposta ao final de cada uma das curvas de produção, o que é comentado a seguir.
Conforme mencionado na Seção 7.4. a questão central da metodologia proposta neste trabalho é a obtenção de boas aproximações para as saturações nos subdomínios. uma vez que estas aproximações refletem no comportamento do deslocamento das fases na malha grossa. O fluxo de uma determinada fase através de uma face de um bloco da malha grossa é, pelo menos em termos de saturações, definido pelo comportamento dos subdomínios. Valores de saturações desta fase que provoquem uni avanço ou retardo da frente, quando comparados com estes mesmos valores na malha fina, influenciam nos valores das variáveis
primárias obtidos na malha grossa. No caso, por exemplo, de se estabelecer uma transmissibilidade para uma conexão da malha grossa maior do que aquela que estaria presente na malha fina. isto acarreta em um fluxo excessivo através desta conexão. Em consequência, o bloco a montante é sujeito a uma retirada maior de massa da fase, enquanto o bloco a jusante sofre efeito contrário. Este desajuste influi no comportamento das variáveis primárias da malha grossa, causando uma oscilação em seus valores ao longo do tempo. Este efeito, que é mais pronunciado nos tempos finais, pode ser visualizado através de oscilações apresentadas nas respostas em termos de vazões de água. Observa-se nas curvas de vazão de água para o caso AJAX (Fig. 7.36) e THOR (Fig. 7.37) que existe uma pequena oscilação na parte final da curva, que é mais evidente no caso AJAX.
Fig. 7.37 - Caso THOR - Vazão de óleo e água no poço produtor
Nestes exemplos não foram incluídos os resultados que consideram o critério GEO para ponderar as saturações dos subdomínios durante o cálculo da saturação representativa. Esta ausência é justificada pelo baixo desempenho deste critério quando comparado com o critério que considera o produto permeabilidade absoluta-mobilidade total. Nos casos heterogêneos, mais do que nos casos homogêneos, esta diferença é notada pelo fato deste último critério utilizar os valores das permeabilidades absolutas de cada bloco do subdomínio, Estas características presentes nos procedimentos de ajuste dos termos de
fluxos contribuem para a boa precisão na obtenção de instantes de irrupção, como observado ein todos os exemplos.
Quanto ao desempenho das técnicas de mudança de escala das permeabilidades absolutas verificou-se. para os casos testados, pouca variação entre os dois métodos implementados e que estão apresentados apenas na Fig. 7.38. Para os demais casos heterogêneos o desempenho é semelhante. No método numérico que utiliza a simulação de fluxo monofásico, em todos os casos, exceto para o caso LOKI. foi utilizada a média dos valores de permeabilidade efetiva obtidos pelo método dos elementos finitos e pelo método das diferenças finitas.
Fig. 7.38 - Caso LOKI - Vazão de óleo e água no poço produtor
Para o método numérico, observou-se que as rotinas do módulo EFFPERM. da biblioteca HOMLIB. em alguns casos, não apresentam resultados coerentes quando o cálculo é feito através do método dos elementos finitos. Esta ocorrência foi verificada por Ribeiro (1996) que citou que tais problemas sempre ocorrem em casos mais heterogêneos, coni desvio-padrão logarítmico muito elevado. No caso LOKI. por exemplo, para o subdomínio 3x3 cujos blocos da diagonal possuem permeabilidades de 0,00001 mD ñas direções v e y. a permeabilidade efetiva calculada por diferenças finitas foi praticamente zero enquanto pelo método dos elementos finitos foi 80 mD. nas duas direções. Nas
As seções transversais heterogêneas estão representadas neste item pelos casos JUNO e ODIN. onde os resultados consideram a relação p0&lt;pw entre as densidades das fases. Para o caso JUNO a vazão de injeção prescrita foi 317.9 m /d (2000 bbl/d) e as curtas de produção estão apresentadas na Fig. 7.39. Os resultados para o caso ODIN foram obtidos de acordo com a Tabela 7.2 e estão representados na Fig, 7.40,
De acordo com os resultados apresentados nesta seção, verifica-se um desempenho muito bom do simulador SCALE no tratamento de heterogeneidades, principalmente em termos de obtenção do instante de irrupção da água no poço produtor, tanto nas seções planas quanto nas seções transversais. As heterogeneidades principais (barreiras e canais) apresentam resultados menos ajustados do que os problemas onde a heterogeneidade é mais suave, quando comparados em termos da produção da água injetada,
7.4.4	Ajuste dos termos fonte
Algumas observações importantes, relacionadas ao ajuste dos termos fonte do sistema de equações apresentados no Capítulo 5 e representados pelos poços, devem ser destacadas a partir dos resultados destas aplicações a reservatórios heterogêneos.
Vã2ão cte óíe© (ms/d)	Vaitão dê óleo
Fig. 7.39 » Caso JUNO - Vazão de óleo e água no poço produtor
Fig. 7.40 - Caso ODIN - Vazão de óleo e água no poço produtor
O ajuste destes termos efetuado pelo SCALE ocorre através de alterações no índice de produtividade e ñas transmissibilidades das conexões entre poços e blocos. Tratados desta forma, as vazões de óleo, em qualquer caso, tendem, antes da irrupção da água no poço produtor, a se alinhar com a resposta da malha grossa. Isto ocorre porque, nas regiões onde as saturações permanecem iguais aos seus valores iniciais, o método computacional SCALE não é capaz de executar nenhum tipo de ajuste. No caso específico dos poços, o único ajuste realizado antes da chegada da frente de água é através da alteração no índice de produtividade, mais particularmente, no valor da permeabilidade absoluta considerada para a conexão bloco-poço. O SCALE adota sempre o valor da permeabilidade do bloco fino onde o poço esta localizado. Observa-se no caso AJAX (Fig. 7.36). onde a permeabilidade do bloco do poço na malha fina não difere muito dos blocos vizinhos, que esta alteração ajusta razoavelmente bem a vazão de óleo nos tempos anteriores ao instante de irrupção. No caso THOR (Fig. 7.37). é possível verificar claramente este ajuste, principalmente pela diferença que existe entre a permeabilidade do bloco do poço e seus blocos vizinhos.
7.4,5	Curvas de permeabilidades relativas
Alguns dos casos descritos na Seção 7.1 serão agora solucionados considerando as outras curvas de permeabilidades relativas apresentadas na Fig. 7.1: potências n=i e n=2.
A seqüência de curvas de fluxos fracionários apresentada a seguir para os casos HERA (Fig. 7.41), ZE U S ('.Fig. 7.421 AJ AX (Fig. 7.43) e J U N O (Fi g. 7.44) fo i o b tida c o n s i derando as condições estabelecidas na Tabela 7.2, exceto para o caso JUNO onde a vazão de injeção especificada foi 79.5 m7d (500 bbl/d),
Esta seqüência mostra, para todos os casos, um melhor desempenho do SCALE quando se considera curvas de permeabilidades relativas associadas a frentes de deslocamentos mais suaves, como ocorre com as curvas com //=1 e com h=L5. Nestes casos não existe uma frente abrupta se deslocando, o gradiente de saturações é mais suave e o comprimento da frente é maior. Verifica-se então que o método é mais hábil em calcular valores mais precisos de saturações representativas para os subdomínios em situações de menores gradientes de saturações.
Fig. 7.41 - Caso HERA - kr n-1 e n=2~ Fluxo fracionário de óleo
Fig. 7.42 - Caso ZEUS - kr w=l e n=2- Fluxo fracionário de óleo
Fig. 7.43 - Caso AJAX -kr w=le n=2- Fluxo fracionário de óleo
a -krn-l
b-krn=2
Fig. 7.44 - Caso JUNO - Fluxo fracionário de óleo
Para verificar se os resultados obtidos pelo procedimento de mudança de escala implementado no simulador SCALE são influenciados pelas velocidades de fluxo, os casos ARES e JUNO foram solucionados com diferentes vazões de injeção no poço injetor, quais sejam: q=79,5 e 795 m7d (500 e 5000 bbl/d). mas mantendo as demais condições de operação descritas na Tabela 7.2.
As Fig. 7.45 e Fig, 7.46 representam soluções para as diferentes condições de operação especificadas para os casos ARES e JUNO, apresentadas em termos de vazões de água e óleo no poço produtor.
Para o caso homogêneo (ARES) o resultado mostra um melhor desempenho na situação com maiores velocidades de fluxo, enquanto para o caso heterogêneo (JUNO) o desempenho é semelhante para as duas situações. Neste caso o procedimento multiescala é fortemente influenciado pelas heterogeneidades no sentido de melhorar a resposta.
A análise das soluções para condições de operações nos poços diferentes das apresentadas neste capítulo, ou seja, pressão constante no fundo para o poço produtor e vazão de óleo especificada no poço injetor. não serão incluídas por não serem relevantes em termos de desempenho do simulador SCALE. O comportamento das respostas, quando outras condições de operação são especificadas, segue as mesmas tendências apresentadas para as situações aqui abordadas.
60,00
50.00
Vazão (m3/d)	Vazão (m3/d)
40.00
30.00
20.00
1 0.00
0.00
0.00
600.00
1200.00
í (dias)
1800.00
a - qinj=79,5 m3/d
b - qinj=795 m Vd
Vazão (m3/d)	Vazão (m3/d)
0.00
1000.00
1500.00
2000.00
2500.00
3000.00
t (dias)
0.00
20.00
40.00	60.00
t(dias)
80.00
100.00 120.00
b “ qinj=795 m7d
7.6	Comparação com PSEUDO
Nesta seção é feita uma comparação do simulador mui tí escala SC ALE e o módulo PSEUDO do simulador comercial ECLIPSE. O objetivo desta seção é comparar qualitativamente duas propostas diferentes de mudança de escala: a primeira baseada apenas em elementos de simulação numérica e a segunda baseada nos conceitos tradicionais de pseudo-funções mui ti fásicas. Uma vez que a simulação mui ti escala não gera pseudo-curvas de permeabilidades relativas, a comparação será feita em termos das respostas globais dos problemas.
O método escolhido para gerar as pseudo-funções para os blocos foi o de Kyte e Berry (1975) modificado, denominado Pore Volume Weighted Pseudos, por apresentar a melhor resposta em comparação com os outros métodos disponíveis no PSEUDO. Foram também geradas pseudo-funções para os poços, utilizando-se o método proposto por Emanuel e Cook (1974). As pseudo-funções para cada bloco da malha grossa e para cada poço foram geradas a partir de uma simulação completa da malha fina, utilizando o simulador ECLIPSE. Estas curvas foram adicionadas ao modelo grosseiro e a solução final obtida também através do ECLIPSE, É importante salientar que esta simulação da malha fina remove uma importante fonte de erro das pseudo-funções, que é a sua dependência da localização do conjunto de blocos que cada uma delas representa, dentro da malha fina completa, A correção deste erro não pode, obviamente, ser realizada quando a técnica é aplicada a casos reais.
A seguir são comparadas as vazões nos poços produtores para os casos HERA (onde foram considerados /z-1 e saturações iniciais iguais a 0.12). AJAX e THOR, Os gráficos das Figuras 7.47 a 7.49 apresentam esta comparação para os três casos.
As soluções para o caso HERA, apresentadas na Fig. 7.47, mostraram uma coincidência total entre a resposta do SCALE, do PSEUDO e a solução de referência na malha fina. Esta concordância pode ser considerada como uma espécie de validação dos métodos, uma vez que este caso aborda unia situação bastante simples, que inclusive, como citado anteriormente neste capítulo, não representa uma aplicação potencial para as técnicas de mudança de escala.
Fig. 7.47 - Caso HERA - Comparação entre SCALE e PSEUDO
Durante a execução do PSEUDO foram observados alguns problemas mencionados em diversos artigos técnicos que analisam o método de Kyte e Berry (1975). Em todos os três casos foi observada a geração de curvas de permeabilidades relativas não monotônicas e com valores maiores que 1. Estes valores foram suprimidos manualmente para permitir a execução do simulador ECLIPSE durante a fase de solução da malha grossa com as pseudo-funções incluídas. O efeito desta remoção foi discutido no Capítulo 3,
Foi verificada também a influência da consideração ou não das pseudo-funções para poços na resposta dos problemas. Em todos os casos apresentados foram consideradas as funções propostas por Emanuel e Cook (1974) durante a etapa de geração de pseudo-funções. A não consideração destas funções pelo PSEUDO leva à obtenção de resultados bem menos ajustados dos que os apresentados nesta seção. Este fato evidencia a importância do ajuste dos termos fontes, relacionados aos poços, e mostra que as funções de Kyte e Berry (1975) utilizadas isoladamente não são suficientes para gerar boas aproximações para a malha grosseira, principalmente quando a resposta é analisada em termos da solução global do problema, nestes casos representada pelos fluxos nos poços.
A Fig. 7.48 mostra um melhor desempenho do procedimento SCALE para o caso AJAX sob as condições testados neste exemplo, quando comparado com o módulo PSEUDO.
Fig. 7.48 - Caso AJAX - Comparação entre SCALE e PSEUDO
No Capítulo 3. o caso THOR foi utilizado para exemplificar as dificuldades de utilização das pseudo-funções de Kyte e Berry (1975) e a grande variação de desempenho do método em relação a utilização ou não de permeabilidades relativas direcionais. A Fig. 7.49 apresenta a solução do SCALE para este problema e permite compará-la com a melhor solução apresentada, naquele capítulo, pelo método de Kytee Berry (1975).
Unia importante observação em relação a estes resultados é que todas as considerações que foram necessárias adotar para melhorar as respostas do PSEUDO, apresentadas no Capítulo 3. são automaticamente tratadas pelo algoritmo desenvolvido. O efeito das permeabilidades relativas direcionais, por exemplo, são consideradas ao se realizar ajustes de transmissibilidades através de todas as faces dos subdomínios. É justamente por incluir estes tratamentos, dentro das etapas de ajuste do algoritmo multiescala. que o procedimento SCALE permitir obter resultados como o apresentado na Fig. 7.49.
Fig. 7.49 - Caso THOR - Comparação entre SC ALE e PSEUDO
7,7	Discussão dos Resultados
A mudança de escala efetuada através de qualquer metodologia constitui na busca de uma solução próxima daquela obtida pela malha fina mas utilizando uma malha menos refinada. Principalmente devido à dificuldade de se obter uma equivalência plena entre diferentes representações do meio poroso, ao se adotar diferentes discretizações deste meio contínuo, a resposta da escala reduzida será sempre uma aproximação. Portanto, a aplicação da técnica é mais adequada a problemas onde existe grande diferença entre a solução na malha fina e na malha grossa e apenas em tal situação são aceitáveis os erros associados ao processo de mudança de escala. E dentro deste contexto que serão analisados os resultados apresentados neste capítulo,
♦ Opções de ajuste no algoritmo multiescala
1. Como considerar as condições de contorno tipo Dirichlet
Em qualquer destas situações, o melhor procedimento para tratar as condições de contorno em termos de saturações é prescrever diretamente as saturações dos blocos da malha grossa nos pontos auxiliares do contorno.
2.	Como calcidar as saturações Sp para ajustar as transmis sibil idades da malha grossa
A formulação apresentada possui um elemento chave que é o ajuste das transmissibilidades das conexões da malha grossa. No entanto, conforme os resultados apresentados nas seções anteriores, a definição de um procedimento geral para obtenção das saturações que irão realizar este ajuste (Passo 1 da Fig. 7.50). não é uma questão trivial. Fatores como geometria de fluxo e forma das frentes de deslocamento têm influência na obtenção desses valores representativos de saturação e todo o processo de solução depende fortemente da qualidade destes valores. Os termos de fluxo ajustados por estas saturações (Passo 2 da Fig. 7,50). devem estar relativamente próximos aos valores da malha fina, uma vez que estes mesmos fluxos irão determinar a distribuição das saturações dentro de cada subdornínio, ao final de cada passo de tempo. Desta forma, todo o processo passa a depender da representad vidade destas saturações.
Dentro de um mesmo suporte verificou-se que a ponderação das saturações do subdomínio que baseia-se no produto permeabilidade absoluta-mobilidade total produz bons resultados, principalmente em meios heterogêneos. Em relação aos blocos selecionados dentro dos subdomínios houve variações nos resultados. De uma forma gerah o critério desenvolvido apresentou bons resultados para situações onde as linhas de fluxo são bem definidas, como é o caso das seções no plano ,tz, o rnesmo não ocorrendo nos casos onde características geométricas e distribuição de permeabilidades absolutas determinam a distribuição das linhas de fluxo, A verificação desta dependência da geometria das linhas de
fluxo abre oportunidades para o desenvolvimento de uma metodologia mais geral baseada nesta evidência.
3.	Como considerar as condições de contorno tipo Neumann
A distribuição dos fluxos ajustados ao longo das faces externas dos subdomínios (Passo 3 da Fig. 7.50) ao final de cada passo de tempo, não tem uma influência tão grande na qualidade dos resultados como o cálculo das saturações representativas para os subdomínios. Os procedimentos de distribuição implementados apresentaram bom desempenho, enquanto a ausência de ponderação mostrou resultados bastante ruins.
1
——&gt;
( sri . fo )
Fig. 7.50 - Esquema dos passos executados pelo algoritmo multiescala, a cada passo de tempo
» Consistência entre as escalas
A evolução consistente do modelo ao longo do tempo depende basicamente da etapa de ajuste dos subdomínios que utiliza os fluxos acertados da malha grossa (Passo 3 da Fig. 7.50). Uma vez que não existe nenhum processo explícito de convergência entre os subdomínios. esta foi a forma encontrada para estabelecer uma relação direta entre a solução nas duas escalas. O fato dos subdomínios adjacentes serem ajustados pelos mesmos fluxos derivados das mesmas conexões da malha grossa e de tal acerto ser realizado a cada passo de tempo, não implica em problemas de convergência nesta etapa.
* Desempenho do método
O ajuste das transmissibilidades das fases proposto neste trabalho, obtido através de uma seqüência de troca de informações entre a escala fina e grossa, mostrou-se efetivo pelo desempenho do método em obter bons resultados em termos de tempo de irrupção do fluido injetado, nos poços produtores. A produção subsequente dos fluidos injetados mostrou-se menos ajustada para os casos onde os gradientes de saturação da frente de deslocamento são maiores e/ou que consideram reservatórios heterogêneos. Nesta última situação, lai comportamento reflete a dificuldade em obter a equivalência de meios heterogêneos através dos processos de mudança de escala das permeabilidades absolutas. Os dois métodos implementados para realizar esta mudança de escala não produziram uma diferença significativa na resposta e outras metodologias podem ser testadas como, por exemplo, o cálculo das permeabilidades equivalentes a cada passo de tempo, o que permite considerar as alterações nas condições de contorno.
Em relação aos demais efeitos analisados e baseando-se nos resultados apresentados neste capítulo, é possível afirmar:
•	para os dois níveis de redução de escala testados. 9 e 25 vezes, verificou-se que. em termos qualitativos, a resposta do simulador SCALE tende a acompanhar a precisão da malha fina equivalente:
•	um melhor desempenho foi verificado em problemas de transporte com fluídos incompressíveis:
•	o método apresentou respostas mais próximas da solução da malha fina em situações onde a relação de densidade de fluidos caracteriza fluxo estável;
•	os resultados independem das condições de produção especificadas para os poços, tanto em termos do tipo de condição prescrita para os poços, quanto em termos dos valores das vazões de injeção;
*	através do ajuste dos termos fonte das equações de balanço de massa, é possível obter uma boa concordância das produções nos poços produtores, mesmo antes da irrupção da água injetada.
Capítulo 8
Conclusões e Recomendações
8.1	Conclusões
Esta tese trata do tema mudança de escala na simulação numérica de fluxo multifásico em meios porosos e apresenta o desenvolvimento de um simulador multiescala como forma de realizar esta tarefa. Em relação às linhas de pesquisa atualmente em desenvolvimento, este trabalho situa-se no ramo que considera apenas parâmetros de simulação numérica e não utiliza o recurso tradicional de geração de pseudo-curvas mui ti fásicas.
A vantagem mais evidente do simulador multiescala desenvolvido é a unificação das etapas de solução e mudança de escala, que é realizada de fornia implícita pelo código computacional, sem a interferência do usuário. Desta forma, a mudança de escala passa a ser uma opção dentro do processo de solução numérica e não é necessária a construção de modelos numéricos com diferentes malhas.
A modelagem computacional implementada considera que. a cada passo de tempo da simulação numérica, numa determinada escala, estão disponíveis informações mais detalhadas do fluxo em uma escala mais refinada. Desta forma, é possível levar em conta detalhes obtidos em refinamentos do modelo da malha grossa. A influência das heterogeneidades numa certa região, por exemplo, pode ser considerada mesmo se esta região for modelada através de um único bloco na malha grossa. Informações sobre a distribuição de 171
saturações nos subdomínios são utilizadas para ajustar o fluxo relativo das fases na malha menos refinada. fazendo com que a solução neste nível represente uma boa aproximação da solução obtida com a simulação da malha fina completa.
Além de fornecer uma resposta numa escala reduzida, o simulador multiescala permite considerar diretamente modificações relativas às condições de fluxo, as quais ocorrem com freqiiência em estudos de reservatórios. Alterações nas vazões e nas posições dos poços não acarretam tarefas adicionais durante a simulação numérica, o que significa uma grande vantagem sobre os procedimentos usuais que consideram pseudo-curvas, já que elas precisam ser reconstruídas toda vez que estes tipos de modificações são introduzidas no modelo numérico.
Os resultados das simulações numéricas conduzidas sob esta nova forma de modelagem computacional, com e sem os efeitos da gravidade, mostraram que a metodologia é capaz de apresentar boas respostas para as situações de fluxo testadas. Estes resultados mostraram também que o procedimento proposto sofre influência da disposição das linhas de fluxo e da forma da frente de deslocamento do fluido injetado. Para os exemplos que consideram efeitos gravi taci onais foi possível obter resultados muitos bons, pois em tal situação existe uma melhor definição das linhas de fluxo.
Em relação ao desenvolvimento do algoritmo multiescala, as principais conclusões são:
•	é possível realizar a mudança de escala durante a solução do sistema de equações, através de ajustes nos termos das equações da escala menos refinada, sem o uso de pseudo-funções multifásicas:
•	a seqüência de soluções aproximadas nos subdomínios. proposta no algoritmo, é capaz de fornecer informações relativas à distribuição de saturações nestas regiões;
•	a metodologia desenvolvida não apresenta diferença significativa de desempenho para os dois níveis de redução de escala testados: 9 e 25 vezes:
•	a interpolação de pressões da malha grossa não constitui uma opção robusta para estabelecer condições de contorno tipo Dirichlet para os subdomínios; a opção de não interpolar apresenta melhor desempenho;
•	o fluxo de informações implementado é capaz de ajustar adequadamente os termos dependentes de saturações nas equações da malha grossa:
•	o ajuste dos termos geométricos é necessário e de fundamental importância, principalmente no ajuste dos termos fonte das equações;
•	a verificação da forte influência da geometria das linha de fluxo na seleção dos biocos dos subdomínios não permite a definição de um critério único para seleção das regiões dos subdomínios que contribuem para o ajuste dos fluxos. De acordo com os casos testados foram estabelecidos os seguintes suportes para estas regiões:
♦	FACE para fluxo unidimensional, ern seções planas;
♦	ÁREA I para fluxo bidimensional, em seções planas;
♦	ÁREA2FACE para seções transversais:
•	a ponderação das saturações destes suportes pelo produto permeabilidade absoluta-mobilidade total é um procedimento eficaz para obter o ajuste dos fluxos, principalmente em meios heterogêneos;
•	a evolução consistente da modelagem multiescala proposta depende do ajuste dos subdomínios ao final de cada passo de tempo, obtido quando eles são resolvidos com condição de contorno tipo Neumann;
•	a distribuição dos fluxos ajustados da malha grossa, ao longo das faces externas dos subdomínios, baseada na ponderação pelas transmissibilidades das fases é eficaz para estabelecer as condições de contorno tipo Neumann e variações na forma desta distribuição não causam mudança significativa na qualidade dos resultados:
•	apesar dos bons resultados obtidos para exemplos que consideram fluidos compressíveis, a metodologia tem melhor desempenho em problemas com fluidos incompressíveis e também para relações de densidades que caracteriza fluxo estável;
•	não existe grande variação nos resultados para diferentes velocidades de fluxo:
• a presença de heterogeneidades, incluindo desde o contraste suave de permeabilidades absolutas até heterogeneidades principáis como canais e barreiras, não constitui fator de limitação de aplicação da técnica.
Um aspecto importante que pode ser observado nas aplicações do simulador SCALE é que as respostas obtidas aproximam-se bastante das soluções da malha fina em situações que caracterizam aplicações potenciais para a técnica de mudança de escala. Estas situações são representadas por problemas onde existe uma grande diferença entre os resultados da malha fina e da malha grossa, de tal fornia que os erros associados ao processo de mudança de escala estejam situados em níveis aceitáveis.
A principal conclusão do trabalho é que a formulação proposta e desenvolvida neste trabalho possui vantagens claras sobre os processos usuais que utilizam pseudo-funções e os resultados numéricos mostraram que é possível obter bons resultados com esta forma de tratamento. Existe, no entanto, uma série de investigações que devem ser realizadas nesta área. A próxima seção apresenta algumas recomendações sobre tópicos a estudar, os quais podem ajudar a reforçar e estender a viabilidade de tal procedimento.
8.2	Recomendações
/Algumas recomendações listadas a seguir são fruto de observações preliminares feitas durante o processo de elaboração do simulador SCALE e por não terem sido aprofundadas neste trabalho possuem um caráter especulativo. Outras recomendações são extensões naturais, decorrentes dos limites impostos inicialmente durante a definição da abrangência desta pesquisa.
1. Critério adaptativo de seleção das regiões dos subdomínios
constatação pode dar origem a um criterio adaptativo de seleção dos suportes FACE. AREA1 e AREA2 que seria função das geometrías das linhas de fluxo em cada um dos subdomínios. A implementação desta forma de seleção das regiões dos subdomínios poderá levar a urna melhoria na qualidade dos resultados.
2.	Métodos de mudança de escala das permeabilidades absolutas
Os dois métodos de mudança de escala das permeabilidades absolutas implementados e testados neste trabalho não tiveram muita influência na qualidade dos resultados, pelo menos para as situações testadas, No entanto, como a equivalência do meio é de extrema importância durante o processo de mudança de escala, a investigação da influência de outros métodos de obtenção destes valores equivalentes é um tópico que merece ser desenvolvido. Dentro do algoritmo multiescala. esta etapa podería se deslocar para dentro do passo de tempo, de tal forma que as permeabilidades equivalentes pudessem ser recalculadas a cada modificação das condições eni torno das regiões definidas pelos subdomínios.
3.	Influência de parâmetros numéricos de controle do simulador
Dentre os fatores que influenciam os resultados obtidos pela simulação multiescala. alguns não foram investigados, quais sejam:
•	a influência do tamanho de passo de tempo na qualidade da resposta: apesar do algoritmo implementado determinar correções nas equações da malha grossa a cada passo de tempo, à medida que o número de ajustes aumenta, ou seja, à medida que o número de passos de tempo aumenta, a resposta tende a melhorar. O controle do tamanho do passo de tempo numa simulação convencional é determinado, geral mente, por limites máximos estabelecidos para as variações das variáveis primárias. No caso da simulação multiescala. a determinação deste passo de tempo estaria também associada à qualidade da solução.
•	a influência dos limites estabelecidos para os critérios de convergência durante a solução dos subdomínios: da mesma forma que diferentes passos de tempo podem influenciar na qualidade da resposta de uni simulador multiescala. valores limites estabelecidos dentro do
ciclo de convergência das iterações Newtonianas podem levar à obtenção de soluções mais ou menos próximas da solução de referência. Esta investigação é restrita ao segundo ciclo de soluções dos subdomínios, quando condições de contorno tipo Neumann são prescritas.
4.	Diversidade de tipos de curvas de permeabilidade relativa na malha fina
Todo o desenvolvimento apresentado neste trabalho considera que apenas um tipo de rocha, quanto às curvas de permeabilidade relativa, está presente em cada região que dá origem a um subdomínio. Esta consideração simplifica a tarefa de mudança de escala, uma vez que um único conjunto de curvas de permeabilidades relativas está associado a cada subdomínio. Modificações substanciais teriam quer ser realizadas no procedimento desenvolvido para considerar vários tipos de rocha dentro de um mesmo subdomínio, uma vez que um único valor de saturação é obtido para cada fase e através da relação única entre permeabilidades relativa e saturação obtêm-se os valores que corrigem as transmissibilidades na malha grossa.
5.	Malha grossa não uniforme
Uma extensão a este trabalho e que pode produzir melhorias nos resultados é a possibilidade de geração de uma malha de simulação não uniforme. Durlofsky et al. (1995) mostrou que a utilização de malhas mais refinadas em regiões com maiores gradientes conduz a melhores resultados, embora, dependendo da. fornia a ser implementada, possa não permitir a uma redução de escala significativa. Mesmo assim, esta consideração é de extrema importância, por exemplo, em situações onde estão presentes grandes variações nas propriedades petro físicas, as quais não são adequada mente tratadas pela mudança de escala e requerem melhor representação no modelo numérico de simulação.
6.	Múltiplas escalas
através de sucessivas simulações nos subdomínios, obter-se-ia um valor final de Sp para os blocos de uma malha bem menos refinada. No sentido contrário, indo da malha grossa até a escala mais refinada, sucessivas simulações dos sub domínios com condição de contorno tipo Neumann ajustariam os subdomínios nas diferentes escalas.
8.	Pressão capilar
A pressão capilar não foi considerada neste trabalho pois sua importância nas escalas envolvidas é pequena. No entanto, no caso de se considerar múltiplas escalas, onde a descrição das heterogeneidades ocorre em diferentes níveis - escala de laboratório, de litofáceis, de simulação numérica. - as forças capilares assumem importância, havendo então a necessidade de se efetuar um procedimento unificado, alterando tanto as curvas de permeabilidades relativas quanto as de pressão capilar.
9.	Computação paralela
Uma extensão importante a este trabalho é a investigação do uso de computação paralela durante a simulação dos subdomínios. Uma vez que as condições de contorno estabelecidas em cada subdomínio. num determinado instante, não dependem de parâmetros obtidos no passo de tempo em questão, é possível solucionar todos os subdomínios ao mesmo tempo, utilizando-se processadores em paralelo. Outro fator que facilita a paralelização da solução dos subdomínios é o fato de não se buscar a convergência entre eles, o que caracteriza a independência das tarefas . O custo computacional deste procedimento, embora demonstrado no Capítulo 4 como sendo viável é uma questão primordial para a viabilidade prática da simulação multiescala.
10.	Seleção Dinâmica dos Subdomínios
A princípio podem existir situações onde o gradiente de saturações numa determinada região permanece constante durante algum tempo, e a solução desta região não precisa ser atualizada até que uma alteração significativa seja verificada. Embora aparentemente simples, a exclusão de algumas regiões durante a solução dos subdomínios pode não ser assim Ião atrativa, uma vez que existe uma grande dependência entre as soluções nas diferentes escalas, como mencionado ao final do Capítulo 7.
Testes preliminares nesta área foram conduzidos neste trabalho, considerando como critério de seleção dos subdomínios a variação das saturações com o tempo num determinado bloco da malha grossa. Os resultados mostraram que a qualidade da resposta cai muito se poucos blocos forem selecionados. Verificou-se que, mais do que a resposta de cada uma destas regiões, a evolução da solução com o tempo, mesmo nos subdomínios com pequenos gradientes de saturação, tem grande influência na qualidade final da solução. Critérios de seleção dos subdomínios devem, portanto, ser investigados criteriosamente com o objetivo de otimizar o binômio qualidade da solução-tempo de resposta.
1L Fluxo trifásico
A extensão do algoritmo desenvolvido para fluxo bifásico água-óleo para fluxo trifásico, considerando também o gás. parece, a princípio, ser apenas uma adequação dos procedimentos, de tal forma que sejam incluídos mais relações entre permeabilidades relativas e saturações das fases e o cálculo destas saturações nos subdomínios. De qualquer forma, a influência de fluidos muito compressíveis não foi verificada e constitui numa extensão natural a este trabalho.
Referencias Bibliográficas
Abou-Kassem, J. H., Aziz, K., (1985), "‘Analytical Well Models for Reservoir Simulation,” SPEJ. agosto, p 573-579.
Alabert, F. G., Corre, B., (1991), "‘Heterogeneity in a Complex Turbiditic Reservoir: Impact on Field Development,” SPE 22902, em SPE 66th Annual Technical Conference &amp;amp; Exhibition , 6-9 outubro, Dallas, Estados Unidos.
Alcouffe, R. E. et al , (1991). “The Multi-Grid Method for the Diffusion Equation with Strongly Discontinuous Coefficients,” SIAM Journal on Scientific and Statistical Computing, v 2, n 4, p 430-454.
Amaziane, B„ (1993), “Global Behavior of Compressible Three-Phase Flow in Heterogeneous Porous Media Trimsport in Porous Media, v. 10, p 43-56.
Aziz, K., (1994), “Notes for Petroleum Reservoir Simulation,” Stanford University.
Aziz, K., Odeh, A. S.. (1981), “Comparison of Solutions to a Three-dimensional Black-Oil Reservoir Simulation Problem,” Journal of Petroleum. Technology, vol. 33, p 13-25.
Aziz, K., Settari, A., (1979), Petroleum Reservoir Simulation, Elsevier Applied Science Publishers.
Babu, D. K., Odeh, A S., Al-Khalifa, A, J., McCann, R. C., (1991), “The Relation Between Wellblock and Wellbore Pressures in Numerical Simulation of Horizontal Wells,” SPERE, agosto, p 324-328.
Barker, J. W., Thibeau, S.. (1996), “A Critical Review of the Use of Pseudo Relative Permeabilities for Upscaling ,” SPE 35491, em European 3-D Reservoir Modeling Conference, 16-17 abril, Stavanger, Noruega.
Bear, J. , (1972), Dynamics of Fluids in Porous Media, American Elsevier, New York.
Behie, A., Forsyth, P. A.. (1983a), “Multigrid Solution of the Pressure Equation in Reservoir Simulation,” SPEJ, p 623-632.
Behie, A., Forsyth, P. A., (1983b), “Multigrid Solution of Three-dimensional Problem With Discontinuous Coefficients Applied Mathematics and Computation, n 13, p 229-240.
Beier, R. A. . (1992), “Pseudorelative Permeabilities From Fractal Distributions,” SPE 24371, em SPE Rocky Mountain Regional Meeting, 18-21 maio, Casper, Estados Unidos.
Berger, M. e Oliger, J., (1984), “Adaptative Mesh Refinement for Hyperbolic Partial Differential Equations,” J. Comp. Phys, vol.53, p 484-512.
Biterge, M. B., Ertekin, T„ (1992), “Development and Testing of a Static/dynamic Local Grid Refinement Technique,” J PT, p 487-495.
Bittencourt, M. L., (1996), “Métodos Iterativos e Multigrid Adaptáveis em Malhas não Estruturadas,” Tese de Doutorado, FEM, Universidade Estadual de Campinas.
Bourgeat, A., (1984), “Homogenized Behavior of Two-Phase Flows in Naturally Fractured Reservoirs With Uniform Fractures Distribution,” Computer Methods in Applied Mechanics and Engineering, n 47, cap. 10, p 205-216.
Brand, C. W., (1992), “CB Linear Solver - User’s Guide.”
Brandt, A„ (1977), “Multi-level Adaptive Solutions to Boundary-value-problems,” Mathematics Computational, 31 , n 138. p 333-390.
Celia, M. A., Rajaram H., Fernand, L. A., (1993), “A Multi-scale Computational Model for Multiphase Flow in Porous Media,”, Advances in Water Resources, v 16, n 1, p 81-92.
Reservoirs,” SPE 29127, em 13th SPE Symposium on Reservoir Simulation, 12-15 fevereiro, San Antonio, Estados Unidos.
Coats, K. H., Dempsey, J. R., Henderson, J. H. , (1971) “The Use of Vertical Equilibrium in Two Dimensional Simulation of Three-Dimensional Reservoir Performance,” SPEJ , março, p 63-71.
Coats, K. H., Nielsen, R. L. Terhune, M. H. Weber, G., (1967) “Simulation of Three-Dimensional Two-phase Flow in Oil and Gas Reservoirs,” SPEJ, dezembro, p 277-288.
Collins, D. A., Mourits, F. M., (1991), “Multigrid Methods Applied to Near-well Modeling in Reservoir Simulation,” SPE 23607.
Davies, B. J., Haldorsen H. H., (1987), “Pseudofunctions in Formations Containing Discontinuous Shales: A Numerical Study,” SPE 16012, em 9th SPE Symposium on Reservoir Simulation, 1-4 fevereiro, San Antonio, Estados Unidos.
Dendy, J. E„ Jr., McCormick, S. F„ Rugde, J. W., Russell, T. F„ Schaffer, S., (1989), “Multigrid Methods for Three-dimensional Petroleum Reservoir Simulation,” SPE 18409, em SPE Symposium on Reservoir Simulation, Houston, Estados Unidos.
Ding Yu, (1995), “Scaling-up in then Vicinity of Wells in Heterogeneous Field,” SPE 29137, SPE Symposium on Reservoir Simulation, 12-15 de fevereriro, San Antonio, Estados Unidos.
Ding Yu, Lemonnier, P. A., (1993), “Development of Dynamic Local Grid Refinement in Reservoir Simulation,” SPE 25279, SPE Symposium on Reservoir Simulation, New Orleans, Estados Unidos.
Durlofsky, L. J., Behrens, R. A., Jones, R. C., Bemath, A., (1991), “Numerical Calculation of Equivalent Grid Block Permeability Tensors for Heterogeneous Porous Media,” Water Resources Research, maio, v 27, n 5, p 699-708.
Durlofsky, L. J., Behrens, R. A., Jones, R. C., Bemath, A., (1995). “Scale Up of Heterogeneous Reservoirs Descriptions.” SPE 30709, em SPE Annual Technical Conference &amp;amp; Exhibition , 22-25 outubro, Dallas, Estados Unidos.
Durlofsky, L. L, Jones. R. C., Milliken, W, J., (1997), “A Nonuniform Coarsening Approach for the Scale Up of Displacement Processes in Heterogeneous Porous Media.” Advances in Water Resources, v 20, n 5-6, p 335-347.
Emanuel, A. S., Cook, G. W., (1974), "Pseudo-Relative Permeability for Well Modeling,” SPE 4731, SPEJ, fevereiro.
Payers, F. J., Hewett, T. A., (1992), “A Review of Current Trends in Petroleum Reservoir Description and Assessment of the Impacts on Oil Recovery,” Advances in Water Resources, vol 15, n 6, p 341-365.
Fernandes,?., Girdinio, P., Repetto, M., Secondo G., (1992), "‘Refinement Strategies in Adaptive Meshing,” ¡EEE Transactions on Magnetics, v 28, n 2, p 1739-1742.
Ferragut L., Montenegro R., Plaza A.. (1994), “Efficient Refinement/Desrefinement Algorithm of Nested Meshes to Solve Evolution Problems,” Communications in Numerical Methods in Engineering, v 10. p 403-412.
Forysth, P. A. e Sammon, P. H., (1985), “Local Mesh Refinement and Modeling of Faults and Pinchouts,” SPE 13524, em SPE Symposium on Reservoir Simulation, Dallas, Estados Unidos.
Gosselin, O., Thomas, J. M.. (1990), “Domain Decomposition Methods in Reservoir Simulation Coupling Well and Full Field Models 2nd European Conference on the Mathematical of Oil Recovery, D. Guérillot e O. Guillon Editors, p 237-253, Paris.
Guérillot, D. R. , Verdiere S., (1995), “Different Pressure Grids for Reservoir Simulation in Heterogeneous Reservoirs.” SPE 29148 , em 13th SPE Symposium on Reservoir Simulation. 12-15 fevereiro, San Antonio, Estados Unidos.
Guzman, R. E„ Giordano, D., Payers, F. J., Godi, A., Aziz K., (1996), “Evaluation of Dynamic Pseudo Functions for Reservoir Simulation”, SPE 35157, em SPE Annual Technical Conference &amp;amp; Exhibition , 6-9 outubro, Denver, Estados Unidos.
Hawthorne, R. G., (1974). “A Model of Fluid Displacement in Multilayer Porous Media Including Capillary Pressure Effects Between Layers,” SPE 5126, 49th Annual Technical Conference and Exhibition, Houston, Estados Unidos.
Hearn, C. L., (1971), “Simulation of Stratified Waterflooding by Pseudo Relative Permeability Curves,” Journal of Petroleum Technology, n 23, julho, p 805-813.
Hermitte, T. e Guerillot, D., (1993), “A More Accurate Numerical Scheme for Locally Refined Meshes in Heterogeneous Reservoirs,” SPE 25261, em SPE Symposium on Reservoir Simulation, New Orleans, Estados Unidos.
Hewett, T. A., Berhens, R. A., (1990), “Considerations Affecting the Scaling of Displacements in Heterogeneous Permeability Distributions,” SPE 20739, em SPE 65th Annual Technical Conference &amp;amp; Exhibition , 23-26 setembro, New Orleans, Estados Unidos.
Hewett, T. A., Berhens, R. A., (1991), “ Scaling Laws in Reservoir Simulation and Their Use ina Hybrid Finite Difference/Streamtube Approach to Simulating the Effects of Permeability Heterogeneity.” Reservoir Characterization II, eds. L. W. Lake, H. B. Carrol e T. C. Wesson, Academic Press, p 402-411.
Holden, L., Lia, O., Madsen, R. A., Mostad, P., Rusten, T., Skorstad, A., (1994), “ Scaling and Representation of Absolute Permeability,” Profit Report - NR-note SAND/02/94, Norwegian Computing Center. P O. Box 114 Blindem, N-0314 Oslo, Noruega.
Jacks, H.H., Smith, O, J. E„ Mattax, C.C., (1973) “The Modeling of a Three-Dimensional Reservoir With a Two-dimensional Reservoir Simulator - The Use of Dynamic Pseudo Functions SPE 4071, SPEJ, junho, p 175-185.
King, P. R., (1989), “The Use of Renormalization for Calculating Effective Permeability,” Transport in Porous Media, n 4, p 37-58.
Kossack, C. A., Aasen, J. O., Opdal, S. T., (1989), “Scaling-Up Laboratory Permeabilities and Rock Heterogeneities With Pseudo Functions for Field Simulations,” SPE 18436, I Oth SPE Symposium on Reservoir Simulation, 6-8 fevereiro, Houston, Estados Unidos.
Kyte, IR. Berry, D. W., (1975), “New Pseudo Functions to Control Numerical Dispersion”, SPEJ, agosto, p 269-276.
Lake, L. W., (1989), Enhanced Oil Recovery, Prentice-Hall, Englewood Cliffs, New Jersey.
Lasseter, T. J., Waggoner, J. R., Lake, L. W., (1986) "‘Reservoir Heterogeneites and Their Influence on Ultimate Recovery,” Reservoir Characterization, editado por Lake, L. W. E Carrol, H. B. Jr., Academic Press, Inc., Orlando, Estados Unidos.
Le Loc h, G., (1987), “Étude de la composition des perméabilités par des méthodes variationnelles”, These de Doctorat, École de Mines de Paris, Paris, França.
Lee. J. Kasap, E., Kelkar, M. G., (1995), “Development and Application of a New Upscaling Technique,” SPE 30712, SPE Annual Technical Conference &amp;amp; Exhibition, 22-25 outubro, Dallas, Estados Unidos.
Lemouzy, P. M., Romeu, R. K., Morelon, I. F., (1993) “A New Scaling-Up Method to Compute Relative Permeability and Capillary Pressure for Simulation of Heterogeneous Reservoirs,” SPE 26660, SPE 68th Annual Technical Conference &amp;amp; Exhibition , 3-6 outubro, Houston, Estados Unidos.
Lim, K. T., Schiozer, D. J„ Aziz, K., (1995), “A New Approach for Residual and Jacobian Array Construction in Reservoir Simulators,” SPE Computers Applications.
Mansoori. J., (1994), “A Review of Basic Upscaling Procedures: Advantages and Disadvantages,” Yarlis, J. M. &amp;amp; Chambers , R, L. Eds., Stochastic Modeling and Geostatistics: Principles, Methods and Case Studies, AAPG Computer Applications in Geology #3, cap 7, AAPG, Tulsa.
McCormick, S. F., (1989), “Multilevel Adaptive Methods for Partial Differential Equations”, SIAM Publications, Philadelphia.
McKeon,T. J. E W-S Chu, (1987), “A Multigrid Model for Steady Flow in Partially Saturated Porous Media,” Water Resources Research, vol. 23, n 4, p 542-550.
Nacul, E. C., (1991), “Use of Domain Decomposition and Local Grid Refinement in Reservoir Simulation,” Tese de Doutorado, Stanford University.
Odeh, A. S.. (1981), "Comparison of Solutions to a Three-dimensional Black-oil Reservoir Simulation Problem,” Journal of Petroleum Technology, vol. 33, p 13-25.
Palagi, C., (1992) "Generation and Application of Voronoi Grid to Model Flow in Heterogeneous Reservoirs,” Tese de Doutorado, Stanford University.
Peaceman, D. W., (1977), Fundamentals of Numerical Reservoir Simulation, Elsevier Scientific Publishing Company, New York.
Peaceman, D. W., (1978), "Interpretation of Well-Block Pressures in Numerical Reservoir Simulation with NonSquare Grid Blocs and Anisotropic Permeability,” SPEJ, junho, p 531-534.
Peaceman, D. W., (1978), "Interpretation of Well-Block Pressures in Numerical Reservoir Simulation - Part 3 : Some Additional Well Geometries, ” SPE 16976, SPE Annual Technical Conference and Exhibition, 27-30 setembro, Dallas, Estados Unidos.
Pickup, G. E., Ringrose, P. S., Jensen, J. L., Sorbie, K. S., (1994), " Permeability Tensors for Sedimentary Structures,” Math. Geol., n 26, p 227-250.
Pickup, G. E., Sorbie, K. S., (1994), "Development and Application of a New Two-Phase Scaleup Method Based on Tensor Permeabilities,” SPE 28586, SPE 69th Annual Technical Conference &amp;amp; Exhibition , 25-28 setembro. New Orleans, Estados Unidos.
PSEUDO Reference Manual, (1994), 95A Release, Intera Information Technologies Limited, England.
Quandalle, P. e Besset, P., (1983), "The Use of Flexible Gridding for Improved Reservoir Modeling,” SPE 12239, SPE Symposium on Reservoir Simulation, San Francisco, Estados Unidos.
Quandalle, P. e Besset, P., (1985), “Reduction of Grid Effects due to Local Sub-gridding in Simulations Using a Composite Grid,” SPE 13527, SPE Symposium on Reservoir Simulation, Dallas, Estados Unidos.
Rame M., Killough, J. E., (1992), "A New Approach to Flow Simulation in Highly Heterogeneous Porous Media ,” SPE Formation Evaluation, setembro. p 247-254.
Renard, P, Marsily, G., (1997), “ Calculating Equivalent Permeability: a Review?’ Advances in Water Resources, v20. n 5-6, p 253-278.
Ribeiro, R. F. J. M. C., (1996), “Cálculo da Permeabilidade Equivalente em Meios Heterogêneos pelo Método dos Elementos Finitos Híbridos,” Tese de Mestrado, UNICAMP.
Rodrigues, J. R. P., (1994), “Refinamento Localizado de Malha no Espaço e no Tempo em Simulação de Reservatórios Petrolíferos,” Tese de Doutorado, Universidade Federal do Rio de Janeiro.
Rubin, B., Barker, J. W., Blunt, M. J., Christie, M. A., Culverwell, I. D., Mansfield, M., (1993), “Compositional Reservoir Simulation With a Predictive Model for Viscous Fingering,” SPE 25234 , 12th SPE Symposium on Reservoir Simulation, 28 fevereiro-3 março, New Orleans, Estados Unidos.
Saad, N. Cullick, A. S. Honarpour, M. M., (1995), “Effective Relative Permeability in Scale-Up and Simulation,” SPE 29592, SPE Rocky Mountain Regional/ Low-Permeability Reservoirs Symposium, 20-22 março, Denver, Estados Unidos.
Schiozer, D. J., (1994), “Simultaneous Solution of Reservoir and Surface Facilities,” Tese de Doutorado, Stanford University.
Soerdamo, E. , Taggart, I. J., Paterson, L., (1994), “Leng th-Dependent Pseudo function: An Improved Up-Scaling Method in Black-Oil Simulation,” SPE 28754, em SPE Asia Pacific Oil&amp;amp;Gas Conference, 7-10 novembro, Melbourne, Australia.
Starley, G. P., (1988), “A Material Balance Method for Deriving Interblock Water/Oil Pseudofunctions for Coarse-Grid Reservoir Simulation,” SPE 15621, SPE Reservoir Engineering, agosto, p 977-983.
Stone, H. L., (1970), “Probability Model for Estimating Three-phase Relative Permeability,” Trans SPE of AIME, n 249, p 214-218.
Stone, H. L., (1991), “Rigorous Black Oil Pseudo Functions,” SPE 21207, em SPE Symposium on Reservoir Simulation, Anaheim, Estados Unidos.
Tan, T. B., (1995), “Estimating Two and Three Dimensional Pseudo-Relative Permeabilities with Non-Linear Regression SPE 29129 , em 13th SPE Symposium on Reservoir Simulation, 12-15 fevereiro, San Antonio, Estados Unidos.
Thibeau, S., Barker, J. W., (1995), “Dynamical Upscaling Techniques Applied to Compositional Flows SPE 29128 , em 13th SPE Symposium on Reservoir Simulation, 12-15 fevereiro, San Antonio, Estados Unidos.
Verdiere S., Guerillot, D.. Thomas, Jean-Marie, (1996), "Dual Mesh Method for Multiphase Flows in Heterogeneous Reservoirs,” 5th European Congress on the Mathematical of Oil Recovery, 3-6 setembro, Leoben, Austria.
Vinsome, P. K. W., (1976), “Orthomin, an Iterative Method Suitable for Solving Sparse Sets of Simultaneous Linear Equations,” SPE 5729, Fourth Symposium on Numerical Simulation of Reservoir Performance, 19-20 fevereiro, Los Angeles, Estados Unidos.
White, C. D. e Horne, R. N., (1987), “Computing Absolute Transmissibility in the Presence of Fine Scale Heterogeneity,” SPE 16011, em 9th SPE Symposium on Reservoir Simulation, 1-4 fevereiro, San Antonio, Estados Unidos.
Yamada, T., Hewett, T., (1995). “Production-Based Effective Vertical Permeability for a Horizontal Well,” SPERE. n 10, vol. 3, p 163-168.
Zhang, FT R., Sorbie, K. S., (1995), “The Upscaling of Miscible and Immiscible Displacement Processes in Porous Media,” SPE 29931, International Meeting on Petroleum Engineering, 14-17 novembro, Beijing, China.
Anexo I
Simulador SCALE
Este anexo faz uma descrição das principais características do programa e mostra exemplos de validação do mesmo.
LI Descrição do Código
O código computacional consta de 110 rotinas implementadas em linguagem FORTRAN 77, com algumas facilidades do FORTRAN 90, como, por exemplo, alocação dinâmica de memória. Algumas destas rotinas basearam-se em subprogramas do simulador META, desenvolvido por Evandro Nacul (Nacul (1991).
1.1.1	Alocação dinâmica de memória
A principal característica do SCALE é a utilização do recurso de alocação de dados em forma de ponteiros dinâmicos. O objetivo ao utilizar recurso é otimizar o programa em termos de alocação de memória, bem como agilizar o acesso aos dados. Além disso, esta forma de programação permitiria a minimização do uso de memória numa opção de alocação dinâmica de subdomínios, embora não tenha sido implementada neste trabalho.
Nesta forma de implementação, todos os dados referentes à malha grossa possuem o mesmo endereço, vetor A, e informações distintas possuem ponteiros específicos: 1, nl,...nl51, os quais são definidos em função das características do problema: número de blocos e poços, quantidade de informações relativas a fluido e rocha, etc.. Do mesmo modo, todos os dados referentes à malha fina e aos subdomínios ficam armazenados no vetor B, conforme ilustrado na Fig. 11. Neste caso, numa extensão do programa, onde nem todos os subdomínios precisariam ser solucionados em todos os passos de tempo, seria possível utilizar a alocação dinâmica do espaço de memória necessário durante a solução destes subdomínios. No vetor B, os ponteiros de 1 a m67 referem-se a dados fornecidos para a malha fina, e são dimensionados em função da quantidade de dados fornecidos para este nível. A partir da posição m68(l), a alocação é feita em função das dimensões e do número de subdomínios a serem resolvidos no passo de tempo em questão. Com esta estratégia não é necessário definir tamanho máximo e fixo para os vetores; eles são estimados em função dos dados fornecidos e utilizados para definir as dimensões de A e B. As posições dos ponteiros são então calculados e situam-se dentro da dimensão estimada.
1
ml ml
B -
mói
m68(í)
m69(í)
/ri51
ml37(z)
Fíg. 1.1 - Vetores e ponteiros utilizados para o armazenamento dos dados no SCALE
1.1.2	Métodos iterativos de solução
/. Baseado no procedimento ORTHOMLN
Este método de solução implementado consiste num conjunto de rotinas computacionais desenvolvidas especi ficamente para simuladores de reservatório, desenvolvidas por Brand (1992), aqui denominado CB (Clemens Brand), e implementadas no simulador META (Nacul (1991)). Foi construído para resolver de forma iterativa um sistema de equações com alto grau de esparsidade. matrizes não simétricas, não assumindo a priori nenhum padrão de esparsidade, estrutura de banda ou ordenação dos blocos. Utiliza o procedimento ORTHOMIN, que é uma generalização do método dos gradientes conjugados (Vinsome (1976)), e um precondicionador construído por fatoração LU incompleta. A versão implementada por Brand é o ORTHOMIN(Zr) reinicializado, no qual um conjunto de k direções de busca, que atendem a condição de ortogonalidade, é construído durante os primeiros k passos de iterações. No passo k+h o processo é reinicializado.
II.	Baseado em técnicas rnultimalhas
Outro procedimento de solução do sistema de equações lineares, baseado na técnica rnultimalhas, foi desenvolvido e testado neste trabalho. O objetivo foi verificar o fator de aceleração dos métodos iterativos que se obtém ao aplicar esta técnica aos sistemas linearizados, como é o caso da maioria das abordagens adotada para solução dos sistemas não lineares, em simulação de reservatórios.
No Anexo II está descrita a implementação do algoritmo rnultimalhas no simulador de reservatórios desenvolvido neste trabalho e são apresentados alguns exemplos, onde são considerados problemas bidimensionais, fluxo multifásico e malhas uniformes, sem refinamento local.
Aplicações da técnica rnultimalhas na área de fluxo de fluidos em meios porosos podem ser encontradas em Behie e Forsyth (1983a), Behie e Forsyth (1983b), McKeon e Chu (1987), Dendy et al. (1989) e Collins e Mourits (1991). Estas investigações têm como objetivo desenvolver metodologias que reduzam o esforço computacional e melhorem a precisão das soluções de alguns problemas de difícil solução numérica encontrados neste campo, como refinamento localizado e problemas com elevado número de incógnitas.
1.2	Principais Fluxogramas
A solução numérica de qualquer domínio pelo SCALE, num determinado passo de tempo, está representada na Fig. 1.2. Este é o procedimento usual em simuladores de reservatório que optam pela linearização do sistema não-linear de equações.
Fig. 1.2 - Ciclo de iterações v durante solução da malha grossa ou dos subdomíníos, num passo de tempo At
O fluxograma da Fig. 1.3 representa o fluxo das principais rotinas do programa conforme o algoritmo multiescala desenvolvido, cujo esquema é apresentado na Fig. 4.3, no Capítulo 4. Neste fluxograma CC significa a condição de contorno prescrita para cada um dos subdomínios, nsd o número de sub domínios a serem resolvidos e K a permeabilidade absoluta.
Fig. 1.3 » Fluxograma principal do simulador SCALE
1.3	Validação
L3.1 CasoSPE
Como o SC ALE foi desenvolvido à partir de um simulador trifásico, denominado CB, este primeiro teste de validação refere-se a um problema de deslocamento de gás por óleo e a validação será feita com o simulador comercial IMEX. A malha considerada foi 10x10 e apenas uma camada na direção z, com os seguintes valores de permeabilidade: Kx=400 mD e Ky=200 mD. O problema considera dois poços, sendo um produtor, localizado em (10,10,1) e outro injetor de gás em (1,1.1). As condições de operação especificadas são: produção constante de óleo igual a 3179.6 nr/d (20000 bbl/d) e injeção constante de gás a 2832 sm 7d (100 M scf/d). Todos os demais dados são os reportados no problema proposto em Odeh (1981).
As Fig. 1.4 e 1.5 permitem comparar as produções acumuladas de gás e as pressões no fundo dos poços produtor e injetor, segundo os dois simuladores. Estes gráficos apresentam uma boa concordância entre os resultados obtidos com o SCALE e o IMEX.
3.00
2.50
2.00
CO
Ê
cu
o
1.50
1 .00
0.50
0.00
Caso SPE
0 IMEX
o SCALE
0.00	400.00	S00.00	1200.00	1600.00	2000.00	2400.00	2800.00	3200.00	3600.00
t ídias)
Fig. 1.4 - Caso SPE - Produção acumulada de gás
Fig. 1,5 - Caso SPE - Pressão de fundo nos poços
1.3.2	Casos A.IAX e ZEUS
Estes dois casos são exemplos considerados neste trabalho e todos os parâmetros do problema e condições de operação estão descritos no Capítulo 7. Estes dois exemplos representam esquemas de um quarto de five-spoi de injeção de água, meios heterogêneos e consideram um poço produtor e um poço injetor. A validação do SCALE é feita para estes casos com o simulador comercial ECLIPSE. A Fig. 1.6 apresenta a vazão da água injetada no poço produtor para o caso AJAX, enquanto a Fig. 1,7 representa a razão água-óleo no poço produtor, para o caso ZEUS.
Os dois resultados validam o simulador SCALE e apresentam pequenas diferenças em relação ao simulador ECLIPSE.
RAO	Qw ím3/ct)
Fig. 1.6 - Caso AJAX - Comparação da vazão de água no poço produtor
Fig. 1.7 - Caso ZEUS - Comparação da razão água-óleo no poço produtor
Anexo II
Algoritmo Multimalhas
Durante a elaboração do simulador SCALE houve a necessidade de definir formas de solução do sistema de equações não lineares. Para este problema, uma vasta bibliografia na área de métodos numéricos considera a técnica multimalhas uma alternativa mais econômica que os métodos tradicionais, mas poucas aplicações são encontradas no ambiente de simuladores de reservatórios. O trabalho desenvolvido e apresentado neste anexo representa uma investigação preliminar do desempenho da técnica e analisa seu comportamento em aplicações práticas.
II. 1 Descrição da Técnica Multimalhas
A idéia básica dos métodos multimalhas é a discretização das equações diferenciais parciais em uma série de malhas com diferentes níveis de refinamento, todas uniformes. A técnica utiliza este conjunto de malhas com diferentes discretizações com o objetivo de eliminar diferentes frequências de erro durante a solução do sistema de equações: malhas mais refinadas removem erros de alta frequência enquanto malhas mais grosseiras removem erros de baixa freqüência. Desta forma, o procedimento multimalhas é utilizado como um fator de aceleração de convergência da solução do problema. Em cada uma das malhas aplica-se esquemas simples de relaxação como Jacobi e Gauss-Seidel, uma vez que o objetivo não é obter a solução nos níveis mais grosseiros e sim a solução do problema utilizando várias malhas.
Na técnica multimalhas estão presentes importantes mecanismos: a transferência de informações entre uma malha grossa e outra, mais fina , nos dois sentidos, e a atenuação do erro.
O funcionamento do método multimalhas pode ser detalhado da seguinte forma. Seja uma sequência de malhas G k, com a malha mais refinada denominada G/!, com espaçamento hk, onde h\ &gt; /o &gt; • •• &gt; hh. Seja a equação diferencial parcial linear da forma Lu = f, onde L é o operador diferencial, u a função incógnita e f o termo fonte. Na malha mais refinada esta equação pode ser representada como:
L/!tf = fft,	(II. 1)
onde L/! é o operador discreto do problema no nível Gh.
Seja u/! a solução aproximada da solução exata uZ/, então o resíduo em G/3 será dado por:
? = tf-tf tf	(II.2)
Uma vez que vZí = u - tf. a forma residual da primeira equação pode ser colocada como:
L‘v* = r",	(II.3)
que é resolvida por algum processo de relaxação até a taxa de convergência se tomar baixa. Estes processos de relaxação são eficientes na eliminação dos erros de alta frequência e à partir do momento que v'! passa a não sofrer alterações na escala da malha Gh, ou seja, quando a convergência começa a se deteriorar, a aproximação de v/! continua numa malha mais grosseira. G , isto é:
1/	= Vri,	(II.4)
onde é a aproximação de na malha grosseira e tfz é o operador de transferência de G11 para GH, também denominado operador de restrição.
onde 1/ é o operador de transferência de GH para Gh, denominado Operador de Interpolação. A equação (11.5) mostra como a solução da malha grosseira é utilizada para corrigir a solução da malha refinada. Depois que a solução na malha mais grosseira, v , é obtida, a solução para a malha fina mais próxima é corrigida, utilizando-se esta expressão. Após a correção, a solução na malha fina é suavizada por relaxação.
Se for considerado genericamente uma sequência de malhas G \ com	este
processo assume um caráter recursivo, onde a transferência de resíduos é feita ao longo da seqüência Gh até G!, com a solução por relaxação sendo obtida em cada uma das malhas. Uma vez alcançado o nível G1 a solução é obtida de forma direta ou iterativa. Neste instante, o processo recursivo retoma, indo de G1 até G11. Nesta etapa de correção, as soluções dos níveis mais grosseiros são utilizadas para corrigir as soluções dos níveis mais refinados e novamente os métodos de relaxação são aplicados para suavizar as soluções. O processo de ir da malha mais refinada para a mais grosseira e de novo para a mais refinada é denominado Ciclo Multimalha.
Este é um dos procedimentos da técnica multimalhas e pode ser encontrado, por exemplo, em Behie e Forsyth (1983), sendo denominado Esquema Corretivo por se basear nas correções que a solução da malha grosseira efetua na solução da malha refinada, e tem sua aplicação restrita a problemas lineares,
No caso de malha composta, que surge em problemas com refinamento local, por exemplo, esta seqüência constitui numa série de malhas encaixadas, o que significa G^1 c: GÁ, para todo k. McCormick (1989) apresenta esquemas com malhas sucessivas, com espaçamento como potência de 2, onde os operadores de transferência assumem então as formas Lf/? e IJlii •
= W + v"	(11.6)
rj
como a função incógnita na malha grossa, e onde é um operador de transferência. A variável aproxima 1/	. que é a solução completa representada no nível grosseiro.
O algoritmo multimalhas não linear FAS pode ser derivado a partir de dois pontos de vistas duais. O primeiro é aquele onde a malha grosseira é usada para acelerar a convergência dos componentes suaves do resíduo da malha refinada, enquanto o segundo baseia-se na correção para a malha grosseira de tal forma que sua solução seja igual a da malha refinada.
II.	1.1 Operadores de transferência entre malhas
Os operadores de transferência citados anteriormente desempenham papel crucial dentro do contexto da técnica multimalhas. As características destes operadores variam em função do problema, do método numérico utilizado na discretização das equações e da relação existente entre as malhas grossa e refinada.
A transferência de parâmetros da malha grossa para a malha fina é definida de acordo com o operador de interpolação ou prolongamento (jJ! ) e pode ser feita de várias formas. Se os pontos da malha grossa não são subconjuntos dos pontos da malha fina, a transferência da solução pode ser feita utilizando-se média ponderada entre os pontos vizinhos. No caso de coincidência de pontos entre as malhas, a transferência das incógnitas deve ser direta da malha fina para a malha grossa. No caso de problemas não lineares a ponderação acelera a convergência, mesmo quando os pontos da malha grossa são subconjuntos dos pontos da malha refinada. Esta aceleração ocorre porque a ponderação ajuda a eliminar oscilações que tenderiam a existir na aproximação da malha fina.
A transferência das variáveis da malha fina para a malha grossa é realizada através dos operadores de restrição	que podem ser tratados de forma similar ao operador de
interpolação. No caso da transferência direta, sem ponderação, o procedimento é denominado injeção de resíduos, enquanto no caso com ponderação o procedimento é denominado Full Weighting.
II.1.2	Métodos de relaxação
O erro da solução de um processo iterativo pode ser expresso em termos de séries discretas de Fourier, podendo ser representado por varios componentes de diferentes comprimentos de onda. Erros locais se referem aqueles componentes com comprimentos de onda da ordem da dimensão da malha. Já os erros globais são os componentes com comprimento de onda maiores do que a dimensão da malha. O principal efeito dos métodos de relaxação é a redução dos erros locais. Esta técnica é eficiente na eliminação de erros locais, ou de alta frequência, que têm um comprimento de onda da ordem do espaçamento da malha, sendo pouco eficiente na eliminação dos erros de grande comprimento de onda. Esta propriedade se manifesta por uma rápida redução do erro (que são principalmente os erros locais) nas primeiras relaxações. Esta etapa é seguida por uma taxa de convergência muito baixa, durante a qual os erros globais são gradualmente reduzidos.
Dentre os processos de relaxação, ou suavização, mais utilizados estão o método de Gauss-Seidel e algumas de suas variações, como o red-black Gauss-Seidel e a decomposição incompleta LU.
IL2 Aplicação na Area de Fluxo de Fluidos em Meios Porosos
A aplicação da técnica multimalhas na área de fluxo de fluidos em meios porosos ainda é bastante limitada. Embora existam alguns trabalhos que abordam problemas lineares e não lineares, no caso específico de simulação de reservatórios os métodos multimalhas têm sido utilizados apenas na solução de problemas relativamente simples, como equações envolvendo apenas a variável pressão, alguns exemplos onde as equações de poços não são consideradas de forma implícita e problemas em regime permanente. Os artigos referidos a seguir apresentam algumas aplicações nesta área.
Behie e Forsyth (1983a) aplicaram técnica multimalhas, através da generalização da técnica proposta por Alcouffe et al. (1981), para o caso de equações diferenciais lineares em domínio heterogêneo, bidimensional. A partir da equação da pressão com contraste abrupto e desconti nu idades nas transmissibilidades, o método foi utilizado para solucionar o sistema gerado a partir da discretização de problemas, tanto simétricos quanto não simétricos. Seu desempenho foi comparado com algoritmos baseados em métodos de gradientes conjugados precondicionados: Incomplete Cholesky Conjugate Gradient (ICCG) para os casos simétricos e ILU/ORTHOMIN para os problemas não simétricos.
Behie e Forsyth (1983b) desenvolveram também um algoritmo multimalhas para domínio tridimensional, considerando equações da pressão e situações com coeficientes descontínuos e anisotropia.
McKeon e Chu (1987) aplicaram a técnica para solução de um sistema de equações algébricas não lineares, originado das equações diferenciais que regem o fluxo de fluidos em meios porosos parcial mente saturados, em regime permanente. Neste trabalho, a abordagem multimalhas adotada foi o FAS, sendo a função transferida da malha fina para a malha grossa através de média ponderada utilizando nove pontos, enquanto a interpolação da correção da malha grossa para a malha fina foi feita utilizando o esquema de interpolação bilinear. Resultados numéricos de problemas envolvendo a pressão como incógnita se ajustaram às soluções analíticas e mostraram que o tempo de solução requerido varia linearmente com o número de incógnitas, enquanto para outros métodos iterativos de solução, como Line Sucessive Over Relaxation (LSOR), esta relação é uma função não linear do número de incógnitas.
Dendy et al. (1989) apresentaram um método multimalhas que aumenta a eficiência de solução de problemas tridimensionais com múltiplas variáveis por bloco, forte assimetria e acoplamento de poços. No entanto, os resultados envolveram apenas a equação da pressão, sem poços implícitos. Dendy et al. verificaram seu desempenho comparando com ILU/ORTHOMIN, precedido por esquema de ordenação red-black, num processo denominado RS/1LU(O).
Collins e Mourits (1991) apresentaram um simulador de reservatórios, considerando 3 fases, formulação Black-Oil, onde associaram elementos multimalhas ao método de decomposição de domínios, mas neste caso foi considerada uma abordagem diferenciada dos conceitos básicos definidos para o método multimalhas. A formulação apresentada por estes autores envolve técnicas de refinamento, desenvolvidas dentro do contexto de multimalhas, e método de decomposição de domínio, a nível das matrizes, aplicado na solução de sistemas não lineares. Nesta abordagem, a malha grossa é inicialmente resolvida e através de pseudo-funções, tenta-se estabelecer uma estimativa inicial para a solução da malha fina, usando como operador de transferência a interpolação linear. Estes autores consideraram que as técnicas de relaxação não são adequadas, citando que no caso de malhas híbridas ( que consideram refinamento em volta de um poço, por exemplo), a interpolação linear não é uma boa aproximação. Também, como foi citado por Dendy et al. (1989), na presença de anisotropia, as técnicas de relaxação pontuais não conseguem atenuar os componentes do erro, que são oscilatórios numa direção e suaves na outra direção. Collins e Mourits (1991) adotaram então a solução da malha grossa apenas para estabelecer uma condição de contorno do tipo Dirichíet para a malha refinada.
O desenvolvimento apresentado foi baseado no método FAS, onde as equações da malha grossa são alteradas para ajustar as equações da malha refinada. As pseudo funções multifásicas foram utilizadas para ajustar a malha refinada, numa iteração multimalhas, à malha grossa. As pseudo-funções apresentadas por Stone (1991) foram estendidas para ajustar as equações do poço, na malha grossa, às vazões obtidas quando se usa refinamento local ao redor do poço. Estas pseudo-funções executam a tarefa de transferir informações entre a malha grossa e a malha refinada, envolvendo apenas o termo fonte da equação de conservação. Quando utilizadas num contexto de técnica multimalhas, as pseudo-funções assumem o caráter dinâmico e podem ser geradas de forma automática.
Uma forma de transferência de informações entre as malhas refinada e grossa apresentada por Collins e Mourits (1991), e que desempenha o papel do operador de restrição da técnica multimalhas convencional, é definida pela expressão:
onde I we.j c representa o índice de produtividade na malha grossa; o índice m se refere a última iteração; os índices c e/’se referem a malha grossa e refinada, respectivamente. Ao se utilizar as informações da malha refinada, as razões água-óleo e gás-óleo se ajustam entre as duas malhas.
Os passos do algoritmo multimalhas proposto por Collins e Mourits (1991), considerando a malha grossa e uma malha refinada foram:
Passo P. Resolve a malha grossa.
Passo 2: Resolve a malha refinada usando a malha grossa para impor condição de contorno tipo Dirichlet.
Passo 3: Atualiza a malha grossa alterando as pseudo-funções para ajustar as vazões da malha refinada.
Passo Calcula o novo resíduo da malha grossa. Se maior que a tolerância, retoma para o passo 1.
Passo 5: Incrementa o tempo da malha grossa escolhendo um novo passo de tempo.
Biterge e Ertekin (1992) modificaram e simplificaram a metodologia original do método multimalhas, proposta por Brandt (1977), com aplicações em problemas parabólicos não lineares, e mostraram aplicações em fluxo multifásico em reservatórios. Estes autores apresentaram uma metodologia com refinamento multimalhas cuja seqüência de solução obedece as seguintes etapas:
Passo /: Obtém uma solução do problema para todo o domínio utilizando a malha grossa.
Passo 2: Gera um nível mais refinado nas regiões de gradientes elevados.
Passo 3: Define condição de contorno do tipo Dirichlet na interface da malha grossa e da malha refinada.
Passo 4: Resolve as equações na malha refinada.
Passo 5: Gera um segundo nível mais refinado obedecendo ao critério do gradiente, com o mesmo tipo de condição de contorno.
Passo 6: Soluciona este segundo nível e continua o processo até obter a precisão desejada.
Rodrigues (1994) também utilizou a técnica multimalhas em problemas com refinamento local, através da aplicação do processo FAC (Fast Adaptive Composite) durante a solução do sistema de equações lineares. Este processo é uma extensão natural do método multimalhas convencional e seus fundamentos foram introduzidos por McCormik (1989). O FAC é uma versão do procedimento padrão das técnicas multimalhas para dois níveis de
refinamento e pode ser diretamente aplicado a problemas com refinamento local, ficando a técnica mais simplificada. Nele, a malha grossa aproxima os componentes globais do erro e a malha refinada aproxima os componentes locais oscilatórios, e nenhuma outra malha é necessária. Este procedimento alterou também o método original substituindo o método de relaxação aplicado as malhas uniformes por um método tradicional, que pode ser direto ou iterativo.
IL3 Desenvolvimento e Implementação de um Algoritmo Multimalhas num Simulador de Fluxo
O comportamento da técnica multimalhas ainda não está completamente definido para alguns tipos de problemas, principalmente aqueles regidos por equações altamente não lineares e não elípticas. Na maioria dass aplicações optou-se sempre por trabalhar diretamente com o operador não linear empregando técnicas multimalhas não linear, geral mente FAS. Nenhuma abordagem trata da solução do sistema linear, envolvido na simulação de reservatórios, baseando-se nos mecanismos básicos da técnica, quais sejam: seqüência de malhas com diferentes refinamentos, utilizadas para eliminar diferentes frequências de erro, e transferência de solução e correção entre malhas.
Neste trabalho foi implementado um algoritmo multimalhas linear, baseado no Esquema Corretivo descrito no item II. 1„ aplicado ao sistema de equações lineares obtido pelo processo de linearização das equações de balanço de massa, apresentadas no Capítulo 5. Esta metodologia é uma outra forma de se tratar a não linearidade das equações e foi também utilizada por Jespersen (1983) na solução das equações de Euler. A opção de se trabalhar com o sistema linearizado é devida ao fato da maioria dos códigos computacionais existentes estarem implementados desta forma e para investigar uma abordagem não descrita na literatura, no âmbito de simuladores de fluxo de reservatórios de petróleo. Diferentemente das implementações encontradas na literatura relacionada a fluxo em meios porosos, onde multimalhas se relaciona quase sempre com refinamento local, o algoritmo aqui descrito será utilizado para obter a solução em todo o domínio. Desta forma, todas as malhas do conjunto utilizado possuem a mesma dimensão, diferentes discretizações e se estendem sobre todo o
domínio do problema. A solução é obtida apenas para a malha mais refinada, sendo as demais utilizadas apenas para correção ou aproximação inicial.
II.3.1	Algoritmo
Passo l: Monta o sistema linear JG UG = - Rg para a malha grosseira (nível 0).
Passo 2: Obtém a solução Uq até convergência.
Passo 3: Faz nlev - 1 até número de níveis refinados especificados.
Passo 3a: Monta o sistema linear UH = - Rt. para o nível nlev utilizando o nível anterior para estabelecer condição inicial para Ur.
Passo 3b: Executa npre relaxações no nível nlev.
Passo 3c: Desce do nível i = nlev até 1
Passo 3c. I: Calcula X H - JK Uh + Rh e injeta este resíduo em RFm Passo 3 c.2: Se i = 1 então obtém solução do sistema JG AU = - Rg até convergência.
Se i &gt; 1 executa npre relaxações no nível i-1.
Passo 3d: Sobe do nível j = 1 até nlev
Passo 3dJ: Se j~nlev calcula solução em G' com correção da malha anterior.
Se j &amp;lt;nlev interpola correção de G’”1 paraG e executa npos relaxações no nível j
Passo 4: Se nlev &amp;lt;número de níveis especificados, retorna ao Passo 3. Se nlev = número de níveis especificados, excuta npos relaxações em nlev.
Passo 5: Verifica convergência da iteração Newtoniana na malha Gíilev. Se não convergiu retorna ao Passo 4.
No algoritmo acima J representa a matriz Jacobiana, X o vetor resíduo do sistema linear, R o vetor das equações de fluxo escrita na forma residual, U o vetor da variação das incógnitas (variáveis primárias) numa iteração Newtoniana e npre e npos o número de relaxações antes e após a injeção do resíduos, respectivamente.
11.3.2	Componentes multimalhas
II.	3.2.1 Soluções no nível grosseiro
As equações em todas as malhas são discretizadas de forma usual, utilizando diferenças finitas com ponderação a montante para os termos de transmissibilidade. A obtenção das aproximações na malhas básicas utiliza a rotina desenvolvida por Brand (1992), utilizando o procedimento ORTHOMIN e um precondicionador baseado em decomposição incompleta LU, aqui denominado ILU/O. Esta etapa é interna ao ciclo Newtoniano e por isso a convergência obedece a critérios estabelecidos apenas para o método de solução, o ILU/O. Desta forma não se obtém a solução deste nível, para o passo de tempo corrente, mas apenas uma aproximação que será utilizada como estimativa inicial para as malhas refinadas.
11.3.2.2	Refinamento de malhas
Inicialmente cada nível refinado é gerado a partir dos dados geométricos fornecidos para o nível básico, sendo o número de níveis limitado pelo parâmetro nlev e o fator de refinamento por kref. A cada iteração Newtoniana a matriz Jacobiana J e o vetor de resíduos R são gerados considerando os últimos valores definidos para as variáveis primárias naquele nível. No instante inicial, todos os níveis possuem os valores iniciais estabelecidos pelas condições de contorno. No procedimento que considera valores diferentes de zero como estimativas iniciais para as variáveis primárias nos níveis refinados, as aproximações obtidas no nível imediatamente menos refinado são interpoladas para estabelecer a condição de cada nível refinado. Utiliza-se interpolação linear para as pressões e os mesmos valores de saturações são passadas dos blocos pais para os blocos filhos. No caso das incógnitas relativas aos poços não se considera a aproximação obtida pela malha grosseira.
Este procedimento é similar ao utilizado por Collins e Mourits (1991), mas aqui é executado a nível da solução, enquanto neste último é efetuado a nível das equações.
11.3.2.3	Relaxação
estagnação do método iterativo, à partir do qual a convergência se torna muito lenta. O número de pré e pós relaxações pode assumir valores estabelecidos ou ser controlado por um critério adaptável em função da taxa de redução do resíduo do sistema linear que esta sendo resolvido. No presente trabalho foi adotado o primeiro procedimento. Durante os testes realizados verificou-se que o efeito de correção da malha grossa era mais efetivo, em termos de convergência, do que o aumento de iterações do método de relaxação. Por isto, um esquema considerando, por exemplo, npre=\ e npos-l, que levaria a repetir o Ciclo V dentro do esquema apresentado na Figura II. 1, mostrou-se mais eficaz do que valores maiores dentro de um único ciclo.
O	Solução até convergência
•	npre relaxações
■	npos relaxações
-----	interpolação/correção	de	soluções
— -	injeção de resíduo
Nível 2
Nível 1
Nível 0
Níveis refinados
Nível grosseiro
Ciclo V
Fig. IL1 - Esquema do algoritmo multimalhas para 3 níveis inlev=2)
11.3.2.4	Injeção dos resíduos e interpolação das correções
imediatamente mais grossa. Neste trabalho, a forma de transferência considerada foi cada bloco pai recebendo a soma dos resíduos dos blocos filhos.
No passo 3d. 1 a solução de cada nível sofre a correção da malha grossa ¿mediatamente anexa, conforme expressão (II.5) do item II. 1. A interpolação da malha grossa para a malha fina adotada foi cada bloco filho recebendo a correção associada a seu bloco pai, o que corresponde ao operador de interpolação ou prolongamento. Alguns testes foram realizados considerando a interpolação linear após esta transferência de valores entre malhas, a exemplo do que foi realizado quando se estabeleceu a condição inicial para as malhas refinadas. No entanto, seu desempenho ficou abaixo do critério anterior.
No contexto mui ti malhas estas operações de transferência constituem o principal mecanismo da técnica. Diferentes autores adotam diferentes formas para estes operadores. A ênfase de investigação tem sido dada a métodos de relaxação e poucas investigações têm sido realizadas em relação a etapa de transferência, principalmente para problemas não escalares. No caso de simuladores de reservatórios dificuldades adicionais são encontradas. Inicialmente, por se adotar, nos testes realizados neste trabalho, o esquema totalmente implícito, dois tipos de incógnitas estão envolvidos no mesmo sistema: pressões e saturações. O caráter difusivo das saturações e convectivo das pressões faz com que operações envolvendo componentes do vetor solução tenham tratamento diferenciado. Além disso, a obtenção da correção para a solução utilizando malhas mais grossas, requer cuidados especiais, como forma de garantir o caráter conservativo das equações em todas as malhas.
IL3.2.5 Não linearidades
Como foi exposto anteriormente, o principal objetivo desta implementação foi verificar o desempenho dos mecanismos básicos da técnica multimalhas quando aplicada a simuladores de reservatório. Algumas observações devem feitas em relação aos aspectos de não linearidades envolvidos nesta aplicação.
refinadas e dos poços não é eficiente uma vez que baixa convergência da malha fina e dos poços, os quais representam apenas uma pequena parcela do número total de equações, dominam a convergência do problema, escondendo o desempenho da parcela de malha grosseira existente no problema. Os exemplos citados neste capítulo não consideram refinamento local, mas da forma com o simulador foi implementado, as equações dos poços são resolvidas em conjunto com as equações dos blocos da malha e consequentemente o processo de convergência do problema é dominado pelas variáveis dos poços. Como toda a teoria da técnica multimalhas esta baseada na capacidade de diferentes discretizações removerem diferentes classes de erros, os termos fontes das equações, representados pelos poços, sofrem pouca influência desta propriedade, pelo menos de forma direta. Indi retamente, a rápida convergência das demais incógnitas do vetor solução, ao longo da malha, introduzem maior rapidez no processo de convergência das equações dos poços.
11,3.2.6 Avanço no tempo
A aplicação desta metodologia a processos com avanço no tempo também merece algumas considerações.
Nos passos iniciais do algoritmo descrito anteriormente, todas as malhas dos níveis inferiores ao mais refinado são resolvidas apenas aproximadamente, dentro da iteração Newtoniana. Apenas o nível mais refinado é resolvido até a convergência, verificada de acordo com os critérios estabelecidos para cada iteração Newtoniana. Por se tratar de um problema não linear, as matrizes Jacobianas destes níveis intermediários, nos passos de tempo subsequentes, são calculadas adotando como estimativa inicial valores das variáveis primárias que não atendem o critério de convergência Newtoniana no passo de tempo corrente. Em outras palavras, os operadores das malhas menos refinadas, utilizadas para obter a correção para a solução da malha refinada, são apenas aproximações.
II	4 Exemplos
IL4.1 Exemplo 1
Com o objetivo de verificar o desempenho do algoritmo proposto, alguns testes foram relalizados, baseados em dados retirados do First Comparative Solution Project, proposto por Odeh(1981), com algumas modificações. Inicialmente apenas uma camada é considerada, ou seja, o problema passa a ser tratado como bidimensional, com espessura de 30.48 m (100 ft) e as dimensões na direção x e y iguais a 1828.8 m (6000 ft). Além disso, apenas o poço produtor é mantido na malha, agora localizado na posição x-y=304.8 m (1000 ft). Finalmente, para evitar a influência de direções predominantes na eficiência do processo de relaxação, considera-se um meio homogêneo com Kx=Ky= 200 mD. Para este problema, dois métodos de solução são analisados e comparados:
a- Solução CB: assim denominada por utilizar a rotina de solução desenvolvida por Clemens Brand (Brand (1992)) , aqui chamada de ILU/O, como método iterativo de solução dos sistemas de equações lineares.
b~ Solução MG: assim denominada por utilizar o algoritmo multimalhas desenvolvido, com o número total de malhas refinadas (nlev) variando entre 1 e 2, e a razão de refinamento (kref) considerada sempre igual a 3.
O objetivo deste exemplo foi obter resultados para uma malha 27x27, comparando resultados e. principalmente, o desempenho dos dois métodos de solução.
Na Tabela II. 1 são apresentados os 5 casos testados e os parâmetros das soluções obtidas através do método de solução convencional. Os dados referentes aos tempos de cpu referem-se a um microcomputador Pentium-90MHz. Os índices apresentados nesta tabela têm a seguinte definição:
T:	tempo total de simulação, em dias;
NTS:	número de passos de tempo;
ERRO: tolerância máxima especificada para as equações de fluxo;
CC:	tipo de condição de contorno especificada para o poço;
ITN:	número médio de iterações Newtonianas;
SOL: número médio de iterações executadas pelo ILU/O, por passo de tempo; T SOL: tempo de cpu dispendido na solução dos sistemas, em segundos;
T TOT: tempo total de cpu , em segundos;
EBM O: erro de balanço de massa para fase óleo ao final da simulação,em m3 ; EBM G: erro de balanço de massa para fase gás ao final da simulação, em m .
Tabela IL1 - Definição dos casos e parâmetros da solução CB - Exemplo 1 - Pentium 90 MHz
Caso	T	NTS	ERRO	cc	ITN	SOL	TSOL	T TOT	EBM O	EBMG
A	5	10	0.02	q	1.1	11.6	6.7	18.7	1.7	394
B	5	5	0.0001	q	1.6	27.4	7.1	15.2	0.8	188
C	5	5	0.0001	p	1.4	24.2	6.4	13.6	11.5	2479
D	20	11	0.01	q	1.09	13.8	8.9	21.8	5.2	51769
Os mesmos casos foram solucionados pelo método MG, sendo considerados 3 esquemas para cada caso: (Ll), (L2) e (2,2), onde o primeiro número entre parênteses significa o número de npre relaxações e o segundo, o número de npos relaxações. São apresentados resultados para a malha 27x27, obtidos utilizando dois níveis ( uma malha fina com 27x27 blocos e uma grossa com 9x9 blocos) e três níveis (a mais refinada com 27x27 blocos, uma intermediária com 9x9 blocos e a mais grossa com 3x3 blocos). Desta forma, o número de níveis refinados considerados foram nlev=\ e nlev=2, respectivamente. A Tabela
II.2	apresenta os resultados para os mesmos casos da Tabela II.I. também para o Pentium 90 e onde os índices possuem a mesma definição anterior.
O caso A, representa um problema onde a tolerância especificada para o erro das equações de balanço de massa, colocada na forma residual, é relativamente alta, Como neste caso o número de iterações Newtonianas é o mesmo para todos os esquemas, o ciclo multimalhas gera um número menor de iterações (SOL) para número de níveis refinados (nlev) menores. O esquema que considera nlev=l executa menos iterações do que o caso nlev-2, mas o tempo de cpu dispendido é quase sempre maior. Isto se deve ao fato do primeiro esquema envolver malhas mais refinadas. Neste exemplo, o esquema que envolve um maior número de níveis leva a menores erros de balanço de massa, para o critério de convergência especificado. Pode-se observar também que o aumento do número de
relaxações funciona melhor no caso onde se considera um menor número de níveis no processo de solução. Em todos os esquemas que consideram n/&lt;?v~2, o tempo de solução dos sistemas ficou entre 43 e 60% do mesmo tempo dispendido peio método CB (Tabela II. 1), enquanto o tempo total ficou, em média, 65% maior no método MG.
Tabela 11.2 ~ Parâmetros das soluções por MG - Exemplo 1 - Pentium 90 MHz
		ITN		SOL		TSOL		TTOT		EBMO		EBMG	
Caso		2	1	2	1	2	1	2	1	2	1	2	1
A	(1,1)	1.1	1.1	15.9	12.3	2.88	4.58	30.0	43.7	3.8	4.4	858	1009
	(1,2)	1.1	1.1	19.0	1 1	5.33	5.33	30.6	44.1	7.2	7.8	1631	1777
	(2,2)	1.1	1.1	20.4	14.3	3.99	3.79	31.0	29.9	2.6	2.6	601	599
B	(1,1)	3.4	3.2	37.0	40.8	2.27	3.07	42.2	39.3	0.3	0.4	68	100
	(1,2)	1.8	1.8	27.6	26.0	1.99	2.07	23.4	23.5	6.0	3.6	1442	820
	(2,2)	1.8	1.8	31.0	26.0	2.54	2.07	23.6	23.2	0.8	0.8	190	189
C	(1,1)	1.4	1.4	18.4	19.8	1.39	1.86	18.3	18.9	10	9.3	2097	1928
	(1,2)	1.4	1.4	22.2	21.0	1.85	1.94	18.7	18.4	8.0	6.5	2315	1942
	(2,2)	1.4	1.4	24.6	22.4	2.12	2.29	18.8	18.9	6.0	6.7	972	1060
D	(1,1)	1.09	1.09	16.8	14.4	3.8	4.0	27.4	32.3	23	0.8	56174	50789
	(1,2)	1.09	1.09	20.0	15.4	4.0	4.2	33.4	32.4	102	108	29034	27761
	(2,2)	1.09	1.09	22.0	16.2	4.5	4.5	33.7	33.2	0.6	0.3	53208	53428
O caso B representa um caso com uma especificação mais rígida para o resíduo das equações de balanço de massa. Foi considerado passos de tempos fixos e iguais ao dobro aos do caso A. Este caso toma mais claro o efeito da suavização da solução (npos=2) no sentido de reduzir o número de iterações Newtonianas e consequentemente diminuir o número de vezes que os sistemas são resolvidos. Embora os melhores resultados multimalhas tenham sido obtidos com cerca de 28% do tempo de solução do processo CB, o tempo total sofreu, em média, um acréscimo de 50%.
O caso C possui as mesmas características do caso B* mudando apenas a condição especificada para o poço. Neste caso considera-se pressão de fundo constante e a equação do poço não faz parte do sistema de equações. Neste caso os resultados são semelhantes para os diversos esquemas multimalhas. A comparação deste caso com o caso B mostra a influência da não linearidade do poço no processo de solução baseado no esquema multimalhas. Ao se retirar a equação do poço o tempo total ficou 36% maior do que no caso considerando solução pelo método CB. além de uma precisão ligeiramente maior, traduzida em menores erros de balanço de massa. Ao se comparar os casos B e C. verifica-se que para o método CB a mudança da condição de contorno reduziu cerca de 10% do esforço computacional, enquanto para o MG a redução chegou até a 60%. no esquema (1,1)*
O caso D mostra, assim como o caso A. que quando a tolerância do erro é alta, o esquema (1,1) sempre funciona melhor que os demais. No caso de se exigir uma maior precisão dos resultados, deve-se sempre executar um número maior de relaxações após a injeção dos resíduos, ou seja, esquemas com npos &gt; 1 são mais efetivos.
II.4.2	Exemplo 2
Com o objetivo de analisai' o desempenho do método para problemas de maiores dimensões, considerou-se uma malha 81x81, ou seja, 6561 blocos. Neste caso, manteve-se 3 níveis de malhas: a mais refinada, com 81x81 blocos, uma intermediária com 27x27 blocos e a mais grossa com 9x9 blocos, o que representa nlev-2. Na Tabela 11,3 são apresentados resultados para 4 diferentes situações testadas, todas considerando esquemas multimalhas (LI). Os dados referentes aos tempos de cpu referem-se a uma estação de trabalho tipo SUN-Sparc 20 e os índices apresentados nesta tabela têm as mesmas definições anteriores.
Tabela IL3 - Comparação entre os métodos de solução MG e CB ~ Exemplo 2 - Estação SUN
Caso	T	NTS	ERRO	cc	ITN		SOL		TSOL	
					MG	CB	MG	CB	MG	CB
El	5	8	0.01	q	2.0	1.2	42.8	29.8	86	319
E2	5	7	0.001	q	Li	LI	2L4	25	60	251
E3	5	5	0.001	q	3.6	2	61.8	55.6	72	332
E4	5	5	0.001	p	1.2	L2	25.8	36	42	243
Novamente nestes exemplos, que consideram nlev=2, npre-l, npos-[. verifica-se o desempenho relativo da técnica multimalhas, quando diferentes limites de erro são estabelecidos e diferentes condições de operação são prescritas no poço produtor. O que mais se destaca neste segundo exemplo são os tempos relativos à solução dos sistemas lineares: de 22 a 27% do mesmo tempo dispendido pelo método CB para os 3 primeiros casos e apenas 17% para o caso E4. Este resultado caracteriza as estratégias multimalhas como mais adequadas a problemas de grande porte.
Através destes exemplos fica demonstrada a eficácia da técnica enquanto método de solução de sistemas de equações em problemas de simulação de reservatórios. De uma forma geral, verifica-se que a implementação prática da técnica multimalha depende de uma otimização do código computacional, de tal forma que a troca de informações entre as malhas seja a menos oneroso possível. O método apresenta melhor desempenho em problemas de grandes dimensões e bastante adequado ao tratamento de domínios complexos.</field>
	</doc>
</add>