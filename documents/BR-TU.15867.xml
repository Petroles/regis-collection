<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.15867</field>
		<field name="filename">22365_Dissertacao_Jefferson_Serafim_Ascaneo.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Processamento de imagens de holografia
digital para o estudo de organismos

planctônicos

Jefferson Serafim Ascaneo

Dissertação apresentada
ao

Instituto de Matemática e Estatística
da

Universidade de São Paulo
para

obtenção do título
de

Mestre em Ciências

Programa: Ciência da Computação
Orientador: Prof. Dr. Roberto Hirata Jr.

Durante o desenvolvimento deste trabalho o autor recebeu auxílio financeiro da CAPES

São Paulo, março de 2017



Processamento de imagens de holografia
digital para o estudo de organismos

planctônicos

Esta versão da dissertação contém as correções e alterações sugeridas
pela Comissão Julgadora durante a defesa da versão original do trabalho,
realizada em 15/03/2017. Uma cópia da versão original está disponível no

Instituto de Matemática e Estatística da Universidade de São Paulo.

Comissão Julgadora:

• Prof. Dr. Roberto Hirata Junior (orientador) - IME-USP

• Prof. Dr. Rubens Mendes Lopes - IO-USP

• Prof. Dr. João Eduardo Kogler Junior - EP-USP



Resumo

ASCANEO, J. S. Processamento de imagens de holografia digital para o estudo de orga-
nismos planctônicos. 2017. 110 pp. Dissertação (Mestrado) - Instituto de Matemática e Estatís-
tica, Universidade de São Paulo, São Paulo, 2017.

O estudo de plâncton é importante para estimar a biodiversidade em ambientes marinhos, auxili-
ando na compreensão de sua dinâmica e do impacto da atividade humana. Neste trabalho, estudamos
as etapas necessárias para a observação de organismos planctônicos utilizando um sistema holográ-
fico digital em linha. A holografia digital permite que as imagens sejam numericamente focalizadas
após sua aquisição através de algoritmos de reconstrução holográfica, o que remove a limitação da
baixa profundidade de foco presente em métodos mais tradicionais, e permite a observação de um
volume maior de água. É feita uma análise das limitações teóricas deste sistema holográfico em ter-
mos das frequências presentes no holograma e na sua reconstrução, observando-se as consequências
para a escolha e implementação dos algoritmos de reconstrução. Também são considerados alguns
detalhes de implementação que decorrem da natureza finita e discreta dos algoritmos. No proces-
samento dos hologramas, os organismos são automaticamente localizados segmentando-se regiões
de interesse por meio de uma reconstrução volumétrica. Estas regiões são reconstruídas a diversas
distâncias e é feita a escolha de um plano focal utilizando uma medida de foco. Diversas medidas
são comparadas em imagens obtidas experimentalmente para determinar a mais adequada na fo-
calização de organismos planctônicos. Por fim, descrevemos a aplicação web desenvolvida para o
processamento distribuído de imagens holográficas digitais de plâncton.

Palavras-chave: processamento de imagens, holografia, plâncton, visão computacional, processa-
mento digital de sinais.

i



ii



Abstract

ASCANEO, J. S. Processing of digital holography images for the study of planktonic or-
ganisms. 2017. 110 pp. Masters dissertation - Instituto de Matemática e Estatística, Universidade
de São Paulo, São Paulo, 2017.

The study of plankton is important for estimating biodiversity in marine environments, helping
in the understanding of its dynamics and the impact of human activity. In this work, we study
the necessary steps for the observation of planktonic organisms using an inline digital holographic
system. Digital holography allows images to be numerically focused after its acquisition through
holographic reconstruction algorithms, which removes the limitation of low depth of focus present
in more traditional methods, and allows the observation of a bigger volume of water. We present an
analysis of the theoretical limitations of this holographic system concerning the frequencies present
in the hologram and its reconstruction, noting the consequences for the choice and implementation
of reconstruction algorithms. Also considered are some implementation details that stem from the
finite and discrete nature of the algorithms. In the processing of holograms, organisms are automa-
tically located by segmenting regions of interest in a volumetric reconstruction. These regions are
reconstructed at numerous distances and the choice of a focal plane is made using the values of a
focus measure. Various measures are compared in experimentally obtained images to determine the
most adequate for focusing planktonic organisms. Finally, we describe a web application developed
for distributed processing of digital holographic images of plankton.

Keywords: image processing, holography, plankton, computer vision, digital signal processing.

iii



iv



Sumário

Lista de Abreviaturas vii

Lista de Símbolos ix

Lista de Figuras xi

Lista de Tabelas xiii

1 Introdução 1
1.1 Considerações Preliminares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.3 Contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.4 Organização do Trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

2 Conceitos 5
2.1 Fundamentos de Processamento Digital de Sinais . . . . . . . . . . . . . . . . . . . . 5
2.2 Fundamentos de Óptica de Fourier . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6

2.2.1 Equações de Maxwell e de Helmholtz . . . . . . . . . . . . . . . . . . . . . . . 7
2.2.2 Método do espectro angular . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.2.3 Aproximação de Fresnel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

3 Processamento de hologramas de plâncton 11
3.1 Holografia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

3.1.1 Remoção de fundo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
3.1.2 Algoritmos de reconstrução . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
3.1.3 Captura e propagação das frequências em holografia digital . . . . . . . . . . 18

3.2 Detalhes de implementação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
3.2.1 FFT real e funções de transferência . . . . . . . . . . . . . . . . . . . . . . . . 22
3.2.2 Sobreposição espacial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
3.2.3 Efeito de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
3.2.4 Amostragem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

3.3 Segmentação de região de interesse . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
3.3.1 Reconstrução volumétrica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
3.3.2 Focalização . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.4 Segmentação Final . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
3.5 Outras considerações . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

v



vi SUMÁRIO

3.5.1 Custo computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
3.5.2 Processamentos adicionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4 Efeito de borda 33
4.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
4.2 Métodos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

4.2.1 Zeros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.2 Média . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.3 Cópia da borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.4 Mediana da borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.5 Reflexão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.6 Rampa linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.7 Rampa linear circular . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.8 Filtro gaussiano . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.9 Filtro gaussiano iterativo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.2.10 Rampa linear com janela de Tukey . . . . . . . . . . . . . . . . . . . . . . . . 39
4.2.11 Cópia da borda com janela Spline . . . . . . . . . . . . . . . . . . . . . . . . . 39
4.2.12 Mediana com janela de cosseno . . . . . . . . . . . . . . . . . . . . . . . . . . 40
4.2.13 Minimização de frequências altas . . . . . . . . . . . . . . . . . . . . . . . . . 40
4.2.14 Minimização do Laplaciano . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

4.3 Complexidade computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
4.4 Resultados experimentais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47

4.4.1 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

5 Focalização 55
5.1 Medidas de foco . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.1.1 Medidas estatísticas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
5.1.2 Medidas com filtro espacial . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
5.1.3 Medidas com janelas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

5.2 Complexidade computacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
5.3 Resultados experimentais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

5.3.1 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

6 Sistema web 77
6.1 Arquitetura . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
6.2 Interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

7 Conclusão 85
7.1 Contribuições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
7.2 Trabalhos futuros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

A Imagens utilizadas no experimento de extensões de borda 89

B Imagens utilizadas no experimento de focalização 95

Referências Bibliográficas 105



Lista de Abreviaturas

FFT Transformada Rápida de Fourier
IFFT Transformada Rápida de Fourier Inversa
FFTreal Transformada Rápida de Fourier de uma sequência de números reais
IFFTreal Transformada Rápida de Fourier Inversa de uma sequência de números reais
RMSE Raiz do Erro Quadrático Médio
ACM Momento Central Absoluto (Image Absolute Central Moment)
HPACM Momento Central Absoluto com Filtro Passa-altas (High-pass filter image absolute

central moment)
TV Variação Total (Total Variation)
GGMSUM Somatório da Magnitude do Gradiente Gaussiano
GGMVAR Variância da Magnitude do Gradiente Gaussiano
SIM Somatório do Máximo Orientado da Intensidade (Steerable Intensity Maximum)
SIMVAR Variância do Máximo Orientado da Intensidade
SDC Correlação do Desvio Padrão
SML Soma do Laplaciano Modificado
XSML Soma Cruzada do Laplaciano Modificado
PK Medida de Pieper e Korpel
EOL Energia do Laplaciano
EOGS Energia Quadrática do Gradiente
SOBVAR Variância de Sobel
LAPVAR Variância do Laplaciano
GBLVAR Variância Global
GBLVARGG Variância Global do Gradiente Gaussiano
TOTVAR Variância Total do Gradiente Gaussiano
GBLVARLoG Variância Global do Laplaciano do Gaussiano

vii



viii LISTA DE ABREVIATURAS



Lista de Símbolos

circ(r) Função circular
sinc(x) Função seno cardinal
rect(x) Função retangular
F {f} Transformada Contínua de Fourier da função f
F?1 {F} Transformada Contínua de Fourier Inversa da função F
FFT Algoritmo que calcula a Transformada Discreta de Fourier
IFFT Algoritmo que calcula a Transformada Discreta de Fourier Inversa
FFTreal Algoritmo que calcula a Transformada Discreta de Fourier de números reais
IFFTreal Algoritmo que calcula a Transformada Discreta de Fourier Inversa de números reais
Re Parte real de um número complexo
Im Parte imaginária de um número complexo
E(I) Esperança de I
Var(I) Variância de I
c Velocidade da luz no vácuo
? Comprimento de onda
k Número de onda
? Frequência óptica

ix



x LISTA DE SÍMBOLOS



Lista de Figuras

3.1 Gravação e reconstrução de holograma . . . . . . . . . . . . . . . . . . . . . . . . . . 11
3.2 Sistema holográfico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
3.3 Exemplo de remoção de fundo de um holograma . . . . . . . . . . . . . . . . . . . . 14
3.4 Reconstrução de um organismo de amplitude . . . . . . . . . . . . . . . . . . . . . . 15
3.5 Reconstrução de um organismo de fase . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.6 Reconstrução holográfica pelo algoritmo da Integração de Fresnel . . . . . . . . . . . 17
3.7 Exemplo numérico da propagação das frequências . . . . . . . . . . . . . . . . . . . . 19
3.8 Exemplo numérico da propagação de uma frequência . . . . . . . . . . . . . . . . . . 20
3.9 Exemplo numérico da propagação de uma frequência . . . . . . . . . . . . . . . . . . 21
3.10 Exemplo numérico das frequências presentes em um holograma . . . . . . . . . . . . 23
3.11 Reconstrução holográfica com sobreposição espacial . . . . . . . . . . . . . . . . . . . 24
3.12 Exemplo numérico da propagação e supressão de frequências em um holograma . . . 25
3.13 Efeito da borda na reconstrução holográfica . . . . . . . . . . . . . . . . . . . . . . . 26
3.14 Segmentação de um holograma em regiões de interesse . . . . . . . . . . . . . . . . . 29
3.15 Focalização de um holograma segundo a medida de entropia . . . . . . . . . . . . . . 29
3.16 Segmentação final de uma região de interesse focalizada. . . . . . . . . . . . . . . . . 30
3.17 Ilustração do efeito da imagem gêmea . . . . . . . . . . . . . . . . . . . . . . . . . . 31

4.1 Efeito da borda na reconstrução holográfica . . . . . . . . . . . . . . . . . . . . . . . 34
4.2 Apodização do holograma para evitar efeito da borda . . . . . . . . . . . . . . . . . . 34
4.3 Extensão de holograma para evitar efeito da borda . . . . . . . . . . . . . . . . . . . 35
4.4 Métodos de extensão de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.5 Métodos de extensão de borda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
4.6 Janela de Tukey . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
4.7 Janela de spline cúbica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
4.8 Janela de cosseno . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
4.9 Minimização do Laplaciano . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.10 Tempo de execução dos algoritmos de extensão de borda . . . . . . . . . . . . . . . . 46
4.11 Tempo de execução dos algoritmos de extensão de borda (detalhe) . . . . . . . . . . 47
4.12 Cálculo do erro dos métodos de extensão de borda . . . . . . . . . . . . . . . . . . . 48
4.13 Holograma utilizado nos gráficos de erro por distância e erro por tamanho da recons-

trução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
4.14 Comparação entre extensões de borda para diferentes distâncias de reconstrução . . . 50

xi



xii LISTA DE FIGURAS

4.15 Comparação entre extensões de borda para diferentes distâncias de reconstrução
(detalhe) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

4.16 Comparação entre extensões de borda para diferentes distâncias de reconstrução
(detalhe) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

4.17 Comparação entre extensões de borda para diferentes tamanhos de imagem . . . . . 51
4.18 Comparação entre extensões de borda para diferentes tamanhos de imagem (detalhe) 52
4.19 Comparação entre extensões de borda para diferentes tamanhos de imagem (detalhe

2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

5.1 Focalização de um holograma segundo a medida de entropia . . . . . . . . . . . . . . 55
5.2 Exemplo de organismo sendo focalizado . . . . . . . . . . . . . . . . . . . . . . . . . 66
5.3 Valores de medidas de foco para um organismo . . . . . . . . . . . . . . . . . . . . . 67
5.4 Exemplo de organismo sendo focalizado . . . . . . . . . . . . . . . . . . . . . . . . . 68
5.5 Valores de medidas de foco para um organismo . . . . . . . . . . . . . . . . . . . . . 69
5.6 Distribuição dos erros de focalização . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
5.7 Exemplo de execução do algoritmo de autofoco . . . . . . . . . . . . . . . . . . . . . 72
5.8 Exemplo de execução do algoritmo de autofoco . . . . . . . . . . . . . . . . . . . . . 73

6.1 Arquitetura do sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
6.2 Tela inicial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
6.3 Parâmetros de um experimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
6.4 Tela para upload de hologramas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
6.5 Visualização dos hologramas enviados . . . . . . . . . . . . . . . . . . . . . . . . . . 80
6.6 Visualização de um holograma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
6.7 Visualização dos organismos segmentados . . . . . . . . . . . . . . . . . . . . . . . . 82
6.8 Focalização manual de um organismo . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

A.1 Hologramas utilizados no experimento de extensão de borda . . . . . . . . . . . . . . 89
A.2 Hologramas utilizados no experimento de extensão de borda . . . . . . . . . . . . . . 90
A.3 Hologramas utilizados no experimento de extensão de borda . . . . . . . . . . . . . . 91
A.4 Hologramas utilizados no experimento de extensão de borda . . . . . . . . . . . . . . 92
A.5 Reconstruções dos hologramas utilizados no experimento de extensão de borda . . . 92
A.6 Reconstruções dos hologramas utilizados no experimento de extensão de borda . . . 93
A.7 Reconstruções dos hologramas utilizados no experimento de extensão de borda . . . 94

B.1 Reconstruções do conjunto A utilizadas no experimento de focalização . . . . . . . . 96
B.2 Reconstruções do conjunto A utilizadas no experimento de focalização . . . . . . . . 97
B.3 Reconstruções do conjunto B utilizadas no experimento de focalização . . . . . . . . 98
B.4 Reconstruções do conjunto B utilizadas no experimento de focalização . . . . . . . . 99
B.5 Reconstruções do conjunto C utilizadas no experimento de focalização . . . . . . . . 100
B.6 Reconstruções do conjunto C utilizadas no experimento de focalização . . . . . . . . 101
B.7 Reconstruções do conjunto C utilizadas no experimento de focalização . . . . . . . . 102
B.8 Reconstruções do conjunto C utilizadas no experimento de focalização . . . . . . . . 103



Lista de Tabelas

4.1 Erros das extensões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.2 Erros das extensões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

5.1 Erros de focalização - Conjunto A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
5.2 Erros de focalização - Conjunto B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
5.3 Erros de focalização - Conjunto C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
5.4 Erros de focalização - Total . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
5.5 Erros de focalização - Mediana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
5.6 Erros de autofoco - Conjunto A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
5.7 Erros de autofoco - Conjunto B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
5.8 Erros de autofoco - Conjunto C . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75

xiii



xiv LISTA DE TABELAS



Capítulo 1

Introdução

Faremos algumas considerações preliminares sobre o estudo de plâncton e o uso de sistemas
holográficos para sua observação e monitoramento. A seguir, apresentaremos os objetivos deste
trabalho, suas contribuições e a organização dos capítulos.

1.1 Considerações Preliminares

A maior parte da superfície terrestre é coberta pelos oceanos, que contêm um sistema ecológico
complexo onde diversos organismos interagem entre si e com o ambiente em que vivem. Dentre
estes organismos, o plâncton forma a base da cadeia alimentar, sendo responsável por grande parte
da fotossíntese que ocorre no planeta. O plâncton é composto por uma grande variedade de seres
vivos, como por exemplo as algas, crustáceos pequenos, larvas de peixes e bactérias. Seu estudo
é, portanto, essencial para melhor compreender a dinâmica dos ecossistemas marinhos, além de
permitir estudar o impacto da atividade humana nestes ambientes aquáticos.

Normalmente, o estudo de plâncton é realizado com amostras coletadas através de redes e outros
mecanismos que, embora permitam identificar as espécies presentes, possuem uma resolução espa-
cial e temporal extremamente limitadas, além de poderem danificar organismos mais frágeis. Estas
amostras requerem a análise manual, em microscópios, por pessoas treinadas, o que gasta muito
tempo e limita a quantidade de dados que podem ser analisados. Estes dados são, portanto, insu-
ficientes para compreender a variabilidade manifesta em escalas mais refinadas e realizar previsões
com grande acurácia.

Mais recentemente, o avanço em tecnologias que permitem capturar imagens digitais, analisá-las
e classificá-las de forma automática ou semi-automática permitiu o surgimento de novos equipa-
mentos, com os quais pode-se estudar a distribuição de plâncton de forma mais eficiente. Entre
eles, destacam-se o ZooScan [GPWG04, GOP+10] e o FlowCAM®[SSY98]. Além de realizarem a
classificação de organismos e detritos, alguns destes sistemas possuem acurácia comparável à de
um especialista [CWR+03]. Porém, muitos destes equipamentos não permitem a análise in situ
de grandes volumes de água, o que ainda é um fator limitante para estudos mais detalhados. Os
sistemas ópticos utilizados possuem uma profundidade de campo limitada, deixando apenas duas
opções: ou capturar imagens de um pequeno volume, como uma região laminar [GPWG04] ou uma
câmara micro-fluídica [SSY98], ou detectar e descartar imagens fora de foco [TSV+98].

Para observar o plâncton em seu habitat natural, e coletar imagens de grandes volumes, sistemas
holográficos digitais em linha têm se mostrado promissores [SHPW07, THM+13, MAK99]. Por não
utilizar lentes, a focalização é feita numericamente após a aquisição da imagem e, assim, a holografia
digital permite superar a limitação da profundidade de campo e coletar imagens de volumes mai-
ores. O uso de holografia em linha simplifica o sistema holográfico, facilitando o seu alinhamento,
estabilização e miniaturização, características estas que são desejáveis no desenvolvimento de um
sistema para observação in situ.

Entretanto, a classificação automática destas imagens ainda se mostra desafiadora, e artigos re-
centes [THM+13] realizam a classificação de organismos, como copépodes e diatomáceas, de forma

1



2 INTRODUÇÃO 1.3

visual. Existem várias dificuldades devido à alta variabilidade dos organismos. Além disso, estes
podem ser observados de qualquer ângulo, com algumas observações fornecendo pouquíssima infor-
mação que ajude em uma identificação correta. Em alguns equipamentos, como o ZooScan, é possível
ajustar o posicionamento e orientação dos organismos para obter a melhor imagem possível, mas
esta estruturação não pode ser feita no sistema holográfico utilizado neste trabalho.

Dentre os aspectos mais suscetíveis de serem controlados e com grande influência na quali-
dade da classificação está a correta segmentação e focalização do organismo, um problema que está
longe de ser completamente solucionado, embora tenham sido feitos vários esforços neste sentido
[Loo11]. Sem algoritmos confiáveis para se obter imagens bem focalizadas dos organismos, a ho-
lografia digital perde sua vantagem mais essencial no estudo de plâncton. É necessário, portanto,
desenvolver e comparar algoritmos e métodos de focalização para que se possa aproveitar a riqueza
de detalhes proporcionada pela holografia digital. Também é preciso levar em conta a teoria de pro-
cessamento digital de sinais, para obter boas reconstruções holográficas sem artefatos provenientes
de um processamento numérico mal planejado, e entender melhor alguns algoritmos de focalização
e segmentação.

1.2 Objetivos

Este trabalho tem como objetivo o estudo das diferentes etapas necessárias para a observação
de plâncton por meio de imagens de holografia digital em linha, incluindo a reconstrução holográ-
fica, focalização e segmentação, e com ênfase nos diversos algoritmos de processamento de imagens
utilizados, realizando este estudo a partir das teorias da Óptica de Fourier e do Processamento
Digital de Sinais. Também visa realizar análises e comparações dos algoritmos estudados em exem-
plos simulados e reais, objetivando melhorar a qualidade das imagens resultantes. Esta melhoria na
qualidade é feita através da eliminação ou supressão de artefatos que são provenientes do sistema
óptico holográfico e dos algoritmos de processamento de imagens, e que não representam adequada-
mente a morfologia dos organismos, e através da recuperação de uma maior quantidade de detalhes
destes organismos sem que isso incorra em um custo computacional demasiadamente elevado. Com
isso, espera-se obter imagens de alta qualidade dos organismos presentes nos hologramas digitais,
viabilizando trabalhos futuros de classificação automática de plâncton, cuja correta identificação e
categorização em classes mais específicas (fine-grained categorization [KSDFF13, KJYFF15]) de-
pende do reconhecimento de estruturas e detalhes finos.

1.3 Contribuições

As principais contribuições deste trabalho são as seguintes:

• Um estudo aprofundado de algoritmos de reconstrução holográfica, com a análise das frequên-
cias presentes nas imagens e sua propagação, e de detalhes de implementação que afetam a
qualidade da imagem reconstruída, decorrentes da natureza finita e discreta dos algoritmos.

• Vasta comparação experimental de diferentes algoritmos de extensão de borda, necessários
para diminuir artefatos presentes na imagem final. É proposto um novo algoritmo, a Mini-
mização do Laplaciano, que é baseado em um algoritmo presente na literatura e que obtém
resultados superiores a todos os outros algoritmos considerados no experimento.

• Extensa comparação experimental de diferentes medidas de foco, utilizadas para determinar
a distância da reconstrução holográfica e obter uma imagem bem focalizada. São propostas
algumas novas medidas, incluindo a Variância Total do Gradiente Gaussiano e a Variância
do Máximo Orientado da Intensidade, que obtiveram excelentes resultados na focalização de
imagens holográficas de organismos planctônicos, com erros médios extremamente pequenos
e inferiores aos de todas as outras medidas consideradas no experimento.



1.4 ORGANIZAÇÃO DO TRABALHO 3

• Desenvolvimento de um sistema web para o processamento distribuído de imagens holográficas
de organismos planctônicos, facilitando a aplicação dos resultados deste trabalho por outros
pesquisadores e contribuindo para tornar o uso de sistemas holográficos uma alternativa prá-
tica no estudo de plâncton.

1.4 Organização do Trabalho

No Capítulo 2, apresentamos algumas definições da área de Processamento Digital de Sinais,
além de uma breve introdução a alguns conceitos de Óptica de Fourier que serão utilizados ao longo
do texto. No Capítulo 3, fazemos uma análise da propagação das frequências na formação do holo-
grama e na sua reconstrução, discutimos os diferentes algoritmos de reconstrução, além de todas as
outras etapas do processamento destas imagens, como a localização de regiões de interesse, focaliza-
ção dos organismos e segmentação. No Capítulo 4, comparamos diversos algoritmos para diminuir
o efeito de difração da borda do holograma na reconstrução. No Capítulo 5, comparamos algumas
medidas de foco utilizadas para determinar a melhor distância de reconstrução dos hologramas.
No Capítulo 6, apresentamos o sistema desenvolvido para o processamento distribuído de imagens
holográficas de plâncton. Finalmente, no Capítulo 7 apresentamos as conclusões e indicamos futuras
linhas de pesquisa.

As imagens utilizadas em um dos experimentos realizados no Capítulo 4 estão disponíveis no
Apêndice A. O Apêndice B apresenta algumas das imagens utilizadas no experimento do Capítulo 5.



4 INTRODUÇÃO 1.4



Capítulo 2

Conceitos

Faremos uma pequena revisão de alguns conceitos de Processamento Digital de Sinais e de Óptica
de Fourier. Estes serão utilizados ao longo do texto, principalmente no estudo dos algoritmos de
reconstrução holográfica e dos processamentos digitais de imagens realizados. O foco será um pouco
maior na Óptica de Fourier, com a qual leitores provavelmente terão menor familiaridade.

2.1 Fundamentos de Processamento Digital de Sinais

A seguir estão algumas definições da área de Processamento Digital de Sinais que serão utilizadas
ao longo do texto. É esperada alguma familiaridade com estes conceitos, e maiores detalhes podem
ser encontrados em diversos livros da área [OSB+89, PV08].

A transformada de Fourier (espectro de Fourier ou espectro de frequências) de uma função g de
duas variáveis independentes x, y ? C é definida como

G(fX, fY ) = F {g} =
+?????
??

g(x, y) exp [?j2?(fXx + fY y)] dxdy,

onde j =
?
?1. As variáveis fX e fY normalmente serão chamadas de frequências.

A transformada de Fourier inversa de uma função G de duas variáveis independentes fX, fY ? C
é definida como

g(x, y) = F?1 {G} =
+?????
??

G(fX, fY ) exp [j2?(fXx + fY y)] dfXdfY .

Os algoritmos para calcular a transformada de Fourier discreta e sua inversa serão denotados
por FFT e IFFT, respectivamente.

Teorema do Deslocamento. Se F {g(x, y)} = G(fX, fY ), então

F {g(x ? a, y ? b)} = G(fX, fY ) exp [?j2?(fXa + fY b)] .

Teorema da Convolução. Se F {g(x, y)} = G(fX, fY ) e F {h(x, y)} = H(fX, fY ), então

F {g ? h} = F

??
?

+?????
??

g(?, ?)h(x ? ?, y ? ?)d?d?

??
? = G(fX, fY )H(fX, fY ),

onde ? denota a operação de convolução.
Uma função g é separável nas coordenadas retangulares (x, y) se

g(x, y) = gX(x)gY (y),

5



6 CONCEITOS 2.2

onde gX(x) e gY (y) são funções de uma variável, e x e y são variáveis independentes.
Se g é separável nas coordenadas retangulares (x, y), então

F {g(x, y)} = FX {gX} FY {gY } ,

onde FX e FY são as transformadas de Fourier unidimensionais nas variáveis x e y, respectivamente.
A função círculo é definida como

circ(
??

x2 + y2) =

???
??
1 se

??
x2 + y2 &amp;lt;1

1
2

se
??

x2 + y2 = 1

0 caso contrário.

A função retângulo é definida como

rect(x) =

???
??
1 se |x| &amp;lt;1

2
1
2

se |x| = 1
2

0 caso contrário.

A função sinc é definida como

sinc(x) =
sin(?x)

?x
.

Um filtro passa-baixa atenua frequências acima de uma frequência de corte. A multiplicação no
espectro de Fourier pela função sinc pode ser interpretada como a aplicação de um filtro passa-baixa,
e corresponde à convolução pela função rect.

Qualquer função complexa g pode ser representada na forma

g(x, y) = a(x, y) exp[j?(x, y)],

onde a(x, y) é uma distribuição real e não negativa de amplitude, e ?(x, y) é uma distribuição real
de fase.

A frequência espacial local da função g é o par de frequências

flX =
1

2?

?

?x
?(x, y) flY =

1

2?

?

?y
?(x, y)

Além disso, ambas as frequências locais flX e flY são zero por definição em regiões onde a função
g torna-se zero. Enquanto que o espectro de Fourier permite analisar a presença de frequências em
toda a imagem, de forma global, as frequências locais permitem associar uma região limitada da
função a uma frequência específica. Isto dá uma ideia aproximada de onde frequências do espectro
de Fourier ocorrem na função, desde que as variações em ?(x, y) sejam suficientemente “lentas”.

2.2 Fundamentos de Óptica de Fourier

O texto a seguir é uma breve introdução à teoria escalar de difração de ondas ópticas, que é a
base dos algoritmos de reconstrução holográfica. Maiores detalhes podem ser encontrados em textos
como o de Goodman [Goo96], ou o de Born e Wolf [BW99].



2.2 FUNDAMENTOS DE ÓPTICA DE FOURIER 7

2.2.1 Equações de Maxwell e de Helmholtz

Sendo uma onda eletromagnética, a luz obedece às equações de Maxwell. Em unidades MKS e
na ausência de carga livre, as equações são

? × E = ?µ
?H

?t

? × H = ?
?E

?t
? · ?E = 0
? · µH = 0

onde E é o campo elétrico, H é o campo magnético, µ e ? são, respectivamente, a permeabilidade
e permissividade do meio no qual a onda se propaga.

Note que estas equações definem campos vetoriais. Para poder desenvolver uma teoria escalar,
iremos supor que algumas propriedades são válidas no meio de propagação da luz. Faremos as
suposições de que o meio é dielétrico, não magnético (permeabilidade igual ao vácuo), homogêneo
(permissividade constante), não dispersivo (permissividade independente dos comprimentos de onda
sendo propagados), linear (conforme a teoria de sistemas lineares, também conhecido como princípio
de superposição), e isotrópico (propriedades não dependem da direção de polarização). Com isso,
é possível mostrar que todos os componentes dos campos magnético e elétrico se comportam da
mesma forma, podendo ser descritos pela equação de onda escalar

?2u ?
n2

c2
?2u

?t2
= 0 (2.1)

onde ?2 é o operador Laplaciano, c é a velocidade de propagação da luz no vácuo e n é o índice de
refração do meio. Os valores de c e n são

c =
1

?
µ0?0

n =

(?
?

?0

)?1
2

onde µ0 e ?0 são a permeabilidade e permissividade do vácuo.
Uma onda monocromática que obedece à equação de onda pode ser escrita, utilizando notação

complexa, por
u(P, t) = Re {U(P) exp(?j2??t)} (2.2)

onde Re{} é a parte real, ? é a frequência óptica, e U(P) é uma função complexa de posição,

U(P) = A(P) exp(?j?(P))

onde A(P) e ?(P) são a amplitude e a fase na posição P , respectivamente. Definiremos o formato
da onda como sendo o formato de uma superfície de fase constante.

A função complexa U(P) será utilizada para descrever as ondas estudadas, já que a oscilação
exp(?j2??t) é rápida demais para ser detectada pelos instrumentos. Substituindo a equação 2.2 na
equação 2.1, chegamos na equação de Helmholtz

?2U + k2U = 0. (2.3)

O valor k é o número de onda definido por

k = 2?n
?

c
=

2?

?
,



8 CONCEITOS 2.2

onde ? é o comprimento de onda no meio dielétrico e ? = c/n?.

2.2.2 Método do espectro angular

O nome desta abordagem deve-se à interpretação da decomposição de Fourier de um campo U
como uma soma de ondas planas propagando-se em diferentes direções, e maiores detalhes deste
ponto de vista podem ser encontrados em Goodman [Goo96]. Suponha que uma onda monocromá-
tica incidente no plano (x, y) propaga-se na direção z. Seja U(x, y, 0) o campo complexo no plano
z = 0; queremos encontrar o campo U(x, y, z) que está a uma distância z do primeiro plano. Pode-
mos escrever este segundo plano como a transformada inversa de Fourier de seu espectro A(x, y; z),
ou seja,

U(x, y, z) =

+?????
??

A(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY . (2.4)

Além disso, em todos os pontos que não são fonte, U precisa satisfazer a equação de Helmholtz
2.3, ou seja,

?2
+?????
??

A(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY

+ k2
+?????
??

A(fX, fY ; z) exp[j2?(fXx + fY y)]dfXdfY = 0.

Usando as equações

d2

dz2
(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = exp[j2?(fXx + fY y)]

d2

dz2
A(fX, fY ; z)

d2

dx2
(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = ?(2?fX)2A(fX, fY ; z) exp[j2?(fXx + fY y)]

d2

dy2
(A(fX, fY ; z) exp[j2?(fXx + fY y)]) = ?(2?fY )2A(fX, fY ; z) exp[j2?(fXx + fY y)]

temos

+?????
??

(?
d2

dz2
A(fX, fY ; z)

+
[?
(2?)2[?(fX)2 ? (fY )2] + k2

]?
A(fX, fY ; z)

)?
exp[j2?(fXx + fY y)]dfXdfY = 0

+?????
??

(?
d2

dz2
A(fX, fY ; z)

+

(?
2?

?

)?2
[1 ? (?fX)2 ? (?fY )2]A(fX, fY ; z)

)?
exp[j2?(fXx + fY y)]dfXdfY = 0.

Note que, como a equação está no formato da transformada inversa de Fourier, podemos calcular
a transformada de Fourier para chegar na equação diferencial

d2

dz2
A(fX, fY ; z) +

(?
2?

?

)?2
[1 ? (?fX)2 ? (?fY )2]A(fX, fY ; z) = 0.



2.2 FUNDAMENTOS DE ÓPTICA DE FOURIER 9

Uma solução elementar é

A(fX, fY ; z) = A(fX, fY ; 0) exp

(?
j
2?

?

??
1 ? (?fX)2 ? (?fY )2z

)?
.

Note que, quando (?fX)2 + (?fY )2 &gt; 1, podemos reescrever a solução como

A(fX, fY ; z) = A(fX, fY ; 0) exp (?µz)

onde
µ =

2?

?

??
(?fX)2 + (?fY )2 ? 1.

Como µ é um número real positivo, estes componentes são rapidamente atenuados devido ao termo
exp (?µz). Eles são conhecidos como ondas evanescentes e podem ser desconsiderados caso a dis-
tância de propagação z seja superior a alguns comprimentos de onda. Portanto, limitaremos a região
do espectro de Fourier com a função circ para eliminar estes componentes.

Chegamos então na equação

A(fX, fY ; z) = A(fX, fY ; 0) circ(
??

(?fX)2 + (?fY )2) exp

[?
j
2?

?
z
??
1 ? (?fX)2 ? (?fY )2

]?
da qual podemos obter a função

H(fX, fY ) =

??
?exp

[?
j 2?

?
z
??

1 ? (?fX)2 ? (?fY )2
]?

se
??

f2X + f
2
Y ?

1
?

0 caso contrário
(2.5)

A função H é chamada função de transferência, e relaciona a “entrada” U(x, y, 0) à “saída” U(x, y, z)
em termos das frequências espaciais A(fX, fY ; z).

Note que nenhuma frequência superior a ??1 é preservada, e portanto não é possível identificar
estruturas com um período menor do que o comprimento de onda usado.

2.2.3 Aproximação de Fresnel

Suponha que uma abertura, ou seja, algo que bloqueia a luz fora de uma determinada região, está
localizada no plano (?, ?) e é iluminada na direção positiva z. Queremos calcular o campo no plano
(x, y), que é paralelo ao plano (?, ?) e está à distância z deste. O eixo z passa pela origem de ambos
os planos. Segundo o princípio de Huygens-Fresnel e a fórmula de difração de Rayleigh-Sommerfeld,

U(x, y) =
z

j?

+?????
??

U(?, ?)
exp(jkr01)

r201
d?d?,

onde r01 é a distância
r01 =

??
z2 + (x ? ?)2 + (y ? ?)2.

Até agora supusemos as condições da teoria escalar e que r01 ? ?. Podemos aproximar r01
movendo z para fora da raiz, e usar a expansão binomial para obter

r01 ? z

[?
1 +

1

2

(?
x ? ?
z

)?2
+

1

2

(?
y ? ?
z

)?2]?
.



10 CONCEITOS 2.2

No denominador, aproximamos r01 por z apenas. Com isso, a equação para o campo em (x, y) é

U(x, y) =
ejkz

j?z

+?????
??

U(?, ?) exp

(?
j
k

2z
[(x ? ?)2 + (y ? ?)2]

)?
d?d?. (2.6)

Esta equação pode ser interpretada como a convolução de U(?, ?) por

h(x, y) =
ejkz

j?z
exp

[?
j
k

2z
(x2 + y2)

]?
.

Calculando analiticamente a transformada de Fourier de h(x, y),

H(fX, fY ) = F
{?
ejkz

j?z
exp

[?
j
?

?z
(x2 + y2)

]?}?
(2.7)

= ejkz exp
[?
?j??z(f2X + f

2
Y )
]?
. (2.8)

Esta função de transferência é uma aproximação da função 2.5, utilizando a expansão binomial

??
1 ? (?fX)2 ? (?fY )2 ? 1 ?

(?fX)
2

2
?

(?fY )
2

2
,

que é válida quando |?fX| ? 1 e |?fY | ? 1. Isto ocorre com pequenos ângulos de difração, ou seja,
quando x, y, ?, ? ? z. Esta aproximação é conhecida como aproximação de Fresnel ou aproximação
paraxial.

Reescrevendo a equação 2.6, obtemos

U(x, y) =
ejkz

j?z????
1

ej
k
2z

(x2+y2)? ?? ?
2

+?????
??

U(?, ?)

4? ?? ?
ej

k
2z

(?2+?2) e?j
2?
?z

(x?+y?)d?d?

? ?? ?
3

. (2.9)

O termo (1) apenas altera a amplitude e fase globalmente, enquanto que o (2) altera somente
a fase, e normalmente podem ser desconsiderados. Já o termo (3) pode ser interpretado como uma
transformada de Fourier, e o (4) é uma exponencial de fase quadrática (função chirp).



Capítulo 3

Processamento de hologramas de
plâncton

Neste capítulo iremos fazer uma breve análise da formação e reconstrução de imagens holo-
gráficas, e estudar as diversas etapas de processamento que são necessárias para obter imagens
individuais dos organismos planctônicos, permitindo sua identificação. Serão analisados alguns al-
goritmos de reconstrução holográfica, a localização e focalização de organismos em um holograma,
e sua posterior segmentação.

3.1 Holografia

Holografia é a técnica de gravar e reconstruir a amplitude e a fase de um objeto, utilizando
iluminação coerente. Denotaremos por reconstrução ou propagação o processo de obter a amplitude
e fase de uma onda em outro(s) plano(s), o que pode ser feito numericamente ou com instrumentos
ópticos, como ilustrado na figura 3.1. Meios de gravação, incluindo filmes fotográficos e sensores
digitais, respondem apenas à intensidade da luz, que é proporcional a |U(P)|2, onde U(P) é a
representação complexa utilizada anteriormente na discussão sobre a difração de ondas. Portanto,
a informação da fase precisa ser gravada como intensidade, caso contrário ela será completamente
perdida. Para isso, grava-se a interferência entre a onda do objeto e uma segunda onda, coerente
com a primeira e com amplitude e fase conhecidas.

Neste trabalho utilizamos imagens digitais de hologramas de Gabor, criadas com o sistema
holográfico em linha que pode ser visto na figura 3.2. A vantagem da holografia digital está na
facilidade de criação, armazenamento, reconstrução e processamento, não sendo preciso realizar
tarefas como processar quimicamente os filmes ou fazer reconstruções ópticas manualmente. Um dos
motivos para utilizar hologramas de Gabor na observação de plâncton é a baixa resolução espacial
em hologramas digitais, se comparada à de filmes holográficos. Isto não permite a utilização de
outras técnicas que envolvem o uso de um feixe de referência em um ângulo com o holograma, o
que criaria franjas de interferência com frequências espaciais mais altas do que seria possível gravar

(a) Gravação do holograma (b) Reconstrução óptica

Figura 3.1: Gravação e reconstrução de holograma.

11



12 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.1

Figura 3.2: Sistema holográfico utilizado nos experimentos. A iluminação proveniente de um laser é filtrada
espacialmente, para remover frequências indesejadas, e depois é expandida e colimada, formando uma onda
aproximadamente plana que atravessa a amostra e é registrada por uma câmera. (Imagem fornecida pelo
LAPS - IO–USP)

com um sensor digital.
Um holograma de Gabor é obtido quando um objeto altamente transparente é iluminado por

uma onda colimada coerente. Suponha que o objeto possua transmissão de amplitude

t(xo, yo) = to + ?t(xo, yo),

onde to é a média de transmissão e ?t são as variações desta média, e

|?t| ? |to|. (3.1)

Ao ser iluminado pela onda colimada coerente, a luz transmitida será composta por uma onda plana
forte, devido ao termo to, e uma onda dispersa fraca devido ao termo ?t(xo, yo). A intensidade
gravada à distância zo do objeto é

I(x, y) = |A + a(x, y)|2

= |A|2 + |a(x, y)|2 + A?a(x, y) + Aa?(x, y),

onde A é a amplitude da onda plana e a(x, y) é a amplitude da onda dispersa no plano de gravação.
Supondo que o meio de gravação responde linearmente à intensidade, a amplitude gravada é

tA(x, y) = tb + ?
?(|a(x, y)|2 + A?a(x, y) + Aa?(x, y)), (3.2)

onde tb e ?? são constantes. Iluminando o holograma por uma onda plana com amplitude uniforme



3.1 HOLOGRAFIA 13

B, o campo transmitido é

BtA(x, y) = Btb????
U1

+ ??B|a(x, y)|2? ?? ?
U2

+ ??A?Ba(x, y)? ?? ?
U3

+ ??ABa?(x, y)? ?? ?
U4

. (3.3)

O primeiro termo U1 é uma onda plana com amplitude uniforme. O segundo termo U2 pode ser
ignorado usando a hipótese da fórmula 3.1, que implica em |a(x, y)| ? A. O terceiro termo U3 é
uma duplicação exata da frente de onda a(x, y), a menos de um fator constante, e aparenta originar
de uma imagem virtual a uma distância zo do holograma. Similarmente, o termo U4 é proporcional
a a?(x, y), e leva à formação de uma imagem real à distância zo no lado oposto do holograma. Com
isso, vemos que o holograma de Gabor gera duas imagens da variação de transmissão ?t, separadas
por uma distância axial 2zo, e acompanhadas de um fundo coerente U1 e um halo U2.

Na holografia de plâncton, podemos supor a hipótese da fórmula 3.1, pois quase a totalidade
do volume sendo imageado estará vazio, preenchido apenas com água, e somente alguns poucos
organismos pequenos irão difratar a onda de luz sendo transmitida. Um estudo sobre o efeito de
grandes quantidades de partículas na qualidade da reconstrução pode ser encontrado na tese de
doutorado de Loomis [Loo11]. Além disso, normalmente as imagens gêmeas U3 e U4 poderiam ser
problemáticas, pois a reconstrução de uma delas é acompanhada pela outra imagem desfocada.
Porém, como os organismos observados são muito pequenos em relação à distância da câmera, a
imagem gêmea aparece extremamente desfocada e normalmente não interfere na correta visualização
da imagem reconstruída. Esta imagem gêmea só começa a causar problemas quando a quantidade
de plâncton é muito elevada, ou os organismos são grandes.

3.1.1 Remoção de fundo

Podemos calcular o fundo tb da equação 3.2 e subtraí-lo do holograma gravado, melhorando a
reconstrução ao eliminar o termo U1 da equação 3.3. Isto pode ser feito de várias formas, como por
exemplo modelando o feixe transmitido, ou subtraindo uma média global ou local da imagem.

Uma vantagem de remover o fundo é que, embora tenhamos suposto que a onda de referência
possui intensidade constante no plano do holograma, na prática ela pode variar de acordo com
a posição, e nos experimentos feitos ela segue uma distribuição de intensidade aproximadamente
gaussiana, com centro próximo ao da imagem, devido ao laser e configuração óptica utilizados.
Sem o fundo, a iluminação torna-se praticamente uniforme, facilitando processamentos posteriores.
Removê-lo também acaba melhorando a qualidade da imagem ao subtrair padrões de interferência
indesejados, provenientes de imperfeições no sistema óptico, como partículas de poeira. Após re-
mover o fundo, a imagem é linearmente normalizada para que ocupe todo o intervalo [0, 255]. Isso
acaba adicionando um termo constante em toda a imagem, o que facilita sua visualização, mas pode
trazer problemas se não for feito um tratamento adequado da borda, conforme será discutido em
uma seção posterior e com mais detalhes no Capítulo 4.

Durante os experimentos que foram realizados, foram testadas duas maneiras de se obter a
imagem de fundo. A primeira consistiu na obtenção de uma sequência curta de imagens antes da
colocação da amostra a ser observada. Com isto, é possível calcular uma imagem média de fundo,
que é subtraída das imagens obtidas após a colocação da amostra. A maior dificuldade desta técnica
consiste na fixação dos componentes. Na prática, ao capturar estas imagens em laboratório, é preciso
colocar uma amostra de água do mar filtrada, e só depois substituí-la pela amostra de interesse.
Nesta substituição, muitas vezes o recipiente acaba sendo levemente movido, o que é suficiente
para mudar completamente o fundo do holograma. Embora ainda não tenha sido testada em um
equipamento in situ, é possível que outras dificuldades apareçam. Alguns detritos podem grudar
nos vidros externos, prejudicando a qualidade da imagem. Caso o fundo seja calculado previamente,
eles não serão parcialmente removidos junto com o fundo. O fundo também pode ser influenciado
pela profundidade sendo amostrada, alterando a proporção da iluminação laser que é absorvida pela
água e a intensidade da iluminação solar que pode chegar na câmera.

A outra técnica testada consiste no cálculo do fundo a partir dos hologramas obtidos das amos-



14 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.1

(a) Holograma original (b) Holograma sem fundo

Figura 3.3: Exemplo de remoção de fundo de um holograma utilizando a média de vários hologramas.

tras. Caso existam hologramas suficientes, é possível calcular uma simples média a partir de uma
seleção grande (maior do que 50, por exemplo) dos hologramas, preferencialmente com organismos
ocupando posições diferentes da imagem, e utilizá-la como fundo. Um exemplo do resultado desta
técnica pode ser visto na figura 3.3. Caso a quantidade de hologramas disponíveis para o cálculo
seja pequena (como 30 imagens no total, por exemplo), a média de intensidade de cada pixel pode
ser feita desconsiderando uma certa porcentagem (obtida experimentalmente) dos valores mais ex-
tremos, com o objetivo de ignorar grande parte dos pixels que representam a interferência de algum
organismo em movimento. Isto supõe que, embora existam poucas imagens, elas são suficientemente
diferentes umas das outras, não havendo nenhuma região que é ocupada por organismos na maior
parte dos hologramas.

Um exemplo de subtração da média local em blocos, para uniformizar a iluminação do holo-
grama, pode ser encontrado na dissertação de mestrado de Domínguez-Caballero [DC06]. A des-
vantagem é que os padrões de interferência indesejados não são minimizados, e a iluminação realiza
pequenos saltos de um bloco para outro. Isto fez com que, na dissertação citada, esta imagem sem
fundo tenha sido utilizada apenas para realizar uma segmentação inicial, não sendo utilizada nas
reconstruções dos segmentos.

3.1.2 Algoritmos de reconstrução

Tradicionalmente, a reconstrução holográfica é feita iluminando o holograma por uma onda
igual ao feixe de referência utilizado, embora alguns tipos de holograma permitam outras formas de
iluminação, como luz branca. Em holografia digital, a iluminação do holograma e sua observação é
feita numericamente, calculando-se o efeito de difração que a onda sofreria ao passar pelo holograma.

Após a remoção do fundo, e supondo que o termo U2 pode ser ignorado, conforme discutido
anteriormente, ao iluminar o holograma por uma onda plana B o campo resultante é

EB = ?
?A?Ba(x, y) + ??ABa?(x, y).

= U3 + U4.

Como estamos iluminando por uma onda plana B qualquer, podemos escolher os parâmetros desta
onda da forma que for mais conveniente, com a única restrição de que a amplitude deve ser estrita-
mente maior do que zero. Ou seja, podemos supor que, em todo o plano (x, y), ela possui amplitude
igual a 1 e fase igual a 0, o que significa que iluminar o holograma por B consiste em multiplicá-lo
por 1. Portanto, esta operação pode ser ignorada, e utilizamos os valores originais do holograma
como sendo o holograma iluminado por uma onda plana. Caso estivéssemos utilizando uma onda
esférica, por exemplo, isto não seria possível, pois a fase da onda seria diferente dependendo da



3.1 HOLOGRAFIA 15

(a) Magnitude (b) Parte Real (c) Parte Imaginária (d) Fase

Figura 3.4: Reconstrução de um organismo de amplitude.

(a) Magnitude (b) Parte Real (c) Parte Imaginária (d) Fase

Figura 3.5: Reconstrução de um organismo de fase.

posição no holograma.
Para obter a onda a(x, y) do objeto focalizada, ainda precisamos propagar a onda à distância

zo, pois estamos no plano do holograma e queremos a onda no plano do objeto. Esta propagação é
feita numericamente utilizando as fórmulas de difração presentes na seção 2.2, como será detalhado
abaixo. Após realizar esta propagação, obtemos a soma da imagem do objeto com sua imagem
desfocada a uma distância 2zo, cada uma correspondendo a um dos termos U3 e U4.

O resultado da propagação é uma matriz de números complexos E(x, y; zo), a partir da qual
podemos calcular a magnitude

I = |E|,

a intensidade que seria observada opticamente

I = |E|2,

e a fase ? a partir de

tan[?] =
Im[E]

Re[E]

Nas figuras 3.4 e 3.5 podem ser vistos exemplos do resultado desta propagação.
A seguir apresentamos a Reconstrução pela Integração de Fresnel e a Reconstrução por Convo-

lução, que são formas diferentes de utilizar as fórmulas da seção 2.2 para calcular a propagação da
onda a uma distância z.

Reconstrução pela Integração de Fresnel

Fazendo as substituições

? =
x

?z
µ =

y

?z
(3.4)



16 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.1

na equação 2.9, temos

U(?, µ) =
?j
?z

ej??z(?
2+µ2)

+?????
??

1? ?? ?
U(?, ?)ej

?
?z

(?2+?2) e?j2?(??+µ?)d?d?

? ?? ?
2

,

onde omitimos o fator ejkz, pois só altera a fase globalmente. O termo (2) é a transformada de
Fourier do termo (1), ou seja,

U(?, µ) =
?j
?z

ej??z(?
2+µ2)F

{?
U(?, ?)ej

?
?z

(?2+?2)
}?
.

Portanto, podemos reconstruir o holograma a uma distância z calculando [SJ02]

Irec = d · FFT(Iholo · c),

onde · representa a multiplicação ponto a ponto, Iholo é a imagem do holograma, e

c(?, ?) = ej
?
?z

(?2+?2) d(?, µ) =
?j
?z

ej??z(?
2+µ2).

Podemos ignorar o termo d se não estivermos interessados na fase.
As seguintes relações são válidas na transformada de Fourier para as dimensões dos pixels ?? e

?? no holograma original:

?? =
1

M??
?µ =

1

N??
,

onde M e N são o número de pixels em cada eixo. Após refazermos a substituição da equação 3.4,

?x =
?z

M??
?y =

?z

N??

Podemos ver que o tamanho ?x do pixel na reconstrução não é necessariamente igual ao tama-
nho ?? do pixel no holograma, podendo ser maior ou menor dependendo da distância da recons-
trução. Por causa disto, este algoritmo não é utilizado para calcular propagações a distâncias muito
pequenas.

Para manter o tamanho do pixel aproximadamente constante, pode-se aumentar a imagem com
zeros, alterando com isso os valores de M e N e as dimensões de ?x e ?y. Porém, isso aumenta
o custo computacional consideravelmente, não sendo prático a distâncias um pouco maiores. Como
exemplo, se estivermos calculando uma reconstrução com ? = 660nm, ?x = 3, 45µm e z = 15cm,
precisaríamos ter M ? 8317 pixels.

Uma outra maneira de manter as dimensões dos pixels é através do cálculo do espectro apenas
das frequências mais baixas, utilizando o algoritmo conhecido como Chirp Z-Transform [RSR69],
cujo resultado é ilustrado na figura 3.6. Porém, isto envolve o cálculo de uma convolução entre matri-
zes de números complexos, eliminando assim a principal vantagem deste algoritmo de reconstrução
holográfica, que é a eficiência obtida com o cálculo de uma única FFT.

Reconstrução por Convolução

É possível reconstruir o holograma realizando a convolução pela função h(x, y), obtida na discus-
são sobre difração escalar, e que depende dos parâmetros do experimento e a distância de propagação
escolhida. Como é possível calcular a transformada de Fourier de h(x, y) analiticamente, iremos uti-
lizar a matriz H(x, y) resultante, o que evita computações desnecessárias. O cálculo da reconstrução



3.1 HOLOGRAFIA 17

(a) Reconstrução padrão (b) Reconstrução com Chirp Z-Transform

Figura 3.6: Reconstrução holográfica pelo algoritmo da Integração de Fresnel. Como o holograma original
possuía diferentes números de pixels nos dois eixos, isto resulta em diferentes dimensões dos pixels na
reconstrução padrão. Estas imagens exibem apenas a região central da reconstrução de um padrão de teste
de resolução 1951 USAF, a cerca de 15,6 cm de distância.

Irec à distância z, utilizando o holograma Iholo e a função de transferência H, é

Irec = IFFT(FFT(Iholo) · H),

onde · representa a multiplicação ponto a ponto. Embora pareça simples, existem alguns detalhes
de implementação importantes que serão mencionados na seção 3.2. Se desejarmos calcular diversas
distâncias de propagação do mesmo holograma, podemos guardar o resultado de FFT(Iholo) e exe-
cutar apenas os cálculos restantes. Desta forma calculamos a transformada de Fourier do holograma
uma única vez, e cada reconstrução posterior necessita apenas do cálculo da função H e de uma
transformada inversa de Fourier.

A partir das fórmulas da seção 2.2, temos as funções de transferência

He(fX, fY ) =

??
?exp

[?
jkz
??

1 ? (?fX)2 ? (?fY )2
]?

se
??
f2X + f

2
Y ?

1
?

0 caso contrário
(3.5)

Hf(fX, fY ) = e
jkz exp

[?
?j??z(f2X + f

2
Y )
]?

(3.6)

onde He é a função de transferência “exata” obtida no método do espectro angular, e Hf é a
aproximação de Fresnel. Não existe diferença significativa entre o resultado obtido a partir das
duas funções, exceto em distâncias extremamente pequenas ou em casos em que as distâncias
laterais não são pequenas em relação à distância axial, conforme já foi estudado em diversos artigos
[Sou81, SR89, MH03]. A aproximação de Fresnel pode resultar em uma computação mais rápida,
por não exigir o cálculo de uma raiz quadrada, e o termo ejkz pode ser ignorado, pois podemos
supor que estamos iluminando o holograma com uma onda plana da forma e?jkz, o que cancelaria
este termo.



18 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.1

3.1.3 Captura e propagação das frequências em holografia digital

Para visualizar os efeitos da propagação numérica do holograma, iremos analisar separadamente
frequências da forma

ufx = rect
(?x
L

)?
exp(j2?xfx),

onde L é a largura do holograma e fx é a frequência sendo estudada. No caso de hologramas digitais,
L é a largura do sensor da câmera referente à região do holograma sendo reconstruída. Limitar-
nos-emos ao caso unidimensional, já que as duas dimensões podem ser facilmente separadas na
aproximação de Fresnel.

A propagação da frequência fx = 0 reduz-se à difração por uma abertura retangular, que pode
ser calculada numericamente através das integrais de Fresnel [Goo96]. Supondo que a distância de
propagação não é extremamente grande, condição que é satisfeita na holografia de plâncton, quase
toda a intensidade continuará no intervalo original de largura L.

Seja U0 = F {u0}, ou seja, U0 é a transformada de Fourier quando fx = 0. A propagação de
uma frequência fx ?= 0 a uma distância z é

ufx(x; z) = F
?1
{?
F
{?
rect

(?x
L

)?
exp(j2?xfx)

}?
(?) · Hz(?)

}?
(x)

= F?1
{?
F
{?
rect

(?x
L

)?}?
(? ? fx) · Hz(?)

}?
(x) (Propriedade de deslocamento)

= F?1 {[U0(?) · Hz(? + fx)] (? ? fx)} (x) (Reorganizando deslocamentos)
= F?1 {U0(?) · Hz(? + fx)} (x) · exp(j2?xfx)

Utilizando a aproximação de Fresnel, e ignorando o termo global de fase que não depende da
frequência, temos

Hz(? + fx) = exp
[?
?j??z(? + fx)2

]?
= exp

[?
?j??z(?)2

]?
exp [?j??z(2?fx)] exp

[?
?j??z(fx)2

]?
= Hz(?) exp (?j2??fx?z) exp

(?
?j??zf2x

)?
.

Portanto,

ufx(x; z) = F
?1 {?U0(?) · Hz(?) · exp (?j2??fx?z) exp(??j??zf2x)?}?(x) · exp(j2?xfx)

= F?1 {U0(?) · Hz(?) · exp (?j2??fx?z)} (x) · exp
(?
?j??zf2x

)?
exp(j2?xfx)

= F?1 {U0(?) · Hz(?)} (x ? fx?z) · exp
(?
?j??zf2x

)?
exp(j2?xfx)

= u0(x ? fx?z; z) exp
(?
?j??zf2x

)?
exp(j2?xfx).

Podemos tirar algumas conclusões a partir desta fórmula, que é uma aplicação direta da propri-
edade de deslocamento da Transformada Canônica Linear (Linear Canonical Transform) [HS05].
A primeira é a de que todas as frequências são preservadas, o que pode ser visto no último termo,
sofrendo apenas uma mudança de fase, representada pelo segundo termo. Isto já era esperado pela
forma da função de transferência na aproximação de Fresnel, que possui amplitude unitária em toda
sua extensão e apenas altera as fases. A segunda é a de que todas as frequências sofrem o mesmo
efeito de difração pela borda do holograma, o que pode ser visto no primeiro termo u0(?; z). É im-
portante notar que isto é uma consequência da aproximação de Fresnel, que remove a raiz quadrada
da função de transferência, fazendo com que todas as frequências sejam tratadas de forma linear.
Por último, cada frequência desloca-se uma distância fx?z com a propagação.

Nas figuras 3.7, 3.8 e 3.9 é possível visualizar os deslocamentos que ocorrem com diferentes
frequências nas reconstruções holográficas. Outro fenômeno que pode ser observado é o que ocorre
na figura 3.9, onde o holograma possui apenas valores reais, ou seja, seus valores imaginários são
nulos, sendo portanto mais representativo dos hologramas deste trabalho, já que não utilizamos
nenhuma técnica de recuperação de fase. Sem a informação da fase, a frequência divide-se em duas,



3.1 HOLOGRAFIA 19

Figura 3.7: Exemplo numérico da propagação das frequências de um holograma, que está na região central
à esquerda, sendo iluminado por uma onda plana que se propaga para a direita. Cada coluna da imagem
é calculada a partir da reconstrução numérica do holograma até a distância apropriada, sendo exibida a
amplitude resultante. A onda plana é bloqueada nas duas regiões à esquerda que não fazem parte da região
central com o holograma. O holograma é formado pela adição de três funções cosseno, com frequência linear,
e tem sua intensidade modulada por uma função gaussiana para evitar os efeitos de difração da borda. Uma
destas frequências é nula, formando a região central do feixe, e as outras duas frequências formam os outros
quatro feixes. Como o holograma possui apenas valores reais, sem a parte imaginária, cada frequência não
nula presente no holograma provoca o surgimento de dois feixes, que correspondem àquela frequência em
sentido horário e anti-horário. A maior frequência forma os feixes externos, pois se desloca mais com a
propagação.



20 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.1

(a) Propagação de frequência de 15 ciclos/centímetro

(b) Propagação de frequência de 45 ciclos/centímetro

Figura 3.8: Exemplo numérico da propagação de uma frequência baixa. O holograma unidimensional é
exibido no topo de cada imagem, sendo calculada sua reconstrução a diferentes distâncias, até 4 m. Apenas
a parte real é exibida, pois a parte imaginária é bem similar, e a intensidade do holograma foi modulada
por uma função gaussiana, para que não ocorram efeitos de difração da borda. Cada pixel possui 4 µm de
largura, e foi simulada a iluminação por um laser com comprimento de onda igual a 660 nm. Cada frequência
desloca-se uma distância fx?z com a propagação, ou seja, após 4 m a frequência de 15 ciclos/centímetro sofre
um deslocamento de 15 × 102 × 660 × 10?9 × 4 = 3.96 × 10?3 m, e a frequência de 45 ciclos/centímetro sofre
um deslocamento de 45 × 102 × 660 × 10?9 × 4 = 1.188 × 10?2 m, conforme pode ser observado na parte
inferior de cada figura.



3.1 HOLOGRAFIA 21

Figura 3.9: Exemplo numérico da propagação de uma frequência baixa, de 45 ciclos/centímetro. O holo-
grama unidimensional é exibido no topo da imagem, sendo calculada sua reconstrução a diferentes distâncias,
até 4 m. A parte imaginária do holograma é nula, pois este é formado por uma função cosseno, e sua in-
tensidade foi modulada por uma função gaussiana, para que não ocorram efeitos de difração da borda. Cada
pixel possui 4 µm de largura, e foi simulada a iluminação por um laser com comprimento de onda igual a
660 nm. Como cada frequência desloca-se uma distância fx?z com a propagação, após 4 m a frequência de
45 ciclos/centímetro sofre um deslocamento de 45 × 102 × 660 × 10?9 × 4 = 1.188 × 10?2 m, conforme pode
ser observado na parte inferior da figura. O holograma não possui parte imaginária, portanto é equivalente
à soma de duas frequências idênticas, mas em sentidos opostos, o que faz com que suas partes imaginárias
se anulem, pois cos x = (eix + e?ix)/2. Com a propagação, estas duas frequências sofrem deslocamentos em
sentidos opostos, separando-se uma da outra.



22 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.2

cada uma sofrendo um deslocamento em uma direção. Visualmente, isto corresponde à formação
da imagem real e da imagem virtual (ou imagem gêmea).

Caso estejamos interessados em obter a propagação do holograma para uma região paralela
de mesma largura L, que está à distância z do holograma e diretamente à sua frente, podemos
supor que as frequências que tenham se deslocado mais do que L podem ser ignoradas. Ou seja, as
frequências fx presentes na reconstrução são

|fx| ?
L

?z
(3.7)

Historicamente, este resultado relaciona-se à teoria da formação da imagem de E. Abbe [Abb73], que
estudou a difração da luz em microscópios e observou que frequências mais altas afastam-se mais do
eixo ótico, levando a uma perda da qualidade da imagem obtida quando parte das frequências não é
capturada ou sofre distorções devido às lentes. A fórmula 3.7 obtida acima é similar às fórmulas (17)
e (20) apresentadas no artigo de Kelly et al. [KHHS11], que considera a formação do holograma,
não sua reconstrução. Um artigo mais recente de Kelly [Kel14] considera esta análise do ponto de
vista da reconstrução numérica.

Também precisamos considerar o efeito de amostragem e integração realizado pelos pixels da
câmera. A integração pelos pixels resulta na aplicação de um filtro passa-baixa no holograma, e a
amostragem impede que frequências acima de 1

2?x
sejam representadas no espectro, onde ?x é a

largura de um pixel no eixo x, resultando em aliasing.
Pode-se dividir a propagação em três regiões [KNR+09], uma na qual a abertura da câmera

limita a resolução, outra na qual tanto a abertura quanto o tamanho do pixel limitam a resolução,
e uma última na qual apenas o tamanho do pixel limita a resolução. Supondo que a região a ser
reconstruída e o holograma possuem largura L, a integração do pixel pode ser ignorada quando

?x ?
3

10

[?
?z

L

]?
. (3.8)

E a abertura da câmera pode ser ignorada quando

?x ? 6
[?
?z

L

]?
.

Kelly et al. [KHHS11] fazem uma análise mais geral, considerando diversos tipos de sistemas
holográficos, e uma das conclusões é a de que uma iluminação esférica altera a distribuição das
frequências, o que pode permitir uma reconstrução mais exata em comparação à iluminação plana.

Na figura 3.10 podemos ver um exemplo numérico destas equações quando ? = 660 nm, L =
7.0725 mm e ?x = 3.45 µm. Até cerca de 7.5 cm, o tamanho dos pixels impede que todas as
frequências que poderiam estar na reconstrução sejam corretamente amostradas. Na região em
vermelho, a partir de pouco mais de 12 cm, uma parte considerável das frequências presentes na
imagem não fará parte de uma reconstrução com a mesma largura do holograma, e diminuir o
tamanho dos pixels não traria grandes benefícios, pois a resolução está limitada pelo tamanho do
sensor da câmera. A região em que a abertura da câmera pode ser ignorada não é exibida por ser
extremamente pequena, extendendo-se a pouco mais de 6 mm de distância do holograma.

3.2 Detalhes de implementação

3.2.1 FFT real e funções de transferência

Para calcular a transformada de Fourier do holograma, é altamente recomendável utilizar a
versão da FFT para matrizes reais, que aproveita a simetria existente no espectro para diminuir
consideravelmente o tempo de processamento e o uso de memória. Com isso, não é possível utilizar
a versão original da função de transferência, pois ela é a transformada de Fourier de uma matriz de



3.2 DETALHES DE IMPLEMENTAÇÃO 23

Figura 3.10: Exemplo numérico das frequências presentes em um holograma com ? = 660nm, L =
7, 0725mm e ?x = 3, 45µm. A linha horizontal preta é a frequência de Nyquist, a região azul representa
as frequências que satisfazem a equação 3.7 e fazem parte da reconstrução, e a região vermelha é a área em
que a integração do pixel pode ser ignorada segundo a equação 3.8.

números complexos. Portanto, para obter os mesmos resultados é necessário separá-la em termos de
seno e cosseno, e realizar as convoluções separadamente, somando os resultados no final. Ou seja,
para obter a reconstrução Irec a partir do holograma Iholo, calculamos

Irec = IFFTreal(IFFT · Hcos) + 1j · IFFTreal(IFFT · Hsin)

onde IFFT = FFTreal(Iholo), Hcos = Re[Hf] e Hsin = Im[Hf]. Note que, por se tratar da trans-
formada de Fourier de uma matriz real, uma das dimensões terá metade do tamanho da imagem
original, e os índices da função de transferência devem percorrer apenas os valores não negativos
nesta dimensão.

Se supusermos que o objeto de interesse possui apenas absorção da luz, não afetando a fase
da onda, podemos aproximar a magnitude calculando apenas a parte real da convolução, ou seja,
utilizamos apenas a função de transferência Hcos.

3.2.2 Sobreposição espacial

Ao realizar a convolução através da FFT, estamos calculando uma convolução circular, o que
pode ter resultados indesejados se não forem tomados certos cuidados. Como a iluminação do feixe
de laser normalmente é bem maior do que a área do sensor, padrões de interferência de objetos
que não estão diretamente à frente da câmera acabam criando padrões na área do sensor. Uma
situação similar pode ocorrer se estivermos reconstruindo apenas uma região do holograma, que
pode conter a interferência de objetos próximos desta região. O resultado é que, ao reconstruir o
holograma utilizando uma convolução circular, objetos que estão logo à direita da área à frente
da câmera acabam sendo parcialmente reconstruídos na região esquerda do holograma, aparecendo
como “imagens fantasmas”. Algo análogo ocorre nas outras bordas, e objetos que são cortados pela
borda continuam na borda oposta, de forma mais fraca e menos detalhada. Os efeitos da convolução
circular podem ser vistos nas imagens de algumas publicações [CVM+11, SBB+08] e na figura 3.11.

A FFT supõe que estamos calculando a transformada de Fourier de uma função periódica, e
o efeito disso é que, ao calcularmos a difração como uma convolução, de um ponto de vista físico
estamos calculando a difração de uma parede formada por infinitas cópias do holograma lado a
lado. Lembrando da análise apresentada na seção 3.1.3, vemos que as frequências mais altas destas
cópias acabam sobrepostas na reconstrução, causando a perda da qualidade da imagem descrita



24 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.2

(a) Holograma (b) Reconstrução com “imagem fantasma”

Figura 3.11: Reconstrução holográfica com sobreposição espacial. No holograma existem ondas de difração
de outro organismo na parte superior da imagem, que provocam o surgimento de uma “imagem fantasma”
deste organismo na parte inferior da reconstrução.

acima. Note que na reconstrução pela integração de Fresnel, como o tamanho dos pixels diminui
de forma inversamente proporcional à propagação da frequência de Nyquist, esta sobreposição não
ocorre neste algoritmo.

Para diminuir o efeito destas sobreposições, uma abordagem é aumentar o holograma com ze-
ros, deixando-o com tamanho suficiente para que nenhuma frequência se afaste a ponto de causar
problemas [Kel14, KFK12]. Porém, com o aumento da distância isso provoca um aumento compu-
tacional considerável, e uma abordagem mais razoável é a combinação da adição de zeros com um
filtro passa-baixa.

Para calcular a convolução linear, podemos fazer com que o holograma fique com o triplo do
tamanho adicionando zeros, e calculamos a função de transferência como sendo a transformada de
Fourier de

hR(x, y) =
ejkz

j?z
exp

[?
j
k

2z
(x2 + y2)

]?
rect

(?
x

2LX

)?
rect

(?
y

2LY

)?
,

com LX e LY sendo iguais ao tamanho original do holograma nos dois eixos. Note que estamos
usando a aproximação de Fresnel.

Podemos evitar o cálculo da transformada de Fourier de hR(x, y) fazendo algumas aproximações.
As frequências locais de hR(x, y) são

flX =
x

?z
rect

(?
x

2LX

)?
, flY =

y

?z
rect

(?
y

2LY

)?
.

Portanto, podemos aproximar o espectro de Fourier de hR(x, y) calculando Hf(x, y), como definida
na equação 3.5, e aplicando um filtro para suprimir frequências maiores do que

fMAXlX =
LX
?z

, fMAXlY =
LY
?z

.



3.2 DETALHES DE IMPLEMENTAÇÃO 25

Figura 3.12: Exemplo numérico da propagação das frequências de um holograma, utilizando um filtro para
suprimir frequências acima de fc = L?z . Os parâmetros utilizados foram ? = 660nm, L = 7, 0725mm,
z = 10cm e ?x = 3, 45µm. Foram propagados dois hologramas: o de uma onda plana (constante igual a
1), e o de uma onda com frequência igual a fc. Adicionou-se zeros para duplicar o tamanho do holograma,
e esta região adicional, demarcada com linhas verticais pretas, é exibida no lado direito da figura. A curva
azul mostra a intensidade da difração da onda plana, e a curva verde mostra a intensidade da difração da
onda de frequência fc. Em vermelho, é possível ver a intensidade da difração da onda de frequência fc, sem
a utilização de nenhum filtro passa-baixa.

Esta condição é igual à da equação 3.7, e devido à análise da propagação das frequências, podemos
adicionar zeros no holograma para que tenha apenas o dobro do tamanho, e não o triplo, sem que
isso cause muita degradação na reconstrução.

Na figura 3.12 é possível ver o efeito de aplicar um filtro passa-baixa, no caso uma janela de Tu-
key, para suprimir frequências acima de fc = L/(?z). No lado esquerdo da figura aparecem os efeitos
da convolução circular. Embora a onda propagada sem o filtro, em vermelho, tenha uma intensidade
considerável na borda esquerda, a onda filtrada, em verde, possui uma intensidade extremamente
baixa. Na borda direita da região sendo propagada, que aparece demarcada por uma linha vertical
no centro da figura, é possível ver que as ondas em verde e vermelho possuem intensidades muito
próximas, exceto nos cerca de 25 pixels finais, em que a onda em verde acaba tendo uma intensidade
menor devido ao filtro. Todas as difrações foram calculadas com a aproximação de Fresnel, e a falta
de simetria na onda em vermelho provavelmente se deve à baixa taxa de amostragem da função de
transferência, assunto que será tratado em uma seção posterior.

3.2.3 Efeito de borda

Ao reconstruir o holograma, o resultado é não apenas a difração da imagem formada no sensor
da câmera, mas também a difração da abertura retangular que limita esta região. Isto gera artefatos
indesejáveis, como ilustrado na figura 3.13. Trataremos deste assunto com detalhes no Capítulo 4.

3.2.4 Amostragem

A função de transferência Hf(fX, fY ) apresenta frequências que aumentam conforme a distância
ao centro, e pode sofrer problemas de amostragem caso estas frequências ultrapassem a frequência
de Nyquist. Como na aproximação de Fresnel os dois eixos são separáveis, faremos a análise do caso
unidimensional, e as mesmas fórmulas serão válidas no caso bidimensional para os dois eixos. A



26 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.2

(a) Reconstrução de holograma estendido com zeros

Figura 3.13: Efeito da borda na reconstrução holográfica. A reconstrução exibe os efeitos da difração da
borda, pois no cálculo da convolução o holograma foi estendido com zeros.

frequência local de Hf(fX) é
flX = ??zfX.

Note que flX refere-se à frequência local de Hf , enquanto que fX refere-se à frequência do espectro
de hf .

Para satisfazer o critério de amostragem, é preciso que [VR09]

|?zfX|&amp;lt;
1

2?fX
.

Supondo que o tamanho do holograma foi duplicado com zeros, e sua largura original é L, temos

?fX =
1

2L
.

Logo, precisamos satisfazer
|?zfX| &amp;lt;L.

Supondo que z, ? ? 0,
|fX|&amp;lt;

L

?z
.

Ou seja, temos novamente a equação 3.7.
Para satisfazer esta equação, podemos suprimir as frequências mais altas, o que foi sugerido

no método conhecido como “Band-Limited Angular Spectrum” [MS09], que trata do algoritmo do
Espectro Angular, não da Aproximação de Fresnel. Alguns artigos posteriores sugerem melhorias
adicionais [YXY+12, YXH+12].

Observando a amostragem de Hf , poderíamos argumentar que, caso uma distância z viole a
condição acima, é possível calcular várias propagações a distâncias menores, que separadamente
não violam esta condição, e que somadas resultam na distância z desejada. Observando a fórmula
da função de transferência Hf , fica óbvio que isto não iria alterar em nada o resultado, exceto
possivelmente por alguns pequenos erros numéricos. A propagação por distâncias menores múltiplas
vezes já foi sugerida na literatura [Kre02, Syp95], embora outros artigos digam que esta abordagem
apresenta os mesmos problemas [VR09], ou os troca por novos tipos de erros [MS09], dependendo
dos detalhes de implementação.



3.3 DETALHES DE IMPLEMENTAÇÃO 27

Também é interessante observar o caso em que

fNYQ&amp;lt;
L

?z
,

o que ocorre a pequenas distâncias de propagação, ou seja, quando

z&amp;lt;
L2?x

?
.

Se observarmos a função hf , vemos que sua frequência local é

flX =
x

?z
,

e para satifazer o critério de amostragem é necessário que

x

?z
&lt;

1

2?x
.

Como estamos calculando hf em uma região de largura 2L, o valor máximo de x é L, e portanto a
distância z precisa satisfazer

z &gt;
L2?x

?
.

Ou seja, quando temos uma superamostragem de Hf , a função hf está subamostrada, e vice-versa
[VR09].

A função Hf pode ser interpretada como uma função chirp [Goo96] multiplicada por uma janela
retangular, limitando sua extensão ao domínio em que a frequência de Nyquist não é ultrapassada. A
Transformada Inversa de Fourier de Hf é, aproximadamente, uma função chirp em que a magnitude
é próxima de 1 em uma região finita, e próxima de 0 nas demais regiões [Goo96, VR09]. Conforme a
distância z diminui, a Transformada Inversa de Fourier de Hf corresponde aproximadamente a um
chirp de duração finita cada vez menor, não violando a condição de amostragem de hf . Do ponto
de vista da convolução, ao calcularmos a propagação utilizando Hf , o tamanho finito da função hf
correspondente limita os ângulos de difração sendo calculados. Utilizando a discussão anterior sobre
a propagação das frequências, podemos calcular o ângulo máximo de difração na aproximação de
Fresnel como sendo [DC06]

?MAX = arctan

(?
fNYQ?z

z

)?
= arctan

(?
?

2?x

)?
.

Como exemplo, quando temos ? = 660 nm e ?x = 3.45 µm, o ângulo máximo de difração é
?MAX ? 0.095 radianos, ou cerca de 5.45?. Isso significa que os ângulos de difração sendo calculados
são pequenos o suficiente para que a aproximação de Fresnel seja válida, obtendo resultados muito
próximos aos do método do Espectro Angular, mesmo a pequenas distâncias. O método do Espectro
Angular só apresentaria diferenças significativas em relação à Aproximação de Fresnel caso ? seja
maior ou aproximadamente igual a ?x, o que não ocorre com o comprimento de onda usado em
holografia de plâncton e a tecnologia atual de sensores CCD (não estamos considerando o caso de
microscopia holográfica).

A tese de Domínguez-Caballero [DC06] considera que este ângulo determina uma distância mí-
nima para que um objeto possa ser observado, de forma que não ocorra aliasing. Porém, a distâncias
menores do que a recomendada na tese, este aliasing apenas causaria a perda de detalhes mais finos,
que também não seriam gravados a uma distância maior, e possivelmente uma pequena degradação
na imagem. A distâncias extremamente curtas, a proximidade da imagem gêmea provavelmente
seria muito mais problemática do que o aliasing. Realizamos experimentos nos quais foram grava-
das imagens a distâncias menores do que a recomendada na tese citada, sem que isso provocasse
nenhuma perda perceptível na qualidade da imagem.



28 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.3

3.3 Segmentação de região de interesse

Para diminuir o tempo de processamento, o holograma é segmentado em diversas regiões de
interesse, cada uma correspondendo idealmente a um único organismo. Esta segmentação envolve
duas etapas: primeiro determinamos as coordenadas de um retângulo que envolve o organismo nos
eixos x e y, e depois determinamos a profundidade z na qual ele se encontra melhor focalizado. De-
terminar as posições laterais na qual um objeto de interesse se encontra também ajuda a determinar
a melhor distância de focalização.

3.3.1 Reconstrução volumétrica

Milgram e Li [ML02] sugeriram calcular a média de várias reconstruções em intervalos igualmente
espaçados, entre as profundidades za e zb, e segmentar esta reconstrução média. Como isto é uma
soma de convoluções onde um dos termos é o holograma, podemos somar as funções de transferência
e realizar uma única convolução. E devido à forma da função de transferência, esta soma é uma
série de potências que pode ser calculada analiticamente.

Se fizermos os intervalos entre as diferentes reconstruções tender a zero, o resultado é a integral
[Loo11]

SK =
1

zb ? za

?? zb
za

exp(?j??z(f2X + f
2
Y ))dz

=
exp(?j??zb(f2X + f

2
Y )) ? exp(?j??za(f

2
X + f

2
Y ))

?j??(zb ? za)(f2X + f
2
Y )

.

Observando o termo (f2X + f
2
Y ) do denominador, podemos ver que isso tem o efeito de um filtro

passa-baixa, o que ajuda a visualizar objetos maiores e elimina oscilações rápidas e objetos muito
pequenos.

Se considerarmos apenas a parte real da função de transferência, temos

SKREAL =
1

zb ? za

?? zb
za

cos(??z(f2X + f
2
Y ))dz

=
sin(??zb(f

2
X + f

2
Y )) ? sin(??za(f

2
X + f

2
Y ))

??(zb ? za)(f2X + f
2
Y )

.

Supondo que za = 0,

SKREAL =
sin(??zb(f

2
X + f

2
Y ))

??zb(f
2
X + f

2
Y )

= sinc(?zb(f
2
X + f

2
Y )).

O holograma médio é então
Imedio = Iholo ? SK,

onde ? denota convolução.
A imagem Imedio é segmentada aplicando uma limiarização adaptativa. Primeiro a imagem é

normalizada linearmente para o intervalo [0, 255]. Então um filtro gaussiano com um valor elevado
para ? é aplicado, e a diferença entre a imagem filtrada e a original é limiarizada, utilizando um
valor estático determinado experimentalmente. A esta segmentação são adicionados pixels com
intensidades muito baixas na imagem Imedio, pois a limiarização adaptativa acaba desconsiderando
grandes regiões com baixa intensidade. Por fim, esta segmentação sofre uma pequena dilatação
binária e objetos muito próximos da borda são removidos.



3.4 SEGMENTAÇÃO FINAL 29

(a) Holograma original (b) Holograma médio (c) Holograma segmentado

Figura 3.14: Segmentação de um holograma em regiões de interesse. O holograma médio foi calculado após
a remoção do fundo do holograma original.

(a) Holograma não focalizado (b) Holograma focalizado

Figura 3.15: Focalização de um holograma segundo a medida de entropia. O holograma foi reconstruído a
várias distâncias, e a imagem à direita é a que obteve o melhor foco, minimizando a entropia.

3.3.2 Focalização

Para calcular a melhor distância de focalização, uma região com 4 vezes a largura e altura
segmentadas é reconstruída a várias distâncias, desde uma distância mínima za até uma distância
máxima zb, que dependem das distâncias usadas no experimento. Em cada reconstrução, é aplicada
uma medida de foco na região que foi segmentada originalmente. A imagem que maximiza (ou
minimiza) esta medida é considerada a melhor focalização, e à região originalmente segmentada é
adicionada uma borda fixa adicional de 50 pixels, determinada experimentalmente. A adição desta
borda fixa é para evitar o corte excessivo de pequenos detalhes dos organismos, como as antenas,
pois estas não podem ser detectadas na reconstrução volumétrica. O uso de uma região 4 vezes
maior em largura e altura para a reconstrução tem o objetivo de não perder muita qualidade, pois
como foi visto a dimensão lateral usada influencia diretamente nas frequências e detalhes presentes.

Várias medidas de foco podem ser usadas, e fazemos uma comparação experimental no Capí-
tulo 5.

3.4 Segmentação Final

Cada região focalizada é novamente segmentada, para determinar o formato e localização do
organismo na imagem. A segmentação é similar à das regiões de interesse, com uma limiarização
adaptativa, adição de pixels com intensidades muito baixas, e uma abertura morfológica. Isto pode
gerar vários segmentos, e apenas o de maior área é considerado. Caso o maior segmento possua um
centróide muito próximo da borda, ou uma área total muito pequena, esta imagem é desconsiderada



30 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.5

(a) Reconstrução focalizada (b) Segmentação

Figura 3.16: Segmentação final de uma região de interesse focalizada.

por se tratar de um erro de segmentação, não contendo nenhum organismo de interesse. Um exemplo
de segmentação pode ser visto na figura 3.16.

A partir desta segmentação poderiam ser extraídas várias características da região, e usadas em
um classificador automático, determinando o tipo de organismo planctônico presente na imagem.
Porém, não tratamos da classificação de organismos plânctonicos neste trabalho, deixando para um
trabalho futuro.

3.5 Outras considerações

3.5.1 Custo computacional

Não foram feitas medidas do custo computacional das diferentes etapas de processamento, mas
sabe-se que o maior gasto de tempo decorre do cálculo da FFT e sua inversa, que em uma imagem
de tamanho N ×N gasta O(N2 log N) operações. Cálculos como a limiarização da imagem possuem
custo O(N2).

Para reduzir o tempo de processamento, uma estratégia é diminuir o número de transformadas
de Fourier que precisam ser calculadas, ou diminuir o tamanho de cada uma. A segmentação inicial
do holograma em regiões de interesse segue esta ideia, pois cada segmento costuma ser significa-
tivamente menor do que a imagem total, diminuindo o tempo de processamento da reconstrução.
Ainda assim, a reconstrução de cada segmento a diferentes distâncias gasta um tempo considerável.

Outra opção é paralelizar o processamento, já que, exceto na obtenção do holograma da imagem
de fundo, todos os hologramas podem ser processados separadamente, e muitos dos cálculos podem
ser feitos de forma paralela. A implementação de parte do processamento em uma GPU já obteria
ganhos de tempo consideráveis [Loo11], embora esteja fora do escopo deste trabalho.

3.5.2 Processamentos adicionais

Além dos processamentos que foram realizados, existem vários outros que podem ser aplicados
para melhorar a qualidade das imagens obtidas. Embora a imagem gêmea não cause problemas
em alguns casos, quando temos uma maior quantidade de objetos sendo observados a imagem
reconstruída de um objeto não terá apenas o ruído de sua própria imagem gêmea, mas também
das imagens gêmeas de todos os outros objetos próximos. Existem diversas técnicas para diminuir
o efeito da imagem gêmea, e um resumo de várias delas pode ser visto no artigo de Hennelly et al.
[HKPM09].



3.5 OUTRAS CONSIDERAÇÕES 31

(a) Reconstrução padrão (b) Supressão da imagem gêmea

Figura 3.17: Ilustração do efeito da imagem gêmea. A segunda imagem foi calculada a partir da primeira,
realizando-se uma limiarização, propagando-se esta imagem binarizada para calcular uma estimativa da
imagem gêmea, e subtraindo esta imagem gêmea da imagem original. Com isso, podemos ter uma ideia do
efeito da imagem gêmea na qualidade da reconstrução, principalmente em imagens como esta, em que existem
vários elementos de tamanho razoável bloqueando a passagem da luz. Apenas a área central da reconstrução
de um teste de resolução 1951 USAF é exibida.

Também existe o efeito de objetos fora de foco, que pode aparecer sobre objetos focalizados
em outro plano. Para tentar resolver este problema foi sugerido que objetos focalizados sejam
segmentados e removidos do holograma, para que no processamento dos outros objetos eles não
apareçam desfocados [MDYL05].

Como é possível construir imagens focalizadas a várias distâncias, e normalmente várias destas
imagens possuem informações importantes que aparecem fora de foco nos outros planos, na área de
microscopia holográfica foi sugerido que se usasse uma medida de foco para combinar várias imagens
a distâncias diferentes, formando uma única imagem que seria estudada sem precisar mudar o foco
constantemente para observar outras características do objeto [BCP+09]. Porém, isto foi feito para
organismos transparentes, e faltam estudos sobre a aplicação desta ideia em organismos opacos.

Para tentar melhorar a qualidade da imagem reconstruída e a localização de partículas, foram
propostas formas de realizar a desconvolução complexa de um volume formado pela reconstrução do
holograma a diversas distâncias. Porém, as técnicas propostas parecem obter resultados melhores
para partículas do que para objetos extensos [LGF10, DCG11].

Por fim, é importante ressaltar que várias destas técnicas estão intimamente relacionadas, com
algoritmos de desconvolução sendo aplicados tanto para remover a imagem gêmea quanto para me-
lhorar a localização de partículas e a qualidade das imagens individuais de um volume; imagens
reconstruídas a diferentes profundidades sendo usadas para realizar a desconvolução, mas também
para criar uma única imagem melhor focalizada; e algoritmos que alternam entre diferentes planos
sendo aplicados na remoção da imagem gêmea e também em segmentações que diminuem os efeitos
de interferência entre os diferentes objetos. O artigo de Denis et al. [DFFD08] unifica alguns algo-
ritmos de remoção de imagem gêmea sob o ponto de vista da desconvolução, além propor um novo
algoritmo e observar sua relação estrita com algoritmos de segmentação.



32 PROCESSAMENTO DE HOLOGRAMAS DE PLÂNCTON 3.5



Capítulo 4

Efeito de borda

A propagação do holograma gera efeitos de difração não apenas devido à imagem formada no
sensor da câmera, mas também devido à borda do holograma. Neste capítulo, iremos tratar dos
diferentes métodos para minimizar os efeitos de difração pela borda nas reconstruções holográficas.

4.1 Introdução

No caso mais simples, onde o holograma é formado por uma iluminação uniforme e nenhum
objeto sendo observado, a reconstrução consiste na difração da luz por uma abertura retangular,
pois, assim como na aproximação de Fresnel (2.2.3), supomos na simulação numérica que a luz é
bloqueada na região exterior ao holograma. No caso de um organismo sendo reconstruído, temos
como resultado a combinação da imagem deste organismo com a difração da luz pela borda do holo-
grama. Isto gera diversos efeitos indesejáveis, alterando a fase e amplitude da imagem reconstruída
de forma brusca, o que diminui a qualidade da imagem, dificulta a observação dos organismos e
pode afetar o resultado de algoritmos de focalização e segmentação.

Na figura 4.1 é possível comparar duas reconstruções, nas quais o holograma original foi esten-
dido para o dobro de sua largura e altura utilizando diferentes métodos. Na primeira imagem, o
holograma é estendido preenchendo a área adicional com zeros, enquanto que na segunda imagem
essa extensão é feita com a média do holograma, apresentando efeitos de difração pela borda bem
menos visíveis. Na figura 3.12 também é possível ver o efeito da borda na intensidade da reconstru-
ção, neste caso em apenas uma dimensão, o que torna o efeito ainda mais evidente. A intensidade
original é igual a 1 em todas as curvas, mas ocorrem rápidas oscilações com a propagação, que são
exibidas na figura.

Para resolver este problema, na área de óptica costuma-se utilizar a técnica conhecida como
apodização, e que corresponde na área de processamento de sinais à aplicação de uma janela. Esta
janela torna a borda do holograma mais suave, evitando que ela contenha muitas frequências altas,
que são as mais problemáticas. Cuche et al. [CMD00] sugerem uma janela similar à de Tukey,
mas usando interpolação por uma função spline cúbica. Zhang et al. [ZFL+13] propõem uma outra
janela, calculada a partir da convolução da função retângulo com uma janela cosseno, e otimizando
os parâmetros.

Porém, técnicas de apodização e suas equivalentes digitais geram novas complicações, pois re-
duzem a visibilidade da região da borda, removendo informação da reconstrução que poderia ser
recuperada sem a janela. Para evitar esta perda de informação, existe uma alternativa digital que
seria de difícil execução através de instrumentos ópticos: pode-se estender o holograma artificial-
mente, adicionando-se pixels na região externa que extrapolam o que foi observado. Isto deve ser
feito sem que surjam frequências altas, para evitar o aparecimento de artefatos. A forma mais sim-
ples de extrapolar o holograma é utilizando a média no lugar de zeros na região externa. Dyomin
et al. [DO08] fazem uma aproximação por uma função spline bicúbica para estender o holograma,
e Dubois et al. [DMYL02] propõem um método de estender o holograma minimizando frequências
espaciais altas.

33



34 EFEITO DE BORDA 4.1

(a) Holograma estendido com zeros (b) Holograma estendido com a média

Figura 4.1: Efeito da borda na reconstrução holográfica. A primeira reconstrução exibe os efeitos da difração
da borda, pois no cálculo da convolução o holograma foi estendido com zeros. Na segunda reconstrução, o
holograma foi estendido com a média, apresentando efeitos menos significativos devido à borda.

(a) Holograma original (b) Holograma reconstruído com apodização

Figura 4.2: Apodização do holograma para evitar efeito da borda. É possível ver que a aplicação da janela
remove informação da região próxima à borda que está presente no holograma original. (Imagens obtidas do
artigo de Kebbel et al. [KHJ01])



4.2 MÉTODOS 35

(a) Imagem original (b) Imagem estendida

Figura 4.3: Extensão de holograma para evitar efeito da borda, utilizando o algoritmo proposto por Dubois
et al. O quadrado na segunda imagem indica a área original que foi estendida. (Imagens obtidas do artigo
de Dubois et al. [DMYL02])

Por fim, pode-se combinar as duas ideias e estender o holograma e aplicar uma janela nesta
extensão. Zhang et al. [ZZF+09] estendem o holograma copiando os valores da borda, o que é
computacionalmente mais eficiente do que calcular a extensão proposta por Dubois et al., e então
aplicam uma janela para diminuir o efeito destes novos valores, mas sem afetar a área original do
holograma. Com isso, resolve-se o problema da baixa visibilidade na região da borda, que ocorre
com a simples aplicação de uma janela, e do elevado custo computacional, que ocorre em extensões
mais elaboradas.

Porém, não está claro qual método resulta nos menores erros, pois vários artigos exibem apenas
uma comparação visual entre a extensão sendo proposta e a extensão com zeros, ou nenhuma
extensão [DMYL02, ZZF+09]. Assim, fazemos a seguir uma comparação experimental de diversos
métodos para avaliar os resultados obtidos e a complexidade computacional.

4.2 Métodos

Todos os métodos recebem um holograma de tamanho M ×N e devolvem um holograma esten-
dido de tamanho 2M × 2N, onde os pixels de [0, 0] a [M ? 1, N ? 1] são idênticos aos do holograma
original. Ou seja, trataremos aqui apenas de métodos que preenchem os pixels adicionais do holo-
grama estendido, sem modificar os valores presentes na região original do holograma.

Também poderíamos considerar métodos que aplicam uma janela ao holograma, fazendo os va-
lores da borda diminuirem gradativamente de magnitude até o valor zero. A aplicação de uma janela
poderia remover a necessidade de estender o holograma, o que seria desejável pois esta extensão au-
menta o custo computacional da reconstrução. Mas, conforme discutido anteriormente, para evitar
os efeitos de reconstruções “fantasmas” é necessário estender o holograma antes de reconstruí-lo,
ou seja, a aplicação da janela não seria suficiente e ainda seria necessário estender o holograma
com zeros. Estes métodos não trariam ganhos computacionais, além de remover informação pre-
sente na borda e, por estes motivos, métodos que alterem a região original do holograma não serão
analisados.

A seguir listamos as extensões de borda que serão comparadas.



36 EFEITO DE BORDA 4.2

(a) Zeros (b) Média (c) Cópia da borda

(d) Mediana da borda (e) Reflexão (f) Rampa linear

(g) Rampa linear circular (h) Filtro gaussiano com ? = 16 (i) Filtro gaussiano iterativo

Figura 4.4: Métodos de extensão de borda. A região superior esquerda contém a imagem original de tamanho
N × N, e as três regiões restantes, também de tamanho N × N cada uma, contêm a extensão da borda.



4.2 MÉTODOS 37

(a) Rampa linear com janela de
Tukey

(b) Cópia da borda com janela
Spline

(c) Mediana com janela de cosseno

(d) Minimização de frequências al-
tas

(e) Minimização do Laplaciano

Figura 4.5: Métodos de extensão de borda. A região superior esquerda contém a imagem original de tamanho
N × N, e as três regiões restantes, também de tamanho N × N cada uma, contêm a extensão da borda.



38 EFEITO DE BORDA 4.2

4.2.1 Zeros

Esta é uma das extensões mais simples, que apenas preenche os pixels adicionais com o valor 0.

4.2.2 Média

Outra extensão simples, preenchendo os pixels adicionais com a média da imagem.

4.2.3 Cópia da borda

Os pixels de cada uma das quatro bordas são copiados. Ou seja, a primeira e a última coluna
são copiadas à esquerda e à direita da imagem, e a primeira e última linhas são copiadas acima e
abaixo da imagem, respectivamente. Isto pode provocar uma descontinuidade no local da imagem
em que estas novas bordas estendidas se encontram, porém ela ocorre a uma certa distância do
holograma original.

4.2.4 Mediana da borda

Similar à cópia da borda, mas ao invés de utilizar o valor do primeiro e último pixel de cada
linha e coluna, utiliza os valores das medianas dos primeiros e últimos k pixels de cada linha e
coluna. Assim como na cópia da borda, pode provocar uma descontinuidade no encontro destas
novas bordas, pois a mediana dos primeiros pixels em geral é diferente da mediana dos últimos
pixels de uma mesma linha ou coluna. A mediana é usada para tentar diminuir o efeito do ruído
da imagem na extensão da borda.

4.2.5 Reflexão

A imagem é refletida em torno das bordas. Embora isto possa diminuir a descontinuidade na
borda, faz com que apareçam reconstruções “fantasmas” sobre a imagem.

4.2.6 Rampa linear

Similar à cópia da borda, mas os valores dos pixels vão diminuindo gradativamente de magnitude
até o valor 0, de forma linear. Assim, não ocorre uma descontinuidade no encontro destas novas
bordas, pois nesta região ambas possuem o valor 0.

4.2.7 Rampa linear circular

É feita uma rampa linear entre os valores do primeiro e último pixel de cada linha e coluna.
Desta forma, a extensão faz com que a última coluna se transforme gradativamente na primeira
coluna da imagem, de forma linear, e o mesmo ocorre com a primeira e a última linha.

4.2.8 Filtro gaussiano

A imagem é inicialmente estendida com sua média, e então é aplicado um filtro gaussiano com
parâmetro ?. Após aplicar o filtro, a região correspondente à imagem sendo estendida é restaurada
aos seus valores originais.

4.2.9 Filtro gaussiano iterativo

A imagem é inicialmente estendida com sua média, e então é aplicado um filtro gaussiano de
forma iterativa. Para um parâmetro ?, a i-ésima iteração aplica o filtro gaussiano com ?i = ?2i ,
i = 0 . . . ?log2(?)+1?, e então substitui os valores na região da imagem original pelos do holograma
não estendido. Por causa desta substituição da área do holograma original a cada iteração, este
método não é equivalente a aplicar um único filtro gaussiano com o parâmetro ? apropriado.



4.2 MÉTODOS 39

Figura 4.6: Janela de Tukey para ? = 0.5.

Figura 4.7: Janela de spline cúbica. Os parâmetros utilizados foram x0 = 0, x1 = 42, x2 = 65, T(x0) = 0,
T(x1) = 0.65, T(x2) = 1, T ?(x0) = 0 e T ?(x2) = 0.

4.2.10 Rampa linear com janela de Tukey

Após realizar a extensão com a rampa linear, é aplicada uma janela de Tukey na imagem
estendida.

A janela de Tukey com parâmetro ? é

Tukey(x) =

???
??

1
2

{?
1 + cos

(?
2?
?
[x ? ?

2
]
)?}?

se 0 ? x &amp;lt;?
2

1 se ?
2
? x &amp;lt;1 ? ?

2
1
2

{?
1 + cos

(?
2?
?
[x ? 1 + ?

2
]
)?}?

se 1 ? ?
2
? x ? 1

(4.1)

4.2.11 Cópia da borda com janela Spline

Após realizar a extensão com a cópia da borda, é aplicada uma janela de spline cúbica na
imagem estendida. Esta janela utiliza interpolação por uma spline cúbica nas regiões de transição
entre os valores 0 e 1.

A função interpolada T(x), utilizada no lado esquerdo (começo) da janela, é definida pelos pontos
{x0, x1, x2}, os valores T(x0), T(x1), T(x2) e as derivadas T ?(x0) e T ?(x2). A spline espelhada é
utilizada no lado direito (final) da janela, e os valores no trecho entre as duas splines são iguais a 1.

Maiores detalhes sobre esta janela podem ser encontrados no artigo de Cuche et al. [CMD00].



40 EFEITO DE BORDA 4.2

Figura 4.8: Janela de cosseno com k = 2.5, L0 = 150, L = 300.

4.2.12 Mediana com janela de cosseno

Após realizar a extensão com a mediana, é aplicada uma janela de cosseno na imagem estendida.
Esta janela com parâmetro k é definida como

W(l) =

????
???
cosk

[?
a
(?

2l
L?L0 ? 1

)?]?
se 1 ? l &amp;lt;L?L0

2

1 se L?L0
2

+ 1 ? l &amp;lt;L+L0
2

cosk
[?
b
(?

2l
L+L0+2

? 1
)?]?

se L+L0
2

? l ? L
, (4.2)

onde L0 e L são os números de pixels horizontais ou verticais no holograma original e no holograma
estendido, respectivamente. Os valores a e b são definidos como

a = ?
?

2
·

L ? L0
L0 + 2 ? L

, b =
?

2
·
L + L0 + 2

L ? L0 ? 2
.

Maiores detalhes sobre esta janela podem ser encontrados no artigo de Zhang et al. [ZZF+09].

4.2.13 Minimização de frequências altas

Para criar uma extensão de borda suave, pode-se minimizar as frequências mais altas do ho-
lograma estendido, como é sugerido por Dubois et al. [DMYL02]. Iremos apresentar apenas uma
ideia do algoritmo, que envolve o cálculo de diversas matrizes, e os detalhes podem ser encontrados
no artigo citado.

Seja w? o vetor de uma linha ou coluna do holograma estendido, com a restrição de que a região
original do holograma não pode ser modificada. Queremos minimizar

? = a|W ?(0)|2 +
N?1??
U=1

U2|W ?(U)|2 +
2N?1??
U=N

(2N ? U)2|W ?(U)|2,

onde W ?(U) são os componentes da transformada discreta de Fourier de w?(z) e a é uma constante
real não nula, necessária para a solução do problema matemático. Os dois somatórios estão separados
devido à forma cíclica da transformada de Fourier.

Primeiro a linha ou coluna w? é estendida com zeros, ficando com tamanho 2N, e calcula-se
uma matriz A de tamanho 2N × 2N. O cálculo desta matriz envolve a multiplicação de algumas
matrizes de tamanho ?(N2), além do cálculo da inversa de uma matriz de mesmo tamanho. Calcula-
se W ? = FFT(w?) e então G = AW ? ?W ?. Por fim, a transformada inversa g = IFFT(G) é utilizada
como o valor final da linha ou coluna sendo estendida. Note que o cálculo de A não depende dos
valores da linha ou coluna sendo estendida, mas depende apenas do tamanho 2N e do parâmetro a
mencionado acima.



4.2 MÉTODOS 41

4.2.14 Minimização do Laplaciano

I A

B C

Figura 4.9: Minimização do Laplaciano. A imagem I é estendida calculando-se as regiões A, B e C sepa-
radamente.

O artigo de Liu e Jia [LJ08] propõe criar uma extensão suave de borda que minimiza a soma
das derivadas parciais de segunda ordem. Para isso, este método minimiza o Laplaciano no interior
da extensão, com a restrição de que a borda desta nova região deve ser similar à borda da imagem,
garantindo uma transição suave entre a imagem e a extensão. Isto cria uma imagem estendida
circular adequada ao uso de algoritmos que dependam do cálculo da FFT da imagem.

A extensão é feita em três regiões separadas: em um bloco A à direita da imagem original; em
um bloco B abaixo da imagem original; e em um bloco C na diagonal, preenchendo a área restante.
Detalharemos como obter o bloco A, pois os outros podem ser obtidos de forma similar, sendo que
o bloco C, computado por último, possuirá as quatro bordas restringidas, e não apenas duas bordas
opostas como nos blocos A e B.

Primeiro é utilizado um filtro gaussiano para suavizar a imagem I, de tamanho M ×N. Apenas
estes valores suavizados serão utilizados no cálculo dos blocos da extensão, mas a imagem final
estendida continuará com os valores originais no lugar de I. Para obter o bloco A, de tamanho
M ×(N +2?), primeiro definimos um bloco A?, também com tamanho M ×(N +2?). As primeiras
e últimas ? colunas de A?, que formam a borda ?A, são iguais às últimas e primeiras ? colunas da
imagem suavizada I, respectivamente. O método consiste então em resolver o seguinte problema de
mínimos quadrados regularizados:

min(??A?2 + ??A ? A??2?A),

onde ?• = ?
2•

?x2
+ ?

2•
?y2

é o operador laplaciano, e ? é um peso que controla a suavidade do bloco A
e sua transição para a imagem I. As colunas que formam a borda ?A são descartadas, resultando
em um bloco A de tamanho M × N.

A principal desvantagem do método proposto por Liu e Jia é o alto custo computacional para
resolver o problema de mínimos quadrados regularizados. Se este método fosse utilizado no proces-
samento de hologramas digitais, o tempo gasto no cálculo da extensão da borda seria maior do que
em todas as outras etapas de processamento juntas. Por este motivo, propomos um novo algoritmo
de extensão de borda, que mantém a ideia principal de minimizar o Laplaciano, mas possui um
custo computacional consideravelmente menor.

Descrição da extensão proposta

Criamos uma extensão suave da borda através da minimização do Laplaciano no interior da
extensão, com a restrição de que a borda desta região, com 1 pixel de largura, deve ser igual à
borda da imagem. Ou seja, comparando com o método proposto por Liu e Jia, fazemos com que
? = 1 e conseguimos obter min(??A?2 + ??A ? A??2?A) = 0. Neste caso, em que a borda ?A só
possui 1 pixel de largura, não calculamos ?A nos pixels da borda, mas apenas no interior de A,



42 EFEITO DE BORDA 4.2

onde o operador laplaciano está bem definido e podemos utilizar um pixel e seus 4 pixels adjacentes
para calcular a versão discretizada do laplaciano. O artigo de Liu e Jia não deixa claro se o operador
laplaciano deve ser calculado nos pixels da borda de A e, em caso afirmativo, qual seria a definição
utilizada para lidar com a falta de um dos pixels. Outra diferença é que não aplicamos um filtro
gaussiano na imagem antes de realizar a extensão, optando pelo ganho de desempenho em não
realizar este passo.

A extensão que propomos também é feita em três regiões separadas. Resolvemos a equação de
Laplace no interior do bloco da extensão:

?u = 0,

onde ? é o Laplaciano. Para o retângulo A (e de forma análoga para B), duas bordas opostas da
imagem I determinam a condição de contorno de Dirichlet,

u(i, 0) = I(i, N ? 1), u(i, N ? 1) = I(i, 0), i ? {0, . . . , M ? 1},

e impomos a condição de contorno de Neumann nas duas bordas restantes:

u?(0, i) = u?(M ? 1, i) = 0, i ? {0, . . . , N ? 1}.

Note que o método proposto por Liu e Jia não deixa claro qual a restrição que deve ser utilizada
nestas duas bordas que não fazem fronteira com a imagem. Dependendo da restrição escolhida e da
fórmula utilizada para calcular (ou não) o operador laplaciano nestas bordas, o método de Liu e Jia
pode ter diferentes resultados, incluindo casos com infinitas soluções. As restrições que utilizamos
nas quatro bordas garantem que a solução é única e escolhemos a condição de contorno de Neumann
de forma a obter uma solução suave.

Para o retângulo C, após determinar os valores de A e B é possível impor a condição de contorno
de Dirichlet nas quatro bordas.

Método da Transformada de Fourier

Para o cálculo eficiente da extensão u, utilizaremos o Método da Transformada de Fourier
[PTVF96]. Primeiro solucionamos a equação mais geral

?2u

?x2
+

?2u

?y2
= ?(x, y).

Note que, se fizermos ?(x, y) = 0, teremos a equação de Laplace.
A versão discretizada é

uj+1,l + uj?1,l + uj,l+1 + uj,l?1 ? 4uj,l = ?2?j,l, (4.3)

onde ? = ?x = ?y é o espaçamento da grade.
Impomos a condição de contorno de Dirichlet u = 0 nas quatro bordas do retângulo, e calculamos

a transformada discreta inversa de seno em duas dimensões

ujl = IDST(u?)jl =
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn sin
?jm

J
sin

?ln

L
.

Isto satisfaz as condições u = 0 em j = 0, J e em l = 0, L.
Utilizando as identidades trigonométricas

sin(? + ?) = sin ? cos ? + cos ? sin ?

sin(? ? ?) = sin ? cos ? ? cos ? sin ?



4.2 MÉTODOS 43

obtemos

uj+1,l =
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn sin
?(j + 1)m

J
sin

?ln

L

=
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn

[?
sin

?jm

J
cos

?m

J
+ cos

?jm

J
sin

?m

J

]?
sin

?ln

L
;

uj?1,l =
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn sin
?(j ? 1)m

J
sin

?ln

L

=
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn

[?
sin

?jm

J
cos

?m

J
? cos

?jm

J
sin

?m

J

]?
sin

?ln

L
.

Portanto,

uj+1,l + uj?1,l =
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn2 cos
?m

J
sin

?jm

J
sin

?ln

L
(4.4)

e, analogamente,

uj,l+1 + uj,l?1 =
2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn2 cos
?n

L
sin

?jm

J
sin

?ln

L
(4.5)

Substituindo as equações 4.4 e 4.5 na equação 4.3, e calculando a transformada inversa discreta
de seno no lado direito da equação, temos

2

J

2

L

J?1??
m=1

L?1??
n=1

u?mn2
(?
cos

?m

J
+ cos

?n

L
? 2
)?
sin

?jm

J
sin

?ln

L
=

2

J

2

L

J?1??
m=1

L?1??
n=1

?2??mn sin
?jm

J
sin

?ln

L
.

Devido à unicidade da transformada discreta de seno e sua inversa, isto é equivalente a igualar os
coeficientes

u?mn2
(?
cos

?m

J
+ cos

?n

L
? 2
)?
= ?2??mn

u?mn =
?2??mn

2
(?
cos ?m

J
+ cos ?n

L
? 2
)?.

O algoritmo para obter u consiste em primeiro calcular ?? = DST(?), utilizar a fórmula acima para
obter u?, e por fim calcular u = IDST(u?).

No caso em que u = 0 em todas as bordas, exceto na borda x = J?, em que u = f(y), podemos
reescrever u como

u = u? + uB (4.6)

onde u? = 0 na borda; e uB = 0 em toda a região, exceto na borda, onde possui os valores f(y).
A equação 4.3 torna-se

u?j+1,l + u
?
j?1,l + u

?
j,l+1 + u

?
j,l?1 ? 4u

?
j,l = ?(u

B
j+1,l + u

B
j?1,l + u

B
j,l+1 + u

B
j,l?1 ? 4u

B
j,l) + ?

2?j,l.

Todos os termos uB desta equação desaparecem, exceto quando j = J ? 1, onde

u?J,l + u
?
J?2,l + u

?
J?1,l+1 + u

?
J?1,l?1 ? 4u

?
J?1,l = ?f(l) + ?

2?J?1,l.

Como os valores de f são conhecidos, isto é equivalente ao problema anterior com u = 0 em todas



44 EFEITO DE BORDA 4.2

as bordas, bastando fazer a substituição

?2?J?1,l ? ?f(l) + ?2?J?1,l.

Podemos utilizar o mesmo raciocínio para impor a condição de contorno de Dirichlet nas quatro
bordas ao mesmo tempo, com os valores desejados, bastando fazer as substituições adequadas para
os valores de ?.

Consideramos agora o caso em que duas das bordas possuem a condição de contorno de Neumann

?u0,l
?x

= 0,
?uJ,l
?x

= 0, l ? {1, . . . , L ? 1}.

Calculamos a tranformada discreta inversa de cosseno no eixo em que impomos a condição
de contorno de Neumann, mantendo a transformada discreta inversa de seno no outro eixo, onde
continuaremos impondo a condição de contorno de Dirichlet:

ujl =
2

J

2

L

J????
m=0

L?1??
n=1

u?mn cos
?jm

J
sin

?ln

L
,

onde as linhas duplas no somatório indicam que o primeiro e o último termo (quando m = 0 e
m = J) devem ser multiplicados por 1

2
.

Os cálculos são análogos aos realizados para a condição de contorno de Dirichlet. Utilizamos as
identidades trigonométricas

cos(? + ?) = cos ? cos ? ? sin ? sin ?
cos(??) = cos ?
sin(??) = ? sin ?

e obtemos novamente a fórmula

u?mn =
?2??mn

2
(?
cos ?m

J
+ cos ?n

L
? 2
)?,

com a diferença de que utilizamos a transformada discreta de cosseno no eixo em que queremos
a condição de contorno de Neumann. Como não estamos interessados em derivadas diferentes de
zero, podemos parar por aqui, não sendo necessário reescrever u como na equação 4.6.

Detalhes de implementação

As definições utilizadas acima para as transformadas de seno e cosseno são levemente diferentes
das normalmente encontradas em bibliotecas numéricas. Como exemplo, a biblioteca SciPy fornece
as seguintes transformadas inversas de seno e cosseno, ambas de Tipo I e para uma dimensão:

ul = IDST(u?)l = 2
L?1??
n=0

u?n sin
?(l + 1)(n + 1)

L + 1

ul = IDCT(u?)l = 2

L?1????
n=0

u?n cos
?ln

L ? 1
= u?0 + (?1)lu?L?1 + 2

L?2??
n=1

u?n cos
?ln

L ? 1

Para obter os resultados corretos, alguns cuidados devem ser tomados. Os valores devem ser
divididos por 2, removendo esta constante da fórmula. Além disso, realizando algumas substituições



4.3 COMPLEXIDADE COMPUTACIONAL 45

de variáveis chegamos na seguinte fórmula para a condição de contorno de Dirichlet:

u?mn =
?2??mn

2
(?
cos

?(m+1)
J+1

+ cos
?(n+1)
L+1

? 2
)?; m = 0, . . . , J ? 1; n = 0, . . . , L ? 1.

Para a condição de contorno de Neumann em um dos eixos, e de Dirichlet no outro eixo, a fórmula
utilizada é

u?mn =
?2??mn

2
(?
cos ?m

J?1 + cos
?(n+1)
L+1

? 2
)?; m = 0, . . . , J ? 1; n = 0, . . . , L ? 1.

Como estamos resolvendo a equação de Laplace, é possível realizar algumas otimizações no
cálculo de ??. O cálculo sem otimizações consiste em:

1. Criar a variável ? com tamanho J × L, preenchida com zeros.

2. Nas bordas em que impomos a condição de contorno de Dirichlet, subtraímos os valores
desejados. Note que, caso utilizemos a condição de Dirichlet nas quatro bordas, ocorrerão
duas subtrações nos quatro cantos de ?, cada uma referente a uma das bordas vizinhas.

3. Calculamos a transformada discreta de seno no(s) eixo(s) em que impomos a condição de
Dirichlet nas duas bordas, e a transformada discreta de cosseno no eixo em que impomos a
condição de Neumann com valor zero nas duas bordas.

Ou seja, o valor de ? é diferente de zero apenas nos pixels vizinhos às bordas em que impomos a
condição de Dirichlet.

Quando impomos a condição de contorno de Dirichlet nas quatro bordas, podemos calcular a
transformada discreta de seno nas colunas de forma direta, com exceção da primeira e última coluna,
cujos valores em geral são diferentes de zero. Primeiro calculamos normalmente a transformada
discreta de seno apenas na primeira e última coluna. Nas colunas restantes, notando que a fórmula
da transformada se reduz à soma do primeiro e último termo do somatório, pois os restantes são
nulos, calculamos a transformada diretamente somando estes dois termos. Por fim calculamos a
transformada discreta de seno no outro eixo. Este procedimento faz com que o cálculo de ?? passe de
O(N2 log N) para O(N2) em um dos eixos, permanecendo com custo O(N2 log N) no outro eixo.

Quando impomos a condição de contorno de Neumann em duas das bordas, podemos calcular a
transformada discreta de cosseno primeiro. Desta forma, basta calcular a transformada na primeira e
última linha, onde impomos a condição de contorno de Dirichlet e o valor de ? é em geral diferente de
zero. Todas as outras linhas continuarão iguais a zero. A seguir, calculamos a transformada discreta
de seno nas colunas como descrito acima, somando o primeiro e último termo do somatório. Desta
forma, o cálculo total de ?? passa de O(N2 log N) para O(N2).

Realizando alguns testes, observamos que estas otimizações fazem com que o tempo total do
cálculo da extensão seja pouco menos de 70% do tempo gasto sem as otimizações, considerando o
cálculo das três regiões e a criação da imagem estendida. Não é feita nenhuma otimização no cálculo
das transformadas inversas, sendo utilizados os algoritmos usuais.

4.3 Complexidade computacional

Iremos considerar a extensão de uma imagem de tamanho N×N para uma de tamanho 2N×2N.
Embora nenhum dos algoritmos tenha alguma restrição sobre o tamanho final da imagem estendida,
este é o mais apropriado no caso de holografia digital, para evitar os efeitos de convolução circular
e de aliasing, conforme discutido anteriormente.

Os seguintes algoritmos possuem complexidade O(N2): zeros, média, cópia da borda, mediana
da borda, reflexão, rampa linear, rampa linear circular, rampa linear com janela de Tukey, cópia
da borda com janela Spline e mediana com janela de cosseno. Supondo que ? seja um valor menor



46 EFEITO DE BORDA 4.4

Figura 4.10: Tempo de execução dos algoritmos de extensão de borda.

do que uma constante K razoável, digamos ? ? 32, o filtro gaussiano e o filtro gaussiano iterativo
também possuem complexidade O(N2).

O algoritmo de minimização das frequências altas proposto por Dubois et al. [DMYL02] depende
dos algoritmos utilizados para realizar as multiplicações de matrizes e a inversão da matriz. Na
prática, os algoritmos utilizados possuem complexidade O(N3). É possível fixar o parâmetro a e
pré-computar as matrizes A do algoritmo para vários valores de N, o que diminui o tempo gasto,
porém não altera a complexidade do algoritmo e utiliza uma quantidade considerável de memória
adicional.

Para resolver a equação de Laplace em um retângulo, utilizamos o método de Fourier, que realiza
o cálculo de transformadas discretas de cosseno e seno, além das respectivas transformadas inversas.
Portanto, este método de extensão da borda possui complexidade O(N2 log N).

Nos gráficos 4.10 e 4.11 é possível ver os tempos de execução para todos os métodos, que
foram implementados em Python 2 utilizando as bibliotecas SciPy [JOP+ ], NumPy [VDWCV11]
e FFTW [FJ98]. Os algoritmos foram executados em um MacBook Pro com processador Intel Core
i5 de 2,5 GHz e 8 GB de memória DDR3 1600 MHz. A Minimização das Frequências Altas possui
o pior desempenho, não sendo recomendável caso se deseje um baixo tempo de execução. O Filtro
Gaussiano Iterativo também tem um custo alto, mas bem abaixo da Minimização das Frequências
Altas. A Minimização do Laplaciano é relativamente rápida para quadrados de até 1000 pixels
de largura, mas seu custo aumenta consideravelmente para imagens maiores. O Filtro Gaussiano
possui um custo ligeiramente elevado para imagens maiores do que 1000 pixels de largura, mas com
desempenho melhor do que a Minimização do Laplaciano. Os métodos restantes são extremamente
rápidos, conforme pode ser visto na Figura 4.11, com os preenchimentos com zeros ou a média sendo
quase instantâneos. Como observado na figura, as diferenças de desempenho entre estes últimos
métodos decorrem principalmente de detalhes de implementação, e seria possível obter resultados
bem similares entre eles com uma implementação mais cuidadosa, com exceção dos Zeros e da
Média, que exigem menos processamento e continuariam sendo os mais rápidos.

A Minimização das Frequências Altas e a Minimização do Laplaciano utilizaram duas threads,
enquanto que os outros métodos utilizaram uma única thread. A biblioteca FFTW foi utilizada na
Minimização do Laplaciano para os cálculos das transformadas, pois possui um desempenho bem
superior ao das bibliotecas NumPy e SciPy no cálculo da Transformada de Fourier.



4.4 RESULTADOS EXPERIMENTAIS 47

Figura 4.11: Tempo de execução dos algoritmos de extensão de borda (detalhe). Os métodos mais rápidos
são o preenchimento com zeros ou com a média, que não exigem muitas operações. Em seguida, a rampa
linear circular, que foi implementada de forma mais cuidadosa. Os métodos restantes em geral utilizam
funções das bibliotecas SciPy e NumPy, além de algumas funções auxiliares no caso da aplicação de janelas
e, por serem mais gerais, estas funções acabam aumentando o custo computacional. Ou seja, as diferenças
de tempo entre estes últimos métodos e a rampa linear circular decorrem principalmente de detalhes de
implementação, e não de alguma característica intrínseca do método.

4.4 Resultados experimentais

Os algoritmos serão avaliados de acordo com a raiz do erro quadrático médio (RMSE):

RMSE(I?) =

????M
x=1

??N
y=1 |I?x,y ? Ix,y|2

MN
,

onde I? é a reconstrução obtida utilizando algum algoritmo de extensão da borda e I é a reconstrução
de referência, com tamanho M × N. Embora a reconstrução seja realizada com uma imagem esten-
dida de tamanho 2M × 2N, apenas a região correspondente ao holograma original é considerada.
Note que a fórmula utilizada também é válida para números complexos, resultando em um valor
real.

Como serão utilizadas imagens obtidas experimentalmente, não é possível ter uma imagem
de referência I que não apresente nenhum efeito de difração da borda. Portanto cada holograma
será reconstruído utilizando a extensão com zeros, mas apenas um retângulo na região central do
holograma reconstruído será utilizado como a imagem de referência I. Esta mesma região retangular
do holograma original será estendida com algum algoritmo e sua reconstrução holográfica I? será
comparada com a imagem I.

Por fim, ordenamos os algoritmos de acordo com a magnitude dos erros. O valor RMSE de-
pende não só do algoritmo de extensão da borda utilizado, mas também dos vários parâmetros da
reconstrução, aumentando, por exemplo, com a distância z da reconstrução. Além disso, parte do
erro representa a perda de informação ao utilizar uma região menor do holograma para a extensão
sendo avaliada, em comparação com a reconstrução de referência que utiliza o holograma inteiro.
Por estes motivos os erros são normalizados para cada imagem, subtraindo dos valores RMSE o
menor valor obtido. Ou seja, o algoritmo com o menor erro para aquela imagem passa a ter erro
igual a zero. Após esta normalização, ordenamos os algoritmos pela média dos erros, e também



48 EFEITO DE BORDA 4.4

(a) Holograma (b) Reconstrução

(c) Extensão com rampa linear (d) Reconstrução da extensão (e) Diferença das reconstruções

Figura 4.12: Cálculo do erro dos métodos de extensão de borda. O holograma (a) foi estendido com zeros e
reconstruído com z = 19 cm, resultando na imagem (b). A região destacada no holograma (a) foi estendida
com a rampa linear, resultando na imagem estendida (c). Esta imagem estendida foi reconstruída e a região
original recortada, obtendo-se a imagem (d). No cálculo do valor RMSE, a região destacada na imagem
(b) é utilizada como referência para calcular o erro da imagem (d). A diferença entre estas duas imagens
pode ser observada na imagem (e), onde as regiões mais escuras representam as maiores diferenças e a
escala é logarítmica para facilitar a visualização. A maior parte do erro se deve à perda de informação
provocada pela utilização de uma região menor do holograma na reconstrução, o que pode ser visto nas
bordas do organismo. Porém, também é possível observar interferências horizontais e verticais na imagem
(e), causadas pela difração da borda da imagem.



4.4 RESULTADOS EXPERIMENTAIS 49

(a) Holograma (b) Reconstrução com z = 6.2 cm

Figura 4.13: Holograma utilizado nos gráficos de erro por distância e erro por tamanho da reconstrução
(figuras 4.14 e 4.17).

calculamos a raiz da média dos quadrados destes erros (RMS dos erros). Assim, podemos avaliar
quais algoritmos obtêm o menor erro em média, e também quais não se distanciam muito do menor
erro obtido pelos algoritmos considerados.

A normalização não altera a ordenação dos algoritmos pela média dos erros, pois apenas subtrai
uma mesma constante dos erros de todos os algoritmos, mas pode alterar a ordenação pelo RMS
dos erros. A ideia é que, após a normalização, um erro igual a zero indica que o método foi melhor
do que todos os outros para todas as imagens. Um valor acima de zero indica o quão distante o
método está de ser melhor do que todos os outros, utilizando duas formas diferentes de medir esta
distância (erro médio ou RMS dos erros).

4.4.1 Resultados

Inicialmente, foram usadas 36 imagens na comparação dos diferentes métodos, com reconstruções
de diferentes tamanhos e distâncias, que podem ser visualizadas no Apêndice A. As imagens foram
feitas com duas câmeras diferentes, com tamanho de pixels e resolução distintas, e capturadas em
alguns dias, com diferentes amostras. A primeira câmera possui resolução de 1312 × 1082 pixels,
com pixels quadrados de largura 8.5 µm. A segunda câmera possui resolução de 2448 × 2050 pixels,
com pixels quadrados de largura 3.45 µm. Também foi utilizado um holograma com resolução de
1000 × 686 pixels, e outro com resolução de 1024 × 1024 pixels, sendo que ambos foram capturados
com a primeira câmera e depois recortados para ficarem com estas resoluções. O laser utilizado
possui comprimento de onda igual a 660 nm, e as distâncias de reconstrução utilizadas foram entre
3.65 cm e 19 cm.

Em um segundo experimento foram utilizadas 200 imagens na comparação dos diferentes mé-
todos, com reconstruções de diferentes tamanhos e distâncias. As imagens foram capturadas no
mesmo dia e com a mesma amostra de plâncton, e feitas com uma única câmera, que possui re-
solução de 2448 × 2050 pixels, com pixels quadrados de largura 3.45 µm. O laser utilizado possui
comprimento de onda igual a 660 nm, e as distâncias de reconstrução utilizadas foram entre 5 cm e
7 cm, escolhidas aleatoriamente. O tamanho da região central utilizada na reconstrução foi escolhido
aleatoriamente entre 748×550 e 1648×1250 pixels, sempre com uma distância mínima de 400 pixels
para qualquer uma das bordas da imagem.

Na mediana da borda, foi utilizado o parâmetro k = 5 pixels. Na rampa linear com janela de
Tukey foi utilizado o parâmetro ? = 0.5. Na cópia da borda com janela Spline, os parâmetros
utilizados para uma janela de largura L foram x0 = 0, x1 = 0.677L4.85 , x2 =

1.042L
4.85

, T(x0) = 0,
T(x1) = 0.65, T(x2) = 1, T ?(x0) = 0 e T ?(x2) = 0. Na mediana com janela de cosseno, o único
parâmetro k utilizado para a janela foi 2.5, com k = 5 pixels para o cálculo da mediana. No filtro



50 EFEITO DE BORDA 4.4

Figura 4.14: Comparação entre extensões de borda para diferentes distâncias de reconstrução. Um ho-
lograma de tamanho 2448 × 2050 foi reconstruído para cada uma das distâncias, sendo estendido com a
minimização do Laplaciano e usado como referência. Os valores dos pixels do holograma estão no intervalo
[0, 255]. Um quadrado de 512 pixels de largura no centro deste holograma foi reconstruído a várias distâncias,
de 2 cm a 7 cm, utilizando os diferentes métodos de extensão de borda. Para cada um dos métodos e distân-
cias utilizados, foi calculada a raiz do erro quadrático médio utilizando o quadrado central da reconstrução
de referência. É possível ver que a extensão com zeros, a extensão com reflexão da imagem e a rampa linear
obtêm erros bem maiores do que os outros métodos. Três organismos aparecem parcialmente no quadrado
utilizado na comparação. Um destes entra em foco a cerca de 5.75 cm de distância, outro a cerca de 6.2 cm
e o restante a cerca de 6.7 cm.

Figura 4.15: Comparação entre extensões de borda para diferentes distâncias de reconstrução (detalhe da
figura 4.14). As reconstruções com zeros e reflexão possuem erros muito elevados e não aparecem na figura.
A rampa linear obtém um erro maior, seguida pela média e filtro gaussiano. Os outros métodos possuem
erros similares, com a minimização do Laplaciano obtendo os menores erros.



4.4 RESULTADOS EXPERIMENTAIS 51

Figura 4.16: Comparação entre extensões de borda para diferentes distâncias de reconstrução (detalhe
da figura 4.14). As reconstruções com zeros, reflexão e rampa linear possuem erros muito elevados e não
aparecem na figura. A média obtém um erro maior, seguida pelo filtro gaussiano e pela cópia da borda. A
mediana da borda obtém um erro similar ao filtro gaussiano iterativo. Os métodos restantes possuem erros
similares entre si, com exceção da minimização do Laplaciano que possui os menores erros.

Figura 4.17: Comparação entre extensões de borda para diferentes tamanhos de imagem. Um holograma
foi reconstruído com a minimização do Laplaciano e utilizado como referência. Os valores dos pixels da
imagem estão no intervalo [0, 255]. Vários quadrados com larguras diferentes foram reconstruídos no centro
do holograma, e foi calculada a raiz do erro quadrático médio para diferentes métodos de extensão de borda.
É possível ver que as extensões com zeros, com reflexão da imagem e com rampa linear obtêm erros bem
maiores do que os outros métodos, e para quadrados com largura maior do que 700 pixels não há muita
diferença entre estes outros métodos.



52 EFEITO DE BORDA 4.4

Figura 4.18: Comparação entre extensões de borda para diferentes tamanhos de imagem (detalhe da figura
4.17). Neste gráfico é possível ver que a minimização do Laplaciano obtém o menor erro para todas as
reconstruções com largura entre 250 e 700 pixels. Os erros da extensão com reflexão (canto superior direito)
ou com rampa linear são bem elevados. Dentre os métodos restantes, a média e o filtro gaussiano obtêm
em geral erros um pouco maiores do que os outros métodos, que têm erros bem similares e ligeiramente
superiores aos da minimização do Laplaciano.

Figura 4.19: Comparação entre extensões de borda para diferentes tamanhos de imagem (detalhe da figura
4.17). Neste gráfico é possível ver que os erros de diversos métodos são bem similares, com o filtro gaussiano,
o filtro gaussiano iterativo e a minimização do Laplaciano possuindo os menores erros. As extensões com
zeros e com reflexão não aparecem na figura, pois os erros são bem elevados, e a extensão com rampa linear
aparece no canto superior direito. A minimização do Laplaciano obtém erros menores do que os outros
métodos.



4.4 RESULTADOS EXPERIMENTAIS 53

gaussiano e no filtro gaussiano iterativo foi utilizado ? = 16.

Tabela 4.1: Erros das extensões (36 imagens)

Método RMS dos erros Erro médio
Minimização do Laplaciano 0.0141082577 0.0057092772
Filtro gaussiano iterativo (? = 16) 0.1338226195 0.0869404209
Filtro gaussiano (? = 16) 0.2708025712 0.1637602514
Mediana com janela de cosseno 0.2353874979 0.1675396627
Mediana da borda 0.2704227127 0.1882365677
Rampa linear circular 0.2447774611 0.2095109489
Cópia da borda com janela Spline 0.2552086359 0.2169131570
Rampa linear com janela de Tukey 0.2645534074 0.2282238668
Minimização das frequências altas 0.2679204009 0.2343276076
Cópia da borda 0.2918432957 0.2436156405
Média 0.4610219089 0.2895375755
Rampa linear 4.4178637247 3.4239223930
Reflexão 5.4039674754 4.7871119578
Zeros 15.3849337862 14.2193549607

Tabela 4.2: Erros das extensões (200 imagens)

Método RMS dos erros Erro médio
Minimização do Laplaciano 0.3518018652 0.214208946
Filtro gaussiano (? = 16) 0.4702341748 0.320962085
Filtro gaussiano iterativo (? = 16) 0.4738536993 0.324729852
Média 0.4818261562 0.332819976
Rampa linear circular 0.5811989071 0.420472612
Minimização das frequências altas 0.6316798803 0.463814411
Mediana da borda 0.9714098964 0.684723224
Cópia da borda 1.0367849283 0.759131488
Reflexão 2.0498254644 1.648931627
Rampa linear 12.0247648276 9.650624437
Cópia da borda com janela Spline 17.1005024836 15.931436500
Mediana com janela de cosseno 17.9511958961 17.086757526
Rampa linear com janela de Tukey 19.3300137749 17.824049186
Zeros 43.9944100212 43.904314537

Na tabela 4.1 estão os resultados do primeiro experimento, com 36 imagens. Os resultados do
segundo experimento, com 200 imagens, podem ser vistos na tabela 4.2. Em ambos o método com
o menor erro foi a minimização do Laplaciano, seguido pelos filtros gaussianos, e o maior erro foi a
extensão com zeros. Embora a minimização das frequências altas tenha sido criada especificamente
para o processamento de hologramas, em ambos os experimentos obteve resultados piores do que
uma simples rampa linear circular, que é um método bem mais eficiente em tempo de processamento
e uso de memória.

Nas figuras 4.14, 4.15 e 4.16 é possível ver que o erro de reconstrução devido à borda depende da
distância utilizada na reconstrução. Já as figuras 4.17, 4.18 e 4.19 mostram como a utilização de uma
região maior do holograma na reconstrução diminui o erro, pois há uma menor perda de informação,
e a área central da imagem que é menos afetada pelos erros de borda é proporcionalmente maior.



54 EFEITO DE BORDA 4.4

Outros parâmetros que influenciam o erro são o tamanho do pixel da câmera e o comprimento de
onda do laser. Ignorando o conteúdo da imagem sendo reconstruída e analisando apenas a função
de transferência usada na reconstrução (equação 3.5), podemos ver que aumentar o comprimento
de onda é similar a aumentar a distância de reconstrução, provocando um maior erro devido à
borda. Já o tamanho do pixel é inversamente proporcional à distância, e a diminuição do tamanho
dos pixels é similar ao aumento da distância de reconstrução, com um fator quadrático, caso a
quantidade de pixels seja mantida constante.

Não realizamos um estudo mais aprofundado de como cada um destes fatores influencia o erro
de borda. Porém, os testes que realizamos mostraram que a extensão que realiza a minimização do
Laplaciano obtém resultados consistentemente melhores do que os outros métodos, e que mesmo nos
poucos casos em que não é o melhor, ainda consegue obter um erro bem próximo ao melhor método
dentre os considerados. Os gráficos de erro por distância e erro por tamanho da imagem, apesar de
serem específicos para um único holograma, indicam que, em geral, os melhores métodos possuem
um comportamento bem similar entre si. Portanto, embora exista a possibilidade de que algum
método obtenha erros menores para certos casos, é razoável escolher a minimização do Laplaciano
como um método geral para diminuir o erro de reconstrução de hologramas de plâncton devido à
descontinuidade da borda.

Por fim, é interessante notar que os métodos com menor erro médio tratam a imagem de forma
bidimensional. A grande maioria dos métodos considerados realiza a extensão linha a linha e coluna
a coluna, ou seja, os valores de uma linha ou coluna da imagem não influenciam a extensão de
outra linha ou coluna. Isto provoca o surgimento de várias frequências perpendiculares à direção
sendo estendida, como pode ser observado na figura 4.12c, onde a rampa linear cria faixas verticais
na região inferior esquerda da figura, e faixas horizontais na região superior direita. Já no caso da
minimização do Laplaciano, do filtro gaussiano e do filtro gaussiano iterativo, a extensão também
é suave na direção perpendicular à que está sendo estendida, pois estes métodos tratam a imagem
como um objeto bidimensional, e não como um conjunto de linhas ou colunas independentes. Isto
pode ser observado na figura 4.5e, onde a região da extensão é bem suave em todas as direções,
possuindo apenas frequências baixas, além de ter uma transição suave entre a imagem original e a
extensão.



Capítulo 5

Focalização

A maior vantagem proporcionada pela holografia digital no estudo de plâncton decorre da possi-
bilidade de realizar a focalização da imagem após sua aquisição, o que permite a observação de um
maior volume de água. Esta característica é vantajosa para a identificação de organismos planctôni-
cos ou a análise do comportamento e da interação destes organismos em diferentes profundidades.
Porém, para isto é necessário que a focalização das regiões de interesse seja feita de forma auto-
mática, caso contrário o tempo gasto realizando a focalização manual tornaria o uso da holografia
inviável em diversos casos.

A abordagem que utilizamos para realizar a focalização automática consiste no uso de uma
medida de foco que é calculada sobre o holograma reconstruído. Ao variar a distância de reconstrução
em um determinado intervalo, a imagem que maximiza (ou minimiza) esta medida é considerada
a melhor focalizada. Embora existam diversos artigos comparando medidas de foco no caso de
fotografia digital, as comparações realizadas para holografia digital de plâncton são mais limitadas.

Uma exceção é a tese de Loomis, que realiza um estudo detalhado de várias medidas de foco
[Loo11]. Em sua tese, um valor de foco é atribuído para cada pixel , onde este valor é o resultado da
medida calculada em uma pequena janela centralizada neste mesmo pixel . Os valores de foco são
calculados para várias distâncias, e a profundidade do pixel é a que maximiza a medida utilizada.
Com isso, é possível obter um mapa de profundidade (depth map), e uma imagem onde todos os
pixels maximizam a medida de foco sendo estudada.

O problema deste método é que, em imagens de holografia digital em linha, apenas pixels pró-
ximos a bordas possuem valores confiáveis de foco. Enquanto que em imagens de fotografia digital
a textura dos objetos pode auxiliar em sua focalização, nesta configuração holográfica o interior
dos objetos ou não possui nenhuma informação, pois toda a luz foi absorvida pelo objeto, ou pos-

(a) Holograma não focalizado (b) Holograma focalizado

Figura 5.1: Focalização de um holograma segundo a medida de entropia. O holograma foi reconstruído a
várias distâncias, e a imagem à direita é a que obteve o melhor foco, minimizando a entropia.

55



56 FOCALIZAÇÃO 5.0

sui padrões de difícil focalização, devido às refrações e dispersão da luz provocadas por um objeto
transparente. Além disso, grande parte da imagem é formada pelo fundo que não pode ser focalizado
por definição, pois é a ausência de objetos e não uma superfície. Ou seja, os pixels que não estão
próximos a bordas e que formam a maior parte da imagem acabam sendo focalizados em distâncias
incorretas, adicionando ruído à imagem final. Ondas de difração de objetos próximos, por exem-
plo, podem ser consideradas melhor focalizadas do que o fundo uniforme da imagem. Sobre estas
dificuldades, Loomis comenta que imagens poucos milímetros fora de foco podem exibir gradientes
mais fortes do que a imagem focalizada, e ilustra esta situação com uma imagem holográfica de um
copépodo, onde a difração de suas antenas finas gera gradientes fortes quando levemente desfocadas.
Também menciona que algumas medidas geram ruído próximo ao organismo devido aos efeitos de
desfocalização e a imagem gêmea.

Para evitar estes problemas, na aplicação demonstrada na tese de Loomis, que consiste em de-
tectar e classificar partículas de petróleo, é feita uma limiarização e apenas os pixels com maior
resposta à medida de foco são considerados. Os valores da medida nestes pixels são então usados
conjuntamente para determinar a profundidade da partícula. Uma diferença importante em relação
ao presente trabalho é que Loomis utiliza as medidas de foco não apenas para determinar a profundi-
dade de um objeto, mas também para detectar a presença destes objetos nas imagens reconstruídas.
Ou seja, as medidas são utilizadas como um filtro que é aplicado em todas as reconstruções para
segmentar objetos, determinando suas posições nos três eixos.

Em hologramas de rostos humanos, Thelen et al. [TFHH09] utilizam diversas técnicas para li-
dar com estes problemas na focalização de pixels. É calculada uma medida de confiança para os
resultados obtidos pela medida de foco, e caso esta confiança esteja abaixo do valor de uma fórmula
determinada experimentalmente, é selecionada uma janela maior em torno do pixel para a focali-
zação. Isto é feito utilizando janelas de vários tamanhos, e caso nenhuma destas possua um valor
aceitável para a medida de confiança, ao final do algoritmo é calculada uma média ponderada na ja-
nela de maior tamanho usando os valores de confiança como peso, preenchendo assim estas lacunas
com valores similares ao da região na qual estão localizadas. Também é feito um ajuste gaussiano
na medida de foco ao determinar a distância de cada pixel . Desta forma, as distâncias obtidas não
ficam restritas às utilizadas no algoritmo de focalização, resultando em uma superfície mais suave,
sem os degraus típicos de uma focalização realizada em passos discretos uniformemente espaçados.
E por fim é feita uma suavização anisotrópica para diminuir o ruído presente na superfície.

Podemos notar que existe uma grande dificuldade de se obter uma boa focalização para pixels
individuais, sem ruído excessivo, sendo necessários vários algoritmos para se chegar ao resultado
desejado. Vale ressaltar que estas imagens holográficas de rostos humanos são distintas das imagens
de plâncton em vários aspectos, alguns dos quais facilitam a focalização. A configuração holográfica
não é em linha, a reconstrução realizada é óptica e as imagens resultantes não possuem fortes ondas
de difração e imagens gêmeas como na holografia de plâncton. Além disso, praticamente toda a
imagem contém a superfície formada pelo rosto, e não um fundo sem objetos.

Neste trabalho, realizamos a comparação de medidas de foco para determinar a profundidade
da imagem como um todo, e não de cada pixel individualmente. A vantagem é que não há a criação
de um ruído adicional na imagem como na focalização de pixels, porém é possível que organismos
maiores fiquem parcialmente desfocados. Além disso, caso existam organismos muito próximos estes
poderão afetar o resultado da focalização, inclusive fazendo com que outros organismos fiquem
focalizados no lugar do organismo sendo processado. Ainda assim, caso os organismos tenham sido
corretamente segmentados, acreditamos que esta abordagem proporciona um resultado superior a
uma simples focalização de pixels.

Um dos problemas da focalização de hologramas de organismos planctônicos é o tempo gasto
para realizar as reconstruções a várias distâncias e calcular a medida de foco. Para diminuir o
tempo de processamento, pode-se reconstruir o holograma a uma quantidade menor de distâncias
e, a partir dos valores da medida de foco, realizar mais reconstruções apenas na região em que
se acredita que o holograma estará bem focalizado. Ou seja, a focalização é realizada em algumas
etapas: primeiro é feita uma focalização grosseira, com uma distância maior entre as reconstruções; e



5.1 MEDIDAS DE FOCO 57

em seguida é feita uma focalização mais fina, diminuindo-se a distância entre as reconstruções, mas
realizando-as apenas na região que obteve o melhor foco na etapa anterior. Pode-se realizar quantas
etapas forem necessárias para se obter uma boa focalização, terminando com uma distância bem
pequena entre cada reconstrução. Um algoritmo extremamente similar foi utilizado por Domínguez-
Caballero [DC06], porém avaliaremos o uso de diferentes medidas de foco neste algoritmo, enquanto
que Domínguez-Caballero utilizou uma única medida de foco, baseada no laplaciano da imagem.

5.1 Medidas de foco

A seguir detalhamos as medidas que foram estudadas.

5.1.1 Medidas estatísticas

Estas medidas realizam algum cálculo estatístico sobre os valores dos pixels, ignorando a posição
destes na imagem.

Entropia

A distância de focalização escolhida é a que minimiza a entropia da imagem [GK89], que é
calculada utilizando seu histograma. Para uma imagem com N níveis de cinza, a entropia é definida
como

Entropia = ?
N??

n=1

Pn log Pn

onde Pn é a probabilidade do n-ésimo nível de cinza, definida como sua frequência relativa na
imagem.

Amplitude

A amplitude de uma imagem I de tamanho M × N é [DSCY06]

Amplitude =
M??
i=1

N??
j=1

|I(i, j)| .

Variância

Utilizada em diversos artigos de processamento de imagens [GYL85, MHN08, LJ05, TBG+05,
LSHW09, BCP+09, PPCCMFV00, HJ07], a variância 1 de uma imagem I de tamanho M × N é

Var(I) =
1

MN

M??
i=1

N??
j=1

[?
I(i, j) ? I?

]?2
,

onde I? é a média de intensidades da imagem I. Alguns autores também utilizam o desvio pa-
drão [Loo11], mas como os valores são considerados de forma relativa, obtendo portanto resultados
idênticos aos da variância, não utilizaremos o desvio padrão como medida de foco.

Contraste de Tamura

Seja ?4 a medida de curtose, isto é,
?4 =

µ4
?4

,

1Usamos o termo “variância” por ser comumente utilizado na área de processamento de imagens, mas é bom deixar
claro que não estamos realizando qualquer tipo de análise estatística das imagens.



58 FOCALIZAÇÃO 5.1

onde µ4 é o quarto momento central e ?2 é a variância. O contraste de uma imagem I, segundo as
medidas de textura propostas por Tamura et al. [TMY78], é definido como

Tamura =
?

(?4)n
,

onde ? é o desvio padrão de I e o valor n é igual a 0.25 (recomendado).
Uma aproximação deste coeficiente utilizada por Memmolo et al. [MDP+11] é

Tamuraaprox =

??
?

I?
.

Esta aproximação é similar à medida de variância, mas com um peso levemente maior para ima-
gens mais escuras, que possuem média mais próxima a zero. Uma outra versão equivalente a esta
aproximação, mas sem a raiz quadrada, é chamada de Desvio Padrão Normalizado [GYL85].

Momento Central Absoluto

O Momento Central Absoluto (Absolute Central Moment) de uma imagem I é [LJ05]

ACM =
??

|i ? I?|p(i),

onde i é o nível de cinza e p(i) é a probabilidade do i-ésimo valor de cinza na imagem, segundo sua
frequência relativa. Ou seja, esta medida é calculada a partir do histograma da imagem I.

Uma definição equivalente é

ACM2 =
1

MN

M??
i=1

N??
j=1

??
I(i, j) ? I?

??
,

onde I? é a média de intensidades da imagem I. Esta definição é chamada de Amplitude [CNAJ01]
ou Variação Absoluta [GYL85].

5.1.2 Medidas com filtro espacial

Estas medidas utilizam algum tipo de filtro espacial, com o objetivo de detectar a presença de
bordas e assim determinar se uma imagem está focalizada.

Variação Total

A Variação Total (anisotrópica) de uma imagem I é

TV(I) =
M??
i=1

N??
j=1

|I(i + 1, j) ? I(i, j)| + |I(i, j + 1) ? I(i, j)|.

Esta medida também é chamada de Sum Modulus Difference (SMD) [Jar76, CNAJ01] e Energy
of Gradient Absolute (EOGA) [BCP+09].

Índice S

O Índice S [LM15] se baseia na ideia de que alterações aleatórias na fase de uma imagem em
geral aumentam a Variação Total medida, mas isto ocorre de forma mais drástica para imagens



5.1 MEDIDAS DE FOCO 59

nítidas. O Índice S de uma imagem I é

S(I) = ? log10 ?
(?
µ ? TV(I)

?a

)?
,

?(t) =
1

?
2?

?? ?
t

e
?s2
2 ds,

onde µ e ?a são definidos pelas equações (10) e (14) no artigo de Leclaire e Moisan [LM15], respec-
tivamente.

O cálculo de S é mais complexo do que o das outras medidas apresentadas aqui, e envolve o
uso de uma FFT. Além disso, como a imagem é tratada de forma periódica, bordas opostas da
imagem podem gerar descontinuidades. Para evitar isso, os autores sugerem que seja usada uma
decomposição periódica da imagem original, cujo cálculo envolve o uso de uma FFT e uma IFFT.
Com isso, temos o equivalente a três usos da FFT para o cálculo desta medida.

Momento Central Absoluto com Filtro Passa-altas

Baseada no Momento Central Absoluto, mas com a aplicação de um filtro passa-altas [LJ05]. A
imagem filtrada é

I(i, j)HP =
{?
I(i, j)

??
|I(i, j) ? I(i ? s, j)| ? T

}?
O valor s é o passo do filtro e T é um valor de limiarização, que descarta parte dos pixels. A imagem
filtrada é um conjunto de pixels, podendo inclusive ser vazia, sendo que neste caso o valor da medida
é 0 por definição.

O Momento Central Absoluto com Filtro Passa-altas (HPACM) é

HPACM(I) = ACM(IHP ),

ou seja, utilizamos a medida ACM definida anteriormente na imagem filtrada.

Magnitude do Gradiente Gaussiano

A partir da função gaussiana em duas dimensões

G?(x, y) =
1

2??2
exp?

x2+y2

2?? ,

onde ? é o desvio padrão, obtemos o gradiente

?G? =
[?
?G?
?x

,
?G?
?y

]?T
.

Podemos realizar a convolução deste gradiente gaussiano com a imagem I e utilizar o resultado
para obter a magnitude do gradiente gaussiano

GGM =

??(?
?G?
?x

? I
)?2

+

(?
?G?
?y

? I
)?2

.

Como medida de focalização, podemos utilizar o somatório

GGMSUM =
??
i

??
j

GGM

ou a variância
GGMVAR =

??
i

??
j

(?
GGM(i, j) ? GGM

)?2
.



60 FOCALIZAÇÃO 5.1

Máximo Orientado da Intensidade

Esta medida foi criada originalmente para determinar o valor de focalização de pixels, e não da
imagem como um todo [Loo11]. Porém, podemos utilizar o somatório dos valores de todos os pixels
para obter a medida de foco

SIM(I) =
??
i,j

SM(i, j) [Imax ? I(i, j)] ,

onde SM é a magnitude do gradiente gaussiano da imagem, e Imax é uma constante maior do
que qualquer valor I(i, j). Utilizaremos Imax = 255, supondo que os valores da imagem estão no
intervalo [0, 255]. Também podemos calcular a variância, ao invés de utilizar a soma dos valores:

SIMVAR(I) = Var(SM(i, j) [Imax ? I(i, j)]).

Não temos conhecimento do uso da medida SIMVAR na literatura.

Correlação do Desvio Padrão

Esta medida é baseada em correlação para diferenciar imagens bem focalizadas das que estão
fora de foco. É calculada a partir da fórmula [LSHW09]

SDC =
1

(M ? 1)N

M?1??
i=1

N??
j=1

I(i + 1, j)I(i, j) ? I?2,

onde I é uma imagem de tamanho M × N.

Soma do Laplaciano Modificado

Originalmente foi definida para uma janela ao redor de cada pixel , mas aqui utilizaremos a
imagem como um todo. Para evitar o cancelamento de termos, o operador laplaciano é modificado
para utilizar valores absolutos:

?2I(i, j) = |2I(i, j) ? I(i ? 1, j) ? I(i + 1, j)| + |2I(i, j) ? I(i, j ? 1) ? I(i, j + 1)|

O valor da medida é [NN94]

SML =
??
i,j

?2I(i, j), para ?2I(i, j) ? T,

onde T é um valor de limiarização.

Soma Cruzada do Laplaciano Modificado

Similar à Soma do Laplaciano Modificado, mas também considera os pixels nas diagonais e
utiliza um passo s:

?2XSMLI(i, j) = |2I(i, j) ? I(i ? s, j) ? I(i + s, j)| + |2I(i, j) ? I(i, j ? s) ? I(i, j + s)|

+
1
?
2
|2I(i, j) ? I(i ? s, j ? s) ? I(i + s, j + s)|

+
1
?
2
|2I(i, j) ? I(i ? s, j + s) ? I(i + s, j ? s)|



5.1 MEDIDAS DE FOCO 61

O valor da medida é [TFHH09]

XSML =
??
i,j

?2XSMLI(i, j), para ?
2
XSMLI(i, j) ? T,

onde T é um valor de limiarização.

Medida de Pieper e Korpel

O método de Pieper e Korpel utiliza um operador diferencial não-direcional [BCP+09]

PK(i, j) = |I(i ? 1, j + 1) ? I(i + 1, j ? 1)| + |I(i + 1, j + 1) ? I(i ? 1, j ? 1)|
+ |I(i, j + 1) ? I(i, j ? 1)| + |I(i ? 1, j) ? I(i + 1, j)|

O valor da medida é
PK =

??
i,j

PK(i, j).

Tenengrad

O método de Tenengrad utiliza o filtro passa-altas de Sobel

?S(i, j) =
??
?Sx(i, j)2 + ?Sy(i, j)2,

onde ?Sx(i, j) e ?Sy(i, j) são os filtros horizontal e vertical de Sobel, respectivamente, calculados
através das máscaras de convolução

Sx =

?
?1 0 ?12 0 ?2
1 0 ?1

?
? ; Sy =

?
? 1 2 10 0 0
?1 ?2 ?1

?
? .

O valor da medida é [BCP+09]

Tenengrad =
M?1??
i=2

N?1??
j=2

(?S(i, j))2 , para ?S(i, j) ? T,

onde T é um valor de limiarização.

Boddeke

Este método utiliza um filtro passa-altas em uma dimensão

?B(i, j) = I(i + 1, j) ? I(i ? 1, j)

para obter a medida [BIA+05]

Boddeke =
M?1??
i=2

N??
j=1

[?B(i, j)]2 .

Laplaciano

Após aplicar o filtro laplaciano utilizando a máscara de convolução

L =

?
? 0 ?1 0?1 4 ?1

0 ?1 0

?
? ,



62 FOCALIZAÇÃO 5.1

obtém-se o valor da medida [BIA+05]

Laplaciano =
M?1??
i=2

N?1??
j=2

|?L(i, j)| , para |?L(i, j)| ? T,

onde T é um valor de limiarização.

Energia do Laplaciano

Nesta medida o filtro laplaciano é utilizado com a máscara de convolução

L =

?
??1 ?4 ?1?4 20 ?4
?1 ?4 ?1

?
?

para obter o valor da medida [HJ07]

EOL =
M?1??
i=2

N?1??
j=2

(?L(i, j))2 .

Energia Quadrática do Gradiente

A Energia Quadrática do Gradiente é [BCP+09, HJ07]

EOGS =
M??
i=2

N??
j=2

(?
fx(i, j)

2 + fy(i, j)
2
)?
,

fx(i, j) = I(i, j) ? I(i ? 1, j),
fy(i, j) = I(i, j) ? I(i, j ? 1).

Uma definição similar é chamada de Frequência Espacial (spatial frequency) [HJ07, LY08]:

SF =
??

(RF)2 + (CF)2,

RF =

???
? 1

MN

M??
i=1

N??
j=2

[I(i, j) ? I(i, j ? 1)]2,

CF =

???
? 1

MN

M??
i=2

N??
j=1

[I(i, j) ? I(i ? 1, j)]2.

Como utilizamos os valores das medidas de forma relativa, buscando o valor máximo, as duas
definições são equivalentes e apenas a medida EOGS será considerada.

Variância de Sobel

Similar à medida Tenengrad, porém calcula a variância do gradiente da imagem após aplicar o
filtro de Sobel [PPCCMFV00]:

SOBVAR =
M?1??
i=2

N?1??
j=2

(?
?S(i, j) ? ?S

)?2
, para ?S(i, j) ? T,

onde T é um valor de limiarização.



5.1 MEDIDAS DE FOCO 63

Variância do Laplaciano

Similar à medida Laplaciano, porém calcula a variância do gradiente da imagem após aplicar o
filtro laplaciano [PPCCMFV00]:

LAPVAR =
M?1??
i=2

N?1??
j=2

(?
|?L(i, j)| ? ?L

)?2
, para |?L(i, j)| ? T,

onde T é um valor de limiarização e ?L é a média dos valores absolutos de ?L(i, j).

5.1.3 Medidas com janelas

Estas medidas realizam cálculos primeiramente em uma janela ao redor de cada pixel , e depois
agregam os resultados de todas as janelas. Nos métodos considerados existem três passos: o primeiro,
opcional, é a aplicação de algum filtro na imagem; o segundo calcula a variância em uma janela de
tamanho fixo ao redor de cada pixel ; e o terceiro calcula a soma ou variância de todos os valores.
O segundo passo resulta em uma imagem ligeiramente menor dependendo do tamanho da janela,
pois são usadas apenas janelas contidas inteiramente na imagem.

Como estes algoritmos calculam a variância de janelas na imagem, é importante que a implemen-
tação seja feita de forma eficiente. No artigo de Bueno-Ibarra et. al [BIA+05], por exemplo, o cálculo
da Variância Global em uma imagem de 3.2 MP possui tempo de execução de quase 28 segundos,
muito maior do que outros algoritmos testados no artigo. Uma forma simples de realizar o cálculo
da variância em janelas de forma mais eficiente é através da fórmula

Var(I) = E[I2] ? (E[I])2.

Ou seja, primeiro calcula-se a imagem com os valores ao quadrado I2, e depois calcula-se a média
em janelas nesta imagem para se obter E[I2] para cada janela. Então calcula-se a média em janelas
na imagem original e subtrai-se os valores ao quadrado (E[I])2 dos valores obtidos no passo anterior,
resultando nas variâncias das janelas Var(I).

O cálculo da média em janelas pode ser feito em duas etapas, uma para cada dimensão da
imagem. Em cada dimensão é calculada a média móvel, que pode ser obtida de forma iterativa
subtraindo o último elemento da janela e somando o próximo, dividindo o resultado pela largura
da janela e somando este valor à média da janela anterior. Ou seja, não é necessário somar todos os
elementos da janela novamente a cada passo, bastando calcular uma subtração, uma divisão e uma
soma por passo. Na biblioteca SciPy a média móvel em duas dimensões é calculada pela função
uniform_filter, através da qual se obtém a Variância Global de uma imagem de 3.2 MP em cerca de
272 ms, quando calculada em um MacBook Pro com processador Intel Core i5 de 2.5 GHz e 8 GB
de memória DDR3 1600 MHz.

Variância Global

A Variância Global [PPCCMFV00, BIA+05] primeiro calcula a variância da imagem I em janelas
de largura e altura r, resultando em uma imagem de variâncias locais ILV . Por fim é calculado o
valor da medida

GBLVAR = Var(ILV ).

Variância Global do Gradiente Gaussiano

A medida GBLVARGG é o resultado da Variância Global aplicada no gradiente gaussiano da
imagem. Não temos conhecimento do uso desta medida na literatura.



64 FOCALIZAÇÃO 5.3

Variância Total do Gradiente Gaussiano

Esta medida é similar à Variância Global do Gradiente Gaussiano, mas utiliza um somatório no
último passo, ao invés da variância. Primeiro é calculado o gradiente gaussiano da imagem, e então
calcula-se a variância deste gradiente em janelas de altura e largura r, resultando em uma imagem
de variâncias locais ILV . Por fim é calculado o valor da medida

TOTVAR =
??

ILV .

Não temos conhecimento do uso desta medida na literatura.

Variância Global do Laplaciano do Gaussiano

A medida GBLVARLoG é o resultado da Variância Global aplicada no laplaciano do gaussiano
da imagem. Não temos conhecimento do uso desta medida na literatura.

5.2 Complexidade computacional

Iremos supor que o gradiente gaussiano é utilizado com um parâmetro ? de valor inferior a
uma constante razoável, digamos ? ? 32. Para uma imagem de tamanho N × N, os algoritmos
das medidas de foco possuem complexidade O(N2), com exceção do Índice S, que utiliza a FFT e
possui complexidade O(N2 log N).

Portanto, o maior gasto computacional na focalização decorre das reconstruções holográficas a
diversas distâncias, e não do cálculo de uma medida de foco (desconsiderando o Índice S).

5.3 Resultados experimentais

As medidas de focalização serão avaliadas de acordo com o erro médio (ME) e a raiz do erro
quadrático médio (RMSE). Para cada imagem, o erro é calculado como a diferença absoluta entre
a distância obtida pela medida de foco e a distância de referência, em milímetros.

Como serão utilizadas imagens obtidas experimentalmente, não é possível saber a distância
correta de cada objeto. Por este motivo, cada imagem foi focalizada manualmente, e a distância
escolhida é utilizada como referência. Existe alguma subjetividade neste processo, pois pessoas dife-
rentes poderiam focalizar a mesma imagem em distâncias diferentes. Porém, como cada imagem foi
reconstruída em vários passos uniformemente espaçados, e considerando as distâncias destes passos
que foram usadas nos experimentos entre uma reconstrução holográfica e a reconstrução imediata-
mente seguinte, para grande parte das imagens existe apenas uma distância que está claramente
melhor focalizada do que as demais. Além disso, o próprio problema sendo analisado possui certa
ambiguidade, pois como os objetos sendo focalizados são tridimensionais, é comum que diferentes
segmentos do objeto estejam bem focalizados a distâncias distintas, não havendo uma única distân-
cia que seja a correta. Desta forma, acreditamos que o uso de distâncias escolhidas manualmente é
razoável, desde que se tenha em mente que diferenças muito pequenas entre os erros das medidas
de foco podem ser o resultado desta subjetividade ou da ambiguidade do problema de focalização.

Para obter as imagens que serão focalizadas, cada holograma foi estendido com a Minimização
do Laplaciano, descrita no Capítulo 4, e reconstruído a 30 distâncias diferentes, espaçadas de forma
uniforme. As reconstruções foram limiarizadas para que as intensidades ficassem no intervalo [0, 255].
Algumas regiões que continham algum objeto foram escolhidas para serem focalizadas, evitando
regiões com mais de um objeto, exceto quando um destes é muito maior do que os demais, caso em
que este objeto maior é o que foi focalizado. As medidas de foco foram aplicadas nestas regiões, e a
distância que maximiza (ou minimiza) o valor da medida é considerada como a melhor focalizada
segundo a medida sendo avaliada.



5.3 RESULTADOS EXPERIMENTAIS 65

5.3.1 Resultados

Foram utilizados três conjuntos de imagens, obtidas experimentalmente de amostras diferen-
tes de organismos planctônicos. Nos três conjuntos, a câmera utilizada possui pixels quadrados de
3.45 µm de largura. No conjunto A, o laser utilizado possui comprimento de onda de 660 nm e os
hologramas foram reconstruídos entre 5 cm e 7 cm. No conjunto B, o laser utilizado possui com-
primento de onda de 660 nm e os hologramas foram reconstruídos entre 6 cm e 8 cm. No conjunto
C, o laser utilizado possui comprimento de onda de 633 nm e os hologramas foram reconstruí-
dos entre 2.5 cm e 4 cm. Com isso, os hologramas dos conjuntos A e B foram reconstruídos com
aproximadamente 0.6897 mm de distância entre cada reconstrução, e os hologramas do conjunto C
com aproximadamente 0.5172 mm de distância entre cada reconstrução. O conjunto A possui 19
imagens, o conjunto B possui 50 imagens e o conjunto C possui 118 imagens, em um total de 187
imagens. Algumas destas imagens podem ser visualizadas no Apêndice B, que contém reconstruções
realizadas à distância escolhida manualmente como sendo a correta.

Ao exibir os erros das medidas, iremos desconsiderar medidas com erro médio superior a dois
passos da distância de referência, ou seja, com erro médio superior a 2 × 0.6897 mm = 1.3794 mm
para os conjuntos A e B, superior a 2 × 0.5172 mm = 1.0344 mm para o conjunto C, e superior a
1.1617 mm para a união dos três conjuntos. Uma grande quantidade das medidas avaliadas mostrou-
se inadequada para a focalização de imagens holográficas de organismos planctônicos, e omiti-las
facilitará a interpretação dos resultados.

As seguintes medidas foram maximizadas: SIMVAR, GBLVAR, TOTVAR, GGMVAR, SOBVAR,
GBLVARGG, GBLVARLoG, HPACM, LAPVAR, Amplitude, Laplaciano, Índice S, SDC, Variância,
Tamuraaprox, SML, Tenengrad, EOL, EOGS, XSML, Boddeke, TV.

As seguintes medidas foram minimizadas: Entropia, GGMSUM, SIM, ACM, Tamura, PK.
Foi utilizado o parâmetro ? = 1 para as medidas TOTVAR, SIMVAR, GGMVAR, e GBLVARGG;

o parâmetro ? = 1.5 para a medida GBLVARLoG; e ? = 2 para as medidas GGMSUM e SIM. Foram
utilizadas janelas de largura e altura igual a 6 pixels para as medidas GBLVAR e GBLVARGG, e
20 pixels para as medidas TOTVAR e GBLVARLoG. Foi realizada uma limiarização com T = 30
nas medidas SOBVAR, LAPVAR e Laplaciano; T = 32 na medida HPACM; T = 40 na medida
SML; T = 70 na medida XSML; e T = 100 na medida Tenengrad. Na medida HPACM foi utilizado
o passo s = 5.

Na figura 5.2 são exibidas todas as reconstruções utilizadas no experimento para um dos or-
ganismos do conjunto C. Os valores de algumas medidas de foco para este organismo podem ser
vistos na figura 5.3. Existem várias características que dificultam a focalização desta imagem: o
organismo é pequeno, não possuindo muitas bordas bem definidas; existem padrões de difração no
lado esquerdo da região inferior da imagem, que aparentam ser de outro organismo próximo que
não aparece na reconstrução; e também existe um padrão de interferência formado por linhas quase
horizontais que criam oscilações na intensidade. O resultado é que as medidas SOBVAR e HPACM
são maximizadas em distâncias incorretas de focalização, além de apresentarem fortes oscilações em
seus valores.

Na figura 5.4 são exibidas todas as reconstruções de outro organismo do conjunto C que foram
utilizadas no experimento. Os valores de algumas medidas de foco para este organismo podem ser
vistos na figura 5.5. Este exemplo também possui características que dificultam sua focalização: o
organismo é transparente, possuindo intensidades que são em grande parte similares ao fundo; além
disso, quando está fora de foco a sua forma esférica cria padrões de difração circulares, que algumas
medidas não diferenciam da imagem focalizada. Neste caso, as medidas GBLVARGG, GBLVAR e
GBLVARLoG são maximizadas em distâncias incorretas de focalização, além de apresentarem fortes
oscilações na região próxima ao valor máximo.

A tabela 5.1 apresenta os erros de focalização para o conjunto A. O uso das medidas TOTVAR
e SIMVAR resultou na focalização incorreta de apenas 1 imagem em 19, com a escolha de outra
distância imediatamente seguida, enquanto que para as medidas Amplitude e GBLVARGG o mesmo
ocorreu em 2 imagens.

Na tabela 5.2, podemos ver que o uso das medidas SIMVAR e GGMVAR resultou nos menores



66 FOCALIZAÇÃO 5.3

Figura 5.2: Exemplo de organismo sendo focalizado. Este organismo pertence ao conjunto C, e é de difícil
focalização por ser extremamente pequeno para a câmera e possuir poucos detalhes. Todas as reconstruções
utilizadas no experimento de focalização são exibidas, com a distância de reconstrução aumentando da es-
querda para a direita, de cima para baixo. A imagem escolhida manualmente como a melhor focalizada é a
quinta da terceira linha.

Tabela 5.1: Erros de focalização - Conjunto A

Medida RMSE (mm) Erro médio (mm)
TOTVAR 0.15822 0.03630
SIMVAR 0.15822 0.03630
Amplitude 0.22375 0.07260
GBLVARGG 0.22375 0.07260
GGMVAR 0.27404 0.10889
SOBVAR 0.27404 0.10889
GBLVAR 0.27404 0.10889
GBLVARLoG 0.27404 0.10889
Entropia 0.67126 0.21779
HPACM 1.14092 0.36298
GGMSUM 0.86659 0.72595
LAPVAR 2.03849 0.79855
Laplaciano 2.55118 1.37931



5.3 RESULTADOS EXPERIMENTAIS 67

Figura 5.3: Valores de medidas de foco para um organismo. O organismo sendo focalizado é o exibido na
figura 5.2, e a linha vertical pontilhada representa a distância escolhida manualmente. O gráfico exibe o
negativo da Entropia, desta forma a distância escolhida é a que maximiza a medida.

Tabela 5.2: Erros de focalização - Conjunto B

Medida RMSE (mm) Erro médio (mm)
SIMVAR 0.19506 0.05517
GGMVAR 0.19506 0.05517
TOTVAR 0.21809 0.06897
GBLVARGG 0.21809 0.06897
GBLVAR 0.23890 0.08276
SOBVAR 0.25805 0.09655
GBLVARLoG 0.32348 0.12414
Laplaciano 0.60909 0.26207
LAPVAR 0.71671 0.30345
Entropia 2.26013 0.42759
HPACM 2.19609 0.56552
SDC 2.48084 0.78621



68 FOCALIZAÇÃO 5.3

Figura 5.4: Exemplo de organismo sendo focalizado. Este organismo pertence ao conjunto C, e é de difícil
focalização por ser transparente e esférico, criando padrões de difração que algumas medidas não diferenciam
do organismo focalizado. Todas as reconstruções utilizadas no experimento de focalização são exibidas, com
a distância de reconstrução aumentando da esquerda para a direita, de cima para baixo. A imagem escolhida
manualmente como a melhor focalizada é a terceira da quarta linha.



5.3 RESULTADOS EXPERIMENTAIS 69

Figura 5.5: Valores de medidas de foco para um organismo. O organismo sendo focalizado é o exibido na
figura 5.4, e a linha vertical pontilhada representa a distância escolhida manualmente. O gráfico exibe o
negativo da Entropia, desta forma a distância escolhida é a que maximiza a medida.

erros para as imagens do conjunto B. Com estas medidas obteve-se a focalização incorreta de 4
imagens em 50, nas quais foi escolhida outra distância imediatamente seguida, enquanto que para
as medidas TOTVAR e GBLVARGG o mesmo ocorreu em 5 imagens.

Tabela 5.3: Erros de focalização - Conjunto C

Medida RMSE (mm) Erro médio (mm)
TOTVAR 0.17168 0.05698
SIMVAR 0.20202 0.07890
GBLVAR 0.50840 0.10520
GGMVAR 0.27353 0.10959
GBLVARGG 0.59852 0.11397
SOBVAR 0.72370 0.17972
HPACM 0.55325 0.31999
Entropia 1.50575 0.42957
GBLVARLoG 1.34846 0.43834

Na tabela 5.3 são apresentados os erros de focalização para as imagens do conjunto C. O uso da
medida TOTVAR resultou na focalização incorreta de 13 imagens em 118, nas quais foi escolhida
outra distância imediatamente seguida, e para a medida SIMVAR o mesmo ocorreu em 18 imagens.

A figura 5.6 exibe as distribuições de erros de focalização para cada uma das medidas testadas,
considerando o conjunto total de 187 imagens. Enquanto que nas tabelas foram utilizados os erros
absolutos, nesta figura existem erros positivos e negativos. Isto permite diferenciar o caso em que
a distância de reconstrução escolhida foi próxima demais ao sensor da câmera do caso em que a
distância foi muito distante. Através dos quartis, é possível notar no gráfico superior que várias das
melhores medidas obtiveram a distância correta de focalização para pelo menos 50% das imagens.



70 FOCALIZAÇÃO 5.3

Figura 5.6: Distribuição dos erros de focalização. Erros negativos indicam uma reconstrução mais próxima
ao sensor da câmera do que a distância de referência escolhida manualmente.



5.3 RESULTADOS EXPERIMENTAIS 71

Tabela 5.4: Erros de focalização - Total

Medida RMSE (mm) Erro médio (mm)
TOTVAR 0.18401 0.05809
SIMVAR 0.19614 0.06823
GGMVAR 0.25498 0.09497
GBLVARGG 0.49381 0.09773
GBLVAR 0.43126 0.09958
SOBVAR 0.59659 0.15029
GBLVARLoG 1.08767 0.32086
HPACM 1.27080 0.39001
Entropia 1.68591 0.40752
LAPVAR 2.15071 0.97547

Nas duas medidas com menor erro médio, TOTVAR e SIMVAR, o maior erro foi de apenas um
passo de focalização para mais ou para menos.

Conforme a tabela 5.4, a medida TOTVAR é a que obteve o melhor desempenho dentre as
medidas avaliadas, possuindo o menor erro médio nos conjuntos de imagens A e C, e um erro
médio apenas um pouco superior ao da melhor medida para o conjunto B. Porém, como foi dito
anteriormente, estes pequenos erros da medida podem ser atribuídos à subjetividade das distâncias
de referência e à ambiguidade do problema de focalização, e não é possível afirmar a partir destes
resultados que seu desempenho é superior ao da medida SIMVAR. Todas as outras medidas obtive-
ram um erro de pelo menos dois passos de focalização para pelo menos uma das imagens. Portanto,
concluímos que as medidas TOTVAR e SIMVAR empataram como as melhores medidas de foco
avaliadas, tendo erros médios extremamente baixos. Lembrando que não temos conhecimento destas
duas medidas que estão sendo propostas neste trabalho sendo utilizadas na literatura.

É interessante notar algumas semelhanças entre as medidas que obtiveram os menores erros.
As quatro melhores medidas utilizam a magnitude do gradiente gaussiano em seu cálculo. E das
sete melhores medidas de foco, todas exceto a TOTVAR podem ser interpretadas como a aplica-
ção de um filtro na imagem seguida pelo cálculo da variância da imagem filtrada. Isto faz sentido
quando comparamos visualmente imagens fora de foco com imagens bem focalizadas: as que estão
focalizadas possuem algumas bordas fortes e a maior parte da imagem tem poucas variações, e
conforme o objeto é desfocalizado as ondas de difração geram ondulações na intensidade de boa
parte da imagem. Portanto, um filtro que responda a estas variações terá um valor bem elevado
para algumas regiões e relativamente baixo para outras em uma imagem focalizada, ou seja, terá
uma variância alta. Já em uma imagem fora de foco as ondas de difração irão gerar valores simi-
lares para este filtro em grande parte da imagem, e a variância será baixa. Outra característica
que pode ser observada é que várias medidas combinam valores obtidos em diferentes escalas. A
medida TOTVAR, por exemplo, utiliza os valores dos pixels para calcular a magnitude do gradiente
gaussiano, que se torna menos local quanto maior for o valor de ?; depois utiliza esta magnitude
para calcular a variância em janelas, resultando em valores menos localizados do que o gradiente; e
finaliza calculando o somatório global para a imagem.

Também é possível combinar mais de uma medida de foco, ao invés de utilizar apenas uma.
Não faremos um estudo detalhado das diferentes formas de realizar estas combinações, mas apenas
mostraremos que mesmo uma técnica simples já pode trazer bons resultados. Ao invés de utilizar
a distância escolhida por uma medida, utilizamos 5 medidas e escolhemos a mediana como distân-
cia final. Na tabela 5.5 está o resultado de utilizar a mediana das medidas SIMVAR, GBLVAR,
TOTVAR, SOBVAR e Entropia. Neste caso, a medida TOTVAR foi calculada com o parâmetro
? = 2. Os erros nos conjuntos A e B são idênticos aos da medida SIMVAR, porém há uma diminuição
nos erros do conjunto C, que são menores do que os erros de qualquer medida individual.



72 FOCALIZAÇÃO 5.3

Tabela 5.5: Erros de focalização - Mediana

Conjunto RMSE (mm) Erro médio (mm)
A 0.15822 0.03630
B 0.19506 0.05517
C 0.16495 0.05260
Total 0.17287 0.05163

Algoritmo de autofoco

As medidas também foram avaliadas quando utilizadas em um algoritmo de autofoco que realiza
a focalização em três etapas, com o objetivo de diminuir o número total de reconstruções. Para cada
imagem são utilizadas as mesmas 30 reconstruções que nos experimentos anteriores, porém em cada
etapa do algoritmo apenas um subconjunto destas reconstruções tem seu foco avaliado. Na primeira
etapa é medido o foco das reconstruções cujos índices pertencem ao conjunto {0, 5, 10, 15, 20, 25, 29}.
Na segunda etapa, além da reconstrução de índice k escolhida na etapa anterior, também são
consideradas as reconstruções de índice par e que pertencem ao intervalo ]k ? 5, k + 5[. Na terceira
e última etapa são consideradas as reconstruções de índice k ? 1, k e k + 1, onde k é o índice que
obteve o melhor foco na etapa anterior.

(a) Passo 1 (b) Passo 2

Figura 5.7: Exemplo de execução do algoritmo de autofoco. No primeiro passo (a), o foco de algumas
reconstruções é avaliado por uma medida de foco, e a reconstrução de índice 15 é a que obtém o melhor foco,
indicado pela linha tracejada vertical. A região sombreada em torno deste índice é selecionada para o passo
seguinte (b), no qual as reconstruções de índices 12, 14, 16 e 18 são avaliadas. A reconstrução de índice
15 continua sendo a melhor focalizada segundo a medida, e a região sombreada mais escura é selecionada
para o passo 3. Porém, as reconstruções de índices 14, 15 e 16 que seriam avaliadas no passo 3 já foram
examinadas, e o algoritmo termina escolhendo a reconstrução de índice 15 como a melhor focalizada por
esta medida.

Como exemplo, suponha que das 7 reconstruções iniciais na primeira etapa, a que está melhor
focalizada segundo a medida sendo avaliada é a de índice 15, como ilustrado na figura 5.7a. Na
segunda etapa é avaliado o foco das reconstruções de índices 12, 14, 16 e 18, além da reconstrução
15 que já foi avaliada. Suponha que, dentre estas 5 reconstruções, a de índice 15 continue sendo
a melhor, como ilustrado na figura 5.7b. Na terceira etapa são avaliadas as reconstruções 14, 15
e 16. Como as três já foram avaliadas nas etapas anteriores, temos que a melhor reconstrução é
a de índice 15. Neste exemplo foram feitas 7 reconstruções na primeira etapa, 4 reconstruções na
segunda e nenhuma reconstrução na terceira. Com isso temos 11 reconstruções, ao invés das 30 que
seriam feitas se a focalização tivesse uma única etapa.

Outro exemplo: na primeira etapa a reconstrução 10 obtém o melhor foco, conforme ilustrado na
figura 5.8a. Na segunda etapa são avaliadas as reconstruções 6, 8, 12 e 14, além da reconstrução 10,



5.3 RESULTADOS EXPERIMENTAIS 73

(a) Passo 1 (b) Passo 2

(c) Passo 3

Figura 5.8: Exemplo de execução do algoritmo de autofoco. No primeiro passo (a), o foco de algumas
reconstruções é avaliado por uma medida de foco, e a reconstrução de índice 10 é a que obtém o melhor foco,
indicado pela linha tracejada vertical. A região sombreada em torno deste índice é selecionada para o passo
seguinte (b), no qual as reconstruções de índices 6, 8, 12 e 14 são avaliadas. A reconstrução de índice 8
torna-se a melhor focalizada segundo a medida, e a região sombreada mais escura é selecionada para o passo
3. Neste último passo, as reconstruções de índices 7 e 9 são avaliadas, e o algoritmo termina escolhendo a
reconstrução de índice 8 como a melhor focalizada segundo a medida.



74 FOCALIZAÇÃO 5.3

conforme ilustrado na figura 5.8b. Supondo que a reconstrução 8 obteve o melhor foco, na terceira
etapa são avaliadas as reconstruções 7, 8 e 9, conforme ilustrado na figura 5.8c. Com relação ao
número de reconstruções este é o pior caso, pois foram feitas 7 reconstruções na primeira etapa, 4
na segunda e 2 na terceira, totalizando 13 reconstruções.

Tabela 5.6: Erros de autofoco - Conjunto A

Medida RMSE (mm) Erro médio (mm)
SIMVAR 0.15822 0.03630
TOTVAR 0.15822 0.03630
GBLVARGG 0.22375 0.07260
SOBVAR 0.27404 0.10889
GGMVAR 0.27404 0.10889
GBLVAR 0.27404 0.10889
GBLVARLoG 0.27404 0.10889
HPACM 0.31644 0.14519
Entropia 0.67126 0.21779
GGMSUM 0.82212 0.68966
Amplitude 3.01445 0.76225
LAPVAR 2.12860 0.90744
Laplaciano 2.55118 1.37931

Tabela 5.7: Erros de autofoco - Conjunto B

Medida RMSE (mm) Erro médio (mm)
SIMVAR 0.19506 0.05517
GGMVAR 0.19506 0.05517
GBLVARGG 0.21809 0.06897
GBLVAR 0.23890 0.08276
SOBVAR 0.25805 0.09655
GBLVARLoG 0.57701 0.23448
Entropia 2.26013 0.42759
LAPVAR 1.35846 0.44138
TOTVAR 2.68169 0.80000
HPACM 2.85854 1.03448
Laplaciano 3.39406 1.17241

Nas tabelas 5.6, 5.7 e 5.8 são exibidos os erros de focalização ao utilizar este algoritmo de
autofoco. A medida SIMVAR não só obteve os menores erros nos três conjuntos de imagens, mas os
erros nos conjuntos A e B são iguais aos dos experimentos anteriores que utilizam 30 reconstruções,
demonstrando a viabilidade de usar este algoritmo para obter focalizações mais rápidas sem que
isto resulte em uma perda considerável de precisão.



5.3 RESULTADOS EXPERIMENTAIS 75

Tabela 5.8: Erros de autofoco - Conjunto C

Medida RMSE (mm) Erro médio (mm)
SIMVAR 0.40122 0.11835
GBLVAR 0.73612 0.17972
GBLVARGG 1.04213 0.23232
SOBVAR 0.89842 0.28930
GGMVAR 1.05939 0.32876
HPACM 1.09413 0.51724
TOTVAR 1.60063 0.53477
GBLVARLoG 1.48299 0.60491
Entropia 1.99760 0.62244



76 FOCALIZAÇÃO 5.3



Capítulo 6

Sistema web

Neste capítulo descrevemos o sistema que foi desenvolvido para o processamento de imagens de
hologramas digitais de plâncton.

6.1 Arquitetura

Figura 6.1: Arquitetura do sistema.

Foi desenvolvido um sistema web para o processamento distribuído de imagens holográficas,
disponibilizado sob a licença GPLv2 1 ou versão posterior, cuja arquitetura pode ser vista na
figura 6.1. O sistema usa o arcabouço Django 2 , sendo programado quase inteiramente na linguagem
Python, exceto pela interface que utiliza HTML, CSS e JavaScript. Os arquivos de imagens são
armazenados de forma distribuída no sistema de arquivos GlusterFS 3 (Files). O Gunicorn 4 é
usado nos servidores de aplicação (Application) . O RabbitMQ 5 é usado no servidor de mensagens

1https://www.gnu.org/licenses/gpl-2.0.html Acessado em 6 de julho de 2017.
2https://www.djangoproject.com/ Acessado em 27 de fevereiro de 2017.
3https://www.gluster.org/ Acessado em 27 de fevereiro de 2017.
4http://gunicorn.org/ Acessado em 27 de fevereiro de 2017.
5https://www.rabbitmq.com/ Acessado em 27 de fevereiro de 2017.

77

https://www.gnu.org/licenses/gpl-2.0.html
https://www.djangoproject.com/
https://www.gluster.org/
http://gunicorn.org/
https://www.rabbitmq.com/


78 SISTEMA WEB 6.2

(Message Server ) para realizar a comunicação entre os servidores de aplicação e os servidores de
processamento (Processing). Nos servidores de processamento, o Celery 6 é usado para executar
tarefas de processamento de forma distribuída. O status destas tarefas (e.g., “Em processamento”
ou “Finalizada”) é armazenado no Redis 7 , que também está localizado no servidor de mensagens. O
banco de dados (Database) PostgreSQL 8 armazena todos os dados do sistema, exceto as imagens,
para as quais armazena apenas o caminho do arquivo. O servidor NGINX 9 (Web server ) recebe as
requisições e as redireciona para os servidores de aplicação, além de servir os arquivos de imagem.

Esta arquitetura permite uma flexibilidade razoável no crescimento do sistema, podendo serem
adicionadas novas máquinas onde forem mais necessárias. O processamento de imagens é uma tarefa
que consome muitos recursos computacionais e é demorada, sendo realizado em máquinas separa-
das de forma assíncrona. Isto libera os servidores de aplicação destas tarefas, para que continuem
respondendo de forma rápida, sem lentidões no uso da interface. Os arquivos de imagens, que repre-
sentam a maior parte dos dados, são armazenados no GlusterFS, que permite distribuir e replicar
os arquivos em vários dispositivos de armazenamento. Desta forma, mesmo que um dispositivo falhe
ainda é possível acessar os arquivos sem a necessidade de recuperar um backup. Também facilita a
adição de novos dispositivos de armazenamento, pois todos eles são vistos pelos clientes como um
único sistema de arquivos. O arcabouço Django permite que novas funcionalidades sejam adiciona-
das ao sistema de forma modular, simplificando o compartilhamento e reaproveitamento de código
entre diferentes sistemas. Portanto, a maior dificuldade de se adicionar uma nova funcionalidade ao
sistema está em seu desenvolvimento, e não na sua integração ao resto do código, incentivando a
adição de novas funcionalidades e a realização de melhorias.

Algumas dificuldades que surgem nos estudos de plâncton decorrem do uso de diversas máqui-
nas e dispositivos de armazenamento, o que faz com que os dados não sejam facilmente localizados
e compartilhados entre os diversos pesquisadores. Na prática, não existe uma política de geren-
ciamento destes dados, o que pode inclusive ocasionar a perda de meses de pesquisas caso uma
máquina falhe e não existam outras cópias. Tendo em vista esta situação, e lembrando que a grande
maioria dos pesquisadores envolvidos não é da área de Tecnologia da Informação, escolheu-se a
arquitetura apresentada com o objetivo de centralizar e organizar o armazenamento de imagens
holográficas. Apesar da instalação inicial ser um tanto complexa, a manutenção pode ser feita sem
grandes esforços. Esta arquitetura já prevê situações como a falha em um disco rígido, e facilita
o compartilhamento de dados até mesmo com grupos de pesquisa localizados em outros países,
bastando fornecer credenciais de acesso ao sistema.

6.2 Interface

O sistema possui uma interface web, fazendo com que possa ser utilizado de praticamente qual-
quer computador de forma fácil, sem precisar ser instalado em cada máquina. A seguir ilustraremos
as principais características do sistema e sua interface.

A tela inicial do sistema pode ser vista na figura 6.2. Os arquivos de imagens são organizados em
experimentos, e nesta figura podem ser vistos alguns dos hologramas de dois experimentos diferentes.

Cada experimento possui um conjunto de parâmetros, como pode ser visto na figura 6.3. Estes
parâmetros incluem as dimensões dos pixels da câmera, o comprimento de onda do laser, e as
distâncias mínima e máxima entre a amostra sendo observada e o sensor da câmera, entre outros.

Após preencher os parâmetros do experimento, os hologramas podem ser enviados ao sistema,
como ilustrado na figura 6.4. É possível realizar o upload de vários arquivos simultaneamente, e
estes podem ser arrastados e soltados na tela de upload, facilitando o envio.

Os hologramas enviados podem ser visualizados na tela exibida na figura 6.5. É possível iniciar
o processamento de todos os hologramas, ou exibí-los em lista, e então processar ou excluir alguns

6http://www.celeryproject.org/ Acessado em 27 de fevereiro de 2017.
7https://redis.io/ Acessado em 27 de fevereiro de 2017.
8https://www.postgresql.org/ Acessado em 27 de fevereiro de 2017.
9https://www.nginx.com/ Acessado em 27 de fevereiro de 2017.

http://www.celeryproject.org/
https://redis.io/
https://www.postgresql.org/
https://www.nginx.com/


6.2 INTERFACE 79

Figura 6.2: Tela inicial.

Figura 6.3: Parâmetros de um experimento.



80 SISTEMA WEB 6.2

Figura 6.4: Tela para upload de hologramas.

Figura 6.5: Visualização dos hologramas enviados.



6.2 INTERFACE 81

hologramas específicos.

(a) Organismos segmentados (b) Organismo reconstruído

(c) Holograma com fundo removido

Figura 6.6: Visualização de um holograma.

Após serem processados, os resultados de cada holograma podem ser vistos como na figura 6.6.
Ao mover o mouse sobre o holograma, as regiões segmentadas são destacadas, como na figura 6.6a.
Quando o mouse é colocado sobre uma das regiões destacadas, a reconstrução focalizada desta
região é exibida como na figura 6.6b, na qual o copépodo próximo ao centro está sendo visualizado.
Existem alguns organismos que aparentemente não foram segmentados na figura 6.6a, mas grande
parte destes são parte do fundo da imagem, ou seja, são padrões estáticos que foram removidos com
o fundo. A imagem sem o fundo pode ser vista selecionando-se um checkbox, como na figura 6.6c.

As regiões de interesse que foram segmentadas e focalizadas automaticamente são exibidas em
uma aba separada, ilustrada na figura 6.7. Os segmentos são separados em três grupos: os que não
foram validados manualmente, os que precisam ser focalizados manualmente, e os que já foram
validados. É possível realizar a validação manual de todas as imagens de uma só vez, seja aceitando
os resultados automáticos, ou exigindo uma focalização manual para todas elas.

A figura 6.8 mostra a tela de focalização manual, na qual uma barra pode ser deslizada para
modificar a distância de reconstrução. Quando estiver bem focalizado, basta clicar no botão OK
para validar o organismo.



82 SISTEMA WEB 6.2

(a) Organismos segmentados

Figura 6.7: Visualização dos organismos segmentados.



6.2 INTERFACE 83

Figura 6.8: Focalização manual de um organismo.

Os resultados do processamento podem ser baixados de uma única vez na tela de parâmetros,
no botão Download experiment. Assim, se desejar o usuário pode utilizar outro sistema para realizar
a classificação das imagens, por exemplo.



84 SISTEMA WEB 6.2



Capítulo 7

Conclusão

Criada várias décadas atrás, a holografia era uma técnica muito a frente de seu tempo, e ainda
seriam necessários alguns avanços tecnológicos para sua adoção em maior escala. A invenção do laser
permitiu a criação de hologramas ópticos de forma relativamente simples, e avanços em computa-
dores e sensores digitais de câmeras tornaram a holografia digital uma alternativa prática. Porém,
ainda resta o desenvolvimento de algoritmos e software que transformem os hologramas digitais em
dados úteis para pesquisadores de forma simples.

As possibilidades oferecidas pelo processamento digital de hologramas são inúmeras, e nas seções
abaixo recapitulamos as contribuições deste trabalho, além de indicar algumas possíveis linhas de
pesquisa para estendê-lo.

7.1 Contribuições

Neste trabalho, detalhamos as diversas etapas de processamento de imagens de holografia di-
gital de plâncton, partindo dos hologramas obtidos experimentalmente e chegando em imagens
focalizadas e segmentadas de organismos planctônicos. Realizamos uma análise de diferentes algo-
ritmos de reconstrução holográfica, verificando como diferentes frequências da imagem são afetadas
e quais os cuidados necessários para evitar artefatos na imagem final. Tratamos os aspectos discre-
tos dos algoritmos, notando os efeitos de amostragem de funções de transferência, e da convolução
circular realizada através da FFT. Propomos algoritmos para melhorar a qualidade das imagens
que dificilmente poderiam ser implementados com instrumentos ópticos: removemos o fundo dos
hologramas, tornando a iluminação mais uniforme e suprimindo artefatos provenientes do sistema
óptico; e estendemos a borda dos hologramas antes de sua reconstrução, obtendo imagens com me-
nos ondulações provenientes da difração da borda retangular do holograma. Também comparamos
diferentes medidas de foco, com as quais podemos obter imagens focalizadas dos organismos de
forma automática.

No Capítulo 4, estudamos diversos algoritmos para estender imagens de holografia digital, e pro-
pomos um novo algoritmo: a Minimização do Laplaciano. Fizemos uma comparação experimental
para determinar quais destes algoritmos obtêm os menores erros na imagem reconstruída, e a Mini-
mização do Laplaciano mostrou-se superior aos outros algoritmos testados. Com isso, conseguimos
diminuir consideravelmente o efeito de difração da borda do holograma, permitindo a visualização
do objeto sendo observado sem estes artefatos que decorrem da natureza finita das dimensões da
imagem.

No Capítulo 5, fizemos a comparação de diversas medidas de foco, além de propor algumas novas
medidas, incluindo a Variância Total do Gradiente Gaussiano e a Variância do Máximo Orientado da
Intensidade. Realizamos comparações experimentais das medidas, e estas duas medidas propostas
mostraram-se superiores a todas as outras que foram avaliadas, com erros de focalização extrema-
mente pequenos. Também apresentamos um algoritmo de autofoco, que realiza um número menor
de reconstruções holográficas, diminuindo o tempo de processamento, com pouca perda de qualidade
na focalização. Concluímos que a focalização totalmente automática de organismos planctônicos é

85



86 CONCLUSÃO 7.2

perfeitamente factível, o que remove uma das principais dificuldades do uso da holografia no estudo
de plâncton, que é a necessidade de focalizar as imagens após sua aquisição, algo que seria muito
trabalhoso se precisasse ser feito de forma manual.

Por fim, no Capítulo 6 apresentamos o sistema web que foi desenvolvido para o processamento
de imagens holográficas de plâncton. O sistema permite o processamento distribuído das imagens,
diminuindo o tempo total de processamento. O uso de uma interface web faz com que o sistema
possa ser usado em praticamente qualquer computador, sem a necessidade de instalar o programa em
cada máquina, bastando a configuração dos servidores. E sua disponibilização como software livre
facilita sua adoção por diversos pesquisadores, além de permitir futuras melhorias por seus usuários.
Com isso, os resultados deste trabalho poderão ser utilizados no dia-a-dia do estudo de organismos
planctônicos, sem que para isso seja necessário compreender todos os detalhes e complexidades da
holografia digital.

7.2 Trabalhos futuros

Existem diversas formas de estender e aprimorar os resultados deste trabalho, e a seguir listamos
algumas que julgamos serem interessantes.

Um aspecto pouco estudado na área de holografia digital de plâncton é o pós-processamento
das imagens reconstruídas, que normalmente consiste apenas na segmentação e extração de carac-
terísticas para classificação. Devido à capacidade de focalizar numericamente a qualquer distância
desejada, é possível obter um volume que, após algum processamento, resultaria em uma imagem
com qualidade superior a qualquer uma das imagens individuais que o compõem.

Uma das técnicas existentes é a desconvolução, que já foi utilizada em holografia com o objetivo
de obter maior precisão na localização de partículas, e com alguns resultados limitados para objetos
extensos [LGF10]. A desconvolução também pode ser usada para diminuir o efeito da imagem
gêmea ou de objetos fora de foco. A maior desvantagem é que o gasto de memória e o tempo de
processamento são extremamente elevados, diminuindo a utilidade prática desta técnica. Também
é possível realizar a desconvolução de uma única imagem, e não de um volume, o que poderia ser
uma alternativa com menor custo computacional.

Outro pós-processamento possível consiste na remoção ou supressão da imagem gêmea, e várias
técnicas já foram propostas para realizar esta tarefa, com diferentes graus de sucesso [HKPM09].
Algumas delas possuem certas restrições, como a exigência de diferentes configurações ópticas, ou
apenas objetos de amplitude.

Outra técnica é conhecida por composição focal (focus stacking) e permite combinar várias
imagens, cada uma focalizada a uma distância diferente, em uma imagem final que é uma “colagem”
de pedaços bem focalizados das imagens originais. Com isso, poderia-se obter uma imagem em que
o organismo inteiro apareça focalizado, permitindo visualizar os detalhes de sua morfologia. A
composição focal também poderia ser feita utilizando o resultado da desconvolução de um volume,
caso esta desconvolução obtenha bons resultados. Na área de holografia, esta técnica e outras
similares já foram utilizadas na microscopia holográfica digital de objetos de fase, para observar
uma ameba [BCP+09], além de ter sido utilizada em objetos não biológicos, tanto macroscópicos
quanto microscópicos [MHN08, FGA+05, DJ07, NNŠ+03], e rostos humanos [TFHH09]. Porém,
nenhuma destas técnicas parece ter sido estudada no processamento de hologramas de plâncton.

Além do algoritmo de autofoco apresentado neste trabalho, também é possível utilizar outros
algoritmos para diminuir o tempo gasto na focalização. Uma possibilidade seria diminuir a resolução
dos hologramas em uma primeira etapa de focalização e, em etapas posteriores, utilizar resoluções
maiores apenas nas distâncias em que a medida de foco indicar a existência de um objeto. Seria
necessário estudar como esta resolução menor afeta as medidas de foco, para determinar como
manter uma focalização confiável mesmo com a perda de detalhes nas primeiras etapas do algoritmo.

Neste trabalho focalizamos a imagem de um organismo como um todo, e não os pixels indivi-
dualmente, ou pequenas regiões da imagem. Caso se deseje posteriormente fazer uma focalização
mais local, os resultados obtidos no Capítulo 5 poderão auxiliar na escolha de medidas de foco,



7.2 TRABALHOS FUTUROS 87

além de ajudar a clarificar quais são as características que distinguem imagens bem focalizadas das
restantes. E como ilustrado por Thelen et al. [TFHH09], não é possível realizar uma focalização
mais local em toda a imagem, sendo necessário em vários casos utilizar janelas maiores, nas quais
os resultados obtidos aqui podem ser aplicados.

As técnicas utilizadas no artigo de Thelen et al. [TFHH09] poderiam ser analisadas em um
trabalho futuro sobre holografia de plâncton, em especial o uso de alguma medida de confiança
para determinar se o valor da medida de foco deve ser utilizado, ou se alguma outra operação
deve ser realizada. Também poderia-se realizar o algoritmo inverso ao do artigo, começando pela
focalização de todo o organismo com as medidas deste trabalho, e depois refinando esta focalização
para regiões cada vez menores.

Outra forma de utilizar uma medida de confiança seria no algoritmo de autofoco. Caso a medida
de foco tenha resultados que não sejam considerados confiáveis, o algoritmo poderia realizar uma
focalização mais refinada em todo o intervalo de distâncias, e não apenas na região em que a
medida de foco atinge seu valor máximo (ou mínimo). Isto aumentaria um pouco o tempo de
processamento, mas poderia melhorar consideravelmente a qualidade de focalização. Uma medida
de confiança também poderia ser usada ao combinar várias medidas de foco. Neste trabalho usamos
a mediana das distâncias escolhidas por várias medidas, mas também poderia-se usar uma medida
de confiança para descartar as medidas de foco que provavelmente não conseguiram focalizar o
organismo.

Uma aplicação extremamente relevante do sistema apresentado neste trabalho é a classificação
de plâncton. O sistema já permite obter imagens focalizadas e segmentadas dos organismos, e seria
necessário realizar a extração de características e o treinamento de classificadores, tornando possível
a classificação automática das imagens. Seria necessário determinar quais características são mais
relevantes, e quais classificadores são mais precisos, o que demandaria um trabalho considerável, mas
tornaria o sistema web apresentado uma excelente opção no estudo de plâncton, sem a necessidade
de utilizar um sistema secundário para a classificação. Também seria recomendável analisar o efeito
de diferentes segmentações na qualidade da classificação.

Futuramente também seria interessante realizar a observação in situ dos organismos, e o rastre-
amento destes nas imagens, levando em consideração o aspecto sequencial das imagens capturadas
e tratando-as como um vídeo.

Apesar das vantagens apresentadas na arquitetura do sistema web desenvolvido neste trabalho,
existem situações nas quais esta arquitetura não é a ideal. Caso se queira realizar o processamento
das imagens a bordo de uma embarcação, uma aplicação desktop seria mais apropriada. Outro caso
seria o de um laboratório sem conexão rápida à internet, e no qual não seja viável instalar e manter
um servidor com o sistema. E um terceiro caso seria o processamento em um veículo subaquático
autônomo, no qual seria necessário um sistema embarcado.

No caso do sistema embarcado, mesmo que seja possível realizar a implementação na liguagem de
programação Python, apenas os trechos de código referentes ao processamento de imagens poderiam
ser reaproveitados. Como uma parte considerável do sistema é a interface com o usuário, não seria
vantajoso tentar modificá-lo para que funcione de modo embarcado. Se não forem necessárias muitas
modificações no código de processamento, este poderia ser extraído como uma biblioteca que seria
utilizada pelos dois sistemas.

Para utilizar o sistema como uma aplicação desktop, com uma instalação mais simples, porém
local, seriam necessárias algumas alterações que demandariam certo esforço 1. Dependendo do
sistema operacional a ser utilizado, o sistema poderia ser empacotado em um aplicativo utilizando
ferramentas como o py2app 2, Pynsist 3, py2exe 4 ou PyInstaller 5. O arcabouço Django continuaria

1https://moosystems.com/articles/14-distribute-django-app-as-native-desktop-app-01.html Acessado em 6 de ju-
lho de 2017.

2https://pythonhosted.org/py2app/ Acessado em 6 de julho de 2017.
3https://pynsist.readthedocs.io/ Acessado em 6 de julho de 2017.
4http://py2exe.org/ Acessado em 6 de julho de 2017.
5http://www.pyinstaller.org/ Acessado em 6 de julho de 2017.

https://moosystems.com/articles/14-distribute-django-app-as-native-desktop-app-01.html
https://pythonhosted.org/py2app/
https://pynsist.readthedocs.io/
http://py2exe.org/
http://www.pyinstaller.org/


88 CONCLUSÃO

sendo utilizado, mas com o banco de dados SQLite 6, que é mais adequado para uma aplicação
desktop. O GlusterFS e o NGINX não precisariam ser usados, e o Gunicorn seria substituído pelo
CherryPy 7, que faria o papel de servidor web. Para mostrar as páginas HTML da interface, uma
forma seria usar o pywebview 8, que exibe o conteúdo das páginas em uma janela através de
componentes nativos do sistema operacional. Também poderia-se usar o Chromium Embedded
Framework 9, que permite embarcar um navegador web na aplicação. Isto possui a desvantagem de
aumentar consideravelmente o tamanho do aplicativo, porém facilitaria a manutenção da interface,
já que os componentes nativos utilizados pelo pywebview poderiam renderizar as páginas de forma
distinta em cada sistema operacional.

Em suma, a área de holografia digital abre diversas possibilidades no estudo de plâncton e,
apesar de todos os avanços obtidos neste e em outros trabalhos, ainda existem diversas ideias a
serem exploradas, tornando esta uma área fértil para futuras pesquisas.

6https://sqlite.org Acessado em 6 de julho de 2017.
7http://www.cherrypy.org/ Acessado em 6 de julho de 2017.
8https://github.com/r0x0r/pywebview Acessado em 6 de julho de 2017.
9https://bitbucket.org/chromiumembedded/cef Acessado em 6 de julho de 2017.

https://sqlite.org
http://www.cherrypy.org/
https://github.com/r0x0r/pywebview
https://bitbucket.org/chromiumembedded/cef


Apêndice A

Imagens utilizadas no experimento de
extensões de borda

As 36 imagens deste apêndice foram utilizadas no primeiro experimento comparando os erros
das diferentes extensões de borda. São exibidos os hologramas originais e suas reconstruções, que
foram utilizadas como referência, utilizando os mesmos parâmetros usados no experimento. Um
retângulo branco nos hologramas mostra a região da imagem que foi estendida com cada método
antes de ser reconstruída para a comparação. Um retângulo branco na reconstrução mostra a região
da imagem utilizada como referência no cálculo do erro.

Figura A.1: Hologramas utilizados no experimento de extensão de borda. A região destacada foi estendida
e reconstruída utilizando os vários métodos de extensão de borda, e o holograma inteiro foi reconstruído com
a extensão com zeros para obter a região utilizada como referência no cálculo do RMSE.

89



90 APÊNDICE A

Figura A.2: Hologramas utilizados no experimento de extensão de borda. A região destacada foi estendida
e reconstruída utilizando os vários métodos de extensão de borda, e o holograma inteiro foi reconstruído com
a extensão com zeros para obter a região utilizada como referência no cálculo do RMSE.



IMAGENS UTILIZADAS NO EXPERIMENTO DE EXTENSÕES DE BORDA 91

Figura A.3: Hologramas utilizados no experimento de extensão de borda. A região destacada foi estendida
e reconstruída utilizando os vários métodos de extensão de borda, e o holograma inteiro foi reconstruído com
a extensão com zeros para obter a região utilizada como referência no cálculo do RMSE.



92 APÊNDICE A

Figura A.4: Hologramas utilizados no experimento de extensão de borda. A região destacada foi estendida
e reconstruída utilizando os vários métodos de extensão de borda, e o holograma inteiro foi reconstruído com
a extensão com zeros para obter a região utilizada como referência no cálculo do RMSE.

Figura A.5: Reconstruções dos hologramas utilizados no experimento de extensão de borda. O holograma
inteiro foi reconstruído após ser estendido com zeros, e a região destacada foi utilizada como referência no
cálculo do RMSE dos diversos métodos de extensão de borda.



IMAGENS UTILIZADAS NO EXPERIMENTO DE EXTENSÕES DE BORDA 93

Figura A.6: Reconstruções dos hologramas utilizados no experimento de extensão de borda. O holograma
inteiro foi reconstruído após ser estendido com zeros, e a região destacada foi utilizada como referência no
cálculo do RMSE dos diversos métodos de extensão de borda.



94 APÊNDICE A

Figura A.7: Reconstruções dos hologramas utilizados no experimento de extensão de borda. O holograma
inteiro foi reconstruído após ser estendido com zeros, e a região destacada foi utilizada como referência no
cálculo do RMSE dos diversos métodos de extensão de borda.



Apêndice B

Imagens utilizadas no experimento de
focalização

As imagens deste apêndice foram utilizadas nos experimentos do Capítulo 5, que comparam as
medidas de foco. São exibidas algumas das imagens utilizadas como referência, ou seja, reconstruídas
à distância que foi considerada nos experimentos como sendo a correta.

95



96 APÊNDICE B

Figura B.1: Reconstruções do conjunto A utilizadas no experimento de focalização.



IMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZAÇÃO 97

Figura B.2: Reconstruções do conjunto A utilizadas no experimento de focalização.



98 APÊNDICE B

Figura B.3: Reconstruções do conjunto B utilizadas no experimento de focalização.



IMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZAÇÃO 99

Figura B.4: Reconstruções do conjunto B utilizadas no experimento de focalização.



100 APÊNDICE B

Figura B.5: Reconstruções do conjunto C utilizadas no experimento de focalização.



IMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZAÇÃO 101

Figura B.6: Reconstruções do conjunto C utilizadas no experimento de focalização.



102 APÊNDICE B

Figura B.7: Reconstruções do conjunto C utilizadas no experimento de focalização.



IMAGENS UTILIZADAS NO EXPERIMENTO DE FOCALIZAÇÃO 103

Figura B.8: Reconstruções do conjunto C utilizadas no experimento de focalização.



104 APÊNDICE B



Referências Bibliográficas

[Abb73] E. Abbe. Beiträge zur theorie des mikroskops und der mikroskopischen wahrneh-
mung. Archiv für mikroskopische Anatomie, 9(1):413–418, 1873. 22

[BCP+09] Isabelle Bergoënd, Tristan Colomb, Nicolas Pavillon, Yves Emery e Christian De-
peursinge. Depth-of-field extension and 3d reconstruction in digital holographic
microscopy. Em SPIE Europe Optical Metrology, páginas 73901C–73901C. Inter-
national Society for Optics and Photonics, 2009. 31, 57, 58, 61, 62, 86

[BIA+05] Mario A Bueno-Ibarra, Leonardo Acho et al. Fast autofocus algorithm for auto-
mated microscopes. Optical Engineering, 44(6):063601–063601, 2005. 61, 62, 63

[BW99] Max Born e Emil Wolf. Principles of optics: electromagnetic theory of propagation,
interference and diffraction of light. CUP Archive, 1999. 6

[CMD00] Etienne Cuche, Pierre Marquet e Christian Depeursinge. Aperture apodization
using cubic spline interpolation: application in digital holographic microscopy. Op-
tics communications, 182(1):59–69, 2000. 33, 39

[CNAJ01] Nathaniel Ng Kuang Chern, Po Aun Neow e Marcelo H Ang Jr. Practical issues in
pixel-based autofocusing for machine vision. Em Robotics and Automation, 2001.
Proceedings 2001 ICRA. IEEE International Conference on, volume 3, páginas
2791–2796. IEEE, 2001. 58

[CVM+11] Giuseppe A. Cirino, Patrick Verdonck, Ronaldo D. Mansano, José C. Pizolato Jr.,
Daniel B. Mazulquim e Luiz G. Neto. Digital holography: Computer-generated ho-
lograms and diffractive optics in scalar diffraction domain. Em Dr. Freddy Monroy,
editor, Holography - Different Fields of Application. InTech, 2011. 23

[CWR+03] Phil F Culverhouse, Robert Williams, Beatriz Reguera, Vincent Herry e Sonsoles
González-Gil. Do experts make mistakes? a comparison of human and machine
identification of dinoflagellates. Marine Ecology Progress Series, 247(17-25):5, 2003.
1

[DC06] José Antonio Domínguez-Caballero. Digital holographic imaging of aquatic species.
Dissertação de Mestrado, Massachusetts Institute of Technology, 2006. 14, 27, 57

[DCG11] Lisa Dixon, Fook Chiong Cheong e David G Grier. Holographic deconvolution mi-
croscopy for high-resolution particle tracking. Optics express, 19(17):16410–16417,
2011. 31

[DFFD08] Loïc Denis, Corinne Fournier, Thierry Fournel e Christophe Ducottet. Numerical
suppression of the twin image in in-line holography of a volume of micro-objects.
Measurement Science and Technology, 19(7):074004, 2008. 31

[DJ07] Cuong Manh Do e Bahram Javidi. Multifocus holographic 3-d image fusion using
independent component analysis. Display Technology, Journal of, 3(3):326–332,
2007. 86

105



106 REFERÊNCIAS BIBLIOGRÁFICAS

[DMYL02] Frank Dubois, Olivier Monnom, Catherine Yourassowsky e J-C Legros. Border
processing in digital holography by extension of the digital hologram and reduction
of the higher spatial frequencies. Applied optics, 41(14):2621–2626, 2002. 33, 35,
40, 46

[DO08] Victor V Dyomin e Alexey S Olshukov. Digital holographic video of plankton. Em
Optical Engineering+ Applications, páginas 70732B–70732B. International Society
for Optics and Photonics, 2008. 33

[DSCY06] Frank Dubois, Cédric Schockaert, Natcaha Callens e Catherine Yourassowsky. Fo-
cus plane detection criteria in digital holography microscopy by amplitude analysis.
Optics Express, 14(13):5895–5908, 2006. 57

[FGA+05] Pietro Ferraro, Simonetta Grilli, Domenico Alfieri, Sergio De Nicola, Andrea Fi-
nizio, Giovanni Pierattini, Bahram Javidi, Giuseppe Coppola e Valerio Striano.
Extended focused image in microscopy by digital holography. Optics express,
13(18):6738–6749, 2005. 86

[FJ98] Matteo Frigo e Steven G Johnson. Fftw: An adaptive software architecture for
the fft. Em Acoustics, Speech and Signal Processing, 1998. Proceedings of the 1998
IEEE International Conference on, volume 3, páginas 1381–1384. IEEE, 1998. 46

[GK89] John Gillespie e RA King. The use of self-entropy as a focus measure in digital
holography. Pattern recognition letters, 9(1):19–25, 1989. 57

[Goo96] J.W. Goodman. Introduction to Fourier optics. McGraw-Hill series in electrical
and computer engineering. McGraw-Hill, 1996. 6, 8, 18, 27

[GOP+10] Gaby Gorsky, Mark D Ohman, Marc Picheral, Stéphane Gasparini, Lars Stem-
mann, Jean-Baptiste Romagnan, Alison Cawood, Stéphane Pesant, Carmen
García-Comas e Franck Prejger. Digital zooplankton image analysis using the
zooscan integrated system. Journal of Plankton Research, 32(3):285–303, 2010. 1

[GPWG04] Philippe Grosjean, Marc Picheral, Caroline Warembourg e Gabriel Gorsky. Enu-
meration, measurement, and identification of net zooplankton samples using the
zooscan digital imaging system. ICES Journal of Marine Science: Journal du Con-
seil, 61(4):518–525, 2004. 1

[GYL85] Frans CA Groen, Ian T Young e Guido Ligthart. A comparison of different focus
functions for use in autofocus algorithms. Cytometry, 6(2):81–91, 1985. 57, 58

[HJ07] Wei Huang e Zhongliang Jing. Evaluation of focus measures in multi-focus image
fusion. Pattern Recognition Letters, 28(4):493–500, 2007. 57, 62

[HKPM09] Bryan M Hennelly, Damien P Kelly, Nitesh Pandey e David S Monaghan. Review
of twin reduction and twin removal techniques in holography. 2009. 30, 86

[HS05] Bryan M Hennelly e John T Sheridan. Fast numerical algorithm for the linear
canonical transform. JOSA A, 22(5):928–937, 2005. 18

[Jar76] Ray A Jarvis. Focus optimization criteria for computer image-processing. Micros-
cope, 24(2):163–180, 1976. 58

[JOP+ ] Eric Jones, Travis Oliphant, Pearu Peterson et al. SciPy: Open source scientific
tools for Python, 2001–. [Online; accessed 2014-08-16]. 46

[Kel14] Damien P Kelly. Numerical calculation of the fresnel transform. JOSA A,
31(4):755–764, 2014. 22, 24



REFERÊNCIAS BIBLIOGRÁFICAS 107

[KFK12] Tomasz Kozacki, Konstantinos Falaggis e Malgorzata Kujawinska. Computation of
diffracted fields for the case of high numerical aperture using the angular spectrum
method. Applied optics, 51(29):7080–7088, 2012. 24

[KHHS11] DP Kelly, JJ Healy, BM Hennelly e JT Sheridan. Quantifying the 2.5 d ima-
ging performance of digital holographic systems. Journal of the European Optical
Society-Rapid publications vol 6 11034, 6:1034, 2011. 22

[KHJ01] Volker Kebbel, Hans-Jürgen Hartmann e Werner PO Jüptner. Application of digital
holographic microscopy for inspection of micro-optical components. Em Lasers in
Metrology and Art Conservation, páginas 189–198. International Society for Optics
and Photonics, 2001. 34

[KJYFF15] Jonathan Krause, Hailin Jin, Jianchao Yang e Li Fei-Fei. Fine-grained recognition
without part annotations. Em Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, páginas 5546–5555, 2015. 2

[KNR+09] Damien P Kelly, Thomas J Naughton, William T Rhodes, Bryan M Hennelly e
Nitesh Pandey. Resolution limits in practical digital holographic systems. Optical
Engineering, 48(9):095801–095801, 2009. 22

[Kre02] Thomas M Kreis. Frequency analysis of digital holography with reconstruction by
convolution. Optical Engineering, 41(8):1829–1839, 2002. 26

[KSDFF13] Jonathan Krause, Michael Stark, Jia Deng e Li Fei-Fei. 3d object representations for
fine-grained categorization. Em Proceedings of the IEEE International Conference
on Computer Vision Workshops, páginas 554–561, 2013. 2

[LGF10] Tatiana Latychevskaia, Fabian Gehri e Hans-Werner Fink. Depth-resolved ho-
lographic reconstructions by three-dimensional deconvolution. Optics express,
18(21):22527–22544, 2010. 31, 86

[LJ05] Feng Li e Hong Jin. A fast auto focusing method for digital still camera. Em
Machine Learning and Cybernetics, 2005. Proceedings of 2005 International Con-
ference on, volume 8, páginas 5001–5005. IEEE, 2005. 57, 58, 59

[LJ08] Renting Liu e Jiaya Jia. Reducing boundary artifacts in image deconvolution.
Em Image Processing, 2008. ICIP 2008. 15th IEEE International Conference on,
páginas 505–508. IEEE, 2008. 41

[LM15] Arthur Leclaire e Lionel Moisan. No-reference image quality assessment and blind
deblurring with sharpness metrics exploiting fourier phase information. Journal of
Mathematical Imaging and Vision, 52(1):145–172, 2015. 58, 59

[Loo11] Nicholas Charles Loomis. Computational imaging and automated identification for
aqueous environments. Tese de Doutorado, Massachusetts Institute of Technology,
2011. 2, 13, 28, 30, 55, 57, 60

[LSHW09] Jingbo Liu, Xiufa Song, Rui Han e Huaying Wang. Autofocus method in digital
holographic microscopy. Em 4th International Symposium on Advanced Optical
Manufacturing and testing technologies: Optical Test and Measurement Techno-
logy and Equipment, páginas 72833Q–72833Q. International Society for Optics and
Photonics, 2009. 57, 60

[LY08] Shutao Li e Bin Yang. Multifocus image fusion using region segmentation and
spatial frequency. Image and Vision Computing, 26(7):971–979, 2008. 62



108 REFERÊNCIAS BIBLIOGRÁFICAS

[MAK99] Edwin Malkiel, Omar Alquaddoomi e Joseph Katz. Measurements of plankton
distribution in the ocean using submersible holography. Measurement Science and
Technology, 10(12):1142, 1999. 1

[MDP+11] P Memmolo, C Distante, M Paturzo, A Finizio, P Ferraro e B Javidi. Automatic
focusing in digital holography and its application to stretched holograms. Optics
letters, 36(10):1945–1947, 2011. 58

[MDYL05] Olivier Monnom, Frank Dubois, Catherine Yourassowsky e Jean Claude Legros.
Improvement in visibility of an in-focus reconstructed image in digital holography
by reduction of the influence of out-of-focus objects. Applied optics, 44(18):3827–
3832, 2005. 31

[MH03] Samir Mezouari e Andy Robert Harvey. Validity of fresnel and fraunhofer ap-
proximations in scalar diffraction. Journal of Optics A: Pure and Applied Optics,
5(4):S86, 2003. 17

[MHN08] Conor P McElhinney, Bryan M Hennelly e Thomas J Naughton. Extended focused
imaging for digital holograms of macroscopic three-dimensional objects. Applied
Optics, 47(19):D71–D79, 2008. 57, 86

[ML02] Jerome H Milgram e Weichang Li. Computational reconstruction of images from
holograms. Applied optics, 41(5):853–864, 2002. 28

[MS09] Kyoji Matsushima e Tomoyoshi Shimobaba. Band-limited angular spectrum
method for numerical simulation of free-space propagation in far and near fields.
Optics express, 17(22):19662–19673, 2009. 26

[NN94] Shree K Nayar e Yasuo Nakagawa. Shape from focus. IEEE Transactions on
Pattern analysis and machine intelligence, 16(8):824–831, 1994. 60

[NNŠ+03] Markus Niederöst, Jana Niederöst, Ji?í Š?u?ka, Markus Niederöst, Markus Nie-
deröst, Jana Niederöst e Jana Niederöst. Automatic 3D reconstruction and visuali-
zation of microscopic objects from a monoscopic multifocus image sequence. ETH,
Swiss Federal Institute of Technology, Institute of Geodesy and Photogrammetry,
2003. 86

[OSB+89] Alan V Oppenheim, Ronald W Schafer, John R Buck et al. Discrete-time signal
processing, volume 2. Prentice-hall Englewood Cliffs, 1989. 5

[PPCCMFV00] José Luis Pech-Pacheco, Gabriel Cristóbal, Jesús Chamorro-Martinez e Joaquín
Fernández-Valdivia. Diatom autofocusing in brightfield microscopy: a comparative
study. Em Pattern Recognition, 2000. Proceedings. 15th International Conference
on, volume 3, páginas 314–317. IEEE, 2000. 57, 62, 63

[PTVF96] William H Press, Saul A Teukolsky, William T Vetterling e Brian P Flannery.
Numerical recipes in C, volume 2. Cambridge university press Cambridge, 1996.
42

[PV08] Paolo Prandoni e Martin Vetterli. Signal processing for communications. CRC
Press, 2008. 5

[RSR69] Lawrence R Rabiner, Ronald W Schafer e Charles M Rader. The chirp z-transform
algorithm and its application. Bell System Technical Journal, 48(5):1249–1292,
1969. 16



REFERÊNCIAS BIBLIOGRÁFICAS 109

[SBB+08] H Sun, PW Benzie, N Burns, DC Hendry, MA Player e J Watson. Underwa-
ter digital holography for studies of marine plankton. Philosophical Transac-
tions of the Royal Society A: Mathematical, Physical and Engineering Sciences,
366(1871):1789–1806, 2008. 23

[SHPW07] Hongyue Sun, David C Hendry, Michael A Player e John Watson. In situ underwa-
ter electronic holographic camera for studies of plankton. Oceanic Engineering,
IEEE Journal of, 32(2):373–382, 2007. 1

[SJ02] Ulf Schnars e Werner PO Jüptner. Digital recording and numerical reconstruction
of holograms. Measurement science and technology, 13(9):R85, 2002. 16

[Sou81] WH Southwell. Validity of the fresnel approximation in the near field. JOSA,
71(1):7–14, 1981. 17

[SR89] AM Steane e HN Rutt. Diffraction calculations in the near field and the validity
of the fresnel approximation. JOSA A, 6(12):1809–1814, 1989. 17

[SSY98] Christian K Sieracki, Michael E Sieracki e Charles S Yentsch. An imaging-in-flow
system for automated analysis of marine microplankton. Marine Ecology Progress
Series, 168:285–296, 1998. 1

[Syp95] Maciej Sypek. Light propagation in the fresnel region. new numerical approach.
Optics communications, 116(1):43–48, 1995. 26

[TBG+05] Andrea Thelen, Jens Bongartz, Dominik Giel, Susanne Frey e Peter Hering. Ite-
rative focus detection in hologram tomography. JOSA A, 22(6):1176–1180, 2005.
57

[TFHH09] Andrea Thelen, Susanne Frey, Sven Hirsch e Peter Hering. Improvements in
shape-from-focus for holographic reconstructions with regard to focus operators,
neighborhood-size, and height value interpolation. IEEE transactions on image pro-
cessing: a publication of the IEEE Signal Processing Society, 18(1):151–157, 2009.
56, 61, 86, 87

[THM+13] Siddharth Talapatra, Jiarong Hong, Malcolm McFarland, Aditya R Nayak, Cao
Zhang, Joseph Katz, James Sullivan, Michael Twardowski, Jan Rines e Percy Do-
naghay. Characterization of biophysical interactions in the water column using in
situ digital holography. Mar. Ecol. Prog. Ser, 473:29–51, 2013. 1

[TMY78] Hideyuki Tamura, Shunji Mori e Takashi Yamawaki. Texture features correspon-
ding to visual perception. IEEE Transactions on System, Man and Cybernatic, 6,
1978. 58

[TSV+98] Xiaoou Tang, W Kenneth Stewart, Luc Vincent, HE Huang, Marty Marra, Scott M
Gallager e Cabell S Davis. Automatic plankton image recognition. Em Artificial
Intelligence for Biology and Agriculture, páginas 177–199. Springer, 1998. 1

[VDWCV11] Stefan Van Der Walt, S Chris Colbert e Gael Varoquaux. The numpy array: a
structure for efficient numerical computation. Computing in Science &amp;amp; Engineering,
13(2):22–30, 2011. 46

[VR09] David G Voelz e Michael C Roggemann. Digital simulation of scalar optical diffrac-
tion: revisiting chirp function sampling criteria and consequences. Applied optics,
48(32):6132–6142, 2009. 26, 27



110 REFERÊNCIAS BIBLIOGRÁFICAS

[YXH+12] Xiao Yu, Tang Xiahui, Peng Hao, Wang Wei et al. Wide-window angular spectrum
method for diffraction propagation in far and near field. Optics letters, 37(23):4943–
4945, 2012. 26

[YXY+12] Xiao Yu, Tang Xiahui, Qin Yingxiong, Peng Hao e Wang Wei. Band-limited angu-
lar spectrum numerical propagation method with selective scaling of observation
window size and sample number. JOSA A, 29(11):2415–2420, 2012. 26

[ZFL+13] Yancao Zhang, Qi Fan, Xinchao Li, Jianjun Shi e Baiyu Yang. Optimization of the
window function for digital hologram apodization in reconstructing the holographic
image. Journal of Optics, 15(10):105406, 2013. 33

[ZZF+09] Yancao Zhang, Jianlin Zhao, Qi Fan, Wei Zhang e Sheng Yang. Improving the
reconstruction quality with extension and apodization of the digital hologram. Ap-
plied optics, 48(16):3070–3074, 2009. 35, 40


	Lista de Abreviaturas
	Lista de Símbolos
	Lista de Figuras
	Lista de Tabelas
	Introdução
	Considerações Preliminares
	Objetivos
	Contribuições
	Organização do Trabalho

	Conceitos
	Fundamentos de Processamento Digital de Sinais
	Fundamentos de Óptica de Fourier
	Equações de Maxwell e de Helmholtz
	Método do espectro angular
	Aproximação de Fresnel


	Processamento de hologramas de plâncton
	Holografia
	Remoção de fundo
	Algoritmos de reconstrução
	Captura e propagação das frequências em holografia digital

	Detalhes de implementação
	FFT real e funções de transferência
	Sobreposição espacial
	Efeito de borda
	Amostragem

	Segmentação de região de interesse
	Reconstrução volumétrica
	Focalização

	Segmentação Final
	Outras considerações
	Custo computacional
	Processamentos adicionais


	Efeito de borda
	Introdução
	Métodos
	Zeros
	Média
	Cópia da borda
	Mediana da borda
	Reflexão
	Rampa linear
	Rampa linear circular
	Filtro gaussiano
	Filtro gaussiano iterativo
	Rampa linear com janela de Tukey
	Cópia da borda com janela Spline
	Mediana com janela de cosseno
	Minimização de frequências altas
	Minimização do Laplaciano

	Complexidade computacional
	Resultados experimentais
	Resultados


	Focalização
	Medidas de foco
	Medidas estatísticas
	Medidas com filtro espacial
	Medidas com janelas

	Complexidade computacional
	Resultados experimentais
	Resultados


	Sistema web
	Arquitetura
	Interface

	Conclusão
	Contribuições
	Trabalhos futuros

	Imagens utilizadas no experimento de extensões de borda
	Imagens utilizadas no experimento de focalização
	Referências Bibliográficas

</field>
	</doc>
</add>