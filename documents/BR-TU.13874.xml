<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.13874</field>
		<field name="filename">20003_TCC%20-%20Gabriel%20Torres%2c%20Isabella%20Faria%20e%20Walkiria%20Braga.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">GABRIEL FERNANDO BARBOSA TORRES ISABELLA DA ROCHA FARIA WALKIRIA BARBOSA SILVEIRA BRAGA
“MODELAGEM, CONTROLE E OTIMIZAÇÃO DE UM REATOR CONTÍNUO COM CINÉTICA DE VAN DE VUSSE”
GABRIEL FERNANDO BARBOSA TORRES ISABELLA DA ROCHA FARIA WALKIRIA BARBOSA SILVEIRA BRAGA
“MODELAGEM, CONTROLE E OTIMIZAÇÃO DE UM REATOR CONTÍNUO COM CINÉTICA DE VAN DE VUSSE”
Projeto Final apresentado ao Curso de Graduação em Engenharia Química, oferecido pelo departamento de Engenharia Química e de Petróleo da Escola de Engenharia da Universidade Federal Fluminense, como requisito parcial para obtenção do Grau de Bacharel em Engenharia Química.
ORIENTADORES
Prof2. Dr. Diego Martinez Praia
Prof2. Dr. Lizandro de Sousa Santos
T693 Torres, Gabriel Fernando Barbosa
Modelagem, controle e otimização de um reator contínuo com cinética de Van de Vusse / Gabriel Fernando Barbosa Torres, Isabella da Rocha Faria, Walkiria Barbosa Silveira Braga. - Niterói, RJ: [s.n.], 2016.
79	f.
Trabalho (Conclusão de Curso) - Departamento de Engenharia Química e de Petróleo - Universidade Federal Fluminense, 2016.
Orientadores: Diego Martinez Prata, Lizandro de Sousa Santos.
1.	Reator químico. 2. Simulação por computador. 3. Cinética química. I. Faria, Isabella da Rocha, n. Braga, Walkiria Barbosa Silveira. UI. Título.
CDD 660.299
GABRIEL FERNANDO BARBOSA TORRES ISABELLA DA ROCHA FARIA WALKIRIA BARBOSA SILVEIRA BRAGA
“MODELAGEM, CONTROLE E OTIMIZAÇÃO DE UM REATOR CONTÍNUO COM CINÉTICA DE VAN DE VUSSE”
Projeto Final apresentado ao Curso de Graduação em Engenharia Química, oferecido pelo departamento de Engenharia Química e de Petróleo, da Escola de Engenharia, da Universidade Federal Fluminense, como requisito parcial para obtenção do Grau de Bacharel em Engenharia Química.
Aprovado em 19 de dezembro de 2016.
BANCA EXAMINADORA

Prof8 Diego Martine/	TEQ-UFF
Presidente da Banca - Orientador
Prof8 Lizandro de Sousa Santos, D.Sc. - TEQ-UFF Orientador
Prof2 Hugo Alvarenga Oliveira, D.Sc. - TEQ-UFF
K-ít* d*'
Alexandre Sanluchi da Cunha, Eng - UFF
Vai acontecer, está acontecendo, aconteceu.
Agradecimentos
Primeiramente, agradeço aos meus pais, Maria Irenilce Martins Barbosa e Fernando Luiz Sabino Torres pela educação, preparo e suporte em todas as etapas da minha vida. Espero um dia retribuí-los em orgulho por tudo que fizeram por mim. Eu amo vocês.
Aos meus amigos: Aline Habibe, Fernanda Pimentel, Guilherme Varella, Ian Almeida, Juliana Targueta, Naienne Santana e Pedro Ricardo, vocês tomaram essa jornada de 5 anos inesquecível.
À Profa. Dra. Denise Rolão Araripe por me confiar o cargo de estagiário em seu laboratório, foi uma experiência que agregou muito para minha vida profissional e pessoal.
Aos meus professores, amigos e orientadores Prof. Dr. Diego Martinez Prata e Prof. Dr. Lizandro Santos, verdadeiros exemplos para a Universidade Federal Fluminense. Obrigado pela dedicação, atenção e o conhecimento transmitido ao longo desse trabalho.
À Renata de Araújo Trevisano por ser companheira nos momentos bons e ruins, e por me dar muita força e amparo quando precisei. Você é excepcional.
Por fim, à Walkiria Braga e Isabella Faria pelo comprometimento e empenho neste trabalho. Aprendi muito com essas gênias. Muito Obrigado.
"It’s times like these time and time again."
Foo Fighters
Gabriel Fernando Barbosa Torres
Agradecimentos
Agradeço à todos que estiveram sempre comigo, que de alguma forma contribuiram com meu desenvolvimento e crescimento pessoal ao longo desses anos.
Especialmente, aos meus pais, Zeny Rocha e Genelson Faria, por todo suporte, paciência, investimento e educação que me deram, mesmo longe estiveram sempre presentes.
À todos amigos do Dragões Cheerleading por me ensinarem que a faculdade não é apenas na sala de aula.
À todos do laboratório do Professor André Gustavo Horta Barbosa, pelo tempo em que passei sendo orientada no projeto de iniciação científica, obrigada por todo ensinamento e por despertar esse "amorzinho"por programação.
Aos meus amigos, Walkiria Braga e Gabriel Torres, não tenho palavras para descrever como me sinto completa em estar neste time, todo processo de desenvolvimento do trabalho foi complicado, mas batalhamos como guerreiros para conseguirmos atigir nossos objetivos.
À Hugo Soler, que foi meu pscicólogo particular durante esses meses que estive focada na conclusão do trabalho, ajudando sempre nas horas mais difíceis e comemorando a cada conquista.
Aos orientadores, Diego Prata e Lizandro Santos, por sempre acreditar no nosso potên-cial e pelo tempo dedicado, obrigada por todo o conhecimento repassado.
À banca examinadora deste trabalho, por terem aceito fazer parte.
"Pode ser que as trilhas nas quais cada um de vocês deve pisar já estejam diante de seus pés, embora talvez não consigam enxergá-las."
O Senhor dos Anéis
Isabella da Rocha Faria
Agradecimentos
Agradeço a todos que fizeram parte desse ciclo de aprendizado pessoal e profissional que foram os anos na Universidade Federal Fluminense. Agradeço a meus pais por todo amor e suporte ao longo desses anos e ao meu irmão, por deixar mais leve os dias pesados.
Agradeço aos meus amigos da faculdade de Química por fazer da UFF uma experiência muito maior que acadêmica. Vocês, junto ao meu amor por esta área da ciência, eram a razão para ir à universidade com um sorriso no rosto.
Obrigada aos amigos da Escola de Engenharia, que me acolheram após a mudança de curso e me fizeram sentir em casa, principalmente depois da volta do intercâmbio. Graças a vocês a engenharia se tomou mais que um curso de graduação e lembrarei desses últimos anos com muito carinho.
Agradeço também à Dra. Maria Clara Ramalho Freitas e ao Prof. Dr. Jackson A. L. C. Resende por serem mais que (des)orientadores durante os anos no laboratório; vocês foram meus mentores e modelo nesse ciclo tão importante. E alguém não poderia pedir por mentores melhores. Obrigada por tudo.
E por fim agradeço aos participantes desse trabalho, meus amigos e parceiros Isabella Faria e Gabriel Torres, que enfrentaram comigo esse monstro mitológico que a área de controle e otimização de processos; e aos nossos orientadores Prof. Dr. Diego Martínez Prata e Prof. Dr. Lizandro Santos, os mestres que já dominaram essa besta e hoje ensinam com tanto gosto jovens a enfrentá-la. Obrigada por todo apoio e dedicação à este trabalho, acho que teremos orgulho "dessa joça"nos anos que estão por vir.
"A excelência não é um ato, mas um hábito."
Aristóteles
Walkiria Barbosa Silveira Braga
Resumo
O estudo da modelagem, controle, simulação e otimização em ambientes industriais é de enorme importância no atual cenário sócio-econômico, existindo uma gama de estudos com diversos temas sobre o assunto. Alguns artigos de referência são utilizados para verificação da aplicação de novas metodologias nestes temas, sendo um deles o esquema reacional de Van de Vusse. Neste trabalho é estudado o esquema reacional de Van de Vusse em um reator CSTR aquecido através de uma jaqueta de troca térmica, sendo feita sua modelagem; simulação e otimização do estado estacionário; e simulação e controle ótimo do sistema dinâmico no caso de um único e dois setpoints, utilizando o artigo escrito por Engell e Klatt (1993) como base para validação do modelo. Os softwares EMSO e Scilab foram usados para as atividades computacionais de simulação, comparando-se também os resultados obtidos entre os dois softwares. Os resultados obtidos se mostraram satisfatórios dentro do escopo sugerido do trabalho, e, apesar da simulação dinâmica com controle otimizado utilizando 2 setpoints obter um valor 2,13% maior da concentração do produto desejado quando comparada com a simulação do estado dinâmico sem controle, considera-se o melhor resultado obtido a simulação dinâmica com controle ótimo com 1 setpoint, devido a sua estabilidade (medida através do ITAE) e aumento de 2,07% da concentração. Estes dados incentivam o uso destes softwares gratuitos e para fins acadêmicos em estudos de controle ótimo.
Palavras-chave: Van de Vusse, Controle ótimo, EMSO, Scilab.
Abstract
The study of modeling, control, simulation and optimization in industrial environments is of enormous importance in the current socio-economic scenario, and there is a range of studies with various themes on the subject. Some benchmark articles are used to verify the application of new methodologies in these subjects, one of them being the Van de Vusse reactive scheme. In this paper the Van de Vusse reactive scheme in a CSTR reactor heated through a thermal exchange jacket was studied, analysing its modeling; Simulation and steady state optimization; And simulation and optimum control of the dynamic system in the case of a single and two different set-points, using the article written by Engell e Klatt (1993) as the basis for validation of the model. The software EMSO and Scilab were used for the computational simulations, also comparing the results obtained between the two softwares. The results obtained were satisfactory within the suggested scope, and although the dynamic simulation with optimized control using 2 setpoints obtained a 2.13% higher value of the desired product concentration when compared to the dynamic state simulation without control, the dynamic simulation with optimal control with 1 setpoint is considered the best result obtained, due to its stability (measured by ITAE) and increase of 2.07% of the concentration. This results encourages the use of these free and for academic purposes softwares in studies of optimal control.
Keywords: Van de Vusse, Optimal Contol, EMSO, Scilab.
SUMARIO
AGRADECIMENTOS
RESUMO
ABSTRACT
LISTA DE FIGURAS
LISTA DE TABELAS
LISTA DE SIGLAS, SÍMBOLOS E ABREVIATURAS
1	INTRODUÇÃO	11
1.1	CONTEXTO............................................... 11
1.2	OBJETIVOS ............................................. 13
1.3	ESTRUTURA.............................................. 13
2	REVISÃO BIBLIOGRÁFICA	15
2.1	MODELAGEM MATEMÁTICA................................... 15
2.1.1	CLASSIFICAÇÃO DOS MODELOS MATEMÁTICOS............. 16
2.1.2	SIMULAÇÃO NA MODELAGEM MATEMÁTICA................. 17
2.2	CONTROLE DE PROCESSOS.................................. 19
2.2.1	TIPOS DE CONTROLADORES ........................... 20
2.2.1.1	Controlador proporcional (P).............. 20
2.2.1.2	Controlador proporcional e integral (PI) . 21
2.2.1.3	Controlador proporcional, integral e derivativo (PID) ....	22
2.2.2	SINTONIA EM CONTROLADORES PID..................... 23
2.2.2.1	Método tentativa e erro................... 24
2.2.2.2	Método de sintonia de Ziegler e Nichols. 25
2.3	OTIMIZAÇÃO DE PROCESSOS................................. 26
2.3.1	FORMULAÇÕES MATEMÁTICAS .......................... 26
2.3.2	APLICAÇÕES DE OTIMIZAÇÃO NA ENGENHARIA QUÍMICA . .	28
2.4	CONTROLE DE PROCESSOS EM REATORES....................... 29
2.4.1	ESQUEMA REACIONAL DE VAN DE VUSSE................. 30
3	METODOLOGIA	32
3.1	MODELAGEM MATEMÁTICA.................................... 32
3.1.1	BALANÇO DE MASSA.................................. 33
3.1.2	BALANÇO DE ENERGIA ............................... 34
3.2	PROGRAMAS DE SIMULAÇÃO COMPUTACIONAL.................... 35
3.2.1	SIMULADOR EMSO.................................... 36
3.2.2	SIMULADOR SCILAB.................................. 39
4	APRESENTAÇÃO DE RESULTADOS	43
4.1	SIMULAÇÃO EM ESTADO ESTACIONÁRIO........................ 43
4.2	OTIMIZAÇÃO DO MODELO ESTACIONÁRIO....................... 44
4.3	SIMULAÇÃO DO MODELO DINÂMICO............................ 46
4.4	CONTROLE ÓTIMO DO MODELO DINÂMICO....................... 48
4.4.1	CONTROLE ÓTIMO PARA UM SETPOINT FIXO.............. 48
4.4.2	CONTROLE ÓTIMO PARA DOIS SETPOINTS................ 58
5	CONCLUSÃO E SUGESTÃO PARA TRABALHOS FUTUROS	68
BIBLIOGRAFIA	70
APÊNDICE A - CÓDIGO NO SCILAB DO CONTROLE ÓTIMO PARA DOIS SET-
POINTS
72
Lista de Figuras
Figura 2.1	Representação do ciclo de simulação matemática............................. 18
Figura 2.2	Estrutura de um Controlador Proporcional................................... 21
Figura 2.3	Respostas de controladores a uma perturbação............................... 23
Figura 2.4	Esquema de reação do ciclopentadieno....................................... 31
Figura 3.1	Representação esquemática do reator de Van de Vusse........................ 32
Figura 3.2	Modelo de um reator CSTR pré-existente no simulador EMSO................... 36
Figura 3.3	Scilab em funcionamento.................................................... 39
Figura 3.4	Ambiente Xcos de diagrama de blocos e resultados gerados graficamente. 40
Figura 4.1	Gráfico da Otimização do Modelo Estacionário............................... 45
Figura 4.2	Gráfico da Simulação do Modelo Dinâmico.................................... 46
Figura 4.3	Gráfico do Controle do Modelo Dinâmico..................................... 47
Figura 4.4	Gráfico Controle Ótimo para	1	setpoint - Tentativa e Erro................. 49
Figura 4.5	Gráfico Controle Ótimo com	1	setpoint - Temperatura - Tentativa e Erro.	52
Figura 4.6 Gráfico Controle Ótimo para 1 set-point - Concentração - Tentativa e Erro. 53
Figura 4.7	Gráfico Controle Ótimo para	1	setpoint - Ziegler Nichols.................. 53
Figura 4.8	Gráfico Controle Ótimo para	1	setpoint - Temperatura - Ziegler Nichols.	57
Figura 4.9	Gráfico Controle Ótimo para	1	setpoint - Concentração - Ziegler Nichols.	57
Figura 4.10	Gráfico Controle Ótimo para 2 setpoints	- Tentativa e Erro................ 58
Figura 4.11	Gráfico Controle Ótimo para 2 setpoints	- Temperatura Tentativa e Erro.	61
Figura 4.12	Gráfico Controle Ótimo para 2	setpoints	- Concentração - Tentativa e Erro.	62
Figura 4.13	Gráfico Controle Ótimo para 2 setpoints	- Ziegler Nichols................. 63
Figura 4.14	Gráfico Controle Ótimo para 2 setpoints	- Temperatura - Ziegler Nichols.	66
Figura 4.15	Gráfico Controle Ótimo para 2 setpoints	- Concentração - Ziegler Nichols.	66
Lista de Tabelas
Tabela 2.1	Sintonia Segundo Ziegler e Nichols.................................... 25
Tabela 2.2	Tipos de problemas de otimização em engenharia química................ 29
Tabela 3.1	Atividades realizadas nos simuladores EMSO e Scilab................... 35
Tabela 3.2	Parâmetros utilizados nas simulações matemáticas no EMSO.............. 37
Tabela 3.3	Condições iniciais utilizadas na simulação do estado estacionário. ...	37
Tabela 4.1	Comparação dos dados obtidos no Modelo Estacionário................... 43
Tabela 4.2	Erros	Percentuais Scilab x Engell e Klatt............................ 44
Tabela 4.3	Erros	Percentuais EMSO x Engell e Klatt.............................. 44
Tabela 4.4	Erros	Percentuais EMSO x Scilab...................................... 44
Tabela 4.5 Comparativo de Cb: Modelo Estacionário x Modelo Estacionário Otimizado....................................................................... 46
Tabela 4.6 Parâmetros de Sintonização de Controle Ótimo do Modelo Dinâmico. .	48
Tabela 4.7	Controle	Ótimo para 1 set-point - Resultados - Tentativa e Erro....... 49
Tabela 4.8	Controle	Ótimo para 1 set-point - Resultados - Ziegler Nichols....... 54
Tabela 4.9	Controle	Ótimo para 2 setpoints - Resultados - Tentativa e Erro....... 59
Tabela 4.10	Controle	Ótimo para 2 setpoints - Resultados - Ziegler Nichols....... 63
Tabela 4.11 Sumário dos resultados do trabalho.................................... 67
LISTA DE SIGLAS, SIMBOLOS E ABREVIATURAS
p	Densidade
To	Tempo Derivativo
	Tempo Integral
Ar Q	Área do Reator Concentração do Composto i
QS	Concentração do Composto i no Estado Estacionário
cp	Capacidade Calorífica
e	Erro da Variável Controlada
Ei Fi	Energia de Ativação da Reação i Vazão Volumétrica de Entrada
h hi ki	Altura do Reator Entalpia da Reação i Constante Cinética da Reação i
Kp	Ganho do Controlador
kw	Coeficiente de Transferência de Calor da Jaqueta de Resfrimento
Q	Taxa de Calor
T	Temperatura do Reator
Tk	Temperatura da Jaqueta
Ts Temperatura do Reator no Estado Estacionário
Tset Temperatura de setpoint do Controlador
u Sinal de Saída do Controlador
uq Estado Inicial do Atuador
V Volume do Reator
CSTR Continuous Stirred Tank Reactor
EDO Equação Diferencial Ordinária
EDP Equação diferencial Parcial
ITAE Integral of time-weighted absolute error
LP Linear Problems
MILP Mix Integer Linear Problem
MINLP Mix Integer Non Linear Problem
NLP Non Linear Problems
PER Plug Flow Reactor
Capítulo 1
INTRODUÇÃO
1.1	CONTEXTO
A competitividade industrial se tomou tópico imprescindível na discussão sobre o cenário econômico atual, fazendo-se necessário o foco em tempo de produção e margem de lucro maiores que antes vistos. Como consequência, unidades de processo operam em seu limite de segurança e são sujeitas a diferentes mudanças operacionais, feitas com objetivo de se adequar a demandas específicas para produção de um produto requisitado. Uma complicação adicional é a dificuldade de operação de uma planta industrial decorrente da integração cada vez maior e mais complexa dos processos, sendo no mínimo trabalhoso evitar que distúrbios não se propaguem entre as unidades interligadas (SEBORG et al., 2010).
Este comportamento enfático em segurança e eficiência fez com que o interesse no estudo de controle de processos e operação de plantas de forma otimizada e computadorizada aumentasse demasiadamente ao longo dos anos. Sem o controle das unidades através de computadores, seria inexecutável operar plantas modernas de maneira rentável e segura sem negligenciar a qualidade do produto ou normas ambientais, que são gradativamente mais restritas.
Contudo, diversos processos de grande interesse industrial são difíceis de ser controlados devido ao seu comportamento fortemente não linear e à falta de medições (ANTONELLI e ASTOLFI, 2003). Problemas não lineares são geralmente encontrados em processos e engenharia: elétrica, química, petroquímica e nuclear. O controle de processos químicos tem certas características distintas que os diferem das outras categorias. A natureza dos modelos matemáticos para a dinâmica desses processos é extremamente complexa, porém os princípios gerais de conservação, fenômenos de transporte, cinética e equilíbrio fazem possível a generalização e simplificação do problema. As variáveis de controle são limitadas e as condições de controle frequentemente estão sujeitas a "restrições de desigualdade, não-linearidades e estrangulamen-
tos"(STEPHANOPOULOS et al., 1984).
Tradicionalmente, processos químicos são controlados por meio da análise de sistemas lineares e ferramentas de design juntamente a modelos linearizados, ou então métodos não-lineares baseados em técnicas de linearização. Contudo, o uso de técnicas lineares é bastante limitado se o processo químico analisado é fortemente não-linear, uma vez que o projeto de controle não-linear necessita, em geral, de um número extenso de informações acerca do processo. Atualmente são usados para controle de reatores, entre outros, controladores Proporcional-Integral-Derivativo (PID), linearização Feedback, establização global por Feedback de estado e técnicas de linearização adaptáveis baseadas na teoria de estabilidade de Lyapunov (ANTO-NELLI e ASTOLFI, 2003).
Um caso interessante industrialmente, no ponto de vista de controle, é da reação de Van de Vusse em um tanque continuamente agitado - CSTR (acrônimo em inglês para continuous stirred tank reactor) com resfriamento, pois possui comportamento não-linear e diversas configurações de controle possíveis. Além disso, esse esquema reacional tem sido usado como um problema de referência para algoritmos de controle de processo não-linear (MAGALHÃES, 2010).
Diante dos avanços tecnológicos e com o aumento da disponibilidade de sofisticados computadores a baixo custo, as simulações computacionais de processos ficaram mais acessíveis e tiveram um considerável aumento em sua utilização. A simulação computacional tem se tomado uma poderosa ferramenta de engenharia, possuindo aplicação em uma vasta gama de problemas, tais como: dimensionamento de equipamentos, estimativa de custos, melhorias na sintonia de malhas de controle, desenvolvimento de novas estratégias de controle na otimização dos processos, desenvolvimento de ecoindicadores, dentre tantas outras (PRATA, 2013).
Portanto, com o aumento da demanda e a grande necessidade de tomar as simulações mais aplicadas e sua utilização mais eficiente, pacotes computacionais foram e estão sendo desenvolvidos, tais como: Matlab®, Scilab®, Aspen/HYSYS®, PRO/II®, EMSO, gPROMS®, SpeedUP® e CAPE-COCO®. Essas ferramentas tomam práticas e rápidas simulações complexas, já que possuem uma gama variada de modelos matemáticos e bancos de dados termodinâmicos, permitindo sua utilização de formas variadas e muitas vezes combinadas (PRATA, 2013).
1.2	OBJETIVOS
O objetivo deste trabalho é implementar a modelagem dinâmica do reator de Van de Vusse e estudar procedimentos para controle ótimo objetivando maximizar seu desempenho e comparar com configurações tradicionais.
O presente trabalho possui, ainda, os seguintes objetivos específicos:
•	Modelagem matemática para a descrição da dinâmica do processo envolvendo cinética de Van de Vusse;
•	Reprodução dos estados estacionário e dinâmico via simulação computacional utilizando os softwares EMSO e Scilab;
•	Aplicar um sistema de controle Feedback na variável temperatura no reator utilizando os software EMSO e Scilab;
•	Aplicar o controle otimizado na variável temperatura do reator utilizando o software Scilab.
1.3	ESTRUTURA
Além desta introdução, que apresenta a contextualização, motivação, softwares computacionais para aplicações de estratégia de controle, reator e sistema reacional e os objetivos, este trabalho de conclusão de curso está organizado como descrito a seguir.
•	Capítulo 2: é realizada uma revisão bibliográfica sobre modelagem, simulação e controle de processos e otimização. Especificamente, são revisados os principais trabalhos em reatores com esquema reacional de Van De Vusse. São, também, apresentadas a importância da simulação computacional para fins de aplicação em controle e especificamente na produção de ciclopentenol a partir do ciclopentadieno.
•	Capítulo 3: é apresentado em detalhes a modelagem matemática, os parâmetros rea-cionais as variáveis a serem controladas e as condições operacionais do reator.
•	Capítulo 4: são apresentados e discutidos os resultados para a implementação da estratégia de controle.
• Capítulo 5: é apresentada a conclusão do trabalho, bem como sugestões para trabalhos futuros.
Finalmente, são apresentadas as referencias bibliográficas consultadas e citadas durante o trabalho.
Este trabalho foi desenvolvido durante a Graduação do Departamento de Engenharia Química e de Petróleo da Universidade Federal Fluminense e está inserido nas linhas gerais de modelagem, simulação, controle e otimização de processos.
Capítulo 2
REVISÃO BIBLIOGRÁFICA
Neste capítulo é realizada uma revisão bibliográfica sobre modelagem e a importância da simulação computacional na resolução de seus sistemas de equações resultantes.
Diferentes tipos de controladores são apresentados, com foco no controlador do tipo Proporcional, Integral e Derivativo (PID), assim como são abordados métodos de sintoma nestes tipos de controladores. O tópico de otimização de processos também é apresentado no capítulo.
E por fim, expõe-se brevemente o esquema reacional de Van de Vusse e os principais trabalhos sobre o assunto em reatores contínuos.
2.1	MODELAGEM MATEMÁTICA
É de conhecimento comum que nos últimos anos os pré-requisitos de desempenho de plantas de processamento ou industriais estão surpreendentemente elevados, sendo os critérios de qualidade e controle de produção cada vez mais rígidos. Com o passar do tempo, os processos se tomaram complexos e integrados, tomando a operação de tais plantas uma tarefa exigente e laboriosa, assim como o desenvolvimento de modelos matemáticos dinâmicos que permitem a descrição das unidades interconectadas presentes na planta química. Somado a isso, modelos matemáticos também podem ser utilizados como base para o projeto de diversos algoritmos de controle de processos.
Conceitualmente, um modelo é uma representação matemática de um sistema físico, químico, biológico ou de informações que permite a racionalização do sistema analisado e a predição de comportamentos frente à modificações de suas condições operacionais ou parâmetros. O modelo a ser escolhido é uma representação aproximada, podendo existir múltiplos
Dessa maneira, o modelo pode não incorporar todas as características — macroscópicas e microscópicas — do processo real. Usualmente busca-se um compromisso entre o custo da fabricação do modelo, isto é, o tempo e o esforço requeridos para obtê-lo e verificá-lo, e o seu detalhamento, bem como os benefícios esperados de sua aplicação. O propósito do modelo determina, em última análise, sua precisão.
2.1.1	CLASSIFICAÇÃO DOS MODELOS MATEMÁTICOS
Existem diversas classificações para os modelos matemáticos, porém se destaca no estudo de sistemas dinâmicos a classificação quanto à linearidade. Modelos lineares são em sua natureza mais simples que os não-lineares, de mais fácil obtenção e implementação. Somado a esta simplicidade, o fato da teoria para projeto de algoritmos de controle baseada neste tipo de modelagem ser melhor estabelecida e levar, na maioria dos casos, a malhas de controle também lineares cujos métodos de análise de desempenho e estabilidade são bem conhecidos e fundamentados (AGUIRRE et al., 2007), toma este tipo de modelo mais atrativo.
Contudo, poucas são as situações reais em que os modelos lineares descrevem precisamente os fenômenos estudados, principalmente devido à complexidade das dinâmicas envolvidas ou pelo alto grau de descrição requerido em uma extensa faixa de operação do sistema, o que seria somente descrito com êxito através de modelos não-lineares. A representação de tais sistemas reais através de modelos lineares demandaria uma quantidade considerável de aproximações e restrições para sua correta utilização, o que poderia, em certo grau, encurtar a validade do modelo.
A metodologia da construção de modelos dinâmicos, por sua vez, está classificada basicamente entre duas abordagens diferentes: a chamada caixa branca, também conhecida como modelagem fenomenológica ou modelagem conceituai (AGUIRRE, 2004), que se baseia na construção de um modelo a partir das propriedades físicas e químicas do sistema estudado, usando regularmente balanço de massa e energia; e a caixa preta, na qual o modelo é construído utilizando uma estrutura genérica e parâmetros obtidos experimentalmente, sendo a integração entre os parâmetros do modelo e a física do sistema não trivial (AGUIRRE et al., 2007). Si-
Outra importante classificação é a dependência no tempo. Um modelo no estado estacionário descreve um modelo independente desta variável, assumindo que a planta alcançou um patamar estável de operação, enquanto o modelo dinâmico leva em consideração a constante mudança do sistema ao longo do tempo. Estas considerações influenciarão diretamente a complexidade do modelo matemático que descreverá o sistema e o método a ser utilizado para sua resolução, a modelagem no estado estacionário resulta em sistemas de equações algébricas; e o dinâmico é descrito por um sistema de equações diferenciais ordinárias (EDOs).
Além destas, se faz também necessária a investigação de outras relações pertinentes a variação espacial. Esta classificação leva em consideração a variação das variáveis em relação a distribuição espacial e a geometria do sistema, podendo ser separado em parâmetros distribuídos e parâmetros concentrados. Por razões de simplificação, considera-se que no modelo concentrado todo o sistema tem parâmetros semelhantes independentemente da localização do ponto de estudo, podendo ser representado então por um único ponto. Esta hipótese é válida para diminuir a complexidade matemática e representar até certo grau sistemas muito bem agitados, porém a representação fiel de um sistema real é feita considerando a variação dos parâmetros com a variação espacial, o que toma o sistema matematicamente muito complexo com a formação de um sistema de equações diferenciais parciais (EDPs), sendo resolvidos somente com a utilização de computadores.
A classificação da modelagem também pode ser feita a partir do modo de operação (sistemas contínuos ou batelada} e do tipo de amostragem em relação ao tempo (contínuo e discreto), além de outras classificações, como modelos monovariáveis e multivariáveis, paramétricos e não paramétricos, entre outros, que podem enriquecer e tomar mais complexa a modelagem, e consequentemente a dificuldade de resolução.
2.1.2	SIMULAÇÃO NA MODELAGEM MATEMÁTICA
Muitas vezes os sistemas de equações gerados através da modelagem matemática são complexos demais para resolução tradicional, sendo de extrema necessidade o uso de computadores para resolver os sistemas de equações resultantes do estudo do estado estacionário; e para
As razões para o uso da simulação são variadas e abrangem do projeto de novas unidades (projeto de processos), a otimização de plantas já existentes e controle do ponto de operação em vista a possíveis perturbações, resultando melhor compreensão do processo em si, além de sua verificação.
Na simulação por via matemática utiliza-se o modelo matemático que descreve o processo analisado e, com as informações necessárias (parâmetros das equações) e métodos numéricos diversificados para resolução das equações do modelo, um resultado é alcançado e então revisto e analisado até que seja aceitável, fechando o ciclo representado na Figura 2.1:
Figura 2.1 - Representação do ciclo de simulação matemática.
Fonte: Pereira (2014)
Uma das mais importantes decisões é a escolha do método numérico a ser aplicado para resolver o modelo. Existem diversos métodos já solidificados descritos na literatura para resolução de sistemas de equações não lineares, como os métodos de Newton-Rapshon e o da Bisseção (LAGE e PINTO, 2001); e para resolução de sistemas de equações diferencias ordinárias, como os métodos de Adams, de Euler, Runge-Kutta e Backward Differentiation Formula (SCILAB ENTERPRISES, 2012).
Estes métodos podem ser executados por meio de simuladores que podem ser modulares, onde o cálculo dos equipamentos é executado de forma sequencial - como o aspenONE® da Aspentech e Unisim® da Honeywell-, e simuladores orientados por equações, onde os modelos podem ser visualizados e usados para várias tarefas como a própria simulação e a otimização. Exemplos destes tipos de simuladores e que serão utilizados neste trabalho são os softwares
2.2	CONTROLE DE PROCESSOS
Antes de abordar sobre os controladores em si, toma-se necessário definir a nomenclatura básica para o entendimento de controle de processos. Alguns termos são:
•	Setpoint: É o valor desejado para a variável controlada. É por meio desse valor e o valor da variável controlada medida no processo que são feitos os cálculos para as decisões do controlador;
•	Variável Controlada: É a variável que se deseja obter um valor desejado para o processo. É ela que deve possuir um desvio mínimo em relação ao set-point;
•	Variável Manipulada: É a variável na qual se atua para manter a variável controlada no valor desejdo;
•	Atuador: Também chamado de elemento final de controle, é o instrumento que manipula a variável manipulada;
•	Controle Manual: Também conhecido como controle de malha aberta, não possui a ação do controlador, tendo a necessidade de um operador para tomar as decisões do que o atuador fará com a variável manipulada a fim de controlar a variável controlada;
•	Controle de Malha Fechada: Também é conhecido como controle feedback ou de re-alimentação, e possui o controlador que, por meio do erro entre a variável controlada medida no processo e o set-point envia o sinal para o atuador. Por não precisar de operador no atuador, o controle em malha-fechada é considerado mais seguro.
Definidos esses termos, pode-se então claramente concluir que o objetivo do controle é manter a variável controlada no valor desejado, por meio da manipulação do atuador na variável manipulada, tanto em malha aberta quanto em malha fechada (SMITH e CORRIPIO, 1985).
Quando se é abordado sobre controle automático de processos e seus dispositivos, tende-se a pensar em algo moderno. Todavia, já eram projetados sistemas de controle feedback pelos Gregos por volta de 250 A.C. e seu modo de funcionamento era semelhante ao controle de
O controlador PID é o mais popular na indústria. O ajuste simples de seus parámetros para se obter um bom desempenho e seu algoritmo estar presente em quase todos os equipamentos de controle na indústria é a razão principal de sua popularidade. No algoritmo desse controlador é calculada a diferença entre a variável controlada (medida no processo) e o valor em que se deseja colocá-la (setpoint) e, um sinal de controle é gerado a fim de diminuir o desvio encontrado. Para o envio de sinal para o atuador (elemento final de controle) o algoritmo PID usa o desvio entre as variáveis em três módulos distintos: O termo proporcional (P), o integral (I), e o derivativo (D) (CAMPOS e TEIXEIRA, 2006).
2.2.1	TIPOS DE CONTROLADORES
Os controladores típicos de processos são baseados na forma de operação da variável erro, são elas: Ação Proporcional, Ação Integral e Ação Derivativa
2.2.1.1	Controlador proporcional (P)
O controlador P é o controlador cujo sinal de saída é calculado de forma proporcional em função do erro. O algoritmo do controlador P é apresentado na Equação (2.1):
u(t) = Kp x e(f) + uq	(2.1)
Na Equação (2.1), o fator Kp é o ganho do controlador (sensibilidade), u(t) é o sinal de saída, ou seja, a ação de controle proporcional, e e(f) é o erro. Posteriormente esse sinal será enviado a um atuador (ex: Válvula) e o colocará em um valor diferente do estado inicial (uq), onde tal ação (fechar ou abrir) dependerá da magnitude do erro encontrado.
A estrutura de um controlador Proporcional é ilustrada na Figura 2.2:
Figura 2.2 - Estrutura de um Controlador Proporcional.
Fonte: Campos e Teixeira (2006)
Na Figura 2.2, SP representa o valor do setpoint, PV representa a variável controlada, e Kv representa a ação proporcional no atuador
A medida de ganho representa o quanto o controlador irá comandar o atuador para uma mesma medida de erro, por isso este representa a sensibilidade. Logo, quanto maior o ganho, mais ação o controlador irá emitir em sinal para um valor de erro (CAMPOS e TEIXEIRA, 2006).
O controlador proporcional é utilizado quando se é admitido tolerar erros no estado estacionário (offset), isto é, quando há uma variação no SP, existe um desvio constante entre o seu valor e o valor de equilíbrio da variável controlada disponibilizada pelo controlador (SEBORG et al., 2010). A simplicidade do controlador proporcional é o seu maior atrativo, mas como existe o revés do desvio em regime permanente, sua aplicação prática fica restrita a controle de nível, onde pequenos desvios do setpoint não contribuiriam para que um tanque transbordasse, por exemplo (LUYBEN, 1989).
2.2.1.2	Controlador proporcional e integral (PI)
O controlador proporcional e integral calcula sua saída proporcionalmente ao erro e proporcionalmente à integral do erro através da Equação (2.2):
(2.2)
Na Equação (2.2), o termo Ti é conhecido como tempo integral, e o fator multiplicativo — é chamado de ganho integral do controlador, podendo ser chamado também de número de "ti repetições por unidade de tempo (CAMPOS e TEIXEIRA, 2006).
A ação proporcional ocorre imediatamente assim que um erro é encontrado, e a ação
integral é responsável pela eliminação do offset presente após a ação proporcional, visto que para que o processo esteja controlado e não haja desvio em estado estacionário, o valor de u(t) deve ser constante e tal condição se completa quando e(t) = 0 de acordo com a Equação 2.2 (SEBORG et al., 2010). Logo, pode-se concluir que a ação integral faz com que o controlador repita a ação proporcional de Ti em Ti unidades de tempo até que o desvio em regime permanente seja igual a zero, mesmo que haja a saturação do atuador. Essa saturação significa que o controlador pode continuar enviando o sinal para o atuador mesmo que ele esteja operando em seu máximo ou seu mínimo, pois a ação integral não deixa haver diferenças (CAMPOS e TEIXEIRA, 2006).
Uma desvantagem intrínseca desse algoritmo é a possibilidade de ocorrência de oscilações. Essas oscilações podem comprometer a estabilidade do sistema de controle, sendo necessário uma boa sintonia do controlador, como também a introdução do modo derivativo (SEBORG et al., 2010).
2.2.1.3	Controlador proporcional, integral e derivativo (PID)
O controlador proporcional, integral e derivativo calcula sua saída proporcionalmente à derivada do erro além dos dois modos supracitados. O algorítimo do controlador PID é apresentada na Equação (2.3):
(2.3)
Na Equação (2.3), o termo Tp é chamado de tempo derivativo do controlador.
A ação derivativa é normalmente usada no sinal da variável controlada medida no processo e posteriormente a ação proporcional e integral são tomadas, contudo ação derivativa também pode ser usada no desvio (LUYBEN, 1989).
Por meio da razão de mudança do erro, a ação derivativa tem como função corrigir antecipadamente seu comportamento. É importante notar que se o controlador possuísse apenas o modo derivativo (isto é, sem as duas primeiras parcelas da Equação (2.3), o controle seria
apenas alcançado quando e(t) fosse constante, o que significa v 7 = 0. Logo, a ação derivativa
dt
sempre estará acompanhada de uma ação proporcional, ou de uma ação proporcional e integral conjunta (SEBORG et al., 2010).
Portanto, a tendência de aumento ou diminuição do erro é estimada pelo modo derivativo, com objetivo de eliminar esse erro previsto atuando na saída do controlador. A ação derivativa em processos lentos tem o papel de reduzir as oscilações possíveis no sistema de controle do processo (SEBORG et al., 2010).
Figura 2.3 - Respostas de controladores a uma perturbação.
TiT
ri
PD
PID
p
Fonte: Seborg et al. (2010)
Controladores do tipo PID são usados na maioria das vezes quando o sinal não possui muito ruído e uma resposta dinâmica precisa é almejada. O controlador PID é designado para controlar a temperatura em reatores químicos (LUYBEN, 1989).
A Figura 2.3 apresenta as respostas dos controladores para perturbações no processo.
2.2.2	SINTONIA EM CONTROLADORES PID
A sintonização consiste em ajustar os parâmetros do controlador de realimentação para obter-se uma resposta específica em malha fechada. Para cada tipo de processo e malha de controle a sintonia terá sua devida complexidade associada. Pode-se esperar, por exemplo, que sintonizar um controlador proporcional é mais simples do que sintonizar um controlador Pro-
Além disso, o principal objetivo de sintonizar um controlador é manter a estabilidade da malha de controle, isto é, sintonizar o controlador levando em conta além do processo, toda a instrumentação incluida na malha (transmissores, conversores, medidores etc) (CAMPOS e TEIXEIRA, 2006).
Apesar de existirem muitos métodos para sintonizar um controlador em malha fechada, grande parte ainda é sintonizada por instrumentos mecânicos e a sintonia dos parâmetros por essa via é satisfatória (LUYBEN, 1989).
Um dos métodos pioneiros para sintonia de controladores em malha-fechada, é o método de tentativa e erro. Além desse método, o método de Ziegler Nichols (ZIEGLER e NI-CHOLS,1942) é considerado padrão também para controladores em malha fechada.
2.2.2.1	Método tentativa e erro
O método tentativa e erro é um procedimento prático que consiste nos seguintes passos:
i	Retirar toda ação integral e derivativa do controlador (tomar T/ —&gt;&amp;lt;» e To —&gt; 0), isto é, colocá-lo no modo manual;
ii	Configurar um valor de Kc baixo;
iii	Colocar o controlador no automático;
iv	Alterar em um pequeno valor o setpoint e avaliar a resposta da variável controlada. Como o ganho é baixo, a resposta será lenta;
v	Dobrar o ganho e fazer uma nova alteração no setpoinf,
vi	Repetir o passo 5 até obter uma resposta subamortecida e oscilatoria. Nesse o ponto o ganho atinge o valor que é conhecido como Ganho Final ou Ganho Último;
vii	Começar a diminuir T/ em intervalos constantes e a cada diminuição, fazer uma perturbação;
ix	Começar a aumentar o valor de Td, fazendo com que se comece a atuar a ação derivativa. Esse valor deverá ser tal que consiga atingir um controle bem preciso, mas sem que ocorra o aumento no ruído de medida da variável controlada;
x	A partir desse ponto, aumentar o valor de Kc até se conseguir um controle com um overshoot em um valor desejado previamente.
2.2.2.2	Método de sintonia de Ziegler e Nichols
O método de sintonia de Ziegler e Nichols é considerado padrão ao tratar-se de sistemas de controle. Esse método possui pouca complexidade e fornece ótimos desempenhos, e em alguns casos, estimativas para a configurações do controlador (LUYBEN, 1989).
As características dinâmicas do processo são determinadas por meio do chamado ganho último e do Período de oscilação da malha. Esses parâmetros são obtidos experimentalmente por meio do método a partir do processo real (SMITH e CORRIPIO, 1985).
Para sintonizar o controlador com o método de Ziegler e Nichols, deve-se aumentar gradativamente o ganho proporcional até que ocorra uma resposta com amplitude constante de oscilatória. Após esse procedimento, tem-se o valor do ganho último (Ku) e do Período de oscilação (Pu). Ambos os parâmetros são obtidos no limite da estabilidade com oscilações na variável controlada. Obtidos os referidos valores, utiliza-se a Tabela 2.1 para se determinar os parâmetros do controlador PID (CAMPOS e TEIXEIRA, 2006):
Tabela 2.1 - Sintonia Segundo Ziegler e Nichols.
Controlador	KP		
P	0.5 x Ku	-	-
PI	0.45 x Ku	Pu/2	-
PID	0.6 x Ku	Pu/2	Pu/*
Outros métodos de sintonia podem ser encontradas nos livros clássicos de controle de processos (SEBORG etal., 2010; LUYBEN, 1989).
Para avaliar a sintonia executada em um sistema de controle, é utilizado um índice de desempenho. Os índices mais conhecidos são ISE (Integral dos erros ao quadrado, IAE (Integral
O ITAE, por ser menos sensível aos erros logo após a perturbação, é mais vantajoso que o IAE. O índice ITAE é calculado por meio da Equação (2.4)
ITAE-
(2.4)
Na Equação (2.4), a integral de uma função do erro dentro de uma janela de tempo suficiente para eliminar desvios no estado estacionário, é utilizada como critério. Isso permite considerar toda a curva de resposta do processo (CAMPOS e TEIXEIRA, 2006).
2.3	OTIMIZAÇÃO DE PROCESSOS
Problemas de otimização podem ser encontrados no projeto, construção, operação e análise de plantas químicas. Na definição feita por Thomas et al. (2001):
Otimização é o uso de métodos específicos para determinar a solução mais efetiva em termos de custos e eficiente para um problema ou projeto de um processo. Esta técnica é uma das maiores ferramentas qualitativas para tomada de decisões industriais.
Em termos gerais, a otimização é a junção de resultados matemáticos com métodos nú-mericos a fim de se identificar a melhor solução dentre um conjunto de soluções, sem explicitar ou avaliar todas elas. E este processo, se visto por outro ângulo, é basicamente a descrição da raiz da engenharia como um todo, uma vez que a clássica função de um engenheiro é projetar sistemas novos, melhores, mais eficientes e menos custosos, assim como avaliar planos e procedimentos para melhor operação de sistemas existentes (RAVINDRAN et al., 2006).
2.3.1	FORMULAÇÕES MATEMÁTICAS
Sendo os problemas de otimização de cunho matemático, é fundamental citar algumas
definições e termos para melhor compreensão do algoritmo:
•	Função Objetivo: Função de uma ou mais variáveis de decisão que se quer otimizar, minimizando-a ou maximizando-a. Essa poderá ser o custo do sistema, rendimento, lucro, etc. Basicamente sua estrutura divide-se em convexa e não convexa, no caso de problemas de minima. Essa última necessita de métodos de otimização mais complexos, chamados de busca global.
•	Restrições: Um modelo que descreva o comportamento do sistema é necessário e, para problemas de otimização, isso significa uma série de equações e desigualdades restritivas. Essas restrições contêm uma região factível que define os limites de performance para o sistema. O modelo deve ser descrito em função das variáveis de decisão.
•	Variáveis de decisão: Variáveis que aparecem no modelo do sistema e que devem ser ajustadas para satisfazer o modelo restritivo. Isso pode ser normalmente alcançado com uma variação dos valores das variáveis, conduzindo o sistema a uma região factível que é determinada por um subespaço destas variáveis. Em problemas de engenharia, esse subsespaço pode ser caracterizado por um conjunto de variáveis de decisão que podem ser interpretadas como grau de liberdade no processo (BIEGLER, 2010).
•	Ponto Ótimo: Ponto formado pelas variáveis de projeto que extremizam a função objetivo e satisfazem as restrições, dadas as tolerâncias numéricas desejadas (para a função objetivo e para as restrições).
•	Valor Ótimo: Valor da função objetivo no ponto ótimo.
Os modelos matemáticos de otimização levam a categorias diferentes de problemas estruturados, podendo ser divididos principalmente em relação a variáveis contínuas ou discretas. Os problemas de programação linear (problemas LP) são descritos quando a função objetivo e as restrições do modelo são lineares e as variáveis de otimização são contínuas. Se algumas variáveis de decisão são inteiras e a função objetivo e restrições são lineares, o problema é chamado de programação linear inteira mista (problemas MILP). Caso alguma restrição ou a função objetivo seja não linear e as variáveis sejam contínuas, trata-se de um problema de programação não-linear (problemas NLP). E por fim, em casos não-lineares com variáveis inteiras, é formulado um modelo através de problemas de programação não-linear inteira mista (problema MINLP) (CORSANO et al., 2008).
Diversos autores contribuíram ao longo dos anos com algoritmos e formulações para modelagem matemática de processos de otimização, sendo de maneira geral a concepção feita sob medida para o problema, contexto ou alternativa estrutural em que o autor lidava - abrangendo a maioria das alternativas relevantes de problemas operacionais e projeto de processos, principalmente em batelada.
Porém, essa especialidade na formulação de problemas fez com que o progresso no decorrer das décadas de estudo não fosse feito de maneira a formular modelagens intrinsecamente gerais, a incluir quaisquer e todas as possibilidades ou ao menos um conjunto significativo de alternativa e decisões. Parte disso se deve à notável dificuldade envolvida na resolução de problemas simultâneos, tendo, como consequência, grande parte das formulações e modelos existentes não permitirem considerar e selecionar todas as estruturas e alternativas possíveis simultaneamente (CORSANO et al., 2008).
2.3.2	APLICAÇÕES DE OTIMIZAÇÃO NA ENGENHARIA QUÍMICA
A otimização encontrou muitas aplicações dentro do ramo químico da engenharia, em especial na engenharia de processos. Problemas desta área geralmente tem muitas soluções com interações complexas no âmbito econômico e de performace, sendo então a tarefa de identificar a solução ótima através do raciocínio intuitivo muito mais complexa do que o esperado (BIE-GLER, 2010). Somado a isso, uma das maneiras da indústria química se manter competitiva é por meio do estudo econômico de seus processos. Como a solução ótima do sistema pode indicar a diminuição de seu custeamento, a otimização de processos se tomou parte integrante de um projeto em engenharia química.
Além do custeamento, problemas de otimização são encontrados na modelagem e desenvolvimento de processos, síntese e projeto e finalmente operação, controle, agendamento e planejamento. A Tabela 2.2 apresenta os tipos de modelos aplicados em cada área da engenharia química.
O projeto tende a ter modelos não-lineares devido a necessidade de lidar com equações de performace, contudo modelos mais simplistas podem ser construídos, resultando em problemas lineares. É importante notar também que problemas NLP representam grande importância em otimização em tempo real. Problemas de operação, por sua vez, tendem a ser dominados por
Tabela 2.2 - Tipos de problemas de otimização em engenharia química.
Tipo do processo	LP	MILP	NLP	MINLP
Construção do modelo do processo			X	X
Projeto do processo				
Trocadores de calor	X	X	X	X
Operação de transferência de massa	X	X	X	X
Separadores		X	X	X
Reatores	X		X	X
Flowsheeting			X	X
Operações				
Agendamento	X		X	X
Distribuição	X		X	X
Otimização em tempo real	X		X	
Controle de processos
Modelo de controle preditivo linear	X
Modelo de controle preditivo não-linear	X
Modelo de controle preditivo híbrido	X
Fonte: Biegler (2010).
modelos lineares, assim como problemas de planejamento, agendamento e distribuição. Controle de processos tem tradicionalmente modelagem com variáveis contínuas, logo resultam em problemas de programação linear e não-linear, apesar de que o uso de variáveis discretas e sistemas de equações lineares têm sido usadas em sistemas híbridos (BIEGLER, 2010).
2.4	CONTROLE DE PROCESSOS EM REATORES
A implementação de malhas de controle é fundamental por medidas econômicas e de segurança, sendo malhas cada vez mais complexas encontradas nas modernas plantas industriais. Por ser uma área de grande importância na indústria, uma vasta gama de estudos diferentes sobre o assunto podem ser encontrados, como o estudo do controle em reatores catalíticos de leito fixo (SALAU, 2004); controle de temperatura em reatores de polimerização em fase gasosa (TOLEDO, 1999) e controle de reatores com multiplicidade de equilíbrio (DIEHL, 2009).
Neste trabalho será estudado especificamente o controle em um reator contínuo com esquema reacional de Van de Vusse.
2.4.1	ESQUEMA REACIONAL DE VAN DE VUSSE
No artigo "Plug-flow type reactor versus tank reactor" (VUSSE, 1964) o autor compara o reator com escoamento pistonado ideal (Plug-Flow Reactor, PFR), indicado se o produto desejado é passível à degradação como resultados de reações consecutivas, com o reator tanque continuamente agitado (Continuous Stirred Tank Reactor, CSTR), indicado quando desejados elevadas seletividades no caso de sistemas de reações paralelas de maiores ordens.
Porém, segundo o autor, a escolha do tipo de reator se toma uma tarefa mais complexa se ambas reações consecutivas e paralelas de maior ordem ocorrem simultaneamente no mesmo esquema reacional. A Equação 2.5 apresenta o exemplo mais simples deste tipo de combinação e que se tomaria conhecido como "esquema reacional de Van de Vusse":
2A-^D	(2.5)
Após o artigo original, um considerável número de artigos foram escritos enfatizando o rendimento do esquema de Van de Vusse para diferentes tipos de reatores, como PFR com reciclo intermediário (LEE, 1977), otimização da cinética da reação de Van de Vusse com reatores semi-batelada (RIDLEHOOVER e SEAGRAVE, 1973) e estudo dos rendimentos do esquema reacional neste mesmo tipo de reator (BROOKS, 1990), até a descrição do controle não-linear em um reator CSTR descrito por Engell e Klatt (1993), que elevaria o esquema de Van de Vusse a um problema referência na área de controle de processos.
No artigo intitulado Gain Scheduling Control of a Non-Minimum-Phase CSTR (ENGELL e KLATT, 1993), os autores apresentam pela primeira vez um problema real com dados da cinética da reação, tempo de residência e dimensionamento de reator, possibilitando a modelagem do sistema. Neste caso, as reações escolhidas pelos autores são a produção de ciclopentenol a partir do ciclopentadieno catalisada por ácido em uma solução aquosa.
Esse processo apresenta como reação principal a transformação do ciclopentadieno (substância A) em ciclopentenol (substância B), que é o produto desejado. O ciclopentadieno produz o diciclopentadieno (substância D) em uma reação de Diels-Alder paralela, devido a alta rea-tividade do reagente; e o ciclopentanodiol (substância C) é formado a partir do ciclopentenol, também muito reativo, a partir da adição de mais uma molécula de água. Ambos os produtos dessas reações são indesejados, ou subprodutos (CHEN et al., 1995). Todos os produtos desse
Figura 2.4 - Esquema de reação do ciclopentadieno.
HO	HO
ciclopentadieno	ciclopentanol	ciclopentanodiol
ciclopentadieno	diciclopentadieno
Fonte: Elaboração própria
esquema reacional são fabricados pela indústria de química fina e não apresentam uso industrial, sendo utilizados em grande maioria como reagentes em estudos laboratoriais de proteínas e vacinas.
Como o sistema reacional fez com que a modelagem resultasse em um conjunto de equações diferenciais ordinárias não lineares relativamente não muito complexo, o problema foi amplamente utilizado no estudo de formas diferentes de controle, como em Klatt e Engell (1998) e Chen et al. (1995); no estudo da estabilidade do sistema, como feito por Antonelli e Astolfi (2003); e otimização de processos, realizada, por exemplo, por Magalhães (2010). Assim, o esquema reacional de Van de Vusse representa um sistema de estudo interessante e desafiador, resultando em estudos diversificados na área de modelagem, simulação, controle e otimização em engenharia química.
O modelo matemático dinâmico para um reator contínuo do tipo CSTR e seus parâmetros e condições operacionais será apresentado em detalhes no Capítulo 3.
Capítulo 3
METODOLOGIA
3.1	MODELAGEM MATEMÁTICA
A vazão volumétrica de entrada F alimentada ao reator contém somente ciclopentadieno (substância A) com concentração molar igual a Cao e temperatura Tj. O sistema é então resfriado através de uma jaqueta de troca térmica cuja temperatura varia com o tempo. A Figura 3.1 representa o sistema analisado.
Figura 3.1 - Representação esquemática do reator de Van de Vusse.
A k &gt;B k-C’
2A-^D
I
Q = kuA„(Tk-T)
-Ay
Fonte: Elaboração própria
Considerando a cinética das reações como elementar, modelo a parâmetros concentra-
dos, mistura perfeita no reator e que não há vazamentos, é possível descrever a dinâmica do reator a partir de um sistema de equações diferenciais não lineares resultante dos balanços de massa para o reator e para as substâncias A, B, C e D; e do balanço de energia para o reator e jaqueta de resfriamento.
3.1.1	BALANÇO DE MASSA
Considerando a transferência de massa que ocorre no sistema, faz-se um balanço de massa para o sistema geral e para cada componente - reagentes e produtos. As equações finais do balanço são apresentadas nas equações 3.2 a 3.6.
i Balanço para o reator:
dh(f) _Fi-F dt A
Fi = F
ii Balanço por componente:
(a)	Balanço para A:
,7dCA(t)
dt
= FCAQ — FCA(f)—Vr\\t,T(t)\
(b)	Balanço para B:
V^A^ = _FCsW+V''2[,’7’W1
(c)	Balanço para C:
=	+ Vr3[í,m
(d)	Balanço para D:
= -FCD{t)+Vr4[t,T{t}\
(3.1)
(3.2)
(3.3)
(3.4)
(3.5)
(3.6)
3.1.2	BALANÇO DE ENERGIA
Estudando o fenômeno de transferência de energia que ocorre no sistema, faz-se um balanço de energia para o sistema geral e para a jaqueta térmica utilizada para aquecer o reator. As equações finais do balanço são apresentadas nas equações 3.7 e 3.8.
i Balanço para o reator:
pCpV = pCpF[Ti ~ Tref] ~ pCpF™ ~ TreA ~	+Qr (3-7)
Já o termo de energia gerada pela reação pode ser descrito através de:
Qr = V £ rjAHg = V (àHRAgk^CA +HRBCk2(T}CB+HRADk3(T}Cl)
ii Balanço para a jaqueta de troca térmica:
= Qe-kwAR[T^-Tk(t)\
(3.8)
Para facilitar a implementação do modelo nos simuladores, denominam-se os termos reacionais r(t,7") dados por:
rl = kiCA r2 = k2CB r3 = k3C¿
(~ra) = ri+r3 rb = ki~ k2 rc = r2 rd = r3
E assume-se que as velocidades de reação são dependentes da temperatura segundo a lei de Arrhenius:
(3.9)
Com a substituição da equação 3.2 nas equações resultantes dos outros balanços é possível representar o sistema de equações diferenciais ordinárias não lineares que descreve a dinâmica do reator matricialmente:
'dCAÍty dt		^[Qo-Q(t)] - (feiQ+fc3CÁ2)
dCg(t) dt		^FÇb(í) +Ã4Ç4 —
dCc(f) dt		^AFCc(í)+^2Cb
dCoÇt) dt		=^FCD^+k3C2A
dT(t) dt		i{f[Tí T (r)] +	[Tk(t)	+
dTk(f) - dt -		Qe — kwAR[T (f) — Tk(f)]
3.2	PROGRAMAS DE SIMULAÇÃO COMPUTACIONAL
Diferentes softwares podem usados para o estudo computacional de um sistema no estado estacionário e dinâmico, assim como seu controle e sua otimização. Neste trabalho a análise do reator com esquema cinético de Van de Vusse foi feita utilizando dois softwares diferentes de simulação computacional, o EMSO e o Scilab®, com o objetivo de implementar e resolver o modelo proposto, bem como simular suas condições operacionais. Um resumo das atividades implementadas em cada simulador é apresentado por meio da Tabela 3.1
Tabela 3.1 - Atividades realizadas nos simuladores EMSO e Scilab.
Atividade	EMSO	Scilab
Implementação do modelo	X	X
Simulação do estado estacionário	X	X
Simulação do sistema dinâmico	X	X
Implementação de sistema de controle	X	X
Otimização no estado estacionário		X
Otimização do sistema dinâmico controlado		X
3.2.1	SIMULADOR EMSO
O ambiente de modelagem do EMSO é estruturado em duas entidades essenciais: Model e FlowSheet. A entidade Model é onde o modelo é propriamente construído e são declaradas as variáveis e parâmetros dos equipamentos. Já o FlowSheet é o ambiente que possibilita a reprodução do modelo já implementado, permitindo dessa maneira, a inserção dos equipamentos do processo com sua descrição matemática já descrita no ambiente Model (RODRIGUES et al., 2006).
Como descrito por Francisquetti (2014), o programa faz uso de conceitos da programação orientada a objetos, como composição e herança. Através da herança é possível desenvolver modelos mais complexos por meio de outros pré-existentes, como mostrado na Figura 3.2; já a composição permite ao usuário criar um modelo a partir de vários outros modelos independentes. Com isso, o software possibilita a comunidade a expandir a biblioteca open source disponível em seu domínio online.
Figura 3.2 - Modelo de um reator CSTR pré-existente no simulador EMSO.
*
*___________________________________________________________
* Sample file for model cstr
*	This sample file needs VRTherm (www.vrtech.com.br) to run.
¡t
*	Author: Paula B. Staudt
*	Sid: sample_cstr.mso 585 2008-07-28 23:31:292 bicca 5
*	--------------------------------------------------------------------
using "reactors/cstr";
»flowsheet cstr_PropyleneGlycol
PARAMETERS
PP	as Plugin(8rief="Physical Properties",
Type = "PP",
Components = ["1,2-propylene oxide", "methanol ","water","1,2-propylene glycol" ], LiquidModel = "PR",
VapourModel = "PR"
NComp as Integer:
R	as Real	(Default=8.3145, Unit='J/mol/K');
Fonte: Elaboração própria
A elaboração do EMSO foi iniciada por (SOARES e SECCHI, 2003) e continuada pelo
projeto ALSOC (Ambiente Livre para Simulação, Otimização e Controle de Processos), da Universidade Federal do Rio Grande do Sul, com o objetivo de desenvolver, manter e distribuir especificações de uma linguagem de modelagem e uma biblioteca de modelos abertas para síntese, simulação, otimização e controle de processos em geral (Projeto ALSOC, 2009).
Utilizando o modelo pré-existente para um reator CSTR escrito na linguagem utilizada pelo EMSO, implementou-se a modelagem do sistema descrita na Seção 3.1, utilizando os parâmetros encontrados no artigo de Engell e Klatt (1993), apresentadas na Tabela 3.2, assim como as condições iniciais apresentadas na Tabela 3.3
Tabela 3.2 - Parâmetros utilizados nas simulações matemáticas no EMSO.
Parâmetro	Valor	Unidade	Descrição
kl	1,287E+12	1/h	Constante de velocidade reacional
k2	1,287E+12	1/h	Constante de velocidade reacional
k3	9,043E+9	1/h.mol	Constante de velocidade reacional
El	9758,3	K	Energia de ativação
E2	9758,3	K	Energia de ativação
E3	8560	K	Energia de ativação
V	0,01	3 m	Volume do reator
Ar	0,215	m2	Área do reator
Cp	3,01	kJ/kg.K	Capacidade calorífica
ro	0,9342	kg/1	Densidade
hl	4,2	kJ/mol	Entalpia da reação A-B
h2	-11	kJ/mol	Entalpia da reação BC
h3	-41,85	kJ/mol	Entalpia da reação A-D
Qe	-1113,5	kJ/h	Taxa de calor
kw	4032	kJ/h.m2.K	Coeficiente de transferência de calor da jaqueta de resfriamento
Tabela 3.3 - Condições iniciais utilizadas na simulação do estado estacionário.
Variável	Valor	Unidade	Descrição
CA0	5,10	mol/1	Concentração inicial do reagente A
CB0	0	mol/1	Concentração inicial do produto B
CcO	0	mol/1	Concentração inicial do produto C
cDo	0	mol/1	Concentração inicial do produto D
Fvol	0,1883	m3/h	Vazão volumétrica da corrente de entrada
Tin	403,15	K	Temperatura inicial
A simulação com o EMSO neste trabalho pode ser dividida em duas etapas: a análise do estado estacionário; e a análise e implementação do controlador no estado dinâmico.
Na análise do estado estacionário considera-se que o sistema é perfeitamente controlado e que não existem variações de temperatura e concentração com o tempo. Consequentemente os
termos diferenciais são nulos e o sistema, antes constituído por equações diferenciais, se toma um sistema de equações algébricas não lineares que é solucionado pelo programa a partir de seu solver pré-embutido. Este faz uso do método de Newton (SOARES, 2003) para resolver o sistema e retomar os valores das variáveis no estado estacionário, que serão comparados aos descritos no estado estacionário por Engell e Klatt (1993), para validação do modelo matemático.
No sistema dinâmico os termos derivativos que representam a variabilidade das variáveis dependentes com o tempo não são nulos, resultando portanto em um sistema de equações diferenciais ordinárias não lineares de valor inicial. Isto posto, faz-se necessário o uso de um tipo diferente de solver para resolução de EDOS para a obtenção dos valores das variáveis ao longo de um determinado período de tempo. Diversos algoritmos podem ser utilizados para esta tarefa (a maioria baseada em métodos Runge Kutta). Neste trabalho será utilizado o método default do EMSO que trata-se do algoritmo Sundials (SOARES, 2003). Os parâmetros para simulação dinâmica foram os mesmos da simulação estacionária e as condições iniciais utilizadas para resolução do problema foram os valores obtidos para as variáveis do sistema na estado estacionário, apresentadas no capítulo de apresentação de resultados.
Seguindo a análise do sistema dinâmico, a implementação e sintonia de um controlador é feita com o intuito de controlar a temperatura do sistema através da manipulação da taxa de calor da jaqueta de troca térmica. A temperatura está relacionada aos termos de concentração através da taxa de reação, dada pela lei de Arrhenius (Equação 3.9), onde a variável está no termo exponencial da equação e influencia consideravelmente os valores das concentrações de produtos e reagentes, sendo importantíssimo seu controle.
Devido ao conceito do software de "programação por herança", modelos pré-existentes de reatores controlados podem ser utilizados como base para implantação de um controlador PID no reator de Van de Vusse. Contudo, neste trabalho o controle será feito a partir de um controlador proporcional e integral (PI), logo considera-se o ganho do termo derivativo sendo nulo. A variável manipulada pelo controlador será a taxa de calor da jaqueta de troca térmica com intuito do controle da temperatura.
A sintonia do controlador foi implementada por meio do método de tentativa e erro descrito na Seção 2.2.2 e por meio do método de Ziegler-Nichols, descrito na mesma seção.
3.2.2	SIMULADOR SCILAB
O Scilab® é um ambiente voltado para resolução de problemas numéricos aplicados à engenharia e ciência da computação, sendo amplamente utilizado em problemas de engenharia química e de processos como ferramenta para o desenvolvimento de controle automático, processamento de sinais e otimização de processos.
O programa conta com uma linguagem de programação de alto nível e ainda assim sintaxe simples, incluindo atribuições, operadores, funções, condicionais e loops. Programas escritos com o Scilab são consideravelmente compactos e muitas das vezes são menores que seus equivalentes em outras linguagens consolidadas de programação como C, C++, Java e FORTRAN (BUNKS et al., 2012).
Além disso, por ser dedicado a computação científica, o Scilab fornece fácil acesso a grandes bibliotecas numéricas de áreas como álgebra linear, integração numérica e otimização; e pode ser acessado por programas de computação simbólica como Maple® e MuPAD®. Os resultados podem gerar gráficos bi-dimensionais e tri-dimensionais, inclusive com animação, como demostrado na Figura 3.3.
Figura 3.3 - Scilab em funcionamento.
Fonte: Campbell et al. (2006)
O Scilab também conta com com uma toolbox chamada Xcos para modelagem e simulação de sistemas dinâmicos onde componentes contínuos e discretos no tempo são interconec-tados, permitindo a construção de sistemas complexos de maneira modular a partir do uso de um editor de diagrama de blocos (CAMPBELL et al., 2006), como mostrado na Figura 3.4.
Portanto, o Scilab foi escolhido como ferramenta para a realização deste trabalho pela
Fonte: Campbell et al. (2006)
versatilidade e facilidade de implementação. Ressalta-se que a maior motivação para o uso do Scilab foi a possibilidade de configurar uma estrutura de otimização acoplada ao modelo dinâmico com considerável facilidade, ao contrário do EMSO, que não possibilita essa etapa. O modelo oriundo dos balanços de massa e energia estudado na Seção 3.1 pode ser implementado por meio de rotinas de integração de funções algébricas, em primeira instância para resolução do sistema no estado estacionário; e de EDOs, para o sistema dinâmico.
O sistema de equações algébricas não lineares, cujos parâmetros e condições iniciais semelhantes aos apresentados nas Tabelas 3.2 e 3.3, salvo mudanças de unidades, é implementado como uma function no Scilab e resolvido por meio do comando fsolve, para o estudo do estado estacionário. Este comando chama automaticamente um dentre uma gama de métodos numéricos pré-embutidos no software, dependendo da escolha do usuário. Neste trabalho o método numérico utilizado foi o default do comando - Método híbrido de Powell1 (CAMPBELL et al., 2006). Novamente, os valores resultantes da simulação serão comparados aos descritos no estado estacionário por Engell e Klatt (1993), para validação da implementação do modelo matemático e do programa construído.
A simulação dinâmica foi feita utilizando parâmetros e código semelhantes a da simulação estacionária, contudo usando os resultados dessa última como condições iniciais. Por se tratar de um sistema de equações diferenciais ordinárias, e não mais equações algébricas, o co-mando/soZve deixa de ser válido, sendo necessário o uso de um mais adequado. O Scilab possui um comando específico para este tipo de sistema, o chamado ode, que utiliza o solucionador *
método híbrido de Powell é um método de resolução de sistemas algébricos não-lineares baseado no método de Newton. O método é explicado mais profundamente por Judd (1998).
Isoda. Este escolhe automaticamente entre o método preditor-corretor não-rígido de Adams e a Fórmula de Diferenciação Retroativa (FDR) rígida (SCILAB ENTERPRISES, 2012), porém outros métodos podem ser configurados pelo usuário. A simulação deste trabalho foi feita utilizando o solucionador padrão.
Um sistema de controle proporcional integral foi implementado ao modelo dinâmico com intuito do controle de temperatura, sendo sua sintonia feita a princípio por meio do método do Ziegler Nichols, alternando posteriormente para o método da tentativa e erro.
As otimizações no Scilab foram feitas objetivando a produção do ciclopentanol, o produto B. O Scilab conta com comandos específicos para otimização, como o fininsearch e o optim, ambos considerando uma função objetivo e procurando valores ótimos ao variar os valores das variáveis de decisão 2.
Porém, o optim permite a inserção de limites dentro do próprio comando, restringindo a região de variação das variáveis de decisão pelo método numérico utilizado (no caso padrão, o método de Quasi-Newton) para encontrar o valor ótimo da função objetivo. Essa restrição é fundamental para a simulação precisa de sistemas reais, por representar, por exemplo, temperaturas e pressões máximas de segurança, vazão de entrada suportada pela tubulação, etc. Contudo o comando exige o cálculo do gradiente da função objetivo, o que pode vir a ser problemático para certos tipos de sistemas.
O comando fininsearch, que usa o algoritmo de Nelder-Mead para encontrar especificamente o mínimo de uma função, não permite a implementação de restrições por si só, sendo necessário o uso de ferramentas matemáticas para restringir a região de atuação do algoritmo. Uma delas é o uso de penalidades, que utiliza condicionais relacionando as restrições e o valor calculado pelo algoritmo para manter a operação dentro da área restrita. No código construído para otimizar o sistema analisado neste trabalho, foi feito o uso do comando fininsearch somado a penalidades a fim de manter as condições operacionais realistas e seguras. O comando calculará o valor mínimo da variável escolhida nestas condições, sendo necessária a inversão do valor para obtenção da variável em seu máximo.
No estado estacionário foram variadas duas variáveis de decisão: a vazão mássica e a taxa de calor na jaqueta de aquecimento, obtendo-se consequentemente o ponto ótimo para
2A definição de variáveis de decisão é dada na revisão bibliográfica, mais especificamente na Subseção 2.3.1.
alcançar o valor máximo de Cb-
Na otimização do sistema dinâmico controlado, a variável de decisão foi a temperatura de setpoint do controlador e, por se tratar de um sistema dinâmico, foi informado ao algoritmo que o ponto no qual o valor de Cb deve ser máximo seria o último ponto da simulação. Primeiramente foi feita a otimização considerando um único setpoint de temperatura para todo o período de tempo e, em seguida, fez-se uma simulação onde o otimizador calcula o melhor arranjo de dois setpoints de temperatura considerando a troca entre eles na metade do período de tempo estudado, visando a maior obtenção de Cb-
Todos os resultados da simulação estacionária, dinâmica e dinâmica controlada serão apresentados e discutidos no capítulo de apresentação de resultados; e o código para a simulação do sistema dinâmico controlado para dois setpoints apresentado como Apêndice.
Capítulo 4
APRESENTAÇÃO DE RESULTADOS
Serão apresentados também, os resultados do estudo de casos na implementação do controle ótimo, fazendo comparações entre os métodos de sintonia "Ziegler Nichols"e "Tentativa e Erro", além de confrontar os dados da otimização do modelo dinâmico controlado com um setpoint e dois setpoints, sempre com o objetivo de obter uma maior concentração do composto B, o ciclopentenol, no final de 10 horas.
4.1	SIMULAÇÃO EM ESTADO ESTACIONÁRIO
Para a validação do modelo matemático, foi desenvolvido um código para o estado estacionário nos softwares EMSO e Scilab, usando as condições reacionais e constantes idênticas aos valores fornecidos por Engell e Klatt (1993), sendo também a modelagem semelhante ao do trabalho citado.
Na Tabela 4.1 tem-se os dados obtidos na simulação em estado estacionário no EMSO e no Scilab, como também os dados obtidos por Engell e Klatt (1993).
Tabela 4.1 - Comparação dos dados obtidos no Modelo Estacionário.
	Cas (mol/m3)	Cbs (mol/m3)	Ts (K)
EMSO	1235	900	407,290
Scilab	1235	900	407,290
Engell e Klatt (1993)	1235	900	407,290
Para a avaliação da qualidade dos resultados obtidos utiliza-se o erro percentual, descrito
na Equação 4.1, entre os dados da Tabela 4.1.
Erro% =
x 100
(4.1)
Na Equação 4.1, XI e X2 representam os dados que se deseja comparar o erro percentual.
As Tabelas 4.2,4.3 e 4.4 apresentam os erros percentuais entre as simulações nos softwares, e dessas simulações com os resultados de Engell e Klatt (1993).
Tabela 4.2 - Erros Percentuais Scilab x Engell e Klatt.
Variável	Erro (%)
Cas	0,01177
Cbs	0,00002
Ts	0,00005
Tabela 4.3 - Erros Percentuais EMSO x Engell e Klatt.
Variável Erro (%)
Cas	0,01214
Cbs	0,00211
Ts	0,00000
Tabela 4.4 - Erros Percentuais EMSO x Scilab.
Variável	Erro (%)
Cas	0,00037
Cbs	0,00002
Ts	0,00005
Pode-se concluir que as simulações realizadas neste trabalho nos softwares Scilab e EMSO validam a modelagem proposta, uma vez que os respectivos desvios em relação aos valores reportados por Engell e Klatt (1993) foram próximos de 0%.
4.2	OTIMIZAÇÃO DO MODELO ESTACIONÁRIO
A otimização estacionária teve como objetivo a maximização da concentração do composto B usando o simulador Scilab, tendo como variáveis de decisão a vazão de entrada e o calor na jaqueta de troca térmica do reator.
Figura 4.1 - Gráfico da Otimização do Modelo Estacionário.
O gráfico da Figura 4.1 representa o algoritmo chamado pelo comando fminsearch atuando na função objetivo (concentração do composto B) até sua convergência. Como deseja-se alcançar a maximização dessa função, utiliza-se o sinal negativo, uma vez que a fminsearch minimiza a função objetivo. Apesar da impressão de convergência após a vigésima iteração, o valor da função não é constante devido à variação nas casas decimais, consequência da tolerância escolhida. A convergência de fato ocorre após 90 iterações e com um valor da função objetivo, a concentração de B, de 1081.13 mol/m3.
A Tabela 4.5 apresenta o resultado da otimização e faz uma comparação com o valor de
concentração do composto B disponível em Engell e Klatt (1993).
Modelo	Cb (mol/m3)
Estacionário (Engell e Klatt (1993)	900
Estacionário Otimizado	1081
Com os dados obtidos da otimização e demonstrados na Tabela 4.5, pode-se concluir que o resultado foi satisfatório, visto que foi alcançado uma concentração do composto B 20% maior do que o valor obtido por Engell e Klatt (1993). Estes valores obtidos na otimização serão utilizados para outros estudos de caso.
4.3	SIMULAÇÃO DO MODELO DINÂMICO
A análise do modelo dinâmico foi feita nos softwares Scilab e EMSO. Foram usados os parâmetros apresentados na Tabela 3.2; e como condições iniciais os valores obtidos na otimização estacionária da temperatura do reator e da jaqueta, e de concentração de todos os
componentes.
A Figura 4.2 mostra o gráfico com os valores de concentração dos compostos obtidos das simulações no EMSO e Scilab para um sistema sem controle. Os valores obtidos nos dois softwares foram consideravelmente semelhantes, sendo assim representados em um único grá
fico.
Figura 4.2 - Gráfico da Simulação do Modelo Dinâmico.
5 000
4 500
Temps (h)
O valor da concentração de B é de 708,00 mol/m3 no tempo de 10 horas e esse valor será base para comparações em todos os casos propostos.
A análise deste mesmo modelo foi feita, porém com a implementação de uma malha de controle fechada usando um controlador PI no software EMSO. Os mesmos parâmetros e condições iniciais da simulação anterior foram utilizados, com temperatura de setpoint para 450 K. Para a sintonia deste controlador, aplicou-se o método de "Ziegler Nichols"e obtendo como resultado um ganho de 0,001 e um tempo integral de 0,035 segundos.
Na Figura 4.3, são apresentados os valores de concentração dos componentes em função do tempo obtidos a partir da simulação dinâmica com controle no EMSO.
Figura 4.3 - Gráfico do Controle do Modelo Dinâmico.
6000.00
Tempo (h)
Com a implementação do controle, o valor da concentração do composto B após o período de 10 horas foi de 0,60 mol/m3, resultado expressivamente menor que o dinâmico sem controle (708,00 mol/m3), demonstrando a relevância da escolha correta para o valor de setpoint para o controlador. O ideal seria a implementação de um sistema de controle atuando junto a uma camada de otimização e, com essa motivação, foram propostos outros casos de estudo para o trabalho para analisar esta proposta.
4.4	CONTROLE ÓTIMO DO MODELO DINÂMICO
Na implementação do controle ótimo, foram feitos os estudos dos casos da simulação com 1 set-point fixo e com 2 diferentes setpoints, com o objetivo de analisar qual obtém maior valor de concentração do composto B no final do processo de 10 horas e qual tem a sintonia mais estável a partir do análise do ITAE. O código para solução desses estudos foi implementado no software Scilab.
Antes da aplicação do controle ótimo, foi feita a sintonia do controlador PI para o modelo proposto por "Ziegler Nichols"e por "Tentativa e Erro". Os valores dos ganhos e tempo integral para as duas formas de sintonia são apresentados na Tabela 4.6.
Tabela 4.6 - Parâmetros de Sintonização de Controle Ótimo do Modelo Dinâmico.
Método de Sintonia	Kp	T/(h)
Tentativa e Erro Ziegler Nichols	10220 16000	10.36 1.36
4.4.1	CONTROLE ÓTIMO PARA UM SETPOINT FIXO
Neste caso, temos como resultado da otimização apenas um setpoint, utilizando as mesmas condições iniciais e parâmetros do modelo dinâmico sem controle. Os parâmetros do controlador são os apresentados na Tabela 4.6.
A Figura 4.4 exibe os valores da função objetivo (valor de concentração de B) a cada iteração, sendo possível verificar a convergência da otimização.
A convergência foi atingida após 54 iterações, com um valor da função objetivo de 199019,04. É necessário observar que por serem utilizadas penalidades no código para restrição da região de operação do reator, o valor resultante da função não é a concentração do composto e sim da soma deste com as penalidades. A otimização resultou em um valor de temperatura de set-point de 415,14 K.
Figura 4.4 - Gráfico Controle Ótimo para 1 setpoint - Tentativa e Erro.
Utilizando este valor de temperatura ótima como setpoint, foi feita a simulação do controle ótimo, cujos resultados são apresentados na Tabela 4.7. São apresentados os valores de concentração do composto A (Ca) e B (Cb), da temperatura do reator (T), da temperatura da jaqueta (Tk), vedor da temperatura de setpoint (Tset) e dos valores de ITAE em amostras de tempo de 0,10 h.
Tabela 4.7 - Controle Ótimo para 1 set-point - Resultados - Tentativa e Erro.
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
0,00	2097,73	1081,14	379,00	389,59	0,00
0,10	1009,47	933,90	415,50	421,74	0,04
0,20	581,10	506,45	424,70	428,51	1,91
0,30	864,55	678,90	415,17	412,60	0,01
0,40	1020,93	795,51	412,08	410,34	1,22
0,50	901,52	737,42	415,20	415,51	0,03
0,60	855,30	698,95	416,14	416,19	0,60
0,70	889,94	717,63	415,17	414,57	0,02
0,80	904,72	729,54	414,87	414,36	0,22
0,90	893,48	723,64	415,18	414,87	0,03
1,00	888,89	719,89	415,27	414,93	0,13
1,10	892,43	721,77	415,17	414,77	0,04
1,20	893,89	722,96	415,14	414,75	0,00
1,30	892,79	722,37	415,17	414,80	0,04
1,40	892,35	722,01	415,18	414,80	0,06
1,50	892,71	722,20	415,17	414,79	0,05
1,60	892,86	722,33	415,17	414,79	0,05
1,70	892,77	722,28	415,17	414,79	0,05
Continua
Continuação da Tabela 4.7
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
1,80	892,73	722,25	415,17	414,79	0,06
1,90	892,78	722,27	415,17	414,79	0,06
2,00	892,81	722,29	415,17	414,79	0,06
2,10	892,81	722,29	415,17	414,79	0,06
2,20	892,81	722,30	415,17	414,79	0,07
2,30	892,83	722,30	415,17	414,79	0,07
2,40	892,84	722,31	415,17	414,79	0,07
2,50	892,85	722,32	415,17	414,79	0,07
2,60	892,86	722,33	415,17	414,78	0,07
2,70	892,87	722,33	415,17	414,78	0,08
2,80	892,89	722,34	415,17	414,78	0,08
2,90	892,90	722,35	415,17	414,78	0,08
3,00	892,91	722,35	415,17	414,78	0,08
3,10	892,92	722,36	415,17	414,78	0,08
3,20	892,93	722,36	415,17	414,78	0,09
3,30	892,94	722,37	415,17	414,78	0,09
3,40	892,95	722,38	415,17	414,78	0,09
3,50	892,96	722,38	415,17	414,78	0,09
3,60	892,97	722,39	415,17	414,78	0,09
3,70	892,98	722,40	415,17	414,78	0,09
3,80	892,99	722,40	415,17	414,78	0,10
3,90	893,00	722,41	415,17	414,78	0,10
4,00	893,01	722,41	415,17	414,78	0,10
4,10	893,02	722,42	415,17	414,78	0,10
4,20	893,03	722,42	415,17	414,78	0,10
4,30	893,04	722,43	415,17	414,78	0,10
4,40	893,05	722,44	415,16	414,78	0,10
4,50	893,06	722,44	415,16	414,78	0,11
4,60	893,06	722,45	415,16	414,78	0,11
4,70	893,07	722,45	415,16	414,78	0,11
4,80	893,08	722,46	415,16	414,78	0,11
4,90	893,09	722,46	415,16	414,78	0,11
5,00	893,10	722,47	415,16	414,77	0,11
5,10	893,11	722,47	415,16	414,77	0,11
5,20	893,12	722,48	415,16	414,77	0,11
5,30	893,13	722,48	415,16	414,77	0,11
5,40	893,13	722,49	415,16	414,77	0,12
5,50	893,14	722,49	415,16	414,77	0,12
5,60	893,15	722,50	415,16	414,77	0,12
5,70	893,16	722,50	415,16	414,77	0,12
5,80	893,17	722,51	415,16	414,77	0,12
5,90	893,17	722,51	415,16	414,77	0,12
6,00	893,18	722,52	415,16	414,77	0,12
Continua
Continuação da Tabela 4.7
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
6,10	893,19	722,52	415,16	414,77	0,12
6,20	893,20	722,53	415,16	414,77	0,12
6,30	893,21	722,53	415,16	414,77	0,12
6,40	893,21	722,54	415,16	414,77	0,12
6,50	893,22	722,54	415,16	414,77	0,12
6,60	893,23	722,55	415,16	414,77	0,13
6,70	893,24	722,55	415,16	414,77	0,13
6,80	893,24	722,55	415,16	414,77	0,13
6,90	893,25	722,56	415,16	414,77	0,13
7,00	893,26	722,56	415,16	414,77	0,13
7,10	893,26	722,57	415,16	414,77	0,13
7,20	893,27	722,57	415,16	414,77	0,13
7,30	893,28	722,58	415,16	414,77	0,13
7,40	893,28	722,58	415,16	414,77	0,13
7,50	893,29	722,58	415,16	414,77	0,13
7,60	893,30	722,59	415,16	414,77	0,13
7,70	893,31	722,59	415,16	414,77	0,13
7,80	893,31	722,60	415,16	414,77	0,13
7,90	893,32	722,60	415,16	414,77	0,13
8,00	893,32	722,60	415,16	414,77	0,13
8,10	893,33	722,61	415,16	414,77	0,13
8,20	893,34	722,61	415,16	414,76	0,13
8,30	893,34	722,62	415,16	414,76	0,13
8,40	893,35	722,62	415,16	414,76	0,13
8,50	893,36	722,62	415,16	414,76	0,13
8,60	893,36	722,63	415,16	414,76	0,13
8,70	893,37	722,63	415,16	414,76	0,13
8,80	893,37	722,63	415,16	414,76	0,13
8,90	893,38	722,64	415,16	414,76	0,13
9,00	893,39	722,64	415,16	414,76	0,13
9,10	893,39	722,64	415,16	414,76	0,13
9,20	893,40	722,65	415,16	414,76	0,13
9,30	893,40	722,65	415,16	414,76	0,13
9,40	893,41	722,65	415,16	414,76	0,13
9,50	893,41	722,66	415,16	414,76	0,13
9,60	893,42	722,66	415,16	414,76	0,13
9,70	893,42	722,66	415,16	414,76	0,13
9,80	893,43	722,67	415,15	414,76	0,13
9,90	893,43	722,67	415,15	414,76	0,13
10,00	893,44	722,67	415,15	414,76 Valor final de ITAE:		0,13 13,76
Figura 4.5 - Gráfico Controle Ótimo com 1 setpoint - Temperatura - Tentativa e Erro.
Como apresentado na Tabela 4.7 e na Figura 4.5, observa-se um overshoot de 9,55K (T = 424,70À"), representando uma ação proporcional atuando de modo a não haver variações bruscas no processo. Além disso, observa-se um offset que varia de 415,15K a 415,17K (diferença percentual de 0,0048%), o que implica em uma boa sintonia do parâmetro de tempo integral; e para um ciclo de 10h de otimização obteve-se um somatório de ITAE igual a 13,76, o que indica um ótimo desempenho de sintonização do controlador PI.
Na Figura 4.6 são mostrados os valores de concentração dos componentes A (Ca) e B (Cb) apresentados na Tabela 4.7 com dados num intervalo de tempo de 0,001 h. Os compostos C e D foram omitidos desta tabela, mas foram obtidos do mesmo procedimento.
Ao final da análise deste caso, observou-se o valor de concentração de B é 722,67 mol/m3 no tempo de 10 horas, maior que o valor obtido no modelo dinâmico em malha aberta.
Portanto considerou-se o resultado sendo um valor satisfatório.
T«mp« (h)
De forma semelhante ao que foi feito no controle ótimo com sintonia de "Tentativa e Erro", fez-se o estudo utilizando o método de sintonia de "Ziegler Nichols". A Figura 4.7 apresenta os valores da função objetivo a cada iteração, sendo possível verificar a convergência da otimização.
A convergência foi atingida após 38 iterações. Com um valor da função objetivo de 199019,04, neste caso foi utilizado penalidades no código, logo o valor desta função é a concentração do composto B somado às penalidades. Nesta otimização resultou-se em um valor de temperatura de setpoint de 415,17 K.
Figura 4.7 - Gráfico Controle Ótimo para 1 setpoint - Ziegler Nichols.
Ite.ação
A simulação do controle ótimo, usando o valor de setpoint otimizado, resultou nos dados apresentados na Tabela 4.8 que apresenta os valores de concentração do composto A (Ca) e B (Cb), da temperatura do reator (T), da temperatura da jaqueta (Tk), valor da temperatura de set-point (Tset) de dos valores de ITAE em amostras de tempo de 0,10 h.
Tabela 4.8 - Controle Ótimo para 1 set-point - Resultados - Ziegler Nichols.
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
0,00	2097,73	1081,14	379,79	389,59	0,00
0,10	500,15	503,13	429,87	444,38	1,47
0,20	846,05	619,46	413,95	404,74	0,24
0,30	1189,12	924,81	410,06	411,88	1,53
0,40	694,30	590,59	420,70	421,91	2,21
0,50	1013,70	767,80	411,69	408,67	1,74
0,60	872,91	729,69	416,21	417,76	0,62
0,70	863,06	693,98	415,63	414,43	0,32
0,80	935,23	749,78	414,20	413,77	0,77
0,90	866,40	708,37	415,90	415,91	0,66
1,00	903,18	725,06	414,82	414,04	0,35
1,10	895,78	726,54	415,17	414,98	0,00
1,20	886,94	717,80	415,29	414,85	0,15
1,30	899,17	726,00	415,01	414,57	0,21
1,40	890,67	721,53	415,24	414,91	0,10
1,50	893,85	722,43	415,13	414,69	0,06
1,60	894,38	723,50	415,14	414,76	0,05
1,70	892,44	722,02	415,18	414,79	0,02
1,80	894,17	723,04	415,13	414,73	0,06
1,90	893,27	722,66	415,16	414,78	0,01
2,00	893,41	722,60	415,15	414,75	0,03
2,10	893,67	722,83	415,15	414,76	0,04
2,20	893,35	722,62	415,16	414,76	0,03
2,30	893,56	722,73	415,15	414,75	0,04
2,40	893,49	722,71	415,15	414,76	0,04
2,50	893,47	722,68	415,15	414,76	0,04
2,60	893,52	722,72	415,15	414,76	0,04
2,70	893,47	722,70	415,15	414,76	0,04
2,80	893,50	722,71	415,15	414,76	0,04
2,90	893,49	722,71	415,15	414,76	0,04
3,00	893,49	722,70	415,15	414,76	0,05
3,10	893,49	722,71	415,15	414,76	0,05
3,20	893,49	722,70	415,15	414,76	0,05
3,30	893,49	722,70	415,15	414,76	0,05
3,40	893,49	722,71	415,15	414,76	0,05
3,50	893,49	722,70	415,15	414,76	0,05
3,60	893,49	722,70	415,15	414,76	0,06
Continua
Continuação da Tabela 4.8
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
3,70	893,49	722,70	415,15	414,76	0,06
3,80	893,49	722,70	415,15	414,76	0,06
3,90	893,49	722,70	415,15	414,76	0,06
4,00	893,49	722,70	415,15	414,76	0,06
4,10	893,49	722,70	415,15	414,76	0,06
4,20	893,49	722,70	415,15	414,76	0,06
4,30	893,49	722,70	415,15	414,76	0,07
4,40	893,49	722,70	415,15	414,76	0,07
4,50	893,49	722,70	415,15	414,76	0,07
4,60	893,49	722,70	415,15	414,76	0,07
4,70	893,49	722,70	415,15	414,76	0,07
4,80	893,49	722,70	415,15	414,76	0,07
4,90	893,49	722,70	415,15	414,76	0,08
5,00	893,49	722,70	415,15	414,76	0,08
5,10	893,49	722,70	415,15	414,76	0,08
5,20	893,49	722,70	415,15	414,76	0,08
5,30	893,49	722,70	415,15	414,76	0,08
5,40	893,49	722,70	415,15	414,76	0,08
5,50	893,49	722,70	415,15	414,76	0,08
5,60	893,49	722,70	415,15	414,76	0,09
5,70	893,49	722,70	415,15	414,76	0,09
5,80	893,49	722,70	415,15	414,76	0,09
5,90	893,49	722,70	415,15	414,76	0,09
6,00	893,49	722,70	415,15	414,76	0,09
6,10	893,49	722,70	415,15	414,76	0,09
6,20	893,49	722,70	415,15	414,76	0,10
6,30	893,49	722,70	415,15	414,76	0,10
6,40	893,49	722,70	415,15	414,76	0,10
6,50	893,49	722,70	415,15	414,76	0,10
6,60	893,49	722,70	415,15	414,76	0,10
6,70	893,49	722,70	415,15	414,76	0,10
6,80	893,49	722,70	415,15	414,76	0,10
6,90	893,49	722,70	415,15	414,76	0,11
7,00	893,49	722,70	415,15	414,76	0,11
7,10	893,49	722,70	415,15	414,76	0,11
7,20	893,49	722,70	415,15	414,76	0,11
7,30	893,49	722,70	415,15	414,76	0,11
7,40	893,49	722,70	415,15	414,76	0,11
7,50	893,49	722,70	415,15	414,76	0,12
7,60	893,49	722,70	415,15	414,76	0,12
7,70	893,49	722,70	415,15	414,76	0,12
7,80	893,49	722,70	415,15	414,76	0,12
7,90	893,49	722,70	415,15	414,76	0,12
Continua
Continuação da Tabela 4.8
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
8,00	893,49	722,70	415,15	414,76	0,12
8,10	893,49	722,70	415,15	414,76	0,12
8,20	893,49	722,70	415,15	414,76	0,13
8,30	893,49	722,70	415,15	414,76	0,13
8,40	893,49	722,70	415,15	414,76	0,13
8,50	893,49	722,70	415,15	414,76	0,13
8,60	893,49	722,70	415,15	414,76	0,13
8,70	893,49	722,70	415,15	414,76	0,13
8,80	893,49	722,70	415,15	414,76	0,14
8,90	893,49	722,70	415,15	414,76	0,14
9,00	893,49	722,70	415,15	414,76	0,14
9,10	893,49	722,70	415,15	414,76	0,14
9,20	893,49	722,70	415,15	414,76	0,14
9,30	893,49	722,70	415,15	414,76	0,14
9,40	893,49	722,70	415,15	414,76	0,14
9,50	893,49	722,70	415,15	414,76	0,15
9,60	893,49	722,70	415,15	414,76	0,15
9,70	893,49	722,70	415,15	414,76	0,15
9,80	893,49	722,70	415,15	414,76	0,15
9,90	893,49	722,70	415,15	414,76	0,15
10,00	893,49	722,70	415,15	414,76 Valor final de ITAE:		0,15 18,08
Na Figura 4.8 os valores de temperatura do reator e a temperatura setpoint otimizado apresentados na Tabela 4.8 são representados na forma gráfica, com dados num intervalo de tempo de 0,001 h.
Utilizando o método de sintonia de "Ziegler Nichols", há um overshoot de 14,70 K (T = 429.87), não havendo também variações bruscas na resposta do processo. Apresenta-se também um offset de 415,15 K (uma diferença percentual de 0,00371% em relação à temperatura de setpoint), o que mostra uma boa ação integral do controlador. A soma do índice ITAE em um ciclo de 10 h foi igual a 18,07.
Os valores de concentração dos componentes A (Ca) e B (Cb) apresentados na Tabela 4.8 (os compostos C e D foram omitidos desta tabela, mas foram obtidos do mesmo procedimento) são representados na forma gráfica na Figura 4.9, com dados num intervalo de tempo de 0,001 h.
Tempo (h)
Figura 4.9 - Gráfico Controle Ótimo para 1 setpoint - Concentração - Ziegler Nichols.
Tempo (h)
Observa-se que o valor da concentração de B é 722,70 mol/m3 no tempo de 10 horas, maior que no modelo dinâmico em malha aberta, sendo o esperado para o resultado do controle ótimo.
Portanto, em ambos os métodos de sintonia para a otimização do modelo dinâmico obtiveram-se resultados bastante satisfatórios. A sintonia por "Tentativa e Erro", porém demonstrou uma melhor estabilidade ao ser comparada com a sintonia pelo método de "Ziegler Nichols"devido ao seu ITAE de menor valor. No que se refere ao valor da concentração do composto B no final de 10 horas, ambos são satisfatórios em comparação ao modelo dinâmico
Figura 4.10 - Gráfico Controle Ótimo para 2 setpoints - Tentativa e Erro.
&gt;
■

4.4.2	CONTROLE ÓTIMO PARA DOIS SETPOINTS
Nesse caso, foi proposta uma situação mais real, onde o setpoint do controlador muda com o tempo. Foi feito o estudo de caso em que o setpoint é alterado no tempo de 5 horas.
Esta análise realizou-se por dois métodos de sintonias, sendo primeiramente apresentados os resultados da sintonia por "Tentativa e Erro". A Figura 4.10 é a representação gráfica da resposta do otimizador, que mostra o valor da função objetivo a cada iteração.
1.2*07
1.1 «07
1*07
8«oe
8*06
o 7*°® « 6*00
5
5*06
4*00
3*00
2*00
1*00
0*00
n « io is 20 ss ao as 40 as so ss Bô as yo 7S 8í&gt; ea no	ion ios no iis 120
A convergência da otimização ocorre após 114 iterações com um valor de função objetivo (concentração do composto somado às penalidades) de 199018,98. Foram então obtidos os valores de temperatura de setpoint, 434,74 K até o tempo de 5 horas e 415,70 K para o intervalo de tempo seguinte. Nota-se que foi necessário um número maior de iterações, devido ao maior grau de complexidade ao implementar dois setpoints diferentes.
A simulação do modelo dinâmico com controle ótimo, usando os setpoints obtidos na otimização, resultou nos valores de concentração dos compostos A (Ca) e B (Cb), temperatura do reator (T), temperatura da jaqueta (Tk) e valor de ITAE que são apresentados na Tabela 4.9 em função do tempo em intervalos de 0,10 h.
Tabela 4.9 - Controle Ótimo para 2 setpoints - Resultados - Tentativa e Erro.
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
0,00	2097,73	1081,14	379,79	389,59	0,00
0,10	526,56	557,01	429,91	450,38	0,48
0,20	177,32	171,10	450,89	472,19	3,23
0,30	294,49	271,20	439,39	449,57	1,39
0,40	440,07	398,48	431,02	440,21	1,49
0,50	381,83	355,52	434,37	447,29	0,19
0,60	329,35	307,87	437,42	450,98	1,61
0,70	341,65	317,11	436,54	448,89	1,26
0,80	360,38	333,68	435,42	447,45	0,54
0,90	357,76	332,04	435,62	448,01	0,78
1,00	351,38	326,41	436,00	448,53	1,25
1,10	351,96	326,70	435,95	448,35	1,32
1,20	354,38	328,81	435,80	448,14	1,27
1,30	354,61	329,09	435,79	448,16	1,36
1,40	354,04	328,59	435,83	448,21	1,51
1,50	354,14	328,64	435,82	448,19	1,61
1,60	354,56	329,01	435,79	448,15	1,68
1,70	354,78	329,21	435,78	448,13	1,76
1,80	354,88	329,28	435,77	448,12	1,85
1,90	355,02	329,41	435,76	448,10	1,94
2,00	355,22	329,57	435,75	448,08	2,01
2,10	355,40	329,73	435,74	448,07	2,09
2,20	355,55	329,86	435,73	448,05	2,17
2,30	355,72	330,00	435,72	448,04	2,25
2,40	355,88	330,14	435,71	448,02	2,32
2,50	356,04	330,28	435,70	448,00	2,39
2,60	356,20	330,41	435,69	447,99	2,46
2,70	356,36	330,55	435,68	447,97	2,53
2,80	356,52	330,68	435,67	447,96	2,60
2,90	356,67	330,81	435,66	447,94	2,66
3,00	356,83	330,95	435,65	447,93	2,73
3,10	356,98	331,08	435,65	447,91	2,79
3,20	357,13	331,20	435,64	447,90	2,85
3,30	357,28	331,33	435,63	447,88	2,91
3,40	357,42	331,46	435,62	447,87	2,97
3,50	357,57	331,58	435,61	447,85	3,02
3,60	357,72	331,70	435,60	447,84	3,08
3,70	357,86	331,83	435,59	447,82	3,13
3,80	358,00	331,95	435,58	447,81	3,18
3,90	358,14	332,07	435,57	447,80	3,23
4,00	358,28	332,19	435,57	447,78	3,28
4,10	358,42	332,30	435,56	447,77	3,33
4,20	358,56	332,42	435,55	447,76	3,38
Continua
Continuação da Tabela 4.9
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
4,30	358,69	332,54	435,54	447,74	3,42
4,40	358,82	332,65	435,53	447,73	3,47
4,50	358,96	332,76	435,52	447,72	3,51
4,60	359,09	332,87	435,52	447,70	3,55
4,70	359,22	332,98	435,51	447,69	3,59
4,80	359,35	333,09	435,50	447,68	3,63
4,90	359,47	333,20	435,49	447,67	3,67
5,00	359,60	333,31	435,49	447,65	3,71
5,10	631,24	516,38	421,84	419,82	31,35
5,20	1136,88	824,78	408,84	404,18	35,65
5,30	999,87	809,25	413,17	413,34	13,41
5,40	816,97	680,01	417,33	418,39	8,84
5,50	856,97	694,41	415,95	415,48	1,39
5,60	911,31	731,44	414,65	413,92	5,84
5,70	897,95	727,46	415,10	414,85	3,43
5,80	880,38	715,34	415,51	415,35	1,08
5,90	884,38	716,57	415,38	415,06	1,90
6,00	889,68	720,23	415,25	414,91	2,68
6,10	888,22	719,73	415,30	415,01	2,43
6,20	886,35	718,45	415,34	415,07	2,20
6,30	886,62	718,50	415,33	415,04	2,30
6,40	887,02	718,79	415,32	415,03	2,39
6,50	886,75	718,66	415,33	415,05	2,38
6,60	886,44	718,45	415,34	415,06	2,36
6,70	886,34	718,38	415,34	415,06	2,38
6,80	886,26	718,34	415,34	415,07	2,40
6,90	886,11	718,25	415,35	415,07	2,41
7,00	885,96	718,16	415,35	415,08	2,42
7,10	885,83	718,08	415,36	415,09	2,43
7,20	885,70	718,00	415,36	415,09	2,44
7,30	885,57	717,92	415,36	415,10	2,44
7,40	885,44	717,84	415,37	415,10	2,45
7,50	885,31	717,77	415,37	415,11	2,46
7,60	885,19	717,69	415,37	415,11	2,47
7,70	885,06	717,61	415,38	415,12	2,48
7,80	884,94	717,54	415,38	415,12	2,48
7,90	884,82	717,46	415,38	415,13	2,49
8,00	884,69	717,39	415,39	415,13	2,49
8,10	884,57	717,32	415,39	415,14	2,50
8,20	884,46	717,24	415,39	415,14	2,50
8,30	884,34	717,17	415,40	415,15	2,51
8,40	884,22	717,10	415,40	415,15	2,51
8,50	884,11	717,03	415,40	415,16	2,52
Continua
Continuação da Tabela 4.9
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
8,60	883,99	716,96	415,40	415,16	2,52
8,70	883,88	716,89	415,41	415,17	2,52
8,80	883,77	716,83	415,41	415,17	2,53
8,90	883,66	716,76	415,41	415,18	2,53
9,00	883,55	716,69	415,42	415,18	2,53
9,10	883,44	716,63	415,42	415,19	2,53
9,20	883,33	716,56	415,42	415,19	2,54
9,30	883,23	716,50	415,42	415,20	2,54
9,40	883,12	716,43	415,43	415,20	2,54
9,50	883,02	716,37	415,43	415,21	2,54
9,60	882,92	716,31	415,43	415,21	2,54
9,70	882,82	716,25	415,44	415,21	2,54
9,80	882,72	716,18	415,44	415,22	2,54
9,90	882,62	716,12	415,44	415,22	2,54
10,00	882,52	716,06	415,44	415,23	2,54
			Valor final de ITAE:		322,90
A Figura 4.11 representa o valor de temperatura do reator (T) e temperatura de setpoint (Tsetl até 5 h e Tset2 após 5 h), com dados em um intervalo de tempo de 0,001 h.
Figura 4.11 - Gráfico Controle Ótimo para 2 setpoints - Temperatura Tentativa e Erro.
Como observado na Tabela 4.9 e Figura 4.11, o controlador sintonizado por Tentativa e Erro, cujos setpoints da otimização são 434,74/f e 415,70K apresentou em sua resposta um overshoot del6.15/C em seu primeiro set-point e 1,64Â" no segundo, sendo a ação bem sintonizada para essa ocasião. Além disso, os valores de offset foram de 0,76^ (diferença percentual de 0,17) e 0,26K respectivamente, tomando a ação integral satisfatória. Por fim, o somatório do índice ITAE é igual a 322,904, valor é mais elevado que os casos anteriormente apresentados, como o esperado devido à mudança de setpoint no tempo de 5h.
Figura 4.12 - Gráfico Controle Ótimo para 2 setpoints - Concentração - Tentativa e Erro.
Os valores de concentração do ciclopentenol no final do processo de 10 h foi de 716,06 mol/m3, valor satisfatório por ser maior que o obtido no modelo dinâmico (708,00 mol/m3), atingindo o objetivo da otimização.
Como foi apresentado para o método de sintonia por "Tentativa e Erro", serão apresentados a seguir os valores obtidos da implementação do controle ótimo com o controlador sintonizado pelo método de "Ziegler Nichols". Na Figura 4.13, é apresentado a convergência da otimização na forma gráfica, demonstrada por valores da função objetivo a cada iteração.
A convergência atingida após 145 iterações com um valor da função objetivo de 199019,01. A otimização resultou nos valores de temperatura de setpoint 362,72 K, válido para o intervalo de tempo de 0h à 5h e 415,16 K, no intervalo de 5 h à 10 h.
Na Tabela 4.10, é apresentado os valores resultantes da simulação usando os resultados obtidos nessa otimização, e nela se encontra valores de concentração de A (Ca) e B (Cb), temperatura do reator (T), temperatura da jaqueta (Tk) e valor de ITAE em amostras de tempo de 0,lh.
Figura 4.13 - Gráfico Controle Ótimo para 2 setpoints - Ziegler Nichols.
Tabela 4.10 - Controle Ótimo para 2 setpoints - Resultados - Ziegler Nichols.
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
0,00	2097,73	1081,14	379,79	389,59	0,00
0,10	3209,30	790,02	365,83	326,51	0,31
0,20	4480,58	276,29	346,39	313,35	3,26
0,30	4174,45	455,98	367,36	346,07	1,39
0,40	3740,91	667,17	365,74	333,64	1,21
0,50	4301,32	386,99	354,55	322,54	4,08
0,60	4236,42	424,32	362,57	336,83	0,09
0,70	3977,66	554,53	364,07	334,37	0,94
0,80	4200,13	440,41	358,44	327,60	3,42
0,90	4216,77	433,70	361,13	333,33	1,43
1,00	4083,48	501,43	362,72	333,68	0,00
1,10	4161,49	460,84	360,15	330,12	2,83
1,20	4191,30	446,39	360,84	332,16	2,25
1,30	4128,62	478,41	361,90	332,95	1,06
1,40	4151,28	466,40	360,83	331,27	2,64
1,50	4173,86	455,16	360,89	331,87	2,75
1,60	4146,76	469,08	361,47	332,47	1,99
1,70	4150,74	466,83	361,07	331,74	2,80
1,80	4164,11	460,10	360,98	331,85	3,12
1,90	4153,44	465,62	361,27	332,21	2,74
2,00	4152,37	466,06	361,14	331,92	3,15
2,10	4159,29	462,56	361,06	331,89	3,49
2,20	4155,57	464,50	361,19	332,08	3,37
2,30	4153,88	465,32	361,15	331,98	3,59
2,40	4157,11	463,67	361,10	331,93	3,89
2,50	4156,06	464,23	361,15	332,02	3,91
Continua
Continuação da Tabela 4.10
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
2,60	4154,84	464,84	361,15	331,99	4,07
2,70	4156,22	464,13	361,12	331,96	4,31
2,80	4156,07	464,22	361,14	331,99	4,41
2,90	4155,36	464,58	361,15	331,99	4,56
3,00	4155,89	464,30	361,13	331,97	4,76
3,10	4155,97	464,26	361,14	331,99	4,90
3,20	4155,61	464,45	361,14	331,99	5,04
3,30	4155,79	464,35	361,14	331,98	5,22
3,40	4155,89	464,31	361,14	331,98	5,37
3,50	4155,72	464,39	361,14	331,99	5,52
3,60	4155,77	464,36	361,14	331,98	5,69
3,70	4155,84	464,33	361,14	331,98	5,85
3,80	4155,77	464,37	361,14	331,98	6,00
3,90	4155,77	464,36	361,14	331,98	6,16
4,00	4155,81	464,34	361,14	331,98	6,32
4,10	4155,78	464,36	361,14	331,98	6,48
4,20	4155,78	464,36	361,14	331,98	6,63
4,30	4155,80	464,35	361,14	331,98	6,79
4,40	4155,79	464,36	361,14	331,98	6,95
4,50	4155,78	464,36	361,14	331,98	7,11
4,60	4155,79	464,35	361,14	331,98	7,27
4,70	4155,79	464,36	361,14	331,98	7,42
4,80	4155,78	464,36	361,14	331,98	7,58
4,90	4155,79	464,36	361,14	331,98	7,74
5,00	4155,79	464,36	361,14	331,98	7,90
5,10	948,04	1083,40	422,30	442,30	36,41
5,20	391,41	341,40	432,43	432,88	89,80
5,30	1352,82	849,52	403,13	394,04	63,73
5,40	961,30	832,03	415,20	419,11	0,20
5,50	722,94	603,47	419,63	420,02	24,59
5,60	980,21	756,40	412,61	410,12	14,27
5,70	918,83	750,79	414,86	415,31	1,70
5,80	850,34	694,86	416,23	416,12	6,22
5,90	910,20	728,86	414,63	413,74	3,12
6,00	901,85	730,36	415,01	414,77	0,88
6,10	883,90	716,85	415,40	415,08	1,44
6,20	896,95	723,85	415,04	414,53	0,74
6,30	896,32	724,95	415,10	414,72	0,40
6,40	891,80	721,74	415,20	414,82	0,24
6,50	894,55	723,12	415,12	414,69	0,26
6,60	894,69	723,54	415,13	414,72	0,23
6,70	893,59	722,79	415,15	414,75	0,06
6,80	894,15	723,05	415,13	414,72	0,17
Continua
Continuação da Tabela 4.10
Tempo (h)	Ca (mol/m3)	Cb (mol/m3)	T(K)	Tk(K)	ITAE
6,90	894,25	723,18	415,13	414,73	0,17
7,00	893,99	723,01	415,14	414,74	0,13
7,10	894,10	723,06	415,14	414,73	0,16
7,20	894,13	723,10	415,14	414,73	0,16
7,30	894,07	723,06	415,14	414,73	0,16
7,40	894,09	723,07	415,14	414,73	0,16
7,50	894,11	723,08	415,14	414,73	0,17
7,60	894,09	723,07	415,14	414,73	0,17
7,70	894,10	723,07	415,14	414,73	0,17
7,80	894,10	723,07	415,14	414,73	0,17
7,90	894,10	723,07	415,14	414,73	0,17
8,00	894,10	723,07	415,14	414,73	0,18
8,10	894,10	723,07	415,14	414,73	0,18
8,20	894,10	723,07	415,14	414,73	0,18
8,30	894,10	723,07	415,14	414,73	0,18
8,40	894,10	723,07	415,14	414,73	0,18
8,50	894,10	723,07	415,14	414,73	0,19
8,60	894,10	723,07	415,14	414,73	0,19
8,70	894,10	723,07	415,14	414,73	0,19
8,80	894,10	723,07	415,14	414,73	0,19
8,90	894,10	723,07	415,14	414,73	0,20
9,00	894,10	723,07	415,14	414,73	0,20
9,10	894,10	723,07	415,14	414,73	0,20
9,20	894,10	723,07	415,14	414,73	0,20
9,30	894,10	723,07	415,14	414,73	0,20
9,40	894,10	723,07	415,14	414,73	0,21
9,50	894,10	723,07	415,14	414,73	0,21
9,60	894,10	723,07	415,14	414,73	0,21
9,70	894,10	723,07	415,14	414,73	0,21
9,80	894,10	723,07	415,14	414,73	0,21
9,90	894,10	723,07	415,14	414,73	0,22
10,00	894,10	723,07	415,14	414,73 Valor final de ITAE:		0,22 460,19
A Figura 4.14 é a representação gráfica dos valores apresentados na Tabela 4.10 de temperatura do reator (T) e temperatura de setpoint (Tsetl até 5 h e Tset2 após 5 h) em amostras de tempo de 0,001 h.
Tempo (h)
O controlador sintonizado por Ziegler Nichols fornece um overshoot de 17,07 K até 5 horas, e 17,27 K após 5 horas, como também, offsets de 1,58 e 0,02, respectivamente. O somatório do índice ITAE para este tipo de sintonia foi de 460,19, mais elevado para o mesmo caso usando a sintonia de "Tentativa e Erro"(ITAE de 322,904), caracterizando-o como mais instável.
A Figura 4.15 representa os valores de concentração de todos os componentes, apresentados na Tabela 4.10.
Figura 4.15 - Gráfico Controle Ótimo para 2 setpoints - Concentração - Ziegler Nichols.
Tempo (h)
O valor da concentração do composto B no final de 10 horas é 723,07 mol/m3, valor mais
alto obtido sendo comparado com todos os outros estudo de casos, possuindo valor satisfatório para a otimização.
A Tabela 4.11 é construída a fim de sumarizar os resultados obtidos no trabalho.
Tabela 4.11 - Sumário dos resultados do trabalho.
Tipo de simulação	Cb (mol/m3)	Valor de ITAE
Dinâmica sem controle	708,00	-
Dinâmica com controle	0,60	-
Controle otimizado com 1 setpoint (Tentativa e Erro)	722,67	13,76
Controle otimizado com 1 setpoint (Ziegler Nichols)	722,70	18,08
Controle otimizado com 2 setpoints (Tentativa e Erro)	716,06	322,90
Controle otimizado com 2 setpoints (Ziegler Nichols)	723,07	460,19
Capítulo 5
CONCLUSÃO E SUGESTÃO PARA TRABALHOS FUTUROS
Os resultados obtidos foram considerados satisfatórios de acordo com a proposta deste trabalho, atingindo o objetivo de implementação do controle ótimo e comparando diversos casos de modelos com controle ótimo, com controle sem otimização e o modelo dinâmico em duas linguagens de programação distintas.
Comparando o modelo com controle ótimo com o modelo dinâmico não otimizado, fazendo as porcentagens de aumento de concentração do composto B no tempo de 10 horas e analisando a estabilidade do controlador, chega-se a conclusão de que o caso com melhor resultado quanto a concentração de ciclopentenol foi o usando 2 setpoints com o método de sintonia de Ziegler Nichols, onde obtivemos um aumento de 2,13% em relação ao modelo dinâmico sem controle. Contudo, seu valor de ITAE (460,19) é alto devido à diferença entre as temperaturas de setpoints (52,44 K) e também por não ser o método que resultou numa sintonia mais estável (comparando com o método de Tentativa e Erro usando 2 setpoints, cujo valor de ITAE maior em 29,83%).
O caso com maior estabilidade do controlador e com aumento considerável na concentração foi o controle ótimo com 1 setpoint com sintonia usando Tentativa e Erro. O aumento na concentração foi de 2,07% (valor semelhante ao valor resultante da sintonia de Ziegler Nichols, com diferença percentual de 0,0042%) e ITAE mais baixo de todos os casos propostos, com um valor de 13,76.
Para trabalhos futuros, recomenda-se a implementação do termo derivativo no controlador (controlador PID) que enriqueceria o código e melhoraria as respostas do controlador com uma diminuição nas oscilações; a utilização do optim como comando para otimização no Scilab por inserir as restrições no próprio comando, evitando assim o uso das penalidades; fazer novos métodos de sintonias que resultem em melhores resultados e, no caso de mais de um setpoinf,
fazer uma sintonia adaptativa em relação a um ponto operacional do reator; realizar um estudo termodinâmico do processo, para melhor compreendê-lo.
Para finalizar, considera-se que este trabalho tem uma grande relevância no contexto de otimização e controle de reatores químicos, pois, além de tratar de um sistema não-linear, conhecido por sua difícil solução, é feita a implementação de um controle ótimo utilizando-se softwares de código aberto para a construção de modelos. Adicionalmente, este estudo não é facilmente encontrado na literatura de controle de processos, pois integra a análise do comportamento dinâmico e seu consequente efeito sobre a produção. Logo, acredita-se que a proposta de implementação deste modelo protótipo pode futuramente ser extendida para futuros trabalhos e possiveis aplicações industriais para a validação da metodologia.
Bibliografia
AGUIRRE, L. A. “Introdução à identificação de sistemas-Técnicas lineares e não-lineares aplicadas a sistemas reais”. [S.l.]: Editora UFMG, 2004.
AGUIRRE, L. A.; BRUCIAPAGLIA, A. H.; MIYAGI, P. E.; PIQUEIRA, J. R. C. "Enciclopédia de automática: controle e automação”. [S.l.]: Blucher, 2007.
ANTONELLI, R.; ASTOLFI, A. “Continuous stirred tank reactors: easy to stabilise?” Automática, Elsevier, v. 39, n. 10, p. 1817-1827, 2003.
BIEGLER, L. T. "Nonlinear programming: concepts, algorithms, and applications to chemical processes”. [S.l.]: SIAM, 2010. v. 10.
BROOKS, B. “Product yields from the van de vusse reaction scheme: use of semi-batch reactors”. Chemical engineering science, Elsevier, v. 45, n. 6, p. 1589-1594, 1990.
BUNKS, C.; CHANCELIER, J.-P.; DELEBECQUE, F.; GOURSAT, M.; NIKOUKHAH, R.; STEER, S.; GOMEZ, C. "Engineering and scientific computing with Scilab”. [S.l.]: Springer Science &amp;amp; Business Media, 2012.
CAMPBELL, S. L.; CHANCELIER, J.-P.; NIKOUKHAH, R. "Modeling and Simulation in SCILAB”. [S.l.]: Springer, 2006.
CAMPOS, M. C. M. M. de; TEIXEIRA, H. C. "Controles típicos de equipamentos e processos industriais”. [S.l.]: Edgard Blücher, 2006.
CHEN, H.; KREMLING, A.; ALLGOWER, F. “Nonlinear predictive control of a benchmark cstr”. In: Proceedings of 3rd European Control Conference. [S.l.: s.n.], 1995. p. 3247-3252.
CORSANO, G.; MONTAGNA, J. M.; IRIBARREN, O. A.; AGUIRRE, P. A.; REINHEIMER, M. A.; MUSSATI, S.; SCENNA, N.; LÓPEZ, R. A.; MASCKAUCHAN, M.; SALVO, C. A. D. et al. “Mathematical modeling approaches for optimization of chemical processes?” Applied Mathematical Modeling, Nova Publishers, p. 23, 2008.
DIEHL, F. C. “Análise, controle e otimização operacional de um reator de zymomonas mobilis com multiplicidade de equilíbrios”. 2009.
ENGELL, S.; KLATT, K. “Gain scheduling control of a non-minimum-phase cstr”. In: Proceedings of the 2nd European Control Conference. [S.l.: s.n.], 1993. p. 2323-2328.
FRANCISQUETTI, M. C. C. “Modelagem, simulação e otimização de processos usando o software emso (environment for modeling, simulation and optimization)”. Monografia-Engenharia Química, Universidade Federal de Uberlândia, Uberlândia, 2014.
JUDD, K. L. "Numerical methods in economics”. [S.l.]: MIT press, 1998.
LEE, H. H. “Tubular reactor with recycle from an intermediate point: yield of van de vusse’s reactions”. Chemical Engineering Science, Pergamon, v. 32, n. 5, p. 562-563, 1977.
LIMA, R.; NEIVA, L.; POUBEL, W. “Utilização do software de código aberto emso para oscilações de temperatura destinadas a analise de sua influência na taxa de reação de polimerização em suspensão de estireno”. Blucher Chemical Engineering Proceedings, v. 1, n. 3, p. 2686-2690, 2015.
LUYBEN, W. L. “Process Modeling,Simulation and Control for Chemical Engineers”. 2nd. ed. [S.l.]: McGraw-Hill Higher Education, 1989. ISBN 0070391599.
MAGALHÃES, O. I. do B. “Desenvolvimento de um sistema de otimização dinâmica em tempo real”. Tese (Doutorado) — Universidade Federal do Rio de Janeiro, 2010.
PEREIRA, F. M. “Introdução a Modelagem Matemática e Simulação de Processos - Material da Disciplina”. [S.l.], 2014. Disponível em:&amp;lt;http://www.dequi.eel.usp.br/~felix/MSP.pdf&gt;.
PRATA, D. M. “Modelagem e Simulação de Processos Químicos,”. Niterói - RJ, 2013.
Projeto ALSOC. “Project ALSOC”. Universidade Federal do Rio Grande do Sul, 2009. Disponível em:&amp;lt;http://www.enq.ufrgs.br/trac/alsoo.
RAVINDRAN, A.; REKLAITIS, G. V.; RAGSDELL, K. M. “Engineering optimization: methods and applications”. [S.l.]: John Wiley &amp;amp; Sons, 2006.
RODRIGUES, R.; GUERRA, C.; SECCHI, A.; LANSARIN, M. “Ensino de cinética e cálculo de reatores químicos utilizando o simulador emso”. In: XVI Congresso Brasileiro De Engenharia Química, realizado em Lorena, em setembro de. [S.l.: s.n.], 2006.
SALAU, N. P. G. “Controle de temperatura em reatores de polimerização em fase gasosa”. 2004.
SCILAB ENTERPRISES. “Scilab: Free and Open Source software for numerical computation”. Orsay, France, 2012. Disponível em:&amp;lt;http://www.scilab.org&gt;.
SEBORG, D. E.; MELLICHAMP, D. A.; EDGAR, T. E; III, F. J. D. “Process dynamics and control”. [S.l.]: John Wiley &amp;amp; Sons, 2010.
SOARES, R. d. P. “Desenvolvimento de um simulador genérico de processos dinâmicos”. 2003.
STEPHANOPOULOS, G. et al. “Chemical process control: an introduction to theory and practice”. Elsevier, 1984.
THOMAS, F. E.; HIMMELBLAU, D.; LEON, L. “Optimization of chemical processes”. 2da. Edition, Ed. McGraw-Hill. Londres, Inglaterra, 2001.
TOLEDO, E. C. V. de. “Modelagem, simulação e controle de reatores cataliticos de leito fixo”. Biblioteca Digital da Unicamp, 1999.
VUSSE, J. Van de. “Plug-flow type reactor versus tank reactor”. Chemical Engineering Science, Pergamon, v. 19, n. 12, p. 994-996, 1964.
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
//...............................................................//
//	Universidade Federal Fluminense	//
// Departamento de Engenharia Quimica e de Petroleo	//
// // // MODELAGEM CONTROLE E OTIMIZACAO DE UM REATOR CONTINUO COM // //	CINÉTICA DE VAN DE VUSSE	//
//	//
//	Codigo do controle otimo para	dois setpoints	//
//	Autores: Gabriel Fernando Barbosa Torres	//
//	Isabella da Rocha Faria	//
//	Walkiria Barbosa Silveira Braga	//
//	Orientadores : Diego M. Prata	//
//	Lizandro Santos	//
//..............................................................//
clear
clc
global kl k2 k3 El E2 E3 hl h2 h3 ro Cp Cpk V tau yi Ti global wl w3 w4 wqm wqmn ys to dtl dt2 kw Ar mk K Tint kl=1.287el2;
k2 = 1.287el2;
k3=9.043e6;
El=9758.3;
E2=9758.3;
E3=8560;
hl=4.2;
h2 = —11;
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
h3 = —41.85;
ro=934.2;
Cp = 3.01;
Cpk=2.0;
V=0.01;
tau =(1/3 6.8 3) ;
yi =5100;
ti =403.15;
kw=4032;
Ar=0.215;
mk=5;
K= 16000
Tint = 1.36
wl=le3;
w3=le3;
w4=le3;
wqm=le3;
wqmn=le3;
ys = [2097.73;1081.14;l 149.78;771.35;379.79;389.59;0;-8500];
to = 0;
dtl = [0:0.001:5];
dt2 = [5:0.001:10];
function [f] = ode_vdv(t ,y, Tset)
global kl k2 k3 El E2 E3 hl h2 h3 ro Cp Cpk V tau yi Ti kw Ar ink K Tint rl = kl*exp(—El/y(5))*y(l);
r2 = k2*exp(—E2/y(5))*y(2);
r3 = k3*exp(—E3/y(5))*y(l)*y(l);
f(8) = y(8) + K*((Tset—y(5) )+y(7)/Tint);
f(l) = -rl —r3 + yi/tau - y(l)/tau;
f(2) = rl - r2 - y(2)/tau;
f(3) = r2 - y(3)/tau;
f(4) = r3 - y(4)/tau;
f(5) = (ti — y(5))/tau — (rl*hl+r2*h2+r3*h3)/(ro*Cp) + kw*Ar*(y(6) — y
(5))/(ro*Cp*V);
f (6) = (y(8) + kw*Ar*(y(5) — y(6)))/(mk*Cpk);
f(7) = Tset - y(5)
endfunction
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
function [z]=obj(par)
global wl w3 w4 wqm wqmn ys to dtl dt2 if par&lt;500 then
Tset = par(l)
y = ode(["adams"],ys,to,dtl ,ode_vdv); ysl=y(:,$)
Tset = par(2)
y = ode(["adams"],ysl,5,dt2,ode_vdv);
P=0
else
P=le7
par=300;
y = ode(["adams"],ys,to,dtl,ode_vdv);
end
Pl = abs (min((y (1 , $)) ,0))*wl;
P3 = abs (min((y (3 , $)) ,0))*w3;
P4 = abs (min((y (4 , $)) ,0))*w4;
Pqm = abs (min(y (8 , $) ,0)) *wqm;
Pqmn = abs (max(y (8 ,—8500))*wqmn;
PTm = abs (min(y (8 , $) ,400)) *wqm;
PTmn = abs (max(y (8 ,$) ,200)) *wqmn; z=—y (2 , $)+Pl+P3+P4+Pqm+Pqmn+PTm+PTmn+P;
endfunction
par0=[420 420]
opt= optimset (" PlotFcns " , optimplotfval ," Display" , "iter"); [xopt,fval] = fminsearch(obj ,[parO],opt)</field>
	</doc>
</add>