<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.14368</field>
		<field name="filename">20682_thesis.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade de Aveiro
Departamento de
Electrónica, Telecomunicações e Informática,

2016

Alison Willian Pereira Sistema Automático de 'Load-Pull' com Base

num Sintonizador de Impedância Eletromecânico

Fully-Automated Load-Pull System based on

Mechanical Tuners



Universidade de Aveiro
Departamento de
Electrónica, Telecomunicações e Informática,

2016

Alison Willian Pereira Sistema Automático de 'Load-Pull' com Base

num Sintonizador de Impedância Eletromecânico

Fully-Automated Load-Pull System based on

Mechanical Tuners

Dissertação apresentada à Universidade de Aveiro para cumprimento dos
requesitos necessários à obtenção do grau de Mestre em Engenharia Elec-
tronica e Telecomunicações, realizada sob a orientação cientí?ca de José
Carlos Esteves Duarte Pedro, Pedro Miguel da Silva Cabral, Professores do
Departamento de Electrónica da Universidade de Aveiro e Dr. Francesc
Martin Purroy líder de grupo na área de ampli?cadores de potência em rádio
frequência (RF) na empresa Huawei Tecnologies Suécia.

Dissertation presented to the University of Aveiro for the ful?lment of the req-
uisites necessary to obtain the degree of Master In electronics and Telecom-
munication Engineering, developed under the scienti?c guidance of José Car-
los Esteves Duarte Pedro, Pedro Miguel da Silva Cabral, Professors in the
Department of Electronics, Telecommunication and Informatics of the Uni-
veristy of Aveiro, and Dr. Francesc Martin Purroy the team leader of radio-
frequency (RF) power ampli?er (PA) in HUAWEI Tecnologies Sweden.



O Júri / The Jury

Presidente / President Prof. Doutor Nuno Miguel Borges de Carvalho
Professor Catedrático da Universidade de Aveiro

Arguente Principal / Main
Examiner

Prof. Doutor João Manuel Torres Caldinhas Simões Vaz
Professor Auxiliar do Instituto Superior Técnico da Universidade de Lisboa

Orientador / Advisor Prof. Doutor José Carlos Esteves Duarte Pedro
Professor Catedrático da Universidade de Aveiro

Co-Orientador / Co-Advisor Prof. Doutor Pedro Miguel da Silva Cabral
Professor Auxiliar Convidado da Universidade de Aveiro



Agradecimentos /
Acknowledgments

É com muita satisfação que expresso a minha gratidão aos meus orientadores
Prof. Dr. José Carlos Esteves Duarte Pedro e Prof. Dr. Pedro Miguel
da Silva Cabral pela ajuda fornecida, conhecimento transmitido e tempo
disponibilizado.

Agradeço ao meu co-orientador, Dr. Francesc Purroy pela sua disponibili-
dade, atenção dispensada, paciência, dedicação e pro?ssionalismo em todas
as fases que levaram à concretização deste trabalho.

O meu profundo agradecimento a todos os colegas que contribuíram para
a concretização desta dissertação, estimulando-me intelectual e emocional-
mente. Em particular, agradeço o Dr. Eng. Luís Cótimos por me ter ajudado
inúmeras vezes.

À Universidade de Aveiro e o Instituto de telecomunicações de Aveiro pela
aprendizagem transmitida, assim como o acesso as suas facilidades.

Está dissertação foi realizada com o apoio e colaboração da empresa
HUAWEI Technologies AB - Suécia. Agradeço esta instituição pelo interesse
no trabalho desenvolvido.

Por último, tendo plena consciência que sem ela nada disso seria possível,
dirijo-me a minha mãe, pelo incentivo, compreensão e encorajamento ao
longo de todos os anos da minha vida. A ela dedico este trabalho!



palavras-chave carga virtual, calibração absoluta de potência, malha-fechada, malha-aberta,
realimentação para frente, sintonizador de impedância eletromecânico, sin-
tonizador de impedância eletrônico

Resumo Por razões de potência, linearidade e e?ciência o ampli?cador é um compo-
nente limitador de performance em qualquer tipo de aplicações relacionadas
com estações base de voz e dados, motivando a indústria das telecomuni-
cações a investir em sistemas capazes de ajudar o projetista de Ampli?cador
de Potência (AP) a obter o máximo deste elemento ativo.

O sistema de 'load-pull' é uma ferramenta essencial para auxiliar o projeto
de ampli?cadores de potência, permitindo determinar as condições ideais de
impedância que maximizam a sua performance.

Esta dissertação insere-se na área de caracterização e projeto de AP, em rádio
frequência e visa a concepção, implementação e validação de um sitema
automático de 'load-pull' passivo.

Neste trabalho, realizou-se um estudo sobre os mais diversos tipos de sis-
temas de 'load-pull' utilizados na caracterização de transistores de alta
potência.

De modo a cumprir a ?nalidade desta dissertação, construí-se um sistema
passivo automatizado de 'load-pull' capaz de lidar com potência 250W forma
de onda contínua (CW) e 2.5 kW de potência de pico em relação a envolvente
de modulação (PEP), onde a repetibilidade da malha de saída deste sistema
é -60dB a uma frequência correspondente de 1.8GHz, garantindo uma boa
precisão das impedâncias apresentadas ao transístor de microondas.



Keywords active injection, absolute power calibration, closed-loop, load-pull character-
ization, electromechanical tuner, electronic tuners, feed-forward, harmonic
impedance synthesis, load-pull, open-loop, virtual load

Abstract Due to power, linearity and e?ciency reasons the PA is the performance lim-
iting component in any state-of-the-art mobile voice and data base station,
motivating the telecommunications industry to invest in systems capable of
helping the designer of PA to get the most of the active devices.

The load-pull system is an essential tool to assist the design of PA, allow-
ing to determine the optimum matching conditions that maximizes the PA
performance parameters.

This dissertation ?ts in the area of radio frequency characterization and PA
design, aiming the artful conception, implementation and validation of an
automated passive load-pull system.

In this work a study was also performed on the most diverse types of load-pull
systems that are used in the characterization of high power transistors.

In order to ful?ll the purpose of this dissertation, an automated load-pull
system was built, being capable to handle 250W of power in continuous wave
(CW) and 2.5kW in peak-to-envelope (PEP), where the system repeatability
of its output network is -60dB at a frequency of 1.8GHz, granting a good
accuracy of impedances presented to the microwave transistor.



Contents

Contents i

List of Figures iii

List of Tables v

Acronyms vi

1 Introduction 1
1.1 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

1.2 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

1.3 Organization and structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

2 Load-Pull Systems 3
2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

2.2 Figures of Merit (FoM) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

2.3 Load-pull measurements: Traditional, VNA and Six-Port. . . . . . . . . . . . . 5

2.4 Load-pull techniques: Passive, Active and Hybrid . . . . . . . . . . . . . . . . . 10

2.5 Comparison of the di?erent kinds of load-pull setups . . . . . . . . . . . . . . . 25

2.6 Re?ection coe?cient enhancement techniques . . . . . . . . . . . . . . . . . . . 26

3 Design and implementation of an automated tuner-based load-pull system 31
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

3.2 Diagram of the automated load-pull system . . . . . . . . . . . . . . . . . . . . 32

3.3 System description . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

3.4 Characterization of the load-pull system . . . . . . . . . . . . . . . . . . . . . . 37

3.5 Characterization of the system components . . . . . . . . . . . . . . . . . . . . 37

3.6 Characterization of tuner . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

3.7 MATLAB routines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

3.8 Automated load-pull system veri?cation . . . . . . . . . . . . . . . . . . . . . . 43

4 Conclusion and Future Work 51
4.1 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

4.2 Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

Bibliography 53

i



A MATLAB Routines 57
A.1 Pre-Characterization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
A.2 Power Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
A.3 Load-Pull Measurements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

B MT981EU10_Setup - HUAWEI 73

C GaN Load-Pull - Target impedances 76

D 3-port to 2-port network conversion 77
D.1 LPS - Output Network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
D.2 LPS - Input Network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

ii



List of Figures

2.1 Representative diagram of load-pull and its applications. . . . . . . . . . . . . . 3

2.2 Representative diagram of the load-pull measurement capabilities. . . . . . . . . 5

2.3 Representative schematic of a traditional automated load-pull measurement [5]. 6

2.4 Generic block diagram of a real-time passive load-pull setup based on [6]. . . . 7

2.5 Simpli?ed automated load-pull setup based on SP re?ectometer technique. . . . 8

2.6 Representation of a passive load-pull system, copied from [5]. . . . . . . . . . . 10

2.7 Example of an electromecanical tuner (EMT) with 2 RF probes. . . . . . . . . 11

2.8 (a) Tuner RF probe. (b) Impact of parallel susceptance in the magnitude of |?|
re?ection coe?cient. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

2.9 A Solid-state electronic tuner, copied from [15]. . . . . . . . . . . . . . . . . . . 12

2.10 Example of an ETS assisting noise parameters in on-wa?er measurements. . . . 12

2.11 Shows the tuner distribution of ETS vs EMT. Copied from [18] . . . . . . . . . 13

2.12 This architecture was on of the ?rst passive harmonic load-pull setups. . . . . . 15

2.13 The harmonic rejection tuner based three-harmonic load-pull architecture. . . . 16

2.14 Tuning coverage at f0, 2f0 and 3f0 using the triplexer method. [23] . . . . . . . 16

2.15 The harmonic rejection tuner based three-harmonic load-pull architecture. . . . 17

2.16 Tuning coverage at f0, 2f0 and 3f0 using a PHT and fundamental tuner.[23] . . 17

2.17 The multipurpose single tuner based harmonic load-pull architecture. . . . . . . 18

2.18 Tuning coverage at f0, 2f0 and 3f0 using the multi purpose single tuner. . . . . 18

2.19 Representative loop of an ideal active closed-loop LPS. system. . . . . . . . . . 20

2.20 Block diagram of a realizable active closed-loop LPS. . . . . . . . . . . . . . . . 21

2.21 A generic schematic of feed-forward active load-pull architecture [5] . . . . . . . 22

2.22 Functional diagram of an active open-loop load-pull system. . . . . . . . . . . . 23

2.23 Hybrid-Active fo load-pull system copied from [28] . . . . . . . . . . . . . . . . 24

2.24 Circuit model of a mechanical tuner with pre-match and tuning probe. . . . . . 26

2.25 Functional diagram (a) and the signal ?ow of an enhaced load-pull setup (b)
copied from [29]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

2.26 Comparison of the maximum achievable re?ection coe?cient between a com-
mercial pre-matched tuner and a loop enhanced tuner at 1.8 GHz base on [29]. 27

2.27 Illustration of the quarter-wave transformer technique in (c). The Z?T represents
the synthesizable loads that are inside of the light blue circles. Moreover, the ZL
are the loads presented after the quarter-wave transformation that are inside of
the light purple circles. Those ones that possess a characteristic line impedance
of 50 ? are depicted in (a) and those ones that possess a characteristic line
impedance of 20 ? are represented in (b). . . . . . . . . . . . . . . . . . . . . . 28

iii



2.28 Fixtures with ?/4 - transformers for load-pull measurements (a) no-bias (b)
bias. Copied from [30]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

2.29 Maury load pull low-loss test ?xture. [32] . . . . . . . . . . . . . . . . . . . . . 29

3.1 Automated load-pull system implementation ?ow chart. . . . . . . . . . . . . . 32
3.2 Scheme of the built automated load-pull system. . . . . . . . . . . . . . . . . . 33
3.3 Functional diagram of the system source block. . . . . . . . . . . . . . . . . . . 34
3.4 Functional diagram of the system load block. . . . . . . . . . . . . . . . . . . . 35
3.5 Illustrate how the re?ection coe?cient of a slide screw tuner change, with a

conductive probe moving in two directions within a slabe line, being represented
on the admittance smith chart. . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

3.6 Equivantel 2-port of the input network of the LPS. . . . . . . . . . . . . . . . . 37
3.7 Interpolation result based on the pre-characterized load impedances. . . . . . . 38
3.8 Representation of the output network of the developed load-pull system. . . . . 41
3.9 Normalized load-pull results obtained in the characterization of one load impedance,

displaying the achieved gain(dB) and e?ciency as function of output power (Pout). 42
3.10 Obtained results of the repeatability check test at 1.8 GHz. . . . . . . . . . . . 43
3.11 Characterization and tuner repeatability setup. . . . . . . . . . . . . . . . . . . 44
3.12 Displayed repeatability test over the Smith chart. . . . . . . . . . . . . . . . . . 44
3.13 Scheme of the outputnetwork repeatability test. . . . . . . . . . . . . . . . . . . 45
3.14 Pre-characterization magnitude and phase error results. . . . . . . . . . . . . . 46
3.15 Precision of poorly calibrated prediction loads. . . . . . . . . . . . . . . . . . . 47
3.16 Precision of the well performed prediction loads. . . . . . . . . . . . . . . . . . 47
3.17 Estimated tuner impedances based on target impedances for the DUT charac-

terization. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
3.18 Load-Pull contours at the Z-plane. . . . . . . . . . . . . . . . . . . . . . . . . . 49
3.19 Load-Pull contour at 3dB gain compression point. . . . . . . . . . . . . . . . . . 49
3.20 Load-Pull contour at 3dB gain compression point where Z0 = 10 ?. . . . . . . 50
3.21 Final bench at Huawei Sweden of an automated tuner based load-pull system. . 50

D.1 Conversion of a 3-port network to 2-port network. . . . . . . . . . . . . . . . . . 77
D.2 Conversion from 3-port to 2-port s-parameters of the input network. . . . . . . 78

iv



List of Tables

2.1 Comparison of the load-pull measurement capabilities. Modi?ed from [11] . . . 9
2.2 Pros and Cons of ETS and EMT. Copied from [8] . . . . . . . . . . . . . . . . 14
2.3 Characteristic of harmonic tuning methods. Copied from [23] . . . . . . . . . . 19
2.4 Comparison between the passive and active techniques. Based on [5]. . . . . . . 25

C.1 Target impedances of the used microwave transistor. . . . . . . . . . . . . . . . 76

v



Acronyms

ACPR Adjacent-channel power ratio

ALC Automatic leveling control

AWR Applied wave research

CAD Computer aided design

CW Continuous wave

?D Drain e?ciency

DLL Dynamic-link library

DUT Device under test

EMT Electromechanical tuner

ETS Electronic tuners

FoM Figures of merit

GaN Gallium nitride

GPIB General purpose interface bus

HRT Harmonic rejection tuner

IF Intermediate frequency

IMD Intermodulation distortion

LNA Low Noise Ampli?er

LPS Load-pull system

LUT Look up table

MPST Multi-purpose single tuner

MWO Microwave o?ce

NVNA Nonlinear vector network analyzer

PA Power ampli?er

vi



PAE Power-added e?ciency

PAPR Peak-to-average power ratio

PDC DC power supply

Pdel Power delivered

PEP Peak-to-envelope

Pin Input power

PLP Load-pull power

Pout Output power

RF Radio-frequency

RMS Root mean square

SA Spectrum analyzer

SMA SubMiniature version A

SNR Signal-to-noise ratio

SOLT Short-open-load-thru

SP Six-port

TRL Thru-re?ect-line

VNA Vector network analyzer

VSG Vector signal generator

VSWR Voltage standing wave ratio

vii



viii



Chapter 1

Introduction

1.1 Motivation

In the last decades the radio communications industry and academic researchers have been
looking for the increase of PA's output power and e?ciency while maintaining linearity and
broadening the operating bandwidth. The PA is the limiting performance component at any
state-of-the-art mobile voice and data base-stations, which justi?es the high investments in
powerful systems capable of aiding the designer to get the most out of the active devices [1].

The most commonly used method in PA artful conception is the computer aided design
(CAD) that provides faster and reliable simulations, which usually meet the experimentally
obtained results. In some cases, the lack or inaccuracy of non-linear models makes the method
unusable. Alternatively, a very attractive measurement-based method, known as load pull is
typically employed, being a powerful tool in the microwave transistor and power ampli?ers
characterization world [1].

The term load-pull refers to the characterization of microwave transistors as a function of
re?ection coe?cient that is seen by the device under test (DUT) at its output terminal. The
traditional load-pull system is a passive technique that utilizes two mechanical tuners, one
to vary the gate (input) impedance and another to vary the drain (output) impedance for a
common source device [2], while accessing the DUT performance parameters.

The active technique is also commonly used in load-pull applications. It is based on signal
injection, emulating the re?ected travelling wave seen by the DUT. This overcomes the is-
sues associated with the passive technique due to its inherent losses that limits the maximum
achievable re?ection coe?cients, being capable to synthesize unit amplitude or even greater
re?ection coe?cients. The disadvantage associated with the active technique relies on the cost
of very expensive ampli?ers beyond being prone to oscillations.

The hybrid load-pull system results from the combination of passive and active techniques.
Although it reduces the cost of additional RF power sources or loop ampli?ers, it is very
expensive and hard to implement [1].

Another commonly used passive technique is the harmonic load-pull system (LPS) required
to perform the characterization at the fundamental and the harmonic frequencies of a DUT.
As a result of harmonic characterization through load-pull measurements, the information of
the device can then be utilized for a more complex design PA architecture where e?ciency
and linearity are the key elements.

1



1.2 Objectives

The main objective of this work is to build a LPS based on already available mechanical
tuners. Nowadays, di?erent strategies for LPS are being employed and, because of that, it is
necessary to introduce load-pull architectures applied in high-power devices characterization,
allowing to understand the most suitable setup for the practical implementation of this work.
That is the reason to establish the following objectives:

? Understand the LPS operation principles, measurements and techniques.

? Develop MATLAB control routines for the available tuners and system equipment.

? Test the developed routines and optimize overall performance.

? Validate the automated LPS assessing the accuracy of the characterization.

1.3 Organization and structure

This dissertation is organized into four chapters and have the following structure:

? Chapter 1: explains the context and motivation of load-pull measurements regarding
the design and characterization of RF power ampli?ers utilized by the radio communi-
cations industry.

? Chapter 2: introduces the load-pull state-of-art, addressing the main features of each
topology and technique. Additionally, strategies and fundamental concepts regarding
high power device characterization is given.

? Chapter 3: presents a concise description regarding the design, implementation and
validation of the built automated tuner based load-pull system.

? Chapter 4: highlights the main aspects, comments the overall work and gives hints
for future improvements of the developed load-pull system.

Appendices

? Appendix A: MATLAB Routines conceived to enable characterization of load tuner,
LPS calibration and automated load-pull measurements.

? Appendix B: MT981EU10_Setup - MATLAB routine developed for the control of
the tuner.

? Appendix C: GaN Load-Pull - List of the target impedances used in the device
characterization.

2



Chapter 2

Load-Pull Systems

This chapter introduces the load-pull state-of-art explaining the most important features,
measurements topologies and techniques applied to high power device characterization.

2.1 Introduction

The PA is designed in terms of output power, e?ciency and gain. Its optimum perfor-
mance is achieved when an appropriate source and load impedance are placed at its input
and output terminals, respectively. Since PAs usually operate at large-signal, for exhibiting
higher e?ciency, linearity breaks and the microwave transistor cannot be accurately repre-
sented through linear s-parameters, justifying the usage of load-pull techniques in order to
determine its optimum matching conditions [3].

Figure 2.1 shows the most commonly used techniques and applications of automated load-
pull systems and the red path indicates the goal of this work.

Figure 2.1: Representative diagram of load-pull and its applications.

3



2.2 Figures of Merit (FoM)

Repeatability - is one of the key features of an automated tuner, indicating how precisely
a tuner can repeat an impedance state. The repeatability consists in the di?erence of s-
parameters between two or more repeated mechanical positions that are measured through a
calibrated vector network analyzer (VNA). The following procedure exempli?es how it can
be quanti?ed: Firstly, the measurement of the s-parameters is done for a respective chosen
mechanical position and are stored in memory. Next, the tuner probe is moved to a dissimilar
position, then moved back and the s-parameters are measured again. The repeatability test
results are obtained by the following equations:

(S11)repeatability = 20.log10|(S11)measured ? (S11)memory| (2.1)

Tuning Range - speci?es the tuners maximum achievable re?ection coe?cient over the
whole Smith chart. Usually, high power microwave transistors possess their optimum load
impedances for gain, e?ciency or output power at a region close to the border of the Smith
chart. In addition, Tuning Range Distribution de?nes how the impedance points are covering
the smith chart regions [4].

Tuner Resolution - de?nes how many impedances state the tuner is capable to syn-
thesize. It is an important requisite to avoid small variations of the seen impedance by the
microwave transistor that might cause signi?cant changes in power-added e?ciency (PAE)
or Pout. Usually an impedance tuner is able to synthesize around 10.000 impedances states,
which can be increased by cascading two or more tuners.

Power Handling Capability - describes the maximum root mean square (RMS) and the
peak powers supported by the tuner without causing any signi?cant change of the calibrated
impedances. This information is speci?ed by the manufacturer of the tuners, de?ning the
safety limits in which it can operate without getting damaged or presenting a risk to the
load-pull system.

Some tuners that in the past were poorly designed, presented large values of insertion
losses, causing heat of the tuner and contributing to the corona e?ect. This e?ect causes
electric discharge due to the air ionization that is surrounding the tuner conductor, damaging
the DUT and system equipment.

Tuning Speed - is seen as the time that the tuner requires to move the probe from one
position to another. Moreover, the Total time takes in consideration the tuning speed and
spent time of the measurements, which is extremely important to have a fast load-pull char-
acterization in particular, when dealing with the passive technique principle.

Tuner Bandwidth - is classi?ed by the frequency range of the tuner and its instantaneous
bandwidth where the speci?ed impedances are synthesizable and the modulated bandwidth
has a speci?ed constant group delay [1].

Tuner Size - refers to the tuner mechanical dimensions being especially important for
on-wafer applications where possible vibrations should be avoided, reducing the impact of
probe movements and acoustic vibrations, as these increase the insertion losses and change
the predicted impedances.

4



2.3 Load-pull measurements: Traditional, VNA and Six-Port.

The load-pull measurements are classi?ed according to the capability of the system to
determine the re?ection coe?cient seen by the DUT, while accessing the injected input power
(Pin) and the power delivered (Pdel) to the load. The ?rst step in setting up a functional
load-pull system is the VNA calibration performed through a standard calibration kit. This
process is necessary to remove the systematic errors caused by directivity, mismatch, isolation,
and cross-coupling that are associated with the VNA.

Not all load-pull systems are able to monitor in real-time the impedances seen by the DUT,
unless the used topology possess waveform or vectorial capabilities such as the nonlinear vector
network analyzer (NVNA). In addition, the components attached between the NVNA and
the DUT reference plane must to be embedded on the calibration in order to directly measure
the impedances.

Most passive setups are characterized beforehand through s-parameters measurements of
tuner mechanical positions and system components. After the information of each system
block is assembled and mathematically cascaded, it allows the system to predict the impedance
state that is seen by the DUT based on the time-domain waveform, vectorial or scalar measure-
ments. In case of a scalar measurements, the characterization through s-parameters provides
the relation of phase and magnitude that exists between ports of the characterized network,
which allows the estimation of power at the DUT reference plane as well as the seen impedance.

The power meter is never directly plugged to the DUT output terminals and because of
that, the information about power is 'uncorrected', requiring a characterization of the system
to mathematically remove the inherent losses of the input and output network, resulting in
the e?ective Pin and Pout.

Because, in the passive load-pull, a2 is generated from b2 in a linear passive network (the
tuner and its associated resistor termination), the synthesized re?ection coe?cient, ??L =
a?2/b

?
2, is independent from the absolute value of b2. This means that, with a proper char-

acterization of the load block, we can predict the re?ection coe?cient actually applied to
the DUT, ?L = a2/b2, independently from the knowledge of b2. Consequently, the passive
load-pull technique is suitable for any of the discussed measurement topologies (Traditional,
VNA Based and Six-port re?ectometer). This can also be said to the closed-loop active, or
hybrid closed-loop, technique, as long as all loop blocks, namely the loop ampli?er, can be
considered linear and perfectly characterized. This is not the case of the open-loop technique
since a2 is independently generated from b2. In such a case, ?

?
L or ?L can only be known after

knowing b2, and that can be obtained from its direct measurement (via a VNA or Six-port
re?ectometer). Otherwise, it would require the knowledge of the DUT's s-matrix and the (non
assured) assumption that the DUT is linear.

Figure 2.2: Representative diagram of the load-pull measurement capabilities.

The following subsections explains how the impedance can be predicted or measured ac-
cording to the chosen topology for the passive load-pull measurements.

5



2.3.1 Traditional load-pull measurements

The traditional load-pull is based on power meter or scalar analyzer measurements, giving
only the scalar information of the DUT performance. The example shown in Fig. 2.3, contains
a DC power supply, an signal generator, an power meter and at least two tuners intended to
control and recon?gure the input and output network through a source tuner and load tuner,
respectively.

The tuner pre-characterization is a process required to determine which s-parameters cor-
responds to a certain mechanical position. This process plays a major role in system char-
acterization, accounting for the s-parameters of the tuner in every used mechanical position
together with the system components to properly shift the reference plane and mathemat-
ically remove the losses present at the output network of the DUT. As such, it is usually
created a look up table (LUT) containing the s-parameters versus tuner mechanical position
and frequency, saving time and eliminating the usage of an additional system component on
the presented topology.

In order to mathematically remove the system losses from the measurements and prop-
erly assist the power at the DUT reference plane, the so-called absolute power calibration
is normally used and it is well treated in Section 3.5.2. When used in passive systems, this
procedure is normally followed by a ?Gt system veri?cation that compares the measured
transducer gain, Gt, to the one predicted through the characterization of the whole LPS.

Figure 2.3: Representative schematic of a traditional automated load-pull measurement [5].

The re?ection coe?cients depicted in Fig.2.4, are de?ned by the ratio of incident travelling
waves, a1, a2 and the re?ected travelling waves, b1, b2, and it is calculated by the following
equations:

?S =
a1
b1

=
ZSource ?Z0
ZSource + Z0

(2.2)

?L =
a2
b2

=
ZLoad ?Z0
ZLoad + Z0

(2.3)

,where ?S is the input re?ection coe?cient, ?L is the output re?ection coe?cient, ZS is the
source impedance, ZL is the load impedance and Z0 represents the characteristic impedance
of the system.

6



2.3.2 VNA based load-pull measurements

The real-time VNA-based load-pull system shown in Fig. 2.4 is capable to monitor the
four travelling waves at the DUT planes a1, a2, b1 and b2. The VNA calibration will shift the
VNA Ref and Test ports that are monitoring a0 and b0 to the DUT input plane allowing the
calculation of ?S while a3 and b3 allows the access of the presented ?L at the DUT output
port. The re?ection coe?cients ?S and ?L are de?ned as the previous equations 2.2 and 2.3,
respectively. The system characterization is also required to assist the measurement of Pin
and Pout, obtained by a proper de-embedding of the system components.

Figure 2.4: Generic block diagram of a real-time passive load-pull setup based on [6].

In VNA-based load-pull setups, the usage of attenuators are justi?ed due to potential
oscillations of the DUT that can exceed the operating power levels causing damage to the
system equipment. In addition, the attenuator maintains the generated harmonic compo-
nents above the levels that might interfere signi?cantly on the measurements. Moreover, only
one power sensor at each power divider termination is required. Assuming a performed pre-
characterization, the tuner re?ection coe?cient is known and the VNA allows to check this
condition [7]. The power being injected and delivered by the DUT is mathematically calcu-
lated at post processing levels, removing the losses caused by probe movements and central
conductor of the tuners and the connectors. The pre-characterization of the tuners speeds up
the measurement process and allows the interpolation of impedances in order to synthesize a
desired re?ection coe?cient present in the DUT reference plane [8].

As it is known, power sensors are wide band, measuring all power including the funda-
mental and harmonic frequencies, which is the reason to utilize ?lters before the measurement
reference plane to ensure that only the fundamental frequency is being monitored and no
power at harmonic components is interfering on the measurements.

The presented measure topology only provides the information at real-time of the seen
impedance by the DUT, it requires, in addition, an absolute power calibration in order to
proper and accurately assists the power at the device input and output terminals which is a
similar process utilized in the traditional technique.

7



2.3.3 Six-port based load-pull measurements

The load-pull measurement based on six-port (SP) re?ectometer technique scheme is de-
picted in Fig. 2.5. It includes two six-port junctions, SP1 and SP2, two automated tuners,
source tuner and load tuner. The SP re?ectometer is a low-cost technique realized in microstrip
technology, which acts as network analyser for absolute power and re?ection coe?cient mea-
surement at the desired frequency [9].

This measurement topology is capable to obtain the re?ection coe?cient based on a circuit
that possess N-port network, requiring 4N power readings [1, 10]. The information of re?ection
coe?cient phase is directly obtained from RF signals through a proper calibration of the SP
re?ectormeters.

Figure 2.5: Simpli?ed automated load-pull setup based on SP re?ectometer technique.

The re?ection coe?cient and power that is obtained with SP re?ectometer measurements
is calculated the following equations:

?DUT (f) =
w(f) ?e(f)

?c(f)w(f) + d(f)
(2.4)

PDUT (f) =
k(f)PRef (f)

|1 + c(f)?DUT (f)|2
(2.5)

,where c(f), d(f) and e(f) are the error box parameters, obtained through a proper calibra-
tion of SP junction, w(f) is the embedded re?ection coe?cient, k(f) is the power calibration
parameter determined at each measurement frequency, PRef (f) is the power reading measure-
ment at reference port of the SP junction and ?DUT (f) is the re?ection coe?cient measured
by the SP re?ectometer.

?S(f) = S22(f) +
S12(f)S21(f)?st
1 ?S11(f)?st

=
?(f)?st + ?(f)

µ(f)?st + 1
(2.6)

, where ?(f) ,?(f) and µ(f) are directly related to the two-port network delimited by
the input and output reference planes of SP junctions and ?st is the source tuner re?ection
coe?cient. In a similar manner the calibration of the SP is performed at the load side of the
DUT.

8



2.3.4 Comparison of the load pull measurement techniques

The major di?erence between the di?erent measurement techniques is the utilized pro-
cedure for the inspection of the impedance seen by the DUT at its reference plane. The
traditional method is unable to monitor, in real-time, the re?ection coe?cient at the DUT
reference plane. On the other hand, the VNA-based technique allows the measurement of that
termination at CW and multi-tones, while the six-port techniques only gives information at
the fundamental frequency due to the narrowed bandwidth of the six-port ?xture, which is
built on microstrip lines. Modulated impedances require a more complex measurement system
with time domain waveform capabilities which is not discussed in this work.

Besides the short introduction of this subsection, the main features of each system are
revised in the following Table 2.1 where it is shown the main important measurements required
for the characterization of microwave transistor using a load-pull application.

Table 2.1: Comparison of the load-pull measurement capabilities. Modi?ed from [11]

9



2.4 Load-pull techniques: Passive, Active and Hybrid

The load-pull techniques have been evolving in the last decades, but its classi?cation
remains organized into two categories: active and passive. These techniques of load-pull refer
to how fashion impedances are synthesized, while the load-pull measurement are classi?ed
accordingly to the system capability in perform scalar, vectorial or time domain measurements.

This section explains the state-of-art of the load-pull techniques focusing on fundamental
frequency characterization. In addition, it is brie?y reviewed the passive harmonic load-pull
techniques that might be used as future work. Moreover, due to the inherent losses exis-
tent in passive load-pull systems, it was found interesting to present some strategies adopted
to increase the maximum achievable re?ection coe?cient in high-power microwave devices
characterization.

2.4.1 Passive load-pull system

The traditional load-pull system is generally built around its main element, the tuner,
which is usually placed between the DUT and the power meter, as shown in Fig. 2.6. The
major challenge in setting up this type of load-pull system involves its characterization and
calibration, required to de-embed the losses and shift reference plane from the peripheral
equipment to the DUT plane, allowing to assist in measuring its performance parameters [5].

Figure 2.6: Representation of a passive load-pull system, copied from [5].

The optimum load impedance is determined by the inspection of the DUT performance
parameters under di?erent impedance states while the measurement of Pin and Pout is done
through a power meter. The correct reading of Pin, Pout and output re?ection coe?cient,
?OUT is obtained by the following equations:

?OUT =
a2
b2

(2.7)

Pin = |a1|2 ?|b1|2 = |a1|2(1 ?|?in|2) (2.8)

Pout = |b2|2 ?|a2|2 = |a1|2(1 ?|?out|2) (2.9)

where, an represents the incident travelling waves and bn, the re?ected travelling waves, where
n corresponds to ports 1 and 2; There are two kinds of passive tuners: electromechanical
tuner (EMT) and the electronic tuners (ETS) as is explained as follows.

10



Electromechanical tuner (EMT)

The EMT is a physical mechanical structure that can be recon?gured to set some s-
parameters at its ports. Generally, it is composed by probes/slug/stubs in a slotted trans-
mission line. Figure 2.7 shows an automated EMT, composed by a slab line, two RF probes,
3 stepper motors and an electronic control board utilized to precisely control the mechanical
position of the probes along the x and y axis. The precision of the motors allows the correla-
tion between its s-parameters and respective mechanical positions, being a crucial feature of
an automated load-pull system.

Figure 2.7: Example of an electromecanical tuner (EMT) with 2 RF probes, based on [12].

The tuner probes depicted in Fig. 2.8 illustrate the main engine utilized in the syntheses of
di?erent re?ection coe?cients. The probe is usually called the mismatched element, because its
vertical movement over Y axis and movement along horizontal X axis, modi?es the magnitude
and phase of the re?ection coe?cient, respectively. This resonator element is speci?ed by the
manufacturer in order to cover a certain range of frequencies, which typically goes from RF
up to millimeter waves [8, 13, 14].

Figure 2.8: (a) Tuner RF probe. (b) Impact of parallel susceptance in the magnitude of |?|
re?ection coe?cient.

The EMT is capable to synthesize re?ection coe?cients, ?, normally as the order of 0.9-
0.95. When it is pre-matched by the ?xture or cascaded with another tuner, this range can
be increased up to 0.98.

11



Electronic tuners (ETS)

The ETS is a faster device fabricated with ON/OFF PIN diodes or varicators, both
mounted in microstrip circuit and digitally controlled. The distribution of re?ection factors
over the smith chart are typically irregular due to the physical distribution of circuit elements
along the microstrip line. Normally, the maximum achievable re?ection coe?cient of an ETS
is about 0.8 enclosed in a certain range of frequencies.

A possible con?guration of an ETS is depicted in Fig. 2.9, which is regularly controlling
di?erent possible ON/OFF states, through a control unit that allows the syntheses of many
high-ly repeatable re?ection coe?cients. However, this tuner possesses a lower tuning reso-
lution compared with the EMT, being usually cascaded with additional tuners, generating
millions of impedance states, which hopefully will correspond to the desired impedance states.

Figure 2.9: A Solid-state electronic tuner, copied from [15].

The ETS possesses higher values of loss, diminishing the maximum achievable re?ection
coe?cient, when compared with the EMT [16]. This makes this tuner more attractive for
an on-wafer characterization due to its associate smaller size and light weight, as shown in
Fig.2.10.

Figure 2.10: Example of an ETS assisting noise parameters in on-wa?er measurements. Copied
from [17].

12



Comparison between EMT and ETS

The most suitable tuner for a certain load-pull application depends on its requisites. Table
2.2 shows a comparison of the main aspects of EMT and ETS utilized in designs of PAs, Low
Noise Ampli?er (LNA), oscillators, mixers and on-wafer tests [8].

The ETS exhibits great values of repeatability, typically -70dB, which apparently shows
that the ETS is better than the EMT, which commonly presents only -60dB of repeatability.
However, the EMT o?ers low insertion loss on the order of tenths of dB even when gamma
possess high values, becoming a more attractive solution for systems requiring synthesizable
load impedances near the border of the smith chart. On the other hand, the ETS operating
losses can go up to 12 dB while presenting a high re?ection coe?cient such as ?L = 0.8, which
is also one of the reasons to reduce the maximum achievable re?ection coe?cient once the
losses can be even further making this technique inappropriate for the characterization of high
power ampli?ers, because of its optimum load condition of the microwave transistor is found
on the edge of the smith chart.

The EMT's are relatively slower due to the time required for the measurement using
general purpose interface bus (GPIB), taking a few seconds to move from one impedance
state to another. On the other hand, the ETS is able to swap the impedance states faster
than the EMT, which usually seems instantaneous, needing only a few milliseconds.

In case of an on-wafer device characterization, the ETS is the most suitable approach,
covering a vast range of frequencies, but at low frequencies the EMT's are also used, when an
appropriate vibration test is performed.

Figure 2.11 shows the comparison between the ETS and EMT , where the ETS has a
?xed load distribution while ETS presents a non-uniform distribution. Due to the fact that
the EMT produces a uniform distribution of generated loads, interpolation algorithms can be
used to synthesize a desired re?ection coe?cient, while the ETS can only cascade another
tuners in order to increase the number of impedances states.

Figure 2.11: Shows the tuner distribution of ETS vs EMT. Copied from [18]

13



Table 2.2: Pros and Cons of ETS and EMT. Copied from [8]

2.4.2 Passive harmonic load-pull system

The harmonic load-pull technique is an essential tool to assist the microwave characteri-
zation and to determine the optimum fundamental and harmonic load conditions for a cer-
tain ?gures of merit (FoM) such as intermodulation distortion (IMD), linearity or e?ciency.
This information plays a major role in the design of switch-mode PAs that require speci?c
impedances at the fundamental and the harmonic frequencies placed at DUT input and output
terminal as reported in [19]. It is known that optimization of DUT harmonic impedances can
improve the e?ciency more 15% than a basic PA design at fundamental frequency [20].

Figure 2.12, illustrates an example of a simple harmonic load-pull system. It possesses
a circulator, a low pass ?lter, high pass ?lter, and pairs of tuners, attenuators and power
meters. The variable, b2 represents the total transmitted wave composed by a fundamental
and harmonic travelling waves, the circulator acts as node forwarding waves from port one
to port two, two to three and three to one, inde?nitely. The ?rst branch has a low pass

14



?lter placed at port 2 of the circulator used to forward only fundamental travelling wave,
b2(f0) , whereas at port 3 a high pass ?lter is forwarding the second harmonic travelling wave,
b2(2f0). For each of the branches a tuner is placed right after the ?lter allowing the control
of fundamental and second harmonic components independently, ?L(f0) and ?L(2f0). Thus
a2(f0) and a2(2f0) are added and re?ected, resulting in a a2 total re?ected travelling wave
seen by the DUT.

Figure 2.12: This architecture was on of the ?rst passive harmonic load-pull setups. Copied
from [22].

The re?ection coe?cient at fundamental and harmonic components are calculated as fol-
lowing equations:

?L(f0) =
a2(f0)

b2(f0)
(2.10)

?L(2f0) =
a2(2f0)

b2(2f0)
(2.11)

The total re?ected travelling waves is obtained by the following equations:

a2(f0) = ?L(f0)b2(f0) (2.12)

a2(2f0) = ?L(2f0)b2(2f0) (2.13)

a2 = a2(f0) + a2(2f0) = ?L(f0)b2(f0) + ?L(2f0)b2(2f0) (2.14)

In principle this technique can be extended to a n-port wideband circulator in order to
control n-1 harmonic components, requiring additionally n-2 band-pass ?lters for the harmonic
components, a low pass ?lter at fundamental frequency and a high pass ?lter to the n-1 highest
harmonic. However, this is not practicable due to reduction in the tuning range caused by the
number of circulators used to deal with a vast number of harmonic frequencies.

Along the years, several variations of the presented technique were developed being nowa-
days classi?ed as harmonic rejection tuner, triplex based harmonic and multi-purpose single
tuner harmonic load-pull [22].

15



Triplexer based harmonic load-pull setup

The triplexer based three-harmonic load-pull setup is shown in Fig. 2.13. It uses a triplexer
that acts as a selective ?lter for the fundamental, second and third harmonic component at its
respective ports, which is attached a low pass ?lter, a band pass ?lter and a high pass ?lter,
increasing the out-of-band rejection for the undesired frequency components. As a result, the
harmonic components of the incident and re?ected travelling waves, b2 and a2, are described
in equations 2.12 and 2.13.

Figure 2.13: The harmonic rejection tuner based three-harmonic load-pull architecture.
Copied from [5].

This setup is normally implemented with a VNA measurement system, being attached to
the coupling N/W depicted in Fig. 2.13. Moreover, the input and output biasing is used to
provide the gate/base bias of the transistor and feed the drain/collector power. In addition,
the coupling is required to monitor the incident and re?ected travelling waves at the input
and output ports of the DUT, allowing to inspect which impedance is being presented at its
fundamental and harmonic components. The power meter is used to access the absolute values
of the output power at the carrier frequency band under di?erent fundamental, second and
harmonic load impedances.

The re?ection coe?cient at each respective frequency is obtained by the following eq 2.14:

b2 = b2(f0) + b2(2f0) + b3(ef0) + ... + b2(nf0) (2.15)

a2 = a2(f0) + a2(2f0) + a3(3f0) + ... + a2(nf0) (2.16)

?Load(nf0) =
a2(nf0)

b2(nf0)
(2.17)

where, n = 1,2,3, ... c

Figure 2.14: Tuning coverage at f0, 2f0 and 3f0 using the triplexer method. [23]

16



Harmonic rejection tuner

The harmonic rejection tuner (HRT) is composed by a pre-match tuner cascade with a
fundamental tuner. The pre-match and fundamental tuner are placed in the following manner
as shown in Fig. 2.15. That is necessary to ful?ll the requirements of maximum re?ection
coe?cient at fundamental and harmonic components presented at the DUT output port due
to the inherent losses of a passive system, which limits the maximum achievable re?ection
coe?cient.

The optimum re?ection coe?cient at harmonic components is usually higher than fun-
damental. Thus, a pre-match tuner is placed as close as possible to the DUT output port,
increasing the maximum achievable re?ection coe?cients at the harmonic components.

Figure 2.15: The harmonic rejection tuner based three-harmonic load-pull architecture.
Copied from [5].

The setup presented in Fig. 2.15, overcomes the problem associated with the losses of
the previous triplexer based technique that is shown in Fig. 2.13. The harmonic rejection
technique utilizes a low loss tuner, helping the synthesis of high re?ection coe?cients. The
major limitation of this method is that, in some applications, the DUT loads are too close to
the Smith chart border aggravating the impact of even the smallest losses.

Figure 2.16: Tuning coverage at f0, 2f0 and 3f0 using a PHT and fundamental tuner.[23]

17



Multi-purpose single tuner based harmonic load-pull setup

The multi-purpose single tuner (MPST) is commonly used harmonic load-pull setup, as
the one depicted in Fig. 2.17, it utilizes a tuner that is capable to control fundamental and
harmonic impedances at f0, 2f0 and 3f0 frequencies. This single tuner has three independent
probes, which are free to move in the horizontal and vertical directions. As refer, it is a
multi-purpose tuner, which drastically reduces the losses introduced by connectors and cables,
achieving a greater re?ection coe?cient for the fundamental and harmonic components when
compared with the previous techniques.

As a drawback, this technique requires an algorithm with larger computational e?ort to
precisely monitor and control the 3 independent probes for the synthesis of fundamental and
harmonic impedances due to the poor isolation.

Figure 2.17: The multipurpose-single tuner based harmonic load-pull architecture. Copied
from [5]

Figure 2.18 illustrates the synthesizable re?ection coe?cient range that is possible to obtain
with the MPST technique at fundamental and harmonic components. This technique is not
suitable for a applications that involves high values of voltage standing wave ratio (VSWR)
at harmonic components such as power ampli?ers.

Figure 2.18: Tuning coverage at f0, 2f0 and 3f0 using the multi purpose single tuner. Based
on [23]

18



Comparison between the passive harmonic load-pull methods

The two main di?erences between the presented techniques consists in the tuning isola-
tion and the tuning range. The isolation will directly interfere on the impedance control at
fundamental and harmonic components. In HRT, the poor isolation between the rejection
and fundamental tuner is around 30dB, making the fundamental and harmonic components
no longer independent and requires from the system designer an additional e?ort to account
this e?ect in the determination of the mechanical positions to satisfy the desired re?ection
coe?cient synthesis [22].

On the other hand, the multi-purpose tuner possess a system that takes the e?ect of poor
isolation repositioning the probe automatically to set the desired impedance at fundamental
and harmonic components. The major drawback is the time needed to move the probes to
the respective mechanical positions.

The triplex-based is the only technique that is considered to perform independent control
of the fundamental and harmonic components due to the triplex isolation that is usually
between 50-60dB at the fundamental and harmonic components.

The following Table 2.3 summarizes the most relevant features of the explained harmonic
load-pull techniques.

Table 2.3: Characteristic of harmonic tuning methods. Copied from [23]

19



2.4.3 Active load-pull system

The active load-pull technique is based on the principle of an active load modulation or of
a split signal method, which is also known as the 'Takayama' technique [23]. In the split signal
method, a signal with the same frequency of the one being injected at the DUT is created or
reused. This signal acts as a re?ected travelling wave and, by modifying its the magnitude
and phase, results in a new re?ection coe?cient seen by DUT.

The active load-pull monitors, in real-time, the re?ection coe?cient seen at the DUT
ports through a proper VNA calibration, helping to determine the forward and travelling
waves, which is required by the control algorithm. The major advantage of this technique
is the capability to synthesize any re?ection coe?cient on the smith chart, overcoming the
inherent losses of the passive system.

Typically, there exists three categories of active load-pull: closed-loop, feed-forward and
open-loop.

Closed-loop load-pull system

The closed-loop constitute the output network of this active load-pull technique, it is
similar to the conventional passive LPS, where ideally the a2 is a direct function of b2 and the
complex gain can modi?ed directly the magnitude and phase of the seen re?ection coe?cient.
If all the elements of the output network are well characterized, including the loop ampli?er,
this technique becomes suitable to perform the traditional measurement, which drastically
reduces cost of the implemented system.

Figure 2.19 illustrates part of the block diagram that composes an ideal closed-loop active
load-pull system. As it can be observed, the setup uses three-port component, e.g. circulator,
for forwarding the incident travelling wave, b2, and re?ect the travelling wave, a2. In addition,
a complex variable ?.ej? is used to modify the magnitude, by ?, and the phase, by ?, of the
incident wave, b2, before injecting it back at the DUT reference plane as a re?ected travelling
wave, a2. The re?ection coe?cient is synthesize as in the following equation:

?LOAD =
a2
b2

=
b2?.e

j?

b2
= ?.ej? (2.18)

,where ?LOAD represents the presented re?ection coe?cient at the DUT plane.

Figure 2.19: Representative loop of an ideal active closed-loop LPS. Copied from [5]

20



A realistic approach of a closed-loop technique requires attenuators, phase shifters, and
loop ampli?ers to properly control the magnitude and phase of the re?ected travelling wave,
as shown in Fig. 2.20

Figure 2.20: Block diagram of a realizable active closed-loop LPS. Copied from [5]

The attenuator and loop ampli?er enable the changes in magnitude of the re?ected travel-
ling wave, a2, while the phase shifter modi?es the phase of ?. As a result, the desired re?ection
factor, ?LOAD, can be synthesizable.

The presented closed loop shown in Fig. 2.19, assumes an ideal circulator and ignores
the system losses. As a result, the travelling wave obtained at the feedback loop is given by
following equation 2.19 and the ?LOAD at the DUT reference plane is given by equation 2.20:

a2 = Gb2 (2.19)

?LOAD =
a2
b2

= G (2.20)

, where G is the complex gain of the feedback loop controlling the magnitude and phase of the
synthesized re?ection coe?cient. Notice that G can assume any value and can be even greater
than one causing unwanted oscillations due to the closed-loop network, which can possibly
damage the DUT and the system equipment.

The closed-loop technique is a more attractive solution for the on-wa?er devices charac-
terization, excluding the unavoidable mechanical movements of the EMT that reduces the
needed tuning range of impedances. Despite the ETS also avoid the movements on the mea-
sure system, it possess a limited tuning range of re?ection coe?cient that can be overcome
with the closed-loop technique. On the other hand, this technique is prone to oscillates due to
the leakage existent in the passive components, which can be reduces with the usage of ?lters
that consequently makes this approach narrow band.

21



Feed-forward load-pull system

The active feed-forward load-pull system is considered to be stable contrary to what hap-
pens in the closed-loop technique. In Fig. 2.21 it is shown an example of this setup that is
composed by a simple active tuning chain, a signal source, a variable phase shifter, an atten-
uator, a variable gain stage and one isolator. The incident travelling wave at the output port
of DUT, b2, is typically given by following equation:

b2 = S21a1 + S22a2 (2.21)

If we assume that the components are ideal, a2, the re?ected travelling wave presented at
the output port of the DUT is obtained with the following equation:

a2 = Ga1 (2.22)

The ?Load represents the ratio of a2 over b2, where the a2 is generated from the incom-
ing wave, a1, an then adjusted by the phase shifter, attenuator, loop ampli?er and isolator.
Consequently, the ?Load results from the combination of Eq. 2.21 and Eq. 2.22 yielding the
following equation:

?Load =
a2
b2

=
1

S21
G

+ S22
(2.23)

,where G represents the complex gain introduced by the loop ampli?er of the feed-forward
load-pull network and S21 and S22 represents the unknown DUT large signal s-parameters.

Figure 2.21: A generic schematic of feed-forward active load-pull architecture [5]

Accordingly to Eq. 2.23, it is important to notice the dependence of the re?ection co-
e?cient with the complex gain G and the DUT large signal s-parameters S21 and S22.
Consequently, the synthesize of ?Load becomes unpredictable due to unknown large-signal
s-parameters exhibited by the DUT. In order to obtain a desired re?ection coe?cient, it is
necessary to use convergence techniques to get a certain re?ection coe?cient. Moreover the
complex loop gain, G, must to be bounded between G = 0, and G = 1/S22. Corresponding
to no operating feed-forward load and the case where it presents the maximum re?ection co-
e?cient, ?Load, at DUT plane. Thus, if the G is bounded, the attenuator and isolator will
prevent the loop ampli?er to oscillate. Moreover, while the DUT operates at its stable region
the S22 ? 1 and the Eq. 2.23 keeps its usefulness for the calculation of ?Load.

22



Open-loop load-pull system

The open-loop is very similar to the feed-forward technique, its di?erence consists basically
in the addition of external sources utilized in the creation of the re?ected travelling wave, a2,
as shown in Fig. 2.22. The loop ampli?er and phase shifter will control the magnitude and
phase of the re?ected travelling wave, a2. In addition, the isolator will guarantee safe operation
range of the loop ampli?er preventing it to get damaged.

The two sources 1 and 2, shown in Fig. 2.22, are responsible for the incident travelling
waves injected at the DUT reference planes, namely a1 and a2. Being the re?ected travelling
wave b1 caused by the ?IN of the DUT and the feed-back of the device, b2 as shown in
the denominator of Eq. 2.24. Consequently, the usage of an external signal of 10 MHz will
maintain the phase coherence between the incident and re?ected waves a2 and b2, once b2 a
created as a function of the source 1, and a2, as a function of source 2.

Figure 2.22: Functional diagram of an active open-loop load-pull system.

The load re?ection coe?cient synthesized with the open-loop technique is given by the
following equation:

?Load =
a2
b2

=
a2

S21a1 + S22a2
=

1

S21
a1
a2

+ S22
(2.24)

,where S21 and S22 are the large-signal s-parameters of the DUT at the fundamental frequency.
An notable point in equation (2.24) is that the value of the load re?ection coe?cient, ?L,

can vary from 0 to ? , only by modifying the magnitude of the re?ected travelling wave, a2.
The major drawback of this technique is the necessity of an expensive external source. In the
case of active harmonic load-pull applications, a power divider with frequency multiplier can
be used with additional loop ampli?ers and phase shifters, or adding an external source at
each harmonic component.

The equation 2.23 and 2.24 presents a theoretical point of view for the feed-forward and
open-loop, respectively. In both cases it is assumed that s-matrix of the DUT is known, al-
though it still valid only if the DUT operates in small signal where its behaviour is linear.
Alternatively, for the large-signal characterization the information of the unknown b2 is nec-
essarily obtained through a measure equipment, helping in the determination of the re?ection
coe?cient based on the characterization of the system. Moreover, helping in this task, it is
also used a convergence algorithm such as Newton-Raphson [5] to properly set the desired
re?ection coe?cient at the DUT's port, which is usually achieved with 5-10 iteration.

For a more detailed information about the open-load pull technique the reader is referred
to [24, 25, 26].

23



2.4.4 Hybrid load-pull system

The hybrid load-pull system is normally recommended for highly re?ective load-pull ap-
plications, it combines the passive and active techniques in order to overcome the associated
problems of both, despite increasing its complexity.

In Fig. 2.23, it is shown an example of the hybrid load-pull application that combines
the passive tuners with active open-loop load-pull setup, the VNA based approach allows
to monitor not only the fundamental but also the harmonic components of the microwave
transistor if the case.

Moreover, the passive part of the system is composed by a source and load impedance tuner
that is normally used to re?ect the high power at the fundamental frequency and therefore
requires a smaller signal to be injected, i.e, it acts as pre-match network of the DUT. In
addition, the active part, in this particular case, is composed by an additional signal source
and ampli?er which is placed at the tuner output port, supporting the needed amount of
power that is necessary to overcome the inherent losses of the passive network and synthesize
the desired load impedance.

Figure 2.23: Hybrid-Active fo load-pull system copied from [28]

? | 1 - ampli?er | 2 - isolator | 3 - bias tee | 4 - dual coupler | 5 - ?xture | 6 - attenuator|

In the hybrid technique, the passive and fundamental load tuner is augmented by an
active source, while the mechanical positions of the tuner are used as a pre-match decreasing
the required load-pull power (PLP). The requisite of an external high-power ampli?er is
diminished, maintaining the needed high re?ection coe?cient.

This setup is cheaper than an active open-loop load-pull system, once it requires less PLP
to be injected at the DUT output port in order to emulate the desired load impedance, while
accessing the DUT performance parameters.

24



2.5 Comparison of the di?erent kinds of load-pull setups

Table 2.4, summarizes the main characteristics of the active and passive method, not
covering the hybrid load-pull due to the vast possible sets that can be obtained with this
technique.

The closed-loop technique possess the lowest re?ection coe?cient range, when compared
with any active technique, as it requires a ?at gain of the loop ampli?er to avoid oscillations.
On the other hand, the feed-forward and the open-loop techniques are not restricted to a ?at
gain condition, however the feed-forward technique might oscillates under some conditions,
which makes the open-loop the most robust active technique in terms of oscillation.

Table 2.4: Comparison between the passive and active techniques. Based on [5].

25



2.6 Re?ection coe?cient enhancement techniques

The traditional LPS is a reliable and low cost setup that uses mechanical tuners for the
high-power device characterization. However, it typically possess a limited range of re?ection
coe?cient due to the inherent losses of the system caused by the couplers, cables and ?xture
that exists between the DUT and tuners. It delimits the maximum achievable VSWR requiring
large amounts of power to properly characterize the DUT.

This section presents the most common techniques used to overcome the already mentioned
problems associated with the passive load-pull system. A short description of the pre-matched
tuning enhancement, the enhanced loop, the quarter-wave impedance transformation and
the broadband impedance transformation is presented, allowing to increase the maximum
achievable re?ection coe?cient at the same time that it reduces the needed PLP to assist the
DUT performance parameters [5].

2.6.1 Pre-matched

The pre-matching technique utilizes two independent RF probes that are inside of the
same tuner, being usually called the pre-matching and tuning probes. The probes are placed
side-by-side on a central conductor as the equivalent representation shown in Fig. 2.24.

Figure 2.24: Circuit model of a mechanical tuner with pre-match and tuning probe.

In this type of tuner to enhance the tuning range, the two RF probes are combined to
produce high levels of re?ection coe?cients, when compared with a single tuner. Its mathe-
matical formulation of how the re?ection coe?cients are normally synthesized is shown in the
following equations.

?total = S
B
11 +

SB21S
B
12?pre?match

1 ?SB22?pre?match
(2.25)

?pre?match =
Y0 ?Ypre?match
Y0 + Ypre?match

(2.26)

Ypre?match = Yprobe + Y0

(
1 ? ?1
1 + ?1

)
(2.27)

?1 = S
A
11 +

SA21S
A
12?probe

1 ?SA22?probe
(2.28)

?probe =
Y0 ? (Yprobe + Y0)
Y0 + (Yprobe + Y0)

=
?Yprobe

Yprobe + 2Y0
(2.29)

26



2.6.2 Enhanced loop

The enhanced loop setup is a simple passive load-pull system that additionally possess a
circulator and an cable with a certain length L2, as shown in the example presented in Fig.
2.25 (a).

The loop is attached to a low-loss impedance tuner and the re?ection coe?cient present
at the DUT plane, can be obtained from simpli?cation of the signal ?ow graph shown in Fig.
2.25 (b), which results in Eq. 2.27 [28].

Figure 2.25: Functional diagram (a) and the signal ?ow of an enhaced load-pull setup (b)
copied from [29].

?Total =
a2
b2

= S22Tuner +
S23TunerS32Tuner?Loop

1 ?S33Tuner?Loop
(2.30)

where

?Loop =
a3
b3

= |?Loop|e?2j?L2 (2.31)

The ?Loop is the re?ection coe?cient generated by the passive loop presented at the output
port of the tuner that is successively transformed in the ?Total, being this the impedance seen
by the DUT at its output port. Figure 2.6 shows a comparison between an pre-matched
tuner, as blue circles, and the low loss tuner using the tuning enhanced loop, represented as
a the red circles. Notice that the maximum re?ection coe?cient is increased with the tuning
enhancement technique.

Figure 2.26: Comparison of the maximum achievable re?ection coe?cient between a commer-
cial pre-matched tuner and a loop enhanced tuner at 1.8 GHz base on [29].

27



2.6.3 Quater-wave impedance transformation

The quarter-wave impedance transformation is a technique used to increase the accuracy
and the maximum achievable re?ection coe?cient, as shown in Fig. 2.27. The enhanced loop
and pre-match techniques are limited in terms of accuracy due to its reference characteristic
impedance that is typically 50 Ohms. In addition, the employment of this technique allows to
diminish the uncertainty on VNA measurements performed at the border of the Smith chart.

Figure 2.27: Illustration of the quarter-wave transformer technique in (c). The Z?T represents
the synthesizable loads that are inside of the light blue circles. Moreover, the ZL are the loads
presented after the quarter-wave transformation that are inside of the light purple circles.
Those ones that possess a characteristic line impedance of 50 ? are depicted in (a) and those
ones that possess a characteristic line impedance of 20 ? are represented in (b).

The major bene?t of the quarter-waver transformation technique is the modi?cation of
the reference impedance, which consequently reduces VSWR for the synthesis of a desired
re?ection coe?cient. In addition, the chances of potential damage to the DUT, tuner and
measurement equipment are diminished, since the required PLP to operate the load pull system
for the same target impedance have also been reduced.

Figure 2.28 shows two ?xtures with ?/4 transformers, the (a) without biasing and (b) with
the drain biasing. The purpose of (b) is to accelerate the design process.

Figure 2.28: Fixtures with ?/4 - transformers for load-pull measurements (a) no-bias (b) bias.
Copied from [30].

28



2.6.4 Broadband impedance transformer

The broadband impedance transformation overcomes the very narrow bandwidth charac-
teristic associated with the quarter-wave transformer which is only 5 to 10 percent of the carrier
frequency. Consequently, the quarter-wave transformer technique is unusable in applications
that involve harmonic characterization.

The also called multi-section impedance transformation allows the synthesis of fundamental
and harmonic impedances with an appropriated tuning range that also reduces PLP required
for the high re?ective load-pull applications.

The tapers are multi-section transformers, which possess di?erent characteristic impedance
in each section. In theory, the in?nite series of sections form a continuously tapered line, being
the most commonly used linear, triangular, exponential and Klopfenstein. The criterion of
choice manly depends on the impedance transformation, which, for some applications, cannot
exceed an established length of the transformer [30].

The linear taper is the simplest one and its design is rapidly obtained but its disadvantage is
the required length for its implementation. The triangular and exponential taper are slightly
complex but present a better response in impedance transformation, being the presented
re?ection coe?cient lower than the one of the linear transformer, for the same correspondent
length.

The best taper is undoubtedly the Klopfenstein once it possess the shortest taper length
for the maximum re?ection coe?cient speci?cation, presenting the lowest in band re?ection
coe?cient. However, its formulation and design relies on the more complex Bessel functions.
Figure 2.29 shows an example from Maury microwave test ?xture that utilizes Klopfeinsten

Figure 2.29: Maury load pull low-loss test ?xture. [32]

taper, using APC 7 mm connector, which presents a good repeatability. In addition, coolers
are used to stabilize the DUT temperature. More information about this type of structures
and related theory about multi-section transformers can be found in the Pozar book [33].

29



30



Chapter 3

Design and implementation of an

automated tuner-based load-pull

system

This chapter presents a concise description of the built setup and all steps regarding the
design, implementation and validation of the automated load-pull system.

3.1 Introduction

The load-pull system is an essential tool utilized to assist power ampli?er design, in par-
ticular to determine the ideal matching impedance for gain, e?ciency or power.

The built passive tuner-based setup consists of one fundamental load tuner, one signal
source, a test ?xture, a dual channel power meter, a power supply, a spectrum analyzer, a RF
test set (including cables, attenuator, ?lter, couplers and power dividers) and a VNA.

The tuner is selected based on its FoM such as repeatability, resolution and tuning range
and distribution of the synthesizable re?ection coe?cients. This helps to achieve high levels of
impedance accuracy, to obtain a vast number of impedances states and synthesize high levels
of re?ection coe?cients covering, in this way, the whole Smith chart.

The implementation of this load-pull system involved 4-four steps described as follows:

? Characterization - to ?nd out the s-parameters of each system component, including the
tuner for a wide range of mechanical positions.

? Assembly of the system components - to establish a load-pull measurement setup.

? Calibration of the load-pull measurement setup - to ?nd out, based on the characteriza-
tion ?les, the inherent losses of the system and to shift the reference plane to the device
packaging ports.

? Measurement of relevant data at the calibrated reference planes - gives us the Pin and
Pout after de-embedding the losses that are associated to the measured data.

Then, knowing the DC supplied (PDC), Pin and Pout the PA FoM such as gain, PAE and
drain e?ciency (?D) can be easily calculated.

31



3.2 Diagram of the automated load-pull system

Figure 3.1 presents a diagram of the whole implementation process of the automated load-
pull setup. First, a calibration of the VNA is performed and then a characterization of each
passive system component is done. This procedure is treated in the upcoming subsections,
speci?cally 3.3 and 3.4.

Furthermore, it is necessary to check the repeatability of the automated load-pull system
under two di?erent scenarios to prove its accuracy and viability. The ?rst test is necessary
to verify the tuner repeatability, where the results should correspond to the data sheet of the
tuners manufacturer, which states that the tuner should present at least a repeatability of -50
dB at a certain range of frequencies. Afterwards, in the second test a ?xture and a load block
are attached to the port 1 and 2 of the tuner, respectively, as it can be seen in Subsection 3.6
and in Fig. 3.12.

The used methodology allows to systematically track and identify the sources of error,
along each step of the system characterization that is indicated in the diagram of Fig. 3.1.
A more detailed information regarding the load-pull system veri?cation will be given in the
following sections.

The last routine is responsible to perform the measurements and store all the relevant
information. This load-pull data is saved in three di?erent directories and forms. The ?rst
directory contains the ?gures of each load characterization, the second is a ?le that contains
all the relevant data regarding the measurements. Finally, the third directory stores a ?le with
the AWR/MWO ?le format containing the DUT load-pull characterization which includes all
the tested load impedances.

Figure 3.1: Automated load-pull system implementation ?ow chart.

32



3.3 System description

The built load-pull system is composed by 3 fundamental blocks: Source Block, Load
Tuner, and Output Block. Moreover, four additional instruments are required: power meter,
DC power analyzer, PC control and the VNA.

A block diagram of the automated load-pull system is shown in Fig. 3.2. The DUT is fed
from a high-power microwave source, which is achieved combining the signal generator and
driver ampli?er. The load impedance is controlled by an automated mechanical tuner and the
measurement data is generated by using a dual channel power meter. The DC power supply
is necessary to provide the gate/base bias of the transistor and feed the drain/collector power.

Figure 3.2: Scheme of the built automated load-pull system.

An additional external trigger connection, not displayed on the Fig. 3.2, guarantees a
synchronous measurement.

? The black dotted lines denote the calibrated VNA characterized blocks.

? The green dashed lines indicate the LAN connection utilized to remotely control the
de-vices.

? The red full lines are the illustrative ?ow of DC and RF power.

? The blue full lines are used to represent the physical interconnection of the power sensor
and power meter.

It is important to notice that the power meter is only monitoring the (uncorrected) power
at each system block where it is placed. The s-parameters obtained from the characterization
are then used to determine and correct the measured power of the ampli?er, via the available,
absolute power calibration and transducer gain formula to e?ectively measure the power being
injected and delivered by the DUT.

33



3.3.1 Source block

The source block is composed by a vector signal generator (VSG) used for generating
the signal and driver for adjusting the power level. This input network is composed by the
following instruments and components:

? Signal Generator enables the performance assessment of the ampli?er under a speci?c
type of stimuli.

? Driver Ampli?er is utilized to boost the RF signal, once it is necessary to supply the
needed amount of power that leads the DUT to the desired compression gain.

? Isolator at port 1 is used to guarantee that the driver right after the VSG sees a matched
load, regardless on the input impedance of the DUT.

? Coupler allows to sample part of the incident wave that is travelling into the DUT.

? Power sensor A is part of the measurement system that provides the uncorrected infor-
mation about the Pin magnitude.

Figure 3.3: Functional diagram of the system source block.

This kind of application dissipates a lot of heat, which justi?es the usage of cooler units
to maintain an average temperature of the DUT and driver.

34



3.3.2 Load block

The load block is composed by an attenuator, a coupler, a low pass ?lter and a power sensor
B. Additionally, a spectrum and time domain analyzer allows to visually inspect the waveform
of the incoming signal. The output network is placed after the tuner and is comprised by:

? Attenuator is used to ensure that less power ?ows to the power sensor preventing the
instrument from being damaged and allowing the performance assessment of the ampli-
?er.

? Coupler is an additional component, utilized to sample part of the signal that is going
to be measured by the power meter at the same time the waveform is being monitored.

? Low pass ?lter is here used to ensure that only the fundamental component is being
measured by the power sensor.

? Spectrum and time domain analyzer is used to check if the desired stimuli of the DUT
has the correct waveform, guaranteeing that no waveform distortion is caused by the
automatic leveling control (ALC) of the Signal Generator.

? Power sensor B is part of the measurement system that provides the uncorrected infor-
mation about the Pout, magnitude.

Figure 3.4: Functional diagram of the system load block.

35



3.3.3 Load tuner

The passive tuners are typically of the slide screw type. They are usually composed by
a slab line enclosed by two parallel ground planes with a centred main line and a re?ective
element (a conductive 'probe') [32]. When this probe is fully retracted the tuner presents an
line impedance of approximately 50 ?.

Likewise a stub, when the probe moves closer to the line, a capacitive e?ect is inserted.
As a result the impedance presented by the tuner is modi?ed, corresponding to the length of
line between the probe and the tuner input.

As the probe position changes along the vertical direction, it modi?es the presented re?ec-
tion coe?cient magnitude. Alternatively, any movement along the longitudinal axis modi?es
the presented phase of the re?ection coe?cient.

The load tuner is the element present in the output matching network that is responsible to
its recon?guration. This makes the ?L controllable, only by setting the tuning probe position
along the longitudinal and vertical axes of the slab line.

The tuner model MT981EU has a carriage structure that supports 2 probes, allowing a
vertical movement of this re?ective element along the line, which is automatically controlled
by precise stepper motors.

Figure 3.5: Illustrate how the re?ection coe?cient of a slide screw tuner change, with a conduc-
tive probe moving in two directions within a slabe line, being represented on the admittance
smith chart.

36



3.4 Characterization of the load-pull system

The characterization of the load-pull system consists in creating one-port or two-port s-
parameter ?les of each passive element presented in the source and load blocks. As a results,
a ?le with .tun extension, is created. This ?le contain the tuner characterization, which is
composed by the set of s-parameters for each of the tuner mechanical positions and frequencies,
respectively.

During the measurements it is known that information about the power is 'uncorrected',
requiring a characterization of the system to mathematically remove the inherent losses of the
input and output network. As result the e?ective Pin and Pout are achieved. For such purpose,
a proper calibration of the VNA is required before any system component characterization. It
removes all systematic errors arising from the inherent directivity, mismatch and cross-coupling
of the measurement equipment.

For this reason, I decided to explain how the s-parameters of system components, tuner and
?xture are obtained. In conclusion, the VNA calibration and system veri?cation are described,
where all the passive elements indicated by the dotted arrow in Fig. 3.2 were characterized
by the short-open-load-thru (SOLT) VNA Calibration method.

3.5 Characterization of the system components

The reference planes of the characterized source block are shown in Fig. 3.3, by the ports
1, 2 and 3. The reference planes of the load block are the input port of the attenuator, output
port of the coupler and the output ?lter port, shown in Fig. 3.4.

Each passive element of the source and load blocks were individually characterized, allowing
them to be integrated in their respective blocks. As an implementation tool, the microwave
o?ce (MWO) was utilized to cascade the obtained s-parameter blocks, resulting in a new
block for the input network and another for the output network.

The s-parameters shown in Fig. 3.6 are the result of a 3-port conversion into a 2-port
of the input network characterization, which the conversion of output and input network are
explained in Appendix D.1 and D.2, respectively.

Figure 3.6: Equivantel 2-port of the input network of the LPS.

37



3.6 Characterization of tuner

The tuner characterization is performed to determine a set of s-parameters, respectively
to each of its mechanical positions at each particular frequency. This information is later on
utilized by interpolation routines in order to synthesize the desired new re?ection coe?cient.

When a certain target impedance is chosen to characterize the ampli?er, it might happen
that this load the impedance falls between pre-calibrated states, as shown in Fig. 3.7. In order
to achieve such level of accuracy, a dynamic-link library (DLL) function is used to interpolate
between the closest pre-characterized impedances and determine the new physical X and Y
mechanical position of the desired impedance and its respective s-parameters. In order to
improve the accuracy, it is necessary to increase the numbers of pre-characterized positions.

Figure 3.7: Interpolation result based on the pre-characterized load impedances.

The replacement of any adapter will require a new tuner characterization. Thus, it is
highly recommended to characterize the tuner without any additional component attached,
such as any bias tee, giving more ?exibility for future changes on the system topology.

Furthermore, the characterization precision is veri?ed by setting the tuner for an arbitrary
impedance near to the centre and then near to edge of the Smith chart over the whole range
of 2? radians phase. This procedure must satisfy the condition in which the error is less
than 0.2% in the magnitude and 0.1 deg in the phase. Any value worse than that indicates a
problem in the calibration and the characterization procedure must be repeated. The goal of
this requirement is to ensure a level of precision around -50dB, which corresponds to a worst
case deviation in the real and/or imaginary part of the re?ection coe?cient of less than 0.003.

38



3.6.1 Characterization of the ?xture

When dealing with high-power device characterization the load-pull system must possess
a mechanism that minimizes the VSWR and, at the same time, enables to synthesize high
re?ection coe?cients, without any risk of damage for the instruments or even the DUT. The
used quarter-wave transformer technique satis?es these requirements allowing to 'pre-match'
the device nearly to its optimum impedance region over the Smith chart.

The thru-re?ect-line (TRL) method of VNA calibration is used for non-coaxial reference
planes such as the DUT microstrip test ?xture. This method presents a better e?ective
directivity, source match and load match compared with the SOLT calibration and helps to
acquire the needed information about s-parameters of each ?xture halves.

The TRL standards are generally easy to fabricate requiring only to know the impedance,
approximately the electrical length of the line standard and the re?ect standard that can be
any high re?ection devices like shorts or opens [33].

3.6.2 VNA calibration and veri?cation

The VNA calibration is a procedure necessary to remove errors presented on the measure-
ment system which are repeatable and usually predictable over time and temperature.

The standard calibration kit utilized in this work, the Agilent 85031B 7mm and the E-Cal
N4431-60008, are only responsible to remove the systematic errors. They allow to perform a
complete SOLT calibration when they are combined with the Unknown-thru calibration, since
some connectors might di?er from each other, as is the case, for example, of the APC 7 mm
and a TYPE(N) 50 connector types. There are three types of measurement errors:

? The systematic errors occur due to imperfections of the test equipment, those er-
rors are caused by directivity, crosstalk, source and load impedance mismatches and
frequency response. The directivity and crosstalk exist due to signal leakage. The
source and load impedance mismatches are directly related with the unavoidable
re?ections in the test set.In addition the frequency response is caused by the de?cient
re?ection and transmission tracking of the test receivers over frequency.

? The random errors presented in the measurement system are usually generated by
the instrument noise (e.g. intermediate frequency (IF) noise ?oor, and the sampler
noise), connector and switch repeatability. The presented noise errors can be reduced
by narrowing the IF bandwidth, increasing source power, or even using trace averaging.

? The drift errors are not removable but still possible to minimize, only by setting a
stable ambient temperature for the test environment.

The veri?cation is performed after the calibration is done, in order to observe if the s-
parameters correspond to the expected ones. As a practical rule, a good calibration holds the
following condition: when a thru connection is tested, the measured magnitude of S21 and
S12 must to be as close as possible to 0 dB and the phase of S11 should be at a mili-degree of
resolution, meaning that the ports 1 and 2 are matched to 50 Ohms.

The S21 isolation is obtained by connecting two loads, one on port 1 and one on port 2.
Next, it is measured the magnitude of S21 and check if it is less than the speci?ed isolation
(typically less than ?80 dB). Another typical procedure is to leave the source port 1 open and
verify if the S11 magnitude is near to 0 dB (within about +-1dB) [34].

39



3.7 MATLAB routines

In this section I will explain the main details regarding the MATLAB routines implemen-
tation. The source code developed in this work can be found in the Appendix A.

3.7.1 Pre-characterization

This routine is responsible to store in memory the s-parameters, X and Y mechanical
positions and frequency at a user-de?ned number of points. Another important requisite for
this routine is to have an even distribution of characterized impedances over the Smith chart,
so that the future interpolated impedances exhibit similar accuracies.

3.7.2 Absolute power calibration

The absolute power calibration routine is mainly used to correct the removal of the inherent
losses of the LPS from the measured data, but it is also used as a resource to determine the
driver gain and, thus, control the available source power.

The so-called ?Gt factor is utilized to account for the error in the predicted losses, con-
sisting in the comparison between measured and predicted transducer gain, Gt. This method
involves measuring the gain of our system with all LPS components including the DUT mi-
crostrip ?xture as thru connection, where the centre of the ?xture is used as reference plane
while the tuner is swept through a load-pull [35].

The prediction of Gt is based on the s-parameters that constitute the input and output
network of the load-pull system characterization, including the DUT test ?xture, and is given
by the following equation [36].

Gt =
PL
Pavs

=
1 ?|?S|2

|1 ? ?IN ?S|2
|S21|2

|?L|2

|1 ?S22?L|2
(3.1)

where, the ?S and ?L are the respectively source and load blocks that are seen by the DUT
microstrip ?xture at its centre. The shown s-parameters belongs to the DUT ?xture, and the
?IN input re?ection coe?cient is obtained with the following equation:

?IN = S11 +
S21S12?L
1 ?S22?L

(3.2)

The used DUT test ?xture for the absolute power calibration is a thru connection and its
s-parameters are represented by the following expression.

STHRU =

(
S11 S12
S21 S22

)
=

(
0 1
1 0

)
(3.3)

by replacing the terms of the equation 3.3 into 3.2 results in

?IN = ?L (3.4)

and consequently it simpli?es the equation 3.1, where Gt becomes

Gt =
(1 ?|?S|2)(1 ?|?L|2)

|1 ? ?L?S|2
(3.5)

40



Furthermore, the Pout is determined through a proper calculation of the incident and
re?ected travelling waves at the DUT reference plane that is obtained through a proper char-
acterization of each of the shown blocks represented in Fig. 3.8. In addition, ?pwr represents
the re?ection coe?cient imposed by the power meter B, acting as a load termination of the
total two-port network. This network and its characterized s-parameters provide the relation
between the power that is being read by the power meter and the Pout of the device as shown
in the following equations.

Figure 3.8: Representation of the output network of the developed load-pull system.

The power meter readings correspond to the re?ected travelling wave seen by the output
network, b2. ?

???
S11total S12total ?1 0
S21total S22total 0 ?1

0 ?1
?pwr

0 1

0 0 0 1

?
???
?
???
a1
a2
b1
b2

?
??? =

?
???

0
0
0
K

?
??? (3.6)

?
???
S21total S22total 0 ?1

0 ?1
?pwr

0 1

S11total S12total ?1 0
0 0 0 1

?
???

? ?? ?
A

?
???
a1
a2
b1
b2

?
???

? ?? ?
?

=

?
???

0
0
0
K

?
???

????
B

(3.7)

The coe?cients represented by ? are obtained by the ratio of A/B, which is presented by
the following equations:

a1 = K
1 ?S22total ?pwr

S21total
(3.8)

a2 = K?pwr (3.9)

b1 = K
(S11total ? ?pwr?)

S21total
where, ? = S11totalS22total ?S21totalS12total (3.10)

b2 = K =

?
20

pwrmeas?30
10 ,where? = 0. (3.11)

Thus, the Pout at the output of the DUT reference plane is given by following equation :

Pout(dBm) = |a1|2 ?|b1|2 = 10log10
(

1

2
|a1|2(1 ?|?L|2)

)
+ 30 (3.12)

,where ?L is given by Eq. 2.16 and its deduction is presented in the next section as well.

41



3.7.3 Load-pull measurements

Firstly, the tuner moves to the desired impedance, next the power supply is switched on
feeding the DUT. Soon after, the RF output power of the VSG is turned on and, ?nally, the
measurements are performed.

In the load-pull measurements, it was extracted absolute values of gain and e?ciency,
but it is simply presented its normalized values, because the absolute values are con?dential.
Moreover, the type of stimuli is classi?ed, highlighting that is not the conventional CW.

Before the gallium nitride (GaN) microwave transistor characterization no matter which
target impedance is chosen, a Pin, that conducts the device to its compression region is
unknown. For this reason, it is necessary to utilize a safe level of Pin, commonly known as
input back-o?, in order to guarantee that the device does not go directly to its compression
region, which can damage the DUT instantaneously.

One of the 114 loads utilized in the DUT characterization is the ZL = 6.8895+j2.8285 ?.
A VGS = -2.66 V, VDS = 50 V, IDS = 1.395 mA at the frequency of 1800 MHz gives the result
shown in Fig. 3.9 that is normalized by its maximum gain and drain e?ciency.

Moreover, the RF output power is swept, step-by-step, recording a user-de?ned number of
data points at each iteration. The routine is responsible to change the maximum peak power
of the signal until the device meets a gain compression value of 3dB. In case this desired gain
compression is not achieved, the MATLAB routine is prepared to store null values for the FoM
where the desired compression is not achieved. Next, the tuner moves to another mechanical
position and this same measurement procedure is repeated.

Figure 3.9: Normalized load-pull results obtained in the characterization of one load
impedance, displaying the achieved gain(dB) and e?ciency as function of Pout.

The other loads utilized in the DUT measurements can be found in Appendix C.

42



3.8 Automated load-pull system veri?cation

The system veri?cation is systematically performed and repeated, until the desired preci-
sion is achieved. The ?ow-chart in Fig. 3.1 illustrates how the tuning setup must be done.
This section is dedicated to prove the reliability of this setup and present the achieved results.

The veri?cation process starts with the tuner repeatability check, whose achieved results
go down to around -50dB, which guarantees a precision of at least 3 decimal places.

Moreover, the system components were assembled and tested in two steps. First, only the
tuner and then the load block and test ?xture were tested. In addition, a prediction test is
performed, which is similar to the repeatability test. This process consist in cascading the
system s-parameter blocks and calculating what is going to be the ?L seen by the DUT.

For the prediction check, a test ?xture was designed and created using a SubMiniature ver-
sion A (SMA) connector at the input and the output. The ?xture is composed by a 50 ? line
with a capacitor placed in middle of the line. This ?xture will cause an impedance transfor-
mation, shifting the reference plane, which allows to understand and verify how precisely the
impedance transformation can be done and how well the impedances can be measured by the
VNA. In order to prove the reliability of this system, the impact of precision measurements
and load-pull data results are also shown.

3.8.1 Repeatability test

As mentioned before in this work, the repeatability test is performed under two di?erent
scenarios. The ?rst one is only intended for the tuner alone and its results can be seen in
Fig. 3.10. The last repeatability test, which has all the output network elements assembled, is
already a prediction test. The ?Total is the input impedance present at the transistor output
terminal and results from the cascaded test ?xture, tuner and load block. For the device
characterization and prediction test the selected frequency was 1.8GHz.

Figure 3.10: Obtained results of the repeatability check test at 1.8 GHz.

43



? ?TUN Repeatability - Tuner

The calculation of ?TUN is equal to the ?IN of equation 3.2, it is veri?ed that ?TUN ?
S11 when the VNA is calibrated. The VNA ports placed at the tuner reference plane acts
as 50? source and load impedances, respectively. Thus, the ?loadblock shown in Fig. 3.11 is
approximately zero, ?loadblock ? 0 .

Figure 3.11: Characterization and tuner repeatability setup.

The high density of impedance states is required to achieve a good accuracy level, when
using the impedance interpolation functions.

Figure 3.12: Displayed repeatability test over the Smith chart.

Figure 3.12 shows the repeatability results displayed over the Smith chart, where the red
symbol '*' indicates the second measurement and the blue 'o' indicates the ?rst measurements.
As can be observed, both symbols overlap, which graphically represent an achieved accuracy
of at least -50dB, using 50 ? as reference impedance.

44



? ?TUN Repeatability - Output Network

For the prediction test it is necessary beforehand to cascade all the s-parameters of the output
network. As such, the following steps are described.

Figure 3.13: Scheme of the outputnetwork repeatability test.

First, the S-matrix of each element of the output network is transformed to a ABCD-
matrix, as shown below:[

A D
B C

]
=

[
(1+S11)(1?S22)+S12S21

2S21
ZO

(1+S11)(1+S22)?S12S21
2S21

1
ZO

(1?S11)(1?S22)?S12S21
2S21

(1?S11)(1+S22)+S12S21
2S21

]
(3.13)

Then, the DUT test ?xture, the tuner and load block are cascaded by a simple matrix
multiplication, resulting in a new ABCD-matrix.[

Atotal Dtotal
Btotal Ctotal

]
=

[
Afix Dfix
Bfix Cfix

]
.

[
Atuner Dtuner
Btuner Ctuner

]
.

[
Aloadblock Dloadblock
Bloadblock Cloadblock

]
(3.14)

Next, this ABCD-matrix is converted back to an S-matrix that contains the whole output
network, as shown in the example below.[

S11total S12total
S21total S22total

]
=

[
Atotal+Btotal/ZO?CtotalZO?D

Atotal+Btotal/ZO+CtotalZO+Dtotal

2(AtotalDtotal?BtotalCtotal)
Atotal+Btotal/ZO+CtotalZO+Dtotal

2
Atotal+Btotal/ZO+CtotalZO+Dtotal

?Atotal+Btotal/ZO?CtotalZO+Dtotal
Atotal+Btotal/ZO+CtotalZO+Dtotal

]
(3.15)

As a result, a new 2 port s-parameters block is obtained and by using it in the ?IN formula,
the presented ?L at the output terminal of the ampli?er can be properly calculated as follows.

?L = S11total +
S12totalS21total ?pwr

1 ?S22total ?pwr
(3.16)

This ?tun is the required ? at the tuner reference plane as shown in Fig. 3.8. It is typically
used by the MLibTuners library functions in order to predict the Stun-parameters and estimate
the new mechanical positions required to synthesize a certain target impedance.

The STotal parameters are utilized to de-embed the output network from the measurements.
A given example is shown in Fig. 3.17 where the red '*' represents ?tun and the blue 'o' circles
the ?L, in this case, the target impedances.

45



3.8.2 Impact of precision measurements

This section reveals the matter of a pre-matching technique and how it contributes to the
maximum achievable re?ection coe?cient. As it can be seen in Fig. 3.12, the tuner exhibits
a good repeatability for the ?rst 3000 load impedances, once the VSWR &gt; 1.5:1.

For the loads closer to 50 ?, the presented signal-to-noise ratio (SNR) required to a proper
measurement of the re?ected power wave is diminished, due to the match conditions, existing
between the VNA ports and DUT. Both the noise ?oor and the sampler noise contribute to
this degradation. In order to diminish, or possible overcome, this problem, it is normal to use
a lower IF, to use averaging or to increase the VNA source power.

Another important constraint regarding the imprecision of the VNA measurements is due
to the very low-loss reactive elements, such as the tuner, being less accurate for the load which
exhibits a maximum re?ection coe?cient greater than 0.8. These problems can be overcome
by using some impedance technique transformation that enables the synthesis of the same
desired impedance requiring a low VSWR.

Figure 3.14: Pre-characterization magnitude and phase error results.

The next two ?gures reveal how important it is the VNA calibration performance. As it can
be seen in Fig. 3.15, the black dotted loads exhibit low values of repeatability approximately
-45dB. Since these loads at the tuner reference plane are mostly closer to 50 ?, this usually
occurs when the calibration is not properly performed and becomes even worst after usage of
a test ?xture. As such the capability to predict load impedances is lost, and the corresponding
load-pull results become meaningless.

46



Another important aspect related to the non-uniform repeatability distribution is that the
interpolation algorithm will not preserve the same performance as the repeatability, even if
the number of pre-characterized states increases, as the example shown in Fig. 3.15.

Figure 3.15: Precision of poorly calibrated prediction loads.

For the second test displayed in Fig. 3.15, the required corrections on the VNA cali-
bration process were applied and the target loads exhibit almost the same accuracy as the
tuner repeatability, which is around -50 dB. This result will guarantee a correct and precise
impedance seen by the DUT, and so it is the one that I decided to use in the load-pull mea-
surements, which shows a uniformly accurate load characterization that provides meaningfully
interpolated target results with a desired ?delity.

Figure 3.16: Precision of the well performed prediction loads.

47



3.8.3 Target impedances

For a chosen set of target load impedances, the interpolation algorithm determines a new
set of mechanical positions and their respective s-parameters based on already characterized
output network shown in Fig. 3.8, taking also into account half of the test ?xture of the DUT
and output block. In the Fig. 3.17, target loads at the ?xture ?ange plane are represented
by blue 'o' points while the red '*' ones represent the required impedances at the tuner ?ange
plane.

Figure 3.17: Estimated tuner impedances based on target impedances for the DUT charac-
terization.

The new mechanical positions are obtained by inverting the similar input re?ection coef-
?cient formula shown in equation 3.16 so that ?tun becomes a function of ?L:

?tun =
?L ?S11fix

?LS22fix ?S11fixS22fix + S12fixS21fix
(3.17)

It is important to notice that ?IN corresponds to the ? at the DUT output, the s-
parameters are the test ?xture ones and the ?L is the equivalent ?IN at the tuner reference
plane which is attached to the ?xture.

48



3.8.4 Load-pull results

After the proper absolute power calibration and system characterization are discussed, the
achieved results of the load-pull measurements of a certain GaN microwave transistor is shown
in Fig. 3.18. They contain the contours of load-pull displayed over the Cartesian plane, also
called Z-plane, in Fig. 3.18 and Fig. 3.19 presents these same results on the Smith chart.

Figure 3.18: Load-Pull contours at the Z-plane.

The obtained load-pull contours are displayed over the Smith chart, where the black sym-
bols 'x' indicate the target impedances, the blue contours denote Pout, at 3dB gain compression
point and the red curves ?D. The information presented in Fig. 3.16 shows the load-pull am-
pli?er characterization at the 50? reference plane.

Figure 3.19: Load-Pull contour at 3dB gain compression point.

49



By inspecting the load-pull results the optimum load impedances in terms of e?ciency and
power at 3dB of gain compression are the following:

ZL = 4.1459 + j1.0265?,Pout3dB (3.18)

ZL = 3.299 + j6.270?,Draineff3dB (3.19)

Figure 3.20: Load-Pull contour at 3dB gain compression point where Z0 = 10 ?.

Figure 3.21: Final bench at Huawei Sweden of an automated tuner based load-pull system.

50



Chapter 4

Conclusion and Future Work

This chapter presents the main important aspects of this dissertation as well as its con-
clusions. In addition, some ideas are given that might be used as future work.

4.1 Conclusion

The strong motivation of this dissertation consists in the fact that, along the years, the
industry of telecommunications has found the necessity to optimize the time spent in the
microwave transistor characterization process in order to quickly and accurately design a
PA that meets the next generation requirements of power, linearity and e?ciency. That
is required due to the data tra?c, user capacity and base station covering range, which is
intensively increasing from one generation of a cellular base station to another. Thus, the
main objective of this dissertation was to build an automated load-pull systems at HUAWEI
Technologies AB, similar to the one that was previously manually performed. In this sense,
a concise study about the load-pull methods and techniques was given, which was further
utilized in the system design.

After getting the knowledge about the most important concepts, regarding load-pull the-
ory, an automated load-pull system was built, implemented and validated. The design allows
to understand the role played by each component of the load-pull system and how to proceed
the characterization and integration of the whole system. Therefore, a systematic proce-
dure was established using applied wave research (AWR)/MWO to support the developed
MATLAB routines utilized in the characterization, absolute power calibration and load pull
measurements.

The traditional load-pull technique implemented in this work utilizes a routine for the tuner
characterization, besides of dedicated DLL for the control of the step motors and interpolation
algorithms of the MT981EU. This makes possible to recon?gure the output network based
on the characterization beforehand of the system, which enables the prediction of the seen
impedance by the DUT and to accurately read the power at the DUT input and output ports.

During the practical tests, it was found that the presented repeatability of the MT981EU
was about - 60dB and even when attached with the rest of the system components it was
maintained. This ?lls the requirement of accuracy to reproduce precisely a certain impedance
state at the DUT reference plane, while assisting its performance assessment [37].

It was understood that a proper absolute power calibration and system veri?cation ensure
that most of the loss deviation on the predicted network losses is ?xed, avoiding possible

51



discrepancies in the presented drain e?ciency.
As a ?nal result, the load-pull measurements of the developed systems needs only 2 hours

to measure 114 loads of a certain transistor, being not even comparable to the manual system
that was built in Aveiro Univeristy which needs about 14 hours of handwork to measure a
similar device with the same quantity of target impedances.

The main goal of this work was successfully achieved where a well-de?ned procedure for
a system characterization and calibration was done, as well as the load-pull measurement
routines. Once all calibrations were ?nished, it was only necessary to introduce the target
parameters for a certain DUT such as VGS, VDS, frequency, desired compression and a set
of target re?ection coe?cients that should be used for its characterization. The routine per-
forms the measurements automatically saving the results in a proper manner for a future post
processing, PA design and non-linear model validation.

4.2 Future work

As a future work, it is recommended to utilize a source tuner in addition to the already
presented topology that was developed in this work. It has the purpose to optimize the
overall performance of the implemented traditional load-pull system allowing a proper power
gain veri?cation that is increased due to the connectors and tuner repeatability.

Another advice would be the change from the traditional to the VNA measurement based
topology granting the correct reading of the presented impedance and Pin being injected at
the DUT input, enhancing the accuracy of the obtained results in terms of PAE and Power
Gain.

Moreover, the harmonic characterization can be added to the system in two di?erent forms
using additional tuners for the second and third harmonics as needed, or through the active
injection of the signal that is going to emulate the harmonic re?ection coe?cient. This active
injection might require less power at the harmonic than at the fundamental, which reduces
the cost of power ampli?ers with high power capabilities.

In addition, the strategy to record the generated data can be optimized, providing an
easier access to the result and it can be integrated in the MWO/AWR scripts speeding up
the process of the artful conception of a PA, reducing the time to design an PA and avoiding
extensive search of the recorded data.

52



Bibliography

[1] G. Simpson, A Beginner's Guide To All Things Load Pull or Impedance Tuning 101
(5A-062). Maury Microwave Corporation, March, 2015.

[2] J. Hoversten, M. Roberg, and Z. Popovi¢, ?Harmonic load pull of high-power microwave
devices using fundamental-only load pull tuners,? in Microwave Measurements Conference
(ARFTG), 2010 75th ARFTG. IEEE, 2010, pp. 1?4.

[3] Z. Wang, Envelope Tracking Power Ampli?ers for Wireless Communications. Artech
House, 2014.

[4] J. Sevic, ?Introduction to tuner-based measurement and characterization,? Maury Tech-
nical Data 5C-054, 2004.

[5] F. M. Ghannouchi and M. S. Hashmi, Load-pull techniques with applications to power
ampli?er design. Springer Science &amp;amp; Business Media, 2012, vol. 32.

[6] R. S. Tucker and P. D. Bradley, ?Computer-aided error correction of large-signal load-pull
measurements,? IEEE transactions on microwave theory and techniques, vol. 32, no. 3,
pp. 296?300, 1984.

[7] P. D. Bradley and R. Tucker, ?Computer-corrected load-pull characterisation of power
mesfet's,? in 1983 IEEE MTT-S International Microwave Symposium Digest, 1983, pp.
224?226.

[8] F. Microwave, ?Computer controlled microwave tuner,? - CCMT, Product Note 41, Jan,
1998.

[9] S. Bensmida, E. Bergeault, G. I. Abib, and B. Huyart, ?Power ampli?er characterization:
An active load-pull system based on six-port re?ectometer using complex modulated
carrier,? Microwave Theory and Techniques, IEEE Transactions on, vol. 54, no. 6, pp.
2707?2712, 2006.

[10] D.-L. Lê and F. M. Ghannouchi, ?Source-pull measurements using reverse six-port re?ec-
tometers with application to mesfet mixer design,? Microwave Theory and Techniques,
IEEE Transactions on, vol. 42, no. 9, pp. 1589?1595, 1994.

[11] R. Tuijtelaars, H. Westra, and G. Sutorius, ?Power ampli?er design and load-pull mea-
surements in practice.? in Agilent technologies and BSW, 2013.

[12] F. Microwave, ?Tuner operation basics,? Dec. 23 2010. [Online]. Available:
http://www.focus-microwaves.com/sites/default/?les/TunerOperationBasics.pdf

53

http://www.focus-microwaves.com/sites/default/files/TunerOperationBasics.pdf


[13] M. M. Corporations, ?Slide screw tuner,? Technical Data, 2G-035A, Feb, 1998.

[14] F. Microwaves, ?Electronic tuners (ets) and electromechanical tuner (emt) ? a critical
comparison,? Technical Note, Aug, 1998.

[15] C. Woodin and D. Wandrei, ?High power solid state programmable load,? Jan. 4 1994, uS
Patent 5,276,411. [Online]. Available: https://www.google.com.ar/patents/US5276411

[16] R. Tuijtelaars, ?Overview of device noise parameter measurement systemse.? in BSW
TestSystems &amp;amp; Consulting bv. VDE/ITG, Dec, 2001.

[17] M. Microwave, ?Measurement and modeling device characterization solu-
tions,? Dec. 23 2015. [Online]. Available: https://www.maurymw.com/pdf/
MAURY-CATALOG-COMPONENTS.pdf

[18] P. Colantonio, F. Giannini, and E. Limiti, ?High e?ciency rf and microwave solid state
power ampli?ers,? 2009.

[19] R. Hajji, F. M. Ghannouchi, and R. G. Bosisio, ?Large-signal microwave transistor mod-
eling using multiharmonic load-pull measurements,? Microwave and Optical Technology
Letters, vol. 5, no. 11, pp. 580?585, 1992.

[20] S. C. Cripps, Advanced techniques in RF power ampli?er design. Artech House, 2002.

[21] R. B. Stancli? and D. Poulin, ?Harmonic load-pull,? in 1979 IEEE MTT-S International
Microwave Symposium Digest, 1979, pp. 185?187.

[22] F. Microwave, ?Comparing harmonic load-pull techniques with regards to power-added
e?ciency (pae),? Application Note 58, May, Tech. Rep., 2007.

[23] B. Hughes, A. Ferrero, and A. Cognata, ?Accurate on-wafer power and harmonic mea-
surements of mm-wave ampli?ers and devices,? in Microwave Symposium Digest, 1992.,
IEEE MTT-S International. IEEE, 1992, pp. 1019?1022.

[24] C. Arnaud, J.-L. Carbonero, J.-M. Nebus, and J.-P. Teyssier, ?Comparison of active
and passive load-pull test benches,? in ARFTG Conference Digest-Spring, 57th, vol. 39.
IEEE, 2001, pp. 1?4.

[25] M. S. Hashmi, A. L. Clarke, S. P. Woodington, J. Lees, J. Benedikt, and P. J. Tasker,
?An accurate calibrate-able multiharmonic active load?pull system based on the envelope
load?pull concept,? Microwave Theory and Techniques, IEEE Transactions on, vol. 58,
no. 3, pp. 656?664, 2010.

[26] A. P. Ferrero and V. Teppati, ?Experimental comparison of active and passive load-pull
measurement technologies,? -, 2000.

[27] S. Dudkiewicz, ?Hybrid-active load pull with pna-x and maury microwave,? Agilent Tech-
nologies, Inc 2012.

[28] F. M. Ghannouchi, M. S. Hashmi, S. Bensmida, and M. Helaoui, ?Loop enhanced passive
source-and load-pull technique for high re?ection factor synthesis,? Microwave Theory
and Techniques, IEEE Transactions on, vol. 58, no. 11, pp. 2952?2959, 2010.

54

https://www.google.com.ar/patents/US5276411
https://www.maurymw.com/pdf/MAURY-CATALOG-COMPONENTS.pdf
https://www.maurymw.com/pdf/MAURY-CATALOG-COMPONENTS.pdf


[29] J. Flucke, P. Heymann, A. Liero, and W. Heinrich, ?Rf-measurements of packaged broad-
band power transistors,? ITG-Fachbericht-GeMIC 2008, 2008.

[30] W. Sha, W. Xianliang, H. Zhixiang, C. Mingsheng, and V. Zhurbenko, ?The high-order
symplectic ?nite-di?erence time-domain scheme: Passive microwave components and an-
tennas,? 2010.

[31] M. Microwave, ?Mt964 load pull test ?xtures,? [Accessed 23 12 2015]. [Online]. Available:
https://www.maurymw.com/pdf/datasheets/4T-005.pdf

[32] V. Teppati, A. Ferrero, and M. Sayed, Modern RF and microwave measurement tech-
niques. Cambridge University Press, 2013.

[33] J. Fleury and O. Bernard, ?Designing and characterizing trl ?xture calibration standards
for device modeling,? Applied Microwave and Wireless, vol. 13, no. 10, pp. 26?55, 2001.

[34] A. technologies, ?Agilent 10 hints for making better network analyzer measurements,? 25
Oct 2001. [Online]. Available: http://cp.literature.agilent.com/litweb/pdf/5965-8166E.
pdf

[35] B. D. Huebschman, ?Calibration and veri?cation procedures at army research laboratory
(arl) for the focus microwaves load pull system,? ARL-TR-3985, Nov 2006.

[36] M. Microwave, ?Theory of load and source pull measurement,? Maury Microwave Corpo-
ration, vol. 27, 1999.

[37] J. Sevic, ?Basic veri?cation of power load-pull systems,? Maury Microwave Corp., Appli-
cation Note 5C-055, Ontario, CA, 2004.

55

https://www.maurymw.com/pdf/datasheets/4T-005.pdf
http://cp.literature.agilent.com/litweb/pdf/5965-8166E.pdf
http://cp.literature.agilent.com/litweb/pdf/5965-8166E.pdf


56



Appendix A

MATLAB Routines

A.1 Pre-Characterization

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Thesis: "Fully?Automated Load?Pull System Based on Mechanical Tuners" %%
% HUAWEI / IT / University of Aveiro %
%??????????????????????????????????????????????????????????????????????????????%
% Description : Main script of tuner characterization %
% Tuner Model : MT981EU10:3170 (Maury) %
%??????????????????????????????????????????????????????????????????????????????%
% Creator : Alison Willian Pereira (awx281679) %
%??????????????????????????????????????????????????????????????????????????????%
% Revision History: %
% Name Date Description %
% awx281679 20150412 Created and initial Revision. %
% awx281679 20150521 Version 2.0 %
%??????????????????????????????????????????????????????????????????????????????%
% Freq_start: 1.8 GHZ Freq_stop: 1.8 GHZ N_points 3000 Cal_set: 1 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
main_dir = 'D:\ALPS\Routines\' ;
cd( strcat(main_dir,'MT981EU10_characterization\')) ;
lp_func = strcat('D:\ALPS\Routines\','aux_tun_charac\') ;
addpath(genpath( lp_func )) ;
addpath(genpath( strcat(main_dir,'\Driversdir_drivers\'))) ;
config = fg_getconfig_v3 ;
handle_pna = config.Instruments.Vector_Analyzer.handle ;

%% Calibration setup
AgN5230C_Setup( handle_pna,'system','delete_all_measurements' ,' ') ;
AgN5230C_Setup( handle_pna,'system','preset',' ') ;
clrdevice( handle_pna) ;
fg_pna_user_setup( handle_pna) ;
ocs_callset = 'cset1.cst' ;
AgN5230C_Setup( handle_pna,'memory','load',ocs_callset) ;
pause(3) ;
AgN5230C_conf_read_maury(handle_pna) ;

%% Set the storage directory folder
is_filename_tun = strcat(lp_func,'\dir_tun\8CELL_Last_shot.tun') ;
share_path = strcat('.\dir_load_pull\dir_measurements',...

'\AWPTST5152015_tun\HUAWEI_MT981EU10_CAL_MEAS\') ;

57



is_fname_vna = '\dir_load_pull\dir_measurements\AWPTST5152015_tun\' ;
i_call_set = 1 ;

%% Tuner initialization ? MT981EU10
MT981EU10_Setup('MLibTuners','load_libraries','') ;
MT981EU10_Setup('MLibTuners','init_setup','') ;
MT981EU10_Setup('MLibTuners','init','') ;

%% Load?Tun File
oct_tunf = tun_to_mat(is_filename_tun) ;
freqs = oct_tunf.data.freq ;

%% Set Paths
shareDay_path = strcat(share_path,datestr(now,'yyyy_mm_dd')) ;
file_out = strcat(shareDay_path,'\',datestr(now,'yy_mm_dd'),...

'?',datestr(now,'HH_MM'),'_TChar_OUT') ;
%% Create Paths
if(~exist(shareDay_path,'dir'))
mkdir(shareDay_path);

end
%% Short test of single frequency characterization
.
for freq_sel = 1:size(freqs,2)
[oct_measured_data] = ... % OUTPUT: pre_characterization tun structure .
f_tun_characterization_v2( ... % FUNCTION NAME .
handle_pna ,... % INPUT: ih_vna object used during the process .
is_filename_tun ,... % INPUT: fullpath and name of the tun file .
freqs(freq_sel) ,... % INPUT: target frequency for characterization .
freq_sel ) ;

freq = freqs(1,freq_sel) ;
line = sprintf('%1gMHz_ws.mat',round(1000*freq)) ;
save( strcat(file_out,line)) ;
disp( 'Pre?Characterization complete! saving ...') ;
f_write_tun_file( strcat(main_dir,...

strcat(file_out(3:end),line(1:end?4),'.tun')),...
oct_measured_data) ;

end
%???????????????????Auxiliar pre?characterization function?????????????????????%

function ...
[oct_tunfile] = ... % OUTPUT: pre_characterization tun structure.
f_tun_characterization_v2( ... % FUNCTION NAME.
handle_pna ,... % INPUT: ih_vna object used during the process.
is_filename_tun ,... % INPUT: fullpath and name of the tun file.
ic_sel_freq ,... % INPUT: target frequency for characterization.
freq_sel )

%% 1Âž? Load .tun file with the mechanical position data.
fct_tundemo = tun_to_mat(is_filename_tun) ;

%% 2Âž ? Load the mech_pos of the frequency to be pre?characterized.
crv_mechpos = fct_tundemo.data.mec_pos(1,freq_sel).data(:,1:3) ;

%?????????????????????????????????????????????????????????????????????????
SmithChart(0); hold on;

%?????????????????????????????????????????????????????????????????????????
set(gcf,'units','normalized','outerposition',[0 0 1 1]) ;

oct_tunfile.info.Method = fct_tundemo.info.Method ;

58



oct_tunfile.info.Name = fct_tundemo.info.Name ;
oct_tunfile.info.Model = fct_tundemo.info.Model ;
oct_tunfile.info.Date_Time = strcat('Date: ',sprintf(date),...

'Time: ',datestr(now,'HH:MM:SS')) ;
oct_tunfile.info.Embedding = fct_tundemo.info.Embedding ;
oct_tunfile.info.start = fct_tundemo.data.freq(1,freq_sel) ;
oct_tunfile.info.stop = fct_tundemo.data.freq(1,freq_sel) ;
oct_tunfile.info.numfreq = 1 ;

%% Creates xxx.Data branch of the structure
oct_tunfile.data.freq = ic_sel_freq ;
oct_tunfile.data.def_gamma = fct_tundemo.data.def_gamma ;
oct_tunfile.data.positions = fct_tundemo.data.positions(freq_sel) ;
AgN5230C_Setup(handle_pna,'system','delete_all_measurements',' ') ;
AgN5230C_Setup(handle_pna,'system','preset',' ') ;
pause(3) ;

%% Load call set of the VNA calibration.
ocs_callset = 'cset1.cst' ;
AgN5230C_Setup( handle_pna,memory','load',ocs_callset) ;
AgN5230C_conf_read_maury(handle_pna) ;

%% Set a desired frequency
AgN5230C_Setup( handle_pna,'user','f_sel_freq',ic_sel_freq) ;

%% 3Âž ? Wait the VNA be read
for ind = 1:oct_tunfile.data.positions
MT981EU10_Setup('MLibTuners','move_tuner' ,crv_mechpos(ind,1:3)) ;
SPM = AgN5230C_s2p_read(handle_pna) ;
s11_cp = SPM(1)+1i.*SPM(2) ;
plot(s11_cp ,'*r') ;
legend( sprintf('s11: %1.4g j%1.4g ',SPM(1),SPM(2)) ,...

sprintf('s21: %1.4g j%1.4g ',SPM(3),SPM(4)) ,...
sprintf('s12: %1.4g j%1.4g ',SPM(5),SPM(6)) ,...
sprintf('s22: %1.4g j%1.4g ',SPM(7),SPM(8))) ;

drawnow ;
crv_spm_total(ind,:) = SPM ;
end

%% Creates xxx.Info branch of the structure
oct_tunfile.data.mp_sparam = [crv_mechpos(:,:) crv_spm_total] ;

%% End
disp('Measurement finished !!!') ;
figure(1) ;
pause(2) ;
close(figure(1)) ;
end
%??????????????????????????????????????????????????????????????????????????????%

59



60



A.2 Power Calibration

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Thesis: "Fully?Automated Load?Pull System Based on Mechanical Tuners" %%
% HUAWEI / IT / University of Aveiro %
%??????????????????????????????????????????????????????????????????????????????%
% Description: wb_pwr_calibration v1.0 ? Power Calibration %
%??????????????????????????????????????????????????????????????????????????????%
% Revision History: %
% Name Date Description %
% awx281679 2015\06\25 First run. %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
main_dir = 'D:\ALPS\Routines\' ;
cd( strcat(main_dir,'MT981EU10_pwr_cal\')) ;
addpath(genpath( strcat(main_dir,'MT981EU10_pwr_cal\')) ;

%% ?????????????????????????????????????????????????????????????????????????????
% Loading all the instruments %%
% ??????????????????????????????????????????????????????????????????????????????
config = fg_getconfig_v4 ;
tpwm = config.Instruments.Power_Meter.handle ;
tdca = config.Instruments.Power_Supply.handle ;
tmxg = config.Instruments.Signal_Generator.handle ;
handle_pna = config.Instruments.Vector_Analyzer.handle ;

AgN5230C_Setup( handle_pna,'system','delete_all_measurements' ,' ') ;
AgN5230C_Setup( handle_pna,'system','preset',' ') ;
clrdevice( handle_pna) ;
ocs_callset = 'cset1.cst' ;
AgN5230C_Setup( handle_pna,'memory','load',ocs_callset) ;
pause(3);
AgN5230C_conf_read_maury( handle_pna ) ;
ic_sel_freq = 1.8 ;
AgN5230C_Setup( handle_pna,'user','f_sel_freq',ic_sel_freq) ;

%% ?????????????????????????????????????????????????????????????????????????????
% Tuner initialization setup %%
% ??????????????????????????????????????????????????????????????????????????????
MT981EU10_Setup( 'MLibTuners','load_libraries','') ;
MT981EU10_Setup( 'MLibTuners','init_setup','' ) ;
MT981EU10_Setup( 'MLibTuners','init','' ) ;

% ??????????????????????????????????????????????????????????????????????????????
% Loading characterization and system s?parameters
% ??????????????????????????????????????????????????????????????????????????????
filename = strcat(main_dir,'dir_load_pull\dir_loads\8cell_eff.txt') ;
data = f_read_load_awr_11param(filename) ;
ZLoad = data.R + 1i.*data.jX ;
sloads = z_to_s(ZLoad,50) ;
fix_fname = 'fixture_8cells.s2p' ;
[~,X.sfix] = f_awr_get_s2p_at_freq_sel( fix_fname,ic_sel_freq ) ;
X.sfix_11 = X.sfix(1,1) ;
X.sfix_21 = X.sfix(1,2) ;
X.sfix_12 = X.sfix(1,3) ;
X.sfix_22 = X.sfix(1,4) ;
gin_fix_to_tun =(?X.sfix_11 + sloads)./ ...

((?X.sfix_11.*X.sfix_22)+sloads.*X.sfix_22+X.sfix_12.*X.sfix_21);
sbfix_s2p = 'sma_male_emb_p1.s2p' ;
[~,X.sbfix ] = f_awr_get_s2p_at_freq_sel( sbfix_s2p ,ic_sel_freq ) ;

61



X.sbfix_11 = X.sbfix(1,1) ;
X.sbfix_21 = X.sbfix(1,2) ;
X.sbfix_12 = X.sbfix(1,3) ;
X.sbfix_22 = X.sbfix(1,4) ;
sloads = gamma_x + 1i.*gamma_y ;
gin_f_fix_2_tun = (?X.sbfix_11 + sloads)./ ...

((?X.sbfix_11.*X.sbfix_22)+sloads.*X.sbfix_22+X.sbfix_12.*X.sbfix_21);
gin_dut = X.sbfix_11 + ((X.sbfix_21*X.sbfix_12.*gin_f_fix_2_tun )./ ...

(1?X.sbfix_11.*gin_f_fix_2_tun)) ;
gamma_x = real(gin_f_fix_2_tun) ;
gamma_y = imag(gin_f_fix_2_tun) ;
filename = '15_06_28?18_50_TChar_OUT1800MHz_ws.tun' ;
meas_dir = '...\ AWPTST5152015_tun\HUAWEI_MT981EU10_CAL_MEAS' ;
MT.tuner_number = 0 ;
MT.fname = strcat(main_dir,meas_dir,'\2015_06_28\',filename) ;
MT.tuner_model = 'MT981EU10' ;
MT.freq = ic_sel_freq ;
MT.mec(1:3) = 9500 ;
MT.interp_mode = 1 ; KEY is required.
gamma_out_s1p = 'gamma_out_s1p.s1p' ;
[~,X.gamma_out_s1p] = f_awr_get_s1p_at_freq_sel( gamma_out_s1p , ic_sel_freq ;
MT.gamma_x_termination = (16.4*10^?3) ;
MT.gamma_y_termination = (?5.23*10^?3) ;
MT981EU10_Setup( 'MLibTuners','free_tuner_data' ,MT) ;
MT981EU10_Setup( 'MLibTuners','read_tuner_data_file',MT) ;

% ??????????????????????????????????????????????????????????????????????????????
% Estimating the Mechanical position and s2p for the sloads
% ??????????????????????????????????????????????????????????????????????????????

SmithChart(2);hold on;
for k = 1:size(sloads,1)
MT.gamma_x = gamma_x(k) ;
MT.gamma_y = gamma_y(k) ;
mpos = MT981EU10_Setup('MLibTuners', 'get_tuner_refl_posn',MT) ;
mp(k,1:3) = [mpos.carr mpos.p1 mpos.p2] ;

%plot target imp
plot( gin_fix_to_tun(k),'o');

%plot(tst.data.mec_pos.data(k,4) +1i.*tst.data.mec_pos.data(k,5),'o');
MT981EU10_Setup( 'MLibTuners','move_tuner',[ mp(k,1) mp(k,2) mp(k,3)]) ;
s_aux = AgN5230C_s_read(handle_pna) ;
s_pchar_11(k) = s_aux(1)+1i.*s_aux(2) ;
s_pchar_21(k) = s_aux(3)+1i.*s_aux(4) ;
s_pchar_12(k) = s_aux(5)+1i.*s_aux(6) ;
s_pchar_22(k) = s_aux(7)+1i.*s_aux(8) ;

plot( s_pchar_11(1,k) ,'r*' ); drawnow ;
err(k) = 20.*log10(abs(( gin_fix_to_tun(k)) ...

? s_pchar_11(1,k))) ;
gin(k) = X.sfix_11 + (X.sfix_21.*X.sfix_12.*s_pchar_11(1,k))./ ...

(1 ? X.sfix_22.*s_pchar_11(1,k)) ;
plot(sloads(k),'bo');
plot(gin(k),'r*');

end
err2 = err ;
sgoal = [ s_pchar_11' s_pchar_21' s_pchar_12' s_pchar_22'] ;
% ?????????????????????????????????????????????????????????????????????????????
% Power Calibtraion %%
% ?????????????????????????????????????????????????????????????????????????????

62



addpath( 'D:\ALPS\fpwr_swp_signals' );
fps_lps_signal_fname = 'fps_15_p_30dB' ;
ot_cal = fpwr_swp_pwr_cal_ldmos_config_v4(config,ic_sel_freq,fps_lps_signal_fname);

% ?????????????????????????????????????????????????????????????????????????????
% s?parameters of system components %%
% ?????????????????????????????????????????????????????????????????????????????
gspec_out_s1p = 'gspec_out.s1p' ;
[~,X.gspec_out]= f_awr_get_s1p_at_freq_sel( gspec_out_s1p , ic_sel_freq);
gpwr_b_s1p = 'gpwr_b.s1p' ;

%Power_meter
[~,X.gpwr_b] = f_awr_get_s1p_at_freq_sel( gpwr_b_s1p , ic_sel_freq);
gamma_out_s2p = 'gamma_out_s2p.s2p' ;
[~,X.gamma_out_s2p ]= f_awr_get_s2p_at_freq_sel( gamma_out_s2p , ic_sel_freq);
gamma_c_pwrc_f_t_tun = 'conector_pwr_cal_b_fix_tuner.s2p' ;

[~,X.gamma_c_pwrc_f_t_tun ] = f_awr_get_s2p_at_freq_sel(gamma_c_pwrc_f_t_tun,...
ic_sel_freq);

X.abcd_gamma_c_pwrc_f_t_tun = s_to_abcd([X.gamma_out_s2p(1,1) X.gamma_out_s2p(1,3);
X.gamma_out_s2p(1,2) X.gamma_out_s2p(1,4)],50);

X.abcd_gamma_out = s_to_abcd([X.gamma_c_pwrc_f_t_tun(1,1) X.gamma_c_pwrc_f_t_tun(1,3);
X.gamma_c_pwrc_f_t_tun(1,2) X.gamma_c_pwrc_f_t_tun(1,4)],50);

MT_pcharc = tun_to_mat(MT.fname) ;
X.mp = MT_pcharc.data.mec_pos.data(:,1:3) ;

for k = 1:size(X.s11_t,1)
X.abcd_t(:,:,k) = s_to_abcd([X.s11_t(k,1) X.s21_t(k,1) ;

X.s12_t(k,1) X.s22_t(k,1)],50) ;
X.abcd_gamma_out_total(:,:,k) = X.abcd_gamma_c_pwrc_f_t_tun * X.abcd_t(:,:,k)*...

X.abcd_gamma_out ;
X.gamma_out_total(:,:,k) = abcd_to_s(X.abcd_gamma_out_total(:,:,k),50) ;

X.gin(k) = X.gamma_out_total(1,1,k) +(( X.gamma_out_total(1,2,k).* ...
X.gamma_out_total(2,1,k).*X.gpwr_b)...
./(1? X.gamma_out_total(2,2,k).*X.gpwr_b)) ;

Gp_lin(k) = (1/(1?(abs(X.gin(k))^2))) .* ...
(abs(X.gamma_out_total(2,1,k).^2) .* ...
(( 1? abs(X.gpwr_b).^2) ./ ...
(abs(1?X.gamma_out_total(2,2,k).*X.gpwr_b).^2))) ;

Gp_dB(k) = 10.*log10(Gp_lin(k)) ;

end
figure(2); plot(Gp_dB,'?o');grid on;
SmithChart(0); plot(X.gin,'o');
close all ;

% ??????????????????????????????????????????????????????????????????????????????
% ?????????????? WARNING THIS UPPER IS USED ONLY TO POWER CAL ??????????????????
% ??????????????????????????????????????????????????????????????????????????????

ot_cal.max = 10.1 ;
PAInputLoss = 31.33 ;
OutputLosses_array = ?Gp_dB ; %G21_dB_out;% ?41.5702 ;

% ??????????????????????????????????????????????????????????????????????????????
% Freescale driver
% ??????????????????????????????????????????????????????????????????????????????

63



Gain_driver_offset = 5.67;
PeakPower = 42;
steps = [PeakPower?15:15/2:PeakPower]?36.251496748344728?0.35 ;
OBO_in_pts = 11 ;
dB_comp = 1 ;
max_peak_after_backoff = 0.01 ;

for k = 72:10

OutputLosses = OutputLosses_array(k) ;
MT981EU10_Setup( 'MLibTuners','move_tuner',[ mp(k,1),mp(k,2),mp(k,3)]) ;
MT981EU10_Setup( 'MLibTuners','move_tuner',[ 100 ,9500,9500]) ;

% ?????????????????????????????????????????????????????????????????????????????
aux = 1;
for j = 1:size(steps,2)

ot_cal.AvgPower = steps(j) ;
ot_flps_pcal = fpwr_swp_ldmos_fetch_load( con?fig,ot_cal,PAInputLoss,OutputLosses);
Pout_peak(:,aux)= ot_flps_pcal.PoutdBm ;
A(j) = max(Pout_peak(:,j))
aux = aux +1 ;
s = input('Next','s') ;

end
end
%??????????????????????????????????????????????????????????????????????????????%

64



A.3 Load-Pull Measurements

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Thesis: "Fully?Automated Load?Pull System Based on Mechanical Tuners" %%
% HUAWEI / IT / University of Aveiro %
%??????????????????????????????????????????????????????????????????????????????%
% Description: wb_alps.m ? Automated Load?Pull System ? PA Measurements %
%??????????????????????????????????????????????????????????????????????????????%
% Revision History: %
%??????????????????????????????????????????????????????????????????????????????%
% Name Date %
% awx281679 2015\04\25 First run. %
% awx281679 2015\06\18 Updated. %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all; close all; clc;
%% ?????????????????????????????????????????????????????????????????????????????
% set main path %%
% ??????????????????????????????????????????????????????????????????????????????
config = fg_getconfig_v4 ;
main_dir = 'D:\Tese\Desktop\Msc_LPS\MATLAB_V2\' ;
cd( main_dir );
addpath( strcat(main_dir,'\wb_flps') );
addpath( '.\workbenchs' );
addpath(genpath('D:\Tese\Desktop\Msc_LPS\MATLAB_V2\wb_pwr_calibration\' ));
addpath('D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_func\f_flps\' );
addpath('D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_func\f_r_awr\' );
addpath('D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_func\AgN5230C\',...

'D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_func\',...
'D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_tun\',...
'D:\Tese\Desktop\Msc_LPS\MATLAB_V2\dir_load_pull\dir_drivers\' );

%% ?????????????????????????????????????????????????????????????????????????????
% LPS User Setup %%
% ??????????????????????????????????????????????????????????????????????????????
% filename of the setup. ex: target is the load's to be measured
dut_loads_fname = strcat(main_dir,'dir_load_pull\dir_loads\8cell_eff.txt' );
fixture_fname = 'fixture_8cells.s2p' ;
signal_fname = '1800MHz_ws_v2' ;
fps_lps_signal_fname = 'fps_15_p_30dB' ;

% Folder of the fpwr_swp_directory:
trans = 'G068_8Cell' ;

%% Dut Bias
Vds = 50 ;
Vgs = ?2.66 ;
Ids = 1.395 ;
Imax = 2 ;
ic_sel_freq = 1.8 ;

%% ?????????????????????????????????????????????????????????????????????????????
% Loading all the instruments %%
% ??????????????????????????????????????????????????????????????????????????????
% Init. instr. &amp;amp; load libraries
config = fg_getconfig_v4 ;
tpwm = config.Instruments.Power_Meter.handle ;

65



tdca = config.Instruments.Power_Supply.handle ;
tmxg = config.Instruments.Signal_Generator.handle ;

%% Tuner initialization setup
MT981EU10_Setup( 'MLibTuners','load_libraries','') ;
MT981EU10_Setup( 'MLibTuners','init_setup','') ;
MT981EU10_Setup( 'MLibTuners','init','') ;

%% ?????????????????????????????????????????????????????????????????????????????
% Creating file directories to save data %%
% ??????????????????????????????????????????????????????????????????????????????

dir = 'flps_data\' ;
path = main_dir ;
share_path = strcat(path,dir) ;
shareDay_path = strcat(share_path,trans,'\',...

strcat(datestr(now,'yyyy_mm_dd')) );

file_out = strcat(shareDay_path,'\', datestr(now,'yy_mm_dd'),'\',...
datestr(now,'HH_MM'),trans,'_lpfs_','\' );

file_out2 = strcat(file_out,trans,'_figures\' );
file_out3 = strcat(file_out,trans,'_swp_load_data\' );

if(~exist(file_out,'dir'))
mkdir(file_out) ;

end

if(~exist(file_out2,'dir'))
mkdir(file_out2) ;

end

if(~exist(file_out3,'dir'))
mkdir(file_out3) ;

end
%%?????????????????????????????????????????????????????????????????????????????
% Estimating the Mechanical position and s2p for the sloads %
% ?????????????????????????????????????????????????????????????????????????????
data = f_read_load_awr_11param(dut_loads_fname) ;
ZLoad = data.R + 1i.*data.jX ;
sloads = z_to_s(ZLoad,50) ;
[~,X.sfix] = f_awr_get_s2p_at_freq_sel(fixture_fname,...

ic_sel_freq );
X.sfix_11 = X.sfix(1,1) ;
X.sfix_21 = X.sfix(1,2) ;
X.sfix_12 = X.sfix(1,3) ;
X.sfix_22 = X.sfix(1,4) ;

gin_f_fix_to_tun1 = (?X.sfix_11 + sloads)./((?X.sfix_11.*X.sfix_22) ...
+sloads.*X.sfix_22+X.sfix_12.*X.sfix_21) ;

fix_conec_s2p = 'fix_and_connector.s2p' ;
[~,X.sfix_conec] = f_awr_get_s2p_at_freq_sel( fix_conec_s2p , ic_sel_freq );

X.sfix_conec_11 = X.sfix_conec(1,1) ;
X.sfix_conec_21 = X.sfix_conec(1,2) ;
X.sfix_conec_12 = X.sfix_conec(1,3) ;

66



X.sfix_conec_22 = X.sfix_conec(1,4) ;

gin_f_fix_to_tun = (?X.sfix_conec_11 + sloads)./ ...
((?X.sfix_conec_11 .* X.sfix_conec_22) ...

+sloads.*X.sfix_conec_22+ X.sfix_conec_12 .* X.sfix_conec_21 );

X.gamma_x = real(gin_f_fix_to_tun) ;
X.gamma_y = imag(gin_f_fix_to_tun) ;

%% ????????????????????????????????????????????????????????????????????????????
% Tuner pre?characterization setup %
% ?????????????????????????????????????????????????????????????????????????????
MT.tuner_number = 0 ;
filename = '15_06_28?18_50_TChar_OUT1800MHz_ws.tun' ;
meas_dir = 'dir_load_pull\dir_measurements' ;
meas_dir2 = '\AWPTST5152015_tun\HUAWEI_MT981EU10_CAL_MEAS' ;
MT.tuner_number = 0 ;
MT.fname = strcat(main_dir,meas_dir,meas_dir2,'\2015_06_28\',filename);
MT.tuner_model = 'MT981EU10' ;
MT.freq = ic_sel_freq ;
MT.mec(1) = 9500 ;
MT.mec(2) = 9500 ;
MT.mec(3) = 9500 ;
MT.interp_mode = 1 ;
MT.gamma_x_term = 0 ;
MT.gamma_y_term = 0 ;
MT981EU10_Setup( 'MLibTuners','free_tuner_data' , MT );
MT981EU10_Setup( 'MLibTuners','read_tuner_data_file', MT );

%% ?????????????????????????????????????????????????????????????????????????????
% Load?Pull full characterization %%
% ??????????????????????????????????????????????????????????????????????????????
% ??????????????????????????????????????????????????????????????????????????????
% Gamma_out %
% ??????????????????????????????????????????????????????????????????????????????

fix_and_connec = 'fix_and_connector.s2p' ;
[~,X.fix_and_connec]= f_awr_get_s2p_at_freq_sel( fix_and_connec, ic_sel_freq );
gamma_out_s2p = 'gamma_out_s2p.s2p' ;
[~,X.gamma_out_s2p ]= f_awr_get_s2p_at_freq_sel( gamma_out_s2p,ic_sel_freq );
gspec_out_s1p = 'gspec_out.s1p' ;
[~,X.gspec_out] = f_awr_get_s1p_at_freq_sel( gspec_out_s1p,ic_sel_freq );
gpwr_b_s1p = 'gpwr_b.s1p' ;
[~,X.gpwr_b] = f_awr_get_s1p_at_freq_sel( gpwr_b_s1p,ic_sel_freq );

% ??????????????????????????????????????????????????????????????????????????????
% ABCD ?MATRIX %
% ??????????????????????????????????????????????????????????????????????????????
X.abcd_fix_and_connec = s_to_abcd([X.fix_and_connec(1,1) X.fix_and_connec(1,3);

X.fix_and_connec(1,2) X.fix_and_connec(1,4)],50) ;

X.abcd_gamma_out = s_to_abcd([X.gamma_out_s2p(1,1) X.gamma_out_s2p(1,3) ;
X.gamma_out_s2p(1,2) X.gamma_out_s2p(1,4)],50) ;

MT_pcharc = tun_to_mat(MT.fname) ;
X.mp = MT_pcharc.data.mec_pos.data(:,1:3) ;

67



X.s11 = MT_pcharc.data.mec_pos.data(:,4) + ...
1i.*MT_pcharc.data.mec_pos.data(:,5) ;

X.s21 = MT_pcharc.data.mec_pos.data(:,6) + ...
1i.*MT_pcharc.data.mec_pos.data(:,7) ;

X.s12 = MT_pcharc.data.mec_pos.data(:,8) + ...
1i.*MT_pcharc.data.mec_pos.data(:,9) ;

X.s22 = MT_pcharc.data.mec_pos.data(:,10) + ...
1i.*MT_pcharc.data.mec_pos.data(:,11) ;

% ??????????????????????????????????????????????????????????????????????????????
% Remove the losses and shift the reference plane to properly read out_pwr_b
% ??????????????????????????????????????????????????????????????????????????????

idx = NaN.*ones(size(gin_f_fix_to_tun,1),1) ;
for k = 1:size(gin_f_fix_to_tun,1)
[~,idx(k)] = min(20.*log10(abs( gin_f_fix_to_tun(k)?X.s11))) ;

end

X.s11_t = X.s11(idx) ;
X.s21_t = X.s21(idx) ;
X.s12_t = X.s12(idx) ;
X.s22_t = X.s22(idx) ;

% ??????????????????????????????????????????????????????????????????????????????
% Post processing awr s2p files
% ??????????????????????????????????????????????????????????????????????????????

MT.gamma_x_term = (16.4*10^?3) ;
MT.gamma_y_term = (?5.23*10^?3) ;
MT981EU10_Setup( 'MLibTuners','free_tuner_data' ,MT );
MT981EU10_Setup( MLibTuners','read_tuner_data_file',MT );

%% Generating mechanical positions
SmithChart(0);hold on;

for k = 1:size(X.gamma_x,1)
MT.gamma_x = X.gamma_x(k) ;
MT.gamma_y = X.gamma_y(k) ;
mpos = MT981EU10_Setup('MLibTuners', 'get_tuner_refl_posn',MT) ;
mp_t(k,1:3) = [mpos.carr mpos.p1 mpos.p2] ;
plot( gin_f_fix_to_tun(k),'o') ;
drawnow ;
plot( sloads(k),'bo' );
end

for k = 1:size(X.s11_t,1)
X.abcd_t(:,:,k) = s_to_abcd([X.s11_t(k,1) X.s21_t(k,1) ;

X.s12_t(k,1) X.s22_t(k,1)],50) ;

X.abcd_gamma_out_total(:,:,k) = X.abcd_fix_and_connec * X.abcd_t(:,:,k)* X.abcd_gamma_out
;
X.gamma_out_total(:,:,k) = abcd_to_s(X.abcd_gamma_out_total(:,:,k),50) ;

X.gin(k) = X.gamma_out_total(1,1,k) + (( X.gamma_out_total(1,2,k).* ...

68



X.gamma_out_total(2,1,k).*X.gpwr_b)...
./(1? X.gamma_out_total(2,2,k).*X.gpwr_b)) ;

Gp_lin(k) = (1/(1?(abs(X.gin(k))^2))).*(abs(X.gamma_out_total(2,1,k).^2).*...
(( 1? abs(X.gpwr_b).^2) ./ ...
(abs(1?X.gamma_out_total(2,2,k).*X.gpwr_b).^2))) ;

Gp_dB(k) = 10.*log10(Gp_lin(k)) ;

end

close all ;
SmithChart(0); plot(sloads,'o'); hold on; plot(X.gin,'*r') ; pause(1) ;
close all ;

%% ??????????????????????????????????????????????????????????????????????????????
% Fast power sweep config %%
% ???????????????????????????????????????????????????????????????????????????????
dos( 'start http://10.202.8.222/web.exe?file=FrontPanel.html' );
pause(2) ;
addpath( '.\wb_fast_pwr_swp_lps\' );

%% ??????????????????????????????????????????????????????????????????????????????
% function fpwr_swp_gan_config_v4 confidential
% ???????????????????????????????????????????????????????????????????????????????
ot_flps = fpwr_swp_gan_config_v4( config,ic_sel_freq,...

fps_lps_signal_fname,Vds,Imax );
% ???????????????????????????????????????????????????????????????????????????????

%% ??????????????????????????????????????????????????????????????????????????????
% FPSWP measurements %%
% ????????????????????????????????????????????????????????????????????????????close all
;???
% Header

filename = strcat(file_out,sprintf('f_%dMHz_GO68.txt',ic_sel_freq*1000) );
fid = fopen(filename,'w','n','US?ASCII');
fprintf(fid,'! Load Pull Measurement Data\n');
fprintf(fid,'!????????????????????????????????????????????????????????\n' );
fprintf(fid,(sprintf('! Frequency = %.3f GHz \n',ic_sel_freq)) );
fprintf(fid,'! Char.Impedances = Source: 1 + 0j Ohm Load: 1 + 0j Ohm \n' );
fprintf(fid,(sprintf('! Source Frequencies = %.3f GHz \n',ic_sel_freq)));
fprintf(fid,'! Source Impedances F0: 1 ? 0j Ohm \n' );
fprintf(fid,'!???????????????????????????????????????????????????????? \n' );
fprintf(fid,'Point \t R \t\t jX \t Gain[dB] \t EffP3dB[%%] \t' );
fprintf(fid,'P3dB[dBm] \t EffP1dB[%%] \t' );
fprintf(fid,'P1dB[dBm] \t Eff47R0dBm[%%]\t' );
fprintf(fid,'Eff49R0dBm[%%] \t Eff50R0dBm[%%]\n' );
fprintf(fid,'!????????????????????????????????????????????????????????' );

% ???????????????????????????????????????????????????????????????????????????????
% Generating the Look?up table for the at the plan of the device power levels %%
% ???????????????????????????????????????????????????????????????????????????????
PAInputLoss = 31.33 ;

% ?????????? WARNING THIS UPPER VALUE WAS USED ONLY FOR THE POWER CAL ???????????
ot_flps.max = 6.1 ;

% ???????????????????????????????????????????????????????????????????????????????

69



% Freescale driver

PeakPower = 38.2?3 ;
SigPAR = 12.27 ;
Power_cal_corrections = ?36.251496748344728?0.35+5.6 ;
steps = [PeakPower?SigPAR]+Power_cal_corrections ;
OBO_in_pts = 11 ;

% It's a index that decide from10 points
dB_comp = 3 ;

% use the 10 pts to start the calculation.
X.Zloads = s_to_z(sloads,50) ;

for k =1:size(mp_t,1)
ot_flps.AvgPower = steps ;
OutputLosses = ?Gp_dB(k) ;
MT981EU10_Setup( 'MLibTuners','move_tuner', [ mp_t(k,1) mp_t(k,2) mp_t(k,3)]) ;
pause(0.3) ;
j = 1 ;
aux_max = 0 ;
filename = strcat(file_out3,sprintf(...

'_%.2dMHz_Vgs_%.3fV_Ids_%.3fmA_ZL_%.4f+j_%.4f_Ohm.txt',...
ic_sel_freq*1000,Vgs,Ids,real(X.Zloads(k)),imag(X.Zloads(k))));

mdat_file = fopen(filename,'wt') ;

fprintf(mdat_file, '! FPS Load Pull Measurement Data\n' );
fprintf(mdat_file, '!??????????????????????????????????????????????????????\n');
fprintf(mdat_file,sprintf('! OutputLosses: %.3d dB \t PAInputLoss: %.3d dB \n',...

OutputLosses,PAInputLoss));
fprintf(mdat_file,'!Efficieny\tGain[dB]\tPoutdBm\tPdc\tPindBm\tPinW\t PoutW\n');
fprintf(mdat_file, '!??????????????????????????????????????????????????????\n');

while (aux_max &amp;lt;dB_comp)
ot_flps.k = k;

%% ??????????????????????????????????????????????????????????????????????????????
% function fpwr_swp_gan_fetch_loadconfidential
% ???????????????????????????????????????????????????????????????????????????????
ot_flps_pswp = fpwr_swp_gan_fetch_load(config,ot_flps,PAInputLoss,OutputLosses);

% ???????????????????????????????????????????????????????????????????????????????
minv = min(ot_flps_pswp.PoutdBm) ;
maxv = max(ot_flps_pswp.PoutdBm) ;

pout_x = ot_flps_pswp.PoutdBm ;
gain_y = ot_flps_pswp.Gain_data ;
eff_y = ot_flps_pswp.Eff_data ;

pout_xx = minv:0.1:maxv ;
gain_yy = pchip(pout_x,gain_y,pout_xx) ;
eff_yy = pchip(pout_x,eff_y ,pout_xx) ;

figure(k); hold on; subplot(2,1,1) ;
plot( pout_x,gain_y,'?ro' ,pout_xx,gain_yy); grid on ;

subplot(2,1,2)
plot( pout_x,eff_y,'?ro' ,pout_xx,eff_yy ); grid on ;

Gmax = max(gain_yy) ;
idx = find( gain_yy == max(gain_yy)) ;

70



PoutdBm_at_Gmax = pout_xx(idx) ;
RT.Avgpower = ot_flps.AvgPower ;
j = j+1 ;

Pmin_after_pk = min(gain_yy(idx:end)) ;
comp_meas = Gmax ? Pmin_after_pk ;
RT.Point = k ;

RT.comp_meas = comp_meas ;
if ot_flps.AvgPower &gt; 5.67
aux_max = 100 ;

end

if comp_meas &gt; dB_comp
aux_max = comp_meas ;

end

if comp_meas&amp;lt;1 &amp;amp;&amp;amp; comp_meas&lt;(dB_comp* 0.8)
ot_flps.AvgPower = ot_flps.AvgPower + 1 ;
RT.inc_step = '+1' ;

end

if comp_meas &gt; (dB_comp* 0.8)
ot_flps.AvgPower = ot_flps.AvgPower + 0.1 ;
RT.inc_step = '+0.1' ;

end

if comp_meas &gt;1 &amp;amp;&amp;amp; comp_meas&lt;(dB_comp* 0.8)
ot_flps.AvgPower = ot_flps.AvgPower + 0.5 ;
RT.inc_step ='+0.5';

end

% ???????????????????????????????????????????????????????????????????????????????
% Write the file with the load?pull data
% ???????????????????????????????????????????????????????????????????????????????
if aux_max &gt; dB_comp
wr_awr.point = k ;
wr_awr.R = real(X.Zloads(k) );
wr_awr.jX = imag(X.Zloads(k) );

dBcomp_find = 1 ;
idx_1dB_comp = idx + find( (abs(Gmax?gain_yy(idx:end)? dBcomp_find )) ...

== min((abs(Gmax?gain_yy(idx:end)? dBcomp_find ))) ) ?1 ;

dBcomp_find = 3 ;
idx_3dB_comp = idx + find( (abs(Gmax?gain_yy(idx:end)? dBcomp_find )) ...

== min((abs(Gmax?gain_yy(idx:end)? dBcomp_find ))) ) ?1 ;

wr_awr.gain = pchip(pout_x,gain_y,45) ;
wr_awr.gain_1dB = gain_yy(idx_1dB_comp) ;
wr_awr.gain_3dB = gain_yy(idx_3dB_comp) ;

wr_awr.eff_1dB = eff_yy(idx_1dB_comp) ;
wr_awr.eff_3dB = eff_yy(idx_3dB_comp) ;

wr_awr.P1dB = pout_xx(idx_1dB_comp) ;
wr_awr.P3dB = pout_xx(idx_3dB_comp) ;
ot_flps = f ;

71



% Set condition around 1dB for extrapolate if the max pout measure goes behond so it' set 0.
if maxv &amp;lt;47
wr_awr.eff47ro = 0 ;
wr_awr.eff49ro = 0 ;
wr_awr.eff50ro = 0 ;

end
if maxv &gt; 47
wr_awr.eff47ro = pchip(pout_x,eff_y,47) ;
wr_awr.eff49ro = 0 ;
wr_awr.eff50ro = 0 ;

end
if maxv &gt; 49
wr_awr.eff47ro = pchip(pout_x,eff_y,47) ;
wr_awr.eff49ro = pchip(pout_x,eff_y,49) ;
wr_awr.eff50ro = 0 ;

end
if maxv &gt; 50
wr_awr.eff47ro = pchip(pout_x,eff_y,47) ;
wr_awr.eff49ro = pchip(pout_x,eff_y,49) ;
wr_awr.eff50r = pchip(pout_x,eff_y,50) ;

end
if k&amp;lt;9
fprintf(fid_awr,sprintf('\n%i\t\t%.4f\t%.4f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f',...

k,wr_awr.R,wr_awr.jX,wr_awr.gain,wr_awr.eff_3dB,wr_awr.P3dB, ...
wr_awr.eff_1dB,wr_awr.P1dB,wr_awr.eff47ro,wr_awr.eff49ro,...
wr_awr.eff50ro ));

else
fprintf(fid_awr,sprintf('\n%i\t%.4f\t%.4f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f\t%.1f',...

k,wr_awr.R,wr_awr.jX,wr_awr.gain,wr_awr.eff_3dB,wr_awr.P3dB, ...
wr_awr.eff_1dB,wr_awr.P1dB,wr_awr.eff47ro,wr_awr.eff49ro,...
wr_awr.eff50ro ));

end
end
% ????????????????????????????????????????????????????????????????????????????????
% Saving alldata_pts
%% ???????????????????????????????????????????????????????????????????????????????
fetch_m = [ot_flps_pswp.Eff ot_flps_pswp.Gain_data ot_flps_pswp.PoutdBm ot_flps_pswp.Pdc' ...

ot_flps_pswp.PindBm ot_flps_pswp.PinW ot_flps_pswp.PoutW ] ;
for idx_w_file=1:size(fetch_m,1)
fprintf(mdat_file, '%.5f\t%.5f\t %.5f\t %.5f\t %.5f\t %.5f\t %.5f\n',...

fetch_m(idx_w_file,:) );
end
fprintf(mdat_file, '!????????????????????????????????????????????????????????\n');
end
fclose(mdat_file);

%% ??????????????????????????????????????????????????????????????????????????????
% Saving figures
%% ??????????????????????????????????????????????????????????????????????????????
plot = figure(k) ;
figure_name = strcat(file_out2,...

printf('GO68_%.2dMHz_Vgs_%.3fV_Ids_%.3fmA_ZL_%.4f+j%.4f_Ohm.fig',...
ic_sel_freq*1000,Vgs,Ids,real(X.Zloads(k)),imag(X.Zloads(k))));

saveas(plot,figure_name); clearvars plot; clear 1; close all; clc ;
end
%% ???????????????????????????????????????????????????????????????????????????????

72



Appendix B

MT981EU10_Setup - HUAWEI

The MATLAB requires an lcc or a equivalent c++ compiler in order to enable the commu-
nication with the Maury tuner (MT981EU) performed through a DLL. In addition, it is also
necessary to add a piece of code to the ?le named 'MLibTuners.h',as shown in the following:

// At the begin
#ifdef __cplusplus
extern "C" {

#endif

...

// At the end
#ifdef __cplusplus
}

#endif

function [ocr_data] = MT981EU10_Setup(current,cmd,val)
%MT981EU10_SETUP Control routine
switch lower(cmd)
%% ????????????????????? First step load tuner library ??????????????????????????
case 'load_libraries'
flag = libisloaded('MLibTuners' );

if flag == 0
addpath('C:\Program Files (x86)\Maury\MLibV04\' );
loadlibrary('MLibTuners','MLibTuners.h' );

ocr_data = 1;
end

case 'show_functions'
libfuncions('MLibTuners');
ocr_data = 1 ;

case 'view_all_func'
libfunctions('MLibTuners);
ocr_data = 1 ;

%???????????????????????????????????????????????????????????????????????????????
[current,ctrl_exe,model,error] = calllib('MLibTuners','add_controller',0,...

TunHubMech','MT981EU10',250,11,0,3170,...

73



'error' );
[current,model,num_axis,tun_step_limits,...
fmin,fmax,freq_to_change_probe] = calllib('MLibTuners','add_tuner',0,'MT981EU10',...

3170,0,1,3,[0 0 0],0,0,0,...
'error' );

ocr_data = [current,ctrl_exe,model,error,...
current,model,num_axis,tun_step_limits,fmin,fmax,...
freq_to_change_probe] ;

case 'init'
ocr_data = calllib('MLibTuners','init_tuners','error' );

case 'get_tuner_pos'
[flag,carr,p1,p2,error] = calllib(current,'get_tuner_position',0,0,0,0,'error');

ocr_data.flag = flag ;
ocr_data.carr = carr ;
ocr_data.p1 = p1 ;
ocr_data.p2 = p2 ;
ocr_data.error = error ;

case 'get_tuner_refl_data'

s11_x = 0; s21_x = 0; s12_x = 0; s22_x = 0 ;
s11_y = 0; s21_y = 0; s12_y = 0; s22_y = 0 ;

[tuner_number,carr,p1,p2,s11_x, ...
s11_y,s21_x,s21_y,s12_x,s12_y, ...
s22_x,s22_y,error] = calllib(current,'get_tuner_refl_data',

val.tuner_number,val.interp_mode,
val.freq,
val.gamma_x_termination,
val.gamma_y_termination, ...

val.gamma_x,val.gamma_y,9500,9500,9500,
s11_x,s11_y,
s21_x,s21_y,
s12_x,s12_y,
s22_x,s22_y, 'error' );

ocr_data.tuner_number = tuner_number ;
ocr_data.carr = carr ;
ocr_data.p1 = p1 ;
ocr_data.p2 = p2 ;
ocr_data.error = error ;
ocr_data.s11 = s11_x + 1i.*s11_y ;
ocr_data.s21 = s21_x + 1i.*s21_y ;
ocr_data.s12 = s12_x + 1i.*s12_y ;
ocr_data.s22 = s22_x + 1i.*s22_y ;

case 'free_tuner_data'
[ocr_data.error] = calllib(current,'free_tuner_data',val.tuner_number) ;

case 'move_tuner'
[flag,error] = calllib(current,'move_tuner',0,.val(1),val(2),val(3),...

'error' );
ocr_data = [flag,error] ;

case 'get_tuner_refl_posn'
[tuner_number,carr,p1,p2,error] = calllib(current,'get_tuner_refl_posn',

val.tuner_number, val.interp_mode,val.freq,...
val.gamma_x_termination,...

val.gamma_y_termination,

74



val.gamma_x,val.gamma_y, 9500,9500,9500,
'error' );

ocr_data.tuner_number = tuner_number ;
ocr_data.carr = carr ;
ocr_data.p1 = p1 ;
ocr_data.p2 = p2 ;
ocr_data.error = error ;

case 'read_tuner_data_file'
[tuner_number,fname,tuner_model,error] = calllib(current,'read_tuner_data_file',

val.tuner_number,val.fname,
val.tuner_model,'error' );

ocr_data.tuner_number= tuner_number ;
ocr_data.tuner_model = tuner_model ;
ocr_data.fname = fname ;
ocr_data.error = error ;

case 'get_tuner_position_mode'
[tuner_number,mode,error] = calllib(current,'get_tuner_position_mode',

val.tuner_number,val.freq, val.mec(1),...
val.mec(2),val.mec(3),val.interp_mode,...
'error' );

ocr_data.tuner_number = tuner_number ;
ocr_data.mode = mode ;
ocr_data.error = error ;

end

75



Appendix C

GaN Load-Pull - Target impedances

The following table C.1 shows the used target impedances in the characterization of the
GaN microwave transistor.

Table C.1: Target impedances of the used microwave transistor.

76



Appendix D

3-port to 2-port network conversion

D.1 LPS - Output Network

In this work the placed spectrum/time-domain analyzer at output network of the built
load-pull system is only used to monitor the waveform of the incoming signal read by the
power meter. For the absolute power calibration, only a 2-port network between the DUT
and the power sensor is necessary to determine the Pout at the microwave transistor reference
plane.

Figure D.1: Conversion of a 3-port network to 2-port network.

To convert a 3-port into a 2-port network, it is only necessary to known the s3p-parameters
of the output network and the re?ection coe?cient, ?3, of time-domain/spectrum analyzer,
that is given by the following equations:?

?b1b2
b3

?
? =

?
?S11 S12 S13S21 S22 S23
S31 S32 S33

?
?
?
?a1a2
a3

?
? (D.1)

and

?3 =
a3
b3

(D.2)

As a result of the 3-port simpli?cation, the 2-port network is given by:

[
b1
b2

]
=

?
?S11 + S13S31?31?S33?3 S12 + S13S32?31?S33?3
S21 +

S31S23?3
1?S33?3 S22 +

S23S32?3
1?S33?3

?
?
?
?a1
a2

?
? (D.3)

77



D.2 LPS - Input Network

To convert a 3-port into a 2-port network, it is only necessary to know the s3p-parameters
of the input network and the re?ection coe?cient of the power sensor A. Thus based on the
diagram of the Fig. D.2 and the following equations a new s2p-parameters are obtained.

Figure D.2: Conversion from 3-port to 2-port s-parameters of the input network.

?
?b1b2
b3

?
? =

?
?S11 S12 S13S21 S22 S23
S31 S32 S33

?
?
?
?a1a2
a3

?
? (D.4)

and

?pwrA =
a3
b3

(D.5)

,where ?pwrA represents the power sensor A placed at the input network used to assists the
characterization of the device measuring the uncorrected power that is being injected to the
DUT.

[
b2
b3

]
=

?
??S22 + S21S12?pwrA1?S11?pwrA S23 + S21S13?pwrA1?S11?pwrA
S32 +

S12S31?pwrA
1?S11?pwrA

S33 +
S31S13?pwrA
1?S11?pwrA

?
??
?
??a1
a2

?
?? (D.6)

78



Copyright ? 2012 Maury Microwave Inc., all rights reserved.

2900 Inland Empire Blvd.  •  Ontario, California  91764-4804
Tel:  909-987-4715  •  Fax: 909-987-1112  •    http://www.maurymw.com

C O R P O R A T I O N

M A U R Y  M I C R O W AV E

SPECIFICATIONS SUBJECT TO CHANGE WITHOUT NOTICE

HIGH-POWER AUTOMATED TUNERS
0.25 TO 8.0 GHz

t e c h n i c a l  d a t a   

Page 1 of 2

Series
MT981xU

January 2012

Features
•  Optimized for GSM/EDGE, WCDMA, WiFi, and 

WiMax In-Fixture and On-Wafer Applications

•  High Matching Range for GaN, GaAs,   
LDMOS, and Si Characterization

•  Simultaneous High-Matching and Low Vibration 
for On-Wafer Applications

• USB Interface for Simple, Fast and Reliable 
Control

•  DLL Environment for Automated Applications

•  Industry's Highest Accuracy Means Your Designs 
Work Right the First Time

•  Industry's Best Calibration Frees Your Time for 
Design

4 T- 0 7 1 A

Applications and Benefits Overview
The MT981 series automated tuners are optimized for 
high power in-fixture and on-wafer applications requiring 
low impedance and low vibration simultaneously. Based 
on Maury's proven non-contacting probe technology, 
these high-performance tuners evolve beyond outdated 
contacting probe technology to deliver high VSWR with 
superb accuracy and reliability. 

An integral component of Maury Device Characterization 
Solutions, these USB-interfaced automated tuners are 
controlled using one of three Maury Software Solutions; 
Maury’s MT930 series IVCAD Advanced Measurement 
and Modeling Software; Maury’s Device Characterization 
Software suite (ATS version 5 or later); or Maury’s DLL 
environment.

The MT930 IVCAD software suite is the most advanced 
measurement and modeling software in the industry, 
with support for multiple load pull techniques including 
traditional load pull using external instrumentation, VNA-
based load pull, active load pull and hybrid load pull.

The ATS software is an integrated device character-
ization suite providing front-end and back-end 

Trademarks shown above are the property of their respective owners.

device characterization tools for power and noise 
characterization.

The DLL environment enables direct interface with common 
programming tools such as Agilent VEE™, NI LabVIEW™, 
MS Visual Basic &amp;amp; C/C++, and Mathworks MATLAB™.

With a tuning resolution in excess of a million impedance 
points and accuracy better than -50 dB over the entire 
Smith chart, Maury automated tuners give you the device 
characterization answers you need with the accuracy 
necessary to make engineering decisions with confidence. 
Typical applications include load pull using CW, GSM/
EDGE, CDMA, WCDMA, WiMax, and WiFi stimulus for 
mobile and infrastructure terminal design, RADAR design, 
and Sat-Com design.

Controller
For optimum performance, the MT1020B ATS Power 
Distribution Hub can be used to control up to four (4) 
MT981xU series tuners. Additionally, the MT1020D 
Desktop Switching Power Supply can be used to provide 
power to a single MT981xU series tuner.  

MT981BU10
7mm High-Power Automated Tuner



SPECIFICATIONS SUBJECT TO CHANGE WITHOUT NOTICE 

2900 Inland Empire Blvd.  •  Ontario, California  91764-4804
Tel:  909-987-4715  •  Fax: 909-987-1112  •    http://www.maurymw.com

t e c h n i c a l  d a t a   4 T- 0 7 1 A

Page 2 of 2

January 2012

Dimensions – Inches and [cm]

Specifications
Frequency Range  .............. See Available Models Table

VSWR Matching Range ....  See Available Models Table

Step Size (Probes)  ..............................62.5 microinches1

Step Size (Carriage)   ........................... 786 microinches1

Connectors:  .......................................... Precision 7mm2

1 Based on 1/2 stepping the drive motors.
2 Precision 7mm per Maury data sheet 5E-060.
3 Defined as the minimum VSWR within 70% of the frequency range.

4 Power rated at maximum VSWR.
5 With probes fully retracted.

Accessories Provided
One (1) MT1020D controller, one (1) USB cable and one 
(1) operating manual.

Available Models

Recommended Accessories
2698C2 7mm (3/4-in. hex) torque wrench

A028D 7mm connector gage kit

8022S 7mm to 3.5mm (female) precision adapter

8022T 7mm to 3.5mm (male) precision adapter

Model
Frequency 

Range
(GHz)

Matching Range Power
Capability4

Vector
Repeatability
(Minimum)

VSWR5
Insertion

Loss5

Dimensions
12.0" [30.5 cm]
10.0" [25.4 cm]Minimum Typical

3

MT981AU11 0.25 – 2.5 15:1 25:1

250 W CW
2.5 kW PEP

–50 dB

1.05:1 0.3 dB

36.9" [93.5 cm]

MT981BU15 0.40 – 2.5 30:1 45:1

23.0" [58.6 cm]
MT981BU10 0.40 – 4.0 15:1 25:1

MT981BU18 0.40 – 8.0 10:1 25:1 –40 dB

MT981WU10 0.60 – 6.0 15:1 25:1
–50 dB

MT981EU10 0.80 – 8.0 15:1 30:1 15.9" [40.3 cm]

DUT Port

10.25 [26.04]

7.14 [18.13] 0.58 [1.47]7.61 [19.34]

12.14 [30.83]
Max

Mating Surfaces
(See Available Models Table)

 4.8 [12.19]
 2.9 [  7.30]

9.37 [23.79]

2.00 [5.08]

Front View Side View


	Contents
	List of Figures
	List of Tables
	Acronyms
	Introduction
	Motivation
	Objectives
	Organization and structure

	Load-Pull Systems
	Introduction
	Figures of Merit (FoM)
	Load-pull measurements: Traditional, VNA and Six-Port.
	Load-pull techniques: Passive, Active and Hybrid
	Comparison of the different kinds of load-pull setups
	Reflection coefficient enhancement techniques

	Design and implementation of an automated tuner-based load-pull system
	Introduction
	Diagram of the automated load-pull system
	System description
	Characterization of the load-pull system
	Characterization of the system components
	Characterization of tuner
	MATLAB routines
	Automated load-pull system verification

	Conclusion and Future Work
	Conclusion
	Future work

	Bibliography
	MATLAB Routines
	Pre-Characterization
	Power Calibration
	Load-Pull Measurements

	MT981EU10_Setup - HUAWEI
	GaN Load-Pull - Target impedances
	3-port to 2-port network conversion
	LPS - Output Network
	LPS - Input Network


</field>
	</doc>
</add>