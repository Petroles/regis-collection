<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20295</field>
		<field name="filename">3780_230069.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

 
 

UNIVERSIDADE FEDERAL DE SANTA CATARINA – UFSC 
 

Programa de Pós-Graduação em Engenharia Mecânica 
 
 
 
 
 
 
 
 
 
 
 

SIMULAÇÃO DE RESERVATÓRIOS DE PETRÓLEO UTILIZANDO O MÉTODO EbFVM  E 
MULTIGRID ALGÉBRICO 

 
 
 
 
 
 

Tese submetida à 
 

 
UNIVERSIDADE FEDERAL DE SANTA CATARINA 

 
 

para a obtenção do grau de 
 

 
DOUTOR EM ENGENHARIA MECÂNICA 

 
 
 
 
 

JONAS CORDAZZO 
 
 
 
 

Florianópolis, abril de 2006 
 



 

 
 



 

UNIVERSIDADE FEDERAL DE SANTA CATARINA 
Programa de Pós-Graduação em Engenharia Mecânica 

 

 
SIMULAÇÃO DE RESERVATÓRIOS DE PETRÓLEO UTILIZANDO O MÉTODO EbFVM  E 

MULTIGRID ALGÉBRICO 
 

 
JONAS CORDAZZO 

 
 

Esta tese foi julgada adequada para a obtenção do título de 
 

DOUTOR EM ENGENHARIA 
ESPECIALIDADE ENGENHARIA MECÂNICA 

 
sendo aprovada em sua forma final. 

 
 
 

_______________________________________________________ 
Clovis Raimundo Maliska, Ph.D - Orientador 

 
_______________________________________________________ 

António Fábio Carvalho da Silva, Dr.Eng. - Co-Orientador 
 

_______________________________________________________ 
José Antônio Bellini da Cunha Neto, Dr. - Coordenador do Curso 

 
 
 

BANCA EXAMINADORA 
 

 
_______________________________________________________ 

Clovis Raimundo Maliska, Ph.D - Presidente 
 

_______________________________________________________ 
Denis José Schiozer, Ph.D - Relator 

 
_______________________________________________________ 

Álvaro Luiz Gayoso de Azeredo Coutinho, Dr.Eng. 
 

_______________________________________________________ 
Eduardo Alberto Fancello, D.Sc. 

 
_______________________________________________________ 

Flavio Dickstein, Dr.Ing. 
 

_______________________________________________________ 
Régis Kruel Romeu, Dr.Ing. 





 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

DEDICATÓRIA 
 

Aos meus pais e irmãs,  
à minha esposa Scheila e 

 ao nosso filho Léo.



 
 
 



 

AAGGRRAADDEECCIIMMEENNTTOOSS  
 
 

 
 Aos professores Clovis Raimundo Maliska e António Fábio Carvalho da Silva pela 

valiosa e indispensável orientação e incentivo que possibilitaram o desenvolvimento deste 

trabalho. 

 Aos amigos do SINMEC, dos alunos da iniciação científica aos doutorandos, que 

deram mostras de companheirismo e contribuíram decisivamente para que os objetivos 

fossem alcançados. Particularmente, enalteço o apoio dos colegas Bruno Contessi, Lynceo 

Braghirolli, Pedro Hinckel, Susie Keller e Fernando Hurtado. 

 À ANP, Agência Nacional do Petróleo, que me confiou uma bolsa através do 

programa MECPETRO - Programa de Formação de Recursos Humanos em Engenharias 

Mecânica e Química com Ênfase em Petróleo e Gás (PRH09-ANP/MCT). Além disso, foi 

indispensável para a realização desta tese o auxílio para viagens e taxa de bancada fornecido 

por esta agência. 

 Ao pesquisador visitante da ANP e amigo Axel Dilhlmann que sempre esteve disposto 

a ajudar em todos momentos, seja na viabilização de recursos financeiros que possibilitaram a 

participação em congressos e outro eventos, seja no apoio e confiança conferidos. 

 Ao Centro de Pesquisas da PETROBRAS - CENPES, na pessoa do Eng. Régis Kruel, 

que possibilitou o enriquecimento do conhecimento prático das atividades de simulação de 

reservatórios mediante diversos projetos realizados com esta universidade. 

 Ao Capítulo Estudantil da Sociedade dos Engenheiros de Petróleo da UNICAMP e ao 

professor Sérgio Bordalo que possibilitaram a apresentação deste trabalho no International 

Paper Contest promovido pela SPE ocorrido no ATCE 2004 em Houston. 

 Ao Instituto Brasileiro do Petróleo e Gás (IBP), representado pela Gisele Pereira, 

Álvaro Teixeira e João C. F. De Luca, que financiou a participação deste pesquisador em 

importantes eventos da área de petróleo.  

 Aos meus pais, irmãs, amada esposa e filho querido que tiveram que suportar a minha 

ausência em muitos momentos. Muito obrigado pela companhia e confiança. 

 E, finalmente, a Deus que me deu forças, coragem e inspiração para a realização deste 

trabalho. 

  



 



 i

SSUUMMÁÁRRIIOO  
  

  

SIMBOLOGIA ..........................................................................................................................  v 
 
RESUMO ................................................................................................................................  xi 
 
ABSTRACT ..............................................................................................................................  xiii 
 
 
1. INTRODUÇÃO .....................................................................................................................   1 
 

1.1. Motivação        4 
 
1.2. Objetivos       5 
 
1.3. Organização do Trabalho       6 

 
 
2. REVISÃO BIBLIOGRÁFICA ................................................................................................    9 
 

2.1. Visão Histórica da Simulação Numérica de Reservatórios de Petróleo          9 
 

2.2. Contextualização do EbFVM em Relação aos Demais Métodos         12 
 

2.3. Utilização de Malhas Não-Estruturadas na Simulação Numérica de Reservatórios de Petróleo     15 
 

2.4. Outros Métodos Utilizados na Simulação Numérica de Reservatórios de Petróleo         17 
 

2.5. Métodos de Solução de Sistema de Equações Algébricas     18 
 
2.6. Métodos Multigrid de Solução de Sistemas Lineares          20  
 

 
3. FORMULAÇÃO MATEMÁTICA ...........................................................................................  23 
 

3.1 Equações Governantes do Modelo Composicional Geral    23 
 

3.2. Equações Governantes do Modelo Black-Oil 26 
 

3.3. Modelo Água-Óleo  30 
 
 
4. FORMULAÇÃO NUMÉRICA,  PARTE 1 - EMBASAMENTO TEÓRICO E FUNDAMENTOS .....  33 
 
   4.1 O Método EbFVM 34 
 

4.1.1. Transformação de Coordenadas – Globais para Locais         36 
 

4.1.2. Funções de Forma como Funções de Interpolação no EbFVM         38 
 
4.1.3. Avaliação do Gradiente de Pressão          39 

  



 

 ii

4.1.4. Cálculo da Área de Passagem do Fluxo         42 
 
4.1.5. Esquema de Avaliação das Mobilidades     44  
  

4.2. Representação das Propriedades Físicas         48 
 

4.3. Representação das Falhas 50 
 

4.4. Refinamento Local    53 
 
 

5. FORMULAÇÃO NUMÉRICA, PARTE 2 – CONSIDERAÇÕES FINAIS E                          
                                                                                 IMPLEMENTAÇÃO COMPUTACIONAL ...............  55 

 
5.1. Método IMPES        57 

 
5.1.1. Formação da Matriz de Coeficientes por Elementos        59 
 
5.1.2. Formação da Matriz Global de Coeficientes        60 

 
5.1.3. Inserção das Informações de Poços na Matriz de Coeficientes         62 

 
5.1.4. Inserção do Termo Transiente na Matriz de Coeficientes  63 

 
5.1.5. Sistema Linear Resultante         64 

 
5.1.6. Determinação do Passo de Tempo         65 

 
5.2. Método Totalmente Implícito      65 

 
5.2.1. Sistema Linear Resultante           66 

 
5.2.2. Cálculo dos Resíduos     68 

 
5.2.3. Cálculo das Derivadas dos Resíduos         70 

 
5.2.4. Critérios de Convergência e Cálculo do Passo de Tempo 75 

 
5.2.5. Procedimento Computacional  77 

 
5.3. Esquema de Armazenamento de Matrizes Esparsas        79 

 
 

6. MÉTODO MULTIGRID DE SOLUÇÃO  DO SISTEMA LINEAR .............................................  83 
 

6.1. Características do Método Multigrid   83 
 

6.2. Mecanismos Envolvidos no Multigrid      85 
  

6.2.1. Transferência de Informação da Malha Grosseira para a Refinada 85 
 

6.2.2. Solução na Malha Grosseira         87 
 

6.2.3. Transferência de Informação da Malha Refinada para a Grosseira 91 
 

6.3. Tipos de Ciclos Multigrid 91 
 

6.4. Formação da Malha Grosseira        93 
 

6.5. Implementação Computacional do Multigrid 97 



 iii

7. AS “TRANSMISSIBILIDADES” NEGATIVAS EM MALHAS TRIANGULARES .......................  101 
 

7.1. A Origem do Conceito de Transmissibilidade 101 
 

7.2. As Transmissibilidades em Malhas Triangulares       103 
 
 
8. RESULTADOS E COMPARAÇÕES .......................................................................................  107 
 

8.1. Validação Numérica    108 
 

8.2. As “Transmissibilidades Negativas” em um Caso Prático     112 
 

8.3. Comparação entre as Soluções do Método Proposto e de um Simulador Comercial  116 
  

8.3.1. Impacto nos Resultados do Caso Analisado no item 8.2         116 
 

8.3.2. Interpretação do Campo de Velocidades do Método EbFVM         120 
 

8.4. As Duas Parcelas do Efeito de Orientação de Malha no EbFVM    125 
 

8.4.1. Deslocamento Radial    125 
 

8.4.2. Malhas de Triângulos Obtusângulos         129 
 

8.4.3. Arranjo de Poços Five-Spot 130 
 

8.5. Comparação entre os Diferentes Esquemas de Representação de Propriedades Físicas e Falhas 
Geológicas no EbFVM          138 

 
8.5.1. Reservatório Heterogêneo sem Falhas Geológicas       139 

 
8.5.2. Reservatório Heterogêneo com Falhas Geológicas       141 

 
8.6. Comparação entre os Métodos IMPES e Totalmente Implícito  149 

 
8.7. Desempenho do Método Multigrid na Simulação de Reservatórios de Petróleo         154 

 
8.7.1. Problemas Homogêneos Resolvidos com IMPES     155 

 
8.7.2. Problemas Homogêneos Resolvidos com Formulação Totalmente Implícita  163 

 
8.7.3. Problemas Heterogêneos e Anisotrópicos       165 

 
8.8. Simulação com Elementos Triangulares e Quadrangulares e com Refinamento Local        169 

 
 

9. CONCLUSÕES .................................................................................................................... 175 
 

9.1. Síntese das Principais Contribuições   175 
 

9.2. Sugestões para Trabalhos Futuros         177 
 

9.2. Considerações Finais 179 
 
 
REFERÊNCIAS BIBLIOGRÁFICAS ............................................................................................ 181 
 
ANEXOS ................................................................................................................................. 197



 

 iv



 v

SSIIMMBBOOLLOOGGIIAA  
 
 
ARÁBICOS 

 

A           matriz de coeficientes da equação da pressão 

A’        matriz de coeficientes da equação da pressão sem os termos de 

compressibilidade e poços 

b           espessura do reservatório, m 

b  vetor de termos independentes 

B          fator volume de formação, m3/m3 

 c  compressibilidade do fluido, Pa-1 

cµ   coeficiente que indica a dependência da viscosidade com a pressão, Pa.s / Pa 

djk  distância utilizada no cálculo do fluxo entre dois volumes de controle j e k 

D          matriz de derivadas das funções de forma 

  DNormX  variação da variável X durante o passo de tempo anterior 

e           termo relacionado à parcela transiente da equação da pressão 

f            termo dependente do modelo de poço utilizado 

F           vetor de termos independentes da equação da pressão 

fm          fluxo fracionário da fase m, adimensional          

g           termo dependente do modelo de poço utilizado 

h           parâmetro dependente da pressão e saturação das fases 

H          matriz dependente da geometria e propriedades físicas constantes no elemento   

J           matriz jacobiana da transformação 

kr          permeabilidade relativa, adimensional 

k           tensor permeabilidade absoluta do meio poroso, m2 

L  matriz triangular inferior 

L  distância de referência, m 

m  massa, kg 

M          razão de mobilidades  

n           termo relacionado à parcela transiente da equação da pressão 

n           vetor normal à interface de dois sub-volumes 



 

 vi

N              número de incógnitas 

Nj              funções de forma 

Nm         número de fases presentes no reservatório 

NNE   Número de nós de um elemento da malha 

p           pressão, Pa 

q         a vazão volumétrica de produção/injeção da fase por unidade de volume do 

reservatório, s-1 

  q          a vazão volumétrica nas condições de estocagem por unidade de volume do 

reservatório, s-1 

  q         vazão volumétrica de produção/injeção da fase, m3/s 

r           raio do poço, m 

R          matriz de rotação 

Rcm        solubilidade do componente c na fase m, m3/m3  

Rm        resíduo da equação m no método Totalmente Implícito 

  R   resíduo da equação no solver multigrid 
s           saturação da fase, adimensional  

  S         vetor área, m2 

t           tempo, s 

Tjk         transmissibilidade, m3 

?   termo que multiplica a diferença de pressão no cálculo do fluxo, m3 

u  componente da velocidade na direção x, m/s 

U  matriz triangular superior 

Vcm        volume do componente c na fase m, m3  

Vm   volume da fase m no reservatório, m3  

Vmm       volume do componente m na fase m, m3  

V          velocidade da fase, m/s 

V?        volume do volume de controle, m3  

W        função peso  

WI        índice de poço, m3  

x           coordenada global, m 

Xcm        fração mássica do componente c na fase m, kg/kg 

y                coordenada global, m 

Z          matriz de coordenadas dos nós 



 vii

GREGOS 

 

?  área da face do sub-volume de controle em coordenadas locais 

?         porosidade 

?   variável genérica 

?         coordenada local 

?          mobilidade, 1/Pa.s 

µ          viscosidade, Pa.s 

?         massa específica, kg/m3 

?  coordenada local 

I?   valor de correção aplicado à célula grosseira I 

?    constante empregada nos processos de aglomeração no multigrid 

 

 

 

SUBSCRITOS 

 

A  grandeza adimensionalizada 

c  componente ou espécie química presente em uma fase 

e         referente ao elemento  

eq        valor médio equivalente do bloco  

fp        valor do fundo de poço 

i           ponto de integração 

i  valor irredutível 

inj  referente a uma grandeza injetada 

I  célula grosseira 

j  índice utilizado para indicar o nó vizinho ao nó k 

k  índice utilizado para indicar o nó vizinho ao nó j 

m         índice utilizado para indicar cada fase (m = w ou o) 

m        ponto médio do sub-volume de controle 

máx     valor máximo 

min      valor mínimo 

n          nó do volume de controle que contém o poço 



 

 viii

nb  nós vizinhos a P 

NB  blocos vizinhos a I 

o          índice da fase óleo  

P          nó da malha ou ponto central do volume submetido à integração numérica 

Pr        valor prescrito 

r  valor residual 

svc       sub-volume de controle 

T          total = água + óleo 

w          índice da fase água   

w     valor relativo ao poço 

 

 

 
SUPERSCRITOS 

 

e  referente a propriedade calculada nas condições de estocagem na superfície 

o          valor utilizado do nível temporal anterior 

max     valor máximo 

n  expoente da curva de Corey 

ref        valor de referência  

?      nível iterativo 

*  valor corrigido 

user  valores especificados pelo usuário 

?   simboliza que ainda não está definido em que limites do intervalo de tempo 

será avaliada a propriedade 

?   a taxa que indica o aumento do esforço do solver com o número de variáveis 

 

 

 

MATEMÁTICOS 

 

[  ]        matriz quadrada ou retangular 

{  }        matriz coluna 

[  ]-1      matriz inversa 



 ix

[  ]T       matriz transposta 

[  ]e       matriz do elemento 

[  ]i      matriz com termos avaliados no ponto de integração i 

?  pertence a 

?  não-pertence a 

?  cada componente de um conjunto 

max  função que retorna o valor máximo entre dois argumentos 

 

 

 

ACRÔNIMOS 

 
ACM   The Additive Correction Multigrid 

AIM   The Adaptive Implicit Method 

CFL   Número de Courant-Friedrichs-Lewy 

CSR    Compressed Sparse Row 

CVFEM  Control Volume Finite Element Method 

EbFVM  Element-based Finite Volume Method  

(Método de Volumes Finitos baseado em Elementos) 

FDM   Método de Diferenças Finitas  

FEM   Método de Elementos Finitos 

FVM    Método de Volumes Finitos 

GMRES  Generalized Minimum Residual 

GS   Gauss-Seidel 

ILU   Incomplete LU decomposition 

IMPES   Implicit Pressure and Explicit Saturations 

LU   Lower and Upper triangular decomposition 

SSOR   Symmetric Successive Over Relaxation 

UDS   Upwind Differencing Scheme 

VPI   Volume Poroso Injetado 

 



 

 x



 xi

RREESSUUMMOO  
 

 

Este trabalho propõe uma metodologia numérica para a simulação do escoamento 

multifásico em reservatórios de petróleo utilizando o Método de Volumes Finitos baseado em 

Elementos (EbFVM). Este método emprega malhas não-estruturadas com elementos 

triangulares e/ou quadrangulares, o que lhe confere maior flexibilidade e generalidade. Os 

poucos métodos disponíveis na literatura de petróleo que utilizam malhas não-estruturadas 

tratam os fluxos nas interfaces dos volumes de controle de forma inadequada. Isto causa 

dificuldades quando triângulos obtusos são empregados e origina interpretações equivocadas 

da transmissibilidade. Propõe-se neste trabalho um novo cálculo do fluxo da forma exata e 

que flexibiliza o processo de construção de malhas que representem com maior fidelidade as 

heterogeneidades, poços horizontais e verticais, e falhas, o que contribui para a diminuição do 

tempo de simulação. A solução das equações resultantes foi obtida empregando-se os métodos 

IMPES (Implicit Pressure Explicit Saturation) e Totalmente Implícito. O sistema linear foi 

resolvido pelo método multigrid baseado na correção aditiva, que aglomera os blocos da 

malha levando em consideração os coeficientes do sistema linear.  

A operação de refinamento localizado é facilitado pela adoção de um sistema de 

coordenadas locais que permite um tratamento similar a todos os elementos da malha o que 

elimina a imprecisão numérica das técnicas de refino tradicionais. Demonstra-se que é 

possível lidar com os mapas de permeabilidade em sua forma completa e sem médias, um 

aspecto importante na simulação de reservatórios heterogêneos e anisotrópicos. O modelo 

resultante é fisicamente consistente e leva a uma clara interpretação das transmissibilidades, 

revelando que triângulos retângulos e obtusos podem ser usados sem maiores restrições. Ao 

comparar os resultados obtidos com os dos modelos usualmente empregados na simulação de 

reservatórios de petróleo, o método EbFVM proposto mostrou-se mais flexível e menos 

susceptível ao efeito de orientação de malha.  



 

 xii



 xiii

AABBSSTTRRAACCTT  
 

 

In this work a numerical model for simulating the multiphase flow in petroleum 

reservoirs using an Element-based Finite Volume Method (EbFVM), also known as CVFEM, 

is presented. The method employs unstructured grids with triangular and/or quadrilateral 

elements, rendering to the method flexibility and generality. The few methods available in the 

petroleum literature which uses unstructured grids do not follow a rigorous procedure for the 

fluxes determination. This causes difficulties when obtuse triangles are employed, giving rise 

to a misinterpretation of the transmissibility. The procedure advanced here, on the other hand, 

performs exact calculation of the mass fluxes and introduces facilitates to build grids for 

representing heterogeneities, horizontal wells and faults with more fidelity, contributing to 

decrease the simulation time. The resulting discretized equations were solved employing the 

methods IMPES (Implicit Pressure Explicit Saturation) and Fully Implicit. The resulting 

linear system was solved with the additive correction multigrid method, which agglomerates 

the grid-blocks based on the coefficients of the linear system.  

Local refinement is naturally done in this method, without the difficulties encountered 

in structured methods for the flux calculation at the intersection of coarse and fine grids. It is 

demonstrated that this method can deal with the permeability maps without averaging 

procedures, which is an important issue in simulating heterogeneous and anisotropic 

reservoirs. The physically consistent approach obtained leads to a clear interpretation of the 

transmissibility, revealing that right-angle or obtuse triangles can be used without grid 

construction restrictions. It is also demonstrated that it is less susceptible to the grid 

orientation effect with the increasing of the mobility ratio. The results obtained using the 

scheme proposed in this work in the EbFVM framework show its superiority over the 

schemes commonly used in petroleum reservoir simulation. 



 



1 

Cap.    

1 IINNTTRROODDUUÇÇÃÃOO    
 

 
  

Na indústria petroleira existe uma série de parâmetros que devem ser avaliados antes 

de se decidir pela viabilidade ou não de um reservatório natural de petróleo. Métodos diversos 

que possam contribuir para uma tomada de decisão são, de uma forma geral, bem aceitos nas 

empresas. E a razão é que elas precisam ter boas estimativas de produção que constituem-se, 

freqüentemente, em parâmetros cruciais utilizados pelos investidores e analistas financeiros 

para avaliar o seu potencial futuro. Neste sentido, as ferramentas numéricas são importantes 

instrumentos, já que a experimentação em laboratório é impossível, e a extração de petróleo e 

todas as operações vinculadas a ela podem ser otimizadas se houver uma forma de prever o 

comportamento do reservatório. Assim, os simuladores de reservatórios de petróleo têm uma 

decisiva função na indústria, e por isso têm recebido muita atenção em centros de pesquisa 

públicos e privados. 

Os reservatórios de petróleo são constituídos por rochas porosas localizadas na região 

subterrânea, onde o petróleo cru está estocado, conforme ilustrado na Fig. 1.1. O petróleo é 

produzido originalmente na rocha geradora, porém ele migra, principalmente por capilaridade 

e forças de empuxo, para a rocha reservatório, não conseguindo se deslocar para cima em 

função da presença de uma rocha capeadora, que tem baixa permeabilidade e que o envolve 

na parte superior. Portanto, para os interesses desta tese, a solução numérica terá como 

domínio apenas a região onde o petróleo permanece armazenado - a rocha reservatório. Esta 

situação física descrita é bem diferente daquela imaginada por algumas pessoas que crêem 

que o petróleo é encontrado em grandes “cavernas”, e o único trabalho para retirá-lo é o 

bombeamento. Na maioria das vezes, o petróleo só pode ser retirado do meio poroso através 

da ação de grandes gradientes de pressão criados por mecanismos físicos bem mais 

elaborados que os das bombas hidráulicas, denominados de processos de recuperação 

avançada. 



2 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

 
 

Fig. 1.1 - Representação do corte vertical de um reservatório sujeito a um processo de                                             

recuperação de petróleo com injeção de água. 

 

 

Em alguns casos, nos primeiros meses de produção de um reservatório, em função das 

elevadas pressões internas, a retirada do petróleo é feita sem grande esforço externo. Esta 

etapa recebe o nome de recuperação primária, e só é possível em função da “energia” 

existente no reservatório em forma de pressão, que provém dos gases solúveis no óleo, capas 

de gás, e do contato, muitas vezes existente, com aqüíferos naturais. À medida que esta 

energia vai decrescendo, a produção também vai diminuindo, embora grande parte do 

petróleo ainda permaneça no reservatório. A solução imediata é a utilização dos processos de 

recuperação secundária, Fig. 1.1, que caracteriza-se pela injeção de água em alguns poços 

com o intuito de suplementar a energia do reservatório e “forçar” o petróleo a escoar em 

direção aos poços produtores. 

A eficiência deste processo, em alguns casos, é ainda bastante baixa porque depende, 

principalmente, das mobilidades dos fluidos residentes (petróleo, gás etc.) e injetado (água). 

Para aumentar ainda mais a quantidade de óleo produzido, deve-se utilizar técnicas de 

recuperação terciária, que usam métodos químicos, como a injeção de polímeros adicionados 

à água, métodos térmicos, como a combustão in situ, e outros, como injeção de gás natural, 



 CAP. 1 – INTRODUÇÃO 3 

 

 

gás carbônico, introdução de bactérias etc1. As pesquisas ainda são incipientes em se tratando 

da muitos desses métodos de recuperação, e por isso ainda não são usados na maioria das 

empresas de petróleo. Contudo, os resultados preliminares têm sido muito promissores, apesar 

dos altos custos normalmente envolvidos nesses processos (MATTAX e DALTON, 1990; 

DYKE, 1997). Como todos esses métodos de recuperação são passíveis de serem modelados e 

estudados numericamente, pode-se notar novamente que o papel da simulação numérica de 

reservatórios de petróleo é cada vez mais importante. Isso é verdade mesmo que ainda hajam, 

em muitos casos, grandes incertezas na caracterização do reservatório e na determinação de 

suas propriedades físicas. Essas incertezas físicas não impedem, contudo, a busca de soluções 

que incrementem os modelos matemáticos adotados e que resultem em melhores previsões, 

como as propostas neste trabalho2.  

Em geral, o conjunto de equações resultantes do modelo matemático empregado na 

simulação de reservatórios é demasiadamente complexo para ser resolvido analiticamente. 

Por isso utilizam-se métodos numéricos que aproximam um sistema de equações diferenciais 

parciais em um sistema linear de equações algébricas. Neste caso a solução passa a ser obtida 

para um número discreto de pontos definidos por uma malha, assumindo-se um determinado 

erro que diminui quanto maior for esse número de pontos. Os primeiros simuladores de 

petróleo empregavam inicialmente apenas malhas Cartesianas, como a utilizada na 

representação do reservatório da Fig. 1.2a. A dificuldade de representar adequadamente as 

geometrias complexas dos reservatórios motivou a introdução de malhas curvilíneas, 

denominadas de malhas corner-points, tal qual a apresentada na Fig. 1.2b, que são construídas 

a partir da definição dos vértices de cada bloco da malha. Essas malhas, conhecidas como 

malhas de 2ª. geração, têm a desvantagem de ainda serem estruturadas, o que ocasiona em 

muitos casos a concentração desnecessária de nós em regiões do domínio de pouco interesse, 

                                                 
1 Verifica-se uma tendência na literatura moderna de petróleo em classificar os métodos de recuperação 
empregando-se apenas as expressões “primários” e “secundários” (THOMAS, 2001; GERRITSEN e 
DURLOFSKY, 2005; ROSA et al, 2006). Os métodos atualmente conhecidos como métodos de recuperação 
secundária são identificados nesta nova proposta como métodos convencionais de recuperação secundária, 
enquanto que os métodos de recuperação terciária são chamados de métodos especiais de recuperação 
secundária, ou no inglês: Enhanced Oil Recovery. Nesta nova classificação, qualquer método de recuperação 
que é utilizado para aumentar a eficiência de recuperação e/ou acelerar a produção em relação à produção 
primária é denominado de recuperação secundária. 

2 Na realidade, a simulação numérica também é responsável, de certa forma, pela determinação de propriedades 
físicas cada vez mais representativas, haja vista o desenvolvimento de métodos numéricos como os que 
determinam as curvas de permeabilidades relativas através da simulação de deslocamento em amostras porosas 
(MEJIA et al., 1995; KULKARNI et al., 1998; HURTADO et al., 2004), os que determinam as permeabilidades 
absolutas e porosidades através da simulação de problemas de mudança de escala - upscaling (RENARD e 
MARSILY, 1997; CHEN et al., 2003), da simulação com o Método de Lattice-Boltzmann (SANTOS et al., 
2005), entre outros. 



4 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

além do fato de que os simuladores comerciais utilizam um esquema de cálculo dos fluxos 

impreciso quando a malha é não-ortogonal (CORDAZZO et al., 2002). 

 

 

 

Fig. 1.2 - Diferentes tipos de malhas que podem ser utilizados na representação do reservatório da Fig. 1.1 

 

 

1.1. Motivação 
 

As dificuldades associadas à representação espacial de domínios arbitrários com 

malhas estruturadas em reservatórios com falhas e heterogeneidades, e a imprecisão numérica 

das técnicas de refinamento localizado têm motivado o interesse pela pesquisa na área da 

simulação numérica de reservatórios para a utilização de malhas não-estruturadas, como a 

apresentada na Fig. 1.2c. Essas malhas formadas por triângulos e/ou quadriláteros (em 2D) se 

conformam com mais facilidade, aumentando a flexibilidade na representação geométrica dos 

reservatórios. Alguns trabalhos da literatura propuseram o uso de tais malhas, mas com 

diversas limitações de ordem prática, seja por empregar dois pontos para a aproximação do 

fluxo e necessidade de ortogonalidade local, no caso das malhas de Voronoi (HEINEMANN 

et al., 1991; PALAGI e AZIZ, 1991), seja pela dedução das equações sob a ótica das malhas 

estruturadas, procurando manter a interpretação física de termos que não existem mais em 

malhas não-estruturadas (FUNG et al., 1991). Neste último caso, os erros numéricos 

acentuam-se demasiadamente quando são utilizados elementos de malha mais deformados. 

Estes métodos numéricos visam uma maior precisão nos resultados devido a uma 

                                       
 

(a) Malhas Cartesianas                                                           (b) Malhas corner-points 

 

 
 

(c) Malhas não-estruturadas (propostas neste trabalho) 



 CAP. 1 – INTRODUÇÃO 5 

 

 

representação mais fiel do domínio, mas perdem-na ao simplificar os cálculos dos fluxos entre 

os volumes de controle. Em resumo, os métodos atuais que empregam malhas não-

estruturadas não reúnem flexibilidade com precisão. A proposta deste trabalho, descrita a 

seguir, busca este objetivo. 

 

 

1.2. Objetivos 
 

A partir do exposto na seção anterior, pode-se apresentar o objetivo principal deste 

trabalho que é desenvolver uma metodologia numérica para a simulação de reservatórios de 

petróleo que utiliza o Método de Volumes Finitos baseado em Elementos (EbFVM) com 

solver3 multigrid, comparando-o com outras opções disponíveis nos simuladores comerciais. 

Nas últimas décadas o EbFVM vem sendo utilizado para a solução das equações de Navier-

Stokes, constituindo-se na forma mais adequada para generalizar o método dos volumes 

finitos (SCHNEIDER e ZEDAN, 1983; RAW, 1985; SOUZA, 2000). Propõe-se utilizar 

malhas bidimensionais não-estruturadas de triângulos e/ou quadriláteros no EbVFM, sem as 

restrições de forma encontradas nos métodos tradicionais.  

Os objetivos específicos podem ser resumidos como: 

 

 Obter as equações discretizadas do modelo matemático a partir do método EbFVM. 

 Apresentar a forma de solução das equações resultantes através das técnicas IMPES 

(Implicit Pressure and Explicit Saturation) e Totalmente Implícita, que requerem a 

implementação de novos procedimentos de cálculo de derivadas e resíduos 

aplicáveis para malhas não-estruturadas.  

 Estudar as alternativas de armazenamento das propriedades físicas, como 

permeabilidade absoluta e porosidade, e a modelagem de falhas geológicas no 

contexto das malhas não-estruturadas. 

 Implementar e avaliar o solver multigrid algébrico baseado na correção aditiva 

(HUTCHINSON e RAITHBY, 1986) para a solução do sistema linear originado 

                                                 
3 Por praticidade, o método de solução do sistema linear será simplesmente denominado de solver neste trabalho. 
 



6 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

com o método EbFVM. É importante o desenvolvimento de um solver robusto4 e 

rápido uma vez que grande parte do esforço computacional de uma simulação é 

despendido nesta etapa. Não se tem conhecimento da aplicação deste tipo de método 

multigrid algébrico em problemas de petróleo. A sua principal característica é a 

possibilidade de resolver sistemas lineares independentemente se a malha do 

problema que os originou é estruturada ou não.  

 Pretende-se também esclarecer certos tópicos que têm causado confusão na 

utilização das malhas não-estruturadas em simulação de reservatórios de petróleo, 

principalmente aqueles relacionados ao cálculo do fluxo entre volumes de controle. 

As transmissibilidades negativas, por exemplo, são termos importantes que 

aparecem nas equações de conservação discretizadas e têm sido um empecilho para 

a utilização de malhas não-estruturadas nesta área. 

 

Como objetivo final propõe-se avaliar a metodologia numérica proposta que, na 

realidade, culmina com o desenvolvimento de um completo simulador de reservatórios de 

petróleo, comparando seus resultados com aqueles obtidos a partir dos simuladores 

comerciais e com resultados provenientes de outros trabalhos publicados na literatura.  

 

 

1.3. Organização do Trabalho 
 

Além deste primeiro e introdutório capítulo, esta tese está distribuída em mais oito 

capítulos, estruturados de forma que as informações são apresentadas seqüencialmente 

visando facilitar o entendimento do leitor. O Cap. 2 contém uma revisão bibliográfica que 

descreve sucintamente alguns dos trabalhos relatados na literatura e procura contextualizá-los 

em termos da sua contribuição para o atual estado da arte da simulação numérica de 

reservatórios de petróleo. 

No Cap. 3 o problema físico é formulado e as equações governantes do escoamento 

em meios porosos são deduzidas. Também é apresentado o modelo físico adotado. 

 

                                                 
4 Robustez é a capacidade de resolver sistemas lineares provenientes de diferentes problemas físicos sem perda 
sensível de eficiência. Solvers robustos requerem pouca intervenção do usuário na mudança de seus parâmetros. 



 CAP. 1 – INTRODUÇÃO 7 

 

 

No Cap. 4 é apresentado de forma detalhada o processo de obtenção das equações 

discretizadas no Método dos Volumes Finitos baseado em Elementos (EbFVM). Também são 

discutidos alguns detalhes referentes a este método, como suas alternativas de representação 

das propriedades físicas e falhas e o procedimento de refinamento local de malha. 

A implementação computacional das duas alternativas de solução do sistema de 

equações adotadas neste trabalho é discutida no Cap. 5, onde os procedimentos de formação 

das matrizes de coeficientes locais e globais são destacados. 

No Cap. 6 são apresentados alguns aspectos relevantes de implementação do solver 

multigrid, como os mecanismos de transferência de informação entre diferentes malhas, 

operadores de restrição e prolongação, tipos de ciclos etc. 

O problema relatado na literatura da ocorrência de transmissibilidades negativas 

quando determinados tipos de elementos triangulares são utilizados é discutido no Cap. 7. 

Inicialmente são revisados alguns conceitos importantes relativos às transmissibilidades, 

sendo na seqüência estudada a sua aplicação em malhas que utilizam triângulos.  

Os resultados, comparações e discussões estão reservados para o Cap. 8, enquanto que 

as conclusões finais e sugestões para trabalhos futuros são apresentadas no Cap. 9. 



 



9 

Cap.    

2 RREEVVIISSÃÃOO  BBIIBBLLIIOOGGRRÁÁFFIICCAA    
 

 
 

Neste capítulo é apresentada a visão geral de alguns trabalhos relacionados aos 

assuntos estudados e desenvolvidos nesta tese que tiveram importância histórica e científica 

para o estado da arte da simulação numérica de reservatórios de petróleo. Esses trabalhos são 

sucintamente descritos e discutidos, sendo que uma discussão mais profunda, quando 

necessária, será feita nos capítulos seguintes onde estas questões serão abordadas com mais 

detalhes. 

 

 

2.1. Visão Histórica da Simulação Numérica de 
Reservatórios de Petróleo 

 

Desde a perfuração do primeiro poço de petróleo em 1859 até os primórdios do século 

20, as pessoas que trabalhavam nas companhias petroleiras não se preocupavam nos aspectos 

técnicos dos mecanismos físicos presentes nos reservatórios. Foi só a partir da década de 1930 

que começaram os primeiros estudos utilizando-se modelos físicos análogos, como 

escoamentos em caixas de areia e circuitos elétricos (NASH, 1990). A Fig. 2.1 apresenta 

resumidamente o quadro histórico do avanço científico nesta área, que culminou no estágio 

atual da simulação numérica de reservatórios de petróleo, e destaca alguns acontecimentos 

importantes que serão considerados nesta seção.  

Os primeiros simuladores de reservatórios de petróleo surgiram na década de 1950, 

quando algumas companhias petroleiras juntaram esforços em pesquisa fundamental e análise 

numérica a fim de desenvolver métodos práticos para uso nos computadores da época 

(MATTAX e DALTON, 1990). A principal motivação eram as atividades de planejamento de 



10 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

médio e longo prazo em grandes reservatórios, que eram aqueles que compensavam os 

investimentos nestes estudos. Os desenvolvimentos iniciais em simulação numérica utilizaram 

malhas Cartesianas (TODD et al., 1972; AZIZ e SETTARI, 1979; YANOSIK e 

MACCRACKEN,1979), que é uma das opções disponíveis e ainda muito utilizada nos 

simuladores comerciais atuais.  

 

 

 

Fig. 2.1 - Quadro histórico de acontecimentos relacionados à simulação numérica de reservatórios de petróleo 

(baseado no texto de Donald W. Peaceman em Nash (1990) e na literatura de petróleo em geral) 

 

 

As dificuldades associadas ao uso de malhas Cartesianas, e das malhas estruturadas 

em geral, vão desde a dificuldade de representação geométrica dos reservatórios até a 

necessidade de utilização de um número excessivo de nós em uma malha quando se deseja 

obter soluções mais acuradas em apenas uma parte do domínio (onde se tem que refinar 

obrigatoriamente toda uma linha e/ou coluna). Isso motivou o desenvolvimento de métodos 

de refinamento local (CIMENT e SWEET, 1973) em malhas Cartesianas. 

As idéias básicas da técnica de refinamento local utilizada nos simuladores atuais 

foram estabelecidas inicialmente por Von Rosenberg (1982). O autor propôs adicionar nós no 

interior de blocos de malhas Cartesianas a fim de melhorar a representação do escoamento 

naquela região. Heinemann et al. (1983), por outro lado, propuseram refinar localmente a 

malha cartesiana apenas por certo período de tempo, em um processo denominado de 

refinamento local dinâmico. Esse procedimento conseguiu reduzir significativamente o 

número de blocos necessários para representar adequadamente um reservatório. A grande 

dificuldade associada à utilização de técnicas de refinamento localizado em malhas 



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 11 
 

 

estruturadas é a perda de precisão numérica que ocorre no cálculo do fluxo entre blocos da 

malha grosseira com aqueles localizados na região refinada (MALISKA et al., 2001). 

 As malhas mais utilizadas atualmente na simulação de reservatórios de petróleo são 

aquelas em que os blocos são formados pela definição de seus vértices, em um formato global 

estruturado (WADSLEY, 1980; GOLDTHORPE e CHOW, 1985; FLEMING, 1987). Elas são 

conhecidas na indústria do petróleo como malhas corner-points, e são baseadas na proposta 

inicial de Hirasaki e O'Dell (1970) de utilizar coordenadas curvilíneas ortogonais. Este 

método tem a vantagem de gerar malhas coincidentes com a fronteira, o que possibilita a 

representação mais fiel de reservatórios com fronteiras complexas e falhas geológicas ao 

longo do reservatório. Sua maior limitação, no entanto, é a utilização de apenas dois valores 

nodais no cálculo do fluxo nas interfaces de dois volumes de controle, o que resulta sempre 

em um stencil de 5 pontos para 2D. Como a parcela dos fluxos cruzados é desprezada, surgem 

erros numéricos que aumentam com a não-ortogonalidade da malha (MALISKA et al., 2001). 

A idéia de utilizar malhas curvilíneas ortogonais para melhorar a representação do 

escoamento radial na região próxima a poços, e utilizar blocos retangulares no restante do 

domínio foi proposta por Pedrosa e Aziz (1986). Com essas malhas, denominadas de híbridas, 

obteve-se maior flexibilidade que os métodos anteriores, o que resultou em uma maior 

precisão na descrição do escoamento próximo a poços, muito embora tenha sido necessário 

aproximar o cálculo das transmissibilidades1 na interface entre os dois tipos de malhas. 

O método de coordenadas curvilíneas não-ortogonais surgiu para eliminar a 

imprecisão numérica advinda da aproximação do cálculo dos fluxos nas malhas corner-points 

(MALISKA et al., 1994; MOTA, 1994). O esquema numérico resultante passa a ser de 9 

pontos para 2D, o que é suficiente para calcular o fluxo de forma exata em malhas 

estruturadas, a menos dos erros de truncamento. A utilização deste método, no entanto, 

provoca uma pequena alteração na estrutura matricial do sistema linear que passa a ser mais 

cheia. 

Cordazzo et al. (2002) discorrem a respeito do cálculo do fluxo, e em conseqüência, 

das transmissibilidades em malhas corner-points. Além da dedução das equações de 

transporte neste sistema de coordenadas, os autores abordam a questão da adoção do esquema 

numérico de 5 pontos para problemas bidimensionais, utilizado por alguns programas 

comerciais, em detrimento da utilização do esquema de 9 pontos, que surge naturalmente em 

                                                 
1 A transmissibilidade é um fator geométrico dado pelo produto da área interfacial de dois volumes de controle e 
sua permeabilidade divididos pela distância entre os centros dos volumes. Mais detalhes serão dados no Cap. 7. 



12 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

função da discretização espacial. As conclusões apresentadas neste trabalho são aplicáveis a 

outros formatos de malhas utilizadas pelos simuladores comerciais.  

A utilização de malhas não-estruturadas parece ser o futuro inevitável para a 

simulação de reservatórios de petróleo porque supera com bastante elegância as dificuldades 

associadas à representação espacial dos domínios arbitrários, com falhas e heterogeneidades, 

e à imprecisão numérica das técnicas de refinamento, que surgem independentemente dos 

métodos estruturados serem de 5 ou 9 pontos. Este é o assunto abordado nas próximas seções. 

 

 

2.2. Contextualização do EbFVM em Relação aos Demais 
Métodos Empregados na Simulação de Reservatórios 

 

O método proposto neste trabalho - Método de Volumes Finitos baseado em 

Elementos – EbFVM (Element-based Finite Volume Method) foi empregado inicialmente na 

resolução das equações de Navier-Stokes com malhas não-estruturadas, resultando em 

softwares comerciais robustos como o CFX2, que tem sido utilizado na indústria com bons 

resultados. O EbFVM surgiu pela aplicação dos princípios de conservação diretamente em um 

ambiente de elementos finitos. Neste método as propriedades são conservadas em volumes de 

controle discretos construídos ao redor dos nós da malha. Baliga e Patankar (1983) 

introduziram esta idéia para elementos triangulares, enquanto que Schneider e Zedan (1983) 

para elementos quadriláteros. O elemento é a entidade definida pelos vértices da malha.  

Este método é usualmente denominado de método de elementos finitos baseado no 

volume de controle (CVFE - Control Volume Finite Elements) em função da flexibilidade 

geométrica obtida e a montagem das equações elemento a elemento. No entanto, essa 

denominação não é precisa porque dá a idéia de que se trata de uma técnica de elementos 

finitos que usa o volume de controle para a integração das equações. O mais adequado é 

denominá-lo de “Método de Volumes Finitos baseado em Elementos” (EbFVM – Element-

based Finite Volume Method), uma vez que este método continua ancorado nas premissas dos 

volumes finitos, isto é, realiza balanços em volumes elementares, utilizando, no entanto, a 

                                                 
2 CFX® é um software de simulação de dinâmica dos fluidos com transferência de calor e reações químicas, e é 
comercializado pela ANSYS Inc. of Canonsburg, Pennsylvania, USA. 



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 13 
 

 

representação geométrica via funções de forma que são tipicamente utilizadas no método dos 

elementos finitos (MALISKA, 2004).  

A fim de dar um suporte maior a escolha deste novo acrônimo (EbFVM), que será a 

denominação mantida doravante neste trabalho, é importante observar a Fig. 2.2, que 

apresenta um diagrama de blocos que contextualiza este método entre os principais métodos 

numéricos utilizados na literatura e que permite uma discussão mais profunda em torno deste 

tema.  

 

 

 
 

Fig. 2.2 - Diferenças entre os principais métodos numéricos (adaptado de Banaszek, 1995) 

 
 
 

Nesta figura está resumido o papel de qualquer método numérico que é o de obter uma 

solução aproximada de uma equação diferencial parcial através da construção e solução de 



14 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

um sistema de equações algébricas. Embora cada método tenha suas diferenças e 

particularidades, a figura demonstra que todos eles podem ser considerados métodos dos 

resíduos ponderados, sendo a função peso o parâmetro principal que diferencia um método do 

outro. 

Uma formulação em resíduos ponderados pode ser escrita como 

 

 ( ) 0
V

W dV =? L ?  (2.1)  

 
onde L  é o operador que representa a equação diferencial, ?  é a aproximação das variáveis 
incógnitas, V é o volume, e W é a função peso. Se W for igual a unidade no volume de 

controle e zero em outras posições, e se a equação estiver na sua forma conservativa, o 

método resultante será o:  

 

 

 Método de Volumes Finitos  

 

 

dependendo do tipo da função de interpolação. Caso a função peso seja a função delta de 

Dirac em um ponto, o método resultante será o das 

 

 Diferenças Finitas (FDM),  

 

enquanto que se W for o conjunto das funções de forma do elemento, obtém-se o 

 

 Método dos Elementos Finitos (FEM do tipo Galerkin). 

 

Portanto, como pode ser visto na Fig. 2.2, o EbFVM tem características que, na 

realidade, o identificam como um método de volumes finitos e não de elementos finitos, como 

o acrônimo CVFEM poderia sugerir, o que justifica a nova denominação “EbFVM” 

empregada neste trabalho. Detalhes adicionais e outras comparações entre esses métodos 

podem ser obtidos nos textos de Patankar (1980), Raw (1985), Cook et al. (1989), Shaw 

(1992), Banaszek (1995) e Maliska (2004). 

 Tradicional (FVM) ou o 
 

 baseado em Elementos (EbFVM),  



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 15 
 

 

2.3. Utilização de Malhas Não-Estruturadas na Simulação 
Numérica de Reservatórios de Petróleo 

 

O primeiro trabalho registrado na literatura a utilizar o EbFVM em problemas de 

petróleo foi o de Rozon (1989), que o denominou de “Método de Volumes Finitos 

Generalizado”. O autor discretizou as equações monofásicas para elementos quadrangulares e 

apresentou uma análise do erro de truncamento do método EbFVM em relação a outros 

métodos tradicionais. Foi mostrado que para a equação de Laplace e malha cartesiana 

uniforme, o erro de truncamento do EbFVM é menor que o obtido pelo Método dos 

Elementos Finitos do tipo Galerkin.  

Fung et al. (1991) apresentaram uma proposta de um Método de Volumes Finitos 

baseado em Elementos para elementos triangulares. Suas idéias são baseadas no trabalho de 

Forsyth (1990), que propôs a utilização dessa técnica nos procedimentos de refinamento 

localizado de malha, para obter uma transição mais suave entre as malhas grosseira e refinada. 

Nesse método o termo transmissibilidade é claramente identificado nas equações resultantes, 

o que foi considerado uma importante característica pois permite a sua direta implementação 

na estrutura atual dos simuladores comerciais. A discretização resulta em equações que são 

muito parecidas com aquelas obtidas pelos métodos tradicionais de volumes finitos, 

resultando, no entanto, em transmissibilidades calculadas de uma forma totalmente diferente. 

A transmissibilidade calculada desta forma não tem mais a interpretação física direta que teria 

se fosse obtida de acordo com os métodos tradicionais. 

A principal crítica que se pode fazer ao método desenvolvido por Fung et al. (1991) e 

que será considerada no Cap. 7 diz respeito à forma como as equações discretizadas 

multifásicas são deduzidas. O procedimento consiste inicialmente em forçar o aparecimento 

explícito dos termos de transmissibilidade, o que só é possível mediante a discretização das 

equações diferenciais monofásicas para elementos triangulares. Obtidas as equações 

discretizadas do caso monofásico, é sugerido simplesmente adicionar os termos de mobilidade 

?  às parcelas das equações, a fim de obter as equações do caso multifásico. Como será 

mostrado também no Cap. 7, este não é um procedimento correto porque o processo de 

discretização deve partir necessariamente das equações diferenciais multifásicas.  

O método proposto por Fung et al. (1991) foi utilizado em uma simulação de campo 

real por Sonier et al. (1993), que não tiveram problemas com instabilidades ou saturações 

negativas. No entanto, cuidados excessivos tiveram que ser tomados inicialmente para que os 



16 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

valores das transmissibilidades não resultassem negativos. Este valores ocorrem em 

decorrência da presença de triângulos obtusos. Houve então a necessidade de modificação da 

malha, refinando-a localmente, até que as transmissibilidades negativas desaparecessem, o 

que não foi, muitas vezes, uma tarefa fácil. Detalhes adicionais sobre as dificuldades 

associadas à geração das malhas neste método podem ser encontrados também no texto de 

Palagi (1992). 

Quandalle (1993) fez um estudo comparativo entre diversos simuladores comerciais e 

acadêmicos em alguns casos-padrão. Foi concluído que para atingir os mesmos resultados das 

malhas tradicionais de nove pontos, as malhas triangulares do Método de Volumes Finitos 

baseados em Elementos proposto por Fung et al. (1991) reduziram o tempo computacional em 

mais de cinco vezes, mesmo com a limitação geométrica da forma dos triângulos comentada 

anteriormente. De uma forma geral foi também observado que todos os simuladores 

conseguiram reduzir o número de volumes de um fator quatro ou mais utilizando malhas 

“flexíveis” em detrimento das Cartesianas.  

O método de Voronoi é outro método que emprega malhas não-estruturadas na 

simulação de reservatórios e que merece ser citado. Ele é um caso particular do EbFVM e 

apareceu como uma alternativa para aumentar a flexibilidade geométrica do Método de 

Volumes Finitos, mantendo a conservação das propriedades nos volumes de controle 

(HEINEMANN et al., 1991; PALAGI e AZIZ, 1991; MARCONDES et al., 1994; 

KUWAUCHI et al., 1996; SKOREYKO et al., 2003). Porém, pelo fato de utilizar a 

ortogonalidade local, este método apresenta restrições na construção da malha, e por 

empregar dois pontos para a aproximação do fluxo, ele apenas atende equações diferenciais 

com o tensor permeabilidade isotrópico. Menores restrições apresentam as malhas K-

ortogonais, que conferem ao método de Voronói uma maior flexibilidade porque são 

construídas levando-se em consideração a direção do escoamento (EDWARDS et al., 1998;  

MLACNIK et al., 2003).  

Um método diferente do proposto por Fung et al. (1991), mas que também utiliza 

malhas triangulares e que se caracteriza por manter os termos de transmissibilidades nas 

equações discretizadas, foi proposto por Verma e Aziz (1997). Neste método o 

armazenamento das propriedades físicas como porosidade e permeabilidade absoluta se dá 

nos volumes de controle construídos ao redor dos vértices dos triângulos. As 

transmissibilidades são determinadas através de um procedimento de média harmônica 

generalizada para problemas monofásicos, e a obtenção das equações para escoamento 



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 17 
 

 

multifásico é feita adicionando-se o termo de mobilidade nas equações discretizadas, o que 

não é um procedimento adequado, como já mencionado. 

Recentemente, Hurtado (2005) utilizou o Método de Volumes Finitos baseado em 

Elementos na simulação de escoamentos bifásicos bidimensionais utilizando elementos 

quadriláteros e esquema seqüencial de solução das equações. O autor mostrou que é possível 

reduzir, e praticamente eliminar em alguns casos, o efeito de orientação de malha a partir da 

utilização de funções de interpolação mais fortemente vinculadas à física do fenômeno 

considerado.  

 

 

2.4. Outros Métodos Utilizados na Simulação Numérica de 
Reservatórios de Petróleo 

 

Edwards e Rogers (1998) propuseram um método de volumes finitos que emprega 

malhas estruturadas não-ortogonais e que impõe a continuidade dos fluxos mediante a 

utilização de funções contínuas nas interfaces dos volumes. Esse procedimento é bastante 

apropriado para lidar com situações de grande anisotropia causada pelo tensor permeabilidade 

absoluta ou pela malha. A sua aplicação em malhas não-estruturadas foi proposta por 

Edwards (2003), com notável redução do custo computacional em relação ao método anterior. 

A busca por soluções mais rápidas tem motivado a pesquisa no desenvolvimento de 

métodos baseados nas linhas de fluxo (streamline), que caracterizam-se por permitir passos de 

tempo maiores para resolver a equação da pressão, resolvendo rapidamente uma equação 

semi-analítica unidimensional para a saturação em intervalos de tempo menores (BATYCKY 

et al., 1997; THIELE, 2001; MASCHIO e SCHIOZER, 2002). Esse método tem sido 

utilizado também para auxiliar os processos de geração de malhas e de mudança de escala – 

upscaling (EDWARDS et al., 1998; CASTELLINI, 2001). A tendência dos métodos 

streamline é serem implementados discretizando a equação da pressão em malhas não-

estruturadas (PRÉVOST et al., 2001; MLACNIK et al., 2003), e em modelos contendo 

termos de pressão capilar, compressibilidade e gravidade (BAKER et al., 2002). 

Uma das mais novas opções de cálculo do fluxo em simuladores comerciais é o 

esquema MPFA (Multi Point Flux Approximation), que apresenta um tratamento mais 

rigoroso dos termos relacionados à não-ortogonalidade da malha e do tensor permeabilidade 



18 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

(AAVATSMARK et al., 2001; ECLIPSE, 2004). Este esquema resulta no desejado stencil de 

9 pontos (para 2D) quando a malha é não ortogonal, ou quando o tensor permeabilidade não 

está alinhado com as direções coordenadas.  

Embora ainda não esteja presente no núcleo numérico dos simuladores de 

reservatórios comerciais mais conhecidos, o método de Elementos Finitos também tem sido 

utilizado na solução de problemas envolvendo escoamento em meios porosos e transferência 

de calor, com resultados relevantes. Este método é dominante na área da mecânica estrutural, 

particularmente nos problemas de elasticidade, mas aplica-se também em problemas mais 

gerais de mecânica dos fluidos. Neste sentido, pode-se citar o desenvolvimento dos métodos 

Mixed-Finite Element Methods (DARLOW et al., 1984; CAI et al., 1997; DOUGLAS et al., 

1997; HELMIG e HUBER, 1999), de Galerkin com funções de alta ordem descontínuas 

(BASTIAN, 2003), com métodos de estabilização (COUTINHO et al., 2004), e com multigrid 

(SILVA et al., 2000), entre outros.  

 

 

2.5. Métodos de Solução de Sistema de Equações Algébricas 
 

Uma vez obtido o sistema de equações discretizadas, deve-se escolher uma forma 

adequada de resolvê-lo. O método mais simples consiste em obter uma equação cuja única 

variável é a pressão, e expressões algébricas de determinação das demais variáveis, como a 

saturação. Um dos primeiros trabalhos publicados nesta direção foi o de Fagin e Stewart 

(1966), mas sua denominação atual - IMPES (Implicit Pressure and Explicit Saturation) foi 

proposta originalmente por Coats (1968). Sua maior limitação é a restrição do passo de tempo 

devido à avaliação explícita das saturações. 

 Hoje em dia, mesmo com o advento de novas técnicas de solução de equações 

lineares, o método IMPES ainda vem sendo utilizado e aprimorado no sentido de obter passos 

de tempo maiores e que resultem em soluções sem instabilidades numéricas (COATS, 2000; 

COATS, 2003; TCHELEPI et al., 2005; SHIRALKAR et al., 2005).  

 Para modelos composicionais, onde são resolvidas equações de diferentes 

componentes, a generalização do método IMPES é o IMPSAT (Implicit Pressure and 

Saturation and Explicit Component Mole Fraction), em que apenas a pressão e a saturação 

são tratados implicitamente, enquanto que as frações molares de todos os componentes são 

tratadas explicitamente. Nos trabalhos pioneiros de Quandalle e Savary (1989) e Branco e 



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 19 
 

 

Rodriguez (1996) este método recebeu as denominações de IMPIMS e modelo semi-

implícito, respectivamente. No entanto, foi apenas no início desta década que o IMPSAT foi 

analisado mais profundamente, estabelecendo-se critérios de estabilidade e comparando-o 

com os modelos IMPES e Totalmente Implícito (CAO e AZIZ, 2002). 

 Os Métodos Totalmente Implícitos surgiram como uma alternativa para obter soluções 

mais rápidas que o método IMPES, principalmente para malhas mais refinadas e com regiões 

que apresentam altas velocidades de fluido, porque as suas limitações no tamanho do passo de 

tempo são menos restritivas (MATTAX e DALTON,  1990). Eles consistem na solução de 

um sistema de equações que envolve todas as variáveis. Este procedimento normalmente é 

realizado através do método de Newton.  

Blair e Weinaug (1969) foram os pioneiros na utilização do método de Newton na 

simulação de reservatórios de petróleo e, desde então, esse método vem sendo utilizado por 

boa parcela dos softwares comerciais (IMEX User’s Guide, 2002; ECLIPSE Technical 

Description, 2004; entre outros). Rigorosamente, a melhor denominação para este método 

seria “método de Newton inexato” (DEMBO et al., 1982), porque o sistema linear é resolvido 

com solvers iterativos, isto é, não de forma exata3. No entanto, convencionou-se na literatura 

de petróleo denominá-lo simplesmente de “método de Newton”, sendo essa, também, a 

denominação empregada em todo este trabalho.  

A solução de sistemas lineares oriundos de malhas com grande número de nós no 

método implícito pode representar um custo computacional alto, porque a dimensão das 

matrizes neste método é tipicamente grande. Por isso, Thomas e Thurnau (1983) propuseram 

tratar explicitamente as variáveis correspondentes a certos volumes de controle, enquanto que 

as demais são resolvidas implicitamente, o que reduz a dimensão do sistema linear e, em 

conseqüência, o custo computacional. Esse método, denominado de adaptativo (AIM - 

Adaptive Implicit Method), tem recebido desde então atenção da comunidade científica 

(COLLINS et al., 1986; YOUNG e RUSSELL, 1993; MARCONDES, 1996; CAILLABET et 

al., 2003), estando presente nos núcleos numéricos de importantes simuladores comerciais 

(IMEX, 2002; ECLIPSE, 2004) apresentando excelentes resultados. 

 

 

                                                 
3 Quando o sistema linear é resolvido de forma exata e a matriz jacobiana é construída de forma exata, o método 
de Newton apresenta convergência de 2ª. ordem.  



20 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

2.6. Métodos Multigrid de Solução de Sistemas Lineares 
 
 

Independentemente do esquema de solução das equações adotado - IMPES, 

Totalmente Implícito, AIM ou outros - o maior custo computacional associado a uma 

simulação numérica deve-se ainda à solução do sistema linear resultante. Neste sentido, os 

métodos multigrid têm se mostrado muito eficientes e robustos na obtenção das soluções. 

A eficiência de um método multigrid pode ser entendida pela análise espectral dos 

erros da solução4. Diversos trabalhos na literatura demonstram que esses erros podem ser 

representados através da superposição de ondas de diferentes freqüências (BRIGGS et al., 

2000; TROTTENBERG et al., 2001, entre outros). Além disso, pode-se mostrar que apenas 

os erros que possuem comprimento de onda da ordem do tamanho da malha é que são 

reduzidos com rapidez nos solvers iterativos. Os outros erros, de menores freqüências para 

esta malha, são reduzidos com muita dificuldade e são os causadores da estagnação do solver. 

Esta observação indica que diferentes malhas são necessárias para poder reduzir todo o 

espectro de freqüências do erro. Métodos que se valem desta constatação são denominados 

multigrid. Nestes métodos, ao serem utilizadas malhas sucessivamente mais grosseiras, 

eliminam-se também os erros que possuem comprimento de onda da ordem do tamanho de 

cada uma das malhas. Com isso todas as componentes do erro são reduzidas com eficiência, 

diminuindo consideravelmente o tempo de computação. 

Os métodos multigrid começaram a ser investigados a partir da década de 1960 com 

os trabalhos de Fedorenko (1964) e Bakhvalov (1966). Porém, foi apenas nas décadas de 1970 

e 1980 que os métodos multigrid tiveram popularidade a partir dos trabalhos de Brandt (1973 

apud TROTTENBERG et al., 2001), quando os métodos multigrid geométricos foram 

introduzidos. Neste tipo de multigrid, o processo de formação das malhas grosseiras se dá 

estritamente em função de aspectos geométricos da malha original, sendo necessária a 

discretização das equações nas malhas grosseiras também. 

As dificuldades associadas à discretização das equações nas malhas grosseiras 

motivou o desenvolvimento dos métodos multigrid algébricos, que foram introduzidos por 

Brandt et al. (1982 apud CLEARY et al., 1999). Esses métodos têm uma característica 

importante: não é necessário repassar nenhuma informação a respeito da malha e do esquema 

de discretização. É suficiente repassar apenas o sistema linear, isto é, a matriz de coeficientes, 

                                                 
4 O erro da solução é definido neste trabalho como a diferença entre a solução exata do sistema linear e a  
solução numérica disponível em uma determinada iteração.  



 CAP. 2 – REVISÃO BIBLIOGRÁFICA 21 
 

 

o vetor de termos independentes e uma estimativa inicial da solução. Foi a primeira tentativa 

de tornar o solver multigrid uma “caixa-preta”, desvinculando-o dos procedimentos 

numéricos.  

A partir das idéias de Settari e Aziz (1973) surgiram os métodos multigrid algébricos 

baseados na correção aditiva (HUTCHINSON e RAITHBY, 1986; VAN DOORMAAL et al., 

1987), que têm como principal característica a inserção da física na concepção do solver, 

através da manutenção dos princípios de conservação nas malhas grosseiras. Neste método as 

equações são deduzidas apenas para a malha refinada, sendo as equações utilizadas nas 

malhas grosseiras obtidas apenas somando-se os coeficientes da malha original. Por isso não é 

necessário ter stencils fixos, o que evita inconsistências entre as malhas e é uma característica 

muito apropriada para aplicação do método em malhas não-estruturadas. 

A robustez do método multigrid baseado na correção aditiva é destacada no trabalho 

de Raw (1996), onde uma variedade de problemas acoplados regidos pelas equações de 

Navier-Stokes são resolvidos sem modificações dos parâmetros do solver. Essa é uma 

vantagem notável, porque os métodos tradicionais como Gradiente Conjugado e GMRES 

apresentam uma taxa de convergência muito sensível ao número de condição da matriz, e 

quando são precondicionados tornam-se muito sensíveis ao tipo de problema analisado. 

Os estudos de Elias et al. (1997) mostraram que se perde eficiência nos métodos 

iterativos quando as equações discretizadas têm coeficientes anisotrópicos5. Isso acontece 

porque os solver iterativos, além de reduzir com eficiência apenas os erros cujo comprimento 

de onda são equivalentes ao tamanho da malha, eles o fazem preferencialmente na direção dos 

grandes coeficientes. Nesses casos a anisotropia dos coeficientes origina diferentes escalas de 

tempo de propagação da informação, afetando diretamente o comportamento da convergência. 

Os autores mostram que uma aglomeração dos volumes de controle da malha refinada que 

vise reduzir a anisotropia dos coeficientes das malhas grosseiras torna o método multigrid 

ainda mais eficiente. A razão é a diminuição da variação das escalas de tempo de propagação 

da informação nas malhas grosseiras. 

Como visto, os métodos multigrid algébricos baseados na correção aditiva têm grande 

potencial a ser explorado na simulação de reservatórios de petróleo com malhas não-

estruturadas. Desde os trabalhos pioneiros de Behie e Forsyth (1983a e 1983b), que utilizaram 

o multigrid geométrico na solução da equação da pressão em problemas com coeficientes 

descontínuos, a falta de flexibilidade geométrica advinda deste tipo de método multigrid tem 

                                                 
5 Esses coeficientes surgem devido à razão de aspecto da malha diferente da unidade e/ou à propriedades físicas 
diferentes em cada direção. 



22 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

sido uma barreira à sua aplicação prática. A despeito disso, diversos trabalhos mostram 

resultados bem satisfatórios na utilização deste tipo de solver em problemas específicos na 

simulação de reservatórios de petróleo (DENDY et al., 1989; COLLINS e MOURITS, 1991; 

CRUMPTON et al., 1995; RODRIGUES e DICKSTEIN, 1996; PARSONS e COUTINHO, 

1999; BASTIAN e HELMIG, 1999; SILVA et al., 2000). 



23 

Cap.    

3 FFOORRMMUULLAAÇÇÃÃOO  MMAATTEEMMÁÁTTIICCAA    
 

 
 Neste capítulo são apresentadas as equações governantes do escoamento em meios 

porosos, juntamente com as aproximações do modelo adotado. As equações são deduzidas 

partindo-se da situação mais simples (escoamento monofásico) até a obtenção das equações 

governantes do modelo composicional geral. A partir de então, serão feitas as hipóteses 

necessárias para a apresentação do modelo adotado neste trabalho. 

 

3.1. Equações Governantes do Modelo Composicional Geral 
 

 Desconsiderando, por simplicidade, fenômenos que não interferem na generalidade do 

método proposto, como reações químicas e o transporte por difusão molecular e dispersão 

hidrodinâmica, a equação de conservação da massa em um escoamento monofásico em meios 

porosos é dada por 

 

( ) ( ). qV
t

? ?
? ?

?
= ?? +

?
 (3.1) 

 

cuja dedução pode ser encontrada na literatura de petróleo em geral (PEACEMAN (1977), 

por exemplo). Nesta equação, ? é a porosidade, que representa a fração de volume que está 

disponível para o escoamento, ?  é a densidade do fluido avaliada nas condições de 

temperatura e pressão do reservatório, V  é a velocidade da fase e q é a vazão volumétrica de 

produção/injeção da fase por unidade de volume do reservatório (positivo para injeção e 

negativo para sucção). 



24 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

Em um passo intermediário rumo ao modelo composicional geral, consideram-se os 

escoamentos multifásicos que apresentam fases formadas por componentes que são 

imiscíveis. Neste caso, a equação de conservação da massa, Eq. (3.1), será escrita como 

 

( ) ( ).m m mm m m
s

qV
t

? ?
? ?

?
= ?? +

?
 (3.2) 

 

onde o sub-índice m indica grandezas associadas à fase e s é a saturação que é definida como 

a fração do espaço poroso ocupada pela fase. Essa nova variável é importante no modelo 

estudado porque será uma de suas variáveis primárias. A sua definição em termos de fração 

de espaço poroso implica que a soma das saturações das Nm fases presentes no meio poroso 

tem que ser igual a unidade,  
 

1
1

mN

m
m

s
=

=?  (3.3) 

 

Essa é uma relação importante e será bastante útil oportunamente.  

A Eq. (3.2), no entanto, não se aplica à reservatórios típicos, onde existem diversos 

componentes ou espécies químicas que formam as fases óleo, gás e água, que se dissolvem e 

vaporizam, migrando de uma fase para outra em função das condições de pressão e 

temperatura. Em situações como estas, podem ou não existir os mesmos componentes em 

cada uma das fases, e em conseqüência, alguma fase pode até mesmo deixar de existir (o que 

é bastante comum com a fase gasosa). O emprego das Eqs. (3.1) e (3.2) implica, 

necessariamente, na conservação da massa da fase, além da do componente, em função da 

presença de apenas um componente em cada fase. Isso deixará de acontecer em modelos mais 

gerais, porque a massa da fase poderá não mais ser conservada, embora os princípios de 

conservação da massa dos componentes devam continuar sendo satisfeitos. 

Por isso, em situações onde um componente pode migrar de uma fase para outra, a Eq. 

(3.2) deve ser generalizada, para que a massa daquele componente que, eventualmente, esteja 

distribuído em diferentes fases, também seja conservada:  

 

1 1 1

.
m m mN N N

cm m m cm m m cm m m
m m m

X s X V X q
t

? ? ? ?
= = =

? ?? ? ? ??
= ?? +? ?? ? ? ?? ? ? ? ?? ?

? ? ?  (3.4) 

 



 CAP. 3 – FORMULAÇÃO MATEMÁTICA 25 

 

 

e, para tanto, é necessário definir a grandeza Xcm  que é a fração mássica do componente c na 

fase m dada por 

 

cm
cm

m

m
X

m
=  (3.5) 

  

 Em meios porosos, a velocidade da fase, mV , pode ser relacionada com o gradiente de 

pressão (DARCY, 1856), e para um reservatório horizontal pode ser determinada através de 

 

rm
m m

m

k k
V p

µ
= ? ?  (3.6) 

 

onde k  é o tensor permeabilidade absoluta do meio poroso, mµ  é a viscosidade da fase, mp  é 

a pressão da fase, e krm é a permeabilidade relativa da fase.  

 É importante notar que o fator que multiplica o gradiente de pressão na Eq. (3.6) é 

composto por termos que dependem apenas das propriedades da rocha (permeabilidade 

absoluta), das propriedades do fluido (viscosidade) e das propriedades de interação de ambos 

(permeabilidade relativa).  

Como é usualmente calculada em função da saturação, a permeabilidade relativa pode 

ser representada através de curvas como as apresentadas na Fig. 3.1, de onde se pode 

determinar a região do gráfico onde as duas fases podem escoar. Essa região é delimitada 

pelos valores de saturação de água em que as permeabilidades relativas das duas fases não são 

nulas: 

 

(1 )wi w ors s s&amp;lt;&amp;lt;?  (3.7) 

 

onde wis  é a saturação de água irredutível e ors  é a saturação de óleo residual. Os valores 

limites maxrok  e 
max
rwk  são valores obtidos das curvas de permeabilidades relativas avaliados nas 

saturações wis  e 1w ors s= ? , respectivamente.  



26 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

 

Fig. 3.1 – Forma típica das curvas de permeabilidade relativa, destacando alguns parâmetros importantes 

envolvidos na sua definição 

 

 

É importante frisar que, independentemente do valor da força motriz a que está 

submetido o reservatório (o gradiente de pressão, por exemplo), não é possível haver valores 

de saturação fora do intervalo delimitado no gráfico da Fig. 3.11. 

 

 

3.2. Equações Governantes do Modelo Black-Oil 
 

A solução do modelo composicional descrito na seção anterior e representado pela Eq. 

(3.4) é altamente custosa computacionalmente na maioria dos casos práticos. Para 

reservatórios que possuem óleos pesados e com baixa volatilidade pode-se utilizar um modelo 

simplificado denominado de Black-Oil, e que caracteriza-se por utilizar grandezas mais 

facilmente mensuráveis, como o fator volume de formação, solubilidade etc., descritas a 

seguir. 

                                                 
1 Existem duas exceções que não são estudadas neste trabalho: 
   I. A simulação, em um mesmo modelo, de reservatórios de petróleo e seus aqüíferos associados (sw = 100%). 
   II. A simulação de escoamentos que se iniciam monofásicos mas que tem a possibilidade da geração de uma 
segunda fase que nunca esteve presente no meio poroso. A simulação da formação das bacias geológicas que 
visa prever o aparecimento do petróleo é um exemplo disso. A condição inicial é o preenchimento completo do 
meio poroso com água, e, com o tempo, em função das condições de pressão e temperatura, a rocha geradora 
passa a produzir o óleo que é acumulado nos poros até atingir a sua saturação crítica que lhe permitirá escoar. 
Durante este processo que ocorre entre 1&gt;sw&gt;(1–sor) a permeabilidade relativa da água vai diminuindo de 1.0 até 

max
rwk  pois o óleo começa o ocupar o espaço poroso antes ocupado completamente pela água.  

 



 CAP. 3 – FORMULAÇÃO MATEMÁTICA 27 

 

 

 

Fator volume de formação. O fator volume de formação, B, é definido como a relação 

entre o volume da fase nas condições do reservatório e o volume da fase nas condições de 

estocagem, geralmente na superfície. Este fator incorpora, pelo menos, três fenômenos físicos 

que causam a variação volumétrica da fase (McCAIN, 1990) que são: 

 

1. a variação da pressão; 

2. a variação da temperatura; 

3. a dissolução da fase gasosa nas demais fases. 

 

Para a fase óleo, normalmente o volume que vai para a superfície é menor que aquele 

que residia no reservatório, o que resulta em valores maiores que a unidade para o fator 

volume de formação desta fase. Isso acontece porque, como na maioria das vezes a 

temperatura é bem maior no reservatório que na superfície, a expansão que ocorre na 

superfície pela redução da pressão não consegue suplantar a contração devido à diferença de 

temperatura. Além disso, como a pressão na superfície normalmente é menor que no 

reservatório uma boa parcela do gás dissolvido no óleo é expulso desta fase, contribuindo 

também para a redução do volume de óleo nas condições de estocagem.  

No entanto, o escoamento é assumido isotérmico no modelo Black-Oil, e portanto, o 

fenômeno físico “variação da temperatura” (item 2 mencionado anteriormente) não 

contribuirá para modificar do fator volume de formação neste modelo. O modelo Black-Oil 

também admite que não existe transferência de massa entre a fase água e as fases óleo e gás, 

sendo as fases água e óleo imiscíveis, e o componente gás pode ser dissolvido na fase óleo. 

Com estas simplificações, o fator volume de formação do óleo passa a depender 

apenas da pressão, apresentando um comportamento típico como o retratado na Fig. 3.2. 

Percebe-se que para baixas pressões, o fator volume de formação aumenta com o incremento 

da pressão, e isto acontece porque maior quantidade de gás passa a se dissolver na fase óleo. 

Para valores de pressão maiores que a pressão de bolha, pb, não há mais gás que não tenha 

sido dissolvido no óleo, e por isso a cada aumento do valor da pressão o volume da fase, 

como um todo, começa a reduzir. 

 



28 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

 

Fig. 3.2 - Curva típica do fator volume de formação em função da pressão, onde pb é a pressão de bolha  

 
 

Quanto à fase água, admite-se normalmente que não há dissolução de outra fase, logo 

a curva do fator volume de formação para esta fase é praticamente linear, com um 

comportamento muito semelhante ao da curva da Fig. 3.2 para pressões maiores que a de 

bolha (pb). 

 

Solubilidade. Uma outra grandeza importante no modelo Black-Oil é a solubilidade de 

um componente em uma dada fase, que é matematicamente definida por  

 
e

cm
cm e

mm

V
R

V
=  (3.8) 

 

onde cmR  é a solubilidade do componente c na fase m, 
e

cmV  é o volume do componente c na 

fase m que é liberado nas condições de estocagem, e  emmV  é o volume liberado do componente 

principal da fase m na fase m nas condições de estocagem.  

 

 Dedução das equações do modelo. A dedução das equações de conservação no 

modelo Black-Oil tem início a partir da substituição da Eq. (3.8) na expressão que define a 

massa específica do componente c que é liberado da fase m nas condições de estocagem, 

 

e cm
c e

cm

m
V

? =  (3.9) 

 

que resulta em 

 



 CAP. 3 – FORMULAÇÃO MATEMÁTICA 29 

 

 

/ ecm c
cm e

mm

m
R

V
?

=  (3.10) 

 

Como o fator volume de formação pode ser expresso matematicamente como 

 

m
m e

mm

V
B

V
=  (3.11) 

 

onde mV  é o volume da fase no reservatório, pode-se reescrever a Eq. (3.10) como 

 

/
/

e
cm c

cm
m m

m
R

V B
?

=  (3.12) 

 

ou 

cm m m
cm m cm me e

m c c

m
R B X B

m
? ?
? ?

= =  (3.13) 

 

quando são substituídas as expressões da massa específica da fase, m? , e da fração mássica, 

cmX , Eq. (3.5). 

Reescrevendo a Eq. (3.13) como 

 
e
c

cm m cm
m

X R
B
?

? =  (3.14) 

 

e  substituindo-a, acompanhada da Eq. (3.6), na Eq. (3.4), e dividindo todos os termos pela 

massa específica do componente nas condições de estocagem, ec? , tem-se a equação geral do 

modelo Black-Oil, 

 

1 1 1

.
m m mN N N

cm cm rm cm
m m m

m m mm m m m

R R k k R
s p q

t B B B
?

µ= = =

? ?? ?? ??
= ? ? +? ?? ?? ? ? ?? ? ?? ? ? ?

? ? ?  (3.15) 

 



30 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

onde, pelas simplificações já comentadas neste modelo, a única solubilidade que depende da 

pressão é a do gás no óleo, Rgo: 

 

( )

1              0              0

              0               0 1 

1               0                       

ww ow wg

oo wo gw

gg og go s

R R R
R R R

R R R R p

= = =

= ==

= = =

 (3.16) 

 

 

3.3. Modelo Água-Óleo 
 

Optou-se neste trabalho por utilizar o modelo Água-Óleo, que é uma versão 

simplificada do modelo Black-Oil, que consiste apenas na simulação de duas fases imiscíveis 

(água e óleo), isto é, Nm = 2. Desprezar-se-ão também as pressões capilares, o que implica em 

 

w op p p= =  (3.17) 

 

 Além disso, deve-se lembrar que anteriormente já foi desprezado o gradiente de 

pressão gravitacional na definição da Lei de Darcy, Eq. (3.6), por se tratar aqui de 

reservatórios horizontais. Todas as aproximações adotadas neste trabalho não comprometerão 

as discussões e resultados a serem obtidos, uma vez que deseja-se estudar aspectos gerais da 

solução numérica das equações. A despeito de suas simplificações, este modelo pode ser 

aplicado em alguns casos reais, como nos sistemas dead-oil, caracterizados por apresentarem 

óleo em pressões baixas e sem a fase gás dissolvida (GERRITSEN e DURLOFSKY, 2005). 

Efetuadas as simplificações, a Eq. (3.15) pode ser reescrita para os fluidos água e óleo, 

como 

 

( )  w ww
w

s
qk p

Bt
? ?
? ?? = ? +??? ?? ? ?

  (3.18) 

e 

( )  o oo
w

s
qk p

Bt
? ?
? ?? = ? +??? ?? ? ?

  (3.19) 

 



 CAP. 3 – FORMULAÇÃO MATEMÁTICA 31 

 

 

onde w e o são os índices das fases água e óleo, respectivamente, ? é a mobilidade de cada 

fase e q~  representa a vazão volumétrica nas condições de estocagem por unidade de volume 

do reservatório, dados por 

 

ro
o

o o

k
B

?
µ

=       e      rww
w w

k
B

?
µ

=  (3.20)  

o

o
o B

q
q =~           e      

w

w
w B

q
q =~  (3.21) 

  

As Eqs. (3.18) e (3.19) do modelo bifásico adotado são equivalentes a Eq. (3.2), mas 

com a vantagem de utilizar grandezas mais facilmente mensuráveis, como o fator volume de 

formação.  Essas equações formam um sistema de duas equações com três incógnitas: p, sw e 

so. A outra equação necessária para o fechamento do problema advém da inspeção de que 

todo o espaço poroso deve estar completamente preenchido pelos fluidos, dada por 

  

1w os s+ =  (3.22) 

 

Esta expressão será doravante chamada de equação de restrição volumétrica. 

As condições de contorno utilizadas normalmente em reservatórios que não 

apresentam aqüíferos são do tipo “contorno selado”, isto é, admite-se fluxo nulo nas fronteiras 

do domínio. A interação com o meio externo ao reservatório se dá, portanto, na maioria das 

vezes apenas por meio da especificação de poços (termo fonte/sorvedouro). 

As viscosidades de cada fase na Eq. (3.20) podem ser consideradas como função da 

pressão por 

 

( )ref refm m mc p pµµ µ= + ?  (3.23) 
 

onde 
m

cµ  é o coeficiente que expressa a dependência da viscosidade com a pressão, e as 

grandezas com super-escrito ref indicam valores de referência. 

Finalmente é importante mencionar que nas Eqs.  (3.18) e (3.19), em função de não 

haver fase gás neste modelo, o fator volume de formação de ambas as fases é definido apenas 

para o intervalo de pressão acima da de bolha (ver Fig. 3.2), onde é assumido uma variação 

linear com a pressão, dada por 



32 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 
 

 

?
?
?

?

?
?
?

?
?
?
??

?
? ??= refm

ref
mm ppc1BB  (3.24) 

 

onde cm é a compressibilidade da fase m definida por 

 

T

m

m
m p

1
c

?
?

=
?

?
 (3.25) 

 
 A solução do modelo Água-Óleo apresentado nesta seção é o assunto considerado no 

próximo capítulo. 



33 

Cap.    

4 
FFOORRMMUULLAAÇÇÃÃOO  NNUUMMÉÉRRIICCAA  

  PPAARRTTEE  11  --  EEMMBBAASSAAMMEENNTTOO  TTEEÓÓRRIICCOO  EE  FFUUNNDDAAMMEENNTTOOSS  

 

 

 
As equações que compõem o modelo matemático apresentadas no capítulo anterior 

são complexas para serem resolvidas de forma analítica. Neste trabalho elas são resolvidas 

numericamente através do Método dos Volumes Finitos baseado em Elementos (EbFVM – 

Element-based Finite Volume Method), apresentado de forma detalhada neste capítulo. 

Como em qualquer método de volumes finitos, o procedimento de obtenção das 

equações discretizadas tem início com a integração das equações diferenciais governantes, 

neste caso as deduzidas no capítulo anterior e que são apresentadas novamente por 

completeza 

  

( )  m mm
m

s
qk p

Bt
? ?
? ?? = ? +??? ?? ? ?

 (4.1) 

 

onde o sub-índice m indica que esta equação é utilizada para ambas as fases – água e óleo (m 

= w ou o). Deve-se lembrar que, durante a dedução do modelo matemático, os termos de 

gravidade, reações químicas, efeitos térmicos e pressão capilar foram desprezados por 

simplicidade, pois não interferem na generalidade do método numérico apresentado. 

O modelo bifásico forma um sistema de duas equações e três incógnitas:  p, sw e so. A 

outra equação necessária para o fechamento do problema vem da condição de que o espaço 

poroso é totalmente preenchido pelas fases, sendo chamada de equação de restrição 

volumétrica dada pela Eq. (3.22). 

 
 



34 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

4.1. O Método EbFVM 
 

Integrando a equação diferencial, Eq. (4.1), no tempo e em um volume de controle 

finito, na forma 
 

( )
, , ,

    m mm
mV t V t V t

s
dVdt q dVdtdVpk dtt B

? ?
? ?? = +? ?? ? ?? ? ?

? ? ?  (4.2) 

 
e dividindo o resultado por t? , obtém-se  

 

( ) ( )  
o

m mP P
o mm P

m m VP

s sV
qdVk pt B B

? ? ?? ?
? ??

? = +???? ?? ? ?
?  (4.3) 

 
Nesta expressão, as grandezas acompanhadas do sub-índice “P” são referentes ao volume de 

controle P onde a integração está sendo efetuada. O super-índice “o” refere-se a grandezas 

avaliadas no passo de tempo anterior, o super-índice ?  indica que ainda é necessário definir 

em que limites do intervalo de tempo será avaliada a grandeza e q  é a vazão volumétrica 

dada por 

 

m mq q V= ?  (4.4) 

 

em [L3.T-1], como é normalmente utilizada nos simuladores comerciais (IMEX User’s Guide, 

2002; STARS User’s Guide, 2002). Como esta vazão é dependente do modelo de poço 

utilizado, ela poderá ser calculada de diferentes formas, como será mostrado no próximo 

capítulo. A definição de quais termos serão tratados implicitamente na Eq. (4.3) também será 

feita no próximo capítulo, com exceção da pressão, que será desde já considerada implícita 

neste trabalho (   p p? = ).  

Aplicando o teorema da divergência de Gauss no primeiro termo do lado direito da Eq. 

(4.3), este termo poderá ser escrito como 

 

( )    .m m
V S

dVk p k p dS
? ?? ?=? ???? ?  (4.5) 

 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 35 

 

 

que é uma integral de superfície sobre todas as faces de um volume de controle. Esta integral 

pode ser aproximada numericamente utilizando o valor da função no ponto médio de cada 

segmento que forma esta superfície  

 

( )  .m m
ii PS

k p Sk p dS
? ?? ?

? ?

? ??? ??  (4.6) 

  

onde i representa estes pontos médios, denominados de pontos de integração. A partir deste 

momento, portanto, é necessário definir os volumes de controle no método numérico adotado 

para ilustrar a posição destes pontos. 

Definindo o elemento como a entidade geométrica delimitada pelos nós da malha, e o 

volume de controle como a região do domínio onde as equações diferenciais governantes são 

integradas, o conceito tradicional usando em volumes finitos estabelece que o elemento da 

malha e o volume de controle são entes geométricos coincidentes (cell centered construction), 

como demonstrado na Fig. 4.1a. Percebe-se que os nós fornecidos pelo gerador de malha 

servem para delimitar espacialmente o volume de controle, mas as propriedades são 

calculadas no seu centro geométrico. No EbFVM, por sua vez, o volume de controle não 

coincide mais com o elemento, e é construído ao redor dos nós da malha (cell vertex 

construction), conforme mostrado na Fig. 4.1b, através da união de parcelas (sub-volumes de 

controle) provenientes dos elementos que rodeiam determinado nó.  

 

 

        
(a)              (b)  

 

Fig. 4.1 - Definição dos elementos e volumes de controle no (a) Método de Volumes Finitos tradicional (FVM) e 

(b) no Método de Volumes Finitos baseado em Elementos (EbFVM) 



36 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Cada um dos 5 sub-volumes destacados na Fig. 4.1b que formam o volume de controle 

ao redor do nó P e que são denominados de svc1 a svc5 possuem a mesma regra de formação: 

são delimitados por retas que saem das medianas das faces dos elemento até seu baricentro. 

Os pontos de integração estão localizados no centro de cada uma das faces que não se 

comunicam com o nó central do volume de controle, e nestas posições é que são avaliadas as 

integrais de superfície dadas pela Eq. (4.6). Note também que no método EbFVM, sob o 

ponto de vista da formação do volume de controle, não há problema algum na união de sub-

volumes provenientes de elementos triangulares e quadriláteros em uma mesma malha. Isso 

contrasta com o método de volumes finitos tradicional, onde a utilização de diferentes 

elementos em uma mesma malha é uma tarefa bastante difícil de ser feita. 

Retornando à equação de conservação dos fluidos, Eq. (4.1), após ter sido integrada no 

volume de controle P da Fig. 4.1b e procedendo conforme foi destacado no início deste 

capítulo, pode-se mostrar que sua forma discretizada será dada por 

 

( ) ( )
o
mm

mo m P im i Pm P PP P

ss tk pq S
BB V

?? ?
?? ?

? ? ? ? ?? ?? ?= + + ?? ? ? ? ? ? ?? ?? ? ? ?
?  (4.7) 

 

onde as grandezas calculadas nos nós da malha (ou nos centros dos volumes de controle) são 

identificadas com o sub-índice P, e aquelas grandezas avaliadas nos pontos de integração são 

identificadas com o sub-índice i, como mencionado anteriormente. 

 

4.1.1. Transformação de Coordenadas – Globais para Locais 

 

No método EbFVM, as equações são comumente resolvidas em um elemento padrão – 

triangular ou quadrangular – em coordenadas locais (?,?). Este será o procedimento adotado 

neste trabalho porque ele apresenta, pelo menos, duas grandes vantagens:  

 

 A utilização de um sistema de coordenadas locais torna cada elemento um ente 

independente dos demais;  
 

 Cada elemento da malha é tratado identicamente não importando quão distorcido 

ele se apresenta nas coordenadas globais.  



 CAP. 4 – FORMULAÇÃO NUMÉRICA 37 

 

 

A Fig. 4.2 apresenta exemplos de elementos triangulares e quadrangulares no plano 

físico, e seus correspondentes elementos padrões no plano transformado.  

 

 

 
(a) Elemento triangular  

 

 
(b) – Elemento quadrangular  

 

Fig. 4.2 - Diferentes elementos nos planos físico e transformado 

 

 

Conforme pode ser observado na Fig. 4.2, foi definido que o domínio do sistema de 

coordenadas locais (?, ?) utilizado em cada elemento do plano transformado deve variar de: 

 

 Para triângulos: 0 a 1 

 Para quadriláteros: -1 a 1 

 

e os nós devem ser numerados de 1 a NNE, no sentido anti-horário, onde NNE é o número de 

nós do elemento, que assume valor 3 para triângulos e 4 para quadriláteros. 



38 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

4.1.2. Funções de Forma como Funções de Interpolação no EbFVM 

 

Como está se buscando uma solução discreta, deve-se assumir, de alguma forma, uma 

aproximação numérica do gradiente de pressão da Eq. (4.7) em função dos valores 

armazenados nos nós da malha. No método de volumes finitos tradicionais é costume obter 

diretamente expressões aproximadas das derivadas a partir do truncamento da Série de Taylor 

da função. Assim, não é necessário utilizar o procedimento de estimar previamente como a 

função varia entre os nós e depois derivá-la analiticamente. A derivada da função é obtida 

diretamente na sua forma numérica, sendo denominada de função de interpolação 

(MALISKA, 2004), que tem uma ordem tão alta quanto a quantidade de nós utilizada neste 

processo.  

Esse não é o procedimento utilizado no EbFVM porque o uso de malhas não-

estruturadas inviabiliza a obtenção de expressões gerais de derivadas espaciais uma vez que, a 

priori, essas malhas não obedecem a um padrão de formação global. Por isso, neste método é 

proposta uma função (linear, bi-linear etc.) definida em cada elemento, tal como no Método 

de Elementos Finitos, cujas derivadas são obtidas analiticamente em qualquer ponto dentro do 

elemento.  

Assim, utilizando-se de um procedimento geral, a pressão, como qualquer outra 

variável do domínio, pode ser facilmente avaliada em qualquer ponto no interior de um 

elemento da malha em função de seus valores nodais utilizando as funções de forma, Nj, que 

exercem o papel de função de interpolação 
 

( )
1

,
NNE

j j
j

p N p? ?
=

= ?  (4.8) 

 

que são definidas para triângulos como 

 

( )
( )
( )

,

,

,

1

2

3

N 1

N

N

? ? ? ?
? ? ?
? ? ?

? = ? ?
?

=?
? =?

 (4.9) 

 

e para quadriláteros como 

 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 39 

 

 

( ) ( ) ( )

( ) ( ) ( )

( ) ( ) ( )

( ) ( ) ( )

,

,

,

,

1

2

3

4

1N 1 1
4
1 1 1N
4
1N 1 1
4
1N 1 1
4

? ? ? ?

? ?? ?

? ? ? ?

? ? ? ?

? = + +?
?
? ? +=
?
?
? = ? ?
?
?
? += ?
?

 (4.10) 

 

Pode-se mostrar que as coordenadas globais de qualquer ponto dentro do elemento 

também podem ser expressas em função de seus valores nodais como 

 

( ) ( )
1

, ,
NNE

j j
j

x N x? ? ? ?
=

=?  (4.11) 

( ) ( )
1

, ,
NNE

j j
j

y N y? ? ? ?
=

=?  (4.12) 

 

 

4.1.3. Avaliação do Gradiente de Pressão 

 

Como as funções de forma são contínuas dentro de cada elemento, podendo, portanto, 

serem diferenciadas, as derivadas espaciais da pressão presentes no termo de fluxo da Eq. 

(4.7) podem ser calculadas em qualquer ponto (?, ?) no interior de cada elemento como 

 

1, ,

NNE
j

j
j

Np
p

x x? ? ? ?=
??

=
? ??  (4.13) 

1 ,,

NNE
j

j
j

Np p
y y

? ?? ? =

??
=

? ??  (4.14) 

 

onde a questão-chave é a determinação das derivadas das funções de forma /jN x? ?  e  

/jN y? ? . Para tanto, emprega-se, inicialmente, a regra da cadeia, na forma 

 



40 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

j j jN N Nx y
x y? ? ?

? ? ?? ?
= +

? ? ? ? ?
 (4.15) 

e        

j j jN N Nx y
x y? ? ?

? ? ?? ?
= +

? ? ? ? ?
 (4.16) 

 

Essas expressões escritas de forma matricial resultam em 

 

1 1

11

..... .....

..........

NNE NNE

NNENNE

NN x y N N
x x

NNN x yN
y y

? ? ? ?

? ?? ?

?? ? ? ??? ? ? ? ? ?
? ? ? ? ? ?? ? ? ? ? ?
? ? ? ? ? ?=

?? ? ?? ?? ? ?? ? ?
? ? ? ? ? ?? ?? ?? ?? ? ? ?? ?

  (4.17) 

 
Manipulando a equação anterior, pode-se mostrar que as derivadas /jN x? ?  e  

/jN y? ?  são dadas por 
 

[ ] [ ]
1

1

1

.....

.....

NNE

NNE

NN
x x

J D
NN

y y

?

??? ?
? ?? ?
? ? =

??? ?
? ?? ?? ?

 (4.18) 

 
onde [J] é a matriz Jacobiana de transformação e [D] é a matriz de derivadas das funções de 

forma 

 

?
?
?
?

?

?

?
?
?
?

?

?

?
?

?
?

?
?

?
?

=

??

??
yx

yx

J ][  (4.19) 

e  

1

1

.....

[ ]
.....

NNE

NNE

NN

D
NN

? ?

? ?

??? ?
? ?? ?
? ?=
? ???
? ?? ?? ?

 (4.20) 

 

Utilizando as Eqs. (4.13), (4.14) e (4.18) pode-se, finalmente, obter a forma matricial 

do gradiente de qualquer variável genérica dada por 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 41 

 

 

{ } { }1[ ] [ ] epp DJ
?=?  (4.21) 

 

onde { }ep  é o vetor com os valores nodais da pressão no elemento (dimensão de NNE), e ][J  
é a matriz de transformação Jacobiana definida na Eq. (4.19) e que pode ser facilmente 

calculada a partir de 

 
[ ][ ] eZDJ =][  (4.22)   

 

onde [ ] eZ  é a matriz de coordenadas dos nós que definem um elemento da malha 
 

[ ]
?
?
?
?

?

?

?
?
?
?

?

?

=

NNENNE

22

11

e

yx

yx
yx

Z  (4.23) 

 

Deve-se lembrar, no entanto, que em função das diferentes funções de forma utilizadas 

neste trabalho (lineares, Eq. (4.9), para elementos triangulares e bi-lineares, Eq. (4.10), para 

elementos quadrangulares), as matrizes de derivadas em relação às coordenadas locais, [D], 

têm formas diferentes de acordo com o tipo de elemento 

  

 Para triângulos:      [ ] ?
?

?
?
?

?
?
?

=
101
011D     (4.24) 

     

 Para quadriláteros:  [ ] ?
?

?
?
?

?
??+??+

?+???+
=

????
????

1111
1111

D
4
1     (4.25) 

 
 

É importante notar também que para elementos triangulares a expressão do gradiente 

de pressão, Eq. (4.21), resultará sempre em um valor constante, independente da posição 

analisada no interior do elemento, uma vez que a matriz de derivadas em relação às 

coordenadas locais, [D], é formada por componentes que não dependem da localização 

espacial, Eq. (4.24). Diversos trabalhos na literatura têm utilizado esta condição de gradiente 

de pressão constante para desenvolver métodos numéricos que resultam em um 

equacionamento que possui forte similaridade com o utilizado em simuladores comerciais 

(FORSYTH, 1990; FUNG et al., 1991; GOTTARDI e DALL´OLIO, 1992). A aplicabilidade 



42 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

destes esquemas, no entanto, é restrita apenas a malhas triangulares e escoamentos 

monofásicos, conforme será discutido no Cap. 7. 

 

4.1.4. Cálculo da Área de Passagem do Fluxo 

  

Avançando na apresentação do tratamento dado no EbFVM aos termos presentes na 

Eq. (4.7), nesta seção será considerado o vetor área { }S? . Embora em 2D esta área seja vista 
simplesmente como uma linha, a denominação “área” continuará sendo utilizada neste 

trabalho. De uma forma geral, valendo-se da idéia de calcular as grandezas elemento a 

elemento, propõe-se determiná-la a partir da seguinte expressão matricial (HURTADO, 2005) 

 

{ } [ ] [ ] { }iTii JRS ?=?  (4.26) 
 

onde i é o ponto de integração localizado sobre a face cuja área deseja-se determinar e R é a 

matriz de rotação dada por 

 

[ ] ??
?

??
?= ? 01

10R  (4.27) 

 

e { }i?  é a área da face do sub-volume de controle em coordenadas locais. A definição 
geométrica de cada uma destas áreas está diretamente relacionada à definição da posição do 

ponto C no interior do elemento (Fig. 4.3). Embora seja arbitrária, a posição deste ponto tem 

sido definida no baricentro do elemento no EbFVM porque facilita a implementação 

computacional ao possibilitar a implementação de algoritmos mais gerais, e origina sub-

volumes de controle de dimensões semelhantes. 

Assim, de acordo com a definição dos elementos padrões no plano transformado, Fig. 

4.3, as áreas da face dos sub-volumes de controle em coordenadas locais { }i?  para diferentes 
pontos de integração i são dadas por 

 

 Para triângulos:  
 

        { }
?
?
?

?
?
??=?

61
31

1    { }
?
?
?

?
?
?=?

? 31
61

2    { }
?
?
?

?
?
?=?

61
61

3  (4.28)  



 CAP. 4 – FORMULAÇÃO NUMÉRICA 43 

 

 

 
 Para quadriláteros: 

 

        { }
?
?
?

?
?
?=?

0
1

1       { }
?
?
?

?
?
?=?

1
0

2       { }
?
?
?

?
?
?=?

?
0
1

3       { }
?
?
?

?
?
?=?

? 1
0

4  (4.29) 

 
 
 
 
 
 

               
 

(a) Elementos triangulares  

 

(b) Elementos quadrangulares 

 

Fig. 4.3 - Elementos triangulares e quadrangulares nos planos físico e transformado, demonstrando as áreas de 

face dos sub-volumes de controle e os pontos de integração (ip) 

 
 
 



44 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

4.1.5. Esquema de Avaliação das Mobilidades 

 

O tratamento dado à mobilidade, ?, na Eq. (4.7) é o assunto abordado nesta seção. Foi 

visto que no EbFVM as variáveis são calculadas e estão disponíveis diretamente apenas nos 

nós da malha, podendo-se obter valores interpolados em qualquer posição no interior de um 

elemento através da utilização das funções de forma, Eqs. (4.9) e (4.10). Este procedimento já 

foi utilizado na discretização do gradiente de pressão (seção 4.1.2), e então, a priori, poder-se-

ia utilizar estas funções semelhantemente para avaliar o termo de mobilidade nos pontos de 

integração.  

Mas este procedimento não se mostra adequado na prática porque o termo que contém 

a mobilidade pode ser considerado um termo advectivo da equação da saturação, Eq. (4.7), e 

termos desta natureza não conferem estabilidade ao método se não forem representados por 

funções de interpolação baseadas no valor a montante (upwind schemes). Por isso este é o 

esquema utilizado neste trabalho. Neste esquema os valores da permeabilidade relativa, fator 

volume de formação e viscosidade utilizados no cálculo da mobilidade avaliada num dado 

ponto de integração, Eq. (3.20), serão calculados a partir dos valores nodais de saturação e 

pressão do volume de controle a montante. Esse esquema, também denominado de upwind 

unidimensional, é incondicionalmente estável, como mencionado, embora possa resultar em 

excessiva difusão numérica e uma dependência anômala dos resultados com a direção das 

linha da malha em alguns casos  (PEACEMAN, 1977; YOSHIAKI, 1982; WOLCOTT et al., 

1996).  

 

Esquemas upwind usuais. Na literatura encontram-se comumente dois diferentes 

esquemas upwind aplicados em malhas triangulares para avaliação da mobilidade, mas que, 

na realidade, não asseguram que em todos os casos ela seja calculada a partir dos valores 

nodais realmente localizados a montante. Isso pode resultar em soluções não-físicas. Um 

destes esquemas é bastante similar ao procedimento utilizado nos simuladores comerciais com 

malhas estruturadas, e baseia-se simplesmente na análise do valor de pressão1 dos dois 

volumes de controle vizinhos à face onde se deseja avaliar a mobilidade. Infelizmente esse 

esquema não é apropriado nos casos onde o fluxo em cada face é calculado com expressões 

                                                 
1 Em problemas tridimensionais, o procedimento usual se baseia na análise do valor do potencial (AZIZ e 
SETTARI, 1979), que é uma grandeza física que envolve também o termo gravitacional não considerado neste 
trabalho. 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 45 

 

 

que envolvem mais de dois valores nodais de pressão, como nas malhas não-estruturadas2. É 

possível encontrar em determinados casos, por exemplo, pj &gt; pk , enquanto que na interface 

entre os sub-volumes de controle j e k o escoamento se dá no sentido de k pra j (CORDAZZO 

et al., 2004a e b). Neste caso o valor a jusante é o utilizado, e portanto, serve como exemplo 

de que a aplicação prática deste tipo de esquema é limitado. 

Em outro esquema bastante utilizado, a escolha do valor a montante é baseado na 

avaliação do sinal do termo ( )jk j kp pT ? . Nesta expressão, é pressuposto que o coeficiente 
Tjk, freqüentemente denominado de transmissibilidade, contenha os parâmetros físicos e 

geométricos utilizados no cálculo do fluxo em malhas ortogonais: área, distância entre os nós 

e a permeabilidade absoluta da interface. Contudo quando o fluxo deve ser calculado em uma 

expressão que envolva mais de dois valores nodais, como é o caso quando a ortogonalidade 

local não existe, não é possível mais identificar a transmissibilidade, como será visto no 

Cap.7. Assim, é possível mostrar que este esquema também não tem suporte físico, porque o 

termo ( )kjjk ppT ?  não é, na realidade, o fluxo completo entre os nós j e k em malhas 
triangulares. 

 

Esquema proposto. Neste trabalho é utilizada uma mesma expressão aplicável para 

elementos triangulares e quadrangulares, em que a mobilidade jk?  é avaliada nas interfaces 

dos volumes de controle j e k a partir da correta interpretação de qual é a direção a montante 

do escoamento nesta interface. Isso é possível analisando-se o sinal do seguinte produto 

escalar 

 

( )
( )

          se           

          se   

jk j
jk

jk k
jk

0k p S

0k p S

? ?

? ?

? ?= ? ?&amp;lt;
?
?

?? = ? ? &gt;
?

 (4.30) 

 

onde o nó j considerado nas expressões anteriores corresponde ao sub-volume de controle 

onde o vetor normal associado a ?S aponta para fora. Note que foi omitida a mobilidade no 

termo do fluxo em virtude de ser representada sempre por um valor positivo, não exercendo 

nenhum efeito neste esquema de avaliação. O procedimento dado na Eq. (4.30) assegura que 

as mobilidades utilizadas pelo esquema numérico sejam realmente aquelas obtidas a partir dos 
                                                 
2 A exceção é o método de Voronoi onde o fluxo é calculado com uma expressão discretizada que envolve 
apenas dois valores nodais em função da utilização de malhas com ortogonalidade local. 



46 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

valores à montante, mesmo nos casos onde o meio é anisotrópico, isto é, em casos onde o 

vetor velocidade pode não estar alinhado na direção do vetor gradiente de potencial. 

É importante mencionar também que diferentemente dos métodos que lidam com 

malhas estruturadas tradicionais, no EbFVM os pontos de integração não estão localizados 

exatamente sobre a linha que une dois nós vizinhos como demonstra a Fig. 4.4a, e por isso 

mesmo não se pode utilizar apenas dois valores de pressão no processo de decisão de qual 

está a montante. A Fig. 4.4b apresenta em destaque dois elementos da malha não-estruturada 

da Fig. 4.4a formados pelos nós a, b, c, j e k, bem como a posição dos dois pontos de 

integração localizados na interface dos volumes de controle construídos ao redor dos nós j e k. 

Percebe-se que os pontos de integração estão localizados dentro dos elementos, e por isso o 

tratamento dado às grandezas avaliadas em cada um destes pontos deve ser elemento a 

elemento e não por interfaces de elementos (arestas), uma vez que existe a possibilidade de 

um fluxo se dar na direção de um volume de controle para o outro dentro de um elemento, 

enquanto que no elemento vizinho a direção do fluxo entre estes volumes pode ser a oposta. 

 

 

 
     (a)      (b) 

 

Fig. 4.4 - Localização dos pontos de integração comuns a dois volumes de controle em (a) uma malha não-

estruturada e, em destaque, em duas faces do volume de controle formado ao redor do nó k 

 

 

As experiências têm mostrado que esta situação inusitada de haver fluxos com 

sentidos contrários em pontos localizados em uma mesma interface (jk1 e jk2 da Fig. 4.4b, por 

exemplo) acontece normalmente apenas quando a malha é composta por elementos bastante 

deformados, que não é o caso dos elementos ilustrados na Fig. 4.4 que foram construídos com 

uma boa razão de aspecto para facilitar a compreensão. 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 47 

 

 

O procedimento proposto neste trabalho para a avaliação das mobilidades pode ser 

implementado computacionalmente sem maiores dificuldades se o termo de análise da Eq. 

(4.30) for escrito matricialmente como 

 

( ) { } { }  Ti ei pk p S H? ?? =  (4.31) 
 

onde { }TiH  é um vetor linha de dimensões (NNE) calculado apenas no início da simulação, e 
é composto pelos termos que dependem apenas da geometria e propriedades físicas constantes 

de cada elemento, que foram aglomerados na forma 

 

{ } { } [ ] [ ] [ ]1T Ti i i ikH S J D
?

= ?  (4.32) 

 

onde o tensor de permeabilidades absolutas, [k], é definido como 

   

[ ] xx xy
yx yy

k k
k

k k
? ?

= ? ?
? ?

 (4.33) 

 
Note que é muito simples e direta a inclusão da forma completa do tensor de 

permeabilidades absolutas neste método. Isso é uma importante característica em se tratando 

de simulação de reservatórios heterogêneos e anisotrópicos3. Percebe-se, no entanto, que não 

foi feita ainda nenhuma consideração a respeito de como as propriedades físicas como 

permeabilidade absoluta e porosidade são armazenadas no domínio. Além disso, não foi 

mencionado como representar as falhas geológicas com o método proposto. Estas questões 

são apresentadas na seqüência. 

  

 

 

 

                                                 
3 Neste trabalho é considerado heterogêneo o domínio que apresentar variação espacial das propriedades físicas 
porosidade e/ou permeabilidade absoluta. Quando o tensor definido na Eq. (4.33) não for isotrópico, o domínio 
será considerado anisotrópico. Baseado nestas definições pode-se afirmar que um reservatório heterogêneo não 
será necessariamente anisotrópico, e vice-versa. 



48 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

4.2. Representação das Propriedades Físicas 
 
 Como visto até agora, a utilização de malhas não-estruturadas e das funções de forma 

é o fato novo que diferencia o EbFVM dos métodos de volumes finitos tradicionais. No 

entanto, pode-se afirmar que as diferenças não são apenas estas. Como o elemento de malha e 

o volume de controle não são mais entidades coincidentes, deve-se escolher em qual delas as 

propriedades físicas, como permeabilidade e porosidade, deverão ser armazenadas.  

Nos métodos pesquisados que utilizam malhas não-estruturadas e conservação local, as 

propriedades físicas são armazenadas nos volumes de controle (VERMA e AZIZ, 1997; 

STARS User’s Guide, 2002). No método proposto nesta tese, no entanto, propõe-se 

armazená-las nos elementos porque esta forma de armazenamento apresenta diversas 

vantagens comentadas na seqüência. Contudo, independentemente do esquema de 

armazenamento das propriedades escolhido, as variáveis principais calculadas no modelo 

numérico, como pressão e saturação, continuam sendo armazenadas nos nós da malha. Na 

Fig. 4.5 comparam-se ambos os esquemas, destacando-se a malha de entrada de dados das 

propriedades e aquela interpretada pelo simulador. 

A primeira vantagem que pode ser citada no armazenamento das propriedades nos 

elementos da malha é que desta forma é desnecessário efetuar qualquer tipo de média para 

avaliar a permeabilidade absoluta nas interfaces dos volumes de controle. Nos métodos 

tradicionais, onde o armazenamento se dá nos volumes de controle, esta média é necessária 

porque existe a descontinuidade da propriedade nas interfaces dos volumes. Nestes casos 

normalmente é utilizada a média harmônica (PETTERSEN, 1983), que para uma malha 

uniforme é dada por 
 

11 1

2
j k

jk

k k
k

?? ?? ?+
= ? ?? ?
? ?

 (4.34) 

 

 Esta média é fisicamente justificada apenas para escoamento unidimensional, sendo 

incerta a sua extensão para as situações bi e tridimensionais. Diversos autores têm criticado a 

média harmônica utilizada para avaliar as permeabilidades internodais (TORONYI e 

FAROUQ ALI, 1974; APPEL, 1976; PETTERSEN, 1983). Romeu e Noetinger (1995) 

quantificaram os erros sistemáticos nos resultados numéricos devido ao uso deste e outros 

tipos de média, desenvolvendo um modelo analítico que confirmou a existência de grandes 

erros e de uma baixa convergência em alguns casos. 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 49 

 

 

 
 

(a) Propriedades armazenadas nos volumes de controle 

 

 
 

(b) Propriedades armazenadas nos elementos da malha 

Fig. 4.5 - Diferentes formas de armazenar as propriedades físicas: (a) no volume de controle (VERMA e AZIZ, 

1997), e (b) nos elementos (proposto neste trabalho) 

  

 

 A desvantagem do esquema de armazenamento proposto nesta tese é a necessidade de 

calcular uma porosidade média no volume porque, conforme mostrado na Fig. 4.5b, o volume 

de controle resultante será heterogêneo. Propõe-se utilizar uma média volumétrica da 

porosidade do tipo 

 

1
P k k

k PP

V
V

??
? ?

= ?
? ?  (4.35) 

 

onde k representa cada um dos sub-volumes de controle que formam o volume P. 

 Embora possa parecer que houve uma simples troca de variável cuja média necessita 

ser tomada (ao invés de fazer uma média na permeabilidade é feita na porosidade), deve-se 

esperar uma melhora nos resultados numéricos, uma vez que em problemas práticos a faixa de 



50 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

variação espacial da porosidade é bem menor que a da permeabilidade. Por isso um 

procedimento mais simples e fácil, como o proposto na Eq. (4.35), pode ser empregado. 

Aliado a isso, os fluxos nas interfaces dos volumes de controle são calculados a partir da Lei 

de Darcy, onde é a permeabilidade que aparece e não a porosidade. Essas razões dão suporte a 

escolha de um método numérico que usa a média da porosidade ao invés da média da 

permeabilidade absoluta. 

 

  

4.3. Representação das Falhas 
 

Nesta seção são discutidas as diferentes formas de modelar falhas geológicas no 

EbFVM: 

 

(1) eliminando elementos no interior do domínio, 

(2) zerando o fluxo diretamente nas interfaces dos volumes de controle, e  

(3) representando a falha a partir de elementos geométricos com espessura reduzida e 

com valores nulos de permeabilidade absoluta.  

 

No primeiro caso, vale-se de uma das vantagens do emprego de malhas não-

estruturadas, que é a facilidade de retirar elementos de qualquer posição do domínio. Isso não 

acarreta na necessidade de alteração do código computacional, porque o tratamento dado a 

esta região é o mesmo dado as outras fronteiras (condição de contorno impermeável). A 

ausência de elementos no interior da malha causa necessariamente uma interrupção no fluxo 

naquela direção, que é o efeito causado pela presença de uma falha geológica. No entanto, 

apenas falhas totalmente selantes são representadas desta forma, o que é uma a desvantagem 

deste tipo de modelagem. 

No segundo caso, a falha modelada não tem espessura, constituindo-se em uma linha 

em 2D ou uma superfície em 3D, como ilustrado na Fig. 4.6. A sua principal vantagem é a 

facilidade de representação no esquema numérico: basta zerar os termos de fluxo entre os 

volumes de controle separados pela falha geológica. Além disso, outra vantagem é a 

economia no número de equações do sistema linear, uma vez que não há necessidade de mais 

elementos, e em conseqüência de mais nós para representar a falha. 

No entanto, uma desvantagem consiste na necessidade de visualizar, além da malha 

dos elementos, a malha dual formada pelos volumes de controle construídos ao redor dos nós 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 51 

 

 

da malha, a fim de posicionar as falhas. Isto poderá ser bastante trabalhoso, principalmente 

em se tratando de malhas não-estruturadas, porque o procedimento consiste em gerar uma 

malha de elementos e, a partir dos volumes formados, localizar a falha nas fronteiras dos 

volumes. Se o resultado não for satisfatório, deve-se gerar outra malha e assim por diante. 

Quando são utilizados elementos triangulares, por exemplo, a representação de uma falha 

através do cancelamento dos fluxos dentro do elemento (ou nas faces dos volumes de 

controle) é uma tarefa ainda mais delicada, porque dificilmente se conseguirá representar uma 

falha que seja geometricamente linear com elementos triangulares.  

 

 

 

                        

Fig. 4.6 - Falha modelada a partir do cancelamento do fluxo no ponto de integração 

 

 

Deve-se destacar, contudo, que a principal desvantagem do esquema de representação 

de falha apresentado na Fig. 4.6 está na incompatibilidade com os tipos de funções de forma 

utilizadas como funções de interpolação. Quando se prescreve uma falha no interior do 

elemento, impõe-se uma descontinuidade da função naquela posição. Isso é incompatível com 

as funções lineares e bi-lineares utilizadas em cada elemento, que não conseguirão reproduzir 

o ‘degrau’ na função oriundo da presença da falha no interior do elemento. 

Por essas razões, propõe-se neste trabalho um esquema diferente de representação de 

falhas, no qual elas são tratadas como entes geométricos com dimensão e propriedades físicas. 



52 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Assim é necessário que elas sejam formadas por elementos de pequena espessura, e com 

permeabilidade absoluta e porosidade baixas. Tratamentos similares aplicados às malhas não-

estruturadas já foram recomendados anteriormente por Kocberber (1995) e Young (1999). A 

Fig. 4.7 apresenta exemplos de falhas modeladas a partir de triângulos e quadriláteros. Neste 

caso, torna-se dispensável a visualização conjunta da malha de volumes de controle e o 

trabalho de gerar novas malhas tais que as falhas estejam mais bem posicionadas nas suas 

fronteiras. 

 

 

 

Fig. 4.7 - Falhas representadas a partir de elementos com baixas permeabilidade e porosidade 

 

 

É importante mencionar que a utilização de elementos de pequena espessura 

localizados ao lado de elementos de grande espessura não introduz um mau condicionamento 

na matriz de coeficientes do sistema linear. A razão é que os volumes de controle 

correspondentes aos nós localizados nas interfaces da falha são construídos com áreas e 

volumes  provenientes também dos elementos adjacentes à falha, e que tem dimensões físicas 

comparáveis aos demais elementos da malha.  

  Embora tenha que se utilizar mais elementos de malha neste método do que no 

anterior, o que é uma desvantagem, deve-se dizer que esta forma de representar meios 

heterogêneos e modelar falhas geológicas propostas é compatível com o uso das funções de 

forma definidas elemento a elemento. Além disso, é um esquema de representação mais 



 CAP. 4 – FORMULAÇÃO NUMÉRICA 53 

 

 

elegante no contexto do EbFVM pois vai na direção da filosofia deste método, que é focar o 

cálculo e o armazenamento de propriedades nos elementos da malha.  

 

 

4.4. Refinamento Local 
 

Recomenda-se que em regiões próximas a poços, em regiões de grandes variações do 

campo de saturação e em regiões de alta heterogeneidade se faça um refinamento local da 

malha. O uso do refinamento local nessas regiões reduz o tempo computacional, sendo 

comparável ao das malhas grosseiras, apresentando resultados muito similares aos das malhas 

totalmente refinadas. No método proposto, a operação de refinamento local é feita de forma 

muito simples, pois a adoção de um sistema de coordenadas locais permite um tratamento 

similar a todos os elementos da malha em um ambiente não-estruturado, o que facilita 

concentrar um número maior de nós nas regiões de interesse. 

A Fig. 4.8 mostra que o procedimento de refinar localmente determinadas regiões da 

malha pode ser feito facilmente, por exemplo, dividindo elementos quadriláteros dando 

origem a elementos triangulares em uma dada região. Como visto, o refinamento local é, 

portanto, um procedimento natural e direto no método proposto, não apresentando as 

imprecisões numéricas dos métodos tradicionais que surgem em função da utilização de 

expressões aproximadas dos fluxos nas interfaces de blocos grosseiros e refinados 

(CORDAZZO et al., 2002).  

Conforme mencionado no início deste capítulo, a utilização de elementos triangulares 

e quadrangulares resulta em ordens de interpolação diferentes - lineares e bi-lineares, 

respectivamente. Pode-se valer disso a fim de obter uma solução com maior precisão, 

concentrando-se elementos quadrangulares em uma determinada região de interesse, ao invés 

de empregar triângulos com uma mesma quantidade de nós. A operação de refinamento local, 

portanto, não está associada apenas ao processo de triangulação de determinadas regiões, 

como poderia estar sendo sugerida pela ilustração da Fig. 4.8. Deve-se salientar novamente, 

no entanto, que preencher uma região com triângulos parecer ser um procedimento mais 

simples. 

 



54 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

Fig. 4.8 - Exemplo do procedimento de refinamento local: (a) malha a ser refinada; (b) malha refinada 

localmente, e (c) destaque para alguns volumes de controle formados 

 
 
 
  

 É importante destacar ainda que existem outras possibilidades promissoras de refinar 

localmente o domínio no EbFVM e não exploradas nesta tese, como por exemplo, a que 

consiste em utilizar elementos com número variável de nós. No Anexo 1 são apresentadas as 

premissas desta técnica que utiliza-se de elementos quadriláteros que, devido a liberdade de 

assumir uma quantidade de nós variando de 4 a 8 nós, pode aumentar ainda mais a 

flexibilidade na discretização espacial, podendo ser uma outra opção na representação de 

reservatórios com falhas e com geometrias altamente complexas.  

 

  



55 

Cap.    

5 
FFOORRMMUULLAAÇÇÃÃOO  NNUUMMÉÉRRIICCAA  
PPAARRTTEE  22  ––  CCOONNSSIIDDEERRAAÇÇÕÕEESS  FFIINNAAIISS  EE  

                                                IIMMPPLLEEMMEENNTTAAÇÇÃÃOO  CCOOMMPPUUTTAACCIIOONNAALL  

 

 

  
A implementação computacional das duas alternativas de solução do sistema de 

equações adotadas neste trabalho, bem como outras considerações sobre aspectos numéricos, 

são os temas abordados neste capítulo. O primeiro esquema de solução utilizado foi o IMPES 

(Implicit Pressure, Explicit Saturation), em que o campo de pressão é calculado 

implicitamente (através da solução de um sistema linear) e o campo de saturação obtido 

explicitamente, utilizando os valores mais recentes do campo de pressão. 

O segundo esquema de solução utilizado neste trabalho foi o Totalmente Implícito. 

Neste caso, resolve-se um sistema linear maior que o resolvido no IMPES, mas que permite 

avançar a solução no tempo sem as excessivas restrições de passo de tempo inerentes àquele 

método. 

Deve-se lembrar que as equações do modelo bifásico discretizadas e obtidas no 

capítulo anterior são 

 

 ( ) ( )
o
mm

mo m P im i Pm P PP P

ss tk pq S
BB V

?? ?
?? ?

? ? ? ? ?? ?? ?= + + ?? ? ? ? ? ? ?? ?? ? ? ?
?           , m = w, o      (5.1)  

   
   

Elas formam um sistema de duas equações e três incógnitas:  p, sw e so. A outra equação 

necessária para o fechamento do problema é a de restrição volumétrica, dada por 

 

 1=+ ow ss  (5.2) 
 

A estratégia para a obtenção da solução deste sistema será a mesma para ambos os 

esquemas, IMPES e Totalmente Implícito, e consistirá em obter a saturação do óleo através da 



56 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

equação de restrição, Eq. (5.2), enquanto que a saturação da outra fase e a pressão serão 

obtidas através da resolução do sistema de equações composto pela equação de conservação 

da água, Eq. (5.1), e de uma combinação linear das equações de conservação de ambas as 

fases. Esta última equação é a da conservação total, e é construída substituindo as saturações 

explicitadas em cada equação de conservação na equação de restrição, resultando em 

 

 
( ) ( )( )

                                           1 0

P P oow w i w w o oi i P
i P

o o
w oP P

w oo o
w o P

B B k p S q B q B

s sV
B B

t B B

? ? ? ?? ?

?
? ?

+ ? ?? + + +

? ??
+ + ? =? ?? ? ?

?
 (5.3)  

 

cuja variável principal é a pressão. Por isso é usualmente denominada de “equação da 

pressão”. A outra equação empregada neste sistema será chamada de equação da saturação. 

Por razões não discutidas neste trabalho, a equação da pressão é classificada como 

parabólica quando o termos de compressibilidade são importantes, ou elíptica nos outros 

casos (PEACEMAN, 1977). A equação da saturação, Eq. (5.1), por sua vez, é considerada 

parabólica quando os efeitos de pressão capilar são importantes. Na ausência desses termos, a 

equação da saturação é classificada como hiperbólica não-linear de 1ª. ordem1. 

Em vez de empregar a equação da pressão neste sistema, poderia ser utilizada 

diretamente a outra equação de conservação ainda não empregada (a do óleo). Esta opção foi 

testada neste trabalho, mas demonstrou-se não ser viável porque dificulta a obtenção de um 

sistema geral e possível de ser utilizado sem grandes alterações pelos métodos analisados 

neste trabalho: IMPES e Totalmente Implícito. Além disso, os testes preliminares com o 

método Totalmente Implícito demonstraram que a utilização da equação da pressão neste 

sistema de equações torna o método numérico mais estável. A razão pode ser o aumento da 

dominância diagonal na matriz de coeficientes, ocasionada pela existência de uma soma das 

mobilidades de cada fase multiplicando a pressão. 

 

 

 

                                                 
1 Esta classificação das equações em elípticas, parabólicas ou hiperbólicas utilizando-se os coeficientes da 
equação diferencial é puramente matemática. Há autores que afirmam que faz mais sentido apontar o caráter das 
equações em cada direção coordenada, utilizando uma classificação mista (PATANKAR, 1980; MALISKA, 
2004) não empregada neste trabalho. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 57 

 

 

5.1. Método IMPES 
 

Como mencionado, no método IMPES o campo de pressão é calculado implicitamente 

(através da solução de um sistema linear) e o campo de saturação explicitamente, sendo o 

campo de saturação atualizado a cada passo de tempo utilizando os valores mais recentes do 

campo de pressão. 

Porém ao examinar a Eq. (5.1) percebe-se uma não-linearidade no termo mm Bs  que 

impede a utilização direta desta equação na determinação da saturação, uma vez que ambos 

estão sendo avaliados no mesmo intervalo de tempo. Deve-se lembrar que o fator volume de 

formação normalmente é calculado em função da pressão, em uma expressão que envolve um 

coeficiente de compressibilidade (c) 

 

 ( )
?
?
?

?

?
?
?

?
?
?
??

?
? ??= refm

ref
mm ppc1BpB  (5.4)  

 

logo, a não-linearidade se estabelece em função de que tanto a saturação como o fator volume 

de formação são dependentes da pressão. Por isso é necessário fazer uma modificação nesta 

equação de conservação para que escoamentos com fluidos compressíveis possam ser 

resolvidos com o método IMPES. Note que para problemas incompressíveis, 1== omm BB  na 

Eq. (5.1), e a não-linearidade desaparece. Para contemplar os demais casos é proposto neste 

trabalho uma linearização do termo mm Bs  através do truncamento dos termos de mais alta 

ordem da série de Taylor 

 

 ......+???
?

?
??
?

?
?

?
+???

?

?
??
?

?
?
?

+= m
m

m

m
m

m

m

m
o
m

o
m

m

m B
B
s

B
s

B
s

sB
s

B
s

 (5.5) 

 

que, conforme demonstrado no Anexo 2, resulta em 

 

 
( )

( )omrefm2o
m

o
m

o
m

m

m

m ppcB
B

s
B
s

B
s

?+=  (5.6)  

 

Substituindo esta expressão na Eq. (5.1) e avaliando explicitamente ( 0? = ) os termos 

na equação resultante que necessitam serem definidos quanto a que limites do intervalo de 



58 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

tempo serão computados, origina-se a equação denominada doravante neste trabalho de 

equação da saturação do método IMPES dada por 

 

 ( )
( )

( ) ( )1
oref o

m m oo m
m mmm oP P ii Pm PP

p pB c Bs q k ps S t
B V

?
?? ?

? ?? ? ?? ?? ?? ?= ? + + ? ?? ?? ? ?? ? ? ?? ?? ?
?  (5.7) 

 

Substituindo a equação da saturação de cada fase linearizada, Eq. (5.7), na equação de 

restrição volumétrica, Eq. (5.2), e agrupando os termos semelhantes, a equação resultante, 

denominada neste trabalho de equação da pressão do método IMPES, será dada por 

 

( ) ( )( )
P P

o o o o o o o o
w w o o i w w o oi i P

i P
B B k p S q B q B? ?

? ?

+ ? ?? + + +?  
 

                      1ª. parcela                    2ª. parcela               

         (5.8) 

( )
0

t
ppV

B
cBs

B
cBs

P

o

P
o
o

o
ref
o

o
o

o
w

w
ref
w

o
w =??

?

?
??
?

?
?

??
??
?

?
??
?

?
++

?
            

    
          3ª. parcela 
 

As Eqs. (5.7) e (5.8) são as expressões linearizadas das Eqs. (5.1) e (5.3), 

respectivamente. Para ser mais didático, neste texto foi escolhida apenas a implementação 

computacional da equação da pressão para ser explicada com mais detalhes na seqüência, 

sendo a implementação da saturação compreendida por analogia. 

O tratamento dado neste trabalho à primeira parcela da Eq. (5.8) foi considerado no 

capítulo anterior, onde foi demonstrado como o gradiente de pressão é discretizado, como a 

área dos sub-volumes de controle é calculada e como são avaliadas as mobilidades 

interfaciais. Resta apresentar neste capítulo como foi implementada computacionalmente esta 

parcela como um todo, utilizando o conceito de cálculo elemento a elemento, além de 

demonstrar como podem ser determinadas as 2ª. e 3ª. parcelas desta equação.  

É importante mencionar que no IMPES as mobilidades e os fatores volume de 

formação são calculados com os valores de pressão e saturação do nível temporal anterior, 

não havendo a necessidade de um processo iterativo em cada nível para obter a nova solução. 

  



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 59 

 

 

5.1.1. Formação da Matriz de Coeficientes por Elementos 

  

A filosofia do método EbFVM proposto consiste em utilizar no cálculo dos fluxos em 

cada um dos pontos de integração a informação armazenada naquele elemento da malha. Por 

isso a forma mais efetiva parece ser criar matrizes em cada elemento, computando as 

contribuições de cada um, seguido de um procedimento de transferência de informações, a 

fim de formar a matriz global de coeficientes.  

Utilizando as definições do gradiente de pressão e vetor área apresentados no capítulo 

anterior, pode-se mostrar que a primeira parcela da equação da pressão, que é o termo de 

fluxo calculado em uma determinada interface de dois volumes de controle (em um ponto de 

integração), independentemente do tipo de elemento utilizado na malha, será dada por 

  

 ( ) { } { }To Pi i eik p S ph H? ? ?? =  (5.9) 
 
onde { }TiH  é um vetor composto pelos termos que dependem apenas da geometria e 

propriedades físicas constantes de cada elemento definido na Eq. (4.32), { }ep  é vetor do 
elemento com seus valores nodais da pressão, e hPi é definido como 

 
 ( ) ( ) ( ) ( ) iooPooiowPowiP BBh ?? +=  (5.10) 
 

onde na convenção adotada neste trabalho, os sub-índices “i” e “P” indicam que a 

propriedade é avaliada no ponto de integração e no nó, respectivamente. O super-índice “o”, 

por sua vez, indica que são utilizados valores calculados no nível de tempo anterior. A 

aproximação do termo de fluxo na equação da saturação é realizada seguindo um 

procedimento semelhante ao apresentado para a equação da pressão. Conforme pode ser visto 

na Fig. 5.1a, cada um dos sub-volumes de controle que formam um elemento, seja ele 

triangular ou quadrangular, terá sempre duas interfaces internas com outros sub-volumes do 

mesmo elemento por onde o fluido escoará. Desta forma, a integral de superfície da Eq. (5.9) 

deverá ser aproximada nestas duas superfícies internas, ou mais precisamente em dois pontos 

de integração localizados no centro de cada superfície dos sub-volumes de controle. 

Considerando isso, o processo de formação das matrizes dos elementos pode ser sistematizado 

(HURTADO, 2005), de forma que o fluxo que atravessa as interfaces de cada sub-volume de 

controle pode ser expresso como 



60 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 { } [ ] { }e eeq A p=  (5.11) 
 

onde 

 [ ]
{ } { }
{ } { }
{ } { }

11 121 2

22 232 3

33 313 1

T T

T T

e
T T

h hH H

h hA H H

h hH H

? ??
? ?
? ?= ?
? ?

?? ?? ?

                (3x3 - para elementos  triangulares)            

 

e   (5.12)  
 

[ ]

{ } { }
{ } { }
{ } { }
{ } { }

11 121 2

22 232 3

33 343 4

44 414 1

T T

T T

T Te

T T

h hH H

h hH H
A

h hH H

h hH H

? ??
? ?
? ??

= ? ?
?? ?

? ?
?? ?? ?

                 (4x4 - para elementos quadrangulares)  

 

A determinação das matrizes dos elementos seguindo o procedimento mencionado 

permite que a matriz global de coeficientes seja construída elemento a elemento, transferindo 

cada valor destas matrizes para sua respectiva posição na matriz global. Embora este 

procedimento de formação da matriz global seja trivial no Método dos Elementos Finitos, ele 

ainda assim será apresentado com mais detalhes na próxima seção porque esse conceito é 

relativamente novo no escopo dos Métodos de Volumes Finitos. 

 

5.1.2. Formação da Matriz Global de Coeficientes 

 

A fim de ilustrar o procedimento de montagem da matriz global de coeficientes, a Fig. 

5.1a apresenta uma malha composta por dois elementos quadrangulares e três triangulares, 

que será utilizada no processo de discretização no método EbFVM. Cada um dos cinco 

elementos que compõe esta malha fornece uma matriz de coeficientes, [ ] eA , que é o resultado 
da aplicação da Eq. (5.9) em cada um dos pontos de integração. A dimensão da matriz local 

de coeficientes representa a quantidade de sub-volumes de controle dentro do elemento, sendo 

que para elementos triangulares esta matriz terá sempre dimensões de 3 x 3, enquanto que 

para quadriláteros sua dimensão será de 4 x 4, conforme representado esquematicamente na 

Fig. 5.1b.  



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 61 

 

 

 
(a) Malha composta por 5 elementos e 8 nós 

 

 
 

(b) Processo de formação da matriz global de coeficientes 
 

Fig. 5.1 - Ilustração do processo de formação da matriz global de coeficientes em esquemas baseados em 

elementos, como o método EbFVM 

 
 

Após o processo de determinação das matrizes de coeficientes dos elementos, 

procede-se a montagem da matriz global de coeficientes que receberá as contribuições de 

todos os elementos da malha, como demonstrado na Fig. 5.1b. Essa montagem é realizada 

simplesmente somando-se o coeficiente armazenado na matriz do elemento na sua posição 

correspondente na matriz global. A contribuição de cada elemento é mostrada nessa figura, 



62 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

sendo que a posição dos coeficientes na matriz global é determinada através das informações 

contidas em uma matriz fornecida pelo gerador de malhas. Nesse caso cada elemento é 

identificado e suas conectividades são definidas. O elemento 1 nesta figura, por exemplo, é 

formado pelos nós 1, 4 e 7, e por isso os valores contidos em sua matriz local deverão ser 

transportados para as posições de intersecção das linhas e colunas correspondentes aos seus 

nós, como demonstrado na Fig. 5.1b. Note que os diferentes tipos de elementos considerados  

(triângulos e quadriláteros) não implicam em nenhuma dificuldade adicional a este processo. 

É importante notar também que apenas a 4ª. linha e a 4ª. coluna da matriz global de 

coeficientes são cheias, e a razão é que o volume de controle construído ao redor do nó 4 é o 

único que possui faces dentro de todos os elementos da malha, e por isso o cálculo do fluxo 

em seus pontos de integração envolve todos os nós. Outras informações relacionadas ao 

processo de formação da matriz global de coeficientes podem ser obtidas na literatura de 

elementos finitos (HUGHES, 1987; ZIENKIEWICZ e TAYLOR, 1989; entre outros). 

 
 

5.1.3. Inserção das Informações de Poços na Matriz de Coeficientes e 
Vetor de Termos Independentes 

 

 Avançando na compreensão de como cada uma das parcelas da equação da pressão foi 

implementada, resta considerar as duas últimas: termo de poços (fonte) e transiente, que  são 

determinados por procedimentos que não necessitam percorrer os elementos, como foi o 

cálculo dos termos de fluxo.  

Para determinar os termos de poços de injeção e produção basta implementar uma 

rotina computacional que percorra apenas os volumes (nós) que contêm poços, calculando e 

atualizando os coeficientes da matriz de coeficientes, [A], e o vetor de termos independentes, 

{ }F , na forma 
 

 nnnnn gAA += ,,                        (5.13)  
 

e 

 nnn fFF +=                         (5.14)   
  



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 63 

 

 

onde n é o nó do volume de controle que contém o poço, e ng  e nf  são termos dependentes 

do modelo de poço utilizado. Suas expressões mais comumente utilizadas são apresentadas no 

Anexo 3. 

 

5.1.4. Inserção do Termo Transiente na Matriz de Coeficientes e Vetor de 
Termos Independentes 

 

 Quanto à inserção do termo transiente na matriz global de coeficientes e no vetor de 

termos independentes o procedimento também é bastante trivial. Para tanto, basta fazer uma 

rotina computacional que percorra os nós da malha, na forma 

 

 PPPPP nAA += ,,    (5.15) 
 
e 

 PPP eFF +=  (5.16)  
 
onde P varia de 1 ao número total de nós da malha, e 

 

 
o ref o ref
w w w o o o P P

P o o
w o P

s B c s B c V
n

B B t
?? ? ?

= ? +? ? ?? ?
 (5.17)  

  
P

o

P
o
o

o
ref
o

o
o

o
w

w
ref
w

o
w

P t
Vp

B
cBs

B
cBs

e ??
?

?
??
?

?
?

?
??
?

?
??
?

?
+?=

?
 (5.18)  

 

onde PV?  é o volume total do volume de controle construído ao redor do nó P, que é formado 

pela união de todos os sub-volumes pertencentes a diferentes elementos que compartilham um 

mesmo nó. Essa grandeza é determinada no início do processo e apenas uma vez, percorrendo 

todos os elementos, somando a contribuição de cada sub-volume de controle, svcV? , num 

procedimento semelhante ao realizado para a montagem da matriz global de coeficientes 

demonstrado na seção 5.1.2. 

  

Cálculo do volume dos sub-volumes de controle. Para obter a expressão do svcV?   é 

necessário conhecer a expressão que calcula o volume do elemento (entidade definida pelos 

nós da malha) dado por (ZIENKIEWICZ e TAYLOR, 1989; MALISKA, 2004) 



64 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 ??
????

????
?

?
??
?

?
?
?

?
?

?
?
?

?
?

=?=?
yxyx

1SV ee .   (5.19) 

 

Comparando esta expressão com a Eq. (4.19), constata-se que o termo entre parênteses 

na Eq. (5.19) é exatamente o determinante da matriz Jacobiana. E como é comum usar ??  e 

??  unitários por simplicidade, pois os mesmos são arbitrários, é fácil demonstrar que os 

volumes de cada um dos sub-volumes de controle, svcV? , são dados por 

 

 6JVsvc ][det=?                                   (para elementos  triangulares) (5.20)   
 

 
mmsvc

JV ?? ,][det=?                              (para elementos quadrangulares)  (5.21) 
 

onde m  é o ponto médio do sub-volume de controle onde é avaliada a expressão do 

determinante. Para o sub-volume de controle 1 do elemento quadrilátero da Fig. 4.3, por 

exemplo, o ponto médio será dado por (? m  = + ½, ? m  = + ½).  No caso de elementos 

triangulares, o determinante da matriz Jacobiana resulta em um valor constante, por isso não é 

necessário avaliá-lo em nenhum ponto dentro do elemento.  

 

5.1.5. Sistema Linear Resultante 
 

Depois de receber as contribuições de todos os elementos e inserir as condições de 

contorno (informações de poços) e termo transiente na matriz global e no vetor de termos 

independentes, o sistema de equações final está completo e é dado por 
 

 [ ]{ } { }FpA =  (5.22)  
 

A solução da Eq. (5.22) é inserida na Eq. (5.7) para obter o campo de saturação de 

uma das fases. O campo de saturação da outra fase, por sua vez, é obtido por meio da equação 

de restrição, Eq. (5.2). Quanto ao tratamento dado aos termos da equação da saturação, 

embora não discutido aqui, segue o mesmo princípio de discretização e implementação 

apresentado para a equação da pressão. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 65 

 

 

Em casos onde é necessário prescrever valores de pressão no domínio, o sistema linear 

da Eq. (5.22) deve ser alterado, e o procedimento empregado neste trabalho está apresentado 

no Anexo 3. 

 

5.1.6. Determinação do Passo de Tempo 

 
A escolha do passo de tempo, t? , utilizado no termo transiente das equações de 

conservação é crucial no método IMPES. Como o campo de saturação é resolvido 

explicitamente neste método, surgem instabilidades numéricas nos resultados quando avança-

se no tempo com intervalos muito grandes. 

 Pode-se determinar uma expressão que estima o passo de tempo máximo que garante 

a estabilidade numérica para o IMPES baseando-se no fato de que uma frente de saturação 

não pode atravessar mais de um volume de controle inteiro em apenas um passo de tempo 

(AZIZ e SETTARI, 1979; MATTAX e DALTON, 1990), 
 

 
( )max '

max
min

1P
i w P

i P P

V
t

q f
?

? ? ?

? ? ? ??? ? ? ?? ? ? ? ? ?? ? ? ?? ?
?

 (5.23)   

 

onde pV?  é o volume poroso dos volumes de controle, iq  é o fluxo total na face i do sub-

volume de controle, e ( )'w
máx

f  é o valor máximo da derivada da curva de fluxo fracionário2 da 

água avaliado nos nós da malha.  

 

 

 

5.2. Método Totalmente Implícito 
 
A simulação de reservatórios de petróleo com grande número de elementos torna-se 

difícil através do IMPES, devido às restrições impostas no tamanho do passo de tempo, 

porque para manter a estabilidade ele torna-se excessivamente pequeno. Nestes casos, a 

alternativa mais viável é a solução implícita das equações através do método de Newton, que 

                                                 
2 O fluxo fracionário de uma fase é a razão entre a mobilidade desta fase e a mobilidade total. 



66 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

é o mais conhecido e estudado método de solução de sistemas de equações não-lineares 

(RUGGIERO e LOPES, 1997), e que permite obter a solução simultânea do campo de pressão 

e saturação.  

 Para usar o método de Newton, escrevem-se as equações na sua forma residual. A 

equação discretizada da conservação, Eq. (5.1) é avaliada implicitamente ( 1? = ), e escrita 

para a fase água, por exemplo, como 

 

 ( ) ( )( )
o

w wP P
w w i woP P

i Pw w P

s sV
R k p S q

t B B
?

?
? ?

? ??? ?= ? ? + ? ?? +? ?? ??? ?? ?
?  (5.24) 

 

enquanto que a equação da pressão, Eq. (5.3), é escrita como 

 

 
( ) ( ) ( )( )

                                                            1

P P ooT w w i w w o oP i i P
i P

o o
w oP P

w oo o
w o P

R B B k p S q B q B

s sV
B B

t B B

? ?

?
? ?

= + ? ?? + +

? ??
+ + ?? ?? ? ?

?
 (5.25)  

 
onde wR  e TR  são os resíduos das equações de conservação da fase água e da conservação 

total. O objetivo deste método é que estes resíduos, calculados em todos os  volumes de 

controle, sejam reduzidos a um valor suficientemente pequeno em cada intervalo de tempo. 

 

5.2.1. Sistema Linear Resultante 

 
 A fundamentação teórica que justifica a forma final do sistema linear resultante 

quando se utiliza o Método de Newton pode ser resumida em três passos básicos: 

 

1. Expansão do resíduo de uma determinada equação em série de Taylor desprezando 

os termos de maior ordem: 

 

 1 1
X

R
R R X

X

?
? ? ?+ +

?

?? ?= + ?? ??? ?
?  (5.26)   

 

onde ?  é o nível iterativo, X representa o vetor de incógnitas (p e sw) envolvidas com a 

respectiva equação de resíduo, e 1 1X X X? ? ?+ +? = ? .  



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 67 

 

 

2. Tornar nulo o resíduo da iteração ? +1: 

 

 1mm
X

R
R X

X

?
? ? +

?

?? ?? = ?? ??? ?
?  (5.27)  

 

3. Aplicar a equação anterior escrita para todos os volumes de controle, obtendo o 

seguinte sistema linear: 

 

 [ ]{ } { }A X R? = ?                               (5.28)                
 

onde A é a matriz Jacobiana. No sistema bifásico adotado, esse sistema matricial é formado a 

partir de matrizes de 2x2, doravante chamadas de blocos, apresentando duas incógnitas para 

cada nó, e tem a forma 

 

 

1 1 1 1

1 1 1 1

1 1

1 1

1 1

1 1

n n n n

n n n n

T T T T

w n wn

w w w w

w n wn

T T T T

w n wn

w w w w

w n wn

R R R R
p s p s

R R R R
p s p s

R R R R
p s p s

R R R R
p s p s

? ? ? ?? ?? ? ? ?
? ?? ? ? ?? ? ? ?? ?? ? ? ?
? ? ? ? ?? ? ? ?? ? ? ? ?
? ? ? ? ?? ? ? ?? ? ? ?
?
?
? ? ? ? ?? ? ? ?
?? ? ? ?? ? ? ??? ? ? ?
?? ? ? ?? ? ? ??? ? ? ??? ? ? ?? ? ? ?? ? ? ?? ?

…
1

1

1

1

n

n

T

ww

n T

wn w

Rp
Rs

p R
s R

? ? ?? ?? ? ? ? ?? ?? ? ?? ?? ?? ??? ? ?? ?? ? ? ?? ?
? ? ? ?? = ?? ? ? ??
? ? ? ?? ?? ? ? ?? ?? ? ? ?? ? ? ? ?? ? ? ??? ? ?? ? ? ?? ?? ??
?
?

 (5.29) 

 
 

Os campos de pressão e saturação são atualizados a cada iteração a partir de 

 

 { } { } { }1 1p p p? ? ?+ += + ?       e       { } { } { }1 1w w ws s s
? ? ?+ +

= + ?  (5.30)          
 

e através da equação da restrição obtém-se a saturação do óleo. Devido às não-linearidades 

presentes nas equações governantes, deve-se iterar um número suficiente de vezes em cada 

passo de tempo, evoluindo os valores de p e sw, recalculando a matriz [A] e o vetor {R}, e 

resolvendo o sistema linear resultante até que se obtenha resíduos suficientemente pequenos. 

Em comparação com o IMPES, o custo computacional da solução de cada nível 

temporal é maior neste método, pois é resolvido várias vezes, neste caso, uma matriz com o 



68 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

dobro do tamanho da matriz obtida no IMPES. Mas esse esforço é freqüentemente 

compensado pela possibilidade de avançar a solução com passos de tempo maiores.  

Na seqüência, são apresentados os procedimentos computacionais utilizados para a 

determinação do vetor de resíduos e da matriz Jacobiana da Eq. (5.29), além de serem 

discutidos outros aspectos importantes no Método de Newton. Aqui também será considerada 

apenas a implementação computacional da equação da pressão, sendo a implementação da 

saturação3 compreendida por analogia.  

  

5.2.2. Cálculo dos Resíduos 

 
 Para facilitar a implementação computacional, a forma residual da equação da pressão, 

Eq. (5.25), será escrita como uma soma de três parcelas: a de acumulação, a dos fluxos entre 

volumes de controle e a de poços 

 

 { } { } { } { }T T T Tacum fluxos poçosR R R R= + +                       (5.31) 
 

onde 

 1
o o
w oP P

T w oo oacum
w o P

s sV
R B B

t B B
? ? ??

= + ?? ?? ? ?
 (5.32)   

 

 ( ) ( )
P P ooT w w ifluxos i i

i P
R B B k p S? ?

? ?

= + ? ???  (5.33)  
 

 ( )T w w o opoços PR q B q B= +  (5.34) 
 

A forma de representar a equação do resíduo dada pela Eq. (5.31) é mais conveniente 

porque torna o cálculo de cada um dos componentes do resíduo independente dos demais, 

seguindo procedimentos particulares e mais apropriados. O resíduo do termo de acumulação 

definido na Eq. (5.32), por exemplo, deve ser calculado em uma rotina que varre todos os nós 

da malha. O resíduo do termo de fluxo, Eq. (5.33), deve ser calculado visitando elemento a 

elemento da malha, enquanto que o resíduo do termo de poços, Eq. (5.34), é calculado 

segundo uma rotina que varre apenas os nós referentes aos volumes de controle que possuem 
                                                 
3  Trata-se de um artifício didático nomear uma equação como sendo a da pressão e a outra da saturação no 
Método Totalmente Implícito, porque ambas as variáveis estão ativas, diretamente ou não, nas duas equações. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 69 

 

 

poços. No Anexo 3 são apresentadas as expressões dos fluxos da Eq. (5.34) mais comumente 

utilizadas como condição de contorno nos poços.  

Conforme foi visto anteriormente, cada um dos sub-volumes de controle que formam  

um elemento, seja ele triangular ou quadrilátero, terá sempre duas interfaces internas com 

outros sub-volumes do mesmo elemento por onde o fluido escoará. Logo, a Eq. (5.33) pode 

ser calculada elemento a elemento utilizando a seguinte expressão 

 

 
{ } { } { }

,

( )( )

           

P P ooT w w nfluxos n n
n P i j

T T
Pi Pji j

R B B k p S

h H h H p

? ?
? =

= + ? ??

? ?= ?? ?

?
 (5.35) 

 

onde os sub-índices i e j são os pontos de integração localizados nas duas faces internas dos 

sub-volumes de controle, e os termos { }iH  e Pih  são dados pela Eq. (4.32) e pela versão 
implícita da Eq. (5.10), respectivamente. A Eq. (5.35) representa a contribuição de um sub-

volume de controle i para o cálculo do resíduo do termo de fluxo em um volume de controle 

completo.  

Visando utilizar uma estrutura que possibilite uma implementação mais geral 

mediante a construção de uma matriz no elemento, os sub-índices i e j devem ser definidos 

como 

 

 
=  numeração local do sub-volume de controle analisado, = 1, ..., 

 +1      se        ou    = 1    se    
i i NNE
j = i i NNE j i = NNE

?
?

??
      (5.36)  

 

onde NNE já foi definido no capítulo anterior e representa o número de nós do elemento. 

 Valendo-se da estruturada computacional já utilizada no IMPES, o vetor de termos 

independentes do resíduo de cada equação pode ser calculado como 

 

 { } [ ]{ } { } { }T T T Tacum poçosR A p R R= ? +       (5.37)  
 

onde { }p  é o vetor global dos valores de pressão e [ ]TA  é a matriz global formada elemento a 
elemento pela contribuição das matrizes locais definidas na Eq. (5.12).    

 

 



70 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

5.2.3. Cálculo das Derivadas dos Resíduos 

 
As derivadas dos resíduos em relação a pressão e saturação de água apresentadas na 

Eq. (5.29) podem ser determinadas analítica ou numericamente. Neste trabalho optou-se por 

utilizar expressões analíticas por produzirem uma matriz Jacobiana exata, portanto, de melhor 

qualidade para convergência, e por serem facilmente deduzidas a partir das equações 

discretizadas neste trabalho4. Embora sejam apresentados procedimentos particulares 

desenvolvidos nesta tese para aplicação em malhas não-estruturadas, o processo de formação 

da matriz Jacobiana é basicamente o mesmo utilizado pelos simuladores em geral, por isso o 

leitor familiarizado com esse processo  poderá ir diretamente para a próxima seção (5.2.4) que 

trata dos critérios de convergência e cálculo do passo de tempo. 

 

Termos de Acumulação. As derivadas do termo de acumulação da equação do 

resíduo, Eq. (5.32), em relação a pressão são dadas por 

 

 
o o
w w o oT P P
o o
w oacum P

s dB s dBR V
p t B dp B dp

? ? ?? ?
= +? ?? ? ? ?

                    (5.38)  

 

e em relação a saturação são nulas 

 

 0T
w acum

R
s

?
=

?
 (5.39) 

 

Termos de poços. As derivadas dos termos de poços, Eq. (5.34), só não serão nulas 

para a condição de contorno de pressão de fundo de poço prescrita, que para os poços 

produtores é escrita como 

 

 ( )m m fpq WI p p?= ?   (5.40)   
 

                                                 
4 Mesmo em casos onde é possível encontrar a derivada analítica das equações dos resíduos, é preferível em 
determinadas situações calcular as derivadas numericamente criando um procedimento mais geral, facilitando a 
troca de equações constitutivas, de equações de estado, entre outras. Nestes casos, e em algumas situações onde 
não é possível encontrar as derivadas analíticas de todos os termos, utiliza-se a aproximação numérica das 
derivadas, que consiste simplesmente em calcular a função com um valor “perturbado”, subtrair desta a função 
calculada sem a perturbação e dividir o resultado pelo valor da perturbação. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 71 

 

 

onde fpp  é a pressão de fundo de poço e WI é o índice de poço que compreende fatores físicos 

e geométricos do poço. Quando essa condição é prescrita, as derivadas dos termos de poços 

da equação da pressão são dadas por 

 

 ( )
,

m mT
m m m m fp

m w opoços

BR
WI B B p p

p p p
?

? ?
=

? ?? ?? ??
= ? + + ?? ?? ?? ? ?? ?? ?

?  (5.41)  

e  

 ( )
,

mT
m fp

m w ow wpoços

R
WI B p p

s s
?

=

??
= ? ?

? ??  (5.42)  

 

No Anexo 3 podem ser obtidos maiores detalhes sobre esta condição de poço e outras 

não mencionadas. 

  

Termos de fluxo. As derivadas dos termos de fluxo em relação a saturação, Eq. (5.33), 

são calculadas a partir de 

 

 { } { } { }( )
k k

T TT
Pi Pji j

w wfluxos

R
h H h H p

s s
? ? ? ?= ?? ?? ?

                      

  

                  
( ) ( ) ( ) ( )( )

( ) ( ) ( ) ( )( )

1 1 ....

             1 1 ....
k

Pi i i
w

Pj j j

h H p H NNE p NNE
s

h H p H NNE p NNE

?
?= + + +??

?? + + ?

     (5.43)  

   

                           { } { } { } { }
k k

T TPjPi
i j

w w

hh
H p H p

s s
??

= ?
? ?

  

 

onde k = 1, ..., NNE para cada sub-volume de controle, com i e j sendo pontos de integração 

definidos com i = 1, ..., NNE e  j = i +1 se i &amp;lt;NNE ou  j = 1 se  i = NNE. Logo, esse termo 

resulta num vetor de dimensões NNE para cada sub-volume de controle, que é a contribuição 

de um sub-volume de controle no cálculo deste resíduo para o volume que o contém. Cada 

derivada presente nesta expressão é determinada a partir de 

 

 ( ) ( )
k k k

i i

Pi w o
w oP P

w w wip ip

h
B B

s s s
? ?? ? ? ?? ? ?

= +? ? ? ?? ? ? ?? ? ?? ? ? ?
  (5.44) 



72 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Contudo, deve-se observar que em função da avaliação à montante do termo de 

mobilidade discutida no capítulo anterior, as derivadas em relação à saturação da equação 

anterior só não serão nulas se o nó a montante deste ponto de integração for o próprio nó k, 

isto é, 

 

0           se  nó à montante  no ponto de integração = 
k

i

m

w ip

k  i
s
??

= ?
?

   

 

Já as derivadas dos resíduos do termo de fluxo em relação a pressão serão calculadas a 

partir de  

            

 { } { } { }( )T TT Pi Pji j
k kfluxos

R
h H h H p

p p
? ? ? ?= ?? ?? ?

 

 

                  
( ) ( ) ( ) ( )( )

( ) ( ) ( ) ( )( )

1 1 ....

             1 1 ....

Pi i i
k

Pj j j

h H p H NNE p NNE
p

h H p H NNE p NNE

?
?= + + +??

?? + + ?

        (5.45) 

 

                { } { } { } { } ( ) ( )( )T TPjPi Pi i Pj ji j
k k

hh
H p H p h H k h H k

p p
?? ??

= ? + ?? ?? ?? ?
     

             
 

Cada derivada presente nesta expressão é determinada a partir de 
 

      

 ( ) ( )
,

i

i

Pi m m
m mip P

m w ok k kP ip

h dB
B

p dp p
?

?
=

? ?? ? ? ?? ?
? ?= +? ? ? ?? ?? ?? ? ? ?? ?

?  (5.46) 

                         
que utiliza as mesmas definições dos sub-índices i, j e k da derivada do resíduo deduzida 

anteriormente. E como antes também, a derivada avaliada no ponto de integração poderá ser 

nula dependendo do nó localizado à montante 

 

0          se  nó à montante  no ponto de integração = 
i

m

k ip

k  i
p
??

= ?
?

   

 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 73 

 

 

 As derivadas do termo de fluxo do resíduo foram implementadas nesse trabalho 

definindo-se uma matriz do elemento que tem a forma 

 

 
1

1

1

svc

svcNNE

T T

NNE

T

fluxos e
T T

NNE
e

R R
X X

R
X

R R
X X

? ?? ? ??
? ??? ? ?? ?? ?

? ?? ? ?
=? ? ? ??? ?? ? ? ?? ? ??
? ??? ? ?? ?? ?? ?

…

 (5.47)  

 

onde X representa as variáveis dependentes do problema, p e sw, e cada linha apresenta a 

equação de conservação de um dos sub-volumes que compõe o elemento. Essa matriz pode 

ser decomposta em duas partes, 

 

 
A B

T T T

fluxos fluxos fluxose e e

R R R
X X X

? ? ? ? ? ?? ? ?
= +? ? ? ? ? ?

? ? ?? ? ? ? ? ?? ? ? ? ? ?
 (5.48)  

 
 

                                              1ª. parcela      2ª. parcela  
 

Determinação da 1ª. Parcela da Eq. (5.48): Esta parcela representa a derivação da 

mobilidade presente nas Eqs. (5.43) e (5.45) em relação as variáveis dependentes, mantendo a 

pressão constante. Ela é uma matriz que é escrita para elementos triangulares com dimensão 

de (3x3): 

 

 
( ) ( )
( ) ( )
( ) ( )

* *
1 2
* *
2 3
* *
3 1

1, 2,
2, 3,
3, 1,

A X X
T

X X
fluxos e

X X e

D k H D k H
R

D k H D k H
X

D k H D k H

? ??
? ?? ? ?

= ?? ? ? ??? ?? ? ? ??? ?

        k = 1, 2, 3 (5.49)  

 
e para elementos quadrangulares com dimensão de (4x4): 
    

 

( ) ( )
( ) ( )
( ) ( )
( ) ( )

* *
1 2
* *
2 3
* *
3 4
* *
4 1

1, 2,
2, 3,
3, 4,
4, 1,

X X
A

X XT

fluxos X Xe

X X e

D k H D k H
D k H D k HR
D k H D k HX
D k H D k H

? ??
? ?? ? ?? ? ?=? ? ? ???? ?? ? ? ?

?? ?? ?

          k = 1, 2, 3, 4  (5.50) 

 



74 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

onde { } { }* Ti iH H p=  e a matriz de derivadas [ ]XD  é definida em cada elemento como 
 

 [ ]
( ) ( ) ( )

( ) ( ) ( )
( ) ( ) ( )

1 1,1 0 1, 3
2,1 2 2, 2 0

0 3, 2 3 3, 3

B
X X X

B
X X X Xe

B
X X X e

D D D
D D D D

D D D

? ?

? ?

? ?

? ?+
? ?= +? ?
? ?+? ?

 (5.51)             

 

para elementos  triangulares e 
    

[ ]

( ) ( ) ( )
( ) ( ) ( )

( ) ( ) ( )
( ) ( ) ( )

1 1,1 0 0 1, 4
2,1 2 2, 2 0 0

0 3, 2 3 3, 3 0
0 0 4, 3 4 4, 4

B
X X X

B
X X X

X Be
X X X

B
X X X e

D D D
D D D

D
D D D

D D D

? ?

? ?

? ?

? ?

? ?+
? ?+? ?=
? ?+
? ?

+? ?? ?
                 

    (5.52) 

    

para elementos quadrangulares, onde cada coeficiente desta matriz é uma derivada dada por 
 

 
( ) ( )

( )
,

         para   

0                                         para   

i

B m
X m ip

m w o i P

B
X w

dB
D i X p

dp

D i X s

?
=

? ? ?? ?
= =? ? ?? ??

? ?? ? ?? ?
?

= =??

?
  (5.53)  

 

e 

 

( ) ( )
( )

( ) ( )

2
,

,

, =   para  

1
, =                                   para  

i

i

m r m m m
X m m mP

m w o k ip m m i

m r m
X m wP

m w o w m m wip i

k d dB
D i j B B X p

p dp dpB

dk
D i j B X s

s B ds

?

?

? µ
µ

µ

?
µ

=

=

? ? ? ? ?? ? ? ??? ? ?= ? + =? ?? ? ? ??? ? ? ? ?? ?? ? ? ?? ? ?
?

? ?? ? ? ??
? ?= =? ? ? ??? ?? ? ? ?? ?

?

?
?
?
??

 

(5.54) 

Na Eq. (5.54) se o nó à montante de um ponto de integração i não for igual ao nó local 

j, esta equação deverá ser anulada. Isso implica que, quando ( )1,1XD?  for não-nulo, por 

exemplo, ( )1,XD NNE?  deverá ser necessariamente nulo devido a função upwind utilizada 
para a mobilidade, e assim por diante.         

 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 75 

 

 

Determinação da 2ª. Parcela da Eq. (5.48): Esta parcela representa a derivação da 

pressão presente nas Eqs. (5.43) e (5.45) em relação as variáveis dependentes, mantendo a 

mobilidade constante. Por isso quando a variável dependente for a saturação esta parcela é 

nula: 

 

  

[ ]                    para   

0                          para   

B

T
e

fluxos e

B

T
w

fluxos e

R
A X p

X

R
X s

X

? ? ??
= =? ? ?

?? ?? ? ??
?
? ? ??
? = =? ?

?? ? ?? ? ?

  (5.55)  

 
 
onde [ ]eA  é a mesma matriz do elemento utilizada no IMPES e definida na Eq. (5.12). 

Determinada a matriz completa do elemento no Método Totalmente Implícito, Eq. 

(5.48), os valores devem ser transportados para a matriz global apresentada na Eq. (5.29), 

seguindo um procedimento muito semelhante ao utilizado na montagem da matriz global da 

pressão no método IMPES, sintetizado na Fig. 5.1, com a exceção de que para o método 

totalmente implícito tem-se uma sub-matriz de 2x2 para cada posição na matriz, 
 

T T

w

w w

w

R R
p s

R R
p s

? ?? ?
? ?? ?
? ?
? ?? ?
? ?
? ?? ?

 

 

conforme apresentado anteriormente na Eq. (5.29).  

 

 

5.2.4. Critérios de Convergência e Cálculo do Passo de Tempo 

 

Convergência do Método de Newton. A solução apresentada pelo Método de Newton 

será considerada convergida em cada passo de tempo quando os seguinte critérios baseados 

nas máximas variações de p e sw  (norma l?) forem satisfeitos: 
 



76 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

1. 1
max

p p? ?+ ?  &amp;lt;max
userp?  

2. 1
maxw w

s s? ?+ ? &amp;lt;( )max
user

ws?   

 

onde ?  é o nível iterativo e as grandezas com super-índices “user” são os valores limites em 

cada iteração especificados pelo usuário: 

 

max
userp?  = máxima variação permitida na pressão (valor padrão (default)  =  10 kPa) 

( )max
user

ws?  = máxima variação permitida na saturação de água (valor default  = 0,005).  

 

 Convergência da solução do sistema linear. Quanto ao critério de convergência do 

solver, será utilizado um esquema baseado nos mesmos valores max
userp?  e ( )max

user
ws?  utilizados 

nos critérios de convergência do Método de Newton. O solver permanecerá iterando enquanto 

as mudanças nos valores das variáveis primárias forem maiores que um determinado 

percentual daqueles parâmetros. O valor padrão (default) utilizado foi 10%.  

 

Determinação do passo de tempo. Embora sejam menores as restrições do tamanho do 

passo de tempo no método implícito, uma vez que este esquema é mais estável que o IMPES, 

deve-se ter cuidado para que ele produza soluções dentro da precisão desejada para o 

problema em questão, haja vista a aproximação da derivada temporal. Uma expressão que 

permite determinar o passo de tempo automaticamente em função de parâmetros calculados 

no passo de tempo anterior, e que vem sendo utilizada pelos simuladores comerciais (STARS 

User’s Guide, 2002) em função de resultar em passos de tempo razoáveis é dada por 

 

 
max min

1,75
0,75

user
o P

user
P

DNormX
t t

DNormX DNormX
? ?

? = ? ? ?+? ?
 (5.56)  

 

onde maxDNormX  é a máxima variação da variável X durante o passo de tempo anterior, e  
user

PDNormX  é uma grandeza definida pelo usuário e que representa a mudança típica 

esperada da variável X em cada passo de tempo. Para os problemas considerados neste 

trabalho, userPDNormX  assume valores da ordem de 1000 kPa e 0,2, para X = p e sw, 

respectivamente. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 77 

 

 

O passo de tempo estimado pela Eq. (5.56) poderá ainda assim ser inadequado se 

resultar em um número elevado de iterações do método de Newton para a obtenção da solução 

convergida ou se surgirem mudanças bruscas do valor das variáveis naquele passo de tempo. 

Deste modo, deve-se utilizar um controle adicional do passo de tempo que abortará a solução 

de um dado um determinado nível temporal se  

 

1. O número de iterações necessárias para a convergência do Método de Newton 

exceder um número máximo estabelecido pelo usuário (valor default = 10); 

2. As variações da pressão e saturação forem maiores que valores pré-estabelecidos 

pelo usuário (valor default = 2 userPDNormX? ). 

 

Em qualquer um destes casos a solução deste nível temporal é interrompida, devendo 

ser reiniciada, adotando-se um passo de tempo menor. Normalmente, uma redução de 50% do 

valor do passo de tempo tem demonstrado ser razoável. 

Por outro lado, se o passo de tempo estimado pela Eq. (5.56) for maior que um valor 

especificado pelo usuário, então o valor prescrito será o utilizado. Caso seja menor que um 

valor mínimo prescrito, a simulação será interrompida, porque, provavelmente, houve a 

entrada de dados incompatíveis com a modelagem física adotada. 

 

5.2.5. Procedimento Computacional 

 
 As etapas do método de solução implícita das equações podem ser resumidas como: 

 

1. Inicializar os vetores e matrizes: 

a) zerando a matriz Jacobiana [ ]A  e a matriz do elemento do IMPES [ ]eA , Eq. (5.12) que 
será utilizada também no Método Totalmente Implícito ( ver Eq. (5.55) ); 

b) computando os valores de B, µ  e as mobilidades das fases e suas derivadas em relação a 

pressão e saturação nos nós da malha; 

c) determinando em todos os pontos de integração a numeração local do nó localizado à 

montante da face que contém o ponto de integração.  

 

2. Em um loop sobre os elementos da malha: 



78 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

a) utilizar nos pontos de integração o valor das mobilidades e as suas derivadas que são 

utilizadas no cálculo dos termos XD , Eq. (5.53), de acordo com a numeração local do nó 

localizado à montante (item 1 c). 

b) determinar as matrizes de derivadas de cada fase - XD e? ?? ? , Eqs. (5.51) e (5.52). 

c) calcular a matriz local [ ]eA , Eq. (5.12), e adicionar cada coeficiente na sua posição 

específica nas matrizes locais de derivadas de resíduos, Eq. (5.48). Além disso deve ser 

criado um vetor de (NNE x 1) multiplicando esta matriz pelo vetor de pressão do elemento 

Todo esse procedimento não necessita ser feito para a equação da água. 

d) adicionar as derivadas do termo de fluxo definidas nas matrizes locais na matriz  

Jacobiana, e também o vetor local para o vetor  global de termos independentes (ver seção 

5.1.2). 

 

3. Em um loop sobre os nós da malha: 
a) calcular o termo de acumulação, Eq. (5.32), e subtraí-lo do vetor de resíduos, Eq. (5.37).  

b) calcular as derivadas do termo de acumulação, Eqs. (5.38) e (5.39), e subtraí-las dos 

termos correspondentes da matriz (2x2) localizada na diagonal da matriz Jacobiana, Eq. 

(5.29). 

 

4. Em um loop sobre os nós que contenham poços: 
a) calcular o termo de poço, Eq. (5.34), e adicioná-lo no vetor de resíduos, Eq. (5.37); 

b) calcular as derivadas do termo de poço em função do modelo de poço adotado, e adicioná-

las na matriz (2x2) correspondente na diagonal da matriz Jacobiana, Eq. (5.29). 

 

5. Resolver o sistema linear para determinar o vetor de incógnitas, Eq. (5.29). 

 

6. Avançar as variáveis dependentes no nível iterativo: { } { } { }1 1p p p? ? ?+ += + ?  e 

{ } { } { }1 1w w ws s s
? ? ?+ +

= + ? . 

 

7. Verificar se a convergência foi obtida a partir dos critérios dados na seção 5.2.4. 

Se não foi, volta-se ao passo 1, incrementando-se o nível iterativo ( 1+= ?? ), ou 

abortando a solução deste intervalo de tempo, reduzindo o passo de tempo e 

tornando 0=? , se o número de ciclos de Newton for demasiado grande ou se as 

variáveis dependentes apresentarem variação maior que o estipulado. 

 

8. Avançar no tempo ( ttt ?+=  e 0=? ) e retornar ao passo 1. 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 79 

 

 

5.3. Esquema de Armazenamento de Matrizes Esparsas 
 
 

As matrizes de coeficientes geradas nos métodos IMPES e Totalmente Implícito são 

altamente esparsas, isto é, possuem um número elevado de valores nulos. Um armazenamento 

de todos os seus coeficientes é altamente ineficiente por trabalhar com uma quantidade 

enorme de zeros e impraticável em função da capacidade de memória dos computadores 

atuais. Por isso existem esquemas especiais de tratamento de matrizes esparsas em que apenas 

os valores não-nulos de uma matriz são armazenados. 

A utilização de esquemas de armazenamento de matrizes esparsas não invalida as 

idéias gerais apresentadas na seção 5.1.2 a respeito da formação das matrizes globais. 

Contudo, os dados passam a ser estruturados não mais a partir de uma forma matricial, mas 

utilizando três vetores que definem todos os elementos não-nulos. O esquema mais simples é 

denominado de formato coordenado (SAAD, 2000), cuja estrutura de dados é composta por 

três vetores de mesmas dimensões:  

 

1. Um vetor de inteiros com os índices das linhas; 

2. Um vetor de inteiros com os índices das colunas; 

3. Um vetor de números reais contendo os valores não-nulos localizados nas posições 

(linha, coluna) definidas nos outros dois vetores. 

 

A Fig. 5.2 ilustra o processo de representação de matrizes esparsas neste formato, 

apresentando um exemplo de uma malha composta por dois elementos – um triangular e outro 

quadrilátero. Nota-se que, semelhantemente ao processo de formação das matrizes globais 

cheias, a matriz global esparsa representada desta forma continua sendo montada a partir da 

informação proveniente das matrizes locais de coeficientes, como deveria ser.  

O esquema de armazenamento adotado neste trabalho é uma variante do formato 

apresentado na Fig. 5.2, e é denominado de formato de linha comprimida - Compressed 

Sparse Row – CSR (BARRETT et al., 1994). Este é o formato de entrada comumente 

utilizado pelos pacotes computacionais por ser mais útil nas operações matriciais típicas, 

embora não seja tão simples e flexível como o formato coordenado. Em vez de armazenar a 

informação redundante referente à numeração dos índices das linhas, é armazenado um vetor 

que aponta para o primeiro valor de cada linha na matriz cheia. A Fig. 5.3 apresenta a matriz 

mostrada na Fig. 5.2 no formato CSR. Além de economizar espaço na memória do 



80 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

computador, no formato CSR tem-se a localização direta do início de cada linha, o que é uma 

informação que agiliza as operações com matrizes.  

 

 

 

 
 

Fig. 5.2 - Procedimento de preenchimento da matriz esparsa (formato coordenado) definida por três vetores que 

contêm os valores não-nulos e os índices que definem a posição de cada um deles na matriz cheia.  

 

 

 

 

 

Fig. 5.3 - Matriz esparsa da Fig. 5.2 no formato de linha comprimida (Compressed Sparse Row) 

 

 



 CAP. 5 – IMPLEMENTAÇÃO COMPUTACIONAL 81 

 

 

A desvantagem da utilização do esquema que armazena apenas os elementos não-

nulos de uma matriz se manifesta durante o processo de construção, isto é, quando são 

visitados os elementos e os valores contidos nas matrizes locais são transferidos para a matriz 

global. A dificuldade é identificar diretamente a localização de um coeficiente no vetor de 

valores dados seus índices da linha e coluna correspondentes da matriz cheia. No entanto, as 

bibliotecas numéricas disponíveis, como a COI-lib5 entre outras, apresentam algoritmos muito 

eficientes que reduzem consideravelmente o trabalho de pesquisa da posição de um 

coeficiente no vetor de valores. Os casos rodados demonstraram que o tempo despendido 

nesta tarefa é incomparavelmente menor que o tempo gasto na solução do sistema linear. Por 

isso não foi dedicado muito esforço neste processo, e sim na implementação de um solver 

mais rápido, o multigrid, que será objeto de estudo no próximo capítulo. 

Porém, quando não se dispõe de uma biblioteca numérica como a COI-lib para 

processar a transferência de dados das matrizes locais para a global, pode-se criar algoritmos 

como o proposto no Anexo 4 que são eficientes e de implementação simples, mas que 

necessitam alocar uma quantidade, muitas vezes, excessiva de memória, em função da criação 

de matrizes locais de endereços em cada elemento. Em situações onde a capacidade de 

memória computacional não for uma restrição muito séria, estes esquemas poderão ser uma 

boa alternativa. 

                                                 
5 A COI-lib é uma biblioteca gráfica desenvolvida em C++ com o objetivo de facilitar o uso de aplicativos de 
alta complexidade, permitindo a entrada de dados e visualização de resultados de maneira simples e intuitiva. 
Pode ser encontrada em http://www.sinmec.ufsc.br/sinmec/software/coi-lib.html. 



 



83 

Cap.    

6 
MMÉÉTTOODDOO  MMUULLTTIIGGRRIIDD  DDEE  SSOOLLUUÇÇÃÃOO    
DDOO  SSIISSTTEEMMAA  LLIINNEEAARR  

 

 
 

6.1. Características do Método Multigrid 
 
O multigrid é um dos métodos disponíveis na literatura para melhorar a eficiência dos 

solvers iterativos. De forma geral, eles se destacam por sua alta robustez, isto é, por sua 

capacidade de resolver sistemas lineares provenientes de diferentes problemas físicos sem 

perda sensível de eficiência (RAW, 1996). Solvers robustos requerem pouca intervenção do 

usuário na mudança de seus parâmetros. Outra característica verificada nos métodos multigrid 

é a sua convergência monotônica, isto é, a solução fornecida pelo solver aproxima-se da 

solução exata a cada iteração (VAN DOORMAAL et al., 1987; ELIAS et al., 1997).  

Normalmente a qualidade da solução numérica está diretamente associada ao número 

de pontos da malha utilizada, no sentido em que uma malha mais refinada representará com 

maior fidelidade a solução da equação diferencial discretizada. Por outro lado, o custo 

computacional para sua determinação é mais alto. Já em uma malha mais grosseira (com um 

número menor de pontos de malha), a solução pode ser mais rapidamente obtida, porém com 

uma qualidade inferior à da malha refinada devido aos maiores erros de truncamento. A idéia 

básica do método multigrid é utilizar malhas diferentes na resolução de um problema a fim de 

acelerar a convergência de malhas mais refinadas. 

Alguns solvers são robustos e eficientes na solução de sistemas lineares com poucas 

variáveis, mas seu custo computacional pode variar exponencialmente com o tamanho do 

problema. Os solvers Gauss-Seidel e os métodos diretos em geral, por exemplo, apresentam 

esforço computacional que aumenta com o quadrado e com o cubo, respectivamente, do 

número de variáveis do sistema linear. Por isso, a ordem do solver é outra importante 

característica a analisar. Ela é expressa como O(N?), onde ?  é a taxa que indica o aumento do 



84 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

esforço do solver com o número de variáveis (N) do problema. A Fig. 6.1 apresenta as curvas 

típicas que relacionam o custo computacional (tempo de CPU) com o número de variáveis do 

sistema linear para diferentes solvers. Percebe-se, nesta figura, que os solvers diretos, como 

Eliminação de Gauss e LU, são métodos de elevada ordem - O(N3), e que portanto, são 

impraticáveis para resolver problemas com grande número de variáveis porque o custo 

computacional torna-se excessivamente grande. 

 

 

 

Fig. 6.1- Comparação entre o desempenho teórico de diferentes solvers 

 

 

Os métodos multigrid, por sua vez, são lineares, isto é, possuem ordem - O(N), que é a 

situação ideal, embora apresentem custo computacional maior que os outros métodos para 

número pequeno de variáveis, conforme pode se visto na Fig. 6.1. Esse mau desempenho na 

solução de pequenos sistemas lineares deve-se aos procedimentos de obtenção dos 

coeficientes e de outros parâmetros das malhas grosseiras. Outros métodos iterativos não 

mencionados como Métodos de Gradiente Conjugado, GMRES, são métodos que apresentam 

curvas de convergência situadas entre a do Gauss-Seidel e a do multigrid na Fig. 6.1. 

 O método multigrid adotado neste trabalho é do tipo algébrico, também chamado na 

literatura de método multigrid baseado na correção aditiva (HUTCHINSON e RAITHBY, 

1986), aplicado originalmente em malhas estruturadas. Neste método, que será denominado a 

partir de agora pelo acrônimo ACM (The Additive Correction Multigrid), propõe-se que as 



 CAP. 6 – MÉTODO MULTIGRID 85 

 

 

equações sejam deduzidas apenas para a malha refinada, sendo as equações utilizadas nas 

malhas grosseiras obtidas apenas somando-se os coeficientes da malha original. Por isso não é 

necessário ter stencils fixos, o que evita inconsistências entre as malhas e é uma característica 

muito apropriada para aplicação do método em malhas não-estruturadas como as utilizadas 

neste trabalho. O processo de formação das células grosseiras e a dedução de suas equações 

são consideradas adiante neste capítulo. 

 Embora esteja sendo utilizada exaustivamente neste trabalho, deve-se mencionar que a 

denominação multigrid não é a mais adequada para descrevê-lo, porque, de fato, não 

necessita-se mais gerar as malhas grosseiras e nem discretizar as equações diferenciais nelas. 

Porém, para evitar incompatibilidades com diversos trabalhos da literatura e em função de que 

muitas vezes deseja-se caracterizar graficamente as conexões das equações utilizadas nas 

malhas grosseiras, procurou-se manter esta denominação. 

 

 

6.2. Mecanismos Envolvidos no Multigrid 
 

 De forma geral há três mecanismos envolvidos no método multigrid: 

 

1. Transferência de informação da malha grosseira para a refinada. 

2. Solução na malha grosseira. 

3. Transferência de informação da malha refinada para a grosseira. 

 

Embora pareça, à primeira vista, ser mais intuitivo discutir estes mecanismos na 

ordem inversa, isto é, de 3 a 1, é mais didático, pelo menos para o ACM, descrevê-los 

exatamente nesta ordem, o que será feito com mais detalhes na seqüência. 

 

6.2.1. Transferência de Informação da Malha Grosseira para a Refinada 

 

 Esta etapa é denominada “operação de prolongação” (BRIGGS et al., 2000; 

TROTTENBERG et al., 2001), e nela a variável da malha refinada tem a sua estimativa 

atualizada com um valor de correção que contribuirá para a eliminação dos erros de baixa 

ordem. No ACM propõe-se que a malha grosseira forneça um vetor com as correções a serem 



86 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

adicionadas na solução da malha refinada. Desta forma, a estimativa da variável será 

incrementada assim 

 

 *P P I?= +? ?  (6.1) 

 

onde *P?  é a solução corrigida da variável ?  calculada para o nó P da malha refinada e  

utilizada como estimativa inicial na próxima iteração, P?  é a última estimativa desta variável 

na malha refinada, ou seja, a solução mais recente, e I?  é a correção proveniente da malha 

grosseira. Nesta equação P representa cada um dos volumes de controle que compõem a 

célula I. A Fig. 6.2 mostra um exemplo da formação das células da malha grosseira a partir de 

uma malha de volumes de controle não-estruturada, denominada na figura de malha original, 

que é aquela onde se procura a solução do sistema linear. 

 

 

 
 

Fig. 6.2 - Processo de formação das malhas grosseiras a partir da aglomeração dos volumes de controle da malha 

original, onde se procura a solução do sistema linear 

  

 

Note que, embora o método de solução das equações seja baseado em elementos – 

EbFVM, as equações finais na malha original são o resultado da aplicação dos princípios de 



 CAP. 6 – MÉTODO MULTIGRID 87 

 

 

conservação nos volumes de controle. Objetiva-se no multigrid que estes princípios apliquem-

se também nas equações da malha grosseira e, por isso, ela deve ser construída pela união de 

volumes de controle, como ilustrado na Fig. 6.2, e não de elementos de malha, que seria um 

procedimento bem mais simples. 

 

6.2.2. Solução na Malha Grosseira 

 
Para que sejam obtidos valores de correção ( I? ) adequados é necessário estabelecer 

equações a serem resolvidas nas malhas grosseiras que tenham forte relação com a física do 

problema a ser resolvida na malha original. Por isso nos métodos multigrid tradicionais as 

equações diferenciais são também discretizadas e resolvidas nas malhas grosseiras. Porém 

esse procedimento aumenta o custo e a complexidade computacional, criando eventuais 

inconsistências entre malhas. Para evitar essas dificuldades é utilizado um procedimento 

diferente no ACM. 

Deseja-se definir um I?  de tal forma que o resíduo da equação de cada volume de 

controle da malha original torne-se mais próximo de zero. Em última instância esse é o 

objetivo do multigrid, como é o de qualquer solver. Uma condição que pode ser explorada 

advém da inspeção de que na solução exata do sistema linear o resíduo de cada equação é 

nulo, assim como deve ser nulo também o somatório dos resíduos das equações de quaisquer 

volumes de controle do domínio 

 

 * 0P
P

=?R  (6.2) 

 

onde *PR  é a expressão mais recente do resíduo
1 da equação de P e, devido à discretização em 

EbFVM, terá a forma 

 

 * * *
 de 

P P P P nb nb
nb P

b A A= ? ? ?R ? ?  (6.3) 

 

                                                 
1 Deve-se evitar confundir a expressão do resíduo R  que é definido sob o ponto de vista do solver (problema 
linear), com o resíduo R do método de Newton e empregado apenas no método Totalmente Implícito (problema 
não-linear). 



88 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

onde nb representa os nós vizinhos a P, A é a matriz de coeficientes e b é o vetor de termos 

independentes. 

Se for substituída a variável *P?  da Eq. (6.1) em (6.3), tem-se 

 

 ( ) ( )* , ,
 de 

P P P P P I P nb nb nb
nb P

b A A? ?= ? + ? +?R ? ?  (6.4) 

 

Mas, reconhecendo a expressão do resíduo PR  presente na equação anterior 

 

 , ,
 de 

P P P P P nb nb P
nb P

b A A? ? =? R? ?  (6.5) 

 

pode-se reescrever a Eq. (6.4) como 

 

 * , ,
 de 

P P P P I P nb nb
nb P

A A? ?= ? ? ?R R  (6.6) 

 

 Escolhendo convenientemente quais volumes de controle farão parte da célula I, e 

somando seus resíduos de acordo com a Eq. (6.2) obtém-se 

 

 , ,
 de 

0 P P P I P nb nb
P I nb P

A A? ?
?

? ?
= ? ?? ?

? ?
? ?R  (6.7) 

 

que escrito da forma tradicional resulta em  

 

 , ,
 de 

I I I I NB NB I
NB I

A A b? ?+ =?  (6.8) 

 

onde NB é o índice das células vizinhas a I na malha grosseira, e 

 

 
( )

, , ,
 de 

I I P P P nb
P I P I nb P I

A A A
? ? ?

? ?? ?= + ? ?
? ?? ?

? ? ?  (6.9) 

 



 CAP. 6 – MÉTODO MULTIGRID 89 

 

 

 
( )

, ,
 de 

I NB P nb
P I nb P I

A A
? ?

? ?? ?= ? ?
? ?? ?

? ?  (6.10) 

 

 { }I P
P I

b
?

= ? R  (6.11) 

 

 A solução do sistema de equações representado pela Eq. (6.8) fornecerá as correções 

que serão somadas à solução da malha refinada e que irão satisfazer a condição desejada e 

estabelecida na Eq. (6.2). A construção dos coeficientes das Eqs. (6.9) e (6.10) requer um 

procedimento computacional bastante simplificado mesmo para malhas não-estruturadas, uma 

vez que consiste em apenas somar coeficientes da malha refinada. O leitor poderá ver a forma 

final dessas equações aplicadas a um exemplo prático em Maliska (2004), onde, através de 

um problema cartesiano bidimensional, poder-se-á compreender melhor o princípio de 

formação dos coeficientes das malhas grosseiras apresentado aqui. 

 Esse procedimento de obtenção das equações das malhas grosseiras tem um 

embasamento físico importante. Elias (1993) demonstra que isso é equivalente a forçar a 

conservação dos fluxos nas interfaces das células grosseiras, o que é uma característica 

desejável, uma vez que o Método de Volumes Finitos é embasado nos princípios de 

conservação. Essa é a razão porque Raw (1996) adverte que todas as equações da malha fina 

devem estar em sua forma conservativa quando se emprega o ACM. É importante destacar, no 

entanto, que o procedimento descrito nesta seção não é equivalente a discretizar as equações 

nas malhas grosseiras, que é o que se queria evitar para não precisar lidar com stencils fixos.  

 

Considerações sobre o Solver Utilizado na Malha Grosseira. Normalmente não se 

deseja obter uma solução muito precisa nas malhas grosseiras, uma vez que se necessita 

apenas de valores utilizados como correção. Por isso os solvers iterativos utilizados no 

multigrid são freqüentemente denominados de métodos de relaxação ou suavização 

(smoothing methods) (TROTTENBERG et al., 2001), e serão denominados doravante neste 

texto de solver-base. Assim, a precisão do solver não é a característica mais importante e 

desejada nesta tarefa, e sim a rapidez com que ele itera, o que não recomenda o uso direto da 

maioria dos métodos conhecidos na literatura como não-estacionários: GMRES, Gradiente 

Conjugado, Orthomin etc.  



90 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 Os métodos estacionários ou ponto a ponto, como Jacobi e Gauss-Seidel, têm sido 

bastante utilizados como solver-base do multigrid por serem rápidos e de simples 

implementação (PHILIPS e SCHMIDT, 1984; ELIAS, 1993; WANG et al., 1995).  

Os métodos baseados na fatoração incompleta LU (Lower/Upper Triangular 

Decomposition) também têm sido utilizados como solver-base do multigrid e, em muitas 

vezes, com melhores resultados que os métodos de relaxação tradicionais (RAW, 1996; 

BASTIAN e HELMIG, 1999). A idéia básica desses métodos é encontrar uma matriz de 

coeficientes aproximada, construída de tal forma que o processo de solução torne-se rápido, 

permitindo trabalhar com os não-zeros e resolvendo iterativamente o sistema linear resultante 

(MALISKA, 2004). Normalmente esta fatoração tem sido utilizada para determinar a matriz 

pré-condicionadora de métodos não-estacionários (MARCONDES, 1996), mas também 

contribui para a implementação de métodos de relaxação com resultados bastante 

satisfatórios. Por não precisar determinar com precisão as matrizes [L] e [U], que é o processo 

mais custoso no solver direto LU, uma solução inexata para o sistema linear pode ser 

rapidamente obtida. 

O processo de construção das matrizes [L] e [U] incompletas é praticamente idêntico 

ao do método LU tradicional, a menos do fato de que apenas os valores não-nulos na matriz 

original são modificados. Esta é uma característica importante porque este procedimento, 

denominado de fatoração ILU(0), não altera o formato de armazenamento da matriz de dados, 

e portanto, não demanda reformatação da matriz esparsa2 (SAAD, 2000). Obtidas as matrizes 

[L] e [U] incompletas, inicia-se o processo iterativo, determinando-se uma correção nas 

variáveis com o método de decomposição LU e atualizando-as, até atingir a norma do resíduo 

escolhido. Este procedimento está apresentado com mais detalhes no Anexo 5, e é bastante 

distinto do empregado nos métodos diretos (solver LU tradicional, por exemplo). Na 

realidade, um solver direto não exerce a função desejada no multigrid se for utilizado para 

obter a solução de todas as malhas porque, além de ser demasiadamente demorado na 

obtenção das soluções com malhas mais finas, ele não aproveita as correções obtidas das 

soluções de malhas mais grosseiras como estimativa inicial, uma vez que os métodos diretos 

não são iterativos. 

O ILU(0) pode ser uma boa opção para atuar como solver-base do multigrid porque 

possui uma taxa de convergência bastante alta devido a atualização de todas as incógnitas em 

                                                 
2 Outros métodos de fatoração incompleta que diminuem a quantidade de valores não-nulos desprezados também 
são relatados na literatura, como ILU(1), ILU(2) etc., mas que aumentam a quantidade de memória utilizada e o 
trabalho na realização da fatoração. 



 CAP. 6 – MÉTODO MULTIGRID 91 

 

 

uma mesma iteração. Essa característica, também conhecida como fortemente implícita,  é 

destacável porque é sempre difícil estimar previamente e com maior precisão o número de 

iterações do Gauss-Seidel em cada malha grosseira necessário para acelerar a convergência do 

multigrid, embora cada iteração do Gauss-Seidel seja mais rápida que a do ILU(0). Foi 

verificado que em malhas com poucos nós, por exemplo, a quantidade utilizada normalmente 

é superestimada, enquanto que para malhas bastante refinadas esta quantidade é insuficiente, 

divergindo a solução. Os resultados preliminares obtidos neste trabalho demonstram que o 

solver ILU(0), por não ser ponto a ponto, apresenta uma menor dependência do número de 

iterações com o tamanho da malha. Além de conferir uma maior implicitude ao método, este 

solver também é bastante adequado na solução de problemas anisotrópicos, tornando-se um 

solver TDMA (Tridiagonal Matrix Solver) no caso limite de coeficientes muito grandes em 

apenas uma direção (RAW, 1996). 

 Neste trabalho optou-se por obter a solução da malha mais grosseira que tiver poucas 

variáveis, normalmente menos que 50, de forma exata através do solver direto (LU), também 

descrito no Anexo 5, enquanto que, para as demais malhas, utilizar-se-á o solver iterativo 

ILU(0) ou o Gauss-Seidel, que serão objetos de comparação no Cap. 8. 

 

6.2.3. Transferência de Informação da Malha Refinada para a Grosseira 

 

Esta etapa do multigrid é usualmente denominada de esquema de restrição ou 

interpolação (BRIGGS et al., 2000; TROTTENBERG et al., 2001). Mas ao contrário do que 

vale para a maioria dos métodos multigrid tradicionais, elas não se aplicam muito bem no 

método multigrid utilizado. A razão é que no ACM não é realizada nenhuma transferência de 

informação de variáveis primárias das malhas refinadas para as grosseiras. Em vez disso, 

como demonstrado na seção anterior, são passados apenas os valores dos coeficientes e dos 

resíduos das equações da malha refinada para serem somados em cada célula, em um processo 

de transferência de dados computacionalmente bastante simplificado. 

 

 

6.3. Tipos de Ciclos Multigrid 
  

 Normalmente a utilização de duas malhas apenas – uma refinada e outra grosseira – 

não é suficiente para acelerar a convergência da solução, pois podem existir ainda outros erros 



92 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

de baixa freqüência3 que não estão sendo eliminados na malha grosseira utilizada. Assim, é 

comum empregar diversas malhas grosseiras de tal forma que possam ser eliminados a maior 

parte dos diferentes modos de freqüência dos erros. A ordem como essas diferentes malhas 

são resolvidas define um “ciclo” do multigrid, que pode ser do tipo flexível ou fixo. 

Os ciclos flexíveis caracterizam-se por sempre iterar o solver-base depois dos 

procedimentos de restrição e prolongação. Em função da taxa de convergência obtida, o 

algoritmo arbitra entre: passar para uma malha mais grosseira, ficar iterando no nível atual, ou 

retornar para uma malha mais refinada. O número de “varridas” do solver é, portanto, variável 

em cada malha. A principal dificuldade associada ao uso deste tipo de ciclo é o 

estabelecimento de critérios adequados e gerais para a tomada de decisão quanto à 

necessidade de mudança de malha.  

Os ciclos fixos, por sua vez, são construídos definindo-se previamente a seqüência das 

diferentes malhas utilizadas e o número de “varridas” do solver em cada uma delas. Os ciclos 

fixos mais utilizados são os ciclos V, W e F, e que são ilustrados na Fig. 6.3 para diferentes 

níveis (quantidade de malhas utilizadas). Note que os três ciclos são idênticos para os casos 

em que se têm apenas dois níveis. Com três níveis os ciclos W e F ainda são idênticos, 

enquanto que para os demais casos os três ciclos são completamente distintos. As 

configurações de cada ciclo para quantidades de níveis maiores que as apresentadas na Fig. 

6.3 podem ser obtidas seguindo-se a mesma regra de formação mostrada. 

No ciclo V o esforço computacional é despendido na mesma proporção para resolver o 

sistema linear em cada uma das diferentes malhas, enquanto que nos ciclos W e F a maior 

parte do trabalho é dedicada nas malhas grosseiras. Como as soluções das malhas grosseiras 

são obtidas mais rapidamente, o multigrid que utiliza os ciclos W e F tem demonstrado ser 

mais rápido do que o multigrid que utiliza o ciclo V (ELIAS, 1993; RAW, 1996). 

Independentemente do ciclo adotado, no entanto, normalmente é utilizado um solver direto 

para obter a solução na malha mais grosseira (destacada com um quadrado na Fig. 6.3), uma 

vez que o sistema linear desta malha é bem menor. 

 

 

                                                 
3 Como já foi comentado no Cap. 2, durante um processo iterativo o erro embutido em uma solução pode ser 
decomposto em modos de alta e baixa freqüências. Em uma dada malha, apenas os erros com comprimento de 
onda equivalente às dimensões de seus volumes de controle são reduzidos eficientemente com os métodos 
iterativos ponto a ponto. Os erros de menor freqüência geralmente causam estagnação do solver. 



 CAP. 6 – MÉTODO MULTIGRID 93 

 

 

 
 

Fig. 6.3 - Ciclos multigrid com diferentes números de níveis (quantidade de malhas), onde n indica o número do 

nível 

 

 

Portanto, resumindo a Fig. 6.3, pode-se dizer que cada vez que o nível aumenta, isto é, 

quando o valor de n é incrementado, tem-se a operação de restrição ou transferência de 

informação da malha refinada para as grosseiras (seção 6.3), enquanto que cada vez que o 

nível diminui tem-se a solução das equações das malhas grosseiras (seção 6.2) seguido da 

operação de prolongação ou transferência de informação das malhas grosseiras para a refinada 

(seção 6.1).  

 

 

6.4. Formação da Malha Grosseira 
  

 A eficiência do método multigrid depende decisivamente da forma como os volumes 

de controle são aglomerados para a formação das malhas grosseiras. Como um mesmo valor 

de correção é aplicado a todos os componentes de uma célula da malha grosseira, o ideal seria 

compor células grosseiras com volumes de controle que apresentassem variáveis cujos valores 

devam ser atualizados aproximadamente com correções de mesma magnitude. Isso indica que 

deveria ser evitada a inclusão, em uma mesma célula grosseira, de volumes de controle que 



94 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

venham a ter valores das incógnitas demasiadamente diferentes, como por exemplo, aqueles 

separados por falha geológica. Esse cuidado é importante porque será difícil encontrar um 

valor único de correção da pressão que seja uma boa estimativa para volumes de controle que 

estejam de um lado e de outro da falha (o primeiro pode ter um alto valor de pressão e com 

tendência de aumentar ainda mais, enquanto que o segundo pode ter um valor baixo de 

pressão e com uma menor tendência de aumentar ou até diminuir).  

Um critério baseado na análise do valor dos coeficientes pode ser um bom indicativo 

para nortear o processo de aglomeração. Se o coeficiente entre dois volumes de controle  i e j, 

por exemplo, tiver um valor muito pequeno em comparação ao coeficiente dos volumes de 

controle j e k, é muito provável que os valores esperados da função calculada em j e k sejam 

muito mais próximos entre si que os valores da função em i e j. Assim, os volumes  j e k  

seriam mais indicados para estarem presentes em uma mesma célula da malha grosseira do 

que os volumes i e j. 

Além disso, um esquema de aglomeração baseado no valor dos coeficientes pode 

contribuir para a redução das diferenças das escalas de tempo da propagação da informação 

pelo solver (ELIAS et al., 1997). Essas diferenças surgem em função da anisotropia dos 

coeficientes e geralmente causam a estagnação do solver. Por estas razões, optou-se neste 

trabalho em adotar este esquema deste tipo. 

A análise dos coeficientes baseia-se essencialmente em duas etapas. Na primeira, 

examina-se se um volume vizinho a uma célula tem condições de ser aglomerado. Se sim, na 

segunda etapa examina-se se existirá outra célula também vizinha àquele volume que tem 

melhores condições de aglomerá-lo. 

 Essas etapas podem ser matematicamente expressas através de duas regras de análise 

dos coeficientes da matriz: 

 

 Regra 1: ( ) ( ), , , ,max , max ,i P P i i h h iA A A A??  (6.12) 

 Regra 2: ( ) ( )
( ), , , ,  de 

max , max max ,i P P i P nb nb P nb P IA A A A? ?
? ?? ? ?  (6.13) 

 

onde ?  é uma constante. O valor de 1/ 2? =  funcionou bem nos problemas testados e, por 

isso, é o valor utilizado neste trabalho. Os sub-índices P, i, h e nb representam volumes de 

controle tais quais os mostrados na Fig. 6.4, definidos de tal forma que P é o índice do volume 

de controle que se deseja agrupar a uma célula I , h representa um volume de controle de 

referência dentro da célula, i é o volume vizinho de P localizado dentro da célula I, e nb 



 CAP. 6 – MÉTODO MULTIGRID 95 

 

 

representa todos os volumes de controle vizinhos a P localizados fora da célula, inclusive 

aqueles não nomeados com “nb” na figura, mas que são evidentes em função do processo de 

discretização das equações adotado.  

 

 

 

Fig. 6.4 - Volumes de controle de interesse no processo de formação da célula grosseira I 

  

 

É importante notar que os termos relacionados ao fluxo advectivo que são calculados 

por funções upwind – UDS originam coeficientes assimétricos, isto é, ,i PA  normalmente é 

muito diferente de ,P iA , criando conexões muito fortes em um sentido e muito fracas no outro. 

Mas isso não adiciona dificuldades no processo de aglomeração porque as regras 1 e 2, Eqs. 

(6.12) e (6.13), baseiam-se no maior valor destes coeficientes. 

Embora a utilização dessas regras assegure que sejam agrupados volumes de controle 

que tenham coeficientes de mesma ordem, elas não produzem uma única solução e não 

asseguram que a eficiência do solver seja maximizada. Deve-se adotar ainda outros critérios 

para evitar, por exemplo, a criação de células com razão de aspecto muito ruim (células muito 

compridas, por exemplo). Isso, além de causar anisotropia nos coeficientes das malhas 

grosseiras, também aumenta o número de conexões nas matrizes. Assim, para assegurar que 

as células formadas tenham uma boa razão de aspecto (o mais “redondo” possível), deve-se 

checar, juntamente com as duas regras, se o volume a ser aglomerado já tem dois ou mais 

vizinhos na célula. Se ele tiver, provavelmente será um bom candidato a ser aglomerado 

porque contribuirá para manter a boa razão de aspecto da célula grosseira. 

 A despeito da definição do número máximo e mínimo de volumes a serem 

aglomerados em cada célula, pode ocorrer ainda que algum volume fique isolado depois do 



96 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

processo de aglomeração. Neste caso, ele é inserido na célula grosseira que contiver o vizinho 

de maior coeficiente. 

 Este algoritmo é utilizado recursivamente para formar todos os níveis de malha. O 

último nível será aquele que tiver um número de células menor que um valor definido pelo 

usuário (50, neste trabalho).  

 

Informações Adicionais sobre a Aglomeração no EbFVM. É importante observar 

que, devido à escolha das funções de forma na discretização espacial das equações 

diferenciais no EbFVM, o esquema de aglomeração adotado poderá reunir em uma mesma 

célula volumes de controle que, efetivamente, não são vizinhos. Esta situação está 

representada na Fig. 6.5, onde percebe-se que a malha grosseira formada por três células, Fig. 

6.5c, possui duas delas, Células 1 e 2, compostas cada uma por duas partes. Cada uma destas 

partes corresponde a volumes de controle que possuem uma “conexão”, isto é, um coeficiente 

entre a célula e o não-vizinho forte o suficiente para justificar a opção de incluí-lo na célula, 

de acordo com as regras de aglomeração apresentadas na seção anterior. Normalmente este 

coeficiente é denominado de coeficiente cruzado. 

 

 

 
 

Fig. 6.5 - Ilustração do processo de formação das malhas grosseiras destacando a possibilidade da presença de 

volumes “não-vizinhos” nas células 



 CAP. 6 – MÉTODO MULTIGRID 97 

 

 

Portanto, o conceito tradicional utilizado em malhas estruturadas de que “volumes de 

controle vizinhos” devem necessariamente compartilhar uma interface comum de passagem 

do fluido, e em conseqüência terem um coeficiente de conexão na matriz, não se aplica no 

EbFVM, onde dois volumes serão considerados vizinhos bastando que exista um coeficiente 

não-nulo entre eles na matriz dos coeficientes, independentemente de sua disposição espacial. 

 

   

6.5. Implementação Computacional do Multigrid 
 

 O solver multigrid foi implementado em C++ utilizando os conceitos de programação 

orientada a objetos, polimorfismo, templates etc. (JOSUTTIS, 1999; STROUSTRUP, 2000). 

Embora se reconheça que este estilo de programação acaba não sendo mais eficiente que a 

programação estruturada tradicional, a sua escolha se justifica, pois o aplicativo criado torna-

se mais facilmente legível, com grande potencial de manutenção e reaproveitamento.  

 A idéia central da implementação é tornar cada um dos níveis de malha um objeto 

composto de matrizes, vetores e escalares. Assim, cada nível terá a sua própria matriz de 

coeficientes (no formato comprimido), seu vetor de termos independentes e vetor solução. 

Um outro vetor muito importante, e que deve estar presente em cada um destes objetos, é o 

vetor coarse. Ele é o resultado do processo de aglomeração e é fundamental na construção da 

matriz de coeficientes do nível grosseiro mais imediato. Este vetor relaciona cada volume de 

controle à célula em que está contido. A Fig. 6.6 ilustra o papel desempenhado pelo vetor 

coarse, apresentando a disposição e numeração dos nós de uma determinada malha e as 

células grosseiras formadas. 

O solver multigrid foi desenvolvido de uma forma geral para resolver também 

sistemas de blocos, isto é, aqueles em que cada termo da matriz de coeficientes é uma sub-

matriz. Nestes casos, cada um dos sistemas lineares dos níveis grosseiros também é composto 

por matrizes de blocos, e seu processo de formação segue as mesmas premissas aplicadas aos 

sistemas sem blocos (Seção 6.4). Deve-se, no entanto, definir qual será o parâmetro utilizado 

no exame do volume de controle que tem a conexão “mais forte” e que, portanto, deverá fazer 

parte de um mesmo bloco na malha grosseira. A Eq. (6.14) ilustra os diferentes coeficientes 

presentes em cada sub-matriz que podem ser combinados a fim de produzir um número 

representativo das conexões fortes. Este é o formato do sistema linear com matriz de blocos 

quando a solução das equações é totalmente implícita. 



98 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

        

Fig. 6.6 - Ilustração da informação armazenada no vetor coarse 

  

 

 

1 1 1 1

1 1 1 1

1 1

1 1

1 1

1 1

n n n n

n n n n

T T T T

w n wn

w w w w

w n wn

T T T T

w n wn

w w w w

w n wn

R R R R
p s p s

R R R R
p s p s

R R R R
p s p s

R R R R
p s p s

? ? ? ?? ?? ? ? ?
? ?? ? ? ?? ? ? ?? ?? ? ? ?
? ? ? ? ?? ? ? ?? ? ? ? ?
? ? ? ? ?? ? ? ?? ? ? ?
?
?
? ? ? ? ?? ? ? ?
?? ? ? ?? ? ? ??? ? ? ?
?? ? ? ?? ? ? ??? ? ? ??? ? ? ?? ? ? ?? ? ? ?? ?

…
1

1

1

1

n

n

T

ww

n T

wn w

Rp
Rs

p R
s R

? ? ?? ?? ? ? ? ?? ?? ? ?? ?? ?? ??? ? ?? ?? ? ? ?? ?
? ? ? ?? = ?? ? ? ??
? ? ? ?? ?? ? ? ?? ?? ? ? ?? ? ? ? ?? ? ? ??? ? ?? ? ? ?? ?? ??
?
?

 (6.14) 

 

Neste trabalho, optou-se, no processo de aglomeração, por analisar simplesmente a 

magnitude do coeficiente da equação da pressão que multiplica p? , isto é, o valor de /T pR ??  

em cada bloco. Esta escolha foi pautada no fato de que a equação da pressão é a equação que 

expressa a conservação global, e por isso é mais representativa do que a equação da 



 CAP. 6 – MÉTODO MULTIGRID 99 

 

 

conservação da água. Já a escolha do coeficiente que multiplica p?  nesta equação deve-se à 

presença direta da pressão no termo de fluxo e não da saturação, que está presente diretamente 

apenas no termo transiente das equações de conservação. 

O armazenamento computacional do sistema linear de blocos é feito de uma forma 

parecida com o armazenamento dos sistemas sem blocos. A diferença é que os vetores de 

linhas e colunas  passam a referenciar os blocos, e cada coeficiente presente nos blocos são 

armazenados em vetores de (1x4) como ilustra a Fig. 6.7. Essa é uma forma geral que permite 

utilizar a mesma estrutura do multigrid independentemente da forma do sistema linear.  

 

 

 

Fig. 6.7 - Ilustração do armazenamento de matrizes de blocos no multigrid 

 
 

O esquema de armazenamento de sistemas de blocos apresentado na Fig. 6.7 é 

imprescindível para tornar geral o processo de formação dos diversos níveis e facilitar a 

implementação das operações de determinação das malhas grosseiras e de suas matrizes de 

coeficientes. Porém, para que fosse possível a solução dos sistemas lineares de cada nível 

utilizando esta estrutura de dados, foi necessário adaptar as rotinas dos solvers-base Gauss-

Seidel e ILU(0) para a resolução de sistemas de blocos. Os testes preliminares mostraram que 

os solvers-base tornaram-se demasiadamente lentos com esta adaptação, em relação à sua 

implementação padrão de solução de sistemas lineares com matrizes no formato de linha 

comprimida (Compressed Sparse Row). Suspeita-se que isto seja em razão da quantidade 



100 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

enorme de operadores lógicos do tipo if-else, laços do tipo for-end que são necessários para as 

varridas dentro dos blocos da matriz de coeficientes. 

 A solução encontrada foi criar, a partir da matriz de blocos da Fig. 6.7, um segundo 

armazenamento do sistema linear para cada nível no formato de linha comprimida (Fig. 5.3), 

que não identifica mais os blocos. Como isso é feito apenas uma vez no início da solução do 

multigrid (imediatamente após a definição dos sistemas lineares de cada nível grosseiro), o 

tempo despendido neste processo é compensado pela rapidez conseguida pelo solver, que é 

chamado inúmeras vezes nos diferentes níveis de malhas grosseiras. 

 Detalhes adicionais sobre a implementação do solver multigrid podem ser obtidos nos 

fluxogramas apresentados no Anexo 6, que resumem todas as rotinas empregadas. 



101 

Cap.    

7 
AASS  ““TTRRAANNSSMMIISSSSIIBBIILLIIDDAADDEESS””    
NNEEGGAATTIIVVAASS  EEMM  MMAALLHHAASS  TTRRIIAANNGGUULLAARREESS    

 

 
O objetivo deste capítulo é estudar e esclarecer o problema do aparecimento de 

transmissibilidades negativas (FUNG et al., 1993; SONIER et al., 1993), que ocorre quando 

determinados tipos de elementos triangulares são utilizados. Esse é um assunto pertinente, 

porque advoga-se que deve ser evitado o uso de malhas que resultem na criação destes 

termos. Para este estudo, inicialmente são revisados alguns conceitos importantes relativos às 

transmissibilidades, sendo na seqüência estudada a sua aplicação em malhas que utilizam 

triângulos.  

 

 

7.1. A Origem do Conceito de Transmissibilidade 
 

O termo transmissibilidade tem sido utilizado exaustivamente na indústria do petróleo 

e teve sua origem na utilização de malhas estruturadas ortogonais, onde o cálculo do fluxo é 

realizado a partir da informação armazenada em dois pontos (MALISKA et al., 2001; 

CORDAZZO et al., 2002). Mesmo no caso de malhas estruturadas não-ortogonais, como o 

caso mostrado na Fig. 7.1, quando o fluxo não pode ser calculado corretamente a partir de 

dois valores nodais apenas, o conceito de transmissibilidade continua sendo utilizado, pois os 

fluxos transversais são desprezados por serem pequenos em relação ao fluxo na direção 

principal.  

 

 

Fig. 7.1 - Volumes de controles de uma malha não–ortogonal destacando os dois pontos utilizados no cálculo do 

fluxo 



102 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

No conceito tradicional do cálculo do fluxo a partir de dois pontos, a vazão 

volumétrica de um componente entre dois volumes adjacentes j e k em uma solução discreta 

das equações de transporte é dado por  

 

( ) ( )
1

mN
jk

jk m k jjk m
m jk

S
q k p p

d
?

=

= ??  (7.1) 

 

onde m?  é a mobilidade da fase m, Nm é o número de fases, k é a permeabilidade absoluta, Sjk 

uma área de passagem do fluxo, djk uma distância adequada para o cálculo do gradiente na 

face e p é a pressão. Nesta expressão as grandezas que são dependentes da geometria e do 

meio podem ser agrupadas na forma 

 

 ( ) ( )
1

mN

jk jk m k jjk m
m

q T p p?
=

= ??  (7.2)  

 

onde Tjk é denominada de transmissibilidade que, portanto, é assim definida  

    

jk
jkjk

jk

S
T k

d
=  (7.3)  

 

As transmissibilidades são calculadas apenas no início da simulação, não tendo seus 

valores alterados ao longo do tempo quando a malha é fixa e a permeabilidade absoluta é 

constante, que é a situação mais comum. A sua utilização prática na engenharia de petróleo é 

muito conveniente porque as falhas geológicas, citando apenas um exemplo, podem ser 

facilmente modeladas alterando-se os valores das transmissibilidades. Em um caso extremo 

de falha selante localizada na face que separa dois blocos, a transmissibilidade entre eles é 

tomada como zero. O mesmo conceito é empregado em outras áreas da engenharia, como o de 

condutância em transferência de calor, por exemplo. 

 

 

 

 



 CAP.  7 – AS “TRANSMISSIBILIDADES” NEGATIVAS EM MALHAS TRIANGULARES 103 

 

 

7.2. A Transmissibilidade em Malhas Triangulares 
 

 Como visto, o conceito de transmissibilidade surgiu com a utilização do cálculo do 

fluxo em uma determinada face a partir dos dados relativos a apenas dois pontos. Uma 

questão consiste, portanto, em verificar se esta definição é apropriada quando são utilizados 

elementos triangulares. A estratégia para obter a resposta deve ser a mesma utilizada para a 

definição tradicional da transmissibilidade apresentada na seção anterior, isto é, analisar a 

expressão discretizada do fluxo entre os volumes de controle. 

 

 

 

Fig. 7.2 - Elemento triangular composto por três sub-volumes de controle (Svc) 

 

 

Embora o método EbFVM tenha sido deduzido no Cap. 5 de uma forma aplicável para 

elementos triangulares e quadrangulares, as equações para elementos triangulares podem ser 

deduzidas de um modo um pouco diferente, valendo-se do fato de que são utilizadas funções 

de forma lineares nestes elementos. No Anexo 7 é mostrada esta dedução alternativa, mais 

apropriada para a discussão das questões neste capítulo. Pode-se mostrar, por exemplo, que o 

fluxo volumétrico na face que separa os sub-volumes de controle 1 e 2 da Fig. 7.2 é dado por 

 

( ) ( )2 1 3 112 12 12 13AB ABp p p pq ? ? ?? ?? ?= +? ?  (7.4)  

 

sendo este o fluxo que atravessa o segmento AB desta figura. O fluxo que passa pelo 

segmento BC, por sua vez, é dado por 



104 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

( ) ( )3 1 2 113 13 13 12BC BCp p p pq ? ? ?? ?? ?= +? ?  (7.5)  

 

onde 12?  é a mobilidade da superfície AB que separa os volumes 1 e 2, e assim por diante. 

Quanto aos termos ?  destas equações, os sub-índices 12 e 13 indicam que se tratam de 

coeficientes que multiplicam as parcelas (p2 – p1) e (p3 – p1), respectivamente, enquanto que 

os super-índices AB e BC indicam que o termo teve origem no cálculo do fluxo nas interfaces 

dos sub-volumes “1 e 2” e “1 e 3”, respectivamente. 

Nota-se que os fluxos que estão cruzando as faces AB e BC não podem mais ser 

calculados exatamente utilizando-se apenas dois pontos, como é possível com malhas 

estruturadas ortogonais, pois na modelagem mais simples com elementos triangulares utiliza-

se uma função de forma que envolve os valores dos três nós, definindo portanto um único 

plano dentro do qual a pressão só pode variar linearmente1. Analisando-se a ordem de 

grandeza dos termos da Eq. (7.4) pode-se verificar que, de uma forma geral, o coeficiente 12
AB?  

não é excessivamente maior que o outro coeficiente ( 13
AB? ), de modo que este último pudesse 

ser omitido, resultando em uma expressão do fluxo calculado apenas por dois pontos. Ou seja, 

não é uma questão de não-ortogonalidade da malha que, quando a ortogonalidade é pequena, 

despreza-se a parcela do fluxo devido a não ortogonalidade e então pode-se definir a 

transmissibilidade, pois apenas dois pontos passam a fazer parte no cálculo do fluxo. 

Somando-se as Eqs. (7.4) e (7.5), tem-se para o fluxo total no sub-volume de controle 

1 uma expressão muito parecida com a obtida em malhas estruturadas, 

  

( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  (7.6)           

 

onde 

13 12 13 13 13
AB BC? ? ? ?? = +  (7.7)  

12 12 12 13 12
AB BC? ? ? ?? = +  (7.8)  

  

 

                                                 
1 A utilização de funções de forma lineares, como as utilizadas nesta dedução, é o procedimento usual em se 
tratando de malhas triangulares (HUGHES, 1987). A utilização de funções de forma mais complexas 
(quadráticas, cúbicas etc.) foge ao escopo deste trabalho. 



 CAP.  7 – AS “TRANSMISSIBILIDADES” NEGATIVAS EM MALHAS TRIANGULARES 105 

 

 

Comparando-se as Eqs. (7.4) e (7.5) com (7.6), tem-se para os fluxos que cruzam cada 

interface da Fig. 7.2 uma interpretação bastante distinta daquela obtida em malhas 

estruturadas: 
 

 

 
 

                     
 

pois 13?  e 12?  não são parcelas relacionadas apenas aos segmentos AB e BC, 

respectivamente. O fluxo que passa pelo segmento AB é dado pela Eq. (7.4) e o fluxo que 

passa pelo segmento BC é dado pela Eq. (7.5). Portanto, inspecionando-se as Eqs. (7.2) e (7.3)

que definem as transmissibilidades, chega-se a uma segunda conclusão importante: 

 

13?          e          12?  
 

 

 
 

Por isso, usou-se o símbolo jk?  nesta expressão, e não jkT  como na literatura. 

Logo, não é mais possível identificar a transmissibilidade em malhas triangulares e, 

por isso, não há nenhuma razão física que impeça que os coeficientes da Eq. (7.6) sejam 

negativos, contrariamente ao que é mencionado em alguns trabalhos da literatura de 

simulação de reservatórios. Esta conclusão independe do número de fases do problema, pois 

mesmo no caso monofásico, quando a mobilidade é igual à unidade nas Eqs. (7.4) e (7.5), 

para que o fluxo seja corretamente calculado é preciso usar três pontos.  

NÃO é o 
fluxo que 
passa pelo 
segmento 

AB ! 

NÃO é o 
fluxo que 
passa pelo 
segmento 

BC ! 

NÃO SÃO 
TRANSMISSIBILIDADES ! 

( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  



106 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

É importante mencionar também que a expressão utilizada em outros trabalhos 

(FUNG et al., 1991) 

 

4
xx i j xy j i yx j i yy i j

ij

k bb k a b k b a k a a
A

+ + +? ?
? = ?? ?

? ?
 (7.9) 

 

só é aplicável em escoamentos monofásicos e com propriedades constantes, isto é, quando as 

mobilidades nas Eqs. (7.7) e (7.8) são idênticas. 

 No próximo capítulo é mostrado, a partir de um exemplo prático, que o coeficiente 

negativo que surge em função da presença de ângulos maiores que 90º tem embasamento 

físico. 



107 

Cap.    

8 RREESSUULLTTAADDOOSS  EE  CCOOMMPPAARRAAÇÇÕÕEESS  
 

 

 

 

Neste capítulo são apresentados os resultados de problemas-teste obtidos a partir da 

formulação desenvolvida nesta tese. Em alguns casos consideram-se reservatórios de 

dimensões físicas bem próximas daquelas verificadas nos trabalhos práticos da engenharia de 

petróleo, enquanto que em outros casos, por comodidade e para facilitar comparações, 

utilizam-se reservatórios de petróleo de dimensões mais reduzidas, mas preservando as 

principais características encontradas nos casos reais.  

As condições de contorno utilizadas na maioria dos problemas resumem-se em 

fronteira impermeável. Dois tipos de poços são considerados: injetores de água e produtores 

de óleo e água, simulando um processo de recuperação secundária, normalmente utilizado nos 

trabalhos de campo para aumentar a recuperação de petróleo. A fim de facilitar a reprodução 

por outros pesquisadores dos casos rodados, os dados utilizados são apresentados ao longo do 

texto ou em tabelas específicas. 

Este capítulo foi dividido em quatro partes distintas:  

 

(1)  Validação numérica da formulação apresentada (seção 8.1);  

(2) Apresentação e interpretação dos resultados do EbFVM e comparação com 

softwares comerciais (seções 8.2 a 8.6);  

(3) Análise do desempenho do solver multigrid em problemas de simulação de 

reservatórios de petróleo (seção 8.7); e  

(4) Simulação de um caso prático que reúne grande parte dos aspectos investigados 

e/ou propostos nesta tese (seção 8.8), a fim de mostrar as suas potencialidades. 



108 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

8.1. Validação Numérica 
 

O modelo numérico EbFVM desenvolvido será validado comparando seus resultados 

com uma solução de referência. Para tanto, foi escolhido o problema unidimensional de 

escoamento bifásico em meios porosos, incompressível, com propriedades constantes, com 

injeção constante de água, sem pressão capilar e regido pela equação de Buckley-Leverett 

 

0w wT
s f

u
t x

?
? ?

+ =
? ?

 (8.1) 

 

que é a versão unidimensional da Eq. (4.1) escrita de forma a explicitar o fluxo fracionário, 

wf , definido como 

 

w
w

T

f
?
?

=  (8.2) 

 

A condição inicial do problema em questão é ( , 0)w wis x s=  para 0 x L? ? , onde wis  é 

a saturação de água irredutível e L é a dimensão na direção axial. As condições de contorno 

são fluxos prescritos: (0, )w injq t q=  e ( , )T injq L t q= ?  para 0t &gt; . 

Por generalidade, as variáveis de interesse deste problema serão adimensionalizadas 

ou normalizadas, de acordo com o caso. A coordenada axial, por exemplo, será 

adimensionalizada como 

 

/Ax x L=  (8.3) 

 

e o tempo será dado em número de volumes porosos injetados (VPI), que é a relação entre os 

volumes de fluido injetado e o poroso disponível para este fluido escoar, dado por 

 

( )1
inj T

A
wi or

q t u t
t

s s AL L?
= =

? ?
 (8.4) 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 109 

 

 

onde ors  é a saturação de óleo residual e Tu  é a velocidade total (soma das velocidades do 

óleo e da água). A saturação da água será normalizada como 

 

1
w wi

wi or

s s
s

s s
?

=
? ?

 (8.5) 

 

 As curvas de permeabilidade relativa serão definidas pela correlação de Corey 

 

( )1
w

o

nmax
rw rw

nmax
ro ro

k k s

k k s

? =?
?

= ???
 (8.6) 

 

onde maxrok  e 
max
rwk  são os valores máximos das curvas de permeabilidades relativas adotadas e 

correspondem às saturações wis  e 1w ors s= ? , respectivamente, como descrito no Cap. 3 (Fig. 

3.1). Na forma adimensionalizada, esses limites são 0s =  e 1s = . Os valores utilizados para 

as permeabilidades relativas limites neste problema são 1max maxrw rok k= = . 

 Nesta seção serão comparados os resultados numéricos com a solução analítica da 

equação de Buckley-Leverett empregando diferentes configurações de curvas de 

permeabilidade relativa e razões de mobilidades das fases1. Diferentes curvas de 

permeabilidade relativa serão obtidas variando-se o valor dos expoentes nw e no da correlação 

de Corey. Curvas lineares correspondem a nw e no iguais a unidade, como apresentado na Fig. 

8.1a e Fig. 8.1b, enquanto que curvas quadráticas serão obtidas quando nw = no = 2.0 (Fig. 

8.1c).  

  

                                                 
1 A razão de mobilidades M é definida como a razão entre as mobilidades da água e do óleo avaliadas na 
saturação de água sw = (1 – soi) e sw = swi , respectivamente (DAKE, 2001). Neste trabalho, contudo, considerar-
se-á em todos os casos analisados que as permeabilidades relativas limites são iguais a unidade ( 1max maxrw rok k= = ), 
o que permite expressar a razão de mobilidades como uma razão de viscosidades /o wM µ µ= . 
 



110 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

         
         (a)  M = 1 e curva de permeabilidades                                  (b) M = 2 e curva de permeabilidades  

            relativas lineares                relativas lineares        

 
(c) M = 2 e curva de permeabilidades 

                                                                      relativas quadráticas 
 

Fig. 8.1 – Curvas de permeabilidades relativas das fases água e óleo (krw e kro)  e de fluxo fracionário da fase 

água ( fw) utilizadas nas simulações 

 

 

As razões de mobilidades consideradas são M = 1 e 2. A posição e a forma da frente 

de saturação dependem fortemente de M, porque o fluxo fracionário pode ser expresso em 

função da razão de mobilidades, 

 

rw
w

ro
rw

k
f

k
k

M

=
+

 (8.7) 

 

A Fig. 8.1 apresenta, sobrepostas às curvas de permeabilidade relativa, as curvas de fw x sw 

que serão usadas nos testes. 

A solução numérica do EbFVM foi obtida com o método IMPES, usando-se malhas 

igualmente espaçadas formadas por uma fileira horizontal de elementos quadriláteros. A 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 111 

 

 

estabilidade numérica foi assegurada utilizando passos de tempo que resultassem em Números 

de Courant (CFL - Courant-Freidrichs-Levy ) iguais a unidade. Este número adimensional é 

definido como 

 

T
t

CFL u
x

?
=

?
 (8.8) 

 

 Ao se comparar as Eqs. (8.8) e (8.4) percebe-se que, para problemas incompressíveis 

resolvidos explicitamente, que é o caso aqui tratado, a condição de estabilidade de Courant-

Freidrichs-Levy (CFL = 1) pode ser entendida como a necessidade de garantir, em cada passo 

de tempo, a passagem de, no máximo, um volume poroso de fluido em cada volume de 

controle. 

Embora as malhas utilizadas sejam igualmente espaçadas, os volumes de controle 

resultantes não serão uniformes em razão da existência de dois volumes de controle que tem a 

metade da dimensão dos demais: um no início e outro no final da malha. Por isso foram 

empregados passos de tempo que asseguram CFL = 1 naqueles volumes, o que resultou em 

valores mais conservadores do passo de tempo para a maioria dos volumes de controle. 

A solução analítica da equação de Buckley-Leverett foi obtida seguindo os 

procedimentos clássicos apresentados na literatura (GREENKORN, 1983; LAKE, 1989; entre 

outros). 

Os resultados numéricos obtidos com o EbFVM para malhas com 20, 100 e 1000 

elementos são apresentados na Fig. 8.2 para um tempo de simulação tA =  0.5 VPI. Como se 

pode notar, os resultados numéricos conseguem reproduzir o comportamento da frente de 

saturação independentemente se o perfil é do tipo pistão (Fig. 8.2a), se tem a frente suavizada 

(Fig. 8.2b) ou se é um pulso de água sendo advectado com uma região suavizada atrás do 

mesmo (Fig. 8.2c). É importante notar também que o aumento da razão de mobilidades 

suavizou a frente de deslocamento (Fig. 8.2b), como se fosse introduzida uma difusão 

numérica, o que acontece quando se emprega malhas demasiadamente grosseiras para 

resolver escoamentos do tipo pistão. Neste caso, foram verificadas pequenas diferenças entre 

as malhas grosseiras e a solução analítica. Mas, o mais importante é que todos os resultados 

obtidos numericamente convergem para a solução exata à medida que a malha é refinada. 

 



112 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

                  
             (a)  M = 1 e curva de permeabilidades                       (b) M = 2 e curva de permeabilidades  

                relativas lineares                     relativas lineares        
 

 
(c) M = 2 e curva de permeabilidades 

relativas não-lineares 
 

Fig. 8.2 – Comparação entre os perfis de saturação ao longo da coordenada axial adimensionalizada para um 

tempo de simulação  tA =  0.5 VPI 

 

 

 

8.2. As “Transmissibilidades Negativas” em um Caso 
Prático 

 

Foi demonstrado no Cap. 7 que não faz mais sentido usar o termo “transmissibilidade” 

no caso de malhas não-estruturadas. Portanto, não há impedimento a que os termos 

usualmente denominados desta forma sejam negativos.  

Como exemplo, considere o reservatório de petróleo com 5 poços, sendo três 

produtores (com pressão de bloco prescrita) e dois injetores (um de água e outro de óleo) 

posicionados conforme mostra a Fig. 8.3. Não é usual injetar óleo no reservatório, contudo 

isso é realizado para gerar um escoamento que permite estudar os aspectos relevantes com 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 113 

 

 

maior facilidade, mesmo em um problema simples como este. As viscosidades da água e do 

óleo são iguais e o escoamento é incompressível. A geometria da malha e a localização dos 

poços foram definidas de maneira a produzir dentro de cada elemento um escoamento na 

direção x apenas, resultando em um caso em que as pressões dos blocos 3 e 5 são iguais. Essa 

direção do escoamento se estabelece em função da discretização realizada com funções de 

forma lineares. 

 

 

 
Fig. 8.3 – Definição geométrica do problema estudado 

 

 

O elemento triangular de interesse e que será tratado com mais atenção nesta seção é o 

elemento delimitado pelos nós 1, 2 e 3 e identificado pelo número 2, que tem um ângulo 

interno maior que 90o. Ele aparece de forma destacada na Fig. 8.4, com seus sub-volume de 

controle e seus nós com a numeração local, que neste caso é coincidente com a numeração 

global dada na Fig. 8.3. Conforme discutido no Cap. 7, é dito na literatura que este elemento 

“causaria” transmissibilidades negativas, e portanto “deveria” ser evitado. 



114 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
Fig. 8.4 – Elemento triangular 2 da malha apresentada na Fig. 8.3, destacando os sub-volumes de controle 

criados e o ângulo obtuso que originaria transmissibilidades negativas. 

 

 

 

A “transmissibilidade” negativa. A fim de mostrar a existência do termo comumente 

denominado de transmissibilidade negativa e obter as equações de forma conveniente, iniciar-

se-á a dedução do termo de fluxo para um dos volumes de controle presentes neste elemento. 

Para tanto, considere a equação do fluxo total deduzida no Cap. 7 para o sub-volume de 

controle 1, svc1, da Fig. 8.4 que tem a forma 

 

 ( ) ( )1 13 3 1 12 2 1q p p p p= ? ? + ? ?  (8.9) 

          

No problema analisado p2  = p1, o que reduz a equação a 

 

( )1 13 3 1q p p= ? ?  (8.10) 

 

Também foi visto no Cap. 7 que o fator  13? , por sua vez, é composto por duas 

parcelas, 

 

113 12 13 13 13Svc
AB BC? ? ? ?? = +  (8.11) 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 115 

 

 

onde 13
BC?  é zero devido a . 0BCV S? = , onde BCS?  é o vetor área entre os pontos B e C da  Fig. 

8.4 e é composto pelo segmento BC paralelo ao escoamento.  As expressões que determinam 

cada um dos termos da equação anterior podem ser vistas no Anexo 7. Logo, o fluxo total do 

sub-volume 1 da Fig. 8.4 será dado por 

 

( )1 12 13 3 1ABq p p? ?= ?  (8.12) 

 

 Inspecionando-se a Fig. 8.4 conclui-se que o fluxo determinado pela Eq. (8.12) é 

aquele que atravessa apenas o segmento AB, pois o segmento BC é paralelo ao escoamento, 

como mencionado. Então, na realidade, o fluido vai de svc1 para svc2, não apresentando 

nenhuma relação com svc3, como poderia estar sendo sugerido pela presença de ( )3 1p p?   
nesta expressão. A menos do trabalho de Palagi (1992) que apresentou importantes 

contribuições,  esta interpretação da correta direção dos fluxos não está devidamente discutida 

na literatura, e pode estar causando dificuldades em muitos modelos numéricos. 

Além disso, deve-se notar que, como fisicamente o fluxo está saindo do sub-volume 1 

e indo na direção de 2, ele recebe sinal negativo na equação de svc1, 

 

( )1 12 13 3 1 0ABq p p? ?= ? &amp;lt; (8.13) 

 

e como ( )3 1 0p p? &gt;  e as mobilidades são positivas, por definição, conclui-se que 

 

13 0
AB? &amp;lt; (8.14) 

 

o que fisicamente está correto, embora este termo não tenha o significado físico da 

transmissibilidade discutido no Cap. 7. Talvez a presença destes coeficientes negativos 

impliquem em alguma dificuldade de solução do sistema linear, mas, como visto, não há 

nenhum argumento físico ou numérico que justifique construir malhas que evitem seu 

aparecimento.  

Resumindo, os termos das equações denominados usualmente de transmissibilidades 

podem assumir valores negativos no caso de triângulos obtusângulos. A prática na área 

numérica, contudo, tem demonstrado que a presença de triângulos muito deformados não é 



116 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

uma boa conduta mas, como visto, a rejeição de uma malha pela simples análise do sinal 

destes termos não tem justificativa. Deve-se lembrar que o verdadeiro fator 

“transmissibilidade” utilizado tradicionalmente em malhas estruturadas será sempre um 

número positivo porque representa o produto da permeabilidade absoluta pela área, dividido 

pela distância entre os nós. 

 

 

 

8.3. Comparação entre as Soluções do Método Proposto e 
de um Simulador Comercial 

 
Nesta seção são comparadas as soluções do simulador EbFVM do pacote comercial 

STARS da CMG (STARS User’s Guide, 2002; FUNG et al., 1991) com as soluções do 

simulador EbFVM proposto. Neste trabalho, o método empregado no simulador comercial 

será denominado doravante de “EbFVM tradicional”.  

Antes de prosseguir nesta seção, deve-se destacar que implementou-se, ainda, um 

outro simulador que utiliza as mesmas equações do EbFVM tradicional, para certificar-se da 

correção do simulador comercial. Não é incomum encontrar simuladores complexos com 

equações implementadas erroneamente (MALISKA et al., 2002). Por isso, é importante ter 

um outro programa para realizar esta verificação. Nos casos rodados, não foram detectadas 

discrepâncias entre os resultados do STARS e do simulador desenvolvido. 

 

8.3.1. Impacto nos Resultados do Caso Analisado no Item 8.2 

 

Para aprofundar o entendimento das questões numéricas envolvidas na discretização 

do problema da Fig. 8.3, pode-se comparar os fluxos produzidos pelo esquema numérico 

proposto neste trabalho e pelo EbFVM tradicional. Para tanto, assume-se, que as saturações 

de água nos nós da malha da Fig. 8.4 são 

 

1
0.0ws =    2 0.0ws =    3 1.0ws =  

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 117 

 

 

 Método proposto. No método EbFVM proposto, as mobilidades são calculadas com 

valores a montante de um determinado ponto de integração, utilizando a Eq. (4.31), que é 

reproduzida aqui: 

 

( )
( )

          se            

          se   

jk j
jk

jk k
jk

0k p S

0k p S

? ?

? ?

? ?= ? ?&amp;lt;
?
?

?? = ? ? &gt;
?

 (8.15) 

 

Por isso, as mobilidades 13?  e 23?  são calculadas com a saturação do nó 3, isto é, com 

saturação igual a unidade, enquanto que a mobilidade 12?  é nula por ser calculada com 

saturação zero. Assim,  o fluxo de água em scv1 calculado na Eq. (8.12), utilizando o esquema 

de avaliação das mobilidades da Eq. (8.15), é dado por 

 

1 0wq =  (8.16) 

 

o que confere com a física do problema, pois com o escoamento dirigido da direita para a 

esquerda, conforme está definido, não poderá sair água do sub-volume 1 para o 2 se a 

saturação 
1w

s  for nula. 

  

Método EbFVM tradicional. Mas, no esquema tradicional, é importante relembrar 

que o fluxo no sub-volume 1 é dado por (FUNG et al., 1991) 

 

( ) ( )13 13 3 1 12 12 2 11q T p p T p p? ?= ? + ?  (8.17) 

 

e que, no problema estudado, em função de 2 1p p=  e 12 0? = , reduz-se a 

 

( )13 13 3 11q T p p?= ?  (8.18) 

  

 Assumindo que kx = ky = k e substituindo os valores de xi e yi do triângulo 2 definido 

na Fig. 8.3 na expressão que determina o coeficiente T13 (FUNG et al., 1991), obtém-se 

 

kT 25,013 ?=  (8.19) 



118 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

que, finalmente, substituído na Eq. (8.18), resulta em 

 

( )13 3 11 0, 25 wwq k p p?= ? ?  (8.20) 

 

Não será possível empregar a Eq. (8.15) na determinação da mobilidade no método 

EbFVM tradicional porque este método não usa informações armazenadas por elementos, 

apenas por arestas. Deve-se optar, portanto, por uma das duas maneiras de calcular a 

mobilidade  apresentadas no Cap. 4.1.5, e que serão relembradas brevemente nesta seção. 

A primeira opção é o esquema de avaliação a montante (upwind) baseado na análise 

do valor de pressão nodal dos dois volumes de controle vizinhos à face onde se deseja avaliar 

a mobilidade, 

 

                  se               

                  se               
jk j j k

jk k j k

p p
p p

? ?
? ?

= &gt;

=&amp;lt;
 (8.21) 

 

Assim, neste problema, w13?  será calculada com a saturação do nó 3, tornando o produto 

( )13 3 1wk p p? ?  não nulo e positivo, de forma que 

 

1 0wq &amp;lt; (8.22) 

 

o que significa que existe fluxo de água saindo do volume 1, cuja saturação de água é zero. 

 Esta conclusão se reveste ainda de maior importância se for adotado o conceito da 

interpretação dos fluxos aplicada à malhas estruturadas e usualmente empregada 

erroneamente para o método EbFVM tradicional que diz, por inspeção da Eq. (8.20), que essa 

massa que sai do volume 1 vai para o volume 3. Neste caso haveria um fluxo que leva massa 

de um local onde ela não existe. 

 Pode-se, no entanto, calcular o fluxo obtido pela Eq. (8.20) utilizando-se o segundo 

esquema de avaliação das mobilidades, e que usa o sinal do termo ( )kjjk ppT ?  para definir o 
valor das variáveis dependentes a montante, 

 

( )
( )

                  se               0

                  se               0

jk j jk j k

jk k jk j k

p pT

p pT

? ?

? ?

?= &gt;

?=&amp;lt;
 (8.23) 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 119 

 

 

Comparando os resultados do STARS para diferentes situações com os do simulador 

desenvolvido nesta tese que utiliza as mesmas equações, pôde-se constatar que a Eq. (8.23) é 

a opção implementada naquele software comercial. Neste caso, a mobilidade w13?  será 

calculada, em vez de utilizar a saturação do nó 3, através da saturação do nó 1, que é zero. Isto 

resulta em 
 

1 0wq =  (8.24) 

 

o que confere com a física do problema. Por inspeção da Eq. (8.20), percebe-se, porém, que 

para valores de saturação de água do nó 1 diferentes de zero, o valor de w13?  será positivo, 

resultando em um fluxo negativo, como o calculado com o esquema anterior. 

 

Conclusão. Quando um dos triângulos for obtusângulo, pode ocorrer uma inversão no 

sentido do fluxo, sendo esta a verdadeira razão da recomendação na literatura da necessidade 

de se evitar tais situações. Para ângulos menores que 90º todos os fluxos, embora possam 

estar contaminados com erros na maioria dos casos, pelo menos obedecem o sentido correto, 

garantindo com isso resultados qualitativamente corretos. A inversão do sentido do fluxo 

altera completamente a física do problema, produzindo resultados freqüentemente 

inaceitáveis. 

O impacto da utilização do esquema proposto e do tradicional para o problema 

estudado, incompressível e homogêneo, com permeabilidade absoluta k= 150 mD, 

viscosidades da água e óleo igual a 1 cp, porosidade igual a 0.2, curvas de permeabilidade 

relativas lineares2 e ?t = 0.001 d, é apresentado na Fig. 8.5. 

Nota-se que as curvas de corte de água nos poços produtores (watercut) na Fig. 8.5a, 

que foram obtidas utilizando o EbFVM tradicional com as mobilidades calculadas a partir da 

Eq. (8.21) apresentam valores negativos em um dos poços. Este mesmo método numérico, 

utilizando agora as mobilidades calculadas a partir da Eq. (8.23) não apresenta mais 

saturações negativas, como mostra a Fig. 8.5b. Na Fig. 8.5c são apresentados os resultados 

obtidos com o método EbFVM proposto e o esquema de avaliação das mobilidades da Eq. 

(8.15). Nota-se que, com exceção dos resultados da Fig. 8.5a, os demais resultados da Fig. 8.5 

                                                 
2 As curvas de permeabilidade relativa lineares são obtidas empregando-se expoentes iguais a 1 na correlação de 
Corey dada pela Eq. (8.6). 



120 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

aparentam ser coerentes, embora os resultados da Fig. 8.5b tenham apresentado produção nula 

de água no poço 1, o que não era o esperado. 

 

 

            
(a) Com avaliação das mobilidades pela Eq. (8.21)        (b)  Com avaliação das mobilidades pela Eq. (8.23) 
 

 
(c) Com avaliação das mobilidades pela Eq. (8.15) 

 

Fig. 8.5 – Curvas de corte de água nos poços produtores do reservatório da Fig. 8.3 obtidas pelos métodos 

EbFVM tradicional (FUNG et al., 1991) e EbFVM proposto neste trabalho, com diferentes esquemas de 

avaliação das mobilidades.  

 

 

8.3.2. Interpretação do Campo de Velocidades do Método EbFVM  

 

O objetivo desta seção é mostrar que mesmo a visualização de resultados obtidos com 

o método EbFVM tradicional pode ser comprometida se forem empregados os mesmos 

conceitos utilizados no processo de discretização de suas equações. Em função da utilização 

freqüente de softwares de visualização comerciais, é comum a necessidade de calcular e 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 121 

 

 

plotar velocidades médias nos elementos da malha, mesmo sabendo que seria mais lógico 

visualizar uma velocidade em cada ponto de integração, pois é aquela que foi utilizada no 

cálculo do fluxo nas equações discretizadas. Isto é indiferente para elementos triangulares e 

escoamento monofásico, porque o campo de velocidade dentro destes elementos é constante, 

assim como o gradiente de pressão, conforme descrito na seção 4.1.3. No entanto, os 

procedimentos usuais para escoamentos multifásicos podem resultar em vetores velocidade 

com direções opostas às esperadas e/ou com valores não-físicos.  

Deve-se relembrar que na utilização do método EbFVM tradicional apenas elementos 

triangulares em 2D ou tetraédricos em 3D têm sido apresentados na literatura. Por isso, 

continuar-se-á nesta seção usando apenas triângulos. No Anexo 7 é deduzida a discretização 

do gradiente de pressão para estes elementos, 

 

( )( ) ( )( )

( )( ) ( )( )
j

J
xxppxxpp

i
J

yyppyypp
p

13121213

12131312

ˆ
)det(

                

ˆ
)det(

?
?

?
?
?

? ?????
+

+?
?

?
?
?

? ?????
=?

 (8.25)   

 

onde os sub-índices referem-se à numeração local do elemento e J é a matriz Jacobiana de 

transformação (Eq. 4.19). Rearranjando termos, pode-se mostrar que esta expressão pode ser 

escrita também como  

 

( ) ( ) ( )

( ) ( ) ( )
j

J
ppyppxppx

i
J

ppyppyppy
p

321132213

231312123

ˆ
)det(

                

ˆ
)det(

?
?

?
?
?

? ?+?+?
+

+?
?

?
?
?

? ?+?+?
=?

 (8.26) 

 

que são as formas mais usuais de representar o gradiente de pressão discretizado no método 

EbFVM, e são utilizadas para determinar a velocidade de uma fase escoando em um meio 

poroso 

 

m mV k p?= ? ?  (8.27) 

 

onde, por simplicidade, o tensor permeabilidade absoluto é considerado isotrópico e 

homogêneo. 



122 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 Como, para fins de visualização, deseja-se obter uma velocidade média dentro do 

elemento, a alternativa que parece mais plausível é a que faz a média das velocidades nos três 

pontos de integração, pois são estas as utilizadas no cálculo do fluxo que originam as 

expressões discretizadas3. Assim, denominando pot m?  a média das mobilidades nos pontos 

de integração, a velocidade média do elemento é dada por 

 

( )( ) ( )( )

( )( ) ( )( )
j

J
xxppxxpp

k

i
J

yyppyypp
kV

13121213
m

12131312
mm

ˆ
)det(

                       

ˆ
)det(

?
?

?
?
?

? ?????
?

+?
?

?
?
?

? ?????
?=

?

?
 (8.28) 

 

Esta equação é bem diferente das duas possíveis expressões que surgem em função da 

utilização dos procedimentos usuais que norteiam a discretização do EbFVM tradicional 

 

( ) ( ) ( ) ( )

( ) ( ) ( ) ( )

12 13

13 12

2 1 3 1 3 1 2 1

3 1 2 1 2 1 3 1

ˆ
det( )

ˆ                
det( )

m m
m

m m

p p y y p p y y
V k i

J

p p x x p p x x
k j

J

? ?

? ?

? ? ? ? ?? ?
= ? +? ?

? ?
? ? ? ? ?? ?

? ? ?
? ?

 (8.29) 

 

ou 

 

( ) ( ) ( )

( ) ( ) ( )

12 13 23

12 13 23

3 2 1 2 1 3 1 3 2

3 1 2 2 3 1 1 2 3

ˆ
det( )

ˆ                
det( )

m m m
m

m m m

y p p y p p y p p
V k i

J

x p p x p p y p p
k j

J

? ? ?

? ? ?

? + ? + ?? ?
= ? +? ?

? ?
? + ? + ?? ?

? ? ?
? ?

 (8.30) 

 

que se valem da premissa errônea de que o fluxo pode ser calculado utilizando-se apenas dois 

valores nodais de pressão e que, por isso, pode-se multiplicar a mobilidade da fase  

diretamente pela diferença de pressões. De fato, não parece lógica esta introdução de 

                                                 
3 Quando for necessário visualizar um campo variável e contínuo de velocidades no interior do elemento deve-se 
buscar outros tipos de médias, como as propostas por Jayantha e Turner (2001), e que resultam em um valor 
médio do gradiente de pressão nos volumes de controle (nós da malha). Nesta proposta, pode-se empregar as 
funções de forma para obter o gradiente de pressão, e em conseqüência, velocidades, em qualquer posição no 
interior do elemento. 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 123 

 

 

mobilidades diferentes multiplicando as diferentes parcelas do gradiente de pressão, que é 

constante dentro do elemento triangular. No entanto, é exatamente este o procedimento 

utilizado no cálculo dos fluxos multifásicos durante o processo de obtenção das equações 

discretizadas no EbFVM tradicional (FUNG et al., 1991). 

O resultado da utilização de cada uma das expressões dadas nas Eqs. (8.28) a (8.30) 

será constatado em um problema prático. A Fig. 8.6 apresenta dois elementos triangulares que 

possuem valores nodais simétricos de pressão e mobilidades nos nós. Esses valores podem ser 

interpretados como uma estimativa inicial ou o resultado de uma simulação. Pretende-se 

visualizar do campo de velocidades originado em cada triângulo a partir destes dados. 

 

 

 
Fig. 8.6 – Elementos triangulares e seus valores nodais de pressão e mobilidade empregados no cálculo de uma 

velocidade média no elemento 

 

 

Dependendo da expressão de velocidade discretizada utilizada, pode-se obter vetores 

completamente diferentes como demonstra a Fig. 8.7. Para facilitar a visualização, estes 

vetores não estão sendo plotados no baricentro do elemento. A utilização da Eq. (8.29), apesar 

de resultar em um campo simétrico como mostra a Fig. 8.7a, apresentou componentes 

horizontais demasiadamente grandes em relação às verticais. Isso não tem suporte físico, 

considerando-se que a componente vertical do gradiente de pressão é visivelmente maior que 

a horizontal, como se pode constatar pela simples inspeção dos dados apresentados na Fig. 

8.6. A Eq. (8.30), por sua vez, resultou em um campo de velocidades que, além de não ser 

simétrico, apresentou componentes verticais com direções opostas em cada elemento (Fig. 

8.7b), o que não se justifica em função das pressões simétricas prescritas nos nós. 

 



124 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

Fig. 8.7 – Vetores velocidade determinados através das expressões: (a) Eq. (8.29), (b) Eq. (8.30) e (c) Eq. (8.28). 

 

 

 

Nota-se na Fig. 8.7c que a expressão empregada neste trabalho, Eq. (8.28), foi a única 

que conseguiu reproduzir, pelo menos qualitativamente, o campo de velocidades esperado, 

uma vez que apresentou a componente vertical desta velocidade nitidamente maior que a 

horizontal. Além disso, as velocidades em cada elemento são simétricas, o que também 

concorda com a simetria dos valores de pressão dados. O valor da permeabilidade absoluta 

utilizado em todos os casos foi de 1,13.10-13 m2, produzindo uma componente vertical da 

velocidade de 1 m/dia nos dois elementos. Esta componente foi utilizada como fator de escala 

para as demais velocidades plotadas nesta figura. 

 

Conclusão. Esses resultados revelam um aspecto importante no uso de métodos 

numéricos.  Nas operações numéricas, devido à discretização, é simples calcular variáveis em 

pontos do domínio a partir de médias (das mais diversas) dos pontos nodais. Estas médias 

podem produzir resultados contrários à física do problema, conforme foi o caso mostrado, 

aqui aplicado para um problema de pós-processamento. É por isso que todas as aproximações 

numéricas devem ser sempre amparadas pela física, a começar pela integração da equação 

diferencial em sua forma conservativa. 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 125 

 

 

8.4. As Duas Parcelas do Efeito de Orientação de Malha no 
EbFVM 

 

Considerando, ainda, o termo de fluxo, a utilização de uma função de interpolação de 

baixa ordem (upwind unidimensional) no cálculo da mobilidade cria uma dependência 

anômala dos resultados com a direção das linhas da malha (YANOSIK e MCCRACKEN, 

1979). Este tipo de interpolação garante estabilidade no método numérico, mas torna as 

soluções  fortemente dependentes da malha. Este é o chamado efeito de orientação de malha e 

é originado, portanto, pela forma como os termos de mobilidade são calculados nas interfaces 

dos volumes de controle. 

É possível demonstrar a existência de um outro erro numérico, que pode se manifestar 

principalmente quando são utilizadas malhas não-estruturadas, de origem semelhante ao efeito 

de orientação de malha e que é criado pela forma como as equações discretizadas multifásicas 

são obtidas. A saber, pela integração das equações diferenciais monofásicas e posterior adição 

dos termos de mobilidade. Já foi comentado neste texto que este é um procedimento 

inadequado para malhas não-estruturadas e, como será demonstrado, resulta em erros 

numéricos que podem ser predominantes nos resultados do EbFVM tradicional. A 

manifestação deste erro será identificada neste texto como um segundo efeito de orientação de 

malha porque cria soluções fortemente dependentes da malha e está relacionado ao cômputo 

das mobilidades, características do conhecido efeito de orientação de malha considerado no 

parágrafo anterior. 

O impacto da utilização das funções de interpolação upwind unidimensionais nos 

resultados do método EbFVM e a manifestação dos dois efeitos de orientação de malha 

mencionados são os assuntos considerados nesta seção e estudados em problemas-teste 

simples.  

 

8.4.1. Deslocamento Radial 

 

Empregando elementos quadriláteros, Bajor e Cormack (1989) propuseram estudar o 

efeito de orientação de malha em uma geometria radial semelhante à apresentada na Fig. 8.8, 

e que consiste de um poço injetor circundado por poços produtores simetricamente 



126 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

posicionados. Elementos triangulares são utilizados para viabilizar as comparações dos 

resultados do método proposto com os obtidos com os métodos tradicionais. 

 

 

 
Fig. 8.8 – Malha utilizada para avaliar o efeito de orientação de malha (48 nós e 68 elementos) 

 

 

As razões de mobilidades dos fluidos estudados neste problemas são M =1 e 10. Os 

dados utilizados na simulação para M = 1 estão apresentados na Tab. 8.1. Os resultados das 

simulações para M = 10 foram obtidos utilizando-se os mesmos dados da tabela, modificando-

se a viscosidade do óleo ( µo =  10 cp) e as curvas de permeabilidades relativas, que passam a 

ser definidas da seguinte forma4 

 

( )1w
w

r
w w

f
k

M f f
=

? +
 (8.31) 

1
o wr r

k k= ?  (8.32) 

  

onde w wf s= . 

 

 

 

                                                 
4 O procedimento de determinação das curvas de permeabilidade relativa em função do fluxo fracionário e da 
razão de mobilidades é recomendado por Yanosik e Mccracken (1979) para os estudos dos efeitos de orientação 
de malha. Eles demonstraram que esses efeitos se manifestam em deslocamentos tipo pistão que, por sua vez, 
surgem quando emprega-se expressões do fluxo fracionário do tipo fw = sw,  fw = sw2, entre outras, acentuando-se 
com o aumento da razão de mobilidades. 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 127 

 

 

Tab. 8.1 – Dados usados na simulação no problema da simulação radial com M = 1 

Porosidade 0,2 

Permeabilidade (isotrópica)  150 mD 

Espessura da camada 1 m 

Viscosidades da água e do óleo 1 cp 

Compressibilidades da água e do óleo 0 

Fatores volume de formação da água e do óleo 1 

swi 0 

sor 0 

krw  avaliada em sw = 1- sor  1 

kro avaliada em sw = swi 1 

Expoentes da curva de Corey, nw e no 1 

Vazão de injeção de água no poço injetor 0,01 m3/d 

Pressão de fundo no poço produtor 100 kPa 

Índice de poço 1 mD.m 

Passo de tempo 0,01 d 

 

 

Na Fig. 8.9 são apresentadas as curvas de corte de água nos poços produtores para 

diferentes razões de mobilidades. Observa-se nesta figura que, em virtude de se tratar de um 

problema com deslocamento radial, o método proposto apresentou os melhores resultados 

pois suas curvas apresentaram menores diferenças de produção de água entre os poços. 

Percebe-se que, embora os resultados do método proposto apresentem um efeito de orientação 

de malha que aumenta com a razão de mobilidades, os resultados do EbFVM tradicional 

apresentaram um aumento ainda maior. 

Uma outra forma de observar as diferenças mostradas na Fig. 8.9 é através da 

visualização das curvas de iso-saturação, como as apresentadas na Fig. 8.10. A razão de 

mobilidades utilizada neste caso foi M = 1, suficiente para se perceber que a solução do 

EbFVM proposto neste trabalho, Fig. 8.10b, revela ser mais simétrica do que a solução obtida 

pelo método tradicional, Fig. 8.10a, o que não deixava de ser esperado em função do que foi 

demonstrado na Fig. 8.9. 

 

 

 



128 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

EbFVM tradicional

0

20

40

60

80

100

0 10 20 30 40

t (d)

C
or

te
 d

e 
Á

gu
a 

%

    

EbFVM proposto neste trabalho

0

20

40

60

80

100

0 10 20 30 40

t (d)

C
or

te
 d

e 
Á

gu
a 

%

  
(a) M = 1 

 

EbFVM tradicional

0

20

40

60

80

100

0 10 20 30 40

t (d)

C
or

te
 d

e 
Á

gu
a 

%

     

EbFVM proposto neste trabalho

0

20

40

60

80

100

0 10 20 30 40

t (d)

C
or

te
 d

e 
Á

gu
a 

%

       
(b) M = 10 

 

Fig. 8.9 – Curvas de produção de água nos poços produtores obtidos pelos métodos EbFVM tradicional e 

proposto neste trabalho para diferentes razões de mobilidade 

 

 

 

    
                             (a) EbFVM tradicional                                                 (b) Método proposto 

 

Fig. 8.10  – Isolinhas de saturação para o tempo de simulação de 23 dias obtidas pelos diferentes métodos 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 129 

 

 

 Esta deficiência do método EbFVM tradicional se acentua quando são utilizados 

triângulos com piores razões de aspecto, como mostrado a seguir. 

 

 

8.4.2. Malhas de Triângulos Obtusângulos 

 

 O próximo caso analisado envolve a simulação de um reservatório de petróleo 

discretizado com uma malha composta apenas por triângulos obtusângulos, isto é, triângulos 

que contêm um ângulo maior que 90º, como os apresentados na Fig. 8.11. De acordo com o 

que é descrito na literatura, elementos deste tipo deveriam ser evitados, uma vez que 

resultariam em “trasmissibilidades negativas” (FUNG et al., 1993; SONIER et al., 1993). 

Pretende-se mostrar o impacto da utilização destes elementos nos resultados dos diferentes 

métodos. 

 

 

 
Fig. 8.11 – Malha de triângulos utilizada nas simulações (17 nós e 24 elementos) 

 

 

Neste exemplo a injeção de água se dá no poço localizado no canto direito inferior da 

malha e a produção se dá no canto oposto. Os dados utilizados nas simulações são os mesmos 

do problema anterior e estão detalhados na Tab. 8.1, com exceção da vazão de água no poço 

injetor, que neste caso foi aumentada para 0,1 m3/d. 

  A Fig. 8.12 apresenta a comparação das curvas de produção de água no poço produtor 

obtidas pelo simulador comercial STARS, utilizando o método EbFVM tradicional, e pelo 

simulador desenvolvido neste trabalho. 



130 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
Fig. 8.12 – Comparação das curvas de produção de água 

 

  

 Embora na Fig. 8.12 não sejam tão evidentes as diferenças entre os resultados, os 

campos de saturação originados pelos dois métodos são significativamente diferentes, como 

mostrado na Fig. 8.13. A despeito da malha utilizada não ser perfeitamente simétrica (Fig. 

8.11), o EbFVM tradicional apresentou resultados com demasiada assimetria e com a frente 

de saturação pouco realista, uma vez que o escoamento de água parece não estar se dando 

preferencialmente na direção da linha que une os poços injetor e produtor conforme pode ser 

visto no lado direito da Fig. 8.13a. Isso não aconteceu com os resultados obtidos pelo método 

proposto, que demonstraram ser fisicamente mais coerentes e significativamente melhores 

(Fig. 8.13b). 

 

 

8.4.3. Arranjo de Poços Five-Spot 

 

O esquema five-spot é um arranjo de poços bastante conhecido e um dos mais 

importantes esquemas de injeção do tipo padrão repetido5. O padrão-base consiste em um 

poço produtor rodeado por quatro poços injetores, como mostrado na Fig. 8.14a e b. A sua 

utilização no estudo dos efeitos de orientação de malha foi introduzida por Todd et al. (1972),  

 
                                                 
5 Os esquemas de injeção visam aumentar a recuperação de petróleo e são classificados em dois grupos 
principais: injeção periférica e injeção em padrão repetido (ou injeção em malhas). No primeiro grupo, os poços 
injetores estão localizados na base (periferia) do reservatório e os produtores se agrupam na sua parte central. No 
segundo grupo, os poços estão uniformemente distribuídos em toda a área do reservatório, seguindo um padrão 
ou malha básica que se repete em todo o domínio (ROSA et al., 2006). 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 131 

 

 

                 
t = 1,25d                                      t = 2,09 d 

(a) EbFVM tradicional 

 

                            
t = 1,25d                                      t = 2,09 d 

 (b) EbFVM proposto 

 

Fig. 8.13 – Mapas de saturação obtidos pelos diferentes métodos para dois tempos de simulação 

 

 

 

que demonstrou que, devido à simetria geométrica, a discretização espacial pode ser realizada 

utilizando-se duas malhas:   

 

(1) com uma malha orientada diagonalmente entre os poços, representando um quarto 

do padrão-base do arranjo de poços five-spot (Fig. 8.14a), e 

 

(2) com uma malha orientada paralelamente à linha que une o poço injetor ao produtor 

(metade deste padrão-base), como mostrado na Fig. 8.14b.  

 

Na região de intersecção das duas malhas (Fig. 8.14c) espera-se obter resultados 

idênticos. No entanto, sabe-se da literatura que, utilizando malhas Cartesianas regulares, os 

resultados são diferentes, especialmente para altas razões de mobilidade. 



132 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
 (a) Malha diagonal               (b) Malha paralela       (c) Superposição das malhas 

 

Fig. 8.14 – Malhas utilizadas no arranjo de poços five-spot 

 

  

 Em função da possibilidade de empregar elementos triangulares na discretização 

espacial do domínio, pode-se facilitar a interpretação dos resultados simulando o escoamento 

na área de superposição das malhas utilizando malhas como as apresentadas na Fig. 8.15, que 

representam ¼ e ½ das malhas paralela e diagonal do esquema five-spot, respectivamente. 

Nota-se que os elementos triangulares foram criados dividindo ao meio cada elemento 

quadrilátero original da malha Cartesiana, e por isso aparecem rotacionados em 90º. Tratam-

se, portanto, de malhas regulares. 

Foram simulados quatro casos, envolvendo diferentes razões de mobilidade: M = 

1/100, 1, 4 e 10. Os dados usados na simulação estão apresentados na Tab. 8.2, além das 

curvas de permeabilidade relativa, definidas a partir das Eqs. (8.31) e (8.32) com 2w wf s= . 

 

 

 

                       
 

(a) Malha paralela    (b) Malha diagonal  
 

Fig. 8.15 – Malhas utilizadas na simulação do problema five-spot 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 133 

 

 

Tab. 8.2 – Dados usados na simulação no problema five-spot com M = 1 

Porosidade 0,2 

Permeabilidade (isotrópica)  150 mD 

Espessura da camada 1 m 

Viscosidades da água e do óleo 1 cp 

Compressibilidades da água e do óleo 0 

Fatores volume de formação da água e do óleo 1 

swi 0 

sor 0 

Vazão de injeção de água no poço injetor 0,05 m3/d 

Pressão de fundo no poço produtor 100 kPa 

Índice de poço 1 mD.m 

Passo de tempo 0,001 d 

 

  

Os resultados obtidos pelos métodos EbFVM tradicional e o proposto neste trabalho 

para as malhas da Fig. 8.15 são comparados na Fig. 8.16 para diferentes razões de mobilidade. 

Nota-se que ambos os métodos apresentam diferenças de produção de água no poço produtor 

entre as malhas paralela e diagonal. No entanto, no método tradicional, à medida que a razão 

de mobilidade aumenta, o efeito de orientação de malha aumenta em uma proporção maior 

que no EbFVM proposto. Importante mencionar que ambos os métodos utilizaram as mesmas 

funções de interpolação para a mobilidade (upwind). Um outro ponto que merece ser 

destacado é que os resultados da malha diagonal do método proposto se aproximam dos da 

malha paralela do método tradicional, resultando num efeito de orientação de malha invertido 

do tradicional relatado na literatura, para todas as razões de mobilidade pesquisadas. 

 

Discussão. O comportamento anômalo das soluções obtidas com o método tradicional 

mostrado na Fig. 8.16d, que se manifesta, principalmente, para altas razões de mobilidade e 

que se caracteriza pelo aumento repentino da produção de água na malha paralela e a 

diminuição na seqüência, é idêntico às das curvas produzidas por malhas Cartesianas e 

relatadas na literatura (YANOSIK e McCRACKEN, 1979; BAJOR e CORMACK, 1989; 

SHIN e MERCHANT, 1993). Estes resultados se manifestam exatamente quando a malha de 

triângulos é construída dividindo-se quadriláteros em triângulos retângulos, sendo esta a razão 

da recomendação de alguns autores de evitar este procedimento de geração de malha 



134 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

(SONIER e EYMARD, 1993). Na realidade, a razão da semelhança dos resultados 

apresentados com os resultados de malhas Cartesianas pode ser facilmente compreendida: 

com este tipo de malha, o coeficiente correspondente à conexão entre os dois nós separados 

pela hipotenusa do triângulo é anulado. O resultado, portanto, é um esquema de cálculo de 

fluxos por 5 pontos que tem as mesmas características do cartesiano, incluindo seu principal 

ponto fraco: o efeito de orientação de malha demasiadamente acentuado. 

 

 

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM tradicional - paralela
EbFVM tradicional - diagonal
EbFVM - paralela
EbFVM - diagonal

              

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%
EbFVM tradicional - paralela
EbFVM tradicional - diagonal
EbFVM - paralela
EbFVM - diagonal

   
   (a) M = 0,01              (b) M = 1 

 

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM tradicional - paralela
EbFVM tradicional - diagonal
EbFVM - paralela
EbFVM - diagonal

                  

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM tradicional - paralela
EbFVM tradicional - diagonal
EbFVM - paralela
EbFVM - diagonal

    
      (c) M = 4                         (d) M = 10 

 

Fig. 8.16 – Comparação das curvas de produção de água no poço produtor obtidas por diferentes métodos que 

utilizam a mesma função de interpolação upwind para avaliar as mobilidades 

 

 

  

 Considerações sobre a função upwind. Como mencionado anteriormente, os 

resultados da Fig. 8.16 foram obtidos para ambos os métodos aproximando a mobilidade nas 

interfaces dos volumes de controle através da função de interpolação upwind. Diversos 

trabalhos têm mostrado que o cálculo da avaliação das mobilidades é uma questão-chave na 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 135 

 

 

redução do efeito de orientação de malha, sendo propostas diferentes funções upwind para a 

obtenção de resultados mais razoáveis (TODD et al., 1972; VINSOME e AU, 1979; 

FRAUENTHAL et al., 1985), mas que são de difícil aplicação em malhas não-estruturadas.  

Como foi discutido no Cap. 5, a equação da pressão é uma equação elíptica e, por isso, 

permitiria, ao contrário da equação da saturação, a utilização de uma função de interpolação 

de mais alta ordem na avaliação das mobilidades sem ocasionar oscilações na solução.  Por 

esta razão, foi implementada a opção de resolver a equação da pressão calculando as 

mobilidades através das próprias funções de forma, que é um procedimento bastante trivial no 

método proposto, conforme pode ser visto no Anexo 8. Na equação da saturação continuar-se-

á avaliando a mobilidade (escrita, agora, em termos do fluxo fracionário) com a função 

upwind. A aplicação prática desta nova formulação nos problemas analisados nesta seção 

pode ser visto na Fig. 8.17, que compara a nova solução, identificada como EbFVM (FF), 

com a obtida empregando a função de interpolação upwind nas duas equações: saturação e 

pressão, representada por EbFVM (U). 

Nota-se na Fig. 8.17a e b que as soluções EbFVM (FF) e EbFVM (U) obtidas com 

baixas razões de mobilidade são praticamente idênticas independentemente da aproximação 

da mobilidade na equação da pressão. Mas, mesmo assim, as soluções das malhas diagonal e 

paralela não são ainda idênticas, apresentando um pequeno efeito de orientação de malha 

remanescente, que pode estar sendo ocasionado pela aproximação da mobilidade por função 

upwind na equação da saturação, que continua sendo realizada. 

Quando a razão de mobilidades aumenta, Fig. 8.17c e d, o efeito de orientação de 

malha aumenta em uma proporção menor quando são utilizadas as funções de forma na 

avaliação das mobilidades na equação da pressão, indicando que estas funções de interpolação 

de mais alta ordem estão contribuindo, mesmo que parcialmente, apenas na equação da 

pressão, para a redução do efeito de orientação de malha. 

 

 



136 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM (FF) - paralela
EbFVM (FF) - diagonal
EbFVM (U) - paralela
EbFVM (U) - diagonal

               

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM (FF) - paralela
EbFVM (FF) - diagonal
EbFVM (U) - paralela
EbFVM (U) - diagonal

  
   (a) M = 0,01              (b) M = 1 

 

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM (FF) - paralela
EbFVM (FF) - diagonal
EbFVM (U) - paralela
EbFVM (U) - diagonal

                

0

20

40

60

80

100

0 1 2 3 4

t (d)

C
or

te
 d

e 
Á

gu
a 

%

EbFVM (FF) - paralela
EbFVM (FF) - diagonal
EbFVM (U) - paralela
EbFVM (U) - diagonal

   
     (c) M = 4                       (d) M = 10 

 

Fig. 8.17 – Comparação das curvas de produção de água no poço produtor obtidas pelo método EbFVM 

utilizando como função de interpolação da mobilidade na equação da pressão as funções de forma (FF) ou  a 

função de interpolação upwind (U) 

 

   

  

A Fig. 8.18 compara os mapas de isolinhas de saturação das malhas paralelas e 

diagonais obtidas com M = 10, para um tempo de simulação de 1 dia, produzidas pelo método 

EbFVM tradicional (software comercial STARS), e pelo método EbFVM proposto utilizando 

as funções upwind e as funções de forma na avaliação das mobilidades na equação da pressão. 

Percebe-se que o efeito de orientação de malha é menos acentuado no terceiro caso. 

 

Conclusão. As soluções mostradas na Fig. 8.18a e Fig. 8.18b são obtidas 

essencialmente pelo mesmo método e com o mesmo esquema de avaliação das mobilidades - 

upwind. Como os resultados do método EbFVM tradicional apresentaram um maior efeito de 

orientação de malha, entende-se que o efeito adicional que contaminou seus resultados deve-

se à forma como são obtidas as suas equações multifásicas discretizadas, isto é, através da 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 137 

 

 

adaptação da equação monofásica. Quando são utilizadas as equações discretizadas 

provenientes da integração das equações diferenciais multifásicas, que é o procedimento usual 

do Método de Volumes Finitos, o único efeito de orientação de malha remanescente tem 

origem na função de interpolação de baixa ordem utilizada. Ao ser utilizada outra função de 

interpolação das mobilidades na equação da pressão, o efeito de orientação de malha 

resultante é menor, embora continue existindo pois a função de baixa ordem (upwind) ainda 

permanece na equação da saturação.  

 

 

    
Malha paralela    Malha diagonal 

(a)  EbFVM tradicional (simulador comercial) 
 

    
Malha paralela    Malha diagonal 

(b) EbFVM proposto (U) 
  

    
Malha paralela    Malha diagonal 

(c) EbFVM proposto (FF) 

 

Fig. 8.18 – Mapas de iso-saturações (sw=0.2, 0.4, 0.6 e 0.8) obtidos por diferentes métodos para razão de 

mobilidade M = 10,  para um tempo de simulação de 1 dia. 

 



138 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

A solução para a eliminação completa do efeito de orientação de malha seria substituir 

as funções upwind unidimensionais6 na equação da saturação por funções upwind mais 

aprimoradas, que verdadeiramente baseiam-se na direção das linhas de correntes e fiquem 

menos vinculadas às linhas da malha. Este assunto não foi estudado nesta tese, mas já foi 

investigado em outros trabalhos (RAW, 1985; HURTADO, 2005). Em suma, os autores 

mostram que estas novas funções produzem resultados com menor orientação de malha e, 

ainda assim, sem as oscilações típicas das funções de interpolação de maior ordem. Neste 

caso o valor interpolado passa a ser função de todos os valores nodais do elemento e não de 

apenas de um, como é o procedimento resultante da função upwind unidimensional 

usualmente empregada. 

A despeito do fato de que as funções de interpolação têm papel decisivo na redução do 

efeito de orientação de malha, é importante mencionar que é sempre preferível, em casos 

práticos, utilizar malhas com orientação randômica de elementos (triangulares e/ou 

quadrangulares), a fim de não criar direções preferenciais para a manifestação do erro 

ocasionado pelo esquema de avaliação das mobilidades. Isso é possível e é o grande trunfo da 

utilização das malhas não-estruturadas, pois os geradores de malhas normalmente não têm 

dificuldades em gerar malhas irregulares. 

 

 

 

8.5. Comparação entre os Diferentes Esquemas de 
Representação de Propriedades Físicas e Falhas 

Geológicas no EbFVM 
 

No Cap. 4 foram apresentadas diferentes formas de armazenar as propriedades físicas 

e falhas geológicas em reservatórios heterogêneos. Foi mostrado que as propriedades físicas, 

como permeabilidade absoluta e porosidade, podem ser armazenadas tanto nos volumes de 

controle (VERMA e AZIZ, 1997; STARS User’s Guide, 2002) como nos elementos, 

conforme proposto neste trabalho. Deve-se lembrar que os elementos são as entidades 

                                                 
6 As funções upwind empregadas neste trabalho podem ser consideradas como unidimensionais porque o valor  a 
ser avaliado na face perpendicular a dois nós será sempre função de apenas um destes, aquele nó, que de acordo 
com algum critério, for considerado à montante desta face.  



 CAP.  8  – RESULTADOS E COMPARAÇÕES 139 

 

 

geométricas definidas pelos nós da malha, enquanto que os volumes de controle são as 

entidades construídas ao redor destes nós, nas interfaces dos quais são calculados os fluxos.  

O impacto nos resultados da aplicação de cada esquema de representação será 

analisado em dois problemas-teste. 

 

8.5.1. Reservatório Heterogêneo sem Falhas Geológicas 

 

 Considere o reservatório heterogêneo apresentado na Fig. 8.19, discretizado 

utilizando-se os dois esquemas apresentados no início do capítulo, isto é, modelando cada 

volume de controle com um único valor de permeabilidade, Fig. 8.19a, ou modelando cada 

elemento da malha através de um único valor de permeabilidade, Fig. 8.19b. Note que o 

procedimento de construção dos volumes de controle que consiste em unir a mediana das 

faces dos elementos ao seu baricentro resulta em volumes como o ilustrado na  Fig. 8.19a em 

tracejado. Para facilitar a visualização, os demais volumes de controle não são identificados 

em ambas as figuras. Os elementos estão representados com linha cheia. Os dados utilizados 

na simulação são apresentados na Tab. 8.3, enquanto que a posição dos poços injetores e 

produtores está destacada na Fig. 8.19.  

É importante destacar que uma situação ideal para as comparações seria utilizar, 

exatamente, as mesmas malhas nos dois casos. Porém, isso não é possível em função da 

necessidade de representar, a partir de esquemas diferentes de armazenamento de 

propriedades, um mesmo reservatório heterogêneo. 

 

 

                                 
(a) Esquema em que k é armazenado no volume                (b) Esquema em que k é armazenado no elemento                            

Fig. 8.19 – Diferentes discretizações do reservatório heterogêneo em estudo 



140 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Tab. 8.3 – Propriedades físicas e parâmetros numéricos utilizados 

Porosidade 0,2 

Espessura da camada 1 m 

Viscosidades da água e do óleo 1 cp 

Compressibilidades da água e do óleo 0 

Fatores volume de formação da água e do óleo 1 

swi 0 

sor 0 

krw  avaliada em sw = 1- sor  1 

kro avaliada em sw = swi 1 

Expoentes da curva de Corey, nw e no 1 

Vazão de injeção de água no poço injetor 0,1 m3/d 

Pressão de fundo no poço produtor 100 kPa 

Índice de poço 1 mD.m 

Passo de tempo 0,01 d 

 
 

Embora possa ser mostrado que o campo de saturação, e em conseqüência, as curvas 

de produção obtidas com cada uma das malhas da Fig. 8.19 não sejam muito diferentes, os 

campos de pressão obtidos em cada caso são bastante distintos, como mostra a Fig. 8.20. 

Nota-se que o campo de pressão obtido pelo esquema que armazena a permeabilidade no 

centro do volume de controle apresenta oscilações, Fig. 8.20a. Já o outro esquema, que é 

aquele em que o campo de permeabilidades é armazenado nos elementos, apresentou os 

resultados qualitativamente esperados, Fig. 8.20b, pois reproduz a forma típica do campo de 

pressão encontrado nas malhas diagonais do esquema five-spot. 

Os resultados fisicamente inconsistentes da Fig. 8.20a podem ter três origens. A 

primeira pode ser a grande descontinuidade do campo de permeabilidade absoluta no interior 

do elemento que ainda existe independentemente do procedimento de média harmônica nos 

pontos de integração. Essa descontinuidade parece ser incompatível com a aproximação bi-

linear do campo de pressão no interior imposta pela utilização de funções de forma. A 

seguinte origem tem a ver com o tipo de média empregada, porque possivelmente a média 

harmônica não seja a mais indicada para esta operação. Conforme descrito no Cap. 4, diversos 

trabalhos da literatura têm acenado nesta direção. Finalmente, não se pode descartar a 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 141 

 

 

influência da malha mais grosseira, em relação a do outro método, que foi empregada nesta 

comparação.  

 

 

 

              
 

(a) Esquema em que k é armazenado no volume                (b) Esquema em que k é armazenado no elemento                            
 

Fig. 8.20 – Campo de pressão obtido com cada técnica de armazenamento das propriedades no problema do 

reservatório heterogêneo analisado  

 

 

 

  No método utilizado no segundo caso em que as propriedades físicas são armazenadas 

nos elementos, Fig. 8.19b, não há a necessidade de fazer nenhum tipo de média para obter a 

permeabilidade no ponto de integração, uma vez que ela é constante dentro do elemento. 

Neste caso desaparecem também todas as dificuldades associadas a descontinuidades no 

elemento e a função de interpolação bi-linear. Um outro ponto positivo deste esquema de 

armazenamento é a facilidade de mapear um domínio heterogêneo com um malha de 

elementos, sem a necessidade de checar uma segunda malha, a dual de volumes de controle, 

onde as propriedades poderiam estar armazenadas. Assim, a melhor alternativa parece ser 

utilizar um método numérico baseado no elemento, como o proposto neste trabalho.  

 

8.5.2. Reservatório Heterogêneo com Falhas Geológicas 

 

Para estudar a aplicação das metodologias de representação de falhas em malhas não-

estruturadas apresentadas no Cap. 4, foi concebido um problema cuja geometria é apresentada 

na Fig. 8.21a que, em virtude da configuração da falha geológica, será denominado de 



142 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

“problema do labirinto”. Nesta mesma figura ainda são apresentados a posição dos poços 

injetor e produtor e as dimensões do reservatório hipotético em estudo. As propriedades 

físicas são as mesmas utilizadas no problema anterior e estão descritas na Tab. 8.3. A partir da 

geometria apresentada, dois diferentes casos serão analisados, e suas diferenças estão 

baseadas no valor do campo de permeabilidade absoluta de uma dada região do domínio, 

aquela que aparece destacada na Fig. 8.21b. A permeabilidade k2 utilizada nesta região é de 

5000 mD, para um reservatório homogêneo, e de 50 mD para um reservatório heterogêneo. 

 

 

                 
                        (b) Permeabilidades absolutas 
                     (a) Reservatório e falha                                                   utilizadas 

  

Fig. 8.21 – O reservatório e a definição da falha no problema do labirinto 

 

No primeiro modelo de representação de falha, em que ela é caracterizada pelo 

cancelamento dos fluxos, será empregada a malha apresentada na Fig. 8.22, que consiste de 

nove elementos quadrangulares e 16 nós (ou 16 volumes de controle). No programa 

computacional, basta anular todos os fluxos localizados nas interfaces dos volumes de 

controle geometricamente coincidentes com a falha. Observe que se a falha estivesse mais 

próxima da fronteira norte do reservatório, seria necessário um maior número de elementos na 

malha se desejássemos ainda uma malha igualmente espaçada. Isto aconteceria porque é 

necessário que os pontos de integração sejam coincidentes com a falha para que os fluxos 

sejam anulados. 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 143 

 

 

                       
(a) Malha utilizada                                       (b) Destaque para os nós, elementos e volumes 

 

 
(c) Destaque para a posição da falha 

 

Fig. 8.22 – Malha utilizada no problema do labirinto simulando a falha através do cancelamento dos fluxos 

  

 

A outra opção de modelar falhas consiste em representá-las utilizando elementos com 

espessura reduzida e com baixos valores de permeabilidade7. Assim, para o reservatório da 

Fig. 8.21, é possível construir uma malha composta por elementos triangulares e 

quadrangulares como a apresentada na Fig. 8.23a, composta por 20 nós e 18 elementos. A fim 

de evitar confusões na interpretação da numeração dos nós, embora a numeração de cada nó 

                                                 

7 No Cap. 4 apresentou-se uma terceira opção de representar falhas, a partir da eliminação de elementos no 
interior da malha. Ela não foi investigada neste capítulo porque apenas falhas totalmente selantes podem ser 
representadas com esta técnica, e a sua aplicação no problema analisado nesta seção produz resultados idênticos 
ao da segunda opção de representar falhas (a proposta neste trabalho). 



144 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

apareça destacada na Fig. 8.23b, os elementos que compõem a falha geométrica aparecem 

desenhados de forma ampliada na Fig. 8.23c, onde são apresentados fora de escala para fins 

de visualização. Note que se não fosse ampliada exageradamente a espessura da falha nesta 

figura, seria impossível visualizá-la na sua escala natural, uma vez que a espessura utilizada é 

0,00001L, onde L é a dimensão do reservatório. Poder-se-ia utilizar valores ainda menores 

para a espessura da falha, mas considera-se que este é um valor adequado. 

 

 

 

                      
                     (a) Malha utilizada                                      (b) Malha utilizada destacando a numeração dos nós 

 

 
(c) Malha com a espessura ampliada para fins de visualização 

 

Fig. 8.23 – Malha utilizada no problema do labirinto representando a falha através de elementos 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 145 

 

 

É importante mencionar que neste esquema para falhas, os coeficientes da matriz de 

determinação do campo de pressões continuam todos sendo da mesma ordem. Isso vale 

mesmo para os coeficientes calculados para os nós vizinhos da falha (nós 5, 7, 15, 16 etc. na 

Fig. 8.23), que continuam sendo da mesma ordem dos demais, uma vez que os volumes e 

áreas envolvidos no seu cálculo provêm também dos elementos adjacentes à falha, que tem 

dimensões físicas comparáveis aos demais elementos da malha. Essa é uma característica 

desejável e importante para assegurar que o solver utilizado não tenha dificuldades adicionais, 

causadas por eventuais diferenças na ordem de magnitude dos coeficientes. 

Por serem bastante semelhantes, os campos de saturação obtidos pelos dois esquemas 

de representação de falhas não são apresentados. No entanto, como mostrado na Fig. 8.24, os 

campos de pressão são bem diferentes. Nota-se que, no caso do reservatório heterogêneo, o 

esquema que representa a falha anulando o fluxo nas interfaces dos volumes apresenta os 

maiores desvios de monotonicidade na curva de queda de pressão ao longo do labirinto (Fig. 

8.24a). No outro esquema, os resultados foram mais satisfatórios, como demonstra a Fig. 

8.24b, pois tais desvios de monotonicidade não existem. Em ambos os casos a pressão é 

calculada nos nós da malha, e o campo de pressão visualizado é obtido por interpolação com 

as funções de forma apresentadas no Cap. 4. 

Estes resultados também podem ser analisados de outra forma: verificando a 

monotonicidade das curvas de queda de pressão ao longo do labirinto. Isso é interessante 

porque nesta direção o problema é praticamente unidimensional. Traçando um gráfico com os 

valores calculados nos nós localizados nesta direção obtêm-se as curvas da  Fig. 8.25, que 

compara os resultados obtidos pelo EbFVM nos dois esquemas de modelagem de falha 

geológica com os resultados obtidos por um simulador de reservatórios comercial (IMEX da 

CMG) utilizando uma malha Cartesiana igualmente espaçada de 4x4 blocos com a forma 

tradicional de calcular os fluxos e representar falhas  (IMEX User’s Guide, 2002). Nesta 

malha Cartesiana, localizada no lado esquerdo da Fig. 8.25c, a falha foi modelada cancelando-

se os fluxos entre os volumes separados por ela, que, para malhas estruturadas, é o 

procedimento adequado. Por isso, a solução deste software comercial é utilizada aqui como 

solução de referência. 

 

 



146 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

                            
          Homogêneo                                             Heterogêneo 

(a) Modelando a falha anulando o fluxo nas interfaces dos volumes 
 

                         
          Homogêneo                                             Heterogêneo 

 (b) Modelando a falha utilizando elementos com baixa permeabilidade 

Fig. 8.24 - Campo de pressão obtido com cada esquema de representação no problema do labirinto 

  

 

 

As curvas da Fig. 8.25a foram obtidas plotando-se os valores de pressão dos nós 

localizados na direção do escoamento: nós 1, 5, 9, 13, ... da Fig. 8.22c. Os dois gráficos da 

Fig. 8.25b, por sua vez, foram obtidos plotando-se os valores de pressão dos nós 1, 3, 4, 6, ...  

e 1, 15, 16, 17, .... da Fig. 8.23c, respectivamente. Percebe-se que mesmo para o caso 

homogêneo, a queda de pressão ao longo do labirinto para o EbFVM no caso em que a falha é 

modelada zerando os fluxos dentro do elemento apresenta-se com oscilações, Fig. 8.25a, que 

se acentuam quando o meio é heterogêneo. Este comportamento não é verificado quando a 

falha é representada utilizando elementos com baixa permeabilidade, Fig. 8.25b. Na realidade, 

para este caso, encontrou-se o mesmo comportamento verificado quando utiliza-se malhas 

Cartesianas, Fig. 8.25c, caracterizado por uma queda da pressão quase linear ao longo do 

labirinto.  

 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 147 

 

 

EbFVM  com Armazenamento de K no VC - 
Cami nho 1, 5, 9,13...

1272

1277

1282

1287

1292

1297

Nó  
1

Nó
5

Nó
9

Nó
13

Nó
14

Nó
15

Nó
16

Nó
12

Nó
8

Nó
4

Nó
3

Nó
2

Nó
6

Nó
10

Nó
11

Nó
7

Volumes ao longo do labiri nto

P
 (

kP
a)

EbFVM  Homog

EbFVM  Heterog

       
(a) Representando a falha anulando o fluxo nas interfaces dos volumes 

 

  

EbFVM  com Arma zena mento de K no El emento - 
Cami nho 1, 3, 4, 6...

1272
1274
1276
1278
1280
1282
1284
1286
1288
1290
1292

Nó 
1

Nó 
3

Nó 
4

Nó 
6

Nó 
2

Nó 
5

Nó 
7

Nó 
8

Nó 
9

Nó 
14

Volumes ao l ongo do la bi rinto

P 
(k

P
a)

EbFVM  Homog

EbFVM  Heterog

         

EbFVM  com Arma zenamento de K no Elemento - 
Ca minho 1, 15,16,17...

1272
1274
1276
1278
1280
1282
1284
1286
1288
1290
1292

Nó 
1

Nó
15

Nó
16

Nó
17

Nó
18

Nó
19

Nó
20

Nó
13

Nó
12

Nó
14

Volumes a o l ongo do l abiri nto

P 
(k

P
a)

EbFVM  Homog

EbFVM  Heterog

 
(b) Representando a falha utilizando elementos com baixa permeabilidade  

 

           

IM EX com mal ha cartesi a na  -  
Cami nho 1,1;  2,1; 3,1; 4,1; 4,2; 4,3; 3,4; ...

1272

1274

1276

1278

1280

1282

1284

1286

1288

1290

1292

1,1 2,1 3,1 4,1 4,2 4,3 4,4 3,4 2,4 1,4 1,3 1,2 2,2 3,2 3,3 2,3

Vol umes ao l ongo do l abi ri nto

P
 (

kP
a)

IM EX Heterog
IM EX Homog

 
(c) Resultados do simulador comercial ( IMEX) utilizando malha Cartesiana 

 

Fig. 8.25 – Comparação da queda de pressão ao longo do labirinto obtida por diferentes métodos 

 

  

 Discussão. Uma possível causa dos indesejados resultados mostrados neste trabalho 

com o esquema de modelar falhas através do cancelamento dos fluxos dentro dos elementos 



148 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

pode ser a utilização de valores nodais de pressão inadequados no cálculo do fluxo. Uma 

ilustração disso é apresentada na Fig. 8.26, onde aparece destacado o elemento formado pelos 

nós 3, 4, 7 e 8. Neste elemento, o fluxo mássico em dois pontos de integração ( , na figura) 

foram anulados para que a falha geológica pudesse ser modelada. Assim o fluxo resultante 

neste elemento, que é o que vem do volume de controle construído ao redor do nó 8 em 

direção do volume de controle construído ao redor do nó 3, deve passar apenas pelas 

interfaces do volume de controle construído ao redor do nó 4, em cada um dos pontos de 

integração identificados com o símbolo (x). 
 

  

 
 

Fig. 8.26 – Pontos de integração e direção do fluxo em um dos elementos da malha utilizada no problema do 

labirinto, no caso em que a falha é representada através do cancelamento dos fluxos nas interfaces 

 

 

A conclusão imediata que se pode obter é que o cálculo do fluxo discretizado nos 

pontos de integração (x) não deve depender de nenhuma grandeza física ou variável 
armazenada no nó 7, pois este nó corresponde a um volume de controle que, em virtude da 

presença da falha,  não apresenta nenhuma relação direta com o fluxo que atravessa as duas 

interfaces destacadas em tracejado na Fig. 8.26. No entanto, como se optou por utilizar um 

método numérico que utiliza as funções de forma como função de interpolação, são elas que 

relacionam obrigatoriamente qualquer grandeza dentro do elemento aos seus quatro valores 

nodais (ou três no caso de elementos triangulares). Assim, quando a parcela do fluxo da 

equação de conservação for discretizada em qualquer uma das duas interfaces analisadas (em 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 149 

 

 

linha tracejada na Fig. 8.26), o gradiente de pressão será aproximado empregando-se quatro 

valores nodais, inclusive o do nó 7. Por isso que, à medida em que o valor de pressão deste nó 

se afasta demasiadamente dos demais, como é o caso heterogêneo analisado nesta seção, os 

resultados obtidos com este esquema começam apresentar-se fisicamente cada vez menos 

realistas.  

Portanto, as oscilações nos resultados obtidos podem ser consideradas um reflexo da 

utilização de um esquema de interpolação que não é adequado para situações de 

descontinuidades de funções dentro do elemento. Por outro lado, o esquema de representação 

de falhas proposto neste trabalho e que utiliza elementos de pequena espessura e com baixa 

permeabilidade não apresenta estas descontinuidades, e por isso é mais adequado para ser 

empregado no EbFVM.  

 
 

 

8.6. Comparação entre os Métodos IMPES e Totalmente 
Implícito 

 

O objetivo desta seção é comparar os métodos de solução de equações mais 

conhecidos, o IMPES (Implicit Pressure and Explicit Saturation) e o Totalmente Implícito, 

aplicados em malhas não-estruturadas. Estes métodos foram descritos no Cap. 5 e agora serão 

comparados na resolução das equações discretizadas resultantes do método EbFVM.  

O problema-teste escolhido para este estudo está definido na Fig. 8.27. Os dados 

utilizados nesta simulação são apresentados na Tab. 8.4. As curvas de permeabilidade relativa 

utilizadas são as definidas pelas Eqs. (8.31) e (8.32) com 1.2w wf s=  e M = 1. 

No caso do IMPES, foi utilizado um passo de tempo fixo calculado pela Eq. (5.23) 

que fornece o maior valor possível que assegura a estabilidade numérica. Foram feitas 

experiências no sentido de utilizar um passo de tempo variável, procurando aumentá-lo à 

medida em que a simulação progredia. Percebeu-se, entretanto, que na maioria dos casos, os 

custos computacionais associados ao procedimento de determinação do valor de um passo de 

tempo estável, variável e maior não justificaram o ganho computacional obtido pela 

diminuição do número de vezes que o sistema linear é resolvido. 

 

 



150 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

 
Fig. 8.27 - Reservatório bidimensional discretizado com uma malha formada por 4357 nós e 4242 elementos 

quadrangulares 

 

 

 
Tab. 8.4 – Propriedades físicas e parâmetros numéricos utilizados 

Porosidade 0,2 

Permeabilidade (isotrópica) 500 mD 

Espessura da camada 1 m 

Viscosidades da água e do óleo 1 cp 

Saturação de água inicial 0 

Pressão inicial 150 kPa 

Compressibilidades da água e do óleo 10-6 kPa-1 

Fatores volume de formação da água e do óleo 
avaliados na pressão inicial 

1 

swi 0 

sor 0 

Vazão de injeção de água no poço injetor 500 m3/d 

Pressão de fundo no poço produtor 100 kPa 

Índice de poço 1 mD.m 

Passo de tempo (quando prescrito) 0,037 d 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 151 

 

 

O método Totalmente Implícito, por outro lado, tem uma maior flexibilidade quanto 

ao tamanho do passo de tempo, e por isso ele foi resolvido de duas formas: 

  

 com o passo de tempo fixo (mesmo do IMPES – 0, 037t? =  d) e  

 com o passo de tempo variável calculado pela Eq. (5.56). 

 

 A utilização de um passo de tempo igual ao do IMPES não se justifica em casos 

práticos, justamente porque ele foi criado para permitir passos de tempo maiores e sem 

instabilidades. Mas, mesmo assim, considerou-se importante esta comparação para que se 

possa ter noção do desempenho do Método Totalmente Implícito quando o passo de tempo é 

fixo e de reduzidas dimensões.  

Quanto à utilização de valores variáveis do passo de tempo, é importante enfatizar 

que, embora as restrições de seu tamanho sejam menores no método implícito, deve-se ter 

cuidado para que ele produza soluções dentro da precisão desejada para o problema em 

questão, haja vista a aproximação da derivada temporal. Por isso, foram usadas as restrições 

apresentadas no Cap. 5 no cálculo automático do passo de tempo a fim de controlar seu 

incremento.  

No problema estudado, a utilização da Eq. (5.56) com estas restrições resultaram em 

passos de tempo com picos de até 40 d, aproximadamente, como mostra o gráfico da  Fig. 

8.28, que relaciona o passo de tempo com o tempo de simulação. Esse valores são, portanto, 

bem maiores que o valor de 0,037 d requerido pelo IMPES para este caso. O formato da curva 

apresentada nesta figura lembra o das curvas do tipo “dente de serra”, e se estabeleceu em 

função da imposição de reduzir pela metade o passo de tempo quando ele resultar em um 

número elevado de iterações do método de Newton para a obtenção da solução convergida ou 

se surgirem mudanças bruscas do valor das variáveis naquele passo de tempo. Essas questões 

já foram discutidas na seção 5.2.4. A brusca redução do passo de tempo no final da simulação 

foi necessário para que a simulação acabasse no tempo exato de 400 d, como desejado. Outros 

critérios de aumento e de redução do passo de tempo poderiam ter sido aplicados, mas esse 

tópico foge ao escopo deste trabalho. 

A Fig. 8.29 apresenta as isolinhas de saturação de água obtidas pelo EbFVM com os 

métodos de solução IMPES e Totalmente Implícito para um mesmo tempo de simulação        

(t = 400 d). Pode-se notar que, mantido o passo de tempo constante durante a simulação, os 

dois métodos produzem resultados muito semelhantes, Fig. 8.29 a e b. Os resultados do 



152 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

método Totalmente Implícito apresentam uma difusão numérica um pouco maior quando lhe 

é permitido avançar com passos de tempo maiores, como pode ser visto na Fig. 8.29 c. 

 
 

 
Fig. 8.28 – Passo de tempo variável empregado na formulação Totalmente Implícita  

em função do tempo de simulação 

 

 
 

  

   
          (a) IMPES           (b) Totalmente Implícito – Passo de Tempo Fixo 

 

 
(c) Totalmente Implícito – Passo de Tempo Variável 

 
Fig. 8.29 – Perfis de saturação de água no tempo de simulação de 400 dias obtidos pelo método proposto para o 

reservatório da Fig. 8.27 utilizando o IMPES e o método Totalmente Implícito  



 CAP.  8  – RESULTADOS E COMPARAÇÕES 153 

 

 

O custo computacional associado a cada método para obter a solução da Fig. 8.29 está 

apresentado na Tab. 8.5. Embora o método Totalmente Implícito tenha apresentado uma 

solução com menor precisão quando o passo de tempo foi calculado automaticamente, a 

redução drástica do custo computacional justifica a sua utilização em casos práticos. Na 

realidade, uma simulação completa pelo método IMPES não é viável em problemas reais de 

reservatórios em função da necessidade da utilização de passos de tempo excessivamente 

pequenos. 

 

 
Tab. 8.5 – Custo computacional do EbFVM com diferentes métodos de solução das equações  

 

Método de Solução das Equações Discretizadas 
Tempo de simulação 

(Pentium 4 – 1.7 GHz – 1 GB RAM) 

IMPES                                (com passo de tempo fixo) 20 min 40 s 

Totalmente Implícito          (com passo de tempo fixo) 200 min 42 s 

Totalmente Implícito          (com passo de tempo variável) 2 min 30 s 

 

 

 Discussão. Nota-se na Tab. 8.5 que o Método Totalmente Implícito apresentou, como  

esperado, um alto custo computacional quando foi utilizado o passo de tempo do IMPES. Isso 

evidencia a inviabilidade de sua aplicação prática com esta ordem de passo de tempo. Mas 

este exemplo serviu para mostrar que os resultados do Método Totalmente Implícito (Fig. 

8.29b) são praticamente idênticos aos do IMPES (Fig. 8.29a) quando estes métodos avançam 

no tempo da mesma maneira. 

 De uma forma geral, os resultados da Fig. 8.29 concordam com a análise numérica 

efetuada por Peaceman (1977), que consistiu em estudar uma versão mais simples das 

equações consideradas nesta tese, mas que conservam na essência o caráter hiperbólico das 

equações de conservação de cada fase. Através de uma análise de estabilidade e dispersão 

numéricas, o autor demonstrou que, para problemas lineares, o método Totalmente Implícito 

com a avaliação a montante das mobilidades (upwind) é incondicionalmente estável, 

apresentando, no entanto, uma difusão numérica que aumenta com o crescimento do CFL. O 

método IMPES, por sua vez, é estável apenas para CFL ? 1, mas com dispersão numérica que 

diminui à medida em que o CFL utilizado se aproxima da unidade. Portanto, em termos de 

redução da difusão numérica,  o ideal seria obter uma simulação numérica sempre com o  



154 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

CFL = 1 e com o método IMPES. Isso é bastante difícil de ser obtido na prática porque um 

mesmo intervalo de tempo dá origem a diferentes valores de CFL dependendo das dimensões 

dos volumes de controle e dos fluxos envolvidos. 

Tecendo as últimas considerações sobre estes dois métodos, deve-se dizer que a 

qualidade dos resultados e a rapidez da simulação dependem, obviamente, do solver 

empregado na solução do sistema linear. Os resultados apresentados até agora neste texto 

foram obtidos com relativa rapidez e precisão com o solver GMRES da COI-lib8. No entanto, 

as boas características deste solver não se verificaram em sistemas lineares maiores, o que 

motivou o desenvolvimento de um solver mais robusto, o multigrid baseado na correção 

aditiva, cujos resultados são o assunto da próxima seção.  

 

 

 

8.7. Desempenho do Método Multigrid na Simulação de 
Reservatórios de Petróleo 

 

Esta seção foi dividida em três partes, de acordo com a natureza do problema físico 

considerado: 

 

(1) Problemas homogêneos resolvidos com IMPES (sistema de uma equação); 

(2) Problemas homogêneos resolvidos com formulação Totalmente Implícita (sistema 

de duas equações); 

(3) Problemas heterogêneos e anisotrópicos resolvidos com IMPES e formulação 

Totalmente Implícita. 

 

Em cada caso, as comparações foram realizadas a partir da solução do sistema linear 

correspondente ao primeiro passo de tempo da simulação, o que parece ser suficiente para 

                                                 
8 O solver GMRES - Generalized Minimal Residual (SAAD, 2000) é um dos métodos iterativos não-
estacionários mais utilizados. A versão utilizada neste trabalho (da biblioteca COI-lib) foi baseada nos 
algoritmos da biblioteca ITL - The Iterative Template Library, que é uma biblioteca genérica de componentes 
que disponibiliza métodos iterativos para a solução de sistemas lineares (http://www.osl.iu.edu/research/itl/ ). 
 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 155 

 

 

inferir conclusões que se aplicam também para a solução dos demais sistemas lineares do 

processo transiente9.  

 

8.7.1. Problemas Homogêneos Resolvidos com IMPES 

 

Este primeiro caso inicia a seção que visa avaliar o potencial do solver multigrid na 

simulação de reservatórios de petróleo, e para tanto utiliza a geometria conhecida como ¼ do 

esquema five-spot (ver Fig. 8.14). Esta geometria foi discretizada com a malha diagonal 

tradicional, isto é, Cartesiana e formada por quadriláteros igualmente espaçados. A solução do 

campo de pressão obtida para o primeiro passo de tempo é a mesma de um escoamento 

monofásico em regime permanente e com propriedades constantes, que resulta em um campo 

de velocidade total como o mostrado na Fig. 8.30. Este escoamento se estabeleceu a partir da 

prescrição de fluxos idênticos, mas com sinais contrários, em dois cantos opostos desta 

geometria (inferior esquerdo e superior direito). Prescreveu-se, em um dos outros cantos, 

pressão igual a zero para assegurar a simetria desta variável no domínio. 

 

 

 
Fig. 8.30 – Campo de velocidade total obtido em uma malha Cartesiana de 15x15 elementos igualmente 

espaçados no problema que representa ¼ do padrão-base do arranjo de poços five-spot 

 
                                                 
9 Inclusive, para o método IMPES, dependendo dos dados utilizados, torna-se necessário resolver apenas o 
primeiro sistema linear da pressão, devendo-se avançar apenas no cálculo explícito da saturação a cada novo 
passo de tempo. Isso é possível quando são utilizadas viscosidades iguais para as fases óleo e água e curvas 
lineares de permeabilidade relativas. 



156 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Este problema foi resolvido integrando as equações de conservação em malhas de 

diferentes razões de refinamento e com dois métodos diferentes: o Método de Volumes 

Finitos (FVM) e o Método de Volumes Finitos baseado em Elementos (EbFVM). O objetivo 

é comparar a eficiência do multigrid na solução do sistema linear da pressão originado em 

cada caso. Deve-se lembrar que o método FVM, quando emprega uma matriz estruturada, 

produz uma matriz de coeficientes com bandas definidas, o que não acontece com o método 

EbFVM, mesmo com malhas regulares. Os dados utilizados no solver multigrid nestas 

comparações estão destacados na Tab. 8.6. Informações adicionais sobre cada um dos 

parâmetros apresentados nesta tabela podem ser obtidas no Cap. 6. 

 

 
Tab. 8.6 – Parâmetros utilizados no multigrid 

Tipo de ciclo F 

Solver-base  Gauss-Seidel 

Número máximo de ciclos 40000 

Número de células para solver direto 50 

Número de iterações no solver iterativo 2 

Número de células em cada bloco grosseiro 7 

  

 
 

A solução fornecida pelo solver será considerada convergida quando apresentar 

diferenças nos valores da pressão menores que 10-4 kPa em relação a uma solução de 

referência (aquela que foi resolvida até atingir a precisão dos erros em nível de máquina). A 

Fig. 8.31 compara os tempos de processamento necessários para os solvers Gauss-Seidel, 

GMRES (pré-condicionado com o SSOR - Symmetric Successive Over Relaxation) e 

multigrid obterem a solução convergida. Para simplificar a leitura, os tempos necessários para 

cada solver obter uma solução convergida dos sistemas lineares provenientes do FVM e do 

EbFVM foram apresentados no mesmo gráfico.  

 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 157 

 

 

Custo ~ N 1.01
R 2 = 0.997

Custo ~ N 2.09
R 2 = 0.999

Custo ~ N 1.94
R 2 = 0.996

1.E-04

1.E-03

1.E-02

1.E-01

1.E+00

1.E+01

1.E+02

1.E+03

1.E+04

1.E+05

1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07

N - Número de incógnitas

C
us

to
 c

om
pu

ta
ci

on
al

 (
s)

Gauss Seidel - FVM Gauss Seidel - EbFVM

GMRES - FVM GMRES - EbFVM

Multigrid - FVM Multigrid - EbFVM

 
Fig. 8.31 – Desempenho de diferentes solvers na solução de sistemas lineares provenientes do Método de 

Volumes Finitos (FVM) e do Método de Volumes Finitos baseado em Elementos (EbFVM) 

 

 

Nota-se na Fig. 8.31 que o método multigrid apresentou um aumento linear do custo 

computacional com o número de incógnitas, como o esperado. O Gauss-Seidel reproduziu o 

comportamento teórico de um aumento quadrático do esforço computacional com o aumento 

da malha. Quanto ao método GMRES, é importante mencionar que é difícil estimar curvas 

gerais, como as obtidas para o multigrid e Gauss-Seidel, por duas razões: primeiro, porque 

depende de diferentes fatores, como o número de condição da matriz (BARRETT et al., 

1994); e, segundo, porque há parâmetros que podem ser ajustados para que possa dar um 

melhor resultado, como o número de restarts. Por isso que, talvez, poder-se-ia melhorar os 

dados de convergência do GMRES destacados na Fig. 8.31, mas o seu estudo está fora do 

escopo deste trabalho. Optou-se em mostrar mesmo assim estes resultados, porque se trata de 

um importante solver mencionado na literatura e porque se espera que os resultados não 

seriam excessivamente modificados se fosse atingida a condição ideal para o GMRES 

funcionar com estas matrizes. 

 

Considerações sobre a aglomeração. Para se ter uma idéia de como os volumes de 

controle são aglomerados na formação das malhas grosseiras, a Fig. 8.32 apresenta a 

visualização dos dois níveis gerados quando uma malha Cartesiana de 25x25 volumes é 

discretizada no problema considerado com o método FVM. Nesta figura são destacadas as 

diferenças entre as malhas grosseiras criadas pelo multigrid quando são formadas pela 



158 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

aglomeração de 4 volumes em cada célula (lado esquerdo da figura) e 7 volumes em cada 

célula (lado direito da figura), que foi a configuração ideal para o caso anterior.  

 Da mesma forma, na Fig. 8.33 são apresentadas as malhas grosseiras originadas a 

partir da discretização com o EbFVM. Não podem ser esperadas aglomerações idênticas às da 

Fig. 8.32 porque no EbFVM os volumes de controle são construídos ao redor dos nós, 

diferentemente, portanto, do FVM onde os volumes de controle e os elementos de malha são 

entidades geometricamente coincidentes. A maior diferença entre as formas das células 

formadas pelo multigrid na solução do sistema linear resultante do EbFVM em relação às 

formadas na discretização FVM está na possibilidade de criação de células que têm volumes 

de controle não-vizinhos, como as que estão destacadas com círculos na Fig. 8.33b. Esse 

assunto já foi considerado na seção 6.4. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 159 

 

 

 
(a) Nível 0 (25x25 volumes) 

 

 

Células com 4 volumes   Células com 7 volumes 

(156 células)    (96 células) 

    
(b) Nível 1 

 

 

(40 células)    (15 células) 

   
(c) Nível 2 

    
Fig. 8.32 – Malha original (a) e malhas grosseiras geradas pelo multigrid (b e c) utilizadas na solução do 

problema descrito na Fig. 8.30 a partir do Método de Volumes Finitos (FVM) 

 



160 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

                    
(a) Nível 0 (625 elementos e 676 nós) 

 

 

Células com 4 volumes   Células com 7 volumes 

(174 células)    (111 células) 

   
(b) Nível 1 

 

 

(44 células)    (23 células) 

  
 (c) Nível 2 

    
Fig. 8.33 - Malha original (a) e malhas grosseiras geradas pelo multigrid (b e c) utilizadas na solução do 

problema descrito na Fig. 8.30 a partir do Método de Volumes Finitos baseado em Elementos (EbFVM) 

 

Células 
formadas com 
volumes não-
vizinhos 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 161 

 

 

Diferentes ciclos e solvers-base. Uma outra análise que também merece ser feita é a 

do desempenho do multigrid empregando diferentes ciclos e solvers-base. Para isso serão 

comparadas as curvas de queda do resíduo das equações discretizadas em EbFVM 

empregando uma malha com 62500 elementos (estruturada de 250 x 250) e 63001 nós, e 

utilizando o mesmo critério de convergência e os dados do problema analisado inicialmente 

nesta seção. A Fig. 8.34 apresenta como a norma Euclidiana do resíduo10, chamada nesta 

figura simplesmente de “Resíduo”, se comporta durante a solução do sistema linear pelo 

multigrid utilizando diferentes solvers-base: Gauss-Seidel (GS) e ILU(0). Para simplificar as 

comparações, o resíduo foi normalizado dividindo-o pelo valor do resíduo calculado antes do 

multigrid iniciar o processo de solução, isto é, calculado com o valor da estimativa inicial de 

pressão. As soluções são apresentadas nesta figura para os ciclos V, W e F, que são aqueles 

definidos na Fig. 6.3, e representam a ordem como as diferentes malhas são resolvidas. 

Como pode ser observado na Fig. 8.34, o desempenho do multigrid praticamente não 

se alterou quando foram utilizados os ciclos W e F, enquanto que com o ciclo V, tempos 

maiores de processamento de máquina foram necessários para atingir os mesmos resíduos, 

não convergindo, inclusive, quando foram utilizadas poucas iterações de Gauss-Seidel. 

Quando foi aumentada a quantidade de iterações do solver-base para o ciclo V, a solução 

convergiu não-monotonicamente em torno de uma linha média. Neste ciclo a utilização do 

solver-base ILU(0) resultou em tempo menores de processamento, ao contrário do que 

aconteceu para os ciclos W e F, onde a utilização do solver-base Gauss-Seidel conferiu 

melhor desempenho ao multigrid. A queda monotônica do resíduo utilizando-se os ciclos W e 

F é uma excelente característica que merece ser salientada. 

 

 

 

                                                 
10 A norma euclidiana do resíduo (norma l2) é definida como a raiz quadrada do somatório dos resíduos de cada 
uma das equações ao quadrado. O resíduo de uma equação está definido na Eq. (6.3). 



162 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
(a) Ciclo V 

 
(b) Ciclo W 

 
(c) Ciclo F 

 
Fig. 8.34 – Comparação entre as curvas de resíduo x tempo de processamento de máquina (Pentium 4 – 1.7 GHz 

– 1 GB RAM) de diferentes ciclos e diferentes solver-base do multigrid: GS - Gauss-Seidel e ILU(0), na solução 

do problema analisado com uma malha de 62500 elementos e 63001 nós. 

 

 

 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 163 

 

 

8.7.2. Problemas Homogêneos Resolvidos com Formulação Totalmente 
Implícita 

 

O desempenho do multigrid na solução de sistemas lineares com matrizes de blocos é 

o tema abordado nesta seção. A formulação Totalmente Implícita resulta em uma matriz de 

coeficientes formada por blocos de dimensão (2x2) para problemas bifásicos como demonstra 

a Eq. (5.29). Por isso o solver multigrid teve de ser implementado de forma generalizada para 

também resolver sistemas que tenham estas características. 

O problema-teste empregado nas comparações é o mesmo da seção anterior (¼ do 

esquema five-spot). Novamente será analisada apenas a solução do primeiro sistema linear do 

transiente. Os dados empregados no multigrid também são os mesmos do caso anterior e são 

apresentados na Tab. 8.6. 

Embora não seja apresentado neste texto, o processo de aglomeração empregado para 

sistemas de blocos resultou em malhas grosseiras similares às obtidas para o IMPES 

apresentadas na seção anterior. Deve-se lembrar que, em função da aglomeração baseada nos 

coeficientes empregada, isso poderia não ter acontecido, uma vez que a matriz de coeficientes 

do IMPES é formada pelos coeficientes da pressão, enquanto a matriz de coeficientes do 

método Totalmente Implícito é formada por derivadas das equações do resíduo. Portanto, 

tratam-se de sistemas lineares de natureza diferente, embora resolvendo o mesmo problema 

físico. Por isso, pode-se afirmar, que o esquema de aglomeração implementado é bastante 

adequado, porque a geometria de uma malha grosseira não deveria depender da forma como 

as equações aproximadas são resolvidas.  

O desempenho do multigrid na solução implícita das equações pode ser visto na Fig. 

8.35, onde é comparado o custo computacional para obter uma solução à medida que a malha 

vai sendo refinada (o número de incógnitas aumenta). Novamente o multigrid apresentou um 

aumento linear do custo computacional com o número de incógnitas do sistema linear. 

 

 



164 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

Custo ~ N 2.06
R 2 = 0.999

Custo ~ N 1.82
R 2 = 0.999

Custo ~ N 1.03
R 2 = 0.999

1.E-04

1.E-03

1.E-02

1.E-01

1.E+00

1.E+01

1.E+02

1.E+03

1.E+04

1.E+05

1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07

N - Número de incógnitas

C
us

to
 c

om
pu

ta
ci

on
al

 (
s)

Gauss-Seidel GMRES Multigrid ACM

 
Fig. 8.35 - Desempenho de diferentes solvers na solução de sistemas lineares com matrizes de blocos 

provenientes do Método de Volumes Finitos baseado em Elementos (EbFVM) 

 

 

 

 A fim de facilitar a comparação do desempenho dos diferentes solvers na solução de 

sistemas lineares com matrizes de coeficientes com e sem blocos, a Fig. 8.36 sobrepõe, em 

um mesmo gráfico, os custos computacionais da resolução do sistema originado pelo IMPES 

(Fig. 8.31) e pelo método Totalmente Implícito (Fig. 8.35). Note que, para esta comparação, 

um mesmo custo computacional é obtido nestes métodos com malhas diferentes porque o 

método Totalmente Implícito produz um sistema linear com o dobro do tamanho do método 

IMPES. O solver multigrid foi o que menos apresentou desempenhos similares na solução de 

sistemas com e sem blocos, o que se verifica no afastamento, embora pequeno, das retas em 

tracejado da Fig. 8.36c. Os outros dois solvers apresentaram essas retas praticamente 

coincidentes. O aumento do esforço computacional do multigrid na solução dos sistemas de 

blocos mostrado na figura pode ser explicado pela existência de procedimentos 

implementados neste solver que atuam exclusivamente neste caso. Um exemplo é o 

procedimento de transformação do sistema linear dos níveis grosseiros para o formato padrão 

de linha comprimida (Compressed Sparse Row), discutido no final do Cap. 6, que torna a 

solução dos solvers-base mais eficiente na resolução de matrizes de blocos. 

 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 165 

 

 

1.E-04

1.E-02

1.E+00

1.E+02

1.E+04

1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07

N - Número de incógnitas

C
us

to
 c

om
pu

ta
ci

on
al

 (
s)

Gauss Seidel - IMPES

Gauss-Seidel - TI

         

1.E-04

1.E-02

1.E+00

1.E+02

1.E+04

1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07

N - Número de incógnitas

C
us

to
 c

om
pu

ta
ci

on
al

 (
s)

GMRES - IMPES

GMRES - TI

 
    (a) Gauss-Seidel          (b) GMRES 

1.E-04

1.E-02

1.E+00

1.E+02

1.E+04

1.E+02 1.E+03 1.E+04 1.E+05 1.E+06 1.E+07

N - Número de incógnitas

C
us

to
 c

om
pu

ta
ci

on
al

 (
s)

Multigrid - IMPES

Multigrid - TI

 
            (c) Multigrid 

 

Fig. 8.36 – Comparação do esforço computacional de diferentes solvers na solução de sistemas lineares de 

blocos (TI – Totalmente Implícito) e sem blocos (IMPES) 

 

 

8.7.3. Problemas Heterogêneos e Anisotrópicos 

 

Conforme já se comentou neste trabalho, há uma menor eficiência de métodos 

iterativos quando as equações discretizadas têm coeficientes de diferentes magnitudes. Nesses 

casos a anisotropia dos coeficientes origina diferentes escalas de tempo de propagação da 

informação, afetando diretamente a convergência. Para superar estas dificuldades foi 

implementada a aglomeração adaptativa no solver multigrid desenvolvido nesta tese que 

possibilita, em problemas heterogêneos e anisotrópicos, a construção de malhas grosseiras 

com transferência de informação homogênea entre as células. 

O problema de estudo está apresentado na Fig. 8.37. Nota-se que o domínio foi 

dividido em quatro regiões de mesma permeabilidade absoluta, onde em apenas duas delas o 



166 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

tensor permeabilidade é isotrópico (cantos direito inferior e esquerdo superior). E como nos 

casos anteriores, prescreveu-se valor de pressão igual a zero no canto inferior direito do 

domínio. Os dados utilizados no solver estão destacados na Tab. 8.7, sendo que os demais 

dados que definem o problema físico são os mesmos da Tab. 8.1, exceto a vazão de injeção e 

o passo de tempo, que adotaram os valores 2,84.10-5 m3/d e 1 d, respectivamente. 

 

 

 
Fig. 8.37 – Caracterização do problema-teste 

 

 
Tab. 8.7 – Parâmetros utilizados no multigrid 

Tipo de ciclo F 

Solver base  Gauss-Seidel 

Número máximo de ciclos 40000 

Número de células para solver direto 50 

Número de iterações no solver iterativo 20 

Número de células em cada bloco grosseiro 4 

 

 

Discretizando o domínio da Fig. 8.37 com uma malha Cartesiana de 625 elementos 

(25x25), os dois níveis grosseiros criados pelo multigrid durante a solução do sistema linear 

estão apresentados na Fig. 8.38. Nesta figura estão apresentados os resultados de dois 

diferentes procedimentos de aglomeração estudados neste trabalho e que resultam em malhas 

grosseiras ligeiramente diferentes, mas que têm um impacto importante na eficiência do 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 167 

 

 

multigrid. O que ocasionou a diferença na geração destas malhas foram as diferentes 

possibilidades de testar as regras de aglomeração descrita na seção 6.4. Se, por exemplo, a 

cada nova célula a ser formada no processo de aglomeração forem testadas as regras apenas 

nos volumes vizinhos livres, ou seja, aqueles que ainda não foram aglomerados em nenhuma 

célula, o resultado é o apresentado na Fig. 8.38a. Esse procedimento é o utilizado no solver 

multigrid de Raw (1996).  

 

 

   
Primeiro nível grosseiro    Segundo nível grosseiro 

(a) Com as regras testadas apenas em volumes vizinhos ainda não aglomerados 
 

   
Primeiro nível grosseiro    Segundo nível grosseiro 

 (b) Com as regras testadas em todos os volumes vizinhos 
 

Fig. 8.38 – Níveis grosseiros originados de uma malha de 25x25 elementos 

 

  

A Fig. 8.38b, por sua vez, apresenta as malhas grosseiras formadas quando é utilizado 

um procedimento um pouco diferente do anterior. A motivação pela mudança é a existência, 

no primeiro caso, Fig. 8.38a, de células horizontais no canto inferior esquerdo e células 



168 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

verticais no canto superior direito que não deveriam existir devido à anisotropia física do 

tensor permeabilidade absoluta (Fig. 8.37) que exigiria uma aglomeração na direção oposta 

em cada caso. Por isso foi testada uma modificação na lógica do processo de aglomeração de 

tal forma que a cada nova célula a ser formada são testadas as regras em todos volumes 

vizinhos, e não só nos livres como no caso anterior. Isso resolveu o problema verificado no 

caso anterior, como demonstra a Fig. 8.38b, mas ao custo da perda da uniformidade das 

células grosseiras na região inferior direita.  

A influência nos resultados da utilização de cada uma das formas de obtenção das 

malhas grosseiras vai ser mostrada na seqüência. Para tanto, não será mais utilizada a malha 

de 25x25 elementos que originou os níveis grosseiros da Fig. 8.38 em função da velocidade 

com que a solução é obtida nesta malha. A experiência mostra que frações muito pequenas de 

segundos não podem ser medidas computacionalmente com muita confiança. Por isso, o 

multigrid foi aplicado na solução do sistema linear maior, referente à discretização em uma 

malha mais refinada de 100x100 elementos (10201 nós). Embora não apresentado, os níveis 

grosseiros desta nova malha têm as mesmas características das malhas grosseiras da Fig. 8.38. 

A Fig. 8.39 apresenta a queda do resíduo com o tempo de processamento empregando-

se diferentes formas de aglomerar as células, em sistemas lineares sem blocos (Fig. 8.39a) e 

com blocos (Fig. 8.39b). Na solução do sistema linear do método IMPES o multigrid divergiu 

quando foi empregada a forma de aglomeração que originou as malhas grosseiras da Fig. 

8.38a. Quando foi utilizada a segunda forma testada neste trabalho o resíduo caiu 

assintoticamente 5 ordens de magnitude no início, como demonstra a Fig. 8.39a, 

apresentando, na seqüência, uma tendência pouco menor de queda com o tempo de 

processamento. Para fins de comparação, é ainda apresentada neste mesmo gráfico a queda do 

resíduo quando a aglomeração é realizada baseando-se apenas em aspectos geométricos da 

malha original. Esse é o esquema empregado em multigrid geométricos. Nota-se que o 

resultado é uma queda brusca do resíduo de apenas uma ordem de magnitude no início, 

apresentando na seqüência, uma queda monotônica muito suave, praticamente uma 

estagnação do resíduo.  

 Na solução de sistemas lineares de blocos (método Totalmente Implícito), o multigrid 

apresentou resultados praticamente insensíveis à questão comentada da aplicação das regras 

na formação das malhas grosseiras, como atesta as curvas bastante semelhantes de queda do 

resíduo da Fig. 8.39b. Deve-se destacar, no entanto, que os resultados obtidos com a 

aglomeração geométrica não são apresentados neste gráfico porque este tipo de aglomeração 

fez com o multigrid divergisse logo nos primeiros ciclos.  



 CAP.  8  – RESULTADOS E COMPARAÇÕES 169 

 

 

                  
            (a) IMPES                        (b) Totalmente Implícito 

 

Fig. 8.39 -  Comparação entre as curvas de resíduo x tempo de processamento de máquina                              

(Pentium 4 – 1.7 GHz – 1 GB RAM) obtidas com diferentes esquemas de aglomeração em uma malha de 

100x100 elementos e 10201 nós. 
 

 

 Discussão. Como visto, a forma como as células são formadas nas malhas grosseiras 

influencia demasiadamente na taxa de convergência do solver. Durante o processo de 

aglomeração, a estratégia de testar as regras apenas nos volumes vizinhos livres parece não 

ser eficaz em alguns casos. Por outro lado, a alternativa testada neste trabalho de aplicar as 

regras em todos os volumes garantiu a convergência nos casos testados. Porém, os resultados 

satisfatórios obtidos com esta abordagem não podem ser considerados gerais a priori, 

devendo-se, portanto, realizar diversos testes adicionais. O que se pode constatar com 

segurança pelos testes realizados é que a aglomeração geométrica não é a indicada para 

problemas heterogêneos e anisotrópicos. E a razão é que a anisotropia dos coeficientes da 

malha original não é “dissipada” nas malhas grosseiras e, segundo Elias et al. (1997),  essa 

anisotropia origina diferentes escalas de tempo de propagação da informação, o que afeta 

diretamente o comportamento da convergência. 

 

 

8.8. Simulação com Elementos Triangulares e 
Quadrangulares e com Refinamento Local 

 

Este capítulo termina apresentando a simulação de um reservatório com dimensões e 

características mais próximas das encontradas em campo a fim de demonstrar as 

potencialidades do método proposto. O domínio foi discretizado utilizando, em uma mesma 



170 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

malha, elementos geométricos triangulares e quadrangulares, com demonstra a Fig. 8.40. 

Percebe-se que problemas com geometrias complexas, como o considerado aqui, podem ser 

tratados com considerável flexibilidade com o método EbFVM. Os triângulos, por exemplo, 

podem ser utilizados em qualquer domínio irregular, podendo os de menores dimensões ser 

posicionados nas regiões mais importantes e de interesse, ou seja, próximo a poços, falhas etc. 

Em outras regiões pode-se utilizar elementos quadriláteros, combinando, desta forma, 

diferentes elementos geométricos a fim de produzir uma malha com boa razão de aspecto. 

 

 

 
 

Fig. 8.40  - Reservatório bidimensional e com falha geológica discretizado com elementos triangulares e 

quadrangulares (1061 nós e 1289 elementos) 

 

 

A matriz porosa do reservatório analisado é considerada homogênea e isotrópica, com 

as propriedades físicas apresentadas na Tab. 8.8. A falha geológica foi modelada de acordo 

com a proposta deste trabalho, isto é, utilizando elementos geométricos de espessura reduzida 

(na média menor que 1 mm) e com baixo valor de permeabilidade absoluta (zero, neste caso). 

A posição da falha geológica e dos poços injetor e produtor é apresentada na Fig. 8.40. As 

curvas de permeabilidade relativa utilizadas são as definidas pelas Eqs. (8.31) e (8.32) com 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 171 

 

 

1.2
w wf s=  e M = 1. O sistema de equações foi resolvido com o método Totalmente Implícito e 

solver multigrid, com o passo de tempo calculado automaticamente. 

 

 
Tab. 8.8  – Propriedades físicas e parâmetros numéricos utilizados 

Porosidade 0,2 

Permeabilidade (isotrópica) 500 mD 

Espessura da camada 1 m 

Viscosidades da água e do óleo 1 cp 

Compressibilidades da água e do óleo 10-4 kPa-1 

swi 0 

sor 0 

Saturação de água inicial 0 

Pressão inicial 150 kPa 

Fatores volume de formação da água e do óleo 
avaliados na pressão inicial 

1 

Vazão de injeção de água no poço injetor 2000 m3/d 

Pressão de fundo no poço produtor 100 kPa 

Índice de poço 1 mD.m 

Passo de tempo inicial 0,28 d 

 

 

Os perfis de saturação de água obtidos para diferentes tempos de simulação são 

apresentados na Fig. 8.41. Nota-se que estes resultados estão qualitativamente reproduzindo o 

comportamento físico esperado. Note também que o refinamento local ao redor dos poços e 

falha geológica pôde ser feito facilmente neste método, não apresentando nenhuma 

incompatibilidade geométrica ou perda de precisão devido a cálculos aproximados do fluxo 

nas interfaces de elementos maiores e menores, o que acontece nos esquemas atualmente 

utilizados pelos simuladores comerciais. Além disso, a simplicidade da representação da falha 

da Fig. 8.40 indica que o EbFVM é realmente promissor na área de simulação de reservatórios 

de petróleo, uma vez que outros tipos de falhas, e mesmo poços com geometrias 

demasiadamente complexas, como os que estão cada vez mais sendo empregados pelas 

empresas de petróleo, podem ser adequadamente representados com as malhas não-

estruturadas utilizadas. 

 



172 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

                 
(a) t = 80 dias      (b) t = 380 dias 

 

                  
(c) t = 680 dias         (d) t = 1940 dias 

 

Fig. 8.41 – Perfis de saturação de água em diferentes tempos de simulação obtidos pelo método proposto para o 

reservatório da Fig. 8.40 

 

 

A fim de ressaltar ainda mais a facilidade como as falhas geológicas são representadas 

no método proposto, o mesmo reservatório da Fig. 8.40 foi simulado atribuindo aos elementos 

que compõem a falha o mesmo valor de permeabilidade do restante do domínio, de modo a 

anular a influência da falha. Isso é feito no arquivo de dados apenas alterando um único valor, 

aquele correspondente à permeabilidade dos elementos da falha. O resultado pode ser visto na 

Fig. 8.42. Note que esta simples alteração eliminou a influência da falha, como devia ser, 

mantendo inalterada a malha. A Fig. 8.41 e a Fig. 8.42 constituem-se em situações limites 

onde a interferência da falha é máxima (completamente selante) ou mínima (completamente 

não-selante), respectivamente. Deve-se ressaltar que, através desta nova metodologia de 

representação de falhas, algumas das atividades do engenheiro de reservatório nos processos 

de ajuste histórico - History Matching (MATTAX e DALTON, 1990) poderá ter uma nova 

abordagem. A razão é que, nas atividades de calibração do modelo, deixou de ser prático 



 CAP.  8  – RESULTADOS E COMPARAÇÕES 173 

 

 

modificar valores de transmissibilidades em malhas não-estruturadas, pois estes valores não 

têm mais um significado físico direto, como discutido no Cap. 7. Fisicamente faz mais sentido 

em malhas não-estruturadas simplesmente alterar os valores de permeabilidade absoluta de 

elementos da falha, como proposto.  

 

 

 

                
(a) t = 80 dias      (b) t = 380 dias 

 

                    
(c) t = 680 dias         (d) t = 1940 dias 

 

Fig. 8.42 – Perfis de saturação de água em diferentes tempos de simulação obtidos pelo método proposto para o 

reservatório da Fig. 8.40 desconsiderando o aspecto selante da falha geológica 



 



175 

Cap.    

9 CCOONNCCLLUUSSÕÕEESS    
 

 

 
Este trabalho teve como contribuição principal o desenvolvimento de um simulador de 

reservatórios de petróleo que utiliza o Método dos Volumes Finitos baseado em Elementos 

(EbFVM) e solver multigrid. Neste método a discretização do domínio é feita em uma forma 

não-estruturada, utilizando elementos triangulares e/ou quadrangulares, possibilitando que 

reservatórios com geometrias complexas possam ser facilmente representados. Além disso, 

por ser um método que é baseado na integração das equações diferenciais na forma 

conservativa em volumes de controle, a conservação da massa é assegurada, permitindo uma 

interpretação direta das equações discretas resultantes. Ao longo dos desenvolvimentos, 

diversos questões, muitas delas controversas na área de petróleo, foram estudadas. As 

conclusões centrais são agora reunidas neste capítulo conclusivo do trabalho.   

 

 

9.1. Síntese das Principais Contribuições 
 
Mostrou-se que o refinamento local é realizado de forma natural no método proposto, 

sem as dificuldades encontradas nos métodos que utilizam malhas estruturadas e que estão 

relacionadas à perda da precisão no cálculo dos fluxos entre blocos localizados na intersecção 

de malhas refinadas e grosseiras.  

Mostrou-se também que o modelo desenvolvido leva a uma clara interpretação da 

transmissibilidade, revelando que triângulos retângulos ou obtusângulos podem ser utilizados 

sem maiores restrições na malha. Isso contraria ao recomendado na literatura que trata do 

método EbFVM tradicional. Mostrou-se que os termos das equações denominados usualmente 

de transmissibilidades podem e precisam assumir valores negativos quando ângulos obtusos 



176 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

aparecem nos elementos triangulares da malha. A prática na área numérica, contudo, tem 

demonstrado que a presença de triângulos muito deformados não é uma boa conduta, mas a 

rejeição de uma malha pautada pela simples análise do sinal destes termos não se justifica. Na 

verdade, foi visto que os erros associados a malhas com elementos com ângulos obtusos têm 

outra origem, que é a forma de obter as equações discretizadas multifásicas a partir de uma 

adaptação da equação diferencial monofásica. Os resultados do método proposto mantiveram-

se fisicamente coerentes mesmo em malhas formadas por elementos de razão de aspecto 

desfavorável, o que não ocorreu com os métodos tradicionais, que chegaram a apresentar 

inversão do sentido dos fluxos quando triângulos demasiadamente obtusos foram utilizados. 

O armazenamento das propriedades nos elementos da malha e a representação de 

falhas geológicas através dos elementos foi a única opção que mostrou ser compatível com as 

funções de interpolação do método EbFVM. As oscilações nos resultados obtidos quando as 

propriedades são armazenadas nos volumes de controle e com as falhas geológicas 

posicionadas nas suas interfaces podem ser consideradas um reflexo da utilização de um 

esquema de interpolação que não é adequado para situações de descontinuidades de funções 

dentro do elemento. Ao armazenar as propriedades nos elementos, conforme proposto nesta 

tese, pode-se trabalhar com os mapas de permeabilidade absoluta resultantes do processo de 

mudança de escala sem a necessidade de cálculo de médias. Nos simuladores de reservatórios 

de petróleo com malhas estruturadas, este cálculo é usual e pode resultar em erros, conforme 

relatado em alguns trabalhos na literatura. Além disso, no método proposto é direta a inclusão 

do tensor permeabilidade completo, o que é uma importante característica na simulação de 

reservatórios heterogêneos e anisotrópicos. Os cálculos realizados elemento a elemento, uma 

prática ainda não difundida na área de volumes finitos, possibilitaram a construção de um 

esquema mais geral, com uma implementação mais limpa e ágil em termos de manutenção e  

reusabilidade. 

Foi mostrado neste trabalho que, para altas razões de mobilidade, os efeitos de 

orientação de malha são sensivelmente mais acentuados nos métodos tradicionais do que no 

método proposto, ambos com mesmo esquema de avaliação das mobilidades, o upwind. Isso 

indica que o efeito adicional que contaminou os resultados do EbFVM tradicional deve-se à 

forma como são obtidas suas equações multifásicas discretizadas, isto é, através da adaptação 

da equação monofásica. Quando são utilizadas as equações discretizadas provenientes da 

integração das equações diferenciais multifásicas, que é o procedimento usual do Método de 

Volumes Finitos, o único efeito de orientação de malha remanescente tem origem na função 



 CAP.9 – CONCLUSÕES 177 

 

 

de interpolação de baixa ordem utilizada. Ao ser utilizada outra função de interpolação das 

mobilidades na equação da pressão, o efeito de orientação de malha resultante é menor.  

O método multigrid implementado nesta tese para a resolução dos sistemas lineares 

provenientes do método IMPES e da formulação Totalmente Implícita apresentou 

características que o recomendam também em aplicações de simulação de reservatórios de 

petróleo. Entre as suas características positivas está o aumento linear do custo computacional 

com o número de incógnitas, o que não se verificou em nenhum dos outros solvers estudados. 

O multigrid com ciclo F apresentou os menores tempos de processamento e queda 

monotônica dos resíduos com o tempo. Embora analisando um número limitado de casos 

nesta tese, a robustez deste solver pode ser vista, uma vez que o seu desempenho praticamente 

não se alterou em problemas anisotrópicos e heterogêneos, graças ao esquema de aglomeração 

adaptativa utilizado. O multigrid também resolveu sistemas lineares com e sem blocos com 

desempenhos similares. Foi mostrado, por outro lado, que a aglomeração baseada apenas nos 

aspectos geométricos da malha produz malhas grosseiras que diminuem o desempenho do 

solver, principalmente em problemas anisotrópicos.  

Para reunir todos estes desenvolvimentos e testá-los, um simulador de reservatórios de 

petróleo foi desenvolvido. Este simulador pode ser usado, em função de suas características 

construtivas, além da continuidade nas atividades de pesquisa, como um simulador didático 

para ensino dos fundamentos da simulação de reservatórios de petróleo.  

 

 

9.2. Sugestões para Trabalhos Futuros 
   

Embora o refinamento local seja um procedimento natural e direto no EbFVM, é 

importante destacar que a possibilidade de utilizar elementos com número variável de nós é 

outra característica promissora neste método e que pode aumentar ainda mais a flexibilidade 

da discretização espacial. Foram apresentadas as premissas de um método baseado em 

elementos (Anexo 1) que emprega elementos quadriláteros construídos com uma quantidade 

de nós variando de 4 a 8. Essa alternativa poderá simplificar a representação de reservatórios 

com falhas e com geometrias altamente complexas. Esse é um assunto que merece uma 

investigação maior em trabalhos futuros. 

Recomenda-se estudar mais profundamente o impacto nos resultados da média 

volumétrica ponderada da porosidade presente no termo transiente. Esta média é necessária 



178 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

quando as propriedades como permeabilidade absoluta e porosidade são armazenadas nos 

elementos, e representa o custo de não precisar mais realizar médias na permeabilidade 

absoluta, este último um procedimento usual na área. 

Uma outra sugestão é resolver as equações do EbFVM com o Método Adaptativo 

Implícito (AIM) no lugar do IMPES e da formulação Totalmente Implícita. Com este método, 

pode-se reduzir significativamente o tempo computacional e a capacidade de armazenamento, 

em função do tratamento explícito que boa parte dos volumes de controle podem receber 

dependendo de um critério de estabilidade. 

A combinação do EbFVM com outros métodos também pode ser uma alternativa 

promissora. Pode-se citar como exemplo a utilização do EbFVM na resolução da equação da 

pressão no método streamlines, empregando-se maiores passos de tempo e resolvendo 

rapidamente uma equação semi-analítica unidimensional para a saturação em intervalos de 

tempo menores.  

A utilização de funções upwind bidimensionais em elementos triangulares é algo que 

ainda não foi testado na literatura. Isso possivelmente contribuiria para eliminar 

completamente o efeito de orientação de malha. Conforme já discutido neste texto, estas 

funções já foram empregadas em outros trabalhos para elementos quadriláteros e baseiam-se 

na direção das linhas de correntes, ficando, portanto, menos vinculadas às linhas da malha. 

Como há um custo computacional adicional neste caso, há uma necessidade de avaliar se esse 

aumento do tempo de processamento não inviabiliza a sua aplicação prática, principalmente 

em malhas não-estruturadas, pois uma orientação randômica de elementos pode, por si só, 

contribuir para amenizar, em parte, o efeito de orientação de malha.  

Nenhuma prova matemática de convergência do método numérico desenvolvido foi 

realizada. Como pode ser visto na literatura de forma geral, este tipo de análise não é usual e, 

muito menos, trivial no escopo do método de volumes finitos. Esse método se suporta 

fundamentalmente na consistência de soluções de problemas complexos. A demonstração da 

convergência da aproximação numérica empregada foge do escopo do presente trabalho e fica 

como sugestão para trabalhos futuros. 

Quanto ao solver multigrid desenvolvido nesta tese, é necessário um estudo mais 

aprofundado a fim de torná-lo ainda mais robusto e eficiente. O multigrid presente em um dos 

mais importantes softwares de CFD da atualidade foi testado nos mais diversos problemas, 

por longos períodos, o que contribuiu fortemente para melhorar ainda mais o seu desempenho 

(RAW, 1996). Portanto, não é possível afirmar, a partir do número limitado de testes 

efetuados nesta tese, que o solver desenvolvido neste trabalho e seus parâmetros utilizados 



 CAP.9 – CONCLUSÕES 179 

 

 

são os ideais para a maior parte dos problemas de simulação de reservatórios. É importante 

ainda submetê-lo a uma bateria mais completa de testes específicos a fim de definir qual é a 

configuração que atende satisfatoriamente uma gama mais abrangente de problemas físicos. 

Além disso, a eficiência do multigrid algébrico poderia aumentar ainda mais se fossem 

empregadas outras técnicas que parecem promissoras, como o processamento paralelo 

(ZHAO et al., 2004). 

Embora a forma de obtenção das equações das malhas grosseiras empregada neste 

trabalho tenha apresentado resultados satisfatórios, recomenda-se estudar alternativas que 

resultem em valores mais adequados das correções. Deve-se lembrar que o esquema utilizado 

neste trabalho consiste em anular o somatório dos resíduos nos blocos, o que pode acarretar 

em módulos de resíduos locais elevados. Talvez um método que minimize o somatório dos 

módulos dos resíduos nos blocos das malhas grosseiras poderia ser uma melhor alternativa. 

No entanto, o custo computacional associado à obtenção dos valores mínimos normalmente é 

alto. Apenas um estudo mais profundo poderia demonstrar a sua viabilidade prática. 

Como o formato final da matriz de coeficientes de um sistema linear depende 

diretamente da forma como os nós são numerados, e conseqüentemente, da ordenação das 

equações, pode-se mostrar que a forma como as equações são ordenadas afeta a velocidade de 

convergência dos métodos de resolução de sistemas lineares (AZIZ e SETTARI, 1979). Por 

isso seria importante um estudo que relacionasse a eficiência do solver multigrid e a forma 

como a matriz de coeficientes está organizada. 

 

 

9.3. Considerações Finais 
 

Na última década, o hardware sofreu mudanças drásticas, possibilitando que muita 

informação pudesse ser manipulada e com rapidez. O software, de uma maneira geral, tem 

acompanhado essa tendência. Contudo, neste intervalo de tempo houve um grande esforço de 

pesquisa dedicado às ferramentas já disponíveis nos simuladores comerciais, sendo poucos os 

trabalhos que apresentaram novas metodologias e novos modelos numéricos conservativos 

(TAMIN et al. 1999). Assim, existe grande necessidade e oportunidades de pesquisa nesta 

área. O trabalho desenvolvido nesta tese enquadra-se nesse contexto, sendo este um passo 

preliminar rumo ao desenvolvimento de um simulador mais completo, isto é, tridimensional, 

composicional e com malhas não-estruturadas. A elaboração de um software robusto para uso 



180 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

no dia-a-dia da engenharia de simulação de reservatórios que equacione, dentro dos requisitos 

do problema, os fenômenos físicos importantes, é o grande desafio. Estes princípios foram 

norteadores no desenvolvimento deste trabalho. 

 

 

 



181 

RREEFFEERRÊÊNNCCIIAASS  BBIIBBLLIIOOGGRRÁÁFFIICCAASS  
 

 
AAVATSMARK, I., REISO, E., REME, H. and TEIGLAND, R., 2001. MPFA for Faults and 

Local Refinements in 3D Quadrilateral Grids with Application to Field Simulations, SPE 

paper 66356 presented at the Reservoir Simulation Symposium, 11-14 February, Houston, 

Texas. 

APPEL, C. A., 1976. A Note on Computing Finite-Difference Interblock Transmissibilities, 

Water Resour. Res., v. 12, n. 3, p. 561-563. 

AZIZ, K. and SETTARI, A., 1979. Petroleum Reservoir Simulation, Applied Science 

Publishers, London. 

BAJOR, O. and CORMACK, D. E., 1989. A New Method for Characterizing the Grid 

Orientation Phenomenon, SPE paper 19353, Society of Petroleum Engineering. 

BAKER, R.O., KUPPE, F., CHUGH, S., BORA, R., STOJANOVIC, S. and BATYCKY, R., 

2002. Full-Field Modeling Using Streamline-Based Simulation: Four Case Studies, SPE 

Reservoir Evaluation &amp;amp; Engineering Journal, April, pp. 126-134. 

BAKHVALOV, N. S., 1966. On the Convergence of a Relaxation Method Under Natural 

Constraints on an Elliptic Operator, USSR Comput. Math. Math. Phys., 6(5):101-135. 

BALIGA, B. R. and PATANKAR, S. V., 1983. A Control Volume Finite-Element Method 

for Two-Dimensional Fluid Flow and Heat Transfer, Numerical Heat Transfer, vol. 6, pp. 

245-261. 

BANASZEK, J., 1995. Some Theoretical and Practical Aspects of Efficient Modelling of 

Heat Transfer Phenomena on Finite Element Grid, Bulletin of Institute of Heat 

Engineering, No.79, pp. 57-90. 

BARRETT, R., BERRY, M., CHAN, T. F., DEMMEL, J., DONATO, J., DONGARRA, J., 

EIJKHOUT, V., POZO, R., ROMINE, C.  and VAN DER VORST, H., 1994. Templates 

for the Solution of Linear Systems: Building Blocks for Iterative Methods, 2nd Ed., SIAM, 

Philadelphia, PA. 



182 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

BASTIAN, P. and HELMIG, R., 1999. Efficient Full-Coupled Solution Techniques for Two-

Phase Flow in Porous Media – Parallel Multigrid Solution and Large Scale Computations, 

Advances in Water Resources, 23, pp. 199-216. 

BASTIAN, P., 2003. Higher Order Discontinuous Galerkin Methods for Flow and Transport 

in Porous Media, in Challenges in Scientific Computing - CISC 2002, number 35 in 

LNCSE, pp. 1-22. 

BATYCKY, R. P., BLUNT, M. J.  and THIELE, M. R., 1997. A 3D Field-Scale Streamline-

Based Reservoir Simulator, SPE Reservoir Engineering, Vol. 12, Number 4, November, 

pp. 246-254. 

BEHIE, A. and FORSYTH, P. A., 1983a. Multigrid Solution of the Pressure Equation in 

Reservoir Simulation, SPE J, pp. 623-632, August. 

BEHIE, A. and FORSYTH, P. A., 1983b. Multi-Grid Solution of Three Dimensional 

Problems with Discontinuous Coefficients, Appl. Math. Comp., 13 (1983) 229-240. 

BLAIR, P. M. and WEINAUG, C. F., 1969. Solution of Two-Phase Flow Problems Using 

Implicit Difference Equations, SPE Journal, pp. 417-424; Trans., AIME, 246. 

BRANCO, C. M. and RODRIGUEZ, F., 1996. A Semi-Implicit Formulation for 

Compositional Reservoir Simulation, SPE Applied Technology Series, Vol 4, Number 1, 

May, pp. 171-177. 

BRANDT, A., 1973.  Multi–level Adaptive Technique (MLAT) for Fast Numerical Solution 

to Boundary Value Problems, in Proceedings of the Third International Conference on 

Numerical Methods in Fluid Mechanics, H. Cabannes and R. Teman, eds., vol. 18 of 

Lecture Notes in Physics, Berlin, Springer–Verlag, pp. 82–89. 

BRANDT, A., MCCORMICK, S. F. and RUGE, J. W., 1982. Algebraic Multigrid (AMG) for 

Automatic Multigrid Solution with Application to Geodetic Computations, Technical 

Report, Institute for Computational Studies, Colorado State University. 

BRIGGS, W. L., HENSON, V. E. and McCORMICK, S., 2000. A Multigrid Tutorial, 2nd 

edition,  SIAM Books, Philadelphia. 



 REFERÊNCIAS BIBLIOGRÁFICAS 183 

 

 

CAI, Z., J. JONES, S. MCCORMICK, T. RUSSELL, 1997. Control-Volume Mixed Finite 

Element Methods, Computational Geosciences, vol.1, pp. 289-315.   

CAILLABET, Y., MAGRAS, J. F. and  RICOIS, O., 2003. Large Compositional Reservoir 

Simulations with Parallelized Adaptive Implicit Methods, SPE paper 81501 presented at 

the SPE Middle East Oil Show, 9-12 June, Bahrain. 

CAO, H. and AZIZ, K., 2002. Performance of IMPSAT and IMPSAT-AIM Models in 

Compositional Simulation, SPE paper 77720 presented at the SPE Annual Technical 

Conference and Exhibition, San Antonio, Texas, 29 September-2 October.  

CASTELLINI, A., 2001. Flow Based Grids for Reservoir Simulation, Master thesis, Stanford 

University. 

CHEN, Y., DURLOFSKY, L. J., GERRITSEN, M. and WEN, X. H., 2003. A Coupled Local-

Global Upscaling Approach for Simulating Flow in Highly Heterogeneous Formations, 

Advances in Water Resources, 26:1041-1060. 

CIMENT, M. and SWEET, R. A., 1973. Mesh Refinements for Parabolic Equations,  

Journal of Computational Physics, Volume 12, Issue 4, August, Pages 513-52. 

CLEARY, A. J., FALGOUT, R. D., HENSON, V. E., JONES, J. E., MANTEUFFEL, T. A., 

MCCORMICK, S. F., MIRANDA, G. N. and RUGE, J. W., 1999. Robustness and 

Scalability of Algebraic Multigrid. SIAM J. Sci. Comput. 21, 5, Dec, 1886-1908.  

COATS, K. H., 1968. Computer Simulation of Three-Phase Flow in Reservoirs, University of 

Texas, Austin, Texas. 

COATS, K. H., 2000. A Note on IMPES and Some IMPES Based Simulation Models, SPE 

Journal,  Vol. 5, N. 3, pp. 245-251. 

COATS, K. H., 2003. IMPES Stability: Selection of Stable Timesteps, SPE Journal, Vol. 8, 

Number 2, June, pp. 181-187. 

COLLINS, D. A. and MOURITS, F. M., 1991. Multigrid Methods Applied to Near-Well 

Modeling in Reservoir Simulation, SPE paper 23607. 



184 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

COLLINS, D. A., NGHIEM, L.X., LI, Y. K. and GRABONSTOTTER, J.E., 1986. An 

Efficient Approach to Adaptive-Implicit Compositional Simulation with an Equation of 

State, SPE Reservoir Engineering, May, pp. 259-264. 

COOK, R. D., MALKUS, D. S. and PLESHA, M. E., 1989. Concepts and Applications of 

Finite Elements Analysis, 3rd Ed., John Wiley &amp;amp; Sons, New York. 

CORDAZZO, J., HURTADO, F. S. V., MALISKA, C. R. and SILVA, A. F. C., 2004a. The 

Negative Transmissibility Issue When Using CVFEM in Petroleum Reservoir Simulation 

– 1. Theory, Proceedings of the 10o.  Brazilian Congress of Thermal Sciences and 

Engineering – ENCIT, Rio de Janeiro. 

CORDAZZO, J., HURTADO, F. S. V., MALISKA, C. R. and SILVA, A. F. C., 2004b. The 

Negative Transmissibility Issue When Using CVFEM in Petroleum Reservoir Simulation 

– 2. Results, Proceedings of the 10o. Brazilian Congress of Thermal Sciences and 

Engineering – ENCIT, Rio de Janeiro. 

CORDAZZO, J., MALISKA, C. R. and SILVA, A. F. C., 2002. Interblock Transmissibility 

Calculation Analysis for Petroleum Reservoir Simulation,  in proceedings of the 2nd 

Meeting on Reservoir Simulation, Universidad Argentina de la Empresa, Buenos Aires, 

Argentina,  November 5-6. 

COUTINHO, A. L. G. A., DIAS, C. M., ALVES, J. L. D., LANDAU, L., LOULA, A. F. D., 

MALTA, S. M. C., CASTRO, R. G. S. and GARCIA, E. L. M., 2004. Stabilized Methods 

and Post-Processing Techniques for Miscible Displacements, Computer Methods in 

Applied Mechanics and Engineering, v. 193, issues 15-16, pp. 1421-1436.  

CRUMPTON, P. I., SHAW, G. F. and WARE, F., 1995. Discretisation and Multigrid 

Solution of Elliptic Equations with Mixed Derivative Terms and Strongly Discontinuous 

Coefficients, Journal of Computational Physics,  v. 116, pp. 343-358. 

DAKE, L. P., 2001. The Practice of Reservoir Engineering. Revised Edition. Elsevier Science 

B. V. Amsterdam, The Netherlands. 

DARCY, H., 1856. Les Fontaines Publiques de la Ville de Dijon, Paris (reprinted in  

Hubbert, M. K., 1969. The Theory of Ground-Water Motion and Related Papers. Hafner 

Publishing Company, New York and London). 



 REFERÊNCIAS BIBLIOGRÁFICAS 185 

 

 

DARLOW, B.L., EWING, R.E., and WHEELER, M.F., 1984. Mixed Finite Element Method 

for Miscible Displacement Problems in Porous Media, SPE Journal, August, pp. 391-398. 

DEMBO, R. S. EISENSTAT, S. C. and STEIHAUG, T., 1982. Inexact Newton Methods, 

SIAM J. Numer. Anal., vol.19, pp. 400-408. 

DENDY Jr., J. E., MCCORMICK, S. F., RUGE, J. W. and RUSSELL, T. F., 1989. Multigrid 

Methods for Three-Dimensional Petroleum Reservoir Simulation, SPE paper 18409 

presented at the SPE Symposium on Reservoir Simulation, 6-8 February, Houston, Texas. 

DOUGLAS, J, FURTADO, and PEREIRA, F., 1997. On the Numerical Simulation of 

Waterflooding of Heterogeneous Petroleum Reservoirs, Computational Geosciences, Vol. 

1, pp. 155-190. 

DYKE, K. V., 1997. Fundamentals of Petroleum, 4th Ed., Petroleum Extension Service, 

Continuing &amp;amp; Extended Education, The University of Texas at Austin, Texas. 

ECLIPSE Technical Description, 2004. Sugar Land, TX: Schlumberger Information Systems. 

EDWARDS, M. G. and ROGERS, C. F., 1998. Finite Volume Discretization with Imposed 

Flux Continuity for the General Tensor Pressure Equation, Computational Geosciences 2, 

pp. 259-290. 

EDWARDS, M. G., 2003. Control-Volume Distributed Sub-Cell Flux Schemes for 

Unstructured and Flow Based Grids, SPE paper 79710 presented at the Reservoir 

Simulation Symposium, 3-5 February, Houston, Texas. 

EDWARDS, M. G., ELF, R. A. and AZIZ, K., 1998. Quasi K-Orthogonal Streamline Grids: 

Gridding and Discretization, SPE paper 49072 presented at the Annual Technical 

Conference and Exhibition, 27-30 September, New Orleans, Louisiana. 

ELIAS, S. R., 1993. Enhancements to Additive Correction Multigrid, Master thesis, 

University of Waterloo, Canada. 

ELIAS, S. R., STUBLEY, G. D. and RAITHBY, G. D., 1997. An Adaptive Agglomeration 

Method for Additive Correction Multigrid, International Journal for Numerical Methods 

in Engineering, Vol. 40, pp. 887-903. 



186 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

FAGIN, R. G. and STEWART Jr., C. H., 1966. A New Approach to the Two-Dimensional 

Multiphase Reservoir Simulator, SPE Journal, June, pp. 175 – 182. 

FEDORENKO, R. P., 1964. The Speed of Convergence of One Iteration Process, USSR 

Computational Math. and Math. Physics, Vol. 4, pp. 227-235. 

FLEMING, G. C., 1987. Modeling the Performance of Fractured Wells in Pattern Floods 

Using Orthogonal, Curvilinear Grids, SPE paper 16973 presented at the Annual Technical 

Conference and Exhibition, 27-30 September, Dallas, Texas. 

FORSYTH, P., 1990. A Control-Volume, Finite-Element Method for Local Mesh Refinement 

in Thermal Reservoir Simulation, SPE Reservoir Engineering, November, pp. 561-566. 

FRAUENTHAL, J. C., di FRANCO, R. B. and TOWLER, B. F. T., 1985. Reduction of Grid-

Orientation Effects in Reservoir Simulator with Generalized Upstream Weighting, SPE 

Journal, 902-908, December.  

FUNG, L. S. K., BUCHANAN, W. L. and SHARMA, R., 1993. Hybrid-CVFE Method for 

Flexible Grid Reservoir Simulation, SPE paper 25266 presented at the 12th SPE 

Symposium on Reservoir Simulation, New Orleans, LA, February 28-March 3. 

FUNG, L. S., HIEBERT, A. D. and NGHIEM, L., 1991. Reservoir Simulation With a 

Control-Volume Finite-Element Method, SPE paper 21224 presented at the 11th SPE 

Symposium on Reservoir Simulation, Anaheim, California, February 17-20. 

GERRITSEN, M. G. and DURLOFSKY, L. J., 2005. Modeling Fluid Flow in Oil Reservoirs, 

Annual Review of Fluid Mechanics, v. 37, pp. 211-238.  

GOLDTHORPE, W. H. and CHOW, Y. S., 1985. Unconventional Modelling of Faulted 

Reservoirs: A Case Study, SPE paper 13526 presented at the Reservoir Simulation 

Symposium, 10-13 February, Dallas, Texas. 

GOTTARDI, G. and DALL´OLIO, D., 1992. A Control-Volume Finite-Element Model for 

Simulating Oil-Water Reservoirs, Journal of Petroleum Science and Engineering, 8, 29-

41, Elsevier Science Publishers B. V., Amsterdam. 

GREENKORN, R. A., 1983. Flow Phenomena in Porous Media, Marcel Dekker, New York. 



 REFERÊNCIAS BIBLIOGRÁFICAS 187 

 

 

HEINEMANN, Z. E., BRAND, C. W., MARGIT, M. and CHEN, Y. M., 1991. Modeling 

Reservoir Geometry With Irregular Grids, SPE Reservoir Engineering, May, pp. 225-232. 

HEINEMANN, Z. E., GERKEN, G. and VON HANTELMANN, G., 1983. Using Local Grid 

Refinement in a Multiple-Application Reservoir Simulator, SPE paper 12255 presented at 

the Reservoir Simulation Symposium, 15-18 November, San Francisco, California. 

HIRASAKI, G. J. and O'DELL, P. M., 1970. Representation of Reservoir Geometry for 

Numerical Simulation, SPE Journal, December, pp. 393-404. 

HUBER, R. U. and HELMIG, R., 1999. Multiphase Flow in Heterogeneous Porous Media: A 

Classical Finite Element Method Versus an IMPES-based Mixed FE/FV Approach, 

International Journal for Numerical Methods in Fluids, v. 29, pp. 899-920.  

HUGHES, T. J. R., 1987. The Finite Element Method, Linear Static and Dynamic Finite 

Element Analysis, Prentice Hall, New Jersey. 

HURTADO, F. S. V., 2005. Uma Formulação de Volumes Finitos baseada em Elementos 

para a Simulação do Deslocamento Bifásico Imiscível em Meios Porosos, Dissertação de 

Mestrado em Engenharia Mecânica, UFSC, Florianópolis, SC.  

HURTADO, F. S. V., MALISKA, C. R., SILVA, A. F. C., AMBRUS, J., CONTESSI, B. A. 

and CORDAZZO, J., 2004. Development of a Laboratory Data Interpretation Software for 

Determination of Relative Permeability Curves by a Parameter Estimation Method, 

Proceedings of the Rio Oil &amp;amp; Gas 2004 Expo and Conference, Rio de Janeiro, October 4-

7. 

HUTCHINSON, B. R. and RAITHBY, G. D., 1986. A Multigrid Method Based on the 

Additive Correction Strategy, Numerical Heat Transfer, vol. 9, pp. 511-537. 

IMEX, Version 2002 User’s Guide. Computer Modelling Group Ltd, Calgary, Alberta, 

Canada. 

JAYANTHA, P. A. and  TURNER, I. W., 2001. A Comparison of Gradient Approximations 

for Use in Finite-Volume Computational Models for Two-Dimensional Diffusion 

Equations, Numerical Heat Transfer, Part B, vol. 40,  pp. 367-390. 



188 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

JOSUTTIS, N. M., 1999. The C++ Standard Library  - A Tutorial and Reference, Addison-

Wesley, U.S.A. 

KOCBERBER, S., 1995. An Automatic, Unstructured Grid-Generation System for 

Geologically Complex Reservoirs, SPE paper 28245 presented at the 1994 SPE 

Petroleum Computer Conference, Dallas, July 31-Aug.3. 

KULKARNI, R., WATSON, A. T., NORDTVEDT, J. and SYLTE, A., 1998. Two-Phase 

Flow in Porous Media: Property Identification and Model Validation, AIChE Journal, 

Vol. 44, No. 11, 2337-2350.  

KUWAUCHI, Y, ABBASZADEH, M., SHIRAKAWA, S. and YAMAZAKI, N., 1996. 

Development and Applications of a Three Dimensional Voronoi-Based Flexible Grid 

Black Oil Reservoir Simulator, SPE paper 37028 presented at the SPE Asia Pacific Oil &amp;amp; 

Gas Conference, Adelaide, Australia, 28-31 October. 

LAKE, L, W., 1989. Enhanced Oil Recovery, Prentice-Hall, New Jersey. 

MALISKA, C. R., 2004. Transferência de Calor e Mecânica dos Fluidos Computacional, 2ª.   

Edição revista e ampliada, Livros Técnicos e Científicos Editora, Rio de Janeiro. 

MALISKA, C. R., CUNHA, A. R., LIVRAMENTO, M. A. and SILVA, A. F. C., 1994. 

Tridimensional Petroleum Reservoir Simulation Using Generalized Curvilinear Grids, in 

proceedings do V ENCIT, São Paulo, Dezembro, pp. 363-366. 

MALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., CEMIN, A. Jr. e HURTADO, F. S. V., 

2004. Guia de Procedimentos para Simulação com Malhas Não-Estruturadas no STARS, 

Relatório Final, Projeto “Malhas não-estruturadas para simulação de reservatórios – 

Desenvolvimento de um núcleo numérico, estudos de malhas não-estruturadas e extensão 

do programa Ciclope”, Outubro, Laboratório de Simulação Numérica em Mecânica dos 

Fluidos e Transferência de Calor – SINMEC, ESSS e CENPES/Petrobras. 

MALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., R, MENDES, R. e CEMIN, A. Jr.,  

2002. Guia de Procedimentos para Interpretação de Transmissibilidades em Malhas 

Utilizadas no IMEX, Relatório Final, Projeto “Malhas volumétricas para a simulação de 

reservatórios de petróleo – Análise numérica e programa de conversão”, Agosto, 

Laboratório de Simulação Numérica em Mecânica dos Fluidos e Transferência de Calor – 

SINMEC, ESSS e CENPES/Petrobras. 



 REFERÊNCIAS BIBLIOGRÁFICAS 189 

 

 

MALISKA, C. R., SILVA, A. F. C., CORDAZZO, J., SILVA, R. F. A. R, MENDES, R. e 

CEMIN, A. Jr.,  2001. Malhas Volumétricas para Simulação de Reservatórios de 

Petróleo, 1º. Relatório, Projeto “Malhas volumétricas para a simulação de reservatórios de 

petróleo – Análise numérica e programa de conversão”, Junho, Laboratório de Simulação 

Numérica em Mecânica dos Fluidos e Transferência de Calor Calor – SINMEC, ESSS e 

CENPES/Petrobras.. 

MARCONDES, F., 1996. Solução Numérica Usando Métodos Adaptativos-Implícitos e 

Malha de Voronoi de Problemas de Reservatórios de Petróleo, tese de doutoramento, 

Universidade Federal de Santa Catarina, Florianópolis, SC. 

MARCONDES, F., ZAMBALDI, M. C. e MALISKA, C. R., 1994. Simulação Numérica de 

Reservatórios de Petróleo Utilizando Malhas de Voronói, V Encontro Nacional de 

Ciências Térmicas e II Simpósio de Engenharia Térmica, São Paulo. 

MASCHIO, C. and SCHIOZER, D. J., 2002. Analysis of the Performance of Streamline 

Simulation, proceedings of 2nd Meeting on Reservoir Simulation, Buenos Aires, 

Argentina, November 5-6.  

MATTAX, C. C. and DALTON, R. L., 1990. Reservoir Simulation. SPE Monograph Series, 

Vol 13, Society of Petroleum Engineers, Richardson,TX. 

McCAIN W. D. Jr., 1990. The Properties of Petroleum Fluids, 2nd edition, Tulsa, Oklahoma, 

USA: PennWell Publishing Co. Inc. 

MEJIA, G. M., MOHANTY, K. K. and WATSON, A. T., 1995. Use of in Situ Saturation 

Data in Estimation of Two-Phase Flow Functions in Porous Media, Journal of Petroleum 

Science and Engineering, 12, 233-245. 

MLACNIK, M. J. HARRER, A. W. and HEINEMANN, Z. E., 2003. Locally Streamline-

Pressure-Potential-Based PEBI Grids, SPE paper 79684 presented at the Reservoir 

Simulation Symposium, 3-5 February, Houston, Texas. 

MOTA, M. A. A., 1994. Simulação Numérica de Reservatórios de Petróleo Utilizando 

Coordenadas Generalizadas e Esquema de Interpolação TVD, Dissertação de Mestrado 

em Engenharia Mecânica, UFSC, Florianópolis, SC.  

NASH, S. G., 1990. A History of Scientific Computing. Addison-Wesley, USA. 



190 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

PALAGI, C. L. and AZIZ, K., 1991. Use of Voronoi Grid in Reservoir Simulation, SPE paper 

22889 presented at the 66th Annual Technical Conference and Exhibition, Dallas, TX, 

October 6-9. 

PALAGI, C., 1992. Generation and Application of Voronoi Grid to Model Flow in 

Heterogeneous Reservoir, Doctor Thesis, Stanford University, California.  

PARSONS, I. D. and Coutinho, A. L. G. A., 1999. Finite Element Multigrid for Two-Phase 

Immiscible Flow in Heterogeneous Media, Communications in Numerical Methods in 

Engineering, vol. 15, pp. 1-7. 

PATANKAR, S. V., 1980. Numerical Heat Transfer and Fluid Flow, Hemisphere Publishing 

Corporation, Washington. 

PEACEMAN, D. W., 1977. Fundamentals of Numerical Reservoir Simulation, Elsevier 

Scientific Publishing Company, Amsterdan, The Netherlands. 

PEDROSA Jr., O. A. and AZIZ, K., 1986. Use of a Hybrid Grid in Reservoir Simulation, SPE 

Reservoir Engineering, November, pp. 611-621. 

PETTERSEN, O., 1983. Finite-Difference Representation of Permeabilities in Heterogeneous 

Models, SPE paper 12340 presented at SPE Fall Meeting, Dallas, Texas. 

PHILIPS, R. E. and SCHMIDT, F. W., 1984. Multigrid Techiniques for the Numerical 

Solution of the Diffusion Equation, Numerical Heat Transfer, vol. 7, pp. 251-268. 

PRÉVOST, M., EDWARDS, M. G. and BLUNT, M. J., 2001. Streamline Tracing on 

Curvilinear Structured and Unstructured Grids, SPE paper 66347 presented at the 

Reservoir Simulation Symposium, 11-14 February, Houston, Texas. 

QUANDALLE, P. and SAVARY, D., 1989. An Implicit in Pressure and Saturations 

Approach to Fully Compositional Simulation, SPE paper 18423 presented at the SPE 

Symposium on Reservoir Simulation, 6-8 February, Houston, Texas. 

QUANDALLE, P., 1993. Eighth SPE Comparative Solution Project: Gridding Techniques in 

Reservoir Simulation, SPE paper 25263 presented at 12th SPE Symposium on Reservoir 

Simulation, New Orleans, LA, U.S.A., February 28-March 3. 



 REFERÊNCIAS BIBLIOGRÁFICAS 191 

 

 

RAW, M., 1996. Robustness of Coupled Algebraic Multigrid for the Navier-Stokes 

Equations, AIAA 96-0297, 34th Aerospace and Sciences Meeting &amp;amp; Exhibit, January 15-

18, Reno, NV. 

RAW, M., 1985. A New Control Volume Based Finite Element Procedure for the Numerical 

Solution of the Fluid Flow and Scalar Transport Equations, Ph.D. Thesis, University of 

Waterloo, Waterloo, Ontario, Canada. 

RENARD, P. and MARSILY, G., 1997. Calculating Equivalent Permeability: A Review, 

Advances in Water Resources, Vol. 20, Nos 5-6, pp. 253-278. 

RODRIGUES, J. R. P., and DICKSTEIN, F., 1996. A Multigrid Procedure for Local Grid 

Refinement in Oil Reservoir Simulation, Journal SPE Applied Technology Series, Issue 

Vol 4, Number 1, Pages 157-164.  

ROMEU, R. K. and NOETINGER, B., 1995. Calculation of Internodal Transmissibilities in 

Finite Difference Models of Flow In Heterogeneous Porous Media, Water Resour. Res., v. 

31, n. 4, p. 943-959. 

ROSA, A. J., CARVALHO, R. S. e XAVIER, J. A. D., 2006. Engenharia de Reservatórios de 

Petróleo, Ed. Interciência : Petrobras, Rio de Janeiro. 

ROZON, B. J., 1989. A Generalized Finite Volume Discretization Method for Reservoir 

Simulation, SPE paper 18414 presented at the Reservoir Simulation Symposium, Houston, 

Texas, February 6-8. 

RUGGIERO, M. A. G. e LOPES, V. L. R., 1997. Cálculo Numérico: Aspectos Teóricos e 

Computacionais, 2ª. ed.,  Makron Books, São Paulo. 

SAAD, Y., 2000. Iterative Methods for Sparse Linear Systems, 2nd Ed., PWS Publishing 

Company, Boston. 

SANTOS, L. O. E., ORTIZ, C. E. P., GASPARI, H. C., HAVERROTH, G. E. and PHILIPPI, 

P. C., 2005. Prediction of Intrinsic Permeabilities with Lattice Boltzmann Method, 

Procedings of 18th International Congress of Mechanical Engineering – COBEM, 

November 6-11, Ouro Preto, MG. 



192 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

SCHNEIDER, G. E. and ZEDAN, M., 1983. Control-Volume-Based Finite Element 

Formulation of the Heat Conduction Equation, in Spacecraft Thermal Control, Design, 

and Operation, Prog. Astronaut. Aeronaut., vol. 86, pp. 305-327. 

SETTARI, A. and AZIZ, K., 1973. A Generalization of Additive Correction Methods for the 

Iterative Solution of Matrix Equations, SIAM Journal of Numerical Analysis, Vol. 10, pp. 

506 – 521. 

SHAW, C. T., 1992. Using Computational Fluid Dynamics, Prentice Hall, New York. 

SHIN, D. and MERCHANT, A. R., 1993. Higher-Order Flux Update Function Method for 

Reduction of Numerical Dispersion and Grid Orientation Effect in Reservoir Simulation, 

SPE paper 25600 presented at the SPE Middle East Oil Technical Conference &amp;amp; 

Exhibition, 3-6 April, Bahrain. 

SHIRALKAR, G. S., FLEMING, G. C., WATTS, J. W., WONG, T. W., COATS, B. K., 

MOSSBARGER, R., ROBBANA, E. and BATTEN, A. H., 2005. Development and Field 

Application of a High Performance, Unstructured Simulator with Parallel Capability, SPE 

paper 93080 presented at the SPE Reservoir Simulation Symposium, 31 January-2 

Feburary, The Woodlands, Texas. 

SILVA, A., COUTINHO, A. L. G. A. e PARSONS, I., 2000. Métodos Multigrid para a 

Simulação por Elementos Finitos de Escoamentos Imiscíveis em Meios Porosos, Métodos 

Numéricos para Cálculo y Diseño en Ingeniería, v. 16, nº 3, pp. 311-326. 

SKOREYKO, F., SAMMON, P. H. and MELICHAR, H., 2003. Use of PEBI Grids for 

Complex Advanced Process Simulators, SPE paper 79685 presented at the SPE Reservoir 

Simulation Symposium, 3-5 February, Houston, Texas. 

SONIER, F. and EYMARD, R., 1993. Mathematical and Numerical Properties of Control-

Volume Finite-Element Scheme for Reservoir Simulation, SPE paper 25267 presented at 

the 12th Symposium on Reservoir Simulation, New Orleans, LA, February 28-March 3. 

SONIER, F., LEHUEN, P. and NABIL, R., 1993. Full-Field Gas Storage Simulation Using a 

Control-Volume Finite Model, SPE paper 26655 presented at the 68th Annual Technical 

Conference and Exhibition, Houston, Texas, 3-6 October. 



 REFERÊNCIAS BIBLIOGRÁFICAS 193 

 

 

SOUZA, J. A., 2000. Implementação de um Método de Volumes Finitos com Sistema de 

Coordenadas Locais para a Solução Acoplada das Equações de Navier-Stokes, 

Dissertação de Mestrado, Programa de Pós-Graduação em Engenharia Mecânica, UFSC, 

Florianópolis. 

STARS, Version 2002 User’s Guide. Computer Modelling Group Ltd, Calgary, Alberta, 

Canada. 

STROUSTRUP, B., 2000. The C++ Programming Language (Special Edition). Addison 

Wesley. USA. 

TAMIN, M., ABOU-KASSEM, J. H. and FAROUQ ALI, S. M., 1999. Recent Developments 

in Numerical Simulation Techniques of Thermal Recovery, SPE paper 54096 presented at 

the SPE International Thermal Operations and Heavy Oil Symposium, Bakersfield, 

California, 17-19 March. 

TCHELEPI, H. A., JENNY, P., LEE, S. H. and WOLFSTEINER, C., 2005. An Adaptive 

Multiphase Multiscale Finite Volume Simulator for Heterogeneous Reservoirs, SPE paper 

93395 presented at the Reservoir Simulation Symposium, 31 January-2 February, The 

Woodlands, Texas 

THIELE, M. R., 2001. Streamline Simulation, 6th International Forum on Reservoir 

Simulation, September 3-7, Schloss Fuschl, Austria. 

THOMAS, G. W. and THURNAU, D. H., 1983. Reservoir Simulation Using Adaptive 

Implicit Method, SPE Journal, October, pp. 759-768. 

THOMAS, J. E., 2001. Fundamentos de Engenharia de Petróleo, Ed. Interciência : Petrobras, 

Rio de Janeiro. 

TODD, M. R., O´DELL, P. M. and HIRASAKI, G. J., 1972. Methods for Increased Accuracy 

in Numerical Reservoir Simulators, SPE Journal, Dec., 515-530. 

TORONYI, R. M. and FAROUQ ALI, S. M., 1974. Determining Interblock Transmissibility 

in Reservoir Simulators, J. Pet. Technol., v. 26, n. 1, pp. 77-78. 

TROTTENBERG U., OOSTERLEE C., SCHÜLLER A., BRANDT A., OSWALD P., and 

STÜBEN K., 2001. Multigrid, Academic Press, Inc., Orlando, FL. 



194 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

VAN DOORMAAL, J. P., TURAN, A. and RAITHBY, G. D., 1987. Evaluation of New 

Techniques for the Calculation of Internal Recirculating Flows,  in proceedings of the 

AIAA 25th Aerospace Sciences Meeting, January 12-15, Reno, Nevada. 

VERMA, S. and AZIZ, K., 1997. A Control Volume Scheme for Flexible Grids in Reservoir 

Simulation, paper SPE 37999 presented at the Reservoir Symposium, Dallas, Texas, 8-11 

June. 

VINSOME, P. K. and AU, A. D. K., 1979. One Approach to the Grid Orientation Problem in 

Reservoir Simulation, SPE paper 8247 presented at the 54th Annual Fall Technical 

Conference and Exhibition, September 23-26, Las Vegas, Nevada. 

VON ROSENBERG, 1982. Local Mesh Refinement for Finite Difference Methods, paper  

SPE 10974 presented at the Annual Technical Conference and Exhibition, 26-29 

September, New Orleans, Louisiana. 

WADSLEY, W. A., 1980. Modelling Reservoir Geometry with Non-Rectangular Coordinate 

Grids, SPE paper 9369 presented at the Annual Technical Conference and Exhibition, 21-

24 September, Dallas, Texas. 

WANG, K., OGBE, D. O, LAWAL, A. S. and MORTON, D. J., 1995. Multigrid Approach 

for Petroleum Reservoir Simulation on the Cray T3D, in Proceedings of Cray User Group 

Conference, Fairbanks, Alaska, September. 

WOLCOTT, D. S., KAZEMI, H. and DEAN, R. H., 1996. A Practical Method for 

Minimizing the Grid Orientation Effect in Reservoir Simulation, SPE paper 36723 

presented at the SPE Annual Technical Conference and Exhibition, Denver, Colorado, 

USA, 6-9 October. 

YANOSIK, J. L. and McCRACKEN, T. A., 1979. A Nine-Point Finite-Difference Reservoir 

Simulator for Realistic Prediction of Adverse Mobility Ratio Displacements, SPE Journal, 

Aug., 253-262; Trans., AIME, 267. 

YOSHIAKI, I., 1982. Evaluation of Interblock Mobility Using a Modified Midpoint 

Weighting Scheme, SPE paper 10498 presented at the 6th SPE Symposium on Reservoir 

Simulation, New Orleans, LA, January 31-February 3. 



 REFERÊNCIAS BIBLIOGRÁFICAS 195 

 

 

YOUNG, L. C. and RUSSELL, T. F., 1993. Implementation of an Adaptive Implicit Method, 

SPE paper 25245 presented at the SPE Symposium on Reservoir Simulation, 28 February-

3 March, New Orleans, Louisiana. 

YOUNG, L. C., 1999. Rigorous Treatment of Distorted Grids in 3D, SPE paper 51899 

presented at the SPE Reservoir Simulation Symposium, Houston, Texas, 14-17 February. 

ZHAO, X., RICHARDS, P. G. and ZHANG, S. J., 2004. A Parallel Algorithm for Algebraic 

MultiGrid, Proceedings of the 42nd annual Southeast regional conference, pp. 285-290, 

Huntsville, Alabama. 

ZIENKIEWICZ, O. C. and TAYLOR R. L., 1989. The Finite Element Method. Vol. I. Basic 

Formulations and Linear Problems. London: McGraw-Hill. 



 



197 

Anexo    

1 
PPRROOPPOOSSTTAA  DDEE  UUMM  EESSQQUUEEMMAA    
AALLTTEERRNNAATTIIVVOO  DDEE  RREEFFIINNAAMMEENNTTOO  LLOOCCAALL    
PPAARRAA  OO  EEbbFFVVMM  
  

 

 

 

  Embora o refino localizado seja um procedimento natural e direto no EbFVM, são 

apresentadas neste capítulo as premissas de uma técnica que emprega elementos com 5 a 8 

nós que podem ser utilizados com vantagem em operações de refino localizado e 

representação de reservatórios complexos no método EbFVM. A Fig. A1.1a apresenta uma 

malha composta por tais elementos e seus volumes de controle resultantes. Embora seja 

possível encontrar na literatura trabalhos que tenham utilizado elementos quadrangulares com 

nove nós no EbFVM (RAW et al., 1985), a proposta de empregar elementos com números 

diferentes de nós em uma mesma malha parece ser promissora. 

  Nota-se que nesta proposta, embora a malha de uma forma geral seja considerada não-

estruturada, os elementos refinados devem ser localmente estruturados uma vez que necessita-

se sempre dividir uniformemente elementos quadriláteros em quatro elementos distintos, em 

razão das funções de forma utilizadas. Por isso, este método de refino é aplicável apenas se a 

razão de refinamento for 1:2 em cada direção, isto é, em cada face do elemento deve-se ter 

apenas um ou dois elementos vizinhos. Essa característica também é encontrada em outros 

trabalhos (ZEEUW, 1993; HEINEMANN e BRAND, 1989). 

  Quanto à construção dos volumes de controle resultantes, propõe-se utilizar a mesma 

regra empregada em elementos de três e quarto nós, isto é, os volumes são criados unindo-se 

o centro dos elementos as medianas de suas faces. Neste caso, todos os fluxos em um ponto 

de integração específico podem ser calculados utilizando os dados do elemento onde o ponto 

de integração está contido. 

  Na Fig. A1.1b é demonstrado que esta mesma técnica apresentada para refino local 

também pode ser utilizada com muitas vantagens na representação de reservatórios com 

falhas. Neste caso é apresentado um reservatório com uma falha vertical discretizado 

utilizando elementos formados com 5 nós. 



198 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

 
(a) 

 

 

 
 

(b) 
Fig. A1.1 - Malha composta por elementos com número variável de nós (esquerda), e seus volumes resultantes 

(direita) em (a) um caso geral e (b) um casos de falha vertical. 

 

 

  

  O processo de obtenção das equações discretizadas utilizando esses elementos é 

idêntico ao discutido no Cap. 4, com exceção das funções de forma utilizadas que se alteram 

em função da quantidade de nós de cada elemento. Na seqüência é apresentado um 

procedimento geral baseado no elemento-padrão da Fig. A1.2 de 8 nós. A idéia principal é 

que quaisquer nós deste elemento podem ser retirados ou adicionados para formar elementos 

de no mínimo 4 e no máximo 8 nós.  



 ANEXO 1 – ESQUEMA DE REFINAMENTO LOCAL 199 

 

 

 
 

Fig. A1.2 - Elemento de 8 nós 

 

 

  As funções de forma para elementos com 4 nós (N1 to N4) passam a ser construídas 

visando a possibilidade de existirem nós nos pontos médios de cada face (nós 5 a 8 na Fig. 

A1.2) como 

 

 ( )5811 2
1

NNNN * +?=  (A1.1) 

 ( )6522 2
1

NNNN * +?=  (A1.2) 

 ( )7633 2
1

NNNN * +?=  (A1.3)  

 ( )8744 2
1

NNNN * +?=  (A1.4)  

 

onde *aN  são as funções de forma tradicionais bi-lineares para elementos quadriláteros dadas 

por 

 

 ( )( )???? aa 114
1

++=*aN ,              a = 1, 2, 3, 4 (A1.5)  

 

e as funções de forma para os nós dos pontos médios de cada face serão dados por (HUGHES, 

1987), 

 



200 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 ( )( )??? a2 112
1

+?=aN                  a = 5 e 7 (A1.6) 

 ( )( )2b 112
1

??? ?+=bN                  b = 6 e 8 (A1.7) 

 

  Nota-se que se qualquer um dos nós  5, 6, 7 e 8 estiver ausente, define-se formalmente 

N5, N6, N7 e N8 como zero, respectivamente.  

  O procedimento de calcular as funções de forma para contemplar esta nova técnica de 

refino localizado no EbFVM pode ser resumido como: 

 

1. Determinar as funções de forma (Ni*) para os nós 1, 2, 3 e 4 pela Eq. (A1.5). Este 

passo é feito para todos os elementos quadriláteros do domínio. 

2. Determinar as funções de forma (Na  e Nb) para os nós 5, 6, 7 e 8 pela Eqs. (A1.6) e 

(A1.7) nos elementos definidos com números de nós superior a 4. 

3. Determinar as novas funções de forma (Ni) para os nós 1, 2, 3 e 4 pelas Eqs. (A1.1) a 

(A1.4) nos elementos definidos com números de nós superior a 4. 

 

 

   

A1.1. Bibliografia 
 
HEINEMANN, Z. E. and BRAND, C. W., 1989. Gridding Techniques in Reservoir 

Simulation. 1st/2nd Stanford Univ. &amp;amp; Leoben Mining Univ. Reservoir Simulation Inf. 

Forum (Alpbach, Austria, Sept/1998-Sept/1989). 

HUGHES, T. J. R., 1987. The Finite Element Method, Linear Static and Dynamic Finite 

Element Analysis, Prentice Hall, New Jersey. 

RAW, M. J., SCHNEIDER, G. E. and HASSANI, V., 1985. A Nine-Noded Quadratic 

Control-Volume-Based Finite Element for Heat Conduction, J. Spacecraft, Vol. 22, N. 5, 

sept-oct, pp. 523-529. 

ZEEUW, D. L., 1993. A Quadtree-Based Adaptively-Refined Cartesian-Grid Algorithm for 

Solution of the Euler Equations, Ph.D. Thesis, University of Michigan, United States. 

 



201 

Anexo    

2 
PPRROOCCEEDDIIMMEENNTTOO  DDEE    
LLIINNEEAARRIIZZAAÇÇÃÃOO  DDOO  TTEERRMMOO  SSmm//BBmm    
DDAA  EEQQUUAAÇÇÃÃOO  DDEE  SSAATTUURRAAÇÇÃÃOO  DDOO  MMÉÉTTOODDOO  IIMMPPEESS  

 

 

 

 Na equação da saturação existe uma não-linearidade entre a saturação e o fator volume 

de formação no termo transiente. Para que o método IMPES resolva também problemas 

compressíveis, este termo deve ser linearizado. Este procedimento é descrito neste anexo. 

Deve-se lembrar que o fator volume de formação é determinado através de 

 

?
?
?

?

?
?
?

?
?
?
??

?
? ??= refm

ref
mm ppc1BB  (A2.1) 

 

onde mc  é a compressibilidade da fase m definida por 

 

T

m

m
m p

1
c

?
?

=
?

?
 (A2.2) 

 

ou, em função do fator volume de formação (DAKE, 2001), 

 

pp
BB

B
1

c
ref

ref
mm

ref
m

m ?
?

=  (A2.3) 

 

Valores típicos de compressibilidade variam entre 0 a 10-3 kPa-1, enquanto que o fator 

volume de formação varia de 0.5 a 1.5. 

 Propõe-se uma linearização através do truncamento dos termos de maior ordem da 

série de Taylor escrita para funções de duas variáveis (SPIEGEL, 1992), 

 



202 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

( ) ( ) ( ) ( ) .....,,),(),( +?+?+= bafbybafaxbafyxf yx  (A2.4) 
 

onde, para o problema em questão, mm Bsf = , de forma que a Eq. (A2.4) pode ser escrita 

como 

 

( ) ( )
m

o

m

mm
m

o

m

mm
o
m

o
m

m

m B
B

Bs
s

s
Bs

B
s

B
s

?
?

?
+?

?
?

+=  (A2.5) 

 

onde o super-índice “o” indica que o termo é avaliado com valores conhecidos do passo de 

tempo anterior. Assim, 

        

( ) m2om
o
m

mo
m

o
m

o
m

m

m B
B

s
s

B
1

B
s

B
s

???+=  (A2.6) 

ou    

 

( )
( )

( )omm2o
m

o
mo

mmo
m

o
m

o
m

m

m BB
B

sss
B
1

B
s

B
s

???+=  (A2.7) 

      
( )

( )2
o

om m
m mo o

m m

s s B B
B B

?= ?  (A2.8) 

  

Mas reconhecendo que a Eq. (A2.1) pode ser escrita como 

 

( )refmrefmrefmm ppcBBB ??=  (A2.9) 
e 

( )refomrefmrefmom ppcBBB ??=  (A2.10) 
 

pode-se mostrar que  

 

( )ppcBBB omrefmomm ?=?  (A2.11) 
 

 Substituindo a Eq. (A2.11) em (A2.8), chega-se a 



 ANEXO 2 – PROCEDIMENTO DE LINEARIZAÇÃO 203 

 

 

( )
( )omrefm2o

m

o
m

o
m

m

m

m ppcB
B

s
B
s

B
s ?+=  (A2.12) 

 

que é a expressão linearizada do termo mm Bs . 

 

 

A2.1. Bibliografia 
 

DAKE, L. P., 2001. The Practice of Reservoir Engineering, Revised Edition, Ed. Elsevier 

Science B. V., Amsterdam, The Netherlands. 

SPIEGEL, M. R., 1992. Manual de Fórmulas, Métodos e Tabelas de Matemática, Edição 

revista e ampliada, McGraw-Hill, São Paulo. 



 



205 

Anexo    

3 
CCOONNSSIIDDEERRAAÇÇÕÕEESS  SSOOBBRREE  OOSS    
RREEGGIIMMEESS  DDEE  OOPPEERRAAÇÇÃÃOO  DDOOSS  PPOOÇÇOOSS  

 

 

 

 No programa computacional desenvolvido nesta tese foram implementados três 

diferentes regimes de operação dos poços: (1) vazão prescrita de água nos poços injetores e 

vazão total prescrita nos poços produtores, (2) pressão de fundo de poço prescrita e (3) 

pressão prescrita no bloco que contém o poço. Essas diferentes alternativas são discutidas 

nesse capítulo, bem como são apresentados para cada caso a forma dos coeficientes para os 

métodos IMPES e Totalmente Implícito. 

 

Coeficientes do Método IMPES.  Os coeficientes de interesse que estão relacionados 

com o regime de operação dos poços no método IMPES são os termos fP e gP das Eqs. (5.13) 

e (5.14) utilizados na definição da 2ª. parcela da equação da pressão do método IMPES, Eq. 

(5.8), definidos de forma geral como  

 

( )o ow w o o P p pq B q B g p f+ = ?  (A3.1) 

 

 e o coeficiente ( )Pwq  da equação da saturação, Eq. (5.7). 
 

 Coeficientes do Método Totalmente Implícito. Para este método os termos 

relacionados com o regime de operação dos poços estão contidos nas expressões que 

determinam o resíduo das equações de conservação das fases, Eq. (5.34), e suas derivadas. 

  

 



206 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

A3.1. Regime de Operação de Vazão de Água Prescrita nos 
Poços Injetores 

  

Este é o caso mais simples, uma vez que se trata da prescrição direta da vazão de 

injeção de água em [L3.T-1], 
Prw

q , que é o próprio termo que aparece na equação de 

conservação da água.  

  

 IMPES:  Os termos da equação da pressão destacados na Eq. (A3.1) serão escritos 

para esse regime  como 

 

( )
Pr

( )o o ow w o o P w w Pq B q B q B+ =  (A3.2)  

 

onde os coeficientes  fP e gP assumem os seguintes valores 

 

( )
Pr

0

o
P w w P

P

f q B

g

= ?

=
 (A3.3) 

                   

enquanto que o termo de fluxo da equação da saturação será dado por 

 

( )
Prw wP

q q=  (A3.4) 

 

 Totalmente Implícito. Os resíduos das equações de conservação das fases associados 

ao termo de poço quando a vazão de injeção de água é prescrita são simplesmente escritos 

como 
 

( )
Pr

Pr

w wpoços

T w wpoços P

R q

R q B

=

=
 (A3.5) 

 

e suas derivadas em relação as variáveis dependentes são nulas. 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 207 

 
 
 

 

A3.2. Regime de Operação de Vazão Total nos Poços 
Produtores 

 

Neste caso a vazão total produzida, 
PrT

q ,  em [L3.T-1], é prescrita no poço produtor. Ela 

corresponde a soma das vazões de água e óleo neste poço. Cuidado deve ser tomado com a 

prescrição deste regime quando são utilizados fluidos compressíveis, pois em um caso destes, 

dependendo da condição de contorno nos poços injetores, poderá estar sendo seja violada a 

conservação da massa global. 

 

IMPES:  Os termos da equação da pressão destacados na Eq. (A3.1) serão escritos 

para esse regime como 

 

Pr
( )o ow w o o P Tq B q B q+ = ?  (A3.6) 

 

e, assim, os coeficientes de interesse são dados por 

 

Pr

0
P T

P

f q

g

=

=
 (A3.7)   

 

Como não foi prescrito fluxo de água neste poço e não é utilizado nenhum modelo de 

poço que relacione a pressão do bloco com alguma pressão de referência, deve-se buscar 

alguma alternativa para encontrar a parcela do fluxo total que corresponde ao fluxo de água. 

Deve-se lembrar que é importante esta determinação porque esse valor será utilizado na 

resolução da equação da saturação, 

 

( )
( )

( ) ( )1
oref o

m mo m
m m mm oP P ii Pm PP

p pB c Bs q k ps S t
B V

?
?? ?

? ?? ? ?? ?? ?? ?= ? + + ? ?? ?? ? ?? ? ? ?? ?? ?
?  (A3.8) 

 

que não está sendo prescrito. Sabe-se que da definição do fluxo das fases, 



208 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

ow

w

ow

w

qq
q

??
?
+

=
+

 (A3.9) 

  

Como 
Pr

T w oq q q= + , pode-se utilizar a equação anterior para determinar a vazão de 

água neste poço, 

 

( )
Pr

o

w
m TP

w o P

q q
?

? ?
? ?

= ? ?+? ?
 (A3.10) 

 

Totalmente Implícito. O resíduo da equação de conservação da fase m associado ao 

termo de poço quando a vazão total produzida no poço produtor é prescrita pode ser calculado 

como o deduzido no método IMPES, 

 

Pr

m
m Tpoços

w o P

R q
?

? ?
? ?

= ? ? ?+? ?
 (A3.11) 

 

e suas derivadas em relação as variáveis dependentes (X = p, sw) são dadas por 

 

Pr

m m
T

poços w o P

R
q

X X
?

? ?
? ?? ?? ?

= ? ? ?? ?? ? +? ?? ?
 (A3.12) 

 

 O termo entre parêntesis na Eq. (A3.12) é denominado de fluxo fracionário da fase m, 

e sua derivada em relação a uma variável genérica X é dada por 

 

( )2
1w o w

w o
w o w o

X X X
? ? ?

? ?
? ? ? ?

? ? ? ?? ? ?= ?? ? ? ?? + ? ?? ? +? ?
 (A3.13) 

 

para a fase água e 

 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 209 

 
 
 

 

o w

w o w oX X
? ?

? ? ? ?
? ? ? ?? ?

= ?? ? ? ?? + ? +? ? ? ?
 (A3.14) 

 

para a fase óleo. As derivadas da mobilidade de cada fase em relação as variáveis dependentes 

podem ser calculadas a partir da Eq. (5.54). 

 

 

A3.3. Regime de Operação de Pressão de Fundo de Poço 
Prescrita nos Poços Produtores 

  

Em situações onde é possível prescrever a pressão de fundo de poço, a vazão de uma 

fase e a pressão do bloco serão relacionados a partir do seguinte modelo de poço, 

 

( )fpm m p pq WI?= ?                     em     [L
3.T-1]  (A3.15) 

 

onde fpp  é a pressão de fundo de poço, e WI é o índice de poço (Well Index) que contém 

informações geométricas e físicas do poço e do bloco que o contém, dado por 

  

( )weq rr
bk2

WI
/ln

?
=                            em     [L3] (A3.16) 

 

onde b é a espessura da camada do reservatório, k é a permeabilidade absoluta do bloco, req é 

um raio médio equivalente do bloco e rw é o raio do poço. 

 As Eqs. (A3.15) e (A3.16) que definem este modelo de poço advém da inspeção de 

que o escoamento é aproximadamente radial na região próxima ao poço, e logo, a velocidade 

pode ser calculada neste região como 

 

m m
dp

u
dr

?= ?  (A3.17) 

ou  



210 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

2
m

m
q dp

rb dr
?

?
= ?  (A3.18) 

 

onde 2 rb?  é a área de passagem do fluxo. Rearranjando e integrando a equação anterior, 

 

2
eq

w fp

r p
m

m
r p

q dr
kb dp

r
? ?= ?? ?  (A3.19) 

 

chega-se a 

 

ln( ) ln( ) 2 ( )m eq w m fpq r r kb p p? ?? ?? = ? ?? ?  (A3.20) 

 

ou 

 

( )
2 ( )

( )
ln /

m fp
fpm m

eq w

kb p p
p pq WI

r r
? ?

?
?

= ? = ?  (A3.21) 

 

IMPES. Neste caso, o termo ( )o ow w o o Pq B q B+  da equação da pressão será dado por 

  

( ) ( ) ( )o o o ofp fpw w o o P w w o op p p pq B q B WI B WI B? ?? ?+ = ? + ?? ?  (A3.22) 

  

 Como estamos expressando ( )o ow w o o P p pq B q B g p f+ = ? , para este regime de 

operação, portanto, os coeficientes das equações serão dados por 

 

. ( )

( )

o o
P fp w w o o

o o
P w w o o

pf WI B B

g WI B B

? ?

? ?

= ? +

= ? +
  (A3.23) 

 

e na equação da saturação o termo de fluxo será dado por 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 211 

 
 
 

 

( ) . ( )w w fpP Pq p pWI ?? ?= ? ?? ?  (A3.24) 

 

Totalmente Implícito. O resíduo associado ao termo de poço das equações de 

conservação terá a forma 

 

( ) ( )m m fpPpoços PR WI p p?= ? ?  (A3.25) 

 

e suas derivadas em relação as variáveis dependentes são dadas por 

 

( )m mm fp
poços P

R
WI p p

p p
?

?
? ?? ?

= ? + ?? ?? ?? ?
 (A3.26) 

e 

( )m m fp
w wpoços P

R
WI p p

s s
?? ?? ?

= ? ?? ?? ?? ?
  (A3.27) 

 

 

A3.4. Regime de Operação de Pressão Prescrita no Bloco 
que Contém o Poço Produtor 

 

Neste caso prescreve-se diretamente o valor da pressão no bloco que contém o poço 

produtor, devendo-se encontrar uma forma alternativa de calcular o fluxo da fase que é 

utilizado na equação de conservação, que agora não é mais prescrito.  

 

IMPES. Neste método não é necessário resolver a equação da pressão pois é 

conhecido o valor de pressão do bloco que contém o poço. Então, diferentemente dos casos 

anteriores, agora além de utilizar os seguintes coeficientes 

 

Pr

0
P

P

pf
g

=
=

 (A3.28) 



212 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

torna-se necessário também substituir o coeficiente A(P,P) da matriz de coeficientes que 

assumirá o valor 1, zerando os demais termos da linha de P. Este procedimento prescreve o 

valor desejado da pressão no bloco. No entanto, as experiências numéricas têm mostrado que 

para a maioria dos casos a matriz de coeficientes é formada por números com ordem de 

grandeza muito menor que 1, o que pode, dependendo do solver utilizado, causar dificuldades 

na resolução do sistema linear pela diferença de ordem de magnitude dos coeficientes. Por 

isso, uma forma alternativa que mantém coeficientes da mesma ordem na matriz é utilizar, ao 

invés da Eq. (A3.28), a seguinte equação 

 

( ) Pr,P pf A P P=  (A3.29) 

 

mantendo inalterado o coeficiente A(P,P), e zerando, como antes, os demais termos da linha 

de P. 

Embora não se tenha que resolver a equação da pressão do bloco para este regime de 

poço, a equação da saturação necessita ainda ser resolvida. E neste caso tem-se a mesma 

dificuldade encontrada na seção A1.2 e que diz respeito à necessidade de definir qual é o 

valor do fluxo de água utilizada na equação da saturação. Uma forma de determiná-lo é 

utilizar como ponto de partida a equação da pressão escrita para o volume que contém o poço 

(a que não foi utilizada devido a prescrição da pressão), isolando o termo de fluxos dos poços, 

 

i w w o o
i P

m q B q B
? ?

= +?  (A3.30)  

   ( ) ( )( )
P P

oo ref o ref
o o o o w w w o o o

w w o o i o oi i
i P w o P P

V p ps B c s B c
B B k p S

B B t
?

? ?
? ?

? ?? ?? ?
? ?= ? + ? ?? ? +? ? ? ??? ? ? ?

?  

 

onde i
i P

m
? ?
?  é o somatório dos fluxos de massa nas fronteiras do volume de controle que 

contém o poço. Este somatório só não será nulo nos blocos que contenham poços, e pode ser 

facilmente calculado ser for utilizada a seguinte expressão 

 

[ ]{ } { }'i p
i P

m A p e
? ?

? ?
= +? ?

? ?
?  (A3.31) 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 213 

 
 
 

 

onde [ ]'A  é a própria matriz global de coeficientes da equação da pressão apresentada no Cap. 
5, sem os termos de poços e sem zerar a linha correspondente ao bloco que contém o poço,  

{ }pe  é o vetor com os termos de compressibilidade definido na Eq. (5.17), e { }p , por sua 
vez, é o vetor que contém os valores mais recentes de pressão, incluindo o valor prescrito no 

bloco. 

Assim, isolando oq  da Eq. (A3.30) e substituindo a expressão resultante na Eq. (A3.9), 

obtém-se uma equação escrita em função da vazão de água, 

 

o
w w

o o
i w o

w i P
w w

o o

q
m

B
q q

B B

?
? ?

? ?

=
+

? +
?

 (A3.32) 

 

e colecionando-se os termos semelhantes, na forma 

 

( ) 1
i

o o o w i P
w w o w w

o o

m
B

q q
B B

? ? ? ? ?
? ?

? ?? ?+ = ? +? ?? ?? ?? ?? ?

?
 (A3.33) 

e  

 

1
o

o o o w w
w w o w i

i Po o

B
q m

B B
?

? ? ?
? ?

? ?? ?
+ ? ? =? ?? ?

? ?? ?
?  (A3.34) 

 

chega-se a equação que determina o fluxo utilizado da equação da saturação quando a pressão 

do poço é prescrita no bloco, dada por 

 

( )
o
w

w io oP
i Po o w w P

q m
B B

?
? ? ? ?

? ?
= ?? ?+? ?

?  (A3.35) 

 

 



214 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

Totalmente Implícito. Neste tipo de regime de poço necessita-se prescrever o fluxo da 

fase em cada uma das equações de conservação da mesma forma como foi no IMPES. 

Utilizando o mesmo raciocínio utilizado naquele método, pode-se mostrar que o termo de 

resíduo dos poços para a equação da conservação da água é dado por 

 

w
w ipoços

i Po o w w P

R m
B B

?
? ? ? ?

? ?
= ?? ?+? ?

?  (A3.36) 

 

Não é necessário calcular o termo equivalente para a equação de conservação do óleo 

porque a equação de conservação total (aquela que fornecerá o valor de p?  para este bloco) 

não será utilizada. Na verdade, como o valor da pressão já é conhecido e não se altera com o 

tempo, o valor de p?  para este bloco calculado pelo sistema linear da Eq. 5.27 deverá ser 

zero, não modificando o valor da pressão do bloco que contém o poço, como o desejado. Para 

tanto, deve-se anular na matriz jacobiana todos os coeficientes da linha referente a equação 

das derivadas da equação da conservação do óleo deste bloco, a menos do termo da diagonal 

principal. Deve-se zerar também a posição correspondente do vetor de termos independentes.  

Quanto a linha que contém os coeficientes da equação de conservação da água, a 

derivada do resíduo do termo de poços será calculado a partir de  
  

w w
i

i Ppoços o o w w P

R
m

X X B B
?

? ? ? ?
? ?? ?

= ? ? ?? ? +? ?
?  (A3.37) 

 

onde X = p, sw e  

    

( )2
1

                                   

w w o
o o w

o o w w

o w
w o w

o o w w

B
X B B X X

B B
X X B B

? ? ?
? ?

? ?

? ? ?
? ?

? ? ? ? ?? ? ?= ? +? ? ? ??? + ? ?? ??? ?
? ? ?? ?? +? ??? ?? ? +?

 (A3.38) 

 

Um resumo com todos os regimes de operação de poços utilizados neste trabalho é 

apresentado na Tab. A3.1 para o IMPES e nas Tabs. A3.2 e A3.3 para o método Totalmente 

Implícito. 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 215 

 
 
 

 

Parâmetro associado ao termo fonte (soma-se ao vetor de termos independentes) 

Poço 
Injetor 

Regime de Operação 1 
(Vazão de água prescrita) 

PrP w w
f q B= ?  

Regime de Operação 1 
(Vazão total prescrita:  água + óleo) 

PrTP
qf =  

Regime de Operação 2 
(Pressão de fundo de poço prescrita) 

. ( )P fp w w o opf WI B B? ?= ? +   
Pf  1 x 1 

Poço 
Produtor 

Regime de Operação 3 
(Pressão prescrita no bloco que 

contém o poço) 

Pr
pf P =  

 

Parâmetro que se somará ao valor da diagonal principal de [A] correspondente ao bloco do poço 

Poço 
Injetor Regime de Operação 1 0=Pg  

Regime de Operação 1 0=Pg  

Regime de Operação 2 ( )P w w o og WI B B? ?= ? +   
Pg  1 x 1 

Poço 
Produtor 

 

 

Regime de Operação 3 

 

 

0=Pg  
torna-se necessário também zerar os termos da linha 

de P, a menos do termo da diagonal - A(P,P), e 
também substituir na posição respectiva no vetor de 
termos independentes o valor prescrito da pressão 

multiplicado pelo coeficiente A(P,P). 

 

Parâmetro utilizado no cálculo explícito das saturações 

Poço 
Injetor Regime de Operação 1 

( )
PrwPw

qq =  

Regime de Operação 1 ( )
Pr

w
m TP

w o P

q q
?

? ?
? ?

= ? ?+? ?
 

Regime de Operação 2 ( ) . ( )w w fpP Pq p pWI ?? ?= ? ?? ?   
( )PIq  1 x 1 

Poço 
Produtor 

Regimes de Operação 3 ( ) ww iP
i Po o w w P

q m
B B

?
? ? ? ?

? ?
= ?? ?+? ?

?  

onde P  é o nó do volume que contém o poço,  e i
i P

m
? ?
?  é calculado como descrito na seção A1.4 

 
Tab. A3.1 – Resumo das expressões dos resíduos associados ao termo de poços para diferentes regimes de 

operação utilizados no Método IMPES 
 



216 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

Resíduo associado ao termo de injeção / produção da fase água 

Poço 
Injetor 

Regime de Operação 1 
(Vazão de água prescrita) 

( )
Prw wpoços P

R q=  

Regime de Operação 1 
(Vazão total prescrita:          

água + óleo) 
Pr

w
w Tpoços

w o P

R q
?

? ?
? ?

= ? ? ?+? ?
 

Regime de Operação 2 
(Pressão de fundo de poço 

prescrita) 
( ) ( )w w fpPpoços PR WI p p?= ? ?  

 
 
 
 
 

RWpocos 
 
 
 
 

 
 
 
 

Npoços 
x 1 

 

Poço 
Produtor 

Regime de Operação 3 
(Pressão prescrita no bloco 

que contém o poço) 

w
w ipoços

i Po o w w P

R m
B B

?
? ? ? ?

? ?
= ?? ?+? ?

?  
 

Resíduo associado ao termo de injeção / produção da equação da pressão 

Poço 
Injetor 

Regime de Operação 1 
(Vazão de água prescrita) 

( )
PrT w wpoços P

R q B=  

Regime de Operação 1 
(Vazão total prescrita:          

água + óleo) 
Pr

T Tpoços
R q= ?  

Regime de Operação 2 
(Pressão de fundo de poço 

prescrita) 
( ) ( )T w w o o fpPpoçosR WI B B p p? ?= ? + ?

 

 
 
 
 

RTpocos 
 
 
 
 

 
 
 
 

Npoços 
x 1 

 

Poço 
Produtor 

Regime de Operação 3 
(Pressão prescrita no bloco 

que contém o poço) 
0TR =  

 
Tab. A3.2 – Resumo das expressões dos resíduos associados ao termo de poços para diferentes regimes de 

operação utilizados no Método Totalmente Implícito 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 ANEXO 3 -  REGIMES DE OPERAÇÃO DOS POÇOS 217 

 
 
 

 

Derivadas do resíduo da equação da água em relação a p e sw  associadas ao termo de poço 

Poço 
Injetor 

Regime de Operação 1 
(Vazão de água prescrita) 

0w w
wpoços poços

R R
p s

? ?
= =

? ?
 

Regime de Operação 1 
(Vazão total prescrita:          

água + óleo) 

Pr

w w
T

w opoços P

R
q

p p
?

? ?
? ?? ?? ?

= ? ? ?? ?? ? +? ?? ?

Pr

w w
T

w w w opoços P

R
q

s s
?

? ?
? ?? ?? ?

= ? ? ?? ?? ? +? ?? ?
 

Regime de Operação 2 
(Pressão de fundo de poço 

prescrita) 

( )w ww fp
poços P

R
WI p p

p p
?

?
? ?? ?

= ? + ?? ?? ?? ?

( )w w fp
w wpoços P

R
WI p p

s s
?? ?? ?

= ? ?? ?? ?? ?
  

 

 
 
 
 

dRWdpPocos 
 
 
 

dRWdsPocos 
 
 
 
 
 

1 x 1 
Poço 

Produtor 

Regime de Operação 3 
(Pressão prescrita no bloco 

que contém o poço) 

w w
i

i Ppoços o o w w P

R
m

X X B B
?

? ? ? ?
? ?? ?

= ? ? ?? ? +? ?
?

 
Derivadas do resíduo da equação da pressão em relação a p e sw  associadas ao termo de poço 

Poço 
Injetor 

Regime de Operação 1 
(Vazão de água prescrita) 

0T T
wpoços poços

R R
p s

? ?
= =

? ?
 

Regime de Operação 1 
(Vazão total prescrita:          

água + óleo) 

0T T
wpoços poços

R R
p s

? ?
= =

? ?
 

Regime de Operação 2 
(Pressão de fundo de poço 

prescrita) 

[
,

T
m m

m w opoços

R
WI B

p
?

=

?
= ? +

? ?  

         ( )m mm m fpBB p pp p
?

?
?? ?? ?

+ + ? ?? ?? ?? ? ?
 

( )
,

mT
m fp

m w ow wpoços

R
WI B p p

s s
?

=

??
= ? ?

? ??  

 

 
 
 
 
 

dRTdpPocos 
 
 
 

dRTdsPocos 
 
 
 
 

1 x 1 
Poço 

Produtor 

Regime de Operação 3 
(Pressão prescrita no bloco 

que contém o poço) 
Mantém-se inalterado o valor na coluna 2P e 

anula-se os demais termos da linha 

 

onde P  é o nó do volume que contém o poço, i
i P

m
? ?
?  é calculado como descrito na seção A3.4, X = p, sw   e 



218 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 
 

( )2
1w o w

w o
w o w o

X X X
? ? ?

? ?
? ? ? ?

? ? ? ?? ? ?= ?? ? ? ?? + ? ?? ? +? ?
,           o w

w o w oX X
? ?

? ? ? ?
? ? ? ?? ?

= ?? ? ? ?? + ? +? ? ? ?
, 

( )2
1w w o o w

o o w w o w
o o w w o o w w

B B
B

X B B X X X X B B
? ? ?

? ? ? ? ?
? ? ? ?

? ? ? ? ? ? ? ?? ? ? ? ?= ? ? +? ? ? ? ? ?? ?? + ? ? ? ?? ? ? ? +? ?? ?
 

 
Tab. A3.3 – Resumo das expressões das derivadas dos resíduos associados ao termo de poços para diferentes 

regimes de operação utilizados no Método Totalmente Implícito 
 



219 

Anexo    

4 
EESSQQUUEEMMAA  AALLTTEERRNNAATTIIVVOO  DDEE  
TTRRAANNSSFFEERRÊÊNNCCIIAA  DDEE  DDAADDOOSS  PPAARRAA  AASS            
MMAATTRRIIZZEESS  EESSPPAARRSSAASS  

 

 

Quando não se dispor de uma eficiente biblioteca numérica capaz de gerenciar o 

armazenamento de matrizes esparsas e os processos de transferência dos coeficientes 

calculados nas matrizes de cada elemento, pode-se utilizar o esquema proposto nesta seção e 

que consiste em criar matrizes locais em cada elemento contendo endereços relativos as 

matrizes esparsas. 

Considere o esquema de armazenamento mais simples de matrizes esparsas  

denominado de “formato coordenado” (SAAD, 2000), no qual os dados passam a ser 

estruturados utilizando-se três vetores de mesmas dimensões que definem todos os elementos 

não-nulos de uma matriz: 

 

1. Um vetor de inteiros com os índices das linhas; 

2. Um vetor de inteiros com os índices das colunas; 

3. Um vetor de números reais contendo os valores não-nulos localizados nas posições 

(linha, coluna) definidas nos outros dois vetores; 

 

conforme explicado no Cap. 5. A utilização de outros formatos de armazenamento, como o 

formato de linha comprimida (Compressed Sparse Row - CSR), também podem ser aplicados 

no esquema proposto. 

A desvantagem da utilização do armazenamento de matriz esparsa é a dificuldade de 

identificar diretamente a localização de um coeficiente no vetor de valores. Dados os índices 

da linha e  coluna correspondentes da matriz cheia, em alguns casos torna-se necessário 

“varrer” praticamente todas as posições dos vetores de índices para identificar a localização 

de um coeficiente no vetor de valores. Essa dificuldade é acentuada no método EbFVM 

porque em cada elemento e a cada passo de tempo é calculada uma matriz local contendo 

valores que devem ser transportados para a matriz esparsa global. Este procedimento 



220 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

normalmente acaba tendo um alto custo computacional, independentemente da 

disponibilidade de algoritmos eficientes, porque de qualquer forma o algoritmo deve ter um 

procedimento de busca da posição correspondente no vetor de valores através da informação 

dos índices da linha e coluna nos outros dois vetores. 

Para sanar essas dificuldades com o armazenamento de matrizes esparsas é proposto 

nesta seção criar uma matriz para cada elemento da malha que contenha as posições no vetor 

de valores da matriz global esparsa onde cada valor da matriz local de coeficientes deve ser 

adicionado. Essas matrizes de endereços, compostas apenas de valores inteiros, são calculadas 

no início do processo e uma única vez para toda a simulação. Através deste procedimento, 

portanto, não é mais necessário, referenciar-se à índices de coluna e linha na transferência de 

informação das matrizes locais para a global, o que é muito conveniente pois evita o trabalho 

de pesquisa da posição de um coeficiente no vetor de valores. 

A Fig. A4.1 ilustra o processo de representação de matrizes esparsas, apresentando um 

exemplo de uma malha composta por dois elementos – um triangular e outro quadrilátero. 

Nota-se que, semelhantemente ao processo de formação das matrizes globais cheias, a matriz 

global esparsa representada desta forma é montada a partir da informação proveniente das 

matrizes locais de coeficientes, como deveria ser. No entanto, a posição no vetor de valores de 

cada um dos valores provenientes das matrizes locais dependerá da informação contida nas 

matrizes de endereços dos elementos. 

 



 ANEXO 4 – ESQUEMA DE TRANSFERÊNCIA DE DADOS PARA MATRIZES ESPARSAS 221 

 

 

 
 

Fig. A4.1 – Procedimento de preenchimento da matriz esparsa definida por três vetores que contêm os valores 

não-nulos e os índices que definem a posição de cada um deles na matriz cheia 

 

 

Para exemplificar o papel das matrizes locais de posições na formação da matriz 

esparsa global, considere que a matriz de conectividades fornecida pelo gerador da malha da 

Fig. A4.1 seja 

 
 Nó local 1 Nó local 2 Nó local 3 Nó local 4 
     

Elemento 1 1 2 4 5 
Elemento 2 4 2 3 - 

 
 

Neste caso, as matrizes de posições de cada um dos elementos terão a forma 

 

1

1 2 3 4
5 6 8 9

e
13 14 16 17
18 19 20 21

? ?
? ?
? ?=
? ?
? ?
? ?

 e 2

16 14 15
e 8 6 7

12 10 11

? ?
? ?= ? ?
? ?? ?

 



222 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

que correspondem as posições destacadas nos vetores de valores da Fig. A4.1. 

O procedimento de construção da matriz esparsa (três vetores) e das matrizes locais de 

endereços pode ser resumido da seguinte forma: 

 

1. Inicializar matrizes de valores inteiros de NNExNNE para cada elemento e dois vetores 

globais de valores inteiros de dimensões 1x(16*NElm), onde NNE  é o número de nós 

do elemento e NElm é o número de elementos da malha. 

 

2. Visitar cada elemento da malha e: 

 

a) escrever a localização da linha e coluna da matriz global nos dois vetores 

globais e escrever esta localização na matriz local de endereços a partir da 

matriz de conectividades fornecida pelo gerador de malhas; 

b) criar um vetor auxiliar que conterá a localização do aparecimento do 

primeiro nó. Esse vetor facilitará a procura por posições correspondentes a 

conexões entre nós que já estão definidas. 

c) sempre que se passar a um novo elemento, checar no vetor auxiliar se a 

posição nos vetores correspondentes a uma posição na linha i e coluna j já 

foi criada. 

 

3. Eliminar as posições alocadas nos vetores globais que não receberam valores. 

 

4. Inicializar um terceiro vetor global de valores de dupla precisão, de mesmas 

dimensões dos dois anteriores, que receberá os dados da matriz de coeficientes.  

 

5. Ordenar os vetores globais de posição em ordem crescente de linha e coluna, para a 

obtenção de vetores ordenados como os demonstrados na Fig. A4.1, e atualizar as 

matrizes locais de endereços de acordo com os novos vetores globais. Este 

procedimento é importante porque acelera o processo de resolução do sistema linear, 

que passa a receber uma matriz esparsa com valores ordenados. 

 

6. Criar um vetor contendo a informação da localização dos dados referentes a diagonal 

da matriz dos coeficientes nos vetores globais. Esse vetor terá muita utilidade na 



 ANEXO 4 – ESQUEMA DE TRANSFERÊNCIA DE DADOS PARA MATRIZES ESPARSAS 223 

 

 

adição  das informações dos termos transientes e de poços na matriz esparsa em cada 

nível temporal.  

 

Deve destacar novamente que com este procedimento não é mais necessário trabalhar 

com os índices relacionados a uma matriz cheia. Isso só é possível porque cada elemento 

conhece a posição que os dados calculados devem ser acrescentados no vetor de valores. 

Portanto, uma vez definidos os vetores globais, não é mais necessário qualquer correlação de 

posições  linha-coluna com a posição no vetor global. 

 

 

A4.1 Bibliografia 
 

SAAD, Y., 2000. Iterative Methods for Sparse Linear Systems, 2nd Ed., PWS Publishing 

Company, Boston. 

 



 



225 

Anexo    

5 
MMÉÉTTOODDOOSS  DDEE  RREELLAAXXAAÇÇÃÃOO    
EEMMPPRREEGGAADDOOSS  NNOO  MMUULLTTIIGGRRIIDD  

  

 

 

 Os métodos utilizados para obter a solução das diversas malhas empregadas no 

multigrid são apresentados sucintamente neste capítulo. Conforme mencionado no Cap. 6, as 

equações da malha mais grosseira são resolvidas com o método direto LU, enquanto que as 

equações das demais malhas utilizadas no multigrid são resolvidas com os solvers iterativos 

ILU(0) ou Gauss-Seidel.  

Os dois primeiros solvers caracterizam-se por transformar a matriz original [A] em um 

produto de duas matrizes triangulares [L] e [U], na forma 

 

 [ ] [ ][ ]

( ) ( )

( ) ( )

( )

1 1
11 1

2 2
22 221

1 1

1 0 0
01

0
1 0 0

n

n

n
n nn nn

UL

a a

a am
A L U

m m a?

? ?? ? ? ?? ? ? ?? ?= = ? ?? ? ? ?? ? ? ?? ? ? ?

 (A5.1) 

 

onde [L] é a matriz triangular inferior com diagonal unitária e [U] a matriz triangular superior. 

Dessa forma, a solução do sistema linear resultante pode ser obtida pelos processos de 

substituição ascendente e descendente, como demonstrado na seqüência. 

 O método de Gauss-Seidel, por sua vez, pertence à classe dos métodos ponto a ponto e 

resolve o sistema linear iterativamente, equação por equação, utilizando os valores das 

variáveis calculadas no ciclo iterativo anterior e também as novas variáveis neste ciclo. 

 Os três solvers mencionados neste capítulo serão descritos com mais detalhes na 

seqüência, enfatizando, principalmente, aspectos de implementação computacional. 

 

 



226 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

A5.1. Método Direto LU de Resolução de Sistema Linear  
  

 O método direto de resolução de sistema linear LU é uma forma modificada do 

método de Eliminação de Gauss. Neste método o sistema linear original  

 

 [ ]{ } { }A b=?  (A5.2) 
 

é escrito como 

  

 [ ][ ]{ } { }L U b=?  (A5.3) 
 

onde [L] e [U] são as matrizes definidas na Eq. (A5.1). Definindo um vetor auxiliar { }V como 
 

 [ ][ ]{ }
{ }

{ }
V

L U b=?  (A5.4) 

 

a solução do sistema linear original pode ser obtida resolvendo-se dois sistemas lineares mais 

simples, sendo o primeiro o que determina o vetor { }V  
 

 [ ]{ } { }L V b=  (A5.5) 
 

e na seqüência, o que determina o vetor solução desejado 

  

 [ ]{ } [ ]U V=?  (A5.6) 
 

 Embora pareça que o custo computacional é grande pela resolução de dois sistemas 

lineares, esse processo é facilitado tomando-se proveito da definição das duas matrizes 

triangulares, resolvendo-se cada sistema das Eqs. (A5.5) e (A5.6) através de substituições 

sucessivas: 

 

 descendentes: 



 ANEXO  5 –  MÉTODOS DE RELAXAÇÃO EMPREGADOS NO MULTIGRID 227 

 

 

 

( )

( )

( ) ( ) ( )

1
1

1 1
11

1

1

/                     para  desde 2 até 
k

k k k
k k kj j kk

j

b
V

L

V b L V L k n
?

=

?
=?

?
?

? ??
= ?? ??

? ? ?
?

 (A5.7) 

 

e  

 ascendentes: 

 

( )

( )

( ) ( ) ( )

1

/                     para  desde ( -1) até 1

n
n

n n
nn

n
k k k

k k kj j kk
j k

V
U

V U U k n
= +

?
=?

?
?

? ?? = ?? ??
? ? ?

?

?

? ?

 (A5.8) 

 

onde n é a dimensão da matriz original. 

 

  

A5.2. Determinação das Matrizes Triangulares [L]  e [U] 
 

 O processo de determinação das matrizes utilizadas no método LU consiste em (n -1) 

passos, onde os elementos ( )1kija
+  da Eq. (A5.1) são construídos a partir dos elementos ( )kija , 

considerando como ( )1ija  a matriz inicial. Este processo tem início pelo cálculo dos termos 

multiplicadores, ikm , que são aqueles que alimentam a matriz [L], e são utilizados para zerar 

os elementos necessários para criar a matriz [U], 

 

 
( ) ( )

( ) ( ) ( )1
ij

/                             para  desde  até 

                   para  desde  até 

k k
ik ik kk

k k k
ij ik kj

m a a i k + 1 n

a a m a i, j k + 1 n+

? =?
?
? = ??

 (A5.9) 

 

 No método implementado neste trabalho não se considera a possibilidade de haver 

termos nulos na diagonal, caso contrário seria necessário a troca de linhas antes de resolver a 

Eq. (A5.9). 

 

 



228 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

A5.3. Método de Resolução de Sistema Linear Baseado na 
Decomposição Incompleta ILU(0) 

 

Este método baseia-se na construção de uma matriz de coeficientes incompleta, isto é, 

que não possui todos os coeficientes da matriz original, mas que é bastante próxima dela, e 

busca resolver iterativamente o sistema linear resultante através de um método que é eficiente 

ao trabalhar com matrizes deste tipo (MALISKA, 2004). A decomposição incompleta ILU(0) 

é uma das formas de obter uma matriz próxima à original. 

O processo de construção das matrizes [L] e [U] incompletas é praticamente idêntico 

ao do método LU tradicional, a menos do fato de que apenas os valores não-nulos na matriz 

original são modificados. Esta é uma característica importante porque este procedimento, 

denominado de fatoração ILU(0), não altera o formato de armazenamento da matriz de dados, 

e portanto, não demanda reformatação da matriz esparsa.  

Obtidas as matrizes incompletas, doravante denominadas de [ ]´L  e [ ]´U , inicia-se o 
processo iterativo, determinando-se uma correção nas variáveis com o método de 

decomposição LU e as atualizando,  até atingir a norma do resíduo escolhido, como 

demonstrado na seqüência. 

Definindo a expressão de um resíduo calculado com a matriz original [A] em uma 

iteração ? como 

 

 { } [ ]{ } { }A b? ?= ??R  (A5.10)  
 

e uma fórmula de recorrência que utiliza a expressão deste resíduo e também as matrizes 

incompletas [L] e [U], dada por 

 

 [ ][ ]{ } [ ][ ]{ } { }1´ ´ ´ ´L U L U? ? ?+ = ?? ? R  (A5.11)  
  

pode-se mostrar que a solução convergida não tem influência das matrizes incompletas [ ]´L  e 

[ ]´U , pois, neste caso, o vetor { }R  se anula e { } { }1? ?+ =? ? .  
 Assim, reescrevendo a Eq. (A5.11) utilizando a definição de uma correção do campo 

de ?  na forma 



 ANEXO  5 –  MÉTODOS DE RELAXAÇÃO EMPREGADOS NO MULTIGRID 229 

 

 

 { } { } { }1 1? ? ?? + += ?? ?  (A5.12)  
 

obtém-se 

  

 [ ][ ]{ } { }1´ ´L U ? ?? + = ? R  (A5.13) 
 

Como as duas matrizes do sistema linear da equação anterior são definidas como 

triangulares inferior e superior, a solução deste sistema pode ser obtida simplesmente 

fazendo-se dois processos de substituições sucessivas, através da definição de um vetor 

auxiliar { }V , 
 

 { } [ ]{ }1 1´V U? ??+ +=  (A5.14) 
 

o que reduz o sistema linear da Eq. (A5.13) a 

 

 [ ]{ } { }1´L V ? ?+ = ? R  (A5.15) 
 

 Obtido o campo de { }V  com a solução da Eq. (A5.15), resolve-se a Eq. (A5.14) para 

obter o campo da correção { }?  que é utilizada, por sua vez, para avançar a solução para o 
novo nível iterativo. Calcula-se o novo vetor de resíduos, Eq. (A5.10), repetindo todo esse 

processo até que a norma do resíduo seja menor que a tolerância especificada. 

 

 

A5.4. Método de Gauss-Seidel 
 

 O Método de Gauss-Seidel, outra opção de solver-base do multigrid, foi implementado 

da forma tradicional que consiste em iterar um número fixo de vezes em cada malha, 

resolvendo equação por equação, utilizando os valores das variáveis calculadas no ciclo 

iterativo anterior e também as novas variáveis neste ciclo. Este procedimento pode ser 

resumido como 



230 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
1

1 1

1 1

1 i n
i i ij j ij j

j j iii

b a a
a

? ? ?
?

+ +

= = +

? ?
= ? ?? ?

? ?
? ?? ? ?  (A5.16) 

 

No Cap. 8, no entanto, utilizou-se também o Método de Gauss-Seidel para avaliar o 

desempenho do multigrid, isto é, procurou-se mostrar a superioridade do método proposto 

comparando-o com métodos tradicionais, como o Gauss-Seidel. Neste caso dever-se-ia 

determinar a norma do resíduo de cada equação para ser utilizada como critério de parada.  

Em situações onde o número de iterações é fixo, o solver Gauss-Seidel implementado de 

acordo com a Eq. (A5.16) aplica-se muito bem. Mas quando se necessita calcular diversas 

vezes o resíduo, este solver pode ser implementado com bastante vantagem utilizando uma 

versão ligeiramente diferente, obtida incluindo o termo ii ia
?? ?  dentro dos colchetes da Eq. 

(A5.16) e somando o termo i
??  no lado direito desta equação, resultando em 

 

 
1

1 1

1

1 i n
i i i ij j ij j

j j iii

b a a
a

? ? ? ?
?

+ +

= =

? ?
= + ? ?? ?

? ?
? ?? ? ? ?  (A5.17) 

 

onde o termo entre colchetes pode ser considerado uma boa estimativa do resíduo da equação. 

Neste caso não é mais necessário o trabalho extra de calcular o resíduo utilizado como critério 

de interrupção do processo iterativo. Note também que o termo entre colchetes dividido por 

iia  é a correção do valor de i
?? . 

 

 

A5.5. Bibliografia 
 

MALISKA, C. R., 2004. Transferência de Calor e Mecânica dos Fluidos Computacional, 2ª.   

Edição revista e ampliada, Livros Técnicos e Científicos Editora, Rio de Janeiro. 

 



231 

Anexo    

6 
FFLLUUXXOOGGRRAAMMAASS  DDOO  SSOOLLVVEERR  

MMUULLTTIIGGRRIIDD  
 

 

 

Nesta seção são apresentados os fluxogramas1 que resumem as rotinas computacionais 

empregadas no software multigrid implementado nesta tese. O significado de cada um dos 

símbolos utilizados pode ser visto na Tab. A6.1, enquanto que os fluxogramas são 

apresentados nas Figs. A6.1 e A6.2. 

 

 
Tab. A6.1 - Símbolos empregados nos fluxogramas 

 

 
 

Terminal Indica início ou fim do processo. 

 

 
 

Operação 
Procedimento executado em um 

local diferente de onde foi 
chamado. 

 

 
 

Operação Local Procedimento completamente executado no local que é chamado. 

 

 
 

Decisão 
Indica  possíveis desvios de acordo 

com as condições estipuladas na 
decisão. 

 

 
 

Laço Repete a execução de um conjunto de instruções. 

 

 
 

Conector Indica final de laço ou recebimento de fluxo desviado. 

                                                 
1 Fluxograma é a técnica de representação gráfica que utiliza símbolos previamente convencionados e que 
permite a descrição clara e precisa do fluxo ou a seqüência de um processo, facilitando a sua análise e redesenho. 



232 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
 

Fig. A6.1 – Fluxograma geral do multigrid 

 



 ANEXO 6 – FLUXOGRAMA DO SOLVER MULTIGRID 233 

 
 
 

 

 
 

Fig. A6.2 – Fluxogramas dos níveis 2 (lado esquerdo) e 3 (lado direito) do multigrid 



 



235 

Anexo    

7 
CCÁÁLLCCUULLOO  DDOO  FFLLUUXXOO  NNAASS  MMAALLHHAASS    
FFOORRMMAADDAASS  PPOORR  EELLEEMMEENNTTOOSS  TTRRIIAANNGGUULLAARREESS    

((UUMMAA  AABBOORRDDAAGGEEMM  DDIIFFEERREENNTTEE  DDAA  AAPPRREESSEENNTTAADDAA  NNOO  CCAAPP..  55  EE  AA  CCOOMMPPAARRAAÇÇÃÃOO                  
CCOOMM  AA  FFOORRMMUULLAAÇÇÃÃOO  UUTTIILLIIZZAADDAA  EEMM  OOUUTTRROOSS  TTRRAABBAALLHHOOSS))  

 

 

 

O procedimento geral de obtenção das equações discretizadas no método EbFVM 

apresentado no Cap. 5 aplica-se para elementos triangulares e quadrangulares. Contudo, a fim 

de avaliar melhor a questão do aparecimento das transmissibilidades negativas discutida no 

Cap. 7, os termos de fluxo das equações são discretizados nesta seção a partir de um 

procedimento um pouco diferente, aplicável apenas para elementos triangulares, mas que 

resulta nas mesmas equações apresentadas no Cap. 5.  

 

Dedução do termo de fluxo. No Método dos Volumes Finitos baseado em Elementos - 

EbFVM, a pressão é avaliada em qualquer ponto do elemento em função dos valores nodais 

utilizando as funções de forma. Para elementos triangulares, tem-se 
 

332211 pNpNpNp ++=  (A7.1) 

 

onde os operadores Ni são as funções de forma e são definidos, para triângulos, como 

 

( )
( )
( )

1

2

3

, 1

,

,

N

N

N

? ? ? ?
? ? ?
? ? ?

= ? ?

=

=

 (A7.2) 

 

A Fig. A7.1 apresenta um elemento triangular nos planos físico (x, y) e transformado 

(?, ?).  

 



236 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 
 

Fig. A7.1 - Elemento triangular nos planos físico e transformado 

 

Pode-se mostrar que as coordenadas de qualquer ponto dentro do elemento também 

podem ser expressas em função dos valores de seus três nós como 

 

( )
( )

1 1 2 2 3 3

1 1 2 2 3 3

,

,

x N x N x N x

y N y N y N y

? ?
? ?

= + +??
?

= + +??
 (A7.3)  

 

Substituindo-se as Eqs. (A7.2) em (A7.1) chega-se a 

 

( ) ( ) ( )1 2 31p p p p? ? ? ?= ? ? + +  (A7.4) 
 

e agrupando-se os termos semelhantes, a equação anterior pode ser reescrita como 

 

( ) ( )
( ) ( )

3 1 2 1 1

3 3 1 2 2 1 1  

p p p p p p

N p p N p p p

? ?= ? + ? +
= ? + ? +

 (A7.5)  

      

Portanto, as derivadas de p em relação a x e y serão dadas por 

 

( ) ( )

( ) ( )

3 2
3 1 2 1

,

3 2
3 1 2 1

,

N Np
p p p p

x x x

N Np
p p p p

y y y

? ?

? ?

? ???
= ? + ?? ? ? ??

?
? ? ??

= ? + ??? ? ??

 (A7.6) 

 



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 237 

 
 
 

 

Porém, para determinar as derivadas das funções de forma xN i ?? /  e  yN i ?? /  utiliza-

se a regra da cadeia, na forma 

 

??? ?
?

?
?

+
?
?

?
?

=
?
? y

y
Nx

x
NN iii       e       

??? ?
?

?
?

+
?
?

?
?

=
?
? y

y
Nx

x
NN iii  (A7.7) 

 

que resulta em um sistema de duas variáveis a duas incógnitas, onde apenas as derivadas de Ni 
em função de x e y não são conhecidas. Assim, resolvendo-se o sistema chega-se a 

 

1
det( )

1
det( )

i i i

i i i

N N Ny y
x J

N N Nx x
y J

? ? ? ?

? ? ? ?

? ? ?? ? ?? ?
= ?? ? ?? ? ? ? ?? ? ?

?
? ? ?? ? ?? ?

= ?? ? ?? ? ? ? ?? ? ?

 (A7.8) 

 

onde )det(J  é o determinante da matriz jacobiana da transformação, dado por 

 

???? ?
?

?
?

?
?
?

?
?

=
yxyx

J )det(  (A7.9) 

 

Já as derivadas de Ni, x e y  em função de ? e ?  podem ser obtidas através de 

 

31 2

31 2

1               0                1

1               1                0

NN N

NN N

? ? ?

? ? ?

?? ?? = ? = =? ? ? ?
??
?
? ?? ?
? = ? = =

? ? ???

 (A7.10) 

 

31 2
1 2 3 3 1

31 2
1 2 3 2 1

NN Nx
x x x x x

NN Nx
x x x x x

? ? ? ?

? ? ? ?

?? ??? = + + = ??? ? ? ??
?
? ?? ??

= + + = ???? ? ? ?

 (A7.11) 

 



238 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

31 2
1 2 3 3 1

31 2
1 2 3 2 1

NN Ny
y y y y y

NN Ny
y y y y y

? ? ? ?

? ? ? ?

?? ??? = + + = ??? ? ? ??
?
? ?? ??

= + + = ???? ? ? ?

 (A7.12) 

 

Substituindo-se as Eq. (A7.11) e (A7.12) em (A7.8), as derivadas das funções de 

forma e o determinante da matriz jacobiana resultam em 

 

( ) ( ) ( )

( ) ( ) ( )

31 2
2 3 3 1 1 2

31 2
3 2 1 3 2 1

1 1 1
          

det( ) det( ) det( )

1 1 1
          

det( ) det( ) det( )

NN N
y y y y y y

x J x J x J

NN N
x x x x x x

y J y J y J

?? ?? = ? = ? = ?? ? ? ?
??
?
? ?? ?
? = ? = ? = ?

? ? ???

 (A7.13) 

 

( )( ) ( )( )12131312)det( yyxxyyxxJ ?????=  (A7.14)  
 

 Substituindo-se as expressões da Eq. (A7.13) na Eq. (A7.6), e reconhecendo-se que o 

gradiente de p é definido como 

 

j
y
p

i
x
p

p ˆˆ
?
?

+
?
?

=?  (A7.15) 

 

 pode-se reescrevê-lo na forma 

 

( ) ( ) ( ) ( )

( ) ( ) ( ) ( )

2 1 3 1 3 1 2 1

3 1 2 1 2 1 3 1

ˆ
det( )

ˆ           
det( )

p p y y p p y y
p i

J

p p x x p p x x
j

J

? ? ? ? ?? ?
? = +? ?

? ?

? ? ? ? ?? ?
+ ? ?
? ?

 (A7.16) 

 

Para simplificar a nomenclatura e facilitar a comparação com as deduções utilizadas 

freqüentemente na literatura (FUNG et al., 1991), adotar-se-á a seguinte convenção 

 

1 3 2 2 1 3 3 2 1

1 2 3 2 3 1 3 1 2

                            

                            

a x x a x x a x x

b y y b y y b y y

= ? = ? = ?

= ? = ? = ?
 (A7.17)  



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 239 

 
 
 

 

onde 1, 2 e 3 são os nós do elemento triangular dado na Fig. A7.1. Reescrevendo a Eq. 

(A7.16), é possível mostrar que 

 

( )
3

1

1 ˆ ˆ
2 i i ii

p b i a j p
A =

? = +?  (A7.18) 

 

onde, por conveniência, o determinante da matriz jacobiana foi substituído pelo dobro da área, 

A, do triângulo. 

Substituindo-se a Eq. (A7.18) na expressão do termo de fluxo discretizado, 

 

( ). .
V S

k p dV k p dS? ?? ? = ?? ?  (A7.19) 

 

chega-se a 
 

( ) ( )
3

1

1 ˆ ˆ. .
2 i i iiV S

k p dV b i a j p k dS
A

? ?
=

? ? = +?? ?  (A7.20) 

 

A questão agora é determinar o produto escalar da Eq. (A7.20). O vetor área presente 

nesta expressão deve ser definido de tal forma que a sua direção normal aponte para fora do 

volume de controle, pois garante que a forma usual do balanço de massa no volume de 

controle seja satisfeito 

 

( )entra sai pi
pi

M
M M V dS

t
?

?
? = ? ? =

??  (A7.21) 

 

onde entraM  e saiM  são os fluxos que entram e saem do volume de controle e /M t? ?  é a sua 

variação de massa. 

Adotando um sentido anti-horário de integração na superfície, pode-se mostrar 

(MALISKA, 2004) que o vetor normal à determinada superfície, Sd , estará sempre se 

dirigido para fora do volume de controle se for expresso como 

 

jdxidySd ˆˆ ?=  (A7.22) 



240 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

que escrevendo em termos das coordenadas locais (?, ?) e utilizando a regra da cadeia, chega-

se a 

 

jd
x

d
x

id
y

d
y

Sd ˆˆ ??
?

?
??
?

?
?
?

+
?
?

???
?

?
??
?

?
?
?

+
?
?

= ?
?

?
?

?
?

?
?

 (A7.23) 

 

Substituindo-se a Eq. (A7.23) em (A7.20), obtém-se 

 

( ) ( )
3

1

1 ˆ ˆ. .
2

ˆ ˆ                                       

i i i
iV S

k p dV b i a j p k
A

y y x x
d d i d d j

? ?

? ? ? ?
? ? ? ?

=

? ? = +

? ?? ? ? ?? ? ? ?
+ ? +? ?? ? ? ?? ? ? ?? ? ? ?? ?

?? ?
 (A7.24) 

 

Em uma situação bidimensional, o tensor k  é escrito como 

 

?
?

?
?
?

?
=

yyyx

xyxx

kk
kk

k   (A7.25) 

 

 e substituindo-o na Eq. (A7.24), realizando-se o produto escalar, chega-se a 

 

( ) ( )
( )

( )

1 1 2 2 3 3

1 1 2 2 3 3

1 1 2 2 3 3

1
.

2

                                   

                                   

xx
V S

xy

yx

y y
k p dV k b p b p b p d d

A

y y
k a p a p a p d d

x x
k b p b p b p d d

? ? ? ?
? ?

? ? ?
? ?

? ? ?
? ?

? ? ?? ?
? ? = + + + +? ? ?? ?? ??

? ?? ?
+ + + + +? ?? ?? ?

? ?
? + + +

? ?

? ?

( )1 1 2 2 3 3                                   yy
x x

k a p a p a p d d? ? ?
? ?

? ?
+? ?

? ?
?? ?? ?

? + + + ?? ?? ?? ??

 (A7.26) 

            

 Substituindo-se as Eq. (A7.11) e (A7.12) em (A7.26), obtém-se 
 



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 241 

 
 
 

 

( ) ( ) ( )
( ) ( )
( ) ( )

1 1 2 2 3 3 2 3

1 1 2 2 3 3 2 3

1 1 2 2 3 3 3 2

1
.

2
                                   

                                   

                        

xx
V S

xy

yx

k p dV k b p b p b p b d b d
A

k a p a p a p b d b d

k b p b p b p a d a d

? ? ? ?

? ? ?

? ? ?

? ? = + + ? +??

+ + + ? +

? + + ? +

? ?

( ) ( )1 1 2 2 3 3 3 2           yyk a p a p a p a d a d? ? ?? + + ? ??

 (A7.27) 

 

Percebe-se que todos os termos do integrando da Eq. (A7.27), com exceção da 

mobilidade ?, são constantes dentro do elemento, pois dependem apenas dos valores nodais, e 

podem ser tirados para fora da integral, na forma 

 

( ) ( )
( )

( )

1 1 2 2 3 3

1 1 2 2 3 3 2 3

1 1 2 2 3 3

1
.

2

                                 

1
                                 

2

                               

xx
V

xy
S S

yx

k p dV k b p b p b p
A

k a p a p a p b d b d

k b p b p b p
A

?

? ? ? ?

? ? = + + +??

? ?
?+ + + ? +? ??
? ?

?+ ? + + +?

?

? ?

( )1 1 2 2 3 3 3 2  yy
S S

k a p a p a p a d a d? ? ? ?
? ?

? + + ?? ? ??
? ?
? ?

 (A7.28)  

 

Neste momento torna-se necessária a definição dos sub-volumes de controle, pois são 

sobre suas faces que a integração de superfície é efetuada. A Fig. A7.2 apresenta os sub-

volumes nos planos físico e transformado. Nota-se que cada um dos três sub-volumes 

pertencentes a um elemento triangular farão parte de três volumes de controle distintos. Estes 

volumes de controle apresentam-se numerados de 1 a 3 no plano físico da Fig. A7.2. Deve-se 

notar também que os pontos de integração estão localizados no centro das faces que separam 

os sub-volumes num mesmo elemento. 

 

 



242 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

 

Fig. A7.2 - Elemento triangular, destacando os sub-volumes (Svc) e os pontos de integração (ip) 

 

 

Os sub-volumes são construídos a partir de retas que saem do ponto médio de uma 

face até o baricentro do triângulo. Portanto, as coordenadas x e y, no plano físico, e ? e ?, no 

plano transformado, do ponto central serão dadas por 

 
3 3

1 1
/ 3                           / 3i i

i i
x x y y

= =

= =? ?  (A7.29) 

e 
3 3

1 1

/ 3 1/ 3                / 3 1/ 3i i
i i

? ? ? ?
= =

= = = =? ?  (A7.30) 

 

Assumindo que a integração da mobilidade na superfície de um volume de controle 

possa ser representada pelo valor médio nesta superfície, então as integrais da Eq. (A7.28), 

por inspeção da Fig. A7.2, resultam em dois possíveis valores em cada ponto de integração 

 

( ) ( )

( ) ( )

( ) ( )

1 11 1
1 1

2 22 2
2 2

3 33 3
3 3

1 1
            

3 6

1 1
           

6 3

1 1
            

6 6

ip ipSip Sip
Sip Sip

ip ipSip Sip
Sip Sip

ip ipSip Sip
Sip Sip

d d

d d

d d

? ? ? ? ? ? ? ? ? ?

? ? ? ? ? ? ? ? ? ?

? ? ? ? ? ? ? ? ? ?

= ? = ± = ? = ±

= ? = ± = ? = ±

= ? = ± = ? = ±

? ?

? ?

? ?

  (A7.31) 

 



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 243 

 
 
 

 

onde Sip1 é a superfície que contém o ponto de integração 1, e assim por diante. A definição 

de que sinal deverá ser utilizado no equacionamento dependerá do sub-volume que estará 

sendo submetido à integração. Deve-se lembrar que a regra adotada para a determinação das 

áreas consiste em percorrer no sentido anti-horário os sub-volumes de controle, como 

demonstram as setas apresentadas na Fig. A7.3, calculando-se ??  e ?? . 

 

 

 

Fig. A7.3 - Elemento triangular, destacando, através de setas, a convenção adotada para a definição do sinal das 

integrais de superfície  

 

 A implementação computacional da Eq. (A7.28) para cada um dos sub-volumes de 

controle do elemento pode ser facilitada se o gradiente de pressão contido nela for escrito de 

forma diferente para cada sub-volume de controle: 

 

Scv1:  ( ) ( ) ( ) ( ) ( )
3

2 1 3 1 3 1 2 1
1

ˆ ˆ ˆ
i i i

i
b i a j P p p y y p p y y i

=

+ = ? ? ? ? ? +? ?? ??                    

                                         ( )( ) ( ) ( )3 1 2 1 2 1 3 1 ˆp p x x p p x x j+ ? ? ? ? ?? ?? ?  

                                   ( ) ( ) ( ) ( )2 1 2 3 1 3 2 1 2 3 1 3ˆ ˆp p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  

 (A7.32)  

 

Scv2:  ( ) ( )( ) ( ) ( )
3

1 2 2 3 3 2 1 2
1

ˆ ˆ ˆ
i i i

i
b i a j P p p y y p p y y i

=

+ = ? ? + ? ? +? ?? ??                    

                                         ( ) ( ) ( ) ( )1 2 3 2 3 2 2 1 ˆp p x x p p x x j+ ? ? + ? ?? ?? ?  



244 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

                                   ( ) ( ) ( ) ( )1 2 1 3 2 3 1 2 1 3 2 3ˆ ˆp p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  

 (A7.33)  

 

Scv3:  ( ) ( )( ) ( ) ( )
3

1 3 2 3 2 3 3 1
1

ˆ ˆ ˆ
i i i

i
b i a j P p p y y p p y y i

=

+ = ? ? + ? ? +? ?? ??                             

                                         ( ) ( ) ( ) ( )1 3 3 2 2 3 1 3 ˆp p x x p p x x j+ ? ? + ? ?? ?? ?  

                                   ( ) ( ) ( ) ( )1 3 1 2 3 2 1 3 1 2 3 2ˆ ˆp p b p p b i p p a p p a j= ? + ? + ? + ?? ? ? ?? ? ? ?  

 (A7.34)  

 

 O gradiente de pressão escrito desta forma, diferente para cada sub-volume de 

controle, permite obter equações discretizadas parecidas com as obtidas com o método dos 

volumes finitos tradicional, isto é, em cada uma delas o coeficiente da diagonal será 

determinado diretamente pela soma dos coeficientes dos sub-volumes de controle vizinhos. 

Isso será constatado nas equações deduzidas a seguir. 

 

Dedução das equações para o scv1. Para o sub-volume 1 da Fig. A7.3, por exemplo, 

os valores utilizados para a integral de superfície em ? e ? nos pontos de integração 1 e 2 

serão, respectivamente  
 

1 1
1 1 1 111

1 11 1

1 1
           

3 6
Svc Svc

ip ip ip ipSipSip
Sip SipSvc Svc

d d? ? ? ? ? ? ? ? ? ?= ? = ? = ? =? ?  (A7.35)  

e 

1 1
2 2 2 22 2

2 21 1

1 1
           

6 3
Svc Svc

ip ip ip ipSip Sip
Sip SipSvc Svc

d d? ? ? ? ? ? ? ? ? ?= ? = ? = ? =? ?   (A7.36) 

 

onde 
1

2

Svc

Sip
??  representa o deslocamento na direção ?  avaliada no ponto de integração 2 na 

equação do sub-volume de controle 1. Para os outros termos a explicação é análoga. A partir 

deste ponto será utilizada esta simbologia para a representação das integrais nos pontos de 

integração. Assim, a Eq. (A7.28) será escrita na forma 

 



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 245 

 
 
 

 

( ) ( ) ( ){ 2 1 2 3 1 3
1

1
.

2 xxscv
k p dV k p p b p p b

A
?? ? = ? + ? +? ?? ??    

                            ( ) ( ) }2 1 2 3 1 3 2 1 2 3 1 21 1 1 16 3 3 6xy ip ip ip ipk p p a p p a b b? ? ? ?
? ?? ? ? ?+ ? + ? + ? ? ? +? ? ? ? ? ?? ?? ?

? ? ? ?? ?
  

   ( ) ( ){ 2 1 2 3 1 312 yxk p p b p p bA+ ? ? + ? +? ?? ?                             

                            ( ) ( ) }2 1 2 3 1 3 2 1 2 3 1 21 1 1 16 3 3 6yy ip ip ip ipk p p a p p a a a? ? ? ?
? ?? ? ? ?? ? + ? ? + + ? ?? ? ? ? ? ?? ?? ?

? ? ? ?? ?
 

 (A7.37)  

 

ou colocando em evidência os valores que multiplicam a mobilidade de um mesmo ponto de 

integração, 

 

( ) ( ) ( ){ 2 1 2 3 1 3
1

. xx
scv

k p dV k p p b p p b? ?? ? = ? + ? +? ?? ???    

       ( ) ( ) 322 1 2 3 1 3 6 3xy
bb

k p p a p p a ? ??+ ? + ? + +? ?? ? ? ?? ? ?
  

    ( ) ( )2 1 2 3 1 3yxk p p b p p b?+ ? + ? +? ?? ??                             

       ( ) ( ) 1322 1 2 3 1 3 6 3 2
ip

yy
aa

k p p a p p a
A

??? ??+ ? + ? + +? ? ?? ? ? ?? ? ??
  

            ( ) ( ){ 2 1 2 3 1 3xxk p p b p p b?+ ? + ? +? ?? ??    
     ( ) ( ) 322 1 2 3 1 3 3 6xy

bb
k p p a p p a ? ??+ ? + ? + +? ?? ? ? ?? ? ?

  

  ( ) ( )2 1 2 3 1 3yxk p p b p p b?+ ? + ? +? ?? ??                                   

                             ( ) ( ) 2322 1 2 3 1 3 3 6 2
ip

yy
aa

k p p a p p a
A

??? ??+ ? + ? +? ? ?? ? ? ?? ? ??
 (A7.38)  

   

Deve-se notar que o valor da mobilidade calculado em cada ponto de integração 

multiplica os três valores nodais da pressão. A equação anterior pode, ainda, ser reescrita 

agrupando os termos que multiplicam cada diferença de pressão, na forma 

 



246 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

( ) ( ) ( )
( ) ( )

1 1

2 2

1 13 3 1 12 2 1
1

2 3 1 2 113 12

.

                                 

ip ip

ip ip

ip
scv

ip

k p dV p p p p

p p p p

? ? ? ?

? ? ?

? ?? ? = ? + ? +? ?

? ?+ ? + ?? ?

?
 (A7.39) 

 

onde 

 

1

3 3 3 33 32 2
13 2 6 3 2 6 3ip

xx xy yx yyk b k a k b k ab ab a
A A

?
+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?

? ? ? ?? ? ? ?
 (A7.40) 

1

2 2 2 23 32 2
12 2 6 3 2 6 3ip

xx xy yx yyk b k a k b k ab ab a
A A

?
+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?

? ? ? ?? ? ? ?
 (A7.41) 

2

3 3 3 33 32 2
13 2 3 6 2 6 3ip

xx xy yx yyk b k a k b k ab ab a
A A

?
+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?

? ? ? ?? ? ? ?
 (A7.42) 

2

2 2 2 23 32 2
12 2 3 6 2 6 3ip

xx xy yx yyk b k a k b k ab ab a
A A

?
+ +? ? ? ?? ? ? ?= + + +? ? ? ?? ? ? ?

? ? ? ?? ? ? ?
 (A7.43) 

 

A primeira parcela da Eq. (A7.39) corresponde ao fluxo entre os sub-volumes de 

controle 1 e 3 (Fig. A7.3), e a segunda parcela corresponde ao fluxo entre os sub-volumes de 

controle 1 e 2. 

 Pode-se, ainda, reduzir a Eq. (A7.39) em uma forma tal em que são explicitadas os 

termos erroneamente denominados de transmissibilidades. Assim,  

 

( ) ( ) ( )13 3 1 12 2 1
1

.
scv

k p dV p p p p?? ? = ? ? + ? ??  (A7.44) 

 

onde 

1 213 1 13 2 13ip ipip ip
? ? ? ?? = +  (A7.45) 

1 212 1 12 2 12ip ipip ip
? ? ? ?? = +  (A7.46) 

  

Apenas nos casos envolvendo escoamentos monofásicos e com propriedades 

constantes, isto é, quando as mobilidades nas Eqs. (A7.45) e (A7.46) são idênticas, é que 

pode-se obter e utilizar a tradicional expressão utilizada em outros trabalhos (FUNG et al., 

1991) 



 ANEXO 7 -  CÁLCULO DOS FLUXOS EM ELEMENTOS TRIANGULARES 247 

 
 
 

 

4
xx i j xy j i yx j i yy i j

ij

k bb k a b k b a k a a
A

+ + +? ?
? = ?? ?

? ?
 (A7.47) 

 

que é obtida pela manipulação das Eqs. (A7.40) a (A7.43), e no caso particular analisado i 

assume valor 1 e j assume 2 e 3, resultando nas transmissibilidade 12?  e 13? , 

respectivamente. Esta restrição na utilização da Eq. (A7.47) não é evidente nos trabalhos 

publicados na literatura específica da área do petróleo. 

 

 

A7.1. Bibliografia 
 

FUNG, L. S., HIEBERT, A. D. and NGHIEM, L., 1991. Reservoir Simulation With a 

Control-Volume Finite-Element Method, SPE paper 21224 presented at the 11th SPE 

Symposium on Reservoir Simulation, Anaheim, California, February 17-20. 

MALISKA, C. R., 2004. Transferência de Calor e Mecânica dos Fluidos Computacional, 2ª.   

Edição revista e ampliada, Livros Técnicos e Científicos Editora, Rio de Janeiro. 

 



 



249 

Anexo    

8 
CCOONNSSIIDDEERRAAÇÇÕÕEESS  SSOOBBRREE  AA      
UUTTIILLIIZZAAÇÇÃÃOO  DDAASS  FFUUNNÇÇÕÕEESS  DDEE  FFOORRMMAA  NNAA  
AAVVAALLIIAAÇÇÃÃOO  DDAASS  MMOOBBIILLIIDDAADDEESS  NNAA  EEQQUUAAÇÇÃÃOO  DDAA  PPRREESSSSÃÃOO  

 

 

 

Nesta seção são apresentados os detalhes referentes à obtenção das equações 

empregadas nos problemas do Cap. 8 quando é utilizada a função de forma como função de 

interpolação na equação da pressão. Neste caso a função de interpolação upwind continua 

sendo usada apenas na equação da saturação. 

Para que seja possível utilizar diferentes funções de interpolação nas duas equações é 

necessário reescrevê-las, isto é, escrevê-las diferentemente do que aparece no texto desta tese. 

Para demonstrar o procedimento de obtenção destas novas equações, considerar-se-á, para 

simplificar, que os fluidos são incompressíveis. Assim, como visto no Cap. 5, a equação da 

saturação tem a forma  

 

( ) ( )( )om m m i m PP
i PP

V
s s k p S q

t
?

?
? ?

?? ? ? = ? ?? +? ??? ?
?  (A8.1)  

 

e a equação da pressão 

 

( )( ) 0T i w o P
i P

k p S q q?
? ?

? ?? + + =?       (A8.2)                 

 

onde oT w? ? ?= + . Essas são as Eq. (5.1) e (5.3) na sua forma simplificada.  

 Note que se for utilizada a função upwind na avaliação da mobilidade da equação da 

saturação, ao mesmo tempo que é utilizada uma função diferente na avaliação da mobilidade 

total na equação da pressão, existirá uma clara inconsistência que deve-se ao fato de que a 

equação da pressão é obtida pela substituição das equações de saturação de cada fase na 



250 J. CORDAZZO: TESE  DE DOUTORADO EM ENGENHARIA MECÂNICA  

 

 

equação da restrição. Por isso propõe-se reescrever a equação da saturação a fim de obter uma 

formulação consistente. 

 Reconhecendo que o fluxo fracionário fm é definido como a relação entre a mobilidade 

da fase e a mobilidade total, 

 

m
m

T

f
?
?

=  (A8.3)              

 

pode-se mostrar que a equação da saturação, Eq. (A8.1), pode ser escrita como 

 

 ( ) ( )( )
i

o
m m m T i m PP

i PP

V
s s f k p S q

t
?

?
? ?

?? ? ? = ? ?? +? ??? ?
?  (A8.4)  

 

que apresenta termos que serão avaliados com diferentes funções de forma: 

 

 
im

f  :  Função de interpolação upwind 

 T?  :  Funções de forma 

 

Como o somatório dos fluxos fracionários de cada fase é igual a unidade, percebe-se 

que a formulação que utiliza funções de forma na avaliação da mobilidade total na equação da 

pressão, Eq. (A8.2), tornou-se consistente. 

 

 


&lt;&lt;
  /ASCII85EncodePages false
  /AllowTransparency false
  /AutoPositionEPSFiles true
  /AutoRotatePages /None
  /Binding /Left
  /CalGrayProfile (Dot Gain 20%)
  /CalRGBProfile (sRGB IEC61966-2.1)
  /CalCMYKProfile (U.S. Web Coated \050SWOP\051 v2)
  /sRGBProfile (sRGB IEC61966-2.1)
  /CannotEmbedFontPolicy /Error
  /CompatibilityLevel 1.4
  /CompressObjects /Tags
  /CompressPages true
  /ConvertImagesToIndexed true
  /PassThroughJPEGImages true
  /CreateJDFFile false
  /CreateJobTicket false
  /DefaultRenderingIntent /Default
  /DetectBlends true
  /ColorConversionStrategy /LeaveColorUnchanged
  /DoThumbnails false
  /EmbedAllFonts true
  /EmbedJobOptions true
  /DSCReportingLevel 0
  /EmitDSCWarnings false
  /EndPage -1
  /ImageMemory 1048576
  /LockDistillerParams false
  /MaxSubsetPct 100
  /Optimize true
  /OPM 1
  /ParseDSCComments true
  /ParseDSCCommentsForDocInfo true
  /PreserveCopyPage true
  /PreserveEPSInfo true
  /PreserveHalftoneInfo false
  /PreserveOPIComments false
  /PreserveOverprintSettings true
  /StartPage 1
  /SubsetFonts true
  /TransferFunctionInfo /Apply
  /UCRandBGInfo /Preserve
  /UsePrologue false
  /ColorSettingsFile ()
  /AlwaysEmbed [ true
  ]
  /NeverEmbed [ true
  ]
  /AntiAliasColorImages false
  /DownsampleColorImages true
  /ColorImageDownsampleType /Bicubic
  /ColorImageResolution 300
  /ColorImageDepth -1
  /ColorImageDownsampleThreshold 1.50000
  /EncodeColorImages true
  /ColorImageFilter /DCTEncode
  /AutoFilterColorImages true
  /ColorImageAutoFilterStrategy /JPEG
  /ColorACSImageDict&amp;lt;&lt;
    /QFactor 0.15
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  &gt;&gt;
  /ColorImageDict&amp;lt;&lt;
    /QFactor 0.15
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  &gt;&gt;
  /JPEG2000ColorACSImageDict&amp;lt;&lt;
    /TileWidth 256
    /TileHeight 256
    /Quality 30
  &gt;&gt;
  /JPEG2000ColorImageDict&amp;lt;&lt;
    /TileWidth 256
    /TileHeight 256
    /Quality 30
  &gt;&gt;
  /AntiAliasGrayImages false
  /DownsampleGrayImages true
  /GrayImageDownsampleType /Bicubic
  /GrayImageResolution 300
  /GrayImageDepth -1
  /GrayImageDownsampleThreshold 1.50000
  /EncodeGrayImages true
  /GrayImageFilter /DCTEncode
  /AutoFilterGrayImages true
  /GrayImageAutoFilterStrategy /JPEG
  /GrayACSImageDict&amp;lt;&lt;
    /QFactor 0.15
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  &gt;&gt;
  /GrayImageDict&amp;lt;&lt;
    /QFactor 0.15
    /HSamples [1 1 1 1] /VSamples [1 1 1 1]
  &gt;&gt;
  /JPEG2000GrayACSImageDict&amp;lt;&lt;
    /TileWidth 256
    /TileHeight 256
    /Quality 30
  &gt;&gt;
  /JPEG2000GrayImageDict&amp;lt;&lt;
    /TileWidth 256
    /TileHeight 256
    /Quality 30
  &gt;&gt;
  /AntiAliasMonoImages false
  /DownsampleMonoImages true
  /MonoImageDownsampleType /Bicubic
  /MonoImageResolution 1200
  /MonoImageDepth -1
  /MonoImageDownsampleThreshold 1.50000
  /EncodeMonoImages true
  /MonoImageFilter /CCITTFaxEncode
  /MonoImageDict&amp;lt;&lt;
    /K -1
  &gt;&gt;
  /AllowPSXObjects false
  /PDFX1aCheck false
  /PDFX3Check false
  /PDFXCompliantPDFOnly false
  /PDFXNoTrimBoxError true
  /PDFXTrimBoxToMediaBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXSetBleedBoxToMediaBox true
  /PDFXBleedBoxToTrimBoxOffset [
    0.00000
    0.00000
    0.00000
    0.00000
  ]
  /PDFXOutputIntentProfile ()
  /PDFXOutputCondition ()
  /PDFXRegistryName (http://www.color.org)
  /PDFXTrapped /Unknown

  /Description&amp;lt;&lt;
    /ENU (Use these settings to create PDF documents with higher image resolution for high quality pre-press printing. The PDF documents can be opened with Acrobat and Reader 5.0 and later. These settings require font embedding.)
    /JPN&amp;lt;FEFF3053306e8a2d5b9a306f30019ad889e350cf5ea6753b50cf3092542b308030d730ea30d730ec30b9537052377528306e00200050004400460020658766f830924f5c62103059308b3068304d306b4f7f75283057307e305930023053306e8a2d5b9a30674f5c62103057305f00200050004400460020658766f8306f0020004100630072006f0062006100740020304a30883073002000520065006100640065007200200035002e003000204ee5964d30678868793a3067304d307e305930023053306e8a2d5b9a306b306f30d530a930f330c8306e57cb30818fbc307f304c5fc59808306730593002&gt;
    /FRA&amp;lt;FEFF004f007000740069006f006e007300200070006f0075007200200063007200e900650072002000640065007300200064006f00630075006d0065006e00740073002000500044004600200064006f007400e900730020006400270075006e00650020007200e90073006f006c007500740069006f006e002000e9006c0065007600e9006500200070006f0075007200200075006e00650020007100750061006c0069007400e90020006400270069006d007000720065007300730069006f006e00200070007200e9007000720065007300730065002e0020005500740069006c006900730065007a0020004100630072006f0062006100740020006f00750020005200650061006400650072002c002000760065007200730069006f006e00200035002e00300020006f007500200075006c007400e9007200690065007500720065002c00200070006f007500720020006c006500730020006f00750076007200690072002e0020004c00270069006e0063006f00720070006f0072006100740069006f006e002000640065007300200070006f006c0069006300650073002000650073007400200072006500710075006900730065002e&gt;
    /DEU&amp;lt;FEFF00560065007200770065006e00640065006e0020005300690065002000640069006500730065002000450069006e007300740065006c006c0075006e00670065006e0020007a0075006d002000450072007300740065006c006c0065006e00200076006f006e0020005000440046002d0044006f006b0075006d0065006e00740065006e0020006d00690074002000650069006e006500720020006800f60068006500720065006e002000420069006c0064006100750066006c00f600730075006e0067002c00200075006d002000650069006e00650020007100750061006c00690074006100740069007600200068006f006300680077006500720074006900670065002000410075007300670061006200650020006600fc0072002000640069006500200044007200750063006b0076006f0072007300740075006600650020007a0075002000650072007a00690065006c0065006e002e00200044006900650020005000440046002d0044006f006b0075006d0065006e007400650020006b00f6006e006e0065006e0020006d006900740020004100630072006f0062006100740020006f0064006500720020006d00690074002000640065006d002000520065006100640065007200200035002e003000200075006e00640020006800f600680065007200200067006500f600660066006e00650074002000770065007200640065006e002e00200042006500690020006400690065007300650072002000450069006e007300740065006c006c0075006e00670020006900730074002000650069006e00650020005300630068007200690066007400650069006e00620065007400740075006e00670020006500720066006f0072006400650072006c006900630068002e&gt;
    /PTB&amp;lt;FEFF005500740069006c0069007a006500200065007300740061007300200063006f006e00660069006700750072006100e700f5006500730020007000610072006100200063007200690061007200200064006f00630075006d0065006e0074006f0073002000500044004600200063006f006d00200075006d00610020007200650073006f006c007500e700e3006f00200064006500200069006d006100670065006d0020007300750070006500720069006f0072002000700061007200610020006f006200740065007200200075006d00610020007100750061006c0069006400610064006500200064006500200069006d0070007200650073007300e3006f0020006d0065006c0068006f0072002e0020004f007300200064006f00630075006d0065006e0074006f0073002000500044004600200070006f00640065006d0020007300650072002000610062006500720074006f007300200063006f006d0020006f0020004100630072006f006200610074002c002000520065006100640065007200200035002e00300020006500200070006f00730074006500720069006f0072002e00200045007300740061007300200063006f006e00660069006700750072006100e700f50065007300200072006500710075006500720065006d00200069006e0063006f00720070006f0072006100e700e3006f00200064006500200066006f006e00740065002e&gt;
    /DAN&amp;lt;FEFF004200720075006700200064006900730073006500200069006e0064007300740069006c006c0069006e006700650072002000740069006c0020006100740020006f0070007200650074007400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006d006500640020006800f8006a006500720065002000620069006c006c00650064006f0070006c00f80073006e0069006e0067002000740069006c0020007000720065002d00700072006500730073002d007500640073006b007200690076006e0069006e0067002000690020006800f8006a0020006b00760061006c0069007400650074002e0020005000440046002d0064006f006b0075006d0065006e007400650072006e00650020006b0061006e002000e50062006e006500730020006d006500640020004100630072006f0062006100740020006f0067002000520065006100640065007200200035002e00300020006f00670020006e0079006500720065002e00200044006900730073006500200069006e0064007300740069006c006c0069006e0067006500720020006b007200e600760065007200200069006e0074006500670072006500720069006e006700200061006600200073006b007200690066007400740079007000650072002e&gt;
    /NLD&amp;lt;FEFF004700650062007200750069006b002000640065007a006500200069006e007300740065006c006c0069006e00670065006e0020006f006d0020005000440046002d0064006f00630075006d0065006e00740065006e0020007400650020006d0061006b0065006e0020006d00650074002000650065006e00200068006f00670065002000610066006200650065006c00640069006e00670073007200650073006f006c007500740069006500200076006f006f0072002000610066006400720075006b006b0065006e0020006d0065007400200068006f006700650020006b00770061006c0069007400650069007400200069006e002000650065006e002000700072006500700072006500730073002d006f006d0067006500760069006e0067002e0020004400650020005000440046002d0064006f00630075006d0065006e00740065006e0020006b0075006e006e0065006e00200077006f007200640065006e002000670065006f00700065006e00640020006d006500740020004100630072006f00620061007400200065006e002000520065006100640065007200200035002e003000200065006e00200068006f006700650072002e002000420069006a002000640065007a006500200069006e007300740065006c006c0069006e00670020006d006f006500740065006e00200066006f006e007400730020007a0069006a006e00200069006e006700650073006c006f00740065006e002e&gt;
    /ESP&amp;lt;FEFF0055007300650020006500730074006100730020006f007000630069006f006e006500730020007000610072006100200063007200650061007200200064006f00630075006d0065006e0074006f0073002000500044004600200063006f006e0020006d00610079006f00720020007200650073006f006c00750063006900f3006e00200064006500200069006d006100670065006e00200071007500650020007000650072006d006900740061006e0020006f006200740065006e0065007200200063006f007000690061007300200064006500200070007200650069006d0070007200650073006900f3006e0020006400650020006d00610079006f0072002000630061006c0069006400610064002e0020004c006f007300200064006f00630075006d0065006e0074006f00730020005000440046002000730065002000700075006500640065006e00200061006200720069007200200063006f006e0020004100630072006f00620061007400200079002000520065006100640065007200200035002e003000200079002000760065007200730069006f006e0065007300200070006f00730074006500720069006f007200650073002e0020004500730074006100200063006f006e0066006900670075007200610063006900f3006e0020007200650071007500690065007200650020006c006100200069006e0063007200750073007400610063006900f3006e0020006400650020006600750065006e007400650073002e&gt;
    /SUO&amp;lt;FEFF004e00e4006900640065006e002000610073006500740075007300740065006e0020006100760075006c006c006100200076006f0069006400610061006e0020006c0075006f006400610020005000440046002d0061007300690061006b00690072006a006f006a0061002c0020006a006f006900640065006e002000740075006c006f0073007400750073006c00610061007400750020006f006e0020006b006f0072006b006500610020006a00610020006b007500760061006e0020007400610072006b006b007500750073002000730075007500720069002e0020005000440046002d0061007300690061006b00690072006a0061007400200076006f0069006400610061006e0020006100760061007400610020004100630072006f006200610074002d0020006a0061002000520065006100640065007200200035002e00300020002d006f0068006a0065006c006d0061006c006c0061002000740061006900200075007500640065006d006d0061006c006c0061002000760065007200730069006f006c006c0061002e0020004e00e4006d00e4002000610073006500740075006b0073006500740020006500640065006c006c00790074007400e4007600e4007400200066006f006e0074007400690065006e002000750070006f00740075007300740061002e&gt;
    /ITA&amp;lt;FEFF00550073006100720065002000710075006500730074006500200069006d0070006f007300740061007a0069006f006e00690020007000650072002000630072006500610072006500200064006f00630075006d0065006e00740069002000500044004600200063006f006e00200075006e00610020007200690073006f006c0075007a0069006f006e00650020006d0061006700670069006f00720065002000700065007200200075006e00610020007100750061006c0069007400e00020006400690020007000720065007300740061006d007000610020006d00690067006c0069006f00720065002e0020004900200064006f00630075006d0065006e00740069002000500044004600200070006f00730073006f006e006f0020006500730073006500720065002000610070006500720074006900200063006f006e0020004100630072006f00620061007400200065002000520065006100640065007200200035002e003000200065002000760065007200730069006f006e006900200073007500630063006500730073006900760065002e002000510075006500730074006500200069006d0070006f007300740061007a0069006f006e006900200072006900630068006900650064006f006e006f0020006c002700750073006f00200064006900200066006f006e007400200069006e0063006f00720070006f0072006100740069002e&gt;
    /NOR&amp;lt;FEFF004200720075006b00200064006900730073006500200069006e006e007300740069006c006c0069006e00670065006e0065002000740069006c002000e50020006f00700070007200650074007400650020005000440046002d0064006f006b0075006d0065006e0074006500720020006d006500640020006800f80079006500720065002000620069006c00640065006f00700070006c00f80073006e0069006e006700200066006f00720020006800f800790020007500740073006b00720069006600740073006b00760061006c00690074006500740020006600f800720020007400720079006b006b002e0020005000440046002d0064006f006b0075006d0065006e0074006500720020006b0061006e002000e50070006e006500730020006d006500640020004100630072006f0062006100740020006f0067002000520065006100640065007200200035002e00300020006f0067002000730065006e006500720065002e00200044006900730073006500200069006e006e007300740069006c006c0069006e00670065006e00650020006b0072006500760065007200200073006b00720069006600740069006e006e00620079006700670069006e0067002e&gt;
    /SVE&amp;lt;FEFF0041006e007600e4006e00640020006400650020006800e4007200200069006e0073007400e4006c006c006e0069006e006700610072006e00610020006e00e40072002000640075002000760069006c006c00200073006b0061007000610020005000440046002d0064006f006b0075006d0065006e00740020006d006500640020006800f6006700720065002000620069006c0064007500700070006c00f60073006e0069006e00670020006600f60072002000700072006500700072006500730073007500740073006b0072006900660074006500720020006100760020006800f600670020006b00760061006c0069007400650074002e0020005000440046002d0064006f006b0075006d0065006e00740065006e0020006b0061006e002000f600700070006e006100730020006d006500640020004100630072006f0062006100740020006f00630068002000520065006100640065007200200035002e003000200065006c006c00650072002000730065006e006100720065002e00200044006500730073006100200069006e0073007400e4006c006c006e0069006e0067006100720020006b007200e400760065007200200069006e006b006c00750064006500720069006e00670020006100760020007400650063006b0065006e0073006e006900740074002e&gt;
  &gt;&gt;
&gt;&gt; setdistillerparams
&lt;&lt;
  /HWResolution [2400 2400]
  /PageSize [612.000 792.000]
&gt;&gt; setpagedevice





</field>
	</doc>
</add>