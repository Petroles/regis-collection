<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.11780</field>
		<field name="filename">17201_ulfc115926_tm_Artur_Vilela.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

 

  

UNIVERSIDADE DE LISBOA 

FACULDADE DE CIÊNCIAS 

DEPARTAMENTO DE ENGENHARIA GEOGRÁFICA, GEOFÍSICA E ENERGIA 

 

 

 

 
 

 

 

 

 

Desenvolvimento de aplicação informática para cálculo de 

desempenho energético de bombas de calor assistidas por 

energia solar 

 

 

Mestrado Integrado em Engenharia da Energia e do Ambiente 

Dissertação 

 

 

Artur Filipe Felizardo Vilela 

 

 

 

 

2015 



 

 

  

  



 

 

  

UNIVERSIDADE DE LISBOA 

FACULDADE DE CIÊNCIAS 

DEPARTAMENTO DE ENGENHARIA GEOGRÁFICA, GEOFÍSICA E ENERGIA 

 
 
 

 
 

 

 

 

 

Desenvolvimento de aplicação informática para cálculo de 

desempenho energético de bombas de calor assistidas por 

energia solar 

 

 

Mestrado em Engenharia da Energia e do Ambiente 

Dissertação 

 

 
Artur Filipe Felizardo Vilela 

 

Dissertação orientada por: 

Maria João Petronilo de Carvalho (FCUL) 

Jorge Manuel Resende Vieira Facão (LNEG) 

 

 

2015 



 

  i 

Agradecimentos 
 

Em primeiro lugar, agradeço à Doutora Maria João de Carvalho pela oportunidade de realizar 

esta dissertação, por me abrir uma porta quando outra se fechou. 

Ao Doutor Jorge Facão agradeço por toda a ajuda, disponibilidade e paciência para as minhas 

dúvidas, mantendo sempre este trabalho no bom caminho e encontrando soluções onde elas 

pareciam não existir. 

À minha família, aos meus pais, agradeço por tudo o que me proporcionaram, pelo apoio que 

me deram e nunca me negaram, por torcerem por mim sem limites. 

À Sara, agradeço por toda a motivação que me deu, por me mostrar que é possível melhorar 

sempre, mesmo quando não julgo ser capaz. O seu apoio foi imprescindível e o seu contributo 

inqualificável. 

À minha irmã, ao Manuel, à Cristiana e ao Cristiano agradeço pelos conselhos que me deram e 

pela disponibilidade.  



 

  ii 

Resumo 

 
No presente trabalho foi desenvolvida uma aplicação informática em Visual Basic, que permite 

ao utilizador conhecer o desempenho energético de três bombas de calor assistidas por energia 

solar para preparação de água quente sanitária, para qualquer município do país, simulando o 

seu funcionamento anual. Os cálculos realizados pela aplicação baseiam-se no modelo de 

funcionamento das bombas de calor desenvolvido no artigo “New test methodologies to analyse 

direct expansion solar assisted heat pumps for domestic hot water” (Facão &amp;amp; Carvalho, 2014) e 

tem como fonte de dados climáticos o software Climas SCE, disponibilizado pelo Laboratório 

Nacional de Energia e Geologia (LNEG). O modelo energético do depósito usado na aplicação 

foi desenvolvido durante este trabalho, tendo como base outros modelos já existentes. Os 

resultados obtidos foram comparados com resultados de ensaios experimentais elaborados para 

os mesmos sistemas, usando os mesmos perfis de extração, para trinta localidades escolhidas a 

partir da Nomenclatura das Unidades Territoriais para Fins Estatísticos (NUTS III), analisando 

o fator de desempenho sazonal (SPF) anual e mensal. 

A diferença entre os valores do SPF anual obtidos nesta aplicação e os valores obtidos nos 

ensaios experimentais para os três sistemas variou entre 0% e 1,8%. Os valores obtidos na 

aplicação demonstram ainda uma diminuição da amplitude entre o mês com o melhor e o pior 

SPF de 3,7% a 45,1%. 

Palavras-Chave: bomba de calor, AQS, SPF, simulação de sistemas, Visual Basic. 

 

Abstract 

 
In the present work was developed a computer application in Visual Basic, which enables the 

user to acknowledge the energy performance of three heat pumps assisted by solar energy for 

domestic hot water, to every city in Portugal, simulating its annual operations. The calculations 

performed by the application are based upon the model of heat pumps developed in the article 

"New test methodologies to analyze direct expansion solar assisted heat pumps for domestic hot 

water" (Facão &amp;amp; Carvalho, 2014). The weather data is provided by Clima SCE software, 

developed by the National Energy and Geology Laboratory. The energy model of the storage 

tank used in the application was developed during this work, based on other existing models. 

The results were compared with test results for the same systems using the same extraction 

profiles for thirty locations chosen from the Nomenclature of Territorial Units for Statistics 

(NUTS III) by analyzing the annual and monthly SPF.  



 

  iii 

The difference between the values of the annual SPF obtained by experimental method and the 

values obtained for the application ranged from 0% to 1.8% for the three systems. The values 

obtained in the application show a decrease of the amplitude between the month with best and 

worst SPF of 3.7% to 45.1%. 

Keywords: heat pump, hot water, SPF, simulation systems, Visual Basic. 

  



 

  iv 

Índice 
 

Agradecimentos .............................................................................................................................. i 

Resumo .......................................................................................................................................... ii 

Abstract ......................................................................................................................................... ii 

Índice de Figuras, Esquemas, Gráficos e Diagramas ................................................................... vi 

Índice de Tabelas ......................................................................................................................... vii 

Nomenclatura ............................................................................................................................. viii 

Acrónimos, Abreviaturas e Siglas ................................................................................................. x 

Capítulo 1 – Introdução ................................................................................................................. 1 

1.1 Enquadramento ................................................................................................................... 1 

1.2. Projetos de Investigação ..................................................................................................... 3 

1.3. Motivação e Objetivos ....................................................................................................... 4 

Capítulo 2 – Revisão Bibliográfica ............................................................................................... 5 

2.1. Energia Solar ...................................................................................................................... 5 

2.2. Bombas de Calor ................................................................................................................ 7 

2.2.1. Bomba de Calor de Expansão Direta Assistida por Energia Solar ............................ 12 

2.3. Visual Basic ..................................................................................................................... 15 

2.4. Métodos Numéricos ......................................................................................................... 15 

2.4.1. Sistema de Equações Lineares .................................................................................. 16 

2.4.2. Sistema de Equações Não-Lineares .......................................................................... 17 

2.5. Regulamentação e Legislação .......................................................................................... 20 

2.5.1. Regulamento (UE) N.º 814/2013 .............................................................................. 20 

2.5.2. EN 16147:2011 ......................................................................................................... 23 

2.5.3. Decisão da CE: 2013/114/EU ................................................................................... 24 

Capítulo 3 – Modelação do Sistema ............................................................................................ 26 

3.1. Componentes da Bomba de Calor .................................................................................... 26 

3.2. Clima e Localidades ......................................................................................................... 28 



 

  v 

3.3. Caracterização de Consumos ........................................................................................... 30 

3.4. Modelo do Depósito ......................................................................................................... 31 

3.5. Modelo da Bomba de Calor ............................................................................................. 35 

3.6. Funcionamento da Aplicação ........................................................................................... 38 

3.6.1. Sub-rotinas e Namespace .......................................................................................... 38 

3.6.2. Visão Geral da Aplicação .......................................................................................... 40 

Capítulo 4 – Resultados .............................................................................................................. 44 

Capítulo 5 – Conclusão ............................................................................................................... 57 

Referências Bibliográficas .......................................................................................................... 59 

Anexos......................................................................................................................................... 62 

Anexo Ia – Ciclo de Consumo S (EN 16147:2011) .................................................................... 63 

Anexo Ib – Ciclo de Consumo M (EN 16147:2011)................................................................... 64 

Anexo Ic – Ciclo de Consumo L (EN 16147:2011) .................................................................... 65 

Anexo Id – Ciclo de Consumo XL (EN 16147:2011) ................................................................. 66 

 

  



 

  vi 

Índice de Figuras, Esquemas, Gráficos e Diagramas 

 

Figura 1 – Evolução do consumo de energia no sector doméstico (tep) por tipo de fonte (1989-

2009) [7] ........................................................................................................................................ 2 

Figura 2 – Funcionamento de uma bomba de calor (adaptado [17]) ............................................. 9 

Figura 3 – Nomenclatura representativa do funcionamento de uma bomba de calor [20] .......... 11 

Figura 4 – Eliminação de Gauss-Jordan [28] .............................................................................. 16 

Figura 5 – Painel solar termodinâmico ....................................................................................... 27 

Figura 6 – Nomenclatura representativa do funcionamento da DX-SAHP usada [23] ............... 28 

Figura 7 – Seleção da simulação a realizar pela aplicação .......................................................... 40 

Figura 8 – Resultado da simulação (exemplo) ............................................................................ 42 

Figura 9 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema I) ......... 46 

Figura 10 – Diferença entre os valores do SPF anual (Sistema I) ............................................... 48 

Figura 11 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema II) ...... 50 

Figura 12 – Diferença entre os valores do SPF anual (Sistema II) ............................................. 52 

Figura 13 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema III) ..... 54 

Figura 14 – Diferença entre os valores do SPF anual (Sistema III) ............................................ 56 

 

Esquema 1 – Princípio de funcionamento de uma bomba de calor (adaptado [17]). .................... 7 

Esquema 2 – Funcionamento de uma bomba de calor assistida por energia solar [20] .............. 11 

Esquema 3 – Componentes de uma bomba de calor assistida por energia solar [23] ................. 13 

Esquema 4 – Representação do funcionamento da DX-SAHP usada [23] ................................. 28 

Esquema 5 – Trocas de energia entre camadas do depósito ........................................................ 33 

 

Gráfico 1 – Temperatura-Entropia (A) e Pressão-Entalpia (B) do ciclo termodinâmico da bomba 

de calor ........................................................................................................................................ 10 

Gráfico 2 – SPF mensal calculado pela aplicação para o sistema I (SPF a amarelo e Eren a azul). 

A – Ponta Delgada; B – Viseu; C – Beja; D – Funchal ............................................................... 45 

Gráfico 3 – SPF mensal calculado pela aplicação para o sistema II (SPF a amarelo e Eren a 

azul). A – Ponta Delgada; B – Viseu; C – Beja; D – Funchal ..................................................... 49 

Gráfico 4 – SPF mensal calculado pela aplicação para o sistema III (SPF a amarelo e Eren a 

azul). A – Ponta Delgada; B – Viseu; C – Beja; D – Funchal ..................................................... 53 

 

Diagrama 1 – Funcionamento geral da aplicação ....................................................................... 42 

Diagrama 2 – Sub-rotina NosDep ............................................................................................... 43 

  

file:///E:/tese/TeseAVfinal_30.docx%23_Toc431370624
file:///E:/tese/TeseAVfinal_30.docx%23_Toc431370632
file:///E:/tese/TeseAVfinal_30.docx%23_Toc431370640
file:///E:/tese/TeseAVfinal_30.docx%23_Toc431370641


 

  vii 

Índice de Tabelas 

 

Tabela 1 – Abreviaturas utilizadas para transmitir informação do sistema através de um código 

de letras (adaptado [20]) .............................................................................................................. 11 

Tabela 2 – Eficiência energética para os diferentes perfis de carga [32] .................................... 21 

Tabela 3 – Requisitos de água misturada a 40°C [32] ................................................................ 21 

Tabela 4 – Eficiência energética dos aquecedores de água em 2017 [32] .................................. 22 

Tabela 5 – Eficiência energética do aquecimento de água em 2018 [32] ................................... 22 

Tabela 6 – Valores de k [32] ....................................................................................................... 23 

Tabela 7 – Condições de teste para todos os sistemas [33] ......................................................... 23 

Tabela 8 – Fluxos dos tipos de extração [33] .............................................................................. 24 

Tabela 9 – Características do painel solar termodinâmico .......................................................... 26 

Tabela 10 – Características dos depósitos de armazenamento .................................................... 27 

Tabela 11 – NUTS III e localidades escolhidas .......................................................................... 30 

Tabela 12 – Valores das constantes das equações (50) e (51) ..................................................... 38 

Tabela 13 – Resultados da simulação (Sistema I) ....................................................................... 47 

Tabela 14 – Resultados da simulação (Sistema II) ...................................................................... 51 

Tabela 15 – Resultados da simulação (Sistema III) .................................................................... 55 



 

  viii 

Nomenclatura  

 
?  Dias Julianos 

COP  Coeficiente de performance 

Cp  Calor específico da água (J/(kg.k)) 

???,??  Energia elétrica consumida pelo compressor (J) 

??  Irradiância de grande comprimento de onda (W/m
2
) 

HR  Humidade relativa (%) 

HRA  Ângulo horário (º) 

IAM  Modificador de ângulo incidente 

????  Irradiância difusa horizontal (W/m
2
) 

????  Irradiância direta horizontal (W/m
2
) 

?????  Irradiância direta no plano inclinado (W/m
2
) 

??  Irradiância global horizontal (W/m
2
) 

???  Irradiância global no plano inclinado (W/m
2
) 

LST  Hora solar local 

LT   Hora local 

??????  Fluxo de água que entra pelo fundo do nó (kg/s) 

??ó  Massa de água do nó (kg) 

??????  Fluxo de água que sai pelo topo do nó (kg/s) 

??  Pressão de saturação (Pa) 

?????  Potência da bomba de calor em standby (kW) 

???,??   Energia útil para aquecimento de água sanitária (J) 

???,??   Energia útil para aquecimento ou arrefecimento de espaço interior (J) 



 

  ix 

??????   Calor fornecido pela resistência da bomba de calor (W) 

?????    Calor fornecido pela bomba de calor (W) 

????????  Calor perdido pelo depósito (W) 

???????  Calor do condensador (W) 

????  Fator de correção ambiente (kWh) 

???????  Calor do evaporador (W) 

????   Consumo diário de eletricidade (kWh) 

?????  Consumo diário de combustível (kWh) 

????   Energia de referência (kWh) 

SCF  Smart Control Factor 

??????? Fator de desempenho sazonal para bombas de calor elétricas 

SPF  Fator sazonal de desempenho 

????   Temperatura ambiente (°C) 

???  Temperatura da água que entra no depósito (°C) 

??    Temperatura do condensador (ºC) 

??    Temperatura do evaporador (ºC) 

????   Temperatura da água que entra no fundo do nó (ºC) 

??ó   Temperatura da água do nó (ºC) 

???   Temperatura de orvalho (ºC) 

????   Temperatura da água que sai no topo do nó (ºC) 

?????? Coeficiente de perdas térmicas do compressor (W/K) 

????  Condutividade térmica do depósito (W/(K.m
2
)) 

????  Energia elétrica consumida pelo sistema de apoio (J) 



 

  x 

????  Energia elétrica consumida em standby (J) 

??????  Velocidade do vento (m/s) 

???????  Calor do compressor (W) 

?  Altura solar (º) 

?  Inclinação do painel solar termodinâmico (º) 

?  Ângulo azimutal (º) 

?  Declinação solar (º) 

??  Diferença de temperaturas (°C) 

?  Emissividade do céu 

?  Ângulo zenital (º) 

?  Rendimento 

??  Rendimento do aquecimento de água por aquecedores 

??   Ângulo de incidência (º) 

?  Constante de Stefan-Boltzmann (W/(m
2
.K

4
)) 

?  Latitude (º) 

 

Acrónimos, Abreviaturas e Siglas 

 
AQS  Água quente sanitária 

BC  Bomba de calor 

CC  Coeficiente de conversão 

CE  Comissão Europeia 

DGEG  Direção Geral de Energia e Geologia 

DL  Decreto-Lei 

DX-SAHP Direct expansion solar assisted heat pump 



 

  xi 

EN  Norma Europeia 

ESTIF  European Solar Thermal Industry Federation 

ESTTP  European Solar Thermal Tecnology Platform 

GUI  Interface gráfica do utilizador 

HP  Bomba de calor 

IEA  International Energy Agency 

LES  Laboratório de Energia Solar 

NUTS  Nomenclatura das Unidades Territoriais para Fins Estatísticos 

S  Coletor solar 

SAHP  Bomba de calor assistida a energia solar 

SCE  Sistema de Certificação Energética dos Edifícios 

SHP  Bomba de calor solar 

UE  União Europeia



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   1 

Capítulo 1 – Introdução 
 

1.1 Enquadramento 
 

O domínio da energia condicionou a evolução do Homem desde muito cedo, primeiro com a 

manipulação do fogo e, mais tarde, com a invenção de moinhos e velas de embarcações. Mas foi 

a partir da criação de máquinas a vapor, e consequente revolução industrial, que as sociedades 

começaram a desenvolver-se a um ritmo nunca antes visto e a adquirir a sua forma atual. 

Devido à sua inegável importância, a energia tornou-se um dos principais motivos de conflito 

entre nações, tendo alimentado duas grandes guerras. Embora hoje o panorama europeu seja 

outro, a Europa continua a ser confrontada com diversos problemas de ordem energética, como: 

o aumento da dependência das importações energéticas e os preços elevados e voláteis da 

energia; a crescente procura de energia a nível global; a falta de segurança que afeta tanto os 

países produtores como distribuidores; as crescentes ameaças decorrentes das alterações 

climáticas e a necessidade de uma maior transparência, integração e interligação dos mercados 

energéticos [1]. 

 

De forma a resolver estes problemas, a Europa tem vindo a procurar alternativas sustentáveis, 

com recurso a fontes de energia renovável em alternativa aos combustíveis fósseis, contribuindo 

assim para a redução das emissões de gases com efeito de estufa, a diversificação do 

aprovisionamento energético e a redução da dependência em relação a mercados de 

combustíveis instáveis, em particular os do petróleo e do gás. A União Europeia (UE) tornou-se 

desta forma líder no que respeita a tecnologias energéticas renováveis, estimando-se que 

atualmente empregue cerca de 1,2 milhões de pessoas nesta indústria. Nos últimos anos 

observou-se, inclusivamente, um aumento da promoção das energias renováveis decorrente das 

alterações favoráveis que ocorreram na legislação da UE. Os últimos dados disponíveis 

provenientes do Eurostat indicam que, em 2012, 14% do consumo de energia na UE-28 foi 

produzido com recurso a energias renováveis [2]. 

 

Relativamente à procura total de calor, em 2013 mais de 10% foi satisfeita por energia 

renovável. A maior parte deveu-se à utilização de bioenergia (mais comum no norte da Europa), 

embora os sistemas solares térmicos e sistemas geotérmicos tenham cada vez um papel mais 

relevante, à medida que se tornam mais competitivos em vários mercados. Isto é tido em conta 

pela Federação Europeia da Indústria Solar Térmica (ESTIF), que estima que para 2020 a 

procura de calor satisfeita por energia renovável seja de 21% [3] [4]. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   2 

No caso de Portugal, é notório a importância que a energia tem na balança económica do país. 

Dados de 2013 mostram que, dos 15,4 Mtep de energia consumida, 11 foram importados. Esta 

dependência espelha-se também no saldo importador de produtos energéticos, tendo sido 

contabilizados cerca de 6,2 mil milhões de euros, que perfazem 20,1% do total do saldo 

importador de mercadorias desse ano [5] [6]. 

 

Relativamente ao consumo de energia no setor doméstico, dados de 2009 revelam que a 

eletricidade foi a principal fonte (representando 38,1% do consumo total), seguida pelas lenhas 

(biomassa e carvão vegetal) com 36,3%, o GPL com 16,3%, o gás natural (8,3%) e, por fim, o 

solar térmico (0,8%) e os produtos de petróleo (0,3%) (Figura 1) [7].  

 

 

Figura 1 – Evolução do consumo de energia no sector doméstico (tep) por tipo de fonte (1989-2009) [7] 

 

No que diz respeito a bombas de calor, em 2009 verificou-se que num total de mais de 450 mil 

equipamentos, a esmagadora maioria era do tipo Ar-Ar (93%), sendo que, até 2010, 55% dos 

equipamentos haviam sido instalados nos últimos quatro anos, demonstrando um claro 

crescimento de mercado [7]. 

 

No âmbito da energia solar, foram instalados em Portugal mais de 50 mil m
2
 de novos coletores 

solares térmicos, em 2013. Contudo, registou-se uma variação negativa de 37% relativamente a 

2012, o que poderá hipotecar os objetivos oficiais do país para 2020 (2,2 milhões de m
2
) uma 

vez que a área total instalada em Portugal em 2013 era de um milhão de m
2
. Por outro lado, a 

indústria prevê uma estagnação ou um crescimento na instalação de novos coletores, tendo em 

conta as regras para os edifícios em vigor desde dezembro de 2013 (Decreto-Lei nº 118/2013) 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   3 

que obrigam os edifícios de serviços, novos ou em caso de reabilitação, a produzir água quente 

sanitária (AQS) através de energia solar térmica ou outros métodos renováveis, como as bombas 

de calor solares ou geotérmicas [8]. 

 

1.2. Projetos de Investigação 
 

A UE encara o setor da energia com extrema importância, não só pelo peso económico que este 

acarreta mas também pela sua importância ambiental e social. Como tal, em conjunto com 

parceiros privados e outras instituições internacionais, tem apostado em programas de 

investigação em tecnologias de várias áreas deste setor: 

  

O programa Horizon 2020 (Programa-Quadro Comunitário de Investigação &amp;amp; Inovação), a 

decorrer desde 2014 e até 2020, é o maior programa de apoio à investigação alguma vez 

projetado pela Comunidade Europeia, com um orçamento global de 77 mil milhões de euros. Os 

fundos acautelados para o setor da energia perfazem um total de 5,9 milhões de euros, sendo 

que 20% são investidos pela UE, 20% pelos seus Estados-membros e os restantes 60% são 

investidos pela indústria europeia. Os objetivos são: inovar, desenvolver energia limpa, segura e 

eficiente, e promover o desenvolvimento sustentável [1] [9]. 

 

A Renewable Heating &amp;amp; Cooling Platform começou em 2005, na Plataforma Europeia de 

Tecnologia Solar Térmica (ESTTP), e foca-se no desenvolvimento de tecnologias de energia e 

de infraestruturas que aumentem a produção de energia térmica a partir de uma fonte de energia 

renovável. Tem como objetivo permitir a viabilidade de exploração dessa fonte e/ou um maior 

rendimento do sistema. O armazenamento de energia térmica, as bombas de calor e os sistemas 

híbridos são algumas das tecnologias investigadas [10] [11]. 

 

A Agência Internacional de Energia (IEA), através do programa Solar Heating &amp;amp; Cooling, 

executou entre 2010 e 2014 a Task 44, que se focou no estudo de sistemas de AQS e 

aquecimento ambiente usando bombas de calor e coletores solares térmicos como principais 

componentes. Estudaram-se as soluções existentes no mercado e procuraram-se soluções 

alternativas, através de estudos laboratoriais, simulações e modelações. Outro dos objetivos 

passou pela divulgação do setor e produção de medidas de apoio ao mercado, tendo o 

Laboratório Nacional de Energia e Geologia (LNEG) sido um dos colaboradores deste projeto 

[12]. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   4 

1.3. Motivação e Objetivos 

 

A legislação portuguesa (DL n.º 118/2013) obriga ao uso de sistemas solares térmicos na 

preparação de AQS em novos edifícios. Em alternativa, podem ser usados outros sistemas de 

aproveitamento de energias renováveis, contando que assegurem, uma base anual, energia 

equivalente à do solar térmico. De acordo com a Diretiva Europeia das energias renováveis, as 

bombas de calor são consideradas equipamentos que captam energia renovável desde que o seu 

desempenho, caracterizado pelo fator de desempenho sazonal (SPF), seja superior a 2,5. Neste 

sentido, é necessário haver uma forma de estimar o comportamento das bombas de calor para 

preparação de AQS. Nas bombas de calor aerotérmicas, o SPF é calculado a uma temperatura 

do ar fixa, igual a 7ºC. Se a bomba de calor for assistida por energia solar térmica, deverá haver 

uma metodologia que calcule o SPF tendo em conta a variação do clima. 

 

Tendo isto em conta, o presente trabalho tem como propósito o desenvolvimento de uma 

ferramenta de cálculo em Visual Basic, que simule anualmente o funcionamento de bombas de 

calor de expansão direta assistidas por energia solar, para a preparação de AQS para o clima 

português. O programa terá como base resultados obtidos experimentalmente no LNEG e 

simulações efetuadas em ambiente TRNSYS, e terá especial interesse para os fabricantes de 

bombas de calor, visto conseguir simular, num curto período de tempo, o consumo de 

eletricidade por parte das bombas de calor que comercializam, assim como a energia que é 

fornecida por estas. Deste modo, poderá ser avaliada a viabilidade das bombas de calor para a 

localidade e o tipo de consumo que o cliente desejar, de forma semelhante à realizada por 

programas de dimensionamento de sistemas solares térmico já existentes. 

 

No capítulo 2 é apresentada uma revisão bibliográfica sobre energia solar, bombas de calor e 

métodos numéricos, sendo também brevemente descrito o Visual Basic, assim como a 

legislação relevante para o tema em análise. Os componentes e métodos usados no 

desenvolvimento da aplicação encontram-se descritos no capítulo 3, sendo que os seus 

resultados são apresentados no capítulo 4. Por fim, no capítulo 5 são discutidas as principais 

conclusões e o trabalho a desenvolver no futuro. 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   5 

Capítulo 2 – Revisão Bibliográfica 

 

2.1. Energia Solar 

 

O processo de fusão nuclear que ocorre no interior do Sol leva a que enormes quantidades de 

energia sejam irradiadas da superfície solar, a qual chega ao nosso planeta de forma mais ou 

menos constante, com uma potência de aproximadamente 1350 W/m
2 

[13]. Contudo, a energia 

recebida num dado local varia a cada instante, sendo também diferente consoante a localização 

geográfica, a climatologia local e o ângulo de incidência. Para quantificar esta energia deve-se 

ter em conta a soma da radiação direta, da radiação difusa (radiação difundida pelas moléculas 

que compõem a atmosfera) e da radiação refletida por outras superfícies (solo, objetos, 

vegetação) [14]. 

 

O facto de a velocidade de rotação da Terra ser constante implicaria que, numa determinada 

localização, o Sol estivesse sempre na mesma direção, à mesma hora, em qualquer dia. No 

entanto, dada a excentricidade da órbita da Terra e de o seu eixo de rotação não ser 

perpendicular à orbita, essa posição varia ao longo do ano. Assim, para se poder conhecer a 

posição solar num ponto específico, é necessário saber o dia do ano, a latitude e a hora local 

(LT). Com estas três variáveis, e usando funções dependentes, obtém-se o ângulo incidente dos 

raios solares a qualquer instante. 

 

A partir da LT é possível calcular a hora solar local (LST), com recurso a um fator de correção 

que tem em conta a variação da longitude dentro do mesmo fuso horário. Contudo, os dados 

utilizados para o desenvolvimento da aplicação já se encontram no formato LST, não sendo 

necessária qualquer correção. 

 

O ângulo horário (HRA) converte a LST para graus, isto é, transforma as 24 horas do ciclo 

diário da LST em 360º (com valores compreendidos entre -180º e +180º). Quando o valor do 

HRA é zero, o Sol encontra-se na sua posição de meio-dia, ao passo que entre a posição de 

meia-noite e a posição de meio-dia são considerados valores negativos. Durante o resto do dia, 

HRA apresenta valores positivos [15]. 

 

 ??? = 15° × (??? ? 12) (1) 

 

Ao ângulo formado entre a linha do equador e uma linha desenhada a partir da Terra até ao Sol 

dá-se o nome de declinação (?). Este ângulo varia devido à translação da Terra em torno do Sol 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   6 

e à inclinação do eixo de rotação da Terra. Como o eixo tem uma inclinação de 23,45º, ? varia 

anualmente entre +23,45º e -23,45º, no solstício de verão e inverno, respetivamente. Nos 

equinócios de primavera e outono, a ? é nula [15]. 

 

 ? = ????1 (23,45° × sin (
360

365
(? ? 81))) (2) 

 

O ângulo da altura solar (?) é, por definição, a altitude angular do Sol em relação ao horizonte, 

quantificando a posição do Sol no eixo vertical em graus. Assim, ao nascer-do-Sol e ao pôr-do-

Sol, o ? é 0º. O ângulo zenital (?) mede o ângulo entre o Sol e a normal ao plano, sendo 

complementar com ?. 

 

 ? = ????1(sin(?) × sin(?) + cos(?) × cos(?) × cos(???)) (3) 

   

 = 90° ? ? (4) 

 

Relacionando os ângulos supra citados, é possível calcular o ângulo de incidência dos raios 

solares sobre uma superfície horizontal a qualquer hora do dia, pois sabendo-se as posições 

vertical e horizontal do Sol, sabe-se também a sua posição exata no céu. A determinação deste 

ângulo é essencial para calcular a quantidade de energia recebida por uma superfície. Tendo em 

conta uma superfície com ângulo de inclinação ? e virada a sul, através da seguinte fórmula é 

possível relacionar a radiação direta incidente na superfície inclinada com a radiação direta 

incidente na superfície horizontal [16]: 

 

 ????? = ???? × (???(?) × ???(?) + ???(?) × ???(??) × ???(?)) (5) 

 

Em que ?? representa o azimute solar, calculado pela seguinte equação [16]: 

 

 
???(?? ) =

???(???) × ???(?)

???(?)
 (6) 

 

A irradiância global na superfície inclinada (??? ) vem [16]: 

 

 ??? = ????? + ???? × (1 + cos ?)/2 (7) 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   7 

2.2. Bombas de Calor 

 

As bombas de água têm como função o transporte de água entre dois depósitos a diferentes 

altitudes. Embora a água flua naturalmente do depósito superior para o inferior, a bomba de 

água consegue fazer a água circular de uma posição inferior para uma posição superior gastando 

relativamente pouca energia. De forma análoga, as bombas de calor transferem calor de um 

meio a temperatura mais baixa para outro com temperatura mais alta, invertendo o fluxo natural 

de calor. Este processo é utilizado, por exemplo, no aquecimento de água a partir do ar exterior 

ou a partir de permutadores geotérmicos [17]. 

 

Para ocorrer transferência de calor de um nível mais baixo de temperatura para um nível mais 

alto, é necessário haver um fornecimento adicional de energia ao sistema, de forma a respeitar a 

segunda lei da termodinâmica. Através de um compressor, a bomba de calor fornece trabalho 

(W) (energia externa) a um fluido, permitindo retirar calor de um meio com uma temperatura 

mais baixa (T1) e, assim, aquecer outro meio que se encontra a uma temperatura superior (T2) 

[17]. 

 

Esquema 1 – Princípio de funcionamento de uma bomba de calor (adaptado [17]).  

T – temperatura; Q – calor; W – trabalho 

 

O coeficiente de desempenho de uma bomba de calor (COP) é um dos principais parâmetros 

necessários para a caracterização da mesma e é obtido relacionando o calor útil que a bomba de 

calor fornece, com o trabalho por ela requerido. Tendo em conta as variáveis do Esquema 1, no 

caso de a bomba de calor aquecer o espaço, o seu COP será dado pela expressão:  

 

 ??? =
?2
?

 (8) 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   8 

 

Por sua vez, caso o funcionamento da bomba de calor tenha como objetivo arrefecer o espaço, o 

COP é representado pela fórmula:  

 

 ??? =
?1
?

 (9) 

 

A energia extraída da fonte de calor não é tida em conta pois não é um gasto da bomba de calor, 

sendo de fonte renovável, quer provenha do ar, água ou solo [17]. Outro parâmetro que avalia o 

comportamento de uma bomba de calor é o SPF, o qual, segundo a norma EN 15316-4-2, é 

calculado através da seguinte equação: 

 

 ??? =
???,?? + ???,??

???,?? + ???? + ????
 (10) 

 

Consistindo, portanto, no rácio entre a energia útil para AQS (???,??), o aquecimento ou 

arrefecimento de espaço interior (???,?? ), e a energia elétrica consumida pelo compressor 

(???,??), pelo sistema de apoio (????) e em standby (????) [18]. 

 

Para efetuar o transporte de energia entre as fontes quente e fria, e vice-versa, é necessário um 

fluido. Esse fluido recolhe e liberta calor (evaporando e condensando), através de variações de 

temperatura e pressão. Resumidamente, o ciclo da bomba de calor processa-se do seguinte 

modo: numa zona em que a pressão do fluido é baixa, este recebe calor e passa de estado líquido 

a gasoso, mantendo a sua temperatura relativamente constante. A seguir, no compressor, a 

pressão do fluido aumenta, provocando igualmente o seu aumento de temperatura. Depois, ao 

entrar no condensador, liberta calor para o espaço/água que se pretende aquecer, retornando ao 

estado líquido. O fluido é então arrefecido através de um processo de expansão isentálpica 

executado na válvula de expansão, que deixa o fluido pronto para regressar ao início do ciclo 

(Figura 2) [17]. 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   9 

 

Figura 2 – Funcionamento de uma bomba de calor (adaptado [17]) 

 

A entalpia e a entropia são duas grandezas físicas muito comuns na caracterização dos processos 

de bombas de calor e outras máquinas térmicas. A energia em forma de calor passível de ser 

retirada de um sistema termodinâmico designa-se por entalpia (?) e é útil, particularmente, para 

analisar processos de geração de potência e de refrigeração. Pode ser calculada através da 

seguinte fórmula: 

 

 ? = ? + ? × ? (11) 

 

Em que ? representa a energia interna do sistema, ? a pressão, e ? o volume. 

 

Segundo a segunda lei da termodinâmica, num sistema isolado, o trabalho pode ser 

completamente convertido em calor, ou seja, em energia térmica, mas a energia térmica não 

pode ser completamente convertida em trabalho. À energia térmica que não pode ser convertida 

em trabalho, dada a irreversibilidade do processo, dá-se o nome de entropia. 

 

O Gráfico 1 ilustra o funcionamento termodinâmico de uma bomba de calor, através dos 

gráficos temperatura-entropia (A) e pressão-entalpia (B). Observa-se que a compressão 

adiabática (1-2) provoca o aumento de temperatura, assim como um ligeiro aumento da entalpia 

do sistema. De seguida, este vapor é arrefecido até ficar saturado (2-3). Ao condensar (3-4), o 

fluido liberta calor num processo isotérmico, isto é, mantendo a mesma temperatura. Essa 

temperatura é posteriormente diminuída pela descompressão levada a cabo pela válvula de 

https://pt.wikipedia.org/wiki/Trabalho_%28f%C3%ADsica%29
https://pt.wikipedia.org/wiki/Calor
https://pt.wikipedia.org/wiki/Energia_t%C3%A9rmica


Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   10 

expansão (4-5). No evaporador, o fluido retira energia do exterior do sistema num processo 

isobárico, passando ao estado gasoso e saturado do início do ciclo (5-1) [19]. 

 

 

Gráfico 1 – Temperatura-Entropia (A) e Pressão-Entalpia (B) do ciclo termodinâmico da bomba de calor 

 

De forma a uniformizar os sistemas combinados de energia solar térmica e bombas de calor, em 

2010 foi proposto um sistema de classificação para bombas de calor, no âmbito da Task 44 [20].  

 

Os sistemas são descritos utilizando um esquema de fluxo de energia (Esquema 2), em que as 

fronteiras do sistema se encontram assinaladas com fundo cinzento e onde são representadas as 

fontes de energia e a finalidade da energia útil. As fontes de energia que necessitam de ser 

compradas situam-se no lado esquerdo do gráfico (retângulos a cinzento escuro) e as fontes de 

energia de origem ambiental ficam na parte superior (retângulos a verde). Em baixo, é possível 

encontrar o nome do fabricante e o tipo de sistema. Do lado direito estão representadas as 

finalidades da energia útil, como a preparação de AQS ou o aquecimento de espaços (retângulos 

vermelhos). Ao centro, em fundo branco, encontram-se os cinco componentes do sistema tidos 

como essenciais: coletor solar, bomba de calor e aquecedor auxiliar (retângulos a laranja), 

complementados por sistemas de armazenamento, um no lado da fonte fria e outro no lado da 

fonte quente da bomba de calor (retângulos a azul). O gráfico é completado por linhas de vários 

tipos que representam os fluxos de energia entre os vários elementos do sistema, e entre as 

fronteiras e o sistema, não sendo a grossura das linhas representativa da quantidade de energia 

transportada. Visto não serem necessárias para caracterizar o sistema, as perdas de energia não 

figuram na representação gráfica. 

A B 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   11 

 

Em alternativa, toda a informação apresentada no Esquema 2 pode ser resumida num código de 

abreviaturas representado na Figura 3. Por convenção, as fontes de energia dos coletores (S) e 

das bombas de calor (HP) ficam sobrescritas – no caso de serem fontes frias – e subscritas – no 

caso de serem fontes quentes – em redor da abreviatura SHP (bomba de calor solar). Caso exista 

mais do que uma fonte de calor, as abreviaturas de cada uma ficam separadas por vírgulas. 

 

 

Figura 3 – Nomenclatura representativa do funcionamento de uma bomba de calor [20] 

 

As diferentes fontes de calor que podem caracterizar o sistema encontram-se descritas na 

Tabela 1, com as respetivas abreviaturas: 

 

Tabela 1 – Abreviaturas utilizadas para transmitir informação do sistema através de um código de letras (adaptado 

[20]) 

S: coletor solar Air: ar srS: armazenamento na fonte fria 

HP: bomba de calor G: solo skS: armazenamento na fonte quente 

Sol: irradiação solar W: água subterrânea SH: aquecimento de espaços 

Esquema 2 – Funcionamento de uma bomba de calor assistida por energia solar [20] 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   12 

2.2.1. Bomba de Calor de Expansão Direta Assistida por Energia Solar 

 

As bombas de calor com expansão direta assistidas a energia solar (DX-SAHP) começam a ser 

amplamente comercializadas para várias aplicações, incluindo preparação de AQS. Neste tipo 

de sistemas, o coletor solar funciona como o evaporador da bomba de calor, de forma a 

transferir a energia solar para o fluido frigorigéneo utilizado no sistema. É de referir que o uso 

de fluido frigorigéneo como fluido da bomba de calor e do coletor resulta num arrefecimento do 

coletor. Esta situação tem como vantagem o aumento do rendimento do coletor uma vez que 

este opera a uma temperatura inferior, levando ao aumento do coeficiente de desempenho da 

bomba de calor e à redução dos seus custos de operação, comparativamente com as bombas de 

calor assistidas por energia solar (SAHP) convencionais [21]. 

 

Uma DX-SAHP – como a utilizada neste trabalho – é composta por: um coletor solar sem 

cobertura, um depósito de AQS, um compressor elétrico, uma válvula de expansão termostática, 

um controlador e um sistema de apoio. O fluido de transferência de calor é o fluido frigorigéneo 

da bomba de calor. 

 

A DX-SAHP funciona da seguinte forma: ao atingir o coletor solar, a radiação solar é absorvida, 

e aquece a superfície do coletor. Quando passa pelo coletor, o fluido de transferência de calor 

(que se encontrava no estado líquido) efetua trocas de calor com o coletor/evaporador, 

aquecendo e evaporando. De seguida, o compressor elétrico aplica trabalho sobre o fluido 

frigorigéneo evaporado, aumentando a sua pressão. Ao chegar ao condensador, o fluido 

frigorigéneo condensa e transfere o seu calor latente para o exterior do condensador, que se 

encontra a uma temperatura mais baixa. Dado que o condensador tem o permutador de calor na 

parte mais baixa do depósito de AQS, o calor é transferido para a água. Após abandonar o 

condensador, o fluido de transferência de calor passa por uma válvula de expansão termostática 

que baixa a sua pressão, regressando ao coletor. O sistema de apoio, que consiste numa 

resistência elétrica, situa-se a seguir ao depósito e é acionado quando a bomba de calor não 

consegue suprir as necessidades de consumo. O acionamento deste sistema encontra-se ainda 

dependente de um termostato colocado à saída do depósito ou a meio do mesmo (Esquema 3) 

[22] [23]. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   13 

 

Esquema 3 – Componentes de uma bomba de calor assistida por energia solar [23] 

 

Coletores 

O coletor termodinâmico tem como função a conversão de radiação solar em calor, através de 

uma superfície que aquece ao absorver a radiação solar. Esta por sua vez, transmite calor por 

condução para o fluido que circula no coletor, que será utilizado para evaporar o fluido 

frigorigéneo. Contudo, no coletor efetuam-se também outro tipo de trocas que estão 

dependentes da relação entre a temperatura de orvalho e a temperatura do coletor, da relação 

entre a temperatura ambiente (????) e a temperatura do coletor, e da velocidade do vento 

(??????), tendo como consequência a alteração do rendimento do coletor [23]. Um sistema DX-

SAHP pode funcionar com diferente configuração, tipo e número de coletores solares, sendo 

que quanto maior for a área de coletores, maior deverá ser o COP. Em ambientes com elevada 

radiação solar e temperaturas altas, os sistemas com coletores sem cobertura permitem ao 

sistema atingir um COP mais elevado relativamente aos sistemas com coletores com cobertura 

[24]. Os últimos são também mais dispendiosos uma vez que o preço por m
2
 é mais elevado 

[24]. 

 

Sistema de Armazenamento 

A incapacidade de aquecer água instantaneamente em qualquer momento de necessidade de 

consumo torna inevitável a adição de um depósito de armazenamento, permitindo ao 

consumidor ter água quente à sua disposição num maior período de tempo, e não só quando 

existe radiação suficiente para aquecer a água à temperatura desejada [25]. Outra vantagem é a 

utilização de sistemas de baixa potência que vão armazenando calor no depósito ficando o calor 

disponível para satisfazer as necessidades de consumo futuras. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   14 

A configuração dos depósitos é bastante variável, no que diz respeito a ligações de entrada e de 

saída e a permutadores de calor. Os depósitos são tipicamente constituídos por aço inoxidável, 

aço esmaltado ou revestidos por plástico. No caso de aquecimento de água para habitações, a 

sua capacidade deverá ser de algumas centenas de litros [14]. 

 

O comportamento térmico dos depósitos de armazenamento depende essencialmente de duas 

características muito importantes: as perdas térmicas e a estratificação de temperaturas dentro 

do depósito. As perdas térmicas estão relacionadas com a condutividade térmica do depósito – 

???? – que representa a potência perdida (??????) por unidade de área exterior do depósito 

(????) e por unidade de diferença de temperatura (??), entre o ambiente e a água no interior do 

depósito.  

 

 
???? =

??????
???? × ??

 (12) 

 

A condutividade térmica varia em função das propriedades do material que constituem o 

depósito. A estratificação da temperatura dentro do depósito apresenta várias vantagens:  

? permite uma maior eficiência das trocas de energia que ocorrem no permutador, 

levando a que a temperatura de entrada do fluido no coletor seja menor e, 

consequentemente, que o rendimento do coletor seja melhor;  

? a temperatura da água de consumo será mais elevada do que temperatura média da água 

no depósito;  

? não ocorrer mistura entre a água quente no depósito e a água da rede que é introduzida 

durante o consumo.  

Para garantir uma boa eficácia do sistema de estratificação, o depósito deverá apresentar um 

posicionamento vertical, ainda que nem sempre seja a melhor opção arquitetónica. De forma a 

manter a estratificação, é ainda recomendável a colocação de defletores na entrada de água fria 

da rede, para evitar que ocorra mistura com a água quente do depósito [25]. 

 

Sistema de Apoio 

O sistema de apoio partilha com o sistema de armazenamento a função de satisfazer as 

necessidades de consumo nos momentos em que existe um défice entre a energia que o 

consumidor solicita e a energia que a bomba de calor consegue fornecer. No entanto, é essencial 

que o sistema de apoio sirva apenas como complemento, de forma a diminuir os gastos com a 

energia convencional e a viabilizar ao máximo a utilização de energia de fonte renovável [25]. 

A resistência elétrica é o sistema de apoio utilizado para este tipo de configuração. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   15 

Compressor 

Este componente do sistema é responsável pelo único consumo de energia elétrica da bomba de 

calor, necessário para fornecer trabalho ao fluido frigorigéneo, de forma a produzir uma 

compressão adiabática [17]. 

 

2.3. Visual Basic 

 

O Visual Basic é uma linguagem de programação projetada para ser facilmente entendida pelo 

utilizador, assente num ambiente integrado de desenvolvimento, criado em 1991 pela Microsoft. 

O software foi desenvolvido com o intuito de ser de fácil utilização e tem como funcionalidades 

o desenvolvimento rápido de aplicações, o desenvolvimento de aplicações de interface gráfica 

do utilizador, o acesso a bases de dados de vários tipos de dados e a criação de controladores 

[26].  

 

A programação em Visual Basic consiste numa combinação entre o arranjo gráfico de uma 

aplicação (organização de componentes ou controladores num formulário e especificação de 

atributos e ações para os componentes) e a escrita de linhas de código adicionais (necessárias 

para a interação de diferentes componentes e atributos). Para além destas facilidades, o Visual 

Basic permite também o desenvolvimento de tarefas comuns a outras linguagens de 

programação como, por exemplo, matemática avançada. Permite ainda a criação de ficheiros 

executáveis dos programas criados, os quais funcionam em qualquer sistema operativo com a 

plataforma .NET Framework [26]. 

 

2.4. Métodos Numéricos 

 

Os métodos numéricos são conjuntos de processos usados com vista a obtenção de soluções 

numéricas em problemas onde não é possível, ou desejável, chegar a uma solução por métodos 

analíticos. Estes procedimentos permitem assim encontrar soluções aproximadas e válidas de 

um modelo ou sistema, e são utilizados em situações em que: os métodos analíticos não se 

aplicam ou envolvem uma injustificável quantidade de cálculos; os problemas são complexos e 

envolvem processos não lineares; os dados do problema são obtidos de forma prática, formando 

um conjunto de valores que necessitam de ser tratados (por diferenciação ou integração, por 

exemplo) [27]. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   16 

2.4.1. Sistema de Equações Lineares 

 

Um sistema de equações lineares consiste num conjunto finito de equações que partilham as 

mesmas incógnitas, sendo que o número de incógnitas não pode ser maior do que o número de 

equações lineares. Estes sistemas representam-se na forma: 

 

 ?? =  ?  (13) 

 

Em que ? representa a matriz dos coeficientes do sistema, ? é a matriz-coluna das incógnitas e 

? é a matriz-coluna dos termos independentes. O número de colunas da matriz dos coeficientes 

consiste no número de incógnitas do sistema, enquanto o número de linhas é dado pelo número 

de equações. 

 

O sistema diz-se possível e determinado, caso haja apenas uma solução, e diz-se possível e 

indeterminado, se existir mais do que uma solução. Se não existir solução o sistema diz-se 

impossível. Quanto ao método de resolução, estes sistemas podem ser classificados como 

métodos diretos (a solução exata é encontrada) ou métodos indiretos (funcionam por processo 

iterativo, aproximando-se da solução passo a passo).  

 

Caso a dimensão do sistema seja grande, isto é, tenha muitas incógnitas (e consequentemente 

muitas equações) a resolução destes sistemas torna-se bastante complexa. Contudo, verificou-se 

um desenvolvimento tecnológico de tal ordem que foi possível criar computadores digitais 

capazes de resolver sistemas de equações de grande complexidade [27]. 

 

Eliminação de Gauss-Jordan 

A eliminação de Gauss consiste num algoritmo de resolução de sistemas de equações lineares 

que tem como propósito a conversão da matriz aumentada (possui os coeficientes das incógnitas 

de um sistema, em conjunto com os termos independentes – [?|?]) em forma de escada. 

 

Figura 4 – Eliminação de Gauss-Jordan [28] 

 

Esta forma é obtida através de uma sequência de operações entre as linhas da matriz, até que a 

parte inferior esquerda da matriz fique preenchida com zeros. Existem três tipos de operações 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   17 

que permitem chegar a esta forma: trocas entre linhas, multiplicação de uma linha por um 

número diferente de zero, e adição de um múltiplo de uma linha a outra linha. 

 

Se uma matriz está em forma de escada, a primeira entrada não nula de cada linha é designada 

de pivô. Se o pivô for 1 e for o único elemento não nulo da sua coluna, então a matriz diz-se em 

forma de escada reduzida. Nesta situação está-se perante a eliminação de Gauss-Jordan, uma 

variante do método de Gauss para a qual a matriz-coluna ? representa uma solução do sistema 

[29]. 

 

2.4.2. Sistema de Equações Não-Lineares 

 

Apesar de os métodos de resolução de sistemas de equações lineares serem muito úteis para 

caracterizar vários sistemas que se desejem estudar, nem sempre é possível traduzir os seus 

processos através de equações lineares do tipo ?(?)  =  ? +  ??, tendo de se recorrer a 

equações não-lineares. 

 

Resolver um sistema de equações não-lineares pode resultar na obtenção de uma, várias 

soluções, ou nenhuma solução. Se houver soluções é necessário interpretá-las, fazendo uso de 

critérios físicos e técnicos envolvidos no problema, visto que, por exemplo, uma temperatura 

expressa em Kelvin (K) nunca poderá ter um valor negativo. Outra particularidade dos sistemas 

de equações não-lineares é o facto de a solução poder não ser encontrada usando um número 

finito de operações. Posto isto, os métodos de resolução para este tipo de sistemas são do tipo 

iterativo, mediante os quais se constrói um vetor com a solução para cada passo da iteração, o 

qual será próximo do vetor com a solução do sistema de equações não-lineares, caso o método 

seja eficaz. O processo cessará quando o erro da solução (ou das equações) for inferior ao erro 

máximo definido. Não existe um método universal para resolver sistemas de equações não-

lineares, sendo que métodos diferentes utilizados no mesmo sistema podem resultar em soluções 

bastante distintas [30]. 

 

Método de Newton-Raphson 

O método de Newton-Raphson é uma ferramenta poderosa para resolver equações através do 

uso de aproximações lineares.  

 

Seja ?(?) uma função e ? uma raiz da equação ?(?)  = 0. No início do processo iterativo 

define-se ?0 como uma estimativa de ?. Sendo ? = ?0 + ?, a diferença entre a raiz e a sua 

estimativa é ?. 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   18 

 

Admitindo h como “pequeno”, pode usar-se uma aproximação linear para concluir que: 

 

 0 =  ?(?) =  ?(?0 + ?) ?  ?(?0) +  ?. ?
?(?0) (14) 

 

No caso de ? ?(?0) não ser próximo de 0, 

 

 ? ? ?
?(?0)

??(?0)
 (15) 

 

Logo, 

 ? =  ?0  +  ? ?  ?0 ?
?(?0)

??(?0)
 (16) 

 

Chegando-se assim a uma nova estimativa de ? – ?1 – dada por: 

 

 
?1  =  ?0  ?

?(?0)

??(?0)
 (17) 

 

Da mesma forma que se obteve ?1, é possível calcular a próxima estimativa para ?, ?2. Ou seja, 

através da raiz estimada anteriormente – ?? – é possível definir ??+1: 

 

 ??+1  =  ??  ?
?(?? )

??(??)
. (18) 

 

Se se tratar de um sistema de equações não-lineares, é utilizado o método de Newton-Raphson 

juntamente com a eliminação de Gauss-Jordan. 

 

Considerando um sistema de n equações não lineares com n incógnitas representado por: 

 

 ?(?) = 0 ? {

f1(?1, ?2, . . . , ?? ) = 0
f2(?1, ?2, . . . , ?? ) = 0

…
fn(?1, ?2, . . . , ?? ) = 0

} (19) 

 

e, de forma análoga à utilizada para chegar a (14), obtém-se: 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   19 

 0 =  ?(?) + [??(?)]. ?? (20) 

 

Daqui resulta a fórmula para o cálculo das iterações que se aproxima da solução 

 

 ??+1 = ?? ? [?? (??)]
?1

. ?(?? ) (21) 

 

Sendo ? = {0, … , ?} e ? = {0, … , ?}, a matriz Jacobiana (?) de ? é: 

 

 {?(?)}?? =
??? (?)

???
 (22) 

 

Na prática, não se inverte explicitamente a matriz ?(?? ). Em vez disso, resolve-se o sistema 

linear: 

 

 ?(?? )?? = ??(?? ) (23) 

 

em ordem ao passo ?? e define-se a nova iteração como: 

 

 ??+1  =  ?? + ??  (24) 

 

voltando o processo à equação (21), com um novo valor de ?? [31]. 

 

O processo iterativo chegará ao fim quando os critérios de paragem forem cumpridos [30], 

sendo usual impor-se que uma certa aproximação do erro relativo seja inferior a um valor 

tolerado: 

 

 
???+1 ? ?? ?

???+1?
=

??? ?

???+1?
&amp;lt;??? (25) 

 

Ou impor-se que a proximidade de zero da norma da função seja inferior a um valor tolerado: 

 

 ??(??+1)? &amp;lt;??? (26) 

 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   20 

2.5. Regulamentação e Legislação 

 

A eficiência energética tem um papel fundamental para manter o equilíbrio entre o 

desenvolvimento tecnológico e a competitividade económica, contribuindo de forma bastante 

importante para um desenvolvimento sustentável e a consciencialização ambiental. Tais 

assuntos também fazem parte das prioridades da Europa, que graças a alterações regulamentares 

e legisladoras, procura o caminho certo na ótica da sustentabilidade. 

 

A legislação que se segue rege o setor onde se insere o sistema estudado neste trabalho. 

 

2.5.1. Regulamento (UE) N.º 814/2013 

 

O regulamento (UE) N.º812/2013 foi aprovado a 2 de agosto de 2013 e dá execução à Diretiva 

2009/125/CE do Parlamento Europeu e do Conselho aplicável a aquecedores de água e 

reservatórios de água quente [32]. Tem como objetivo a definição de requisitos de conceção 

ecológica para a colocação no mercado e/ou a entrada em serviço de aquecedores de água com 

uma produção térmica nominal igual ou inferior a 400kW, e de reservatórios de água quente 

com um volume útil igual ou inferior a 2000 litros, incluindo os integrados em sistemas mistos 

de aquecedor de água e dispositivo solar definidos no artigo 2.º do Regulamento Delegado (UE) 

N.º812/2013. Esta diretiva não é aplicável a aquecedores de água concebidos para utilizar 

predominantemente combustíveis gasosos ou líquidos produzidos a partir de biomassa, ou que 

utilizem combustíveis sólidos, entre outros. É também importante referir alguns conceitos 

definidos por este regulamento que são relevantes para o trabalho: 

 

Aquecedor de água 

É um dispositivo ligado a uma fonte de alimentação externa de água potável ou para uso 

sanitário equipado com um ou mais geradores. Tem como finalidade gerar e transferir calor para 

produzir água quente potável ou para uso sanitário, a diferentes níveis de temperatura, 

quantidades e caudais durante diferentes intervalos de tempo. 

 

Potência calorífica nominal 

É a potência calorífica declarada à saída do aquecedor de água quando aquece a água em 

condições nominais normais, expressa em quilowatt (kW). 

 

 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   21 

Volume útil de armazenamento 

É o volume nominal de um reservatório de água quente ou de um termoacumulador, expresso 

em litros (L). 

 

Aquecedor de água com bomba de calor 

Por definição é um aquecedor de água que utiliza calor ambiente a partir de uma fonte 

atmosférica, aquática ou geotérmica e/ou calor residual para a geração de calor. 

 

Reservatório de água quente 

É um recipiente destinado a armazenar água quente para fornecimento de água quente e/ou de 

aquecimento ambiente, incluindo eventuais aditivos. Não está equipado com um gerador de 

calor, podendo no entanto ter um ou mais aquecedores de imersão auxiliares. 

 

Aquecedor de imersão auxiliar 

Designa um aquecedor que utiliza o efeito de Joule em resistências elétricas. Está integrado num 

reservatório de água quente e só gera calor quando a fonte externa de calor é interrompida (por 

exemplo, durante os períodos de manutenção) ou avaria. Outra possibilidade é fazer parte de um 

reservatório de água quente solar, fornecendo calor quando a fonte de calor solar não é 

suficiente para proporcionar os níveis de conforto necessários. 

 

A partir de 26 de setembro de 2015, a eficiência dos aquecedores de água não deve ser inferior 

aos valores da Tabela 2: 

 

Tabela 2 – Eficiência energética para os diferentes perfis de carga [32] 

Perfil de carga 3XS XXS XS S M L XL XXL 3XL 4XL 

Eficiência energética 

do aquecimento de 

água 

22% 23% 26% 26% 30% 30% 30% 32% 32% 32% 

 

A quantidade de água misturada a 40ºC não deverá ser inferior aos seguintes valores da Tabela 

3: 

 

Tabela 3 – Requisitos de água misturada a 40°C [32] 

Perfil de carga M L XL XXL 3XL 4XL 

Água misturada a 

40ºC 
65 litros 130 litros 210 litros 300 litros 520 litros 1040 litros 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   22 

A 26 de setembro de 2017 os valores de eficiência energética serão alterados para os referidos 

na Tabela 4: 

 

Tabela 4 – Eficiência energética dos aquecedores de água em 2017 [32] 

Perfil de carga 3XS XXS XS S M L XL XXL 3XL 4XL 

Eficiência energética 

do aquecimento de 

água 

32% 32% 32% 32% 36% 37% 37% 37% 37% 38% 

 

A 26 de setembro de 2018, a eficiência energética dos aquecedores de água não deve ser inferior 

aos seguintes valores: 

 

Tabela 5 – Eficiência energética do aquecimento de água em 2018 [32] 

Perfil de carga XXL 3XL 4XL 

Eficiência energética do 

aquecimento de água 
60% 64% 64% 

 

A eficiência energética do aquecimento de água por parte dos aquecedores de água tradicionais 

e aquecedores de água com bomba de calor ( ??) é calculada da seguinte forma: 

 

 ?? =
????

(????? + ?? × ????? )(1 ? ??? × ?????) + ????  
 (27) 

 

Sendo que ????  é a energia de referência, ????? é o consumo diário de combustível, ????? é o 

consumo diário de eletricidade,  CC representa o coeficiente de conversão, SCF significa fator 

de controlo inteligente e smart é o controlo inteligente. O fator de correção ambiente (????) é 

calculado, para bombas de calor, através da seguinte equação: 

 

 ???? = ?? × 24? × ????? (28) 

 

Em que ????? representa a potência da bomba de calor em standby, e os valores de ? estão 

indicados na  Tabela 6: 

 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   23 

Tabela 6 – Valores de k [32] 

 3XS XXS XS S M L XL XXL 3XL 4XL 

? 0,23 0,23 0,23 0,23 0,23 0,23 0,23 0 0 0 

 

De forma a ser garantida a conformidade, os cálculos e as medições devem ser efetuados 

utilizando normas harmonizadas que tenham sido publicadas no Jornal Oficial da União 

Europeia ou utilizando outros métodos de cálculo e de medições que tomem em consideração os 

métodos geralmente reconhecidos como sendo os mais avançados.  

 

Estas regulamentações são transpostas a nível nacional pelo Decreto-Lei Nº. 12/2011, de 24 de 

janeiro. 

 

2.5.2. EN 16147:2011 

 

A norma europeia EN 16147:2011 especifica métodos de ensaio de bombas de calor para 

preparação exclusiva de AQS, com compressor acionado eletricamente, e os respetivos 

relatórios de classificação [33]. 

 

Durante o ensaio devem ser mantidas as seguintes condições (Tabela 7): 

 

Tabela 7 – Condições de teste para todos os sistemas [33] 

Variável medida Valor definido 

Voltagem fornecida Tensão nominal 

Frequência fornecida Frequência nominal 

Fluxo de ar na fonte quente Nominal, indicado pelo fornecedor. Quando é dado apenas 

um intervalo de valores, deve ser usado o valor máximo. 

Temperatura da água na entrada (ºC) 10 

Fluxo da água quente (l/min) 4/10 

 

Os testes avaliam vários parâmetros do sistema, estando divididos em seis etapas principais: 

A – Período de aquecimento; 

B – Determinação da energia de entrada; 

C – Determinação do consumo de energia e do COP para AQS utilizando perfis de extração. 

(várias extrações num ciclo de extrações); 

D – Determinação da temperatura de referência da água quente e a quantidade máxima de 

água quente utilizável numa única extração; 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   24 

E – Determinação do intervalo de temperaturas em que se irá operar; 

F – Testes de segurança. 

 

Para a determinação do consumo de energia e do COP para AQS é definido um período de 

medições de 24h com consumos definidos a tempos exatos e energia extraída determinada 

(Tabela 8): 

Tabela 8 – Fluxos dos tipos de extração [33] 

Tipo de extração Energia (kWh) 
Caudal a ser mantido durante 

a extração (l/min) 

Limpeza doméstica 0,105 4 ± 0,5 

Pequena extração 0,105 4 ± 0,5 

Limpeza do chão 0,105 4 ± 0,5 

Lavagem de louça 0,315 4 ± 0,5 

Lavagem de louça 0,420 4 ± 0,5 

Lavagem de louça 0,735 4 ± 0,5 

Grande extração 0,525 4 ± 0,5 

Duche 1,400 4 ± 0,5 

Duche (ciclo XL e XXL) 1,820 10 ± 0,5 

Banho 3,605 10 ± 0,5 

Banho (ciclo XL) 4,420 10 ± 0,5 

Duche + Banho (ciclo XXL) 6,240 10 ± 0,5 

 

No entanto, alguns destes consumos têm de respeitar outras exigências. 

Relativamente aos consumos “Banho” e “Limpeza do chão” é necessário manter uma diferença 

de pelo menos 30ºC entre a temperatura da água de consumo e a temperatura da água de 

entrada. No caso do consumo “Lavagem de louça”, essa diferença deve ser igual ou superior a 

45ºC. Para os restantes consumos, é exigido que durante a extração a diferença média entre a 

água de consumo e a água de entrada seja de 15ºC nalguns casos e 30ºC noutros. 

 

Diferentes arranjos destes consumos formam cinco ciclos de consumo distintos (S, M, L, XL, 

XXL) que são usados nos ensaios dos equipamentos. 

 

2.5.3. Decisão da CE: 2013/114/EU 

 

A 1 de março de 2013 foi publicada no Jornal Oficial da União Europeia a Decisão da CE: 

2013/114/EU que estabelece as orientações para os Estados-Membros relativamente ao cálculo 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   25 

da energia renovável que é obtida a partir de bombas de calor de diferentes tecnologias, em 

conformidade com o artigo 5.º da Diretiva 2009/28/CE do Parlamento Europeu e do Conselho. 

 

O método de base para o cálculo desta energia encontra-se no Anexo VII da Diretiva 

2009/28/CE onde estão definidos os três parâmetros a ter em conta para efeitos de metas 

respeitantes às energias renováveis [34]. São eles: a eficiência do sistema de energia (? ou eta); 

a quantidade estimada de energia útil fornecida pelas bombas de calor (Qusable); o SPF. 

 

Em conformidade com o Anexo VII da Diretiva, a quantidade de energia renovável fornecida 

pelas tecnologias das bombas de calor (????) deve ser calculada através da seguinte fórmula: 

 

 ???? = ??????? × (1 ?
1

???
) (29) 

 

Em que ??????? é o calor total útil fornecido pelas bombas de calor, calculado como o 

produto da capacidade nominal de aquecimento (??????) e as horas equivalentes anuais 

de bomba de calor (??? ), expresso em GWh. 

 

 ??????? = ??? × ?????? (30) 

 

??? consiste no número anual presumido de horas durante as quais uma bomba de calor tem de 

fornecer calor à capacidade nominal para fornecer o calor total utilizável fornecido pelas 

bombas de calor, expressas em horas. Já (??????) consiste na capacidade de arrefecimento ou de 

aquecimento do ciclo de compressão do vapor, expresso em GW. Por último, ??? define-se 

como o fator de desempenho sazonal médio estimado, referente ao coeficiente de desempenho 

sazonal líquido em modo ativo (???????) para as bombas de calor elétricas, ou ao rácio de 

energia primária sazonal líquida em modo ativo (??????? ) para as bombas de calor térmicas. A 

equação (29) é aplicada para bombas de calor para aquecimento ambiente. No caso das bombas 

de calor para preparação de AQS, ???????  é a energia anual extraída do depósito de acordo com 

os perfis de extração. 

 

A Diretiva define ainda critérios de desempenho mínimo das bombas de calor para efeitos de 

energia renovável. Segundo o Anexo VII, os Estados-membros devem assegurar que são 

tomadas em consideração unicamente as bombas de calor com um ??? superior a 1,15 ×  1/ . 

Para que a energia seja considerada renovável, o SPF mínimo das bombas de calor elétricas 

deve ser 2,5, dado que a eficiência dos sistemas de energia (?) encontra-se fixada em 45,5%.  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   26 

Capítulo 3 – Modelação do Sistema 

 
O desenvolvimento de uma ferramenta intuitiva para o utilizador implica a simulação do 

comportamento dos elementos do sistema, tendo em conta as suas condições de funcionamento 

e as necessidades de consumo do utilizador. Para tal é imperativo o estudo do equipamento a 

simular, de forma a obter uma caracterização mais detalhada sobre os seus componentes e 

respetivo funcionamento. A investigação que deu origem ao trabalho “New test methodologies 

to analyse direct expansion solar assisted heat pumps for domestic hot water” da autoria do Dr. 

Jorge Facão e da Dr.ª Maria João Carvalho [23], do Laboratório de Energia Solar (LES) do 

LNEG, permitiu obter informação detalhada sobre o funcionamento da bomba de calor e do 

depósito de 250 litros. Contudo, uma vez que para diferentes volumes do depósito alguns 

parâmetros são alterados, foram fundamentais os resultados de ensaios realizados 

posteriormente pela mesma equipa no LNEG LNEG para outras configurações do mesmo tipo 

de sistema, permitindo a caracterização para os restantes volumes. 

 

3.1. Componentes da Bomba de Calor 
 

A bomba de calor utilizada é do tipo DX-SAHP, sendo constituída por um depósito de 

armazenamento com compressor incorporado e um coletor solar termodinâmico que funciona 

como evaporador da bomba de calor.  

 

Evaporador/Coletor Solar 

O painel solar termodinâmico (Figura 5) é leve e não apresenta cobertura. Devido às 

características do fluido e do próprio painel, não são esperados problemas quer de aquecimento, 

quer de congelamento, e o fabricante estima uma vida útil de 25 anos. 

 
Tabela 9 – Características do painel solar termodinâmico 

Comprimento 2000 mm 

Altura 800 mm 

Espessura 20 mm 

Peso 8 kg 

Intervalo de inclinação 10º a 85º 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   27 

 
Figura 5 – Painel solar termodinâmico 

 

Depósito de Armazenamento 

Os depósitos de armazenamento são cilindros verticais em inox/esmalte, com 58cm de diâmetro 

e diferentes alturas, que resultam em diferentes volumes, como indica a Tabela 10: 

 
Tabela 10 – Características dos depósitos de armazenamento 

 Sistema 200L Sistema 250L Sistema 300L 

Volume (l) 200 250 300 

Altura (m) 1,3 1,5 1,7 

Diâmetro (m) 0,58 0,58 0,58 

Altura da resistência (m) 0,13 0,06 0,17 

Altura do controlador (m) 0,61 0,72 0,80 

Potência da resistência (W) 1500 1500 1500 

Peso (kg) 73 83 95 

 

Compressor 

O fluido utilizado é o R134a, que permite – devido às suas propriedades termodinâmicas e à 

válvula de expansão da bomba de calor – assegurar o funcionamento do sistema mesmo no dia 

mais frio do ano, pois não são registadas temperaturas tão baixas como esta em nenhuma zona 

de Portugal. Este componente, de potência nominal de 550W, entra em funcionamento sempre 

que a temperatura da sonda que se encontra no depósito for inferior à temperatura de set-point 

definida. 

 

O fluxo de energia da bomba de calor em estudo encontra-se no Esquema 4, de forma 

semelhante ao Esquema 2. 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   28 

 
Esquema 4 – Representação do funcionamento da DX-SAHP usada [23] 

 

Os retângulos com fundo preenchido representam os componentes do sistema e as energias 

envolvidas. É possível observar que o coletor capta energia das fontes ambientais Sol e ar 

exterior (retângulos a verde), que são utilizadas pela bomba de calor juntamente com 

eletricidade (retângulo a cinzento escuro). O fluido da bomba de calor, ao permutar energia com 

o depósito (retângulo azul), aquece a água armazenada, fornecendo AQS (retângulos a 

vermelho). 

 

O sistema pode também ser representado de uma forma mais resumida pela abreviatura da 

Figura 6:  

 

 
Figura 6 – Nomenclatura representativa do funcionamento da DX-SAHP usada [23] 

 

3.2. Clima e Localidades 

 

A utilização de bases de dados é uma necessidade indispensável para um software de simulação 

como o desenvolvido neste trabalho. De forma a combinar a funcionalidade do programa com a 

localização para a qual o utilizador pretende a aplicação do sistema da bomba de calor, foram 

usados dados climáticos de cada município, bem como a sua latitude. Estes dados referem-se a 

informação horária de ???? (°C), ?????? (m/s), humidade relativa (HR) (%), radiação global 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   29 

horizontal (??) (Wh/m
2
) e radiação difusa horizontal (????) (Wh/m

2
) durante um ano, sendo 

disponibilizados pelo LNEG através do software Climas-SCE. Foi utilizada a versão 1.0.5, de 

11 de Fevereiro de 2014 [35]. 

 

Estes dados requerem tratamento, pois são horários e por vezes o programa funciona com 

intervalos de tempo de cem segundos. Assim torna-se necessário definir os valores entre horas, 

tendo tal sido realizado com recurso ao método de interpolação linear, para os valores de ????, 

??????, ??, ???? e ??. A seguir encontra-se um exemplo geral para a ????: 

 

 ????
? = ????

? +
?

????
(????

?+1 ? ????
? ) (31) 

 

Em que os valores de índice ? pertencem ao vetor importado do ficheiro Excel, com 8760 

elementos (número de horas do ano); os valores de índice i pertencem ao novo vetor criado com 

200385 elementos (intervalos de uma hora entre as 22:00 e as 7:00 e de cem segundos das 7:00 

até às 22:00 para um ano); e a constante hora representa a divisão do intervalo de tempo do 

novo vetor pelo intervalo de tempo do vetor importado do ficheiro Excel. O índice j é 

incrementado até ser igual a hora. Nesse momento, o índice t aumenta uma unidade e o valor de 

j volta a 0. Para os restantes parâmetros (??????, ??, ???? e ??) procede-se da mesma forma. A 

irradiância direta incidente no plano horizontal (????), é calculada pela diferença entre ?? e ???? 

no plano horizontal. Utilizando as equações (5) e (7) define-se ????? e ???. 

 

A 14 de abril de 2008 entrou em vigor o Decreto-Lei N.º 68/2008 (posteriormente alterado pelo 

Decreto-Lei N.º85/2009, de 3 de Abril e pela Lei N.º21/2010 de 23 de Agosto) que divide o 

território português em aglomerados de municípios tendo por base a Nomenclatura das 

Unidades de Território Estatísticas (NUTS). Embora na aplicação se encontrem disponíveis para 

simulação todos os municípios do país, a análise dos resultados foi feita apenas para uma 

localidade por cada zona da NUTS III, as mesmas que foram tidas em conta nos ensaios 

experimentais do LNEG e na Tabela 11:  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   30 

Tabela 11 – NUTS III e localidades escolhidas 

NUTS III Localidade escolhida Latitude [º] 

Minho-Lima Viana do Castelo 41,9 

Alto Trás-os-Montes Bragança 41,6 

Cávado Braga 41,6 

Ave Guimarães 41,5 

Grande Porto Porto 41,3 

Tâmega Amarante 41,2 

Douro Vila Real 41,1 

Entre Douro e Vouga Santa Maria da Feira 40,9 

Baixo Vouga Aveiro 40,6 

Dão-Lafões Viseu 40,7 

Serra da Estrela Seia 40,5 

Beira Interior Norte Guarda 40,6 

Baixo Mondego Coimbra 40,3 

Pinhal Interior Norte Oliveira do Hospital 40,1 

Cova da Beira Covilhã 40,2 

Pinhal Interior Sul Sertã 39,8 

Beira Interior Sul Castelo Branco 39,9 

Pinhal Litoral Leiria 39,8 

Médio Tejo Tomar 39,6 

Oeste Torres Vedras 39,3 

Lezíria do Tejo Santarém 39,1 

Alto Alentejo Portalegre 39,1 

Grande Lisboa Lisboa 38,9 

Península de Setúbal Setúbal 38,6 

Alentejo Central Évora 38,6 

Alentejo Litoral Grândola 38 

Baixo Alentejo Beja 37,9 

Algarve Faro 37,3 

Região Autónoma dos Açores Ponta Delgada 37,8 

Região Autónoma da Madeira Funchal 32,7 
 

3.3. Caracterização de Consumos 

 

Para cada uma das localidades foram simulados os três sistemas de bombas de calor (200L, 

250L, e 300L), sendo que para o sistema de 200L de armazenamento foi estudado um ciclo de 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   31 

consumo do tipo L da norma EN 16147:2011 e para os sistemas de 250L e 300L foi usado um 

ciclo do tipo XL da mesma norma (Anexo I). Para todos os casos foram calculados o SPF e o 

Eren anual e mensal, a partir dos valores do consumo do compressor e da energia utilizada para 

consumo. Para o tratamento dos dados e análise comparativa foi utilizado o software Microsoft 

Excel. 

 

3.4. Modelo do Depósito 

 

Para a realização deste trabalho foi necessário caracterizar um depósito de energia térmica de 

um único fluido, sujeito a trocas de calor. No modelo é tida em conta uma carga que retira 

fluido do topo do depósito (onde a temperatura deverá ser mais alta), e introduz a mesma 

quantidade mássica de água no fundo do depósito. Esta carga representa os consumos de energia 

dos ciclos de consumo incorporados na aplicação. Ao depósito está também associada uma 

resistência elétrica que deverá ser acionada quando a ???? atinja -5ºC. Esta resistência 

encontra-se em diferentes cotas nos diferentes depósitos das bombas de calor projetadas 

(Tabela 10). Quanto à permuta de calor entre o fluido da bomba de calor e o fluido do depósito, 

esta é feita pelo condensador da bomba de calor. 

 

Casos de Estudo 

De forma a chegar ao modelo final utilizado no programa foram estudados outros modelos 

computacionais de simulação de depósitos de energia: 

 

O modelo desenvolvido por Duffie &amp;amp; Beckman [36] reduz a complexidade real das equações de 

energia do depósito formando um modelo simples e prático. Pressupõe trocas de energia pelas 

paredes do depósito e a estratificação da temperatura do fluido contido. Ghaddar &amp;amp; Al-Marafie 

[37] publicaram um método ainda mais simples que o anterior, de forma a ser resolvido 

analiticamente. Contudo este modelo apresenta uma grande incompatibilidade pelo facto de 

admitir que o depósito é isolado de forma perfeita e não tem perdas de calor convectivo com o 

ambiente. Este pressuposto permite simplificar bastante o modelo matemático usado e facilitar a 

sua computação, mas torna-o incompatível com depósitos reais.  

 

Kuhn, VanFuchs &amp;amp; Zob [38] desenvolveram um modelo em que cada entrada de volume de 

água não realiza misturas com o resto dos nós do depósito, criando camadas com diferentes 

volumes. Este modelo é ideal para modelos em que o volume do depósito se renova em 

intervalos de tempo algo curtos e, portanto, não se adequa ao modelo que se pretende 

desenvolver, devido à estagnação noturna. 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   32 

Insatisfeito com o modelo incluído no software TRNSYS na altura, B. Newton [39] 

desenvolveu um modelo alternativo e muito detalhado, específico para depósitos de água de 

sistemas com coletores solares, dando especial atenção às fontes de aquecimento no depósito e 

às consequentes alterações criadas no fluxo da água armazenada.  

 

Existem outros modelos que, apesar de satisfazerem grande parte dos critérios que permitem 

descrever os depósitos das bombas de calor caracterizados no programa, são desenvolvidos para 

depósitos onde o volume de fluido é variável, tornando os modelos incompatíveis com os 

sistemas em análise. 

 

O modelo desenvolvido neste trabalho tem por base o modelo criado por Duffie &amp;amp; Beckman 

[37], mas tem em conta o contributo de B. Newton [40] para o aquecimento das várias camadas 

estratificadas acima da cota do permutador de calor. 

 

Metodologia 

Analisando os modelos de armazenamento de energia existentes e não tendo em conta os que 

usam soluções salinas, verifica-se que o método de diferenças finitas é utilizado na maioria dos 

casos, dos quais fazem parte o método explícito e o método implícito. Usando o método 

explícito, a temperatura num determinado nó no momento t+1 é influenciada pela temperatura 

desse nó e dos nós adjacentes no momento t. Estas equações são, normalmente, mais simples de 

resolver, mas necessitam de satisfazer critérios de estabilidade. Estes critérios existem de forma 

a limitar o erro, definindo um limite máximo para o intervalo de tempo do algoritmo, o que 

pode levar a que o programa demore demasiado tempo a simular o período pretendido. Usando 

o método implícito, a temperatura de um nó no instante t+1 depende da temperatura desse nó no 

instante t e da temperatura dos nós adjacentes no instante t+1. O esforço realizado 

computacionalmente para resolver o sistema de equações é bastante maior do que no caso do 

método explícito mas, uma vez que não é necessário respeitar critérios de estabilidade, o 

algoritmo pode utilizar intervalos de tempos maiores e, consequentemente, menos iterações. 

Apesar de no método implícito não haver limite máximo para o intervalo de tempo, deve ter-se 

atenção a este fator pois pode tornar o sistema menos fiável. 

 

Tendo em conta que o modelo do depósito é simulado para um ano inteiro, o intervalo de tempo 

a ser utilizado não deve ser demasiado curto, de forma a não obrigar o programa a fazer um 

número exagerado de iterações e, consequentemente, demorar demasiado tempo. Por essa razão 

foi escolhido o método implícito. 

 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   33 

Sistema de Equações 

A equação do balanço de energia no depósito representa a variação de energia no depósito (??) 

num determinado período de tempo (??), e é obtida calculando a diferença entre o somatório do 

fluxo de energia que entra no sistema (?????) e o somatório do fluxo de energia que sai do sistema 

(??????). 

 

 

??

??
= ? ????? ? ? ??????  

 

(32) 

Esta equação é igualmente representativa do balanço de energia em cada nó do depósito. 

 

Como ganhos energéticos são contabilizados as entradas de fluido no depósito, a energia 

transferida pela bomba de calor e a energia transferida pela resistência auxiliar. Por sua vez, as 

perdas energéticas contabilizam as trocas de energia com o ar interior e a saída de fluido do 

depósito. Como a temperatura de entrada do fluido definida é menor do que a temperatura do ar 

interior definida, podem ocorrer, esporadicamente ganhos de energia nos nós inferiores (em vez 

de perdas) nas trocas pela parede do depósito. (Esquema 5). 

 

 

Esquema 5 – Trocas de energia entre camadas do depósito 

 

A equação geral do balanço de energia num nó é: 

 

 

??ó?????ó
??

= ?????? ?????? ? ?????? ?????? ? ??(??ó ? ????) + ????? + ??????

+  ??
? ?????? ????? ? ??

??????? ????ó 

(33) 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   34 

Em que ??ó é a massa de água do nó; ???ó é a variação da temperatura da água do nó; ?? é o 

intervalo de tempo; ?????? é o fluxo de água que entra pelo fundo do nó e ???? a sua temperatura; 

?????? é o fluxo de água que sai pelo topo do nó e ???? a sua temperatura; ?? é o coeficiente de 

perda do depósito; ?????  é o calor fornecido pela bomba de calor; ?????? é o calor fornecido pela 

resistência da bomba de calor e, por fim, ??? é a temperatura a que a água entra no depósito. 

 

A variação da temperatura da água afeta vários dos seus parâmetros e propriedades, como é o 

caso do calor específico da água (cp), mas, de forma a facilitar os cálculos e tendo em conta que 

a sua variação teria pouco impacto nos balanços, assume-se o seu valor como constante, 

definindo o seu valor para uma temperatura de 25ºC [40]. O pressuposto de que a variação da 

temperatura da água não altera de forma significativa as suas restantes propriedades também é 

essencial para manter o sistema linear, podendo desprezar-se a variação de densidade 

consequente da variação da temperatura e assumir que existe sempre a mesma massa de água no 

depósito. 

 

Visto que o volume de água no depósito se mantém inalterado durante todos os momentos, isto 

é, o volume do depósito encontra-se sempre preenchido por água, a quantidade de água que sai 

num determinado intervalo de tempo é igual à quantidade de água que entra nesse mesmo 

intervalo, logo: 

 

 ?????? = ?????? (34) 

 

Como o depósito apenas possui um ponto de entrada e um ponto de saída de água (na base e no 

topo, respetivamente) o valor de ??
? será 0 para equações de todos os nós, exceto para o nó do 

topo para o qual tem o valor 1. De forma análoga,  ??
? terá o valor 0 nas equações de todos os 

nós, exceto no nó da base onde assumirá o valor 1. Assim sendo, a expressão do método 

implícito toma a seguinte forma: 

 

??ó?? (
??ó

?+1 ? ??ó
?

??
)

= ?????? ????ó?1
?+1 ? ?????? ????ó

?+1 ? ??(??ó
?+1 ? ????

?+1 ) + ????? + ??????

+  ??
? ?????? ????? ? ??

??????? ????ó
?+1 

(35) 

 

Dado que o modelo apenas admite movimentos de massa no sentido ascendente, a equação de 

energia é escrita da seguinte forma: 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   35 

??ó?1
?+1 (??????? ??) + ??ó

?+1 (
??ó??

??
+ ?????? ?? + ?? + ??

??????? ??)

=
??ó????ó

?

??
+ ??. ????

?+1 + ????? + ?????? +  ??
? ?????? ????? 

(36) 

 

Podemos assim formar uma matriz A (? × ?), em que n é o número de nós do depósito e 

representa os coeficientes das incógnitas. A matriz B contém os termos independentes destas 

equações. 

 

 ?(?, ? ? 1) = (??????? ??) (37) 

 

 ?(?, ?) = (
??ó??

??
+ ?????? ?? + ?? + ??

??????? ??) (38) 

 

?(?, 1) = (
??ó????ó

?

??
+ ??. ????

?+1 + ????? + ?????? +  ??
? ?????? ?????) (39) 

 

No caso do nó superior não existe ? (?, ? ? 1) pois não existe nenhum nó acima deste.  

 

Tendo em conta que o sistema é formado por equações lineares, é possível resolvê-lo utilizando 

o algoritmo da eliminação de Gauss-Jordan, encontrando-se assim o valor das incógnitas da 

matriz, ou seja, as temperaturas de cada nó. 

 

Quando a bomba de calor se encontra em funcionamento, o calor transferido pelo condensador 

(????? ) é apenas dividido pelos nós que vão desde a posição do permutador até ao topo do 

depósito. No caso de algum dos nós se encontrar a uma temperatura superior à temperatura 

máxima definida pelo controlador, esse nó deixa de ser aquecido, assim como todos os nós que 

se encontram acima desse. 

 

3.5. Modelo da Bomba de Calor 

 

As equações que permitem modelar o funcionamento da bomba de calor são retiradas do 

trabalho de Facão &amp;amp; Carvalho [23], permitindo simular os seus balanços de energia dependentes 

de uma variedade de parâmetros, como são o caso da radiação, da hora do dia, ????, entre 

outros. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   36 

Como o evaporador da bomba de calor é definido como sendo um coletor solar sem cobertura, 

tem a capacidade de absorver calor de condensação quando a sua temperatura é inferior à 

temperatura de orvalho do ar exterior. A seguinte fórmula permite calcular a temperatura de 

orvalho (???) em função da ???? e da HR [41]: 

 

 ??? (???? , ??) =
?. (ln (

??
100

) +
?. ????

? + ????
)

? ? (ln (
??
100

) +
?. ????

? + ????
)
 (40) 

 

Em que ? e ? são constantes. 

 

Isto permite calcular a pressão de saturação (??), quer para a ??? que para a temperatura do 

evaporador (?? ) [42]. 

 

 

?? (?) = 10
2. exp (19,016 ?

4064,95

? + 236,25
) (41) 

 

Utilizando a seguinte equação obtém-se o calor contribuído pelo efeito de condensação 

(???????????çã?) [43]: 

 

???????????çã? = 1.357 × ? × (?2 + ?2 × ??????) × (??(??? ) ? ??(?? )) (42) 

 

Em que ?2 e ?2 são constante. Caso ?? &gt; ???, então ???????????çã? = 0. Por problemas de 

convergência foi definido um limite superior para o calor de condensação de 250W. 

 

Para se fazer o balanço da radiação global no evaporador (????) é necessário quantificar a 

emissividade do céu ( ?) e a radiação de grande comprimento de onda (??) [43]: 

 

 
? = 0,711 + 0,56 ×

???
100

+ 0,73 × (
???
100

)
2

 (43) 

 

 ?? = ??(???? + 273,15)
4(1 + cos ?)/2 (44) 

 

 ???? = ?? + 0,85(?? ? ?(???? + 273,15)
4) (45) 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   37 

Em que ? é a inclinação do coletor solar termodinâmico. Depois de calculados o ???????????çã? e 

o balanço radiativo do evaporador a seguinte equação permite determinar o fluxo de energia do 

evaporador (???????) [23]: 

 

 
??????? = ???????????çã? + ???? ? 0(1 ? ?? ??????)???

? ?[(?2 + ?2??????)(?? ? ????)] 
(46) 

 

Através dos dados fornecidos pelo fabricante relativamente ao compressor, é possível calcular o 

calor libertado pelo fluido no condensador (???????) e o trabalho transferido pelo compressor 

(???????), em função da ??  e da temperatura do condensador (?? ) [23]:  

 

 ??????? = ? + ??? + ???
2 + ??? + ??? ?? + ???

2?? (47) 

 

 ??????? = ?1 + ?1?? + ?1??
2 + ?1?? + ?1?? ?? + ?1??

2?? (48) 

 

No entanto, esta não é a única forma de calcular o ???????. Através do coeficiente global de 

transferência de calor do condensador (??????) e a diferença de temperaturas entre o fluido no 

condensador e a temperatura da água no tanque sabe-se essa potência [23]: 

 

 ??????? = ??????(?? ? ???) (49) 

 

Relacionando estes fluxos obtém-se o seguinte balanço de energia [23]: 

 

 ??????? = ??????? + ??????? ? ??????(?? ? ??? ) (50) 

 

Como o último elemento da equação é pequeno relativamente aos restantes, é retirado de forma 

a facilitar a computação do programa. 

 

Por outro lado, devido a problemas de convergência do sistema em algumas iterações, foi feita 

uma análise de regressão linear múltipla de forma a obter equações lineares para as correlações 

?? - ?? -??????? e ?? -?? -???????, estudando as curvas da ficha técnica do compressor: 

 

 ??????? = ?3 + ?3?? + ?3?? + ?3?? ?? (51) 

 

 ??????? = ?4 + ?4?? + ?4?? + ?4?? ??  (52) 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   38 

Tabela 12 – Valores das constantes das equações (50) e (51) 

?? ?? ?? ?? 

2182,64 82,313 -11,964 -0,5064 

    
?? ?? ?? ?? 

167,74 -7,227 4,854 0,1728 

 

Para resolver o sistema formado pelas equações (46) e (49) a (52) foi utilizado o método de 

Newton-Raphson, que resolve uma matriz 5x6 cujas cinco primeiras colunas são constituídas 

pelos coeficientes das incógnitas e a última coluna pelos termos independentes. As incógnitas 

deste sistema são: ?? , ?? , ???????, ??????? e ???????. 

 

3.6. Funcionamento da Aplicação 

 

3.6.1. Sub-rotinas e Namespace 

 

No Visual Basic, o procedimento “Sub” consiste numa série de instruções. Quando é chamado 

este procedimento não retorna valores, limitando-se a executar as tarefas ordenadas depois da 

declaração Sub e terminando com a declaração End Sub, Sub End ou Return. Uma sub-rotina 

pode conter argumentos (como constantes e variáveis) ou expressões que lhe são passadas pelo 

código de chamada. 

 

Sub-rotina ReDimData – A partir do ficheiro Excel da localidade escolhida pelo utilizador 

importa os dados climáticos relevantes para a aplicação. Uma vez que os valores importados são 

horários a sub-rotina calcula novos valores com intervalos de cem segundos através de 

interpolação linear. A seguir, calcula o ângulo de incidência dos raios solares no coletor para 

cada instante da simulação e a respetiva radiação incidente. 

 

Sub-rotina gaussJ – Calcula a solução de uma matriz de equações lineares utilizando o método 

de eliminação de Gauss-Jordan. 

 

Sub-rotina setQaux – Verifica se a temperatura da água que está a ser consumida respeita os 

valores exigidos pela norma EN 16147:2011 e, caso esses valores estejam em incumprimento, 

calcula a potência auxiliar necessária para manter o intervalo de temperaturas desejado. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   39 

Sub-rotina setQdep – Caso a bomba de calor esteja ligada, avalia a temperatura dos nós para 

garantir que nenhum nó acima do nó da sonda do controlador tenha uma temperatura superior a 

este e impede que a temperatura máxima definida pelo controlador seja ultrapassada. Fá-lo 

dividindo o calor do condensador pelo nó da sonda e os nós superiores à sonda, desde que 

estejam abaixo da temperatura definida. Caso encontre um nó com temperatura superior ao 

limite não o aquece, aquecendo apenas desde a sonda até aos nós imediatamente abaixo deste. 

 

Sub-rotina setCiclo – Avalia o ciclo de consumo escolhido pelo utilizador e define o caudal de 

extração exigido pela norma EN 16147:2011 para o respetivo tipo de consumo. A seguir avalia 

se com esse caudal a energia extraída é inferior à desejada. Caso seja inferior, é contabilizada a 

energia extraída e o caudal é mantido para o intervalo de tempo seguinte, até que a energia de 

extração exigida para o tipo de consumo seja atingida. No caso de ser superior à desejada, o 

caudal é redefinido para que naquele intervalo de tempo a energia extraída seja igual à desejada 

para o tipo de consumo em questão. 

 

Sub-rotina CicloBC – Simula o funcionamento da bomba de calor fazendo uso dos parâmetros 

descritos no trabalho de Facão &amp;amp; Carvalho [23]. Começa por calcular ???, ?? (??? ), ?, ??, ???? 

e o modificador de ângulo incidente (???). Posteriormente, através do método de Newton-

Raphson, e usando a sub-rotina “gaussJ” define-se para aquele instante o valor do calor do 

condensador e do evaporador, e as respetivas temperaturas assim como o trabalho do 

compressor. 

 

Sub-rotina NosDep – Define a temperatura de todos os nós do depósito em cada instante da 

simulação. Contém um ciclo for para todas os instantes do ano, que começa por avaliar a hora 

do dia e definir o intervalo de tempo da iteração nesse instante. Depois chama a sub-rotina 

“setCiclo” que define o valor do caudal de extração e a sub-rotina “setQdep” que divide o calor 

do condensador pelos vários nós. A seguir, com recurso à sub-rotina “gaussJ” calcula a 

temperatura em cada nó do depósito e chama a sub-rotina “setQaux” para avaliar se a 

temperatura no nó de extração respeita a norma EN 16147:2011. Consequentemente, calcula o 

calor que a resistência elétrica necessita fornecer para que a norma seja cumprida. 

Posteriormente, tendo em conta o modelo escolhido, é definido o intervalo de temperaturas de 

funcionamento do controlador para o instante simulado e é analisada a temperatura do nó da 

sonda do controlador. Caso a temperatura esteja fora dos limites definidos pelo controlador é 

chamada a sub-rotina “CicloBC”, que simula o funcionamento da bomba de calor naquele 

instante e define os valores do calor do condensador e do consumo do compressor. Esta sub-

rotina possui contadores que contabilizam a energia anual consumida pelo compressor e pela 

resistência elétrica, as perdas térmicas, a energia extraída para consumo e o calor fornecido pelo 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   40 

condensador, calculando também o SPF anual e mensal, assim como a energia renovável (Eren) 

anual e mensal. 

 

Os namespaces organizam objetos evitando ambiguidade e simplificando referências quando 

são usados grandes grupos de objetos, como é o caso das bibliotecas de classes. As classes são 

uma forma de encapsular sub-rotinas e funções num único objeto, para que o código se 

mantenha organizado e não seja repetitivo. 

 

Namespace CicloConsumos – Agrupa quatro classes (CicloS, CicloM, CicloL, CicloXL) que 

traduzem para a linguagem do Visual Basic a Tabela 8 e as tabelas do Anexo I, de forma a que 

a caracterização dos consumos possa ser usada pela sub-rotina “setCiclo”. 

 

3.6.2. Visão Geral da Aplicação 

 

O programa inicialmente apresenta uma interface (Figura 7) onde o utilizador poder escolher a 

localidade para a qual pretende fazer a simulação, a bomba de calor que deseja simular, bem 

como um dos ciclos de consumo disponíveis (Diagrama 1). A seleção da localidade define qual 

o ficheiro Excel de onde são retirados os dados climáticos; a escolha da bomba de calor define 

as variáveis correspondentes aos seus parâmetros de funcionamento; e a escolha do ciclo de 

consumo define os instantes em que existe extração e o seu caudal (m_dot_L) e energia 

(joulador). No entanto, existem alguns parâmetros que se encontram definidos desde o início do 

programa e que não podem ser alterados, como o número de nós do depósito (nos = 6) e os 

intervalos de tempo (de uma hora entre as 22:00 e as 7:00 e de cem segundos das 7:00 até às 

22:00). 

 

 

Figura 7 – Seleção da simulação a realizar pela aplicação 

 

Ao iniciar a simulação, o programa começa por importar os dados do ficheiro Excel da 

localidade escolhida e seguidamente redimensiona-os por interpolação linear para um vetor que 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   41 

respeite os intervalos de tempo definidos, correndo a sub-rotina “reDimData”. Uma vez definido 

o vetor ????, a sub-rotina calcula ????? e ???. Quando “reDimData” chega ao fim, inicia-se a sub-

rotina “NosDep”, representada no Diagrama 2, que começa por correr outra sub-rotina – 

“setCiclo” – definindo o valor do caudal de saída dependendo do ciclo de consumo escolhido e 

da energia extraída até esse instante (contakWh). Caso a bomba de calor esteja ligada (controlo 

= true), é chamada a sub-rotina “setQdep” que divide a potência do permutador do condensador 

(Qdotcond) pelos nós selecionados (Qdep), segundo os critérios definidos pela sub-rotina. Em 

seguida é simulado o funcionamento do depósito, calculando as temperaturas nos nós (Ts) 

através das equações do depósito usando outra sub-rotina – “gaussj” – que resolve o sistema de 

equações lineares utilizando o método da eliminação de Gauss-Jordan. Caso a temperatura no 

nó do depósito onde se encontra a sonda do controlador seja superior à temperatura máxima 

definida pelo mesmo (difSup) a bomba de calor é desligada (controlo = false). No entanto, se 

for inferior à temperatura mínima definida (difInf), a bomba de calor é ligada e é chamada a 

sub-rotina “CicloBC”. Esta simula o funcionamento da bomba de calor resolvendo um sistema 

de equações através do método de Newton-Raphson e definindo o calor do condensador que é 

transmitido à água no depósito, assim como a potência consumida pelo compressor 

(Wdotcomp). Se este calor não for suficiente para aquecer a água à temperatura desejada é 

considerado um apoio elétrico em série (Qaux) com o sistema, contabilizado pela sub-rotina 

“setQaux”. Ao chegar ao fim, a sub-rotina “NosDep” volta a iniciar-se para o instante seguinte, 

durante os 200385 instantes definidos. 

 

Por fim é apresentado um gráfico com os valores de SPF e Eren e uma janela com os valores da 

energia anual consumida pelo compressor (contWdotcomp) e apoio (contQaux), assim como a 

energia anual fornecida pelo condensador (contQdotcond), a energia anual consumida 

(contEner) e as perdas térmicas no depósito (contPT), como representado pela Figura 8. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   42 

OUTPUT 

Fim da aplicação 

INPUT 

Início da aplicação 

Localidade Modelo BC Ciclo de consumo 

????  ?? ????  ?? ?????? Latitude 

NosDep 

setCiclo 

setQdep 

gaussJ 

setQaux CicloBC 

CicloConsumo

s 

ReDimData 

SPF anual SPF mensal 

Perdas térmicas Consumo Anual 

Eren mensal Eren anual 

Qcond Wcomp 

 Variável 

 Processo 

 

 

Diagrama 1 – Funcionamento geral da aplicação 

Figura 8 – Resultado da simulação (exemplo) 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   43 

Início da sub-rotina 

Ciclo for de i = 0 até i = 200384 

Analisa a hora do dia e define o passo da iteração (3600s ou 100s) 

Contabiliza a contWcomp, contQcond e contQaux 

Chama a sub-rotina setCiclo 

Chama a sub-rotina setQdep caso controlo = true 

Ciclo for que define a matriz Al(6x6) 

Chama a sub-rotina gaussJ 

Define difSup e difInf tendo em conta o modelo da BC simulada e a hora do dia 

Verifica a Ts no nó da sonda e analisa se controlo será true ou false 

Chama a sub-rotina setQaux 

Contabiliza a contEner e contPT 

Fim do ciclo for e da sub-rotina 

Altera m_dot_L para que o 

caudal desejado seja mantido 

e contabiliza contakWh. 

Quando contkWh = joulador, 

m_dot_L = 0 

Analisa as Ts desde a sonda 

até ao topo e define Qdep 

Resolve o sistema e devolve as Ts 

Se a temperatura 

mínima de extração 

não cumprir a 

norma define Qaux 

Simula o funcionamento da BC naquele 

intervalo e calcula Qdotcond e Wdotcomp 

Se controlo = true chama a 

sub-rotina CicloBC 

Diagrama 2 – Sub-rotina NosDep 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   44 

Capítulo 4 – Resultados 

 

A análise realizada neste capítulo tem como objetivo estudar a viabilidade dos resultados 

obtidos através da aplicação desenvolvida, comparando-os com os resultados obtidos no LNEG 

com base numa simulação do sistema utilizando o programa TRNSYS e a caracterização 

experimental dos sistemas de acordo com a metodologia expressa em [23]. 

 

Não é possível antecipar com exatidão o valor da energia extraída durante um determinado 

intervalo de tempo, dado que o modelo de equações do depósito demonstra que o caudal de 

extração num intervalo de tempo influencia a temperatura da água de saída do depósito. 

Contudo, a diferença entre a energia que deveria ser extraída segundo a EN 16147:2011 e a 

energia extraída pela simulação é muito pequena, sendo inferior a 1% quando comparados os 

valores da energia útil anual obtidos no LNEG com os da aplicação. 

 

A análise gráfica dos resultados mensais do SPF foi feita em maior detalhe para as localidades 

onde se verificou o maior (Ponta Delgada) e o menor (Viseu) SPF, assim como a maior (Beja) e 

a menor (Funchal) radiação direta anual. 

 

Sistema I – 200L 

O mês de agosto destaca-se como o mês com maior SPF para as cidades vistas em detalhe, quer 

na aplicação desenvolvida quer nos resultados anteriormente obtidos no LNEG. Os valores são 

coincidentes para Ponta Delgada – 3,37 – e a maior diferença observada com a aplicação foi de -

1% para Viseu. Por outro lado, em ambos os trabalhos verificou-se que , com exceção de Ponta 

Delgada, o SPF mais baixo em dezembro. Na região autónoma dos Açores verificou-se também 

a maior diferença obtida com a aplicação (2,4%) (Gráfico 2). 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   45 

 
Gráfico 2 – SPF mensal calculado pela aplicação para o sistema I (SPF a amarelo e Eren a azul). A – Ponta Delgada; 

B – Viseu; C – Beja; D – Funchal 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   46 

Relativamente à diferença de amplitude entre os meses com maior e menor SPF, verificou-se 

que esta era mais acentuada nos resultados anteriormente obtidos no LNEG do que nos 

resultados da aplicação agora desenvolvida (Figura 9). As divergências foram maiores para as 

localidades de Aveiro, Coimbra e Portalegre (-21,3%, -19,2% e -19,2%, respetivamente) e 

menores para as cidades do Funchal, Amarante e Beja (-3,7%, -5,7% e -6,8%, respetivamente). 

 

 

Figura 9 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema I) 

 

Quanto aos valores anuais do SPF obtidos pela aplicação, verificou-se que estes variam entre 

3,19 em Ponta Delgada e 2,76 em Viseu, sendo expetável que na primeira região sejam 

produzidos anualmente 2929 kWh de origem renovável, sendo que para a região Dão-Lafões 

cerca de 2716 kWh (Tabela 13). 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   47 

Tabela 13 – Resultados da simulação (Sistema I) 

Localidade SPF - LNEG SPF Eren 

Viana do Castelo 2,78 2,78 2728 

Bragança 2,87 2,91 2798 

Braga 2,77 2,78 2730 

Guimarães 2,80 2,81 2747 

Porto 2,85 2,86 2771 

Amarante 2,79 2,78 2731 

Vila Real 2,87 2,89 2787 

Santa Maria da Feira 2,78 2,78 2731 

Aveiro 2,85 2,85 2769 

Viseu 2,76 2,76 2716 

Seia 2,79 2,77 2726 

Guarda 2,81 2,83 2756 

Coimbra 2,82 2,83 2754 

Oliveira do Hospital 2,81 2,81 2745 

Covilhã 2,81 2,79 2734 

Sertã 2,82 2,82 2752 

Castelo Branco 2,94 2,93 2807 

Leiria 2,88 2,91 2798 

Tomar 2,82 2,83 2755 

Torres Vedras 2,95 2,97 2827 

Santarém 2,92 2,94 2811 

Portalegre 2,98 2,98 2832 

Lisboa 2,98 2,98 2832 

Setúbal 2,93 2,92 2803 

Évora 2,98 2,98 2834 

Grândola 2,92 2,93 2807 

Beja 3,03 3,04 2862 

Faro 3,00 2,99 2836 

Ponta Delgada 3,14 3,19 2929 

Funchal 3,03 3,06 2869 

 

As localidades onde as diferenças de valores são menores situam-se maioritariamente no sul do 

país. Os valores obtidos pela aplicação para o SPF anual estão bastante próximos dos valores 

anteriormente obtidos no LNEG, apresentando uma variação máxima de 1,3% para Seia e Braga 

e sendo igual para as localidades de Santarém, Lisboa, Setúbal e Grândola (Figura 10). 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   48 

 
Figura 10 – Diferença entre os valores do SPF anual (Sistema I) 

 

Sistema II – 250L 

Em ambos os trabalhos verificou-se que para as quatro cidades escolhidas o mês com maior SPF 

é agosto e o mês com menor SPF é janeiro, com exceção de Ponta Delgada que tem em 

dezembro o valor mais baixo (Gráfico 3). Comparando os valores do mês de agosto obtidos 

pela aplicação com os anteriormente obtidos pelo LNEG, verificou-se para Viseu a maior 

diferença (-4,1%), e para o mês com SPF mais baixo a maior diferença foi de 7,7% também para 

Viseu. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   49 

 
Gráfico 3 – SPF mensal calculado pela aplicação para o sistema II (SPF a amarelo e Eren a azul). A – Ponta Delgada; 

B – Viseu; C – Beja; D – Funchal 

 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   50 

No que diz respeito ao valor máximo e mínimo do SPF mensal para uma localidade verificou-se 

que a sua diferença é menor nos resultados obtidos pela aplicação comparativamente com os 

valores do ensaio experimental, sendo que as maiores variações entre os dois métodos se 

registaram para as localidades de Viseu, Coimbra e Amarante (-45,1%, -44,6% e -41,7%, 

respetivamente) e as menores variações em Aveiro, Beja e Seia (-18,2%, -23,9% e -26,4%, 

respetivamente) (Figura 11). 

 

 

Figura 11 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema II) 

 

As localidades com maior SPF anual são Ponta Delgada (3,63), Funchal (3,49) e Beja (3,47), 

tendo Viseu (3,18) o SPF mais baixo, seguido de Viana do Castelo, Braga, Amarante, Santa 

Maria da Feira e Seia (todas com 3,21). A energia anual proveniente de fonte renovável para 

este sistema, representada na Tabela 14, varia entre 5046 e 4776 kWh. 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   51 

Tabela 14 – Resultados da simulação (Sistema II) 

Localidade SPF - LNEG SPF Eren 

Viana do Castelo 3,18 3,21 4794 

Bragança 3,31 3,34 4882 

Braga 3,17 3,21 4795 

Guimarães 3,21 3,24 4816 

Porto 3,25 3,29 4845 

Amarante 3,18 3,21 4797 

Vila Real 3,29 3,32 4865 

Santa Maria da Feira 3,18 3,21 4797 

Aveiro 3,27 3,28 4839 

Viseu 3,15 3,18 4776 

Seia 3,17 3,21 4794 

Guarda 3,22 3,26 4830 

Coimbra 3,23 3,25 4820 

Oliveira do Hospital 3,22 3,24 4814 

Covilhã 3,21 3,22 4801 

Sertã 3,23 3,25 4821 

Castelo Branco 3,37 3,35 4889 

Leiria 3,31 3,34 4878 

Tomar 3,23 3,25 4824 

Torres Vedras 3,39 3,40 4914 

Santarém 3,36 3,36 4893 

Portalegre 3,42 3,41 4920 

Lisboa 3,41 3,41 4925 

Setúbal 3,35 3,35 4885 

Évora 3,42 3,41 4924 

Grândola 3,36 3,36 4891 

Beja 3,49 3,47 4960 

Faro 3,43 3,42 4926 

Ponta Delgada 3,61 3,63 5046 

Funchal 3,45 3,49 4967 

 

Analisando os valores do SPF anual obtidos pela aplicação, verificou-se que estão bastante 

próximos dos anteriormente obtidos pelo LNEG para o mesmo sistema, coincidindo várias 

vezes e tendo como resultado menos semelhante o da localidade de Ponta Delgada, com uma 

diferença relativa de 1,6%. As localidades onde as diferenças são menores situam-se 

maioritariamente no sul do país (Figura 12).  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   52 

 
Figura 12 – Diferença entre os valores do SPF anual (Sistema II) 

 

Sistema III – 300L 

Analisando os resultados mensais para as localidades escolhidas, verificou-se que no mês com 

SPF mais elevado (agosto) a maior diferença entre os valores anteriormente obtidos pelo LNEG 

e da aplicação (Gráfico 4) é de 4,2% e no mês com SPF mais baixo (dezembro em Ponta 

Delgada e janeiro nas restantes) a maior diferença entre os valores obtidos através dos dois 

métodos é de -7,8%. Para ambos os SPF, menor e maior, as maiores diferenças foram 

observadas na região Dão-Lafões, representada por Viseu. 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   53 

 
Gráfico 4 – SPF mensal calculado pela aplicação para o sistema III (SPF a amarelo e Eren a azul). A – Ponta 

Delgada; B – Viseu; C – Beja; D – Funchal 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   54 

Relativamente aos valores máximo e mínimo do SPF mensal para uma localidade (Figura 13), é 

notório que a diferença entre os dois valores é sempre menor nas simulações da aplicação, tal 

como foi constatado nos sistemas anteriores. Os valores mais baixos registam-se nas localidades 

de Ponta Delgada, Beja e Torres Vedras (-15,8%, -16,5% e -24,4%, respetivamente) e os valores 

mais altos em Coimbra, Santa Maria da Feira e Sertã (-44,6%, -42,2%, -40,0%, respetivamente). 

 

 
Figura 13 – Diferença de amplitude entre os meses como maior e menor SPF (Sistema III) 

 

No que concerne o SPF anual, os valores mais elevados voltaram a registar-se nos arquipélagos 

dos Açores (3,83) e da Madeira (3,67), assim como no Baixo Alentejo (3,65); ficando no 

extremo oposto as localidades de Viseu (3,32), Viana do Castelo (3,35), Braga (3,35) e Seia 

(3,35). Para Ponta Delgada a energia anual proveniente de fonte renovável é de 5152 kWh, 

enquanto para Viseu é de 4873 kWh, como representado na Tabela 15: 

 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   55 

Tabela 15 – Resultados da simulação (Sistema III) 

Localidade SPF - LNEG SPF Eren 

Viana do Castelo 3,33 3,35 4890 

Bragança 3,46 3,50 4979 

Braga 3,32 3,35 4893 

Guimarães 3,37 3,39 4914 

Porto 3,42 3,44 4946 

Amarante 3,3 3,36 4897 

Vila Real 3,45 3,47 4964 

Santa Maria da Feira 3,33 3,36 4895 

Aveiro 3,43 3,43 4938 

Viseu 3,3 3,32 4873 

Seia 3,32 3,35 4892 

Guarda 3,37 3,41 4928 

Coimbra 3,39 3,39 4918 

Oliveira do Hospital 3,37 3,38 4912 

Covilhã 3,36 3,36 4900 

Sertã 3,38 3,39 4919 

Castelo Branco 3,54 3,52 4990 

Leiria 3,48 3,49 4977 

Tomar 3,39 3,40 4923 

Torres Vedras 3,57 3,56 5013 

Santarém 3,53 3,52 4993 

Portalegre 3,59 3,57 5021 

Lisboa 3,6 3,58 5026 

Setúbal 3,53 3,51 4986 

Évora 3,59 3,58 5024 

Grândola 3,53 3,52 4990 

Beja 3,68 3,65 5060 

Faro 3,62 3,59 5039 

Ponta Delgada 3,82 3,83 5152 

Funchal 3,66 3,67 5070 

 

Comparativamente com os valores anteriormente obtidos pelo LNEG, os valores do SPF anual 

obtidos pela aplicação são menos coincidentes para as localidades de Amarante (1,8%), Guarda 

(1,2%) e Bragança (1,2%), sendo que em Aveiro, Coimbra e Covilhã os valores são iguais 

(Figura 14). 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   56 

 

Figura 14 – Diferença entre os valores do SPF anual (Sistema III) 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   57 

Capítulo 5 – Conclusão 

 

Neste trabalho propôs-se o desenvolvimento de uma ferramenta que simula o funcionamento 

anual de uma bomba de calor assistida por energia solar, que seja de fácil interação, cujos 

resultados são facilmente interpretados pelo utilizador, permitindo ao possível cliente averiguar 

o custo energético das suas necessidades de consumo. Esta facilmente permite também conhecer 

o SPF, a energia proveniente de fonte renovável e as perdas térmicas anuais do depósito. 

 

O modelo de depósito desenvolvido foi minuciosamente testado antes da conclusão da 

aplicação, permitindo o estudo do seu comportamento durante os períodos de extração e durante 

o período de funcionamento da bomba de calor, assim como a ocorrência simultânea de 

extração e aquecimento da água do depósito. Os resultados obtidos e as comparações efetuadas 

comprovam a validação deste modelo. 

 

A aplicação encontra-se concebida para 3696 configurações distintas (308 municípios, 4 perfis 

de extração e 3 sistemas), das quais 90 foram comparadas com resultados anteriormente obtidos 

pelo LNEG para caracterização dos sistemas I, II e III. Analisando os valores do SPF mensal, 

verifica-se que para essas configurações existe alguma divergência na amplitude entre os meses 

com pior e melhor SPF. Tal poderá dever-se às alterações necessárias para a convergência do 

sistema de equações da bomba de calor. Porém, não é percetível através dos resultados obtidos, 

se existe uma subestimação ou sobrestimação da energia solar convertida e das perdas térmicas 

do depósito. Ainda assim, são mais relevantes para o presente trabalho os valores do SPF anual 

obtidos pela aplicação, uma vez que a diferença relativamente aos valores anteriormente obtidos 

no LNEG é sempre inferior a 2%, sendo inclusivamente muitas vezes coincidente. A nível 

absoluto, Ponta Delgada apresenta, para todos os sistemas, o SPF anual mais elevado. Na 

situação oposta encontra-se a cidade de Viseu, sendo também percetível que, de uma forma 

geral, à medida que se avança para sul em Portugal continental o SPF vai aumentando.  

 

Futuramente, poderá ser acrescentado à aplicação a possibilidade de o utilizador definir o seu 

próprio perfil de extração diário, bem como os dias da semana em que esse perfil é alterado, e 

até simular dias sem extração, para períodos de férias, por exemplo. Outro parâmetro passível 

de ser alterado no futuro tendo em conta o interesse do utilizador, é a amplitude de temperaturas 

do controlador. Por definição, o ângulo de inclinação do painel termodinâmico é de 45º, mas 

poderá ser vantajoso modificá-lo, tendo em conta o perfil de extração definido, através do 

desenvolvimento de uma metodologia para a otimização desse ângulo. Poderá também ser 

adicionada uma componente de análise económica, tendo em vista o custo da eletricidade e o 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   58 

ciclo de vida do equipamento. Por fim, outra alteração interessante seria tentar diminuir o tempo 

de simulação, aplicando outros métodos ou reformando o código do programa, podendo, 

hipoteticamente, ser aumentado o número de nós do depósito (seis).  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   59 

Referências Bibliográficas 
 

[1]  Parlamento Europeu, “Política Energética: Princípios Gerais,” 2014. 

[2]  Parlamento Europeu, “Energias Renováveis,” 2014. 

[3]  Agência Internacional de Energia, “World Energy Outbook 2013,” 2013. 

[4]  Federação Europeia da Indústria Solar Térmica (ESTIF), “Solar Thermal Market in Europe 

- Trends an Market Statistics 2013,” 2014. 

[5]  Direção Geral de Energia e Geologia, “Fatura Energética Portuguesa 2013,” 2014. 

[6]  Direção Geral de Energia e Geologia, “Balanço Energético 2013,” 2014. 

[7]  Direção Geral de Energia e Geologia, “Inquérito ao Consumo de Energia no Sector 

Doméstico 2010,” 2011. 

[8]  F. Cardoso, “Podemos chegar aos 120.000m2,” Edifícios e Energia, Setembro/Outubro 

2014.  

[9]  “Renewable Heating &amp;amp; Cooling Platform,” [Online]. Available: http://www.rhc-

platform.org/. [Acedido em junho 2015]. 

[10]  Renewable Heating &amp;amp; Cooling, “Cross-Cutting Technology Roadmap,” Bruxelas, 2014. 

[11]  “EUREC,” [Online]. Available: http://www.eurec.be/en/Projects-Partnerships/European-

Technology-Platforms/Renewable-Heating-and-Cooling/ . [Acedido em junho 2015]. 

[12]  “Solar Heating &amp;amp; Cooling Program,” [Online]. Available: http://task44.iea-

shc.org/description. [Acedido em junho 2015]. 

[13]  “PVGIS,” [Online]. Available: http://re.jrc.ec.europa.eu/pvgis/download/download.htm. 

[Acedido em janeiro 2015]. 

[14]  Portal Energia, “Energia Solar Térmica - manual sobre tecnologias, projecto e instalação,” 

2004. 

[15]  C. Honsberg e S. Bowden, “PVEDUCATION,” [Online]. Available: 

http://pveducation.org/. [Acedido em junho 2015]. 

[16]  Y. Goswami, F. Kreith e J. F. Kreider, Principles of Solar Engineering, CRC Press, 2015.  

[17]  Y. Cengel e M. Boles, Termodinamica, McGraw Hill, 2011.  

[18]  “EN 15316-4-2: 2008. Heating systems in buildings. Method for calculation of system 

energy requirements and system efficiencies.,” 2008.  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   60 

[19]  M. Kaltschmitt, W. Streicher e A. Wiese, Renewable Energy - Technology, Economics and 

Environment, Springer, 2007.  

[20]  E. Frank, M. Haller, S. Herkel e J. Ruschenburg, “Systematic Classification of Combined 

Solar Thermal and Heat Pump Systems,” em Proceedings of the EuroSun 2010 

Conference, Graz, Austria, 2010.  

[21]  S. Chaturvedi, V. Gagrani e T. Abdel-Salam, “Solar-assisted heat pump - A sustainable 

system for low-temperature water heating applications,” Elsevier, 2013.  

[22]  X. Kong, D.Zhang, Y. Li e Q. Yang, “Thermal performance analysis of a direct-expansion 

solar-assisted heat pump water heater,” Energy, 2011.  

[23]  J. Facão e M. J. Carvalho, “New test methodologies to analyze direct expansion solar 

assisted heat pumps for domestic hot water,” Solar energy 100, pp. 66-75, 2014.  

[24]  M. Zhu, H. X. B. Zhang e X. Guan, “The Characteristics of the Evaporator/Evaporator for 

Direct Expansion Solar Assisted Heat Pump System,” Journal of Power and Energy 

Engineering, pp. 73-76, 2013.  

[25]  M. J. Carvalho, “Princípios Gerais para Concepção e Dimensionamento de Sistemas 

Solares Térmicos Activos,” 1998. 

[26]  “Codeproject,” [Online]. Available: http://www.codeproject.com/Articles/710181/Visual-

Basic-6-0-A-giant-more-powerful-than-ever. [Acedido em janeiro 2015]. 

[27]  M. Dias. [Online]. Available: http://www.mdias.uac.pt/AN_0506/act_1.pdf. [Acedido em 

junho 2015]. 

[28]  C. Balsa, “Capítulo 2 - Sistemas de Equações Lineares,” [Online]. Available: 

http://www.ipb.pt/~balsa/teaching/MN08/Sist_Lin.pdf. [Acedido em março 2015]. 

[29]  “Wikipédia - Eliminação de Gauss-Jordan,” [Online]. Available: 

https://en.wikipedia.org/wiki/Gaussian_elimination. [Acedido em junho 2015]. 

[30]  C. Balsa, “Capítulo 3 - Sistemas de Equações Lineares,” [Online]. Available: 

http://www.ipb.pt/~balsa/teaching/1011/M1/cap3_aula.pdf. [Acedido em Março 2015]. 

[31]  C. Balsa, “Capítulo 4 - Equações Não-Lineares,” [Online]. Available: 

http://www.ipb.pt/~balsa/teaching/1011/MAE/cap4.pdf. [Acedido em março 2015]. 

[32]  C. Conde e E. Schiavi, Métodos numéricos de resolución de ecuaciones no lineales.  

[33]  Comissão Europeia, “Regulamento (UE) N.º814/2013,” Jornal Oficial da União Europeia, 

vol. 239, pp. 162-183, 2013.  

[34]  “EN 16147:2011. Heat pumps with electrically driven compressor – Testing and 

requirements for marking of domestic hot water units.,” 2011. 



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   61 

[35]  Comissão Europeia, “Decisão da Comissão 2013/114/EU,” Jornal Oficial da União 

Europeia, vol. 62, pp. 27-35, 2013.  

[36]  “LNEG,” [Online]. Available: http://www.lneg.pt/servicos/328/2263/. [Acedido em março 

2015]. 

[37]  J. A. Duffie e W. A. Beckman, em Solar Engineering of Thermal Processes, Wiley, 2013, 

pp. 379-384. 

[38]  N. Ghaddar e A. Al-Marafie, “Numerical simulation of stratification behaviour in thermal 

storage tanks,” Applied Energy, vol. 32, n.º 3, pp. 225-239, 1989.  

[39]  J. K. Kuhn, G. F. Vonfuchs e A. P. Zob, “Developing and Upgrading of Solar System 

Thermal Energy Storage Simulation Models,” Maio 1980.  

[40]  B. J. Newton, “Modeling of Solar Storage Tanks,” 1995. 

[41]  “Waxa software,” [Online]. Available: 

http://www.vaxasoftware.com/doc_eduen/qui/caloresph2o.pdf. [Acedido em abril 2015]. 

[42]  D. Sonntag, Important New Values of the Physical Constants of 1986, Vapour Pressure 

Formulations based on the IST-90 and Psychrometer Formulae, 1990, pp. 340-344. 

[43]  K. Vajen, M. Kramer e E. Frank, “Extended Model Equation for uncovered collectors,” em 

ISES Solar World Congress, Gotemburgo, 2003.  

[44]  G. L. Morrison, “Simulation of Packaged Solar Heat-Pump Water Heaters,” Solar Energy, 

vol. 53, pp. 249-257, 1994.  

 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   62 

 

 

 

 

 

Anexos 
  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   63 

Anexo Ia – Ciclo de Consumo S (EN 16147:2011) 

 

  

Hora de 

início 

Energia 

(kWh) 

Tipo ?? desejada (K), a ser 
mantida durante a extração 

?? (K) mínima para 
contar como energia útil 

1 07:00 0,105 Pequeno   15 

2 07:30 0,105 Pequeno   15 

3 08:30 0,105 Pequeno   15 

4 09:30 0,105 Pequeno   15 

5 11:30 0,105 Pequeno   15 

6 11:45 0,105 Pequeno   15 

7 12:45 0,315 Lavagem louça 45   

8 18:00 0,105 Pequeno   15 

9 18:15 0,105 Limpeza casa   30 

10 20:30 0,420 Lavagem louça 45   

11 21:30 5,250 Grande   30 

Total 2,1       

 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   64 

Anexo Ib – Ciclo de Consumo M (EN 16147:2011) 

 

  

Hora de 

início 

Energia 

(kWh) 

Tipo ?? desejada (K), a ser 
mantida durante a extração 

?? (K) mínima para 
contar como energia útil 

1 07:00 0,105 Pequeno   15 

2 07:15 1,400 Duche   30 

3 07:30 0,105 Pequeno   15 

4 08:01 0,105 Pequeno   15 

5 08:15 0,105 Pequeno   15 

6 08:30 0,105 Pequeno   15 

7 08:45 0,105 Pequeno   15 

8 09:00 0,105 Pequeno   15 

9 09:30 0,105 Pequeno   15 

10 10:30 0,105 Limpeza chão 30   

11 11:30 0,105 Pequeno   15 

12 11:45 0,105 Pequeno   15 

13 12:45 0,315 Lavagem louça 45   

14 14:30 0,105 Pequeno   15 

15 15:30 0,105 Pequeno   15 

16 16:30 0,105 Pequeno   15 

17 18:00 0,105 Pequeno   15 

18 18:15 0,105 Limpeza casa   30 

19 18:30 0,105 Limpeza casa   30 

20 19:00 0,105 Pequeno   15 

21 20:30 0,735 Lavagem louça 45   

22 21:15 0,105 Pequeno   15 

23 21:30 1,400 Duche   30 

Total 5,845       

 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   65 

Anexo Ic – Ciclo de Consumo L (EN 16147:2011) 

 

  

Hora de 

início 

Energia 

(kWh) 

Tipo ?? desejada (K), a ser 
mantida durante a extração 

?? (K) mínima para 
contar como energia útil 

1 07:00 0,105 Pequeno   15 

2 07:15 1,400 Duche   30 

3 07:30 0,105 Pequeno   15 

4 07:45 0,105 Pequeno   15 

5 08:05 3,605 Banho 30   

6 08:25 0,105 Pequeno   15 

7 08:30 0,105 Pequeno   15 

8 08:45 0,105 Pequeno   15 

9 09:00 0,105 Pequeno   15 

10 09:30 0,105 Pequeno   15 

11 10:30 0,105 Limpeza chão 30   

12 11:30 0,105 Pequeno   15 

13 11:45 0,105 Pequeno   15 

14 12:45 0,315 Lavagem louça 45   

15 14:30 0,105 Pequeno   15 

16 15:30 0,105 Pequeno   15 

17 16:30 0,105 Pequeno   15 

18 18:00 0,105 Pequeno   15 

19 18:15 0,105 Limpeza casa   30 

20 18:30 0,105 Limpeza casa   30 

21 19:00 0,105 Pequeno   15 

22 20:30 0,735 Lavagem louça 45   

23 21:00 3,605 Banho 30   

24 21:30 0,105 Pequeno   15 

Total 11,655       

 

  



Desenvolvimento de aplicação informática para cálculo de desempenho energético de bombas de calor assistidas por energia solar 

Artur Filipe Felizardo Vilela   66 

Anexo Id – Ciclo de Consumo XL (EN 16147:2011) 

 

  

Hora de 

início 

Energia 

(kWh) 

Tipo ?? desejada (K), a ser 
mantida durante a extração 

?? (K) mínima para 
contar como energia útil 

1 07:00 0,105 Pequeno   15 

2 07:15 1,820 Duche   30 

3 07:26 0,105 Pequeno   15 

4 07:45 4,420 Banho 30   

5 08:05 0,105 Pequeno   15 

6 08:15 0,105 Pequeno   15 

7 08:30 0,105 Pequeno   15 

8 08:45 0,105 Pequeno   15 

9 09:00 0,105 Pequeno   15 

10 09:30 0,105 Pequeno   15 

11 10:00 0,105 Pequeno   15 

12 10:30 0,105 Limpeza chão 30   

13 11:00 0,105 Pequeno   15 

14 11:30 0,105 Pequeno   16 

15 11:45 0,105 Pequeno   15 

16 12:45 0,735 Lavagem louça 45   

17 14:30 0,105 Pequeno   15 

18 15:00 0,105 Pequeno   15 

19 15:30 0,105 Pequeno   15 

20 16:00 0,105 Pequeno   15 

21 16:30 0,105 Pequeno   15 

22 17:00 0,105 Pequeno   15 

23 18:00 0,105 Pequeno   15 

24 18:15 0,105 Limpeza casa   30 

25 18:30 0,105 Limpeza casa   30 

26 19:00 0,105 Pequeno   15 

27 20:30 0,735 Lavagem louça 45   

28 20:46 4,420 Banho 30   

29 21:15 0,105 Pequeno   15 

30 21:30 4,420 Banho 30   

Total 19,07       

 


</field>
	</doc>
</add>