<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.15625</field>
		<field name="filename">22092_2017SerraCalculo.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 

 

 

 

AUTARQUIA ASSOCIADA À UNIVERSIDADE DE SÃO PAULO 

Cálculo da fração de vazio em escoamentos bifásicos (gás/líquido) a partir da 
identificação de bolhas em imagens digitais 

Pedro Luiz Santos Serra 

 Tese apresentada como parte dos  
requisitos para obtenção do Grau de  
Doutor em Ciências na Área  
de Tecnologia Nuclear - Reatores 
 

 Orientador: 

 Prof. Dr.  Roberto Navarro de Mesquita 

São Paulo 

2017 
 



 

 

 

INSTITUTO DE PESQUISAS ENERGÉTICAS E NUCLEARES 
Autarquia associada à Universidade de São Paulo 

 Cálculo da fração de vazio em escoamentos bifásicos (gás/líquido) a partir da 
identificação de bolhas em imagens digitais 

Pedro Luiz Santos Serra 

 Tese apresentada como parte dos  
requisitos para obtenção do Grau de  
Doutor em Ciências na Área  
de Tecnologia Nuclear - Reatores 
 

 Orientador: 

 Prof. Dr.  Roberto Navarro de Mesquita 

Versão Corrigida 
Versão Original disponível no IPEN 

São Paulo 

2017 

 
 



 
 

 

 

  

 

 

 

 

  

 

 

 

 

 

Lúcia e Caio, 

 

 a vocês, pelo carinho, amor e compreensão em todas as fases  desta tese de 

doutorado mas,em especial, pelo apoio recebido  nos  momentos mais críticos de sua 

realização. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



 
 

 

 

AGRADECIMENTOS 

 

Pessoas especiais foram marcantes nessa jornada. Algumas me indicaram o 

caminho e como abrir portas, outras transformaram momentos de angústia em incentivo, 

motivação  possibilitando realizações e, por fim, aquelas que não economizaram esforços 

em suas orientações convertendo situações difíceis, impasses e condições obscuras em 

soluções. 

Ao Dr. Régis Cortez Bueno por mostrar e me indicar o caminho a seguir. 

Através dela foi possível a realização destes estudos no Centro de Engenharia Nuclear - 

CEN do Instituto de Pesquisas Energéticas e Nucleares - IPEN e pela parceria, 

companheirismo e amizade. 

Ao Dr. Paulo Henrique Mazotti pela abertura aos debates que resultaram na 

solução de muitos problemas. Pela ajuda na construção do módulo gerador de escoamento 

bifásico para aplicação no reator e, principalmente, no incentivo e motivação nos 

momentos de desânimo e ausência de resultados justificáveis.  

Em especial ao Dr. Roberto Navarro de Mesquita na condução deste trabalho, 

apontando caminhos em situações difíceis, mostrando opções em ocasiões de resultados 

não convincentes, fomentando com dados e revertendo situações que se apresentavam sem 

possibilidades de evolução. Uma pessoa visionária que ao longo desses anos demonstrou 

uma invejável capacidade de mostrar que a ciência não tem limites e a humanidade evolui 

ao buscar avançar superando barreiras. 

 

A todos vocês, muito obrigado e que a luz do Grande Arquiteto do Universo 

ilumine vossas jornadas. 

 

 

 

 

 

 

 

 



 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

“No fundo não sou literato, sou pintor. Nasci pintor, mas como nunca peguei nos pincéis a 

sério, arranjei, sem nenhuma premeditação, este derivativo de literatura, e nada mais 

tenho feito senão pintar com palavras.”  

Carta a Godofredo Rangel, Areias, 6/7/1909. 

Monteiro Lobato  

 



 
 

CÁLCULO DA FRAÇÃO DE VAZIO EM ESCOAMENTOS BIFÁSICOS 

(GÁS/LÍQUIDO) A PARTIR DA IDENTIFICAÇÃO DE BOLHAS EM IMAGENS 

DIGITAIS 

Pedro Luiz Santos Serra 

RESUMO 

 

A Agência Internacional de Energia Atômica (IAEA - "International Atomic 

Energy Agency") vem incentivando o desenvolvimento de sistemas passivos de 

refrigeração em plantas nucleares visando a simplificação e o incremento da confiabilidade 

em funções essenciais de segurança nos projetos de uma próxima geração de reatores 

nucleares refrigerados a água. O principal fundamento desses sistemas é o emprego da 

circulação natural como sistema de segurança aplicável em operações de desligamento do 

reator para manutenção ou na ocorrência de acidentes. A circulação natural é um fenômeno 

que surge em virtude do gradiente de temperatura em pontos diferentes do circuito de 

refrigeração. Em condições extremas de estabilidade têm-se o estabelecimento do 

escoamento bifásico gás/líquido podendo configurar-se segundo diferentes regimes. A 

fração de vazio é reconhecida como um dos parâmetros chave na predição da ocorrência de 

instabilidades do escoamento bifásico.  

Apresenta-se neste trabalho uma inovadora metodologia para estimativa da fração 

de vazio a partir de imagens digitais capturadas diretamente de circuitos experimentais que 

geram o escoamento bifásico. O método é baseado na aquisição de imagens, com controle 

da profundidade de campo, de uma seção do Circuito de Circulação Natural (CCN) 

presente no IPEN/CNEN-SP. A imagem é segmentada com base na inferência fuzzy de 

diferentes parâmetros de segmentação e ajustada ao foco utilizado na sua aquisição. Ela é 

varrida de um modo inédito e iterativo, utilizando máscaras de diferentes tamanhos 

integrando um conjunto de redes neurais com a Transformada Randomizada de Hough. 

Cada diferente tamanho de máscara é escolhido de acordo com os tamanhos das bolhas que 

são os objetos de interesse. O volume da bolha é estimado baseado em sua projeção plana 

capturada nas imagens digitais. O cálculo da fração de vazio considera o volume da seção 

geométrica do escoamento no tubo de vidro cilíndrico e a profundidade de campo utilizada 

e nos parâmetros geométricos inferidos para cada bolha detectada.  

Os resultados mostraram que a integração entre o conjunto de redes neurais e a 

Transformada Randomizada de Hough aumentaram a robustez das estimativas do sistema. 

 



 
 

 

TWO-PHASE FLOW VOID FRACTION ESTIMATION BASED ON BUBBLE 

SEGMENTATION AND DIMENSIONING USING NEURAL NETS AND 

MODIFIED RANDOMIZED HOUGH TRANSFORM  

Pedro Luiz Santos Serra 

ABSTRACT 

 

The International Atomic Energy Agency (IAEA) has been encouraging the 

use of passive cooling systems in new designs of nuclear power plants. Next nuclear 

reactor generations are intended to possess simpler and robust safety functions. Natural 

circulation based systems hold an undoubtedly prominent position among these. Natural 

circulation phenomenon occurrence depends only on the existence of refrigerant liquid 

temperature gradient in different sections of the plant refrigerator circuit. The study of limit 

conditions for these systems has led to instability behavior analysis where many different 

two-phase flow patterns are present. Void fraction is a key parameter in thermal transfer 

analysis of theses flow instability conditions. 

This works presents a new method to estimate void fraction from digital 

images captured at an experimental two-phase flow circuit. The method is primarily based 

on depth-of-field controlled image acquisition of a section of a closed loop of natural 

circulating water through cylindrical glass tubes. This loop is called Natural Circulation 

Facility (NCF) and is located at Nuclear and Engineering Research Institute in Brazil 

(IPEN/CNEN-SP). Image is segmented based on fuzzy inference of different segmentation 

parameters and adjusted to image acquisition focus. The image is then scanned in an 

inedited way using different-sized masks integrating a set of different artificial neural 

networks with a modified Randomized Hough Transform. Each different mask size is 

chosen in accordance to bubble sizes which are objects of interest. The bubble volume is 

estimated based on two-dimensional projection sizing based on digitally acquired images. 

Void fraction calculation takes into account the volume of the geometrical section of flow 

inside cylindrical glass tube considering used depth-of-field. It is also based on the 

summed bubble geometrical parameters inferred for each detected bubble. 

The results have shown that integration between artificial-neural-net sets and 

Randomized Hough Transforms increase system estimations robustness. 

 

 



 
 

 

 

SUMÁRIO 

 

   Página 

    

1 INTRODUÇÃO ........................................................................................ 10 

    

2 OBJETIVO ........................................................................................ 24 

    

3 REVISÃO BIBLIOGRÁFICA ............................................................... 26 

    

4 METODOLOGIA .................................................................................... 42 

4.1 Concepção e descrição do sistema .......................................................... 42 

4.1.1 Seleção da amostra do escoamento ........................................................ 44 

4.1.2 Cálculo do volume total das bolhas na amostra do escoamento ......... 47 

4.1.3 Cálculo da fração de vazio da amostra do escoamento ....................... 54 

4.2 Fundamentação teórica das principais aplicações .............................. 54 

4.2.1 Método fuzzy para a seleção da profundidade da 

imagem da amostra do escoamento 

 

..................................... 

 

54 

4.2.2 As redes neurais artificiais (RNA's) no 

processo de identificação das bolhas 

 

................................................ 

 

65 

 Configuração inicial da rede neural .......................................................... 72 

 Treinamento da rede neural ...................................................................... 74 

 Execução da rede neural .......................................................................... 77 

4.2.3 Identificação dos parâmetros geométricos 

das interfaces gás-líquido 

 

................................................ 

 

78 

4.2.4 Cálculo da fração de vazio da amostra do escoamento ....................... 87 

4.3 Calibração e ajustes do sistema computacional .................................. 91 

 Método gravimétrico para cálculo da fração de vazio ......................... 94 

4.4 Descrição do Circuito de Circulação Natural ....................................... 97 

    

5 RESULTADOS ........................................................................................ 101 

5.1 Condições gerais e de contorno dos experimentos .............................. 102 

5.2 Análise estatística dos perfís das bordas 

das bolhas (aplicação lapsob) 

 

................................................... 

 

103 

    



 
 

    

   Página 

    

5.3 Sistema de inferência focal fuzzy ............................................................ 109 

5.4 Ferramenta de seleção da amostra - selecTool ..................................... 112 

5.5 Ferramenta construtora das amostras de treinamento ....................... 114 

5.6 Configuração final do conjunto de redes neurais ................................ 119 

5.7 Eliminação das bolhas detectadas na amostra da 

imagem do escoamento e identificação geométrica 

via transformada randomizada de Hough (TRH) 

 

 

.............................. 

 

 

122 

 Identificação da bolha por votação - parte I ....................................... 123 

 Identificação do centro de outra 

elipse por votação - parte II e III 

 

.......................................................... 

 

124 

 Resultados da integração da transformada randomizada de 

Hough com outros algoritmos na detecção de bolhas em foco 

 

........... 

 

127 

5.8 Cálculo da estimativa da fração de vazio  132 

    

6 CONCLUSÕES ...................................................................................... 141 

    

 REFERÊNCIAS BIBLIOGRÁFICAS ................................................ 147 

    

 APÊNDICE A - Base de dados de 

imagens digitais do escoamento bifásico 

 

.............................................. 

 

153 

    

 APÊNDICE B - Análise estatística dos perfís de bordas .................... 158 

    

 APÊNDICE C – Código computacional 

das principais aplicações 

 

.............................................. 

 

163 

  



 

10 

 

 

 

 

1 INTRODUÇÃO 

 

A produção de energia elétrica a partir de fontes nucleares tem como princípio 

a conversão do calor liberado de reações nucleares em energia mecânica, responsável pela 

indução de energia elétrica. O fundamento desta forma de produção energética é a 

ocorrência de uma reação em cadeia controlada denominada fissão nuclear, obtida a partir 

da quebra de partículas de Urânio pelo bombardeamento de nêutrons, figura 1.  

 
FIGURA 1 - Representação da fissão nuclear 

FONTE:&amp;lt;http:// parquedaciencia.blogspot.com.br/2013/09/ 
fissao-ou-fusao-nuclear-qual-diferenca.html&gt; 

A quebra destas partículas resulta na liberação de outras partículas e de uma 

impressionante quantidade de energia sob a forma de calor, capaz de aquecer um fluido a 

temperaturas que permitem a geração de energia mecânica suficiente para a indução de 

energia elétrica com boa eficiência, TERREMOTO (2012). Tudo isto sem depositar um 

grama de gás carbônico na atmosfera. 

A figura 2 ilustra um diagrama esquemático de uma usina termonuclear ou, 

simplesmente usina nuclear, com um reator nuclear de potência refrigerado a água 

pressurizada (PWR- Pressurized Water Reactor). Nela pode-se identificar as principais 

partes integrantes deste tipo de usina.  



 

11 

 

 

F
IG

U
R

A
 2

 -
R

e
p
re

se
n
ta

ç
ã
o

 e
sq

u
e
m

á
ti

c
a
 d

a
 s

e
ç
ã
o
 t

ra
n
sv

e
rs

a
l 
d
e
 u

m
a
 p

la
n
ta

 n
u
c
le

a
r 

tí
p
ic

a
 d

e
 á

g
u
a
 p

re
ss

u
ri

z
a
d
a
 (
P

W
R

)

F
O

N
T

E
: 

“
S

y
st

e
m

s 
S

u
m

m
a
ry

o
f

a
 W

e
st

in
g

h
o

u
se

P
re

ss
u

ri
z
e
d

W
a
te

r
R

e
a
c
to

r
N

u
c
le

a
r 

P
o

w
e
r 

P
la

n
t”

C
o

p
y
ri

g
h

t 
1

9
7
1

, 
W

e
st

in
g

h
o

u
se

E
le

c
tr

ic
C

o
rp

o
ra

ti
o

n
”



 

12 

 

 

O núcleo do reator é a parte onde ocorre a fissão nuclear que é responsável pela 

geração de energia sob a forma de calor. Além do combustível (Urânio enriquecido), o 

núcleo do reator é preenchido com água como fluído refrigerante que constituí o circuito 

primário de refrigeração. A água é também empregada como moderador dos nêutrons 

resultantes da fissão nuclear neste tipo de reator. 

O processo de moderação consiste na redução da velocidade de propagação dos 

nêutrons a fim de possibilitar a ocorrência de novas reações pela sua incidência em outros 

núcleos de Urânio constituindo a reação em cadeia. Varetas de Cádmio ou Boro são 

empregadas para controle do fluxo de nêutrons no reator. Elas também são utilizadas para 

desligamento ("shutdown") do reator para sua manutenção ou devido a ocorrência de 

acidentes.  

O fluído refrigerante a alta pressão é bombeado ao longo do circuito primário 

para troca de calor com um circuito secundário, responsável pela produção do vapor para 

movimento das turbinas e consequente geração de energia elétrica. O núcleo do reator, 

circuito primário de refrigeração e parte do circuito secundário da usina estão confinados 

em uma blindagem especial denominada blindagem biológica, formada por uma espessa e 

compacta parede de concreto. 

Segundo a Agência Internacional de Energia Atômica - IAEA (CLEVELAND 

e CHOI, 2009) a energia produzida a partir de fontes nucleares representa 15% de toda 

energia elétrica produzida no mundo. Diversos países já incluem em sua política energética 

a introdução da energia nuclear ou o aumento de sua capacidade de geração. Para sua 

viabilização, diversas organizações e instituições investem na busca da simplificação dos 

modelos de plantas nucleares tendo como principal objetivo a redução de custo partindo do 

desenvolvimento e da implantação de sistemas mais simples, sem prejuízo de sua 

confiabilidade. A proposta de desenvolvimento e implantação de sistemas passivos de 

segurança aplicada a reatores refrigerados a água (WCR – “Water Cooled Reactors”) está 

em plena concordância com tais objetivos e foi indicada como um método desejável de 

simplificação e incremento da confiabilidade em funções essenciais de segurança em 

plantas nucleares (IAEA, 1991). A criação de um projeto de pesquisa coordenado 

("Coordinated Research Project - CRP") pela IAEA em 2004, intitulado Fenômeno de 

Circulação Natural, Modelamento e Confiabilidade de Sistemas Passivos de Segurança 

que Utilizam Circulação Natural ("Natural Circulation Phenomena, Modeling and 



 

13 

 

Reliability of Passive System that Utilize Natural Circulation") visa o estudo de sistemas 

passivos de segurança utilizando a circulação natural como um modelo econômico e 

seguro, aplicável em plantas nucleares. Tais indicações estão fundamentadas na eliminação 

dos custos de instalação, manutenção e operação dos sistemas ativos que requerem 

múltiplas bombas com geradores independentes e redundantes de energia elétrica.  

Uma representação esquemática de um modelo de resfriamento baseado nos 

princípios da circulação natural é ilustrada na figura 3. Dentre as principais situações para 

aplicação deste sistema releva-se a ocorrência de panes no sistema ativo de refrigeração, 

denominados “Loss of Collant Accident” - LOCA, resultando no desligamento da planta 

nuclear. 

 

 
FIGURA 3 - Esquema da aplicação de um circuito de refrigeração  

natural com um dissipador passivo de calor em uma planta nuclear. 

FONTE: CLEVELAND e CHOI (2009) 

CLEVELAND E CHOI (2009) evidenciaram ainda a criação, pela "CRP”, de 

um plano integrado de pesquisa com uma descrição de tarefas direcionadas, tais como:  

? estabelecimento do estado de arte em circulação natural; 

? identificação e descrição de sistemas de referência; 



 

14 

 

? identificação e caracterização dos fenômenos que influenciam a circulação 

natural; 

? exame da aplicação de dados e códigos para projetos e segurança e 

? exame da confiabilidade de sistemas passivos de segurança que utilizam 

circulação natural. 

Estas diretrizes requerem a realização de análises detalhadas com a finalidade 

de assegurar o desempenho destes sistemas sob as mais diversas condições. Extensos 

estudos e análises no sentido de avaliar valores que influenciam este desempenho são 

realizados com o propósito da obtenção de modelos representativos das condições e na 

descoberta e avaliação dos parâmetros relacionados ao fenômeno. 

KUMAR et al. (2015) revelaram que uma das consequências do acidente de 

Fukushima foi a realização de revisões detalhadas nas características de segurança das 

plantas nucleares mais recentes. Constataram, no projeto do reator avançado de água 

pesada (AHWR - Advanced Heavy Water Reactor) em desenvolvimento no Bhabha 

Atomic Research Center - India, a possibilidade da transferência de uma pequena fração do 

calor de decaimento total do sistema principal de transporte de calor  para o moderador por 

radiação. Isto levaria, em operações prolongadas de desligamento ("station black-out"), o 

aumento da temperatura e pressão do moderador. Para lidar com este problema mantendo 

as condições do moderador dentro dos limites de segurança por ao menos sete dias, um 

novo sistema passivo de segurança empregando circulação natural foi incorporado ao 

projeto do reator. 

Alguns reatores da geração atual fazem uso da circulação natural como 

fundamento para desenvolvimento de sistemas passivos de segurança empregados na 

remoção de calor em caso de desligamento do sistema (“shutdown”) para fins de 

manutenção, ou na ocorrência de falhas das bombas de circulação do sistema principal de 

refrigeração. Eles são aplicados em reatores de potência refrigerados a água (PWR) e a 

água pesada (PHWR), KUDARIYAWAR et al. (2016). A aplicação desses sistemas 

mostrou-se eficaz na remoção de até 20% da potência nominal do reator. 

KUDARIYAWAR et al. (2016) realizaram simulações empregando Fluido Dinâmica 

Computacional (CFD - Computer Fluid Dynamics) com o objetivo de geração de dados do 

campo de escoamento em diversas condições transientes em um circuito experimental de 

circulação natural. Tais dados seriam úteis no conhecimento completo da evolução do 

escoamento e dos campos de temperatura no circuito em situações que resultariam em 



 

15 

 

diversos tipos de instabilidades. A principal contribuição de seu trabalho foi a confirmação 

da teoria de transporte de "hot plugs" empregada para explanar os vários tipos de 

instabilidade (como pulsação unidirecional ou bi-direcional). A validação do modelo CFD  

foi realizada com dados obtidos de um circuito experimental de circulação natural. A 

instabilidade da circulação natural foi calculada e, em um primeiro instante, a relação entre  

o padrão de escoamento instável e o transporte de "plugs"  quente/frio foram estudados 

detalhadamente. KUDARIYAWAR et al. (2016) evidenciaram a abrangência de tais 

estudos visto que circuitos de refrigeração com circulação natural são utilizados em 

diversas outras aplicações de engenharia como, sistemas de aquecimento solar, 

resfriamento de motores de combustão interna, lâminas de turbina a gás, extração de 

potência geotérmica e sistemas de refrigeração de computadores. 

ZHANG et al. (2015) apresentaram estudos experimentais pela aplicação de 

um circuito de circulação natural para resfriamento do reator de pesquisa da universidade 

de Kyoto (KUR - Kyoto University Research Reactor) em condições térmicas de operação 

(10 a 100kW) e de desligamento ("shutdown"). Foram realizadas tomadas de temperatura 

em diversos pontos do circuito que é empregado para resfriamento do núcleo do reator. 

Também foram analisadas as velocidades do escoamento ao longo do núcleo do reator. 

ZANGH et al. (2015) constataram que as condições mais críticas para o circuito de 

circulação natural ocorreram na condição de operação de 100 kW, no entanto, consideradas 

dentro dos critérios de segurança estabelecidos para operação do reator. 

Ressalta-se que praticamente todas as análises e estudos sobre o 

comportamento do fluído em circuitos de circulação natural envolvem o desenvolvimento 

e a aplicação de diversos modelos teóricos, ou semi-empíricos,  aliados ao 

desenvolvimento de circuitos experimentais. Além das publicações já mencionadas 

GOUDARZI e TALEBI (2015) retrataram esta interação ao empregar um modelo 

matemático analítico de equações governantes da geração de entropia aplicado a diversas 

configurações geométricas e condições de operação de um circuito experimental de 

circulação natural. 

A circulação natural surge como consequência da ocorrência de forças 

direcionais (denominadas "driving forces") proveniente da variação da densidade do fluido 

em função do gradiente de temperatura em diferentes localizações de um circuito, 

(MESQUITA et al. 2009). Ela apresenta, em situações limites de transferência de calor, 

características particulares que incluem o escoamento bifásico com a presença de gás e 



 

16 

 

líquido. O padrão deste escoamento pode ser determinante na identificação destas situações 

e, por conseguinte, na eficiência de um circuito refrigerador concebido com base neste 

fenômeno natural. Tais padrões são normalmente classificados como: “em bolhas” 

("bubble flow"), pistonados ("plugs" ou "slugs"), agitados ("churn") e anulares 

(BARBOSA JR.,2012), figura 4. 

 

FIGURA 4 - Padrões de escoamento gás-líquido em tubos verticais segundo classificação 

apresentada por BARBOSA JR. (2012). FONTE: Elaborada pelo próprio autor / 

IMAGENS: CCN/CEN 

NAYAK, et al. (2007, p. 387) em seu estudo sobre estabilidade  em sistemas 

bifásicos de circulação natural, menciona que a taxa de escoamento é dependente do vazio 

gerado no sistema devido a adição de calor e perda de carga. Acrescenta ainda que 

estimativas precisas da fração de vazio, bem como a queda de pressão devido ao atrito 

(“frictional pressure drop”), são parâmetros chaves para predição do limiar de 

instabilidade.  

A fração de vazio consiste na relação entre o volume de gases e o volume total 

do escoamento (gases e líquido) e exerce grande influência sobre os limites de estabilidade 

do sistema. Trata-se de um parâmetro em destaque nos estudos relacionados ao 

comportamento do escoamento bifásico. Seu valor está presente na maioria das correlações 

que tratam deste comportamento assim como nos diversos parâmetros envolvidos com o 

regime de escoamento. Sua variação temporal é indicativa de situações de transição entre 

os regimes de escoamento e de condições de instabilidade. 



 

17 

 

 

SCHLEGEL et al. (2009) mencionam a inexistência de escoamento pistonado 

("slugs") em sistemas com escoamento bifásico com grandes diâmetros e os classifica nos 

tipos: "em bolhas", bolhas capilares ("cap-bubbles") e agitado ("churn"). Partindo de 

medições da fração de vazio em um circuito vertical e empregando uma função cumulativa 

de densidade de probabilidade (para fins de representação da variação temporal da fração 

de vazio) com um mapa auto-organizável de Kohonen obtém como resultado, o regime de 

escoamento no circuito. Eles associaram a fração de vazio e o regime de escoamento como 

os parâmetros principais na predição do escoamento. Vale ressaltar que 

SCHLEGEL et al. (2009) fizeram uso de um circuito com circulação forçada, ou seja, 

empregando bombas de centrifugação para circulação do fluído no circuito. Algumas de 

suas conclusões não devem ser estendidas para escoamentos bifásicos em circuitos com 

circulação natural. 

BARBOSA, CRIVELARO e SELEGHIM JR. (2010) também fizeram uso do 

Mapa Auto Organizável para identificação e classificação do escoamento bifásico em um 

complexo circuito experimental empregando circulação forçada, desenvolvido e localizado 

nas dependências do Laboratório de Engenharia Termo fluído da Universidade de São 

Paulo localizado no Campus de São Carlos (NETeF-USP). Os valores da fração de vazio, 

obtidos através de um sensor capacitivo, associado a queda e o gradiente de pressão 

extraídos do circuito foram empregados para treinamento, testes e aplicação do mapa 

auto-organizável. Os resultados representavam a classificação do escoamento no circuito 

experimental segundo seis tipos diferentes de regimes. 

SMITH et al. (2012) mencionam a ocorrência de uma fase transitória entre um 

escoamento com bolhas e um agitado. Ambos referenciam a fração de vazio como 

parâmetro essencial e identificador do regime de escoamento ao longo do circuito. 

Tais estudos estão concentrados na identificação e caracterização das formas 

possíveis de escoamento dentro de um sistema com circulação natural. 

A tecnologia empregada para aquisição das imagens de escoamento é 

dependente do tipo de sistema e do fluído utilizado. UCHIMURA et al. (1998) emprega 

um sistema de imageamento por radiografia de nêutrons em tempo real (RTNR - Real 

Time Neutron Radiography) na aquisição das imagens em um circuito de circulação 

natural que emprega metal líquido como refrigerante. SAITO et al. (2011) aplica esta 



 

18 

 

mesma tecnologia na visualização do escoamento em um circuito com escoamento bifásico 

empregando água como refrigerante. Esta tecnologia é empregada em circuitos com 

tubulação metálica. Ela consiste, basicamente, na exposição do escoamento a um feixe de 

nêutrons incidente sobre um anteparo (cintilador granular de nêutrons - LiF6Zns). A 

passagem do feixe de nêutrons térmicos por regiões com presença de gás no escoamento 

produzirá uma atenuação energética menor, resultando na geração de uma imagem com 

maior intensidade de luz resultante da reação do feixe de nêutrons com o cintilador 

posicionado atrás da tubulação com o escoamento. A imagem produzida pela reação desses 

feixes de nêutrons incidentes com o cintilador é capturada por uma câmera de alta 

resolução através de uma adequada combinação de lentes e espelhos, figura 5. 

 
FIGURA 5 - Representação esquemática do sistema de imageamento por radiografia de 

nêutrons. FONTE: SAITO et al.(2011) 

SUNDE, AVDIC e PÁZSIT (2005) apresentaram um método de identificação 

e classificação de escoamento bifásico também baseado em dados de imagens capturadas 

via imageamento por nêutrons. Eles empregaram um modelo que consiste na aplicação de 

redes neurais para classificação do tipo de escoamento a partir destas imagens. Elas foram 

pré-processadas utilizando o método de subtração de sombras e filtro Wavelet. Concluíram 

que o emprego de Wavelet pouco contribuiu na melhoria da precisão dos resultados, 

porém, resultou em um impacto positivo na fase de treinamento da rede neural.  



 

19 

 

Circuitos experimentais com tubulações de vidro permitem a extração das 

imagens pelo emprego direto de câmeras de alta resolução e definição. Esta tecnologia, 

conhecida por imageamento direto, visa o aumento da velocidade de exposição, resultando 

na melhoria da qualidade no processo de aquisição das imagens e a redução do custo na 

obtenção experimental de parâmetros de escoamento (por exemplo: regime e velocidade de 

escoamento, fração de vazio estática e temporal, etc.) sem o comprometimento da precisão 

dos resultados. Para tanto as mais diversas técnicas de reconhecimento de padrões em 

imagens são aplicadas com a finalidade de buscar um aprimoramento das análises 

subsequentes. 

 O modelo adotado por WANG e DONG (2009) tem como base a variação 

da escala de cinza (Gray Level Co-occurence Matrix – GLCM) e do gradiente (Gray Level 

Gradient Co-occurence Matrix – GLGCM) de imagens capturadas experimentalmente via 

imageamento direto, figuras 6 e 7. 

 
FIGURA 6 - Vista esquemática do experimento. 

FONTE: WANG e DONG (2009) 

WANG e DONG (2009) limitaram-se às informações baseadas em um método 

de extração de características relacionadas à textura das imagens (energia, homogeneidade, 



 

20 

 

entropia, protuberância, assimetria de cinza, inércia e média de graduação de cinza). A 

partir das matrizes de níveis de coocorrência de cinza (GLCM e GLGCM), das faixas de 

variação de tais características e da dinâmica do escoamento (velocidade do fluido e dos 

gases em função do tempo) foi possível o reconhecimento, com boa precisão, do tipo de 

escoamento bifásico dentro das quatro opções ilustradas e propostas pelo autor. 

 
FIGURA 7 - Imagens do escoamento bifásico (gás-líquido) 

FONTE: WANG e DONG (2009) 

WANG e DONG (2009) alegaram ainda que o emprego deste modelo pode 

permitir a medida da fração de volume de gás (fração de vazio) em circuitos experimentais 

horizontais. 

Existem muitas publicações voltadas à determinação do padrão de escoamento 

através de técnicas de reconhecimento de padrões aplicados a imagens de escoamento 

bifásico, cada qual empregando uma particularidade no sentido de obter resultados de 

forma mais eficiente, com redução de custo e com alta confiabilidade, 

DE MESQUITA et al.(2012), SUNDE, AVDIC e PÁZSIT (2005), WANG e 

DONG (2009), FICHERA et al.(2000) e CRIVELARO e SELEGHIM JR.(2002).  

 WOLDESEMAYAT e GHAJAR (2007) realizaram uma análise sobre 68 

correlações empíricas de fração de vazio baseadas em um conjunto imparcial  de dados 

(2845 pontos) cobrindo uma grande margem de parâmetros. Um total de 403 pontos foram 

selecionados da literatura e confrontados com quatro modelos de  correlações da fração de 

vazio consideradas as mais adequadas para aplicação em circuitos verticais. Embora a 

comparação dos resultados entre duas correlações específicas terem apresentado uma 



 

21 

 

diferença da ordem de 5%, os casos mais gerais e que continham a grande maioria dos 

dados pesquisados na literatura apresentavam erros da  ordem de ? 15%, figura 8. 

 
FIGURA 8 - Comparação entre a fração de vazio obtida das correlações e medidas para 

circuitos verticais. FONTE: WOLDESEMAYAT e GHAJAR (2007). 

A ocorrência dessas discrepâncias torna evidente a necessidade de interações 

cada vez mais frequentes no sentido de alimentar e municiar tanto os estudos teóricos para 

obtenção de modelos mais representativos e das mais diversas condições do modelo físico, 

como pela aquisição experimental dos parâmetros essenciais na elaboração e avaliação 

desses modelos. 

Novas propostas de métodos que fazem integração entre estes dois tipos de 

abordagem têm surgido em outras áreas de aplicação, como na área médica ou biológica. 

ELSALAMONY (2016) faz uso da integração de técnicas de processamento de 

imagens e algoritmos inteligentes para identificação e diagnóstico de anemia a partir de 

imagens digitais microscópicas de amostras (esfregaços) de sangue. Esta integração de 

diferentes técnicas está ilustrada na figura 9 tendo como primeira fase os processos de 

coloração das imagens das células sanguíneas, a aplicação de uma variante da 

transformada de Hough, denominada transformada circular de Hough (CHT - Circular 

Hough Transform) em conjunto com funções de segmentação para detecção e contagem de 



 

22 

 

células sanguíneas saudáveis ou não. A transformada circular de Hough é empregada na 

detecção das células vermelhas e sua contagem. 

A técnica "watershed" e um conjunto de funções morfológicas foram 

empregadas na melhoria das imagens e separação de células oclusas. Muitas operações são 

realizadas pela transformada circular de Hough como a identificação da polaridade da 

célula e estimativa dos centros das células nas imagens. Uma rede neural multicamada é 

aplicada para classificação do tipo de anemia permitindo um diagnóstico preciso e 

eficiente. 

 
FIGURA 9 - Principais fases do algoritmo. FONTE: ELSALAMONY (2016) 

A metodologia proposta por ELSALAMONY (2016) apresentou resultados 

satisfatórios na identificação e precisão dos diversos tipos de anemia. Seus resultados 

indicaram uma eficiência de 100%, 98%, 100% e 99,3% para identificação de quatro 

classes representativas dos tipos de formas anêmicas como: foice, eliptocitose, microcitose 

e nenhuma. 

Embora represente um menor custo, a obtenção da fração de vazio a partir de 

imagens extraídas experimentalmente resulta em imprecisões relacionadas às suas próprias 

características. 

A identificação dos fatores que contribuem para estas imprecisões aliada ao 

estudo e desenvolvimento de técnicas integradas de processamento de imagens e 

algoritmos inteligentes prestam uma importante contribuição na pesquisa atual envolvendo 

escoamentos bifásicos e, por conseguinte, a compreensão e entendimento do fenômeno da 

circulação natural e de todas as suas particularidades. 

Com base nos  estudos previamente apresentados constata-se que a pesquisa do 

comportamento dos padrões bifásicos em circulação natural necessita do desenvolvimento 

de modelos integrados envolvendo técnicas de processamento de imagem, técnicas 

experimentais de medida de parâmetros e técnicas de varredura iterativa.  



 

23 

 

Este trabalho surge dentro deste contexto, propondo o desenvolvimento de 

programas computacionais integrados para cálculo da fração de vazio volumétrica a partir 

de imagens digitais bidimensionais capturadas de circuitos experimentais. Estes algoritmos 

representam uma solução de parte importante do problema de obtenção confiável de 

parâmetros necessários para a compreensão, a mensuração e a consequente predição do 

escoamento bifásico e, por conseguinte, do próprio fenômeno da circulação natural. 

Os cálculos partem de uma amostra volumétrica do escoamento bifásico 

selecionada de uma imagem capturada por imageamento direto em um circuito 

experimental de vidro. Este processo utiliza inferência fuzzy para eliminação de pixels fora 

da profundidade de campo previamente selecionada nas câmeras de alta resolução 

utilizadas na aquisição. Executa-se, sobre esta amostra volumétrica de escoamento, um 

inédito processo de sucessivas varreduras integradas de redes neurais artificiais associadas 

à aplicação de um modelo modificado da transformada randomizada de Hough. Esta 

inédita metodologia, que utiliza esta sequência de operações, permite a inferência precisa 

da quantidade de gás na amostra volumétrica do escoamento no instante da captura da 

imagem, permitindo a determinação da razão entre este volume de gases e o da amostra do 

escoamento, parâmetro usualmente conhecido como fração de vazio volumétrico. 

Os modelos de cálculo tem como principal suporte a confiabilidade obtida pela 

integração entre os algoritmos inteligentes, as técnicas de segmentação e a transformada 

randomizada de Hough. Uma estimativa da precisão e confiabilidade da estimação é obtida 

pela comparação com resultados obtidos de experimentos específicos que fazem a medida 

direta deste parâmetro.  



 
24 

 

 

2 OBJETIVO 

 

O objetivo geral deste trabalho é o desenvolvimento de um sistema 

computacional para cálculo da fração de vazio a partir do imageamento direto do 

escoamento bifásico em circuitos de circulação natural. 

A composição de diversos modelos integrados com diferentes tecnologias são 

tratados como metas que visam a realização dos objetivos específicos conforme descrição 

abaixo:  

? o estabelecimento de dimensões de uma amostra tridimensional, ou 

volumétrica, da imagem do escoamento para minimização da distorção 

ótica devida à concavidade da tubulação do experimento; 

?  a associação da profundidade de campo selecionada na câmera de alta 

resolução na aquisição direta da imagem do escoamento a valores de 

parâmetros de segmentação associados ao foco da imagem; 

? o reconhecimento da imagem de cada uma das bolhas dentro das dimensões 

da amostra da imagem do escoamento e 

? a associação de circunferências ou elipses representadas analiticamente por 

seus parâmetros e propriedades com a forma das interfaces gás-líquido 

capturadas de bolhas em imagens digitais do escoamento bifásico de 

circuitos experimentais de circulação natural. 

Trata-se de uma pesquisa e desenvolvimento tecnológico necessário para suprir 

importante lacuna na pesquisa atual relativa à obtenção confiável, por imageamento, de 

parâmetros para modelamento de escoamento bifásico. Esta confiabilidade é aperfeiçoada 

pela integração de técnicas de processamento de imagens com algoritmos inteligentes. 

O ineditismo desta iniciativa está fundamentado nos seguintes itens: 

? o desenvolvimento de uma metodologia que associa os parâmetros de 

aquisição de imagem relativos à profundidade de campo (com foco pré-estabelecido) com 

os parâmetros de segmentação da imagem analisada, utilizando inferência fuzzy e métricas 

de foco; 



 
25 

? a utilização de um conjunto de redes neurais artificiais treinadas para 

subimagens com dimensões diferentes e de acordo com as buscadas dos objetos de 

interesse na imagem (neste trabalho, bolhas). Estas subimagens são geradas por uma 

varredura da imagem da amostra volumétrica do escoamento utilizando máscaras virtuais;  

? a integração deste conjunto de redes neurais com a transformada de Hough 

para a otimização e robustez na detecção e classificação dos objetos de interesse e  

? o refinamento da metodologia de votação na transformada randomizada de 

Hough (TRH) para incremento da robustez na identificação dos parâmetros geométricos 

das formas elípticas.    

O desenvolvimento do sistema computacional tem como objeto de aplicação o 

cálculo da fração de vazio de imagens digitais capturadas do Circuito de Circulação 

Natural (CCN) do Centro de Engenharia Nuclear do IPEN (DE MESQUITA et al., 2012) 

visando sua aplicação em futuras análises e estudos deste fenômeno. A aquisição das 

imagens do escoamento deste circuito experimental é realizada por imageamento direto. 

O ajuste e a calibração da metodologia de cálculo e das aplicações é baseado 

em uma bancada experimental de medida de fração de vazio via método gravimétrico. 



 

26 

 

 

3 REVISÃO BIBLIOGRÁFICA 

 

Em TERREMOTO (2012) é apresentado o processo de geração de energia 

elétrica a partir de fontes nucleares. Esta forma de geração está fundamentada na 

ocorrência de uma reação em cadeia controlada, denominada fissão nuclear. Ela consiste 

na quebra de partículas de Urânio pelo bombardeamento de nêutrons resultando na 

liberação de outras partículas e de uma impressionante quantidade de energia sob a forma 

de calor. Esta última capaz de aquecer um fluido a temperaturas que permitem a geração de 

energia mecânica suficiente para a indução de energia elétrica com boa eficiência. Trata-se 

de uma das principais fontes energéticas mundiais visto que, segundo CLEVELAND E 

CHOI (2009), representa 15% da geração da energia elétrica mundial.  

CLEVELAND E CHOI (2009) apresentaram um quadro resumido de diversos 

modelos de sistemas nucleares refrigerados a água que fazem uso da circulação natural 

como sistemas passivos de segurança. Eles mencionaram ainda que estudos para a 

simplificação dos futuros projetos de plantas nucleares são motivados pela Agência 

Internacional de Energia Atômica (AIEA) para implementação de novas tecnologias 

direcionadas à redução de custo sem o comprometimento da segurança. 

O impactante cenário do acidente de Fukushima conduziu a um emergente 

questionamento dos sistemas de segurança convencionais devido a sua dependência de 

componentes ativos. A composição desses dois fatores associado ao incentivo dado pela 

Agência Internacional de Energia Atômica para o desenvolvimento e implementação de 

projetos que fazem uso da circulação natural como sistema passivo de segurança 

induziram, segundo KUMAR et al. (2015), a necessidade de revisão dos mais recentes 

projetos e instalações de reatores nucleares. No projeto do Reator Avançado de Água 

Pesada (AHWR - "Advanced Heavy Water Reactor") em desenvolvimento no Bhabha 

Atomic Research Center, na Índia, KUMAR et al. (2015) constataram a possibilidade da 

transferência de uma pequena fração do decaimento de calor total do sistema principal de 

transporte de calor  para o moderador por radiação. Isto levaria, em operações prolongadas 

de desligamento ("station black-out"), ao aumento da temperatura e pressão do moderador. 

Para manter as condições do moderador dentro dos limites de segurança por ao menos sete 



 

27 

dias, um novo sistema passivo de segurança empregando a circulação natural foi 

incorporado ao projeto do reator. 

A aplicação de circuitos de circulação natural monofásicos surge como uma 

proposta viável para os futuros projetos de reatores nucleares a água pressurizada (PWR - 

Pressurized Water Reactor) e a água pesada pressurizada (PHWR - Pressurized Heavy 

Water Reactor). Elas seriam efetivas na remoção de até vinte por cento da potência 

nominal do núcleo em reatores a água pressurizada quando acionadas em casos de falhas 

de potência nas bombas de circulação. O emprego deste fenômeno não se restringe apenas 

à tecnologia nuclear. KUDARIYAWAR et al. (2016) relataram a aplicação da circulação 

natural em diversos outros segmentos da engenharia como aquecedores solares, 

resfriamento de transformadores, extração geotérmica de potência, resfriamento de 

motores de combustão interna, resfriamento de computadores e resfriamento de lâminas de 

turbinas em virtude da expressiva confiabilidade desses sistemas. Seus estudos foram 

baseados na utilização de um circuito experimental de circulação natural (NCL - Natural 

Circulation Loop) com quatro configurações representativas de diferentes tipos de reatores 

nucleares. Eles consistem em simulações de fases de transição do escoamento neste 

circuito pela aplicação da técnica de fluído dinâmica computacional em três dimensões (3D 

CFD - Tree Dimensional Computer Fluid Dynamics). O modelo é validado com os dados 

experimentais extraídos do circuito. Em um primeiro caso de cálculo de instabilidade no 

circuito foi estudada, em detalhes, a relação entre padrões de escoamento instáveis e o 

transporte de slugs frios/quentes.  

KUDARIYAWAR et al. (2016) mencionaram que projetos avançados, como o 

CAREM (Central Argentina de Elementos Modulares) consideram o emprego da 

circulação natural monofásico como um modo normal de resfriamento do núcleo do reator. 

Eles também demonstraram a necessidade de integração e confronto dos resultados obtidos 

por modelos teóricos com os extraídos de circuitos experimentais para análises deste 

fenômeno. Os resultados experimentais de seus estudos foram observados em um circuito 

de circulação natural retangular com quatro configurações diferentes, cada qual 

representativa de uma das formas de aplicação da circulação natural em sistemas nucleares. 

Ainda que experimentalmente, o emprego de reatores de pesquisa 

mostraram-se uma importante e realística ferramenta no estudo da circulação natural 

aplicada em sistemas de refrigeração. ZHANG et al. (2015) avaliaram a capacidade de 

refrigeração e segurança  a partir de investigações experimentais realizadas no Reator de 



 

28 

Pesquisa da Universidade de Kyoto (KUR - Kyoto University Research Reactor). O Reator 

de Pesquisa da Universidade de Kyoto consiste de um reator de pesquisa moderado a água 

com potência máxima possível de 5MW. Concluíram que a operação com circulação 

natural em potência térmica de 100 kW representou a condição mais severa de operação do 

reator. Nesta condição, todos os parâmetros estimados estavam dentro dos critérios de 

segurança do reator de pesquisa.  

ZHANG et al. (2015) mencionaram ainda que a circulação natural é efetiva  

para fins de remoção do calor do núcleo em operações de desligamento ("shutdown"). 

O principal objetivo dos circuitos de circulação natural é a obtenção simultânea 

de alta eficiência termodinâmica e operação estável. GOUDARZI e TALEBI (2015) 

mencionaram que o circuito de circulação natural rejeita passivamente calor das fontes 

para dissipadores de calor sem o emprego de bombas mecânicas. A ocorrência de 

instabilidades como, oscilação da pressão, potência removida, temperatura, taxa de fluxo 

de massa e densidade do fluído podem causar problemas na operações desses sistemas. 

GOUDARZI e TALEBI (2015) realizaram estudos para otimização dos parâmetros 

geométricos e condições operacionais em circuitos de circulação natural visando a 

minimização da geração de entropia resultando em um melhor desempenho e, 

consequentemente, maior eficiência do circuito. 

A instabilidade em circuitos experimentais de circulação natural se manifesta 

pela ocorrência mútua do escoamento bifásico (gás-líquido). O escoamento bifásico se 

estabelece segundo um padrão de classificação que foi apresentado por BARBOSA Jr. 

(2012) como: “em bolhas” ("bubble flow"), pistonados ("plugs" ou "slugs"), agitados 

("churn") e anulares.  MESQUITA et al. (2009) empregaram algoritmos inteligentes para 

aprimoramento na  detecção de bordas e reconhecimento de padrões  durante fases de 

transições nos regimes de escoamento a partir de imagens digitais capturadas do Circuito 

de Circulação Natural (CCN) desenvolvido e instalado no Centro de Engenharia Nuclear 

(CEN) nas dependências do Instituto de Pesquisas Energéticas e Nucleares (IPEN). Eles 

descrevem a circulação natural como um fenômeno natural resultante de forças direcionais 

que surgem da diferença de densidade do fluído devido ao gradiente de temperatura em 

pontos diferentes do circuito.  

BOURE et al. (1973) e RUPINI et al. (2014) afirmam que a instabilidade em 

escoamentos bifásicos pode ser avaliada a partir de uma complexa composição entre 

diversas variáveis. Destacam-se a variação da queda de pressão e do fluxo de massa do 



 

29 

escoamento, sendo que esta última pode ser estimada a partir de correlações envolvendo a 

fração de vazio.  

A instabilidade em sistemas de escoamento bifásico deve ser exaustivamente 

analisada em função da sua associação à perda de eficiência do circuito na remoção de 

calor. 

Segundo NAYAK et al.( 2007, p. 386 - 398), estimativas precisas da fração de 

vazio e da perda de pressão por atrito são parâmetros chaves para a predição de um limiar 

de instabilidade. Eles desenvolveram um modelo linearizado baseado no modelo de deriva 

de fluxo com quatro equações para estudo do efeito de diferentes modelos de escoamentos 

bifásicos como fator multiplicador bifásico de atrito, velocidade de deriva e do parâmetro 

de distribuição de vazio na estabilidade do escoamento em sistemas de circulação natural. 

Concluíram que o uso de modelos de escoamentos homogêneos para fator de fricção como 

para fração de vazio prevê uma grande taxa de escoamento de circulação natural 

comparado com outros modelos. Em circulação natural, a taxa de escoamento depende do 

vazio gerado no sistema devido a adição de calor e a perda de pressão no sistema. 

Os circuitos experimentais buscam a reprodução fiel do escoamento bifásico 

em todo o circuito projetado para implementação do sistema de refrigeração. Alguns 

modelos de circuito tem por finalidade a aquisição direta de imagens do escoamento por 

imageamento direto ou por imageamento por nêutrons para identificação, análise e estudos 

dos parâmetros que regem o escoamento em suas mais diversas configurações. Diversos 

outros parâmetros são mensuráveis nestes circuitos habilitando-os para ajustes, 

configuração e calibração de sistemas computacionais que são executados interativamente. 

A validação via confronto dos resultados obtidos por correlações teóricas e resultados 

experimentais bem como no aperfeiçoamento e atualização das correlações teóricas  já 

existentes, são também objetos de aplicação desses circuitos. 

SCHLEGEL et al. (2009) empregaram um modelo denominado medidor de 

vazio por impedância elétrica, que na realidade mede a admitância da mistura bifásica 

sobre uma área estabelecida de um complexo circuito experimental gerador de escoamento 

bifásico. As medições são armazenadas sob a forma de tensão de saída de um circuito 

medidor. A identificação do regime de escoamento é realizada pelo uso de um Mapa Auto-

Organizado de Kohonen (SOM - Self Organized Map) empregando a Função de Densidade 

de Probabilidade Acumulada (CPDF - Cumulative Probability Density Function) da área 

média  do sinal da fração de vazio, representada pela conversão do sinal de saída do 



 

30 

circuito medidor. Eles relacionaram a inexistência de escoamento pistonado ("slugs 

bubbles") a circuitos com tubulações com grandes diâmetros. Classificaram o escoamento 

bifásico nos tipos: "em bolhas", bolhas capilares ("cap-bubbles") e agitado ("churn") e 

atribuíram à fração de vazio e ao regime de escoamento como os dois parâmetros 

relevantes  para predição do escoamento.  

Um complexo sistema experimental foi apresentado por BARBOSA, 

CRIVELARO e SELEGHIM JR. (2010) que permite a simulação do escoamento bifásico 

gás-líquido e gás sólido. A aplicação de um modelo de rede neural, denominado mapa auto 

organizável, apresentaram resultados precisos na avaliação e análise do modelo gás-líquido  

do escoamento bifásico. Seus dados de entrada do escoamento são extraídos de  sensores 

posicionados ao longo do circuito experimental. 

SMITH et al. (2012) também fizeram uso do medidor de fração de vazio por 

impedância elétrica para validação e confronto dos resultados de seus estudos com a 

aplicação do modelo de dois fluídos para cálculo do comportamento do escoamento 

bifásico por tratar-se do modelo mais prático disponível, embora com certa complexidade 

no que diz respeito aos termos de transferência interfacial. 

O circuito experimental utilizado por SMITH et al. (2012) inclui uma seção de 

visualização do escoamento para imageamento direto empregando câmeras filmadoras com 

velocidade de 10000 quadros por segundo para captura das imagens aplicadas ao estudo do 

movimento das partículas no escoamento. Com o emprego da equação de transporte de 

área interfacial aliado aos resultados adquiridos experimentalmente, SMITH et al. (2012) 

confirmaram um critério para um regime de transição do escoamento para circuitos com 

tubulações com grandes diâmetros. Eles também identificaram as condições de entrada que 

podem induzir mudanças no padrão do escoamento. 

A potencialidade do imageamento por nêutrons foi constatada por SAITO et al. 

(2011)  na visualização do escoamento bifásico em tubulações metálicas a partir da 

implementação e instalação de um sistema de imageamento por nêutrons no buraco B4 do 

reator de pesquisa da universidade de Kyoto (KUR - Kyoto University Reactor). Eles 

apresentaram exemplos de imagens estáticas e dinâmicas do escoamento bifásico 

capturadas via imageamento por nêutrons. SAITO et  al. (2011) demonstraram que a 

tecnologia de imageamento por nêutrons permite a visualização de escoamentos em 

tubulações metálicas e são mais apropriados para aplicações em que o escoamento ocorre 

em sistemas com alta pressão.  



 

31 

UCHIMURA, et al. (1998) também fizeram uso do imageamento por nêutrons 

em tempo real (RTNR - Real Time Neutron Radiography) para visualização do escoamento 

bifásico (gás-líquido) em circuitos que empregam metal líquido. Seu principal objetivo foi 

a observação do movimento das bolhas em um escoamento bifásico em circuitos com 

metal líquido buscando extrair valores da fração de vazio e velocidade do escoamento.  

SUNDE, AVDIC e PÁZSIT (2005) fazem uso do imageamento por nêutrons 

em circuitos com tubulação metálica. Suas análises são baseadas na integração da 

transformada "Wavelet" (análise de multi resolução) com uma rede neural artificial e 

consistem na classificação do escoamento bifásico dentre os quatro tipos de regime 

conhecidos. Seus resultados mostraram-se bons na identificação dos regimes em bolhas e 

anular, porém confusos na identificação dos regimes "churn" e "slug" em função da 

ocorrência simultânea desses dois tipos de regimes de escoamento. 

Os estudos realizados por WANG e DONG (2009) partiram de imagens 

digitais capturadas por imageamento direto de um circuito experimental horizontal. Suas 

análises eram baseadas na construção de dois modelos matriciais (matriz de co-ocorrência 

de nível de cinza - GLCM e gradiente da matriz de co-ocorrência de nível de cinza - 

GLGCM) com base nas características de texturas das imagens. Eles constataram a 

existência de uma relação efetiva entre estas características com a razão de densidade 

gás-líquido do escoamento. Esta relação não ocorre quando se trata da velocidade 

superficial do gás ou do líquido. 

DE MESQUITA et al.(2012), KUDARIYAWAR et al.(2016), ZHANG 

et al.(2015), SCHLEGEL et al.(2009), SMITH et al.(2012), SAITO et al. (2011), 

UCHIMURA et al.(1998), SUNDE, AVDIC e PÁZSIT(2005), WANG e DONG(2009), 

FICHERA et al.(2000) e CRIVELARO e SELEGHIM JR.(2002) fizeram uso de circuitos 

experimentais para fins de reprodução dos modelos de escoamento em análise ou da 

similaridade do sistema a ser estudado com o projeto a ser implementado em modelos 

reais. O principal objetivo destes circuitos é sua representatividade para desenvolvimento 

de códigos matemáticos com a reprodução das principais características do escoamento 

permitindo sua predição em aplicações reais. A grande maioria dos estudos relatados 

mostraram uma convergência na identificação dos possíveis regimes de escoamento 

através das diversas técnicas apresentadas, muitos deles apontaram a fração de vazio como 

um dos principais parâmetros nesta predição e, consequentemente, na avaliação da 

estabilidade do sistema.  



 

32 

A fração de vazio é um dos parâmetros críticos e está diretamente envolvida na 

predição da perda de pressão e da transferência de calor em sistemas gás-líquido, relataram 

WOLDESEMAYAT e GHAJAR (2007). Eles realizaram uma análise comparativa de 

68 correlações de fração de vazio sobre um conjunto de dados, a partir da coleta e triagem 

de 2845 dados. Estas análises consideraram diferentes configurações de circuitos 

experimentais com diâmetro, ângulo de inclinação e regime de escoamento. Seus 

resultados mostraram discrepâncias de até 15% entre valores obtidos pela aplicação das 

correlações selecionadas e os resultados obtidos experimentalmente. Com isto fica 

evidente a necessidade de interações cada vez mais frequentes no sentido de alimentar e 

municiar tanto os estudos teóricos para obtenção de modelos mais representativos e das 

mais diversas condições do modelo físico, como pela aquisição experimental de 

parâmetros empregando as mais diversas tecnologias com o objetivo de assegurar 

medições dentro de precisões aceitáveis. 

Em imageamento direto as imagens do escoamento devem ser controladas, ou 

seja, os estudos são realizados a partir da seleção de uma parcela volumétrica do 

escoamento. Esta seleção deve ser criteriosa, a fim de minimizar considerações sobre os 

efeitos óticos causadores de distorções nas imagens, bem como na compatibilização entre a 

configuração do equipamento empregado para a captura das imagens digitais e de 

parâmetros de segmentação da imagem para determinação e controle da profundidade da 

amostra.  

KROTKOV (1987) elaborou um estudo para medição automática da qualidade 

do foco de uma imagem ("sharpness of focus") para formulação ou elaboração de uma 

métrica ou critério de "sharpness". O principal objetivo dos estudos de KROTKOV (1987) 

era de estabelecer um critério de distância de um objeto associado à qualidade do foco de 

uma imagem. Ele apresentou alguns modelos apropriados para estabelecimento do critério 

de "sharpness" associado à uma distância focal. O primeiro deles, denominado "Tenegrad" 

consiste na estimativa do gradiente da intensidade de cinza ? I(x,y) para cada ponto da 

imagem e somar todas as magnitudes maiores que um limiar. As derivadas parciais para 

composição do gradiente são obtidas pela aplicação do operador Sobel com a convolução 

de kernel. O segundo modelo trata da aplicação do operador Laplaciano, ?
2
I(x,y), 

associada a convolução de kernel para cada pixel da imagem. Um terceiro modelo foi a 

variância do nível de cinza da imagem onde ele associou altas variâncias de nível de cinza 



 

33 

a imagens com alta estrutura  "sharp", ou seja, imagens bem definidas e com alta qualidade 

de foco.  

O desenvolvimento de um modelo que associasse estes parâmetros à 

profundidade de campo de imagens digitais permitiria a seleção de amostra de escoamento 

com três dimensões e com profundidade controlada. Em função das pequenas variações 

ambientais passíveis de ocorrência em experimentos com captura de imagens digitais, os 

modelos de inferência Fuzzy mostram-se adequados à este tipo de aplicação. 

MENDEL (1995) apresenta um tutorial para construção de modelos nebulosos 

("fuzzy") aplicado a sistemas de engenharia. A compatibilização dos parâmetros sugeridos 

por KROTKOV (1987) para avaliação da qualidade de foco de imagens ("sharpness") 

segundo um modelo nebuloso e com base em uma análise estatística sobre imagens obtidas 

experimentalmente, sugere a inédita proposta de associação da profundidade de campo 

selecionada pela câmera de alta resolução empregada na captura de imagens digitais (ou 

distância focal) com um modelo lógico nebuloso que estabelece a qualidade de foco. 

A integração entre algoritmos inteligentes e técnicas de processamento de 

imagens digitais vem contribuindo cada vez mais com a robustez e eficiência de várias 

aplicações nas mais diversas áreas.  

DAVE e BHASWAN(1992) fazem uso da integração da lógica fuzzy com uma 

técnica de "clustering" para detecção parcial de formas. Concluíram que a eficiência de 

seus algoritmos na detecção de círculos e elipses tem desempenho comparado ao da 

transformada de Hough.  

HAN et al.(1994) emprega a lógica nebulosa, ou lógica "fuzzy", integrada com 

a transformada de Hough para fins de ajuste das formas segundo um modelo geométrico 

bem definido. 

SURAL e DAS (1999) fazem uso de um modelo denominado neuro-fuzzy no 

reconhecimento de caracteres em documentos digitalizados. Trata-se de um problema ótico 

de reconhecimento de caractere (OCR - Optical Character Recognition). As duas 

abordagens fundamentais para este problema são o reconhecimento de caracteres e 

"template matching" (comparação de modelos). Também mencionaram que o perceptron 

de múltiplas camadas ("MLP - Multi Layer Perceptron") e outras e outras redes neurais são 

frequentemente utilizadas no reconhecimento de caracteres após terem sido treinadas com 

um conjunto de padrões pelo treinamento supervisionado. 



 

34 

BASAK e PAL (2005) apresentam uma generalização da transformada de 

Hough clássica pela aplicação de um modelo "Fuzzy" (denominado transformada Fuzzy 

Hough, ou "FHT - Fuzzy Hough Transform" ) para fins de captura de figuras com formas 

descritas como imprecisas, mal definidas, ou até distorcidas. 

Este conjunto de citações sugerem que a integração entre algoritmos 

inteligentes com detectores de borda aliados à modelos de identificação e/ou associação de 

interfaces gás-líquido à figuras analiticamente definidas contribuiriam com uma maior 

robustez na identificação e mensuração da quantidade de gases em uma amostra 

volumétrica de escoamento bifásico.  

Na medicina, ELSALAMONY (2016) faz uso de um sistema integrado na 

apresentação de um algoritmo para diagnóstico da ocorrência de anemia a partir de 

imagens microscópicas de amostras sanguíneas. A identificação e contagem de células 

anêmicas é realizada por uma combinação de técnicas de identificação da forma da célula, 

empregando transformada circular de Hough, separação de células oclusas pelo emprego 

da técnica Watershead e contagem final e classificação das células doentes da amostra pelo 

emprego de uma rede neural alimentada adiante. Seu algoritmo apresentou resultados 

bastante promissores, da ordem de 97 a 100% de precisão ocasionando diagnósticos 

altamente precisos e eficientes. 

Seguindo um modelo mais adequado na integração de técnicas para detecção 

de bolhas em amostras volumétricas selecionadas de imagens digitais de escoamento 

bifásico optou-se, neste trabalho, por uma original integração entre redes neurais artificiais 

multicamadas (Multilayer Perceptrons) com um exclusivo modelo de votação 

implementado na transformada randomizada de Hough (TRH). A esta rede neural artificial 

é atribuída a função de identificação e seleção da imagem contendo uma única bolha. Esta 

imagem selecionada possui dimensões quadradas, ou seja largura e altura, 

aproximadamente iguais à duas vezes as dimensões dos semi-eixos maior e menor da 

bolha. 

HAYKIN (2001) menciona que as arquiteturas de redes neurais artificiais mais 

adequadas para aplicações com reconhecimento de padrões são os Perceptron de Múltiplas 

Camadas (MLP - Multilayer Perceptrons) e a rede de Função Base Radial (RBF). Ele 

define formalmente o reconhecimento de padrões como o processo pelo qual um 

padrão/sinal recebido é atribuído a uma classe dentre um número predeterminado de 

classes (categorias). 



 

35 

Justifica-se, portanto, a integração de um modelo de rede neural artificial 

multicamadas como um dos mais adequados ao reconhecimento de padrão dentre os 

estudados e apresentados por HAYKIN (2001). O emprego desta rede teria como proposta 

o reconhecimento de cada bolha em um processo inédito, iterativo e dinâmico de varredura 

sobre uma amostra volumétrica da imagem do escoamento bifásico. O cálculo do volume 

de gases de cada bolha requer o uso de um detector de borda que evidencie sua interface 

gás-líquido. 

BHARDWAJ e MITTAL (2012) apresentam uma comparação entre diversos 

detectores de borda para fins de identificação daquele que proporcionou melhor 

performance. Concluíram que a declividade modificada apresentou melhores resultados, 

inclusive quando comparados com o detector Canny até então considerado o mais 

promissor dentre os avaliados. 

MICHÉ e DEBRIE (1995) apresentam um novo operador de segmentação de 

imagens auto adaptativo para aplicações em tempo real. Ele é baseado em um modelo 

estendido de declividade para detecção de bordas em imagens com baixo contraste e sem 

qualquer pré-processamento. 

BUENO (2016) apresenta resultados promissores para o cálculo da fração de 

vazio de escoamentos bifásicos a partir de imagens digitais pela aplicação de um 

interessante modelo integrando lógica fuzzy e declividade na detecção de bordas. 

BENSHAIR, MICHÉ e DEBRIE (1996) fazem uso deste modelo de 

declividade em um modelo de programação dinâmica para aplicação em algoritmos de 

correspondência de visão binocular estéreo ("binocular stereo vision"), ou seja, a 

reconstituição de uma estrutura tridimensional a partir de um par de cenas tomadas de 

posições próximas. A opção pelo seu emprego deve-se ao melhor desempenho na 

varredura da imagem para detecção das bordas sem o comprometimento  da complexidade 

de tempo do algoritmo.  

A declividade tanto na sua versão básica, como na estendida, requer análise da 

intensidade de cinza de uma certa quantidade de pixels anterior, durante e posteriormente a 

formação da borda. Isto inviabiliza sua aplicação em imagens quadradas com dimensões 

aproximadas as das bolhas com que foram reconhecidas e selecionadas pela rede neural 

artificial. Estas dimensões foram estabelecidas visando evitar a extração dos parâmetros 

geométricos de duas ou mais bolhas próximas uma das outras considerando-as como uma 



 

36 

única bolha. Recomenda-se portanto, a aplicação do operador Canny  visto que, segundo 

BHARDWAJ e MITTAL (2012), é assumidamente uma segunda e eficiente opção para o 

processo de detecção de bordas. 

WENYING et al. (2008) apresentam um algoritmo de segmentação de imagem 

baseado em um modelo aperfeiçoado do operador Canny. Aplicado em escoamento 

bifásico em tubulação de pequenos diâmetros, WENYING et al. (2008) concluíram que o 

modelo desenvolvido é efetivo para análise e reconhecimento de bolhas em escoamentos 

multifásicos, no entanto o algoritmo necessita ser melhorado para obtenção de resultados 

melhores. 

A transformada de Hough tanto em sua aplicação convencional, como em seus 

modelos avançados, fazem uso das coordenadas dos "supostos" pixels das bordas das 

bolhas detectadas pela aplicação do operador Canny. Estas coordenadas seriam utilizadas 

na identificação dos parâmetros geométricos descritivos das figuras analíticas (elipses ou 

circunferências) que melhor se ajustem à este conjunto de pixels. 

A complexidade de tempo e espaço de algoritmos que aplicam a transformada 

de Hough em sua forma convencional cresce exponencialmente em função do acréscimo 

dos parâmetros considerados nas dimensões de uma matriz acumuladora. Esta última, 

representada pela variação de cada parâmetro geométrico da figura analítica a ser 

detectada. Um grande número de alternativas foram resultantes da busca de vários autores 

para a solução desta indesejável situação. Muitas delas foram eficazes na redução da 

complexidade de tempo e espaço, porém, pouco efetivas na robustez dos resultados. 

TSUJI e MATSUMOTO (1978) relataram que a aplicação direta da 

transformada de Hough para detecção de objetos elípticos em imagens digitalizadas requer 

uma matriz acumuladora de dimensão cinco para indexação de parâmetros especificando 

sua localização, forma e orientação. Seu uso torna-se impraticável em função do longo 

tempo computacional e grande necessidade de memória. Eles propuseram a ideia de 

contornar este problema a partir da avaliação de clusters em um espaço de parâmetros 

bidimensional e unidimensional empregando uma propriedade conhecida das elipses para 

seleção de um número menor de pontos candidatos à borda de uma elipse. Os cinco 

parâmetros que melhor ajustam a elipse a partir destes candidatos são avaliados pelo 

método dos mínimos quadrados. Suas conclusões e discussões foram realizadas sobre 

imagens digitalizadas e sintetizadas (com 128 x 128 pixels). Embora o algoritmo tivesse 



 

37 

apresentado resultados satisfatórios para estas condições identificaram a deficiência na 

detecção de elipses parcialmente obstruídas. 

BALLARD (1981) apresenta a transformada generalizada de Hough como uma 

composição de mapeamentos de formas simples para construção de mapeamentos de 

formas complexas. Ele associa esta propriedade da transformada generalizada de Hough a 

um tipo universal de transformada que pode ser usada para encontrar formas complexas. 

Embora não faça nenhuma menção à complexidade de tempo e espaço, ele propõe a 

realização de estudos para melhoria de desempenho de seu algoritmo. 

DAVIES (1987) apresenta um novo algoritmo, baseado na transformada de 

Hough, para detecção de objetos circulares em imagens digitais. Embora admita a boa 

robustez do algoritmo na supressão de imagens com ruído, DAVIES (1987) reconhece um 

melhor desempenho do modelo original da transformada de Hough em imagens com 

oclusões ou quebra de objetos superior a um quarto da circunferência de um objeto. 

NIXON (1989) apresenta uma versão estendida da transformada de Hough com 

a proposta de construção de um algoritmo mais eficiente em termos de tempo de execução 

e ocupação de memória que sua versão original. Seu algoritmo é baseado nas informações 

do gradiente residual nos pontos de intersecção local da forma verdadeira e da forma 

estimada do objeto para ajuste na imagem. Análises do resíduo entre a tangente local da 

forma e a direção prevista revelaram uma relação analítica para a discrepância na presente 

estimativa. Concluiu que a técnica estendida é não linear e nem sempre resulta em valores 

exatos para cada parâmetro. 

YUEN, ILLINGWORTH e KITTLER (1989) apresentaram uma alternativa 

para contornar os  problemas de armazenagem e desempenho da transformada de Hough 

em seu modelo original. Eles realizaram a decomposição da transformada de Hough em 

duas fases. O método mostrou-se eficiente em diversas situações tendo como relevância a 

detecção de elipses parcialmente oclusas. 

XU, OJA e KULTANEN (1990) propuseram um método que captura 

aleatoriamente "n" pixels e os mapeia sobre um ponto no espaço de parâmetros. Seus 

resultados mostraram um novo e efetivo método no que diz respeito a necessidade de 

espaço para armazenamento, velocidade de processamento e alta resolução. 

YIP, TAM e LEUNG (1992) indicam o emprego da transformada de Hough 

para extração das propriedades geométricas de figuras analíticas por se tratar  de uma 



 

38 

técnica reconhecidamente robusta para detecção de formas definidas analiticamente. Eles 

apresentaram um modelo modificado da transformada de Hough com a redução da 

necessidade de espaço de memória, sem o comprometimento de sua eficiência e robustez. 

Tal modelo está fundamentado na redução da matriz acumuladora para uma matriz 

bidimensional. 

XU e OJA (1993) expõe as vantagens da transformada randomizada de Hough 

em relação a original e suas variantes. Eles apresentam detalhadamente os fundamentos da 

transformada randomizada de Hough demonstrando, com base em conceitos teóricos e 

experimentais, as vantagens desta promissora técnica de extração de características de 

formas geométricas. 

YOO e ISHWAR(1993) apresentam uma variação da transformada de Hough 

para detecção de formas elípticas baseadas na definição polar e de polos das cônicas. A 

principal vantagem desta definição é evitar a propagação dos erros  na estimação de 

parâmetros sobre os sucessivos estágios da transformada de Hough original. O método 

proposto mostrou ser preciso, mesmo com reduzido número de pares de pontos, permitindo 

a detecção de elipses oclusas e concêntricas com precisão. 

MCLAUGHLIN (1998) descreve um algoritmo para detecção de formas 

elípticas com base na transformada randomizada de Hough. Seu método é comparado com 

três outros métodos , também baseados na transformada de Hough. O modelo apresentado 

por MCLAUGHLIN(1998) mostrou-se mais preciso na redução do número de pontos das 

imagens originais e detecção de falsas elipses. 

INVERSO (2002) apresenta em seu algoritmo uma particularização da 

transformada randomizada de Hough para detecção de elipses com ângulos com semi-eixo 

maior ortogonal e paralelo ao eixo das abscissas. Evidencia que o maior desgaste no 

desenvolvimento de seu projeto foi na derivação das equações da elipse. Segundo 

INVERSO (2002) a transformada randomizada de Hough não reduz significantemente o 

tempo de processamento e os requisitos de memória necessários para captura das elipses. 

YU, LIU e HE (2008) apresentam uma variação da transformada randomizada 

de Hough empregando um ponto de controle de cônicas e um vínculo entre as normais nos 

pontos finais das cordas da elipse. Isto tem como consequência uma grande  redução da 

amostragem e acumulação. Outro fator de grande importância é o emprego de um modelo 

empregando lógica fuzzy para seleção entre as diversas elipses candidatas que surgem 



 

39 

devido ao reduzido número de pontos nas bordas detectadas nas imagens. A aplicação da 

lógica fuzzy tem como base o uso do "status" de distribuição dos pontos da borda da elipse 

candidata em relação a área do polígono inscrito. Este modelo está fundamentado na visão 

perceptual de agrupamento. Isto contribui para a confiança nos resultados extraídos e, 

portanto, na precisão do cálculo da fração de vazio. 

CHENG, GUO e ZHANG (2009) desenvolveram um interessante algoritmo 

com integração da transformada randomizada de Hough com um algoritmo genético para 

seleção aleatória dos pares de pontos mais promissores selecionados a partir de uma função 

de ajuste. Concluíram um melhor desempenho do algoritmo na detecção de curvas claras e 

com ruídos. 

ZHANG, JIANG E LIU (2012) mencionaram que a injeção de gás acima de 

1%  em circuitos verticais simuladores de escoamento bifásico resulta na ocorrência de 

bolhas oclusas na ordem de 40%. Existem dois reconhecidos métodos para tratar com 

bolhas oclusas em imagens digitais e estimativas da distribuição do tamanho das bolhas 

(BSD - Bubble Size Distribution). O método apresentado é baseado em dois passos 

fundamentais. O primeiro deles, denominado segmentação de contorno, assume que 

"pontos côncavos" em uma sequência dominante de pontos estão sempre conectados.  O 

agrupamento de segmentos, segundo passo, é principalmente baseado no critério do desvio 

da distância média entre a curva ajustada e uma dimensão correspondente, por exemplo, 

uma estimativa da área da figura correspondente. Segundo os autores, os resultados 

mostraram-se bastante precisos quando comparado com outros dois métodos, porém, pode-

se avaliar ainda a ocorrência de falsas estimativas em função do agrupamento de duas 

bolhas como se fossem uma única. 

TENG, KIM e KANG (2012) apresentam uma metodologia baseada na 

transformada randomizada de Hough com aperfeiçoamento no esquema de votação. Os 

cinco parâmetros da elipse são votados separadamente em dois passos: o primeiro voto é 

para identificação das coordenadas do centro e o segundo é para os demais parâmetros 

(comprimento do semi-eixo maior e semi-eixo menor e ângulo entre o semi-eixo maior e o 

eixo das abscissas. A principal contribuição de TENG, KIM e KANG (2012)  consiste na 

análise da variação dos ângulos das linhas tangentes nos pontos da borda para 

diferenciá-los entre ruído e pontos do padrão da elipse e a derivação das equações para 

extração dos cinco parâmetros da elipse por um esquema de votação em dois níveis. Seus 

resultados mostraram-se bastante promissores no que diz respeito ao desempenho do 



 

40 

algoritmo e sua precisão mesmo em casos de imagens com objetos elípticos parcialmente 

representados. 

MUKHOPADHYAY e CHAUDHURI (2015) apresentam uma síntese dos 

últimos cinquenta e um anos de pesquisa e desenvolvimento da transformada de Hough e 

se surpreenderam em relação ao ainda grande número de atualizações desta metodologia 

nos últimos cinco anos. Mencionam a existência de escopo para desenvolvimento da 

transformada de Hough com os mais diversos objetivos como, velocidade, precisão e 

resolução especialmente na detecção parcial de formas e perspectivamente curvas 

complexas e distorcidas bi e tri dimensionais. 

STROKINA et al. (2016) apresentaram uma metodologia para detecção de 

bolhas circulares concêntricas empregando a transformada circular de Hough. Eles 

relataram a ocorrência da formação de bolhas em dispersões de óleo e relacionaram a 

formação de círculos concêntricos à ocorrência de uma grande quantidade de efeitos óticos 

distintos como reflexão, refração, interferência e outros. Embora satisfatórios, seus 

resultados apresentaram um erro relativo médio de 28% no volume de gás em uma 

aplicação industrial de bomba de suspensão. 

RICCA, BELTRAMETTI e MASSONE (2016) apresentaram minuciosamente 

todos os fundamentos matemáticos da transformada de Hough como sua principal 

ferramenta para identificação de imagens com simetria. O alvo de aplicação desta 

tecnologia é a identificação de anomalias em imagens médicas, mais especificamente, 

tomografia computadorizada por raio X. 

O emprego da transformada randomizada de Hough (TRH) mostra-se uma 

eficiente ferramenta no desenvolvimento de aplicações para identificação dos parâmetros 

geométricos de figuras que melhor se ajustem às bordas de interesse das bolhas (interface 

gás-líquido) reconhecidas na amostra volumétrica da imagem do escoamento através da 

seleção pela rede neural artificial multicamada e alimentada adiante (Feedforward 

Multilayer Perceptron). Este modelo apresenta-se como o mais adequado para aplicação 

em imagens com poucas bolhas conforme avaliação de MC LAUGHLIN (2002). Sua 

integração com a rede neural artificial em um processo dinâmico de sucessivas varreduras 

da amostra volumétrica da imagem digital do escoamento bifásico representa um processo 

original na pesquisa e desenvolvimento de ferramentas aplicadas aos estudos do 

escoamento bifásico. A meta desta parte do processo é o cálculo do volume de gás em uma 

amostra volumétrica selecionada de uma imagem digital de escoamento bifásico. A razão 



 

41 

entre este volume de gás e o da amostra resulta na estimativa da fração de vazio que, 

baseada em um conjunto de ajustes, medições e confrontos com resultados experimentais, 

permitem a estimativa deste parâmetro para todo um circuito de circulação natural. 



 

42 

 

 

4  METODOLOGIA 

 

4.1  Concepção e descrição do sistema 

O sistema computacional foi concebido para operar em três fases distintas 

recebendo as imagens digitais do escoamento capturadas de um circuito experimental 

como principal entrada. Informações adicionais sobre o experimento como a resolução da 

câmera utilizada na captura das imagens, seu posicionamento em relação ao circuito, o 

diâmetro e o comprimento da secção do tubo de vidro do circuito experimental enquadrado 

pela câmera são necessárias para calibração, ajuste e configuração final do sistema. 

A concepção do sistema computacional para cálculo da fração de vazio é 

representada pelas fases de operação apresentadas na figura 10. Elas são ilustradas pelos 

blocos no centro da figura. As entradas de cada fase estão à esquerda de cada bloco e suas 

respectivas saídas, à direita. Cada fase foi concebida em função de seu objetivo específico. 

A primeira delas consiste na seleção de uma amostra do escoamento bifásico e recebe 

como entrada uma imagem digital obtida de seção da tubulação do circuito experimental. 

A imagem é capturada com a câmera posicionada de modo a utilizar todo o sensor ótico, 

alinhando a maior dimensão do sensor com a maior seção longitudinal capturada do tubo 

cilíndrico. O sentido do escoamento é da direita para a esquerda nas imagens representadas 

neste trabalho. Este sentido corresponde ao escoamento ascendente no circuito 

experimental. O sistema realiza a conversão da imagem, originalmente colorida, em escala 

de cinza normalizada com posterior rotação de noventa graus no sentido horário. A seleção 

das dimensões da amostra do escoamento considera a ocorrência de distorções devido aos 

efeitos óticos na aquisição da imagem e compatibilização da profundidade de campo 

selecionada na câmera com seu foco. Na fase seguinte, a amostra do escoamento será 

sucessivamente varrida por máscaras virtuais para reconhecimento das bolhas no 

escoamento e cálculo do volume de cada uma delas. O somatório desses volumes atribuído 

a uma variável acumuladora representa, ao final desta segunda fase, o volume total de gás 

contido dentro dos limites da amostra. A terceira e última fase do sistema calcula a razão 

entre o volume de gases e o volume total da amostra resultando na estimativa da fração de 

vazio da amostra da imagem capturada do escoamento bifásico.A partir de uma adequada 

calibração, pode-se assumir o resultado desta saída do sistema como uma medida extensiva 



 

43 

da fração de vazio média relativa a todo o volume de interesse do circuito experimental. 

Este conjunto de algoritmos são integrados visando a obtenção de uma estimativa da fração 

de vazio local após calibração e comparação com a medida direta, supondo que a amostra  

seja representativa de um grau de homogeneidade deste parâmetro de escoamento ao longo 

do circuito. 

 

Im
a

g
e

n
s 

d
e

 E
n

tr
a

d
a

S
is

te
m

a
 F

u
zz

y
 

d
e

 In
fe

rê
n

ci
a

(p
ro

fu
n

d
id

a
d

e
)

C
á

lc
u

lo
 d

o
 v

o
lu

m
e

 t
o

ta
l d

a
s 

b
o

lh
a

s 
n

a
 a

m
o

st
ra

 d
o

 
e

sc
o

a
m

e
n

to

R
e

d
e

s 
N

e
u

ra
is

 
A

rt
if

ic
ia

is
? ? ?

? ? ?

? ? ?

#
 Id

e
n

ti
fi

ca
çã

o
 d

o
s 

p
a

râ
m

e
tr

o
s 

g
e

o
m

é
tr

ic
o

s 
d

e
 c

a
d

a
 b

o
lh

a
#

 C
á

lc
u

lo
 d

o
 v

o
lu

m
e

 d
e

 c
a

d
a

 b
o

lh
a

Tr
a

n
sf

o
rm

a
d

a
 

R
a

n
d

o
m

iz
a

d
a

 d
e

 
H

o
u

g
h

S
e

le
çã

o
 d

a
 a

m
o

st
ra

 d
o

 e
sc

o
a

m
e

n
to

 
b

if
á

si
co

.

D
is

to
rç

õ
e

s 
 

ó
ti

ca
s

(d
im

e
n

sõ
e

s 
su

p
e

rf
ic

ia
is

)

#
 R

e
co

n
h

e
ci

m
e

n
to

 
d

e
 u

m
a

 b
o

lh
a

 n
a

 s
u

b
 

im
a

g
e

m

#
 C

á
lc

u
lo

 d
o

 v
o

lu
m

e
 t

o
ta

l d
e

 g
a

se
s 

n
a

 a
m

o
st

ra
 d

o
 

e
sc

o
a

m
e

n
to

 =
 ?

vo
lu

m
e

 d
e

 c
a

d
a

 b
o

lh
a

 d
e

te
ct

a
d

a

C
á

lc
u

lo
 d

a
 f

ra
çã

o
 d

e
 v

a
zi

o
 d

a
 a

m
o

st
ra

 v
o

lu
m

é
tr

ic
a

 d
o

 
e

sc
o

a
m

e
n

to
 b

if
á

si
co

?

F
IG

U
R

A
  
1

0
 –

D
ia

g
ra

m
a
 r
e
p

re
se

n
ta

ti
v

o
 d

a
s 

fa
se

s 
d

o
 s

is
te

m
a
.



 

44 

4.1.1 Seleção da amostra do escoamento 

Trata-se da primeira fase do sistema e consiste na execução de uma sequência 

de operações digitais sobre a imagem do escoamento finalizando na seleção de uma  

amostra da imagem do escoamento capturada do circuito experimental, figura 11.  

 
FIGURA 11 - Exemplo de uma imagem digital capturada do circuito gerador de 

escoamento bifásico. ARQUIVO: IMG_0805.JPG 

FONTE: Bancada de calibração da fração de vazio - CEN/IPEN. 

Inicialmente a imagem é convertida para uma representação em escala de 

cinzas normalizada, ou seja, com variação na intensidade de grau de cinza entre zero 

(preto) e um (branco). Além de estabelecer uma normalização para todas as imagens, a 

conversão em níveis de cinza torna o desenvolvimento e a execução das demais aplicações 

mais simples e econômicas em termos de ocupação de memória e tempo de processamento.  

As dimensões frontais da amostra visam a minimização da inclusão na amostra 

da imagem de partes dela que incluem distorções da imagem devidas aos efeitos óticos que 

ocorrem. O principal deles está relacionado ao desvio dos feixes de luz advindos da 

amostra em direção à câmera fotográfica ocasionado pela refração por duas interfaces, a 

primeira entre a água e o vidro do tubo e a segunda entre o vidro do tubo e o ar. Alguns 

estudos sobre o foco na aquisição de imagens neste tipo de experimentos foram publicados 

recentemente pelo grupo do CEN que estuda o CCN (MASOTTI E DE MESQUITA 2015, 

p. 175-205) que descrevem parte do problema das distorções causadas por este fenômeno 

em tubos cilíndricos de vidro. 



 

45 

Outros efeitos óticos podem ser observados que estão relacionados à reflexão 

interna da luz e à interferência entre feixes advindos destas reflexões internas e feixes 

advindos do exterior do tubo. Eles estão diretamente relacionados a formação de sombras 

sobre as interfaces gás/líquido dificultando sua identificação. 

A profundidade da amostra é obtida por uma inovadora aplicação envolvendo 

um modelo fuzzy de inferência para mapeamento da profundidade de campo selecionada na 

câmera aos parâmetros de segmentação de imagens, indicados por KROTKOV (1987) 

como representativos do seu foco. A aplicação deste modelo sobre cada pixel da imagem 

realiza este mapeamento fundamentado na combinação desses três parâmetros: 

? a intensidade de cinza normalizada; 

? a soma da intensidade negativa de cinza, ou seja, do inverso da intensidade 

de cinza, "1-I(x,y)", ao operador Sobel. Este último representando a primeira 

derivada da variação da intensidade de cinza do pixel. Esta composição é 

normalizada de forma a ajustar seus valores ao domínio [0,1] e 

? adição da intensidade negativa de cinza com o resultado da aplicação do 

operador Laplaciano. Este último representando a segunda derivada sobre a 

variação da intensidade de cinza. Esta composição também é normalizada 

para fins de ajuste dos seus valores no domínio [0,1]. 

A associação da intensidade negativa de cinza aos operadores Sobel e 

Laplaciano normalizados, para cada pixel da imagem, tem o propósito de relacionar este 

parâmetro a uma função crescente em concordância a como normalmente são apresentados 

os valores dos operadores Sobel e Laplaciano. O modelo da inferência focal fuzzy aplicado 

sobre uma imagem do escoamento está esquematizado na figura 12.  

As entradas do modelo de inferência fuzzy são extraídas da imagem após sua 

conversão em intensidade de cinza normalizada, rotação de noventa graus no sentido anti-

horário e seleção das dimensões frontais conforme os critérios adotados para limitação da 

percepção dos efeitos de distorção ótica. Após este processo são aplicados os operadores 

Sobel e Laplaciano sobre cada pixel desta imagem resultando em mais duas novas 

imagens, também normalizadas, com as mesmas dimensões da original. Realiza-se a soma 

da imagem com intensidade negativa de cinza normalizada à estas duas resultantes, 

compondo assim a entradas do modelo fuzzy. A aplicação do modelo de inferência focal 

fuzzy se faz sobre cada pixel nas mesmas posições dessas imagens. Eles são "fuzzificados" 



 

46 

segundo funções de pertinência previamente elaboradas e com base em um estudo sobre as 

bordas das bolhas consideradas "em foco" e "fora de foco" apresentado no apêndice A. 

 
FIGURA 12 - Representação esquemática da fase de seleção da amostra sobre uma 

imagem digital do escoamento bifásico 

Após a inferência das regras sobre estas variáveis e aplicação do processo de 

"defuzzificação", os pixels "em foco" são preservados com seus valores de intensidade 

negativa de cinza normalizados. Os pixels "fora de foco" são eliminados por serem 

considerados fora da profundidade de campo selecionada na câmera utilizada no 

experimento. Assim como as funções de pertinência do processo de "fuzzificação" as 

empregadas na "defuzzificação" consideram a associação dos resultados do experimento de 

medida direta da fração de vazio comparando com a profundidade de campo utilizada na 

aquisição.A profundidade de campo utilizada na aquisição da imagem é aferida segundo 

uma escala de nível posicionada na lateral da tubulação do circuito experimental.  

Este modelo de inferência focal fuzzy tem como fundamento a aplicação de 

lógica matemática voltada a aplicações envolvendo variações de seus elementos e que 

podem produzir resultados dentro de certa faixa de variações predeterminadas. Estas faixas 

de variação são viabilizadas por variáveis linguísticas, que contém uma descrição intuitiva 

e prática do conceito envolvido em cada variável. Estes modelos são conhecidos como 

lógica fuzzy ou lógica nebulosa. A iniciativa de desenvolver um modelo empregando esta 

? Conversão em escala de 
cinza normalizada

? Rotação de 90º no sentido 
anti-horário

? Seleção das dimensões 
frontais/superficiais

Extração e composição das 
características da amostra
? Intensidade negativa de cinza

? Intensidade negativa de cinza + Sobel
? Intensidade negativa de cinza + Laplaciano

Entrada

Saída
Sistema de Inferência Focal Fuzzy 

Varredura das 
matrizes/imagens

(pixel por pixel)

Fuzzificação

InferênciaRegras

Defuzzificação

V

F



 

47 

tecnologia deve-se a possibilidade da variação dos parâmetros de segmentação da imagem 

como consequência das variações na luminosidade do ambiente em que os experimentos 

são realizados. A estrutura de um sistema fuzzy de inferência, seus processos, elementos e 

sua fundamentação, são apresentados em detalhes na seção 4.2.1. 

 A figura 13 ilustra um modelo representativo de todas as métricas 

mencionadas e utilizadas para o estabelecimento das dimensões frontais e de profundidade 

da amostra do escoamento bifásico. O volume desta amostra representa um importante 

valor para o cálculo da estimativa final da fração de vazio. 

 
FIGURA 13 - Representação esquemática das métricas adotadas  

para definição da amostra do escoamento bifásico 

 

4.1.2 Cálculo do volume total das bolhas na amostra do escoamento 

Esta segunda fase do sistema recebe a amostra da imagem do escoamento 

como entrada que doravante será denominada amostra do escoamento ou simplesmente 

amostra. Trata-se da imagem resultante da execução da primeira fase do sistema que é 

considerada ser representativa do escoamento bifásico ao longo do circuito experimental 

no instante de sua captura. O somatório do volume estimado de todas as bolhas nos limites 

desta amostra deverá representar o volume total de gás dentro das suas dimensões e trata-se 

de um importante parâmetro para o cálculo da fração de vazio.  



 

48 

O cálculo do volume de cada bolha é realizado mediante sua detecção (ou 

reconhecimento) e na identificação dos parâmetros geométricos da figura analítica (elipse 

ou circunferência) que melhor se ajusta à borda externa (interface gás/líquido) da projeção 

ortogonal da elipse bidimensional capturada na imagem fotográfica. Este volume supõe 

que a elipse bidimensional represente sua projeção com seus eixos maior e menor paralelos 

ao plano do sensor da câmera. Supõe-se ainda que as bolhas com projeção elíptica sejam 

homogêneas e regulares. Também fica implícito a ocorrência de erros nos casos em que 

bolhas elípticas que projetem uma circunferência no sensor. A descrição do cálculo 

simplificado está contida na seção 4.2.4.  O volume de cada bolha detectada é adicionado a 

uma variável acumuladora que tem seu valor atualizado sempre que uma nova bolha é 

detectada. A imagem da bolha é eliminada da amostra após a execução desta sequência de 

procedimentos. A variável acumuladora conterá, ao final da detecção de todas as bolhas, a 

estimativa do volume total de gases da amostra.  

Esta metodologia é original em todas as suas características pois envolve o 

emprego de máscaras virtuais para convolução da imagem da amostra. Estas máscaras 

quadradas, ou seja, com altura e largura iguais, iniciam o processo com dimensões 

equivalentes às das menores bolhas observadas em todas as imagens de escoamento. Elas 

varrem toda a imagem da amostra do escoamento pixel por pixel. Ao finalizar a varredura 

da amostra, a dimensão da máscara é aumentada para início de uma nova varredura. Este 

processo se repete até a dimensão da máscara atingir valores equivalentes aos das maiores 

bolhas observadas no escoamento. As máscaras virtuais operam como selecionadoras de 

subimagens. Elas são deslocadas sobre a imagem da amostra do escoamento fazendo a 

seleção de subimagens de acordo com suas dimensões. Este deslocamento ocorre pixel a 

pixel, ou seja, coluna por coluna e linha por linha. Em cada seleção é executada uma rede 

neural artificial previamente configurada e treinada para as dimensões da máscara virtual. 

Ela tem a finalidade de reconhecimento da imagem de uma bolha dentro dos limites da 

máscara virtual, ou subimagem. Caso não seja identificada nenhuma bolha, a máscara 

virtual é deslocada de um pixel segundo a metodologia adotada para a varredura da 

amostra e inicia um novo processo para a detecção de uma bolha sobre uma nova 

subimagem. Na ocorrência do reconhecimento de uma bolha na subimagem, executa-se um 

processo para associação da figura geométrica formada pela borda da bolha a uma definida 

analiticamente podendo ser uma elipse ou circunferência (caso especial de uma elipse com 

semieixos maior e menor iguais). Este processo foi desenvolvido com base na 



 

49 

transformada randomizada de Hough (RHT - Randomized Hough Transform) que tem 

como principal fundamento a associação de figuras geométricas analiticamente bem 

definidas a conjuntos de pontos selecionados aleatoriamente e, no caso deste trabalho, 

supostamente localizados nas bordas das bolhas em imagens digitais.  

Uma vez associada as propriedades geométricas de uma figura analítica aos 

pixels que descrevem sua borda (pixels de borda), é realizado o cálculo do volume da 

bolha adicionando este valor em uma variável acumuladora do volume de todas as bolhas 

anteriormente detectadas. Após a atualização desta variável, a bolha é eliminada da 

amostra da imagem de escoamento para evitar uma segunda identificação em outra 

varredura com uma máscara virtual com dimensões maiores. A máscara virtual é então 

deslocada de um pixel segundo a metodologia de varredura estabelecida dando 

continuidade ao processo. 

A figura 14 retrata este conjunto de processos e nela descreve-se o 

procedimento inédito e original da varredura da imagem de cada amostra de escoamento 

empregando com a aplicação integrada de máscaras virtuais com uma rede neural artificial 

com múltiplas camadas e alimentada adiante ("Feedforward Multilayer Perceptron") para 

detecção das bolhas em conjunto com a utilização da transformada randomizada de Hough 

(TRH). Este procedimento visa a extração das propriedades geométricas da figura analítica 

que melhor se ajuste à borda externa de cada bolha detectada. Esta borda é considerada 

como representativa da interface gás-líquido do escoamento. Ainda que necessária para a 

realização dos cálculos, esta integração assegura uma maior precisão e consequente 

"robustez" ao cálculo geral do volume total das bolhas visto que: 

? as bordas de falsas bolhas detectadas ("falsos positivos") pela rede neural, dificilmente 

serão consistentes a ponto de serem associadas a uma figura analítica pela TRH; 

? a TRH somente associará os supostos pixels de borda da imagem à uma bolha se, pelo 

menos, 55% deles pertencerem a uma elipse ou circunferência definida analiticamente 

dentro das dimensões da máscara de varredura. Esta consideração torna-se muito útil 

para a avaliação mais precisa da ocorrência de bolhas quando estão localizadas em uma 

região do tubo que está no limiar da profundidade de campo da aquisição da imagem ou 

da ocorrência daquelas bolhas que estejam parcialmente oclusas e 

? o acréscimo gradual nas dimensões da máscara de varredura visando a detecção de uma 

única bolha na subimagem evita a associação de duas figuras analíticas próximas a uma 



 

50 

única forma na imagem (uma das principais possíveis fontes de erros pela utilização da 

TRH ), devido à proximidade de seus pixels. 

 
FIGURA 14 - Representação esquemática do cálculo do volume total  

das bolhas na amostra de escoamento 

Máscara de
varredura

Identificação dos 
parâmetros 

geométricos da 
interface da bolha

(xc ,yc ,a , b, ? )

Transformada 
Randomizada de 

Hough

Cálculo do 
volume da bolha

Atualização da 
variável 

acumuladora de 
volume (?)

Exclusão da bolha da 
amostra da imagem

Incremento nas 
dimensões da 

máscara de 
Varredura

? Nova Varredura

Identificação da bolha na imagem 
da amostra do escoamento.

Rede 
Neural 

Artificial ??
?

?
?
?

?
?
?

Identificação 
da bolha 

V

F

Final da 
varredura 

da 
amostra

V

F

Deslocar a 
máscara sobre a 

imagem da 
amostra de 

escoamento
Dimensão 
máxima da 

máscara

F

Início

V

Volume total 
das bolhas na 

amostra de 
escoamento

Fim Amostragem progressiva 
do escoamento



 

51 

Redes Neurais Artificiais (RNA) são algoritmos inteligentes com arquitetura 

inspirada no modelo biológico de funcionamento do cérebro. Elas são constituídas por uma 

rede interligada de elementos de processamento chamados de neurônios artificiais. Esta 

rede em geral é organizada em colunas destes elementos que são chamadas de camadas de 

neurônios artificiais (podem ser camadas de entrada, escondidas e de saída). As camadas 

de entrada são as que recebem os sinais sensoriais, no caso, a intensidade dos pixels da 

subimagem selecionada pela máscara virtual. O número de elementos da camada de 

entrada da rede neural artificial multicamadas (RNA) é definida em função da dimensão da 

subimagem, ou seja, pela altura e largura da máscara de varredura. Ela consiste no total de 

pixels tanto da máscara de varredura como na sub imagem correspondente. Estes 

algoritmos RNA serão melhor descritos na seção 4.2.2. 

O número de elementos da camada de entrada da rede neural artificial 

multicamadas (RNA), neste trabalho, é definido em função da dimensão da subimagem, ou 

seja, pela altura e largura da máscara de varredura. Ela consiste no total de pixels tanto da 

máscara de varredura como da sua correspondente subimagem. A saída da RNA é um 

vetor com dois elementos e para um resultado positivo este vetor deverá ter o valor do seu 

primeiro elemento igual a um ("1") e do segundo igual a zero ("0"). Qualquer outra 

combinação dos valores dos elementos desse vetor representará uma saída "negativa" e isto 

significa a ausência de bolhas na subimagem. O número inicial de elementos da camada de 

entrada da RNA é de 901, correspondente a uma subimagem de 30 por 30 pixels 

vetorizada, ou seja, com as colunas da matriz 30 x 30 da subimagem rearranjadas 

sequencialmente e pela introdução de um primeiro elemento com valor igual a um ("1"), 

representando uma entrada correspondente ao elemento independente da RNA para fins de 

padronização do seu modelo de cálculo. O valor de 30 pixels representa o diâmetro de uma 

bolha circular ou comprimento máximo do maior eixo de uma bolha elíptica a ser 

detectada. Este valor é estabelecido em consequência de análises quantitativas sobre um 

conjunto significativo de imagens de amostras de escoamento tendo como principal 

restrição a não detecção de duas bolhas, mesmo que parcialmente oclusas.  

Após a varredura de uma amostra de imagem a dimensão da máscara de 

varredura é aumentada seguindo estas mesmas restrições para início de uma nova 

varredura. Uma nova camada de entrada será acrescentada a esta rede neural e o conjunto 

de pesos sinápticos serão substituídos por outro, correspondente a esta nova configuração. 

Este processo iterativo se repetirá até as dimensões da máscara de varredura atingir valores 



 

52 

correspondentes aos das maiores bolhas observadas nestas 100 imagens de amostra de 

escoamento. 

O treinamento da RNA é realizado de forma iterativa e tem como elemento de 

entrada um conjunto de amostras "rotuladas", também conhecido como amostras de 

treinamento. Trata-se de um arquivo contendo um grande número de subimagens 

vetorizadas e suas saídas correspondentes. Este arquivo de treinamento, é construído 

manualmente pela seleção de diversas amostras "positivas" e "negativas". São consideradas  

"positivas" as amostras que: 

? apresentarem apenas uma única bolha completa inscrita em suas dimensões; 

? todos os seus pixels de borda terem ao menos um pixel vazio de espaço 

vazio entre os limites da máscara virtual de varredura e 

? apenas um dos limites da máscara virtual de varredura poderá conter pixels 

de borda de bolhas inscritas. 

As subimagens "negativas" são caracterizadas: 

? pela ausência de bolhas completas nos limites da máscara virtual de 

varredura podendo conter apenas; 

? bolhas que contenham pixels de borda ocupando mais de uma das linhas 

limitantes da máscara de varredura; 

?  partes de bolhas eliminadas por varreduras anteriores; 

? bolhas incompletas, mesmo que nos limites da máscara virtual de 

varredura e 

? bolhas parcialmente fora dos limites da amostra de escoamento. 

Estas últimas restrições são impostas devido a possibilidade de seleção errada 

de bolhas com dimensões maiores que a própria máscara virtual de varredura. A seleção 

das amostras de treinamento é realizada sobre cada uma das imagens da amostra de 

escoamento bifásico. São selecionadas cerca de quatro a cinco mil amostras para 

construção de um arquivo de treinamento correspondente às dimensões de uma única 

máscara de varredura.  

O treinamento de cada rede neural utiliza a minimização de uma função de 

custo e de suas variações em relação aos pesos sinápticos para a correspondente 

configuração da RNA.    O resultado de cada treinamento é um conjunto de pesos 

sinápticos associado às configurações da RNA para cada dimensão de máscara de 



 

53 

varredura, figura 15. Este conjunto de pesos sinápticos representam a base de 

conhecimento da RNA e é implementado sempre que a rede for executada para 

reconhecimento de uma bolha dentro dos limites de uma subimagem. 

 
FIGURA 15 - Treinamento de redes neurais com amostragem progressiva. 

Arquivo contendo as 
amostras de 
treinamento

Imagens de amostras de 
escoamento

seleção  progressiva de 
sub imagens para 

construção do arquivo 
de treinamento com as 
dimensões da máscara 

de treinamento

Treinamento da Rede 
Neural Artificial pelo 

método de propagação 
reversa 

(“backpropagation”)

Pesos 
sinápticos de 
acordo com a 
configuração 

da RNA.

Execução da RNA para 
detecção das bolhas nas 
amostras das imagens de 

entrada

?
?
?

?
?
?

?
?
?

x0 = +1

x2

x1

x3

xm

x4

a0
(1) = +1

a0
(2) = +1

y1
y2

?
?
?

?
?
?

?
?
?

?
?
?

x0 = +1

x2

x1

x3 x0 = +1

xm

x4

a0
(1) = +1

a0
(2) = +1

y1
y2

Aumento nas 
dimensões da 

máscara de 
varredura para 
construção de 

um novo arquivo 
de treinamento. 

Introdução de uma nova 
camada de entrada na 
RNA para adequação 

com as novas dimensões 
da máscara de varredura

Eliminação das imagens das bolhas 
detectadas



 

54 

4.1.3 Cálculo da fração de vazio da amostra do escoamento 

As fases anteriores fornecem os valores suficientes para o cálculo da fração de 

vazio considerando as condições de escoamento no instante em que a imagem da amostra 

foi capturada. Da primeira fase tem-se a seleção de uma amostra de escoamento e seu 

volume corresponde à representação proporcional do volume total de gases e líquido no 

circuito. O resultado da segunda fase representa o volume total de gases (ar ou vapor 

d'água)  nas dimensões da amostra selecionada no instante da captura da imagem. A fração 

de vazio pode ser estimada pela razão entre estes dois valores e é calculada pela expressão: 

líquido)  (gases escoamento deamostra da   totalVolume

amostra na  gases de  totalVolume

?
??          (4.1) 

 

4.2 Fundamentação teórica das principais aplicações 

As fases de seleção da amostra do escoamento e do cálculo do volume de gases 

na amostra contém diversas inovações baseadas em processos de segmentação de imagens, 

algoritmos inteligentes, modelos para extração de propriedades geométricas de figuras 

analíticas em imagens digitais, além de processos dinâmicos de varredura de imagens.   

A essência na seleção da amostra é o mapeamento da imagem via composição 

de parâmetros de segmentação segundo um modelo de lógica fuzzy. Este modelo, 

doravante denominado sistema de inferência focal fuzzy faz uso de um modelo que procura 

relacionar o foco de uma imagem com a profundidade de campo em que ela fora capturada. 

O cálculo do volume de gases em uma amostra de imagem de escoamento 

envolve aplicações com redes neurais artificiais integradas com um modelo aprimorado da 

transformada randomizada de Hough. Este processo integrado evolui sobre a amostra da 

imagem do escoamento segundo um processo de varredura empregando máscaras virtuais 

para seleção de subimagens com dimensões progressivas. 

 

4.2.1 Método fuzzy para seleção da profundidade na imagem da amostra de 

 escoamento 

A fase de seleção da amostra sobre a imagem capturada por imageamento 

direto tem o propósito de estabelecer as dimensões de uma amostra volumétrica do 

escoamento e evidenciando as imagens das bolhas dentro destes limites. Não se trata de 



 

55 

uma mera melhoria da qualidade da imagem e sim na evidenciação das bolhas dentro dos 

limites de uma amostra volumétrica do escoamento com dimensões controladas. 

A imagem original colorida do escoamento bifásico é capturada de uma secção 

da tubulação de vidro do circuito experimental por uma câmera de alta resolução 

posicionada de modo a alinhar o maior do lado do sensor retangular da câmera com a 

maior extensão (vertical) da seção retangular fotografada da tubulação do circuito. No 

sistema, a imagem é rotacionada de 90
o
 no sentido horário. Posteriormente ela é convertida 

para uma imagem normalizada para seus níveis de intensidades de cinza, ou seja, com 

domínio [0,1]. Esta imagem será utilizada como base para cálculo dos parâmetros 

indicados por KROTKOV (1987) na análise da qualidade do foco dos pixels da imagem. 

Ela é posteriormente convertida em intensidade negativa de cinza normalizada e também é 

empregada na composição final dos parâmetros para análise de foco. A imagem negativa 

de intensidade de cinza normalizada apresenta a propriedade de representação dos pixels 

das bordas das fases gasosas com intensidade próxima de branco (valores próximos de um 

como intensidade de cinza). Algumas avaliações preliminares apresentadas por NG (2011) 

constataram uma melhor resposta da rede neural na detecção de padrões com estas 

propriedades. 

O estabelecimento das dimensões da vista frontal da imagem tem o objetivo de 

seleção da amostra em regiões em que as distorções óticas, ocasionadas pela refração 

devido à lente formada pelo tubo de vidro cilíndrico, sejam minimizadas. Estudos para 

avaliação e mensuração do desvio dos feixes de luz em virtude do efeito de refração da luz, 

principal fenômeno ótico responsável pelas distorções das imagens apontam para um 

ângulo de visão da largura da amostra inferior à 10
o
 . Este ângulo pode ser representado 

como o ângulo do vértice do triângulo formado pelo centro da lente da câmera e as 

referências laterais esquerda e direita da vista frontal da amostra. Estabelece-se, portanto, 

uma amostra com forma quadrada e dimensões correspondentes à 50% do diâmetro interno 

da tubulação de vidro na seção de captura das imagens do experimento. O centro da 

amostra coincide com o eixo longitudinal da tubulação e suas medidas correspondentes. 

Estes valores estarão sujeitos a avaliação durante o processo de calibração e ajuste do 

sistema em função dos valores medidos experimentalmente e dos resultados obtidos 

através da execução do sistema. 

A profundidade da amostra é definida em função de algumas propriedades 

relacionadas à qualidade do foco da imagem em conjunto com a profundidade de campo 



 

56 

ajustada na câmera no momento da aquisição da imagem e suas possíveis variações. Para 

isto optou-se pela composição de três parâmetros representativos da qualidade do foco da 

imagem de acordo com o modelo apresentado por KROTKOV(1987) e combinados, 

segundo um modelo fuzzy de inferência (MENDEL, 1995), para melhor lidar com as 

variações do comportamento destes parâmetros causados por possíveis mudanças das 

condições de aquisição da imagem ao longo do experimento.  

Um sistema fuzzy de inferência consiste em um sistema de modelagem lógica 

que estima o valor de veracidade de suas sentenças numa faixa contínua de valores entre 0 

e 1. Assim há a criação de uma máquina de inferência em que um conjunto de sentenças 

lógicas são avaliadas a partir de funções que podem também conter variáveis linguísticas 

que também assumem valores intermediários entre 0 e 1. Ele utiliza como base a teoria de 

conjuntos clássica e faz uma extensão desta teoria, incluindo elementos que podem 

pertencer parcialmente a mais de um conjunto. Assim os elementos podem pertencer 

simultaneamente a dois conjuntos diferentes no mesmo universo. Podemos dizer que os 

universos de elementos precisos (também denominados universos "crisp") podem ser casos 

especiais dos universos de conjuntos nebulosos (também conhecidos por "fuzzy").  

Segundo MENDEL (1995) um sistema de lógica fuzzy ("FLS - Fuzzy Logic 

System") é um mapeamento de um vetor de dados de entrada (características precisas crisp) 

em um vetor de dados de saída escalar crisp intermediados por uma inferência que usa 

sentenças de variáveis nebulosas (“fuzzy”). Uma das maiores vantagens da utilização da 

lógica fuzzy é a possibilidade de se construir um grande número de possíveis mapeamentos 

entre as variáveis tradicionais na engenharia e em outras áreas. Outra vantagem é a 

simplificação do modelamento computacional destes mapeamentos já que possibilita a 

utilização de variáveis com variáveis linguísticas que incorporam faixas de valores crisp 

em sua máquina de inferência. 

A figura 16 ilustra um diagrama de blocos de um sistema de lógica fuzzy, nela 

estão apresentados os principais elementos deste sistema. 

A entrada do sistema consiste em um vetor contendo valores das características 

relevantes para a inferência. Estes valores são denominados como valores precisos ou 

"crisp". No caso da amostra da imagem  do escoamento bifásico estas  características 

foram escolhidas para o fim de identificação da quantificação do foco de cada pixel. 

Assim, através do sistema, infere-se se o pixel está em foco ou não, baseado em métodos 

sugeridos por KROTKOV (1987). Os elementos constituintes deste vetor de entrada 



 

57 

passam por um processo inicial de "fuzzificação" que consiste na associação dos seus 

valores a funções de pertinências (funções que mensuram o quanto o valor de entrada 

pertence a um valor linguístico da variável fuzzy) com resultados no intervalo [0,1].  

 
FIGURA 16 - Sistema de Lógica Fuzzy 

FONTE: MENDEL (1995) 

As funções de pertinência são em geral construídas considerando avaliações do 

especialista quanto ao grau de inserção de cada variável crisp aos conjuntos nebulosos 

(fuzzy) utilizados para a construção da máquina de inferência. Neste trabalho elas  foram 

avaliadas segundo  diferentes propriedades do pixel que se quer avaliar para inferir se está 

ou não no foco.  

Os parâmetros indicados por KROTKOV (1987) e empregados como variáveis 

de entrada do sistema de inferência fuzzy foram: 

? a intensidade de cinza normalizada, ),( yxI : valores baixos da intensidade de cinza 

normalizada, próximos de zero, indicam pixels de imagens em foco. A posterior 

conversão desta imagem em intensidade negativa de cinza normalizada presta-se a 

associação de uma função crescente a este parâmetro, tal qual os demais parâmetros 

considerados na análise; 

? operador Sobel, ),( yxS : representa a primeira derivada direcional da intensidade de 

cinza do pixel. Estes valores identificam um valor ascendente ou descendente da 

intensidade de cinza. Esta propriedade é uma evidência da ocorrência de uma borda 

na imagem e 

? operador Laplaciano, ),( yxL : consiste na segunda derivada da intensidade de cinza. 

Ele representa uma rápida variação na intensidade de cinza, característica 

apropriada para detecção de bordas. Deve-se tratar com cautela os resultados deste 

parâmetro. Eles podem representar a ocorrência de ruídos na imagem.  

Regras

Inferência

Fuzzificador Defuzzificador

Entradas
Precisas
(“Crisp”)

x ? U

Conjuntos de

entrada Fuzzy

u ? U v ? V

Conjuntos de

saída Fuzzy

Saídas
Precisas
(“Crisp”)

y = f(x)? V



 

58 

 

KROTKOV (1987) relata que este conjunto de parâmetros com a definição de 

limiares apropriados podem estabelecer um padrão de qualidade de cada pixel da imagem 

que, para este trabalho, poderia identifica-lo dentro de uma profundidade de campo.  

A estimativa do gradiente para cada pixel é, segundo KROTKOV(1987): 

 22),(
yx

IIyxI ???      (4.1) 

Emprega-se o operador Sobel como convolução de kernel sobre cada pixel da 

imagem: 

?
?
?

?

?

?
?
?

?

?

???
?
?

?

?

?
?
?

?

?

?

?

?

?
?

121

000

121

4

1

101

202

101

4

1
yx

ii      (4.2) 

O cálculo da magnitude do gradiente é dado por: 

 ? ? ? ?
22

),(),(),( yxIiyxIiyxS
yx

??     (4.3) 

O Laplaciano é representado pela derivada segunda da intensidade de cinza e é 

considerado, segundo KROTKOV (1987), como uma técnica de passagem das altas 

frequências espaciais. Ele é expresso por: 

 
2

2

2

2

2
),(

y

I

x

I
yxI

?

?
?

?

?
??      (4.4) 

Seu cálculo aproximado é realizado pela aplicação da máscara de convolução 

de kernel: 

),(.

141

4204

141

.
6

1
),( yxIyxL

?
?
?

?

?

?
?
?

?

?

??                      (4.5) 

 

Os valores da intensidade de cinza tratados isoladamente aliados aos valores da 

intensidade negativa de cinza em conjunto com os resultados da aplicação dos operadores 

Sobel e Laplaciano sobre cada pixel da amostra da imagem compuseram o vetor de entrada 

do denominado sistema de inferência focal fuzzy. O resultado da sua aplicação sobre cada 

pixel da imagem teve como objetivo a classificação deste pixel como dentro ou fora da 

profundidade de campo da amostra volumétrica do escoamento bifásico.  



 

59 

Para a construção das funções de pertinência foram consideradas a intensidade 

de cinza, ),( yxI e a composição da intensidade negativa de cinza, ),(1 yxI? , com os demais 

operadores Sobel, ? ? ),(),(1 yxSyxI ?? e Laplaciano, ? ? ),(),(1 yxLyxI ?? . Considerou-se estes 

parâmetros como representativos para a classificação dos pixels das bordas das bolhas 

como "em foco" e "fora de foco".   Os valores para a construção das funções de pertinência 

foram obtidos de análises estatísticas sobre um conjunto de perfis de bordas de bolhas "em 

foco" e "fora de foco" capturadas de amostras de imagens do escoamento bifásico. O 

resultado dessas análises representa os valores médios e limitantes dessas propriedades e 

de suas composições. A figura 17 apresenta o modelo construído para a função de 

pertinência de intensidade de cinza. Nela são representados os valores de pertinência de 

perfis extraídos das imagens das bordas de bolhas "em foco" e "fora de foco". Os valores 

da intensidade de cinza para perfis de bordas de bolhas "em foco" são próximos de zero 

(coloração escura ou preta)  e possuem o valor médio considerado na figura como sendo a 

média da intensidade de cinza dos pixels que compõe o perfil da borda. O valor máximo de 

"bordas em foco" será considerado a média dos perfis adicionada de um desvio padrão da 

média. As mesmas considerações são feitas para perfis de bordas "fora de foco" tendo 

como valor mínimo, a média subtraída do desvio padrão.  

 
FIGURA 17 - Modelo de função de pertinência 

Pertinência de Intensidade de cinza 

As equações (4.6) e (4.7) consistem em expressões gerais para cálculo da 

média m  de uma variável m  qualquer e do seu correspondente desvio padrão ?, 

respectivamente: 

n

m

m

n

i

i?
?? 1           (4.6) 

I(x,y)

? [I(x,y)]

0

1
Bordas em foco Bordas fora de foco



 

60 

? ?

1

1

2

?

?

?
?
?

n

mm
n

i

i

?      (4.7) 

O valor de "n" corresponde ao número de pixels do perfil de cada borda de 

uma bolha "em foco" ou "fora de foco" selecionada na imagem do escoamento e o valor de 

i
m  corresponde ao valor do parâmetro em análise referente ao pixel "i". 

As figuras 18 e 19 ilustram os demais parâmetros considerados nas análises. 

Nelas são consideradas as composições da Intensidade negativa de cinza com o resultado 

da aplicação dos operadores Sobel e Laplaciano.  

 
FIGURA 18 - Modelo de função de pertinência 

Pertinência de Intensidade negativa de cinza + Sobel 

 
FIGURA 19 - Modelo de função de pertinência 

Pertinência de Intensidade negativa de cinza + Laplaciano 

As variáveis descritas nas funções de pertinência apresentadas nas figuras 17, 

18 e 19 consistem em: 

? ?),( yxI?  função de pertinência para o valor de intensidade de cinza de um 

pixel da imagem da amostra do escoamento; 

ffI _  média da intensidade de cinza de perfis de bolhas fora de foco. Valor 

resultante da análise estatística sobre uma amostragem de perfis de 

bolhas fora de foco; 

[1-I(x,y)]+S(x,y)

? [1-I(x,y) ]+S(x,y)

0

1
Bordas em focoBordas fora de foco

feS _??feS _ffS _ ??ffS _

[1-I(x,y)]+L(x,y)

? [1-I(x,y) ]+L(x,y)

0

1
Bordas em focoBordas fora de foco

ff
L

_
??

fe
L

_
??

ff
L

_ fe
L

_



 

61 

feI _  média da intensidade de cinza de perfis de bolhas em foco.Valor 

resultante da análise estatística sobre uma amostragem de perfis de 

bolhas em foco; 

??ffI _  limite inferior da intensidade de cinza de bolhas fora de foco, 

correspondente ao valor médio da intensidade de cinza subtraída do 

valor de um desvio padrão da média. Valores resultantes da análise 

estatística sobre uma amostragem de perfis de bordas de bolhas fora 

de foco; 

??feI _  limite superior da intensidade de cinza de bolhas em foco, 

correspondente ao valor médio da intensidade de cinza adicionada do 

valor de um desvio padrão da média. Valores resultantes da análise 

estatística sobre uma amostragem de perfis de bordas de bolhas em 

foco;  

? ? ),(),(1 yxSyxI ???  função de pertinência para o valor da intensidade negativa de cinza 

adicionada ao resultado do operador Sobel de um pixel da imagem 

da amostra do escoamento bifásico; 

ffS _  média da soma da intensidade negativa de cinza com o resultado do 

operador Sobel para uma amostragem de perfis de bordas de bolhas 

fora de foco. Valores resultantes da análise estatística sobre uma 

amostra de perfis de bolhas fora de foco; 

??ffS _  limite superior para soma da intensidade negativa de cinza com o 

resultado do operador Sobel para pixels de bolhas com perfis fora de 

foco. Este valor corresponde à média normalizada da soma entre a 

intensidade negativa de cinza adicionada com o valor do resultado 

do operador Sobel sobre uma amostragem de perfis de bolhas fora de 

foco, adicionado de um desvio padrão da média calculado sobre este  

mesmo parâmetro; 

feS _  média da soma da intensidade negativa de cinza com o resultado do 

operador Sobel para uma amostragem de perfis de bordas de bolhas 

em foco. Valores resultantes da análise estatística sobre uma amostra 

de perfis de bolhas em foco; 



 

62 

??feS _  limite inferior para a soma da intensidade negativa de cinza com o 

resultado do operador Sobel para pixels de bolhas com perfis em 

foco. Este valor corresponde à média normalizada da soma entre a 

intensidade negativa de cinza adicionada com o valor do resultado 

do operador Sobel sobre uma amostragem de perfis de bolhas em 

foco, subtraído de um desvio padrão da média calculado sobre este  

mesmo parâmetro; 

? ? ),(),(1 yxLyxI ???  função de pertinência para o valor da intensidade negativa de cinza 

adicionada ao resultado do operador Laplaciano de um pixel da 

imagem da amostra do escoamento bifásico; 

ffL _  média da soma da intensidade negativa de cinza com o resultado do 

operador Laplaciano para uma amostragem de perfis de bordas de 

bolhas fora de foco. Valores resultantes da análise estatística sobre 

uma amostra de perfis de bolhas fora de foco; 

??ffL _  limite superior para soma da intensidade negativa de cinza com o 

resultado do operador Laplaciano para pixels de bolhas com perfis 

fora de foco. Este valor corresponde à média normalizada da soma 

entre a intensidade negativa de cinza adicionada com o valor do 

resultado do operador Laplaciano sobre uma amostragem de perfis 

de bolhas fora de foco, adicionado de um desvio padrão da média 

calculado sobre este  mesmo parâmetro; 

feL _  média da soma da intensidade negativa de cinza com o resultado do 

operador Laplaciano para uma amostragem de perfis de bordas de 

bolhas em foco. Valores resultantes da análise estatística sobre uma 

amostra de perfis de bolhas em foco; 

??feL _  limite inferior para a soma da intensidade negativa de cinza com o 

resultado do operador Laplaciano para pixels de bolhas com perfis 

em foco. Este valor corresponde à média normalizada da soma entre 

a intensidade negativa de cinza adicionada com o valor do resultado 

do operador Laplaciano sobre uma amostragem de perfis de bolhas 



 

63 

em foco, subtraído de um desvio padrão da média calculado sobre 

este  mesmo parâmetro; 

O processo de "fuzzificação" consiste no mapeamento do vetor de 

características definido em um universo preciso para um universo denominado nebuloso, 

ou fuzzy. Este processo consiste no cálculo dos valores de pertinência no domínio [0,1] 

para cada uma das características do vetor de entrada e associadas a variáveis linguísticas. 

Estes valores de pertinência são submetidos a um processo de inferência gerido por um 

conjunto de regras estabelecidas segundo um modelo lógico matemático adaptado para 

aplicação em um universo fuzzy. O resultado da aplicação dessas regras identifica o grau de 

pertinência sobre funções de pertinências de saída que identificam o pixel de borda como 

"em foco" ou "fora de foco". Tal qual apresentada na figura 20 abaixo. 

 
FIGURA 20 - Modelo de função de pertinência representando a saída do sistema 

O módulo de inferência representado pela linha pontilhada apresentada na 

figura 16 tem, em sua condição básica, oito regras de inferência fuzzy, são elas: 

)()()()()8

)()()()()7

)()()()()6

)()()()()5

)()()()()4

)()()()()3

)()()()()2

)()()()()1

____

____

____

____

____

____

____

____

fefefefe

fefffefe

fefefffe

fefffffe

fefefeff

fffffeff

fffeffff

ffffffff

saídaLSI

saídaLSI

saídaLSI

saídaLSI

saídaLSI

saídaLSI

saídaLSI

saídaLSI

????

????

????

????

????

????

????

????

???

???

???

???

???

???

???

???

      (4.8) 

Os subscritos f_f e e_f complementam o significado das variáveis linguísticas 

com os termos "em foco" e "fora de foco", respectivamente. Os valores das pertinências 

para estas condições representam os antecedentes das regras e são os resultados da 

aplicação das funções de pertinência sobre os elementos do vetor de entrada preciso. Os 

?saída (x)

0

1
Bordas em focoBordas fora de foco

0,5 x



 

64 

valores das funções de saída são os resultados fuzzy das operações lógicas enumeradas nas 

expressões contidas em (4.8). 

Os operadores de intersecção representam a função lógica "E" que consiste na 

operação mínimo (min) na lógica fuzzy, realizando a interseção das funções de pertinência 

descritas em lógica fuzzy. A expressão (4.9) representa um exemplo desta operação: 

? ?)],([)],,([min)],([)],([
____

yxSyxIyxSyxI
fffefffe

???? ??        (4.9) 

Pode-se também empregar o produto limitado para a função lógica "E", uma 

vez que ela preserva os princípios da contradição e do meio excluído em universos 

nebulosos, ou seja: 

)],([)],([)],([)],([
____

yxSyxIyxSyxI
fffefffe

???? ???               (4.10) 

}1)],([)],([,0max{)],([)],([
____

???? yxSyxIyxSyxI
fffefffe

????         (4.11) 

A relação de implicação fuzzy emprega um modelo relacionado à lógica 

clássica, traduzida por uma representação generalizada do Modus Ponens e apresentado 

conforme a sequência de expressões abaixo: 

? Premissa 1: x é A*; 

? Premissa 2: se (x é A) então (y é B); 

? Consequente: y é B*; 

No modelo clássico, se a Premissa 1 ou primeiro antecedente for verdadeira e a 

Premissa 2 ou segundo antecedente for verdadeira, então a Consequente é verdadeiro. No 

Modus Ponens Generalizado, esta inferência funciona com graus de verdade que variam de 

0 a 1. 

Esta relação evidencia o grau de similaridade entre um modelo fuzzy e um 

modelo preciso, no entanto, o resultado da inferência das regras expressas em (4.8) sobre 

os valores fuzzificados do vetor de entrada, resultam em valores de pertinência segundo 

funções de saída. Estas funções de saída podem ser convertidas em um resultado preciso 

relacionado com a classificação do pixel da borda como "em foco" ou como "fora de foco" 

e seria obtido pela obtenção de um único valor final para a máquina de inferência fazendo 

a união das 8 expressões de (4.8). A partir deste valor pode-se fazer o processo inverso que 

é chamada de “defuzzificação” para a obtenção de um valor numérico (crisp) final para a 

inferência.  Para este trabalho foi utilizado o método geométrico ou método do centróide. 



 

65 

As expressões (4.12) e (4.13) apresentam estes cálculos para saídas discretas e contínuas, 

respectivamente. 

?
?

?
)(

)(.

x

xx
C

sa íd a

sa íd a

o g
?

?
         (4.12) 

?

?
?

dxx

dxxx
C

sa íd a

sa íd a

o g

)(

)(.

?

?
         (4.13) 

A classificação do pixel será realizada mediante os valor do centroide dos 

valores de pertinência de saída e as relações descritas abaixo , ou seja:  

?? 5,0
og

C pixel "fora de foco"               (4.14) 

?? 5,0
og

C pixel "em foco"      (4.15) 

 

4.2.2 As redes neurais artificiais (RNAs) no processo de identificação das bolhas 

O processo de identificação das bolhas na amostra da imagem do escoamento é 

realizado através de um conjunto de redes neurais artificiais multicamadas com 

alimentação adiante ("feedforward multilayer perceptron").  

As redes neurais artificiais são algoritmos concebidos com base na forma de 

processamento das informações pelo cérebro humano. Segundo HAYKIN (2001): 

" Uma rede neural é um processador maciçamente paralelamente distribuído 

constituído de unidades de processamento simples, que têm a propensão natural para 

armazenar conhecimento experimental e torná-lo disponível para o uso. Ela se assemelha 

ao cérebro em dois aspectos: 

1. O conhecimento é adquirido pela rede a partir de seu ambiente através de 

um processo de aprendizagem. 

2. Forças de conexão entre neurônios, conhecidas como pesos sinápticos, são 

utilizadas para armazenar conhecimento adquirido. " 

Um neurônio artificial representa a unidade básica para a construção de uma 

rede neural. Sua arquitetura e seus elementos constituintes estão ilustrados na figura 21 

abaixo. É com base nesta representação que uma rede neural artificial é projetada e 

implementada computacionalmente. 



 

66 

Os elementos básicos do modelo representado na figura 21 são: 

? os pesos sinápticos, 
kmkk

www ,...,,
21

: reconhecidos como a base de 

conhecimento de uma RNA, tratam-se dos elementos ponderadores do sinal 

de entrada 
m

xxx ,...,,
21

. Eles agem como atenuadores ou amplificadores do 

sinal de entrada; 

? um somador dos sinais de entrada ponderados pelos respectivos pesos 

sinápticos. Estas operações constituem um combinador linear e 

? uma função de ativação para restringir a amplitude do sinal de saída do 

neurônio. O intervalo normalizado da amplitude da saída de um neurônio é 

unitário fechado [0,1]. 

 
FIGURA 21 - Representação esquemática de um neurônio artificial.  

FONTE: HAYKIN (2001) 

Pode-se escrever um neurônio k pelas seguintes equações: 

j

m

i

kjk
xwu ?

?

?
1

       (4.16) 

)(
kkk

buy ???             (4.17) 

onde: 

kmkk
www ,...,,

21
:  pesos sinápticos do neurônio k; 

m
xxx ,...,,

21
: sinais de entrada; 

k
u :  saída do combinador linear; 

x1

x2

xm

wk1

wk2

wkm

? ? ( . )
Sinais de 
entrada

Pesos
sinápticos

Saída
yk

Bias
bk

Junção
aditiva

Função de
Ativação



 

67 

(.)? :  função de ativação; 

k
b :  bias e 

k
y :  sinal de saída do neurônio 

O bias, 
k

b , tem o efeito de aplicar uma transformação afim à saída do 

combinador linear. O termo 
k

v é denominado de campo local induzido e é descrito pela 

expressão: 

kkk
buv ??      (4.18) 

 

O bias é um parâmetro externo do neurônio artificial. Um procedimento 

comum é assumir o bias como uma nova sinapse, "
0k

w ", adicionando-se uma nova entrada, 

0
x , ao conjunto de entradas do neurônio k. Com isto o neurônio artificial pode ser 

representado matematicamente pelas expressões: 

j

m

j

kjk
xwv ?

?

?
0

        (4.19) 

)(
kk

vy ??      (4.20) 

Esta adequação do modelo matemático facilita a representação do neurônio sob 

a forma vetorial através da consideração dos elementos de entrada da rede neural pelo 

vetor: 

? ?T
m

xxxX ...
10

?             (4.21) 

Os pesos sinápticos passariam também a ser representados vetorialmente: 

 

? ?T
kmkkk

wwwW ...
10

?               (4.22)  

Seguindo este formato, a saída do neurônio k pode ser representada pela 

expressão: 

).(
k

T

k
WXy ??          (4.23) 

A arquitetura de uma rede neural artificial corresponde à representação da 

estrutura pela qual os neurônios de uma rede neural estão interligados. Para o processo de 

reconhecimento de padrões, HAYKIN (2001) indica o emprego de uma rede neural 

alimentada adiante com múltiplas camadas. Esta arquitetura de rede consiste em uma 



 

68 

camada de entrada, representada pelos próprios elementos do vetor de entrada, um 

conjunto de camadas intermediárias denominadas camadas ocultas e, uma camada de 

saída. O procedimento de cálculo desta rede é similar ao apresentado para um neurônio 

artificial, lembrando que a entrada da segunda camada corresponde às saídas da camada 

anterior, ou seja, da camada de entrada e assim por diante até chegar na camada de saída da 

rede. A figura 22 ilustra uma rede neural alimentada adiante com múltiplas camadas.  

 
FIGURA 22 - Grafo arquitetural de uma rede neural artificial alimentada adiante 

(a) Camada de entrada; (b) Camada oculta; (c) Camada de saída 

A rede neural apresentada na figura 22 tem uma camada de entrada, 

representada pelo vetor ? ?T
m

xxxX ...
21

? .  A execução desta rede alimentada adiante 

requer a inclusão do primeiro elemento do vetor X  , ou seja, 1
0

??x . Trata-se da inclusão 

de um sinal unitário ponderado pelo bias da rede neural, tal qual apresentado nas 

expressões (4.21) e (4.22). Esta atualização do vetor de entrada resultará no vetor 

? ?T
m

xxxxa ...
210

)0(
?  . Os elementos da primeira e única camada oculta da rede neural 

são resultantes da ponderação deste vetor de entrada pela matriz de pesos sinápticos com a 

posterior aplicação da função de ativação. Ela é representada pelo vetor )1(a   ,já 

considerando a adição do elemento representante do bias para esta camada, também 

representado na figura 22. A expressão para cálculo deste vetor é: 

x1

x2

xm

Saída
yk

a1
(1)

x0 =+1 a0
(1) 

a2
(1)

an
(1)

a0
(1) =+1

(a)
(b)

(c)



 

69 

? ?? ?TWaa T )0()0()1( .1 ???               (4.24) 

Onde )0(W  é a matriz de pesos sinápticos da camada de entrada da rede neural. 

Ela é representada por: 

)1(
,11,1

,11,1

)0(

...

.

.

.

.

.

.

.

.

.

...

nxm
nmm

n

ww

ww

W

?
??

?
?
?
?
?

?

?

?
?
?
?
?

?

?

?            (4.25) 

Ainda em conformidade com o modelo de rede apresentado na figura 22, a 

expressão da saída da rede neural, 
k

y , é: 

).(
)1()1(

Way
T

k
??        (4.26) 

A matriz )1(W  é a matriz de pesos sinápticos da camada oculta. A saída da rede 

neural pode ser representada por um escalar ou vetor com dois ou mais elementos. A 

definição do formato desta saída depende do tipo de classificação que será aplicada a rede 

neural. Quando uma rede neural for projetada para classificação de três ou mais classes, 

sua saída correspondente apresentará um número equivalente de elementos. Nestas 

ocasiões a rede neural será conhecida por rede neural artificial multiclasse. 

O resultado do treinamento de uma rede neural artificial são as matrizes de 

pesos sinápticos empregadas na ponderação de cada uma de suas camadas interligadas.  

A técnica de treinamento por retropropagação (ou "backpropagation") é a mais 

conhecida e diretamente aplicada em redes neurais multicamadas e alimentadas adiante. 

Trata-se de um método iterativo que consiste na propagação reversa, sobre a própria rede 

neural, do erro médio calculado sobre um conjunto de amostras rotuladas, ou seja, 

amostras com seus respectivos resultados. 

JAIN et al.(1996) descrevem detalhadamente o algoritmo de retropropagação 

como: 

1. Inicialização aleatória dos termos das matrizes de pesos sinápticos em 

valores pequenos; 

2. aleatoriamente, escolha um padrão de entrada )( ix ; 

3. execute a rede adiante sobre este sinal de entrada 



 

70 

4. Execute a rede neural adiante para esta amostra de entrada e calcule seu 

sinal de saída, L
i

y ; 

5. Calcule L
i

? na camada de saída: 

])[(
L

i

U

i

L

i

L

i
ydhg ????            (4.27) 

  Onde L
i

h representa a entrada da rede na i-ézima unidade da L-ézima 

 camada e g' é a derivada da função de ativação g. 

6. Calcule os "deltas" para as camadas precedentes pela retropropagação do 

erro: 

11
)(

??

???
l

j

j

l

ij

l

i

l

i
whg ?? ; para 1,...,1?? Ll    (4.28) 

7. Atualize os pesos sinápticos usando: 

1?
??

l

j

l

i

l

ji
yw ??         (4.29) 

8. Vá para o passo 2 e repita o procedimento para o próximo padrão até que o 

erro na camada de entrada seja menor que um limiar estabelecido ou um 

número máximo de iterações seja alcançado. 

A taxa de aprendizagem, "? " estabelece o grau de aproximação dos pesos 

sinápticos para cada iteração. A escolha por valores de taxas de aprendizado menores, 

proporciona robustez ao processo de aprendizagem, porém, torna-o mais lento. Um valor 

muito alto da taxa de aprendizagem pode resultar na instabilidade do processo de 

treinamento.  

O processo de reconhecimento de padrões associado a um modelo de máscaras 

virtuais com dimensões progressivas representa uma das principais inovações deste 

projeto. A máscara virtual progressiva, com dimensões iniciais pré-estabelecidas, executa 

uma varredura ordenada de uma amostra  da imagem do escoamento para a seleção 

sequencial de subimagens e identificação de uma única bolha. O treinamento e a aplicação 

da rede neural artificial (RNA) ocorre iterativamente de duas formas distintas, ambas em 

composição com as subimagens selecionadas pela máscara virtual progressiva. Nesta parte 

do projeto foram feitas as seguintes considerações: 

? as dimensões da máscara virtual progressiva foram escolhidas  iguais em altura e 

largura, ou seja, as máscara virtuais progressivas constituíram quadrados virtuais. 



 

71 

Estas dimensões eram compatíveis com o número de elementos de entrada da rede 

neural. Seus valores iniciais perfizeram uma máscara de 30 x 30 pixels, ou seja, 

uma matriz correspondente a um total de 900 pixels; 

? a configuração inicial da rede neural artificial (RNA) foi estabelecida em uma 

camada de entrada, duas escondidas e uma de saída. Esta configuração, segundo 

JAIN et al. (1996), estimula a não linearidade entre o mapeamento dos pixels de 

entrada e o resultado das camadas subsequentes, característica inerente no 

reconhecimento de padrões em imagens complexas. Estudos com avaliação da 

configuração de RNA's são realizados para este fim; 

? tanto na fase de treinamento como na execução sobre uma amostra de imagem 

ocorrerá a inclusão progressiva de uma nova camada de entrada, sempre que 

concluída uma varredura completa. O número de elementos dessa nova camada 

deve ser compatível com o aumento da máscara virtual de varredura para 

identificação de bolhas com dimensões maiores. Este processo, denominado 

varredura progressiva, irá ser repetido até que as dimensões da máscara de 

varredura, também denominada “máscara de varredura progressiva” venha a atingir 

a dimensão das maiores bolhas observadas nas imagens do escoamento e 

? foi estabelecida uma saída vetorial multiclasse, ou seja, ? ?Ty 01? . A razão do 

estabelecimento desta forma de saída para classificação da presença de uma bolha 

na subimagem deve-se à possível necessidade de redução de classificações erradas 

em função de um excessivo número de execuções da rede neural na varredura 

completa de uma amostra de imagem. Estas classificações são denominadas de 

falso-positivos, ou seja, ocasião em que a rede classifica erroneamente subimagens 

sem bolhas como positivas. Outra situação é a ocorrência de verdadeiro-negativos 

representada por situações em que subimagens sem bolhas são classificadas como 

positivas. Um dos recursos para minimização dessas ocorrências é o 

estabelecimento de limiares sobre os valores de saída da rede neural. Estes limiares 

devem assegurar a classificação positiva nos casos de detecção de bolha nas 

subimagens, ou seja, assegurem uma aproximação da saída da rede neural em que 

seus elementos, nestes casos, tenham valores próximos suficientes dos elementos 

de ? ?Ty 01? .  A definição desses dois limiares é realizada via tentativa e erro e 

devem ser criteriosos no sentido de assegurar a detecção das verdadeiras bolhas nas 

subimagens. 



 
72 

 

Configuração inicial da rede neural 

Baseando-se nas metodologias de projetos de redes neurais apresentados por 

NG (2011), MEHTA et al. (2006) e HAYKIN (2001), optou-se por uma rede neural 

artificial com múltiplas camadas e alimentada adiante segundo a arquitetura inicial 

apresentada na figura 23.  

 
FIGURA 23 - Configuração da rede neural artificial empregada na identificação  

de bolhas via máscara virtual de varredura com dimensões 30 x 30.  
  N. de camadas = 3 N. de elementos: 1a camada = 900 +1 
        2a camada = 144 +1 
        3a camada = 25 +1 

O número de elementos da camada de entrada corresponde ao número de pixels 

da máscara de varredura progressiva. O valor de x0 = +1 corresponde ao elemento 

acrescentado ao vetor de entrada para fins de inclusão do bias na constituição e cálculo do 

campo local induzido correspondente ao resultado do produto matricial entre os pesos 

sinápticos e os valores do vetor de entrada da rede.  Este procedimento é repetido para as 

camadas subsequentes da rede. O procedimento de execução da rede na forma alimentada 

adiante ("feedforward") e vetorizada é representado abaixo. Este procedimento considera 

uma função de ativação do tipo sigmoide aplicada em processos de classificação.  Sob esta 

forma, a rede é executada nas fases de treinamento, tendo como entrada um conjunto de 

.

.

.

.

.

.

.

.

.

x0 =+1

x1

x2

x3

xm

a0(2) =+1

a1(2)

a2(2)

an(2)

a0(1) =+1

a1(1)

a2(1)

ap(1)

a1(0) = h?(1)

a2(0) = h?(2)

?(3)

?(2)

?(1)



 
73 

 

imagens rotuladas, e na aplicação final quando ela é executada diversas vezes durante o 

processo de varredura de uma amostra de imagem. Assim, tem-se: 

x(i) vetor correspondente aos valores dos pixels da máscara de  varredura na forma 

vetorizada, ou seja, seguindo a sequência de posicionamento de coluna após coluna: 

x(i)=[x1,1 ... x1,n x2,1 ... x2,n ... xn,n]T . O valor de n corresponde a dimensão da máscara. 

Seu valor inicial é 30 e corresponde às subimagens com 30 x 30 pixels; 

i i=1, ... , m corresponde ao número de amostras de treinamento, por exemplo, no 

caso de amostras 30 x 30, m= 5500, visto o arquivo com amostras rotuladas 

(amostra de treinamento supervisionado) conter 5500 elementos. Para execução da 

rede sobre uma única subimagem capturada por uma máscara de varredura i=1; 

?(j) matriz de pesos sinápticos da camada correspondente; 

g(z) função de ativação do tipo sigmoide, comumente aplicada em processos de 

classificação logística:
ze

zg
?+

=
1

1
)( ; 

h?(x(i)) saída da rede neural para uma subimagem ou conjunto de subimagens de entrada x(i) 

(amostra de treinamento). 

A execução da rede neural na identificação de uma bolha nos limites de uma 

subimagem é realizada em seu modo de cálculo de alimentação adiante, ou seja, 

"feedforward" conforme o procedimento descrito: 

• Leitura da imagem dentro dos limites da máscara de varredura sob a forma 

vetorizada e representada pelo vetor [ ]nnn xxxxxx ,1,2,12,11,1 ......= ; 

• inclusão do valor de 10 =x  como primeiro elemento do vetor de entrada da rede 

neural; 

[ ]xxX 0=        (4.30) 

• cálculo dos valores do campo local induzido da primeira camada da rede: 

)3()2( .?= Xz        (4.31) 

• cálculo dos elementos de entrada da segunda camada (escondida) da rede e 

acrescentando o valor correspondente ao bias, ou seja, 1)2(0 =a , tem-se: 

[ ])(1 )2()2( zga =          (4.32) 



 
74 

 

• a função de ativação tendo )2(z como argumento é: 

)2(

1
1

)( )2(
ze

zg
?+

= ;         (4.33) 

• cálculo do campo local induzido para a segunda camada da rede: 

)2()2()1( .?= az  ;       (4.34) 

• cálculo dos elementos da terceira camada da rede, acrescentando o valor 

correspondente ao bias, tem-se: 

[ ])(1 )1()1( zga =  ;        (4.35) 

• cálculo do campo local induzido referente à terceira camada da rede: 

)1()1()0( .?= az         (4.36) 

• cálculo da saída da rede neural correspondente à imagem vetorizada de entrada: 

)()( )0(zgxh =?           (4.37) 

Os elementos de )( xh? que identificam a detecção de uma, ou até mais, bolhas 

em uma única subimagem definida pela máscara progressiva de varredura são: 

?
?

?
?
?

?
=

0
1

)( xh?       (4.38) 

Qualquer outra combinação de valores será identificada como ausência de 

bolhas na subimagem. 
 

Treinamento da rede neural 

O treinamento da rede neural é realizado segundo o método de propagação 

reversa, ou "backpropagation", de forma iterativa. Uma vez obtidas as matrizes de pesos 

sinápticos, a rede neural é executada sobre as amostras de imagens utilizadas como base 

para a sua própria construção. Neste processo, a transformada randomizada de Hough é 

executada nos casos de identificação positiva de bolhas nos limites da máscara virtual 

progressiva. Seus resultados são as coordenadas do centro, o semieixo maior, o semieixo 

menor e o ângulo de inclinação entre o semieixo maior e a horizontal local da elipse 

descrita analiticamente e representante da borda de interesse da bolha, ou seja, da interface 

gás-líquido. Estes parâmetros são utilizados na limpeza da imagem da bolha da amostra  da 

imagem do escoamento. A varredura completa desta amostra  tem o objetivo de limpá-la 



 
75 

 

para a construção de uma nova amostra de treinamento, empregando uma máscara 

progressiva de varredura com dimensões maiores. Este ciclo: construção da amostra de 

treinamento - limpeza das amostras s das imagens do escoamento bifásico - incremento nas 

dimensões da máscara progressiva de varredura, repete-se até que as dimensões da máscara 

progressiva de varredura atinjam as das maiores bolhas observadas em todas as imagens do 

escoamento. Ao final deste processo, acumulam-se um conjunto de arquivos, cada qual 

contendo os pesos sinápticos para execução da rede neural artificial de forma vetorizada. 

Ainda durante a fase de treinamento, a rede neural pode ser executada para fins 

de definição dos limiares de refinamento. O principal critério adotado para este processo de 

tentativa e erro é a eliminação do máximo de "falsos positivos" sem o comprometimento da 

detecção de bolhas com as dimensões apropriadas à máscara de varredura progressiva.  

O arquivo de amostras de treinamento da rede neural artificial para uma 

dimensão específica da máscara progressiva de varredura é composto de um conjunto de 

amostras organizadas linha por linha. Cada linha deste arquivo corresponde à uma 

subimagem vetorizada com as dimensões da máscara progressiva de varredura. Esta 

subimagem pode apresentar bolha ou não. Por se tratar de uma amostra de treinamento 

rotulada, o arquivo também contém a saída correspondente de cada subimagem. 

O treinamento via "backpropagation" consiste na propagação do erro da rede 

neural no sentido reverso. Este processo apresenta como resultado a minimização de uma 

função de custo )( )( ixJ?  em relação aos pesos sinápticos. Esta função é específica para 

aplicações de classificação logística e é construída empregando uma associação de funções 

logarítmicas com um processo de regularização para evitar a ocorrência de falsos valores 

que indicariam sua condição mínima, NG (2012). Emprega-se o método de otimização 

denominado gradiente conjugado e executado segundo uma função implementada em 

MATLAB ("fmincg"). Este método tem como característica principal a finalização do 

processo de minimização em função do número de iterações fornecida pelo usuário. Ele 

também estabelece um valor inicial e atualiza, conforme conveniência, a taxa de 

aprendizagem aplicada ao processo de treinamento. 

O processo de treinamento se inicia com a construção das matrizes de pesos 

sinápticos. Seus valores são gerados aleatoriamente segundo modelo estabelecido 

heuristicamente e apresentado por NG (2011). Posteriormente é realizada a aplicação da 



 
76 

 

rede neural em seu modo de execução "feedforward”, ou seja, de propagação adiante. 

Aplica-se o processo conforme a sequência:  

• Cálculo da função de custo considerando um modelo adequado para 

classificação logística: 

[ ] ????
= == =

?+????=
n

j

p

l

m

i

K

k
k

ii
kk

ii
k ljm

xhyxhy
m

J
1 1

2

1 1

)()(

,2
)))(1)(log(1())(log(

1
)(

?
? ??            (4.39) 

• Cálculo do erro na saída da rede para todas as amostras: 

kyh ?= ??
0      (4.40) 

• Cálculo da propagação reversa do erro: 

( ) )('*.. )1()0()1(1 zgT ?? ?=           (4.41) 

• Elimina-se o elemento 10?  

• Repete-se o procedimento para cálculo de 2? , ou seja: 

( ) )('*.. )2()1()2(2 zgT ?? ?=           (4.42) 

• Elimina-se o elemento 20?  

• Inicializa-se uma variável acumuladora )( i?  e atribuí iterativamente os 

resultados: 

Tiiii a ).( )1()()1()1( +++ +?=? ?              (4.43) 

• Calculam-se portanto os valores de  )3()2()1( e; ??? . Os valores do gradiente da 

função de custo sem a consideração dos fatores de regularização são obtidos 

de: 

)()(
)(

1 ii
i mm

J
?+?=

??
? ??            (4.44) 

Os valores da função de custo e de seu gradiente em relação aos pesos 

sinápticos serão empregados na minimização numérica da função de custo em relação aos 

valores dos pesos sinápticos. Tal condição é suficiente para assegurar valores adequados 

dos pesos sinápticos para seu emprego na rede neural. O método para tal procedimento é o 

método de otimização por gradiente conjugado e tem, segundo NG (2011) apresentado 

bons resultados em aplicações similares. A função fmincg implementada em ambiente 

MATLAB executa este método. 



 
77 

 

O resultado do treinamento da rede neural são as matrizes de pesos sinápticos 

de acordo com a configuração da rede neural artificial para cada máscara progressiva de 

varredura. Este resultado só é obtido após o treinamento de todas as opções de dimensões 

da máscara de varredura.  

Execução da rede neural 

A execução da rede neural sobre uma amostra de imagem do escoamento 

bifásico consiste na realização de sucessivas varreduras com máscaras virtuais progressivas 

para fins de detecção das bolhas. A sequência de procedimentos retrata este processo: 

I. inicialização das dimensões da máscara virtual progressiva de varredura para o 

menor valor definido, ou seja, 30 x 30 pixels; 

II. varredura, segundo um estabelecido modelo de progressão, da amostra da imagem 

com a separação de cada subimagem, selecionada pelos limites da máscara virtual 

progressiva de varredura; 

a. execução da rede neural sobre cada subimagem e, em caso de identificação 

de uma bolha na subimagem:  

i. aplicação de um detector de borda na subimagem, no caso, detector 

Canny; 

ii. identificação dos parâmetros geométricos das bordas da imagem; 

iii. verificação da ocorrência de bordas concêntricas e, caso positivo, 

eliminação dos parâmetros geométricos das bordas de menores raios 

ou de menor composição modular entre os semieixos maior e menor; 

iv. cálculo do volume da bolha e atribuição do resultado do volume a 

uma variável acumuladora de volume da amostra da imagem e 

v. eliminação da imagem da imagem da bolha da amostra  da imagem 

do escoamento evitando sua detecção em duplicidade via máscaras 

de varreduras progressivas com dimensões maiores; 

b. em caso de não detecção de bolha nos limites da máscara de varredura 

progressiva procede-se com o avanço da máscara de um pixels de acordo 

com as seguintes restrições de varredura da amostra : 

i. caso não seja possível o avanço devido ao final da linha da amostra, 

o avanço será sobre a primeira coluna da próxima linha da amostra; 

ii. caso tenha sido finalizada a varredura da imagem para uma 

determinada dimensão da máscara de varredura e não seja a maior 



 
78 

 

dimensão estabelecida para a máscara de varredura. Atribuir um 

acréscimo nas dimensões da máscara de varredura e retornar o 

processo para o item II ou 

iii. caso tenha sido finalizada a varredura da imagem para uma 

determinada dimensão da máscara de varredura e caso seja a maior 

dimensão estabelecida para a máscara de varredura. Finalizar o 

processo de execução da rede neural e seguir o processo para o item 

III; 

III. seguir para a fase final do sistema que realiza o cálculo da fração de vazio para a 

amostra da imagem. 
 

4.2.3 Identificação dos parâmetros geométricos das interfaces gás-liquido 

Tanto na fase de treinamento como na execução da RNA ocorre uma interação 

com o processo para obtenção das propriedades geométricas das figuras analíticas que se 

ajustem às interfaces gás líquido, no caso de detecção de bolha na subimagem. 

A extração dessas propriedades geométricas de uma única bolha em uma 

subimagem é realizada empregando-se a transformada de Hough por ser reconhecidamente 

uma técnica robusta para detecção de formas definidas analiticamente em uma imagem 

(YIP, TAM e  LEUNG, 1992).  

A transformada de Hough, em sua implementação convencional compreende 

duas fases. A primeira delas consiste na realização de incrementos em uma matriz 

acumuladora baseada no mapeamento da transformação e na regra de votação. A segunda 

trata de um exaustivo processo de pesquisa por parâmetros na matriz acumuladora e na 

verificação de formas candidatas associadas a estes parâmetros. A implementação da 

transformada de Hough requer o emprego de uma matriz acumuladora de dimensão 5 para 

detecção de elipses (coordenadas do centro da elipse, semieixo maior e menor e ângulo de 

inclinação) e tridimensional para círculos (coordenadas do centro e raio). 

A complexidade de tempo e espaço de algoritmos que aplicam esta 

transformada cresce exponencialmente em função do aumento de cada parâmetro desta 

matriz. 

Partindo-se desta afirmação muitos métodos modificados foram propostos. 

Embora efetivos em termos computacionais, eles comprometiam a robustez da 



 
79 

 

transformada, podendo prejudicar seus resultados em aplicações mais complexas, TSUJI e 

MATSUMOTO (1978), DAVIES (1989), MUAMAR e NIXON (1989) e 

LEAVERS (1989).  

YIP, TAM e  LEUNG (1992) apresentaram um modelo modificado da 

transformada de Hough com a redução da necessidade de memória, sem comprometimento 

de sua eficiência e robustez. Tal modelo consiste na redução da matriz acumuladora para 

uma matriz bidimensional. Partindo de imagens sintéticas e binárias digitalizadas com 

128 x 128 pixels e com o uso do operador de gradiente Sobel, a figura 24 (a) consiste na 

imagem de borda com 108 pixels. Os pontos maiores indicam as posições de picos 

detectados com um limiar ("threshold") de 10% do valor máximo do histograma. Na 

figura 24(b), YIP, TAM e  LEUNG (1992), mostram o histograma correspondente do 

acumulador bidimensional. 

 
FIGURA 24 - (a) posições dos picos locais detectados  

do acumulador sobre a imagem da borda. (b) histograma  
bidimensional do acumulador com picos correspondentes. 

FONTE: YIP, TAM e LEUNG (1992) 
 

(a)

(b)



 
80 

 

O modelo desenvolvido por YIP, TAM e LEUNG (1992) apresenta como 

restrição a geração de resultados positivos apenas para figuras analiticamente bem 

definidas. Sua aplicação em situações reais é comprometida em função dessas restrições, 

pois é perceptível que bolhas reais em um escoamento bifásico sofrem deformações em 

função das características do próprio experimento, como do fenômeno da circulação 

natural e suas instabilidades. Isto impossibilita sua associação integral a figuras 

analiticamente definidas, caso de elipses e circunferências. YIP, TAM e LEUNG (1992) 

também não consideram figuras sobrepostas, ou seja, com oclusões parciais das imagens 

das bolhas. Isto poderia comprometer os resultados, pois na sua ocorrência, as figuras após 

a separação em subimagens, apresentariam falhas de continuidade em suas bordas. 

A transformada randomizada de Hough (RHT - Randomized Hough 

Transform) apresentada por YU, LIU e HE (2008) tem como principal benefício a 

significativa redução das amostras e da matriz acumuladora resultando em uma expressiva 

melhoria de desempenho. Ela também permite a extração das propriedades de elipses 

parcialmente oclusas. Este recurso é importante, pois, a extração gradual das subimagens 

contendo bolhas deixa lacunas nas imagens resultantes quando as bolhas estão oclusas, 

mesmo que parcialmente. 

O potencial da transformada aleatória de Hough pode ser verificado em outras 

aplicações. TENG, KIM e KANG (2012) e ZHANG, JIANG E LIU (2012) apresentaram 

exemplos de aplicações destas variações da transformada de Hough sendo, o último, na 

identificação de bolhas em escoamento bifásico empregando uma única imagem contendo 

diversas bolhas dispersas. 

Além da expectativa por um melhor desempenho, justifica-se o emprego da 

transformada randomizada de Hough em subimagens com uma única bolha pela 

eliminação da possibilidade de cálculo das propriedades geométricas de uma única bolha 

em ocasiões de ocorrência da composição de duas bolhas próximas. 

O modelo desenvolvido tem como base o apresentado por McLaughlin (1997 e 

2000). Deve-se relevar que este modelo aplicado em imagens com poucas elipses ou 

circunferências (tratada como um caso particular de elipse) apresentam desempenho 

superior às demais variantes desta transformada no que diz respeito a precisão e 

desempenho computacional. Seu desempenho é comparável a própria metodologia 

apresentada por McLaughlin (2000) conforme exposto na figura 25. 



 
81 

 

 
FIGURA 25 - Comparação da precisão de detecção de elipses empregando-se diversos 

métodos e variantes da transformada de Hough. FONTE: MC LAUGHLIN (2000) 

A aplicação da transformada randomizada de Hough ocorre após a aplicação de 

um detector de bordas sobre a imagem. Apesar do método da declividade ser mais 

recomendado para esta operação segundo BHARDWAJ e MITTAL (2012), sua aplicação 

estaria limitada em função da necessidade do conhecimento prévio da intensidade de cinza 

de um número considerável de pixels anterior e posterior a borda da bolha. Valores estes 

que poderiam estar fora das dimensões da máscara progressiva de varredura e seriam de 

difícil identificação. O operador Canny, segunda opção apresentada por BHARDWAJ e 

MITTAL (2012) mostrou ser o mais indicado visto não necessitar destes parâmetros e já 

disponibilizar os valores da primeira derivada direcional da intensidade de cinza dos pixels 

da borda da bolha. Estas derivadas são empregados na transformada randomizada de 

Hough  visto representarem o coeficiente angular das retas tangentes aos pixels da borda da 

bolha. 

A notação empregada para representação das coordenadas dos pontos nas 

imagens emprega o sistema de eixos padrão de uma imagem digital tendo sua origem 

localizada no extremo superior esquerdo da imagem. Elas são identificadas pelas letras 

"r", para a coordenada da linha e "c", para a da coluna. 

A transformada randomizada de Hough parte da seleção aleatória de pixels 

distintos da suposta borda e das suas possíveis combinações segundo um modelo de 



 
82 

 

distribuição uniforme de probabilidades. As coordenadas desses supostos pixels da borda 

da bolha, ),( bb rc , e das suas derivadas direcionais são obtidas da aplicação do detector 

Canny. A dimensão dessa amostragem é de 50% de todas as possíveis combinações dois a 

dois entre todos os pixels de borda da subimagem após a aplicação do detector Canny. As 

derivadas direcionais sobre estes pixels, ),( )()( iiy bb rcg  e ),(
)()( ii

x bb
rcg , consideram o padrão 

de eixos correspondentes à convenção para representação de imagens digitais e a razão 

entre elas representam o coeficiente angular da reta tangente, tm , por um pixel de borda 

com coordenadas ),( bb rc , ou seja: 

),(
),(

)()(

)()(
)(

ii
x

ii
yi

t

bb

bb

rcg
rcg

m =  i=1,2        (4.45) 

O índice i=1,2 é empregado para diferenciar o pixel de borda e o seu par na 

correspondente seleção aleatória. Pode-se extrair os coeficientes lineares das retas 

tangentes, )( ilc , a partir dos coeficientes angulares obtidos da equação 4.23 e das 

coordenadas dos pixels correspondentes: 

)()()()( . ib
i

t
i

b
i

l cmrc ?=  i=1,2         (4.46) 

As coordenadas ),( tt rc  do ponto de intersecção das retas tangentes aos pixels da 

borda são obtidas por: 

)2()1(

)1()2(

tt

ll
t mm

cc
c

?
?

=         (4.47) 

)1()1( . lttt ccmr +=         (4.48) 

O cálculo das coordenadas do ponto médio entre os pares de pixels de borda 

pode ser realizado através das expressões: 

2

)2()1(
bb

m

cc
c

+
=         (4.49) 

2

)2()1(
bb

m

rr
r

+
=         (4.50) 

Sabe-se que o centro da elipse ou circunferência, "C(xc,yc)", está localizado na 

reta que passa pelas intersecções das retas tangentes, ponto "t", e pelo ponto médio dos 

respectivos pontos das bordas, ponto "m". Os coeficientes angular, tmm , e linear, ltmc , desta 

reta para cada par de pontos da amostragem pode ser calculado empregando-se as 

expressões abaixo: 



 
83 

 

mt

mt
tm cc

rr
m

?
?

=        (4.51) 

mtmmltm cmrc .?=          (4.52) 

A figura 26 ilustra a aplicação destes conceitos que resultam na equação 

reduzida desta reta, expressa pela equação (4.53): 

ltmcoltmrol cymx += .           (4.53) 

A partir do cálculo dos pontos sobre todas as retas geradas ao longo da 

extensão da subimagem e de uma votação sobre os pixels resultantes deste cálculo, será 

possível constatar a ocorrência de uma maior concentração de votos sobre as coordenadas 

do centro da elipse, "C(xc,yc)".  

 
FIGURA 26 - Representação da metodologia  

de cálculo para obtenção das coordenadas  
do centro da elipse empregando RHT. 

Na figura 26 estão ilustradas estas propriedades que fundamentam este modelo 

de cálculo e votação. A partir dela é possível constatar que a maior concentração de pontos 

estará na região do centro da elipse. Muitos autores adotam as coordenadas com maior 

votação como sendo o centro da figura analítica, no entanto, acredita-se que o processo 

aleatório na seleção de pares de pontos, aliado a uma pequena diferença na votação para 

pontos com coordenadas próximas (cerca de dois pixels), introduzem uma incerteza neste 

processo. Neste sentido, algumas modificações foram implementadas no modelo 

convencional da transformada aleatória de Hough a fim de melhorar a qualidade da figura 

analítica obtida como a que melhor se ajusta ao conjunto de pares dos pixels das bordas 

detectadas na imagem. O primeiro passo consiste na seleção das quatro coordenadas mais 

promissoras do centro da elipse, identificadas por uma diferença de votos inferior a dois 

pixels e com coordenadas distantes de, pelo menos, dois pixels.  

A(1) (c1 , r1)

O(0,0) c

r

m(1,2) 

C(xc  ,yc )

xc

yc



 
84 

 

A continuidade deste processo é a obtenção dos demais parâmetros da figura 

geométrica, ou seja, a dimensão dos semieixos maior e menor e o ângulo do semieixo 

maior em relação à horizontal local.  A extração desses parâmetros requer a translação da 

coordenada do centro da elipse para a origem do sistema O (0,0) e, consequentemente, de 

todos os pixels selecionados aleatoriamente da subimagem. Este processo é realizado sobre 

a combinação aleatória de três pontos (i=1,2 ou 3) necessários para a definição de uma 

elipse e, vetorialmente, consiste na aplicação das duas expressões descritas abaixo:  

c
ii yrr ?= )()(00        (4.54) 

c
ii xcc ?= )()(00        (4.55) 

A equação geral da elipse segundo este modelo é: 

( ) ( )( ) ( ) 12)(00)(00)(00
2)(

00 =++
iiii rCrcBcA       (4.56) 

sendo: 

2

2

2

2cos
b

sen
a

A
??

+=            (4.57) 

?? cos..
11

.2
22

sen
ba

B ?
?
?

?
?
?

?=     (4.58) 

2

2

2

2 cos
ba

sen
C

??
+=            (4.59) 

Os valores de "a", "b" e "?" correspondem aos semieixos maior e menor e a 

inclinação da elipse que consiste no ângulo formado entre o semieixo maior e a horizontal 

local, figura 27. 

 
FIGURA 27 - Representação dos  
parâmetros geométricos da elipse 

?

horizontal
local



 
85 

 

Com um conjunto formado por três pontos da borda da elipse (tripla) é possível 

construir o sistema linear: 

( ) ( )
( ) ( )
( ) ( ) ?

?
?

?

?

?
?
?

?

?

?
?
?

?

?

?
?
?

?

?

=
?
?
?

?

?

?
?
?

?

?
?

1
1
1

1

2)3(
00

)3(
00

)3(
00

2)3(
00

2)2(
00

)2(
00

)2(
00

2)2(
00

2)1(
00

)1(
00

)1(
00

2)1(
00

rrcc
rrcc
rrcc

C
B
A

        (4.60) 

A solução do sistema linear consiste na obtenção dos valores de A, B e C e os 

valores dos parâmetros geométricos da elipse são obtidos mediante a condição: 

0
2

.
2

&gt;?
?
?

?
?
?

?
B

CA          (4.61) 

Uma vez satisfeita a condição descrita pela desigualdade 4.61, pode-se calcular 

os valores dos parâmetros da elipse. 

22

2

)(
2

BCACA
b

+?++
=     (4.62) 

2

2

1
1

b
CA

a
?+

=          (4.63) 

?
?

?

?
?

?

?

&gt;
?
?
?

?
?
?
?

?

?
?

?

?
?
?
?

?
?
?
?

?

?
?

=

0cos

0cos

22

222

22

222

B
ab

aAba
a

B
ab

aAba
a

?         (4.64) 

Na ocorrência da igualdade entre os valores de "a" e "b",  identifica-se a 

borda de uma bolha circular. Nesta condição não haveria sentido a aplicação de qualquer 

uma das expressões descritas em 4.64. Na ocorrência de situações como estas, o valor de 

"?" será assumido como zero. Isto ocorre visto que bolhas circulares são casos particulares 

de elipses com semieixos iguais. 

A detecção final dos parâmetros da elipse consiste em um complexo sistema de 

votação desses três parâmetros calculados sobre uma grande amostra de tripla de pixels. A 

matriz acumuladora possui três parâmetros governantes, os semieixos maior e menor e o 

ângulo de inclinação da elipse. Os votos são contabilizados sobre o conjunto identificado 

sobre estes três parâmetros e são atribuídos a um único elemento dessa matriz.  

A escolha pela figura analítica que melhor se ajusta aos supostos pixels da 

interface gás-líquido representada pela borda externa da bolha inicia-se pelo processo de 



 
86 

 

varredura da matriz acumuladora e identificação do conjunto de parâmetros (a,b,?) com 

maior votação. 

É realizada a construção da figura analítica com centro na origem do sistema 

cartesiano, ou seja, O(0,0). Realiza-se a translação dos pixels desta figura obtida 

analiticamente segundo cada uma das quatro opções de coordenadas de centro da elipse 

obtidas pelo primeiro processo de votação. Para cada uma das quatro opções  de 

coordenadas de centro da elipse, é realizada uma contagem dos pixels de borda 

identificados na imagem original coincidentes com o das figuras analíticas. A figura com 

maior contagem  de pixels coincidentes será considerada a principal figura. As demais 

opções são descartadas. A relação entre os pixels de borda e os da figura analítica deverá 

ser superior à um limiar de 60% para que os parâmetros da figura analítica sejam 

considerados descritivos da interface gás-líquido da bolha.  

Este limiar visa ainda a identificação de elipses parcialmente oclusas e serve 

também como um fator adicional na identificação de bolhas fora de foco. 

Após a identificação dos parâmetros da elipse, a borda da bolha correspondente 

é apagada da imagem das bordas e o processo é repetido até atingir uma taxa de pixels de 

borda inferior ao limiar estabelecido. Na ocorrência da detecção de outra elipse, é realizada 

uma verificação de concentricidade entre elas. Caso isto venha acontecer, entende-se que a 

bolha inscrita é proveniente da ocorrência de sombras sobre sua interface e os parâmetros 

que a descrevem, ou seja, com menores valores de semieixos serão eliminados dos 

resultados. Caso contrário, é identificada uma segunda interface gás líquido nos mesmos 

limites da subimagem. O sistema estará reconhecendo esta, mesmo que indesejável, 

segunda bolha dentro dos limites da subimagem. A imagem da bolha na amostra  do 

escoamento será apagada para continuidade do processo. 

O resultado do processo de captura dos parâmetros das figuras analíticas 

descritivas das interfaces gás líquido nas subimagens será o número de figuras 

identificadas e uma matriz contendo em suas linhas o conjunto de parâmetros 

( )?bayx cc  descritivo de cada bolha. 

 

 

 



 
87 

 

4.2.4 Cálculo da fração de vazio da amostra do escoamento 

WHALLEY (1996) define a fração de vazio como a média temporal da fração 

transversal entre a área ou volume  que é ocupada pela fase gasosa. Ele também define a 

fração de vazio pela proporção do volume total que é ocupado por gás no escoamento. 

Entende-se que esta segunda definição se refere à fração de vazio volumétrica por se tratar 

de uma proporção de volumes.  

O cálculo do volume de cada uma das bolhas identificada nas amostras de 

escoamento, considera sua simetria em torno de seu semieixo maior, ou seja, a terceira 

dimensão da bolha seria descrita por um semieixo com comprimento igual ao do semieixo 

menor identificado na aplicação da transformada randomizada de Hough: 

cb =                 (4.65) 

O volume da bolha é calculado com esta consideração: 

2..
3
4

baV ?=         (4.66) 

 A figura 28 apresenta um elipsoide com estas características e dela já se 

pode observar sua similaridade com as bolhas visualmente identificadas nas imagens do 

circuito experimental. 

 
FIGURA 28 - Elipsóide regular empregado na  

representação de uma bolha. 
FONTE:&amp;lt;http://pt.wikipedia.org/wiki/Elipsoide&gt;,  

acesso em 31/03/2014 

 O volume de cada bolha é adicionado a uma variável acumuladora que é 

atualizada toda vez que uma bolha é identificada durante o processo de varredura de uma 

x

y

z

O



 
88 

 

amostra de escoamento. Ao final de todas as varreduras, esta variável acumuladora 

representa o volume total de gases na amostra, "
totg

V ", ou seja: 

...)114()96()80()66()54()44()36()30( ++++++++= ggggggggg VVVVVVVVV tot  (4.67) 

onde: 

totg
V  ... volume total de gases em uma amostra de escoamento; 

)(dsVg ... volume total das bolhas detectadas em uma amostra de escoamento 

por uma máscara virtual progressiva de varredura de dimensões "ds"; 

ds ... dimensões da máscara virtual progressiva para cada varredura da 

amostra do escoamento. ds = 30, 36, 44, 54, 66, 80, 96, 114, ... 

Os valores para incremento nas dimensões da máscara virtual progressiva de 

varredura são escolhidos segundo uma progressão aritmética com razão 2. Estes valores 

são selecionados a partir da observação do aumento progressivo do espaço entre as bolhas 

de dimensões maiores a medida que as varreduras progressivas vão ocorrendo. 

O cálculo da estimativa amostral da fração de vazio volumétrica, "?", consiste 

na razão entre o volume total de gases na amostra, "
totg

V " e o volume total da amostra, "" glV

ilustrada nas figuras 29 e 30. 
 

 

 
FIGURA 29 - Representação esquemática da amostra da imagem do escoamento bifásico 

(vista lateral) 

Câmera de 
alta resolução

Coluna 
de vidro do 

circuito
Seção da imagem 

do escoamento

Amostra do 
escoamento



 
89 

 

 
FIGURA 30 - Representação esquemática da amostra da imagem do escoamento bifásico 

(vista de cima) 

A vista frontal da amostra, representada pela projeção da imagem do 

escoamento sobre o sensor da câmera, possui dimensões iguais, ou seja, sua altura "h" é 

igual sua largura "Sa". 

O cálculo do volume total da amostra, "" glV , consiste no cálculo da área da 

planta, "Sp"  (ou área da amostra vista por cima) multiplicada pela sua altura, "h", ou seja: 

hSV pgl .=      (4.68) 

A área da planta, "Sp" é constituída pela adição da área interna do arco circular, 

"Sac" , limitado pelos pontos "a" e "b", o raio interno do tubo, "rint" com ângulo de abertura  

"?" em relação ao centro da tubulação, com a área do retângulo, "Sret" , com sua base 

formada pela linha de comprimento "Sa" (segmento " ab ") e com altura, "" reth , igual ao 

comprimento do segmento ae . A altura do retângulo é limitada pela profundidade de 

campo selecionada na câmera e aferida segundo a escada de nível ilustrada na figura 13. 

A área do arco circular é resultante extração da área do triângulo com vértices 

nos pontos a,b e c, da área do setor circular, formada pelo ângulo "?" e com os mesmos 

pontos. Os segmentos ca  e cb  possuem o mesmo comprimento do "rint" que é calculado 

segundo a expressão (4.69): 

Profundidade de campo da imagem “idof”

Profundidade de campo da 
amostra “sdof”

Su
pe

rf
íc

ie
 d

a 
am

os
tr

a
“S

a“

Planta da tubulação 
vertical do experimento

?

“?
ex

t“

“?
in

t“

“hret”

“htri”

“Sp “
c

a

b

e

d



 
90 

 

2int
?? ??

= extr           (4.69) 

Onde ??  é a expessura do vidro da tubulação do experimento. O ângulo de 

abertura referente às dimensões da amostra é obtido de: 

?
?
?
?

?

?

?
?
?
?

?

?
?
?
?

?
?
?

=
int

2
.2

r

S

arcsen

a

?           (4.70) 

A área do setor circular, scS  é obtida da expressão : 

2
.2int ?rSsc =  (? em radianos)         (4.71) 

O cálculo da área do triângulo abc, "" ?S , inscrito no setor circular, requer o 

cálculo da sua altura, "" ?h , que é obtida da expressão (4.72), ou seja: 

?
?
?

?
?
?

=? 2
cos.int

?
rh         (4.72) 

Logo: 

2
. ?

? =
hS

S a       (4.73) 

A área interna do arco circular é: 

??= SSS scac        (4.74) 

A altura do retângulo "abde" é: 

( )????
?
?

?
?
?

??= hrsrh dof
ext

ret intint 2
?         (4.75) 

A área do retângulo é; 

retaret hSS .=      (4.76) 

A adição da área do arco circular com a área do retângulo, resulta na área da 

planta, ou seja: 

retacp SSS +=         (4.77) 

O volume da amostra, " glV ", pode ser calculado com a consideração que a 

altura da amostra é igual à "Sa" e a equação (4.68) fica: 



 
91 

 

apgl SSV .=       (4.77) 

O cálculo da estimativa da fração de vazio da amostra, "?", pode ser calculada 

pela expressão: 

gl

gtot

V
V

=?      (4.78) 

 O processo pode ser reiniciado considerando outra imagem com as mesmas 

propriedades das amostras volumétricas das imagens anteriores pela captura do 

escoamento bifásico em outro instante de tempo, ou seja, no instante em que a imagem 

fora adquirida. O cálculo da variação temporal da fração de vazio, ou seja, para uma 

sequência de imagens em intervalos contínuos de exposição, representa a evolução 

temporal do escoamento bifásico.  

 

4.3 Calibração e ajustes do sistema computacional 

O desenvolvimento do sistema computacional considera as imagens do 

escoamento bifásico capturadas de circuitos de circulação natural como sua principal 

aplicação. As imagens são adquiridas pelo processo de imageamento direto que, consiste 

na captura direta de imagens digitais do escoamento bifásico, objeto de estudo no 

fenômeno da circulação natural, via câmeras de alta velocidade e resolução diretamente de 

uma seção longitudinal da tubulação de vidro do circuito. 

A calibração e os ajustes do sistema computacional farão uso das imagens 

capturadas de uma bancada de calibração de fração de vazio. Projetada e desenvolvida para 

este fim, a bancada de calibração de fração de vazio encontra-se nas dependências do 

Centro de Engenharia Nuclear do Instituto de Pesquisas Energéticas e Nucleares 

(CEN/IPEN). Ela consiste em um circuito aberto gerador de escoamento bifásico com 

tomadas de pressão em dois pontos diferentes. A figura 31(c) apresenta a imagem de uma 

visão geral da bancada de calibração de fração de vazio e as demais imagens, suas partes 

principais  como: (a) o painel de tomada de pressão; (b) seção da tubulação em que as 

imagens do escoamento bifásico são capturadas; (d) a tomada de pressão no ponto superior 

do circuito aberto e (e) elemento poroso e tomada de pressão no ponto inferior do circuito 

aberto. A diferença de pressão entre os pontos superior e inferior do circuito permite a 

estimativa da fração de vazio para as condições de execução do experimento. Os resultados 

desta bancada de calibração serão confrontados com os resultados da execução do sistema 



 
92 

 

sobre as correspondentes imagens capturadas durante a execução do experimento, ou seja, 

nas mesmas condições da sua realização. 

Este processo tem como fundamento a aquisição das imagens digitais 

capturadas diretamente do circuito aberto gerador de escoamento bifásico desta bancada de 

calibração. Esta parte da bancada é composta de uma coluna de vidro cilíndrica preenchida 

com água e com um sistema poroso de injeção de ar em sua base. As principais 

características físicas deste circuito aberto reproduzem as dos experimentos realizados no 

CCN nas dependências do CEN /IPEN (Centro de Engenharia Nuclear / IPEN), ou seja, o 

diâmetro interno da tubulação de vidro neste circuito, a distância em que a câmera de alta 

velocidade e resolução está posicionada da tubulação de vidro e o comprimento da secção 

longitudinal da imagem da tubulação do circuito.  

 
FIGURA 31 - Imagens da bancada de calibração de fração de vazio. (a) Painel de tomada 
de pressão; (b) seção da tubulação de captura das imagens do escoamento; (c) Visão geral 

da bancada; (d) Tomada de pressão da parte superior do circuito aberto; (e) Tomada de 
pressão da parte inferior do circuito aberto. 

A fração de vazio pode ser estimada experimentalmente através do diferencial 

entre a pressão extraída dos dois pontos do circuito gerador apresentados na figura 31(d) e 

31(e). Esta diferença de pressão é representada pela diferença entre as colunas d'água 

expostas no painel de tomadas de pressão, também capturado por imagem sincronizada 

com a do escoamento bifásico durante a execução do experimento. A figura 32 apresenta 

um esquema da bancada de calibração e suas respectivas partes. 

(a)

(b) (c)

(d)

(e)



 
93 

 

 
FIGURA 32 - Representação esquemática do  

circuito gerador de escoamento bifásico 

As imagens do escoamento bifásico correspondentes aos valores medidos da 

fração de vazio são capturadas da seção longitudinal ilustrada nas figuras 31(b) e 32 e são 

utilizadas como entrada do sistema computacional, figura 33.  

 
FIGURA 33 - Imagem capturada da bancada  

de calibração da fração de vazio. 

Elemento
poroso

Compressor

Câmera 
de alta 

resolução

Coluna 
de vidro

Painel de 
tomadas

de pressão



 
94 

 

A calibração e os ajustes deste sistema são realizadas com base no confronto 

direto dos valores da fração de vazio obtidos através da sua execução para diversas 

imagens digitais de escoamento bifásico  com os valores obtidos experimentalmente por 

um método denominado gravimétrico. 

Este processo de calibração e ajuste do sistema computacional habilita sua 

aplicação em circuitos que fazem uso do imageamento direto para estudos do fenômeno da 

Circulação Natural, em particular, o Circuito de Circulação Natural (CCN) instalado no 

Centro de Engenharia Nuclear do IPEN (DE MESQUITA et al., 2012). 

Em sua concepção original, o sistema computacional foi desenvolvido para 

aplicações sobre imagens obtidas por imageamento direto com o propósito de aplicação 

direta no Circuito de Circulação Natural. A perspectiva de universalizar sua aplicação para 

imagens de escoamento capturadas por imageamento por nêutrons visa a diversificação do 

sistema em termos de imagens provenientes de tecnologias diferentes para análise e estudo 

do fenômeno da circulação natural. 

Método gravimétrico para cálculo da fração de vazio 

A leitura da diferença de pressão realizada no circuito de simulação do 

escoamento é representada pela diferença na altura dos níveis de água no painel de 

tomadas de pressão, "h", figura 34(b). 

O método empregado para obtenção experimental da fração de vazio através 

desta leitura é denominado método gravimétrico e, para sua aplicação devem ser 

consideradas as seguintes restrições: 

• deve ser aplicado em escoamentos verticais tipo bolhas e com velocidade de 

líquido muito baixa; 

• a medida do diferencial de pressão permite o cálculo da fração de vazio 

volumétrica&amp;lt;?&gt;3 das fases no trecho do escoamento em questão e  

• se a distribuição axial das fases varia pouco (L pequeno e assim como as 

perdas por atrito) ao longo de L, pode-se afirmar que a fração de vazio 

média na seção é igual à concentração volumétrica,&amp;lt;?&gt; ?&amp;lt;?&gt;3 , figura 34. 



 
95 

 

 
FIGURA 34 - (a) Representação esquemática do painel de tomada  

de pressão em dois pontos do circuito; (b) Imagem do painel de  
tomada de pressão no circuito gerador do escoamento bifásico. 

A diferença de pressão, , é resultante da concentração de gás entre os dois 

pontos do escoamento devido a injeção de gás, da variação de pressão devido ao atrito 

entre as fases gasosa e líquida: 

          (4.79) 

onde: 

   densidade da mistura (kg/m3) 

   densidade do líquido (kg/m3) 

   diferencial de pressão causado pelo atrito do escoamento da 

    mistura 

 h  diferença na altura das colunas d'água no painel de tomada de 

    pressão (mm) 

   diferença na altura da coluna d'água devido a injeção de gases 

    no sistema (mm) 

A densidade da mistura é obtida em função da fração de vazio média&amp;lt;?&gt;, 



 
96 

 

tem-se: 

( ) GLm ????? +?= 1          (4.80) 

Substituindo a equação (4.80) em (4.79) e assumindo como GL ??? ?=? , 

desprezando-se o diferencial de pressão devido ao atrito da mistura, visto a velocidade da 

fase líquida ser próxima de zero, obtém-se a fração de vazio ?: 

L
h

GL

L .
??

?
?

+
=         (4.81) 

Para a bancada de calibração de instrumentos dedicados aos escoamentos 

bifásicos localizada no Laboratório de Termo-hidráulica Experimental do Centro de 

Engenharia Nuclear (CEN-IPEN) os parâmetros são: 

g = 9,81 m/s2 

L = 1,295 m 

82,997=
L

?  kg/m3 (@ 15 oC, Pamb) 

2502,0=
G

?  kg/m3 (@ 15 oC, Pamb) 

A descrição detalhada do método gravimétrico é realizada por ROCHA (2005, 

p. 50 - 53) onde é apresentada uma análise da incerteza sobre a aplicação deste mesmo 

método (p. I2 - I3). Esta incerteza é definida como o parâmetro associado ao resultado de 

uma medição e caracteriza a dispersão dos valores. A incerteza para a fração de 

vazio," ?? " é obtida, especificamente para o caso da aplicação do método gravimétrico, 

pela expressão: 

2

2

2

2)( ?
?
?

?
?
?+?

?
?

?
?
?=

L
Lh

L
h ??

??     (4.82) 

As imagens que servirão de base para calibração e ajustes das aplicações que 

compõe o sistema computacional foram adquiridas da bancada experimental de calibração 

da fração de vazio do escoamento bifásico buscando condições representativas do Circuito 

de Circulação Natural (CCN) do Centro de Engenharia Nuclear do IPEN (DE 

MESQUITA et al., 2012).  

 

 



 
97 

 

4.4 Descrição do Circuito de Circulação Natural (CCN) 

O CCN é constituído de tubos cilíndricos de vidro preenchidos com 20 litros de 

água desmineralizada, um aquecedor de calor controlado por um Variac (fonte de calor) e 

um trocador de calor helicoidal trabalhando como uma fonte fria (resfriamento). A 

visualização é possível em todo o circuito. O aquecedor é composto de dois resistores 

elétricos que podem ser controlados até 8000 W. O refrigerador é um circuito de água a 

temperatura ambiente. Existe um tanque de expansão parcialmente preenchido com água e 

posicionado acima do circuito agindo como um pressurizador. A figura 35 ilustra este 

circuito com destaques às suas principais partes integrantes.  

Das partes integrantes dessa figura pode-se ter uma visão completa do circuito, 

figura 35(c), do pressurizador posicionado na parte superior do circuito para fins de 

simulação de um modelo de refrigeração de um circuito aplicado em reatores nucleares 

pressurizados a água, figura 35(a), do Variac utilizado para fins de controle de temperatura, 

ou de adição de calor, figura 35(b), do trocador de calor para simulação do sistema de 

resfriamento , figura 35(d) e do aquecedor empregado para adição de calor ao circuito, 

figura 35(d). 

 
FIGURA 35 - Circuito de Circulação Natural (CCN). (a) Pressurizador;  

(b) Variac (controlador de calor); (c) Visão global do circuito; 
(d) Trocador de calor helicoidal; (e) Aquecedor. 

(a)

(b) (c)

(d)

(e)



 
98 

 

As aquisições de imagens são feitas simultaneamente com as medidas de 

temperatura e empregam câmeras de alta resolução (20 Mpixels).  

A frequência de captura das imagens em um experimento típico neste circuito 

(MESQUITA et al., 2009) foi de 1 quadro por segundo em experimentos com duração 

variável de 1000 a 1500 s. 

Uma estrutura foi elaborada para iluminação do escoamento pelo fundo de 

forma a estabelecer um contraste ideal e reduzir os efeitos de reflexão da face anterior do 

tubo, figura 36. O perfil das imagens capturadas foi de quadros de 3888 x 2592 pixels com 

uma resolução de 0.03 mm/pixel. Estas imagens foram adquiridas para uma secção 

longitudinal de 110 mm e transversal de 43.6 mm (diâmetro externo), figuras 36 e 37. 

 
FIGURA 36 - Representação esquemática 
do Circuito de Circulação Natural (CCN). 

FONTE: DE MESQUITA, R.N. et al. (2012) 



 
99 

 

O experimento que simula o escoamento bifásico neste circuito consiste em um 

ciclo de duas a três horas de operação que incluem o aquecimento inicial da massa de água 

com observação através dos sensores de temperatura, pressão e visualização dos diversos 

regimes de escoamento. 

 
FIGURA 37 - Região focal da câmera. 

FONTE: MESQUITA et al. (2009) 
O circuito gerador do escoamento bifásico para fins de calibração e ajuste do 

sistema computacional tem por princípio a reprodução de condições similares do CCN. 

Estas condições incluem a reprodução de características próprias do escoamento bifásico e 

são relevantes na captura das imagens para fins de aplicações no CCN: 

• a infraestrutura de aquisição de imagens no circuito gerador de escoamento bifásico 

emprega os mesmos equipamentos para aquisição de imagens, iluminação em 

posições similares as do circuito CCN; 

• as características físicas da tubulação de vidro do circuito experimental gerador do 

escoamento bifásico possui as mesmas características da tubulação do CCN, ou 

seja, foram utilizados tubos de vidro com mesmo diâmetro e espessura aos 

empregados no CCN; 

• a aquisição das imagens no circuito gerador do escoamento bifásico só poderá ser 

realizada a partir da observação da ocorrência de homogeneidade do escoamento, 

ou seja, em condições tais que uma imagem parcial seja representativa do 

escoamento em todo o circuito e, por conseguinte, do seu resultado experimental e 



 
100 

 

• as condições de iluminação na aquisição das imagens bem como os parâmetros 

relacionados aos ajustes das câmeras devem ser rigorosamente controlados de 

forma a assegurar a reprodução dos resultados em condições experimentais 

similares entre elas e as empregadas no CCN. 



 

101 

 

 

 

5 RESULTADOS 

 

O sistema computacional foi implementado contendo diversas aplicações e será 

mencionado neste texto por VFTools. O termo VFTools é uma sigla ("Void Fraction 

Tools" - Ferramentas de Fração de Vazio) e refere-se à uma caixa de ferramentas com um 

conjunto de aplicações (ou ferramentas) empregadas no cálculo da fração de vazio. As 

aplicações do VFTools executam a adequação de imagens digitais e seleção de amostras 

volumétricas do escoamento bifásico, o reconhecimento de bolhas, a identificação das 

propriedades geométricas das bolhas, o cálculo do volume de gases nos limites destas 

amostras de escoamento e o cálculo da fração de vazio.  

As aplicações foram desenvolvidas em MATLAB empregando recursos de 

interface gráfica para melhor visualização dos resultados e interatividade com o usuário. 

Todas as indicações, legendas e textos das interfaces gráficas estão na língua inglesa 

visando futuras utilizações em conjunto com outras universidades ou centros de pesquisa. 

As principais aplicações e suas funcionalidades são: 

? selecTool: realiza a seleção da amostra da imagem do escoamento bifásico 

segundo um modelo de captura das medidas superficiais, ou frontais e da 

profundidade da imagem do escoamento capturada do experimento. Esta 

última é associada a um valor de profundidade de campo selecionado na 

câmera de alta resolução e a um sistema de inferência focal fuzzy. Esta 

composição de profundidade de campo à um modelo fuzzy de inferência 

procura classificar e associar os pixels em foco das imagens do escoamento 

à um valor máximo de profundidade limitador do volume da amostra da 

imagem do escoamento; 

?  maSamTool: é a principal aplicação do VFTools. Ela realiza a construção 

das amostras de treinamento das redes neurais artificiais e o treinamento da 

rede dedicada à cada dimensão da máscara virtual de varredura progressiva. 

Executa o treinamento e realiza uma avaliação prévia do resultado do 

treinamento. Realiza a limpeza da amostra da imagem do escoamento 

bifásico para uma específica dimensão de máscara virtual de varredura 



 

102 

 

progressiva sobre uma amostra da imagem do escoamento e realiza o 

cálculo da fração de vazio e 

? saManTool: atua como suporte da maSamTool na construção e preparação 

do arquivo de amostras de treinamento. Esta aplicação realiza a 

reclassificação das amostras de "positiva" para "negativa" ou vice-versa. Ela 

possibilita a eliminação da amostra deste arquivo de amostras de 

treinamento assim como sua reorganização. 

O suporte para o desenvolvimento das aplicações e no emprego de recursos que 

melhorem a interatividade com o usuário e desempenho do sistema foram referências 

específicas de desenvolvimento e aplicações em MATLAB, tais como ATTAWAY (2012), 

GONZALES (2009) e LENT (2013). Embora não estejam ainda incorporadas ao sistema 

VFTools na forma de uma interface gráfica com o usuário, duas outras aplicações foram 

desenvolvidas, também em MATLAB: 

? lapsob: realiza o cálculo dos perfis de bordas de bolhas "em foco" e "fora de 

foco" para fins de análise estatística e 

? V_Sample: executa o cálculo do volume das amostras das imagens do 

escoamento bifásico com base nas suas dimensões e resolução. 

 

5.1 Condições gerais e de contorno dos experimentos 

Dois conjuntos de imagens foram utilizados de forma interativa no 

desenvolvimento do sistema. Estas imagens foram capturadas em datas diferentes que 

serão referenciadas na identificação de cada experimento. O primeiro experimento, e mais 

abrangente, foi realizado em 24/10/2013 e o segundo, mais restrito em termos de número 

de imagens, foi realizado em 10/05/2017.  

As imagens capturadas nestes experimentos e utilizadas nos estudos, bem 

como a identificação dos seus arquivos correspondentes, estão organizadas e apresentadas 

no apêndice A.  

Embora tratem de uma mesma bancada de calibração da fração de vazio, 

algumas variações nas configurações dos componentes do circuito aberto, configuração e 

posicionamento da câmera de alta resolução e iluminação, de fundo e ambiental, ocorreram 

nestes experimentos. Tais variações resultaram em tratamentos diferenciados na fase de 

pré-processamento e seleção das amostras de escoamento. O uso e a execução das demais 



 

103 

 

aplicações a partir do resultado da selecTool são idênticos. Necessitando apenas da 

atualização dos volumes correspondentes das amostras selecionadas diante da alteração da 

configuração da tubulação de vidro do circuito aberto e da profundidade de campo 

selecionada na câmera de alta resolução. Assim, tem-se: 

? Experimento de 24/10/2013 

? Resolução da imagem: 0,02 mm/pixel; 

? Profundidade de campo: 15 ? 3 mm da face anterior da tubulação de vidro; 

? Diâmetro externo da tubulação de vidro: 42 mm; 

? Espessura do vidro: 4 mm; 

? Dimensões frontais da amostra da imagem do escoamento: 800 x 800 pixels 

e 

? Volume da amostra, Va(18 mm) = 4,53 x 10
8
 pixels

3
 

? Experimento de 10/05/2017: 

? Resolução da imagem: 0,019 mm/pixel; 

? Profundidade de campo: 20 ? 5 mm da face anterior da tubulação de vidro; 

? Diâmetro externo da tubulação de vidro: 46 mm; 

? Espessura do vidro: 4 mm; 

? Dimensões frontais da amostra da imagem do escoamento: 800 x 800 pixels 

e 

? Volume da amostra, Va (20 mm) = 5,12 x 10
8
 pixels

3
. 

 

5.2 Análise estatística dos perfis das bordas das bolhas (aplicação lapsob) 

A aplicação lapsob é responsável pelo cálculo dos parâmetros empregados na 

construção das funções de pertinência do sistema de inferência focal fuzzy. Ela apresenta 

como resultado a variação desses parâmetros segundo o perfil da borda de uma bolha "em 

foco" ou "fora de foco" capturada de uma das imagens do escoamento bifásico. Seus 

resultados são gráficos que apresentam a bolha selecionada e os valores da variação da 

intensidade de cinza, da primeira derivada da intensidade de cinza e da segunda derivada 

da intensidade de cinza resultantes da aplicação dos operadores Sobel e Laplaciano sobre a 

imagem. Ela apresenta também a composição da primeira e segunda derivadas da 

intensidade de cinza, com a intensidade negativa de cinza. As derivadas da intensidade de 

cinza são mencionadas como "Sobel" para a primeira derivada e "Laplaciano" para a 



 

104 

 

segunda derivada. Todos os valores resultantes da aplicação lapsob são normalizados 

segundo o domínio [0,1]. Os valores da média e desvio padrão de cada um desses 

parâmetros estão expostos e identificados abaixo de cada um dos gráficos apresentados nas 

figuras. Os gráficos apresentados nas figuras 38 e 39 correspondem à variação desses 

parâmetros para perfis de bordas extraídos de imagens de uma bolha. Elas correspondem 

aos arquivos de imagens IMG_797_3.JPG e IMG_797_2.JPG, respectivamente. Estes 

perfis foram extraídos de imagens do escoamento bifásico capturadas no experimento 

de 24/10/2017. 

As figuras 40 e 41 apresentam gráficos dos parâmetros de segmentação das 

imagens do escoamento bifásico capturadas no experimento de 10/05/2017 e correspondem 

aos arquivos, IMG_2137.JPG e IMG_ 2145.JPG, respectivamente.  Os perfis avaliados e 

analisados nas imagens 38 e 40 correspondem a perfis de imagens em foco. Já os perfis das 

imagens 39 e 41, a imagens de bordas de bolhas fora de foco. Uma avaliação comparativa 

dessas figuras já é possível verificar a ausência de um padrão no perfil das bordas 

ilustradas nas figuras 39 e 41, ou seja, perfis de bordas fora de foco. Embora os valores do 

desvio padrão sejam significativos em comparação com os das bordas em foco, as médias  

da intensidade de cinza, da intensidade negativa de cinza adicionada ao operador Sobel e 

da intensidade de cinza adicionada ao Laplaciano são menores que os das bordas em foco. 

Este comportamento é esperado de bordas fora de foco visto haver uma grande variação 

nos valores de intensidade de cinza, porém, em níveis baixos. Nas figuras 38 e 40 os 

valores dos parâmetros apresentam poucas e contínuas variações. Este comportamento é 

típico de um perfil de bolha em foco. Os valores médios para estes perfis de bolhas em 

foco são, significativamente, maiores que os das bolhas fora de foco, no entanto, os valores 

do desvio padrão são da mesma ordem de grandeza. 

Os valores coletados dos 192 perfis de bordas do experimento de 24/10/2013 e 

dos 110 perfis de bordas do experimento de 10/05/2017 estão organizados e tabelados no 

apêndice B. Com base nestes dados foi realizado o cálculo do valor médio e do desvio 

padrão global dos parâmetros de segmentação considerados no modelo de inferência focal 

fuzzy. Essas análises e a construção do modelo estatístico baseado em uma distribuição 

gaussiana, foram realizadas isoladamente para cada um dos experimentos em função da 

ocorrência de uma significativa diferença de iluminação entre eles. A composição 

adequada desses valores com o desvio padrão global de cada um desses parâmetros 

viabiliza a construção das funções de pertinência. 



 

105 

 

 

F
IG

U
R

A
3
8
–

R
e
su

lt
a
d
o
s

d
o

c
á
lc

u
lo

d
o
s

p
a
râ

m
e
tr

o
s

d
e

se
g
m

e
n
ta

ç
ã
o

d
e

im
a
g
e
n
s

v
ia

la
p
so

b
(b

o
lh

a
e
m

fo
c
o

)
(a

)
In

te
n

si
d

a
d

e
d

e
c
in

z
a

e
L

a
p
la

c
ia

n
o

;
(b

)
In

te
n

si
d

a
d
e

d
e

c
in

z
a

e
S

o
b

e
l;

(c
)

In
te

n
si

d
a
d

e
n

e
g

a
ti

v
a

d
e

c
in

z
a

+
L

a
p

la
c
ia

n
o

;
(d

)
In

te
n

si
d

a
d

e
n

e
g

a
ti

v
a

d
e

c
in

z
a

+
S

o
b

e
l;

(e
)

L
a
p

la
c
ia

n
o

+
S

o
b

e
l.

(d
)

(a
)

(e
)

(b
)

(c
)



 

106 

 

 
 

F
IG

U
R

A
3

9
–

R
e
su

lt
a
d

o
s

d
o

c
á
lc

u
lo

d
o

s
p

a
râ

m
e
tr

o
s

d
e

se
g

m
e
n

ta
ç
ã
o

d
e

im
a
g

e
n

s
v

ia
la

p
so

b
(b

o
lh

a

fo
ra

d
e

fo
c
o
)

(a
)

In
te

n
si

d
a
d
e

d
e

c
in

z
a

e
L

a
p
la

c
ia

n
o
;

(b
)

In
te

n
si

d
a
d
e

d
e

c
in

z
a

e
S

o
b

e
l;

(c
)

In
te

n
si

d
a
d
e

n
e
g
a
ti

v
a

d
e

c
in

z
a

+
L

a
p
la

c
ia

n
o
;
(d

)
In

te
n
si

d
a
d
e

n
e
g
a
ti

v
a

d
e

c
in

z
a

+
S

o
b

e
l;

(e
)

L
a
p
la

c
ia

n
o

+
S

o
b

e
l.

(d
)

(a
)

(e
)

(b
)

(c
)



 

107 

 

 
 

 

F
IG

U
R

A
4

0
–

R
e
su

lt
a
d

o
s

d
o

c
á
lc

u
lo

d
o

s
p

ar
â
m

et
ro

s
d
e

se
g
m

e
n

ta
ç
ã
o

d
e

im
a
g

e
n
s

v
ia

la
p

so
b

(b
o

lh
a

e
m

fo
c
o

)
(a

)
In

te
n

si
d

a
d

e
d

e
c
in

z
a

e
L

a
p

la
c
ia

n
o

;
(b

)
In

te
n

si
d

a
d

e
d

e
c
in

z
a

e
S

o
b

e
l;

(c
)

In
te

n
si

d
a
d

e
n

e
g

a
ti

v
a

d
e

c
in

z
a

+
L

a
p

la
c
ia

n
o

;
(d

)
In

te
n

si
d

a
d

e
n

e
g

a
ti

v
a

d
e

c
in

z
a

+
S

o
b

e
l;

(e
)

L
a
p

la
c
ia

n
o

+
S

o
b

e
l.

(d
)

(a
)

(e
)

(b
)

(c
)



 

108 

 

 
 

F
IG

U
R

A
4
1
–

R
e
su

lt
a
d
o
s

d
o

c
ál

c
u
lo

d
o
s

p
a
râ

m
e
tr

o
s

d
e

se
g
m

e
n
ta

ç
ã
o

d
e

im
a
g
e
n
s

v
ia

la
p
so

b
(b

o
lh

a
fo

ra

d
e

fo
c
o
)

(a
)

In
te

n
si

d
a
d
e

d
e

c
in

z
a

e
L

a
p
la

c
ia

n
o

;
(b

)
In

te
n
si

d
a
d
e

d
e

c
in

z
a

e
S

o
b
e
l;

(c
)

In
te

n
si

d
a
d
e

n
e
g
a
ti

v
a

d
e

c
in

z
a

+
L

a
p
la

c
ia

n
o

;
(d

)
In

te
n
si

d
a
d
e

n
e
g
a
ti

v
a

d
e

c
in

z
a

+
S

o
b
e
l;

(e
)

L
a
p
la

c
ia

n
o

+
S

o
b
e
l.

(d
)

(a
)

(e
)

(b
)

(c
)



 

109 

 

As tabelas 1 e 2 apresentam os resultados desses estudos. Os resultados 

demonstram uma significativa variação entre os parâmetros das imagens capturadas nos 

experimentos de 23/10/2013 e nos de 10/05/2017.  

 

TABELA 1 - Média e desvio padrão das variáveis linguísticas empregadas na construção 

do sistema de inferência focal fuzzy - experimento de 24/10/2013 

 

TABELA 2 - Média e desvio padrão das variáveis linguísticas empregadas na construção 

do sistema de inferência focal fuzzy - experimento de 10/05/2017 

 

Onde: 

I  imagem representada pela intensidade de cinza 

1-I  imagem representada pela intensidade negativa de cinza 

Sob matriz com as mesmas dimensões da imagem contendo os resultados da 

aplicação do operador Sobel empregando a máscara de Kernel para 

varredura da imagem 

Lap matriz com as mesmas dimensões da imagem contento os resultados da 

aplicação do operador Laplaciano empregando a máscara de Kernel para 

varredura da imagem 

?  média 

?  desvio padrão da média 

 

5.3 Sistema de inferência focal fuzzy 

O sistema de inferência fuzzy foi elaborado com base nos resultados obtidos 

das análises dos perfis das bordas das bolhas. Estes resultados mostraram que as condições 

de iluminação interferem nos valores empregados no sistema focal de inferência fuzzy. 

Diante desta constatação, foram construídos dois sistemas de inferência focal baseado em 

(1-I)+Lap (1-I)+Sob I (1-I)+Lap (1-I)+Sob I

Média 0,53455 0,51154 0,33615 0,47058 0,32559 0,47336

? 0,16203 0,09311 0,09577 0,12065 0,09017 0,08838

?+? 0,69659 0,60466 0,43192 0,59123 0,41576 0,56173

?-? 0,37252 0,41843 0,24037 0,34993 0,23541 0,38498

IMAGENS COM BORDAS EM FOCO IMAGENS COM BORDAS FORA DE FOCO

(1-I)+Lap (1-I)+Sob I (1-I)+Lap (1-I)+Sob I

Média 0,65984 0,49546 0,44363 0,60348 0,32103 0,60171

? 0,11195 0,11064 0,12544 0,12613 0,06800 0,09821

?+? 0,77179 0,60610 0,56907 0,72961 0,38903 0,69992

?-? 0,54790 0,38481 0,31819 0,47736 0,25302 0,50349

IMAGENS COM BORDAS EM FOCO IMAGENS COM BORDAS FORA DE FOCO



 

110 

 

modelos fuzzy. O primeiro deles para os experimentos de 2013 e o segundo para o 

experimento de 2017.  

As funções de pertinência de entrada foram construídas de acordo com o 

experimento realizado e estão apresentadas nas figuras 42, 43 e 44 para o experimento de 

24/10/2013 e 45, 46 e 47 para o de 10/05/2017. 

 
FIGURA 42 - Função de pertinência 

Intensidade de cinza - 24/10/2013 

 

FIGURA 43 - Função de pertinência 

Intensidade negativa de cinza + Sobel 

24/10/2013

 

FIGURA 44 - Função de pertinência 

Intensidade negativa de cinza + Laplaciano 

24/10/2013 

I(x,y)

? [I(x,y)]

0

1
Bordas em foco Bordas fora de foco

0,34 0,430,39 0,47

[1-I(x,y)]+S(x,y)

? [1-I(x,y) ]+S(x,y)

0

1
Bordas em focoBordas fora de foco

0,510,42 0,430,33

[1-I(x,y)]+L(x,y)

? [1-I(x,y) ]+L(x,y)

0

1
Bordas em focoBordas fora de foco

0,530,37 0,590,47



 

111 

 

 
FIGURA 45 - Função de pertinência 

Intensidade de cinza - 10/05/2017 

 
FIGURA 46 - Função de pertinência 

Intensidade negativa de cinza + Sobel 

10/05/2017 

 
FIGURA 47 - Função de pertinência 

Intensidade negativa de cinza + Laplaciano 

10/05/2017 

 

Um conjunto de oito regras foram elaboradas e implementadas no módulo de 

inferência fuzzy. Elas foram minuciosamente elaboradas considerando-se os objetivos da 

aplicação que é a classificação de um pixel como "fora de foco" ou "em foco". Pixels "fora 

de foco" são considerados fora dos limites da amostra da imagem do escoamento e, 

portanto, serão descartados da imagem final, caso contrário, o pixel será preservado. Os 

valores input1, input2 e input3 são características extraídas de cada pixel da imagem e 

correspondem aos valores resultantes da aplicação do operador Laplaciano adicionado à 

intensidade negativa de cinza, do operador Sobel adicionado a intensidade negativa de 

I(x,y)

? [I(x,y)]

0

1
Bordas em foco Bordas fora de foco

0,44 0,570,50 0,60

[1-I(x,y)]+S(x,y)

? [1-I(x,y) ]+S(x,y)

0

1
Bordas em focoBordas fora de foco

0,490,38 0,390,32

[1-I(x,y)]+L(x,y)

? [1-I(x,y) ]+L(x,y)

0

1
Bordas em focoBordas fora de foco

0,660,55 0,730,60



 

112 

 

cinza e da intensidade de cinza respectivamente. Todos estes valores foram normalizados e 

as oito regras finais são apresentadas na TABELA 3. 

TABELA 3 - Regras implementadas no Sistema de Inferência Focal Fuzzy 

N
o 

ANTECEDENTE 1  ANTECEDENTE2  ANTECEDENTE 3  CONSEQUENTE 

1 If(input1 is lap-out) AND If(input2 is sob-out) AND If(input3 is int-out) THEN If(output1 is out-focus) 

2 If(input1 is lap-out) AND If(input2 is sob-out) AND If(input3 is int-in) THEN If(output1 is in-focus) 

3 If(input1 is lap-out) AND If(input2 is sob-in) AND If(input3 is int-out) THEN If(output1 is out-focus) 

4 If(input1 is lap-out) AND If(input2 is sob-in) AND If(input3 is int-in) THEN If(output1 is in-focus) 

5 If(input1 is lap-in) AND If(input2 is sob-out) AND If(input3 is int-out) THEN If(output1 is out-focus) 

6 If(input1 is lap-in) AND If(input2 is sob-out) AND If(input3 is int-in) THEN If(output1 is in-focus) 

7 If(input1 is lap-in) AND If(input2 is sob-in) AND If(input3 is int-out) THEN If(output1 is in-focus) 

8 If(input1 is lap-in) AND If(input2 is sob-in) AND If(input3 is int-in) THEN If(output1 is in-focus) 
 

Elas apresentam como resultado valores fuzzificados para a saída do sistema.  

A defuzzificação é  realizada pelo método do centroide e a classificação da saída ocorrerá 

conforme as funções de pertinência ilustradas na figura 48. Os parâmetros de saída foram 

definidos em função de simulações do próprio sistema implementado em ambiente 

MATLAB, ATTAWAY (2012). 

 
FIGURA 48 - Modelo de função de pertinência representando a saída do sistema  

 

5.4 Ferramenta de seleção da amostra - selecTool 

A aplicação selecTool (abreviatura de "selection Tool" - ferramenta de seleção) 

realiza a adequação e a seleção da amostra volumétrica do escoamento bifásico a partir das 

imagens digitais capturadas por imageamento direto de circuitos experimentais. A 

selecTool apresenta uma única tela (interface gráfica) para o imageamento direto. Embora 

disponibilize a opção de seleção de imagens capturadas por imageamento por nêutrons, a 

única funcional e apta para seleção é a metodologia de aquisição de imagens de circuitos 

experimentais via imageamento direto. A opção de seleção de imagens por imageamento 

por nêutrons presta-se a uma das evoluções concebidas para a aplicação. Estas opções são 

?saída (x)

0

1
Bordas em focoBordas fora de foco

0,5 x



 

113 

 

apresentadas em um painel localizado na parte superior direita da aplicação e a única que 

deve ser selecionada é a por imageamento direto, figura 49. A imagem original é 

apresentada no painel esquerdo da aplicação e consiste em uma imagem do escoamento 

bifásico capturada com a câmera de alta resolução posicionada verticalmente para cobrir 

uma maior extensão longitudinal da tubulação do circuito. Os parâmetros descritivos do 

experimento e da metodologia de aquisição das imagens são também representados em  

caixas de textos posicionadas abaixo da imagem. O sistema realiza a seleção de uma área 

frontal de interesse da amostra. Esta área é capturada levando-se em consideração a 

simetria com o eixo longitudinal da tubulação e suas dimensões, 400 pixels para cada lado 

do eixo e 800 pixels longitudinalmente, correspondem àquelas em que as distorções óticas 

do escoamento podem ser consideradas desprezíveis. Estes parâmetros foram selecionados 

a partir de observações visuais do escoamento e de suas imagens e estarão sujeitos a 

alterações mediante o processo de calibração e ajustes do sistema. Posteriormente, o 

sistema executa a rotação da imagem original para fins de compatibilização da imagem 

com o sentido do escoamento e em seguida, sua conversão em nível de cinza normalizado. 

A imagem colorida com as dimensões selecionadas para a amostra volumétrica é também 

apresentada no painel inferior direito. Sua exposição presta-se à comparação e uma 

avaliação visual dos resultados após a execução da aplicação. 

 
FIGURA 49 - Interface gráfica da aplicação selecTool 



 

114 

 

A seleção da profundidade da imagem é realizada mediante a aplicação do 

modelo de inferência focal fuzzy que relaciona a profundidade de campo em que a imagem 

digital foi capturada e a inferência fuzzy empregando os parâmetros de segmentação de 

imagens considerados para estabelecimento da qualidade de foco. 

A tela superior direita exibe a imagem da amostra do escoamento bifásico 

selecionada. As bolhas exibidas nesta imagem estão de acordo com a profundidade de 

campo estabelecida para seleção da amostra. Os pixels das bolhas que estão totalmente ou 

parcialmente fora desses limites foram eliminados da imagem. A comparação visual entre 

esta amostra selecionada e a imagem original, permite a identificação do processo de 

exclusão das bolhas fora dos limites da amostra e proporciona maior segurança à avaliação 

do usuário do sistema, evidenciando a execução de permitindo um processo controlado de 

seleção de amostras das imagens. 

 

5.5 Ferramenta construtora das amostras de treinamento 

A segunda e principal aplicação do sistema, denominada maSamTool 

(abreviatura de "make Samples Tool" - ferramenta de construção de amostras), executa um 

conjunto de operações independentes, figura 50. A primeira delas consiste na construção 

de um arquivo de amostras (subimagens) de treinamento para a rede neural. Nesta 

operação a aplicação recebe como entrada uma amostra de imagem de uma seção 

volumétrica do escoamento bifásico previamente selecionada pela aplicação selecTool. 

Uma vez carregada, a amostra é exibida em um painel localizado a esquerda, com 

dimensões maiores que sua correspondente colorida. Esta última é exibida em um painel 

intermediário a sua direita para fins de avaliação da compatibilização entre as subimagens 

candidatas a amostra de treinamento selecionadas na imagem do painel esquerdo com sua 

correspondente na imagem original. Esta subimagem candidata é selecionada com as 

dimensões de uma máscara virtual selecionada na janela de opções localizada na parte 

superior direita da aplicação. Ela é exibida em detalhes no painel a direita da aplicação. A 

seleção da candidata à amostra de treinamento poderá ser realizada aleatória ou 

manualmente. A subimagem selecionada passa a representar uma candidata à amostra de 

treinamento e deve ser classificada como uma bolha (classificação positiva) ou não através 

dos botões posicionados abaixo do seu painel de visualização. Uma vez selecionada como 

amostra de uma bolha, a aplicação irá calcular os somatórios dos pixels de sua diagonal 

principal, secundária e de todos os pixels da subimagem. Estes valores são empregados na 



 

115 

 

atualização do cálculo da média geral e do desvio padrão de todas as amostras positivas do 

arquivo de amostras de treinamento e atualizado nas caixas de textos correspondentes na 

aplicação. Eles podem, e devem ser considerados e avaliados pelo usuário em uma revisão 

do arquivo de amostras de treinamento. As atualizações da amostra de treinamento 

correspondem a inclusão de novas subimagens vetorizadas e sua classificação 

correspondente. O painel contador indicador do número de amostras positivas, negativas e 

o total de amostras, é atualizado após cada inclusão.  A não classificação de uma 

subimagem candidata com a consequente seleção de outra representará a sua exclusão e a 

classificação e inclusão no arquivo de amostras de treinamento será atribuída à imagem em 

exposição, caso seja classificada.  

 
FIGURA 50 - Interface gráfica da aplicação maSamTool 

A terceira aplicação tem o objetivo de prestar suporte na construção do arquivo 

de amostras de treinamento da rede neural. Ela é denominada saManTool (abreviatura de 

"sample Manager Tool" - Ferramenta de gerenciamento de amostras), figura 51. Ela 

executa o gerenciamento do arquivo de amostras de treinamento com as opções de 

exclusão de imagens mal selecionadas, reclassificação de imagens selecionadas e de 

organização das amostras no arquivo. Esta aplicação também apresenta os dados 

estatísticos das amostras contidas no arquivo. A aplicação saManTool permite a varredura 

sequencial ou pelo índice de todas as imagens das amostras de treinamento, bem como a 



 

116 

 

ordenação e reordenação dessas  subimagens quer seja na eliminação de uma imagem, quer 

seja pela classificação das amostras. 

 
FIGURA 51 - Interface gráfica da aplicação saManTool 

O processo de construção e gestão do arquivo de amostras de treinamento 

requer um rigoroso critério de classificação manual das amostras de treinamento e um 

significativo número de amostras para assegurar a ocorrência de resultados confiáveis. 

A opção por construção de arquivos com 4 a 5 mil amostras de treinamento foi 

baseado nos exercícios apresentados por NG (2011). A construção e treinamento de uma 

rede neural artificial para classificação múltipla, com dez classes, foi utilizado um arquivo 

com 5000 amostras de treinamento. 

Concluída a construção do arquivo de amostras de treinamento para 

reconhecimento de bolhas com dimensões compatíveis às da máscara virtual de varredura 

progressiva, executa-se o processo de treinamento e teste via aplicação maSamTool. Este 

treinamento é realizado empregando método de propagação reversa, mais conhecido como 

"backpropagation". Os testes são realizados empregando a própria amostra de treinamento 

construída para uma máscara de varredura de subimagens com a dimensão especificada na 

sua construção e na própria aplicação. Os resultados apresentados se referem a subimagens 

com 30 x 30 pixels. O treinamento da rede neural artificial é iniciado com a execução da 

opção  "TRAIN" na aplicação maSamTool. É solicitada a seleção do nome e caminho do 

arquivo contendo as amostras de treinamento e de um segundo arquivo com as 



 

117 

 

características de cada bolha empregada no cálculo das propriedades estatísticas da 

amostra. A figura 52 apresenta a tela de execução da aplicação maSamTools durante a fase 

de treinamento da rede neural. A execução do treinamento é específica para a dimensão 

selecionada da máscara virtual de varredura progressiva exibida na parte superior direita da 

interface gráfica . O painel que anteriormente era utilizado para exposição de amostras de 

imagens, agora apresenta um quadro com 100 imagens das amostras de treinamento 

selecionadas aleatoriamente. 

 
FIGURA 52 - Apresentação da aplicação maSamTool durante a execução do 

treinamento para uma máscara virtual de varredura progressiva com 30 x 30 pixels. 

A figura 53 apresenta a tela do resultado do teste de treinamento considerando 

um arquivo de amostras de treinamento com 4595 amostras sendo 1145 amostras positivas, 

ou seja, contendo até duas bolhas e 3450 negativas que representam imagens sem nenhuma 

bolha ou com apresentação de apenas partes de bolhas nos limites da profundidade de 

campo das imagens.  

 
FIGURA 53 - Tela de resultados do  

treinamento da rede neural 



 

118 

 

Este teste consiste na execução da rede neural, considerando as matrizes de 

pesos sinápticos resultantes do treinamento, sobre a própria amostra de treinamento.         

A precisão representada na tela de resultados representa a razão entre o número de acertos , 

ou seja, "verdadeiros positivos" para resultados positivos da rede nos casos em que a 

amostra contém bolhas e "verdadeiros negativos" nos casos contrários, ou seja, resultados 

da aplicação da rede em subimagens sem bolhas. O número total de execuções da rede 

neural artificial nesta avaliação corresponde ao número total das amostras de treinamento. 

A finalização da maSamTool para a condição de treinamento é a apresentação de uma tela 

para gravação das matrizes dos pesos sinápticos em um arquivo nomeado pelo próprio 

usuário com posterior apresentação das sub imagens descritas na primeira camada oculta 

da rede neural artificial, figura 54.  

 
FIGURA 54 - Finalização da fase de treinamento da rede neural com apresentação das 

subimagens da segunda camada. 

Observa-se nesta figura o grau de aleatoriedade das imagens representantes da 

segunda camada da rede neural indicando uma inicialização assimétrica dos pesos 

sinápticos. Esta verificação é importante e justifica sua apresentação em função da 

necessidade de se evitar a simetria na segunda camada da rede neural que poderia 

ocasionar a anulação de ramificações de entradas da rede neural. 

Uma vez concluído o treinamento da rede neural para uma dimensão específica 

de máscara virtual de varredura progressiva, as amostras de imagens devem ser preparadas 



 

119 

 

para construção de outras amostras de treinamento utilizando máscaras virtuais 

progressivas com dimensões maiores. Este procedimento consiste na execução da rede 

neural sobre as amostras de imagens do escoamento realizando a varredura com 

consequente eliminação das bolhas detectadas. Assim que finalizada a execução do 

maSamTool para esta funcionalidade, a nova amostra de imagem do escoamento bifásico 

sem as bolhas identificadas dentro dos limites da máscara virtual de varredura progressiva, 

será novamente armazenada  e disponibilizada para construção de um novo arquivo de 

amostra de treinamento para sub imagens com dimensões maiores. Este procedimento é 

executado sucessivamente até ser concluído com a detecção e eliminação das bolhas com 

maiores dimensões observadas nas imagens do escoamento bifásico. 

A calibração e os ajustes desses processos são interativos e ocorrem à medida 

em que eles são implementados. As formas de apresentação dos resultados são modificadas 

para fins de compatibilização com o parâmetro em análise. 

 

5.6 Configuração final do conjunto de redes neurais 

A definição da configuração final da rede neural considera os resultados 

produzidos sobre uma amostra de imagem selecionada no processo anterior, no caso a 

figura do arquivo 0812.tif. Esta configuração é estabelecida em função de sucessivas 

execuções da rede neural para realização de análises de tentativa e erro. O melhor resultado 

define a configuração definitiva da rede, ou seja, o número de camadas e o de elementos 

por camada. Considera-se o melhor resultado com aquele que reconhece a menor 

quantidade de "falso-positivos" em uma amostra do escoamento. Também é levado em 

consideração que a rede deverá, nesta mesma execução, reconhecer todas as bolhas 

existentes, ou seja, "verdadeiro-positivos" , nos limites da amostras. . 

Os resultados das análises estão apresentados na TABELA 4. O número de 

"falso-positivos", que representam o falso reconhecimento de bolhas, estão apresentados 

em função do número de elementos das camadas ocultas da rede. O número de elementos 

das camadas de entrada e saída são fixos. O número de elementos da camada de entrada 

deve ser compatível com o número total de pixels estabelecido pelas dimensões da máscara 

virtual de varredura progressiva. Esta análise é realizada apenas para a varredura da 

primeira amostra de imagens do escoamento bifásico por se tratar do uso da máscara 

virtual de varredura progressiva com as menores dimensões, ou seja, 30 x 30 pixels. Isto já 



 

120 

 

estabelece uma camada de entrada com 901, ou seja, 900 elementos referente ao número de  

pixels da subimagem e um elemento com valor fixo e igual a "1" referente a entrada do 

"bias" (elemento externo ou termo independente) da rede neural artificial. Os valores dos 

demais 900 elementos correspondem ao valor da intensidade negativa de cinza 

normalizada de cada pixel da subimagem. A configuração de número 10 é a adotada para 

esta aplicação e consiste de 901 elementos da camada de entrada, 145 elementos para a 

primeira camada oculta, 26 elementos para a segunda camada oculta e 2 elementos para a 

camada de saída. Com exceção da camada de saída, todas as camadas consideram a 

inserção do elemento correspondente à bias. 

A configuração das demais redes neurais artificiais, ou seja, para entradas com 

subimagens capturadas via máscaras virtuais de varreduras progressivas maiores são 

resultantes da introdução de novas camadas de entrada com dimensões compatíveis com as 

novas máscaras virtuais de varredura progressiva adicionada do elemento específico para a 

consideração do "bias" no algoritmo da RNA. 

TABELA 4 - Resultados da análise para definição da configuração da rede neural artificial 

Configurações 

da RNA 

Camada de 

entrada 

Primeira 

camada oculta 

Segunda 

camada oculta 

Camada de 

saída 

Número de 

falsos positivos 

(1) 900 225 36 2 28 
(2) 900 196 36 2 26 
(3) 900 169 36 2 25 
(4) 900 144 36 2 24 
(5) 900 121 36 2 28 
(6) 900 144 144 2 23 
(7) 900 144 81 2 24 
(8) 900 144 64 2 25 
(9) 900 144 49 2 28 

(10) 900 144 25 2 22 
(11) 900 144 16 2 25 

 

A ocorrência de "falso-positivos" como resultado da RNA deve-se à grande 

quantidade de execuções para varredura completa de uma amostra volumétrica de imagem 

do escoamento. Este número de execuções oscila entre 50000 a 120000. Ele depende de 

um valor mínimo para o somatório da intensidade de cinza de todos os pixels da 

subimagem, estabelecido como limite para execução e do número de bolhas existentes nos 

limites da amostra volumétrica do escoamento bifásico. O valor mínimo do somatório da 

intensidade de cinza da subimagem é consequência da análise estatística realizada na 

construção do arquivo de amostra de treinamento. Ele considera um valor de 40 para a 

soma da intensidade negativa de cinza dos pixels nos limites da máscara virtual de 

varredura progressiva. Este valor representa um limite inferior (média - 2,17 ?) indicando 

uma probabilidade inferior a 2,5% da ocorrência de bolhas com valores menores. São 



 

121 

 

adotados dois limiares para a saída da rede neural. Estes limiares são aplicados sobre os 

valores dos elementos do vetor de saída da rede neural, ou seja, ? ?Ty 01? . O valor inicial 

desses limiares consideram a ordem de grandeza do valor da função de custo, )( xJ
?

 na fase 

de treinamento da rede. A função de custo representa o erro médio da rede neural na 

condição final do processo de treinamento. Tratam-se de dois valores que minimizam a 

detecção de "falso-positivos" sem o comprometimento da qualidade da rede na detecção 

das verdadeiras bolhas na amostra do escoamento bifásico, ou seja, dos 

"verdadeiro-positivos" . 

A figura 55 apresenta a tela da aplicação maSamTool após a execução da rede 

neural sobre uma amostra de escoamento. Esta execução é realizada via botão "RUN" e 

executa um processo de limpeza da imagem da amostra do escoamento, pela eliminação 

das bolhas detectadas pela rede neural artificial integrada com a transformada randomizada 

de Hough, nos limites da máscara virtual de varredura progressiva. 

 
FIGURA 55 - Apresentação final da execução da rede neural sobre a amostra da imagem 

do escoamento bifásico pré processada. ARQUIVO: 0812.tif 

A imagem apresentada no painel à direita da interface gráfica da aplicação 

apresenta apenas as bolhas detectadas pela rede neural artificial como consequência de 

uma varredura completa da amostra da imagem do escoamento bifásico por uma máscara 

virtual de varredura progressiva com dimensões de 30 x 30 pixels. 



 

122 

 

A expectativa dos resultados era a detecção de cinco bolhas, no entanto eles 

resultaram na detecção de nove, sendo as cinco bolhas esperadas, ou seja, "verdadeiro-

positivos" e quatro "falso-positivos". Deve-se considerar ainda que: 

? execuções anteriores para estabelecimento da configuração da rede, 

resultaram em números maiores de "falso-positivos". Elas ainda não 

consideravam os limiares sobre os valores de saída da rede; 

? foram considerados limiares bastante rigorosos sobre os elementos de saída 

da rede neural artificial, ou seja, somente os resultados com erros inferiores 

a 2.10
-5

 foram classificados como uma bolha nos limites da subimagem; 

? a progressão da varredura da imagem ocorre pixel a pixel e isto requer um 

grande número de execuções da rede neural artificial. Neste caso foram 

realizadas 59107 execuções da rede, valores estes traduzidos em 

classificações de subimagens. Sendo assim, observa-se que o número de 

"falso-positivos" é insignificante e pouco representativo diante do número 

de execuções, ou seja, houve 6,78.10
-3

 % de casos com "falso-positivos". 

Estes resultados refletem a especificação de limiares para os valores de 

saída de cada execução da rede neural. Em simulações anteriores, sem a 

aplicação de limiares, os resultados apresentavam números maiores de 

"falso-positivos", cerca de 22 a 30 casos para cada imagem. 

 

5.7 Eliminação das bolhas detectadas na amostra da imagem do escoamento e 

identificação geométrica via transformada randomizada de Hough (TRH) 

O processo de eliminação das bolhas após sua detecção na execução da rede 

neural artificial é o mesmo da identificação dos parâmetros geométricos da interface gás 

líquido para cálculo do seu volume. Ambos necessitam da eliminação da imagem da bolha 

e sua realização requer as informações das coordenadas do centro, a dimensão de seus 

semi-eixos e do ângulo de inclinação da elipse que descreve analiticamente a interface gás 

líquido.  A eliminação da bolha consiste, inicialmente, no cálculo e eliminação dos pixels 

da forma analítica que representa sua borda externa com posteriores e sucessivas 

eliminações das elipses circunscritas a ela via  decremento das dimensões dos semi-eixos 

até se tornarem mínimos. 



 

123 

 

A detecção dos centros das elipses e de seus parâmetros (semi-eixo maior, 

semi-eixo menor e ângulo de inclinação) é realizado por uma função específica para este 

fim, denominada rht_center. Trata-se da aplicação da transformada randomizada de Hough 

sobre as subimagens com a identificação da ocorrência de bolhas.  

Identificação da bolha por votação - parte I 

As figuras 56, 57 e 58 apresentam a aplicação da transformada randomizada de 

Hough sobre uma subimagem contendo uma bolha bem definida.  

A sequência apresentada na figura 56 parte da detecção da bolha na 

subimagem, ou seja, uma vez detectada a existência de, pelo menos, uma bolha dentro dos 

seus limites, a subimagem passa a representar o resultado, no caso "positivo", da aplicação 

da rede neural artificial. O processo continua com a execução do operador Canny sobre 

esta subimagem com a consequente detecção dos pixels da borda da bolha e do cálculo das 

derivadas direcionais sobre eles. Estes resultados são armazenados em matrizes com as 

mesmas dimensões da subimagem para posterior aplicação no cálculo do coeficiente 

angular das retas tangentes aos pixels selecionados aleatoriamente. É realizada uma seleção 

aleatória dos "supostos" pixels da borda da bolha. Estes pontos, representados por suas 

coordenadas, são organizados, aleatoriamente, em conjuntos contendo 50% do total das 

possíveis combinações de pares. É perceptível a convergência das votações das 

coordenadas do centro da elipse. As quatro coordenadas mais votadas são selecionadas e a 

partir delas, os pixels são recombinados aleatoriamente formando triplas para identificação 

dos demais parâmetros. A maior diferença deste segundo processo é que os parâmetros são 

extraídos mediante a constatação da existência de uma elipse descrita, analiticamente, por 

eles. As combinações dos parâmetros da elipse com as quatro coordenadas mais votadas do 

seu centro servirão de base para identificação da forma que melhor se ajusta aos pixels de 

borda. Esta verificação consiste no cálculo da taxa de pertinência entre as coordenadas dos 

pontos da elipse, calculados analiticamente, com os pontos das bordas da bolha. A 

combinação que apresentar maior taxa de pertinência e apresentar um valor superior 

a 60%, será considerada descritiva da borda da bolha, ou seja, da interface gás líquido. A 

eliminação da borda desta elipse da subimagem, é realizada pela eliminação dos pixels 

resultante do seu cálculo analítico com a aplicação dos parâmetros identificados.  

Além do armazenamento dos parâmetros da elipse obtida, um parâmetro 

indicador da existência de uma figura analítica na imagem,  "flag" , é alterado, e o número 

de elipses encontradas na imagem"n_el", é também atualizado.   



 

124 

 

 
FIGURA 56 - Parte I - Aplicação dos procedimentos para detecção dos parâmetros 

geométricos da elipse. 

Identificação do centro de outra elipse por votação – parte II e III 

Uma segunda verificação é efetuada diante da possibilidade da existência de 

mais de uma bolha na imagem. A figura 57 ilustra esta nova execução da rotina  rht_center, 

como a parte II do processo. Nela também é possível observar a existência de uma nova 

elipse e ficando clara a convergência da votação sobre as coordenadas do centro desta nova 

elipse. O cálculo dos demais parâmetros e a eliminação desta elipse ocorre dentro dos 

mesmos moldes da parte I na extração dos parâmetros da primeira elipse. As variáveis 

indicadoras da existência de uma nova figura analítica na imagem, "flag" , e do número de 

elipses, "n_el", ainda não são atualizadas. Estas atualizações ocorrerão mediante a 

verificação da circunscrição de qualquer uma das duas elipses detectadas. Caso isto venha 

a ocorrer, é necessário a identificação da elipse com semi-eixos maiores por representar a 

borda externa da bolha, considerada interface gás-líquido. A borda interna é identificada 

como borda da sombra, formada em função dos efeitos óticos ocorridos durante a aquisição 

da imagem. Esta elipse com semi-eixos menores é eliminada da imagem e os parâmetros 

indicadores dela são desconsiderados. Caso as elipses não sejam concêntricas, identifica-se 

uma segunda bolha nos limites da sub imagem e o processo de captura e análise dos 

parâmetros que a descreve serão realizados, identificados e inseridos nos dados de saída da 

Centro ( xC , yC )  =  (16,15)

Semi-eixo maior ==&gt; a = 13 pixels

Semi-eixo menor =&gt;  b = 12 pixels

Inclinação == &gt;          ? = 135o  

Aplicação de um

detector de borda

(“ Canny”)

Identificação e votação das coordenadas 

do centro da elipse:

(“Transformada Randomizada de Hough”)

Extração dos parâmetros 

geométricos da elipse:

(“ Transformada Randomizada 

de Hough”)

Figura original

detectada pela

Rede Neural

Eliminação da borda da elipse 

correspondente da imagem



 

125 

 

função "rht_center". Nestas ocasiões, a saída da função será representada por uma matriz 

onde cada linha conterá os cinco parâmetros descritivos de cada elipse detectada e, 

complementando as informações de saída, a variável "flag", indicando a existência de 

elipses nos limites da máscara virtual de varredura e "n_el", indicando o número de elipses 

encontradas correspondendo ao número de linhas da matriz de saída da função contendo os 

parâmetros das elipses encontradas. 

 
FIGURA 57 - Parte II - (Continuação) Procedimentos para detecção dos parâmetros 

geométricos da elipse. 

A parte III deste processo, ilustrado na figura 58, consiste na execução de uma 

nova verificação e finalização da função. Observa-se que da parte II, figura 57, sobraram 

poucos pixels na imagem e, dificilmente outra elipse seria identificada nesta subimagem, 

pois, a razão entre o número de pontos da subimagem e da borda da elipse analítica é 

visivelmente  inferior ao limiar de 60%. Isto é confirmado pelos resultados e a variável de 

controle de existência de elipse na subimagem, "flag", é atualizada com um valor igual a 

"2", indicativo da finalização da função retornando o número de elipses e os parâmetros 

geométricos correspondente a cada uma delas. A disponibilização dos parâmetros 

geométricos das figuras representativas das bolhas detectadas nas subimagens viabilizam a 

eliminação da imagem da bolha da subimagem e o cálculo do volume de cada uma delas 

para atualização da variável acumuladora do volume total de gás nos limites da amostra da 

imagem do escoamento bifásico.  

Centro ( xC , yC )  =  (17 , 17)

Semi-eixo maior  ? a = 8 pixels

Semi-eixo menor ? b = 6 pixels

Inclinação ? ? = 15o  

Identificação e votação das coordenadas 

do centro de uma  nova  elipse:

(“Transformada Randomizada de Hough”)

Extração dos parâmetros 

geométricos da elipse:

(“ Transformada Randomizada 

de Hough”)

Eliminação da borda 

da elipse 

correspondente da 

imagem

Verificação e eliminação da 

elipse por se tratar de uma 

elípse concentrica inscrita 

em uma elipse com 

dimensões maiores.



 

126 

 

 
FIGURA 58 - Parte III - (Continuação) Procedimentos para detecção dos parâmetros 

geométricos da elipse. 

Existem ocasiões, além da ocorrência de elipses circunscritas, em que a 

detecção da elipse na subimagem será desconsiderada: 

? o cálculo da elipse analítica resultou em coordenadas de pixels localizados 

fora, ou na borda da máscara de varredura empregada pela rede neural para 

detecção da interface gás-líquido; 

? as coordenadas do centro da elipse estão fora, ou no limite, da máscara 

virtual de varredura progressiva empregada pela rede neural artificial na 

detecção da bolha; 

? imagens de bolhas selecionadas com partes na região limiar ou fora da 

profundidade da imagem da amostra volumétrica do escoamento bifásico. 

Neste caso, a rede neural detecta a bolha, no entanto sua taxa de pixels na 

borda analítica detectada é inferior ao limite estabelecido, em função da 

ocorrência de muitas falhas na sua borda externa e 

? mesmo com aparência nítida da imagem da bolha, a seleção da imagem da 

bolha identificou e extraiu alguns de seus pixels por estarem fora dos limites 

de profundidade de campo. Isto é passível de ocorrência em bolhas no limiar 

do controle deste parâmetro e podem resultar na ocorrência de baixa taxa de 

Identificação e votação das coordenadas 

do centro de uma  nova  elipse:

(“Transformada Randomizada de Hough”)

Extração dos parâmetros 

geométricos da elipse:

(“ Transformada Randomizada 

de Hough”)

Centro ( xC , yC )  =  (16 , 13)

Semi-eixo maior  ? a = 13 pixels

Semi-eixo menor ? b = 4 pixels

Inclinação ? ? = 101o  

Taxa de pixels na 

borda  da elipse 

inferior ao mínimo  

estabelecido (50%)

? Os pontos da 

imagem não 

correspondem a 

uma elipse

Flag = 2

FIM



 

127 

 

pixels de borda não identificando a bolha como válida para cálculo da 

fração de vazio. 

 

Resultados da integração da transformada randomizada de Hough com os outros 

algoritmos na detecção das bolhas em foco 

Estas situações ressaltam a importância da integração da transformada 

randomizada de Hough com os demais algoritmos, contribuindo diretamente para a 

robustez dos resultados. As figuras que seguem demonstram estas situações. A figura 59 

apresenta uma ocasião de uma bolha parcialmente fora de foco. Neste caso é visível que o 

conjunto de pixels da borda não foram suficientes para sua identificação como uma elipse 

válida. Esta situação é diferente da ocorrência de bolhas parcialmente oclusas devido a 

sobreposição por outras bolhas diante da possibilidade de não ocorrência de pixels fora de 

foco e o conjunto de pixels fora da região oclusa seja suficiente para identificá-la. 

 
FIGURA 59 - Imagem parcialmente fora de foco. Taxa de pertinência &amp;lt;60% 

A figura 60 representa um caso similar a este, onde a bolha está totalmente 

representada, porém, com sua imagem degradada em função da sua localização no limiar 

da profundidade de campo. Nesta situação a borda da bolha, obtida pela aplicação do 

operador Canny, apresenta várias descontinuidades. Embora compensadas e preenchida 

pelo operador, apresenta muitas  distorções, dificultando seu ajuste a um modelo de 

Imagem 

original

Imagem 

resultante da 

aplicação 

do detector de 

borda (Canny)



 

128 

 

representação analítico de uma elipse. O resultado da taxa de pixels desta imagem, assim 

como a subimagem representada na figura 60, foi inferior ao limiar  de 60% estabelecido 

para sua consideração como elipse válida. 

 
FIGURA 60 - Imagem de uma bolha no limiar da profundidade de campo. 

A figura 61 ilustra uma evidente situação de identificação "falso-positivo". 

Trata-se uma mancha ocasionada na imagem por uma bolha quase que totalmente fora da 

profundidade de campo.  

A forma desta imagem já demonstra tratar-se de uma figura totalmente fora dos 

padrões de uma bolha e que dificilmente seria identificada e ajustada analiticamente como 

uma forma elíptica. Uma particularidade observada nesta figura é a não convergência na 

votação das coordenadas do seu centro. 

A figura 62 apresenta a ocorrência de detecção de um falso positivo talvez em 

decorrência da generalização da rede neural. Embora com uma curva bem definida e com 

possibilidade de ajuste por uma elipse definida analiticamente, a imagem da fase gasosa 

sugere a ocorrência de pontos fora da máscara virtual de varredura progressiva e foi 

imediatamente desconsiderada pela função "rht_center". 

 

 

Imagem 

original

Imagem 

resultante da 

aplicação 

do detector de 

borda (Canny)



 

129 

 

 
FIGURA 61 -  Aplicação da transformada de Hough em falsos positivos. 

Também é possível observar a ocorrência de uma dispersão na votação das 

coordenadas do centro desta elipse. Observa que se trata de uma votação dispersa devido a 

localização fora dos limites da máscara virtual de varredura progressiva. 

 
FIGURA 62 - Aplicação da transformada randomizada de Hough em falsos positivos. 

Em todas as ocasiões em que os padrões geométricos não são detectados, a 

saída da função rht_center apresenta o número de elipses nulo. Isto evita que a imagem 

Imagem 

resultante da 

aplicação 

do detector de 

borda (Canny)

Imagem 

original

Imagem 

resultante da 

aplicação 

do detector de 

borda (Canny)

Imagem 

original



 

130 

 

seja eliminada da amostra do escoamento. Ela permanecerá presente em futuras varreduras 

com máscaras virtuais de varredura progressiva com dimensões maiores. Este fator é 

importante pois, neste último caso pode-se supor tratar-se da parte de uma bolha que, 

embora parcialmente dentro da profundidade de campo, pode possuir dimensões maiores. 

A figura 63 ilustra uma sequência de varredura de uma amostra da imagem do 

escoamento bifásico com máscaras virtuais de varredura progressiva com 30 x 30 pixels e 

36 x 36 pixels. 

A imagem original rotacionada e com dimensões superficiais idênticas às da 

amostra volumétrica do escoamento é apresentada no item "a" desta figura. A resposta do 

processo de seleção da amostra volumétrica e eliminação das bolhas fora do limite da 

profundidade de campo é ilustrada na imagem apresentada no item "b" desta mesma figura. 

Comparando-se esses itens da figura 63, pode-se constatar a ocorrência da seleção das 

imagens das bolhas dentro do limite de profundidade de campo. A imagem seguinte, figura 

63(c), ilustra o resultado da aplicação da rede neural artificial sobre a amostra da imagem 

do escoamento empregando a máscara virtual de varredura com as menores dimensões 

estabelecidas para execução. As subimagens apresentadas neste item da figura 

correspondem às detectadas pela rede neural artificial. A figura 63 (d) apresenta o 

resultado da limpeza da imagem do item anterior. Observa-se que todas as bolhas 

detectadas foram excluídas do item (d) da figura 63. Isto é consequência da execução da 

transformada randomizada de Hough sobre cada sub imagem com a identificação dos 

parâmetros geométricos das interfaces gás-líquido e execução do processo de limpeza de 

cada bolha detectada. A figura 63(e) ilustra o resultado da rede neural artificial com o 

emprego de uma nova máscara virtual de varredura progressiva com dimensões de 36 x 36 

pixels. O resultado final do processo de eliminação das bolhas detectadas é apresentado na 

figura 63(f). A imagem apresentada neste item da figura ilustra dois casos de 

"falso-positivos" que foram detectados pela rede neural artificial, porém, suas imagens não 

foram eliminadas em virtude da não identificação da existência de bolhas nos limites 

dessas sub imagens traduzindo o significativo aumento da robustez neste processo em 

função da integração entre tecnologias inteligentes para reconhecimento de padrões com a 

transformada randomizada de Hough. 

 

 



 

131 

 

 

 

 
 

 

(a
)

(b
)

(c
) (d

)
(e

)
(f

)

F
IG

U
R

A
 6

3
 –

S
e
q

u
ê
n

c
ia

 d
e
 v

a
rr

e
d

u
ra

 s
o

b
re

 u
m

a
 i

m
a
g

e
m

 d
a
 a

m
o

st
ra

 v
o

lu
m

é
tr

ic
a
 d

e
 e

sc
o

a
m

e
n

to
 b

if
á
si

c
o

: 

(a
) 

im
a
g

e
m

 o
ri

g
in

a
l:

 0
7

9
4

.t
if

(b
) 

a
m

o
st

ra
 v

o
lu

m
é
tr

ic
a
; 

(c
) 

re
su

lt
a
d

o
 d

a
 a

p
li

c
a
ç
ã
o

 d
a
 R

N
A

 p
a
ra

 m
á
sc

a
ra

 v
ir

tu
a
l 

d
e
 v

a
rr

e
d

u
ra

 c
o

m
 3

0
x

3
0

 p
ix

e
ls

; 
(d

) 
a
m

o
st

ra
 a

p
ó

s 
o

 p
ro

c
e
ss

o
 d

e
 l

im
p

e
z
a
 d

a
s 

b
o

lh
a
s;

 (
e
) 

re
su

lt
a
d

o
 d

a
 a

p
li

c
a
ç
ã
o

 

d
a
 R

N
A

 p
a
ra

 m
á
sc

a
ra

 d
e
 3

6
x

3
6

 p
ix

e
ls

 e
 (

f)
 a

m
o

st
ra

 a
p

ó
s 

o
 p

ro
c
e
ss

o
 d

e
 l

im
p

e
z
a
 d

a
s 

b
o

lh
a
s.



 

132 

 

5.8  Cálculo da estimativa da fração de vazio 

A estimativa da fração de vazio é realizada mediante o cálculo do volume total 

de gases na amostra. Ela é representada pela relação entre este volume de gases e o volume 

total (líquido + gás) no circuito. Estudos sobre o escoamento bifásico adotam valores 

médios, representativos deste parâmetro ao longo de todo um circuito experimental. 

Os cálculos relacionados a este parâmetro neste estudo consideram a fração de 

vazio sobre uma amostra de escoamento e sua representação global fica comprometida 

caso o escoamento desta amostra não represente um valor global do circuito. A bancada de 

calibração de fração de vazio presta-se à esta compatibilização de resultados. Fatores de 

correção foram adotados para fins de ajustes nos resultados obtidos nos cálculos pelo 

sistema VFTools e das medições realizadas na bancada de calibração. 

Foram selecionadas sete imagens capturadas dos experimentos, sendo três 

delas do experimento realizado em 24/10/2013 e quatro do experimento realizado em 

10/05/2017. O critério para seleção destas imagens foi a utilização de imagens com 

dimensões de até 66 pixels das maiores bolhas identificadas no escoamento.  

As figuras 64, 65 e 66 tratam das imagens capturadas no experimento de 

24/10/2013. Elas estão apresentadas em forma cronológica da aquisição das imagens. As 

imagens desse experimento tiveram os valores de medida do desnível da coluna de água 

relativas aos pontos de tomada de pressão mediante leitura visual na bancada de calibração 

de fração de vazio.  

As figuras exibem os resultados da estimativa de fração de vazio pelo método 

gravimétrico (descrito na seção 4.3), os resultados obtidos pelo sistema VFTools, o valor 

corrigido utilizando um fator de correção, e a dispersão relativa, "? ", para cada caso 

analisado, calculada segundo a expressão (5.1): 

100.
ex p

ex p

?

??
?

?
?

co

 (%)    (5.1) 

Onde: 

co
?  fração de vazio corrigida 

ex p
?  fração de vazio experimental, medida direta extraída da bancada de calibração 

 de fração de vazio  



 

133 

 

A figura 64 representa os resultados experimentais e os calculados via sistema 

VFTools.  

 
FIGURA 64 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_0780.JPG e experimental. 

A fração de vazio experimental, ou seja, adquirida pela leitura do painel de 

pressão da bancada de calibração apresentou um valor de %2316,0exp ?? correspondendo 

a uma diferença de pressão representada pela diferença na altura das colunas d'água no 

painel de pressão de mmH 3?? . A estimativa da fração de vazio via sistema VFTools 

apresentou um valor de %14,0?? . 

Para cada experimento foi adotado uma constante denominada fator de 

correção. Para este primeiro experimento este fator foi ajustado para 62,1?cof . Este fator 

genérico engloba, para estes estudos, vários possíveis fatores, desde fatores óticos de 

refração não levados em conta, não homogeneidade da distribuição do escoamento no tubo 

(amostra não representativa) e à imprecisão no ajuste da profundidade de campo na 

Experimento: 24/10/2013

Arquivo: IMG_0780.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 0780.tifArquivo: c0780.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 1,62

?H = 3 mm
? = 0,2316 %

? = 0,14319 % ? = 0,2319 %

Dispersão relativa
? = 0,12 %



 

134 

 

aquisição. O ajuste da profundidade de campo diante da imprecisão da escada de nível de 

profundidade de campo ter uma medição de mm3?  também inclui variações do foco que 

ocorrem por possíveis vibrações da tubulação e que por isto poderiam influenciar este 

ajuste. Se associássemos este fator genérico somente à estimativa da profundidade de 

campo seu valor sugeriria uma redução na profundidade de campo de 18 mm para 13 mm. 

A aplicação deste fator de correção sobre o resultado do sistema representa a redução para  

%12,0??  na dispersão dos resultados do sistema VFTools em relação aos extraídos 

experimentalmente via leitura do painel da bancada de calibração da fração de vazio. 

As figuras 65 e 66 mostram os resultados obtidos utilizando este mesmo fator. 

Elas representam os resultados extraídos das imagens do escoamento bifásico apresentadas 

nos arquivos IMG_781.JPG e IMG_844.JPG respectivamente, relativas ao mesmo 

experimento e, portanto, com condições semelhantes de aquisição.  

 
FIGURA 65 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_0781.JPG e experimental. 

Experimento: 24/10/2013

Arquivo: IMG_0781.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 0781.tifArquivo: c0781.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 1,62

?H = 3 mm
? = 0,2316 %

? = 0,1328 % ? = 0,2152 %

Dispersão relativa
? = 7,08 %



 

135 

 

A dispersão entre os resultados da bancada experimental e da estimativa do 

sistema VFTools apresentou valores de 7,08 % para a imagem do escoamento do arquivo 

IMG_781.JPG, figura 65, e de 5,8% para a imagem do escoamento do arquivo 

IMG_844.JPG, figura 66.  

 
FIGURA 66 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_0844.JPG e experimental 

Outro aspecto interessante é a coerência visual entre as imagens das amostras 

do escoamento. As imagens representadas nas figuras 64 e 65 ilustram escoamentos com 

uma densidade de bolhas parecidas na imagem. A imagem da amostra do escoamento 

ilustrada na figura 66 apresenta uma densidade maior e isto é perceptível pelo valor da 

fração de vazio experimental e estimada pelo sistema VFTools. 

Os resultados dos experimentos realizados em 10/05/2017 estão ilustrados nas 

figuras 67 a 70 apresentadas a seguir. A alteração de alguns parâmetros destes 

experimentos (em relação ao descrito anteriormente) devem ser ressaltados para a análise 

dos resultados obtidos pela aplicação do VFTools.  

Experimento: 24/10/2013

Arquivo: IMG_0844.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 0844.tifArquivo: c0844.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 1,62

?H = 5 mm
? = 0,386 %

? = 0,2244 % ? = 0,3635 %

Dispersão relativa
? = 5,8 %



 

136 

 

 
FIGURA 67 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_2137.JPG e experimental 

O primeiro deles diz respeito ao aumento da profundidade de campo em que as 

imagens foram capturadas. Enquanto no experimento de 24/10/2013 esta profundidade de 

campo era de 15 ? 3 mm, este parâmetro é de 20 ? 5 mm para o experimento de 

10/05/2017. As imagens mostraram a necessidade de se adotar um valor maior para o fator 

de correção que, associado às dimensões do volume da amostra, representariam uma 

redução na profundidade de campo de 20 para 12 mm no experimento de 10/05/2017.  

Outra mudança observada neste novo experimento foi uma avaliação visual em 

que houve aumento da não homogeneidade na distribuição do escoamento (distribuição das 

bolhas) ao longo do circuito, refletindo diretamente nos resultados da estimativa da fração 

de vazio via sistema VFTools baseada nas amostras utilizadas.  

Experimento: 10/05/2017

Arquivo: IMG_2137.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo:02137.tifArquivo: c2137.tif

Amostra 
volumétrica

Resultados

Leitura do Painel de 
Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 2,07

(-1,5;-1,0)
?H = 2,5 mm
? = 0,1158 %

? = 0,056 % ? = 0,1159 %

Dispersão relativa
? = 0,1 %



 

137 

 

 
FIGURA 68 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_2142.JPG e experimental 

As figuras 67, 68 e 69 refletem isto por representar medidas efetuadas em 

intervalos de tempo próximos. Embora os resultados indicassem valores iguais de fração 

de vazio pelas leituras do painel da bancada de calibração, ocorreram variações quando 

comparadas com os resultados obtidos via estimativas tomando-se por base as imagens 

correspondentes. Isto verifica-se pela comparação das dispersões entre os resultados de 

cada uma delas. Presume-se portanto que os resultados dos experimentos extraídos via 

bancada de calibração da fração de vazio no circuito representa um valor médio deste 

parâmetro e correspondente à fração de vazio média caso fosse estimada em diversas 

localizações diferentes do circuito.  

Outro fator a ser ressaltado diz respeito à incerteza nas medições 

experimentais. Ao admitir-se uma incerteza de 0,5 mm na medição do nível d'água de cada 

Experimento: 10/05/2017

Arquivo: IMG_2142.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 02142.tifArquivo: c2142.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 2,07

(-1,5;-1,0)
?H = 1,5 mm
? = 0,1158 %

? = 0,0572 % ? = 0,1184 %

Dispersão relativa
? = 0,26 %



 

138 

 

tomada de pressão, supõe-se uma incerteza máxima de 1,0 mm sobre a medição deste 

parâmetro. O impacto direto desta incerteza na medida experimental da fração de vazio, ou 

seja, via bancada de calibração é de um valor de %08,0??? . Embora represente um valor 

absoluto pequeno, esta incerteza é significativa quando se trata de medições experimentais 

em circuitos com baixa fração de vazio. Sob estas condições, o valor da incerteza poderia 

comprometer uma análise quantitativa dos resultados, limitando-as à associações dos 

resultados às observações qualitativas sobre as imagens capturadas do escoamento. Para 

valores maiores de fração de vazio a incerteza passa a ser insignificante e o processo de 

calibração e ajuste do sistema passaria a ser mais preciso. 

 
FIGURA 69 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_2143.JPG e experimental 

 

Experimento: 10/05/2017

Arquivo: IMG_2143.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 02143.tifArquivo: c2143.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 2,07

(-1,5;-1,0)
?H = 1,5 mm
? = 0,1158 %

? = 0,054 % ? = 0,1112 %

Dispersão relativa
? = 4,0 %



 

139 

 

 
FIGURA 70 - Fração de vazio estimada da amostra capturada da imagem do arquivo 

IMG_2148.JPG e experimental 

Análises complementares foram realizadas com base na avaliação de diversos 

fatores de correção que podem ser associados à profundidade de campo das imagens e nos 

resultados da fração de vazio para cada um dos experimentos. Este processo consiste nos 

cálculos de dispersão em função de diferentes valores para o fator de correção. Estes 

cálculos utilizaram estimativas de correções do valor de profundidade de campo (pc) 

considerando que todo o fator de correção utilizado fosse devido a este parâmetro. As 

tabelas 5 e 6 apresentam estes resultados.   

 

 

 

Experimento: 10/05/2017

Arquivo: IMG_2148.JPG

Imagem original 
capturada do Circuito 

Amostra

Arquivo: 02148.tifArquivo: c2148.tif

Amostra 
volumétrica

Resultados

Leitura do Painel 
de Pressão

Sistema VFTools
Opção: RUN

Valor corrigido
fco = 2,07

(-2,5;-1,0)
?H = 2,5 mm
? = 0,193 %

? = 0,1006 % ? = 0,2082 %

Dispersão relativa
? = 7,9 %



 

140 

 

TABELA 5 - Relação das frações de vazio com a profundidade de campo 

 (Experimento de 24/10/2013) 

Imagem 

 

fCO  (pc) 

IMG_780 

?b = 0,2316 % 

?VFTools = 0,1432 % 

IMG_781 

?b = 0,2316 % 

?VFTools = 0,1328 % 

IMG_844 

?b = 0,386 % 

?VFTools = 0,2244 % 

2,51 (10 mm) 0,3594 % (55%) 0,3333 % (44%) 0,5632 % (46%) 

2,12 (11 mm) 0,3036 % (31%) 0,2815 % (22%) 0,4757 % (23 %) 

1,84 (12 mm) 0,2635 % (13%) 0,2444 % (5,5 %) 0,4129 % (7%) 

1,62 (13 mm) 0,2320 % (0,17%) 0,2151 % (7,1 %) 0,3635 % (5,8%) 

1,45 (14 mm) 0,2076 % (10%) 0,1926 % (17 %) 0,3254 % (16%) 

 

 

TABELA 6 - Relação das frações de vazio com a profundidade de campo 

 (Experimento de 10/05/2017) 

Imagem 

 

fCO  (pc) 

IMG_2137 

?b = 0,1158 % 

?VFTools = 0,056 % 

IMG_2142 

?b = 0,1158 % 

?VFTools = 0,057 % 

IMG_2143 

?b = 0,1158 % 

?VFTools = 0,054 % 

IMG_2148 

?b = 0,193 % 

?VFTools = 0,1006 % 

2,83 (10 mm) 0,1585 % (37%) 0,1613 % (39 %) 0,1528 % (32 %) 0,2847 % ( 48%) 

2,39 (11 mm) 0,1338 % (16%) 0,1362  % (18 %) 0,1291 % (11 %) 0, 2404 % (25 %) 

2,07 (12 mm) 0,1159  % (0,1%) 0,1180  % (2 %) 0,1118 % (3,5 %) 0, 2082 % (8 %) 

1,83 (13 mm) 0,1025 % (11 %) 0,1043 % (10  %) 0, 0988% (15 %) 0,0,1841 % (4,6%) 

1,63 (14 mm) 0,0913  % (21 %) 0,0929 % (20 %) 0,0,088% (24%) 0,164 % (15%) 

 

Dessas tabelas foi também possível observar a diferença relativa entre os 

resultados da bancada de calibração e os valores estimados pelo sistema VFTools 

corrigidos pelos fatores de correção ótica. As menores diferenças ocorreram sob condições 

em que estes resultados foram calculados utilizando um fator de correção que sugeriria 

uma profundidade de campo oscilante entre 12 e 13 mm se o fator de correção 

correspondesse unicamente à profundidade de campo.  Estes valores induzem à condição 

de que, independente da seleção na profundidade de campo, os fenômenos óticos que 

ocorrem durante o experimento exercem grande influência sobre as imagens posicionadas 

posteriormente à uma distância fixa. Esta influência pode estar relacionada às 

características físicas da tubulação de vidro utilizada no experimento.  

 

 



 

141 

 

 

 

6 CONCLUSÕES 

 

Foi desenvolvido um sistema computacional utilizando novas metodologias 

para mensuração da fração de vazio a partir de imagens digitais de escoamento bifásico.  

Denominado VFTools por se tratar de uma sigla com menção à Void Fraction Tools ou 

Ferramentas de Fração de Vazio, este sistema contém, como seu próprio nome sugere, um 

conjunto de ferramentas aplicáveis à realização da estimativa da fração de vazio em 

escoamentos cujos objetos de interesse na imagem analisada contenham contornos com 

configurações elípticas ou circulares em sua geometria. As ferramentas podem ser 

utilizadas para uso isolado ou em conjunto, numa sequência de processos destinados ao 

cálculo da fração de vazio. 

O emprego do sistema VFTools em imagens reais do escoamento bifásico, 

obtidas em circuito experimental existente no Centro de Engenharia Nuclear do IPEN-SP, 

mostrou-se com uma eficiência próxima de 100% no reconhecimento das bolhas de 

interesse (dentro do limite experimental definido na aquisição de imagens) em imagens de 

escoamentos com baixas frações de vazio e 100% preciso nos resultados de estimativa das 

medidas geométricas associadas a elas. Estes ótimos resultados do sistema sugerem que 

parte das técnicas utilizadas possa ser aplicada em outras áreas de conhecimento que 

necessitem mensurar cientificamente estruturas com objetos com geometria elíptica.  

O método integrou de forma inédita, num sistema de varredura pixel a pixel, 

um conjunto de redes neurais artificiais e uma forma modificada da transformada 

randomizada de Hough. Além desta complexa integração, o sistema VFTools incluiu um 

pré-processamento da imagem para treinamento das redes neurais que permitiu uma 

detecção das bolhas de acordo com um procedimento experimental que limitou a aquisição 

das imagens a uma faixa pré-determinada de foco.  

Apesar de haver necessidade de maior automatização do sistema em sua fase 

de treinamento, o núcleo da detecção e segmentação da imagem pode ser utilizado em 

muitas outras aplicações. Destacam-se como exemplo, projetos de mensuração de materiais 

compostos utilizando fibras de carbono com geometrias semelhantes, aplicações na área de 

transporte de fluídos por longas distâncias (transporte de petróleo via oleodutos), sistemas 



 

142 

 

de refrigeração de componentes eletrônicos, refrigeração de sistemas de geração de energia 

solar e aplicações geotérmicas, além de sua aplicação nos sistemas de resfriamento nuclear. 

Outra importante área com potencial de aplicação, é a utilização do sistema em imagens 

médicas, onde se encontram muitas imagens digitalizadas de estruturas biológicas com esta 

geometria. 

O sistema de votação desenvolvido neste trabalho para a utilização da 

transformada de Hough merece ser destacado pois, abre um novo campo de estudos desta 

transformada que vem crescendo sua utilização, tanto pelo aumento da capacidade de 

processamento dos novos hardwares, como pela simplificação de sua implementação que 

vem sendo alcançada pelos trabalhos mais recentes. A otimização do algoritmo 

possibilitaria sua utilização com maior velocidade. Um estudo mais aprofundado e 

específico das velocidades computacionais envolvidas com a utilização dos parâmetros já 

existentes deve ser desenvolvido em breve. 

Por ser um sistema muito complexo, envolvendo diferentes fases de 

desenvolvimento, ainda apresentou tempos de processamento computacional da ordem de 

2 a 4 horas para execução do sistema sobre uma imagem quando utilizando máscaras de 

maiores dimensões (acima de 2000 pixels). Pela mesma complexidade, o método se 

mostrou profícuo em abertura de novos campos de pesquisa, especialmente quanto à 

integração do uso de redes neurais artificiais com a transformada de Hough quando 

aplicadas convolucionalmente a uma imagem. 

A concepção e implementação do VFTools foi realizada em fases distintas que 

resultaram em um sistema composto por três aplicações contendo funcionalidades que o 

habilitam à execução dos seguintes processos: 

? adequação e seleção de uma amostra do escoamento bifásico a partir de 

imagens digitais capturadas de circuitos experimentais por imageamento 

direto (aplicação selecTool); 

? seleção e classificação, via máscara virtual de varredura progressiva 

previamente dimensionada, de subimagens da amostra do escoamento 

bifásico para a construção de uma base de treinamento de uma rede neural 

artificial com a criação de arquivos (aplicação maSamTool); 

? revisão e organização do arquivo de amostras de treinamento da rede neural 

artificial através da reclassificação, exclusão e reordenação das amostras de 



 

143 

 

treinamento e de suas correspondentes classificações (aplicação 

saManTool); 

? treinamento da rede neural artificial construída para a detecção de bolhas 

com dimensões menores, ou compatíveis, que as fixadas para a máscara 

virtual de varredura progressiva empregada na construção do arquivo de 

amostras de treinamento. Avaliação da qualidade do treinamento com a 

execução da rede neural sobre as próprias subimagens da amostra de 

treinamento (aplicação maSamTool); 

? redução do número de detecções de "falso-positivos" pela rede neural via 

ajustes de limiares de classificação (aplicação maSamTool); 

? execução da rede neural sobre uma amostra volumétrica de escoamento 

bifásico com máscara virtual de varredura progressiva com dimensões fixas 

e em conjunto com a função "rht_center". Esta última, executa a 

transformada randomizada de Hough modificada e presta-se à ocultação da 

imagem das bolhas detectadas, em foco e dentro dos limites da máscara de 

varredura da amostra do escoamento bifásico (aplicação maSamTool 

integrada com a função rht_center). Este processo integrado tem o objetivo 

de limpeza da imagem da amostra volumétrica do escoamento bifásico 

através da exclusão da imagem das bolhas detectadas com dimensões 

menores que os definidos pela máscara virtual de varredura progressiva. Ele 

presta-se à preparação desta imagem para ser novamente utilizada na 

construção de um novo arquivo de amostras de treinamento empregando 

uma máscara virtual com dimensões maiores e 

? execução da rede neural artificial integrada com a transformada 

randomizada de Hough na detecção progressiva das bolhas em uma amostra 

de escoamento para cálculo do volume de gás nesta amostra e consequente 

cálculo da fração de vazio (aplicação maSamTools em composição com a 

função rht_center). 

O desempenho e eficiência das aplicações foram sendo constatadas ao longo do 

desenvolvimento deste trabalho. Os resultados obtidos progressivamente indicaram 

interpretações e compreensões não previstas inicialmente sobre as condições envolvidas na 

execução dos experimentos. O cálculo da fração de vazio foi feito para um pequeno 

conjunto de amostras, mas que apesar de pequeno, permitiu o estabelecimento de novos 



 

144 

 

parâmetros para avaliar a correspondência entre a profundidade de campo utilizada para 

aquisição e sua correspondência na avaliação pelo sistema. Outros fatores óticos 

envolvidos no experimento podem ser também avaliados utilizando este sistema, como o 

grau de uniformidade da iluminação de fundo (background). O sistema VFTools mostra-se 

bastante útil e eficaz para a realização destas análises uma vez que permitiria a elaboração 

de um mapeamento desses fatores associadas à diversas variáveis descritivas de 

configurações dos experimentos na própria bancada de calibração da fração de vazio. 

Os resultados obtidos pelo VFTools, sobre as imagens do escoamento 

capturadas da bancada experimental de calibração, mostraram-se precisos com dispersões 

inferiores à 10% quando comparadas aos resultados experimentais aferidos via diferencial 

de pressão. Com base nestes resultados pode-se também concluir que o refinamento na 

aquisição das imagens resultaria em resultados mais precisos. A incerteza nas medições da 

fração de vazio via bancada de calibração exerceram um papel significativo na 

interpretação dos resultados em virtude de sua ordem de grandeza estar compatível dos 

valores constatados e estimados da fração de vazio. O emprego de condições mais estritas 

na técnica experimental do processo de calibração utilizando o método gravimétrico pode 

vir a melhorar precisão das estimativas do sistema. Entre estas melhorias do método de 

calibração estão: o aumento do paralelismo nos feixes de luz de fundo, o uso de cabines 

escuras no imageamento e o aumento do sincronismo entre os instantes de aquisição das 

imagens do escoamento bifásico e do painel de pressão. 

A execução da rede neural artificial sobre uma amostra de imagem do 

escoamento bifásico é realizada em conjunto com uma máscara virtual de varredura 

progressiva responsável pela captura de uma subimagem do escoamento bifásico limitada 

às suas dimensões. A progressão desta máscara ocorre coluna a coluna sobre cada linha da 

amostra e em cada progressão é executada a rede neural para reconhecimento de bolhas 

nos limites da sub imagem definida pelas dimensões dessa máscara. O número de 

execuções da rede neural artificial é extremamente grande diante do número de bolhas a 

serem detectadas nas amostras volumétricas de imagem do escoamento. Isto resultou em 

um número excessivo de "falso-positivos" na identificação. O emprego de ajustes nos 

limiares para classificação na saída da rede neural artificial mostrou-se eficiente, porém, 

não suficiente para suprir esta deficiência na utilização da rede neural. Sendo assim, 

pode-se concluir também que a associação dos resultados da rede neural artificial com os 

resultados obtidos pela aplicação da transformada randomizada de Hough conduziram a 



 

145 

 

resultados muito mais eficientes e precisos com poucos erros de detecção. Conclui-se ainda 

que o sucesso desta integração se deve também ao limiar de 60% sobre o número de pixels 

de borda sobre a elipse ou circunferência descrita analiticamente sobre a borda da imagem 

detectada e à implementação de um rigoroso processo de votação e combinação dos 

demais parâmetros dessas figuras geométricas que melhor se ajustem às bordas detectadas. 

As melhorias implementadas à transformada randomizada de Hough e a integração de seu 

uso com a rede neural artificial incrementaram a robustez no cálculo da fração de vazio e 

por conseguinte, a precisão dos resultados.   

Embora raras, ocasiões como esta ocorreram na detecção de "falso-positivos" 

envolvendo a composição de duas ou mais sombras espessas de bolhas e sobrepostas. A 

composição destas sobreposições resulta em partes de imagens com valores de intensidade 

negativa de cinza maiores, mesmo na ocorrência das duas ou mais bolhas estarem fora da 

profundidade de campo na aquisição da imagem. O formato desta região com valores 

maiores de intensidade negativa de cinza pode coincidir com modelos de figuras analíticas 

elípticos ou circulares. A aplicação do operador Canny sobre elas resultaria na detecção de 

bordas com estas formas e, por conseguinte, detectadas como bolhas. A aplicação da 

transformada randomizada de Hough, mesmo com a evolução da versão modificada nesse 

trabalho, não seria capaz de evitar esta identificação. As figuras, ou partes delas seriam 

eliminadas das imagens e com seus volumes adicionados incorretamente ao do total de 

gases na amostra.  

Algumas opções poderiam contribuir na melhoria desses resultados. A primeira 

delas é a identificação e aplicação de modelos diferenciados de varreduras que resultem em 

uma significativa redução do número de execuções da rede neural artificial sobre uma 

amostra da imagem do escoamento. Isto poderia ser suficiente na solução deste problema 

uma vez que haveria uma grande redução na detecção de "falso-positivos". Uma segunda 

opção é a realização de estudos mais detalhados sobre uma configuração otimizada da rede 

neural pela sua composição com um modelo de extração de características ou por uma 

minuciosa investigação sobre sua arquitetura. A terceira e última opção seria o uso de uma 

rede neural com funções de base radial (RBF), também indicada para reconhecimento de 

padrões complexos. A realização da captura de imagens do escoamento sincronizadas, sem 

distorções óticas devido a introdução de uma caixa para correção visual do escoamento, 

também é uma opção realizável, no entanto, deve-se relevar que as imagens capturadas 

com o uso deste recurso requer sua composição com imagens de outra vista do 



 

146 

 

escoamento. Esta composição traria uma visão tridimensional do escoamento e poderiam 

minimizar o erro das estimativas da fração de vazio em escoamentos bifásicos. Estes 

estudos requerem um grande esforço no desenvolvimento de técnicas de composição de 

imagens bidimensionais, no entanto, representaria uma expectativa por resultados 

extremamente precisos deste importante parâmetro proporcionando mais uma grande 

evolução nos estudos do escoamento bifásico. 

 



 

147 

 

 

 

REFERÊNCIAS BIBLIOGRÁFICAS 

 

ATTAWAY,STORMY. MATLAB: a practical introduction to programming and 

problem solving.2. ed. Elsevier: Oxford, 2012 

 

BARBOSA, P.R.; CRIVELARO,K.C.O.; SELEGHIM JR., PAULO. On the Application of 

Self-Organizing Neural Networks in Gas-Liquid and Gas-Solid Flow Regime 

Identification. In.: J. of the Braz. Soc. of Mech. Sci. &amp;amp; Eng. - Vol. XXXII, March, 2010. 

 

BARBOSA JR., JADER R.. Introdução aos escoamentos bifásicos gás-liquido. Apostila 

do curso ministrado na EBEM: Escola Brasileira de Escoamentos Multifásicos, UTFPR: 

Universidade Tecnológica Federal do Paraná - Curitiba, 2012. 

 

BASAK, JAYANTA; PAL, SANKAR K.. Theoretical quantification of shape distortion in 

fuzzy Hough transform. Fuzzy Sets and Systems. N. 154, p. 227-250, 2005. 

 

BHARDWAJ, SAKET; MITTAL, AJAY. A survey on various edge detector techniques. 

Procedia Technology. N.4, p. 220 - 226, 2012. 

 

BOURE, J.A.;BERGLES, A.E.; TONG, L.S..Review of two-phase flow instability. 

Nuclear Engineering and Design. N. 25, pg. 165-192, 1973. 

 

BUENO, RÉGIS CORTEZ. Detecção de contornos em imagens de padrões de 

escoamento bifásico com alta fração de vazio em experimentos de circulação natural 

com o uso de processamento inteligente. Tese (Doutorado). Instituto de Pesquisas 

Energéticas e Nucleares, 2016. 

 

CHENG, H.D.; GUO, YANHUI; ZHANG, YINGTAO. A novel Hough transform based 

on eliminating particle swarm optimization and its applications. Pattern Recognition 42 

p.1959-1969, 2009. 

 

CLEVELAND, J.; CHOI,J. H.. Passive Safety Systems and Natural Circulation in Water 

Cooled Nuclear Power Plants. IAEA TECDOC-1624, Viena – 2009, ISBN 978–92–0–

111309–2. 

 

CRIVELARO, K. C. O.; SELEGHIM JR., P. Detection of Horizontal Two-Phase Flow 

Patterns Through a Neural Network Model. Journal of the Brazilian Society of 

Mechanical Sciences, Rio de Janeiro, Brazil, March-2002. 

 

DAVE, RAJESH N.; BHASWAN,KURRA. Adaptive Fuzzy c-Shells Clustering and 

Detection of Ellipses. IEEE transactions on neural networks,vol. 3, n.5, Setembro, 1992. 

 

DAVIES, E. R..A high speed algorithm for circular object location. Pattern Recognition 

Letters 6, pp. 323-333, 1987. 

 



 

148 

 

DE MESQUITA, R.N. et al., Classification of natural circulation two-phase flow patterns 

using fuzzy inference on image analysis. Nuclear Engineering and Design 250, p. 592-

599, 2012. 

 

ELSALAMONY, HANY A.. Healthy and unhealthy red blood cell detection in human 

blood smears using neural networks. Micron 83, p.32-41, 2016. 

 

FICHERA, A.; MUSCATO, G.; XIBILIA, M. G.; PAGANO, A..Modeling Unstable 

Behavior of a Natural Circulation Loop with a Neural Network. IEEE-200, p. 75-80, 

2000. 

 

GONZALEZ, RAFAEL E.; WOODS, Richard E..Digital image processing. 3. ed., New 

Jersey: Pearson Education, 2008. 

 

GONZALEZ, RAFAEL E.; WOODS, Richard E..Digital image processing: using 

MATLAB. 2. ed., Gatesmark, 2009. 

 

GOUDARZI, N.; TALEBI, S.. Improving performance of two-phase natural circulation 

loops by reducing of entropy generation. Energy 93 p. 882-899, 2015. 

 

GUIAASIAN, S.M..Two-phase flow, boiling and condensation in conventional and 

miniature systems. Cambridge University, 2007. 

 

HAN, JOON H.; KÓCZY,LÁSZLÓ T.; POSTON, TIMOTHY. Fuzzy Hough transform. 

Pattern Recognition Letters, 15, p. 649 - 658, July 1994. 

 

HAYKIN, SIMON. Redes Neurais: princípios e prática. trad. Paulo Martins Engel, 2. 

ed., Porto Alegre: Bookman, 2001. 

 

INVERSO, SAMUEL. Ellipse detection using randomized Hough transform.Technical 

Report, Department of Computer Science, Rochester Institute of Technology, New York, 

2002. 

 

JAIN, ANIL K.; MAO, JIANCHANG; MOHIUDDIN, K. M.. Artificial Neural Networks: 

A Tutorial. Computer, IEEE, 1996. 

 

JAN, FARMANULLAH; USMAN, IMRAN; AGHA,SHAHRUKH. Reliable iris 

localization using Hough transform, histogram-bisection and eccentricity. Signal 

Processing 93 p. 230-241, 2013. 

 

KROTKOV, ERIC. Focusing. International Journal of Computer Vision, 1 p. 223 - 237, 

1987. 

 

KUDARIYAWAR, JAYARAJ YALLAPPA; VAIDYA, ABHIJEET MOHAN; 

MAHESHWARI, NARESH KUMAR; SATYAMURTHY, POLEPALLE. Computational 

study of instabilities in a retangular natural circulation loopusing 3D CFD simulation. 

International Journal of Thermal Sciences 101 p. 193 - 206, 2016. 

 

KUMAR, MUKESH; PAL, ESHITA; NAYAK, ARUN K.; VIJAYAN, PALLIPATTU K.. 

Conceptual design of a passive moderator cooling system for a pressure tube type natural 



 

149 

 

circulation boiling water cooled reactor. In.: Nuclear Engineering and Design 219, p. 

261 - 270, 2015. 

 

LENT, CRAIG S..Learning to program with MATLAB: building GUI tools.New Jersey: 

John Wiley &amp;amp; Sons, 2013. 

 

MASOTTI, PAULO HENRIQUE FERRAZ; MESQUITA, ROBERTO NAVARRO. 

Paraconsistent logic study of image focus in cylindrical refraction experiments. In.: 

Paraconsistent Intelligent-Based Systems.1. ed., p. 175-205, 2015. 

  

MCLAUGHLIN, ROBERT A.. Randomized Rough Transform: Improved ellipse detection 

with comparison. Pattern Recognition Letters, 19 p. 299-305, 1998. 

 

MCLAUGHLIN, ROBERT A..Intelligent algorithms for finding curves and surfaces in 

real world data. PhD Thesis. Department of Electrical and Electronic Engineering - 

University of Western Australia. Crawlei, Australia, 2000. 

 

MEHTA, AXAY; MEHTA, HEMA A.; MANJUNATH, T.C.; ARDIL, C.. A Multi-Layer 

Artificial Neural Network Architecture Design for Load Forecasting in Power System. 

In.: International Journal of Applied Mathematics and Computer Sciences. n 4 - v 4, 

2006. 

 

MENDEL, JERRY M..Fuzzy logic systems for engineering: a tutorial. In.: Proceedings 

of IEEE v. 83 n. 3, Março, 1995. 

 

MESQUITA, R.N. et al.. Two-Phase Flow Patterns Recognition and Parameter 

Estimation through Natural Circulation Test Loop Image Analysis. Proc. 7th ECI 

International Conference on Boiling Heat Transfer (ICBHT 2009), Florianópolis-SC-

Brazil, 3-7 May, p.541-546, ISBN: 978-1-61567-794-8 2009. 

 

MICHÉ,P.; DEBRIE, R.. Fast and self-adaptive image segmentation using extended 

declivity. Ann. Télécommun., 50, n.3-4, p. 401-410, 1995. 

 

MUCKHOPADHYAY, PRIYANKA; CHAUDHURI, BIDYUT B.. A survey of Hough 

transform. Pattern Recognition 48, p. 993-1010, 2015. 

 

NAYAK, A.K. et al. Study on the stability behavior of two-phase natural circulation 

systems using a four-equation drift flux model. Nuclear Engineering and Design, 237, 

p.386-398, 2007. 

 

NIXON, MARK. Improving an extended version of the Hough transform. Signal 

Processing 19, p. 321-335, Elsevier, 1990. 

 

NG, ANDREW. Machine Learning. Curso a distância ministrado no período de Setembro 

a Novembro de 2011. disponível em&amp;lt;https://www.coursera.org/ #course/ml&gt;, Stanford 

University, 2011. 

 

RICCA, GIORGIO; BELTRAMETTI, MAURO C.; MASSONE, ANNA MARIA. 

Detecting curves of symmetry in images via Hough transform. Mathematics in Computer 

Science 10, p. 179-205. Março, 2016. 



 

150 

 

 

ROCHA, MARCELO DA SILVA. Projeto, construção e análise de um sensor de 

impedância de múltiplos eletrodos aplicado à medição da fração de vazio em 

escoamentos bifásicos do tipo gás-líquido. Tese (Doutorado), Escola Politécnica da 

Universidade de São Paulo, 2005. 

 

ROTHMAN, PAULA. Angra pode virar uma nova Fukushima ou Chernobyl ? 

Disponível em:&amp;lt;http://exame.abril.com.br/tecnologia/angra-pode-virar-uma-nova-

fukushima-ou-chernobyl/&gt;. Acesso em: 27 de Dezembro de 2016. 

 

RUSPINI, LEONARDO CARLOS; MARCEL, CHRISTIAN PABLO; CLAUSSE, 

ALEJANDRO. Two-phase flow instabilities: A review. International Journal of Heat 

and Mass Transfer. N. 71, pg. 521 - 548, 2014. 

 

SAITO,Y.; SEKIMOTO, S.; HINO, M.; KAWABATA, Y.. Development of neutron 

radiography facility for boiling two-phase flow experiment in Kyoto University Research 

Reactor. Nuclear Instruments and Methods in Physics Research. 651, p. 36-41, 2011. 

 

SCHLEGEL,J.P.; SAWANT,P.; PARANJAPE,S.;OZAR,B.; HIBIKI,T.; ISHII,M.. Void 

fraction and flow regime in adiabatic upward two-phase flow in large diameter vertical 

pipes. Nuclear Engineering and Design. 239, p. 2864-2874, 2009. 

 

SMITH,T.R.;SCHLEGEL,J.P.;HIBIKI,T.;ISHII,M..Two-phase flow structure in large 

diameter pipes. International Journal of Heat and Fluid Flow. 33, p. 156-167, 2012. 

 

STROKINA, NATALIYA; MATAS, JIRI; EEROLA, TUOMAS; LENSU, LASSE; 

HEIKKI KÄLVIÄINEN. Detection of bubbles as concentric circular arrangements. 

Machine Vision and Application 27, p. 387-396. Fevereiro, 2016. 

 

SUNDE, CARL; AVDIC, SENADA; PÁZSIT, Imre. Classification on Two-Phase Flow 

Regimes Via Image Analysis and a Neuro-Wavelet Aproach. Progress in Nuclear Energy. 

Grã Bretanha, v.46, n. 3-4, p. 348-358, 2005. 

 

SURAL, SHAMIK; DAS, P. K.. Fuzzy Hought transform and MLP with fuzzy 

input/output for character recognition. Fuzzy Sets and Systems, 105, p. 489 - 497, 1999. 

 

TENG, ZHU; KIM, JEONG-HYUN; KANG, DONG-JOONG. Ellipse detection: a simple 

and precise method based on randomized Hough transform. Optical Engineering. Vol. 

51(5), Maio de 2012. 

 

TERREMOTO, LUÍS ANTÔNIO ALBIAC.Reatores nucleares de potência. Slides de 

aula proferida no curso de Fundamentos de Tecnologia Nuclear - Reatores. Instituto de 

Pesquisas Energéticas e Nucleares, São Paulo, 2012. 

 

TSUJI, SABURO; MATSUMOTO,FUMIO. Detection of ellipses by a modified Hough 

transform. IEEE trans. Computer C-27(8), pp. 777-781, 1978. 

 

UCHIMURA, KEIICHI; HARVEL, GLENN D.; MATSUMOTO, TAKAAKI; 

MASAYUKI, KANZAKI; CHANG, JEN-SHIH. An image processing approach for two-



 

151 

 

phase interfaces visualized by a real time neutron radiography technique. Flow 

Measurement and Instrumentation 9, p. 203-210, 1998. 

 

WANG, HONGYI; DONG, FENG. Image Features Extraction of Gas/liquid Two-Phase 

Flow in Horizontal Pipeline by GLCM and GLGCM. In: THE NINETH 

INTERNATIONAL CONFERENCE ON ELETRONIC MEASUREMENT &amp;amp; 

INSTRUMENT-ICEMI' 2009, v.2, p.135-139. ISBN.: 978-1-4244-3864-8 IEEE-2009. 

 

WENYIN, ZHANG; NINGDE, JIN; XIA, LIN; ZHIQIANG, NIE. Bubble image 

segmentation of gas/liquid two-phase flow based on improved Canny operator. 
Proceedings of International Conference on Computer Science and Software Engineering, 

IEEE, 2008. 

 

WHALLEY, P.B..Two-Phase Flow and Heat Transfer. Oxford University, New York, 

1996. 

 

WOLDESEMAYAT, MELKAMU A.; GHAJAR, AFSHIN J. Comparison of void fraction 

correlations for different flow patterns in horizontal and upward inclined pipes. 

International Journal of Multiphase Flow, v. 33, p. 347-370, 2007. 

 

WOLINSKI, ALAN EDUARDO. Fissão ou fusão nuclear ? Qual a diferença ?. 

Disponível em:&amp;lt;http://parquedaciencia.blogspot.com.br/2013/09/fissao-ou-fusao-nuclear-

qual-diferenca.html&gt;. Acesso em: 27 dez 2016.  

 

XU,LEI; OJA, ERKKI; KULTANEN, PEKKA. A new curve detection method: 

Randomized Hough Transform (RHT). Pattern Recognition Letters 11, p. 331-338, 

North-Holland, 1990. 

 

XU,LEI; OJA, ERKKI. Randomized Hough Transform (RHT): basic mechanisms, 

algorithms, and computational complexities. CGVIP: Image Understanding v. 57, n. 2, 

p. 131-154, 1993. 

 

YIP, RAYMOND K. K.; TAM, PETER K. S. e LEUNG, DENNIS N. K.. Modification of 

Hough transform for circles and ellipses detection using a 2-dimensional array. Pattern 

Recognition, v. 25 n. 9 p. 1007-1022, Grã-Bretanha:1992. 

 

YOO, JAE HUNG; SETHI, ISHWAR K.. An ellipse detection method from the polar and 

pole definition of conics. Pattern Recognition v. 26 n.2 p. 307-315. Great Britain, 1993. 

 

YU, HAIBIN; LIU, JINGBIAO; HE ZHIWEI. A Modified RHT Method for Ellipse 

Detection Based on Geometric Constraints and Perceptual Grouping. In.: The 3rd 

International Conference on Innovative Computing Information and Control - ICICIC'08, 

IEEE, 2008. 

 

YUEN, H. K.; ILLINWORTH, J.; KITTLER, J.. Detecting partially occluded ellipses 

using the Hough transform. Image and vision computing v. 7, n.1 p. 31-36, Fevereiro, 

1989. 

 

 



 

152 

 

ZHANG, JIAN; SHEN, XIUZHONG; FUJIHARA, YASUYUKI; SANO, TADAFUMI; 

YAMAMOTO, TOSHIHIRO; NAKAJIMA, KEN. Experimental study on the safety of 

Kyoto University Research Reactor at natural circulation cooling mode. Annals of 

Nuclear Energy, 76, p. 410-420, 2015. 

 

ZHANG, WEN-HUI; JIANG, XIAOYA; LIU, YIN-MINGZI. A method for recognizing 

overlapping elliptical bubbles in bubble image. Pattern Recognition Letter 33, 

p. 1543-1548, 2012. 

 



 

153 

 

 

APÊNDICE A -Base de dados de imagens digitais do escoamento bifásico 

 

Foram considerados dois experimentos nos cálculos para estimativa da fração 

de vazio. A bancada de calibração da fração de vazio empregada na realização desses 

experimentos eram similares, porém, pequenas diferenças existiam entre elas. O fator que 

mais interferiu nestes diferentes experimentos foi a variação na iluminação de fundo, 

requerendo novas análises para obtenção dos parâmetros empregados no Sistema de 

Inferência Focal Fuzzy. Além da aplicação dessas imagens nos cálculos e calibração das 

aplicações para cálculo da estimativa da fração de vazio, as imagens organizadas e 

apresentadas nas tabelas, prestaram-se à realização das análises dos parâmetros 

relacionados ao perfil das bordas das bolhas empregados no Sistema de Inferência Focal 

Fuzzy.  

As imagens dos experimentos foram organizadas e separadas conforme 

descrição: 

? Experimento realizado em 24/10/2013: Imagens e arquivos 

correspondentes estão organizados nas tabelas 1A a 5A e  

? Experimento realizado em 10/05/2017: Imagens e arquivos 

correspondentes estão organizados na tabela 6A. 

 

TABELA 1A - Imagens digitais do escoamento bifásico - 24/10/2013 

 
IMG_0740.JPG 

 
IMG_0741.JPG 

 
IMG_0742.JPG 

 
IMG_0743.JPG 

 
IMG_0744.JPG 

 
IMG_0745.JPG 

 
IMG_0746.JPG 

 
IMG_0747.JPG 

 
IMG_0748.JPG 

 
IMG_0749.JPG 

 
IMG_0750.JPG 

 
IMG_0751.JPG 

 

 

 



 

154 

 

TABELA 2A - Imagens digitais do escoamento bifásico - 24/10/2013 (Continuação) 

 
IMG_0752.JPG 

 
IMG_0753.JPG 

 
IMG_0754.JPG 

 
IMG_0755.JPG 

 
IMG_0756.JPG 

 
IMG_0757.JPG 

 
IMG_0758.JPG 

 
IMG_0759.JPG 

 
IMG_0760.JPG 

 
IMG_0761.JPG 

 
IMG_0762.JPG 

 
IMG_0763.JPG 

 
IMG_0764.JPG 

 
IMG_0765.JPG 

 
IMG_0766.JPG 

 
IMG_0767.JPG 

 
IMG_0748.JPG 

 
IMG_0749.JPG 

 
IMG_0750.JPG 

 
IMG_0751.JPG 

 
IMG_0752.JPG 

 
IMG_0753.JPG 

 
IMG_0754.JPG 

 
IMG_0755.JPG 

 
IMG_0756.JPG 

 
IMG_0757.JPG 

 
IMG_0758.JPG 

 
IMG_0759.JPG 

 
IMG_0760.JPG 

 
IMG_0761.JPG 

 
IMG_0762.JPG 

 
IMG_0763.JPG 

 
IMG_0764.JPG 

 
IMG_0765.JPG 

 
IMG_0766.JPG 

 
IMG_0767.JPG 

 

 

 



 

155 

 

TABELA 3A - Imagens digitais do escoamento bifásico - 24/10/2013 (Continuação) 

 
IMG_768.JPG 

 
IMG_769.JPG 

 
IMG_770.JPG 

 
IMG_771.JPG 

 
IMG_772.JPG 

 
IMG_773.JPG 

 
IMG_775.JPG 

 
IMG_776.JPG 

 
IMG_0777.JPG 

 
IMG_0778.JPG 

 
IMG_0779.JPG 

 
IMG_0780.JPG 

 
IMG_0781.JPG 

 
IMG_0782.JPG 

 
IMG_0783.JPG 

 
IMG_0784.JPG 

 
IMG_0785.JPG 

 
IMG_0786.JPG 

 
IMG_0787.JPG 

 
IMG_0788.JPG 

 
IMG_0789.JPG 

 
IMG_0790.JPG 

 
IMG_0791.JPG 

 
IMG_0792.JPG 

 
IMG_0793.JPG 

 
IMG_0794.JPG 

 
IMG_0795.JPG 

 
IMG_0796.JPG 

 
IMG_0797.JPG 

 
IMG_0798.JPG 

 
IMG_0799.JPG 

 
IMG_0800.JPG 

 
IMG_0801.JPG 

 
IMG_0802.JPG 

 
IMG_0803.JPG 

 
IMG_0804.JPG 

 

 

 



 

156 

 

TABELA 4A - Imagens digitais do escoamento bifásico - 24/10/2013 (Continuação) 

 
IMG_805.JPG 

 
IMG_806.JPG 

 
IMG_807.JPG 

 
IMG_808.JPG 

 
IMG_809.JPG 

 
IMG_810.JPG 

 
IMG_811.JPG 

 
IMG_812.JPG 

 
IMG_0817.JPG 

 
IMG_0818.JPG 

 
IMG_0819.JPG 

 
IMG_0820.JPG 

 
IMG_0821.JPG 

 
IMG_0822.JPG 

 
IMG_0823.JPG 

 
IMG_0824.JPG 

 
IMG_0825.JPG 

 
IMG_0826.JPG 

 
IMG_0827.JPG 

 
IMG_0828.JPG 

 
IMG_0829.JPG 

 
IMG_0830.JPG 

 
IMG_0831.JPG 

 
IMG_0832.JPG 

 
IMG_0833.JPG 

 
IMG_0834.JPG 

 
IMG_0835.JPG 

 
IMG_0836.JPG 

 
IMG_0837.JPG 

 
IMG_0838.JPG 

 
IMG_0839.JPG 

 
IMG_0840.JPG 

 
IMG_841.JPG 

 
IMG_842.JPG 

 
IMG_843.JPG 

 
IMG_844.JPG 

 

 

 



 

157 

 

 

TABELA 5A - Imagens digitais do escoamento bifásico - 24/10/2013 (Continuação) 

 
IMG_845.JPG 

 
IMG_846.JPG 

 
IMG_847.JPG 

 
IMG_848.JPG 

    

 
IMG_0849.JPG 

 
IMG_0850.JPG 

 
IMG_0851.JPG 

 
IMG_0852.JPG 

 

 

TABELA 6A - Imagens digitais do escoamento bifásico - 10/05/2017 

    
IMG_2130.JPG IMG_2131,JPG IMG_2132.JPG IMG_2133.JPG 

    
IMG_2134.JPG IMG_2135.JPG IMG_2136.JPG IMG_2137.JPG 

    
IMG_2138.JPG IMG_2139.JPG IMG_2140.JPG IMG_2141.JPG 

    
IMG_2142.JPG IMG_2143.JPG IMG_2144.JPG IMG_2145.JPG 

    
IMG_2146.JPG IMG_2147.JPG IMG_2148.JPG IMG_2149.JPG 

    
IMG_2150.JPG IMG_2151.JPG IMG_2152.JPG IMG_2153.JPG 

 



 

158 

 

 

 

APÊNDICE B - ANÁLISE ESTATÍSTICA DOS PERFÍS DE BORDAS 

 

A definição dos valores empregados na construção das funções de pertinência 

do sistema de inferência focal fuzzy foram baseadas em análises sobre as variáveis 

indicadas por KROTKOV (1987) para composição de uma relação entre a qualidade da 

imagem e a profundidade de campo. Parâmetros de segmentação de imagens como a 

intensidade de cinza, o Laplaciano e Sobel sobre uma imagem são fatores chaves para 

estabelecer uma relação entre os pixels da imagem posicionados dentro de uma região 

limitada pela profundidade de campo em que a imagem foi capturada . As análises foram 

divididas em dados coletados experimentalmente e tratam de um levantamento estatístico 

sobre quatro perfis de bordas de bolhas consideradas em foco e fora de foco. No 

experimento de 24/10/2013 foram coletadas bordas de 48 bolhas consideradas "em foco" e, 

portanto, dentro da profundidade de campo estabelecida na aquisição da imagem e bolhas 

"fora de foco" que são consideradas em posições além deste limite de profundidade. O 

resultado do levantamento dos 192 perfís de bordas foram organizados em tabelas para 

cálculo da média e do desvio padrão global de cada parâmetro.  

A tabela 1B representa a compilação de todos os parâmetros extraídos das 

quatro bordas de cada uma das 48 bolhas selecionadas para análise. Ela está dividida em 24 

"bolhas em foco" e  24 "bolhas fora de foco". As bolhas consideradas em foco são aquelas 

dentro dos limites da profundidade de campo em que as imagens do escoamento bifásico 

foram capturadas. Caso contrário a bolha será considerada fora de foco. Para cada bolha 

analisada, foi calculada a variação dos parâmetros considerados no modelo de inferência 

focal fuzzy em função do perfil médio de cada uma das suas bordas, ou seja, da borda 

superior, direita esquerda e inferior. Estes valores foram compilados e estão expostos na 

tabela que ao final apresenta o cálculo da média global de cada um dos parâmetros 

combinados, ou seja: 

? Laplaciano adicionado à intensidade negativa de cinza: Lap+(1-I); 

? Sobel adicionado à intensidade negativa de cinza: Sob+(1-I) e 

? Intensidade de cinza. 

 

 



 

159 

 

TABELA 1B - Análise estatística das bordas das bolhas - experimento de 23/10/2013 

 

 

Lap+(1-I) Sob+(1-I) I Lap+(1-I) Sob+(1-I) I

0,44940 0,66206 0,44215 0.41477 0,34296 0,48912

0,58371 0,50716 0,28710 0,47595 0,38676 0,42204

0,51388 0,52645 0,40625 0,45017 0,35326 0,45044

0,63290 0,59634 0,24722 0,30459 0,16071 0,61591

0,60552 0,42128 0,36195 0,49564 0,29611 0,47191

0,59090 0,48681 0,37021 0,43161 0,21699 0,54634

0,63367 0,59548 0,37843 0,50148 0,34770 0,49615

0,55528 0,53801 0,46897 0,47228 0,25100 0,52686

0,57327 0,59907 0,36466 0,57748 0,56925 0,39056

0,60020 0,58138 0,34579 0,51852 0,48353 0,43389

0,63383 0,50588 0,23236 0,38786 0,23573 0,54898

0,66974 0,52322 0,21200 0,42450 0,26026 0,50596

0,59516 0,50372 0,36018 0,47553 0,33022 0,46409

0,68490 0,57080 0,25764 0,52747 0,46301 0,43332

0,64677 0,57889 0,31040 0,49100 0,43106 0,44882

0,49191 0,39104 0,48768 0,54310 0,43536 0,42472

0,53489 0,45883 0,41933 0,45530 0,33872 0,50189

0,59810 0,67598 0,40595 0,39429 0,23078 0,55211

0,61164 0,45435 0,31799 0,45585 0,43525 0,50701

0,76576 0,55738 0,15858 0,53172 0,40645 0,42428

0,66677 0,48226 0,28229 0,47283 0,30336 0,51436

0,67846 0,56656 0,27231 0,60865 0,39535 0,35454

0,89482 0,59841 0,15562 0,73818 0,39519 0,40744

0,80556 0,52775 0,29965 0,74577 0,43740 0,38043

0,57929 0,62693 0,36371 0,40658 0,32922 0,50110

0,51719 0,48235 0,35765 0,47830 0,35278 0,40454

0,51534 0,51343 0,40344 0,44134 0,33868 0,45312

0,65392 0,61002 0,24137 0,34758 0,22341 0,59457

0,59625 0,41288 0,36955 0,51535 0,30272 0,45118

0,67123 0,42972 0,27143 0,44181 0,22770 0,53161

0,61529 0,52943 0,39684 0,05108 0,34448 0,47999

0,59283 0,56558 0,44574 0,43950 0,27883 0,56258

0,60965 0,59086 0,33047 0,57674 0,49583 0,39088

0,62238 0,63004 0,33551 0,48044 0,45885 0,46869

0,63444 0,47433 0,24361 0,40369 0,23506 0,53305

0,66680 0,52564 0,20894 0,36484 0,20583 0,57230

0,59377 0,49534 0,35395 0,53065 0,33512 0,42305

0,67341 0,63248 0,29416 0,52550 0,42654 0,44724

0,61978 0,60426 0,33920 0,53526 0,36985 0,41266

0,59166 0,46652 0,36246 0,50521 0,40195 0,45003

0,53883 0,46725 0,40724 0,48760 0,36940 0,45398

0,67634 0,60791 0,33574 0,41513 0,23252 0,53552

0,71273 0,54024 0,20432 0,50183 0,40684 0,47406

0,71412 0,56439 0,20693 0,59277 0,43796 0,36117

0,70268 0,50909 0,25329 0,52726 0,33653 0,44756

0,72333 0,56736 0,22129 0,64609 0,41711 0,30647

0,89756 0,59163 0,15873 0,71458 0,38528 0,42252

0,80073 0,49247 0,29746 0,73384 0,41521 0,39634

0,38129 0,52124 0,38129 0,39749 0,32234 0,48643

0,36968 0,45423 0,36968 0,47881 0,36931 0,39721

0,30040 0,47767 0,30040 0,42645 0,34838 0,46364

0,30405 0,52103 0,30405 0,31819 0,17213 0,56422

0,40693 0,36005 0,40693 0,51820 0,33372 0,44321

0,33778 0,44644 0,33778 0,46737 0,24337 0,50292

0,41942 0,53502 0,41942 0,48319 0,34296 0,50010

0,49590 0,45771 0,49590 0,47893 0,27251 0,50212

0,33797 0,54053 0,33797 0,55927 0,47272 0,38127

0,39598 0,50987 0,39598 0,56766 0,47169 0,37530

0,27294 0,45595 0,27294 0,40940 0,25651 0,51845

0,22649 0,48494 0,22649 0,42350 0,25449 0,50528

0,43818 0,43617 0,43818 0,52246 0,34308 0,42859

IMAGENS COM BORDAS EM FOCO IMAGENS COM BORDAS FORA DE FOCO

TABELA 1A - Análise estatística das bordas das bolhas



 

160 

 

 

 

As análises sobre o experimento de 10/05/2017 foram realizadas sobre um 

número inferior de bolhas. Nela foram consideradas 14 bolhas em foco e 14 fora de foco, 

totalizando 112  perfís de bordas (56 em foco e 56 fora de foco).  

A tabela 2B representa a compilação de todos os parâmetros extraídos das 

quatro bordas de cada uma das 28 bolhas selecionadas para análise. Ela está dividida em 14 

"bolhas em foco" e  14 "bolhas fora de foco". As bolhas consideradas em foco são aquelas 

dentro dos limites da profundidade de campo em que as imagens do escoamento bifásico 

foram capturadas. Caso contrário a bolha será considerada fora de foco. Para cada bolha 

analisada, foi calculada a variação dos parâmetros considerados no modelo de inferência 

focal fuzzy em função do perfil médio de cada uma das suas bordas, ou seja, da borda 

superior, direita esquerda e inferior. Estes valores foram compilados e estão expostos na 

Lap+(1-I) Sob+(1-I) I Lap+(1-I) Sob+(1-I) I

0,30665 0,51574 0,30665 0,47391 0,38962 0,47161

0,39590 0,47429 0,39590 0,45641 0,36632 0,46621

0,42747 0,47797 0,42747 0,48581 0,41230 0,44992

0,46908 0,41237 0,46908 0,43217 0,33180 0,50499

0,46664 0,50105 0,46664 0,39801 0,21457 0,56142

0,49154 0,38235 0,49154 0,44264 0,36451 0,50303

0,21459 0,54831 0,21459 0,49076 0,40236 0,43940

0,30465 0,49073 0,30465 0,49832 0,31190 0,47534

0,27771 0,51177 0,27771 0,58766 0,39888 0,36491

0,23745 0,55634 0,23745 0,74582 0,42378 0,37411

0,27153 0,48935 0,27153 0,73859 0,42216 0,39632

0,43246 0,52054 0,45620 0,33640 0,24395 0,55514

0,48833 0,45296 0,40988 0,41368 0,29063 0,48910

0,41819 0,52325 0,39067 0,36783 0,28374 0,54007

0,52479 0,61460 0,34905 0,33053 0,19389 0,59425

0,50987 0,36059 0,44717 0,43913 0,22163 0,53708

0,55292 0,45895 0,39865 0,38599 0,15967 0,59672

0,52300 0,60545 0,46539 0,45481 0,26494 0,55024

0,45969 0,48988 0,53611 0,43216 0,19763 0,57311

0,54085 0,58486 0,39550 0,44640 0,41313 0,50384

0,54297 0,63193 0,40870 0,41787 0,38579 0,52963

0,54780 0,46309 0,33060 0,36243 0,18592 0,58256

0,57542 0,52020 0,31211 0,36150 0,17722 0,58761

0,47886 0,49197 0,46390 0,40038 0,23836 0,54785

0,58764 0,57705 0,34518 0,45220 0,38326 0,50522

0,50938 0,57623 0,42707 0,41395 0,32410 0,51954

0,42501 0,56118 0,49283 0,42739 0,34047 0,52858

0,46130 0,49105 0,48373 0,40271 0,29554 0,55025

0,44713 0,68968 0,47528 0,36593 0,17110 0,59692

0,63874 0,54312 0,28403 0,44034 0,38780 0,50468

0,69244 0,55537 0,23509 0,45214 0,35900 0,50640

0,64901 0,49377 0,29241 0,42939 0,19551 0,57940

0,60895 0,57510 0,34191 0,50556 0,34306 0,46431

0,85031 0,63499 0,22340 0,65911 0,32672 0,50715

0,76721 0,51103 0,34924 0,69089 0,36371 0,46420

Média 0,54200 0,51959 0,34155 0,47401 0,32934 0,47826

s 0,15200 0,08169 0,09112 0,11266 0,09091 0,07760

m+s 0,69400 0,60128 0,43267 0,58667 0,42025 0,55586

m-s 0,39000 0,43790 0,25043 0,36135 0,23844 0,40067

TABELA 1A - Análise estatística das bordas das bolhas - Continuação

IMAGENS COM BORDAS EM FOCO IMAGENS COM BORDAS FORA DE FOCO



 

161 

 

tabela que ao final apresenta o cálculo da média global de cada um dos parâmetros 

combinados, ou seja: 

? Laplaciano adicionado à intensidade negativa de cinza: Lap+(1-I); 

? Sobel adicionado à intensidade negativa de cinza: Sob+(1-I) e 

? Intensidade de cinza. 

TABELA 2B - Análise estatística das bordas das bolhas - experimento de 10/05/2017 

 

Lap+(1-I) Sob+(1-I) I Lap+(1-I) Sob+(1-I) I

0,4657 0,3136 0,6877 0,4883 0,2080 0,7765

0,4598 0,3191 0,6958 0,4984 0,2515 0,7633

0,5311 0,4946 0,5884 0,5022 0,2931 0,7528

0,3428 0,1067 0,8410 0,4933 0,2346 0,7734

0,5045 0,4134 0,6609 0,4046 0,2831 0,7298

0,4669 0,4652 0,6973 0,3588 0,2547 0,7816

0,4981 0,5359 0,6350 0,4598 0,4843 0,6728

0,4812 0,3584 0,6873 0,3784 0,3053 0,7568

0,5096 0,4098 0,4770 0,3975 0,2675 0,7380

0,4385 0,4515 0,5726 0,5067 0,3664 0,7085

0,5635 0,5411 0,4211 0,4423 0,5345 0,6743

0,4549 0,4056 0,5191 0,3897 0,2378 0,7595

0,7468 0,5412 0,3482 0,3594 0,2494 0,7686

0,7134 0,5201 0,3884 0,3665 0,2326 0,7559

0,7512 0,5467 0,3385 0,4043 0,3390 0,7217

0,7771 0,5044 0,3070 0,4019 0,2283 0,7147

0,7730 0,5923 0,3485 0,6926 0,3530 0,4472

0,6631 0,4952 0,4593 0,6671 0,3144 0,4878

0,7375 0,5901 0,3601 0,6750 0,3132 0,4713

0,7254 0,6218 0,3941 0,6712 0,3208 0,4742

0,8111 0,5696 0,2645 0,5775 0,3637 0,4430

0,6837 0,4414 0,4374 0,4734 0,2988 0,5576

0,7819 0,5918 0,2968 0,5742 0,4119 0,4287

0,7789 0,5469 0,3045 0,5231 0,3850 0,4984

0,7296 0,4953 0,3195 0,6930 0,3165 0,4996

0,5991 0,3803 0,4537 0,6521 0,2677 0,5497

0,6630 0,5544 0,3527 0,6513 0,2613 0,5523

0,7317 0,5458 0,3226 0,6714 0,2929 0,5341

0,7507 0,4351 0,3665 0,6821 0,3300 0,5887

0,6925 0,3756 0,4249 0,6760 0,2845 0,5881

0,7405 0,4282 0,3785 0,6755 0,3034 0,5829

0,7390 0,4247 0,3875 0,6777 0,2963 0,5829

0,6753 0,5565 0,4032 0,6965 0,2993 0,5647

0,6022 0,4304 0,4729 0,6748 0,2565 0,5882

0,6938 0,6329 0,3428 0,6998 0,3143 0,5582

IMAGENS COM BORDAS EM FOCO IMAGENS COM BORDAS FORA DE FOCO



 

162 

 

 

 

0,7168 0,5876 0,3587 0,6748 0,2713 0,5884

0,6950 0,5702 0,3829 0,7291 0,3745 0,5726

0,6338 0,4935 0,4377 0,7047 0,3418 0,6054

0,6878 0,5911 0,3543 0,7257 0,3457 0,5801

0,6833 0,5013 0,3696 0,7345 0,4449 0,5675

0,7294 0,5491 0,3615 0,7214 0,3769 0,5843

0,6283 0,5038 0,4579 0,7160 0,3474 0,5900

0,6986 0,6131 0,3729 0,7170 0,3710 0,5805

0,7307 0,5499 0,3864 0,7143 0,3670 0,5928

0,7666 0,5449 0,2914 0,7650 0,4492 0,5188

0,6297 0,4229 0,4686 0,7546 0,3885 0,5345

0,5279 0,1820 0,6178 0,7593 0,3905 0,5217

0,7260 0,5747 0,3276 0,7559 0,4566 0,5313

0,7506 0,5631 0,4122 0,6382 0,2985 0,5453

0,6739 0,4021 0,5277 0,6201 0,2657 0,5758

0,7291 0,4923 0,4308 0,6333 0,3025 0,5533

0,7954 0,5955 0,3836 0,6263 0,2971 0,5719

0,7648 0,7353 0,4569 0,6871 0,2888 0,5288

0,6622 0,4035 0,5490 0,6460 0,2477 0,5805

0,7303 0,5804 0,4408 0,6558 0,2885 0,5608

0,7140 0,6536 0,4997 0,6596 0,3098 0,5655

Média 0,65984 0,49546 0,44363 0,60348 0,32103 0,60171

s 0,11195 0,11064 0,12544 0,12613 0,06800 0,09821

m+s 0,77179 0,60610 0,56907 0,72961 0,38903 0,69992

m-s 0,54790 0,38481 0,31819 0,47736 0,25302 0,50349



 

163 

 

 

APÊNDICE C – Código computacional das principais aplicações do sistema VFTools 

 

O sistema VFTools é composto pelas seguintes aplicações:  

? selecTool: aplicação para seleção de uma amostra de escoamento. Esta 

aplicação foi desenvolvida sob uma interface gráfica com o usuário e 

consiste na aplicação sequencial de um conjunto de funções sobre a 

imagem capturada do experimento. Estas funções tratam da seleção de uma 

amostra do escoamento e da sua adequação para as aplicações posteriores. 

A primeira delas executa a seleção da superfície frontal da imagem do 

escoamento capturada do experimento com posterior rotação da imagem 

para compatibilização do sentido do escoamento a conversão da imagem, 

originalmente colorida, em intensidade de cinza normalizada. A execução 

da selecTool é finalizada com a aplicação do modelo de inferência focal 

fuzzy segundo parâmetros de segmentação de imagens normalizados sobre 

cada pixel da amostra com a consequente eliminação dos considerados 

“fora de foco” da imagem da amostra do escoamento; 

? maSamTool: aplicação com interface gráfica com o usuário com múltiplas 

funcionalidades. A primeira delas consiste na construção de arquivos de 

amostras de treinamento de uma rede neural com número de elementos de 

entrada correspondente às dimensões (ou os limites) de uma máscara 

virtual de varredura progressiva. A segunda funcionalidade consiste no 

treinamento da rede neural apresentando como resultado as matrizes com 

os pesos sinápticos de cada par de camadas. A execução da rede neural 

sobre uma amostra de escoamento com uma máscara virtual de varredura 

progressiva com dimensões fixas para eliminação consiste na terceira 

funcionalidade desta aplicação. Sua execução presta-se à eliminação das 

bolhas identificadas dentro dos limites físicos desta máscara. A execução 

desta terceira funcionalidade é realizada via integração da rede neural com 

uma função, denominada "rht_center". Esta última realiza a aplicação da 

transformada randomizada de Hough para captura dos parâmetros da figura 

geométrica que se ajusta aos contornos externos da bolha (interface 

gás-líquido). Finalmente a execução final do conjunto de redes neurais 

correspondente às dimensões da máscara virtual de varredura progressiva 



 

164 

 

para cálculo do volume de gases na amostra e consequente cálculo da 

fração de vazio e 

? saManTool: aplicação para fins de gerenciamento e organização dos 

arquivos de amostra de treinamento da rede neural. 

Os códigos computacionais das principais funções que compõe o sistema 

VFTools são apresentados e suas funcionalidades são apresentadas nos comentários das 

próprias funções. 

 

selecTool / lsi_edge.m 

function lsi_edge(handles) 
     
% ********************************************************************* 
% Read and prepare the selected image for pre-processing as follow:   * 
%   1.  Selection the region of interests (ROI) of the sample,        * 
%       regarding the acquisition image procedure (Direct or          * 
%       Neutron Radiography imaging)                                  * 
%   2.  Convert the ROI image to gray level image and rotate it       * 
%       acoording to the flow direction                               * 
%   3.  Compute the Laplacian and Sobel operator applied to each ROI  * 
%       image pixel using a Kernel mask as defined and presented by   * 
%       Krotkov (1983).                                               * 
%   4.  Submit each Laplacian, Sobel and Gray level of the ROI image  * 
%       pixel under a established Fuzzy Inference System that         * 
%       regards:                                                      * 
%       # (1-Gray level intensities) + Laplacian                      * 
%       # (1-Gray level intensities) + Sobel                          * 
%       # Original image gray level intensities                       * 
%********************************************************************** 
 
% 
% Read the cCaptured image reading 
% 
 
global SrcSelected; 
 
 
fn=get(handles.inpImgFileText,'String'); 
fp=get(handles.inpFilePathImgText,'String'); 
ir=imread([fp,fn]); 
 
% 
%   Identification the ROI image coordinates center 
% 
    [imlines,imcols,imdim]=size(ir); 
 
    xcenter=round(imcols/2); 
    for i=1:1:imlines 



 

165 

 

        if(ir(i,xcenter,1)&gt;40 &amp;amp;&amp;amp; ir(i,xcenter,2)&gt;40 &amp;amp;&amp;amp;... 
                ir(i,xcenter,3)&gt;40) 
            istart=i+20; 
            break; 
        end 
    end 
    for i=imlines:-1:1 
        if(ir(i,xcenter,1)&gt;40 &amp;amp;&amp;amp; ir(i,xcenter,2)&gt;40 &amp;amp;&amp;amp;... 
                ir(i,xcenter,3)&gt;40) 
            iend=i-20; 
            break; 
        end 
    end 
     
    ycenter=round((istart+iend)/2); 
 
% 
%   Displacement of the ROI image center toward the symetric longitudinal 
%   axis in order to choose the best sample 
% 
 
dispinp=get(handles.inpLongDispText,'String'); 
xd=str2double(dispinp); 
xc=xcenter+xd; 
yc=ycenter; 
 
% 
%   Creating the selected sample file 
% 
 
if strcmp(SrcSelected,'CDI') 
    nxdam=800; 
    nydam=800; 
elseif strcmp(SrcSelected,'NRI') 
    nydam=floor(iend-istart); 
    nxdam=nydam; 
else 
    display('Invalid Image Device Source'); 
end 
     
    amcolor=zeros(nydam,nxdam,imdim); 
    xstart=xc-floor(nxdam/2); 
    ystart=yc-floor(nydam/2); 
 
    for i=1:nxdam 
        for j=1:nydam 
            for k=1:3 
                amcolor(i,j,k)=ir(ystart-1+i,xstart-1+j,k); 
            end 
        end 
    end 
 



 

166 

 

    clear ir; 
 
% 
%   Image normalizing and rotation to agree with experimental flow 
% 
 
    amc=double(amcolor)/255; 
 
    theta=pi/2; 
    T=[ cos(theta)  sin(theta)  0 
        -sin(theta) cos(theta)  0 
        0           0           1]; 
    tr=maketform('affine',T); 
    amrotc=imtransform(amc,tr); 
     
    axes(handles.ImgOriginal); 
    image(amrotc,'CDataMapping','scaled'); 
    set(gcf,'colormap',jet); 
    axis image; 
    axis off; 
 
    amrot=rgb2gray(amrotc); 
    set(gcf,'colormap',gray); 
     
% 
%   Krotkov's Laplacian operator application with Kernel mask 
% 
 
    [lin,col]=size(amrot); 
    lp=(1/6).*[1 4 1;4 -20 4;1 4 1]; 
    lap=zeros(lin,col); 
 
    for i=2:1:lin-1 
        for j=2:1:col-1 
            mask=amrot(i-1:1:i+1,j-1:1:j+1); 
            lpmask=lp.*mask; 
            lap(i,j)=sum(sum(lpmask,2),1); 
        end 
    end 
    lap(1,:)=lap(2,:); 
    lap(lin,:)=lap(lin-1,:); 
    lap(:,1)=lap(:,2); 
    lap(:,col)=lap(:,col-1); 
    lmin=min(min(lap,[],1),[],2); 
    lmax=max(max(lap,[],1),[],2); 
    lap=(lap-lmin)/(lmax-lmin); 
     
% 
%   Krotkov's Sobel operator application. 
% 
 
    ix=(1/4).*[-1 0 1;-2 0 2;-1 0 1]; 



 

167 

 

    iy=(1/4).*[1 2 1;0 0 0;-1 -2 -1]; 
    sob=zeros(lin,col); 
    sobx=zeros(lin,col); 
    soby=zeros(lin,col); 
 
    for i=2:1:lin-1 
        for j=2:1:col-1 
            mask=amrot(i-1:1:i+1,j-1:1:j+1); 
            sbx=ix.*mask; 
            sobx(i,j)=sum(sum(sbx,2),1)*amrot(i,j); 
            sby=iy.*mask; 
            soby(i,j)=sum(sum(sby,2),1)*amrot(i,j); 
            sob(i,j)=sqrt(sobx(i,j)^2 + soby(i,j)^2); 
        end 
    end 
 
    sob(1,:)=sob(2,:); 
    sob(lin,:)=sob(lin-1,:); 
    sob(:,1)=sob(:,2); 
    sob(:,col)=sob(:,col-1); 
    sobmax=max(max(sob,[],1),[],2); 
    sobmin=min(min(sob,[],1),[],2); 
    snorm=(sob-sobmin)/(sobmax-sobmin); 
    sob=snorm; 
     
    % 
    %   1 - Gray level intensities + Laplacian (normalized) 
    % 
     
    ilap=(1-amrot)+lap; 
    ilapmax=max(max(ilap,[],2),[],1); 
    ilapmin=min(min(ilap,[],2),[],1); 
    ilapnorm=(ilap-ilapmin)/(ilapmax-ilapmin); 
     
    % 
    %   1 - Gray level intensities + Sobel (normalized) 
    % 
     
    isob=(1-amrot)+sob; 
    isobmax=max(max(isob,[],2),[],1); 
    isobmin=min(min(isob,[],2),[],1); 
    isobnorm=(isob-isobmin)/(isobmax-isobmin); 
    
    %******************************************************* 
    %   The pixels identified by de Fuzzy Inference System * 
    %   are loaded in "edge" matrix as a border pixel of   * 
    %   the bubble image.                                  * 
    %******************************************************* 
     
    edge=ones(nxdam,nydam); 
% 
    border_fis=readfis('new_lsi_border.fis'); 



 

168 

 

% 
%    border_fis=readfis('lsi_border.fis'); 
     
    for i=1:1:lin 
        for j=1:1:col 
            inp_fis=[ilapnorm(i,j),isobnorm(i,j),amrot(i,j)]; 
            out_fis=evalfis(inp_fis,border_fis); 
            if(out_fis &gt; 0.5) 
                edge(i,j)=amrot(i,j); 
            end; 
        end; 
    end; 
% 
%   Transform to negative image 
% 
 
edge=1-edge; 
     
axes(handles.ImgProcessedAxis); 
image(edge,'CDataMapping','scaled') 
axis image; 
axis off; 
 
[filename, filepath]=uiputfile('*.tif','Save in .tif file', 'amostra1'); 
imwrite(edge,[filepath,filename],'tif'); 
imwrite(amrotc,[filepath,'c',filename],'tif'); 
 
clear amrotc; 
end 

 

maSamTool / ANN_2HL_30x30 

function ANN_2HL_30x30_Training(handles) 
%% 
% 
% ANN_30X30_Training: BACKPROPAGATION TRAINING FOR IMAGES  WITH 30X30 
% DIMENSION ARTIFICIAL NEURAL NETWORK ARQUITECTURE HAS AN INPUT LAYER WITH 
% 900 INPUT DATA THAT CORRESPONDS TO THE PIXELS INTENSITY OF A 30 X 30  
% IMAGE AND TWO HIDDEN LAYERS (WITH 144 AND 25 UNITS). 
% THIS ANN WILL BE APPLIED FOR IMAGE CLASSIFICATION IN: 
% 
%   1 - IMAGE MASK WITH ONE BUBBLE 
%   0 - IMAGE MASK WITHOUT ANY BUBBLE 
% 
%   nl  ............ number of labels (output units) 
%   il  ............ input layer units (input units related to image 
%                    dimension) 
%   fhl ............ first hidden layer units 
%   shl ............ second hidden layer units 
% 
%   For 30x30 input layer: 
%       il  = 900 



 

169 

 

%       fhl = 144 
%       shl =  25 
%       nl  =   2 
% 
%% 
 
% 
%   Reading training samples file with 
%   x ... training samples images and 
%   y ... related outputs ("[1 0]" or "[0 1]") 
% 
 
global msamp; 
load(msamp,'x','y'); 
 
%% 
% Theta3 is a (il+1)  x fhl Weight Matrix applied to input layer 
% Theta2 is a (fhl+1) x shl Weight Matrix applied to first hidden layer 
% Theta1 is a (shl+1) x  nl Weight Matrix applied to second hidden layer 
%       producing output signal. 
% Random initialization of the Weight matrices regards the ANN 
% arquitecture 
% 
 
% 
%   Cleaning the weight files to avoid input errors 
% 
 
clear ThetaV30x30; 
 
il=900; 
fhl=144; 
shl=25; 
nl=2; 
 
m = size(x,1); 
yl=zeros(m,2); 
 
for i=1:m 
    if(y(i)==1) 
        yl(i,1)=1; 
    else 
        yl(i,2)=1; 
    end 
end 
 
% Randomly select 100 data points to display 
 
sel = randperm(m); 
sel = sel(1:100); 
axes(handles.ImageAxes); 
displayData(x(sel, :)); 



 

170 

 

 
Theta3=initialTheta(il,fhl); 
Theta2=initialTheta(fhl,shl); 
Theta1=initialTheta(shl,nl); 
 
% 
%   Weight matrices randomized inicializations 
% 
 
initial_ThetaV30x30 = [Theta3(:);Theta2(:);Theta1(:)]; 
lambda=0.01; 
 
% 
%   Theta3 ......  (il+1) x fhl 
%   Theta2 ...... (fhl+1) x shl 
%   Theta1 ...... (shl+1) x nl 
% 
%   initial_ThetaV30x30 ... Vectorized Weight matrices 
% 
 
% 
%   Training the ANN to compute Theta3, Theta2 and Theta1 
% 
 
options=optimset('MaxIter',400); 
costFunction30x30=@(p) Cost_2HL_30x30(p,il,fhl,shl,nl,x,yl,lambda); 
[ThetaV30x30, ~]=fmincg(costFunction30x30,initial_ThetaV30x30,options); 
 
[sampname, sampath]=uiputfile('*.mat','Save in .mat file','ThetaVec30x30'); 
wname=[sampath,sampname]; 
save(wname,'ThetaV30x30'); 
 
% 
%   Seting start and end of each Weight matrix to proceed with Unrolling 
%   vectors 
% 
 
startTheta3=1; 
endTheta3=(il+1)*fhl; 
 
startTheta2=endTheta3+1; 
endTheta2=endTheta3 +(fhl+1)*shl; 
 
startTheta1=endTheta2+1; 
endTheta1=endTheta2+(shl+1)*nl; 
 
Theta3 = reshape(ThetaV30x30(startTheta3:endTheta3),(il+1),fhl); 
Theta2 = reshape(ThetaV30x30(startTheta2:endTheta2),(fhl+1),shl); 
Theta1 = reshape(ThetaV30x30(startTheta1:endTheta1),(shl+1),nl); 
 
 
displayData(Theta2(2:end,:)); 



 

171 

 

 
ypred=zeros(m,1); 
pred = predict_2HL_30x30(Theta3,Theta2,Theta1,x); 
for i=1:m 
    if pred(i)==1 
        ypred(i)=1; 
    else 
        ypred(i)=0; 
    end 
end 
     
erro=sum(sum(abs(y-ypred),2),1); 
prec=1-(erro/size(y,1)); 
 
msg=['Training set accuracy: ',num2str(prec * 100)]; 
 uiwait(msgbox(msg,'Title','modal')); 
end 

 

maSamTool / ANN_2HL_30x30 

function ANN_2HL_30x30(handles) 
%% 
%   NEW_ANN_30x30:  TRACKING AN IMAGE WITH A 30x30 MASK.THE SUB IMAGE CAPTURED 
%                   BY THE MASK IS ANALYSED WITH AN ARTIFICIAL NEURAL NETWORK. 
%                   IT WILL ORGANIZE THE SUB IMAGE REGARDING TWO CLASSES: 
%                   1 - SUB IMAGE WITH ONE BUBBLE OR 
%                   2 - SUB IMAGE WITHOUT ANY BUBBLE 
%% 
global arqimg; 
global dimam; 
global v30; 
global sumv30; 
global icontv30; 
 
[ximg, yimg]=size(arqimg); 
 
if icontv30 == 0 
    opt=get(handles.MaskSizePopMenu,'String'); 
    ind=get(handles.MaskSizePopMenu,'Value'); 
    dimam=str2double(opt(ind)); 
else 
    dimam=30; 
end 
 
il=900; 
fhl=144; 
shl=25; 
nl=2; 
 
if icontv30==0 
    [Theta_name,Theta_path]=uigetfile('*.mat','Load *.mat file','Weights'); 
    W30x30=[Theta_path,Theta_name]; 



 

172 

 

else 
    W30x30='Weights\ThetaVec30x30.mat'; 
end 
load(W30x30); 
 
startTheta3=1; 
endTheta3=(il+1)*fhl; 
 
startTheta2=endTheta3+1; 
endTheta2=endTheta3+(fhl+1)*shl; 
 
startTheta1=endTheta2+1; 
endTheta1=endTheta2+(shl+1)*nl; 
 
Theta3 = reshape(ThetaV30x30(startTheta3:endTheta3),(il+1), fhl); 
Theta2 = reshape(ThetaV30x30(startTheta2:endTheta2),(fhl+1),shl); 
Theta1 = reshape(ThetaV30x30(startTheta1:endTheta1),(shl+1) ,nl); 
 
outimg=ones(ximg,yimg); 
count30x30=0; 
count_aval=0; 
%p=zeros(1,2); 
 
% 
%   horizontal feedforward tracking 
% 
 
i=1; 
while i&amp;lt;= ximg-dimam 
    j=1; 
    while j&amp;lt;= yimg-dimam 
         
        mask=arqimg(i:i+dimam-1,j:j+dimam-1); 
        amsepsum=sum(sum(mask,1),2); 
         
        if(amsepsum &gt; 40.00) 
             
            count_aval=count_aval+1; 
             
            xmask=mask(:)'; 
 
            a3=[1 xmask]; 
             
            z2=a3*Theta3; 
            a2=[1 sigmoid(z2)]; 
             
            z1=a2*Theta2; 
            a1=[1 sigmoid(z1)]; 
             
            z0=a1*Theta1; 
            a0=sigmoid(z0); 
             



 

173 

 

%            [~,p]=max(a0, [],2); 
             
            if a0(1,1)&gt;= 0.999999 &amp;amp;&amp;amp; a0(1,2)&amp;lt;0.000001 
                 
                count30x30=count30x30+1; 
                outimg(i:i+dimam-1,j:j+dimam-1)=... 
                    arqimg(i:i+dimam-1,j:j+dimam-1); 
                [xc,yc,a_el,b_el,theta_el,~,n_el]=rht_center(mask); 
                 
                if(n_el ~= 0) 
                    disp(['n_el = ',num2str(n_el)]); 
                    for n_shape=1:n_el 
                        disp(['xi = ',num2str(i)]); 
                        disp(['yj = ',num2str(j)]); 
                        disp(['xc = ',num2str(xc(n_shape))]); 
                        disp(['yc = ',num2str(yc(n_shape))]); 
                        disp(['a = ',num2str(a_el(n_shape))]); 
                        disp(['b = ',num2str(b_el(n_shape))]); 
                        disp(['theta = ',num2str(theta_el(n_shape))]); 
                        frame_out=build_shape(i,j,xc(n_shape),yc(n_shape),... 
                            a_el(n_shape),b_el(n_shape),theta_el(n_shape),... 
                            ximg,yimg,dimam); 
                        if frame_out == 0 
                            cleanel(i,j,xc(n_shape),yc(n_shape),... 
                                a_el(n_shape),b_el(n_shape),... 
                                theta_el(n_shape)); 
                            if icontv30 == 1 
                                v30=(4/3)*pi*a_el(n_shape)... 
                                    *(b_el(n_shape)^2); 
                                sumv30=sumv30+v30; 
                            end 
                        end 
                    end 
                end 
            end 
        end 
        j=j+1; 
    end 
    i=i+1; 
end 
 
if icontv30 == 0 
    axes(handles.SampleAxes); 
    image(arqimg,'CDataMapping','scaled'); 
    set(gcf,'colormap',gray); 
    axis image; 
    axis off; 
 
    disp(['n. resultados positivos =' num2str(count66x66)]); 
    disp(['n. de execuções da rede = ' num2str(count_aval)]); 
    imtool(outimg); 
    disp('press Enter to continue'); 



 

174 

 

    pause; 
    [nimgfile, nimgpath]=uiputfile('*.tif' ,'Save in .tif file', 'name-66'); 
    imwrite(arqimg,[nimgpath,nimgfile],'tif'); 
end 
end 

 

maSamTool / Cost_2HL_30x30 

function [J, grad] = Cost_2HL_30x30(params,il,fhl,shl,nl,x,yl,lambda) 
                                    
%COST30X30 Implements the neural network cost function for a two layer 
%neural network which performs classification 
%   [J grad] = Cost30X30(params,il,hl,nl,x,yl,lambda) computes the cost and  
%   gradient of the neural network. The parameters for the neural network  
%   are "unrolled" into the vector params and need to be converted back  
%   into the weight matrices.  
%  
%   The returned parameter grad should be a "unrolled" vector of the 
%   partial derivatives of the neural network. 
% 
% 
%   Reshape nn_params back into the parameters Theta1 and Theta2, the weight  
%   matrices for our 2 layer neural network 
% 
%   il  .......... number of the input layer elements 
%   fhl .......... number of the first hidden layer elements 
%   shl .......... number of the second hidden layer elements 
%   nl  .......... label numbers 
%   x   .......... matrix with the input samples. Each sample corresponds 
%                  a one line of the matrix 
%   y   .......... output 
% 
%   Theta1 ...... Weitghs for the second hidden layer 
%   Theta2 ...... Weights for the first hidden layer 
%   Theta3 ...... Weights for the input layer 
% 
 
startTheta3=1; 
endTheta3=(il+1)*fhl; 
 
startTheta2=endTheta3+1; 
endTheta2=endTheta3+(fhl+1)*shl; 
 
startTheta1=endTheta2+1; 
endTheta1=endTheta2+(shl+1)*nl; 
 
Theta3 = reshape(params(startTheta3:endTheta3),(il+1) ,fhl); 
Theta2 = reshape(params(startTheta2:endTheta2),(fhl+1),shl); 
Theta1 = reshape(params(startTheta1:endTheta1),(shl+1), nl); 
 
 
%% 



 

175 

 

%   Feedforward Neural Network with regularization 
% 
% Setup some useful variables 
%   m .......... number of samples 
%    
 
m = size(x, 1); 
 
% 
% Feedforward Neural Network 
% 
 
a3= [ones(m,1) x]; 
 
z2=a3*Theta3; 
a2=[ones(m,1) sigmoid(z2)]; 
 
z1=a2*Theta2; 
a1=[ones(m,1) sigmoid(z1)]; 
 
z0=a1*Theta1; 
a0=sigmoid(z0); 
 
% 
% regularization term 
% 
 
Theta3reg=Theta3(2:end,:); 
Theta2reg=Theta2(2:end,:); 
Theta1reg=Theta1(2:end,:); 
 
% 
%   Extracting the firs collumn of the Weigth matrix 
% 
 
sqrTheta3=(Theta3reg.*Theta3reg); 
sqrTheta2=(Theta2reg.*Theta2reg); 
sqrTheta1=(Theta1reg.*Theta1reg); 
 
 
sumTheta3=sum(sum(sqrTheta3,2)); 
sumTheta2=sum(sum(sqrTheta2,2)); 
sumTheta1=sum(sum(sqrTheta1,2)); 
 
regterm=(lambda/(2*m))*(sumTheta3+sumTheta2+sumTheta1); 
 
%         
% regularized cost function 
% 
 
J =((1/m)*(sum(sum((-yl.*log(a0)-(1-yl).*log(1-a0)),2))))+regterm; 
 



 

176 

 

%% 
%   Back propagation algorithm implementation 
%   Compute the gradients Theta1_grad and Theta2_grad. 
% 
%   Theta1_grad and Theta2_grad represents the partial derivatives of the 
%   cost function with respect to Theta1 and Theta2, respectively. 
% 
 
Delta1=zeros(size(Theta1)); 
Delta2=zeros(size(Theta2)); 
Delta3=zeros(size(Theta3)); 
 
delta0=a0-yl; 
 
d1=delta0*Theta1'; 
dl1=d1(:,2:end); 
delta1=dl1.*sigmoid_Grad(z1); 
 
d2=delta1*Theta2'; 
dl2=d2(:,2:end); 
delta2=dl2.*sigmoid_Grad(z2); 
 
Delta1=Delta1+a1'*delta0; 
Delta2=Delta2+a2'*delta1; 
Delta3=Delta3+a3'*delta2; 
 
D1=(1/m).*Delta1; 
D2=(1/m).*Delta2; 
D3=(1/m).*Delta3; 
 
% 
%   Computing regularization terms 
% 
 
regterm_grad1=(lambda/m).*Theta1; 
regterm_grad1(1,:)=0; 
regterm_grad2=(lambda/m).*Theta2; 
regterm_grad2(1,:)=0; 
regterm_grad3=(lambda/m).*Theta3; 
regterm_grad3(1,:)=0; 
 
Theta1_grad=D1+regterm_grad1; 
Theta2_grad=D2+regterm_grad2; 
Theta3_grad=D3+regterm_grad3; 
% Unroll gradients 
grad = [Theta3_grad(:);Theta2_grad(:); Theta1_grad(:)]; 
 
end 

 

 

 



 

177 

 

maSamTool / rht_center 

function [x_c,y_c,a_ell,b_ell,theta_ell,flag, n_found]=rht_center(f) 
 
[r,c]=size(f); 
rc=floor(hypot(r,c)/2); 
 
% 
%   r  ... number of the image rows 
%   c  ... number of the image columns 
%   rc ... maximum value of the ellipse semi axes 
% 
 
gx=zeros(r,c); %#ok&lt;NASGU&gt; 
gy=zeros(r,c); %#ok&lt;NASGU&gt; 
 
vote=zeros(r,c); 
vote_params=zeros(r,c,180); 
max_vote_params=zeros(4,1); 
maxv=0; 
max_vote=zeros(4,1); 
 
% 
%   Voting acummulation matrices 
% 
 
xc=zeros(4,1); 
yc=zeros(4,1); 
x_c=zeros(4,1); 
y_c=zeros(4,1); 
 
 
% 
%   xc  row ellipse center 
%   yc  columm ellipse center 
% 
 
a_el=zeros(4,1); 
b_el=zeros(4,1); 
theta_el=zeros(4,1); 
a_ell=zeros(4,1); 
b_ell=zeros(4,1); 
theta_ell=zeros(4,1); 
 
% 
%   a_el    ellipse semi major axis 
%   b_el    ellipse semi minnor axis 
%   theta   ellipse semi major axis angle relative to horizontal axis 
% 
 
A_el=zeros(4,1); 
B_el=zeros(4,1); 



 

178 

 

C_el=zeros(4,1); 
 
A_ell=zeros(4,1); 
B_ell=zeros(4,1); 
C_ell=zeros(4,1); 
 
% 
%   A_el; B_el; C_el    General ellipse equation coeficients 
%   A_ell;B_ell;C_ell selected general elipse equation coeficients 
% 
 
a_pix=zeros(4,1); 
b_pix=zeros(4,1); 
c_pix=zeros(4,1); 
 
% 
%   Gaussian filter application under f(r,c) and derivatives computation 
%   gx ...          row direction derivative 
%   gy ...          columm direction derivative 
% 
%   flag ...        control of the image tracking 
%                   flag = 0 == &gt; any ellipse was found (initial value) 
%                   flag = 1 == &gt; ellipse was found after tracking 
%                   flag = 2 == &gt; any ellipse was found after tracking 
%                                 ==&gt;   the image doesn't contain any  
%                                       ellipse more 
%   pix_rate        pixel rate regarding np and flag (threshold &gt;= 0.25) 
%   n_found ...     number of ellipses found 
% 
 
flag = 0; 
n_found = 0; 
sig=stdev(f); 
[gy,gx]=smoothGradient(f,sig); 
 
border=edge(f,'canny'); 
 
while (flag ~= 2) 
    [rb,cb]=find(border); 
    np=size(rb,1); 
    zb=[rb,cb]; 
%    disp([' np = ',num2str(np)]); 
%    disp('Pause - press Enter to Continue &gt;&gt;&gt; '); 
%    pause; 
% 
%   sample_size ... size of the pixels sample of the border image 
%   it corresponds to 50% of the total (P1,P2) combinations 
% 
 
 
    sample_size=floor(0.6*((np*(np-1))/2)); 
 



 

179 

 

% 
%   variables initialization for triplex points 
%   rb ...      row coordinates of the border pixel 
%   cb ...      columm coordinates of the border pixel 
%   rb_00 ...   row coordinates relative to translated center (0,0)  
%   cb_00 ...   columm coordinates relative to translated center(0,0) 
%   mtm ...     angular coeficient of the border point tangent line 
%   cltm ...    linear coefficient of the border point tangent line 
%   ae ...      ellipse major semi_axis 
%   be ...      ellipse minor semi-axis 
%   theta ...   ellipse major semi-axis angle in radians 
%   thetag ...  ellipse major semi-axis angle in degrees 
% 
 
    rb1=zeros(sample_size,1); 
    rb100=zeros(sample_size,1); 
    cb1=zeros(sample_size,1); 
    cb100=zeros(sample_size,1); 
 
    rb2=zeros(sample_size,1); 
    rb200=zeros(sample_size,1); 
    cb2=zeros(sample_size,1); 
    cb200=zeros(sample_size,1); 
 
    rb3=zeros(sample_size,1); 
    rb300=zeros(sample_size,1); 
    cb3=zeros(sample_size,1); 
    cb300=zeros(sample_size,1); 
 
    mt1=zeros(sample_size,1); 
    mt2=zeros(sample_size,1); 
 
    cl1=zeros(sample_size,1); 
    cl2=zeros(sample_size,1); 
 
    ct=zeros(sample_size,1); 
    rt=zeros(sample_size,1); 
 
    cm=zeros(sample_size,1); 
    rm=zeros(sample_size,1); 
 
    mtm=zeros(sample_size,1); 
    cltm=zeros(sample_size,1); 
 
    ae=zeros(sample_size,1); 
    be=zeros(sample_size,1); 
    theta=zeros(sample_size,1); 
 
    ck=zeros(4,1); 
    rk=zeros(4,1); 
 
% 



 

180 

 

%   triplex of border points P1:(rb1,cb1), P2:(rb2,cb2) and P3: (rb3,cb3) 
%   sample_size combinations 
% 
 
    for comb =1:sample_size 
        i1=randi(np); 
        i2=randi(np); 
        i3=randi(np); 
        while (i1 == i2 || i1 == i3 || i2 == i3) 
            i1=randi(np); 
            i2=randi(np); 
            i3=randi(np); 
        end 
            rb1(comb)=zb(i1,1); 
            cb1(comb)=zb(i1,2); 
            rb2(comb)=zb(i2,1); 
            cb2(comb)=zb(i2,2); 
            rb3(comb)=zb(i3,1); 
            cb3(comb)=zb(i3,2); 
    end 
 
% 
%   The center of the ellipse is at the line that passes through 
%   the tangents lines cross point (rt,ct) and the midpoints of the 
%   two sample points (rm,cm).  
% 
 
    for i=1:sample_size 
        mt1(i)=gx(rb1(i),cb1(i))/gy(rb1(i),cb1(i)); 
        mt2(i)=gx(rb2(i),cb2(i))/gy(rb2(i),cb2(i)); 
        cl1(i)=rb1(i)-mt1(i)*cb1(i); 
        cl2(i)=rb2(i)-mt2(i)*cb2(i); 
        ct(i)=(cl2(i)-cl1(i))/(mt1(i)-mt2(i)); 
        rt(i)=mt1(i)*ct(i)+cl1(i); 
        cm(i)=(cb1(i)+cb2(i))/2; 
        rm(i)=(rb1(i)+rb2(i))/2; 
        mtm(i)=(rt(i)-rm(i))/(ct(i)-cm(i)); 
        cltm(i)=rm(i)-mtm(i)*cm(i); 
    end 
 
    for nv=1:sample_size 
        for ycol=1:c 
            xrow=round(mtm(nv)*ycol+cltm(nv)); 
            if xrow &gt; 0 &amp;amp;&amp;amp; xrow&amp;lt;= r 
                vote(xrow,ycol)=vote(xrow,ycol)+1; 
            end 
        end 
    end 
% 
%    xplot=zeros(r*c,1); 
%    yplot=zeros(r*c,1); 
%    vplot=zeros(r*c,1); 



 

181 

 

% 
%    n=1; 
%    for i=1:r 
%        for j=1:c 
%            xplot(n)=i; 
%            yplot(n)=j; 
%            vplot(n)=vote(i,j); 
%            n=n+1; 
%        end 
%    end 
%    stem3(xplot,yplot,vplot,'b-'); 
%    xlabel('linha') 
%    ylabel('coluna') 
%    zlabel('votos') 
%    title('votação das coordenadas do centro da elipse') 
 
%    disp('Pause - press enter to continue'); 
%    pause; 
 
% 
%   Selection of the four most voted ellipse center locations (xc,yc)  
% 
 
    n_c=1; 
    while (n_c&amp;lt;= 4) 
        for i=1:r 
            for j=1:c 
                if vote(i,j)&gt; maxv 
                    maxv=vote(i,j); 
                    imax=i; 
                    jmax=j; 
                end 
            end 
        end 
 
        if(n_c &gt;= 2) 
            if(abs(max_vote(n_c-1)-maxv)) &amp;lt;2 
                if(abs(xc(n_c-1)-imax) &gt; 1 || abs(yc(n_c-1)-jmax) &gt; 1) 
                    xc(n_c)=imax; 
                    yc(n_c)=jmax; 
                    max_vote(n_c)=maxv; 
                    vote(imax,jmax)=0; 
                    maxv=0; 
                    n_c=n_c+1; 
                else 
                    vote(imax,jmax)=0; 
                    maxv=0; 
                end 
            else 
                xc(n_c)=imax; 
                yc(n_c)=jmax; 
                max_vote(n_c)=maxv; 



 

182 

 

                vote(imax,jmax)=0; 
                maxv=0; 
                n_c=n_c+1; 
            end 
        elseif(n_c == 1) 
            xc(n_c)=imax; 
            yc(n_c)=jmax; 
            max_vote(n_c)=maxv; 
            vote(imax,jmax)=0; 
            maxv=0; 
            n_c=n_c+1; 
        end 
    end 
 
    n_c=1; 
    while n_c&amp;lt;= 4 
 
% 
%   Translation of the pixels coordinates to ellipse center 
% 
%    disp(['xc(',num2str(n_c),') = ',num2str(xc(n_c))]); 
%    disp(['yc(',num2str(n_c),') = ',num2str(yc(n_c))]); 
%     
        for comb=1:sample_size 
            rb100(comb)=rb1(comb)-xc(n_c); 
            cb100(comb)=cb1(comb)-yc(n_c); 
            rb200(comb)=rb2(comb)-xc(n_c); 
            cb200(comb)=cb2(comb)-yc(n_c); 
            rb300(comb)=rb3(comb)-xc(n_c); 
            cb300(comb)=cb3(comb)-yc(n_c); 
        end 
        for comb=1:sample_size 
            A=zeros(3,3); 
            B=ones(3,1); 
         
            A(1,1)=cb100(comb)^2; 
            A(1,2)=rb100(comb)*cb100(comb); 
            A(1,3)=rb100(comb)^2; 
            A(2,1)=cb200(comb)^2; 
            A(2,2)=rb200(comb)*cb200(comb); 
            A(2,3)=rb200(comb)^2; 
            A(3,1)=cb300(comb)^2; 
            A(3,2)=rb300(comb)*cb300(comb); 
            A(3,3)=rb300(comb)^2; 
                  
            if rcond(A) &gt; 0.001 
             
                X=linsolve(A,B); 
                     
                if (X(1)*X(3))-((X(2)/2)^2) &gt; 0 
                    bsq1=(X(1)-X(3))^2; 
                    bsq2=(X(2))^2; 



 

183 

 

                    bsq3=sqrt(bsq1+bsq2); 
                    bsq4=X(1)+X(3)+bsq3; 
                    bsqr=2/bsq4; 
                    be(comb)=round(sqrt(bsqr)); 
                    asq1=X(1)+X(3); 
                    asq2=1/bsqr; 
                    asqr=1/(asq1-asq2); 
                    ae(comb)=round(sqrt(asqr)); 
                    if ae(comb) == be(comb) 
                        theta(comb)=0.0; 
                    elseif ae(comb) &gt; be(comb) 
                        arg=real(sqrt(((asqr*bsqr*X(1))-asqr)/(bsqr-asqr))); 
                        if(X(2)&amp;lt;= 0) 
                            theta(comb)=round(acosd(arg)); 
                        else 
                            theta(comb)=round(acosd(-arg)); 
                        end 
                    end 
                end 
                 % 
                 %  Check for a valid ellipse 
                 % 
                  
                 for i=1:4 
                     el_out=build_shape(0.0,0.0,xc(i),yc(i),ae(comb),... 
                         be(comb),theta(comb),r,c,c); 
                     if el_out == 1 
                         ae(comb)=0; 
                         be(comb)=0; 
                         theta(comb)=0; 
                     end 
                 end 
            end 
        end 
        for comb=1:sample_size 
             
            if ae(comb) &gt; 0 &amp;amp;&amp;amp; ae(comb) &amp;lt;rc 
                if be(comb) &gt;0 &amp;amp;&amp;amp; be(comb) &amp;lt;rc 
                    if theta(comb) &gt; 0 &amp;amp;&amp;amp; theta(comb)&amp;lt;= 180 
                        vote_params(ae(comb),be(comb),theta(comb))=... 
                            vote_params(ae(comb),be(comb),theta(comb))+1; 
                    end 
                end 
            end 
        end 
        for i=1:rc 
            for j=1:rc 
                for k=1:180 
                    if vote_params(i,j,k) &gt;= max_vote_params(n_c) 
                        max_vote_params(n_c)=vote_params(i,j,k); 
                        a_el(n_c)=i; 
                        b_el(n_c)=j; 



 

184 

 

                        theta_el(n_c)=k; 
                    end 
                end 
            end 
        end 
         
        max_vote_params(:)=0; 
        vote_params(:,:,:)=0; 
           
        sqa_el=(a_el(n_c))^2; 
        sqb_el=(b_el(n_c))^2; 
        sqc_el=(cosd(theta_el(n_c)))^2; 
        sqs_el=(sind(theta_el(n_c)))^2; 
        sc_el=sind(theta_el(n_c))*cosd(theta_el(n_c)); 
         
        A_el(n_c)=(sqc_el/sqa_el)+(sqs_el/sqb_el); 
        B_el(n_c)=2*((1/sqa_el)-(1/sqb_el))*sc_el; 
        C_el(n_c)=(sqs_el/sqa_el)+(sqc_el/sqb_el); 
         
        n_c=n_c+1; 
    end 
% 
%   At this point was selected four set of eight parameters as: 
%   [xc(1:nc),yc(1:nc)] ... raw and column center coordinates 
%   [a_el(1:nc),b_el(1:nc),theta_el(1:nc)] ... ellipse major and minor  
%                                              semi-axis and its 
%                                              inclination 
%   A_el(1:nc),B_el(1:nc),C_el(1:nc) ...    general ellipse equation 
%                                           parameters 
% 
%   Check and select the best ellipse fitting parameters: 
%   i ... correspondent index to ellipse parameters (xc,yc,a,b theta) 
% 
    nt_pix=zeros(4,1); 
    n_pix_found=zeros(4,1); 
    for i=1:4 
        for rk00=-floor(r/2):floor(r/2) 
            a_pix(i)=A_el(i); 
            b_pix(i)=B_el(i)*rk00; 
            c_pix(i)=(C_el(i)*(rk00^2))-1; 
            delta=(b_pix(i)^2)-(4*a_pix(i)*c_pix(i)); 
            if(delta &gt;= 0) 
                if (delta == 0) 
                    ck00=floor(-b_pix(i)/(2*a_pix(i))); 
                    ck(i)=ck00+yc(i); 
                    rk(i)=rk00+xc(i); 
                     
                    if (ck(i) &gt; 0 &amp;amp;&amp;amp; ck(i)&amp;lt;= c) 
                        if(rk(i) &gt; 0 &amp;amp;&amp;amp; rk(i)&amp;lt;= r) 
                            nt_pix(i)=nt_pix(i)+1; 
                            if(border(rk(i),ck(i)) == 1) 
                                n_pix_found(i)=n_pix_found(i)+1; 



 

185 

 

                            end 
                        end 
                    end 
                else 
                    ck00=floor((-b_pix(i)+sqrt(delta))/(2*a_pix(i))); 
                    ck(i)=ck00+yc(i); 
                    rk(i)=rk00+xc(i); 
                     
                    if (ck(i) &gt; 0 &amp;amp;&amp;amp; ck(i)&amp;lt;= c) 
                        if(rk(i) &gt; 0 &amp;amp;&amp;amp; rk(i)&amp;lt;= r) 
                            nt_pix(i)=nt_pix(i)+1; 
                            if(border(rk(i),ck(i)) == 1) 
                                n_pix_found(i)=n_pix_found(i)+1; 
                            end 
                        end 
                    end 
                    ck00=floor((-b_pix(i)-sqrt(delta))/(2*a_pix(i))); 
                    ck(i)=ck00+yc(i); 
                    rk(i)=rk00+xc(i); 
                     
                    if (ck(i) &gt; 0 &amp;amp;&amp;amp; ck(i)&amp;lt;= c) 
                        if(rk(i) &gt; 0 &amp;amp;&amp;amp; rk(i)&amp;lt;= r) 
                            nt_pix(i)=nt_pix(i)+1; 
                            if(border(rk(i),ck(i)) == 1) 
                                n_pix_found(i)=n_pix_found(i)+1; 
                            end 
                        end 
                    end 
                end 
            end 
        end 
     end 
    imax=0; 
    nm_pix=0; 
    pix_rate=0; 
    for i=1:4 
        p_r=n_pix_found(i)/nt_pix(i); 
        if(p_r &gt; nm_pix) 
            nm_pix=p_r; 
            imax=i; 
            pix_rate=p_r; 
        end 
    end 
     
%    disp(['n_pix_found = ',num2str(n_pix_found(imax))]); 
%    disp(['total de pixels de borda na imagem: ',num2str(nt_pix(imax))]); 
%    disp([' &gt;&gt;&gt;&gt; pixel rate = ',num2str(pix_rate)]); 
%     
%    disp(' ***** Parâmetros  geométricos obtidos ***** '); 
%     
%    disp(['xc(',num2str(imax),') = ',num2str(xc(imax))]); 
%    disp(['yc(',num2str(imax),') = ',num2str(yc(imax))]); 



 

186 

 

%    disp(['a_el(',num2str(imax),') = ',num2str(a_el(imax))]); 
%    disp(['b_el(',num2str(imax),') = ',num2str(b_el(imax))]); 
%    disp(['theta_el(',num2str(imax),') = ',num2str(theta_el(imax))]) 
     
    % 
    %   threshold of 60 % for the ellipse found 
    % 
     
%    imtool(border); 
%    disp('Press enter to continue ... '); 
%    pause; 
    if (pix_rate &gt;= 0.55 &amp;amp;&amp;amp; pix_rate &amp;lt;1.0) 
        if flag == 0 
            n_found=1; 
            flag=1; 
            x_c(n_found)=xc(imax); 
            y_c(n_found)=yc(imax); 
            a_ell(n_found)=a_el(imax); 
            b_ell(n_found)=b_el(imax); 
            theta_ell(n_found)=theta_el(imax); 
             
            A_ell(n_found)=A_el(imax); 
            B_ell(n_found)=B_el(imax); 
            C_ell(n_found)=C_el(imax); 
             
            % 
            %   clear the ellipse edge and its neighbour for more  
            %   ellipses/image evaluation 
            %   using general ellipse equation 
            %   (A_ell)*c^2+(B_ell*r)*c+(C_ell*r^2 - 1) = 0 
            %   apix = A_ell 
            %   bpix = B_ell*r 
            %   cpix = C_ell*r^2 - 1 
            % 
             
            for rell=floor(-r/2):floor(r/2) 
                 
                apix=A_ell(n_found); 
                bpix=B_ell(n_found)*rell; 
                cpix=(C_ell(n_found)*rell^2)-1; 
                 
                delta_ell=(bpix^2)-4*apix*cpix; 
                 
                if delta_ell &gt;= 0 
                    if delta_ell == 0 
                        cell=-bpix/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 



 

187 

 

                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                    else 
                        cell=(-bpix+sqrt(delta_ell))/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 



 

188 

 

                                border(rf-1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                    
                        cell=(-bpix-sqrt(delta_ell))/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf)=0; 
                            end 
                        end 



 

189 

 

                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                    end 
                end 
            end 
        else 
            n_found=n_found+1; 
            x_c(n_found)=xc(imax); 
            y_c(n_found)=yc(imax); 
            a_ell(n_found)=a_el(imax); 
            b_ell(n_found)=b_el(imax); 
            theta_ell(n_found)=theta_el(imax); 
             
            A_ell(n_found)=A_el(imax); 
            B_ell(n_found)=B_el(imax); 
            C_ell(n_found)=C_el(imax); 
             
            % 
            %   clear the ellipse edge and its neighbour for more  



 

190 

 

            %   ellipses/image evaluation 
            %   using general ellipse equation 
            %   (A_ell)*c^2+(B_ell*r)*c+(C_ell*r^2 - 1) = 0 
            %   apix = A_ell 
            %   bpix = B_ell*r 
            %   cpix = C_ell*r^2 - 1 
            % 
             
            for rell=floor(-r/2):floor(r/2) 
                 
                apix=A_ell(n_found); 
                bpix=B_ell(n_found)*rell; 
                cpix=(C_ell(n_found)*rell^2)-1; 
                 
                delta_ell=(bpix^2)-4*apix*cpix; 
                 
                if delta_ell &gt;= 0 
                    if delta_ell == 0 
                        cell=-bpix/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 



 

191 

 

                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                    else 
                        cell=(-bpix+sqrt(delta_ell))/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 



 

192 

 

                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                     
                        cell=(-bpix-sqrt(delta_ell))/(2*apix); 
                        rf=rell+x_c(n_found); 
                        cf=floor(cell)+y_c(n_found); 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c); 
                                border(rf,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf&amp;lt;=c) 
                                border(rf+1,cf)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf&amp;lt;= r) 
                            if (cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf-1,cf-1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 
                                border(rf+1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt;1 &amp;amp;&amp;amp; rf&amp;lt;=r) 
                            if(cf &gt; 0 &amp;amp;&amp;amp; cf &amp;lt;c) 



 

193 

 

                                border(rf-1,cf+1)=0; 
                            end 
                        end 
                        if(rf &gt; 0 &amp;amp;&amp;amp; rf &amp;lt;r) 
                            if(cf &gt; 1 &amp;amp;&amp;amp; cf&amp;lt;= c) 
                                border(rf+1,cf-1)=0; 
                            end 
                        end 
                    end 
                end 
            end 
             
            % 
            %   Checking for concentryc ellipses 
            % 
            if(n_found &gt; 1) 
                nf_1=n_found-1; 
                for p=1:nf_1 
                    delta_xc=x_c(n_found)-x_c(p); 
                    delta_yc=y_c(n_found)-y_c(p); 
                    d_xy=sqrt(delta_xc^2 + delta_yc^2); 
                 
                    d_ellp=sqrt(a_ell(p)^2+b_ell(p)^2); 
                    d_elln=sqrt(a_ell(n_found)^2+b_ell(n_found)^2); 
                    d_ellnp=d_elln-d_ellp;  
                     
                    if(d_ellnp &gt; 0) 
                        ab=sqrt(a_ell(p)^2+b_ell(p)^2); 
                        if(d_xy &amp;lt;ab) 
                            x_c(p)=x_c(n_found); 
                            y_c(p)=y_c(n_found); 
                            a_ell(p)=a_ell(n_found); 
                            b_ell(p)=b_ell(n_found); 
                            theta_ell(p)=theta_ell(n_found); 
                            A_ell(p)=A_ell(n_found); 
                            B_ell(p)=B_ell(n_found); 
                            C_ell(p)=C_ell(n_found); 
                             
                            % 
                            %   Discard the internal ellipse and 
                            %   decrease b_found number 
                            % 
                             
                            x_c(n_found)=0; 
                            y_c(n_found)=0; 
                            a_ell(n_found)=0; 
                            b_ell(n_found)=0; 
                            theta_ell(n_found)=0; 
                            A_ell(n_found)=0; 
                            B_ell(n_found)=0; 
                            C_ell(n_found)=0; 
                             



 

194 

 

                            n_found=n_found-1;    
                        end 
                    else 
                        ab=sqrt(a_ell(n_found)^2+b_ell(n_found)^2); 
                        if(d_xy &amp;lt;ab) 
                             
                            % 
                            %   Discard the internal ellipse and 
                            %   decrease b_found number 
                            % 
                             
                            x_c(n_found)=0; 
                            y_c(n_found)=0; 
                            a_ell(n_found)=0; 
                            b_ell(n_found)=0; 
                            theta_ell(n_found)=0; 
                            A_ell(n_found)=0; 
                            B_ell(n_found)=0; 
                            C_ell(n_found)=0; 
                             
                            n_found=n_found-1;    
                        end 
                    end 
                end 
            end 
        end 
    else 
        flag=2; 
    end 
%imtool(border); 
%disp(['flag = ',num2str(flag)]); 
%disp(['nfound = ',num2str(n_found)]); 
%disp('&gt;&gt;&gt; Pause - Press any key to continue ...'); 
%pause; 
end 
end 

 

 

 

 

 

 


	Capa, Folha de Rosto_atualizado
	PedroLuizSantosSerra_D
	Sumario_revisado
	I-INTRODUÇÃO_rev
	II-OBJETIVO-rev
	III-REVISÃO_BIBLIOGRÁFICA_rev
	IV-METODOLOGIA_I_rev
	IV-METODOLOGIA_II_rev
	V-RESULTADOS-I_rev
	V-RESULTADOS-II_rev
	VI-CONCLUSÕES_rev
	REFERÊNCIAS_BIBLIOGRÁFICAS_rev
	Apendice_A_rev
	Apendice_B_rev
	Apendice_C_rev


</field>
	</doc>
</add>