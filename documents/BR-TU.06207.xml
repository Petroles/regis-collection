<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06207</field>
		<field name="filename">10725_280141.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">AGUSTINHO PLUCENIO
DESENVOLVIMENTO DE TECNICAS
DE CONTROLE nAo LINEAR PARA elevacAo DE FLUIDOS multifAsicos
FLORIANOPOLIS 2010
UNIVERSIDADE FEDERAL DE SANTA CATARINA PROGRAMA DE pós-graduaçAo EM ENGENHARIA DE AUTOMAÇAó E SISTEMAS
DESENVOLVIMENTO DE tECNICAS DE CONTROLE nAó LINEAR PARA elevaçAo DE FLUIDOS multifAsicos
Tese submetida à Universidade Federal de Santa Catarina como parte dos requisitos para a obtenção do grau de Doutor em Engenharia de Automaçao e Sistemas.
Agustinho Plucenio
Florianópolis, Maio de 2010.
Catalogação na fonte pela Biblioteca Universitária da
Universidade Federal de Santa Catarina
P733d Plucenio, Agustinho
Desenvolvimento de técnicas de controle não linear para elevação de fluidos multifásicos [tese] / Agustinho Plucenio ; orientador, Daniel Juan Pagano. - Florianópolis, SC, 2010.
275 p.: il., grafs., tabs.
Tese (doutorado) - Universidade Federal de Santa Catarina, Centro Tecnológico. Programa de Pós-Graduação em Engenharia de Automação e Sistemas.
Inclui referências
1. Engenharia de sistemas. 2. Controle preditivo para sistemas não lineares. 3. Elevação por injeção contínua de gás. I. Pagano, Daniel Juan. II. Universidade Federal de Santa Catarina. Programa de Pós-Graduação em Engenharia de Automação e Sistemas. III. Título.
CDU 621.3-231.2(021)
DESENVOLVIMENTO DE TÉCNICAS DE CONTROLE NAO LINEAR PARA elevacAo DE FLUIDOS multifAsicos
Agustinho Plucenio
‘Esta Tese foi julgada adequada, servindo como requisito parcial para a obtenção do Título de Doutor em Engenharia de Automaçao e Sistemas, e aprovado em sua forma final pelo Programa de Pós-Graduação em Engenharia de Automaçao e Sistemas da Universidade Federal de Santa Catarina.'
Daniel J. Pagano, Dr.
Orientador
Eugênio de Bona Castelan Neto, Dr.
Coordenador do Programa de Pós-Graduação em Engenharia de Automação e Sistemas
Banca Examinadora:
Daniel J. Pagano, Dr. Presidente
Adhemar de Barros Fontes, Dr.
Mario C. Massa de Campos, Dr.
Pedro Garcia Gil, Dr.
Julio Elias Normey Rico, Dr.
Eduardo Camponogara, Dr.
Dedicatoria
A memoria de meus queridos pais José e Celina Aurelia Plucenio.
vi
Agradecimentos
Agradeço a minha esposa Márcia e aos meus filhos Daniel, Renata e Guilherme pelo incondicional carinho e apoio.
viii
Resumo da tese apresentada à UFSC como parte dos requisitos necessários para obtenção do grau de Doutor em Engenharia de Automaçao e Sistemas.
Desenvolvimento de Técnicas de Controle Não Linear para Elevacao de Fluidos
-&gt;
Multifésicos
Agustinho Plucenio
Maio/2010.
Orientador: Prof. Dr. Daniel Juan Pagano
Area de Concentração: Controle e Automação
Palavras-chave: Controle Preditivo para Sistemas Não
Lineares, Elevação por Injecao Contínua de Gas
Numero de Paginas: 341
O ambiente no fundo de poçcos de petroleo e hostil. Altas pressãoes e temperaturas frequentemente combinadas com a presenca de fluidos acidos são um desafio para a instalação de instrumentacão de fundo de poco. Alem das condições do ambiente, ha a dificuldade de prover alimentaçcãao de energia para esses instrumentos e meios de comunicação com a superfície. Não menos importante é o desafio tecnológico da medicao das vazães de agua, oleo e gas em escoamento multifasico com tecnicas nao intrusivas e com baixa perda de pressão. Para com-pletaçães em aguas profundas e especialmente com a cabeca do poço instalada no fundo do mar (arvore de Natal molhada), uma operaçao para a troca de um instrumento de fundo de pocço pode significar custos da ordem de ate dezenas de milhãoes de dolares. Esta situaçcaão inibiu por muito tempo o desenvolvimento de instrumentaçcãao para fundo de poco e possivelmente foi um dos fatores que influenciou o baixo nível de
pesquisa em modelos e técnicas de controle e automação da produção já que para controlar deve-se medir. Felizmente, nos Ultimos 10 anos, tem havido um grande desenvolvimento de instrumentos de medicão e atuaçao para uso no fundo de pocos. Paralelamente ao esforço na érea de instrumentacçãao tem havido avançcos no desenvolvimento de téecnicas de controle e automaçcãao para a produçcaão de petroéleo protagonizados pelas grandes empresas operadoras. As soluções propostas por cada empresa recebem diferentes denominacães como Campo Inteligente, Poço Inteligente, Gerenciamento digital e integrado da produção, etc, mas, independente da denominaçcãao, consistem na aplicaçcãao de téecnicas de controle, automacçãao e otimizaçcaão para o desenvolvimento de um campo de petroéleo. Frequentemente as soluçcãoes propostas saão incipientes e utilizam heurísticas nas tomadas de decisoes frente a falta de modelos representativos dos processos e da ausência de medição de todas as variaveis necessárias. Em alguns projetos recentes de desenvolvimento de campos de petroéleo torna-se evidente que o avançco da tecnologia de instrumentaçcãao de fundo de poçco atropelou o desenvolvimento de modelos e algoritmos de controle que nãao estãao preparados para utilizar as novas mediçcoães e capacidade de atuaçcaão para a melhoria do controle dos processos de explotação. Nesses casos a empresa operadora depara-se com o problema de ter mais informacçãao do que pode utilizar. Em algumas instalacçãoes modernas a quantidade de informaçcaão ée tanta que a dificuldade é determinar quais dados armazenar e em que taxa de amostragem uma vez que existe uma percepcçaão de que essas informaçcãoes nãao estãao sendo utilizadas em toda sua plenitude.
O algoritmo de controle preditivo para sistemas não lineares desenvolvido neste trabalho pode utilizar praticamente qualquer tipo de modelo do processo jéa que obtéem a representacçãao linearizada do sistema de forma numérica. Esta característica deve permitir sua utiliza-cçãao no controle e otimizaçcaão da explotaçcãao de reservatéorios utilizando simulador de reservatéorio como modelo do processo. A dinêamica lenta das principais variéaveis e parêametros do reservatéorio permite tempos de amostragem taão grande como dias ou atée meses o que facilitaria a aplicaçcãao do algoritmo.
riser submarino. A elevação por GLC é um dos métodos de elevação artificial mais utilizados no Brasil respondendo por mais de 70 % da produçao do petréleo nacional. Os desenvolvimentos pressupãem que os poços operando via GLC disponham da mediçao da pressao e temperatura de fundo dos poços, da medição da vazao de injeçao de gas e da existência de chokes de injeção de gés com atuação automatica.
As contribuiçcãoes do trabalho saão
•	o desenvolvimento de modelos para utilização na descricão fenome-noléogica, otimizacçãao e controle do processo de elevaçcãao por GLC,
•	desenvolvimento de um algoritmo de controle MPC distribuído,
•	desenvolvimento de um algoritmo MPC pratico para sistemas não lineares,
•	aplicaçcãao de otimizacçãao e controle a um grupo de poçcos operando via GLC e
•	a aplicação de controle na operacão de um riser submarino.
Abstract of the Thesis presented to UFSC as a partial fulfillment of the requirements for the degree of Doctor in Automation and System Engineering.
Development of Non Linear Control Techniques for the lifting of Multiphase Fluids
Agustinho Plucenio
May/2010.
Advisor: Prof. Dr. Daniel Juan Pagano
Area of Concentration: Controle e Automação Keywords: Model Based Predictive Control for Non Linear Systems, Gas-Lift
Number of pages: 341
The environment at the bottom of oil wells is hostile. High pressures and temperatures combined with the presence of acid fluids are a challenge for the installation of downhole instruments. Besides the environment conditions, there is a difficulty to provide power for the instruments and means of communication to the surface. Not less important is the technological challange for measuring the flow-rates of oil, water and gas in multiphase flow with non intrusive techniques with low pressure losses. For deep water completions and specially with the well production head at the sea bottom (wet xmas-tree completion), an operation to replace a faulty downhole instrument may cost up to tens of million dollars. For a long time this situation inhibited the development of downhole instruments and it is likely the cause for the low level of research on models and techniques for the control and automation of oil production since to control it is necessary to measure. Fortunately in the last 10 years there has been a big development of instrumentation for measuring and actuation for downhole wells. Parallel to the effort in the area of instrumentation there has been advances in developing techniques of control and automation for the oil production
under the leadership of the major operating companies. The solutions proposed by these companies receive different names as Inteligent Field Technology, Smar Well Technology, Digital and Integrated Oilfied Management, etc, but, regardless of denomination, are the implementation of control techniques, automation and optimization to develop an oil field.
Quite often the proposed solutions are only incipient and use heuristics in making decisions due to the lack of representative process models and complete measurements of all variables.
In some modern oilfield development projects it becomes evident that advances in downhole instrumentation technology ran over the development of models and control algorithms that are not ready to use the new measurements and actuation capacity to improve the exploitation process. In this case the operating oil company faces the problem of having more information than it can use. In some modern facilities the amount of information is such that often the difficulty is determining what data to store and what sampling rate to adopt, as there is a perception that this information is not being used in all its fullness.
The model based predictive control algorithm for nonlinear systems developed in this work can use practically any kind of process model since it derives a linearized representation of the system numerically. This characteristic should allows its application in controlling and optimizing the exploitation of reservoirs using a reservoir simulator as the system model. The slow dynamics of the main reservoir variables and parameters allows sampling times as big as days or even months which would facilitate the implementation of the algorithm.
One of the first downhole instruments developed were the temperature and pressure downhole gages (PDG) that are being installed today in nearly all new offshore wells in Brasil. This work deals with the development of models and control techniques for multiphase flow lift approaching the gas-lift method and the fluid elevation in submarine risers. More than 70% of the oil production in Brazil is realized using ccontinuous gas-lift (GLC) as the artificial lift method. The developments assume that the wells operating with gas-lift have downhole pressure and temperature measurements, gas injection flow-rate measurements and automated injection chokes.
The contributions of this work are
•	development of gas-lift models for the phenomenological description of the process, optimization and process control,
•	development of an algorithm for distributed MPC,
•	development of an algorithm MPC for nonlinear systems,
•	application of control and optimization for a group of wells operating with gas-lift,
•	application of control for the operation of a submarine riser.
Glossário
Arvore de Natal - Conjunto de equipamentos como válvulas e conexões instalados na cabeça do poço cuja funçao principal é possibilitar o escoamento para fora ou para dentro do poço. BSW - Basic sediments and water.
Cabeca do poco - O sistema de conexões, vélvulas e adaptadores variados que proporcionam o controle da pressõao de um pocço de producçõao.
Canhoneados - Regiõo do revestimento onde foi realizado operacõo de canhoneio visando estabelecer comunicacõo hi-draéulica entre o pocço e a formaçcõao.
Choke - Dispositivo que incorpora um orifício, utilizado para ajustar vazõao ou pressõao.
Completaçõo - Conjunto de operações realizadas depois da perfuraçcõao do poçco que visam colocar o poçco em produçcõao. Depletado - Reservatéorio cuja pressõao caiu abaixo da pressõao original devido a produçao de fluidos.
Explotaçõo - Exploracõo econômica de um campo petrolífero. Exploraçõo - Fase inicial das operações de petréleo que incluem a geraçcõao de um prospecto e a perfuracçõao de um poçco exploratéorio.
Fluido subsaturado - Fluido que na pressõao e temperatura em que se encontra é 100% líquido.
Gas lift manifold - Secõo de duto que recebe gés da unidade de compressõao e de onde saem dutos que alimentam os poçcos operando via gas lift contínuo.
GOR - Gas Oil Ratio.
Packer - Elemento instalado dentro do poço revestido que permite isolar o espaçco anular revestimento-tubo de pro-ducçãao do tubo de produçcãao.
Perfilagem - Conjunto de registros de dados da formacão obtidos por meio de ferramentas descidas no interior do poçco. Revestimento ou casing - Tubos de aço de em seçoes de aproximadamente 12 metros utilizados para fazer o isolamento do poçco com a formaçcaão.
Slick line - Operaçcãao onde ferramentas sãao descidas dentro do pocço na extremidade de um cabo de açco para realizar operacçãoes como assentamento de véalvulas de gas-lift, movimentar sliding-sleeves, etc.
Sliding Sleeve - Luva deslizante que permite bloquear ou abrir para fluxo uma zona do poco.
Tubos de produçcãao ou tubing - Tubos de açco instalados no interior dos poçcos revestidos por onde fluem os fluidos produzidos ou injetados.
Sumário
1	Introdução	1
1.1	Objetivos do Trabalho................................. 6
1.2	Organização do Trabalho .............................. 6
2	Elevação Artificial via Injeção Contínua de Gás	9
2.1	O Processo de Elevação por Injeção Contínua de Gás -
GLC................J................................. 10
2.2	Modelagem do Processo de Elevaçao por Injeçao Contínua de Gas ........................................ 14
2.2.1	Um modelo fenomenolágico a parâmetros concentrados ........................................... 18
2.2.2	Um modelo empírico para otimizacão da elevação
por GLC ...................................... 45
2.2.3	Um modelo dinâmico para controle e otimizacão 78
2.3	Conclusões e desenvolvimentos futuros................ 81
3	Controle MPC Distribuído	83
3.1	Desenvolvimento de agentes para controle de processos .	85
3.2	MPC distribuído...................................... 87
3.2.1	Decomposição da Formulacão MPC sem restricão 88
3.2.2	Aplicacão da tácnica para um problema benchmark 94
3.2.3	Comparação entre o algoritmo MPC Centralizado
e Distribuído ................................ 97
3.2.4	Desempenho do algoritmo MPC distribuído ...	99
3.3	Convergâencia do Algoritmo MPC distribuído ......... 101
3.4	MPC distribuído na presencça de restriçcoães ....... 103
3.4.1	Restrições sobre Au............................105
3.4.2	Restrições sobre u.............................109
3.4.3	Restrições sobre y.............................112
3.5	Conclusões e desenvolvimentos futuros.................120
4	MPC Prático para sistemas não lineares - PNMPC 121
4.1	Introduçõo............................................121
4.2	Metodologias de MPC para Processos Nõo Lineares . . . 123
4.2.1	MPC com modelos de prediçõo nao-linear na Funçõo
Objetivo.......................................123
4.2.2	Métodos baseados em	modelos particulares . . . 124
4.2.3	Métodos baseados em	linearizações...........124
4.3	Desenvolvimento da técnica PNMPC......................127
4.3.1	A obtençõo de F e Gpnmpc.......................137
4.3.2	Obtençõo da açõo	de controle..................138
4.3.3	Exemplo 1......................................138
4.4	Erro de prediçõo, ruído e perturbações................141
4.4.1	Exemplo 2......................................144
4.5	Aplicaçõo em processos multivariéveis.................148
4.5.1	Exemplo 3 - PNMPC aplicado no controle de
uma Planta com 6 Tanques Esféricos.............148
4.6	PNMPC com Gradiente Ponderado.........................155
4.6.1	Exemplo 4 - PNMPC aplicado no controle da
reacõo Van Der Vussen..........................159
4.7	Estabilidade..........................................168
4.7.1	Desenvolvendo uma condiçõo suficiente para estabilidade .................................... 168
4.7.2	Introduzindo a condiçao para estabilidade na for-
mulaçõo MPC com PQ ............................170
4.7.3	Aplicaçõo da tecnica...........................172
4.7.4	Método iterativo para a restriçõo quadrática so-
bre Au ........................................174
4.8	Conclusõo e desenvolvimentos futuros .................192
5	Controle aplicado a poços operando via GLC	195
5.1	Introducão............................................196
5.1.1	Elf 1990 ..................................... 197
5.1.2	Suez Oil Co. 1995 ............................ 198
5.1.3	Shell 1998 ................................... 199
5.1.4	Texaco 1999 .................................. 203
5.1.5	TotalFinaElf 2002 ............................ 204
5.1.6	Dubai Petroleum Company 2006 ................. 205
5.1.7	Petrobras 2006 ............................... 206
5.2	Um sistema de Controle automático com ênfase na otimiza-
ção da produção.......................................208
5.2.1	Obtencao da vazão de gás disponível para injeção
nos poçcos ................................... 209
5.2.2	Controlador PI com açao Feed-Forward considerando
a dinêmica da valvula..........................217
5.2.3	Sántese dos parêmetros de um Controlador Ro-
busto com acçãao FF .......................... 221
5.2.4	Resultados obtidos com simulaçao na sántese do
controlador robusto .......................... 222
5.2.5	Implementacão da Proposta para Automação de
um Grupo de Pocços ........................... 227
5.2.6	Um estudo de caso para operação com restrição . 230
5.3	Um sistema de Controle automático utilizando a técnica
de controle preditivo baseado em modelo PNMPC . . . 237
5.3.1	A formulaçao NMPC..............................238
5.3.2	A função custo para o algoritmo PNMPC .... 239
5.3.3	Sintonia do algoritmo PNMPC....................246
5.3.4	Resultados obtidos.............................248
5.4	Conclusães e desenvolvimentos futuros.................252
6	Controle de escoamento em risers	255
6.1	Introducão............................................255
6.2	Revisitando a estratágia PI para suprimir slug-flow . . . 259
6.3	Estratágia Slug SMC...................................261
6.4	Uma estratágia slug SMC modificada....................264
6.5	Controle Slug Washout SMC.............................268
6.6	Conclusões ...........................................271
7	Conclusões e desenvolvimentos futuros	275
A Introdução ao Controle Preditivo Baseado em Modelo281
A.1	Introdução......................................281
A.2	Conceitos Básicos de MPC .......................285
A.2.1 Tipos de Controle Preditivo para Sistemas Lineares288
A.2.2 DMC - Dynamic Matrix	Control............289
Lista de Figuras
2.1	Elevação por Injeção Contínua de Gás................. 11
2.2	Curva Típica da Vazão de Líquido e Pressão na frente
dos Canhoneados x Vazao Mássica de Gás de Injeçao . .	12
2.3	Poco operando com Gas-lift........................... 20
2.4	Fracão mássica de gas................................ 24
2.5	Alguns resultados para regime permanente............. 38
2.6	Alguns resultados de simulação dinâmica I............ 39
2.7	Alguns resultados de simulação dinâmica II........... 40
2.8	Resultados com o simulador OLGA2000MR	I......... 41
2.9	Resultados com o simulador OLGA2000MR	II........ 42
2.10	Comportamento tipo árbita fechada................... 42
2.11	Equilábrios com modelo desenvolvido................. 43
2.12	Equilábrios com OLGA2000MR.......................... 43
2.13	Simulação dinamica p/ Pr = 11 MPa com qgf = 0.55
kg/s................................................. 44
2.14	Modelo de influxo................................... 47
2.15	IPR	linear + Vogel.................................... 56
2.16	pwf	=	f (qinj)	para poços UFSC-1	a 4	  66
2.17	pwf	=	f(qinj)	para poços UFSC-5	a 8	  66
2.18	pwf	=	f (qi„j)	para poco UFSC-15	................. 68
2.19	pwf = f (qinj) para poco
2.20	pwf = f(qinj) para poco
2.21	pwf = f(qinj) para poco
2.22	pwf = f(qinj) para poco
2.23	pwf = f(qinj) para poco
UFSC-17 ............... 70
UFSC-20 ............... 71
UFSC-21 ............... 73
UFSC-23 ............... 74
UFSC-75 ............... 76
2.24	pwf = f (qinj) para poco exemplo com Pr = 11.0 MPa 77
2.25	Estrutura do Modelo dinamico baseado em Hammerstein 79
2.26	Parâmetros identificados................................. 80
3.1	Estrutura de Controle com Agentes......................... 86
3.2	Diagrama esquemático da coluna de destilação.............. 95
3.3	Controle via agentes...................................... 97
3.4	Resposta com DMC distribuído.............................. 98
3.5	Resposta com DMC centralizado............................. 99
3.6	Comparação entre o numero de iteraçães e o erro de
seguimento de referância..................................100
3.7	Resposta do MPC Distribuádo com restricao Au1 &amp;lt;0.05 107
3.8	Resposta do MPC Centralizado com restricao Au1 &amp;lt;0.05108
3.9	Resposta do MPC Distribuído com restrição Au1 &gt; -0.05109
3.10	Resposta do MPC Centralizado com restriçao Au1 &gt;
-0.05 ................................................... 110
3.11	Resposta do MPC Distribuído com restriçao u1 &amp;lt;0.35 . 112
3.12	Resposta do MPC Centralizado com restriçao u1 &amp;lt;0.35 113
3.13	Resposta utilizando MPC centralizado com restrição em
y2, y2 &amp;lt;0.26	.......................................118
3.14	Resposta utilizando MPC distribuído com 35 trocas de
informacão e restricão em y2, y2 &amp;lt;0.26 ..............118
3.15	Resposta com MPC distribuído com 50 trocas de informação e restrição em y2, y2 &amp;lt;0.26.....................119
4.1	Resultados	de seguimento	de	referância	com PNMPC .	.	139
4.2	Resultados	de seguimento	de	referância	com NEPSAC	.	139
4.3	Resultados	de seguimento	de	referância	com PNMPC .	.	140
4.4	Resultados	de seguimento	de	referância	com NEPSAC	.	140
4.5	Diagrama de Blocos para o tratamento de erro de modelagem e ruído ....................................... 142
4.6	Resposta	'	perturbação na	saída................145
4.7	Resposta	'	perturbação na	saída	com ruído e	a =	0	.	.	.	146
4.8	Resposta	a	perturbação na	saída	com ruído e	a =	0.7	.	.	147
4.9	Planta com	6 Tanques Esfíricos .........................150
4.10	Respostas em Malha Aberta................................152
4.11	Respostas de h3 e h6 em Malha Fechada...............152
4.12	Ação de Controle em Malha Fechada...................153
4.13	Respostas de h1, h2, h4 e h5 em Malha Fechada .... 154
4.14	Comparação entre as predições com o modelo e com o
algoritmo PNMPC em T=40.05 min.......................154
4.15	Interpretação gráfica do gradiente ponderado........156
4.16	Comparação entre predicao com modelo nao linear e mo-
delo linearizado com Gradiente Ponderado.............158
4.17	Comparaçao entre predição com modelo não linear e mo-
delo linearizado com Gradiente Ponderado Simplificado 158
4.18	Relação entre cB e u em Regime Permanente (Curva de
equilíbrios do sistema)..............................160
4.19	Respostas em malha aberta...........................161
4.20	Controle de cb com PNMPC............................163
4.21	Controle de cb com PNMPC-Controle de erros .........163
4.22	Comparação entre Predição com o modelo e com PNMPC164
4.23	Teste de Seguimento de Referência em torno de P1 ... 165
4.24	Teste de Seguimento de Referência em torno de P1 para
uss &amp;lt;15	.........................................167
4.25	Simulaçao para erro de atraso =5....................174
4.26	Simulação sem erro no atraso........................175
4.27	Derivada da funçao de Lyapunov para erro de atraso=5 176
4.28	Desempenho do metodo com algoritmo iterativo .... 177
4.29	Sistema de aquecimento de água em linha.............178
4.30	Aplicacão de PNMPC nao robusto......................184
4.31	Aplicacao de PNMPC nao robusto com a2 = 0, 2 . . . . 185
4.32	Aplicacçãao de PNMPC robusto ...................... 187
4.33	Aplicação de PNMPC robusto-variáveis auxiliares .... 188
4.34	Resposta com aplicaçcãao da táecnica robusta ...... 190
4.35	Variáveis auxiliares obtidas com a simulacao........190
4.36	Desempenho do algoritmo com diferentes pesos P .... 191
4.37	Resultado da simulacão sem aplicacao da técnica robusta 193
4.38	Variaveis auxiliares na simulação sem a técnica robusta 193
5.1	Estratégia de Controle Dynacon.......................202
5.2	Gas lift manifold.....................................209
5.3	Controle da pressao no Gas Lift Manifold - GLM .... 210
5.4	Estratégia de controle da pressao no GLM..............212
5.5	Modelo simplificado do gas-lift manifold..............213
5.6	Estrutura de controle simplificada da pressão do gas-lift
manifold ............................................ 214
5.7	Estrutura de controle para anélise da resposta a pertur-
bação ................................................215
5.8	Perturbação tipo rampa................................216
5.9	Estrutura de controle incluindo dinâmica do choke de
injecão...............................................218
5.10	Estrutura de controle com ação feed-forward..........218
5.11	Efeito da perturbação rampa na vazão de entrada sobre
a pressaão do gas-lift manifold ..................... 223
5.12	Efeito da perturbação rampa na vazao de entrada so-
bre a pressãao do gas-lift manifold utilizando acçãao feedforward ............................................. 223
5.13	Diagrama de Nyquist mostrando o conceito de pico de
sensibilidade ....................................... 225
5.14	Resultados do projeto do PI Robusto utilizando Margem
de Ganho=2............................................225
5.15	Resultados do projeto do PI Robusto utilizando Pico de
sensibilidade igual a 3.2 ........................... 226
5.16	Sistema de Controle de Poços alimentados por um man-
ifold comum ......................................... 228
5.17	Estrutura do Controlador PC2.........................230
5.18	Carta de alocacão de gas-lift .......................231
5.19	Vazão méssica de gés entrando e saindo do GLM........232
5.20	Pressão no GLM com controle utilizando açao Feed For-
ward ................................................ 233
5.21	Pressão no GLM com controle nao utilizando açao Feed
Forward...............................................234
5.22	Pwf de todos os pocos................................235
5.23	Porcentagem de géas utilizada	por cada poçco ....... 235
5.24	Produçcaão de éoleo por poçco ...................... 236
5.25	Gas-lift manifold-GLM .............................. 238
5.26	Vazãao de géas normalizada entrando no GLM ......... 249
5.27	Pressao no GLM e no fundo dos poços x vazães saindo
do GLM ............................................. 250
5.28	Vazão de	produçao	de íleo de todos os poços........251
5.29	Vazão de	produçao	de íleo de cada poço.............251
6.1	Instalação do riser	simulado no OLGA.................256
6.2	Abertura	do choke	como parâmetro de bifurcaçao - Um
ciclo limite estível desenvolve-se a partir de uma Bifur-cacão Hopf Supercrítica (HBsup)......................257
6.3	Diagrama de bifurcaçao no plano	Pi) ............258
6.4	Diagrama de Bifurcaçao no plano (Pl, P2).............258
6.5	Resposta do sistema controlado pelo PI para pertur-bacães na vazao de entrada (5Kg.s-1 para 3.5Kg.s-1) . 260
6.6	Resposta do sistema controlado pelo PI para pertur-baçães na vazao de entrada (5Kg.s-1 para 3Kg.s-1) . . 261
6.7	Bifurcaçcãao Grazing-sliding induzida no sistema ... 262
6.8	Resposta do sistema no tempo com a estratíegia de controle SMC (Malha aberta e com controle realimentado aplicado). a) abertura do choke; b) estados do sistema . 265
6.9	Diagrama de espaço de estados no plano (Pl, P2) .... 265
6.10	Respostas de controle e saída com a lei de controle modificada (6.8) para uma perturbação na entrada .......267
6.11	Diagrama de espaçco de estados para o sistema com a lei
de controle modificada (6.8).........................267
6.12	Resposta de controle e saídas do sistema com o slug
washout SMC para perturbacçaão na vazãao de entrada do riser .............................................. 270
6.13	Diagrama de espacço de estados do sistema com slug
washout SMC ........................................ 271
A.1 Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo .................................. 284
Lista de Tabelas
2.1	Variáveis e parâmetros utilizados no modelo....... 21
2.2	Subscritos utilizados no modelo................... 22
2.3	Parâmetros do poço de teste....................... 37
2.4	Parâmetros utilizados nos testes realizados com o simu-
lador Marlim...................................... 65
2.5	Dados do Poço UFSC-15............................. 68
2.6	Parâmetros identificados para os	dados do	Poço	UFSC-15	68
2.7	Dados do Poço UFSC-17............................. 69
2.8	Parâmetros identificados para os	dados do	Poço	UFSC-17	69
2.9	Dados do Poço UFSC-20............................. 71
2.10	Parâmetros identificados para os	dados do	Poco	UFSC-20	71
2.11	Dados do Poço UFSC-21............................ 72
2.12	Parâmetros identificados para os	dados do	Poço	UFSC-21	72
2.13	Dados do Poço UFSC-23............................ 74
2.14	Parâmetros identificados para os	dados do	Poço	UFSC-23	74
2.15	Dados do Poco UFSC-75............................ 75
2.16	Parâmetros	identificados para os dados do Poço	UFSC-75	76
2.17	Parâmetros	identificados para os dados do exemplo [1]	.	78
3.1	Parâmetros	de sintonia do algoritmo MPC......... 98
3.2	Parâmetros	de sintonia do algoritmo MPC.........104
4.1	Parâmetros e variáveis do processo................179
4.2	Parâmetros do processo de aquecimento.............181
4.3	Parâmetros de sintonia do algoritmo PNMPC sem utilização da tácnica robusta...........................183
4.4	Paraêmetros de sintonia do algoritmo PNMPC com a uti-
lizacçaão da táecnica robusta ........................ 186
4.5	Parêmetros do modelo discreto..........................187
4.6	Parêametros de sintonia do algoritmo PNMPC com a uti-
lizacçãao da táecnica robusta p/ o controle do reator de oxido de etileno ..................................... 189
5.1	Nomenclatura...........................................240
5.2	Dados dos poços........................................247
5.3	Sintonia dos parâmetros do Algoritmo	PNMPC............248
6.1	Parêmetros utilizados na simulação	do	riser............256
6.2	Parêmetros da lei de controle..........................266
Capítulo 1
Introdução
O ambiente no fundo de poços de petróleo ó hostil. Altas pressões e temperaturas frequentemente combinadas com a presença de fluidos ócidos sao um desafio para a instalação de instrumentação de fundo de poço. Além das condiçoes do ambiente, hó a dificuldade de prover alimentação de energia para esses instrumentos e meios de comunicação com a superfície. O desenvolvimento de sensores de pressão, temperatura, vazão e aceleracao baseados na tecnologia de fibra ótica permite a utilização de instrumentos que não necessitam de energia elétrica para seu funcionamento. Tanto os sensores como a transmissão da informação funciona com um feixe de luz viajando no interior da fibra e dos sensores. Esta tecnologia permite a aquisicçaão de mediçcoães imunes ao ruódo eletromagnóetico e oferece seguranca intrínsica de forma natural. Infelizmente a dificuldade de se fabricar sistemas de conexãao e desconexãao de fibras-óoticas em óaguas profundas tem inibido a utilizaçcaão desta tecnologia neste ambiente.
Não menos importante é o desafio tecnológico da medicão das vazãoes de aógua, oóleo e góas em escoamento multifaósico com tóec-nicas nãao intrusivas e com baixa perda de pressaão. A ocupaçcãao de um duto pelas fraçcãoes de óagua, óoleo e góas e as velocidades dessas fraçcãoes variam conforme o padrãao de escoamento, fazendo da medicçaão das vazãoes individuais um problema complexo quando se quer garantir passagem plena no duto. Vólvulas para fundo de pocço com acionamento na superfócie estaão sendo instaladas em novos pocços e podem trazer grandes benefócios na implementaçcãao
de estratéegias de producçãao em completacçãao de poçcos com muélti-plas zonas produtoras. O méetodo convencional utilizado para o controle da produçcãao individual de cada zona exigia em alguns casos a realizaçcãao de perfilagens para a determinaçcãao das vazãoes produzidas por cada zona seguida de operacçãoes corretivas. Essas operaçcoães corretivas podiam ser operaçcãoes de slik-line para atuar vaélvulas do tipo sliding-sleeve ou intervencçãao no pocço com sonda para isolamento permanente de uma zona. Mesmo assim as soluções eram do tipo on-off enquanto atualmente, a disponibilidade de medição e atuacão permite o controle contínuo das vazoães produzidas por cada zona produtora do poçco.
Poços injetores em multiplas zonas podem tambem se beneficiar com o controle em tempo real da vazão de injeção por zona. Na ausêencia dessas véalvulas perfis de injecçãao tem de ser realizados periodicamente e dependendo da avaliaçcaão do perfil de injeçcãao pode se decidir por reequipar o poço com novos chokes a fim de estabelecer a distribuição de injeção desejada. Isto requer a ope-raçcãao com sondas com custos proibitivos em ambiente de aéguas profundas.
Para completacçãoes em éaguas profundas e especialmente com a cabeça do poço instalada no fundo do mar (érvore de Natal molhada), uma operacão para a troca de um instrumento de fundo de poçco pode significar custos da ordem de atée dezenas de milhãoes de déolares. Esta situaçcãao inibiu por muito tempo o desenvolvimento de instrumentaçcãao para fundo de poçco e possivelmente, foi um dos fatores que influenciou o baixo nével de pesquisa em modelos e téecnicas de controle e automacçãao da produçcãao, jéa que para controlar deve-se medir. Felizmente, nos ultimos 10 anos, tem havido um grande desenvolvimento de instrumentos de mediçcãao e atuaçcãao para uso no fundo de pocços. Paralelamente ao esforçco na éarea de instrumentacçaão tem havido avancços no desenvolvimento de téecnicas de controle e automacçaão para a producçãao de petréoleo protagonizados pelas grandes empresas operadoras. As soluçcãoes propostas por cada empresa recebem diferentes denominaçcãoes tais como Campo Inteligente, Poço Inteligente, Gerenciamento Digital e Integrado da Produçcãao, etc, mas, independente da denomi-naçcãao, consistem na aplicacçãao de téecnicas de controle, automaçcãao e otimizacçãao para o desenvolvimento de um campo de petréoleo,
[2], [3], [4], [5], [6], [7], [8], [9], [10].
Frequentemente as soluçcãoes propostas saão incipientes e utilizam
heurísticas nas tomadas de decisões frente a falta de modelos representativos dos processos e da ausencia de medicõo de todas as variaveis necessarias. Em alguns projetos recentes de desenvolvimento de campos de petroleo torna-se evidente que o avanço da tecnologia de instrumentacõo de fundo de poço atropelou o desenvolvimento de modelos e algoritmos de controle que nõao estõao preparados para utilizar as novas medicoes e capacidade de at-uaçõo para a melhoria do controle dos processos de explotacõo. Nõo e incomum nesses casos acontecer a situaçao onde as empresas operadoras depararam-se com o problema de ter mais infor-maçcõoes do que podem utilizar. Em algumas instalaçcoões modernas a quantidade de informacõo é tanta que a dificuldade é determinar quais dados armazenar e em que taxa de amostragem. Existe uma percepçcaõo de que essas informaçcõoes naõo estõao sendo utilizadas em toda sua plenitude. Ha de se observar entretanto que a maioria dos poços existentes seguem funcionando com o mínimo de instrumentacõo na superfície e nenhuma instrumentaçõo de fundo de poco. Os custos para a instalacao da instrumentaçao nesses poços, principalmente em aguas profundas é elevadíssimo. Mesmo a instalacõo de instrumentos de superfície pode tornar-se inviavel devido a necessidade de parada da produçcõao do poçco, o que exige uma estrategia de agendamento em funçcõao de uma eventual parada do poçco para serviçco de manutençcõao.
Como acontece em muitos processos, a explotacõo de um campo de petroleo nõo pode ser feita de forma eficiente em malha aberta. No caso do processo de produçõo de petroleo tem-se um incentivo ainda maior para a aplicaçcõao de controle pois o processo esta em constante mudançca.
Por maiores que tenham sido os avanços nas tecnicas de modelagem de reservat orios baseados em aquisiçcõao, tratamento e in-terpretaçõo de dados de sísmica, perfilagens, testes de formaçõo, etc, naõo se conhece totalmente o campo de petroleo que se explora. O conhecimento vai se aprimorando na medida em que novos poços sõo perfurados e colocados em produçõo. Ainda assim, seja qual for o modelo considerado, poçcos saõo perfurados e sua operaçcõao tem de ser otima dentro deste cenario. O conceito de malha lenta e rápida expressa bem a situaçõo [2]. A malha lenta e onde se modela o reservatorio, decide-se pela locaçcõao de novos poçcos, faz-se an alise de risco de investimentos, etc. A malha r apida e a malha da automaçcõao dos metodos de elevaçcõao artificial, da completaçcõao inteligente, da otimizaçcõao da produçcõao, etc.
Espera-se que a troca de informações entre as duas malhas seja a chave para uma explotaçõo otimizada do reservatório. Para isto se faz necessório uma melhoria consideróvel na conectividade, disponibilidade de informações e desenvolvimento de metodologias que possam refinar os modelos dos reservatórios em funcõo da entrada de novos dados. As tomadas de decisões estarõo relacionadas principalmente com vazõoes de óagua, óoleo e góas e muito frequentemente em escoamento multifósico. O controle de escoamento multifaósico pode contribuir, por exemplo, na produçcõao de petróoleo em risers submarinos ou na operaçcõao de poçcos com el-evaçao por injeçõo contínua de gas (GLC), um dos métodos de elevacõo artificial de petróleo mais utilizados no Brasil.
Na medida em que as novas descobertas de campos petrolóferos no Brasil se deslocam para longe da costa, como óe o caso dos campos do próe-sal, fica cada vez mais importante o desenvolvimento de tóecnicas de controle e otimizaçcõao que contribuam para o desenvolvimento de um sistema de operaçcõao remota das unidades de produçõo que, na contingência de uma falha de comunicacõo, possa operar a unidade de forma segura, ótima e autênoma por algum tempo. A literatura sobre controle e otimizaçcaõo da ope-raçcõao de poçcos operando com elevaçcõao via GLC óe vasta mas os problemas tratados diferem em funçcõao das caracterósticas dos poços sendo considerados. No Brasil mais de 70% da produçao de petroóleo óe proveniente de aóguas profundas e realizada com elevacçõao por GLC. Neste ambiente os custos de perfuraçcaõo, com-pletaçcõao e operaçcõao dos poçcos óe muito elevado fazendo com que somente aqueles poçcos com consideróavel produçcaõo sejam completados. Todos os esforços sõo feitos no sentido de garantir que os insumos necessóarios para a operaçcõao oótima dos poçcos estejam disponóveis incluindo a compressõao e tratamento de góas para uti-lizaçcaõo nos poçcos operando via GLC. Os poçcos atuais nõao dispõoem de choke de produçcõao com acionamento automaótico e somente nos uóltimos anos iniciou-se um esforçco para instalar chokes de in-jecçõao automaóticos nos poçcos operando via GLC. Nos uóltimos dez anos tem havido tambóem um esforçco na instalaçcõao de medidores de pressao e temperatura de fundo de poço (Permanent Downhole Gage). Muito mais recentemente tem havido a completaçõo de alguns pocços com completaçcaõo inteligente onde sõao instalados medidores de pressõao, temperatura e vazaõo alóem de vóalvulas com acionamento hidróaulico ou elóetrico a partir da superfócie.
O cenóario sobre o qual desenvolve-se este trabalho consiste de
poços com choke de produção manual mas com choke de injeção de gás automático e com medição da pressão e temperatura de fundo.
Este trabalho procura contribuir em duas áreas distintas; i) desenvolvimento de modelos para utilizacão no controle e otimização de poços operando via GLC e ii) desenvolvimento de tecnicas de controle para aplicaçcaão em unidades de producçaão de petráoleo.
Com relaçao ' primeira contribuição procura-se desenvolver modelos fenomenolágicos mais simples do que aqueles utilizados por simuladores comerciais para determinar os diferentes comportamentos dinâmicos do poço em função de suas principais características. Desenvolve-se tambám modelos de regime permanente para utilizaçcãao na otimizaçcaão da distribuiçcãao de gáas disponável e por uáltimo um modelo para utilizaçcãao em controle baseado na representação Hammerstein que preserva a relação de regime permanente e introduz um comportamento dinâmico aproximado.
As contribuições no desenvolvimento de tecnicas de controle são duas: i) desenvolve-se uma tácnica para a aplicacão de controle preditivo distribuádo que permite o tratamento de restricçãoes em entradas e saádas. A ideia áe poder implementar o controle de poços de forma distribuída em trabalhos futuros. ii) Propoe-se um algoritmo práatico de controle preditivo baseado em modelo para sistemas não lineares (PNMPC). O algoritmo desenvolvido pode utilizar praticamente qualquer forma de modelo jaá que a represen-taçcãao linearizada das prediçcãoes áe obtida de forma numáerica. Esta caracterástica deve permitir sua utilizacçãao no controle e otimiza-çcãao da explotacçãao de reservatáorios utilizando simulador de reser-vatáorio como modelo do processo. A natureza lenta da evoluçcãao das principais variáaveis e parâametros do reservatáorio permite tempos de amostragem tãao grande como dias ou atáe meses o que facilitaria a aplicaçcãao do algoritmo. O trabalho contribui tambáem com a aplicaçcãao de táecnicas de controle e otimizaçcãao sobre um sistema constituído de um manifold de gas lift e poços operando via injecão contínua de gas. Uma primeira abordagem mostra a aplicaçcãao de controle com o objetivo de otimizar a produçcãao e estabilizar a pressão no manifold de gas lift sem atuar na estabi-lizaçcaão da dinaâmica dos poçcos. Uma segunda abordagem apresentada consiste na aplicação do algoritmo PNMPC a um manifold de gas lift e um grupo de poçcos com o objetivo de otimizar a produção, estabilizar a pressão no manifold e minimizar as os-
cilações na vazão de produção no fundo dos poços. Para finalizar aplicam-se técnicas de controle de estrutura variável na producão de petréleo e gás em um riser submarino com o objetivo de estabilizar a produção com o mínimo de queda de pressão no choke de superfécie.
1.1	Objetivos do Trabalho
O objetivo deste trabalho é contribuir com o desenvolvimento de modelos e téecnicas de controle e automacçãao para a elevaçcãao de fluido multifásicos. A enfase principal é na automação e controle de poços operando por Injeção Contínua de Gas (GLC) e na es-tabilizaçcãao do escoamento em risers submarinos de produçcãao.
1.2	Organização do Trabalho
No capítulo 2 apresenta-se o método de elevação artificial via injeção conténua de gas, GLC e três diferentes abordagens para a modelagem do processo.
No capétulo 3 apresenta-se uma técnica para a aplicação de controle preditivo baseado em modelo de forma distribuéda onde existe um agente para cada acão de controle. Esses agentes executam um mesmo tipo de algoritmo cuja instanciaçcãao depende dos relacionamentos com os agentes vizinhos o que ée dependente do tipo de acoplamento existente no processo sendo controlado. As açães de controle são obtidas depois de um determinado numero de troca de informaçcãoes entre os agentes. O sistema desenvolvido ée capaz de tratar as restriçcoães tépicas como limitaçcãoes nas vari-açcãoes da açcaão de controle entre tempos de amostragem, nos valores méaximo e ménimo das açcãoes de controle e nos valores maéximo e ménimo das saédas.
Taylor de segunda ordem. Desenvolve-se ainda um método para tratar erros de modelagem e ruído e uma forma de introduzir a demanda por estabilidade na função objetivo. O metodo e aplicado com sucesso a alguns sistemas apresentados na literatura.
No capítulo 5 discute-se a aplicação de tecnicas de controle e otimização da produção de pocos operando via GLC. Uma primeira abordagem desconsidera a dinâmica dos poços e propãe uma tec-nica que estabiliza a pressão no manifold de gas lift e, utilizando os desenvolvimentos de modelos apresentados no capítulo 2 garante a operaçcãao dos poçcos ocorrendo de forma otima sob uma determinada metrica. Uma segunda abordagem utiliza a modelagem desenvolvida no capítulo 2 e aplica a tecnica de controle predi-tivo para sistemas não lineares desenvolvida no capítulo 4 a um sistema constituído de um manifold de gas lift e 4 poços. O objetivo de controle e estabilizar a pressão no manifold, minimizar as oscilacçãoes na vazãao de produçcãao do fundo dos poçcos e otimizar a producao para a vazao de gas disponível.
No capítulo 6 discute-se o Controle de escoamento em risers submarinos. A elevação de fluído multifasico em risers submarino pode ser afetada por um fenâmeno conhecido como golfada severa induzida pelo terreno. Este fenâmeno pode acontecer em determinadas geometrias do riser e vazões de líquido e gas. Para uma determinada geometria de riser consistindo de uma parte horizontal no fundo do mar e de uma parte vertical ou inclinada, pode acontecer uma acumulacão de líquido na região de tran-siçcãao horizontal-vertical. Esta acumulaçcãao provoca uma restrição a subida do gas que se acumula aumentando a pressao neste ponto. Quando esta pressão atinge um determinado valor o gas acumulado desloca o fluido a jusante e o riser e dominado por gas baixando a pressão de fundo. O líquido começa novamente a se acumular e um novo processo se inicia. Na superfície tem-se a produçcãao na forma de golfadas alternadas dominadas por liquido ou gas. Este tipo de escoamento prejudica o processo de separacçãao alem de contribuir para a fadiga do proprio riser. O trabalho propãoe algumas tecnicas de controle para estabilizar o escoamento.
Introdução
8
Capítulo 2
Elevação Artificial via Injeção Contínua de Gás
Este capítulo apresenta o processo de produção de petróleo utilizando Elevação Artificial do Tipo Injeção Contínua de Gas (GLC). Faz uma revisão bibliogrófica sobre os trabalhos na area de modelagem do processo, apresenta algumas abordagens para a modelagem do processo e apresenta comparaçcoães com resultados obtidos com o software OLGA2000MR.
Elevação Artificial é a denominacão para as tócnicas que auxiliam a elevaçao de fluido do interior de poços de petróleo. A Elevaçcãao Artificial íe normalmente adotada quando a pressãao do reservatóorio naão óe mais suficiente para elevar o fluido produzido pela formaçao ató a superfície. Entretanto estratógias modernas de explotaçcãao podem empregar móetodos de elevaçcãao artificial antes que este estóagio de depletaçcãao do reservatoório seja al-cançcado. Existem diversos móetodos de elevaçcãao artificial sendo que os mais comuns são:
—	Bombeio Mecânico com Bomba de Haste Flexível (BM)
—	Bombeio Mecanico com Bomba de Cavidade Progressiva (BCP)
—	Bombeio com Bomba Elétrica Centrífuga Submersa (BCS)
—	Injecao Contónua de Gas (GLC)
— Injecao Intermitente de Gís (GLI)
A maioria desses mítodos são apresentados em [11]. Nesta tese abordaremos somente a elevaçao por injeção contínua de gís, GLC.
2.1	O Processo de Elevação por Injeção Contínua de Gás - GLC
A Elevacão por Injeçao Contínua de Gís (GLC) ou gas lift utiliza a injecão de gas em um ponto mais baixo da coluna de pro-duçao de forma que a mistura gís-líquido presente na coluna de produçcãao exerçca um pressãao na frente dos canhoneados inferior à pressao do reservatírio. Desta forma a mistura gís-líquido í produzida na superfície e direcionada a um separador ígua-íleo-gías. O gías produzido (ou parte do gaís dependendo do poçco) íe tratado e recomprimido para reutilizaçcãao no processo de el-evaçao. A figura 2.1 mostra o princípio de funcionamento do míetodo de Elevaçcãao por GLC. A vazãao de gías injetado, controlada pela Vílvula de Injeção de Gís na superfície, desce pelo espaçco anular revestimento-tubo de produçcaão e entra no tubo de produção pela vílvula operadora de gas lift tipicamente alojada em um tubo especial chamado mandril de gas lift. Depois de passar pela víalvula de gas lift o gías sobe no interior do tubo de produçcãao e ao gaseificar o líquido no seu interior diminui a pressãao exercida na frente dos canhoneados. A diferençca de pressaão entre a pressaão de formacçãao e a pressãao exercida pelo peso da coluna de líquido gaseificado permite a produçcãao da mistura. Os pocços completados para operacçãao com injecçãao contínua de gías sãao em geral equipados com uma síerie de víalvulas de gas lift distribuídas ao longo da coluna de producçãao. Exceto pela víalvula localizada no fundo, as demais vaílvulas sãao utilizadas para a partida do poçco ou kick-off. Estas vílvulas permitem que o tubo de produção seja gaseificado sequencialmente atravíes da abertura sequencial das vaílvulas de cima para baixo. No final do processo de partida a uínica víalvula que permite a entrada de gías no interior do tubo de produçcãao íe a víalvula localizada mais profundamente tambíem conhecida como víalvula operadora. Alíem da víalvula operadora, uma vílvula de controle da injecão de gís e um choke instalados na linha de injecçãao e produçcãao respectivamente sãao tambíem parte
Figura 2.1: Elevação por Injeção Contínua de Gás
do sistema de controle do poço. As vélvulas de gas lift são con-strucães mecanicas normalmente instaladas dentro de um tubo de producão especial chamado mandril de gas lift. Na maioria dos casos estas véalvulas saão projetadas de forma a permitirem sua retirada do mandril de gas lift para manutencçãao atravées de uma operaçcãao de slick line.
Devido ao custo muito alto na intervençcaão dos pocços completados com cabeçca de poçco instaladas no fundo do mar, alguns pocços sãao equipados sem as véalvulas de descarga jaé que estas poderiam falhar. Nestes casos a unica vélvula presente é a vélvula operadora.
Figura 2.2: Curva Tópica da Vazõo de Lóquido e Pressõo na frente dos Canhoneados x Vazao Móssica de Gós de Injeçõo
do efeito da gravidade na queda de pressaõo no tubo de produçcõao. Conforme a vazaõo de injecçõao de góas aumenta, cresce a queda de pressõao no tubo de produçcõao devido ao atrito e a inclinaçcaõo da curva diminui ató atingir-se o ponto P\. Neste ponto qualquer aumento na vazaõo do gaós injetado causaraó um aumento na queda de pressõao devido ao atrito maior do que o decróescimo devido a diminuicçõao do peso da mistura gaós-lóquido resultante. O graófico da pressao (Pwf = g(Qi)) na frente da zona canhoneada exibe uma curva que óe quase uma imagem espelho da curva da vazõao de lóquido produzido com o mónimo ocorrendo para o mesmo valor da vazaõo de injeçcõao de góas. O controle de um poçco operando via Injeçcõao Contónua de Gaós óe normalmente realizado de acordo com uma estratóegia de otimizaçcõao. Embora o góas utilizado para a injeçcõao naõo seja perdido, existe um custo para sua compressõao desde a pressõao do separador atóe a pressõao de injeçcõao. As fraçcõoes de óoleo, óagua e góas produzidas por cada poçco tem diferente impacto econêomico no processo de producçõao. A óagua produzida óe normalmente tratada antes do descarte, o góas e o óoleo produzido pela formaçcõao tem diferentes valores de mercado. Os recursos disponóveis podem tambóem impor restricçõoes como limites na ca
pacidade de separação, transporte e compressão e terão um impacto na distribuição de gás comprimido para um grupo de poços. Diversos trabalhos tem tratado este problema com diferentes tác-nicas de otimização como em [12], [13], [14], [15] e [16]. Do ponto de vista do controle estas táecnicas visam a operaçcaão do poçco dentro de uma regiao definida da curva Qnq. = f (Qinj) denominada de Regiao de Interesse Econômico. As consideraçães feitas dizem respeito ao comportamento estaático do sistema. Do ponto de vista dinôamico diversos aspectos devem ser analisados.
A vazão de um poço operando por GLC pode tornar-se bastante oscilatória ao mudar-se a vazão de injecão de gás ou quando ocorrem mudançcas na pressãao da cabecça do poçco devido a pertur-baçcoães causadas pelos processos a jusante do pocço. Este comportamento oscilatáorio áe mais forte quando a queda de pressãao no Tubo de Produção é dominada pelo termo devido a gravidade e tende a diminuir quando o termo devido ao atrito torna-se com-paravel. Isto explica a razão para os operadores aumentarem a vazãao de injeçcãao de gas como um ultimo recurso para estabilizar um poço operando por GLC. Na maioria dos casos esta solução nãao e otima. Ao contrario, dependendo da disponibilidade de gas comprimido, da produçcaão do pocço, dos custos envolvidos, o ponto de operação otimo pode situar-se bem a esquerda do ponto Pi da figura 2.2. Alem disso a operaçao dos poços com oscilações sustentadas reduz a produçcaão dos pocços em relaçcãao a operacçãao sem oscilacões. Sem mencionar os problemas causados pelas oscilações nos processos de separacçãao. Isto justifica um estudo de modelos dinôamicos que permitam realizar um controle mais eficiente sistema aumentando a produtividade e diminuindo as oscilacçãoes.
A modelagem do processo de elevaçcãao por GLC apresenta diversas dificuldades. A principal e o fato de que o fenôomeno de transporte de fluido multifasico so pode ser descrito com rigor por um conjunto de equaçcãoes diferenciais parciais e algebricas para fraçcãoes muito pequenas do tubo onde ocorre o escoamento, vide [17] e [18]. Existem diversos estudos para descrever os diferentes padrãoes de escoamentos como tipo bolhas, misturado, golfada, anular, etc., que podem ocorrer na elevaçao por GLC conforme [19]. Em geral busca-se determinar em que condiçcãoes se desenvolvem esses tipos de escoamento e quando ocorre a mudancça de um tipo de escoamento para outro, o que torna a descriçcaão do processo ainda mais complexa.
A aplicação da mecônica classica juntamente com estudos experi
mentais sobre as condições para o formação dos diferentes padrões de escoamentos tem sido utilizada para o desenvolvimento de simuladores para processos que envolvem escoamentos multifásicos incluindo a elevaçõo por GLC, vide [20].
Uma dificuldade adicional para a modelagem do processo de el-evaçcõao por GLC áe a indisponibilidade da medicçõao das principais variáveis do processo como as vazões dos diferentes fluidos em determinados pontos do processo.
2.2	Modelagem do Processo de Elevação por Injeçao Contínua de Gás
Diversos trabalhos sobre a modelagem e controle de poços operando por GLC tem sido publicados nos ultimos anos [21], [22], [23], [24], [25], [26], [27], [28], [29], [30]. Em [21] discute-se o comportamento dinâmico obtido com um simulador do processo de elevacõo por GLC que contempla o fenâmeno heading.
Em [24] e [31] obtám-se um modelo simplificado, a parâmetros concentrados, do sistema de elevaçcõao por GLC utilizando-se equaçcõoes de conservacçõao de massa nos diferentes compartimentos do poçco. O modelo proposto é representado por
x 1 = -Wgc(x) + Wiv (x,U1)	(2.1)
x2	wiv(x) wpg (x, u2)
X3	= Wr (x) - WpO(x, U2 )
onde
x1 = Massa de gás no anular
x2 = Massa de gas no Tubo de Produçao
x3 = Massa de áleo no Tubo de Produçao
wgc = Vazao de gas atravás da valvula operadora de gas lift
wiv = Vazao de gas atraves da valvula de injeçõo wpg = Vazõo de gas através do choke de produçao wpo = Vazõo de oleo atravás do choke de produçõo wr (x) = Influxo de oleo do reservatório u1 = Abertura da valvula de Injecõo de Gas u2 = Abertura do choke de producao.
Os problemas com este modelo sãao diversos. A massa total nos compartimentos nãao pode ser medida. O modelo nãao leva em conta a componente devido ao atrito no céalculo da pressãao de fundo. Aléem disso os estados naão apresentam uma relaçcãao direta com as variéaveis comumente medidas na préatica que sãao as pressões na superfície e de fundo em alguns casos. Apesar disso o modelo ée interessante pela simplicidade e parece um candidato natural para o sistema.
Os trabalhos [25], [26], [27], contribuicães do autor desta tese, sãao propostas onde o controle da dinêamica do poçco ée realizado somente com a manipulacão da vazão de injeção de gas. Supoe-se que a producçãao ée entregue a um separador mantido a uma pressãao constante. A proposta nãao considera a manipulaçcaão do choke de producão de forma deliberada jé que na maioria dos poços em operacão não se dispoe de chokes automatizados. Além disso qualquer queda de pressão no choke de producão significa aumento da pressaão de fundo e diminuiçcãao da produçcãao.
Diversos modelos lineares relacionando a vazão massica na cabeça do poçco com a vazãao méassica de géas injetado saão obtidos em diferentes pontos de operacao do sistema. Utilizando estes modelos projeta-se um controlador robusto para o controle do processo dentro da regiãao de interesse econêomico. Infelizmente, por razoães de seu alto custo, a medicçãao da vazaão méassica na cabeçca do poçco ainda naão ée utilizada inviabilizando a implementaçcãao desta téec-nica com a tecnologia de medicçãao de escoamento multiféasico atual. Em [28] apresenta-se uma proposta de modelagem do processo muito interessante e inovadora. Define-se as constantes:
R = Constante do Gés Ideal
T = Temperatura do poço
PI = índice de Produtividade do Poco
Pr = Pressao do Reservatório
Po = Pressão do Separador
g = Aceleraçao devido a gravidade
L = Comprimento do Tubo de Produção.
Definem-se as variaveis:
z = Distência vertical medida da superfície em direcão ao fundo do pocço.
rk(t, z) = Fracão volumótrica de gas, se k = g ou líquido, se k = l.
x(t, z) = Fração móssica de gós.
P(t, z) = Pressão em algum ponto no interior do poço. xL(t) = Fração massica de gas em z = L.
PL(t) = Pressao em z = L.
pk (t, z) = Densidade do gós, se k = g ou do lóquido, se k = l.
pm = Densidade da mistura lóquido e gas.
qk (t, z) = Fluxo móssico de lóquido, se k = l ou gós se k = g.
Vk = Velocidade do lóquido, se k = l ou do gós, se k = g.
Modela-se a pressão de fundo (na frente dos canhoneados) como
P (t,z)= Po +	pm(t,C )gdZ-	(2.2)
■Jo
Assume-se
Pm = xpg + (1 - x)pi,	(2.3)
pm	pl + x(pg	pl)-
Assume-se tambem que a temperatura T seja constante, o gradiente de pressão constante igual a PrLPo e o comportamento ideal do gós frente a Pressão e Temperatura. Substituindo (2.3) em (2.2)
P(t, z) = Po + pigz +	x(t, z)g(p(z) - pi(2.4)
Jo
P(k z) = Po + pigz +	x(t, Q)g((L—‘LpT+ ^Pr - pi)dZ'
dp + d (pv)
dt dz
pode-se escrever para a fração de gás e líquido (considerando não existir troca de massa entre as fases),
d(Pgrg) , d(PgrgVg) = 0 dt + dz	’
d(Piri) , d(PiriVi) = 0 dt + dz
(2.6)
Define-se a fração mássica de gás x como
rg Pg rg Pg + ri Pi
(2.7)
e adota-se um modelo de relacionamento entre Vg e Vl, onde V-x_ e a velocidade que adquire uma bolha de gás em uma coluna de líquido,
Vg - Vi = V^.	(2.8)
ri
Pode-se combinar as equaçães (2.6), (2.7) e (2.8) para obter
dx ,. dx
+ Vg d~z =0
(2.9)
Os autores propãem a seguinte soluçao para a equação (2.9)
T — z
x(t,z) = xL(t------v— )•	(2.10)
Vg
O significado da expressão (2.10) é que a fraçao de gás ao longo do tubo de produçcãao áe igual ao valor que ocorreu no fundo do poco 0 = segundos atrás. Para z = L, x(t, L) = xL(t).
A expressão para P(t, L) dada pela equacão (2.4) á trabalhada para eliminar a dependencia de z escrevendo-se
P(t,L) = PL(t) = Po + pigL +	k(t - T)xL (t)df2.11)
Jt-s
onde
õ
k(t)
L
Vg g(
tPo + (õ — t)pr õRT
— Pi)
e
t e [0, õ].
(2.12)
Neste trabalho utiliza-se a o modelo da pressão de fundo para formular uma lei de controle. A lei de Controle obtida é muito similar a um controle Proporcional e depende do calculo de um valor para Xref que depende do valor de Pref. Os resultados obtidos com simulação são promissores mas o ajuste do controlador nao parece simples alem de não dispor de acão integral e por isso dificilmente garantira erro nulo em regime permanente. Por outro lado o modelo obtido para a pressão de fundo, apesar de naão incorporar o termo devido ao atrito e um resultado interessante.
pL(t) = po + pigL +	- t)g(tP°	t)Pr - pi)Vgdr
para
t G [0, S] e S = Vl	(2.13)
Vg
2.2.1	Um modelo fenomenologico a parâmetros concentrados
Nesta seçcãao desenvolve-se um modelo fenomenologico para pocços operando por GLC com baixo custo computacional. Utiliza-se o desenvolvimento realizado por [24], [31] e [28] para obter-se um modelo que exibe o comportamento dinâmico do poço para toda a faixa de vazao de injecão. Diferentemente dos trabalhos citados, considera-se aqui o atrito no tubo de produção. Existem dois fenâomenos que geram instabilidade em poçcos operando com gas lift. O fenâmeno mais conhecido é o heading que resulta da interacçãao entre o escoamento no espacço anular e no tubo de produção quando a valvula operadora de gas lift opera em regime não
crítico. Escoamento crítico íe aquele onde a velocidade do fluido íe superior a velocidade da propagaçcãao do som nas condiçcãoes do escoamento. Mantida essa condição, as perturbaçoes na pressão em um ponto do escoamento nãao se propagam na direçcaão contraíria a direcçãao do escoamento e a vazaão depende somente da pressãao a montante. O escoamento de gías atravíes de um orifício passa a ser crítico quando a razãao entre a pressãao a juzante do orifício e a pressão a montante do orifício í menor que rcrit,
k
(2	\ k-1	c
rcrit =í k+1)	’ onde k = -p.	(2.14)
Na equacão 2.14 cp e cv são respectivamente o calor específico do gías a pressaão constante e a volume constante. Para metano e etano o valor de k í respectivamente 1, 31 e 1, 20. Para os gases utilizados no processo de elevacão do tipo GLC rcrit tem um valor da ordem de 0, 55. Na pratica se diz que o escoamento é crítico quando a pressaão a jusante íe igual ou menor do que a metade da pressaão a montante embora isto seja uma aproximacçãao.
O escoamento em víalvulas operadoras de gas lift do tipo orifício iraí apresentar escoamento crítico se a razãao entre a pressãao no tubo de produçcãao a jusante da víalvula e a pressaão no anular a montante da vílvula for menor que rcrit. Neste caso não haverí o fenêmeno heading pois elimina-se a interação entre o escoamento no tubo de produçcãao e o escoamento no espaçco anular.
Manter um escoamento onde a pressãao a montante seja aproximadamente o dobro da pressãao a jusante torna-se custoso pois a demanda de potêencia depende do produto entre a pressãao e vazãao. Alíem disso existem problemas tíecnicos relacionados com a alta pressãao a que se submeteraão os equipamentos do poçco.
O desenvolvimento de víalvulas operadoras do tipo Venturi permitiu escoamento supersêonico com perda de pressãao muito baixa. Existem víalvulas no mercado que fornecem escoamento crítico com pressão a montante apenas 10% maiores do que a pressão a jusante da vaílvula. Apesar da utilizaçcaão de víalvulas operadoras de gas lift do tipo Venturi observou-se ainda fenêomenos os-cilatíorios em determinados poçcos e em certas condiçcãoes de operação. Estas oscilações se devem ao fenêmeno denominado densitywave. Neste fenômeno, mesmo com a vazao míssica de gís constante na saída da víalvula operadora, desencadeia-se uma os-
Figura 2.3: Poço operando com Gas-lift
cilaçcãao na pressãao de fundo.
Um esquema de um poço operando por elevaçao tipo GLC é apresentado na figura 2.3.
As equaçcãoes que descrevem o escoamento no tubo de produçcãao sãao obtidas com a aplicacçãao da conservacçãao da massa e da quantidade de movimento, [1]. Estas equações descrevem o escoamento em um elemento de tubo dz. Modelando-se tanto o espaco anular como o tubo de producçãao, o comportamento do reservatéorio e utilizando-se as equacães de estado para os fluidos envolvidos pode-se aplicar téecnicas de integraçcaão para obter-se o comportamento do poçco.
Apresenta-se na sequâencia um modelo simplificado do processo que permita uma anéalise mais réapida do comportamento dinâamico do sistema. O trabalho utiliza algumas das idéeias desenvolvidas em [32], [24], [31] e [33].
Para a descriçcaão deste modelo define-se as variéaveis e parâame-tros apresentados na tabela 2.1 e os subscritos mais utilizados na tabela 2.2.
Tabela 2.1: Varióveis e parâmetros utilizados no modelo
Símbolo	descrição
z	distância vertical a partir do fundo
A	Area do tubo de producão (TP)
M.	Massa de gas ou líquido
q.	Vazao massica de gas ou líquido
x	Fracão massica de gas
r	Fracao área do TP ocup. por gas ou líquido
w	Veloc. terminal de uma bolha de gas
V.	Veloc. da fracao gas ou líquido
Usl = -^A -l A	Velocidade superficial de líquido
u — -^g Us9	-gA	Velocidade superficial de gás
p.	Densidade do gas/líquido
f	Fator de atrito
D	Diâametro do tubo de produçcãao
L	Distâancia entre sup. e fundo do poçco
g	Aceleracçãao da gravidade
M	Peso molecular do gías
Z	Compressibilidade do gís
R	Constante universal do gís ideal
T	Temperatura
T.	Temperatura na cabecça ou fundo
Pr	Pressaão estaítica do reservatoírio
pwf	Pressãao na frente dos canhoneados
pwh	Pressãao na cabecça do poçco
Ps	Pressaão no separador
PI	índice de produçao
C	Constante do choke de produçcãao
a	Constante de tempo
Tabela 2.2: Subscritos utilizados no modelo
Símbolo	descriçao
g	gaís
i	líquido
f	no fundo do pocço
c	na cabecça do pocço
if	líquido no fundo
gf	gaís no fundo
ic	líquido na cabecça
gc	gías na cabeçca
s	separador
wh	well head
si	superficial de líquido
sg	superficial de gaís
O modelo proposto e apresentado na equação 2.15.
Mfg = qgf — qgc
Mi = qif — qic
q'ff = ~[ — qif + PI (Pr — Pwf)]	(2.15)
O modelo proposto na equaçcãao 2.15 baseia-se em trôes equacçãoes diferenciais ordinarias. As duas primeiras representam o balançco de massa de gas e de líquido no interior do tubo de producão. A terceira equacçãao descreve uma dinôamica de primeira ordem para a entrada de líquido no fundo do poço. Esta é uma dinamica simplificada e inspirada no trabalho de Fetkovich na descrição do mecanismo de influxo de agua em reservatorios de oleo subsaturado, [34].
A fim de simplificar a modelagem, a distaôncia entre a valvula de gas lift e a zona canhoneada é desprezada e a pressao na frente da frente da valvula de gas lift é considerada igual a pwf. Alem disso considera-se um pocço vertical. Considera-se a vazãao de gas entrando diretamente no tubo de produçcãao atraves da valvula operadora. Esta consideracçaão representa de certo modo o que acontece quando se tem escoamento crítico. Nenhuma dessas sim-plificaçcãoes comprometem a generalizaçcãao do modelo proposto mas facilitam a apresentacçãao do mesmo. Pode-se incorporar ao modelo proposto a equaçao para a conservação da massa de gas no anular e o modelo da valvula operadora para obter-se uma rep-resentaçcãao mais geral do processo GLC visando um estudo tanto do fenômeno heading como do density wave.
Uma variavel chave para a modelagem do fenômeno density wave e a fracão massica de gas, x, apresentada na equacão 2.7 e que representa a relaçcãao entre a massa ocupada pela fraçcãao da secçãao transversal do duto contendo gas pela massa total ocupada pelo duto.
x	,	(2.16)
rg Pg + riPl
\		
onde rg	g	
	= A ’	
	\i	
ri	= e	
\	=	Ag + Al .	(2.17)
Ag e Ai são respectivamente as frações da área da seção transversal do duto ocupada pelo gás e pelo líquido.
Figura 2.4: Fraçao míssica de gís
As fraçães rg e rl podem ser utilizadas na equacao da conservacao da massa para a fase gés e léquido fluindo no tubo de produção, como
dPg rg , dPg rg vg dt	dz
dPiri + dPiriVi dt	dz
0,
0.
(2.18)
Um importante resultado de [33] foi utilizar o modelo de velocidade entre Vg e Vl apresentado na equacao 2.19 e as equacães 2.7 e 2.18 para encontrar a dinêmica de x mostrada pela equaçao diferencial parcial 2.20.
V to
Vg = Vi + ----
ri
(2.19)
dx ,, dx	.	.
dt+ Vg dz = 0	(2.20)
Aplicando-se a Transformada de Laplace na equaçcãao 2.20 obtéem-
se
sx(z, s) — x(z, 0) + Vg —dz—) = o.	(2.21)
dx(z, s)	s „
= - dz x(z, s)	Vg
(2.22)
Assumindo a origem de z = 0 como o ponto do tubo de produção na frente da valvula de gas lift e z = L como o ponto no tubo de producçãao igual a superfécie, pode-se integrar a equacçaão 2.22,
z L dx(z, s) z=0 x(z,s)
z=L
z=0
(2.23)
&lt;dz
Como J dy/y = ln y, obtem-se,
lnx(z, s) lL
ln
x(L, s)A
x(0, s) )
L
- V ’•
L
■ V
x(L, s)
- L s x(0, s)e Vg ,
(2.24)
que no domínio do tempo pode ser escrita como
xsup
(t) = xfundo(t	V ).
Vg
(2.25)
A equacão 2.25 expressa o fato que x (gas mass quality) viaja com a velocidade Vg. Isto significa que o valor de x na superfície no instante t é o mesmo que o valor de x do fundo no instante t — t sendo que t é o tempo que levou para esta propriedade chegar até a superfécie. Para uma velocidade constante do géas, temos que T = L.
A estratéegia para modelar o comportamento do escoamento no tubo de produçcaão consiste em descrever as variéaveis pressãao, fraçcaão voluméetrica de géas e léquido, vazãao de gaés e léquido, densidade do géas no fundo e na superfécie. A variaével que vai permitir a conexãao entre estes dois pontos de observacçãao ée a fracçãao méassica de gaés x. Assume-se que o sistema parte de um regime permanente estéavel com valores definidos para Pwf, Pgf, rgf, xf, Vgf, Vif, pwh, Pgc, r gcj Vgc- V etc.
Estratégia para a implementação do modelo
As variaveis, parâmetros e constantes utilizados na modelagem são apresentados na tabela 2.1. A implementaçao do modelo desenvolvido foi realizada com um pequeno programa que divide-se em 3 partes. Na primeira parte calcula-se a relaçao em regime
permanente entre Pw f e qgf. Nesta parte do programa determinase também, como será explicado na sequência, a relação entre a pressão na cabeça do poço e os estados Mg e Mi.
No segundo estágio o usuário escolhe uma vazão de injecão qgf que caracteriza o funcionamento do poço em regime permanente. O programa desenvolvido calcula então todas as condições iniciais que serao utilizadas na simulaçao. No terceiro estágio aplica-se uma vazaão de injeçcãao qgf desejada e o programa calcula a evoluçcaão das variáveis de interesse ao longo do tempo futuro definido pelo usuaário.
Uma das dificuldades do modelo proposto é a determinação dos valores em regime permanente para Mg e Mi, respectivamente a massa de gás e a massa de líquido no tubo de produçao. A estrategia utilizada para encontrar uma solução numerica que atende todas as relaccoães em regime permanente para uma determinada vazão de injecao de gás qgf constante e explicada na sequência. Inicia-se o processo com um valor inicial para a pressão de fundo, por exemplo Pwf = .95Pr. Com este valor calcula-se todas as variáaveis do fundo de pocço,
qlf	= PI (Pr - Pwf ) M
pgf =	= Pwf RT
Vgf =	- Vlf +	 rlf
Vl	qif piAif'
Alf	= rif A
Vgf =	qif	i V— pirif A	rif ’
Vgf =	=	—(-f + V- )■	(2.26) rif piA
Utilizou-se a seguinte expressão para VTO, [35]
V- = 0.35. lgD(pi - P’f &gt;
Pl
(2.27)
Tambám necessita-se de uma expressão para rl f, que obtám-se a
partir de
qgf = Pgf Vgf rgfA,
1 — rif,
rgf
qgf
rif
Pgf Vgf(1	rif)A,
(1
qgf	)
Pgf Vgf A
(2.28)
Combinando as equações 2.26 e 2.28,
Vgf	(1 —	)-1( -f + V-), Pgf Vgf A	PiA
Vgf	=	''A +	+ V-.	(2.29) PiA	PgfA
De acordo com a equaçao 2.29 a velocidade do gas no fundo é igual a soma da velocidade superficial do líquido no fundo (uslf = pqpA), da velocidade superficial do gas no fundo (usgf = ipgíA) e da velocidade terminal da bolha de gas, VTO,
Vgf = uslf + usgf +	(2.30)
O valor de rgf pode ser calculado como
3‘	Vgf Pgf A
(2.31)
Com rl = 1 — rgf o valor de Xf pode ser calculado utilizando a equação 2.7 e Vlf pode ser obtido com a equacao 2.19.
Para a determinaçcãao das variaveis na cabeçca do poçco, utiliza-se o fato de que as vazões massicas qk, k = loug sao iguais aquelas do fundo em regime permanente j a que
drkPk , drkPkVk	_
+	=0, em regime permanente,
dt	dz
drkPk = 0
dt = ’
drkPk Vk dz
dAr-kPkVk
0 ou, como A e constante,
dz
dqk dz
Alem disso x na cabeca do poco é igual ao valor no fundo do poço em regime permanente, ja que xc = xf (t — a) e xf (t) é considerado constante em regime permanente, isto e,
dx	dx	
dt + g dz	=	0, mas
dx	
	=	0,
~dt	
dx	
	= 0,
dz	
xc	= xf
qc	=	qf
em regime permanente,
Utiliza-se a expressao da vazao no choke de produção,
qc	C/Pc(Pwh	Ps),
(2.32)
onde pc representa a densidade média da mistura gás-líquido na cabeca do poco que pode ser calculada pela equação 2.33,
_ = 1
Pc = Xc .	(1-Xc) ,
pgc	pl
(2.33)
onde
Combinando-se as equações 2.32, 2.33 e 2.34 pode-se obter o valor de pwh e determinar as demais variaveis na cabeça do poco. O valor de pgc é calculado utilizando-se a equaçao 2.34. Utilizando-se o resultado obtido com a equação 2.30 pode-se escrever por induçcãao que
Vgc = usgc + uslc +	■	(2.35)
Novamente, como as vazães massicas de gas e líquido sao iguais as do fundo,
Vgc = qgf ¡APgc + qif ¡APl +	■	(2.36)
O valor de rgc e calculado como
qgf
APgcVgc
(2.37)
O valor de Vlc pode ser calculado como,
V =_________qlf____
ic~ (1 - rgc)Apl-
Tendo definido as densidades, velocidades e as fraçcãoes da íarea do tubo de produção ocupadas pelo gís e pelo líquido, alem da pressão na cabeça de produçao pode-se calcular um novo valor para a pressão de fundo. Uma expressao simplificada para a pressaão de fundo consiste em considerar somente o termo devido à gravidade e ao atrito.
Pwf-novo = Pwh + (Mg + Ml ) A + ^Patrito-	(2.39)
Para calcular as massas de gís e líquido considera-se o eixo vertical com a origem no fundo do poço (z = 0) e com (z = L) na cabeça. As expressões para Mg e Ml podem ser escritas como
LL
Mg =	Ag (z)pg (z)dz = A	rg (z) p g (z)dz
J0	J0
Mi = A (1 - rg(z))pidz	(2.40)
■Jo
Necessita-se de expressães para rg(z) e pg(z). Baseado no conhecimento do sistema optou-se por expressãoes exponenciais como
Pg(z)	= PgfekpZ
rg (z) = rgfekrZ,	(2.41)
onde kp
kr
1ln( ),
L	pgf
|ln( ).
L	rgf
(2.42)
Substituindo as expressães para pg (z) e rg (z) da equacao 2.41 na
equacão 2.40 e resolvendo, obtém-se
Mg	_ ( Pgf Argf )(e((kr+ko)L)	i) (kr 1 kp)
Mi	= PiA(L - ()(e(krL - 1)).	(2.43) kr
E interessante observar que utilizando-se tambám uma expressão exponencial para Vg (z) do tipo
Vg (z)	= Vgfekvz, com
kv = Lln( V),	(2.44)
L	vgf
obtém-se em regime permanente
drg (z)Pg (z)Vg(z) dz
drg (z)Pg (z)Vg (z) dz
kr + kp + kv
0
(kr + kp + kv )rgf Pgf Vgf '	+ k?+kv	= 0
0.
(2.45)
A constatação de que kr + kp + kv = 0 assegura que a solucao obedece a lei da continuidade para escoamento onde nãao háa conversãao gás-líquido e vice-versa. Para o cálculo da perda de pressão por atrito preferiu-se utilizar uma expressãao linear para a evoluçcãao da densidade máedia e da velocidade máedia da mistura. Este procedimento será utilizado tambem na simulacao dinâmica onde não se conhece a distribuicçãao espacial dessas variáaveis e uma aproximação linear á um bom compromisso. Definindo-se as densidades medias no fundo pf e na cabeça do poço pc, tem-se
pf = rgf Pgf + (1 — rgf )Pl,
pc = rgcPgc + (1 — rgc )Pl.	(2.46)
As velocidades da mistura sãao definidas como em [1],
uf	— usgf + uslf	
uc	=	usgc + uslc	
onde usgf	qgf	
	Pgf A	
uslf	qif PiA	
usgc	qgc PgcA’	
uslc	qic PiA'	(2.48)
A equação para a velocidade da mistura ao longo do eixo z é escrita como
.	uc — uf
u(z) = Uf 3------—-z.	(2.49)
L
A taxa de queda de pressãao por atrito pode ser escrita como
dp dz
f
2Dp(z)u(z')2, ou
(2.50)
f [L
Apatrito = 2d	p(z)ü(z)2dz	(2.51)
Substituindo as equações 2.47 e na equaçao 2.51,
Apatrito = 2D f (Pf + L z)(uf +
'	z)2 dz
(2.52)
L
A soluçao da equação 2.52 fornece
2
A = fL(2_____________) + l--2 +
Apatrito = 2d (12 Pf Uf Uc) + 12 Pc'Uf +
2______.	3 _ _2,
12 PcUcUf ) + 12 PcUc )
3 - -2
--Pf Uf
12Pf f
12
+ 12 PfUc +
(2.53)
Tendo obtido um novo valor para a pressao de fundo, pw--novo, pode-se calcular o erro
GTTOatual — pwf-novo	pwf'	(2.54)
A correcão no valor de pwf foi realizada utilizando a aplicacão
de um algoritmo de controle Proporcional Integral (PI) na forma discreta. O novo valor é calculado como
Pwf = Pwf + Corr,	(2.55)
e o valor da correçao é calculado como
Corr = Corr anterior + (kp + ki)erroatuai - kperroanterior ■ (2.56)
O algoritmo é interrompido quando atinge-se um erro com valor absoluto menor do que um valor admiss ível, eadmissvel. Na fase de regime permanente calcula-se a solucao para toda a faixa de valores de vazão de injecao de gas de interesse. Este procedimento permite determinar uma expressão para a pressão na cabeça do poço em função dos estados Mg e Ml.
Uma variavel chave para a descrição matematica do processo é a pressão na cabeça do poco. Em [33] calcula-se a pressão na cabeça com a equação 2.57,
Mg	RTc
Pwhp = AL - Mi	'	(2.57)
pi
Esta expressão foi proposta para um modelo bastante simplificado. Considerando o fator de compressibilidade do gas igual a 1, a expressão seria valida se a massa de gas Mg estive toda submetida a mesma pressão. No caso em que o tubo de produção esta todo ocupado por gas MMI_9M » 1a expressao se aproxima da realidade ao se desprezar o efeito do peso do gas. Ja, para pocos não surgentes e, considerando que nao ha velocidade descendente de fluido, quando o tubo de producão esta todo ocupado por l íquido, mM9m	0, a pressão na cabeça tende a pressao do separador,
Ps. Diante disso uma proposta é a utilizacao da expressão
Mg	RTc
Pwhp = AL - Mi pl
pwh	ppwhp + (1 p)Ps
(2.58)
Obviamente deve-se tambem obter uma expressão para p. Pelo exposto e natural buscar uma expressão para p como funcao de Ig = mM9m . Como para cada valor de vazao de injeçao qgf obtem-se valores para Mg, Mi, pwh e pwhp obtem-se suficiente
informacão para ajustar uma função para p como funçao de Ig. A cada um dos n valores de qgf calcula-se
P
Pwh Ps
Pwhp Ps
Mg	.
Mg + Mo
(2.59)
Ajusta-se entãao os parôametros do polinôomio
Pestimado = k1 + k^Ig + k‘3Ig +	+ k5kg + k6kg	(2.60)
O modelo dinâmico
O modelo descrito pela equaçao 2.15 é discretizado com um tempo de amostragem Ts. A derivada de qualquer dos três estados é aproximada pela expressãao de Euler. Na modelagem dinôamica não se pode contar com algumas simplificaçães possíveis para o modelo de regime permanente. A vazãao massica, por exemplo, não e necessariamente igual ao longo do eixo vertical z e tampouco o valor de x no instante kTs é igual na cabeca e no fundo do poçco. Sabe-se que se a velocidade do gas fosse constante entãao, de acordo com a equaçcãao 2.25,
xc(t) = xf(t — t), com	(2.61)
t = L	(2.62)
Vg
O procedimento adotado para a obtençcaão de xc(kTs) consiste em manter uma matriz H com Nh linhas e três colunas. Uma coluna para o valor de Vgc, outra para Vgf e outra para xf. Em regime permanente todas as linhas saão iguais.
Na medida em que se inicia a simulaçcãao dinôamica, passado o tempo Ts todas as linhas, exceto a primeira sãao deslocadas para uma posiçcãao mais abaixo e a ultima linha e descartada. A primeira linha recebe os valores atualizados de Vgc(Ts), Vgf (Ts) e xf (Ts). O valor de xc(kTs) sera igual a xf ((k + d)Ts) sendo que para encontrar o valor de d o seguinte procedimento é adotado.
Deve-se observar que para cada instante de tempo, no lugar de uma unica velocidade, temos a velocidade no fundo do pocço, Vgf e na cabecça do pocço, Vgc. Assim no instante kTs podemos calcular
e	(2.63)
a distancia percorrida pelo gas como ALi = Vgc(kTs)Ts. Isso nos levaria para a segunda linha em um ponto Li abaixo da cabeça do poçco. A velocidade do géas na distêancia Li abaixo da cabecça no instante (k — 1)Tspode ser obtida através de uma interpolacao considerando uma distribuição de velocidade linear entre Vgf ((k — 1)Ts) e Vgc((k — 1)Ts) cujos valores estao na segunda linha da matriz H. Ou seja, a seguinte relação é vélida,
Vg (Li, (k — 1)Ts) — Vgf ((k — 1)Ts) =
L — Li Vgc((k — 1)TS) — Vgf ((k — 1)TS)
L
Vg(Li, (k — 1)Ts)=	(2.64)
Vgf ((k — 1)Ts) +	(Vgc((k — 1)Ts) — Vgf ((k — 1) Tfi )) .
Com o valor de Vg(Li, (k — 1)Ts) pode-se calcular o novo deslocamento, L2,
L2 = Li + Vg (Li, (k — 1)Ts )Ts	(2.65)
O procedimento é continuado até que o valor calculado de Ld iguale L. Neste ponto,
xc(kTs) = xf ((k — d)Ts).	(2.66)
Utilizando os dados da matriz H com Vgc na coluna 1, Vgf na coluna 2 e xf na coluna 3, o seguinte pseudo coédigo permite
determinar o valor de xc(kTs).
Le = 0;
i = 0;
while Le&lt;L
i = i + 1;
Vgz = H(i, 2) + (L - Le) * (H(i, 1) - H(i, 2))/L;
Le = Le + Vgz * Ts;
end
T = i;
xc = H(T, 3);
O valor de pwh é calculado utilizando-se a equação 2.57 com p obtido com os coeficientes previamente calculados na fase de sim-ulaçao de regimes permanente. Com pwh pode-se calcular pgc e com xc obtido com o procedimento previamente descrito pode-se calcular a densidade media na cabeça do poço, pc utilizando-se a equação 2.33. Como pc = rgcpgc + (1 — rgcpi), obtem-se rgc como
rgc
(Pl - Pc)
(Pl — pgc)
(2.67)
Calcula-se na sequência a vazao massica total na cabeca do poço para a condiçao de abertura total do choke de produção, u =1.
qc = CusJPc(pwh - Ps)
(2.68)
Supãe-se que qc &gt; 0. No caso em que rgc = 1, a vazão massica na cabeçca do poçco e igual a vazaão de g as e
qgc
^sgc
Vgc
uslc
Vlc
qc, qgc
PgcA'
^sgc
0,
0.
(2.69)
Para valores de rgc &amp;lt;1, utiliza-se as seguintes relações
^sgc	qgc pgcA qic
uslc	pi A5
Vgc	=	=	usgc 1 uslc 1 ^^5
qgc + qic =	qc,
qgc	= rgcApgcVgc,	(2.70)
para obter-se
Vgc =
qc + V^piA pc A
(2.71)
Nota-se a vazão méssica virtual V^plA na equação 2.71. A velocidade Vlc e calculada utilizando-se a equação 2.19 e as vazães méssicas de gés e líquido na cabeca do poço são calculadas,
qgc	rgcApgcVgci
qic = (1 — rgc)ApiVic.	(2.72)
A pressãao de fundo ée recalculada a cada instante de tempo utilizando-se a equacão 2.39.
Aplicaçao do modelo
A fim de verificar a qualidade do modelo desenvolvido aplicou-se ao poço tambem modelado por [1] com os parâmetros definidos na tabela 2.3.
A figura 2.5 mostra alguns resultados obtidos na fase regime permanente para o poço com os parâmetros da tabela 2.3. A figura 2.5-a mostra a relaçõo Pressõo de fundo versus vazao de injeçõo de gás. A figura 2.5-b mostra a pressõo na cabeca do poco e seu valor estimado com o polinâmio descrito pela equacõo 2.60. A figura 2.5-c mostra a distribuiçõo da fraçao de vazio, rg, ao longo do eixo vertical para uma vazõo de injecao de gás de 1.0 kg/s. Nota-se que a curva é muito semelhante aquela apresentada em
[1]	para o poco com os mesmos parâmetros e vazõo de injeçao e utilizando uma modelagem baseada na soluçcõao das equacçõoes diferenciais parciais que regem o fenâmeno. A figura 2.5-d mostra que x tem uma relaçcaõo praticamente linear em relacçõao a vazõao de
Tabela 2.3: Parâmetros do poço de teste
Símbolo Descrição	Unidade
T	Temp. na cabeça e fundo do poço	300 K]
M	Massa molar do gas	0.0289 Kg/mol]
L	Dist. da cabeca-fundo do poco	2500 m]
D	Diâm. interno tubo de produção	0.125 m]
f	Fator de atrito	0.015]
C	Constante do choke de produção	0.0058 m2]
PI	Indice de Produtividade do pocço	4 x 10-6 Kg/sPa]
rhoi	Densidade do líquido produzido	1000 Kg/m3]
Pr	Pressãao estatica da formaçcaão	18 x 106 Pa]
Ps	Pressaão do separador	1 x 106 Pa]
T	Const. Tempo vazao da formação	600s]
injeção de gas.
A figura 2.6 apresenta o comportamento da pressao de fundo pwf e da vazao de líquido na cabeça do poço qlc para a vazao de injecão de gas, qgf, com valor inicial de 2.0 kg/s que cai para 1.0 kg/s no tempo igual a 2 horas e cai novamente para 0.1 kg/s no tempo igual a 6 horas.
O comportamento da pressão de fundo para a primeira mudanca na vazãao de injeçcaão acontece dentro do esperado com uma reaçcaão do tipo resposta inversa e pouca oscilacao. Quando a vazão cai para 0.1 kg/s ocorre o fenâmeno density-wave caracterizado pelo comportamento com oscilaçcoães sustentadas da pressãao de fundo e consequente vazão de producão de líquido na cabeça do poço na forma de golfadas.
A figura 2.7 mostra o comportamento das variaveis Mg, Mi, rgc, rgf, Pwh e xf. Observa-se que todas as variaveis desenvolvem oscilacçãoes sustentadas apos a mudancça na vazãao de injeçcaão de gas no tempo igual a 6 horas.
(C)
(d)
Figura 2.5: Alguns resultados para regime permanente
tativamente as respostas das variáveis de interesse.
A figura 2.8 mostra no topo a vazão de injeção de gás seguida da pressao de fundo pwf logo e da vazao de produção de líquido na cabeça do poço qic. Nota-se uma semelhança muito forte com os resultados obtidos com o simulador desenvolvido e apresentados na figura 2.6.
A figura 2.9 apresenta no topo as fraçães de gás no fundo, rgf e na cabeça do poço, rgc seguida do grafico da pressão na cabeça do poco, pwh e da fracao mássica de gas do fundo do poco, Xf. Percebe-se que qualitativamente existe uma semelhança no comportamento das mesmas variaáveis obtidas com o simulador desenvolvido e apresentadas na figura 2.7.
A figura 2.10 mostra o mapa dos estados qif, Mg e Mi. Nota-se que a trajetáoria da curva atinge um ponto fixo na mudançca da vazão de injecão para 1.0 kg/s mas entra em uma orbita fechada (ciclo-limite estavel) na mudanca para 0.1 kg/s.
Utilizou-se o poço com os parâmetros da tabela 2.3 para realizar um estudo sobre a estabilidade do pocço quando se varia a pressãao estaática da formacçãao. Utilizando-se o modelo desenvolvido diminuiu-se a vazãao de injeçcãao atáe o ponto onde o poçco
(a)
— 2
Ol--------1-------i------iv	i	i	i	i	i	i	i	i
0	2	4	6	8	10	12	14	16	18	20	22	24
Tempo [ h ]
Figura 2.6: Alguns resultados de simulaçao dinâmica I
desenvolve oscilacões sustentadas ou um ciclo-limite. O resultado e apresentado na figura 2.11. Nota-se que na medida em que a pressão estatica da formação aproxima-se de um valor que induziria surgância do poço diminui a vazõo mássica de injecõo de gás necessaria para levar o poço a instabilidade. O modelo corrobora as observações em [1] de que nõo ocorre o fenômeno density-wave em poços surgentes.
Nota-se que as vazõoes maáximas que geram ciclo-limites estáaveis saõo menores que aquelas encontradas com o modelo mais completo de [1] para o mesmo poço.
Entretanto, os valores de vazõao de injeçcõao máaxima que geram oscilacçõoes sustentadas para diferentes valores de pressõao estáatica de formaçcõao estõao muito práoximos aos valores encontrados com as simulações mostradas em [1] utilizando o simulador OLGA2000MR e apresentadas aqui na figura 2.12.
Figura 2.7: Alguns resultados de simulação dinâmica II
uma vazão de injeção mínima de gás a fim de que o poco não desenvolva o fenômeno density-wave. Esta vazao mínima deverá ser igual ao valor da vazão de injeção que leva o poço a desenvolver oscilaçães sustentadas acrescido de um fator de segurança. No caso de haver uma incerteza muito grande no valor mínimo correto este fator de segurançca pode ser muito grande o que vai prejudicar a distribuicao otima de gás dentre os poços nos momentos de restriçcãao.
A figura 2.13 mostra uma simulação para o poço exemplo com a pressao do reservatário igual a 11.0 MPa quando se faz uma mudanca na vazao de injeção de gás de 2.0 kg/s para 0.55 kg/s. Nota-se claramente o desenvolvimento de um ciclo limite. Sim-ulaçcãoes com vazãoes ligeiramente maiores do que 0.55 kg/s dãao origem a comportamento semelhante mas as oscilacçãoes apresentam uma tendôncia de queda de amplitude. O ponto qgf = 0.55, Pr = 11.0 MPa e mostrado na figura 2.11.
Um procedimento adequado para a determinacão dos tipos de equilábrios seria analisar os autovalores da matriz Jacobiana J do modelo dinômico descrito pela equacão 2.73 com os valores
2
q t [MPa]	P„f[MPa]	qjkg/s]
0
0	2	4	6	8	10	12	14	16	18	20	22	24
20
10
0
0	2	4	6	8	10	12	14	16	18	20	22	24
Tempo [h]
Figura 2.8: Resultados com o simulador OLGA2000MR I
encontrados nos equilíbrios.
fi = Mg = qgf	qgc
fa = Mli = qif - qic
f3 = qlf = T [-qif + PI (Pr - Pwf)]	(2.73)
	r dfi dMg	dfl dMi	dfl I dqir	
J =	ÔMg	df2 dMi	df2 Sqif	(2.74)
	df3			
	L dMg	dMi	dqif -	
Dada a complexidade do modelo, uma alternativa seria obter a matriz Jacobiana de forma numérica, onde
dfj	= fj (M¡q- + e)
dMegq-	e
dfj	= fj M + e)
dMfq'	e
dfj	= fj (qif' + e)
dqfq-	=	e
(2.75)
Xf[-]	Pwh [MPa]	rgc e rgf [-]
Tempo [h]
’ ULJUUUUUIÁJUUIAJUUIAJUU
1.08
1.04
1
0.96
0	2	4	6	8	10	12	14	16	18	20	22	24
Tempo [h]
Figura 2.9: Resultados com o simulador OLGA2000MR II
Figura 2.10: Comportamento tipo orbita fechada
Vazão de injeção de gás - q [ kg/s ]
Pressão estática do reservatório pr [ bar ]
Figura 2.11: Equilíbrios com modelo desenvolvido
1.3
1.2
1.1 _ 1.0 |0.9
0.8
a&gt;
0.7
0.6
O
0.5
c
0.4
«j
0.3
0.2
0.1
0.0
50
100	150	200	250
(b)
:.bwwvwwwww
8o	2	4	6	8	10	12
(0
Figura 2.13: Simulação dinâmica p/ Pr = 11 MPa com qgf = 0.55 kg/s
2.2.2	Um modelo empírico para otimização da elevação por GLC 1
A disponibilidade da medicão das vazoes de agua, oleo e gas produzidas por cada poçco em tempo real ainda nãao e uma realidade. Como alternativa busca-se estimar estas vazães da melhor forma possível. Com o aumento do uso de medidores de pressao e temperatura de fundo, surge uma oportunidade para melhorar a otimização da produção dos pocos operando por GLC.
A otimizaçcãao da operaçcãao de um grupo de poçcos depende fundamentalmente do conhecimento das relacçoães entre as vazãoes de oleo, agua e g as produzidas pelos pocços em funcçãao da vazãao de injeção de gas (Curvas WPC- Well Performance Curve). Estas relaçcãoes mudam ao longo do tempo causando a necessidade de desenvolver-se uma tecnica para sua atualizaçcãao. Os desenvolvimentos apresentados nesta seçcãao baseiam-se em um novo cenario para poçcos sendo completados atualmente. Neste cen ario
—	os pocos sao equipados com medicao de pressao de fundo.
— Todos os pocos recebem gas para injeçao de um mesmo manifold.
— Todos os pocos sao equipados com medidores de vazao mas-sica de g as na linha de injeçcaão.
— Todos os pocos sao equipados com valvula de controle na linha de injeçcaão de gas.
— Todos os pocos podem ter sua producao direcionada para um separador de teste.
O objetivo e encontrar uma forma de predizer as vazãoes de agua, oleo e gas ou, no jargão da industria, determinar as curvas WPC. A estrategia que vai se adotar consiste em
—	buscar uma funcão que estime a pressao de fundo pwf em regime permanente em funçcaão da vazaão de injeçcãao de gas qinj,
—	utilizar a curva IPR do poço,
—	estabelecer uma estrategia de atualizaçao do modelo pwf = f (qinj ).
1 Parte deste trabalho foi publicado em [36] e também faz parte do projeto de pesquisa Desenvolvimento de Algoritmos de Controle para Métodos de Elevação Artificial realizado em parceria com a Petrobras.
Deve-se observar que mesmo tendo-se medicães de superfície das vazãoes seria necessíario conhecer tambíem o modelo que relaciona essas vazães com a vazão de injecão de gís pois, principalmente no momento de restriçcaão na disponibilidade de gías necessita-se de modelos para otimizar a distribuição de gís que maximize uma função objetivo como a míxima producao de íleo, por exemplo. Antes de apresentar o desenvolvimento do modelo pwf = f (qinj) faz-se uma introdução à relacão IPR na subseção seguinte.
A curva IPR-Inflow Performance Relationship
Desde o início da exploracão de petríleo buscou-se uma relação, em regime permanente, entre a vazãao de produçcaão e a pressãao de fundo na frente dos canhoneados. Para a razãao entre a variaçcaão da vazão AQ e a variacao na pressao de fundo Apwf, ppQ deuse a denominacao de índice de Produtividade. M. Muskat, em 1942 jí apontava que as propriedades do petríleo e a distribuicão da permeabilidade relativa e saturacçãao variam de acordo com a queda de pressãao observada dentro do reservatíorio em direçcãao ao poçco produtor. Assim, esperava que a relaçcaão entre a vazãao e a pressão de fundo fosse mais complexa que linear, principalmente em reservatíorios produzindo com pressãao abaixo do ponto de bolha.
Uma introdução à representação da produção de poços de petríleo utilizando a curva IPR deve passar necessariamente por sua obtençcãao analítica, ainda que seja para condiçães muito especiais. Mostrase aqui a obtencão da relação IPR para um escoamento de líquido subsaturado (sempre a pressaão acima do ponto de bolha).
O escoamento em meio poroso í descrito pela conhecida formula de Darcy,
= kAdP dr’
onde
(2.76)
q é a vazao
— k e a permeabilidade [m2],
— A e a seção transversal ao escoamento ou area de drenagem [m2],
—	P é a Pressão [Pa]
—	r é a distância na direcao do fluxo [m],
—	a é a viscosidade do fluido — .
m.s
Pe
rw= raio do poço re= raio de drenagem
Pw = pressão no interior do poço Pe = pressão na fronteira h = expessura da zona canhoneada.
q = vazão
Figura 2.14: Modelo de influxo
A figura 2.14 mostra o modelo utilizado na obtenção analítica da curva de influxo. Diversas premissas são assumidas como
—	a formacao e homogânea,
—	a formacao e isotropica,
—	o fluido tem viscosidade constante,
—	o fluido tem compressibilidade baixa e constante,
—	o fluxo e isotermico e laminar,
—	os efeitos da gravidade sao desprezados,
—	a espessura do reservatório e constante com camadas imper-meaveis acima e abaixo da zona permeavel,
—	o fluxo no reservatorio e de fase unica.
d2P	1 dP 0act dP
onde
—	P e a pressão,
—	r e a distância radial ao centro do poco,
—	e a porosidade da formaçao,
—	d e a viscosidade do fluido,
—	k e a permeabilidade da formacao,
—	ct e a compressibilidade total formacão-fluido.
As seguintes condiçães iniciais e de fronteira sao utilizadas, para r = rw, utilizando-se a equacão de Darcy (equacao 2.76),
dP
dr
q =
dP
dr
A =
r=rw
kA dP d dr ’ Qd kA 2nrw h
Qd k2nrwh
(2.78)
A condição de fronteira em r = rw é
dP qd
lim r =
r—&gt;rw dr	k2nh
(2.79)
Para a fronteira externa trâs tipos são consideradas:
—	Reservatório com acao infinita. No início da explotacao do reservatorio a movimentaçcãao de fluido ainda nãao atingiu suas fronteiras e o perfil de pressãao e uma funçcaão do tempo. A condiçcaão e entãao escrita como
lim P(r,t) = Pi.	(2.80)
r----
—	Fronteira com fluxo nulo. O segundo tipo de fronteira e o de fluxo zero na fronteira ou
dP(r, t)
dr
= 0.
(2.81)

— Fronteira com pressao constante. Assume que a pressão na fronteira mantem-se constante,
P(re,t) = Pr .
(2.82)
Na expressão (2.80), Pi significa a pressao inicial do reservatório. A solucão da equação da difusão (2.77) para as três diferentes condicães de fronteira gera as seguintes expressões:
— Fluxo transiente
pwf = Pi -
— 3.23
(2.83)
— Fluxo em pseudo regime permanente
qp,B
0.00708kh
log(—\ — 3.4
rw
(2.84)
— Fluxo em regime permanente
Pw, = Pr — B log( íe.)
Pwf r 0.00708kh rw )
(2.85)
Nas expressões (2.83) a (2.85) as seguintes variaveis foram introduzidas:
—	Pi=Pressõo inicial do reservatório (psia)
—	P=Pressao media do reservatorio (psia)
—	pwf =Pressõo na frente dos canhoneados com o poco fluindo
—	q=Vazao de oleo cru (STB/dia)
—	k=Permeabilidade (miliDarcy)
—	h=expessura da zona canhoneada (ft)
—	B=Fator volume de formacao (fraçao)
—	p,=Viscosidade do fluido (cP)
—	re=Raio de drenagem (ft)
—	rw =Raio do poço (ft)
As expressões obtidas para o poco vertical produzindo oleo de um reservatorio homogêneo e demais condições citadas fornece uma
relação linear entre a vazão e a diferença de pressão P — pwf. Na pratica a relação IPR mais conhecida e utilizada para fluidos subsaturados esta de acordo com a solucão analítica obtida pela equação (2.84).
Qo = J (P — pwf).	(2.86)
O éndice de produtividade J leva em conta a permeabilidade relativa do oleo cru e o fator de skin que responde pela influência de danos na formaçcãao vizinha ao pocço.
j	akh	kr
2n [ln() — 3.4 + s] hB
(2.87)
Pequeno Histórico da Relaçao IPR
A primeira apresentaçcãao do conceito de curva IPR foi feita por Rawlins e Schellhardt em 1935, [37]. M. Muskat, em 1942, [38] ja apontava que as propriedades do petr oleo e a distribuiçcãao da permeabilidade relativa e saturacçãao variam de acordo com a queda de pressãao observada dentro do reservatorio em direçcãao ao poçco produtor. Assim, esperava que a relaçcãao entre a vazãao e a pressãao de fundo fosse mais complexa que linear, principalmente em reservatórios produzindo com pressao abaixo do ponto de bolha. Uma formula sugerida para o éndice de produtividade foi
J (Pwf) = —	.	(2.88)
dpwf
Como o índice de produtividade dependeria da pressão, Muskat sugeriu uma expressão para o éndice de produtividade para um decrescimo de pressaão na frente dos canhoneados perto de zero a fim de estabelecer uma referencia,
J0 — J (pwf ) —
9Q(pwf) dpwf
akh
2n pn(rw) - 3.4 + s]
kr
pB
Em 1954, Gilbert, [39] introduziu o conceito de IPR na
(2.89) otimiza-
çao da vazão de producão e pressão de fundo. Em 1968 J. V.
P
p
Vogel trabalhou na busca de expressões para a vazão de oleo cru
versus pressãao de fundo para poçcos produzindo por mecanismos de gas dissolvido (solution gas drive) em diferentes estagios de de-
plecão e diferentes características de permeabilidade relativa, característica do óleo produzido. Ele observou um comportamento adimensional muito similar para a maioria dos casos investigados e estabeleceu uma equacão prótica que melhor se adequava.
—— = 1 - 0.2 f) - 0.8 f) .	(2.90)
qmax	Pr	Pr
Esta equacçãao era uma melhor ferramenta para analisar o comportamento de poçcos em reservatíorios com mecanismo de producçãao do tipo gías em soluçcãao do que a equacçãao linear.
Em 1973 M. J. Fetkovich propos outra forma de IPR onde assumia que a mobilidade () era uma simples funcao linear da pressão. (kro é a permeabilidade relativa para a fase oleo função da saturação de oleo, So, ^o é a viscosidade do áleo e Bo áe o fator de formaçcaão do áoleo.) Fetkovich propôos que
kro(So)
VoBo
= aP.
(2.91)
A forma da função IPR de Fetkovich é
n
Qo
Qom ax
(2.92)
Estudos mais recentes como o de Raghavan, [40] partem da ex-pressãao
q	pP feUSo) dp
'	= JP wf p.°bo	(2.93)
qomax	PP kro(So) dp
Jo poBo dP
e utilizam a suposiçcãao da relacçãao linear entre a mobilidade e a
pressão para obter
qo	=	aPdP
qo™ax	Jp aPdP
qo	= (aP - aPWf)
__2
qomax	aP
qo
qomax
(2.94)
Uma outra forma de IPR é uma pequena alteração na equação de Vogel proposta por Richardson and Shaw, [41], que permite uma maior flexibilidade de ajuste.
p2
qo	,	pwf	Pwf
= 1 - v - (1 -2	(2.95)
qomax	P	P
Se a relaçao linear da mobilidade com a pressao e modificada para incorporar um termo constante, mostra-se em [42] que existe uma dependência de v com os valores da mobilidade.
= a + 2bP.
(2.96)
Mostra-se que o parâmetro v na equacão (2.95) torna-se
v =
2(
kro (So )
1-íoBo
)P=0
( kro(So) )_	I ( kro(So)
( ^oBo	) P = 0 + ( ^oBo
)P
(2.97)
Trabalhos na busca de expressães IPR analíticas têm investido em pesquisas sobre o efeito das mudançcas na mobilidade ao longo da vida produtiva do reservatório. Em [43] apresenta-se um procedimento para a obtenção analítica de IPR considerando o conhecimento da mobilidade e de suas derivadas em relacçãao a pressãao media do reservatorio. Considerando o caso da fase oleo, por
exemplo, obtem-se a expressão da vazão como
J °
J° fP MS]¿p onde
pwf PoBo
2nkh
(2.98)
ln( rw) - 3 + S
Para um raio generico de pocço pode-se considerar pwf = P. Para maior simplicidade faz-se uma troca de variaveis,
p = p - AP dP = -dAP.
(2.99)
Os limites de integraçcaão sãao mudados e a equaçcãao para a vazaão qo pode ser reescrita como
qo = J°	kro(So) dAP.	(2.100)
Jq	doBO
Normaliza-se a expressao multiplicando-se e dividindo-se por P.
(2.101)
Para facilitar a notacao define-se x = Neste caso a equaçao (2.101) torna-se
qo = J°P	ro^o) (x)dx.	(2.102)
JO	¡J&gt;oBO
A expressão para qo na equaçao (2.102) pode ser aproximada por uma serie de Taylor.
i=N
qo = qo|(x=o)+	-dp qo(x)
i=1
(2.103)
Avaliando-se os termos da equacao (2.102):
íq°(x&gt;
x=0
x=0
x=0
0	(2.104)
jo p ( kro(So) A
\ poBo J (x=0)
JO P1 d ( kro(So) A
2 dx y ^oBo J (x=o)
JOP1 d2	( kro(So) A
3! dx2 y f^oBo J (x=o)
q (x)	=	jo P1 d	(kr o (So n
dxn o( ) x=0	n! dxn-1 \ PoBo )(x=0)
Escrito em uma forma compacta
^=n	n—1
qo = JOP	j—T
o	n! dxn—1
kro(So) A
P-oBo J (x=0)
xn—1
(2.105)
Um resultado muito importante é obtido quando se calcula a vazao maxima com o objetivo de obter-se uma expressao normalizada, do tipo apresentada por Vogel. A vazão maxima sera aquela onde P = 0 ou x =	= P-P = 1, isto e,
qomax. =
1 dn—1
n! dxn—1 i=1
kro(So)\
PoBo J (x=0)
(2.106)
Obtem-se assim
qo
qo max
=n 1 dn 1 ( kro(So) )	xn— 1
¿^i=1 n! dxn 1 ( ^oBo )(x=0)x
■s-^í=n 1 dn-1 ( kro(So) )
= 1 n! dxn-1 ( ^oBo )(x=0)
(2.107)
seguinte expressão:
&lt;lo
qomax
= 1 + N1 (P) + N2(P)2 + N(P)3 + N(P)4, onde
(2.108)
N4
1 d3 fcro(So),
----------------|x=0
N3
N2
Ni
24 dx3 ^oBo _ 1 d2 fcro (So)
6 dx2 //oB,
1	d kro (So) |
2	dx ^oBo x~u ' 2 dx2 ^oBo
kro(Sok	d kro(So) |
-	|x = 0 +	D |x = 0
(2.109)
|	+	1 d3 kro(So) |
|x = 0 I z. 7	3	J~i |x = 0
'o	6 dx3 poBo
|	, 1 d2 kro(So) |	, 1 d3
|x=0 +2 dx2 ,, b |x=0 +4 dx3 MoBo
kro (So) I
|x=0
^o-Bo	dx ^o-Bo
1	d2 ( kroSo) |	+ 1 d3 kro(So)
2	dx2	^oBo x "	6 dx3 ^oBo
I x=0
kro(So) .	+ 1 d kro(So) .
|x=0 +2 dx poBo |x=0
PoBo
1 d3 kro(So) .
24 dx3 poBo x=0
1 d2 kro(so). _
6 dx2 poBo x=0
(2.110)
D
o
+
+
Estas expressões servem para validar as aproximações polinomiais para as vazões de oleo do tipo
i=n	z \ i—1
qo(Pwf) = ^2 "■' (
(2.111)
Relaçao IPR utilizada neste trabalho
A relação IPR utilizada neste trabalho considera a existência de uma parte da curva sendo descrita pela relação linear para fluido subsaturado e outra parte para fluido saturado onde a pressão e temperatura de fundo caracteriza um ponto de operaçao abaixo do ponto de bolha. Definem-se as seguintes variáveis:
—	Psat, Pressão de saturacao.
—	qsat, Vazao de láquido para pressão de fundo igual a pressão de saturacçãao.
—	Qmax, Vazão máxima de líquido para pressão de fundo igual a zero.
—	pwf, Pressao na frente da zona canhoneada (Pressure well flowing).
A equaçao (2.112) mostra a relação IPR utilizada. A expressão é uma combinação de uma relação linear para fluido subsaturado e a expressão de Vogel. Note-se que para pwf = psat tem-se a vazao igual a qsat e para pwf = 0 obtem-se a vazao maxima Qmax.
q = qsat +
(q
max
qsat)
0.2 pWf
psat
-0.8Í pwf\
psat
(2.112)
1
A figura 2.15 mostra um grafico tépico para este tipo de representação.
Figura 2.15: IPR linear + Vogel
Estratégia para a obtençao da relaçao atual qo, qa e qg x qinj
poço. Esta condição e tipicamente a abertura total do choke de produçcãao e a manutençcãao da pressãao no separador.
A atualização da relaçao qo, qa e qg x Vazao de Injecao de gas deve ser realizada para que nos momentos de restriçcãao na disponibilidade de gas para injecçãao se possa levar os poçcos a operarem em pontos de operaçcãao que se traduzam em uma operaçcãao otima sob algum ponto de vista econômico. Testes de producão que necessitam da reducçãao da produçcaão dos poçcos nãao sãao bem vistos pelo setor de operacçoães pois se traduzem em altos custos.
Com a existôencia da mediçcãao da pressaão de fundo e sua disponi-bilizacçãao em um sistema de controle via rede pode-se conceber estrategias simples para a manutençcãao da operaçcaão em pontos otimos para situaçães em que não ocorram restriçães. Uma ideia e realizar a aquisiçcaão em regime permanente de alguns pontos (Vazão de injecão, Pressão de Fundo) e levar o poço a operar em um ponto onde a taxa de variaçcãao da pressãao de fundo em relacçãao a vazao de injecao seja zero (dpwf = 0). Este ponto corresponde ao ponto P\ da figura 2.2 onde se mostra uma curva típica relacionando tanto a vazaão de produçcãao de oleo como a pressãao de fundo em funcçãao da vazãao de injeçcãao de gas.
Este procedimento pode ser suficiente quando nãao existe restriçcãao no fornecimento de gas e deseja-se otimizar a produçcãao de oleo sem levar em conta nenhum custo associado. Entretanto, para o caso em que ocorra uma restriçcãao na disponibilidade de gas para injeçcaão a alocaçcaão de g as para cada pocço necessita do conhecimento da relacçãao entre a vazãao de produçcãao de oleo e a vazaão de injeçcaão de gas para cada poçco.
A mesma necessidade existe caso se adote uma funçcãao objetivo que leva em conta o valor diferenciado da producçãao de oleo e gas, o custo de tratamento de agua e o custo da compressãao do g as. Neste caso mesmo havendo disponibilidade total de g as o ponto otimo estara um pouco à esquerda do ponto Pi da figura 2.2. A ideia e obter a relação entre a Pressão de Fundo pwf e a Vazão de Injeção qinj, pwf = f (qinj) e entao utilizar o conhecimento dos parômetros da curva IPR, BSW e RGO para calcular as vazães de oleo, agua e gas em função de qinj conforme mostra a equacão
(2.113).
pwf — f (qinj ) qmin j	&amp;lt;qmax
qinj — qtnj __ qinj
qliq — qsat + (q max
- qsat) 1 - 0.2pwf - 0.8
psat
f pwf\ \psat J
2"
qo — (1 - BSW)qiiq
qg — RGO(1 - BSW)qiiq qa — BSWqiiq
(2.113)
As vazões expressas pela equação (2.113) estao em unidades de volume por unidade de tempo em condições padrão de temperatura e pressao e podem ser convertidas facilmente para unidades de massa por tempo. O procedimento descrito pela equação
(2.113)	é de amplo conhecimento da industria do petróleo mas sua aplicação torna-se factével com a medição da pressão de fundo. Para automatizar o procedimento de identificação da relação pwf = f (qínj) e diminuir a perda de produçao elaborou-se a seguinte estratégia. A estrategia proposta consiste nas seguintes etapas:
1	Aplicaçcãao de um procedimento de busca do ponto de pressaão
de fundo mínima (pWf e a vazão de injecao correspondente q*nj tal que	\(Pwf	)= 0 ).
2	Procedimento de aquisição de pontos (pwf, qinj) nas proximidades do ponto (pWf, q*nj). A ideia é fazer a aquisição de pontos de forma que o valor de pwf não se afaste demasiado de pWf.
3	Obtenção da curva estendida pwf = f (qinj) com os pontos
obtidos. A curva estendida visa extrapolar a relaçcãao pwf = f (qinj) e cobrir todos os pontos operacionais	&amp;lt;qinj&amp;lt;
qmax )
qinj ).
4	Obtenção da curva WPC a partir da curva estendida pwf = f (qinj) e dos parâmetros IPR, BSW e RGO conforme equação
(2.113).
E importante que as condiçães de superfície sejam mantidas durante os testes para a aquisição dos pontos (pwf, qinj).
Para o item 1 da estratégia propãe-se um procedimento automatizado no controle da vazãao de injeçcaão para a aquisiçcaão do par
(Pressão de Fundo, Vazão de Injeção) em regime permanente. Para tornar o procedimento mais eficiente e melhorar a qualidade dos dados obtidos a proposta e estabelecer uma janela de tempo onde os valores médios das duas variáveis e suas variâncias são calculadas. O valor médio aceito para o teste é aquele onde a variância estabilizou-se.
A atualização dos parâmetros da relaçao IPR, BSW e RGO continuam necessitando do direcionamento da produçcãao do poçco para um separador de teste. Para minimizar a perda de producçaão poderia ser interessante alternar testes onde o poçco ée operado somente no ponto (pWf, Qinj) e testes com a operaçao em pelo menos dois pontos onde o segundo ponto seria aquele com a maior pressãao de fundo atingida no teste para identificação de pwf = f (qinj).
A partir do resultado dos testes pode-se atualizar os valores de BSW, RGO e reavaliar os parâmetros da curva IPR.
Considerando-se que a pressão de saturação, psat, mantenha-se constante busca-se a atualizaçcaão de dois parâametros da curva IPR qsat e qmax. E claro que os dois parâmetros seriam melhor avaliados com a colocaçcãao do pocço em funcionamento em dois ou mais pontos de pressãao de fundo diferentes. Entretanto uma alternativa ée utilizar somente o teste de produçcaão para a pressãao de fundo mínima (máxima produção) o que evitaria qualquer perda de produção. Como são dois parâmetros a serem determinados precisaria-se de testes com pelo menos duas pressãoes de fundo diferentes para sua determinação. Uma alternativa é considerar que a relaçao entre qmax e qsat se mantenha, isto é, q^*2 = q^^q1 = k. Neste caso pode-se determinar os valores atualizados de qmax e qsat sem perda de produçcaão.
A estratéegia para a atualizaçcãao dos paraâmetros IPR, BSW e RGO pode considerar testes com 1 ponto alternados com testes de 2 pontos sendo que cada vez se faria tambéem o levantamento dos pontos (pwf, qinj) para a obtenção da relaçao estendida pwf = f (qinj b
O Modelo Matemático pwf = f (qinj)
A busca por uma funçcãao mateméatica que possa descrever o comportamento da pressaão de fundo em funcçaão da vazãao de injeçcãao de gás e orientada pelas seguintes observações:
—	Busca-se uma função que possa ser utilizada para extrapolar valores de pressão de fundo.
—	O ajuste da curva devera ser feito com poucos pontos.
—	Seria desejavel que a tecnica de ajuste permitisse a inserçao de conhecimento sobre o processo.
Diversas funçães foram testadas como funcães polinomiais, trigonometri-cas e exponenciais. Finalmente a seguinte função mostrou-se capaz de absorver a relação para uma diferente gama de condições:
ye	pwf * pwf	
qi	qinj	
U'		
ye	= ©ie-f (“’02) + ©2 + ©3u2,	(2.114)
onde p*wf e q*nj são respectivamente os valores de pwf e qinj onde dPwf = 0, ©i, ©2, ©3 e ©4 sao parâmetros ajustaveis como sera &amp;amp;Qinj
visto a seguir.
A função combina uma exponencial com uma função quadrática. A exponencial decrescente somada a funcao quadratica vai apresentar um ponto de mínimo como acontece com a função desejada. Alem disso, tanto a funcao exponencial como a funcão quadratica tem a capacidade de extrapolaçcãao muito boa quando comparadas, por exemplo, com expressãoes polinomiais de ordem maior que 2. Alem disso a soma das duas funcães busca uma representaçcãao onde predomine o decaimento para valores baixos de u e que a partir de um valor predomine o crescimento representando assim a diminuicão devido a gravidade sendo dominada depois pelo crescimento devido ao atrito. Diversas funçães expoentes f (u) foram testadas desde a mais simples como f (u) = u, f (u) = ©2u, etc., mas um bom ajuste so pode ser obtido com a funcao f (u) = ©2um. O modelo final proposto torna-se então
ye
u
ye
pwf pWf qinj q* ■
inj
©le-02"™ + ©3 + ©4u2,
(2.115)
onde m realiza uma forma de transformação sobre a variável vazão de injeção e depende das características de cada poço como sera apresentado na sequência.
O ajuste dos parâmetros do modelo
O ajuste dos parêametros do modelo foi colocado como um problema de programação quadrática sequencial. Inicialmente a matriz com n pares (pwf ,qinj) foi normalizada dividindo-se todas as pressoes pela pressao pwf e todas as vazoes por q*nj onde (pwf,qinj) e o ponto onde	= 0. Este procedimento visa
evitar problemas numericos. Partindo-se de um conjunto de pa-rêmetros iniciais &amp;amp; = [ ©1 ©2 ©3 ©4 ] e dos n elementos de entrada ui, (i = 1 : n), calcula-se o vetor com os valores estimados Ye. A diferenca entre os valores reais Y e os valores estimados Ye e definida como o vetor de erros E = Y — Ye,
E = Y - Ye
yi - yei
y2 - ye2
yn - yen
(2.116)
A cada iteracçãao calcula-se a variacçãao otima do vetor de parêame-tros A&amp;amp; que somada ao vetor &amp;amp; ira anular uma fracão p do vetor erro E . Ou seja, a cada iteracçaão minimiza-se a seguinte funcçaão objetivo
J = (pE — HA&amp;amp;)t (pE — HA&amp;amp;).	(2.117)
Nesta expressao p e um escalar entre 0.01 e 0.05 e corresponde a fração do erro a ser anulado a cada iteracão. H e o Jacobiano onde cada linha e o gradiente da saída em relação aos parâmetros &amp;amp;.
H
" ôpwf		9pwf		9pwf		9pwf
Ô©1	U=U1	d©2	U=U1	d©3	U=U1	Ô©4
9pwf		9pwf		9pwf		9pwf
d©i	U=U2	d©2	U=U2	d©3	U=U2	d©4
9pwf		9pwf		9pwf		9pwf
. d©i	u=un	d©2	u=un	d©3	u=un	d©4
I U = Un
I U=U1
1 U=U2
(2.118)
Os elementos do gradiente são calculados a cada iteração como
dye | dex 1
U=U1
e-02U
dye | de21
U=U1
-e^e-0^
dye | des1
U=U1
dye | de 41
U= U1
(2.119)
1
u
2
1
1
1
A funcao objetivo expressa pela equaçao (2.118) pode ser reescrita como
J = A©tHtHA© - 2(3EtHA© + p2ETE	(2.120)
Desprezando-se o termo p2EtE que não apresenta relaçao com A©, pode-se expressar a funcao objetivo como um problema clássico de programacçãao quadráatica a ser resolvido a cada iteraçcãao,
A©	= arg min J
s. a.
J = |a©tHtha© - PEtha©
©min &amp;lt;©ant + A© &amp;lt;©max	(2.121)
A vantagem da utilização da formulação em programação quadrática ficara evidente na sequencia da exposição deste trabalho.
Utilizaçao do Conhecimento das Características do Poço
Um parâmetro importante para o ajuste do modelo ó a pressão estítica da formacão, Pest.• Existe normalmente um conhecimento aproximado de seu valor. Este valor pode ser modelado como sendo igual a um valor nominal, Pest-N, acrescido de uma incerteza, ±ePest-N. O valor de Pest pode entao ser expresso pela equaçao (2.122),
Pest-N(1 — e) &amp;lt;Pest &amp;lt;Pest-N(1 + e) •	(2.122)
Para pocos não surgentes este conhecimento pode ser incorporado
ao problema de ajuste na formulacão da programação quadrática sequencial na forma de uma restriçao. Para isso obtem-se o valor da equação (2.115) para u = 0 que corresponde a pressão de fundo para vazao de injecao nula. E importante mencionar que a relação pwf x qinj em regime permanente nao contempla todos os pontos existentes entre qinj = q*nj ate qinj = 0. Existem valores de vazãao de injeçcãao de gas que naão sãao realizaveis pois existe um limite ménimo para a vazão de injecão que possibilita a elevação de fluido. Mesmo antes deste limite o comportamento dinâmico das vazãoes torna-se muito oscilatorio e seria necessario a aplicaçcãao de controle ativo para a manutençcãao da operacçãao. Entretanto, para um pocço nãao surgente, pode-se imaginar que a curva de regime permanente teria a tendencia de chegar a pressao de fundo igual a pressãao estatica para vazãao de injecçãao nula. Assim, para valores de vazãao de injeçcãao de gas bem maiores do que a vazãao que leva o poço a oscilacões sustentadas este procedimento é razoável.
Desta forma a equacão (2.115) para u = 0 torna-se
y(0) = ex + 03 = Pest.	(2.123)
Combinando-se a equaçao (2.122) com a equação (2.123) obtem-se
Pest-N(1 — e) &amp;lt;ei + 03 &amp;lt;Pest-N(1 + e)
como
ei = eiant + A0!
03 = 03ant + A03
Pest-N(1 — e) &amp;lt;eiant + A01 + 03ant + A03
Pest-N(1 + Ê) &gt; eiant + Aei + e3ant + Ae3	(2 + 24)
Para colocar no formato adequado para o algoritmo de progra-macão quadrática sequencial, introduz-se a desigualdade expressa pela equaçao (2.124) como uma restrição na formulaçao do problema de otimizaçcãao
A© = arg min J
s. a.
J = 'a© T HtHA© -	HA©
2	1
A©1 + A©3 &amp;lt;Pest-N (1 + e) — ®1ant — ®3ant
— A©1 — A©3 &amp;lt;—Pest-N (1 — e) + ©1ant + ®3ant	(2.125)
Com este procedimento pode-se incorporar ao algoritmo de ajuste dos parâmetros as informaçães disponíveis na seguinte formulação do problema:
Ajuste os parâmetros da função expressa pela equação (2.115) para o conjunto de pontos adquiridos em regime permanente do poço ndo surgente i que apresenta um BSW aproximado de BSWi, um RGO em torno de RGOi e uma pressão estática nominal de Pest.Ni com uma incerteza de e100%.
Nos casos de poços surgentes não se aplicam as restrições mas pode-se igualmente encontrar os parâmetros do modelo.
Resultados Obtidos
Para o estudo realizado na busca de uma metodologia para a obtenção do expoente m da equaçao (2.115) utilizaram-se todos os pares (pwf, qinj) gerados com o simulador de poços para GLC em regime permanente Marlim. Inicialmente um poço foi instanciado com características representativas de poços reais e variou-se os parâmetros BSW e RGO em 8 diferentes combinaçães. Para cada caso obteve-se valores de vazaão de producçãao e agua oleo e gas e pressãao de fundo para diferentes valores de vazãao de injeçcãao de gas. A tabela 2.4 mostra os cenarios utilizados para a geração dos dados utilizados neste estudo.
Tabela 2.4: Parâmetros utilizados nos testes realizados com o simulador
Marlim
Teste	BSW [%]	RGO
1	15	79
2	45	79
3	58	79
4	75	79
5	85	79
6	58	50
7	58	80
8	58	105
avaliacão da qualidade do ajuste, entretanto, utilizou-se todos os pontos disponíveis buscando assim determinar a capacidade de extrapolação da funcão identificada com poucos pontos.
Para avaliar a qualidade do ajuste utilizou-se o fator R definido como
1 -
R =

EL(y(») - ye(i))2
N=i(y(i) - y)2
(2.126)
onde N e o nUmero de pontos utilizados na identificação, y representa o valor medio dos N valores das pressães y e ye e o valor estimado da pressão de fundo obtido com o modelo. As figuras 2.16 e 2.17 mostram o ajuste obtido para os dados dos pocos 1 a 4 e 5 a 8 respectivamente. Mais uma vez é importante observar que a curva foi ajustada com os pontos mostrados em circulos pretos. Estes pontos foram selecionados de forma que a pressão maxima não atingisse mais do que 1% do valor otimo irrestrito (pressão mínima no fundo). Os pontos mostrados em circulos claros não foram utilizados para a identificaçcãao dos paraâmetros dos modelos. Observa-se que a curva ajustada consegue extrapolar muito bem passando muito proximo a estes pontos.
A fim de melhor avaliar o modelo proposto foi gerado dados de um grupo de poçcos com configuracçãoes completamente diferentes
Pressão de fundo [ Kgf/cm2]	Pressão de fundo [ Kgf/cm2]	Pressão de fundo [ Kgf/cm2]	Pressão de fundo [ Kgf/cm2]
Ajuste para conjunto de pontos 1-BSW=15%, RGO=79
Vazão de injeção [ m3/d * 1000 ]
Ajuste para conjunto de pontos 4-BSW=58%, RGO=79
Vazão de injeção [ m3/d * 1000 ]
Ajuste para conjunto de pontos 3-BSW=45%, RGO=79
Ajuste para conjunto de pontos 5-BSW=75%, RGO=79
Figura 2.16: pwf = f (qinj) para pocos UFSC-1 a 4
Ajuste para conjunto de pontos 6-BSW=85%, RGO=79
Ajuste para conjunto de pontos 7-BSW=58%, RGO=50
Ajuste para conjunto de pontos 9-BSW=58%, RGO=105
FT 2801
E
’ê, 260
Vazão de injeção [ m3/d * 1000 ]
Ajuste para conjunto de pontos 8-BSW=58%, RGO=80
Vazão de injeção [ m3/d * 1000 ]
240
220
200
O ■Q
		Pressão de fundo estimada o Dados não utilizados p/ ajuste o Dados utilizados para ajuste			
V	 R=0.9996				
				
1801
0	100	200	300	400
Vazão de injeção [ m3/d * 1000 ]
Figura 2.17: pwf = f (qinj) para poços UFSC-5 a 8
entre si. Os dados de simulaçcãao disponibilizados sãao Pressaão de revestimento, Vazão de Líquido produzido e Vazao de Injeção de
Gás. Com estes dados deve-se obter a pressão de fundo pwf. Para isso deve-se utiliza-se a expressaão para IPR combinada,
qliq	IP (Pest.	pwf) para pwf &gt; Psati e	(2.127)
qliq
qsat + (qmax
- qsat )
0.2( pWf)
psat
0.8( pWf )2
psat
1
para pwf &amp;lt;Psat-
Para os casos onde a pressãao estéatica ée menor que a pressãao de saturaçcãao o poçco vai operar sempre em regime saturado e a ex-pressãao para Vogel pode ser utilizada diretamente.
- Poco UFSC-15
Características do Poço UFSC-15
—	Poco direcional
—	Pressao estatica:246.0
cm2
—	Pressao de saturacao:224.8
cm2
— Pressao de Teste:245.0
Kgf cm2
— Vazao de Teste:76.0 m3/d
- RGOf:100.0 m3/m3
- oAPI:24.7
- BSW:60.3 %
—	Densidade relativa da agua produzida:1.06
—	Densidade relativa do gás de formacao:0.619
—	Densidade relativa do gas de injecao:0.780
—	Pressão na superfície:14.0
cm2
A tabela 2.5 apresenta os dados obtidos com a simulaçcãao do Poçco UFSC-15
Tabela 2.5: Dados do Poço UFSC-15
Pressao Revest.	Q	m3 Qiiq.	d	qinj	d
128	883.9	37716.5
133	901.7	53726.3
143	909.2	73368.3
158	917.6	107736.7
173	916.1	174140.5
188	893.5	211629.6
203	870.1	240490.5
233	827.9	284198.2
263	793.5	316652
293	765.8	342311.8
323	742.2	364269.3
Figura 2.18: pwf = f (qinj) para poço UFSC-15
Tabela 2.6: Parâmetros identificados para os dados do Poço UFSC-15
©1	©2	©3	©4	m
0.0539	1.5710	0.9872	0.0013	0.175
—	Pressão estatica:199.0
cm¿
—	Pressão de saturacao:242.1
—	RGOf:100.0 m3/m3
—	oAPI:29.0
—	BSW:67.6 %
—	Densidade relativa da agua produzida:1.06
—	Densidade relativa do gáas de formacçaão:0.790
—	Densidade relativa do gas de injecao:0.780
—	Pressão na superfície:16.5
r	cm2
A tabela 2.7 apresenta os dados obtidos com a simulaçcãao do Poçco UFSC-17
Tabela 2.7: Dados do Poço UFSC-17
Pressao Revest.	qiiq.	d	qinj m
132.81	708.6	35068
140.81	881.8	62482.6
148.81	929.2	77396.4
156.81	941.6	185925.1
173.81	934.7	214444.4
188.81	927	234465.9
198.81	921.5	246217.3
223.81	907.3	271690.1
248.81	893.7	293446.1
298.81	867.5	332277.5
348.81	841.7	367381.9
A tabela 2.8 apresenta os parâmetros identificados para o ajuste dos dados do poco UFSC-17:
Tabela 2.8: Parâmetros identificados para os dados do Poco UFSC-17
ei	e2	es	e4	m
0.0729	7.5665	0.9966	0.0030	1.1100
- Poco UFSC-20
Características do poço UFSC-20
Figura 2.19: pwf = f (qinj) para poço UFSC-17
—	Poço direcional
—	Pressão estatica:197.0
cm2
—	Pressão de saturação:247.1
cm2
—	RGOf:100.0 m3/m3
- oAPI:27.5
—	BSW:79.7 %
—	Densidade relativa da agua produzida:1.06
—	Densidade relativa do gas de formaçao:0.770
—	Densidade relativa do gas de injeção:0.780
—	Pressao na superfície:12.8
cm2
A tabela 2.9 apresenta os dados obtidos com a simulaçcãao do Poçco UFSC-20
A tabela 2.10 apresenta os parâmetros identificados para o ajuste dos dados do poço UFSC-20:
-	Poco UFSC-21
Características do poco UFSC-21
-	Pocço direcional
— Pressão estatica:203.7
Tabela 2.9: Dados do Poço UFSC-20
Pressao Revest.	q	m¿ qiiq- d	qinj m
115.54	451.9	36540.3
130.54	500	73096.5
140.54	458.2	176527.4
145.54	453.8	186109.9
155.54	444.7	203169.2
160.54	440.6	210367
165.54	436.6	217520.1
175.54	429.1	230555.3
190.54	419	247669.4
215.54	404.5	272181.1
265.54	380.3	314010.8
Figura 2.20: pwf — f (qinj) para poço UFSC-20
Tabela 2.10: Parâmetros identificados para os dados do Poco UFSC-20
	©2	©3	©4	m
0.2374	8.8801	1.0008	0.0033	1.9000
— Pressão de saturacao:251.0
- IP:7.7
m3/d kgf / cm2
- c=0.2
—	RGOf:113.0 m3/m3
-	oAPI:27.5
—	BSW:34.1 %
—	Densidade relativa da agua produzida:1.06
—	Densidade relativa do gas de formacao:0.760
—	Densidade relativa do gas de injecao:0.770
—	Pressão na superfície:13.0
cm2
A tabela 2.11 apresenta os dados obtidos com a simulacao do Poço UFSC-21
Tabela 2.11: Dados do Poço UFSC-21
Pressão Revest. Kgf2- cm2	q qlzq.	d	qinj md
97.4	557.3	50875.1
107.4	567.4	67173.1
117.4	572.5	78600.6
122.4	574	83308.3
137.4	567.8	187204.6
147.4	566.6	199916.1
172.4	562.8	228684.3
197.4	556.7	254373.1
247.4	540.9	299280.9
297.4	526.2	338377.9
322.4	519.3	356386.6
A tabela 2.12 apresenta os parâmetros identificados para o ajuste dos dados do poçco UFSC-21:
Tabela 2.12: Parâmetros identificados para os dados do Poço UFSC-21
©1	©2	©3	©4	m
0.9038	3.5017	0.9666	0.0075	0.5600
Figura 2.21: pwf = f (qinj) para poco UFSC-21
- Poco UFSC-23
Características do poco UFSC-23
—	Poco direcional
—	Pressão estatica:205.0
cm2
— Pressao de saturaçao:242.1
Kgf cm2
— IP:16.0
m3 /d kgf / cm2
— c=0.2
—	RGOf:100.0 m3/m3
—	oAPI:26.1
— BSW:48.8 %
—	Densidade relativa da agua produzida:1.06
—	Densidade relativa do gas de formacao:0.750
—	Densidade relativa do gas de injecão:0.780
—	Pressao na superfície:13.1
cm2
A tabela 2.13 mostra os dados obtidos com a simulaçao do Poco UFSC-23
A tabela 2.14 apresenta os parâmetros identificados para o ajuste dos dados do pocço UFSC-23:
Tabela 2.13: Dados do Poço UFSC-23
Pressao Revest.	q qiiq-	d	qinj m
110	784.1	51304.7
120	801.8	68982.2
135	811.9	86840.5
150	817.7	99786.2
160	783.8	206224.5
185	766.6	239616.6
210	755.4	263522.4
240	743.9	289697.4
260	735.4	305919.2
305	716.4	339712.9
335	704.5	360586.4
Figura 2.22: pwf = f (qinj) para poco UFSC-23
Tabela 2.14: Parâmetros identificados para os dados do Poco UFSC-23
©1	©2	©3	©4	m
0.3886	5.8173	0.9971	0.0052	1.0400
- Poco UFSC-75
Características do poço UFSC-75
—	Poco vertical
—	Pressão estatica:217.2
cm2
— Pressão de saturacao:197.7 Kgf
cm2
- IP:42.9
m3 /d kgf / cm2
- c=0.2
—	RGOf:100.0 m3/m3
-	oAPI:29.7
— BSW:3 %
—	Densidade relativa da agua produzida:1.07
—	Densidade relativa do gás de formacao:0.860
—	Densidade relativa do gas de injecao:0.780
—	Pressão na superfície:15.6
cm2
A tabela 2.15 mostra os dados obtidos com a simulação do Poco UFSC-75 A tabela 2.16 apresenta os parâmetros identificados
Tabela 2.15: Dados do Poço UFSC-75
Pressão Revest. Kgf- cm2	q	m3 qliq-	d	qinj m
134.11	1424.9	112379.1
144.11	1447	226058.7
159.11	1448.5	266148.8
174.11	1444.7	297014.5
184.11	1440.9	314410.8
209.11	1429.7	350476.4
234.11	1417.7	379901.1
259.11	1405.5	405699.7
284.11	1392.9	429936
334.11	1366.8	474798.1
359.11	1353.6	495788.5
para o ajuste dos dados do poço UFSC-75:
Figura 2.23: pwf — f (qinj) para poco UFSC-75
Tabela 2.16: Parêmetros identificados para os dados do Poço UFSC-75
©1	©2	©3	©4	m
0.4005	0.6138	0.7748	0.0083	0.0900
Adaptaçao do modelo para poços altamente depletados
Para poçcos nãao surgentes o modelo desenvolvido considera a pressaão de fundo igual a pressao estatica correspondendo a vazao de in-jecão de gas nula na obtençao da funçao pwf = f (qinj) em regime permanente. Na pratica isto e razo avel para poçcos onde a pressaão estatica encontra-se pouco abaixo do limiar de surgência. De acordo com os resultados obtidos na seção 2.2.1 e apresentados na figura 2.11, ao diminuir-se a vazao de injecao atinge-se um valor onde o metodo GLC nao consegue estabelecer uma pressao de fundo menor do que a pressãao estatica em regime permanente.
11 MPa tem-se uma vazão mínima igual a 0.41 kg/s. Definindo ^inj como a mínima vazao de injeção realizavel com GLC, tem-se para o poço exemplo, q"j = 0.41 kg/s com Pr = 11 MPa. Nestes casos, antes de iniciar o procedimento de identificação efetua-se uma primeira transformação nas vazães de injecão a serem utilizadas na obtencão do modelo subtraindo q™r dos valores de vazão obtidos para obter q^-,
qLj = qinj - qmj	(2.128)
A partir deste ponto utiliza-se todos os procedimentos já descritos. Isto á, obtem os valores que correspondem ao ponto de mínimo pwf, agora com os valores de vazão de injeção já diminuídos de q™r, (q." j,PWf)• A normalizacao das vazões e da pressao de fundo á feita com (q“j e p*wf), respectivamente.
Figura 2.24: pwf = f (qinj) para poco exemplo com Pr = 11.0 MPa
Tabela 2.17: Parâmetros identificados para os dados do exemplo [1]
©1	©2	©3	©4	m
0.2281	2.1125	0.9430	0.0293	1.0
2.2.3	Um modelo dinâmico para controle e otimização
Os modelos matemáticos servem a diferentes objetivos. O modelo fenomenológi- co á importante para se conhecer o processo em profundidade e permitir uma análise paramátrica com o objetivo de melhorar o seu desempenho, por exemplo. O modelo em regime permanente á muito utilizado em algoritmos de otimização, principalmente para processos estáveis e que operam neste regime a maior parte do tempo. Para finalizar a discussão de modelos para processos GLC, propãe-se nesta seção um modelo dinâamico que utiliza o desenvolvimento realizado na seçcaão anterior mas que acrescenta um comportamento dinaâmico. O objetivo deste modelo á ser o mais preciso possível em regime permanente para permitir a utilizaçcãao do modelo em uma estratáegia de controle preditivo que visa otimizar a distribuiçcãao de gáas enquanto atenua as oscilaçcãoes causadas por variaçcãoes na disponibilidade de gáas.
O modelo aqui descrito áe muito semelhante aquele apresentado em [44], exceto pela consideraçao de pocos altamente depletados discutidos na secçãao anterior.
A ideia á utilizar um modelo Hammerstein [45] modificado conforme a estrutura apresentada na figura 2.25
O bloco A subtrai da vazao de injeção o valor q^j que corresponde ao valor da vazão mínima realizavel para o funcionamento do poço em GLC. Para este valor de vazão de injecão a pressão de fundo em regime permanente seria muito práoxima da pressãao estaática do reservatório Pr. Este valor pode ser considerado nulo para valores de pressãao de reservatáorio práoximos ao limiar do valor de surgância. O bloco B normaliza o valor da vazão de injecão (em relacao a qrn). O bloco C aplica a funcao desenvolvida na secao anterior para regime permanente que calcula a pressãao de fundo em função da vazão de injeção. O bloco D aplica uma função de transferâencia de 2a. ordem com o zero, o fator de atenuacçãao e a
Figura 2.25: Estrutura do Modelo dinâmico baseado em Hammerstein
frequência natural sendo funções da vazao de injeção normalizada,
u.	A saída do bloco D é a pressão de fundo normalizada. O bloco E limita a pressão de fundo normalizada a pressão estética normalizada. O bloco F filtra a aplicação da saturação feita pelo bloco E. Finalmente o bloco D recupera a pressão de fundo ao multiplicar a pressao normalizada por p*wj.
A figura 2.26 apresenta o resultado de um estudo realizado para o poço modelo apresentado na seção 2.2.1 para a pressao de reservatório de 20 MPa. Para este caso considerou-se qmr = 0. ■íinj
Utilizando o modelo fenomenolégico desenvolvido na seçao 2.2.1 determinou-se a dependência dos parêmetros a, Ç e wn em relação a vazão de injecao normalizada u. A figura 2.26-a mostra os valores da vazãao de injeçcãao e da pressãao de fundo utilizados na obtençcãao da vazãao de injeçcãao normalizada u. A figura 2.26-b apresenta alguns valores encontrados para o zero da funcçãao de transferêencia de segunda ordem do modelo proposto em funcçãao da vazão de injeção normalizada. No mesmo gréfico apresenta-se
a função ajustada para os pontos obtidos, a(u).
3	2
P1U3 + P2U2 + P3U + P4 a(u)	=	2
u2 + qpu + q2
Pi =	-972,1
P2	=	1294
P3	=	-502,3
P4	=	33,8
qi = -1,476
q2	=	= 0,5679	(2.129)
Figura 2.26: Parâmetros identificados
A figura 2.26-ç apresenta os valores encontrados para Ç e a função ajustada para os mesmos.
Ç(u) = 0.3488e-0'1266“ - 0.5265e-3'855u	(2.130)
A figura 2.26-d mostra os valores encontrados para a frequência natural wn e a função ajustada para os mesmos.
wn(u) = —0,01713u4 + 0,04658u3 — 0,04569u2	(2.131)
+ 0, 01909u + 0,0003956
2.3	Conclusões e desenvolvimentos futuros
Neste capítulo foram apresentadas três abordagens na modelagem da elevação por GLC, i)uma modelagem fenomenologica baseada na propagação da fração massica de gas, ii)uma modelagem para a relacçãao em regime permanente entre a pressãao de fundo e a vazão de injeção de gas e iii)um modelo baseado na representação tipo Hammerstein modificada que preserva o modelo es-tatico desenvolvido e acrescenta uma dinêamica aproximada em funçao da vazao de injeção de gas. A modelagem fenomenolo-gica desenvolvida apresenta bom desempenho dinêamico exibindo os fenômenos de fase não mínima e o comportamento com sub-amortecimento progressivo conforme se diminui a vazãao de injeçcãao ate atingir-se oscilacçoães sustentadas para uma determinada vazãao suficientemente baixa. Um mapa desta vazãao para diferentes valores de pressãao est atica da formacçãao mostrou uma semelhançca muito grande com os resultados obtidos para um poçco equivalente simulado no OLGA2000MR. O comportamento em regime permanente, por outro lado, exibe uma diferençca muito grande e exige mais desenvolvimento. Essas características do modelo o tornam um candidato para utilizaçcaão em prediçcãao quando se pode medir a pressão de fundo em tempo real ja que é possível aplicar os metodos de correcçãao como o que foi apresentado neste trabalho. Um trabalho importante e a utilizaçcãao do modelo feno-menologico desenvolvido para a modelagem do fenêmeno heading. Isto poderia ser relativamente simples ja que o que falta seria uma modelagem do escoamento de gas no anular e na v alvula operadora de gas-lift.
exemplo tecnicas Monte Carlo de ajuste. Isto permitiria partir-se de sintonias de modelo com uma qualidade mínima inicial semelhante a qualidade da representacão do simulador fenomenologico. Ha de se considerar que o custo para a obtencao de dados reais para a sintonia de modelo e custosa pois passa invariavelmente pela necessidade de variar o regime de funcionamento do poçco e assim opera-lo de forma sub-otima pelo tempo de aquisicçãao.
O modelo baseado na representação Hammerstein modificado é um esforçco no sentido de preservar uma relaçcãao de regime permanente de qualidade no modelo dinâmico. Isto pode ser interessante em determinadas formulaçcãoes de controle preditivo como a apresentada na secão 5.3 do capítulo 5 onde nao se define os valores referâencia para as pressãoes de fundo na funçcãao objetivo. A funçcaão objetivo e formulada visando principalmente atingir um certo desempenho econoâmico e um determinado comportamento dinâmico dos poços e do manifold de gas lift, para diferentes disponibilidades de gas comprimido. Neste sentido, o modelo desenvolvido mostra-se bastante interessante pois ao incorporar um bom modelo de regime permanente pode atender o objetivo principal de controle. Desenvolver modelos fenomenologicos simples que preservem uma relacçaão de regime permanente de qualidade suficiente para otimização em problemas de escoamento multi-fasico e um desafio muito grande. O comportamento dinaâmico do modelo e aproximado mas pode atender ao objetivo de controle por tratar-se de fenâomeno com dinâamica lenta e que naão requer atuaçcãao agressiva de controle em malha fechada o que permite operar com erros de modelagem razoaveis. Ja a sintonia dos parâmetros do modelo dinâmico precisa ser simplificada havendo aí um grande espaçco para melhoras.
Capítulo 3
Controle MPC
Distribuído
A maioria dos sistemas dinâamicos com multiplas entradas e multi-plas saídas (MIMO) encontrados na industria apresentam intera-çcãoes entre as variaveis controladas frente as vari aveis manipuladas. De forma que raramente uma variavel é controlada pela manipulaçcãao de uma unica acçãao de controle. O controle de processos que apresentam interaçcãoes utilizando estrategias do tipo uma entrada uma saída (SISO) ainda que possível em alguns casos, faz com que a operaçcãao se desenvolva muito longe dos limites impostos pelas restricães do problema. A fim de evitar a violacão das restricçãoes devido ao comportamento dinâamico ocasionado pelas interacçãoes, o sistema e operado a uma distâancia muito grande da restriçcãao. Isto diminui o desempenho da planta.
O controle de plantas complexas é tipicamente dividido em níveis hierárquicos. No nível basico estão os controladores locais utilizados para implementar acçoães como vazaão, velocidade de uma esteira, temperatura de uma soluçcaão, concentraçcãao de um produto, etc. Estas açães fazem parte de uma estrategia de controle cuja referencia e fornecida pelo nivel de controle imediatamente superior que e o controle avançcado. Em termos de velocidade da dinaâmica, os controladores locais trabalham com taxas de amostragem de segundos ou fraçcãao de segundo enquanto que o controle avançcado trabalha com vari aveis amostradas em intervalos de tempo algumas dezenas de vezes maiores. Acima do controle avancçado pode
existir algoritmos de otimizacão em tempo real (RTO-Real Time Optimizer) que resolvem problemas de otimizaçcaão tipicamente para a soluçcãao em regime permanente do sistema e fornecem os set-points para o sistema de controle avançado. Estes algoritmos de otimização recebem informação da camada de planejamento sobre a disponibilidade de recursos disponíveis e sobre as demandas futuras.
Atualmente os controladores locais de muitas instalações como refinarias, por exemplo, utilizam controle via redes de campo. Dentre as redes de campo a rede Foundation Fieldbus tem se destacado pois permite que estrategias de controle sejam implementadas nos proprios instrumentos de campo atraves da uti-lizaçcaão de algoritmos encapsulados em blocos funcionais que sãao interligados para executar as tarefas de medicçaão, c alculo da açcaão de controle e atuaçcãao. Os instrumentos Foundation Fieldbus saão ligados a um barramento comum que e utilizado para a troca de informacçãao alem de, opcionalmente, suprir a energia eletrica para seu funcionamento. As tarefas de controle sãao executadas de forma determinística dentro de um tempo fixo chamado de macrociclo. Alem do tempo assegurado para as tarefas de controle existe um tempo extra destinado ' troca de informações com o sistema de controle avançcado e supervisãao.
E um consenso entre pesquisadores e praticantes que a tecnica de controle avançado mais utilizada na industria é o Controle Pred-itivo Baseado em Modelo. Uma estat ística recente e interessante sobre aplicaçoes de controle avançado na industria química do Japão e apresentada em [46].
Uma das características mais apreciadas na tecnica de controle preditivo e sua capacidade de tratar as restriçcãoes sobre as entradas e saídas de forma simples e elegante. Este tratamento de restricoes permite, por exemplo, a diminuiçao do " give away" em processos onde o produto deve manter uma determinada característica dentro de uma faixa de valores sob pena de multa, por exemplo. Em geral a aplicaçcãao de Controle Preditivo baseado em modelo permite operar mais proximo das restriçcãoes sem viola-las. Apesar das inumeras vantagens da aplicaçcãao de controle preditivo existem alguns aspectos relacionados com sua implementaçcãao e utilização que poderiam ser melhorados:
— O MPC demanda um longo tempo para ajuste dos modelos e parâmetros do controlador.
—	A manutençao do algoritmo de controle exige o trabalho de especialistas.
—	Alteraçoes na planta exigem a revisao de todo o sistema de controle.
—	As soluçoes de controle avancado sao caras para pequenas empresas.
Uma proposta no sentido de responder a algumas das dificuldades citadas e a utilizaçcãao de agentes para o controle de sistemas. Toma-se aqui o nome de agente para definir um objeto matem atico que comunicando-se com outros objetos matematicos similares, recebendo os valores das vari aveis do processo e tam-bem das referôencias, fornece o valor de uma das açcãoes de controle. A ideia e desenvolver um algoritmo de controle preditivo que sera calculado atraves da troca de informacçãoes entre os agentes de forma iterativa. A cada instante de amostragem cada agente recebe os valores calculados pelos demais agentes e recalcula sua açcãao de controle. Isto e repetido por um determinado numero de instantes de amostragem ate que os valores calculados por cada agente nãao mudem mais que um certo percentual em relaçcãao aos valores calculados anteriormente.
A figura 3.1 mostra uma possível configuração do sistema. Cada agente poderia ainda ter modulos de supervisãao, otimizaçcãao, identificação de modelo, etc. Do ponto de vista da implementação em redes de comunicaçcãao para controle esta tecnica e plenamente viavel ja que o tempo de amostragem do controle avançcado e tipicamente uma ordem de grandeza maior que o tempo de amostragem do controle local.
3.1	Desenvolvimento de agentes para controle de processos
Um agente tal como definido na introduçcaão podera eventualmente resolver parte das dificuldades existentes no controle de processos. Entretanto, alem de resolver o problema de controle preditivo de forma distribuída seria desejavel que o agente
—	diminuísse o numero de horas gastas com a identificacao de modelos do processo,
Agente N
Figura 3.1: Estrutura de Controle com Agentes
—	utilizasse o acesso as informações para melhorar continuamente a qualidade do modelo do processo,
—	respondesse a situacoes de falha de mediçõo e/ou atuacõo de forma segura.
—	tornasse o controle avançado disponível para usuarios da tecnologia fieldbus.
O controle de processos moderno é realizado na medicõo e atuacao em intervalos de tempo fixo chamados de tempo de amostragem. Tanto na malha de controle local como na de controle avançado, uma açcaõo de controle deve ser produzida a cada instante de tempo. Por isso, e considerando que o controle preditivo baseado em modelo tem se mostrado uma das tecnicas de controle mais bem aceitas na industria, desenvolve-se neste capítulo uma proposta de agente que visa inicialmente resolver o problema de controle de forma distribuída.
A expectativa é incorporar neste agente basico outras funcionalidades que irão fazer com que o agente atenda todos os requisitos acima mencionados.
3.2	MPC distribuído
O objetivo desta seçao é apresentar uma decomposição do problema de controle preditivo de forma que o problema possa ser resolvido por agentes. Estes agentes serão tantos quantas forem as acoes de controle do problema. Para simplificar a apresen-taçcãao da tecnica apresenta-se inicialmente a decomposicçaão do algoritmo para formulaçcoães sem restriçcoães. A maioria das ideias apresentadas neste trabalho foram tambem publicadas em [47]. Depois da apresentação do algoritmo MPC distribuído sem res-triçcoães apresenta-se um algoritmo baseado em projeçcãoes vetoriais que resolve o problema MPC com restricçãoes.
Supondo que possamos representar as relacões entrada-saída de uma planta na forma linear, então poderia se esperar que a relacão entrada saída na forma de matriz função de transferencia fosse escrita em Laplace como
(3.1)
yi(s)
y2(s)
«3(s)
«4(s)
_ yn(s) _
Hii(s)	H12(s)	Hi3(s)	0 •	•0		U1(s)
0	H22(s)	H23(s)	0 •	•0		U2(s)
0	H32(s)	H33(s)	H34(s)	•	•0		U3(s)
0	0	#43 (s)	H||('s)	•	•0		U4(s)
0		0	0 •	•	Hnn(s) .		. Un(s) _
n-diagonal com n variável. E claro que no caso em que nao houvesse nenhum acoplamento a matriz seria diagonal e cada agente resolveria um problema de controle do tipo SISO (Single InputSingle Output). O fato de que a matriz função de transferência típica e dispersa favorece a utilização de agentes pois tipicamente cada agente necessita comunicar-se com poucos outros agentes.
3.2.1	Decomposição da Formulação MPC sem restrição
A maioria dos algoritmos de controle preditivo baseado em modelo determinam o vetor incremento de acão de controle Au minimizando a seguinte funçcãao objetivo:
min J
Au
J = (W - Y)TR(W - Y) + AuTQAu,	(3.2)
onde
-	W é o vetor com as referências futuras
-	Y é o vetor com as predições das variaveis controladas
-	R e uma matriz diagonal com pesos para o seguimento de refer-êencias
-	Au e o vetor com as futuras mudanças nas acoes de controle
-	Q e um matriz diagonal com pesos sobre as mudancas nas ações de controle
Para No saídas e N entradas, W, Y, R, Au e Q sao composições de vetores e matrizes,
Au
Qi 0	...	0
0	Q2 ...	0
(3.3)
W
R
Q
0	0	...	QNi
A funçao custo J pode ser escrita como
J =	(Wi - Yi)TRi(Wi - Yi) +
(W2 - Y2)tR2(W2 - Y2) +
... +
(WWo - YNo )TRn (Wn - YNo) +
Auf Q1Au1 +
Auf Q2AU2 +
... +
AuN QNi AuN	(3.4)
As prediçcãoes sãao calculadas na forma de resposta livre somada ao efeito das futuras mudançcas na acçãao de controle corrente conforme se faz no algoritmo DMC e GPC, [48].
Y = F + GAu,	(3.5)
F é o vetor com a resposta livre de todas as variáveis controladas, isto e, a resposta quando não ha mudança nas entradas ou Au = 0. Ge a matriz dinâmica no algoritmo DMC obtida com a resposta ao degrau de cada saída para cada entrada. A matriz G e tambem utilizada no algoritmo GPC onde e frequentemente obtida resolvendo-se a equação diofântica. Em [49] e [50] demonstra-se que a matriz G e a matriz Jacobiana das predições em funçao dos incrementos de controle G = N—.
*	mu
			Fi		
F		=	F2		(3.6)
			FN		
	Gii	G12	.		.	G1N¿	
G =	g21	G22	.		.	G2 V	(3.7)
	GNO1	GNo2	.		. G N V	
Substituindo as equacães 3.5, 3.6e3.7na equação 3.4, e definindo WFi = Wi - Fi, WF2 = W2 - F2 e assim por diante, tem-se que
Ni	Ni
j = (WFi -	GiiAui)TRi(WFi -	GiiAui)
i=1	i=i
Ni	Ni
+ (WF2 -	G2iAui)TR2(WF2 -	G2iAui)
i=i	i=i
+	...
Ni	Ni
+	(WFn	- G^Au/Rn(WFn -	GNoiAui)
i=i	i=i
+ Auf QiAuí
+ Auf Q2Au2
+ ...
+ AuNi QNi AuN	(3.8)
Desenvolvendo a equação (3.8) e multiplicando J por 1/2,
Ni	Ni
j =	5	AuT GTi Ri	GiiAui +
i=1	i=1
1 Ni	Ni
-	AuT gT R2	G2iAui +
i=1	i=1
... +
1 Ni	Ni
-	AuT GNoÍRno	GNoiAui
i=1	i=1
Ni
-	AuT GTiR1WF1
i=1
Ni
-	AuT gTr2wf2
i=1
-...	(3.9)
Ni
-	AuTG. R. WF
i=1
1	Ni
+xEAuT QiAu«
i=1
1 N
+~E WFTR WF, com	(3.10)
2	j=1
i = 1,..., Ni, j = 1, ...,NO.
Os algoritmos de controle preditivo para sistemas lineares DMC e GPC aplicados a problemas sem restriçães calculam o vetor Au que faz ddJu = 0. A ideia aqui é buscar Au1, Au2, ..., AuNi que faz o gradiente
■	dJ	■ Mui dJ Mu2		1 • o o 	1
dJ		0
		
Obviamente isto equivale a ddju = 0.
Para qualquer g = 1,Ni,
dÃ--	= GfgR	GüAUi	(3.12)
-	i= 1
Ni
+GT- R2	G2iAui
i= 1
+...+
Ni
+ GNO-R	GNoiAui
i= 1
—GT- R1WF1
—GT- R2WF2
—G . R . WFno
+Q- Au-
Agrupando os termos com Aug,
No	\
y? Gj- Rj Gj-+q- 1Au-+	(3.13)
No	Ni
GT-Rj I	GjiAui — (Wj — Fj)
j = 1	\i=1,i=-
Antes de escrever uma expressao para Aug deve-se observar que um algoritmo MPC é normalmente utilizado em sistemas de controle amostrados. Como j a mencionado, estes algoritmos normalmente entregam açoes de controle em períodos de tempo fixo chamados tempo de amostragem. O valor do tempo de amostragem depende da natureza do processo sendo controlado mas e tipicamente muito maior do que o tempo de amostragem utilizado no controle local ou tambem chamado controle regulat orio. Uma figura típica é o macrociclo do nível H1 de uma rede Foundation Fieldbus [51] que varia de 200 a 1000 ms, enquanto um tempo
de amostragem do algoritmo MPC pode ser medido em minutos em muitas aplicações na indUstria do refino e petroquímica, por exemplo.
Poderia-se imaginar um sistema de controle MPC distribuído rodando no nível H1 de uma rede Foundation Fieldbus. Neste caso o valor final de cada açõo de controle Aug calculada pelo controle MPC distribuído seria disponibilizado somente após um alto numero de macrociclos. Supondo que a funcõo de cada agente seja encapsulada em um bloco funcional Foundation Fieldbus, a cada macrocilo todos os Ni blocos funcionais do tipo agentes MPC calculariam o valor Aug em uma forma iterativa. Depois de um determinado numero de macrociclos os valores de Aug calculados por cada agente teriam evoluído para o valor final e seriam disponibilizados para o controle local tipicamente na forma de um set-point. Obviamente esta nao ó a unica forma de implementar o controle MPC distribuído mas ó uma forma simples de se explicar seu funcionamento.
Para a formulaçõo sem restrições a expressõo para cada Aug no tempo de amostragem t e na iteracõo k pode ser escrita como
Au lk =	Ofc
A ug 11	g -g,
(3.14)
onde
*g
E Gjg R Gjg + Qg ) e
No	í	Ni
— = E GTgRj (Wj (t) -Fj (t)- E GjiAukNt) j=1	\	i=i,i=g
Na equaçõo (3.14)
—	Wj (t) ó o vetor p x 1 com as referencias futuras da saída j no instante de amostragem t,
—	Fj (t) í o vetor p x 1 com as respostas livres da saída j no instante de amostragem t,
—	Auk-1(t) í o vetor m x 1 com os incrementos de controle da entrada i na iteraçõo k — 1 do instante de amostragem t,
—	p í o horizonte de prediçao e
—	meo horizonte de controle
Deve-se ressaltar que a dificuldade computacional para obter-se Aus e muito menor do que aquela para obter o vetor Au completo. Conforme ja discutido, nesta abordagem distribuída, o vetor Au e determinado por agentes utilizando uma combinação de calculos repetidos de Aug e troca de informações. Cada agente g inicia o tempo de amostragem t montando um valor inicial para Aug utilizando os valores finais obtidos no tempo de amostragem t — 1 depois de N iteraçães,
AUg I1
Aus IN! (2)
Aug IN! (3)
(3.15)
0
O valor inicial utilizado para Aug I1 é consistente com a filosofia dos algoritmos MPC que assumem como nulo o valor do incremento de controle no instante seguinte ao horizonte de controle, isto e, Au(m + 1) = 0. No instante de amostragem t, calcula-se o vetor incremento da acõo de controle Aug |t utilizando-se um filtro conforme sera explicado posteriormente. Na equaçcaõo 3.16 o índice k refere-se ao numero do calculo de Aug |t realizado pelo agente g no instante de amostragem t.
Aug |k = (1 - a)Aug |k + aAug |k-1.	(3.16)
3.2.2	Aplicação da técnica para um problema
benchmark
Apresenta-se nesta seçao a aplicacão da tecnica de controle MPC distribuído ao problema Shell Heavy Oil Fractionator descrito em [48]. Um diagrama esquematico da coluna é apresentado na figura 3.2. A aplicaçao do Controle preditivo distribuído tornase mais apropriada em situaçães onde não existe acoplamento de todas as entradas com todas as saídas que é uma situação esperada em grandes processos. Para a analise do desempenho do algoritmo proposto, entretanto, quanto maior o acoplamento maior sera a dificuldade imposta ao algoritmo. Por esse motivo utiliza-se esse processo para demonstrar a aplicacçãao do metodo. A dinâmica do processo é descrita por um modelo baseado em função de transferância em Laplace que é discretizada utilizando o tempo de amostragem de 4 minutos. As vari aveis controladas
Figura 3.2: Diagrama esquemático da coluna de destilação
sao a composição de topo yi, composicao da saída lateral y2 e a temperatura de refluxo de fundo y3. As variaveis manipuladas são a vazão de saída de topo u1, a vazao de saída lateral u2 e a vazão de recirculação de fundo u3. Deve-se observar que as variaveis manipuladas ui, u2 e u3 calculadas pelo controle avançado em um sistema com taxa de amostragem igual a 4 minutos (240 segundos) serao implementadas por controladores PID que rece-berãao estes valores como set-points e calcularaão a abertura dos posicionadores das valvulas de controle que implementaraão estas vazões na rede de controle local. Esta rede de controle local trabalha com tempo de amostragem da ordem de 1 segundo. Isto significa que se o controle local fosse implementado em uma rede Foundation Fieldbus, entãao os agentes que implementam o controle MPC distribuído poderiam trocar informacao ate 240 vezes aproximadamente (dependendo do macrociclo da rede) antes de disponibilizarem as açães de controle como referencia para os controladores locais de vazaão. Isto da uma ideia da factibilidade da
tácnica já que normalmente pode-se obter convergência com um nuímero muito menor de iteraçcãoes ou troca de informaçcãoes entre agentes. O modelo baseado em Funcao de Transferência no dománio Laplace é dado pela equação (3.17).
yi(s)
y2(s)
y3(s)
4.05e-27s
1+50s
5.39e-18s
1+50s
1.77e-28s
1 + 60s
5.72e-14s
1 + 60s
5.88e-27s
1+50s
6.9e-15s 1+40s
4.38e-20s
1+33s
4.42e-22s
1+44s
7.2
1+19s
U1(s)
U2(s)
U3(s)
(3.17)
As saídas	y2 e y3 estao sujeitas a perturbacoes. Dentre es-
tas perturbaçcoães estaão aquelas devido a variaçcoães nas vazãoes de refluxo de topo. As funcoes de transferância relacionando a per-turbaçao nas saídas yi, y2 e y3 e as variaçães nas vazoes de refluxo de topo são apresentadas pela equação (3.18).
yp1(s)
yp2(s)
yp3(s)
1.44e-27s
1+40s
1,83e~15s
1+20s
1.26
1+32s
Up(s)
(3.18)
A figura 3.3 apresenta uma proposta de controle para a coluna Shell utilizando 3 agentes. Um agente para cada ação de controle. Como ja mencionado, se o controle regulatório da coluna fosse implementado via Foundation Fieldbus (FF), então as acoes de controle seriam implementadas por controladores do tipo PID instanciados como blocos funcionais em posicionadores de vaílvulas de controle FF. Os agentes seriam blocos funcionais e poderiam estar igualmente instanciados nos posicionadores. Desta forma a referâencia para os controladores PID que efetivamente implementam as vazãoes passariam dos agentes para os blocos funcionais PID sem sequer utilizar o barramento.
Figura 3.3: Controle via agentes
as predicçãoes de forma semelhante ao algoritmo DMC podem ser convertidas para a formulação distribuída.
3.2.3	Comparação entre o algoritmo MPC Centralizado e Distribuído
A fim de comparar a resposta entre o algoritmo MPC centralizado e o algoritmo distribuído, utilizou-se o algoritmo MPC DMC (Dynamic Matrix Control) com os parâametros apresentados na tabela
3.1.	Os pesos utilizados para a função custo MPC não sao o foco deste trabalho. A escolha dos valores seguiu o usual compromisso entre desempenho e robustez. A resposta com o algoritmo distribuido mostrado na figura 3.4 foi obtida usando um numero de troca de informaçcãoes entre agentes igual a 20. O criterio de parada utilizado foi o numero de iteraçcãoes (igual a 20) mas existem outras possibilidades. Uma ideia e fixar um numero m aximo de iteraçcãoes mas dar a possibilidade para a iteraçcãao parar mais cedo baseado
Tabela 3.1: Parâmetros de sintonia do algoritmo MPC
S ímbolo	descrição	valor
p	Horizonte de predição	15
m	Horizonte de controle	3
Ri	Peso seg. de referência p/ yi	Ipxp
R2	Peso seg. de referência p/ y2	Ipxp
R3	Peso seg. de referência p/ y3	Ipx p
Qi	Peso esf. de controle Aui	0-2Ipxp
Q2	Peso esf. de controle Au2	0-2Ipxp
Q3	Peso esf. de controle Au3	0 •1 Ip x p
	Filtro de referencia	0.7
a	Au Filtro p/ MPC distribuído	0.35
Figura 3.4: Resposta com DMC distribu ído
0.6
0.4 -
1
0.2 -
-0.2 -
0

r
2
X-2
-0.4 L 0
4
6
8
10	12	14	16	18	20	22	24
Time [ h ]
Figura 3.5: Resposta com DMC centralizado
3.2.4	Desempenho do algoritmo MPC distribuído
Para se ter uma idéia do número de troca de informações entre agentes necesséria para um certo desempenho, uma anélise foi feita baseada no erro entre as saédas e as referências. Para cada saéda Yj a cada tempo de amostragem t o erro relativo et foi calculado como
(Y* - W)
et =	j Wt	= 1 - 3, t = 1 ...N	(3.19)
Assim, e* = 1 significa um erro de 100%. Uma média do erro absoluto foi calculada para cada saéda bem como a méedia das 3
saédas,
eabs (j ) —
N
|ej (t)|
t=1______
N ’
1 3
eabs —
3 j=i
N
/ Elej (t)l t=1
(3.20a)
(3.20b)
N
\
\

Um valor de eabs = .01 significa um erro médio de 1%. A figura
3.6	apresenta a percentagem com que o erro utilizando o algoritmo distribuído e maior do que o erro utilizando o algoritmo centralizado. E evidente que os erros relativos tendem a zero na media em que no numero de troca de informações entre os agentes aumenta. A equacão utilizada para calcular cada erro percentual da saída e
e% = (- 1) * 100	(3.21)
ecent
Nota-se que para esta aplicaçao, obtem-se erros aceitaveis para
5	10	15	20	25	30	35	40
Número de troca de informações entre agentes
Figura 3.6: Comparacao entre o numero de iteracoes e o erro de seguimento de referência
3.3	Convergência do Algoritmo MPC distribuído
A convergencia do vetor Au¿ para seu valor verdadeiro (aquele que minimiza a função objetivo) tem de ser garantida para uma aplicacçãao segura. Para uma aplicaçcãao sem restriçcãoes os desenvolvimentos feitos na area da computacão distribuída podem ser utilizados abstraindo-se da problematica da comunicaçcaão entre agentes. A tecnica Jacobi overrelaxation, [52], é adotada aqui para recalcular Aug como uma combinação linear dos valores calculados pela equação (3.14) e o valor obtido na iteração anterior,
Aug|k = (1 - a)Aug|k + aAug(3.22)
Para entender como o filtro a pode garantir estabilidade ou convergência do algoritmo é importante observar que a equacão (3.14) mostra que Aug, g = 1 : Ni, depende de todos os demais vetores Au», exceto do vetor Aug. Ao se agrupar as expressães para todos os Au» pode-se utilizar a equacão (3.14) para obter-se a equacçãao 3.23
N
Auilk =	Aij Auilk-1 + Bi,	(3.23)
i=i,i=g
onde as matrizes Aj terão dimensao m xm e o vetor Bj dimensao m x 1. A matriz A»» é nula. As matrizes Aj podem ser facilmente obtidas com a equaçcãao 3.14. Escrevendo uma expressãao centralizada para Au = [ Au1 Au2 ... AuNi ] utilizando
a equação (3.23),
Au1
Au2
Auní
(3.24)
o A12
A21 0
A1Ni
A2 Ni
Aui
Au2
k-1
Aníi Aní-ii
Auní
0
+
Bi
B2

Bní
que, numa forma compacta se torna
Auk = AAuk-i + B.	(3.25)
Aplicando o filtro de acordo com a equacão (3.22),
Auk = AFAuk-i + (1 - a)B,
Af = (1 - a)A + ai.	(3.26)
Nota-se que a ação do filtro e introduzir elementos na diagonal da matriz AF. No limite, para a =1, teríamos AF igual a matriz identidade. E obvio que a convergâencia sera obtida se os autovalores Xr de ((1 - a)A + aI) satisfazem
||ArII2 &amp;lt;1
(3.27)
3.4	MPC distribuído na presença de restrições
-&gt;
Em geral os algoritmos MPC utilizados na industria utilizam o algoritmo de Programaçao Quadrática na determinacão das açães de controle. Tipicamente o algoritmo de Programação Quadrática resolve o seguinte problema a cada instante de amostragem:
min	J	
Au		
s. a		
J =	2aut 5Au + eT Au	
AAu&amp;lt;	B	(3.28)
Na equação (3.28) a restriçao expressa por AAu &amp;lt;B representa uma família de restribes que normalmente incluem.
—	Restriçao sobre os valores dos incrementos de controle Au, isto e, Aumin. (j) &amp;lt;Au(j) &amp;lt;Au max. (j).
—	Restriçao sobre os valores das acoes de controle u, isto é, umin. (j) &amp;lt;u(j) &amp;lt;umax. (j).
—	Restriçao sobre os valores das saídas y, isto e, ymin (j) &amp;lt;y(j) &amp;lt;ymax.(j).
Essa família de restricoes responde pela maioria das necessidades da industria de processos. As restriçcãoes sobre os valores admissíveis para Au refletem a capacidade limitada da mudanca de valores que os atuadores podem fornecer. Uma valvula de controle, por exemplo, exige um tempo determinado para variar sua abertura desde 0% ate 100%. Para um determinado tempo de amostragem fixo, isto estabelece um maximo valor de incremento e de decremento de abertura realizavel a cada instante de amostragem. Esta limitacão e tambem chamada de slew rate.
As restriçcãoes sobre os valores das açcoães de controle, por outro lado, refletem os limites da capacidade do atuador. A mesma v alvula mencionada anteriormente, por exemplo, s o pode ter sua abertura entre os valores 0% e 100%.
As restriçães sobre os valores das variaveis de saída permitem exigir que algumas variaveis de interesse nãao ultrapassem algum valor determinado. O cumprimento destas restricçãoes e valioso quando se deseja garantir que uma determinada concentracçãao de
uma substâancia, por exemplo, naão seja menor ou maior que um determinado valor. Em um processo produtivo esta possibilidade e muito importante pois estes valores muitas vezes tem de ser assegurados devido a necessidade de se garantir a especificaçcãao do produto sendo produzido sob pena de se perder a produçcãao quando estas especificacçãoes nãao saão atendidas.
A introduçcãao dessas restriçcãoes na formulaçcaão de controle melhora o desempenho do sistema. Ha de se considerar que o algoritmo de otimizaçcaão resolve um problema numerico e, se naão informado, naão considera nenhuma limitaçcaão sobre o valor calculado de uma ação de controle, como 100% para a abertura de uma valvula de controle, por exemplo. Ao introduzir as restriçcãoes conhecidas do problema obtem-se uma açcãao de controle de melhor qualidade que efetivamente realiza o que se pretende com a função objetivo. Em [48] apresenta-se em detalhes a colocaçcãao de todas essas restriçcãoes na forma MAu &amp;lt;N.
A fim de introduzir restriçães na formulaçao distribuída reescreve-se o problema de Programação Quadrática colocando-se as res-tricçãoes dentro da funçcaão custo utilizando-se multiplicadores de Lagrange, [53]. A maioria dos resultados que seráo apresentados a seguir tambem fazem parte de um artigo apresentado em [54] e partes do trabalho estãao em outro artigo submetido ao Congresso Brasileiro de Automatica 2010. As simulacães realizadas nas sub-seçcãoes seguintes tanto para o algoritmo centralizado como para o distribuído utilizaram os parâmetros de sintonia apresentados na tabela 3.2.
Tabela 3.2: Parâmetros de sintonia do algoritmo MPC
Símbolo	descriçcãao	valor
P	Horizonte de predicçãao	15
m	Horizonte de controle	3
Ri	Peso seg. referância p/ yi	IpXp
R2	Peso seg. referância p/ y2	0.2IpXp
Rs	Peso seg. referância p/ y3	3Ipxp
Qi	Peso esf. de controle Au!	0 •1 Ip X p
Q2	Peso esf. de controle Au2	0-2Ipxp
Q3	Peso esf. de controle Au3	0-15Ipxp
	Filtro de referância	0.4
a	Au Filtro p/ MPC distribuído	0.375
3.4.1	Restrições sobre Au
Para restrições em Au e u não ha dificuldades pois a restricao e local. Para o caso de restricão em Au a matriz A da equação (3.28) e a matriz identidade de dimensão m x m e o vetor B para o caso de limite superior seria escrito como B = Aumax1 onde o vetor 1 e um vetor de uns de dimensao m x 1. Para este caso pode-se reescrever a funçcaão objetivo como
min	L	
Au		
s. a.	^AuT4Au + eTAu + Ats (IAus -	
L=		_ Au^ax 1)
AT &gt;	0	(3.29)
d Aus dL
As
Para todos os agentes g = 1 : Ni, exceto o agente g = s, calcula-se a ação de controle conforme a equação (3.14) aqui repetida,
Aug |k = -4-1eg	(3.30)
Para o agente s, a soluçcaão otima exige que
= 4S Aus + es + As =0
= IAus - Aumax1 =0
&gt;	0	(3.31)
Define-se o erro ao atendimento à restrição S,
S = IAus - Aum‘ax1.	(3.32)
Existem diversas formas de implementar um sistema iterativo com as equacçãoes 3.31 e 3.32 que resultem na solucçãao otima de 3.30. Uma ideia é utilizar o erro ao atendimento da restrição, S, para modificar o vetor com os multiplicadores de Lagrange As de forma a modificar Aus e levar ao cumprimento da restricão (S = 0). Deve-se ter em mente que a equacçãao 3.31 e valida somente na ocorrência da restrição. De qualquer forma quando As é nulo a solucçaão e a mesma obtida pela equaçcãao 3.30.
A forma adotada para transformar o erro S em mudanças no valor de As utiliza o fato de que manipulando-se as equações 3.31 e 3.32 obtém-se
dA
dS =	(3.33)
Assim, para um incremento de erro ASun. = [ 1	1	• • •	1 ]T
deve-se modificar o vetor As na direcao do vetor unitario Ad,
Ad = ||$AS|| $sAS“”--	(3.34)
De forma que, para um determinado vetor erro S, calcula-se o incremento do vetor AA como a projecão de S no vetor unitério Ad;
AA = (S.Ad)Ad, ou
Aj = Aj-1 + (S.Ad)Ad	(3.35)
Finalmente pode-se escrever o processo iterativo proposto para obtencão da acão de controle obedecendo a restrição em Au. A ação de controle para o agente s pode ser calculada de forma iterativa inicializando o vetor As de dimensao m x 1 com zeros. Define-se o erro ao atendimento da restricão na iteracao k como
Sj = IAuJ-1 - A&lt;“1	(3.36)
Na sequência atualiza-se o vetor Aj,
Aj = Aj-1 + (Sj .Ad) Ad,
Aj (j)	&gt; 0 para j=1:m	(3.37)
e calcula-se a acçãao de controle
Auj = -$-1 (ej + Aj),
Auj = (1 - a)AuJ + aAuJ-1.	(3.38)
tribuído utilizou-se 35 trocas de informações a cada instante de amostragem. Foi exigido uma restrição no incremento da ação de controle Au1 na forma Au1 &amp;lt;0.05.
y
0.8
0.05
0.6
0.5
0.15
0.25
0
0.05
8
8
0
0
u1
u2
U3
2	4	6
tempo [ h ]
246 tempo [ h ]
-0.25
0
tempo [ h ]
u
------y,
------y2
------ys
ref,
ref2
ref3
-0.05
tempo [ h ]
			 A(l) 	 A,(2) 	 A, (3)
			
		
JL		
0
Figura 3.7: Resposta do MPC Distribuído com restrição Aui &amp;lt;0.05
A figura 3.7 apresenta os resultados obtidos com o algoritmo MPC distribuído proposto. Observa-se que como o horizonte de controle e igual a 3, ha tambem 3 multiplicadores de Lagrange para restricão nos incrementos de uma açao de controle. Esses multiplicadores assumem valores que otimizam a função objetivo atendendo a restriçcãao.
A figura 3.8 apresenta os resultados obtidos com o algoritmo MPC centralizado. Foi utilizado o MPC DMC com o algoritmo de pro-gramaçao quadrática quadprog do Matlab. A fim de fazer uma melhor comparacao extraíram-se os multiplicadores de Lagrange utilizados pelo algoritmo quadprog do Matlab. Nota-se a grande semelhançca entre os valores dos multiplicadores de Lagrange obtidos na forma distribuída e centralizada dos algoritmos. Observando os valores das saídas para a versão distribuída e centralizada percebe-se um comportamento ligeiramente mais pr oximo das referencias para o caso distribuído. Com ambas as tecnicas as restriçcãoes saão obedecidas. Naão se conhece em profundidade
y
tempo [ h ]
0.75
0.25
0
-0.25
0
8
2	4	6
tempo [ h ]
02468 tempo [ h ]
Figura 3.8: Resposta do MPC Centralizado com restrição Au &amp;lt;0.05
a tecnica utilizada pelo otimizador quadprog no tratamento das restriçcõoes e por enquanto pode-se afirmar que o resultado obtido com o MPC distribuído nõo é pior do que aquele obtido com a tecnica centralizada, pelo menos para esta aplicacçõao.
Para restricoes do tipo Au &gt; Aumm transforma-se a restriçõo fazendo
Au	&gt;	Au™1 equivale a
—Au &amp;lt;— Au^l	(3.39)
A equacõo (3.29) deve ser reescrita como
min L
Au
s. a
L =	2 AuT 5Au + 0T Au + Af (—IAus + Au^ax 1),
Af &gt; 0	(3.40)
Neste caso para o agente s,
dL dAus dL
dAs
= $sAus + ©s - As =0
= S = —IAus +A«m“x1 =0
&gt; 0
(3.41)
A
s
As figuras 3.9 e 3.10 mostram os resultados de simulaçao para
y
tempo [ h ]
tempo [ h ]
A u
tempo [ h ]
Figura 3.9: Resposta do MPC Distribuído com restrição Auj. &gt; —0.05
a restricão Aui &gt; -0.05. A figura 3.9 mostra a resposta com o MPC distribuído utilizando 50 trocas de dados entre os 3 agentes enquanto que a figura 3.10 apresenta os resultados com o MPC centralizado utilizado o otimizador quadprog do Matlab. Em geral as respostas sãao bem semelhantes.
3.4.2	Restrições sobre u
As restrições sobre u podem ser tratadas de forma semelhante ao que foi feito com aquelas sobre os incrementos de controle Au. Deve-se ressaltar que qualquer acão de controle s pode ser escrita
y
0.6
tempo [ h ]
Lambda
-0.4 1-------111-----------------------1
0	2	4	6	8
tempo [ h ]
Figura 3.10: Resposta do MPC Centralizado com restricao Au &gt; -0.05
como
us = uS 11 + DAus, onde
D
10	•••	0
11	...	0
11	...	1
(3.42)
O vetor uS 11 de dimensão m x 1 e composto pelos valores da ação de controle us implementada no instante de amostragem
anterior. Para o caso de restrição no valor maximo de uma deter-
minada açao de controle s, u™™, a funcao custo aumentada com
os operadores de Lagrange seria escrita como
min
Au
s. a
L =
A
&gt;
T
s
L
-AuT5Au + eTAu + AT (DAus + «s-11 - C“x1)
0	(3.43)
Para os agentes diferentes de s,
Aug Ik = -$-1eg	(3.44)
Para o agente s,
dL dAus dL dA
$sAus + es + Dt As — 0
DAus + «s-11 - C“x1 = 0
As &gt;	0
(3.45)
Neste caso define-se o erro ao atendimento da restriçao como
£ = Aus + D-1 (uS-11 -	.	(3.46)
A partir da equaçao (3.46) e (3.45) pode-se obter
= G = - (DT)“1 $SD-1	(3.47)
A equaçõo (3.47) mostra o gradiente de As em relaçõo ao vetor S, G. Para um vetor com um incremento unitaério nos componentes
de S = Sun pode-se obter o vetor unitério que mostra a direcõo
do ajuste de As,
Ad =
-GAEun
gae. .. •
(3.48)
Como ja feito anteriormente, para um determinado vetor erro S pode-se calcular o incremento do vetor AAs como a projecao de S no vetor unitério Ad,
AA — (E.Ad)Ad, ou
Ask — Ask-1 + (E.Ad)Ad
Ak &gt; 0
(3.49)
O processo iterativo é semelhante ao que já foi explicado para a restrição em Au. As figuras 3.11 e 3.12 mostram a comparacão entre a aplicação do algoritmo distribuído e centralizado para o caso de uma restrição em ui, ui &amp;lt;0.35. A figura 3.11 mostra a resposta obtida com o MPC distribuído utilizando 35 trocas de informação entre os 3 agentes utilizados. A figura 3.12 mostra a resposta obtida com o algoritmo MPC centralizado. Observase que as respostas sãao muito semelhantes e ambas as tecnicas obedecem a restriçcãao.
y
Au,
			
Ou.			
		vr	
			
-0.2 ---------!----------!----------!---------
0	2	4	6	8
tempo [ h ]
Figura 3.11: Resposta do MPC Distribuído com restrição u1 &amp;lt;0.35
3.4.3	Restrições sobre y
Este e o principal desafio para a aplicacão de controle preditivo na forma distribuída. A introducão de restrições sobre uma determinada saída afeta um grupo de agentes responsaveis pelo comportamento desta saída tornando o problema mais complexo do que foi para as restricães sobre Au e u. Sem perda de generalidade discute-se aqui o tratamento para a restrição em uma das saídas, saída j, do tipo yj &amp;lt;ymax. Como ja feito anteriormente ha de se restringir o valor de yj ao longo de todo o horizonte de predicao
0
8
0
8
2	4	6
tempo [ h ]
246 tempo [ h ]
Figura 3.12: Resposta do MPC Centralizado com restrição u1 &amp;lt;0.35
neste caso. Assim, do ponto de vista do controle MPC, equivale a dizer
yj &amp;lt;ymaxiPxi ou
GjiAui + Gj2Au2 + • • • + Gjn Aun +	&amp;lt;yjax íp^i50)
A formulação do problema de Programação Quadrática que determina a açcãao de controle na formulaçcãao centralizada e
min	J	
Au		
s. a		
J =	|aut 5Au + eT	Au
AAu&amp;lt;	B	
A=	[ Gji Gj2	• • •	Gjn ]
B=	y““x1pXi - Fj	
Au =	[ Aui	Au2	• •	• Au„ ]T
Antes de iniciar o procedimento de introduzir a restriçao em uma função custo aumentada incorporando os multiplicadores de La-
grange, vamos supor que tanto a resposta livre Fj como a res-tricão yj &amp;lt;ymax possam ser divididas em tantas partes quantas forem as açoes de controle, n. Assim, no lugar de 1 restrição, teremos n restrições. Esta suposiçao é apenas um artifício matematico como sera demonstrado na sequâencia,
Fj = Fj1 + Fj2 ' Fjn
= yma + y™ax + ... + y™*	(3.52)
A formulação do problema descrito pela equação (3.51) seria modificada para
min		J	
Au			
s. a		^AuT	
J			$Au + eT Au
		2	
Gj1Au1	&lt;	„ max yji	-	-Fj!
Gj2Au2	&lt;	max yj2	-	Fj2
Gjn Aun	&lt;	max yjn	-	_ Fjn-
Agora pode-se propor uma função custo aumentada introduzindo-
se as restriçcãoes com		os multiplicadores de Lagrange.
min		L
Au		
s. a		|aut 4Au + 0T Au +
L		
		A (GjjAu! - ymax + j + Af (Gj2Au2 - y	+ Fj2) +
		... +
		Af (Gj„aU - y™nax + F .
Ai	&gt;	0pX 1
A2	&gt;	0pX 1
An &gt;	0px1
(3.54)
Seguindo com a estrategia de se buscar
[ dL dAuí
dL dAu2
dAUn ]T = [0 0 ••• 0 ]T&gt;	(3.55)
aplica-se as cond^ães para minimização da equação (3.54),
dL dAui
dL
dAu2
dL dAun dL dÃi dL dÃ~2
dL dAn
Ai
A2
$iAui + ei + Gt1Ai = 0
$2Au2 + e2 + gt2a2 = 0
$nAun + en + GTnAn = 0
Si = GjiAui - ymx + Fji = 0
£2 = Gj2Au2 - ym2ax + Fj2 = 0
= Sn = GjnAun - y^ + Fjn = 0
&gt;	0px i
&gt;	0px i
A„ &gt; 0pXi	(3.56)
Deve-se encontrar os vetores Aug, g = 1 : n, que satisfacam a equacao (3.56). E interessante observar que ao somar as ex-pressoes para £i, recupera-se a restriçao original.
£	=	£i + £2 + • • • + £n, ou
£ = GjiAu! - ymax + Fj! + Gj2Au2 - ym2ax + Fj2 +
. +
Gj„Au„ - ymax + Fjn	(3.57)
O grande desafio é determinar os vetores Ag, g = 1 : n, pois cada agente calcula sua acçãao de controle como
Aug = -$g-1 (eg + GTg Ag )	(3.58)
Trabalhando-se com as equações 3.56 e 3.57 as seguintes relaçães são obtidas,
(3.59)
A equação 3.59 sugere que uma pequena violação na restrição para yj, AS, poderia ser eliminada mudando cada Ai pelo valor apresentado na equaçcaão 3.60,
AAi = (g^G^)-1 AS.	(3.60)
Entretanto a inversãao da matriz apresentada na equaçcãao 3.60 nãao e realizavel para sistemas com atraso de transporte que irãao exibir um determinado numero de linhas com zeros para Gji. Diante disso buscou-se uma forma heurística que mostrou bom resultados. Um vetor Vji é montado conforme equacao 3.61,
Vji = (g^-G) 1,	(3.61)
em seguida, cada elemento não nulo de Vji é invertido e o vetor resultante é normalizado resultando no vetor Vj.orm. Para cada agente g, (g G 1 : N), o seguinte pseudo-codigo é executado a cada instante de amostragem t,
—	Todos os vetores Aí são inicializados com zeros.
—	Os vetores Vj°rm são computados offline,
—	Cada agente g calcula Sk, o erro ao atendimento a restrição,
N
GjíAuk-1 + Fj - ymax1	(3.62)
i
—	Ag é atualizado como
Akg=Ag-1+yk.vn°ry v™rm
—	Qualquer elemento negativo de Ag é forçado a zero.
—	Aug é calculado de acordo com a equacao 3.58.
(3.63)
— Aplica-se o filtro em Au()
Au^ = (1 — aJAuJ + aAug 1	(3.64)
O processo é iterativo e aquelas açães de controle que não afetam a restrição acabam tendo um operador de Lagrange nulo devido a restricao Aj &gt; 0. Deve-se observar que o procedimento iterativo permite que os valores positivos de Aj aumentem ou diminuam para atender a restriçcãao sempre se mantendo naão negativos. As figuras 3.13, 3.14e 3.15 mostram a resposta obtida com controle MPC DMC centralizado e distribuédo para uma restrição em y2, y2 &amp;lt;0.26. Em todas as figuras apresenta-se na coluna à esquerda as saédas no topo e as acães de controle na base. Na coluna da direita apresenta-se uma ampliacçaão na regiãao onde a restriçcãao estéa ativa no topo, e os operadores de Lagrange na base.
A figura 3.13 mostra o resultado de simulacão para o MPC centralizado com uma restrição em y2, y2 &amp;lt;0.26. Neste caso sao utilizados somente 15 multiplicadores de Lagrange, p = 15. A figura 3.14 mostra a resposta obtida com a aplicaçcãao do controle MPC distribuédo proposto usando 35 trocas de informaçcaão entre os agentes enquanto que a figura 3.15 apresenta a resposta quando o numero de troca de informacões utilizado foi 50. Fica evidente que o aumento do numero de troca de informaçães melhora a resposta. O resultado obtido com 35 trocas de informaçcaão ée similar aquele obtido com o MPC centralizado enquanto que a resposta resultante da aplicaçcaão do algoritmo distribuédo com 50 trocas de informaçcãao apresenta um comportamento melhor. Percebe-se que a resposta com o algoritmo distribuédo, aléem de atender a restricão, segue melhor a referencia e apresenta uma perturbacão menor na saéda y2.
Uma possével razão para esse resultado é que o algoritmo dis-tribuédo utiliza um nuémero de multiplicadores de Lagrange muito maior do que o algoritmo quadpro do Matlab. A técnica de calcular um vetor com os multiplicadores de Lagrange para cada agente a fim de anular o erro projetado resulta em um numero muito grande de multiplicadores de Lagrange o que acaba resultando em uma melhor resposta.
Figura 3.13: Resposta utilizando MPC centralizado com restriçao em y2, y2 &amp;lt;0.26
y
tempo [ h ]
-0.2 -------'-------'-------'-------
0	2	4	6	8
tempo [ h ]
tempo [ h ]
Figura 3.14: Resposta utilizando MPC distribuído com 35 trocas de informação e restricão em y2, y2 &amp;lt;0.26
y
tempo [ h ]
y
tempo [ h ]
tempo [ h ]
Figura 3.15: Resposta com MPC distribuído com 50 trocas de informação e restricão em y2, y2 &amp;lt;0.26
3.5	Conclusões e desenvolvimentos futuros
A metodologia apresentada buscou resolver o problema de controle MPC multivariavel de forma distribuída frente as restrições tipicamente tratadas na industria. Acredita-se que esta tecnica permitir a a utilizaçcaão de controle preditivo de forma mais intensa principalmente onde ja se utilizam sistemas de controle via redes fieldbus, por exemplo. Em uma rede Foundation Fieldbus, por exemplo, um bloco funcional poderia ser oferecido que, quando instanciado em diferentes instrumentos permitiria a obtençcãao da lei de controle do MPC atraves da troca de informaçcãoes no bar-ramento H1 da rede. Uma solução MPC desse tipo permitiria uma adaptaçao do algoritmo à um aumento da planta de forma relativamente simples ja que novos blocos poderiam ser instanciados com comunicaçcoães com outros blocos conforme a natureza da solucçãao. Para o caso sem restricçãoes apresentou-se as condiçcãoes necess arias para a estabilidade do algoritmo. Existem entretanto diversos aspectos que precisam ser estudados com mais profundidade. Na sequêencia do trabalho pretende-se
—	desenvolver tecnicas que incorporem garantia de estabilidade para a soluçcãao obtida com o processo iterativo dos agentes,
—	aplicar as tecnicas desenvolvidas no capítulo 4 para o tratamento de erro de modelagem e acrescentar tecnicas de iden-tificaçcãao em malha fechada que permitam a aplicacçaão da tecnica em plantas com pouco conhecimento dos modelos dinêamicos. Os agentes teriam a capacidade de identificar novos modelos na medida em que determinassem índices de desempenho com potencial para melhorias com os modelos atuais,
—	estudar o comportamento do sistema frente a falhas de co-municaçcãao, falhas nos atuadores da camada regulat oria, etc,
—	desenvolver tecnicas para diminuir o numero de troca de informações. Estudar a influencia do numero de troca de informaçcãoes frente a perturbacçãoes, seguimento de referêencia, etc,
—	estudar a formulaçao para aplicacao de NMPC (Nonlinear MPC).
Capítulo 4
MPC Prático para sistemas não lineares -PNMPC
4.1	Introdução
Desde seu surgimento a tecnica de controle preditivo para sistemas lineares vem se tornando cada dia mais popular na industria, principalmente depois do surgimento do Controle Preditivo DMC. A aplicaçao de Controle Preditivo requer a determinação de um modelo do processo. Como a maioria dos processos saão efetivamente nãao lineares recorre-se a tecnicas de linearizaçcãao para a obtençcãao do modelo. Para muitos processos este procedimento e aceitável, seja pelo nível de nao linearidade do processo ser pequeno ou pelo fato da planta operar sempre em uma regiãao muito proxima do ponto de operaçcãao utilizado na linearizaçcaão do modelo. Seja um processo sem acoplamento direto entrada-saída descrito por
x = f (x, u),
y(x) = h(x),
(4.1)
onde x é um vetor com os estados do processo e y um vetor com as saídas. Os pontos de equilíbrio do processo são obtidos fazendo-se X = 0, ou f (xeq., ueq.) = 0 e yeq. = h(xeq.), onde yeq., xeq., ueq. são respectivamente as saídas, os estados e as entradas nos pontos de equilíbrio do sistema. Para um ponto de equilíbrio na origem, pode-se escrever
x = Ax + Bu, y = Cx,
onde
A
B
C
211
dx lXe9' ,Ueq
211
du lXeq' ?Ueq
dh | dx|Xeq' ’Ueq
(4.2)
(4.3)
Na equação 4.3 a matriz A e conhecida como o Jacobiano de f(x, u). Seus autovalores definem a estabilidade dos pontos de equilíbrio xeq, ueq..
O modelo representado na forma de equações de estado cont ínua pela equacçãao 4.2 pode ser convertido na forma de equaçcãoes de estado discreta ou na forma de função de transferência.
A linearizacçãao pode tambem ser realizada utilizando-se o conceito de vari avel desvio onde se aplica uma mudançca de vari aveis para levar o equilíbrio à origem.
xá = x - xeq.,
Uá = U - Ueq..	(4.4)
Neste caso pode-se igualmente descrever o sistema pela equação de estado para pontos de equilíbrio nao triviais,
xs = Axs + Bu,
y = yeq. + Cxá.	(4.5)
A tecnica de linearizaçao em pontos de equilíbrio do sistema tem sido aplicada principalmente de duas formas. A forma tradicional considera o modelo linearizado invariante e utiliza-o para fazer as predicães. Uma forma mais elaborada consiste em atualizar o
modelo a cada instante de amostragem e considera-lo invariante ao longo do horizonte de predição.
4.2	Metodologias de MPC para Processos Não Lineares
Existe uma grande quantidade de tecnicas MPC que direta ou indiretamente tratam sistemas não-lineares [55]. Uma possível classificação destas tecnicas as divide em 3 grupos: (a) as que utilizam diretamente um modelo nãao linear generico e um algoritmo de otimizaçao não linear de proposito geral; (b) as que utilizam modelos nãao lineares particulares e metodos de otimização específicos para o modelo escolhido; (c) as que utilizam um ou varios modelos lineares para representar o processo e algoríti-mos de otimizacçãao lineares. Evidentemente as vantagens de uma ou outra alternativa estãao diretamente relacionadas ao compromisso desempenho-custo computacional. Nesta seção discute-se, com uma visão pratica, as vantagens e desvantagens de algumas destas tecnicas, para fornecer subsídios ao projetista na hora de escolher uma ou outra metodologia.
4.2.1	MPC com modelos de predicao nao-linear na Funçao Objetivo
Uma abordagem natural e a utilizaçcãao das prediçcoães na funçcãao objetivo empregando o modelo não-linear. A minimizacão da funcçãao objetivo e realizada com programas de otimizaçcãao especializados na soluçcãao de funçcãoes naão-lineares como Programaçcãao Não Linear ou Sequential Quadratic Programming (SQP), etc. São preservadas as características de horizonte deslizante e a repetição da otimizaçao a cada período de amostragem. O problema de otimizaçcãao a ser resolvido pode em geral ser colocado como
u = argmin f (W, Y, 11, u)	(4.6)
Sujeito a :
h(u) = 0,
g(u) &amp;lt;0, onde
W é o vetor com as referências futuras, Y é o vetor com as saídas presentes e passadas, u é o vetor com as entradas passadas e u é o vetor com as entradas presente e futuras. Além disso, f : Rn —&gt; R, h : Rn —&gt; Rm e g : Rn —&gt; Rp sao funcões conténuas e diferenciéaveis.
Do ponto de vista pratico a principal vantagem deste metodo reside no uso de um modelo nõo linear, que permite em geral, obter predições muito próximas as saédas reais da planta. Como desvantagens devem citar-se as questões iterativas dos métodos de otimizaçõo, a incerteza no tempo que levam para entregar uma resposta, a convergêencia, as soluçcõoes em ménimos locais, etc. que fazem com que sua utilizaçõo para controle em tempo real seja ainda pouco difundida. Alguns deste pontos sõao discutidos em [56].
4.2.2	Métodos baseados em modelos particulares
Uma forma de obter uma solucao mais simples que a correspondente ao modelo naõo linear genéerico consiste em utilizar modelos nõo lineares particulares como por exemplo Séries de Volterra ou modelos de Hammerstein [57, 58]. Estas alternativas sõo interessantes na praética quando o caso estudado enquadra-se bem na aproximaçao selecionada. O compromisso entre complexidade de célculo e desempenho é novamente o fator determinante da escolha. A otimizaçõo nestes casos pode ser mais simples que no caso geral. Do ponto de vista préatico ée importante notar que o uso de um modelo mais complexo que represente melhor a dinêamica do processo real somente seréa vantajoso quando o erro de modelagem for pequeno. Em outros casos a des-sintonia do controlador necesséaria para manter a robustez pode eliminar a vantagem do uso de um melhor modelo.
4.2.3	Metodos baseados em linearizações
controlado será proporcional as diferenças entre o modelo e o processo. Diversas abordagens baseadas em simplificações, linearizações e LMPC tem sido propostas. Algumas delas sao analisadas no que segue.
Ponderação de múltiplos modelos lineares
Para um determinado modelo nõo linear representado por
x =	f (x, u)
y =	h(x)
(4.7)
podem-se obter modelos lineares nos equilíbrios do sistema. Estes equilíbrios sõo definidos pelo conjunto de pontos P = {(x*, u*) s. a X = f (x*, u*) = 0}. Um modelo linear pode ser obtido ao redor de um equilíbrio (x®, u®) G P como
x = Ai(x - xi) + Bi(u - ui)	(4.8)
y = h(xi) + Ci(x - xi), onde
Ai = df (x,u)
A =	dx
l(xgu^), B
df (x,u) du
|(x¿,u¿) e Ci =
dh(x,u) dx
|(x¿,u¿).
Os modelos contínuos obtidos tem um equivalente discreto com
matizes Ad, Bd, Cd. Em algumas condicoes, o modelo nao linear da planta pode ser recuperado pela combinaçõo de N modelos politopicos
i=N	i=N
[Ad, Bd] = ^2 OiAd’ Bd], onde ^2 a® = 1	(4.9)
i=1	i=1
Esta ideia pode ser explorada no contexto de controle MPC robusto, MPC adaptativo ou MPC escalonado. Em [59], [60] e [61] discute-se a utilizaçcaõo de multiplos modelos lineares com enfoque na proposta de controle MPC robusto. Em [62] discute-se a utiliza-çcõao de multiplos modelos em uma proposta de MPC escalonado. Em [63] um esquema adaptativo utilizando MPC DMC é apresentado para um sistema de uma entrada e uma saída. O custo computacional e o desempenho destes metodos esta diretamente relacionado ao numero de modelos necessarios e aos procedimentos de ponderaçcõao, que em geral nõao sõao simples de generalizar.
Método min-max
Este metodo foi desenvolvido para sistemas lineares que apresentam comportamentos dependentes de parâmetros variaveis no tempo ou perturbacçãoes e pode ser usado para processos nãao lineares quando estes sao representados aproximadamente por um conjunto de modelos lineares. A filosofia utilizada na tecnica min-max e determinar a açcãao de controle que minimiza uma funçcãao objetivo para o cenario em que o conjunto de perturbacçãoes e incertezas a maximizam. A funcçãao objetivo penaliza o desvio do comportamento predito pelo modelo e aquele desejado. Considerando o conjunto de vari aveis incertas ou perturb aveis como © , pode-se escrever o problema da seguinte forma
u = argmin J (W, Y, "u, u)	(4.10)
J = argmax J(W, Y, "u, u, 0)
sujeito às restriçães nas variaveis de controle e de processo. Esta tecnica e considerada custosa computacionalmente pois, dependendo do numero de variaveis incertas e dos horizontes de predição e controle pode haver uma explosao de combinaçoes a serem investigadas para a determinacçãao do maximo. A tecnica de otimizaçcaão min-max surgiu de pesquisas na area da teoria dos jogos dinâmicos. Em [64], [65], [66] e [67] propãe-se a utilização da otimização min-max em MPC utilizando modelos baseados na resposta ao impulso. Outros autores desenvolveram algoritmos MPC utilizando a tecnica de otimizaçcaão min-max para sistemas representados por equaçães de estados. Em um trabalho recente nesta area, [68] propãoe-se uma tecnica MPC baseada em otimizaçcaão min-max mas que sugere uma forma de diminuir o custo computacional. No lugar de buscar o m aximo da funçcãao custo considerando todas as combinacães possíveis para o conjunto de incertezas e o horizonte de prediçcãao, os autores mostram uma tecnica onde se determina um limite superior (upper bound) para a maximizacão da função custo que sera entãao minimizada.
Assim, esta abordagem nãao se apresenta interessante do ponto de vista pr atico dado que nãao se mostra computacionalmente mais atrativa que a de NMPC.
Linearizações a cada instante de amostragem
Muitas pesquisas nesta area visam a resolucçãao, por metodos alternativos, do problema de otimizacão não linear. Em alguns casos, como em [69], estende-se a ideia de resposta livre yi e forçada yj usando um modelo não linear para o calculo de yl e um modelo linear para yf supondo que esta ultima pode convergir a zero num procedimento iterativo. Desta forma o problema de otimizaçcãao não linear pode ser transformado numa sequência de problemas de otimizaçcãao linear. Esta metodologia pode funcionar adequadamente em alguns casos praticos sem necessidade de muitas iter-açcoães mas naão garante a obtencçãao do otimo nem a convergêencia do processo iterativo [70]. Em outros casos utilizam-se lineariza-çcãoes sucessivas em torno ao ponto de operaçcãao transformando o modelo num sistema variante no tempo, mas que permite utilizar algoritmos mais simples para minimizar J [71, 72].
Em todos os casos anteriores onde sãao usadas aproximaçcoães tratase de compensar as perdas no desempenho com a maior velocidade de processamento e simplicidade dos algoritmos. Assim, pode-se considerar como melhor aquele algoritmo que consiga o melhor compromisso desempenho-simplicidade-velocidade. Como se vera na proxima seçcãao, este objetivo pode ser atingido com uma abordagem pratica e simples de NMPC.
4.3	Desenvolvimento da técnica PNMPC
Conforme discutido no apêendice A, os algoritmos de controle preditivo para sistemas lineares como o DMC e o GPC utilizam a representacao do vetor de predicoes ao longo do horizonte p, Y, como uma funcao do vetor com m mudancas na acão de controle Au,
Y = F + GAu,	(4.11)
A tecnica proposta neste trabalho difere das propostas anteriores principalmente pelo fato de utilizar modelos linearizados independentes dos pontos de equilíbrio do sistema. Deve-se perceber que ao se calcular as predicoes, para um sistema linear ou não linear, os unicos elementos que podem mudar os valores das prediçães são os elementos do vetor incremento de controle Au.
Busca-se uma forma de descrever a evolucao dos estados do sistema ao longo do horizonte de prediçcaão utilizando uma represen-taçcãao linear dos estados em relaçcaão aos incrementos de controle futuros. Para isto nãao se utiliza o conceito de ponto de equilíbrio. Assume-se que as predições Yp dependem das entradas passadas ii, dos estados presentes e passados y" e dos incrementos de entradas futuros Au,
Yp = f ( y , u, Au).
(4.12)
O Vetor com as prediçães é reescrito como
F + GpnMPCAu,
(4.13)
Yp
onde
F
GpNMPC
f( y", u"),
d Yp
d Au
A matriz GpNMpC é o Jacobiano de Yp.
Desenvolve-se aqui uma forma de representaçcãao das predicçãoes que pode ser utilizada tanto para sistemas representados por modelos lineares como para aqueles representados por modelos nãao lineares desde que os estados sejam contínuos e diferenciíveis em relação as entradas.
Seja x £ e w um vetor de funçoes contínuas e diferenciaveis
de x.
w=
w1(x1&gt; x2 , ... , xm )
W2(X!,X2, . . . ,Xm)
(4.14)
wp (x1, x2, ... , xm )
e um vetor p x 1 das funçães de m variéveis do vetor
Para pequenas variaçães de x igual a Ax em torno de xo,
Ax = [ Ax i Ax2 ... Axm ]T,	(4.16)
pode-se obter uma aproximaçao de w(xo + Ax) utilizando-se a série de Taylor onde os termos de ordem maiores do que 1 são desprezados.
w(xo + Ax) = w(xo) + dx (xo)Ax,	(4.17)
onde dx e o gradiente de w relativo a x calculado em x = xo.
d w
d x
dwí	dwí	dwí
dxí	dx2	
dw2	dw2	•	dw2
dxí	dx2	
dwp	dwp
dxí	dx2
dwp
(4.18)
X=Xo
Seja o sistema dinêmico nao linear contínuo e diferenciavel com uma entrada e uma saéda representado pela equaçcãao (4.19):
y(k) = f (y(k - na),y(k - na + 1)...,y(k - 1),
u(k - nu), u(k - nu + 1), ..., u(k - 1)),	(4.19)
onde na e nb são os maiores atrasos de y e u respectivamente. Assume-se que as entradas ocorrerãao em um horizonte de controle m. Neste horizonte aparecem as seguintes entradas
u(k)	= u(k - 1) + Au(k)
u(k +1) = u(k) + Au(k + 1) = u(k - 1) + Au(k)
+ Au(k + 1)
u(k + m - 1) = u(k - 1) + Au(k) + Au(k + 1)
+	+ Au(k + m - 1).
(4.20)
Assume-se que as entradas nos instantes posteriores a k + m - 1 sejam iguais a u(k + m - 1). Calculando-se as prediçães em um horizonte de prediçcãao p a partir do modelo dado pela equaçcaão
(4.19)	tem-se
y(k + 1) = f (y(k - na + 1)..., y(k), u(k - nu + 1), ...,u(k)) (4.21)
y(k + 2)	=	f (y(k - na	+ 2)...,y(k	+ 1),u(k - nu + 2), ...,u(k + 1))
y(k + p)	=	f (y(k - na	+ p)...,y(k	+ p - 1),u(k - nu + 1), ...,u(k + m	- 1))
Considerando as equaçães 4.20, o conjunto de equacães 4.21 pode ser reescrito como
y(k + 1) = f (y(k - na + 1)...,y(k),u(k - nu + 1), ...,u(k - 1), Au(k)) y(k + 2) = f (y(k - na + 2)...,y(k + 1),u(k - nu + 2), ...,u(k - 1), Au(k), Au(k + 1))
y(k + p) = f (y(k - na + p)...,y(k + p - 1),u(k - nu + 1), ...,u(k - 1), Au(k), Au(k + 1),Au(k + m - 1))	(4.22)
Observa-se que as predicães são funçães de Au(k), Au(k+1),	Au(k+
m — 1), das entradas passadas e das saídas presentes e passadas. Se denominarmos o conjunto de entradas passadas de upassado e as entradas atuais e passadas de ypassado entao as predicoes podem ser reescritas como
y(k + 1)	—	f (ypassado, upassado,	Au(k))	(4.23)
y(k + 2)	—	f (ypassado,upassado,	Au(k), Au(k + 1))
y(k + p)	—	f (ypassado, Upassado,	Au(k), Au(k +1),..., Au(k +	m — 1))
Nota-se claramente que os unicos elementos com poder de variar as saídas futuras são os incrementos da açao de controle Au(k), Au(k+ 1), ••• , e Au(k + m — 1).
Definindo-se	
Y —	Conjunto de valores passados e presente de y.
U —	Conjunto de valores passados de u
u—	uo + ãu
uo —	u(k - 1)1	(
ãu —	DAu
Au	—	[ Au(k) Au(k + 1) ... Au(k + m — 1) ]T
onde, 1 é um vetor de dimensão m x 1 com todos elementos iguais a um e D e uma matriz triangular inferior m x m com todos elementos nao nulos iguais a um. As predicães podem ser escritas como
Y = f(Y, *—, u).	(4.25)
Utilizando o mesmo procedimento que na equação 4.17,
Y — f(Y, Y, uo) +
d Y du
ãu
u=uo
(4.26)
Usando as equaçães 4.24:
d Y
dY ?
——ãu
d Au
Au
(4.27)
Nomeando F = f (Y, u , uo) e Gpnmpc = ¿dYül	, onde F e
u lu=uo
o vetor de predicães que seria obtido para Au = 0 e GPNMPC e o gradiente das saídas preditas com relacão ao vetor dos incrementos de controle Au calculado para Au = 0, a seguinte representaccãao compacta e obtida
Y — F + GpnmpcAu.
(4.28)
GpNMpC e a matriz dinamica generalizada que pode ser utilizada para sistemas lineares e para sistemas não lineares contínuos e
diferenciáveis.
Gpnmpc —	" dyk + 1 d&amp;amp;ui dVk + 2	0 • dyk + 2 S&amp;amp;uk + 1	•	0 •	0	(4.29)
	d yk+p	d yk+p	d yk+p	
	_	dáuk	SAuk+1	dAuk + m-1	.	
A expressão 4.28 pode ser escrita para um sistema de uma entrada e uma saída como
' y(k + 1) '		f1(yi u')passado
y(k + 2)		f2(y u~)passado
_ y(k + p)		fp(yi u~)passado
(4.30)
- dy(k+1) dAu(k) dy(k+2) dAu(k)
0
dy(k+2) dAu(k + 1)
Au(k)
Au(k + 1)
0
0
0
0
dy(k+p)	dy(k+p)
- dAu(k)	dAu(k+1)
dy(k+p)
ôAu(k+m-1)
Au=0
Au(k + m — 1)
Nota-se neste caso a forma triangular inferior da matriz Jacobiano devido a causalidade do sistema, ou seja
dy(k +j) dAu(k + i)
= 0 para i &gt;j
(4.31)
A expressao 4.30 representa a equaçao 4.28 de forma mais detalhada onde
—	Y e o vetor p x 1 contendo as predições no horizonte de predicao p.
—	F á o vetor p x 1 contendo as saídas preditas supondo que as açoes de controle no horizonte de controle m sao mantidas iguais a açao de controle no instante k — 1, ou u(k) = u(k + 1) = ... = u(k + m — 1) = u(k — 1).
—	Gpnmpc á a versao nao linear da matriz dinâmica utilizada no Controle Preditivo DMC ou a versao generalizada válida para sistemas lineares ou nao lineares (p/ sistemas contínuos e diferenciaveis). Sua dimensao é p x m.
- Au e o vetor m x 1 contendo os incrementos nas açoes de controle no horizonte de controle m.
E importante observar que para um sistema linear causal invariante no tempo e sem acoplamento direto entrada saída, a matriz dinâmica utilizada no Controle Preditivo DMC ou GPC é igual aquela obtida com a matriz Gradiente definida na equação (4.30).
A matriz dinâamica do algoritmo DMC ou GPC e normalmente obtida com os elementos da resposta a um degrau unitario aplicado no instante k a um sistema com condições iniciais nulas. Ou seja
y(k + j)	=	0 para	j&lt;0
u(k + j)	=	1 para	j &gt; 0, ou
Au(k + j)	=	1 para	j=0
Au(k + j)	=	0 para	j=0
Seja uma predição yk+j •
yk+j = f (y(k + j - 1), ...,y(k + 1),u(k))	(4.32)
A derivada parcial d£+j é definida como
dyk+j   lim yk+j(uk-i + Auk) — yk+j(uk-1)	(4 33)
d Auk	Au^—0	Auk
Como ük+j e uma funcao linear de u(k) e portanto de u(k — 1) e Au(k), então yk+j(uk-1 + Auk) _ ük+j(uk-1) + ük+j(Auk) e a derivada pode ser reescrita como
_ lim ük+j(Auk)	(4.34)
d Auk	Au^—-o	Auk
lim f (x)	_	0
x——c
lim g(x)	_	0, então
x——c
l.m =	,	(4.35)
x -c g(x)	x " g (x)
se existente. Neste caso devido ao numerador e denominador serem funçães lineares de Au(k) isto equivale numericamente a se tomar o limite para Auk 1. Assim
dyk+j = yk+j (Auk = 1)	(4 36)
d Auk	1
A expressãao 4.36 representa a resposta do sistema no instante (k+j) ao degrau unitario no instante k que e por definição o valor do elemento G(j, 1) da matriz dinamica do algoritmo DMC.
Como para um sistema linear e invariante no tempo a resposta ao degrau unitario aplicado no instante k + j observado no instante k + j + 1 e igual à resposta do sistema a um degrau aplicado no instante k + j + 1 observado no instante k + j + 2, a matriz Gradiente para sistemas lineares tem seus elementos da primeira coluna repetidos nas diagonais. Isto e, para uma matriz G com p &gt; m, G(1,1) = G(2, 2) = ... = G(m, m), G(2,1) = G(3, 2) = ... = G( m +1, m), etc.
Outra maneira mais simples de demonstrar que a matriz Jaco-biano Gpnmpc equivale a matriz dinêmica G do algoritmo DMC ou GPC para sistemas lineares e utilizar a equaçao 4.37 apresentada no apêendice A.
Nesta equacçãao as prediçcãoes sãao calculadas atraves da convolucçãao entre as respostas ao degrau unit ario e os incrementos de entrada.
j	to
y(k +j/k) = ^2 giAu(k+j -i)+ ^2 giAu(k +j-i)+ n(k +j/k) i=1	i=j+1
k as predições se resumem em
y(k + j/k)	=	^2 g®Au(k + j - i) + õ(k + j/k),
i=1
ou
y(k + 1)	= gxAu(k)
y(k + 2)	= giAu(k + 1) + g2Au(k)
y(k + j) = giAu(k + j - 1) + g2Au(fe + j - 2)+----+ gjAu(k)
Fica evidente que dy(k + 1) =
dAu(k)	= g1’
dy(k + 2) =
dAu(k)	g2’
dy(k + 2)	=
d Au(k +1)	g1’
dy(k + j) dAu(k)
(4.38)
Seja o sistema dinêamico representado pela equaçcaõo a diferençcas
y(k) = ay(k — 1) + bu(k — 1)
(4.39)
Para este sistema pretende-se determinar a matriz G utilizada pelo algoritmo DMC e GPC e compará-la com a matriz obtida pelo mátodo generalizado proposto. Para isso avalia-se a resposta do sistema a um degrau unitário no instante k.
Um degrau unitario em k produz as seguintes entradas no horizonte de controle m, u(k) = 1, u(k + 1) = 1,u(k + m — 1) = 1 e Au(k) = 1, Au(k + 1) = 0,Au(k + m — 1) = 0. A prediçõo da resposta do sistema ao degrau unitaário no instante k para
condição inicial nula (y(k) = 0) e
y(k +1)	=	ay(k) + bu(k) = b	(4.40)
y(k + 2)	=	ay(k + 1) + bu(k +	1)	=	ab + b
y(k + 3)	=	ay(k + 2) + bu(k +	2)	=	a(ab +	b) + b = a2b + ab +	b
y(k + p)	=	ak+p-1b + ak+p-2b	+	... + ab +	b
Reescrevendo-se as predições de forma algébrica para k = k +1 até k = k + p e supondo m = p para simplificar, têm-se:
y(k + 1) =bu(k) = b(u(k — 1) + Au(k))	(4-41)
=bAu(k)
y(k + 2) =ay(k + 1) + bu(k + 1)
=abAu(k) + b(u(k) + Au(k + 1))
=abAu(k) + bAu(k) + bAu(k + 1)
=(ab + b)Au(k) + bAu(k + 1)
y(k + 3) =ay(k + 2) + bu(k + 2)
=a(ab + b)Au(k) + abAu(k + 1) + bAu(k)
+bAu(k + 1) + bAu(k + 2)
=(a2b + ab + b)Au(k) + (ab + b)Au(k + 1) + bAu(k + 2)
y(k + p) =(ap 1b + ap 2b + ... + ab + b)Au(k) + ... +(ab + b)Au(k + m — 2) + bAu(k + m — 1)
Utilizando-se a resposta ao degrau para a montagem da matriz G do Controle Preditivo DMC temos
gdmc =
b ab + b a2 b + ab + b
00 b0 ab + b	b
00
00
00
ap 1 b + ap 2b + ... + ab + b . ..	a2b + ab + b ab + b b
(4.42)
E evidente que utilizando-se a expressao do Gradiente dado pela equaçcãao (4.30) sobre as prediçcãoes apresentadas pela equaçcãao (4.41) conclui-se que Gpnmpc = Gdmc para o exemplo de sistema linear apresentado.
4.3.1	A obtenção de F e Gpnmpc
A tecnica de controle preditivo baseado em modelo pressupoãe a disponibilidade de um modelo matematico do processo. Neste trabalho estuda-se a aplicacçãao de controle preditivo a sistemas amostrados a uma taxa de amostragem Ts. Devido a grande variedade de estruturas para representaçcãao de processos como redes neurais, modelos NARMAX, equacães a diferenças não lineares, etc., torna-se pouco pratico propor uma soluçcãao de controle baseado em expressães matematicas para F e Gpnmpc• Preferiu-se a sua obtençcaão de forma numerica. Para isso pressupãoe-se simplesmente que pode-se obter um algoritmo que calcule o vetor com as p prediçães, Yp quando se fornece os valores das entradas e saídas passadas e o vetor com os m incrementos de entrada futura Au para o caso de um sistema com uma entrada e uma saída, por exemplo. A cada iteraçao executa-se o seguinte procedimento:
— Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e saídas passadas e com Au = [ 0 0	...	0 ]T.
F = YP.
— Calcula-se a primeira coluna da matriz Gpnmpc. Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e saídas passadas e com Au = [ e 0	...	0 ], onde e e um
valor muito pequeno, ^000 , por exemplo.
1 _vo
Gpnmpc(:&gt; 1) =	p.
— Calcula-se a segunda coluna da matriz Gpnmpc. Obtem-se o vetor p x 1 Yp executando o modelo com as entradas e saídas passadas e com Au = [ 0 e ...	0 ]. Gpnmpc(:, 2) =
v 2 _v 0
vp vp
e '
— Prossegue-se com o calculo das demais colunas da matriz
Gpnmpc ate a ultima coluna onde obtem-se o vetor YpJ1 executando o modelo com as entradas e saídas passadas e __________________________________________________v0 com Au =[0 0	... e ]. Gpnmpc(:, m) = p e p .
4.3.2	Obtenção da ação de controle
O vetor com as p prediçães, Yp í representado na forma
Yp = F + GpnmpcAu.	(4.43)
Cada elemento do vetor resposta livre F é calculado utilizando-se o modelo de prediçcaão e assumindo Au =	0 0	. . .	0 T e
recebe o acréscimo do valor de n(k) conforme mostra a figura 4.5. A obtencçãao da açcãao de controle íe realizada utilizando as tíecnicas jí conhecidas e descritas no apêndice A.
4.3.3	Exemplo 1
Alguns dos resultados apresentados nesta seçcaão foram tambíem apresentados em [73] e [49]. O modelo nao linear com uma entrada e uma saída mostrado na equaçcãao 4.44 íe apresentado em
[74]	onde íe controlado com uma tíecnica de controle MPC iterativa denominada NEPSAC. A figura 4.1 mostra o resultado da aplicacao de controle utilizando a técnica PNMPC. Foi aplicado um horizonte de prediçcaão igual a 3 e um horizonte de controle igual a 2. Com estes mesmos paraêmetros foi realizado o controle utilizando a tíecnica iterativa NEPSAC que adota a montagem da matriz G utilizando resposta ao degrau. Nota-se que para este modelo e para as referêencias utilizadas ambas as tíecnicas funcionaram bem com resultados muito semelhantes.
Para mostrar a diferencça entre os dois míetodos, alíem da necessidade de iteraçcoães no míetodo NEPSAC, muda-se a referêencia para um sinal senoidal com amplitude e frequêencia variantes no tempo.
y(k) = (l+y^-l^ + ^feU)2)	(4.44)
+0.3cos(.5(y(k — 1) + y(k — 2))) + 1.2u(k — 1)
Controle com PNMPC
Amostra
Figura 4.1: Resultados de seguimento de referência com PNMPC
Controle com NEPSAC
Amostra
Figura 4.2: Resultados de seguimento de referência com NEPSAC
para a maioria dos sistemas nao lineares. Como demonstrado na seçõo 4.3, os elementos da matriz dinamica G somente sao iguais a resposta ao degrau para sistemas lineares. Mesmo que o algoritmo NEPSAC utilize um processo iterativo para a determi-
nacão de Au, este procedimento baseia-se em uma representacao baseada na resposta ao degrau que nãao se justifica como uma representaçcãao de um sistema naão linear.
Figura 4.3: Resultados de seguimento de referência com PNMPC
Amostra
Controle com NEPSAC
Figura 4.4: Resultados de seguimento de referencia com NEPSAC
4.4	Erro de predição, ruído e perturbações
J&gt;
Os algoritmos de controle preditivo como DMC e GPC utilizam um mecanismo para corrigir as predicçõoes. A táecnica de Controle DMC corrige as prediçcõoes com o erro entre o valor medido da variáavel controlada e seu valor predito com o modelo no instante
k.	Esta tácnica aplicada a sistemas lineares garante erro nulo em regime já que o incremento do esforço de controle necessário para a correçcaõo do erro no instante k seráa o mesmo nos instantes futuros devido a relacao linear entre entrada e saída, isto á, o ganho áe constante. A aplicacçaõo deste mesmo procedimento para a tácnica PNMPC aplicada a sistemas nao lineares nõo garante erro nulo em regime jáa que o ganho varia com o ponto de operaçcõao do sistema. O mecanismo de correçcõao das prediçcoões adotado neste trabalho á uma versõo explicita daquele utilizado pelo algoritmo GPC. Soma-se a cada prediçõo a integral do erro de prediçõo filtrado.
A figura 4.5 mostra o diagrama de blocos da tácnica proposta para a correçcõao das prediçcõoes utilizando-se o algoritmo PNMPC. A cada instante de amostragem calcula-se o erro entre a saáda que o preditor calcula que a variável teria no instante k, y(k/k — 1) e a saáda real da variável no instante k. O valor de y(k/k — 1) é o primeiro elemento do vetor de prediçcõoes obtido no instante k — 1. Na discussao a seguir sera utilizado o operador atraso/avanco qj onde i e Z tal que q-1f (k) = f (k —1) e qf (k) = f (k+1) conforme
[75]. Define-se
ysc = valor predito da saáda sem correçao,
y = valor real da saáda,
n = valor da correçõo a ser somada a saáda sem correçõo, e = y — y erro entre a saáda real y e a saáda predita y, e = y — ysc erro entre a saáda real e a saáda sem correçõo.
Figura 4.5: Diagrama de Blocos para o tratamento de erro de modelagem e ruído
para isso utilizou-se o erro no instante de amostragem anterior e(k — 1) para obter a correção n(k).
O erro entre a saída do processo no instante atual e a saída do modelo é filtrado por um filtro passa-baixa F = D , integrado e somado à saída predita pelo modelo no instante seguinte. A técnica PNMPC supãe que a integral do erro filtrado é mantida constante durante as prediçães calculadas no instante k. Assumindo que A = 1 — q-1 tem-se
y(k) — y(k/k — 1) =e(k)	(4.45)
k
y(q) — (q-1 e(q)A F + y«c(q)) =e(q)
k
y(q) — ySc(q) =e(q)(1 + q-11—— F)
1 — q 1
F (” = D^
e(q)=(df cdA^/^—y-c(q))
Supondo que o sistema em malha fechada seja estével entao na vizinhança de um ponto de operação pode-se substituir o operador q por z e aplicar o Teorema do valor final.
e(z)
y(z) - ysc(z)
(D k) (y(z) - ysc(z)) suPondo (Df (z)A + z 1 ki)
S
1 - z-1
Df (z)A
-n	Df (z)A	S
= Z™1( z )(Df(z)A + z-1ki)1 - z-1
DF(z)(1 - z-1) S o
= lim	S = 0
z—&gt;1 (Df (z)A + z 1ki)
(4.46)
Pode-se perceber que a presenca de (1 - z-1) no numerador da equação (4.46) garante erro nulo em regime permanente para uma entrada degrau de valor finito de y(1) - ysc(1) igual a 1_Z_1. Além de garantir erro nulo em regime, o tratamento do erro de modelagem deve garantir que a dinâmica do erro apresente um tempo de resposta desejado. Esta característica depende dos polos de h(z) =	(fc) ou das raízes do denominador de h(z).
Definindo-se e(k) = y(k) - ysc(k) e considerando-se pequenas diferenças entre o modelo e o processo real pode-se função de transferância entre o erro de modelagem e pois da correçcãao como
escrever a o erro de-
h(z)
h(z)
e(z)
4z)
Df(z)(1 - z-1)
Df(z)(1 - z-1) + z-1ki
(4.47)
O tratamento do erro de modelagem depende assim da escolha do denominador do filtro F e do ganho integral k^. Um filtro candidato é
F (z) = f,	(4.48)
que fornece a seguinte função de transferência h(z),
h( ) =	z2 - (1 + fd)z + fd
z z2 - (1 + fd - ki)z + fd
(4.49)
Um projeto simples para k e fd consiste em comparar o polinomio denominador de h(z) com um polinâmio desejado pd(z). Supondo
um polinómio desejado de segunda ordem criticamente amortecido,
pd(z)	=	(z - «)2,
pd(z) = z2 - 2az + a2.	(4.50)
Comparando o polinómio denominador de h(z) da equaçao 4.49 com o polinómio desejado da equação 4.50, obtem-se as igualdades,
1 + fd	ki —	2a
fd	=	a2
(4.51)
O projeto do filtro do preditor consiste em escolher o valor de a e entaão determinar fd e ki.
fd	=	a2
ki	=	1 + a2 — 2a
(4.52)
A escolha de a tem um impacto na velocidade com que o erro responde à uma perturbacão. Quanto menor a mais rapidamente o erro tende a zero para uma perturbacão do tipo degrau. Entretanto ha de se considerar o nível de ruído na escolha de a como sera discutido na sequencia. O fator de correção n(k), calculado no instante de amostragem k para ser utilizado na prediçcãao k + 1 ate k + p e obtido como
n(z X) =
1 1
1 - fdz-1 1 - z-1
e(z x), ou
n(k) = n(k - 1)(1 + fd) - fdn(k - 2) + e(k)ki
(4.53)
O tratamento do erro de predicão utiliza um filtro e um integrador. O ganho do filtro é unitario somente para a — 0, quando fd — 0 e ki — 1.
4.4.1	Exemplo 2
A fim de avaliar o desempenho da estrategia proposta para o tratamento de ruídos e erros de modelagem aplica-se a tecnica proposta para o exemplo 1 apresentado na subsecão 4.3.3. Inicialmente avalia-se a resposta do controle PNMPC a entrada de um
sinal degrau na saída do processo para um sistema sem ruído na medicao. A figura 4.6 apresenta a resposta obtida com a aplicação
Figura 4.6: Resposta à perturbaçao na saída
do algoritmo PNMPC utilizando-se os seguintes parêmetros:
—	horizonte de prediçao igual a 3
—	horizonte de controle igual a 3
—	ponderacão no esforço de controle, A = 0.01
—	fator a = 0
De acordo com a equacão 4.52 a escolha de a = 0 equivale a
fd = a2 =0, e
ki =	1 + a2 — 2a = 1.	(4.54)
Ou seja, a utilização de a = 0 significa integrar o erro, ki = 1, sem a aplicacao de nenhum filtro, fd = 0. Observa-se que o efeito da perturbaçcaão na saída aparece em um instante de amostragem e íe eliminado no instante seguinte. Este seria um ajuste ideal na ausêencia de ruído. A figura 4.7 apresenta a resposta do sistema sendo controlado com o algoritmo PNMPC utilizando os mesmos ajustes mas com a adicçaão de ruído branco na saída alíem da per-turbaçcãao degrau. A figura 4.7-a mostra a perturbaçcãao degrau e o
Figura 4.7: Resposta ' perturbação na saída com ruído e a = 0
ruído que foi somado a saída do sistema. Nota-se que o sinal de saída apresenta um nível de ruído um pouco maior do que o ruído acrescentado, muito provavelmente pela também notável variação no sinal de controle u como mostra a figura 4.7-b. Este ruído na ação de controle í indesejível pois prejudica o elemento final de controle como uma vílvula de controle, por exemplo. Neste caso pode-se escolher um valor de a maior do que zero e obter assim uma filtragem sobre o ruído. O aspecto negativo disso í que a perturbaçcãao naão seraí eliminada tãao rapidamente como quando a = 0. A figura 4.8 mostra a resposta obtida com a = 0.7. Notase claramente que o sinal de controle apresenta-se bastante menos ruidoso e que o ruído na saída í semelhante ao ruído acrescentado (não houve multiplicacao significativa de ruído). De forma geral a conclusão í que com a escolha de um sí parâmetro, a, pode-se obter uma resposta mais ou menos rípida as perturbações. Para variíaveis do processo com presençca de ruído existe um compromisso entre a rapidez na resposta ' perturbação e a contaminação de ruído na ação de controle.
(a)
(b)
Figura 4.8: Resposta à perturbaçao na saída com ruído e a = 0.7
4.5	Aplicação em processos multivar-iãveis
Apesar da apresentaçcãao da tecnica PNMPC ter sido realizada para sistemas de uma entrada e uma saída, não ha nenhuma res-triçcãao na aplicaçcaão da tecnica para sistemas com multiplas entradas e multiplas saídas (Sistemas MIMO). Em realidade não h a praticamente nenhuma diferençca ja que havendo mais de uma entrada e mais de uma saída basta montar os vetores de predição e incrementos de açcaão de controle aumentados. Assim, para um sistema de ne entradas e ns saídas teríamos os seguintes vetores,
Yp	=	[	Yp!	Yp2	...	Ypns	]T
Au	=	[	Au!	Au2	...	Aune	]T	(4.55)
A obtençao de F e Gpnmpc acontece da mesma forma como descrito para o caso de uma entrada e uma saída. A diferença e que agora a matriz Gpnmpc tem mne colunas que serao obtidas calculando-se a derivada parcial de forma numerica calculando-se o vetor de prediçao Yp com Au = 0 e o vetor de predicao obtido ao utilizar-se Au = 0 acrescido de e em cada um dos elementos de Au. Assim, para um sistema com 3 entradas e com horizonte de controle igual a 2 teriamos Gpnmpc com 6 colunas. A coluna 5, por exemplo, seria obtida como
Y^___y0
GPNMPC(Í 5)	=	(4.56)
e
Yp	=	Yp(Au = [ 0	0	0	0	0	0	]T)
Yp	=	Yp(Au = [ 0	0	0	0	e	0	]T)
4.5.1	Exemplo 3 - PNMPC aplicado no controle de uma Planta com 6 Tanques Esfericos
A figura 4.9 mostra um sistema desenvolvido na UFRGS e citado em [76]. A partir de um reservatório bombeia-se agua com uma unica bomba para seis tanques atraves de dois ramos diferentes com vazãoes controladas por abertura de valvulas. O modelo
dinêamico do sistema e descrito pelas seguintes equacçoães:
. dhi ■	= xiFi - R^/~h[	(4.57)
dh2 A 2 —;— dt	= R^/hi - R^y/hz	
, dh3 dt	= (1 - x2)F2 + R2 V	Zh2 - R3\/h3
. dh4	= x2F2 - R^/h4	
, dh5 A*~ddt	= R^y/hi — R^y/hs	
dh6 ■	=	(1 - xi)Fi + R5V	h5	R6y/ h6
onde
-	Ai, (i = 1 : 6), e a area da secao de cada tanque em funçao do nível de fluido no mesmo (hi) e do diametro para o nível (Di).
-	Ri, (i = 1 : 6), e a resistência a passagem do fluido pelo orifício no fundo de cada esfera.
-	hi, (i = 1:6), e o n ível do fluido em cada um dos seis tanques esfericos.
-	xi é fracao da vazao de fluido Fi que flui para o tanque 1.
-	hi, (i = 1:6), e o nível do fluido em cada um dos seis tanques esfericos.
-	x2 e fracao da vazao de fluido F2 que flui para o tanque 4.
Nas equacoes 4.57
Aj = n(Djhi - h2)	(4.58)
Ri	ai\/2g
As equacçãoes 4.57 sãao discretizadas utilizando-se a aproximaçcãao de Euler com um Tempo de amostragem de 3 segundos. O processo multivariavel é representado pelas saídas h3 e h6 e as entradas F1
e F2.
Planta com seis tanques esféricos
Figura 4.9: Planta com 6 Tanques Esféricos

H3		■ F3 ■	+	G11	G12 ■		■ AF1 ■
h6		. Fe .		, G21	g22		af2
O objetivo de controle é levar os níveis h3 e h6 para valores desejados. As saídas h3 e h6 apresentam dinamicas répidas ou lentas dependendo dos pontos de operação. Isto demanda um horizonte de predicão muito longo devido a necessidade de se utilizar um tempo de amostragem pequeno. Para evitar trabalhar-se com matrizes de dimensoães muito elevadas adota-se a tíecnica de se utilizar uma prediçao a cada N instantes de amostragem futuro. Este procedimento é uma generalização da proposta apresentada em [77] que sugere a utilização de pontos de coincidência da trajetória de referência no lugar da utilização de todos os pontos. Este esquema é de fócil implementacão com a técnica PNMPC proposta. Utilizou-se um horizonte de controle de 3 para cada entrada e um numero de predicão de 210 para cada saída. Este
horizonte de predicão foi reduzido para 31, (210/7 +1), tomandose a primeira predição e depois uma a cada 7. Desta forma o vetor F tem dimensão 62 x 1 e a matriz Gpnmpc tem dimensão 62 x 6. O horizonte de prediçcãao ainda leva em conta a necessidade de se cobrir a dinâmica das saídas por um tempo suficiente maior que o tempo em que as saídas apresentam resposta inversa devido o comportamento de fase nãao-mínima. O processo Seis Tanques Esfericos apresenta um comportamento entrada-saída não linear, comportamento de fase não-mínima e um pequeno atraso de transporte. As saídas são representadas em [cm] e as entradas em [cm3/min]. Isto faz com que os valores dos sinais de entrada sejam muito maiores que os das saídas. As matrizes de ponderação R e Q são inicialmente normalizadas levando em consideraçcãao os valores míaximos de ambas as grandezas. Alíem disso faz-se um estimativa dos tempos de atraso e da duracçãao do efeito de fase naão-mínima predominante para diminuir os valores correspondentes na matriz de ponderaçcãao R. Este procedimento tem o efeito de priorizar a dinâamica de fase mínima das saídas e acredita-se que melhora a estabilidade numíerica do algoritmo. O algoritmo PNMPC opera com os estados do sistema. Assim se fez necessíario utilizar as medicçoães de todos os 6 estados do sistema apesar do controle ser realizado apenas sobre as saídas correspondentes aos estados h3 e h6. As medicães de todos os estados são relevantes para a aplicaçcãao do algoritmo de tratamento de erro de predicão já que os estados h3 e h6 dependem dos demais estados.
A figura 4.10 mostra o resultado de alguns testes de simulaçcãao do sistema em malha aberta. As figuras 4.11, 4.13 e 4.12 mostram os resultados obtidos com a aplicação da tícnica PNMPC para uma síerie de mudançcas de referâencia propostas em [76]. Deve-se mencionar que na simulacçãao supoãe-se que as referâencias futuras nãao sãao conhecidas mas sãao consideradas como iguais a referâencia atual.
Na figura 4.11 tâm-se o comportamento das saídas h3 e h6 em comparaçcãao com as referâencias estabelecidas. A figura 4.13 mostra o comportamento dos níveis hj, h2, h4 e h5. Diferentemente das referâencias propostas em [76] para o controle do mesmo processo, preferiu-se utilizar referâencias que exijam mais desempenho do sistema de controle.
No tempo igual a 25 minutos requer-se que o nível 3 suba enquanto o nível 6 diminua, por exemplo. No tempo igual a 60
0	2	4	6	8	10 12 14 16 18 20
Tempo [ min ]
0	2	4	6	8	10 12 14 16 18 20
Tempo [ min ]
Figura 4.10: Respostas em Malha Aberta
minutos muda-se a referêencia do nível 6 e pode-se perceber a per-turbaçcaão causada no nível 3.
(a)
(b)
Figura 4.11: Respostas de h3 e h6 em Malha Fechada
(b)
Figura 4.12: Ação de Controle em Malha Fechada
Observa-se que a técnica PNMPC proposta permite um ótimo seguimento de referência com exceção do comportamento de fase não mínima que mantém-se em malha fechada como esperado.
Para avaliar a capacidade do algoritmo PNMPC em representar as predicães utilizando-se a expressao Y = F + Gpnmpc^u compara-se as prediçcoães obtidas com esta expressãao com as predi-çoes obtidas diretamente do modelo não linear. A comparacão foi realizada no instante de amostragem 801 que corresponde ao tempo t = 40.05 min.
Figura 4.13: Respostas de hl, h2, h4 e h5 em Malha Fechada
4.6	PNMPC com Gradiente Ponderado
A tecnica PNMPC proposta utiliza a matriz G igual ao gradiente ddYu calculada para Au = 0. O gradiente é obtido a cada instante de amostragem atraves de um procedimento numerico como descrito na seção 4.3. Dependendo do grau da não linearidade do sistema pode ser interessante obter uma nova matriz G somente a cada N instantes de amostragem ou, ao contrario, pode ser desejavel melhorar o modelo de predicão. Sistemas altamente não lineares e com comportamento de resposta inversa exigem bons modelos de prediçcãao principalmente quando se deseja um desempenho rapido do sistema sendo controlado.
Nesta seçcãao apresenta-se um procedimento que visa melhorar o modelo de prediçcaão. Como ja mencionado a matriz gradiente G e calculada a cada instante de amostragem para Au = 0. Entretanto, devido a nãao linearidade do modelo e processo, o gradiente varia em funçao do incremento de controle aplicado. Um procedimento que visa melhorar o calculo do gradiente consiste em calcula-lo em dois passos:
Passo 1: Calcula-se o gradiente Gi como ja descrito na secão 4.3 utilizando-se Au = 0 .
Passo 2: Utilizando o gradiente Gi calcula-se o incremento da açcaão de controle intermediario Au¡ e com ele o gradiente G2. O gradiente que sera utilizado para o calculo da acao de controle definitiva é G = 0.5G1 + 0.5G2
Uma interpretacão grafica do procedimento é mostrada na figura 4.15 para o caso de uma função y = f (x). Pode-se observar na figura 4.15 que o primeiro valor de Ax = Ax® é diferente do valor que seria necessario para que a funçcãao atingisse o valor desejado yd = y(x + Ax). Utilizando-se o valor de Ax® obtido com o primeiro gradiente calculado em x, calcula-se o gradiente intermediario dyU+Aa: . Em seguida calcula-se o gradiente ponderado que e a media entre o gradiente em y(x) e em y(x+Ax®). A utiliza-cão do gradiente ponderado ira fornecer um valor de Ax = Axp que e muito mais proximo do valor correto para que a funçcaão atinja yd = y(x + Ax). Este procedimento é uma tentativa de atingir uma aproximacão de Taylor de segunda ordem, onde
y(x + Ax) a f (x) + ílíx^Ax + 1 fpA»’	(4.60)
Figura 4.15: Interpretação gráfica do gradiente ponderado
Obtendo-se
Ax1 =	X ), pode-se calcular	(4.61)
dx
df (x + Ax®)	.	„
e fazer a seguinte aproximaçao
df(x+Ax^) _ df(x)
dx_________dx
Axi
dx
d2f(x)
dx2
Assim, a Eq. (4.60) pode ser reescrita como
,	. .	...	df (x)	1
y(x + Ax) = f(x) + dx Ax +2
~ df (xfAx*) _ df (x) ~ dx ___________dx
Ax®
Ax2.
(4.62) Pode-se dizer que Ax1 = Ax(1 _5), onde 5 e um valor que depende da curvatura da função, sendo positivo para função concava e
negativa para funçao convexa. Introduzindo esta relaçao na Eq.
(4.62), tem-se
y(x+Ax) = f (x)+ (1
1	) df (x)	1	df (x + Ax®)
2(1 _ ã)) dx + 2(1 _ ã) dx
(4.63)'
Ax.
O célculo de ô iria necessitar da avaliacão da derivada segunda de f (x) que deseja-se evitar. Assim o melhor compromisso é considerar ô = 0 e
y(x + Ax) = f (x) +
df (x)
0.5 -fT-Z+ 0.5	„
x	ox
df (x + Ax®)	.
v	7 Ax.
(4.64)
O resultado do caso escalar pode ser estendido para a Matriz Gradiente Ponderada.
O procedimento descrito acima requer duas avaliações da Matriz Gradiente. A fim de se diminuir a carga computacional do algoritmo propõe-se uma versõo de Matriz Gradiente Ponderada simplificada onde o cálculo do incremento da açõo de controle intermediario Au¡ á realizado utilizando-se a matriz G obtida no instante de amostragem anterior.
A figura 4.16 mostra a comparacçõao entre a prediçcõao calculada com o modelo nõao linear e com o modelo linearizado utilizando a Matriz Gradiente Ponderada para o instante de tempo igual a t = 40.05 min. Comparando a resposta obtida com a versao linearizada que utiliza a Matriz Gradiente calculada para Au = 0 apresentada na figura 4.14, percebe-se uma melhora muito significativa. A figura 4.17 mostra o resultado obtido utilizando-se a Matriz Gradiente Ponderada Simplificada. O resultado á muito similar ao obtido com a Matriz Gradiente que utiliza dois caálculos de Gradiente a cada instante de amostragem.
Figura 4.16: Comparação entre predição com modelo não linear e modelo linearizado com Gradiente Ponderado
Figura 4.17: Comparaçao entre prediçao com modelo nao linear e modelo linearizado com Gradiente Ponderado Simplificado
4.6.1	Exemplo 4 - PNMPC aplicado no controle da reação Van Der Vussen
O Controle da Reação Van Der Vussen é um problema benchmark para o desenvolvimento de algoritmos de controle de processos nao lineares como pode ser visto em [78], [79], [80], [81], [82]. A reaçao Van Der Vussen e um processo contínuo que acontece em um reator do tipo tanque agitado isotermico. A reaçao consiste do seguinte esquema
A —&gt;kl B —&gt;k2 C	(4.65)
2A —&gt;k3 D
A e o produto que entra no reator, B é o produto desejado e C e D sao subprodutos indesejados. Utiliza-se neste exemplo o modelo do processo apresentado em [82]:
Ca	kaca k3Ca V (cAin ca)u
cb	kica k2Cb	cbu.
y = cb	(4.66)
Neste modelo
—	ca é a concentraçao do produto A.
—	y = cb é a concentracao do componente B e a variavel controlada.
—	u = Fr1 é o inverso do tempo de residencia e a variavel manipulada sendo Fent a vazao de entrada e VR o volume do tanque.
—	ki = k2 = 15.0345 sao constantes de reacao dadas pela equacçao de Arrhenius.
—	k3 = 2.324 é outra constante de reaçao.
—	CAin = 5.1 é a concentracao de entrada de A.
		J.P1			
		r			
					
		i			
		1			
		!			
					
		!			
					
					
0	5	10	15	20	25	30	35
u [ s-1]
Figura 4.18: Relação entre cB e u em Regime Permanente (Curva de equilíbrios do sistema)
Os estados estacionarios ou equilíbrios do sistema sao obtidos fazendo-se ca = cb = 0. A figura 4.18 mostra a curva de equilíbrios do sistema. Nota-se que existe um ponto Pi onde ocorre o valor maximo de saída. Além disso este processo apresenta um comportamento de fase nao-mínima para operações a esquerda do ponto Pi. A figura 4.19 mostra o comportamento da concentraçao do produto B (cB) em malha aberta quando submetido a degraus na entrada. A figura 4.19-a mostra a resposta para um degrau positivo enquanto que a figura 4.19-b mostra o comportamento da saída para um degrau negativo. As entradas correspondem a valores na regiao do lado esquerdo de Pi da figura 4.18. Nota-se claramente o comportamento do tipo resposta inversa ou fase naõo mínima em ambos os casos.
O modelo contínuo representado pela equacõo (4.66) foi discretizado com um tempo de amostragem de 18 segundos (0.005 horas) utilizando-se uma aproximacao de Euler (c =	).
u [ s-1 ]	Concentraçao B
Tempo [ min ]
Tempo [ min ]
Figura 4.19: Respostas em malha aberta
Ca(k) _ ca(k — 1) — Tski ca(k — 1) — Tsk3ca(k — l)2
+Ts(cae — Ca(k — 1))u(k — 1)
cb(k) _ cb(k — 1) + Tskica(k — 1) — Tsk2cb(k — 1) —Tscb(k — 1)u(k — 1)
ü(k) _ cb(k)	(4.67)
A variavel que se deseja controlar é cb. Entretanto, apesar de nao se controlar a variavel ca, supoe-se que dispoe-se de sua medicao. Para a aplicaçao da tecnica PNMPC se faz necessario manter o modelo nao linear de ca corrigido em funcão das medições. Para isso, a cada iteracçaão, o algoritmo determina o erro entre o valor das variaveis ca e cb medidas e os valores obtidos utilizando-se a representaçcãao linearizada com a tecnica do gradiente ponderado. Com este procedimento garante-se erro nulo em regime permanente na presençca de erros de modelagem e perturbaçcãoes utilizando a tecnica discutida na secçaão 4.4. Para os resultados de simulacão que serao apresentados na sequência foram utilizados os seguintes parâmetros de sintonia do controlador PNMPC:
—	Horizonte de predicio igual a 30
—	Horizonte de controle igual a 3
—	Ponderaçao no esforço de controle com A = 0.0025
—	Parâmetro controle do erro de modelagem a = 0
Não se aplicou nenhum filtro nas mudancas de referencia. Para instantes de tempo maiores que 90 minutos aplicou-se uma mudança nos parâmetros da planta simulada.
k1 = k2 = 1.1k1-nom.
k3 = 0.9k3-nom.	(4.68)
Utilizou-se o algoritmo de programacçãao quadr atica para obtençcaão das açcoães de controle. As restriçcoães utilizadas foram relativamente brandas nesta simulaçcãao:
umax.
umin.
umax.
Au
min.
35
0
20
0
(4.69)
As figuras 4.20 e 4.21 mostram o resultado da aplicacão da tecnica PNMPC no controle de cB aplicando-se mudanças de referência para valores na faixa ' esquerda de P1 da figura 4.18.
A figura 4.20-a mostra que o algoritmo PNMPC consegue efetuar um bom seguimento de referência. Alem disso reage bem ' variação no modelo da planta em relação ao modelo utilizado para predição ao levar a saída para a referência desejada em um tempo pequeno e com um desvio maximo razoavel. A figura 4.20b mostra a açcaão de controle e o incremento da acçãao de controle e a forma como reagem ' variação dos parâmetros da planta para t &gt; 90 min..
-----erro ca
Tempo [ min.]
Figura 4.20: Controle de cb com PNMPC
erro c
Figura 4.21: Controle de cb com PNMPC-Controle de erros
Figura 4.22: Comparação entre Predição com o modelo e com PNMPC
O desempenho do algoritmo PNMPC depende fundamentalmente de sua capacidade de representar as predições de forma linear utilizando a técnica do gradiente ponderado. Observando a figura 4.21-b pode-se perceber que o erro de modelagem a cada instante de amostragem é mantido em valores baixos mesmo nos momentos de mudança de referencia. Entretanto uma amostra das predições ao longo do horizonte de predição p mostra que no momento da mudança de referência, mesmo para modelos de predicão iguais ao da planta, acontece a maior diferença. Essa diferençca ée méaxima no momento da mudancça de referêencia e diminui rapidamente nos instantes de amostragem seguintes como mostra a figura 4.22. No instante t = 39, 9 min. hé uma mudança significativa na referência e na acão de controle resultando em uma diferencça grande na prediçcãao feita com o modelo nãao linear e o modelo linearizado enquanto que nos dois instantes de amostragem seguintes, t = 40, 2 min. e t = 40, 5 min. a diferença diminui significativamente. Sao nos instantes de mudanca de re-ferêencia ou entrada de perturbaçcãoes que ée importante dispor de uma boa téecnica para obter as prediçcãoes.
Uma das dificuldades esperadas de um controlador baseado em um modelo linear seria a operacão do processo no ponto Pi da relaçao cb x u em regime permanente apresentada na figura 4.18 já que neste ponto o ganho do modelo linear seria zero. Em [82] propãe-se um algoritmo MPC nao linear iterativo para o controle deste processo para uma sequência de referências visando mostrar a capacidade da táecnica proposta em controlar o processo ao redor do ponto Pi. A figura 4.23 mostra os resultados obtidos com
Figura 4.23: Teste de Seguimento de Referencia em torno de Pi
a aplicação da tácnica PNMPC para a sequência de referencias sugeridas em [82]. Utilizou-se um horizonte de prediçao igual a 30, horizonte de controle igual a 3, ponderação do esforço de controle, A = 0,01 e o parâmetro de controle de erro a = 0 . Para evitar a influência do comportamento tipo resposta inversa ou fase nao mánima optou-se por fazer os primeiros 10 elementos da matriz de ponderacçãao do seguimento de referêencia igual a zero. Notase que a tácnica PNMPC leva o sistema às referências desejadas exceto para o valor 1,11 que não pertence ao conjunto de pontos realizáveis da relação em regime permanente cb x u. Nota-se entretanto que o sistema leva cb ao valor mais proximo possível, cb = 1, 09. Um ponto interessante a ser observado á que ha dois valores de entrada u que levam o sistema atá cb = 1,0 como pode ser visto na relaçao de regime permanente cb x u.
Como a funcçãao custo cresce com o quadrado da diferençca entre referência e resposta e a trajetória ate cb igual a 1,0 pelo lado direito de cb x u apresenta comportamento de fase nao mínima o sistema de controle chegou a cb = 1, 0 pelo lado direito que apresenta comportamento de fase ménima e menor custo.
Uma forma de forçar o sistema a permanecer no lado esquerdo da relaçao em regime permanente cb x u é modificar a funcao objetivo para introduzir um termo que penaliza afastamentos do valor de regime permanente da entrada conforme proposto em [83]. Para isso calcula-se o valor de regime permanente para cada valor da referência uss(yref(k)) e escreve-se a seguinte funcão custo:
J
= (Yp - W)T R (Yp - W) + AuTQiAu
+ (U - USS)T Q2 (U - Uss), onde
U = uk-i [ 1	1	1 ]T +
1
1
1
0 0
1 0
11
Au
Uss = uss(yref (k)) [ 1	1	1 ]T .	(4.70)
Os parâmetros utilizados no ajuste do algoritmo foram
—	horizonte de predkao p = 30;
—	horizonte de controle m = 3;
Q1 = 0-01!mxm;
Q2 = 0-001!mxm;
—	parâmetro para o controle de erro de modelagem a = 0
Devido a presenca de comportamento de resposta inversa os primeiros
10	elementos da matriz de ponderacão de seguimento de referância R foram zerados. Os resultados da aplicacao do controle PNMPC são apresentados na figura 4.24. Pode-se perceber pela ação de controle e pelo comportamento de resposta inversa que a variável cb vai de 1.09 atá 1.0 com valores de entrada pertencente ao lado esquerdo de Pi na figura 4.18.
(a)
(b)
Figura 4.24: Teste de Seguimento de Referência em torno de Pi para Uss &amp;lt;15
4.7	Estabilidade
Na seção 4.4 discutiu-se uma técnica para manter nulo o erro de modelagem em regime permanente e garantir uma dinêamica tãao répida quanto possível para sua trajetéria ate zero. Entretanto, sabe-se que alguns erros de modelagem podem desestabilizar o sistema sob controle. Especialmente aqueles erros de sincroniza-çcãao temporal entre o comportamento da planta e o do modelo. Neste sentido erros no atraso de transporte podem ter um impacto grande na estabilidade do sistema. Uma das alternativas para conviver com este problema ée penalizar os incrementos de controle na funcçãao objetivo obtendo assim uma resposta lenta em malha fechada mas garantindo a estabilidade do sistema. Para sistemas lineares uma soluçcãao que funcione para um valor de referência vai funcionar para todas as outras. Ja para sistemas não lineares a situacçãao ée diferente. Esta secçãao apresenta uma téecnica para garantir que a açcaão de controle obtida a cada instante de amostragem com o algoritmo de controle PNMPC mantenha o sistema estével. Parte deste trabalho foi apresentado em [84].
4.7.1	Desenvolvendo uma condição suficiente para estabilidade
A proposta esta baseada nas ideias de Lyapunov sobre funçães do tipo energia decrescente no tempo. [85]. Considere a seguinte funçcãao de Lyapunov
V	=	ãT Pe, onde
e	=	Yp - W e
Yp = F + GAu.	(4.71)
a cada instante de amostragem garantir-se que
dV
o sistema será estável. Deve-se observar que
V(0) = 0 e
V &gt; 0 para e = 0.	(4.73)
O desafio á desenvolver uma expressao para djt e assegurar-se que seu valor continue negativo a cada instante de amostragem com um custo computacional mínimo. Para isso desenvolve-se a expressãao para V na equaçcãao 4.71. Observa-se que V depende de F, W e Au,
V = f (F, W, Au),
dV dV dF + dV d W + dV d Au ~dt = dF ~dt + dW ~dt~ + dÃü dt
Desenvolvendo a equaçao 4.71,
dV
dF
dV
dW
dV dAu
At
(At P + AuT Gt P),
-(At P + AuT Gt P),
(AtPG + AuTGtPG), onde (4.75)
Ft - WT.	(4.76)
As derivadas parciais , FW e ^77^ são obtidas utilizando uma matriz Toeplitz [83] modificada, equivalente ao operador derivada discreta A = 1 — z-1,
dF
~dt
dW
~dt dAu ~dT
TpF,
TpW,
TmAu.
(4.77)
Ao calcular as derivadas a divisão por Ts, o tempo de amostragem, áe omitida uma vez que o resultado continua proporcional. Para
o caso de um sistema com uma entrada e uma saída (Sistema SISO-Single Input Single Output), por exemplo, Tp e Tm sao respectivamente matrizes p x p e m x m, com p e m sendo os horizontes de predicçãao e de controle respectivamente.
	■ —1 0	1 —1	0	••• 1	•••	0 0	
T= T m,p —	0	0	• • • —1	1	(4.78)
	0	0	••• 0	—1	
A utilizaçcõao dessas matrizes limitam a aplicaçcaõo da tecnica para m &gt; 1. A matriz Toeplitz T pode ser utilizada para calcular a derivada do vector V como TV. Em sua forma original a primeira linha de T é [ 1	0	0	••• 0 ], o que e equivalente a assumir
que o elemento que precede V(1) e zero. Para esta aplicaçao o oposto e valido. Isto e, a matriz Toeplitz sera aplicada ao vetor com a diferença entre a resposta livre e a referencia, A = F — W e ao vetor incremento de controle Au. Neste caso e mais natural assumir que Aum+i = 0 e que (F — W)p+i = 0. Ou seja, em MPC assume-se que o incremento de controle depois do horizonte de controle e zero e, na maioria das vezes, que no instante seguinte ao horizonte de prediçcõao atingiu-se o valor de referâencia. Isto justifica a utilizacçõao da matriz Toeplitz modificada.
Combinando as equações 4.74, 4.77 e 4.78, chega-se a equaçõo
= AT Tj PA +(At Tj PG + At PGTm)Au
+AuTGtPGTmAu &amp;lt;0	(4.79)
4.7.2	Introduzindo a condição para estabilidade na formulação MPC com PQ
centar a expressao dV &amp;lt;0 dada pela equacao 4.79 na funcao objetivo a ser minimizada. A minimizaçc ao da funcç ao custo contendo esta expressao pode tornar dg” negativa mas isto nao garante que seréa sempre negativa. Para isso se faz necesséario acrescentar uma restricao na formulacao PQ.
A introduçao da restricao dg" &amp;lt;0 na formulaçao QP apresenta uma dificuldade. A expressao 4.79 tem um elemento quadrético em Au e a maioria dos algoritmos de PQ nao admitem restricçoes nao lineares. Uma solucçao exata requer a utilizaçcao de algoritmos de programaçcao nao linear mas uma soluçcao aproximada pode ser obtida montando-se uma expressao para um dos vetores Au da expressao 4.79. Isto é feito utilizando-se a cauda (tail) do vector Au calculado no instante de amostragem anterior, k — 1, com seus elementos deslocados uma posicçao para cima e acrescentando um zero no ultimo elemento como mostra a equaçao 4.80 para um sistema SISO,
Autail = [AuJ-^ü] .	(4.80)
Com esta aproximaçao a nova formulacao do problema de Pro-gramaçao Quadrática pode ser escrita como
Au = arg min J
s. t.
MAu &amp;lt;N, onde
J = ^AuT $Au + ©T Au com
$ = Gt RG + Q +
$1 = GT PGTm
0 = Gt RA + ©T
©T = AT T PG + At PGTm
(4.81)
Na equaçao 4.81 a expressao MAu &amp;lt;N agrupa todas as restricoes e será explicada na sequência.
por exemplo.
N2 &amp;lt;MAu &amp;lt;Ni ou
MAu &amp;lt;N1
—MAu &amp;lt;—N2 com
N1 = —At Tj PA
N2 = At Tj PA + £
M = At Tj PG + At PGTm +
AuT	gT PGT
Auaprox.G PGTm
(4.82)
A equacão 4.82 é a restrição que assegura que
(4.83)
Hé dois parâmetros importantes a serem sintonizados, P e £, embora nas aplicacães feitas ate agora uma boa escolha para P parece evitar que dt atinja o limite —£. Aparentemente, para as apli-caçães feitas, um valor muito negativo para —£ afeta o seguimento de referâencia de forma que naturalmente um compromisso ée estabelecido e a restricçaão nãao foi alcancçada.
O fato de haver trâs matrizes, R, Q e P para serem sintonizadas oferece mais flexibilidade mas aumenta a complexidade da sintonia. Alguns experimentos mostraram que em caso de forte erros de modelagem obteve-se bons resultados diminuindo os primeiros elementos de R embora seja difícil estabelecer uma regra geral.
4.7.3	Aplicação da técnica
A fim de verificar o desempenho obtido com a tíecnica proposta e suas limitações, aplica-se a mesma a alguns problemas citados na literatura.
Exemplo 5
Retomamos o processo utilizado no exemplo 2 na subseçcãao 4.3.3.
y(k) =
2.5y(k _ 1)y(k _ 2) (1+ y(k _ 1)2 + y(k _ 2)2)
+ y(k _ 2))) + 1.2u(k _ 1 _ d)
+ 0.3cos(.5(y(k _ 1)
(4.84)
A planta sera simulada com o modelo mostrado na equação (4.84) incluindo um atraso de transporte d enquanto que no modelo utilizado para obter as predicães considera-se d = 0. A fim de comparar o desempenho do sistema de controle PNMPC utilizando a tecnica de introduçcaão de robustez proposta apresenta-se inicialmente o resultado obtido quando se aplica o procedimento convencional de aumentar a ponderaçcãao do esforcço de controle aumentado o valor dos elementos da diagonal da matriz Q. Na sequêencia apresenta-se o resultado com a tecnica proposta.
Os seguintes parêametros foram utilizados nas simulacçãoes:
—	p=10
—	m=3
—	Peso na ponderacçaão do esforcço de controle utilizando a solucçaão convencional: Q = 60I(m, m)
—	Peso na ponderacao do esforço de controle utilizando a solucao robusta proposta:0.0
—	Peso na ponderaçao da robustez: P = 0.03I(p,p)
—	Limite inferior de dt: £ = _0.01
Alem disso, aplicou-se uma perturbação na saída igual a 0.25 no instante de amostragem igual a 275 com duraçcãao de 4 amostras.
A coluna esquerda da figura 4.25 mostra o resultado da aplicaçcãao da tecnica PNMPC utilizando a ponderaçcãao no esforcço de controle para um erro de atraso de transporte entre modelo e planta igual a 5. A coluna da direita da mesma figura mostra o resultado com a aplicaçcaão da tecnica robusta proposta para o mesmo caso. Neste caso nãao se utilizou nenhuma ponderaçcaão no esforçco de controle para deixar evidente o efeito da tecnica. Nota-se que o resultado obtido com ambas as tecnicas e muito similar. O resultado com a tecnica robusta apresenta um sobressinal maior do que no caso convencional mas parece reagir melhor a perturbaçcãao.
Amostra
(b1)
4i	 7							
&gt;J	| I							
á 1 1 ...!							
						—	y -	- ref.	
					-		
0	50	100 150 200 250 300 350							
Amostra
(a2)
(b2)
Figura 4.25: Simulação para erro de atraso =5
A diferença entre as duas técnicas se faz evidente com os resultados da figura 4.26 para o caso onde não hé erro entre modelagem e planta. Neste caso fica evidente que a tecnica robusta proposta oferece uma resposta muito mais répida. Resumindo, significa que desconhecendo-se o erro no atraso a utilização da tecnica robusta proposta deve oferecer uma resposta mais réapida sempre quando o erro entre a planta e o modelo adotado for pequeno enquanto que a téecnica convencional de ponderar o esforcço de controle vai penalizar sistematicamente o desempenho da resposta.
A figura 4.27 mostra a derivada da função de Lyapunov ao longo da simulaçao com erro de atraso igual a 5 amostras. Praticamente todos os valores sãao menores ou iguais a zero como previsto.
4.7.4	Método iterativo para a restrição quadrática sobre Au
Os resultados apresentados nas figuras 4.25, 4.26 e 4.27 utilizam o algoritmo robusto proposto com uma aproximação para um dos vetores Au da expressao quadrética que aparece na restricao relacionada com a derivada da funçcaão de Lyapunov na equaçcãao
(a1)
Amostra
(b1)
Amostra
(a2)
Amostra
(b2)
Figura 4.26: Simulação sem erro no atraso
4.79.
Na solução iterativa o vetor Au utilizado na primeira iteracao á obtido com a aproximação Au = Autail como ja explicado. Nas iterações seguintes o vetor Autail á atualizado com a contribuiçao do vetor obtido com a minimizaçcãao,
Autaíi(k) = aAun + (1 - a)Autaii(k - 1).	(4.85)
O processo iterativo termina quando (Autail(k) — Auk)T(Autail(k) — Auk ) áe menor que um determinado valor proáximo de zero ou quando o nuámero de iteraçcãoes atinge um valor limite.
A figura 4.28 apresenta os resultados obtidos com o algoritmo iterativo para a minimizacçãao da funçcãao objetivo. As figuras da coluna esquerda apresentam os resultados para o caso em que háa um erro no atraso de transporte entre o modelo da planta e o modelo de prediçcaão igual a 5 instantes de amostragem. Na coluna da direita estaão os resultados para o caso em que nãao háa erro de modelagem. Em ambas as colunas apresenta-se a saída no grafico do topo, a açcãao de controle e o incremento de controle no graáfico do meio e a derivada da função de Lyapunov no gráfico da base. O objetivo nãao áe propor um máetodo para resolver problemas de
Figura 4.27: Derivada da função de Lyapunov para erro de atraso=5
Programação quadrática com restrições não lineares mas avaliar o desempenho da proposta NMPC robusta. O algoritmo iterativo mostrou-se bastante eficiente para este caso o que era de se esperar pois o valor inicial de Auioü é muito bom ja que se nada mudar na referência ou se não houver perturbações seu valor seria exato. Para sistemas adequadamente amostrados não se espera grandes mudançcas entre iteracçãoes sucessivas. Os resultados obtidos e apresentados na figura 4.28 mostram um comportamento da açcãao de controle mais suave e que o valor da derivada da funçcãao de Lyapunov se manteve sempre negativa. O efeito da perturbacão na saída foi tambem menor do que o obtido com o algoritmo aproximado.
Figura 4.28: Desempenho do metodo com algoritmo iterativo
Exemplo 6
A figura 4.29 mostra o diagrama de processo de um aquecedor de água em linha. O objetivo do processo é manter a temperatura e a vazao na saéda do duto em valores desejados. Para mostrar a vantagem da técnica robusta proposta supõe-se que a medição da temperatura é realizada a uma distância Lt do aquecedor. O
Figura 4.29: Sistema de aquecimento de água em linha
modelo do processo pode ser realizado utilizando-se um balancço de energia no volume do aquecedor. A variaçcaõo da energia no interior do aquecedor AEinterna é igual a diferenca entre a energia que entra Eentra e a energia que sai, Esai.
Eentra Esai = ^Einterna	(4.86)
Os parâmetros e variaveis do processo utilizados na simulação sõao apresentados na tabela 4.1. Assumindo perdas nulas para simplificar,
Eentra	=	PaqAtCaTe + P At,
E -	- Esai	_ paqAtcaTi-)
AEinterna	~	pa Aa La ca ATí , ou
paAaLaCaATi	= PaqAtCaTe + PAt - paqAtcaTi (4.87)
ATí
At
q T + q T +
AaLa 1 + AaLa e +
pacaAaEa
(4.88)
Tabela 4.1: Parâmetros e variáveis do processo
Símbolo Descrição	Valor
T Te	Temp. água entrando no aquecedor	K]
Ti	Temp. água interior do aquecedor		K ]
q	Vazao na linha	m3/s J
P	Potencia forn. ao aquecedor	W]
ca	Calor específico da égua	4168 J/KgK ]
La	Comprimento do aquecedor	0, 3m ]
Da	Diametro do aquecedor	1, 5 x 0, 0254 m ]
Dt	Diametro do duto	0, 5 x 0, 0254 m ]
Lt	Dist. aquecedor-transm. temp.	1, 25 m]
no limite quando At —&gt; 0,
=______q_T. + _^_Te +_______1_____
dt	AaLa	AaLa	pacaAa La
A fim de utilizar a vazao em unidades litros/hora multiplica-se a vazão por kq = 1/1000 x 3600 e obtém-se
dTj dt
kq q
AaLa
Ti +
kq q
AaLa
Te +
----1----P.
pa caAa La
(4.90)
Supoe-se que a temperatura de saída do aquecedor é igual a temperatura interna Tj. Utilizando a aproximacao de Euler para a derivada pode-se reescrever a equaçao 4.90 na forma discreta como,
dTi = Ti(k) - Ti(k - 1) dt	Ts
(4.91)
T,(k -1)+T. kqAL1- Te+
AaAa
Ti(k)= Ti(k - 1) - Ts Ts —A-^p (k - 1).
paca AaLa
AaLa
Definindo-se
ki
T skq
k2
AaLa'
Ts
PacaAaLa
(4.92)
pode-se escrever
Ti(k) = Ti(k - 1) - kiq(k - 1)T)(k - 1) + kiq(k - 1)Te + k2P(k - 1). (4.93)
A medição da temperatura é realizada a uma distância Lt na direção do fluxo. Nesta posição, desprezando perdas, a temperatura medida no instante k, T(k) e igual a temperatura que aconteceu d instantes de tempo igual ao período de amostragem Ts atras na saída do aquecedor. Na forma de equação contínua o atraso u deveria satisfazer a equação
' ■
Lt
v(t)
v(t)dt,
q(t) At
(4.94)
e o atraso d seria calculado como o valor inteiro mais proximo de Tp. Uma outra forma e buscar d que satisfaz
d e Z
•t = v(k - i)Ts
Lt
v(k - i)
q(k - i) At
(4.95)
l
De forma que a temperatura T, medida na posiçao Lt distante do aquecedor, pode ser escrita como
T(k) = Ti(k - d).
(4.96)
Se colocarmos um atraso d em todas as variaveis da equaçao 4.93,
Tj(k — d) = Tj(k — 1 — d) — k^q(k — 1 — d)Tj(k — 1 — d) + kiq(k — 1 — d)Te + k^P (k — 1 — d).	(4.97)
Utilizando a equação 4.96 em 4.97,
T(k) = T(k - 1) - kiq(k - 1 - d)T(k - 1) + kiq(k - 1 - d)Te +	(k - 1 - d).	(4.98)
A equação 4.98 relaciona a temperatura medida T(k) com a vazao q(k - 1 - d) e com a potência eietrica aplicada P(k - 1 - d) no aquecedor de forma nao linear. Não se aplicou o atraso na temperatura de entrada ja que supãe-se que a mesma não esta sendo medida.
Para mostrar o desempenho da tecnica PNMPC robusta proposta simula-se a aplicação de controle utilizando o algoritmo PNMPC com e sem a aplicação da tecnica proposta para lidar com erro de modelagem de forma robusta. O objetivo do controle é levar a temperatura no ponto de medicçãao para determinados valores desejados enquanto se mantem a vazão o mais proximo possível de um valor desejado. A tabela 4.2 apresenta os valores dos pa-rêmetros do processo utilizados na simulaçao: Trata-se de um
Tabela 4.2: Parâmetros do processo de aquecimento
Variavel	Valor	Unidade
Qdes.	500	l/h
Tdes.	diversas	K
Te	293	K
p J max.	10000	W
P - J min.	0	W
Qreax.	2000	l/h
pnin.	250	l/h
problema MPC com dois objetivos. Alem disso é tambem um problema com duas entradas e duas saídas. A função custo utilizada consiste em ponderar com pesos diferentes
—	o seguimento da temperatura de referência, (peso Ri),
—	o desvio da vazao desejada, (peso R2),
—	os elementos do vetor Au relacionados com a Potencia eletrica, (peso Si),
—	os elementos do vetor Au relacionados com a Vazão, (peso S2).
Definindo Im como a matriz identidade m x m, Ip como a matriz identidade p x p, 0m como a matriz de zeros m x m, e
	1		0		0	
ü l-l	1		1		0	
					0	
	1		1		1	
						mxm
					n T	
1m =	1	1	1		1	-1 mx 1	
1p =		1		1	]T x	
p					-1 px 1	
0 =	0	0		0	r -1 mx 1	
(4.99)
obtem-se
Ri
R2b
R2
a 1Ip
a2Im
' 0m
0m
0m
R2b
Si = AxIm
S2 = A2Im
Si 0m
0m	S2
S
Q
Qd
W
0
qk-11m
0
qdes.1
Tdes.lp
0m	0m
0m Dl
Au
(4.100)
m
Com essas definições pode-se escrever o problema de encontrar o vetor incremento de controle Au como a minimizacõo da seguinte
funcõo objetivo com restrições,
min J
Au
s. a.
J = (y- w)tRí (Y- W + (Q-Qd)TR2(Q-Qd)
+AuT SAu
Pk — 11 m	+	D1	0m	Au&amp;lt;	[ P	11 J max.2-m
qk — 1 lm		0m	D1		qmax. 1m
Pk — 1	+	D1	0m	Au &gt;	P	1 J mtn.2m
qk— 1		0m D1		qmin. 1m
(4.101)
onde Y é o vetor com as predições no horizonte de prediçao p obtido com a tecnica PNMPC na forma Y = F + GAu. Os parametros de sintonia utilizados na aplicação do algoritmo PNMPC sem a tecnica robusta sõo apresentados na tabela 4.3.
Tabela 4.3: Parâmetros de sintonia do algoritmo PNMPC sem utiliza-çcaõo da tecnica robusta
Paraâmero	Descricao	Valor
p	Horizonte de predicao	100
m	Horizonte de controle	3
a1	Pond. p/ refer. Temperatura	1
«2	Pond. p/ refer. Vazao	0,00025
A1	Pond. incremento Pot. Eletrica	0,01
A2	Pond. incremento Vazaao	5
As simulaçcoões com ou sem a utilizaçcõao da tecnica robusta utilizam o mesmo modelo para prediçcõao com um atraso fixo igual a 4 tempos de amostragem que e em geral menor do que o tempo de atraso que depende da vazaõo. A figura 4.30 mostra o resultado obtido com a aplicacçõao do algoritmo PNMPC sem a utilizacçõao da tecnica que introduz robustez proposta. Este e um dos resultados possíveis a depender do ajuste dos parâmetros a2, Ai e A2 se considerarmos fixos os valores de a1, p e m. Nota-se que a temperatura apresenta um comportamento lento mas segue a referância desejada. Nesta simulaçao foi necessario a utilizacõo de um valor muito grande para a2 que pondera a variacõo nos incrementos de vazõao, Aq, a fim de garantir a estabilidade. Isto comprometeu
Tempo [ min. ]
Figura 4.30: Aplicação de PNMPC não robusto
a capacidade do controle de levar a vazão para valores próximos do valor desejado. A evolução da vazao quando a referencia para a temperatura passa a 315 K e tão lenta que a vazao se mantem tão baixa a ponto de não utilizar toda a potência eletrica disponível para o aquecimento. O comportamento normal seria a vazão crescer ate o ponto em que a potência atingisse o valor maximo Pmax. = 10000 W. A figura 4.31 mostra que o sistema instabiliza quando se diminui a ponderaçcaão sobre a variacçaão nos incrementos de vazão Aq utilizando a mesma ponderacao que no algoritmo PNMPC robusto. Para a simulação com o algoritmo robusto utilizou-se os parêametros apresentados na tabela 4.4.
Os resultados da aplicaçcãao do algoritmo robusto sãao apresentados nas figuras 4.32 e 4.33. Utilizou-se a versao iterativa do algoritmo PNMPC robusto onde o vetor Au e obtido com um metodo iterativo conforme ja descrito anteriormente. Observa-se neste caso que a temperatura atinge a referência de forma mais rápida do que no caso não robusto e, alem disso, a vazao e tão proxima do valor desejado quanto e possível pela saturação da potência em seu valor maximo. Isto é, na ausência de saturação da potencia eletrica a vazãao atinge a vazãao desejada. No caso da satu-raçcaão da potêencia eletrica para a temperatura de referêencia igual a 315 a vazao fica limitada ao valor maximo que, com a potência
Tempo [ min. ]
Figura 4.31: Aplicação de PNMPC nao robusto com a2 =0, 2
disponível fornece a temperatura desejada. A figura 4.33 mostra algumas variaveis auxiliares obtidas com a simulação. A figura 4.33-a mostra o valor da derivada da função de Lyapunov a cada instante de tempo e nota-se que é sempre menor ou igual a zero e maior que o valor mínimo estipulado. A figura 4.33-b mostra o valor do atraso real do processo durante a simulacçaão onde observase que atinge um valor maximo igual a 23 tempos de amostragem que e muito maior do que o valor igual a 4 utilizado no modelo de prediçcãao. A figura 4.33-c mostra o numero de vezes que o algoritmo de programacçãao quadratica foi acionado para determinar Au. Nota-se que em regime permanente o numero é igual a 1 o que significa que não houve iteraçães e a aproximação de um dos vetores Au utilizando a cola ou tail do vetor calculado no instante de amostragem anterior é um otimo valor inicial para o metodo iterativo. Nota-se tambem que o numero de iteraçcoães utilizado foi relativamente pequeno. A figura 4.33-d mostra o erro de predicçãao e o fator de correção n. Como o erro simulado é somente de atraso nota-se que o fator de correçcãao vai a zero em regime permanente. Nos momentos de mudança de referência tem-se valores nao nulos como era de se esperar.
Tabela 4.4: Parêametros de sintonia do algoritmo PNMPC com a uti-lizaçcãao da tecnica robusta
Paramero	Descricao	Valor
p	Horizonte de predição	100
m	Horizonte de controle	3
«1	Pond.p/ refer. Temperatura	1
«2	Pond. p/ refer. Vazaão	0,00025
A1	Pond. incremento Pot. Eletrica	0,0003
A2	Pond. incremento Vazaão	0,2
P	Pond. esforçco de robustez	0,01Ip
e	Valor mínimo para a dt	-0,5
Exemplo 7
Em [86] apresenta-se uma tecnica de controle MPC robusta e sua aplicaçcaão a um reator de oxido de etileno. O sistema e modelado atraves de uma matriz funcão de transferencia na forma contínua mostrada na equacçãao 4.102 e na forma discreta equivalente (utilizando uma tempo de amostragem de 1 segundo) na equaçcaão
4.103.
G(s) =
G(z) =
- 0.19
s
nc2i
dc2is + 1
-nci2
dci2s + 1
0.235
s
(4.102)
-0.19 z-1
ndi2 z-ddi2
nd2i	0.235
z-dd2i	z-1
(4.103)
Os valores de nd12, nd21, dd12 e dd21 utilizados na simulação da planta são apresentados na tabela 4.5. Para testar a robustez do algoritmo de controle concebeu-se 4 modelos de prediçao numerados de 1 a 4 com variaçães nos valores dos parâmetros. O desafio é controlar o sistema utilizando os modelos de predição com ganhos menores e constantes de tempo maiores do que a planta. A tecnica utilizando MPC com equacães de estado denominada Cost Contracting Technique para sistemas integradores é apresentada em [86] e controla o sistema. Apresenta-se aqui uma versão do algoritmo PNMPC para sistemas lineares mas incorporando a tecnica robusta proposta. Uma das questães sobre a utilizaçao da tecnica robusta proposta diz respeito a factibilidade da solucão.
Tempo [ min. ]
Figura 4.32: Aplicacão de PNMPC robusto
Tabela 4.5: Parâmetros do modelo discreto
Mod.	ndi2	ddu	nd2i	dd‘2i
True	-0.5677	0.8787	-0.2178	0.8963
1	-0.1226	0.9738	-0.0044	0.9448
2	-0.0125	0.9262	-0.0143	0.9932
3	-0.0045	0.9738	-0.0005	0.969
4	-0.0850	0.9500	-0.0236	0.8963
Ou seja, existe a soluçcãao e o algoritmo proposto tem condicçoães de encontrá-la? Para este problema resolveu-se mostrar que
—	a matriz Hessiana da funcao objetivo á positiva definida. Isto áe verificado mostrando que o determinante de todas as matrizes menores principais, (leading minors) da matriz Hes-siana sãao maiores do que zero.
—	O Numero de condiçao da matriz Hessiana apresenta valores pequenos. A matriz Hessiana nãao áe singular nem tampouco se aproxima da singularidade.
—	O método iterativo utilizado para tratar da restricao quadrática em Au converge em poucas iteraçcoães. O máetodo áe muito semelhante ao consagrado mátodo simplex, [87], utilizado na
Figura 4.33: Aplicação de PNMPC robusto-variáveis auxiliares
solução de equações lineares onde parte-se de um bom valor inicial e o sistema converge para o valor correto. Neste caso a natureza do problema fornece naturalmente um otimo valor iniciar que é a cola ou tail do vetor Au obtido no instante de amostragem anterior.
— O sistema controlado com a tecnica robusta proposta é es-tével com uma ampla faixa de valores de ponderação na diagonal da matriz P. Isto sera mostrado variando-se o valor da diagonal da matriz P entre 1% e 100% do seu valor nominal.
Para demonstrar o desempenho da técnica PNMPC robusta aplicada neste exemplo a planta foi simulada com o modelo real mostrado na tabela 4.5. O modelo utilizado para as predicães inicia com o modelo 4 que é substituído pelo modelo numero 3 no tempo igual a 100 s, pelo modelo numero 2 no tempo igual a 130 s e pelo modelo 1 a partir do tempo igual a 160 s. Os parâmetros utilizados para a sintonia do algoritmo PNMPC robusto sãao apresentados na tabela 4.6.
As restriçães utilizadas são as mesmas adotadas em [86]. A escolha dos parâmetros de sintonia como p, m e as ponderaçães
Tabela 4.6: Parâmetros de sintonia do algoritmo PNMPC com a uti-lizacao da tecnica robusta p/ o controle do reator de oxido de etileno		
Paramero	Descrição	Valor
p	Horizonte de predição	6
m	Horizonte de controle	3
Ri	Pond.p/ referência saída 1	1 1Ip,p
R2	Pond. p/ referencia saída 2	1, 1Ip,p
Qi	Pond. incr. controle p/ entrada 1	Im,m
Q2	Pond. incr. controle p/ entrada 2	1 65I m,m
a	Const. p/ filtragem erro de predicçãao	a = 0.8
Pi	Peso para robustez erro 1	0.06Ip,p
P2	Peso para robustez erro 2	0.22Ip,p
e	Min. p/ a derivada da função de Lyapunov	-2.0
a.max ui	Valor maximo para entrada 1	0,75
..max u2	Valor maximo para entrada 2	0,75
, .min ui	Valor min. para entrada 1	-0,75
min u2	Valor min. para entrada 2	-0,75
Aumax	Valor maximo p/ incr. entrada 1	0,5
Aumin	Valor mínimo p/ incr. entrada 2	-0,5
utilizadas seguem a criterio tradicional de balancear desempenho e robustez e exceto pela matriz P nao serao discutidas.
A figura apresenta as variaveis controladas e manipuladas aplicando a sintonia descrita. Nota-se que as variaveis atingem o valor de referencia sem oscilacães e as ações de controle seguem as restriçães impostas. A figura 4.35 mostra diversas variaveis de interesse. As figuras 4.35-a e 4.35-b mostram o erro de modelagem e a integral do erro filtrado para a variavel 1 e 2 respectivamente. Nota-se que a utilização de a = 0, 8 no algoritmo de tratamento do erro de modelagem resulta em uma integral do erro filtrado bastante suave. A figura 4.35-c mostra a evoluçcãao da derivada da funcão de Lyapunov. Como exigido cada vez que se calcula a acçãao de controle ela e mantida sempre menor ou igual a zero e obedece o limite inferior igual a -2. Como o problema de encontrar o vetor Au significa encontrar o mínimo de uma funcao quadratica,
(a)
									!	
! i 1 	Iz	- V a y										
									-- - ref,	
a / ’/y									--- ref2	
										y2	
0	20	40	60	80	100	120	140	160	180	200
Tempo [s]
(b)
Figura 4.34: Resposta com aplicação da técnica robusta
(a)
0.05 0			
			
0.05	í		Erro1	
-0.1	í	—li	
0	50	100	1 50	200
(b)
0	50	100	150	200
	14	Número de	/
dL/dt	12	X condição de |	
	10	L_	
	8		
(e)
(f)
4.26
4.24
4.22
Menor	T
determinante dos (Leading Minors de&amp;lt;|&gt;)
mm
4'20	50	100	150	200
Tempo [s]
50	100	150	200
Tempo [s]
4
2
Figura 4.35: Variéveis auxiliares obtidas com a simulacão
então e importante garantir que a matriz $ seja inversível e também positiva definida. A figura 4.35-d mostra o nUmero de condição da matriz $ e a figura 4.35-e mostra o valor do menor
d 2 J determinante dentre os leading minors da matriz $ = ^¿2 • Observa-se que o número de condição é pequeno indicando que a matriz é inversével e esté longe da singularidade. O fato do menor valor dentre os determinantes dos leading minors da matriz $ ser positivo indica que a matriz é positiva definida e a matriz apresenta um mínimo global na ausência de restricães. A figura 4.35-f apresenta o numero de vezes que se utilizou o algoritmo de programaçcãao quadréatica no processo iterativo devido a restricao quadrética. Nota-se que atingiu-se o erro aceitavel com no méximo 3 iteraçães e que em regime permanente, depois das mudanças de modelo, não se fez necessario iterações extras devido a utilização do valor inicial de Auesp. igual a cola de Au utilizado no instante de amostragem anterior.
A fim de mostrar a robustez da soluçcãao robusta proposta simulou-se a aplicaçao do algoritmo PNMPC robusto com valores de P variando desde 1 % até 110 % do valor nominal utilizado. Os resultados são apresentados na figura 4.36.
Figura 4.36: Desempenho do algoritmo com diferentes pesos P
Percebe-se que todas as escolhas da matriz de ponderação P fornecem uma resposta estavel das saídas apesar de um comportamento dinâmico diferente na mudanca de referência mostrando que não seria difícil encontrar uma ponderação P que estabilize o sistema. A figura 4.37 mostra a resposta obtida sem a utiliza-çcãao da tecnica robusta mas com todos os demais parâametros de sintonia do algoritmo PNMPC robusto utilizados anteriormente. Observa-se que o algoritmo PNMPC sem a tecnica robusta consegue estabilizar o sistema ate o tempo igual a 100 segundos quando o modelo de prediçcãao e o de numero 4. Para os modelos numero 3 e 2 utilizados a partir do tempo igual a 100 segundos o sistema instabiliza e so não cresce indefinidamente devido a restrição nos incrementos e nas açães de controle. A instabilidade fica tambem evidente pelos valores positivos da derivada da funçcãao de Lyapunov mostrada na figura 4.38-c. O comportamento dos erros de modelagem e fatores de correção mostrados nas figuras 4.38-a e 4.38-b tambem mostram o comportamento oscilatorio durante o tempo em que o modelo de prediçcãao utilizado foi o numero 3 e 2. O comportamento do sistema com o modelo numero 1, a partir do tempo igual a 160 segundos, apresenta uma oscilação moderada e as acçãoes de controle nãao atingiram seus valores de saturacçãao. O sistema parece a beira da instabilidade e simulaçcoães com a introducao de ruído mostram que o sistema instabiliza para todos os modelos de predição 4, 3, 2 e 1. Verificou-se tambem que a utilizaçao do tratamento do erro de modelagem com a = 0 instabiliza o sistema para todos os modelos de 1 a 4. Ja a utilização de a = 0, 9 estabiliza o sistema para os modelos 4 e 1 mas nãao para os modelos 3 e 2.
4.8	Conclusão e desenvolvimentos futuros
Apresentou-se neste capítulo a proposta de um algoritmo MPC para aplicaçcãao em sistemas nãao lineares com comportamento dos estados contínuos e diferenciaveis em relação as entradas. A técnica proposta, denominada de MPC Nãao linear pratico-PNMPC, propãoe uma forma generalizada de representaçcãao do vetor de predições valida para sistemas lineares ou não lineares (sistemas com estados cont ínuos e diferenciaveis em relação as entradas). A rep-resentaçcãao linear das prediçcãoes e realizada utilizando-se um pro-
Figura 4.37: Resultado da simulação sem aplicacao da tecnica robusta
(b)
Figura 4.38: Variaveis auxiliares na simulação sem a tecnica robusta
cedimento numerico e por isso o algoritmo pode ser aplicado as mais diversas formas de representacçãao de sistemas nãao lineares como redes neuronais, modelos NARMAX, etc.
Com o intuito de obter melhores predições, desenvolve-se um
procedimento numérico de dois passos que obtém uma aproximação linear com qualidade próxima a representação Taylor de 2a. ordem. A tecnica proposta incorpora uma metodologia para o tratamento de erros de modelagem baseada na escolha de um unico parâmetro que pondera o requisito de filtragem de ruído e velocidade de resposta.
A estabilidade do algoritmo e fortemente melhorada com a incor-poraçcaão de uma tecnica que coloca o requisito de estabilidade na função objetivo. Isto e realizado exigindo-se que a derivada de uma função de Lyapunov mantenha-se negativa no horizonte de prediçcãao.
A implementaçao deste requisito no algoritmo de Programaçao Quadratica enfrenta a dificuldade do surgimento de uma restricão quadr atica no vetor incremento de controle Au.
Uma solução inicial para este problema e apresentada e consiste na transformacçãao da restriçcãao quadratica sobre Au em linear ao se aproximar um dos vetores Au como a cola do vetor obtido no instante de amostragem anterior, Auio¡¡.
Na sequância desenvolve-se um processo iterativo onde a restri-cçãao e transformada em linear ao se estimar um valor inicial do vetor incremento de controle baseado na cola do vetor Au anterior, Auíaií somente na primeira iteração. Este vetor e corrigido com parte do novo vetor obtido a cada iteraçcãao em um processo iterativo que e interrompido quando o erro entre este e o vetor Au atual obtido torna-se suficientemente pequeno.
A solucçãao do problema de Programacçãao Quadr atica com restriçcãao quadratica nãao e o objetivo principal deste trabalho mas deve ser investigada na continuaçcãao da pesquisa com o objetivo de aprimorar o algoritmo e estabelecer as condiçcoães de operaçcãao segura do mesmo.
Nãao e demais voltar a salientar que o algoritmo desenvolvido aplica-se a sistemas contínuos em relacão as entradas e que sejam amostrados seguindo as melhores tecnicas de amostragem de sistemas. O algoritmo e aplicado aos estados do sistema e este trabalho naão pretende oferecer nenhuma novidade na questãao relacionamentos estado-saída de sistemas.
Capítulo 5
Controle aplicado a poços operando via GLC
Nos Ultimos 10 anos algumas empresas atuando na exploração e producão de petróleo começaram a introduzir técnicas de controle e automaçao na operação de pocos de petróleo. Essas iniciativas resultaram em tecnicas com nomes como smart wells, intelligent wells, smart fields ou Gerenciamento Digital Integrado da Produçao-GEIDG na Petrobras, [88]. A introdução da tecnologia da informação no sistema de produção de petróleo é lento principalmente devido ao custo proibitivo da intervençcãao em poçcos para a instalaçcaão dos sensores e atuadores necessóarios. Alóem disso os equipamentos a serem instalados no fundo dos poços tem de suportar as condiçcoães adversas causadas por alta pressãao, temperatura e vibraçcãoes. Neste capótulo apresenta-se uma breve revisãao do desenvolvimento de tóecnicas de controle, otimizaçcaão e automaçcãao da operacçãao de pocços utilizando elevacçãao do tipo GLC. Na sequância são apresentados duas abordagens para a au-tomacçãao da operacçãao.
5.1	Introdução
O desenvolvimento de tecnicas de controle para poços operando via GLC tem sido intenso no meio acadâmico e industrial como em [22], [89], [23], [24], [31], [25], [26], [27], [28], [29], [30],[44]. A otimizaçcõao da produçcõao de poçcos operando via GLC tem recebido tambem a atençõo de diversos pesquisadores com os primeiros trabalhos publicados na decada de 70. Em [90], o termo curva de desempenho (well performance curve ou WPC) foi introduzido e utilizado para modelar a relaçõo entre gas de injecõo e taxa de pro-duçõo. O metodo equal-slope foi proposto em [91]. A distribuiçõo do gas de injecõo é obtida computando a inclinacao (slope) das tangentes das curvas de desempenho que satisfazem as condiçcoões de otimalidade de primeira ordem (Karush-Kuhn-Tucker Conditions) [52].
Uma abordagem mais flexível para o problema de alocacõo de gas de injeçõo foi proposta em [92, 93]. Nishikiori et al. desenvolveram um metodo, baseado no metodo quasi-Newton e pro-jecçõao de gradiente, capaz de tratar limites de injeçcaõo nos pocços alem da restriçcõao de disponibilidade de gas de injeçcõao. Um procedimento heurístico foi tambem desenvolvido para encontrar uma estimativa inicial que esteja dentro da regiõao de convergâencia do algoritmo quasi-Newton.
Em [94], um metodo com convergâencia global foi proposto para encontrar a alocaçcõao otima de gas de injeçcao que maximiza a producçaõo de oleo. Este metodo pode ser visto como uma exten-sõo do metodo proposto em [92, 93], o qual utiliza um algoritmo de programaçõo quadrática sequencial (PQS) [95] no lugar do metodo quasi-Newton. Em [96, 97], um modelo linear por partes alternativo e proposto para o problema de alocaçcõao de gas de injecçaõo, para cenarios com restriçcõao na disponibilidade de gas, limites inferiores e superiores para injecçõao em cada pocço e tratamento de curvas de desempenho nõao-câoncavas. Este trabalho traz grande aprofundamento teorico, atraves do estudo poliedrico do espaçco de restriçcõoes, e a concepçcõao de cortes baseados na noçcõao de cobertura em problemas da mochila [98, 99]. Estes desenvolvimento levam a algoritmos tipo cut-and-branch eficazes, capazes de resolver problemas de alocaçcõao de grande porte e obter uma soluçao comprovadamente otima.
Na sequância é apresentado um resumo de alguns projetos de
controle da operacão de poços com elevação do tipo GLC implementados por companhias operadoras.
5.1.1	Elf 1990
Diversos trabalhos sobre a otimizacão da elevação por gas lift tem sido publicados como [100] e [91] mas possivelmente o primeiro trabalho apresentado em Congresso descrevendo a automacçãao da operação de poços operando via gas lift foi o de P. Letemayer e P. M. Miret para o campo de Gonelle no Gabão [101]. Neste trabalho os autores descrevem os benefícios atingidos com a aplicação de uma técnica de controle e automação dos poços do campo de Gonelle, Gabao em Março de 1990. Sem duvida os principais benefícios foram um aumento da producao de cerca de 20% com uma redução da taxa de injecao de gés tambem em cerca de 20%. Algumas características da solução adotada são:
—	Inferência da vazao de producao baseado na medicão da Temperatura do fluido produzido na cabeça do poço.
—	Sistema de Controle Local mas conectado a um sistema su-pervisíorio, isto íe, PLC situado junto a cada poçco mas trocando informaçcãao com a sala de comando.
—	Controle da Vazao de Injeçao de Gas é o ajuste principal.
—	Medicão das pressões na cabeca do poço no tubo de produção, THP, no revestimento, CHP, temperatura no topo do tubo de produçao, THT e vazão de injecao de gas, IGR.
—	Atuacão no choke de produçao é utilizada para controle de partida e re-partida do poçco.
E importante observar que defende-se neste trabalho o controle da vazao de injeção de gés em malha fechada, Effectively, as a slight plugging occurs, the system detects an IGR decrease and immediatelly corrects choke opening. Plugging tendancy is therefore eliminated.”
(drawndown) ja que a formação e pouco consolidada e exige cuidados especiais.
O trabalho não apresenta maiores detalhes sobre a tecnica de otimizaçcãao utilizada na alocacçãao de gas e tampouco descreve os algoritmos de controle.
Desde a publicação do trabalho de P. Letemayer e P. M. Miret no campo de Gonelle muitos outros trabalhos tem sido publicados sobre o tema.
5.1.2	Suez Oil Co. 1995
Em [102] discute-se a utilizacão de um modelo completo do sistema de produçao via gas-lift do campo Ras Budran no Golfo de Suez para utilizacão na otimização do processo.
O ênfase e dado para a distribuicao otima de gas de injeçao em cenarios de disponibilidade limitada de gas. Os poçcos produzem fortemente sub saturados o que permite a consideraçcaão de uma relacao linear para a curva IPR. Todas as perdas de pressão são modeladas utilizando correlações disponíveis na literatura. Para o escoamento multifasico vertical utilizou-se correlações de Orki-asewski Hagedorn e Brown e Mukherjee e Brill conforme a avali-açcãao do erro em relacçãao a testes de pressãao efetuados. O trabalho apresenta de forma suscinta o metodo utilizado para a alocaçcaão de gas. Trata-se do metodo equal slope. Um modelo matematico e obtido para cada poço relacionando a vazão de injeçao x de um poco j, (xj) com sua vazão de líquido total fj(x).
n
fj(x) =	bj’ixl	(5J)
l=1
Os coeficientes bjl são determinados pelo metodo dos mínimos quadrados.
Encontra-se para cada poço j a vazao de injecão (x*) que fornece o ponto onde o gradiente da vazão de producão de líquido e zero:
dfj (x)	.	.
dT' =0	(5.2)
No caso em que a capacidade dos compressores nao possa fornecer a vazãao total exigida pelos pocços para funcionarem nos seus pon-
tos átimos resolve-se o seguinte problema de otimização:
max(f1(x1) +	+ ... + fm(xm))	(5.3)
sujeito a
xi + x2 + ... + xm &amp;lt;X
xi &gt; 0
O problema de otimizaçao pode tornar-se mais complexo se outras restriçães são introduzidas como limites para as vazães de injeção mínimas e restrições nos equipamentos a juzante do poço como linhas de fluxo e separadores. O artigo conclui que
—	a atualizacao do modelo desenvolvido com novas mediçoes á essencial para sua utilizacão como uma ferramenta para a otimizaçcãao do processo.
—	Os erros obtidos ficaram entre os modelos desenvolvidos e as mediçoes ficaram entre 1 e 1.5%.
—	11 pocos foram melhor modelados com a correlacão de Ork-iszewski, 4 com a correlaçao de Hagedorn e Brown e 1 com a de Mukherjee e Brill.
5.1.3	Shell 1998
Em [103] discute-se aspectos de otimização de gas lift sob o ponto de vista da tecnologia desenvolvida pela empresa Shell. O artigo mostra táecnicas para a obtençcaão das vazãoes de produçcãao e sua utilização na otimização do uso do gás disponível para injeção. Nota-se a aplicacão de controle tanto no choke de injecão como no choke de produção. Apresenta-se ainda diversas tecnicas desenvolvidas pela empresa Shell como:
—	WellDone - WellDone é o nome do algoritmo de otimizaçao para teste de poçco que analisa mediçcoães de separadores de teste em tempo real. Otimiza o tempo de teste. Trata-se de um sistema automatizado para testes de pocços. O sistema de teste inclui a cabeca do poço, as linhas de fluxo entre a cabeça do poço e o separador, o separador de teste e sua instrumentacçãao.
—	DeltaP - E um mátodo para calcular a producao de láquido baseado na queda de pressãao em um orifácio instalado na linha de fluxo perto do separador.
—	IGUF - Incremental Gas Utilization Factor. Determina a resposta da produçcãao do poçco para incrementos em sua vazãao de injeçcãao de gas.
—	DynaCon - usa a manipulaçao do choke de produçao para estabilizar poçcos que exibem comportamento instaável.
—	SGAS - Shell usa um pacote de software para tempo real chamado SGAS para monitoramento do sistema de gas-lift e seus poçcos associados. Realiza uma distribuiçcãao automáatica de gáas para os poçcos para manter uma pressaão estaável no sistema de gas-lift e uma distribuiçcãao áotima e estáavel para os poçcos. SGAS monitora a pressãao na cabeçca dos poçcos (THP e CHP - Tubing Head Pressure e Casing Head Pressure) e utiliza estas informaçcãoes para identificar pocços instáaveis.
—	GLUE - A alocação de gas á baseada nas curvas de desempenho de gas-lift de todos os poçcos. As curvas de desempenho sãao obtidas com um programa de anáalise de gas-lift chamado GLUE (Gas Lift Users Environment).
Shell utiliza a mediçcãao da queda de pressãao em um orifácio para calcular a vazãao de oáleo. Este áe o máetodo DeltaP.
AP = f (k,Qiiq.,Qg^ic)	(5.4)
O valor de k está associado com a abertura do orifício, Qliq. representa a vazão de láquido produzida e Qgt_lcrepresenta a vazao total de gaás nas condiçcãoes da linha.
Qgt_sc = Qgisc + FGOR(1 — BSW )Qliq.	(5.5)
FGOR e BSW representam o GOR (Gas Oil Ratio) da formacão e a saturação de água respectivamente. Qgt_sc e Qgi_sc sao a vazãao total de gaás e a vazãao de injeçcãao de gáas, respectivamente em condiçcaão padraão. A vazãao de oáleo pode ser calculada combinando-se as equaçcoães 5.4 e 5.5:
Qoil = f (k, Qg^sc, FLP, AP, FGOR, BSW)	(5.6)
FLP (Fow Line Pressure) áe usada para converter a vazãao de gáas da condicçãao de linha para a condiçcãao padrãao. O fator de cali-
braçao (depende do diametro do orifício), o FGOR e BSW são determinados durante um teste de poçco. Assume-se que estes pa-râametros mantenham-se constantes entre os testes de poçcos. O diâmetro do orifício utilizado e selecionado de forma a inserir uma queda de pressão muito pequena, da ordem de 7 psi. Testes de campo realizados em 9 poços offshore mostraram que em 90% das mediçães realizadas com a tecnica DeltaP obteve-se um erro menor ou igual a 10%.
Dynacon e a tecnica de controle utilizada para estabilizar e minimizar a Pressão no topo do revestimento (CHP). Assume-se que a vazao de injeção seja implementada de forma independente, isto e, não se manipula a vazão de injeção para efeito de controle da dinâamica. A estrategia de controle adota uma configuraçcãao de dois PIDs em cascata. A malha interna utiliza a medicão da pressao no topo do revestimento (CHP) para obter uma acão de controle que e a abertura do choke de produção. O valor de refe-râencia para a malha interna e fornecido por uma malha que utiliza a medição da abertura do choke de producao e tem como referência uma abertura desejada. O choke de produção deveria estar sempre aberto para obter-se a maxima produção. Entretanto, a fim de garantir uma certa margem de controle para estabilizar-se a pressãao de revestimento, deve-se mante-lo com uma abertura ligeiramente menor que 100%. Assim a referâencia para a abertura do choke na malha PID externa e calculada em funcçãao da vazão de injeção. A figura 5.1 mostra a estrategia de controle Dynacon proposta neste trabalho. Supãe-se que a velocidade de resposta da malha externa seja bem menor do que a malha interna a fim de que a malha interna possa atuar na estabilizaçcaão da pressaão do revestimento e que a longo prazo a abertura do choke de produçcãao atinja a abertura de referâencia desejada suavemente. O fato da abertura de referâencia do choke de produçcãao ser uma funçcaão da vazãao de injeçcãao parece normal nesta estrategia uma vez que necessita-se de uma margem de atuaçcãao do choke maior para valores de injeçcaão menores pois a dinâamica do sistema tem uma atenuaçcãao menor para taxas de injecçãao menores.
Figura 5.1: Estrategia de Controle Dynacon
vazao constante) e da queda de pressao no anular (pequena). Assim, controlar a pressaõo no topo do revestimento para uma vazaõo de injeçõo constante equivale a controlar a pressõo no tubo de produçõo no ponto de injecao de gas. Por outro lado a diferença da pressaõo neste ponto do tubo de producçõao para a pressõao na frente dos canhoneados deve-se praticamente a queda de pressõo exercida pela coluna de fluido produzido pela formaçao no intervalo entre a profundidade dos canhoneados e a valvula operadora. Desprezando-se o atrito, este valor seria constante e dependeria da densidade media do fluido produzido.
O artigo defende uma estrategia de fechamento do choke de pro-duçcõao para aumentar a producçaõo em relaçcõao aquela que seria obtida com o choke 100% aberto para pocos operando em regiao instável. A justificativa é que com o choke 100% aberto o comportamento do tipo slug-flow resulta em uma produc-ao media pequena comparada com a que se pode obter com o pocço controlado atraves do fechamento do choke. A ideia seria utilizar o metodo DeltaP para buscar uma abertura de choke que maximize a producõo. Esta parte do trabalho nao esta bem clara pois ao mesmo tempo defende-se uma estrategia para estabilizar o pocço
utilizando-se o Dynacon.
5.1.4	Texaco 1999
Em [104] o trabalho desenvolvido pela Texaco Exploration and Production descreve um programa de automacão de poços operando por gas lift com exemplos do Lake Barre Field e Gulf of Mexico. Este trabalho defende a consideração do custo da taxa de injecão de gas na obtençcãao do ponto otimo assim como outros autores. Defende tambem a consideraçcãao do custo da agua produzida e o valor associado diferente para o gas produzido pelo poco. De acordo com os autores estas consideraçcãoes irãao colocar o ponto otimo sem restriçao um pouco à esquerda do otimo que considera apenas a produção total de petroleo. O objetivo principal do sistema e controlar a injeçcãao de g as para cada poçco de forma que este receber a sua taxa de injeçcãao otima. As taxas sãao mantidas constantes mesmo quando a pressãao de suprimento varia.
As características dos poços são obtidas com testes do tipo step rate well test. Com estes testes, curvas que relacionam a vazao de produçcãao com a taxa de injeçcãao de gas sãao obtidas. Utilizando as saídas do compressor (possivelmente pressão de descarga e re-circulação) e possível determinar a quantidade de gas disponível para injeçcaão. Com estas informaçcãoes uma tabela de alocaçcãao de gas pode ser obtida para cada pocço. Esta tabela relaciona a vazãao otima de injeçcaão para cada pressãao de suprimento de gas (possivelmente a pressão a montante do manifold de gas lift).
Os autores defendem o step rate well test e a utilização da representação da relaçao Qo x Qi na forma de polinómio. Os coeficientes dos fatores polinomiais seriam obtidos por um metodo de ajuste de curva utilizando mínimos quadrados.
Assim como em outros artigos os autores ressaltam que as os-cilaçcãoes devido a operaçcãoes em malha aberta atuam no sentido de diminuir a produçcãao di aria efetiva.
uma grande mudanca na vazão de injeção sem uma perda significativa de producão. Este resultado pode ser contra intuitivo ja que poderia se imaginar que a quantidade de gas a ser diminuída deveria ser reduzida do poço com menor índice de produtividade. Concluem que uma injeçao de gas feita com o auxílio de controladores de vazãao fornecendo uma vazãao constante garantem uma melhoria na produção ao eliminar as oscilaçães devido a flutu-açcãoes na pressãao de suprimento de gas. Mostram ainda a uti-lizaçao das medições para a detecção de início de entupimento devido a hidratos. No momento da detecção, o choke é atuado rapidamente para remover o deposito.
O artigo e um pouco superficial mas é importante observar que defendem o controle da vazãao de injecçãao como uma forma de garantir uma produçao mais estavel e maior.
5.1.5	TotalFinaElf 2002
Em [105] o trabalho apresentado por engenheiros da Elf-Congo e TotalFinaElf incluindo P. Letemayer fala das vantagens da apli-caçcãao de automaçcãao na operaçcãao de pocços maduros operando via gas-lift no campo Sendji offshore Congo. Sem fornecer detalhes das soluçcãoes adotadas o artigo descreve apenas algumas características da soluçao e os objetivos atingidos. Fica clara a preocupação com o controle da dinâmica do poço e defende-se a atuacão simultanea do choke de injeçao e de produção na estabilização do poçco. O Algolritmo de Controle e baseado em sequâencia sem utilizar calculos.
A melhoria na produçcãao foi maior que 1300 bopd comparada com o esperado de 1000 bopd.
O custo da implementaçcaão do sistema foi de 4 milhãoes de dolares ou 66 Mil dolares por poço. A solução de controle é do tipo distribuída para evitar problemas com conexão. A solução de controle inclui a repartida controlada dos pocços. Nãao fica claro qual o metodo utilizado para alocaçcãao de g as. O âenfase foi dado na elimi-naçcãao das oscilaçcãoes que causam diversos problemas operacionais alem da diminuição da producão efetiva de ate 50% em alguns casos. O artigo nãao fala da alocacçãao otima de gas e concentra-se em controlar a dinâamica dos poçcos inclusive na repartida. Ainda assim os resultados obtidos sãao impressionantes. Nãao mostra o algoritmo de controle utilizado afirmando apenas que atua tanto
no choke de injecão como no choke de produção. Fica a impressão de que as taxas de injeçcaão de cada poçco sãao selecionadas pelos operadores.
5.1.6	Dubai Petroleum Company 2006
Em [106] descreve-se um modelo de otimização para um sistema de produçao offshore Dubai operando com gas-lift pela companhia Dubai Petroleum Company.
O modelo de otimização contempla todo o sistema: configuraçao de fundo de poçco, o sistema de escoamento da produçcãao, a rede de dutos para alimentaçcãao de gas para injeçcãao, separadores, compressores e bombas.
A solucçãao do processo de otimizaçcãao fornece valores recomendados para a taxa de injeçcaão de cada poçco, pressãao de separadores, pressãao de descarga dos compressores e utilizaçcãao de compressores.
O projeto foi dividido em 3 fases. O sistema nãao esta automatizado.
Principais conclusãoes:
1	- Os resultados obtidos no processo de otimizacçãao do sistema indicaram que a realocacçãao de gas de injeçcaão para todos os poços a fim de manter estavel a pressão do manifold de gaslift resulta em menos perda de produçcãao. O artigo reconhece que o gradiente entre a vazãao de produçcãao e a taxa de in-jecão de gas é muito pequeno perto do otimo global (a curva e plana naquela regiãao) e isto possibilita uma diminuiçcãao consider avel da taxa de injeçcãao de g as com uma perda de producão muito pequena. Quando isto é feito para todos os poços e possível operar com muito menos gas e com uma perda de producçaão muito pequena.
2	- Devido as diferençcas consideraveis de temperatura entre verãao e inverno, a capacidade de compressaão varia para a potância instalada. No verão ocorre uma falta de gas e o processo de otimizaçcãao da alocaçcãao de g as permitiu trabalhar com os compressores existentes e ate mesmo desligar compressores no inverno.
3	- Na fase 1 o campo de Falah obteve um amento de 11% na produçao com uma reducão de 14% na taxa de injeção
de gés. Na fase 2 outros campos obtiveram melhorias um pouco menos expressivas.
4	- Os modelos sao atualizados a cada 3 meses e o processo de otimização permite a criacão (offline) de tabelas contemplando diferentes cenaérios de disponibilidade de géas para injeção.
No caso de falta de gés jé não se utiliza a política anterior de fechar poços. A polética atual consiste em fazer uma redução de 0,5 MMscf/D por poço para um grupo de poços (20) selecionados pelo algoritmo de otimizaçao. Isto fornece uma economia de gas de 10 MMscf/D. Caso a indisponibilidade seja maior do que 10 MMscf/D entaão a reducçãao de 0.5 MMscf/D ée aplicada a um novo grupo de poçcos (podem incluir alguns do primeiro grupo). Se a indisponibilidade for maior do que 20 MMscf/D entãao o sistema passa para o terceiro grupo, e assim por diante. Estaão sendo feitos esforçcos para a implementacçãao de uma soluçcãao de controle do tipo SCADA.
O Projeto acontece em um sistema nãao automatizado e, por isso, estabelece um sistema off-line de otimização. Ainda assim é um sistema muito interessante pois leva em conta todos os processos envolvidos como linhas de fluxo, compressores, separadores, poços, etc. O modelo é atualizado conforme ocorrem modificações no sistema e as estratéegias sãao reavaliadas a cada 3 meses quando se faz a realocaçcãao de géas. A grande dificuldade que esta soluçcãao encontraréa na praética ao longo do tempo ée sua dependâencia do fator humano. Como os procedimentos naão sãao automatizados, algumas tarefas podem nãao acontecer como se esperava ou na éepoca em que se esperava que acontecesse. Aléem disso a realo-cacçãao de géas somente a cada 3 meses parece deixar margem para melhoras jé que neste período pode ter havido mudanças que justificassem atualizaçcãoes. Eé claro que isto depende muito das características dos reservatórios e eventualmente pode ser suficiente para este caso mas nãao parece ser uma solucçãao aplicéavel para todas as situaçcãoes. O artigo nãao fornece nenhuma informaçcãao sobre os modelos adotados e sobre os algoritmos utilizados.
5.1.7	Petrobras 2006
Em [88] discute-se a visao da Petrobras do Gerenciamento Digital Integrado da Producçãao. Neste trabalho apresenta-se algumas
açcãoes da Petrobras sobre a automacçãao de pocços de petroleo. Com relaçao a elevação por gaslift contínuo os seguintes trabalhos são apresentados:
—	Descreve-se uma investigaçao sobre a sensibilidade da temperatura medida na cabeça de produção da plataforma à variaçcãoes na taxa de producçãao medida em um separador de teste. O artigo conclui que apesar de comprovar-se a re-lacão sua sensibilidade não é suficiente para utilização na otimizaçcãao do processo. A correlaçcãao da dinâamica das va-riaveis mostra-se interessante para a identificacão de regime permanente em testes de produçcãao.
—	apresenta-se o desenvolvimento de uma estrategia de inferência da vazao de producão em um escoamento multifasico de poços com alto GOR e oleo leve no campo de Urucu. Uma rede neural utiliza mediçcoães de temperatura e deltaP em uma estrutura com duas placas de orifícios e infere a vazão. O fato dos poços produzirem com alto GOR e operarem com choke atuado para estabilização justificam a estrategia ja que nenhuma pressão indesejavel é adicionada na pressao de fundo pelo sistema de mediçcaão. As medicçãoes inferidas saão utilizadas nos algoritmos de controle do poçco.
—	Descreve-se uma aplicaçao de controle realizada no campo Riacho da Forquilha pertencente a unidade de negocios Rio Grande do Norte. O sistema e monitorado e operado remotamente, por uma conexãao de radio, pelos analistas de poçcos trabalhando em Natal, 250 km do poco. O sistema de controle consiste de um CLP instalado junto a cabeca do poço contendo o algoritmo de otimizaçcaão. A estrategia baseia-se na mediçcãao da pressãao de fundo como variavel controlada e na utilizaçcãao da pressãao no revestimento como variavel manipulada. Um PID atua na vazaão de injeçcãao controlando a abertura de uma valvula de controle na linha de injecçãao de g as. A metodologia e considerada eficiente para determinar novas taxas de injeçcaão devido a mudançcas na producçãao do poço relacionados com GOR, BSW, garantia de escoamento, ou restriçcoães externas como instabilidade de compressores. Devido o grande numero de poçcos neste campo maduro, a atualizaçcãao da taxa de injeçcãao baseada em testes de pro-duçcãao nãao garantiria que a mudançca ocorresse no momento adequado (wrong time decision).
Na sequêencia serãao apresentadas duas abordagens para a ope-raçcãao autom atica de um grupo de poçcos utilizando elevaçcãao do tipo GLC. Para ambas propostas considera-se instalaçcãoes com as seguintes características:
— Os pocos sao equipados com medicao de pressao de fundo.
— Todos os pocos recebem gas para injeçao de um mesmo manifold.
— Todos os pocos sao equipados com medidores de vazao mas-sica de g as na linha de injeçcãao.
— Todos os pocos sao equipados com valvula de controle na linha de injeçcãao de gas.
— Todos os pocos podem ter sua producao direcionada para um separador de teste.
5.2	Um sistema de Controle automático com ênfase na otimizacáo da produção
1 Nesta seção apresenta-se um algoritmo de controle para a ope-raçcãao de um grupo de poçcos equipados com sensores de fundo de poço medindo pressão e temperatura. A medição contínua da pressaão e temperatura de fundo naão sãao interessantes somente para o controle das operacçãoes mas saão informacçãoes valiosas para o gerenciamento da recuperacçaão de oleo de todo o campo. Alem disso, cada poço e equipado com mediçao de vazão de injeção e um choke de injecçãao com controle automatico. Este e um cenario realístico no Brasil para os pocos sendo completados atualmente para elevaçcãao por GLC. Um controlador local atuando sobre um choke de injeçcãao determina a vazãao de gas sendo injetada em cada poço a partir de um gas lift manifold (GLM) comum conforme mostrado na figura 5.2. O sistema de automacão deve operar os poçcos de forma otima sob condiçcãoes de alta disponibilidade de gas enquanto garante a operacão estavel durante períodos de baixa disponibilidade de g as.
1 Parte deste trabalho foi publicado em [36] e também faz parte do projeto de pesquisa Desenvolvimento de Algoritmos de Controle para Métodos de Elevação Artificial realizado em parceria com a Petrobras.
Poço 1
Poço 2
Poço 3
Poço 4
Poço 5
5.2.1	Obtenção da vazão de gás disponível para injeção nos poços
Uma das dificuldades na distribuição do gás procedente do sistema de compressão á garantir que o mesmo seja utilizado de forma otima enquanto se estabilize a pressao no gas lift mani-fold-GLM. Propoe-se uma estratágia que estabiliza a pressao no GLM e otimiza a distribuição de gás comprimido disponível entre os pocos conforme mostra a figura 5.2. Gas do sistema de compressãao entra no GLM a uma pressaão igual a pressãao nominal de descarga do ultimo compressor. Durante operacães normais, o sistema de controle do sistema de compressãao fornece uma vazãao de gáas suficiente para manter a pressaão no GLM alta o bastante para manter a vazão de injeçao de gas sem restrição para cada poço. Se por qualquer motivo a vazão de gás entrando no GLM diminui, a pressãao no GLM iráa cair se as vazãoes de injeçcaão de gáas para cada poçco forem mantidas em seus valores sem restriçcãao. Eventualmente as vazões sem restricão não poderão ser implementadas mesmo com a abertura total dos chokes de injeçao. Torna-se necessário uma estratágia que:
—	Estabilize a pressao no GLM em um valor proximo a pressão de descarga nominal do compressor no caso do evento de uma diminuição na vazao de injeçao entrando no GLM; e
—	Determine a vazão total de gas disponível para injecão nos poçcos conectados ao GLM.
O gas lift manifold-GLM conecta o subsistema de compressão e o subsistema de poços: Sua interação define a quantidade de gás de injeçao disponibilizada para os poços. Para que os poços possam operar nos seus pontos átimos irrestritos a pressão no GLM deve exceder a maior pressão de revestimento dentre todos os pocos como mostrado na figura 5.3. Isto permite uma queda de pressão na linha conectando o GLM ao anular dos pocos. Assume-se que uma estratágia de controle seja implementada no subsistema de compressaão de gaás para manter a pressãao no GLM na regiao verde (operacao normal). Tal estratágia depende da estrutura montada no sistema de produção (clientes para o gás e prioridades do operador do sistema). Um sistema de controle supervisáorio monitora a pressãao no GLM e atualiza seu estado para (1) normal (range verde), (2) normal mas testes não permitidos (range amarelo) e (3) operacçãao com restriçcaão na disponibilidade de gaás (range vermelho). Testes nãao deveriam ser permitidos na regiãao amarela jáa que existe uma grande possibilidade do sistema entrar na regiaão de operaçcaão com restricçãao. Apesar da existência do sistema de controle que visa manter a pressão na regiao verde (operação normal) á possível que falhas no subsistema de compressãao naão permitam a implementaçcãao da vazãao de gáas necessaária para manter todos os poçcos operando em seus valores de injecao irrestritos. Neste caso a pressão no GLM iria cair ao ponto de tornar-se impossável estabelecer uma vazãao de gáas do GLM ao anular dos poçcos. Obviamente uma açcaão tem de ser tomada antes que isso aconteçca. A solucçãao proposta imple-
Legend
Operação normal
2 Operação normal mas testes não permitidos
Operação com restrições
sem restrição para poços 1 :N
Figura 5.3: Controle da pressão no Gas Lift Manifold - GLM
menta um segundo controlador de pressao do GLM (Controlador
de Pressão do GLM-Pocos), PC2 na figura 5.4, que disputa o controle da pressão do GLM com o subsistema de compressão: enquanto o controlador do subsistema de compressão, PC1, atua no góas entrando no GLM, o segundo controlador, PC2, manipula a vazãao de gaós saindo do GLM quando o subsistema de com-pressao falha e a pressão no GLM cai abaixo da região verde e assume um valor menor do que o valor de referâencia do segundo controlador. O valor de referância (Pref) do segundo controlador e alto o suficiente para a operação irrestrita dos poços mas ligeiramente menor do que a pressaão nominal de descarga do subsistema de compressao conforme mostra a figura 5.3.
A saóda do controlador PC2 óe limitada a um valor igual a soma das vazoes de injeção ótimas irrestritas de todos os poços. Assim, enquanto a pressão do GLM for maior do que o (Pref) do controlador PC2, a açcãao de controle deste seróa constante e igual a soma das vazoães de injeçcãao óotimas irrestritas de todos os poçcos. A vazãao calculada pelo controlador PC2 óe implementada pelos controladores FC1, Fc2, ..., FCn.
A vazaão calculada pelo controlador PC2 óe informada a cada controlador local da vazaão de cada poçco que dispãoem de uma tabela de alocaçcãao, look-up table. Esta tabela relaciona a vazãao a ser implementada por cada pocço em funcçãao da vazãao de saóda fornecida pelo controlador PC2. Um algoritmo de otimizaçao é responsóvel por gerar as tabelas de alocações para cada poço calculando offline a vazãao de injeçcãao de góas a ser implementada por cada poçco em funcçãao da vazãao de gaós disponóvel. Cada poçco possui um valor de injecçãao mónimo de forma a evitar a operaçcaão na regiaão de ciclo limite devido aos fenâomenos heading ou density wave. Assim, a vazãao total mónima a ser implementada corresponde ao somatóorio da vazaão mónima de todos os poçcos. O controlador PC2 implementa uma estratóegia anti wind-up.
Enquanto a pressãao no GLM for normal, e portanto maior do que (Pref), a saída do controlador PC2 cresce e é limitada a um valor igual a soma das vazãoes de injecçaão óotimas irrestritas de todos os poçcos. Esta vazãao óe implementada atravóes da acçaão dos controladores locais que recebem a açcaão de controle de PC2 e obtóem seus valores de referencia através de uma tabela de alocação. Quando ocorre uma falha no subsistema de compressãao que diminui a vazãao de entrada no GLM, a pressãao começca a cair. Quando a pressao no GLM atinge valores menores do que (Pref) a acão
Poço 1
Poço 2
Poço N
GLM
Figura 5.4: Estrategia de controle da pressãao no GLM
de controle de PC2 age no sentido de manter a pressão no valor (Pref). Ao fazer isso a vazão calculada por PC2 se iguala a vazão de entrada. Esta vazao é informada a cada controlador local que atraves da tabela de alocaçcãao implementam as vazãoes otimas que estabilizam a pressão no GLM. No momento em que a vazão de gas entrando no GLM cresce a pressão no GLM tambem cresce e eventualmente ao atingir valores maiores que (Pref) fazem com que a vazãao calculada por PC2 retorne ao valor igual a soma das vazãoes de injeçcaão otimas irrestritas de todos os pocços.
A figura 5.2 mostra um gas-lift manifold para a distribuição de gas a um grupo de pocos operando por Injeção Contínua de Gas. Supõe-se que o duto que traz o gas ate o ponto de distribuição e o duto de distribuicão tem o mesmo diêmetro	e que
os elementos entre a valvula de entrada e as valvulas de saída conforme indicado pela linha tracejada na figura 5.2. A soma de todos os volumes dentro destes limites vãao compor um unico volume, representado na figura 5.5 que sera utilizado na modelagem da dinamica do gas-lift manifold.
Figura 5.5: Modelo simplificado do gas-lift manifold
Para a configuraçcãao mostrada na figura 5.2 o volume total seria obtido como
5
V =	+ $!L2 +	$í+2Li+2).	(5.7)
i=1
De forma geral para este tipo de configuraçcãao, considerando que os dutos de gas para cada poço podem ter diómetros ($p) e comprimentos (Lp) diferentes, teríamos
N
V = J(^1L1 + ^2L2 +	^PíLpí)-	(5.8)
i=1
O comportamento da pressaão no volume concentrado pode ser descrito aplicando-se a lei da conservaçcãao da massa,
dP RT
~di = MV(Qe - Qs)j onde	(5J)
—	P - Pressao, Pa
—	R - Constante universal dos gases, 8,3144126 Pam3mol/K
—	T - Temperatura, K
—	M - Peso molecular do gas, Kg/mol
—	V - Volume, m3
—	Qe - Vazão massica de gas de injecao entrando no volume, Kg/s
— Qs - Vazõo massica de gas de injeçõo saindo do volume, Kg/s.
Definindo kp = MV, e aplicando a transformada de Laplace na equaçcõao 5.9, obtem-se
— k
P (s) = —p (Qe(s) — Qs(s))	(5.10)
s
O controle da pressõo no gas-lift manifold pode ser realizado por uma estrutura de controle do tipo PI (Controle Proporcional Integral). A estrutura de controle deve ter acçõao anti-windup incorporada ja que em condicçõoes normais o controlador operara saturado. Para simplificar a analise da resposta do sistema de controle pode-se desconsiderar a estrutura anti-windup ja que esta funçcaõo e inoperante no momento da restriçcõao na disponibilidade de g as.
Figura 5.6: Estrutura de controle simplificada da pressõo do gas-lift manifold
A figura 5.6 mostra a estrutura de controle que sera utilizada para a síntese do controlador. E interessante mencionar que o principal objetivo de controle e manter a pressaão em seu valor de referância Pref. diante de perturbações na vazao de entrada Qe. Diante disso parte-se para a obtencçãao da funcçãao de transferâencia em malha fechada entre a variacão de pressao na saída AP e a variação na vazão de injecão de entrada AQe. A figura 5.7 mostra a estrutura de controle que ser a utilizada para analise da resposta à perturbaçao. Considera-se o sistema em equilíbrio e analisa-se a resposta à uma variação na vazão de entrada, AQe.
Figura 5.7: Estrutura de controle para analise da resposta à pertur-baçcaão
Escrevendo-se a relacão entre AP(s) e AQe(s) obtem-se:
—-
(-AP (s)C(s) — AQe(s))	= AP (s)
s
- -
AQe(s) - = AP (s)(1 — C (s) -).	(5.11)
ss
Pretende-se ajustar os parâmetros K e Ti do controlador PI
c (s) =
-K (Tis + 1)
Tis
(5.12)
Substituindo 5.12 em 5.11,
AP (s) AQe(s) AP (s) AQe(s)
kpTi s
Tis2 + KkpTis + Kkp ’
kps s2 + Kkps +
(5.13)
______kps______5qe
s2 + Kkps +	s
(5.14)
Aplicando-se o Teorema do Valor Final na equacão (5.14),
AP (to)
AP (to)
kps	5qe
lim s	,
s ' s2 + Kkps + Kk s
0.
(5.15)
A perturbação mais provével para a vazão de injeçao talvez seja do tipo rampa como mostrada na figura 5.8. Este tipo de sinal
representa uma diminuiçcãao da vazãao de entrada de gías do tipo rampa com uma duraçao igual a L numa taxa igual a —. No domínio Laplace este tipo de perturbação pode ser modelado
como	AQe(s) =	1 (1 - e-Ls)	(5.16) L s2
A aplicação deste sinal na equacão (5.13) fornece a seguinte per-turbaçcãao na pressaão de saída.
AP (s) = ■	kps	Kk ÔqTe 12 (1	e-LS)	(5.17) s2 + Kkps + KkP L s2
A aplicacão do Teorema do Valor Final ao sinal expresso pela equacão (5.17) tambem resulta em valor igual a zero indicando que este tipo de perturbaçcãao tambíem íe rejeitado em regime permanente.
Para analisar o efeito na pressão durante a perturbacão do tipo rampa, assume-se um sinal do tipo rampa de duracão infinita e
aplica-se o Teorema do valor final,
kps	5qe 1
lim — s________p___________—___
- s2 + Kkps +	L s2
^P(^) = — K Ô~L	(5.18)
A expressão (5.18) mostra a diminuição da pressão durante uma perturbacao do tipo rampa. E importante verificar que o efeito da perturbação rampa na pressão de saída depende dos parâmetros do controlador K. Ou seja a diminuicão da pressão na saída vai ser menor para um tempo de integraçao Ti menor e um ganho K maior. Como visto na analise da resposta para regime permanente verifica-se que a perturbaçcãao e anulada se o sinal e uma rampa de duraçcãao finita como a figura 5.8.
5.2.2	Controlador PI com ação Feed-Forward considerando a dinâmica da válvula
Em geral uma valvula naão responde imediatamente ao comando de abertura. Em alguns casos a modelagem considerando um atraso O na resposta é suficiente. Em realidade o que se pretende modelar é a relação em malha fechada do sistema de controle de vazão que incorpora a dinâmica do choke de injeção. A equação
(5.19)	mostra a funçao de transferância que sera utilizada para considerar a dinâmica do choke de producão. O comportamento dinamico do ckoke de injeção foi modelado como um sistema de primeira ordem com um atraso.
e-0s
FTMFchokeinj, =-----—	(5.19)
&amp;amp;v s — 1
O estudo da resposta do sistema ao controlador PI mostra que sua aplicacçãao rejeita, em regime permanente, perturbaçcoães do tipo degrau. Para perturbacçoães do tipo rampa, tâem-se uma queda de pressaão durante a ocorrâencia da mesma em um valor que depende da taxa da propria rampa e da relaçao K do controlador. No momento que a vazãao de entrada se estabiliza a pressãao volta ao seu valor de referância. Se desejarmos evitar uma queda de pressãao muito grande devemos diminuir o tempo de integraçcãao do controlador, Ti e aumentar seu ganho, K conforme mostra a
AQ,
Figura 5.9: Estrutura de controle incluindo dinâmica do choke de in-jeçcãao
equação 5.18. Sob o ponto de vista da robustez do sistema isto nao e uma boa opçao ja que, havendo erros de modelagem, não se pode diminuir a relacao T demasiado sob pena de instabilizar a resposta do sistema. Uma alternativa é a utilização de uma estrutura de controle feed-forward em combinacao com o controle realimentado conforme mostra a figura 5.10.
Figura 5.10: Estrutura de controle com ação feed-forward
Procura-se a aplicação de uma acão feed-forward FF(s) que aplicada no sinal da vazão de entrada e somada a ação de controle garanta erro proximo a zero durante a ocorrância da perturbação do tipo rampa.
Na obtençcaão do sinal a ser aplicado procede-se com a determi-naçao de (S) em funcao de FF(s). Uma vez obtida a função de transferância, obtem-se a expressao para AP(s) supondo uma perturbacao AQe(s) = —	, isto é, uma rampa com taxa — õ.
Finalmente determina-se a expressão para FF(s) que pratica-
mente elimina o erro em regime permanente para a rampa.
—k e-(0s)
[-AP (s)C (s) + AQe(s)(FF (s) - 1)] (p	= AP (s),
s(av s + 1)
(5.20)
C (s) = -K
Tis + 1
e es (&lt;7V s + 1)
Tis	’
,	• ■ s ^i - (0 +	)s = 1 - &amp;amp;T s,
e
- AQe(s)(FF(s) - 1)kp(1	QtS) =
s
AP(s)[1 + Kk-(T“ +T 1)2(1 - °Ts)].	(5.21)
Manipulando-se a equação 5.21 obtém-se
AP(s) = -	-s(FF(s) - 1)(1 - Qts)	(5 22)
AQe(s)	(-T- - TiQt)s2 + (Ti - Qt)s + 1'	(' )
Assumindo uma perturbacao do tipo rampa, AQe(s) = -e aplicando na função de transferência expressa na equaçao 5.22, tem-se
Ks(FF(s) - 1)(1 - Qts)	£
(-Tf - TíQt)s2 + (Ti - Qt)s + 1 s2 ’
K(FF(s) - 1)(1 - Qts)	ó
(TTf- - TíQt)s2 + (Ti - Qt)s + 1 s '
(5.23)
Aplicando-se o Teorema do valor final a AP(s) fornecido pela equacao 5.23,
AP (TO) :	K(FF(s) - 1)(1 - Ots)	õ '	(fTkf - TiOt)s2 + (Ti - Ot)s + 1 s’
AP (to)	= Um TK(FF(s) - 1)(1 - °t’)	õ, '	(Kf- - TOt)s2 + (Ti - Ot)s + 1 ’
AP (to)	= lim K(FF(s) - 1)õ	(5.24) s^0 K
De acordo com a equação (5.24) o efeito da perturbação do tipo rampa na pressão sera nulo em regime se
FF(s) — 1	=	0 para s = 0, ou
FF (0)	=	1	(5.25)
Uma função que atende a equaçao (5.25) é
FF (s) = kdS + 1.	(5.26)
as + 1
A escolha desta função alem de atender o objetivo de eliminar o efeito de uma perturbaçcãao do tipo rampa atende a recomendaçcãao classica de filtro feed-forward que e a de buscar inverter o efeito da planta. Ou seja, a vazão de entrada não é controlada pela valvula como a vazão de saída. A vazão de saída calculada pela acao feedforward e implementada pela valvula cuja dinâmica foi modelada por um atraso e uma funcão de transferância de primeira ordem. Não se pode inverter a funçao atraso mas pode-se buscar um numerador do filtro feed-forward que cancele em parte o efeito da funçcãao de transferâencia de primeira ordem da valvula. Diante disso o filtro feed-forward proposto é
FF (s) =	s + 1.	(5.27)
as + 1
5.2.3	Síntese dos parâmetros de um Controlador Robusto com acao FF
A tecnica utilizada na síntese dos parâmetros do controlador PI nas seçcãoes anteriores ée em geral considerada agressiva e pode ser justificada para este processo quando a estrutura de controle nãao utiliza açcãao feed-forward. Em realidade na ausâencia de açcaão feedforward seria recomendaével buscar um ajuste que de um lado minimize o efeito causado pela perturbaçcãao rampa e de outro oferecça robustez para erros de modelagem. O efeito da rampa na pressão é igual a K S, onde T e K sao respectivamente o Tempo de integracão e o ganho do controlador e S é a taxa da pertur-baçcãao rampa. Sabe-se que ao buscar um ajuste dos parâametros do controlador Ti e K que aumentem a robustez do sistema em malha fechada, a razão ? seria aumentada, aumentando assim o efeito da perturbaçcãao na pressaão do gas-lift manifold. Contudo no caso de se utilizar a açcãao feed-forward na solucçãao de controle, elimina-se a perturbaçcãao em regime para uma perturbacçãao do tipo rampa. Neste caso pode-se lancçar maão de téecnicas de ajuste do controlador PID mais conservadoras que garantam uma maior robustez na soluçcãao.
Uma téecnica interessante para o ajuste dos paraâmetros do controlador que considera o aspecto de robustez ée aquela proposta por Sigurd Skogestad, [107]. Neste trabalho demonstra-se uma téecnica de ajuste simples que ée refinada com consideraçcãoes sobre robustez. Aléem disso mostra-se a utilizaçcãao da téecnica para diferentes funçcãoes de transferâencia. A planta foi modelada como ~sP (r s+i). De acordo com a técnica proposta em [107] o controlador poderia ser um PID completo (com açao integral) ou um controlador PI no caso em que uv seja pequeno e possa-se representar o sistema como
,-@s
G(s)
g-Qr s
kp-----, com
s
+ ©•
(5.28)
Como av esperado e pequeno pois representa a dinamica do controle da vazão pelo choke de injeção, adota-se a representaçao do sistema pela funçao de transferencia da equaçao (5.28). Para o sistema assim representado o ajuste recomendado para um con-
trolador PI é dado pela equação (5.29),
1
K
kp(rc + ©y)’ Ti =	4(tc + ©t ).
(5.29)
Na equação 5.29 tc representa a constante de tempo desejada para o sistema em malha fechada. O procedimento pode ser então baseado na proposta de um tempo de estabilização desejado Test. que vai fornecer tc =	. A partir de um modelo nominal do
processo, (kp) e ©T pode-se buscar o menor valor de que garanta uma determinada margem de ganho e margem de fase para determinadas incertezas nos parâmetros.
5.2.4	Resultados obtidos com simulação na síntese do controlador robusto
Para analisar a proposta de controle discute-se nesta subseçcãao sua aplicaçao a um cenério mostrado na figura 5.2 onde 5 poços saão alimentados com gaés a partir de um gas-lift manifold com as seguintes caracterésticas
—	Volume equivalente= 1 m3
—	Vazão nominal de entrada= 33.2 Kg/s
—	Pressao nominal do gas-lift manifold = 24 MPa
—	Peso molecular do gas= 0.028 Kg/mol
—	Temperatura do gas= 300 K
A figura 5.11 mostra o efeito de uma perturbação rampa na vazão de entrada de gaés no manifold sobre a pressãao no mesmo utilizando a estrutura de controle mostrada na figura 5.2.2. O Controlador PI utilizado tem os parâmetros K = —1.1419e — 006 e Ti = 40.68. A simulação mostra o efeito de uma queda na vazao de injecao a uma taxa de 0.05 Kg/s/s no intervalo de tempo entre 600s e 900s. A queda de pressãao resultante pode ser calculada pela equacão 5.18,
AP
— —
-T- — = 1.7816e + 006 Pa, ou
K L
250
$240
CN 245
E
225
400
235
230
								
								
		\ AP=(Ti/K)8/L \	=18.16 Kaf/cm2						
								
								
500
600
1000
1100
700	800	900
Tempo [ s ]
1200
Figura 5.11: Efeito da perturbacõo rampa na vazao de entrada sobre a pressõao do gas-lift manifold
Tempo [ s ]
Figura 5.12: Efeito da perturbacao rampa na vazao de entrada sobre a pressao do gas-lift manifold utilizando acao feed-forward
A figura 5.12 mostra a reduçõo da variacao da pressõo no gaslift manifold quando utiliza-se acçõao feed-forward. Utilizou-se o controlador PI com os mesmos parametros e tambem a mesma perturbacao rampa com taxa de 0.05kg/s/s. A acõo feed-forward utilizada e a vazaõo de entrada depois de aplicado o filtro mostrado na equacõo (5.26). Utilizou-se uv = 2 e a = 0.1. Como ja mencionado, a utilizaçcõao da açcaõo feed-forward permite a utilizaçcõao de um controlador mais robusto às incertezas de modelagem en-
quanto diminui consideravelmente a variacçaão no valor da pressãao do manifold como pode ser visto na figura 5.12.
Síntese do controlador robusto
Nos desenvolvimentos a seguir considerou-se os parâmetros do modelo do choke como © = 1 e tv = 2. A equacao (5.29) mostra que ao aumentar-se o valor de tc aumenta-se o valor de Tj e diminui-se o valor de K. Isto significa em geral menor ganho do sistema de controle e maior robustez. Considerando que tc e a constante de tempo do sistema em malha fechada, pode-se escrever tc em funçao do tempo de estabilização, tc =	. Desta
forma pode-se fazer a analise da robustez do sistema em malha fechada em função do tempo de estabilizaçao desejado.
A síntese dos parâmetros K e Tj pode então ser realizada da seguinte forma:
Encontrar o tempo de estabilizaçao que fornece uma margem de ganho igual a MG considerando que existe erros nos parâmetros do modelo que minimizam a margem de ganho do sistema. Observando o modelo completo pode-se perceber que a margem de ganho e minimizada quando todos os paraâmetros sãao maiores do que o nominal. Ou seja, o caso onde o ganho do sistema kp é maior do que o ganho nominal kpN, o atraso é maior do que o atraso nominal ©vN e a constante de tempo tv é maior do que tvN e a combinacão que mais desestabiliza o sistema em malha fechada. Pode-se então definir um erro maximo esperado para cada parâmetro e buscar o Tempo de estabilizaçao que garante uma determinada margem de ganho MG. A partir do Tempo de estabilizaçcaão determinado calcula-se, utilizando-se tambem os parâmetros nominais do processo, kpN, ©vN e tvN os parâmetros do controlador PI, K e Tj.
Procedimento similar pode ser feito estabelecendo-se um pico de sensibilidade desejado
Ms
1
|1 + C(jw)H(jw)\'
(5.31)
A figura 5.13 mostra o conceito utilizado. A ideia é garantir uma distância segura entre a curva de Nyquist C(jw)H(jw) do ponto —1+j0 no caso em que os parâmetros do processo sejam diferentes
daqueles considerados no projeto do controlador. Esta distâancia e definida como r na figura 5.13, onde r =	•
Figura 5.13: Diagrama de Nyquist mostrando o conceito de pico de sensibilidade
Percentual de erro dos parâmetros [ % ]
Percentual de erro dos parâmetros [ % ]
Diagrama de Nyquist
0.1
0
-0.1
MG=2
Percentual de erro dos parâmetros [ % ]
+
Ponto -1+0j Ponto -0.5 +0j -----Curva para erro=+25% —e— Curva para erro=+50% —i— Curva para erro=+75% 0 Curva para erro=+100%
-0.3
-0.4
-0.5
-1	-0.8	-0.6	-0.4	-0.2	0
eixo real
Figura 5.14: Resultados do projeto do PI Robusto utilizando Margem de Ganho=2
A figura 5.14 mostra os resultados obtidos com o projeto dos
parâmetros K e T do controlador PI quando se estabeleceu uma margem de ganho igual a 2 para erros de modelagem de kp, 0v e tv desde 25% ate 100% de seus valores nominais. A ideia é mostrar que uma vez determinado o nível de incerteza nos valores destes parâmetros, pode-se obter os parâmetros do controlador ainda com uma margem de ganho. Nota-se que na medida que se supõe uma incerteza maior, menor e o ganho e maior e o tempo integral necessario para garantir a margem de ganho desejada.
a-Tempo de estabilização x erro
Percentual de erro dos parâmetros [ % ]
Percentual de erro dos parâmetros [ % ]
Percentual de erro dos parâmetros [ % ]
d-Diagrama de Nyquist
eixo real
Figura 5.15: Resultados do projeto do PI Robusto utilizando Pico de sensibilidade igual a 3.2
A figura 5.15 mostra o resultado obtido utilizando um procedimento similar mas baseado no pico de sensibilidade desejado. Para efeito de compararlo estipulou-se um valor de pico de sensibilidade desejado de 3.2 que, para este processo resulta em uma margem de ganho de aproximadamente 2. A utilizacao do pico de sensibilidade pode se mostrar mais interessante do que a margem de ganho pois garante de forma global uma determinada distâan-cia do ponto — 1 + 0j. A utilizacao da margem de fase junto com a margem de ganho pode oferecer um criterio semelhante ao do pico de sensibilidade. Deve-se observar que o procedimento desenvolvido nõao introduz nenhum conservadorismo ja que a funccaõo C(jw)H(jw) foi avaliada para a faixa de frequencia de interesse para cada valor de erro nos parâametros.
A figura 5.15-d mostra o Diagrama de Nyquist para cada L = Ci(jw)Hi(jw), onde i é o índice que representa o erro considerado que vai de 25% até 100% em passos de 25%. Conforme o valor do erro esperado, o controlador é ajustado para manter o valor do pico de sensibilidade desejado.
5.2.5	Implementação da Proposta para Automação de um Grupo de Poços
A figura 5.16 mostra um sistema de controle para um grupo de poços operando com elevação artificial por gas-lift proposto. Um gas-lift manifold recebe gés do sistema de compressão e deve distribui-lo para um numero de poços de forma a maximizar uma determinada funçao objetivo enquanto estabiliza a pressão no manifold. Isto deve ser feito tanto no caso em que hé disponibilidade para a operação no ponto ótimo da curva Pwf = f (Qinj.) de cada poçco, como tambéem nos casos em que ocorram diminuiçcãoes na vazao de gés sendo entregue ao gas-lift manifold. A estrutura de controle mostrada na figura 5.16 é uma representação em diagrama de blocos do sistema de controle em desenvolvimento. Percebe-se na figura diferentes elementos como
—	Controlador da Pressão PC2 no manifold de gas-lift. Este controlador cuja séntese foi discutida na subseçcãao anterior estabiliza a pressãao no manifold ao calcular a vazaão total de saéda a ser implementada pelos controladores locais de vazãao de injeção de cada poco. Sua estrutura final é mostrada na figura 5.17.
—	Controladores locais de vazão de injeção de cada poco, FC. Estes controladores recebem a tabela de alocaçao do Bloco Algoritmo de Otimização sempre que ocorre uma nova ger-acçãao de tabelas. Recebem tambéem constantemente o valor da vazao total disponével do Controlador da Pressão no Manifold PC2. Com essas duas informações o controlador FC determina o valor da vazãao de injeçcaão a ser implementada (referencia do controlador local).
—	Bloco Controle Supervisório. Este bloco e responsavel por coordenar a integracçaão de todos os elementos que participam do sistema de controle. Com base na leitura da pressãao do manifold de gas-lift, por exemplo, determina se os pocços podem entrar em regime de teste ou naão. Aléem disso, baseado
Figura 5.16: Sistema de Controle de Poços alimentados por um manifold comum
em uma estrategia pre-definida podem sugerir ao operador a realizaçcãao de um teste de poçco para atualizaçcãao da curva Pwf X Qinj..
—	Bloco Teste Automático de Poços. Este bloco é responsavel por realizar o teste de poçco quando autorizado pelo terminal do operador. Os testes são realizados de forma a minimizar o tempo de ensaio ao mesmo tempo que garantem a qualidade dos dados conforme sera discutido neste capítulo.
—	Bloco Algoritmo de Otimização. Este bloco é responsavel por calcular as tabelas de alocaçcãao de todos os poçcos sempre que recebe uma nova informaçcãao que impacta a alocaçcãao otima de gas. A principal informação é uma nova curva Pw f X Qinj. de um determinado poco recebida do bloco Teste Automático de Pocos. Dependendo da funcão objetivo selecionada, atualizações sobre os custos de compressao, tratamento de agua, valores atuais do oleo e gas produzido poderiam tambem iniciar o calculo de novas tabelas de alocação. Neste capétulo discute-se a implementaçcãao deste bloco.
—	Terminal do Usuário. Este terminal pode em realidade ser divido em mais de um tipo de forma a atender diferentes objetivos. Um tipo de terminal seria aquele para utilizaçcãao do operador. Este terminal poderia permitir um dialogo de alto nível entre o operador e o sistema automatico de controle onde o operador poderia aceitar ou recusar açcãoes propostas pelo sistema. O operador poderia, por exemplo, aceitar ou nãao a sugestãao do sistema em realizar um novo teste de um poçco. Poderia ainda aceitar o resultado do teste ou exigir a repetiçcãao parcial ou total do mesmo, aceitar a sugestãao do sistema em fazer a repartida de um poçco que foi fechado, etc. Um outro nével de terminal de usuario poderia permitir a visualizaçcaão das principais variaveis do processo como pressão no manifold de gas-lift, vazão de injecão de gas de cada poçco, etc. mas sem a possibilidade de intervençcãao do usuario.
Figura 5.17: Estrutura do Controlador PC2
Isto é possível pois os controladores locais teriam as informações necessárias para a tomada de decisõo sobre a vazõo étima a ser implementada em cada poco ou seja, a vazao total disponível informada pelo controlador local da pressao no manifold e a ultima tabela de alocaçao. Desta forma o sistema poderia manter-se operando por um longo tempo sem a necessidade da rede de controle. E claro que é o sistema de controle via rede que permite a atualizaçcõao dos modelos e a geracçaõo de novas tabelas de alocaçcaõo mas do ponto de vista operacional uma falha de comunicacõo da rede naõo impede o funcionamento do sistema.
5.2.6	Um estudo de caso para operação com restrição
Esta subseçcõao descreve a aplicaçcõao dos algoritmos de otimiza-çcaõo e controle desenvolvidos para um estudo de caso com modelos de poçcos derivados do simulador de escoamento multiféasico OLGAmR
O cenário é aquele representado pela figura 5.2 no início desta seçõo, onde 8 poços recebem gas de um unico GLM (Gas Lift Manifold).
Algumas características do cenario simulado sõo:
—	Volume equivalente: 1.0 m3
—	Pressõo nominal do GLM: 225.4 Kgf/cm2
—	Pressõo de referência do GLM sob restricõo: 224.4 Kgf/cm2
O estudo de caso considera somente a restrição na capacidade de compressão do sistema.
Cada poco possui um modelo de regime permanente relacionando sua vazão de injeção de gás com a vazão de oleo produzido.
A figura 5.18 mostra a alocacao de gas obtida com os modelos e a aplicaçcãao do algoritmo de otimizacçãao para todo o range de disponibilidade de gáas.
Figura 5.18: Carta de alocação de gas-lift
O objetivo da simulaçao é mostrar o desempenho completo do sistema de automaçao e otimização durante uma queda na disponibilidade de gas para injeção utilizando a estrutura de automação mostrada na figura 5.16. Para isso a dinâmica do GLM, dos chokes e dos poços foram modelados e implementados.
A figura 5.19 mostra a vazao de gas para injeção entrando e saindo do GLM. Como pode ser observado na figura, a estratégia de controle consegue distribuir a vazãao de géas saindo do GLM em um valor praticamente igual aquela que entra. A figura 5.20 mostra a pressãao no GLM.
Figura 5.19: Vazão mássica de gás entrando e saindo do GLM.
há praticamente nenhuma variacão na pressao do GLM para as diferentes disponibilidades de vazao de gás entrando no GLM.
A fim de mostrar a vantagem na utilização da açao Feed-Forward no controle da pressão do GLM, a figura 5.21 mostra a pressão no GLM quando utiliza-se o controlador sem ação Feed Forward.
Conforme discutido anteriormente, variacões na vazão de entrada do GLM do tipo rampa podem causar grandes variaçcãoes na pressãao do GLM com amplitudes dependentes dos parâmetros do controlador e da taxa de variacão da rampa. E muito importante manter a pressao no GLM tão perto quanto possível do seu valor de referência durante as operações com restrição na disponibilidade de gáas a fim de nãao permitir o acionamento do controlador utilizado para operaçcãao normal. A idáeia áe manter a pressãao no GLM em um valor ligeiramente menor do que o normal durante as operaçcãoes com restriçcãao de forma que o subsistema compressor continuaraá tentando aumentar a vazãao de gáas entregue ao GLM a fim de recuperar o controle da pressãao para o valor normal. Assim que o subsistema compressor entregue uma vazãao maior do que a vazaão de saturacão do controlador PC2, a pressão no GLM crescerá e será mantida no seu valor normal. Isto pode ser observado nas figuras 5.20 e 5.19. A sequencia de eventos simulada no estudo de caso acontece conforme abaixo. O sistema esta operando normalmente com o GLM na pressao normal de 225.4 Kgf/cm2.
Figura 5.20: Pressão no GLM com controle utilizando ação Feed Forward
Uma hora mais tarde acontece uma diminuição da vazão de entrada no GLM tipo rampa. O controlador PC2 reage e calcula a vazão a ser implementada (vazão de gas disponível) para manter a pressao no GLM em sua nova referência de 224.4 Kgf/cm2. A vazaão calculada pelo controlador PC2 e passada para os controladores locais de cada poço que possuem uma tabela de alocacão pre calculada e apresentada na figura 5.18. A acão simultanea dos controladores locais de cada poçco implementam a vazãao calculada que estabiliza a pressao no GLM e maximiza a producão de oleo para aquela disponibilidade de vazão de gas. Sete horas e um quarto mais tarde o subsistema compressor consegue entregar a vazãao de entrada no GLM elevando sua pressãao para o valor normal.
A figura 5.22 mostra o comportamento da pressão de fundo de todos os poços conforme a vazão de gas de injeção varia durante o estudo de caso. As pressoães sobem conforme o esperado durante as operacçãoes com restriçcãao na disponibilidade de gas para injeçcãao. A figura 5.23 mostra a porcentagem do total de gas disponível utilizado por cada poço e a figura 5.24 mostra a vazão de oleo produzida por cada poçco durante a operacçãao com restricçãao.
O comportamento dinêamico da vazãao de oleo apresentada na
Figura 5.21: Pressão no GLM com controle nao utilizando ação Feed Forward.
figura 5.24 é uma aproximaçao do que acontece na frente dos canhoneados. Os valores em regime permanente são mais representativos.
Figura 5.22: Pwf de todos os pocos
Figura 5.23: Porcentagem de gas utilizada por cada poço
								Poço 1	 		Poço 2 		Poço 3 Poço 4 	Poço 5 ■	 Poço 6 		Poço 7 	Poço 8	
								
								
		-						
								
								
								
								
								
									
								
Tempo [ h ]
1800
Figura 5.24: Produçao de óleo por poço
5.3	Um sistema de Controle automático utilizando a técnica de controle preditivo baseado em modelo PNMPC
Na seção 5.2 apresentou-se uma técnica para a automação de um grupo de pocos operando com elevação por GLC com o objetivo de garantir a distribuição otima de gas dentre os poços. Nenhuma ação de controle foi projetada para agir no sentido de modificar o comportamento dinâmico dos pocos. O algoritmo de otimizaçao garante que a vazão mínima implementada em cada poço seja superior ao valor que leva o poço ao comportamento com oscilaçães sustentadas típicos dos fenâmenos heading ou density-wave. As motivaçães para este tipo de solução são diversas:
—	A grande maioria dos poços operando via GLC nao dispoem de choke de produção com atuacao automatica dificultando a aplicaçcãao de tecnicas de controle avançcadas.
—	A operaçao de pocos com baixa vazao de injecão acarreta em significativas perdas de produção e por isso, a maioria das instalaçcãoes estãao bem equipadas com compressores reserva para evitar essas situaçcãoes.
—	Existem sistemas de superfície preparados para mitigar os efeitos das oscilacçãoes causadas por eventual diminuiçcãao na vazão de injecao de gas como os slug-catcher, por exemplo.
—	A utilizaçao de valvulas do tipo Venturi praticamente eliminam a ocorrência do fenâmeno heading. Por outro lado o fenâmeno density-wave não ocorre para pocos surgentes e acontece para vazãoes de injeçcãao muito baixas para poçcos operando em reservatórios com baixo nível de depleçao conforme mostrado no capítulo 2.2. A utilização de sistemas de recuperaçcãao via injecçãao de agua em pocços injetores contribui para a manutençcãao da pressãao de fundo dos poçcos.
Figura 5.25: Gas-lift manifold-GLM
a pressão no GLM. A maior parte desta trabalho foi apresentada em [44] e [54].
5.3.1	A formulaçao NMPC
Como ja mencionado, considera-se um conjunto de N poços operando via GLC com medição de pressão de fundo e equipados com mediçao e controle via choke da vazão de injeção de gas. Todos os pocços recebem gas de um GLM comum que nesta proposta de controle possui, alem das saídas para todos os pocos, uma saída extra para o queimador ou para recirculacão conforme a instalacão. Esta saáda é um mecanismo que permite ao gas ser descarregado em casos onde a vazãao de gas entrando no GLM e maior do que o necess ario para operar os poçcos em seus pontos otimos irrestritos.A vazão dessa saída sera referida como a vazão de excesso.
Para tal sistema mostrado na figura 5.25 desejamos
—	manter a pressão no GLM proximo ao seu valor de referência projetado de acordo com as necessidades dos poçcos,
—	distribuir a vazão de gas disponibilizada pelo subsistema compressor entre os poçcos de forma a maximizar um objetivo econêomico e
—	minimizar as oscilações na produção causadas pelas mudanças nas vazões de injeção de gás. Essas oscilações causam problemas aos processos de separacão.
Algumas restrições devem ser consideradas.
—	Manter a vazao de injecao de gás de cada poco maior do que um valor mínimo.
—	Manter a pressão no GLM entre um limite inferior e superior.
A tabela 5.1 apresenta a nomenclatura utilizada.
5.3.2	A função custo para o algoritmo PNMPC
A formulação da função objetivo a ser utilizada no algoritmo MPC Não Linear deve ser tal que sua minimização forneça os objetivos propostos. Os objetivos sao o econômico e o de comportamento dinâmico desejado.
Existem diversos objetivos econômicos que podem ser introduzidos como aqueles que consideram o valor diferenciado da pro-duçcãao de áoleo e gáas e o custo do tratamento da aágua produzida. Neste trabalho utiliza-se o objetivo econômico que considera o ganho devido a producao de áleo e o custo de compressão de gás para injeçao. Para isso define-se a função custo econômico
l = s£x [Po	- qAqini)) + Cc&lt;inj],	(5.32)
onde
—	N á o numero total de pocos,
—	Po é o preco do áleo,
—	Cc á o custo de compressão de gás.
As vazoes de injeção q*nj que minimizam o custo L, no caso de nãao haver restriçcãao na disponibilidade de gáas, podem ser obtidas calculando-se
" dL ■ dq1 ■ dLn		1 • • O O 	1
dL		0
dqN ■		
Tabela 5.1: Nomenclatura
Simb.	Descrição da variével	Unidade
qo1	Vazaão de oíleo do poçco i	stdm3 .d-1
qliq1	Vazãao de líquido do poçco i	stdm3 .d-1
qwl	Vazãao de aígua do poçco i	stdm3 .d-1
qg1	Vazaão de gías do poçco i	stdm3 .d-1
pWf	Pressãao de fundo do poçco do poçco i	kgf.cm-2
p	Pressãao míedia do reservatoírio	kgf.cm-2
PSat	Pressaão de saturacçaão do oíleo do pocço i	kgf.cm-2
qlSat	Vazao de líquido do poço i para pWf = p'lsat	stdm3 .d-1
ar í maa	Vazão maxima de líquido do poço i (pwf = 0)	stdm3 .d-1
qomax	Vazãao míaxima de íoleo do poçco i	stdm3 .d-1
qi - Vmi	Vazãao de injeçcaão de gías do poçco i	stdm3 .d-1
Qeqe	Vazao de excesso do GLM (queim. or recirc.)	stdm3 .d-1
PGLM	Pressao no GLM-Gas Lift Manifold	kgf.cm-2
sp pGLM	Pressão de referência do GLM	kgf.cm-2
PuP	Valor de pwf utilizado na normalizacçãao poçco i	kgf.cm-2
'iznj	Valor de qinj para pWf = pWf	stdm3 .d-1
...out qGLM	Vazaão maíssica de gaís saindo do GLM	kgs-1
qGLM	Vazaão míassica de gaís entrando no GLM	kgs-1
qGLM	Somatério de q^ de todos o pocos	kgs-1
w	Valor predito da variével w
Sémb.. Constante	Unidade
V	Volume equivalente do GLM	3 m
R	Contante Universal dos gases , 8.314472	Pa.m3 / Kmol
M	Peso molecular do gaís	kg.mol-1
BSW	Saturacçaão de aígua	-
GOR	Razão Gés-éleo	-
Isto resulta em
1- dqo^Çqlnj) -1		i oKüK •• 1	
d qinj ■ n	q)		
		
dqoN (qN)		Cc L Po	J
dÔiNj		
que é o mesmo resultado obtido pelo método equal-slope. O conjunto de vazoes implementadas é tal que qualquer ganho econômico com um aumento da vazao de injeção de gés em qualquer poco e superado pelo custo de compressão de gés. Para o caso sem restricçãao na disponibilidade de géas isto equivale a operar todos os poços no ponto da curva qo® = f (qlinj) onde a inclinacao seja igual a razão entre o Custo de Compressao por unidade de vazão de gas e o preco por vazao de óleo, C. No caso de haver restri-cçãao na disponibilidade de géas para injeçcãao o problema pode ser escrito como
min	L
q2 .	... qN. 1
inj	in. J
[ qinj
s. a
L = S^[(qoLx - qoi (qinj )) + kqinj]
k C
k = po
p o
yN qi &amp;lt;qdisp
pii= 1 inj	inj
(5.35)
A solução do problema expresso pela equação 5.35 pode ser obtida reescrevendo-se o problema utilizando-se o multiplicador de Lagrange A para inserir a restrição na equacão.
qi1
s.
L
min	L
q2	qN A l
qinj ' ' ' qinj A
inj
a
= S£1 [	- qopqínj)) + kq*nj + A
= r
Po
(5.36)
k
Devido a natureza convexa do problema a solução ótima global
pode ser obtida calculando o vetor [ q1 • q2nj • • • q^ A ] que satisfaz
- dL	-		
dqi ■		0
dL		0
dq^dj		
dL		0
dqN ■ dL		0
- dX .		
Aplicando-se 5.37 em 5.36 obtém-se
dq°1(q1„j)
Ôqinj
dqo^qijnj) dq2nj
dqoN (qNj) dqn
dL
dA
k + A
yN qi _ qdisP = 0 ^i=H inj "inj	v
(5.38)
k + A
k + A
A equacão 5.38 representa o método equal slope com restrição na disponibilidade de gas. Na sequência define-se os elementos necessários para a formulação da funçao objetivo econômica a ser utilizada no algoritmo de controle preditivo PNMPC. Como a função objetivo seré minimizada ao longo do horizonte de predição para as vazãoes de éoleo que sãao funçcãao da pressãao de fundo e das vazãoes de injecçãao ao longo do horizonte de controle héa a necessidade de se compensar os diferentes intervalos de tempo preditos. Aléem disso as predicçãoes sãao realizadas em funçcãao dos incrementos de vazão de injeçao Aqi • para cada poco. Define-se o vetor com os incrementos de vazao de injecão de cada poco i, AQi- como
AQexc — [	^qexc(k + 1) ' ' ' ^qexc(k + m 1)	.
(5.40)
O vetor com todos os incrementos de vazão saindo do GLM e escrito como
AQG„LM = [ AQ. )t (AQ2„j )T ... (AQNj )T	AQ ]T.
(5.41)
A perda de faturamento devido a operação abaixo da vazão ótima pode ser escrita como
Lp = PoSN=1Sp=1 (qomax - q°i(q'inj)(k + 3)) Ts.	(5.42)
Ja a perda de faturamento devido o custo de compressão pode ser expresso como
Lc =	(qtnj (k + 3)) Ts.	(5.43)
O problema da otimizacão da produçao pode ser colocado na funcão objetivo do algoritmo PNMPC como
min	L1	(5.44)
[ A&lt;. )T (Aq2„3- )T ••• (AQiAj )T (AQexc)T f
s. a
L1 = S"1 [S’_,	- W^íni)(k + j)) T.
+ PP "	(«inj (k + 3)) T.
O fator m compensa o fato de que a perda de producao acumulada e calculada no intervalo de tempo pT. enquanto que o custo da compressao de gas é calculada no intervalo de tempo mTs .
Para implementar a funcão custo na forma matricial define-se para cada poco i a perda de producao qoL,
«oL = q^max - «O^PWf )&gt;	(5.45)
onde qol(pwf)) é a vazão de oleo calculada em função do valor predito de pWf. Com o intuito de escrever a funçao custo na forma
matricial monta-se o vetor com as perdas de produção de todos os i poços no horizonte de predição p.
Q°l = [ qoL(1) ••• «°l(p) ••• q°L(i) ••• q°L(p) ]T
(5.46)
A fim de minimizar as oscilaçães nas vazães de producão coloca-se na funcão objetivo um termo igual ao somatório do quadrado da derivada das perdas de produção de todos os poços ao longo do horizonte de predicçãao.
l=. y
i= 1 j =
dt
(5.47)
A derivada da vazãao de todos os poçcos ao longo do horizonte de prediçcãao pode ser obtida de forma matricial utilizando a matriz T equivalente ao operador A = 1 — z- A Em sua forma original a matriz Toeplitz equivalente ao operador A = 1 — z-1 ó escrita
como
	1 -1	0 1	0 0	0 0	...	0 ...	0
D =					... 0
	0	0	0		-1 1
(5.48)
A utilizaçcaão dessa matriz pressupãoe que o elemento que antecede o vetor ao qual ela seria aplicada tem valor nulo. Para a utilizacão pretendida neste trabalho ó mais natural supor que no final do horizonte de prediçcãao a derivada da perda de produçcãao sera muito pequena. Assim, utiliza-se uma matriz Toeplitz modificada, T que considera a uóltima derivada nula.
	-1 0	1 -1	0 1	0 0	...	0 ...	0
T =					... 0
	0	0	0		00
(5.49)
Finalmente pode-se apresentar o problema de otimizaçao a ser
resolvido pelo algoritmo PNMPC,
min	J (5.50)
[	)T (AQ?„j )T ... (AQ^j )T (AQexc)T ]T
s. a
J = WiQÕl + W2QGÍm +
(PGlm - PGLM)TW3(PGlm - PGLM)
+ (tqgl)t W4 (tqg^ + (AQGLm )t W5AQG“Lm ,
Qout	min
GLM &gt; QGLM
PD max
GLM S P GLM P~	D min
GLM &gt; P GLM
Os primeiros dois termos da funçao custo implementam o objetivo econômico, o terceiro termo forca a pressão no GLM para seu valor de referencia, o quarto termo minimiza as oscilacoes na perda de produção o que tem o mesmo efeito que minimizar as variaçães na produçao de óleo. O quinto termo minimiza as mudanças nas vazoes de injecão dos poços e da linha de excesso. Os vetores Wi e W2 podem ser ajustados para implementar o objetivo econôomico e ponderar os custos de compressaão e faturamento com a produçao de oleo. As matrizes W3, W4 e W5 devem ser ajustadas para a obtençcaão do comportamento dinôamico desejado frente ao objetivo principal que óe o econôomico.
Obviamente que uma ponderaçcãao excessiva nestas matrizes pode resultar em um resultado econôomico pior durante o comportamento transiente no momento de uma restricçãao na disponibilidade de góas para compressãao. Mas, quando bem ajustadas, pode-se obter um comportamento dinôamico mais suave das vazãoes de óoleo e uma produçcaão igual ou maior do que a que seria obtida sem a aplicacão de controle. Deve-se observar que em regime permanente os termos 3, 4 e 5 vão a zero e atinge-se o resultado econôomico de regime permanente.
Não se aplicou restrições nos valores máximos das vazões saindo do GLM mas poderia ser feito sem dificuldades. As vazões de injecao nos poços poderiam ser limitadas a um valor ligeiramente maior do que a vazão que induz a maior produção de oleo. Isto seria uma garantia a mais que nao se operaria de forma muito ineficiente no caso de alguma falha e deixaria uma margem para utilizaçcãao no controle das oscilaçcãoes.
Aplica-se tambem restrição na pressão do GLM. Apesar do algoritmo de controle ser normalmente capaz de manter a pressãao no GLM muito proxima do valor de referência, optou-se por introduzir uma restriçao em seu valor mínimo e maximo correspondendo a uma faixa de 5 % para baixo e para cima respectivamente do valor de referêencia. A pressãao no GLM e vital para que se possa realizar as vazoães de injeçcaão.
O modelo utilizado para prediçao da pressão de fundo utilizado é descrito no capítulo 2.2, seção 2.2.3. Este modelo fornece uma re-laçcãao pressãao de fundo-vazaão de injeçcaão em regime permanente de alta qualidade. Este modelo de regime permanente foi utilizado em uma representação Hammerstein modificada onde o comportamento dinêmico é dependente da vazão de injeçao. Para a pressão no GLM utilizou-se o modelo apresentado no capítulo 2.2, seçao
2.2.2.
5.3.3	Sintonia do algoritmo PNMPC
Para testar a aplicaçao do algoritmo PNMPC no controle de um grupo de poços, um total de 4 pocos foram modelados. Esses poçcos foram primeiramente modelados e simulados em um software da Petrobras desenvolvidos para a simulação de pocos operando via GLC em regime permanente. Os dados obtidos com este simulador foram utilizados para ajustar a relaçao pwf x qinj em regime permanente descrita no capítulo 2.2, seção 2.2.2. Os pa-rêametros que definem o comportamento em regime permanente dos pocos sao descritos na tabela 5.2. Em seguida um modelo dinêamico hipotetico foi acrescentado a cada poçco na formulaçcãao Hammerstein descrita no capítulo 2.2, seção 2.2.3.
Uma forma de sintonizar os parâmetros da funcão objetivo do algoritmo PNMPC e iniciar com as ponderaçcoães para os dois primeiros termos que representam o objetivo econêomico. Em seguida as ponderacçãoes dos demais termos saão ajustadas para
Tabela 5.2: Dados dos poços				
Parâametro	Pocço 1	Pocço 2	Poçco 3	Poçco 4
qmax[ m ]	871.38	7.739e+003	5.177e+003	1.558e+003
BSW	0.341	0.676	0.03	0.488
P*wf [kgf/cm2 ]	110.0	185.1	182.9	146.5
q*inj [mi/d]	8.33e+4	1.859e+5	2.661e+5	9.98e+4
P [kgf/cm2]	203.7	199	217.2	205
ai	.9038	0.067	0.4003	0.3885
a2	3.5039	8.0042	0.6133	5.8235
a3	0.9666	0.9972	0.7751	0.9972
a4	0.0075	0.0026	0.0082	0.0052
m	0.56	1.11	0.09	1.04
balançcar os obj etivos atenuacçãao de oscilaçcãoes contra o objetivo econômico. Os parâmetros de sintonia utilizados são mostrados na tabela 5.3.
Controlar o sistema composto pelo GLM e pocos tem uma grande vantagem de eliminar a restriçcãao na disponibilidade de gaás do problema de alocação ja que todo o gás distribuádo á aquele que mantám a pressão no GLM em equilíbrio e portanto é a vazão disponável a cada momento. Muitos estudos sobre a otimizaçcaão de poçcos operando por GLC consideram a a disponibilidade de gás como uma restrição mas não indicam como esta informação seria disponibilizada. Uma outra vantagem desta tecnica é a possibilidade de aplicar otimizaçcaão mesmo durante os transientes que podem ser mais ou menos frequentes dependendo das instalaçcãoes e caracterásticas dos pocos. O comportamento dinamico da pressão no GLM áe altamente dependente do volume interno dos dutos associados e áe normalmente mais raápido do que as pressãoes de fundo dos pocos. No caso de utilizar-se um tempo de amostragem unico para todas as variáveis há de se considerar a dinamica da pressão no GLM para a escolha. Para evitar horizontes de prediçao muito grandes para a variável qoL decidiu-se montar o vetor de predi-cçãoes com valores a cada 3 instantes de amostragem o que resultou em um horizonte p igual a 150.
Tabela 5.3: Sintonia dos parêmetros do Algoritmo PNMPC		
S ímbolo.	Descrição da variável	Valor
Ts	Tempo de amostragem	5s
m	Horizonte de controle	3
P	Horizonte de predicão para qoL	150
P1	Horizonte de predicao para Pglm	18
W1	Elementos do vetor Wi 1 x 4p	0,020
W2	Elementos do vetor W2 1 x 5m	5e-4
W3	Elementos da diagonal da matriz W3 p1 x p1	(1)
W4	Elementos da diagonal da matriz W4 4p x 4p	(2)
W5	Elementos da diagonal da matriz W5 5m x 5m	(3)
1.	w3(i) varia linearmente de 1 to 10 para i = 1 : 18
2.	w4(i) e funcao linear da vazao massica de gas normalizada (em relaçao a qlQLM) entrando no GLM. 1 para qGnLM°rm = 1 e 12 para 7“™ = 0.25
3.	w5(i) = 1x10 5 para i=1:12. Para i=13:15 utilizou-se uma funcao
linear da vazao massica de gas normalizada entrando no GLM, qaLM°rm.	(i, i) varia de 1x10 5 para 7^—°™ = 1,0 a
15x10-5 para 7^°™ = 0.25.
5.3.4	Resultados obtidos
A fim de testar a estrategia proposta simulou-se uma operação de 24 horas cobrindo diferentes disponibilidades de gas para injeção. Assumiu-se um volume equivalente do GLM (soma de todos os volumes internos dos dutos associados ao GLM) igual a 1 m3. Cada poço possui um valor de injecão de gas que corresponde aproximadamente ao valor que induz a maior producão de oleo. Os valores da pressao de fundo e vazão de injeção correspondente a este ponto recebem o sobrescrito *. As pressões e vazões de cada poçco sãao normalizadas com relacçãao a esses valores.
A figura 5.27 topo mostra a pressão de fundo de todos os poços (valores normalizados) e a pressão no GLM (normalizada em re-laçao ao valor de referência). Pode-se observar que as pressães variam suavemente devido a acçaão do controle. A pressaão no GLM apresenta uma pequena mudança em relacao a referência nos momentos de mudançca na vazãao de entrada no GLM do tipo rampa mas nao ultrapassa os valores da restricão. A figura 5.27-base
1.2
1
0.8
0.4
É
E O cr
0.2
0	2	4	6	8	10 12 14 16 18 20 22 24
Tempo [ h ]
Figura 5.26: Vazão de gás normalizada entrando no GLM
mostra as vazãoes de gas de todos os poçcos e a vazaão de excesso de gas. E interessante observar que quando a vazãao de gas entrando no GLM vai a 110% do seu valor nominal a vazão de excesso cresce para manter a pressaão no GLM em seu valor de referêencia e para evitar perda de produção. Quando a vazão de gas entrando no GLM decresce de 50 % para 25 % de seu valor nominal, a vazãao na linha de excesso ajuda a evitar mudançcas bruscas na vazãao de injecçaão dos poçcos que causariam uma oscilaçcãao excessiva na vazaão de producçãao de oleo. Este comportamento pode ser ajustado atraves da sintonia dos parêametros da funçcãao custo.
Figura 5.27: Pressão no GLM e no fundo dos pocos x vazões saindo do GLM
produçao de óleo de todos os poços é mostrada na figura 5.29. As curvas com as linhas sólidas foram obtidas com a simulação utilizando o controle de oscilações enquanto que as curvas com linhas tracejadas são resultados da simulação sem aplicação de controle de oscilacao. O poco 3 ó o principal produtor. E interessante notar que a queda na produçcaão nãao óe muito afetada pela diminuiçcãao na vazaão de góas entrando no GLM devido a alocaçcaão apropriada feita pelo algoritmo PNMPC. Apesar de haver pouco grau de liberdade para aplicaçao de controle (somente manipulacão nas vazães de saída do GLM) todos os objetivos de controle foram atingidos: 1) distribuição ótima de gós, 2) controle da pressão no GLM e 3) atenuacçãao das oscilaçcãoes na producçãao de óoleo.
Figura 5.28: Vazao de producao de óleo de todos os pocos
Figura 5.29: Vazao de producao de óleo de cada poco
5.4	Conclusões e desenvolvimentos futuros
O monitoramento permanente de pressão e temperatura de fundo de poçco estóa se tornando uma realidade para novos poçcos. Alóem disso a maioria dos novos poçcos óe tambóem equipada com chokes de injeçao com controle automatizado. Neste capítulo apresentou-se duas abordagens para o controle de um grupo de poçcos operando via GLC. A primeira abordagem ignora o comportamento dinâmico dos poçcos e pode ser utilizada sempre quando a disponibilidade de góas comprimido para injeçcãao permite o funcionamento dos poçcos com vazãoes de injeçcaão bem maiores do que a vazãao que leva o poçco ao funcionamento com oscilaçcoães sustentadas. A tóecnica de controle preditivo PNMPC apresentada e aplicada no controle de um grupo de poçcos operando via GLC contempla a operacçãao dos poçcos para grandes restricçãoes na disponibilidade de góas comprimido para injecão. Nesses casos os pocos exibem um comportamento bastante oscilatoório da pressãao de fundo que se traduz em produçcãao tambóem oscilatóoria. Ainda que essas oscilaçcoães tendam a desaparecer com o tempo se as vazãoes de injeçcaão de gaós forem mantidas constantes, nos momentos das mudancças elas podem prejudicar bastante o processo de separaçcaão das fases óagua, óoleo e góas. A soluçcãao de controle utilizando o algoritmo PNMPC óe mais geral e poderóa ser implementada em futuros poçcos propiciando operacçãoes mais rentóaveis e seguras. Alguns desenvolvimentos futuro nesta óarea saão
—	a incorporacão de requisitos de desempenho do processo de separacçaão óagua, óoleo e góas na funçcaão objetivo do algoritmo de controle nãao linear PNMPC apresentado. No lugar de minimizar as oscilaçcoães nas vazãoes de produçcãao com a expectativa de melhorar o processo de separaçcaão, poderia-se minimizar diretamente as variaçcãoes nas variaóveis dos separadores como interface de óagua-óoleo, nóvel de óoleo e pressãao do separador,
—	desenvolver estrategias para a manutencao da operacão dos poçcos mesmo quando a vazãao de góas para injeçcaão óe menor do que o somatóorio das vazãoes operacionais mónimas de dada poço. Vazão operacional mínima sendo a vazao que leva cada pocço a desenvolver oscilaçcoães sustentadas devido ao fenâmeno heading ou density-wave. Uma abordagem seria
o desenvolvimento de táecnicas de controle chaveado semelhantes a utilizadas no capátulo 6 para eliminar as oscilações para vazãoes de injeçcãao menores do que as vazãoes operacionais mánimas. Um sistema supervisoário poderia comutar o sistema de controle do poçco entre o controle individual baseado em controle chaveado e controle PNMPC em funçcaão da disponibilidade de gáas disponável. Obviamente mesmo com a utilizaçcãao de controle chaveado a operaçcãao do pocço seráa pos-sável para uma determinada faixa de vazao media de gás, abaixo da qual o poço teria de ser fechado. A aplicação da táecnica poderia garantir o funcionamento do pocço para menores disponibilidades de gaás em relaçcãao a estratáegia de fechar o poçco para vazoães disponáveis práoximas a vazaão operacional mánima.
Controle aplicado a pocos operando via GLC
254
Capítulo 6
Controle de escoamento em risers
6.1	Introdução
O Transporte de fluido multifasico (áleo, água e gás) á um procedimento importante na induástria do petráoleo. Atualmente háa uma tendêencia em aumentar o nuámero de poçcos atendidos por uma mesma plataforma ou sistema de produçcaão assim como o comprimento dos risers entre o conjunto de poços e o sistema de producçãao. O escoamento simultêaneo de láquido e gáas em dutos pode apresentar um fenomeno chamado slug-flow que á caracterizado pela distribuicçãao intermitente de gáas e láquido ocupando grande parte do duto. As oscilaçcoães nos náveis de pressãao e vazãao durante o fenêomeno slug-flow podem provocar efeitos indesejáaveis nos dutos e equipamentos de superfácie. Essas oscilaçcãoes podem causar problemas sáerios na entrada dos separadores multifaásicos, por exemplo, deteriorando a qualidade da separaçcãao assim como transbordamento, [108]. Técnicas de controle automático realimentado podem ser utilizadas para a supressaão deste tipo de oscilacçãao. Como resultado obtáem-se vazãoes estaáveis nos risers e minimiza-se o problema nos separadores multifaásicos. Ao mesmo tempo pode-se operar com menos custo energáetico e uma melhor utilizaçcãao da capacidade dos equipamentos instalados aumentando a produçcãao.
Um diagrama esquematico de um riser utilizado em um sistema de produção offshore é mostrado na figura 6.1 com os parametros utilizados apresentados na tabela 6.1. A operaçao deste sistema foi simulado no OLGA1 *. Na figura 6.1 as pressões no fundo e no
Figura 6.1: Instalacão do riser simulado no OLGA.
Tabela 6.1: Parâmetros utilizados na simulacão do riser
Parâmetro	valor	unidade
Vazão massica entrando no riser	5	Kg.s-1
Pressão no separador	5.106	Pa
Fração de vazio	5	%
Temperatura na saída do riser	22	o C
Temperatura na entrada do riser	62	o C
topo do riser, respectivamente Pi e P2, sao medidas e utilizadas para calcular uma ação de controle que é aplicada no choke. A
1 Software para simulação de escoamento multifásico comercializado pela Scand-
power
modelagem deste sistema áe bastante complexa. Um procedimento usual consiste em utilizar equaçcãoes diferenciais parciais que expressam as leis de conservaçcaão de massa, energia e movimento para os fluidos presentes e modelos matemáticos de elementos como o choke, por exemplo. Um modelo simplificado baseado em um sistema com 3 equaçcãoes diferenciais ordináarias e 3 estados pode ser encontrado em [109], [110].
Figura 6.2: Abertura do choke como parâmetro de bifurcacao - Um ciclo limite estavel desenvolve-se a partir de uma Bifurcação Hopf Su-percrática (HBsup).
O diagrama de bifurcaçcãao considerando a abertura do choke como o parâametro de bifurcaçcaão áe apresentado na figura 6.2 e foi obtido com os resultados da simulação do sistema de riser apresentado na figura 6.1 no simulador OLGA2000. Nesta simulaçcãao utilizou-se uma vazao mássica na entrada do riser de 5Kg.s-1 e considerou-se uma pressao no separador de 5.106Pa. O diagrama de bifurcação da figura 6.2 á qualitativamente similar ao diagrama mostrado em [109].
A variedade de equilábrios estáaveis e instáaveis áe apresentada na figura 6.3. Nesta figura mostra-se tambem as curvas correspondendo aos valores máaximos e mánimos do ciclo limite. A pro-jecçãao dos ciclos limite para diferente aberturas de choke no plano (P1, P2) á apresentada na figura 6.4. Pode-se observar nesta figura que a relação entre as pressões Pi e P2 no manifold de equilábrio estaável pode ser aproximada por uma reta.
Como pode ser visto nas figuras 6.2-6.4, uma Bifurcaçao Hopf
Figura 6.3: Diagrama de bifurcação no plano (u(í),Pi)
Figura 6.4: Diagrama de Bifurcaçao no plano (P-í,P2)
supercrítica desenvolve-se no ponto HBsup dos diagramas dando origem a um ciclo limite estaável.
Maior pressõo para uma mesma vazõo massica significa maior consumo de energia necessaria para o bombeamento do fluido. Por outro lado, risers conectados diretamente a pocços poderiam aumentar a pressõao na frente da zona produtora causando a diminuiçcõao na produçao de oleo. Qualquer que seja o caso é desejavel operar o riser com uma vazõao nõao oscilatoria e com uma queda de pressõao mínima no choke de superfície.
Diversas leis de controle lineares tem sido propostas para prevenir oscilacões devido ao fenêmeno slug-flow em risers submarinos como em [110] e [108].
Esses controladores lineares sõo soluções validas para uma faixa de operacçõao muito estreita e pode-se dizer que sõao soluçcoões locais para um problema naõo linear complexo. Propõoe-se neste trabalho uma soluçao alternativa baseada na Teoria de Controle de Modos Deslizantes (Sliding Mode Control) de sistemas nõo lineares.
Este capítulo é organizado como segue. Na secõo 6.2 a lei de controle Proporcional Integral (PI) é revisitada mostrando que nõao e robusta para perturbaçcoões na vazaõo de entrada do riser. Nas secões 6.3 e 6.4 propõe-se diferentes estrategias SMC para controlar as oscilações devido o fenêmeno slug-flow. A estrategia SMC washout é apresentada na seção 6.5. No final discute-se algumas limitacçoões do metodo de controle proposto e propõoe-se melhoramentos futuros.
6.2	Revisitando a estratégia PI para suprimir slug-flow
Nesta secçãao mostra-se atraves de simulacçãoes que a lei de controle pi naão e robusta para perturbaçcoães na vazãao de entrada do riser. Uma simulação foi realizada para avaliar a eficiencia da lei de controle PI dada por
implementada é dada por
u(k) = u(k — 1) + soe(k) + sie(k — 1)
onde s0 = kc(1 + jjs), si = —kc, Ts = 1s é o tempo de amostragem e Ti e o tempo de integracao. A sintonia do controlador PI foi realizada utilizando regras simples de ajuste uma vez que não se dispõe de um modelo matematico de baixa ordem do processo.
Figura 6.5: Resposta do sistema controlado pelo PI para perturbações na vazão de entrada (5Kg.s-1 para 3.5Kg.s-1)
A simulaçao foi realizada com as seguintes características:
1.	a abertura do choke foi fixada em 20% e o ponto de operação calculado a partir da curva do manifold de equilibrio e caracterizado por (P*,P% ) = (6.93 • 106 [Pa], 5.56 • 106 [Pa]);
2.	em 5000s o controle e ligado;
3.	uma perturbação na entrada do riser e aplicada em 15000s;
4.	o controle e desligado em 25000s.
Figura 6.6: Resposta do sistema controlado pelo PI para perturbações na vazao de entrada (5Kg.s-1 para 3Kg.s-1)
primeira perturbaçõo e na figura Fig.6.6 para a segunda pertur-baçõo. Como pode ser observado, o controle PI rejeita a primeira perturbaçõo mas nõo é robusto o suficiente para a segunda per-turbacõo. A fim de atacar a dificuldade causada por grandes variações de vazõo na entrada do riser, propõe-se três diferentes estratéegias de controle baseadas em Controle de modos deslizante (Sliding Mode Control-SMC) nas secões seguintes.
6.3	Estratégia Slug SMC
A ideia principal ée projetar uma lei de controle de modos deslizante (SMC) que induz uma bifurcaçõo grazing-sliding no sistema, [111], mudando sua dinâmica e, desta forma, controlando a amplitude do ciclo limite. Este tipo de bifurcaçõo nõo suave introduz movimento deslizante parcial ao longo da superfécie deslizante, reduzindo ou suprimindo a amplitude do ciclo limite nõao desejado. Para explicar essas ideias, considere um sistema geral definido por
x = F (x,u(x))	(6.1)
onde x G Rn é um vetor de estados de dimensõo n, e u(x) G R é
o sinal de controle. A função F(x) = (Fi, F2,Fn) : Rn Rn, representa um sistema contínuo não suave. Assume-se que como resultado de uma Bifurcação Hopf (contínua ou não, [112]), o sistema exibe um comportamento oscilatório em regime permanente, onde um ciclo limite estóvel ó a solucão da equação 6.1.
A bifurcacão grazing-sliding para suprimir um ciclo limite ocorre quando o ciclo limite ó atravessado por uma superfície deslizante que gera uma transiçcãao nãao suave grazing-sliding onde parte da trajetória do ciclo limite permanece na superfície deslizante como mostrado na figura 6.7.
Figura 6.7: Bifurcacao Grazing-sliding induzida no sistema
Por exemplo, em um sistema com dimensão 2, considere-se a regiao Si da forma
51	:= {x = (xi, X2) : X2 &gt; m}
para um m arbitrório, sendo
S := a(x) = {x = (xi, X2) : X2 = m}
e
52	:= {x = (xi,x2) : x2 &amp;lt;m}.
Com a variaçao de m, acontece uma bifurcacão grazing-sliding e a amplitude do ciclo limite óe reduzida ou mesmo eliminada. Assim, o controle de modo deslizante sugerido óe
u — u0 + Au sgn(a(x))	(6.2)
onde ofx) — 0 e a superfície deslizante, uma funçao dos estados do sistema que permite a mudança de sua dinâmica; u0 e o valor da variavel de controle no ponto de operacão e Au e o valor maximo que a variavel de controle pode assumir a partir de u0. A funçao sgn(-) pode ser definida como
ou
sgn(a(x))
se a(x) &amp;lt;0; se a(x) &gt; 0.
(6.3)
sgn(a(x))
0, se a(x) &amp;lt;0;
1, se a(x) &gt; 0.
(6.4)

Aplicando as equaçães acima, propoe-se a seguinte lei de controle dada por
u — u0 + Au sgn(a),	(6.5)
a(P1,P2) — P2 — P1 + p
(6.6)
onde p = P* — P2*; Au = u0 — umin; u0 é a abertura desejada para o choke e umin é o valor da ação de controle no ponto de Bifurcação de Hopf. A superfície de chaveamento é definida como P2 = P1 — ft e define-se sgn(-) para fechar o choke sempre que a &gt; 0. O bias da abertura do choke u0 é definido no ponto de operaçao desejado. Neste ponto P*, P2* sao definidos na curva do manifold de equilíbrios para uma dada vazão massica de entrada no riser como mostrado na figura 6.3.
A escolha do valor bias da abertura do choke de superfície deve considerar dois fatores. Por um lado o valor deveria ser grande o suficiente a fim de garantir uma queda de pressao mínima no choke. Por outro lado o bias não deveria estar muito longe dos valores que podem causar quedas de pressãao significativas no choke a fim de poder responder rapidamente às perturbacões. A abertura do choke perto de 100% causa uma queda de pressão mínima mas dependendo das características do choke uma queda de pressão significativa no choke pode ser obtida somente para valores menores de 10%. A estrategia de controle pode ser interpretada como um mecanismo que forçca um escoamento hipotetico em regime permanente que seria obtido sem o comportamento slug-flow. Para uma vazão massica de entrada de gas e líquido constante a pressão Pi pode ser expressa como Pi = P2 + onde
p levaria em conta os termos devido a gravidade e atrito para um pseudo escoamento estavel. Para um modelo homogêeneo simplificado de escoamento no riser pode-se escrever
(6.7)
onde A é a seção do duto; mgr e mlr sao a massa do gas e a massa do líquido no riser; p é a densidade media do fluido; v e a velocidade media do fluido no riser; h e a comprimento do riser; f é o fator de atrito; dr é o diametro do riser. Na equacao
6.7	o primeiro termo corresponde a contribuiçao da gravidade e o segundo ao do atrito. A qualquer momento em que o relacionamento entre P1 e P2 dado pela equacao 6.7 e violado, uma ação é tomada na abertura do choke para forçar o relacionamento P1, P2 desejado. Obviamente isto é feito de uma forma que forneça uma abertura de choke desejada que minimiza P1 e consequentemente a energia utilizada para elevar o gas e o líquido entrando no riser. A resposta temporal em malha aberta é apresentada na figura 6.8. Em t = 5000s o sistema de controle proposto é ligado. Em t = 15000s uma perturbaçao na vazão de entrada (de 5Kg.s-1 a 3.5Kg.s-1) foi aplicada. Pode-se observar na figura 6.8 e 6.9 que a amplitude das oscilaçães é diminuída em torno do ponto de operaçcaão quando o controle e ligado.
Como pode ser observado na figura 6.8, apos o desligamento do controle, em t = 250000s, as oscilações retornam ao sistema. O diagrama de espaço de estados, no plano (P1,P2), é apresentado na figura 6.9.
A tecnica de controle SMC proposta opera bem para pequenas perturbaçcãoes na vazãao de entrada do riser mas a acçãao de controle chaveia permanentemente para manter o equilíbrio no ponto de operaçcãao.
Figura 6.8: Resposta do sistema no tempo com a estratégia de controle SMC (Malha aberta e com controle realimentado aplicado). a) abertura do choke; b) estados do sistema
Figura 6.9: Diagrama de espaco de estados no plano (P1; P2)
A ideia é combinar duas leis de controle (i) o controle utilizado na seção 6.3 e (ii) uma forma discreta da lei de controle PI conforme apresentada na seçao 6.2 por meio de uma funcao convexa como
u(t) = M usmc + (1 - m) upi,	(6.8)
usmc = uo + Au sgn(a),	(6.9)
onde
CT = P2 - P1 + P-
uPI (k)	= uPI (k — 1) + s0 e(k) + Si e(k — 1),	(6.10)
onde usmc e a lei de controle de chaveamento dada por 6.9 e uPI e o controle PI 6.10, com e(k) = P*(k) — Pí(k).
O parâmetro g = g(Pi,P2) fornece uma transição suave entre as leis de controle de tal forma que se as trajetórias estao longe do ponto de equilíbrio então g tende a 1; de outra forma g se aproxima de 0. O parâmetro g é definido como
M = 1+râ^)
(6.11) A(PbP2) = ( pt — 1)2 + (pt — 1)2
onde P* e o ponto de operacão para a pressão de fundo e P2* é o valor desejado para a pressao na entrada do choke de superfície. Os valores dos parâmetros para os controladores definidos pelas equações 6.9, 6.10 e 6.11 são apresentados na Tabela 6.2. O parâmetro p é definido como p = P* — P*. A resposta do
Tabela 6.2: Parâmetros da lei de controle
Parâmetro	Valor	Unidade
uo	0.2	
Au	0.12	
so	-8.08 • 10-6	Pa-1
S1	7.92 • 10-6	Pa-1
Y	8/S	
S	0.008	
sistema com a lei de controle proposta para uma perturbação na vazão massica de entrada no riser é mostrada na figura 6.10 e o
diagrama de espaço de estados ó apresentado na figura 6.11. O tempo de amostragem adotado foi Ta = 1s. Em t = 15000s, a
Abertura do choke
				—							
	◄— Controle ligado				: !
					\
	vazão de entrada ~				◄ desligado
		A	í					, A	i	-
	j	1				M i
Tempo [s] xio
van ave is do sistema
Tempo [s] xio4
Figura 6.10: Respostas de controle e saída com a lei de controle modificada (6.8) para uma perturbação na entrada
Figura 6.11: Diagrama de espaço de estados para o sistema com a lei de controle modificada (6.8)
vazão móssica de entrada no riser ó reduzida de 5kg/s to 3.5kg/s.
Esta perturbacçãao muda as condicçãoes de operaçcãao do processo. A estrategia de controle SMC proposta controla o sistema reduzindo a amplitude das oscilaçcãoes.
Em t = 25000s, o controle é desligado e o sistema comeca a exibir oscilacçãoes de pressaão e vazaão novamente. Isto acontece porque o valor de abertura de choke encontra-se na regiãao de instabilidade. Uma desvantagem de usar o algoritmo SMC discutido nesta Seção áe que naão áe possável estabilizar o sistema para grandes pertur-bacçãoes na vazãao.
6.5	Controle Slug Washout SMC
Todas as táecnicas apresentadas anteriormente para o controle de golfadas utilizam referêencias para obter a lei de controle. Essas estratáegias tem um problema quando ocorrem mudancças na vazãao máassica entrando no riser. Mesmo um escoamento estabilizado irá exibir valores diferentes para Pi e P2 frente a diferentes vazães máassicas de gáas jáa que os termos devido a gravidade e atrito na expressãao para a queda de pressãao no riser bem como a queda de pressãao no choke crescem com o aumento da vazãao.
Para a táecnica de controle de modos deslizante a manutençcãao da referêencia frente a mudançcas na vazãao máassica entrando no riser significam requerer que o sistema opere em um ciclo limite nãao suficientemente colapsado ou exigir o estabelecimento de um escoamento infactável.
Visto que o objetivo praático áe estabilizar a vazãao mantendo o choke com uma queda de pressão mánima, a idáia de referência de pressãao perde significado. Poderia-se dizer que o problema de controle á bem resolvido se as pressães e vazães enquanto o choke de superfácie áe mantido aberto bem acima do valor que caracteriza o inácio do ciclo limite. A ideia áe desenvolver um estratáegia de controle que suprime as oscilaçcãoes enquanto mantáem a abertura do choke operando em torno de um valor desejado. Se as oscilacçoães sãao suprimidas as pressãoes resultantes seraão uma con-sequêencia da vazãao maássica de entrada, caracterásticas do fluido e geometria do sistema.
A fim de atender as restriçcãoes propãoe-se neste Seçcãao uma nova estratáegia SMC para rejeitar perturbaçcãoes na vazãao de entrada
do riser baseada em filtros washout. Os filtros washout sao usados intensivamente para controlar sistemas caóticos por meio de técnicas baseadas na teoria de bifurcações [113] e em sistemas de controle de vôo [114]. Recentemente, filtros washout foram aplicados em inversores de eletrônica de potôncia em conjunto com controladores SMC a fim de rejeitar perturbacões de carga [115]. Um filtro washout é um filtro passa alta linear que elimina a componente de regime permanente da entrada enquanto permite a passagem da componente transiente. A utilizacao de filtros washout assegura que todos os pontos de equilíbrio do sistema original sejam preservados no sistema controlado, i. e., sua localizaçcaõo permanece inalterada.
A funcao de transferencia de um filtro washout típico é dada por
Gf (s) =
s	w
I	1	I	,
s + w	s + w
onde w denota a reciproca da constante de tempo do filtro que é positiva para filtros estaveis. Assume-se que seja possível filtrar a variavel x para obter um novo sinal xF e definir uma variavel auxiliar z de forma a satisfazer a seguinte equaçao
dz
= w(x — z). dt
uWSMC
uo + Au sgn((j),
(6.13)
xp = x — z.
Então o efeito do filtro washout pode ser representado por meio de uma equaçcaão diferencial adicional,
(6.12)
Dois filtros washout sao utilizados, um para Pr e outro para P2 de tal forma que
zi = wi(Pi — z) = wi pi
-¿2 = W2 (P2 — z) = W2Í)2
onde
^(Ã,-P2) = P - Ã-	(6.14)
Note que 6.14 é similar a 6.6 mas agora o parâmetro p é nulo. A superfície de deslizamento é agora definida como P2 = —Pl e ela não depende do ponto de operação.
Em t = 10000s o controle automatico é ligado e em t = 30000s vazao de entrada no riser é reduzida de 5kg/s para 3kg/s.
Em t = 50000s o controle é novamente desligado e o sistema retorna ao comportamento oscilatório. Os resultados de simulação sao apresentados na figura 6.12.
Figura 6.12: Resposta de controle e saídas do sistema com o slug washout SMC para perturbaçao na vazão de entrada do riser
Figura 6.13: Diagrama de espaco de estados do sistema com slug washout SMC
6.6	Conclusões
A falta de robustez no controle de oscilações devido ao fenômeno slug-flow em risers submarinos utilizando o sistema de controle classico PI foi abordada neste trabalho aplicando técnicas SMC. Trôes controladores SMC diferentes foram propostos para suprimir as oscilaçcõoes devido o fenoômeno slug-flow em risers. Resultados de simulaçcõao foram obtidos utilizando o software OLGA a fim de comparar as diferentes estratéegias SMC sujeitas a perturbações na vazao mássica na entrada do riser de 5Kg.s-1 to 3Kg.s-1. A técnica SMC revela-se uma forma robusta de suprimir os ciclo limites quando o modelo mateméatico do processo nõo é disponével na prética. A dinômica do sistema riser apresentando o comportamento slug-flow em malha aberta com ponto de operaçcõao desconhecido foi tratado neste trabalho utilizando filtros washout. Esta situaçõo se manifesta na presenca de perturbaçoes na vazõao méassica de entrada no riser. Um obstéaculo préatico para a aplicaçcõao da téecnica SMC padrõao no campo ée a componente de alta frequôencia no sinal de controle produzido conhecida como chattering. Este problema pode levar ao desgaste prematuro de elementos do choke. A presençca do efeito chattering na açcõao de controle poderaé ser eliminada com futuros trabalhos utilizando-se controladores de modos deslizante de alta ordem (High Order
Sliding Mode - HOS’M controllers) ou ajustando a funcõo sign() por uma funçõo suave contínua, mantendo dentro do possível as condições de atratividade do sistema comutado.
Controle de escoamento em risers
273
Controle de escoamento em risers
274
Capítulo 7
Conclusões e desenvolvimentos futuros
Este trabalho apresentou as seguintes contribuicões:
—	Modelagem da operaçao de elevacao de petroleo via injecao contónua de góas (GLC),
—	desenvolvimento de um algoritmo de controle MPC distribuído,
—	desenvolvimento de uma tecnica de controle MPC para sistemas nãao lineares
—	aplicaçao de 2 tócnicas de controle para um sistema constituído por um manifold de gas-lift e um grupo de poços
—	aplicaçao de controle na estabilizacão do escoamento em um riser submarino.
Alguns desenvolvimentos futuros do trabalho sãao:
—	Estudar um mecanismo para que o modelo fenomenologico da elevaçcãao por gas-lift forneçca uma relaçcãao em regime permanente de melhor qualidade.
—	Para o modelo da relação pwf = f (qinj) em regime permanente desenvolver uma metodologia baseada na utilização de um simulador de fenomenológico de regime permanente e tócniças do tipo Montecarlo que permita obter seus parâmetros em função das características do poço.
—	Desenvolver um mótodo numórico robusto para resolver o problema de programacçaão quadraótica com restricçãao quadróatica para a tócnica PNMPC com requisito de estabilidade na função objetivo.
—	Para a aplicação da tócnica PNMPC no controle de um grupo de poços e manifold de gas-lift, testar a inclusão de requisitos para o controle do separador óagua-óoleo e góas no lugar de minimizar as oscilaçcãoes das vazãoes de produçcãao.
—	Estudar a aplicacão de controladores de modos deslizante de alta ordem (High Order Sliding Mode - HOSM controllers) ou substituição da função sign() por uma função suave contínua para diminuir ao móximo a presença do efeito chattering na ação de controle dos risers submarinos.
—	A tócnica de controle preditivo baseado em modelo para sistemas nãao lineares desenvolvida obtóem a representacçãao linearizada do sistema de forma numóerica a cada instante de amostragem e por isso pode fazer uso das mais diversas formas de representaçcãao do sistema a ser controlado. Por outro lado existe um desenvolvimento tecnolóogico muito grande na producçãao de simuladores numóericos de reservatóorios que saão utilizados para representar o comportamento dos mesmos. Um trabalho futuro interessante é aplicar a tócnica de controle preditivo desenvolvida no controle da produçcaão de um reservatoório utilizando como modelo do sistema um simulador numóerico de reservatóorio. Acredita-se que o tempo de amostragem nesta aplicaçcaão seria muito grande comparado com os tempos necessóarios para a obtencçãao da representaçcãao linearizada do sistema o que facilitaria a implementacçãao da tóecnica.
Publicações realizadas:
Em Revistas brasileiras de divulgação:
—	A. Plucenio e D. J. Pagano, Tendências do controle e automação no setor upstream da indUstria do petroleo, Revista Petro&amp;amp;Quámica-Editora Valete, pag. 84-90, Setembro de 2005.
—	M. P. Castro and E. Camponogara and A. Plucenio, Escalonamento de compressores em campos de petroleo operados por gas-lift: uma formulação em programaçao matematica, Revista Petro&amp;amp;Química-Editora Valete, pag.63-70, Setembro de 2007.
Em Revistas Internacionais
—	Eduardo Camponogara, Agustinho Plucenio, Alex F. Teixeira, and Sthener R.V. Campos. An automation system for gas-lifted oil wells: Model identification, control, and optimization. Journal of Petroleum Science and Engineering, 70(3-4):157 167, 2010.
—	Eduardo Camponogara, Melissa Pereira de Castro, Agustinho Plucenio and Daniel J. Pagano, Compressor scheduling in oil fields:Piecewise-linear formulation, valid inequalities, and computational analysis, Optimization and Engineering, October 2009.
Em Congressos Nacionais
—	A. Plucenio, D. J. Pagano e J. E. Normey-Rico, Controle robusto aplicado a produçcaão de petr oleo por elevacçaão artificial tipo gas-lift, Congresso Brasileiro de Automática, 2004;
—	R. Oenning, A. Plucenio, Desenvolvimento de uma unidade experimental: Micro-poçco de petroleo com elevacçãao por in-jecão contínua de gas, 3 Congresso Brasileiro de Petráleo de P&amp;amp;D em Petráleo e Gas (PDPetro),2005-Salvador-BA.
—	L. F. Pozas, A. Plucenio, Melhoria da convergência de algoritmo genetico utilizado em alocaçcãao de poçcos, 3 Congresso Brasileiro de P&amp;amp;D em Petráleo e Gás (PDPetro), 2005, Salvador-BA;
—	S. G. Boff, D. J. Pagano and A. Plucenio e R. Alves, Apli-caçcaão de um SCADA a uma unidade experimental de coluna de destilacão, 3o. Congresso Brasileiro de P&amp;amp;D em Petráleo e Gáas (PDPetro), 2005, Salvador-BA;
—	A. Plucenio, D. J. Pagano, G. A. Mafra e A. H. Bruciapaglia, Uma extensão do controle preditivo MPC para sistemas não lineares, Congresso Brasileiro de Automática, 2006;
—	D. J. Pagano, A. Plucenio e P.K. Salvato, Controle de os-cilaçcoães utilizando sistemas comutados, Congresso Brasileiro de Automática, 2006;
—	A. Plucenio, J. E. Normey-Rico, D. J. Pagano e A. H. Bruciapaglia, Controle Preditivo na industria do Petróleo e Gós, 4o. Congresso Brasileiro de P&amp;amp;D em Petróleo e Gás (PDPetro), Outubro de 2007, Campinas-SP;
—	A. Plucenio e E. Camponogara, Automacão da elevacao artificial com injecão contínua de gós-Tendências industriais e acadêmicas, 4o. Congresso Brasileiro de P&amp;amp;D em Petróleo e Gáas (PDPetro), Outubro de 2007, Campinas-SP;
—	M. P. de Castro, E. Camponogara e A. Plucenio, Escalonamento de compressores em campos de petróoleo operados por gas-lift:formulaçcaão linear por partes, 4o. Congresso Brasileiro de P&amp;amp;D em Petróleo e Gas (PDPetro), Outubro de 2007, Campinas-SP;
—	A. Plucenio, D. J. Pagano, J.E. Normey-Rico, J. Pavei e C. Moya, Including Robustness in the MPC Cost Function, Congresso Brasileiro de Automática, 2008, Juiz de Fora-MG.
—	A. Plucenio, D. J. Pagano, E. Camponogara, H. F. Scherer e M. Lima, A simple distributed MPC algorithm, Congresso Brasileiro de Automáatica, 2008, Juiz de Fora-MG.
—	D. J. Pagano, A. Plucenio e C. A. Gonzaga, Controlling oscillations and re-starting operations in gas-lift wells, Congresso Brasileiro de Automática, 2008, Juiz de Fora-MG.
—	L. B. Resende, A. Plucenio e D. J. Pagano, CFD com controle aplicado na modelagem de um separador góas-liquido em linha, 5o Congresso Brasileiro de Pesquisa e Desenvolvimento em Petróleo e Gás (PDPetro), Outubro de 2009, Fortaleza-CE;
—	A. Plucenio, Sistema de multiplos agentes no controle de processos de refino, 5o Congresso Brasileiro de Pesquisa e Desenvolvimento em Petráoleo e Gáas (PDPetro), Outubro de 2009, Fortaleza-CE.
Submetidos:
—	A. Plucenio, D. J. Pagano e Cleber A. Ganzaroli, Dinâmica do fenômeno density wave em poços com elevacão por gaslift, Congresso Brasileiro de Automática, 2010, Bonito-MS.
—	A. Plucenio, A simple distributed MPC algorithm II, Congresso Brasileiro de Automática, 2010, Bonito-MS.
—	A. Plucenio, D. J. Pagano, C. Ganzaroli, Modelos Dinamicos de Pocos operando via Gas-Lift Cont ínuo, Rio Oil &amp;amp; Gas Expo and Conference 2010.
Em Congressos Internacionais:
—	A. Plucenio, G. A. Mafra and D. J. Pagano, A control strategy for an oil well operating via gas-lift, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume II, Gramado, RS;
—	D. J. Pagano, V. Dallangnol Filho, A.Plucenio, Identification of polinomial NARMAX models for an oil well operating by continuos gas lift, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume II, Gramado, RS;
—	E. Camponogara, M. P. Castro, A. Plucenio, The facility location problem: model algorithm and application to compressor allocation, ADCHEM 2006, Proceedings of the IFAC International Symposium on Advanced Control of Chemical Processes, 2006, volume I, pag. 247-252, Gramado, RS;
—	A. Plucenio, D. J. Pagano, A. H. Bruciapaglia, J. E. Normey-Rico, A practical approach to predictive control of nonlinear processes, Proceedings of the NOLCOS 2007-7th, IFAC Symposium on Nonlinear Control Systems, Pretoria-South Africa;
—	E. Camponogara, M. P. de Castro, A. Plucenio, Compressor Scheduling in Oilfields: A Piecewise-Linear Formulation, Automation Science and Engineering, 2007. Case 2007. IEEE International Conference, Pages: 426-441, September 2007;
—	E. Camponogara, A. Plucenio, Lift-gas allocation under precedence constraints: 1-configuration inequalities, Systems, Man and Cybernetic, 2007, IEEE International Conference, Pages:2727-2732, October 2007;
—	A. Plucenio, D. J. Pagano, E. Camponogara, A. Traple, Gaslift Optimization and Control with Nonlinear MPC, AD-CHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;
—	H. Scherer, E. Camponogara and A. Plucenio, Distributed Optimization for Predictive Control of a Distillation Column with Output,Control-Input Constraints, ADCHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;
—	D. J. Pagano, A. Plucenio and A. Traple, Slug-flow Control in Submarine Oil-risers using SMC Strategies, ADCHEM 2009, IFAC International Symposium on Advanced Control of Chemical Processes, July 12-15, 2009 Koc University, Istanbul, Turkey;
Apêndice A
Introdução ao Controle Preditivo Baseado em Modelo
A.1 Introdução
-&gt;
Uma introducao às técnicas de Controle Preditivo baseado em Modelo pode ser encontrada em [116], [77], etc. A idéia da predição para o célculo da açao de controle não é nova. A ação derivativa do classico Controle PID utiliza uma forma de predição atraves da açao derivativa expressa pelo termo kddy. O Preditor de Smith [117] ja utilizava uma forma de predicao para a compensação do tempo morto. A ideia é simples e intuitiva. Conhecendo o comportamento do sistema (modelo entrada-saída) determinar a sequência de açães de controle a serem tomadas no futuro de forma a seguir uma trajetória desejada tambem conhecida com o mínimo de esforço. Aplicar a primeira ação da sequencia e no instante seguinte repetir o processo.
Um bom exemplo da aplicacçãao de controle preditivo para nãao especialistas e aquele praticado pelo motorista de um automovel. Conhecendo o veículo que dirige o motorista observa a pista desde o trecho que esté logo a sua frente como aquele que esté mais afastado e toma as açães necessarias para seguir sua trajetória. Se olhasse somente para o trecho logo a sua frente teria de fazer
seguidos movimentos na direção corrigindo a trajetória do veículo. Olhando somente para o trecho mais afastado poderia deixar de fazer um seguimento correto e andar até mesmo na contramao. E olhando um trecho que vai desde os primeiros metros a frente do veículo e alguma distância mais a frente que o motorista consegue seguir a trajetéria com pequenos movimentos corretivos na direçcaão e na aceleraçcaão. O comprimento da pista ou o a distâan-cia a ser percorrida sob anélise representa aqui o horizonte de prediçcãao.
Em geral as téecnicas de controle preditivo baseado em modelo tâem em comum a minimizaçcãao de uma funçcãao custo.
Suponha que deseje-se fazer uma viagem de automével de forma segura, confortével, rápida e econâmica. Para isto se enumeram os seguintes objetivos:
—	seguir na pista da direita,
—	terminar a viagem em tempo mínimo,
—	seguir as praticas seguras e regras de trânsito obedecendo os limites de velocidade,
—	fazer uma viagem confortével.
—	gastar o ménimo de combustével.
Se o veéculo fosse dotado de sensores e acionadores adequados poderia ser conduzido por um processador que minimizasse uma funçao objetivo na forma de uma expressão matemética. Mesmo atuando de forma manual o motorista age como se minimizasse uma funcão custo pois minimiza os desvios da trajetéria mantendo-se na pista da direita. Minimiza o afastamento da velocidade ideal respeitando as restriçcoães impostas pela sinalizaçcaão e dis-tâancia ménima do veéculo a sua frente. Minimiza o desconforto adaptando a velocidade as condicçãoes da pista. Minimiza o gasto de combustével selecionando a marcha ideal para a velocidade do veéculo e posicçãao do pedal do acelerador.
velocidade ideal e hó um peso para o nível de solavancos, a mini-mizacao da função objetivo resulta na viagem com as características desejadas.
Para finalizar deve-se mencionar a necessidade do constante ajuste do modelo frente as obervaçães ou medições das varióveis do processo. No exemplo da viagem do carro isto se manifesta, por exemplo, quando o motorista detecta que o veículo sacoleja mais ou menos do que o previsto. Isto é observado pelo motorista e seré levado em consideração nas sua predicães futuras.
O controle preditivo baseado em modelo (mpc) é uma das técnicas de controle moderno mais potentes e provavelmente a que teve mais êxito em aplicacães industriais [118] principalmente na industria do petróleo. As principais causas deste exito devem-se a que as estrategias de mpc podem ser aplicadas tanto a sistemas monovariéaveis como multivariaveis lineares ou nãao lineares, as restricoes nas saédas e nas açoes de controle podem ser consideradas no projeto da lei de controle em tempo real e, pela préopria definicçãao dos algoritmos, podem ser usadas para controlar processos com atrasos [119].
O mpc nao é uma estrategia de controle especéfica, mas é o nome dado a um conjunto muito grande de méetodos de controle que foram desenvolvidos considerando algumas ideias comuns baseadas no conceito de predição. Na figura A.1 mostra-se a estrutura geral de um mpc onde pode ser observado o funcionamento do algoritmo: com o controle e o erro atuais e um modelo calcula-se primeiro a prediçcãao da saéda futura do processo; com estas informaçcoães um moédulo de otimizaçcãao calcula o sinal de controle a ser aplicado ao processo no préoximo passo considerando a minimizaçcaão de um determinado éndice de desempenho e as restricçãoes nas variaéveis de processo e/ou de controle [48].
A maioria dos sistemas reais tôm dinômica não linear, porem quando o processo opera numa pequena faixa então a sua dinamica pode ser aproximada satisfatoriamente atravées de modelos lineares. Isto tem motivado a que muitas técnicas de mpc foram abordadas utilizando modelos lineares: Matriz Dinôamica de Controle (dinamic matrix control-dmc), [120]; Controle Algorítmico Baseado em Modelo (model algorithm control-mac), [121]; Controle Preditivo Generalizado (generalized PREDICTIVE control-gpc), [122]); Controle Preditivo Adaptativo (extended PREDICTIVE SELF ADAPTIVE CONTROL-EPSAC), [123].
Figura A.1: Diagrama de Blocos do Algoritmo de Controle Preditivo Baseado em Modelo
São muitas as aplicacoes de controle baseadas em softwares comerciais que implementam LMPC nas refinarias de petroleo no Brasil e no mundo [48].
As principais vantagens do LMPC estao vinculadas as facilidades de obtençcãao de modelos lineares, se comparados aos nãao lineares, e as menores dificuldades para se resolver os problemas de otimiza-çcãao associados. Porem, quando os processos tâem dinâamica muito nãao linear ou quando a faixa de operaçcãao e variavel, entãao necessariamente devera ser tomado em conta o modelo nãao linear no projeto do controle, de forma que permita manter o desempenho desejado para o sistema em malha fechada.
Do ponto de vista conceitual o MPC nao linear (nmpc) não apresenta dificuldades. Considerando a mesma funçao objetivo (J) que no caso linear e um modelo não linear para o calculo das pre-diçcoães o objetivo consiste novamente em encontrar o controle que minimize a funcçãao objetivo num algoritmo de horizonte deslizante. Ja do ponto de vista pratico sãao varias as dificuldades encontradas neste problema (se comparado ao caso linear): (a) a determinacçãao do modelo do processo quando deve ser obtido por identificaçcãao, (b) a obtençcaão do sinal de controle requer, em geral, a soluçcãao de um problema otimizacçãao nãao convexo e (c) a analise de estabilidade e robustez da soluçao. Por estes motivos o NMPC e um campo aberto para pesquisas tanto na area de determinacão de modelos como nos procedimentos e algoritmos de otimizaçcãao para o calculo do controle [48, 124].
A.2 Conceitos Básicos de MPC
Os algoritmos MPC possuem algumas características comuns [48]: (a) usam um modelo explícito do processo e das perturbações para predizer a saída do mesmo num determinado horizonte finito; (b) calculam as ações de controle para todo o horizonte a partir da minimização de uma determinada funçõo objetivo; (c) o horizonte e deslizante, pelo que para cada período de amostragem o horizonte e deslocado um passo para frente, aplica-se unicamente a açcõao de controle de aquele instante e desconsidera-se o resto dos controles dentro do horizonte.
As diferencas entre os diversos algoritmos existentes devem-se basicamente à forma de escolher os modelos para o processo e as perturbaçcoões, ao tipo de funçcaõo objetivo e ao procedimento para manipular as restricões e o calculo do controle [125].
O modelo de prediçcõao e provavelmente o elemento mais importante dentro do controlador dado que ele deve ser capaz de representar adequadamente a dinamica do processo para permitir o calculo das prediçoes da sua saída, ser intuitivo e ao mesmo tempo permitir uma analise teorica do sistema. As diferentes estrategias de MPC utilizam diferentes formas para representar as relaçcoões entre entradas manipuladas, perturbações e saídas do processo. Em geral o modelo é separado em duas partes: no modelo do processo propriamente dito e no modelo das perturbaçcõoes; ambos necessarios para o calculo das prediçcõoes. Os modelos lineares sõao os mais usados na pratica para representar o processo e podem ser de entrada saída (resposta impulsiva, resposta ao degrau e funçao de transferência) ou de variaveis de estado.
Os modelos de resposta impulsiva ou ao degrau sõao bastante utilizados na pratica por oferecem as seguintes vantagens: (a) são intuitivos e podem ser usados em plantas multivariaveis sem acrescentar complexidade; (b) quando identificados não precisam de conhecimento a-priori do processo e (c) descrevem de maneira simples efeitos mais complexos da dinaêmica do processo como atrasos e comportamentos de fase não minima. Por outro lado apresentam alguns inconvenientes: (a) naõo podem ser usados com plantas instaveis e (b) necessitam utilizar um grande numero de parêametros para descrever o modelo, sobre tudo se o processo tiver um atraso grande.
O modelo de funcçãao de transferêencia tem como vantagens prin-
cipais que pode ser usado para plantas instaveis e que precisa, em geral, de poucos paraâmetros para descrever o comportamento do sistema (o atraso, por exemplo, pode ser descrito apenas com um parâmetro). Ja seu principal inconveniente é a necessidade de conhecer a priori a ordem dos polinomios numerador e denominador quando o modelo deve ser identificado a partir de dados experimentais.
Os modelos de espaçco de estados podem ser usados diretamente para processos multivariaveis e não lineares. Como inconvenientes cabe mencionar que em geral os estados não tem significado físico e que na maioria das vezes e necessario o uso de observadores, aumentando assim a complexidade de calculo do controle.
Os modelos nãao lineares sãao geralmente usados para descrever a dinâamica do processo quando os modelos lineares nãao geram bons resultados. Modelos fenomenologicos [126], empíricos [127], redes neurais [128] ou logica nebulosa [129] podem ser usados em agumas aplicaçcãoes para determinar o modelo de predicçãao. O inconveniente no uso destes modelos e a maior complexidade tanto no procedimento de obtencçãao do modelo do processo quanto no c alculo da lei de controle.
A escolha de um modelo para as perturbaçcãoes e tãao importante quanto a do processo. O modelo mais utilizado para a descriçcaão de perturbaçcãoes deterministicas e estocasticas e o conhecido como modelo autoregressivo integrado de media movel (Auto-Regressive and Integrated Moving Average, ARIMA) [122]. Este modelo permite representar mudanças aleatorias, ”off-sets”e outros fenâ-menos normalmente encontrados no meio industrial.
A funçcãao objetivo a ser minimizada pode ter diferentes formas mas a mais utilizada e do tipo quadratica contendo o somatorio do quadrado do erro entre uma trajetoria desejada e a trajetoria obtida ao longo de um horizonte de prediçcãao e o somatorio do quadrado dos incrementos de açcãao de controle em um horizonte de controle [125].
Seja
-	J uma funcão custo;
-	k a denominacçãao do instante de tempo ou amostra atual, k — 1o instante anterior e k + j o instante j depois do atual;
-	p o horizonte de predicão ou numero de amostras depois da amostra atual onde as prediçcãoes e trajet orias futuras sãao
(A.1)
consideradas;
-	m o horizonte de controle ou numero de amostras onde as entradas sãao manipuladas para minimizar a funcçãao custo;
-	y(k + j/k) a saída y no instante j depois do instante atual k calculada com o modelo do sistema;
-	Au(k + i) a variação na ação de controle no instante (k + i) com relacão a ação de controle no instante anterior u(k + i — 1). Ou seja Au(k + i) = u(k + i) — u(k + i — 1).
Uma funcçãao custo genéerica ée dada pela equacçãao (A.1) onde o termo Jseg. ref. leva em conta o seguimento de referência e o termo Jesf. cont. o esforço de controle.
J	Jseg. ref. + Jesf. cont
Para um sistema com uma entrada e uma saída (SISO - Single Input Single Output) uma função custo típica é a apresentada na equacçaão (A.2).
Ni+p-1	m—1
J =	Yj(y(k + j) — r(k + j))2 +	XiAu(k + i)2. (A.2)
j=Ni	i=0
Na equacao (A.2) e Xj são as ponderações, respectivamente sobre o seguimento de referência e o esforço de controle. Em muitos casos as ponderaçcãoes para o caso SISO saão constantes. N1 é o numero de amostras que determina o inécio do horizonte de predição. O problema a ser resolvido é obter o vetor Au = [ Au(k) Au(k + 1) ••• Au(k + m — 1) ] que minimiza a função Custo J sujeito a restriçcãoes sobre os incrementos de controle Au, as açães de controle u = [ u(k) u(k + 1) ••• u(k + m — 1) ] e a saéda predita y(k + j) = [ y(k + 1) y(k + 2) ••• y(k + p) ]T.
— Modelo dinamico do sistema
—	Modelo da perturbaçao
—	Funcao Custo
—	Forma de obtencao da Lei de Controle
Para sistemas dinâamicos representados por modelos entrada-saéda lineares os modelos dinaâmicos mais comuns sõao:
—	Representaçao por Resposta ao Impulso
—	Representaçao por Resposta ao degrau
—	Representaçõo por Funcao de Transferância
A.2.1 Tipos de Controle Preditivo para Sistemas Lineares
Os tipos de controle preditivo mais conhecidos sõo:
Model Predictive Heuristic Control ou Model Algorithmic Control (MAC) - Utiliza o modelo do sistema baseado na resposta ao impulso. Por basear-se na resposta ao impulso ée um méetodo de controle preditivo véalido para sistemas estéaveis. A trajetória é desejada tem uma dinamica de primeira ordem que evolui desde a saída atual ate a referância desejada. Os horizontes de predicçaõo e controle sõao iguais.
Dynamic Matrix Control - Utiliza o modelo do sistema baseado na resposta ao degrau.
Predictive Functional Control (PFC) - Utiliza modelo do tipo equaçcaõo de estados e ée aplicéavel a processos lineares e nõo lineares, estóveis e instóveis. No lugar de buscar o seguimento de referâencia ao longo do horizonte de predicçaõo, este méetodo busca a coincidâencia das prediçcõoes com alguns pontos da trajetória desejada. A acao de controle consiste em uma combinaçcaõo de funçcoões base prée-selecionadas.
Extended Prediction Self Adaptive Control - Utiliza modelo baseado em Funçcõao de Transferâencia. Uma caracteróstica marcante deste móetodo óe que o horizonte de controle óe igual a 1.
Generalized Predictive Control (GPC) - Método proposto por Clarke et al. [130]. Utiliza o modelo CARIMA para as prediçcõoes. Um aspecto importante do algoritmo GPC óe a forma como trata o erro de modelagem. As prediçcõoes incorporam a integral do erro filtrado.
A.2.2 DMC - Dynamic Matrix Control
Desenvolvido nos anos setenta por Cutler e Ramaker da empresa Shell, a técnica de Controle Preditivo DMC é uma das mais utilizadas na indUstria, principalmente em petroquímicas [116]. A tecnica de controle preditivo DMC (Dynamic Matrix Control) utiliza a representacão do modelo da planta na forma nao paramétrica. As saídas da planta sao calculadas baseadas na resposta ao degrau unitério de cada entrada. Para um sistema de uma entrada e uma saéda estéavel e linear pode-se escrever
y(k) =	9iAu(k - i) + n(k),	(A.3)
i=1
onde g-í são os elementos do vetor resposta ao degrau unitario na entrada. Utilizando-se a equacão (A.3) para escrever-se a predicão da saída y em um instante j unidades de tempo de amostragem futuros têm-se
y(k + j/k) = ^2 9iAu(k + j - i) + n(k + j/k)	(A.4)
i=1
A equacão (A.4) pode ser reescrita dividindo-se o tempo entre 1 : j e (j + 1) : to.
j
y(k +j/k) =	gíA«(k +j - i)+	gi^u(k +j - i)+ n(k+j/k)
í=1	i=j+1
(A.5) Deve-se observar que se substituémos os limites do somatoério do primeiro termo a direita da equação (A.5) verifica-se que este termo representa a contribuiçao das entradas [Au(k), ... Au(k + j - 1)] na saéda do processo enquanto que o segundo termo representa o efeito de todas as entradas desde (k - 1) até (k + j - to) ou (-to). Ou seja, o primeiro termo representa a mudança do processo devido as mudancças nas açcãoes de controle futuras enquanto o segundo termo representa a saéda do processo no instante (k + j) devido as entradas que ocorreram até o momento (k - 1). A téecnica DMC supãoe que os erros de modelagem ou perturbações futuras n(k + j/k) são todas iguais a que ocorreu no
instante k, ou n(k). Então
+ j/k) = ym(k) - y(k/k),	(A.6)
onde ym(k) é o valor da saída real no instante k, mas
n(k + j/k) = ym(k) - 529iAu(k - i) e	(A.7)
i=1
substituindo-se (A.7) em (A.5) tem-se
j
y(k+j/k) = ^2 9iAu(k+j-i)+ ^2 9iAu(k+j-i)+y m (k)-	9iAu(k-i).
i=1	i=j+1	i=1
(A.8)
Os três Ultimos termos da equação (A.8) podem ser combinados e têm-se
j
y(k + j/k) =	9iAu(k + j - i) + f (k + j)	(A.9)
i=1
onde
f (k + j) = ym(k) ^2(9j+i - 9i)Au(k - i)	(A.10)
i=1
Entretanto como os elementos gi da resposta ao degrau unitario de um sistema estavel convergem em um determinado numero de amostras N pode-se truncar o somatório da equaçao (A.10) em N ja que 3 N tal que gN+1 = 9n• Com esta consideraçao a equaçao (A.10) é reescrita como
N
f (k + j) = ym(k) + ^2(9j+i - 9i)Au(k - i)	(A.11)
i=1
bem manipulados. Daí surge a ideia do horizonte de controle m. Pode-se perceber que se o o horizonte de controle for muito pequeno estaremos tirando graus de liberdade da acçãao de controle e as acoes de controle tendem a tornar-se mais ativas. Horizontes de Controle menores facilitam o calculo da ação de controle. Ja o horizonte de prediçcãao determina o intervalo de tempo futuro sobre o qual se quer ter controle. Escrevendo-se a expressao (A.9) expandida considerando-se o horizonte de controle m e o horizonte de prediçao p tâm-se
y(k + 1/k)	—	giAu(k)	+	f (k + 1)
y(k + 2/k)	—	g2Au(k)	+	giAu(k + 1)	+ f (k + 2)
y(k + 3/k)	—	g3Au(k)	+	g3Au(k + 1)	+ giAu(k + 2) + f (k + 3)
y(k + p/k)	—	gpAu(k)	+	gp_iAu(k +	1) + ... + gp-m+íAu(k + m - 1) -
O conjunto de equações (A.12) pode ser reescrito em uma forma compacta pela equaçcãao (refdmccom).
Y — F + GAu,	(A.13)
onde G e a Matriz Dinamica definida pela equacão (A.15).
gi	0	... 0
92	gi	... 0
		... 0
gm	gm-1	. . .	g1
gP	gP-i	. . .	gp-m+1
(A.14)
y(k + 1/k)
y(k + 2/k)
y(k + p/k)
(A.15)
f (k + 1) f (k + 2)
f (k + p)
Au =
Au(k)
Au(k + 1)
Au(k + m — 1)
(A.16)
(A.17)
Utilizando-se a forma de expressar as predicçãoes com a equacçãao (A.13) pode-se tambem reescrever a funçcãao objetivo dada pela equacçãao (A.2) em uma forma mais compacta como
J = (Y — W)T R(Y — W) + AuT QAu,	(A.18)
ou
J =	(F + GAu — W)T R(F + GAu — W) + AuT QAu
onde R e uma matriz diagonal contendo as ponderacçãoes sobre o seguimento de referâencia ao longo do horizonte de predicçaão, W e o vetor contendo as trajetórias futuras desejadas no horizonte de predicçaão e Q e uma matriz diagonal contendo as pon-deraçcoães sobre o esforçco de controle. A expressãao (A.1) e valida para sistemas com multiplas entradas e multiplas saádas (Sistemas MIMO-Multiple Inputs Multiple Output) como tambem para sistemas com uma entrada e uma saáda (Sistemas SISO-Single Input Single Output). Para os sistemas com uma entrada e uma saáda áe comum considerar R como a matriz identidade e a matriz Q = AI„ „ . Neste caso a expressao (A.1) transforma-se em
J = (F + GAu — W)T (F + GAu — W) + ÀAuT A(A.19)
No caso de sistemas MIMO com Ne entradas e Ne saádas, a matriz G sera composta por NeNs submatrizes, o vetor F sera composto de Ns vetores e o vetor Au por Ne vetores. Como exemplo, para um sistema com 2 entradas e 2 saádas tâem-se
Yi
Y2
F1	+	G11	G12		Au1
F2		G21	G22		Au2
(A.20)
A minimizacçãao da funçcãao custo para o caso sem restricçoães pode ser obtida igualando-se a zero o gradiente da funçcãao Custo dada pela equação (A.1), dd^ü = 0.
d J
—— = 2GtRGAu + 2GtRF — 2GtRW + 2QAu (A.21) dAu
Isolando-se Au obtóm-se ;
Au = (Gt RG + Q)- 1Gt R(W — F)	(A.22)
Como g^ü2 = 2(GtRG + Q) e R e Q saão matrizes diagonais com elementos positivos, então 9\'ü2 ó definida positiva e o mínimo encontrado íe um mínimo global.
Na presençca de restricçãoes sobre a acçãao de controle ou sobre a proípria saída a minimizaçcãao da funcçaão Custo íe obtida com a aplicacão de algoritmos de Programação Quadrítica. Estes algoritmos resolvem problemas do tipo
min xT $x + 0T x	(A.23)
x
sujeito a
Ax &amp;lt;b
Manipulando-se a funçao Custo definida na equacao (A.1) pode-se colocí-la no formato da equaçao (A.23) fazendo-se
$ = Gt RG + Q,	(A.24)
e
0 = Gt Rt (F — W).
As restriçcãoes podem ser aplicadas tanto sobre as entradas como sobre as saídas. Sobre as entradas pode-se aplicar restrições tanto na taxa de mudançca da açcãao de controle como em seus valores míaximos e mínimos. Para denotar a restricçãao de que as variaçcãoes míaximas da açcãao de controle em um intervalo de tempo igual a um período de amostragem sejam aquelas que o elemento atuador pode fornecer, (Aumin &amp;lt;Au &amp;lt;Aumax), escreve-se para o caso
SISO
IAu&amp;lt;
IAu&amp;lt;	ÂUmin1,
(A.25)
onde I é a matriz identidade de dimensão m x m e 1 é um vetor de dimensão m x 1 com todos elementos iguais a 1.
Para a aplicação de restricães sobre u escreve-se
u = u(k — 1)1 + DAu,
(A.26)
onde D e uma matriz triangular inferior m x m com todos os elementos não nulos iguais a 1. Para expressar que umin. &amp;lt;u &amp;lt;umax. escreve-se
DAu&amp;lt;	(umax — u(k — 1))1	(A.27)
—DAu &amp;lt;(—umin + u(k — 1))1,
Para introduzir restriçães sobre a saída do tipo ymtn. &amp;lt;y &amp;lt;ymax., escreve-se Y = F + GAu e
GAu &amp;lt;ymax1 — F	(A.28)
— GAu&amp;lt;	— ymin1 + F,
Todas as restricães podem ser expressas montando-se uma matriz A e B tal que AAu &amp;lt;B.
A =
I —I D —D
G —G
(A.29)
Au
max
1
Aumin 1
B =
(umax	u(k	l))1
( umin + u(k	1))1
Vm^ax1	F
ymin 1 + F
(A.30)
Para o caso de múltiplas entradas e múltiplas saldas pode-se igualmente montar matrizez A e B de forma a expressar as restricoes sobre todas as entradas e saldas. Por exemplo, para o caso de 2 entradas ui e u2 e 2 saldas y1 e y2,
A =
I	0mxm
0mxm	I
-I	0mxm
0mxm	-I
D	0mxm
0mxm	D
-D	0mxm
0mxm	-D
Gii	Gi2
G2i	g22
-Gii	-Gi2
-G2i	-G22
(A.3l)
B=
Aumax 1mx 1
Aumax 1mx 1
- Aumin1mx1
Aumin 1m x 1 (u1max ~U1(k - 1))1mx1 (u2max -u2(k - 1))1mx1 (-u1min + u1(k - 1))1mx1 (-u2min + u2(k - 1))1mx1
„,1	i	rpl
ymax1px1	F px1
„,2	i	_ T72
ymax1px1	F px1
ymin1px1 + F px1 ymin1px1 + F px1
(A.32)
onde 0 é uma matriz de zeros, I é uma matriz identidade m x m, D e uma matriz triangular inferior m x m com todos elementos não nulos iguais a 1 e Gy e uma das submatrizes que compoem
a matriz G e que relaciona a saéda i com a entrada j.
A facilidade com que as restriçcãoes sãao introduzidas no caélculo da açcãao de controle quando utiliza-se Controle Preditivo, a facilidade com que os problemas multivariéaveis sãao tratados faz com que a cada dia aumente-se a utilizaçcãao desta téecnica no controle de Processos. Dentre as diversas formulaçcoães, produtos baseados na técnica DMC ainda são os mais utilizados no setor downstream da induéstria do petréoleo.
Referencias
B ibliograficas
[1]	Bin Hu. Characterizing gas-lift instabilities. Master's thesis, Department of Petroleum Engineering and Applied Geophysics, Norwegian University of Science and Technology University, Trondheim, Norway, 2004.
[2]	S.R.V. Campos et al. Spe99956 right-time decision of artificial-lift management for fast loop control. 2006 SPE Intelligent Energy Conference and Exhibition, 2006.
[3]	W. S. Going et al. Spe99834 intelligent-well technology: Are we ready for closed-loop control? 2006 SPE Intelligent Energy Conference and Exhibition, 2006.
[4]	L.A. Saputelli et al. Spe83798 promoting real time optimization of hydrocarbon-producing system. 2003 Offshore Europe Conference, September, 2003.
[5]	M. McCelvey et al. Spe88506 intelligent well system with hydraulic adjustable chokes and permanent monitoring improves conventional esp completion for an operator in ecuador. 200f Asia Pacific Oil and Gas Conference and Exhibition, October, 2004.
[6]	C. Oberwinker et al. Spe96645 real time information to the engineer's desktop-how murphy e&amp;amp;p improved production management. 2005 Offshore Europe Conference, September, 2005.
[7]	L. J. Durlofsky P. Sarma and K. Aziz. Spe94241 efficient closed-loop production optimization under uncer-
tainty. 2005 SPE Europe/EAGE Annual Conference, June,
2005.
[8]	D. B. Silin et al. Spe95685 waterflood surveillance and control: Incorporating hall plot and slope analysis. 2005 SPE Annual Technical Conference and Exhibition, October,
2005.
[9]	M. Hauser T. Unneland. Spe96390 real time manage-ment:from vision to engagement-an operator’s experience. 2005 SPE Annual Technical Conference and Exhibition, October, 2005.
[10]	M. F. Silva Jr. et al. Spe95917 technologies trials of intelligent field implementation in carmópolis field. 2005 SPE Annual Technical Conference and Exhibition, October, 2005.
[11]	M. J. Economides, A. D. Hill, and C. E. Economides. Petroleum Production Systems. Prentice Hall, Inc., 1994.
[12]	Camponogara E. Nakashima P. Otimizaçao da alocação de gós de injeção para um conjunto de poços operando via gas-lift. XV Congresso Brasileiro de Automdtica-CBA 2004,
2004.
[13]	P. Nakashima P. and E. Camponogara. Alocacao ótima de taxas de injecaão de gas-lift utilizando programacãao linear inteira mista. Petro &amp;amp; Quimica 263, 2004.
[14]	E. Camponogara and A. Deconto. Gas-lift allocation under precedence constraints:piecewise-linear formulation and k-covers. 44 IEEE Conference on Decision and Control, and The European Control Conference, 2005.
[15]	P. Nakashima and E. Camponogara. Optimization of liftgas allocation using dynamic programming. IEEE Transactions on Systems, Man, and Cybernetics-Part A, 2005,
2005.
[16]	Alarcón G.A., Torres C. F., and Gómez E. Global optimization of gas allocation to a group of wells in artificial lift using nonlinear programming. Journal of Energy Resources Technology, 124 : 262 — 268, December-2002.
[17]	Y.Tang. Transient dynamic characteristics of gas-lift unloading. Master's thesis, University Tulsa, Tulsa, USA,
1998.
[18]	N. Petalas and K. Aziz. A mechanistic model for multiphase flow in pipes. 4-9 Annual Technical Meeting of the Petroleum Society of the Canadian Institute of Mining, Metalurgy and Petroleum, 1998.
[19]	Y. Chen. Modeling gas-liquid flow in pipes:flow pattern transitions and drift-flux modeling. Master's thesis, University of Stanford, Stanford, USA, 2001.
[20]	Scandpower Petroleum Technologies. Olga 2000 v. 4-10 User Manual. Scandpower P. T., Kjeller, Norway, 2003.
[21]	G. Defaye L. Caralp and C. Vidal. Dynamic behaviour of a gas-lift simulator. European Symposium on Computer Aided Process Engineering-2, 2002.
[22]	B. Jansen et al. Automatic control of unstable gas lift wells. SPE Annual Technical Conference and Exhibition, Outubro
1999.
[23]	Gisle Otto Eikrem, Bjarne Foss, Lars Imsland, Bin Hu, and Michael Golan. Stabilization of gas lifted wells. Proceedings of the IFAC 15th World Congress, Barcelona, 2002.
[24]	Lars Imsland, Gisle Otto Eikrem, and Bjarne Foss. State feedback control of a class of positive systems: Application to gas lift control. ECC’03, Cambridge, 2003.
[25]	A. Plucenio. Automaçao da produção de pocos de petróleo operando com elevaçao artificial por injecao contínua de gás. Master's thesis, Programa de Pos-Graduação em Engenharia Elíetrica, Universidade Federal de Santa Catarina, Florianíopolis, 2003.
[26]	A. Plucenio, D. J. Pagano, and J. Normey-Rico. Au-tomaçcaão de um grupo de poçcos de petríoleo operando com elevacão contínua de gas. II Congresso Brasileiro de P&amp;amp;D em Petróleo e Gas, 2003.
[27]	A. Plucenio, D. J. Pagano, and J. Normey-Rico. Controle robusto aplicado à produção de petróleo por elevaçao artificial tipo Gas-Lift. XV Congresso Brasileiro de Automática-CBA 2004, 2004.
[28]	L. Sinègre et al. Distributed model for density wave dynamics in gas-lifted wells. 44 IEEE Conference on Decision and Control, and European Control Conference, Dec. 2005.
[29]	D. J. Pagano, V. D. Filho, and A. Plucenio. Identification of polynomial narmax models for an oil well operating by continuous gas-lift. International Symposium on Advanced Control of Chemical Process-ADCHEM 2006, pages 1113— 1118, 2006.
[30]	A. Plucenio, D. J. Pagano, and G. A. Mafra. A control strategy for an oil well operating via gas lift. International Symposium on Advanced Control of Chemical Process-ADCHEM 2006, pages 1081-1086, 2006.
[31]	Gisle Otto Eikrem, Bjarne Foss, and Lars Imsland. Stabilization of gas lifted wells based on state estimation. IFAC ADCHEM 2003, Hong Kong, 2004.
[32]	L. S. Imsland, B. A. Foss, and G. O. Eikrem. State feedback control of a class of positive systems: Application to gas lift stabilization. Cambridge, United Kingdom, 2003.
[33]	L. Sinegre. Etude des instabilitóes dans les puits activóes par gas-lift. Master's thesis, Ecole des Mines de Paris, Paris, France, 2006.
[34]	Adalberto J. Rosa and Renato de S. Carvalho. Previsão de comportamento de reservatáorios de petroáleo. Editora Interciencia Ltda., 2002.
[35]	A.R. Hasan, C.S. Kabir, and M. Sayarpour. A basic approach to welbore two-phase flow modeling. pages 384-389, Anaheim-California-U.S.A., 2007.
[36]	E. Camponogara, A. Plucenio, A. F. Teixeira, and S. R. V. Campos. An automation system for gas-lifted oil wells: Model identification, control, and optimization. Journal of Petroleum Science and Technology, 2009.
[37]	E.L. Rawlins and M.A. Schellhardt. Backpressure Data on Natural Gas Wells and Their Application to Production Practices. In Monograph Series-USBM, 1935.
[38]	H.H. Evinger and M. Muskat. Calculation of Theoretical Productivity Factor. In Proc. Trans. AIME, 1942.
[39]	W.E. Gilbert. Flowing and Gas-Lift Well Performance. In Drilling and Production Practice, API, 1954.
[40]	R. Raghavan. Well Test Analysis. In Petroleum Engineering Series, Englewood Cliffs, New Jersey-USA, 1993.
[41]	J.M. Richardson and A.H. Shaw. Two-Rate IPR Testing-A Practical Production Tool. In JCPT, March-April 1982.
[42]	Y.D.C. Maravi. NEW INFLOW PEFORMANCE RELATIONSHIPS FOR GAS CONDENSATE RESERVOIRS. Master's thesis, Texas A and M University, 2003.
[43]	J.R.C. Torrico. Desenvolvimento analítico das curvas IPR a partir de um simulador de reservatórios. Master's thesis, Universidade Estadual de Campinas, 1995.
[44]	A. Plucenio, D. J. Pagano, E. Camponogara, A. Traple, and A. Teixeira. Gas-lift optimization and control with nonlinear mpc. International Symposium on Advanced Control of Chemical Process-ADCHEM 2009, 2009.
[45]	F. Giri, F.Z. Chaoui, M. Haloua, Y. Rochdi, and A. Naitali.
Hammerstein model identification.	10th Mediterranean
Conference on Control and Automation - MED2002, July-2002.
[46]	Manabu Kano and Morimasa Ogawa. The state of the art in advanced chemical process control in japan. In AD-CHEM’09: Proceedings of the International Symposium on Advanced Control of Chemical Processes, pages Part I,11— 26, 2009.
[47]	A. Plucenio, D. J. Pagano, E. Camponogara, H. F. Scherer, and M. Lima. A simple distributed mpc algorithm. XVII Congresso Brasileiro de Automática,, 2008.
[48]	E.F. Camacho and C. Bordons. Model Predictive Control. Springer, Berlin, 2004.
[49]	A. Plucenio, D. J. Pagano, A. H. Bruciapaglia, and J. E. Normey-Rico. A practical approach to predictive control for nonlinear processes. NOLCOS 2007 - 7th IFAC Symposium on Nonlinear Control Systems, 2007.
[50]	A. Plucenio, J. E. Normey-Rico, and A. H. Bruciapaglia. Controle preditivo não linear na industria do petróleo e gás. 40 Congresso Brasileiro de P e D em Petróleo e Gas, 2007.
[51]	Jonas Berge. Fieldbus for Process Control: Engineering, Operation, and Maintenance. ISA-The Instrumentation, Systems, and Automation Society, Reasearch Triangle Park, NC,USA, 2001.
[52]	D. P. Bertsekas. Nonlinear Programming. Athena Scientific, 1995.
[53]	Dimitri P. Bertsekas. Constrained Optimization and Lagrange Multiplier Methods (Optimization and Neural Computation Series). Athena Scientific, 1 edition, 1996.
[54]	A. Plucenio. Sistema de muóltiplos agentes no controle de processos de refino. 5o. Congresso Brasileiro de P&amp;amp;D em Petróleo e Gas, Outubro-2009.
[55]	R. Findeisen and F. Allgower. An introduction to nonlinear model predictive control. 21st Benelux Meeting on Systems and Control, pages 229-237, 2002.
[56]	Mark Cannon. Efficient nonlinear model predictive control algorithms. Annual Reviews in Control, 28:229-237, 2004.
[58]	J.E.S. Santos. Controle Preditivo nao Linear para Sistemas de Hammerstein. Tese de doutroado. UFSC., 2005.
[57]	H.H.J. Bloemen, T.J.J. van den Boom, and H.B. Verbruggen. Model-based predictive control for hammerstein systems. In Proceedings of the 39th IEEE Conference on Decision and Control. Sydney, Australia, 2000.
[59]	V. Balakrishnan M.V. Kothare and M. Morari. Robust constrained model predictive control using linear matrix inequalities. Automatica, 32:1361-1379, 1996.
[60]	J.Y. Choi W.K. Son and O.K. Kwon. Robust predictive control of uncertain nonlinear systemv with constrained input. Transaction on Control, Automation and Systems Engineering, 4:289-295, 2002.
[61]	V. Sakizlis A.M. Manthanwar and E.N. Pistikopoulos. Robust parametric predictive control design for polytopically uncertain systems. American Control Conference, 2005.
[62]	Y.Lu and Y.Arkunl. A scheduling quasi-minmax mpc for lpv systems. American Control Conference, pages 22722276, 1999.
[63]	Y.Lu and Y.Arkunl. A practical multiple model adaptive strategy for single-loop mpc. Control Engineering Practice, 11:141-159, 2003.
[64]	P.J. Campo and M. Morari. Robust model predictive control. 1987 American Control Conference, pages 1021-1026,
1987.
[65]	E. Zafiriou. Robust model predictive control of processes with hard constraints. Comp. Chem. Eng., 14(4/5):359-371, 1990.
[66]	H. Genceli and M. Nikolaou. Design of robust constrained model predictive controllers with volterra series. AIChE Journal, 41(9):2098-2107, 1995.
[67]	Z.H. Zheng and M. Morari. Robust stability of constrained model predictive control. American Control Conference, pages 379-383, 1993.
[68]	D.R.Ramirez, T. Alamo, E.F. Camacho, and M. de la Penha. Min-max mpc based on a computationally efficient upper bound of worst case cost. Journal of Process Control, 16:511-519, 2006.
[69]	R.M.C. De Keyser. A gentle introduction to model based predictive control. In PADI2 International Conference on Control Engineering and Signal Processing, Piura, Peru, 1998.
[70]	M. J. Pomar Garcia c. Controle Preditivo Nao Linear com Aplicação a Eletrônica de Potência, school=Universidade
Federal de Santa Catarina, Florianopolis, SC C., Programa de Pós-Graduação em Engenharia Elétrica. PhD thesis, 2005.
[72]	F. Kunhe. Controle Preditivo aplicado a Robótica Móvel. Diss. de Mestrado, UFRGS, 2005.
[71]	B. Kouvaritakis, M. Cannon, and J.A. Rossiter. Non-linear model based predictive control. International Journal of Control, 72(10):919-928, 1999.
[73]	A. Plucenio, D.J. Pagano, G. A. Mafra, and A. H. Bru-ciapaglia. Uma extensao do controle preditivo DMC para sistemas não lineares. XVI Congresso Brasileiro de Automação, 1:2644-2649, 2006.
[74]	Mircea Lazar. Nonlinear controler based on the epsac approach. Master's thesis, University of Ghent, Department of Control Engineering and Automation, Flanders, Belgium,
2001.
[75]	K.J. Astrom and B. Wittenmark. Computer Controlled S’ystems-Theory and Design. Prentice Hall, Upper Saddle River, New Jersey, USA, 1997.
[76]	M. Escobar and J.O. Trierweiler. Multimodel approach to multivariable low order structured-controller design. International Symposium on Advanced Control of Chemical Process, pages 1021-1026, 2006.
[77]	J.M. Maciejowski. Predictive Control with Constraints. Prentice Hall, Edinburgh Gate, Harlow, Essex,CM202JE, England, 2002.
[78]	J.O. Trierweiler and A. R. Secchi. Exploring the potentiality of using multiple model approach in nonlinear model predictive control. Progress in Systems and Control Theory, 26:191-203, 2000.
[79]	A. Kremling H. Chen and F. Allgower. Nonlinear predictive control of a benchmark cstr. Proc. of 3rd ECC, pages 32473252, 1995.
[80]	S. Engell and K.-U. Klat. Nonlinear control of a nonminimum-phase cstr. Proc. of American Control Conference, pages 2041-2045, 1993.
[81]	J.O. Trierweiler and S. Engell. Controllability analysis via the rpn for a cstr with van de vusse reaction. Proc. of European Control Conference, 1997.
[82]	P. B. Fernandes S. Koch, R. G. Duraiski and J.O. Trierweiler. Nmpc with state-space models obtained through linearization on equilibrium manifold. International Symposium on Advanced Control of Chemical Process, pages 1015-1020, 2006.
[83]	J. A. Rossiter. Model-Based Predictive Control-A practical Approach. CRC PRESS, Boca Raton, Florida, USA, 2003.
[84]	A. Plucenio, D. J. Pagano, J. E. Normey-Rico, J. Pavei, and C. Moya. Including robustness in the mpc cost function. XVII Congresso Brasileiro de Automática, 2008.
[85]	H. K. Khalil. Nonlinear Systems. Prentice Hall, New Jersey-USA, 1995.
[86]	D. Odloak A. H. Gonzales, J.L. Marchetti. Extended robust model predictive control for integrating systems. International Symposium on Advanced Control of Chemical Process, 1:129-134, 2006.
[87]	Mokhtar S. Bazaraa, John J. Jarvis, and Hanif D. Sher-ali. Linear Programming and Network Flows. Wiley-Interscience, 2004.
[88]	Sthener R. V. Campos, Manoel F. Silva Junior, Jose F. Correa, Edson Bolonhini, and Durval F. Filho. Right time decision of artificial lift management for fast loop control. In Proc. of the SPE Intelligent Energy Conference and Exhibition, Amsterdam, Netherlands, 2006.
[89]	G.O. Eikrem L. S. Imsland, B. A. Foss. State feedback control of a class of positive systems:application to gas lift stabilization. In submitted to ECC'03, Trondheim, Norway.
[90]	J. D. Redden, T. A. G. Sherman, and J. R. Blann. Optimizing gas-lift systems. In Proceedings of the 49th Annual Fall Meeting of Petroleum Engineers of AIME, Houston, USA, October 1974. Paper SPE 5150.
[91]	E. P. Kanu, J. Mach, and K. E. Brown. Economic approach to oil production and gas allocation in continuous gas lift. Journal of Petroleum Technology, 33:1887-1892, October 1981. Paper SPE 9084.
[93]	N. Nishikiori, R. A. Redner, D. R. Doty, and Z. Schmidt. An improved method for gas lift allocation optimization. ASME Journal of Energy Resources Technology, 117:87-92, 1995.
[92]	N. Nishikiori, R. A. Redner, D. R. Doty, and Z. Schmidt. An improved method for gas lift allocation optimization. In Proceedings of the SPE 64th Annual Technical Conference and Exhibition, San Antonio, USA, October 1989. Paper SPE 19711.
[94]	G. A. Alarcon, C. F. Torres, and L. E. Gomez. Global optimization of gas allocation to a group of wells in artificial lift using nonlinear constrained programming. ASME Journal of Energy Resources Technology, 124(4):262-268, December
2002.
[95]	P. T. Boggs and J. W. Tolle. Sequential quadratic programming. Acta Num., 4:1-52, September 1995.
[97]	P. H. R. Nakashima. Otimização de processos de produção de petroleo via injecao contínua de gas. Ph.D. Thesis Proposal, Graduate Program in Electrical Engineering, Federal University of Santa Catarina, April 2004.
[96]	E. Camponogara and P. H. R. Nakashima. Optimizing gaslift production of oil wells: Piecewise linear formulation and computational analysis. IIE Transactions, 38(2):173-182,
2006.
[99]	E. Balas and E. Zemel. Facets of the knapsack polytope from minimal covers. SIAM Journal of Applied Mathematics, 34:119-148, 1978.
[98]	L. A. Wolsey. Integer Programming. John Wiley &amp;amp; Sons, 1998.
[100]	T.D. Mayhill. Simplified method forf gas-lift well problem identification and diagnosis. In Proc. 49th Annual Fall
Meeting of the Society of Petroleum Engineers of AIME, Houston-Texas, USA, 1974. Paper SPE 5151.
[101]	P. Lemetayer and P. M. Miret. Tool of the 90's to optimize gas lift efficiency in the gonelle field, gabon. In Proc. SPE Offshore Europe Conference, Aberdeen September 1991. Paper SPE 23089.
[102]	Y. A. W. El-Massry and A. D. Price. Development of a network and gas lift allocation model for production optimization in the ras budran field. In Proc. SPE Middle East Oil Show, Bahrain„ March 1995. Paper SPE 29782.
[103]	C.L. Dunham and H.N.J. Poulisse. Real-time artificial lift optimization. In Proc. 8th Abu Dhabi International Petroleum Exhibition and Conference, Abu Dhabi,, October 1998. Paper SPE 49463.
[104]	Terry Bergeron, Andrew Cooksey, and J.Scott Reppel. New automated continuous gas-lift control system improves operational efficiency. In Proc. SPE Mid-Continent Operations Symposium, Oklahoma City-Oklahoma, USA, March 1999. Paper SPE 521123.
[105]	O. Boisard, B. Makaya, A. Nzossi, J.C. Hamon, and P. Lemetayer. Automated well control increases performance of mature gas-lifted fields, sendji case. In Proc. 10th Abu Dhabi International Petroleum Exhibition and Conference, Abu Dhabi” October 2002. Paper SPE 78590.
[106]	M.S.Nadar, T.S Schneider, K.L. Jackson, C.J.N. McKie, and J. Hamid. Implementation of a total system production optimization model in a complex gas-lifted offshore operation. In Proc. SPE Annual Technical Conference and Exhibition, San Antonio-Texas, USA, September 2006. Paper SPE 103670.
[107]	S. Skogestad. Probably the best simple pid tuning rules in the world. submitted to the Journal of Process Control,
2001.
[108]	J. Godhavn, M. P. Fard, and P. H. Fuchs. New slug control strategies, tuning rules and experiments results. Journal of Process Control, 15:547-557, 2005.
[109]	E. Storkaas and S. Skogestad. Cascade control of unstable systems with application to stabilization of slug flow. IFAC Symposium ADCHEM 2003, January 2004.
[110]	E. Storkaas. Stabilizing control and controllability. Control solutions to avoid slug flow in pipeline-riser systems. PhD thesis, Norwegian University of Science and Technology, Norwegian, 2005.
[111]	F. Angulo, M. di Bernardo, E. Fossas, and G. Olivar. Feedback control of limit cycle: a switching control strategy based on nonsmooth bifurcation theory. IEEE Transactions on Circuit and Systems-I, 52(2):366-378, February 2005a.
[112]	A. R. Champneys M. di Bernardo, C. Budd and P.S. Kowalczyk. Piecewise-smooth Dynamical Systems: Theory and Applications. Applied Mathematical Sciences 163. Springer, 2008.
[113]	H. Wang and E. H. Abed. Bifurcation control of a chaotic system. Automatica, 31:1213-1226, 1995.
[114]	H. C. Lee and E. H. Abed. Washout filter in the bifurcation control of high alpha flight dynamics. In Proc. of the American Control Conference, pages 206-211, Boston, MA, 1991.
[115]	F. B. Cunha and D. J. Pagano. DC-DC step-up converter controlling by SMC and with an auxiliary washout filter. In Proc. of Congresso Brasileiro de Automatica, CBA2002,
2002.	(in portuguese).
[116]	E.F. Camacho and C. Bordons. Model Predictive Control. Springer, London, 1999.
[117]	O. J. M. Smith. Close control of loops with deadtime. Chemical Engineering Progress, 53:217, 1957.
[118]	H. Takatsu, T. Itoh, and M. Araki. Future needs for the control theory in industries-report and topics of the control technology survey in the japanese industry. Journal of Process Control, 8(5-6):369-374, 1998.
[119]	J.E. Normey-Rico and E.F. Camacho. Control of Dead-time Processes. Spinger, Berlin, 2007.
[120]	C.R. Cutler and B.L. Ramaker. Dynamic matrix control - A computer control algorithm. In AIChE 86th National Meeting, Houston, TX, 1988.
[121]	J. Richalet, A. Rault, J.L. Testud, and J. Papon. Algorithm control for industrial processes. In Proc. 4th IFAC Symp. on Identification and System Parameter Estimation, Tbilisi, USSR, 1976.
[122]	D.W. Clarke, C. Mothadi, and P.S. Tuffs. Generalized predictive control. Part I: The basic algorithm. Part II: Extensions and interpretations. Automatica, 23(2):137-160, 1987.
[123]	R. De Keyser. A gentle approach to predictive control. In Eolss Publishers Co. Ltd., editor, Encyclopedia of Life Support Systems (EoLSS), Oxford, April 2003.
[124]	c D. Limon. Control Predictivo de Sistemas No Lineales Sujetos a Resticciones: Estabilidad y Robustez. PhD thesis, Universidad de Sevilla, 2002.
[125]	J.A. Rossiter. Model-Based Predictive Control: A practical Approach. CRC Press, 2003.
[126]	M. Pomar, J.E. Normey-Rico, and E. Camponogara. Non linear model based predictive controller of a buck boost converter. In Proc. of the XVI IFAC World Congress, Prague, 2005.
[127]	O. Nelles. Nonlinear System Identification. Spinger, Berlin, 2001.
[128]	Y. Tan and R. De Keyser. Advances in Model-Based Predictive Control, chapter Neural Network Based Predictive Control. Oxford University Press, 1994.
[129]	I. Skrjanc and D. Matko. Advances in Model-Based Predictive Control, chapter Fuzzy Predictive Controller with Adaptive Gain. Oxford University Press, 1994.
[130]	C. Mohtadi D. W. Clarke and P.S. Tuffs. Generalized predictive control-part i-the basic algorithm. Automatica, 23(2):137-148, 1987.</field>
	</doc>
</add>