<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09321</field>
		<field name="filename">14292_346334.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE FEDERAL DE SANTA CATARINA DEPARTAMENTO DE AUTOMACAO E SISTEMAS
GUSTAVO ARTUR DE ANDRADE
Control of Systems Modeled by Hyperbolic Partial Differential Equations
Gustavo Artur de Andrade
Control of Systems Modeled by Hyperbolic Partial Differential Equations
Tese de doutorado submetida ao Programa de Pós-Graduação em Engenharia de Automação e Sistemas para a obtenção do Grau de Doutor em Engenharia de Automação e Sistemas.
Orientador: Prof. Daniel Juan Pagano, Dr.
Ficha de identificação da obra elaborada pelo autor, através do Programa de Geração Automática da Biblioteca Universitária da UFSC.
de Andrade, Gustavo Artur
Control of systems modeled by hyperbolic partial differential equations / Gustavo Artur de Andrade ; orientador, Daniel Juan Pagano - Florianópolis, SC, 2017.
162 p.
Tese (doutorado) - Universidade Federal de Santa Catarina, Centro Tecnológico. Programa de Pós-Graduação em Engenharia de Automação e Sistemas.
Inclui referências
1. Engenharia de Automação e Sistemas. 2. Controle de processos. 3. Equações diferenciais parciais. 4. Sistemas hiperbólicos. I. Pagano, Daniel Juan. II. Universidade Federal de Santa Catarina. Programa de Pós-Graduação em Engenharia de Automação e Sistemas. III. Título.
Gustavo Artur de Andrade
CONTROL OF SYSTEMS MODELED BY HYPERBOLIC PARTIAL DIFFERENTIAL EQUATIONS
Esta tese de doutorado foi julgada adequada para a obtenção do Título de “Doutor em Engenharia de Automação e Sistemas” e aprovada em sua forma final pelo Programa de Pos-Graduaçao em Engenharia de Automaçao e Sistemas.
Florianópolis, 22 de fevereiro de 2017.
Prof. Daniel Ferreira Coutinho, Dr.
Coordenador do Programa de Pós-Graduação em Engenharia de Automação e Sistemas
Banca Examinadora:
Prof. Daniel Juan Pagano, Dr. - DAS - UFSC Presidente - Orientador
Prof. Julio Elias Normey-Rico, Dr. - DAS - UFSC
Prof. Luis Antonio Aguirre, Dr. - DELT - UFMG
Prof. Nestor Roqueiro, Dr. - DAS - UFSC
Prof. Ricardo H. C. Takahashi, Dr. - MTM - UFMG
ACKNOWLEDGMENTS
I would like to thank the supervisor of my thesis professor Dr. Daniel Juan Pagano for his support and encouragement.
I also thank professors Dr. Manuel Berenguel Soria, Dr. José Luis Guz-mán Sanchez and Dr. Francisco Gabriel Acién Fernández for helpful discussions during my stay at the Grupo de Automática, Robótica y Mecatrónica, Universidad de Almería, Spain, in 2014. This visit was funded by the project CAPES-DGU 220/2010.
I thank professor Dr. Rafael Vazquez Valenzuela from Universidad de Sevilla for his valuable comments and fruitful discussions.
Furthermore, I thank the Conselho Nacional de Desenvolvimento Científico e Tecnolágico (CNPq) for the financial support.
Finally, I would like to thank my family and friends for their incessant support.
RESUMO
Control of Systems Modeled by Hyperbolic Partial Differential Equations
GUSTAVO ARTUR DE ANDRADE
Fevereiro/2017
Orientador: Prof. Daniel Juan Pagano, Dr.
.Área de concentraçao: Controle, Automacao e Sistemas
Sistemas com parâmetros distribuídos representam uma vasta gama de processos da engenharia. Neste caso, as variAaveis do sistema irâo conter termos dependentes do tempo assim como gradientes espaciais e, portanto, e natural representá-los por equações diferenciais parciais. Exemplos podem ser encontrados em diversas áreas: desde processos químicos e tármicos, sistemas de producõo e distribuiçao de energia, e problemas relacionados ao transporte de fluidos e ciencia mádica.
Esta tese trata dois tipos de problemas: estabilizaçõo de equações diferenciais parciais hiperboálicas lineares com variáavel de controle na condiçcaõo de contorno e controle regulatáorio de sistemas descritos por equacçõoes diferenciais parciais hiperbáolicas quasilineares com variáavel de controle no dománio. Com relaçcõao ao primeiro, estudaram-se duas metodologias de controle: (i) uma lei de controle estática que garante convergência do sistema para o ponto de equilibrio desejado. A metodologia de controle utiliza uma funçõo de Lyapunov para encontrar os valores dos parêmetros do controlador que garantem estabilidade exponencial em malha fechada. Resultados de simulacçõao para o problema de supressõao de golfadas em sistemas de produçao de petráleo sõo apresentados para ilustrar a eficiência do má-todo; (ii) uma lei de controle baseada nas ferramentas clássicas do domínio da frequência. Neste caso, aplicamos a transformada de Laplace à equa-çcaõo diferencial parcial para obter uma funçcõao de transferêencia irracional e entao, ferramentas classicas do domínio da frequência sõo usadas para projetar o controlador, de maneira similar aos sistemas de dimensao finita com funçcõao de transferêencia racional. Estes resultados foram aplicados experimentalmente no problema de controle de oscilaçcõoes termoacusticas do tubo de Rijke, mostrando a efetividade do metodo. Para o segundo problema, utiliza-se o metodo das características combinado com a tecnica de controle por modos deslizantes. O metodo das características é usado para
transformar o sistema de equações diferenciais parciais em um conjunto de equações diferenciais ordinárias que descrevem o sistema original. O projeto de controle á entõo realizado a partir deste conjunto de equações diferenciais ordinárias atravás de resultados bem conhecidos da teoria de equações diferenciais ordinárias. Os resultados obtidos foram testados experimentalmente em dois sistemas de escala industrial: uma planta solar e um fotobiorreator tubular.
Palavras-chaves: controle de processos; controle por modos deslizantes; domínio da frequência; equacões diferenciais parciais; estabilizaçõo; funçõo de transferência irracional; método das características.
ABSTRACT
Control of Systems Modeled by Hyperbolic Partial Differential Equations
GUSTAVO ARTUR DE ANDRADE
February/2017
Supervisor: Prof. Daniel Juan Pagano, Dr.
Concentration area: Control, Automation and systems
Distributed parameter systems represent a wide range of engineering processes. In this case, the system variables will contain temporally dependent terms as well spatial gradients and, therefore, it is natural to represent them by partial differential equations. Examples can be found in many fields: chemical and thermal processes, production and distribution energy systems, and problems related to fluid transport and medical science.
This thesis deals with two different problems: stabilization of linear hyperbolic partial differential equations with boundary control and regulatory control of systems described by quasilinear hyperbolic partial differential equations with in domain control. Concerning the boundary control problem, we studied two control methodologies: (i) a static control law that guarantees convergence of the system to the desired equilibrium point. This control methodology uses a Lyapunov function to find the values of the control parameters that guarantee closed-loop exponential stability. Simulation results for the slugging control problem in oil production facilities are presented to illustrate the efficiency of the methodology; (ii) a control law based on the frequency domain tools. In this case, we applied the Laplace transform on the partial differential equation to obtain an irrational transfer function and then classical frequency domain tools are used to design the control law. These results were applied experimentally to the control problem of thermoacoustic oscillations in the Rijke tube, showing the effectiveness of the method. Regarding the regulatory control problem, we use the method of characteristics together with the sliding mode control methodology. The method of characteristics is used to transform the partial differential equations into a system of ordinary differential equations that describes the original system without any kind of approximation. Then, the control design is performed on the ordinary differential equations with well-known results of the theory of lumped parameter systems. The results
were validated experimentally in two industrial scale systems: a solar power plant and a tubular photobioreactor.
Keywords: process control; sliding mode control; frequency domain; partial differential equations; irrational transfer function; stabilization; method of characteristics.
Contents
List of Figures	17
List of Tables	21
Notation	23
1	Introduction	25
1.1	Motivation and state of the art ........................... 25
1.2	Problem definition......................................... 27
1.3	Objectives................................................. 29
1.3.1	General objective................................... 29
1.3.2	Specific objectives ................................ 30
1.4	Contributions.............................................. 30
1.4.1	Publications........................................ 31
1.5	Organization of the thesis................................. 32
2	First-order hyperbolic systems	35
2.1	First-order hyperbolic systems............................. 35
2.2	Characteristic form of a hyperbolic systems ............... 37
2.3	The Cauchy problem......................................... 40
2.4	Mixed initial-boundary value	problem ...................... 43
3	Boundary control of linear hyperbolic systems	45
3.1	Definitions and notations ................................. 45
3.2	The boundary control law................................... 47
3.2.1	Stability analysis.................................. 47
3.2.2	Explicit dissipative boundary conditions............ 48
3.3	Application of the boundary control strategy to the suppres-
sion of slugging oscillations in oil facilities............ 50
3.3.1	Steady-state and linearized system.................. 50
3.3.2	Model in terms of characteristic coordinates......... 52
3.3.3	Stability analysis................................. 54
3.3.4	Design of the control law ......................... 56
3.3.5	Simulation results ................................ 57
3.4	Conclusions.............................................. 58
4	Boundary control of a Rijke tube using irrational transfer
functions	59
4.1	Open-loop transfer function of the Rijke tube ........... 59
4.1.1	Poles and zeros of the	open-loop system............ 62
4.2	Closed-loop system....................................... 63
4.2.1	Proposed control law............................... 63
4.2.2	Stability analysis................................. 64
4.3	Results.................................................. 68
4.4	Conclusions.............................................. 69
5	In domain control of quasi-linear hyperbolic systems	71
5.1	Definitions and	notations ............................... 71
5.2	Distributed sliding mode control for quasilinear hyperbolic
systems................................................... 73
5.2.1	The case of 1-D quasilinear hyperbolic systems with
relative	degree	one................................ 74
5.2.2	The case of 1-D quasilinear hyperbolic systems with
relative	degree	two............................. 82
5.3	Conclusions.............................................. 92
6	Conclusions and future works	95
6.1	Future works............................................. 97
Bibliography	99
A	Modeling of slug flow phenomenon in oil installations	107
A.1 Description of slug flow....................................107
A.2 Mathematical model..........................................109
A.2.1 Formulating the model as a quasilinear hyperbolic system..............................................110
A.	2.2 Well-posedness....................................112
A.	3	Simulation results ......................................113
B Modeling thermoacoustic phenomenon in the Rijke Tube 115
B.	1	System description.......................................115
B.	1.1 The Rijke tube ...................................115
B.1.2 The thermoacoustic phenomenon in the Rijke tube . 116
B.2	Mathematical model...........................................118
B.	3	Model validation.............................................122
C Modeling of solar power plants	125
C.	1	System description...........................................125
C.2	Mathematical model...........................................126
C.	2.1 Well-posedness........................................127
C.	3	Model validation ........................................... 128
D Modeling biomass production in outdoor tubular photobiore-
actors	131
D.	1	System description...........................................131
D.2	Mathematical model...........................................134
D.	2.1 External loop mathematical	model......................134
D.	2.2 Bubble column mathematical	model......................139
D.	3	Model validation ........................................... 141
E Optimization of biomass production in outdoor tubular photobioreactors	145
E.	1	The photobioreactor optimization problem...............145
E.2	Optimal control for biomass production ......................146
E.	2.1 First-order necessary Conditions for	optimality	.	.	.	150
E.2.2 Second-order sufficient conditions for optimality	.	.	151
E.3	Near-optimal strategy .......................................152
E.4	Results................................................153
E.4.1 Simulation results .................................... 153
E.4.2 Experimental results .................................. 156
E.5	Conclusions ................................................ 161
List of Figures
1.1	Systems of interest for the in domain control problem. ...	29
2.1	Representation of the characteristic curves............... 39
3.1	Bottom and top pressure, and choke opening with the proposed control law. At t = 3.3 h the control was switched on
and at t = 15 h the control was again switched off........ 57
4.1	Location of the poles of the open-loop transfer function
(4.14). They were calculated numerically by finding roots of (4.15). Note that there is an unstable pole at 131 Hz on the imaginary axis, and infinite stable poles that tend asymptotically towards (4.16)............................. 62
4.2	Nyquist plot of r^(s) showing two clockwise encirclements
of the origin as w decreases from I to to —to............. 68
4.3	Pressure fluctuations at the microphone location and control
signal as a function of time. At t = 3.5 s the controller is actived. At t = 12 s the control is deactivated........... 69
5.1	Experimental result of the solar power plant with DSMC
controller in a clear day. Results of October 3rd, 2013. ...	81
5.2	Experimental result of the solar power plant with DSMC
controller in a cloudy day. Results of October 2nd, 2013. . .	82
5.3	Block diagram of control structure........................ 89
5.4	Time-response dynamics of the total inorganic carbon, the
CO2 injection, and the pH when a step change at the total inorganic carbon reference was applied ................... 90
5.5	Experimental result of the tubular photobioreactor with DSMC
controller. Results of July 1st, 2014..................... 91
5.6	Experimental result of the tubular photobioreactor with DSMC
controller. Results of July 3rd, 2014..................... 92
A.1 Family of systems subjected to the slugging phenomenon [67].108
A.2 Typical bifurcation diagram considering the outlet valve opening as the bifurcation parameter. A stable limit cycle undergoes from a supercritical Hopf bifurcation HBsup. . . 108
A.	3 Bottom and top pressure for different choke opening values. 114
B.	1 Rijke tube schematic and detailed view of the prototype used
for the experiments.......................................116
B.2 (a) Microphone signal at the onset of instability showing growth, and then saturation of the limit cycle. A zoomed-in picture shows the periodic, but nonsymetric, limit-cycle behavior. (b) Bifurcation diagram of non-dimensional velocity
with heat release as bifurcation parameter................117
B.	3 Validation result: bode plot of the Rijke model and the ex-
perimental plant..........................................123
C.	1 Solar field in CIESOL [75]...............................126
C.	2 Validation results: simulated and experimental data of the
outlet temperature as a function of solar radiation and volumetric flow..............................................129
D.	1 A schematic view of a tubular photobioreactor at Las Pal-
merillas experimental station, Almeria-Spain..............132
D.2 Distribution of the forms of inorganic carbon in the photobioreactor with changes in pH. .......................... 138
D.	3 Validation results: simulated and experimental data of dis-
solved oxygen (DO) concentration, pH, and biomass concentration as a function of CO2 injection and solar radiation. . 143
E.	1 Surface of daily biomass production, calculated from the
model (D.22) and (D.30) and cost function (E.1), as a function of the initial time and final switching time, in local hours. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production..........................................153
E.2 Simulation results for the classic, near-optimal and optimal daily biomass production strategies. The graphics show (top) the biomass concentration at the outlet of the bubble column, Cb,out, (middle) the medium flow, Qm and (bottom) the solar irradiance profile............................................ 154
E.3 Experimental result of the classic harvesting strategy being used at the Palmerillas Experimental Station. The harvesting process starts around 8:00 h and lasts 1 hour. The total cumulated flow is 0.3061 and the daily biomass production obtained is 0.2956 kg/m3....................................157
E.4 Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.2947 kg/m3.........................158
E.5 Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.3435 kg/m3.........................159
E.6 Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 7 hours. The total cumulated flow is 0.1737 and the daily biomass production obtained is 0.0832 kg/m3.................160
E.7 Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 9 hour. The total cumulated flow is 0.0918 and the daily biomass production obtained is 0.0392 kg/m3.................161
List of Tables
A.	1 Parameters of the slug flow model......................114
B.	1 Values of the parameters of the system.................122
C.	1 Solar plant model parameters [75]......................128
D.	1 Composition of the culture medium used in the tubular
photobioreactor..........................................133
D.	2	Photobioreactor model	parameters [40, 64]..............141
E.	1 Convergence behavior of the tubular photobioreactor opti-
mization problem.........................................154
E.2	Sensitivity to solar	irradiance........................155
E.3 Performance indexes calculated from the response of the experimental results of the classic, near-optimal and optimal strategies................................................162
Notation
Sets
R	set of real numbers
C	set of complex numbers
C+	set of all complex numbers with real part larger than or equal zero
■ Mm, n (R)	set of m x n real matrices
Dn	set of n x n diagonal real matrices with strictly positive diagonal
Function spaces and norms
By Ck we denote the class of k times continuously differentiable functions.
Consider a function f : (0, 1) R and define, for p G [1, to)
IfII Lp(0,1)
Then, for p G [1, to), the Lp((0, 1); R) space is defined as
Lp((0, 1);R) = {f : ||f|lp(o,i) &amp;lt;to}.
For p = to, we define
LTO((0, 1);R) = {f : ||f||l~(o i) = sup |f(x)| &amp;lt;to}. z£(0, i)
Define
IIf^h2(o,i) = (jo |f(x)|2dx1 dX|2dx+jo 1	|2dx)
Then the Sobolev space H2((0, 1);R) is defined as
h2((0, 1);R) = {f : IfIIh2(o,i) &amp;lt;to}.
Consider the holomorphic function G : C+	C and define
IIg(s)IIh(c+) = sup |G(s)|-
k '	Re(s)&gt;0
By HTO(C+; C) we denote the following Hardy space:
H	C) = {G : HGHh^&amp;lt;
Chapter 1 Introduction
1.1	Motivation and state of the art
In the last decades, the development of control techniques for linear and nonlinear systems with distributed parameter systems based on partial differential equations (PDEs) has received great attention from the scientific community [1, 2]. These control methodologies exploit the properties of the PDE system to ensure the control problem specifications. Applications of this research area can be found in many fields: chemical and thermal processes, distribution and energy production systems, and systems related with fluid transport and medical science [3].
Based on the location of the actuators and sensors, the control methodologies for distributed parameter systems can be divided into (i) in domain control and (ii) boundary control. In the first case, the actuation and sensing are inside the domain of the PDE system or are evenly distributed everywhere in the domain. From a practical point of view, this means that the sensing and actuation are intrusive. In the second case, the sensing and actuation are not intrusive. Thus, in the mathematical formulation we have the actuation and sensing variables in the boundary condition of the PDE system. The boundary control is considered more realistic due to the fact that actuation and measurement are not intrusive in practice [4].
Several control methodologies for boundary control and in domain control can be found in the literature. Motivated by several industrial processes, boundary control methodologies are most focused on stabilization. In [2, 5] the stabilization of linear PDEs is investigated through a frequency domain approach, whereas [6] focuses on the disturbance rejection problem for system modeled by linear first-order hyperbolic PDEs. In [7], a static control law based on a Lyapunov function is introduced for the particular
case of 2 x 2 linear hyperbolic PDEs without in domain coupling. In [8], this result was extended to n x n linear hyperbolic PDEs weakly coupled in domain. The case of first-order nonlinear hyperbolic PDEs was treated in [9]. Other extensions and applications of this control methodology can be seen in [10-12]. The backstepping method is another promising control methodology for boundary control stabilization problem in PDEs [4]. The main idea is to construct an invertible coordinate transformation (Volterra integral transform) and a control law in order to target the system to the desired closed-loop form. The closed-loop desired form is called target system. The choice of the target system is different for each class of PDEs. This requires that the control designer has a reasonable knowledge about the stability properties of the different classes of PDEs. Some results of this control methodology for hyperbolic PDEs can be seen in [1], and for parabolic PDEs in [13, 14].
Regarding in domain control methodologies, in [15, 16] a feedback linearization control strategy for regulation and disturbance rejection problem was developed for linear and quasilinear hyperbolic PDEs. Other contributions for hyperbolic PDEs range from optimal control methods (e.g. [17-19]) and Lyapunov based methods [20]. The case of regulation and disturbance rejection through sliding mode control is studied in [21-24]. This method is based on the combination of the method of characteristics and the classical concepts of sliding mode control for lumped parameter systems. Methods based on spectral decomposition techniques can be seen in [25, 26]. This approach takes advantage of the spatial differential operator structure and used the Galerkin method to approximate the system by a low-dimensional set of ODEs and to design the controller [27].
Although the research of control methodologies for distributed parameter systems based on the theory of PDEs has become increasingly active, many problems associated with general technical methodology, computational tractability and experimental applications in industrial systems remain open. Probably, these problems are related with the mathematical challenges of PDEs. Even simple problems such as heat equations and wave equations require the user to have a considerable background in PDEs and functional analysis before one can study the control design methods for these systems [4]. In this context, further research into the control of PDEs is necessary to yield results for a broader class of models.
In this thesis we will study the control problem of systems represented by quasilinear and linear first-order hyperbolic PDEs and applications, mainly taking into account the problems mentioned in the former paragraph.. These PDEs are used to represent a wide range of systems encountered in engineering processes. The focus of the study is on the nominal model of
the system and parametric uncertainties are not considered.
1.2	Problem definition
In this thesis we consider two distinct and disjoint control problems:
i. The boundary stabilization problem of 1-D linear hyperbolic PDEs. In this case, these PDEs have the following expression:
du	d u
— (x, t) + A—(x, t) + Mu(x, t) = 0,
(1.1)
where t e [0, +to) is the time variable, x e [0, L] is the space variable, u : [0, +to) x [0, L] Rn is the vector of state variables, A and M are n x n real matrices.
The initial condition of (1.1) is
u(x, 0) = uo(x), x e [0, L],	(1.2)
and the boundary conditions are
gi,o(u(0, t),uo(t),Ci,oX(t)) = 0, t e [0, +&lt;X&gt;),	(1.3)
gijL(u(L, t),uL(t),CijLX(t))=0, t e [0, +to),	(1.4)
i = l,...,n,
where gifi, gi,L : Rn+2 R, u0, uL : [0, +to) R are the control VariaM^, Ci,0 (ci1,0 . . . cip,0) and Ci,L (ci1,L . . . cip,L) are row vectors with real entries and
(t) = f (X (t), u(L,t), u(0,t)),
with X e Rp, X(0) = X0, f : Rp+2n	Rp.
ii. The regulation and disturbance rejection problem of 1-D quasilinear hyperbolic PDEs with in domain control. These systems are given by
d n	dn
dn(x, t) + A(n( x, t), u(t))dx(x, t) = F(n( x, t)),	(1.5)
where n : [0, +^) x [0, L]	Rn is the vector of state variables,
A : Rn+1 Mn,n (R), u : [0, +to) R and F : Rn Rn.
The initial condition of (1.5) is
and the boundary conditions are
hi, o(n(0,t), Bi, oY (t)) = 0, t € [0, +to), hi,L(n(L,t), Bi,LY(t)) =0, t € [0, +to), i = i,...,n,
(1.7)
(1.8)
where hit0,	hi,L	:	Rn+1	R,	Bit0	=	(b^y	...	bip,0)	and	Bi,L	=
(bi1,L ... bip,L) are row vectors with real entries and
(t) = " Y (t) n(L,t) n(0,t))
with Y € Rp, Y(0) = Yo,	: Rp+2n	Rp.
The control problem (1.1)-(1.4) is studied with an eye on the application of suppressing slugging oscillations in oil production facilities and thermoacoustic oscillations in the Rijke tube.
Slugging is a well-known phenomenon that occurs in oil production facilities and is characterized by an intermittent axial distribution of gas and liquid, leading to an oscillating flow pattern. Consequently, sudden variations of oil production due to changes in pressure and flow rates of liquid and gas may occur. Slugging may have undesirable effects on the oil production process [28]. It will affect the oil production and will reduce the lifetime and increase the maintenance costs of the processing equipment. Therefore, its suppression by automatic control is of great economic interest.
Regarding the phenomenon of thermoacoustic oscillations, it is described by high levels of sound produced due to the feedback between heat release rate fluctuations and acoustic pressure fluctuations in confined spaces. This phenomenon remains a serious problem in the development of gas turbines for aeroengines as well as for power generation applications [29]. In such applications, the thermoacoustic instabilities are undesirable due to the additional mechanical strain caused by the pressure waves on the components. Moreover, suppress these oscillations is essential for developing engines for propulsion and power generation with high efficiency, increased performance, and low emissions. In this thesis, we use the Rijke tube as a prototype system to study this problem, since the absence of combustion process in the Rijke tube turns the modeling and system analysis problem significantly more treatable than the other cases where thermoacoustic instability occurs [30].
The motivation for the study of the class of systems (1.5)-(1.8) emerged during a stay at the Grupo de Automática, Bobática y Mecatrónica of the Universidad de Almería, Spain, under the supervision of the professors
(a) Solar power plant at CIESOL building, (b) Tubular photobioreactor at Las Pal-Almeria - Spain	merillas experimental station, Almería -
Spain.
Figure 1.1: Systems of interest for the in domain control problem.
Manuel Berenguel Soria and José Luis Guzmán Sanchez, in which we developed control methodologies for an experimental solar plant at the Solar Energy Research Center (CIESOL) and an industrial tubular photobioreactor located at Las Palmerillas experimental station (Figure 1.1).
The control objective in the solar power plant is to maintain the outlet temperature of the field at a desired level in spite of disturbances (in this case the solar irradiance, ambient temperature and the inlet temperature of the fluid). Regarding the tubular photobioreactor, the control objective is to regulate the pH in its optimal value to maximize the biomass production and also to attenuate the undesirable transient caused by the disturbances.
Although these systems have similar control objective, they have different relative degrees. As will be shown, the solar power plant has relative degree one, i.e., the output variable must be derived only one time to establish an explicit relation with the control variable. Whereas the photobioreactor has relative degree two. This property influences directly the control design [31].
1.3	Objectives
1.3.1	General objective
The general objective of this thesis is to study and explore control methodologies, in a theoretical-experimental way, for the specific class of control problems of systems modeled by hyperbolic PDEs described in Section 1.2. The focus of this study is on the nominal model of the systems and para
metric uncertainties are not considered. Moreover, the results are presented, whenever possible, in a general form, in order to generate results of interest to a significant portion of the scientific community.
1.3.2	Specific objectives
In order to achieve the general objective, the following specific objectives are listed:
•	To study the properties of first-order hyperbolic systems.
•	To study, in the bibliography, relevant information about the control of first-order hyperbolic systems.
•	To develop control methodologies that solve the control problem of the systems of interest.
•	To test experimentally the control methodologies in the control problems of interest.
1.4	Contributions
Regarding the use of the theoretical tools, it can be highlighted as contribution of this thesis the application and experimental validation of infinitedimensional control methodologies on industrial processes. Generally, these control methodologies are only tested by simulation on simple numerical examples.
In Chapter 3, we develop a static boundary stabilizing control law for the slugging problem of oil production facilities, based on the methodology of [7]. The proposed control law guarantees the convergence of the states to the origin in the L2-norm. Comparing to other control methodologies applied on the slugging problem, the proposed control law guarantees stability for greater values of the choke opening. Most of the control methodologies (see for instance [28]) stabilize the system for choke opening at the maximum of 20-25%, whereas the control law developed in this thesis can achieve values of choke opening of more than 45%.
Another contribution is the development of necessary and sufficient conditions for closed-loop stability of the thermoacoustic oscillations in the Rijke tube, presented in Chapter 4. In this case, we used some properties of the system transfer function to guarantee the input-output stability through the use of Nyquist-type test.
In Chapter 5, we develop a control law for the regulation problem of a solar power plant and a tubular photobioreactor. The control methodology
used to solve these control problems is the sliding mode control together with the method of characteristics [21-24]. Moreover, an equivalent control law is developed for these systems to avoid the chattering phenomenon, an inherent characteristic of sliding mode control [32]. Furthermore, we suggested to use the total inorganic carbon as output to control the pH of the tubular photobioreactor. The main advantage of this approach is that it allows to derive an easier control law expression if compared to using directly the pH variable for designing the controller, due to the model complexity. Moreover, a comparative study between this control methodology and another classic methodologies, such as PID and model predictive controllers, was shown in [41, 42]. Through a set of numerical tests it was shown that the DSMC approach is better than PID and model predictive controllers in settling time and disturbances rejection.
Finally, in Appendix E we develop two methodologies to maximize the biomass production in tubular photobioreactors. These methodologies achieved higher biomass production than the classical strategy that is currently used in the industry. However, as this is not the main topic of this thesis, we present these results as an appendix.
I.	4.1 Publications
Parts of the thesis are contained in the following conference papers and articles.
Conference papers
[33]	G. A. Andrade, D. J. Pagano, I. Fernández, J. L. Guzmán, and M. Berenguel. Boundary control of an industrial tubular photobioreactor using sliding mode control. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Cape Town, South Africa, 2014. p. 4903-4908.
[34]	G. A. Andrade, D. J. Pagano, J. L. Guzman, and M. Berenguel. Op-timizaciáon de la produccioán de biomasa en fotobiorreactores tubular. In: Proceedings of the 35th Jornadas de Automática. Valencia, Spain, 2014. p. 513-519.
[35]	I. Fernáandez, G. A. Andrade, J. L. Guzmáan, M. Berenguel, and D.
J.	Pagano. Modelo NARMAX de pH en un fotobiorreactor tubular de microalgas. In: Proceedings of the 34th Jornadas de Automaática. Barcelona, Spain, 2013. p. 550-557.
[11] G. A. de Andrade, and D. J. Pagano. Boundary control for stabilization of slugging oscillations. In: Proceedings of the 2th IFAC Workshop on
Automatic Control in Offshore Oil and Gas Production. Florianópolis, Brazil, 2015. p. 77-82.
[36]	I. Fernandez, M. Berenguel, J. L. Guzmón, F. G. Ación, G. A. Andrade, and D. J. Pagano. Hierarchical non-linear control of a tubular photobioreactor. In: Proceedings of the 5th IFAC Conference on Nonlinear Model Predictive Control. Seville, Spain, 2015. p. 224-229.
[37]	G. A. de Andrade, Vazquez, R. and D. J. Pagano. Boundary feedback control of unstable thermoacoustic oscillations in the rijke tube. In: Proceedings of the 2th IFAC Workshop on Control of Systems Governed by Partial Differential Equations. Bertinoro, Italy, 2016. p. 48-53.
[38]	G. A. de Andrade, Vazquez, R. and D. J. Pagano. Boundary control of a Rijke Tube using irrational transfer functions with experimental validation. Submitted to the 20th World Congress of the International Federation of Automatic Control.
Articles
[39]	G. A. Andrade, D. J. Pagano, J. D. Alvarez, and M. Berenguel. Distributed sliding mode control: Application to a solar power plant. Journal of Control, Automation and Electrical Systems, v.25, n. 3, p. 291-302, 2014.
[40]	I. Fernóandez, F. G. Acióen, M. Berenguel, J. L. Guzmóan, G. A. Andrade, and D. J. Pagano. A lumped parameter chemical-physical model for tubular photobioreactors. Chemical Engineering Science, v. 112, p. 116-129, 2014.
[41]	G. A. de Andrade, J. D. Alvarez, D. J. Pagano, and M. Berenguel. Nonlinear controllers for solar thermal plants: a comparative study. Control Engineering Practice, v. 43, p. 12-20, 2015.
[42]	G. A. de Andrade, D. J. Pagano, J. L. Guzmón, M. Berenguel, I. Fer-nóandez, and F. G. Acióen. Distributed sliding mode control of pH in tubular photobioreactors. IEEE Transactions on Control Systems Technology, v. 24, p. 1160-1173, 2016.
[43]	G. A. de Andrade, M. Berenguel, J. L. Guzmón, D. J. Pagano, and F. G. Acióen. Optimization of biomass production in outdoor tubular photobioreactors. Journal of Process Control, v. 37, p. 58-69, 2016.
[44]	I. Fernóandez, M. Berenguel, J. L. Guzmaón, F. G. Acióen, G. A. de Andrade, and D. J. Pagano. Hierarchical control for microalgae biomass production in photobioreactors. Control Engineering Practice, v. 54, p. 246-255, 2016.
1.5	Organization of the thesis
•	Chapter 2 focus on the properties and main theorems related to first-order hyperbolic systems. The definition of hyperbolicity, the Cauchy problem and the mixed initial-boundary value problem are introduce. The definition of characteristic coordinates, which is used to transform the PDE system into the well-known characteristic form is also introduced. All these definitions and properties will be used in the remaining chapters for the controllers design.
•	In Chapter 3 we study the problem of suppressing slugging phenomenon in oil facilities by means of a stabilizing boundary control law. We start the chapter by stating the proposed control methodology for general 1-D linear hyperbolic PDE systems. Then, we show how to apply this methodology to the slugging control problem. The resulting control law only needs measurements of pressure at the outlet valve, the bottom pressure and total flow-rate measurement through the outlet valve. The closed-loop stability result is stated and proved by Lyapunov function approach. Simulation results on a nonlinear model of the slugging phenomenon shows the effectiveness of the results.
•	In chapter 4 we focuses on the stabilization of thermoacoustic oscillations in the Rijke tube, under a frequency domain approach. First, the theoretical model of the Rijke tube is rigorously studied to derive an irrational transfer function. Then, a control law is designed by using classical frequency domain tools to guarantee input-output stability. We test the proposed control methodology in an experimental setup to show its effectiveness and real-life applicability of the method.
•	In Chapter 5 we study the regulation problem and disturbance rejection of hyperbolic PDEs with in domain control. For this case, we use the sliding mode control methodology together with the method of characteristics. We state this methodology for systems with relative degree one and two, respectively. The development of an equivalent control law to avoid the chattering phenomenon, an intrinsic characteristic of this methodology, is treated. The results are tested experimentally in a solar power plant and a tubular photobioreactor of industrial scale.
•	The concluding remarks and future perspectives are given in Chapter 6.
•	In Appendices A-D we describe the systems that were used to validate the control methodologies in Chapters 3- 5. In each of these
appendices is given a brief description of the plant, the mathematical model and the control problem.
• Appendix E gives two methods to calculate the optimal medium culture flow rate in order to maximize the biomass production in outdoor photobioreactors. One methodology is based on the optimal control theory. In this context, a direct method is used to discretize the optimal control problem and a nonlinear programming technique is applied into the resulting optimization problem. The other methodology calculates only the culture medium injection time, while the culture medium flow rate is maintained constant during this time. The results are validated experimentally in a tubular photobioreactor of industrial scale. However, as this is not the main topic of this thesis, we present these results in Appendix E.
Chapter 2
First-order hyperbolic systems
In this chapter, we discuss the main concepts related to first-order hyperbolic systems: hyperbolicity, characteristic coordinates, the Cauchy problem and the mixed initial-boundary value problem. The material shown in this chapter was extracted from [45-48]. The chapter is organized as follows. In section 2.1 we define the class of first-order hyperbolic systems of interest in this thesis. The characteristic form of first-order hyperbolic systems is introduced in Section 2.2. The Cauchy problem and mixed initial-boundary value problem are discussed in Sections 2.3 and 2.4, respectively.
2.1	First-order hyperbolic systems
We consider the following first-order quasilinear system
d u .	.	. . .	.. du .	.	„. .
— (x, t) + A(u(x, t)) — (x, t) = F(u(x, t)),
(2.1)
where t e [0, +to) is the time, x e [0, L] is the space, u : [0, L] x [0, +to) Rn is the state vector, A : Rn Mn,n(R) and F : Rn Rn are of class C 1.
Definition 2.1. The system (2.1) is hyperbolic if, for any given u on the domain under consideration, A(u(x, t)) has n real eigenvalues Ai(u(x, t)), . .., , An(u(x, t)), a complete set of left (respectively right) eigenvectors li(u( x, t)) = (l»i(v(x, t)), ..., /¿n(u(x, t)) (respectively rj(u( x, t)) = (rw(v(x, t)), . .., rni(u(x, t))T), for i = 1,. .. ,n, such that
and
A(u(x, t))ri(u(x, t)) = Aj(u(x, t))ri(u(x, t)).	(2.3)
We have
det |/jj(u(x, t))| = 0,	(respectively det |rjj(u(x, t))| = 0).	(2.4)
Without loss of generality, we may assume that on the domain under consideration
li(u(x, t))rj(u(x, t)) = Sij	(i,j = 1,. .., n)
and
rl(u(x, t))ri(u(x, t)) = 1	(i = 1,.. ., n),
(2.5)
(2.6)
where hi,j stands for the Kronecker symbol. Let
L(u(x, t)) =
&amp;lt;li(u(x, t)) \
.	I = lij(u(x, t)),
ln(v(x, t)) J
R(u(x, t)) =
ri(u(x, t))
. rn
= rij (u(x i)),
(2.7)
(2.8)
be the matrices composed of the left and right eigenvectors respectively, and
A(v(x, t)) = diag{Ai(u(x, t)), ..., An(u(x, t))}.	(2.9)
Then, by (2.2)-(2.3), immediately follows that
L(u(x, t))A(u(x, t)) = A(u(x, t))L(u(x, t)),	(2.10)
and
A(u(x, t))R(u(x, t)) = A(u(x, t))R(u(x, t)).	(2.11)
Moreover, by (2.5) we have
L(u(x, t))R(u(x, t)) = I,	(2.12)
Definition 2.2. If, for any given u(x, t) on the domain under consideration, A(u(x, t)) has n distinct real eigenvalues, i.e.,
Ai(u(x, t)) &amp;lt;A2(v(x, t)) &amp;lt;• • • &amp;lt;An(v(x, t)),	(2.13)
then, the set of left (respectively right) eigenvectors must be complete. This kind of hyperbolic system (2.1) is called to be a strictly hyperbolic system.
As shown in [47], for any strictly hyperbolic system, all Aj (u(x, t)), /j(r(x, t)) and rj(r(x, t)) (i = 1, ..., n) have the same regularity as A(u(x, t)). However, it is not always the case for general hyperbolic systems.
Example 2.1. Let
,	( 0 u
A(u)=( u2	0
Note that A(u) G C '■, but the eigenvalues A1,2(o) = ±u2 / C '■ at u = 0.
Example 2.2. Let
A(u) =
0,
___1_
e u2
cos sin
sin cos ( U ) A - cos (U )
u=0
u=0
It is easy to see that A(u) G C '' and the eigenvalues Ai,2 = ±e-U2 G C '' . However, one can not find a complete set of left (respectively right) eigenvectors {li(u), ¿2(0)} (respectively {ri(0), r2(u)}) depending continuously on u at u = 0.
2.2	Characteristic form of a hyperbolic systems
For hyperbolic systems, there exists a change of coordinates £(x, t) = ^(v(x, t)) such that (2.1) can be transformed into a system of coupled transport equation
df	df-
-7^(x, t) + Aj«(x, t))-dx(x, t) = ^¿«(x, t))
•	The function : Rn	Rn is a diffeomorphism:
C(x, t) = y&gt;(v(x, t))	u(x, t) = ^-1«(x, t)),
with Jacobian matrix ^(u(x, t)) = d^/dv.
•	The Jacobian matrix ^(u(x, t)) diagonalizes the matrix A(u(x, t)):
^(u(x, t))A(u(x, t)) = A(u(x, t))^(u(x, t)).
Clearly, this change of coordinates exists for any hyperbolic PDE system with A e Mn,n(R) constant and A diagonalizable. If the entries of A are nonlinear, finding the change of coordinates £(x, t) = ^(u(x, t)) requires to find a solution of the first order PDE ^(u(x, t))A(u(x, t)) = A(u(x, t))^(u(x, t)).
Example 2.3. channel	Consider the linearized Saint- Venant system for a single open du .	, du .	.	. (x, t) + A — (x, t) = F(u(x, t)),
a (V H )•	(-■ -■ Cf•■■)
with
' ( V)
In these expressions, h(x, t) = H(x, t) — H and v(x, t) = V(x, t) — V denote the deviations of the water height, H, and water velocity, V, with respect to the steady-states H and V, respectively. The gravity constant is denoted by g and C is a friction parameter.
Notice that A has two distinct non-zero eigenvalues, namely,
Ai = V + N gH &gt; 0,
A2 = V — V gH &amp;lt;0.
The corresponding left eigenvectors can be taken as
h =
I2 =
It follows that the characteristic coordinates can be defined as
£1(x, t) = v(x, t) + h(x, t)
The inverse transformation can also be computed from the above equation:
h(x, t) =
fi(x, t) -&amp;amp;(x, t) [h
2 V
v(x, t) =
f1(x, t) + &amp;amp;(x, t)
2
One can observe that the quantity fi can be seen as the directional derivative dfi/dt at point (x, t) along the curve (xi(x, t, s),Tj(x, t, s)) satisfying
dx
-(x-(x,t, s),Ti(x,t, s)) = Ai«(xi(x,t, s),Ti(x,t, s)), x-(x,t, 0) = xo, ds
(2.15)
dTi (xi(x,t, s), Ti(x,t, s)) = 1, ds
Ti(x,t, 0) = 0.
(2.16)
This curve is called characteristic curve. The quantity Xi is called characteristic velocity and its sign directly influences the direction of the solution propagation fi. This property, illustrated in Figure 2.1, is very important and will be used for the results that will be developed in the following chapters.
Figure 2.1: Representation of the characteristic curves.
The derivative of fi with respect to s then can be written
dfi
~T(x-(x, t, s),Ti(x, t, s)) = gi(C(x-(x, t, s), Ti(x, t, s)) ds
Remark 2.1. If gi,(fi(x, t)) = 0 for some i, then ( is constant (or invariant) along the i-th characteristic curve, since (xi(x, t, s),Tj(x, t, s)) = 0. In this case, the quantity ( is called Riemann invariant.
Definition 2.3. The vector field
Ki = (gi«(xi(x, t, s), Ti(x, t, s))), Xi('Xi(x, t, s)), Ti(x, t, s)), 1)
is called i-th characteristic vector field of (2.14).
This method of transforming the PDE system (2.14) into a set of ODEs along the characteristic curvers is called method of characteristics [45]. Once these ODEs are found, they can be solved and transformed into a solution for the original PDE system. However, it is generaly not possible to separately solve the differential equations of the characteristic curves (2.15)-(2.16) and the system variables (2.17). Therefore, it is necessary to integrate them simultaneously, generally using numerical methods.
The existence and unicity of continuously differentiable solutions of the above PDE system on an interval t e [0, J] is known as Cauchy problem and has been intensively studied in the literature [45, 47, 49]. In general, this is shown on the basis of the integral representation
(i(x, t) = (i(xi(x, t, 0), 0, 0) + / gi(C(xi(x, t, s),Ti(x, t, s))ds
Jo
of (2.17). In the next section we give a sufficient condition for the existence of a solution for the Cauchy problem.
2.3	The Cauchy problem
Consider the Cauchy problem for system (2.1)
du .... .	.. du .	.	„. .
(x, t) + A(u(x, t)) — (x, t) = F(u(x, t))
u(x, 0) = ^(x),	x e (—to, to),
(2.18)
(2.19)
where ^(x) = (^(x), ...,&amp;lt;y&gt;n(x)) is a given C1 function of x with bounded C1 norm ||u||1 = supx |u(x)| + supx |u'(x)|.
Noting that in the corresponding characteristic form (2.14), for each i = 1, ..., n, the i-th equation is an ordinary differential equation along the i-th characteristic, we have that [47, 50]:
Theorem 2.1. Suppose that Xfiyfix, t)), ¡i(v(x, t)) (i = 1,	n) and
F(u(x, t)) are all C1 functions and ^(x) is a C1 vector function with
bounded C1 norm. Then, there exists 5 &gt; 0 such that the Cauchy problem
(2.18)-(2.19) admits a unique local C1 solution u on the domain
{(x, t)|0 &amp;lt;t &amp;lt;5, —to &amp;lt;x &amp;lt;+to} .
Moreover, if
F(0) = 0,
(2.20)
then, for any given A(u(x, t)) and F(u(x, t)), 5 &gt; 0 can be taken as 5 = 5(||^(x))||1) depending only on the C1 norm ||^(x))||1.
Example 2.4. Consider the Cauchy problem for the Burgers equation
u(x, 0) = y&gt;(x),
(2.21)
(2.22)
where ^(x) is a C1 function.
On the existence domain of the solution u to the Cauchy problem, the characteristic curve is defined by
Moreover, along the characteristic curve we have
(2.23)
(2.24)
(2.25)
namely, u takes a constant value and therefore u is Riemann invariant. Furthermore, since u is constant, it follows, by (2.23)-(2.24), that the characteristic curve must be a straight line.
Solving (2.23)-(2.25) with the initial data (2.22), we get that the characteristic curve passing through any given point (x, t) = (xg, 0) is
x = xg^(xg )t
(2.26)
on which
Hence, if the C1 norm of&amp;lt;y&gt;(x) is bounded, for small values of t, by means of the implicit function theorem we can get from (2.26) that
xo = xo(x, t).	(2.28)
Substituting (2.28) into (2.27) gives the solution of the Cauchy problem (2.21)-(2.22):
u = p(x0(x, t))
Note that this solution exists in general only locally in time. In fact, if&amp;lt;p(x) is not a non decreasing function of x, there exist two points (0, xa) and (0, xb) on the initial axis, such that xa &amp;lt;xb and&amp;lt;p(xa) &gt;&amp;lt;p(xb).
Thus, the characteristic curves passing through these two points are respectively
x = xa + p(xa )t,
x = xb + p(xb)t,
must intersect each other in a finite time and, since the solution u takes the different values&amp;lt;p(xa) and p(xb) on these two characteristic curves, at the intersection point the value of the solution can not be uniquely determined.. In this case, the Cauchy problem (2.21)-(2.22) does not admits a global solution on t &gt; 0, i.e., the solution to this Cauchy problem must blow up in a finite time.
Remark 2.2. When the initial condition ^(x) is defined in a finite interval xa &amp;lt;x &amp;lt;xb instead of the whole x-axis, then, Theorem 2.1 is still valid on the corresponding maximum determinate domain:
{(x, t)|0 &amp;lt;t &amp;lt;¿, xa(x, t, s) &amp;lt;x &amp;lt;xb(x, t, s)} ,
where x = xa(x, t, s) e x = xffx, t, s) are determined by
dxa
ds dTa ds
xa(x, t, 0) = xa,0
Ta(x, t, 0) = 0
max Ai(v(xa (x, t, i=1, ...,n
1
s), Ta(x, t, s)))
and
d^b = min Xi(v(xb(x, t, s), Tb(x, t, s))) ds	i=1,...,n
dTb = ,
ds
xb(x, t, 0) = xb,o
Tb(x, t, 0) = 0
In other words, x = xa(x, t, s) is the rightmost characteristic passing through the point (x, t) = (xa, Ta) and x = Xb(x, t, s) is the leftmost characteristic passing through the point (x, t) = (x^, Tb).
2.4	Mixed initial-boundary value problem
We consider the following mixed initial-boundary value problem:
du .... .	.. du .	.	„. .
(x, t) + A(u(x, t)) — (x, t) = F(u(x, t))
u(x, 0) = ^(x),	x e [0, L],
vs = hs(vi, .. ., vm, t),	(s = m + 1, ..., n)
vr = hr(vm+1, . .., vn, t),	(r = 1, .. ., m)
(2.29)
(2.30)
(2.31)
(2.32)
where
Vi = /j(^(x))u	(i =1, ..., n).
Without loss of generality we assume that
gi(t, 0, ..., 0) =0	(i = 1, ..., n).
(2.33)
We suppose that matrix A(u(x, t)), in (2.29), has no zero eigenvalues, i.e.,
Ar(u(x, t)) &amp;lt;0 &amp;lt;As(u(x, t))	(r = 1, ..., m; s = m + 1, ..., n).
(2.34)
Moreover, the conditions of C1 compatibility are supposed to be satisfied at the points (x, t) = (0, 0) and (L, 0) respectively. More precisely, the conditions of C1 compatibility at the point (x, t) = (0, 0) are
ls(u°(0))u°(0) = hs(li(u°(0))u°(0), ..., lm(u°(0))u°(0),0)
(s = m + 1, . .., n)	(2.35)
and
d	d
~Qt [ls(u°(0))u°(0)] = — [hs(li(u°(x))u°(0), ..., lm(u°(x))u°(0),0)] .
(2.36)
Similarly, for the point (x, t) = (L, 0)
ls(u°(L))u°(L) = hs(li(u°(L))u°(L), ..., lm(u°(L))u°(L),0)
para s = m + 1, ..., n	(2.37)
and
d	d
- [ls(u0(L))u0(L)] = - [hs(Mu0(L))u0(L), ..., lm(u0(L))u0(0),0)] .
(2.38)
Under these assumptions, we have[47]:
Theorem 2.2. Suppose that Xi (u(x, t)), li(u(x, t)), F(u(x, t)), hj(t) (i =
1, . .., n), and ^(x) are all C1 functions with respect to their arguments. Suppose furthermore that (2.4), (2.33) and (2.34) hold. Suppose finally that the conditions of C1 compatibility are satisfied at the point (x, t) = (0, 0) and (L, 0) respectively. Then, there exists 5 &gt; 0 such that the mixed initialboundary value problem (2.18)-(2.32) admits a unique local C1 solution u on the domain
R(5) = {(x, t)|0 &amp;lt;t &amp;lt;5, 0 &amp;lt;x &amp;lt;L} .
Moreover, if (2.20) holds, then, for any given A(u(x, t)), F(u(x, t)) and gi(t, •) (i = 1, .. ., n), 5 &gt; 0 can be taken as 5 = 5(||^||i, ||h|| 1), i.e., depending only on the C1 norms ||^||1 and ||h||1.
Remark 2.3. Suppose that there are zero eigenvalues, but the following inequalities are satisfied
Xp(y(x, t)) &amp;lt;Xq(u(x, t)) = 0 &amp;lt;Xr(u(x, t))
(p =1, . . . , l; q = l +1, ..., m; r = m +1, ..., n).
Then, the boundary conditions (2.31)-(2.32) should be replaced by
x = 0 : vr = gr(V1, .. ., Vi, vi+1, .. ., vm, t)	(r = m + 1, . .., n)
x L :	vp	gp(Vl+1?	. . . ,	vm,	vm+1i	. . . ,	t)	(p	1 . . . , l)
with
hp(t, 0, . .., 0) = hr(t, 0,. .., 0) = 0(p = 1, . .., l; r = m + 1, . .., n).
In order to Theorem 2.2 be applied.
Remark 2.4. In [51] it was shown how to extend these results to the case of general differential boundary conditions with a much more involved technical development then Theorem 2.2.
Remark 2.5. Extensions of the local existence results shown in Theorem 2.1 and 2.2 have been discussed in numerous contributions (cf. [49] and [47]). However, these results are in general valid only under very conservative assumptions on the initial condition.
Chapter 3
Boundary control of linear hyperbolic systems
In this chapter, the problem of suppressing slugging phenomenon is investigated. Industrial facilities such as gas-lifted wells and offshore production oil-risers are examples of system where occurs such phenomenon. To study this problem, we consider that these systems are written as a set of 3 x 3 hyperbolic PDEs of balance laws, where the control variable appears at the right boundary condition (see Appendix A). By means of the characteristic coordinates approach, we deduce a stabilizing control law. The exponential stability of the equilibrium is proved by means of a Lyapunov stability analysis. The chapter is organized as follows. In section 3.1 we detail the notation used throughout the chapter. In Section 3.2 we derive the control methodology theory. The design of this control strategy to the slugging problem and simulation results are shown in Section 3.3. The conclusions are given in Section 3.4.
3.1	Definitions and notations
In this section we give the definitions and notations used throughout this chapter. We are interested in the following 1-D n x n linear hyperbolic system:
d£	d £
-dt(x, t)+ AdX (x, t) - M£(x, t)=0,	(3.1)
where t e [0, +to) is the time variable, x e [0, L] is the space variable, £ : [0, +to) x [0, L] Rn is the vector of state variables, and A, M e
Mn,n(R). We assume that A is diagonal with non-zero real diagonal entries such that
A = diag{Ai, A2, ..., An}, Ai &gt; 0 V i G {1, ..., m},
Ai &amp;lt;0 V i G {m + 1, . .. , n}.
For legibility and to facilitate the computations to be presented in this chapter, we introduce the following notations:
u =
£m+1
\ £n
1
(3.2)
c =
and
A+ = diag{Ai,..., Am},
A- = diag{Am+i,..., An}.
Using these notations, system (3.1) is rewritten to
n 4 a+
M c )	0
0 a JL( c+ A J dx \ C
(3.3)
The initial condition of (3.3) is
i x- 0) = c0(xX	x G [0, L],	(3.4)
and the boundary conditions are		
gi,0(C(0, t), C(L, t), u0(t)) =	= 0, t G [0, +to),	(3.5)
9i,L(C(0, t), C(L, t),uL(t)) =	= 0,	t G [0, +to),	(3.6)
i = i,.		
where gi0, giL : Rn+1	R and u0, uL	: [0, +to)	R are the	control
variables.
Our objective is to design u0 and uL such that (3.3)-(3.6) is exponentially stable. We adopt the following definition for exponential stability of
(3.3)-(3.6):
Definition 3.1. The linear hyperbolic system (3.3)-(3.6) is exponentially stable if for every T &gt; 0, there exists C(T) &gt; 0 such that, for every C" G L2([0, L];Rn), the solution to the Cauchy problem (3.3)-(3.6) satisfies
IICG t)||L2([0,L]) &amp;lt;Ce-ai||C0||L2([0,L]).
3.2	The boundary control law
Following [52], a simple solution to guarantee exponential stability of system
(3.3)-(3.6) is to impose a control action uo and uL such that boundary conditions (3.5)-(3.6) are transformed to
e+(0, t)	\	= / Koo	K01 \	i e+(L, t)	\	(3
C(L,t)	) K10	KxJ C(0,t)	)	,	(3.7)
'------V------'
K
where K is a real matrix.
The Cauchy problem (3.3), with initial condition (3.4) and boundary condition (3.7) is well-posed [51]. This means that for any initial condition £0 e L2([0, L]; Rn) and for every T &gt; 0, there exists C(T) &gt; 0 such that a solution g(x, t) e Co([0, +to); L2([0, L]; Rn)) exists, is unique and satisfies
ll£(&gt; t)|L2([o,L]) &amp;lt;C(T) ||£ Hl2([o,l]) , ^t e [0, T].
In the next subsection we will impose sufficient conditions for (3.3)-(3.4) under the boundary conditions (3.7) to guarantee exponential stability according to Definition 3.1.
3.2.1	Stability analysis
Consider the following Lyapunov function
V = i	P(x)&lt;dx,	(3.8)
o
where P(x) =&amp;lt;liag{p.,/ 'T'/,x. i = 1, ..., n}, with p &gt; 0, pi &gt; 0 positive real numbers and Oj = sign(Aj).
The time derivative of V along the system (3.3)-(3.4) and (3.7) is
dV- = f (—AP&lt;*&gt;«—«TP&lt;*&gt;A '+ i M P&lt;*&gt;«+
Then, integrating by parts, we have:
dV
dt
= — ( &amp;lt;(L, t)
iT (0, t)
( APqL)
0	\ (&amp;lt;(l, t) \ +
—ap(0) J m ■	'
&lt;T (—p|A|P(x) + MtP(x) + P(x)m) I dx.
Note that if dV/dt is negative definite, then the system is exponentially stable. We then have following theorem [8]:
Theorem 3.1. The system (3.3) with initial condition (3.)) and boundary conditions (3.5)-(3.6), with uo and uL such that (3.7) holds, is exponentially stable if there exist p &gt; 0 and pi &gt; 0, i = 1, .. ., n such that
1. The boundary quadratic form
( I (£, i) I (0, i) ) ( AP0(L) — aP(#) ) (	,
is positive definite under the constraints of the linear boundary conditions
&lt;+ (0, t) — Kooi+(L, t) — Koi&lt;-(0, t) = 0, C(L, t) — K!oi+(L, t) — Koi&lt;-(0, t) = 0,
Vt &gt; 0 along the solutions of system (3.3) with initial condition (3.)) and boundary conditions (3.5)-(3.6), with uo and ul such that (3.7) holds.
2. The matrix —p| A|P + Mt P( x) + P(x)M is negative definite Vx e (0, L).
Definition 3.2. Boundary conditions that satisfy condition 1 of the previous theorem are called dissipative boundary conditions.
3.2.2	Explicit dissipative boundary conditions
In this section, we will show a variant of Theorem 3.1. This approach allow us to obtain an explicit characterization of a dissipative boundary condition which guarantees the system exponential stability in the case where ||M|| is sufficiently small.
Let Dp denote the set of diagonal pxp real matrices with strictly positive diagonal entries. Then, the Lyapunov function (3.8) is rewritten to
r L
V = / [(&lt;+TPoI^ '	+ (&lt;-Tdx, (3.9)
where p &gt; 0 and Po e Dm, Pi e Dn.
Consider the following norm for the matrix K:
p(K) A inf {||AKA -i||, A e S} ,	(3.10)
where || • || is the usual matrix 2-norm and
S = {A = diag{Do, Di}, D0 = P0A+, D? = PiA -} .	(3.11)
We have then the following theorem:
Theorem 3.2. If p(K) &amp;lt;1, there exist £ &gt; 0 such that, if \\M\\ &amp;lt;£, then the linear hyperbolic system (3.3) with initial condition (3.4) and boundary conditions (3.5)-(3.6), with uo and ul such that (3.7) holds, is exponentially stable.
Proof. Consider the candidate Lyapunov function (3.9). The time derivative of V is
dV
dt
= d (&lt;+TPoA+ C+) e-dx+/° dx (* -TPiA -C -dx
+
(MtP + pm) C dx.
(3.12)
where P A (Poe ¡ix. Pie^x).
Then, integrating by parts:
% = Vi+ V2,	(3.13)
where
Vi a
[C+TPoA+e+e-^x] L + [c-TPi ATe^] L ,
V2 A j CT (-pPA + MTP + pm) C dx.
To show that dV/dt is negative definite we will show that Vi and V2 are negative definite.
In order to show that Vi is negative definite we introduce the following notations:
Substituting the boundary condition (3.7) in V1, we have
Vi = - [&lt;+TPoA+e+e-^x]L + T PiA-CeMX]L
= - (e+T PoA+e+e-^+e	m-e-) +
(e+T kTO+e-T kTi) PoA+ (Koo&lt;+ + Koieo) +
(e+T Kfo+e-T KTi) PiA- (Kioe++KUe-) ■■.	(3.14)
Since p(K) &amp;lt;1 by hypothesis, there exist Do G Dn, D1 G Dn-m and A = diag{D0, Di} such that
IIAKA-11| &amp;lt;1.	(3.15)
Select Po and P1 such that P0A+ = DO and P1A- = Dp
Define z0 = Do£-, z1 = D1e+ and zT = (zT,zT). Then, using the inequality (3.15), we have
(e+T kTo+e-T KTi)PoA+(Kooe++Koie-) + (e+T K0+ e-TKTi)PiA-(Kioe+ + Kiie-) = ||AKA-iz||2 &amp;lt;||z||2
= e+TPoA+e++e-T PiA-e-.	(3.16)
Comparing (3.16) with (3.14) we can therefore conclude that there exists p, sufficiently small such that V is negative definite.
In order to show that V2 is negative definite, it is easy to see that if there exist £ &gt; 0 such that ||M|| &amp;lt;£ then there exists a &gt; 0 such that
dV
V2 &amp;lt;—aV	— = Vi + V2 &amp;lt;—aV.
dt
Consequently the solutions of the system (3.3) with initial condition
(3.4)	and boundary conditions (3.6) exponentially converge to the origin in L2 -norm.	□
3.3	Application of the boundary control strategy to the suppression of slugging oscillations in oil facilities
3.3.1	Steady-state and linearized system
We assume that the steady-state solution for system (A.10) is a constant solution e(x, t) = e*, Vt G [0, +^), Vx G [0, L], satisfying the boundary
conditions (A.6)-(A.8) and the condition
2 (1—u£ )(”(1—u£ )M2uf +2MRTpiu£uP + R2T 2pfu £ fu3-----"--------------------L--------
2 AMdpi uf ((1-u£ )Muf + RTpiu£)
AMpi
■tz-#	—-gsin0(x).
(1—u£)Muf + RTpiu 3^	- 7
In order to linearize the system (A.10) and its boundary conditions (A.6)-(A.7), we define the deviations of the states v1(x, t), v2(x, t) and v3(x, t) with respect to the steady-states v*, v* and v* by
6vi(x, t) = vi(x, t) — v*,
5v2(x, t) = v2(x, t) — v2,
Sv3(x, t) = v3(x, t) — v3.
Then, the linearized quasilinear model (A.10) around the steady-state (see [52]) is described by
^dtU(x, t) + F(u*)(x, t) + S(u*)6u(x, t) = 0,
(3.17)
where
Ju = [ Ju1 5v2 8v3 ]T ,
u* = [ V* V* v* ]T ,
S(u*) 4 [ dS(u*) d(u*) dS(u*) ] .
Let ql = (1 — U;h’2. Then, the linearized boundary condition (A.6) results in the following expression:
PI6vi(0, t) + (1 — U*)£v2(0, t) — u2£^(0, t) = 0.	(3.18)
Similarly, consider qg = u3u2. Then, the linearized boundary condition (A.7) is given by
v*8v2(0, t)+ v*8v3(0,t) =0.	(3.19)
Finally, the linearized boundary condition (A.8) is expressed as
8v2(L, t) = Kuf 8v1(L, t) + Ku38v3(L, t) + Ku8u(t),	(3.20)
where bu(t) = u(t) — u*, being u* the choke opening steady-state value, and
Ku3
KV1
(pLRT — u*)u2
2(pLRTv3 + (1 — u3)u*) ’
rLu Wl//cy ■ i u3p-wL///ty________u2
2(pLRTv3 + (1 — u3 )u *)	pLv *(u *
PsY
Ku
= Cout
_______PLu*______
PlRTv^ + (1 — ui )u *
(u*
Ps)-
&gt;
3.3.2	Model in terms of characteristic coordinates
In this section, we transform the system (3.17) into the so-called characteristic form by using the characteristic coordinates [52].
To this aim, let us consider the following change of coordinates:
£1 (x , t) =	Ju2(x ,	t) +	adu3(x ,	t) +	bbu 1 (x ,	t),	(3.21)
£2(x , t) =	Ju2(x ,	t) +	aJu3(x ,	t) —	bbu i(x ,	t),	(3.22)
£3(x, t) =	Ju3(x,	t),	(3.23)
where
RTpiV2 — MuiV2 ( 1—U3)Mui+RTpiU3 i
b __ p Aui VM3 RTV3 — MRTV3V2
=	Mui(( 1—U3)MuiRTpiU3) '
With these new coordinates, the system (3.17) is rewritten in the following form:
d£	d£
-^1 (x, t) + A(x, t) + S£(x, t)=0,	(3.24)
with
£ = [ £1 (x, t) £2(x, t) £3(x, t) ]T ,
and A is the matrix with the transport speeds, given by
with
A=
A 1	0	0
0 —|A2|	0
00	a3
(3.25)
(( 1—U3) AMv 2 + ART P1V3V 1) VMARTvI, AM2 RTP1V3V 1
I u2( 1— u3)	1
'	Api	+
RU3U2
AMui ,
A	((1—u3)AMu]i+ARTpiu3ui) VM 3RTu3
A2 =	AM 2RTpiV3U i
U2(1—U3)
Api
I RU3U2
1 AMui ,
A3 = —U2
(1—U3)Mu i +RTpiU3 AMpiu i
A 1 =
these expression satisfy the following inequalities:
Vx € [0, L],	X2 &amp;lt;0 &amp;lt;A3 &amp;lt;Ax.
The expression for S is complicated to be written in details. Then, to save space, we express its structure as
	0-1,1	01,2	&amp;amp;1,3
S =	02,1	^2,2	&amp;amp;2,3
	0	0	0
(3.26)
Note that the last line of S is filled with 0. This occurs because the state variable u3(x, t) is a Riemann invariant [53]. This structure is also preserved by the transformation shown in this section.
Several numerical tests performed for the system considered in this work (see Table A.1 for details about the system geometry) have shown that the following inequalities hold:
&amp;amp;1,3 = ^2,3 &amp;lt;0 &amp;lt;CT1,1 = ^2,1 &amp;lt;&amp;amp;1,2 = ^2,2
Typical values are ct1,3 = a2,3 « -425, a1,2 = a2,2 « 15224, and ^1,1 = ^2,1 ~ 0.4.
Finally, the boundary conditions (3.18)-(3.20), in characteristic coordinates, are expressed as
£1(0, t) -&amp;lt;2(0,t)=0,	(3.27)
^2(L, t)	+ k1£1(L,	t) +	k2£2(0,	t)	+ k3£3(L	t)	=	0,	(3.28)
£3(0, t) - .,P (0, t) = 0,	(3.29)
or in matrix form
£1(0, t)
&amp;amp;(L, t)
£3(0, t)
0		0	’ £1 (L, 0) ■
-k1	-k2	-k3	£2(0, t)
0	A	0	£3.L-, t)
K
(3.30)
7
where
A
PIU3
PIau3 — 2u.,u2 — PIbu^ ’
u, + 2bu2
u3 — 2bu2,
and fej, i = 1,3 are constant design parameters that have to be tuned to guarantee the stability of the linear system (3.17), as will be shown in the next section.
The change of coordinates (3.21)-(3.23) is inverted as follows:
£i(x, t) + &amp;amp;(x,t) - 2a^(x, t)
¿u1(x, t) = --------------2---------------
x	£1(x, t) -
dv?(x, t) = ------------------,
¿«3(x, t) = &amp;amp;(x, t).
(3.31)
(3.32)
(3.33)
3.3.3	Stability analysis
Using Theorem 3.1 and Theorem 3.2 the system stability under the boundary conditions (3.30) may be expressed as the following two conditions:
1.
0
0
yAipi
I A3 |p3
0
0



^A2P2
I A3 |p3
(3.34)
&amp;lt;1
2.
k1|A3|p3
Aipi
MA3IP3
A2P2
k3
(Mi + 2aii)pie-^x ^2'p2'+ ffi2Pie-MX ai3Pie-MX
CT2iP2eMX + ^i2Pie-^x
(^|A2I + 2^22 P2'"' ^23p2'
Q
^i3Pie-^x \
^23P2eMX	I
M3P3e-MX /
(3.35)
is positive definite.
Note that condition (i) is satisfied if and only if
^AmaxAKA T(AKA)) &amp;lt;1,
where Amax(-) denotes the maximum eigenvalue of its argument.
A sufficient condition for Q to be positive definite is that its principal
minors be strictly positive. This fact results in the following inequalities:
pAi + 2'ii &gt; 0,	(3.36)
p|A2| + 2'22 &gt; 0,	(3.37)
(pAi + 2aii)(p|A21 + 2.'&gt;22)piP2 - ^2'p2'	+ 'i2Pie-MX)2 &gt; 0, (3.38)
pX3p3e-^x [(pAi + 2'11 )(p|A21 + 2'22)piP2 - ('21P2'	+ 'i2PieMX)2] -
'23P2eMX [(pAi + 2'11)'23P1P2 - '&gt;2'/'2'/;' + '12Pie-MX)'13Pie-MX + ' 2;p-'	[('2iP2eMX + 'i2Pie-MX)'23P2eMX-
(p| A2 | + 2'22)'13P1P2] &gt; 0,	(3.39)
Conditions (3.36)-(3.37) are satisfied for any p &gt; 0. Condition (3.38) is satisfied for sufficiently small p &gt; 0 if the parameters p1,p2 are selected such that '12p1 = '21p2, as shown in [52]. Indeed, the term ('21p2e-MX + '12p1eMX)2 is maximum either at x = 0 or at x = L. For x = 0, we have
(pAi + 2'ii)(p|A21 + 2'22)piP2 - ('21P2 + ' 12P1 )2
=	P1P2	(p2Ai|A2|)	+ 2p ('22Ai	+ 'ii|A2|)	- ('22P2	- '12P1)2
=	P1P2	(p2Ai |A21)	+ 2p ('22A1	+ '111A21)	&gt; 0,
for any p &gt; 0. On the other hand, for x = L we have
(pAi + 2'ii)(p|A2 | + 2'22)piP2 - ('2iP2eML + '32P3e(ML)2
= P1P2 (p2 Ai |A2 |) + 2p ('22 Ai + '11 |A2 |) -
('22P2eML - 'i2Pie-ML^ &gt; 0,
for p &gt; 0 sufficiently small because the function
F(p) 4 ('np2e-ML - '22P3eML)2
is exponential in p.
Finally, inequality (3.39) is satisfied for a sufficiently large p3. It follows that there exists a &gt; 0 such that
dV
V2&amp;lt;	-aV	=^	— = Vi	+ V2	&lt;	-aV	v&amp;lt;=	0.	(3.40)
dt
Hence, V is a Lyapunov function along the solutions of the linearized slugging model and its solutions exponentially converge to 0 in L2([0, L]; R3)-
Remark 3.1. The Lyapunov function used in this section to show the stability of the linear system cannot be used to analyze the local stability of the nonlinear case. To this aim, an augmented Lyapunov function must be used, to prove convergence in H2-norm. This proof is much more complicated than the linear case shown in this section. More detail about the nonlinear case are given in [7, 52].
3.3.4	Design of the control law
In the previous section, we have seen that the system stability is guaranteed if the feedback control law (3.28) holds. Therefore, in this section we shall present how the explicit expression of the control law can be obtained using the boundary condition (3.20).
We introduce the following notations:
&lt;ML) = ML, t),
¿«2(P) ¿u2(L, t),
¿«s(L) ¿vs(L, t),
¿«1(0) = ¿«1(0, t),
¿«2(0) = ¿«2(0, t), ¿«3(0) = ¿«3(0, t).
Using the definition of the characteristic coordinates (3.21)-(3.23) the boundary condition (3.28) is rewritten as
¿«3(L)(a+feia+fe3) — ¿«i(feib —¿^¿«3(L)(1 + fei)+fe2 (¿«2(0)+a^«3(0)-
^¿v1 (0)) = 0. (3.41)
Then, by eliminating ¿u3(L) between (3.20) and (3.41), and eliminating ¿u2(0) and ¿u3(0) between (3.18), (3.19) and (3.41), we get the following expression for the control law
u(t) = u* + KPu2 ¿«2 (L) + /w . ¿«1 (L) + Kpo ¿«1 (0),
(3.42)
where
Kp.
Kp.
Kpo
£3 + Ku3 + a + k1 a + k1Ku3
Kz (a + k1a + k3)	’
Kz (a+kia+M ^k1b — b — ~K]~ (a + k1a + ^3)) , Ku3 k2 (PI(a«3/«2 — 1) — b)
Kz (a + k1a + k3)	'
2
1
It must be noted that the feedback control law (3.42) needs measurements of pressure at the outlet valve, the bottom pressure and total flow-rate
Time (h)
Figure 3.1: Bottom and top pressure, and choke opening with the proposed control law. At t = 3.3 h the control was switched on and at t = 15 h the control was again switched off.
measurement through the outlet valve. For the simulations results shown in Section 3.3.5, we consider that all these variables are being measured. In some real cases this is not true. Therefore, the use of a state observer together with the control law is probably the best option in these cases.
3.3.5 Simulation results
This section shows the simulation results obtained when using the proposed controller to stabilize the quasilinear model (A.10). We consider a 2500 meter long vertical well with reservoir pressure Pr = 180 bar and separator pressure Ps = 10 bar. Table A.1 gives a list of the parameters used for the computations. The space was divided in N sections and the space derivatives were written using a finite difference scheme. An ODE solver was used to obtain the solution.
In Fig. 3.1 the results obtained with the control technique proposed in this thesis are shown. The operating point was chosen to be Z* = 48%. The steady-state values of u* (0), u* (L) and u* (L), necessary for the control
law, can be obtained by computing the steady-state model (A.10) in such operating point. The controller gains were chosen to be ki = -0.5, k2 = 2.3 and = 300. These parameters were found after several simulations in order to improve the control system performance. At t = 3.3 h the control was switched on. It can be noted that the oscillations are suppressed and the system remains in the desired operating point. At t = 15 h the control was switched off and as expected, the system comes back to the oscillatory regime.
3.4	Conclusions
In this chapter we studied the boundary stabilization problem in linear hyperbolic PDE systems by using dissipative boundary conditions. We have shown, by means of a Lyapunov function, that under certain considerations in boundary conditions, the solution of the system decays exponentially to the origin in the L2-norm. These results were applied to the slug control problem in oil facilities. Although the theoretical results guarantee stability only for the linearized system, simulations have shown relatively promising results when the control law is applied to the nonlinear system.
Chapter 4
Boundary control of a Rijke tube using irrational transfer functions
This chapter is concerned with boundary stabilization of thermoacoustic oscillations in the Rijke tube. To study this problem we consider that the mathematical model takes the form of two interconnected compartments. Each compartment is described by the linearized Euler equations of gas dynamics and the interaction between these compartments is given by the heater model. The control input is applied on the left boundary condition of the cold zone (see Appendix B). From this model we derive an irrational transfer function to design a stabilizing boundary control in the frequency domain. In particular, we derive necessary and sufficient conditions for the input-output stability through the use of Nyquist-type test. Experimental results show the effectiveness and real-life applicability of the method. The chapter is organized as follows. Section 4.1 presents the characterization of the transfer function. The closed loop system and its stability is studied in Section 4.2. The experimental results are shown in Section 4.3. Finally, the main conclusions are presented in Section 4.4.
4.1	Open-loop transfer function of the Rijke tube
In the following, we will compute a transfer function G(s) from the speaker to the microphone pressure based on model (B.2)-(B.7). To derive this transfer function, note that equations (B.2)-(B.3) represent the wave equation. To see that, take both a time and space derivative in (B.3) and subtract
the resulting expressions. One obtains
dttF&gt;i(t, xi) = c'd,,/' t, xi),	i = 1, 2	(4.1)
where c = y Ypp is the speed of sound.
It is well known that the solution of (4.1) is given by the D’Alambert formula [54]. Therefore, the acoustic pressure in the upstream propagates according to
Pi(t,x) = f (t — C) + g (t + D , —x„&amp;lt;x&amp;lt;0,	(4.2)
and similarly to the downstream side
P2(t,x) = h (t — C) + j (t + C) , 0 &amp;lt;x &amp;lt;xd,	(4.3)
where f, g, h, j are arbitrary function (not stated and unimportant for the following developments) which satisfy the boundary and initial conditions.
Using (4.2)-(4.3) and (B.2), we obtain the velocity fluctuations at the upstream and downstream part of the tube:
vi(t, x) =	pc	f	(t — D — g (t + 0) ,	—x„&amp;lt;x&amp;lt;0,	(4.4)
V2(t, x)=	Pc	(h	(t — C) — j (t + x)) ,	0 &gt; x &gt; xd.	(4.5)
Considering x = 0 and substituting (4.2)-(4.5) into (B.4)-(B.5), and applying the Laplace transform into these equations, we obtain
X (•**.’) ) = Y ( J w )+ Z*’&gt;,	46
where G, —, F and J are the Laplace transform of g, h, f and j, respectively, and
—1
X(s’ =
1	hv
TS + 1 ’
yPA
(4.7)
(4.8)
(4.9)
From the boundary conditions (B.7), we obtain that f (t) = — g (t — 2y2) + u(t — Xr) and j(t) = — h (t — 2yr). These reflections at tube ends are modeled for ideal condition. A more realistic model should include acoustic reflection losses at the boundary. Therefore, we introduce the constants Ru, Rd G ( —1, 0) to account for acoustic reflection losses. It follows that these boundary conditions are rewritten to
f (t) = R„g (t — r„) + u(t — y) ,	(4.10)
j(t) = Rdh (t — Td),	(4.11)
where tu = 2 — and Td = 2	.
Taking the Laplace transform of (4.10)-(4.11) and substituting them into (4.6) we finally obtain
— 1 — R„e-T“s (1-R"ye U } (1 + Y^(s))
1 + Rde-Trs
1-Rde-Tds
Y
e 2s
Y
e 2 s
(4.12)
where U is the Laplace transform of u.
Notice that from (4.12) we obtain
H (s)
U (s)
2e- 2s Y det(S)
(1 + 7^(s))
(4.13)
where
— 1 — R„e-T“s (1-R2e U } (1 + 7^(s))
1 + Rde-Tds
1-Rde-Tds
Y
The open-loop transfer function required, G(s), is from the speaker to the microphone pressure Pmic. This can be obtained from (4.13) and by expressing Pmic in terms of the acoustic waves using (4.3):
G(s) =
Pmic ( s )
U (s)
_( )s r .
2e (	c	)s	2 ’ m,c ’d\ s
(1 + Rde I c ) )(1 + 7^(s)),
Y det(S)

16000
14000
— 12000 N
-"10000 -
w
3 8000 -
&gt;&gt;
| 6000
CD
4000
2000
0
-6
131 Hz
x
-4	-2	0	2	4
Real axis (Hz)
Figure 4.1: Location of the poles of the open-loop transfer function (4.14). They were calculated numerically by finding roots of (4.15). Note that there is an unstable pole at 131 Hz on the imaginary axis, and infinite stable poles that tend asymptotically towards (4.16).
4.1.1	Poles and zeros of the open-loop system
The poles of G(s) characterize the open-loop dynamic behavior of the linearized system. They are given by the solutions of the following equation:
V&gt;(s)	7PA(rs + 1)(1 - Rde-Tus)(1 - Rde-Tds)-
(1 - R„e-Tus)(7PA(rs + 1) + 7h^)(1 + Rde-TdS) = 0. (4.15)
In general, this equation has no explicit solution. Numerical resolution for the values in Table B.1 leads to the poles depicted in Figure 4.1. As can be seen, there is a pair of unstable complex conjugated poles at the frequency 131 Hz on the imaginary axis, which corresponds to the frequency of oscillation, and infinite poles on the left hand side of the complex plane. The following proposition provides a closed solution of (4.15) to explain the poles behavior for high frequency:
Proposition 4.1. When |s|	0, the solutions of (4-15) tend asymptotically
towards
log(R„Rd)	2jnk
P±k =	±	,	(4.16)
Tu + Td	Tu + Td
where k e N, and the approximation error is at the first-order given by:
P±k ~ P±k -
fi(p±k ) fi'(p±k ) .
(4.17)
Proof. Equation (4.16) follows directly from a high frequency analysis of (4.15).
Writing the Taylor expansion of fi around p±k = p±k + p±k + o(p'±k) we get
fi(p±k) = fi(p±k) + fi'(pk )p±k + o(p±k).	(4.18)
Note that fi(pk) = 0, and fi'(pk) = 0. Therefore, equation (4.18) leads to (4.17). This concludes the proof.	□
The zeros of (4.14) are the values of s such that G(s) is zero. In this case, the zeros are given by
z±k =
log ( Rd)	jkn
2 xmic xd	xmic xd ,
(4.19)
where k e N.
As can be seen in (4.19), the zeros have real negative part and therefore are in the left-hand side of complex plane. Furthermore, it can be seen from this equation that the microphone location only affect the zeros of the system. The poles remain unchanged independent of the microphone position.
4.2	Closed-loop system
4.2.1	Proposed control law
As shown in Equation (B.8), the thermoacoustic oscillation in the Rijke tube occurs when acoustic energy is greater than the loss. The gain and loss of energy depend on the acoustic field. However, conditions can change completely if the field in the tube is disturbed by a different sound source, which in this work is produced by a loudspeaker. The inclusion of a sound source changes the difference between energy gain and loss, which can become larger or smaller than the unperturbed acoustic field.
Therefore, it is reasonable to consider the control law given by
where Kc and tc are design parameters. Note that with this control law the loudspeaker reproduces an amplified and delayed pressure wave of the tube.
4.2.2	Stability analysis
In this work, the following definition of stability is adopted.
Definition 4.1. If a system maps every input u G L2([0, to); C) to an output y G L2([0, to); C) and
lly|L2([0, to)) sup ij-jj--------- &amp;lt;to,
u=o IIuIIl2([0, to))
the system is stable. A system is said to be unstable if it is not stable.
Remark 4.1. Stability of systems described by their transfer functions can be checked by Theorem A.2 of [55]. In this case, a linear system is stable if and only if its transfer function G belongs to H00 (C+; C).
With control law (4.20), the closed-loop transfer function is given by
G-(‘&gt; = 1 - GSU ■	(4;21&gt;
where C(s) = Kce-TcS.
For the stability result we will use the following necessary and sufficient condition [56].
Theorem 4.1. The closed-loop system is stable if and only if
1.	inf	|1 - C(s)G(s)| &gt; 0
Re(s)&gt;o
2.	C(pi) = 0, i = 1, .. ., no, where pi are the poles of G in C+.
Condition 1 of Theorem 4.1 can be checked through the graphic Nyquist criterium. In our case, the open-loop is non stricly proper, and the application of the graphic Nyquist criterium is more delicate [56]. Condition 2 of the previous theorem corresponds to a condition preventing an instability due to the cancellation of an unstable pole of G by a zero of C.
Since the proposed control law (4.20) is not strictly proper, we have to take into account the behavior of the Nyquist plot at infinity. We propose below a way to circumvent this problem by analyzing the closed-loop poles for high frequencies. First, we state a technical result that will be used in the stability analysis.
Lemma 4.1. Consider the neutral delay equation
M
1 - £ aie-riS =0,
i=1
(4.22)
with the components r = (ri, r^, ..., ru) rationally independent1 * *.
The solutions of (4.22) lie in the left of complex plane if and only if
M
E N &amp;lt;I-	(4.23)
i=1
Proof. See Theorem 2.2 and Corollary 2.4 of [57].
□
Consider that the system fulfills the following assumption
Assumption 4.1. The set
r = {xu + xd,
CTc + Xd + x
mic,
CTc + 3xd — x
mic
},
is rationally independent.
Then, we have the following result:
Proposition 4.2. Let tc, xmic &gt; 0 such that
r	(xu + xd- cTd + xd + xmic, cTc + 3xd	xmic) ,
is rationally independent. Then, the following inequality is a necessary condition of closed-loop stability:
|Kc|(1 + |Rd|) &amp;lt;1 — RdRu	(4.24)
Proof. For |s|	0, the closed-loop poles can be approximated as the
solution of
1 — RuRde-(Tu +Td)s — Kce
(

)
s

— KcRde
^CTc +3xd-xmi^ s
= 0.
(4.25)

Then, choosing tc, xmic &gt; 0 such that
r = (Xu + Xd, CTd + Xd + Xmic,
CTc + 3Xd — X
mic
),
is rationally independent we can apply Lemma 4.1 to obtain the inequality (4.24). This concludes the proof.	□
1We say that the real numbers ai, an are rationally independent if the only
n-tuple of integers ki, ..., kn such that kiai + ••• + knan = 0 is the trivial solution in
which every ki, i = 1, ...,n is zero.
Using this result we can restrict the test of the Nyquist criterion to a finite range of frequencies, as stated in the corollary bellow.
Corollary 4.1. If Proposition f.2 is verified, then there exists so &gt; 0 such that condition 1 of Theorem f.1 needs only be tested on a finite range |s| &amp;lt;so.
Proof. For sake of simplification in the following computations, define G(s) as the approximated transfer-function of (4.14) for |s|	0.
Note that if Proposition 4.2 holds, then there exists £ &gt; 0 such that
|1 - C(s)G(s)| &gt;£.
Moreover, for |s| &gt; s0 we have that
||C(s)G(s)|-|C(s)G(s)||&amp;lt;£.
It follows that,
|1 - C(s)G(s)| &gt; ||1 - C(s)G(s)| - |C(s)G(s) - C(s)G(s)|| &gt; 0.
Therefore, there exists s0 such that |1 - C(s)G(s)| &gt; 0 when condition
□
(4.24) is satisfied.
The Nyquist stability criterion which accommodates infinite dimensional system is stated in the next theorem [3].
Theorem 4.2. Let g be a function which is meromorphic on an open set containing C+ and suppose that g has no poles or zeros on the imaginary axis. Furthermore, assume that g has a non-zero limit at to in C+, i.e., there exists a g(TO) G C, g(TO) = 0 such that
lim sup	|g(s) - g(TO)| = 0.
P -	,,	,
sec+,||s||&gt;p
Then g has at most finitely many poles and zeros in C+ and
2nj J-- gj-	2n	-
where No and Po are the number of zeros and poles of g, respectively, in C+. Furthermore, No - Po equals the number of times that g(jo), known as the Nyquist contour, winds the origin as o decreases from +to to -to.
In the next proposition we show the conditions that the Nyquist contour must obey in this finite range of frequencies in order to guarantee the stability of the closed-loop system.
Proposition 4.3. Let nu be the number of open-loop poles of (4.14) in C+. Denote the Nyquist contour of
^(s) 1 +
2Ke (	c	)s	2xmic-x^s
(1+ Rde 2 c ' )x

(Y — 1)det(S)
(1+ YXs))	(4.26)
by r^(s). Then the transfer function Gci is
1. Unstable if r^(s) does not encircles the origin nu times in the clockwise direction.
2. Stable if r^(s) encircles the origin nu times in the clockwise direction.
In the limiting case that r^(s) does not encircle but crosses —1, the stability is undetermined.
Proof. First we have to show that ^(s) is meromorphic in C in order to apply Theorem 4.2. Note that the exponential function is an entire function and it is well-known that the composition of entire functions also results in an entire function. Thus is expressed as the ratio of entire functions, meaning that it is meromorphic. Further,
lim
sup	|^(s)|
_{s£C+ | |s| &gt;m}
= 0.
Next we show that ^(s) has finitely many poles in C+. Note by (4.26) that the poles of are the same as the open-loop system. Therefore, by Proposition 4.1, we now that the poles are asymptotic to (4.16), which clearly have negative real part. Assume that the open-loop system is unstable (if the open-loop system is stable than there is nothing to do because there are not poles in C+), then there exist poles in C+. We have to show that there are finite poles in C+, say p±1, ..., p±n0. Indeed, since the open-loop poles are asymptotic to (4.16), then there exists n0 6 N such that Vn &gt; no Re(p±n) &amp;lt;0. Therefore, there are p±1, ..., p±n0 poles, with n0 6 N, in C+. Define nu = 2n0. Then, nu is the counterclockwise number that the Nyquist contour of encircles the origin. Likewise, the number of zeros of - that is, the closed-loop system poles - in C+ is the number of times the Nyquist contour of encircles the origin in the clockwise
Real axis
Figure 4.2: Nyquist plot of r^(s) showing two clockwise encirclements of the origin as w decreases from I to to —to.
direction. This means that Gcl G HTO(C+; C) if r^(s) encircles the origin nu times in the clockwise direction and Gcl / HTO(C+; C) if r^(s) does not encircles the origin nu times in clockwise direction, making it a stable or unstable transfer function according to Theorem 4.2.	□
In sum, the necessary and sufficient conditions developed in this section can be checked by the algebraic equation (4.24) and by choosing tc and xmic such that Assumption 4.1 and the Nyquist criterion are satisfied.
4.3	Results
In this section, we present results of real experiments in the Rijke tube configuration described in Section B.1 with control law (4.20).
We choose Kc = 0.002 in order to satisfy inequality (4.24), and tc was designed in order to r^(s) encircles the origin twice in the clockwise direction since, as shown in Figure B.3(a), the system has a pair of complex conjugated poles in C+. The Nyquist plot of r^(s) for tc = 0.001 is depicted in Figure 4.2. There are two clockwise encirclements of the origin as w decreases from +to to —to. Thus, the closed-loop system must be stable and should be reasonably robust to plant's uncertainties and changes.
Unfortunately, the value of tc must be chosen by trial and error, since we have not developed analytical conditions for this control parameter.
Figure 4.3 shows the sound pressure at the microphone location and the control signal with the control law (4.20). At the beginning of the experiment, no controller is active, and the system is in the limit cycle. At t = 3.5 s the controller is actived. It can be noted that the oscillations are suppressed and the system remains in the operating point. At t = 12 s the control is deactivated and as expected, the system comes back to the oscillatory regime.
Figure 4.3: Pressure fluctuations at the microphone location and control signal as a function of time. At t = 3.5 s the controller is actived. At t = 12 s the control is deactivated.
4.4	Conclusions
We have addressed the issue of boundary stabilization of thermoacoustic oscillations of the Rijke tube by a frequency domain approach. We have used some properties of the system transfer function to derive necessary and sufficient conditions for input-output stability of the boundary controlled system. Experimental results for a Rijke tube prototype shows the effectiveness of the proposed approach.
Chapter 5
In domain control of quasi-linear hyperbolic systems
In this chapter we are concerned with tracking and disturbance rejection problem in 1-D quasilinear hyperbolic systems, where the control variable is modeled in the domain of the PDE system. The control methodology is based on the sliding mode control strategy together with the method of characteristics. This proposal allows us to characterize the sliding regimes and their fundamental properties by a geometric approach. A basic material about the main concepts of this methodology is presented in Section 5.2. An approach to apply this control methodology in systems with relative degree one is shown in Section 5.2.1. Also in that section, a smooth control law is developed based on the concept of equivalent control, and experimental tests on a solar collector field are presented to show the effectiveness of the approach. In Section 5.2.2, we present this control methodology for systems with relative degree two. In the end of this section, we apply the obtained results to the pH control problem of a tubular photobioreactor. Concluding remarks are discussed in Section 5.3.
5.1 Definitions and notations
We are interested in the following 1-D n x n quasilinear hyperbolic systems:
(x,t) + A(u(t))H(x,t) = f«(x, t)),
where t e [0, to) is the time variable, x e [0, L] is the space variable, £ : [0, to) x [0, L] Rn is the vector of state variables, A : R Mn,n(R) and f : Rn Rn. The control variable is u : [0, to) R and the controlled variable is denoted by y : Rn R. We assume that the system relative degree1 is at maximum two, i.e., the controlled variable must be differentiated at most twice to obtain an explicit relation with the control variable. Moreover, we assume that A is a diagonal matrix:
A = diag{Ax, A2, ..., An},
and A1 = u(t).
The initial condition of (5.1) is
i x- 0) = ^(x^ x e [0,H	(5.2)
where £0 e C 1([0, L]; Rn), and the boundary conditions are
9i,0(£(t, 0)) = 0, t e [0, +to),	(5.3)
9i,L(£(t, L)) = 0, t e [0, +to),	(5.4)
i = 1...
where gifi, gi,L : Y	R.
The existence and uniqueness of the solution of (5.1)-(5.4) can be proved using the method of characteristics. Then, if £0(x) is a continuously differentiable function of its arguments, one can show, using Theorem 2.2, that the solutions are continuously differentiable with respect to their arguments, i.e., £(x, t) e C1([0, L] x [0, +to);Rn). Moreover, since the i-th equation of system (5.1) is an ordinary differential equation along the i-th characteristic we can use the Caratheodory theorem for ordinary differential equation to guarantee existence and uniqueness of the solution even when u is discontinuous [58].
In terms of characteristic equations, system (5.1) is given by
d^i
di (xi(x, t, s),Ti(x, t, s)) = fi(C(xi(x, t, s), Ti(x, t, s))), dx ■
-1 (xi(x,t, s),Ti(x,t, s)) = Ai(£(xi(x,t, s),u(Ti(x, t, s)))), ds
dTi
-A (xi(x,t, s), Ti(x,t, s)) = 1,
ds
(i = 1 ..., n)
(5.5)
1A similar concept, called characteristic index, was introduced by Christofides and Daoutidis [15]. However, in this thesis, the term relative degree is preferred over characteristic index.
or briefly
dzi
dt
Ki«(xi(x, t, s),Ti(x, t, s)), u(Ti(x, t, s)), Ti(x, t, s)),
(5.6)
(i = 1, ..., n), where
Ki
fi (C(xi(x, t, s), Ti(x, t, s))) Ai«(xi(x,t, s),u(Ti(x, t, s)))) 1
We recall that Ki is the i-th characteristic vector field of (5.1).
5.2	Distributed sliding mode control for quasilinear hyperbolic systems
Sliding mode control is a classical nonlinear control methodology characterized by a commuted control action. The main idea of this methodology is to design a surface in such a way that the system has some desired performance. Once on the surface, the system trajectories are induced to the desired operating point, i.e., a pseudo-equilibrium of the commuted system. If this pseudo-equilibrium is stable, the system trajectories remain there. A Lyapunov-like stability condition guarantees that the distance to the surface decreases along all system trajectories and constrains the trajectories to point toward the surface. The basic elements of this control methodology for lumped parameter systems can be seen in [59]. In this section, an approach for 1-D quasilinear hyperbolic systems, called distributed sliding mode control (DSMC), is presented following the ideas of [21, 22, 24].
The following switching control law determines the control action of system (5.1)-(5.4):
i	w+(C(x,	t),	x,	t)	if	h(£(x,	t), x,	t)	&gt; 0
1	u-(£(x,	t),	x,	t)	if	h(£(x,	t), x,	t)	&amp;lt;0
(5.7)
where u+ &gt; u- and h : Rn	R is the switching boundary function.
Under the switching control law (5.7), the characteristic equations (5.6), for i = 1, have two characteristic curves generated by the characteristic vector field k u+ and Ky u-, respectively. It is referred to k u+, when u = u+ is the control input and similarly Ky u-, when u = u-. The other characteristic vector fields, k2, ... ,Kn, are not affected by changing the control u from u+ to u-. Therefore, the characteristic curves associated
with k2, ..., Kn are not defined for both values of the binary switching control law.
Definition 5.1. The condition h(£(x, t), x, t) = 0 defines an isolated smooth manifold £(x, t) = y&gt;(x, t), called sliding surface, and is defined as
S = {(£(x, t), x, t) G Rn+2 : g(x, t) = ^(x, t)}.	(5.8)
At the points where S is a hypersurface, it is assumed that h is a smooth surface with locally nonzero gradient, except possibly on a set of zero measure.
Basically, system (5.1)-(5.4) with control law (5.7) has three different behaviors at the sliding surface: (i) crossing; (ii) attractive sliding; and (iii) repulsive sliding. The main idea in sliding control systems is to perform the following:
1.	to define the desired operating point (a stable pseudo-equilibrium point) in such a way that it is in the attractive sliding region;
2.	to guarantee that the system trajectories reach the surface (in finite time) from a defined local set of initial conditions.
If these objectives are achieved, then, once the system trajectories are on this surface they slide toward the pseudo-equilibrium point and remain there. In the next sections we describe a methodology to induce attractive sliding regime for systems with relative degree one and two, respectively.
5.2.1 The case of 1-D quasilinear hyperbolic systems with relative degree one
In this section, we will describe a methodology to induce attractive sliding regime for 1-D hyperbolic systems that fulfill the following assumption:
Assumption 5.1. The system (5.1)-(5.f) has relative degree one, i.e., the output y must be differentiated (in time) once to obtain an explicit relation with the input u. Furthermore, we assume that h(£(x, t), x, t) = h(£i(x, t), x, t).
Definition 5.2. An attractive sliding regime for systems with relative degree one is said to locally exist on an open set Sas C S if the total derivative of h satisfies
dh / /	\	\
dt (^i(x, t), x, t) &amp;lt;0, dh / /	\	\
dt (^i(x, t), x, t) &gt; 0,
if h(£i(x, t), x, t) &gt; 0,
if h(£i(x, t), x, t) &amp;lt;0.
(5.9)
Note that the total derivative of h along the characteristic lines can be computed by the Lie derivative of h with respect to the vector field k2:
dh dh dh dh
d = dTi+ deifi + dxiu = Lki-“ h
where LK1 u h denotes the Lie derivative of h with respect to the vector field Ki for a given control input u.
The next theorem, extracted from [24], exposes a relation between the PDE system (5.1)-(5.4) characteristic equations (5.6) and the switching control law (5.7).
Theorem 5.1. Suppose that system (5.1)-(5.f) satisfies Assumption 5.1. Then, an attractive sliding regime locally exists for system (5.1)-(,5.f) on an open set Sas C S, if and only if the phase flows corresponding to the controlled characteristic vector field exhibit a local sliding regime under the influence of some switching law (5.7).
Proof. Suppose an attractive sliding regime locally exists for (5.1)-(5.4) with control law (5.7), then the time derivative of h, evaluated on an open neighborhood of S satisfy (5.9). The total time derivative can be computed in terms of the directional derivative of h along the controlled characteristic direction field k2 u+ and k2 u-. The directional derivative is evaluated on points above and below the switching boundary function which lie in a small vicinity of the sliding surface. Then,
• If h &gt; 0:
dh
dt
dh dh dh + dTi+ dei fi + dxiu	L
K1, u +
h &amp;lt;0.
• If h &amp;lt;0:
dh dh dh dh dt dT1 + d£i 1 + dx1
L«1, u- h &gt; 0.
Hence the flows corresponding to the characteristic vector fields k2 u+ and Ki u- satisfy the conditions for the existence of an attractive sliding regime on an open set Sas C S.
Sufficiency follows by assuming an attractive sliding mode exists for the controlled characteristic system while hypothesizing that an attractive distributed sliding mode does not exist. By reversing the arguments presented above, a contradiction is easily established.	□
From now on, we can perform the analysis on the closed loop system using the characteristic equations.
In [60] it was shown, by a Lyapunov argument, that condition (5.9) guarantee reachability of the system trajectories to an open set Eas C E in finite time. Basically, to ensure that the system trajectories enter in the region of attractive sliding regime in finite time the time derivative of the Lyapunov function V = 1 h2dx must be such that dV/dt &amp;lt;— p(VV)a, where p &gt; 0 and 0 &amp;lt;a &amp;lt;1. Then, by the comparison principle for first-order differential inequalities [61] we obtain that 2vV &amp;lt;V(0) — pt, Vt. Since -\/V &gt; 0, then -\/V must reach VV = 0 in finite time, which means that V must reach V = 0 in finite time with upper bound V(0)/p.
Under attractive sliding condition, the system trajectories are constrained in h = 0. In this case it is also assumed that dh/dt = LK1,uh = 0. Let a solution to dh/dt = 0 exist. Then, we have the following definition:
Definition 5.3. For all states £ located on an open set of E, the unique control function, ueq, locally constraining the distributed trajectories on an open set Eas C E, is known as the equivalent control. The resulting dynamics, constrained to E, will be addressed as ideal sliding dynamics.
The flows generated by £ under the influence of ueq locally adopt an integral surface [24]. It follows that the gradient of h is orthogonal to the controlled characteristic vector field K1jMeq, i.e.,
dh dh dh
Lh =	+ deTf1 + dX1Ueq =	K1’“- &gt; =0-
• ueq
To see that ueq is well defined, we will prove in the next theorem that the above equality locally defines ueq in a unique way. Moreover, it will be established that the equivalent control is necessarily locally intermediate among the extreme feedback control laws u+ and u -.
Theorem 5.2. Suppose a sliding regime locally exists for system (5.1)-(5.f), with control law (5.7), on E. Then, there exists a unique smooth feedback control law u = ueq such that the characteristic direction field of (5.1) controlled by ueq locally adopts as an integral surface the graph of the function £(x, t) = p(x, t). Moreover, locally on E:
u &amp;lt;ueq &amp;lt;u ',
Proof. The proof amounts to demonstrating the existence of a smooth equivalent control for the corresponding attractive sliding regime of the characteristic system. Indeed, since the local invariance of h = 0 necessarily
requires dh/dt = 0, one has LK1 u h = 0. On the other hand, the existence of a local attractive sliding regime on S implies, necessarily, that locally on S: dLKh/du = 0, i.e., LK1 uh = 0 has, according to the implicit function theorem, a unique solution u = ueq. Hence, if an attractive sliding regime exists, the equivalent control locally exists and is uniquely defined.
Suppose now that an attractive sliding regime locally exists on S for the switching feedback control law (5.7). Then, locally on S, the following three relations hold:
LK1 u+ h &amp;lt;0	(5.10)
Lk1 , ueq h =	0,	(5.11)
Lk1 u- h&gt; 0.	(5.12)
Subtracting (5.11) from (5.10) and (5.12) from (5.11) we obtain
LK1 u+ h	LK,Ueq h &amp;lt;0,
LK1, ueq h	Lki u — h &amp;lt;0.
From the mean value theorem, there exists smooth functions u^ and u- such that
LK,U+ h	LK,Ueq h
(Vh, Ki,u+ - Ki,ueq) = (u+ - ueq){yh,dniu+ /du) &amp;lt;0,
LK,Ueq h — LK,U- h
(yh, K1,Ueq — K1,u-) = (ueq — u-)(Vh, 9k1u-/du) &gt; 0,
where u+ and u-, respectively, satisfy ueq &amp;lt;u+ &amp;lt;u+ and u- &amp;lt;u- &amp;lt;ueq, i.e., locally on S we have u- &amp;lt;ueq &amp;lt;u+.	□
Remark 5.1. The existence of u+ &amp;lt;ueq &amp;lt;u- is a necessary and sufficient condition for the existence of attractive sliding regimes.
Development of a smooth equivalent control law
It is well known that the switching control law (5.7) causes oscillations in the controlled variables and infinitely fast control actions are impossible to be applied in several systems with mechanical actuators. A possible solution to guarantee the reachability of the system to the sliding surface and, at the same time, to reduce the chattering problem is to design a continuous control law as
where uN is the control action designed for the reaching phase during which the system trajectories starting off the sliding surface moves toward it, and ueq is the control component that acts when the system is on the attractive region of the sliding surface. In what follows, a methodology, based on a Lyapunov function, to obtain such control law is described.
Consider the following Lyapunov function
V =|^ (h(fii(x, t), x, t))2 dx.
If dV/dt is negative definite, then the system trajectories will decrease until they reach the sliding surface. Evaluating such operation results in
dV
dt
h — dX dt
h (LK1 h) dX.
Note that if we take LK1 h = —Ah, then dV/dt &amp;lt;0, for any A &gt; 0. In fact, the implicit function theorem guarantees that LK1 h + Ah = 0 can be solved for u, since d(LK1 h + Ah)/du = 0, in order to get dV/dt &amp;lt;0. By the comparison principle for first-order differential inequalities, this implies that V(t) &amp;lt;V(0)e-Ai. Therefore, the system's trajectories decrease towards the sliding surface as t to given any initial condition.
The explicit expression of (5.13), after some algebraic manipulations, is given by
dhfi(i(.X, t)) + fi(£1(X, t)) + Xh(^i(X, t)) XXttÁX t))
(5.14)
Note that (5.14) is valid if and only if dh/dx = 0. With this result, we have proved the following theorem:
Theorem 5.3. Consider the system (5.1) with initial condition (5.2) and boundary conditions (5.4) and such that Assumption 5.1 is satisfied.. Then, the control law (5.14), with A&gt; 0 enforces the system trajectories of (5.1)(5.4) to the sliding surface h = 0.
Application to the solar power plant control problem
The solar collector field used to test the control methodology is located at the CIESOL (Centro de Investigación de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almería -Spain. A brief description of the process is given in Appendix C.
The control objective in a distributed collector field is to maintain the temperature of the field at a desired level. The reference value is set
according to the plant operation mode. The main disturbances are the inlet temperature variation, the ambient temperature and changes of the solar irradiance. The controlled variable is the mean outlet temperature of the collector loops and the control variable is the fluid velocity/flow by a pump. The flow range is 2 to 12 m3/h.
Since the objective in solar thermal plants is to maintain the temperature at a desired reference value, we consider the following sliding surface:
1 f *
h = Tf (x,t) - Tfref (x,t) + —	(Tf (x,t) - Tfref (x, tf)dt = 0, (5.15)
Ti J0
where the first term in the right hand side denotes the error between the measured temperature, Tf, and the set-point profile, Tf,ref. The second term corresponds to the integral of this error and T is the integral time constant, and (•) is the mean value of its argument. We assume that the set-point profile is given by
Tf,ref (x, t) = Tin(t) + S(x)(T*ut(t) - Tin(t)),	(5.16)
where Tin(t) = Tf (0, t) is the inlet fluid temperature, T*ut(t) is the desired outlet temperature at Tf (L, t), and S(x) is a spatial dependent function, where ¿(0) = 0 and d(L) = 1, and when x G (0, L) this function must be designed in such a way that (5.16) behaves as the stationary solution of (C.2).
Remark 5.2. It is important to emphasize that to achieve the reference error equal zero on the sliding surface (5.15), it is necessary and sufficient that the dynamics of the error is stable. This can be guaranteed by adequately choosing the parameter Tj,.
For this system we can not apply directly the switching control law (5.7). Therefore, we have to develop a continuous control law. In what follows we describe the development of such control law based on the approach described in Section 5.2.1.
Using the method of characteristics we obtain the following set of equations that generate the vector field np.
dTf
—T(xi(x, t, s),Ti(x, t, s)) = ds
Dinh*
Pf Cf Af
(Tm(xi(x, t, s),T1(x, t, s))-
Tf (xi(x, t, s),T1(x, t, s))),
dxi —(Tí(x, t, ds
s)) =
u(ti(x, t, s))
Af
d,Ti ds
where u = ql.
Consider the rate of change of h over the solution of (5.17) given by the
Lie derivative:
LK1 h(xi(x, t, s),Ti(x, t, s)) =
(Tm(xi(x, t, s),Ti(x, t, s))-LPf Cf Af
m&amp;lt;&lt;	\	/	dh .	.	.	.	..	u(ti(x, t, s))
Tf (xi(x C s),Ti(X C	C shTiGx C s)) +------------X
dTf	Af
dh	dh
— (xi(x, t, s),Ti(x, t, s)) + —(xi(x, t, s),Ti(x, t, s)),	(5.18)
Substituting (5.15) and (5.18) in (5.14), the smooth equivalent control law is obtained
, .	Af
u(t) = dTf,ref
dx
Dinht (Tm(x, t) - Tf (x, t)) + (a + Ty) (Tf (x, t)
A it
-Tf,ref U t)) + T j (Tf (x -)
f (x, -))d- ,	(5.19)
where the control parameters are Tj and A. To eliminate the necessity for the slope of the temperature set-point profile along the solar collector field, equation (5.19) is averaged with respect to space. This results in the following expression
u(t) = T	f~\X=L Di nht(Tm(t) - Tf (t)( + fA +
Tf,ref lx=0 L	\
i‘ t
- T -	- Tf,ref (a))da ,
Ti J 0
(Tf (t)	Tf,ref (t)) +
(5.20)
Remark 5.3. In [62] it was shown that implementing a control law based on the average tracking error as (5.20) guarantee the point-wise convergence of the distributed tracking error T(x, t) - Tref (x, t).
In addition, the control law (5.20) contains an open-loop observer to estimate the collector plate temperature, since there is no measurement of such variable in the real plant. The observer is given by the real-time numerical integration of the model (C.1)-(C.2) to estimate the temperature of the fluid and collector plate, and use them in the control law (5.20). Moreover, we use the real measurement of the inlet temperature in boundary condition (C.3).
The control parameters were chosen to be A = 50 and Tj = 5.7 min. These values were chosen by simulating control law (5.20) in model (C.1)-(C.3) under real data disturbances and analyzing the controller response for set-point tracking and disturbance rejection.
Figure 5.1 shows the experimental results with the DSMC controller in a clear day. At the beginning of the experiment the gas heater was operating on automatic mode by an on-off controller, causing the oscillations in the inlet temperature, as can be seen in the bottom graph of Figure 5.1. At about t = 11 h the gas heater coupled to the installation was set on manual mode to eliminate the oscillations in the inlet temperature. It is the reason of the oscillations in the control signal during this time period. Notice that, the solar irradiance is smooth along the experiment . As can be seen the output response shows a small overshoot of less than 1 oC and the settling time is of around 11 minutes for a set-point change of 3 oC. Although the solar irradiance is smooth, the inlet temperature changes inside a wide range, from 60 oC to 67 oC causing strong disturbances in the system. This fact produces that the volumetric flow rates during the test cover almost its whole range from 4 to 10 m3/h.
12
10
8
4
2
$
59
63
61
O
£ n ro
&lt;D
Q.
E
1®
67
65
Figure 5.1: Experimental result of the solar power plant with DSMC controller in a clear day. Results of October 3rd, 2013.
Another experiment is shown in Figure 5.2 where the controller performance against solar irradiance disturbances can be appreciated. In this scenario, three different set-points were imposed. The inlet temperature has small changes along the test. The system response is smooth and a small overshoot of less than 1 OC can be seen. At around t = 12.70 h a small cloud leads to a fast decrease in the solar irradiance. The controller does not respond because the inlet temperature was increasing and it compensates the impact of the solar irradiance disturbance. After the disturbance it can be noted that the controller quickly reestablishes the set-point tracking.
O
&lt;D
□
&lt;D
CL
Figure 5.2: Experimental result of the solar power plant with DSMC controller in a cloudy day. Results of October 2nd, 2013.
66
64
62
5.2.2	The case of 1-D quasilinear hyperbolic systems with relative degree two
In this section we are going to develop an sliding mode control methodology for systems that fulfill the following assumption:
Assumption 5.2. The system (5.1)-(5.f) has relative degree two, i.e., the output y must be differentiated (in time) twice to obtain an explicit relation with the input u. Furthermore, we assume that h(£(x, t)) = h(£*(x, t)).
It is easy to see that the attractive sliding condition (5.9) can not be applied in systems that satisfy the Assumption 5.2. Indeed, if the system relative degree is two, then dLK*h/du = 0. Consequently, the equivalent control function ueq does not exist and, according to Remark 5.1, attractive sliding regime can not be induced by the results of the previous section. To deal with this problem, a second-order sliding manifold is developed in this section in order to create a local sliding motion for system (5.1)-(5.4).
Definition 5.4. An attractive sliding regime for systems with relative degree two is said to locally exist on an open set Sas C S if the total derivative of h satisfies
dt* (^*(x, t), x, t) &amp;lt;0, d* h
dt* (^*(x, t), x, t) &gt; 0,
if h(£*(x, t), x, t) &gt; 0,
if h(£*(x, t), x, t) &amp;lt;0
(5.21)
These attractive sliding conditions can be computed by the Lie derivative of LK2h with respect to the vector field Ki:
d2h dt2
d	d	d
dT" (Lk2 h) +	(LK2	+ dX" (LK2
(LK2 h),
L
, U
where LK1, U(LK2 h) represents the Lie derivative of LK2 h with respect to the vector field Ki,u for a given control input u.
Theorem 5.1 can be easily adapted for the case (5.21). This result is stated below.
Theorem 5.4. Consider the system (5.1)-(5.f) such that Assumption 5.2 is satisfied. Then, an attractive sliding regime locally exists for system (5.1)(5.4) on an open set Sas C S, if and only if the phase flows corresponding to the controlled characteristic vector field exhibit a local sliding regime under the influence of the switching law (5.7).
In sum, the idea of this methodology is to induce the vector field K1, by means of the feedback switching controller (5.7), to the hypersurface LK2 h = 0, which is contained in h = 0. In this way, it becomes possible to indirectly induce the vector field k2 to h = 0, since the vector fields K1 and k2 are coupled. Furthermore, with a similar argument used in Section 5.2.1 we can show that the attractive sliding condition (5.21) guarantees the reachability of the systems trajectories into an open set Sas C S in finite time.
Note that the invariance condition h = 0 implies that dh/dt = LK1 h = 0 and also d2h/dt2 = LK1,U(LK2 h) = 0. According to Definition 5.3, the control function u = ueq such that LK1,U(LK2 h) = 0 is called equivalent control. Furthermore, the gradient of LK1 h is orthogonal to the controlled vector field K2,Ueq:
LK,Ueq
d	d	d
(LK1 h)	dT (LK2 h) +	(LK2 h)f1 + dx (LK2 h)u
(VL«2 h, K1,Ueq )	=0,	(5.22)
where K1,Ueq stands for the ideal sliding dynamics induced by the interactions of the two vector field K1 U- and K1 U+. Note that this orthogonality condition also implies that the gradient of h is orthogonal to the vector field k2.
The equivalent control is given by the solution of (5.22) for ueq, which is derived on the nominal system dynamics, and is effective only once the attractive sliding region is reached. Moreover, using the same argument of Theorem 5.2 we can show that ueq is well defined and locally intermediate among the extreme feedback control laws u+ and u -.
Development of a smooth equivalent control law
In this section we are concerned in developing a continuous control law of the form
u — ueq + uN,
in order to avoid the chattering problem. To do that, consider the following Lyapunov function
dh 2
(x z + Aih(6(x	x j) j
dx,
where Ai &gt; 0.
The time derivative of this Lyapunov function is
dV
dt
/„ Q+Aih)(diQ+A,h))dx=
[	(LK2 h + A1h)(LKl u (LK2 h + A1h))dx.	(5.23)
J0
Notice that if (LK1 u(LK2h + A1h)) = —A2(LK2h + A1h)), with A2 &gt; 0, then equation (5.23) is negative definite. Since d(LK2 u (LK1 h + A1h)) + A2(LK1 h + A1h))/du = 0, the implicit function theorem guarantees the existence of u such that
(Lk2 ,u (Lk1 h + A1h)) + A2 (LK1 h + A1h)) = 0.	(5.24)
Then, by the comparison principle for first-order differential equations we have that V(t) &amp;lt;V(0)e-A2i, i.e., the system’s trajectories decrease exponentially to the sliding surface given any initial condition. With this result we have the following theorem:
Theorem 5.5. Consider the system (5.1) with initial condition (5.2) and boundary conditions (5.)) and such that Assumption 5.2 is satisfied. Then, the control law obtained as the solution of (5.2)), with A1, A2 &gt; 0 enforces the system trajectories of (5.1)-(5.)) to the sliding surface h = 0.
Application to the tubular photobioreactor control problem
The tubular photobioreactor used in this thesis to test the automatic control strategy is located at the Palmerillas Experimental Station, property of CAJAMAR foundation (Almería, Spain). A brief description of the system
is given in Appendix D. The pH control problem in tubular photobioreactors deals with keeping the outlet pH of the external loop at a desired reference value in spite of disturbances. For this microalga specie, the optimal pH reference value is 8 [63].
The pH behavior in a microalgal culture is mainly influenced by two phenomena. On one hand, the intake of CO2 as nutrient causes the formation of carbonic acid, leading to a decrease in the pH of the culture. On the other hand, when the microalgae perform the photosynthesis they consume CO2 and generate O2, causing an increase in the pH. The provided CO2 is transferred to the culture medium as a function of mass transfer coefficient in the system. Remaining fractions of injected CO2 produce an oscillatory behavior in the measured pH, because of the continuous recirculation of the culture, until its total elimination.
The main system disturbances are the medium injected to perform the biomass harvesting, which introduces total inorganic carbon to the culture, and thus decreasing the pH value, and solar irradiance changes, caused by the solar cycle and presence of clouds, producing changes in the rate of photosynthesis and thus in the rise of pH. The control variable is the CO2 flow/velocity provided by a valve, located at the beginning of the loop (see Figure D.1), which flow range is 0 to 5 L/min. In this work, a control design based on controlling the total inorganic carbon is proposed. It must be stressed that this is not the only way to control this process. However, using the total inorganic carbon as controlled variable reduces the complexity of the calculus involved on the control law design if compared to using directly the pH variable for control design, due to the model equations.
Since the total inorganic carbon, [CT], is the controlled variable and the gas velocity/flow, Vg, is the control variable, then the system's relative degree is two. Therefore, the approach developed in Section 5.2.2 will be used to solve this control problem. Moreover, the continuous control law must be used to avoid the chattering problem.
Using the method of characteristics in (D.5) we obtain the following set of equations that generate the vector field ki:
[CT]( ( t )	( t ))	PC°2 Cb
——(xi(x i, s),Ti(x, i, s)) = —-------
ds	Mco2
(xi(x, t, s),Ti(x, t, s)) = Vl,
ds
dTi
ds
+ Kiai
CO2 ([CO2] - [CO2])
(5.25)
of equations that generates the vector field k2 :
dy/s'' (x2(x, t, s),T2(x, t, s)) = -KiOijCO2([CO2*] - [CO2]) ^s2 ((T2(x,	s)) = U
dT2 ds
(5.26)
where u = Vg.
The sliding surface is chosen to be
h([CT], x, t) = ([CT](x, t) - [Ct]re/(x, t))+
([Ct](x, a) - [Ct]re/(x, a)) da,
(5.27)
where Ti is the time constant of the integral term, [CT]ref (x, t) is the total inorganic carbon reference profile and 0 is the mean value of its arguments. We consider that the reference profile [CT]ref (x, t) is calculated as
[Ct]ref (x, t) = [Ct](0, t) + J(x)([Ct]re/(L, t) - [Ct](0,t)),	(5.28)
where J(x) = aebx is a spatial dependent function valid for x e [0, L], where a = 0.039 and b = -0.014. The [CT](0, t) value is obtained directly from the state observer (we will comment on the state observer in the following paragraphs). Equation (5.28) is used to compute the set-point profile in the DSMC control law. This expression was obtained by fitting the steady-state numerical solution of (D.5) over the photobioreactor operating point.
The control law is based on equation
(Lk2j„ + A2)(Lk1 h + A1h) = 0
which must be solved for u. It uses the two sets of characteristic vector fields to define the equivalent sliding dynamics. Evaluating such equation, it is obtained
d2 h	d2 h
(lk2&gt;„ + a2)(lk1 h + Aih))(LK1 h + Aih) =	^2 +
,Tr d2h	A	(dh dh\ A (dh T,dh\ A A ,
+ (Vi + u) dtdx	+ A at+ udiJ + AIt+ V+ A1A2h =	0,
where Ai = |Ai and A2 = |A2. Substituting h into (5.29) yields
d2[CT] , (	, V) 92[Ct] ,	' c
+ (U + '	+uVl
'') + Ai
)
,	( d[CT]
+ u\~dT -
( d[C1T ]
U\ dx ’
'V dx
dx
9[Ct [ref
dx
9[Ct ]
________uV d2[CT[ref + 1 d[CT] dx2_____1	dx2	Ti dt
T + T ([CT] - [CT[ref ) +
T i
dt + T ([Ct ] - [Ct ]ref)
dt
+ A2	[CT
d[CT[ref
1 f *	1
+tw	([Ct] - [Ct[ref)dt = 0. (5.30)
TiJ0
dx
+ A1A2 [CT] - [Ct[ref
Notice that the three first terms in (5.30) can be expressed by the Lie derivative of [CT] with respect to the two characteristic fields, i.e.,
Lk2 (Lki [Ct]) =
d2 [ct]
dt2
+ Vg Vl
d2 [ct]
dx2
+ (Vg + Vl)
d2 [ct] dtdx
Kiai,CO2
d[CO2] + V d[CO2] dt	s dx
+
Vmol
£
(1 - £)Kiai,co2HCO2Pt([CO2]
- [CO2])	Pco2 (vdCb + dCfa	( - Ucoe '' dx + dt) . (5.31)
Substituting (5.31) in (5.30) the following control law is obtained
u=
+ A2
Kiai,co2 Hco2Pt
(1 - £)Kiai,co2 ([CO2] - [CO2]) + fa
Pco2 Cb
_ Mco2
+ Kiai,co2 ([CO2] - [CO2]) - Vl	'
+ ^AiA2 + ~1 T	([CT] - [CT ^ref) + AiA -	-
+^TT L ([Ct] - [Ct]ref}dt + t '- j I { lVd2[CT [ref	K	d[CO2[
+ Vl ----------Ka,co2 n---------Ai
dx2	dx
Ti dx
d [ct ]
dx
Pco2 dCb
Mco2 dx
'	' ]|, (5.32)
dx
where
ft
ft
ft
-V+ ^MrC + KiOi,CO2([co;] - [CO2]), dx	Mco2
ft
P2 - [CO2X1P3 ’
-V	+ P°2C6Yp/x,
Ki	, 2/\K2
[H+P + [H+]3 ’
P2
1 +
Ki , AM [H+] + [H+]2 ’
P3
Ki + 2K1K2 [H+] + [H+ ]2
1 ,	Kw	, Ki[CO2] , 4 2K1K2 '
1+ [H+ ]2 +	[H+]2	+4 [H+]3
To avoid the requirement of setting the slope of the total inorganic carbon profile set-point along the photobioreactor tube, equation (5.32) is averaged with respect to space. This results in the following final control law
u — |Kiai,co2 Hco2Pt
(1 - £)KiOi,co2 ([co;]-
[CO2]) + (ft)] + ft	'
M	+ Kiai,co2 ([co;] - [CO2])-
MCO2
Vl [CT]ref |L] + ^ftft + '1 T '2
' y 2	([CT] - [CT]ref-
2 Cbl0L + V dx
([CT] - [CT]ref ) + ft (ft)
d[Cj ]ref
McO	+ Ti [Ct]l° } /
L
- Ko,co2 [CO2]|L
0
-ft ([Ct] - [Ct]ref )lL} ,	(5.33)
It is noteworthy that, for implementation purposes, the derivative terms of the control law (5.33) were discretized by a backward finite difference scheme. Moreover, the implementation of the control law (5.33) contains an state observer to estimate the total inorganic carbon and the other variables present in the control law that are not measured in the real plant.
This observer is given by (D.22) and (D.30). The initial condition of these equations were obtained from the real plant. Moreover, these equations were solved by the method of lines using a backward finite difference approximation. To ensure stability and to impose limits in the computational cost, the Courant-Friedricks-Lewy condition was used. Since this model was validated with real photobioreactor data with a discrepancy of around 1.2% between the values of the model states and the real system states [40, 64], no correction mechanism between the estimated state values and the real system states was used.
In addition to the DSMC controller, an outer feedback loop with integral action is used to calculate the total inorganic carbon concentration set-point required to maintain the system pH in its optimal value. The outer feedback loop is a PI controller with the following structure
[CT]ref (L,t) = kp ApH(t) +	1	ApH(t)dT ,	(5.34)
Ti,pH 0
where ApH = pHref (t) — pH(t) and pHref is the desired pH reference. The pH reference is kept in its optimal value during the experiments to guarantee maximal photosynthesis rate, i.e., pHref (t) = 8. A block diagram of the entire control system is shown in Figure 5.3.
Figure 5.3: Block diagram of control structure.
For a constant set-point [CT]ref (L,t) (calculated by the PI controller), the set-point profile [CT]ref (x,t) is obtained from (5.34), which is a steady state solution of the total inorganic carbon. This set-point profile is modified to obtain a perfect match between the desired pHref and the pH of the plant.
The design of the PI controller of the outer feedback loop was based on the AMIGO tuning rule [65]. This tuning rule methodology is based on a first-order transfer function plus dead time of the system. Thus, the reaction curve method based on an open-loop test [65] was used to calculate such model. In this way, during the night period of the day, where the solar irradiance does not affect the system, a step change at the total inorganic
carbon reference was applied to capture the dynamics between the total inorganic carbon and the pH, as shown in Figure 5.4. For this experiment the inner DSMC-photobioreactor closed-loop system was considered.
Time (h)
Figure 5.4: Time-response dynamics of the total inorganic carbon, the CO2 injection, and the pH when a step change at the total inorganic carbon reference was applied
As can be observed in Figure 5.4, the increase in the total inorganic carbon produces a decrease in the pH, observing a time delay of 390 s. The evolution of the pH response is governed by two main dynamics [66], one second-order oscillatory term (natural frequency v, = 0.0140 rad/s and relative damping factor £ = 0.0420) and one overdamped dynamics (with time constant 450 s). The fraction of the remaining injected CO2 is recirculated producing the oscillatory behavior in the measured pH. However, to design the PI controller only the overdamped dynamic is considered. Then, the following first-order model with dead time, relating the pH output to the total inorganic carbon input, is obtained
G(s) =
1.59 e-390s
450s + 1	’
(5.35)
where s is the Laplace variable. The resulting PI parameters, using the AMIGO tuning rule are kp = -0.1778 (m3 L)/(mol min) and 7’,..pH = 547.9434 s. For the DSMC controller, we chose A1 = 128, A2 = 126 and T = 600 s. These values were find in simulation by a trial and error procedure in order to improve the closed-loop performance.
In Figure 5.5 the response of the sliding mode controller on July 1st, 2014 is shown. The experiment lasted around 12:30 h. Between 9:00 and 11:00 the harvesting of the culture was performed, where fresh medium is
	1	1	1	1	1	1—					
Pn					-
_ Arx-w	-					
l	1	1	1	1	1
10	12	14	16	18	20
CO, injection
Medium injection
9
1000
800 -
600 -
0 B
8
•g 4 -
_E
o. -J 3 -O r° B 2 -
1 -
Figure 5.5: Experimental result of the tubular photobioreactor with DSMC controller. Results of July 1st, 2014.
400 -
200 -
	10	12	14	16 18	20
-	1	1 1	l	1	1
			“ “ Reference l	l	-
	1	1 1		1
	10	12	14	16 18	20
Time (h)
5
injected in the photobioreactor. The controller responds by decreasing the carbon dioxide injection. It can be observed in the bottom graphic of Figure 5.5 that the total inorganic carbon remains constant along the day in such a way that the pH of the photobioreactor tracks the reference. Smooth changes in irradiance are about 100 W/m2 and the controller compensates it in such a way that no tracking errors (more than ±0.1) were found.
8	10	12	14	16	18	20
1000 -
800 -
600 -
400 -
200 -
0
8
10
12
14
16
20
Figure 5.6: Experimental result of the tubular photobioreactor with DSMC controller. Results of July 3rd, 2014.
Another experiment, performed on July 3rd, 2014 is shown in Figure 5.6. The harvesting operation was performed between 9:00 and 11:00 h. The controller was regulating the dioxide carbon flow correctly during the whole test. In spite of the disturbances, the system response is smooth and the tracking error was less than ± 0.1 for the pH. This is a promising result, taking into account the disturbances affecting the plant and the uncertainties present in the system model.
5.3	Conclusions
In this chapter we describe the development of a sliding mode control methodology for the tracking and disturbance rejection problem in systems modeled by 1-D quasilinear hyperbolic systems with in domain control. The central idea of the control approach is the combination of the method
of characteristics and sliding mode control. The method of characteristics is employed for a general first-order hyperbolic PDE to derive a nonlinear ODE system, which exactly describes the original PDE system. Then, the control design is performed in the ODE system instead of the original PDEs, which means that results for the description of sliding regimes in the control theory of lumped parameter systems become available for the PDE control problem. This approach was first proposed in [24]. A comparative study between this control methodology and another classic methodologies, such as PID and model predictive controllers, was shown in [41, 42]. Through a set of numerical tests it was shown that the DSMC approach is better than PID and model predictive controllers in settling time and disturbances rejection.
Chapter 6
Conclusions and future works
Most of the results in the literature for analysis of control systems and development of algorithms for controller design are for systems modeled by ODEs. However, in many practical engineering systems the variable to be controlled depends on several independent variables (for example time and space). When there is more than one independent variable, it is natural to model the dynamics of the system by PDEs. In this thesis we studied and developed control methodologies for systems with dynamics modeled by first-order hyperbolic PDEs.
For a better understanding of the dynamic behavior of these systems, in Chapter 2 it was first studied the main properties of first-order hyperbolic PDEs. It was shown that for these systems there exist a coordinate transformation, called characteristic coordinates, that transform the PDEs into its diagonal form. Interestingly, in this framework the PDE can be transformed, along specific curves, into a set of ODEs without any approximation. This methodology of transforming the hyperbolic system into a set of ODEs is called method of characteristics and it can be used for the solution of the Cauchy problem associated with the PDE. Furthermore, the method of characteristics yields valuable insights into different aspects of the solution, that leads to the development of the control methodologies considered throughout this thesis.
These control methodologies were studied and developed for a set of specific control problems, but the results were presented, whenever possible, in a general form. More precisely, the control methodologies were studied and developed for the application on the following control problems: (i) suppression of slugging phenomenon in oil production facilities; (ii) stabilization of thermoacoustic oscillations in the Rijke tube; (iii) control of temperature of a solar power plant, and; (iv) control of pH of a tubular photobioreactor.
Since there is no general control theory to deal with PDEs and due to the fact that these systems have different control problems and mathematical models, we used different control methodologies to treat them.
In Chapter 3 we have described a control methodology, developed in [8], for the suppression of slugging phenomenon in oil production facilities. We first present this methodology for a general n x n first order linear hyperbolic system. The idea is to impose a new boundary condition into the system as a linear combination of the system states, where each state is multiplied by a coefficient. By a Lyapunov based design method, the value of these coefficients are chosen to ensure the exponential stability of the system. The control variable is then designed such that the boundary condition of the system behaves like this new boundary condition that guarantee the system stability. Simulation results applied in the nonlinear model showed the effectiveness of the method. Comparing to other control methodologies applied on this system, the proposed control law guarantees stability for greater values of the choke opening. Most of the control methodologies (see for instance [28]) stabilize the system for choke opening at the maximum of 20-25%, whereas the control law developed in this thesis can achieve values of choke opening of more than 45%. However, the main limitation of this control law is, of course, the requirement of sensors of pressure at the outlet valve, bottom pressure and total flow-rate. In some real cases this is not feasible. The development of a state observer together with the control law is probably the best option in these cases. Moreover, in the simulations it was considered constant inlet of gas. From a practical point of view, it should be considered influxes of gas. These issues should be solved before to apply the control law into a real system.
In Chapter 4 we focused on the boundary feedback stabilization of the thermoacoustic phenomenon in the Rijke tube by a frequency domain approach. For this system, we first compute theoretically an irrational transfer function, based on its linearized PDE model, and then we provide a detailed characterization of the poles and zeros of the system. To stabilize the system, a proportional control law with delayed output is proposed. Using the Nyquist theorem for infinite dimensional systems and analyzing the closed-loop poles for high frequencies we derived necessary and sufficient conditions for the input-output stability. Experimental results on a prototype show the effectiveness and real-life applicability of the method.
In Chapter 5 we have addressed the problem of regulation and disturbance rejection for first-order quasilinear hyperbolic systems with the control variable in the domain of the PDE. The control methodology used was the distributed sliding mode control and was first proposed in [24]. Its central idea is the combination of the method of characteristics and
sliding mode control. The method of characteristics is employed to derive a nonlinear ODE system that exactly describe the original PDE system. Then, the control design is performed in the ODE system instead of the original PDEs, which means that all known results for the description of sliding regimes in the control theory of lumped parameter systems become available for the PDE control problem. Besides, the well-known chattering problem of sliding mode control is solved by applying a continuous control law derived from a candidate Lyapunov function. We have developed this methodology for systems with relative degree one and two, respectively. The controllers were implemented, together with a state observer, in a solar power plant and a tubular photobioreactor. In both cases, the control law demonstrate promising results not only in set-point tracking in spite of nonlinear dynamics and uncertainties, but also in the presence of strong disturbances. Moreover, in [41, 42] it was showed, through a set of numerical tests, that the closed-loop system with the DSMC approach has better performance than PID and model predictive controllers in settling time and disturbances rejection.
In general, the methodologies studied for controlling first-order hyperbolic PDEs have better performance than classical control approaches. This second one is based on simplifying assumptions that the control and controlled variables are spatially uniform. Yet, many control problems involve regulation or stabilization of variables which are distributed in space, and cannot be effectively solved with the traditional approaches. Moreover, the trend in industrial processes is to meet increasingly stringent safety regulations, and tighter product quality and energy specification [15]. In addition, they must be flexible enough to meet the product demands of a rapidly changing world market, utilize feedstocks, and minimize the use of dangerous chemicals. If these processes have distributed parameters, then the methodologies studied in this thesis and others in literature will be critical for the economic success of the industry.
These needs, together with the advances in the development of mathematical models that predict the behavior of distributed parameter systems provide a strong justification of the use of feedback control of these processes based on PDEs.
6.1 Future works
This thesis is an ongoing work, hence, there are topics that need further research. The main ones are the following:
(A.10). In order to prove the local stability of the nonlinear system the following augmented Lyapunov function should be used
V = I [(u+tP0u+) e-^1- + (u-TPiu-) e-^1-] dx+
0
£ [(e+TQo&lt;+) e-^2x + (rTQiC) e-^2x] dx+
I [(w+TBow+) e-M2X + (w-TBiw-) e-M2-] dx, 0
where
Po = D2 (a+)-1 ,
Qo = DO (A+),
Bo = D2 (A+)3 ,
and £ = dr and w = -d-r.
dx	dx2
Pi = d? (a-)-Qi = d? (a-) ,
Bi = D? (A-)3 ,
ii.	To show that the input-output stability of the proposed control law for the Rijke tube control problem, studied in Chapter 4, implies the exponential stability of the states of the system.
iii.	Development of state observers based on PDE models, with convergence guaranteed, for the cases studied in Chapter 3 and 5. Thus, the results of this thesis can been generalized to output-feedback control systems.
iv.	To test the control law developed in Chapter 3 in an experimental plant to further corroborate the results presented here.
v.	To analyze the effect of parametric uncertainties in the control methodologies studied throughout this thesis.
Bibliography
[1]	M. Krstic and N. Bekiaris-Liberis . Nonlinear stabilization in infinite dimension. Annual Reviews in Control, v. 37: p. 220-231, 2013.
[2]	X. Litrico and V. Fromion . Boundary control of hyperbolic conservation laws using a frequency domain approach. Automatica, v. 45: p. 647-656, 2009.
[3]	R. F. Curtain and H. Zawrt. An introduction to infinite dimensional linear systems theory. Springer-Verlag, 1995.
[4]	M. Krstic and A. Smyshlyaev. Boundary control of PDEs: a course on backstepping designs. Philadelphia: SIAM Advances in Design and Control, 2008.
[5]	F.M. Callier and C. A. Desoer. An algebra of transfer functions for distributed linear time-invariant systems. IEEE Transactions on Circuits and Systems, v. 9: p. 651-662, 1978.
[6]	O. A. Aamo. Disturbance rejection in 2 x 2 linear hyperbolic systems. IEEE Transactions on Automatic Control, v. 58: p. 10951106, 2013.
[7]	J.-M. Coron, B. d’Andrea Novel, and G. Bastin. A strict Lyapunov function for boundary control of hyperbolic systems of conservation laws. IEEE Transactions on Automatic Control, v. 52: p. 2-11, 2007.
[8]	A. Diagne, G. Bastin, and J.-M. Coron. Lyapunov exponential stability of 1-D linear hyperbolic systems of balance laws. Automatica, v. 48: p. 109-114, 2012.
[9]	J.-M. Coron and G. Bastin. Dissipative boundary conditions for one-dimensional quasi-linear hyperbolic systems: Lyapunov stability for the C1-norm. SIAM Journal on Control and Optimization, v. 53: p. 1464-1483, 2015.
[10]	G. Bastin, J.-M. Coron, and O. Tamasoiu. Stability of linear density-flow hyperbolic systems under PI boundary control. Automatica, v. 53: p. 37-42, 2015.
[11]	G. A. de Andrade and D. J. Pagano. Boundary control for stabilization of slugging oscillations. In: Proceedings of the 2nd IFAC workshop on automatic control in offshore oil and gas production. Florianopolis, Brazil, 2015. p. 77-82.
[12]	V. dos Santos, G. Bastin, J.-M. Coron,and B. d'AndrEa Novel. Boundary control with integral action for hyperbolic systems of conservation laws: Stability and experiments. Automatica, v. 44: p. 1310-1318, 2008.
[13]	R. Vazquez and M. Krstic. Control of 1-D parabolic PDEs with Volterra nonlinearities - Part I: design. Automatica, v. 44: p. 2778-2790, 2008.
[14]	R. Vazquez and M. Krstic. Control of 1-D parabolic PDEs with Volterra nonlinearities - Part II: analysis. Automatica, v. 44: p. 2791-2803, 2008.
[15]	P. CHRISTOFIDES. Nonlinear and robust control of partial differential equations: methods and applications to transport-reaction processes. Boston: Birkhauser, 2001.
[16]	D. B. Pourkargar and A. Arm aou. Geometric output tracking of nonlinear distributed parameter systems via adaptive model reduction. Chemical Engineering Science, v. 116: p. 418-427, 2014.
[17]	M. J. Balas . Finite dimensional control of distributed parameter systems by Galerkin approximation of infinite dimensional controllers. Journal of Mathematical Analysis and Applications, v. 114: p. 17-36, 1986.
[18]	J. L. Lions . Optimal control of systems described by partial differential equations. Berlin: Springer-Verlag, 1971.
[19]	B. Bamieh, F. Paganini, and M. Dahleh. Distributed control of spatially invariant systems. IEEE Transactions on Automatic Control, v. 47: p. 1091-1107, 2002.
[20]	P. K. C. Wang. Asymptotic stability of distributed parameter systems with feedback controls. IEEE Transactions on Automatic Control, v. 11: p. 46-54, 1966.
[21]	E. M. Hanczyc and A. Palazoglu. Sliding Mode Control of Nonlinear Distributed Parameter Chemical Processes. Industrial and Engineering Chemistry Research, v. 34: p. 557-566, 1994.
[22]	E. M. Hanczyc and A. Palazoglu. Nonlinear control of a distributed parameter process: The case of multiple characteristics. Industrial and Engineering Chemistry Research, v. 45: p. 4406-4412,
1995.
[23]	H. Sira-Ramirez. Distributed sliding mode control in systems described by quasilinear partial differential equations. Systems and Control Letters, v. 13: p. 177-181, 1989.
[24]	H. Sira-Ramirez and J. Rivero-Mendonza. Slidingmode control of nonlinear first-order distributed parameter systems. Pure Mathematics and Applications, v. 1: p. 123-141, 1990.
[25]	S. Y. Shvartsman and I. G. Kevrekidis. Nonlinear model reduction for control of distributed systems: a computer-assisted study. A. I. Ch. E. Journal, v. 44: p. 1579-1595, 1998.
[26]	D. Shi, N. H. El-Farra, P. MHASKAR,and P. D. Christo f ides. Predictive control of particle size distribution in particulate processes. Chemical Engineering Science, v. 1: p. 268-281, 2006.
[27]	C. Vilas, M. R. García, J. R. Banga,and A. A. Alonso. Robust feed-back control of distributed chemical reaction systems. Chemical Engineering Science, v. 62: p. 2941-2957, 2007.
[28]	J. Godhavn, M. P. Fard, and P. H. Cuchs. Newslug control strategies, tuning rules and experiments results. Journal of Process Control, v. 15: p. 547-557, 2003.
[29]	M. Krstic, A. Krupadanam, and C. Jacobson. Selftuning control of a nonlinear model of combustion instabilities. IEEE Transactions on Control Systems Technology, v. 7: p. 424-436, 1999.
[30]	J. P. Epperlein, B. Bamieh, and J. Astrom. Thermoacoustics and the Rijke tube: Experiments, identification and modeling. Control Systems Magazine, v. 35: p. 57-77, 2015.
[31]	J. J. E. Slotine and W. Li. Applied nonlinear control. New Jersey: Prentice Hall, 1991.
[32]	H. Sira-Ramirez. Nonlinear variable structure systems in sliding mode: the general case. IEEE Transactions on Automatic Control, v. 34: p. 1186-1188, 1989.
[33]	G. A. Andrade, D. J. Pagano, I. Fernandez, J. L. GuzAn, and M. Berenguel. Boundary control of an industrial tubular photobioreactor using sliding mode control. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Cape Town, South Africa, 2014. p. 4903-4908.
[34]	G. A. Andrade, D. J. Pagano, J. L. GuzÁN, and M. Berenguel. Optimización de la producción de biomasa en foto-biorreactores tubular. In: Proceedings of the 35th Jornadas de Automática. Valencia, Spain, 2014. p. 513-519.
[35]	I. Fernández, G. A. Andrade, J. L. GuzÁN, M. Berenguel, and D. J. Pagano. Modelo NARMAX de pH en un fotobiorreactor tubular de microalgas. In: Proceedings of the 19th World Congress of the International Federation of Automatic Control. Barcelona, Spain, 2014. p. 550-557.
[36]	I. Fernández, M. Berenguel, J. L. GuzÁN, F. G. Acién, G. A. Andrade, and D. J. Pagano. Hierarchical non-linear control of a tubular photobioreactor. In: Proceedings of the 5th IFAC Conference on Nonlinear Model Predictive Control. Seville, Spain, 2015. p. 224-229.
[37]	G. A. de Andrade, R. Vazquez, and D. J. Pagano. Boundary feedback control of unstable thermoacoustic oscillations in the rijke tube. In: Proceedings of the 2nd IFAC workshop on control of systems governed by partial differential equations. Bertinoro, Italy,
2016.	p. 48-53.
[38]	G. A. de Andrade, R. Vazquez, and D. J Pagano. Boundary control of a Rijke Tube using irrational transfer functions with experimental validation. Accepted for IFAC World Congress
2017,	2016.
[39]	G. A. Andrade, D. J. Pagano, J. D. Alvarez, and M. Berenguel. Distributed sliding model control: Application to a solar power plant. Journal of Control, Automation and Electrical Systems, v. 26: p. 1-12, 2014.
[40]	I. Fernández, F. G. Acién, M. Berenguel, J. L. Guz-mÁn, G. A. Andrade, and D. J. Pagano. A lumped parameter chemical-physical model for tubular photobioreactors. Chemical Engineering Science, v. 112: p. 116-129, 2014.
[41]	G. A. de Andrade, J. D. Alvarez, D. J. Pagano, and M. Berenguel. Nonlinear controllers for solar thermal plants: a comparative study. Control Engineering Practice, v. 43: p. 12-20, 2015.
[42]	G. A. de Andrade, D. J Pagano, J. L. Guzmán, M. Berenguel, I. Fernández, and F. G. Acién. Distributed sliding mode control of pH in tubular photobioreactors. IEEE Transactions on Control Systems Technology, v. 24: p. 1160-1173, 2016.
[43]	G. A. de Andrade, M. Berenguel, J. L. Guzmán, D. J Pagano, and F. G. Acién. Optimization of biomass production in outdoor tubular photobioreactors. Journal of Process Control, v. 37: p. 58-69, 2016.
[44]	I. Fernández, M. Berenguel, J. L. Guzmán, F. G. Acién, G. A. Andrade, and D. J. Pagano. Hierarchical control for microalgae biomass production in photobioreactors. Control Engineering Practice, v. 54: p. 246-255, 2016.
[45]	V. I. Arnold. Geometrical methods in the theory of ordinary differential equations. London: Springer, 1983.
[46]	S. Alinhac. Hyperbolic Partial Differential Equations. New York: Springer, 2009.
[47]	T. T. Li. Controllability and observability for quasilinear hyperbolic systems. Beijing: Higher Education Press, 2009.
[48]	F. John. Partial Differential Equations. New York: Springer-Verlag, 1982.
[49]	T. T. Li, Z. Q. Shao, and D. X. Kong. Global existence of classical solutions to the Cauchy problem on a semi-bounded initial axis for a nonhomogeneous quasilinear hyperbolic system. Mathematical Analysis and Applications, v. 325: p. 205-225, 2007.
[50]	P. D. Lax. Hyperbolic Partial Differential Equations. Providence: American Mathematical Society, 2006.
[51]	J.-M. Coron and G. Bastin. Stability and boundary stabilization of 1-D hyperbolic systems. New York: Birkhauser Basel, 2016.
[52]	G. Bastin, J.-M. Coron, and B. d’Andréa Novel. Boundary feedback control and Lyapunov stability analysis for physical networks of 2x2 hyperbolic balance laws. In: Proceedings of the 47th IEEE Conference on Decision and Control. Cancun, Mexico, 2008. p. 1454-1458.
[53]	R. Di Meglio F. Vazquez, M. Krstic, and N. Petit. Backstepping stabilization of an underactuated 3x 3 linear hyperbolic system of fluid flow equation. In: Proceedings of the American Control Conference 2012. Montreal, Canada, 2012. p. 3365-3370.
[54]	L. C. Evans. Partial differential equations. American Mathematical Society, 2010.
[55]	R. Curtain and K. Morris. Transfer functions of distributed parameter systems: A tutorial. Automatica, v. 45: p. 1101-1116, 2009.
[56]	C. A. Desoer and M. Vid YAS AGAR. Feedback systems: input output properties. New York: Academic Press, 1975.
[57]	J. K. Hale and S. M. V. Lun el . Strong stabilization of neutral functional differential equations. IMA Journal of Mathematical Control and Information, v. 19: p. 5-23, 2002.
[58]	A. F. FILIPPOV. Differential equations with discontinuous righthand side. Dordrecht: Kluwe Academic Publishers, 1988.
[59]	J. Y. Hung, W. Gao, and J. C. Hung. Variable Structure Control: A Survey. IEEE Transactions on Industrial Electronics, v. 40: p. 2-22, 1993.
[60]	V. Utkin, J. GULDNES, and J. SHI. Sliding mode controlin eletro-mechanical systems. New York: CRC Press, 2009.
[61]	H. K. Khalil. Nonlinear systems. New Jersey: Prentice Hall,
1996.
[62]	S. Mechhoud and T.-M. Laleg-Kirati. Observer-based bilinear control of first-order hyperbolic PDEs: application to the solar collector. In: Proceedings of the 5fth Annual Conference on Decicion and Control. Osaka, Japan, 2015. p. 4909-4914.
[63]	J. F. SAnchez, J. M. Fernandez, F. G. AciEn, A. Rueda, J. PErez-Parra, and E. Molina. Influence of culture conditions on the productivity and lutein content of the new strain Scenedesmus almeriensis. Process Biochemistry, v. 43: p. 398405, 2008.
[64]	I. Fernandez, F. G. AciEn, M. Berenguel, and J. L. GuzmAn. First principles model of a tubular photobioreactor for microalgal production. Industrial &amp;amp; Engineering Chemistry Research, v. 27: p. 11121-11136, 2014.
[65]	K. J. Astrom and T. HAgglund. Advanced PID control. Research Triangle Park, USA: ISA - The Instrumentation, Systems, and Automation Society, 2005.
[66]	M. Berenguel, F. Rodr íguez, F. G. AciEn, and J. L. G arc Í A. Model predictive control of pH in tubular photobioreactors. Journal of Process Control, v. 14: p. 377-387, 2004.
[67]	F. Di Meglio, N. Petit, V. Alstad, and G.-O. Kaasa. Stabilization of slugging in oil production facilities with or without upstream pressure sensors. Journal of Process Control, v. 22: p. 809822, 2012.
[68]	M. E. Stasiak, D. J. Pagano , and A. Plucenio .A new discrete slug-flow controller for production pipeline risers. In: Proceedings of the 1th IFAC Workshop on Automatic Control in Offshore Oil and Gas Production. Trondheim, Norway, 2012. p. 122-127.
[69]	F. Di Meglio, G. O. Kaasa, N. Petit, and V. Alstad. Model-based control of slugging: advances and challenges. In: Proceedings of the 1th IFAC Workshop on Automatic Control in Offshore Oil and Gas Production. Trondheim, Norway, 2012. p. 109-115.
[70]	F. Di Meglio, G.-O. Kaasa, N. Petit, and V. Alstad. Slugging in multiphase flow as a mixed initial-boundary value problem for a quasilinear hyperbolic system. In: Proceedings of the American Control Conference 2012. San Francisco, USA, 2012. p. 35893596.
[71]	J. W. S. Rayleigh. The theory of sound. New York: Dover, 1945.
[72]	K. Kashinath, I. Waugh, and M. P. Juniper. Nonlinear self-excited thermoacoustic oscillations of a ducted premixed flame: bifurcations and routes to chaos. In: Proceedings of the N3L International Workshop T.U.M. Munich, Germany, 2013.
[73]	M. A. Heckl. Active control of the noise from a Rijke tube. Journal of Sound and Vibration, v. 124: p. 117-133, 1988.
[74]	J. P. Epperlein. Topics in modelling and control of spatially distributed systems. PhD thesis. University of California.
[75]	M. Pasamontes, J. D. Alvarez, J. L. GuzmAn, M. Berenguel , and E. F. Camacho. Hybrid modeling of a solarthermal heating facility. Solar Energy, v. 97: p. 577-590, 2013.
[76]	A. Meaburn and F.M. Hughes. Resonance characteristics of distributed solar collector fields. Solar Energy, v. 51: p. 215-221, 1993.
[77]	E. F. Camacho, M. Berenguel, F. R. Rubio, and D. MARTÍNEZ. Control of solar energy systems. London: Springer, 2012.
[78]	F. G. AciEn, F. García, SAnchez PErez, J. M. Fern A n d e z , and E. Molina. Modeling of biomass productivity in tubular photobioreactors for microalgal cultures: effects of dilution rate, tube diameter and solar irradiance. Biotechnology Bioengineering , v. 58: p. 605-616, 1998.
[79]	I. Fernández, F. G. Acién, J. M. Fernández, J. L. Guzmán, J. J. MaGÁN,and M. Berenguel. Dynamic model of microalgal production in tubular photobioreactors. Bioresource Technology, v. 126: p. 172-181, 2012.
[80]	F. Cámácho, F. G. Acién, J. A. Sánchez, F. Gárcíá, and E. M o L i N á . Prediction of dissolved oxygen and carbon dioxide concentration profiles in tubular photobioreactors for microalgal culture. Biotechnology Bioengineering, v. 62: p. 71-86, 1999.
[81]	F. Grognárd, A. Akhmetzhánov, and O. Bernárd. Optimal strategies for biomass productivity maximization in a photobioreactor using natural light. Automática, v. 50: p. 358-368, 2014.
[82]	E. PoláK. Computational methods in optimization. New York: Academic Press, 1971.
[83]	J. T. Betts. Practical methods for optimal control and estimation using nonlinear programming. Philadelphia, USA: SIAM Advances in Design and Control, 2010.
[84]	C. Buskens and H. Máurer. SQP methods for solving optimal control problems with control and state constraints: adjoint variables, sensivity analysis and real-time control. Journal of Computational and Applied Mathematics, v. 120: p. 85-108, 2000.
[85]	M. BáZáRáá, H. D. SheráLI, and C. M. Shetty. Nonlinear programming theory and algorithms. New Jersey: Wiley-Interscience, 2006.
[86]	P . Dupuis and M. R. Jámes. Rates of convergence for approximation schemes in optimal control. SIAM Journal on Control and Optimization, v. 36: p. 719-741, 1998.
[87]	M. BáZáRáá, H. D. SheráLI, and C. M. Shetty. Nonlinear programming theory and algorithms. New Jersey: Wiley-Interscience, 2006.
Appendix A
Modeling of slug flow phenomenon in oil installations
This appendix deals with the slug flow phenomenon in oil well and flow lines. In Section A.1 we briefly describe the characteristics of the slug flow and its impact on the level of oil production. Then, in Section A.2, we present a mathematical model for two-phase flow able to reproduce the slugging phenomenon. Numerical results are presented in Section A.3 to demonstrate that the model reproduces the slug flow phenomenon similarly to other results in the literature.
A.1 Description of slug flow
Slug flow is a multiphasic flow regime that occurs mainly in oil installations, such as gas lift well and flowline risers (Figure A.1 summarizes the family of systems we are focusing in this appendix). This phenomenon is characterized by intermittent axial distribution of gas and liquid that lead to oscillatory flow patterns. Consequently, there may be dangerous variations in oil production due to changes in pressure and liquid and gas flow. Mature oil fields, increase of gas-oil ratio and increase of water fraction are probably the main cause of this type of unstable flow.
A typical slugging bifurcation diagram, considering the outlet vale opening (production choke) as a bifurcation parameter, is shown in Figure A.2. As can be seen, a supercritical Hopf bifurcation takes place at the point HBsup, giving rise to a stable limit cycle. As negative effects of this type of phenomenon, it can be mentioned the oil production detriment and several issues concerning safety of operations on the surface equipment, which can
Figure A.1: Family of systems subjected to the slugging phenomenon [67].
provoke several undesired effects as deteriorating the separation quality and level overflow in the multiphase flow separator [68].
Several methodologies have been developed to avoid the undesirable slugging phenomenon, between them, the active control of the outlet valve has been shown a promising method to suppress these oscillations [28]. These controllers use mainly upstream pressure sensors (a sensor located
Figure A.2: Typical bifurcation diagram considering the outlet valve opening as the bifurcation parameter. A stable limit cycle undergoes from a supercritical Hopf bifurcation HBsup.
at the bottom of the pipe) in the feedback-loop to stabilize the flow by outlet valve actuation.
A.2 Mathematical model
Systems subjected to slugging phenomenon consist of pipes ranging from several hundreds to several thousands meter-long pipes filled with oil, gas, and sometimes water. The distributed nature of these systems suggests models consisting of PDEs [69]. The model used in this work is similar to that proposed by [70], but the friction against the pipe walls is considered and a homogeneous model for the two-phase flow is used. Moreover, it is assumed constant temperature along the pipe, incompressible oil, and no mass transfer between the gas and liquid phase. In this context, the PDEs that describe the system behavior are given by
dag Pg , 1 d'h = 0
dt A dx , daipi + I dqi = 0
dt A dx , dpmVm	dP + pm vm
dt	dx
2dPmV
Pmgsind(x),
(A.1)
(A.2)
(A.3)
f
2 m
where, for k = g or l, ak denotes the volume fraction of phase k, pk its density and qk its flow rate. The pressure is denoted by P, pm is the density of the mixture, vm is the velocity of the mixture, f accounts for the friction factor, d is the pipe diameter and A its cross-section area, and d(x) is the inclination of the pipe. The time variable is t e [0, +to) and x e [0, L] is the space variable, where L is the length of the pipe. Note that in the above equations we have omitted the time and space arguments for sake of legibility.
Besides the PDE model (A.1)-(A.3), the following algebraic equations are used for system closure:
ag + al = 1 p = Pg RT
M '
pm	agpg + alpl,	(A.4)
w =
ag pg ag Pg + aiPi
(A.5)
where R is the specific gas constant, M is the gas molar weight, w is the gas mass fraction, and T is the temperature.
Regarding the boundary conditions, they are given at both ends of the pipe. At the bottom, two boundary conditions are given: one for the liquid flow rate, assuming that it is linearly depend on the pressure drop between
the pipe and the oil reservoir, and other boundary condition for the gas flow rate, assumed to be constant. They are expressed as
qi(0, t) = PI[Pr - P(0, t)], qg(0, t) = qg,
(A.6)
(A.7)
where ql is the liquid flow rate, qg is the gas flow rate, PI is a constant coefficient called productivity index and Pr is the pressure in the reservoir, assumed to be constant.
At the top, the total flow rate, qt = ql + qg, is assumed to be governed by a valve equation of given by
qt(L, t) = Cout u(t) ^pm(L, t)(P(L, t) - Ps),	(A.8)
where Ps is the pressure in the separator, Cout is a valve constant and u is the valve opening, which is the manipulated variable.
A.2.1 Formulating the model as a quasilinear hyperbolic system
Consider the following state vector
r	1 T	I"	a g P g
U M U1 U2 u3	= [ agpg+aipl
iT
P qt ] .
Combining Equations (A.1)-(A.3), with relations (A.4)-(A.5), it is possible to rewrite the system as
dH	dF ,	..
(u(x, t)) + -dx(u(x, t)) = G(u(x, t)).
(A.9)
Note that 8Ha(u) = H'(u)du, therefore the above equation can be rewritten to
d u	du
(x, t) + A(u(x, t)) — (x, t) = S(u(x, t)).
(A.10)
where
A(u(x, t)) = H'(u(x, t)) xF'(u(x, t)) S(u(x, t)) = H'(u(x, t))-1G(u(x, t))
The expression of A(u(x, t)) and S(u(x, t)) are given by (A.11) and (A.12), respectively.

(1--U1 )Mv2 + RTplv-í
3 AMpiv2 v3(Mv2-RTpi)((l-v1)Mv2 + RTpiv1) AMRTp^V!
RTpiv3—Mv2v3
AM P1V2


______AMpi_______
(1—f 1 )Mv2 + RT pi vi
gsine(x) + fvj
0 0	\
q	((l--ui)M-U2 + -RTp;-ui)I 2
AMRTp^V!
-RT-Uj-U2 r,(l—y1')Mv2lJ3 + RTpiV1V3
AMv%	AMpiV2	J
(A.ll)
A.2 Mathematical model
I
I
&gt;i)((l-t;i)M2t;2 + 2MRTpit;it;2) + _R2T2p^2
A.2.2 Well-posedness
To guarantee that A and all the other functions of u belong to Ci, we restrict our study to a set
u G K c (0, L) x (Ps, Pr) x (0, +to) c R3
For each value of u G K, A has 3 real eigenvalues Ai(u), i =1, 2, 3, as / li(u) \ well as a set of linearly independent left eigenvectors l(u) = I l2 (u) I .
\ l3(u) J The following inequalities hold
Vu G K, A2(u) &amp;lt;0 &amp;lt;Ai(u) &amp;lt;A3(u).
This ensures that the system is strictly hyperbolic, according to Definition 2.2. In order to apply Theorem 2.2, to establish the well-posedness of the mixed initial-boundary value problem, we have to rewritte the boundary conditions (A.6)-(A.8). More precisely, given a C1 initial condition p : [0, L] K, there must exist two functions gl : R R2 and gr : R2 R such that Equations (A.6)-(A.8) are equivalent to
z = 0 : (vi(0, t), V3(0, t)) = gl(v2(0, t)) z = L : V2(L, t) = gr(vi(L, t), V3(L, t), u)
where v(x, t) = l(p(x))u(x, t).
The existence of such functions only depends on the choice of the initial condition p. Rewriting (A.6)-(A.8) in the u variables we get, for the left boundary conditions,
hl(vi, U2, U3) =
(1 - Ui (0, t))u3(0, t) - PI(Pr - U2(0, t)) (1 - U1(0, t))u3(0, t) - qg
whereas the right boundary condition reads
hr (Ui, U2, U3, u) = U3 - Cout u(t)x

____________U2(L, t)plM____________
Mu2(L, t)(1 - ui(L, t)) + ui(L, t)RTpl
(u2(L, t) - Ps) = 0.
In the u variables, these equations can be rewritten to
z = 0 : hl(Ui, U2, U3) = hl(miu, m2v, m3u) = 0,
z = L :	hr(Ui,	U2,	U3,	U) =	hr(Ui, U2,	U3)	=	hr(miu,	mpi),	mpj,	U) = 0
/ mi(u) where the are line vectors such that m(u) = I m2(u)
\ m3(u)
A necessary and sufficient condition for the functions gi and gr to exist is that the following Jacobian matrices
( ftV2(0), V3(0)) ft(«1(0), v2(0), V3(0)) )
and
( ft («1(L), v2(L), «3(L)) )
are nonsigular. Then, the Implicit Function Theorem guarantees the existence of gl and gr. Further, the well-posedness follows, according to Theorem 2.2 given that p also verifies conditions of C1 compatibility.
A.3 Simulation results
This section shows the simulation results of the open-loop quasilinear model (A.10). The model parameters are shown in Table A.1. We consider a 2500 meter long vertical well with reservoir pressure Pr = 180 bar and separator pressure Ps = 10 bar. For the numerical simulations, the space was divided in N sections and the space derivatives were written using a finite difference scheme. These equations were solved by using ODE solver. To ensure numerical stability, the Courant-Friedricks-Lewy condition was used.
In Figure A.3 is shown an open loop simulation of the quasilinear system (A.10). The simulation starts with the production choke opened to Z = 100% and then after t = 8 h the production choke is closed to Z = 50% and to Z = 20% after more 8 hours. The oscillations have a period around of 50 minutes. For this case study, the supercritical Hopf bifurcation point, HBsup take place at a valve opening Z(t) = 22% (this value was found by performing several simulations for different valve openings). The corresponding open-loop bifurcation diagram for the valve opening is shown in Figure A.2.
Table A.1: Parameters of the slug flow model.
Symbol	Description	Value and units
A	pipe cross-section area	0.0094 mi 2
Cout	valve constant	0.0024 [-]
d	pipe diameter	0.1092 m
g	gravity constant	9.81 m s-2
R	universal gas constant	8.31 J K mol-1
L	length of the tube	2500 m
M	gas molar weight	0.016 Kg mol-1
e	inclination pipe	90o
pi	productivity index	0.3 kg (s bar)-1
Pr	reservoir pressure	180 bar
Ps	separator pressure	10 bar
T	temperature	300 K
Choke opening (%)	Top pressure (bar)	Bottom pressure (bar)
80
70
60
50
30
25
20
15
10
00
50
0

I I I I I I I—
0	5	10	15	20	25	30	35
------------------1-----------------1-----------------1-----------------1------------------1-----------------1-----------------r-
I I 1 I I I 11111 RaAAaaa/—:--i
A A A u
0	5	10	15	20	25	30	35
n---------------1--------------1--------------1--------------1--------------r-

i i i i i i i
0	5	10	15	20	25	30	35
Time (h)
Appendix B
Modeling thermoacoustic phenomenon in the Rijke Tube
This appendix describes the thermoacoustic phenomenon in the Rijke tube. In Section B.1, we briefly describe the Rijke tube and the thermoacoustic phenomenon. Its mathematical model is presented in Section B.2. In this work, the Rijke tube is modeled as a heating section embedded within a network of pipes. Simulation results validating the model with real data from the system are shown in Section B.3.
B.1 System description
B.1.1 The Rijke tube
The Rijke tube experiment basically consists of a vertical tube opened in both ends and a heater source in the lower half. A speaker placed to a slight distance under the tube is used as actuator, while a microphone placed near the top of the tube provides the pressure measurement.
In this work, all the experiments were performed on a simple 1.3 meter long glass tube with an electrical heating element made of nichrome wire coil (see Figure B.1). The power is delivered into the coil using a DC power supply with power output 360 W. The location of the electrical heating element was chosen to be a quarter of the tube length. The sound pressure in the tube is measured with a clip-on microphone with built-in preamplifier. This signal is sent to a control computer through a data acquisition device. The control system is implemented as part of a SCADA program based on a LabVIEW software. In such configuration the control algorithm is implemented as Matlab function executed from the SCADA program. For
Figure B.1: Rijke tube schematic and detailed view of the prototype used for the experiments.
the closed-loop experiments it was used a 30 W ceiling speaker as the actuator together with a linear amplifier.
B.1.2 The thermoacoustic phenomenon in the Rijke tube
In the Rijke tube, thermoacoustic phenomenon refers to the creation of sound due to the transfer of energy from a thermal source to acoustic waves. In this system, the heat source excites acoustic waves: the heat source transfers heat to the air in the tube, making the air to rise up and creating an upward flow. The rising hot air becomes dense by coming in contact with the cooler walls of the upper half of the tube. This means that in the lower half of the tube, the air always experiences expansion, while in the upper part, the air always experiences compression. This explains how the heat source in the lower half of the tube leads to creation of a standing wave. But it is not enough to clarify how the heat source sustains the already excited acoustic waves. This part of the phenomenon is formulated by the Rayleigh's criterion [71]. This criterion states that if heat be given to the air at the moment of greatest condensation, or be taken from it at the moment of greatest rarefaction, the oscillation is encouraged. On the other hand, if heat be given at the moment of greatest rarefaction, or taken from
0	5	10	15	20	25
20	20.02	20.04	20.06
Time (s)
(a)
(b)
Figure B.2: (a) Microphone signal at the onset of instability showing growth, and then saturation of the limit cycle. A zoomed-in picture shows the periodic, but nonsymetric, limit-cycle behavior. (b) Bifurcation diagram of non-dimensional velocity with heat release as bifurcation parameter.
it at the moment of greatest condensation, the oscillation is discouraged. In mathematical terms, the Rayleigh’s criterion is formulated in terms of the Rayleigh integral over the control volume V:
I = j P(t)Q(t)dt,	(B.1)
where P is the acoustic pressure fluctuation, Q is the fluctuation in heat power released in the heater, and t is time.
According to the Rayleigh’s criterion, if I &amp;lt;0, the acoustic oscillations will damp out. If I &gt; 0, then acoustic oscillations will grow. And, if I = 0, the oscillations will neither be damped out nor amplified.
A typical sound pressure output evolution is shown in Fig. B.2(a). At the beginning of the experiment, the heater coil power supply was turned on and increased until 300 W, which is the critical heater power which the tube begin to hum. As can be seen in that figure, at this point the sound pressure grows exponentially, behaving then as a linear system. When the pressure amplitude grows beyond the bounds of linearity the system behavior moves into nonlinear regime (limit cycle). The sound frequency, under standard conditions, is approximately twice the length of the tube (see the bottom graphic of Figure B.2(a)).
Figure B.2(b) depicts the bifurcation graphic of the Rijke tube considering the heat release as bifurcation parameter. For small values of heat power, the system equilibrium is stable and all perturbations decay asymptotically resulting in steady flow within the tube. As the heat power increases, the
stability margin of the system decreases and at a critical value of the heat power a Hopf bifurcation takes place, giving rise to a limit cycle. This limit cycle is unstable and the Hopf bifurcation is subcritical in nature. As the amplitude of this limit cycle increases in magnitude, it collapses with a stable limit cycle in a Fold bifurcation. Note that between the Fold and the Hopf Bifurcation points coexist (i) one stable equilibrium point, (ii) and two periodic orbits, one unstable (inner limit cycle) and other stable (outer). This is the range of bistability, depending on amplitude of the initial perturbation either a steady state or a limit cycle is reached. The influence of other bifurcation parameters, such as the heat release position, can be seen in [72].
B.2 Mathematical model
The Rijke tube can be modeled as a heating section embedded within a network of pipes. We assume that the fluctuations of pressure, density, and velocity occur only along the axial direction. Therefore, the system can be described by the one-dimensional mathematical model of compressible gas dynamics. Furthermore, the heating release zone is assumed to be located in a very narrow section.
The Rijke tube is composed of 2 compartments described by the linearized Euler equations of gas dynamics:
dVj ,	.	1 dPi .	.
(t, Xi) + - — (t, Xi) = 0, dt	p dxi
dPi .	.	— dVi .	.
“df (t, Xi) + Y^dX" (t, Xi) = 0,
i = 1, 2,
(B.2)
(B.3)
where t e [0, +to) is the time, Xi e (—Xu, 0), x2 e (0, Xd), xu, Xd &gt; 0, 7 is the adiabatic ratio, P is the pressure fluctuation, and V is the velocity fluctuation. The steady-state density and pressure are denoted by p and P, respectively. It is important to emphasize that in this work the steadystate density, pressure and velocity are assumed to be constant along the space. Furthermore, the steady-state values are considered the same for both compartments of the tube.
The initial condition is defined by
Vi(0, Xi) = Vi,o(Xi), i = 1, 2.
Pi'0- Xi) i,o(Xi),
We represent the interconnection between the downstream and upstream part of the system by the following algebraic relations, which can be directly obtained by linearizing the equations conservation of mass, momentum and energy across the heat zone x = 0,
P2 (t, 0) - Pi(t, 0) = 0,	(B.4)
7P52(t, 0) - YPvi(t, 0) = YQ(t),	(B.5)
where A is the cross-sectional area of the tube and Q is the fluctuation of heat power released in the heater. Following [30], we assume that the fluctuation of heat power is expressed by the following ordinary differential equation (ODE)
(t) = -Q(t) + hv vi(t, 0),	(B.6)
where thr is the heat release time constant and hv is the velocity-dependent heat transfer coefficient.
Moreover, the system (B.2)-(B.3) is subjected to the following boundary conditions
Pi(t, -x„) = u(t),	P^2(t, xd)=0,	(B.7)
where u is the control input.
Remark B.1. In [73] it was computed an explicit estimation for the Rayleigh integral (B.1) from the equations (B.2)-(B.7). The thermoacoustic oscillations amplitude grows if the acoustic energy stored in the tube increases in time average, i.e.,
I-p(0)Q &gt; P(L&gt;(L) - P(0)v(0) + nLc (	" + Pv2(0) j , (B.8)
pc2	A	\ pc2	/
where • is the mean value (in time) of its argument, nLc	+ pv2(0)^
is the Stokes layer, and n is the attenuation constant of the sound wave traveling along the tube.
Well-posedness
To study the existence and uniqueness of the solution of system (B.2)-(B.7), we will introduce the characteristic coordinates. This result is presented in the following lemma, which can be easily proved by direct computation.
Lemma B.1. Consider the invertible linear transformation T : L2(0,1) x L2(0,1) —&gt; L2(0,1) x L2(0,1) such that
The transformed linear system from (B.2)-(B.3) is written as
-df (t, Xi) +	(t, Xi) = 0,
d£i2 a x A d£i2 a x „ p/(t, xi) - AaX“(t, xi) = 0,
i = 1, 2,
(B.9)
(B.10)
where A =
The initial condition is defined by
£i1(0, xi) £i1,0(xi), £i2(0, xi) £i2,0(xi), i = 1, 2.
The boundary conditions (B.f)-(B.7) are given by
£21(t 0) = £11(t, 0) +
£12(t 0) = £22(t 0) +
(t)	' '-A p ..
£11(A xu)	£12(t, xu) I 2u(t),
£22(t, Xd) = -£21(t,Xd).
Av^c5(t),
v (£11(t0) - £12(t,0)),
(B.11)
(B.12)
(B.13)
(B.14)
(B.15)
Without loss of generality, it can be assumed that, by re-scaling the space variable, the two counterparts of PDE (B.9)-(B.15) evolve in the domain from 0 to 1. Indeed, define z = Xu+x for x e [—xu, 0), and z = Xd-x for x e (0,Xd], and consider
d = i xu dx	if x e [—J 0)
dz	1 — xd dx if x e (0,xd)
This leads to express the system (B.9)-(B.15) into
a?(/,z) + A a! «■ z) = °, C(0,z) = C0(z)	(B.16) (B.17)
£21 (t, 1) = £11(t, 1) +	Y^_Q(t), Av Pyp	(B.18)
1) = £22(t 1) +	,=— Ay Pyp	(B.19)
t dt (t) = Q(t)+2(£11 (t, 1)	£12(t, 1)),	(B.20)
^1^ 0) = —£12(t 0) + 2U(t)	(B.21)
0) = —£21(t 0)	(B.22)
where z G [0, 1] is the re-scaled space variable, and
C = (£11, £12, £21, £22^
A = diag { - A/xq, A/x„, A/xd, - A/xd} .
In the framework (B.16)-(B.22), the rijke tube mathematical model is represented by four transport PDEs evolving in the domain z G [0,1] and coupled at the boundaries.
The existence and uniqueness of the solution of system (B.16)-(B.22) can be proved by the method of characteristics, which enables us to restate the PDE as a set of classical ODEs. Then, if Co and u are continuously differentiable functions of their arguments and if Co and the boundary conditions verify conditions of C1 compatibility, one can show that the solutions of the system are continuously differentiable with respect to their arguments, i.e., C G C4([0, 1] x [0, to); R4). Moreover, based on a extension of [2], there exist M &gt; 0 and n such that for any t G [0, to), any C G C4([0, 1]; R4) and any u(t) G L2([0, t]; R4) n C4([0, t], R4), there exists Kt such that
llC(', t)|L2([0, 1];R4) + |Q(t) | — Me^ (||£q|Il2([0, 1];R4) + |(Q(0) |)
+ Kt
u(t)||
2
7
Table B.1: Values of the parameters of the system.
Symbol	Description	Value
p	Density	1.2 kg/m3
P	Pressure	105 N/m2
V	Velocity	0.35 m/s
Y	Adiabatic ratio	1.4
Y	Y—1	0.4
L	Tube length	1.3 m
x0	Heater position	1L
d	Tube diameter	0.0762 m
Ru	Reflection coefficient	—0.95
Rd	Reflection coefficient	—0.95
thr	Heat-release time constant	0.002
hv	Velocity-dependent heat transfer coefficient	200
B.3 Model validation
This section shows the validation results of the Rijke model (B.2)-(B.7) in the frequency domain. The model parameters used for the results are shown in Table B.1. They were based on the estimation made in [74].
Figure B.3(a) shows the open-loop frequency response for the experiment described in Section B.1. For this experiment, the system was first brought to the unstable regime. Then, a feedback control law is turned on, and the test signal, in this case a sine sweep over the frequency range 100 — 900 Hz, is added to the feedback signal. The microphone, positioned at xmic « 3j6L, records the sound pressure for the duration of the experiment (the data used here was collected over 20 s). Notice that with this experiment we will obtain the frequency response of the closed-loop system, but the open-loop frequency response can be recovered using some simple algebra. The open-loop frequency response of model (B.2)-(B.7) is depicted in Figure B.3(b).
As can be seen, by comparing Figure B.3(b) and Figure B.3(a), the model qualitatively capture the most important features of the real system: resonant peaks, a phase increase of 180 ° at the first peak for the unstabilized open loop, and phase drops of the same amount at the higher-order peaks. There remain however unknown parameters in G(s): overall gain due to the unknown conversion factors of speaker and microphone, the linear gain hv, time constant t and assumptions about friction, diffusive effects, and the stead upward flow. It should be emphasized however, that the real power
of the model lies in the explaining the thermoacoustic stability with a very simple model.
40
20
0
-20
-40
100	200	300	400	500	600	700	800	900
-180
-540
-900
-1260
-1620
100	200	300	400	500	600	700	800	900
Frequency (Hz)
(a) Bode plot obtained by applying a sine sweep, over the range 100 — 900 Hz, into the experimental plant.
£ 40 r
'J' 20 -| oí i-20f ro -40 L
100	200	300 400	500	600	700	800 900
o2 -180
-540
-900
CL
-1260
						
J	X	X		V			-
-				—V.		-
100	200	300 400	500	600	700	800 900
Frequency (Hz)
(b) Bode plot of model (4.14).
Figure B.3: Validation result: bode plot of the Rijke model and the experimental plant.
Appendix C
Modeling of solar power plants
This appendix presents the solar thermal plan located at the CIESOL (Centro de Investigación de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almería - Spain. In Section C.1, we give the description of this solar thermal plant and its control objective. The mathematical model of the system is described in Section C.2. Then, in Section C.3 the mathematical model is validated with real data from the real system.
C.1 System description
The solar collector field used in this work is located at the CIESOL (Centro de Investigación de la Energia Solar, in Spanish) building, a Solar Energy Research Center in the University of Almería - Spain. The energy generated by the heat generation process is applied to an absorption cooling unit in order to obtain chilled water. More details about the CIESOL solar cooling process can be found in [75].
Basically, the solar energy facility is composed of a solar flat collector field installed in the roof of the building, two tanks used for hot water storage, and a gas heater as auxiliary heat source. These elements are connected by a net of pipes, including three-way valves to modify the operation mode and a variable radial pump that allows to set the flow rate. Since the focus of this paper is the control of the outlet temperature of the solar collector field, just such subsystem is considered to be described in this work. The interested reader can found more details of the whole plant in [75].
Its main purpose is to increase the temperature of the fluid to provide the desired outlet temperature in an operation range between 50 °C and 100 °
Figure C.1: Solar field in CIESOL [75].
An inherent characteristic of the solar collector fields is the presence of resonance modes, producing unacceptable oscillatory behavior in the outlet temperature. This phenomena is excited, mainly, when fast rise time specifications of the control system or when there exist hard disturbances [76, 77].
The main disturbances are the inlet temperature variation, the ambient temperature and abrupt changes of the solar irradiance. The controlled variable is the mean outlet temperature of the solar collector field and the control variable is the fluid velocity/flow provided by the pump which flow range is 2.5 to 11 m3/h.
C.2 Mathematical model
The modeling of the solar thermal system of the CIESOL building was firstly presented in [75]. The subsystem of the solar collector field has been modeled by two coupled hyperbolic PDEs, one for the collector plate and one for the thermal fluid (water).
The equation for collector plate takes into account the influence of solar irradiance and the thermal losses to the ambient and the fluid. It is defined
as
dT
Pm Cm Am	(x, t) = q C I (t) - hi(Tm(x, t) - Ta(t))-
Di n ht (Tm(x,t) - Tf (x,t)), (C.1) where Tm is the metal temperature, Tf is the fluid temperature, Am is the metal cross-sectional area, and Cm and pm are the metal specific heat capacity and metal density, respectively. The Global coefficient of thermal losses is given by hl, Ta is the ambient temperature, ht is the coefficient of metal-fluid transmission, Di is the inner diameter of the pipe line, I is the solar irradiance, and C and go are the mirror optical aperture and mirror optical efficiency, respectively.
On the other hand, the equation for the fluid temperature, considers the convection effect of the fluid flow, and the thermal transference produced between the collector plate and the fluid. The dynamic behavior of the fluid is defined as
dTf	dTf
Pf Cf Af ~df &amp;amp; t) + Pf Cf qi(t)~dxft) =
Di n ht (Tm(x, t) - Tf (x, t)) (C.2)
where Af is the fluid cross-sectional area, Cf is the fluid specific heat capacity, pf is the fluid density and ql is the oil pump volumetric flow rate (control variable).
Besides, the system has one boundary defined by the inlet fluid temperature:
Tf (0,t) = Tin(t).	(C.3)
where Tin is the inlet fluid temperature.
C.2.1 Well-posedness
We admit the following assumptions for model (C.1)-(C.2):
Assumption C.1. q, I, and Ta are restricted to the following sets:
q(t) €	Qq = {q &amp;amp; C 1([0,t];R)	: 0&amp;lt;	qmin&amp;lt;	q(t)	&amp;lt;11, Vt &gt; 0} ,
1 (t) &amp;amp;	QI = {I &amp;amp; C1([0,t]5 R)	: 0&amp;lt;	Imin&amp;lt;	1 (t)	&amp;lt;Imaxt V &gt; 0} ,
Ta(t) &amp;amp; QT = {Ta &amp;amp; C1([0,t]; R) : 0 &amp;lt;Ta,min &amp;lt;Ta(t) &amp;lt;T^max, 'Vt &gt; 0} ■
These assumptions are compatible with the physical characteristics of the solar power plant. They also ensure the well-posedness of the PDE. Indeed, applying the method of characteristics into (C.1)-(C.2), we can restate the PDE as a set of classical ODEs. Then, given a C1 initial condition p : [0, L] R2 that verifies the conditions of C1 compability, the system must be well-posed, according to Theorem 2.2.
C.3 Model validation
The model calibration was performed by comparison of the real data with the simulations response obtained using estimated parameter values. These parameters values (see Table C.1) were determined by a genetic algorithm fitting the ISE (integral of squared error) criterion. For more details about the model calibration and validation procedure the interested reader is referred to [75].
Figure C.2 shows the outlet temperature of the model compared to real experimental data.
As can be seen in the upper graphic of Figure C.2 The initial temperature transient of the model and real system shows a significant difference due to the fact that is very hard to know the initial temperature profile of tube and fluid. But, after the initial transient, the model tends to the real system temperature with a maximum discrepancy of ±2 °C.
Table C.1: Solar plant model parameters [75].
Symbol Description		Value and units
L	Solar collector field length	18.29 m
Pm	Metal density	1100 kg/m3
Pf	Fluid density	1000 kg/m3
Cm	Metal specific heat capacity	440 J/(K kg)
Cf	Fluid specific heat capacity	1100 j/(K kg)
A m	Metal cross-sectional area	0.0038 m2
Af	Fluid cross-sectional area	0.0013 m2
no	Mirror optical efficiency	0.67
G	Mirror optical aperture	0.9143 m
hi	Global coefficient of thermal losses	20.773 W/(m2 K)
ht	Coefficient of metal-fluid transmission	1283.2 W/(m2 K)
Di	Inner diameter of the pipe line	0.04 m
Do	External diameter of the pipe line	0.07 m
75
70
65
60
CL
55
50
_	— Outlet temperature - real				
	Outlet temperature - model				
_	— Volumetric flow				
q_			r__.	
				-
12
10
8
6
4
2
Temperature (°C)	Volumetric flow (m3/h)
the
Figure C.2: Validation results: simulated and experimental data of outlet temperature as a function of solar radiation and volumetric flow.
Appendix D
Modeling biomass production in outdoor tubular photobioreactors
This appendix describes the biomass production process of the outdoor tubular photobioreactor located at Las Palmerillas Experimental Station, property of Cajamar fundation, in Almeria-Spain. In Section D.1, we briefly describe this tubular photobioreactor. Its mathematical model is presented in Section D.2. In this work, the mathematical model is formed of two interconnected compartments: a bubble column and a solar receiver. Each of this compartments is described by a set of mass balances for the liquid and gas phase. Simulation results validating the model with real data from the system are shown in Section D.3.
D.1 System description
The photobioreactor used in this work for the design of control strategies is based on a tubular photobioreactor located at Las Palmerillas Experimental Station, property of Cajamar fundation, in Almeria-Spain. This photobioreactor is located inside a greenhouse where the Scenedesmus almeriensis microalga is cultivated. This kind of microalga is characterized by a high growth rate, withstanding temperature up to 45 °C and pH values up to 10 [78].
A general scheme of the plant is depicted in Figure D.1, showing the main components: (i) the external loop and (ii) the bubble column.
The external loop is made of transparent tubes with 0.09 m diameter
Figure D.1: A schematic view of a tubular photobioreactor at Las Palmeri-llas experimental station, Almeria-Spain.
and joined into a loop configuration to obtain a total horizontal length of 400 m, with a capacity of 2200 L. The objective of the external loop is to increase the surface exposed to the sun in order to the microalgae capture a larger amount of radiation and perform photosynthesis. Moreover, CO2 in gas phase is injected at the beginning of the loop to provide the inorganic carbon to growth and to control the pH of the culture.
The bubble column is 3.25 m high and 0.5 m in diameter, with a capacity of 400 L, and performs several functions. On one hand, it is used for mixing the culture and desorption of O2 produced during the photosynthesis by air injection at a flow rate of 140 L/min. On the other hand, nutrients are also added in the column and the biomass harvesting is performed in this part of the process. The culture is continuously recirculated between the loop and the column using a pump located in the bottom of the column. The culture medium composition is shown in Table D.1. Furthermore, the culture is operated in nutrient-sufficient conditions: nutrients are ever at concentrations not limiting the growth.
Table D.1: Composition of the culture medium used in the tubular photobioreactor. _______________________________________
Component	Concentration [mmol/L]
Ca(NOs)2	7.92
KH2PO3	2.45
MgSO4	2.71
Fe-EDTA	4.8190x10-3
Zn-EDTA	6.566x10-4
Mn-EDTA	3.8647x10-3
Cu-EDTA	2.829x10-4
Mo	6.949X10-4
B	2.15850X10-2
The pH, temperature, and dissolved oxygen are measured with Crison probes at several points of the solar receiver of the photobioreactor: three positions for dissolved oxygen, five positions for pH and temperature. These measurements are well distributed along the tube. The biomass concentration is estimated from a turbidity meter located at the bubble column. Moreover, liquid and gas flow rates are measured using digital flow meters. All these measurements are connected to a control computer through a data acquisition device NI Compact FieldPoint.
The pH control problem in tubular photobioreactors deals with keeping the outlet pH of the external loop at a desired reference value in spite of disturbances. For this microalga specie, the optimal pH reference value is 8 [63].
The pH behavior in a microalgal culture is mainly influenced by two phenomena. On one hand, the intake of CO2 as nutrient causes the formation of carbonic acid, leading to a decrease in the pH of the culture. On the other hand, when the microalgae perform the photosynthesis they consume CO2 and generate O2 , causing an increase in the pH. The provided CO2 is transferred to the culture medium as a function of mass transfer coefficient in the system. Remaining fractions of injected CO2 produce an oscillatory behavior in the measured pH, because of the continuous recirculation of the culture, until its total elimination.
The main system disturbances are the medium injected to perform the biomass harvesting, which introduces total inorganic carbon to the culture, and thus decreasing the pH value, and solar irradiance changes, caused by the solar cycle and presence of clouds, producing changes in the rate of photosynthesis and thus in the rise of pH. The control variable is the CO2 flow/velocity provided by a valve, located at the beginning of the loop (see
Figure D.1), which flow range is 0 to 5 L/min.
D.2 Mathematical model
The microalgal culture is a two-phase system and it is formed of two interconnected compartments: a bubble column and a solar receiver. In the liquid phase, biomass, dissolved oxygen and total inorganic carbon concentrations mass balances are considered, while the gas phase takes into account the mass balance of carbon dioxide and oxygen molar fraction. The dynamic model of microalgal production of photobioreactors was previously developed and described in [40, 64, 79]. The photobioreactor used in this work operates under atmospheric pressure, in which no significant overpressure existing in whatever place of the reactor. The flow is assumed to be one-dimensional. The reactor operates under controlled temperature conditions. The variation of temperature along the solar receiver is lower than 1 °C and ranging from 20 to 28 °C along the daily cycle, thus no large changes taking place. For this reason, the temperature balance is not considered in this work. In the following, the photobioreactor model is briefly described.
D.2.1 External loop mathematical model
The biomass mass balance is directly dependent on the photosynthesis rate, thus the equation for the biomass concentration is expressed as
dC	dC
-C-(x, t) + Vi (t)-C(x, t) = P02 (x, t)C-(x, t)Yp/x,
(D.1)
where t G [0, +to) is the time, x G [0, L] is the space, Cb is the biomass concentration, Yp/x is the biomass yield coefficient produced by the oxygen unit mass, V) = Qi/(A(1 — e)) is the liquid velocity, A is the cross-sectional area of the tube, e is the gas hold-up and Ql is the volumetric flow rate of liquid. The oxygen production rate per biomass mass unit is given by
PO2 (x, t)
p	Tn
P O2 max laV
K ■ m + Inv
-C1
^B1e( pJ-(x,‘)) — B2e( pH(x-t&gt; )) — rPO2 max,
(D.2)
*
where Kq2 is the oxygen inhibition constant, [O2] is the dissolved oxygen concentration, Pq2 max is the maximum photosynthesis rate for microorganisms under the culture conditions, Bi and B2 are preexponential factors,
Ci and C2 are the activation energies, r is the respiration factor, and /v,., m and z are form parameters. The average solar irradiance Iav is given by the following expression:
(D.3)
where I0 is the solar radiation on an obstacle-free horizontal surface, Ka is the extinction coefficient and dt, i is the external loop tube diameter. Notice that the solar radiation is modulated by a factor al, which represents the solar radiation fraction available in the particular area of the reactor.
Regarding the dissolved oxygen, this is related to the gas-liquid mass transfer rate and the photosynthesis rate as
+ Klal,o2 (x, t)([O2](x, t) - [O2](x, t)), (D.4)
where MO2 is the molecular weight of oxygen, Kiai,o2 is the volumetric gasliquid mass transfer coefficient for oxygen, [O2 ] = HO2 PTyO2 is the oxygen equilibrium concentration with gas phase, HO2 is the Henry's constant for oxygen, PT is the total pressure, and yO2 is the oxygen molar fraction in the gas phase.
The mass balance of the total inorganic carbon concentration is written in a similar way to the dissolved oxygen balance as
+ Klal,cO2 (x, t)([CO2](x, t) - [CO2](x, t)), (D.5)
being [CT] the total inorganic carbon concentration, Kt ai ,CO2 is the mass transfer coefficient for CO2, PCO2 = —PO2 is the carbon dioxide consumption rate, [CO2] = HCO2PTycO2 is the dioxide carbon in equilibrium with the gas phase, HCO2 is the Henry's constant for carbon dioxide, [CO2] is the dissolved carbon dioxide and ycO2 is the carbon dioxide molar fraction in the gas phase.
The gas phase is made of CO2 and O2 molar fractions. The mass balance for carbon dioxide molar fraction is described as
~ (x, t) + Vg (t) dyCO' (x, t) =
— 4^(1 — £(x, t))Kiai,CO2([CO2](x, t) — [CO2](x, t)), (D.6) £ ( x, t )
where Vg = Qg/(Ac) is the gas phase velocity (control variable), Qg is the volumetric flow rate of the gas, and Vmoi the molar volume.
For the oxygen, an analogous mass balance can be established
dyo2
dt
(X, t) + Vg (t)
(X t) =
-	- £(x t))K‘a‘O2t) - t)).
(D.7)
The boundary conditions for model (D.1)-(D.7) are given by
Cb(0,t) = Cb,°ut(t), lCO2 (0,t) = lCO2 in (t)
[O2](0,t) = [O2]°ut(t),	[CT](0,t) = [Ct ]°ut(t),
yCO2 (0, t) = yCO2 in (t)	(D.8)
where Cbout, [O2]out and [CT]out are the biomass, dissolved oxygen and total inorganic carbon concentration at the outlet of the bubble column, respectively. These values are obtained from the bubble model described in Section D.2.2. yco2 in and yO2 in are the injection of molar fraction of CO2 and O2, respectively.
Equations (D.1)-(D.7) describe the photobioreactor state equations. In addition, a relationship between the total inorganic carbon concentration and the dissolved carbon dioxide in the culture is also needed for system closure. Such relationship is described as follows.
In microalgal cultures, the changes in pH are due mainly to consumption of carbon dioxide; pH variations due to consumption of other nutrients and degradation of excreted metabolites can be neglected [80]. As dioxide carbon in gas phase dissolves in the media, it breaks down into different species, namely dissolved dioxide carbon, CO2, carbonic acid H2CO3, bicarbonate, HCO—, and carbonate CO((-. This chemical process can be described as follows. First, CO2 reacts with water to yield carbonic acid
CO2 + H2O	H2CO3.	(D.9)
H2CO3 is a weak acid and it dissociates, yielding HCO-,
H2CO3	H+ +HCO-.	(D.10)
The reaction equilibrium (D.10) can be described by an equilibrium constant Ki, expressed as
[HCO-][H +] [CO2]
= 10-6.381
(D.11)
The HCO3- that is produced will further dissociate as
HCO- H+ + CO3-
(D.12)
The dissociation (D.12) can also be described by a second equilibrium constant, K2, such that
K2 =
[CO3-][H +] [HCO-]
10.377
Finally, the water dissociates according to
H2O OH- +H+,
which is described by the following equilibrium constant
Kw = [OH-] • [H+] = 10-14.
(D.13)
(D.14)
(D.15)
The [H+] concentration is generally given as a pH value, defined as the negative logarithm, pH= — log10[H+].
The total inorganic carbon is equal to the sum of inorganic carbon species,
[Ct ] = [CO2] + [HCO-] + [CO3-].	(D.16)
Combining (D.11), (D.13) and (D.16), it is obtained
[Ct] = (* + A + KK2) [CO2]'	(D'17’
d[Ct] =	(.	+	K1	+	K1K2)	d[CO2]	(	K1	+	2K1K2)	[CO ] d[H+]
dt v	[h+] + [h+]2; dt	v [h+]2 + [h+]3 ;	2 dt
(D.18)
In addition, the following electroneutrality constraint must be satisfied
d[H+]	d [Cat+]
dt + dt
d [OH-] + d[HCO-] + 2 d [CO|-] + d [An-] dt + dt + dt + dt .
(D.19)
Assuming constant concentrations of cations, [Cat+], and anions, [An ], equation (D.19) is rewritten as
d [H+ ] =	[k+] + -tf+f	d[CO2]
dt 1 I Kw + K1[c°2] + 2 K1K2	dt
1+ [H+]2 + H +	+2 H +
(D.20)
The boundary conditions for [H+] and [CO2] are given by
[H+](0,t) = [H+]out(t),	[CO2](0,t) = [COO),	(D.21)
where [H+]oui and [CO2]out are the concentrations of [H+] and [CO2] at the outlet of the bubble column, respectively. These values are obtained from the equations of the bubble column, presented in Section D.2.2.
If the chemical equilibria between the different forms are disturbed - as when dioxide carbon is added to the culture, removed in photosynthesis, or vented to the air - the reaction will shift one way or the other in an attempt to reestablish equilibrium. For example, when CO2 is added to the system the H+ increases following the production of H2CO3, as can be seen in (D.9) and (D.10). So, the pH decreases and consequently the total inorganic carbon rises. Conversely, when CO2 is removed during photosyntheis or lost to the air by diffusion, the reactions shift to the left in (D.9) and (D.10). The H+ concentration declines, but the COi(- concentration slightly rises, preventing a rise in pH and a decrease in the total inorganic carbon concentration.
Figure D.2 shows the distribution of the forms of inorganic carbon in the photobioreactor with changes in pH in steady state. Note that at pH 6.5-10.5, bicarbonate is the most abundant form. CO2 dominates at low pH, while carbonate dominates at high pH values.
As can be noted, if the pH is at an equilibrium point, so the total inorganic carbon, with its inorganic carbons species, is at equilibrium too. In
Figure D.2: Distribution of the forms of inorganic carbon in the photobioreactor with changes in pH.
the case treated in this thesis, carbon consumed by microalgae is compensated by supplying CO2 to maintain pH and, as a consequence, a desired level of inorganic carbon is achieved. Based on this hypothesis, in this work the total inorganic carbon is used as output variable to control the pH.
In sum, the tubular photobioreactor model is given by equations (D.1)-(D.8), (D.18) and (D.20)-(D.21), which can be written in the following compact form
dz	dz
- + A(z(x, t)) — = G(z(x, t)),
z(0, t) = ^(t),
(D.22)
where z = [C [O2] [Ct] [CO2] [H+] yco2 yo2 ]T, A is a 7 x 7 matrix and G is a vector function.
D.2.2 Bubble column mathematical model
For the bubble column, a similar formulation can be applied taking into account several considerations [79]. Moreover, the dilution process must be added to the liquid phase balances. Then, for the biomass concentration the following mass balance can be established:
Vliqc(t) dCbOut (t) + Qiiq,c(t)(Cb,out(t) — Cb,in(t)) =
Vliq,c(t)Po2 (t)Cb,OutYp/x — Qm(t)Cb,Out(t), (D.23)
where the subscript c refers to the bubble column, Cb,in is the inlet biomass concentration (solar receiver output), Vliq,c is the liquid volume in the column and Qm is the volumetric flow rate of culture medium. The oxygen production rate per biomass mass unit, PO2 is calculated in the same way as the external loop, which is given by (D.2)-(D.3).
In the case of the total inorganic carbon, the relationship between the inlet medium [CT]m and the outlet overflow is included in the mass balance, resulting in
Vliq,c(t) [ dtOUt (t) + Qliq,c(t)([CT]out(t) — [Ct]in(t)) =
Viiq,c(t)PCO2 (t)Cb,out(t) + Vliq,c(t)Klal,CO2c(t)([CO2*](t) — [CO2](t))lm — MCO2
Qm(t)([CT ]m — [Ct ]out (t)),	(D.24)
where [CT]in(t) is the total inorganic carbon at the inlet of the bubble column. The mass transfer coefficient for CO2 in the bubble column is
defined as Kiai,co2c, [CT]m is the inorganic carbon concentration in the culture medium, and (• )lm is the logarithm mean driving force.
Regarding the dissolved oxygen, a similar procedure is evaluated to obtain the following mass balance:
d[O2]out dt
(t)+Q iiq,c(t)([O2]out(t) — [O2]in(t)) — +Viiq,c(t)
Pq-2 (t)[Cfe]OMt (t)
Mq2
+ Viiq,c(t)Kiai,Q2c(t)([O^](t) — [O2](t))im — Qm(t)([O2]m — [O2]out(t)),
(D.25)
where [O2]in(t) is the oxygen concentrations in the liquid phase at the inlet of the bubble column. Klal,O2C is the volumetric gas-liquid mass transfer coefficient for oxygen in the bubble column, and [O2]m is the dissolved oxygen in the culture medium.
Regarding the gas phase, the mass balance for the O2 to N2 molar ratio for the bubble column is described by
Vgas,c (t)	(t) + FN2C	(Yo2,out (t) - Y02,in(t)) =
dt	Vn2,c
- Vliq,c(}Vmol Kiai,o2c(t)([O2](t) - [O2](t))im, (D.26) yN2&gt;c
where Vgas,c(t) is the gas volume of the column, and yN2C is the nitrogen molar fraction in the bubble column. The O2 to N2 molar ratio in the gas phase is defined at the inlet, YO2in, and outlet, YO2 OUt, of the bubble column.
The carbon dioxide to nitrogen molar ratio is regarded as the following mass balance:
Vgas,c (t) dYC00t2’°Ut (t) + F	(Ya02,out (t) - YcO2,in(t)) =
dt	t
- Vliq,c(t}Vmol Kiai,co2c(t)([CO2*](t) - [CO2](t))im,	(D.27)
yN2,c
where YCO2 in and YCO2 out is the carbon dioxide to nitrogen molar ratio in the inlet and outlet of the bubble column, respectively. The relationship between the molar fraction and the molar ratio is known to be defined as
Y y = 1+ Y'
As well as the mathematical model of the solar receiver, a relationship between the total inorganic carbon and dissolved carbon dioxide in the
bubble column must be established. This result in the following equations:
-[Ct ]out
-t
(t)	(1+[H+U(t) + [H+ ]2ut(t)
[C°2]o«i(t) f [h+]2 (,) ._______
VH ]out(t)+ [H+]|ut(t)
Ki
K1K2	-[CO2]out (t)_
-t ()
-[H+ ]out (t),	(D.28)
-t
Ki
2K1K2
-- ' 1 3
and
-[H +]
Ki
___________.	2K1K2
[H+ ]o„t(t) ' H+]|„t(t) Kw :o„t(t)
out
-t ( ) = 1 I	Kw	. Ki[CO2]o„t(t) . 2 K1K2
1+ H+]2„t(t) ' H+]2„t(t)	12 H+]|ut(t)
-[CO2] out (t)
-t ().
(D.29)
Equations (D.23)-(D.29) can be rewritten as
- E
(t) = ^(E(t)) + B(E(t))Qm(t),
(D.30)
where E [Cb,out [Ct]out [O2Ut Yo2&lt;out Yao2,out [CO2] [H +]]T is the state vector, and ^(E(t)) and B(E(t)) are vector functions with appropriated dimensions.
D.3 Model validation
The calibration and validation of the system were performed by comparison of the real data with the simulation responses obtained using estimated parameter values. These parameter values (see Table D.2) were determined by an optimization algorithm which minimizes the ISE (Integral of Squared Error) criterion [40, 64].
Table D.2: Photobioreactor model parameters [40, 64].
Parameters	Description	Value and units
Ac	Cross-sectional area of the column	0.1257 m2
Ai	Cross-sectional area of the loop	0.0055 m2
Bi	Preexponential factor	2.4098
B2	Preexponential factor	533.009
Co	Drift flux model parameter	0.996
Ci	Activation energy	6.2684
C2	Activation energy	68.8062
[CT ]m	total inorganic carbon in medium	8 mol/m3
Table D.2 - (continued)
Parameters	Description	Value and units
dt,c	total column diameter	0.4 m
dt,l	total loop diameter	0.084 m
Hco2	Henry's const. for carbon dioxide	38.36 mol/ (atm m3)
H02	Henry's const. for oxygen	1.07 mol/ (atm m3)
Ka	Extinction coefficient	133.0324 m2/ kg
KCO2,c	Transfer coeff. const. for CO2 in column	0.91
Kco2,i	Transfer coeff. const. for CO2 in solar receiver	0.91
K02,c	Transfer coeff. const. for O2 in column	0.91
Ko2,l	Transfer coeff. const. for O2 in solar receiver	0.91
Ki	Form parameter	173.9504
		^E/(m2 s)
K02	Oxygen inhibition constant	0.7202 mol/ 3
Lc	Length of column	m 3.2 m
Li	Length of loop	400 m
m	Form parameter	0.0015
MCO2	Molecular weight of CO2	32 g/mol
M02	Molecular weight of O2	44 g/mol
n	Form exponent	0.9779
[O2]m	Dissolved oxygen in medium	0.2812 mol/m3
Po2,max	Maximum photosynthesis rate	4.37 x 105 kg of O2/(kg s)
PT	Total pressure	1 atm
r	Respiration factor	0.01
R	gas constant	8.31 J K/mol
Sc	Column area	4.0212 m2
Yo/x	Biomass yield coefficient	0.9713 kg of O2
z	Form parameter	5.4333
ac	Distribution solar factor for bubble column	0.1052
ai	Distribution solar factor for solar receiver	0.9725
DO solar receiver - model “ “ DO column - model O DO solar receiver - real □ DO column - real ~ 400
-o S
&gt; p
200
S oj 1
0
0	5	10	15	20	25	30	35	40	45
9
8
I
Q.
7
pH solar receiver - model	pH solar receiver - real

20
25
30
35
40
45
1.25
E
"ft
0.75
0.5 -
0.25 L
0
20
25
30
35
40
45
CO2 injection
Medium injection
•g 2 1
•| 0 ■ 0
10
15
20
MJ
25
30
35
40
45
10
8
6
4
2
0
1500
f.
1000 -
500 -
-L
5
—I—
20
U
25
u
30
35	40
—i
45
6 L
0
5
1
6
E
4
0 -
0
5
5
Time (h)
Figure D.3: Validation results: simulated and experimental data of dissolved oxygen (DO) concentration, pH, and biomass concentration as a function of CO2 injection and solar radiation.
Figure D.3 shows the results for the validation process. For the validation procedure we considered the photobioreactor operating in continuous mode with a dilution rate of 0.34 L/day, circulation velocity of 1 m/s and volumetric flow of 140 L/min at the bubble column. Regarding CO2 injections, a sequence of pulses were used, adapting its amplitude and weight according to the period of day to keep the pH value in an appropriate and secure range.
The mathematical model reproduces the system dynamics with a mean error of 4.7 % for the dissolved oxygen measured at the output of the external loop, and a mean error of 5.4% for the dissolved oxygen measured at the output of the bubble column. On the other hand, the mean error between the real pH and the simulated pH was 1.4% at the output of the external loop. These results show that the mathematical model reproduces the system dynamics for these operating conditions.
Appendix E
Optimization of biomass production in outdoor tubular photobioreactors
In this appendix we are concerned with microalgal biomass production optimization in outdoor tubular photobioreactors. The main purpose of such optimization system is to calculate the culture medium flow rate in order to maximize the biomass production over a determined period of time. Two different methods are proposed in this work: (i) an optimal and (ii) a near-optimal strategy. Simulation and experimental results allow the user to evaluate the effectiveness of the biomass production optimization strategies proposed, compared with a classical harvesting strategy. The appendix is organized as follows. In Section E.1 we describe the photobioreactor optimization problem. Section E.2 outlines the optimal biomass production strategy. The near-optimal strategy is shown in Section E.3. Simulation and experimental results obtained with the proposed optimization strategies are shown in Section E.4.
E.1 The photobioreactor optimization problem
We consider the optimization of the biomass long term production under the influence of day/night cycles. This optimization problem consists to find the time evolution of the culture medium flow rate, maximizing the total quantity of biomass produced and diluted out of the reactor, over a period of time. The photobioreactor used to test the optimization methodology is located at Palmerillas Experimental Station, property of CAJAMAR
foundation (Almería, Spain). The description of this system is given in Appendix D.
A steady state analysis of the dynamic model presented in Appendix D shows that QmCb,out = Vliq,cPO2 Cb,outYp/x I Q liq,c(Cb,in Cb,out)j in which the term (Cb,in - Cb,out) can be considered zero, since in the steady-state regime, the biomass concentration at the inlet and outlet of the bubble column is the same. Therefore, maximizing ,Qm Cbout, amounts to maximizing PO2 Cb,outYp/x which is the biomass productivity and is a concave function for Cb,out. It follows that the solution of
(PO2 Cb,outYp/x) =
dCb,out
for Cb,out is the optimal biomass concentration, C out, and Q*m = Vliq,cPO2 x Yp/x yields the optimal medium flow rate. Note that PO2 Cb,outYp/x is increasing for Cb,out &amp;lt;Cb,out and decreasing for Cb,out &gt; Cb,out. Also note that PO2 is a function of Cb,out (see Appendix D).
In a constant light environment, the optimal medium flow rate, Qm , computed above is a positive constant value since the photosynthesis rate is always greater than the respiration rate, i.e., the therm rPO2 max in (D.2). In this case it is possible to attain an instantaneous biomass output flow optimization. However, in an environment with varying light it is not possible to settle the medium flow rate for an instantaneous productivity optimization. For example, during the night there is no algal growth, only respiration (see (D.2)), so that harvesting during this period would result in loss of biomass. For these systems, the photobioreactor operating in the long term must be considered to solve the biomass production optimization problem [81]. This is the case for the outdoor tubular photobioreactor studied. Hence, the next sections are dedicated to present an optimal and a near-optimal strategy to solve the biomass production optimization problem for outdoor tubular photobiorectors.
E.2 Optimal control for biomass production
The objective of the optimal control strategy is to find the time evolution of the culture medium flow rate, Qm , that maximizes a given cost function J. This cost function considers the daily biomass production, that is, the biomass produced and diluted out of the reactor over the period of one day. Let tf = 24 h be the period of time, then the following optimal control
problem is obtained
(E.1)
(E.2)
rf
max J(Qm(t)) = max	D(Qm(t))Cb,out(t) dt,
Qm(t)	J 0
subject to
dE
-dt (t) = ^(E(t)) + B(E(t))Qro(t),
an	d H
(x, t) + A(H(x, t)) — (x, t) = ^(H(x, t)), (E.3)
H(to, x)= H0(x), E(to) = E0,
0 &amp;lt;Qm(t) &amp;lt;10,
Cb,out(t f ) = Cb,out(t0),
(E.4)
(E.5)
(E.6)
where D = is the dilution rate, being V)iq = Vliql + Vliqc, and H0(x) and E0 are the initial conditions for the solar receiver and bubble column model, respectively. The term D Cbout represents the biomass productivity. Constraint (E.5) refers to valve operating conditions (the valve flow range goes from 0 to 10 L/min), while the terminal constraint (E.6) is included to guarantee the same operating point of the photobioreactor every day.
To solve the optimal control problem (E.1)-(E.6) there are basically two methods: (i) the Pontryagin’s maximum principle and; (ii) direct methods (numerical optimization). When the mathematical model involved is not complex, the Pontryagin’s maximum principle is straightforward to be used and analytic solutions can be provided. However, when the system is complex, as the case treated here, it should be hard to derive explicit solutions. Hence, methods based on numerical optimization are more suitable for these cases.
The numerical optimization scheme used in this work is based on the control parametrization concept [82]. In this technique, the control variable, Qm, is discretized in M constant piece-wise values along the control horizon [t0, tf], such that Tk € [t0, tf], k = 1, .. ., M, is the mesh or grid points with
&lt;0 = T1 &amp;lt;... &amp;lt;Tm-1 &amp;lt;Tm = tf.
(E.7)
The discretization (E.7) is assumed to be equidistant for the sake of simplicity, where
h ~ M - 'I, Ti = t0 + (i “ 1)h, i = 1,M.	(E.8)
Therefore, the control vector in the grid points, is defined as
U = [Qm(1) Qm(2) ••• Qm(M )]T .	(E.9)
Besides the control variable discretization, the photobioreactor mathematical model (D.22) and (D.30) must also be discretized. The discrete approximation used in this work implies in a finite difference Euler scheme for time and space. The spatial partial derivative, in a given time instant, is approximated by
dH (	H(j, t) - H(j - 1,t)
dx (X’ )	Ax
where Ax = L/S is the spatial derivative discretization length, being S the number of points, and j = 1, 2,..., S the j-th spatial volume.
Regarding the time derivative, we use the following approximations for (D.22) and (D.30):
dH (	H(j, k + 1) - H(j, k)
dt (x )	h
dE (t) = E(k + 1) - E(k). (E.U) dt	h
Note that using the time and spatial derivative approximations (E.10)-(E.11), the models (D.22) and (D.30) are transformed into discrete algebraic expressions. For sake of simplicity, the discrete algebraic expressions of (D.22) and (D.30) are written in a compact form as
X (k + 1) = X (k) + $(X (k), Qm(k)),	(E.12)
where
X ■ = (HE(,kk)) ■
A(H(j, k))"	k) -AHx(j - 1 k) + ^(H(j, k))
^(k)(E(k)) +xB(E(k))Qm(k)
Consider the optimization variables
z A [X(1) X(2) ... X(M) Qm(1) Qm(2) ... Qm(M)]T e RNz,
(E.13)
where Nz = (8S + 8)M.
The optimal control problem (E.1)-(E.6) is replaced by the following discretized control problem in the form of a NLP problem with equality
and inequality constraints
M
max J(z) =maxY' D(Qm(k))Cb,out(k)
z	z '
k=1
subject to
X (k + 1) = X (k) + $(X (k), Qm(k)),
X (0) = e0,
0 &amp;lt;Qm(k) &amp;lt;10,
Cb,out (M) = Cb,out(0),	(E.14)
where £0 = [H0(j) E0]T, j = 1, 2,..., S, is the initial condition of (E.12).
Note that problem (E.14) has a large number of optimization variables, (7S + 8)M, and constraints, (7S + 10)M + 1. Even so, this problem can be efficiently solved if the sparse structure of the Jacobian and the Hessian of the associated Lagrangian are taking into account [82-84].
Nevertheless, the dimension of (E.14) can be reduced if the control variable is treated as the only optimization variable, while the state variables are obtained recursively from the state equation. This approach is called recursive approach [83]. Using the recursive approach, the optimization variables are rewritten as
z = [Qm (1) Qm(2) ... Qm(M )]T G RM,	(E.15)
and the state variables from (E.12) are computed recursively as functions of the control variable with initial condition X(0) = £0. In this context, we obtain the following biomass production maximization problem:
M
max J(z) =ma^y D(Qm(k))Cb,out(k) zz k=1 subject to 0 &amp;lt;Qm(k) &amp;lt;10, Cb,out(M) = Cb,out(0).	(E.16)
	(E.17) (E.18)
Problem (E.16)-(E.18) results in a dense structure in the Hessian of the Lagrangian, since the number of optimization variables were reduced and 50% of the elements in the Jacobian of the constraints are zero [84]. In this work, we use the SQP algorithm to solve this problem [83, 85].
The SQP algorithm is an iterative algorithm for nonlinear programming. At each step, a quadratic sub-problem based on a second-order
Taylor approximation of the Lagrangian function of problem (E.16)-(E.18) and the linearization of the cost function (E.16) with respect to the constraints (E.17)-(E.18) is solved. The solution of the quadratic sub-problem is then used to obtain the search direction where the cost function is maximized. Moreover, to enforce convergence from any initial point, a line search method with a merit function is used.
The interested reader can find convergence results of approximations to optimal control problems in [86]. In next subsections it is stated the first-order necessary conditions and second-order sufficient conditions for optimality of (E.16)-(E.18).
E.2.1 First-order necessary Conditions for optimality
Consider the final constraint (E.18) expressed as
(XM ) = Cb,out(M) — Cb,out(0) = 0	(E.19)
and the box constraint (E.17) rewritten as two inequalities constraints given by
g(Q™(k))=( Qm(kl(fc)1&lt;=0^) , for k = V..,M.	(E.20)
Then, the Lagrangian function for the NLP problem (E.16)-(E.18) can be introduced as
M
L(z, PM, A) = J(z)+ PM$m (Xm) +	(A(k))T g(Qm(k)), (E.21)
k=1
where L : X xRxR2M	R, pM e R, A(k) G R2, A = (A(1) ... A(M))T g
R2M.
The first-order necessary condition of optimality for the problem (E.16)-(E.18) are given by the KKT conditions, since (E.16)-(E.18) is a finitedimensional nonlinear mathematical program. This conditions are given by
VL(z, pm, A) = 0,	(A(k))T g(Qm(k)), k = 2, ..., M — 1, (E.22)
where the subscript z denotes the partial derivative with respect to z.
E.2.2 Second-order sufficient conditions for optimality
In this section, second-order sufficient conditions for optimality of problem (E.16)-(E.18) are shown. Consider the following notation
G(z) = (G1(z), ...,GNc(z)),	(E.23)
where G(z) is the collection of functions defining the equality and inequality constraints (E.17)-(E.18), and Ne = 1, and Nc = Ne + 2M.
Then, problem (E.16)-(E.18) is rewritten as
M
max J(z) =max V D(Qm(k))Cb,out(k)	(E.24)
z	z '
k = 1
subject to
G1(z) = 0,	(E.25)
Gi(z) &amp;lt;0, for i = Ne + 1,...,Nc,	(E.26)
and its associated Lagrangian function is given by
L(z, p) = J(z) + MtG(z),	(E.27)
where p G RNc.
A numerical check for second-order sufficient condition for optimality is then evaluated as follows. Let z be an optimal solution for (E.24)-(E.26) with associated Lagrange multiplier ~p satisfying the KKT conditions. Also, consider the set of active indexes defined by Ia = {i G {1,..., Nc}|Gj(z) = 0} and let ma = #Ia. Denote Ga = (Gi)ieI as the active constraints and ~pa g Rm“ the corresponding Lagrange multiplier to active constraints. Then, the second-order sufficient condition can be stated under the following assumption [87].
Assumption E.1. Assume that
1.	J (z), G(z) are twice continuously differentiable with respect to z;
2.	the gradients in VzGa are linearly independent, i.e., rank(Ga(z)) = ma;
3.	strict complementarity ~pa of the Lagrange multipliers holds;
4.	the Hessian of the Lagrangian is positive definite on Ker(Ga(z)),
vTLzz(z, ~p)v &gt; 0, Vv G Ker(VzGa(z)), v = 0.	(E.28)
Then z is a local minimum for (E.24)-(E.26).
As shown in [84], a numeric check of the second-order sufficient condition consists in evaluating the projected Hessian on Ker(VzGa) and verify if its eigenvalues are positive.
E.3 Near-optimal strategy
In this section, a near-optimal strategy for biomass production is presented. From a practical point of view, this strategy is mainly important for those photobioreactors that are not equipped with a continuous medium valve or for those cases where the medium valve flow rate cannot be setted in the values obtained from the optimal strategy described in the previous section.
The idea of the near-optimal strategy is to simulate the model (D.22) and (D.30) to compute the initial switching time, t = tin, from Qm(t) = 0 L/min to Qm(t) = 10 L/min, to start the harvesting process, and the time t = tfn to switch from Qm(t) = 10 L/min to Qm(t) = 0 L/min, to close the photobioreactor. It must be stressed that the culture medium flow rate is equal zero if t / [tin,tfn]. For sake of simplicity, in this thesis, these simulations were performed considering a clear day solar irradiance model [77], and the process variables adequately regulated in their optimal operating point.
Figure E.1 shows the surface of daily biomass production, calculated from the model (D.22) and (D.30) and cost function (E.1), for several different switching times. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production.
As can be seen in Figure E.1, the daily biomass production is constant along its contour levels, which means that the daily production is mainly dependent of the total medium injected through the system. Therefore, it can be concluded from Figure E.1 that a total cumulated flow of 0.23 starting after 17:30 h must bring the biomass productivity close to the optimal operating point. It must be stressed that the results shown in this section are mainly valid for the studied photobioreactor. Due to the different biological system parameters, such as respiration factor, photosynthesis rate, and the photobioreactors structure, the switching time of the near-optimal strategy must be studied case by case.
Figure E.1: Surface of daily biomass production, calculated from the model (D.22) and (D.30) and cost function (E.1), as a function of the initial time and final switching time, in local hours. The dark blue contour level corresponds to wash out of the photobioreactor and the dark red contour to maximal daily production.
E.4 Results
This section shows simulation and real experiments using the optimization strategies to maximize the daily biomass production in tubular photobioreactors. First, the optimization strategies were tested and compared by simulation, where the nonlinear model described in Appendix D was used as virtual plant. The actual harvesting system, that will be called classic strategy (that is based on photobioreactor design optimization), is also shown for comparison purposes. Afterwards, the proposed optimization systems were verified through real experiments on the industrial photobioreactor described in Appendix D.
E.4.1 Simulation results
The simulations were performed for a period of 1 day, where the solar irradiance profile was collected from the real photobioreactor. Regarding the optimal strategy, several simulation tests were made to analyze the influence of the number of grid points of the control variable in the cost function value. Numbers greater than 15 did not show a significant change in the value of the cost function, as can be seen in Table E.1, where M is the number of grid points, CPU is the computing time in seconds, and ERR denotes the relative error of the KKT conditions given in (E.22). Furthermore, a numerical check
Table E.1: Convergence behavior of the tubular photobioreactor optimization problem.
M	CPU [s]	J [kg/m3]	ERR
5	3252	0.2407542	2.27 x 10-3
10	7591	0.2410867	3.39 x 10-4
15	15646	0.2411018	4.74 x 10-4
20	21974	0.2411025	4.94 x 10-4
30	47498	0.2411035	5.19 x 10-4
40	61035	0.2411089	5.35 x 10-4
of the projected Hessian was positive definite with vmin = 0.001 as the smallest eigenvalue for all studied cases. All numerical computations were performed in a workstation Intel Core i7® @2.00 Gigahertz and 4096 KB memory cache.
Figure E.2 shows the response of the optimal, near-optimal and classic strategies for a day with small disturbances in the solar irradiance.
10
8
6
H 4 "= 2
0
0
II
_		— Classic strategy			1	1		1 = 1	1 ■	1	“	
-	— — Near optimal strategy			-
	— Optimal strategy		1 ■	
			ZZ1
4
12
16
20
24
1000
E _g gj J
500 -
0 u
0
4	8	12	16	20
Time (h)
Figure E.2: Simulation results for the classic, near-optimal and optimal daily biomass production strategies. The graphics show (top) the biomass concentration at the outlet of the bubble column, Cb,out, (middle) the medium flow, Qm and (bottom) the solar irradiance profile.
As can be seen in Fig. E.2 there is no biomass harvesting during the dark phase of the day cycle for neither of the strategies. This fact is quite obvious since there is only microalgal respiration during this period and therefore perform the harvesting would result in loss of biomass. Moreover, using the optimal strategy the reactor is kept closed until the afternoon, which means that Cb,out &amp;lt;C , as explained in Section E.1. The medium flow changes from Qm	= 0 to Qm	Qm,	where 0&amp;lt;	Qm	&lt;	l0,	when	Cb,out +	Cb,out
in order to maintain the maximal biomass production. The harvesting process finish at the night, when a sufficient level of biomass concentration is reached to satisfy the terminal constraint (E.18).
The total cumulated flow Jtf D(Qm(t))dt of the classical strategy is 0.1820, i.e., 18.2% of the medium has been renewed during the 24 h, performed by the injection of culture medium from 9:00 to 10:00 with a flow rate of 10 L/min. The resulting daily biomass production for this strategy is 0.2337 kg/m3. Using the near-optimal strategy the daily biomass production was of 0.2488 kg/m3, i.e., an increase of 6.4613% over the classic harvesting strategy was obtained with total cumulated flow of 0.1577. Finally, using the optimal strategy proposed in this work, a daily biomass production of 0.2578 kg/m3 with a total cumulated flow of 0.1629.
The optimal strategy proposed in this work resulted in an increase of 10.3124% over the classic harvesting strategy and an increase of 3.8511% with respect to the near-optimal strategy. Note that these results are even more relevant when extrapolated to an industrial level with several photobioreactors in series with a continuous production over all year. Moreover, using the optimal strategy it is possible to maintain the perennity of the process due to the terminal constraint. Also note that, although the classic and near-optimal strategies have guaranteed the perennity of the process for the specific day shown in Figure E.2, this cannot be ensured for all days because these strategies do not take into account the process dynamics. In this context, using the optimal strategy it is possible to prevent that the culture density be very high and consequently avoid that the culture be affected by the shadow effect.
Since in real experiments the presence of uncertainties between the model and real plant may be relevant, a sensitivity analysis with solar irra-
Table E.2: Sensitivity to solar irradiance.
Uncertainty [%]	J [kg /m3]	¿M [kg/m3]
-10	0.2400353	-0.0127
+10	0.2419881	0.0061
diance uncertainties conditions was developed. Table E.2 summarizes the sensitivity results. As can be seen the solar irradiance has a low sensitivity in the cost function and terminal constraint.
E.4.2 Experimental results
This section shows the results obtained when using the classic, near-optimal and optimal strategies to maximize biomass production in a real tubular photobioreactor. The experiments have been performed at the plant described in Appendix D. All experiments performed consider the pH and temperature adequately controlled in their optimal operating points. Moreover, the microalgae is continuously aerated to remove the dissolved oxygen produced during the photosynthesis process.
The harvesting strategies were implemented on an industrial computer located at the plant facility. A LabVIEW-based software executes the optimal, near-optimal or classic harvesting strategies, which are coded in the Matlab environment. All systems sensors and actuators are connected to the Compact-FieldPoint unit from National Instruments. It must be stressed that the biomass concentration is estimated by a turbidity meter, which was calibrated by comparing biomass concentration values obtained from laboratory with the signal values obtained from the sensor. Although this apparatus has a good measurement accuracy, the facility has a high noise level. In this context, the biomass graphics shown in this section were treated and filtered for better viewing.
Classic Harvesting Strategy
Figure E.3 shows a representative experimental result of the classic harvesting strategy in the tubular photobioreactor. As can be seen in the upper graphic of Figure E.3, the biomass concentration operating point was of 1.1 kg/m3 and the solar irradiance was smooth (bottom graphic of Figure E.3) during the experiment. For this particular day, the classic harvesting strategy obtains a daily biomass production of 0.2956 kg/m3 with a total cumulated flow of 0.3061. The mean biomass productivity was estimated in 2.3976x10-6 kg/(m3-s).
Near-Optimal Harvesting Strategy
The near-optimal harvesting strategy was implemented with the starting harvesting time t = 18 : 00h and the closing time t = 19 : 05h, resulting in a total cumulated flow of 0.2485.
Figure E.3: Experimental result of the classic harvesting strategy being used at the Palmerillas Experimental Station. The harvesting process starts around 8:00 h and lasts 1 hour. The total cumulated flow is 0.3061 and the daily biomass production obtained is 0.2956 kg/m3.
Figure E.4 shows an experimental result obtained with the near-optimal biomass production strategy. The biomass concentration operating point was around 1 kg/m3. It can be seen in the bottom graphic of Figure E.4 that the solar irradiance is smooth along the day. The daily biomass production obtained from this experiment was 0.2947 kg/m3 and the mean biomass productivity was estimated in 4.2937x10-6 kg/(m3-s).
Another experiment with the near-optimal strategy is shown in Figure E.5. As can be seen in the bottom graphic of Figure E.5 there are small transients in the solar irradiance, due to passing clouds. The daily biomass production obtained from this experiment was 0.3435 kg/m3 and the mean biomass productivity was estimated in 3.4000x10-6 kg/(m3-s).
Optimal Harvesting Strategy
The medium flow calculated by the optimal daily biomass production strategy is performed offline. In this way, initial conditions obtained from the real plant are used in the model (D.22)-(D.30), and the optimization procedure
800
Time (h)
Figure E.4: Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.2947 kg/m3.
is then applied. The solar irradiance is estimated through a meteorological model [77]. This model calculates the solar irradiance for a clear day of a desired location, in this case, Almería - Spain. Although clear days are not always a realistic scenario, the slow biomass dynamics and the sensitivity analysis presented in Table E.2 shown that this solar irradiance model gives a good model prediction for the optimization system. Moreover, to minimize the errors between the model and the real system caused by unmodelled dynamics and unmeasured disturbances, the error e = Cb,out(M) — Cbr (M), where Cbr (M) is the real biomass concentration value, obtained from the last sampling time, is summed to the terminal constraint. Note that using this approach, the optimization system works as a sliding horizon methodology. Finally, a PI controller is used in the medium valve to set the flow rates obtained from the optimizer.
Figure E.6 shows a representative day of the photobioreactor operating with the optimal biomass production strategy. Note that the biomass operating point is of 0.5 kg/m3 . The system was operating with low cell density because in this period of the year (summer) the microalga suffers stress and
T
T
10 -
E 3 S S
-L.
16
-L.
20
24
800
E 600 -
S 400 -
200 -
8 12 16 20
Time (h)
24
c
I
i

4 -
2 -
0 u
0
0 L
0
T
T
Figure E.5: Experimental result of the near-optimal harvesting strategy. The harvesting process starts around 18:00 h and lasts 1 hour. The total cumulated flow is 0.2485 and the daily biomass production obtained is 0.3435 kg/m3.
the cells may adhere in the photobioreactor tube wall, due to high temperatures and solar irradiance. For this experiment, a daily biomass production of 0.0832 kg/m3 was achieved with a total cumulated flow of 0.1737. The estimated mean biomass productivity is 2.8964x10-6 kg/(m3-s). As can be noted in the upper graphic of Figure E.6, the final constraint was not assured due to the unmodelled dynamics and unmeasured disturbances. The terminal constraint error was of -0.0681 kg/m3. In order to reduce this error, the optimization problem solved for the next time horizon was considering this error in the terminal constraint.
The experiment performed in the next day is shown in Figure E.7. Observe that in this experiment, the culture medium injected in the system is much lower than the experimental test shown in Figure E.6, as an attempt to fulfill the terminal constraint. It results in a total cumulated flow of 0.0918, daily biomass production of 0.0392 kg/m3 and mean biomass productivity of 2.5163x10-6 kg/(m3-s). The terminal constraint error is of -0.0103 kg/m3, as expected the error was reduced.
Time (h)
Figure E.6: Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 7 hours. The total cumulated flow is 0.1737 and the daily biomass production obtained is 0.0832 kg/m3.
gies are summarized in Table E.3. This table shows the total cumulated flow (TCF), mean biomass productivity (Pb), daily biomass production (DBP), and the normalized daily biomass production (NDBP). This last index corresponds to the ratio between daily biomass production and the integral of the biomass concentration over the time horizon. This index was calculated to minimize the influence of the system operating point over the results.
As can be seen in Table E.3, the optimal strategy had worst performance than the near-optimal strategy. This is due to the fact the photobioreactor was operating with a low cell density during the experiments to avoid the shadow effect caused by the adherence of the microalgae cells in the photobioreactor tube wall (typical phenomenon that occurs in the period of the experiments). Consequently, the biomass growth rate was low during those days. However, it is expected that the optimal strategy has better performance when operating with the same cell density of the other experimental cases.
Figure E.7: Experimental result of the optimal harvesting strategy. The harvesting process starts around 13:00 h and lasts around 9 hour. The total cumulated flow is 0.0918 and the daily biomass production obtained is 0.0392 kg/m3.
E.5 Conclusions
In this appendix, the daily biomass production optimization problem in tubular photobioreactors was studied. To deal with this problem, two strategies were proposed: (i) an optimal biomass production strategy and; (ii) a near-optimal biomass production strategy. Regarding the optimal biomass production strategy, a direct optimization method together with the control parametrization concept was used to solve the nonlinear programming problem. In the case of the near-optimal strategy, the biomass harvesting time for a constant medium flow rate value is computed. This calculus is evaluated directly from the system dynamical model, under real conditions.
Simulation results shown that both strategies proposed in this work achieved higher biomass production than the classical strategy currently used in the real plant. In addition, these results also shown that the best period of time to perform the biomass harvesting process is at the afternoon till the night, contrary to the classical strategy in which is carried out at the beginning of the day. For the experimental results, the proposed strategies
Table E.3: Performance indexes calculated from the response of the experimental results of the classic, near-optimal and optimal strategies.
Strategy	Index	Day	
		1	2
	TCF	0.3061	
Classic Strategy	DBP [kg/m3]	0.2956	
	NDBP	1.9164x10-4	
	Pb [kg/(m3-s)]	2.3976x10-6	
	TCF	0.2485	0.2485
Near-optimal	DBP [kg/m3]	0.2947	0.3435
Strategy	NDBP	2.3028x10-4	2.2765X10-4
	Pb [kg/(m3-s)]	4.2937x10-6	3.4000X10-6
	TCF	0.1737	0.0918
Optimal Strat-	DBP [kg/m3]	0.0832	0.0392
egy	NDBP	1.2077X10-4	6.6293X10-5
	Pb [kg/(m3-s)]	2.8964X10-6	2.5163X10-6
also shown promising results. However, due to the fact that it is not possible to reproduce the tests under the same conditions, it is hard to quantify the improvement obtained in the photobioreactor with such optimization systems.
Although the evaluation performed in this work is based on a single tubular photobioreactor, the results can be easily extrapolated to an industrial level with several photobioreactors in series with a continuous production. In such case, the benefits are even more visible.</field>
	</doc>
</add>