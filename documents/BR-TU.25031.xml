<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.25031</field>
		<field name="filename">9583_FabioHidekiAshikawaCorr17.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 
 

 

FÁBIO HIDEKI ASHIKAWA 

 

 

 

 

 

 

 

 

 

 

 

MITIGAÇÃO DE GOLFADAS EM SISTEMAS OFFSHORE UTILIZANDO 

MODELO DINÂMICO SIMPLIFICADO 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

São Paulo 

2017



 
 

 

FÁBIO HIDEKI ASHIKAWA 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

MITIGAÇÃO DE GOLFADAS EM SISTEMAS OFFSHORE UTILIZANDO 

MODELO DINÂMICO SIMPLIFICADO 

 

 

 

 

 

Dissertação apresentada à Escola 

Politécnica da Universidade de São Paulo 

para obtenção do título de Mestre em 

Ciências 

 

 

 

 

 

 

 

 

 

 

 

 

São Paulo 

2017



 
 

 

FÁBIO HIDEKI ASHIKAWA 

 

 

 

 

 

 

 

 

 

 

 

MITIGAÇÃO DE GOLFADAS EM SISTEMAS OFFSHORE UTILIZANDO 

MODELO DINÂMICO SIMPLIFICADO 

 

 

 

 

 

Dissertação apresentada à Escola Politécnica 

da Universidade de São Paulo para obtenção 

do título de Mestre em Ciências 

 

 

Área de Concentração: Engenharia Química 

 

 

Orientador: Prof. Dr. Song Won Park 

 

 

 

 

 

 

 

 

 

 

 

São Paulo 

2017 

 



 
 

 

 

 

 



 
 

 

AGRADECIMENTOS 

 

 

Ao meu orientador, Prof. Dr. Song Won Park, pelo apoio, grande paciência e ajuda 

durante a elaboração desta dissertação. 

 

Aos membros da banca de qualificação, pelas sugestões de melhoria e correções. 

 

Aos meus pais, pela minha formação e por sempre me apoiarem. 

 

A Petrobras, empresa na qual faço parte, pelo apoio e compreensão durante a 

realização deste trabalho. 

 

A Deus, por me dar força para superar todas as dificuldades desta jornada. 

 

Ao Departamento de Engenharia Química, pela oportunidade de realização do 

mestrado. 

  



 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

“A mente que se abre a uma 

nova ideia jamais voltará ao 

seu tamanho original.” 
 

Albert Einstein  

  



 
 

 

RESUMO 

ASHIKAWA, F.H. Mitigação de Golfadas em Sistemas Offshore utilizando Modelo 
Dinâmico Simplificado. São Paulo, 2017. Dissertação (Mestrado em Ciências - Engenharia 
Química) – Escola Politécnica da Universidade de São Paulo, 2017. 

Atualmente, há inúmeras instalações offshore operando em regimes instáveis de escoamento. Tal regime 

é resultado de diâmetros superdimensionados das linhas de produção ou baixa vazão dos poços. Deve-

se notar que, muitas vezes, o regime intermitente se instala no final da vida produtiva dos poços, devido 

ao declínio natural dos reservatórios, o que causa uma redução da produção do campo de petróleo. Tal 

instabilidade traz dificuldades na produção offshore, pois pode causar danos nos equipamentos da 

plataforma ou perdas de produção. Neste âmbito, é necessário estudar meios de atenuar ou suprimir 

este tipo de regime de escoamento. O objetivo deste trabalho é desenvolver métodos de forma a garantir 

a estabilidade do sistema através da modulação adequada da válvula choke, reduzindo ou mesmo 

eliminando o comportamento oscilatório da produção, mantendo a válvula choke na maior abertura 

possível, trazendo desta forma, ganhos econômicos através do aumento da produtividade do poço. Para 

a análise do sistema, utilizou-se um modelo dinâmico simplificado encontrado na literatura. Este modelo 

foi escolhido por reproduzir adequadamente o escoamento em golfadas severas, causado pela presença 

de trecho horizontal descendente na linha de produção. O sistema foi também modelado no OLGA®, 

sendo este, um software comercial com uso bastante disseminado na indústria de petróleo e com grande 

aplicação em simulações que exigem uma análise do comportamento transiente do problema. A 

avaliação da eficácia dos métodos de supressão das golfadas foi realizada através de duas abordagens 

distintas. Inicialmente, utilizou-se um controlador PI adaptativo com capacidade de operação em 

diferentes regiões de aberturas da válvula choke. Por fim, utilizou-se um Regulador Linear Quadrático 

associado a um observador de estados com filtro de Kalman Unscented com o objetivo de verificar como 

o sistema se comportaria em caso de necessidade de um observador para compensar uma possível 

falha do sensor submarino de pressão. Em ambos os casos, notou-se redução nas oscilações devido a 

golfadas do poço. As soluções foram implementadas através da integração entre o modelo do OLGA® e 

os algoritmos desenvolvidos no MATLAB utilizando servidor OPC.  

 
Palavras-Chave: Controle avançado de golfada severa, óleo e gás, produção 

offshore, válvula choke, modelos de escoamento por golfadas. 
 



 
 

 

ABSTRACT 

ASHIKAWA, F.H. Slugs mitigation in offshore systems by simplified dynamic model. São 
Paulo, 2017. MSc Thesis (Master in Chemical Engineering at Polytechnic School of the 
University of Sao Paulo), Brazil, 2017. 

Nowadays, there are numerous offshore installations operating in unstable flow regimes. Such unstable 

flow is the result of oversized diameters of production lines or low flow wells. It should be noticed that 

often the intermittent system occurs at the end of the productive life of wells due to the natural decline of 

the reservoir, which causes a reduction in oil field production. Such instability brings difficulties in offshore 

production, it can cause damage to the platform equipment or production losses. In this context, it is 

necessary to consider means to reduce or remove this type of flow regime. The objective of this work is 

to develop methods to ensure system stability by adequate modulation of choke valve, reducing or even 

eliminating the oscillatory behavior of the production, with the biggest choke valve opening possible, 

bringing economic gains by increasing well production The system analysis was carried out using a 

simplified dynamic model found in literature. This model was chosen by appropriately reproduction of 

severe slug flow, caused by the presence of downward horizontal section in the production line. The 

problem was also modeled on OLGA®, which is a commercial software with widespread use in the oil 

industry and large application in simulations that require a transient behavior analysis. The evaluation of 

the slugs suppression methods was carried out through two different approaches. First, an adaptive PI 

controller with capability to operate in different regions of choke valve openings was used. Finally, a 

Quadratic Linear Regulator associated to an Unscented Kalman Filter was used to verify how the system 

would behave in the event of a possible failure of subsea pressure sensor. In both cases, there was a 

reduction in oscillations due to slugs. The solutions were implemented through communication between 

the OLGA® model and the control algorithms developed in MATLAB using OPC server. 

 

Keywords: Riser slug advanced control, oil and gas, offshore production, choke valve, 
slugging flow models 

  



 
 

 

GLOSSÁRIO E SIGLAS 

 

Gas lift Injeção de gás com o objetivo de reduzir as perdas de carga no 
escoamento e aumentar a produtividade do poço 

Flowline Trecho horizontal das linhas submarinas dos poços 

Pipeline Sinônimo de Flowline 

Riser Trecho vertical das linhas submarinas dos poços 

Slug Golfada 

Subsea Localização abaixo do nível do mar 

Topside Localização acima do nível do mar (oposto de subsea) 

Válvula Choke Válvula de controle de vazão 

Wellhead Cabeça do poço 

ABB Asea Brown Boveri S.A. 

EKF Extended Kalman Filter 

LQR Linear-quadratic regulator 

PIG “Pipeline Inspection Gauge”  

SP Sigma Point 

SPKF Sigma Point Kalman Filter 

UKF Unscented Kalman Filter 

 

 

  



 
 

 

SIMBOLOS 

 

? Área da seção transversal do tubo 

??, ?? Áreas da seção transversal ocupadas pelo gás e pelo líquido 

??, ?? Áreas do pipeline e do riser 

??, ?? Área livre para o escoamento de gás e de líquido na base do riser 

??1 Constante da válvula choke de produção 

?1, ?2 Distúrbios de outros poços na malha de drenagem 

??, ??, ?? Diâmetros do pipeline, do riser e do poço 

?? Diâmetro interno da seção transversal circular 

? Erro de saída 

? Energia interna por unidade de massa 

?( ) Função não linear do sistema do processo 

? Matriz Jacobiana das derivadas parciais de ?( ) em relação a ? 

??? Razão mássica gás óleo 

??  Fonte de massa da fase gás 

 ?? Fonte de massa da fase líquida  

?? Fonte de massa da fase dispersa de gotículas de líquido. 

?? Fonte interna 

? Elevação 

?? Altura ocupada pelo líquido 

?( ) Função não linear do sistema de medição 

?? Nível de líquido no ponto mais baixo do pipeline 

?? Abertura ao fluxo na base do riser 

? Matriz Jacobiana das derivadas parciais de h( ) em relação a ? 

?? Entalpia da fonte de massa 

? Função custo do controlador LQR 



 
 

 

? Fator de escala  

? Ganho de adaptação 

?? Coeficiente para a vazão de gás na base do riser  

?? Coeficiente para a vazão de líquido na base do riser 

?? Fator de correção do nível de líquido no pipeline 

?? Matriz de ganho do observador 

???? Ganho do controlador LQR 

??, ??, ?? Comprimentos do pipeline, do riser e do poço 

??,? Massa de gás no riser 

??,?, ??,? Massas de gás no pipeline e de líquido no pipeline 

??,?, ??,? Massa de gás no riser e de líquido no riser 

? Vetor de variáveis aleatórias 

? Pressão 

R Solução definida simétrica positiva da equação de Riccatti. 

? Matriz de covariância dos estados 

??? Matriz de correção cruzada entre ? e ? 

?? Pressão de separação 

??? Pressão no topo do riser 

???? Pressão do reservatório 

???, ??? Pressão no fundo e na cabeça do poço 

???,??? Pressão de entrada nominal em regime permanente do pipeline 

?? Índice de produtividade 

Q Matriz de peso do controlador LQR para os estados ?  

? Matriz de covariância do ruído de processo  

R Matriz de peso do controlador LQR para a entrada ? 

? Matriz de covariância do ruído de medição 

?? Fração mássica de gás em condições de equilíbrio 



 
 

 

?? Taxa de distribuição de deslizamento 

??? Número de Reynolds no riser 

??? Número de Reynolds no pipeline 

??? Número de Reynolds para escoamento no poço 

??, ?? e ?? Perímetro molhado do gás, do líquido e da interface 

?? Superfície da interface 

?? Temperatura do pipeline 

?? Temperatura do poço 

? Vetor de controle ou entrada do sistema 

? Transferência de calor da parede do tubo 

?????,?? Velocidade superficial do líquido na entrada 

????, ?????,?, ?????,? Velocidades da mistura, superficial do líquido no riser e do gás no riser 

?????,? Velocidade superficial média de líquido no poço 

? Velocidade 

?? Ruído de medição 

??, ??, ??, ?? Velocidades das gotículas, do gás, da interface e do líquido 

??? Velocidade de queda da gotícula 

?? Velocidade relativa   

??, ?? Volume do pipeline e do riser 

??,? Volume ocupado pelo gás no riser 

??, ?? Volumes ocupados pelo gás e pelo líquido 

?? Ruído do processo  

??,??, ??,?? Vazões mássicas de entrada do gás e do líquido 

??,???, ??,??? Vazões mássicas de saída do gás e do líquido 

???? Vazão mássica de saída da válvula choke 

??,??, ??,?? Vazões mássicas de gás e de líquido na base do riser 



 
 

 

?? Vazão mássica do reservatório 

???? Vazão mássica nominal do reservatório 

??,??, ??,?? Vazão mássica de gás e líquido na cabeça do poço 

? Matriz Jacobiana das derivadas parciais de f( ) em relação a ? 

? Vetor de estados do sistema 

??? Estado estimado  

? Vetor de resposta ou saída do sistema 

? Abertura da válvula choke 

?? Abertura crítica da válvula choke 

?1 Abertura normalizada da válvula choke 

??,?? Fração volumétrica no topo do poço 

??,??
?  Fração mássica do gás no topo do poço 

??, ??, ?? Frações volumétrica do gás, do líquido e das gotículas de líquido 

??,?? Fração volumétrica de líquido no topo do riser 

??,?? Fração volumétrica de líquido na base do riser 

??,??
?  Fração mássica de líquido no topo do riser 

?? Fração volumétrica de líquido  

??
? Fração mássica de líquido na seção do pipeline 

????,?
?  Fração mássica média de líquido na seção do pipeline 

????,? Fração volumétrica média de líquido na seção do pipeline 

????,? Fração volumétrica média de líquido no poço 

????,? Fração volumétrica média de líquido no riser 

? Inclinação do tubo em relação a um plano horizontal 

???? Perdas por fricção no pipeline 

???? Perdas por fricção no riser 

???? Perda de carga no poço devido ao atrito 



 
 

 

? Parâmetros da planta 

? Inclinação do pipeline 

?? Fator de fricção no pipeline 

?? Fator de fricção no riser 

?? Fator de atrito no poço 

? Viscosidade do líquido 

? Massa específica 

??? Densidade da mistura no topo do riser 

?? Densidade do líquido 

??,r Densidade do gás no riser 

?? Densidades do gás  

??,? Densidade do gás no pipeline 

????,? Densidade média do gás no pipeline 

??,? Densidade do gás no riser 

????,? Densidade média da mistura no riser 

????,? Densidade média da mistura bifásica 

??,? Densidade da fase gás no poço 

??? Densidade da mistura no poço 

? Conjunto de pontos sigma 

??, ??, ??  Atrito do gás na parede, do líquido na parede e na interface 

? Vetor de parâmetros do controlador adaptativo 

?? Taxa de transferência de massa entre as fases 

?? Taxa de arrastamento 

?? Taxa de deposição 

   

  



 
 

 

LISTA DE FIGURAS 

 

Figura 2-1 – Esquemático de um poço de petróleo offshore. ............................................... 22 

Figura 2-2 – Padrões de fluxo multifásico em um duto horizontal para diferentes velocidades 

de escoamento. ............................................................................................... 24 

Figura 2-3 – Padrões de fluxo multifásico em um duto vertical para diferentes velocidades de 

escoamento. .................................................................................................... 24 

Figura 2-4 – Esquemático de um sistema sujeito ao fenômeno de golfada severa. ............. 26 

Figura 2-5 – Ciclo de formação de golfadas severas. .......................................................... 27 

Figura 2-6 – Diagrama de bifurcação ................................................................................... 28 

Figura 3-1 – Diagrama de blocos genérico de um controle adaptativo. ................................ 30 

Figura 3-2 - Sistema de controle adaptativo por escalonamento de ganhos ........................ 31 

Figura 3-3 – Controle adaptativo por modelo de referência ................................................. 32 

Figura 3-4 – Controle adaptativo auto-sintonizado ............................................................... 34 

Figura 3-5 – Observador de estado de ordem plena ............................................................ 38 

Figura 3-6 – Sistema de controle realimentado por estado observado ................................. 40 

Figura 3-7 – Diagrama de blocos do sistema com controlador-observador .......................... 42 

Figura 3-8 – Sistema de controle realimentado por estado observado de ordem mínima .... 42 

Figura 3-9 – Estrutura geral do filtro de Kalman ................................................................... 47 

Figura 3-10 – Princípio do filtro de Kalman Unscented ........................................................ 50 

Figura 3-11 – Seção transversal do escoamento. ................................................................ 55 

Figura 3-12 – Perfil lateral de escoamento estratificado. ...................................................... 55 

Figura 3-13 – Representação simplificada do escoamento (Sem bloqueio de líquido) ......... 63 

Figura 3-14 – Representação simplificada do bloqueio de líquido na base do riser, levando a 

golfada severa. ................................................................................................ 63 

Figura 3-15 – Esquemático de um sistema poço-pipeline-riser. ........................................... 71 

Figura 3-16 – Modelo do OLGA® para o sistema pipeline-riser ........................................... 75 

Figura 3-17 – Curva de fração mássica de gás x temperatura do fluido ............................... 76 

Figura 3-18 – Modelo do OLGA® para o sistema poço-pipeline-riser .................................. 77 

Figura 4-1 – Comportamento das pressões na entrada do pipeline (PIPE-1) e no topo do riser 

(PIPE-5) para uma abertura crescente da válvula choke ................................. 78 

Figura 4-2 – Oscilação das pressões de entrada do pipeline e de topo do riser para diferentes 

aberturas da válvula choke .............................................................................. 79 

Figura 4-3 – Diagrama de bifurcação - pressão na entrada do pipeline x abertura da válvula 

choke ............................................................................................................... 80 



 
 

 

Figura 4-4 – Diagrama de bifurcação - pressão no topo do riser x abertura da válvula choke

 ........................................................................................................................ 80 

Figura 4-5 – Oscilação das pressões do fundo do poço e no topo do riser para diferentes 

aberturas da válvula choke .............................................................................. 82 

Figura 4-6 – Diagrama de bifurcação - pressão no fundo do poço x abertura da válvula choke

 ........................................................................................................................ 83 

Figura 4-7 – Diagrama de bifurcação - pressão no topo do riser x abertura da válvula choke

 ........................................................................................................................ 83 

Figura 4-8 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula choke 

com abertura de 5% ........................................................................................ 87 

Figura 4-9 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula choke 

com abertura de 10% ....................................................................................... 88 

Figura 4-10 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula 

choke com abertura de 20% ............................................................................ 89 

Figura 4-11 – Resposta ao degrau e diagrama de Bode para a função de transferência de z 

para P1. ........................................................................................................... 90 

Figura 4-12 – Resposta ao degrau de P1 para aberturas da válvula choke variando de 10% a 

50% utilizando um controlador PI de ganho estático ........................................ 91 

Figura 4-13 – Resposta ao degrau de P1 para aberturas da válvula choke variando de 10% a 

50% utilizando um controlador PI adaptativo ................................................... 92 

Figura 4-14 – Variação do ganho proporcional e do tempo integral do controlador PI adaptativo 

para diferentes aberturas da válvula choke ...................................................... 93 

Figura 4-15 – Comportamento da pressão de entrada do pipeline P1 e abertura da válvula 

choke com a utilização do controlador adaptativo PI para diferentes setpoints de 

pressão ............................................................................................................ 94 

Figura 4-16 – Pressões P1 e P2 com controlador LQR + Filtro de Kalman Unscented para 

diferentes aberturas da válvula choke .............................................................. 96 

Figura 4-17 – Simulação do OLGA® para as pressões P1  e P2 com o controlador LQR + 

Filtro de Kalman Unscented ............................................................................. 97 

Figura A-1 – Tela de configurações básicas do servidor OPC no OLGA ® ......................... 106 

Figura A-2 – Tela de configuração das variáveis a serem expostas no servidor OPC........ 107 

Figura A-3 – Barra de tarefas para início da simulação em “batch” .................................... 107 

Figura A-4 – Tela de status da simulação .......................................................................... 108 

Figura A-5 – Tela de configuração do bloco do Simulink “OPC Configuration”................... 108 

Figura A-6 – Blocos do Simulink para leitura e escrita de variáveis do servidor OPC ........ 109 

 

 



 
 

 

Figura B-1 – Diagrama Simulink do controlador PI adaptativo utilizando o modelo linearizado 

do MATLAB ................................................................................................... 110 

Figura B-2 – Diagrama Simulink do controlador PI adaptativo utilizando o modelo do OLGA®

 ...................................................................................................................... 111 

Figura C-1 – Diagrama Simulink do regulador linear quadrático (LQR) com Filtro de Kalman 

Unscented (UKF) utilizando o modelo linearizado do MATLAB ..................... 112 

Figura C-2 – Diagrama Simulink do regulador linear quadrático (LQR) com Filtro de Kalman 

Unscented (UKF) utilizando o modelo do OLGA® ........................................ 113 

 

 



 
 

 

LISTA DE TABELAS 

 

Tabela 1 – Substituições para a equação do observador de ordem reduzida ...................... 44 

Tabela 2 – Parâmetros do sistema pipeline-riser ................................................................. 70 

Tabela 3 – Parâmetros adicionais para o sistema poço-pipeline-riser .................................. 74 

Tabela 4 – Dados da geometria do sistema pipeline-riser modelado no OLGA® .................. 75 

Tabela 5 – Dados da geometria do sistema poço-pipeline-riser modelado no OLGA® ......... 77 

 

  



 
 

 

SUMÁRIO 

 

1. INTRODUÇÃO ........................................................................................................................................18 

1.1. VISÃO GERAL .......................................................................................................................................... 18 
1.2. MOTIVAÇÃO ........................................................................................................................................... 18 
1.3. OBJETIVOS ............................................................................................................................................. 20 
1.4. ESTRUTURA DO TRABALHO ........................................................................................................................ 20 

2. REVISÃO BIBLIOGRÁFICA .......................................................................................................................22 

2.1. ESCOAMENTO EM GOLFADAS..................................................................................................................... 23 
2.2. GOLFADAS SEVERAS ................................................................................................................................. 26 
2.3. ESTABILIZAÇÃO DE ESCOAMENTO EM GOLFADAS ........................................................................................... 28 

3. MATERIAIS E MÉTODOS .........................................................................................................................30 

3.1. CONTROLE ADAPTATIVO ........................................................................................................................... 30 
3.1.1. Controle Adaptativo com Escalonamento de Ganho ..................................................................... 31 
3.1.2. Controle Adaptativo por Modelo de Referência ............................................................................ 32 
3.1.3. Controle Adaptativo Auto-Sintonizado .......................................................................................... 34 

3.2. REGULADOR LINEAR QUADRÁTICO (LQR) .................................................................................................... 36 
3.3. OBSERVADORES DE ESTADO ...................................................................................................................... 37 

3.3.1. Observador de Estado de Ordem Plena ......................................................................................... 38 
3.3.2. Observador de Ordem Reduzida .................................................................................................... 42 

3.4. FILTRO DE KALMAN .................................................................................................................................. 46 
3.4.1. Filtro de Kalman Estendido (EKF) ................................................................................................... 46 
3.4.2. Filtro de Kalman Unscented (UKF) ................................................................................................. 49 

3.5. SIMULADOR OLGA® ................................................................................................................................ 53 
3.5.1. Modelo Matemático do OLGA® ...................................................................................................... 54 
3.5.2. Formulação Matemática ............................................................................................................... 55 
3.5.3. Equações de Balanço de Massa ..................................................................................................... 56 
3.5.4. Equações de Quantidade de Movimento ....................................................................................... 57 
3.5.5. Equação de Energia da Mistura ..................................................................................................... 59 
3.5.6. Propriedades dos Fluidos e Transferência de Fase ........................................................................ 59 
3.5.7. Transferência de Massa Interfacial ............................................................................................... 60 

3.6. MODELOS DINÂMICOS SIMPLIFICADOS ........................................................................................................ 61 
3.7. “MODELO DE JAHANSHAHI” PARA UM SISTEMA “PIPELINE-RISER” .................................................................... 62 

3.7.1. Equações de Balanço de Massa para um Sistema “Pipeline-Riser” ............................................... 62 
3.7.2. Condições de Contorno na Entrada ............................................................................................... 64 
3.7.3. Condições de Contorno na Saída ................................................................................................... 64 
3.7.4. Modelo do Pipeline ........................................................................................................................ 65 
3.7.5. Modelo do Riser ............................................................................................................................. 67 
3.7.6. Modelo de Escoamento de Gás na Base do Riser .......................................................................... 68 
3.7.7. Modelo de Escoamento de Líquido na Base do Riser ..................................................................... 69 
3.7.8. Modelo de para Distribuição das Fases na Saída da Válvula Choke .............................................. 69 

3.8. “MODELO DE JAHANSHAHI” PARA UM SISTEMA “POÇO-PIPELINE-RISER” .......................................................... 71 
3.8.1. Modelo Simplificado Poço-Pipeline-Riser....................................................................................... 71 

3.9. MODELAGEM DO SISTEMA NO SIMULADOR OLGA® ........................................................................................ 74 
3.9.1. Modelagem do Sistema Pipeline-Riser .......................................................................................... 74 
3.9.2. Modelagem do Sistema Poço-Pipeline-Riser ................................................................................. 76 

4. RESULTADOS E DISCUSSÃO ....................................................................................................................78 

4.1. MODELO DO SISTEMA PIPELINE-RISER .......................................................................................................... 78 
4.1.1. Pressões de Entrada e Saída e Diagrama de Bifurcação do Pipeline-Riser no OLGA® .................... 78 
4.1.2. Diagramas de Bifurcação do Modelo Pipeline-Riser no MATLAB .................................................. 79 

4.2. MODELO DO SISTEMA POÇO-PIPELINE-RISER ............................................................................................... 81 



 
 

 

4.2.1. Pressões de Entrada e Saída e Diagrama de Bifurcação do Poço-Pipeline-Riser no OLGA® ........... 81 
4.2.2. Diagramas de Bifurcação pelo Modelo Poço-Pipeline-Riser no MATLAB ...................................... 82 

4.3. ALGORITMOS DE CONTROLE PARA MITIGAÇÃO DE GOLFADAS .......................................................................... 84 
4.3.1. PI Adaptativo ................................................................................................................................. 85 
4.3.2. Regulador Linear Quadrático com Filtro de Kalman Unscented .................................................... 94 

5. CONCLUSÕES .........................................................................................................................................98 

REFERÊNCIAS ................................................................................................................................................ 101 

APÊNDICE A .................................................................................................................................................. 106 

APÊNDICE B .................................................................................................................................................. 110 

APÊNDICE C................................................................................................................................................... 112 

ANEXO A ....................................................................................................................................................... 114 

ANEXO B ....................................................................................................................................................... 122 

 



 
    18 
 

 

1. INTRODUÇÃO 

 

1.1. Visão Geral 

 

A exploração do petróleo se iniciou em jazidas de pequena profundidade que 

demandavam menores esforços e pouca tecnologia. Entretanto, à medida que estes 

campos superficiais se esgotaram, foi necessário um maior desenvolvimento 

tecnológico de forma a possibilitar a exploração de reservas mais profundas. No Brasil 

há um desafio adicional, pois, as maiores reservas de petróleo se encontram em alto 

mar (offshore). Com o avanço tecnológico, a fronteira exploratória se deslocou para 

lâminas d’água cada vez mais profundas. Nestas condições, a tendência é que o 

escoamento de petróleo esteja sujeito a temperaturas menores, o que possibilita a 

formação de bloqueios nas linhas pela formação de hidratos e/ou parafinas, além 

disso, há uma maior probabilidade de o escoamento ser intermitente (JAHANSHAHI, 

2013). 

Quando o regime de escoamento é em golfadas, ou seja, é composto por severas 

variações na produção de óleo e gás, tem-se diversos problemas na plataforma, 

como: redução de eficiência na separação dos fluidos, possíveis perdas de produção 

ocasionadas por paradas não programadas (shutdown) ou restrição de produção por 

capacidade limitada da planta de processo, causada pelos picos de vazão dos poços. 

Devido a estes desafios, o estudo do regime de escoamentos multifásicos na 

produção offshore e a mitigação de instabilidades é cada vez mais importante para se 

evitar perdas de produção e aumentar a produtividade dos campos de petróleo.  

 

1.2. Motivação 

 

Conforme descrito anteriormente, as golfadas representam um problema que não 

pode ser ignorado, pois produz consequências bastante prejudiciais à produção de 

petróleo. As formas mais comuns de contornar este problema estão descritas a seguir: 



 
    19 
 

 

? Aumentar o volume do separador de produção, ainda na etapa de projeto, de 

modo que o mesmo consiga absorver as variações decorrentes da produção 

em golfadas. Esta solução possui como desvantagem uma maior necessidade 

de investimentos. Há ainda um outro fator limitante: uma plataforma de 

produção offshore possui, muitas vezes, espaço bastante limitado, portanto, a 

opção por um equipamento de maior dimensão pode ser tecnicamente inviável 

(BENDIA, 2013). 

? Utilizar a injeção de gas lift (Figura 2-1), pois com uma vazão adequada de gás 

injetado, pode-se alterar o regime de escoamento, através da mudança na 

relação de velocidades das fases de gás e líquido escoado. Este método tem 

algumas desvantagens, como o aumento do custo de compressão para suprir 

a demanda adicional de gás (SCHMIDT; BRILL; BEGGS, 1980). Outra 

desvantagem é que nem sempre há capacidade suficiente de compressão de 

gás para suprir a vazão ótima de injeção em todos os poços (Problema de 

otimização) e a partir de um certo patamar de vazão, o aumento de perda de 

carga por fricção é predominante e causa perdas de produção. 

? Restringir manualmente a válvula choke (Figura 2-1) do poço que apresentar 

comportamento oscilatório. Esta solução foi uma das primeiras a serem 

propostas para evitar o escoamento em golfadas (YOCUM, 1973). A restrição 

desta válvula pode reduzir ou, até mesmo, eliminar o comportamento oscilatório 

do poço. Porém, ao adotar esta solução, aumenta-se a contrapressão sobre o 

poço e, consequentemente, há uma perda de produção decorrente desta 

alternativa.  

? Uma opção à restrição manual da válvula choke é a modulação automática da 

mesma. Há diversos estudos que comprovam que a modulação adequada da 

válvula choke pode eliminar as oscilações sem causar perdas de produção. A 

manipulação ativa desta válvula pode inclusive aumentar a produtividade dos 

poços, reduzindo a pressão média de escoamento (GODHAVN; FARD; 

FUCHS, 2004). Estes controladores normalmente utilizam como variável 

manipulada a abertura do choke topside e, como variável controlada, a pressão 

na base do riser. 



 
    20 
 

 

 

Na prática, os sistemas de controle anti-golfadas que modulam a válvula choke sofrem 

com limitações de robustez, ou seja, o sistema se torna instável após algum tempo 

devido a, por exemplo, mudanças na vazão dos poços e/ou na planta de processo. 

Com a perda de eficiência do controlador, os operadores tendem a desligar o mesmo 

e utilizar o fechamento manual da válvula choke. Portanto, é importante que sejam 

obtidas soluções robustas para este problema.  

Um agravante do sistema sujeito a golfadas é que o mesmo se caracteriza por ser 

altamente não linear, sendo que os ganhos do controlador mudam drasticamente para 

diferentes condições de operação. Deve-se também lidar com o atraso de controle 

(time delay) decorrente de linhas de produção com grande comprimento, o que 

dificulta ainda mais a estabilização do sistema.  

 

1.3. Objetivos 

 

O objetivo deste trabalho é desenvolver métodos de forma a garantir a estabilidade 

do sistema através da modulação adequada da válvula choke, reduzindo ou mesmo 

eliminando o comportamento oscilatório da produção, mantendo a válvula choke na 

maior abertura possível, trazendo desta forma, ganhos econômicos através do 

aumento da produtividade do poço. 

 

1.4. Estrutura do Trabalho 

 

No capítulo 1, são introduzidos conceitos sobre o escoamento intermitente, em 

especial o composto pelo regime de golfadas. Foi descrita também a motivação para 

realização deste trabalho, através dos ganhos potenciais da modulação adequada da 

válvula choke na supressão das instabilidades.  

No capítulo 2, são apresentados os objetivos do trabalho. 

O capítulo 3 apresenta a revisão bibliográfica do tema de forma a identificar os estudos 

mais relevantes da área e o estado da arte no que diz respeito aos métodos de 

mitigação de golfadas em plataformas de petróleo. Aqui consta também uma breve 



 
    21 
 

 

revisão bibliográfica englobando os conceitos de Controle Adaptativo, de 

Observadores de Estado e Filtros de Kalman formando a base teórica que será 

utilizada na implementação dos controladores. 

No capítulo 4, é apresentado um modelo dinâmico simplificado encontrado na 

literatura que representa adequadamente o problema de golfadas severas através de 

sistemas poço-pipeline e poço-pipeline-riser.  

No capítulo 5, é exposto o desenvolvimento da metodologia de supressão de golfadas 

utilizando algoritmos de controle, tomando como base o modelo dinâmico simplificado 

apresentado no capítulo 4. 

No capítulo 6, são apresentadas as conclusões obtidas neste trabalho. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Os resultados parciais do presente trabalho foram apresentados em Ashikawa, F.H.; PARK, S.W. MITIGAÇÃO DE 
GOLFADAS NA PRODUÇÃO DE PETRÓLEO EM SISTEMAS OFFSHORE. In: XXI Congresso Brasileiro de 
Engenharia Química, 2016, Fortaleza, CE. XXI CIBEQ. São Paulo: ABEQ, 2016.  



 
    22 
 

 

2. REVISÃO BIBLIOGRÁFICA 

 

Os regimes de escoamento com golfadas severas ocorrem em sistemas formados por 

flowlines/risers que transportam uma mistura multifásica (óleo e gás) do leito marinho 

até a superfície (TAITEL, 1986). 

Este tipo de regime de escoamento é caracterizado por apresentar altas oscilações 

nas vazões e pressões. Este fluxo intermitente causa diversos problemas para os 

equipamentos da plataforma. Portanto, são necessários métodos efetivos para lidar 

com as mesmas e diversos estudos foram desenvolvidos para tentar prevenir estas 

ocorrências (HAVRE; DALSMO, 2002). 

A solução mais simples é a restrição manual da válvula choke de topside, porém, esta 

manobra reduz a vazão de produção, especialmente em campos em que a pressão 

de reservatório é relativamente baixa. Portanto, é desejável uma solução que 

estabilize o fluxo e garanta a maior produção possível. 

Na Figura 2-1, apresenta-se um esquemático genérico de um sistema de produção de 

petróleo offshore, com o intuito de facilitar o entendimento dos termos técnicos e 

equipamentos citados nos próximos capítulos: 

 

Figura 2-1 – Esquemático de um poço de petróleo offshore. 

 

 



 
    23 
 

 

2.1.  Escoamento em Golfadas 

 

O comportamento de um fluxo bifásico é muito mais complexo que um fluxo 

monofásico. O fluxo bifásico é constituído de um processo que envolve interações de 

diversas variáveis. As fases gás e líquido normalmente não fluem com a mesma 

velocidade no duto, devido as diferenças de densidade e viscosidade.  Em um fluxo 

ascendente, a fase gasosa, que é menos densa e menos viscosa, tende a fluir em 

uma maior velocidade que a fase líquida. Por outro lado, em fluxos sujeitos a 

inclinações descendentes, o líquido tende a fluir em uma maior velocidade que o gás 

(JAHANSHAHI, 2013). 

Embora existam soluções analíticas para fluxos monofásicos aplicados na indústria 

com resultados razoáveis, as predições para um fluxo multifásico, mesmo quando 

restritos a uma geometria simples são, em geral, de maior complexidade. 

A empresa Total foi uma das primeiras a utilizar um sistema de controle anti-golfadas. 

Esta aplicação ocorreu em um duto de 16 polegadas de diâmetro localizado no Mar 

do Norte e sujeito a um escoamento multifásico (COURBOT, 1996). O objetivo era 

controlar a pressão na base do riser, manipulando a abertura da válvula choke. Em 

2000, a ABB utilizou um controle similar para prevenir as golfadas entre as plataformas 

Hod e Valhall, também no Mar do Norte (HAVRE; STORNES; STRAY, 2000). 

A Figura 2-2 mostra alguns dos padrões de fluxo multifásico em dutos horizontais para 

diferentes velocidades de escoamento e a Figura 2-3 mostra os padrões de 

escoamento para dutos verticais (BILTOFT et al., 2013), (SIVERTSEN; E. 

STORKAAS; SKOGESTAD, 2010). 



 
    24 
 

 

 

Fonte: (JAHANSHAHI, 2013) 
Figura 2-2 – Padrões de fluxo multifásico em um duto horizontal para diferentes velocidades 

de escoamento. 

 

  

Fonte: (JAHANSHAHI, 2013) 
Figura 2-3 – Padrões de fluxo multifásico em um duto vertical para diferentes velocidades de 

escoamento. 
 



 
    25 
 

 

 

Na Figura 2-2 e na Figura 2-3, o escoamento em golfadas (slug flow) foi destacado. O 

mesmo é caracterizado por uma sequência de bolsões de líquido (slugs) seguidos de 

bolsões de gás. 

Algumas das causas para o escoamento em golfadas estão descritas abaixo: 

1. Golfadas hidrodinâmicas (Hydrodynamic slugs) – este tipo de golfada ocorre 

em dutos horizontais devido à diferença de velocidades das fases líquida e 

gasosa. Estas golfadas são caracterizadas por apresentarem alta frequência e 

menor amplitude na variação das pressões e vazões envolvidas.  

2. Golfada de riser (Riser slugging) ou golfada severa – este tipo de golfada é 

induzido pela presença de um riser vertical, geralmente associado a um trecho 

horizontal descendente a montante do riser associado também a uma condição 

de baixa vazão de escoamento. O líquido bloqueia o trecho inferior do riser, 

impedindo a entrada de gás no mesmo. Este bloqueio persiste até que a 

pressão a montante exceda a coluna hidrostática de líquido presente no riser. 

Este tipo de golfadas se caracteriza por ser constituído de grande volume de 

líquidos, causando também grandes variações de pressão na plataforma. 

(JAHANSHAHI, 2013). 

3. Golfadas induzidas pelo terreno (Terrain-induced slugging) – induzidas pela 

superfície irregular do leito marinho, fazendo com que o líquido tenha tendência 

de acumular nas posições do duto de menor elevação, causando bloqueio do 

fluxo de gás no duto de forma semelhante a golfada de riser, porém com menor 

intensidade.  

4. Golfadas causadas por manobras operacionais (Operational-based slugging) – 

Algumas manobras e operações no poço podem causar instabilidades, um 

exemplo é a golfada causada pela passagem de PIG (equipamento utilizado 

para limpeza ou inspeção interna de dutos), esta operação gera um grande 

distúrbio nas vazões do poço.  



 
    26 
 

 

5. Golfadas causadas pelo efeito de casing heading em poços de gas lift (Casing 

heading slugs) – este tipo de golfada é similar a golfada de riser, porém a 

pressurização do gás ocorre no anular do poço e não na base do riser.  

2.2.  Golfadas Severas 

 

A instabilidade causada pela golfada severa é um dos principais desafios de garantia 

de escoamento encontrados na produção offshore. A seguir é descrito em detalhes, o 

mecanismo de formação da golfada severa (riser slugging).  

A golfada severa se forma em sistemas com fluxo multifásico (gás e líquido) com 

vazão relativamente baixa de produção e/ou diâmetro de duto superdimensionado. 

(JANSEN; SHOHAM; TAITEL, 1996). Está geralmente associada a uma geometria de 

linha desfavorável a montante do riser (trecho horizontal descendente), ocasionando 

um bloqueio de líquido na base do riser, impedindo assim, a passagem do gás.  A 

Figura 2-4 mostra um esquemático de um sistema de produção sujeito ao bloqueio de 

líquido, e consequentemente ao fenômeno de golfada severa. 
 

 

Figura 2-4 – Esquemático de um sistema sujeito ao fenômeno de golfada severa. 

 

Este bloqueio causa um contínuo aumento da pressão a montante, até que a mesma 

seja suficiente para compensar a coluna hidrostática de líquido (JANSEN; SHOHAM; 

TAITEL, 1996). 

O mecanismo de formação deste tipo de golfada pode ser descrito resumidamente em 

quatro passos, que estão ilustrados na Figura 2-5. 



 
    27 
 

 

Passo 1: O líquido acumula no ponto mais baixo do riser. Este fato ocorre apenas em 

escoamentos em que as velocidades de líquido e gás são baixas o suficiente para 

permitir este acúmulo. 

Passo 2: Após a ocorrência do bloqueio, enquanto a coluna hidrostática de líquido for 

maior que a pressão do gás, a montante do bloqueio, ocorrerá um aumento contínuo 

desta pressão, causada pela compressão do gás produzido. 

Passo 3: Quando o gás consegue vencer a coluna hidrostática e atinge a base do 

riser, ocorre um deslocamento da golfada de forma violenta. Este evento é causado 

pela rápida expansão do gás e pela redução da coluna hidrostática a medida que o 

líquido chega ao separador. Este fenômeno tem potencial de causar grandes 

variações na planta de processamento (dificuldades na separação de óleo/água, 

distúrbios no sistema de compressão de gás) e até mesmo possíveis danos nos 

equipamentos. 

Passo 4: Após a expulsão de grande parte do líquido e do bolsão de gás, o sistema 

apresentará uma velocidade de escoamento tão baixa que parte do líquido voltará 

para a base do riser, reiniciando o ciclo. 

 

Fonte: (PICKERING et al., 2001) 
Figura 2-5 – Ciclo de formação de golfadas severas. 

 

  



 
    28 
 

 

2.3. Estabilização de Escoamento em Golfadas 

 

Através do uso de técnicas de controle, é possível alterar as fronteiras de transição 

entre os regimes de escoamento e consequentemente estabilizar o poço, sem alterar 

a geometria dos dutos ou as condições de contorno originais do sistema 

(JAHANSHAHI, 2013). 

Para avaliar o comportamento oscilatório de um sistema sujeito a golfadas, uma 

metodologia comumente empregada na literatura é a de levantar o diagrama de 

bifurcação. Tal diagrama ilustra o comportamento do sistema para todo o range de 

abertura da válvula choke. Na Figura 2-6, a linha contínua superior representa os 

valores máximos atingidos pela pressão de entrada e a linha inferior representa os 

valores mínimos desta pressão. Por último, a linha tracejada central representa a 

condição não oscilatória em regime permanente e a linha contínua central representa 

a pressão média entre os valores máximos e mínimos de pressão. Porém, sem um 

controle ativo, esta condição é instável (STORKAAS; SKOGESTAD, 2007). 

 
Figura 2-6 – Diagrama de bifurcação  

 

Para o exemplo acima, o valor de abertura da válvula choke que representa a 

transição entre o escoamento estável (não oscilatório) e o escoamento com golfadas 

é de aproximadamente 5%. É possível notar que, utilizando o controle ativo da válvula 



 
    29 
 

 

choke, a pressão média do sistema não oscilatório (linha tracejada central) é menor 

que o valor médio da pressão sem o controle da válvula (linha contínua central), sendo 

assim, operar na região instável, pode trazer ganhos de produtividade do poço através 

da menor contrapressão imposta ao reservatório (OGAZI et al., 2010). 

Vários sistemas de controle têm sido desenvolvidos com o intuito de amenizar os 

problemas gerados pela alimentação intermitente nos sistemas de produção offshore. 

Uma metodologia empregada é utilizar um controle supervisório com chaveamento de 

controladores PID para o modo com golfadas e o modo sem golfadas, através da 

medida ou da estimativa da pressão da base (PEDERSEN; DURDEVIC; YANG, 

2014). Em outra abordagem, utiliza-se de diferentes desempenhos de controladores 

PID para a válvula choke (CAMPOS et al., 2015). Demais aspectos de modelagem 

dinâmica voltada ao controle de golfadas são abordados em trabalhos de controle e 

observadores de estado (PEDERSEN; DURDEVIC; YANG, 2017), porém, o estado 

de arte não difere do que está descrito aqui no presente texto. 

Outros trabalhos adotaram uma estratégia de controle em cascata com realimentação 

baseada em medidas de pressão de fundo e na vazão no topo do riser para suprimir 

as golfadas (FARD; GODHAVN; SAGATUN, 2006). Outros adotaram um sistema de 

controle PID que mede a pressão na base do riser e manipula a válvula choke para 

evitar golfadas no riser (STORKAAS; SKOGESTAD, 2007). Porém, a maior 

desvantagem destes sistemas é que os mesmos se baseiam em pressões que não 

estão localizados na superfície, ou seja, estes sensores estão sujeitos a falhas e 

possuem manutenção complexa e dispendiosa. 

 

 

  



 
    30 
 

 

3. MATERIAIS E MÉTODOS 

3.1. Controle Adaptativo 

 
Um sistema de controle adaptativo é um sistema não linear ainda que tanto o modelo 

da planta quanto o controlador sejam sistemas lineares. Ou seja, a adaptação dos 

parâmetros em malha fechada faz com que o sistema resultante se torne não linear 

(SILVA, 2014). Este controle é particularmente interessante para sistemas cujos 

parâmetros da planta são desconhecidos ou variam com o tempo.  

Um sistema de controle adaptativo é gerado na tentativa de se controlar plantas com 

parâmetros desconhecidos através da variação automática dos parâmetros do 

controlador (NARENDRA; ANNASWAMY, 1989), (ASTOLFI; KARAGIANNIS; 

ORTEGA, 2010) como mostra a Figura 3-1. 

 

Fonte: (SILVA, 2014) 
 Figura 3-1 – Diagrama de blocos genérico de um controle adaptativo. 

 

A construção de um controlador adaptativo contempla (ÅSTRÖM; WITTENMARK, 

1995): 

? A característica da resposta em malha fechada para o sistema 

? Uma lei de controle com parâmetros ajustáveis 

? Um mecanismo para o ajuste destes parâmetros  

? A implementação da lei de controle  



 
    31 
 

 

 

Normalmente é necessário combinar técnicas de projeto de sistemas de controle com 

técnicas de estimação de parâmetros. Diversas estratégias de controle adaptativo são 

geradas através da combinação de cada uma das possíveis técnicas de estimação de 

parâmetros com cada uma das técnicas de projeto de controladores. Os esquemas 

de controladores adaptativos mais utilizados são (SILVA, 2014):  

? Escalonamento de Ganho (Gain Scheduling) 

? Controle Adaptativo por Modelo de Referência (Model Reference Adaptive 

Control) 

? Regulador Auto-Sintonizável (Self-Tuning Regulator) 

 

3.1.1. Controle Adaptativo com Escalonamento de Ganho 

 
O Escalonamento de Ganho consiste em ajustar os parâmetros do controlador 

utilizando uma variável correlacionada, conforme mostrado na Figura 3-2. 

Normalmente, varia-se os parâmetros do controlador de forma discreta dentro de um 

conjunto pré-definido de valores. A estratégia consiste em projetar controladores fixos 

para diferentes regiões de operação da planta e, em função das variáveis auxiliares, 

selecionar qual dos controladores é o mais adequado em um dado instante de tempo 

(LAGES, 2007). 

 
Fonte: (SILVA, 2014) 

 Figura 3-2 - Sistema de controle adaptativo por escalonamento de ganhos 

 
Para a utilização do escalonamento de ganho é necessário conhecer a dinâmica de 

variação da planta em função de poucas variáveis facilmente mensuráveis. Apesar de 



 
    32 
 

 

ser um método bastante utilizado, há diversas desvantagens como: necessidade de 

alto esforço computacional, caso o número de regiões de operação da planta seja 

elevado, visto que é necessário projetar-se um controlador para cada uma destas 

regiões. Outra desvantagem consiste no fato de o escalonamento de ganho ser um 

mecanismo de adaptação em malha aberta. Uma dificuldade adicional inerente a este 

método é a prova de estabilidade do controlador resultante. Mesmo que se possa 

provar a estabilidade para todos os controladores associados a cada uma das regiões 

de operação, não há garantias de que, ao se chavear entre eles, o sistema resultante 

continuará estável (SILVA, 2014). 

 

3.1.2. Controle Adaptativo por Modelo de Referência 

 
O modelo de referência representa a dinâmica desejada para planta como mostra a 

Figura 3-3. O objetivo deste método de controle adaptativo é fazer com que a diferença 

entre a saída da planta e a saída do modelo de referência seja nula (LAGES, 2007). 

 
Fonte: (SILVA, 2014) 

 Figura 3-3 – Controle adaptativo por modelo de referência 

 
Deve-se escolher o modelo de referência de forma a refletir as especificações de 

desempenho do sistema de controle, tais como: tempo de subida, tempo de 

acomodação, overshoot, etc. Porém, o modelo de referência deve apresentar 

comportamento possível de ser atingido pelo sistema de controle. Portanto, deve-se 

escolher um modelo de referência levando-se em conta as restrições em sua estrutura 

que são dependentes da estrutura do modelo de planta (SILVA, 2014). 



 
    33 
 

 

Utiliza-se um conjunto de parâmetros ajustáveis para parametrizar o controlador de 

forma a se obter a capacidade de rastreamento perfeito, logo, caso se conheça os 

parâmetros da planta, os parâmetros correspondentes do controlador devem ser tais 

que fazem a saída da planta convergir para a saída do modelo de referência. Para se 

provar a estabilidade e convergência, os métodos de controle adaptativo exigem que 

o controlador possa ser parametrizado linearmente, ou seja, que a lei de controle seja 

linear com relação aos seus parâmetros (LAGES, 2007). O problema é obter um 

mecanismo de ajuste dos parâmetros do controlador que faça com que o erro de saída 

? = ? ? ?? passe a convergir para zero. Nas primeiras versões do controlador, era 

utilizado um mecanismo de adaptação baseado no gradiente. Supondo que ?  seja o 

vetor de parâmetros do controlador, a ideia é reduzir ?2(?) através do ajuste de ?, de 

forma a causar a sua maior redução, ou seja: 

??

??
= ??

?

??
(?2(?)) = ?2??(?)

?

??
(?(?))  

3.1 

onde ? é uma constante positiva denominada ganho de adaptação. 

A variável ?(?) é o erro de saída obtido supondo-se que os parâmetros do controlador 

são ?. Como o gradiente de ?(?) é igual ao gradiente de ?(?), já que ?? é 

independente de ?, pode-se escrever: 

??

??
= ?2??(?)

?

??
(?(?))  

3.2 

 

A função de sensitividade 
??(?)

??
 usualmente depende dos parâmetros da planta, que 

são desconhecidos. Para resolver este problema foi proposta uma regra que consiste 

em utilizar as estimativas no instante t ao invés de parâmetros desconhecidos (SILVA, 

2014). Em geral não é possível obter-se os zeros  (SASTRY; BODSON, 1989) para 

os esquemas baseados nesta regra, no entanto quando o ganho de adaptação e a 

amplitude da entrada referência são pequenos, o esquema apresenta bom 

desempenho (MARRELS et al., 1986). 

A substituição da função de sensitividade 
??(?)

??
 por outras funções, permite que se 

obtenha a prova de estabilidade e propriedades de convergência através da teoria de 

Lyapunov  (NARENDRA; LIN; VALAVANI, 1980). 



 
    34 
 

 

 

3.1.3. Controle Adaptativo Auto-Sintonizado 

 
No controle adaptativo auto-sintonizado altera-se os parâmetros do controlador a cada 

mudança dos parâmetros da planta (ÅSTRÖM; WITTENMARK, 1989) como mostrado 

na  Figura 3-4. O controlador possui basicamente duas etapas: a estimação dos 

parâmetros e o projeto do controlador.  

 
Fonte: (SILVA, 2014) 

Figura 3-4 – Controle adaptativo auto-sintonizado 

 

? Estimação de parâmetros: Nesta etapa, realiza-se a identificação da planta, 

obtendo sua função de transferência, que posteriormente é utilizada no projeto 

do controlador. A estimação de parâmetros é realizada utilizando métodos de 

estimação recursivos, ou seja, a cada recursão os parâmetros são atualizados 

com base na última medição e nos valores anteriores. Há vários métodos para 

estimar on-line os parâmetros do controlador, tais como: aproximação 

estocástica, mínimos quadrados, mínimos quadrados estendido generalizados, 

variáveis instrumentais e máxima verossimilhança, sendo estes parâmetros 

atualizados e ajustados a cada período de amostragem para obter-se o controle 

desejado do sistema (SILVA, 2014). 

? Projeto do controlador: Nesta etapa calcula-se os parâmetros do controlador 

de forma a garantir um bom desempenho sem erro estacionário considerando 

um modelo de referência. O projeto é realizado em tempo real e a solução 

apresentada refere-se ao sistema cujos parâmetros foram estimados na etapa 



 
    35 
 

 

anterior. Existem diversos métodos numéricos para o projeto do controlador, 

tais como: mínima variância, linear quadrática, alocação de polos, modelo de 

referência e auto sintonizável (SILVA, 2014). 

Caso os parâmetros da planta sejam desconhecidos, substitui-se os parâmetros, 

pelas suas estimativas determinadas por algum estimador on-line de parâmetros. O 

controlador obtido combinando-se um esquema de identificação on-line de parâmetros 

com um controlador convencional, é denominado Self-Tuning Regulator (ÅSTRÖM; 

WITTENMARK, 1973). 

Tipicamente, desenvolve-se os controladores auto-sintonizados em tempo discreto. A 

cada instante de amostragem os parâmetros da planta ? são identificados com base 

nas entradas ? e saídas ? anteriores. Os parâmetros do controlador ? são 

determinados e o sinal de controle ?  é gerado. Nota-se que, nos controladores auto-

sintonizados, os parâmetros do controlador são determinados de forma a ajustar-se 

aos dados de entrada e saída da planta, enquanto nos controladores por modelo de 

referência, os parâmetros são ajustados de forma a fazer o erro de trajetória convergir 

para zero. Pode ser mostrado  (ÅSTRÖM; WITTENMARK, 1989), que a abordagem 

dos controladores por modelo de referência é um caso particular do controladores 

auto-sintonizados, utilizando-se de uma parametrização adequada. 

É mais complexo garantir a estabilidade e a convergência de um controlador auto-

sintonizado que no controlador por modelo de referência, que normalmente exige 

suposição sobre as propriedades dos sinais envolvidos. Os controladores auto-

sintonizados são obtidos combinando-se uma técnica de estimação de parâmetros 

com uma técnica de controle. As técnicas de controle mais utilizadas são: Variância 

Mínima, Variância Mínima Generalizada, Controle Preditivo Generalizado, Alocação 

de polos e controle Linear Quadrático Gaussiano. Para possibilitar a implementação 

do controlador em tempo real, utilizam-se técnicas de estimação dos parâmetros 

recursivas, principalmente: Mínimos Quadrados Recursivo e Mínimos Quadrados 

Estendido (SILVA, 2014). 

  



 
    36 
 

 

3.2. Regulador Linear Quadrático (LQR) 

 
O regulador linear quadrático (LQR) é um controlador ótimo que foi amplamente 

difundido na literatura em diversas aplicações (SUN; GAN, 2010) e (UYGUN; 

MATTHEW; HUANG, 2006). O regulador linear quadrático possui características 

excelentes de desempenho e é de simples implementação. Este tipo de estratégia de 

controle inclui a realimentação dos estados, que são ponderados de forma a minimizar 

uma função custo (BURNS, 2001).  

No controle utilizando regulador linear quadrático, assume-se que a dinâmica da 

planta é linear e conhecida.  

??+1 = ???? + ???? 

?? = ???? 

3.3 

 

Dado um sistema da Equação 3.3 com um estado inicial ?(0), encontra-se o sinal de 

entrada ótimo ??, que leva o sistema para o estado zero ? = 0 de maneira ótima, 

através da minimização da função custo: 

? =
1

2
? ??

??
?=0 ??? + ??

????  3.4 

Isto requer que o par (??, ??) seja estabilizável, ou seja, que seus estados possam 

ser transferidos para a origem de qualquer estado inicial em um tempo infinito (SYRE, 

2012). ? e ? são matrizes simétricas positivas definidas para os estados ? e a entrada 

? respectivamente. O objetivo é minimizar a função custo, então se ? é alto, utilizar a 

entrada ? será caro e fornececerá uma resposta lenta. Tendo um alto valor no primeiro 

elemento de ? comparada aos outros elementos da diagonal, o controlador irá 

priorizar o primeiro estado. Adicionalmente, se ? é muito maior que ?, obtém-se uma 

resposta rápida. O ótimo entre ? e ? muitas vezes é encontrado por tentativa e erro. 

A solução ótima é ?? = ???????, onde: 

???? = ?
?1??

?
?   3.5 

 

E ? é a solução definida simétrica positiva da equação de Riccatti.  

  ??
?
? + ??? ? ????

?1??
?
? + ? = 0 



 
    37 
 

 

É possível estabelecer um compromisso entre a amplitude das variáveis de estado, a 

velocidade de resposta do sistema e a amplitude do sinal de controle, através da 

escolha adequada dos índices de desempenho relativos a estas variáveis. Porém, a 

utilização deste tipo de estratégia de controle é comprometida na presença de 

distúrbios e/ou quando há variações paramétricas no sistema a ser controlado. Isto 

ocorre pois a lei de controle depende diretamente dos estados da planta, ou seja, caso 

existam dinâmicas não consideradas, a ação de controle é prejudicada por não conter 

todas as informações referentes ao sistema (KANIESKI, 2010).  

 

3.3. Observadores de Estado 

 

Em projetos de sistemas de controle considera-se que todas as variáveis de estado 

sejam acessíveis para medição, porém, na prática isto pode não ser verdade. Logo, é 

necessário estimar estas variáveis não mensuráveis ou não medidas. Este processo 

de estimação das variáveis de estado é comumente chamado de observação. Quando 

um observador de estado estima todas as variáveis de estado do sistema, mesmo que 

algumas delas sejam mensuráveis, é denominado observador de ordem plena. Se 

apenas algumas das variáveis de estado do sistema são acessíveis, pode-se 

desenvolver um observador de estado que estima somente aquelas inacessíveis para 

medição. Neste caso o observador é denominado observador de estado de ordem 

reduzida ou observador de estado de ordem mínima (OLIVEIRA, 2014), sendo a 

planta definida por: 

??? = ?? + ??   3.6 

? = ??  3.7 

  

Nestas equações 3.6 e 3.7, por exemplo, ? é o vetor de estado de dimensão ?, i.e., 

(? ? ??), ? é o vetor de controle de dimensão ?, i.e., (? ? ??), ? é o vetor de resposta 

ou saída de dimensão ?, i.e., (? ? ??), ? é a matriz ?×? de estado (? ? ??×?), ? é a 

matriz ?×? de controle ou entrada (? ? ??× ?), e ? é a matriz ?×? de saída ou de 

observação (? ? ??×?). Por concisão, são omitidas as especificações das dimensões 

das matrizes quando não houver necessidade. 



 
    38 
 

 

O modelo matemático é o mesmo da planta, exceto por incorporar um termo adicional 

que compensa as incertezas nas matrizes A e B e a ausência do erro inicial visto que 

o observador é um subsistema reconstrutor do vetor de estado da planta. O erro de 

estimação ou erro de observação pode ser definidos pela diferença entre a saída 

medida e a saída estimada. O erro inicial é a diferença entre o estado inicial e o estado 

inicial estimado (OLIVEIRA, 2014). Logo, define-se o modelo matemático de um 

observador como: 

???? = ???? + ?? + ??(? ? ????) = (? ? ???)??? + ?? + ??? 3.8 

Onde ??? é o estado estimado e ???? é a saída estimada. As entradas do observador são 

a saída ? e a entrada ?. A matriz ?? é denominada matriz de ganho do observador 

que atua como um termo de correção que envolve a diferença entre a saída medida 

? e a saída estimada ????. Esse termo corrige continuamente a saída do modelo e 

aumenta o desempenho do observador. A Figura 3-5 mostra o diagrama de blocos do 

sistema e do observador de estado de ordem plena. 

 
Fonte: (OLIVEIRA, 2014) 

 Figura 3-5 – Observador de estado de ordem plena 

 

 

3.3.1. Observador de Estado de Ordem Plena  

 
Conforme citado anteriormente, o observador de ordem plena consiste em um 

observador com a mesma ordem da planta, mesmo que todos seus estados sejam 

mensuráveis.  



 
    39 
 

 

Supondo que a planta seja definida pelas equações 3.6 e 3.7, tem-se que para 

encontrar o erro de observação, subtrai-se a equação 3.8 a partir da equação 3.6 : 

??? ?  ???? = ?? ? ???? ? ??(?? ? ????) = (? ? ???)(? ? ???)   3.9 

Definindo o vetor de erro como ? = ? ? ???, a Equação 3.9 se torna: 

??? = (? ? ???)?        3.10 

Nota-se na Equação 3.10, que o comportamento dinâmico do vetor de erro é 

determinado pelos autovalores da matriz (? ? ???). Se a matriz (? ? ???) for uma 

matriz estável, o vetor de erro convergirá para zero, qualquer que seja o vetor de erro 

inicial ?(0). Ou seja, ???(?) convergirá para ?(?) independentemente do valor de ?(0) e  

???(0). Se os autovalores da matriz (? ? ???) forem escolhidos de tal maneira que o 

comportamento do vetor de erro seja assintoticamente estável e adequadamente 

rápido, então qualquer vetor de erro tenderá a zero com uma velocidade adequada.  

Se a planta for completamente observável, é possível escolher a matriz ?? tal que 

(? ? ???) tenha seus autovalores escolhidos arbitrariamente. Para tanto, é preciso 

verificar a condição necessária e suficiente para observação de estado. Ou seja, 

verifica-se que o posto da matriz abaixo seja n:  

[

??

????

?
????

??1

]     

3.11 

 

A condição de observabilidade completa do sistema original é definida pelas 

Equações 3.6 e 3.7. Uma vez selecionado os autovalores desejados, o observador de 

estado de ordem plena poderá ser projetado, desde que a planta seja completamente 

observável. Os autovalores desejados da equação característica devem ser 

escolhidos de modo que o observador responda, pelos menos, duas a cinco vezes 

mais rápido que o sistema em malha fechada considerado. O processo de projeto, 

portanto, passa a ter dois estágios, sendo o primeiro a determinação da matriz K de 

realimentação, que produzirá a equação característica desejada, e o segundo consiste 

na determinação da matriz de ganho do observador que produzirá a equação do 

observador desejada (OLIVEIRA, 2014). A Figura 3-6 apresenta o diagrama de blocos 

de um sistema de controle realimentado por estado observado. 



 
    40 
 

 

 
Fonte: (OLIVEIRA, 2014) 

 Figura 3-6 – Sistema de controle realimentado por estado observado 

 

Considerando um sistema completamente controlável e observável, tem-se a lei de 

controle baseado no estado observado ???: 

? = ?????   3.12 

Que produz a equação de estado: 

??? = ?? ? ????? = (? ? ??)? + ??(? ? ???) 3.13 

Como o erro ?(?) é dado por ?(?) ? ???(?), reescreve-se a equação 3.13 como: 

??? = (? ? ??)? + ???     3.14 

 

Combinando a equação 3.10 do erro do observador com a equação 3.14, tem-se:  

[
???
???
] = [

? ? ?? ??
0 ? ? ???

] [
?
?
]        

3.15 

 

A equação 3.15 descreve as dinâmicas do sistema de controle realimentado por 

estado observado. A equação característica desse sistema é: 

[
?? ? ? + ?? ???

0 ?? ? ? + ???
] = 0        

3.16 

ou 

|?? ? ? + ??||?? ? ? + ???| = 0               3.17 

  



 
    41 
 

 

Os polos de malha fechada do sistema de controle realimentado por estado observado 

consistem nos polos do projeto por alocação de polos e nos polos do projeto isolado 

do observador. Ou seja, o projeto da alocação de polos e o projeto do observador são 

independentes entre si. Eles podem ser conduzidos separadamente e combinados 

para formar o sistema de controle realimentado por estado observado (OLIVEIRA, 

2014). 

Supondo que a planta seja completamente observável, ao se aplicar uma lei de 

controle por realimentação de estado observado, tem-se que as equações do 

observador serão dadas por: 

???? = (? ? ??? ? ??)??? + ???      3.18 

 ? = ?????                   3.19 

 

Supondo uma condição inicial nula e resolvendo a transformada de Laplace para ???(?) 

da Equação 3.18, tem-se: 

???(?) = (?? ? ? + ??? + ??)
?1???(?)       3.20 

Substituindo ???(?) na Equação 3.19 e resolvendo a transformada de Laplace, obtém-

se a seguinte função de transferência: 

?(?) = ??(?? ? ? + ??? + ??)
?1???(?)      3.21 

?(?)

?(?)
= ??(?? ? ? + ??? + ??)

?1??       
3.22 

 

A Figura 3-7 mostra a representação em diagramas de blocos do sistema. Nota-se 

que a função de transferência ?(?? ? ? + ??? + ??)
?1?? atua como controlador do 

sistema. Por isso, denomina-se esta função de transferência como função de 

transferência do controlador-observador. 

 



 
    42 
 

 

 
Fonte: (OLIVEIRA, 2014) 

 Figura 3-7 – Diagrama de blocos do sistema com controlador-observador 

 

A matriz do controlador-observador ? ? ??? ? ?? pode ser estável ou não, embora 

? ? ?? e ? ? ??? sejam escolhidas para serem estáveis. 

 
3.3.2. Observador de Ordem Reduzida 

 
Algumas variáveis de estado podem ser medidas com exatidão, logo, não necessitam 

ser estimadas ou observadas. Suponha que um vetor de estado ? seja um vetor de 

dimensão ? e que a saída seja um vetor ? de dimensão ? que pode ser medido. Como 

as variáveis ? de saída são combinações lineares das variáveis de estado, então ? 

variáveis de estado não precisam ser estimadas. É necessário estimar apenas ? ? ? 

variáveis de estado. Então, um observador de ordem reduzida se torna um observador 

de ordem (? ? ?), que também pode ser denominado como um observador de ordem 

mínima (OLIVEIRA, 2014). A Figura 3-8 mostra um diagrama de blocos de um sistema 

com um observador de ordem mínima.  

 
Fonte: (OLIVEIRA, 2014) 

 Figura 3-8 – Sistema de controle realimentado por estado observado de ordem mínima 

 



 
    43 
 

 

A ideia básica do observador de ordem mínima, é que a saída que pode ser medida 

seja um escalar (ou seja ? = 1). Considera-se então, o sistema como descrito pelas 

Equações 3.6 e 3.7, onde o vetor ? é particionado em duas partes: ?? (escalar) que é 

igual a saída ? e, portanto, pode ser medida diretamente e ?? (vetor com dimensão 

? ? 1), que é a porção não medida do vetor de estado. Desse modo, a equação de 

estado particionada e a de saída resultam em: 

[
??
?
?

????
] = [

??? ? ???
? ? ?
??? ? ???

] [

??
?
??

] + [
??
?
??

] ?    
3.23 

? = [1 ? 0] [

??
?
??

]           
3.24 

onde ??? é um escalar, Aab é uma matriz 1×(? ? 1), Aba é uma matriz (? ? 1)×1, Abb 

é uma matriz (? ? 1)×(? ? 1) , Ba é uma matriz ?× ?, e Bb é uma matriz (? ? 1)× ? . 

A partir da Equação 3.23, pode-se retirar a equação da porção mensurável do estado 

que resulta em: 

???? = ????? + ????? + ???       3.25 

ou 

???? ? ????? ? ??? = ?????    3.26 

 

As equações 3.25 e 3.26 agem como equações de saída. Considera-se o lado 

esquerdo das equações 3.25 e 3.26 como quantidades conhecidas para o projeto de 

observadores de ordem mínima. Da mesma forma, a partir da equação 3.23, pode-se 

retirar a equação não mensurável do estado que resulta em: 

???? = ????? + ????? + ???      3.27 

 

Como as quantidades ????? e ??? são conhecidas, a Equação 3.27 descreve as 

dinâmicas da porção não mensurável do estado.  

É possível comparar a equação de estado do observador de ordem plena obtido a 

partir de ??? = ?? + ??, com a equação de estado do observador de ordem mínima 

dada pela Equação 3.27. Da mesma forma, é possível comparar as equações de saída 



 
    44 
 

 

do observador de ordem plena dada por  ? = ?? com a equação de saída do 

observador de ordem mínima dada pelas Equações 3.25 e 3.26. 

O projeto de observadores de ordem mínima pode ser construído a partir do 

observador de ordem plena substituindo as quantidades de ? = ????? , pelas 

quantidades apresentadas nas equações 3.25, 3.26 e 3.27, associando cada 

quantidade com o valor comparado para ordem plena. A Tabela 1 lista as substituições 

necessárias para escrever a equação do observador de ordem mínima. 

Tabela 1 – Substituições para a equação do observador de ordem reduzida  

Observador de estado de 

ordem plena 

Observador de estado de 

ordem mínima 

??? ???? 

? ??? 

?? ????? + ??? 

? ???? ? ????? ? ??? 

? ??? 

??(matriz n x 1) ??(matriz (n ? 1)x 1) 

Fonte: (OLIVEIRA, 2014) 

 

Fazendo as substituições necessárias, constrói-se a equação do observador de ordem 

mínima como segue: 

????? = (??? ? ?????)???? + ????? + ??? + ??(???? ? ????? ? ???)  3.28 

onde a matriz ?? do observador de estado é uma matriz (? ? 1)×1. 

Na Equação 3.28, observa-se que para estimar ??, é necessário diferenciar ??, o que 

representa uma dificuldade, pois a diferenciação amplifica ruídos. Portanto, 

analisando as equações 3.25 e 3.26, pode-se reescrever a equação do observador de 

ordem mínima como: 

????? = (??? ? ?????)???? + ????? + ??? + ???????  3.29 

 



 
    45 
 

 

Em seguida, obtém-se a equação do erro do observador de ordem mínima. Então, 

subtraindo a Equação 3.29 da Equação 3.27, tem-se: 

???? ? ????? = (??? ? ?????)(?? ? ????) 3.30 

Por definição, tem-se que  ? = ?? ? ????, o que transforma a Equação 3.30 em: 

??? = (??? ? ?????)?      3.31 

 

A partir da Equação 3.31, pode-se obter as dinâmicas de erro seguindo a mesma 

técnica desenvolvida para o observador de ordem plena. Para isso, tem-se que o 

posto seja (? ? 1) na seguinte matriz: 

[

???
??????

?
??????

??2

] 3.32 

 

Esta é a condição de observabilidade completa aplicada ao observador de ordem 

mínima. A equação característica do observador de ordem mínima é obtida a partir da 

Equação 3.31, como segue: 

|?? ? ??? + ?????| = (? ? ?1)(? ? ?2) ? (? ? ???1) = ?
??1 + ???1?

??2 + ? +

?????2? + ?????1 = 0            
3.33 

onde ?1, ?2, ? , ???1 são os autovalores desejados do observador de ordem mínima. A 

matriz de ganho ?? do observador pode ser determinada escolhendo-se primeiro os 

autovalores desejados do observador de ordem mínima e utilizando-se do 

procedimento já desenvolvido para o observador de ordem plena com as modificações 

apropriadas. 

Para o sistema de controle realimentado por estado observado com observador de 

ordem plena, tem-se que os polos de malha fechada consistem nos polos devido ao 

projeto isolado da alocação de polos e dos polos devidos ao projeto isolado do 

observador. Para o caso do sistema de controle realimentado por estado observado 

com observador de ordem mínima, a mesma conclusão se aplica. Portanto, a equação 

característica pode ser obtida como: 

|?? ? ? + ??||?? ? ??? + ?????| = 0      3.34 

 



 
    46 
 

 

Os polos de malha fechada do sistema de controle realimentado por estado observado 

com um observador de ordem mínima compreendem os polos de malha fechada da 

alocação de polos, ou seja, autovalores da matriz (? ? ??), e os polos de malha 

fechada devido ao observador de ordem mínima, ou seja, autovalores da matriz (??? ?

?????). Portanto, o projeto da alocação de polos e o projeto do observador de estado 

de ordem mínima são independentes entre si. 

 

3.4. Filtro de Kalman 

 
3.4.1. Filtro de Kalman Estendido (EKF) 

 
Em alguns casos, as saídas do sistema são corrompidas por sinais de ruído causados 

por motivos diversos (por ex. ruídos elétricos gerados por transientes de energia ou 

ruídos captados pelo sistema de cabeamento). Portanto, pode ser impossível 

determinar com certeza os valores dos sinais no sistema em um dado momento. Para 

contornar este problema, será utilizado o filtro de Kalman, para tanto será necessário 

conhecer dados estatísticos presentes nos sinais de ruído (DUTTON; THOMPSON; 

BARRACLOUGH, 1997). 

Atualmente, o Filtro de Kalman é uma das ferramentas de estimativa mais utilizadas 

na estimativa de estados de um sistema dinâmico na presença de ruído. É possível 

estimar os valores reais das medições e os seus valores calculados, atribuindo um 

peso maior para o valor com o menor grau de incerteza (THRUN; BURGARD; FOX, 

2005). A Figura 3-9 mostra a estrutura geral do Filtro de Kalman, bem como as etapas 

de predição e correção.  

O Filtro de Kalman possui muitas aplicações na tecnologia (AUGER et al., 2013) e 

algumas extensões e generalizações do método são mostradas através da versão 

estendida (EKF) e Unscented (UKF, do inglês Unscented Kalman Filter) (CRUZ, 

2013), (GREWAL; ANDREWS, 2008).  



 
    47 
 

 

 
Fonte: (CRUZ, 2013) 

Figura 3-9 – Estrutura geral do filtro de Kalman 

 
O Filtro de Kalman tem excelente desempenho na estimativa de estados em sistemas 

lineares, porém sua aplicação é complexa em sistemas reais não lineares. O filtro de 

Kalman Estendido supera essa limitação (CRUZ, 2013). 

Considera-se um sistema não linear dado por: 

??+1 = ?(??, ??, ??)      3.35 

??+1 = ?(??+1) + ??+1   3.36 

onde ?() é uma função não linear do sistema do processo e ?() uma função não linear 

do sistema de medição. Ambas as funções podem ser usadas para propagar o vetor 

de estados ??+1 e o vetor de saída ??+1. As variáveis ??, ?? e ??+1 estão relacionadas 

ao controle, ao ruído do processo e ao ruído de medição respectivamente (CRUZ, 

2013). 

O filtro de Kalman Estendido fornece uma aproximação do valor verdadeiro, 

representando essa aproximação por uma função gaussiana (THRUN; BURGARD; 

FOX, 2005), (GREWAL; ANDREWS, 2008). 

Se ?() é uma função não linear, a projeção da função gaussiana através desta função 

é tipicamente uma função não gaussiana. Portanto é necessário aproximar a função 

?() por uma função linear tangente a ?() na média da função gaussiana, de forma que 

esta distorção não ocorra (CRUZ, 2013). 

Uma vez que ?() é linearizada, a mecânica de propagação da esperança é 

equivalente à do filtro de Kalman. Da mesma forma, é necessário obter uma função 



 
    48 
 

 

linear tangente a função de medição de ?(), mantendo assim a natureza gaussiana 

da esperança posterior (THRUN; BURGARD; FOX, 2005). 

O Filtro de Kalman Estendido utiliza a Expansão de Taylor (primeira ordem) como 

método de linearização. A expansão de Taylor constrói uma aproximação linear da 

função ?() a partir de seu valor e inclinação conforme mostrado na Equação 3.37: 

??(??, ??+1) =
??(??, ??+1)

???
 

3.37 

 

O Filtro de Kalman Estendido utiliza as linearizações de ?() e ?() em relação às 

variáveis de estado e ao ruído do processo, sendo denominadas pelas matrizes 

Jacobianas das equações 3.38, 3.39 e 3.40. 

? = ??(?) =

[
 
 
 
 
 
??1

??1

??1

??2
?

??1

???
??2

??1

??2

??2
?

??2

???

? ? ? ?
???

??1

???

??2
?

???

???]
 
 
 
 
 

  3.38 

? = ??(?) =

[
 
 
 
 
 
??1

??1

??1

??2
?

??1

???
??2

??1

??2

??2
?

??2

???

? ? ? ?
???

??1

???

??2
?

???

???]
 
 
 
 
 

      3.39 

? = ??(?) =

[
 
 
 
 
 
??1

??1

??1

??2
?

??1

???
??2

??1

??2

??2
?

??2

???

? ? ? ?
???

??1

???

??2
?

???

???]
 
 
 
 
 

      3.40 

 

As matrizes Jacobianas ? e ? não são constantes. Porém, caso as mesmas sejam 

avaliadas em um valor específico do vetor de estados ? = ?0, as matrizes Jacobianas 

correspondentes tornam-se constantes. Logo, a etapa da predição é dada pelas 

Equações 3.41 e 3.42 e a etapa da correção é dada pelas equações 3.43, 3.44 e 3.45 

(CRUZ, 2013). 

 



 
    49 
 

 

Predição: 

????
? = ?(?????1

+ , ???1)       3.41 

??
? = ????1

+ ?? + ????1?
?       3.42 

 

Correção: 

?? = ??
???[???

??? + ??]
?1       3.43 

????
+ = ????

? + ??[?? ? ?(????
?)] 3.44 

??
+ = ??

? ? ?????
?       3.45 

 

 

3.4.2. Filtro de Kalman Unscented (UKF) 

 

O filtro de Kalman (KF) é um dos métodos mais utilizados para estimar variáveis de 

estado devido a sua simplicidade e robustez. Porém, a aplicação do filtro de Kalman 

a sistemas não lineares pode ser complexa. A abordagem mais comum é utilizar o 

filtro de Kalman Estendido (EKF), que basicamente lineariza todos os modelos não 

lineares para que o filtro de Kalman tradicional possa ser aplicado. Conforme 

mostrado na seção 3.4.1. Embora seja largamente utilizado, existe um consenso de 

que a implementação do filtro de Kalman Estendido não é simples, pois a linearização 

pode produzir filtros altamente instáveis, se a hipótese de linearidade local for violada; 

adicionalmente a derivação de matrizes Jacobianas não são triviais na maioria das 

aplicações e frequentemente levam a dificuldades significativas de implementação 

(ST-PIERRE; GINGRAS, 2004). 

O Filtro de Kalman Unscented foi proposto com o objetivo de superar os problemas 

verificados com a utilização do Filtro de Kalman Estendido, possibilitando a obtenção 

de um estimador com performance equivalente ao filtro de Kalman para sistemas 

lineares e que representa adequadamente um sistema não linear, porém sem a 

necessidade dos passos de linearização descritos pelo filtro de Kalman Estendido  

(JULIER; UHLMANN, 1997).  



 
    50 
 

 

Posteriormente, foram propostas algumas modificações para o Filtro de Kalman 

Unscented com o objetivo de adaptá-lo ao tipo de aplicação (WAN; MERWE; 

NELSON, 2000).  

O Filtro de Kalman Unscented é capaz de realizar estimação de estados em sistemas 

que contêm não-linearidades, sem a necessidade de se linearizar as funções 

presentes no modelo (JULIER; UHLMANN, 2004). 

A transformação Unscented consiste em se utilizar um conjunto finito de vetores que, 

ao sofrerem uma transformação não-linear, apresentam média amostral e covariância 

amostral idênticas às calculadas para o novo conjunto de vetores transformados, 

supondo uma transformação de 2ª ordem  (JULIER; UHLMANN, 1997). A Figura 3-10 

mostra como se dá a transformação Unscented. 

 

Fonte: (JULIER; UHLMANN, 1997) 
Figura 3-10 – Princípio do filtro de Kalman Unscented 

 

Uma variável aleatória ?, de dimensão ?, possui média e covariância dadas por ??? e ?. 

Deseja-se calcular a média ??? e a covariância ??? de uma variável aleatória ?, de 

dimensão ?, sendo que ? está relacionada a ? por meio de uma função não-linear ?: 

? = ?(?)         3.46 
 

É mais simples aproximar uma distribuição gaussiana do que linearizar uma função 

não-linear arbitrária (JULIER; UHLMANN, 1997). Para que uma função de densidade 

de probabilidade gaussiana possa ser completamente descrita, são necessárias a 

média e a covariância. Portanto, o objetivo é encontrar alguma parametrização que 



 
    51 
 

 

permita a propagação direta da informação por meio das equações não-lineares 

através da captura da média e da covariância. (JUNIOR, 2003). 

É possível obter a parametrização desejada, através da geração de um conjunto de 

vetores a partir das linhas ou colunas das matrizes ±???, ou seja, das matrizes 

compostas pela raiz quadrada positiva e negativa da matriz de covariância ? 

multiplicada pela dimensão do vetor de variáveis aleatórias ?. Este conjunto de vetores 

é dado pela matriz ? ? 2?; 

? = [??? ????]        3.47 

 

Devido à maneira como é construído, este conjunto de vetores possui covariância 

amostral igual a ? e média amostral zero. Cada vetor é conhecido na literatura como 

Ponto Sigma (SP) logo, o Filtro de Kalman Unscented é conhecido também como 

Sigma Points Kalman Filter (SPKF) (MERWE; WAN, 2001).  

Para que o novo conjunto de vetores formado possua a mesma média dos vetores ? 

originais, adiciona-se a média ??? à cada coluna da matriz ?. Como o novo conjunto é 

simétrico, seus movimentos centrais impares são nulos, fazendo com que os três 

primeiros momentos sejam iguais aos da distribuição original (JUNIOR, 2003). 

É possível ainda adicionar um fator de escala ? no cálculo da raiz quadrada da matriz 

de covariância, sem que o resultado da nova covariância se altere. 

O novo conjunto de vetores é gerado da seguinte maneira: 

? = [?(? + ?)? ??(? + ?)?]       3.48 

?(0) = ???        3.49 

?(?) = ??? + ?(?)        3.50 

Sendo ?(?)a iésima coluna da matriz ?. Desta forma ? varia de 1 a 2?. 

A nova matriz de covariância é dada por: 

? =
1

2(?+?)
? (?(?) ?2??=1 ???)(?

(?) ? ???)?       3.51 



 
    52 
 

 

Desenvolvendo-se a equação acima, é possível verificar que a covariância de ? é 

igual à covariância original ?. A transformação Unscented pode ser efetuada 

seguindo-se o procedimento abaixo (JULIER; UHLMANN, 1996). 

Cálculo dos pontos sigmas e novo conjunto de vetores ?: 

?(0) = ??? 3.52 

          

?(?) = ??? + ?(?)    3.53 

       

Cálculo dos pesos ?: 

?(0) =
?

?+?
        3.54 

?(?) =
1

2(?+?)
        3.55 

 

Cada novo vetor gerado ?(?) é propagado usando-se a função não-linear ?, formando 

um conjunto de pontos sigmas: 

?(?) = ?(?(?))        3.56 

 

A nova média é dada por: 

??? = ? ?(?)?(?)2??=0      3.57 

 

A covariância do conjunto de vetores transformado ?(?) é: 

??? = ? ?(?)(?(?) ? ???

2?

?=0

)(?(?) ? ???)? 
3.58 

    

Observando-se as equações 3.52 e 3.53, verifica-se que o número de pontos sigma 

(???) é dado por: 

??? = 2? + 1        3.59 

 

É importante notar que as estimativas das equações 3.57 e 3.58 são exatas somente 

para transformações até a 2ª ordem (JULIER; UHLMANN, 1996). 

  



 
    53 
 

 

Algoritmo do Filtro de Kalman Unscented 

Passo de predição: 

?????1 = [?????1 ? ?????1] + ?? [????1 ?????1]      3.60 

???? = ?(?????1, ???1)        3.61 

????? = ??????        3.62 

??? = ??????[????]
? + ???1       3.63 

Passo de atualização: 

???? = [???? ? ????] + ?? [??? ????]      3.64 

?? = ?(????)        3.65 

?? = ?
?

???        3.66 

?? = ?
?

???[?
?

?]
? + ??       3.67 

?? = ????
?
??[?

?
?]

?        3.68 

 

Passo para computar o ganho do filtro ??, atualizar a média ????e a covariância ??: 

?? = ????
?1

        3.69 

???? = ???
?

? + ??[?? ? ??]        3.70 

?? = ?
?

? + ??????
?
        3.71 

 
 

3.5. Simulador OLGA® 

 

O simulador computacional OLGA® (Oil-liquid-Gas Analyser) é um simulador numérico 

unidimensional de escoamento multifásico em dutos e instalações de produções 

dedicado à indústria de óleo e gás. O software utiliza três equações de continuidade 

(uma para o gás, uma para o líquido e outra para as gotículas de líquido), duas 

equações de quantidade de movimento (uma para a fase gás incluindo a fase dispersa 

e uma para a fase líquida) e 1 equação de energia para a mistura, considerando que 

todas as fases estão na mesma temperatura (SCHLUMBERGER, 2014).  

A solução é dada utilizando-se o método de volumes finitos com integração semi-

implícita no tempo, que é o esquema mais adequado para o escoamento multifásico 

transiente (passos relativamente longos). As propriedades dos fluidos são 

determinadas utilizando o software PVTsim, que calcula estas propriedades baseado 



 
    54 
 

 

nos componentes do óleo e sua quantidade. Este software é capaz de reproduzir o 

comportamento da golfada em diversos sistemas, incluindo poços sujeitos a golfadas 

do tipo casing-heading, assim como a maioria das linhas sujeitas a golfadas severas  

(SCHLUMBERGER, 2014).  

O OLGA® é considerado a ferramenta padrão para simulações multifásicas (BURKE; 

KASHOU, 1995), com aplicações especialmente voltadas ao estudo de golfadas 

(LAWRENCE et al., 2015), sendo que o mesmo é utilizado com frequência nos 

estudos comparativos pelo fato de representar bem o sistema real e pelo seu foco em 

simulações de sistemas com comportamento transiente (MEGLIO, 2011). 

A modelagem matemática utilizada no software OLGA® é mostrada de forma 

detalhada abaixo (BENDIKSEN et al., 1991). 

 

3.5.1. Modelo Matemático do OLGA®  

 

De forma a simplificar o modelo e a constituição da equação geral da conservação, 

foram consideradas as seguintes características do escoamento:  

? Duto de seção transversal circular de diâmetro constante ?? e inclinado de um ângulo 
?;  

? Unidimensional (1D) com duas fases, gás e líquido, independentes uma da outra;  

? Predominância da fase gás na seção do duto;  

? Sem transferência de energia entre as fases;  

? Regime transiente;  

? Padrão de escoamento estratificado;   

 

A Figura 3-11 e a Figura 3-12 abaixo, caracterizam a seção transversal e o perfil de 

escoamento estratificado do duto. 



 
    55 
 

 

  

Fonte: (SALES, 2013) 
 Figura 3-11 – Seção transversal do escoamento. 

  

Fonte: (SALES, 2013) 
Figura 3-12 – Perfil lateral de escoamento estratificado. 

 

onde ?? é a área da seção transversal ocupada pelo gás; ?? é a área da seção 

transversal ocupada pelo líquido; ?? é a superfície da interface; ?? é a altura ocupada 

pelo líquido; ?? é o diâmetro interno; ?? é o volume ocupado pelo gás; ?? é o volume 

ocupado pelo líquido; ?? é o atrito do gás na parede; ?? é o atrito do líquido na parede; 

? é a inclinação do tubo em relação a um plano horizontal; e ?? é o atrito na interface.  

 

3.5.2. Formulação Matemática  

 

As equações do modelo de dois fluidos têm sido muito utilizadas na resolução de 

escoamentos bifásicos em tubulações, particularmente na indústria de petróleo, tendo 

sido incorporado nos códigos comerciais do OLGA® (BENDIKSEN et al., 1991).  

Para os modelos físicos, as equações de continuidade separadas são aplicadas para 

o gás, para o líquido e para gotículas de líquido, que podem ser acopladas através de 

transferência de massa interfacial. Esse modelo faz uso das seguintes equações de 

conservação:  



 
    56 
 

 

(i) Uma equação de balanço de massa (continuidade) é utilizada para as três 
fases;  

(ii) Duas equações de quantidade de movimento (uma para a fase gás 
incluindo a fase dispersa e uma para a fase líquida);  

(iii) Uma equação de energia para a mistura. Duas classes de padrões são 
utilizadas, a saber: distribuído (intermitente ou bolhas) e separado 
(estratificado ou anular). A transição entre os padrões de escoamento é 
baseada na fração de área média e determinada de acordo com o conceito 
de mínimo escorregamento onde é escolhido o padrão de escoamento que 
leve à menor velocidade do gás.  

Conforme mostrado na Figura 3-11 e na Figura 3-12, o duto é de seção circular e os 

volumes ocupados pelo líquido e pelo gás são dados por ?? e ??. A razão de volumes 

pode ser considerada igual a razão de áreas e as frações volumétricas do líquido e do 

gás, ?? e ?? podem ser definidas como (SALES, 2013): 

?? =
??

?
     3.72 

?? =
??

?
    3.73 

Onde as frações volumétricas, ?? e ??, estão sujeitas a seguinte condição: 

?? + ?? = 1     3.74 

 

 

3.5.3. Equações de Balanço de Massa  

 
Para a fase gás:  

?

??
(????) = ?

1

?

?

??
(???????) + ?? + ??     3.75 

 

Para a fase líquida:  

?

??
(????) = ?

1

?

?

??
(???????) + ??

??

??+??
? ?? + ?? + ??     3.76 

 

Para a fase de gotículas de líquido:  

?

??
(????) = ?

1

?

?

??
(???????) ? ??

??

??+??
+ ?? ? ?? + ??     3.77 

 

Para os termos das equações 3.75, 3.76 e 3.77 tem-se ?? - Fração volumétrica do 

gás; ?? - Fração volumétrica do líquido; ?? - Fração volumétrica das gotas de líquido; 

? - Massa específica; ? - Velocidade; ? - Pressão; ? - Área da seção transversal do 



 
    57 
 

 

tubo; ??- Taxa de transferência de massa entre as fases; ?? - Taxa de arrastamento; 

?? - Taxa de deposição; ?? - Fonte de massa da fase gás; ?? - Fonte de massa da 

fase líquida; e ?? - Fonte de massa da fase dispersa de gotículas de líquido. Os 

subscritos g, L, i e D indicam gás, líquido, interface e deposição de gotas.  

 
3.5.4. Equações de Quantidade de Movimento  

 
Para a fase gás:  

?

??
(??????) = ??? (

??

??
) ?

1

?

?

??
(???????

2) ? ??
1

2
??|??|??

??

4?
? ??

1

2
??|??|??

??
4?

+ ????? cos ? + ???? ? ?? 

3.78 

 

Para a fase gotículas de líquido:  

?

??
(??????) = ??? (

??

??
) ?

1

?

?

??
(???????

2) + ????? cos ? ? ??
??

??+??
?? + ???? ?

???? + ??      

3.79 

 

As equações 3.78 e 3.79 foram combinadas para produzir um salto tal que o termo de 

arrasto representado por ?? na relação entre gás/gotículas se anula. Assim tem-se 

somente uma equação de balanço de quantidade de movimento para a fase gás 

incluindo a fase dispersa de gotículas de líquido, representada pela equação 3.80 

abaixo: 

  



 
    58 
 

 

Para a combinação gás/gotículas de líquido:  

?

??
(?????? + ??????)

= ?(?? + ??) (
??

??
) ?

1

?

?

??
(???????

2 + ???????
2) ? ??

1

2
??|??|??

??

4?

? ??
1

2
??|??|??

??
4?

+ (???? + ????)? ??? ? + ??
??

?? + ??
?? + ????

? ???? 

3.80 

 

Para a fase líquida: 

?

??
(??????) = ??? (

??

??
) ?

1

?

?

??
(???????

2) ? ??
1

2
??|??|??

??
4?

? ??
1

2
??|??|??

??
4?

+ ????? cos ? + ??
??

?? + ??
?? ? ???? + ????

? ???(?? ? ??)?
???
??

sin ? 

3.81 

 

Nas equações 3.78 a 3.81, ? corresponde a inclinação do tubo com a vertical e ??, ?? 

e ?? são respectivamente, o perímetro molhado do gás, do líquido e da interface. 

Supõe-se que a fonte interna ?? entra com um ângulo de 90° na parede do tubo, 

caminhando sem impulso líquido. Com isso pode-se considerar: 

- Na evaporação do filme líquido: 

?? = ??  para  ?? &gt; 0   3.82 

 

- Na evaporação das gotas de líquido: 

?? = ??  para  ?? &gt; 0   3.83 

 

- Na condensação: 

?? = ??  para  ?? &amp;lt;0   3.84 

 

As equações de conservação acima podem ser aplicadas para todos os tipos de 

regimes de escoamento.  

A velocidade relativa ?? é definida pela seguinte equação de deslizamento 

?? = ??(?? + ??)       3.85 



 
    59 
 

 

Onde ?? é a uma taxa de distribuição de deslizamento causado por uma distribuição 

desigual de fases e velocidades em toda a seção transversal da tubulação, como 

esboçada na seção seguinte. 

A velocidade das gotículas é similarmente definida por: 

?? = ?? ? ??? cos ?   3.86 

onde ??? é a velocidade de queda da gotícula. A velocidade de interface ?? é 

aproximada para ??, que é a velocidade do líquido. 

 

3.5.5. Equação de Energia da Mistura 

 
Para a energia da mistura tem-se: 

?

??
[?? (?? +

1

2
??

2 + ??) + ?? (?? +
1

2
??

2 + ??) + ?? (?? +
1

2
??

2 + ??)]

= ?
?

??
[???? (?? +

1

2
??

2 + ??) + ???? (?? +
1

2
??

2 + ??)

+ ???? (?? +
1

2
??

2 + ??)] + ?? + ? 

3.87 

onde ? é a energia interna por unidade de massa, ? é a elevação, ?? é a entalpia da 

fonte de massa e ? é a transferência de calor da parede do tubo. 

 

3.5.6. Propriedades dos Fluidos e Transferência de Fase 

 
Todas as propriedades (massas específicas, compressibilidades, viscosidades, 

tensão superficial, entalpias, capacidades de calor e condutividade térmica) são dadas 

em tabelas em função da pressão e temperatura e os valores reais em um 

determinado ponto no tempo e espaço são encontrados pela interpolação nestas 

tabelas (BENDIKSEN et al., 1991). Essas tabelas são geradas previamente à 

simulação do OLGA®, utilizando qualquer pacote de propriedades dos fluidos, 

baseadas nas equações de Peng-Robinson, Soave-Redlich-Kwong ou outra equação 

de estado, em conformidade com o formato da tabela especificada (SALES, 2013). 

Considera-se que, a composição total da mistura é constante no tempo ao longo da 

tubulação, enquanto que as composições do gás e do líquido mudam com a pressão 

e a temperatura, como resultado da transferência de massa interfacial. Em sistemas 



 
    60 
 

 

reais, a diferença de velocidade entre as fases de gás e óleo podem causar mudanças 

na composição total da mistura. Isso pode ser totalmente contabilizado somente para 

um modelo de composição (BENDIKSEN et al., 1991). 

 

3.5.7. Transferência de Massa Interfacial 

 
A aplicação do modelo de transferência de massa na interface pode tratar tanto 

condensação normal quanto evaporação e condensação retrógrada, em que uma fase 

pesada condensa a partir da fase de gás com a queda de pressão (BENDIKSEN et 

al., 1991). A fração mássica de gás em condições de equilíbrio pode ser definida 

como: 

?? =
??

(??+??+??)
   3.88 

 

A taxa de transferência de massa poderá ser expressa da seguinte maneira: 

?? = [(
???

??
)

?

??

??
+ (

???

??
)

?

??

??

??

??
+ (

???

??
)
?

??

??
+ (

???

??
)
?

??

??

??

??
] (?? + ?? + ??)      3.89 

 

O termo (
???

??
)

?

??

??
 representa a transferência de fase a partir de uma massa presente 

em uma seção devido a mudança de pressão na referida secção. Já o termo 

(
???

??
)

?

??

??

??

??
 representa a transferência de massa causada pela massa que flui de uma 

seção para a outra. 

  



 
    61 
 

 

 

3.6. Modelos Dinâmicos Simplificados 

 

Ao estudar um escoamento em golfadas, o foco deve ser direcionado a capturar a 

dinâmica da formação da golfada, não a golfada em si, ou seja, o objetivo é evitar o 

regime de escoamento em golfadas ao invés de determinar o comprimento ou o 

formato das mesmas. Ao invés de lidar com modelos complexos, como os 

desenvolvidos no simulador OLGA®, é necessário um modelo dinâmico simplificado 

para a análise de controlabilidade e projeto do controlador. Alguns dos principais 

modelos encontrados na literatura estão citados a seguir: ”Modelo de Jahanshahi” 

(JAHANSHAHI; SKOGESTAD, 2011), “Modelo de Storkaas” (STORKAAS; 

SKOGESTAD, 2003), “Modelo de Eikrem1”, “Modelo de Kaasa” (KAASA et al., 2007), 

“Modelo de Nydal” (SILVA; DESSEN; NYDAL, 2010) e “Modelo de Di Meglio” 

(MEGLIO; KAASA; PETIT, 2009). Os modelos citados foram simulados no domínio do 

tempo e seus resultados comparados ao modelo OLGA® com o objetivo de avaliar os 

cinco aspectos abaixo, listados em ordem de importância (JAHANSHAHI; 

SKOGESTAD, 2011): 

? Abertura crítica da válvula choke para a formação de golfadas 

? Frequência das oscilações com a válvula choke na abertura crítica 

? Resposta dinâmica para uma mudança em degrau da abertura da válvula 
choke 

? Pressão e vazão do sistema para o regime permanente 

? Pressões e vazões mínima e máxima das oscilações durante o regime de 
golfadas 

Os modelos simplificados também foram analisados no domínio da frequência, onde 

foram consideradas a localização dos polos instáveis e zeros instáveis (RHP) do 

modelo. Ao final do comparativo, os modelos que apresentaram os melhores 

resultados e as melhores predições das pressões e vazões mínimas e máximas para 

o regime permanente quando comparadas aos resultados do OLGA®, foram o “Modelo 

de Jahanshahi” e o “Modelo de Di Meglio”.  

                                            
1 EIKREM, G. O. 2008. “Eikrem Riser Model” 

http://www.nt.ntnu.no/users/skoge/diplom/prosjekt08/tuvnes 



 
    62 
 

 

Porém o “Modelo de Jahanshahi” apresentou um melhor ajuste para uma resposta em 

degrau da pressão de topside  (JAHANSHAHI; SKOGESTAD, 2011). Portanto, optou-

se neste trabalho pela utilização do “Modelo de Jahanshahi”, pois considera-se que 

este é o modelo simplificado mais representativo do sistema real e apresenta 

vantagens sobre os demais modelos encontrados na literatura. Este modelo será 

descrito a seguir, em detalhes.  

 

3.7. “Modelo de Jahanshahi” para um Sistema “Pipeline-Riser” 

 

3.7.1. Equações de Balanço de Massa para um Sistema “Pipeline-Riser” 

 

As equações diferenciais 3.90, 3.91, 3.92 e 3.93 mostradas abaixo representam as 

equações de conservação de massa das fases gasosa e líquida do sistema “pipeline-

riser” mostrado na Figura 3-13 e na Figura 3-14. 

???,?

??
= ??,?? ? ??,?? 

3.90 

???,?

??
= ??,?? ? ??,?? 

3.91 

???,?

??
= ??,?? ? ??,??? 

3.92 

???,?
??

= ??,?? ? ??,??? 
3.93 

 

As quatro variáveis de estado do modelo são: ??,? massa de gás no pipeline [kg] 

??,? massa de líquido no pipeline [kg], ??,? massa de gás no riser [kg] e ??,? massa 

de líquido no riser [kg]. 



 
    63 
 

 

 

Fonte: (JAHANSHAHI, 2013) 
Figura 3-13 – Representação simplificada do escoamento (Sem bloqueio de líquido) 

 

Fonte: (JAHANSHAHI, 2013) 
Figura 3-14 – Representação simplificada do bloqueio de líquido na base do riser, levando 

a golfada severa. 

 

 

Os principais parâmetros utilizados no modelo estão descritos na Tabela 2. Quatro 

dos parâmetros encontrados nesta tabela são utilizados para sintonia do modelo, 

conforme abaixo: 



 
    64 
 

 

? ??: Fator de correção do nível de líquido no pipeline 

? ??1: Constante da válvula choke de produção 

? ??: Coeficiente para a vazão de gás na base do riser 

? ??: Coeficiente para a vazão de líquido na base do riser 

 

 

3.7.2. Condições de Contorno na Entrada 

 

Nas equações 3.90 e 3.91, ??,?? e ??,?? representam as vazões mássicas de entrada 

do gás e do líquido, respectivamente. A princípio, é assumido que estas vazões são 

constantes, mas esta condição de contorno pode ser posteriormente alterada por 

exemplo, para uma vazão de entrada variável com a pressão. 

 

3.7.3. Condições de Contorno na Saída  

 

Considera-se como condição de contorno na saída, que a pressão na saída é 

constante (pressão de separação, ??). Logo, é possível representar a vazão de saída 

para uma mistura bifásica pela equação da válvula choke (JAHANSHAHI, 2013): 

???? = ??1. ?(?1)????. max (??? ? ??, 0)  3.94 

 

Sendo ?1, a abertura normalizada da válvula choke (0 &amp;lt;?1 &amp;lt;1) e ?(?1), a equação 

característica da válvula.  

Nas simulações, é considerada uma válvula linear, ou seja, ?(?1) = ?1 . Esta premissa 

pode ser alterada para outros tipos de válvulas. 

As vazões mássicas de saída são calculadas (JAHANSHAHI, 2013) conforme abaixo: 

??,??? = ??,??
? . ????   3.95 

??,??? = (1 ? ??,??
? ). ????   3.96 

 

A fração mássica ??,??
?  de líquido no topo do riser é dada por: 



 
    65 
 

 

??,??
? =

??,??.??

??,??.??+(1???,??).??,?
   3.97 

A densidade da mistura bifásica no topo do riser é dada por: 

??? = ??,??. ?? + (1 ? ??,??). ??,?  3.98 

A fração volumétrica de líquido, ??,?? é calculada pela equação: 

??,?? = 2. ????,? ? ??,?? =
2.??,?

??.??
?

??

??
  3.99 

 

3.7.4. Modelo do Pipeline 

 

A fração volumétrica de líquido na seção do pipeline ?? é dada pela fração mássica de 

líquido ??
? e pela densidade das fases líquida e gasosa: 

?? =
??

?/??

??
?/?? +(1???

?)/??
   3.100 

 

A fração mássica média de líquido na seção do pipeline é dada pelas vazões mássicas 

na entrada: 

????,?
? =

??,??

??,?? + ??,??
   3.101 

 

Então, a fração volumétrica média de líquido no pipeline é: 

????,? =
????,?.??,??

????,?.??,??+??.??,??
   3.102 

 

A densidade do gás ????,? é calculada com base na pressão nominal (em regime 

permanente) no pipeline. Para efeitos de simplicidade do modelo, assumiu-se que o 

gás é ideal: 

????,? =
???,???.??

?.??
   3.103 

 

Pressão de entrada nominal ???,??? é calculada a partir de uma inicialização em 

regime permanente do modelo. Portanto, para vazões de entrada constantes, obtém-

se ????,? também constante. A área da seção transversal do pipeline é dada por: 

?? =
?

4
. ??

2    3.104 

 



 
    66 
 

 

onde ?? é o diâmetro do pipeline, então o volume do pipeline é dado por ?? = ??. ??. 

Considerando uma distribuição homogênea do gás e do líquido ao longo do pipeline, 

a massa de líquido é dada por:  

????,? = ??. ??. ????,?   3.105 

 

Portanto, o nível de líquido no ponto mais baixo do pipeline é dado aproximadamente 

por ?? ? ??. ????,?, onde ?? = ??. cos ? é a abertura ao fluxo na base do riser e ? a 

inclinação do pipeline, ou seja: 

?? = ??. ??. ????,?   3.106 

onde ?? é o fator de correção em torno da unidade que pode ser utilizado para o ajuste 

fino do modelo. Se o conteúdo de líquido no pipeline aumentar de ???,? , o mesmo 

começa a preencher o pipeline a partir do ponto mais baixo e um comprimento do 

pipeline igual a ?? será ocupado unicamente por líquido. 

A variação de massa do líquido no pipeline é calculada por: 

???,? = ??,? ? ????,? = ??. ??. (1 ? ????,?). ?? 3.107 

 

O nível de líquido no pipeline é ? = h? + ??. sen ? , ou seja: 

? = ?? + (
??,??????,?

??.(1?????,?).??
) . ??? ?  

3.108 

 

Assim, o nível de líquido no pipeline ? pode ser escrito como uma função da massa 

de líquido no pipeline ??,?, que é uma variável de estado do modelo. Os demais 

parâmetros da equação 3.108 são constantes. 

A densidade do gás no pipeline é dada por: 

??,? =  
??,?

??,?
    3.109 

onde o volume ocupado pelo gás no pipeline é: 

??,? = ?? ? ??,?/??   3.110 

 

A pressão na entrada do pipeline, assumindo que o gás é ideal, é dado por: 

??? =
??,?.?.??

??
    3.111 



 
    67 
 

 

 

Para o cálculo das perdas por fricção no pipeline, apenas o líquido é considerado: 

???? =
????,?.??.??.?????,??

2 .??

2.??
   3.112 

O fator de fricção ?? do pipeline pode ser considerado como uma aproximação 

explícita da equação implícita de Colebrook-White. Esta equação foi adotada por ser 

considerada a mais precisa lei de resistência ao escoamento, sendo utilizada como 

padrão referencial: 

1

???
= ?1,8. ???10. [(

?/??

3,7
)
1,11

+
6,9

???
]  3.113 

onde o número de Reynolds é: 

??? =
??.?????,??.??

?
   3.114 

 

O termo ? é a viscosidade do líquido.  A velocidade superficial ?????,??, do líquido é: 

?????,?? =
4.??,??

?.??
2.??

    3.115 

 

 

3.7.5. Modelo do Riser 

 

O volume total do riser é dado por: 

?? = ??. (?? + ??)   3.116 

onde a sua área da seção transversal é  

 ?? =
?

4
??

2     3.117 

E o volume ocupado pelo gás no riser é dado por: 

??,? = ?? ? ??,?/??   3.118 

 

A densidade do gás no riser é dada por: 

??,? =
??,?

??,?
    3.119 

E a pressão no topo do riser, dada pela lei dos gases ideais é: 

??? =
??,?.?.??

??
    3.120 

 

A fração volumétrica média de líquido no riser é: 



 
    68 
 

 

????,? =
??,?

??.??
  3.121 

 

A densidade média da mistura no riser é: 

????,? =
??,?+??,?

??
   3.122 

 

A perda por fricção no riser é: 

???? =
????,?.??.????,?.????

2 .(??+??)

2.??
   3.123 

O fator de fricção do riser, utilizando-se da mesma correlação adotada para o pipeline 

é: 

1

???
= ?1,8. ???10. [(

?/??

3,7
)
1,11

+
6,9

???
]  3.124 

O número de Reynolds para o escoamento no riser é dado por: 

??? =
????,?.????.??

?
   3.125 

 

Sendo as velocidades da mistura no riser dadas por:  

???? = ?????,? + ?????,?   3.126 

?????,? =
??,??

??.??
    3.127 

?????,? =
??,??

??,?.??
    3.128 

 

 

3.7.6. Modelo de Escoamento de Gás na Base do Riser 

 

Como ilustrado na Figura 3-14, quando o nível de líquido na seção do pipeline 

ultrapassa a abertura do duto na base do riser (? &gt; ??), o líquido causa um bloqueio 

do gás, ou seja, a vazão de gás ??,?? na base do riser é zero. 

??,?? = 0,    ? ? ??   3.129 

 

Quando o líquido não está bloqueando a base do riser (? &amp;lt;??) conforme Figura 3-13, 

o gás irá fluir do volume ??,? para ??,? com a vazão mássica ??,?? [kg/s] que é dada por 

uma “equação de orifício” (SKOGESTAD, 2009): 



 
    69 
 

 

??,?? = ??. ??. ???,?. ???,      ? &amp;lt;??   3.130 

onde: 

??? = ??? ? ???? ? ??? ? ????,?. ?. ?? ? ????  3.131 

 

A área livre ?? para o escoamento de gás pode ser calculada utilizando funções 

trigonométricas, mas por simplicidade, é utilizada neste modelo, uma aproximação 

quadrática. 

?? = ??. (
????

??
)
2

, ? &amp;lt;??    3.132 

?? = 0, ? ? ??    3.133 

 

 

3.7.7. Modelo de Escoamento de Líquido na Base do Riser 

 

A vazão mássica de líquido na base do riser é também descrita por uma “equação de 

orifício”: 

??,?? = ??. ??. ???. ???    3.134 

onde: 

? = ??? ? ???? + ??. ?. ? ? ??? ? ????,?. ?. ?? ? ????  3.135 

e também: 

?? = ?? ? ??    3.136 

 

 

3.7.8. Modelo de para Distribuição das Fases na Saída da Válvula Choke 

 

Para o cálculo das vazões mássicas de cada fase, deve-se conhecer a distribuição 

das fases no topo do riser. A fração volumétrica de líquido no topo do riser (???), é 

calculada considerando-se que, em um duto com escoamento bifásico vertical, há 

uma relação aproximadamente linear entre a pressão e a fração volumétrica de 

líquido. Adicionalmente, o gradiente de pressão é assumido como constante ao longo 

do riser para regimes de escoamento estáveis (sem golfadas), ou seja, o gradiente da 

fração de líquido é constante (
????

??
= ?????????). Logo, a fração volumétrica média de 

líquido no riser é dada por: 



 
    70 
 

 

????? =
??,??+??,??

2
    3.137 

Esta fração volumétrica ????,? do líquido no riser também é dada pela equação 3.121. A 

fração ??,?? na base do riser é determinada pela área ocupada pelo líquido nesta base 

do riser: 

??,?? =
??

??
    3.138 

Então, a fração volumétrica de líquido no topo do riser é: 

??,?? = 2. ????,? ? ??,?? =
2.??,?

??.??
?

??

??
  3.139 

 

 

Tabela 2 – Parâmetros do sistema pipeline-riser 

Símbolo Descrição Valor Unidades 

? Constante universal dos gases 8314 J/(kmol.K) 

? Gravidade 9,81 m/s2 

?  Viscosidade do líquido 1426 x 10-4 Pa.s 

?? Densidade do líquido 832,2 kg/m
3 

??  Peso molecular do gás 20 g 

?? Temperatura do pipeline 293,15 K 

?? Diâmetro do pipeline 0,12 m 

?? Comprimento do pipeline 4300 m 

?? Diâmetro do riser 0,1 m 

?? Comprimento do riser 300 m 

?? Comprimento da seção horizontal no topo do riser 100 m 

?? Pressão do separador 50,1 bar 

?? Fator de correção de nível 0,7 - 

?? Coeficiente para a vazão de gás na base do riser 3,49 x 10-2 - 

??  Coeficiente para a vazão de líquido na base do riser 2,81 x 10
-1 - 

??1 Constante da válvula choke de produção 1,16 x 10
-2 - 

Fonte:  (JAHANSHAHI, 2013) 

 

 

  



 
    71 
 

 

3.8. “Modelo de Jahanshahi” para um Sistema “Poço-Pipeline-
Riser” 

 
Na seção 3.7, analisou-se um sistema com vazões de entrada constantes, definidas 

na seção 3.7.2 (condições de contorno de entrada). Porém, para uma análise mais 

realista de um sistema de produção de petróleo, deve-se utilizar uma vazão de entrada 

variável com a pressão. Portanto adicionou-se ao modelo um poço de petróleo, onde 

é assumido que a pressão do reservatório é constante (condição de contorno), 

conforme Figura 3-15. 

 
Fonte: (JAHANSHAHI, 2013) 

Figura 3-15 – Esquemático de um sistema poço-pipeline-riser. 

 

 

3.8.1. Modelo Simplificado Poço-Pipeline-Riser 

 

Para o modelo poço-pipeline-riser, adicionou-se duas variáveis de estado, a massa 

do gás e a massa do líquido dentro do poço, resultando em um modelo com seis 

estados. As equações de estado adicionais são: 

???,?

??
= (

???

???+1
) . ?? ? ??,??  3.140 



 
    72 
 

 

???,?

??
= (

1

???+1
) . ?? ? ??,??   3.141 

onde ??? é a razão mássica gás/líquido média produzida pelo reservatório, considera-

se neste modelo que este parâmetro do poço é conhecido, ??,?? e ??,?? são as vazões 

de gás e líquido na cabeça do poço. A vazão ?? do reservatório para o poço foi 

considerada como uma relação linear com a pressão: 

?? = ??. ??? (0, ???? ? ???)   3.142 

 

Sendo PI, o índice de produtividade do poço, ???? a pressão do reservatório que pode 

ser considerada constante para um período pequeno de análise (alguns dias) 

A pressão ??? no fundo do poço é: 

??? = ??? + ????,?. ?. ?? + ????   3.143 

onde ???? , a perda de carga no poço devido ao atrito, é dada por: 

???? =
????,?.??,????

.?????,?
2 .??

2.??
    3.144 

 

Aqui a fração volumétrica média de líquido no poço é dada por: 

????,? =
??,?

??.??
     3.145 

Para o fator de atrito no poço, é utilizada a mesma correlação do pipeline: 

1

???
= ?1,8. ???10. [(

?/??

3,7
)
1,11

+
6,9

???
]   3.146 

Tem-se o número de Reynolds para o escoamento no poço: 

??? =
??.??????,?.??

?
   3.147 

E a velocidade superficial média de líquido no poço é: 

?????,? =
4.??????

?.??
2 .??

    3.148 

onde ?????? é a vazão nominal do poço, conhecida a priori.  

Como outras variáveis importantes do modelo do poço, a densidade média da mistura 

bifásica é: 

 ????,? =
??,?+??,?

??
    3.149 

A densidade da fase gás é: 



 
    73 
 

 

??,? =
??,?

?????,?/??
   3.150 

E a pressão na cabeça do poço, considerando gás ideal é: 

??? =
??,?.?.???

??.(?????,?/??)
     3.151 

 

Para calcular as frações volumétricas no topo do poço, utiliza-se as mesmas 

considerações feitas para o riser: 

??,?? = 2. ????,? ? ??,??    3.152 

 

Neste caso, assume-se que o fluido do reservatório está saturado e a fração 

volumétrica do líquido é ??,?? = 1, pois a pressão no fundo do poço é bastante 

elevada, mantendo todo o gás em solução. A fração mássica do gás no topo do poço 

é dada por: 

??,??
? =

(1???,??).??,?

??,??.??+(1???,??).??,?
    3.153 

 

E a densidade da mistura no topo do poço é: 

??? = ??,??. ?? + (1 ? ??,??). ??,?   3.154 

onde ??? é a pressão na entrada do pipeline.  

As vazões das fases gás e líquido na cabeça do poço são dadas por: 

??,?? = ???. ??,??
?     3.155 

??,?? = ???. (1 ? ??,??
? )    3.156 

 

As vazões de gás e líquido no pipeline são dadas respectivamente por: 

??,?? = ??,?? + ?1    3.157 

??,?? = ??,?? + ?2    3.158 

onde ?1  e ?2 podem ser consideradas como distúrbios de outros poços na malha de 

drenagem. 

  



 
    74 
 

 

Tabela 3 – Parâmetros adicionais para o sistema poço-pipeline-riser 

Símbolo Descrição Valor Unidades 

???? Pressão do reservatório 320 bar 

?? Índice de produtividade 2,75 x 10-6 kg/(s.Pa) 

???? Vazão mássica nominal do reservatório 9 kg/s 

??? Razão mássica gás óleo 0,0417 - 

?? Temperatura do poço 369 K 

?? Diâmetro do poço 0,12 m 

?? Profundidade do poço 3000 m 

Fonte: (JAHANSHAHI, 2013) 

 

 

3.9. Modelagem do sistema no simulador OLGA® 

 

3.9.1. Modelagem do Sistema Pipeline-Riser 

 
O sistema pipeline-riser descrito na seção 3.7 foi modelado no software OLGA® 

considerando os parâmetros geométricos informados na Tabela 2.  

Para este modelo, considerou-se o comprimento total do trecho pipeline de 4300m, 

sendo este, formado por um trecho horizontal de 2000m (PIPE-1) e por um trecho com 

inclinação descendente de 1 grau, composto por uma seção de 2000m (PIPE-2) e 

outra de 300m (PIPE-3).  

O trecho riser foi composto por um duto de 300m com inclinação vertical (PIPE-4) e 

um trecho horizontal de 100m (PIPE-5), a válvula choke está situada ao final do trecho 

horizontal, conectada a montante de um separador de produção com pressão 

constante de 50,1 bar. Os trechos denominados PIPE-1 a PIPE-5 fazem parte da 

nomenclatura constante na Tabela 4. 

Para todo o duto, a rugosidade considerada foi de 0,028 mm. 

 



 
    75 
 

 

 

Figura 3-16 – Modelo do OLGA® para o sistema pipeline-riser 

 

Tabela 4 – Dados da geometria do sistema pipeline-riser modelado no OLGA® 

Trecho Nome Diâmetro Rugosidade Comprimento Elevação 

Pipeline-Riser PIPE-1 0.12 m 2.8E-05 m 2000 m 0 m 

Pipeline-Riser PIPE-2 0.12 m 2.8E-05 m 2000 m -34.9 m 

Pipeline-Riser PIPE-3 0.12 m 2.8E-05 m 300 m -5.24 m 

Pipeline-Riser PIPE-4 0.1 m 2.8E-05 m 300 m 300 m 

Pipeline-Riser PIPE-5 0.1 m 2.8E-05 m 100 m 0 m 

 

 

Neste problema, considerou-se a fonte de massa com vazão de 9 kg/s e temperatura 

da mistura de 293,15K (20ºC). Pela curva mostrada na Figura 3-17 é possível obter a 

fração mássica do gás na entrada do pipeline. Para 20ºC, tem-se que 4% da vazão 

mássica é relativa a fração gasosa, logo, as vazões mássicas de alimentação do duto 

são de 0,36 kg/s na fase gasosa e 8,64 kg/s na fase líquida. 



 
    76 
 

 

 

Figura 3-17 – Curva de fração mássica de gás x temperatura do fluido 

 

 

3.9.2. Modelagem do Sistema Poço-Pipeline-Riser 

 

O sistema poço-pipeline-riser descrito na seção 3.8 foi modelado no software OLGA® 

considerando os parâmetros geométricos informados na Tabela 3.  

Para este modelo, considerou-se o comprimento do poço de 3000m vertical, pressão 

de reservatório de 320 bar e temperatura do fluido a 369K. O modelo do reservatório 

foi considerado linear, ou seja, a vazão de produção varia linearmente ao diferencial 

de pressão imposto ao reservatório. 



 
    77 
 

 

 

Figura 3-18 – Modelo do OLGA® para o sistema poço-pipeline-riser 

 

Tabela 5 – Dados da geometria do sistema poço-pipeline-riser modelado no OLGA® 

Trecho Nome Diâmetro Rugosidade Comprimento Elevação 

Poço PIPE-1 0.12 m 2.8E-05 m 3000 m 3000 m 

 

 

  



 
    78 
 

 

4. RESULTADOS E DISCUSSÃO 

 

4.1. Modelo do sistema pipeline-riser 

 
4.1.1. Pressões de Entrada e Saída e Diagrama de Bifurcação do Pipeline-

Riser no OLGA® 
 

A partir do sistema pipeline-riser modelado no OLGA® na seção 3.9.1, simulou-se o 

comportamento das pressões de entrada (pipeline) e saída (topo do riser) para uma 

abertura da válvula choke em rampa (entre 4% e 10%). O objetivo é determinar a 

abertura crítica da válvula, na qual as pressões da entrada do pipeline e do topo do 

riser se tornam instáveis e iniciam o comportamento oscilatório. Na Figura 4-1, a 

abertura da válvula choke está mostrada na escala de 0.04-0.10 no lado direito e as 

pressões na entrada do pipeline e no topo do riser estão mostradas na escala 50-80 

no lado esquerdo do gráfico. Através da análise do gráfico, nota-se que as oscilações 

nas pressões na entrada do pipeline e no topo dor riser se iniciam para aberturas da 

válvula choke em 7%, sendo esta, a abertura crítica em que o sistema se torna 

oscilatório. 

 

Figura 4-1 – Comportamento das pressões na entrada do pipeline (PIPE-1) e no topo do riser 
(PIPE-5) para uma abertura crescente da válvula choke 

 



 
    79 
 

 

A mesma simulação foi realizada, agora com uma maior variação da válvula choke 

(2% a 100%), com o objetivo de visualizar os ranges de oscilação das pressões para 

cada abertura da válvula choke e determinar de forma indireta, o diagrama de 

bifurcação do sistema, estes resultados podem ser visualizados na Figura 4-2. O 

diagrama de bifurcação é formado pelos valores de máximo e mínimo das pressões 

na entrada do pipeline e no topo do riser. A abertura da válvula choke está mostrada 

na escala de 0.0-1.0 no lado direito e as pressões na entrada do pipeline e no topo do 

riser estão mostradas na escala 50-100 no lado esquerdo do gráfico. 

 

Figura 4-2 – Oscilação das pressões de entrada do pipeline e de topo do riser para diferentes 
aberturas da válvula choke 

 

 

4.1.2. Diagramas de Bifurcação do Modelo Pipeline-Riser no MATLAB 

 

Os diagramas de bifurcação obtidos no MATLAB através do modelo simplificado de 

Jahanshahi para o sistema pipeline-riser são apresentados na Figura 4-3. Diagrama 

de bifurcação é um método adequado para avaliar o ponto em que o sistema se torna 

instável. Para presente caso, o modelo se torna instável para aberturas da válvula 

choke superiores a 7%, ponto em que ocorre a separação das linhas representativas 

das pressões máximas e mínimas, tanto para a pressão de entrada do pipeline (Figura 

4-3), quanto para a pressão do topo do riser (Figura 4-4), onde a linha tracejada 



 
    80 
 

 

representa a região de equilíbrio instável, representando o ponto ideal de operação, 

onde é possível elevar a produtividade do poço. 

A avaliação do modelo pipeline-riser pode ser realizada, comparando-se as oscilações 

de pressões de entrada do pipeline e de topo do riser obtidas no OLGA® e mostradas 

na Figura 4-2, com os diagramas de bifurcação obtidos via MATLAB mostrados na 

Figura 4-3 e na Figura 4-4. Tanto o diagrama obtido pelo OLGA® quanto no MATLAB 

são mapas de bifurcação de Hopf  (STORKAAS; SKOGESTAD, 2007) e (ZAKARIAN, 

2000) 

 
Figura 4-3 – Diagrama de bifurcação - pressão na entrada do pipeline x abertura da válvula 

choke 

 

 
Figura 4-4 – Diagrama de bifurcação - pressão no topo do riser x abertura da válvula choke 

0 10 20 30 40 50 60 70 80 90 100

60

65

70

75

80

85

Abertura da Válvula Choke, Z
1
 [%]

P
in

 [
b
a
r]

Pressão na Entrada do Pipeline (PIPE-1))

 

 

Pressões Máximas e Mínimas - Modelo Jahanshahi

Região de Equilíbrio Instável

0 10 20 30 40 50 60 70 80 90 100
50

51

52

53

54

55

56

57

Abertura da Válvula Choke, Z
1
 [%]

P
rt
 [

b
a
r]

Pressão no Topo do Riser (PIPE-5)

 

 

Pressões Máximas e Mínimas - Modelo Jahanshahi

Região de Equilíbrio Instável



 
    81 
 

 

 

Portanto, é possível comprovar que, para ambos os casos de MATLAB e OLGA®, as 

pressões de entrada do pipeline e do topo do riser, iniciam o comportamento 

oscilatório para aberturas da válvula choke de aproximadamente 7%.  

Nota-se também que, para as simulações do MATLAB, os ranges de oscilação das 

pressões na entrada do pipeline (entre 64 bar e 78 bar) e no topo do riser (entre 50 

bar e 56 bar) são maiores que os obtidos pelo OLGA® (respectivamente entre 65 bar 

e 74 bar e entre 50 bar e 53 bar). Apesar das diferenças verificadas, considera-se que 

o modelo de Jahanshahi implementado no MATLAB apresenta bom ajuste com os 

resultados das simulações no OLGA®.  

 

 

4.2. Modelo do Sistema Poço-Pipeline-Riser 

 

4.2.1. Pressões de Entrada e Saída e Diagrama de Bifurcação do Poço-
Pipeline-Riser no OLGA® 

 

A mesma análise realizada para o sistema pipeline-riser foi repetida para o sistema 

poço-pipeline-riser. Os resultados podem ser visualizados na Figura 4-5, onde estão 

mostradas as faixas de oscilação das pressões para cada abertura da válvula choke, 

sendo possível visualizar o diagrama de bifurcação do sistema poço-pipeline-riser, 

similar ao item anterior, formado pelos valores de máximo e mínimo das pressões na 

entrada do pipeline e no topo do riser mostradas respectivamente nas escalas 50-85 

para a pressão de topo do riser e 240-300 para a pressão do fundo do poço  no lado 

esquerdo da Figura 4-5. A abertura da válvula choke está mostrada na escala de 0.0-

1.0 no lado direito da Figura 4-5. 



 
    82 
 

 

 
Figura 4-5 – Oscilação das pressões do fundo do poço e no topo do riser para diferentes 

aberturas da válvula choke 
 

 

4.2.2. Diagramas de Bifurcação pelo Modelo Poço-Pipeline-Riser no MATLAB 

 

De forma análoga a realizada para o sistema pipeline-riser na seção 4.1.2, foram 

ilustrados os diagramas de bifurcação obtidos no MATLAB, através do modelo 

simplificado de Jahanshahi para o sistema poço-pipeline-riser. Os diagramas de 

bifurcação mostrados na Figura 4-6 e na Figura 4-7 podem ser comparados com a 

simulação do OLGA® mostrada na  Figura 4-5. 



 
    83 
 

 

 

Figura 4-6 – Diagrama de bifurcação - pressão no fundo do poço x abertura da válvula choke 

 

 

Figura 4-7 – Diagrama de bifurcação - pressão no topo do riser x abertura da válvula choke 

 

Analogamente, é possível avaliar o modelo poço-pipeline-riser, comparando-se a 

Figura 4-5 que representa os resultados do OLGA® com a Figura 4-6 e a Figura 4-7, 

que representam os diagramas de bifurcação obtidos via MATLAB. Novamente, os 

resultados obtidos pelo OLGA® apresentam ranges menores que os simulados pelo 

MATLAB. 

0 20 40 60 80 100
270

275

280

285

290
Pressão no Fundo do Poço

Abertura da Válvula Choke, Z
1
 [%]

P
b

h
 [

b
a
r]

0 20 40 60 80 100
50

52

54

56

58

60
Pressão no Topo do Riser

Abertura da Válvula Choke, Z
1
 [%]

P
rt

 [
b
a
r]



 
    84 
 

 

Apesar das diferenças verificadas, considera-se que o modelo de Jahanshahi 

implementado no MATLAB apresenta bom ajuste com os resultados das simulações 

no OLGA®.  

Com base em tais resultados, utilizou-se o modelo simplificado modelado no MATLAB 

para o desenvolvimento de algoritmos de controle, com o objetivo de suprimir golfadas 

nos pontos de operação em que o sistema é instável (para aberturas da válvula choke 

maiores que a abertura crítica).  

 

 

4.3. Algoritmos de Controle para Mitigação de Golfadas 

 
Diversos algoritmos de controle têm sido desenvolvidos com o intuito de atenuar os 

problemas gerados pela produção em golfadas. O sistema proposto é instável para 

aberturas fixas da válvula choke superiores a abertura crítica, portanto, para se operar 

na região instável, aumentando a produtividade do poço e mitigando as golfadas, é 

necessário modular adequadamente a válvula. Para isto, diversos algoritmos de 

controle foram propostos (JAHANSHAHI; SKOGESTAD, 2013), (JAHANSHAHI et al., 

2014), (JAHANSHAHI; SKOGESTAD, 2015), (OLIVEIRA; JÄSCHKE; SKOGESTAD, 

2015), (SIVERTSEN; SKOGESTAD, 2005) e  (ZHOU; KAASA; AAMO, 2008). 

Como variável controlada, são utilizadas preferencialmente as pressões de fundo do 

poço ou de topo do riser, pois as mesmas são as mais comumente encontradas nos 

sistemas reais, seja através de sensores de pressão submarinos ou na plataforma. 

Porém, os transmissores submarinos possuem como desvantagem, uma manutenção 

de alto custo em caso de falha. 

Como variável manipulada, é utilizada a abertura da válvula choke no topo do riser, 

visto que, apesar de ser possível a existência da válvula choke em outras posições, 

como na cabeça do poço ou na base do riser, estas não são comuns em poços 

produtores de óleo. 



 
    85 
 

 

Neste trabalho são adotadas duas abordagens distintas para as técnicas de controle, 

a primeira será a utilização de um controlador PI adaptativo que consiga atuar perante 

as mudanças inerentes do sistema. A segunda abordagem é a utilização de um 

Regulador Linear Quadrático associado a um observador de estados com filtro de 

Kalman Unscented. O objetivo é verificar como o sistema se comporta em caso de 

utilização de um observador para compensar a falha de um sensor submarino. 

 
4.3.1. PI Adaptativo 

 
Os sistemas de controle aplicados na produção de petróleo se tornam instáveis após 

algum tempo, devido, por exemplo, à depleção natural do reservatório, reduzindo a 

produtividade do poço. Para compensar esta deficiência, são necessários 

controladores que consigam operar em diferentes pontos de operação e que lidem 

adequadamente com as não linearidades características deste tipo de sistema.  

Para o controlador PI com ganho adaptativo, foi utilizado um algoritmo encontrado na 

literatura (JAHANSHAHI, 2013), que é descrito em detalhes abaixo. 

A implementação deste controlador é realizada com base no ganho estático do 

sistema e na abertura média da válvula choke. No diagrama de bifurcação, a linha 

central representa a região desejada de operação conforme já citado nas seções 

anteriores. Esta linha está diretamente relacionada as propriedades da válvula choke 

(JAHANSHAHI, 2013), a equação da válvula possui a seguinte definição: 

? = ??. ?(?). ??. ??    4.1 

onde ? (kg/s) representa a vazão mássica de saída da válvula, ?? representa a perda 

de carga através da válvula e ?? é uma constante conhecida da válvula. Logo, a perda 

de carga pode ser reescrita como: 

    ?? =
???

?(?)2
 4.2 

Onde ??? é uma constante e pode ser definida por: 

??? =
1

???
. (

???

??
)
2

    4.3 

Sendo ??? e ??? a vazão mássica média de saída e a densidade média da mistura 

respectivamente, que podem ser obtidos das seguintes equações: 



 
    86 
 

 

??? ? ??,?? + ??,??   4.4 

??? =  ????. ?? + (1 ? ????). ????     4.5 

 

Portanto, pela equação 4.2, a pressão a montante do choke é dada por: 

??? =
???

?(?)2
+ ?????   4.6 

onde ?????, também uma constante, é dada por: 

????? = ???
? ?

???

?(??)2
  4.7 

e ?? é a abertura crítica da válvula choke do diagrama de bifurcação. 

Derivando a equação 4.7 em relação a ?, tem-se o ganho estático: 

?(?) =
?2???.

??(?)

?

?(?)3
   4.8 

Assumindo uma válvula com abertura linear, a equação acima pode ser reescrita: 

?(?) =
?2???

?3
    4.9 

onde ? é a abertura da válvula choke e varia de 0 ? ? ? 1. 

Os valores do ganho proporcional e do tempo integral do controlador PI podem ser 

escritos em função da abertura ? da válvula choke: 

??(?) =
?.????

?(?).??/??
   4.10 

??(?) = 3. ????. (
?

??
)   4.11 

onde ???? representa o período das oscilações no sistema em malha aberta, ?
? 

representa a abertura crítica da válvula (mostrada no diagrama de bifurcação) e ? é 

uma constante calculada a partir da resposta em degrau do sistema em malha 

fechada. 

Primeiramente são mostrados os gráficos do sistema em malha aberta, das pressões 

P1 (entrada do pipeline) e P2 (topo do riser), vazão volumétrica Q e vazão mássica W 

para diferentes aberturas da válvula choke. 

A Figura 4-8 mostra as saídas do sistema para uma abertura da válvula choke de 5% 

obtidas no MATLAB. Nota-se, conforme seção 5.1 que o sistema é estável para esta 



 
    87 
 

 

abertura da válvula choke, mesmo em malha aberta, porém a pressão estabilizada da 

entrada do pipeline P1 é elevada, aproximadamente de 77,42 bar. 

 

Figura 4-8 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula choke 
com abertura de 5% 

 

Na Figura 4-9 são mostradas as saídas do sistema para uma abertura da válvula 

choke de 10% obtidas no MATLAB. Nota-se que para esta abertura, o sistema já se 

torna oscilatório em malha aberta, visto que a abertura da válvula choke é maior que 

a abertura crítica 7%, valor este, obtido na seção 4.1.1. Apesar do comportamento 

oscilatório, a pressão média de entrada do pipeline P1 para abertura de 10% é de 

71,56 bar, valor menor que o apresentado pelo sistema para uma abertura da válvula 

choke de 5%. 



 
    88 
 

 

 

Figura 4-9 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula choke 
com abertura de 10% 

 

Na Figura 4-10 são mostradas as saídas do sistema para uma abertura da válvula 

choke de 20% obtidas no MATLAB. Nota-se que para esta abertura, o sistema 

continua oscilatório em malha aberta, porém a pressão média de entrada do pipeline 

P1 é de 69,53 bar, sendo novamente menor que nos casos anteriores. Conforme 

mostrado na seção 2.3, menores contrapressões impostas ao reservatório resultam 

em maior produtividade do poço, porém deve-se considerar o comportamento 

indesejável representado pelas oscilações do poço, resultando em um regime de 

escoamento por golfadas. 



 
    89 
 

 

 
Figura 4-10 – Pressões P1 e P2, vazão volumétrica Q e vazão mássica W para a válvula choke 

com abertura de 20% 

 

Para comparar a efetividade do controlador PI adaptativo, primeiramente projetou-se 

um controlador PI de ganho fixo. Linearizou-se o sistema para o ponto de operação 

de abertura da válvula choke em 10%, após esta etapa, obteve-se a função de 

transferência considerando como entrada, a abertura z da válvula choke e como saída, 

a pressão de entrada do pipeline P1. Obteve-se o ganho proporcional e o tempo 

integral utilizando a ferramenta “PID Tuner” disponível no MATLAB de forma a 

adequar o desempenho dinâmico do sistema em malha fechada mostrados na Figura 

4-11. Os valores de ganho proporcional e tempo integral obtidos são respectivamente: 

?? = ?1,09 e ?? = 11,9. 



 
    90 
 

 

 

 

Figura 4-11 – Resposta ao degrau e diagrama de Bode para a função de transferência de z para 
P1. 

 

A partir do controlador PI de ganho fixo, simulou-se no MATLAB, a resposta em degrau 

para diferentes aberturas da válvula choke (entre 10% e 50%). Nota-se que este 

controlador só é adequado para aberturas da válvula choke de até 26%, para valores 

maiores, o sistema se torna instável. As simulações de resposta ao degrau estão 

mostradas na Figura 4-12. 

 



 
    91 
 

 

 
Figura 4-12 – Resposta ao degrau de P1 para aberturas da válvula choke variando de 10% a 

50% utilizando um controlador PI de ganho estático 

 

Adotando-se o controlador PI adaptativo descrito na seção 4.3.1, obteve-se 

novamente a resposta em degrau para aberturas da válvula choke entre 10% e 50% 

no MATLAB.  

O período de oscilação adotado foi obtido através da simulação do sistema em malha 

aberta, dado pela Figura 4-9 e é de aproximadamente ???? = 2500 ?. 

Nota-se que este controlador consegue estabilizar o sistema até mesmo com grandes 

aberturas da válvula choke, ou seja, o controlador PI adaptativo apresenta 

desempenho melhor que o controlador PI de ganho estático, visto que proporciona 

maior produtividade para o poço através da menor contrapressão imposta ao 

reservatório pelo fato de operar de maneira estável para maiores aberturas da válvula 

choke. As simulações de resposta ao degrau para o controlador PI adaptativo estão 

mostradas na Figura 4-13. 



 
    92 
 

 

 
Figura 4-13 – Resposta ao degrau de P1 para aberturas da válvula choke variando de 10% a 

50% utilizando um controlador PI adaptativo 

 

A Figura 4-14 mostra a variação do ganho proporcional representada pela linha 

tracejada e do tempo integral representada pela linha cheia, para aberturas da válvula 

choke variando de 10% a 50%. 



 
    93 
 

 

 
Figura 4-14 – Variação do ganho proporcional e do tempo integral do controlador PI adaptativo 

para diferentes aberturas da válvula choke 

 

Para a simulação com o OLGA®, substituiu-se a planta pelo modelo do OLGA® 

utilizando os blocos de escrita e leitura de variáveis no servidor OPC disponíveis no 

Simulink. A configuração do servidor OPC está descrita em detalhes no Apêndice A e 

a implementação no Simulink do controlador PI adaptativo está mostrada no Apêndice 

B.  

A Figura 4-15 mostra o comportamento da pressão de entrada do pipeline P1 em 

malha aberta e após a ativação do controlador PI adaptativo. Nota-se que o sistema 

era oscilatório em malha aberta, para uma abertura fixa da válvula choke em 10%. 

Após aproximadamente 5 h, o controlador foi ligado e o setpoint da pressão P1 fixado 

em 68 bar. A válvula choke iniciou a modulação e foi capaz de reduzir drasticamente 

a oscilação do sistema. Realizou-se a redução do setpoint de pressão em 0,5 bar a 

cada 5 h, nota-se que o controle adaptativo conseguiu manter as oscilações de 

pressão em patamares aceitáveis ao mesmo tempo que proporcionou uma pressão 

média de entrada do pipeline P1 menor que no sistema em malha aberta. A vantagem 

deste controlador para o PI convencional é que o mesmo tem a capacidade de operar 

em ranges maiores da válvula choke, porém este controlador tem a desvantagem de 

depender da disponibilidade da pressão de entrada do pipeline para operar. 



 
    94 
 

 

 
Figura 4-15 – Comportamento da pressão de entrada do pipeline P1 e abertura da válvula 
choke com a utilização do controlador adaptativo PI para diferentes setpoints de pressão 

 

 
4.3.2. Regulador Linear Quadrático com Filtro de Kalman Unscented 

 
Algumas vezes, os sensores de pressão e temperatura localizados no fundo do mar 

sofrem falhas, sendo que, muitas vezes a substituição dos mesmos apresentam 

custos proibitivos. Portanto, é interessante analisar formas de evitar golfadas em 

sistemas pipeline-riser utilizando apenas a medição de pressão no topside. Porém, a 

dinâmica desse sistema possui polos próximos a instabilidade (RHP right half plane), 

(STORKAAS; SKOGESTAD, 2007), além de zeros positivos relativamente próximos 

aos polos instáveis, como exaustivamente demonstrado na seção 4.1, de forma 

prática através dos diagramas de bifurcação. Então, pode-se concluir que a medição 

real da pressão na entrada do pipeline não é uma tarefa simples, pois há excesso de 



 
    95 
 

 

oscilações e ruídos. Uma solução convencional é adotar um observador que utilize a 

pressão do topside em lugar da pressão do pipeline, para estimar os estados não 

disponíveis, incluindo a pressão de fundo (JAHANSHAHI, 2013). Em resumo, algumas 

variáveis são difíceis de serem medidas, portanto é necessário estimar estes estados 

através das saídas do sistema. Os estados estimados podem ser utilizados com 

feedback em substituição dos estados reais do sistema (DUTTON; THOMPSON; 

BARRACLOUGH, 1997).  

O Filtro de Kalman proporciona um bom método de estimar o estado de um sistema 

dinâmico na presença de ruído. Considerando as vantagens expostas na seção 3.4.2, 

adotou-se neste trabalho o filtro de Kalman Unscented. O desempenho do filtro de 

Kalman Unscented é melhorado pela implementação de um fator de esquecimento 

menor que um, com isto, é possível aumentar artificialmente a covariância e o ganho 

? do observador. Porém, com altos ganhos no observador, o sistema se torna mais 

sensível ao ruído. 

Primeiramente, realizou-se a simulação via MATLAB utilizando o modelo linearizado 

como planta. A Figura 4-16 mostra o comportamento das pressões de entrada do 

pipeline P1 e de topo do riser P2. Nota-se que, assim como o controlador PI adaptativo, 

o regulador linear quadrático com filtro de Kalman Unscented é capaz de estabilizar 

as oscilações de pressão em patamares aceitáveis ao mesmo tempo que proporciona 

uma pressão média de entrada do pipeline menor que no sistema em malha aberta. 

Esta abordagem possui a vantagem de funcionar mesmo em caso de falha do sensor 

de fundo e na presença de ruídos na medição das variáveis, porém com ranges de 

aberturas da válvula choke mais restritas que para o caso do controlador PI adaptativo 

com a medição direta da pressão de fundo. 



 
    96 
 

 

 
Figura 4-16 – Pressões P1 e P2 com controlador LQR + Filtro de Kalman Unscented para 

diferentes aberturas da válvula choke 

 

Para a simulação com o software OLGA®, substituiu-se a planta pelo modelo do 

OLGA® utilizando os blocos de escrita e leitura de variáveis no servidor OPC 

disponíveis no Simulink. A configuração do servidor OPC está descrita em detalhes 

no Apêndice A e a implementação no Simulink do regulador linear quadrático com 

filtro de Kalman Unscented está mostrada no Apêndice C. 

A Figura 4-17 mostra o comportamento da pressão de entrada do pipeline P1, pressão 

de topo do riser P2 para a simulação com o OLGA®. Nota-se que, o regulador linear 

quadrático com filtro de Kalman Unscented só é capaz de estabilizar as oscilações de 

pressão para aberturas da válvula choke de até aproximadamente 30%, desempenho 



 
    97 
 

 

próximo do obtido com o PI convencional, esta diferença se dá principalmente pelo 

fato de o PI considerar a presença do sensor de entrada do pipeline e a abordagem 

desta seção considerar apenas a estimativa do sensor, ou seja, apesar do 

desempenho não tão satisfatório, esta abordagem possui a vantagem de funcionar 

mesmo em caso de falha do sensor de fundo e na presença de ruídos na medição das 

variáveis, porém em ranges mais restritos de abertura da válvula choke. 

 
Figura 4-17 – Simulação do OLGA® para as pressões P1  e P2 com o controlador LQR + Filtro 

de Kalman Unscented 

 

  



 
    98 
 

 

5. CONCLUSÕES  

 

O estudo da estabilidade em escoamentos utilizando a válvula choke em plataformas 

offshore de produção de petróleo é um problema bem estabelecido e definido, 

incluindo a modelagem, a análise e a representação matemática, como já descrito no 

presente trabalho.  

Entretanto, a solução de controle ou mitigação dessa instabilidade ainda é um 

problema em aberto. Toda a literatura publicada ou os laboratórios associados2 

apresentam soluções para este problema visando aplicações práticas, com métodos 

teóricos e técnicas de controle relativamente simples, visto que o problema por si só 

já é extremamente complexo. O presente trabalho não poderia ser diferente, 

apresentando soluções de ponto de vista prático com teorias de controle já 

consolidadas.  

Nas seções 4.1 e 4.2, concluiu-se que a dinâmica do modelo simplificado 

implementado no MATLAB representa de forma satisfatória os resultados obtidos no 

simulador OLGA®, possibilitando a adoção do modelo do MATLAB para o projeto dos 

algoritmos de controle desenvolvidos neste trabalho. A implementação dos algoritmos 

de controle foi realizada no MATLAB/Simulink e sua aplicação no modelo do OLGA® 

foi realizada via servidor OPC, que possibilita a interação na válvula choke em tempo 

real. 

A avaliação da eficácia dos métodos de supressão das golfadas, foi realizada através 

de duas abordagens distintas. Inicialmente, utilizou-se um controlador PI adaptativo 

com capacidade de operação em diferentes regiões de aberturas da válvula choke. 

Por fim, utilizou-se um Regulador Linear Quadrático associado a um observador de 

estados com filtro de Kalman Unscented com o objetivo de verificar como o sistema 

                                            
2 Ver por exemplo, grupo da NTNU liderado por Skogestad http://www.nt.ntnu.no/users/skoge/publications/2015/oliveira-ifac-

offshore-2015/patent/NTNU%20Anti-slug%20control_patent_product%20sheet%20(1).pdf; Oil and Gas Engineering Laboratory de 
Univ. Cranfield https://www.cranfield.ac.uk/case-studies/research-case-studies/slug-control; Statoil de Noruega 
http://www.statoil.com/en/technologyinnovation/fielddevelopment/flowassurance/slugcontrol/pages/default.aspx, CENPES de Petrobras 
https://pdfs.semanticscholar.org/09c2/93db97387cfdf832a511df192e4aabb6989c.pdf e  http://www.swge.inf.br/CBA2014/anais/PDF/1569996275.pdf, 
e muito outros centros. 



 
    99 
 

 

se comportaria em caso de necessidade de um observador para compensar uma 

possível falha do sensor submarino de pressão.  

Conforme mostrado na seção 4.3.1, é possível reduzir as oscilações na pressão de 

entrada do pipeline P1 após a ativação do controlador PI adaptativo. Nota-se que o 

sistema era oscilatório em malha aberta, para uma abertura fixa da válvula choke em 

10% mas após a ativação do controlador, a válvula choke iniciou a modulação e 

conseguiu reduzir as oscilações do sistema. Esta estabilização é notada mesmo 

reduzindo-se o setpoint de pressão de entrada do pipeline P1, ou seja, foi possível 

manter as oscilações de pressão em patamares aceitáveis ao mesmo tempo que se 

obteve uma pressão média menor de entrada do pipeline quando comparada ao 

sistema em malha aberta. 

A seção 4.3.2, mostra o desempenho do regulador linear quadrático combinado com 

o filtro de Kalman Unscented. Assim como o controlador PI adaptativo, o regulador 

linear quadrático com filtro de Kalman Unscented foi capaz de estabilizar as oscilações 

porém, o mesmo só é capaz de obter resultados satisfatórios para aberturas da válvula 

choke de até aproximadamente 30%, desempenho próximo do obtido com o PI 

convencional, esta diferença se dá principalmente pelo fato de o PI considerar a 

presença do sensor de entrada do pipeline e regulador linear quadrático considerar 

apenas a estimativa do sensor, ou seja, apesar do desempenho menor, esta 

abordagem possui a vantagem de funcionar mesmo em caso de falha do sensor de 

fundo e na presença de ruídos na medição das variáveis. 

A faixa de operação da válvula choke, tanto para o PI quanto para o LQR, não é um 

problema em si, uma vez que se pode utilizar um sistema supervisório para a decisão 

de controle por faixas (model based switched control) resolvendo essa 

“rangeabilidade” do controlador. Entretanto, do ponto de vista de metodologia, não 

acrescentaria relevância ao presente estudo. Revisitar as técnicas de controle 

adaptativo tanto para o PI quanto para o LQR, aliado ao estado da arte dos Filtros de 

Kalman, atende aos propósitos do presente trabalho. 

Em trabalhos futuros, pode-se avaliar a utilização de novas teorias de controle como 

o controle distribuído de equações diferenciais parciais (PDE based control) ou 



 
    100 
 

 

controle estocástico de sistemas inerentemente estocásticas (ou seja, sem uma 

determinação precisa da variável de saída sendo, portanto, não baseado em 

realimentação do erro, um exemplo é o controle de sistemas quânticos3). Entretanto 

essas incursões teóricas estão além do escopo do presente trabalho. 

 

 

  

                                            
3 Performance Measure for Optimal Quantum Control https://arxiv.org/pdf/1504.03926.pdf 



 
    101 
 

 

REFERÊNCIAS 

 
ASTOLFI, A.; KARAGIANNIS, D.; ORTEGA, R. Nonlinear and Adaptive Control 

with Applications. Springer, 2010. 

ÅSTRÖM, K. J.; WITTENMARK, B. On self-tuning regulators. Automatica. p. 
185-199. 1973.  

ÅSTRÖM, K. J.; WITTENMARK, B. Adaptive Control. Massachusetts, 1989. 

ÅSTRÖM, K. J.; WITTENMARK, B. A. Survey of Adaptive Control applications. 
Proceedings of the 34th IEEE Conference on Decision and Control. p. 649-
654. 1995.  

AUGER, F.; HILAIRET, M.; GUERRERO, J. M.; MONMASSON, E.; ORLOWSKA-
KOWALSKA, T.; KATSURA, S. Industrial applications of the Kalman filter 
A review. IEEE Transactions on Industrial Electronics. p. 60(12), 5458-5471. 
2013.  

BENDIA, R. M. Avaliação econômica de estratégias de controle de golfadas 
no processo de separação de plataformas marítimas. Dissertação de 
Mestrado. UFRJ. Rio de Janeiro. 2013. 

BENDIKSEN, K. H.; MALNES, D.; MOE, R.; NULAND, S. The Dynamic Two-Fluid 
Model OLGA Theory and Application. SPE Production Engineering. p. 171-
180. 1991.  

BILTOFT, J.; HANSEN, L.; PEDERSEN, S.; Z. YANG, Z. Recreating riser 
slugging flow based on an economic lab-sized setup. IFAC International 
Workshop on Periodic Control 5th. p. 47–52. 2013.  

BURKE, N. E.; KASHOU, S. F. Slug sizing/slug volume prediction, state of the 
art review and simulation. Offshore Technology Conference. 1995.  

BURNS, R. S. Advanced Control Engineering. 1ª. ed. Londres Butterworth, 
2001. 

CAMPOS, M.; TAKAHASHI, T. R.; ASHIKAWA, F. H.; N., S. S.; MEIEN, O. F. V.; 
STENDER, A. Advanced anti-slug control for offshore production plants. 
2nd IFAC Workshop on Automatic Control in Offshore Oil and Gas Production. 
Florianopolis. p. 83–88. 2015.  

COURBOT, A. Prevention of Severe Slugging in the Dunbar 16' Multiphase 
Pipeline. Offshore Technology Conference. Houston. 1996.  

CRUZ, S. M. Implementação de um Filtro de Kalman Estendido em 
Arquiteturas Reconfiguráveis Aplicado ao Problema de Localização em 
Robótica Móvel. Dissertação de Mestrado. UnB. Brasília. 2013. 

DUTTON, K.; THOMPSON, S.; BARRACLOUGH, B. The Art of Control 
Engineering. 1ª. ed. 1997. 

FARD, M. P.; GODHAVN, J. M.; SAGATUN, S. I. Modeling of Severe Slug and 
Slug Control with OLGA. SPE International Symposium and Exhibition on 
Formation Damage Control. Lafayette. 2006.  



 
    102 
 

 

GODHAVN, J. M.; FARD, M. P.; FUCHS, P. H. New slug control strategies, 
tuning rules and experimental results. Journal of Process Control 15. p. 
547–557. 2004.  

GREWAL, M. S.; ANDREWS, A. P. Kalman filtering theory and practice using 
Matlab. Wiley, 2008. 

HAVRE, K.; DALSMO, M. Active Feedback Control as a Solution to Severe 
Slugging. SPE Annual Technical Conference and Exhibition. 2002.  

HAVRE, K.; STORNES, K. O.; STRAY, H. Taming slug flow in pipelines. ABB 
Review. 2000.  

JAHANSHAHI, E. Control Solutions for Multiphase Flow Linear and nonlinear 
approaches to anti-slug control. Tese de Doutorado. NTNU. Trondheim. 
2013. 

JAHANSHAHI, E.; OLIVEIRA, V.; GRIMHOLT, C.; SKOGESTAD, S. A 
comparison between Internal Model Control, optimal PIDF and robust 
controllers for unstable flow in risers. Elsevier IFAC Publications. p. 5752-
5759. 2014.  

JAHANSHAHI, E.; SKOGESTAD, S. Simplified Dynamical Models for Control 
of Severe Slugging in Multiphase Risers. 18th IFAC World Congress. 
Milão,. p. 1634–1639. 2011.  

JAHANSHAHI, E.; SKOGESTAD, S. Comparison between nonlinear model-
based controllers and gain-scheduling Internal Model Control based on 
identified model. Proceedings of the IEEE Conference on Decision &amp;amp; Control. 
p. 853-860. 2013.  

JAHANSHAHI, E.; SKOGESTAD, S. Anti-slug control solutions based on 
identified model. J. Process Control. 2015.  

JANSEN, F. E.; SHOHAM, O.; TAITEL, Y. The elimination of severe slugging—
experiments and modeling. Int. J. Multiphase Flow Vol. 22. p. 1055-1072. 
1996.  

JULIER, S. J.; UHLMANN, J. K. A general method for approximation nonlinear 
transformations of probability distributions. Technical report, Robotics 
Research Group, Department of Engineering Science,. 1996.  

JULIER, S. J.; UHLMANN, J. K. A new extension of the kalman filter to non-
linear systems. In: AeroSense: The 11th Internacional Symposium on 
Aerosparce/Defense Sensing, Simulation and Controls. 1997.  

JULIER, S. J.; UHLMANN, J. K. Unscented filtering and nonlinear estimation. 
Proceedings of the IEEE. p. 92(3), 401-422. 2004.  

JUNIOR, H. B. Métodos de Estimação Recursiva Baseados no Filtro de 
Kalman Aplicados a Sistemas Não-Lineares. Dissertação de Mestrado. 
UFMG. Belo Horizonte. 2003. 

KAASA, G. O.; ALSTAD, V.; ZHOU, J.; AAMO, O. M. Nonlinear model-based 
control of unstable wells. Modeling, Identification and Control. p. 69–79. 
2007.  

KANIESKI, J. M. Modelagem e Controle LQR Aplicado a um Condicionador de 
Energia. Dissertação de Mestrado. UTFPR. Pato Branco. 2010. 



 
    103 
 

 

LAGES, W. F. Controle Adaptativo de Sistemas Estocásticos. UFRGS. Porto 
Alegre. 2007. 

LAWRENCE, C.; XU, Z. G.; ANDERSSON, P.; EIDING, H.; HOVDEN, L. .; 
HENRIKSSON, J.; HU, B. Validation of a Physically-Based Model for Slug 
Initiation and Evolution in Hydrodynamic Slug Flow. In 17th International 
Conference on Multiphase Production Technology. BHR Group. 2015.  

MARRELS, I. M. Y.; ANDERSON, B. D. O.; BITMEAD, R. R.; BODSON, M.; 
SASTRY, S. S. Revisition the MIT rule for adaptive control. In Proceedings 
of the 2nd IFAC Workshop on Adaptive Systems in Control and Signal 
Processing. 1986.  

MEGLIO, F. D. Dynamics and control of slugging in oil production. 
Dissertação de Mestrado. MINES ParisTech. Paris. 2011. 

MEGLIO, F. D.; KAASA, G. O.; PETIT, N. A first principle model for multiphase 
slugging flow in vertical risers. Joint 48th IEEE Conference on Decision and 
Control and 28th Chinese Control Conference. 2009.  

MERWE, R. V.; WAN, E. A. Kalman Filtering and Neural Networks cap 7. 
Ontario. John Wiley &amp;amp; Sons, 2001. 

NARENDRA, K. S.; ANNASWAMY, A. M. Stable Adaptive Systems. Dover 
Publications, 1989. 

NARENDRA, K. S.; LIN, Y. H.; VALAVANI, L. S. Stable adaptive controller 
design, part II Proof of stability. IEEE Transactions on Automatic Control. p. 
440–448. 1980.  

OGAZI, A. I.; CAO, Y.; YEUNG, H.; LAO, L. Slug control with large valve 
opening to maximizing oil production. Offshore Europe Oil &amp;amp; Gas 
Conference &amp;amp; Exhibition. 2010.  

OLIVEIRA, C. A. M. Projeto de Observadores de Estado utilizando Algoritmos 
Genéticos. Dissertação de Mestrado. UFERSA. Mossoró. 2014. 

OLIVEIRA, V.; JÄSCHKE, J.; SKOGESTAD, S. An autonomous approach for 
driving systems towards their limit an intelligent adaptive anti-slug 
control system for production maximization. 2nd IFAC Workshop on 
Automatic Control in Offshore Oil and Gas Production. 2015.  

PEDERSEN, S.; DURDEVIC, P.; YANG, Z. Learning control for riser-slug 
elimination and production-rate optimization for an offshore oil and gas 
production process. The 19th World Congress of the International 
Federation of Automatic Control. p. 8522–8527. 2014.  

PEDERSEN, S.; DURDEVIC, P.; YANG, Z. Challenges in slug modeling and 
control for offshore oil and gas productions: A review study. International 
Journal of Multiphase Flow Volume 88. p. 270–284 Jan. 2017.  

PICKERING, P. F.; HEWITT, G. F.; WATSON, M. J.; HALE, C. P. The prediction 
of flows in production risers - truth &amp;amp; myth? IIR Conference. 2001.  

SALES, F. C. S. Análise da Acurácia do Simulador de Escoamento Bifásico 
OLGA em Transientes de Gasodutos. Dissertação de Mestrado. UFRJ. Rio 
de Janeiro. 2013.  



 
    104 
 

 

SASTRY, S.; BODSON, M. Adaptive Control Stability, Convergence and 
Robustness. Dover Publications, 1989. 

SCHLUMBERGER. OLGA User Manual. Dynamic Multiphase Flow Simulator. 
2014. 

SCHMIDT, Z.; BRILL, J.; BEGGS, D. Riser-base gas injection into the se forties 
line. SPE Journal. p. 407–414. 1980.  

SILVA, C. M.; DESSEN, F.; NYDAL, O. J. Dynamic multiphase flow models for 
control. 7th North American Conference on Multiphase Technology. p. 221–
236. 2010.  

SILVA, M. J. S. Controle Adaptativo Aplicado a um Sistema de Bombeamento 
de Água Visando a Redução de Perdas de Energia Elétrica e Água. Tese 
de Doutorado. UFPB. João Pessoa. 2014. 

SIVERTSEN, H.; E. STORKAAS, E.; SKOGESTAD, S. Small-scale Experiments 
on Stabilizing Riser Slug Flow. Chemical Engineering Research and Design. 
p. 213–228. 2010.  

SIVERTSEN, H.; SKOGESTAD, S. Cascade Control Experiments of Riser Slug 
Flow using Topside Measurements. 2005.  

SKOGESTAD, S. Chemical And Energy Process Engineering. CRC Press, 
Taylor &amp;amp; Francis Group, Boca Raton, FL, 2009. 

STORKAAS, E.; SKOGESTAD, S. A simple dynamic model for control design 
and analysis of severe slugging. Multiphase'03. 2003.  

STORKAAS, E.; SKOGESTAD, S. Controllability analysis of two-phase 
pipeline-riser systems at riser slugging conditions. Control Engineering 
Practice 15. p. 567–581. 2007.  

ST-PIERRE, M.; GINGRAS, D. Comparison between the Unscented Kalman 
filter and the extended Kalman filter for the position estimation module 
of an integrated navigation information system. Intelligent Vehicles 
Symposium, 2004 IEEE. p. 831-835. 2004.  

SUN, L.; GAN, J. Researching of two-wheeled self-balancing robot base on 
LQR combined with PID. 2nd International Workshop on Intelligent Systems 
and Applications. p. 1–5. 2010.  

SYRE, T. V. Anti-Slug Control with Non-Linear State Estimation. Dissertação 
de Mestrado. NTNU. Trondheim. 2012. 

TAITEL, Y. Stability of severe slugging. Int. J. Multiphase Flow Vol. 12. p. 203-
217. 1986.  

THRUN, S.; BURGARD, W.; FOX, D. Probabilistic Robotics. The MIT Press, 
2005. 

UYGUN, K.; MATTHEW, H. W. T.; HUANG, Y. FBA-LQR An optimal control 
approach to flux balance analysis. Industrial e Engineering Chemistry 
Research. p. 8554–8564. 2006.  

WAN, E. A.; MERWE, R. V.; NELSON, A. T. Dual Estimation and the Unscented 
Transformation, volume Neural Information Processing Systems. p. 666-
672. 2000.  



 
    105 
 

 

YOCUM, B. Offshore riser slug flow avoidance Mathematical models for 
design and optimization. SPE European Meeting. Londres,. p. SPE 4312. 
1973.  

ZAKARIAN, E.. Analysis of two-phase flow instabilities in pipe-riser systems. 
In: Proceedings of the ASME pressure vessels and piping conference, Seattle. 
2000. 

ZHOU, J.; KAASA, G. O.; AAMO, O. M. Nonlinear adaptive observer control for 
a riser slugging system in unstable wells. American Control Conference 
Westin Seattle Hotel. Seattle. 2008.  

  



 
    106 
 

 

APÊNDICE A 

 

Integração MATLAB com o OLGA® 

 

Utilizou-se o servidor OPC para viabilizar a comunicação entre os softwares OLGA® e 

MATLAB. Abaixo, seguem descritos o passo a passo para configurar o servidor. 

Após a modelagem do sistema no software OLGA®, realiza-se a configuração servidor 

OPC através do item “SERVEROPTIONS”. Nesta tela, é necessário preencher as 

opções básicas do servidor OPC conforme mostrado na Figura A-1. 

 

 

Figura A-1 – Tela de configurações básicas do servidor OPC no OLGA ® 

 

O próximo passo consiste em expor no servidor OPC, as variáveis desejadas para 

leitura e escrita, isto é realizado incluindo itens “SERVERDATA” nas saídas do 



 
    107 
 

 

modelo.  Cada variável deve ser configurada individualmente conforme mostrado na 

Figura A-2. 

 

Figura A-2 – Tela de configuração das variáveis a serem expostas no servidor OPC 

 

O passo seguinte consiste em iniciar a simulação do modelo em modo “batch” 

conforme mostrado na Figura A-3. 

 

Figura A-3 – Barra de tarefas para início da simulação em “batch” 

 
 
Ao iniciar a simulação em modo “batch”, a tela de status da simulação é aberta, 

mostrando os dados de registro do servidor OPC e o tempo decorrido de simulação, 

conforme mostrado na Figura A-4.  

 



 
    108 
 

 

 

Figura A-4 – Tela de status da simulação 

 

Nesta etapa, o servidor OPC já está registrado e o OLGA® já está enviando e 

recebendo dados do servidor. O próximo passo consiste em realizar a configuração 

do MATLAB para que a comunicação seja estabelecida por completo. A configuração 

do servidor do MATLAB pode ser realizada via Simulink, através do bloco “OPC 

Configuration”. Ao abrir as configurações do bloco em questão, é possível conectar 

ao servidor recém registrado, estabelecendo a comunicação conforme mostrado na 

Figura A-5. 

 

 

Figura A-5 – Tela de configuração do bloco do Simulink “OPC Configuration” 

 

 



 
    109 
 

 

Por fim, basta adicionar no Simulink, os blocos de escrita e leitura do servidor OPC e 

escolher as variáveis desejadas. Estes blocos estão disponíveis na biblioteca do OPC 

Toolbox do Simulink conforme mostrado na Figura A-6. 

 

Figura A-6 – Blocos do Simulink para leitura e escrita de variáveis do servidor OPC 

 

 

  



 
    110 
 

 

APÊNDICE B 

 

Implementação do controlador PI adaptativo no Simulink 

 

Primeiramente, implementou-se o controlador adaptativo no Simulink utilizando como 

planta, o modelo linearizado para a abertura da válvula choke em 10%, obtendo-se 

assim, a função de transferência com a abertura z da válvula choke como entrada e a 

pressão de entrada do pipeline P1 como saída.  

A implementação do algoritmo de adaptação se deu através da criação de uma função 

no MATLAB que contém as equações mostradas na seção 4.3.1. Esta função utiliza 

como entrada a abertura z da válvula choke e como saída os ganhos proporcional Kc 

e integral Ki, que por sua vez são entradas do controlador PI adaptativo. 

 
Figura B-1 – Diagrama Simulink do controlador PI adaptativo utilizando o modelo linearizado 

do MATLAB  

 
 
Após a implementação utilizando a função de transferência linearizada do MATLAB, 

realizou-se a implementação do sistema utilizando a planta do OLGA® como sistema 

a ser controlado. Para isto, utilizou-se blocos do Simulink para escrita e leitura de 

variáveis de forma a possibilitar a troca de informação entre os dois softwares. 

  



 
    111 
 

 

 

 
Figura B-2 – Diagrama Simulink do controlador PI adaptativo utilizando o modelo do OLGA®  

 

 
Código do MATLAB para o algoritmo de adaptação 
 
function [Kc,Ki]=fcn(Z) 
wG_in0 = 0.36; %vazão de entrada gás 
wL_in0 = 8.64; %vazão de entrada líquido 
beta=0.061; 
tosc=2500; %segundos 
z_critico=0.07; 
T2= 2.903e+02; 
rho_L= 8.322e+02; 
R= 8314; 
M_G= 23; 
w=9; 
Cv=1.16e-2; 
P2_t = 57.8e5; 
rho_G2=P2_t*M_G/(R*T2); 
d=((wG_in0*rho_G2+wL_in0*rho_L)/w)/1000; %densidade da mistura 
a=(1/d)*(w/Cv); 
kz=-2*a/(Z^3); 
Kc = beta*tosc/(kz*(abs(Z/z_critico))^0.5); 
Ti = 3*tosc*(Z/z_critico); 
Ki=1/Ti; 
end 
 

  



 
    112 
 

 

APÊNDICE C 

 
Implementação do regulador linear quadrático (LQR) com Filtro de Kalman 

Unscented 

 

Primeiramente, implementou-se o regulador linear quadrático (LQR) com Filtro de 

Kalman Unscented no Simulink utilizando como planta, o modelo linearizado para a 

abertura da válvula choke em 10%, obtendo-se assim, a função de transferência com 

a abertura z da válvula choke como entrada e a pressão de entrada do pipeline P1 

como saída conforme mostrado na Figura C-1.  

 

Figura C-1 – Diagrama Simulink do regulador linear quadrático (LQR) com Filtro de Kalman 
Unscented (UKF) utilizando o modelo linearizado do MATLAB  

 

 
Posteriormente, realizou-se a implementação do sistema substituindo o modelo do 

MATLAB pela planta do OLGA®. Para isto, utilizou-se blocos do Simulink para escrita 

e leitura de variáveis de forma a possibilitar a troca de informação entre os dois 

softwares conforme mostrado na Figura C-2. 



 
    113 
 

 

 
Figura C-2 – Diagrama Simulink do regulador linear quadrático (LQR) com Filtro de Kalman 

Unscented (UKF) utilizando o modelo do OLGA®  

 
 
 
Código do MATLAB para o regulador linear quadrático 
 
Q_lqr=1e-3*diag([1 0 1 0]); 
R_lqr=1e9; 
N_lqr=zeros(4,1); 
[K_lqr,S,e] =dlqr(F,B,Q_lqr,R_lqr,N_lqr); 
u_c(k-1)=-K_lqr*x(:,k-1); 
if(u_c(k-1)&lt;-u_pc(k-1)); 
u_c(k-1)=-u_pc(k-1); 
end 
if(u_c(k-1)&gt;(1-u_pc(k-1))); 
u_c(k-1)=1-u_pc(k-1); 
end 
 
 
 
  



 
    114 
 

 

ANEXO A 

 
 



 
    115 
 

 

 



 
    116 
 

 

 



 
    117 
 

 

 



 
    118 
 

 

 



 
    119 
 

 

 



 
    120 
 

 

 



 
    121 
 

 

 



 
    122 
 

 

ANEXO B 

 



 
    123 
 

 

 
 



 
    124 
 

 

 
 
 
 
 
 



 
    125 
 

 

 
 
 



 
    126 
 

 

 
 
 



 
    127 
 

 

 



0 
 

BIOGRAFIA 
 
 
 

No ano de 2008, se formou em Engenharia Elétrica na UNESP -  

Universidade Estadual Paulista "Júlio de Mesquita Filho" – Campus 

de Ilha Solteira. 

 

Em 2009, entrou para a Petrobras como Engenheiro de Petróleo. Realizou 

treinamento interno no CEP - Curso de Engenharia de Petróleo na Universidade 

Petrobrás em Salvador-BA. Em 2010, finalizou pós-graduação obtendo o título de 

especialista em Engenharia de Petróleo.  

 

Ainda em 2010, se mudou para Macaé-RJ, onde trabalhou na operação onshore e 

offshore de plataformas de petróleo da Bacia de Campos.  

 

Em 2011, se mudou para Santos-SP, onde exerce atualmente o cargo de Engenheiro 

de Petróleo na base de operações do FPSO Cidade de Santos que produz os campos 

de Uruguá e Tambaú, na Bacia de Santos. Neste período, participou de 

comissionamentos de poços de petróleo e gás natural, manifolds submarinos, 

unidades de injeção de água dessulfatada dentre outras atividades. Em suas 

atividades cotidianas elaborou e revisou procedimentos de partida e parada de poços, 

participou de estudos para otimização operacional, análises de risco e planejamento 

de paradas programadas. Pelas atividades desenvolvidas, tem contato com os 

desafios tecnológicos de onde surgem seus interesses acadêmicos. Como exemplos, 

tem-se a participação conjunta com a equipe da Petrobras em projetos de otimização 

de produção por controle de bandas de nível dos vasos separadores de plataformas, 

controle de golfadas dentre outros. 

 

Seus interesses atuais são as ferramentas e métodos que permitam aumentos na 

eficiência de produção com redução de custos através dos menores tempos de parada 

operacional, menor consumo de diesel em poços e garantia de integridade de 

equipamentos, estando alinhado com as diretrizes estratégicas da companhia. 

 

 


</field>
	</doc>
</add>