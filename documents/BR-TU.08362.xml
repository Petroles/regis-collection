<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08362</field>
		<field name="filename">13196_Ana_Julia_Righetto_versao_revisada.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
University of São Paulo
“Luiz de Queiroz” College of Agriculture

The impact of choosing different meshes under INLA/SPDE
framework for geostatistical modelling

Ana Julia Righetto

Thesis presented to obtain the degree of Doctor in Sci-
ence. Area: Statistics and Agricultural Experimenta-
tion

Piracicaba
2017



Ana Julia Righetto
Degree in Statistics

The impact of choosing different meshes under INLA/SPDE
framework for geostatistical modelling
versão revisada de acordo com a resolução CoPGr 6018 de 2011

Adviser:
Prof. Dr. PAULO JUSTINIANO RIBEIRO JUNIOR

Thesis presented to obtain the degree of Doctor in Science.
Area: Statistics and Agricultural Experimentation

Piracicaba
2017



2

Dados Internacionais de Catalogação na Publicação
DIVISÃO DE BIBLIOTECA - DIBD/ESALQ/USP

Righetto, Ana Julia
The impact of choosing different meshes under INLA/SPDE framework

for geostatistical modelling/ Ana Julia Righetto. – – versão revisada de acordo
com a resolução CoPGr 6018 de 2011. – – Piracicaba, 2017 .

95 p.

Tese (Doutorado) – – USP / Escola Superior de Agricultura “Luiz de
Queiroz”.

1. Geoestatística 2. INLA 3. SPDE 4. Malhas . I. Título.



3

DEDICATORATION

To my parents,
Edison Righetto and Luzia Francisca Pedrazzi Righetto, for all support and encouragement.

To my boyfriend,
Thiago Gentil Ramires for always being by my side.

To them,
I dedicate this work.



4

ACKNOWLEDGMENTS

I have so much to thank for...
I thank my God and ’Santo Expedito’ for giving me faith enough to believe and reach my

dreams.
To my parents, Edison Righetto and Luzia Francisca Pedrazzi Righetto, I have no words to

thank for all the support, love and encouragement. You are examples of human beings and I am very
grateful to have you in my life. Having your support during all my life was fundamental. Thank you,
Thank you, Thank you! I love you very much! Shalom Eilechem!

To all my family, thank you for all cheer for this achievement. Special thanks to my grandmother
Laura Righetto who fulfilled our agreement.

To my advisor Paulo Justiniano, thank you very much for all these years of partnership, that
began during my master’s degree. Thank you for all the help, guidance and support. It was an honor to
work under your supervision.

For my advisor in Belgium, Christel Faes, thank you for being so receptive and for having
magnified my work. It was a pleasure to meet you and work with you. Dank you!

To Yannick Vandendijck, who along with Christel, did not measure efforts to help me. Dank
you!

For all LEG/UFPR staff, who have always been helpful to me and a special thanks to Elias
Krainski, who helped me in defining the theme of my PhD and was always very attentive.

To my boyfriend, Thiago Gentil Ramires, my life partner and academic. Thank you for all the
encouragement and for always be there. ’Meu Fifu’!

To my friends Rodrigo Pescim, Luiz Ricardo Nakamura, Mariana Ragassi, Everton Batista,
Pedro Henrique Cerqueira, Camila Cerqueira, Taciana Savian, Heber Alvarenga, Antonia Alvarenga,
Lucélia Borgo, Flávio Rabelo, Débora Robert de Godoi, Ezequiel Lopez, Everton Hanser, Lucas Cunha,
Guilherme Biz, Cássio Dessotti, Alexandre Lavorenti, Djair Frade, Natalie Veronika, Maria Joseane,
Thiago Oliveira, thank you for the friendship, for all the help and for making postgraduate life less
stressful.

To my friends since always Aline, Thais, Gisele, Marília, Rannay, Ana Cláudia, Leticia, Karine,
Iara, Jenifer, Ariany, Juliana, Pérola thank you for the sincere friendship and constant presence in my
life.

A special thanks to Suelen Monteiro, who closely followed all the development of my doctorate
and has always been a friendly shoulder even with all physical distance between us.

To my friends Amanda Ferro, Vanessa Sehaber, Daniel Grados, Paula Carvalho, Elizabeth
Hashimoto, Mariele Queiroz, Fabiana Watanabe, Gabriel Batalini, Tatiana David, Karina Loureiro,
Lysandra Fernandes, thank you for all the talk and distraction.

To the Xibiu family, Rafael Jacomini, Pedro Lian, Andre Sanches, Henrique Gioia, Karina
Ferracioli, Tâmara Zago, Ana Paula Teles, Fernanda Galende, Augusto Seabra, Gustavo Giachini, thank
you for all the barbecues and conversations. We are all Xanxi!

To my friends from Belgium, Shah Rukh Sajid (my panda friend), Svitlana, Gilani, Tooba,
Amena, Sarmad, Shahram, Farhan, Muhammad Shaker, Stefani (Peffi Wie), thank you for helping me
to have a more pleasure life during my stay in Belgium. My Belgium gift for all my life.

To all professor from the Department of Exact Science at ESALQ/USP, Prof. Dr. Roseli
Aparecida Leandro, Prof. Dr. Taciana Villela Savian, Prof. Dr. Carlos Tadeu, Prof. Dr. Gabriel Adrián
Sarriés, Prof. Dr. Silvio Sandoval Zocchi, Prof. Dr. Sonia Maria De Stefano Piedade, Prof. Dr. Cristian
Marcelo Villegas Lobos, Prof. Dr. Idemauro Antonio, Prof. Dr. Renata Alcarde, Prof. Dr. Edwin



5

Moises Marcos Ortega, for all the support, teaching, wisdom and dedication in those years and a special
thanks to Profa. Dr. Clarice Demétrio, who played a key role in my trip to Belgium.

To all colleagues in the department, specially Fernando Mayer, Renan Pinto, Maria Cristina,
Ricardo Klein, Reginaldo Hilário e Andreia Hilário, thank you for the friendship and for all the knowledge
exchanged.

To the staff of the Department of Exact Science at ESALQ/USP, the secretary Luciane Brajão,
and the computer technicians Eduardo Bonilha and Jorge Wiendl. Thank you for all the help. A special
thanks to secretary Solange Sabadin. Thank you, Sô, for all the help. You are very special to me.

To Geert Molenberghs, Martine Machiels, Marc Thoelen, Chantal Brodie, Kevin Watjou and
Maren Vranckx, for all the help during my stay in Belgium.

To Nani (in memmoriam), Rebeca, Lilica, Negao and Pingo. My four legged hairy, thank you
for your loyalty and for helping me lead a lighter life.

To GCAA (’Grupo de Controle de Animais Abandonados no Campus’), thank you for having
been my therapy in Piracicaba since 2014. I hope that all dogs find a home.

To CAPES and CNPq, for financial support.
And finally, a special thanks to myself for never giving up!



6

CONTENTS

Resumo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2 On the choice of the mesh for the analysis of geostatistical data using R-INLA . . . . . . . . . . 13

2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.2 INLA and SPDE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

2.2.1 Model fitting and predictive information criteria . . . . . . . . . . . . . . . . . . . . 16
2.3 Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

2.3.1 Simulation Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.3.2 Impact of mesh on inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.3.3 Selecting the best mesh . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.4 Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
2.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
3 A simulation study with different meshes for geostatistical data with random, cluster and regular

grids. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
3.2 Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

3.2.1 Goodness of fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
3.3 Simulation Study . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.3.1 Simulation Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
3.4 Data Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
3.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
4 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
APPENDICES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59



7

RESUMO

O impacto na escolha de diferentes malhas em modelagem geoestatística sob a abordagem
INLA/SPDE

Métodos de estatística espacial são amplamente utilizados, uma vez que várias áreas do
conhecimento, como ciências ambientais, geologia, agronomia, entre outros, envolvem a compreensão
da distribuição espacial de processos a partir de dados referenciados espacialmente. Com o avanço dos
Sistemas de Informação Geográfica e dos Sistemas de Posicionamento Global, esse uso foi ampliado.
Muitos métodos utilizados na estatística espacial são computacionalmente exigentes e, portanto, o
desenvolvimento de métodos mais eficientes recebeu muita atenção nos últimos anos. Um desenvolvi-
mento importante foi a introdução do método de aproximação de Laplace aninhado integrado, capaz
de realizar análises Bayesianas de forma mais eficiente. O uso deste método para dados geoestatísti-
cos é comumente feito considerando a abordagem de equações diferenciais parciais estocásticas que
requer a criação de uma malha que cobre a área de estudo. Este é o primeiro e um importante passo,
pois todos os resultados dependerão da escolha desta malha. Como não existe uma maneira formal
e direta de especificar a malha, investigamos possíveis diretrizes sobre como uma malha adequada é
escolhida para um problema específico. Através de estudos de simulações, tentamos criar diretrizes
para a construção da malha para conjunto de dados aleatórios, regulares e de cluster e aplicamos
essas diretrizes em conjunto de dados reais.

Palavras-chave: Geoestatística; INLA; SPDE; Malhas



8

ABSTRACT

The impact of choosing different meshes under INLA/SPDE framework for geostatistical modelling

Spatial statistics methods are widely used since several areas of knowledge such as en-
vironmental sciences, geology, agronomy, among others, involve the understanding of the spatial
distribution of processes from spatially referenced data. With the advancement of Geographic In-
formation Systems and the Global Positioning Systems this use has been extended. Many methods
used in spatial statistics are computationally demanding, and therefore, the development of more
computationally efficient methods has received a lot of attention in recent years. One such important
development is the introduction of the integrated nested Laplace approximation method which is able
to carry out Bayesian analysis in a more efficient way. The use of this method for geostatistical data
is commonly done considering the stochastic partial differential equation approach that requires the
creation of a mesh overlying the study area. This is the first and an important step since all results
will depend on the choice of this mesh. As there is no formal and close way to specify the mesh,
we investigate possible guidelines on how a suitable mesh is chosen for a specific problem. Through
simulations studies, we tried to create guidelines for the construction of the mesh for random, regular
and cluster data set and we aplly this guidelines in real data set.

Keywords: Geostatistics; INLA; SPDE; Meshes



9

1 INTRODUCTION

The understanding of the spatial distribution of data from phenomena occurring in space is a
major challenge to clarify key issues in various areas of knowledge, such as health, environment, geology,
agronomy, among many other areas. Such studies are becoming increasingly common, due to advances
in Geographic Information Systems (GIS) and Global Positioning Systems (GPS), which are related to
spatial information systems, as well as advances in computational procedures that enable and facilitate
the analysis or representation of space and phenomena that occur in it. Thus, there is growing interest
in analyzing and fit models to georeferenced data.

Spatial statistics methods are intended to measure properties and relationships, taking into
account the spatial location of the studied phenomenon. This area of statistics is didactically divided
into three sub-areas: geostatistics (point referenced data), area data (area referenced data) and poit
process. Different statistical methods are used to analyze and describe the data for each of these sub-
areas. This work will emphasizes the sub-area of geostatistics, which incorporates the interpretation of
the statistical distribution and the spatial correlation of the samples. According to Matheron (1963),
geostatistics is the application of the formalism of random functions for the recognition and estimation
of natural phenomena.

In geostatistical analysis, the data consist of measurements y1,..,yn obtained in locations s1,..,
sn sampled from a spatially continuous region A ? Rd. These measurements are associated to a spatial
phenomenon, treated as the realization of a stochastic process X(s), s ? Rd which is not directly observed,
given by any set of random variables Y (s), s ? Rd, defined in a common probability space.

Considering a latend Gaussian random field X(s) over the study region A, it is necessary to
perform a sampling, in n locations, to obtain values of the variable of interest, Y(s) of dimension n, from
the values observed in the sampled locations s = (s1, .., sn). The basic model is given by

Y (s) = µ + X(s) + ?, (1.1)

in which ? is the white noise, µ = D?, where D is a matrix of covariates and ? is a q-dimensional vector
of parameters and X(s) is a Gaussian random field, with vector of null mean and covariance matrix ?
taking into account some correlation function.

With geostatistical techniques it is possible to describe the spatial dependence structure of
the data, establishing a spatial correlation function that depends only on the distance of the position
of the samples and represents the behavior of the spatial variability of the data, using a model. In
order to analyze the spatial dependence of a random variable, the geostatistical model is based on the
covariance or semivariance function and, according to Mello et al. (2005), these functions are important
for the definition of the spatial variability structure and the interpolation of values by kriging, obtaining
minimal errors in the interpolation and enabling the construction of thematic maps. The covariances
are functions of the distance between observations and usual models for the covariance functions are the
spherical, exponencial, gaussian, Mate?rn, among others.

The log-likelihoog for the model (1) is given by

L(?) = ?
1

2
(nlog(2?) + log(|?|) + (y ? µ)

?
??1(y ? µ)).

The computations that involves the covariance matrix is costly as it depends on the covariance function,
which depends on the distances of the locations. This cost also appears on the predictions, so it is
necessary to choose wisely the covariance function.

According to Bolin and Lindgren (2013), traditional methods in spatial statistics were typically
developed without any consideration of computational efficiency and, in many applications, the cost of
taking measurements limits the sample size in which the required computational cost is not a problem.



10

However, with the increasing use of GIS and GPS, which produce large data sets, computational efficiency
is of the utmost importance.

Somethimes the inference, as is usually done in the classical approach, may present problems
especially in the estimation of variance components, since the inference process is based on the asymptotic
distribution of the maximum likelihood estimators. As a solution to this, it is common to propose the use
of the Bayesian approach, which allows the updating of information. However the Bayesian approach still
requires the demanding computations related to the covariance matrix in the likelihood and specification
of more realistic priori in order to make the model identifiable. In recent years, a new method has been
proposed by Rue, Martino and Chopin (2009), called Integrated Nested Laplace Approximation (INLA),
which is a computationally effective alternative to methods based on Markov Chain Monte Carlo (MCMC)
algorithms.

According to Lindgren and Rue (2015), INLA is designed for latent Gaussian models, a very
broad and flexible class of models, ranging from a mixed (generalized) linear model to spatial and
temporal-spatial models. In the spatial setup it can be combined with the approach of Stochastic Partial
Differential Equation (SPDE) (Lindgren, Rue and Lindstrom, 2011), one can accommodate georeferenced
data from all sub-areas of spatial statistics.

A Gaussian field (GF) is is the key component in geostatistical modeling and it is important
when specifying hierarchical spatial models. According to Lindgren, Rue and Lindstrom (2011), the
covariance function specification of an intuitive interpretation of the field properties, as regards compu-
tational efficiency, impairs the GF because the cost of factoring dense matrices is cubic in dimension.
When a GF satisfies the Markov property (conditional independence), it will be considered a Gaussian
Markov random field (GMRF).

Consider the graph G = (V, E), in which V = {1, ..., n} and E is defined by xi?xj|x?i,j, meaning
that there is no edge between the knots i and j. Rue and Held (2005) define a GMRF as a random vector
x = (x1, ..., xn)

?
? Rn which follows a multivariate normal distribution and satisfies the Markov property.

Also, the GMRF, with mean vector µ and precision matrix Q &gt; 0, in which Q = ??1, will be with
respect to the graph G = (V, E), with the condition that Qij ?= 0 ? i, j ? E for all i ?= j and that its
density will be:

?(x) = (2?)
? n

2 |Q|
1
2 exp

(
?
1

2
(x ? µ)

?
Q(x ? µ)

)
. (1.2)

According to Lindgren, Rue and Lindstrom (2011), GMRF is a discretly indexed Gaussian field
in which the complete conditionals of ?(xi|x?i), which x?i represents all elements of x except the ith,
depend only on a set of neighbors ?i for each place i, i = 1, ..., n and this generates a computational gain
due to the zero standard in the precision matrix Q. The GMRF is widely used in hierarchical models
because it allows stochastic dependence among a set of unknown parameters. This hierarchy is done in
three steps, in which the unknown hyperparameters ? specify a GMRF. In this way, x is connected to
the data y and it is usually assumed that y is conditionally independent of x. Considering a simple case,
each yi depends only on xi and, in this way, the two vectors have the same dimension. The three steps
of the hierarchy are given by:

? ? ?(?) (1.3)

x ? ?(x|?)

yi ? ?(yi|xi),

thus, a posteriori distribution is given by ?(x, ?|y) ? ?(?)?(x|?)
?n

i=1 ?(yi|xi).



11

Empirically, Rue and Tjelmeland (2002) have demonstrated that it can be found a GMRF
which can approximate a GF for most of the common covariance functions used in geostatistical analysis
and have proposed using GMRF instead of GF precisely because of computational issues. This proposal
has shown problems since the adjustment of GMRF to GF was restricted to the regular grid. In this way,
this approach implies some restrictions because, according to Lindgren, Rue and Lindstrom (2011), the
modeling must be done with a GF in a set of locations {si} and one must construct a GF with matrix of
covariance ? of which there is a GMRF with local neighborhood and precision matrix Q, such that Q?1

is close to ? and computations should be performed with the GMRF by numerical methods for sparse
matrices.

Following the requirements from the proposal of Rue and Tjelmeland (2002), Lindgren, Rue and
Lindstrom (2011) have demonstrated that these it can be satisfied for some GF members when using the
Mate?rn covariance function, where the GMRF representation is explicit. The GMRF construct can be
done using a certain SPDE that has GF with Mate?rn covariance function as the solution when triggered
by a Gaussian white noise. The result is given by a basic function representation with parts-based linear
functions and Gaussian weights with Markov dependencies determined by general domain triangulation.
This triangulation is called mesh.

Currently, the INLA method has received considerable importance due to its precision and
computational speed. When used in conjunction with SPDE for geostatistical models, it is necessary to
generate a mesh, formed by junctions of triangles, under the study region and, in addition, the precision
of the parameter estimates, as well as the prediction of the final model, will depend on this mesh. A set
of attributed needs to be carefully chosen on order to create a suitable mesh: set values for the edges
of the triangles inside the mesh (which encompasses the study region), for the edges of the outer mesh
(outside the study region, to avoid edge effect) and for the smallest permitted distance between the edge
junctions (knots). Each change in these values implies more or less knots in the mesh, which implies
more or less computational burden.

In this work we named by a the maximal allowed lengths of triangle edges in the inner domain,
by b the maximal allowed lengths of triangle edges in the outter domain and by c the shortest distance
allowed between points. Different combinations of this three values, generate different meshes, as we
can see in Figure 1.1. where meshes were generate with b = 0.03 and with a = (0.02, 0.08, 0.14) and
c = (0.002, 0.03) As we increase the value of a and c, we get meshes with less triangle and different mesh
gives different results in the analysis.

Bolin and Lindstro?m (2014), raise concerns about the importance of using the appropriate mesh
and how a simple change in the mesh can affect the result of the analysis. Then, following up on these
issues, the main objective here is to try to find a way to create the more suitable mesh for different types
of georeferenced data (regular grid, irregular grid or data with clusters), through a simulation study.

In this context, in Chapter 2 we reports results of a simulation study, for random data with
different sample sizes, to investigate the most appropriate mesh, in which the meshes were generated
taking into account the sample locations and changing some parameters for the creation. In Chapter 3,
we fixed the sample size and focus on different types of data, being them regular, irregular and cluster
data. For each type of data, were considered different parameter values to generate the meshes as well
as different ways to define the knots. Chapter 4 shows an overall conclusion.

References

Bolin, D.; Lindgren, F. A comparison between Markov approximations and other methods for large
spatial data sets. Computational Statistics &amp;amp; Data Analysis, v. 61, p. 7-21, 2013.



12

(I) (II)

(III) (VI)

Figure 1.1. Generate meshes with b = 0.03 different values of (a, c) given by I) (0.02, 0.002),
II)(0.08, 0.002), III) (0.08, 0.03) and IV) (0.14, 0.03).

Bolin, D. Lindstrom, J. Spatial Statistics using R-INLA and Gaussian Markov random fields. Pan-
American Advanced Study Institute, 15:29:57Z, rev.3691, 2014.

Lindgren, F.; Rue, H. Bayesian Spatial Modelling with R-INLA. Journal of Statistical Software, v.
63, 2015.

Lindgren, F.; Rue, H.; Lindstrom, J. An explicit link between Gaussian fields and Gaussian Markov
random fields: the stochastic partial differential equation approach. Journal of the Royal Statistical
Society, v. 73, p. 423-498, 2011.

Matheron, G. Principles of geostatistics. Economic Geology, Austin, v. 58, p. 1246-1266, 1963.

Mello, J. M.; Batista, J. L. F.; Ribeiro Jr, P. J.; Oliveira, M. S. Ajuste e seleção de modelos espaciais
de semivariograma visando à estimativa volumétrica de Eucalyptus grandis. Scientia Florestalis,
Piracicaba, v.1, n. 69, p. 25-37, 2005.

Rue, H.; Martino, S.; Chopin, N. Appriximate Bayesian inference for latent Gaussian models by using
integrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society
- Series B, v.71, Part 2, p.319-392, 2009.

Rue, H.; Tjelmeland, H. Fitting Gaussian Markov random fields to Gaussian fields. Scand. J. Statist,
v. 29, p. 31-50, 2002.



13

2 ON THE CHOICE OF THE MESH FOR THE ANALYSIS OF GEOSTATISTICAL
DATA USING R-INLA

Abstract: Spatial statistics are useful to measure properties and relationships of a ge-
ographically studied phenomenon. Many methods used in spatial statistics are computationally
demanding, and therefore, the development of more computationally efficient methods has received
a lot of attention in recent years. One such important development is the introduction of the inte-
grated nested Laplace approximation method which is able to carry out Bayesian analysis in a more
efficient way. The use of this method for geostatistical data is commonly done considering the SPDE
approach that requires the creation of a mesh overlying the study area. This is an important step in
the analysis since the obtained results depend on the choice of this mesh. Here, the impact of the
mesh on inference and prediction is investigated through simulation studies. As there is no formal
procedure to specify the mesh, we investigate possible guidelines on how an optimal mesh is chosen.
Through a simulation study, with random data set, different meshes were created, considering the
sample locations as starting point for the knots of the mesh. An application using rainfall data in
Parana? state, Brazil, is presented.
Keywords: Geostatistics; Integrated nested Laplace approximation; Mesh; Stochastic partial differ-
ential equation.

2.1 Introduction

Models in spatial statistics are used to measure properties and relationships of a geographi-
cally measured outcome, explicitly taking into account the spatial locations of the studied phenomenon.
Traditional methods in spatial statistics were developed without the consideration of computational ef-
ficiency, as in many applications the sample size was limited due to the cost involved in obtaining the
measurements (Bolin and Lindgren, 2013). Nowadays, however, with the increasing use of geographic
information systems and global positioning systems, large data sets are becoming available, and compu-
tational efficiency has become extremely important.

Geostatistical data are widely analyzed using the kriging method, an optimal interpolation
method employing the spatial autocorrelation to derive predictions at unmeasured locations (Gelfand et
al., 2010). A popular choice to estimate the statistical dependence is the Mate?rn family of covariance
functions, which includes, for example, the exponential and Gaussian covariance functions, as particular
cases. For inference, it is common to use the Bayesian framework, which is based on the observed data
only and easily allows for sequential updating of information. Sampling methods such as Markov Chain
Monte Carlo (MCMC) are well known in Bayesian inference, but demand intense computation time.

As an alternative to the computational intensive MCMC methods, Rue, Martino and Chopin
(2009) proposed the use of integrated nested Laplace approximations (INLA). INLA is an approximate
method designed for inference of latent Gaussian models, a very wide and flexible class of models ranging
from (generalized) linear mixed model to spatial and spatio-temporal models (Lindgren and Rue, 2015).
When combined with stochastic partial differential equation (SPDE) (Lindgren, Rue and Lindstrom,
2011), it can accommodate georeferenced data from all sub-areas of spatial statistics (geostatistics, lattice
data and point processes). Recently, INLA has received considerable attention due to its accuracy and
computational speed (Karagiannis et al., 2013; Lindgren, 2012).

The SPDE approach approximates the Gaussian field using a Gaussian Markov random field.
For geostatistical data, the spatial field is described using a weighted sum of piece-wise linear basis function
that is ussually defined from a triangularisation of the study area, called the mesh. The accuracy of the
estimates as well as the predictions will depend on the mesh specification. The idea is that smaller



14

triangles will increase the accuracy, though when the spatial range is larger, larger triangles can be used.
The mesh can be constructed using different principles. A common method, using R-INLA, is to use the
locations of the measurements as initial triangulation vertices, and add or remove knots according to the
size for the edges of the triangles of the inside mesh (which includes the study region), for the edges of the
outer mesh (outside the study area, to avoid border effects) and to the shortest distance allowed between
the junctions of the edges (knots). Each combination of these three values implies a certain number of
knots on the mesh, and more knots can increase in the computational cost. While it has been indicated
that the choice of the mesh must be done carefully (Lindgren and Rue, 2015), no conclusive way to create
the best mesh has been described.

As the analysis depends on the chosen mesh, the objective of this work is to extensively study
the parameters for the creation of the mesh, to see their impact on the analysis and set guidelines to
construct the optimal mesh in two dimensional spatial domains, for irregular geostatistical data, solving
some issues raised by Bolin and Lindstrom (2014). In Section 2.2 , we give a brief introduction to INLA
and the SPDE approach and discuss some criteria to evaluate the mesh. A simulation study is performed
in Section 2.3 and an application with real data set is provided in Section 2.4. A discussion is provided
in Section 2.5.

2.2 INLA and SPDE

INLA is a deterministic method to perform Bayesian inference of latent Gaussian models,
avoiding computational intensive Markov chain Monte Carlo simulations (Rue, Martino and Chopin,
2009). The method is designed for a large class of Gaussian Markov random fields (GMRF), including
many of the hierarchical models with latent Gaussian processes. If y represents the data, x the GMRF
and ? the vector of hyperparameters, the idea of INLA is to approximate the posterior density ?(?|y)
via Gaussian approximation of the posterior of the latent field ?(x|?, y) and a Laplace approximation in
the latent field marginal posterior calculations. Details can be found in Rue, Martino and Chopin (2009).

Lindgren, Rue and Lindstrom (2011) showed that the use of INLA is not restricted to discrete
spatial domains, given there is a connection between continuous domains and Markov models. Indeed,
a large class of random field models can be expressed as a solution of a continuous domains stochastic
partial differential equation (SPDE). Whittle (1954) showed that the Mate?rn covariance function can be
seen as a solution of the SPDE. This connection allows one to carry out the calculations for a continuous
random field using the (discrete) GMRF representation. This is done by approximating the spatial field
as a basis function representation:

x(s) =
K?

k=1

?k(s)xk, (2.1)

where ?k(s) are piece-wise linear basis function defined on a triangulation of the study domain and
{x1, ..., xK} are Gaussian weights chosen to approximate the solutions to the SPDE on the domain. The
triangulation consists in subdividing the study area into a set of non-intersecting triangles (Cameletti et
al., 2012), with linear basis function defined with barycentric interpolation. This SPDE/GMRF analysis
is available in the R-package INLA (Rue, Martino and Chopin, 2009).

The first step of the analysis is the construction of a triangulated mesh on which the SPDE/GMRF
representation is built (Lindgren, 2012). As an initial step, we can choose to place the triangle vertices at
the locations where measurements were taken, and after that, add or remove additional vertices, creating
the triangulation for the analysis. As the solution may present a border effect, it is necessary to extend
the mesh also outside the study area to avoid it. According to Lindgren (2012), the effect in constructing
triangles is that we can obtain small ones (and so obtain high accuracy to represent the field) where the



15

locations are dense, and bigger ones when the locations are sparse. As the analysis depends on the mesh,
it is very important to create a mesh suited for the data at hand.

In the R-INLA implementation, the function inla.mesh.2d() is available to create the mesh.
Several parameters in this function can be chosen as to construct a mesh for the problem at hand, e.g.
the max.edge parameters define the maximal allowed lengths of triangle edges in the inner domain and
in the outer extension, the cutoff parameter corresponds with the shortest distance allowed between
points (Krainski and Lindgren, 2014; Krainski and Rue, 2013). A change in one of these values, will
create a different mesh, making it more or less dense (with more or less knots).

We will work with the above three arguments for building the convex mesh: the maximal
allowed edge length in the inner domain (a) and outer domain (b), and the shortest allowed distance
between points (c). We will always consider larger values of the maximal allowed edge length for the
outer domain as for the inner domain (b &gt; a), as the outer domain is needed only to avoid border effects.

(I) (IV)

(II) (V)

(III) (VI)

Figure 2.1. Example of meshes with b = 0.40 and (a, c) given by (I) (0.03, 0.001), (II) (0.07, 0.001),
(III) (0.11, 0.001), (IV) (0.07, 0.01), (V) (0.07, 0.03), (VI) (0.07, 0.06)

For exploratory reasons, we ilustrated how the choice of these parameters determine the aspect
of the mesh in Figure 2.1. We consider 100 randomly generated locations of a spatial process on the unit
square. Starting with these locations as initial vertices of the triangulation, we create different meshes,
depending on the parameters a, b and c. In the left panel, we fix the maximal allowed edge length
(b = 0.4) and shortest distance allowed between points (c = 0.001), but change the value of the maximal
allowed edge length in the inner domain (a = (0.03, 0.07, 0.11)). By increasing the maximal allowed edge
length, the triangulation becomes less dense, with the number of vertices decreasing from 3701 to 890
and 633, respectively. The right panel in Figure 2.1 shows the impact of increasing the minimal allowed
distance between vertices (c = 0.01, 0.03, 0.06). The edge length for the inner and outer domain was kept
fix (a = 0.07, b = 0.4). While changing c from 0.001 (panel II) to 0.01 (panel IV) has only little impact, a
further increase of c has a bigger one, changing the number of vertices to 859, 753 and 266, respectively.



16

By increasing the value of c, less clustered vertices are observed, making the mesh more regular over the
whole domain. Even a small change in one parameter to construct the mesh can generate a complete
different mesh and the results will be affected. Then, the focus of this survey is to investigate the impact
of the mesh in the analysis.

2.2.1 Model fitting and predictive information criteria

To evaluate and compare the performance of different meshes, different predictive information
criteria can be used. Three information criteria are considered in this study: the deviance information
criterion (DIC), the Watanabe-Akaike information criterion (WAIC) and the conditional predictive ordi-
nate (CPO). In Section 2.3, we investigate the performance of these criteria to perform mesh selection.
These criteria are briefly explained below.

The deviance information criterion, described by Spiegelhalter et al. (2000), is defined as

DIC = ?2 log p(y|??) + 2pDIC,

where 2 log p(y|??) is the posterior expected deviance measuring the suitability of the model and pDIC
the estimated effective number of parameters of the model, representing the complexity of the model. In
this way, DIC takes into consideration both the suitability and complexity of the model.

Proposed by Watanabe (2010), WAIC can be viewed as an improvement on the DIC for Bayesian
models (Vehtari and Gelman, 2014) and is given by

WAIC = ?2 log
?

p(y|?)?(?|y)d? +
n?

i=1

V ar (log(p(yi|?))) .

Similar as with DIC, the first term measures the predictive performance, and the second term penalizes
for model complexity. Compared to DIC, WAIC averages p(y|?) over the posterior distribution of ?,
whereas DIC conditions on the point estimate of ?. The complexity term is a sum of the variance for
each data point separately, yielding more stable results as DIC (Gelman, Hwang and Vehtari, 2014).

The conditional predictive ordinate is a cross-validation method, estimating the leave-one-out
predictive distribution (Geisser and Eddy, 1979). The posterior predictive distribution for an observation
i can be expressed as

p(yi|y?i) =
?

p(yi|?)?(?|y?i)d?,

where yi is the ith observation of y and y?i is y without observation i. So the CPO is the probability a
posteriori to observe yi when the model is adjusted without yi. A bigger value of CPO indicates a better
adjustment. Instead of having to refit the model each time, an approximation of CPO can be obtained
by sampling from the posterior distribution:

CPOi =
1

T ?1
?T

t=1 p(yi|?t)?1
,

where ?t is a sample from ?(?|yi) and T indicated the number of posterior samples. This is the inverse
of the posterior mean of the inverses of the likelihood. This is an efficient method, but requires care since
numerical problems in the calculations can occur (Held, Schrodle and Rue, 2010). However, when using
INLA it is possible to verify if numerical problems did occur and recompute the CPO using a less efficient
method (re-fitting the model for every observation).

In this work we used a summary by calculating the log-score, given by

log CPO = ? 1
n

?n
i=1 log(p(yi|y?i)).

This log-score is an estimator of the log marginal likelihood function and smaller values indicate better
model performance. In contrast to DIC and WAIC, the log CPO score does not adjust for the complexity
of the model.



17

2.3 Simulation Study

In this section, we first describe the simulation design, after which results are discussed. The
first goal of the simulation study is to investigate the impact of the choice of the mesh on the inference
(parameter estimation and prediction). The second goal is to investigate how we can select an optimal
mesh for a particular data problem at hand.

2.3.1 Simulation Design

A simulation study, with 200 simulation runs, was set up to compare different meshes. Different
simulation scenarios are considered. Spatial geostatistical processes with sample sizes of n = 300, 100 and
50 are generated. Observed locations are randomly generated on the unit square. A response vector y is
generated according to the model y = ?0 + ?1x + s + e, where x is a uniformly distributed covariate, s is
a Mate?rn spatial random field with correlaton function given by M(h|k, ?) = 1

2k?1?(k)
(?||h||)kKk(?||h||)

and e is white noise. Parameters are fixed to ?0 = 1, ?1 = 2. The spatial variability of the Mate?rn spatial
random field is set to ?2s = 0.7 and Gaussian white noise variability to ?2e = 0.3. The nominal range of the
spatial random field is specified as ?? =

?
8(?? d

2
)

k
= 0.20, by setting the smooth parameter k = 10, the

fractional operator order ? = 1.5 and d = 2, as the study region A ? Rd. Note that the choice of ? = 1.5
in the Mate?rn spatial random field corresponds to an exponential random field (Gelfand et al., 2010). For
the prior, we used the log-gamma distribution with parameters c(1.0,0.00005). To prevent effects caused
by a single choice of coordinates, we conduct the simulation in five batches of 40 simulations and within
one batch the coordinates are kept fixed.

To investigate the impact of meshes, different meshes are constructed for the generated pro-
cesses. The initial triangulation taken is given by the locations of the generated process. Note that, as we
keep the coordinates fixed within batches, also the meshes will remain the same within a batch. Different
meshes are considered by allowing the max.edge=(a,b) and cutoff=c parameters to change. The set of
values considered for the maximal allowed edge length in the inner domain is a = (0.05, 0.09, 0.13, 0.17, 0.19, 0.20),
for the maximal edge length in the outer domain is b = (0.4, 0.3, 0.2) and for the shortest allowed distance
between two points is c = (0.001, 0.005, 0.01, 0.03, 0.05, 0.07, 0.10, 0.13). Combinations of these three val-
ues leads to a total of 144 different meshes. These values were chosen such that the value of a is smaller
or equal to the range ??, and the value of b, controlling the outer boundaries to avoid boundary effects,
should be larger than a. The results are shown for b = 0.3, as we notice that there is almost no impact
for the different values of b

Table 2.1 summarizes, for the different combination of the parameters a and c, the average
number of vertices (rounded to integer) in the mesh, for a sample size of n = 100 and a maximal edge
length in the outer domain of b = 0.3. A more dense triangulation is obtained with smaller values of both
a and c. When the cutoff parameter is large, the number of vertices in the triangulation is lower than
the number of observed locations. In addition, we observe that the influence of a decreases as c increases.
Results in the next sections focus on the scenario of a sample size of n = 100. Results for n = 50 and
n = 300 are given in the Appendix A.

2.3.2 Impact of mesh on inference

To investigate the impact of the mesh on the inference, we calculated, for each mesh, the
coverage (based on the 95% Confidence Interval), bias and mean squared error (MSE) for each of the
parameters in the model and for the predictions.

Table 2.2 summarizes the simulation coverage for the covariance function parameters (?2e , ?2s , k
and ??) and for ?0 and ?1, for meshes with varying maximal allowed edge length in the inner domain (a)



18

Table 2.1. Average number of knots for different combinations of the parameters a and c, with parameter
b = 0.3 and sample size n = 100.

c=0.001 c=0.005 c=0.01 c=0.03 c=0.05 c=0.07 c=0.10 c=0.13
a=0.05 1398 1394 1390 989 400 208 120 86
a=0.09 523 517 507 487 400 206 117 84
a=0.13 315 307 293 251 236 206 116 84
a=0.17 272 265 250 203 174 159 115 84
a=0.19 266 259 243 192 160 145 115 84
a=0.20 263 256 241 189 155 140 113 84

and varying shortest allowed distance between points (c), but with fixed maximal length in the external
area (namely, b = 0.3). Figure A.1 in the Appendix A shows the coverage for all considered meshes.

Table 2.2. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3.

Coverage in % for:
Mesh c a ?0 ?1 ?2e ?

2
s k ?

?

1 0.001 0.05 90.50 90.00 13.50 52.50 30.00 30.00
2 0.09 92.50 90.00 8.50 17.50 21.50 21.50
3 0.13 93.00 90.50 6.50 9.00 19.00 19.00
4 0.17 92.50 90.00 6.50 8.00 21.00 21.00
5 0.19 92.50 90.50 8.00 9.00 21.50 21.50
6 0.20 92.00 90.00 7.50 8.50 21.50 21.00
7 0.005 0.05 88.50 85.00 17.00 56.50 34.00 34.00
8 0.09 89.50 84.00 13.00 26.50 26.00 26.00
9 0.13 89.50 84.00 12.00 16.00 25.50 25.50

10 0.17 89.50 84.00 12.00 16.00 27.00 27.00
11 0.19 89.00 84.50 12.00 15.00 26.50 26.50
12 0.20 88.50 84.50 12.50 15.50 26.50 26.00
13 0.01 0.05 92.00 86.00 36.50 70.50 52.00 52.00
14 0.09 94.00 90.00 38.50 50.00 48.50 48.50
15 0.13 92.50 89.50 37.50 39.50 46.50 46.50
16 0.17 92.50 89.00 39.00 38.00 47.00 47.00
17 0.19 92.50 89.00 37.00 37.00 48.00 48.50
18 0.20 92.00 89.00 37.50 37.50 48.50 48.00
19 0.03 0.05 95.50 90.00 79.00 91.00 89.50 88.50
20 0.09 97.00 92.00 83.50 94.00 92.50 92.50
21 0.13 98.00 92.50 81.50 94.00 91.50 92.00
22 0.17 98.00 93.50 80.50 92.00 89.50 90.00
23 0.19 97.50 94.00 78.00 90.50 90.00 90.50
24 0.20 97.50 94.00 78.50 91.00 90.50 90.50
25 0.05 0.05 97.50 91.00 83.50 96.00 91.00 91.00
26 0.09 98.50 92.00 80.50 96.00 90.00 90.00
27 0.13 99.50 92.50 74.00 97.50 89.50 89.50
28 0.17 99.50 93.00 66.00 97.50 88.50 88.50
29 0.19 99.50 93.00 67.00 96.00 88.00 88.00
30 0.20 99.00 93.50 65.50 96.00 88.50 88.50
31 0.07 0.05 99.00 92.50 60.50 96.00 87.00 86.50
32 0.09 99.50 92.00 59.00 95.50 86.50 86.50
33 0.13 99.50 92.50 59.50 95.50 86.50 86.50
34 0.17 99.00 94.00 44.00 94.50 82.00 82.00
35 0.19 99.00 92.50 39.50 96.00 85.00 85.00
36 0.20 99.50 92.50 36.50 96.50 84.00 84.00
37 0.10 0.05 99.50 93.50 20.50 93.50 83.50 83.50
38 0.09 99.50 92.50 19.50 92.50 82.00 82.00
39 0.13 99.50 93.50 19.00 93.50 82.50 82.50
40 0.17 99.50 93.50 19.50 93.00 84.00 84.00
41 0.19 99.50 93.50 19.50 92.50 85.00 85.00
42 0.20 99.50 93.00 18.50 93.00 85.50 85.50
43 0.13 0.05 98.50 93.50 2.50 94.50 86.00 86.00
44 0.09 98.50 93.00 2.00 94.50 89.00 89.00
45 0.13 98.50 93.50 3.00 94.00 89.50 90.00
46 0.17 98.50 93.50 3.00 94.00 89.50 90.00
47 0.19 98.50 93.00 3.00 94.00 89.50 90.50
48 0.20 98.50 93.50 3.00 94.50 89.50 90.00

It can be observed that the largest impact on the coverage is observed for the cutoff parameter
c. The parameters ?0 and ?1 have good coverage specially for meshes with high values of c. Increasing
the shortest allowed distance, improves the coverage for the parameters ?2s , k and ??, no matter much
the value of a. However, we also observe an undercoverage for the parameter ?2e , especially if c gets too
small or too large. Overall, we can also observe that an increase of the maximal allowed edge length in
the inner domain (a) has a negative impact on the coverage of most parameters. These results show that,
indeed, the choice of the mesh is very important to obtain good coverage for the covariance parameters.
Mesh 20, with a = 0.09, b = 0.3 and c = 0.03, has the best coverage of ?2e , k and ??, meshes 27 and 28
have the best results for ?2s and meshes with c = 0.10 have the best coverage for ?0 and ?1. So there does



19

not seem to be one mesh that is outperforming all other meshes for all parameters together. Considering
the coverage of all parameters together, mesh 20 has the best results overall.

Results given in the Appendix A with sample size of n = 50 or n = 300 are very similar.
When the value of the cutoff parameter c is very small, the coverage for all covariance parameters is too
low. Increasing the value of c, decreases the number of knots in the mesh, but leads to better nominal
coverages. However, when c is too large, the coverage for ?2e drops again. The impact of changing the
maximal allowed length in the inner domain (a) has much less impact on the nominal coverage and
changing the value of b, the maximal allowed length in the outer domain, has no impact. The mesh with
best coverage depends on the parameter of interest and the sample size: for ?2e , mesh 29 has has a slightly
better results for coverage when n = 50 and for all the others parameters, mesh 45 is outstanding when
n = 50; when n = 300, ?2e has the best coverage for mesh 13, while for the others parameters, meshes
with higher values of c have better results.

Table 2.3 presents the absolute bias of the estimated parameters, for all meshes with b = 0.3.
We observe again that the impact of the cutoff parameter is largest, compared to the impact of the
max.edge parameter. The bias of the estimated parameters is highest when the minimal allowed distance
between points is very small. Note that when c is very small, the mesh can have a highly clustered
pattern, whereas when c is very large, the mesh has only a very limited number of knots. Decreasing the
number of knots by increasing the maximal allowed edge in the inner domain, slightly decreases the bias
when c is small. We can observe that for ?0 and ?1, the values of bias is really small, and quite often
zero, for ?2e , mesh 20 has the minimal absolute bias. For the parameter ?2s , mesh 21 performs well, for k
meshes with c = 0.07 have the small bias and for ??, the minimum value of bias is obtained by c = 0.01.
Looking all the parameters together, we can conclude that meshes with c = 0.03 would yield optimal
results in this simulation setting.

Table 2.3. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3.
Bias for: Bias for:

Mesh c a ?0 ?1 ?2e ?
2
s k ?

? Mesh c a ?0 ?1 ?2e ?
2
s k ?

?

1 0.001 0.05 0.00 0.03 0.26 0.27 13.92 0.08 25 0.05 0.05 0.01 0.02 0.06 0.02 0.20 0.10
2 0.09 0.01 0.02 0.28 0.45 13.06 0.09 26 0.09 0.01 0.02 0.07 0.01 0.54 0.09
3 0.13 0.00 0.03 0.28 0.56 11.06 0.08 27 0.13 0.01 0.02 0.10 0.03 0.62 0.11
4 0.17 0.00 0.03 0.28 0.62 9.76 0.08 28 0.17 0.01 0.02 0.12 0.01 0.27 0.11
5 0.19 0.00 0.03 0.28 0.63 9.22 0.08 29 0.19 0.01 0.02 0.13 0.02 0.20 0.11
6 0.20 0.00 0.03 0.28 0.63 8.97 0.07 30 0.20 0.01 0.02 0.13 0.01 0.01 0.10
7 0.005 0.05 0.00 0.03 0.25 0.26 13.14 0.07 31 0.07 0.05 0.01 0.02 0.15 0.01 0.51 0.13
8 0.09 0.00 0.04 0.26 0.42 12.06 0.08 32 0.09 0.01 0.02 0.15 0.01 0.64 0.13
9 0.13 0.00 0.04 0.26 0.52 10.07 0.07 33 0.13 0.01 0.02 0.15 0.01 0.73 0.14

10 0.17 0.00 0.04 0.26 0.58 8.80 0.06 34 0.17 0.01 0.02 0.17 0.01 0.50 0.15
11 0.19 0.00 0.04 0.26 0.59 8.49 0.06 35 0.19 0.01 0.02 0.18 0.05 0.03 0.14
12 0.20 0.00 0.04 0.26 0.59 8.27 0.06 36 0.20 0.01 0.02 0.18 0.06 0.24 0.13
13 0.01 0.05 0.01 0.02 0.20 0.19 9.18 0.03 37 0.10 0.05 0.01 0.02 0.23 0.28 1.73 0.13
14 0.09 0.01 0.02 0.18 0.28 7.79 0.02 38 0.09 0.01 0.02 0.23 0.31 1.78 0.13
15 0.13 0.00 0.03 0.19 0.37 6.79 0.02 39 0.13 0.01 0.02 0.23 0.33 1.75 0.13
16 0.17 0.00 0.03 0.18 0.42 6.03 0.02 40 0.17 0.01 0.02 0.23 0.32 1.68 0.13
17 0.19 0.00 0.03 0.18 0.43 5.74 0.02 41 0.19 0.01 0.02 0.23 0.32 1.65 0.13
18 0.20 0.00 0.03 0.18 0.43 5.57 0.02 42 0.20 0.00 0.03 0.24 0.29 1.33 0.13
19 0.03 0.05 0.01 0.02 0.05 0.02 1.94 0.05 43 0.13 0.05 0.00 0.03 0.29 0.50 2.77 0.12
20 0.09 0.01 0.02 0.01 0.01 0.30 0.08 44 0.09 0.00 0.03 0.29 0.53 2.75 0.12
21 0.13 0.01 0.02 0.03 0.00 0.18 0.09 45 0.13 0.00 0.03 0.30 0.43 2.16 0.12
22 0.17 0.01 0.02 0.04 0.03 0.06 0.09 46 0.17 0.00 0.03 0.30 0.44 2.20 0.12
23 0.19 0.01 0.02 0.04 0.04 0.10 0.09 47 0.19 0.00 0.03 0.30 0.45 2.22 0.12
24 0.20 0.01 0.02 0.04 0.04 0.10 0.08 48 0.20 0.00 0.03 0.30 0.44 2.24 0.12

The mean square error (MSE) was calculated for each parameter and results are presented in
Table A.1 in the Appendix A. As we can notice, the value of MSE is high for k in all meshes, especially
for meshes with small values of c and a. For ?0 almost all meshes have the same results and for ?1 meshes
with c = 0.07 and c = 0.10 the results are the same and with the minimum value. For ?2e the best results
for MSE occur for c = 0.03 and for ?2s and k small values for MSE occur for mesh 21, and for ?? meshes
4 and 5 have the minimum value for MSE. Similar results are observed when n = 50 and n = 300.

Finally, we also investigated the impact of the mesh on the predictive performance of the model.
For each mesh, the coverage and the mean square error (MSE) of the predictions in the sampled locations



20

Table 2.4. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,
considering 200 simulations.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 18.75 0.28 25 0.05 0.05 90.97 0.21
2 0.09 13.11 0.29 26 0.09 90.79 0.21
3 0.13 11.41 0.29 27 0.13 89.83 0.22
4 0.17 12.24 0.29 28 0.17 89.04 0.22
5 0.19 12.51 0.29 29 0.19 88.89 0.22
6 0.20 12.82 0.29 30 0.20 88.72 0.22
7 0.005 0.05 26.48 0.28 31 0.07 0.05 87.76 0.23
8 0.09 23.54 0.28 32 0.09 87.59 0.23
9 0.13 23.25 0.28 33 0.13 87.61 0.23
10 0.17 23.79 0.28 34 0.17 85.91 0.25
11 0.19 23.82 0.28 35 0.19 85.42 0.25
12 0.20 23.98 0.28 36 0.20 84.98 0.25
13 0.01 0.05 45.17 0.25 37 0.10 0.05 82.06 0.28
14 0.09 48.95 0.25 38 0.09 81.81 0.28
15 0.13 48.67 0.25 39 0.13 81.33 0.28
16 0.17 49.01 0.25 40 0.17 81.28 0.28
17 0.19 48.74 0.25 41 0.19 81.33 0.28
18 0.20 48.85 0.25 42 0.20 81.06 0.28
19 0.03 0.05 85.56 0.21 43 0.13 0.05 75.89 0.32
20 0.09 90.49 0.20 44 0.09 75.53 0.32
21 0.13 90.83 0.20 45 0.13 75.28 0.32
22 0.17 90.84 0.20 46 0.17 75.28 0.32
23 0.19 90.95 0.20 47 0.19 75.33 0.32
24 0.20 90.92 0.21 48 0.20 75.36 0.32

are calculated. Results are presented in Table 2.4 (as well as Table A.5 and Table A.11 in the Appendix
A). Within the groups of meshes with the same value of c, changing the value of a has little impact on
the MSE and coverage of the predictions. While meshes with the smallest c value perform the worst in
term of coverage, meshes with c = 0.03 have the best coverage and MSE. The results for b = 0.4 and
b = 0.2 are similar. In Table 2.4 we can notice that mesh 20 is one of the meshes with better results and
was the mesh that in Table 2.2 has the best results.

The predictive performance of the model was also investigated for locations not used in the
analysis. For n = 100 the predictions was made in 25 locations, and for n = 50 and n = 300 in 13 and 75
locations, respectively. Table 2.5 presents the results and we can notice that as the value of c increases,
the coverage is smaller and the MSE has a slight decrease and gets bigger again with c = 0.10. Within
the groups, the mesh with a = 0.05 has the best results. For n = 50 and n ? 300 the same results are
presented in Table A.6 and Table A.12 in the Appendix A.

Boxplots of bias for each mesh, considering the 25 extra locations are presented in Figure 2.2
(as well as in Figure A.3 and Figure A.7 in the Appendix A) and we can notice that there is no difference
within and between the groups.

2.3.3 Selecting the best mesh

Results in the previous section showed that there is a large impact of the mesh on the inference
(parameter estimation and prediction). Also, it is was observed that there is not a single mesh which is
optimal. Therefore, in this section, we investigate whether we can use the predictive information criteria
as described in Section 2.1, to select an optimal mesh.

To perform mesh selection, we calculate DIC, WAIC and logCPO, for each simulation run. To
simplify the comparison, we fix b = 0.3 and a and compare meshes for different values of c. Figure 2.3
shows the number of simulations in which the mesh with a particular value of c was chosen as the best
according to DIC (panel I), WAIC (panel II) or logCPO (panel III). In settings where two meshes perform
equally good, the lowest value was considered for the two meshes. Looking at Figure 2.3, we observe an



21

Table 2.5. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,
considering 200 simulations, for 25 locations not in the analysis.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 90.80 0.45 25 0.05 0.05 82.60 0.44
2 0.09 80.26 0.45 26 0.09 82.54 0.44
3 0.13 71.40 0.46 27 0.13 78.60 0.44
4 0.17 62.86 0.47 28 0.17 74.56 0.44
5 0.19 61.14 0.47 29 0.19 73.02 0.45
6 0.20 59.64 0.47 30 0.20 71.58 0.45
7 0.005 0.05 90.76 0.45 31 0.07 0.05 77.78 0.45
8 0.09 80.62 0.45 32 0.09 77.62 0.45
9 0.13 72.50 0.46 33 0.13 77.62 0.45
10 0.17 64.68 0.47 34 0.17 73.82 0.45
11 0.19 63.04 0.47 35 0.19 71.82 0.45
12 0.20 61.50 0.47 36 0.20 70.46 0.46
13 0.01 0.05 89.94 0.44 37 0.10 0.05 71.32 0.46
14 0.09 81.30 0.45 38 0.09 71.06 0.47
15 0.13 73.94 0.45 39 0.13 70.62 0.47
16 0.17 67.38 0.46 40 0.17 70.22 0.47
17 0.19 65.92 0.46 41 0.19 70.12 0.47
18 0.20 65.26 0.46 42 0.20 69.72 0.47
19 0.03 0.05 87.98 0.44 43 0.13 0.05 65.98 0.49
20 0.09 83.10 0.44 44 0.09 65.98 0.49
21 0.13 78.66 0.45 45 0.13 65.94 0.49
22 0.17 74.88 0.45 46 0.17 65.66 0.49
23 0.19 73.60 0.45 47 0.19 65.72 0.49
24 0.20 72.68 0.45 48 0.20 65.96 0.49

Figure 2.2. Bias for Y in 25 extra locations, for all 200 simulations, for b = 0.3.

apparent difference between the DIC and WAIC measured on the one hand, and the logCPO on the other
hand. Results based on DIC and WAIC are very similar, with smaller values of c to be preferred in most
simulation runs (no matter which a is selected). LogCPO, on the other hand, seem to select meshes with
a larger value of c, and meshes with c = 0.03 (blue color) seems to standout.

The mean of DIC, WAIC and logCPO are reported in Table 2.6 for b = 0.3. We can observe



22

(I)

(II)

(III)

Figure 2.3. For each value of a, minimum value of: (I) DIC; (II) WAIC and (III) logCPO, for all 200
simulations, for b = 0.3.

that meshes with smaller value of c are selected using DIC and WAIC. For the mean of logCPO, there
are multiple meshes with good results and a way to choose one can be the minimum number of knots,
which occurs with higher values of c and a. If we consider all these three results together, we can choose



23

mesh 20 as the best one, which is the same conclusion as in section 2.3.2. As we have seen before that
the meshes with smaller value of c lead to larger MSE and bias for inference of covariance parameters, it
can be argued that those selection methods are not well suited if interest is in the covariance function.

Table 2.6. Mean values of DIC, WAIC and logCPO for meshes with b = 0.3.
Mesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO

1 0.001 0.05 -442.09 -448.64 2.07 25 0.05 0.05 230.73 231.21 1.28
2 0.09 -490.14 -500.73 2.09 26 0.09 231.33 231.77 1.28
3 0.13 -504.62 -515.26 2.13 27 0.13 237.21 237.70 1.28
4 0.17 -495.78 -506.18 2.12 28 0.17 240.72 241.35 1.28
5 0.19 -496.70 -506.81 2.11 29 0.19 241.05 241.69 1.28
6 0.20 -492.78 -503.08 2.11 30 0.20 241.55 242.19 1.28
7 0.005 0.05 -369.05 -370.31 1.98 31 0.07 0.05 242.94 243.85 1.28
8 0.09 -389.08 -395.66 1.96 32 0.09 243.20 244.13 1.28
9 0.13 -387.74 -395.32 1.97 33 0.13 243.30 244.24 1.28
10 0.17 -384.21 -389.65 1.96 34 0.17 246.10 247.05 1.28
11 0.19 -383.24 -389.03 1.95 35 0.19 246.78 247.72 1.29
12 0.20 -381.55 -387.75 1.95 36 0.20 247.02 247.92 1.28
13 0.01 0.05 -211.80 -205.13 1.78 37 0.10 0.05 251.05 252.20 1.29
14 0.09 -162.39 -163.09 1.69 38 0.09 250.94 252.10 1.29
15 0.13 -161.75 -166.19 1.70 39 0.13 251.48 252.61 1.29
16 0.17 -156.79 -160.54 1.68 40 0.17 251.50 252.63 1.29
17 0.19 -162.57 -163.38 1.68 41 0.19 251.39 252.54 1.29
18 0.20 -162.23 -162.97 1.68 42 0.20 251.62 252.79 1.29
19 0.03 0.05 155.35 161.35 1.34 43 0.13 0.05 255.85 257.13 1.30
20 0.09 213.02 213.13 1.28 44 0.09 256.22 257.47 1.30
21 0.13 221.37 221.18 1.28 45 0.13 256.55 257.78 1.30
22 0.17 223.23 223.12 1.28 46 0.17 256.55 257.78 1.30
23 0.19 223.54 223.35 1.28 47 0.19 256.49 257.73 1.30
24 0.20 223.71 223.56 1.28 48 0.20 256.57 257.80 1.30

We now evaluate the logCPO, DIC and WAIC criteria for mesh selection over all values of a,
b and c. Figure 2.4 shows boxplots of parameter estimates based on the mesh with lowest DIC, WAIC
or logCPO, obtained in each simulation. For comparison, we also present in this figure the boxplots of
the estimates obtained for each parameter with mesh 20, the mesh chosen as the one with best overall
performance for the chosen simulation settings (based on bias, MSE, coverage of parameter estimates
and predictions). We can observe that the boxplots obtained with mesh 20 are similar to the boxplots
obtained for the results of logCPO. Selection of the mesh using DIC and WAIC has bad performance,
seen in the large bias of all covariance parameters. Indeed, DIC and WAIC tends to select the mesh
with smaller cutoff values, and thus the more dense meshes, though it was observed in the previous
section that a mesh with smallest c value leads to larger bias and worse coverage for estimation of the
covariance parameters. The logCPO tends to select the mesh with larger cutoff values, and thus the more
sparse/regular meshes. While the difference between the DIC, WAIC and logCPO would be expected
to behave similarly (as they are asymptotically the same), it is important to realize that all methods
are only approximations of the predictive accuracy. While DIC and WAIC give reasonable answers in
many cases, they only attempt to capture the predictive behavior within the sample, whereas the logCPO
captures also out-of-sample prediction error.

Similar results are observed for other sample sizes. For n = 50 and n = 300, the best values
of DIC and WAIC also occurs for smaller values of c, as we can see in Table A.7 and Table A.13 of the
Appendix A, respectively. For logCPO with n = 50, the best results occur for larger value of c, especially
for c = 0.10. In the case of n = 300, meshes with smaller values of c, mainly c = 0.01, have the best
values of logCPO. Considering the analysis, we can assume that mesh 27 is a good one for n = 50 and
mesh 13 for n = 300. These meshes have plausible and satisfactory results. Figure A.5 and Figure A.9
of the Appendix A are figures similar to Figure 2.4 above and in all this three figures, the boxplot of the
chosen mesh is more alike with the boxplot of logCPO, so as told before, logCPO is the best criteria for
mesh selection.



24

Figure 2.4. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and
logCPO, and based on mesh 20.

Based on these simulation results, it is confirmed that the logCPO criterion is better suited for
mesh selection.

2.4 Data Analysis

The data analysed was the so called Parana? dataset, which is freely available in the geoR
package (Ribeiro and Diggle, 2001) in R (R Core Team, 2015). The data considers average precipitation
levels throughout Parana? state, Brazil. Data is available on 143 locations and the response represents
average winter (dry season) rainfall.

To perform the analysis we take out the linear trend from the variable, because we noticed that
this trend lead to misleading results. To model these data, we assume the model y = ?0 +s+?, where s is
a Mate?rn spatial random field with ? = 1.5. Considering the range as 380, assumed by a semivariogram
analysis, we create eighteen meshes to analyse this data set, namely a = c(20, 35, 55, 100, 240, 380),
b = 570 and c = c(13, 35, 51). The value of a was chosen taking into account the value of range, allowing
for small values until we reach the expected value of the range. The value of b is chosen larger than a
and for c values it was considered random values in the case that all the coordinates are the inner mesh.
In Table 2.7 we present the number of knots for each of these meshes. We can observe that the number
of knots almost does not change for values of a larger than 100.



25

Table 2.7. Number of knots and values for DIC, WAIC and logCPO for each mesh for Para?na data.

Mesh c a Number knots DIC WAIC logCPO
1 13 20 1235 1305.94 1306.35 4.58
2 35 678 1307.34 1307.46 4.58
3 55 362 1306.53 1306.47 4.58
4 100 234 1307.85 1307.78 4.58
5 240 230 1307.97 1307.91 4.58
6 380 230 1307.97 1307.91 4.58
7 35 20 197 1307.69 1306.64 4.58
8 35 195 1308.14 1307.04 4.58
9 55 194 1307.90 1306.81 4.58
10 100 134 1309.51 1308.59 4.58
11 240 122 1309.71 1308.65 4.58
12 380 122 1309.71 1308.65 4.58
13 51 20 100 1308.18 1307.65 4.58
14 35 100 1308.44 1307.93 4.58
15 55 97 1307.65 1307.09 4.58
16 100 94 1307.60 1307.08 4.58
17 240 77 1307.83 1307.05 4.57
18 380 77 1307.83 1307.05 4.57

The posterior distributions for ?0, ?2s , k and ?? are not very different across the considered
meshes, as we can observe in Figures 13-16 of the Supplementary Material. Table 2.8 shows the posterior
mean estimates for the parameters and we can observe that the choice of the mesh does not have a large
impact on the estimates, though mesh 16 was the one that estimates the value for ?? closer to the one
that we obtained from the exploratory analysis and also has good results for ?2s . The values of DIC,
WAIC and logCPO was computed and added into Table 2.7. As for the posterior estimates, these three
criteria also only show minor difference between the meshes. The smallest results for these three criteria
occurs for meshes 1, 17 and 18, in which meshes 17 and 18 are exactly the same. Comparing the results
of this meshes with mesh 16 we can say that mesh 16 is better although it has more knots than meshes
17 and 18. So we selected mesh 16 and computed the prediction mean and prediction standard deviation
over the study area. This is given in Figure 2.5.



26

Table 2.8. Estimates of the parameters for each mesh.
Mesh c a ?0 ?2s k ??

1 13 20 -3.04 1004.25 4x10?3 530.36
2 35 -2.90 1019.22 3x10?3 568.74
3 55 -2.88 1026.20 3x10?3 573.44
4 100 -2.87 1020.58 3x10?3 588.12
5 240 -2.85 1007.17 3x10?3 582.86
6 380 -2.85 1007.17 3x10?3 582.86
7 35 20 -2.80 1002.03 3x10?3 555.72
8 35 -2.75 1003.72 3x10?3 570.49
9 55 -2.77 987.82 3x10?3 556.80
10 100 -2.60 1018.22 3x10?3 588.27
11 240 -2.37 1063.74 3x10?3 618.14
12 380 -2.37 1063.74 3x10?3 618.14
13 51 20 -3.25 994.48 4x10?3 520.95
14 35 -3.14 979.35 4x10?3 512.67
15 55 -3.24 979.76 4x10?3 504.03
16 100 -3.14 979.48 4x10?3 494.87
17 240 -2.11 1263.75 3x10?3 666.64
18 380 -2.11 1263.75 3x10?3 666.64

(I) (II)

(III) (IV)

Figure 2.5. (I) Histogram, (II) plot of sample and corresponding values, (III) predicted surface and
(IV) prediction standard deviation considering mesh 16.

2.5 Conclusion

The first step to use the SPDE/GMRF approach in INLA with geostatistical data is to create
a triangulated mesh over the study area. Using a simulation study, we have shown that inferential results
depend on the considered mesh. The simulation results indicated that the value of b, the maximal edge



27

length in the outer domain, has almost no impact on the results. On the other hand, the choice of the
value of c, the shortest allowed distance between points, has the largest impact. Thirdly, conditional on
a value of c, the value of a, the maximal edge length in the inner domain, also leads to some differences.

Pre-specification of the triangulated mesh is not straightforward, since it is possible to create a
mesh with very good predictive behavior, but that leads to poor covariance parameter estimates. We have
used three predictive information criteria, namely DIC, WAIC and CPO, to investigate whether these
criteria can be used to select an optimal mesh for a specific data problem. We noticed that the predictive
information criteria DIC and WAIC lead to choosing dense meshes. These meshes indeed perform well
in terms of coverage and mean squared error for predictions, but do not perform well in the other parts
of the analysis, namely the estimation of the covariance parameters. Thus, DIC and WAIC showed to
prefer meshes with more knots. Further, we have noticed that mesh selection using the logCPO leads to
better performing meshes overall.

Working with INLA is fast, but selection of the mesh is hindered by the computationally
intensive logCPO measurement. While a fast approximating method for CPO calculating is available
in INLA, it is very important to ensure that no numerical problems occur. We have observed that in
many cases, especially with dense meshes, this approximating method does not work and, therefore, CPO
needed to be recalculated by refitting the model, leaving out every observation one at a time.

In this paper, we focused on a simple simulation scenario to investigate the impact of different
meshes on prediction and estimation of covariance parameters. Further investigation is still needed
towards the mesh triangulation using the SPDE/GMRF approach in INLA. For example, in our simulation
study the meshes were created considering the coordinates. However, it is not required that the observed
locations are included as nodes in the mesh. Thus, it is also possible to create meshes without the
observed coordinates or by using a specific subset of the observed locations. Additionally, situation in
which the observed data locations are more clustered or more regular should be investigated in more
details.

In the analyzed scenarios, we choose the mesh that stands out from the others, but there is not
only one suitable mesh. For n = 50, meshes constructed with c = 0.05 have good results and comparing
with range, it is a ratio of 0.25 ;for n = 100, meshes with c = 0.03 have good results, generating a
proportion of 0.15 with range and for sample size n = 300, the proportion is 0.05, with c = 0.01.

References

BOLIN, D.; LINDGREN, F. A comparison between Markov approximations and other methods for large
spatial data sets. Computational Statistics &amp;amp; Data Analysis, v. 61, p. 7-21, 2013.

BOLIN, D.; LINDSTRO?M, J. Spatial Statistics using R-INLA and Gaussian Markov random fields.
Pan-American Advanced Study Institute, 15:29:57Z, rev.3691, 2014.

CAMELETTI, M.; LINDGREN, F.; SIMPSON, D., RUE, H. Spatio-temporal modeling of particulate
matter concentration through the SPDE approach. Advances in Statistical Analysis, v. 97, p. 109-131,
2012.

GEISSER, S.; EDDY, W. A predictive approach to model selection. Journal of the American Statistical
Association, Boston, v.74, n.365, p.153-160, 1979.

GELFAND, A E. Model determination using sampling-based methods. In: GILKS, W.; S. RI- CHARD-
SON, S.; SPIEGELHALTER, D. (Eds.), Markov chain Monte Carlo in practice. Florida: Chapman &amp;amp;
Hall/CRC, 1996. chap. 9, p. 145-161.



28

GELFAND, A. E.; DIGGLE, P. J., FUENTES, M.; GUTTORP, P. (Eds) Handbook of spatial statistics.
CRC press, 2010.

GELMAN, A.; HWANG,J.; VEHTARI, A. Understanding predictive information criteria for Bayesian
models. Statistics and Computing, v. 24, n. 6, p. 997-1016, 2014.

HELD, L., SCHRODLE, B., RUE, H. Posterior and Cross-validatory Predictive Checks: A comparison
of MCMC and INLA. In T. Kneib and G. Tutz, editors,Statistical Modelling and Regression Structures,
p. 91 , 2010.

KARAGIANNIS-VOULES, D-A, SCHOLTE, R. G. C., GUIMARE?ES, L. H., UTZINGER, J.,
VOUNATSOU, P. Bayesian Geostatistical Modeling of Leishmaniasis Incidence in Brazil. PLoS Ne-
glected Tropical Diseases, v. 7, n. 5, e2213. doi:10.1371/journal.pntd.0002213. 2013.

KRAINSKI, E. T.; RUE, H. A short introduction on how to fit a SPDE model with INLA. 2013.

KRAINSKI, E. T.; LINDGREN, F. The R-INLA tutorial: SPDE models. 2014.

LINDGREN, F. Continuous domain spatial models in R-INLA. The ISBA Bulletin, v. 19, n. 4, 2012.

LINDGREN, F.; RUE, H. Bayesian spatial modelling with R-INLA. Journal of Statistical Software, v.
63, 2015.

LINDGREN, F.; RUE, H.; LINDSTRo?M, J. An explicit link between Gaussian fields and Gaussian
Markov random fields: The stochastic partial differential equation approach. Journal of the Royal Sta-
tistical Society, v. 73, p. 423-498, 2011.

R Core Team (2015). R: A language and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

RIBEIRO JR., P.J. and DIGGLE, P.J. (2001) geoR: A package for geostatistical analysis. R-NEWS
Vol 1, No 2. ISSN 1609-3631. Available for download at: http://cran.r-project.org/doc/Rnews.

RUE, H.; MARTINO, S.; CHOPIN, N. Appriximate Bayesian inference for latent Gaussian models by
using integrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society
- Series B, v.71, Part 2, p.319-392, 2009.

SPIEGELHALTER, D.J.; BEST, N.G.; CARLIN, B.P.; LINDE, A.V.D. Bayesian measures of model
complexity and fit. Journal of the Royal Statistical Society Series B, London, v.64, n.4, p.583-639, 2000.

VEHTARI, A.; GELMAN, A. WAIC and cross-validation in Stan. Submitted. http://www.stat.columbia.
edu/gelman/research/unpublished/waic stan.pdf Accessed, v. 27, n. 2015, p. 5, 2014.

WATANABE, S. Asymptotic equivalence of Bayes cross validation and widely applicable information
criterion in singular learning theory. Journal of Machine Learning Research, v. 11, p. 3571-3594, 2010.

WHITTLE, P. On stationary processes in the plane. Biometrika, v. 41, p. 434-449, 1954.



29

3 A SIMULATION STUDY WITH DIFFERENT MESHES FOR GEOSTATISTICAL
DATA WITH RANDOM, CLUSTER AND REGULAR GRIDS.

Abstract: Advanced in Geographic Information Systems and Global Positioning Systems
placed increasing demands and chalenge for spatial statistics analysis. Most of the methods used
in this analysis are computationally demandingOne approach, which is considered an remarkable
development, is the introduction of the integrated nested Laplace approximation method which is
able to carry out Bayesian analysis in a more efficient way. The use of this method for geostatistical
data is commonly done considering the SPDE approach that requires the creation of a mesh over the
study area. This is the first and an important step since all results will depend on the choice of this
mesh. As there is no formal and close way to specify the mesh, we investigate possible guidelines on
how an optimal mesh is chosen for a specific problem. We study the impact of the mesh for random,
regular and cluster data set, through a simulation study in which we considered different ways to
define the knots. Two applications with real data set,rainfall data in Parana? state, Brazil, and soil
data set, is presentend.
Keywords: Geostatistics; Clustered data; Random data; Integrated nested Laplace approximation;
Mesh

3.1 Introduction

The methods of spatial statistics have the purpose of measuring properties and relationships,
taking into account the spatial location of the phenomenon studied in an explicit way. Geostatistics is a
sub-area of spatial statistics and according to Matheron (1963) it is the application of the formalism of
random functions for the recognition and estimation of natural phenomena.

For geostatistical modeling with Bayesian analysis a method of approach has been increasingly
used, which is the integrated nested Laplace approximations (INLA), proposed by Rue, Martino and
Chopin (2009). This method is an alternative for Markov Chain Monte Carlo (MCMC) and it is faster
(Karagiannis et al., 2013; Lindgren, 2012). INLA is an approximate method designed for inference
of latent Gaussian models, a very wide and flexible class of models ranging from (generalized) linear
mixed model to spatial and spatio-temporal models (Lindgren and Rue, 2015). When combined with
stochastic partial differential equation (SPDE) (Lindgren, Rue and Lindstrom, 2011), it can accommodate
georeferenced data from all sub-areas of spatial statistics.

When combaning INLA with SPDE, for geostatistical data, the spatial field is best described
using a weighted sum of piece-wise linear basis function that is usually defined from a triangularisation
of the study area, called the mesh. This triangularisation can be done with small or big trianguls or a
combination of both. The idea is that smaller triangles will increase the accuracy, though when the spatial
range is larger, larger triangles can be used. The mesh can be constructed using different principles. we
can create the mesh using all the coordinate or just using a sample of it or we can also use only the
domain of the area.

Although it is known that the choice of the mesh must be done carefully (Lindgren and Rue,
2015), since accuracy of the estimates as well as the predictions will depend on the choice of the mesh,
there is no conclusive way to create the best one. In this way, the objective of this work is to study the
parameters for the creation of the mesh with different type of meshes, to see their impact on the analysis
and set guidelines to construct the optimal mesh in two dimensional spatial domains. The study is made
with creation of meshes using all coordinate, using a sample of the coordinate and only considering the
domain of the study area. With this three types of meshes, we made the study for irregular, regular
and cluster geostatistical data. The objective is to try to solve issue raised by Bolin and Lindstrom



30

(2014), which was how different meshes impact in analysis. In Section 3.2, we give a brief introduction to
INLA and the SPDE approach and discuss some criteria to evaluate the mesh, in Section 3.3 we show a
simulation study, applications with real data set are provided in Section 3.4 and a discussion is provided
in Section 3.5.

3.2 Methodology

In a study that requires the use of the position of the sample elements, traditional statistical
techniques are no longer sufficient for analysis. For such studies, one needs the approaches used in
spatial statistics. Geostatistics is a sub-area of spatial statistics and, according to Diggle, Ribeiro Jr and
Christensen (2003), the data in this sub-area consist of measurements y1,..,yn obtained in locations s1,..,
sn, sampled from a region A spatially continuous, in which A ? Rd. The grid of this samples can be in
different way, as it can be in a regular grid, meaning that all points of sample are equal spaced, it can be
in a random grid or a cluster one.

Diggle, Tawn and Moyeed (1998) introduced the term ”model-based geostatistics”, in which
modeling is performed by specifying a parametric model for the variable(s) under study and using statis-
tical inference methods based on the likelihood function applied to geostatistical studies. With geosta-
tistical techniques it is possible to describe the spatial dependence structure of the data, establishing a
spatial correlation function that depends only on the distance of the position of the samples and repre-
sents the behavior of the spatial variability of the data, by means of a model. Also, the parameters of the
models are estimated and used in the spatial predictions of the variables under study and then, it can
be said that there is uncertainty about these parameters and as a consequence, there is uncertainty in
the predictions made. When using the classical geostatistical methodology in the estimation of parame-
ters through the maximum likelihood method, we use only the information from the data, the adopted
model and the asymptotic theories, but when using the Bayesian methods, besides all this knowledge we
also use a priori information about the parameters, that is, there may be an initial knowledge that is
expressed through a prior distributions. Under this approach, there is no difference between parameters
and observations, both of which are treated as random quantities.

After defining the priori distribution of the parameters it is possible to summarize inferential
techniques, usually using probabilities and expectation. In this step, it is often necessary to use intensive
computational methods such as Monte Carlo via Markov Chains (MCMC). In geostatistics, the Gibbs
sampler and the Metropolis-Hastings algorithm were the most used methods. An alternative approach
is the INLA method, which is a deterministic method to perform Bayesian inference in a large class of
Gaussian Markov random fields (GMRF), including many of the hierarchical models with latent Gaussian
processes. It has been gaining a lot of space on the practice because it is more computationally efficient
(Rue, Martino and Chopin, 2009).

If y represents the data, x the GMRF and ? the vector of hyperparameters, the idea of INLA
is to approximate the posterior density ?(?|y) via Gaussian approximation of the posterior of the la-
tent field ?(x|?, y) and a Laplace approximation in the latent field marginal posterior calculations.
For more details see Rue, Martino and Chopin (2009). Lindgren, Rue and Lindstrom (2011) showed
that INLA is not restricted to discrete spatial domains, given there is a connection between continu-
ous domains and Markov models. Also, a large class of random field models can be expressed as a
solution of a continuous domains stochastic partial differential equation (SPDE) and it is possible to
obtain connections between the parameters of the SPDE and the elements of the precision matrix for
weights in representation, using as basis the covariance function Mate?rn. The Mate?rn function is given
by M(h|k, ?) = 2

1?k

?(k)
(?||h||)kKk(?||h||), in which ?(.) is the Gamma function, Kk is Bessel function with

order k and ||h|| is the distance between two locations. With this connection it is possible to carry out



31

the calculations for a continuous random field using the (discrete) GMRF representation:

x(s) =

K?
k=1

?k(s)xk, (3.1)

where ?k(s) are piece-wise linear basis function defined on a triangulation of the study domain and
{x1, ..., xK} are Gaussian weights chosen to approximate the solutions to the SPDE on the domain. This
triangulation consists of partitioning the study area into a set of non-intersecting triangles (Cameletti et
al., 2012), with linear basis function defined with barycentric interpolation. This approach is available in
the R-package INLA (Rue, Martino and Chopin, 2009).

This partitioning can be done with the construction of a triangulated mesh on which the
SPDE/GMRF representation is built (Lindgren, 2012). As an initial step, we can choose to place the
triangle vertices at the locations where measurements were taken, and after that, add or remove additional
vertices, creating the triangulation for the analysis. As the solution may present a border effect, it is
necessary to extend the mesh also outside the study area to avoid it. According to Lindgren (2012), the
global effect in constructing triangles is that we can obtain small ones (and so obtain high accuracy to
represent the field) where the locations are dense, and bigger ones when the locations are sparse. As the
analysis depends on the mesh, this first step is very important, so we can create a mesh suited for the
data at hand.

The function inla.mesh.2d(), in the R-INLA implementation, is available to create the mesh.
Several parameters in this function can be chosen as to construct a mesh for the problem at hand but in
this work we are only using three: the max.edge parameters, which define the maximal allowed lengths of
triangle edges in the inner domain and in the outer extension, the cutoff parameter, which corresponds
with the shortest distance allowed between points (Krainski and Lindgren, 2014; Krainski and Rue, 2013).
A change in one of these values, will create a different mesh, making it with more or less knots.

In this work we named the parameters to construct the mesh as: the maximal allowed edge
length in the inner domain is a, the outer domain is represented by b and the shortest allowed distance
between points by c. We will always consider larger values of the maximal allowed edge length for the
outer domain as for the inner domain (b &gt; a), as the outer domain is needed only to avoid border effects.

3.2.1 Goodness of fit

To compare the results obtained from the differents meshes, we used some criteria to try to
obatin the optimal mesh. The criteria used were: the deviance information criterion (DIC), the Watanabe-
Akaike information criterion (WAIC) and the conditional predictive ordinate (CPO).

Spiegelhalter et al. (2000) described DIC as

DIC = ?2 log p(y|??) + 2pDIC,

where 2 log p(y|??) is the posterior expected deviance measuring the suitability of the model and pDIC
is the estimated effective number of parameters of the model, representing the complexity of the model.
Thus, we can say that DIC takes into consideration both the suitability and complexity of the model.

WAIC was proposed by Watanabe (2010) and can be viewed as an improvement on the DIC
for Bayesian models (Vehtari and Gelman, 2014).The formula for WAIC is given by

WAIC = ?2 log
?

p(y|?)?(?|y)d? +
n?

i=1

V ar (log(p(yi|?))) .

In the same way for DIC, in WAIC the first term measures the predictive performance, and the second
term penalizes for model complexity. According to Gelman, Hwang and Vehtari (2014), the complexity
term is a sum of the variance for each data point separately, yielding more stable results as DIC.



32

CPO statistics is a model assessment tool which has been widely used in the statistical literature
under various contexts (Ibrahim, Chen and Sinha, 2013) and it is a cross-validation method, estimating
the leave-one-out predictive distribution (Geisser and Eddy, 1979). The posterior predictive distribution
for an observation i can be expressed as

p(yi|y?i) =
?

p(yi|?)?(?|y?i)d?,

where yi is the ith observation of y and y?i is y without observation i. So the CPO is the probability a
posteriori to observe yi when the model is adjusted without yi. A bigger value of CPO indicates a better
adjustment. Instead of having to refit the model each time, an approximation of CPO can be obtained
by sampling from the posterior distribution:

CPOi =
1

T ?1
?T

t=1 p(yi|?t)?1
,

where ?t is a sample from ?(?|yi) and T indicated the number of posterior samples. This is the inverse
of the posterior mean of the inverses of the likelihood. This is an efficient method, but requires care since
numerical problems in the calculations can occur (Held, Schrodle and Rue, 2010). However, when using
INLA it is possible to verify if numerical problems did occur and recompute the CPO using a less efficient
method (re-fitting the model for every observation).

Normally, CPO is used plotting a graphic of CPO’s values against the observation index. An
alternative to this plots, is to use the average of the summary statistics named as the logarithm of
the Pseudomarginal Likelihood (LPML) (Ibrahim, Chen and Sinha, 2013). In this paper we named as
logCPO and the formula is given by log CPO = ? 1

n

?n
i=1 log(p(yi|y?i)). This log-score is an estimator

of the log marginal likelihood function and smaller values indicate better model performance. In contrast
to DIC and WAIC, the log CPO score does not adjust for the complexity of the model.

In addition to look only the estimates of the parameters, Zhang and Zimmerman (2007) said
that the ratio ?

2
s

?
affects interpolation more than each this parameter separately. So, we will also consider

the estimate of this ratio, in which ? = 1
?? , in our notation.

3.3 Simulation Study

This section is to describe the simulation design and its results in which we investigate the
impact of the choice of the mesh in the parameter estimation and prediction and we also investigate how
to select an optimal mesh for a particular data problem considering the design of the sample.

All the analysis was made using R software (R Core Team, 2015) and INLA package (Rue,
Martino and Chopin, 2009).

3.3.1 Simulation Design

In this simulation study, we runned 200 simulations and investigate the optimal mesh for three
kind of sample design: random, regular and cluster data set, always with sample size n = 100, on the unit
square. We conduct the simulation in five batches of 40 simulations and within one batch the coordinates
are kept fixed, except on regular sample, to avoid possible confounding of the generated coordinates on
the simulation results,

A response vector y is generated according to the model y = ?0 + ?1x + s + e, where x is a
uniformly distributed covariate, s is a Mate?rn spatial random field and e is white noise. Parameters are
fixed to ?0 = 1, ?1 = 2. The spatial variability of the Mate?rn spatial random field is set to ?2s = 0.7
and Gaussian white noise variability to ?2e = 0.3. The scale parameter (k) has value 10 and the nominal



33

range, specified as ?? =
?

8(?? d
2
)

k
, has value 0.2. We also fixed the fractional operator order ? = 1.5 and

d = 2, as the study region A ? Rd. For the prior, we used the log-gamma distribution with parameters
c(1.0,0.00005).

We worked with 48 meshes for each type of data and they are divided in three groups, of 16
meshes each: the first one (GM1) is the group in which the initial triangulation taken is given by the
locations of the generated process; the second group (GM2) is the one that we did not considered the
coordinate to create the mesh, we only take into account a specific domain and in the third group (GM3)
the meshes was created by half of the coordinate and for the selection of the coordinate we use the space
filling algorithm (Johnson, 1990)

The spacial domain used was [?0.1, 1.1]× [?0.1, 1.1]. To create different meshes, we considered
the max.edge and cutoff parameters to change. The values considered for the maximal allowed edge
length in the inner domain is a = (0.05, 0.09, 0.17, 0.20), for the maximal edge length in the outer
domain is b = 0.3 and for the shortest allowed distance between two points is c = (0.005, 0.03, 0.07, 0.10).
Combinations of these three values leads to a total of 16 different meshes. These values were chosen such
that the value of a is smaller or equal to the range ??, and the value of b, controlling the outer boundaries
to avoid boundary effects, should be larger than a.

The analysis will be presented separately according to the data design.

• Random data set

Table 3.1 summarizes, for the three groups and for the different combination of the parameters
a and c, the average number of knots in the mesh. A more dense triangulation is obtained with smaller
values of both a and c. We can observe that meshes created with domain and not taking any coordinate,
always gets larger numbers of knots.

Table 3.1. Average number of knots for different combinations of the parameters a and c, with parameter
b = 0.3 for random data.

c=0.005 c=0.03 c=0.07 c=0.10
GM1 a=0.05 1593 1191 269 148

a=0.09 598 567 270 146
a=0.17 347 286 204 147
a=0.20 333 269 170 143

GM2 a=0.05 2109 1586 370 208
a=0.09 727 727 369 208
a=0.17 252 252 252 209
a=0.20 212 212 212 206

GM3 a=0.05 1599 1198 267 145
a=0.09 567 565 267 145
a=0.17 251 248 201 144
a=0.20 221 218 163 141

We calculated the coverage (based on the 95% Confidence Interval), bias and mean square error
(MSE) for each of the parameters in the model and for the predictions and also bias and MSE for the
ratio ?

2
s

?
, to investigate the impact of the mesh on the inference,

The values of the coverage (in %) for the covariance function parameters (?2e , ?2s , k and ??)
and for ?0 and ?1 are summarized on Table 3.2. In the Appendix B, Figure B.1 shows the coverage for
all considered meshes. As we can observe in this table, all meshes have good results for coverage of ?0
and ?1. For ?2e , meshes from GM1 have better results, specially the ones with c = 0.03 and as the value
of a gets higher, the coverage gets small. For the parameters ?2s , k and ??, all the meshes, except the
meshes from GM1 with c = 0.005, have similar and good results and this is is very clear when looking at
the Figure B.1 of the Appendix B. So, considering the coverage of all parameters together, mesh 6 was
the one with the best results overall.



34

Table 3.2. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3, for random data set.

Coverage in % for:
Group Mesh c a ?0 ?1 ?2e ?

2
s k ?

?

1 0.005 0.050 88.000 86.000 19.000 61.000 35.500 35.500
2 0.005 0.090 89.000 83.000 11.000 22.000 23.500 23.500
3 0.005 0.170 89.000 84.000 12.500 16.000 25.000 25.000
4 0.005 0.200 89.500 84.000 13.000 15.000 27.500 28.000
5 0.030 0.050 96.000 92.000 81.500 92.500 90.500 90.500
6 0.030 0.090 97.500 92.000 82.500 94.500 91.000 90.500
7 0.030 0.170 97.500 93.500 80.000 93.000 90.000 90.000

GM1 8 0.030 0.200 97.500 93.500 80.000 90.500 90.500 90.500
9 0.070 0.050 99.500 93.000 63.500 96.500 84.500 84.500

10 0.070 0.090 99.500 93.500 62.500 95.000 84.500 84.500
11 0.070 0.170 99.000 93.500 47.500 96.000 82.500 82.500
12 0.070 0.200 99.500 92.000 37.000 96.500 81.500 81.500
13 0.010 0.050 99.000 93.500 25.500 96.000 84.000 84.000
14 0.010 0.090 99.000 94.000 26.500 96.000 83.000 83.000
15 0.010 0.170 99.000 93.500 25.500 97.000 83.500 83.500
16 0.010 0.200 98.500 93.500 23.500 96.000 85.000 85.000
17 0.005 0.050 94.000 91.000 63.000 68.500 65.500 65.500
18 0.005 0.090 96.000 92.500 76.000 90.000 87.500 87.500
19 0.005 0.170 98.000 92.000 31.500 86.500 84.000 84.000
20 0.005 0.200 97.000 93.500 16.500 89.000 84.500 84.500
21 0.030 0.050 96.000 90.000 68.000 75.000 74.500 74.500
22 0.030 0.090 96.000 92.500 76.000 90.000 87.500 87.500
23 0.030 0.170 98.000 92.000 31.500 86.500 84.000 84.000

GM2 24 0.030 0.200 97.000 93.500 16.500 89.000 84.500 84.500
25 0.070 0.050 99.500 92.500 50.500 88.000 86.000 86.000
26 0.070 0.090 98.500 93.500 50.000 92.000 85.000 85.000
27 0.070 0.170 98.000 92.000 31.500 86.500 84.000 84.000
28 0.070 0.200 97.000 93.500 16.500 89.000 84.500 84.500
29 0.010 0.050 98.500 92.500 23.500 89.000 85.500 85.500
30 0.010 0.090 99.000 93.500 20.000 88.500 82.000 82.000
31 0.010 0.170 99.000 94.500 18.000 89.000 85.500 86.000
32 0.010 0.200 98.500 93.500 18.000 91.000 87.000 87.000
33 0.005 0.050 96.000 90.500 69.000 78.500 76.500 77.000
34 0.005 0.090 98.000 91.000 77.500 92.500 89.000 89.000
35 0.005 0.170 98.500 93.500 39.500 95.000 82.000 82.000
36 0.005 0.200 98.500 94.000 29.000 94.500 81.500 81.500
37 0.030 0.050 97.000 91.000 77.000 83.500 83.500 83.500
38 0.030 0.090 98.000 91.500 77.500 92.500 89.500 89.500
39 0.030 0.170 98.500 93.500 40.000 95.000 83.000 83.000

GM3 40 0.030 0.200 98.000 94.000 29.000 94.500 82.500 82.500
41 0.070 0.050 99.000 93.500 56.500 92.500 83.500 83.500
42 0.070 0.090 99.000 93.500 55.500 93.500 84.000 84.000
43 0.070 0.170 98.500 93.500 38.000 96.500 82.000 82.500
44 0.070 0.200 98.000 94.000 25.500 94.000 83.000 83.000
45 0.010 0.050 99.000 94.000 24.500 92.500 82.500 82.500
46 0.010 0.090 99.000 94.000 25.000 93.000 83.500 83.500
47 0.010 0.170 99.000 94.000 23.500 92.500 83.500 83.500
48 0.010 0.200 99.000 94.000 20.000 92.500 84.000 84.000

Table 3.3 presents the absolute bias of the estimated parameters and for the ratio ?
2
s

?
. We can

notice that the bias for ?0 and ?1 have small values and similar results for the meshes. For ?2e , the best
value for the bias is obtained with mesh 6 and the highest value with mesh 2,but it is not so different
from the values from other meshes. The small value of bias for ?2s is with mesh 9 and for these parameter
the values are higher than for ?2e , but almost all meshes have the same behavior. The bias for parameter
k some meshes obtained high and discrepant values from the others, as for example, mesh 1 has bias with
value 11.943 and mesh 10 obtained value 0.051, and we can notice that meshes from GM1 have smaller
results. For ?? the values obtained for bias vary from 0.024 to 0.144, so there is no huge difference from
each mesh. The results of bias for the ratio ?

2
s

?
also did not have big change between meshes and the

lowest values were obtained with c = 0.005 from GM1.
Table B.1 from the Appendix B shows the results of MSE for the parameters and the ratio.

Similar as the values of bias, we can notice high values of MSE for k and meshes from GM1 with c = 0.03
are the ones with small values and theses values are really small when comparing with the other meshes.
For the others parameters and for the ratio, there are no big difference of the values from all meshes.

Considering the variable, we calculated the coverage and MSE of prediction in the sample
locations to investigate the impact of the mesh on the predictive performance of the model. These results
are in Table 3.4 and we can notice that the highest values for coverage and the lowest values for MSE
are from meshes with c = 0.03 from GM1; all the others meshes have similar results for MSE and only
meshes with the lowest value of c from GM1 have very small values for coverage.

The predictive performance of the model was also investigated for locations not used in the



35

Table 3.3. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes
with random data set.

Bias for:

Group Mesh c a ?0 ?1 ?2e ?
2
s k ?

? ?
2
s
?

1 0.005 0.050 0.004 0.030 0.246 0.232 11.943 0.055 0.010
2 0.005 0.090 0.001 0.035 0.261 0.445 12.328 0.075 0.015
3 0.005 0.170 0.001 0.040 0.257 0.574 8.716 0.063 0.016
4 0.005 0.200 0.002 0.039 0.256 0.601 8.127 0.060 0.024
5 0.030 0.050 0.005 0.025 0.045 0.051 2.395 0.057 0.037
6 0.030 0.090 0.008 0.018 0.014 0.022 0.139 0.089 0.050
7 0.030 0.170 0.008 0.019 0.035 0.032 0.263 0.093 0.060

GM1 8 0.030 0.200 0.008 0.020 0.040 0.043 0.384 0.091 0.064
9 0.070 0.050 0.008 0.017 0.137 0.001 0.072 0.140 0.083

10 0.070 0.090 0.009 0.017 0.140 0.006 0.051 0.137 0.082
11 0.070 0.170 0.009 0.018 0.167 0.024 0.054 0.145 0.084
12 0.070 0.200 0.009 0.017 0.183 0.065 0.308 0.138 0.080
13 0.010 0.050 0.010 0.020 0.216 0.164 1.185 0.138 0.086
14 0.010 0.090 0.009 0.021 0.216 0.165 1.306 0.138 0.086
15 0.010 0.170 0.009 0.021 0.215 0.168 1.197 0.138 0.086
16 0.010 0.200 0.010 0.019 0.220 0.162 1.289 0.132 0.085
17 0.005 0.050 0.013 0.012 0.068 0.322 7.567 0.024 0.040
18 0.005 0.090 0.008 0.021 0.066 0.261 2.707 0.079 0.074
19 0.005 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097
20 0.005 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121
21 0.030 0.050 0.011 0.010 0.033 0.290 5.703 0.038 0.048
22 0.030 0.090 0.008 0.021 0.066 0.261 2.707 0.079 0.074
23 0.030 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097

GM2 24 0.030 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121
25 0.070 0.050 0.007 0.022 0.154 0.353 2.582 0.085 0.081
26 0.070 0.090 0.006 0.025 0.155 0.313 2.456 0.090 0.084
27 0.070 0.170 0.007 0.024 0.198 0.662 3.907 0.088 0.097
28 0.070 0.200 0.007 0.025 0.237 0.631 3.753 0.101 0.121
29 0.010 0.050 0.006 0.024 0.222 0.874 4.695 0.086 0.115
30 0.010 0.090 0.005 0.023 0.224 0.723 4.108 0.105 0.121
31 0.010 0.170 0.003 0.028 0.227 0.565 3.250 0.095 0.101
32 0.010 0.200 0.005 0.026 0.226 0.840 4.039 0.098 0.116
33 0.005 0.050 0.010 0.013 0.061 0.125 3.618 0.043 0.036
34 0.005 0.090 0.012 0.013 0.064 0.036 0.293 0.106 0.066
35 0.005 0.170 0.011 0.016 0.183 0.096 0.674 0.143 0.082
36 0.005 0.200 0.009 0.018 0.206 0.138 1.154 0.138 0.078
37 0.030 0.050 0.011 0.012 0.023 0.127 3.561 0.050 0.040
38 0.030 0.090 0.012 0.012 0.064 0.037 0.312 0.106 0.067
39 0.030 0.170 0.011 0.016 0.183 0.096 0.679 0.144 0.082

GM3 40 0.030 0.200 0.009 0.018 0.206 0.136 1.145 0.137 0.077
41 0.070 0.050 0.007 0.018 0.147 0.049 0.034 0.133 0.077
42 0.070 0.090 0.006 0.018 0.147 0.031 0.298 0.136 0.076
43 0.070 0.170 0.009 0.019 0.186 0.088 0.572 0.142 0.084
44 0.070 0.200 0.010 0.018 0.212 0.136 0.701 0.140 0.079
45 0.010 0.050 0.010 0.016 0.216 0.293 2.343 0.126 0.083
46 0.010 0.090 0.010 0.017 0.218 0.348 2.457 0.126 0.084
47 0.010 0.170 0.011 0.016 0.219 0.291 2.197 0.128 0.084
48 0.010 0.200 0.011 0.015 0.222 0.352 2.367 0.131 0.085

Table 3.4. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering
200 simulations, with random data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 28.955 0.273 25 0.070 0.050 88.115 0.238
2 0.005 0.090 23.740 0.281 26 0.070 0.090 87.925 0.238
3 0.005 0.170 23.385 0.281 27 0.070 0.170 85.045 0.259
4 0.005 0.200 23.650 0.280 GM2 28 0.070 0.200 81.745 0.282
5 0.030 0.050 87.405 0.205 29 0.010 0.050 82.775 0.273
6 0.030 0.090 90.485 0.203 30 0.010 0.090 83.005 0.272
7 0.030 0.170 90.795 0.205 31 0.010 0.170 83.105 0.273

GM1 8 0.030 0.200 90.870 0.205 32 0.010 0.200 82.585 0.275
9 0.070 0.050 88.270 0.229 33 0.005 0.050 78.620 0.218

10 0.070 0.090 88.100 0.230 34 0.005 0.090 89.875 0.211
11 0.070 0.170 86.455 0.242 35 0.005 0.170 85.515 0.249
12 0.070 0.200 85.485 0.249 36 0.005 0.200 83.610 0.261
13 0.010 0.050 82.745 0.268 37 0.030 0.050 86.180 0.209
14 0.010 0.090 82.710 0.268 38 0.030 0.090 89.875 0.211
15 0.010 0.170 82.815 0.268 39 0.030 0.170 85.510 0.249
16 0.010 0.200 82.540 0.270 GM3 40 0.030 0.200 83.605 0.261
17 0.005 0.050 71.860 0.223 41 0.070 0.050 87.790 0.234
18 0.005 0.090 89.760 0.212 42 0.070 0.090 87.795 0.234
19 0.005 0.170 85.045 0.259 43 0.070 0.170 85.310 0.251

GM2 20 0.005 0.200 81.745 0.282 44 0.070 0.200 83.090 0.265
21 0.030 0.050 79.475 0.215 45 0.010 0.050 82.805 0.268
22 0.030 0.090 89.760 0.212 46 0.010 0.090 82.690 0.269
23 0.030 0.170 85.045 0.259 47 0.010 0.170 82.740 0.269
24 0.030 0.200 81.745 0.282 48 0.010 0.200 82.150 0.272

analysis and it was made in 25 locations. Results for coverage and MSE for these 25 locations are
presented in Table 3.5. We can notice that the values for MSE are very similar for all the meshes, the
results are around 0.4. The values for coverage for the variable in 25 extra locations are not all so high
as for 100 locations in the analysis, most meshes have coverage less than 80% and the mesh with highest



36

coverage is mesh 17 (a = 0.05 and c = 0.005), from GM2. Mesh 6 obtained the lowest MSE (0.443) and
coverage of 83.22, being that the best value was 92.08%.

Table 3.5. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25
locations, considering 200 simulations, with random data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 90.580 0.451 25 0.070 0.050 82.680 0.452
2 0.005 0.090 80.620 0.452 26 0.070 0.090 83.240 0.451
3 0.005 0.170 65.840 0.467 27 0.070 0.170 80.320 0.459
4 0.005 0.200 61.900 0.473 GM2 28 0.070 0.200 76.000 0.466
5 0.030 0.050 87.820 0.444 29 0.010 0.050 77.780 0.461
6 0.030 0.090 83.220 0.443 30 0.010 0.090 77.020 0.462
7 0.030 0.170 75.700 0.444 31 0.010 0.170 77.260 0.462

GM1 8 0.030 0.200 72.920 0.448 32 0.010 0.200 77.380 0.461
9 0.070 0.050 77.480 0.447 33 0.005 0.050 90.020 0.453

10 0.070 0.090 77.660 0.446 34 0.005 0.090 84.400 0.447
11 0.070 0.170 74.620 0.452 35 0.005 0.170 74.420 0.454
12 0.070 0.200 71.060 0.454 36 0.005 0.200 70.680 0.461
13 0.010 0.050 70.620 0.462 37 0.030 0.050 88.620 0.452
14 0.010 0.090 70.060 0.463 38 0.030 0.090 84.380 0.447
15 0.010 0.170 70.620 0.462 39 0.030 0.170 74.460 0.454
16 0.010 0.200 70.080 0.464 GM3 40 0.030 0.200 70.640 0.461
17 0.005 0.050 92.080 0.463 41 0.070 0.050 78.020 0.447
18 0.005 0.090 87.720 0.451 42 0.070 0.090 78.240 0.446
19 0.005 0.170 80.320 0.459 43 0.070 0.170 74.160 0.455

GM2 20 0.005 0.200 76.000 0.466 44 0.070 0.200 70.080 0.461
21 0.030 0.050 91.700 0.462 45 0.010 0.050 70.900 0.465
22 0.030 0.090 87.720 0.451 46 0.010 0.090 70.800 0.464
23 0.030 0.170 80.320 0.459 47 0.010 0.170 70.620 0.465
24 0.030 0.200 76.000 0.466 48 0.010 0.200 70.680 0.466

The bias for the prediction in these 25 extra locations was calculated and ploted with boxplot,
as we can see in Figure 3.1. The 48 boxplot for the values of bias are quite the same and we can notice
that there is no difference within and between the groups.

Figure 3.1. Bias for Y in 25 extra locations, with random data set.

These results showed that there is a large impact of the mesh on the inference (parameter
estimation and prediction) and it is was observed that there is not a single mesh which is optimal in
everything. Therefore, we investigate whether we can use the predictive information criteria as described
in Section 2.1, to select an optimal mesh.

We calculate the mean of DIC, WAIC and logCPO (Table 3.6) to perform mesh selection.
Minimum values of DIC and WAIC occur with meshes from CM1 with c = 0.005 and occur negative



37

values for DIC and WAIC, as we can notice in Table 3.6. Disregarding negative values, the minimum
values for DIC and WAIC occur with mesh 17 (35.877 and 43.257) and it is the mesh with more knots
(2109 knots, Table 3.1). This does not occur for logCPO. Meshes 7 and 8 have minimum value for logCPO
(1.279), followed by mesh 6 and other meshes, with value of 1.281. Mesh 6 has value 213.639 for DIC
and 213.871 for WAIC.

Table 3.6. Mean values of DIC, WAIC and logCPO for meshes with random data set .
Group Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO

1 0.005 0.050 -348.646 -347.352 1.935 25 0.070 0.050 242.810 244.572 1.283
2 0.005 0.090 -387.573 -392.315 1.981 26 0.070 0.090 243.059 244.826 1.283
3 0.005 0.170 -388.284 -394.420 1.965 27 0.070 0.170 247.626 249.531 1.287
4 0.005 0.200 -383.974 -390.865 1.949 GM2 28 0.070 0.200 251.459 253.263 1.292
5 0.030 0.050 170.092 176.546 1.316 29 0.010 0.050 249.753 251.548 1.288
6 0.030 0.090 213.639 213.871 1.281 30 0.010 0.090 250.074 251.837 1.289
7 0.030 0.170 222.671 222.477 1.279 31 0.010 0.170 250.767 252.612 1.292

GM1 8 0.030 0.200 223.690 223.589 1.279 32 0.010 0.200 250.367 252.118 1.290
9 0.070 0.050 241.802 242.580 1.281 33 0.005 0.050 90.609 103.326 1.411

10 0.070 0.090 242.071 242.810 1.282 34 0.005 0.090 223.217 224.530 1.287
11 0.070 0.170 245.125 245.932 1.284 35 0.005 0.170 246.560 247.588 1.284
12 0.070 0.200 246.970 247.811 1.285 36 0.005 0.200 248.739 249.705 1.286
13 0.010 0.050 249.704 250.704 1.288 37 0.030 0.050 163.988 169.977 1.331
14 0.010 0.090 249.621 250.623 1.288 38 0.030 0.090 223.214 224.509 1.287
15 0.010 0.170 249.675 250.683 1.288 39 0.030 0.170 246.600 247.616 1.284
16 0.010 0.200 250.128 251.117 1.289 GM3 40 0.030 0.200 248.768 249.734 1.286
17 0.005 0.050 35.877 43.257 1.487 41 0.070 0.050 242.290 243.264 1.281
18 0.005 0.090 219.211 221.541 1.288 42 0.070 0.090 242.284 243.290 1.281
19 0.005 0.170 247.626 249.531 1.287 43 0.070 0.170 247.018 248.037 1.285

GM2 20 0.005 0.200 251.459 253.263 1.292 44 0.070 0.200 249.300 250.256 1.287
21 0.030 0.050 110.325 115.101 1.400 45 0.010 0.050 249.623 250.653 1.287
22 0.030 0.090 219.211 221.541 1.288 46 0.010 0.090 249.764 250.797 1.288
23 0.030 0.170 247.626 249.531 1.287 47 0.010 0.170 249.805 250.854 1.288
24 0.030 0.200 251.459 253.263 1.292 48 0.010 0.200 250.144 251.178 1.288

Taking all the results into account (bias, MSE, coverage of parameter estimates and predictions),
we can consider that mesh 6 is the optimal one from random data set. In Figure 3.2 we can observe
boxplots of parameter estimates based on the mesh with lowest DIC, WAIC or logCPO, obtained in each
simulation and for comparison, we also present in this figure the boxplots of the estimates obtained for
each parameter with mesh 6.

We can observe that the boxplots obtained with mesh 6 are more similar to the boxplots
obtained for the results of logCPO. Also, selection of the mesh using DIC and WAIC has bad performance,
seen in the large bias of all covariance parameters. While the difference between the DIC, WAIC and
logCPO would be expected to behave similarly, sinse they are asymptotically the same, it is important
to realize that all methods are only approximations of the predictive accuracy. While DIC and WAIC
give reasonable answers in many cases, they only attempt to capture the predictive behavior within the
sample, whereas the logCPO captures also out-of-sample prediction error. So, it is confirmed that the
logCPO criterion is better suited for mesh selection.



38

Figure 3.2. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and
logCPO, and based on mesh 6 for random data set.

• Regular data set

As previously stated, for regular data set we do not have the batches of 40 simulations, we
only have one simulated coordinate. So, Table 3.7 shows the number of knots in the mesh, for the three
groups. For regular data, meshes created with part of the coordinate (GM3), obtained smaller numbers
of knots, when comparing with GM1 and GM2.

Table 3.7. Number of knots for different combinations of the parameters a and c, with parameter b = 0.3
for regular data.

c=0.005 c=0.03 c=0.07 c=0.10
GM1 a=0.05 2211 1365 309 179

a=0.09 648 648 310 179
a=0.17 228 228 201 179
a=0.20 212 212 182 179

GM2 a=0.05 2109 1586 370 208
a=0.09 727 727 369 208
a=0.17 252 252 252 209
a=0.20 212 212 212 206

GM3 a=0.05 1925 1467 279 167
a=0.09 614 614 281 167
a=0.17 227 227 187 167
a=0.20 198 198 169 167

The values of the coverage (in %) for all the parameters (?0, ?1?2e , ?2s , k and ??) are summarized
on Table 3.8. In the Appendix B, Figure B.2 shows the coverage for all considered meshes. As we can



39

observe in these table and figure, for ?0 and ?1, all meshes have good coverage. Observing the results
for the others parameters, we can notice that meshes from GM1 have bad results. In fact, for ?2e , all the
meshes from GM1 have 0% of coverage. Some meshes from GM2 also have 0% coverage for ?2e but meshes
19, 23 and 27 obtained 35.5%. Meshes 35 and 39 (both from GM3) were the ones that obtained the best
result for this parameter: 41% for coverage . For ?2s , some meshes from GM1 obtained 0% of coverage,
the majority of the meshes of GM2 have good results and the best value for coverage is from mesh 46
(GM3) and mesh 36 (GM2) with 96%. Meshes 19, 23, 27, 35 and 39 all obtained 95% of coverage for ?2s .
The results for parameter k are more homogeneous between the groups and mesh 31 was the one with
better results, 90% of coverage. In the last column of the table are the results for ?? and we can observe
that the results are quite similar to the ones for k. The best value is for mesh 31 (90% of coverage).
Meshes 19, 23 and 27 obatined 87% and meshes 35 and 39 obtained 84% both for k and ??.

Table 3.8. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3, for regular data set.

Coverage in % for:
Group Mesh c a ?0 ?1 ?2e ?

2
s k ?

?

1 0.005 0.050 95.000 92.000 0.000 65.500 73.500 73.500
2 0.005 0.090 95.500 91.500 0.000 31.500 63.000 63.500
3 0.005 0.170 92.500 91.000 0.000 0.000 31.500 31.500
4 0.005 0.200 93.000 92.500 0.000 0.000 33.500 34.000
5 0.030 0.050 95.500 91.500 0.000 57.000 73.000 73.000
6 0.030 0.090 95.500 91.500 0.000 31.500 63.000 63.500
7 0.030 0.170 92.500 91.000 0.000 0.000 31.500 31.500

GM1 8 0.030 0.200 93.000 92.500 0.000 0.000 33.500 34.000
9 0.070 0.050 95.500 91.000 0.000 10.000 60.500 63.000

10 0.070 0.090 95.500 91.500 0.000 9.000 59.500 60.500
11 0.070 0.170 92.500 91.500 0.000 0.000 31.500 33.000
12 0.070 0.200 92.500 91.500 0.000 0.500 34.000 36.000
13 0.010 0.050 93.000 91.000 0.000 0.000 33.000 34.500
14 0.010 0.090 93.000 91.000 0.000 0.000 33.000 34.500
15 0.010 0.170 93.000 91.000 0.000 0.000 33.000 34.500
16 0.010 0.200 93.000 91.000 0.000 0.000 33.000 34.500
17 0.005 0.050 93.500 92.000 0.000 4.000 55.000 55.500
18 0.005 0.090 93.500 92.500 0.000 0.000 37.500 37.500
19 0.005 0.170 97.000 90.500 35.500 95.000 87.000 87.000
20 0.005 0.200 97.000 91.500 15.500 95.500 87.500 87.000
21 0.030 0.050 96.000 91.000 0.000 1.500 53.500 53.500
22 0.030 0.090 93.500 92.500 0.000 0.000 37.500 37.500
23 0.030 0.170 97.000 90.500 35.500 95.000 87.000 87.000

GM2 24 0.030 0.200 97.000 91.500 15.500 95.500 87.500 87.000
25 0.070 0.050 92.000 90.500 15.000 27.000 27.500 27.500
26 0.070 0.090 93.000 90.500 17.500 33.000 33.500 34.000
27 0.070 0.170 97.000 90.500 35.500 95.000 87.000 87.000
28 0.070 0.200 97.000 91.500 15.500 95.500 87.500 87.000
29 0.010 0.050 97.500 92.500 18.500 95.000 86.000 85.500
30 0.010 0.090 96.000 92.500 24.500 94.000 86.000 86.000
31 0.010 0.170 96.500 90.500 20.000 95.000 90.000 90.000
32 0.010 0.200 96.500 91.000 20.500 96.000 88.000 88.000
33 0.005 0.050 96.000 92.500 0.000 30.500 76.500 76.500
34 0.005 0.090 96.500 90.000 0.000 1.500 65.500 65.500
35 0.005 0.170 97.500 92.000 41.000 95.000 84.000 84.000
36 0.005 0.200 97.500 92.500 35.000 95.000 84.000 84.000
37 0.030 0.050 96.000 91.500 0.000 20.000 72.500 72.500
38 0.030 0.090 96.500 90.000 0.000 1.500 65.500 65.500
39 0.030 0.170 97.500 92.000 41.000 95.000 84.000 84.000

GM3 40 0.030 0.200 97.500 92.500 35.000 95.000 84.000 84.000
41 0.070 0.050 93.000 87.000 13.000 23.000 34.500 35.500
42 0.070 0.090 92.500 88.000 8.000 15.500 32.500 34.000
43 0.070 0.170 97.500 92.000 38.000 95.000 82.500 82.500
44 0.070 0.200 96.500 92.500 36.000 95.500 83.500 83.500
45 0.010 0.050 96.500 92.000 37.000 95.000 83.000 83.000
46 0.010 0.090 97.000 91.500 34.500 96.000 83.500 83.500
47 0.010 0.170 96.500 92.000 37.000 95.000 83.000 83.000
48 0.010 0.200 96.500 92.000 37.000 95.000 83.000 83.000

We also calculated the bias for all the parameters and for the ratio ?
2
s

?
. These results are

presented in Table 3.9 and as we can notice, for ?0 the values are very similar and for the parameter
?1, meshes from GM2 have slightly better results. For ?2e , all meshes from GM1 have the same results,
meshes from GM2 have similar results and meshes 25 and 26 stand out with the lowest values of this
group (0.155 and 0.126, respectively) and from GM3, the best one is mesh 41 with value of 0.167 for
coverage. The bias for ?2s have some high values and the lowest one is 0.103 from mesh 29. For the
parameter k, big values for bias appear for meshes from GM1 and the lowest value is 0.028 of mesh 31.
The values for the bias are more homogeneous for parameter ?? and mesh 26 has the lowest value (0.013).



40

Results for the ratio ?
2
s

?
do not differ much between the meshes. The lowest value of bias (0.008) for the

ratio was obtained with mesh 1. Although meshes 19, 23, 27, 35 and 39 did not obtained the best results
of bias for either any parameter or the ratio, the results obtained was not so bad, compared with the best
ones.

Table 3.9. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes
with regular data set.

Bias for:

Group Mesh c a ?0 ?1 ?2e ?
2
s k ?

? ?
2
s
?

1 0.005 0.050 0.015 0.009 0.300 0.380 8.246 0.044 0.008
2 0.005 0.090 0.015 0.009 0.300 1.266 10.831 0.049 0.018
3 0.005 0.170 0.015 0.005 0.300 1.710 11.672 0.085 0.052
4 0.005 0.200 0.015 0.007 0.300 2.363 13.660 0.086 0.063
5 0.030 0.050 0.014 0.010 0.300 0.418 7.170 0.038 0.015
6 0.030 0.090 0.015 0.009 0.300 1.266 10.831 0.049 0.018
7 0.030 0.170 0.015 0.005 0.300 1.710 11.672 0.085 0.052

GM1 8 0.030 0.200 0.015 0.007 0.300 2.363 13.660 0.086 0.063
9 0.070 0.050 0.014 0.011 0.300 2.187 10.991 0.042 0.053

10 0.070 0.090 0.014 0.012 0.300 1.981 9.727 0.041 0.051
11 0.070 0.170 0.015 0.006 0.300 2.786 13.740 0.085 0.058
12 0.070 0.200 0.017 0.005 0.300 5.736 15.966 0.084 0.073
13 0.010 0.050 0.017 0.005 0.300 5.357 17.596 0.086 0.078
14 0.010 0.090 0.017 0.005 0.300 5.357 17.596 0.086 0.078
15 0.010 0.170 0.017 0.005 0.300 5.357 17.596 0.086 0.078
16 0.010 0.200 0.017 0.005 0.300 5.357 17.596 0.086 0.078
17 0.005 0.050 0.015 0.007 0.300 0.791 9.115 0.067 0.025
18 0.005 0.090 0.015 0.005 0.300 2.015 13.050 0.083 0.054
19 0.005 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081
20 0.005 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076
21 0.030 0.050 0.013 0.011 0.300 0.691 8.119 0.070 0.027
22 0.030 0.090 0.015 0.005 0.300 2.015 13.050 0.083 0.054
23 0.030 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081

GM2 24 0.030 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076
25 0.070 0.050 0.014 0.008 0.155 4.720 19.477 0.036 0.123
26 0.070 0.090 0.015 0.009 0.126 9.635 21.615 0.013 0.141
27 0.070 0.170 0.018 0.009 0.248 0.257 0.119 0.164 0.081
28 0.070 0.200 0.022 0.002 0.319 0.177 0.110 0.182 0.076
29 0.010 0.050 0.019 0.008 0.316 0.103 0.388 0.208 0.073
30 0.010 0.090 0.018 0.008 0.301 0.242 0.409 0.185 0.077
31 0.010 0.170 0.018 0.009 0.306 0.176 0.028 0.168 0.067
32 0.010 0.200 0.019 0.010 0.305 0.169 0.030 0.175 0.070
33 0.005 0.050 0.013 0.013 0.300 0.326 4.011 0.044 0.022
34 0.005 0.090 0.013 0.011 0.300 1.107 6.607 0.052 0.056
35 0.005 0.170 0.014 0.014 0.238 0.139 2.763 0.241 0.076
36 0.005 0.200 0.014 0.012 0.258 0.153 2.846 0.246 0.076
37 0.030 0.050 0.013 0.012 0.300 0.480 6.321 0.046 0.026
38 0.030 0.090 0.013 0.011 0.300 1.107 6.607 0.052 0.056
39 0.030 0.170 0.014 0.014 0.238 0.139 2.763 0.241 0.076

GM3 40 0.030 0.200 0.014 0.012 0.258 0.153 2.846 0.246 0.076
41 0.070 0.050 0.009 0.020 0.167 2.987 12.030 0.018 0.090
42 0.070 0.090 0.012 0.015 0.210 2.559 11.241 0.026 0.085
43 0.070 0.170 0.013 0.015 0.249 0.153 2.811 0.245 0.077
44 0.070 0.200 0.014 0.013 0.256 0.151 2.725 0.244 0.075
45 0.010 0.050 0.013 0.013 0.254 0.148 2.752 0.243 0.075
46 0.010 0.090 0.013 0.013 0.263 0.142 2.784 0.262 0.083
47 0.010 0.170 0.013 0.013 0.254 0.148 2.768 0.243 0.075
48 0.010 0.200 0.013 0.013 0.254 0.148 2.768 0.243 0.075

Table B.2 from the Appendix B shows the results of MSE for the parameters and the ratio,
with regular data set. The results are quite similar to the ones obtained for the bias. There is no mesh
that stands out for the values of MSE for ?0 and ?1. For ?2e , meshes 25 and 26 were the best ones, with
MSE of 0.085, followed by meshes 35 and 39, with value of 0.086. The values of MSE for the parameter
?2s are very high for some meshes and the lowest value is 0.120 obtained with meshes 35 and 39. The
best value of MSE for k was 34.614 with mesh 33, followed by 37.899 with meshes 35 and 39. Most of all
the other meshes have very high values. For the nominal range, the lowest results was 0.004 with mesh
33, followed by 0.005 with several meshes, including meshes 35 and 39. The value of MSE for the ratio
was similar between the meshes, the best results (0.004) with meshes 17 andd 21. For values of MSE,
meshes 35 and 39 have better results than meshes 19, 23 and 27.

We also calculated the coverage (in %) and MSE of prediction in the 100 coordinate of sample
locations to investigate the impact of the mesh on the predictive performance of the model. Table 3.10
shows these results and we can notice that the values of coverage for meshes fom GM1 are very low,
meshes form GM2 with small values of a (0.05 and 0.09) with small values of c (0.005 and 0.03) also have
low value for coverage and the same occur for these configuration of meshes from GM3. The best result



41

for coverage is 86.765% with meshes 35 and 39, meshes 19,23 and 27 obatined 85.720%. For MSE, all
meshes have similar results.

Table 3.10. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering
200 simulations, with regular data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 3.100 0.301 25 0.070 0.050 28.510 0.295
2 0.005 0.090 3.040 0.301 26 0.070 0.090 33.290 0.294
3 0.005 0.170 2.980 0.301 27 0.070 0.170 85.720 0.307
4 0.005 0.200 2.980 0.301 GM2 28 0.070 0.200 80.830 0.348
5 0.030 0.050 3.065 0.301 29 0.010 0.050 80.760 0.347
6 0.030 0.090 3.040 0.301 30 0.010 0.090 81.920 0.339
7 0.030 0.170 2.980 0.301 31 0.010 0.170 82.300 0.340

GM1 8 0.030 0.200 2.980 0.301 32 0.010 0.200 81.430 0.342
9 0.070 0.050 2.990 0.301 33 0.005 0.050 3.125 0.301

10 0.070 0.090 3.000 0.301 34 0.005 0.090 3.075 0.301
11 0.070 0.170 2.965 0.301 35 0.005 0.170 86.765 0.300
12 0.070 0.200 2.980 0.301 36 0.005 0.200 85.730 0.310
13 0.010 0.050 2.975 0.301 37 0.030 0.050 3.105 0.301
14 0.010 0.090 2.975 0.301 38 0.030 0.090 3.075 0.301
15 0.010 0.170 2.975 0.301 39 0.030 0.170 86.765 0.300
16 0.010 0.200 2.975 0.301 GM3 40 0.030 0.200 85.730 0.310
17 0.005 0.050 3.105 0.301 41 0.070 0.050 25.660 0.301
18 0.005 0.090 3.035 0.301 42 0.070 0.090 17.400 0.302
19 0.005 0.170 85.720 0.307 43 0.070 0.170 86.345 0.305

GM2 20 0.005 0.200 80.830 0.348 44 0.070 0.200 85.880 0.309
21 0.030 0.050 3.085 0.301 45 0.010 0.050 85.870 0.307
22 0.030 0.090 3.035 0.301 46 0.010 0.090 85.670 0.312
23 0.030 0.170 85.720 0.307 47 0.010 0.170 85.875 0.307
24 0.030 0.200 80.830 0.348 48 0.010 0.200 85.875 0.307

The predictive performance of the model was also investigated for locations not used in the
analysis and it was made in 25 locations, randomly selected. These results for coverage and MSE are
presented in Table 3.11. We can observe that the values for coverage for these 25 extra locations are
more homogeneous than for the coverage for the sample set. The best value (90.5%) was obtained with
mesh 17. Meshes 19, 23 and 27 obtained 75.580% while meshes 35 and 39 obtained 70.720%. For MSE
values, there is no mesh that stands out from the rest.

Table 3.11. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25
locations, considering 200 simulations, with regular data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 88.480 0.435 25 0.070 0.050 72.420 0.599
2 0.005 0.090 78.840 0.447 26 0.070 0.090 71.960 0.605
3 0.005 0.170 19.720 0.504 27 0.070 0.170 75.580 0.463
4 0.005 0.200 19.840 0.504 GM2 28 0.070 0.200 72.880 0.460
5 0.030 0.050 84.720 0.439 29 0.010 0.050 74.500 0.463
6 0.030 0.090 78.840 0.447 30 0.010 0.090 75.880 0.461
7 0.030 0.170 19.720 0.504 31 0.010 0.170 73.980 0.460

GM1 8 0.030 0.200 19.840 0.504 32 0.010 0.200 74.840 0.465
9 0.070 0.050 60.300 0.467 33 0.005 0.050 89.680 0.440

10 0.070 0.090 60.220 0.467 34 0.005 0.090 78.180 0.499
11 0.070 0.170 19.860 0.504 35 0.005 0.170 70.720 0.445
12 0.070 0.200 19.840 0.504 36 0.005 0.200 70.140 0.447
13 0.010 0.050 19.820 0.504 37 0.030 0.050 87.860 0.447
14 0.010 0.090 19.820 0.504 38 0.030 0.090 78.180 0.499
15 0.010 0.170 19.820 0.504 39 0.030 0.170 70.720 0.445
16 0.010 0.200 19.820 0.504 GM3 40 0.030 0.200 70.140 0.447
17 0.005 0.050 90.500 0.466 41 0.070 0.050 60.040 0.560
18 0.005 0.090 85.280 0.493 42 0.070 0.090 59.320 0.571
19 0.005 0.170 75.580 0.463 43 0.070 0.170 70.800 0.444

GM2 20 0.005 0.200 72.880 0.460 44 0.070 0.200 69.840 0.446
21 0.030 0.050 89.320 0.468 45 0.010 0.050 69.960 0.446
22 0.030 0.090 85.280 0.493 46 0.010 0.090 70.140 0.448
23 0.030 0.170 75.580 0.463 47 0.010 0.170 69.960 0.446
24 0.030 0.200 72.880 0.460 48 0.010 0.200 69.960 0.446

The bias for the prediction in these 25 extra locations was calculated and ploted with individual
boxplot for each mesh, as we can see in Figure 3.3. All the boxplots for the values of bias are quite the
same and we can notice that there is no difference between groups and nor among groups. Boxplot of
meshes with c = 0.10 tends to be more homogeneous.



42

Figure 3.3. Bias for Y in 25 extra locations, with regular data set.

As for the random data set, we can observe that these results showed that there is a large
impact of the mesh on parameter estimation and prediction and there is not a single mesh which is
optimal in everything. So, to select an optimal mesh, we calculate the mean of DIC, WAIC and logCPO
and these results are in Table 3.12. We can notice that, despite only meshes 1 and 5 have more than one
thousan knots, all meshes from GM1 have similar results for DIC and WAIC and are among the lowest
values. But, meshes from this gruop did not have any good results. Considering logCPO, the best value
was 1.361 from meshes 30 and 32. Meshe 19, 23 and 27 obtained 254.947(DIC), 258.455 (WAIC) and
1.364 (logCPO). Meshes 35 and 39, obtained 1.367 for logCPO and for DIC and WAIC, this two meshes
obtained 256.932 and 258.662, respectively. The three meshes from GM2 have better results.

Meshes 19, 23 and 27 have all the same results and in fact, have the same number of knots
and the same occur withe meshes 35 and 39 between them. If we consider all the results of bias, MSE,
coverage of parameter estimates, predictions and also DIC, WAIC and logCPO we can assume that the
threes meshes form GM2 are the optimals ones.

Table 3.12. Mean values of DIC, WAIC and logCPO for meshes with regular data set .
Group Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO

1 0.005 0.050 -579.196 -592.839 2.312 25 0.070 0.050 -335.895 -345.227 2.370
2 0.005 0.090 -580.335 -594.935 2.391 26 0.070 0.090 -286.396 -294.157 2.274
3 0.005 0.170 -582.154 -598.045 2.474 27 0.070 0.170 254.947 258.455 1.364
4 0.005 0.200 -582.022 -597.948 2.475 GM2 28 0.070 0.200 264.722 266.418 1.363
5 0.030 0.050 -579.478 -593.444 2.336 29 0.010 0.050 264.149 265.766 1.362
6 0.030 0.090 -580.335 -594.935 2.391 30 0.010 0.090 262.865 264.600 1.361
7 0.030 0.170 -582.154 -598.045 2.474 31 0.010 0.170 263.674 265.591 1.363

GM1 8 0.030 0.200 -582.022 -597.948 2.475 32 0.010 0.200 263.287 264.924 1.361
9 0.070 0.050 -581.576 -597.302 2.502 33 0.005 0.050 -579.016 -592.257 2.340

10 0.070 0.090 -581.712 -597.473 2.477 34 0.005 0.090 -579.656 -593.857 2.471
11 0.070 0.170 -582.055 -598.090 2.467 35 0.005 0.170 256.932 258.662 1.367
12 0.070 0.200 -582.052 -597.709 2.471 36 0.005 0.200 259.909 261.429 1.367
13 0.010 0.050 -581.955 -598.152 2.481 37 0.030 0.050 -579.043 -592.596 2.363
14 0.010 0.090 -581.955 -598.152 2.481 38 0.030 0.090 -579.656 -593.857 2.471
15 0.010 0.170 -581.955 -598.152 2.481 39 0.030 0.170 256.932 258.662 1.367
16 0.010 0.200 -581.955 -598.152 2.481 GM3 40 0.030 0.200 259.909 261.429 1.367
17 0.005 0.050 -579.227 -592.826 2.339 41 0.070 0.050 -355.104 -365.382 2.382
18 0.005 0.090 -580.254 -594.793 2.410 42 0.070 0.090 -436.668 -448.883 2.511
19 0.005 0.170 254.947 258.455 1.364 43 0.070 0.170 258.444 260.108 1.367

GM2 20 0.005 0.200 264.722 266.418 1.363 44 0.070 0.200 259.794 261.287 1.368
21 0.030 0.050 -579.273 -593.235 2.336 45 0.010 0.050 259.219 260.790 1.367
22 0.030 0.090 -580.254 -594.793 2.410 46 0.010 0.090 259.749 261.360 1.368
23 0.030 0.170 254.947 258.455 1.364 47 0.010 0.170 259.219 260.790 1.367
24 0.030 0.200 264.722 266.418 1.363 48 0.010 0.200 259.219 260.790 1.367

In Figure 3.4 we can observe boxplots of parameter estimates based on the mesh with lowest
DIC, WAIC or logCPO, obtained in each simulation and we also present in this figure the boxplots of



43

the estimates obtained for each parameter with mesh 19.
We can observe that the boxplots obtained with mesh 19 are more similar to the boxplots

obtained for the results of logCPO. Also, selection of the mesh using DIC and WAIC has bad performance,
seen in the large bias of all covariance parameters. In this case, DIC and WAIC tends to select not only
more denses meshes but also the ones with really bad results.

Figure 3.4. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and
logCPO, and based on mesh 19 for regular data set.

• Cluster data set

As same as for random data set, for cluster data we conduct the simulation in five batches of
40 simulations and within one batch the coordinates are kept fixed, resulting in 200 simulation. Table
3.13 shows the average number of knots for each mesh. .



44

Table 3.13. Average number of knots for different combinations of the parameters a and c, with
parameter b = 0.3 for cluster data.

c=0.005 c=0.03 c=0.07 c=0.10
GM1 a=0.05 1539 1143 265 145

a=0.09 587 550 265 143
a=0.17 346 281 199 143
a=0.20 333 265 166 140

GM2 a=0.05 2109 1586 370 208
a=0.09 727 727 369 208
a=0.17 252 252 252 209
a=0.20 212 212 212 206

GM3 a=0.05 1524 1147 262 143
a=0.09 550 548 263 142
a=0.17 250 247 195 142
a=0.20 227 223 162 138

For ?0, ?1?2e , ?2s , k and ??, we calculated values for coverage and summarized the results in
Table 3.14 and in the Appendix B, Figure B.3 shows the values of coverage.. The results for cluster data
set are very similar to the results for random data. Values of coverage for ?0 and ?1 are very similiar
amongst the meshes. For ?2e , the parameter more critical for coverage, mesh 5 has the best results of
86.500%, For ?2s , k and ??, the results are quite homogeneous between meshes, although the meshes with
c = 0.005 from GM1 stand out with very low results. The best results for ?2s is 98.5% with mesh 5; mesh
31 got the best value of 98.5% for the parameter k and the best results of coverage for ?? was 89.5% with
mesh 37.

Excluding ?0 and ?1, we have four parameters and three meshes with good results: mesh 5, 31
and 37. Looking for the results of these three meshes, mesh 31 is not efficient in covering ?2e . Meshes 5
and 37 have very similar results. It is worth mentioning that both have the same value for a = 0.05 and
c = 0.03.



45

Table 3.14. Coverage, in %, of the 95% credible intervals of the parameters ?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3, for cluster data set.

Coverage in % for:
Group Mesh c a ?0 ?1 ?2e ?

2
s k ?

?

1 0.005 0.050 89.500 87.000 28.500 59.000 31.000 31.000
2 0.005 0.090 89.000 84.000 22.500 33.500 25.500 25.500
3 0.005 0.170 91.500 86.500 23.000 27.500 28.500 28.500
4 0.005 0.200 93.000 87.000 22.500 27.500 32.000 32.000
5 0.030 0.050 97.000 93.000 86.500 98.500 86.500 86.000
6 0.030 0.090 97.500 93.500 84.500 98.000 87.500 87.500
7 0.030 0.170 96.500 94.000 80.500 96.000 86.000 86.000

GM1 8 0.030 0.200 97.000 93.500 80.000 97.000 88.000 88.000
9 0.070 0.050 96.000 93.500 56.000 97.000 83.500 83.500

10 0.070 0.090 95.500 93.500 58.500 97.000 83.000 83.000
11 0.070 0.170 97.500 92.500 35.500 97.000 80.000 80.000
12 0.070 0.200 97.000 93.500 33.500 96.000 82.000 82.000
13 0.010 0.050 98.000 93.500 24.000 95.500 79.000 78.500
14 0.010 0.090 98.000 93.500 21.000 95.000 79.000 79.000
15 0.010 0.170 97.500 94.000 23.000 95.500 80.500 80.000
16 0.010 0.200 98.000 93.500 18.000 93.000 82.500 82.500
17 0.005 0.050 96.500 92.000 81.000 88.000 82.000 82.000
18 0.005 0.090 96.500 92.500 73.000 92.000 85.000 85.000
19 0.005 0.170 98.000 94.500 27.000 86.000 83.000 83.000
20 0.005 0.200 99.000 94.000 16.500 88.000 85.500 86.000
21 0.030 0.050 96.500 93.500 81.000 91.500 87.500 87.500
22 0.030 0.090 96.500 92.500 73.000 92.000 85.000 85.000
23 0.030 0.170 98.000 94.500 27.000 86.000 83.000 83.000

GM2 24 0.030 0.200 99.000 94.000 16.500 88.000 85.500 86.000
25 0.070 0.050 97.000 92.000 45.000 88.500 85.500 85.500
26 0.070 0.090 96.500 92.000 47.500 89.000 84.500 84.500
27 0.070 0.170 98.000 94.500 27.000 86.000 83.000 83.000
28 0.070 0.200 99.000 94.000 16.500 88.000 85.500 86.000
29 0.010 0.050 97.000 93.000 17.000 86.000 82.500 81.500
30 0.010 0.090 96.500 92.500 21.000 83.500 85.000 85.000
31 0.010 0.170 98.000 93.000 22.500 87.000 88.500 88.500
32 0.010 0.200 98.000 92.500 21.500 86.500 83.500 83.500
33 0.005 0.050 96.500 93.500 83.000 93.000 86.500 86.000
34 0.005 0.090 98.000 93.000 78.500 97.500 86.500 86.500
35 0.005 0.170 97.000 93.500 39.500 96.500 84.500 84.000
36 0.005 0.200 96.000 93.000 35.000 95.500 79.500 79.500
37 0.030 0.050 97.000 93.500 83.000 96.000 89.500 89.500
38 0.030 0.090 98.000 93.000 78.500 97.500 86.500 86.500
39 0.030 0.170 97.000 93.500 39.500 96.500 84.500 84.500

GM3 40 0.030 0.200 96.000 93.000 35.000 96.000 79.000 79.500
41 0.070 0.050 98.000 92.500 47.000 96.500 81.000 81.000
42 0.070 0.090 98.000 93.000 48.500 97.000 82.000 81.500
43 0.070 0.170 97.000 92.500 35.500 95.000 80.500 80.500
44 0.070 0.200 96.500 93.000 29.500 94.500 81.000 81.000
45 0.010 0.050 98.500 91.500 18.500 96.000 85.500 85.500
46 0.010 0.090 98.500 92.000 19.500 95.500 84.500 84.000
47 0.010 0.170 98.500 91.500 17.500 96.000 85.500 85.500
48 0.010 0.200 98.500 91.500 17.500 95.000 85.000 85.000

Besides the coverage, we also calculated the values for bias for the six parameters and for the
ratio ?

2
s

?
. Table 3.15 shows this results and we can observe that no huge difference appears for ?0 and

?1. For ?2e , the best result occur with mesh 33 with value of 0.001. For ?2e , mesh 5 obtain 0.006 of bias
and mesh 37 got 0.018. For the parameter ?2s the best result (0.002) was with mesh 5; mesh 37 obtain
0.039. For parameter k, the values of bias are more different between the meshes. The best result was
0.066 with mesh 34; mesh 5 got 1.034 and for mesh 37 it was 1.274. The value of bias for ?? was best
with meshes 3 and 4 with value of 0.027. For this parameter, bias with mesh 5 was 0.071 and with mesh
37 was 0.065. The results for the ratio ?

2
s

?
are not very different between the meshes; meshes from GM1

with c = 0.005 obtain better results and the best one was 0.003 with mesh 2. For the ratio, mesh 5 got
0.051 and mesh 37 got 0.050. In general, considering values of bias, mesh 5 was better than mesh 37.

Table B.3 from the Appendix B shows the results of MSE for the parameters and the ratio.
This value for ?0 and ?1 are very similar for all meshes, also for ?2e . The best result (0.015) of MSE for
?2e was with mesh 6. Mesh 5 got 0.016 and mesh 37 got 0.017. For the parameter ?2s , the lowest value
was 0.052 with mesh 5 and mesh 37 got 0.093. Values of MSE for k are very high and the best one was
60.188 with mesh 7. Meshes 5 and 37 obtained 117.775 and 93.509, respectively. For ??, the best value
was 0.028 with mesh 2. Value for mesh 5 and mesh 37 was 0.037 and 0.042, in this order. MSE for the
ratio has tittle change between the meshes and the lowest value was 0.010 with mesh 4 and for meshes 5
and 37 the values was 0.023 and 0.027, respectively. Again meshe 5 has slightly better results than mesh
37.

Values for coverage and MSE was calculated to evaluate prediction in the 100 coordinate of



46

Table 3.15. Absolute bias of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes
with cluster data set.

Bias for:

Group Mesh c a ?0 ?1 ?2e ?
2
s k ?

? ?
2
s
?

1 0.005 0.050 0.009 0.027 0.219 0.216 12.153 0.047 0.012
2 0.005 0.090 0.005 0.029 0.228 0.361 10.745 0.051 0.003
3 0.005 0.170 0.007 0.029 0.216 0.492 7.078 0.027 0.033
4 0.005 0.200 0.010 0.025 0.214 0.510 6.286 0.027 0.034
5 0.030 0.050 0.013 0.016 0.006 0.002 1.034 0.071 0.051
6 0.030 0.090 0.014 0.015 0.046 0.016 0.313 0.096 0.064
7 0.030 0.170 0.014 0.016 0.064 0.029 0.350 0.106 0.076

GM1 8 0.030 0.200 0.015 0.017 0.065 0.036 0.508 0.099 0.073
9 0.070 0.050 0.011 0.024 0.145 0.046 0.505 0.125 0.081

10 0.070 0.090 0.011 0.025 0.145 0.048 0.603 0.126 0.080
11 0.070 0.170 0.013 0.022 0.173 0.053 0.522 0.129 0.085
12 0.070 0.200 0.013 0.023 0.182 0.079 0.512 0.124 0.087
13 0.010 0.050 0.015 0.024 0.210 0.258 2.124 0.138 0.102
14 0.010 0.090 0.014 0.024 0.213 0.257 2.032 0.137 0.101
15 0.010 0.170 0.015 0.023 0.210 0.247 1.986 0.140 0.105
16 0.010 0.200 0.014 0.023 0.219 0.265 2.094 0.137 0.104
17 0.005 0.050 0.013 0.011 0.010 0.132 2.746 0.058 0.059
18 0.005 0.090 0.011 0.019 0.088 0.172 1.828 0.089 0.078
19 0.005 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127
20 0.005 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125
21 0.030 0.050 0.014 0.011 0.035 0.138 2.383 0.067 0.065
22 0.030 0.090 0.011 0.019 0.088 0.172 1.828 0.089 0.078
23 0.030 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127

GM2 24 0.030 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125
25 0.070 0.050 0.014 0.017 0.161 0.339 2.267 0.102 0.097
26 0.070 0.090 0.010 0.022 0.157 0.345 3.052 0.089 0.090
27 0.070 0.170 0.010 0.019 0.200 0.551 3.424 0.111 0.127
28 0.070 0.200 0.013 0.016 0.236 0.527 2.780 0.118 0.125
29 0.010 0.050 0.010 0.021 0.232 0.699 4.141 0.110 0.141
30 0.010 0.090 0.013 0.015 0.224 0.646 3.723 0.108 0.120
31 0.010 0.170 0.014 0.016 0.224 0.563 3.705 0.097 0.116
32 0.010 0.200 0.012 0.019 0.226 0.688 4.129 0.110 0.128
33 0.005 0.050 0.012 0.019 0.001 0.053 2.364 0.056 0.046
34 0.005 0.090 0.015 0.017 0.083 0.007 0.066 0.100 0.066
35 0.005 0.170 0.015 0.018 0.172 0.043 0.542 0.127 0.086
36 0.005 0.200 0.014 0.019 0.183 0.143 1.348 0.125 0.093
37 0.030 0.050 0.013 0.019 0.018 0.039 1.274 0.065 0.050
38 0.030 0.090 0.015 0.017 0.083 0.007 0.091 0.101 0.067
39 0.030 0.170 0.015 0.018 0.172 0.045 0.574 0.127 0.086

GM3 40 0.030 0.200 0.014 0.019 0.182 0.138 1.285 0.125 0.093
41 0.070 0.050 0.016 0.019 0.152 0.041 0.402 0.127 0.083
42 0.070 0.090 0.016 0.018 0.150 0.039 0.412 0.126 0.082
43 0.070 0.170 0.016 0.019 0.176 0.122 1.548 0.122 0.094
44 0.070 0.200 0.015 0.019 0.192 0.220 1.886 0.125 0.098
45 0.010 0.050 0.014 0.023 0.216 0.171 1.278 0.134 0.107
46 0.010 0.090 0.015 0.022 0.215 0.173 1.272 0.135 0.108
47 0.010 0.170 0.014 0.024 0.215 0.177 1.330 0.134 0.107
48 0.010 0.200 0.015 0.023 0.218 0.226 1.829 0.128 0.106

sample locations. Meshes with c = 0.005 from GM1 obtained the worst result for coverage. The best
value was 91.550 % with mesh 5, mesh 37 obtained 90.600%. For MSE, values were very similar and the
best one was 0.189 with mesh 5.

Table 3.16. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh, considering
200 simulations, with cluster data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 36.975 0.263 25 0.070 0.050 85.855 0.232
2 0.005 0.090 34.060 0.267 26 0.070 0.090 85.990 0.230
3 0.005 0.170 34.820 0.265 27 0.070 0.170 82.375 0.255
4 0.005 0.200 36.060 0.264 GM2 28 0.070 0.200 78.720 0.278
5 0.030 0.050 91.550 0.189 29 0.010 0.050 78.825 0.273
6 0.030 0.090 91.290 0.191 30 0.010 0.090 79.805 0.269
7 0.030 0.170 90.525 0.196 31 0.010 0.170 79.650 0.269

GM1 8 0.030 0.200 90.710 0.196 32 0.010 0.200 79.745 0.269
9 0.070 0.050 86.380 0.223 33 0.005 0.050 87.985 0.194

10 0.070 0.090 86.325 0.223 34 0.005 0.090 90.135 0.201
11 0.070 0.170 84.120 0.237 35 0.005 0.170 83.660 0.238
12 0.070 0.200 82.995 0.242 36 0.005 0.200 82.725 0.244
13 0.010 0.050 80.220 0.260 37 0.030 0.050 90.600 0.192
14 0.010 0.090 79.890 0.262 38 0.030 0.090 90.120 0.201
15 0.010 0.170 80.180 0.260 39 0.030 0.170 83.650 0.238
16 0.010 0.200 79.355 0.265 GM3 40 0.030 0.200 82.750 0.244
17 0.005 0.050 89.090 0.195 41 0.070 0.050 85.570 0.227
18 0.005 0.090 90.030 0.204 42 0.070 0.090 85.815 0.226
19 0.005 0.170 82.375 0.255 43 0.070 0.170 82.635 0.241

GM2 20 0.005 0.200 78.720 0.278 44 0.070 0.200 81.355 0.249
21 0.030 0.050 91.115 0.194 45 0.010 0.050 79.820 0.263
22 0.030 0.090 90.030 0.204 46 0.010 0.090 79.715 0.262
23 0.030 0.170 82.375 0.255 47 0.010 0.170 79.795 0.263
24 0.030 0.200 78.720 0.278 48 0.010 0.200 79.510 0.264



47

For 25 locations not used in the analysis and randomly chosen, we also calcultaed the predictive
performance of the model. Table 3.17 presents the results for coverage and MSE for this 25 extra locations.
The best value for coverage was 91.320% with mesh 17 from GM2; meshes 5 and 37 obtained 88.260%
and 88.800%, respectively. Values for MSE did not differ greatly between groups nor among groups. The
lowest value was 0.458 with meshes 6, 34, 37 and 38; mesh 5 got 0.459.

Table 3.17. Nominal coverage, in %, and MSE for the variable Y na calculated for each mesh in 25
locations, considering 200 simulations, with cluster data set.

Group Mesh c a Coverage(%) MSE Group Mesh c a Coverage(%) MSE
1 0.005 0.050 90.920 0.471 25 0.070 0.050 82.200 0.471
2 0.005 0.090 82.560 0.473 26 0.070 0.090 82.400 0.470
3 0.005 0.170 67.600 0.486 27 0.070 0.170 80.760 0.473
4 0.005 0.200 63.680 0.493 GM2 28 0.070 0.200 78.600 0.480
5 0.030 0.050 88.260 0.459 29 0.010 0.050 78.180 0.481
6 0.030 0.090 84.520 0.458 30 0.010 0.090 76.660 0.486
7 0.030 0.170 77.160 0.461 31 0.010 0.170 77.360 0.488

GM1 8 0.030 0.200 75.420 0.461 32 0.010 0.200 76.960 0.485
9 0.070 0.050 79.680 0.466 33 0.005 0.050 89.460 0.460

10 0.070 0.090 79.820 0.465 34 0.005 0.090 85.220 0.458
11 0.070 0.170 75.500 0.470 35 0.005 0.170 76.000 0.467
12 0.070 0.200 73.360 0.469 36 0.005 0.200 73.160 0.467
13 0.010 0.050 73.620 0.475 37 0.030 0.050 88.800 0.458
14 0.010 0.090 73.460 0.475 38 0.030 0.090 85.220 0.458
15 0.010 0.170 73.600 0.475 39 0.030 0.170 75.960 0.467
16 0.010 0.200 72.960 0.476 GM3 40 0.030 0.200 73.140 0.467
17 0.005 0.050 91.320 0.462 41 0.070 0.050 79.360 0.465
18 0.005 0.090 87.000 0.460 42 0.070 0.090 79.200 0.464
19 0.005 0.170 80.760 0.473 43 0.070 0.170 75.980 0.467

GM2 20 0.005 0.200 78.600 0.480 44 0.070 0.200 73.080 0.469
21 0.030 0.050 90.140 0.467 45 0.010 0.050 73.980 0.475
22 0.030 0.090 87.000 0.460 46 0.010 0.090 74.200 0.475
23 0.030 0.170 80.760 0.473 47 0.010 0.170 73.940 0.475
24 0.030 0.200 78.600 0.480 48 0.010 0.200 73.560 0.474

The bias for the prediction in these 25 extra locations was calculated and ploted with individual
boxplot for each mesh (Figure 3.5). As we can notice, all the boxplots for the values of bias are quite the
same.

Figure 3.5. Bias for Y in 25 extra locations, with regular data set.

As for the others data set, we can observe that there is a large impact of the mesh on parameter
estimation and prediction and there is not a single mesh which is optimal in all results. To try to select
an optimal mesh, we calculate the mean of DIC, WAIC and logCPO (Table 3.18). Meshes from GM1
with c = 0.005, got negative values for DIC and WAIC and were the meshes with higher values of
logCPO. Disregarding this meshes, the lowest value for DIC and WAIC were both with mesh 33 (180.702
and 182.276, respectively). The lowest value for logCPO was 1.253 with meshes 6,7 and 18. Values for



48

mesh 5 were DIC=215.528, WAIC=216.189 and logCPO= 1.255 and for mesh 37 were DIC=208.811,
WAIC=210.748 and logCPO=1.262.

Table 3.18. Mean values of DIC, WAIC and logCPO for meshes with cluster data set .
Group Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO

1 0.005 0.050 -277.241 -277.101 1.810 25 0.070 0.050 240.772 242.300 1.260
2 0.005 0.090 -294.297 -299.530 1.809 26 0.070 0.090 240.600 242.299 1.260
3 0.005 0.170 -285.426 -292.638 1.808 27 0.070 0.170 244.745 246.397 1.265
4 0.005 0.200 -275.800 -279.642 1.795 GM2 28 0.070 0.200 248.235 249.763 1.273
5 0.030 0.050 215.528 216.189 1.255 29 0.010 0.050 247.828 249.316 1.271
6 0.030 0.090 225.410 225.558 1.253 30 0.010 0.090 246.918 248.395 1.268
7 0.030 0.170 228.594 228.673 1.253 31 0.010 0.170 247.144 248.646 1.270

GM1 8 0.030 0.200 229.018 229.180 1.254 32 0.010 0.200 247.121 248.697 1.269
9 0.070 0.050 240.008 240.634 1.259 33 0.005 0.050 180.702 182.276 1.298

10 0.070 0.090 240.042 240.651 1.259 34 0.005 0.090 231.515 232.218 1.255
11 0.070 0.170 243.106 243.729 1.263 35 0.005 0.170 242.657 243.356 1.261
12 0.070 0.200 243.876 244.484 1.264 36 0.005 0.200 243.752 244.468 1.262
13 0.010 0.050 246.180 246.919 1.267 37 0.030 0.050 208.811 210.748 1.262
14 0.010 0.090 246.592 247.284 1.268 38 0.030 0.090 231.541 232.245 1.255
15 0.010 0.170 246.203 246.946 1.267 39 0.030 0.170 242.633 243.333 1.261
16 0.010 0.200 247.122 247.812 1.269 GM3 40 0.030 0.200 243.701 244.419 1.262
17 0.005 0.050 195.986 198.941 1.271 41 0.070 0.050 240.637 241.284 1.259
18 0.005 0.090 230.923 232.265 1.253 42 0.070 0.090 240.352 240.997 1.258
19 0.005 0.170 244.745 246.397 1.265 43 0.070 0.170 242.941 243.538 1.261

GM2 20 0.005 0.200 248.235 249.763 1.273 44 0.070 0.200 244.638 245.247 1.263
21 0.030 0.050 217.715 220.822 1.254 45 0.010 0.050 247.072 247.860 1.270
22 0.030 0.090 230.923 232.265 1.253 46 0.010 0.090 246.952 247.744 1.269
23 0.030 0.170 244.745 246.397 1.265 47 0.010 0.170 247.051 247.840 1.270
24 0.030 0.200 248.235 249.763 1.273 48 0.010 0.200 247.217 247.991 1.269

Considering all results, meshes 5 and 37 stand out from the other meshes and mesh 5 have
slightly better results tha mesh 37.

In Figure 3.6 we can observe boxplots of parameter estimates based on the mesh with lowest
DIC, WAIC or logCPO, obtained in each simulation and we also present in this figure the boxplots of the
estimates obtained for each parameter with mesh 5. Boxplots obtained with mesh 5 are more similar to
the boxplots obtained for the results of logCPO. Also, selection of mesh using DIC and WAIC has bad
performance, seen in the large bias of all covariance parameters.



49

Figure 3.6. Estimated ?0, ?1, ?2e , ?2s , k and ??, considering the meshes with minimal DIC, WAIC and
logCPO, and based on mesh 5 for cluster data set.

3.4 Data Analysis

• Parana? dataset

One of the analyzed datasets was the so called Parana? dataset, available in the geoR package
(Ribeiro and Diggle, 2001) in R. The data were collected in 143 random locations and consider the mean
levels of precipitation in the entire state of Paran?-Brazil, and the response variable represents the average
winter precipitation (dry season).

To perform the analysis we take out the linear trend from the variable, because we noticed that
this trend lead to misleading results. To model these data, we assume the model y = ?0 + s + ?, where s
is a Mate?rn spatial random field with ? = 1.5

Performing a semivariogram analysis, we assumed the range as 380(??) and based on this value,
we created 54 meshes being 18 created with all locations (GM1), 18 created with domain (GM2) and
18 created with part of the locations using the space filling algorithm (GM3). To create each of this 18
meshes, for the maximal allowed lengths of triangle edges in the inner domain (a) we used the values
a = c(20, 35, 55, 100, 240, 380) taking into account the value of range and allowing for small values until
we reach the expected value of the range. For the maximal allowed lengths of triangle edges in the outer
domain (b) the value was b = 570 and for the shortest distance allowed between points (c) the values
were c = c(13, 35, 51). For the domain, we used the bordes available in the data set plus 2.5. Table 3.19
show the number of knots for each mesh in each group and Figures B.4-B.12 of Appendix B show the
image of the meshes.



50

Table 3.19. Number of knots for each mesh for Paran? data.
Group Mesh c a Number knots Group Mesh c a Number knots Group Mesh c a Number knots

1 13 20 1235 19 13 20 1410 37 13 20 1218
2 13 35 678 20 13 35 777 38 13 35 679
3 13 55 362 21 13 55 353 39 13 55 320
4 13 100 234 22 13 100 125 40 13 100 152
5 13 240 230 23 13 240 45 41 13 240 137
6 13 380 230 24 13 380 32 42 13 380 137
7 35 20 197 25 35 20 209 43 35 20 193
8 35 35 195 26 35 35 212 44 35 35 194

GM1 9 35 55 194 GM2 27 35 55 208 GM3 45 35 55 192
10 35 100 134 28 35 100 126 46 35 100 126
11 35 240 122 29 35 240 42 47 35 240 104
12 35 380 122 30 35 380 32 48 35 380 104
13 51 20 100 31 51 20 119 49 51 20 106
14 51 35 100 32 51 35 118 50 51 35 105
15 51 55 97 33 51 55 117 51 51 55 104
16 51 100 94 34 51 100 114 52 51 100 105
17 51 240 77 35 51 240 41 53 51 240 80
18 51 380 77 36 51 380 32 54 51 380 80

Figure B.13 in the Appendix B, shows the posterior distributions for ?0, ?2s , k and ?? and
we can notice that for ?0, the posterior for mesh 37 behaves differently from other meshes with less
variability, for the parameter ?2s the posterior for mesh 37 has a high variability and posterior for meshes
23, 24, 29, 30, 35 and 36 stand out from the others with different means and variability. We can notice
that the same occur with the posterior of this six meshes for k and ??. The parameter estimates are in
Table 3.20 and we can observe that the choice of the mesh does not have a large impact on the estimates.
Meshes 9, 13 until 16 and 26 have better results for ?2s and for parameter ??, mesh 23 has the best value,
although mesh 16 also gets good results.

Table 3.20. Estimates of the parameters for each meshfor Paran? data.
Group Mesh c a ?0 ?2s k ?

? Group Mesh c a ?0 ?2s k ?
?

1 13 20 -3.041 1004.249 0.004 530.363 28 35 100 -2.809 1071.426 0.004 564.845
2 35 -2.899 1019.222 0.004 568.737 29 240 -4.124 2111.668 0.009 226.850
3 55 -2.883 1026.202 0.003 573.441 30 380 -7.804 3161.480 0.014 144.841
4 100 -2.867 1020.585 0.003 588.119 31 51 20 -2.695 1085.372 0.004 558.542
5 240 -2.852 1007.166 0.003 582.856 GM2 32 35 -2.726 1092.988 0.004 568.645
6 380 -2.852 1007.166 0.003 582.856 33 55 -2.961 1070.469 0.004 532.726
7 35 20 -2.797 1002.032 0.004 555.719 34 100 -3.057 1145.570 0.003 584.626
8 35 -2.747 1003.724 0.004 570.486 35 240 -4.022 1720.023 0.008 243.698

GM1 9 55 -2.766 987.824 0.004 556.803 36 380 -7.547 3285.426 0.013 152.666
10 100 -2.605 1018.224 0.003 588.273 37 13 20 -3.907 19759.314 0.318 6.293
11 240 -2.370 1063.741 0.003 618.143 38 35 -2.781 1016.201 0.004 565.346
12 380 -2.370 1063.741 0.003 618.143 39 55 -2.865 1009.105 0.004 557.738
13 51 20 -3.249 994.481 0.004 520.953 40 100 -2.738 1041.134 0.003 638.464
14 35 -3.145 979.349 0.004 512.673 41 240 -2.608 1033.338 0.003 638.393
15 55 -3.244 979.765 0.004 504.027 42 380 -2.608 1033.338 0.003 638.393
16 100 -3.140 979.482 0.004 494.867 43 35 20 -3.068 1025.605 0.003 572.346
17 240 -2.110 1263.745 0.003 666.639 44 35 -3.048 1039.799 0.003 573.872
18 380 -2.110 1263.745 0.003 666.639 GM3 45 55 -3.062 1045.103 0.003 578.584
19 13 20 -3.101 1027.246 0.004 516.609 46 100 -2.892 1080.247 0.003 662.980
20 35 -3.227 1021.859 0.004 498.400 47 240 -2.763 1103.220 0.003 670.484
21 55 -3.023 1032.815 0.004 511.843 48 380 -2.763 1103.220 0.003 670.484
22 100 -2.943 1046.193 0.004 505.889 49 51 20 -2.787 1043.170 0.003 583.009

GM2 23 240 -3.550 1627.018 0.006 318.852 50 35 -2.741 1041.540 0.003 582.401
24 380 -7.615 3362.882 0.013 155.867 51 55 -2.642 1039.266 0.003 581.089
25 35 20 -2.986 1010.473 0.004 543.476 52 100 -2.479 1075.265 0.003 614.429
26 35 -3.058 989.798 0.004 529.683 53 240 -3.091 1032.363 0.004 540.050
27 55 -3.017 1017.109 0.004 538.467 54 380 -3.091 1032.363 0.004 540.050

The values of DIC, WAIC and logCPO was computed and added into Table 3.21 and we can
notice better results for mesh 37 but this mesh has really bad results for estimates. Values for DIC, WAIC
and logCPO show minor difference between the meshes. So, we can assume mesh 16 is the optimal one.



51

Table 3.21. Values for DIC, WAIC and logCPO for each mesh for Paran? data.
Group Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO

1 13 20 1305.94 1306.35 4.58 28 35 100 1311.83 1312.10 4.59
2 35 1307.34 1307.46 4.58 29 240 1300.32 1299.51 4.55
3 55 1306.53 1306.47 4.58 30 380 1311.99 1311.71 4.59
4 100 1307.85 1307.78 4.58 31 51 20 1309.11 1308.93 4.58
5 240 1307.97 1307.91 4.58 GM2 32 35 1309.31 1309.08 4.58
6 380 1307.97 1307.91 4.58 33 55 1307.69 1307.24 4.58
7 35 20 1307.69 1306.64 4.58 34 100 1308.75 1308.86 4.58
8 35 1308.14 1307.04 4.58 35 240 1306.39 1305.56 4.57

GM1 9 55 1307.90 1306.81 4.58 36 380 1316.75 1316.43 4.60
10 100 1309.51 1308.59 4.58 37 13 20 -838.05 -862.64 -2.12
11 240 1309.71 1308.65 4.58 38 35 1307.64 1307.85 4.58
12 380 1309.71 1308.65 4.58 39 55 1306.69 1306.88 4.58
13 51 20 1308.18 1307.65 4.58 40 100 1310.78 1310.67 4.59
14 35 1308.44 1307.93 4.58 41 240 1310.56 1310.49 4.59
15 55 1307.65 1307.09 4.58 42 380 1310.56 1310.49 4.59
16 100 1307.60 1307.08 4.58 43 35 20 1308.01 1308.17 4.58
17 240 1307.83 1307.05 4.57 44 35 1307.69 1307.77 4.58
18 380 1307.83 1307.05 4.57 GM3 45 55 1308.05 1308.17 4.58
19 13 20 1306.33 1306.97 4.58 46 100 1313.99 1314.40 4.60
20 35 1305.62 1306.48 4.58 47 240 1313.50 1313.78 4.60
21 55 1306.63 1306.99 4.58 48 380 1313.50 1313.78 4.60
22 100 1307.74 1307.51 4.58 49 51 20 1312.86 1313.90 4.60

GM2 23 240 1307.18 1306.44 4.57 50 35 1312.66 1313.39 4.60
24 380 1316.20 1315.69 4.60 51 55 1313.08 1314.15 4.60
25 35 20 1309.85 1310.09 4.59 52 100 1313.13 1314.24 4.60
26 35 1310.06 1310.20 4.59 53 240 1310.72 1311.30 4.59
27 55 1308.95 1308.97 4.58 54 380 1310.72 1311.30 4.59

Using mesh 16, we computed the prediction mean and prediction standard deviation over the
study area (the two figures from the bottom in Figure 3.7). Comparing Figure 3.7 II and Figure 3.7 III
we can assume that mesh 16 gives good prediction.

(I) (II)

(III) (IV)

Figure 3.7. (I) Histogram, (II) plot of sample and corresponding values, (III) predicted surface and
(IV) prediction standard deviation considering mesh 16.

• Soil dataset

The data set here analyzed is the camg data set, in a regular grid, also available in the geoR
package (Ribeiro and Diggle, 2001) in R. We are analyzing the soil samples of magnesium in depth 0-20,
named mg020, colected in 178 locations.



52

To model these data, we assume the model y = ?0 + s + ?, where s is a Mate?rn spatial random
field with ? = 1.5. The variance of the variable is 39.39 and with the aid of a semivariogram analysis, we
assumed the range as 400 (??) and so, k = 0.005. Based on this value we created 54 meshes. The same
as before, we separeted the meshes into three groups: 18 meshes created with all locations (GM1), 18
created with domain (GM2) and 18 created with part of the locations using the space filling algorithm
(GM3).

To create the meshes, we considered for the maximal allowed lengths of triangle edges in
the inner domain (a) the values (20,40,60,120,260,400); for the maximal allowed lengths of triangle
edges in the outer domain (b) the value was b = 600 and for the shortest distance allowed between
points (c) the values were (14,37,54). To create the domain, we use one function of the package R-
INLA called inla.nonconvex.hull and the domain is given by inla.nonconvex.hull(coordinate,60,
50,resolution=c(90,90))$loc. Figures B.14-B.22 from Appendix B show the images of created meshes
and Table 3.22 below shows the number of knots for each mesh.

Table 3.22. Number of knots for each mesh for soil data.
Group Mesh c a Number knots Group Mesh c a Number knots Group Mesh c a Number knots

1 14 20 3362 19 14 20 4313 37 14 20 3215
2 14 40 1690 20 14 40 2079 38 14 40 1602
3 14 60 795 21 14 60 986 39 14 60 736
4 14 120 295 22 14 120 282 40 14 120 208
5 14 260 246 23 14 260 77 41 14 260 146
6 14 400 245 24 14 400 51 42 14 400 145
7 37 20 557 25 37 20 691 43 37 20 548
8 37 40 553 26 37 40 673 44 37 40 543

GM1 9 37 60 554 GM2 27 37 60 686 GM3 45 37 60 544
10 37 120 295 28 37 120 276 46 37 120 208
11 37 260 246 29 37 260 77 47 37 260 146
12 37 400 245 30 37 400 51 48 37 400 145
13 54 20 270 31 54 20 349 49 54 20 267
14 54 40 270 32 54 40 352 50 54 40 264
15 54 60 273 33 54 60 351 51 54 60 265
16 54 120 208 34 54 120 286 52 54 120 196
17 54 260 147 35 54 260 78 53 54 260 128
18 54 400 144 36 54 400 49 54 54 400 127

The parameter estimates are in Table 3.23 and we can notce that for ?0, the estimated values
are almost the same. For the parameter ?2s , half of meshes from GM1 overestimated this parameter, the
same occur with meshes 24, 25, 30 and 36 from GM2 and meshes 37, 38 and 44 from GM3. The best
value for ?2s occur with mesh 27. For k, some meshes, including mesh 27, obtained the exact value. For
??, the estimate most similar to the stipulated value was with mesh 53 the value of 396.201 and mesh 27
obtained 417.423.

The values of DIC, WAIC and logCPO was computed and added into Table 3.24. We can notice
that meshes from GM1 have negative results for this three criteria and those meshes have bad results in
all analysis. The small (positive) results for DIC was 1037.02 with mesh 26, for WAIC was 1040.80 also
with mesh 26 and for logCPO the best value was 2.97 with meshes 34, 40 and 46. This results with mesh
27 were 1046.39 (DIC), 1048.73 (WAIC) and 2.98 (logCPO), not far from the minors ones.



53

Table 3.23. Estimates of the parameters for each mesh for Soil data.
Group Mesh c a ?0 ?2s k ?

? Group Mesh c a ?0 ?2s k ?
?

1 14 20 27.349 225.546 0.311 6.436 28 37 120 24.790 39.813 0.007 274.361
2 40 27.249 212.464 0.201 9.943 29 260 24.161 47.518 0.006 356.202
3 60 25.502 38.138 0.012 168.098 30 400 23.532 112.748 0.010 193.083
4 120 25.544 41.596 0.015 135.957 31 54 20 24.372 39.492 0.005 375.086
5 260 26.184 536.623 0.146 13.677 GM2 32 40 24.511 37.671 0.006 356.415
6 400 26.186 533.051 0.147 13.635 33 60 24.431 39.159 0.005 369.717
7 37 20 27.007 392.239 0.156 12.825 34 120 24.455 40.683 0.005 373.239
8 40 25.659 39.245 0.014 143.499 35 260 24.056 51.629 0.007 276.123

GM1 9 60 27.006 389.648 0.156 12.857 36 400 22.970 136.836 0.011 187.693
10 120 25.544 41.596 0.015 135.957 37 14 20 27.497 205.812 0.229 8.726
11 260 26.184 536.623 0.146 13.677 38 40 27.204 257.290 0.183 10.957
12 400 26.186 533.051 0.147 13.635 39 60 25.591 44.040 0.013 150.161
13 54 20 24.039 38.553 0.003 614.885 40 120 24.483 37.161 0.005 437.492
14 40 24.033 38.645 0.003 613.556 41 260 24.453 36.714 0.004 484.431
15 60 23.884 39.873 0.003 610.772 42 400 24.452 36.749 0.004 484.269
16 120 24.308 36.371 0.004 514.214 43 37 20 25.675 46.431 0.017 119.675
17 260 24.172 36.932 0.004 567.643 44 40 26.929 496.750 0.161 12.388
18 400 24.283 35.917 0.004 541.241 GM3 45 60 25.765 46.740 0.017 115.848
19 14 20 25.695 43.909 0.016 126.075 46 120 24.483 37.161 0.005 437.492
20 40 25.828 48.753 0.017 117.083 47 260 24.453 36.714 0.004 484.431
21 60 26.146 64.464 0.026 76.259 48 400 24.452 36.749 0.004 484.269
22 120 24.297 37.278 0.005 423.440 49 54 20 24.370 36.666 0.004 507.665

GM2 23 260 24.501 47.362 0.006 318.026 50 40 24.511 36.060 0.004 445.414
24 400 23.935 102.094 0.010 204.161 51 60 24.519 35.560 0.005 436.221
25 37 20 26.357 104.627 0.033 60.693 52 120 24.629 36.447 0.005 386.195
26 40 24.789 37.422 0.006 327.538 53 260 24.724 34.445 0.005 396.201
27 60 24.473 39.346 0.005 417.423 54 400 24.743 34.243 0.005 390.551

Table 3.24. Values for DIC, WAIC and logCPO for each mesh for Soil data.
Group Mesh c a DIC WAIC logCPO Group Mesh c a DIC WAIC logCPO

1 14 20 -1045.52 -1064.51 -2.09 28 37 120 1043.60 1048.56 2.98
2 40 -1051.57 -1090.31 -2.16 29 260 1072.81 1072.84 3.02
3 60 -1037.86 -1053.63 -2.06 30 400 1067.59 1067.17 3.00
4 120 -1017.69 -1052.80 -2.06 31 54 20 1049.29 1051.18 2.98
5 260 -1111.69 -1166.31 -2.38 GM2 32 40 1053.02 1055.10 2.99
6 400 -1112.32 -1166.93 -2.38 33 60 1049.06 1051.17 2.98
7 37 20 -1046.77 -1101.36 -2.19 34 120 1048.73 1050.50 2.97
8 40 -1031.61 -1051.38 -2.06 35 260 1066.28 1065.48 3.00

GM1 9 60 -1047.36 -1101.95 -2.20 36 400 1068.88 1068.67 3.00
10 120 -1017.69 -1052.80 -2.06 37 14 20 -1066.48 -1119.93 -2.25
11 260 -1111.69 -1166.31 -2.38 38 40 -1042.52 -1095.65 -2.18
12 400 -1112.32 -1166.93 -2.38 39 60 -1032.84 -1053.26 -2.06
13 54 20 1066.26 1066.83 3.02 40 120 1047.06 1047.13 2.97
14 40 1066.86 1067.50 3.02 41 260 1054.90 1054.56 2.98
15 60 1064.53 1065.47 3.01 42 400 1054.87 1054.56 2.98
16 120 1060.81 1060.14 3.00 43 37 20 -1020.86 -1059.65 -2.08
17 260 1064.89 1063.83 3.00 44 40 -1085.68 -1140.24 -2.30
18 400 1064.75 1063.63 3.00 GM3 45 60 -1031.49 -1052.65 -2.06
19 14.00 20 -1019.59 -1056.11 -2.07 46 120 1047.06 1047.13 2.97
20 40 -1030.01 -1049.40 -2.05 47 260 1054.90 1054.56 2.98
21 60 -1033.28 -1056.65 -2.07 48 400 1054.87 1054.56 2.98
22 120 1062.98 1066.29 3.01 49 54 20 1056.61 1057.91 3.00

GM2 23 260 1073.61 1073.16 3.02 50 40 1049.74 1050.44 2.98
24 400 1073.70 1073.41 3.02 51 60 1048.95 1049.86 2.98
25 37 20 -1044.52 -1062.07 -2.08 52 120 1044.12 1044.07 2.96
26 40 1037.02 1040.80 2.98 53 260 1054.13 1054.46 2.98
27 60 1046.39 1048.73 2.98 54 400 1054.03 1054.36 2.98

Using mesh 27, we computed the prediction mean and prediction standard deviation over the
study area (the two figures from the bottom in Figure 3.8). Comparing Figure 3.8 I and Figure 3.8 III
we can assume that mesh 27 obtained good prediction.



54

(I) (II)

(III) (IV)

Figure 3.8. (I) Plot of sample and corresponding values, (II) histogram , (III) predicted surface and
(IV) prediction standard deviation considering mesh 27.

3.5 Conclusion

When using th SPDE/GMRF approach in INLA in geostatistical analysis, the first step is to
create a mesh over and plus the study area. With a simulation study we showed that inferential results
depend on this created mesh. In a previous study, we notice that the value of b(the maximal edge length
in the outer domain) has almost no impact on the results,so in this study we fixed it. The choice of the
value of c, the shortest allowed distance between points, has the largest impact and, conditional on a
value of c, the value of a (the maximal edge length in the inner domain) also leads to some differences.

We worked with three predictive information criteria, namely DIC, WAIC and CPO, to inves-
tigate whether these criteria can be used to select an optimal mesh for a specific data problem and we
notice that DIC and WAIC lead to choosing meshes with poor results in the analysis while CPO has
a better sense. The only problem with CPO is that we need to make sure that no numerical problems
occur because if it happens, CPO needed to be recalculated by refitting the model, leaving out every
observation one at a time and this could take a long time, specially in simulation study.

In this paper, our focus was to investigate different types to create a convex mesh for different
geostatistical data set. We worked with three ways to create the mesh and it is possible to notice
that working with radom and cluster data, best results are obtained with meshes generated with all
coordinates, with a relation with ratio of 0.15 between c = 0.03 and range. For regular data, results were
not good when meshes were created considering the coordinates, better results were obtained with mesh
creation by domain. Further investigation with convex mesh is still needed and also to investigate how
non-convex meshes worked for each kind of this data set.

References

BOLIN, D.; LINDSTRO?M, J. Spatial Statistics using R-INLA and Gaussian Markov random fields.
Pan-American Advanced Study Institute, 15:29:57Z, rev.3691, 2014.

CAMELETTI, M.; LINDGREN, F.; SIMPSON, D., RUE, H. Spatio-temporal modeling of particulate
matter concentration through the SPDE approach. Advances in Statistical Analysis, v. 97, p. 109-131,
2012.



55

DIGGLE, P.J.; RIBEIRO JR., P.J.; CHRISTENSEN, O.F. An introduction to model-based geostatistics.
In: M?LLER, J. (Ed.). Spatial Statistics and Computational Methods. New York: Springer, 2003.
p. 43-86.

DIGGLE, P. J.; TAWN, J. A.; MOYEED, R. A. Model-based geostatistics. Journal of the Royal
Statistical Society: Series C, v. 47, p. 299-350, 1998.

GEISSER, S.; EDDY, W. A predictive approach to model selection. Journal of the American Statistical
Association, Boston, v.74, n.365, p.153-160, 1979.

GELMAN, A.; HWANG,J.; VEHTARI, A. Understanding predictive information criteria for Bayesian
models. Statistics and Computing, v. 24, n. 6, p. 997-1016, 2014.

HELD, L., SCHRODLE, B., RUE, H. Posterior and Cross-validatory Predictive Checks: A comparison
of MCMC and INLA. In T. Kneib and G. Tutz, editors,Statistical Modelling and Regression Structures,
p. 91 , 2010.

IBRAHIM, J. G.; CHEN, M.; SINHA, D.Bayesian Survival Analysis. Ed: Springer Science &amp;amp; Business
Media, 2013. 480 p.

JOHNSON, M.E.; MOORE, L.M.; YLVISAKER,D. Minimax and maximin distance designs. Journal of
Statistical Planning and Inference,n. 26, p. 131-148, 1990.

KARAGIANNIS-VOULES, D.A., SCHOLTE, R. G. C., GUIMARE?ES, L. H., UTZINGER, J.,
VOUNATSOU, P. Bayesian Geostatistical Modeling of Leishmaniasis Incidence in Brazil. PLoS Neglected
Tropical Diseases, v. 7, n. 5, e2213. doi:10.1371/journal.pntd.0002213. 2013.

KRAINSKI, E. T.; RUE, H. A short introduction on how to fit a SPDE model with INLA. 2013.

KRAINSKI, E. T.; LINDGREN, F. The R-INLA tutorial: SPDE models. 2014.

LINDGREN, F. Continuous domain spatial models in R-INLA. The ISBA Bulletin, v. 19, n. 4, 2012.

LINDGREN, F.; RUE, H. Bayesian spatial modelling with R-INLA. Journal of Statistical Software, v.
63, 2015.

LINDGREN, F.; RUE, H.; LINDSTRo?M, J. An explicit link between Gaussian fields and Gaussian
Markov random fields: The stochastic partial differential equation approach. Journal of the Royal Sta-
tistical Society, v. 73, p. 423-498, 2011.

MATHERON, G. Principles of geostatistics. Economic Geology, Austin, v. 58, p.1246-1266, 1963.

R Core Team (2015). R: A language and environment for statistical computing. R Foundation for Sta-
tistical Computing, Vienna, Austria. URL https://www.R-project.org/.

RIBEIRO JR., P.J. and DIGGLE, P.J. (2001) geoR: A package for geostatistical analysis. R-NEWS Vol
1, No 2. ISSN 1609-3631. Available for download at: http://cran.r-project.org/doc/Rnews.

RUE, H.; MARTINO, S.; CHOPIN, N. Appriximate Bayesian inference for latent Gaussian models by
using integrated nested Laplace aproximations (with discussion). Journal of the Royal Statistical Society
- Series B, v.71, Part 2, p.319-392, 2009.

SPIEGELHALTER, D.J.; BEST, N.G.; CARLIN, B.P.; LINDE, A.V.D. Bayesian measures of model
complexity and fit. Journal of the Royal Statistical Society Series B, London, v.64, n.4, p.583-639, 2000.

VEHTARI, A.; GELMAN, A. WAIC and cross-validation in Stan. Submitted. http://www.stat.columbia.
edu/gelman/research/unpublished/waic stan.pdf Accessed, v. 27, n. 2015, p. 5, 2014.

WATANABE, S. Asymptotic equivalence of Bayes cross validation and widely applicable information
criterion in singular learning theory. Journal of Machine Learning Research, v. 11, p. 3571-3594, 2010.



56

ZHANG, H.; ZIMMERMAN, D. L. Hybrid Estimation of Semivariogram Parameters. Mathematical
Geology, v. 39, n. 2, February 2007. DOI: 10.1007/s11004-006-9070-8.



57

4 CONCLUSION

When using the INLA method for geostatistical data, the first step is to create a mesh under
the study region and all the analysis will depend on this mesh. This mesh is composed of several triangles
in which the junction of the edges (knots) may or may not coincide with the locations. There are several
ways to create the mesh and in this work we approach the creation using the maximal allowed edge length
in the inner (a) and outer (b) domain and the shortest allowed distance between two points (c). We could
notice that the value of b has almost no impact on the results and the choice of the value of c has the
largest impact. Also, conditional on a value of c, the value of a also leads to some differences.

Pre-specification of the triangulated mesh is not easy, since it is possible to create a mesh with
very good predictive behavior, but that leads to poor covariance parameter estimates. We have used
DIC, WAIC and CPO, to investigate whether these criterias can be used to select an optimal mesh for a
specific data problem. We noticed that the predictive information criterias DIC and WAIC almost always
lead to choosing dense meshes. These meshes indeed perform well in terms of coverage and mean squared
error for predictions, but do not perform well in the other parts of the analysis, namely the estimation
of the covariance parameters. Thus, DIC and WAIC showed to prefer meshes with more knots. Further,
we have noticed that mesh selection using the logCPO leads to better performing meshes overall.

The logCPO criteria needs careful since it is very important to ensure that no numerical prob-
lems occur. We have observed that in many cases, especially with dense meshes, this approximating
method does not work and, therefore, CPO needed to be recalculated by refitting the model, leaving out
every observation one at a time.

First, we study for random data the behavior of the maximal allowed edge length in the inner (a)
and outer (b) domain and the shortest allowed distance between two points (c) for different sample values
to verify the impact of the mesh with different sample values then we extended the study to different
ways to create the mesh with the use of different values of a, b and c. There is still much to study for
a better guide on how to create the mesh but with this beginning of study we can notice similarities in
the real data applications with the simulation study carried out. It is possible to notice that analysis
with regular data set works better withe meshes created by domain, not considering the coordinates. For
random and cluster data set, meshes created considering all the locations, generate better results and
proportion given by c

?? is equal to 0.15, a proportion to give a special attention when creating the mesh.
Also, we notice that the value of b to create the mesh has no impact in the analysis, the attention should
be in a and b.



58



59

APPENDICES

Appendix A: Supplementary Material for Chapter 2

Additional simulations results

In Section 2.3 of Chapter 2, a simulation study is presented with n = 100. In this section of
Appendix A we provide the results of the simulation study considering n = 50 and n = 300.

The colours of the graphics in the following sessions are: red for c=0.001, orange for c=0.005,
green for c=0.01, blue for c= 0.03, light blue for c=0.05, pink for c=0.07, yellow for c=0.10 and grey for
c=0.13. And in each group of these colours, the value of a increases from left to right.

Simulation study with n=100

Impact of mesh on inference

Figure A.1. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=100.



60

Table A.1. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3.
MSE for:

Mesh c a ?0 ?1 ?2e ?
2
s k ?

?

1 0.001 0.05 0.07 0.12 0.08 0.29 543.04 0.02
2 0.09 0.07 0.12 0.08 0.34 299.48 0.02
3 0.13 0.06 0.12 0.08 0.40 182.82 0.02
4 0.17 0.06 0.12 0.08 0.48 144.96 0.01
5 0.19 0.06 0.12 0.08 0.47 127.04 0.01
6 0.20 0.06 0.12 0.08 0.48 122.49 0.02
7 0.005 0.05 0.07 0.14 0.08 0.30 544.10 0.02
8 0.09 0.07 0.14 0.08 0.33 285.95 0.02
9 0.13 0.07 0.14 0.08 0.38 171.38 0.02

10 0.17 0.07 0.14 0.08 0.44 131.29 0.02
11 0.19 0.07 0.14 0.08 0.46 121.33 0.02
12 0.20 0.07 0.14 0.08 0.45 115.09 0.02
13 0.01 0.05 0.07 0.14 0.06 0.28 424.82 0.04
14 0.09 0.07 0.14 0.06 0.24 202.96 0.04
15 0.13 0.07 0.13 0.06 0.26 120.75 0.04
16 0.17 0.07 0.13 0.06 0.32 100.72 0.04
17 0.19 0.07 0.13 0.06 0.33 91.92 0.04
18 0.20 0.07 0.13 0.06 0.33 86.29 0.04
19 0.03 0.05 0.06 0.12 0.03 0.07 87.72 0.06
20 0.09 0.06 0.11 0.02 0.14 88.41 0.06
21 0.13 0.06 0.11 0.02 0.06 31.88 0.07
22 0.17 0.06 0.11 0.02 0.07 34.07 0.07
23 0.19 0.06 0.11 0.02 0.08 32.10 0.07
24 0.20 0.06 0.11 0.02 0.08 32.60 0.06
25 0.05 0.05 0.06 0.11 0.02 0.08 88.57 0.07
26 0.09 0.06 0.11 0.02 0.12 131.08 0.06
27 0.13 0.06 0.11 0.02 0.07 36.54 0.07
28 0.17 0.06 0.11 0.03 0.08 51.22 0.08
29 0.19 0.06 0.11 0.03 0.10 59.79 0.07
30 0.20 0.06 0.10 0.03 0.09 46.20 0.06
31 0.07 0.05 0.06 0.10 0.03 0.09 45.91 0.10
32 0.09 0.06 0.10 0.03 0.10 46.08 0.10
33 0.13 0.06 0.10 0.03 0.09 41.33 0.11
34 0.17 0.06 0.10 0.04 0.14 49.59 0.12
35 0.19 0.06 0.10 0.05 0.22 66.93 0.11
36 0.20 0.06 0.10 0.05 0.23 69.40 0.11
37 0.10 0.05 0.06 0.10 0.06 1.16 123.40 0.11
38 0.09 0.06 0.10 0.06 1.96 125.43 0.12
39 0.13 0.06 0.10 0.07 2.32 138.98 0.11
40 0.17 0.06 0.10 0.07 1.91 130.67 0.12
41 0.19 0.06 0.10 0.07 1.93 127.96 0.11
42 0.20 0.06 0.11 0.07 2.44 111.41 0.11
43 0.13 0.05 0.06 0.11 0.09 1.87 130.20 0.12
44 0.09 0.06 0.11 0.10 2.20 133.10 0.12
45 0.13 0.06 0.11 0.10 1.33 107.18 0.11
46 0.17 0.06 0.11 0.10 1.38 108.93 0.11
47 0.19 0.06 0.11 0.10 1.42 112.95 0.11
48 0.20 0.06 0.11 0.10 1.37 109.74 0.12



61

Simulation study with n=50

Impact of mesh on inference

Figure A.2. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=50.



62

Table A.2. Coverage, in %, of the 95% credible intervals of the parameters?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3, for n = 50.

Coverage in % for:
Mesh c a ?0 ?1 ?2e ?2s k ??

1 0.001 0.05 93.00 93.50 0.50 59.50 51.50 55.00
2 0.09 92.00 93.50 1.00 33.50 43.00 43.00
3 0.13 92.00 94.50 1.00 18.00 41.50 42.00
4 0.17 93.00 94.50 0.50 11.50 44.50 45.50
5 0.19 92.50 95.00 1.00 11.50 43.50 43.50
6 0.20 92.50 95.50 0.50 11.00 45.00 45.00
7 0.005 0.05 93.00 93.50 0.50 59.50 51.50 55.00
8 0.09 92.00 93.50 1.00 33.50 43.00 43.00
9 0.13 92.00 94.50 1.00 18.00 41.50 42.00
10 0.17 93.00 94.50 0.50 11.50 44.50 45.50
11 0.19 92.50 95.00 1.00 11.50 43.50 43.50
12 0.20 92.50 95.50 0.50 11.00 45.00 45.00
13 0.01 0.05 93.50 90.00 5.50 62.50 57.00 60.00
14 0.09 92.50 89.50 7.00 38.00 49.00 49.00
15 0.13 93.00 91.00 7.50 24.00 47.50 48.00
16 0.17 93.50 91.50 7.00 17.50 50.00 51.00
17 0.19 92.50 92.00 8.00 16.50 50.00 50.00
18 0.20 93.00 92.50 7.50 16.50 51.50 51.50
19 0.03 0.05 91.00 87.00 25.50 61.50 62.50 63.00
20 0.09 92.00 85.00 42.00 55.50 65.00 65.00
21 0.13 89.50 84.50 59.50 67.00 72.00 73.00
22 0.17 90.00 86.00 61.00 66.00 72.00 72.00
23 0.19 90.00 86.50 62.50 65.50 73.50 74.00
24 0.20 92.00 86.50 63.50 64.50 73.00 73.00
25 0.05 0.05 92.50 88.50 57.50 66.00 71.00 70.00
26 0.09 91.50 88.00 52.00 61.50 66.00 66.50
27 0.13 94.50 88.50 72.00 82.50 78.50 78.50
28 0.17 94.00 89.50 74.00 86.50 82.00 82.00
29 0.19 94.50 91.00 74.50 86.50 81.50 81.50
30 0.20 95.50 91.50 74.00 88.00 81.00 81.00
31 0.07 0.05 94.00 91.50 68.00 88.50 81.50 81.50
32 0.09 96.00 91.00 67.50 88.00 82.50 82.50
33 0.13 96.50 92.00 69.00 86.50 83.50 84.00
34 0.17 97.50 92.50 64.50 91.50 82.00 82.00
35 0.19 96.50 93.50 61.00 91.50 81.00 81.00
36 0.20 97.50 93.50 60.00 90.00 82.00 82.00
37 0.10 0.05 96.50 92.50 54.50 89.50 83.00 83.00
38 0.09 97.00 93.00 56.50 90.50 83.00 83.00
39 0.13 96.50 92.50 54.50 92.50 86.00 86.00
40 0.17 96.50 92.50 55.00 92.00 86.00 86.00
41 0.19 96.50 92.50 53.50 91.00 86.00 86.00
42 0.20 96.00 93.00 54.00 92.00 85.50 85.50
43 0.13 0.05 97.50 93.00 35.00 91.00 88.00 88.00
44 0.09 97.00 94.00 29.00 91.00 88.50 88.50
45 0.13 97.50 94.00 29.00 92.50 89.50 89.50
46 0.17 97.00 93.50 28.50 92.50 89.00 89.00
47 0.19 96.50 94.00 29.00 92.50 89.00 89.00
48 0.20 97.00 93.50 28.50 92.00 89.00 89.00



63

Table A.3. Absolute bias of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3,
for n = 50.

Bias for:
Mesh c a ?0 ?1 ?2e ?2s k ??

1 0.001 0.05 0.03 0.00 0.30 0.67 18.57 0.08
2 0.09 0.02 0.00 0.30 0.62 14.04 0.08
3 0.13 0.03 0.00 0.30 0.73 11.33 0.08
4 0.17 0.02 0.00 0.30 0.83 9.35 0.07
5 0.19 0.02 0.00 0.30 0.85 8.53 0.07
6 0.20 0.02 0.00 0.30 0.87 8.35 0.07
7 0.005 0.05 0.03 0.00 0.30 0.67 18.57 0.08
8 0.09 0.02 0.00 0.30 0.62 14.04 0.08
9 0.13 0.03 0.00 0.30 0.73 11.33 0.08
10 0.17 0.02 0.00 0.30 0.83 9.35 0.07
11 0.19 0.02 0.00 0.30 0.85 8.53 0.07
12 0.20 0.02 0.00 0.30 0.87 8.35 0.07
13 0.01 0.05 0.02 0.00 0.28 0.62 15.71 0.06
14 0.09 0.02 0.01 0.28 0.56 11.97 0.06
15 0.13 0.02 0.01 0.28 0.66 9.71 0.06
16 0.17 0.02 0.01 0.28 0.75 7.94 0.05
17 0.19 0.02 0.01 0.28 0.77 7.18 0.05
18 0.20 0.02 0.01 0.28 0.79 7.15 0.05
19 0.03 0.05 0.02 0.02 0.21 0.32 9.56 0.00
20 0.09 0.02 0.01 0.16 0.53 9.04 0.05
21 0.13 0.01 0.03 0.10 0.42 4.57 0.10
22 0.17 0.02 0.03 0.09 0.65 5.25 0.09
23 0.19 0.02 0.02 0.09 0.57 4.54 0.09
24 0.20 0.02 0.02 0.08 0.60 4.39 0.11
25 0.05 0.05 0.04 0.02 0.08 0.49 6.61 0.10
26 0.09 0.04 0.02 0.09 0.63 7.91 0.12
27 0.13 0.03 0.01 0.01 0.25 2.76 0.16
28 0.17 0.04 0.02 0.04 0.31 2.16 0.19
29 0.19 0.04 0.03 0.05 0.32 2.00 0.19
30 0.20 0.04 0.03 0.06 0.30 1.72 0.19
31 0.07 0.05 0.03 0.01 0.08 0.29 1.22 0.22
32 0.09 0.03 0.00 0.09 0.46 1.92 0.22
33 0.13 0.03 0.01 0.09 0.21 0.68 0.23
34 0.17 0.03 0.01 0.13 0.21 0.59 0.24
35 0.19 0.03 0.01 0.15 0.33 1.11 0.25
36 0.20 0.03 0.01 0.16 0.38 1.33 0.25
37 0.10 0.05 0.03 0.01 0.19 0.36 1.35 0.24
38 0.09 0.03 0.01 0.20 0.48 1.48 0.25
39 0.13 0.03 0.01 0.19 0.25 0.95 0.25
40 0.17 0.03 0.01 0.19 0.22 0.46 0.25
41 0.19 0.03 0.01 0.20 0.22 0.41 0.26
42 0.20 0.03 0.01 0.20 0.29 1.10 0.25
43 0.13 0.05 0.03 0.01 0.27 0.64 2.64 0.21
44 0.09 0.03 0.01 0.28 0.52 2.37 0.21
45 0.13 0.03 0.01 0.28 0.50 2.08 0.22
46 0.17 0.03 0.01 0.28 0.50 2.07 0.21
47 0.19 0.03 0.01 0.28 0.49 2.21 0.21
48 0.20 0.03 0.01 0.28 0.50 2.06 0.22



64

Table A.4. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3, for n = 50.
MSE for:

Mesh c a ?0 ?1 ?2e ?2s k ??
1 0.001 0.05 0.10 0.20 0.09 13.77 2187.42 0.01
2 0.09 0.10 0.19 0.09 1.18 541.03 0.01
3 0.13 0.10 0.19 0.09 0.86 266.87 0.01
4 0.17 0.11 0.19 0.09 1.00 179.91 0.01
5 0.19 0.11 0.19 0.09 0.95 142.91 0.01
6 0.20 0.11 0.19 0.09 1.04 140.73 0.01
7 0.005 0.05 0.10 0.20 0.09 13.77 2187.42 0.01
8 0.09 0.10 0.19 0.09 1.18 541.03 0.01
9 0.13 0.10 0.19 0.09 0.86 266.87 0.01
10 0.17 0.11 0.19 0.09 1.00 179.91 0.01
11 0.19 0.11 0.19 0.09 0.95 142.91 0.01
12 0.20 0.11 0.19 0.09 1.04 140.73 0.01
13 0.01 0.05 0.11 0.23 0.09 13.72 1969.76 0.02
14 0.09 0.11 0.23 0.09 1.10 452.62 0.02
15 0.13 0.11 0.24 0.09 0.75 214.01 0.03
16 0.17 0.11 0.23 0.09 0.89 140.82 0.03
17 0.19 0.12 0.24 0.08 0.85 111.39 0.03
18 0.20 0.12 0.23 0.08 0.95 117.64 0.03
19 0.03 0.05 0.12 0.24 0.07 0.44 406.22 0.09
20 0.09 0.12 0.24 0.06 2.11 591.50 0.12
21 0.13 0.12 0.25 0.05 1.14 230.60 0.16
22 0.17 0.12 0.25 0.05 3.87 283.34 0.16
23 0.19 0.11 0.24 0.05 1.95 214.86 0.16
24 0.20 0.11 0.24 0.05 2.08 215.06 0.24
25 0.05 0.05 0.11 0.24 0.06 1.69 360.94 0.17
26 0.09 0.11 0.25 0.06 3.23 491.41 0.24
27 0.13 0.10 0.22 0.04 0.78 204.33 0.21
28 0.17 0.11 0.22 0.04 1.24 174.91 0.28
29 0.19 0.11 0.22 0.04 1.38 167.62 0.29
30 0.20 0.11 0.22 0.04 1.13 156.68 0.30
31 0.07 0.05 0.10 0.21 0.05 2.45 175.99 0.31
32 0.09 0.10 0.21 0.05 6.31 222.77 0.32
33 0.13 0.10 0.21 0.05 0.92 132.95 0.31
34 0.17 0.10 0.21 0.05 0.70 119.57 0.32
35 0.19 0.10 0.20 0.06 2.35 176.24 0.34
36 0.20 0.10 0.20 0.06 4.00 201.84 0.34
37 0.10 0.05 0.10 0.20 0.07 2.05 140.64 0.33
38 0.09 0.10 0.20 0.07 5.62 145.15 0.36
39 0.13 0.10 0.20 0.07 0.92 100.31 0.36
40 0.17 0.10 0.20 0.07 0.81 85.61 0.37
41 0.19 0.10 0.20 0.07 0.79 86.43 0.38
42 0.20 0.10 0.20 0.07 1.38 107.11 0.36
43 0.13 0.05 0.10 0.20 0.11 5.73 145.46 0.34
44 0.09 0.10 0.20 0.11 3.76 137.79 0.33
45 0.13 0.10 0.20 0.11 3.83 132.40 0.34
46 0.17 0.10 0.20 0.11 3.84 130.75 0.34
47 0.19 0.10 0.20 0.11 2.93 129.65 0.33
48 0.20 0.10 0.20 0.11 3.83 131.23 0.34



65

Table A.5. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b=0.3,
considering 200 simulations, for n=50.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 3.51 0.29 25 0.05 0.05 65.38 0.24
2 0.09 3.94 0.29 26 0.09 60.46 0.25
3 0.13 3.97 0.29 27 0.13 82.89 0.24
4 0.17 3.87 0.29 28 0.17 85.77 0.24
5 0.19 4.01 0.29 29 0.19 87.82 0.24
6 0.20 3.89 0.29 30 0.20 87.87 0.24
7 0.005 0.05 3.51 0.29 31 0.07 0.05 85.83 0.25
8 0.09 3.94 0.29 32 0.09 84.81 0.25
9 0.13 3.97 0.29 33 0.13 85.66 0.25
10 0.17 3.87 0.29 34 0.17 87.21 0.26
11 0.19 4.01 0.29 35 0.19 87.00 0.27
12 0.20 3.89 0.29 36 0.20 86.58 0.27
13 0.01 0.05 10.24 0.29 37 0.10 0.05 84.71 0.29
14 0.09 11.66 0.29 38 0.09 84.74 0.29
15 0.13 13.62 0.29 39 0.13 84.91 0.29
16 0.17 13.73 0.29 40 0.17 84.86 0.29
17 0.19 14.01 0.29 41 0.19 84.76 0.29
18 0.20 13.75 0.29 42 0.20 84.72 0.29
19 0.03 0.05 30.92 0.27 43 0.13 0.05 79.78 0.33
20 0.09 46.52 0.26 44 0.09 79.43 0.34
21 0.13 70.26 0.24 45 0.13 78.93 0.34
22 0.17 71.48 0.24 46 0.17 78.92 0.34
23 0.19 74.28 0.24 47 0.19 79.26 0.34
24 0.20 74.16 0.24 48 0.20 79.01 0.34



66

Table A.6. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,
considering 200 simulations, for 13 locations not in the analysis.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 93.27 0.54 25 0.05 0.05 84.08 0.57
2 0.09 88.04 0.54 26 0.09 84.42 0.57
3 0.13 79.15 0.54 27 0.13 81.00 0.54
4 0.17 72.12 0.55 28 0.17 75.54 0.54
5 0.19 69.31 0.56 29 0.19 75.00 0.53
6 0.20 65.96 0.56 30 0.20 73.50 0.54
7 0.005 0.05 93.27 0.54 31 0.07 0.05 79.77 0.54
8 0.09 88.04 0.54 32 0.09 79.35 0.54
9 0.13 79.15 0.54 33 0.13 79.15 0.54
10 0.17 72.12 0.55 34 0.17 76.38 0.54
11 0.19 69.31 0.56 35 0.19 75.00 0.54
12 0.20 65.96 0.56 36 0.20 73.73 0.54
13 0.01 0.05 92.62 0.54 37 0.10 0.05 74.38 0.54
14 0.09 87.46 0.54 38 0.09 74.58 0.55
15 0.13 78.62 0.55 39 0.13 74.62 0.54
16 0.17 72.15 0.56 40 0.17 74.54 0.54
17 0.19 69.04 0.56 41 0.19 74.65 0.54
18 0.20 66.19 0.56 42 0.20 74.38 0.54
19 0.03 0.05 90.54 0.55 43 0.13 0.05 71.31 0.54
20 0.09 84.65 0.57 44 0.09 70.92 0.55
21 0.13 80.85 0.54 45 0.13 70.62 0.55
22 0.17 75.42 0.54 46 0.17 70.65 0.55
23 0.19 73.46 0.54 47 0.19 70.81 0.55
24 0.20 71.88 0.54 48 0.20 70.77 0.55

Figure A.3. Bias for Y in 13 extra locations, for all 200 simulations, for b=0.3.

Selecting the best mesh



67

(I)

(II)

(III)

Figure A.4. For each value of a, minimum value of:(I)DIC; (II) WAIC and (III)logCPO, for all 200
simulations, for b=0.3 with n=50.



68

Table A.7. Mean values of DIC, WAIC and logCPO for meshes with b=0.3 for n=50.

Mesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO
1 0.001 0.05 -288.32 -295.62 2.31 25 0.05 0.05 -9.21 -5.38 1.69
2 0.09 -286.83 -294.16 2.30 26 0.09 -26.82 -25.34 1.74
3 0.13 -286.75 -293.89 2.26 27 0.13 82.06 84.10 1.43
4 0.17 -286.63 -293.64 2.24 28 0.17 97.90 98.59 1.41
5 0.19 -286.25 -293.34 2.26 29 0.19 108.68 109.72 1.37
6 0.20 -286.39 -293.46 2.25 30 0.20 108.39 109.89 1.37
7 0.005 0.05 -288.32 -295.62 2.31 31 0.07 0.05 103.82 105.70 1.39
8 0.09 -286.83 -294.16 2.29 32 0.09 103.59 104.93 1.39
9 0.13 -286.75 -293.89 2.26 33 0.13 104.92 106.40 1.38
10 0.17 -286.63 -293.64 2.24 34 0.17 119.19 120.30 1.35
11 0.19 -286.25 -293.34 2.26 35 0.19 123.92 124.77 1.35
12 0.20 -286.39 -293.46 2.25 36 0.20 124.63 125.44 1.35
13 0.01 0.05 -259.84 -264.27 2.25 37 0.10 0.05 125.45 126.37 1.35
14 0.09 -253.27 -258.52 2.23 38 0.09 126.95 128.03 1.35
15 0.13 -244.01 -246.87 2.16 39 0.13 127.08 128.03 1.35
16 0.17 -244.53 -245.40 2.12 40 0.17 127.17 128.13 1.35
17 0.19 -242.69 -244.77 2.15 41 0.19 127.35 128.31 1.35
18 0.20 -243.27 -244.81 2.14 42 0.20 127.50 128.45 1.35
19 0.03 0.05 -167.43 -166.10 2.02 43 0.13 0.05 130.57 131.41 1.36
20 0.09 -94.18 -92.02 1.86 44 0.09 131.11 131.95 1.36
21 0.13 14.21 21.02 1.55 45 0.13 131.26 132.08 1.36
22 0.17 24.51 26.20 1.55 46 0.17 131.31 132.14 1.36
23 0.19 36.91 40.09 1.51 47 0.19 131.12 131.98 1.36
24 0.20 36.69 40.18 1.50 48 0.20 131.28 132.11 1.36



69

Figure A.5. Estimates for ?0, ?1, ?2e , ?2s , k and ??, considering the mesh with minimal DIC, WAIC
and logCPO, and estimates considering mesh 27.



70

Simulation study with n=300

Impact of mesh on inference

Figure A.6. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ?? with n=300.



71

Table A.8. Coverage, in %, of the 95% credible intervals of the parameters?0, ?1, ?2e , ?2s , k and ?? for
different meshes with b = 0.3, for n = 300.

Coverage in % for:
Mesh c a ?0 ?1 ?2e ?2s k ??

1 0.001 0.05 97.00 92.00 80.00 91.00 80.00 80.00
2 0.09 95.50 91.00 69.50 77.00 69.00 69.00
3 0.13 95.00 92.00 68.50 77.00 68.50 69.00
4 0.17 95.00 92.00 72.50 78.50 69.50 70.00
5 0.19 95.00 92.00 72.50 78.50 69.50 70.00
6 0.20 95.00 92.00 72.50 78.50 69.50 70.00
7 0.005 0.05 97.00 91.50 81.50 91.50 80.00 80.00
8 0.09 95.00 92.00 77.00 81.50 75.00 75.00
9 0.13 94.50 91.50 74.50 82.00 72.00 72.00
10 0.17 94.50 91.00 76.50 82.50 74.50 75.00
11 0.19 94.50 91.00 77.00 83.00 75.00 75.00
12 0.20 94.50 91.00 77.00 83.00 75.00 75.00
13 0.01 0.05 98.00 92.00 90.00 95.00 88.50 88.50
14 0.09 97.50 92.50 86.00 94.00 88.50 88.00
15 0.13 97.00 92.50 86.50 93.50 86.00 86.00
16 0.17 97.50 92.50 86.00 93.00 86.50 86.50
17 0.19 97.50 92.50 86.00 93.00 86.50 86.50
18 0.20 97.50 92.50 86.00 93.00 86.50 86.50
19 0.03 0.05 97.50 92.50 75.50 94.50 88.00 88.50
20 0.09 97.50 92.00 55.00 92.00 87.00 87.00
21 0.13 98.00 92.50 45.50 94.00 87.50 87.50
22 0.17 97.50 92.50 45.00 94.50 87.00 87.00
23 0.19 97.50 92.50 45.00 94.50 87.50 87.50
24 0.20 97.50 92.50 45.00 94.50 87.50 87.50
25 0.05 0.05 97.50 93.00 20.00 95.00 86.00 86.00
26 0.09 98.00 93.50 20.00 95.00 86.50 86.50
27 0.13 97.00 94.00 6.50 96.50 87.50 87.50
28 0.17 97.00 93.50 4.00 96.50 88.00 88.00
29 0.19 97.00 93.50 4.00 97.00 86.50 86.50
30 0.20 97.00 93.50 4.00 97.00 86.00 86.00
31 0.07 0.05 97.00 93.50 1.00 96.00 88.50 88.50
32 0.09 97.00 93.50 1.00 97.00 88.00 88.00
33 0.13 97.50 93.50 1.00 97.00 88.50 88.50
34 0.17 97.00 94.00 0.00 96.00 87.50 87.50
35 0.19 96.50 93.50 0.00 96.50 89.00 89.00
36 0.20 96.50 93.50 0.00 97.00 88.50 88.50
37 0.10 0.05 97.00 93.50 0.00 91.00 86.00 85.50
38 0.09 97.00 94.50 0.00 89.50 83.50 83.50
39 0.13 96.50 93.50 0.00 90.00 86.50 86.50
40 0.17 96.50 93.50 0.00 90.00 86.50 86.50
41 0.19 96.50 93.50 0.00 89.50 86.50 86.50
42 0.20 96.00 94.00 0.00 89.00 85.50 85.50
43 0.13 0.05 96.50 93.50 0.00 78.50 82.50 82.50
44 0.09 97.00 92.50 0.00 80.50 82.00 82.00
45 0.13 96.50 92.00 0.00 78.00 81.00 81.00
46 0.17 97.50 93.00 0.00 78.50 81.50 81.50
47 0.19 97.00 93.00 0.00 79.50 80.50 80.50
48 0.20 97.50 93.00 0.00 78.50 81.50 81.50



72

Table A.9. Absolute bias of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3,
for n = 300.

Bias for:
Mesh c a ?0 ?1 ?2e ?2s k ??

1 0.001 0.05 0.02 0.01 0.03 0.01 1.64 0.01
2 0.09 0.02 0.01 0.05 0.05 3.24 0.00
3 0.13 0.02 0.01 0.05 0.07 3.12 0.00
4 0.17 0.02 0.01 0.05 0.07 2.91 0.00
5 0.19 0.02 0.01 0.05 0.07 2.89 0.00
6 0.20 0.02 0.01 0.05 0.07 2.89 0.00
7 0.005 0.05 0.02 0.01 0.03 0.01 1.34 0.01
8 0.09 0.02 0.01 0.03 0.02 2.29 0.01
9 0.13 0.02 0.01 0.04 0.05 2.35 0.00
10 0.17 0.02 0.01 0.03 0.05 2.14 0.00
11 0.19 0.02 0.01 0.03 0.04 2.05 0.00
12 0.20 0.02 0.01 0.03 0.04 2.05 0.00
13 0.01 0.05 0.02 0.01 0.01 0.04 0.36 0.03
14 0.09 0.02 0.01 0.01 0.03 0.08 0.03
15 0.13 0.02 0.01 0.01 0.02 0.14 0.02
16 0.17 0.02 0.01 0.01 0.01 0.10 0.02
17 0.19 0.02 0.01 0.01 0.01 0.10 0.02
18 0.20 0.02 0.01 0.01 0.01 0.10 0.02
19 0.03 0.05 0.02 0.01 0.06 0.04 1.56 0.06
20 0.09 0.02 0.01 0.08 0.06 1.81 0.07
21 0.13 0.02 0.01 0.09 0.05 1.62 0.06
22 0.17 0.02 0.01 0.09 0.04 1.61 0.06
23 0.19 0.02 0.01 0.09 0.04 1.60 0.06
24 0.20 0.02 0.01 0.09 0.04 1.60 0.06
25 0.05 0.05 0.02 0.01 0.12 0.05 1.71 0.07
26 0.09 0.02 0.01 0.12 0.05 1.69 0.07
27 0.13 0.02 0.01 0.14 0.05 1.46 0.07
28 0.17 0.02 0.01 0.15 0.04 1.38 0.07
29 0.19 0.02 0.01 0.15 0.03 1.35 0.07
30 0.20 0.02 0.01 0.15 0.03 1.36 0.07
31 0.07 0.05 0.02 0.01 0.17 0.00 0.75 0.06
32 0.09 0.02 0.01 0.17 0.00 0.78 0.06
33 0.13 0.02 0.01 0.17 0.00 0.77 0.06
34 0.17 0.02 0.01 0.20 0.02 0.29 0.05
35 0.19 0.02 0.01 0.20 0.04 0.06 0.05
36 0.20 0.02 0.01 0.20 0.04 0.01 0.05
37 0.10 0.05 0.02 0.01 0.24 0.25 1.23 0.04
38 0.09 0.02 0.01 0.25 0.24 1.06 0.04
39 0.13 0.02 0.01 0.24 0.24 1.00 0.04
40 0.17 0.02 0.01 0.24 0.24 1.00 0.04
41 0.19 0.02 0.01 0.25 0.25 1.10 0.04
42 0.20 0.02 0.01 0.25 0.26 1.21 0.04
43 0.13 0.05 0.02 0.01 0.29 0.64 2.85 0.04
44 0.09 0.02 0.01 0.30 0.70 3.14 0.04
45 0.13 0.01 0.01 0.30 35x10100 3.00 25.75
46 0.17 0.02 0.01 0.30 48x10100 3.11 27107.18
47 0.19 0.02 0.01 0.30 48x10100 3.06 27107.18
48 0.20 0.02 0.01 0.30 48x10100 3.11 27107.18



73

Table A.10. MSE of the parameters?0, ?1, ?2e , ?2s , k and ?? for different meshes with b = 0.3, for
n = 300.

MSE for:
Mesh c a ?0 ?1 ?2e ?2s k ??

1 0.001 0.05 0.03 0.03 0.01 0.02 50.01 0.01
2 0.09 0.03 0.03 0.02 0.04 70.98 0.01
3 0.13 0.03 0.03 0.02 0.05 62.53 0.01
4 0.17 0.03 0.03 0.02 0.05 57.79 0.01
5 0.19 0.03 0.03 0.02 0.05 57.34 0.01
6 0.20 0.03 0.03 0.02 0.05 57.34 0.01
7 0.005 0.05 0.03 0.03 0.01 0.03 41.74 0.01
8 0.09 0.03 0.03 0.01 0.04 52.63 0.01
9 0.13 0.03 0.03 0.01 0.04 49.64 0.01
10 0.17 0.03 0.03 0.01 0.04 44.97 0.01
11 0.19 0.03 0.03 0.01 0.04 43.63 0.01
12 0.20 0.03 0.03 0.01 0.04 43.63 0.01
13 0.01 0.05 0.03 0.03 0.01 0.02 11.61 0.01
14 0.09 0.03 0.03 0.01 0.02 13.99 0.01
15 0.13 0.03 0.03 0.01 0.02 14.80 0.01
16 0.17 0.03 0.03 0.01 0.02 13.86 0.01
17 0.19 0.03 0.03 0.01 0.02 13.86 0.01
18 0.20 0.03 0.03 0.01 0.02 13.86 0.01
19 0.03 0.05 0.03 0.03 0.01 0.03 9.27 0.01
20 0.09 0.03 0.03 0.01 0.03 10.96 0.01
21 0.13 0.03 0.03 0.01 0.03 10.20 0.01
22 0.17 0.03 0.03 0.01 0.03 10.37 0.01
23 0.19 0.03 0.03 0.01 0.03 10.30 0.01
24 0.20 0.03 0.03 0.01 0.03 10.30 0.01
25 0.05 0.05 0.03 0.03 0.02 0.03 12.56 0.01
26 0.09 0.03 0.03 0.02 0.03 13.09 0.01
27 0.13 0.04 0.03 0.02 0.03 18.25 0.01
28 0.17 0.04 0.03 0.03 0.03 16.68 0.01
29 0.19 0.04 0.03 0.03 0.03 17.07 0.01
30 0.20 0.04 0.03 0.03 0.03 17.04 0.01
31 0.07 0.05 0.04 0.03 0.03 0.03 23.65 0.01
32 0.09 0.04 0.03 0.03 0.03 24.57 0.01
33 0.13 0.04 0.03 0.03 0.03 23.70 0.01
34 0.17 0.04 0.03 0.04 0.04 41.76 0.01
35 0.19 0.04 0.03 0.04 0.07 55.41 0.01
36 0.20 0.04 0.03 0.04 0.07 50.53 0.01
37 0.10 0.05 0.04 0.03 0.06 0.35 64.42 0.02
38 0.09 0.04 0.03 0.06 0.25 57.28 0.02
39 0.13 0.04 0.03 0.06 0.24 55.05 0.02
40 0.17 0.04 0.03 0.06 0.24 55.05 0.02
41 0.19 0.04 0.03 0.06 0.31 60.95 0.02
42 0.20 0.04 0.03 0.07 0.29 61.35 0.02
43 0.13 0.05 0.04 0.03 0.09 1.42 104.70 0.02
44 0.09 0.04 0.03 0.09 1.73 116.24 0.03
45 0.13 0.04 0.03 0.09 14x10100 114.39 13x105
46 0.17 0.04 0.03 0.09 14x10100 127.19 14x1010
47 0.19 0.04 0.03 0.09 14x10100 125.52 14x1010
48 0.20 0.04 0.03 0.09 14x10100 127.19 14x1010



74

Table A.11. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b=0.3,
considering 200 simulations, for n=300.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 90.08 0.16 25 0.05 0.05 87.74 0.18
2 0.09 86.75 0.17 26 0.09 87.73 0.18
3 0.13 86.99 0.17 27 0.13 84.80 0.19
4 0.17 87.46 0.17 28 0.17 83.81 0.20
5 0.19 87.53 0.17 29 0.19 83.75 0.20
6 0.20 87.53 0.17 30 0.20 83.73 0.20
7 0.005 0.05 90.83 0.16 31 0.07 0.05 81.81 0.21
8 0.09 89.17 0.17 32 0.09 81.69 0.21
9 0.13 88.77 0.17 33 0.13 81.75 0.21
10 0.17 89.53 0.17 34 0.17 78.25 0.22
11 0.19 89.70 0.17 35 0.19 77.31 0.23
12 0.20 89.70 0.17 36 0.20 77.15 0.23
13 0.01 0.05 93.70 0.15 37 0.10 0.05 71.87 0.25
14 0.09 93.42 0.15 38 0.09 71.23 0.26
15 0.13 93.47 0.15 39 0.13 71.49 0.26
16 0.17 93.50 0.15 40 0.17 71.49 0.26
17 0.19 93.49 0.15 41 0.19 71.33 0.26
18 0.20 93.49 0.15 42 0.20 70.73 0.26
19 0.03 0.05 92.30 0.16 43 0.13 0.05 63.44 0.30
20 0.09 90.70 0.16 44 0.09 62.91 0.30
21 0.13 90.06 0.17 45 0.13 62.76 0.30
22 0.17 89.88 0.17 46 0.17 62.47 0.30
23 0.19 89.87 0.17 47 0.19 62.59 0.30
24 0.20 89.87 0.17 48 0.20 62.47 0.30



75

Table A.12. Nominal coverage, in %, and MSE for the variable Y calculated for each mesh with b = 0.3,
considering 200 simulations, for 75 locations not in the analysis.

Mesh c a Coverage(%) MSE Mesh c a Coverage(%) MSE
1 0.001 0.05 87.41 0.31 25 0.05 0.05 79.54 0.30
2 0.09 76.05 0.32 26 0.09 79.50 0.30
3 0.13 73.03 0.32 27 0.13 74.19 0.31
4 0.17 73.11 0.32 28 0.17 70.81 0.31
5 0.19 73.03 0.32 29 0.19 70.17 0.31
6 0.20 73.03 0.32 30 0.20 70.12 0.31
7 0.005 0.05 87.45 0.30 31 0.07 0.05 74.32 0.32
8 0.09 80.17 0.31 32 0.09 74.18 0.32
9 0.13 77.83 0.31 33 0.13 74.26 0.32
10 0.17 77.15 0.31 34 0.17 69.95 0.32
11 0.19 77.11 0.31 35 0.19 67.43 0.33
12 0.20 77.11 0.31 36 0.20 66.99 0.33
13 0.01 0.05 87.60 0.30 37 0.10 0.05 65.80 0.34
14 0.09 81.55 0.30 38 0.09 65.20 0.35
15 0.13 79.32 0.30 39 0.13 65.53 0.34
16 0.17 78.88 0.30 40 0.17 65.53 0.34
17 0.19 78.85 0.30 41 0.19 65.38 0.35
18 0.20 78.85 0.30 42 0.20 64.92 0.35
19 0.03 0.05 86.01 0.30 43 0.13 0.05 58.07 0.37
20 0.09 80.59 0.30 44 0.09 57.44 0.38
21 0.13 75.27 0.30 45 0.13 57.19 0.38
22 0.17 73.94 0.30 46 0.17 56.89 0.38
23 0.19 73.82 0.30 47 0.19 56.73 0.38
24 0.20 73.78 0.30 48 0.20 56.89 0.38



76

Figure A.7. Bias for Y in 75 extra locations, for all 200 simulations, for b=0.3.

Selecting the best mesh



77

(I)

(II)

(III)

Figure A.8. For each value of a, minimum value of:(I)DIC; (II) WAIC and (III)logCPO, for all 200
simulations, for b=0.3 with n=300.



78

Table A.13. Mean values of DIC, WAIC and logCPO for meshes with b=0.3 for n=300.

Mesh c a DIC WAIC logCPO Mesh c a DIC WAIC logCPO
1 0.001 0.05 559.42 558.85 1.18 25 0.05 0.05 683.73 684.27 1.17
2 0.09 499.23 494.29 1.20 26 0.09 683.82 684.36 1.17
3 0.13 502.19 495.79 1.20 27 0.13 691.72 692.03 1.18
4 0.17 506.62 502.02 1.20 28 0.17 694.74 695.01 1.18
5 0.19 507.47 502.82 1.20 29 0.19 694.85 695.13 1.18
6 0.20 507.47 502.82 1.20 30 0.20 694.91 695.19 1.18
7 0.005 0.05 581.58 580.48 1.17 31 0.07 0.05 698.96 699.83 1.18
8 0.09 557.66 552.72 1.17 32 0.09 699.29 700.14 1.18
9 0.13 547.11 541.86 1.18 33 0.13 699.05 699.91 1.18
10 0.17 563.49 557.37 1.17 34 0.17 706.11 706.65 1.19
11 0.19 565.44 559.80 1.17 35 0.19 707.55 707.97 1.19
12 0.20 565.44 559.80 1.17 36 0.20 707.72 708.11 1.19
13 0.01 0.05 633.13 634.15 1.16 37 0.10 0.05 718.08 719.39 1.20
14 0.09 634.34 635.34 1.16 38 0.09 719.85 721.11 1.21
15 0.13 633.61 634.30 1.16 39 0.13 719.30 720.53 1.21
16 0.17 634.02 634.72 1.16 40 0.17 719.30 720.53 1.21
17 0.19 634.02 634.70 1.16 41 0.19 719.64 720.86 1.21
18 0.20 634.02 634.70 1.16 42 0.20 720.88 722.01 1.21
19 0.03 0.05 662.41 662.78 1.17 43 0.13 0.05 732.98 733.78 1.23
20 0.09 672.36 672.62 1.17 44 0.09 733.87 734.63 1.23
21 0.13 675.26 675.52 1.17 45 0.13 734.37 735.14 1.23
22 0.17 675.98 676.28 1.17 46 0.17 735.14 735.81 1.23
23 0.19 675.99 676.29 1.17 47 0.19 735.00 735.69 1.23
24 0.20 676.01 676.31 1.17 48 0.20 735.14 735.81 1.23



79

Figure A.9. Boxplots for estimated ?0, ?1, ?2e , ?2s , k and ??, considering the mesh with minimal DIC,
WAIC and logCPO, and boxplots of estimated considering mesh 13.



80

Additional data analysis results

Figure A.10. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380).

Figure A.11. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380).

Figure A.12. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380).



81

Figure A.13. Posterior density for meshes with c = 13.

Figure A.14. Posterior density for meshes with c = 35.



82

Figure A.15. Posterior density for meshes with c = 51.



83

Appendix B: Supplementary Material for Chapter 3

Additional simulations results

In Section 3 of the paper a simulation study is presented. In this section of the supplementary
materials we provide some extra figures and tables

The colours of the graphics in the following sessions are: green for c=0.005, blue for c=0.03,
light blue for c=0.07 and pink for c=0.10 and in each group of these colours, the value of a increases from
left to right. First are the meshes from GM1, in the middle the meshes of GM2 and then the meshes
from GM3.

Simulation study with random data set

Figure B.1. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with random data set.



84

Table B.1. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes with
random data set.

MSE for:
Group Mesh c a ?0 ?1 ?2e ?2s k ??

?2s
?

1 0.005 0.050 0.076 0.142 0.074 0.107 342.507 0.042 0.037
2 0.005 0.090 0.073 0.143 0.078 0.518 334.709 0.020 0.008
3 0.005 0.170 0.071 0.143 0.078 0.424 124.373 0.022 0.011
4 0.005 0.200 0.071 0.141 0.078 0.459 109.720 0.023 0.014
5 0.030 0.050 0.064 0.115 0.027 0.214 234.545 0.068 0.043
6 0.030 0.090 0.062 0.111 0.020 0.054 36.953 0.074 0.046
7 0.030 0.170 0.062 0.109 0.019 0.071 25.885 0.085 0.055

GM1 8 0.030 0.200 0.062 0.108 0.020 0.076 24.274 0.075 0.059
9 0.070 0.050 0.061 0.100 0.031 0.099 77.397 0.118 0.097
10 0.070 0.090 0.061 0.101 0.032 0.133 73.769 0.112 0.101
11 0.070 0.170 0.061 0.100 0.041 0.137 64.926 0.121 0.086
12 0.070 0.200 0.061 0.101 0.045 0.227 79.323 0.113 0.079
13 0.010 0.050 0.061 0.102 0.059 0.661 91.492 0.134 0.091
14 0.010 0.090 0.061 0.102 0.059 0.475 92.817 0.135 0.090
15 0.010 0.170 0.061 0.102 0.059 0.690 92.569 0.136 0.090
16 0.010 0.200 0.062 0.102 0.060 0.539 88.267 0.134 0.102
17 0.005 0.050 0.066 0.123 0.039 0.431 303.055 0.082 0.060
18 0.005 0.090 0.063 0.104 0.024 0.819 135.185 0.101 0.078
19 0.005 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080
20 0.005 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141
21 0.030 0.050 0.065 0.120 0.033 0.341 178.225 0.088 0.064
22 0.030 0.090 0.063 0.104 0.024 0.819 135.185 0.101 0.078
23 0.030 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080

GM2 24 0.030 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141
25 0.070 0.050 0.060 0.100 0.038 1.083 122.125 0.086 0.063
26 0.070 0.090 0.060 0.099 0.038 0.751 115.402 0.095 0.063
27 0.070 0.170 0.060 0.101 0.052 5.094 209.869 0.103 0.080
28 0.070 0.200 0.061 0.103 0.067 2.482 150.564 0.131 0.141
29 0.010 0.050 0.062 0.103 0.063 11.461 233.469 0.112 0.139
30 0.010 0.090 0.059 0.099 0.062 4.373 194.848 0.144 0.174
31 0.010 0.170 0.059 0.099 0.063 2.485 136.485 0.097 0.060
32 0.010 0.200 0.058 0.099 0.063 10.929 212.877 0.131 0.142
33 0.005 0.050 0.066 0.125 0.036 0.137 114.452 0.074 0.046
34 0.005 0.090 0.064 0.111 0.023 0.137 68.511 0.086 0.056
35 0.005 0.170 0.062 0.101 0.045 0.580 112.107 0.115 0.071
36 0.005 0.200 0.063 0.103 0.054 0.511 111.039 0.115 0.072
37 0.030 0.050 0.066 0.120 0.027 0.587 416.993 0.057 0.045
38 0.030 0.090 0.064 0.111 0.023 0.138 68.930 0.087 0.057
39 0.030 0.170 0.062 0.101 0.046 0.574 112.003 0.116 0.071

GM3 40 0.030 0.200 0.063 0.103 0.054 0.514 109.933 0.114 0.071
41 0.070 0.050 0.062 0.104 0.035 0.325 82.094 0.104 0.067
42 0.070 0.090 0.062 0.103 0.035 0.318 68.569 0.109 0.063
43 0.070 0.170 0.062 0.103 0.047 0.443 98.785 0.123 0.093
44 0.070 0.200 0.062 0.104 0.057 0.705 101.313 0.117 0.071
45 0.010 0.050 0.061 0.102 0.059 1.131 142.069 0.127 0.079
46 0.010 0.090 0.061 0.101 0.060 2.132 164.644 0.122 0.082
47 0.010 0.170 0.061 0.102 0.060 1.258 139.509 0.129 0.081
48 0.010 0.200 0.061 0.102 0.061 2.103 161.523 0.133 0.079



85

Simulation study with regular data set

Figure B.2. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with regular data set.

Table B.2. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes with
regular data set.

MSE for:

Group Mesh c a ?0 ?1 ?2e ?
2
s k ?

? ?
2
s
?

1 0.005 0.050 0.059 0.122 0.090 3.031 1513.227 0.005 0.005
2 0.005 0.090 0.059 0.123 0.090 55.848 1607.877 0.006 0.005
3 0.005 0.170 0.061 0.125 0.090 57.665 470.474 0.009 0.007
4 0.005 0.200 0.061 0.126 0.090 69.132 797.943 0.010 0.010
5 0.030 0.050 0.059 0.123 0.090 2.272 757.171 0.005 0.005
6 0.030 0.090 0.059 0.123 0.090 55.848 1607.877 0.006 0.005
7 0.030 0.170 0.061 0.125 0.090 57.665 470.474 0.009 0.007

GM1 8 0.030 0.200 0.061 0.126 0.090 69.132 797.943 0.010 0.010
9 0.070 0.050 0.059 0.121 0.090 101.645 1420.148 0.006 0.011

10 0.070 0.090 0.059 0.121 0.090 111.090 1247.377 0.006 0.010
11 0.070 0.170 0.060 0.125 0.090 294.339 1147.598 0.010 0.012
12 0.070 0.200 0.060 0.125 0.090 2146.851 2683.051 0.009 0.032
13 0.010 0.050 0.060 0.125 0.090 805.068 2435.142 0.010 0.027
14 0.010 0.090 0.060 0.125 0.090 805.068 2435.142 0.010 0.027
15 0.010 0.170 0.060 0.125 0.090 805.068 2435.142 0.010 0.027
16 0.010 0.200 0.060 0.125 0.090 805.068 2435.142 0.010 0.027
17 0.005 0.050 0.061 0.124 0.090 8.358 825.628 0.006 0.004
18 0.005 0.090 0.061 0.132 0.090 72.039 1158.467 0.009 0.007
19 0.005 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042
20 0.005 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039
21 0.030 0.050 0.060 0.125 0.090 1.519 269.073 0.007 0.004
22 0.030 0.090 0.061 0.132 0.090 72.039 1158.467 0.009 0.007
23 0.030 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042

GM2 24 0.030 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039
25 0.070 0.050 0.067 0.140 0.085 380.776 1497.534 0.072 0.036
26 0.070 0.090 0.067 0.143 0.085 4458.014 3401.350 0.085 0.086
27 0.070 0.170 0.061 0.128 0.095 1.984 83.765 0.171 0.042
28 0.070 0.200 0.059 0.125 0.124 1.148 71.887 0.185 0.039
29 0.010 0.050 0.059 0.127 0.125 0.830 75.770 0.266 0.040
30 0.010 0.090 0.059 0.127 0.116 1.661 97.474 0.222 0.040
31 0.010 0.170 0.059 0.126 0.117 2.239 91.836 0.170 0.032
32 0.010 0.200 0.059 0.125 0.119 0.950 78.014 0.179 0.031
33 0.005 0.050 0.060 0.124 0.090 0.131 34.614 0.004 0.005
34 0.005 0.090 0.064 0.136 0.090 47.797 725.652 0.005 0.008
35 0.005 0.170 0.060 0.128 0.086 0.120 37.899 0.205 0.044
36 0.005 0.200 0.059 0.126 0.093 0.126 40.235 0.213 0.047
37 0.030 0.050 0.061 0.128 0.090 1.674 562.439 0.005 0.005
38 0.030 0.090 0.064 0.136 0.090 47.797 725.652 0.005 0.008
39 0.030 0.170 0.060 0.128 0.086 0.120 37.899 0.205 0.044

GM3 40 0.030 0.200 0.059 0.126 0.093 0.126 40.235 0.213 0.047
41 0.070 0.050 0.063 0.155 0.083 498.872 1652.502 0.107 0.035
42 0.070 0.090 0.066 0.151 0.087 310.197 932.174 0.041 0.024
43 0.070 0.170 0.059 0.128 0.090 0.121 41.305 0.212 0.047
44 0.070 0.200 0.059 0.127 0.093 0.126 42.211 0.211 0.047
45 0.010 0.050 0.059 0.126 0.092 0.138 44.709 0.208 0.046
46 0.010 0.090 0.059 0.125 0.098 0.154 46.126 0.256 0.053
47 0.010 0.170 0.059 0.126 0.092 0.138 43.749 0.208 0.046
48 0.010 0.200 0.059 0.126 0.092 0.138 43.749 0.208 0.046



86

Simulation study with cluster data set

Figure B.3. Coverage of the meshes for: beta0, beta1, ?2e , ?2s , k and ??, with cluster data set.



87

Table B.3. MSE of the parameters ?0, ?1, ?2e , ?2s , k and ?? and for
?2s
?

, considering all meshes with
cluster data set.

MSE for:
Group Mesh c a ?0 ?1 ?2e ?2s k ??

?2s
?

1 0.005 0.050 0.077 0.122 0.067 0.098 358.855 0.029 0.015
2 0.005 0.090 0.079 0.137 0.069 0.212 224.366 0.028 0.013
3 0.005 0.170 0.080 0.140 0.068 0.371 105.996 0.047 0.023
4 0.005 0.200 0.075 0.123 0.068 0.397 86.291 0.030 0.010
5 0.030 0.050 0.070 0.096 0.016 0.052 117.775 0.037 0.023
6 0.030 0.090 0.068 0.095 0.015 0.068 92.372 0.040 0.031
7 0.030 0.170 0.068 0.094 0.018 0.065 60.188 0.060 0.035

GM1 8 0.030 0.200 0.067 0.093 0.017 0.062 48.392 0.046 0.027
9 0.070 0.050 0.070 0.097 0.033 0.233 104.191 0.076 0.042
10 0.070 0.090 0.070 0.098 0.033 0.212 111.425 0.075 0.039
11 0.070 0.170 0.070 0.096 0.041 0.159 87.497 0.083 0.050
12 0.070 0.200 0.070 0.098 0.044 0.176 73.412 0.088 0.057
13 0.010 0.050 0.070 0.097 0.056 0.861 129.622 0.131 0.079
14 0.010 0.090 0.070 0.098 0.057 0.875 123.825 0.131 0.082
15 0.010 0.170 0.070 0.097 0.056 0.770 120.767 0.140 0.092
16 0.010 0.200 0.069 0.097 0.059 0.900 131.053 0.132 0.086
17 0.005 0.050 0.071 0.096 0.024 0.111 89.881 0.064 0.043
18 0.005 0.090 0.070 0.092 0.023 0.167 95.257 0.077 0.039
19 0.005 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100
20 0.005 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108
21 0.030 0.050 0.070 0.094 0.021 0.199 147.394 0.062 0.042
22 0.030 0.090 0.070 0.092 0.023 0.167 95.257 0.077 0.039
23 0.030 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100

GM2 24 0.030 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108
25 0.070 0.050 0.071 0.098 0.040 1.201 147.496 0.090 0.055
26 0.070 0.090 0.070 0.098 0.037 0.677 138.932 0.090 0.049
27 0.070 0.170 0.070 0.096 0.053 2.064 176.069 0.123 0.100
28 0.070 0.200 0.071 0.097 0.069 1.559 125.360 0.148 0.108
29 0.010 0.050 0.071 0.096 0.067 2.519 173.810 0.166 0.190
30 0.010 0.090 0.071 0.096 0.064 2.352 163.539 0.123 0.066
31 0.010 0.170 0.072 0.102 0.064 1.518 146.115 0.137 0.122
32 0.010 0.200 0.070 0.097 0.065 2.870 182.690 0.155 0.118
33 0.005 0.050 0.072 0.103 0.019 0.087 172.062 0.043 0.027
34 0.005 0.090 0.070 0.095 0.019 0.091 83.856 0.051 0.032
35 0.005 0.170 0.072 0.097 0.040 0.120 75.647 0.107 0.067
36 0.005 0.200 0.072 0.099 0.044 0.376 126.372 0.105 0.074
37 0.030 0.050 0.071 0.096 0.017 0.093 93.509 0.042 0.027
38 0.030 0.090 0.070 0.095 0.019 0.092 85.093 0.051 0.033
39 0.030 0.170 0.072 0.097 0.040 0.121 74.818 0.107 0.067

GM3 40 0.030 0.200 0.072 0.099 0.044 0.351 115.666 0.105 0.072
41 0.070 0.050 0.072 0.097 0.034 0.231 101.557 0.087 0.053
42 0.070 0.090 0.072 0.098 0.034 0.209 94.262 0.088 0.055
43 0.070 0.170 0.072 0.098 0.042 0.284 107.271 0.128 0.122
44 0.070 0.200 0.072 0.100 0.047 0.718 142.403 0.126 0.110
45 0.010 0.050 0.073 0.101 0.057 0.350 103.119 0.144 0.152
46 0.010 0.090 0.074 0.101 0.057 0.344 96.259 0.148 0.158
47 0.010 0.170 0.073 0.101 0.057 0.360 104.559 0.142 0.150
48 0.010 0.200 0.073 0.100 0.058 0.625 131.008 0.139 0.142



88

Additional data analysis results

• Parana? dataset

Figure B.4. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM1.

Figure B.5. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM1.

Figure B.6. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM1.



89

Figure B.7. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM2.

Figure B.8. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM2.

Figure B.9. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM2.



90

Figure B.10. Meshes with c = 13, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM3.

Figure B.11. Meshes with c = 35, b = 570 and a = (20, 35, 55, 100, 240, 380) of GM3.

Figure B.12. Meshes with c = 51, b = 570 and a = (20, 35, 55, 100, 240, 380)of GM3.



91

Figure B.13. Posterior density for meshes with Paraná data set.



92

• Soil data set

Figure B.14. Meshes with c = 14, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM1.

Figure B.15. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM1.



93

Figure B.16. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400)of GM1.

Figure B.17. Meshes with c = 14, b600 and a = (20, 40, 60, 120, 260, 400) of GM2.

Figure B.18. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM2.



94

Figure B.19. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM2.

Figure B.20. Meshes with c = 14, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3.

Figure B.21. Meshes with c = 37, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3.



95

Figure B.22. Meshes with c = 54, b = 600 and a = (20, 40, 60, 120, 260, 400) of GM3.




</field>
	</doc>
</add>