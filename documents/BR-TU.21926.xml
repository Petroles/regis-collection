<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.21926</field>
		<field name="filename">5745_309792.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA
PROGRAMA DE PO?S-GRADUAC?A?O EM ENGENHARIA

DE AUTOMAC?A?O E SISTEMAS

Thiago Lima Silva

FORMULAC?O?ES INTEIRAS MISTAS PARA MODELOS
LINEARES POR PARTES MULTIDIMENSIONAIS:

APLICAC?O?ES NA OTIMIZAC?A?O DA PRODUC?A?O DE
PETRO?LEO SOB RESTRIC?O?ES DE PRESSA?O

Floriano?polis

2012





Thiago Lima Silva

FORMULAC?O?ES INTEIRAS MISTAS PARA MODELOS
LINEARES POR PARTES MULTIDIMENSIONAIS:

APLICAC?O?ES NA OTIMIZAC?A?O DA PRODUC?A?O DE
PETRO?LEO SOB RESTRIC?O?ES DE PRESSA?O

Dissertac?a?o submetida ao Programa
de Po?s-Graduac?a?o em Engenharia de
Automac?a?o e Sistemas para a obten-
c?a?o do Grau de mestre.
Orientador: Prof. Eduardo Campono-
gara, Ph.D.

Floriano?polis

2012



Ficha de identificação da obra elaborada pelo autor,
 através do Programa de Geração Automática da Biblioteca Universitária da UFSC.

Silva, Thiago Lima
   Formulações inteiras mistas para modelos lineares por
partes multidimensionais [dissertação] : aplicações na
otimização da produção de petróleo sob restrições de pressão /
Thiago Lima Silva ; orientador, Eduardo Camponogara -
Florianópolis, SC, 2012.
   142 p. ; 21cm

   Dissertação (mestrado) - Universidade Federal de Santa
Catarina, Centro Tecnológico. Programa de Pós-Graduação em
Engenharia de Automação e Sistemas.

   Inclui referências 

   1. Engenharia de Automação e Sistemas. 2. Linearização
por partes. 3. Funções multidimensionais. 4. Programação
inteira-mista. 5. Restrições de pressão. I. Camponogara,
Eduardo. II. Universidade Federal de Santa Catarina.
Programa de Pós-Graduação em Engenharia de Automação e
Sistemas. III. Título.



Thiago Lima Silva

FORMULAC?O?ES INTEIRAS MISTAS PARA MODELOS LINEARES
POR PARTES MULTIDIMENSIONAIS

Esta Dissertac?a?o foi julgada aprovada para a obtenc?a?o do T??tulo de “mestre”, e
aprovada em sua forma final pelo Programa de Po?s-Graduac?a?o em Engenharia de
Automac?a?o e Sistemas.

Floriano?polis, 18 de Junho 2012.

Prof. Jomi Fred Hu?bner, Dr.
Coordenador do Curso

Prof. Eduardo Camponogara, Ph.D.
Orientador

Banca Examinadora:

Prof. Eduardo Camponogara, Ph.D.
Presidente

Prof. Agustinho Plucenio, Dr.





Alex Furtado Teixeira, Eng.

Prof. Cid Carvalho de Souza, Dr.

Prof. Katia Campos de Almeida, Ph.D.





Dedico essa dissertac?a?o aos meus pais por
serem os meus grandes amigos e compa-
nheiros em todos os momentos da minha
vida.





AGRADECIMENTOS

Ao professor, orientador e amigo Eduardo Camponogara pela
motivac?a?o e apoio incondicional no desenvolvimento desta dissertac?a?o.

Agradec?o a meus pais pelos conselhos e pela compreensa?o du-
rante o desenvolvimento deste trabalho.

Ao Conselho Nacional de Desenvolvimento Cient??fico (CNPq),
inicialmente, e a? Petrobras pelo apoio financeiro para a realizac?a?o deste
trabalho.

Agradec?o a meus irma?os e minha fam??lia pelo pela preocupac?a?o
e apoio ao longo desses anos.

Agradec?o a I?tala pelo amor, compreensa?o e cumplicidade ao
longo desses anos.

Agradec?o a meus amigos e companheiros pela amizade e por
tornar os dias de trabalho mais divertidos.





“Tenho apenas duas ma?os e o sentimento
do mundo”

Carlos Drummond de Andrade





RESUMO

O problema de alocac?a?o de ga?s de injec?a?o com restric?o?es de alinha-
mento poc?o-manifold e restric?o?es de pressa?o no sistema de produc?a?o
e? um problema na?o linear inteiro-misto de dificuldade considera?vel. A
complexidade deste problema reside na natureza das deciso?es discretas
do alinhamento e nas na?o linearidades presentes nas curvas de produc?a?o
dos poc?os e de queda de pressa?o nas tubulac?o?es.

A abordagem de soluc?a?o utilizada neste trabalho e? a reformula-
c?a?o deste problema em programas lineares inteiros-mistos com o uso
de ferramentas de linearizac?a?o por partes para func?o?es multidimensio-
nais. Foram desenvolvidas sete reformulac?o?es lineares inteiras-mistas,
considerando aproximac?o?es por hipercubos e por simplexes. Enquanto
a aproximac?a?o por hipercubos e? mais simples e possui menos varia?-
veis, a aproximac?a?o por simplexes possui mais varia?veis, mas e? mais
detalhada.

Foi apresentada uma ana?lise computacional destas formulac?o?es
para um cena?rio modelado a partir de um sistema de produc?a?o sinte?tico
constru??do com uma ferramenta de escoamento multifa?sico. Para ava-
liar o desempenho das formulac?o?es desenvolvidas, foram considerados
cena?rios com diferentes disponibilidades de ga?s no compressor e diferen-
tes qualidades de aproximac?a?o. Os resultados da ana?lise computacional
mostraram que, para as aproximac?o?es por hipercubos, o modelo SOS2
teve melhor desempenho na maioria dos cena?rios. Para as aproxima-
c?o?es por simplexes, o modelo Log teve o melhor desempenho dentre
os modelos. Considerando ambas aproximac?o?es, para um cena?rio com
qualidade de aproximac?a?o fina e com uma restric?a?o mais apertada na
disponibilidade de ga?s de injec?a?o, apenas o modelo Log conseguiu obter
a soluc?a?o o?tima para o problema.

Palavras-chave: Linearizac?a?o Por Partes, Func?o?es Multidimensio-
nais, Programac?a?o Inteira-Mista, Alocac?a?o de Ga?s de Injec?a?o, Restri-
c?o?es de Pressa?o.





ABSTRACT

The problem of allocating lift-gas to oil wells subject to well-manifold
routing, and pressure constraints in the production system is a mixed-
integer non-linear problem of considerable difficulty. The complexity of
this problem rests on the nature of discrete decisions of the routing and
the non linearities of the well production curves and pressure drops in
the pipelines.

The solution approach used in this work is the reformulation of this
problem into mixed-integer linear programs with piecewise-linearization
tools for multidimensional functions. Seven mixed-integer linear refor-
mulations were developed with hypercube and simplex approximations.
While the hypercube approximation is simpler and more compact, the
simplex approximation has more variables, but is more accurate.

A computational analysis of the application of these formulations
to a synthetic production system represented in a multi-flow simulator
is presented. In order to evaluate the performance of these formulations,
instances with different availability of lift-gas in the compressor and
different qualities of approximation were considered. The results of the
computational analysis showed that the SOS2 model solved the problem
faster in most instances of the hypercube approximation. With simplex
approximations, the Log model was faster in all scenarios. Considering
both approximations, when the quality of approximation is accurate
and the lift-gas availability is low, only the Log model obtained the
optimal solution.

Keywords: Piecewise-linearization, Multidimensional Functions, Mixed-
Integer Programming, Lift-gas Allocation, Pressure Constraints.





LISTA DE FIGURAS

Figura 1 Sistema Simplificado de Produc?a?o com Alinhamento e
Injec?a?o de Ga?s. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

Figura 2 Injec?a?o Cont??nua de Ga?s. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

Figura 3 Curva de Desempenho do Poc?o. . . . . . . . . . . . . . . . . . . . . . . . 38

Figura 4 Curva de Produc?a?o do Poc?o. . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

Figura 5 Curva de Queda de Pressa?o. . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

Figura 6 Formulac?a?o da Rede de Produc?a?o . . . . . . . . . . . . . . . . . . . . . . 50

Figura 7 Func?a?o Linear por Partes Na?o-convexa com Dom??nio
Unidimensional. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55

Figura 8 Func?a?o Linear por Partes com Dom??nio Bidimensional. 56

Figura 9 Triangulac?a?o J1 no dom??nio de f (x,y) . . . . . . . . . . . . . . . . . . 57
Figura 10 Uma Ramificac?a?o para o Modelo Log. . . . . . . . . . . . . . . . . . 67

Figura 11 Dom??nio Bidimensional da Func?a?o Ilustrativa Particio-
nado em uma Grade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

Figura 12 Rede de Produc?a?o com Injec?a?o de Ga?s. . . . . . . . . . . . . . . . . 108

Figura 13 Hipercubos - Capacidade de compressa?o Alta . . . . . . . . . . 114

Figura 14 Hipercubos - Capacidade de Compressa?o Me?dia . . . . . . . . 115

Figura 15 Hipercubos - Capacidade de Compressa?o Baixa . . . . . . . . 116

Figura 16 Simplexes - Capacidade de Compressa?o Alta . . . . . . . . . . . 121

Figura 17 Simplexes - Capacidade de Compressa?o Me?dia . . . . . . . . . 122

Figura 18 Simplexes - Capacidade de Compressa?o Baixa . . . . . . . . . 123

Figura 19 J1 ordenada em [0,2]2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138





LISTA DE TABELAS

Tabela 1 Nu?mero de Varia?veis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

Tabela 2 Nu?mero de Restric?o?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83

Tabela 3 Para?metros dos Poc?os . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108

Tabela 4 Aproximac?a?o com Hipercubos com Qualidade Baixa . . . 112

Tabela 5 Aproximac?a?o com Hipercubos com Qualidade Me?dia . . . 112

Tabela 6 Aproximac?a?o com Hipercubos com Qualidade Fina . . . . 113

Tabela 7 Simplexes - Qualidade Baixa . . . . . . . . . . . . . . . . . . . . . . . . . . 118

Tabela 8 Simplexes - Qualidade Me?dia . . . . . . . . . . . . . . . . . . . . . . . . . . 119

Tabela 9 Simplexes - Qualidade Alta . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

Tabela 10 Tamanho da Formulac?a?o (Qualidade Baixa, Simplexes) 140

Tabela 11 Tamanho da Formulac?a?o (Qualidade Me?dia, Simplexes) 140

Tabela 12 Tamanho da Formulac?a?o (Qualidade Fina, Simplexes) . 140

Tabela 13 Tamanho da Formulac?a?o (Qualidade baixa, Hipercubos)141

Tabela 14 Tamanho da Formulac?a?o (Qualidade me?dia, Hipercubos)141

Tabela 15 Tamanho da Formulac?a?o (Qualidade fina, Hipercubos) . 141

Tabela 16 Custos/Ganhos Econo?micos . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

Tabela 17 Soluc?a?o com Simplexes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

Tabela 18 Soluc?a?o com Hipercubos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

Tabela 19 Injec?a?o de Ga?s (Hipercubos) . . . . . . . . . . . . . . . . . . . . . . . . . . . 143

Tabela 20 Injec?a?o de Ga?s (Simplexes) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144





LISTA DE ABREVIATURAS E SIGLAS

WPC Well Performance Curve . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38

PQS Programac?a?o Quadra?tica Sucessiva . . . . . . . . . . . . . . . . . . . . . 39

BSW Basic Sediments and Water . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

PLS Programac?a?o Linear Sucessiva . . . . . . . . . . . . . . . . . . . . . . . . . . 45

DI Dia?metro interno . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

R Rugosidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107

RGO Raza?o ga?s-o?leo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107





LISTA DE SI?MBOLOS

qni Varia?vel cont??nua que representa a taxa de ga?s injetado no
poc?o n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

yn Varia?vel bina?ria que indica se um poc?o n esta? produzindo . . 48
zn,m Varia?vel bina?ria de alinhamento que indica se a produc?a?o do

poc?o n e? direcionada ao manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
qn,mh Vaza?o da fase h ? H enviada do poc?o n para o manifold m 48
qn,m Vetor com as vazo?es de todas as fases enviados do poc?o n

para o manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
qm Varia?vel que representa a vaza?o total recebida dos poc?os co-

nectados ao manifold m para todas as fases . . . . . . . . . . . . . . . . . . . 48
pm Varia?vel que representa a pressa?o do manifold m . . . . . . . . . . . 48
P Problema de Alocac?a?o de Ga?s sob restric?o?es de Alinhamento

e Pressa?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

N Nu?mero total de poc?os de petro?leo . . . . . . . . . . . . . . . . . . . . . . . . . 48
N Conjunto de poc?os considerados no problema . . . . . . . . . . . . . . 48

Nm Subconjunto de poc?os cuja produc?a?o pode ser enviada ao
manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

M Nu?mero total de manifolds de produc?a?o . . . . . . . . . . . . . . . . . . . 49
M Conjunto de manifolds do sistema . . . . . . . . . . . . . . . . . . . . . . . . . 49

Mn Subconjunto dos manifolds que podem receber produc?a?o do
poc?o n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

H Conjunto com as vazo?es multifa?sicas: o?leo (o), ga?s (g) e a?gua
(w) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

qmaxi Capacidade de compressa?o dos compressores . . . . . . . . . . . . . . . 49
ln Limite inferior de injec?a?o de ga?s do poc?o n . . . . . . . . . . . . . . . . . 49
un Limite superior de injec?a?o de ga?s do poc?o n . . . . . . . . . . . . . . . . 49
pm,S Pressa?o operacional do separador que recebe a produc?a?o do

manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
qn,L Limite inferior de vaza?o do poc?o n . . . . . . . . . . . . . . . . . . . . . . . . . 49
qn,U Limite superior de vaza?o do poc?o n . . . . . . . . . . . . . . . . . . . . . . . . 49
qm,S Capacidade de processamento do separador conectado ao

manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
pm,min Pressa?o operacional m??nima do manifold m . . . . . . . . . . . . . . . . 49



pm,max Pressa?o operacional ma?xima do manifold m . . . . . . . . . . . . . . . . 49
f Func?a?o que indica o benef??cio econo?mico do sistema de pro-

duc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

g Func?a?o que indica o ganho com a produc?a?o de um manifold 49
c Func?a?o que indica o custo com a injec?a?o de ga?s nos poc?os . . 49
?pm Varia?vel que representa a queda de pressa?o na tubulac?a?o que

conecta o manifold m ao separador que recebe sua produc?a?o. . . 49
P Conjunto de politopos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

V (P) Conjunto dos ve?rtices do Politopo P . . . . . . . . . . . . . . . . . . . . . . . 54
yP Varia?vel bina?ria que indica se um politopo P esta? ativo . . . . 57
?P,v Varia?vel de peso cont??nua associada ao ve?rtice v do politopo

P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
P j(B,l) Conjunto de politopos cujos co?digos bina?rios tem o valor

j ?{0,1} na posic?a?o l . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
L(P) Conjunto de ??ndices para o co?digo bina?rio do politopo P . . . 60
?v Varia?vel de peso cont??nua associada a um ve?rtice v . . . . . . . . . 64
B Func?a?o injetora que associa a cada politopo P ?P um vetor

bina?rio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66

Lt Subconjunto do conjunto de ve?rtices que representa o ramo
da esquerda de uma ramificac?a?o no n??vel t . . . . . . . . . . . . . . . . . . . . 67

Rt Subconjunto do conjunto de ve?rtices que representa o ramo
da direita de uma ramificac?a?o no n??vel t . . . . . . . . . . . . . . . . . . . . . . . 67

E d Conjunto de eixos do dom??nio com dimensa?o d . . . . . . . . . . . . 68
Se Conjunto de breakpoints do eixo e . . . . . . . . . . . . . . . . . . . . . . . . . 68
Ie Conjunto dos intervalos contidos no eixo e . . . . . . . . . . . . . . . . . 68
Ie(s) Conjunto de intervalos do eixo e que conte?m o breakpoint s 68
J+e,B,l Subconjunto do conjunto de ve?rtices contido cujos intervalos

que os conte?m te?m 1 na posic?a?o l do seu co?digo bina?rio . . . . . . . 68
J0e,B,l Subconjunto do conjunto de ve?rtices contido cujos intervalos

que os conte?m te?m 0 na posic?a?o l do seu co?digo bina?rio . . . . . . . 68
Lr,s Conjunto dos ve?rtices que te?m valor par na posic?a?o r e ??mpar

na posic?a?o s do ve?rtice v . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
Rr,s Conjunto dos ve?rtices que te?m valor ??mpar na posic?a?o r e

par na posic?a?o s do ve?rtice v . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
xP Varia?vel cont??nua que representa um ponto do dom??nio no

politopo P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73



?k Varia?vel cont??nua associada ao intervalo [dk?1,dk] . . . . . . . . . . 76
?

n,m,P
qi,pr Varia?vel de peso associada a um par de breakpoints em K

n,m×
Rn,m no politopo P . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

P n,m Conjunto de politopos no dom??nio da func?a?o de vaza?o do
poc?o n para o manifold m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88

P m Conjunto de politopos no dom??nio da func?a?o de queda de
pressa?o na tubulac?a?o do manifold m para o seu separador . . . . . 88

yn,mP Varia?vel bina?ria associada a cada politopo P ? P
n,m . . . . . . . 88

ymP Varia?vel bina?ria associada a cada politopo P ? P
m . . . . . . . . . 88

?
m,P
ko,kg,kw Varia?vel de peso associada ao ve?rtice

(ko,kg,kw) ?V (P), com P ? P m; . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
ym Varia?vel bina?ria que indica se o manifold m recebe produc?a?o 88
K n,m Conjunto de breakpoints referentes a? vaza?o de ga?s de injec?a?o 89

Rn,m Conjunto de breakpoints referentes a? variac?a?o da pressa?o do
manifold . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89

yl Varia?vel bina?ria para a entrada l do co?digo bina?rio de cada
politopo que constro?i uma ramificac?a?o . . . . . . . . . . . . . . . . . . . . . . . . 90

P j,n,m(B,l) Conjunto que agrupa os politopos pertencentes a P n,m

associados a? func?a?o B que de acordo com o valor j no ??ndice l
da sua representac?a?o bina?ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

L (P n,m) Conjunto de ??ndice para os vetores bina?rios que represen-
tam cada politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

P n,m(qi, pr)Conjunto dos politopos P?P n,m que conte?m o ve?rtice (qi, pr) 92
P m(ko,kg,kw)Conjunto dos politopos P?P m que conte?m o ve?rtice (ko,kg,kw) 93
xn,ml Varia?vel bina?ria que induz a primeira fase da ramificac?a?o do

Log para cada ??ndice em l ? ?(K n,m) . . . . . . . . . . . . . . . . . . . . . . . . . 95
x?n,ml Varia?vel bina?ria que induz a primeira fase da ramificac?a?o do

Log para cada ??ndice em l ? ?(Rn,m) . . . . . . . . . . . . . . . . . . . . . . . . . 95
yn,mr,s Varia?vel bina?ria que induz a segunda fase da ramificac?a?o do

Log com (r,s) ? ?n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
?(K n,m) Conjunto de ??ndices para os co?digos bina?rios que repre-

sentam os intervalos contidos em K n,m . . . . . . . . . . . . . . . . . . . . . . . . 95

?(Rn,m) Conjunto de ??ndices para os co?digos bina?rios que repre-
sentam os intervalos contidos em Rn,m . . . . . . . . . . . . . . . . . . . . . . . . 95

?
n,m Conjunto de pares com ??ndices usados para construir a tri-

angulac?a?o J1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95

L
n,m

r,s Conjunto dos ve?rtices v ?V (P), com P ? P n,m, cujo valor vr



e? par e vs e? ??mpar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
R

n,m
r,s Conjunto dos ve?rtices v ?V (P), com P ? P n,m, cujo valor vr

e? ??mpar e vs e? par . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
axis(Q) Eixo que conte?m o conjunto de breakpoints Q . . . . . . . . . . . 95
xm,?l Varia?vel bina?ria que define a primeira fase da ramificac?a?o do

Log para a fase com ? ?{O,G,W} e para o ??ndice l ? ?(?m) de
B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

ymr,s Varia?vel bina?ria que constro?i a segunda fase da ramificac?a?o
do Log para cada par (r,s) ? ?m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

L
n,m

r,s Conjunto dos ve?rtices v ?V (P), com P ? P m, cujo valor vr e?
par e vs e? ??mpar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97

R
n,m
r,s Conjunto dos ve?rtices v ?V (P), com P ? P m, cujo valor vr e?

??mpar e vs e? par . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
qn,m,Pi Varia?vel cont??nua que representa a injec?a?o de ga?s em um

poc?o n para o politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
pn,m,Pr Varia?vel cont??nua que representa a pressa?o do manifold m no

politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
mn,mP Vetor com os coeficientes para o hiperplano que aproxima a

func?a?o qn,m no politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
cn,mP Coeficiente linear do hiperplano que aproxima a func?a?o q

n,m

no politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
An,mP Matriz com coeficientes das inequac?o?es lineares que definem

o politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
bn,mP Vetor com coeficientes das inequac?o?es lineares que restringem

o politopo P ? P n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
qmP Vetor que conte?m as varia?veis cont??nuas que representam as

vazo?es de ga?s, o?leo e a?gua, respectivamente, na tubulac?a?o que
conecta o manifold m ao seu separador, dentro de um politopo
P ? P m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

mmP Coeficientes do vetor normal do hiperplano que aproxima a
func?a?o ? pm(qmP ) no politopo P ? P

m . . . . . . . . . . . . . . . . . . . . . . . . . . 99

cmP Coeficiente linear do hiperplano que aproxima a func?a?o ? p
m(qmP )

no politopo P ? P m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
AmP Matriz com coeficientes das inequac?o?es lineares que definem

o politopo P ? P m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
bmP Vetor com coeficientes das inequac?o?es lineares que definem

o politopo P ? P m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
?

j,k
n,m Varia?vel cont??nua de peso que, incrementalmente, condiciona



o dom??nio a apenas um simplex T ? T n,m . . . . . . . . . . . . . . . . . . . . . 101
w jn,m Varia?vel bina?ria que indica quais varia?veis de peso ?

j,k
n,m dos

simplexes Tj ? T n,m sa?o ativadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
q j,ki,n,m Breakpoint de injec?a?o de ga?s correspondente ao ve?rtice k do

simplex j ? T n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
p j,kr,n,m Breakpoint de pressa?o do manifold m correspondente ao ve?r-

tice k do simplex j ? T n,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
T n,m Conjunto de simplexes que compo?em a fam??lia de politopos

do dom??nio da func?a?o de vaza?o do poc?o n para o manifold m
qn,m . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101

V (T ) conjunto de ve?rtices do simplex T ? T n,m . . . . . . . . . . . . . . . . . . 101
?

j,k
m Varia?vel cont??nua de peso que, incrementalmente, condiciona

o dom??nio a apenas um simplex Tj ? T m. . . . . . . . . . . . . . . . . . . . . . 102
w jm Varia?vel bina?ria que indica quais varia?veis de peso ?

j,k
m dos

simplexes Tj ? T m esta?o ativos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
q j,km Vetor que conte?m as varia?veis cont??nuas que representam

as vazo?es de ga?s, o?leo e a?gua em um ve?rtice k de um simplex
Tj ? T m; . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

T m Conjunto de simplexes que compo?em a fam??lia de politopos
do dom??nio da func?a?o de queda de pressa?o ? pm(qm) na tubulac?a?o
que conectam o manifold m ao seu separador . . . . . . . . . . . . . . . . . . 102

?
n,m
qi Varia?vel cont??nua auxiliar que representa a soma das vari-

a?veis de peso ?q?i,pr
para uma determinada taxa de injec?a?o de

ga?s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

?
n,m
pr Varia?vel cont??nua auxiliar que representa a soma das varia?-

veis de peso ?qi,p?r para uma determinada pressa?o no manifold . 104

?
m
o Varia?vel cont??nua auxiliar que representa a soma das varia?-

veis de peso ?mko,kg,kw tal que k
o = o para o ? O m . . . . . . . . . . . . . . . 105

?
m
g Varia?vel cont??nua auxiliar que representa a soma das varia?-

veis de peso ?mko,kg,kw tal que k
g = g para g ? G m . . . . . . . . . . . . . . . 105

?
m
w Varia?vel cont??nua auxiliar que representa a soma das varia?-
veis de peso ?mko,kg,kw tal que k

w = w para w ? W m . . . . . . . . . . . . . 105





SUMA?RIO

1 INTRODUC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
1.1 CONTRIBUIC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
1.2 ESTRUTURA DA DISSERTAC?A?O . . . . . . . . . . . . . . . . . . . . . . 33
2 DEFINIC?A?O DO PROBLEMA . . . . . . . . . . . . . . . . . . . . . 35
2.1 ELEVAC?A?O ARTIFICIAL POR INJEC?A?O CONTI?NUA DE

GA?S . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
2.2 TRABALHOS RELACIONADOS: DISTRIBUIC?A?O DE GA?S

DE INJEC?A?O SUJEITO A RESTRIC?O?ES DE PRESSA?O . . 39
2.2.1 Alocac?a?o de Ga?s de Injec?a?o . . . . . . . . . . . . . . . . . . . . . . . . 39
2.2.2 Restric?o?es de Pressa?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
2.3 FORMULAC?A?O DO PROBLEMA . . . . . . . . . . . . . . . . . . . . . . . 47
2.4 SUMA?RIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
3 MODELOS INTEIROS-MISTOS PARA FUNC?O?ES

LINEARES POR PARTES MULTIDIMENSIONAIS . 53
3.1 NOTAC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
3.1.1 Exemplo com Dom??nio Unidimensional . . . . . . . . . . . . . 54
3.1.2 Exemplo com Dom??nio Bidimensional . . . . . . . . . . . . . . 54
3.2 MODELOS DE COMBINAC?A?O CONVEXA DESAGRE-

GADA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
3.2.1 Modelo Ba?sico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
3.2.1.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
3.2.1.2 Caso Bidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
3.2.2 Modelo Logar??tmico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
3.2.2.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
3.2.2.2 Caso Bidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
3.3 MODELOS DE COMBINAC?A?O CONVEXA (AGREGADA) 63
3.3.1 Modelo Ba?sico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
3.3.1.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
3.3.1.2 Caso Bidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
3.3.2 Modelo Logar??tmico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
3.3.2.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
3.3.2.2 Caso Bidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
3.4 MODELO MU?LTIPLA ESCOLHA . . . . . . . . . . . . . . . . . . . . . . . 73
3.4.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
3.4.2 Caso Bidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
3.5 MODELO INCREMENTAL . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
3.5.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76



3.5.2 Caso Multidimensional (Bidimensional) . . . . . . . . . . . 77
3.6 MODELO SOS2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
3.6.1 Caso Unidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
3.6.2 Caso Multidimensional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
3.7 TAMANHO DAS FORMULAC?O?ES . . . . . . . . . . . . . . . . . . . . . . 82
3.8 SUMA?RIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
4 REFORMULAC?O?ES LINEARES POR PARTES . . . . . 85
4.1 REFORMULAC?A?O COM O MODELO DCC . . . . . . . . . . . . . 85
4.2 REFORMULAC?A?O COM O MODELO DLOG . . . . . . . . . . . . 89
4.3 REFORMULAC?A?O COM O MODELO CC . . . . . . . . . . . . . . . 91
4.4 REFORMULAC?A?O COM O MODELO LOG . . . . . . . . . . . . . 93
4.5 REFORMULAC?A?O COM O MODELO MC . . . . . . . . . . . . . . 97
4.6 REFORMULAC?A?O COM O MODELO INC . . . . . . . . . . . . . . 100
4.7 REFORMULAC?A?O COM O MODELO SOS2 . . . . . . . . . . . . . 103
4.8 SUMA?RIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5 ANA?LISE COMPUTACIONAL . . . . . . . . . . . . . . . . . . . . 107
5.1 SISTEMA DE PRODUC?A?O . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.2 ANA?LISE DE DESEMPENHO . . . . . . . . . . . . . . . . . . . . . . . . . . 109
5.2.1 Aproximac?a?o por Hipercubos . . . . . . . . . . . . . . . . . . . . . . 111
5.2.1.1 Variac?a?o da Capacidade de Compressa?o de Ga?s . . . . . . . . . 111
5.2.1.2 Variac?a?o da Qualidade de Aproximac?a?o . . . . . . . . . . . . . . . . 114
5.2.2 Aproximac?a?o por Simplexes . . . . . . . . . . . . . . . . . . . . . . . . 117
5.2.2.1 Variac?a?o da Capacidade de Compressa?o de Ga?s . . . . . . . . . 117
5.2.2.2 Variac?a?o da Qualidade da Aproximac?a?o . . . . . . . . . . . . . . . 120
5.2.3 Ana?lise Geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
5.3 SUMA?RIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
6 SUMA?RIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
Refere?ncias Bibliogra?ficas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
APE?NDICE A -- Ape?ndice . . . . . . . . . . . . . . . . . . . . . . . . . . . 137



31

1 INTRODUC?A?O

Embora os recentes avanc?os tecnolo?gicos tenham ampliado a di-
versidade de alternativas energe?ticas dispon??veis na sociedade, o petro?-
leo ainda e? a principal fonte de energia do mundo moderno. Ale?m de
combust??vel, esse o?leo de origem fo?ssil tambe?m esta? presente em diver-
sos produtos incorporados no nosso dia-a-dia, como fertilizantes, tintas,
borrachas, ale?m dos derivados do petro?leo, os quais substituem uma
grande quantidade de mate?rias-primas. Ainda ha? uma grande quanti-
dade deste recurso dispon??vel no planeta, entretanto, por ser uma fonte
de energia na?o-renova?vel, ele se esgotara?. Como conseque?ncia, a? medida
que estes hidrocarbonetos sa?o extra??dos, mais caro e dif??cil se torna seu
processo de extrac?a?o. Ale?m disto, a demanda crescente por petro?leo
e a competitividade dos mercados levam as indu?strias a inovarem em
tecnologia com o objetivo de otimizar o processo de produc?a?o e reduzir
os custos operacionais.

O ra?pido desenvolvimento das tecnologias de hardware e soft-
ware, como as tecnologias para medic?a?o digital e para processamento
de dados, tem possibilitado a aplicac?a?o de te?cnicas avanc?adas de auto-
mac?a?o no processo de produc?a?o dos poc?os. Com a integrac?a?o destas
tecnologias com os sistemas de informac?a?o digital, as operac?o?es tem se
tornado mais flex??veis, resultando em custos operacionais reduzidos e
em um aumento do fator de recuperac?a?o dos reservato?rios (BOOTH-
ROYD, 1994; YETEN et al., 2004; CAMPONOGARA et al., 2010;
CAMPOS et al., 2010).

Essas inovac?o?es e as demandas pelo uso eficiente das novas tec-
nologias deram origem ao conceito de Campos Inteligentes, tambe?m
conhecidos por Smart Fields, Intelligent Fields, e, na Petrobras, pelo
nome de Gerenciamento Integrado de Operac?o?es (GIOp), cuja ideia e?
integrar sistemas de informac?a?o digital com as mais modernas te?cnicas
de perfurac?a?o, s??smicas e de reservato?rio para melhorar a gesta?o das
operac?o?es nos campos de petro?leo. Entretanto, os desafios cient??ficos
e tecnolo?gicos para tornar a tecnologia de campos inteligentes em re-
alidade sa?o inu?meros. Para isto, modelos e algoritmos que utilizem a
informac?a?o u?til provida pelos sistemas de informac?a?o digitais e pelas
ferramentas de simulac?a?o devem ser desenvolvidos com o intuito de
trazer benef??cios na otimizac?a?o da produc?a?o.

Ao longo da operac?a?o dia?ria nos sistemas de produc?a?o de petro?-
leo, muitas deciso?es precisam ser tomadas com o objetivo de maximizar
a produc?a?o. Dentre essas deciso?es esta?o a escolha da configurac?a?o das



32

va?lvulas, quais poc?os estara?o ativos e para onde sera? direcionada a pro-
duc?a?o de cada poc?o, respeitando-se as restric?o?es operacionais como a
capacidade de processamento nas instalac?o?es da superf??cie, disponibili-
dade de ga?s para injec?a?o, restric?o?es de fluxo e pressa?o nas tubulac?o?es,
dentre outras. Enta?o, para se obter uma operac?a?o dia?ria o?tima, as
interac?o?es entre reservato?rio, poc?os e instalac?o?es da superf??cie devem
ser consideradas simultaneamente. Atualmente, a operac?a?o de campos
de petro?leo em alto-mar e? geralmente baseada em ana?lises de sensibi-
lidade com o uso de ferramentas de simulac?a?o e heur??sticas. Embora
estes me?todos otimizem a produc?a?o de o?leo para casos particulares, eles
na?o necessariamente determinam o modo de operac?a?o que maximiza a
produc?a?o de petro?leo dia?ria (KOSMIDIS; PERKINS; PISTIKOPOU-
LOS, 2005).

Ha? diversos trabalhos na literatura que utilizam a programac?a?o
matema?tica para maximizar a produc?a?o de campos de petro?leo, com
atenc?a?o especial voltada para campos em alto-mar, onde a complexi-
dade e? geralmente maior (BUITRAGO; RODRI?GUEZ; ESPIN, 1996;

ALARCO?N; TORRES; GO?MEZ, 2002; KOSMIDIS; PERKINS; PIS-
TIKOPOULOS, 2005; CAMPONOGARA; CONTO, 2009; MISENER;
GOUNARIS; FLOUDAS, 2009). Entretanto, um aspecto que ainda
possui desafios cient??ficos e? a representac?a?o das restric?o?es de pressa?o
nas tubulac?o?es que conectam poc?os, manifolds e separadores. Sem o
tratamento expl??cito destas restric?o?es, os planos de produc?a?o podem
na?o ser via?veis operacionalmente. Este trabalho propo?e algoritmos e
modelos com o objetivo de tornar a estrate?gia de produc?a?o dia?ria dos
campos de petro?leo eficiente.

1.1 CONTRIBUIC?A?O

Quando se considera a influe?ncia da variac?a?o de pressa?o nos ma-
nifolds e da injec?a?o de ga?s pressurizado nos poc?os, as curvas de produ-
c?a?o dos poc?os podem ser caracterizadas como func?o?es na?o-convexas com
dom??nios bidimensionais. As curvas de queda de pressa?o nas tubulac?o?es
sa?o func?o?es das vazo?es de ga?s, o?leo e a?gua nas tubulac?o?es, caracteri-
zando curvas na?o-lineares com dom??nios tridimensionais. Investiga-se
enta?o a modelagem de func?o?es na?o convexas que, em geral, levam a
problemas NP-Dif??ceis, i.e., muito dif??ceis de se resolver, em especial,
quando tais func?o?es sa?o multivariadas.

Neste trabalho, apresentamos um modelo em programac?a?o na?o-
linear inteira-mista para o problema de alocac?a?o de ga?s sob restric?o?es



33

de alinhamento entre poc?os e manifolds e restric?o?es de pressa?o. A com-
plexidade deste problema reside nas deciso?es discretas do alinhamento
entre poc?os e manifolds e nas na?o-linearidades presentes nas curvas de
produc?a?o dos poc?os e de queda de pressa?o das tubulac?o?es. As na?o-
linearidades deste problema surgem nas curvas de produc?a?o dos poc?os
e nas curvas de queda de pressa?o das tubulac?o?es.

Aqui, sa?o propostas diversas reformulac?o?es lineares inteiras-mistas
para o problema de alocac?a?o de ga?s com base nos diversos modelos
apresentados em (VIELMA; AHMED; NEMHAUSER, 2010) para re-
presentar func?o?es lineares por partes multidimensionais. Em seguida,
o desempenho computacional dos modelos desenvolvidos e? comparado
para aproximac?o?es com representac?o?es por triangulac?o?es e por hiper-
cubos.

Podemos sumarizar as principais contribuic?o?es deste trabalho
como segue:

• Formulac?a?o em Programac?a?o Na?o-Linear Inteira-Mista (MINLP)
do problema de alocac?a?o de ga?s sob restric?o?es de alinhamento
entre poc?os e manifolds e restric?o?es de pressa?o;

• Sete reformulac?o?es do problema com Programac?a?o Linear Inteira-
Mista (MILP), obtidas com o uso das ferramentas de linearizac?a?o
por partes multidimensional e

• Ana?lise de desempenho das formulac?o?es MILP desenvolvidas para
duas aproximac?o?es diferentes.

1.2 ESTRUTURA DA DISSERTAC?A?O

Esta dissertac?a?o esta? dividida em seis cap??tulos e um ape?ndice.
No Cap??tulo 2 apresentamos com mais detalhes o cena?rio do problema
na o?tica da engenharia de petro?leo, revisando conceitos sobre elevac?a?o
artificial por injec?a?o cont??nua de ga?s e restric?o?es de pressa?o, conside-
rando o estado da arte dos trabalhos desenvolvidos nesta a?rea. Ainda
neste cap??tulo, e? apresentada uma formulac?a?o matema?tica para o pro-
blema resolvido nesta dissertac?a?o em programac?a?o na?o-linear inteira-
mista.

O Cap??tulo 3 apresenta os modelos lineares inteiros-mistos para
representar func?o?es lineares por partes multidimensionais, os quais ser-
vem como fundamentac?a?o teo?rica para o trabalho desenvolvido nesta
dissertac?a?o.



34

O Cap??tulo 4 apresenta as reformulac?o?es lineares por partes do
problema modelado como um programa na?o linear inteiro-misto exibido
no Cap??tulo 2 com base nos modelos apresentados no Cap??tulo 3.

O Cap??tulo 5 apresenta o modelo do sistema de produc?a?o que foi
utilizado como insta?ncia para o problema resolvido nesta dissertac?a?o
e uma ana?lise computacional dos formulac?o?es lineares inteiras-mistas
desenvolvidas no Cap??tulo 4 para aproximac?o?es com hipercubos e com
simplexes.

O Cap??tulo 6 apresenta o suma?rio da dissertac?a?o, sintetizando
os resultados alcanc?ados e as perspectivas de trabalhos futuros.

Por fim, o Ape?ndice A apresenta conceitos e ilustrac?o?es que po-
dem auxiliar no entendimento dos conceitos apresentados neste traba-
lho.



35

2 DEFINIC?A?O DO PROBLEMA

Um sistema integrado t??pico de produc?a?o de ga?s e o?leo consiste
em: (i) o reservato?rio, que e? definido como uma regia?o da superf??cie
que conte?m o?leo, ga?s e a?gua saturados no espac?o poroso de uma rocha
permea?vel; (ii) os poc?os produtores, que transferem os fluidos do reser-
vato?rio para manifolds ; (iii) o manifold, onde as vazo?es que ve?m dos
poc?os sa?o misturadas; (iv) as tubulac?o?es que conectam os manifolds a?s
instalac?o?es na superf??cie; (v) os separadores, os quais sa?o os sistemas
de tratamento prima?rio da produc?a?o, onde os fluidos sa?o separados em
o?leo, ga?s e a?gua; e (vi) compressores para disponibilizar ga?s para poc?os
com elevac?a?o artificial por injec?a?o de ga?s. A Figura 1 ilustra um sis-
tema de produc?a?o t??pico onde ha? o reservato?rio, cinco poc?os produtores
escoando o?leo, ga?s e a?gua para os concentradores, chamados manifolds.
Entre os poc?os e os manifolds, ha? va?lvulas de alinhamento que sa?o res-
ponsa?veis por direcionar a produc?a?o de um poc?o para um manifold. As
va?lvulas de alinhamento direcionam a produc?a?o de um poc?o para um
determinado manifold. Em seguida, a produc?a?o chega a um separador
que separa as fases e direciona o ga?s para um sistema de tratamento e
compressa?o de ga?s, o qual conte?m um ou mais compressores. Parte do
ga?s pressurizado sera? exportado e parte sera? injetado nos poc?os com
elevac?a?o artificial. A vaza?o de ga?s pressurizado que e? injetado em cada
poc?o e? regulada pelas va?lvulas, denominadas chokes de injec?a?o. A a?gua
e? geralmente enviada para um estac?a?o de tratamento e o o?leo enviado
para exportac?a?o.

A produc?a?o de petro?leo e? geralmente limitada por condic?o?es f??-
sicas do reservato?rio, poc?os e pela capacidade de processamento e ar-
mazenamento de fluidos nas instalac?o?es da superf??cie tais como capa-
cidade de compressa?o dos compressores, limites operacionais de vaza?o
dos fluidos nos poc?os, restric?o?es de pressa?o entre os poc?os, manifolds
e separadores, dentre outros. Ao longo da operac?a?o dia?ria, essas limi-
tac?o?es devem ser consideradas no conjunto de deciso?es tomadas pelos
operadores humanos a fim de maximizar a produc?a?o de o?leo. Dentre
essas deciso?es esta?o a escolha da configurac?a?o das va?lvulas que regu-
lam as vazo?es, a escolha dos poc?os que produzira?o em um determinado
momento, o alinhamento entre poc?os, manifolds e separadores.

Atualmente, a operac?a?o dia?ria de poc?os em alto-mar e? geralmente
baseada em ana?lises de sensibilidade, usando ferramentas de simulac?a?o
e heur??sticas. Embora estes me?todos otimizem a produc?a?o de o?leo para
casos particulares, eles na?o necessariamente levam a? utilizac?a?o de um



36

Oil
Separated

Oil

SeparatedGas
to Compressor

Compressed
Gas to Wells

Oil/Gas
FromWells

Separated
Oil

SeparatedGas
to Compressor

Compressed
Gas to Wells

Oil/Gas
FromWells

Óleo-Água

Reservatório

Manifolds

     
Gás Separado

Gás Pressurizado para
Injetar nos Poços

Poço A Poço B Poço C Poço D Poço E

Óleo + Gás + Água

Válvulas de Alinhamento

C h o k e s d e I n j e ç ã o

d e G á s

Compressor

Sistema de tratamento de 
água e exportação de óleo

Sistema de tratamento e separação de gás

Figura 1: Sistema Simplificado de Produc?a?o com Alinhamento e Injec?a?o
de Ga?s.

modo de operac?a?o que maximiza a produc?a?o dia?ria. Este trabalho tem
como objetivo desenvolver uma ferramenta com base na programac?a?o
matema?tica de suporte a? decisa?o para um campo de petro?leo que e?
composto por um conjunto de poc?os produtores, manifolds, separadores
e tubulac?o?es que transportam os fluidos neste sistema.

Neste cap??tulo, sa?o revisados os conceitos da engenharia de pe-
tro?leo necessa?rios para o entendimento do problema. Apresenta-se em
seguida os trabalhos dispon??veis na literatura relacionados e e? apresen-
tada uma formulac?a?o matema?tica para o problema a ser tratado nesta
dissertac?a?o.

2.1 ELEVAC?A?O ARTIFICIAL POR INJEC?A?O CONTI?NUA DE GA?S

A produc?a?o de um poc?o de petro?leo em alto-mar e? determinada
pela diferenc?a de pressa?o entre a va?lvula localizada na cabec?a do poc?o e



37

o reservato?rio. Quando a pressa?o no reservato?rio e? suficientemente ele-
vada, os fluidos sa?o capazes de alcanc?ar a superf??cie naturalmente. Po-
c?os com esta caracter??stica sa?o chamados de poc?os surgentes. Quando
a pressa?o do reservato?rio e? baixa para elevar os fluidos naturalmente
ou quando a produc?a?o do poc?o esta? abaixo do ideal, ha? a necessidade
da utilizac?a?o de me?todos de elevac?a?o artificial.

Um me?todo de elevac?a?o artificial bastante usado nos campos de
petro?leo em alto-mar e? a elevac?a?o por injec?a?o cont??nua de ga?s (gas-lift ),
no qual injeta-se ga?s pressurizado no fundo da coluna de produc?a?o do
poc?o de petro?leo com o objetivo de aumentar a produc?a?o. A Figura 2
ilustra o me?todo de elevac?a?o artificial por injec?a?o cont??nua de ga?s.

R eservatório
s

Gás + Óleo + Água

Gás de Injeção Choke de
Injeção de Gás

Compressor

Válvula de
Gas-Lift

Manifolds
Separador

Choke de Produção

Coluna de Produção
Anular

Revestimento

Figura 2: Injec?a?o Cont??nua de Ga?s.

A produc?a?o dos fluidos da formac?a?o e? realizada utilizando-se uma
tubulac?a?o chamada de coluna de produc?a?o. O ga?s e? injetado utilizando-
se o espac?o anular formado entre o revestimento e a coluna de produc?a?o.
Ha? uma va?lvula na superf??cie, denominada choke de injec?a?o de ga?s, que
controla a injec?a?o de ga?s pressurizado. O ga?s pressurizado proveniente
do compressor chega pelo anular (annulus ) do poc?o e e? injetado atrave?s
da va?lvula de gas-lift. A coluna de produc?a?o conduz o o?leo, ga?s e a?gua
provenientes do reservato?rio ate? o choke de produc?a?o. A injec?a?o do ga?s
pressurizado na coluna de produc?a?o produz dois efeitos: reduc?a?o da
pressa?o hidrosta?tica do poc?o, reduzindo a densidade me?dia do fluido,
e aumento do atrito devido ao aumento do volume ocupado pelo ga?s
na tubulac?a?o. Quando o ga?s e? misturado com o o?leo, o peso da coluna
de produc?a?o e? reduzido, resultando na reduc?a?o da pressa?o de fundo
(Pw f ). A diferenc?a entre a pressa?o do reservato?rio (PR) e a pressa?o



38

de fundo (Pw f ) induz a vaza?o de fluidos do reservato?rio para o poc?o.
Como a pressa?o hidrosta?tica de sa??da e? reduzida na injec?a?o do ga?s
pressurizado, a diferenc?a de pressa?o entre o reservato?rio e o fundo do
poc?o e? elevada, possibilitando que os fluidos do reservato?rio entrem no
poc?o a uma vaza?o maior. O bom resultado que se obte?m com a injec?a?o
de ga?s diminui a? medida que a quantidade de ga?s injetada ultrapassa
um ponto o?timo, uma vez que a injec?a?o do ga?s tambe?m aumenta o
atrito, elevando a pressa?o de sa??da e reduzindo a vaza?o.

Para determinar a taxa o?tima de injec?a?o de ga?s de injec?a?o, uma
pra?tica usual e? alocar o ga?s a um poc?o de acordo com a sua Curva
de Desempenho do Poc?o, do ingle?s Well Performance Curve (WPC)
(MAYHILL, 1974; NISHIKIORI et al., 1995). A WPC e? uma curva

Figura 3: Curva de Desempenho do Poc?o.

que descreve a vaza?o de fluidos obtida em func?a?o da taxa de injec?a?o de
ga?s alocada a um poc?o. A Figura 3 ilustra uma WPC t??pica, onde ha?
uma regia?o de instabilidade, uma regia?o de estabilidade e uma regia?o
de vaza?o de injec?a?o o?tima de ga?s pressurizado. Quando a capacidade
de compressa?o de ga?s e? ilimitada, a taxa de injec?a?o de ga?s o?tima para
cada poc?o e? o ponto ma?ximo na curva de desempenho. Entretanto, a
capacidade de compressa?o dos compressores em um campo de petro?leo
pode ser menor que a soma das taxas o?timas de injec?a?o para todos
os poc?os. O problema de otimizac?a?o de alocac?a?o de ga?s de injec?a?o
consiste em encontrar as taxas de ga?s de injec?a?o para cada poc?o que



39

maximizam o benef??cio com a produc?a?o do campo sujeito a?s restric?o?es
de capacidade de compressa?o de ga?s e a?s demais restric?o?es operacionais.

2.2 TRABALHOS RELACIONADOS: DISTRIBUIC?A?O DE GA?S DE
INJEC?A?O SUJEITO A RESTRIC?O?ES DE PRESSA?O

Os me?todos dispon??veis na literatura para a otimizac?a?o da pro-
duc?a?o em campos de petro?leo podem ser divididos em tre?s categorias:
(i) ana?lise de sensibilidade com o uso de ferramentas de simulac?a?o,
(ii) me?todos heur??sticos e (iii) me?todos de programac?a?o matema?tica.
Ha? diversos trabalhos dispon??veis na literatura que utilizam a pro-
gramac?a?o matema?tica como ferramenta para otimizar a produc?a?o de
campos de petro?leo em alto-mar (BUITRAGO; RODRI?GUEZ; ESPIN,

1996; ALARCO?N; TORRES; GO?MEZ, 2002; BOGAERT et al., 2004;
KOSMIDIS; PERKINS; PISTIKOPOULOS, 2004, 2005; CAMPONO-
GARA; CONTO, 2009; MISENER; GOUNARIS; FLOUDAS, 2009).
Neste trabalho, o me?todo para resoluc?a?o do problema de otimizac?a?o da
produc?a?o sera? um me?todo de programac?a?o matema?tica.

Nesta sec?a?o, sera? apresentada uma revisa?o da literatura para
o problema de alocac?a?o de ga?s de injec?a?o e, em seguida, para uma
extensa?o deste problema em que se incorpora as restric?o?es de pressa?o
para o problema sob a o?tica da programac?a?o matema?tica.

2.2.1 Alocac?a?o de Ga?s de Injec?a?o

Redden, Sherman e Blann (1974) desenvolveram um procedi-
mento anal??tico para encontrar a distribuic?a?o de ga?s com melhor bene-
f??cio econo?mico. O procedimento utiliza informac?o?es do poc?o e realiza
ca?lculos sobre o comportamento da vaza?o multifa?sica nas tubulac?o?es
para avaliar a resposta na vaza?o do poc?o a uma alterac?a?o na taxa de
injec?a?o de ga?s. A distribuic?a?o o?tima do ga?s dispon??vel foi calculada com
base na contribuic?a?o de cada poc?o para o benef??cio total do sistema.
Esta soluc?a?o foi utilizada em um campo de petro?leo na Venezuela com
1500 poc?os com elevac?a?o artificial por injec?a?o cont??nua de ga?s e no
Texas em 150 poc?os.

Go?mez (1974) propuseram um me?todo para ajustar os pontos a
fim de encontrar uma aproximac?a?o polinomial de segunda ordem para a
curva de desempenho do poc?o. Em seguida, o problema de otimizac?a?o
foi resolvido com o uso de Programac?a?o Quadra?tica Sucessiva (PQS).



40

Um dos primeiros trabalhos dispon??veis na literatura para o pro-
blema de alocac?a?o de ga?s em poc?os operados com elevac?a?o artificial com
base na curva de desempenho do poc?o foi proposto por Kanu, Mach e
Brown (1981). O me?todo desenvolvido, denominado equal-slope, con-
verge para uma soluc?a?o em que a inclinac?a?o das curvas de desempenho
dos poc?os deve ser igual, ou seja, um aumento infinitesimal na taxa de
injec?a?o de ga?s produziria o mesmo resultado para todos os poc?os.

Nishikiori et al. (1995) propuseram uma extensa?o do me?todo
equal-slope com base no algoritmo otimizac?a?o na?o-linear quasi-newton.
Este me?todo possui a necessidade de uma estimativa inicial fact??vel
para que haja converge?ncia do algoritmo. Em certos casos, ter uma
boa estimativa inicial configura um problema considera?vel. Tanto o
me?todo equal-slope quanto o me?todo quasi-newton usam informac?a?o
do gradiente da func?a?o na escolha da direc?a?o de busca, podendo ficar
presos a o?timos locais caso a func?a?o seja na?o-convexa. Estes me?todos
baseados na inclinac?a?o das WPC’s na?o podem ser diretamente aplicados
em poc?os que necessitam de uma vaza?o m??nima de ga?s para produzir,
pois as WPC’s dos poc?os, neste caso, na?o sa?o co?ncavas.

Buitrago, Rodr??guez e Espin (1996) propuseram um me?todo para
resolver o problema de alocac?a?o de ga?s que utiliza um algoritmo gene?-
tico e um procedimento estoca?stico para calcular a regia?o de descenso no
algoritmo de busca. A explorac?a?o do espac?o de soluc?o?es fact??veis pode
ser intrata?vel computacionalmente caso o problema possua muitas res-
tric?o?es, ale?m de tambe?m na?o haver garantia de otimalidade global pela
natureza probabil??stica do me?todo. De acordo com os resultados apre-
sentados neste trabalho, este me?todo na?o tem bons resultados quando
se trata de problemas com muitas restric?o?es, produzindo melhores re-
sultados em problemas irrestritos ou com poucas restric?o?es.

Fang e Lo (1996) desenvolveram um me?todo para encontrar as
taxas o?timas de injec?a?o para o problema de alocac?a?o de ga?s sob restri-
c?o?es nas instalac?o?es de superf??cie. As curvas de desempenho dos poc?os
foram aproximadas por um conjunto finito de pontos atrave?s de uma
func?a?o linear por partes e o problema foi solucionado com programa-
c?a?o linear. Como o problema foi modelado como um programa linear,
algumas varia?veis discretas do problema foram consideradas cont??nuas,
podendo resultar em soluc?o?es infact??veis. Esta limitac?a?o foi solucionada
com o uso de programac?a?o inteira-mista em um trabalho apresentado
posteriormente em (WANG, 2003).

Vazquez et al. (2001) abordaram o fato de algumas soluc?o?es pro-
postas para o problema de a otimizac?a?o da produc?a?o de o?leo terem
mu?ltiplos o?timos locais. Os solvers podem ficar presos em um o?timo



41

local que e? inferior ao o?timo global. Foi usado um solver h??brido que
consiste de um algoritmo gene?tico e uma busca heur??stica, levando a
resultados pro?ximos ao o?timo global.

Alarco?n, Torres e Go?mez (2002) desenvolveram uma extensa?o

do me?todo proposto em (GO?MEZ, 1974) com a inclusa?o de um termo
logar??tmico. Os resultados obtidos apontaram que o ajuste da curva
com este termo e? melhor do que o apresentado no trabalho anterior.

Camponogara e Nakashima (2006) solucionaram o problema de
otimizac?a?o da alocac?a?o de ga?s com o uso de programac?a?o dina?mica sob
uma capacidade de compressa?o limitada do compressor. A ativac?a?o dos
poc?os foi feita com a introduc?a?o de restric?o?es de precede?ncia. Uma van-
tagem da utilizac?a?o da programac?a?o dina?mica e? que, com os resultados
intermedia?rios computados, encontrou-se a soluc?a?o para uma fam??lia
de problemas em toda a faixa dispon??vel de ga?s de injec?a?o.

Camponogara e Conto (2009) resolveram o problema na?o linear
inteiro-misto de distribuic?a?o de ga?s, considerando os limites de inje-
c?a?o para cada poc?os e as restric?o?es de precede?ncia. Eles propuseram
uma formulac?a?o linear inteira-mista do problema com a linearizac?a?o das
func?o?es na?o lineares, o que possibilitou o uso de algoritmos de progra-
mac?a?o inteira. O problema foi solucionado com o uso de um algoritmo
cut-and-branch com cortes desenvolvidos com base em coberturas ba-
seadas no problema da mochila (knapscak ). Os autores afirmaram que
os resultados nume?ricos mostraram que o nu?mero de no?s explorados na
a?rvore de busca foi reduzido depois da inserc?a?o dos cortes.

Misener, Gounaris e Floudas (2009) consideraram o problema de
otimizar a distribuic?a?o de uma quantidade limitada de ga?s de injec?a?o
para poc?os em um campo de petro?leo com o uso de te?cnicas de linea-
rizac?a?o por partes. Eles investigaram quatro diferentes abordagens de
linearizac?a?o e comparam os resultados quanto a? eficie?ncia computacio-
nal.

Camponogara et al. (2010) desenvolveram um me?todo que es-
tima a WPC por meio de medic?o?es da pressa?o de fundo do poc?o e com
base na disponibilidade de vaza?o de ga?s fornecido pelas estac?o?es de
compressa?o para o manifold de gas-lift. Eles desenvolveram um algo-
ritmo de programac?a?o linear inteira-mista para solucionar o problema
de alocac?a?o de ga?s com base nas WPC’s e validaram os resultados em
um simulador de escoamento multifa?sico denominado OLGA c©.

Codas e Camponogara (2012) desenvolveram duas formulac?o?es
lineares inteiras-mistas para o problema de alocac?a?o de ga?s na?o-linear
inteiro-misto. A primeira (compacta) foi obtida com uma aproxima-
c?a?o linear por partes das curvas na?o-lineares, com o usa de varia?veis



42

bina?rias para representar a linearizac?a?o e as deciso?es de alinhamento.
A segunda formulac?a?o (integrada) combina deciso?es de linearizac?a?o e
alinhamento com o uso de uma u?nica varia?vel bina?ria. A estrutura de
ambas formulac?o?es foi explorada para desenvolver cortes de cobertura
estendidos. Os resultados mostraram que a gerac?a?o de planos de cortes
com o uso da formulac?a?o integrada torna esta formulac?a?o mais eficiente
que a compacta, embora possua mais varia?veis.

2.2.2 Restric?o?es de Pressa?o

Os trabalhos discutidos na sec?a?o anterior que sa?o baseados nas
WPC’s dos poc?os assumem que estas sa?o independentes para cada poc?o.
Isto e? va?lido grande parte dos sistemas de produc?a?o de petro?leo em
alto-mar, pois, nestes casos, o manifold de produc?a?o esta? localizado na
plataforma de produc?a?o. Como a tubulac?a?o que conecta o manifold de
produc?a?o e o separador de produc?a?o, nesta situac?a?o, e? relativamente
curta, a queda de pressa?o pode ser considerada desprez??vel e, portanto,
a pressa?o no manifold e? considerada constante. Entretanto, com a
introduc?a?o de novas tecnologias de explorac?a?o submarinha nos sistemas
de produc?a?o de petro?leo modernos, os poc?os que esta?o distantes da
plataforma de produc?a?o escoam sua produc?a?o a? plataforma de produc?a?o
atrave?s de uma tubulac?a?o comum.

Devido a? longa dista?ncia das tubulac?o?es compartilhadas, a queda
de pressa?o nessas tubulac?o?es pode ser grande, variando em func?a?o do
volume dos fluidos em cada tubulac?a?o. Portanto, ajustar a produc?a?o de
um poc?o mudando a taxa de injec?a?o de ga?s pressurizado ou a abertura
da va?lvula de produc?a?o afetara? os outros poc?os que compartilham a
mesma tubulac?a?o para enviar os fluidos para a plataforma. A Figura 4
ilustra a vaza?o de l??quido de um poc?o que na?o produz a?gua em func?a?o
da injec?a?o de ga?s e da variac?a?o da pressa?o no manifold. Neste caso,
modelos que utilizam as WPC’s dos poc?os na?o podem ser aplicados di-
retamente ao problema de alocac?a?o de ga?s de injec?a?o devido a? variac?a?o
da pressa?o nos manifolds de produc?a?o. Para se obter resultados mais
precisos, as func?o?es de queda de pressa?o nas tubulac?o?es que conectam
os poc?os, manifolds e separadores precisam ser incorporadas no modelo
de otimizac?a?o.

A presenc?a de mu?ltiplas fases na composic?a?o dos fluidos de uma
tubulac?a?o torna complexo o ca?lculo da queda de pressa?o, pois as pro-
priedades de cada fluido e as interac?o?es entre elas devem ser conside-
radas. Para contornar a complexidade, Beggs e Brill (1973) estudaram



43

0
0.5

1
1.5

2

x 10
5

300
400

500
600

700
800

0

50

100

150

200

250

300

350

400

Vazão de Líquido

Injeção de Gás
Pressão do Manifold

Figura 4: Curva de Produc?a?o do Poc?o.

as correlac?o?es entre a queda de pressa?o e a vaza?o dos fluidos em uma
tubulac?a?o. Tais correlac?o?es foram usadas posteriormente para aproxi-
mar a queda de pressa?o em uma tubulac?a?o como func?a?o das vazo?es dos
fluidos. A Figura 5 ilustra a queda de pressa?o em uma tubulac?a?o de 100
metros em func?a?o da vaza?o de ga?s e de l??quido. Os poc?os que enviam
os fluidos para esta tubulac?a?o possuem uma frac?a?o de a?gua, do ingle?s
Basic Sediments and Water (BSW) igual a 10.

Litvak e Darlow (1995) desenvolveram duas te?cnicas para repre-
sentac?a?o das equac?o?es de pressa?o em um sistema de produc?a?o: modelos
anal??ticos e tabelas com os breakpoints para a pressa?o. A primeira e?
bastante usada na engenharia de petro?leo para a simulac?a?o da vaza?o
nas tubulac?o?es dos poc?os, va?lvulas e instalac?o?es da superf??cie por ser
precisa em relac?a?o ao feno?meno f??sico real. A segunda te?cnica modela
a queda de pressa?o nas tubulac?o?es como func?a?o da pressa?o absoluta na
sa??da e das vazo?es de o?leo, ga?s e a?gua. A func?a?o original da queda de
pressa?o e? aproximada com um func?a?o linear por partes representada
em tabelas que mapeiam a queda de pressa?o associada com os break-
points de pressa?o de sa??da e as vazo?es de cada fase. Embora esta te?cnica
seja mais eficiente quanto ao tempo computacional, o uso de tabelas
demanda uma quantidade de memo?ria considera?vel e pode se tornar
invia?vel em redes de produc?a?o muito extensas.



44

2
4

6
8

10x 10
5

1000 2000 3000
4000 5000

6000 7000

50

100

150

200

250

300

350

400

450

500

550

Queda de Pressão

Vazão de Gás

Vazão de Líquido

Proporção de Água (BSW) = 10

Figura 5: Curva de Queda de Pressa?o.

Dutta-Roy e Kattapuram (1997) propuseram uma nova aborda-
gem para otimizac?a?o do problema de alocac?a?o de ga?s de injec?a?o usando
equalizac?a?o das presso?es com base na vaza?o multifa?sica das tubulac?o?es,
acoplado a? te?cnica de PQS para lidar com as restric?o?es na?o lineares do
problema de otimizac?a?o. A abordagem foi avaliada com ate? tre?s poc?os
ide?nticos compartilhando a mesma tubulac?a?o. Os resultados aponta-
ram que as taxas de injec?a?o o?timas para cada poc?o foram reduzidas a?
medida que o nu?mero de poc?os aumentou.

Todas as soluc?o?es discutidas ate? enta?o garantem apenas que um
o?timo local seja encontrado. Como os problemas formulados sa?o ge-
ralmente na?o-convexos, os algoritmos podem na?o encontrar a soluc?a?o
o?tima global. Stoisits et al. (1999) desenvolveram um algoritmo ge-
ne?tico para encontrar uma soluc?a?o pro?xima ao o?timo global para um
problema similar. Entretanto, na?o ha? garantias de se encontrar um
o?timo local ou o o?timo global. Ale?m disto, o algoritmo desenvolvido
na?o e? eficiente, pois a estrutura do problema na?o e? explorada durante
o me?todo de soluc?a?o.



45

Handley-Schachler, McKie e Quintero (2000) utilizaram Progra-
mac?a?o Linear Sucessiva (PLS) ao inve?s de PQS para resolver o problema
de otimizac?a?o com as restric?o?es de pressa?o. As quedas de pressa?o nas
tubulac?o?es foram modeladas usando-se equac?o?es na?o-lineares padro-
nizadas. Em cada iterac?a?o do algoritmo PLS, a queda de pressa?o e?
linearizada para cada poc?o. A curva de desempenho de cada poc?o foi
modelada como uma superf??cie linear por partes usando inequac?o?es li-
neares, similar ao que foi feito em (FANG; LO, 1996). De acordo com
o autor, isto reduziu o nu?mero de iterac?o?es necessa?rias pelo algoritmo
PLS.

Wang (2003) modelou o problema de alocac?a?o de ga?s conside-
rando as interac?o?es de fluxo na linhas compartilhadas pelos poc?os. Di-
versas formulac?o?es foram investigadas, dentre elas, uma formulac?a?o foi
sugerida pelo autor por ter suporte a fechamento e abertura dos poc?os
e por ser computacionalmente eficiente. O problema foi solucionado em
seguida com um algoritmo PQS.

Kosmidis, Perkins e Pistikopoulos (2004) propo?s uma formulac?a?o
inteira-mista para a operac?a?o dia?ria de um poc?o e a alocac?a?o de ga?s
para campos de petro?leo em alto mar considerando o comportamento
do reservato?rio, os fluidos multifa?sicos nas tubulac?o?es e as restric?o?es de
capacidade nas instalac?o?es da superf??cie. Com a inclusa?o da pressa?o
no modelo do campo de petro?leo, a vaza?o de um poc?o operado com
elevac?a?o por injec?a?o cont??nua de ga?s passa a depender da taxa de ga?s
injetado e da pressa?o no manifold de produc?a?o que coleta a produc?a?o
de va?rios poc?os que compartilham a tubulac?a?o que leva o fluido ate? o
separador na superf??cie. Por isto, os modelos dos poc?os foram aproxi-
mados com func?o?es lineares por partes e o problema foi reformulado em
um programa na?o linear inteiro-misto eficiente. Mais tarde, Kosmidis,
Perkins e Pistikopoulos (2005) modelaram o mesmo problema de alo-
cac?a?o de ga?s como um programa na?o linear inteiro-misto envolvendo
restric?o?es lo?gicas, aproximac?o?es lineares por partes para o modelo de
cada poc?o, restric?o?es de pressa?o e alinhamento entre poc?os, manifolds e
separadores. Eles ilustraram a aplicabilidade da abordagem de soluc?a?o
de proposta com um nu?mero de exemplos ilustrativos e os resultados
mostraram um aumento na produc?a?o de o?leo acima de 10 % quando
comparados com os me?todos tradicionais aplicados na maioria dos cam-
pos de petro?leo na pra?tica.

Gunnerud e Foss (2010) aproximaram as func?o?es de queda de
pressa?o nas tubulac?o?es que conectam os manifolds e os separadores com
uma func?a?o linear por partes que depende apenas das vazo?es de o?leo,
ga?s e a?gua, pois a pressa?o no separador, ou seja, na sa??da da tubulac?a?o,



46

foi considerada constante. Conjuntos Especialmente Ordenados Tipo
2 (SOS2) foram usados para representar a func?a?o linear por partes
multidimensional. As demais curvas na?o lineares foram aproximadas
por func?o?es lineares por partes e o problema foi reduzido a um programa
linear inteiro-misto. A soluc?a?o foi aplicada ao campo de petro?leo Troll
Oeste, que e? estruturado em um conjunto de clusters submarinhos.
A estrutura do campo e? adequada para aplicac?a?o de decomposic?o?es.
Portanto, foi desenvolvida uma decomposic?a?o Dantzig Wolfe para o
problema de otimizac?a?o, que depois foi solucionado com um algoritmo
de branch-and-price.

Com os resultados obtidos nesta dissertac?a?o, Silva, Codas e Cam-
ponogara (2012) desenvolveram um programa na?o linear inteiro misto
para o problema de alocac?a?o de ga?s com restric?o?es pressa?o e alinha-
mento entre poc?os e manifolds. Como este problema e? consideravel-
mente dif??cil de resolver, eles propuseram duas reformulac?o?es lineares
inteiras-mistas do problema com base nos modelos agregados de combi-
nac?a?o convexa padra?o (CC) e Logar??tmico (Log). Os resultados apre-
sentados pelos autores indicaram que o modelo logar??tmico e? mais efi-
ciente que o modelo padra?o por causa do nu?mero reduzido de varia?veis
e restric?o?es.

Apesar de existirem diversos trabalhos abordando o problema
de otimizac?a?o da produc?a?o em poc?os de petro?leo operados com eleva-
c?a?o artificial por injec?a?o cont??nua de ga?s, a representac?a?o das restric?o?es
de pressa?o nos sistemas de produc?a?o que utilizam as novas tecnolo-
gias submarinhas ainda e? um desafio. Alguns trabalhos mais recentes
te?m utilizado func?o?es lineares por partes para aproximar as func?o?es de
queda de pressa?o nas tubulac?o?es. Entretanto, na?o ha? dispon??vel na li-
teratura, uma ana?lise computacional dos diversos modelos que podem
ser usados para representar func?o?es lineares por partes com aplicac?a?o
na engenharia de petro?leo. Neste trabalho, busca-se incorporar as res-
tric?o?es de pressa?o aos modelos de sistemas de produc?a?o operados por
injec?a?o cont??nua de ga?s. Procura-se avaliar o desempenho computaci-
onal dos modelos de programac?a?o linear inteira-mista para representar
as func?o?es lineares por partes que aproximam as func?o?es de queda de
pressa?o nas tubulac?o?es, com o objetivo de identificar ferramentas capa-
zes de melhorar o desempenho das abordagens utilizadas nos campos
de petro?leo.



47

2.3 FORMULAC?A?O DO PROBLEMA

O problema de otimizac?a?o da produc?a?o dia?ria de um campo de
petro?leo com poc?os operando com injec?a?o cont??nua de ga?s tem como
objetivo determinar: (i) a condic?a?o operacional de cada poc?o (aberto
ou fechado); (ii) as conexo?es entre poc?os, manifolds e separadores que
compo?em o sistema; (iii) a vaza?o dos fluidos resultante de cada poc?o;
(iv) a pressa?o que cada manifold deve ser operado; (v) a quantidade
de ga?s de injec?a?o alocada para cada poc?o tal que o benef??cio dia?rio, ou
seja, o ganho com a venda de o?leo menos o custo do ga?s usado pelo
compressor para elevar os fluidos em um dia, seja maximizado.

O modelo tambe?m deve considerar as leis f??sicas e as restric?o?es
operacionais tais como: (i) balanc?o de massa ao longo das tubulac?o?es
na rede de produc?a?o; (ii) limites superior e inferior de produc?a?o para
cada poc?o; (iii) limites de separac?a?o de ga?s, o?leo e a?gua nas insta-
lac?o?es da superf??cie; (v) capacidade de tratamento de ga?s de injec?a?o
pelo compressor; (vi) relac?o?es de pressa?o entre os poc?os, manifolds e
separadores.

O problema de alocac?a?o de ga?s de injec?a?o a poc?os de petro?leo,
considerando o roteamento dos poc?os para os separadores e sujeito a
restric?o?es de ga?s e capacidade de processamento das unidades de se-
parac?a?o foi discutido em (CODAS; CAMPONOGARA, 2012). Com o
intuito de analisar modelos lineares por partes multidimensionais, este
trabalho propo?e uma extensa?o do trabalho pre?vio considerando tambe?m
as restric?o?es de pressa?o nas tubulac?o?es que conectam poc?os, manifolds
e separadores. O problema e? formulado como um programa na?o-linear



48

inteiro misto:

P : max f = ?
m?M

g(qm)? ?
n?N

c(qni ) (2.1a)

s.a. : ?
n?N

qni ? q
max
i (2.1b)

Para todo n ? N :
lnyn ? qni ? unyn (2.1c)

?
m?Mn

zn,m = yn (2.1d)

qn,m = qn,m(pm,qni )zn,m,?m ? Mn (2.1e)
ynqn,L ? ?

m?Mn
qn,m ? ynqn,U (2.1f)

qm = ?
n?Nm

qn,m ? qm,S,?m ? M (2.1g)

pm = pm,S + ?pm(qm),?m ? M (2.1h)
pm,min ? pm ? pm,max (2.1i)
yn ?{0,1},?n ? N (2.1j)
zn,m ?{0,1},?n ? N ,?m ? Mn (2.1k)

com as seguintes varia?veis:

• qni e? a taxa de ga?s de injec?a?o alocada ao poc?o n;

• yn e? 1 quando o poc?o n esta? produzindo, e 0 caso contra?rio;

• zn,m assume valor 1 se a produc?a?o do poc?o n e? direcionada ao
manifold m, e 0 caso contra?rio;

• qn,mh e? a vaza?o da fase h?H enviada do poc?o n para o manifold m,
e qn,m = (qn,mh : h ?H ) e? um vetor com as vazo?es de todas as fases.
A vaza?o de ga?s recebido pelo manifold m de produc?a?o e? a soma
da taxa de ga?s de injetado no poc?o n (Inj) e do ga?s proveniente
do reservato?rio (R): qn,mg = q

n,m
g,R + q

n,m
g,Inj;

• qm = ?
n?Nm

qn,m e? a vaza?o total recebida dos poc?os conectados ao

manifold m para todas as fases;

• pm e? a pressa?o do manifold m;

para?metros:



49

• N e? o nu?mero de poc?os de petro?leo, N ={1,...,N} e Nm ?N e? o
subconjunto de poc?os cuja produc?a?o pode ser enviada ao manifold
m;

• M e? o nu?mero de manifolds, M = {1,...,M} e Mn ? M e? o sub-
conjunto de manifolds que podem receber produc?a?o do poc?o n.
A produc?a?o de cada manifold e? direcionada para um u?nico sepa-
rador;

• H = {o, g, w} possui as vazo?es multifa?sicas: o?leo (o), ga?s (g) e
a?gua (w);

• qmaxi e? a capacidade de compressa?o dos compressores;

• ln e un sa?o limites na injec?a?o de ga?s para cada poc?o n;

• pm,S e? a pressa?o operacional do separador que recebe a produc?a?o
do manifold m;

• qn,L e qn,U sa?o os vetores com os limites inferiores e superiores
para a vaza?o do poc?o n em todas as fases h ? H ;

• qm,S e? a capacidade de processamento do separador conectado ao
manifold m;

• pm,min e? a pressa?o operacional m??nima do manifold m;

• pm,max e? a pressa?o operacional ma?xima do manifold m;

e func?o?es:

• f e? uma func?a?o composta pela func?a?o g que representa o benef??cio
econo?mico proveniente da produc?a?o dos poc?os, que e? concentrada
nos manifolds e pela func?a?o c, a qual representa o custo de injec?a?o
de ga?s nos poc?os. A func?a?o g possui na sua representac?a?o os custos
com a compressa?o de ga?s e tratamento da a?gua e os ganhos obtidos
com a produc?a?o de ga?s e o?leo. Qualquer outra func?a?o cont??nua
pode ser considerada, tal como a produc?a?o total de o?leo;

• qn,mh (p
m,qni ) e? a vaza?o da fase h enviada do poc?o n ao manifold

m, dado como uma func?a?o da pressa?o do manifold e da taxa de
ga?s injetado no poc?o n, com qn,m(pm,qni ) = (q

n,m
h (p

m,qni ) : h ? H )
sendo a func?a?o vetorial com as vazo?es de todas as fases;

• ?pm(qm) e? a func?a?o que representa a queda de pressa?o na tu-
bulac?a?o que conecta o manifold m ao separador que recebe sua
produc?a?o.



50

A capacidade de ga?s no compressor e os limites superior e inferior
na taxa de injec?a?o de ga?s para cada poc?o esta?o definidos nas restric?o?es
(2.1b) e (2.1c) respectivamente.

O alinhamento de poc?os para manifolds e? determinado pelas res-
tric?o?es (2.1d)-(2.1e) e garantem que cada poc?o enviara? sua produc?a?o
para apenas um manifold quando estiver ativo, ou seja, quando yn = 1.
Quando o poc?o n na?o estiver alinhado com o manifold m, ou seja,
zn,m = 0, a produc?a?o do poc?o n enviada ao manifold m e? nula e, caso
contra?rio, a produc?a?o do poc?o n que e? enviada ao manifold m e? limitada
pelas capacidades ma?ximas e m??nimas qn,U e qn,L respectivamente.

Os limites operacionais de produc?a?o dos poc?os, o balanc?o de
massa e os limites de separac?a?o para cada fase nas instalac?o?es da su-
perf??cie sa?o definidos nas restric?o?es (2.1f) e (2.1g), enquanto o balanc?o
de pressa?o entre os manifolds e separadores sa?o assegurados pelas res-
tric?o?es (2.1h) e (2.1i).

1

1 M

1 S Separadores

Manifolds

Poços

Compressor

Manifold de Injeção de Gás

N

Figura 6: Formulac?a?o da Rede de Produc?a?o



51

A formulac?a?o do problema e? ilustrada na Figura 6 para uma
rede de produc?a?o. A principais varia?veis de decisa?o do problema esta?o
ilustrada na cor verde, enquanto as demais varia?veis esta?o ilustradas
em azul. Os para?metros e limites operacionais do problema esta?o em
vermelho.

O problema de alocac?a?o de ga?s de injec?a?o com alinhamento
poc?o-manifold e? um problema de programac?a?o na?o-linear inteiro-misto
de complexidade computacional considera?vel, devido a?s caracter??sticas
na?o-lineares das func?o?es de vaza?o dos poc?os qn,m(pm,qni ), de queda de
pressa?o nas tubulac?o?es ?pm(qm) e a?s varia?veis discretas. Este problema
pode ser considerado NP-dif??cil, pois e? mais geral que o problema de
alocac?a?o de ga?s tratado em (CAMPONOGARA; NAKASHIMA, 2006),
ao qual o problema cla?ssico da mochila e? redut??vel em tempo e espac?o
polinomial.

2.4 SUMA?RIO

Neste cap??tulo foi apresentada a motivac?a?o e a definic?a?o do pro-
blema que e? abordado e solucionado nesta dissertac?a?o. Inicialmente, foi
feita uma breve apresentac?a?o de alguns conceitos ba?sicos da engenha-
ria de petro?leo necessa?rios ao entendimento do problema e uma revisa?o
sucinta sobre a elevac?a?o artificial por injec?a?o cont??nua de ga?s. Em se-
guida, foi feita uma revisa?o bibliogra?fica contendo diversos trabalhos
dispon??veis na literatura relacionados com o problema de alocac?a?o de
ga?s sujeito a restric?o?es de pressa?o. Por fim, o problema foi formulado
matematicamente como um programa na?o linear inteiro-misto.



52



53

3 MODELOS INTEIROS-MISTOS PARA FUNC?O?ES
LINEARES POR PARTES MULTIDIMENSIONAIS

Problemas de minimizac?a?o envolvendo func?o?es convexas podem
ser modelados como problemas de programac?a?o linear (LP) atrave?s
de te?cnicas de linearizac?a?o por partes e resolvidos de forma eficiente.
Quando a modelagem de problemas complexos envolve func?o?es na?o-
convexas, e? necessa?rio introduzir na?o-linearidades no modelo, o que
pode tornar o problema de otimizac?a?o NP-Dif??cil mesmo quando todas
as func?o?es sa?o uni-variadas. Estas na?o linearidades podem ser aproxi-
madas com func?o?es lineares por partes e com a introduc?a?o de varia?veis
bina?rias auxiliares e restric?o?es adicionais, que relacionam as varia?veis
cont??nuas do modelo com as varia?veis bina?rias auxiliares, ou ainda atra-
ve?s da construc?a?o de ramificac?o?es especializadas nas varia?veis cont??nuas
(KEHA; FARIAS JR; NEMHAUSER, 2004).

Problemas de otimizac?a?o envolvendo func?o?es lineares por partes
podem ser resolvidos com algoritmos especializados tais como o branch-
and-cut desenvolvido por Keha, FARIAS JR e Nemhauser (2004) sem
o uso de varia?veis bina?rias, ou os algoritmos propostos em (TOMLIN,
1988) e (FARIAS; JOHNSON; NEMHAUSER, 2001), que estendem
o conceito de conjuntos especialmente ordenados (SOS) para func?o?es
na?o-convexas multidimensionais e semi-cont??nuas, respectivamente, e
utilizam tais conjuntos em um me?todo de branch-and-bound. Estes
problemas que envolvem func?o?es lineares por partes tambe?m podem ser
modelados como programas inteiros-mistos e resolvidos com solvers de
propo?sito geral. A vantagem desta u?ltima abordagem esta? no emprego
da tecnologia dispon??vel no estado da arte dos solvers de Programac?a?o
Linear Inteira-Mista (MILP).

Modelos para func?o?es lineares por partes na?o-convexas te?m sido
amplamente estudados na literatura (SHERALI, 2001; JEROSLOW;
LOWE, 1984; LEE; WILSON, 2001), mas tais estudos concentram-se
nos casos em que as func?o?es sa?o uni-variadas ou separa?veis. Em al-
guns problemas em a?reas tais como economia, engenharia qu??mica e
engenharia de petro?leo, a modelagem de func?o?es multidimensionais ou
multivariadas e? inevita?vel. Em alguns casos, ha? como se converter uma
func?a?o multivariada em uma func?a?o separa?vel atrave?s de alguma mani-
pulac?a?o alge?brica, mas tal conversa?o pode ser indeseja?vel porque pode
resultar em uma formulac?a?o mais fraca ou com erros nume?ricos eleva-
dos. Vielma, Ahmed e Nemhauser (2010) estudaram diversos modelos
em MILP para representar func?o?es lineares por partes na?o convexas,



54

com atenc?a?o especial a?s func?o?es multidimensionais. Neste cap??tulo,
apresentaremos os modelos em MILP existentes na literatura para re-
presentar func?o?es lineares por partes na?o-convexas multidimensionais.

3.1 NOTAC?A?O

Seja f : D ? R uma func?a?o cont??nua definida sobre um dom??-
nio compacto D ? Rd , onde um conjunto compacto, em espac?os com
dimensa?o finita, e? um conjunto fechado que e? limitado. De acordo
com Vielma, Ahmed e Nemhauser (2010), f e? uma func?a?o linear por
partes se, e somente se, existe uma fam??lia de politopos P, tal que,
?P?P P = D , {mP}P?P ?Rd e {cP}P?P , tal que:

f (x) :=
{

m?Px + cP, x ? P,?P ? P
}

(3.1)

Seja V (P) o conjunto de ve?rtices do politopo P e V (P) =
?P?PV (P) o conjunto de todos os ve?rtices do dom??nio.

3.1.1 Exemplo com Dom??nio Unidimensional

Nesta sec?a?o, apresentamos uma func?a?o linear por partes com
dom??nio unidimensional, representada na Figura 7, com o objetivo de
ilustrar o conceito destas func?o?es apresentado na Equac?a?o (3.1) e para
explicitar os modelos apresentados neste cap??tulo para o caso unidi-
mensional.

Esta func?a?o possui dom??nio unidimensional D = [0,4], dividido
em uma fam??lia de politopos P = {P1,P2,P3,P4}, onde P1 = [0,1], P2 =
[1,2], P3 = [2,3], P4 = [3,4], V (P1) = {0,1}, V (P2) = {1,2}, V (P3) = {2,3}
e V (P4) = {3,4}, com os pontos do gra?fico G = {(x, f (x)) : x ? D} sendo
{(0,8),(1,28),(2,14),(3,25),(4,21)}.

3.1.2 Exemplo com Dom??nio Bidimensional

As formulac?o?es MILP das func?o?es lineares por partes deste cap??-
tulo sera?o explicitadas para o caso bidimensional com uma func?a?o linear

por partes que aproxima a func?a?o f (x,y) = e?y + e?x
2
?x2 + xy?2y ilus-

trada na Figura 8.
O dom??nio desta func?a?o D = [?2,2]2 e? uma triangulac?a?o J1

(Union Jack ), particionada em um conjunto de politopos P = {P1,P2,



55

Figura 7: Func?a?o Linear por Partes Na?o-convexa com Dom??nio Unidi-
mensional.

...,P32} e um conjunto de ve?rtices para cada politopo V (P1) ={(?2,?2),
(?2,?1), (?1,?1)}, V (P2) ={(?2,?1),(?1,?1),(?2,0)},..., V (P32) =
{(2,?1),(1,?1), (2,?2)} conforme ilustrado na Figura 9. Nesta figura,
os tria?ngulos do dom??nio sa?o definidos a partir de pontos centrais lo-
calizados nas coordenadas ??mpares do dom??nio, ou seja, nos pontos
(?1,?1),(?1,1),(1,?1) e (1,1). Em torno deste pontos centrais, sa?o
criados quatro quadrados que, mais tarde, sa?o particionados em tria?n-
gulos, os quais representam os politopos do dom??nio da func?a?o. Nesta
figura, os ve?rtices foram dispostos de forma ordenada de acordo com
o tria?ngulo. Esta ordenac?a?o e? usada mais tarde pelo modelo Incre-
mental, o qual sera? apresentado neste cap??tulo. A triangulac?a?o J1 e?
definida formalmente no Ape?ndice A.1 e uma heur??stica de ordenac?a?o
dos tria?ngulos e ve?rtices e? apresentada no Ape?ndice A.2.

3.2 MODELOS DE COMBINAC?A?O CONVEXA DESAGREGADA

As formulac?o?es desta sec?a?o dividem o dom??nio da func?a?o em um
conjunto de politopos P. Cada politopo P ? P possui um conjunto
de ve?rtices V (P) e, para cada ve?rtice v ?V (P) deste politopo, ha? uma
varia?vel cont??nua ?P,v associada. A representac?a?o de um ponto do gra?-
fico G da func?a?o e? descrita como a combinac?a?o convexa dos ve?rtices de



56

Figura 8: Func?a?o Linear por Partes com Dom??nio Bidimensional.

cada politopo com as seguintes relac?o?es:

(x, f (x)) = ?
P?P

?
v?V (P)

?P,v(v, f (v)) (3.2a)

{?P,v}P?P,v?V (P) ?R+ (3.2b)

?
P?P

?
v?V (P)

?P,v = 1. (3.2c)

Note que, para a func?a?o ilustrativa unidimensional ilustrada na Figura
7, P1 ?P2 = {1}, enta?o o ve?rtice v = 1 tera? duas varia?veis cont??nuas
associadas: ?P1,1 e ?P2,1.

3.2.1 Modelo Ba?sico

O modelo de Combinac?a?o Convexa Desagregada (DCC) na?o re-
quer nenhuma propriedade especial na sua fam??lia de politopos, sendo



57

-2 -1 0 1 2

-1

-2

0

1

2

-2 -1 0 1 2

-1

-2

0

1

2

Figura 9: Triangulac?a?o J1 no dom??nio de f (x,y)

dado pela formulac?a?o:

?
P?P

?
v?V (P)

?P,vv = x (3.3a)

?
P?P

?
v?V (P)

?P,v f (v) = f (x) (3.3b)

?P,v ? 0, ?P ? P,?v ?V (P) (3.3c)

?
v?V (P)

?P,v = yP, ?P ? P (3.3d)

?
P?P

yP = 1 yP ?{0,1},?P ? P (3.3e)

As restric?o?es (3.3a)-(3.3c) representam um ponto do gra?fico (x, f (x))
como combinac?a?o convexa de (v, f (v)) para v ? V (P). As equac?o?es
(3.3d) e (3.3e) limitam a combinac?a?o convexa a exatamente um poli-
topo P. Note que, pela restric?a?o (3.3e), apenas uma varia?vel yP pode
assumir valor 1, significando que apenas um politopo pode estar ativo.
Quando yP = 1, as varia?veis de peso associadas a?quele politopo ?P,v
podem assumir um valor no intervalo [0,1], enquanto todas as outras
varia?veis associadas aos demais politopos assumem valor zero. Esta
formulac?a?o foi estudada em (CROXTON; GENDRON; MAGNANTI,
2003), (JEROSLOW; LOWE, 1984), (MEYER, 1976) e (SHERALI,
2001).



58

3.2.1.1 Caso Unidimensional

Nesta sec?a?o, a formulac?a?o expl??cita do modelo DCC para func?a?o
linear por partes unidimensional ilustrada na Figura 7 e? apresentada,
como segue:

?
P?P

?
v?V (P)

?P,vv = x ?
{

?P1,0 0 + ?P1,1 1 + ?P2,1 1 + ?P2,2 2 +
?P3,2 2 + ?P3,3 3 + ?P4,3 3 + ?P4,4 4 = x

?
P?P

?
v?V (P)

?P,v f (v) = f (x) ?

??
?

?P1,0 8 + ?P1,1 28 + ?P2,1 28 + ?P2,2 14 +
?P3,2 14 + ?P3,3 25+
?P4,3 25 + ?P4,4 21 = f (x)

?P,v ? 0,?P ? P,?v ?V (P) ?
{

?P1,0 ? 0,?P1,1 ? 0,?P2,1 ? 0,?P2,2 ? 0,
?P3,2 ? 0,?P3,3 ? 0,?P4,3 ? 0,?P4,4 ? 0

?
v?V (P)

?P,v = yP,?P ? P ?

????
???

?P1,0 + ?P1,1 = yP1
?P2,1 + ?P2,2 = yP2
?P3,2 + ?P3,3 = yP3
?P4,3 + ?P4,4 = yP4

?
P?P

yP = 1 ? yP1 + yP2 + yP3 + yP4 = 1

yP ?{0,1},?P ? P ? yP1 ?{0,1}, yP2 ?{0,1}, yP3 ?{0,1}, yP4 ?{0,1}

3.2.1.2 Caso Bidimensional

Nesta sec?a?o, a formulac?a?o expl??cita do modelo DCC para a fun-
c?a?o linear por partes bidimensional ilustrada na Figura 8 e? apresentada,
como segue:

?
P?P

?
v?V (P)

?P,vv = x ?

?????????
????????

?
P1,v

P1
1

(?2,?2) + ?
P1,v

P1
2

(?2,?1)
+?

P1,v
P1
3

(?1,?1) + ?
P2,v

P2
1

(?2,?1)
+?

P2,v
P2
2

(?1,?1) + ?
P2,v

P2
3

(?2,0)
+···+ ?

P32,v
P32
1

(2,?1) + ?
P32,v

P32
2

(1,?1)
+?

P32,v
P32
3

(2,?2) = x



59

?
P?P

?
v?V (P)

?P,v f (v) = f (x) ?

???????????
??????????

?
P1,v

P1
1

(11.4074) + ?
P1,v

P1
2

(2.7366)

+?
P1,v

P1
3

(5.0862) + ?
P2,v

P2
1

(2.7366)

+?
P2,v

P2
2

(5.0862) + ?
P2,v

P2
3

(?2.9817)
+···+ ?

P32,v
P32
1

(?1.2634)+
?

P32,v
P32
2

(3.0862) + ?
P32,v

P32
3

(3.4074)

= f (x)

?P,v ? 0,?P ? P, v ?V (P) ? ?P1,vP11
? 0, ?

P1,v
P1
2
? 0, ..., ?

P32,v
P32
3
? 0

?
v?V (P)

?P,v = yP,?P ? P ?

???????
??????

?
P1,v

P1
1

+ ?
P1,v

P1
2

+ ?
P1,v

P1
3

= yP1
?

P2,v
P2
1

+ ?
P2,v

P2
2

+ ?
P2,v

P2
3

= yP2
...

?
P32,v

P32
1

+ ?
P32,v

P32
2

+ ?
P32,v

P32
3

= yP32

?
P?P

yP = 1 ? yP1 + yP2 +···+ yP32 = 1

yP ?{0,1},?P ? P ? yP1 ?{0,1}, yP2 ?{0,1}, ... ,yP32 ?{0,1}

3.2.2 Modelo Logar??tmico

O Modelo de Combinac?a?o Convexa Desagregada Logar??tmico
(DLog) tem como objetivo reduzir o nu?mero de varia?veis bina?rias e de
restric?o?es adicionais do modelo DCC. Com base nos resultados apresen-
tados em (IBARAKI, 1976; VIELMA; KEHA; NEMHAUSER, 2008),
Vielma e Nemhauser (2009) desenvolveram uma nova formulac?a?o onde
cada politopo P ? P e? representado com um vetor bina?rio definido por
y ?{0,1}dlog2 |P|e, usando uma func?a?o injetora B : P ?{0,1}dlog2 |P|e.
Algumas varia?veis bina?rias sa?o usadas para forc?ar que ?v?V (P) ?P,v = 1



60

quando y = B(P). O modelo resultante e? dado por:

Eqs. (3.3a)?(3.3c) (3.4a)

?
P?P

?
v?V (P)

?P,v = 1 (3.4b)

?
P?P1(B,l)

?
v?V (P)

?P,v ? yl,?l ? L(P) (3.4c)

?
P?P0(B,l)

?
v?V (P)

?P,v ? (1?yl ),?l ? L(P) (3.4d)

yl ?{0,1},?l ? L(P) (3.4e)

onde B(P)l e? o valor do co?digo bina?rio associado ao politopo P na posi-
c?a?o l, sendo a posic?a?o l crescente da esquerda para a direita, P j(B,l)
e? o conjunto de politopos cujos co?digos bina?rios tem o valor j ?{0,1}
na posic?a?o l e L(P) e? o conjunto de ??ndices para as entradas de um
co?digo bina?rio B(P), conforme definidos a seguir:

P j(B,l) := {P ? P : B(P)l = j}, j ?{0,1}
L(P) := {1,...,dlog2 |P|e}.

As Equac?o?es (3.4c)–(3.4e) garantem que ?P,v seja diferente de
zero apenas quando y = B(P).

3.2.2.1 Caso Unidimensional

Para a func?a?o ilustrativa unidimensional, B e? definida como uma
func?a?o injetora tal que B(P1) = (0,0), B(P2) = (0,1), B(P3) = (1,0) e
B(P4) = (1,1). Assim, P 1(B,1) ={P3,P4}, P 1(B,2) ={P2,P4}, P 0(B,1) =
{P1,P2} e P 0(B,2) ={P1,P3}. O conjunto L(P) ={1,2} e? o conjunto de
??ndices para o co?digo bina?rio dos politopos. As equac?o?es (3.4a) do mo-
delo DLog sa?o equivalentes a?s equac?o?es (3.3a)–(3.3c). Como a forma
expl??cita de tais restric?o?es ja? foram apresentadas na sec?a?o 3.2.1.1, a
formulac?a?o a seguir apresenta apenas as demais restric?o?es do modelo



61

Dlog:

?
P?P

?
v?V (P)

?P,v = 1 ?
{

?P1,0 + ?P1,1 + ?P2,1 + ?P2,2 +
?P3,2 + ?P3,3 + ?P4,3 + ?P4,4 = 1

?
P?P1(B,l)

?
v?V (P)

?P,v ? yl,?l ? L(P) ?
{

?P3,2 + ?P3,3 + ?P4,3 + ?P4,4 ? y1
?P2,1 + ?P2,2 + ?P4,3 + ?P4,4 ? y2

?
P?P0(B,l)

?
v?V (P)

?P,v ? 1?yl,?l ? L(P) ?

????
???

?P1,0 + ?P1,1 + ?P2,1
+?P2,2 ? (1?y1)
?P1,0 + ?P1,1 + ?P3,2
+?P3,3 ? (1?y2)

yl ?{0,1},?l ? L(P) ? y1 ?{0,1}, y2 ?{0,1}

3.2.2.2 Caso Bidimensional

Nesta sec?a?o, a formulac?a?o expl??cita do modelo DLog para a fun-
c?a?o linear por partes bidimensional ilustrada na Figura 8 e? apresentada.
Seja B uma func?a?o injetora definida como segue:

B : P ?{0,1}dlog2 |P|e ?

???????????????
??????????????

B(P1) = (0,0,0,0,0),
B(P2) = (0,0,0,0,1),
B(P3) = (0,0,0,1,1),
B(P4) = (0,0,0,1,0),
B(P5) = (0,0,1,1,0),
B(P6) = (0,0,1,0,0),

...
B(P31) = (1,0,1,1,1),
B(P32) = (1,1,1,1,1)



62

A seguir, sera?o definidos os conjuntos necessa?rios no desenvolvimento
da formulac?a?o:

L(P) = {1,...,dlog2 |P|e}? L(P) = {1,2,3,4,5}
P 1(B,1) = {...,P31,P32},

P 0(B,1) = {P1,P2,P3,P4,P5,P6,...},
P 1(B,2) = {...,P32},

P 0(B,2) = {P1,P2,P3,P4,P5,...,P31},
...

P 1(B,5) = {P2,P3,...,P31,P32},
P 0(B,5) = {P1,P4,P5,P6,...}

As equac?o?es (3.4a) do modelo DLog sa?o equivalentes a?s equa-
c?o?es (3.3a)–(3.3c). Como a forma expl??cita de tais restric?o?es ja? foram
apresentadas na sec?a?o 3.2.1.2, a formulac?a?o a seguir apresenta apenas
as demais restric?o?es do modelo Dlog:

?
P?P

?
v?V (P)

?P,v = 1 ?

??????
?????

?
P1,v

P1
1

+ ?
P1,v

P1
2

+ ?
P1,v

P1
3

+?
P2,v

P2
1

+ ?
P2,v

P2
2

+ ?
P2,v

P2
3

+···+
?

P32,v
P32
1

+ ?
P32,v

P32
2

+ ?
P32,v

P32
3

= 1

?
P?P1(B,l)

?
v?V (P)

?P,v ? yl,?l ? L(P)

m??????????????????
?????????????????

?P?P1(B,1) ?v?V (P) ?P,v ? y1 ?

{
···+ ?

P31,v
P31
1

+ ?
P31,v

P31
2

+ ?
P31,v

P31
3

+?
P32,v

P32
1

+ ?
P32,v

P32
2

+ ?
P32,v

P32
3
? y1

?P?P1(B,2) ?v?V (P) ?P,v ? y2 ?
{
···+ ?

P32,v
P32
2

+ ?
P32,v

P32
3
? y2

...

?P?P1(B,5) ?v?V (P) ?P,v ? y5 ?

??????
?????

?
P2,v

P2
1

+ ?
P2,v

P2
2

+ ?
P2,v

P2
3

+?
P3,v

P3
1

+ ?
P3,v

P3
2

+ ?
P3,v

P3
3

+···
+?

P31,v
P31
1

+ ?
P31,v

P31
2

+ ?
P31,v

P31
3

+?
P32,v

P32
1

+ ?
P32,v

P32
2

+ ?
P32,v

P32
3
? y5



63

?
P?P0(B,l)

?
v?V (P)

?P,v ? 1?yl,?l ? L(P)

m??????????????????????????????????????????????
?????????????????????????????????????????????

?P?P0(B,1) ?v?V (P) ?P,v ? 1?y1 ?

????????????
???????????

?
P1,v

P1
1

+ ?
P1,v

P1
2

+ ?
P1,v

P1
3

+?
P2,v

P2
1

+ ?
P2,v

P2
2

+ ?
P2,v

P2
3

+?
P3,v

P3
1

+ ?
P3,v

P3
2

+ ?
P3,v

P3
3

+?
P4,v

P4
1

+ ?
P4,v

P4
2

+ ?
P4,v

P4
3

+?
P5,v

P5
1

+ ?
P5,v

P5
2

+ ?
P5,v

P5
3

+?
P6,v

P6
1

+ ?
P6,v

P6
2

+···? 1?y1

?P?P0(B,2) ?v?V (P) ?P,v ? 1?y2 ?

??????????????
?????????????

?
P1,v

P1
1

+ ?
P1,v

P1
2

+ ?
P1,v

P1
3

+?
P2,v

P2
1

+ ?
P2,v

P2
2

+ ?
P2,v

P2
3

+?
P3,v

P3
1

+ ?
P3,v

P3
2

+ ?
P3,v

P3
3

+?
P4,v

P4
1

+ ?
P4,v

P4
2

+ ?
P4,v

P4
3

+?
P5,v

P5
1

+ ?
P5,v

P5
2

+ ?
P5,v

P5
3

+···
+?

P31,v
P31
1

+ ?
P31,v

P31
2

+ ?
P31,v

P31
3

? 1?y2
...

?P?P0(B,5) ?v?V (P) ?P,v ? 1?y5 ?

????????
???????

?
P1,v

P1
1

+ ?
P1,v

P1
2

+ ?
P1,v

P1
3

+?
P4,v

P4
1

+ ?
P4,v

P4
2

+ ?
P4,v

P4
3

+?
P5,v

P5
1

+ ?
P5,v

P5
2

+ ?
P5,v

P5
3

+?
P6,v

P6
1

+ ?
P6,v

P6
2

+ ?
P6,v

P6
3

+···? 1?y5
yl ?{0,1},?l ? L(P) ? y1 ?{0,1}, y2 ?{0,1}, y3 ?{0,1},..., y5 ?{0,1}

3.3 MODELOS DE COMBINAC?A?O CONVEXA (AGREGADA)

Os modelos desta sec?a?o associam a cada ve?rtice v ? V (P) uma
varia?vel cont??nua ?v e representam um ponto do gra?fico (x, f (x)) com



64

as seguintes equac?o?es:

(x, f (x)) = ?
v?V (P)

?v(v, f (v)), (3.5a)

{?v}v?V (P) ?R+ (3.5b)

?
v?V (P)

?v = 1 (3.5c)

Estes modelos foram desenvolvidos com o objetivo de reduzir o
nu?mero de varia?veis do modelo DCC, agregando as varia?veis cont??nuas
associadas a cada ve?rtice v?V (P) que pertence a mais de um politopo
P ? P.

3.3.1 Modelo Ba?sico

O modelo de combinac?a?o convexa agregada (CC) e? dado por:

?
v?V (P)

?vv = x (3.6a)

?
v?V (P)

?v f (v) = f (x) (3.6b)

?v ? 0,?v ? V (P) (3.6c)

?
v?V (P)

?v = 1 (3.6d)

?v ? ?
P?P(v)

yP,?v ? V (P) (3.6e)

?
P?P

yP = 1, yP ?{0,1}, ?P ? P (3.6f)

onde P(v) :={P?P : v?V (P)} e? o conjunto de politopos que conte?m o
ve?rtice v. Esta formulac?a?o foi estudada na literatura por Keha, FARIAS
JR e Nemhauser (2004), Lee e Wilson (2001) e Padberg (2000).

3.3.1.1 Caso Unidimensional

Nesta sec?a?o, a formulac?a?o expl??cita do modelo CC para a func?a?o
linear por partes unidimensional ilustrada na Figura 7 e? apresentada a



65

seguir:

?
v?V (P)

?vv = x ? ?00 + ?11 + ?22 + ?33 + ?44 = x

?
v?V (P)

?v f (v) = f (x) ? ?08 + ?128 + ?214 + ?325 + ?421 = f (x)

?v ? 0,?v ? V (P) ? ?0 ? 0, ?1 ? 0, ?2 ? 0, ?3 ? 0, ?4 ? 0

?v ? ?
P?P

yP,?v ? V (P) ?

??????
?????

?0 ? yP1
?1 ? yP1 + yP2
?2 ? yP2 + yP3
?3 ? yP3 + yP4
?4 ? yP4

?
P?P

yP = 1 ? yP1 + yP2 + yP3 + yP4 = 1

yP ?{0,1},?P ? P

3.3.1.2 Caso Bidimensional

Para a func?a?o f (x,y) ilustrada nas Figuras 8 e 9, o modelo CC
pode ser descrito de forma expl??cita pelo conjunto de equac?o?es abaixo:

?
v?V (P)

?vv = x ? ?v1 (?2,?2) + ?v2 (?2,?1) +···+ ?v25 (2,?2) = x

?
v?V (P)

?v f (v) = f (x) ? ?v1 11.4074 + ?v2 7.7569 +···

+?v25 (?3.8463) = f (x)
?v ? 0,?v ? V (P) ? ?v1 ? 0, ?v2 ? 0, ..., ?v25 ? 0

?
v?V (P)

?v = ?v1 + ?v2 + ?v3 +···+ ?v25 = 1



66

?v ? ?
P?P

yP,?v ? V (P) ?

???????????
??????????

?v1 ? yP1 + yP8
?v2 ? yP1 + yP2
?v3 ? yP1 + yP2 + yP7

+yP10 + yP15 + yP16
+yP9 + yP8

...
?v25 ? yP25 + yP32

?
P?P

yP = yP1 + yP2 + yP3 +···+ yP32 = 1

yP ?{0,1},?P ? P ? yP1 ?{0,1}, yP2 ?{0,1},...,yP32 ?{0,1}

3.3.2 Modelo Logar??tmico

O modelo de Combinac?a?o Convexa Agregada Logar??tmico (Log)
e? baseado no modelo CC, mas utiliza um nu?mero logar??tmico de varia?-
veis bina?rias e restric?o?es associadas em relac?a?o a? cardinalidade do con-
junto de politopos do dom??nio. O modelo Log associa a cada politopo
P ? P um vetor bina?rio em y ?{0,1}dlog2 |P|e atrave?s de uma func?a?o
injetora B : P ?{0,1}dlog2 |P|e tal que B(P) = y. Conforme discutido
em (VIELMA; AHMED; NEMHAUSER, 2010), a func?a?o B precisa in-
duzir uma ramificac?a?o bina?ria em que, no u?ltimo n??vel, as varia?veis de
peso ? associadas aos ve?rtices de ao menos um politopo P ? P sejam
diferentes de zero:

?P ? P tal que {v ? V (P) : ?v &gt; 0}?V (P) (3.8)

Uma ramificac?a?o va?lida para a condic?a?o (3.8) consiste de uma seque?ncia
de dicotomias {Lt,Rt}t?T definidas por um conjunto finito T de ??ndi-
ces e subconjuntos correspondentes Lt,Rt ? V (P), tal que, para cada
P ? P, e? verdade que V (P) = ?t?T (V (P)\Tt ) onde Tt = Lt ou Tt = Rt ,
para cada t ? T . Tais ramificac?o?es impo?em a condic?a?o (3.8) na formu-
lac?a?o atribuindo o valor zero a determinados ? ’s de acordo com o ramo
escolhido no n??vel da a?rvore, ou seja, ?vl = 0,?vl ?Lt e ?vr = 0,?vr ?Rt .
A formulac?a?o que constro?i um ramificac?a?o va?lida para o modelo Log e?



67

dada por:

Eqs. (3.6a)?(3.6d) (3.9a)

?
v?Lt

?v ? yt, ?t ? T (3.9b)

?
v?Rt

?v ? (1?yt ), ?t ? T (3.9c)

yt ?{0,1}, ?t ? T (3.9d)

Uma ramificac?a?o va?lida para a func?a?o ilustrativa com dom??nio
unidimensional da Figura 7 e? dada por L1 ={2}, R1 ={0,4}, L2 ={3,4}
e R2 = {0,1}, com T = {1,2}. O conjunto de equac?o?es que implementa
as equac?o?es (3.9b)-(3.9d) da formulac?a?o acima para a ramificac?a?o apre-
sentada e? dada por:

?
v?Lt

?v ? yt, ?t ? T ?
{

?2 ? y1,
?3 + ?4 ? y2

?
v?Rt

?v ? (1?yt ), ?t ? T ?
{

?0 + ?4 ? (1?y1),
?0 + ?1 ? (1?y2)

yt ?{0,1}, ?t ? T ? y1 ?{0,1}, y2 ?{0,1}

A ramificac?a?o constru??da a partir da formulac?a?o apresentada acima e?
ilustrada na Figura 10. Para cada n??vel da a?rvore, ha? um ramo induzido

Figura 10: Uma Ramificac?a?o para o Modelo Log.

pelas varia?veis bina?rias yt , t ? T e, como resultado, um conjunto de
varia?veis de peso ? assumem valor zero. Por exemplo, no primeiro
n??vel, quando y1 = 0, e? criado o ramo L1 = {2} e a varia?vel de peso ?2
recebe valor 0. Neste caso, apenas os poliedros P1 = [0,1] e P4 = [3,4]



68

podem ser habilitados, pois os demais poliedros que conte?m o ve?rtice
v2 = 2 possuem a varia?vel de peso ?2 associada com valor nulo. No
final da ramificac?a?o, cada folha da a?rvore possui apenas um poliedro
habilitado, o qual possui as varia?veis de peso ? que na?o foram zeradas.
O dom??nio da func?a?o e? composto pela unia?o dos poliedros habilitados
nas folhas da ramificac?a?o. Note que o modelo Log assegura que a
ramificac?a?o seja independente, ou seja, que cada n??vel da a?rvore possua
os ramos da esquerda e direita independentes dos n??veis superiores.
Mais especificamente, independente de quais varia?veis sa?o ramificadas
primeiramente, os ramos das suba?rvores da esquerda e direita na?o sera?o
alterados, conforme pode ser visto na Figura 10.

Vielma e Nemhauser (2009) desenvolveram uma formulac?a?o que
constro?i uma ramificac?a?o va?lida com um nu?mero logar??tmico de vari-
a?veis bina?rias e dicotomias em relac?a?o a? cardinalidade do conjunto de
politopos. Tal ramificac?a?o e? va?lida para uma fam??lia de politopos P
que seja topologicamente equivalente ou compat??vel com a triangulac?a?o
J1. Esta ramificac?a?o e? baseada em um procedimento de duas fases. A
seguir, alguns conceitos sa?o introduzidos com o objetivo de se modelar
tal ramificac?a?o.

Seja E d o conjunto de eixos do dom??nio com dimensa?o d da
func?a?o. Seja Se = {s0,...,sn} o conjunto de breakpoints, ou seja, dos
valores de cada coordenada, e Ie :={[s0,s1], ...,[sn?1,sn]} o conjunto de
intervalos contidos no eixo e ? E d . O conjunto dos ve?rtices do dom??nio
e? definido como V (P) = Se1 ×···×Sed , onde e1,...,ed sa?o os eixos do
dom??nio pertencentes ao conjunto E d . Seja Ie(s) := {I ? Ie : s ? I}
o conjunto de intervalos que conte?m o breakpoint s. Seja ?e([si,si+1]) =
i + 1 o ??ndice do intervalo I = [si,si+1] ? Ie. Seja B : {1,...,|Ie|}?
{0,1}dlog2(|Ie|)e uma func?a?o compat??vel com SOS2, ou seja, B(i) e B(i + 1)
diferem em apenas um bit, tendo como resultado um co?digo bina?rio.
Existem diversos conjuntos de vetores bina?rios com esta propriedade e
estes sa?o geralmente denominados Gray Codes (WILF, 1989).

A primeira fase da ramificac?a?o consiste em usar uma disjunc?a?o
de conjuntos para limitar a combinac?a?o convexa dos ve?rtices do dom??nio
a um hipercubo. A formulac?a?o correspondente a? primeira fase usara? os
conjuntos

J+e,B,l := {s ? Se : B(?e(I ))l = 1,?I ? Ie(s)}

J0e,B,l := {s ? Se : B(?e(I ))l = 0,?I ? Ie(s)}

que constroem a primeira parte da ramificac?a?o do Log. O breakpoint
s no eixo e pertence ao conjunto J+e,B,l se todos os intervalos que conte?m



69

o breakpoint s te?m na posic?a?o l do seu respectivo co?digo bina?rio o valor
1. O conjunto J0e,B,l e? semelhante, pore?m os intervalos que conte?m o
breakpoint te?m na posic?a?o l do seu co?digo bina?rio o valor 0.

Seja [0,w]2 ? R2 o dom??nio da func?a?o para a dimensa?o d = 2.
Neste caso, o conjunto de eixos E 2 = {x,y}. As equac?o?es a seguir mo-
delam a primeira fase da ramificac?a?o do Log:

w

?
v2=0

?
v1?J+e,B,l

?v1,v2 ? z
e
l ,?e ? E

d,?l ?{1,...,dlog2(|w|)e} (3.10a)

w

?
v2=0

?
v1?J0e,B,l

?v1,v2 ? 1?z
e
l ,?e ? E

d,?l ?{1,...,dlog2(|w|)e} (3.10b)

zel ?{0,1},?e ? E
d,?l ?{1,...,dlog2(|w|)e}, (3.10c)

A segunda fase seleciona um simplex dentro do hipercubo ini-
bindo alguns ve?rtices ainda habilitados depois da primeira fase da ra-
mificac?a?o. Para esta fase, alguns novos conceitos sa?o introduzidos.

Seja v j o valor da posic?a?o j do vetor v. Lr,s e? o conjunto dos ve?rti-
ces que te?m valor par na posic?a?o r e ??mpar na posic?a?o s do vetor v, sendo
definido como Lr,s = {v ? V (P) : vr e? par e vs e? ??mpar}. Rr,s e? o con-
junto dos ve?rtices que te?m valor ??mpar na posic?a?o r e par na posic?a?o s do
vetor v, sendo definido como Rr,s = {v ?V (P) : vr e? ??mpar e vs e? par}.
As posic?o?es r e s pertencem ao conjunto D = {1,...,d}, onde d e? a
dimensa?o do dom??nio da func?a?o. O conjunto de equac?o?es a seguir im-
plementam a segunda fase da ramificac?a?o do modelo Log:

?
v?Lr,s

?v ? yr,s,?r,s ? D : r &amp;lt;s (3.11a)

?
v?Rr,s

?v?1?yr,s ,?r,s ? D : r &amp;lt;s (3.11b)

3.3.2.1 Caso Unidimensional

Nesta sec?a?o, a formulac?a?o expl??cita do modelo Log para a func?a?o
linear por partes unidimensional ilustrada na Figura 7 e? apresentada.
Seja a func?a?o B definida de acordo com a propriedade Gray Code como
segue B(P1) = (0,0), B(P2) = (0,1), B(P3) = (1,1) e B(P4) = (1,0). Os
conjuntos que criam uma ramificac?a?o nas varia?veis de peso ? sa?o defi-



70

nidos a seguir:

J+
(x,B,1) = {2}, J

+
(x,B,2) = {3,4}

J0(x,B,1) = {0,4},J
0
(x,B,2) = {0,1}

As primeiras equac?o?es do modelo Log sa?o equivalentes a?s equac?o?es
(3.6a)-(3.6d) do modelo CC. Por isto, sera?o apresentadas abaixo apenas
as demais equac?o?es do modelo:

?
v?J+x,B,l

?v ? zxl ,?l ? L(P) ?
{

?2 ? zx1
?3 + ?4 ? zx2

?
v?J0x,B,l

?v ? (1?zxl ),?l ? L(P) ?
{

?0 + ?4 ? (1?zx1)
?0 + ?1 ? (1?zx2)

zxl ?{0,1},?l ? L(P) ? z
x
1 ?{0,1}, z

x
2 ?{0,1}

3.3.2.2 Caso Bidimensional

Nesta sec?a?o, sera? apresentada uma formulac?a?o expl??cita para a
func?a?o bidimensional ilustrada na Figura 8, cujo dom??nio esta? repre-
sentado na Figura 9, usando o modelo Log. Para a dimensa?o do espac?o
d = 2, seja D = {1,...,d} um conjunto de ??ndices e J = [?2,...,2]2 o
conjunto de ve?rtices que compo?em a triangulac?a?o J1. Seja B : I ?
{0,1}dlog2 |I |e uma func?a?o injetora seguindo a propriedade Gray code,
B([?2,?1]) = (0,0), B([?1,0]) = (0,1), B([0,1]) = (1,1), B([1,2]) = (1,0),
onde I ={[?2,?1], [?1,0], [0,1],[1,2]} e? o conjunto de intervalos. Note
que os intervalos pertencentes I sa?o da forma [si,si+1] para si ? S\{sn},
onde S = {s1,s2,...,sn} e? o conjunto de breakpoints.

Seja J+(a,B,l) ? Sa o conjunto do breakpoints do eixo a (x ou y)
tal que, para cada s ? Sa, os intervalos I ? I (s), aos quais s pertence,
possuem valor 1 na posic?a?o l dos seus co?digos bina?rios B(I). A definic?a?o
do conjunto J0(a,B,l) e? similar a J+(e,B,l), exceto para os co?digos
bina?rios dos politopos que conte?m um determinado breakpoint s devem
ter valor 0 na posic?a?o l, ao inve?s de 1. Como os conjuntos de breakpoints
para os eixos x e y para a func?a?o bidimensional ilustrativa sa?o ide?nticos,
os conjuntos de ve?rtices J+ e J0 sa?o os mesmos para ambos os eixos.
Para a func?a?o ilustrativa bidimensional, conjuntos J+(e,B,l) e J0(e,B,l)



71

sa?o definidos como segue:

J+(x,B,1) = J+(y,B,1) = {0}
J0(x,B,1) = J0(y,B,1) = {?2,2}
J+(x,B,2) = J+(y,B,2) = {1,2}

J0(x,B,2) = J0(y,B,2) = {?2,?1}

A primeira fase do Log consistira? em selecionar um quadrado
dentro do dom??nio da func?a?o. Este esquema de ramificac?a?o usa duas
varia?veis bina?rias para cada eixo para codificar os intervalos: (zx2,z

x
1)

codifica os quatro intervalos do eixo x, enquanto (zy2,z
y
1) codifica os do

eixo y, onde zal e? a varia?vel bina?ria para uma posic?a?o l do co?digo para
o eixo a. A primeira fase do Log para a func?a?o ilustrativa com dom??nio
bidimensional e? formulada com as seguintes equac?o?es:

2

?
s1=?2

?
s2?J+(y,B,2)

?s1,s2 ? z
y
2 ?

??
?

??2,1 + ??1,1 + ?0,1 + ?1,1
+?2,1 + ??2,2 + ??1,2 + ?0,2
+?1,2 + ?2,2 ? z

y
2

2

?
s2=?2

?
s1?J+(x,B,2)

?s1,s2 ? z
x
2 ?

??
?

?1,?2 + ?1,?1 + ?1,0 + ?1,1
+?1,2 + ?2,?2 + ?2,?1
+?2,0 + ?2,1 + ?2,2 ? zx2

2

?
s1=?2

?
s2?J+(y,B,1)

?s1,s2 ? z
y
1 ?

{
??2,0 + ??1,0 + ?0,0
+?1,0 + ?2,0 ? z

y
1

2

?
s2=?2

?
s1?J+(x,B,1)

?s1,s2 ? z
x
1 ?

{
?0,?2 + ?0,?1 + ?0,0
+?0,1 + ?0,2 ? zx1



72

2

?
s2=?2

?
s1?J0(x,B,1)

?s1,s2 ? (1?z
x
1) ?

????
???

??2,?2 + ??2,?1 + ??2,0
+??2,1 + ??2,2 + ?2,?2
+?2,?1 + ?2,0 + ?2,1
+?2,2 ? (1?zx1)

2

?
s2=?2

?
s1?J0(x,B,2)

?s1,s2 ? (1?z
x
2) ?

????
???

??2,?2 + ??2,?1 + ??2,0
+??2,1 + ??2,2 + ??1,?2
+??1,?1 + ??1,0 + ??1,1
+??1,2 ? (1?zx2)

2

?
s1=?2

?
s2?J0(y,B,1)

?s1,s2 ? (1?z
y
1) ?

????
???

??2,?2 + ??1,?2 + ?0,?2
+?1,?2 + ?2,?2 + ??2,2
+??2,2 + ??1,2 + ?0,2
+?1,2 + ?2,2 ? (1?z

y
1)

?
s1=?2

?
s2?J0(y,B,2)

?s1,s2 ? (1?z
y
2) ?

????
???

??2,?2 + ??1,?2 + ?0,?2
+?1,?2 + ?2,?2 + ??2,?1
+??1,?1 + ?0,?1 + ?1,?1
+?2,?1 ? (1?z

y
2)

zx1 ?{0,1}, z
x
2 ?{0,1}, z

y
1 ?{0,1}, z

y
2 ?{0,1}

Para o exemplo ilustrativo, quando (zx2,z
x
1) = (0,1) e (z

y
2,z

y
1) = (0,1), o

politopo quadrado [?1,0]×[?1,0] e? selecionado.
A segunda fase da ramificac?a?o seleciona um tria?ngulo dentro do

quadrado escolhido na primeira fase da ramificac?a?o. Os conjuntos de



73

equac?o?es definidos a seguir modelam a selec?a?o do tria?ngulo:

J? = {(s1,s2) ? D ×D : s1 &amp;lt;s2} = {(1,2)}
Ls1,s2 = {v ? J : vs1 e? par,vs2 e? ??mpar},?(s1,s2) ? J? ?
L1,2 = {(?2,?1),(?2,1),(0,?1),(0,1),(2,?1),(2,1)}

Rs1,s2 = {v ? J : vs1 e? ??mpar,vs2 e? par},?(s1,s2) ? J? ?
R1,2 = {(?1,?2),(?1,0),(?1,2),(1,?2),(1,0),(1,2)}

?
(s1,s2)?Ls1,s2

?s1,s2 ? ys1,s2 ?
{

??2,?1 + ??2,1 + ?0,?1
+?0,1 + ?2,?1 + ?2,1 ? y1,2

?
(s1,s2)?Rs1,s2

?s1,s2 ? 1?ys1,s2 ?
{

??1,?2 + ??1,0 + ??1,2
+?1,?2 + ?1,0 + ?1,2 ? (1?y1,2)

y1,2 ?{0,1}

3.4 MODELO MU?LTIPLA ESCOLHA

O modelo Mu?ltipla Escolha (MC) aproxima a func?a?o original
com equac?o?es de hiperplanos. O dom??nio e? dividido em um conjunto
de politopos, que sa?o limitados por um conjunto de inequac?o?es lineares.
O modelo MC e? dado por:

?
P?P

xP = x (3.14a)

?
P?P

(mPxP + cPyp) = f (x) (3.14b)

APxP ? bPyP,?P ? P (3.14c)

?
P?P

yP = 1, yP ?{0,1},?P ? P (3.14d)

onde APxP ? bP e? o conjunto de inequac?o?es lineares que descrevem
P. O modelo MC representa um ponto do dom??nio como um vetor,
denotado por xP, para cada politopo da fam??lia. A equac?a?o (3.14a)
representa um ponto do dom??nio, enquanto a Equac?a?o (3.14b) aproxima
a func?a?o original para cada politopo P com a equac?a?o de um hiperplano
mPxP + cP. A Equac?a?o (3.14c) e as varia?veis bina?rias yP garantem que
um ponto do dom??nio pertenc?a a apenas um politopo. Esta formulac?a?o
foi estudada em (BALAKRISHNAN; GRAVES, 1989), (CROXTON;
GENDRON; MAGNANTI, 2003) e (JEROSLOW; LOWE, 1984).



74

3.4.1 Caso Unidimensional

Para a func?a?o unidimensional ilustrada na Figura 7, a formulac?a?o
expl??cita MC e? apresentada a seguir:

?
P?P

xP = x ? xP1 + xP2 + xP3 + xP4 = x

?
P?P

(mPxP + cPyP) = f (x) ?
{

(20xP1 + 8yP1 ) + (?14xP2 + 42yP2 )+
(11xP3 ?8yP3 ) + (?4xP4 + 37yP4 ) = f (x)

ApxP ? bPyP,?P ? P ?

????????????????????
???????????????????

[
?1
1

]
xP1 ?

[
0
1

]
yP1 ,

[
?1
1

]
xP2 ?

[
?1
2

]
yP2 ,

[
?1
1

]
xP3 ?

[
?2
3

]
yP3 ,

[
?1
1

]
xP4 ?

[
?3
4

]
yP4

?
P?P

yP = 1 ? yP1 + yP2 + yP3 + yP4 = 1

yP ?{0,1},?P ? P ? yP1 ?{0,1}, yP2 ?{0,1}, yP3 ?{0,1}, yP4 ?{0,1}



75

3.4.2 Caso Bidimensional

Para a func?a?o bidimensional ilustrada na Figura 8, a formulac?a?o
expl??cita MC e? apresentada a seguir:

?
P?P

xP = x ? xP1 + xP2 +···+ xP32 = x

?
P?P

(mPxP + cPyP) = f (x) ?

??????
?????

[2.3496 ?8.6708] xP1 ?1.235yP1
+ [2.3496 ?5.7187] xP2 + 1.7175yP2

+···+
[?4.3496 ?4.6708] xP32 + 2.765yP32
= f (x)

APxP ? bPyP,?P ? P ?

???????????????????????????????????
??????????????????????????????????

?
?????

1 0
?1 0
0 1
0 ?1
1 ?1

?
?????xP1 ?

?
?????
?1
2
?1
2
0

?
?????yP1 ,

?
?????

1 0
?1 0
0 1
0 ?1
?1 1

?
?????xP2 ?

?
?????
?1
2
0
1
?2

?
?????yP2 ,

...?
?????

1 0
?1 0
0 1
0 ?1
1 1

?
?????xP32 ?

?
?????

2
?1
?1
2
0

?
?????yP32

?
P?P

yP = 1 ? yP1 + yP2 +···+ yP32 = 1

yP ?{0,1},?P ? P ? yP1 ?{0,1}, yP2 ?{0,1}, ..., yP32 ?{0,1}



76

3.5 MODELO INCREMENTAL

O modelo Incremental (Inc) aproxima a func?a?o original incre-
mentalmente a partir de um conjunto ordenado de ve?rtices divididos
em politopos no dom??nio da func?a?o. Este modelo requer que o conjunto
de politopos P seja uma triangulac?a?o com uma propriedade especial
de ordenac?a?o.

3.5.1 Caso Unidimensional

Para o caso unidimensional, a propriedade de ordenac?a?o e? sempre
satisfeita, pois ha? uma ordem natural entre os ve?rtices no dom??nio da
func?a?o. Por simplicidade, apresentaremos abaixo a formulac?a?o para
uma func?a?o uni-variada f : [l,u] ? R e para P = {[dk?1,dk]}Kk=1, onde
l = d0 ? d1 ? ···? dK = u. Nestas condic?o?es, o modelo incremental
tem a forma:

d0 +
K

?
k=1

?k(dk ?dk?1) = x (3.15a)

f (d0) +
K

?
k=1

?k ( f (dk)? f (dk?1)) = f (x) (3.15b)

?1 ? 1, ?K ? 0 (3.15c)
?k+1 ? yk ? ?k, yk ?{0,1},?k ?{1,...,K ?1} (3.15d)

A equac?a?o (3.15a) representa o deslocamento de um ponto x do
dom??nio para um determinado politopo P ? P de acordo com a orde-
nac?a?o dos ve?rtices. O mesmo acontece com a func?a?o, conforme repre-
sentado na equac?a?o (3.15b). As restric?o?es (3.15c)?(3.15d) garantem
que um ponto do dom??nio pertenc?a a? apenas um politopo. Quando x
esta? no politopo [dk?1,dk], enta?o {? j}k?1j=1 assumem valor 1, ?k assume
um valor no intervalo [0,1] e {? j}Kj=k+1 assumem valor 0.

Para o exemplo ilustrativo unidimensional apresentado na Figura
7, temos que K = 4 e d0 = 0, d1 = 1, d2 = 2, d3 = 3 e d4 = 4. Assim, P =
{[0,1], [1,2],[2,3],[3,4]},com l = 0 ? 1 ? 2 ? 3 ? 4 = u. A formulac?a?o
Inc expl??cita para a func?a?o ilustrativa com dom??nio unidimensional e?



77

dada por:

d0 +
K

?
k=1

?k (dk ?dk=1) = x ?
{

0 + ?1(1?0) + ?2(2?1)
+?3(3?2) + ?4(4?3) = x

f (d0) +
K

?
k=1

?k ( f (dk)? f (dk?1)) = f (x) ?

??
?

8 + ?1(28?8) + ?2(14?28)
+?3(25?14) + ?4(21?25)
= f (x)

?1 ? 1, ?K ? 0 ? ?4 ? 0

?k+1 ? yk ? ?k,?k ?{1,...,K ?1}?

??
?

?2 ? y1 ? ?1
?3 ? y2 ? ?2
?4 ? y3 ? ?3

yk ?{0,1},?k ?{1,...,K ?1}? y1 ?{0,1}, y2 ?{0,1}, y3 ?{0,1}

3.5.2 Caso Multidimensional (Bidimensional)

A extensa?o do modelo incremental para func?o?es multivariadas
requer que a fam??lia de politopos P seja uma triangulac?a?o T que
obedec?a as seguintes propriedades de ordenac?a?o:

O1 Os simplexes em T devem estar ordenados segundo T1,...,T|T | tal
que Ti ?Ti+1 6= /0 para i ?{1,...,|T |?1}.

O2 Os ve?rtices de cada simplex Ti devem possuir uma ordenac?a?o v0i ,...,
v|V (Ti)|?1i tal que v

|V (Ti)|?1
i = v

0
i+1 para i ?{1,...,|T |?1}.

Para uma definic?a?o formal de um simplex consultar o Ape?ndice A.1.
A propriedade O1 garante que haja uma ordenac?a?o entre os simplexes
do dom??nio. A propriedade O2 significa que o u?ltimo ve?rtice de um
simplex deve coincidir com o primeiro ve?rtice do simplex seguinte. Isto
garante uma ordenac?a?o total de todos os ve?rtices do dom??nio.

Tais propriedades de ordenac?a?o sa?o condic?o?es necessa?rias para
representar um ponto do gra?fico G = {(x, f (x)) : x ? dom( f )} de forma
incremental como ocorre em (3.15a) para o caso uni-variado. Lee e
Wilson (2001) mostraram que tais condic?o?es sa?o satisfeitas por diversas
triangulac?o?es, inclusive pela triangulac?a?o J1. Para uma triangulac?a?o
que obedec?a as propriedades de ordenac?a?o O1?O2, a formulac?a?o Inc e?



78

dada por:

v01 +
|T |

?
i=1

|V (Ti)|?1

?
j=1

?
j

i

(
v ji ?v

0
i

)
= x (3.16a)

f (v01) +
|T |

?
i=1

|V (Ti)|?1

?
j=1

?
j

i

(
f (v ji )? f (v

0
i )
)

= f (x) (3.16b)

|V (Ti)|?1

?
j=1

?
j

i ? 1,?i ?{1,...,T } (3.16c)

?
j

i ? 0,?i ?{1,...,T },? j ?{1,...,|V (Ti)|?1} (3.16d)

yi ? ?
|V (Ti)|?1
i ,?i ?{1,...,|T |?1} (3.16e)

|V (Ti+1)|?1

?
j=1

?
j

i+1 ? yi,?i ?{1,...,|T |?1} (3.16f)

yi ?{0,1},?i ?{1,...,|T |?1} (3.16g)

Este modelo foi estudado em (DANTZIG, 1960; JEROSLOW; LOWE,
1985; KEHA; FARIAS JR; NEMHAUSER, 2004; LEE; WILSON, 2001;
PADBERG, 2000), referenciado por me?todo delta. Mais recentemente,
este passou a ser denominado modelo incremental em (VIELMA; AH-
MED; NEMHAUSER, 2010; CROXTON; GENDRON; MAGNANTI,
2003; KEHA; FARIAS JR; NEMHAUSER, 2004). A formulac?a?o expl??-
cita do modelo Inc para a func?a?o com dom??nio bidimensional ilustrado
na Figura 9 e? dada pelo conjunto de equac?o?es:

v01 +
|T |

?
i=1

|V (Ti)|?1

?
j=1

?
j

i

(
v ji ?v

0
i

)
= x ?

??????????????????????
?????????????????????

[
?2
?2

]
+ ? 11

([
?1
?1

]
?
[
?2
?2

])
+? 21

([
?2
?1

]
?
[
?2
?2

])
+? 12

([
?1
?1

]
?
[
?2
?1

])
+? 22

([
?2
?0

]
?
[
?2
?1

])
+···

+? 132

([
2
?1

]
?
[

1
?1

])
+? 232

([
2
?2

]
?
[

1
?1

])
=

[
x
y

]



79

f (v01) +
|T |

?
i=1

|V (Ti)|?1

?
j=1

?
j

i

(
f (v ji )? f (v

0
i )
)

= f (x)

m??
?

11.4074 + ? 11 (5.0862?11.4074) + ?
2
1 (2.7366?11.4074)

+? 12 (5.0862?2.7366) + ?
2
2 (?2.9817?2.7366) +···+

?
1
32(?1.2634?3.0862) + ?

2
32(3.4074?3.0862) = f (x)

V (Ti)?1

?
j=1

?
j

i ? 1,?i ?{1,...,T }?

?????
????

?
1
1 + ?

2
1 ? 1

?
1
2 + ?

2
2 ? 1

...
?

1
32 + ?

2
32 ? 1

?
j

i ? 0,?i ?{1,...,T },? j ?{1,...,|V (Ti)|?1}?

?????
????

?
1
1 ? 0, ?

2
1 ? 0

?
1
2 ? 0, ?

2
2 ? 0

...
?

1
32 ? 0, ?

2
32 ? 0

yi ? ?
|V (Ti)|?1
i ,?i ?{1,...,|T |?1}? y1 ? ?

2
1 , y2 ? ?

2
2 , ..., y31 ? ?

2
31

|V (Ti+1)|?1

?
j=1

?
j

i+1 ? yi,?i ?{1,...,|T |?1}?

?????
????

?
1
2 + ?

2
2 ? y1,

?
1
3 + ?

2
3 ? y2,

...
?

1
32 + ?

2
32 ? y31

yi ?{0,1},?i ?{1,...,|T |?1}? y1 ?{0,1}, y2 ?{0,1},..., y31 ?{0,1}

3.6 MODELO SOS2

Em um trabalho pioneiro, Beale e Tomlin (1970) propuseram
uma representac?a?o de func?o?es lineares por partes usando varia?veis de
peso ? ’s associadas aos ve?rtices no dom??nio da func?a?o para realizar
a combinac?a?o convexa, restringindo tais varia?veis tal que no ma?ximo
duas varia?veis ? sa?o diferentes de 0 e consecutivas em um procedimento
branch-and-bound. Este tipo de restric?a?o e? denominada restric?a?o com
conjunto de varia?veis especialmente ordenado do tipo II (SOS2), ou
simplesmente restric?o?es SOS2. Atualmente, alguns solvers de propo?sito
geral, a exemplo do CPLEX, da?o suporte a restric?o?es SOS2.

Camponogara, Nazari e Meneses (2012) apresentaram um exem-
plo que ilustra como uma restric?a?o SOS2 e? tratada em uma ramificac?a?o

em um procedimento branch-and-bound. Suponha que {? 0j ,...,?
k( j)
j }



80

sa?o SOS2 e seja {?? 0j ,??
1
j ,...,??

k( j)
j } a soluc?a?o da relaxac?a?o do problema,

onde apenas ?? k1 , ?? k2 &gt; 0 para k1,k2 ?{0,...,k( j)}, k1 &amp;lt;k2 e k2?k1 ? 2.
Esta violac?a?o de restric?o?es SOS2 pode ser incorporada ao branch-and-
bound introduzindo as restric?o?es ? 0j = ··· = ?

k1
j = 0 em um lado da

ramificac?a?o, e ?
k1+2
j = ··· = ?

k( j)
j = 0 do outro lado.

3.6.1 Caso Unidimensional

A formulac?a?o SOS2 para a func?a?o ilustrativa unidimensional e?
apresentada a seguir:

?
v?V (P)

?vv = x ? ?00 + ?11 + ?22 + ?33 + ?44 = x

?
v?V (P)

?v f (v) = f (x) ? ?08 + ?128 + ?214 + ?325 + ?421 = f (x)

?v ? 0,?v ? V (P) ? ?0 ? 0, ?1 ? 0, ?2 ? 0, ?3 ? 0, ?4 ? 0

?
v?V (P)

?v = 1 ? ?0 + ?1 + ?2 + ?3 + ?4 = 1

(?v)v?V (P) sa?o SOS2 ? (?v)v?{0,1,2,3,4} sa?o SOS2

Para a func?a?o ilustrativa da Figura 7, cada ve?rtice v ?V = {0,1,2,3,4}
do dom??nio possui uma varia?vel de peso associada ?v para realizar a
combinac?a?o convexa. As varia?veis {?v}v?V compo?em uma restric?a?o
SOS2. Neste caso, no ma?ximo duas varia?veis ?v, com v ? V , sa?o di-
ferentes de 0 e consecutivas ao longo da busca branch-and-bound. Por
exemplo, quando o politopo P1 = [0,1] estiver habilitado, apenas ?0 e
?1 podem ser diferentes de 0.

3.6.2 Caso Multidimensional

Beale (1980) mostrou como estender restric?o?es SOS2 para fun-
c?o?es lineares por partes multidimensionais usando cadeias ligadas de
restric?o?es SOS2. Esta ideia sera? apresentada para a func?a?o com dom??-
nio bidimensional ilustrada na Figura 8.

Seja X ={?2,?1,...,2} e Y ={?2,?1,...,2} os conjunto de bre-
akpoints do eixo x e y, respectivamente. O dom??nio da func?a?o bidimen-
sional e? particionado em uma grade G = X ×Y e, a cada ve?rtice v desta
grade, e? associada uma varia?vel de peso ?v. A Figura 11 ilustra a grade



81

G , onde ?v1,v2 com (v1,v2) ? G representa a varia?vel de peso associada
ao ve?rtice (v1,v2) da grade.

Figura 11: Dom??nio Bidimensional da Func?a?o Ilustrativa Particionado
em uma Grade

A func?a?o original ilustrada na Figura 8 pode ser aproximada por
meio do modelo SOS2, com o seguinte conjunto de equac?o?es:

x = ?
(v1,v2)?G

?v1,v2 (v1,v2) (3.17a)

f? = ?
(v1,v2)?G

?v1,v2 f (v1,v2) (3.17b)

?
(v1,v2)?G

?v1,v2 = 1 (3.17c)

Ale?m disto, e? necessa?rio impor as seguintes restric?o?es nas varia?veis ? :

?v1 = ?
v2?Y

?v1,v2 ,?v1 ? X (3.17d)

?v2 = ?
v1?X

?v1,v2 ,?v2 ?Y (3.17e)

(?v1 )X sa?o SOS2 (3.17f)

(?v2 )Y sa?o SOS2 (3.17g)

A restric?a?o SOS2 nos ? ’s assegura que somente os ? ’s correspondentes a
ve?rtices contidos em duas colunas vizinhas sejam diferentes de zero. De
forma similar, a restric?a?o SOS2 imposta nas varia?veis ? assegura que
apenas os ? ’s correspondentes dois ve?rtices contidos em linhas vizinhas
sejam diferentes de zero. O conjunto de equac?o?es a seguir aproxima a



82

func?a?o original com o modelo SOS2:

?
v?V (P)

?vv = x ?
{

??2,?2(?2,?2) + ??2,?1(?2,?1) +···
+?2,?2(2,?2) = x

?
v?V (P)

?v f (v) = f (x) ?
{

??2,?211.4074 + ??2,?17.7569
+···+ ?2,?2(?3.8463) = f (x)

?v ? 0,?v ? V (P) ? ??2,?2 ? 0, ??2,?1 ? 0, ..., ?2,?2 ? 0

?
v?V (P)

?v = ??2,?2 + ??2,?1 +···+ ?2,?2 = 1

?x = ?
y?Y

?x,y,?x ? X ?

?????
????

??2 = ??2,?2 + ??2,?1 +···+ ??2,2
??1 = ??1,?2 + ??1,?1 +···+ ??1,2

...
?2 = ?2,?2 + ?2,?1 +···+ ?2,2

?y = ?
x?X

?x,y,?y ?Y ?

?????
????

??2 = ??2,?2 + ??1,?2 +···+ ?2,?2
??1 = ??2,?1 + ??1,?1 +···+ ?2,?1

...
?2 = ??2,2 + ??1,2 +···+ ?2,2

(?x)X sa?o SOS2

(?y)Y sa?o SOS2

Note que, para o exemplo ilustrativo com dom??nio bidimensional, o m??-
nimo da func?a?o e? encontrado quando ??2,2 = 1 e os demais ? ’s assumem
valor 0. Quando isto acontece, ??2 = 1 e ?2 = 1, e as demais varia?veis
? , ? te?m valor 0.

3.7 TAMANHO DAS FORMULAC?O?ES

Nesta sec?a?o, sa?o apresentados os tamanhos das formulac?o?es es-
tudadas neste cap??tulo. As Tabelas 1 e 2 conte?m informac?o?es sobre
o tamanho das formulac?o?es em relac?a?o ao nu?mero de varia?veis cont??-
nuas e bina?rias e ao nu?mero de restric?o?es adicionais para cada modelo,
respectivamente.

Os tamanhos das formulac?o?es e? definido em func?a?o da dimensa?o
do dom??nio d, do nu?mero de politopos |P| e do nu?mero de ve?rtices
|V (P)| ou |V (P)|, para P ? P, com excec?a?o dos modelos Log, MC e
SOS2.

O tamanho do modelo MC e? uma func?a?o de d, |P| e do nu?mero



83

Modelo Varia?veis Adicionais Varia?veis Bina?rias
DCC |P|+ ?P?P |V (P)| |P|
DLog dlog2(|P|)e+ ?P?P |V (P)| dlog2(|P|)e
CC |V (P)|+|P| |P|
Log |V (P)|+|S| |S|
MC d +|P| |P|
Inc |P|?1 + ?P?P (|V (P)|?1) |P|?1

SOS2 |V (P)|+ d 0

Tabela 1: Nu?mero de Varia?veis

Modelo Restric?o?es Adicionais
DCC d + 2|P|+ ?P?P |V (P)|+ 2
DLog d + ?P?P |V (P)|+ 3dlog2(|P|)e+ 2
CC d + 2|V (P)|+|P|+ 3
Log d +|V (P)|+ 3|S|+ 2
MC d + ?P?P F (P) +|P|+ 2
Inc d + 4|P|+ ?P?P (|V (P)|?1)?2

SOS2 2d + K(G ) + 2

Tabela 2: Nu?mero de Restric?o?es

de facetas dos politopos P, denotado por F (P) em P. Em particular,
quando P e? uma triangulac?a?o, temos que |F (P)|? d + 1,?P ?P, onde
d e? a dimensa?o do dom??nio.

Para o Log, o tamanho da formulac?a?o e? uma func?a?o do nu?mero
de ve?rtices |V (P)| e de |S|, onde S e? uma ramificac?a?o para uma trian-
gulac?a?o J1 definida em [0,K]d . Para o caso bidimensional, por exemplo,
temos que |P| = Kd d! e |S| = ddlog2(K)e+ d(d ?1)/2. Para dimenso?es
com d &gt; 2, o valor de |S|? log2(|P|), ou seja, limK??

|S|/(log2(|P|) = 1
(VIELMA; AHMED; NEMHAUSER, 2010).

No modelo SOS2, o nu?mero de varia?veis adicionais varia tambe?m
em func?a?o do nu?mero total de breakpoints de cada eixo da grade G .
Para o exemplo ilustrativo com dom??nio bidimensional, o nu?mero de
varia?veis adicionais e? K(G ) = |X|+ |Y| = 10, onde X e Y representam o
nu?mero de breakpoints das coordenadas x e y da grade G do dom??nio.



84

3.8 SUMA?RIO

Neste cap??tulo, foi apresentada uma definic?a?o para func?o?es linea-
res por partes. Em seguida, foram estudados modelos lineares inteiros-
mistos para representar estas func?o?es. Ale?m disto, para cada modelo,
foram apresentadas formulac?o?es expl??citas para func?o?es ilustrativas com
dom??nios unidimensional e bidimensional. Por fim, foram apresentados
os tamanhos das formulac?o?es com relac?a?o ao nu?mero de varia?veis e
restric?o?es adicionais.



85

4 REFORMULAC?O?ES LINEARES POR PARTES

As na?o-linearidades do problema de alocac?a?o de ga?s sob res-
tric?o?es de pressa?o e de alinhamento descrito no Cap??tulo 2 aparecem
nas curvas de desempenho de poc?o (WPC) e nas func?o?es de queda de
pressa?o nas tubulac?o?es que conectam os manifolds de produc?a?o aos
separadores nas instalac?o?es da superf??cie. A complexidade computacio-
nal deste problema reside na natureza na?o-convexa e multidimensional
destas func?o?es e no conjunto de deciso?es discretas relacionadas com a
ativac?a?o de um poc?o ou com o roteamento entre poc?os, manifolds e
separadores para escoar os fluidos.

Func?o?es lineares por partes podem ser usadas para aproximar
func?o?es na?o-convexas. Problemas de otimizac?a?o que envolvem tais fun-
c?o?es podem ser modelados como programas lineares inteiros-mistos, que
podem ser resolvidos com algoritmos especializados ou com solvers de
propo?sito geral. Geralmente, a u?ltima abordagem tem vantagem sobre
a primeira, pois utiliza a tecnologia no estado da arte dispon??vel para
solucionar problemas lineares inteiros-mistos.

Neste cap??tulo sera?o apresentadas aproximac?o?es lineares inteiras-
mistas para o problema em questa?o com base nos modelos apresentados
no Cap??tulo 3. A primeira sec?a?o apresenta a reformulac?a?o linear inteira
mista completa para o problema, enquanto as demais sec?o?es apresentam
apenas a reformulac?a?o das restric?o?es que esta?o relacionadas com as
func?o?es na?o-convexas.

4.1 REFORMULAC?A?O COM O MODELO DCC

A vaza?o de l??quido qn,m de um poc?o n depende da pressa?o do
manifold m ao qual ele esta? conectado, pm, e da taxa de ga?s injetado no
poc?o, qni . A func?a?o da queda de pressa?o ?p

m(qm) nas tubulac?o?es que
conectam cada manifold m ao seu separador e? uma func?a?o na?o-linear
das vazo?es de ga?s, o?leo e a?gua.

As curvas de desempenho de poc?o e queda de pressa?o nas tubu-
lac?o?es sa?o aproximadas com func?o?es lineares por partes e o problema P
e? reformulado em um programa linear inteiro-misto baseado no modelo
DCC como segue:



86

P? DCC : max f? = ?
m?M

g(q?m)? ?
n?N

c(qni ) (4.1a)

s.t. : ?
n?N

qni ? q
max
i (4.1b)

Para todo n ? N :
lnyn ? qni ? unyn (4.1c)

?
m?Mn

zn,m = yn (4.1d)

?
m?Mn

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

qi = q
n
i (4.1e)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

pr ? pm,?m ? Mn (4.1f)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

pr + p
m,max(1?zn,m) ? pm,

?m ? Mn (4.1g)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

qn,m(qi, pr) = q?n,m,?m ? Mn

(4.1h)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.1i)

?
n,m,P
qi,pr

? 0,?m ? Mn, P ? P n,m, (qi, pr) ?V (P) (4.1j)

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

= yn,mP ,?m ? Mn,P ? P
n,m (4.1k)

?
P?Pn,m

yn,mP = zn,m,?m ? Mn (4.1l)

yn,mP ?{0,1},?m ? Mn,P ? P
n,m (4.1m)

yn ?{0,1} (4.1n)
zn,m ?{0,1},?m ? Mn (4.1o)



87

Para todo m ? M :

?
P?Pm

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw q

m
ko,kg,kw = q?

m (4.1p)

q?m = ?
n?Nm

q?n,m ? qm,S (4.1q)

?
P?Pm

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw ? p

m(qmko,kg,kw ) = ?? p
m

(4.1r)

pm,S + ??p
m

= pm (4.1s)

?
m,P
ko,kg,kw ? 0,?P ? P

m,(ko,kg,kw) ?V (P) (4.1t)

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw = y

m
P ,?P ? P

m (4.1u)

?
P?Pm

ymP = y
m (4.1v)

ym ? ?
n?Nm

zn,m (4.1w)

ymP ?{0,1},?P ? P
m (4.1x)

ym ?{0,1} (4.1y)

com as seguintes varia?veis:

• qni e? a taxa de ga?s de injec?a?o alocada ao poc?o n;

• yn e? 1 quando o poc?o n esta? produzindo, e 0 caso contra?rio;

• zn,m assume valor 1 se a produc?a?o do poc?o n e? direcionada ao
manifold m, e 0 caso contra?rio;

• q?n,mh e? a func?a?o que aproxima a vaza?o da fase h ? H enviada do
poc?o n para o manifold m, e q?n,m = (qn,mh : h ? H ) e? um vetor com
as vazo?es de todas as fases. A vaza?o de ga?s recebido pelo manifold
de produc?a?o e? a soma da taxa de ga?s de injetado no poc?o n (Inj)
e do ga?s proveniente do reservato?rio (R): qn,mg = q

n,m
g,R + q

n,m
g,Inj;

• q?m = ?
n?Nm

q?n,m e? a vaza?o total recebida dos poc?os conectados ao

manifold m para todas as fases;

• pm e? a pressa?o do manifold m;

• ? n,m,Pqi,pr e? uma varia?vel de peso associada a um par de breakpoints
em K n,m ×Rn,m no politopo P. Quando o manifold m recebe



88

produc?a?o do poc?o n, zn,m assume valor 1 e a sua combinac?a?o
convexa respectiva se torna ativa;

• yn,mP ( y
m
P ) e? uma varia?vel bina?ria associada a cada politopo P ?

P n,m(P m) que assume valor 1 quando a combinac?a?o convexa e? li-
mitada ao politopo P. De acordo com a Restric?a?o (4.1k), quando
isto acontece, apenas os ve?rtices de P podem ser parte da combi-
nac?a?o convexa que define a injec?a?o de ga?s no poc?o n e a pressa?o
do manifold relacionado m;

• ?m,Pko,kg,kw e? a varia?vel de peso associada ao ve?rtice (k
o,kg,kw) ?

V (P), com P ? P m;

• ym e? uma varia?vel bina?ria que recebe valor 1 quando o manifold
m recebe produc?a?o de algum poc?o.

para?metros:

• N e? o nu?mero de poc?os de petro?leo, N ={1,...,N} e Nm ?N e? o
subconjunto de poc?os cuja produc?a?o pode ser enviada ao manifold
m;

• M e? o nu?mero de manifolds, M = {1,...,M} e Mn ? M e? o sub-
conjunto de manifolds que podem receber produc?a?o do poc?o n.
A produc?a?o de cada manifold e? direcionada para um u?nico sepa-
rador.

• H = {o, g, w} possui as vazo?es multifa?sicas: o?leo (o), ga?s (g) e
a?gua (w);

• qmaxi e? a taxa de ga?s de injec?a?o dispon??vel nos compressores;

• ln e un sa?o os limites inferior e superior na injec?a?o de ga?s para
cada poc?o n;

• pm,S e? a pressa?o operacional do separador que recebe a produc?a?o
do manifold m;

• qmko,kg,kw e? a vaza?o de fluido para as fases de o?leo (k
o), ga?s (kg)

e a?gua (kw) para o ve?rtice (ko,kg,kw) pertencente ao dom??nio da
func?a?o de queda de pressa?o ?pm.

• qn,L e qn,U sa?o os limites inferior e superior para a vaza?o do poc?o
n;



89

• qm,S e? a capacidade de armazenamento do separador conectado
ao manifold m para cada fase de H ;

• P n,m e? o conjunto de politopos com os ve?rtices pertencentes a
K n,m ×Rn,m, onde K n,m e Rn,m sa?o os conjuntos de breakpoints
referentes a? vaza?o de ga?s de injec?a?o e a? variac?a?o da pressa?o do
manifold quando o poc?o n envia produc?a?o para o manifold m,
respectivamente;

• pm,max e? a pressa?o ma?xima do manifold m;

e func?o?es:

• f e? uma func?a?o com o benef??cio proveniente da produc?a?o dos
poc?os, que e? concentrada nos manifolds (g), descontado o custo
da injec?a?o de ga?s (c);

• qn,mh (p
m,qni ) e? a vaza?o da fase h enviada do poc?o n ao manifold

m, dado como uma func?a?o da pressa?o do manifold e da taxa de
ga?s injetado no poc?o n, com qn,m(pm,qni ) = (q

n,m
h (p

m,qni ) : h ? H )
sendo a func?a?o vetorial com as vazo?es de todas as fases.

• ?pm(qm) e? a func?a?o que representa a queda de pressa?o na tu-
bulac?a?o que conecta o manifold m ao separador que recebe sua
produc?a?o.

Note que as restric?o?es (2.1e) e (2.1f) do problema original foram
reformuladas no problema aproximado P? DCC com o conjunto de restri-
c?o?es (4.1e)?(4.1m). Estas restric?o?es expressam a aproximac?a?o linear
por partes da curva de desempenho do poc?o qn,m com o uso do modelo
DCC. As equac?o?es (2.1g) e (2.1h) do problema original tambe?m foram
reformuladas no problema aproximado P? DCC com o conjunto de restri-
c?o?es (4.1p)?(4.1x). Estas restric?o?es expressam a aproximac?a?o linear
por partes da curva de queda de pressa?o ? p(qm) nas tubulac?o?es com o
modelo DCC.

Nas sec?o?es seguintes deste cap??tulo apenas as reformulac?o?es li-
neares por partes das restric?o?es (2.1e)?(2.1h) do problema original P
sera?o apresentadas.

4.2 REFORMULAC?A?O COM O MODELO DLOG

Nesta sec?a?o, sera? apresentada a reformulac?a?o linear por partes
P? DLog do problema P com o uso do modelo DLog. A curva de desempe-
nho do poc?o qn,m e? aproximada por uma func?a?o linear por partes com



90

base no modelo DLog, como segue:

Para todo n ? N :

?
m?Mn

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

qi = q
n
i (4.2a)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

pr ? pm,?m ? Mn (4.2b)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

pr + p
m,max(1?zn,m) ? pm,?m ? Mn (4.2c)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

qn,m(qi, pr) = qn,m,?m ? Mn (4.2d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.2e)

?
n,m,P
qi,pr

? 0,?m ? Mn, P ? P n,m, (qi, pr) ?V (P) (4.2f)

?
P?Pn,m

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

= zn,m,?m ? Mn (4.2g)

?
P?P1,n,m(B,l)

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

? yl,?m ? Mn,l ? L (P n,m) (4.2h)

?
P?P0,n,m(B,l)

?
(qi,pr)?V (P)

?
n,m,P
qi,pr

? (1?yl ),?m ? Mn,l ? L (P n,m)

(4.2i)

yl ?{0,1},?m ? Mn,l ? L (P n,m) (4.2j)

tendo como varia?vel adicional:

• yl e? uma varia?vel bina?ria para a entrada l do co?digo bina?rio de
cada politopo que constro?i a ramificac?a?o das varia?veis de peso ? .

e para?metros:

• P 1,n,m(B,l) e P 0,n,m(B,l) representam os conjuntos de politopos
associados a? func?a?o injetora B que mapeia politopos em vetores
bina?rios, agrupando os politopos de acordo com o ??ndice l da sua
representac?a?o bina?ria B, onde P j,n,m(B,l) := {P ? P n,m : B(P)l =
j}, j ?{0,1};

• L (P n,m) := {1,...,dlog2 |P
n,m|e} e? o conjunto de ??ndices para os

vetores bina?rios que representam cada politopo P ? P n,m.

Por simplicidade, os para?metros, varia?veis e func?o?es ja? definidos previ-
amente na?o foram apresentados novamente. O conjunto de restric?o?es



91

(4.2a)-(4.2j) apresentadas acima reformulam as restric?o?es (2.1e) e (2.1f)
do problema original, aproximando a curva de desempenho do poc?o
qn,m(qi, pm).

Em seguida, a curva de queda de pressa?o nas tubulac?o?es ?p(qm) e?
aproximada com uma reformulac?a?o linear por partes baseada no modelo
DLog:

Para todo m ? M :

?
P?Pm

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw q

m
ko,kg,kw = q?

m (4.3a)

q?m = ?
n?Nm

q?n,m ? qm,S (4.3b)

?
P?Pm

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw ? p

m(qmko,kg,kw ) = ?? p
m

(4.3c)

pm,S + ?? p
m

= pm (4.3d)

?
m,P
ko,kg,kw ? 0,?P ? P

m,(ko,kg,kw) ?V (P) (4.3e)

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw = y

m,?P ? P m (4.3f)

ym ? ?
n?Nm

zn,m (4.3g)

?
P?P1,m(B,l)

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw ? yl,?l ? L (P

m) (4.3h)

?
P?P0,m(B,l)

?
(ko,kg,kw)?V (P)

?
m,P
ko,kg,kw ? (1?yl ),?l ? L (P

m) (4.3i)

ym ?{0,1} (4.3j)
yl ?{0,1},?l ? L (P m) (4.3k)

O conjunto de restric?o?es apresentados reformulam as restric?o?es (2.1g) e
(2.1h) do problema original, aproximando a curva de queda de pressa?o
nas tubulac?o?es ?pm(qm).

4.3 REFORMULAC?A?O COM O MODELO CC

Nesta sec?a?o, sera?o apresentadas as reformulac?o?es lineares das
restric?o?es na?o-lineares (2.1e) e (2.1f) do problema original com o uso
do modelo CC. As equac?o?es que expressam a curva de desempenho do



92

poc?o qn,m(qi, pr) sa?o reformuladas como segue:

Para todo n ? N :
qni = ?

m?Mn
?

qi?K n,m
?

pr?Rn,m
?

n,m
qi,pr

qi (4.4a)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr ? pm,?m ? Mn (4.4b)

pm ? ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr + p
m,max(1?zn,m),?m ? Mn (4.4c)

q?n,m = ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

qn,m(qi,pr),?m ? Mn (4.4d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.4e)

?
n,m
qi,pr
? 0,?m ? Mn,qi ? K n,m, pr ? Rn,m (4.4f)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

= zn,m,?m ? Mn, (4.4g)

?
n,m
qi,pr
? ?

P?Pn,m(qi,pr)
yn,mP ,?m ? Mn, qi ? K

n,m,pr ? Rn,m (4.4h)

?
P?Pn,m

yn,mP = zn,m,?m ? Mn (4.4i)

yn,mP ?{0,1},?m ? Mn,?P ? P
n,m (4.4j)

com para?metro adicional:

• P n,m(qi, pr) e? o conjunto dos politopos P ? P n,m que conte?m o
ve?rtice (qi, pr).

Para o modelo CC, a reformulac?a?o das equac?o?es (2.1g) e (2.1h)
referentes a? curva de queda de pressa?o ? pm(qm) e? dada a seguir: Para



93

todo m ? M :

q?m = ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw q

m
ko,kg,kw (4.5a)

q?m = ?
n?Nm

q?n,m ? qm,S (4.5b)

??p
m

= ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw ?p

m(qmko,kg,kw ) (4.5c)

pm = pm,S + ??p
m

(4.5d)

?
m
ko,kg,kw ? 0,?(k

o,kg,kw) ? V (P m) (4.5e)
?

m
ko,kg,kw ? ?

P?Pm(ko,kg,kw)
ymP ,?(k

o,kg,kw) ? V (P m) (4.5f)

?
P?Pm

ymP = y
m (4.5g)

?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw = y

m (4.5h)

ym ? ?
n?Nm

zn,m (4.5i)

ym ?{0,1} (4.5j)
ymP ?{0,1},?P ? P

m (4.5k)

tendo como para?metro adicional:

• P m(ko,kg,kw) e? o conjunto de politopos P ? P m que conte?m o
ve?rtice (ko,kg,kw).

Note que a reformulac?a?o das restric?o?es (2.1g) e (2.1h) do problema
original com o conjunto de restric?o?es apresentado acima aproxima a
curva de queda de pressa?o nas tubulac?o?es ? pm(qm).

4.4 REFORMULAC?A?O COM O MODELO LOG

Nesta sec?a?o, a func?a?o na?o-convexa qn,m(pm,qni ) e? aproximada com
uma func?a?o linear por parte com o uso do modelo Log apresentado na



94

Sec?a?o 3.3.2 como segue:

Para todo n ? N :
qni = ?

m?Mn
?

qi?K n,m
?

pr?Rn,m
?

n,m
qi,pr

qi (4.6a)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr ? pm,?m ? Mn (4.6b)

pm ? ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr + p
m,max(1?zn,m),?m ? Mn

(4.6c)

q?n,m = ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

qn,m(qi,pr),?m ? Mn

(4.6d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.6e)

?
n,m
qi,pr
? 0,?m ? Mn,qi ? K n,m,?pr ? Rn,m

(4.6f)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

= zn,m,?m ? Mn, (4.6g)

Para todo n ? N , m ? Mn, l ? ?(K n,m) :

?
qi?J

+
axis(K n,m ),B,l

?
pr?Rn,m

?
n,m
qi,pr
? xn,ml (4.6h)

?
qi?J0axis(K n,m ),B,l

?
pr?Rn,m

?
n,m
qi,pr
? (1?xn,ml ) (4.6i)

Para todo n ? N , m ? Mn, l ? ?(Rn,m) :

?
qi?K n,m

?
pr?J+axis(Rn,m ),B,l

?
n,m
qi,pr
? x?n,ml (4.6j)

?
qi?K n,m

?
pr?J0axis(Rn,m ),B,l

?
n,m
qi,pr
? (1? x?n,ml ) (4.6k)



95

Para todo n ? N , m ? Mn, ?(r,s) ? ?n,m :

?
(qi,pr)?L

n,m
r,s

?
n,m
qi,pr
? yn,mr,s (4.6l)

?
(qi,pr)?R

n,m
r,s

?
n,m
qi,pr
? (1?yn,mr,s ) (4.6m)

com as seguintes varia?veis adicionais:

• xn,ml (x?
n,m
l ) e? uma varia?vel bina?ria que induz a primeira fase da

ramificac?a?o do Log para cada ??ndice em l ? ?(K n,m) (?(Rn,m))
de B;

• yn,mr,s e? uma varia?vel bina?ria que induz a segunda fase da ramifica-
c?a?o do Log para cada par (r,s) ? ?n,m.

para?metros:

• ?(K n,m) := {1,...,dlog2(K
n,m)e} e ?(Rn,m) := {1,...,

dlog2(R
n,m)e} sa?o conjuntos de ??ndices;

• ?n,m := {(r,s) ? D2 : r &amp;lt;s}, sendo D := {1,...,d}, onde d e? a di-
mensa?o do dom??nio;

• L n,mr,s = {v ? V (P n,m) : vr e? par e vs e? ??mpar} e
R

n,m
r,s ={v?V (P n,m) : vr e? ??mpar e vs e? par}, ?r,s?D ={1,...,d},

r &amp;lt;s, onde d e? a dimensa?o do dom??nio.

e func?a?o adicional:

• axis(Q) e? o eixo que conte?m o conjunto de breakpoints Q.

O conjunto de restric?o?es acima lineariza as restric?o?es (2.1e) e (2.1f) do
problema original P. As restric?o?es (4.6h)-(4.6k) realizam a primeira fase
da ramificac?a?o do modelo Log, selecionando um quadrado no dom??nio
da func?a?o qn,m.

As restric?o?es (4.6l) e (4.6m) sa?o responsa?veis pela construc?a?o da
segunda fase da ramificac?a?o do modelo Log, selecionando um tria?ngulo
dentro do quadrado escolhido na primeira fase da ramificac?a?o.

Agora, a func?a?o na?o-linear ?pm(qm) e? aproximada com uma fun-
c?a?o linear por partes e as restric?o?es na?o lineares (2.1f) e (2.1g) do pro-
blema original sa?o reescritas em um programa linear inteiro-misto, com
base no modelo Log, conforme apresentado a seguir.



96

Para todo m ? M :

q?m = ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw q

m
ko,kg,kw (4.7a)

q?m = ?
n?Nm

q?n,m ? qm,S (4.7b)

??p
m

= ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw ?p

m(qmko,kg,kw ) (4.7c)

pm = pm,S + ??p
m

(4.7d)

?
m
ko,kg,kw ? 0,?(k

o,kg,kw) ? V (P m) (4.7e)
?

m
ko,kg,kw ? ?

P?Pm(ko,kg,kw)
ymP ,?(k

o,kg,kw) ? V (P m) (4.7f)

?
P?Pm

ymP = y
m (4.7g)

?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw = y

m (4.7h)

ym ? ?
n?Nm

zn,m (4.7i)

ym ?{0,1} (4.7j)
ymP ?{0,1},?P ? P

m (4.7k)

Para todo m ? M , ? ?{O,G,W}, l ? ?(?m) :

?
(ko,kg,kw)?V (Pm):k??J+axis(?m ),B,l

?
m
ko,kg,kw ? x

m,?
l (4.7l)

?
(ko,kg,kw)?V (Pm):k??J0axis(?m ),B,l

?
m
ko,kg,kw ? (1?x

m,?
l ) (4.7m)

Para todo m ? M , (r,s) ? ?m :

?
(ko,kg,kw)?L mr,s

?
m
ko,kg,kw ? y

m
r,s (4.7n)

?
(ko,kg,kw)?Rmr,s

?
m
ko,kg,kw ? (1?y

m
r,s) (4.7o)

tendo as seguintes varia?veis adicionais:

• xm,?l e? a varia?vel bina?ria que define a primeira fase da ramificac?a?o
do Log para a fase com ? ?{O,G,W} e para o ??ndice l ? ?(?m)



97

de B;

• ymr,s e? a varia?vel bina?ria que constro?i a segunda fase da ramificac?a?o
do Log para cada par (r,s) ? ?m.

para?metros adicionais:

• Om, Gm e W m sa?o os conjuntos de breakpoints referentes ao ma-
nifold m para as fases de o?leo, ga?s e a?gua, respectivamente. O
conjunto de ve?rtices do dom??nio da func?a?o de queda de pressa?o
?pm(qm) e? definido como V (P m) = Om ×Gm ×W m;

• P m(ko,kg,kw) e? o conjunto de politopos P ? P m que conte?m o
ve?rtice (ko,kg,kw);

• L mr,s := {v ? V (P m) : vr e? par,vs e? ??mpar}, ?r,s ? D = {1,...,d},
com r &amp;lt;s, onde d e? a dimensa?o do dom??nio;

• Rmr,s := {v ? V (P m) : vr e? ??mpar,vs e? par}, ?r,s ? D = {1,...,d},
com r &amp;lt;s, onde d e? a dimensa?o do dom??nio.

As restric?o?es (4.7l) e (4.7m) induzem a primeira fase da ramifica-
c?a?o do modelo Log, na qual o dom??nio e? condicionado a um hipercubo.
As restric?o?es (4.7n) e (4.7o) implementam a segunda fase da ramifica-
c?a?o, na qual um tetraedro e? escolhido dentro do hipercubo selecionado
na primeira fase. Este esquema de ramificac?a?o constro?i uma fam??lia de
politopos compat??vel com a Triangulac?a?o J1.

4.5 REFORMULAC?A?O COM O MODELO MC

Nesta sec?a?o, a func?a?o na?o-convexa qn,m(pm,qni ) sera? aproximada
com uma func?a?o linear por partes com o uso do modelo MC apresen-
tado na Sec?a?o 3.4. O conjunto de equac?o?es que aproximam a func?a?o
qn,m(pm,qni ) com o modelo MC e? apresentado a seguir:



98

Para todo n ? N :

?
m?Mn

?
P?Pn,m

qn,m,Pi = q
n
i (4.8a)

?
P?Pn,m

pn,m,Pr ? p
m,?m ? Mn (4.8b)

pm ? ?
P?Pn,m

pn,m,Pr + p
m,max(1?zn,m),?m ? Mn (4.8c)

?
P?Pn,m

(
mn,mP

[
qn,m,Pi
pn,m,Pr

]
+ cn,m,P y

n,m
P

)
= q?n,m,?m ? Mn (4.8d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.8e)

An,mP

[
qn,m,Pi
pn,m,Pr

]
? bn,mP y

n,m
P ,?m ? Mn, P ? P

n,m (4.8f)

?
P?Pn,m

yn,mP = zn,m,?m ? Mn (4.8g)

qn,m,Pi ? 0, p
n,m,P
r ? 0,?m ? Mn, P ? P

n,m (4.8h)

yn,mP ?{0,1},?m ? Mn, P ? P
n,m (4.8i)

com varia?veis adicionais:

• qn,m,Pi e? uma varia?vel cont??nua que representa a injec?a?o de ga?s em
um poc?o n para o politopo P ? P n,m;

• pn,m,Pr e? uma varia?vel cont??nua que representa a pressa?o do mani-
fold m no politopo P ? P n,m;

• yn,mP e? uma varia?vel bina?ria que recebe o valor 1 quando o politopo
P ? P n,m esta? ativo e 0, caso contra?rio.

e para?metros adicionais:

• mn,mP e? o vetor com os coeficientes para o hiperplano que aproxima
a func?a?o qn,m no politopo P ? P n,m;

• cn,mP e? o coeficiente linear do hiperplano que aproxima a func?a?o
qn,m no politopo P ? P n,m;

• An,mP e b
n,m
P sa?o as matrizes e os vetores de coeficientes das inequa-

c?o?es lineares que definem o politopo P ? P n,m, os quais podem
ser de qualquer fam??lia de politopo, a exemplo de hipercubos ou
simplexes;



99

A seguir, e? apresentada uma aproximac?a?o baseada no modelo
MC para a func?a?o da queda de pressa?o ?pm(qm) nas tubulac?o?es que
conectam os manifolds aos separadores:

Para todo m ? M :

?
P?Pm

qm,P = q?m (4.9a)

q?m = ?
m?Nm

q?n,m ? qm,S (4.9b)

?? p
m

= ?
P?Pm

?
?mmP

?
? qm,Pgqm,Po

qm,Pw

?
?+ cmP ymP

?
? (4.9c)

pm = pm,S + ??p
m

(4.9d)

AmP

?
? qm,Pgqm,Po

qm,Pw

?
?? bmP ymP ,?P ? P m (4.9e)

?
P?Pm

ymP = y
m (4.9f)

ym ? ?
n?Nm

zn,m (4.9g)

qm,P =
(
qm,Pg ,q

m,P
o ,q

m,P
w
)
? 0,?P ? P m (4.9h)

ymP ?{0,1},?P ? P
m (4.9i)

ym ?{0,1} (4.9j)

com varia?veis adicionais:

• qmP =
(

qmP,g,q
m
P,o,q

m
P,w

)
e? um vetor que conte?m as varia?veis cont??nuas

que representam as vazo?es de ga?s, o?leo e a?gua, respectivamente,
na tubulac?a?o que conecta o manifold m ao seu separador, dentro
de um politopo P ? P m;

• ymP e? uma varia?vel bina?ria que recebe o valor 1 quando o politopo
P ? P m esta? ativo e 0, caso contra?rio.

e para?metros adicionais:

• mmP conte?m os coeficientes do vetor normal do hiperplano que
aproxima a func?a?o ?pm(qmP ) no politopo P ? P

m;



100

• cmP e? o coeficiente linear do hiperplano que aproxima a func?a?o
? pm(qmP ) no politopo P ? P

m;

• AmP e b
m
P sa?o os coeficientes das inequac?o?es lineares que definem

o politopo P ? P m, os quais podem ser de qualquer fam??lia de
politopo, a exemplo de hipercubos ou simplexes;

4.6 REFORMULAC?A?O COM O MODELO INC

Nesta sec?a?o sera?o apresentadas as equac?o?es baseadas no modelo
Inc que aproximam as func?o?es na?o convexas qn,m e qm. O conjunto de
equac?o?es a seguir aproxima a func?a?o qn,m:

Para todo n ? N :

qni = q
1,0
i,n,m + ?

m?Mn

|T n,m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

n,m

(
q j,ki,n,m ?q

j,0
i,n,m

)
(4.10a)

p1,0r,n,m +
|T n,m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

n,m

(
p j,kr,n,m ? p

j,0
r,n,m

)
? pm,?m ? Mn (4.10b)

pm ? p1,0r,n,m +
|T n,m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

n,m

(
p j,kr,n,m ? p

j,0
r,n,m

)
+ pm,max(1?zn,m),?m ? Mn (4.10c)

q?n,m = qn,m(q1,0i,n,m, p
1,0
r,n,m) +

|T n,m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

n,m(
qn,m(q j,ki,n,m, p

j,k
r,n,m)? q

n,m(q j,0i,n,m, p
j,0
r,n,m)

)
,?m ? Mn (4.10d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.10e)

|V (T1)|?1

?
k=1

?
1,k
n,m ? zn,m,?m ? Mn (4.10f)

?
j,k

n,m ? 0,?m ? Mn, j ?{1,...,|T
n,m|}, k ?{1,...,|V (Tj)|?1}

(4.10g)



101

w jn,m ? ?
j,|V (Ti)|?1

n,m ,?m ? Mn, j ?{1,...,|T |?1} (4.10h)
|V (Tj )|?1

?
k=1

?
j+1,k

n,m ? w
j
n,m,?m ? Mn, j ?{1,...,|T

n,m|?1} (4.10i)

w jn,m ?{0,1},?m ? Mn, j ?{1,...,|T
n,m|?1}. (4.10j)

tendo como varia?veis:

• ? j,kn,m e? uma varia?vel cont??nua de peso que, incrementalmente, con-
diciona o dom??nio a apenas um politopo;

• w jn,m e? uma varia?vel bina?ria que recebe valor 1 quando as varia?veis
de peso ?

j?,k
n,m dos simplexes Tj? ? T n,m com j? &amp;lt;j recebem valor 1.

Neste caso, o simplex ativo e? o Tj+1.

e para?metros adicionais:

• q j,ki,n,m e? o breakpoint de injec?a?o de ga?s correspondente ao ve?rtice k
do simplex j;

• p j,kr,n,m e? o breakpoint de pressa?o do manifold m correspondente ao
ve?rtice k do simplex j;

• T n,m e? o conjunto de simplexes que compo?em a fam??lia de poli-
topos do dom??nio da func?a?o de vaza?o do poc?o n para o manifold
m qn,m;

• V (T ) e? o conjunto de ve?rtices do simplex T ?T n,m. A rigor, teria-
se que utilizar a notac?a?o T n,m ? T n,m, pore?m deixa-se T para na?o
sobrecarregar a notac?a?o.



102

A seguir, a func?a?o ?pm(qm) e? aproximada, atrave?s da reformula-
c?a?o das equac?o?es (2.1g) e (2.1h) com o modelo Inc:

Para todo m ? M :

q?m = q1,0m +
|T m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

m

(
q j,km ?q

j,0
m

)
(4.11a)

q?m = ?
n?Nm

q?n,m ? qm,S (4.11b)

??p
m

= ?pm(q1,0m ) +
|T m|

?
j=1

|V (Tj )|?1

?
k=1

?
j,k

m

(
?pm(q j,km )??p

m(q j,0m )
)

(4.11c)

pm = pm,S + ??p
m

(4.11d)

ym ? ?
n?Nm

zn,m (4.11e)

|V (T1)|?1

?
k=1

?
1,k
m ? y

m (4.11f)

?
j,k

m ? 0,? j ?{1,...,|T
m|},?{1,...,|V (Tj)|?1} (4.11g)

w jm ? ?
j,|V (Tj )|?1

m ,? j ?{1,...,|T m|?1} (4.11h)

?
k=1

?
j+1,k

m ? w
j
m,? j ?{1,...,|T

m|?1} (4.11i)

w jm ?{0,1},? j ?{1,...,|T
m|?1} (4.11j)

tendo como varia?veis adicionais:

• ? j,km e? uma varia?vel cont??nua de peso que, incrementalmente, con-
diciona o dom??nio a apenas um politopo ou simplex Tj ? T m. A
rigor, teria que ser T mj , mas vamos deixar Tj para na?o sobrecarre-
gar a notac?a?o;

• w jm e? uma varia?vel bina?ria que recebe valor 1 quando as varia?veis
de peso ?

j?,k
m dos simplexes Tj? ? T m com j? &amp;lt;j recebem valor 1.

Neste caso, o simplex ativo e? o Tj+1.

e para?metros adicionais:

• q j,km = (q
j,k
m,g,q

j,k
m,o,q

j,k
m,w) e? um vetor que conte?m as varia?veis cont??-

nuas que representam as vazo?es de ga?s, o?leo e a?gua, respectiva-
mente em um ve?rtice k de um simplex Tj ? T m;



103

• T m e? o conjunto de simplexes que compo?em a fam??lia de politopos
do dom??nio da func?a?o de queda de pressa?o ?pm(qm) na tubulac?a?o
que conectam o manifold m ao seu separador;

• V (T ) e? o conjunto de ve?rtices do simplex T ? T m. A rigor, teria-
se que usar T m, mas vamos deixar T para na?o sobrecarregar a
notac?a?o.

4.7 REFORMULAC?A?O COM O MODELO SOS2

Nesta sec?a?o, sera?o apresentadas as reformulac?o?es lineares das
restric?o?es na?o-lineares do problema original com o uso do modelo SOS2.
As equac?o?es que expressam a curva de desempenho do poc?o qn,m(qi, pr)
sa?o reformuladas como segue:

Para todo n ? N :
qni = ?

m?Mn
?

qi?K n,m
?

pr?Rn,m
?

n,m
qi,pr

qi (4.12a)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr ? pm,?m ? Mn (4.12b)

pm ? ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

pr + p
m,max(1?zn,m),?m ? Mn (4.12c)

q?n,m = ?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

qn,m(qi, pr),?m ? Mn (4.12d)

ynqn,L ? ?
m?Mn

q?n,m ? ynqn,U (4.12e)

?
n,m
qi,pr
? 0,?qi ? K n,m,?m ? Mn, pr ? Rn,m (4.12f)

?
qi?K n,m

?
pr?Rn,m

?
n,m
qi,pr

= zn,m,?m ? Mn, (4.12g)

?
n,m
qi

= ?
pr?Rn,m

?qi,pr ,?qi ? K
n,m (4.12h)

?
n,m
pr = ?

qi?K n,m
?qi,pr ,?pr ? R

n,m (4.12i)

(
?

n,m
qi

)
K n,m

sa?o SOS2 (4.12j)(
?

n,m
pr

)
Rn,m

sa?o SOS2 (4.12k)

tendo como varia?veis adicionais:

• ? n,mqi e? uma varia?vel cont??nua auxiliar que representa a soma das



104

varia?veis de peso ?q?i,pr
tal que q?i = qi.

• ? n,mpr e? uma varia?vel cont??nua auxiliar que representa a soma das
varia?veis de peso ?qi,p?r tal que p

?
r = pr.

As varia?veis auxiliares ?
n,m
qi e ?

n,m
pr compo?em a cadeia ligada de

conjuntos de varia?veis especialmente ordenadas do tipo 2 e induzem a
construc?a?o de uma grade, de forma semelhante a? ilustrac?a?o apresen-
tada na Figura 11. As restric?o?es SOS2 (4.12j) e (4.12k) garantem que
a combinac?a?o convexa das varia?veis de peso ?qi,pr associadas a cada
ve?rtice (qi, pr) estara?o limitadas a apenas um politopo, um quadrado
neste caso, do dom??nio.

A reformulac?a?o das equac?o?es (2.1g) e (2.1h) referentes a? curva
de queda de pressa?o ? pm(qm), com o modelo SOS2, e? apresentada a
seguir:

Para todo m ? M :

q?m = ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw q

m
ko,kg,kw (4.13a)

q?m = ?
n?Nm

q?n,m ? qm,S (4.13b)

??p
m

= ?
(ko,kg,kw)?V (Pm)

?
m
ko,kg,kw ?p

m(qmko,kg,kw ) (4.13c)

pm = pm,S + ??p
m

(4.13d)

?
m
ko,kg,kw ? 0,?(k

o,kg,kw) ? V (P)m (4.13e)
?

m
o = ?

(ko,kg,kw)?V (Pm):o=ko
?

m
ko,kg,kw ,?o ? O

m (4.13f)

?
m
g = ?

(ko,kg,kw)?V (Pm):g=kg
?ko,kg,kw ,?g ? Gm (4.13g)

?
m
w = ?

(ko,kg,kw)?V (Pm):w=kw
?ko,kg,kw ,?w ?W m (4.13h)

ym ? ?
n?Nm

zn,m (4.13i)

?
(ko,kg,kw)?Pm

?
m
ko,kg,kw = y

m (4.13j)

ym ?{0,1} (4.13k)



105

(? mo )Om sa?o SOS2 (4.13l)(
?

m
g
)

Gm
sa?o SOS2 (4.13m)

(? mw )W m sa?o SOS2 (4.13n)

tendo como varia?veis adicionais:

• ? mo e? uma varia?vel cont??nua auxiliar que representa a soma das
varia?veis de peso ?mko,kg,kw tal que k

o = o para o ? O m;

• ? mg e? uma varia?vel cont??nua auxiliar que representa a soma das
varia?veis de peso ?mko,kg,kw tal que k

g = g para g ? G m;

• ? mw e? uma varia?vel cont??nua auxiliar que representa a soma das
varia?veis de peso ?mko,kg,kw tal que k

w = w para w ? W m.

e para?metros adicionais:

• Om, Gm e W m sa?o os breakpoints de o?leo, ga?s e a?gua, respectiva-
mente, que compo?em o dom??nio da func?a?o de queda de pressa?o
?pm(qm) na tubulac?a?o que conecta o manifold m ao seu separador,
sendo V (P m) = Om ×Gm ×W m.

4.8 SUMA?RIO

Neste cap??tulo foram propostas aproximac?o?es lineares por partes
para as func?o?es na?o-lineares qn,m(qi, pr) e ?pm(qm) do problema na?o-
linear inteiro-misto de alocac?a?o de ga?s sob restric?o?es de alinhamento e
de pressa?o formulado na Sec?a?o 2.3. Para modelar estas func?o?es lineares
por partes, foram propostas reformulac?o?es lineares inteiras-mistas do
Problema P com base nos modelos apresentados no Cap??tulo 3.

As formulac?o?es MILP propostas neste trabalho e contidas neste
cap??tulo compo?em uma contribuic?a?o na a?rea de otimizac?a?o da produc?a?o
de petro?leo para a soluc?a?o do problema de alocac?a?o de ga?s de injec?a?o
sob restric?o?es de alinhamento e de pressa?o.



106



107

5 ANA?LISE COMPUTACIONAL

Este cap??tulo apresenta uma ana?lise computacional das formu-
lac?o?es lineares inteiras-mistas desenvolvidas no Cap??tulo 4 no contexto
do problema de alocac?a?o de ga?s sob restric?o?es de alinhamento e de pres-
sa?o apresentado no Cap??tulo 2. O cena?rio desenvolvido para analisar o
desempenho computacional dos modelos e? um sistema de produc?a?o de
um campo de petro?leo sinte?tico modelado com o uso de um simulador
de escoamento multifa?sico.

Este cap??tulo foi estruturado da seguinte forma: a primeira parte
apresenta a modelagem do sistema de produc?a?o; em seguida, sa?o apre-
sentados os resultados de desempenho dos modelos para aproximac?o?es
com hipercubos e simplexes. Por fim, e? feita uma ana?lise geral dos
modelos com ambas as aproximac?o?es, discutindo-se a relac?a?o de custo-
benef??cio entre a qualidade da aproximac?a?o e o desempenho computa-
cional.

5.1 SISTEMA DE PRODUC?A?O

O sistema de produc?a?o possui N = 16 poc?os e M = 2 manifolds,
onde todos os poc?os podem ser alinhados para os dois manifolds de
produc?a?o, ou seja, Nm = N para todo m ? M . O campo possui dois
separadores, um para cada manifold. Ha? um compressor que envia o
ga?s para um manifold de injec?a?o, o qual distribui o ga?s para os 16
poc?os. A rede de produc?a?o e? ilustrada na Figura 12.

Os poc?os e os manifolds do sistema de produc?a?o esta?o topologica-
mente divididos em dois grupos: os poc?os 1-8 esta?o a 1 km de dista?ncia
do manifold 1, e a 10 km de dista?ncia do manifold 2, enquanto os poc?os
de 9-16 esta?o a 1 km do manifold 2 e a 10 km do manifold 1. As tu-
bulac?o?es que conectam os poc?os aos manifolds possuem 4 polegadas de
dia?metro interno (DI) e 0,001 polegadas de rugosidade (R) . Com esta
estrutura topolo?gica, se o poc?o n esta? mais pro?ximo do manifold m1 do
que do manifold m2, enta?o qn,m1 (p,qi) ? qn,m2 (p,qi) para uma pressa?o
p no manifold e uma injec?a?o de ga?s qi.

Todos os poc?os possuem a raza?o ga?s-o?leo (RGO) e a frac?a?o de
a?gua (BSW) constantes para as diferentes taxas de injec?a?o de ga?s e
variac?o?es na pressa?o do manifold. A vaza?o de l??quido de cada poc?o e?
regida pela equac?a?o ql = pi(pr ?pw f ), onde ql = qo + qw, pw f e? a pressa?o
no fundo do poc?o, pi e? o ??ndice de produtividade do poc?o, e pr e? a



108

Figura 12: Rede de Produc?a?o com Injec?a?o de Ga?s.

pressa?o esta?tica do reservato?rio.
Estes para?metros sa?o apresentados na Tabela 3, onde as unida-

des para RGO, BSW, pr e pi sa?o sm3/sm3, %, psi, and STB/d/psi,
respectivamente.

Tabela 3: Para?metros dos Poc?os

n RGO BSW pr pi n RGO BSW pr pi
1 200 0 2100 15 9 200 10 1900 5
2 200 20 2300 2 10 200 40 2200 9
3 300 10 1950 12 11 300 0 1850 11
4 300 40 2050 15 12 300 20 2300 6
5 400 0 1750 4 13 400 10 1825 14
6 400 20 1700 9 14 400 40 2200 7
7 500 10 1700 11 15 500 0 1600 8
8 500 40 2100 10 16 500 20 1800 5

A tubulac?a?o que conecta o manifold 1 ao seu separador possui um
comprimento de 100 m, enquanto a tubulac?a?o que conecta o manifold
2 ao seu separador mede 50 m. Ambos possuem elevac?a?o desprez??vel,
ID = 4,5 polegadas, e R = 0,001 polegadas. A pressa?o absoluta dos



109

manifolds pode variar de 300 a 800 psi de acordo com as condic?o?es
operacionais, enquanto a pressa?o nominal do separador e? 300 psi.

Todos os poc?os possuem tubulac?o?es ide?nticas com as seguintes
caracter??sticas: ID de 3 polegadas, profundidade de perfurac?a?o de 3,7
km, profundidade de 2,7 km, e ponto de injec?a?o a 2,8 km. A maior
taxa de vaza?o de ga?s permitida para cada poc?o e? de 8000 Mscf/d.

As curvas usadas para representar este sistema de produc?a?o es-
ta?o dispon??veis em (SILVA A. CODAS, 2011) em formato AMPL. Esta
insta?ncia foi obtida com o uso do software Schlumberger Pipesim, ins-
pirado em uma insta?ncia sinte?tica apresentada em (KOSMIDIS; PER-
KINS; PISTIKOPOULOS, 2004).

5.2 ANA?LISE DE DESEMPENHO

Esta sec?a?o apresenta uma ana?lise computacional das formula-
c?o?es lineares inteiras-mistas apresentadas no Cap??tulo 4 para o cena?rio
apresentado na sec?a?o anterior. Essas formulac?o?es foram escritas na lin-
guagem de programac?a?o matema?tica AMPL e resolvidas com o solver
de programac?a?o inteira-mista CPLEX 11 em uma estac?a?o de trabalho
com sistema operacional Linux, com processador Intel Core 2 Quad
3.0GHz e com 4GB de memo?ria RAM. Todos os experimentos foram
executados com um limite de tempo de 10.000 segundos (? 2,78 horas).

Para fins de comparac?a?o do desempenho das formulac?o?es, foram
analisados o impacto da variac?a?o da capacidade de compressa?o de ga?s e
da quantidade de politopos usados para representar as func?o?es lineares
por partes multidimensionais. A primeira ana?lise avalia como o desem-
penho dos modelos varia em func?a?o da limitac?a?o de ga?s de injec?a?o no
sistema, enquanto a segunda ana?lise tem o intuito de analisar o tempo
de execuc?a?o dos modelos quando a qualidade da aproximac?a?o se torna
mais fina e, consequentemente, o nu?mero de varia?veis adicionais do pro-
blema aumenta. Para a primeira ana?lise, foram considerados tre?s n??veis
de capacidade de compressa?o de ga?s no compressor:

Capacidade de Compressa?o Alta: Na?o ha? limite para a vaza?o de
ga?s de injec?a?o;

Capacidade de Compressa?o Me?dia: A vaza?o de ga?s de injec?a?o dis-
pon??vel no compressor e? a metade da vaza?o necessa?ria para injetar
o ma?ximo poss??vel em todos os poc?os;

Capacidade de Compressa?o Baixa: A capacidade de compressa?o
de ga?s para todo o sistema e? o equivalente ao ma?ximo de ga?s que



110

se pode injetar em um u?nico poc?o.

Para a segunda ana?lise, os dom??nios das func?o?es lineares por par-
tes foram particionados em politopos caracterizados como hipercubos e
simplexes. Foram considerados tre?s n??veis de qualidade de aproximac?a?o
das func?o?es lineares por partes que aproximam as func?o?es qn,m(pm,qni )
e ?pm(qm):

Qualidade Baixa: Uma aproximac?a?o com hipercubos foi considerada
com qualidade baixa quando possui 18 politopos (6 breakpoints de
injec?a?o de ga?s e 3 breakpoints de pressa?o no manifold ) no dom??nio
da func?a?o qn,m(pm,qni ) e 25 (5 breakpoints para cada fase do fluido)
politopos no dom??nio da func?a?o ? pm(qm). Para representar o
mesmo dom??nio, uma aproximac?a?o com simplexes considerada
de qualidade baixa possui 36 politopos (o dobro do nu?mero de
quadrados) no dom??nio da func?a?o qn,m(pm,qni ) e 150 (6 vezes o
nu?mero de cubos) politopos no dom??nio da func?a?o ? pm(qm);

Qualidade Me?dia: Para uma qualidade me?dia, a aproximac?a?o com
hipercubos representa o dom??nio da func?a?o qn,m(pm,qni ) com 66
politopos (11 breakpoints de injec?a?o de ga?s e 6 breakpoints de
pressa?o no manifold ) e o dom??nio da func?a?o ?pm(qm) com 1000
politopos (10 breakpoints para cada fase do fluido). A represen-
tac?a?o do dom??nio por simplexes para a qualidade me?dia possui
132 (o dobro do nu?mero de quadrados) politopos no dom??nio da
func?a?o qn,m(pm,qni ) e 6000 (6 vezes o nu?mero de cubos) politopos
no dom??nio da func?a?o ?pm(qm);

Qualidade Fina: Para uma qualidade fina, a aproximac?a?o com hi-
percubos representa o dom??nio da func?a?o qn,m(pm,qni ) com 180
(15 braekpoints de injec?a?o de ga?s e 12 breakpoints de pressa?o no
manifold ) politopos e o dom??nio da func?a?o ?pm(qm) com 2197
politopos (13 breakpoints para cada fase do fluido) . A represen-
tac?a?o do dom??nio por simplexes para a qualidade fina possui 360
(o dobro do nu?mero de quadrados) politopos no dom??nio da fun-
c?a?o qn,m(pm,qni ) e 13182 (6 vezes o nu?mero de cubos) politopos no
dom??nio da func?a?o ?pm(qm).

Note que a representac?a?o do mesmo dom??nio para uma qualidade de
aproximac?a?o similar possui um nu?mero diferente de politopos para a
representac?a?o com hipercubos e simplexes. Para a aproximac?a?o da
func?a?o qn,m(pm,qni ) com dom??nio bidimensional, cada quadrado do do-
m??nio e? particionado em dois tria?ngulos. Para a aproximac?a?o da func?a?o



111

?pm(qm) com dom??nio tridimensional, cada cubo e? particionado em 6
tetraedros. Portanto, dentre as aproximac?o?es, a representac?a?o do do-
m??nio por simplexes e? mais fina.

Inicialmente, e? feita uma comparac?a?o dos modelos DCC, DLog,
CC e SOS2 com a aproximac?a?o por hipercubos. Em seguida, os mode-
los DCC, DLog, CC, Log e MC sa?o aproximados com uma fam??lia de
politopos que e? compat??vel com a triangulac?a?o J1 e analisados quanto
ao seu desempenho computacional. A parte final desta sec?a?o compara
o desempenho de ambas as aproximac?o?es e discute a qualidade de apro-
ximac?a?o de cada abordagem.

A Sec?a?o A.3 do Ape?ndice apresenta os tamanhos das formulac?o?es
desenvolvidas, considerando o nu?mero de varia?veis cont??nuas, bina?rias
e de restric?o?es do problema para as diferentes qualidades de aproxi-
mac?a?o. Os para?metros usados no problema de otimizac?a?o, bem como
as soluc?o?es obtidas para as aproximac?o?es por simplexes e hipercubos,
considerando as diferentes qualidades, sa?o apresentados na Sec?a?o A.4
do Ape?ndice.

5.2.1 Aproximac?a?o por Hipercubos

Nesta sec?a?o, sera? feita uma ana?lise computacional dos modelos
DCC, DLog, CC e SOS2 com hipercubos para o problema de alocac?a?o
de ga?s discutido no Cap??tulo 2. As formulac?o?es que falharem ao tentar
encontrar uma soluc?a?o o?tima para o problema por excesso de memo?ria
sera?o apresentadas nas tabelas com um asterisco (*).

A primeira parte desta sec?a?o tem como objetivo analisar o de-
sempenho computacional dos modelos com a variac?a?o da capacidade
de compressa?o de ga?s, enquanto a segunda faz uma ana?lise do desem-
penho com relac?a?o a? variac?a?o do nu?mero de politopos, considerando a
evoluc?a?o do GAP dual no tempo.

5.2.1.1 Variac?a?o da Capacidade de Compressa?o de Ga?s

Nesta sec?a?o, o desempenho computacional dos modelos e? ana-
lisado com diferentes taxas dispon??veis no compressor para injec?a?o de
ga?s. As Tabelas 4, 5 e 6 apresentam os tempos de execuc?a?o (em se-
gundos) de cada formulac?a?o para resolver o problema de otimizac?a?o
da produc?a?o para uma qualidade de aproximac?a?o baixa, me?dia e alta,
respectivamente, variando-se a capacidade de compressa?o de ga?s de in-



112

jec?a?o. Nessas tabelas tambe?m e? apresentado o GAP dual da soluc?a?o
encontrada dentro do tempo limite de 10.000 segundos (? 2,77 horas).

Tabela 4: Aproximac?a?o com Hipercubos com Qualidade Baixa

Alta Me?dia Baixa

DCC
Tempo (s) 21,47 21,14 553,58
GAP (%) 0 0 0

DLog
Tempo (s) 21,11 17,05 144,38
GAP (%) 0 0 0

CC
Tempo (s) 17,66 12,98 893,37
GAP (%) 0 0 0

SOS2
Tempo (s) 5,90 6,57 238,99
GAP (%) 0 0 0

Analisando-se os dados da Tabela 4, os quais sa?o referentes a?
aproximac?a?o com qualidade baixa, pode-se notar que todos os modelos
conseguem encontrar a soluc?a?o o?tima para todas as capacidades de
compressa?o de ga?s no compressor. Para as capacidades de compressa?o
de ga?s alta e me?dia, os modelos tiveram desempenho similar, sendo o
SOS2 o modelo com o melhor desempenho. Com uma capacidade de
compressa?o de ga?s baixa, o problema se torna mais restrito e os modelos
levam mais tempo para encontrar a soluc?a?o o?tima. Neste caso, o modelo
DLog teve um desempenho melhor.

Tabela 5: Aproximac?a?o com Hipercubos com Qualidade Me?dia

Alta Me?dia Baixa

DCC
Tempo (s) 276,61 397,94 10.000
GAP (%) 0 0 2,41

DLog
Tempo (s) 7.460,58 10.000 10.000
GAP (%) 0 0,03 0,12

CC
Tempo (s) 105,22 53,17 10.000
GAP (%) 0 0 9,91

SOS2
Tempo (s) 21,11 28,68 367,44
GAP (%) 0 0 0

Analisando-se os dados da Tabela 5, a qual apresenta os resul-
tados para uma qualidade de aproximac?a?o me?dia, pode-se notar que
todos os modelos convergem para a soluc?a?o o?tima com a capacidade de
compressa?o de ga?s alta. Com capacidade de compressa?o de ga?s me?dia,



113

apenas o modelo Dlog na?o encontra a soluc?a?o o?tima. Para uma capa-
cidade de compressa?o de ga?s baixa, apenas o modelo SOS2 conseguiu
encontrar a soluc?a?o o?tima. O modelo CC teve um desempenho melhor
que o DCC para os cena?rios com capacidades de compressa?o de ga?s alta
e me?dia, e tambe?m conseguiu chegar mais pro?ximo da soluc?a?o o?tima
com uma capacidade de compressa?o baixa. Isto era esperado, pois o
modelo CC reduz o nu?mero de varia?veis do modelo DCC agregando as
varia?veis cont??nuas associadas aos ve?rtices dos politopos. Entretanto,
com uma capacidade de compressa?o de ga?s baixa, o modelo CC na?o
chegou a? soluc?a?o o?tima, ficando com um GAP dual de 9.91%, que e?
relativamente elevado. O modelo SOS2 teve o melhor desempenho para
todas as capacidades de compressa?o de ga?s. Este resultado aponta que,
no cena?rio com qualidade de aproximac?a?o me?dia, o tratamento algo-
r??tmico das restric?o?es SOS2 ao inve?s do uso de varia?veis bina?rias deu
ganhos significativos na resoluc?a?o do problema de alocac?a?o de ga?s.

Tabela 6: Aproximac?a?o com Hipercubos com Qualidade Fina

Alta Me?dia Baixa

DCC
Tempo (s) 3.927,00 4.180,19 6.618,02?

GAP (%) 0,00 0,00 169,36

DLog
Tempo (s) 10.000,00 10.000,00 10.000,00
GAP (%) 0,11 50,29 22,72

CC
Tempo (s) 4.078,94 1.002,81 10.000,00
GAP (%) 0,00 0,00 7,63

SOS2
Tempo (s) 380,97 417,99 10.000,00
GAP (%) 0,00 0,00 5,95

Analisando-se os dados da Tabela 6, que apresentam os resultado
para uma qualidade de aproximac?a?o alta, pode-se notar que, com exce-
c?a?o do modelo DLog, todos os demais modelos conseguiram encontrar
a soluc?a?o o?tima com as capacidades de compressa?o de ga?s alta e me?dia.
Isto mostra que o ganho obtido com a reduc?a?o logar??tmica de varia?-
veis bina?rias com relac?a?o ao nu?mero de politopos teve pouca influe?ncia
no desempenho computacional do modelo DLog, pois era esperado que
este modelo tivesse um bom desempenho com um nu?mero maior de
politopos. Com uma capacidade de compressa?o de ga?s baixa, nenhum
dos modelos conseguiu encontrar a soluc?a?o o?tima. O modelo SOS2 teve
o melhor desempenho dentre os modelos, conseguindo chegar mais pro?-
ximo da soluc?a?o o?tima com uma capacidade de compressa?o baixa, com
um GAP dual de 5,95%.



114

5.2.1.2 Variac?a?o da Qualidade de Aproximac?a?o

Esta sec?a?o tem como objetivo analisar o desempenho dos mode-
los com a variac?a?o da qualidade da aproximac?a?o, considerando a evolu-
c?a?o do GAP dual ao longo do tempo de execuc?a?o. As Figuras 13, 14 e
15 apresentam os gra?ficos dos modelos para os cena?rios com capacida-
des de compressa?o de ga?s alta, me?dia e baixa, respectivamente. Cada
gra?fico apresenta o desempenho dos modelos para as aproximac?o?es com
as qualidades baixa, me?dia e fina. Os gra?ficos esta?o em escala logar??t-
mica em func?a?o da alta variac?a?o do tempo computacional e GAP. A
aproximac?a?o com hipercubos para as qualidades baixa, me?dia e alta sa?o
denotadas por 18-125, 66-1000 e 180-2197, respectivamente. Tais va-
lores representam o nu?mero de politopos para os dom??nios das func?o?es
de vaza?o dos poc?os e das curvas de queda de pressa?o nas tubulac?o?es.

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)

DCC 18?125
DCC 66?1000
DCC 180?2197
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
SOS2 18?125
SOS2 66?1000
SOS2 180?2197

Figura 13: Hipercubos - Capacidade de compressa?o Alta

Analisando-se o gra?fico ilustrado na Figura 13, cujo cena?rio e?
caracterizado pela capacidades de compressa?o alta de ga?s, pode-se no-



115

tar que todos os modelos convergiram para a soluc?a?o o?tima com as
qualidades de aproximac?a?o baixa e me?dia. Quando a qualidade e? fina,
apenas o modelo DLog na?o conseguiu encontrar a soluc?a?o. Este resul-
tado aponta que o crescimento logar??tmico em relac?a?o ao nu?mero de
politopos de varia?veis bina?rias do modelo DLog na?o teve muita influe?n-
cia no desempenho deste modelo. Para a aproximac?a?o com qualidade
baixa, os modelos tiveram um desempenho similar, encontrando a so-
luc?a?o o?tima em menos de 100 segundos. O modelo SOS2 teve melhor
desempenho com todas as qualidades de aproximac?a?o.

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)

DCC 18?125
DCC 66?1000
DCC 180?2197
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
SOS2 18?125
SOS2 66?1000
SOS2 180?2197

Figura 14: Hipercubos - Capacidade de Compressa?o Me?dia

Analisando-se o gra?fico da Figura 14, cujo cena?rio e? caracterizado
pela capacidade de compressa?o de ga?s me?dia, pode-se notar que, com
uma qualidade de aproximac?a?o baixa, todos os modelos conseguiram
encontrar a soluc?a?o o?tima e fechar o GAP dual. Com esta qualidade
de aproximac?a?o, o desempenho dos modelos foi similar, sendo o modelo
SOS2 aquele com melhor desempenho. Para as qualidades de aproxima-
c?a?o me?dia e alta, todos os modelos, com excec?a?o do DLog, conseguiram
encontrar a soluc?a?o o?tima. Embora tenha conseguido fechar o GAP,



116

o modelo DCC encontrou a primeira soluc?a?o fact??vel mais distante da
soluc?a?o o?tima para todas as qualidades de aproximac?a?o. Pode-se notar
que, quando o nu?mero de politopos aumenta, o modelo DLog tem o pior
desempenho dentre os modelos e na?o chegou a? soluc?a?o o?tima para os
cena?rios com capacidade de compressa?o de ga?s me?dia e baixa. Este re-
sultado pode indicar que o impacto do nu?mero logar??tmico de varia?veis
bina?rias adicionais deste modelo teve pouca influe?ncia no desempenho
do mesmo. O modelo SOS2 tambe?m teve o melhor desempenho para as
qualidades de aproximac?a?o me?dia e alta, indicando que o tratamento de
restric?o?es SOS2 pelo solver acelerou consideravelmente o desempenho
deste modelo.

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)

DCC 18?125
DCC 66?1000
DCC 180?2197*
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
SOS2 18?125
SOS2 66?1000
SOS2 180?2197

Figura 15: Hipercubos - Capacidade de Compressa?o Baixa

A Figura 15 apresenta um gra?fico que relaciona o GAP pelo
tempo de execuc?a?o dos modelos com aproximac?a?o por hipercubos para
o cena?rio com capacidade de compressa?o baixa. Para a qualidade de
aproximac?a?o baixa, todos os modelos conseguiram encontrar a soluc?a?o
o?tima. Neste cena?rio, embora o modelo SOS2 tenha encontrado uma
soluc?a?o fact??vel primeiro, o modelo DLog teve o melhor desempenho.



117

Com uma qualidade de aproximac?a?o me?dia, dentre todos os modelos,
apenas o modelo SOS2 conseguiu encontrar a soluc?a?o o?tima. Quando a
qualidade de aproximac?a?o se torna fina, nenhum dos modelos conseguiu
encontrar a soluc?a?o o?tima para o problema, sendo o SOS2 o modelo que
conseguiu encontrar uma soluc?a?o mais pro?xima da soluc?a?o o?tima, com
um GAP dual de 5,95%. Este resultado mostra que o problema de
alocac?a?o de ga?s com capacidade de compressa?o baixa no compressor e?
um problema consideravelmente dif??cil de se resolver a? medida que a
qualidade da aproximac?a?o se torna mais fina.

5.2.2 Aproximac?a?o por Simplexes

Nesta sec?a?o, sera? feita uma ana?lise computacional dos modelos
DCC, DLog, CC, Log e MC para uma aproximac?a?o por simplexes para
o problema de alocac?a?o de ga?s discutido no Cap??tulo 2. As formula-
c?o?es que falharem ao tentar encontrar uma soluc?a?o o?tima por falta de
memo?ria sera?o apresentadas nas tabelas com um asterisco (*).

De forma similar ao que foi feito na sec?a?o que apresenta os resul-
tados com a aproximac?a?o por hipercubos, a primeira parte desta sec?a?o
tem como objetivo analisar o desempenho computacional dos mode-
los com a variac?a?o da capacidade de compressa?o de ga?s, enquanto a
segunda faz uma ana?lise do desempenho com relac?a?o a? variac?a?o do
nu?mero de politopos, considerando a evoluc?a?o do GAP dual no tempo.

5.2.2.1 Variac?a?o da Capacidade de Compressa?o de Ga?s

Nesta sec?a?o, o desempenho computacional dos modelos e? ana-
lisado com diferentes taxas dispon??veis no compressor para injec?a?o de
ga?s. As Tabelas 7, 8 e 9 apresentam os tempos de execuc?a?o (em segun-
dos) gastos por cada formulac?a?o para resolver o problema de alocac?a?o
de ga?s com as qualidades de aproximac?a?o baixa, me?dia e alta, respec-
tivamente, variando-se a capacidade de compressa?o de ga?s de injec?a?o.
Nessas tabelas tambe?m sa?o apresentados os GAP ’s duais das soluc?o?es
encontradas dentro do tempo limite de 10.000 segundos.

Com base nos resultados apresentados na Tabela 7, pode-se no-
tar que, para uma capacidade de compressa?o alta, todos os modelos,
com excec?a?o do CC conseguiram encontrar a soluc?a?o o?tima. Para as
capacidades de compressa?o me?dia e baixa, os modelos DCC e CC na?o
conseguiram encontrar a soluc?a?o o?tima, embora estes modelos tenham



118

Tabela 7: Simplexes - Qualidade Baixa

Alta Me?dia Baixa

DCC
Tempo (s) 614,22 10.000,00 ?7.000,00
GAP (%) 0,00 0,04 8,63

DLog
Tempo (s) 220,61 570,31 3152,90
GAP (%) 0,00 0,00 0,00

CC
Tempo (s) 10.000,00 10.000,00 10.000,00
GAP (%) 0,02 0,05 8,61

Log
Tempo (s) 7,29 7,42 6,88
GAP (%) 0,00 0.00 0.00

MC
Tempo (s) 791,46 775,62 365,35
GAP (%) 0,00 0,00 0,00

chegado a uma soluc?a?o com GAP relativamente pequeno para a ca-
pacidade de compressa?o me?dia. O modelo DCC encontrou a soluc?a?o
o?tima com uma capacidade de compressa?o alta, mas falhou ao tentar
encontrar a soluc?a?o para o problema com capacidade de compressa?o
baixa. E? relevante observar que, para as capacidades de compressa?o
alta e me?dia, os modelos logar??tmicos DLog e Log tiveram o melhor de-
sempenho, tendo melhor desempenho que os modelos DCC e CC para
todas as capacidades de compressa?o de ga?s. Isto era esperado, pois a
aproximac?a?o por simplexes possui mais politopos do que a aproxima-
c?a?o por hipercubos para a mesma qualidade de aproximac?a?o. Assim, as
propriedades de crescimento logar??tmico das formulac?o?es DLog e Log
tiveram um impacto relevante na aproximac?a?o por simplexes com ca-
pacidades de compressa?o de ga?s alta e me?dia. Entretanto, quando a
restric?a?o de capacidade de compressa?o de ga?s se torna mais restrita,
o modelo MC apresenta um desempenho melhor que o modelo DLog.
Em todos os cena?rios, o modelo Log teve o melhor desempenho.

Analisando-se os dados da Tabela 8, pode-se notar que, para
uma capacidade de compressa?o alta, todos os modelos, com excec?a?o
do MC, conseguiram encontrar a soluc?a?o o?tima. Com uma capacidade
de compressa?o me?dia, com excec?a?o do DLog que na?o fechou o GAP
no tempo dispon??vel, os demais modelos conseguiram encontrar a so-
luc?a?o o?tima, sendo o modelo MC aquele que teve o pior desempenho.
E? va?lido observar que, com as capacidades de compressa?o de ga?s alta
e me?dia, o modelo DCC teve desempenho melhor que o modelo DLog.
Este resultado na?o era esperado, pois o nu?mero maior de politopos da
aproximac?a?o com qualidade me?dia deveria evidenciar o crescimento lo-



119

Tabela 8: Simplexes - Qualidade Me?dia

Alta Me?dia Baixa

DCC
Tempo (s) 3.342,49 3716,04 ?5350,45
GAP (%) 0,00 0,00 13,33

DLog
Tempo (s) 4.701,79 10.000,00 10.000,00
GAP (%) 0,00 0,02 4,54

CC
Tempo (s) 2.423,16 1.713,72 ?4.341,63
GAP (%) 0,00 0,00 127,36

Log
Tempo (s) 27,97 13,92 60,04
GAP (%) 0,00 0,00 0,00

MC
Tempo (s) 10.000,00 9.019,77 10.000,00
GAP (%) 0,04 0,00 3,26

gar??tmico de varia?veis bina?rias do modelo DLog em relac?a?o ao DCC.
Isto pode se dar pelas caracter??sticas intr??nsecas do poliedro formado
pelas restric?o?es do problema de alocac?a?o de ga?s. Outro fato a se des-
tacar e? que o modelo CC teve melhor desempenho que o modelo DCC
com as capacidades de compressa?o alta e me?dia. Isto era esperado, pois
o modelo CC reduz o nu?mero de varia?veis cont??nuas do modelo DCC
agregando as varia?veis associadas aos ve?rtices de politopos vizinhos.
Para a capacidade de compressa?o baixa, os modelos DCC e CC falha-
ram ao tentar encontrar a soluc?a?o o?tima para o problema e apenas o
modelo Log conseguiu encontrar a soluc?a?o o?tima para o problema. Para
todas as capacidades de compressa?o de ga?s, o modelo Log teve desem-
penho consideravelmente superior aos demais modelos. Analisando-se

Tabela 9: Simplexes - Qualidade Alta

Alta Me?dia Baixa

DCC
Tempo (s) ?5.808,49 ?6.975,51 ?6.026,55
GAP (%) 554,05 536,78 554,09

DLog
Tempo (s) 10.000,00 10.000,00 10.000,00
GAP (%) 0,12 0,10 29,11

CC
Tempo (s) ?6.985,34 ?5.818,30 ?4.305,80
GAP (%) 63,54 100,45 111,02

Log
Tempo (s) 106,61 96,55 698,11
GAP (%) 0,00 0,00 0,00

MC
Tempo (s) 10.000,00 10.000,00 10.000,00
GAP (%) 0,30 0,23 10,21



120

os dados da Tabela 9, pode-se notar que os modelos DCC e CC falha-
ram ao tentar encontrar a soluc?a?o o?tima para todas as capacidades de
compressa?o de ga?s. Os modelos DLog e MC na?o conseguiram encon-
trar a soluc?a?o o?tima dentro do tempo dispon??vel. Apenas o modelo Log
conseguiu encontrar a soluc?a?o o?tima em todos os cena?rio de capacidade
de compressa?o de ga?s. Este resultado mostra que a propriedade de
crescimento logar??tmico do nu?mero de var??aveis e restric?o?es adicionais
do modelo Log teve um impacto considera?vel na eficie?ncia de soluc?a?o
do problema com uma qualidade alta.

5.2.2.2 Variac?a?o da Qualidade da Aproximac?a?o

Esta sec?a?o apresenta uma ana?lise de desempenho dos modelos
com variac?o?es na qualidade das aproximac?o?es por simplexes. As Figu-
ras 16, 17 e 18 apresentam a evoluc?a?o do GAP em func?a?o do tempo de
execuc?a?o dos modelos para os cena?rios com capacidades de compressa?o
de injec?a?o de ga?s alta, me?dia e baixa, respectivamente. Os gra?ficos
esta?o em escala logar??tmica em func?a?o da alta variac?a?o do tempo com-
putacional e GAP. Para fins de comparac?a?o, cada gra?fico apresenta o
desempenho dos modelos para as aproximac?o?es com qualidades fina,
me?dia e baixa em cada cena?rio de capacidade de compressa?o de ga?s.

Analisando-se o gra?fico ilustrado na Figura 16, cujo cena?rio e?
caracterizado pela capacidade de compressa?o alta, pode-se notar que,
para uma qualidade de aproximac?a?o baixa, todos os modelos, com ex-
cec?a?o do CC, conseguem encontrar a soluc?a?o o?tima. Neste cena?rio, os
modelos DCC e MC te?m desempenho similar, enquanto o modelo DLog
apresenta um desempenho melhor. Para uma aproximac?a?o com quali-
dade me?dia, apenas os modelos Log, DLog e DCC conseguem encontrar
a soluc?a?o o?tima. Neste cena?rio, os modelos logar??tmicos apresentam
um resultado melhor, o que era esperado, uma vez que o nu?mero de
varia?veis destes cresce de forma logar??tmica em relac?a?o ao nu?mero de
politopos. Com uma qualidade de aproximac?a?o fina, apenas o modelo
Log consegue encontrar a soluc?a?o o?tima, sendo o modelo com melhor
desempenho para todas as qualidades de aproximac?a?o no cena?rio com
capacidade de compressa?o de ga?s alta.

O gra?fico ilustrado na Figura 17 apresenta o desempenho dos
modelos com um cena?rio caracterizado pela capacidade de compressa?o
me?dia de ga?s. Neste cena?rio, todos os modelos, com excec?a?o do CC,
convergem para a soluc?a?o o?tima para uma qualidade de aproximac?a?o
baixa. Os modelos DLog e MC apresentaram desempenho similar, en-



121

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)

DCC 18?125
DCC 66?1000
DCC 180?2197
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
Log 18?125
Log 66?1000
Log 180?2197
MC 18?125
MC 66?1000
MC 180?2197

Figura 16: Simplexes - Capacidade de Compressa?o Alta

quanto os modelos DCC e Log tiveram desempenho melhor. Para a
aproximac?a?o com qualidade me?dia, apenas o modelo DLog na?o conse-
guiu encontrar a soluc?a?o o?tima. Ao contra?rio do esperado, o modelo
DCC teve desempenho superior ao DLog com as qualidades de aproxi-
mac?a?o baixa e me?dia, possivelmente porque o poliedro do problema e?
menor devido a? restric?a?o mais apertada da capacidade de compressa?o
de ga?s, minimizando o ganho do modelo DLog com a reduc?a?o do nu?-
mero de varia?veis bina?rias. Com uma qualidade de aproximac?a?o fina,
os modelos DCC e CC falharam ao tentar encontrar a soluc?a?o o?tima.
Os modelos DLog e MC na?o encontraram a soluc?a?o o?tima, mas fica-
ram com um GAP dual relativamente pequeno. Apenas o modelo Log
conseguiu encontrar a soluc?a?o o?tima para o problema, sendo o modelo
com o melhor desempenho para todas as qualidades de aproximac?a?o no
cena?rio com capacidade de compressa?o me?dia.

O gra?fico ilustrado na Figura 18 apresenta o desempenho dos
modelos para um cena?rio caracterizado pela capacidade de compressa?o
baixa de ga?s. Para uma qualidade de aproximac?a?o baixa, apenas os
modelos Log, MC e DLog conseguiram encontrar a soluc?a?o o?tima. O



122

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)
DCC 18?125
DCC 66?1000
DCC 180?2197
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
Log 18?125
Log 66?1000
Log 180?2197
MC 18?125
MC 66?1000
MC 180?2197

Figura 17: Simplexes - Capacidade de Compressa?o Me?dia

modelo MC teve desempenho melhor que o modelo DLog, enquanto
o Log teve o melhor desempenho. Para as qualidades de aproximac?a?o
me?dia e alta, apenas o modelo Log conseguiu encontrar a soluc?a?o o?tima,
sendo o modelo com melhor desempenho para todas as qualidades de
aproximac?a?o no cena?rio com capacidade de compressa?o baixa de ga?s.

5.2.3 Ana?lise Geral

Esta sec?a?o analisa o desempenho computacional das formulac?o?es
para as aproximac?o?es com simplexes e hipercubos, considerando o im-
pacto da variac?a?o na qualidade de aproximac?a?o em cada abordagem.
Para o cena?rio analisado, os resultados obtidos com a ana?lise computa-
cional dos modelos para ambas as aproximac?o?es suscitaram as seguintes
concluso?es:

Desempenho Computacional : De um modo geral, para o cena?-
rio analisado, os modelos SOS2 e Log apresentaram os melhores
desempenhos para as aproximac?o?es por hipercubos e por simple-



123

10
0

10
1

10
2

10
3

10
4

10
?4

10
?3

10
?2

10
?1

10
0

10
1

10
2

10
3

Tempo (s)

G
A

P
(%

)

DCC 18?125
DCC 66?1000
DCC 180?2197
DLog 18?125
DLog 66?1000
DLog 180?2197
CC 18?125
CC 66?1000
CC 180?2197
Log 18?125
Log 66?1000
Log 180?2197
MC 18?125
MC 66?1000
MC 180?2197

Figura 18: Simplexes - Capacidade de Compressa?o Baixa

xes, respectivamente. Com as qualidade de aproximac?a?o baixa,
embora os resultados sejam pro?ximos, o modelo SOS2 tem desem-
penho ligeiramente melhor quando a capacidade de compressa?o
de ga?s e? alta ou me?dia. Quando a capacidade de compressa?o se
torna restrita, o Log apresenta resultado consideravelmente mais
eficiente. Para uma qualidade de aproximac?a?o me?dia, o SOS2
e? melhor apenas com capacidade de compressa?o alta. Nos ca-
sos com qualidades me?dia e alta, o Log tem melhor desempenho.
Com uma qualidade de aproximac?a?o alta, o Log e? melhor que
o SOS2 em todos os cena?rios. Na situac?a?o espec??fica em que a
qualidade de aproximac?a?o e? baixa e a capacidade de compressa?o
de ga?s e? baixa, o modelo DLog teve melhor desempenho que o
SOS2. Com os resultados apresentados neste cap??tulo, nota-se
que, quando a capacidade de compressa?o de ga?s e? baixa, o pro-
blema de alocac?a?o de ga?s se torna mais dif??cil. Neste cena?rio,
a? medida que a aproximac?a?o se torna mais fina, ou seja, o nu?-
mero de politopos aumenta, o modelo Log se destaca pelo seu
desempenho em relac?a?o aos demais modelos. Para a qualidade
de aproximac?a?o fina, dentre todos os modelos, apenas o modelo



124

Log conseguiu encontrar a soluc?a?o o?tima para o problema. Isto
se explica pelo crescimento logar??tmico de varia?veis cont??nuas e
bina?rias do modelo Log em relac?a?o ao nu?mero de politopos.

Qualidade da Aproximac?a?o : Para uma mesma qualidade, a apro-
ximac?a?o por hipercubos resulta em formulac?o?es com menos vari-
a?veis cont??nuas, pois possui menos politopos que a aproximac?a?o
por simplexes. Entretanto, como a representac?a?o do dom??nio de
ambas aproximac?o?es e? equivalente, a aproximac?a?o com simple-
xes e? mais fina e produz um resultado com erros de aproximac?a?o
menores.

Para uma qualidade baixa, os modelos DLog e SOS2 apresen-
taram desempenho melhor para a aproximac?a?o com hipercubos,
enquanto o DLog, MC e Log tiveram melhor desempenho com
simplexes. Para uma qualidade me?dia, apenas os modelos DLog
e MC enfrentaram dificuldades para resolver o problema, pore?m,
quando a capacidade de compressa?o de ga?s e? baixa, neste cena?-
rio, apenas os modelos SOS2 e Log conseguem encontrar a soluc?a?o
o?tima. Para as aproximac?o?es por hipercubos, quando a qualidade
da aproximac?a?o e? fina, os modelos DCC, CC e o SOS2 conseguem
resolver o problema com as capacidades de compressa?o de ga?s alta
e me?dia. Entretanto, quando a capacidade de compressa?o de ga?s
se torna restrita (baixa) neste cena?rio, nenhum dos modelos com
aproximac?a?o por hipercubos consegue resolver o problema. Para
as aproximac?o?es com simplexes, apenas o Log conseguiu resolver
o problema com a qualidade de aproximac?a?o fina para qualquer
capacidade de compressa?o de ga?s.

5.3 SUMA?RIO

Neste cap??tulo, foi apresentada um ana?lise computacional das
formulac?o?es lineares inteiras-mistas vistas no Cap??tulo 4 para o pro-
blema de alocac?a?o de ga?s sob restric?o?es de alinhamento e de pressa?o
apresentado no Cap??tulo 2. Inicialmente, foi apresentado um sistema
de produc?a?o de um campo de petro?leo que serviu como insta?ncia para
a ana?lise computacional. Em seguida, foi apresentada a ana?lise de de-
sempenho dos modelos DCC, DLog, CC e SOS2 para uma aproximac?a?o
com hipercubos que considerou a variac?a?o de capacidade de compres-
sa?o de ga?s e a variac?a?o da qualidade de aproximac?a?o. Foi apresentada
tambe?m uma ana?lise de desempenho dos modelos DCC, DLog, CC,
Log e MC para uma aproximac?a?o com simplexes que tambe?m levou em



125

conta a variac?a?o da capacidade de compressa?o de ga?s e a variac?a?o da
qualidade de aproximac?a?o. Por fim, foi feita uma ana?lise geral do de-
sempenho das aproximac?o?es com simplexes e hipercubos, considerando
a qualidade de aproximac?a?o de cada abordagem.



126



127

6 SUMA?RIO

A alta competitividade dos mercados petrol??feros e os altos cus-
tos do processo de extrac?a?o tornam qualquer lucro obtido na produc?a?o
de hidrocarbonetos muito significativo. Neste contexto, a obtenc?a?o das
taxas o?timas de injec?a?o de ga?s para os poc?os com elevac?a?o artificial,
da configurac?a?o das va?lvulas como resultado das presso?es obtidas pelos
modelos de otimizac?a?o e do alinhamento entre poc?os e manifolds que
permitam maximizar o benef??cio obtido com a produc?a?o tem papel im-
portante nos campos de petro?leo. Neste trabalho, foram apresentados
modelos e uma abordagem de soluc?a?o para se obter o modo de operac?a?o
dia?rio que maximiza a produc?a?o de campos de petro?leo que utilizam a
elevac?a?o artificial por injec?a?o cont??nua de ga?s.

Uma formulac?a?o na?o linear inteira-mista foi desenvolvida para
modelar o problema de alocac?a?o de ga?s de injec?a?o em poc?os sujeitos a
restric?o?es de capacidade de ga?s dispon??vel no compressor, limites ope-
racionais de vaza?o dos poc?os e a?s restric?o?es de pressa?o, o que confi-
gura um cena?rio bem pro?ximo da realidade de campos de petro?leo atu-
ais. Uma vantagem da modelagem deste problema com programac?a?o
inteira-mista e? que outras restric?o?es podem ser incorporadas ao modelo
do problema, o qual pode ser estendido para outros cena?rios, servindo
de base para diferentes me?todos de soluc?a?o.

A abordagem de soluc?a?o utilizada neste trabalho foi a refor-
mulac?a?o do problema na?o-linear inteiro-misto em um programa linear
inteiro-misto com o uso de ferramentas de linearizac?a?o por partes para
func?o?es multidimensionais. Foram desenvolvidas sete formulac?o?es em
programac?a?o linear inteira-mista para solucionar o problema, conside-
rando aproximac?o?es por hipercubos e por simplexes. A programac?a?o
linear inteira-mista aliada a? ferramenta de linearizac?a?o por partes e?
uma ferramenta poderosa porque viabiliza o co?mputo de soluc?o?es o?ti-
mas globais para problemas que envolvem func?o?es na?o-convexas, o que
geralmente configura problemas NP-Dif??ceis, i.e., muito dif??ceis de se
resolver, em especial, quando tais func?o?es sa?o multivariadas. O interes-
sante desta ferramenta e? que o erro da aproximac?a?o e? reduzido a? medida
que a qualidade da aproximac?a?o se torna mais fina. Em contrapartida,
a? medida que a aproximac?a?o se torna mais fina, o problema se torna
mais dif??cil de se resolver, pois passa a ter mais varia?veis e restric?o?es
adicionais.

Foi apresentada uma ana?lise computacional das formulac?o?es li-
neares inteiras-mistas desenvolvidas para um cena?rio modelado a partir



128

de um sistema de produc?a?o sinte?tico constru??do com uma ferramenta
de simulac?a?o de escoamento multifa?sico. A ana?lise teve como objetivo
analisar o desempenho computacional dos modelos com a variac?a?o da
disponibilidade de ga?s no compressor e com diferentes qualidades de
aproximac?a?o para hipercubos e simplexes. Os resultados encontrados
podem servir para balizar a decisa?o dos operadores de campos de petro?-
leo e para nortear o desenvolvimento de soluc?o?es mais espec??ficas para
cena?rios diferentes do abordado nesta dissertac?a?o. De um modo geral,
para as insta?ncias usadas no trabalho, os modelos SOS2 e Log apresen-
taram os melhores desempenhos para as aproximac?o?es por hipercubos
e por simplexes, respectivamente. Com as qualidade de aproximac?a?o
baixa, embora os resultados sejam pro?ximos, o modelo SOS2 tem de-
sempenho ligeiramente melhor quando a capacidade de compressa?o de
ga?s e? alta ou me?dia. Quando a capacidade de compressa?o se torna res-
trita, o Log apresenta resultado consideravelmente mais eficiente. Para
uma qualidade de aproximac?a?o me?dia, o SOS2 e? melhor apenas com
capacidade de compressa?o alta. Nos casos com qualidades me?dia e alta,
o Log tem melhor desempenho. Com uma qualidade de aproximac?a?o
alta, o Log e? melhor que o SOS2 em todos os cena?rios, sendo o u?nico
modelo a solucionar o problema com qualidade de aproximac?a?o alta e
capacidade de compressa?o baixa.

Dentre as reformulac?o?es apresentadas neste trabalho, aquela que
se baseia no modelo Inc na?o foi analisada quanto ao seu desempenho
computacional porque na?o foi desenvolvido uma heur??stica de orde-
nac?a?o dos simplexes e ve?rtices para o R3. O desenvolvimento desta
heur??stica e? um um trabalho futuro a ser desenvolvido.

Como sugesta?o para trabalhos futuros propomos uma aborda-
gem h??brida atrave?s composic?a?o de uma aproximac?a?o convexa para a
func?a?o de queda de pressa?o com a func?a?o linear por partes para a vaza?o
dos poc?os. A aproximac?a?o convexa pode ser encontrada com um algo-
ritmo de Programac?a?o Semi-definida. O resultado desta abordagem e?
uma formulac?a?o mais compacta e que pode trazer ganhos no desempe-
nho devido a? utilizac?a?o da informac?a?o do gradiente da func?a?o convexa.
Um outro tema de pesquisa futura e? a extensa?o do problema para um
cena?rio mais complexo, com a incorporac?a?o de alinhamento entre ma-
nifolds e separadores. Neste caso, a pressa?o de sa??da das tubulac?o?es,
onde ocorrem as quedas de pressa?o, se torna uma varia?vel do problema
e a incorporac?a?o desta no problema de otimizac?a?o requer a modelagem
de uma func?a?o linear por partes de quatro dimenso?es. Espera-se que
o modelo logar??tmico (Log) tenha um bom desempenho neste cena?rio,
uma vez que o crescimento do seu nu?mero de varia?veis e? logar??tmico.



129

REFERE?NCIAS BIBLIOGRA?FICAS

ALARCO?N, G. A.; TORRES, C. F.; GO?MEZ, L. E. Global
optimization of gas allocation to a group of wells in artificial lift using
nonlinear constrained programming. Journal of Energy Resources
Technology, v. 124, n. 4, p. 262–268, 2002.

BALAKRISHNAN, A.; GRAVES, S. C. A composite algorithm for a
concave-cost network flow problem. Networks, v. 19, n. 2, p. 175–202,
1989.

BEALE, E. M. L. Branch and bound methods for numerical
optimization of non-convex functions. Computational Statistics, v. 80,
p. 11–20, 1980.

BEALE, E. M. L.; TOMLIN, J. A. Special facilities in a general
mathematical programming system for non-convex problems using
ordered sets of variables. In: Proceedings of the Fifth International
Conference on Operations Research. [S.l.: s.n.], 1970. p. 447–454.

BEGGS, D.; BRILL, J. A study of two-phase flow in inclined pipes.
Journal of Petroleum technology, Society of Petroleum Engineers,
v. 25, n. 5, p. 607–617, 1973.

BOGAERT, P. M. et al. Improving oil production using Smart Fields
technology in SF30 satellite oil development offshore Malaysia. In:
Proceedings of the Offshore Technology Conference. Houston, TX:
[s.n.], 2004.

BOOTHROYD, D. Unmanned platforms need multifunctional control.
Computing &amp;amp; Control Engineering Journal, v. 5, n. 6, p. 274 –276,
1994.

BUITRAGO, S.; RODRI?GUEZ, E.; ESPIN, D. Global optimization
techniques in gas allocation for continuous flow gas lift systems. In:
SPE Gas Technology Symposium. Calgary, Alberta, Canada: [s.n.],
1996.

CAMPONOGARA, E.; CONTO, A. de. Lift-gas allocation under
precedence constraints: MILP formulation and computational
analysis. IEEE Transactions on Automation Science and Engineering,
v. 6, n. 3, p. 544–551, July 2009.



130

CAMPONOGARA, E.; NAKASHIMA, P. H. R. Optimizing gas-lift
production of oil wells: Piecewise linear formulation and computational
analysis. IIE Transactions, v. 38, n. 2, p. 173–182, 2006.

CAMPONOGARA, E.; NAZARI, L. F.; MENESES, C. N. A revised
model for compressor design and scheduling in gas-lifted oil fields. IIE
Transactions, v. 44, n. 5, p. 342–351, 2012.

CAMPONOGARA, E. et al. An automation system for gas-lifted
oil wells: Model identification, control, and optimization. Journal of
Petroleum Science &amp;amp; Engineering, v. 70, n. 3-4, p. 157–167, 2010.

CAMPOS, S. R. V. et al. Urucu field integrated production modeling.
In: Proceedings of the SPE Intelligent Energy Conferece and
Exhibition. Utrecht, The Netherlands: [s.n.], 2010.

CODAS, A.; CAMPONOGARA, E. Mixed-integer linear optimization
for optimal lift-gas allocation with well-separator routing. European
Journal of Operational Research, v. 212, p. 222–231, 2012.

CROXTON, K. L.; GENDRON, B.; MAGNANTI, T. L. A comparison
of mixed-integer programming models for nonconvex piecewise linear
cost minimization problems. Management Science, v. 49, p. 1268–1273,
2003.

DANTZIG, G. On the significance of solving linear programming
problems with some integer variables. Econometrica, Journal of the
Econometric Society, v. 28, n. 1, p. 30–44, 1960.

DUTTA-ROY, K.; KATTAPURAM, J. A new approach to gas-lift
allocation optimization. In: Proceedings of SPE Western Regional
Meeting. [S.l.: s.n.], 1997.

FANG, W. Y.; LO, K. K. A generalized well-management scheme
for reservoir simulation. SPE Reservoir Engineering, v. 11, n. 2, p.
116–120, 1996.

FARIAS, I. R. D.; JOHNSON, E. L.; NEMHAUSER, G. L.
Branch-and-cut for combinatorial optimization problems without
auxiliary binary variables. Knowledge Engineering Review, v. 16, p.
25–39, 2001.

GO?MEZ, V. Optimization of Continuous Flow Gas Lift Systems.
Dissertac?a?o (Mestrado) — University of Tulsa, Oklahoma, U.S.A,
1974.



131

GUNNERUD, V.; FOSS, B. Oil production optimization–a piecewise
linear model, solved with two decomposition strategies. Computers &amp;amp;
Chemical Engineering, v. 34, n. 11, p. 1803–1812, 2010.

HANDLEY-SCHACHLER, S.; MCKIE, C.; QUINTERO, N. New
mathematical techniques for the optimisation of oil &amp;amp; gas production
systems. In: SPE European Petroleum Conference. [S.l.: s.n.], 2000.

IBARAKI, T. Integer programming formulation of combinatorial
optimization problems. Discrete Mathematics, v. 16, p. 39–52, 1976.

JEROSLOW, R.; LOWE, J. Experimental results on the new
techniques for integer programming formulations. Journal of the
Operational Research Society, v. 36, n. 5, p. 393–403, 1985.

JEROSLOW, R. G.; LOWE, J. K. Modelling with integer variables.
In: Mathematical Programming at Oberwolfach II. [S.l.]: Springer
Berlin Heidelberg, 1984. v. 22, p. 167–184.

KANU, E. P.; MACH, J. M.; BROWN, K. E. Economic approach to
oil production and gas allocation in continuous gas lift. Journal of
Petroleum Technology, v. 33, n. 10, p. 1887–1892, 1981.

KEHA, A. B.; FARIAS JR, I. R. de; NEMHAUSER, G. L. Models
for representing piecewise linear cost functions. Operations Research
Letters, v. 32, p. 44–48, 2004.

KOSMIDIS, V.; PERKINS, J.; PISTIKOPOULOS, E. Optimization of
well oil rate allocations in petroleum fields. Industrial &amp;amp; Engineering
Chemistry Research, ACS Publications, v. 43, n. 14, p. 3513–3527,
2004.

KOSMIDIS, V.; PERKINS, J.; PISTIKOPOULOS, E. A mixed
integer optimization formulation for the well scheduling problem on
petroleum fields. Computers &amp;amp; Chemical Engineering, Elsevier, v. 29,
n. 7, p. 1523–1541, 2005.

LEE, J.; WILSON, D. Polyhedral methods for piecewise-linear
functions i: the lambda method. Discrete Applied Mathematics, v. 108,
n. 3, p. 269–285, 2001.

LITVAK, M.; DARLOW, B. Surface network and well tubinghead
pressure constraints in compositional simulation. In: Proceedings of
the SPE Reservoir Simulation Symposium. San Antonio, Texas: [s.n.],
1995.



132

MAYHILL, T. Simplified method for gas-lift well problem identification
and diagnosis. In: Proc. of Fall Meeting of the Society of Petroleum
Engineers of AIME. Houston, Texas: [s.n.], 1974.

MEYER, R. R. Mixed integer minimization models for piecewise-linear
functions of a single variable. Discrete Mathematics, v. 16, n. 2, p.
163–171, 1976.

MISENER, R.; GOUNARIS, C. E.; FLOUDAS, C. A. Global
optimization of gas lifting operations: A comparative study of
piecewise linear formulations. Industrial &amp;amp; Engineering Chemistry
Research, v. 48, n. 13, p. 6098–6104, 2009.

NISHIKIORI, N. et al. An improved method for gas lift allocation
optimization. ASME Journal of Energy Resources Technology, v. 117,
p. 87–92, 1995.

PADBERG, M. Approximating separable nonlinear functions via
mixed zero-one programs. Operations Research Letters, v. 27, n. 1,
p. 1–5, 2000.

REDDEN, D.; SHERMAN, T. A. G.; BLANN, J. R. Optimizing
gas-lift systems. In: 49th Annual Fall Meeting of the Society of
Petroleum Engineers of AIME. [S.l.: s.n.], 1974.

SHERALI, H. D. On mixed-integer zero-one representations for
separable lower-semicontinuous piecewise-linear functions. Operations
Research Letters, v. 28, n. 4, p. 155–160, 2001.

SILVA A. CODAS, E. C. T. Test instance of the lift-gas allocation
problem with pressure constraints and well-separator routing in AMPL
format. 2011.&amp;lt;http://www.das.ufsc.br/?camponog/IFAC-2012/&gt;.

SILVA, T. L.; CODAS, A.; CAMPONOGARA, E. A computational
analysis of convex combination models for multidimensional
piecewise-linear approximation in oil production optimization. In:
Proceedings of IFAC Workshop - Automatic Control in Offshore Oil
and Gas Production. Trondheim, Norway: [s.n.], 2012.

STOISITS, R. et al. Production optimization at the kuparuk river
field utilizing neural networks and genetic algorithms. In: Proceedings
of the SPE Mid-Continent Operations Symposium. [S.l.: s.n.], 1999.

TOMLIN, J. A. Special ordered sets and an application to gas supply
operations planning. Mathematical Programming, v. 42, n. 1-3, p.
69–84, 1988.



133

VAZQUEZ, M. et al. Global optimization of oil production systems, a
unified operational view. In: SPE Annual Technical Conference and
Exhibition. New Orleans, Louisiana: [s.n.], 2001.

VIELMA, J.; KEHA, A.; NEMHAUSER, G. Nonconvex, lower
semicontinuous piecewise linear optimization. Discrete Optimization,
v. 5, n. 2, p. 467–488, 2008.

VIELMA, J.; NEMHAUSER, G. Modeling disjunctive constraints
with a logarithmic number of binary variables and constraints.
Mathematical Programming, v. 128, n. 1-2, p. 49–72, 2009.

VIELMA, J. P.; AHMED, S.; NEMHAUSER, G. Mixed-integer models
for nonseparable piecewise-linear optimization: Unifying framework
and extensions. Operations Research, v. 58, n. 2, p. 303–315, 2010.

WANG, P. Development and applications of production optimization
techniques for petroleum fields. Tese (Doutorado) — Stanford
University, 2003.

WILF, H. Combinatorial Algorithms: An Update, volume 55 of
CBMS-NSF Regional Conference Series in Applied Mathematics. [S.l.]:
Society for Industrial and Applied Mathematics, 1989.

YETEN, B. et al. Decision analysis under uncertainty for Smart Well
deployment. Journal of Petroleum Science &amp;amp; Engineering, v. 43, p.
183–199, 2004.



134



APE?NDICE A -- Ape?ndice





137

Esta Sec?a?o conte?m conceitos e ilustrac?o?es sobre a triangulac?a?o
J1 que podem facilitar o entendimento desta dissertac?a?o. Ale?m disto,
apresenta informac?o?es sobre o nu?mero de varia?veis e restric?o?es dos pro-
blema resolvidos nesta dissertac?a?o e as soluc?o?es correspondentes.

A.1 TRIANGULAC?A?O J1 (”UNION JACK”)

Em topologia, a generalizac?a?o do conceito de tria?ngulo a outra
dimenso?es e? um simplex, o qual e? um invo?lucro convexo de n + 1 pontos
independentes em Rn. Esta nomenclatura se deve ao fato de o simplex
ser o pol??gono mais simples de sua dimensa?o, ou seja, um tria?ngulo
(2D) e? o pol??gono que possui menos ve?rtices e arestas, o tetraedro (3D)
e? o pol??gono que possui menos ve?rtices, arestas e faces.

Uma triangulac?a?o J1 e? composta por um conjunto de simplexes
que particionam um dom??nio D = [0,K]n, para K ? Z, com K par. O
conjunto de ve?rtices da triangulac?a?o J1 e? dado por V = {0, ...,K}n. A
construc?a?o desta triangulac?a?o e? baseada no produto cartesiano de tre?s
conjuntos: conjunto dos de ve?rtices ??mpares (V 0), conjunto de direc?o?es
(S) e conjunto de permutac?o?es (Sym(N)). Seja N = {1,...,n}, sendo
n a dimensa?o do dom??nio. Pode-se definir os conjuntos dos ve?rtices
??mpares, direc?o?es e permutac?o?es da triangulac?a?o J1 como segue:

•V 0 = {v ? V : vi e? ??mpar,?i ? N}

•Sym(N) = Permutac?o?es simples do conjunto N

•S = {?1,1}n

A triangulac?a?o J1 e? enta?o definida em torno dos ve?rtices ??mpares do
conjunto V 0. A Figura 19 ilustra uma triangulac?a?o J1 com dom??nio
em [0,2]2, onde V 0 = {(1,1)}, Sym(N) = {(1,2),(2,1)} e o conjunto S =
{(?1,?1),(?1,1),(1,?1),(1,1)}.

A partir do ve?rtice ??mpar v0 = (1,1) sa?o definidos quatro qua-
drantes. O quadrante que conte?m os tria?ngulos T1 e T4 corresponde a?
direc?a?o s1 = (?1,?1); o quadrante que conte?m os tria?ngulos T2 e T3 cor-
responde a? direc?a?o s2 = (?1,1); o quadrante que conte?m os tria?ngulos
T5 e T8 e? referente a? direc?a?o s3 = (1,?1); e o quadrante que conte?m os
tria?ngulos T6 e T7 e? referente a? direc?a?o s4 = (1,1).

Cada quadrante e? dividido em dois tria?ngulos, que sa?o definidos
pelas permutac?o?es. Sendo assim, podemos afirmar que cada simplex em
uma triangulac?a?o J1 pode ser identificado de forma u?nica por uma tripla
(v0,?,s)?V 0×Sym(N)×Sn. O tria?ngulo T1 da Figura 19 e? definido pela



138

0 1 2

1

2

Figura 19: J1 ordenada em [0,2]2

tripla [(1,1),(1,2),(?1,?1)]. Para a func?a?o ilustrada na Figura 8, com
K = 4, n = 2 e V 0 = {(1,1), (1,3),(3,1),(3,3)} e Sym(n) = {(1,2),(2,1)},
o tria?ngulo (politopo) P3 = {(1,3),(0,3),(0,2)} e? definido a partir da
tripla (v0,?,s), onde v0 = (1,3), ? = (1,2) e s = (?1,1).

Agora, vamos definir formalmente a triangulac?a?o J1. Seja ei o
i?e?simo vetor unita?rio de Rn. Para cada (v0,?,s) ? V 0 ×Sym(N)×
Sn, ha? um simplex definido por j1(v0,?,s), cujos ve?rtices {vi}ni=0 sa?o
definidos da seguinte forma:{

v0 = v0
vi = vi?1 + s? (i) e

? (i),?i ? N

Para ilustrar essa definic?a?o, apresentaremos a seguir a aplicac?a?o deste
me?todo para o tria?ngulo T1 definido pela tripla [v0,?,s], onde v0 = (1,1),
? = (1,2) e s = (?1,?1):

v0 = (1,1)

v1 = v0 + s? (1) e
? (1), onde ? (1) = 1, s1 = ?1, e1 = (1,0)

v1 =
[

1
1

]
+ (?1)?

[
1
0

]
=

[
0
1

]
v2 = v1 + s? (2) e

? (2), onde ? (2) = 2, s2 = ?1, e2 = (0,1)

v2 =
[

0
1

]
+ (?1)?

[
0
1

]
=

[
0
0

]



139

A.2 ORDENAC?A?O NUMA TRIANGULAC?A?O J1

Neste sec?a?o, apresentamos uma heur??stica para ordenac?a?o dos
simplexes da triangulac?a?o J1 no R2. A Figura 19 ilustra uma trian-
gulac?a?o J1 em [0,2]2 com os tria?ngulos e ve?rtices ordenados conforme
as propriedades O1 e O2 apresentadas na Sec?a?o 3.5.2. A heur??stica de
ordenac?a?o da triangulac?a?o J1 foi dividida em tre?s partes.

A primeira parte cria uma ordenac?a?o para os ve?rtices ??mpares
v0 ? V 0 de acordo com as coordenadas em X e Y . Inicialmente, os
ve?rtice (xi,yi) ? V 0 sa?o ordenados em relac?a?o a X . Em seguida, os
ve?rtices com a mesma coordenada xi sa?o ordenados em relac?a?o a Y .
Esta ordenac?a?o garante que haja intersec?a?o entre os quadrantes.

A segunda parte ordena os tria?ngulos de cada quadrante com
base nos para?metros que definem cada simplex da triangulac?a?o V 0,
Sym(n) e Sn com o objetivo de garantir que a propriedade O1 seja sa-
tisfeita. Os tria?ngulos sa?o ordenados em direc?o?es de subida e descida,
conforme ilustrado na Figura 19.

A subida do lado esquerdo do quadrante, correspondente a?s dire-
c?o?es Se = {(?1,?1),(?1,1)}, seleciona os tria?ngulos T1{v0 = (1,1),? =
(1,2),s = (?1,?1)} e T2{v0 = (1,1),? = (1,2),s = (?1,1)}, com a permu-
tac?a?o (1,2). Em seguida, a descida e? realizada com a escolha da permu-
tac?a?o (2,1), definindo os tria?ngulos T3{v0 = (1,1),? = (2,1),s = (?1,1)}
e T4{v0 = (1,1),? = (2,1),s = (?1,?1)}.

A subida do lado direito do quadrante, correspondente a?s di-
rec?o?es Sd = {(1,?1),(1,1)}, seleciona os tria?ngulos T5{v0 = (1,1),? =
(2,1),s = (1,?1)} e T6{v0 = (1,1),? = (2,1),s = (1,1)}, com a permuta-
c?a?o (2,1). Em seguida, a descida e? realizada com a escolha da permu-
tac?a?o (1,2), definindo os tria?ngulos T7{v0 = (1,1),? = (1,1),s = (1,1)}
e T8{v0 = (1,1),? = (1,2),s = (1,?1)}.

Na segunda parte da heur??stica, os tria?ngulos foram ordenados
de tal forma que ha? pelo menos um ve?rtice comum entre os tria?ngulos
subsequentes. A terceira parte da heur??stica define a ordenac?a?o dos
ve?rtices de cada tria?ngulo com o objetivo de satisfazer a propriedade
O2. Para isto, dados os tria?ngulos subsequentes Ti e Ti+1, basta escolher
um ve?rtice em comum desses tria?ngulos e garantir que este ve?rtice sera?
o u?ltimo ve?rtice de Ti e o primeiro ve?rtice de Ti+1. O primeiro ve?rtice do
primeiro tria?ngulo e? escolhido do conjunto dos ve?rtices deste tria?ngulo
que na?o sa?o comuns ao tria?ngulo subsequente. O u?ltimo ve?rtice do
u?ltimo tria?ngulo e? escolhido do conjunto de ve?rtices deste tria?ngulo
que na?o sa?o comuns ao tria?ngulo anterior.



140

A.3 TAMANHO DAS FORMULAC?O?ES

Esta sec?a?o apresenta o tamanho das formulac?o?es desenvolvidas
para as aproximac?o?es por simplexes e por hipercubos para as diferentes
qualidades de aproximac?a?o apo?s o presolve do CPLEX, etapa na qual
se realizam reduc?o?es de redunda?ncias do problema original. As Tabelas
10, 11 e 12 apresentam o nu?mero de varia?veis cont??nuas, bina?rias e de
restric?o?es das formulac?o?es com base nos modelos DCC, DLog, CC e
MC para a aproximac?a?o por simplexes com qualidades de aproximac?a?o
baixa, me?dia e alta, respectivamente.

Tabela 10: Tamanho da Formulac?a?o (Qualidade Baixa, Simplexes)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 5.170 1.522 1.753
DLog 5.170 228 637
CC 940 1.586 1.141
Log 228 940 599
MC 690 1.674 3.351

Tabela 11: Tamanho da Formulac?a?o (Qualidade Me?dia, Simplexes)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 45.026 12.318 12.549
DLog 45.026 300 781
CC 4.226 15.890 4427
Log 4.226 336 821
MC 8.574 3.250 15.637

Tabela 12: Tamanho da Formulac?a?o (Qualidade Fina, Simplexes)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 65.122 19.102 19.333
DLog 65.122 364 909
CC 7.874 22.802 8.075
Log 7.874 368 917
MC 21.886 9.906 47.765

Em seguida, as Tabelas 13, 14 e 15 apresentam o nu?mero de va-
ria?veis cont??nuas, bina?rias e de restric?o?es das formulac?o?es com base nos



141

modelos DCC, DLog, CC e SOS2 para a aproximac?a?o por hipercubos
com qualidades de aproximac?a?o baixa, me?dia e alta, respectivamente.

Tabela 13: Tamanho da Formulac?a?o (Qualidade baixa, Hipercubos)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 2.418 498 729
DLog 2.418 190 561
CC 940 498 1.141

SOS2 1.258 50 599

Tabela 14: Tamanho da Formulac?a?o (Qualidade me?dia, Hipercubos)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 18.178 3.108 3.339
DLog 18.178 262 705
CC 4.226 3.108 4.427

SOS2 4.830 50 885

Tabela 15: Tamanho da Formulac?a?o (Qualidade fina, Hipercubos)

Modelo Varia?veis cont??nuas Varia?veis Bina?rias Restric?o?es
DCC 47.474 8.434 8.665
DLog 47.474 328 837
CC 10.268 8.434 10.469

SOS2 11.210 50 1.223

A.4 SOLUC?A?O DAS INSTA?NCIAS DO PROBLEMA

Os modelos de linearizac?a?o por partes multidimensional apre-
sentados nesta dissertac?a?o sa?o equivalentes quando a aproximac?a?o e? a
mesma. Esta sec?a?o apresenta a soluc?a?o do problema de otimizac?a?o para
as aproximac?o?es por simplexes e hipercubos com as diferentes qualida-
des de aproximac?a?o. A Tabela 16 apresenta os ganhos e custos conside-
rados na func?a?o objetivo max f = ?

m?M
(poqmo + pgq

m
g ?pwqmw)? ?

n?N
pni q

n
inj.

As Tabelas 17 e 18 apresentam o valor da func?a?o objetivo, as vazo?es de
o?leo, ga?s e a?gua e a pressa?o nominal dos manifolds resultantes da solu-
c?a?o obtida para as aproximac?o?es por simplexes e por hipercubos para



142

as aproximac?o?es baixa, me?dia e fina. As vazo?es esta?o apresentadas em
metros cu?bicos (sm3) e a pressa?o dos manifolds em psia.

Tabela 16: Custos/Ganhos Econo?micos

Ganho com venda de o?leo (po) 20
Ganho com venda de ga?s (pg) 2

Custo com tratamento de a?gua (pw) 1
Custo com compressa?o de ga?s (pi) 0

Tabela 17: Soluc?a?o com Simplexes

Qualidade Baixa Me?dia Fina
Func?a?o Objetivo 5.016.386 5.015.744 5.015.925

Vaza?o de o?leo (qmo )
m1 1.328 1.139 1.299
m2 1.526 1.680 1.532

Vaza?o de ga?s (qmg )
m1 1.240.000 1.240.000 1.240.000
m2 1.240.000 1.240.000 1.240.000

Vaza?o de a?gua (qmw)
m2 317 180 315
m2 400 483 402

Pressa?o absoluta (pm)
m1 535 528 550
m2 457 470 460

Em seguida, as vazo?es para injec?a?o de ga?s nos poc?os sa?o apre-
sentadas nas Tabelas 19 e 20 para as aproximac?o?es por hipercubos e
simplexes, respectivamente, considerando as qualidades de aproxima-
c?a?o baixa, me?dia e alta.



143

Tabela 18: Soluc?a?o com Hipercubos

Qualidade Baixa Me?dia Fina

Func?a?o Objetivo 5.015.756 5.015.782 5.015.948

Vaza?o de o?leo (qmo )
m1 1.297 1.140 1.300
m2 1.526 1.681 1.533

Vaza?o de ga?s (qmg )
m1 1.240.000 1.240.000 1.240.000
m2 1.240.000 1.240.000 1.240.000

Vaza?o de a?gua (qmw)
m1 315 184 315
m2 405 483 401

Pressa?o absoluta (pm)
m1 549 528 551
m2 459 470 460

Tabela 19: Injec?a?o de Ga?s (Hipercubos)

Poc?o Qualidade Baixa Qualidade Me?dia Qualidade Fina
1 90.576 84.950 73.194
2 135.883 225.065 136.051
3 90.576 93.092 89.375
4 90.576 149.726 89.375
5 92.915 121.409 113.265
6 135.883 121.409 113.265
7 90.576 93.092 105.556
8 90.576 76.610 97.084
9 119.002 104.927 97.084
10 74.250 104.927 89.403
11 74.250 48.293 80.903
12 74.250 54.243 73.223
13 74.250 48.293 80.903
14 74.250 76.610 102.177
15 119.556 48.293 97.084
16 119.556 76.610 105.585



144

Tabela 20: Injec?a?o de Ga?s (Simplexes)

Poc?o Qualidade Baixa Qualidade Me?dia Qualidade Fina
1 90.612 84.950 72.717
2 128.628 226.535 129.446
3 90.612 87.486 89.342
4 133.282 169.901 89.342
5 90.612 113.267 113.265
6 90.612 121.290 113.265
7 90.612 84.950 113.265
8 90.612 75.108 97.084
9 90.612 104.903 97.084
10 90.612 104.903 89.436
11 90.612 48.269 80.903
12 59.566 48.269 80.903
13 90.612 48.269 80.903
14 90.612 80.768 89.436
15 104.872 48.269 97.084
16 110.246 80.768 113.265


</field>
	</doc>
</add>