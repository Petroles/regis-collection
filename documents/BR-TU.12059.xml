<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.12059</field>
		<field name="filename">17576_Vieira_WilliamGoncalves_D.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE ESTADUAL DE CAMPINAS 

FACULDADEDEENGENHMUAQuThnCA 

DEPARTAMENTO DE SISTEMAS DE PROCESSOS QuThnCOS E INFORMÁTICA 

FCC: CONTROLE PREDITIVO E IDENTIFICAÇÃO VIA REDES NEURAIS 

Autor: William Gonçalves Vieira 

Orientadora: Dra. Ana Maria Frattini Fileti 

Co-Orientador: Dr. Florival Rodrigues de Carvalho 

Tese de Doutorado apresentada à Faculdade de Engenharia Química como parte dos 

requisitos exigidos para a obtenção do título de Doutor em Engenharia Química. 

Campinas - São Paulo 
Dezembro de 2002 

UNlCAMP 



V EX 
TOMBO BC/ 5 3"'l~J'I'"grrrgr 
PROC • • j_;z Lf-J() ê 

cn Dr;:) 
PREço ::f: :{1. qo 
DATA ~:j_/Qq/03 

N• CPO 

FICHA CATALOGRÁFICA ELABORADA PELA 
BIBLIOTECA DA ÁREA DE ENGENHARIA - BAE - UNTCAMP 

V673f 
Vieira, William Gonçalves 

FCC: controle preditivo e identificação via redes 
neurais I William Gonçalves Vieira. --Campinas, SP: 
[ s.n.], 2002. 

Orientadores: Ana Maria Frattini Fileti e Florival 
Rodrigues de Carvalho. 

Tese (doutorado) -Universidade Estadual de 
Campinas, Faculdade de Engenharia Química. 

1. Craqueamento cata!ítico. 2. Redes neurais 
(Computação). 3. Controle preditivo. L Fileti, Ana 
Maria Frattini. II. Carvalho, Florival Rodrigues de. ill. 
Universidade Estadual de Campinas. Faculdade de 
Engenharia Química. IV. Título. 



Tese de Doutorado defendida por William Gonçalves Vieira e aprovada em 06 de 

dezembro de 2002 pela banca examinadora constituída pelos doutores: 

i 

Prof'. Dr". Ana Maria Frattini Fileti ~ntadora)- FEQ!UNICAMP 

' 

·~se da Cunha- CSN 

' . J ' 

'vl:vr 
Prof'. Dr•. Liliane Maria Ferrareso Lona- FEQIUNICAMP 

Prof. Dr. Antônio Carlos Luz Lisboa- FEQIUNICAMP 



Este exemplar corresponde à versão final da Tese de Doutorado em 

Engenharia Química. 

Profa. Dra. Ana Maria F 
(orientador 

li i 



iv 

À esposa e filhos 

Célia, Fábio, Leandro e Vmícius 



AGRADECIMENTOS 

A Deus acima de tudo, por me permitir viver e assim realizar. 

À minha amada esposa pelo apoio e incentivo durante toda esta jornada; sem ela eu 

tenderia ao fracasso. 

Aos meus filhos por sua paciência, apmo e compreensão durante minhas ausências do 

convivio familiar. 

À minha orientadora Dra. Ana Frattini, pela sua experiência, suas criticas e sugestões bem 

vindas e necessárias à realização desta Tese. 

Ao co-orientador, Dr. Florival, por sua grande ajuda e total apoio, sem o qual eu não 

conseguiria terminar esta tarefa. 

Ao Professor Dr. Mauricio Bezerra, pela autorização do uso de suas rotinas 

computacionais. 

À colega Vivianni, pela amizade e apoio. 

Aos professores e funcionários da UFPE pela disponibilização de seu precioso tempo. 

Ao Departamento de Engenharia Química da Universidade Federal de Pernambuco, por 

ceder espaço, equipamentos e materiais necessários. 

A Universidade Federal de Alagoas pela liberação para realização desta Tese. 

A CAPES/PIDCT pela ajuda financeira na concessão da bolsa de doutorado. 

v 



Resumo: A unidade de Craqueamento Catalitico em Leito Fluido - FCC, modelo Kellogg 
Orthoflow F., representa um processo de refino de petróleo apresentando característica 
altamente não linear, possuindo fortes interações entre as variáveis de produção, e 
condições de operação extremamente severas. Essas unidades são constituídas basicamente 
de duas seções: urna de reação catalitica na qual ocorrem as reações de quebra de cadeia 
hidrocarbônica e também há formação de coque, desativando o catalisador; e outra seção 
onde ocorre a regeneração do catalisador desativado. O objetivo dessa unidade é 
transformar produtos de elevado peso molecular, que apresentam baixo valor agregado, em 
compostos de elevado valor comercial. As unidades FCC, devido às condições severas de 
operação, necessitam de um controle rigoroso de determinadas variáveis operacionais. 
Apesar de existirem instalados controladores avançados baseados em modelos de 
convolução, freqüentemente essas unidades são reguladas por meio de controladores PID 
padrões e também através de controle manual baseado no conhecimento de operadores das 
refinarias. O presente estudo tem como objetivo desenvolver um controlador preditivo 
multivariável (Multivariable Predictive Contra! - MPC) para ser implementado na unidade 
FCC, utilizando Redes Neurais Artificiais (RNA) como modelo interno do controlador. 
Inicialmente é previsto realizar a identificação do processo da FCC em RNA, obedecendo a 
seguinte estratégia: usando um modelo fenomenológico que representa a unidade industrial, 
e partindo de um estado inicial são aplicados diversos degraus nas variáveis manipuladas 
analisando as respostas nas variáveis controladas do processo. A partir destas simulações 
são gerados diversos conjuntos de dados divididos em grupos de treinamento, validação e 
teste. Diversas redes neurais do tipo multicamada jeedjorward são então criadas para 
representar o modelo fenomenológico, sendo selecionada aquela que apresenta melhor 
desempenho, quando comparada com o modelo. A configuração da RNA escolhida como 
modelo interno foi 8x15x4 (camadas de entrada, escondida e de saída, respectivamente) 
apresentando um erro relativo máximo de 1% quando comparado com os resultados do 
modelo rigoroso. Posteriormente, foi previsto desenvolver um controlador preditivo 
multivariável usando como modelo interno esta rede selecionada. Este controlador foi 
implementado dentro da rotina do modelo fenomenológico, sendo então realizados testes 
para verificar seu desempenho, comparando o resultado com o sistema aberto e também 
com o controlador DMC (Dynamic Matrix Contra!) existente. Diversos horizontes de 
predição e controle foram analisados, sendo selecionados aqueles que apresentaram melhor 
desempenho. Foi introduzido um ruído nos sinais do modelo fenomenológico para testar a 
robustez do controlador proposto. O controlador apresentou bom desempenho mesmo na 
presença de ruídos de 1,5%, levando sempre as variáveis controladas para seus valores de 
referência, o que comprova sua robustez. Baseados nestes resultados, conclui-se que um 
controlador preditivo multivariável baseado em RNA é perfeitamente capaz de controlar 
um sistema não linear de porte do FCC, onde elevada interação entre suas variáveis 
operacionais e fortes restrições estão presentes. Isto nos permite extrapolar que são boas as 
expectativas para uma futura utilização na unidade industrial, principalmente devido à sua 
simplicidade, robustez e facilidade de implementação, a despeito da dificuldade de sintonia 
do controlador. 

Palavras Chave: FCC, Redes Neurais Artificiais, Controlador preditivo multivariável. 

vi 



Abstract: The Fluid Cracking Catalytic unit - FCC, Kellogg Orthotlow F. model, 
represents a very strong nonlinear process, with severe interactions among the process 
variables, and extremely severe operation conditions. The unit is composed of two sections: 
one is the catalytic reaction, where the hydrocarbon break:s chain reactions and coke 
deposition tak:e place becoming the catalyst inactive, and the other where the catalyst 
regeneration happens. The objective is to transform products derived from petroleum, with 
lúgh molecular weight and low added value, into products with lúgher profit. Due to the 
severe operation conditions, rigorous control of some variable is needed. In spite of the 
existence of advanced control based on a convolution model, in practice, FCC units are 
frequently regulated by standard PID controllers, and also through manual control actions 
based on the knowledge of the refinery operators. The objective of tlús study is to develop a 
Multivariable Predictive Control (MPC) to be implemented in the FCC unit, using the 
Artificial Neural Networks (ANN) as internai model. Initially, the process identification in 
ANN of the FCC was done by the following strategy: an initial state was first aclúeved 
using numerical simulations based on the phenomenological model. Then, severa! steps 
changes were applied to the manipulated variables and the response in the controlled 
variables were monitored and recorded. From these simulations, severa! groups of data 
were generated for training, validation and testing. The Neural Network of multilayer 
feedforward type were created to represent the phenomenological model, being selected the 
one that better represents the phenomenological model. The ANN configuration chosen to 
be the internai model was 8x15x4 (Input x Hidden x Output) arclútecture, with a maximum 
relative error below 1% when comparing the results with the phenomenological model 
results. Later on, it was developed a multivariable predictive control based on tlús internai 
model. Tlús control was implemented inside the routine of the phenomenological model. 
The performance tests were evaluated comparing the results with the open system and with 
the Dynarnics Matrix Control (DMC). Severa! prediction and control horizons were 
analyzed. The ANN control presented good performance even in the presence of noise of 
1,5% of intensity, tak:ing back the controlled variables to its setpoints, proving its 
robustness. Based on these results, a multivariable predictive control based on ANN 
showed be perfectly able to control a nonlinear system like a FCC unit, where lúgh 
interactions among process variables, and strong restriction conditions exists. Tlús allows 
us to have good expectations for a future use in the industrial unit, mainly due to its 
simplicity, robustness and facility of use, in spite of the difliculty of tune control. 

Keywords: FCC, Artificial Neural Networks, Multivariable Predictive Control. 

vii 



SUMÁRio 

LISTA DE FIGURAS. • • • • • . • . . • • . • • • • • • • • . • • • . . . . . • • • . • • . . • • .. .. .. • • • • • • • . . . xi 

LISTA DE TABELAS............... . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . . . xiii 

NO MEN CLA TURA .. . .. .. .. • .. • • • • • • • . • • . . • • • .. • • • • • • • • .. . .. .. • . . . . . . .. . . • . • . • • • • xiv 

CAPÍTULO I 

INTRODUÇÃO • • . . . . • . . • • . . • • • • .. . • • . • • . • • . . • • • • • . • • • . • • . • . .. .. . • • • • • • • • 1 

1.1 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. 1 

1.2 Estrutura do trabalho . . . . • • • • • • . • . • . • • . . . • . • • . • • . . • . . . • • • • • • • • • • • • 4 

CAPÍTULO TI 

REVIsÃo BmLioGRÁFICA • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • 7 

2.1 Unidade de Craqueamento Catalítico . • • • • • . . . • • • • • • • • • • • • • • . • • • . • • • • 7 

2.2 Redes Neurais Artificiais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 

2. 2.1 Histórico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 

2.2.2 As Redes Neurais Artificiais . • • • • . • • • . • • . • . . • . . • . • • . • . • • • • • • • • • • • • • 16 

2.3 Proposta da Tese • . . • • • • • • • • • • • • • • • • • . • . . . . • • • • • . • • • . . • . • . • . • • • • • • 25 

CAPÍTULO fi 

MODELAGEM MATEMÁTICA DO PROCESSO • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • 27 

3.1 Modelos que representam a unidade de FCC • • • • . • . • . • • • . • • • • • • • • • • • • . 27 

3.2 Processo de Craqueamento Catalítico em Leito Fluido . . • • . . . • • . • . • • • • • • 28 

3. 2.1 Descrição de operação da unidade • • • • • • . • . • • • • • • • • • • • • • . • • • • • • • • • • • • 30 

3.2.2 Estratégia de controle do FCC. • • • • • • • • • • • • • • • • • • • • • • • • • • • • . • • • • • • • • 32 

3.3 As Redes Neurais Artificiais . . • • • • • . • • . • • . . • • • • • • • • • • . . • • • • • • • • • • • • • 35 

3.3.1 Arquitetura das redes multicamadas • • • • • . • . . • • . • • • • • • . • • . . . • . • • . • • • • 36 

3.3.2 Método de Treinamento Backpropagation. • • . . . • • • • . • • . . • • • • • • • • • • • • • • 43 

3.3.3 Identificação em Redes Neurais Artificiais • • • . • • • • • • • • • • • • • • • • • • • • • • • • 48 

3.4 Aplicação das redes neurais no FCC • • • • • . . . . . . • • • • • • • . . • • • • • • • • • • • • . • 52 

3.5 Controle Preditivo com Modelo . • • . • • . • . • • • • • • • • • • • • • • . . • • • • • . • • • • • • 57 

3.5.1 Controle do FCC utilizando conw modelo as Redes Neurais.............. 59 

viii 



CAPÍTULO IV 

RESULTADOS . . . . . . . . . . . . .. . . . . . • . • . . . . . . . . . . . • • • . . • • • . • • • . • . .. • . . . . . . . 65 

4.1 Identificação do modelo fenomenológico via Redes Neurais Artificiais • . • . . 65 

4.1.1 Obtenção dos conjuntos de dados a partir do modelo fenomenológico . • • • . • 65 

4.1.2 Obtenção das condições do treinamento das redes . • . . . • • • • • • • • • • • . • • • . • 66 

4.1.3 Modelo escolhido em rede neural para representar o processo de FCC . • • . • 71 

4.2 Controlador Preditivo usando as RNA como modelo interno • . • • • • • • • • . • . 78 

4.2.1 Comportamento do modelo fenomenológico em malha aberta • . . • • • • • . . • . 82 

4.2.2 Resposta utilizando DMC (Dynamic Matrix Control).................... 82 

4.2.3 Testes de desempenho do controlador proposto . • . • . • • . . . . • • . . . • • • . • • • . 83 

4.2.3.1 Problema regulador............................................. 83 

4.2.3.2 Problema regulador para uma perturbação agressiva • • . • • • . . . . • • . . • . • • 87 

4.2.3.3 Mudança de qualidade da carga • • • • • • . • • • • . • . • • • • • • • • • . • . • • • • • • • . • 89 

4.2.3.4 Problema servo-regulador • . • • • . • • • • • • • • . • . . . . . • . • . . . . . • • . . • . • • . . • 92 

4. 2. 3. 5 Comparação com o controle DMC • • . • . • • • . • . • • • • • • • • • • • • • • • • • • . . • . 95 

CAPÍTULO V 

CONCLUSÕES E SUGESTÕES. • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • 99 

REFERÊNCIAS BIBLIOGRÁFICAS • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • 103 

ANExos 

ANEXO A ALGORITMO DE TREINAMENTO VIA RETROPOPAGAÇÃO 

(BACKPROPAGAITON) ••••••••••••••••••••••••••••• • • • • • • • • • • • • • • • • • • • • • 119 

ANEXO B CÁLCULO DOS ELEMENTOS DE J?E(ID DO MÉTODOSTEEPEST DESCENT. 121 

ANEXO C ALGORITMO DO CONTROLE PREDITIVO UTILIZANDO REDES NEURAIS • 123 

ANEXO D MODELO DINÂMICO DO CONVERSOR.. • • • • • • • • • • • • • • • • • • • • • .. • .. • 125 

ANEXO E ALGORITMO DE IDENTIFICAÇÃO DO PROCESSO EM REDES NEURAIS 

ARTIFICIAIS ..••.......••.•••....•.............. · · · · · • · • · · · · · · • • · · · · .. 135 

APÊNDICES . . • . . . . . . . • • . • . . . . . • • . . . . . . . . . . . . . . . . . . . . . . .. • • • • . . . . . . . . . 137 

APÊNDICE 11DENTIFICAÇÃO DE PROCESSO DE UMA UNIDADE DE CRAQUEAMENTO 
CATALíTICO UTILIZANDO REDE NEURAL •••••••••••••••••••••••••••• • •• ••• 141 

ix 



APÊNDICE 2 FCC UNIT: MULTIVARIABLE PREDICTIVE CONTROL WITH ANN 
MODELIN'G. • • • . • . . . • .. .. . • • • • . • . • • • • • • • • • . • . • • • • . • • • • • . . . • • • . • • • • . • . • • . 157 

APÊNDICE 3 FCC: UMA ALTERNATIVA DE CONTROLE PREDITIVO 
MULTIV ARIÁVEL POR REDE DINÂMICA.............................. • • • • • 173 

APÊNDICE4 FCC: PROCESS IDENTIFICATION THROUGH ARTIFICIAL NEURAL 
NETWORKS . . . . • • . .. . . . • . . . . . . . • • • . • . . • . . . . .. . • . . . . . . . . . . . . . . . . . . . . . . . . 183 

X 



LISTA DE FIGURAS 

Figura 3.1 Circulação de Catalisador em uma Unidade de Craqueamento Catalitico . . . . . . . . . . . . . . 29 

Figura 3.2 Desenho esquemático da Unidade de Craqueamento Catalitico da Kellogg Orthojlow F. 
pertencente à Refinaria Henrique Lage, situada em S. José dos Campos- SP . . . . . . . . . . . 31 

Figura 3.3 Esquema do controle convencional da unidade de Craqueamento Catalitico . . . . . . . . . . . 32 

Figura 3.4 Fonnas de conexão dos neurônios artificiais. 1, 2 e 3 representam as camadas de entrada, 
intermediária ou escondida e de saída, respectivamente . . . . . . . . . . . . . . . . . . . . . . . . . . . 37 

Figura 3.5 Redes mniticamadas feedforward exemplificado para o caso de 3 camadas (a) 
parcialmente conectada e (b) totalmente conectada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38 

Figura 3.6 Representação esquemàtica de um neurônio qualquer pertencente à camada k+ 1 . . . . . . . 40 

Figura 3. 7 Exemplos de função de ativação do neurônio tipo sigmoidal (BAUGHMAN &amp;amp; LIU, 
1995) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42 

Figura 3.8 Estrutura das RNA para n = m = 1 à esquerda e para n = m = 2 à direita para um sistema 
SISO (SANTOS, 2000b).................................................... 51 

Figura 3.9 Opções de identificação do processo utilizando rede neural para capturar o 
comportamento dinâmico; método série-paralelo e método paralelo . . . . . . . . . . . . . . . . . . 52 

Figura 3.10 Esboço da representação da rede neural proposta com arqnitetura 8xl5x4, referente ao 
sistema MIMO mais complexo. Os Bias não estão apresentados por problemas de 
limitação de espaço na figura . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57 

Figura 3.11 Esboço ilustrativo da ação de controle preditivo considerando apenas uma variável 
controlada (sistema SISO) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58 

Figura 3.12 Esquema genérico proposto para um Controlador Preditivo com Modelo utilizando 
Redes Neurais Artificiais (DE SOUZA JR, 1993) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60 

Figura 3.13 Esboço do sistema de controle proposto, via Redes Neurais Artificiais, para 
acoplamento ao controle convencional da unidade FCC . . . . . . . . . . . . . . . . . . . . . . . . . . 63 

Figura 4.1 Resposta na Temperatura da Fase Densa do primeiro estàgio do regenerador, TRGl, aos 
degraus impostos nas variáveis manipuladas, TFP, RAI, RTF e CTCV, com arqnitetura 
8xl5x4 na RNA. Comparação entre RNA (representação em linha continua) e modelo 
fenomenológico (representação descontínua) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73 

Figura 4.2 Resposta na Temperatura da Fase Densa do seguodo estàgio do regenerador, TRG2, aos 
degraus impostos nas variáveis manipniadas, TFP, RAI, RTF e CTCV, com arqnitetura 
8xl5x4 na RNA. Comparação entre RNA (representação em linha continua) e modelo 
fenomenológico (representação descontínua) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73 

Figura 4.3 Resposta na Severidade da Reação Catalitica, variável SEV, aos degraus impostos nas 
variáveis manipuladas, TFP, RAI, RTF e CTCV, com arqnitetura 8xl5x4 na RNA. 
Comparação entre RNA (representação em linha continua) e modelo fenomenológico 
(representação descontínua) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 4 

Figura 4.4 Resposta na Temperatura de Saída do Riser, TR.X, aos degraus impostos nas variáveis 
manipuladas, TFP, RAI, RTF e CTCV, com arqnitetura 8xl5x4 na RNA. Comparação 
entre RNA (representação em linha continua) e modelo fenomenológico (representação 
descontínua) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 4 

xi 



Figura 4.5 Degraus impostos nas variáveis manipuladas: Temperatura da Alimentação do Reator, 
TFP (esquerda), e Vazão de AI para o Regenerador, RAI (direita), nas etapas de 
treinamento e validação da rede neural, na configuração 8xl5x4 (vide Tabela 4.2) . . . . . . 75 

Figura 4.6 Degraus impostos na variável manipulada: Vazão de Alimentação do Reator, RTF 
(esquerda) e Vazão de Catalisador Regenerado, CTCV (direita), nas etapas de treinamento 
e validação da rede neural na configuração 8xl5x4 (vide Tabela 4.2) . . . . . . . . . . . . . . . . . 76 

Figura 4.7 Comparação entre os resultados obtidos da variável TRGl (esquerda) e TRG2 (direita), 
pelo modelo em redes neurais com ruído e os resultados obtidos pelo modelo rigoroso, 
aplicando degraus nas variáveis TFP, RAI, RTF e CTCV, conforme Tabela 4.3, 
configuração 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77 

Figura 4.8 Comparação entre os resultados obtidos da variável severidade da reação catalitica 
(esquerda) e TRX (direita), pelo modelo em redes neurais com ruído e pelo modelo 
rigoroso, com os degraus impostos nas variáveis TFP, RAI, RTF e CTCV (vide Tabela 
4.2, configuração 2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78 

Figura 4.9 Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto 
(linba tracejada). Variáveis controladas: Temperaturas das Fases Deusas do Regenerador, 
primeiro estágio, TRGl (esquerda) e segundo estágio, TRG2 (direita). Perturbação: 
Temperatura do AI para o Regenerador, T AI variação +8% . . . . . . . . . . . . . . . . . . . . . . . . 84 

Figura 4.10 Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto 
(linha tracejada). Variáveis controladas: Severidade da Reação Catalitica, SEV 
(esquerda) e Temperatura de Saída do Riser, TRX (direita). Perturbação: Temperatura 
do Ar para o Regenerador, T AI variação +8% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85 

Figura 4.11 Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto 
(linha tracejada). Variáveis associadas: Temperatura da Fase Diluída do segundo estágio 
do Regenerador- TD2 (esquerda) e Temperatura de Saída Geral do Regenerador • TDG 
(direita). Perturbação: Temperatura do Ar para o Regenerado r, T AI variação +8% . . . . . 86 

Figura 4.12 Problema Regulador. Resultados das ações do controlador nas variáveis mauípuladas 
RAI e CTCV, assumindo como estratégia de otimização manter a variável RTF fixa. 
Perturbação: Temperatura do AI para o Regenerador, T AI variação +8% . . . . . . . . . . . . 86 

Figura 4.13 Problema Regulador. Resultados das ações do controlador nas variáveis mauípuladas 
RTF e TFP, assumindo como estratégia de controle manter a variável RTF fixa. 
Perturl:lação: Temperatura do AI para o Regenerador, T AI variação +8% . . . . . . . . . . . . . 87 

Figura 4.14 Resultados obtidos da ação do controlador (linha cheia) e os resultados do sistema 
aberto (linha tracejada). Variáveis controladas: Temperatura da Fase Densa do primeiro 
estágio do Regenerador, TRGl (esquerda) e Temperatura da Fase Densa do segundo 
estágio do Regenerador, TRG2 (direita). Perturbação: variável SETPDCV intensidade 
de+7,7% ............................................................... 88 

Figura 4.15 Resultados obtidos da ação do controlador (linha cheia) e os resultados do sistema 
aberto (linha tracejada). Variáveis controladas: Severidade da Reação Catalitica 
(esquerda) e Temperatura de Saída do Riser, TRX (direita). Perturl:lação: variável 
SETPDCV intensidade de +7, 7% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88 

Figura 4.16 Ações do controlador nas variáveis manipuladas, RAI e CTCV, assumindo como 
otimização manter a variável RTF fixa. Resposta à perturbação degrau de +7,7% no 
Diferencial. de Pressão entre o Regenerador e o Reator, variável SETPDCV . . . . . . . . . . 89 

Figura 4.17 Ações do controlador nas variáveis mauípuladas, RTF e TFP, assumindo como 
otimização manter a variável RTF fixa. Resposta à perturbação degrau de + 7, 7% no 
Diferencial de Pressão entre o Regenerador e o Reator, variável SETPDCV . . . . . . . . . . 89 

xii 



Figura 4.18 Resultados obtidos do teste de simulação de mudança de qualidade de carga, 
companmdo sistema aberto (linha tracejada) e controlador (linha cheia). Variáveis 
controladas: 1RG1 (esquerda) e TRG2 (direita). Pertwbação: variável KCC, intensidade 
+ 10%, e inserção de ruído de 1,5% nas variáveis controladas. Estratégia de otimização: 
minimizar a produção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90 

Figura 4.19 Resultados obtidos do teste de simulação de mudauça de qualidade de carga, 
companmdo sistema aberto (linha tracejada) e controlador (linha cheia). Variáveis 
controladas: Severidade da Reação Catalitica, SEV (esquerda) e Temperatura de Saída 
do Riser, TRX (direita). Perturbação: variável KCC com intensidade de + lOo/o, e 
inserção de ruído de 1,5% nas variáveis controladas. Estratégia de otimização: 
miniminrr a produção. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91 

Figura 4.20 Resultados das ações do controlador nas variáveis manipuladas RAI e CTCV, 
assumiudo como estratégia de otimização minimizar a produção, como resposla à uma 
pertwbação na variável KCC com intensidade de + 1 0"/o, com inserção de ruído de 1,5% 
nas variáveis controladas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92 

Figura 4.21 Resultados das ações do controlador nas variáveis manipuladas RTF e TFP, assumiudo 
como estratégia de otimização minimizar a produção, como resposla à uma pertwbação 
na variável KCC com intensidade de + 10%, com inserção de ruído de 1,5% nas 
variáveis controladas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92 

Figura 4.22 Resultados obtidos do teste de mudauça de estratégia de produção. Variáveis 
controladas: 1RG1 (esquerda) e 1RG2 (direita). Pertwbação: variável TAl com 
intensidade de +8%, com inserção de ruído de 1,5% nas variáveis controladas. 
Estratégia de otimização: maximizar a produção de GLP . . . . . . . . . . . . . . . . . . . . . . . . . 93 

Figura 4.23 Resultados obtidos do teste de mudauça de estratégia de produção. Variáveis 
controladas: Severidade da Reação Catalitica (esquerda) e TRX (direita). Perturbação: 
degrau na variável T AI com intensidade de +8o/o, e inserção de ruído de 1,5% nas 
variáveis controladas. Estratégia de otimização: maximizar a produção de GLP . . . . . . . 93 

Figura 4.24 Resultados das ações do controlador nas variáveis manipuladas RAI e CTCV, 
assumiudo como estratégia de otimização maximizar a produção de GLP ao invés de 
Nafta. Resposla à uma pertwbação na variável T AI com intensidade de +8%, com 
inserção de ruído de 1,5% nas variáveis controladas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94 

Figura 4.25 Resultados das ações do controlador nas variáveis manipuladas RTF e TFP, assumindo 
como estratégia de otimização maximizar a produção de GLP. Respos1a à uma 
pertwbação na variável TAl de intensidade +8%, com inserção de ruído de 1,5% nas 
variáveis controladas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94 

Figura 4.26 Respos1a comparativa entre os resultados das Temperaturas de Saída das Fases Densas 
do Regenerador, primeiro e segundo estágios - 1RG 1 e 1RG2. No gráfico da esquerda 
estão representados o resultado do controlador proposto (linha cheia) e o resultado sem 
ação do controlador (linha tracejada); e no gráfico da direita estão representados os 
resultados do DMC (MORO, 1992). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95 

Figura 4.27 Resposla comparativa entre os resultados da Severidade da Reação Cataíítica. No 
gráfico da esquerda estão representados o resultado do controlador proposto (linha 
cheia) e o resultado sem ação do controlador (linha tracejada); e no gráfico da direita 
estão representados os resultados do DMC (MORO, 1992). . . . . . . . . . . . . . . . . . . . . . . . 96 

Figura 4.28 Resposla comparativa entre os resultados da Temperatura de Saída do Riser- TRX. No 
gráfico da esquerda estão representados o resultado do controlador proposto (linha 
cheia) e o resultado sem ação do controlador (linha tracejada); e no gráfico da direita 
estão representados os resultados do DMC (MORO, 1992). . . . . . . . . . . . . . . . . . . . . . . . 96 

Figura 4.29 Resposla comparativa entre os resultados da Temperatura da Fase Diluída do Segundo 
Estágio do Regenerador- TD2. No gráfico da esquerda estão representados o resultado 
do controlador proposto (linha cheia) e o resultado sem ação do controlador (linha 
tracejada); e no gráfico da direita estão representados os resultados do DMC (MORO, 
1~·-································································n 

xili 



LISTA DE TABELAS 

Tabela 4.1 Exemplos de alguns resultados de arquiteturas de RNA obtidos para determinação dos 
parâmetros da rede: número de degraus, número de padrões de treinamento e precisão 
do gradiente . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67 

Tabela 4.2 Variáveis manipuladas, suas respectivas perturbações impostas, freqüência de 
amostragem e intervalo de tempo entre cada degrau para os conjuntos de treinamento e 
validação das RNA, nas configurações I e 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 

Tabela 4.3 Variáveis manipuladas, suas respectivas pertwbações impostas, freqüência e tempo de 
amostragem para o conjunto de teste das redes neurais, nas configurações 1 e 2 . . . . . . . 71 

Tabela 4.4 Característica da rede neural que irá representar a unidade FCC como modelo interno do 
71 

controle preditivo ....................................................... . 
Tabela 4.5 Valores obtidos de Pesos e Bias da Rede Neural com arquitetura 8x15x4, obtidos a partir 

de 1367 padrões de treinamento, considerando um valor de 5,26le-4 no gradiente da 
função objetivo e amostragem de 6 em 6 minutos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72 

Tabela 4.6 Dados referentes às condições operacionais do controle preditivo DMC utilizando um 
modelo de convolução (MOR0,1992) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82 

xiv 



AI 

ANN 

BFGS 

co 
co2 
CSTR 

CTCV 

DDE 

DFP 

DMC 

FCC 

FCCU 

FINEP 

FLCs 

GDR 

GLP 

GMC 

GPC 

IA 

IAE 

IMC 

KCC 

LCO 

LDMC 

MAC 

MBPC 

MIMO 

MISO 

MPC 

NOMENCLATURA 

Lista de abreviaturas e siglas 

- Artificia!Intelligence 

-Artificial Neural Networks 

- Broyden-Fletcher-Goldfarb-Shanno 

- Monóxido de carbono 

- Dióxido de Carbono 

- Continuous Stirred Tank Reactor 

-abertura da válvula de catalisador regenerado (abertura de válvula) 

- Differential Difference Equation 

- Davidon-Fletcher-Powell 

- Dynamic Matrix Control 

- Fluid Catalytic Cracking 

- Fluid Catalytic Cracking Unit 

- Financiadora de Estudos e Projetos 

- Fuzzy Logic Contra/ler 

- Generalized Delta-Rute 

- Gás Liqüefeito de Petróleo 

- Generic Model Control 

- Generalized Predictive Contra! 

- Inteligência Artificial 

-Integral Absolute Errar 

-Internai Model Control 

- constante de reação (experimental) 

- Light Cycle Oi! 

-Linear Dynamic Matrix Contra! 

- Model Algorithmic Control 

- Model Base Predictive Contrai 

- Multiple Input and Multiple Output 

- Multiple Input and Single Output 

- Model Predictive Contrai 

XV 



MPLs 

NARX 

NMPC 

NNIMC 

NO, 

PCA 

PI 

PID 

QDMC 

RAI 

RAil 

RAI2 

RECOPE 

RHC 

RNA 

RTF 

SETPDCV 

SETSEV 

SETTRX 

SEV 

SISO 

SOx 

SQP 

SSQ 

TAl 

TD2 

TDG 

TFP 

TRGl 

TRG2 

TRX 

- Multilayer Perceptrons 

- Non-linear Auto-Regressive eXogenous 

-Neural Model Predictive Control 

- Neural Network Internai Model Contrai 

- Óxidos de Nitrogênio 

-Principal Component Analysis 

- Proportional Integral 

- Proportional Integral Derivative 

- Quadratic Dynamic Matrix Control 

-vazão de artotal para o Regenerador (Nm3/h) 

- vazão de ar para o primeiro estágio do regenerador (Nm3 Ih) 

-vazão de ar para o segundo estágio do regenerador (Nm3/h) 

- Projeto de Redes Cooperativas de Pesquisa 

- Receding Horizon Contrai 

-Redes Neurais Artificiais 

-vazão de alimentação do Riser (m31h) 

- setpoint do diferencial de pressão entre o regenerador e o reator 

- setpoint da variável severidade da reação catalítica 

- setpoint da variável temperatura na saída do Riser 

- severidade da reação catalítica 

- Single Input and Single Output 

- Óxidos de Enxofre 

- Successive Quadratic Programming 

- Sum of Square oj residual 

- temperatura do ar para o regenerador COC) 

- temperatura de saída da fase diluída do segundo estágio do regenerador COC) 

- temperatura de saída da fase diluída geral do regenerador (°C) 

- temperatura da alimentação do Riser COC) 

- temperatura da fase densa do primeiro estágio de regeneração (0 C) 

- temperatura da fase densa do segundo estágio de regeneração COC) 

- temperatura na saída do Riser COC) 

xvi 



Lista de Símbolos 

Símbolos latinos 

H - matriz Hessiana das derivadas segundas parciais da função objetivo em 
relação às variáveis independentes 

corr - correção do valor de y predito para cada instante de predição 

d - representa o vetor distúrbio 

e - erro entre valor predito e valor desejado da variável y no treinamento da rede 

E - função objetivo do treinamento da rede neural 

Ep - função erro de cada padrão 

exp - exponencial 

f - função de ativação de cada neurônio 
j - função objetivo 

k - índice: representa o instante atual 

m, n - parâmetro relacionado à ordem do modelo de identificação 

n - representação do neurônio 

Nc - horizonte de controle 

Np - horizonte de predição 

p - índice: representa um padrão p qualquer 

q - índice: representa variáveis controladas 

r - índice: representa variáveis manipuladas 

S - saida do neurônio 

sp - setpoint (trajetória de referência) 

t - saida do processo 

tanh - tangente hiperbólica 

u 

Vmax 

Vmin 

Vnor 

V real 

- valor de entrada de um processo (representa as variáveis manipuladas do 
processo) 

- valor máxímo assumido pela variável 

- valor rnínímo assumido pela variável 

- valor normalizado 

- valor da variável nas unidades do processo 

xvii 



w 

y 

a 

fJ 

'7 

e 
À 

- representação dos pesos das conexões 

- valor de salda de um processo (representa as variáveis controladas do 
processo) 

Símbolos gregos 

- pesos de igual importância nas variáveis controladas 

- filtro para definição das trajetórias de referência 

-constante de momento (momentum) no método do gradiente conjugado 

- taxa de aprendizado no método do gradiente conjugado 

- bias ou threshold 

- função auxiliar que representa a soma das entradas de um neurônio; pesos 
utilizados para penalizar variações excessivas da variável manipulada 

- variação ou delta de uma unidade qualquer 

- representa o gradiente de uma função 

Símbolos especiais 

- símbolo acima das variáveis representativo de variável predita 

- símbolo abaixo das variáveis representativo de vetor 

xvili 



1 

CAPÍTULO I 

INTRODUÇÃO 

1.1 Objetivos 

A unidade de craqueamento catalítico em leito fluido (do inglês Fluid Cracking 

Catalytic Unit - FCCU ou simplesmente FCC) é uma unidade pertencente às refinarias de 

petróleo. Apresenta como objetivo principal o de transformar matéria prima de grande peso 

molecular em produtos mais leves que possuem alto valor agregado. Ela representa o maior 

processo catalítico do mundo e é fundamental não apenas para as refinarias, mas também 

para o cenário econômico mundial, em função da importância de seus produtos. 

Basicamente, esta unidade é composta por um reator e um regenerador, e por possuírem 

elevada interação entre suas variáveis de processo e em função da complexidade das 

cinéticas químicas envolvidas nas reações catalíticas, apresentam dificuldades dinâmicas e 

conseqüentemente dificuldades para operar e controlar. Freqüentemente essas unidades são 

reguladas por meio de controladores PID padrões e também através de controle manual 

baseado no conhecimento de operadores das refinarias. A meta dessa unidade é maximizar 

a produção de Nafla (gasolina automotiva) ou de GLP (Gás Liquefeito de Petróleo), 

controlando a conversão e as variáveis mais representativas, frente às perturbações externas 

e variações na qualidade da carga. 

Os processos químicos, na sua maioria, apresentam características fortemente não 

lineares, entretanto normalmente se utiliza um modelo linear no projeto do controlador 

devido às suas facilidades de implementação. A utilização desse modelo linear, juntamente 

com os controladores PID, apesar de sua versatilidade, pode ser satisfatória numa certa 

região operacional, mas não globalmente. O controle preditivo, por outro lado, apresenta a 

vantagem de permitir a incorporação de modelos não lineares em sua formulação de forma 

direta (LIMA &amp;amp; OLIVEIRA, 1997). Porém, um modelo não linear é dificil de ser 

representado, necessitando do bom conhecimento do processo, além de exigir 

procedimentos computacionais normalmente complexos principalmente no que se refere a 

sistemas multivariáveis, caracterizados como sistema de múltiplas entradas e múltiplas 

saidas (JvfiMO - Multi Input Multi Output), com elevada interação entre as variáveis do 

processo e com fortes restrições (LIMA &amp;amp; OLIVEIRA, 1997). A unidade de FCC 



2 

representa um processo com essas caracteristicas, apresentando restrições de processo e 

condições de operação extremamente severas. O elevado grau de interação entre as 

variáveis envolvidas no processo de FCC torna esse controle bastante complexo para ser 

realizado utilizando a técnica do desacoplarnento das variáveis, muito usada para sistemas 

MIMO em geral; nestes casos a utilização de um controle avançado multivariável se torna 

urna alternativa bastante aceitável. O controle preditivo com modelo (de sua denominação 

em inglês como é conhecida Model Predictive Contra! - MPC) se apresenta atualmente 

como o controle avançado de processo mais utilizado para este tipo de atuação, e o controle 

por matriz dinâmica, utilizando modelo de convolução (do inglês - Dynamic Matrix 

Contra! - DMC), representa o controle tradicional proposto para sistemas como os da 

unidade FCC, sendo sua técnica já bastante conhecida. 

O algoritmo DMC desenvolvido para a unidade FCC, conforme descrito por 

MORO (1992) se baseia em representações numéricas da dinâmica do processo, descritas 

por um sistema de equações diferenciais lineares. O controle linear multivariável apresenta 

como vantagem a facilidade de compor o vetor resultante das perturbações simplesmente 

somando linearmente os efeitos de cada perturbação individual. Isto representa uma 

aproximação do modelo, urna vez que o sistema é inerentemente não linear, e esta 

propriedade não se aplica necessariamente a um sistema não linear. O controle LDMC 

(Linear Dynamic Matrix Contra!) existente na unidade FCC atua em dois módulos: um no 

nivel estático, implementando as restrições do modelo; e outro no nivel dinâmico, onde as 

ações de controle são calculadas a partir dos valores de referência (setpoints) fornecidos 

pelo nivel estático. Podem ser observadas pelo menos duas desvantagens deste controle: a 

primeira seria a utilização de um controle linear (LDMC) para representar o processo 

altamente não linear; e a segunda seria a necessidade de se dividir o controle em dois 

módulos para permitir sua implementação, urna vez que utilizando o LDMC para manipular 

as restrições, realizar ações de controle e otimização em todas as previsões futuras, iria 

gerar uma matriz de programação linear muito grande, impossibilitando sua implementação 

on-line. 

A criação de computadores digitais de baixo custo e alta velocidade de 

processamento possibilitou o uso de métodos matemáticos complexos e mais precisos, em 

substituição aos métodos simplificados, na implantação de controle avançado de processos. 



3 

Com o aperfeiçoamento destes computadores, uma área que se expande é a aplicação de 

Redes Neurais Artificiais (RNA) (em inglês Artificial Neural Networks - ANN), para 

otimização e controle de processos. A utilização de Redes Neurais Artificiais em controle 

de processo já está bastante difundida nos meios de pesquisa, sendo encontrados diversos 

estudos na literatura comparando suas bases matemáticas e algumas aplicações industriais 

de sucesso, conforme NARENDRA (1996). As RNA permitem que se simule um processo 

químico qualquer, sendo ele linear ou não linear, conhecendo-se um histórico operacional 

do processo ou apenas conhecendo-se os dados de entrada e as respostas correspondentes, 

mesmo que não se tenha certeza do mecanismo que rege este processo (NARENDRA &amp;amp; 

MUKHOPADHYAY, 1997). O método se fundamenta na Inteligência Artificial (lA) (do 

inglês Artificial Intelligence -AI). 

A unidade de FCC, por ser extremamente complexa, faz com que qualquer 

tentativa de modelá-la matematicamente gere uma representação bastante aproximada. 

Entretanto, devido ao elevado valor agregado de seus produtos - pois representa o maior 

potencial de ganho econômico de todos os processos de refino de petróleo - torna 

compensador qualquer investimento na área de modelagem (KRISHNA &amp;amp; P ARKIN, 1985). 

O controle preditivo que faz uso de Redes Neurais como modelo para representar a 

dinâmica do processo é denominado por alguns autores (ZHAN &amp;amp; ISHIDA, 1997) de 

controle por Modelo Interno (do inglês Neural Network Interna/ Model Contra/ NNIMC 

ou simplesmente IMC). A potencialidade desta ferramenta foi decisiva na escolha do 

método a ser aplicado neste trabalho. Até o momento não foi encontrado nenhum artigo na 

literatura envolvendo o controle de sistemas dessa complexidade, com características 

multivariáveis, utilizando as RNA como modelo do controlador o que de certa forma 

fornece um caráter inédito ao tema proposto. 

Moro, em sua dissertação de mestrado, fazendo uso de um modelo da unidade 

FCC desenvolvido por KURIHARA (apudMORO, 1992), apresentou um estudo do estado 

estacionário, onde implementou uma estratégia de controle preditivo, usando DMC através 

de um modelo de convolução. Moro validou o modelo fenomenológico, obtido por 

princípios termodinâmicos e de conservação de massa e energia, com os dados da própria 

unidade industrial; a existência desse modelo fenomenológico motivou a realização deste 

estudo. 



4 

A proposta aqui é realizar a identificação do processo de FCC, utilizando o modelo 

fenomenológico desenvolvido por Moro, criando a partir desta identificação um modelo em 

redes neurais para simular o comportamento dinâmico das variáveis mais significativas 

deste processo. Posteriormente, desenvolver um controlador preditivo para esta unidade e 

usar as redes neurais como modelo do controlador. Para verificar seu desempenho, é 

previsto realizar alguns testes envolvendo perturbações nas variáveis do processo, assim 

como efetuar uma comparação entre os resultados do controlador DMC obtido da literatura 

MORO (1992), e os resultados do controlador proposto. 

Recentemente, as pesquisas no Brasil envolvendo a área de petróleo foram 

descentralizadas em função da quebra do monopólio nessa área, tendo sido disponibilizadas 

para as diversas instituições de pesquisa do país. Dentro desta estratégia de 

descentralização foi criada uma rede de pesquisa denominada de projeto RECOPEITACP 

(REdes COoperativas de PEsquisa/Técnicas Avançadas de Controle de Processos), 

financiada pela FINEP, integrando diversas instituições de ensino superior e centros de 

pesquisa do país, com objetivo de estudar e desenvolver métodos de controle de processos 

na área de petróleo. A unidade de FCC, modelo Kellogg Orthojlow F representa um dos 

temas escolhidos para fazer parte do projeto RECOPE, e este estudo é parte integrante deste 

projeto. 

1.2 Estrutura do trabalho 

No CAPÍTULO II é feita uma Revisão Bibliográfica, onde são comentados os 

estudos encontrados na literatura que foram tomados como base para realização desta 

proposta, relacionados à unidade de FCC - item 2.1, e também à técnica de redes neurais -

item 2.2, sendo incluidos um breve histórico e um resumo da técnica, dando ênfase em 

identificação e controle de processos; e no item 2.3 é apresentada a proposta da tese. No 

CAPÍTULO III sob o título Modelagem Matemática do Processo é apresentada uma breve 

descrição de processo de FCC - item 3. 1, uma descrição da operação da unidade e o 

controle convencional normalmente utilizado, com objetivo de situar o leitor no tema 

abordado. O estudo da técnica de Redes Neurais, onde são inseridos o método de 

treinamento utilizado e a metodologia de identificação, é apresentado no item 3.2. A 

descrição do processo de identificação da FCC em redes neurais - item 3.3 e o controle 

preditivo proposto- item 3.4, finalizam o capítulo. No CAPÍTULO IV são apresentados os 



5 

Resultados obtidos, distribuídos em Identificação do modelo - item 4.1, e Controlador 

Preditivo em Redes Neurais - item 4.2. Neste item estão relatadas as dificuldades 

encontradas, os resultados dos testes de desempenho do modelo e as comparações 

efetuadas. No CAPÍTULO V são apresentadas as Conclusões e Sugestões para trabalhos 

futuros. Posteriormente, são apresentadas as Referências Bibliográficas citadas no presente 

estudo. Nos ANEXOS estão mostrados o Algoritmo de Treinamento via Retropopagação 

(Backpropagation), utilizado na identificação da rede (ANEXO A); o Cálculo dos 

Elementos de Ve(}V do método Steepest Descent, citado no treinamento da rede neural são 

apresentados no ANEXO B; o Algoritmo do Controle Preditivo utilizando Redes Neurais é 

mostrado no ANEXO C; o Modelo Dinâmico do Conversor, que foi utilizado como 

simulador da unidade industrial e também para obtenção dos dados de treinamento, está 

incluído no ANEXO D. o Algoritmo de Identificação do Processo em Redes Neurais 

Artificiais é apresentado no ANEXO E. Os artigos enviados para publicação e aceitos para 

apresentações em congressos, sendo publicados em Anais dos eventos, foram inseridos 

como APÊNDICES no presente estudo. 



7 

CAPÍTULO li 

REVISÃO BmLIOGRÁFICA 

Neste capítulo são apresentados alguns estudos, obtidos da literatura, relacionados 

a unidade FCC, e as Redes Neurais Artificiais, os quais contribuíram para realização desta 

proposta. 

2.1 Unidade de Craqueamento Catalítico 

A unidade de FCC é um dos processos mais importante em refinarias de petróleo 

devido à elevada capacidade de produção, rendimento de produtos e a importância deles. 

Um pequeno beneficio neste processo é economicamente atraente. Além disso, as 

exigências dos regulamentos ambientais que restringem as emissões poluentes dessas 

unidades, como é o caso de CO, C02, NOx e SOx, tomaram os seus controles muito 

importantes. Porém, as unidades de FCC representam processos fisicamente complexos e 

inúmeras são as dificuldades para operar e controlar. As seções do regenerador e do reator 

das unidades de FCC são altamente interativas e com dinâmica dificil. O processo, apesar 

de bastante estudado, é pouco conhecido principalmente por causa da complexidade das 

cinéticas químicas envolvidas. Na prática, as unidades de FCC são reguladas 

freqüentemente por meio de controladores padrões PID (Proportional Integral Derivative) 

e também por ações de controle manual baseado no conhecimento dos operadores das 

refinarias (AGUILARA et ai., 1999). 

Diversos estudos já foram realizados envolvendo a unidade de FCC, na tentativa 

de simular matematicamente a unidade, desenvolver equações que pudessem representar 

seus estados estacionários e avaliar o comportamento dinâmico de suas variáveis, utilizando 

equações dos princípios termodinâmicos e expressões cinéticas para a velocidade das 

reações, conforme se observa nos estudos de KURlliARA (1967), ISCOL (1970), LEE &amp;amp; 

KUGELMAN (1973), LEE &amp;amp; GROVES (1985), FALTSI-SARAVELOU et a!. (1991), 

ARANDES &amp;amp; LASA (1992), BALCHEN et a!. (1992), ZHENG (1994), 

KHANDALEKAR &amp;amp; RIGGS (1995), TVRZSKÁ DE GOUVÊA &amp;amp; ODLOAK (1998), 

WANG et a!. (1999a,b), XU etal. (2001) e HODGSON et a!. (2001). 



8 

São muitos os estudos que focalizam diretamente os problemas relacionados ao 

controle e otimização da unidade de FCC. ANSARI &amp;amp; TADÉ (2000) propuseram uma 

estratégia de otimização não linear com restrições aplicada à unidade de FCC. Neste caso o 

modelo dinâmico não linear do processo foi baseado em uma estrutura de unidade que 

utiliza um único estágio no regenerador - denominado de Modelo N da AMCO; o qual foi 

usado para a análise da dinâmica da planta e para testes do sistema de controle não linear 

multivariável proposto. Foi desenvolvido um controlador preditivo com modelo interno 

(IMC), baseado na estratégia de Controle por Modelo Genérico (Generic Modei Contrai-

GMC), com inclusão de restrições dentro do próprio modelo do controlador. O modelo foi 

testado em uma aplicação em tempo real, sendo os resultados da simulação usados para 

atualização dos valores do sistema de controle (um algoritmo dinâmico de atualização de 

parâmetros), para prevenir os possíveis erros de modelagem. Em seu estudo foi dado maior 

importância em manter as variáveis dentro de seus limites de restrição do que em atingir 

um objetivo econômico. Ele mostrou que o ajuste do controlador multivariável não linear 

era muito maís fácil de ser executado do que o ajuste do controlador linear. Os resultados 

do controlador proposto concordaram favoravelmente aos resultados do DMC obtido do 

MATLAB® (utilizando uma estratégia de controle multivariável linear). Na presente 

proposta, é previsto utilizar um controle baseado no algoritmo MPC, similar ao 

desenvolvido por este estudo, utilizando como modelo interno do controlador (IMC) um 

modelo em redes neurais, ao invés do modelo fenomenológico. 

ZANIN et ai. (2000a) descrevem a implementação de uma nova estratégia de 

otimização não convencional em tempo real aplicada na maximização de produção de GLP 

(Gás Liquefeito do Petróleo) em um conversor FCC da Petrobrás na refinaria de São José 

dos Campos. F oram enfatizadas as dificuldades de otimização para os controladores 

existentes. Os testes efetuados foram descritos em detalhes. Eles mostraram que os 

beneficios da otimização não são restritos a fatores econômicos. A implementação da 

estratégia fornece meios de como mudar a forma de pensar dos operadores da unidade. A 

estratégia de otimização implementada mostrou ser capaz de manter o controle da planta 

até mesmo na ausência de algumas variáveis manipuladas e na presença de fortes 

perturbações. Além disso, foi mostrado que a estratégia de otimização pode direcionar o 

processo para novos pontos operacionais. Em outro estudo, ZANIN et ai. (2000b ), 

apresentaram algumas estratégias de otimização na unidade de FCC modelo Kellog 



9 

Orthoflaw F, de forma a manter o controle avançado do processo em condições ótimas 

mesmo quando a estratégia proposta para unidade for alterada, ou seja, o otimizador atua 

em tempo real no controle avançado em qualquer estratégia de produção. Foi usado um 

modelo linear para predição das variáveis de saída do controlador. Foi proposto agilizar a 

estabilização da unidade mesmo na presença de fortes perturbações evitando as situações de 

desvio do estado estacionário (conhecido como off-sets). Na presente proposta é previsto 

utilizar o modelo Kellog Orthoflow F da FCC para obtenção dos dados de treinamento das 

redes neuraís, desenvolver estratégias de otimização do controle além de testar o 

desempenho do controlador simulando a ausência de uma das variáveis manipuladas. 

PRANATYASTO &amp;amp; QIN (2000) utilizaram um processo de Diagnose de Falhas 

no controle da unidade FCC da AMCO Modelo N. Aplicaram um modelo de Análise do 

Componente Principal (Principal Component Analysis - PCA) para detectar e identificar 

falhas em sensores de medida. Alertaram que as falhas de sensores podem ser devido a 

ruído randôrnico, mau funcionamento ou descalibração de instrumento, e afirmaram que o 

controle pode ser ineficiente, se antes de sua ação não for feita uma verificação no sinal do 

instrumento, na tentativa de detectar erros grosseiros que possam influenciar nos resultados 

do controle. O método se baseia na simulação da perturbação no processo comparando o 

desempenho com e sem a validação dos dados. Concluíram que o controlador linear QDMC 

(Quadratic Dynamic Matrix Contra/) com validação de dados apresenta desempenho 

superior ao mesmo controlador sem validação. No presente estudo, acredita-se que o 

modelo proposto em RNA, por apresentar robustez e ser menos afetado com a presença de 

sinaís ruidosos deverá apresentar bom desempenho mesmo em taís condições adversas, 

porém, será criada uma rotina desenvolvida em fontes de códigos computacionaís em 

linguagem Fortran para gerar ruídos na etapa de identificação do modelo e também na etapa 

do controle preditivo e assim confirmar seu bom desempenho nessas condições. 

GÁL VEZ &amp;amp; SOUZA (2000) apresentaram um projeto de controlador 

multivariável baseado no dominio de freqüência, para a unidade FCC modelo Kellog 

Orthoflow F, utilizando o modelo matemático desenvolvido por MORO &amp;amp; ODLOAK 

(apud GÁLVEZ &amp;amp; SOUZA, 2000) como "unidade industrial". Tendo realizado o 

desacoplamento das variáveis do controlador, foi discutida a flexibilidade do controle SISO 

neste controle desacoplado. Foi usado o controlador MPC/DMC, com o modelo 



10 

representado por um sistema MIMO 2X2. Observa-se, entretanto, que o modelo utilizado 

foi simplificado, pois originalmente deveria ser representado, no mínimo, por um sistema 

MIMO 4X4. No presente estudo, o mesmo modelo fenomenológico verificado por MORO 

&amp;amp; ODLOAK (1995), foi utilizado. O sistema MIMO proposto por GÁL VEZ &amp;amp; SOUZA 

(2000) será substituído por um modelo em RNA, não estando prevista nenhuma 

simplificação no modelo, apesar de ser esperado elevado grau de complexidade nessa 

simulação. 

MORO (1992) apresentou como tema de mestrado o desenvolvimento de um 

controlador preditivo multivariável para unidade de FCC. O modelo do controlador adotado 

foi baseado no modelo fenomenológico de 1 O lumps (grupos de componentes), 

desenvolvido por KURIHARA (apud MORO, 1992). Tendo em vista a utilização desse 

mesmo modelo como modelo fenomenológico para identificação em RNA, este estudo será 

descrito em mais detalhes a seguir. 

O modelo desenvolvido por KURlliARA (1967) foi fundamentado em um sistema 

envolvendo o craqueamento no Riser e dois estágios de regeneração, com queima parcial 

do CO. As informações utilizadas na modelagem foram obtidas a partir de princípios de 

conservação e termodinâmicos na unidade de Craqueamento Catalítico. Estes princípios 

foram utilizados para simular a unidade industrial e as equações resultantes estão incluídas 

no ANEXO D do presente estudo. 

Para a validação do modelo Moro realizou vários testes na unidade industrial e no 

modelo fenomenológico, comparando seus resultados. Estes testes constaram de aplicação 

de urna variação degrau a cada uma das variáveis manipuladas individualmente, mantendo 

as demais variáveis nos seus estados estacionários observando as respostas nas variáveis 

mais importantes, considerando o sistema aberto. O mesmo procedimento foi aplicado na 

unidade industrial obtendo essas respostas experimentalmente, sendo então feita uma 

comparação entre os resultados. Todos os testes apresentaram limitações na amplitude dos 

degraus devido a restrições de segurança e operacionais, sendo considerado como limite 

máximo um degrau de 1% nas variáveis manipuladas, tendo em vista que a operação da 

unidade não permitia degraus excessivos nessas variáveis e também devido à instabilidade 

operacional oriunda da operação de alguns controles em manual. Mesmo considerando a 



11 

imprecisão dos dados coletados industrialmente, e a limitação descrita acima, o modelo foi 

considerado satisfatório pelo autor. 

O controle foi desenvolvido a partir do LDMC (Linear Dynamic Matrix Contra!), 

dividindo-o em duas partes: uma estática, onde são tratadas as restrições de processo; e 

outra dinâmica, onde são calculadas as ações de controle utilizando os valores de referência 

fornecidos pelo modelo no nível estático. Esta estratégia visou reduzir o esforço 

computacional exigido pelo sistema, no cálculo do modelo fenomenológico. Após 

validação do modelo, foi feita a aplicação do controlador proposto ao controle digital 

convencional da unídade. Para isto foram escolhidas as seguintes variáveis do processo 

como controladas: - temperatura de saída do reator, que representa bem as variações do 

processo; - severidade da reação catalítica, que representa de certa forma a conversão; e, -

temperaturas do regenerador, fases densas do primeiro e segundo estágios. As variáveis 

escolhidas como manípuladas foram: - vazão de ar para o regenerador; - abertura da válvula 

de catalisador regenerado; - vazão de carga; e - temperatura da carga. 

O primeiro teste do controlador consistiu de maximização da severidade; e o 

segundo teste de maximização da carga. Visando verificar a atuação do controlador frente a 

perturbações não medidas, foi aplicado um degrau no valor de referência do controlador de 

pressão diferencial reator/regenerador. Em todos os testes efetuados a atuação do 

controlador se mostrou eficiente. Isto levou o autor a concluir que o controle proposto era 

considerado adequado para implementação on-line. No presente estudo é proposto realizar 

a identificação do modelo de FCC através da simulação do sistema em malba aberta, 

utilizando o modelo matemático desenvolvido por Moro. Devido às restrições inerentes ao 

próprio modelo e às limitações operacionais descritas em sua dissertação, serão tornadas 

precauções para restringir a amplitude das variações em todas as variáveis controladas e 

associadas do processo. Posteriormente, no desenvolvimento do controlador preditivo, esse 

modelo fenomenológico será usado para simular a operação da unídade FCC. 

A seguir, são citados ainda alguns estudos encontrados na literatura, referentes à 

simulação e/ou controle nas unídades de FCC, que além de confirmar o elevado interesse 

em pesquisa nessa área, a situa como uma área que, "apesar de bastante estudada, é pouco 

conhecida" (AGUILARA etal., 1999), e por isto ainda apresenta muito a ser desenvolvido. 



12 

GROSDIDJER et ai. (1993) visaram incluir as restrições inerentes ao processo 

dentro da malha de controle, utilizando um controlador MPC tipo IDCOM-M, na unidade 

FCC pertencente a Neste Qy's Porvoo refinery (projeto TExAco®), sem sacrificar muito o 

tempo de processamento. 

KHANDALEKAR &amp;amp; RIGGS (1995) propuseram um simulador dinâmico para a 

unidade de FCC, modelo IV da AMCO, desenvolvido usando modelos matemáticos. O 

conjunto de equações diferenciais resultantes deste modelo foi resolvido usando o método 

de Runge-Kutta de quarta ordem. O controle proposto foi baseado no tipo Generic Model 

Control (GMC). 

MORO &amp;amp; ODLOAK. (1995) utilizaram o modelo desenvolvido por MORO 

(1992), e conseguiram implementar degraus maiores que 1% nas variáveis manipuladas. 

Eles constataram que o modelo fenomenológico existente, desenvolvido para unidade de 

FCC, representa bem a dinâmica da unidade industrial, mesmo para degraus maiores que 

1%. 

KALRA &amp;amp; GEORGAK.IS (1996) analisaram a influência das características 

operacionais do reator de FCC (Modelo IV da AMCO), utilizando MPC linear no controle 

do processo não linear, para diferentes condições de operação. 

GOH et a!. (1997) utilizam um modelo linear robusto para controle multivariável 

do processo do FCC, que foi considerado não linear, utilizando modelo baseado em 

controle preditivo por matriz dinâmica (DMC). 

YANG et ai. (1998) propuseram uma ação de controle hierárquica multi-objetiva, 

que pudesse, ao mesmo tempo, realizar o controle e também as restrições do processo de 

uma unidade de FCC. Um controle do tipo Model Base Predictive Control (MBPC), com 

inclusão de restrições de processo na formulação das leis de controle, foi proposto e 

desenvolvido, obedecendo a um critério de prioridades previamente estabelecido, de forma 

a não sobrecarregar computacionalmente o sistema. 

AGUILARA et a!. (1999), utilizaram um projeto de controle regulatório para 

estabilização das temperaturas do reator e do regenerador de uma unidade de FCC, 

utilizando o modelo de LEE &amp;amp; GROVES (apud AGUILARA et ai., 1999), criado a partir 

do modelo de 3 lumps. A estrutura do controlador proposta foi semelhante a um 



13 

compensador Proporcional duplo Integral (Pe), que de acordo com os autores, apresenta 

maior robustez do que o controle PI tradicional. 

ANTONIADES &amp;amp; CHRISTOFIDES (1999) propuseram uma metodologia para a 

síntese de controladores não lineares de realimentação para sistemas com uma única 

entrada e única salda (SISO - Single Input and Single Output) não linear denominada 

Dif.ferential Dif.ference Equation (DDE) que inclui retardo de tempo no atuador de controle 

e no sensor de medida, sendo aplicada com sucesso em uma unidade de FCC. 

NIEDERBERGER et ai. (2000) apresentaram um software de simulação/ 

otimização de processo de unidades de FCC pertencente à Petrobrás, denominado de 

SIMCRAQ0 T (um simulador estático destinado à avaliação, otimização e projeto de 

conversores de unidades de FCC; desenvolvido pelo Programa de Desenvolvimento de 

Tecnologia e Estratégica de Refino - PROTER através do Programa FCC - Petrobrás, para 

a conversão de resíduos). Este software, de acordo com os autores, pode ser usado em todas 

as unidades de produção, independente do modelo existente, permitindo simulações, ajuste 

de parâmetros e otimização onde se procura condições operacionais que garantam máxima 

rentabilidade. O modelo incorpora as melhorias no processo de FCC realizadas ao longo de 

anos na companhia. Este pacote apresenta como principal característica a facilidade de uso 

devido à interface gráfica do software, apresentando fácil sintonia e se adaptando às 

diversas geometrias de reator/regenerador, capacidades e qualidade de carga, relatam seus 

autores. 

Poucos artigos foram encontrados na literatura até a presente data, relacionando 

FCC e RNA ou rede Fuzzy, merecendo destaque: 

RUIZ &amp;amp; SONNET (2000) descrevem a aplicação de um pacote comercial 

(NeurOn-Line Studio, Gensym Corporation, Cambridge, Massachusetts, USA), 

desenvolvido utilizando estruturas em RNA para análise, otimização e como redutores de 

modelo. No mesmo pacote, são previstos a configuração do modelo, treinamento, validação 

e teste. Para maximização de produtividade, podem ser tomadas decisões assistidas ou 

automáticas, podendo ser incorporadas restrições de processo. O pacote foi testado na 

unidade FCC pertencente à unidade REPSOL YPF da refinaria de La Plata, Buenos Aires, 

Argentina, na área de controle de qualidade, desenvolvendo um sistema de inferenciação 

em linha do ponto de destilação 90% de Nafta, para criar dessa forma um modelo reduzido 



14 

em redes neurais. O modelo criado mostrou boa predição do ponto de destilação 90% de 

Nafta. 

SARMA &amp;amp; RENGASW AMY (2000) desenvolveram um controlador com base na 

rede Fuzzy (Fuzzy Logic Controller - FLCs) para ser utilizado numa unidade com 

característica não linear e com fortes interações entre suas variáveis de operação. O FLCs 

foi considerado adequado para ser utilizado com um desacoplador linear (Static Linear 

Decoupler - SLD), agindo como um controlador multivariável "descentralizado", 

denominado GS-FLC/SLD multivariável (General Sigmoidal Gain-Scheduled Fuzzy Logic 

Controller). Esta técnica de controle foi aplicada em uma unidade de FCC, modelada como 

um sistema com dinâmica de ordem 3, e o sistema multivariável GS-FLC/SLD demonstrou 

um bom desempenho de controle servindo como servo/regulatório e apresentando robustez. 

WANG et a!. (1999a) propuseram um estudo usando funções wavelet e redes 

neurais para identificação e diagnóstico de processo. Em outro artigo, W ANG et al. 

(1999b), testaram o sistema proposto anteriormente numa unidade de FCC. 

SANTOS et a!. (2000a) reportam o uso de redes neurais na identificação de 

processo da FCC, considerando dois modelos distintos, um mais complexo, desenvolvido 

por Kurihara, e outro mais simples, desenvolvido por Lee &amp;amp; Kugelman. Neste último 

modelo foi possível um estudo detalhado, com cálculo do ponto de operação ótimo, dentro 

dos padrões de estabilidade, utilizando-se um programa computacional, (AUT0/97). Este 

programa (AUT0/97), disponivel em fontes de códigos computacionais em linguagem 

F ortran, é utilizado para obtenção dos diagra1nas de bifurcação onde localiza as regiões de 

operação estáveis. Neste estudo eles se limitaram a sistema SISO para ambos os modelos. 

Foi proposto ainda o controle do processo do FCC baseado no controle preditivo, utilizando 

o modelo desenvolvido na identificação, sendo aplicado apenas no modelo de Lee &amp;amp; 

Kugelman. Os resultados mostraram que as RNA capturaram o comportamento não linear 

do processo com relativamente poucos neurônios. No presente estudo é previsto utilizar um 

processo de identificação, baseado em RNA., semelhante ao descrito no estudo de Santos, 

considerando, entretanto, o sistema MIMO que apresenta características bem mais 

complexas. A rotina de controle proposta também é semelhante à rotina desenvolvida 

naquele estudo. 



15 

Conforme pode ser observado do exposto acima, o problema de controle da 

urúdade FCC tem sido amplamente abordado por várias metodologias. Uma identificação 

desse processo multivariável em redes neurais, devido à complexidade da rede resultante e 

principalmente à pesada carga computacional exigida pelo método de treinamento da rede 

neural, ainda não tinha sido realizada. Por outro lado, o processo de FCC representa um 

desafio onde benefícios sigrúfícativos para indústria de processo e para teoria de controle 

poderiam ser alcançados, e a identificação desse processo baseada em redes neurais pode 

fornecer ao projetista desta urúdade um melhor entendimento da dinâmica do processo 

podendo ser útil como um modelo interno para o Controle Preditivo. O Modelo de Controle 

Preditivo é baseado em um índice de desempenho global e parametrização das variáveis de 

controle em um modelo não linear, com inclusão de restrições, conforme relatado em 

BALCHEN et al. (1992), GROSDIDIER et al. (1993) e ALI &amp;amp; ELNASHAIE (1997). O 

modelo desenvolvido em redes neurais, resultante de um processo de identificação, por ser 

mais robusto do que aqueles desenvolvidos por métodos tradicionais, onde se utilizam 

modelos fenomenológicos, é menos influenciado pela presença de ruídos, podendo ser 

adequado seu uso em sistemas ruidosos (NARENDRA, 1996). 

2.2 Redes Neurais Artificiais 

2.2.1 Histórico 

As primeiras pesquisas realizadas relacionando "sinais de perspicácia" associada à 

atividade cerebral apontam para o século XVIII em um texto Psychology (Briefer Course), 

datado de 1890 de William James (apudNELSON &amp;amp; ILLINGWORTH, 1991; SIMPSON, 

1990). Entretanto, apenas em 1943, em trabalho publicado por McCulloch e Pitts, é 

apresentado um modelo em redes neurais utilizando circuitos elétricos (PRETT &amp;amp; 

GARCIA, 1988; SIMPSON, 1990; NELSON &amp;amp; ILLINGWORTH, 1991). Em 1949, 

Donald Hebb lançou o livro "The Organization of Behavior"; o método de treinamento 

descrito por ele, Hebb 's Learning Rule, ainda hoje é bastante utilizado. Na década de 50 

implementou-se o estudo da aprendizagem em redes neurais, sendo que no fim da década 

foram criados alguns projetos de aprendizagem, entre eles o denominado Perceptron de 

FRANK ROSENBLATT (apud NELSON &amp;amp; ILLINGWORTH, 1991); BERNARD 

WIDROW and MARCIAN HOFF (apud NELSON &amp;amp; ILLINGWORTH, 1991) 

desenvolveram o modelo MADALINE (Multiple ADAptive LINear Elements), que foi a 



16 

primeira aplicação de redes neurais em um processo real - a criação de filtros adaptativos 

para eliminar ecos em linha telefônica. De acordo com o método de aprendizagem proposto 

por Rosenblatt, para perceptrons com duas camadas - uma de entrada outra de saida, os 

pesos eram ajustados conforme a diferença entre os resultados obtidos computacionalmente 

e os resultados esperados (SIMPSON, 1990; NELSON &amp;amp; lLLlNGWORTH, 1991). Na 

década de 60 existiam duas linhas de estudo divergentes entre si, ambas defendendo o 

interesse em propor urna modelagem para compor a Inteligência Artificial - IA; urna que foi 

defendida por Rosenblatt - autor de "Princípios de Neurodinâmica" - sugeriu o perceptron 

como base para a modelagem do cérebro e a IA; e outra defendida por Minsky M. e Papert 

S.- apoiavam a teoria de um processamento simbólico serial para a IA (SIMPSON, 1990). 

Como resultado destas análises e com o sucesso dos processos simbólicos, o estudo das 

redes neurais ficou um pouco esquecido por longo periodo. Na década de 70, os estudos 

aplicando redes neurais ficaram restritos a alguns pesquisadores no Japão, Europa e União 

Soviética. Somente na década de 80, com o surgimento de computadores digitais mais 

rápido e com a descoberta de métodos eficientes de treinamento, auxiliado pela influência 

do fisico John Hopfield que atraiu seguidores para sua área de pesquisa, é que os estudos na 

área de redes neurais prosseguiram com certo entusiasmo. Hopfield propôs uma arquitetura 

de redes neurais que leva hoje seu nome (SIMPSON, 1990; DE SOUZA JR., 1993; 

HAYKIN, 1994). Nos dias de hoje, dezenas de outras arquiteturas de rede neural são 

conhecidas, entre elas: Adalíne; Perceptron; Counterpropagation; Neocognitron; Mapas 

Auto-Organizáveis; Memórias Associativas Bidirecionais; Wave-nets; Backpropagatíon; 

Teoria da Ressonância Adaptativa, dentre outras (DE SOUZA JR., 1993). Alguns 

softwares, que utilizam esta técnica também estão disponiveis nos diversos pacotes de 

métodos matemáticos, podendo citar entre eles o MATLAB®; sendo já bastante conhecida a 

utilização de suas rotinas em redes neurais e redes Fuzzy para solução de sistemas lineares e 

não lineares. As aplicações das RNA nos dias atuais atingem diversos campos do 

conhecimento, mas é na área das ciências exatas que elas se apresentam em maior peso. 

2.2.2 As Redes Neurais Artificiais 

Diversos estudos bem sucedidos encontrados na literatura comprovam a eficácia 

das RNA aplicadas às várias categorias de processos, como observado nos estudos relativos 

a processos químicos e bioquimicos (WANG et al., 1998; DI MASSIMO et al., 1992), e 



17 

também aos aplicados a processos contínuos (HOSKINS &amp;amp; HIMMELBLAU, 1992; 

WANG et al., 1998; ALVES &amp;amp; NASCIMENTO, 2001) e em batelada (FENG&amp;amp; JIN, 1993; 

DONG et al., 1996; FILETI &amp;amp; PEREIRA, 1997; KROTHAPALLY &amp;amp; PALANKI, 1997, 

GREAVES et al., 2001). Na área de simulação, assim como em controle de processos, 

utilizando a línba adaptativa ou preditiva, também são encontrados estudos envolvendo as 

RNA e/ou redes de lógica Fuzzy, destacando-se os estudos de NASCIMENTO JR. (1994), 

NARENDRA (1996), NARENDRA &amp;amp; MUKHOPADHYAY (1997), FILETI &amp;amp; PEREIRA 

(1997), PEREIRA FILHO (1999), ZHAO et al. (2000), FILETI et al. (2000) e SARMA &amp;amp; 

RENGASW AMY (2000). Alguns destes artigos em RNA abordam análise, identificação e 

otimização de processos como observado em POLLARD et al. (1992), SAVKOVIC'-

STEVANOVIC' (1994), NIKRAVESH et al. (1996), e outros as utilizam em diagnose de 

falhas (KA VURI &amp;amp; VENKATASUBRAMANIAN, 1992), ou em ínferenciação on-line 

PEDROSA et al. (2001). 

Especificamente na área de controle, diversos autores centralizaram seus estudos 

em metodologias alternativas para otimizar a atuação de controladores em processos, como 

é o caso de BHAT &amp;amp; McAVOY (1990), HERNÁNDEZ &amp;amp; ARKUN (1992), ZHAN &amp;amp; 

ISHIDA (1992), Y AMADA &amp;amp; Y ABUT A (1992), LEVIN &amp;amp; NARENDA (1993), LEVIN &amp;amp; 

NARENDRA (1996), KIM et a!. (1997), NARENDA &amp;amp; MUKHOPADHYAY (1997) e 

W ANG et al. (1998). Analisando apenas o aspecto matemático do método de redes neurais, 

autores como JOSEPH et al. (1992) e HOLCOMB &amp;amp; MORARI (1992), se preocuparam em 

realizar comparações entre as redes neurais e os métodos clássicos, como métodos lineares 

e métodos estatísticos, visando comprovar o bom desempenho dessa técnica. Outros 

propuseram ainda novas arquiteturas e/ou metodologias de treínamento para as redes 

neurais, visando príncipalmente reduzir o tempo de processamento de computador 

(denomínado de tempo de CPU), conforme se pode constatar nos trabalhos de BHAT &amp;amp; 

McAVOY (1992), YANG et ai. (1994), ROBITAILLE et al. (1996), SALOMON &amp;amp; 

HEMMEN (1996), ZAINUDDIN &amp;amp; EVANS (1997), KROTHAPALLY &amp;amp; PALANKI 

(1997), KAMARTHI &amp;amp; PITTNER (1999) e W ANG &amp;amp; ZHU (2000). 

STEPHANOPOULOS &amp;amp; HAN (1996) apresentaram um apanhado do estado da 

arte numa revisão dos estudos da literatura que utilizaram sistemas baseados em rotinas 

computacionais, classificados como "Sistemas Inteligentes" nas diversas áreas da 



18 

Engenharia de Processos (comentaram entretanto que o termo "inteligente" foi empregado 

erroneamente, e que alguns autores preferiram denominá-los de "conhecimento"). Na área 

de controladores "inteligentes", os autores citaram que sistemas de controle baseados em 

lógicas Fuzzy e em redes neurais são muito eficazes como aproximadores de função em 

sistemas não lineares; isto permitiu uma expansão sem precedentes de artigos publicados 

em algumas áreas, como em retificação de dados, avaliação e otimização de processos 

operacionais, diagnose de falhas, estimação de estados, identificação de processos e 

reconhecimento de padrões. Acrescentaram ainda que na caracterização das RNA é 

necessário definir sua topologia e a função de transferência nos nós da rede; para 

determinar sua estrutura deve ser especificado o número de camadas, o número de nós por 

camada, o grau de conectividade, o "caminho" e o tipo das conexões. Entretanto, precisa 

ainda ser avaliado o conjunto de dados a ser apresentado à rede como padrões e qual o 

critério de aproximação a ser adotado no modelo. Em controle preditivo, eles citam a 

aplicação de RNA como modelo não linear de processo, o qual pode ser usado para 

predizer a resposta futura do mesmo em aplicações de controle e monitoramento de 

processos. Este estudo foi bastante útil para avaliar a tendência dos estudos em redes 

neurais, auxiliando também na compreensão da sua estrutura e definição das variáveis que 

interferem diretamente nas RNA, além de fornecer uma vasta fonte de referências. 

NARENDRA (1996), em um breve resumo, relata o avanço do uso de RNA nas 

diversas áreas, sua aplicação em controle de processos não lineares, enfocando também 

algumas aplicações de sucesso na indústria. Cita ainda que, o fato de as redes neurais serem 

mais tolerantes a falhas, menos sensíveis à ruído inerente ao sistema, apresentando 

robustez, e mais facílmente implementado do que as aproximações por métodos 

convencionais utilizando funções polinomiais, séries trigonométricas, métodos estatísticos 

ou outros, é que faz com que elas sejam mais recomendadas em controle de processos do 

que os outros métodos. 

Um sistema com dinâmica não linear é representado em seu estudo pela equação 

de estado :E: 



L: x(k+I)=f[x(k),u(k)],f(O,O)=O 
y(k)=h[x(k)], h(O)= O 

(2.1) 

19 

onde u(k), y(k) E \Rm e x(k) E \nn representam a entrada, saída e vetor de estado, 

respectivamente, no tempo k e as funções f e h são assumidas serem suaves, isto é, possuem 
derivada contínua em toda a extensão. 

O objetivo é determinar uma condição sob a qual um vetor de entrada u(k) pode 

ser obtido tal que a saída do sistema assuma determinado comportamento. Os expoentes m 

e n determínarn o sistema, ou seja, se m = n = I então o sistema apresenta única entrada e 

única saída (SISO), caso m = I e n &gt; 1 tem-se um sistema de única entrada e múltiplas 

saídas (SIMO), caso m &gt;I e n &gt; I o sistema apresenta múltiplas entradas e múltiplas 

saídas (MIMO). O primeiro passo para este tipo de controle é a identificação do mesmo 

utilizando os sinais disponíveis. Esta identificação consiste em selecionar um modelo 

paramétrica adequado e ajustar seus parâmetros visando otimizar o critério de desempenho 

baseado no erro entre a saída da planta e a saída do modelo. Se a rede neural, representada 

por funções discretas N1 e Nh é então usada para aproximar as funções f e h, o modelo 
assume a forma: 

x(k+l) = N 1 [x(k),u(k)] 

Y(k)=Nh[x(k)] (2.2) 

onde N1 e Nh são treinados por um método da literatura independentemente e seus 

parâmetros são ajustados de forma a minimizar as diferenças (x(k)-x(k)) e 

(y( k)- H k)) , respectivamente. Como o sistema pode se tomar instável durante o 

treinamento on-line, todo treinamento num problema prático é levado usando um simulador 

o.ff-line. Uma área onde o estudo de redes neuraís tem se mostrado bastante atrativo é 

aquela onde o controle é baseado em dados de entrada e saída apenas. Como na maíoria dos 

casos práticos o sistema a ser controlado apresenta múltiplas entradas e saídas, a eficácia da 

rede neural como controlador irá depender da aplicabilidade da metodologia normalmente 



20 

usada em controle multivariável. A dificuldade está justamente na interdependência 

normalmente observada entre as diversas entradas e saídas. Em caso de sistema tipicamente 

multivariável, com característica não linear, cujos parâmetros são desconhecidos, tem-se 

então um problema de controle adaptativo multivariável não linear. E é justamente aí que é 

mostrada a potencialidade das redes neurais. Outra área de interesse em pesquisa é o 

controle adaptativo por múltiplos modelos. Neste caso os controladores são desacoplados. 

O presente estudo está baseado em controle multivariável de um sistema MIMO, com 

m &gt; I e n &gt; 1, usando dados de entrada e saída apenas. Devido ao elevado grau de 

interdependência das variáveis de processo da unidade FCC, o desacoplamento destas 

variáveis assumiria dimensões elevadas, com resultados possivelmente duvidosos. Desta 

forma, optou-se por não desacoplar o modelo do controlador. 

SA VKOVIC'-STEV ANOVIC' (1994) apresentou um estudo com objetivo de 

avaliar a aplicabilidade de redes neurais para análise de dados industriais. Foi apresentada 

uma arquitetura para rede neural constituída de três camadas distintas (Input, Hidden and 

Output- IxHxO), as quais foram classificadas como: as camadas de entrada (1), camada de 

percepção; interna ou escondida (H), camada conceitual; e camada de saída (0), camada de 

ação. A unidade de entrada (I) foi constituída de fatos ou condições de estado, a unidade 

escondida (H) situada entre as unidades de entrada e de saída foi responsável pela 

transformação dos dados de entrada em resultados de saída, e a unidade de saída (O) 

correspondeu aos resultados numéricos que foram comparados com os resultados esperados 

e decidir qual ação a ser tomada. Foram utilizadas funções de ativação do tipo sigmoidal e 

o treinamento da rede foi realizado através do procedimento de retropropagação. Aqui foi 

adotada a configuração totalmente por alimentação direta (do inglês jee4forward) que é a 

configuração mais popular para este tipo de rede; o termo "totalmente" apresenta aqui o 

significado de que os neurônios de uma camada estão conectados apenas aos neurônios da 

camada seguinte, não havendo nenhuma ligação de retorno. 

O treinamento da rede teve como meta atingir o minimo erro, definido como a 

diferença entre a saída obtida do cálculo pela rede e o valor desejado para saída. Nesta 

etapa foram usados o algoritmo Powell, o método (Sum of Square ofresidual- SSQ), e o 

algoritmo da regra delta generalizada (Generalized Delta-Rule- GDR), para calcular os 

pesos da rede os quais minimizassem a função objetivo. No modo de treinamento foi 



21 

fornecido um conjunto de exemplos de treinamento consistindo de um par de vetores de 

entrada/saída. No processo de treinamento, a rede foi inicializada com um pequeno peso 

randômico em cada nó. Com o objetivo de avaliar o treinamento da rede neural no processo 

de classificação e otimização, dois casos foram investigados. O primeiro caso consistiu em 

uma coluna de destilação e separador liquido-liquido de um azeótropo heterogêneo. O 

segundo caso foi o processo de destilação azeotrópica de acetato de butila, álcool butílico e 

água, interconectado com a coluna de destilação industrial. Em ambos os casos estudados 

vários modelos de redes neurais foram explorados para encontrar a arquitetura que 

fornecesse o menor erro durante o treinamento. 

Através desta investigação foi concluído pelo autor que as redes neurais têm um 

potencial a ser desenvolvido dentro da ferramenta de predição, e suas aplicações permitem 

que se façam a estimação dos parâmetros de processo para melborar sua produtividade. O 

resultado do treinamento obtido pelo algoritmo GDR é comparável ao resultado obtido com 

o método Powell mesmo usando diferentes arquiteturas de redes. Seus resultados 

mostraram também a aplicabilidade das estruturas em redes neurais com e sem camada 

escondida, concluindo também que adicionando uma camada escondida aumenta-se o 

desempenho da rede, mas aumenta também o tempo computacional. Foi mostrado ainda o 

efeito positivo da combinação de redes neurais em módulos. A condição ótima de operação 

foi experimentalmente verificada na planta. No presente estudo, serão utilizadas RNA 

apresentando mesmo modelo de arquitetura mostrado acima, composto de três camadas 

com configuração feedforward com a função sigmoidal como função de ativação. 

WANG et al. (1998) apresentaram uma estratégia de controle preditivo onde um 

processo não linear é modelado usando RNA Foi proposto dividir o controle em duas 

partes, uma denominada de modelagem do processo não linear usando redes neurais e outra 

representando a técnica do controle preditivo. Seus estudos se limitaram ao caso de 

otimização onde apenas uma ação de controle é envolvida, obviamente a complexidade do 

problema aumenta quando o número de variáveis cresce. O caso estudado foi o controle de 

pH em um reator CSTR, onde existiam duas correntes de entrada: hidróxido de sódio e 

ácido acético. O fluxo de ácido foi fixado como constante- F1, variando apenas a corrente 

de soda - F2 (como variável manipulada), o pH era a variável controlada. Aqu~ a 

dificuldade observada era devido a grande variação na dinâmica do processo. Para este 



22 

sistema quatro entradas foram consideradas apropriadas, dois valores de pH (pH(t) e pH(t-

1)) e dois valores de vazão de soda (F2(t) e F2(t-l)). Na saída, apenas um neurônio 

(pH(t+J)), e na camada escondida foram escolhidos 10 neurônios. Foi observado que 

quando o número de nós na camada escondida é relativamente pequeno, o processo produz 

oscilações indes~áveis na região de viragem do pH mesmo que a performance tenba sido 

boa na fase de treinamento. Visando contornar este problema uma tentativa seria aumentar 

o número de nós na camada de entrada, acrescentando pH(t-2) e h(t-2) mas isto poderia 

levar a resultados errôneos pois aí o número de nós existentes na camada escondida já não 

seria capaz de treinar a rede adequadamente. Foi concluído que a escolha do número de nós 

de entrada deve ser baseada na análise do processo específico, e que um aumento excessivo 

não necessariamente aumenta o desempenho do sistema, podendo causar um problema de 

convergência e um aumento desnecessário da complexidade e da sobrecarga 

computacional. No presente estudo uma análise semelhante será adotada na escolha do 

número de elementos na camada de entrada, tomando-se o cuidado para não haver perda de 

generalidade do modelo em redes neuraís e também não causar sobrecarga computacional, 

urna vez que a estratégia de controle proposta prevê atuação em maís de uma variável ao 

mesmo tempo. 

ZHAN &amp;amp; ISHIDA (1997) apresentaram um modelo multipasso para o controle 

preditivo com modelo em um sistema com uma única entrada e única saída (SISO) não 

linear. A proposta apresentada foi utilizar controle preditivo utilizando redes neuraís para 

simulação do modelo (Neural Model Predictive Contrai - NMPC). O objetivo básico foi 

selecionar um conjunto de ações de controle futuros que minimizassem uma função 

objetivo baseado na técnica de modelagem preditiva, sujeito a restrições de processo. A 

função a ser minimizada foi assim representada, 

. 
mm 

u(k ), ... ,u(k+M-1) 

N 2 

:L[vp,.a(k+ J)- ysp(k+ J)] 
i=l (2.3) 

sujeito ás seguintes restrições: 



Ymm 5oyprod (k+ j)5oy,_ (J=1, ... ,N) 

umin 5ou(k+i}5,u,_ (i=O,l, ... ,M-1) 

iu(k +i)-u(k +i -1~ 5o ~u"""' (i= O, 1, ... ,M -1), 

onde NeM são os horizontes de predição e controle respectivamente. 

23 

Como o horizonte de predição é maior do que o de controle, as ações de controle 

foram consideradas constantes nos intervalos de amostragem acima do horizonte de 

controle. Foi aplicado o método backpropagation para treinamento da rede, e a técnica 

steepest descent para aceleração do método. A soma dos erros entre as saidas preditas e os 

valores de referência no horizonte de predição, foi definida como, 

(2.4) 

A variável manipulada no período de amostragem k +i, reconhecida como u(k+i) 

foi ajustada, iterativamente, pelo método steepest descent, ou seja, 

u(k +i)"""' =u(k +i)-q (E ·) (i= O, 1, ... ,M -1)até E 5o e, 
àu k+z 

(2.5) 

onde 17 é o tamanho do passo e e representa o critério de convergência. As restrições nas 

variáveis manipuladas receberam o seguinte tratamento: se a restrição for ultrapassada, 

então a variável manipulada assume o valor do limite; entretanto este limite pode ser 

ultrapassado, devido a variações de outras variáveis manipuladas, em função da 

interdependência destas variáveis. 

Este processo foi aplicado em um sistema não linear, representado por um reator 

CSTR, numa reação exotérmica e irreversível, com uma cinética de primeira ordem. A rede 

utilizada para modelo foi composta de 2 nós de entrada (y(k) e u(k)), 4 nós na camada 



24 

escondida e 1 nó na camada de saída (y(k+ 1)), onde k representa o instante de amostragem 

presente e k+ 1 representa o instante futuro. O método backpropagation incluiu o termo de 

momento no treinamento (momentum). Foram gerados 400 padrões para o treinamento, 

sendo necessário 1000 iterações para início de controle. Dos resultados obtidos da 

simulação, ele concluiu que o desvio encontrado entre o modelo e o sistema real foi devido 

a ausência de informações na região não estável, mas que o perfil do modelo acompanhou o 

perfil real. Para avaliar a influência do horizonte de predição na ação do controle, ele 

utilizou inicialmente N = 5, depois N = 1 O e N = 15, para horizonte de controleM = I. Ele 

concluiu que a medida que aumenta o horizonte de predição, o controle fica maís estável, 

entretanto é necessário maíor esforço computacional. Fazendo também uma análise 

utilizando M = 5 com N = 5, chegou a resultado oscilatórios, concluindo que para controle 

de sistemas não estáveis é muito importante utilizar uma estratégia de estabilidade. 

Analisando o efeito de ruído no controlador, concluiu que o controlador foi capaz de 

estabilizar o sistema mesmo na presença de ruídos e distúrbios externos, apresentando 

porém um desempenho pior do que o mesmo sistema sem estas interferências. Em seu 

estudo, concluiu que a principal vantagem do método apresentado foi a utilização da 

mesma estrutura de rede neural tanto na modelagem da planta quanto na determinação da 

variável manipulada. No presente estudo é previsto utilizar RNA com o método de 

treinamento via backpropagation para identificação de um sistema não linear com 

restrições e com características MIMO, avaliando também a influência da presença de ruído 

no modelo. É previsto também avaliar a influência do horizonte de predição no 

desempenho do controlador, utilizando um critério baseado na técnica de tentativa e erro. 

ENDER &amp;amp; MACIEL FILHO (2000) utilizaram redes neuraís em estratégias de 

controle preditivo aplicadas a unidades de craqueamento catalitico em leito fixo, sendo 

observado o bom desempenho do controlador. Destaca-se aqui que o treinamento é feito 

inicialmente off-line, mas após inicio da atuação do controlador, o treinamento passa a ser 

feito on-line, na tentativa de capturar alterações no comportamento dinâmico do processo. 

DE SOUSA JR (1993) empregou urna RNA para classificação de processo onde a 

rede foi usada para predizer as propriedades de um catalisador em função das condições do 

processo de fabricação. O autor também usa a rede para a identificação de reatores não 

lineares com controle preditivo. Em seu estudo foi usado o método backpropagation com a 



25 

técnica steepest descent como rotina de treinamento. Foi usado um programa desenvolvido 

em fontes de códigos computacionais em linguagem Fortran, baseado em um estudo de 

CASTIER (1990), que calcula o gradiente conjugado de FLETCHER e REEVES (1964, 

apud DE SOUZA JR., 1993). Ele acrescentou algumas rotinas a este programa, adaptando-

o às suas condições. Este mesmo programa desenvolvido por CASTIER (1990), foi 

também utilizado por outros autores, a saber: FONSECA (1998), em sua dissertação de 

mestrado, num estudo onde as RNA foram usadas na identificação de um processo de 

fermentação alcoólica continua, e SANTOS (2000b ), que apresentou como tema de 

mestrado um estudo envolvendo a identificação da unidade FCC. 

2.3 Proposta da Tese 

No presente estudo, é previsto utilizar o mesmo programa desenvolvido por 

CASTIER (1990) e DE SOUZA JR. (1993) para identificação do modelo em RNA, sendo 

necessários alguns ajustes para adaptá-lo ao problema proposto. O método do gradiente 

conjugado foi o método escollúdo para o treinamento das redes neurais, devido ao bom 

desempenho deste método nos testes preliminares efetuados e devido à prévia decisão de se 

efetuar um treinamento ojj-line, e, portanto, o tempo de treinamento não constituiria um 

fator limitante para o processo de identificação. Vale ressaltar que se o tempo de 

treinamento da rede fosse prejudicial ao processo na identificação da rede ou se fosse 

previsto um treinamento on-line, outro método poderia ser utilizado para treinamento (os 

métodos do gradiente conjugado, gradiente descendente com busca em linba, gradiente 

conjugado com passo fixo, quasi-Newton DFP- David.on-Fletcher-Pawe/1 e quasi-Newton 

BFGS - Broyden-Fletcher-Goidfarb-Shanno estão disponiveis no programa). A decisão de 

usar um programa pronto para o processo de identificação em redes neurais foi útil pois 

economizou tempo que seria despendido na etapa de desenvolvimento de um software para 

criação da rede, que, no caso em questão, representa apenas uma ferramenta de cálculo e 

não constitui o principal propósito deste estudo. Tal prática de usar um programa pronto é 

comum em trabalhos de aplicação (GROSDIDIER et ai., 1993; ALI &amp;amp; ZAFIRIOU, 1993; 

ISHIKAWA et ai., 1997; RUIZ &amp;amp; SONNET, 2000; JAMIESON, 2001; GREAVES et ai., 

2001; PEDROSA et a!., 2001), onde pacotes comerciais diversos disponiveis em grande 

número são freqüentemente utilizados (CHEN, 1990; BORGES &amp;amp; CASTIER, 1993, apud 

DE SOUZAJR., 1993). 



26 

O modelo fenomenológico, validado com os dados da unidade industrial por 

MORO (1992), foi desenvolvido a partir dos estudos de KURIHARA (1967). Este modelo, 

tendo em vista a boa concordância de seus resultados com os dados da unidade industrial, 

serviu de base para os trabalhos de MORO &amp;amp; ODLOAK (1995), AGUJLARA et a!. (1999), 

SANTOS (2000), ANSARI &amp;amp; TADÉ (2000), ZANIN et a!. (2000a,b), entre outros, sendo 

portanto considerado adequado para o processo de identificação da FCC em Redes Neurais 

Artificiais. O modelo supra citado, devido ainda à disponibilidade do programa fonte e às 

facilidades de manuseio, será também usado como simulador da FCC para testar o 

controlador preditivo multivariável proposto. 

Como estratégia desta tese é proposto inicialmente realizar a identificação do 

processo de FCC em redes neurais a partir do modelo fenomenológico disponibilizado por 

MORO (1992). O treinamento da rede será baseado num procedimento Backpropagation 

utilizando o método do Gradiente Conjugado. Diversas arquiteturas de rede serão obtidas e 

suas respostas comparadas com as respostas do modelo fenomenológico, sendo escolhidas 

aquelas que apresentarem melhor desempenho e menor tempo de CPU na etapa de 

treinamento. Posteriormente é proposto desenvolver um controlador preditivo multivariável 

(MPC), adotando como modelo a Rede Neural escolhida do processo de identificação. O 

método de minimização utilizado será obtido da rotina NCONF, disponível na biblioteca 

IMSL pertencente ao Fortran. Para avaliar o desempenho do controlador proposto, são 

previstos alguns testes efetuando perturbações no modelo fenomenológico de forma a 

avaliar as respostas do controlador, comparando-a com os resultados dessas mesmas 

perturbações com o sistema aberto e com as respostas obtidas do controlador DMC obtido 

por Moro. 



27 

CAPÍTULOill 

MODELAGEM MATEMÁTICA DO PROCESSO 

É apresentada aqui uma breve descrição do processo da unidade FCC, enfatizando 

as variáveis utilizadas no sistema de controle convencional existente e que serão também 

utilizadas no controle preditivo em redes neurais. Posteriormente são apresentados a 

metodologia empregada das redes neurais e o processo de identificação, e finalmente o 

procedimento do controle preditivo. 

3.1 Modelos que representam a unidade de FCC 

Diversos estudos obtidos na literatura mostram modelos matemáticos onde se 

procura obter uma forma de representar a unidade de FCC. Entre esses modelos, que são 

utilizados como modelo em controladores preditivos, destacam-se os desenvolvidos por: 

MCFARLANE &amp;amp; REINEMAN (1990), GROSDIDIER et a/. (1993), ALI &amp;amp; ELNASHAIE 

(1997), que utilizaram a FCC, Modelo IV da EXXON; LEE &amp;amp; KUGELMAN (1973) e HAN 

&amp;amp; CffiJNG, (2001a,b) que utilizaram um modelo side by side; e MORO &amp;amp; ODLOAK 

(1995), onde utilizaram o modelo Orthojlaw F. da M. W. Kellogg, o qual representa um 

modelo de 10 Lumps descrito inicialmente por Kurihara; dentre outros. Todos eles 

justificaram seu uso em função dessa unidade apresentar elevado valor agregado em seus 

produtos, com grande possibilidade de retomo de investimento, independente do modelo 

considerado. 

HAN &amp;amp; CffiJNG, (2001a,b) propuseram o desenvolvimento de um modelo 

dinâmico para a FCC, num primeiro estudo, e testes comparativos, em outro estudo, 

visando simular o regenerador e o reator. O reator foi considerado como modelo de 4 

Lumps e o regenerador composto de duas fases, identificado como modelo side by side. O 

modelo foi criado de forma modular, onde cada módulo representou uma parte da unidade, 

descrita por equações diferenciais. F oi constatada a presença de mais de um estado 

estacionário para as condições normais de operação para este modelo de FCC, a depender 

do estado inicial na simulação. Citaram também que seu comportamento dinâmico é muito 

sensível á condição de ativação inicial do catalisador. Este modelo foi validado com valores 



28 

de estado estacionário obtidos da literatura, representando bem o processo fisico e 

confirmando a elevada interação existente entre o regenerador e o reator. 

3.2 Processo de Craqueamento Catalítico em Leito Fluido 

Qualquer que seja o modelo considerado, a unidade de FCC apresenta como 

objetivo o de reduzir o tamanho das cadeias hidrocarbônicas das frações mais pesadas do 

Petróleo por meio de reações cataliticas. 

O craqueamento catalítico utilizado em refinarias de petróleo é considerado o 

maior processo catalítico do mundo em função do volume processado e dimensões dos 

equipamentos utilizados. Este processo é útil, pois transforma produtos derivados de 

Petróleo de alto peso molecular e que apresentam baixo valor comercial agregado em 

produtos de maior valor comercial. Estas unidades apresentam normalmente um lucro 

liquido de US$30/ton processada, o que equivale a um lucro líquido de US$240.000/día se 

considerarmos um processamento normal de 8.000 ton/día (MORO, 1992). 

Essa unidade recebe como carga as correntes provenientes principalmente das 

seguintes unidades de uma refinaria de petróleo: Destilação à Vácuo, as correntes de 

Gasóleo e Resíduo de Vácuo, e Unidade de Desasfaltação com Propano, como Óleo 

Desasfaltado. O petróleo e suas frações são constituídos por misturas bastante complexas 

de hidrocarbonetos, contendo inclusive heteroátomos com oxigênio, enxofre e nitrogênio 

(VENUTO &amp;amp; HABID, 1978). Esta composição variada influencia diretamente na 

desativação do catalisador e na composição da gasolina produzida (P ACHOVSKY &amp;amp; 

WOJCIECHOWSKI, 1975). A complexidade da carga de uma unidade de FCC toma 

impossível a modelagem cinética de cada uma das reações envolvidas, tomando necessário 

o agrupamento dos componentes em lumps (WEEKMAN, 1979). O modelo de dez lumps 

constitui hoje o mais completo modelo de craqueamento catalitico (JACOB et al, 1976). 

Como produtos gerados, tem-se: Gás Combustível - hidrogênio, metano, etano e eteno; Gás 

Liquefeito de Petróleo (GLP) - propano, propeno, butanos e butenos; Nafta Craqueada -

hidrocarbonetos de 5 ou mais átomos de carbono e que se destilam à temperatura de até 

220°C; Óleo Leve de Reciclo (Light Cycle Oi/ - LCO) com destilação até 360°C; Óleo 

Decantado também denominado Óleo Combustível de FCC ou Óleo Combustível 

Craqueado, composto de hidrocarbonetos mais pesados que o Óleo Leve; e Coque - sólido 

de alto peso molecular e alto teor de carbono, geralmente com relação C:H de 1:1, sendo 



29 

queimado na própria unidade. Desses produtos, o que apresenta maior valor agregado é a 

Nafta Craqueada, utilizada como gasolina automotiva, sendo portanto esta a principal meta 

de uma unidade de craqueamento. Alternativamente, a unidade pode também ser 

direcionada para a produção de GLP. 

O processo ocorre em temperaturas elevadas, na faixa de 500 a 550°C, em 

presença de um catalisador seletivo, à base de Zeólitas. O catalisador se apresenta na forma 

de um pó branco de diâmetro médio de 60).lm, com elevada porosidade e área específica, e, 

por apresentar dimensões tão pequenas, escoa como se fosse um fluido, o que facilita seu 

manuseio, porém, com o inconveniente de provocar abrasão nos equipamentos e redução 

em seu diâmetro devido ao atrito. 

Devido às condições de temperatura do reator, ocorrem também reações 

secundàrias indesejáveis devido ao craqueamento térmico, como a formação de coque, 

polimerização e desidrogenação, com conseqüente deposição do coque sobre a superficie 

do catalisador, reduzindo sua atividade. Desta forma, toma-se necessària a regeneração do 

catalisador, o que é feito por meio de queima do coque depositado. Para isto, o catalisador é 

transportado da seção de reação para a seção de regeneração e dai volta para a seção de 

reação, por meio de transporte fluido. 

A seguir (Figura 3.1) é apresentado um desenho esquemático mostrando a 

circulação do catalisador de uma planta industrial. 

GAS COIIIBUSTivB. CATAUSAOOR PRODUTOS 

GASTO 

REGENERADOR REATOR 

AR CATAUSAOOR ALIIIIENTAÇÀO 

REGENERADO 

Figura 3.1 Circulação de Catalisador em uma Unidade de Craqueamento 
Catalítico. 

Na seção de reação prevalecem as reações de quebra de cadeia que são 

endotérrnicas, resultando em um consumo de energia. É nesta seção que ocorre também a 



30 

formação de coque que é depositado no catalisador reduzindo sua atividade. Na seção de 

regeneração o coque depositado no catalisador é queimado gerando energia e provocando 

sua reativação. A energia liberada nesta reação será utilizada para suprir a energia gasta na 

outra seção; daí, pode ser observada a importância de se realizar um balanço de energia 

entre estas seções para que sejam mantidas as condições de operação dentro dos limites de 

restrição do sistema, e de forma a garantir uma economia de energia. Outro balanço 

necessário neste processo é o balanço de carbono que faz com que a quantidade de coque 

gerada na seção de reação seja igual à quantidade queimada na outra seção. Além disso, é 

necessário ainda manter uma vazão de catalisador circulando entre as duas seções; para isto 

torna-se indispensável manter um perfil de pressões adequado, denominado de balanço de 

pressão. As equações de balanço de energia e massa da unidade de FCC, obtidas do modelo 

de KURffiARA (1967), e usadas para validar o modelo com a unidade industrial (MORO, 

1992), estão mostradas no ANEXO D. 

3.2.1 Descrição de operação da unidade 

A seguir é feita uma descrição da operação da unidade de craqueamento catalitico. 

Para acompanhá-la é utilizado um esquema representando o conversor FCC da Kellogg 

Orthoflow F. da Refinaria Henrique Lages (Figura 3.2). Apesar de representar esta unidade 

específica, os princípios aqui descritos são similares a qualquer outro modelo (MORO, 

1992). 

A carga após ser aquecida até uma temperatura adequada, na faixa de 200 a 300°C, 

é injetada na base do reator tubular, conhecido como Riser, utilizando-se também vapor 

d'água para facilitar a dispersão dos hidrocarbonetos em gotículas. Devido ao contato com 

o catalisador quente (cerca de 700°C) proveniente do regenerador, a carga é rapidamente 

vaporizada dando inicio às reações de craqueamento. A vaporização faz com que a mistura 

carga e catalisador siga a direção ascendente ao longo do Riser, com velocidade média de 

20 mls, o que fornece um tempo de residência em tomo de 2 segundos nesta etapa do 

reator. À salda do Riser, com temperatura em tomo de 540°C, a mistura penetra no vaso 

separador, também chamado de reator, onde sofre desaceleração até aproximadamente 

0,5 m/s, provocando a separação de hidrocarbonetos e catalisador. Os hidrocarbonetos 

passam através de um conjunto de ciclones de duplo estágio, visando reter as particulas 



31 

mais finas de catalisador que tenham sido arrastadas e são enviados para a seção da unidade 

onde será feita a separação entre as várias frações por meio de destilação. 

Produtos-~---. 

Vaso 
Separador 

Retificador 

Leito do 1° 
Estágio 

---ô Ar-----' 

l..eito do 

Ar _____ ___. 

TCV 

Ri ser 

A 

Vapor de 
Dispcr.são 

Carga 

Figura 3.2 Desenho esquemático da Unidade de Craqueamento 
Catalítico da Kellogg Orthoflow F. pertenceote à Refinaria 
Henrique Lage, situada em S. José dos Campos - SP. 

O catalisador forma um leito no fundo do vaso separador, iniciando um fluxo 

descendente. O catalisador nesta fase está impregnado de coque e de hidrocarbonetos mais 

pesados que podem ainda ser recuperados, o que é feito no retificador ou stripper, através 

de injeção de vapor d'água. A seguir o catalisador passa por um tubo vertical conhecido 

como stand-pipe, o qual possui em sua base uma válvula, denominada de válvula de 

catalisador gasto, que manipula a vazão que chega ao primeiro estágio do regenerador. 

Neste ponto a injeção de ar dá inicio à combustão do coque, reduzindo o seu teor da faixa 

de 1,0% em massa para cerca de 0,25% em massa, com elevação da temperatura até 

aproximadamente 680°C. O catalisador flui para o segundo estágio de regeneração, onde é 

injetado mais ar e o teor de carbono cai para 0,1% em massa, atingindo temperaturas em 

tomo de 700°C. 



32 

Os gases de combustão, contendo quantidade apreciável de monóxido de carbono 

(em tomo de 10% vol.), passam através de um conjunto de ciclones e são enviados, após 

redução da pressão, para uma caldeira onde o CO é queimado para gerar vapor d'água de 

alta pressão. A presença de CO nos gases de combustão faz com que ocorra a sua oxidação 

na fase diluída do regenerador, provocando elevação de temperatura nesta região. 

O catalisador, já regenerado é enviado para a base do Riser, com vazão controlada 

por uma válvula (válvuía de catalisador regenerado), onde o ciclo se repete. 

3.2.2 Estratégia de controle do FCC 

Inicialmente, é apresentada uma descrição do controle convencional da unidade 

FCC, para auxiliar na descrição do processo. Para isto, a Figura 3 .3 a seguír será útil para 

entendimento deste controle. 

Figura 3.3 Esquema do controle convencional da unidade de Craqueamento 
Catalítico. 

A carga, normalmente proveniente do sistema de tancagem da unidade, apresenta 

um controle de vazão independente. Ela é aquecida em permutadores de calor e 

posteriormente em um forno de aquecimento de carga. A temperatura da carga na saída do 

fomo é controlada por meio de um controle de vazão de combustível para o forno. A 



33 

temperatura de saída do Riser é controlada pela válvula de admissão de catalisador 

regenerado. O nível de catalisador no vaso separador é controlado pela válvula de 

catalisador gasto. As temperaturas dos leitos, fases densas e diluídas são controladas pela 

vazão de ar para regeneração. O diferencial de pressão dos subsistemas reação e 

regeneração, indiretamente a pressão do regenerador, é controlado pela válvula de gases de 

combustão. 

Visando manter a unídade operando em condições de estabilidade e continuidade 

desejadas, é necessário o controle de alguns parâmetros do processo. A seguir são 

apresentados os controles maís relevantes de uma unidade de FCC, juntamente com sua 

justificativa de controle (MORO, 1992; GROSDIDIER et al., 1993): 

• Concentração de 02 no gás de combustão - Excesso de Oz no gás de combustão 

representa um desperdício econômico, uma vez que é gasta energia para soprar ar para 

dentro do vaso regenerador. Por outro lado, insuficiente quantidade de Oz pode levar o 

regenerador à queima parcial, produzindo maís CO junto com COz. Apesar do 

regenerador operar freqüentemente com queima parcial, a operação em região 

intermediária entre os dois modos de queima representa uma região instável. Esta 

instabilidade deve ser evitada mantendo um teor mínimo de Oz no gás de combustão. 

Na impossibilidade de se ter um analisador de linha acoplado ao sistema para este 

controle, o mesmo pode ser feito indiretamente por meio do controle de temperatura da 

fase diluída, o qual por sua vez, é feito controlando as temperaturas dos leitos densos 

nos 12 e 22 estágios de regeneração. 

• Capacidade do soprador de ar - A capacidade de queima do coque depositado no 

regenerador, e portanto, a capacidade de alimentação da unidade, pode ser limitada pela 

capacidade do soprador de ar. O controle da capacidade deste soprador é efetuado pela 

regulagem do ângulo das lâminas do soprador, o qual não pode exceder determinado 

limite inferior e superior. Esta capacidade é também indiretamente limitada pela 

velocidade superficial máxima permitida no regenerador. Esta velocidade superficial 

deve ser mantida abaixo de um limite para prevenir entrada excessiva de ar através do 

leito fluídizado. Tal situação pode criar condições de queima acima da seção do 

regenerador ou então dentro dos ciclones, fenômeno denomínado de queima posterior 

ou afterbum. Isto ocorre quando uma boa parte da combustão ocorre na região do 



34 

regenerador acima do leito, e isto pode acontecer quando o tempo de residência do Oz é 

baixo devido à elevada velocidade superficial. A oxidação do CO neste caso é 

completada fora do leito fluidizado; 

• Temperatura do leito do regenerador - A temperatura dentro do leito do regenerador 

varia ao longo do eixo vertical do vaso, sendo tipicamente mais baixa no fundo do leito 

e alta na câmara e na linha de saída de gás combustível. Apesar da câmara apresentar 

picos momentâneos de temperatura alta devido a ocorrência de queima acima do leito, 

denominada de qfterburn, em geral esta temperatura apresenta um perfil bem 

comportado; isto significa que é suficiente controlar apenas uma temperatura, no caso, 

o controle da temperatura do leito denso é suficiente para estabilizar todo o perfil. Esta 

temperatura, entretanto, não necessariamente deve ser fixada por um valor de 

referência, mas sim deve ser mantida dentro de limites de controle. Ela não deve ser 

muito alta para que a temperatura da câmara não atinja os limites de resistência 

mecânica dos ciclones e da linha de gás combustível. Além disso, a circulação de 

catalisador diminui com o acréscimo da temperatura do leito, uma vez que menos 

catalisador será necessário para manter a temperatura do Riser dentro do objetivo de 

controle. Desta forma, uma temperatura muito alta no leito decresce a razão 

catalisador/ óleo, o que causa efeitos indesejáveis nos produtos de saída, como por 

exemplo, reduz a conversão (ou severidade) da reação. Por outro lado, a baixa 

temperatura do leito denso é também não desejável pois pode forçar a abertura total da 

válvula de catalisador regenerado, válvula esta que permite a circulação do catalisador 

do regenerador para o leito do reator limitando assim a capacidade de processamento da 

unidade; 

• Temperatura do Riser - Duas restrições de operação limitam a capacidade do 

controlador de temperatura de saída do Riser em manipular a válvula de catalisador 

regenerado: 

- A saída do controlador é primeiramente restringida pela necessidade de manter 

esta válvula dentro da faixa de controlabilidade. Além de uma certa posição 

máxima de abertura, qualquer deslocamento excedente não produz nenhum efeito 

significativo na temperatura de saída do Riser. A válvula é então dita estar 

saturada. 



35 

- A saída do controlador é também restringida pela necessidade de manter um 

diferencial mínimo de pressão através da válvula. Este LlP é obrigatório para 

prevenir um fluxo reverso acidental, evitando assim a entrada de óleo de 

alimentação no leito regenerador ao invés de entrar no Ri ser, o que teria efeito 

catastrófico, dado à presença de oxigênio associado à elevada temperatura deste 

leito; 

• Pressão de sucção do Compressor de Gás Úmido- A capacidade de processamento da 

unidade pode ser limitada pela habilidade do compressor de gàs úmido em processar a 

principal fração vaporizada. Sua capacidade é limitada pela necessidade de manter o 

controle de pressão (posição de abertura da válvula de vapor) dentro de seu limite de 

controlabilidade. illtrapassada uma certa posição máxima de abertura, a válvula de 

vapor falha em controlar o fluxo de vapor para a turbina que aciona o compressor de 

gás úmido. Esta situação previne o compressor de ter condição suficiente de controle 

para manter a pressão de sucção nos valores desejados; 

• Gás combustível produzido - Esta restrição final surge na unidade de recuperação de 

vapor. Excessiva carga processada ou elevada temperatura produz mais óleo 

combustível do que pode ser recuperado no absorvedor da unidade de recuperação de 

vapor. 

É importante que se entenda que nem todas as restrições são encontradas 

simultaneamente durante a operação da unidade. Uma carga mais pesada, por exemplo, 

pode gerar uma quantidade maior de coque e relativamente pouco gás de craqueamento. 

Isto sobrecarrega o soprador de ar e faz aumentar a temperatura do leito, mas deíxa a 

temperatura de saida do Riser e a pressão de sucção do compressor bem dentro de suas 

faixas de controlabilidade. Reciprocamente, uma carga leve tende a forçar estas duas saidas 

de controle até seus limites enquanto alivia a operação do soprador. 

3.3 As Redes Neurais Artificiais 

A Inteligência Artificial (IA) é um campo da ciência da computação concebida 

para o projeto de sistemas de computadores inteligentes, isto é, sistemas com características 

que associamos à inteligência no comportamento humano. Em termos práticos, IA trata do 

processamento por métodos não algorítmicos, simbólicos de resolver problemas 



36 

(BAUGHMAN &amp;amp; LIU, 1995). O processamento simbólico é a base para algumas 

aplicações da IA (PRETT &amp;amp; GARCIA, 1988); nela, o conhecimento é extraído e 

representado simbolicamente por regras. As redes neurais são subgrupos de programas e 

rotinas computacionais que fazem parte da IA. Este subgrupo, por ser parte integrante do 

tema dessa tese, será descrito a seguir. Alguns autores associam as Redes Neurais 

Artificiais com as células neuronais existentes nos seres vivos de origem animal, inclusive 

alguns termos e conceitos utilizados para caracterizar as RNA são tomados emprestados 

dessas células. É recomendado ao leitor que tiver interesse em conhecer algumas dessas 

comparações realizadas, que procurem uma literatura adequada como NELSON &amp;amp; 

ILLINGWORTH (1991). Dando continuidade ao estudo, a seguir são apresentadas as RNA, 

iniciando com um resumo desta técnica e uma síntese da rede proposta, descrevendo o 

método de treinamento utilizado. Posteriormente é feita uma descrição do método de 

Controle Preditivo com Modelo, enfocando o Modelo de Redes Neurais Artificiais. 

3.3.1 Arquitetura das redes multicamadas 

Na tentativa de reproduzir os mecanismos de entendimento de como são 

assimiladas as informações no próprio cérebro, foram desenvolvidos os processos 

subsimbólicos, que são modelos matemáticos aplicados a um sistema devidamente 

arrumado. São as chamadas Redes Neurais ou Neuronais Artificiais. Definindo 

genericamente o que seja rede neural, utilizando uma analogia com o cérebro humano, 

podemos dizer que é " ... urna distribuição densa de elementos processadores (também 

chamados de nós, neurônios, memórias de curto alcance, etc.) dispostos em camadas e 

interconectados através de canais unidirecionais - as conexões ... ", essas conexões são 

também chamadas de Sinapses (DE SOUZA JR, 1993; HAYKIN, 1994). 

Estas conexões apresentam urna certa liberdade de arquitetura ou topologia, que é 

a forma como os neurônios artificiais estão conectados. De maneira geral, existem três 

opções de conexões de neurônios, que são: intracamadas, intercamadas e recursivas 

(BAUGHMAN &amp;amp; LIU, 1995), conforme mostrados nas representações da Figura 3.4 a 

seguir. 



2 3 

INTRACAMf&lt;OA INTERCAMA.OA 

2 3 

ODO 
ÔOO 
OOD 

RECURSIVA 

Figura 3.4 Formas de conexão dos neurônios artificiais. 1, 2 e 3 representam as camadas 
de entrada, intermediária ou escondida e de saida, respectivamente. 

37 

As redes neurais podem ser caracterizadas por 3 partes principais: - a topologia da 

rede; - a característica computacional de seus elementos; e, - a regra de treinamento 

(HERNÁNDEZ &amp;amp; ARKUN, 1992). Referente à topologia (ou arquitetura), podem ser 

identificados pelo menos 4 diferentes classes de arquitetura, as quais estão intimamente 

ligadas à forma de treinamento a que estão submetidas. A topologia a que estamos 

interessados no presente estudo, denominada de "redes multicamadas feedforward' é 

destacada a seguir: 

• Rede multicamadafeedforward. Nesta arquitetura é observada a presença de uma ou 

mais unidades ou camadas escondidas. O termo feec!forward (alimentação para frente 

ou direta) representa um tipo particular de ligação entre as camadas. Os neurônios das 

camadas escondidas ficam entre a camada de entrada e a camada de saida e seu objetivo 

é conseguir extrair da rede resultados estatísticos de alta ordem, que se tornam úteis por 

exemplo quando o número de neurônios de entrada é muito grande (HAYKIN, 1994). 

Nesta topologia também é notado o paralelismo do modelo. Os sinais provenientes da 

camada de entrada, também denominados de fonte, suprem os neurônios da camada 

escondida (primeira camada escondida, se houver mais de uma); daí, os resultados das 

operações realizadas nesta camada (vetores de saída dos nós) são sinais de entrada da 

próxima camada. Desta forma, o conjunto de sinais (respostas) obtidos na saida da rede 

(após passar por todas as camadas), denominado resposta global da rede, será 

comparado com padrões supridos pelos nós fontes da primeira camada. Existem duas 

formas de se conectar os nós de uma camada com a outra nesta configuração 

feec!forward: totalmente conectada e parcialmente conectada; uma rede com arquitetura 

de multicarnadas, por exemplo, pode ser totalmente conectada, caso cada nó de uma 



38 

camada esteja conectado com todos os nós da camada seguinte, ou, caso contrário, a 

rede será parcialmente conectada, conforme representado na Figura 3.5. Uma das 

formas da rede neural jeedjorward parcialmente conectada que apresenta um certo 

interesse é a localmente conectada, ou seja, os nós são conectados apenas aos neurônios 

da vizinhança. O tipo localmente conectado é útil quando se sabe a priori que apenas 

alguns neurônios de entrada (não todos eles) exercem influência em determinada 

resposta de saída, e os demaís exercem pouca ou nenhuma influência nessas respostas, e 

se deseja reduzir o tempo computacional no processo de treinamento. Os demaís tipos 

de topologia normalmente encontrados são: rede de simples camadajeedjorward, redes 

recorrentes e redes em estruturas lattice. 

Camada 
de 

entrada 

Camada 

escondida 

a) Rede pardaimentetxln-

Camada 
de 

saída 

Camada 
de 

Entrada 

Camada 

Escondida 

Camada 
de 

Saída 

(b) Rede totalmente conectada 

Figura 3.5 Redes multicamadas feedforward exemplificado para o caso de 3 camadas 
(a) parcialmente conectada e (b) totalmente conectada. 

Convém esclarecer que para cada arquitetura de rede, há um método de 

treinamento específico, o que envolve uma rotina computacional própria; dessa forma, 

quando não existem restrições quanto ao tempo processamento de computador gasto no 

treinamento, ou quando não se consegue precisar a influência relativa de cada variável de 

entrada nas respostas de saída, urna boa estratégia de programação é utilizar uma rotina 



39 

computacional baseada numa estrutura de rede multicamada totalmente conectada, e deixar 

por conta do próprio treinamento a decisão da influência de cada nó nos resultados. 

A rede proposta neste estudo apresenta a seguinte topologia: rede multicamada 

totalmente conectada, com os sinais passando em uma única direção (da entrada para a 

saida), caracterização feedjorward, com apenas ligações intercamadas, apresentando 3 

camadas denominadas respectivamente de camada de entrada, camada escondida e camada 

de saida (ínput, hídden and output layers). O número de neurônios na camada de entrada 

será definido como sendo igual ao número de variáveis pertinentes do sistema em questão 

(denominadas de variáveis controladas e manipuladas); na camada intermediária, utilizando 

a técnica de tentativa e erro, será buscado qual o número minimo de neurônios que fornece 

menor erro quadrático, e ao mesmo tempo, que apresenta resultados satisfatórios, baseados 

num critério de desempenho preestabelecido; na última camada, o número de neurônios 

será definido como sendo igual ao número de variáveis controladas preditas do sistema em 

questão. Uma vez definida a topologia que a rede irá ter, agora pode ser explicado o 

fimcionamento de um neurônio em uma rede multicamada qualquer. 

Acompanhando a Figura 3.6 a seguir, tem-se um neurônio j qualquer da camada 

k+l. Este neurônio recebe um conjunto de informações Sp;.k{i=J, ... ,n,J, correspondente às 

saldas, ou ativações, dos nk neurônios da camada anterior, que são ponderadas pelo peso 

w11k correspondente à sua conexão. O neurônio soma essas entradas ponderadas e o valor 

resultante é por sua vez somado a um limite interno de ativação, um bias (também 

denominado em determinadas redes de threshold) que é representado por ~.k+ 1• Ao 

resultado dessa soma é aplicada uma função denominada de função de transferência. A este 

sinal resultante, o neurônio j produz uma resposta representada por Sp1;k+I (DE SOUZA JR, 

1993; HAYKIN, 1994). 



40 

j -és imo neurÔnio do 
eomado f K + 1) 

Figura 3. 6 Representação esquemática de um neurônio qualquer pertencente à camada 
k+l. 

Matematicamente, pode-se expressar o comportamento de um neurônio por: 

2pj.k+l =[fwjik.spi.k]+B1.k+, 
r=J 

(3.1) 

Dois tipos de função são normalmente usados para a ativação dos neurônios, o tipo 

global e o local. 

A função de ativação global produz uma saída para um largo intervalo de entradas. 

Como exemplos de função de ativação, tem-se: 

degrau limiar: J(Àpj.k+J )= {: ~ se 
se Âpj.k+l &gt;0 

Àpj.k+l s; o 

(3.2) 

(3.3) 

freqüentemente, no caso de degrau limiar, f(ÂpJ.k+J) é de natureza binária, ou seja, 

,; = 1 (um) se ÀpJ.k+l &gt; O e Ç = O (zero) para os demais casos; 



41 

- função sigmoidal: f(JPi.k+z) = [1 + exp(- ÀPiJ&lt;+Z )['; (3.4) 

- função tangente hiperbólica: f(JPi.k+z )= tanh(Jpj,k+Z). (3.5) 

As funções locais são aquelas que só apresentam uma resposta ativa para valores 

de entrada na vizinhança imediata do seu centro de ativação. Entre as funções desta 

natureza destaca-se a função gaussiana. 

n"• [(s .-p f] - função gaussiana: !Pi = exp "'~ / ; 
•=z 2a1 

(3.6) 

com OJ indicando a largura (desvio padrão) da gaussiana e fJJ• os centros adaptativos da 

mesma, os quais podem ser fixados em P:i (WEIGEND et a!., 1990 apudDE SOUZA JR., 

1993). 

A função de ativação a ser utilizada neste estudo é a função sigmoidal (Equação 

3.4). Esta função é a mais amplamente empregada como função de transferência em redes 

neurais (NELSON &amp;amp; ILLINGWORTH, 1991; DE SOUZA JR, 1993; HAYKIN, 1994). 

Para quaisquer valores apresentados à rede, esta função limita suas respostas entre [0,0 e 

1, O]; desta forma, para tornar as respostas da rede compatíveis com as respostas do 

processo, é necessário normalizar todos os padrões apresentados à rede nesta faixa. A 

Figura 3.7, a seguir, apresenta um exemplo da função de ativação sigmoidal 

(BAUGHMAN &amp;amp; LIU, 1995). Nesta figura pode ser observado o caráter continuo e 

portanto diferenciável da função sigmoidal, e também pode ser observada a limitação das 

respostas rp(v) entre 0,0 e 1,0, para quaisquer valores de v. 



42 

2 

1.8 

1.6 
'I'( v) 

1.4 

1.2 

1 

0.8 

0.6 

0.4 

0.2 

o 
-10 .a -6 -4 -2 o 2 4 s 10 

v 

Figura 3. 7 Exemplos de função de ativação do neurônio tipo 
sigmoidal (BAUGHMAN &amp;amp; LIU, 1995). 

A aprendizagem da rede, ou treinamento, corresponde ao processo onde os pesos e 

bias são modificados (SIMPSON, 1990). Existem dois tipos de aprendizagem: o 

supervisionado e o não supervisionado. Os métodos mais empregados para treinamento de 

uma rede são os chamados supervisionados, onde a rede aprende por experiência, isto é, 

exemplos conhecidos de entrada e saída são apresentados à rede, que ajusta seus pesos de 

modo a se adaptar a estes exemplos. No treinamento não supervisionado, a rede não usa 

nenhuma influência externa para ajustar seus pesos, ao contrário, existe um monitoramento 

interno de desempenho, ou seja, a rede procura por regularidades ou tendências dos sinaís 

de entrada fazendo adaptações dos pesos de acordo com funções da rede, mesmo sem saber 

se está indo na direção certa ou errada (NELSON &amp;amp; ILLINGWORTII, 1991). Desta forma 

a rede pode prever saídas para novas entradas. Por construção, os neurônios de uma mesma 

camada não se interligam diretamente, por conseguinte a rede apresenta um certo 

paralelismo; outra característica apresentada é que os dados são distribuídos, ou seja, 

mesmo que alguns neurônios sejam removidos, o desempenho global da rede poderá ser 

pouco alterado. A rede descrita desta forma, no que diz respeito ao paralelismo, guarda 

certa semelhança, mesmo que vaga, com o comportamento paralelo do mecanismo cerebral. 



43 

A arquitetura da rede, no que diz respeito a ser totalmente ou parcialmente 

conectada ou referente ao número de camadas, é escolhida em função do processo que se 

deseja representar. O desempenho global da rede é função, principalmente, da topologia 

escolhida para camada escondida, sendo influenciada pelo número de camadas escondidas 

existentes e pelo número de nós nestas camadas. Geralmente, o aumento do número de nós 

numa camada escondida não aumenta tanto o tempo de treinamento quanto o aumento do 

número de camadas escondidas. De acordo com a literatura, uma única camada escondida 

geralmente é suficiente para representar qualquer função não linear, bastando para isto 

utilizar um número adequado de nós nesta camada (NIKRA VESH et ai., 1996}. A seguir é 

apresentado o método de treinamento proposto. 

3.3.2 Método de Treinamento Backpropagation 

Antes do treinamento propriamente dito, é necessário definir o tipo de treinamento 

a ser implementado ao sistema. A utilização de RNA para identificação de sistemas se 

apresenta em duas fases distintas: uma fase de aprendizado do sistema, onde são obtidos os 

pesos e bias das conexões das RNA, e outra, que pode ser denominada de fase de uso da 

rede treinada, onde a RNA treinada é usada para representar o sistema que foi identificado. 

A etapa de treinamento, dependendo do próprio sistema que se deseja representar, pode 

consumir um tempo de processamento computacional (CPU time) excessivamente elevado 

tomando essa etapa muito lenta para ser implementada em linha (on-line). Dessa forma, o 

procedimento de aprendizado da rede neural pode ser efetuado fora do processo (off-line). 

Na outra etapa, fase de uso da rede treinada, o tempo é normalmente da ordem de frações 

de segundo, o que permite sua implementação on-líne. Neste estudo é previsto treinamento 

o.ff-line de forma a definir a arquitetura da rede; nesta etapa é determinado também o 

número de neurônios necessários na camada escondida, o número de padrões necessários 

para identificação do modelo e também o tempo e o intervalo de amostragem, a partir de 

um procedimento com base na tentativa e erro. A fase de uso da rede treinada, obviamente 

será realizada on-line. 

Para descrever a etapa de treinamento emprestaremos outra característica do 

comportamento do cérebro: a capacidade de aprender através do uso de exemplos, fazendo 

uma analogia com o computador. O método do aprendizado em redes neurais representa 

uma técnica muito utilizada para armazenagem do conhecimento. Para armazenar este 



44 

"conhecimento" no computador, podemos empregar a técnica do uso de exemplos. Para o 

treinamento (também chamado de aprendizado) é necessário criar uma rede neural; desta 

forma foi criada a rede multicamadas feedforward. A característica típica deste tipo de rede 

é ser formada por uma camada de entrada, uma ou mais camadas escondidas e uma camada 

de saída, confonne já dito; o sínal se propaga através da rede na direção para frente camada 

a camada. Esta rede neural é normalmente referida como sendo Perceptrons multicamadas 

(Multilayer Perceptrons- MLPs). O :MLPs possui 3 características distintas: 

• O modelo de cada neurônio na rede apresenta uma não linearidade na saída final. Esta 

não linearidade é suave, isto é, a função é diferenciável em toda extensão; 

• A rede contém uma (ou mais) camada( s) de neurônios escondidos; 

• A rede apresenta alto grau de conectividade, determinado pelas Sinapses (ligações) dos 

neurônios. 

Este modelo tem sido aplicado com sucesso na solução de diversos problemas 

complexos por meio de treinamento utilizando o algoritmo popularmente conhecido - errar 

backpropagation algorithm ou simplesmente backpropagation, que é baseado na técnica de 

correção do erro por aprendizagem (RUMELHART, et ai., 1986; WHITELEY &amp;amp; DA VIS, 

1992). 

Basicamente, esse processo de treinamento consiste em duas passadas pela rede 

em diferentes direções; uma na direção para frente e outra para trás. Na direção para frente 

o vetor de entrada aplica um sinal padrão de atividade nos nós da rede e seu efeito se 

propaga através da rede camada a camada. Então um conjunto de respostas é produzido na 

última camada (camada de saída da rede). Nesta passagem os pesos são todos fixados. Após 

comparação do sinal de resposta com o valor desejado, cria-se um erro. Este erro é o 

responsável pelo método de correção dos pesos da rede. Na correção, o erro retoma através 

da rede (segunda passagem ou passagem de retomo) onde os pesos são ajustados de acordo 

com uma regra preestabelecida de correção de erro. Esta regra tem como objetivo fazer 

com que a resposta da rede caminhe na direção da resposta desejada, diminuindo desta 

forma o erro a cada passada (DE SOUZA JR., 1993; HAYKIN, 1994). 

No método backpropagation, na fase de aprendizagem, são fornecidas várias 

entradas conhecidas e respectivas saídas e os pesos das conexões são modificados até que 



45 

as saídas calculadas seJam próximas numericamente das saídas desejadas. Em notação 

matemática, isto eqüivale a: 

(3.7) 

onde Ep representa o erro entre o valor desejado de cada padrão e o encontrado pela rede, e 

é fornecido por: 

(3.8) 

O método do gradiente descendente usa a informação do gradiente para calcular a 

direção de busca, ou seja, como o vaJor do gradiente determina a direção crescente da 

função, o negativo do gradiente irá determinar a direção descendente máxima da função. 

Minimizando a função erro (global ou local), obtém-se: 

(3.9) 

No processo de otimização foi empregada a estratégia de steepest descent 

(RUMELHART &amp;amp; MCCLELLAND, 1986 apudDE SOUZA JR., 1993; HAYKIN, 1994). 

Este método é descrito como se segue para a k-ésirna iteração, 

(3.10) 



46 

onde, w é o vetor de variáveis independentes de otimização, ou seja, pesos e bias, e o 

parâmetro de ajuste 17 é a taxa de aprendizagem (tomado como valor fixo, positivo e menor 

do que 1,0). 

As duas fases do treinamento via backpropagation visam atualizar os pesos das 

conexões. O algoritmo proposto é apresentado no ANEXO A. Depois da rede treinada, 

pode-se então proceder à segunda etapa que é a fase de utilização da rede, a qual 

corresponde às equações AI a AS do referido anexo. 

Uma caracteristica inerente ao método backpropagation é que ele, em alguns 

casos, pode se tornar excessivamente lento, quando por exemplo, os passos usados na 

correção dos pesos e bias, são pequenos. Em outros casos, apresentam oscilações nos 

pesos, quando estes mesmos passos são muito grandes e a resposta se aproxima do valor 

desejado. Para evitar as oscilações, soma-se um termo de momento à Equação 3.10; desta 

forma tem-se, 

(3.11) 

Contudo, a equação acima, para e fixo, pode não ser suficiente para resolver 

problemas de oscilação. Em vista disto, vários trabalhos foram desenvolvidos visando 

contornar estas dificuldades de convergência; estes trabalhos podem ser agrupados entre 

duas linhas principais. A primeira delas corresponde a trabalhos onde são sugeridas 

modificações apenas na implementação e não no algoritmo do método convencional; a 

outra linha de trabalhos abrange aqueles onde o problema de treinamento de uma rede 

neural é reestruturado usando estratégias tradicionais de engenharia, como por exemplo, no 

estudo de FILKIN, 1989 (apudDE SOUZA JR., 1993), no qual o treinamento é visto como 

uma evolução contínua de :!f no tempo, sendo expresso por equações diferenciais ordinárias 

que são resolvidas usando uma rotina - DIVPAG - da biblioteca IMSL (IMSL, Inc., 

Houston, Texas apud DE SOUZA JR., 1993). Esta segunda linha de ação é mais utilizada, 

principalmente porque o treinamento é considerado por muitos um problema de otimização 

não linear. 



47 

Algumas propostas têm surgido na literatura de um ajuste menos empírico da taxa 

de aprendizado, destacando o uso do método steepest descent com ajuste dinâmico de 17 

(e= O) através de busca unidimensional (WATROUS, 1987 apudDE SOUZA JR., 1993). 

Os autores LEONARD &amp;amp; KRAMER, 1990 (apud DE SOUZA JR., 1993) propuseram um 

método de gradiente de direções conjugadas, com 17 e e ajustados dinamicamente. A 

direção de buscaS na iteração k+ 1 é gerada recursivamente como segue: 

(3.12) 

(3.13) 

(3.14) 

onde o vetor dos pesos Wk+l foi determinado usando-se uma busca unidimensional 

(interpolação quadrática) para TJ, 

(3.15) 

O método utilizado de busca para 17 elimina as oscilações observadas no método 

do gradiente descendente com passo fixo. 

Outros trabalhos ainda adotam o método de Newton, no qual a direção de busca 

leva em conta informações de segunda ordem sobre a função objetivo. Nesse método, a 

equação 3. 9 pode ser rescrita, 

(3.16) 

de modo que, 



48 

(3.17) 

o que é equivalente à, 

(3.18) 

onde H é a matriz Hessiana (matriz das derivadas segundas parciais da função objetivo em 

relação às variáveis independentes de otimização) (EDGARD &amp;amp; HIMMELBLAU, 1988, 

apud DE SOUZA JR., 1993). Os valores de VE(!!:k) representam o gradiente do erro em 

função das variáveis independentes (pesos e bias) do método steepest descent, e são 

apresentados no ANEXO B. 

O método de steepest descent corresponde a um caso particular do método de 

Newton, onde a Hessiana foi substituída por um escalar (DE SOUZA JR., 1993). 

A rotina computacional usada para identificação do processo em redes neurais foi 

desenvolvida por CASTIER (1990)\ baseada em uma rotina de minimização da função 

multivariável usando algoritmo do gradiente conjugado de FLETCHER e REEVES (1964/ 

e revisada por De SOUZA JR. (1996). Esta rotina foi utilizada por CASTIER (1990), De 

SOUZA JR. (1993), FONSECA (1998) e SANTOS (2000). A utilização de rotina pronta ao 

invés de desenvolver o próprio modelo constitui uma prática comum, conforme já dito, e 

possibilita redistribuir melhor o tempo disponível para outras atividades. 

3.3.3 Identificação em Redes Neurais Artificiais 

No processo de identificação em questão, o objetivo é avaliar o comportamento 

dinâmico de um processo não linear. A identificação pode ser definida como o 

"conhecimento" da relação entre as entradas e saidas do processo. Neste processo, os 

1 Escrito por: Marcelo Castier. Programa de Engenharia Química- COPPE, Universidade Federal do Rio de 
Janeiro. BASED ON A SKEUETON OF TilE ROUTINE TMSSJ OF M.L. MICHELSEN. (Instittntet for 
Kemiteknik- DTII- Denmark). 1990. 
2 Edgar, T. F. and Himmelblau, D. M. Optimization of Chemical Processes, p. 206-208, McGraw-Hill 
Intni.Ed., New York (1988). 



49 

valores deverão ser normalizados antes de serem apresentados à rede, com o objetivo de 

evitar que valores de ordem de grandeza distinta influenciem nos resultados. A expressão 

adotada para normalização resulta num padrão limitado entre 0,10 e 0,90, ao invés de 0,0 e 

1,0. A escolha dessa normalização tem como objetivo possibilitar uma pequena 

extrapolação dos valores e evitar a utilização de valores extremos (DE SOUZA JR., 1993; 

SANTOS, 2000). A expressão de normalização dos padrões adotada foi: 

Vnor = 0,1 O+ (V real- V mi.n J x 0,80 
Vmax-Vmm 

para desnonnalização dos padrões, foi utilizada a expressão inversa: 

Vreal =V min+ (Vnor- 0,10) x (V max-V min) 
0,80 

onde: Vnor é o valor normalizado 

Vmin: valor minimo assumido pela variável; 

Vmax: valor máximo assumido pela variável; 

Vreal: valor da variável nas unidades do processo. 

(3.19) 

(3.20) 

Quatro classes de modelos são sugeridas para identificação em processos não 

lineares, os quais podem ser descritos por equações de diferenças finitas (NARENDRA &amp;amp; 

PARTHASARATY, 1990; LANDAU, 1979 apud JAGANNATHAN &amp;amp; LEWIS, 1996). 

São eles: 

n-J 

Modelo I: y(k+ 1) =:La, y(k-i)+ f[u(k),u(k-1), ... ,u(k-m+1)+d(k)]. (3.21) 
i=O 



50 

m-1 

Modelo II: y(k + 1) = IP, u(k-i)+ f[y(k),y(k-1), ... ,y(k-n +1)+d(k)]. (3.22) 
í=O 

y(k+ 1) = .fly(k),y(k-1), .. . ,y(k-n+1)]+ 

g[u(k),u(k -1), .. . p(k -m+ 1) +d(k)]. (3.23) 
Modeloill: 

Modelo IV: 
y(k+l) = f[y(k),y(k-1), ... ,y(k-n+1); 

u(k),u(k -l), ... ,u(k- m + 1) +d(k)]. (3.24) 

onde f() E R!' e g() E R" são funções não lineares, m e n, estão relacionados a ordem do 

sistema. As variáveis u(k) e y(k) representam respectivamente, a entrada e a saída de um 

processo no tempo de amostragem k, e d(k) E R " representa o vetor distúrbio no instante k. 

O Modelo IV é o mais geral, e também conseqüentemente, o de maior dificuldade de 

implementação. Os Modelos I e II são casos especiais de IV, quando a saída do processo é 

linear nos valores passados de y e u, o que pode não ser aceitável para o caso do modelo 

utilizando a unidade de FCC. No Modelo m, considera-se que os efeitos na saída dos 
valores passados de y e u são separáveis e aditivos. Neste trabalho será suposto que o 

processo da FCC tem a estrutura dada pelo Modelo IV. Portanto, para a identificação via 

RNA, a relação entre as entradas (y(k), ... , y(k-n+ I); u(k), ... u(k-m+ 1)) e a saída da rede 

neural ( Y( k + 1) ), representando um sistema discreto no tempo, será descrita por: 

j;(k + 1) = í[y(k ),y(k -J), ... ,y(k- n + J);u(k),u(k -l), ... ,u(k -m + 1)] (3.25) 

Na etapa de treinamento, os pesos e bias da rede serão ajustados, de modo a 

minimizar o erro, definido como erro de identificação, fornecido pela diferença entre o 

valor predito e o valor desejado para a variável y, ou seja, 

e(k+l) = Y(k+l)- y(k+ 1) (3.26) 

O esforço computacional será tanto menor, quanto menor for a ordem do sistema, 



51 

ou seja, o valor de m = n, conforme pode ser observado na Figura 3.8 onde está 

exemplificado para um sistema SISO (SANTOS, 2000b). Para n = m = 1 e n = m = 2, com 

H representando o número de neurônios na camada escondida a estrutura possui 3xH + 2 

conexões e 5xH+2 conexões, respectivamente. Fazendo esta mesma análise para o caso 

proposto, considerando agora que teremos 4 variáveis controladas e 4 variáveis 

manipuladas, o número de parâmetros a ser estimado seria 13xH+4 conexões, para 

n = m = 1, e 21xH+4 conexões, para n = m = 2. Com isto este último caso possui 1,6xH 

parâmetros a mais a serem estimados, correspondendo a 319 conexões para 15 nós na 

camada intermediária. 

y(k) 

y(k-1) 

u(k) 

u(k-1) 

Figura 3.8 Estrutura das RNA para n = m = 1 à esquerda e para n = m = 2 à díreita para um sistema 
SISO (SANTOS, 2000b). 

O comportamento dinâmico do modelo não linear pode ser capturado por redes 

recorrentes, onde os neurônios são interligados para frente e para trás arbitrariamente 

envolvendo um sistema de equações diferenciais ordinárias não lineares e exigindo alto 

custo computacional (tempo); ou então este comportamento pode ser capturado 

alimentando os valores passados de saída do processo, juntamente com os valores presentes 

na forma de um modelo NARX (Non-linear Auto-Regressive eXogenous) (BHAT &amp;amp; 

McAVOY, 1992). No sistema proposto o comportamento dinâmico do processo será obtido 

apresentando os padrões na forma de variações no tempo, sendo considerado de ordem 

igual a 1; então diz-se que o comportamento dinâmico será capturado por uma rede neural 

não dinâmica. Desta forma, apenas os valores presentes serão apresentados à rede, não 

sendo fornecidos os valores dos instantes anteriores. Os dois métodos passíveis de serem 

usados para a identificação de um processo são denominados normalmente de método 



52 

série-paralelo (MPS) e método paralelo (MP). No método backpropagation de treinamento 

os sinais para trás (redes recorrentes) não estão presentes. De modo que permite apenas o 

treinamento no esquema série-paralelo (SANTOS, 2000). O método MPS será adotado 

neste estudo (NARENDRA &amp;amp; PARTHASARATY, 1990 apud JAGANNATHAN &amp;amp; 

LEWIS, 1996; LIMA &amp;amp; OLIVEIRA, 1997). A Figura 3.9 ilustra estes dois métodos. 

l PROCESSO: y(k) 
)msp 

y(k) 

® Y(K-1) mp R 
Y(K-n+2) E 

~ D Y(l&lt;-n+l) E 
u(k) y(k+l) v(k) 

$ N 
q-

u(K-1) E 

cÇJ u u(K-2) R 
u(k-m+2) A 

cã u(k-m+l) L mps: método série-paralelo 
mp: método paralelo 

Figura 3. 9 Opções de identificação do processo utilizando rede neuml para capturar o comportamento 
dinâmico; método série-paralelo e método paralelo. 

No método série-paralelo, a salda do processo é alimentada na rede neural, e no 

método paralelo, as saídas atrasadas da própria rede são alimentadas à mesma. A Equação 

3.25, referente ao Modelo IV, passa a ser escrita na forma: 

Y(k +I)= ][Y(k),Y(k -I), ... ,Y(k- n + I);u(k),u(k -I), ... ,u(k-m +I)] (3.27) 

Esta forma de se reproduzir o comportamento dinâmico, usando formas não 

lineares de equações de diferenças finitas, requer um número bem maior de entradas na 

rede, o que obviamente requer mais neurônios e pesos a serem ajustados, porém, o 



53 

treinamento é relativamente mrus simples do que no caso de sistemas de equações 

diferenciais não lineares. 

3.4 Aplicação das redes neurais no FCC 

Neste item é feita uma descrição do processo de identificação da unidade de FCC 

em redes neurais. De acordo com a descrição do item 3.2.2 Estratégia de controle do FCC, 

para esta unidade várias estratégias de controle poderiam ser apresentadas. O objetivo aqui 

não foi o de propor uma mudança nas condições de controle, nem alterar as ações das 

variáveis manipuladas e controladas da unidade, mas sim de propor uma alternativa de 

controle utilizando RNA. Procurou-se manter as mesmas considerações de restrição e 

controle operacional existentes nesta unidade, inserindo se necessário urna rotina de 

otimização baseada nesta estratégia já existente. Para o processo de identificação em redes 

neurais as seguintes variáveis operacionais foram selecionadas como variáveis controladas: 

- Temperatura da Fase Densa do Primeiro Estágio de Regeneração- TRGl; 

- Temperatura da Fase Densa do Segundo Estágio de Regeneração- TRG2; 

- Severidade da Reação Catalítica- SEV; 

- Temperatura na Saída do Riser - TRX. 

As temperaturas apresentam restrições relativas a limitação de material, segurança 

e estabilidade do próprio processo catalítico. As temperaturas das fases densas do primeiro 

e segundo estágios de regeneração são controladas a partir da injeção de ar no regenerador. 

Na verdade este controle representa um controle indireto, pois a variável que se deseja 

controlar é a temperatura da fase diluída geral. Esta temperatura é a melhor indicação da 

conversão do regenerador para controlar a razão CO/C02, na ausência de um analisador de 

linha. Para manter esta temperatura nos limites especificados, na faixa de 705 a 720°C, as 

temperaturas das fases densas deverão ser mantidas próximas aos seus valores de referência 

para controle, ou seja, 671,6°C no primeiro estágio e 700,8°C no segundo. Como a razão 

entre as vazões de ar para o primeiro e segundo estágios é mantida fixa (RAIJIRA12=10) 

conforme modelo fenomenológico, toma-se dificil manter as duas variáveis nos seus 

respectivos valores de referência ao mesmo tempo para todos os estados estacionários. 

Desta forma, se urna delas for controlada, por exemplo, a variável TRGl, a outra não 

necessariamente será mantida exatamente no controle. Esta limitação é observada quando 



54 

se executa o programa de simulação da unidade FCC, dessa forma é esperado o mesmo 

comportamento no modelo em redes neurais. 

A Temperatura de Saída do Riser é considerada a variável maís importante para 

ajuste da conversão do reator sendo usada para definir estratégias de produção. Um valor 

elevado nesta temperatura aumenta a produção de hidrocarbonetos leves, sendo adequado 

para aumentar a produção de GLP; por outro lado, um valor maís baixo aumenta a 

produção de Nafta, que constitui a principal meta de uma unidade de FCC. Temperaturas 

excessivamente altas tendem a formar muito gás combustível, o que limita a produção da 

unidade devído a limitações no processamento deste gás, e um valor muito baixo irá limitar 

a conversão da unidade. Para maximizar a conversão de Nafta, esta variável deve ser 

mantida próxímo de 542°C, e para elevar a produção de GLP a temperatura deve ser 

mantida em 545°C. 

A Severidade da Reação Catalitíca representa na verdade um valor estimativo, 

obtido empiricamente (Equações 0.6 e D.6a ANEXO D). Para produção de Nafta, este 

valor deve ser mantido próximo de 76, 7%. Seu controle pode ser feito alterando-se a 

temperatura do reator, ou a temperatura da carga. É importante observar a estreita relação 

entre a temperatura de saída do Riser e a severidade da reação catalitica, de forma que 

alterando-se o valor de referência de uma, necessariamente irá afetar o valor da outra. Da 

mesma forma como ocorre nas temperaturas do regenerador, é esperado também um 

comportamento similar entre as variáveis severidade da reação catalitica e temperatura de 

saída do Riser no modelo em redes neurais. Portanto, para se obter uma resposta adequada 

de controle, faz-se necessário alterar ambos valores de referência. Esta variável apresentou 

restrições de máximo em 85% e de minimo em 70%. 

Além dessas variáveis, outras ainda necessitam ser mantidas dentro de urna faixa 

restrita de controle. É o caso das variáveis associadas do processo. Pertencem a este grupo 

de variáveis o diferencial de pressão entre regenerador e reator - SETPDCV, que permite 

um fluxo contínuo de catalisador escoando do regenerador para o reator, sendo mantido em 

0,65kg:f/cm2 e a temperatura da fase diluída geral - TDG, que indica a conversão do 

regenerador, sendo mantida entre 710 e 725°C. 

É sabido que estes valores de referência podem apresentar ligeiras variações em 

função principalmente da qualidade da carga. Considera-se, entretanto, que mantendo estas 



55 

variáveis selecionadas dentro de um certo limite de controle, a unidade FCC será mantida 

em condições estáveis de operação, mantendo a conversão constante mesmo na presença de 

perturbações externas como, por exemplo, as mudanças na qualidade da carga ou as 

oscilações inerentes ao processo. 

Foi efetuado um teste de sensibilidade da unidade. Neste procedimento procurou-

se aplicar degraus em algumas variáveis, denominadas aqui de variáveis manipuladas, 

acompanhando-se suas influências nas variáveis controladas e associadas em função do 

tempo, utilizando o sistema aberto, ou seja, sem ação de controle. Os testes de simulação 

realizados consistiram de variações em forma de degraus nas variáveis: 

- Vazão de Alimentação- RTF; 

- Temperatura da Alimentação - TFP; 

- Vazão de Ar para o Regenerador - RAI; 

- Abertura da Válvula de Catalisador Regenerado- CTCV. 

Estas variáveis manipuladas também apresentam restrições de operação. A 

variável RTF - vazão de alimentação, por exemplo, é controlada por outro algoritmo 

externo à unidade, então a estratégia normalmente efetuada nesta variável é manter os 

valores de máximo e minimo de restrição próximos um do outro, em uma situação 

previamente definida fora da unidade. Caso se deseja efetuar uma estratégia de otimização 

de produção nesta variável, seus limites de restrição poderão ser alterados, sendo 

aumentados ou diminuídos, conforme a operação decida por elevar ou reduzir a produção. 

Os limites existentes para esta variável são: 383,3m3/h a 416,7m3/h. A variável TFP -

temperatura de alimentação, representa uma variável importante para ajuste da severidade 

da reação catalítica atuando no controlador de temperatura do forno de carga. Apresenta 

apenas limite minimo de 219°C. A variável RAI - vazão de ar para o regenerador, é 

utilizada para controlar a temperatura dos leitos densos. Convém observar que esta vazão 

representa a vazão total de ar para o regenerador, conforme já dito. Esta variável apresenta 

um limite máximo de 240k:Nm3 Ih. A variável CTCV - abertura da válvula de catalisador 

regenerado, apresenta uma resposta muito acentuada (maior sensibilidade) nas variáveis 

SEV e TRX. Apresenta restrição de máximo em 0,9 unidades e de minimo em O, 72 

unidades. 



56 

Uma vez definidos os controles propostos, ou seja, defitúdas as variáveis 

controladas e as variáveis matúpuladas, é apresentado a seguir a estrutura da rede neural 

que irá representar a utúdade de FCC. 

Devido a complexidade da estrutura da rede neural proposta foram consideradas 

duas estratégias de identificação para representar o modelo. Na primeira estratégia, com o 

objetivo apenas de obtenção dos parâmetros de treinamento da rede, como, por exemplo, a 

obtenção do número de padrões, o número de degraus mínimo necessário para cada 

variável matúpulada, a freqüência de amostragem e a precisão de convergência 

(representada pelo gradiente da função objetivo) foi considerado um sistema MIMO mais 

simples. Neste sistema MIMO cada variável matúpulada foi tratada individualmente, sendo 

geradas urna rede neural para cada variável matúpulada, resultando em 4 redes neurais. Na 

segunda estratégia foi considerado um sistema MIMO mais complexo, onde as variáveis 

matúpuladas foram tratadas em co~unto. Nesta estratégia de identificação foram usados os 

parâmetros obtidos das 4 redes obtidas pela estratégia anterior. 

No sistema MIM:O mais simples, o número de nós na camada de entrada da RNA 

foi definido como sendo igual ao número de variáveis controladas, obtidas no instante atual 

'k' adicionado de uma variável matúpulada, obtida também no instante atual 'k', ou seja, a 

rede foi representada por cinco (5) nós. Estes nós na camada de entrada corresponderam a: 

TRGh, TRG2k, SEVk e l'RX,ç; adicionado de uma das seguintes variáveis: RA.lk, CTCVk, 

RTFk ou TFPk. No sistema MIMO mais complexo o número de nós na camada de entrada 

da RNA foi definido como sendo igual ao número de variáveis controladas, obtidas no 

instante atual 'k' adicionado de todas as variáveis matúpuladas também no instante atual 

'k', ou seja, a rede foi representada por oito (8) nós. Estes nós, portanto, corresponderam a: 

e TRGh, TRG2k, SEVk, l'RX,ç, RA.lk, CTCVk, RTFk e TFPk. O número de nós na camada 

de saida foi definido como igual ao número de variáveis controladas, obtidas no instante 

futuro k+ 1, sendo representada por quatro ( 4) nós tanto no sistema MIMO mais simples 

quanto no sistema mais complexo, correspondendo a: TRGh+I, TRG2k+I, SEVk+I e 

TR:X,ç+I· Na ausência de um critério preciso para detenninação do número de nós na 

camada intermediária, foi adotado para esta detenninação o método de tentativa e erro. A 

determinação desses parâmetros no sistema MIMO mais simples, como intervalo de tempo 

entre cada degrau e intensidade destes degraus, para cada variável matúpulada, obedeceu a 



57 

uma certa lógica baseada em tentativa e erro associada a "bom senso", uma vez que existe 

um certo compromisso entre o tempo de treinamento, a precisão da rede neural e a 

necessidade de extrapolação desses resultados para serem utilizados no sistema MIMO 

mais complexo. A Figura 3.10 mostra a arquitetura 8x15x4 proposta para a rede neural que 

irá representar o modelo fenomenológico (sistema MIMO mais complexo). Nesta figura 

não estão representados os pesos e bias por limitação de espaço na mesma. 

Figura 3.10 Esboço da representação da rede neural proposta com arquitetura 8xl5x4, 
referente ao sistema MIM:O mais complexo. Os pesos e Bias não estão 
apresentados por problemas de limitação de espaço na figura. 

O algoritmo de identificação do processo em redes neura1.s artificiais (vide 

ANEXO E) descreve passo a passo o procedimento utilizado na obtenção do modelo em 



58 

redes neurais. Foram utilizadas rotinas computacionais em linguagem FORTRAN para 

realização deste procedimento. 

3.5 Controle Preditivo com Modelo 

Neste estudo é proposto utilizar o Controle Preditivo com Modelo devido à sua 

grande capacidade de projeto de sistemas de controle, com obtenção de ótimo desempenho 

e capacidade de operação por grandes periodos de tempo sem intervenções freqüentes de 

especialistas (FILETI, 1998). Sua aplicação é bastante adequada para sistemas 

multivariáveis e com restrições. O controle preditivo apresenta algumas variações, Modei 

Aigorithmic Contrai - MAC, Dynamic Matrix Contrai - DMC; Generaiized Predictive 

Contrai - GPC; Receding Horizon Control - RHC e Neural Network Internai Modei 

Contra/ - NNIMC. Cada uma dessas variações se fundamenta em metodologias 

ligeiramente distintas apresentando vantagens e limitações. 

O controle preditivo é assim denominado devido à forma como é feito o cálculo da 

lei de controle, ou seja, no instante atual, chamado instante k é feita a previsão do processo 

para instantes futuros, k+ I, k+2, ... , k+Np, onde Np é denominado horizonte de predição. O 

ponto de partida para esta predição é representado pelos sinais das variáveis controladas e 

manipuladas atuais provenientes da unidade industrial. A partir de um modelo, previamente 

definido, são feitas previsões das respostas do processo simulando alterações nas variáveis 

manipuladas para Nc instantes futuros, onde Nc representa o horizonte de controle; 

normalmente Nc 5 Np. São feitas então seleções destas variáveis de forma a escolher 

aquelas que fornecem somente respostas com determinadas características. Apesar da 

previsão ser feita sobre um horizonte de controle, apenas a primeira predição é 

implementada na ação do controlador. Após implementação, o tempo é atualizado para k+ I 

e todo o cálculo é repetido. A Figura 3.11 apresenta o esboço da ação do controle preditivo 

para um sistema SISO genérico qualquer. 



passado 

r ~set..poinf' 

--~---r~--~~--~~~--~~~~ rem~ 
K~2 K-1 K+1 K+U 

u 

momento presente 

Muro 

K+H 

ações de controle 
projetadas 

Figura 3.11 Esboço ilustrativo da ação de controle preditivo considerando apenas uma variável 
controlada (sistema SISO). 

59 

Normalmente, adota-se um critério de comparação entre a resposta predita e a 

resposta desejada para escolha da ação do controlador. Esta comparação é feita por meio de 

minimização de equações algébricas que geralmente são funções da variável controlada 

predita - y , da variável manipulada - u e de uma trajetória de referência - sp (setpoint). 
Desta forma, o erro futuro é minimizado, e se o modelo escolhido representar bem o 

processo e se não ocorrerem distúrbios, o processo seguirá fielmente a trajetória de 

referência. Existem três técnicas diferentes para se representar o modelo interno de 

predição, como Modelo de Convolução, utilizado no Controle por Matriz Dinâmica, 

Modelos Heurísticos, utilizados no Controle por Modelo Algoritmo, e Modelo por Redes 

Neurais, utilizados no Controle por Rede Dinâmica. No presente estudo é proposto utilizar 

as Redes Neurais Artificiais, para representar o modelo de predição. 

3. 5.1 Controle do FCC utilizando como modelo os Redes Neurais 

A metodologia de Controle Preditivo com Modelo pode utilizar como modelo do 

processo a própria rede neural. Freqüentemente leva em consideração apenas os dados de 

entrada e saída sem necessidade do conhecimento prévio das leis fundamentais que regem o 

processo. Alguns autores denominam urna variação dessa técnica de Controle por Rede 

Dinâmica - DNC (Willis et ai., 1992, apud FILETI, 1998). Esta técnica relativamente 

recente foi aplicada pelos autores na simulação de um sistema não linear caracterizado por 

eles de sistema de múltiplas entradas e única saída (Multiple Input and Single Output -



60 

MISO), representado por uma coluna piloto de 1 O estágios. A rede proposta apresentou 

arquitetura do tipo 3-4-4-1 (IxHlxH2xO) para simular um controle preditivo não linear, 

sendo comparado com um modelo preditivo linear com tempo morto e com um controlador 

PI (Proporcional Integral). Foi utilizado o mesmo horizonte de predição e controle para 

ambos os controladores. Analisando o erro pelo método Integral do Erro Absoluto IAE 

(Integral Absolute Error), foi observado que o controle preditivo não linear apresentou o 

menor índice IAE. Eles implementaram também o mesmo controlador preditivo não linear 

para demonstrar sua aplicabilidade em um problema com características MIMO. 

O diagrama a seguir (Figura 3 .12) mostra um esquema de um controlador 

preditivo utilizando Redes Neurais (BHAT &amp;amp; McAVOY, 1990; apud DE SOUZA JR., 

1993). 

Entradas passadas . 
e presentes Saídas 

Futuras 
Redes Neurais 

Entradas 
Futuras 

+ 
Otimizador 

Para o 
Processo -

Valo es 
Desejados 

Figura 3.12 Esquema genérico proposto para um Controlador Preditivo com Modelo 
utilizando Redes Neurais Artificiais (DE SOUZA JR., 1993). 

A rede neural usada foi previamente treinada para identificação do processo. Para 

em seguida estar apta para o controle fazendo predições um passo adiante, em um total de 

Np predições no futuro. 

O método sugerido foi fundamentado numa proposta de WILLIS et ai. (1992) e 

HUNT et ai. (1992), (apud FILET, 1998), e se baseia na minimização de uma função 

objetivo j definida como, 



61 

(3.28) 

onde Np é o horizonte de predição, Nc é o horizonte de controle, 2 são os pesos utilizados 

para penalizar variações excessivas da variável manipulada, e a são os pesos de igual 

importância utilizados para se definir urna ordem de importância nas variáveis controladas, 

os índices q representa a variável controlada, e r representa a variável manipulada, 

(FILETI, 1998). A expressão da função objetivo j está sujeita as seguintes restrições nas 

entradas e saídas do processo: 

&lt;'(k ")&amp;lt;·-1 N Ymin -Yq +1 -Ymáx,l- , ... , P (3.29) 

(3.30) 

[u(k +i)- u(k +i -1)} 5, LÍU=,i = l, ... ,Nc (3.31) 

A trajetória de referência para a estratégia de controle é dada pelo modelo: 

spq(k)=y(k) (3.32) 

spq(k+i)= f:Jspq(k+i-1)+( ]- fJ )spq(k) (3.33) 

onde fJ assumiu os seguintes valores: 0,80; 0,85; 0,90; 0.95 e 0,97, dependendo do ajuste do 
controlador. 

Para garantir a robustez do modelo, cada predição de um passo adiante da rede 

neural foi corrigida usando uma variável de correção fornecida por: 

corr(k) = y(k)- Y(k I k-1) (3.34) 



62 

A predição corrigida assume a forma: 

y,(k + 1 i k) = j)(k +li k)+corr(k) (3.35) 

onde y(k) é a saída real do processo no tempo de amostragem k; y( k I k -1) , é a predição 

da variável y para o instante k obtida pela rede neural no tempo de amostragem anterior 

(k- 1) e y J k i k + 1) é a variável corrigida. 

A rotina computacional do controlador foi desenvolvida utilizando a linguagem 

FOR~, sendo inserida na rotina do modelo fenomenológico. As restrições já 

existentes neste modelo fenomenológico foram mantidas, e as rotinas de entrada e saída de 

dados foram aproveitadas. O processo de minimização da função objetivo foi realizada 

empregando a rotina NCONF, da biblioteca IMSL, interna do FORTRAN. Esta rotina 

implementa o método de programação quadrática sucessiva (Successive Quadratic 

Programming - SQP) e o método do gradiente por diferenças finitas (Finite Difference 

Gradient), mas não está disponível na forma aberta, e portanto não se tem acesso aos 

programas fontes. No ANEXO C é apresentado um algoritmo para implementação do 

Controlador Preditivo com Modelo via Redes Neuraís Artificiais. No programa em 

linguagem FORTRAN, foram incluídas as restrições do modelo (Equações 3.29 a 3.31), 

sendo estas restrições utilizadas também para realizar a estratégia de otimização do 

controlador. As variáveis manípuladas e controladas deverão primeiro ser normalizadas nos 

mesmos moldes da normalização usada no processo de identificação, (Equações 3.19 e 

3.20), antes de serem inseridas como dados de entrada do programa. 

Após identificação do modelo em RNA, ou seja, após obtenção da rede neural e 

após desenvolvimento do modelo preditivo usando esta rede neural como modelo para 

predição do comportamento do sistema MIMO maís complexo, foram feitos testes de 

simulação para verificar o desempenho dos resultados do modelo proposto. A Figura 3.13 a 

seguír apresenta um esboço do sistema de controle proposto, já acoplado ao sistema 

convencional. Convém relembrar que a unidade FCC é representada por um simulador 

matemático denominado de modelo fenomenológico. 



U,Y 
Restrições 

MODELO 

------ --- ----® PR~~~ O 
r---1---l,QDN~C;:_j-1 

Fomo 

Função 
Objetivo 

r -::,t-----t-W~-:-:::rt-\-,L;-l--~-~----~--------t: ti-T:c-+--tz:_(_---lr~rga c 
· @ L....----c combustível 
i - FC _; 
' I 
~-------------j __________________ _ 

Figura 3.13 Esboço do sistema de controle proposto, via Redes Neurais Artificiais, 
para acoplamento ao controle convencional da unidade FCC. 

63 



65 

CAPÍTULO IV 

RESULTADOS 

É proposto otimizar o controle da unidade FCC, representada aqui por um modelo 

fenomenológico existente, procurando manter as variáveis do processo dentro de seus 

limites de restrição frente às perturbações no sistema, quer sejam na vazão, temperatura ou 

qualidade da carga. A estratégia definida para esta proposta foi primeiramente realizar a 

identificação do processo da FCC em RNA, gerando um modelo. Posteriormente foi 

desenvolvido um controlador preditivo que fez uso do modelo desenvolvido em RNA como 

modelo interno do controlador. Com o controlador proposto acoplado ao simulador que é o 

próprio modelo fenomenológico foram realizados diversos testes de desempenho, 

comparando seus resultados com o sistema aberto e com o modelo DMC obtido por 

MORO, (1992). Seguem os resultados obtidos da identificação, controle e testes efetuados. 

4.1 Identificação do modelo fenomenológico via Redes Neurais Artificiais 

4.1.1 Obtenção dos conjuntos de dados a partir do modelo fenomenológico 

Diversas variáveis operacionais poderiam ser utilizadas como variáveis 

controladas e manipuladas na indústria (vide CAPÍTULO III). Porém, a alteração da 

estratégia básica de controle existente atualmente na unidade FCC não fez parte deste 

estudo, portanto as mesmas variáveis controladas e manipuladas consideradas no estudo de 

MORO foram também consideradas neste estudo. A estratégia de produção proposta foi a 

de maximizar a produção de Nafta sendo entretanto realizado um teste propondo mudança 

de produção para GLP, visando avaliar o desempenho do controlador num processo de 

alteração da estratégia de produção. Como o modelo fenomenológico desenvolvido por 

Moro foi usado para representar a unidade industrial no processo de identificação em RNA, 

procurou-se elevar ao máximo a amplitude dos degraus nas variáveis manipuladas, para 

avaliar a capacidade das Redes Neurais Artificiais em fornecer as respostas adequadas nas 

variáveis controladas sem ultrapassar os limites de restrição de cada urna delas. 

Partindo de um programa em linguagem FORTRAN, denominado aqui de modelo 

fenomenológico, desenvolvido por MORO (1992), o qual representa a dinâmica da unidade 

FCC, foram obtidos por simulação diversos conjuntos de dados em malha aberta, isto é, 



66 

sem ação de controle, para diferentes condições de operação. Para isto foram 

implementados degraus nas 4 variáveis manipuladas individualmente, RAI, CTCV, RTF e 

TFP, partindo de um estado estacionário inicial, observando-se o seus efeitos nas 4 

variáveis controladas, TRGI, TRG2, SEV e TRX, e nas variáveis associadas TDG e TD2 

em função do tempo. 

Estes dados obtidos da simulação foram divididos em três grupos: conjunto de 

dados para treinamento da rede neural- grupo de treinamento, conjunto de dados para 

validação do modelo -grupo de validação, e co~unto de dados para teste da rede neural já 

treinada - grupo de teste. O método da validação cruzada foi usado para obtenção dos 

dados para treinamento da rede (padrões de treinamento e validação). Obviamente, a forma 

como foram obtidos os grupos de treinamento e validação garante que o grupo de dados de 

treinamento é também um subconjunto do grupo de validação, mas o grupo de dados de 

teste foi obtido utilizando outra seqüência de degraus de forma a não comprometer a 

validade da rede neural. Posteriormente, os arquivos obtidos de cada um dos grupos eram 

normalizados e armazenados na forma adequada para serem lidos pelo programa de redes 

neurais. Foi a partir destes conjuntos que a identificação do modelo da FCC em redes 

neurais foi realizada. 

4.1.2 Obtenção das condições do treinamento dos redes 

Utilizando um simulador de redes neurais, conforme CAPÍTULO Ill e 

procedimentos descritos no ANEXO E, foram criadas diversas arquiteturas de redes 

neurais, sendo treinadas, validadas e testadas pelos vários conjuntos de dados obtidos do 

modelo fenomenológico. 

Inicialmente, foram feitas simulações em um sistema MIMO mrus simples, 

utilizando apenas uma variável manipulada, observando as respostas nas quatro variáveis 

controladas, visando obter o número de degraus em cada variável manipulada; o valor de 

cada degrau; o intervalo de tempo entre dois degraus consecutivos, que pudessem abranger 

toda a faixa de operação da variável; a freqüência de amostragem; e o gradiente da função 

objetivo (que é um dos critérios de convergência da rede neural, e que define indiretamente 

a precisão do resultado da rede). Este sistema MIMO foi gerado apenas para esta finalidade. 

Diversas arquiteturas de RNA foram obtidas, sendo considerado como aceitas para 

análise aquelas configurações cujos resultados das variáveis controladas obtidos das redes 



67 

neurais apresentaram erros relativos inferiores a 1% em todos os pontos, quando 

comparados com os resultados obtidos com o modelo fenomenológico. Desta forma, a 

estratégia de criação das redes neurais obedeceu a uma rotina de cálculos rigorosamente 

estabelecida (vide ANEXO E). Estes resultados obtidos utilizando este sistema MIMO mais 

simples foram úteis para uma estimativa da configuração do modelo utilizando um sistema 

MIMO mais complexo, onde estava previsto utilizar as quatro variáveis manipuladas em 

uma única rede neural. 

A Tabela 4.1 apresenta alguns resultados obtidos do treinamento da rede na etapa 

de determinação dos parâmetros para configuração da rede neural, utilizando processador 

Pentium II 400 mHz. O programa era sempre reiniciado com pesos e bias diferentes quando 

a convergência não era atingida. Isto era observado quando o programa travava por algum 

motivo ou quando o valor mínimo do gradiente da função objetivo não era encontrado. 

Tabela 4.1 Exemplos de alguns resultados de arquiteturas de RNA obtidos para determinação dos 
parâmetros da rede: número de degraus, número de padrões de treinamento e precisão do 

ente. 
Arquite- Variável n• Número Tempo Gradiente Função N• Obs: 
tora da mauipu- degraus de padrões deCPU (critério de objetivo iterações 
rede (1) lada (minuto) convergência) 

8x15x4 (2) 25 1367 2589 5,26E-4 1,09E-1 861 
5x3x4 RAI 6 584 107 6,02E-8 2,10E-2 2528 (5) 
5x9x4 TFP 6 284 17 8,20E-4 4,45E-1 200 
5x20x4 TFP 6 284 238 9,41E-4 4,28E-1 213 
5x5x4 RTF 23 892 3307 (1,00E-9) (3) (4) 
5x6x4 RTF 23 892 920 8,11E-8 1,34E-2 6845 (3) 
8x3x4 (2) 30 2091 97 3,54E-4 6,22E-1 1203 (5) 
5x5x4 CTCV 7 434 355 9,45E-8 2,61E-2 &gt;10000 (6) 
5x4x4 CTCV 8 343 126 9,02E-8 1,40E-2 8320 (6) 
5x6x4 RAI 13 928 (l,OOE-7) (3) (7) 
5x7x4 RTF 23 892 9161 (l,OOE-9) (3) (4) 

(1) Camadas de entrada, escondida e de saída da rede neural (1 x H x 0): (lnput, Hidden, Output layers). 
(2) RAI, TFP, RTF e CTCV; 
(3) Número excessivo de padtões para esta arquitetura de rede e esta precisão (critério de convergência); 
( 4) O programa não convergiu mesmo após reiniciar 8 vezes utilizando valores de pesos diferentes; 
(5) Resultados não satisfatórios com 3 nós na camada escondida (com perda de generalidade); 
( 6) O programa convergiu após reiniciar 3 vezes com pesos aleatórios diferentes; 
(7) O programa não convergiu. 

Inicialmente, com a utilização de um processador Pentium 100 mHz, não foi 

obtido sucesso na convergência para nenhuma configuração de rede neural com mais de 5 

nós na primeira camada, utilizando um número superior a 2500 padrões no treinamento da 



68 

rede e adotando como critério de convergência um valor inferior a 1, Oe-7 no gradiente da 

função objetivo. Uma vez que haveria necessidade de modelar o sistema com as 4 variáveis 

manipuladas juntas, representativo do sistema MIMO mais complexo, foram necessários 

alguns ajustes nos parâmetros da RNA na obtenção do grupo de treinamento, como a 

redução do número de padrões, a alteração do tempo de amostragem e a diminuição da 

precisão da rede, na tentativa de se reduzir o tempo de treinamento e avaliar a condição 

limite de cada um desses parâmetro. Esta exigência foi justificada pela elevada carga 

computacional do método do gradiente conjugado utilizado no programa de treinamento via 

backpropagation. 

Na ausência de um critério para a determinação dos parâmetros a serem utilizados 

na configuração da RNA, considerou-se como ponto de partida os mesmos valores de 

degraus recomendados por MORO, (1992). Devido à necessidade de abranger toda a faixa 

de restrição das variáveis manipuladas, esta escolha resultou em um número excessivo de 

degraus no treinamento, ou seja, 23 degraus na variável RTF, 13 degraus na variável RA1 e 

18 degraus na variável TFP; a amostragem, para esses casos foi tomada de 2 em 2 minutos 

e o tempo considerado entre dois degraus consecutivos foi de 200 minutos, constante para 

todas as variáveis (por facilidade de programação). Desta forma, alguns problemas 

surgtram, como por exemplo, a obtenção de um número de padrões excessivo, 4600 

padrões apenas para a variável RTF. Outro problema encontrado foi que em algumas das 

simulações efetuadas, o sistema não chegava a atingir o estado estacionário antes da 

implementação do degrau seguinte, observado quando se aplica degraus nas variáveis 

manipuladas RA1 e CTCV, pois para essas variáveis, as variáveis controladas necessitam de 

um intervalo de tempo acima de 200 minutos para atingir o novo estado estacionário. 

Posteriormente, foi tentado reduzir o número de degraus em cada variável 

manipulada e, simultaneamente, aumentar o intervalo de tempo entre os degraus. 

Obviamente, reduzir o número de degraus implica em aumentar a amplitude do mesmo. 

Assim, outros problemas surgiram, pois um degrau maior resulta em respostas mais 

agressivas tanto nas variáveis controladas quanto nas variáveis associadas do processo, 

resultando em temperaturas que ultrapassavam os limites impostos pela restrição do 

modelo. 

Foi observado que a simulação no modelo fenomenológico, para obtenção dos 

grupos de dados da identificação, deveria apresentar um compromisso entre o número de 



69 

degraus e o intervalo de tempo entre eles, de forma a abranger toda a faixa de operação 

da variável manipulada, sem no entanto sobrecarregar o processamento computacional do 

treinamento das redes neurais. Outra exigência necessária, relativa ao treinamento, foi 

reduzir de forma acentuada o número de padrões a ser apresentado à rede neural, reduzindo 

a freqüência de amostragem; inicialmente tomado amostras de 2 em 2 minutos, passando 

para de 4 em 4 minutos e finalmente para a freqüência de 6 em 6 minutos. Observou-se que 

um valor acima deste último compromete os resultados da rede neural, e os valores 

inferiores à freqüência de 6 minutos provou-se serem excessivos do ponto de vista do 

processo, além de comprometer o tempo de treinamento. 

A freqüência de amostragem dos dados utilizados para validação (grupo de 

validação) não apresentou nenhuma restrição quanto ao tempo de processamento, obtendo 

respostas num intervalo de alguns segundos, sendo portanto adotada a freqüência de 2 em 2 

minutos para validação das RNA. Com isto, o número de padrões na etapa de validação das 

redes foi 3 vezes superior ao número de padrões de treinamento [(6 em 6) x (2 em 2 min.)]. 

O gradiente da função objetivo, que indica a precisão alcançada pela rede durante 

o treinamento, também precisou ser alterado, pois foi observado que um valor muito baixo, 

da ordem de l,OOe-7 ou inferior, dependendo do número de padrões apresentados à rede e 

da arquitetura proposta, resultava na não convergência do método. Observou-se também 

que a utilização de um valor mais elevado, da ordem de l,OOe-2 no gradiente da função 

objetivo, não necessariamente resultou numa rede mal condicionada como era esperado, 

mas, por outro lado, permitiu a convergência e tomou o processamento bem mais rápido. 

Portanto, depois de exaustivos testes com o sistema MIMO mais simples nas condições 

intermediárias entre l,OOe-2 e l,OOe-7, adotou-se o valor de l,OOe-3 no gradiente da função 

objetivo como critério de convergência para o sistema MIMO mais complexo. 

A Tabela 4.2 a seguir apresenta as variáveis manipuladas, com os valores obtidos 

após testes exaustivos de simulação. Dessa forma são apresentados os degraus, a freqüência 

de amostragem e o tempo entre os degraus, selecionados para obtenção dos conjuntos de 

treinamento e de validação das RNA. Estes valores foram utilizados tanto no modelo 

fenomenológico quanto no modelo em redes neurais, testando cada uma variável 

manipulada individualmente. Observa-se que estes degraus nas variáveis manipuladas 

abrangem toda a faixa de operação da respectiva variável, sendo possível obter qualquer 

estado estacionário dentro do intervalo de validade do modelo fenomenológico. 



70 

Tabela 4.2 Variáveis manipuladas, suas respectivas perturbações impostas, freqüência de 
amostragem e intervalo de tempo entre cada degrau para os conjuntos de treinamento 
e os conjuntos de validação das RNA, nas configurações 1 e 2. 

VARIA VEIS CONJUNTO DE TREINAMENTO E V ALIDAÇÂO 
MANJPULADAS Degrau (%) Tempo entre degraus (min.) 

TFP 
RAI 
RTF 

CTCV 

TFP; 
RAI; 
RTF; 
CTCV 

Configuração 1: 5xHx4 (MIMO mais simples). 
-5, -8.5, -3, +1, +4, o 270, 300, 300, 300, 300, 300 
-5, -9, -3, + 1, +4, o 570, 600, 900, 600, 600, 300 
-6, -10, -4, +2, +7, o 270, 300, 300, 300, 300, 300 
-7, -12, -5, +2, +11, +4, o 270, 300, 300, 300, 600, 600, 300 

Configuração 2: 8xHx4 (MIMO mais complexo). 
-5, -8.5, -3, +1, +4, O, 300, 300, 300, 300, 300, 300, 
-5, -9, -3, + 1, +4, O, 600, 600, 900, 600, 600, 300, 
-6, -10, -4, +2, +7, O, 300, 300, 300, 300, 300, 300, 
-7, -12, -5, +2, +11, +4, o 270, 300, 300, 300, 600, 600, 300 

Freqüência de amostragem Treinamento: de 6 em 6 minutos 
Validação: de 2 em 2 minutos 

As arquiteturas representadas pela estrutura geral 5xHx4 (IxHxO) representam o 

sistema MIM:O mais simples e as arquiteturas representadas por 8xHx4 representam o 

sistema MIM:O mais complexo; variando o valor de H, número de neurônios na camada 

intermediária, as diversas configurações das redes neurais puderam ser obtidas. No sistema 

MIMO mais simples, os 5 nós na camada de entrada representam as seguintes variáveis: 

uma variável manipulada e quatro variáveis controladas, relativas ao instante atual k, e a 

camada de saída é formada pelas 4 variáveis controladas relativas ao instante futuro k+ I. 

Os números de nós representativos da camada intermediária foram determinados de forma 

sistemática, iniciando por 2 nós e aumentando até 20 nós. Dos modelos obtidos em redes 

neurais, foi escolhido para representar a unidade de FCC um dos que apresentaram melhor 

desempenho associado ao menor tempo de treinamento. 

A freqüência de amostragem dos dados utilizados para teste da rede (grupo de 

teste) não apresentou nenhuma restrição quanto ao tempo de processamento, obtendo 

respostas num intervalo de alguns segundos, sendo portanto adotada a freqüência de 1 em 1 

minuto para teste das RNA. O grupo de teste das redes treinadas apresentou um número de 

padrões diferentes do número de padrões apresentado pelo grupo de treinamento para cada 

variável manipulada testada. Estes padrões foram distribuídos em 3 degraus. 

A Tabela 4.3 apresenta os resultados obtidos após exaustivos testes de simulação 

dos valores dos degraus, a freqüência e o tempo de amostragem, selecionados para 

obtenção do conjunto de teste das redes neurais artificiais. Conforme se pode observar, os 



71 

valores dos degraus aqui obtidos foram diferentes daqueles utilizados para treinamento e 

validação das redes neurais. A configuração 1 corresponde ao sistema MIMO mais simples 

e a configuração 2 corresponde ao sistema MIMO mais complexo. 

Tabela 4.3 Variáveis manipuladas, suas respectivas pertmbações impostas, freqüência 
e tempo de amostragem para o conjunto de teste das redes neurais, nas 
configurações 1 e 2. 

VARIÁVÊIS 
MANIPULADAS 

CONJUNTO DE TESTE 

Degrau(%) Tempo (min.) 
Configuração 1: 5xHx4 (MIMO mais simples) 

TFP +2.5, -2.5, o 320, 350, 350 
RAI +2.5, -2.5, o 320, 350, 350 
RTF +1.5, -1.5, o 320, 350, 350 

CTCV +2.5, -2.5, o 320, 350, 350 
Configuração 2: 8xHx4 (MIMO mais complexo) 

TFP; +2.5, 2.5, O, 320, 350, 350, 
RAI; +2.5, -2.5, O, 350, 350, 350, 
RTF; +1.5, -1.5, O, 350, 350, 350, 
CTCV +2.5, -2.5, o 350, 350, 350 

Freqüência de amostragem Teste: de I em lmiouto 

4.1.3 Modelo escolhido em rede neural para representar o processo de FCC 

Após testes exaustivos utilizando a configuração 1 da Tabela 4.2, a Rede Neural 

Artificial na configuração 8xl5x4 foi escolhida para representar a unidade FCC. As 

características dessa rede neural escolhida podem ser observadas na Tabela 4.4. Conforme 

observado nesta tabela, a amostragem efetuada pelo simulador na etapa do treinamento foi 

de 6 em 6 minutos, utilizando 1367 padrões de treinamento. Para obtenção dos valores de 

pesos e bias utilizando essa arquitetura, o tempo de CPU na etapa de treinamento foi de 

2589 minutos, e o tempo de CPU da etapa de validação da rede treinada foi de frações do 

minuto, apesar do número de padrões nesta etapa ser 3 vezes maior para amostragem de 2 

em 2 minutos. 

Tabela 4.4 Característica da rede neural que irá representar a unidade FCC como modelo interno do controle 
reditivo. 

Arquitetura Função 
objetivo 

8xl5x4 1,090e-l 

Gradiente Amostragem (min.) Número de padrões 
da ftmção~~----~~~~~--~~--~~--------~~---
objetivo Treinamento Validação Teste Treinamento Teste 

5,26le-4 6 em 6 2 em 2 1 em I 1367 4058 



72 

A Tabela 4.5 a seguir estão mostrados os 207 valores de pesos e bias obtidos do 

treinamento da rede neural utilizando arquitetura 8xl5x4. 

Tabela 4.5 Valores obtidos de Pesos e Bias da Rede Neural com arquitetura 8xl5x4, obtidos a partir de 1367 
padrões de treinamento, considerando um valor de 5,26le-4 no gradiente da função objetivo e 
amostragem de 6 em 6 minutos . 

.47642007E-Ol -.10997058E+Ol .537!2952E+OO .16278169E+Ol-.2662346!E+Ol .40162145E+Ol-.85293986E+OO 
-.83308695E+OO .62985414E+OO -.!9376488E+Ol -.28953329E+Ol .51304134E+OO -.20140789E+Ol .95963696E+OO 
.44126629E+OO -.6l!l8937E+OO -.23777494E+OO -.84760394E+OO -.92440208E+OO .16982143E+Ol-.11754802E+Ol 
.26943251E+Ol .38326266E-Ol -.16456690E+Ol -.IO!l2937E+Ol .58967543E-01 -.99977825E+OO -.83331993E+OO 
.30860234E+OO .16321434E-Ol -.10190787E+Ol .91446274E+OO -.31826450E+Ol-.42!54347E+Ol-.13748242E+Ol 

-.12511031E+Ol .47372795E+Ol .72462004E+OO .25942670E+Ol .3845!975E+Ol .33209471E+Ol -.15924532E+Ol 
.963893!4E+OO .73748590E+Ol .25633198E+OO .22942283E+00-.17544575E+Ol-.19177279E+Ol .!0782848E+Ol 
.26172835E+OO .55785923E+OO .27624180E+Ol -.65433978E+OO .90384369E+OO -.75437757E+OO -.11517354E+Ol 

-.18234982E+Ol -.l0731542E+Ol -.81131642E+OO .l61320!7E+OO -.52848359E+OO -.15770797E+O! .15695846E+OO 
.36307808E+Ol -.39848365E+Ol .3764559IE+Ol-.25552819E+00-.19227990E+OO .10948989E+Ol-.21864137E+O! 

-.49544216E+Ol .94621508E+OO -.27028238E+Ol -.16543556E+Ol -.468!118!E+Ol .352814!0E+OO -.28959553E+Ol 
-.32984398E+OO .24791173E+Ol -.32945610E+Ol .37290757E+Ol .30380304E+OO -.16222274E+O! .46884296E+OO 
-.22939766E+Ol -.31556919E+Ol -.71339962E+OO -.34056904E+Ol -. 78899875E+OO -.46898667E+Ol-.7853162!E+OO 
-.20056079E+Ol .67539046E+OO .35037244E+Ol .l2661227E+Ol .2108!713E+Ol .79291829E-01 -.14226274E+Ol 
-.61056905E+Ol -.34389588E+OI-.32125939E+Ol -.19469285E+Ol -.2144746!E+Ol-.48438877E+OI .33765429E+Ol 
-.13541679E+OI -.34852518E+Ol -.42514642E+OO .35225725E+OI .28535996E+OO .40107947E+Ol -.11296984E+Ol 
-.25676889E+Ol -.4652!538E+OI -.27902707E+Ol -.34609998E+Ol -.94447819E+OO -.32538245E+Ol-. 72755567E+Ol 
.68332677E+OO -.48739794E+Ol -.55139962E+Ol -.41175465E+Ol-.61297857E+Ol .22214469E+Ol .16640388E+Ol 
.24202851E+OI .12922740E+OI -.22921244E+OI -.24820667E+Ol-.12754215E+Ol-.21005135E+Ol .27903429E+Ol 
.1525189!E+Ol .35602338E+Ol .41070880E+Ol -.34680382E+Ol -.52021135E+Ol .49014304E+OO -.17908792E+Ol 
.33645843E+Ol .41807872E+Ol-.31221733E+OO .17187288E+Ol .35363162E+Ol .28532667E+Ol .37259543E+Ol 
.35348205E+Ol -.18540924E+Ol -.18538534E+Ol -.31026818E+Ol-.38375686E+Ol -.415048!2E+OO -.10013938E+Ol 

-.73990152E+Ol -.32039620E+Ol -.34465615E+OO -.17125642E-02 -.16057288E+Ol -.2070066!E+Ol .24284576E+Ol 
.17967249E+Ol .22928926E+Ol .16208579E+Ol -.65611859E+OO -.18173554E+OO -.6384833!E+OO -.44428257E+Ol 
.33196312E+OO .32679148E+OO -.77376488E+OO .11445027E+OO -.48887102E+Ol-.42656076E+Ol-.71196779E+Ol 

-.75145752E+Ol -.5624%13E+Ol -.58074619E+Ol .95778501E+OO -.%698590E-01 .OOOOOOOOE+OO .OOOOOOOOE+OO 
.OOOOOOOOE+OO .OOOOOOOOE+OO .OOOOOOOOE+OO .OOOOOOOOE+OO .OOOOOOOOE+OO .OOOOOOOOE+OO .12526530E+Ol 

-.51555794E+OO -.25060!51E+Ol-.39141717E+Ol .26143436E+Ol-.77652453E+OO .45172553E+Ol .!8567980E+Ol 
.18321523E+Ol .18599109E+OI .56379407E+OO .28302349E+Ol .68566420E+OO .745631!5E+Ol .32621059E+Ol 
.6711!958E+OO .159438IOE+OI .17271837E+Ol .14709207E+Ol 

Estes valores de pesos e bias encontrados na etapa de treinamento serão os 

mesmos utilizados na etapa de validação e teste da rede. Os gráficos das Figuras 4.1 a 4.4 

representam os resultados obtidos da validação da rede neural, observados os critérios de 

treinamento e validação da Tabela 4.2, comparados com os resultados obtidos do modelo 

fenomenológico obtidos com a configuração 8xl5x4. Nos gráficos das Figuras 4.5 e 4.6 são 

mostrados os degraus impostos em cada urna das variáveis manipuladas e os intervalos de 

tempo entre estes mesmos degraus (obtido conforme a Tabela 4.2), aplicados no modelo 

fenomenológico e no modelo em RNA com a arquitetura 8xl5x4 escolhida. Conforme se 

pode observar desses gráficos a estratégia adotada para as perturbações foi a de aplicar 

diversos degraus em cada uma das variáveis manipuladas individualmente, procurando 



abranger toda a faixa de operação dessas variáveis, enquanto as demais variáveis eram 

mantidas fixas em um estado estacionário. 

e 
~ ·a; (.) 

E o 
"I:: 
~ 

Q. ~ 
o c.? 
"00::: 

"' 
1-

f/) • c: .._ 
"' o "' "' "' "' .._ f/) Cl) 
.f!! c: Cl) 
"' O&gt; "' !!! E o 
:::&gt; 

"' -E .!2 
"' O&gt; Q.•&lt;U 
E'ln 
"' Cl) 1-

700 

690 

680 

,.., 

~r 
670 

660 

650 

640 
o 2000 4000 

Tempo (min.) 

6000 8000 

Figura 4.1 Resposta na Temperatura da Fase Densa do primeiro estágio do regenerador, TRGl, 
aos degraus impostos nas variáveis manipuladas, TFP, RAI, RTF e CTCV, com 
arquitetura 8xl5x4 na RNA. Comparação entre RNA (representação em linha contínua) 
e modelo fenomenológico (representação descontínua). 

730 
o 
"' ~ 
~ ~ 720 
"' N f/) c.? o 
"' 

a::: 710 

"' 
1-

f/) • 
c: .._ 

"' 
o 

700 
"' "' "' 

E 
f/) Cl) 

.f!! c: 

"' 
8, 690 

"' !!! E o 
:::&gt; "' 680 -E ·º 
"' C&gt; o."" 
E "lií 670 
"' "' 1-

o 2000 4000 
Tempo (min.) 

Extratégia de treinamento 
da rede: 

o Treinamento 
--Validação 

6000 8000 

Figura 4.2 Resposta na Temperatura da Fase Densa do segnndo estágio do regenerador, TRG2, 
aos degraus impostos nas variáveis manipuladas, TFP, RAI, RTF e CTCV, com 
arquitetura 8xl5x4 na RNA. Comparação entre RNA (representação em linha 
contínua) e modelo fenomenológico (representação descontínua). 

73 



74 

~ 
~ 

84 

õi 80 
r§ 
o 
~ 78 

~ 
«&amp;lt;
"C 76 
&lt;1l 
"C 
«&amp;lt;
:g 74 
~ 

(/) 

Extratégia de treinamento 

I
, da rede: 
, c Treinamento 

~ --Validação 

l I 
I ~ ? u ~ 

72,_----~~--.---~~---,r-~~----~----~----~-
0 2000 4000 

Tempo (min.) 

6000 8000 

Figura 4.3 Resposta na Severidade da Reação Catalítica, variável SEV, aos degraus impostos nas 
variáveis manipuladas, TFP, RAI, RTF e CTCV, com arquitetura 8xl5x4 na RNA. 
Comparação entre RNA (representação em linha continua) e modelo fenomenológico 
(representação descontínua). 

570 

ü 
..2- 565 

i}? 560 
1-

~ 555 
U) 

·~ 550 
"C 
«&amp;lt;545 
:2 
«&amp;lt;
"' 540 
&lt;1l 

"C 
e! 535 
:&gt; 

~ 530 
&lt;1l 
a. 
E 525 

Extratégia de treinamento 
da rede: 

" Treinamento 
--Validação 

~ +-----~~-,----~-----r--L-~----+-----~--~-L-
0 2000 4000 6000 8000 

Tempo (min.) 

Figura 4.4 Resposta na Temperatura de Saída do Riser, 1RX, aos degraus impostos nas variáveis 
manipuladas, TFP, RAI, RTF e CTCV, com arquitetura 8xl5x4 ua RNA. Comparação 
entre RNA (representação em linha continua) e modelo fenomenológico (representação 
descontinua). 

Cada gráfico das Figuras 4.1 a 4.4 representa a resposta obtida de cada uma 

variável controlada aos degraus impostos nas variáveis manipuladas. Neles, as linhas 



75 

verticais nos instantes 1500, 4500, 6000 e 8200 minutos, delimitam os intervalos 

correspondentes aos degraus aplicados em cada variável manipulada, ou seja, delimitam a 

ação das variáveis TFP, RAI, RTF e CTCV, respectivamente, conforme pode ser observado 

nas Figuras 4.5 e 4.6. Conforme se observa, o tempo necessário para as variáveis 

controladas atingirem um novo estado estacionário após cada degrau é diferente para cada 

variável manipulada. Também pode ser observado que uma mesma variável controlada 

pode apresentar comportamentos diferentes em diferentes estados estacionários, uma 

característica da não linearidade do processo. Nestes gráficos, a indicação representada por 

um círculo corresponde aos valores do modelo fenomenológico apresentados para 

treinamento da rede e a indicação representada por uma linha continua corresponde aos 

resultados de validação da rede. O erro relativo percentual apresentado na etapa de 

validação entre os resultados da rede e do modelo foi inferior a 0,3% em todos os pontos 

tanto nas variáveis controladas quanto nas associadas do processo. 

A boa concordância entre os valores de treinamento e de validação observada em 

todos os gráficos das Figuras 4.1 a 4.4 é um indicativo de que a rede neural na configuração 

escolhida, arquitetura 8x15x4, representa bem o modelo fenomenológico. Durante o 

processo de identificação, ficou evidente que as redes neurais com arquiteturas formadas 

por um número de nós na camada intermediária superior a 15, como por exemplo a rede 

com arquitetura 8x20x4, também poderia representar o processo de FCC, mas além de 

apresentar um tempo de processamento de CPU mais elevado, os resultados obtidos não 

apresentaram nenhuma melbora significativa que justificassem o uso desta configuração. 

:2 i -manipulada TFP I (J245 1= I manipulada RAI I .2. 
I fr: 2«1 ~Z25 .... 

%"-'" ~ 
m ~= 
1! • 

" 1!"" ~· r-1ii 
~zz; 

o 
f!!210 ~ 

e • c. 
!2al ~"" • 
~ 215 " il200 -• ~ .... 

o 2000 4000 6000 """ 
&gt; 

' ""' """' OlOO """ Tempo (rrin.) Tempo (min.) 
-F1gura 4.5 Degraus unpostos nas vanáve1s mampuladas: Temperatura da Alimentaçao do Reator, 1FP 

(esquerda), e Vazão de AI para o Regenerador, RAI (direita), nas etapas de treinamento e 
validação da rede neural, na configuração 8xl5x4 (vide Tabela 4.2). 



76 

Os gráficos da Figura 4.5 mostram as variações impostas às variáveis 

temperatura da carga - TFP e vazão de ar - RAI; 6 degraus na variável TFP, e, 

posteriormente, 6 degraus na variável RAI, de forma a abranger toda a faixa de variação 

permitida pelas restrições do modelo fenomenológico para estas variáveis, ou seja, de 

215°C a 245°C, e de 20lkNm3/h a 23lkNm3/h, respectivamente. 

440 I manipulada RTF I 0,95 I I :2 I 
-manipulada CTCV ... 430 

§. 
~ 0,90 r 

"- 420 ~ 
ti ~-o 

410 
.g e 

~ ~f 0,85 L_ w -~ 400 S.c o B.S. 
e ~&gt; 
1l. 390 ~ ~ O,SO 
~ 

1 
'1110 

!;!'380 m ' 
m &gt;.g 

1 
u 

-8 370 
!! 0,75 
• o ~ 

'lil • ,.., "' ~ l! 0,70 
o 2000 4000 6000 8000 o """ 4000 6000 0000 Tempo (min.) Tempo (min.) 

.. -Ftgwa 4.6 Degraus rmpostos na vanavel marupulada: Vazao de Alimentação do Reator, RTF (esquerda) e 
Vazão de Catalisador Regenerado, CTCV (direita), nas etapas de treinamento e validação da rede 
neural na configuração 8xl5x4 (vide Tabela 4.2). 

Os gráficos da Figura 4.6 mostram as variações impostas às variáveis vazão de 

carga - RTF e abertura da válvula de catalisador regenerado - CTCV; foram aplicados 6 

degraus na variável RTF e posteriormente 7 degraus na variável CTCV, abrangendo toda a 

faixa de controle adotada, de 363m3/h a 416,7m31h, para a variável RTF, e de 0,72 a 0,92 

para a variável CTCV. Foi a partir desses degraus nas variáveis manipuladas que as 

respostas nas variáveis controladas TRGI, TRG2, SEV e TRX (Figuras 4.1 a 4.4) puderam 

ser obtidas. 

Os gráficos das Figuras 4.7 e 4.8 mostram uma comparação em forma de dispersão 

entre os resultados obtidos utilizando o modelo fenomenológico (também chamado aqui de 

modelo rigoroso) e os resultados obtidos utilizando a configuração escolhida da rede neural 

8x15x4, utilizando outro grupo de dados (padrões de teste), diferentes das seqüências de 

treinamento e de validação (vide Tabela 4.3). O objetivo da utilização de um conjunto de 

dados para teste contendo seqüência de degraus diferentes da seqüência de treinamento e 

validação é verificar a capacidade de generalização da rede (BAUGHMAN &amp;amp; LIU, 1995). 



77 

Como os valores obtidos pelo simulador são não ruidosos e é sabido que a 

unidade industrial apresenta freqüentemente característica bastante ruidosa em seus sinais, 

foi proposta a inserção de um ruído na tentativa de simular de forma mais real os sinais 

provenientes da unidade. O ruído foi distribuído de forma aleatória, apresentando 

intensidade máxima de 1%, com freqüência também aleatória nas variáveis controladas 

proveniente do modelo fenomenológico. Os resultados obtidos dessa simulação são 

mostrados nos gráficos das Figuras 4. 7 e 4.8 a seguir . 

.g ~ 680 ICQmparaçao entre os resultados 
~ i Lo Dispersao 
c c 
e • 
~'i 675 

~~ 
ê ::- 670 
~~ 
!'":" 
-; .!2 665 
-,_g&gt; 
!:ti 
" e -o 

~ ·~ ""' 
~;:: 
~ ~ ~~------r-----~----~-----, 

660 665 670 Q15 eao 
Temperatura da fase densa do regenerador 

primeiro estágio~ TRG1 (oC) modelo fenomenológico 

710 Comparação entre os resultados 
o Dispersao 

~~--------,-----.---------~1 685 690 695 700 705 710 
Temperatura da fase densa do regenerador 

segundo estágio - TRG2 (oC) modelo fenomenológico 

Figura 4.7 Comparação entre os resultados obtidos da variável TRGI (esquerda) e TRG2 (direita), pelo 
modelo em redes neurais com núdo e os resultados obtidos pelo modelo rigoroso, aplicando 
degraus nas variáveis TFP, RAI, RTF e CTCV, conforme Tabela 4.3, configuração 2. 

Conforme pode ser observado nos gráficos da Figura 4.7, que representam as 

temperaturas das fases densas do regenerador, as respostas entre modelo rigoroso, valores 

das abcissas, e simulação em rede neural, valores das ordenadas, foram praticamente 

coincidentes (a reta traçada a partir da bissetriz representa valores iguais da abcissa e da 

ordenada). O erro relativo percentual entre os valores da rede e os valores do modelo 

rigoroso com ruído foi inferior a 0,1% para todos os pontos do gráfico. 



78 

~ 
;; 
1ã n,s 
o 
o 
~ 
~m i 
~ "' .a, 
~ -
~~ I 
~ ! ~ 78,0 78,5 ,....... 538 540 542 544 546 
Severtdade da reação catalítica (%)modelo fenomenológico Temperatura do riser- TRX (oC) modelo fenomenológíoc 

Figura 4.8 Comparação entre os resultados obtidos da variável severidade da reação catalitica (esquerda) e 
TRX (direita), pelo modelo em redes neurais com ruído e pelo modelo rigoroso, com os degraus 
impostos nas variáveis TFP, RAI, RTF e CTCV (vide Tabela 4.3, configuração 2). 

Os gráficos da Figura 4.8, apesar de apresentarem maior dispersão se comparados 

com os gráficos da Figura 4.7, representaram erro relativo máximo inferior a 0,7% para 

variável severidade da reação catalítica (SE V) (esquerda) e inferior a 0,3% para a variável 

temperatura do Riser (TRX) (direita). Portanto, baseado nestes resultados, o modelo 

desenvolvido em RNA atende perfeitamente ao propósito de representar a unidade FCC 

num controle preditivo, apresentando boa capacidade de generalização e robustez. 

4.2 Controlador Preditivo usando as RNA como modelo interno 

Uma vez escolhido o modelo em redes neurais que será usado para representar o 

processo de FCC, foi desenvolvido um controlador preditivo multivariável para o controle 

desta unidade, utilizando como modelo interno a rede neural na configuração escolhida. 

Convém observar que mesmo a rede sendo treinada considerando a ação de 

degraus em cada variável manipulada individualmente conforme definido na estratégia de 

identificação, o controlador proposto, utilizando a técnica de minimização de uma função 

objetivo para um sistema multivariável, prevê a atuação do controlador em todas as 

variáveis manipuladas simultaneamente. Isto representa um procedimento ainda não 

aplicado em RNA para controle multivariável conforme constatado na literatura, e portanto 

caracteriza uma ação de controle inédita. 

A ação do controlador desenvolvido pode ser realizada juntamente com estratégias 

de otimização da planta. Estas estratégias podem ser selecionadas por ação externa, onde se 



79 

detennina qual variável será manipulada alterando os limites de restrição para aquela 

variável. Dentre as estratégias para o caso em questão que apresenta interesse, pode ser 

citada a otimização da produção, alterando os limites de restrição da variável vazão de 

carga - RTF, adequado quando há necessidade de maximizar ou rrúnimizar a produção da 

unidade. Observou-se que a ação do controlador sobre esta variável, pode resultar numa 

estratégia não adequada aos interesses da refinaria como por exemplo, pode resultar em 

redução ou aumento não adequado de produção. Realmente, apesar de terem sido 

escolhidas 4 variáveis para serem usadas como variáveis manipuladas, na verdade a 

variável RTF, não deveria à princípio ser considerada como variável manipulada pois sua 

estratégia é definida normalmente por fatores externos à unidade de FCC (MORO, 1992). 

No entanto, ela é fundamental para otimização da planta quando se busca como objetivo a 

maximização de produção. 

Outra estratégia também útil corresponde à otimização da ação de controle sobre a 

temperatura da carga, variável TFP. Caso haja alguma limitação no fomo de carga o 

controlador pode limitar a faixa de ação nesta variável. Esta estratégia de ação do 

controlador pode ser estendida também para quaisquer outras variáveis manipuladas ou 

para as controladas (com algumas ressalvas), apenas alterando seus limites de restrição. 

Com relação às variáveis controladas, uma estratégia normalmente utilizada nas refinarias é 

a de se alterar o objetivo da unidade, passando a produzir mais GLP ao invés de Nafta, e 

isto pode ser feito alterando-se o valor de referência da variável TRX. 

O mesmo programa do modelo fenomenológico usado para gerar os dados de 

treinamento (MORO, 1992) foi usado para simular a unidade industrial. A rotina do 

controlador foi inserida como uma subrotina no programa do modelo fenomenológico e as 

rotinas de entrada e saída de dados para impressão existentes no modelo foram aproveitadas 

para apresentação de resultados. Na simulação, a partir do modelo fenomenológico, foram 

obtidos os dados das variáveis controladas e manipuladas que são as entradas para o 

controle. De posse desses dados é chamada a rotina de otimização onde é feita a predição 

das ações de controle, utilizando a rede neural para prever a resposta dessas ações nas 

variáveis controladas em todo horizonte de predição. Os resultados dessas predições 

resultam nas ações do controlador, em todo horizonte de controle. Selecionadas as ações 

que minimizam as diferenças entre as trajetórias de referência e as variáveis controladas no 

horizonte de controle, a primeira ação de controle nas variáveis manipuladas é então 



80 

enviada de volta ao programa do modelo fenomenológico gerando os dados de 

impressão de resultados; então o ciclo se repete. 

Como teste do controlador utilizando redes neurais como modelo interno, foram 

simulados 1000 minutos de operação, com ação do controlador à partir do minuto 100 

sendo inserido uma perturbação após 400 minutos. 

O simulador (programa do modelo fenomenológico) se inicia em uma condição 

fora do estado estacionário, denominada de condição inicial de operação; portanto, após 

início da ação de controle, ou seja, após o instante 100 minutos, o controlador inicia uma 

tentativa de levar as variáveis controladas para o seus valores de referência. Isto justifica a 

alteração observada em alguns dos gráficos no intervalo entre 1 00 e 400 minutos, instante 

da perturbação. 

Os degraus impostos nas variáveis escolhidas para perturbação apresentaram 

algumas limitações devido ao próprio modelo fenomenológico, que tiveram seus degraus 

limitados a valores bastante conservativos (MORO, 1992; MORO &amp;amp; ODLOAK, 1995). 

Algumas dificuldades foram encontradas nos testes realizados conforme reportado 

a seguir: 

• dificuldades na freqüência de amostragem do controlador: este dado representa a 

freqüência de chamada da rotina de controle. As freqüências de 1 em 1 minuto, de 2 em 

2 minutos, de 4 em 4 minutos, de 5 em 5 minutos, de 6 em 6 minutos, de 8 em 8 

minutos e de 1 O em 1 O minutos foram testados em todas as simulações, sendo 

observado que acima da freqüência de 6 minutos as respostas não eram satisfatórias 

para nenhuma situação. Utilizando um tempo de 1 em 1 minuto, mesma freqüência de 

amostragem utilizada na simulação pelo modelo fenomenológico, as respostas do 

controlador apresentaram oscilações crescentes, divergindo e interrompendo a 

simulação. Foi tentado corrigir este comportamento alterando os ajustes do controlador, 

mas sem muito sucesso. A freqüência de 2 em 2 minutos também apresentou 

oscilações, mas em menor intensidade. As freqüências de amostragem que se 

apresentaram mais satisfatórias para o controlador foram de 4 em 4 minutos, de 5 em 5 

minutos e de 6 em 6 minutos; 

• dificuldades no horizonte de predição: foram testados diversos valores de Np (Np = 1, 

2, 4, 5, 10, 12, 15, 18 e 20), sendo escolhidos apenas aqueles que apresentaram 



81 

resultados significativos. Dentre as dificuldades encontradas no ajuste dessa variável, 

duas se destacaram: primeiro, foram observadas oscilações utilizando um valor de 

Np = 1, sendo que neste caso, só era possível concluir a simulação (até I 000 minutos), 

reduzindo muito o valor do degrau na variável perturbação, o que não representa uma 

alternativa satisfatória. A segunda dificuldade foi a tentativa de elevar o valor de Np 

para valores acima de 1, mantendo os mesmos ajustes do controlador. Observou-se que 

após cada alteração neste horizonte foi necessário alterar todos os demais parâmetros do 

controlador, como À;, a;, freqüência de amostragem, filtros e perturbações impostas. 

Provou-se que Np é extremamente sensível a variações da freqüência de amostragem. O 

máximo obtido para este horizonte foi de 20 amostragens considerando uma freqüência 

de 5 em 5 minutos, o que representa uma previsão de 100 minutos; ainda assim, nem 

todos os testes apresentaram resultados satisfatórios para este horizonte. Valores muito 

baixo apresentaram oscilações nas respostas do controlador. Os valores de Np que 

apresentaram melhores resultados foram 10, 12, 15 e 20 amostragens; 

• dificuldades no ajuste da variável fdtro: esta variável determina as trajetórias de 

referência das variáveis controladas. Os valores testados foram: 0,80, 0,90, 0,95, e 0,97; 

observou-se que estas variações exerciam alguma influência nos resultados do 

controlador. Procurou-se manter o mesmo valor de filtro para todas as variáveis 

controladas em cada teste, sendo os valores 0,90 e 0,97 os que apresentaram melhores 

resultados para a maioria das situações testadas; 

• dificuldades nos valores de ajuste de 2; e a; no controlador: essas variáveis, À; e a;, 

correspondem ás punições aplicadas às variáveis manipuladas e controladas. Foi 

tentado, mas sem sucesso, implementar um mesmo ajuste para estas variáveis em todos 

os testes de perturbação efetuados. Os valores utilizados em cada situação estão 

reportados juntos aos dados dos testes, nas seções seguintes; 

• dificuldades no horizonte de controle: para esta variável, Nc, a dificuldade encontrada 

foi na tentativa de elevar este valor de 1 para 2, uma vez que a rotina utilizada para 

Nc = 2 é bastante diferente daquela utilizada para Nc = 1. Entretanto, para valores de 

horizonte de controle superiores a 2, em virtude da dificuldade de ajuste do controlador 

para estes casos, não foi possível concluir a simulação de 1000 minutos para nenhum 

valor de perturbação nos testes realizados. 



82 

4.2.1 Comportamento do modelo fenomenológico em malha aberta 

As mesmas perturbações propostas para os testes do controlador foram impostas 

ao modelo em malha aberta, utilizando o programa do modelo fenomenológico. Com isto, 

espera-se conseguir realizar uma comparação entre os resultados com e sem a ação do 

controlador. Estes resultados obtidos em malha aberta foram inseridos juntos aos resultados 

obtidos com ação do controlador na forma gráfica utilizando urna linha tracejada (vide 

gráficos das Figuras 4.9 a 4.11, 4.14, 4.15, 4.18, 4.19, e 4.26 a 4.29). 

4.2.2 Resposta utilizando DMC (Dynamic Matrix Control) 

Os resultados obtidos do controle DMC utilizando modelo de convolução 

(MORO, 1992) foram inseridos ao lado dos resultados do controlador utilizando modelo 

interno em redes neurais, em um dos teste realizados. Tal procedimento teve como objetivo 

efetuar uma comparação entre estes controladores, avaliando principalmente o tempo de 

resposta e a amplitude das mesmas nas variáveis controladas. Este teste foi efetuado 

simulando as mesmas condições da literatura, sendo as figuras ali existentes transferidas 

por meio de uma fotocopiadora; portanto, sua resolução ficou ligeiramente prejudicada. 

A estratégia de otimização proposta por MORO (1992) e reproduzida aqui, foi a de 

maximizar a severidade da reação. As condições da perturbação utilizando este modelo são 

mostradas na Tabela 4.6. Os gráficos das Figuras 4.26 a 4.29 representam as respostas 

obtidas por Moro no teste de maximização da severidade. 

Tabela 4.6 Dados referentes às condições operacionais do controle preditivo DMC utilizando um modelo de 
convolução (MORO,l992). 

vazão de ar&amp;lt;240k.Nm Ih 
Variáveis manipuladas abertura da válvula de catalisador regenerado &amp;lt;90"/o 

383,3m3!h&amp;lt;vazão de carga&amp;lt;416,7m3!h 
temperatura da carga &gt; 219°C 
650°C&amp;lt;temperatura das fases densas do regenerador, I o e 2° estágios &amp;lt;720°C 

Variáveis controladas 70% &amp;lt;Severidade da reação catalítica &amp;lt;85% 
535°C&amp;lt;temperatura da reação &amp;lt;545°C 
variação na tempen~tura de reação &amp;lt;I °C/min 
período de execução do algoritmo = lmin. 
horizonte de controle - lmin. 

Parâmetros de controle horizonte de predição - 12min. 

fatores de supressão nas variáveis manipuladas: À. = 3, O para todas as variáveis 
fatores de igual importância nas variáveis controladas: a1=2; a2=2; as=l; a,-1 

Estratégia de otimização perturbação na variável SETPDCV, alterando de 0,65kgf/cm
2 

para O, 70kgl)'cm2 



83 

4.2.3 Testes de desempenho do controlador proposto 

É proposto realizar testes de desempenho no controlador utilizando as Redes 

Neurais como modelo interno efetuando degraus em algumas variáveis denominadas de 

variáveis perturbação de forma a obter as respostas a estas perturbações considerando o 

sistema aberto e o sistema com controle. 

Para o teste de um problema regulador é proposto aplicar um degrau na variável 

Temperatura do Ar para o Regenerador, variável TAl (vide equação D.14, ANEXO D), 

alterando seu valor em +8%. Um segundo teste foi realizado considerando como 

perturbação o Diferencial de Pressão entre o Regenerador e o Reator, variável SETPDCV; 

esta variável não pertencente diretamente ao controle proposto, mas apresenta uma malha 

de controle independente. O valor de referência foi alterado de 0,65kgfi'cm2 para 

O, 70kgfi'cm2 ; esta perturbação é considerada critica para operação da unidade devido a 

elevada amplitude do degrau imposto. Um terceiro teste foi realizado, propondo avaliar o 

desempenho do controlador a partir de urna suposta alteração da qualidade da carga, 

representada neste caso por urna simulação de mudança na tendência da carga à formação 

de coque, alterando a Constante de Reação, variável KCC (vide Equação D.12, ANEXO 

D), em +10%. Um quarto teste foi efetuado propondo alteração da estratégia de operação 

que é feita simulando a produção de mais GLP ao invés de Nafta, alterando o valor de 

referência da variável SETSEV em +0,77% e SETTRX em +0,51%. Com objetivo de 

realizar uma comparação entre o DMC desenvolvido por MORO (1992) e o controlador 

proposto foi efetuado um teste simulando as mesmas variações propostas no estudo de 

Moro. Nas seções que se seguem estão apresentados os detalhes dos testes efetuados, e os 

gráficos obtidos como respostas. 

4.2.3.1 Problema regulador 

Para o teste de controle regulador, foi considerado como variável de perturbação a 

Temperatura do Ar para o Regenerador, variável TAl. Esta variável apresenta um valor 

inicial de 190°C e o valor da perturbação foi de +8%, ou seja, + 15,2°C. Foi considerado 

amostragem de 4,0 em 4,0 minutos, com um horizonte de predição, Np, igual a 10 instantes 

de amostragem e um horizonte de controle, Nc, igual a 1. Os fatores de ponderação nas 

ações de controle, representados por A.,, que restringem as ações nas variáveis manipuladas 



84 

foram: l,Oe-3 para TFP, 3,0e-4 para RAI, 6,0e-4 para RTF, e S,Oe-2 para CTCV; e os 

fatores de igual importância, representados por a;, que controlam a relevância de cada 

variável controlada, foram: l,Oe-3 para TRG1, l,Oe-5 para TRG2, l,Oe-4 para SEV e S,Oe-3 

para TRX. O filtro utilizado para o cálculo da trajetória de referência foi único, de 9,0e-l, 

para todas as variáveis e a estratégia de otimização considerada para o teste foi a de manter 

fixa a Vazão de Carga da unidade, variável RTF. Com isto, o programa de controle 

procurou manter as variáveis controladas dentro de uma faixa estreita de variação alterando 

todas as demais variáveis manipuladas, RAI, CTCV e TFP. 

Os gráficos das Figuras 4.9 a 4.11 mostram as respostas à perturbação degrau de 

+15,2°C na variável TAl; estas respostas são apresentadas em forma comparativa entre 

sistema em malha aberta (linha tracejada) e com atuação do controlador (linha cheia). O 

inicio da ação de controle e o inicio da perturbação são destacados nesses gráficos. 

i'J!do da ação Inicio da 

de~ c~ 
Compamção entre as respostas; 
síslema at:ertD e com controle 
-Sistema com c:onl!ole 
· · · · · · Sistema aberto 

r 1 

+~~~~~r----
1. 

o 100 3Xl 300 400 soo eoo 100 aoo aoo 1(0) 
Tempo (m!n.) 

707 

.g_ 
§ '5 700 .,_ 
jlN 
.gá1"' 
ml-
0 ' c ~ 704 e.g 
., E 

lnicio da ação 

"'"""""" 
) 

inicioda i ~entreasrespostas; 
perturbação ! sist:en'B aberto e com con1m1e: 

(IL _-------=··=.,. __ ""_::;_;;:-__ __jl 
I' . 

lJl e 700 
.f!~ v -8~702 ~ 
~.g 
]! .2 701 &amp;amp;E i-+--=·-:::·-.. "·-·-·-··-- ----------.. --·----- ---
E 11) setpoint 
~ Cil 700-h-+ ........ --,-.+...--,--,-.-,--,--.--,-..--, 

o 100 200 300 400 500 600 700 800 900 1000 
Tempo (nin,) 

Figura 4.9 Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto (linha 
tracejada). Variáveis contrOladas: Temperatnras das Fases Densas do Regenerador, primeiro 
estágio, TRGI (esqnerda) e segnndo estágio, TRG2 (direita). Pertnrbação: TemperatnradoArpara 
o Regenerador, T AI variação +8%. 

Os gráficos da Figura 4.9 correspondem as respostas nas variáveis TRGl e TRG2. 

Conforme era esperado, a elevação de TAl implicou em uma elevação imediata de ambas 

as temperaturas, resultando na elevação da temperatura do catalisador regenerado que por 

sua vez elevou também a temperatura do reator e a severidade da reação. Estes aumentos 

foram corrigidos simultaneamente por ação do controlador que reduziu gradualmente a 

vazão de ar, a abertura da válvula de catalisador regenerado e a temperatura da carga. A 



85 

vazão de carga foi mantida fixa na mesma faixa operacional que estava antes de ocorrer 

a perturbação, conforme foi definido pela ação do otimizador (vide Figura 4.13) 

?S.2 inicio da açao 
do controle 

~ 78,1 j 
-~ 7$.0 
= .. 
1l 77fJ 
o 
~ 771. 
~ 
ai 77,7 

~ l 

lnicío da _ .. , 
c """""''"""' I ·!-.. -cc.-:o .. CC ••• CC •• CC ••• CC •• CC ••• CC •• CC ••• CC. ·--· •• ----' 

Com~ entre as respostas: 
sistema aberto e com controle 
- Sislema com cortro1e 

············;.;-···~·· ---i 77,6 -·--·--·r '!! 
§: 77,5i-+--~­
Jl 

77.&lt;+.....-i--........ -,-....-+-........ -.,.....,--,......-,-....., 
o 100 200 300 400 soo eoo 100 BIXl 9Xl 1cm 

TerT4» (rrin.) 

"'·' 
5&lt;5,5 

~ 5&lt;5,0 
g "'·' 

COmparação entre as respost;S: 
sistema aberto e com controle 
-Sistema com controle 
- · · · · · Sistema aberto 

o 100 200 300 400 soo eoo 100 eoo eoo 1000 
TerT4» (rrin.) 

Figura 4.1 O Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto (linha 
tracejada). Variáveis controladas: Severidade da Reação Catalítica, SEV (esquerda) e 
Temperatura de Saída do Riser, TRX (direita). Perturbação: Temperatura do AI para o 
Regenerador, TAI variação +8%. 

As variáveis TRG2 e TRX, conforme se observa nos gráficos da direita nas 

Figuras 4.9 e 4.10, se apresentaram um pouco acima dos seus valores de referência. Na 

variável TRG2, isto é justificado devido à relação entre a vazão de ar entre os dois estágios 

do regenerador ser fixa, não sendo possível controlar uma variável independente da outra, 

conforme já dito; na variável TRX observa-se também uma dependência entre esta variável 

e a severidade da reação catalítica, claramente visto na expressão de cálculo da severidade 

que é função da variável TRX (vide equações D.6 e D.6a no ANEXO D). Apesar disto, 

como a amplitude dessas variações foi muito pequena, mantendo-se próximo do valor de 

referência, estes resultados foram considerados muito bons. 

Na Figura 4.11 são mostrados os gráficos das variáveis associadas, Temperatura 

de Saída da Fase Diluída do segundo estágio do Regenerador, variável TD2 (esquerda), e 

Temperatura de Saída da Fase Diluída Geral, variável TDG (direita). Estas variáveis foram 

mantidas dentro da faixa de controle, conforme observado na Figura 4.11, em função da 

ação do controlador nas temperaturas dos leitos densos. Nestes gráficos é possível também 

observar como seria o comportamento destas variáveis sem ação de controle (linhas 

tracejadas, Figura 4.11 ). 



86 

&lt;JE 
:!l 1:j "" 
~ 1-

! l" 
~ -

t t: 1=;:~ 11:::;::;:;:;::;=·::·-~l[l_.·_:::·-~-~:· ·_·--,_-_-_:-----~-_-._-_-_-_-~-
~~ I --~a~- g a-·-
1- $ Tempo {mín.) 

ns in!do da ação inicio da 
perb.Jrba~ 

--*C- rtmite mã&gt;:irno 
COmpa!aÇao entre as respostas: 
sistema aberto e com controle 
-Sistema com controle 
· · · · · · Sistema aberto 

100 200 300&amp;lt;400 500 &amp;amp;XI 700 soo 000 1000 
Tempo (min.) 

Figura 4.11 Problema Regulador. Resultados com ação do controlador (linha cheia), sistema aberto (linha 
tracejada). Variáveis associadas: Temperatura da Fase Diluída do segundo estágio do 
Regenerador- TD2 (esquerda) e Temperatura de Saída Geral do Regenerador- TDG (direita). 
Perturbação: Temperatura do Ar para o Regenerador, T AI variação +8%. 

Nos gráficos seguintes, Figuras 4. 12 e 4.13, são apresentadas as ações nas 

variáveis manipuladas obtidas pelo controlador. No gráfico correspondente á Vazão de 

Carga, variável RTF (Figura 4.13 esquerda), é perfeitamente visível a estratégia proposta 

pelo otimizador de manter fixa esta variável no seu valor inicial (representando uma reta 

horizontal no valor 404,2Nm3/h). 

~ 224 
inicio cta açao I Variável manipulada I ~ infcioda 

i de col"'lrn!e perturtraçao --RAI 
~ "' ç .g 222 
~ 

I 
&gt; 
~ 
o 

~ 
c 

221 ~ 

~ 
o 
~"" 

I 

• Q. 
~ 
~ "' 1./ ., 
o 
~ 

"' ~ I ... 200 "' ... ""' 600 700 .., .,. •ooo o,s1o+--l--~-.,.--i--:r-,---,.-.,.,--,.-.-. O 100 AIO 300 400 500 8XI 700 800 9CIJ 11XXl Tempo (min.) Tempo (min.) 
Figura 4.12 Problema Regulador. Resultados das ações do controlador nas variáveis mauípuladas RAIe 

CTCV, assumindo como estratégia de otimização manter a variável RTF fixa. Perturbação: 
Temperatura do Ar para o Regenerador, T AI variação +8%. 



406,0 
inicio da a;:ão 
de controle 

) 
I 

inicio da --
236,5 

inidodaação inidoda 
~ de controle perturbação 
~ 2360 ) c 
.fi. 235.5 

J23s.o+--f---~/ 
~ 

{!I 234,5 
e 
;; 
~ 234,0 
E 

Variável manipulada 
-TFP 

87 

~ ns.s+--.J.--,---.---,-4-.,--.-,--.-,--,-,...,----, 
o 100 200 300 400 500 600 700 800 900 1000 

Tempo (min.) Tempo {min.) 

Figura 4.13 Problema Regulador. Resultados das ações do controlador nas variáveis manipuladas RTF e 
TFP, assumindo como estratégia de controle manter a variável RTF fixa. Perturbação: 
Temperatura do Ar para o Regenerador, T AI variação +8%. 

4.2.3.2 Problema regulador para uma perturbação agressiva 

Num segundo teste, na tentativa de verificar o desempenho do controlador em 

condições mais severas, foi dado uma perturbação no valor de referência do Diferencial de 

Pressão entre o Regenerador e o Reator, variável SETPDCV. Uma alteração nesta variável 

afeta diretamente a vazão de catalisador para o Riser, numa intensidade dificil de ser 

quantificada. Uma perturbação degrau foi feita alterando de 0,65 kg:flcm2 para O, 70 kg:flcm2 

nesta variável, correspondendo a 7,7% de variação. Também foi realizada neste teste a 

inserção de um ruído de intensidade 1,5% nos sinais fornecidos pelo programa 

fenomenológico, que aqui representa a unidade industrial, antes da chamada da rotina do 

programa de controle. Conforme foi dito na etapa de treinamento (CAPÍTULO ill), o 

objetivo do ruído aqui foi também o de avaliar o desempenho do controlador em uma 

situação que representasse de forma mais real as condições da unidade industrial, para que 

pudesse ser testada a robustez do modelo. 

Os fatores de ponderação para este teste nas variáveis manipuladas, À;, foram: 

I,Oe-3 para TFP, 3,0e-4 para RAI, 6,0e-4 para RTF, e 5,0e-2 para CTCV; e os fatores de 

igual importância, ai, para as variáveis controladas, foram: l,Oe-3 para TRGI, l,Oe-5 para 

TRG2, l,Oe-4 para SEV e 5,0e-3 para TRX. O filtro utilizado para o cálculo da trajetória de 

referência foi único, de 9,0e-l para todas as variáveis e a estratégia de otimização 

considerada para o teste foi novamente a de manter fixa a vazão de carga da unidade. O 

intervalo de amostragem foi de 4,0 em 4,0 minutos e os horizontes considerados foram 



88 

Np = 10 e Nc = 1. Procurou-se manter os mesmos ajustes do controlador obtidos no teste 

anterior, conforme se pode observar, mesmo sabendo a priori que isto poderia ser 

prejudicial ao seu desempenho. 

Os gráficos das Figuras 4.14 e 4.15 a seguir apresentam as respostas à perturbação 

na variável SETPDCV com a inserção de ruído nos sinais das variáveis controladas, e nos 

gráficos das Figuras 4.16 e 4.17 são mostrados os degraus fornecidos pelo controlador. 

... Q::rrpara;ão entre as resçostas: 
I 

715 Corrparação entre as respostas. _g_ inicio ela ação lricio da ln'1cio da ação início da 
e O "" i sislerra aberto e cem o:::ntroJe ~ 6no 

.,_ -- sistema aberto e CXliTI controle de""""" -- -Sistema can conl:rde _E.g. I _,..,.., """- "\ r-ls.- cJ I •.•... Sisten'a aberto I .. ~ ....•. Sistema aberto .g &amp;amp;1 676 $N \.,.! I ml- Setpcint _f'&gt;,_ .g ~ 7&lt;)5 _J ·f=--w ' 672 c~ ........... .. ···~ v m ' .. ·-· -- -------.g .g 668 ê ... 700 .g~ setpoint e E w e 
.! c 664 :: $ ~"" 
.g!&gt; 

I 
J!!e 

-····· ... ... 
.... {lg' e ~ 600 .. , ... !! ;; S90 

I 

. ...... ······· .. .a-o ... .. ~.., .. 
~ ·&amp;amp; 656 I ~-2 c.:s 

i 
X.~ 685 

~ = 652 ~i 6&amp;amp;J ·. 
.. 

o 100 ""' 300 """ ""' 600 700 800 "" 1000 o 100 ""' ""' """ 500 600 700 800 ""' 1000 T""l'l (nin.) Tempo (min.) 

Figura 4. 14 Resultados obtidos da ação do controlador (linha cheia) e os resultados do 
sistema aberto (linha tracejada). Variáveis controladas: Temperatura da Fase 
Densa do primeiro estágio do Regenerador, TRG1 (esquerda) e Temperatura da 
Fase Densa do segundo estágio do Regenerador, TRG2 (direita). Perturbação: 
variável SETPDCVintensidade de +7,7%. 

S3 
inicioda I Comparação entre as respostas: I =~I ~entre as TeSJXlSI:a$: início da ação 6'558 inicio da ação de controle G~o~ sistema aberto e com controle ~ 

.. _ 
Sistema aberto e com amtro1e 

l 82 ) 
-Sistema com controle 

I 
&gt;&lt;556 

r c I 
-Sistema oom controle 

~ 
· · - · · - Sistema aberto "' I 

.. ... Sistema aberto 
1- 554 

81 ······· ·---- ---··· .. ]i 

I 
I· 

... 
~ 

/; 
-···· .. .. .. 552 .. . .. 

B ~ .• 
o 80 1: ·. .. .g 550 

'B. I i :!! : "' 548 e 79 I 11 i 
"' 

I 
.. .., .. 546 .. 78 

.etpan1 '7'= .., .., I 544 -··-·--····---T~ &amp;amp;!;ti~· ....... "' -·- i- . ~-, ......... 1· ·-·· .... ·-····· . ... -:g 542 !!! 77 .. 
íJl ~540 

76 {!. 
o 100 200 300 400 500 600 700 800 900 1000 o 100 200 300 400 500 600 700 800 900 1000 

Tempo (min.) Tempo (min.) 

Figura 4.15 Resultados obtidos da ação do controlador (linha cheia) e os resultados do Sistema aberto (linha 
tracejada). Variáveis controladas: Severidade da Reação Catalitica (esquerda) e Temperatura de 
Saída do Ri ser, TRX (direita). Perttubação: variável SETPDCV intensidade de + 7, 7%. 

I 
I 



s 
~232 
ê 
i!l.228 
E! 
o 

início da ação 
deoontrole 

I) 
inicio da êi I ~~anipulada I 

~Z24 
:. ""LJ---------r 
" ., o 

"'&gt;st z1s+0~+-.-... ~+-,---.-~-,-~,--,--.-~..., 100 200 300 400 500 $XI 700 800 900 1COO 
Tempo (min.) 

o 

início da ação .. """""'. inicio da --
89 

.J!!rtite ~.ÍJTII'_ -

I 
Variável rranlpu!ada 

. -crcv 

100 2Xl 300 400 500 600 700 oco 900 100J 

Tempo (min.) 

Figura 4.16 Ações do controlador nas variáveis manipuladas, RAI e CTCV, assumindo como otimização 
manter a variável RTF fixa. Resposta à perturbação degrau de +7,7% no Diferencial de Pressão 
entre o Regenerador e o Reator, variável SETPDCV. 

408 

407 
:2 
.~ 

E 
6406 
u. 
ti: 
' 405 .. 

início da ação início da 
perturbação 

Variável manipulada 
-RTF 

I? variável mantida fixa 
~ ~~-+--------~------~~~~~=---

" ., o 
~403 

100 200 soo 400 soo eoo 100 soo OOJ 1000 
Tempo (min.) 

ô 
-2-

244 

a. 240 
u. ,__ 
' 

inicio da ação 

'"7)~ 
início da 

êí~o 
Variável manipulada 
--TFP 

o236 
~ ~-+---------h 

"E Z32 ~ 
~ .. ,. ., 
f!! .a 224 
f!! 
" Q. EZ20 
~ 

o 

limite mínimo - ·--- , _____ .. _____ ,,_,- ,_,_ -· ---·- --- __ , ____ , _____ .. _____ ··--·------- ---- _____ ,_ 

100 200 300 400 500 600 700 800 900 1000 

TE!IJ"!'O (min.) 

Figura 4.17 Ações do controlador nas variáveis manipuladas, RTF e TFP, assumindo como otimização 
manter a variável RTF fixa. Resposta à perturbação degrau de + 7, 7% no Diferencial de Pressão 
entre o Regenerador e o Reator, variável SETPDCV. 

Conforme se pode observar a inserção de ruído com intensidade de 1,5% nas 

variáveis do processo não exerceu nenhuma influência visível no comportamento das 

variáveis manipuladas ou controladas, o que confirma a robustez do controlador preditivo 

utilizando modelo em RNA O comportamento oscilatório observado pode ter sido causado 

pela elevada agressividade da perturbação ou por questões relacionadas a dificuldade de 

ajuste do controlador. 

4.2.3.3 Mudança de qualidade da carga 

Uma situação considerada usual da unidade de FCC corresponde ao aumento da 

formação de coque devido a algum dístúrbio nas condíções de operação do reator ou 



90 

mesmo por alteração da qualidade da carga. Isto reflete diretamente na necessidade de se 

aumentar a temperatura do Regenerador. Este aumento resulta numa alteração da 

quantidade de catalisador em circulação, o que por sua vez altera também a temperatura do 

reator e a conversão. Desta forma, visando verificar a ação do controlador frente uma 

situação real dessa natureza, foi dado uma perturbação degrau na Constante de Reação de 

formação de coque usada pelo programa do modelo fenomenológico para determinar a taxa 

de formação de coque, variável KCC (ANEXO D). Como estratégia de controle, foi 

proposta a minimização de carga. Os fatores de ponderação para este teste nas variáveis 

manipuladas, À;, foram: l,Oe-3 para TFP, 3,0e-2 para RAI, 6,0e-4 para RTF, e 5,0e-2 para 

CTCV; e os fatores de igual importância, ai, para as variáveis controladas, foram: 1,0e-3 

para TRG1, 1,0e-5 para TRG2, l,Oe-4 para SEV e 5,0e-3 para TRX. O filtro utilizado para 

o cálculo da trajetória de referência foi único, de 9,7e-1 para todas as variáveis e a 

estratégia de otimização considerada para o teste foi a de minimizar a produção alterando a 

Vazão de Carga da unidade, variável RTF. O intervalo de amostragem foi de 4,0 em 4,0 

minutos e os horizontes considerados foram os mesmos do teste anterior Np = 1 O e Nc = 1. 

Os gráficos das Figuras 4.18 e 4.19 apresentam os resultados da ação do 

controlador frente à esta perturbação juntamente com a estratégia de redução de carga da 

unidade. Nesta simulação também foi inserido um ruído de 1,5% nos sinais das variáveis 

controladas. 

-qinicioda~ ,
1

, =:o~a:= 
- Sislema a:m ca!lrole 
. -- . -- Sslerna aberto 

! . .. .. .. - .... ... 

Setpoirt 

""' 1000 

715 

.g _ Comparação entre as respostas: 
§ ~ inicio da ação inícioda sistemaabertoecomcontrole 
~- de cootro1e perturbação -Sistema eom corrtrole 

I ;5 N 710 ~ (Í · ··· Sistemaaberlc 
.g ~ I ) 
~ ~ f./ (\ . .. .. .. . ... ... ..... -

H
705 

A ·· i! 100 -~-\/---- -~ t;:'- -- ~rn 
f! .2 
""' c.l!! 
E " t! ai 695+-4~.,..-.-,-..,.....,f-.--,--..--,-~.,--,--,-~.,--,---, 

o 100 200 300 400 500 600 700 800 900 100J 
Tempo (min.) 

Figura 4.18 Resultados obtidos do teste de smmlação de mudança de qualidade de carga, comparando SIStema 
aberto (linha tracejada) e controlador (linha cheia). Variáveis controladas: 1RG1 (esquerda) e 
1RG2 (direita). Perttubação: variável KCC, intensidade +10%, e inserção de ruído de 1,5% nas 
variáveis controladas. Estratégia de otimização: minimizar a produção. 



79,5 

inicio da ação 
de controle 

1\ 
I 

Comparação entre as respostas: 
inicio da 

sistema aberto e com controle 

pertuúrt&gt;.çãl·L_-_ -_s_""""' __ "'_m_"'_"""'_• _ _J . · · · · · · Sistema aberto 

set point 

100 200 300 400 500 600 700 800 000 1000 

Tempo (min.) 

91 

550 
! Comparação entre as respostas: I 

inidoda i ~=::::e I 
perturbaçãoj • • · • · · Sistema aberto 

inicio da ação 
~ 548 de controle 
1-, (.i ... ················ ·····~ 

Set point 

a • ~ ~ ~ ~ = ~ ~ -
Tempo (min.) 

Figura 4.19 Resultados obtidos do teste de simulação de mudança de qualidade de carga, comparando sistema 
aberto (linha tracejada) e controlador (linha cheia). Variáveis controladas: Severidade da Reação 
Catalitica, SEV (esquerda) e Temperatura de Saída doRiser, TRX (direita). Perturbação: variável 
KCC, intensidade +I 0%, e inserção de ruído de 1,5% nas variáveis controladas. Estratégia de 
otimização: minimizar a produção. 

Conforme pode ser observado nas Figuras 4.18 e 4 .19, com a redução da carga, 

houve imediato aumento da temperatura do reator e aumento da conversão, e como 

conseqüência, posterior aumento das temperaturas do Regenerador. O controlador reagiu 

reduzindo a circulação de catalisador, a Temperatura da Carga e a Vazão de Ar para o 

Regenerador (vide Figuras 4.20 e 4.21), trazendo as variáveis controladas para os seus 

valores de referência. Com a perturbação, no instante 400 minutos, houve imediato 

aumento da temperatura do reator e da severidade da reação catalitica e posterior aumento 

das temperaturas do regenerador. O controlador reagiu novamente reduzindo ainda mais a 

vazão de catalisador circulante e a temperatura da carga. Posteriormente reduziu a vazão de 

ar para o regenerador para reduzir as temperaturas do primeiro e segundo estágios. Esta 

ação conjunta causou reduções excessivas na conversão e temperatura do reator o que 

novamente acionou o controlador no sentido de ajustar a conversão elevando ligeiramente a 

circulação de catalisador regenerado e a temperatura da carga, o que corrigiu também as 

temperaturas do regenerador. A resposta do sistema aberto, sem ação do controlador, é 

mostrada na forma de uma linha tracejada. Os gráficos das Figuras 4.20 e 4.21 apresentam 

as ações do controlador para este teste. 



92 

{240 _ _, __________ ---·--------------·-··- ------- __ ,__, ___ ---- ---- ------~~~--~1!'9----- .. -· ------- . &gt; Q9J -··-·-·-·- - ·---·----···- __!irrite_ máxirm __ -(,.) ,__ 
inlciodaaç!o ' Va~ rranipulada ' infcio da açao inicio da 

I I 
(,.) inicio da I I&amp;lt;(236 de controle Variável manipulada . Q88 "'"'"""'" -- -cr01 a:: er- o ~ ' . --RAI "" - Ql36 Cí 'õ""' ~~Q "" " &gt; ~m ~~ Q84 

" e., "' ~"" ~Z24 .g I!! QS&gt; 1--
o 

~ 
.. " - Jllt: 1!!220 ]! .2l QOJ 

IV .. .. .. Q. o~ 
IV'-(õ 216 -8 Q78 "' o "" ... Q76 o 212 N 

'lll ~ 
~ o 100 200 ,., "" 5D €00 700 0::0 9JO 1000 o 100 200 ,., 400 5D em 700 ""' "" 1000 TefT1'0 (rrin.) T0fT1'0 (rrin.) 

-Figura 4.20 Resultados das açoes do controlador nas vanáveiS mampuladas RAIe CTCV, assunundo como 
estratégia de otimização minimizar a produção, como resposta à uma perturbação na variável 
KCC de intensidade+ 10%, com inserção de ruído de 1,5% nas variáveis controladas. 

408 início da ação 

"" de " :€'406 
~400 
~'"'­
"-
li'"" 

• 402 

~ 401 
1l400 
-8399 

t: 

minimização de carga 
Variável manipulada 
-RTF 

396 

~~-+~~~~+-~~r--.~~-r~ 
o 100 20Cl 300 400 m soo 100 80CI 900 1coo 

T0"1'0 (rrin.) 

240 
inicio da ação inicio da 

ô 
.E-239 
0.. 

1=238 . 
o 
~237 

J~ 
.. 235 
{'! 

~234 
i! 

de ntrole variável manipulada 
--TFP 

!::+-~--r~~~~.-~~~-r.-~~~ 
o ~ ~ w 400 ~ ~ 700 0::0 ~ -

T0"1'0 (rrin.) 

Figura 4.21 Resultados das ações do controlador nas variáveis manipuladas RTF e TFP, assumindo como 
estratégia de otimização minimizar a produção, como resposta à uma perturbação na variável 
KCC de intensidade+ 10%, com inserção de ruído de 1,5% nas variáveis controladas. 

Conforme se observa neste teste as ações de controle não foram afetadas com a 

presença de ruídos nos sinais das variáveis controladas, confirmando novamente a robustez 

das Redes Neurais Artificiais como modelo interno de um controlador preditivo. 

4.2.3.4 Problema servo-regulador 

Conforme informações obtidas, (ODLOAK3, 2001), a unidade de FCC 

freqüentemente precisa alterar a estratégia de produção para atender solicitações de 

3 Consulta pessoal ao Dr. Darci Odloak por ocasião da apresentação dos seminários do projeto RECOPE em 
Canela, RS, em nov. 2001. 



93 

mercado. Desta forma, foi proposto avaliar o desempenho do controlador frente a esta 

situação, considerando ainda uma perturbação degrau na variável Temperatura do Ar para o 

Regenerador, variável TAl, com intensidade de +8%. A inserção de um ruído de 

intensidade 1,5% nos sinaís das variáveis controladas também foi efetuada. Os gráficos das 

Figuras 4.22 e 4.23 apresentam os resultados obtidos desta simulação nas variáveis 

controladas. Como estratégia do otimizador foi maximizado o valor de referência da 

Temperatura de Saída do Riser, para atender à solicitação de produção de GLP. Foram 

simulados 800 minutos neste teste, sendo mantidos os mesmos valores de início de atuação 

do controlador e de perturbação dos testes anteriores. 

675 "" I - 1-- I TRG1 I ' I TRG2j 7(17 """"' -674 70S 
·º I 

·º "' _613 "'- 700 {\ :ep !e 
~- I .. N 704 e (;672 v 

o C&gt; 
I 

-c 
-~ 0: -------· 

~ 
c 0: 703 

E 
,_ ~ ,_ 

·c .:. 671 
.....,, 

~ :._ i ~ D. o ~ o 7a2 o -c o -c -c 
~""' 

-c e 701 
I!! I!! .. --·-·-··-·- 1- - --...... - ... -
! 

c 

~ 
c -rt .. .. 700 "' "' !:. !"" .. ! o D. o ... E -c E -c .. .. ,_ 

"" 
,_ 695 

o 100 ""' ""' 400 500 "" 700 800 o 100 ""' 3Xl 400 500 ""' 700 800 Tempo (min.) Tempo (min) 
- ., Figura 4.22 Resultados obtidos do teste de mudança de estrategia de produçao. Vanave1s controladas. TRGl 

(esquerda) e TRG2 (direita). Perturbação: variável TAI com intensidade de +8%, com inserção 
de ruído de 1,5% nas variáveis controladas. Estratégia de otimização: maximizar a produção de 
GLP. 

78,4 

~ 
78;2 

-~ 78,0 
~ 
.g_ n.s 

~ 
~ T/,6 

i 
J 

j-SEVERij 

--
o 100 ""' "" 400 "" 600 700 800 

Tempo (min.) 

Figura 4.23 Resultados obtidos do teste de mudança de estratégia de produção. Variáveis controladas: 
Severidade da Reação Catalitica (esquerda) e TRX (direita). Perturbação: degrau na variável TAI 
com intensidade de +8o/o, e inserção de ruído de 1,5% nas variáveis controladas. Estratégia de 
otimização: maximizar a produção de GLP. 



94 

Os gráficos das Figuras 4.24 e 4.25 apresentam as respostas nas variáveis 

manipuladas para esta situação. Como as variáveis controladas TRX e Severidade da 

Reação Catalítica estão interrelacionadas, uma mudança no valor de referência de uma 

delas necessariamente irá afetar o valor de referência da outra, para atender à condição de 

estado estacionário. 

224 

RAIJ 
223 

700 800 

Tempo (min.) 

Figura 4.24 Resultados das ações do controlador nas variáveiS mampuladas RAI e CTCV, assummdo como 
estratégia de otimização maximizar a produção de GLP ao invés de Nafta. Resposta à mna 
perturbação na variável TAI com intensidade de +8%, com inserção de ruído de 1,5% nas 
variáveis controladas. 

""·' . 237.0 I"""'' - I TFPI - -- I RlF I i 404,5 e z;s,5 I. 
- ~ 

~ .g 404,0 Q. ÕZ36.0 
o 

~.._ 
~ -a. 
~ ::240'3,5 

iU u.. I 
, ~ 235.5 

"e J\!• " ~ -!!- .9- !!' 
~ 1= 403,0 r c !l 235.0 -a. a: ê .. 'E 
~ 

]! " 1! .. ~402.5 'li! 234.5 
]! !l ~ I =ê 
~ 

402,0 234,0 
o 100 200 "" 

., 500 600 700 800 o 100 210 ., 400 "" 600 700 ""' Tempo (min.) Tempo (min.) 
.. 

Figura 4.25 Resultados das ações do controlador nas vanave1s mampuladas RTF e TFP, assummdo como 
estratégia de otimização maximizar a produção de GLP. Resposta á mna pertUibação na variável 
T AI de intensidade +8o/o, com inserção de ruído de 1,5% nas variáveis controladas. 

Novamente, a presença de ruído não afetou o desempenho das ações do 

controlador para esta situação. 



95 

4.2.3.5 Comparação com o controle DMC 

Na tentativa de efetuar uma comparação entre o controlador preditivo proposto e o 

controlador preditivo DMC existente, foi proposto efetuar uma simulação das condições 

encontradas no controlador DMC desenvolvido por Moro em sua dissertação de mestrado 

(MORO, 1992). Desta forma, um teste foi efetuado aplicando uma variação de 0,65 para 

O, 70kgfi'cm2 na variável perturbação setpoint do controlador de Pressão Diferencial entre 

Regenerador e Reator, variável SETPDCV. Como estratégia de controle, foi proposta a 

maximização de severidade, igual ao proposto no controle DMC. Os fatores de ponderação 

para este teste nas variáveis manipuladas, Â;, foram: 5,0e-2 para TFP, S,Oe-2 para RAI, 

8,0e-2 para RTF, e 4,0e-2 para CTCV; e os fatores de igual importância, a;, para as 

variáveis controladas, foram: l,Oe-3 para TRGI, l,Oe-6 para TRG2, l,Oe-3 para SEV e 

l,Oe-3 para TRX. O filtro utilizado para o cálculo da trajetória de referência foi único, de 

9,0e-l para todas as variáveis. O intervalo de amostragem foi de 5,0 em 5,0 minutos e o 

horizonte Np = 10. O horizonte de controle foi alterado para 2, utilizando outra rotina em 

linguagem FORTRAN. Os gráficos das Figuras 4.26 a 4.29 apresentam os resultados 

comparativos de ambos os controladores, juntamente com os resultados sem ação de 

controle (linha tracejada). 

"c 

730 

Temperaturas do regenerador- variáveis controladas 

i;. I -com ação de controle I 
. - - - -sem ação de controle 

72ll --r·b..=--''"----.L. ___ limrte-. máximo 

710 ! 
; 

700-l--1'&gt; 
i 

680 
I 
i 

TRG2- fase densa do segundo estágio 

~ ------------
\ ---- ----------... __ _ 

TRG1- fase densa do primeiro estâgio 

"'" +----"!-.. 
660 l \ -----------------1 ..... ___________ _ 
650 --+---·-·---·-----------

! limite minímo 

100 150 200 250 300 350 400 

Tempo (min.) 

Ftgura 4.26 Resposta comparattva entre os resultados das Temperaturas de Satda das Fases Densas do 
Regenerndor, primeiro e segnndo estágios - TRGI e TRG2. No gráfico da esquerda estão 
representados o resultado do controlador proposto (linha cheia) e o resultado sem ação do 
controlador (linha tracejada); e no gráfico da direita estão representados os resultados do DMC 
(MORO, 1992). 



96 

Severidade calculada - variável controlada 

: ~~I --com ação de controle I 
94 l, - - - ·sem ação de controle 

~=================---~lim~~~~m~é~x~im~o 92 r----+ -
90 i 

j 
% 86 ! 

84 \ 

: [ 
781----f 
76 ! 
74 

--------~----------------------

valor real 

72 

i 
! 
! limite mlnimo 

70 -·-!------·----·----·--
68 o 5o} 

iniciod~ 
perturbação 

100 150 200 250 

Tempo (min.) 

300 350 400 

.. Umnemóximo . 
Í , e9lpoint . . 

"l ~ 
1 

n.. vo.lcrreci 
K ~ ·~~~·~·F~~-~·r:~u~~~~)-~~~ " t---- M u 'n:?~ " ; •. -VI' T 
~~---"~!r : 
74 : a 

' ' 
: I 

nt---~:~um~~~m~m~~------~:----------41 
, , Tempo lminl 

"~----~--~--~--~--T---~~~-4 
SG too 15&amp;amp; 200 250 JOO J:;o o!OO 

" 

inldo do PG~Wrbor;!o 
a1llaç!c 
doDMC 

F1gura 4.27 Resposta comparativa entre os resultados da Sevendade da Reação Catalítica No gráfico da 
esquerda estão representados o resultado do controlador proposto (linha cheia) e o resultado sem 
ação do controlador (linha tracejada); e no gráfico da direita estão representados os resultados do 
DMC (MORO, 1992). 

"c 

554 

552 

550 

548 

546 

Temperatura na saida do Riser - variável controlada 

j
1

'1 --TRX com ação de controle I 
! I -- -- TRX sem ação de controle 
I ---
~ ' ------------
1 ... . 

' ' 
' ' ' ' 

' 
' ' 
--

----

- valor real 
544 I 1 
542H 

150 200 250 

Tempo (min.) ""' 

TEMPERATURA NA SAÍDA DO RrSEfl- variivd contratada 

""'j u..m,;,.,;;, da s .... ridn. .. , 
""1 

I 

"'1 .. 
u 5-161 lllnrle' A 

!04~ ~ 
,., I . 
SoiQ; 1 ,. ,. ... ... 

I 
.,. J 

Figura 4.28 Resposta comparativa entre os resultados da Temperatura de Saída do RJser- TRX No gráfico da 
esquerda estão representados o resultado do controlador proposto (linha cheia) e o resultado sem 
ação do controlador (linha tracejada); e no gráfico da direita estão representados os resultados do 
DMC (MORO, 1992). 



Temperatura da fase diluída do~ estãgio ~variável associada 
720 

710 

'c 

700 

690 

680 
o 

i 
i 
' L 
' I 
i 
' ! 
' ! 
' i 
I 
! 
! 

50 

' ' ' 
' ' 
' 

I 
-com açao de controle I 
- -- - sem açao de controle 

\ ----------------
\ -------, __ ... --

100 150 200 250 300 350 400 

Tempo (min.) 

97 

TEMPERATURA FASE llllUIDA 2°ESTÂGIO • v•riivele .. odm 
"" ' ' ' ' ! I ~ tim.'CQ mâxi:no 

I ' 

""1 ' 
oc.v3~ - ~ /\ ,,. . Jtimlle , ' '\,v. 

'I jmii'limo: 'I :I ! i\ 
l 

' :&gt;oo.j 

I ' i V Tempo (mi•J ,., I 
" , .. '"' "" "" "" "" ... ... lntcioíia perturbQÇão 

o.!u.açiic 
doDMC 

Figura 4.29 Resposta comparativa entre os resultados da Temperatura da Fase Dilmda do Segundo Estagto do 
Regenerador - TD2. No gráfico da esquerda estão representados o resultado do controlador 
proposto (linha cheia) e o resultado sem ação do controlador (linha tracejada); e no gráfico da 
direita estão representados os resultados do DMC (MORO, 1992). 

Analisando os gráficos das Figuras 4.26 a 4.29 acima, o primeiro fato que se 

observa é que após início da perturbação, o tempo necessário para se atingir o estado 

estacionário com ação de controle foi praticamente o mesmo, próximo a 200 minutos, para 

ambos os controladores. Outro fato que se observa é que as amplitudes das respostas 

também foram praticamente iguais para ambos. Isto comprova, pelo menos, igual 

desempenho para o controle proposto comparando com o DMC existente. Levando em 

consideração o tempo de processamento, o controlador baseado em Redes Neurais 

Artificiais se mostra superior, uma vez que sua resposta é extremamente mais rápida, 

mesmo se considerarmos a possibilidade de elevar o horizonte de controle para valores 

superiores a 1. É necessário que se esclareça que o tempo de processamento do controle via 

RNA, uma vez efetuado o treinamento o.ff-line, é da ordem de frações do minuto, inferior 

portanto ao tempo de simulação e ao tempo de amostragem considerados; e, o ganho no 

esforço computacional do controle DMC só foi possível de ser obtido com o 

"desmembramento do problema de programação linear em dois níveis: o nível estático onde 

são tratadas as restrições e o nível dinâmico onde o controle multivariável é feito usando os 

setpoints obtidos no nível estático" (MORO, 1992). 

Comparando os resultados obtidos do controlador, considerando Nc = 2 (Figuras 

4.26 a 4.29), com os resultados obtidos considerando Nc = 1 (Figuras 4.14 e 4.15), observa-

se uma melhora razoável nas ações de controle, com redução das oscilações. Entretanto, os 



98 

ajustes do controlador foram extremamente dificeis de serem realizados para este 

horizonte (Nc = 2), e não se obteve êxito na tentativa de se elevar Nc para valores superiores 

a 2. Convém observar que a rotina de minimização escrita em linguagem Fortran para Nc = 

1 é diferente da rotina para Nc = 2, o que por sua vez difere também para Nc &gt; 2, apesar de 

utilizarem o mesma subrotina NCONF para minimização da função objetivo, (vide Capítulo 

Til). O aumento deste horizonte resulta no aumento do número de variáveis a otimizar, 

aumentando a dificuldade de ajuste do controlador. 



99 

CAPÍTULO V 

CONCLUSÕES E SUGESTÕES 

Um modelo interno do controlador preditivo para unidade FCC, representando a 

dinâmica das principais variáveis de controle foi desenvolvido e testado, utilizando a 

técnica de Inteligência Artificial - as Redes Neurais Artificiais. O modelo fenomenológico 

existente na literatura que representa esta dinâmica, já devidamente validado com a unidade 

industrial, foi usado para obtenção dos conjuntos de dados para treinamento da rede. Este 

modelo também foi usado para representar a unidade industrial no teste de desempenho do 

controlador desenvolvido. Como treinamento da referida rede, foi utilizada a modalidade 

supervisionada, denominada Backpropagation. 

Não foi tecido neste estudo nenhum comentário a respeito da obtenção de mínimos 

locais por esse método de treinamento, pois a preocupação maior foi obter uma 

configuração que atendesse aos requisitos preestabelecidos de erro entre rede e modelo 

ngoroso, não importando se este resultado fosse obtido de um mínimo local ou não. 

Diversas arquiteturas de redes, utilizando diferentes números de nós na camada 

intermediária foram testadas, utilizando como critério para seleção da rede ótima o erro 

relativo, limitado em no máximo 1, O% entre os resultados obtidos da rede neural e os 

resultados obtidos do modelo. 

A configuração escollúda baseada nesse critério de erro para representar a unidade 

de FCC foi de uma rede totalmente conectada com alimentação positiva com 3 camadas 

contendo: 8 nós na primeira camada, 15 nós na camada intermediária, e 4 nós na camada de 

saída. Na etapa de identificação do modelo foi inserido um ruído aleatório nos sinais das 

variáveis controladas do modelo fenomenológico visando testar a robustez do modelo em 

RNA. A rede escollúda apresentou bons resultados apresentando robustez mesmo 

utilizando uma precisão de apenas 5,23E-4 no gradiente da função objetivo, gerando uma 

função objetivo, que representa o somatório dos erros quadráticos dos resultados da rede de 

1,09E-l. Estes resultados permitem concluir que o modelo escollúdo é capaz de representar 

fielmente o modelo fenomenológico, mesmo considerando a não linearidade do processo e 

elevada interação entre suas variáveis de operação, sendo também considerado adequado 

para ser usado como modelo interno de um controlador preditivo. 



100 

Um controlador preditivo utilizando as RNA como modelo interno foi 

desenvolvido e inserido na rotina do modelo fenomenológico, propondo controle e 

otimização. Visando testar a robustez do controlador proposto e simular as condições de 

sinais ruidosos normalmente encontradas numa unidade industrial foi inserido um ruído 

aleatório nos sinais das variáveis controladas provenientes da simulação nos testes do 

controlador. Diversas situações foram testadas: problema de controle regulador, problema 

de controle servo-regulador, simulação de mudança de produção de Nafta para GLP, entre 

outros, para diferentes horizontes de predição e controle, sendo efetuado comparações com 

sistema aberto e com o controle DMC. 

O controle rnultivariável utilizando redes neurais como modelo interno aplicado ao 

simulador do processo FCC demonstrou um desempenho muito bom em todas as 

simulações efetuadas, principalmente se considerarmos que as perturbações impostas foram 

bem mais agressivas do que normalmente são permitidas nessas unidades. Em todos os 

testes efetuados o controlador manteve a estabilidade do processo levando as variáveis 

controladas para os seus valores de referência mesmo na presença de ruidos, permitindo 

também obter urna estratégia de otimização do controle. A utilização de Nc = 2 melhorou 

consideravelmente a ação do controlador quando comparado com horizonte de controle 

Nc = 1, reduzindo as oscilações observadas com este controle no teste efetuado. 

Isto demonstra que um controlador preditivo rnultivariável baseado em RNA é 

perfeitamente capaz de controlar um sistema não linear do porte da unidade do FCC, no 

qual elevada interação entre suas variáveis operacionais e fortes restrições estão presentes, 

apresentando robustez, uma característica das redes neurais artificiais. Isto nos permite 

extrapolar que são boas as expectativas para urna futura utilização na unidade industrial, 

principalmente devido à sua simplicidade, robustez e facilidade de implementação, a 

despeito da dificuldade de sintonia do controlador. Corno sugestões para trabalhos futuros, 

podem ser citados: 

• O modelo fenomenológico representativo do FCC, Modelo Kellogg Orthoflow F., está 

sendo revisado atualmente (conforme ZANIN, 2001 4). Neste estudo é proposto uma 

atualização e melhoria do modelo. Proponho que seja feito o mesmo estudo de 

4 
ZANlN, A C. lntegrating Real-time optimization into the Model Predictive Controller ofthe FCC system. V Simpósio 

Brasileiro de Automação Inteligente -SBA/. Canela, RS. 2001. Disponível em:&amp;lt;http://www.delet.ufrgs.br/vsbai&gt; e 
informação verbal. 2001. 



identificação e controle utilizando as Redes Neurais Artificiais para este modelo 

revisado; 

101 

• A ação de controle do Regenerador (nas temperaturas dos leitos densos, primeiro e 

segundo estágios) apresentou desempenho um pouco prejudicado devido a razão de ar 

para os estágios ser considerada fixa no próprio modelo fenomenológico. É proposto 

realizar um estudo de identificação e controle incluindo a razão de ar para os dois 

estágios do Regenerador como nova variável manipulada, de forma a aumentar a 

eficiência do controle de suas temperaturas de saida; 

• Como o desempenho do Regenerador é baseado no teor de 02 livre nos gases de 

combustão, é proposto realizar um estudo de inferenciação do teor de 02 nos gases de 

combustão, visando inseri-lo no modelo fenomenológico e dessa forma avaliar 

diretamente o desempenho do Regenerador como função desse teor, ao invés de utilizar 

as temperaturas dos leitos, utilizando um modelo Híbrido de Redes Neurais; 

• Como foi observado que o desempenho do controlador pode ser melhorado ainda mais 

considerando o horizonte de controle maior que 1, é proposto realizar novos testes 

utilizando o mesmo modelo de identificação, fazendo Nc = 2 e valores superiores para 

este horizonte; 

• Durante o processo de identificação, foi observado que uma vez obtidos os pesos e bias 

para determinada arquitetura de rede neural, estes poderiam ser utilizados como inputs 

para novo treinamento com mesma arquitetura ao invés de se utilizar valores 

randômicos, com a vantagem de reduzir muito o tempo de CPU neste treinamento. Isto 

poderia ser útil tomando viável o treinamento em linha ( on-line) na unidade industrial. 

É proposto testar a possibilidade de treinamento com o modelo fenomenológico, 

simulando um treinamento em linha, utilizando como entrada para treinamento os 

valores de pesos e bias obtidos do treinamento off-line. Este procedimento seria de 

extrema importância numa eventual mudança de procedência do petróleo utilizado com 

conseqüente mudança da qualidade da matéria prima da FCC. 



103 

REFER!NCIAS BmLIOGRÁFICAS 

AG~ARA, R., GONZÁLEZ, J, RAMIREZ, J. A, BARRÓN, M. Control of a fluid 

catalytic cracking unit based on proportional-integral reduced order observers. Joumal oj 

Chemical Engineering v. 75, p. 77-85, 1999. 

ALI, E. E. AND ELNASHAlE, S., Non-linear model predictive control of industrial type 

IV fluid catalytic cracking (FCC) units for rnaximum gasoline yield, Ind. and Engng. 

Chem. Res., v. 36, p. 389-398, 1997. 

ALI, E. and ZAFIRIOU, E. On the Tuning ofNonlinear Model Predictive Control 

Algorithms. 1993. Technical Research Repor!, lnstitute for Systems Research National 

Science FoundationEngineering Research Center Program (NSFD CD 8803012), TR 

93-26. In: E-Mail: zafiriou@src.umd.edu. Acessado em: 20 jan. 2000. 

ALVES, R. M. B. and NASCIMENTO, C. A O. Neural Network Based Approach for an 

Industrial Isoprene Process Optirnization. In: fih WORLD CONGRESS OF CHEMICAL 

ENGINEERING, 967., 2001, Melbourne, Australia. Proceedings ... Melbourne, Australia, 

2001. 

ANSARI, R. M. and TADÉ, M. O. Constrained nonlinear multivariable control of a fluid 

catalytic cracking process. Joumal oj Process Contra! v. 10, p. 539-555, 2000. Disponível 

em:&amp;lt;http://www.elsevier.com/locate/jprocont&gt;. Acessado em: 03 dez. 2000. 

ANTONIADES, C., CHRISTOFIDES, P. D. Feedback control ofnonlinear differential 

difference equation systems. Chemical Engineering Science v. 54 p. 5677-5709, 1999. 

ARANDES J. M. and LASA H. I. - Simulation and Multiplicity of Steady States in 

Fluidized FCCUs. Chemical Engineering Science, v. 47, n. 9-11, 2535-2540, 1992. 



104 

BALCHEN, J.G., LUNGQUIST D. AND STRAND S., State-space predictive control, 

Chemical Engineering Sei. v. 47 p. 787-798, 1992. 

BAUGHMAN, D. R. and LIU, Y. A. Neural Networks in Bioprocessing and Chemical 

Engineering. London: Academic Press, Inc., 1995, 489 p .. 

BHAT, N. and McAVOY, T. J. Use ofNeural Nets for Dynamic Modeling and Control of 

Chemical Process Systems. Computers chem. Engng., v. 14, n. 4/5, p. 573-583, 1990. 

BHAT, N. and McAVOY, T. J. Determining Model Structure for Neural Models by 

Network Stripping. Computers chem. Engng., v. 16, n. 4, p. 271-281, 1992. 

CASTIER, M. Subroutine for the Minimization of a Multivariable Function using the 

Conjugate Gradient Method oj FLETCHER AND REEVES (1964). Based on a skeleton of 

the routine TMSSJ ofM. L. MICHELSEN. (Instittutet for Kemiteknik- DTH- Denmark). 

Programa de Engenharia Química- COPPE. Universidade Federal do Rio de Janeiro, 1990. 

DE SOUZA JR, M. B. Redes Neuronais Multicamadas aplicadas a modelagem e controle 

de processos quimicos. Rio de Janeiro: COPPEIUFRJ,. 1993. 124 p. Tese (doutorado). 

DI MASSIMO, C., MONTAGUE, G. A., WILLIS, M. J., THAM, M. T. and MORRlS, A. 

J. Towards Improved Penicillin Fermentation via Artificial Neural Networks. Computers 

chem. Engng., v. 16, n. 4, p. 283-291, 1992. 

DONG, D., McAVOY, T. J. and ZAFIRIOU, E. Batch-to-Batch Optimization Using Neural 

Network Models. Ind. Eng. Chem. Research. v. 35, p. 2269-2276, 1996. 



EDGAR, T. F. and HIMMELBLAU, D. M. Optimization ofChemical Processes, p. 

206-208, McGraw-Hill lntnl. Ed, New York, 1988. 

105 

ENDER, L. and MACIEL FILHO, R. Utilização de modelo dinâmico neural em estratégia 

de controle preditivo multivariável. XIII Congresso Brasileiro de Engenharia Química-

COBEQ. XIX lnteramerican Congress oj Chemical Engineering. Anais do congresso, 2000. 

FALTSI-SARAVELOU, O. VASALOS, I. A. andDIMOGIORGAS, G. FBSim: Amode1 

for Fluidized Bed Simulation - li. Simu1ation of an industrial Fluidized Catalytic Cracking 

Regenerator. Computers Chem. Engng. v. 15, n. 9, p. 647-656, 1991. 

FENG, E. and JIN, Y. A Neural Methodology for Batch Process Optimizing Control. 

Second/EEE Conjerence on Contra! Applications, p. 13-16, September 1993. 

FILETI, A. M. F. Controle avançado de Processos: Adaptativo, Preditivo e Fuzzy. 

Modelagem Matemática via Redes Neurais. Aplicações em Processos Químicos. (material 

especialmente elaborado para o curso ministrado na Escola Politécnica da Universidade 

Federal da Bahia). UNICAMP- Faculdade de Engenharia Química. Campinas, Brasil. Jul. 

1998. 

FILETL A. M. F. and PEREIRA, J. A. F. R. Adaptive and predictive control strategies for 

batch distillation: Development and experimental testing. Computers chem. Engng. v. 21, 

Suppl., p. S 1227-812231, 1997. 

FILETI, A. M. F., PEREIRA FILHO, R. D., PEDROSA, L. S. and PEREIRA, J. A. F. R A 

comparison of control strategies for bath distillation. Intemational Symposium on Advanced 

Contra! of Chemical Process- ADCHEM 2000. p. 635-640. Pisa, Italy- June 2000. 



106 

FONSECA E. F. Controle Preditivo Baseado em Redes Neurais de Fermentação Alcoólica 

Contínua. Recife: DEQIUFPE, 1998, Dissertação (Mestrado). 

GÁL VEZ, J. M. and SOUZA, S. R. Multivariable modeling and control of a Fluid Catalytic 

Cracking Converter unit. XIII Congresso Brasileiro de Engenharia Química- COBEQ. 

XIX Interamerican Congress oj Chemical Engineering. Anais do congresso, 2000. 

GOH, K. C., WU, F. and WALSH, S. Control Design forNonlinearProcessModels using 

Linear Robust Control Methods: An FCCU Example. Computers Chem. Engng., v. 21, 

Suppl., p. S595-S600, 1997. 

GREA VES, M. A., MUJT ABA, I. M. and HUSSAlN, M. A. Model Development Though 

Pilot Plant Experiments and Neural Networks for Optimal Control ofBatch Dístillation. In: 

6'h WORLD CONGRESS OF CHEMICAL ENGINEERING, 591., 2001, Melbourne, 

Australia. Proceedings ... Melbourne, Australia, 200 I. 

GROSDIDIER., P., MASON, A., AlATOLARTI, A., HEINONEN, P. and VANHAMÀKI, 

V. FCC Unit Reactor-Regenerator Control. Computers chem. Engng., v. 17, n. 2, p. 165-

179, 1993. 

HAN, I. S. &amp;amp; CHUNG, C. B. Dynamic modeling and simulation of a fluidized catalytic 

cracking process. Part li: Property estimation and simulation Published by Elsevier Science 

Ltd. Chemical Engineering Science 56 (2001) p. 1973-1990, 2001b. 

HAN, I. S. &amp;amp; CHUNG, C. B. Dynamic modeling and simulation of a tluidized catalytic 

cracking process. Part I: Process modeling Published by Elsevier Science Ltd. Chemical 

Engineering Science 56 p.1951-1971, 200Ia. 



HAYKIN, S. Neural Networks-A Comprehensive Foundation. NJ: Macmillan 

Publishing Co., 1994, 696 p. 

HECHT-NIELSEN, R. Theory ofthe backpropagation network. Proceedings, Int. Joint. 

Conf on Neural Networks, Washington, DC, v. 1, p. 593-605, 1989. 

HERNÁNDEZ, E. and ARKUN, Y. Study ofthe Control-Relevant Proprieties of 

Backpropagation Neural Network Models ofNonlinear Dynamical Systems. Computers 

chem. Engng., v. 16, n. 4, p. 227-240, 1992. 

107 

HODGSON, M. C. J., FOSKETT, S. J. and YANIK, S. J. Catalyst Management Concepts 

to Cope with Mass-Transfer Limitations in the Fluid Catalytic Cracking Unit. In: 6'h 

WORLD CONGRESS OF CHEMICAL ENGINEERING, 1749., 2001, Melbourne, 

Australia. Proceedings. Melbourne, Australia, 2001. 

HOLCOMB &amp;amp; MORAR!. PLS/Neural Networks. Computers Chem. Engng., Pergamon 

PressLtd, v.16 (4), p. 393-411, 1992. 

HOSKINS, J. C. and HIMMELBLAU, D. M. Process Control via Artificial Neural 

Networks and Reinforcement Leaming. Computers chem. Engng., v. 16, n. 4, p. 241-251, 

1992. 

ISCOL L. The dynamics stability of a fluid catalytic cracker. Joint Automatic Control 

Conference, Atlanta, Georgia, 602-607, 1970. 

ISHIKAWA, T., NATORI, Y., LIBER.IS, L. andPANTELIDES, C. C. Modeling and 

Optimization of an Industrial Batch Process for the Production ofDioctyl Phthalate. 

Compters Chem. Engng., v. 21, Suppl., p. S1239-S1244, 1997. 



108 

JACOB S. M., GROSS, B., VOLTZ, S. E. and WEEKMAN, V. W., A lumping and 

reaction scheme for catalytic cracking. AIChE. Joumal, v. 22, n. 4, p. 701-713, 1976. 

JAGANNATHAN, S. and LEWIS, F. L. Identification ofNonlinear Dynarnical Systems 

Using Multi!ayered Neural Networks. Automatica, v. 32, n. 12, p. 1707-1712, 1996. 

JAMIESON, A. E. Dynarnic Simulation in Process Control Design. In: ffh WORLD 

CONGRESS OF CHEMICAL ENGINEERING, 1670., 2001, Melbourne, Australia. 

Proceedings. Melbourne, Australia, 2001. 

JOSEPH, B., W ANG, F. H. and SHIEH, D. S. -S. Exploratory Data Analysis: A 

Comparation of Statistical Methods with Artificial Neural Networks. Computers Chem. 

Engng., v. 16, n. 4, p. 413-423, 1992. 

KALRA, L. and GEORGAKIS, C. The effects ofOperational Characteristics ofCatalytic 

Cracking Reactors on the Closed-Joop Performance ofLinear Model Predictive Controllers. 

Computers chem. Engng., v. 4, p. 401-415, 1996. 

KAMARTHI, S. V. and PITTNER, S. Accelerating neural network training using weight 

ex:trapolations. Neural Networks. Pergamon, Elsevier Science Ltd, v. 12, p. 1285-1299, 

1999. Dispmúve1 em:&amp;lt;http://www.eselvier.comllocate!neunet&gt;. Acessado em: 14 set. 

2000. 

KA VURI, S. N. and VENKATASUBRAMANIAN, V. Combining Pattem Classification 

and Assumption-based Techniques for Process Fault Diagnosis. Computers Chem. Engng., 

v. 16, n. 4, p. 299-312, 1992. 



109 

KHANDALEKAR, P. D. and RIGGS, J. B. Nonlinear Process Model Based Control 

and Opti.mization ofa Model IV FCC Unit. Computers Chem. Engng., v. 19, n. 11, p. 1153-

1168, 1995. 

KlM, S. -J., LEE, M., PARK, S., LEE, S. -Y. and PARK, H. A Neural Linearizing Control 

Scheme for Nonlinear Chemical Processes. Computers Chem. Engng., v. 21, n. 2, p. 187-

200, 1997. 

KRISHNA, A. S. and PARKIN, E. S. Modeling the Regenerator in Commercial Fluid 

Catalytic Cracking Utúts. Chemical Engng. Prog. April (57) 1985. 

KROTHAP ALL Y, M. and P ALANKI, S. A Neural Network Strategy for Batch Process 

Optimization. Computers chem. Engng., v. 21, Suppl., p. S463-S468, 1997. 

KURIHARA, H. Optimal Control of Fluid Catalytic Cracking Processes. MIT, Cambridge, 

MA: Ph.D. Thesis, 1967. 

LEE, E. and GROVES, F. R. Mathematical model ofthe fluidized bed catalytic cracking 

plant. Trans. Soe. Compt. Sim., v. 2, p. 219-236, 1985. 

LEE, W. and KUGELMAN, A. M.- Number ofsteady-state operating points and local 

stability of open-loop fluid catalytic cracker. Ind. Eng. Chem. Pocess Des. Dev., v. 12, p. 

197-204, 1973. 

LEVIN, A. U. and NARENDRA, K. S. Control ofNonlinear Dynamical Systems Using 

Neural Networks: Controllability and Stabilization. IEEE Transactions on Neural 

Networks, v. 4, n. 2, March 1993. 



110 

LEVIN, A. U. and NARENDRA, K. S. Control ofNonlinear Dynamical Systems Using 

Neural Networks- Part II: Observability, Identification, and Control. IEEE Transactions 

on Neural Networks, v. 7, n. 1, January 1996. 

LIMA, E. L. e OLIVEIRA, S. L. Tendências em Controle de Processos. Apostila do curso. 

Escola Piloto de Engenharia Química. Programa de Engenharia Química, COPPEIUFRJ. 

1997. 

MACF ARLANE R. C. &amp;amp; REINEMAN R. C., Multivariable Optimizing Control of a 

Model N Flluid Catalytic Cracking Unit, AJChE Spring National Meeting, March 18-22, 

Orlando, Florida, 1990. 

MORO, L, F. L. and ODLOAK, D. Constrained Multivariable Control ofFluid Catalytic 

Cracking Converters. J. Proc. Cont., v. 5, n. I, p. 29-39, 1995. 

MORO, L. F. L. Dese11Volvimento de um Controlador Preditivo Multivariável para um 

Co11Versor Industrial de Craqueamento Catalítico. São Paulo: USP, 1992, 77 p. 

Dissertação (Mestrado) 

NARENDRA, K. S. and MUKHOP ADHY AY, S. Adaptive Control Using Neural 

Networks and Approximate Models. IEEE Transactions on Neural Networks, v. 8, n. 3, 

May !997. 

NARENDRA, K. S. Neural Networks for Control: Theory and Practice. Proceedings of the 

IEEE, Oct 1996. v. 84, n. 10. 



NASCIMENTO JR., C. L. Artificial Neural Networks in Control and Optimization. 

1994. 209 p. Thesis (Doctor ofPhilosophy)- Faculty ofTechnology, University of 

Manchester, Control Systems Center- UMIST, Manchester, UK. 

111 

NELSON, M. M. and ILLINGWOTH, W. T. A Practical Guide to Neural Nets. Addison-

Wesley Publishing Company, Inc., 1991, 344 p. 

NIEDERBERGER, J., FUSCO, J. M., CID, E. A. e SANDES, E. F. SIMCRAQ
0
T- Um 

sistema avançado para a simulação e otimização do processo de FCC. XIII Congresso 

Brasileiro de Engenharia Química- COBEQ. XIX /nteramerican Congress ofChemical 

Engineering. Anais do congresso, 2000. 

NIKRA VESH, M. F ARELI, A. E. and ST ANFORD, T. G. Model Identification of 

Nonlinear Time Variant Process via Artificial Neural Network. Computers chem. Engng., 

v. 20, n. 11, p. 1277-1290, 1996. 

PACHOVSKY, R A. and WOJCIECHOWSKl, B. W. Effects of charge stock composition 

on selectivity in the cracking ofneutral distillates. Can. Joumal ojChem. Engng., v. 53, p. 

659-665, dec. 1975. 

PEDROSA, L. S., NUNES, R L., PEREIRA, J. A. F. R and FILETI, A. M. F. A Neural 

Network Based Inference System to the on-line estimation ofPolymer Quality. In: 6* 
WORLD CONGRESS OF CHEMICAL ENGINEERING, 424., 2001, Melbourne, Australia. 

Proceedings. Melbourne, Australia, 200 I. 

PEREIRA FILHO, R. D. Desenvolvimento e implementação de controladores Fuzzy para 

uma coluna de destilação em batelada. Universidade Estadual de Campinas- UNICAMP, 

SP, 1999. 



112 

POLLARD, J. F., BROUSSARD, M. R., GARRISON, D. B. and SAN, K, Y. Process 

Identification Using Neural Networks. Computers chem. Engng., v. 16, n. 4, p. 253-270, 

1992. 

PRANATYASTO, T. N., and QIN, S. J. Model Predictive Control ofFCC units with 

Integrated Sensor Validation and Process Fault Diagnosis. International Symposium on 

Advanced Contrai ojChemical Processes. p. 569-574, Italy- June, 2000. 

PRETT, M. P. and GARCIA, C. E. Fundamental Process Contrai. USA MA: Butterworth 

Publishers, Stoneham, 1988. 

ROBITAILLE, B., MARCOS, B., VEILLETTE, M. and PAYRE, G. Modified Quasi-

Newton Methods for Training Neural Networks. Computers Chem. Engng., v. 20, n. 9, p. 

1133-1140, 1996. 

RUIZ C. A. and SONNET, A Neural Networks Applications in the process Industry. XIII 

Congresso Brasileiro de Engenharia Química COBEQ. XIX Interamerican Congress oj 

Chemical Engineering. Anais do congresso, 2000. 

RUMELHART, D. E., HINTON, G. E. and WILUAMS, R. J. Learning internai 

representations by error propagation. Para/lei Distributed Processing: Explorations in the 

Microstructure ojCognition. v. 1, (Rumelhart, D. E. and McClelland, J. L., eds). 

Foundations the MlT Press. Cambridge. 1986. 

SALOMON, R. and V AN HEMMEN, J. L. Accelerating Backpropagation through 

Dynamic Self-Adaptation. Neural Networks, Pergamom press, Elsevier Science Ltd., v. 9., 

n. 4, p. 589-601, 1996. 



113 

SANTOS, V. M. L. Identificação e Controle Preditivo Baseado em Redes Neurais de 

Processos de Craqueamento Catalítico em LeitoFluidizado. Recife, PE: DEQ!UFPE, IOlp. 

2000b. dissertação (mestrado) 

SANTOS, V. M. L., CARVALHO, F. R. and De SOUZA Jr., M. B. Predictive Control 

Based on Neural Networks: An Application to a Fluid Catalytic Cracking Industrial Unit. 

Brazilian Jou171al oj Chemical Engineering. v.l7 n. 04-07, p. 897-902. 2000a. 

SARMA, P. AND RENGASW AMY, R. Multivariable gain-scheduled fuzzy logic control 

of a fluidized catalytic cracker unit. Computers and Chemical Engineering v. 24 p. I 083-

1089, 2000. 

SA VKOVIC' -STEV ANOVIC', J. Neural Networks for Process Analysis and Optimization: 

Modeling and Applications. Computers chem. Engng. v. 18. n. 11112. p. 1149-1155, 1994. 

SIMPSON, P. K. Artificial Neural Systems: Foundations, Paradigms, Applications and 

Implementations. New York: Pergamon Press, Inc. 1990, 203 p. 

STEPHANOPOULOS, G. and HAN, C. Intelligent Systems in Process Engineering: A 

Review. Computers Chem. Engng., v. 20, n. 6/7, p. 743-791, 1996. 

TVRZSKÁ DE GOUVÊA, M. and ODLOAK, D. One-layer real-time optimization ofLPG 

production in the FCC unit: procedure, advantages and disadvantages. Computers Chem. 

Engng., v. 22, Suppl., SI91-198, 1998. 

VENUTO, P. B. and HABIB, E. T. Catalyst feedstock- Engineering interactions in fluid 

catalytic cracking. Cat. Rev. sei. Eng., v. 18, n. 1, 1978. 



114 

W ANG, H., OH, Y. and YOON, E. S. Strategies for Modeling and Control ofNonlinear 

Chemical Processes using Neural Networks. Computers Chem. Engng. v. 22, Suppl., p. 

S832-S862, 1998. 

W ANG, X. Z., CHEN, B. H., Y ANG, S. H., C. MCGREA VY. Application ofwavelets and 

neural networks to diagnostic system development, 1, feature extraction. Computers and 

Chemical Engineering, v. 23, p. 899-906, 1999a. 

WANG, X. Z., CHEN, B. H., YANG, S. H., C. MCGREAVY. Application ofwavelets and 

neural networks to diagnostic system development, 2, an integrated framework and its 

application. Computers and Chemical Engineering, v. 23 p. 945-954, 1999b. 

W ANG, Z. and ZHU, T. An effi.cient learning algorithm for improving generalization 

performance ofradial basis function neural networks. Neural Networks. Pergamon, 

Elsevier Science Ltd, v. 13, p. 545-553, 2000. Disponível em: 

&lt;http://www.elsevier.cornllocate/neunet&gt;. Acessado em: 14 set. 2000. 

WEEKMAN, V. W., Lumps, models and kinetics in practice. AIChE. Monograph Series, v. 

75, n. 11, 1979. 

WHlTELEY, J. R. and DA VIS, J. F. Knowledge-based Interpretation of Sensor Patterns. 

Computers Chem. Engng., v. 16, n. 4, p. 329-346, 1992. 

XU, C., GAO, J. and LIN, S. Simulation ofthe flow and Reaction and Application ofthe 

Reaction-Terminating Techníque in FCC Riser Reactor. In: (/h WORLD CONGRESS OF 

CHEMICALENGINEERING, 1214., 2001, Melbourne, Australia. Proceedings. Melbourne, 

Australia, 200 1. 



115 

Y AMADA, T. and Y ABUT A, T. Neural Network Controller Using Autotuning Method for 

Nonlinear Functions. IEEE Transactions on Neural Networks, v. 3, n. 4, July 1992. 

YANG, S. H., CHUNG, P. W. H., WANG, X Z. andMcGREAVY, C. Multi-objective 

Constraint Control for FCC Reactor-Regenerator System. Computers Chem. Engng., v. 22, 

Suppl. p. 8831-8834, 1998. 

Y ANG, Y., YIZONG, C., ZHAO, R and GOVlND, R Process Optimization Using Neural 

Networks. IEEE Inter. Conf On Neural Networks, Orlando, FL. Proceedings Piscataway., 

v. 7, p. 4635-4639, 1994. 

ZAlNUDDIN, Z. and EV ANS, D. J. Acceleration ofthe Back Propagation through 

Dynamic Adaptation ofthe Learning Rate. Intem. J. Computer Math., v. 65, p. 1-17, 1997. 

ZANlN, A. C. Integrating Real-time optimization into the Model Predictive Controller of 

the FCC system. V Simpósio Brasileiro de Automação Inteligente - SBAI. Canela, RS. 

2001. Disponível em:&amp;lt;http://www.delet.ufrgs.br/vsbai&gt; Comunicação pessoal. 2001. 

ZANlN, A C., M. TVRZSKÁ DE GOUVÊA, M. AND ODLOAK, D. Industrial 

implementation of a real-time optimization strategy for maximizing production ofLPG in a 

FCC unit. Computers and Chemical Engineering, v. 24 p. 525-531. 2000a. 

ZANlN, A C., M. TVRZSKÁ DE GOUVÊA, M. AND ODLOAK, D. Comparing different 

real-time optimization strategies for the FCC Catalytic Converter. Jntemational Symposium 

on Ad:vanced Contra! of Chemical Process- ADCHEM 2000. p. 803-808. Pisa, Italy- June 

2000b. 



116 

ZHAN, J. and ISHIDA, M. The Multi-step Predictive Control ofNonlinear SISO Processes 

with a Neural Model Predictive Control (NMPC) Method. Computers chem. Engng., v. 21, 

n. 2, p. 201-210, 1997. 

ZHAO, F., OU, J. and DU, W. Pattem-based fuzzy predictive control for a chemical 

process with dead time. Engineering Applications of Artificial Intelligence. Pergamon, 

Elsevier Science Ltd, v. 13, p. 37-45, 2000. Disponível em: 

&lt;http://www.elsevier.comllocate/engappai.html&gt;. Acessado em: 14 set. 2000. 

ZHENG, Y. -Y., Dynarnic modeling and simulation ofa catalytic cracking unít. Computers 

Chem. Engng., v.l8 (I), p. 39-44, Pergamon Press Ltd 1994. 



117 

ANEXOS 



119 

ANExo A 

ALGORITMO DE TREINAMENTO VIA RETROPOPAGAÇÃO (BACKPROPAGATION) 

A seguir é apresentado um algoritmo para atualização dos pesos e bias durante o 

treinamento da rede: 

-Passo 0: Inicialmente é atribuído valores aleatórios pequenos aos pesos e bias, evitando 

assim problemas como sirnetría (caso fossem gerados números iguais) e 

saturação (caso fossem gerados números muitos grandes para os pesos). Uma boa 

opção é gerar números entre -1 e +1 (RUMELHART &amp;amp; MCCLELLAND, 1986 

apud DE SOUZA JR., 1993 ); 

-Passo 1: Para cada padrão p (p = I, 2, ... Np), existe um conjunto de entradas Spj.O ú = 1, 2, 
... , nJ - onde n 1 corresponde ao número de neurônios na camada de entrada; e um 

conjunto de saídas des~adas lpt (I = 1, 2, ... , nJ) - onde nL corresponde ao 

número de neurônios na camada de saída L. Apresenta-se um padrão p por vez à 

rede; 

1. A passagem pela primeira camada de neurônios não lineares produz as 

seguintes ativações: 

(j =I, 2, .. .n,) (A.1) 

onde J( ) é dada pela função sigmoidal, (Equação 3 .4); 

2. À saída da camada escondida tem-se as ativações, 

(A.2) 

.2 .2 =[~w .. l.s -~]+e2 PJ· ~ fl pl, ), 
i=l 

j =1,2, .. .nh (A.3) 

tal que J( ) é dada pela função sigmoidal (Equação 3.4), e nh representa o 

número de neurônios na camada escondida; 

3. À saída da rede tem-se, 

(A.4) 



120 

j=J,2, ... ,nL (A.5) 

tal que f( ) é dada por função sigmoidal (Equação 3.4); 

-Passo 2: Os pesos são atualizados usando o método steepest descent, (Equação 3.10), 

sendo que as equações que fornecem os gradientes, são apresentadas no ANEXO 

B. 

Obs.J: na implementação do método pode-se atualizar os pesos após apresentação de cada 

padrão ou após apresentação de todos os padrões. No presente estudo, foi escollúdo 

atualizar os pesos após apresentação de todos os padrões; 

Obs.2: os padrões deverão ser normalizados antes de serem apresentados à rede. 

Repetem-se os passos 1 e 2 até que o erro fornecido por E (Equação 3.7) seja minimizado, 

ou seja, até que o erro seja menor que um valor delta muito pequeno. Aqui, foi adotado 

como critério de convergência a comparação do gradiente do erro E da função objetivo com 

um valor delta, e não a comparação do erro E da própria função objetivo com este valor, o 

que na verdade, apresentam mesmos resultados. 



121 

ANExoB 

CÁLCULO DOS ELEMENTOS DE .J!E(};f) DO MÉTODO STEEPEST DESCENT 

São apresentadas aqui as equações que fornecem o gradiente do erro em função 

das variáveis independentes (pesos e bias) para o método do passo decrescente - steepest 

descent, exemplificando para três camadas. (DE SOUZA JR., 1993; HAYKIN, 1994). 

Dado a função representada pela expressão B.1, 

(B.1) 

onde E representa o erro e, 

(B.2) 

Para os pesos w fiZ entre a camada escondida e a camada de saida, calcula-se a 

derivada pela regra da cadeia, ou seja, 

o E 
iJw ji2 

(B.3) 

Para os bias , ~.L, da última camada, calcula-se também pela regra da cadeia, 

(B.4) 

Para os pesos w fi' entre a camada de entrada e a camada escondida, calcula-se a 

derivada pela regra da cadeia, 



122 

(B.S) 

Para os bias , ~.2, da camada escondida, também pela regra da cadeia generalizada, 

tem-se, 

àE 
--= 
8(}2 

). 

(B.6) 

A derivada f'(x) - onde x aqui representa uma variável qualquer e f é a função 

sigmoidal, é fornecida por: 

f'(x)= ( e-x r = J(x}(l- J(x)) 
1 +e-x 

(B.7) 



123 

ANExo C 

ALGORITMO DO CONTROLE PREDITIVO UTILIZANDO REDES NEURAIS 

Neste Anexo é apresentado um algoritmo para implementação do Controlador 

Preditivo com Modelo utilizando as Redes Neurais Artificiais para representarem o modelo 

interno do controlador. 

1. Amostrar y;(k) e variáveis secundárias u;(k), sendo u=x(k)-x(k-1), e normalizar estas 

variáveis, utilizando a Equação 3 .19; 

2. Fazer predições de y,(k+l) via RNA, onde j;,corresponde ao valor predito de y;, 

utilizando o modelo interno que foi desenvolvido baseado na Equação 3.27; 

3. Avaliar o minimo da função objetivo em função de y, setpoint e u, utilizando a 
Equação 3.28, de forma a atender também aos critérios de restrição das Equações 3.29, 

3.30 e 3.31. Ao invés de se utilizar os valores de setpoints diretamente na equação 3.28, 

foi empregado a estratégia de se utilizar uma trajetória de referência calculada em 

função dos valores atuais das variáveis y(k) e setpoints utilizando a Equação 3.33. 

Dentro dessa estratégia foi realizado o cálculo de y predito de acordo com a Equação 

3.35; 

4. Atingiu o critério de convergência (atingiu o minimo)? 

Obs.: essa rotina foi realizada baseada no método de programação quadrática 

sucessiva existente na rotina interna do Fortran. 

N --+ corrigir u' e voltar para 2; 

S --+ efetuar a desnormalização nas variáveis de saida do controlador, utilizando a 

Equação 3.20 e implementar a primeira ação de controle~ u1' = u; 

5. Esperar hora de amostragem; 

6. Voltar para etapa 1. 



125 

ANExoD 

MODELO DINÂMICO DO CONVERSOR 

A simulação do processo de Craqueamento Catalítico foi desenvolvida a partir das 

características do Conversor FCC da Refinaria Henrique Lage, baseando-se em balanços de 

massa e energia. Este modelo, denominado aqui de modelo fenomenológico e algumas 

vezes de modelo rigoroso, já havia sido previamente validado com os dados da unidade 

industrial (MORO, 1992), tendo apresentado resultados bastante satisfatórios, sendo 

inclusive proposto sua implantação para controle na unidade, utilizando controlador DMC. 

Este modelo fenomenológico, sem ação do controlador, foi utilizado para gerar os 

conjuntos de dados de treinamento das redes neurais e também para representar a unidade 

industrial para implementação de um controle preditivo. 

A seguir serão apresentadas as equações obtidas destes balanços, obtidas por 

MORO, (1992), que representam o modelo fenomenológico a ser usado neste estudo para 

simular o conversor: 

• Balanço de carbono no catalisador do regenerador - este carbono é também 

conhecido como carbono catalítico e é representado por, 

dCcat 
Hra =-Rrc.Ccat+100.Rcf 

dt (D.l) 

onde:Hra = inventário de catalisador no reator (ton.) 

Ccat= carbono catalítico (%massa) 

Rrc = circulação de catalisador para o Ri ser ( ton/tmin) 

Rcf, por sua vez, representa o carbono reativo e é obtido pela seguinte equação 

em estado estacionário, 

Rcf = KccPra.[CjOf·
65 

WHSV 0•35 Ex:p(-1500/ R![Trx+273]).Rif Dif 11440 
Ccat.Crc 0•06 (D.2) 

onde: Kcc = constante experimental; 



126 

CIO = relação entre a circulação de catalisador e a vazão de carga; conhecida como 

relação catalisador I óleo (ton/ton); 

Trx = temperatura na saída do Riser ("C); 

Rtj= vazão de carga (m3/dia); 

Dtj = massa específica da carga (ton/m3); 

Pra = pressão na zona de reação (kgf7cm2); 

WHSV = velocidade espacial (ton cargalhltollcata!isador); 

Crc =teor de carbono no catalisador regenerado (%massa). 

O catalisador gasto - representado pelo catalisador que deixa o vaso separador, por 

sua vez, é dado por, 

dCsc ( ) Hra-- = Rrc. Crc2- Csc + 1 OO.Rcf 
dt (D.3) 

onde: Csc = teor de carbono no catalisador gasto (%massa); 

Crc2 = teor de carbono no catalisador regenerado (%massa); 

• Balanço de energia no Riser considerado como um reator CSTR, foi obtida a 

seguinte equação, 

Hris.Sc. dTrx = Sc.Rrc.(Trg2- Trx )+ Sj Dtf Rtf.(TJp- Trx )/1440 + 
dt 

-!llifvDtf /1440-M:lcr Roc 

onde: Hris = inventário de catalisador no Riser (ton); 

Se = calor especifico do catalisador, constante (kcallkg/"C); 

Trg2 = temperatura do leito do segundo estágio de regeneração ("C); 

(D.4) 



127 

Sf = calor específico da carga, constante e igual ao dos produtos 

(kcallkgf'C); 

1JP ~ temperatura da carga na entrada do Riser ("C); 

LM!fv ~ calor de vaporização da carga (kcallkg); 

LM!cr ~ calor de craqueamento (kcallkg); 

Roc ~ velocidade das reações de craqueamento (tonlmin). 

A velocidade das reações de craqueamento pode ser obtida por, 

A Dtf 
Roc=kcr.( )Rtj.-

1-A 1440, (D.S) 

onde kcr é uma constante obtida experimentalmente e A representa a severidade, sendo 

definida pela equação: 

A= 4040 _Pra.(c;or'.WHSV
0
·" .Exp( 1sooo ) 

Ccat.Crc 0 •06 R.(Trx + 273) (D.6) 

Na verdade, (MORO, 1995), a severidade da reação catalítica é determinada a 

partir da expressão: 

SEVCONT = 100. * A/(1.0+ A) 

A fração mássica da carga convertida pode ser obtida por, 

Roc 
Co11Versão (%m) 

1440.Rtf Dtj 

• Balanço de catalisador no vaso separador- é obtido por, 

(D.6a) 

(D.7) 



128 

dHra 
--=Rcr-Rsc 

dt 
(D.8) 

onde a vazão de catalisador gasto é manipulada por uma válvula situada no stand-pípe, 

controlada pelo controlador de nível do vaso separador. A vazão de catalisador 

depende do diferencial de pressão disponível para a válvula, que por sua vez, depende 

das pressões do reator e do regenerador e do nível do leito de catalisador, e pode ser 

escrita como, 

MLCv = Pra + yh + yhsp- Prg 

onde: L1PLcv = perda de carga disponível para a válvula; 

Pra = pressão no vaso separador; 

r= peso específico do catalisador fluidizado (assumido = 500kgf/m3); 

hsp = altura do stand-pipe (m); 

Prg = pressão do regenerador; 

A altura de catalisador no vaso separador h, é dada por, 

h=(Hra).Iooo 
p.A 

onde: p = massa específica do catalisador no vaso separador(= 500kg/m3); 

A =área transversal do vaso separador (m2). 

A vazão de catalisador através da válvula é, portanto, 

(D.9) 

(D.IO) 



129 

(D.ll) 

onde: ALcv = abertura da válvula; 

CVLcv =coeficiente de vazão. 

A dinâmica desta válvula, assim como de todas as outras, foi considerada de 

primeira ordem; então, 

dALCV -c 
--- .ALCV 

dt (D.l2) 

onde: C = saída do controlador do vaso separador. 

• Balanço de energia no vaso separador - considera apenas a capacidade ténnica do 

catalisador, desprezando o efeito do vapor e hidrocarbonetos. 

dTra 
Hra.-- = Rrc.Trx- Rsc.Tra 

dt (D.l3) 

• Balanço de energia no leito do primeiro estágio do regenerador - o regenerador é 

considerado um reator de mistura, com temperatura e concentrações homogêneas, 

calores específicos constantes na faixa de temperatura normal e considerando também 

que 10% do ar é arrastado para o segundo estágio, e é aquecida até a temperatura do 

leito mas não participa da reação de queima de coque. A equação obtida é, 

Hrgl.ScdTrgl Sc.Rsc.Tra-Sc.Rrcl.Trgl+ 
dt 

+0,0215.Sa.Rail.(Tai- Farl2.Trgl)+ 

- Fgkl.Sa.Trgl /1000- Mfrgl.Carbl.l2/I 000 

onde: Sa = calor especifico do ar e dos gases de combustão (kcal!kg0 C); 

(D.l4) 



130 

Rail =vazão de ar injetada no primeiro estágio de regeneração (k Nm3/h); 

Tai = temperatura do ar injetado ( 0 C); 

Far12 =vazão de ar arrastada para o segundo estágio, proporcional à vazão de 

catalisador ("' 1 O%); 

Fgkl = vazão de gases de combustão (kgmol/min); 

Carb 1 = carbono queimado (kgmollmin); 

iJF/rgl = calor de combustão do coque, considerado função apenas da relação 

C02/CO nos gases de combustão, sendo obtido a partir de, 

M!r 1 =(7831+ 
5416 )/(1+ 1 ) 

g (C02 /CO) (C02 /CO) (D.IS) 

onde esta equação considera apenas a queima de carbono grafite, desprezando o 

hidrogênio, enxofre, etc. 

A queima de coque na fase densa é representada pela reação: 

CHx(s) + [(fJ+2)12(j3+ 1) + xl4].02(g) --+ f3/(fJ+ l).CO(g) + 

+ Jl(jJ+l).C02(g) + xi2.H~(g), 

sendo que, na fase diluída, ocorre a reação, 

onde: CHx = coque depositado no catalisador; 

fJ = relação CO;/CO intrinseca no catalisador (moi/moi). 

A velocidade de queima de carbono é representada por, 



131 

K -EcfR.T c p rc=- co·e ·c·o2 (D.l6) 

onde: Kco =constante pré-exponencial (k:Pa-1 s-1); 

Ec/R = 18.900K; 

Cc = kg carbono/kg de catalisador, 

P02 =pressão parcial média logarítmica de Oz ao longo do leito (k:Pa); 

No trabalho de Moro foi utilizado uma equação aproximada para representar a 

velocidade de queima de coque, dada por, 

Rcbi = Kor.exp(-18.900/(Trgl + 273 ))Crcl.Ojgl.Pr g 

onde: Rcb 1 = velocidade de queima de coque (%C/min); 

Crcl =teor de carbono no catalisador do 12 estágio (%massa); 

Ofgl =teor de 02 no gás de combustão do 12 estágio (%vol); 

Prg = pressão do regenerador (kgf7cm2); 

Carb 1 = queima de carbono em kgmol/min, dada por: 

Carbl = IOI12.Rcbl.Hrgl 

(D.l7) 

• Balanço de carbono no catalisador do Regenerador - a equação que fornece a 

variação de carbono no catalisador do regenerador é: 

dCrci 
dt 

(Rsc.Csc- Rrcl.Crcl) 
Hrgl.Rcbl (D.l8) 

• Balanço de oxigênio nas fases densa e diluída - o oxigênio no gás do leito do 12 

estágio do regenerador é representado por, 



132 

Vdel.pm dOfg1 0,21.Rmail.FGm. Ojg1.10 Rcb1Hrg1Fat1 
100 dt 100 12 (D.19) 

onde: Vdel =volume da fase densa do IQ estágio (m3); 

P" = densidade molar dos gases de combustão (kgmol/m3); 

~ail =vazão molar de ar, já descontado arraste para 2Q estágio (kgmollmin); 

Ofgl = %molar de 02 nos gases de combustão na saída da fase densa; 

Fatl = relação molar 02 consumtaofC queimado, fornecida por: 

{ 0 +2) X 
Fat1= \fJ +-

2.(/3+1) 4 (D.20) 

Estes cálculos são repetidos de maneira análoga para o 2º estágio de regeneração. 

Na fase diluída do 1Q estágio é utilizado a equação: 

[ 
15.000 r j·5 r 1 n 1.5] 

Rco=-kc0 .exp ( . )t02 ·tCOvrg 
Tdll+273 (D.21) 

onde: Rco = em kgmol de CO/m3 s; 

[02] =%molar de 02 na fase diluída; 

[CO] = % molar de CO na fase diluída. 

O balanço de massa para o 02 é dado por: 

Vdil.pm d[OJ=FGm(Ofgl-[D2 D Rco 
100 dt 100 2.Vdil.60 (D.22) 



onde: Vdil =volume da fase diluída do 12 estágio (m3). 

• Balanço de Energia na fase diluída a equação que representa este balanço é, 

dTdil 
dt 

FG (Trgl- Tdil)+ 67636. Rco.60 
p.Vdil p.Sa 

onde: Tdil =temperatura da fase diluída do 12 estágio (0 C); 

FG = vazão de gases de combustão (kg/mín); 

p =densidade dos gases de combustão (kg/m3). 

133 

(D.23) 

Cálculo análogo é feito para a fase diluída do 22 estágio e para a fase diluída geral. 

• Balanço de pressão no regenerad.or - o balanço é feito considerando o regenerador 

como sendo apenas uma capacitância, de acordo com a equação, 

Vdii dp =Fi-Fo 
dt 

onde: Fi = vazão de gases de combustão gerados (kg/mín); 

(D.24) 

F o= vazão de gases de combustão enviados para a caldeira de CO (kg/mín). 

Foi considerado comportamento de gás ideal, então, 

PrgPM 
p = R.(Tdii + 273) 

onde: PM = peso molecular dos gases de combustão (kg/kgmol). 



134 

Daí, tem-se, 

Vdi! PM dPrg =Fi-Fo 
R.(Tdi+273) dt (D.25) 

onde Fo é controlado pela válvula slide de gases de combustão sob comando do 

controlador de pressão diferencial entre o regenerador e o reator. Esta válvula foi 

simulada de maneira semelhante às válvulas de catalisador. 

• Balanço de catalisador no leito t:kJ JQ estágio do regenerador - o nível de catalisador 

no 1 º estágio é dado por: 

h= Hrgi 
PcarArg! 

onde: Pcat = massa específica média do leito do 12 estágio (kg/m3); 

Arg! = área transversal do Iº estágio (m2). 

A vazão é dada por: 

Rrcl = K.(h- hv f' 

(D.26) 

(D.27) 

onde: Rrcl =vazão de catalisador do primeiro para o segundo estágio (ton/min); 

hv =altura do vertedor (4 m). 

O balanço de massa resulta em, 

dHrg! =Rsc-K.(h-hv}"" 
dt (D.28) 



135 

ANExo E 

ALGORITMO DE IDENTIFICAÇÃO DO PROCESSO EM REDES NEURAIS ARTIFICIAIS. 

É descrito a seguir o procedimento utilizado para identificação do modelo 

fenomenológico utilizando as redes neurais artificiais (DE SOUZA JR. 5, 1996). 

1- Utilizando a rotina computacional referente ao programa do modelo 

fenomenológico, foram obtidos três conjuntos de dados das variáveis manipuladas 

e controladas, grupo de treinamento, grupo de validação e grupo de teste; 

2- utilizando rede neural com esqueleto 5xHx4, foi obtida a primeira rede neural, 

fazendo H = 1, utilizando a primeira variável manipulada e as 4 variáveis 

controladas obtidas pela seqüência de treinamento em 1, grupo de treinamento; 

3- utilizando a outra seqüência, grupo de validação, foi realizada a validação da 

rede treinada; 

caso 3 a: a rede não converge, voltar para 1 e alterar o número de padrões de 

treinamento, ou o tempo de amostragem; 

caso 3 b: a rede converge, mas apresenta desempenho ruim, alterar H e voltar para 

2; 

caso 3 c: a rede converge, e apresenta bom desempenho na validação, testar a 

rede com a outra seqüência de dados, grupo de teste; 

caso 3d: a rede converge, mas o tempo de treinamento gasto é excessivo para ser 

utilizado num sistema com arquitetura MIMO mais complexa, retomar 

para 1 e obter outra seqüência de padrões (grupo de treinamento, grupo 

de validação e grupo de teste); 

caso 3 e: a rede converge, apresenta valores aceitáveis em todos os dados 

referentes à rede, obter mais algumas arquiteturas aumentando o valor 

de H, mantendo constantes os demais parâmetros obtidos em 3 d, para 

efetuar comparações de desempenho; 

5 DE SOUZA JR., M. B. Estudo Preliminar da teoria das ANN. Subrotinas OPTCG.FOR, OPTMU.FVR, 
MODTRAJN.FOR.. Revisão das subrotinas. Universidade Federal de Pernambuco- UFPE. Departamento de Engenharia 
Quimica - DEQ Laboratório de Simulação e Controle de Processos - LSCP©. 1996. Informação verbal. 



136 

4- capturar informações obtidas em 3 e, como número de nós na camada escondida, 

critério de convergência, número de padrões de treinamento, tempo de 

treinamento, intervalo de tempo de amostragem, valor da função objetivo, número 

de degraus aplicados na variável manipulada; 

5- repetir as ações retomando para 1, considerando a segunda variável manipulada, e 

assim sucessivamente até obter várias configurações de redes neurais para todas as 

variáveis manipuladas; 

6- utilizando a rede neural com esqueleto 8x:Hx4, fazendo H igual ao melhor valor 

obtido de H para cada variável manipulada em 5, testar diversas arquiteturas para 

comparações; 

7- selecionar a arquitetura que obteve melhor desempenho e menor tempo de 

treinamento, para ser o modelo em redes neurais. 



137 

APÊNDICES 



V SBAI 
V !lil!MPÓSIO BRASILEIRO OE AUTOMAÇÃO INTEL!GIENTE 

07 A 09 OE NOVEMBRO OE 200 1 
HtlTEL CONTINENTAL • CANELA, RS 

CERTIFICADO 

t:::E::RTIFICO ~UE WII...I..IAM 130NÇAI...VES VIEIRA 

PARTICIPOU DO V SIMPÓSIO BRASILEIRO DE AUTOMAÇÃO INTELIGENTE, 

REALIZADO DE 07 A 09 DE NOVEMBRO DE 2001 EM CANELA, RS. 

&lt;Z'J:;~) 

~
;/- /,)'./~ 

?-';'-&gt;'/·/ 
['/ ,/,l:a 
'v/ - --) .. ,.,_""-~ - . .-7 

P~. AI.EXA~I::H'tfl: SANFELIC!:: BAll:AN!i:LkA 
SZ$~~r?1\'#n·~ t"&gt;l" OOMi!íJ~Áí:J l;):õ~.f~.C\.t•;!;t.At&gt;tlr~4. 

1T ~ Ei? ~I) u.:te;, fi!J ~~ w ._, : . r \.~~· .. ,,,.,~,&gt;-""'~'"'"&gt;·'' .-.,.; ''-~"'"' ~--"-~" ' ""-~-.::..,' 
(;)t,f~J 

,.,~_.,, .. .-.,.,\&gt;.·~--- ,&gt;·~:-&gt;:N:~&gt; 

,;:; 
,_. 

~:; w 
\.0 



IDENTIFICAÇÃO DE PROCESSO DE UMA UNIDADE DE CRAQUEAMENTO 
CATALÍTICO UTILIZANDO REDE NEURAL. 

Vieira, W.G.\ Fileti, A.M.F. 2•; Carvalho, F.R3 
1CTEC/DEQ- Universidade Federal de Alagoas 

Maceió- AL- Brasil 57072-970 e-mail: wgy@fapeal.br 
2DESQIFEQ - Universidade Estadual de Campinas 

Campinas- SP- Brasil 13083-970 e-mail: frattini@desa.fea.unicamp.br 
3CTG/DEQ -Universidade Federal de Pernambuco 

Recife- PE Brasil 50740-521 e-mail: florival@npd.ufue.br 

141 

Este artigo descreve um procedimento de identificação, baseado em RNA, de um conversor Catalítico em 
Leito Fluido (FCC). Um modelo fenomenológico, validado com dados reais de operação, foi usado para gerar 
um conjunto de dados de variáveis operacionais. A panir do estado estacionário inicial foram aplicados vários 
degraus nas variáveis mauipuladas sendo gerados três grupos de dados para treinamento, validação e teste da 
rede respectivamente. Uma rede neural multicamada feedforward foi escolhida para a representar a FCC, 
sendo adotadas diferentes estratégias para sua arquitetura: na primeira, a camada de entrada foi formada por 
uma variável manipulada, e na segunda, foi formada de quatro variáveis mauipuladas. A camada de saída foi 
formada por quatro variáveis controladas. O número de nós na camada escondida foi obtido por tentativa-e-
erro. Das diversas estroturas propostas, as arquiteturas escolhidas para representar o modelo da FCC foram 
5xl5x4 e 8xl5x4 (IxHxO) com critério de convergência de 10'3 no gradiente da função objetivo. Em todos os 
testes, o erro relativo das variáveis de saída foi inferior a I%. Como resultado, foram desenvolvidos modelos 
em redes neurais confiáveis para a identificação de processo e eles poderão ser usados como modelo em uma 
estrutura de controle preditivo. 

INTRODUÇÃO 

O uso de métodos matemáticos complexos e mais precisos em engenharia de 
sistemas tem sido extensivamente encorajado pela introdução de computadores digitais de 
baixo custo e alta velocidade de processamento. Esta nova tecnologia permitiu o uso de 
rede neural artificial como metodologia para a identificação e controle de sistemas 
químicos. 

Qualquer processo químico linear ou não linear pode ser representado por um 
modelo em rede neural, mesmo quando os princípios termodinâmicos e cinéticos do 
processo são desconhecidos. Só os dados operacionais de entrada/saida são necessários [1]. 

Já foram feitas várias pesquisas baseadas em RNA: Narendra [2], resume a 
aplicação de RNA em Controle de Processo e descreve o último avanço nesta área. O autor 
compara as bases matemáticas das RNA e menciona algumas aplicações industriais de 
sucesso. Na área de identificação de processos, Nikravesh [3] explica um procedimento de 
treinamento backpropagation que é aplicado em um reator CSTR. 

De Souza Jr. [4] empregou uma RNA para classificação de processo onde a rede 
foi usada para predizer as propriedades de um catalisador em função das condições de 
processo de fabricação. O autor também usa a rede para a identificação de reatores não 
lineares com controle preditivo. Santos [5] reporta a aplicação de uma RNA para 
identificação e controle de um processo FCC e usa dois modelos de processo diferentes: um 
modelo simplificado "side-by-side" e um mais complexo, já validado com os dados da 
unidade industrial. O estudo foi restrito a uma estrutura SISO (Single Input and Single 
Output). 

* Autor para o qual toda a correspondência deve ser enviada. 



142 

A unidade de FCC é um dos processos mais importantes em refinarias de 
petróleo devido ao grande volume de produtos processados, seu rendimento e alto valor 
agregado. Um pequeno beneficio neste processo é economicamente atraente. Além disso, 
os regulamentos ambientais que restringem suas emissões poluentes como CO, C02, NOx 
e SOx, tomaram este controle muito importante, e devido às características deste processo, 
pode ser necessário um controle avançado. Porém, as unidades de FCC apresentam 
processos fisicamente complexos e diversas dificuldades para operar e controlar. As seções 
do regenerador e do reator das unidades de FCC são altamente interativas e com dinãmica 
dificil. O processo é pouco conhecido principalmente por causa da complexidade das 
cinéticas químicas envolvidas. Na prática, as unidades de FCC são reguladas 
freqüentemente por meio de controladores PID padrões e também por ações de controle 
manuais baseado no conhecimento dos operadores das refinarias. 

Uma estratégia de otimização não linear com restrição foi proposta por Ansari e 
Tadé [6] e aplicada à unidade de FCC. Um modelo dinãmico não linear do processo da 
FCC era usado para a análise da dinãmica da planta e para testes de um sistema de controle 
não linear multivariável. O modelo foi testado em uma aplicação em tempo real e os 
resultados foram usados para suprir os valores iniciais de projeto do sistema de controle não 
linear. Um algoritmo dinãmico de atualização de parâmetros foi usado para reduzir o efeito 
de erros de modelagem atualizando regularmente os parâmetros do modelo. O algoritmo de 
otimização não linear com restrição foi testado em tempo real no conjunto reator-
regenerador da unidade FCC. Os resultados concordaram favoravelmente aos resultados de 
um controlador multivariávellinear. 

Wang et al. [7,8] propuseram um estudo usando funções "wavelets" e redes 
neurais não supervisionada para extração das características da dinãmica transiente e 
identificação do estado operacional do processo da FCC. Esta ação conjunta se propôs a 
reduzir a extensão dos dados e remover os componentes ruídosos do processo. Aguilara et 
al. [9] utilizaram um projeto de controle regulatório para estabilização das temperaturas do 
reator e do regenerador de urna unidade de FCC, considerando as condições de cinéticas 
pouco conhecidas. A lei de controle proposta usa estimativas on-line de erros de 
modelagem de entrada/saída, obtidas através de um observador proporcional-integral de 
ordem reduzida. A estrutura do controlador proposta é semelhante a um compensador 
proporcional - duplo integral (PI2) com a nova parametrização do ganho do controlador 
sendo determinada em termos da malha fechada e constantes de tempo estimadas. O 
desempenho do esquema de controle proposto foi analisado por simulações numéricas. 
Antoniades e Christofides [10] propuseram urna metodologia para a síntese de 
controladores não lineares de realimentação para sistemas SISO não linear "Differential 
Difference Equation" (DDE) que incluem retardo de tempo no atuador de controle e no 
sensor de medida. O método de controle proposto foi aplicado com sucesso a uma unidade 
FCC onde foi mostrado que o desempenho do controlador não linear proposto não é afetado 
pela presença de tempo morto associada à malha de reciclo e aos dutos que transferem 
material do reator para o regenerador e vice-versa. 

Zanín et al. [11] descreveu a implementação de uma nova estratégia de otimização 
não convencional em tempo real aplicada na maximização da saída de LPG em um 
conversor FCC da refinaria de São José dos Campos no Brasil. Foi dado enfoque às 
dificuldades de otimização para os controladores existentes. Os primeiros testes efetuados 
foram descritos em detalhes. Eles mostraram que os beneficios da otimização não são 
restritos a fatores econômicos. A implementação da estratégia fornece meios de como 
mudar a forma de pensar dos operadores da unidade. A estratégia de otimização 



143 

implementada mostrou ser capaz de manter o controle da planta até mesmo na ausência 
do sinal de algumas variáveis manipuladas e na presença de fortes perturbações. Além 
disso, foi mostrado que a estratégia de otimização pode direcionar o processo para novos 
pontos operacionais. Sarma e Rengaswamy [12] usaram uma rede de controladores de 
lógica fuzzy (GS-FLCs), usando padrão sigmoidal (SGS). Esta estrutura não linear GS-FLC 
permite o uso de um desacoplador estático linear bastante simples (SLD). Esta técnica de 
controle foi aplicada em uma unidade de FCC, e o sistema multivariável GS-FLC/SLD 
demonstrou um bom desempenho de controle servindo como servo/regulatório e 
apresentando robustez. 

Do exposto acima, o problema de controle da unidade FCC tem sido amplamente 
abordado por várias metodologias. A identificação baseada em redes neurais pode fornecer 
ao projetista desta unidade um melhor entendimento da dinâmica do processo podendo ser 
útil como um modelo interno para um Controle Preditivo. O Modelo de Controle Preditivo 
é baseado em um indice de desempenho global com parametrização das variáveis de 
controle em um modelo não linear, com inclusão de algumas restrições de processo 
[13,14,15]. O processo da FCC representa um desafio onde beneficios significativos para 
indústria de processo e para teoria de controle poderiam ser alcançados. 

Neste trabalho é descrito o desenvolvimento de um modelo FCC usando RNA 
Este modelo representa um processo fortemente não linear, com restrições operacionais 
caracterizando um sistema MIMO (Multiple Input and Multiple Output). Além da não 
linearidade do processo e das restrições operacionais, é observado alto grau de interação 
entre suas variáveis. O estudo de caso escolhido para o presente desenvolvimento foi a 
Unidade de Craqueamento Catalitico em Leito Fluido (FCC) da refinaria Henrique Lage -
REV AP (São José dos Campos, SP, Brasil), através de seu respectivo modelo: Kellogg 
Orthoflow F. Moro [16] apresentou o modelo fenomenológico da Refinaria Henrique Lage 
da unidade FCC. Este modelo foi validado com os dados operacionais da unidade 
industrial. Para treinar a RNA, um simulador numérico baseado neste modelo 
fenomenológico foi usado no presente estudo para gerar um conjunto de dados de variáveis 
operacionais. São propostas diferentes arquiteturas de redes para representar o processo da 
FCC. 

DESCRIÇÃO DO PROCESSO 

O processo escolhido para estudo foi o do conversor (FCC) representado pelo 
modelo Kellogg Orthoflow F. da Unidade de Craqueamento Catalitico da Refinaria 
Henrique Lages da Petrobrás. O objetivo é reduzir o tamanho das redes hidrocarbônicas das 
frações mais pesadas do Petróleo por meio de reações cataliticas. Este processo é 
extremamente útil pois transforma produtos derivados de Petróleo de alto peso molecular e 
baixo valor comercial agregado em produtos de maior valor comercial. A Unidade de 
Craqueamento recebe como carga as correntes provenientes das seguintes unidades: 
Destilação à Vácuo, como Gasóleo e Resíduo de Vácuo, Unidade de Desasfaltação com 
Propano, como Óleo Desasfaltado. Como produtos gerados, tem-se: Gás Combustível; Gás 
Liquefeito de Petróleo (GLP); Nafta Craqueada; Óleo Leve de Reciclo (Light Cycle Oil-
LCO); Óleo Decantado também denominado Óleo Combustível de FCC ou Óleo 
Combustível Craqueado e Coque. Desses produtos, o que apresenta maior valor agregado é 
a Nafta Craqueada, utilizada como gasolina automotiva, sendo portanto esta a principal 
meta de uma unidade de craqueamento. O processo ocorre à temperaturas elevadas, na 
faixa de 500 a 550°C, em presença de um catalisador seletivo, à base de Zeólitas. O 



144 

catalisador se apresenta na forma de um pó branco de elevada porosidade e área 
específica, e, por apresentar dimensões tão pequenas, escoa corno se fosse um fluido, o que 
facilita seu manuseio. Devido às condições de temperatura do reator, ocorrem também 
reações secundárias indesejáveis, como formação de coque, polimerização e 
desidrogenação, com conseqüente deposição sobre a superficie do catalisador, reduzindo 
sua atividade. 

A unidade é composta de duas seções, urna de reação catalitica, onde ocorrem as 
reações de quebra de cadeia e também deposição de coque sobre o catalisador, e a outra 
onde ocorrem as reações de queima do coque, regenerando o catalisador (vide FIGURA 1). 
Desta forma o catalisador é circulado da seção de reação para a seção de regeneração, 
retomando para a seção de reação (vide FIGURA 2). A reação de regeneração é feita por 
queima com injeção de ar no regenerador. Devido às condições extremamente severas de 
operação, há necessidade de controle rigoroso de algumas variáveis operacionais 
(controladas), o que é feito direta ou indiretamente por meio de alterações em outras 
variáveis do processo (manipuladas). Diversas variáveis podem ser usadas corno controle 
na indústria. Neste estudo serão usadas as seguintes variáveis: temperatura de saída do 
reator (riser) - TRX; temperaturas das fases densas do primeiro e segundo estágios de 
regeneração - TRG 1 e TRG2; e conversão do reator - Severidade. As seguintes variáveis 
serão manipuladas: vazão da carga- RTF, vazão de catalisador regenerado- CTCV, vazão 
de ar para o regenerador - RA1 e temperatura da carga- TFP. Além dessas variáveis, 
também se deseja manter outras variáveis do processo dentro de seus limites de restrição: 
diferencial de pressão entre regenerador e conversor, temperatura da fase diluída do 22 

estágio do regenerador e temperatura da fase diluída geral. 

Produtos --___,f]-;::==~l 
Vaso 

Separador • -,....~ '-' 

Retificador 

Gases de 
Combustão 

Ar 
Ar 

Leito 
do 20 
Estágio 

Riser 

Carga 
Vapor 

de 
Dispersão 

Figura L Desenho esquemático da unidade de Craqueamento Catalitico 
da Refinaria Enri ne La e. 



145 

CATAI.JSADOR PRODUTOS 

GASTO 

REGENERADOR REATOR 

AR CATAUS.AOOR 

Fi 2. Desenho e emátíco da circulação do catalísador 

METODOLOGIA 

Redes neurais 

A RNA é formada por elementos processadores denominados de neurônios, nós ou 
nodos, interligados por canais chamados de conexões formando uma rede densa [ 4, 17]. Os 
nodos são organizados em camadas que unem a entrada com a saída. As conexões 
interligam os nodos de uma camada com os nodos de outra. O modo como os nodos são 
conectados e a disposição deles determina a arquitetura da rede. No presente estudo a rede 
foi configurada como multicamada totalmente "feedforward", com uma camada escondida 
e sem conexões de realimentação. As camadas escondidas são usadas para extrair da rede, 
resultados estatísticos de alta ordem [ 17]. 

Matematicamente, o comportamento de um neurônio em uma camada genérica 
pode ser representado por: 

onde: À representa a saída do neurônío 'j ', na camada ' k+ 1 '; 
S corresponde às saídas ou ativações de todos os neurônios da camada ' k '; 
w é o peso das conexões; 
8 é o limite interno de ativação do neurônio correspondente 'j ' (bias ). 

(1) 

Urna função de ativação, chamada de função de transferência do 
aplicada a f... No presente estudo foi usada a função sigmoidal, definida por: 

neurônío, é 

(2) 

O procedimento de aprendizagem é o processo onde os pesos e bias são 

modificados [18]. O treinamento supervisionado foi usado neste trabalho. Dados 

conhecidos de entrada e saída (padrões) são apresentados à rede. Então a rede é ajustada 

mudando os pesos e bias de acordo com regras predefinidas. Os padrões foram inicialmente 

normalizados para evitar diferenças de magnítude nos dados de entrada e saída [19]. 



146 

Devido ao uso da função sigrnoidal como função de transferência, a normalização 
foi feita para obter os padrões no intervalo positivo entre 0.0 e 1.0. Na realidade, foi 
escolhido um limite de intervalo entre 0.1 e 0.9 para permitir, se necessário pequenas 
extrapolações [5]. A seguinte expressão foi usada para o procedimento de normalização: 

Pnor = 0.1 +(p""1 = pmin Jx 0.8 
p""" pmin 

onde: Pnor representa o padrão normalizado; 

(3) 

Preaz é padrão nas unidades de entrada/saída e é obtido do modelo fenomenológico; 
p min é o limite inferior da variável; 
p max é o limite superior da variável. 

Os pesos e bias iniciais foram selecionados por uma rotina geradora de números 
aleatórios entre -1.0 e +1.0. O Algoritmo de Treinamento usado foi o Backpropagation, 
baseado na técnica de correção de erro. No processo de otimização foi usada a estratégia de 
"steepest descent" [ 4, 17]. 

OBTENÇÃO DO CONJUNTO DE DADOS 

O modelo fenomenológico desenvolvido por Moro [16] que representa a unidade 
de FCC foi usado para gerar os dados de processo para treinamento e teste do modelo em 
rede neural. 

Fazendo uso de simulações numéricas baseado no modelo fenomenológico, 
primeiramente foi obtido um estado estacionário inicial. Então, vários degraus foram 
aplicados nas variáveis manipuladas sendo monitoradas as respostas nas variáveis 
controladas. Foi observado que o tempo gasto em treinamento da rede é diretamente 
dependente do número de degraus aplicados à variável manipulada. Por outro lado, um 
número muito baixo de degraus poderia ser insuficiente para representar toda faixa 
operacional do processo. Na realidade, deve haver um compromisso entre o número de 
degraus a serem implementados e a variação total permitida às variáveis manipuladas. Foi 
usado inicialmente o range recomendado por Moro: 1,5 kNm3 Ih na variável RAI; 0,003 
unidades na variável CTCV; 50,0 m3/d na variável RTF e 2,2 °C na variável TFP. O 
intervalo de tempo entre dois degraus consecutivos deveria ser suficientemente grande para 
o processo atingir um novo estado estacionário antes da implementação do degrau seguinte. 
A Tabela 1 apresenta as variáveis manipuladas, os respectivos degraus impostos e o 
intervalo de tempo entre eles. 



147 

Tabela 1. Variáveis manipuladas, e suas re · as pertwbações impostas. 
Variáveis CONJUNTO DE 1REINAMENTO E V ALIDAÇAO CONJUNTO DE TESTE 

manipuladas Degrau(%) Temno (miu.) Degrau(%) Temno (miu.) 
CTCV -7,-12,-5,+2,+11,+4, o 270,300,300,300,600,600,300 +2,5; -2,5; o 320, 350, 350 

RAI -5, -9, -3, +1, +4, o 570,600,900,600,600,300 +2,5; -2,5; o 320, 350, 350 
RTF -6, -lO, -4, +2, +7, o 270,300,300,300,300,300 + 1,5; -1,5; o 320, 350, 350 
TFP -5, -8,5, -3, + 1, +4, o 270,300,300,300,300,300 +2,5; -2,5; o 320, 350, 350 

CTCV; -7,-12,-5,+2,+11, +4, O, 270, 300, 300, 300, 600,600,300, +2,5; -2,5; O; 320, 350, 350, 
RAI; -5, -9, -3, +1, +4, O, 600,600,900,600,600,300, +2,5; -2,5; O; 350, 350, 350, 
RTF; -6, -10, -4, +2, +7, O, 300,300,300,300,300,300, + 1,5; -1,5; O; 350, 350, 350, 
TFP -5, -8,5, -3, +1, +4, o 300,300,300,300,300,300 +2,5; -2,5; o 350, 350, 350 

Os dados obtidos do modelo fenomenológico foram divididos em 3 grupos: 
treinamento (se estes valores forem usados para o procedimento de aprendizado), validação 
(se usado para validação da rede treinada) e teste (se usado para teste final da rede neural). 
Estes grupos de dados foram obtidos sob condições específicas, ou seja: 

- Treinamento: tiradas amostras a cada 6 min., começando no 4° minuto; intervalo entre 
dois degraus sucessivos (veja Tabela. 1 ). 

- Validação: tiradas amostras a cada 2 min., começando no 4° minuto; intervalo entre 
dois degraus sucessivos (veja Tabela. 1 ). 

- Teste: tiradas amostras a cada 1 min., começando no 1° minuto; intervalo entre dois 
degraus sucessivos (veja Tabela. 1). 

Todos estes dados foram obtidos depois de atingido o estado estacionário inicial 
(30min.). 

Convém notar que a seqüência de degraus no teste é diferente da seqüência de 
degraus imposta para treinamento e da seqüência de validação. 

TREINAMENTO DA RNA 

Com os conjuntos de dados obtidos de simulações numéricas rigorosas, inicia-se o 
procedimento de aprendizagem. Urna rede multicamada feedforward completamente 
conectada foi escolhida para a representação da FCC. Foram adotadas duas estruturas 
diferentes para a arquitetura de rede: na primeira, a camada de entrada era formada por uma 
variável manipulada e quatro variáveis controladas, e na segunda estrutura por quatro 
variáveis manipuladas e quatro controladas. A camada de saída foi formada pelas quatro 
variáveis controladas. 

O número de nodos na camada escondida foi obtido por um procedimento de 
tentativa-e-erro. Observou-se que o aumento do número de nodos na camada escondida 
resultava em melhores resultados e tempo de treinamento inferior ao requerido com o 
aumento do número de camadas escondidas. Hiecht-Nielsen [20] já havia provado que 
qualquer função continua pode ser simulada com uma arquitetura de 3 camadas. Entretanto, 
deve haver neurônios suficientes na camada escondida. Então o uso de mais de uma 
camada escondida foi descartado. 

Uma vez determinado a arquitetura de rede, foi feito um estudo visando definir o 
número minimo de padrões a ser apresentado à rede durante o treinamento. Os dados foram 
escolhidos de forma a representar toda faixa operacional das variáveis. 

Inicialmente um número excessivo de padrões de treinamento (mais de 5000) foi 
usado. A convergência só foi atingida quando este número foi reduzido para menos de 1500 



148 

padrões, dependendo da precisão e do número de nodos na camada escondida. O 
critério de convergência usado variou de 10'9 a 10'3 no gradiente da função objetivo. O 
número denodos de 1, 2, 3, 4, 5, 6, 10, 15 e 20 foram testados na camada escondida. Um 
erro relativo inferior a 1% entre os resultados do modelo e os resultados da rede foi 
considerado suficiente para aceitação do procedimento de treinamento. 

RESULTADOS E CONCLUSÕES 

Modelagem em RNA 

A Tabela 2 mostra o tempo de CPU gasto no procedimento de treinamento com um PC Pentium II 
400 MHz. Também mostra o critério de convergência usado e o valor mínimo obtido para a função 
objetivo. Foram testadas ambas as estruturas descritas no item "Treinamento da RNA ". 

Variável manipnlada Tempo de CPU Critério de convergência Função objetivo 
(min) 

Primeira estrutura 
CTCV 320 8,49E-4 1,61E-l 
RAl 685 6,86E-4 8,26E-2 
RTF 356 7,81E-4 3,56E-2 
TFP 1029 4,37E-4 2,07E-2 

CTCV, RAI, RTF, TFP 
Segunda estrutura 

2589 I 5,26E-4 1,09E-l 

Após treinamento, foi executada a validação da rede com o conjunto de dados de 
validação. Foi utilizada outra seqüência de degraus. Após isso, foi realizado o teste final. 
Neste teste, na tentativa de simular as condições mais próximas da realidade de uma 
unidade industrial, foram adicionados ruídos randôrnicos a todos os sinais das variáveis 
controladas. 

Com um número reduzido de nodos (1 a 5) e usando como critério de 
convergência de I o-9 a I 0'3 no gradiente da função objetivo, a convergência não foi atingida 
ou algumas oscilações do processo não puderam ser capturadas em alguns testes o que 
poderia ser resultado de uma perda de generalidade. Aumentando o número de neurônios na 
camada escondida para IO, 15 e 20, os resultados foram considerados aceitáveis. Neste 
caso, para reduzir o tempo gasto no treinamento foi necessário uma mudança no critério de 
convergência para (10'3 e 10'2). O número de padrões também foi reduzido (IOOO padrões). 

Nas Figuras 3 e 4 é apresentado o comportamento das variáveis controladas para 
três degraus na variável manipulada CTCV. Os valores são mostrados de uma forma 
comparativa entre salda da rede (com ruído) e modelo rigoroso. Foram usados arquitetura 
5xi5x4 e critério de convergência de 10'3 no gradiente da função objetivo. Como pode ser 
observado, o erro relativo entre modelo rigoroso e rede praticamente desaparece para as 
variáveis TRGI e TRG2. Para Severidade e TRX, os erros relativos foram 
aproximadamente O.I5% e O.I %. 

Foram também dados degraus nas variáveis RAI, RTF e TFP. O comportamento 
foi similar ao obtido anteriormente e o erro relativo entre modelo em redes neurais e 
modelo rigoroso obtidos com o conjunto de dados de teste é mostrado em forma de 
dispersão nas Figuras 5 a IO. Deve ser notado que a seqüência de degraus de teste é 
diferente da seqüência imposta para treinamento e validação da rede. Estas figuras mostram 
a proximidade entre os resultados do modelo em redes neurais e os resultados obtidos por 
simulação rigorosa. 



a proximidade entre os resultados do modelo em redes neurais e os resultados obtidos 
por simulação rigorosa. 

---TRG1 Rede 
706 ---TRG2 Rede 

704 --- TR G 1 M odeio 
---TRG2 Modelo 

702 

700 

696 
~ .g 6674 
ffi .2-

J:!! l5 672 
~ ~ 
~ J 670 
l ~ 6 6 8 +--~---,.---~--.,--~---.---~--,.--~--, 
:E. o 200 400 600 800 1000 

Tempo (m in.) 

149 

Figura 3. Resposta comparative entre modelo rigoroso e modelo em rede neural para as variáveis TRGl e 
TRG2 com 3 de ns na variável mani ulada CTCV. 

--- S eve rída de R e de 
545 ---TRX Rede 
544 ---Severidade Modelo 

543 
---TRX Modelo 

542 

541 

540 
ü 
.!?-

~ (i) 78 ,O 

l -~ 
~ B 11.5 
"O 
ro ~ 

"' ~ 77 ,O ii; &gt; m 
~ 76.5 "' • o .... 200 400 600 800 1000 

Tempo (min.) 

Figura 4. Resposta comparativa entre modelo rigoroso e modelo em rede neural para as variáveis Severidade 
da reação catalítica e Tem ratura do Riser com 3 de ns na variável mani ulada CTCV. 



150 

78,4 

78,2 

78,0 

~77,8 

-8 77,6 
e 
Q,} 77,4 ., 
~ 77,2 

i 77,0 
cn 76,8 

76,6 

I • 

76,4 -!L,--,~-.-~-.-..-,~-.-~,.....,-,.~-,-,.--,~-, 
76,4 76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 

Severidade modelo(%) 

546 

544 

6 
..2- 542 
-1l 
e 
~ 540 
.... 

538 

I • DiSpersão I 

536-IL-.---.--~~-----...-----.--.---.-~ 
536 538 540 542 544 546 

TRX modelo (oC) 

Figuras 5 e 6. Resposta da dispersão relativa entre modelo rigoroso e rede neural para variáveis Severidade da 
reação catalítica e TRX com 3 de us na variável RAI. 

78,4 j ., Dispersao I 
78,2 

78,0 

* -77,8 ~ 
~ 77,6 

~ 77,4 

~ 77,2 
&gt; 

c1i 77,0 
76,8 

76,6 +L,-..,.--r~-r~,.....,_,.-r..,.---,-..,.-,-~,.-....-,c--&amp;lt;
76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 

Severidade modelo(%) 

546 

545 

544 

6 543 
e 
~ 542 

1;1 541 
.... 

540 

539 

I • Dispersao I 

538 +"----~.--,-,---r---.----.----.--.-, 
538 539 540 541 542 543 544 545 546 

TRX modelo (OC) 

Figuras 7 e 8. Resposta da dispersão relativa entre modelo rigoroso e rede neural para variáveis Severidade da 
reação catalítica e TRX com 3 de us na variável RTF. 

78,2 

78,0 

-77,8 

~ 
~ 77,6 
!1 
-1l nA 
~ 
êii 77,2 
~ 
(/) 77,0 

" Dispersao I 

76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 

Severidade modelo{%) 

546 

545 

544 

~543 
t 542 
~ 541 .... 

540 

539 

• DiSpersao I 

538.jL~----------~r-----------,.~--,.-, 
538 539 540 541 542 543 544 545 546 

TRX modelo (oC) 

Figuras 9 e 10. Resposta da dispersão relativa entre modelo rigoroso e rede neural para variáveis Severidade da 
reação catalítica e TRX com 3 de us na variável TFP. 

Os resultados para a segunda estrutura da rede (arquitetura 8x!Sx4) com critério 
de convergência de 10"3, é apresentado na Figura 11 (Severidade da reação de 



craqueamento ). A diferença entre modelo fenomenológico e rede pode ser melhor 
observada nas Figuras 12 e 13. 

7 9 .o 

7 8,5 

!E 
o 
'S. 

7 8,0 

~ 

~ 
~ 7 7,5 .., 
-8 = 7 7 ,O :g 
~ 
"' 76,5 

76,0 
1050 2100 

Tempo (min.) 

Resposta aos degraus nas 
4 variâveis manipuladas 
--Rede 

M odeio 

3150 4200 

151 

Figura 11. Resposta comparativa entre modelo rigoroso e modelo em rede neural para a variável Severidade da 
reação catalitica com 12 degraus em todas as variáveis manipuladas. 

78,6 

78,4 

78,2 

-78,0 

l!na . ' 
! 77,6 
~ 77,4 

~ 77,2 
~ 77,0 
"' 76,8 

76,6 

o Dispersão i 

76,4 -JL,~-~-,-~-,.-.-...,.-.....,--.-,-~....,..._., 
76,4 76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 78,6 

Severidade modelo(%) 

5&lt;8 

544 

6 
Ss42 

i 
1ii 540 
.... 

538 

Q Dispersao I 

538 540 542 544 

TRX modelo (oC) 

Figoras 12 e 13. Resposta da dispersão relativa entre modelo rigoroso e rede neural para variáveis Severidade 
da reação catalitica e TR.X com 12 de us em todas as variáveis. 

Dos resultados obtidos, as arquiteturas escolhidas para modelar a FCC em rede 
neural foram 5x15x4 e 8x15x4. Em todos os testes realizados o erro relativo das variáveis 
de saída foi inferior a 1%. Como resultado, foram obtidos modelos de rede neural 
confiáveis para a identificação de processo e eles poderão ser usados como modelo em uma 
estrutura de controle preditivo para o controle da FCC. 

OBSERVAÇÕES FINAIS 

Este trabalho descreve um procedimento de identificação, baseado em redes 
neuraís artificiaís, de um Conversor de Craqueamento Catalítico em Leito Fluido. Um 
modelo fenomenológico, validado com dados reaís de operação de um conversor Kellogg 
Orthoflow F., foi usado para gerar um conjunto de dados de variáveis operacionaís. Uma 
rede multicamada feedforward totalmente conectada foi escolhida para a representação da 



152 

FCC. Foram adotadas duas estratégias diferentes para a arquitetura de rede: na 
primeira, a camada de entrada era composta por uma variável manipulada e quatro 
variáveis controladas, e na segunda estrutura, era composta de quatro variáveis 
manipuladas e quatro variáveis controladas. A vantagem principal de redes neurais em 
comparação ao modelo fenomenológico é o menor tempo gasto de processamento da CPU 
o que viabiliza sua aplicação como modelo num controle preditivo. Além disso, foi 
mostrado também que ambas as estruturas propostas fornecem predições de alta qualidade 
das variáveis controladas. Dos resultados, as arquiteturas escolhidas para representar o 
modelo FCC em redes neurais foram 5xl5x4 e 8xl5x4. Em todos os testes, o erro relativo 
das variáveis de saída foram inferiores a I%. Como resultado, foram obtidos modelos de 
rede neural confiáveis para a identificação de processo e eles poderão ser usados como 
modelo em urna estrutura de controle preditivo para o controle do conversor FCC. 

REFERÊNCIAS BIBLIOGRÁFICAS 
I Narendra, K. S. &amp;amp; Mukhopadhyay, S., 1997, 'Adaptive Control Using Neural 

Networks and Approximate Models'. IEEE Transactions on Neural Networks, 8(3), pp. 
475-485. 

2 Narendra, K. S., 1996, 'Neural Networks for Control: Theory and Practice'. 
Proceeding ofthe IEEE, vol. 84(10), pp. 1385-1406. 

3 Nikravesh, M. Fareli, A E. And Stanford, T. G., 1996, 'Model Identification of 
Nonlinear Time Variant Process via Artificial Neural Network'. Computers and 
Chemical Engineering, 20(11), pp. 1277-1290. 

4 De Souza Jr, M. B. (1993) 'Redes Neuronais Multicamadas Aplicadas a Modelagem e 
Controle de Processos Químicos'. Dr. Thesis, COPPEIUFRJ, Brazil. 

5 Santos, V. M. L., Carvalho, F. R. And De Souza Jr, M. B. (2000) 'Predictive Control 
Based on Neural Networks: An Application to a Fluid Catalytic Cracking Industrial 
Unit'. Brazilian Joumal ojChemical Engineering. 17(04-07), pp. 897. 

6 Ansari, R. M. and Tadé, M. O. (2000) 'Constrained nonlinear multivariable control of 
a fluid catalytic cracking process'. Joumal of Process Contra/I O, pp. 539-555. 

7 Wang, X. Z., Chen, B. H., Yang, S. H., C. McGreavy. (1999) 'Application ofwavelets 
and neural networks to diagnostic system development, 1, feature extraction'. 
Computers and Chemical Engineering 23, pp. 899-906. 

8 Wang, X. Z., Chen, B. H., Yang, S. H., C. McGreavy. (1999) 'Application ofwavelets 
and neural networks to diagnostic system development, 2, an integrated framework and 
its application'. Computers and Chemical Engineering 23 pp. 945-954. 

9 Aguilara, R., González, J, Ramirez, J. A., Barrón, M. (1999) 'Control of a fluid 
catalytic cracking unit based on proportional-integral reduced order observers'. Joumal 
ofChemical Engineering 75 pp. 77-85. 

10 Antoniades, C., Christofides, P. D. (1999) 'Feedback control of nonlinear differential 
difference equation systems'. Chemical Engineering Science 54 pp. 5677-5709. 

11 Zanin, A C., M. Tvrzská de Gouvêa, M. and Odloak, D. (2000) 'Industrial 
implementation of a real-time optimization strategy for maximizing production ofLPG 
in a FCC unit'. Computers and Chemical Engineering 24 pp. 525-531. 

12 Sarma, P. and Rengaswamy, R. (2000) 'Multivariable gain-scheduled fuzzy logic 
control of a fluidized catalytic cracker unit'. Computers and Chemical Engineering 24 
pp. 1083-1089. 



13 Balchen, J.G., Lungquist D. and Strand S., (1992) 'State-space predictive control', 
Chemical Engineering Sei. 47 pp. 787-798. 

153 

14 Grosdidier P., Mason A., Aitolahti A., Vanhumaki V., (1993) 'FCC Unit 
Regenerator/reactor control', Computers and Chemical Engineering 17 pp. 165-179. 

15 Ali, E.E. and Elnashaie, S., (1997) 'Nonlinear model predictive control of industrial 
type IV :fluid catalytic cracking (FCC) units for maximum gasoline yield', lnd. and 
Engng. Chem. Res. 36 pp. 389-398. 

16 Moro, L. F. L. (1992) 'Desenvolvimento de um controlador preditivo multivariável 
para um conversor industrial de Craqueamento Catalítico'. MSc. Thesis, USP/SP, 
Brazil. 

17 Haykin, S. (1994) 'Neural Networks - A Comprehensive Foundation' Macrnillan 
Publishing Co. NJ, 696p. 

18 Simpson, P. K. (1990) 'Artificial Neural Systems: Foundations, Paradigms, 
Applications and Implementations'. Pergamon Press, Inc., NY, 203p. 

19 Baughman, D. R. &amp;amp; Liu, Y. A (1995) 'Neural Networks in Bioprocessing and 
Chernical Engineering'. Acadernic Press, Inc. London, 489p. 

20 Hecht-Nielsen, R. (1989) 'Theory ofthe Backpropagation Neural Network', IEEE Int. 
Conf On Neural Networks, I, pp. 593-605. 



hstituto Supericr Politécnico José Antonio Echeverría 
Facultad de lngeniería Química 

111 Tdler Internacional de Análisis de Procesos 
('iudad de laHabana. Cuba, 24 alUi de abril 2002 

CYECJ('fiP I CJ?ICJ)O 

,\; VV.G. v;eitH: A.M F f;iE1ti, F.H Carv&lt;~!ho; J./1 F.R. Peretra 

t•or su flll.rlidJ!:H:iún cn cl Talln c ou el tJ·aba,jo 

fC(, UNrr MUL T!i.//IRVUJLC f&gt;Rl~ OíC TiVE CON JF?Ol. WITH ANN .'v10DELING 

,, .;~ ,L.JI"t.:\ 
: y ,,~_. 
,f r. 

··,. 

Of&lt;; M',;Fit.~~1 Gu,lerte2: OtJqoc 
P((~sir.jm~te Cornfté OP{Jant;:;;tlj{)~ 

·., r· t /.4 
Dr~J. Lourdes Zuri.a1af;_~r;:4tfuy de Cardenas 

· Decana I 

f-' 
01 
01 



FCC UNIT: MUL TIVARIABLE PREDICTIVE CONTROL WITH ANN MODELING. 

Vieira, W.G. 1"; Fileti, A.M.F. 2; Carvalho, F.R.3 ; Pereira, J.A.F.R2 

1- CTEC/DEQ- Universidade Federal de Alagoas 57072-970 Maceió- AL- Brasil 
E-mail: wvieira@ctec.ufal.br 

157 

2- DESQ/FEQ - Universidade Estadual de Campinas 13083-970 Campinas - SP -
Brasil E-mail: frattini@desq.feg.unicamp.br e pereira@desg.feq.unicamp.br 

3- CTG/DEQ- Universidade Federal de Pernambuco 50740-521 Recife- PE- Brasil 
E-mail: florival@npd.ufpe.br 

ABSTRACT: This paper propose a Multivariable Predictive Control using Artificial 
Neural Networks (ANN) as model of a nonlinear process. A phenomenological model 
that represent the FCC unit of the Henrique Lage refinery was used to obtain the 
ANN model. The regenerator and the reactor sections of FCC units are highly 
interactive with difficult dynamics, thus this units are process physically complex and 
prove several difficulties to operate and control. This phenomenological model was 
already validated with the data of the own industrial unit being therefore appropriated 
for this purpose. The FCC process variables controlled were: the temperatura of the 
regenerator first stage, the temperatura of the regenerator second stage, the 
temperatura of the mixture in riser and the severity of the cracking catalytic reaction; 
as manipulated variables were used: regenerated catalyst flowrate at riser, air 
flowrate at regenerator first and second stages, the feed flowrate at riser entrance 
and the feed temperatura at riser entrance. The purpose is maximizing production, 
trying to reach the optimized conversion maintaining the control variables inside of a 
restriction range even for the disturbances in the system. The predictive control 
presented good performance, when compared with the system without control in ali 
the tested situations, taking the controlled variables to its set points. 

keywords: multivariable predictive control, artificial neural networks, FCC. 

1 INTRODUCTION 
The FCC process represents a challenge for process industry and for control 

theory in function of its high complexity and operation difficulty. This unit represents the 
most important process in refineries of petroleum due to the higher commercial values of 
its products. A small benefit in this process is economically attractive. Several authors 
presented studies involving the FCC unit. SANTOS (2000), was presented as MSc. thesis 
theme a study involving the FCC unit, using ANN (Artificial Neural Network) in the process 
identification. This study was limited to a SISO (Single lnput and Single Output) system. 
The control of the FCC process, using the model developed in the identification system 
also was proposed. The results were shown satisfactory. The same routine developed by 
CASTIER (1990) and De SOUZA Jr. (1993) it was used in her study. Ansari and Tadé 
(2000) presented a strategy of nonlinear optimization with restriction applied to the FCC 
unit. In their study a nonlinear dynamic model of the process was used for a multivariable 
control system. Aguilara et ai. (1999) used a project of regulatory control for stabilization of 
the reactor and the regenerator temperaturas of FCC unit. Zanin et ai. (2000) describe the 
implementation of a new strategy of non conventional optimization in real time applied in a 
FCC converter. As observed, in ali these studies, a neural networks model study involving 
the main variables of the FCC unit assorted was not still realized. 

* Whom ali correspondence should be addressed. 



158 

FCC converter. As observed, in ali these studies, a neural networks model study 
involving the main variables of the FCC unit assorted was not still realized. 

Any linear or nonlinear chemical process can be simulated through a neural 
network modeling, even when the first principies of the process are unknown. Just 
inputloutput operational datais needed (NARENDRA &amp;amp; MUKHOPADHYAY, 1997). 

Several researches were already made based on ANN: NARENDRA (1996), 
summarizes the application of ANN in process control and describes the last advances in 
this area. The author compares ANN's mathematical bases and some successful industrial 
applications are mentioned. 

WANG et ai., (1998) presented a strategy of predictive control where a nonlinear 
process was modeled using ANN. lts studies were limited to the case of optimization 
where just one control action is involved, obviously the complexity of the problem 
increases when the number of variables grows. ZHAN &amp;amp; ISHIDA, (1997) presented a study 
for the predictive control model in nonlinear process with single input and single output 
(SISO). The basic objective in their works was select a group of futures control actions that 
minimized a objective function based on the technique of predictive modeling with process 
restrictions. They concluded that the deviation found between the model and the real 
system was due to absence of infonnation in the non stable area, but even thus the model 
follow the real profile. 

De Souza Jr. (1993) employed an ANN for process classification, where the 
network was used to predict the properties of a catalyst in function of the conditions of the 
manufacture process. The author also used the network for the identification of nonlinear 
reactors within a predictive controlloop. In its work, he obtained satisfactory results, using 
the backpropagation training method with the steepest descent minimization technique. lt 
was already used in its Dr. thesis a existent routine, based on the Castier study (CASTIER 
1990) that calculates the conjugated gradient using the FLETCHER and REEVES (1964) 
routine. He adapted this routine in Fortran language for its conditions. 

Until now none application of ANN in nonlinear multivariable control process with 
high interaction among its operational variables and with strong process restrictions was 
made. 

The purpose of this work is get an altemative strategy of predictive control using 
ANN model, applied to a multivariable nonlinear process with restrictions. A 
phenomenological model that represent the FCC unit, Kellog Orthoflow F. model was used 
for identification in neural networks (Vieira, et ai., 2001). This model was validated with the 
operational data of the industrial unit by MORO (1992), in his MSc. thesis using a 
simulator developed by KURIHARA (1967). The fact of the model have been validated with 
the operational data of the industrial unit make the simulator suitable for the control 
purposed. In the present study, will be use the same routine developed by CASTIER 
(1990) and De SOUZA Jr. (1993), being necessary some fittings to adapt it to the 
proposed problem. 

In the session 2 it is made a brief Process Description. The Methodology is 
presented in the session 3, the Open System in the session 3.1. the Conventional Control 
of FCC in the session 3.2. and the Predictive Control in the session 3.3. The Results are 
presented in the session 4 and the References are presented in the session 5. 

2 PROCESS DESCRIPTION 
The Fluid Catalytic Cracking (FCC) unit represented by the Kellogg Orthoflow F. 

model of the Henrique Lage Refinery of Petrobrás was the process chosen for this study. 
The converter is supposed to reduce the size of the hydrocarbon chains of the heavy 
petroleum fractions through catalytic reactions. This process is extremely important 
because derived products of petroleum of high molecular weight (that possessas little 
application and therefore lower commercial value) are transformed in products of higher 



159 

commercial values. The FCC unit inputs are the outputs of the following units: Vacuum 
Distillation (Gas-oil and Vacuum Residue) and Unit of Treatment with Propane (Heavy Oil). 
As products, it is obtained: Fuel Gas, Liquefied Gas of Petroleum (GLP), Cracked 
Naphtha, Light Cycle Oil (LCO), Decanted Oil (also denominated Fuel Oil of FCC or 
Cracked Fuel Oil) and Coke. These high-value products are called Cracked Naphtha, 
mainly used as automotive gasoline. High temperatura is needed (from 500°C to 550°C) in 
presence of a selective catalyst. The catalyst is used in the form of a white powder with 
high porosity and specific area. Because of the small dimensions, it flows as if it was a 
fluid. Due to the operational temperatura range, undesirable secondary reactions occur, 
such as coke formation, polymerization and dehydrogenating. As a consequence coke 
deposition on the surface of the catalyst occurs and therefore the catalyst activity is 
reduced. 

The unit is composed of two sections: one of catalytic reaction, where the reactions 
of chain break and also coke deposition on the catalyst take place; and the other, where 
bum of the coke occurs, regenerating the catalyst (see Figure 1). Then the catalyst is 
forced to pass from the reaction section to the regeneration section, and finally coming 
back for the reaction section (see Figure 2). The regeneration reaction is carried out 
through air injection and buming in the regenerator. 

Products---:::J_j 

Separator 

Aír to' first sta 

Air to second sta 

Figure 1 Schematic draw of the FCC of Henrique Lage Refinery. 

Due to the extremely severe conditions of operation, rigorous control of some 
operational variable (controlled) is needed. Severa! variables can be taken as controlled in 
the industry. In this study the following variables will be used: temperatura of cracking 
mixture in riser (TRX), temperatura of dense phase at regenerator first and second stages 
(TRG1 and TRG2) and conversion of the reactor (Severity of the cracking reaction). The 
following variables will be manipulated: total feed flowrate to riser (RTF), regenerated 



160 

catalyst valve opening (CTCV), air flowrate to regenerator (RAI) and feed temperatura 
at riser entrance (TFP). Besides these variables, the process requires the maintenance of 
other variables between their restriction limits, such as: differential pressure on the reactor 
levei control valve, temperatura of the regenerator first stage di lute phase and temperatura 
of the regenerator global dilute phase. 

3 METHODOLOGY 
The predictive control, has this denomination due to the form as the calculation of 

the control law is made, that is, in the current instant, called "k" instant is made the 
forecast of the process for future instants, "k+1", "k+2", ... , "k+Np", where Np is 
denominated prediction horizon. By a model, previously defined, forecasts of the answers 
of the process simulating alterations in the manipulated variables for Nc future instants are 
made; Nc represents the control horizon. The manipulated variables that supply only 
answers with certain characteristics are selected. Then, the first prediction action is 
implemented in the control. After implementation, the time is updated for "k+1" and the 
calculation is repeated. Usually, the approach among the predicted response and the wish 
response is adopted for choice of the contrai action. This comparison is made by means of 
minimization of algebraic equations. These equations are functions of the predicted control 
variable - y, the manipulated variable - u and a set point - sp. Then, the future error is 
minimized, and if the chosen model represents exactly the process and if disturbances 
don't happen, the process will follow the reference trajectory faithfully (FILETI, 1998). 

The algebraic equation is defined by, 

N, Nç 

i= ~:;a.{Y.(k+l)-sp.(k +l)f + LÀ,(u;(k)-u;(k -l)f 
i:l r-o 

subject the following restrictions: 

Y,;, sy(k+i)sy-,i=1, ... ,NP 

umin S u(k +i -1) $ umáx,i = 1, ... ,NP 
[u(k+i)-u(k+i -1)]5 ~=,i =1, ... .,Nc (3.1) 

where .:t are the weights used to avoid excessiva variations of the manipulated variable, 
and a are the tune weights used in the controlled variables, the indexes q and r represent 
the controlled variables and manipulated variables, respectively. 

The reference trajectory for the control strategy is given by: 

y,p(k)=y(k) 

y~+i) = j]y';i-1 + (1- [J)sp (3.2) 

where fJ assumes one of the following values: 0,85; 0,90; 0.95 and 0,97, depends on the 
control tune. Each prediction of the neural network was corrected by: 

c(k)=y(k)- y(k lk-1) 

The corrected prediction is: 

Yc(k +llk)= y(k+11 k)+c(k) (3.3) 



161 

where y(k) it is the real output of the process in time "k'', .Y(k 1 k -1) the prediction of 

variable yfor the instant "k" obtained by the neural network in time "k-1" and Yc(k I k + 1) is 
the corrected predicted variable. 

3. 1 Open System 
The same disturbances proposed for the control test were imposed to the model 

in open loop, using the phenomenological model routine. Then is hopes to get to 
accomplish a comparison among the tests with and without control action. The results of 
the behavior of the model without control action and the results obtained with the control 
action were shown in graphs forrns (Figures 5 to 7). 

3.2 FCC usual control 
lnitially, a description of the FCC conventional control is presented. The Figure 3 

is useful for its understanding. 
The feed usually coming from the tank system and it has an independent control. 

lt is heated up in a feed heating. The temperatura of this stream is controlled by a feed fuel 
control. The temperatura of "Riser" output is controlled by the regenerated catalyst valve. 
The catalyst levei in the separator vessel is controlled by the spent catalyst valve. The 
temperaturas of the dense and diluted beds phases are controlled by air flowrate to 
regenerator. The reactor and regenerator pressure differential is controlled by combustion 
gases valve. 

Figure 3 Schematic draw of FCC conventional control 

3.3 Predictive Control 
The computational control routine was developed using Fortran language, being 

inserted in phenomenological model routine. The minimization process (minimization of 
objective function) was accomplished using the NCONF routine, of the IMSL Fortran 
Library. This routine implements the Successive Quadratic Programming - SQP and the 
Finite Difference Gradient method, but the sources programs don't allow access. The 
manipulated and controlled variables were norrnalized in the same shape of the 



162 

normalization method used in the process identification, when the neural network was 
developed (Vieira, et ai., 2001). 

The model in neural networks was trained considering the action of degrees in 
each variable manipulated individually, but the DNC (Dynamic Networks Control), foresees 
the performance in the whole manipulated variables simultaneously. The diagram of the 
Figure 4 show an outline of a predictive control using ANN. 

'u" - 'y" input 
ínk-lmuik . 'y"-ín 

IIBURAL k+l 
RE'l'WDIIKS 

'u" input 
ínk 

I DP'f'IIIIIIZilll I.BD:or 
+ 

Toprocess 
I. 

-

Figure 4 Schematic draw of DNC using ANN. 

The Figure 5 show a sketch of the proposed control system, already coupled to 
the conventional system. 

The control action can be obtained with optimization strategies of the plant. These 
strategies are obtained by externai actions, where it can be determined which variable will 
be manipulated changing its restriction limits. Two strategies of optimization have interest 
in industrial plant: the first one is the maximization orthe minimization production strategy, 
by RTF variable; the second strategy is, the change the objective of lhe uni! to produce 
GLP instead of Naphtha, by TRX variable. 

U,Y 
r I Raslrictions 

Pror:luc1s .. L 
"""""" 

Prediclion H :Dblecttve 
,------ ( ----@ llodel !WIOtlon - --- --
i V t setpoints 
i~ I DNCI 

Combustlon 
i.~ 

" I I i -~ ' r= " @-i r;, ' DC 
' 

Heater 

r------------. r- ' rR FC ' ' t i .--z&amp;amp; :: I ::: ~~ 
j l k. j ~ i tr- Fesd from 
:AU~ 'Jtf : , ____ Tank i L. ___ , i ®®~ i JJr ~~ L-------~ Puelgas to Haatet 
~----------L----------------Q)-

F1gure 5 DNC proposed coupled to the convent10nal system 

By mathematical simulation through the phenomenological model (ODLOAK, 1997) 
were obtained the data of the controlled and manipulated variables that com pose lhe input 
to the DNC control. With this data the optimization routine is called and the predictions of 



163 

the actions in the manipulated variables are done. The ANN is used to get the 
response of those actions in the controlled variables in every prediction horizon (Np). The 
results of those predictions supply the control actions in every control horizon (Nc). After 
the actions that minimize the differences among the reference trajectories in the control 
horizon be selected, the first control action is sent to the phenomenological model program 
to print the results, then the control program is await for new sampling instant, and the 
cycle begin again. 

The DNC test were simulate 800 minutas, with control action beginning from the 
100th minute, a disturbance beginning from the 400th minutas. The program simulator 
(phenomenological model) begins out of the stead state, denominated of initial condition of 
operation; therefore, after beginning of the control action, time 100 minutas, the controller 
begins an action of taking the variables controlled for its set points. This justifies the 
change observed in ali the graphs in the interval among 1 00 minutas and 400 minutas. 

A noise by 1,5% of intensity was inserted in the signs of the controlled variables 
before the called of the optimization program, in the attempt of approaching the simulator 
to the real conditions of operation; nevertheless, the neural network was capable to predict 
the behavior of the model for ali varíables involved in the process. 
4.RESULTS 

For test simulation was intend to apply a disturb in degree form in temperatura of the 
air to the regenerator, TAl varíable, altering its value in +8%. The sampling of 4,0 in 4,0 
minutas was considered, with Np equal to 10, and Nc equal to 1. The weight factors À.; 
were: 1 ,Oe-3 for TFP, 3,0e-4 forRAI, 6,0e-4 for RTF, and 5,0e-2 for CTCV; and the weight 
factors lX/, that define the relevance of each controlled variable, were: 1,0e-3 for TRG1, 
1 ,Oe-5 for TRG2, 1 ,Oe-4 for SEV and 5,0e-3 for TRX. The filter used for the reference 
trajectory was 9,0e-1 for ali varíables, and the optimization strategy considered for the test 
was to fix the feed flowrate to riser, varíable RTF. 

The graphs of the Figures 6 to 13 show the responses to the disturbance of 8% in 
variable TAl; these responses are presented in comparativa form among the results with 
control action (fullline) and without control action or open system (dash line). 

Comparison among the responses: 
open loop system and controlloop 

--contrai system 

706 
----- open loop system 

p 

~ 
9l 704 

---- ... ;., --:-:J ~;;;~;;-~-;;;;. .. .I:. Q. 
"' 

702 
11) 
c 
"' .., 700~ 
õ 

' -' 
"' 674- t\ ':~~~:::~-,-~,==:~ -:::1 1ii -!. 672 ---·---------------~~ 
E setpoint 
~ ' 670 - --

o 100 200 300 400 500 600 700 800 
Time (min.) 

Ftgure 6 Response m Regenerator after d1sturbance m TAl vanable. 
Comparison among open loop (dash line) and control loop (full 
line). 



164 

Comparison among the responses: 

78,2 
open loop system and controlloop 

control --control system 

- 78,1-
begining ----- open loop system 

~ 

0 distu rbance o -t 
78,0 begining ,-, 

c ; -'------------------77,9 ' ' ; ' Cll ' c 77,8 ' ' :si! ' 
~ 77,7 iA u õ 
~ 77,6 

' ~point j 77,5 _-/! --- ---
77,4 

o 100 200 300 400 500 600 700 800 
Time(min.) 

F1gure 7 Response m Severity of catalyt1c reacbon afler d1sturbance m TAl 
variable. Comparison among open loop (dash line) and control 
loop (full line). 

Comparison among the responses: 

open loop system and controlloop 
546,0 --control system 

545,5 
----- open loop system 

control 
disturoance 

6 545,0- begíning beginíng 
"-

D c ~ 544,5 , ... -....... ----------------' 1- ' • ' 544,0- ' Cl) ' -:::1 
' 1ii 543,5- ' - ' 8. ' 

543,0 ' E ' ' {!!. ' ' - 542,5- .--/'' / Cl) .. 
iE 542,0- Set point 

541,5 
o 100 200 300 400 500 600 700 800 

Time (min.) 

Figure 8 Response in Riser output after disturbance in TAl variable. 
Comparison among open loop (dash line) and control loop (full 
line). 

The elevation of TAl results in an immediate elevation of TRG1 and TGR2, that 
results too in the elevation of the temperature of the regenerated catalyst that also 
elevated TRX and SEV. These increases were corrected simultaneously by the contrai 



165 

action that reduced the air flowrate to regenerator, reduced toe the catalyst flowrate to 
riser, by reducing the CTCV variable and the TFP, gradually. The feed flowrate to riser 
(see Figure 11) was maintained fixed as it was defined. 

The TRG2 and TRX variables stay close to its set points; in the TRG2 variable that is 
justified due to the fixed rate among the air to first and to second stage; in the TRX 
variable that is justified by an interdependence observed between this variable and the 
severity of the catalytic reaction; but despite this, these results were considered 
satisfactory. 

224 

(1)~223 
.§.. 

~222 
' ~ 

control 
begining 

D 

Manipulated variable 
--RAI 

disturbance 
begining 

G 
s ---1! 221 +--+-------- 1\ 
~ ., 
ª'220 s ., 
!! 219 
~ 
~2181-~-+--~~-T-,--~~~--------~-.~-. 
&lt;f o 1 oo 2ào 3oo 400 5oo 6oo 100 800 

Time (min.) 

Figure 9 Optimizer action in manipulated variable- RAI, after disturbance in 
TAl variable. 

Manipulated variable 

~ 
0,83 --CTCV 

control 
0,82 begining disturbance 

.;. 0,82 

i) 
begining 

c Cí 1 0,82 
o o 82 ., ' 
.=: 

0,82 !l! 
li 0,81 

i 0,81 
ãl 0,81 
! ., 0,81 c ., 
~ 0,81 

o 100 200 300 400 500 600 700 800 
Time (min.) 

Figure 1 O Optimizer action in manipulated variable - CTCV, after 
disturbance in T AI variable. 



166 

406,0 

:ê 
~'E 4os.5 

~ 
~ 405,0 
• 

. ~ 404,5 
s 
~ 404,0 

g = 403,5-
! 

control 
begining 

D 

Manipulated variable 
--RTF 

disturbance 

s 403,0 +-~-+~-..~-.--,-~-1--_.,......!.---.--~-,-~---, s o 1 00 200 300 400 500 600 700 800 
Time (min.) 

Figure 11 Optimizer action in manipulated variable - RTF (fixing this 
variable as wished) after disturbance in TAl variable. 

I Manipulated variable 
I --TFP 

6' 236,5 
.S.. centro! disturbance 
11. begining begining 

~ 236.0 I) G 
~ 235,5 

~ /[\ 
5l 235,0 +---+------
·c 
~ e 234,5 
! 
l'i. 234,0 

~ 
i 233,5 +---r--,.-~-,.-.~-,f--,.--,,--.... --.--.----.. • 
.! o 100 200 300 400 500 600 700 800 

Time(min.) 

Figure 12 Optimizer action in manipulated variable - TFP, after disturbance 
in T AI variable. 

The test was done too with change in operational strategy producing GLP despite of 
Nafta and the results were too satisfactory. 

The control proposed DNC presented excellent results in ali the tested situations, in 
spite of considering Nc equal to 1. Whether the control taking the variables to their set 
point or in the optimization where the control associates a search of certain operational 
condition. lt is believed that elevating the control horizon for Nc &gt;1, the results will be 
better, reducing the time of the control response; this was not still made due to the 
extreme difficulty of tune the multivariable control. 



167 

5REFERENCE 
AGUILARA,R., GONZÁLEZ,J, RAMIREZ, J A., BARRÓN,M. Control of fluid catalytic 

cracking unit based on proportional-integral reduced order observers. J. Chem. Engng. 
v. 75, p. 77-85, 1999. 

ANSARI, R. M. &amp;amp; TADÉ, M. O. Constrained nonlinear multivariable control of a fluid 
catalytic cracking process. J of Proc Cont v.10, p. 539-555, 2000. 

DE SOUZA JR, M. 8. Redes Neuronais Multicamadas Aplicadas a Modelagem e Controle 
de Processos Químicos. Rio de Janeiro: COPPEIUFRJ,. 1993. 124 p. Tese 
(doutorado) 

FILETI, A. M. F. Controle avançado de Processos: Adaptativo, Preditivo e Fuzzy. 
Modelagem Matemática via Redes Neurais. Aplicações em Processos Químicos. 
(curso ministrado na Escola Politécnica da Universidade Federal da Bahia). 

KURIHARA H. Optimal Control of Fluid Catalytic Cracking Processes. MIT: Science Dr. 
Thesis, 1967. Tese (doutorado) 

MORO, L F. L Desenvolvimento de um Controlador Preditivo Multivariável para um 
Conversor Industrial de Craqueamento Catalítico. São Paulo: USP, 1992, 77 p. 
Dissertação (Mestrado) 

NARENDRA, K. S. Neural Networks for Control: Theory and Practice. Proc. of IEEE, Oct 
1996. v. 84, n. 10. 

NARENDRA,K. S. and MUKHOPADHYAY, S. Adaptive Control Using Neural Networks 
and Approximate Models. IEEE Trans. on N. Net., v. 8, n. 3, May 1997. 

SANTOS, V. M. L Identificação e Controle Preditivo Baseado em Redes Neurais de 
Processos de Craqueamento Catalítico em Leito Fluidizado. Recife, PE: DEQIUFPE, 
101p. 2000b. dissertação (mestrado) 

VIEIRA,W.G., FILETI,A.M.F., CARVALHO, F.R., PEREIRA, J.A.F.R. FCC: Process 
ldentification Through Artificial Neural Networks. Proceedings of 6TH World Congress of 
Chem Engng. Australia. 2001. 

WANG,H., OH,Y. and YOON,E. S. Strategies for Modeling and Control of Nonlinear 
Chemical Processes using Neural Networks. Comp. Chem. Engng. v. 22, Suppl., p. 
S832-S862, 1998. 

ZHAN, J. &amp;amp; ISHIDA, M. The Multi-step Predictive Control of Nonlinear SISO Processes 
with a Neural Model Predictíve Control (NMPC) Method. Computers chem. Engng., v. 
21, n. 2, p. 201-210, 1997. 



169 



170 

78 

Sala Boa Viagem 
~···-·······-················-·····------·····························································································-·······-··············--·--·-········-, 

Dia/hora Código Título 

I f tt -:J.f 
z;_.-:;-;.:t5H.-so 

:-i-CJBHF :\. \.K.:tn:LA.GI:.0\.1 !\1.A"!1:.:\·l:\TKA r: fTElT&lt;.)S fi·E Cú.:.&lt;)-
~tE'fHIA N.·\ f'.il\-lUA()\(} B!FA:,K..-\ Di: l'~-I R1:-;E1~ 

H:C- F\lA AL1't·:R\.Xrl"\':\ DF t:o~..;TH:OLC PR.FTH"fh:(:.i 
MFLTlV·\lU,\VEl. PO!: Rl.'.Df' L&gt;F&lt;hUC.' 

cn:"'-T'f{(H.f OF Qi :AUf&gt;:\UF .\tFt.HOt~/dX) DF ~F~I\iA~ i)E 
PROUr·RO:Pl:LEt...:·::) Hl.\iOf.:Al. 

\1()DFL\(-i.E\:í \"iA .. TE~.-1.-:\TlC:.-\ fJ.\ t)lS1'R1Bl . .'JÇAO DE ·r_;\MA· 
!'il'l() D;\S 1-'~\KTÍCU .. \~ DF P(!LU::Sr!.KE~\U PHODt ".1.:10:\:'- P!)H 
POt.l.\lFR!7A•:~A&lt;:) E.\·t SF\.!!kSl ·~t;f;\:S\0 

C.\l NO\:{) Si.\!UA0f.)R DF StHIF' n:;-..wcH~A.b PAR.-\ !U::J)g~ 
DE DCTCJ.':' CO\i FLl_:lLX).':- E'-&lt;C(}\lf'RF.':'~fVF.fS 

Sü-H.:L\C.A.o DL~A;\UC.\ DE RfDC:; i.iE Dl fOS í.)Pl·.-fu\NlXi 
•.:o;...-; H.l __ õ(f)(&gt;~&amp;lt;~ú\!PI~FS~i\'fJ~ DEJ\S()S 

- ÇAO DE :.:.Is·rf:\i/1.~ LH:.\\?'1-'!'kX.h '\:\(.1 UNE:\H.ES. P PARTE: 
KEV!SA.o P:\ TEUl~l:\. 

CO(.·JPA.H:\C:\0 D+. DtfF.RE.\"TE:-: \!fT()J.)()~ Di·. Jf)f:NTJFfC\· 
C\Q Dt ...:;t~TF;\·p,:-, DL'..'&lt;VH("(6 ?\.Ü) U:\:E.-\!&lt;.E:.;.. 2~ PARTI:: 
RESI..:l.T:\f.){)S .\:'t ::';·if.Ri".C.~)S 

ESF.'Dt) DA u::-..:.A.\HC •. -~. Df C:\i Ri:":\.l()R Df 
.P0l..L\·1EK!/.Ai,.:Ao (.&lt;)\{ KE:-\F!UA;\l.F:.._·--n) P-t)i\ F\·'.!\P(_;f:A(.;\() 

~l?.-lt1 .. A.\ ... ~(1 E~'1/\Ch):'~.-\J.H:\ I1A p(,lV,1ElHZA(:A.U E:\l L-\MA 
F FM ;\V.SS:\ DE PKOPHJ::&lt;() 

;-;o!:\.11. OU\Ç.\(,: FST.·\(:J(Y~.-\H.IA UF f{F_í)J·:.:'-. Dr T H.:'TO~ :_rnu · 
/..\0\;P() t_;:',..l \-!tJnFl.O DE F~((;-\".f.F'\:':."(_"; ..;:\lPUPtC:\DO 

·\if~ORíT\i() PAR..\ PRFVh..\!) flf PL\.'·.·,_:,s F"XPFRJ\·H~?-....:."[.\h 
~r.qf:r~clAb 



Colt .• 
. . •·.·•.· ..... ··· ···.·····.·····• ··.......• ' 

- '-::_ .- -··. ) ',_ ..... ::- -:... _.-··-· __ :· 

XIV CONGRt$\0 BRA\tl!tRO DE fNGEN~ARIA QUiMICA 

$ 
&amp;amp;*'""' E.. . ,., 

"~~· ~: TI FI l_":Y ~\ r· ..... )· . o· l~~ "''' .·. ·. · ..... 
Certificamo• q~&amp;amp; WIUIAN GONÇALVES VIEIRA purtíçipou elo XIV C!,&gt;OQI'j&gt;$$0 Brasileiro do Engenharia Química, realizado de 25 

u 28 de agoslo do 2002, em Natal- RN, na condl~ao de PARTICIPANTE. 

Natal (RN), 2e d• agosto de .2002 

fJ42v~ 
Prol" Mlircio. Mo ria .Limo Pv11rte 

Prtsidonte do COBEQ 7002 

Renliza~õo: "":cABEQ 
'\ .. ~~~ti~· 

~Oim~e~~ 

~~ eL ....... ~~~~ 
Gorei" Ribeiro de Maeedo 

Coótd.ottdora do tomit&amp;amp; tétnitO·éhHltifitQ 

Organb:açôOl u~~ 
~~ .. "! 

Ct DEQ 
(;,i.;il~it~ O.ow~IW"·M·lii~4~ 
lt(f'!&lt;&gt;k&gt;~l&lt;&gt; ''"J+Hh~tlb&amp;lt;ll&lt;•imJoo 

,_.. 
-J ,_.. 



173 

FCC: UMA ALTERNATIVA DE CONTROLE PREDITIVO MULTIV ARIÁ VEL 
POR REDE DINÂMICA. 

Vieira, W.G.\ Fileti, A.M.F 2 "; Carvalho, F.R.3 ; Pereira, J.A.F.R2 

1- C1EC/DEQ - Universidade Federal de Alagoas 57072-970 Maceió. AL Brasil E-mail: wgy@ctec.ufal.br 
2- DESQIFEQ - Universidade Estadual de Campinas 13083-970 Campinas. SP Brasil E-mail: 

frattini@desa.fea.unicamp.br e pereira@desg.fea.unicamp.br 
3- CTGJDEQ - Universidade Federal de Pernambuco 50740-521 Recife - PE - Brasil E-mail: 

florival@nJ?d.ufue.br 

RESUMO: O objetivo do presente estudo é propor um Controlador Preditivo Multivariável 
utilizando Redes Neurais Artificiais como modelo de predição para controlar um processo não 
linear. Um modelo fenomenológico representando a unidade de Craqueamento Catalítico da 
refinaria Henrique Lage foi utilizado para gerar o modelo em redes neurais. Este modelo 
fenomenológico já foi validado com os dados da própria unidade industrial sendo portanto 
adequado para este propósito. As variáveis controladas do processo são: temperaturas do 
regenerador F e 22 estágios, temperatura do riser e severidade da reação; como manipuladas 
são utilizadas: vazão de catalisador, vazão do ar e vazão e temperatura da carga. É proposto 
maximizar a produção, procurando atingir a conversão otimizada mantendo as variáveis do 
processo dentro de uma faixa de controlabilidade frente às perturbações no sistema. O 
controlador desenvolvído apresentou bom desempenho, comparado com o sistema aberto, em 
todas as situações testadas levando as variáveis controladas para o set poínt. 

PALAVRAS-CHAVE: controle preditivo multivariável, redes neurais artificiais e FCC. 

ABSTRACT: Tiris paper propose a Multivariable Predietive Control using Artificial Neural 
Networks (ANN) as model of a non-linear process. A phenomenological model that represent 
the FCC unit of the Henrique Lage refinery was used to obtaín the ANN model. Tiris model 
"lvas already valídated with the data of the own industrial unit being therefore appropriated for 
this purpose. The process variables controlled were: temperatures of the regenerator first and 
second stage, the temperature of the mixture in riser and the severity of the cracking reaction; 
as manipulated variables were used: catalyst flow rate at riser, air flow rate at regenerator and 
feed flow rate and temperature at riser entrance. The purpose is maximízing production, trying 
to reach the optimization of conversion maintaining the control variables inside of a restriction 
range even for the disturbances in the system. The predictive control presented good 
perfonnance, when compared with open system in ali the tested sítuations, taking the 
controlled variables for the set point. 

!.INTRODUÇÃO 

A introdução de computadores digitais de 
baixo custo e alta velocidade de 
processamento tem encorajado o uso de 
métodos matemáticos complexos e mais 

precisos em engenharia de sistemas. Este 
avanço tecnológico possibilitou o uso de 
redes neurais artificiais (RNA) como 
ferramenta para controle de sistemas 
químicos. As RNA permitem que se simule 
um processo químico qualquer, sendo ele 

* Autor para o qual toda a correspondência deve ser enviada. 



174 

linear ou não linear, conhecendo-se um 
histórico operacional do processo ou 
apenas conhecendo-se os dados de entrada 
e as respostas correspondentes, mesmo que 
não se tenha certeza do mecanismo do 
processo (NARENDRA &amp;amp; 
MUKHOPADHYAY, 1997). 
Diversos estudos relacionados a RNA têm 
sido encontrados na literatura. 
NARENDRA (1996), apresenta em um 
resumo a aplicação de RNA em controle de 
processo, incluindo algumas aplicaçõ~s 
industriais de sucesso. WANG et ali., 
(1998) apresentou uma estratégia de 
controle preditivo onde um processo não 
linear é modelado usando RNA. Seus 
estudos se limitaram ao caso de otimização 
onde apenas uma ação de controle é 
envolvida, obviamente a complexidade do 
problema aumenta quando o número de 
variáveis cresce. ZHAN &amp;amp; ISHIDA, 
(1997) apresentaram um estudo para o 
controle preditivo com modelo em um 
processo não linear com uma única entrada 
e única saída (SISO - Single Input and 
Single Output). A proposta apresentada foi 
utilizar controle preditivo utilizando RNA 
para simulação do modelo. O objetivo 
básico foi selecionar um conjunto de ações 
de controle futuro que minimizasse urna 
função objetivo baseado na técnica de 
modelagem preditiva, sujeito a restrições 
de processo. Eles concluíram que o desvio 
encontrado entre o modelo e o sistema real 
foi devido a ausência de informações na 
região não estável, mas que o perfil do 
modelo acompanhou o perfil real. Porém, 
seu estudo se limitou a um sistema SISO. 
De SOUSA Jr., (1993) empregou urna 
RNA para identificação de um processo 
catalitico. O autor também usa a rede para 
a identificação de reatores não lineares 
com controle preditivo. Em seu trabalho, 
ele obteve resultados satisfatórios, usando 
o método de treinamento 
"backpropagation", com a técnica "steep 
descenf' como rotina de minimização. Foi 
usado na sua tese de doutorado urna rotina 

já pronta, baseada no estudo de CASTIER 
(1990), que calcula o gradiente conjugado 
de FLETCHER e REEVES (1964). Ele 
adaptou esta rotina em linguagem Fortran 
para suas condições. 

O processo da FCC em função de sua 
elevada complexidade e dificuldade de 
operação e controle representa um desafio 
onde beneficios significativos para 
indústria de processo e para teoria de 
controle poderiam ser alcançados. Esta 
unidade, em virtude do elevado valor 
agregado de seus produtos represe_nta o 
processo mais importante em refinanas de 
petróleo. Um pequeno beneficio neste 
processo é economicamente atraente. 
Diversos autores apresentaram estudos 
envolvendo a unidade de FCC. SANTOS 
(2000), apresentou como terna de mestrado 
um estudo utilizando RNA na identificação 
desta unidade. Este estudo se limitou a 
sistema SISO. Foi proposto também o 
controle do processo da FCC, utilizando o 
modelo desenvolvido na identificação. Os 
resultados se mostraram satisfatórios. A 
mesma rotina desenvolvida por CASTIER 
(1990) e De SOUZA Jr. ~1993) fo! 
utilizada em seu estudo. Ansan and Tade 
(2000) apresentaram uma estratégia de 
otimização não linear com restrição 
aplicada à unidade de FCC. Neste estudo 
um modelo dinâmico não linear do 
processo foi usado para um sistema de 
controle multivariável. AGUILARA et ai. 
(1999) utilizaram um projeto de controle 
regulatório para estabilização das 
temperaturas do reator e do regenerador de 
uma unidade de FCC. Zanin et ai. (2000) 
descrevem a implementação de uma nova 
estratégia de otimização não convencional 
em tempo real aplicada em um conversor 
FCC. Conforme observado em todos estes 
estudos foram utilizados modelos 
fenomenológicos, e um modelo em redes 
neurais envolvendo as principais variáveis 
da unidade FCC juntas ainda não tinha sido 
realizado. 



A meta a ser alcançada neste 
trabalho foi obter uma estratégia 
alternativa de controle preditivo usando as 
RNA como modelo do controlador, 
aplicadas a um processo multivariável não 
linear e com restrições. Para representar o 
processo multivariável, um modelo 
fenomenológico que simula a unidade de 
Craqueamento Catalitico, modelo Kellog 
Orthojlow F, foi utilizado para 
identificação em redes neurais (VIEIRA, et 
ai., 2001). MORO (1992), em sua 
dissertação de mestrado utilizando um 
simulador desenvolvido por KURlliARA 
(1967), validou este modelo 
fenomenológico com os dados da unidade 
industrial, criando um controlador DMC e 
acoplando-o ao simulador. O fato do 
modelo já ter sido validado com os dados 
da unidade industrial tomou este simulador 
bastante adequado para o propósito aqui 
apresentado. Com o controlador é proposto 
otimizar a produção de Nafta, ou 
alternativamente GLP, de forma a atingir a 
conversão otimizada frente às perturbações 
no sistema. 

No presente estudo, é previsto 
utilizar a mesma rotina desenvolvida por 
CASTIER (1990) e De SOUZA Jr. (1993), 
sendo necessário alguns ajustes para 
adaptá-la ao problema proposto. Na sessão 
2 é feito uma breve Descrição do Processo. 
A Metodologia é apresentada na sessão 3, 
o cálculo do Sistema Aberto na sessão 3 .1. 
o Controle Convencional da FCC na sessão 
3.2. e o Controlador Preditivo na sessão 
3.3. Os Resultados são apresentados na 
sessão 4 e as Referências Bibliográficas 
são apresentadas na sessão 5. 

2.DESCRIÇÃO DO PROCESSO 

A unidade de Craqueamento 
Catalitico apresenta como objetivo o de 
reduzir o tamanho das redes 
hidrocarbônicas das frações mais pesadas 
do petróleo por meio de reações catalíticas. 
Este processo é extremamente útil pois 

175 

transforma produtos derivados de 
petróleo de alto peso molecular e que 
possuem baixo valor agregado em produtos 
de maior valor comercial. Esta unidade 
gera os seguintes produtos: Gás 
Combustível; Gás Liquefeito de Petróleo; 
Nafta Craqueada; Óleo Leve de Reciclo; 
Óleo Decantado e Coque. Desses produtos, 
o que apresenta maior valor agregado é a 
Nafta Craqueada, utilizada como gasolina 
automotiva, sendo portanto esta a principal 
meta dessa unidade. Devido às condições 
de temperatura do reator, ocorre deposição 
de coque sobre a superficie do catalisador, 
reduzindo sua atividade. A unidade é 
composta de duas seções, uma de reação 
catalítica, e a outra onde ocorrem as 
reações de queima do coque com injeção 
de ar, regenerando o catalisado r (Figura 1). 

O controle rigoroso de algumas 
vanavers operacionais (controladas), é 
feito por meio de alterações em outras 
vanavers do processo (manipuladas). 
Diversas variáveis podem ser usadas como 
controle na indústria, porém, algumas delas 
apresentam maior facilidade de medição ou 
então influenciam diretamente as demais 
variáveis; então, estrategicamente, neste 
estudo foram escolhidas como variáveis 
controladas: a temperatura do riser, TR..X; 
as temperaturas das fases densas do 
pnmerro e segundo estágios de 
regeneração, TRG 1 e TRG2; e a 
severidade da reação catalitica, SEV. As 
seguintes variáveis foram consideradas 
como manipuladas: vazão da carga, RTF, 
vazão de catalisador regenerado, CTCV, 
vazão de ar para o regenerador, RAl e 
temperatura da carga, TFP. 



176 

Produto$ --o::J 
v ... 

Separador 

Riser 

h---c...ga 
1

1 Vapor 
"""- de 

Dispersão 

Figura 1 Esquema da FCC da Refinaria Enrique 
Lage. 

3.METODOLOGIA 

O controle preditivo, é assim 
denominado devido à forma como é feito o 
cálculo da lei de controle, ou seja, no 
instante atual, chamado instante "/(' é feita 
a previsão do processo para instantes 
futuros, "k+ 1", "k+ 2", ... , "k+Np'', onde Np 
é denominado horizonte de predição. A 
partir de um modelo, previamente definido, 
são feitas previsões das respostas do 
processo simulando alterações nas 
variáveis manipuladas para Nc instantes 
futuros, onde Nc representa o horizonte de 
controle. São feitas então seleções destas 
variáveis de forma a escolher aquelas que 
fornecem somente respostas com 
determinadas caracteristicas. Então, a 
primeira predição é implementada na ação 
do controlador. Após implementação, o 
tempo é atualizado para "k+ 1" e todo o 
cálculo é repetido. Normahnente, adota-se 
um critério de comparação entre a resposta 
predita e a resposta desejada para escolha 
da ação do controlador. Esta comparação é 
feita por meio de minimização de equações 
algébricas que geralmente são funções da 
variável controlada predita - y , da 
variável manipulada - u e de uma trajetória 
de referência- sp (set point). Desta forma, 
o erro futuro é minimizado, e se o modelo 
escolhido representar bem o processo e se 
não ocorrerem disturbâncias, o processo 

seguirá fielmente a trajetória de referência 
(FILE TI, 1998). 

A equação algébrica é definida 
como, 

NP Nc 

j = 2&gt;.{Y.(k+1)-sp.(k +1)~ + 2:;2,(u;(k)-u;(k -1))' 
td ie:::O 

sujeito as seguintes restrições: 

Ymin s,y(k+i)s,y-,i=1, ... ,NP 

umin 5, u(k +i -1) 5, umáx,i = 1, ... ,N P 

[u(k+i)-u(k+i -1)]5,~""",i = l, ... ,Nc (3 .1) 

onde À. são os pesos utilizados para 
penalizar variações excessivas da variável 
manipulada, e a são os pesos de igual 
importância utilizados nas vanave1s 
controladas, os índices q e r representam as 
variáveis controladas e manipuladas. A 
trajetória de referência para a estratégia de 
controle é dada pelo modelo: 

y'P(k)= y(k) 

y~+i) = f3y~+i-J + (1- f3)sp (3.2) 

onde f3 assume um dos seguintes valores: 
0,85; 0,90; 0.95 e 0,97, dependendo do 
ajuste do controlador. Cada predição de um 
passo adiante da rede neural foi corrigida 
usando uma variável de correção fornecida 
por: 

c(k) = y(k)- Y(k I k -1) 

A predição corrigida então fica: 

Yc(k+1lk)=y(k+1lk)+c(k) (3.3) 

onde y(k) é a saída real do processo no 
tempo de amostragem k, y(k I k -1) , a 
predição da variável y para o instante k 
obtida pela rede neural no tempo de 



amostragem anterior (k-1) e Yc(klk+I) é 
a variável predita corrigida. 

3.1. Sistema Aberto 

As mesmas perturbações propostas 
para teste do controlador foram impostas 
ao modelo em malha aberta, utilizando a 
rotina do modelo fenomenológico. Com 
isto, espera-se conseguir realizar urna 
comparação entre os testes com e sem a 
ação do controlador. Os resultados obtidos 
do comportamento do modelo sem ação de 
controle foram agrupados juntos aos 
resultados obtidos com ação do controlador 
na forma de gráficos utilizando uma linha 
pontilhada (Figuras 5 a 8). 

3.2.Controle Convencional da FCC 

Inicialmente, é apresentada uma 
descrição do controle convencional da 
unidade FCC, para auxiliar na descrição do 
processo. A Figura 2 é útil para seu 
entendimento. 

A carga, normalmente proveniente 
do sistema de tancagem da unidade, 
apresenta um controle de vazão 
independente. Ela é aquecida em um fomo 
de aquecimento de carga. A temperatura da 
car~a na saída do fomo é controlada por 
meiO de um controle de vazão de 
combustível para o fomo. A temperatura 
de saida do "Riser' é controlada pela 
válvula de admissão de catalisador 
regenerado. O nível de catalisador no vaso 
separador é controlado pela válvula de 
catalisador gasto. As temperaturas dos 
leitos, fases densas e diluídas são 
controladas pela vazão de ar para 
regeneração. O diferencial de pressão dos 
subsistemas reação e regeneração, é 
controlado pela válvula de gases de 
combustão. 

177 

Fomo 

,@ 
r , 
·~ 

Corga 

Figura 2 Esquema de controle convencional da FCC. 

3.3.Controlador Preditivo 

A rotina computacional do 
controlador foi desenvolvida utilizando 
linguagem F ortran, sendo inserida na 
rotina do modelo fenomenológico. O 
processo de minimização da função 
objetivo foi realizado empregando a rotina 
NCONF, da biblioteca IMSL, interna do 
Fortran. Esta rotina implementa o método 
de programação quadrática sucessiva 
(Successive Quadratic Programming -
SQP) e o método do gradiente por 
diferenças finitas (f'inite Dif.ference 
Gradient), mas não se tem acesso aos 
programas fontes. No programa foram 
incluídas as restrições do modelo 
(Equações 3 .I), sendo estas restrições 
utilizadas também para realizar a estratégia 
de otimização do controlador. As variáveis 
manipuladas e controladas foram 
normalizadas nos mesmos moldes da 
normalização usada no processo de 
identificação, (VIEIRA, et ai., 2001 ). 

Convém observar que o modelo em 
redes neurais foi treinado considerando a 
ação de degraus em cada variável 
manipulada individualmente, mas o 
controlador DNC (Dynamic Networks 
Control), prevê a atuação em todas as 
variáveis manipuladas simultaneamente. O 
diagrama da Figura 3 mostra um esquema 



178 

de um controlador preditivo utilizando 
RNA. 

Entradas passadas ' 

e "'"""'"" """"" Futu&lt;"' Redes Neurats 

Entradas 

'""""' + 
""""""" Parao 

"""""" 
-

v. 

Figura 3 Esquema proposto do Controlador 
Preclitivo com Modelo utilizando redes neurais. 

A Figura 4 apresenta um esboço do 
sistema de controle proposto, já acoplado 
ao sistema convencional. 

A ação do controlador pode ser 
obtida juntamente com estratégias de 
otimização da planta. Estas estratégias são 
obtidas por ações externas, onde se 
determina qual variável será manipulada 
alterando-se os seus limites de restrição. 
Dentre as estratégias de otimização que 
apresentam interesse, duas se destacam: 
primeiro a estratégia de maximizar ou 
minimizar a produção da unidade, variável 
RTF; em segundo, a estratégia de alterar o 
objetivo da unidade, passando a produzir 
GLP ao invés de Nafta, alterando-se o set 
point da variável TR.X. 

·-® 

Fomo 

Função 
Objetive 

r FC 
Httr---tz~ii,__%.-. 

ca'lla 

combustível 

Figura 4 Esboço do controle proposto. via RNA, 
para acoplamento ao controle convencional da 
FCC. 

Na simulação matemática obtida 
através do modelo fenomenológico 
(ODLOAK, 1997) foram obtidos os dados 
das variáveis controladas e manipuladas 
que compõem as entrada para o controle 
DNC. De posse desses dados é chamada a 
rotina de otimização onde são feitas as 
predições das ações nas variáveis 
manipuladas. A RNA é usada para prever 
as respostas dessas ações nas variáveis 
controladas em todo horizonte de predição 
(Np). Os resultados dessas predições 
resultam nas ações do controlador, em todo 
horizonte de controle (Nc). Selecionadas as 
ações que núnimizam as diferenças entre 
as trajetórias de referência no horizonte de 
controle, a primeira ação do controlador é 
então enviada de volta ao programa do 
modelo fenomenológico gerando os dados 
de impressão de resultados, ficando o 
programa de controle aguardando novo 
instante de amostragem, repetindo o ciclo. 

Como teste do controlador DNC, 
foram simulados 1000 minutos de 
operação, com ação do controlador à partir 
do minuto 100 sendo inserido urna 
perturbação a partir do instante 400 
minutos. O programa simulador (modelo 
fenomenológico) se unCJa em uma 
condição fora do estado estacionário, 
denominada de condição inicial de 
operação; portanto, após inicio da ação de 
controle, tempo 100 minutos, o controlador 
inicia uma ação de levar as variáveis 
controladas para o seus "set points'. Isto 
justifica a alteração observada em todos os 
gráficos no intervalo entre 100 minutos e 
400 minutos, instante da perturbação. 

4.RESULTADOS 

Para o teste considerando o 
problema regulador é proposto aplicar um 
degrau na variável temperatura do ar para o 
regenerador, variável T AI, alterando seu 
valor em +8%. Foi considerado 
amostragem de 4,0 em 4,0 núnutos, com 
Np igual a 10, e Nc igual a 1. Os fatores de 



ponderação, À; , que restringem as ações 
nas variáveis manipuladas foram: l,OE-3 
para TFP, 3,0E-4 para RAI, 6,0E-4 para 
RTF, e S,OE-2 para CTCV; e os fatores de 
igual importância, a,, que controlam a 
relevância de cada variável controlada, 
foram: l,OE-3 para TRG1, 1,0E-5 para 
TRG2, 1,0E-4 para SEV e S,OE-3 para 
TRX. O filtro utilizado para a trajetória de 
referência foi de 9,0E-1, para todas as 
variáveis e a estratégia de otimização 
considerada para o teste foi a de manter 
fixa a vazão de carga da unidade, variável 
RTF. 

Os gráficos das Figuras 5 a 12 
mostram as respostas à perturbação na 

179 

variável T AI; estas respostas são 
apresentadas em forma comparativa entre a 
resposta do sistema em malha aberta (linba 
pontilhada) e com atuação do controlador 
(linha cheia). A elevação de TAI implicou 
em uma elevação imediata de TRG1 e 
TGR2, resultando na elevação da 
temperatura do catalisador regenerado que 
por sua vez elevou também TRX e SEV. 
Estes aumentos foram corrigidos 
simultaneamente por ação do controlador 
que reduziu gradualmente a vazão de ar, a 
abertura da válvula de catalisador 
regenerado e a temperatura da carga. A 
vazão de carga (Figura 11) foi mantida fixa 
conforme foi definido. 

Ftgura 5. Variável controlada. 
TRGL Permrbação: temperatura do 
ar para o regenerador, T AI. 

Figura 6. Vanável controlada. 
TRG2. Perturbação: temperatura 
do ar parn o regenerador, T AI. 

Ftgura 7. Variável controlada: 
SEV. Perturbação: temperatura do 
ar para o regenerado r, T AI. 

····--·· 
S..t~otnt 

Ftgura 8. Variável controlada. TRX. 
Perturbação: temperatura do ar para 
o regenerador, T AI. 

Figura 9. Resultado da ação do 
controlador na variável RAI. 
Pertuibação: temperatura do ar 
para o regenerador, T AI. 

Figura I O. Resultado da ação do 
controlador na variável 
manipulada CTCV. Perturbação: 
temperatura do ar para o 
regenerador, T AI. 



180 

~·-

f 1!:~0o1oJI-. +--t------
~ 11: l I I 403,5j I 

4000~ I 
o 200 400 $00 000 

T~jmln.) 

~000 

Figura !!.Resultado da ação do 
controlador na variável RTF. 
Perturbação: temperatura do ar para o 
regenerador, T AI. 

Figura 12. Resultado da ação do 
controlador na variável 
manipuladas TFP. Perturbação: 
temperatura do ar para o 
regenerador, TAI. 

F1gura 13 Variável controlada: 
TRG I. Perturbação na variável 
TAI, e ruído de 1,5% nas variáveis 
controladas. Otimização: 
maximizar GLP. 

I-TRG2' --
setpomt 

Figura 14 Variável controlada: Figura 15 Variável controlada: Figura 16 Variável controlada: 
TRG2. Perturbação na variável T AI, 
e ruído de 1,5% nas variáveis 
controladas. Otimização: maximizar 
GLP. 

SEV. Perturbação na variável 
T AI, e ruído de 1,5% nas 
variáveis controladas. 
Otimização: maximizar GLP. 

TRX. Perturbação na variável T AI, 
e ruído de 1,5% nas variáveis 
controladas. Otimização: 
maximizar GLP. 

Analisando as Figuras 6 e 8, 
observa-se que as variáveis TRG2 e TR.X 
se apresentaram ligeiramente acima dos 
seus set points. Na variável TRG2, isto é 
justificado devido à relação entre a vazão 
de ar entre primeiro e segundo estágios do 
regenerador ser mantida fixa, não sendo 
possível controlar urna variável 
independente da outra; na variável TR.X 
observa-se uma interdependência entre esta 
variável e a severidade da reação catalítica; 
mas apesar deste afastamento, estes 
resultados foram considerados bons. 

Conforme informações obtidas, 
(ODLOAK, 2001), a unidade FCC 
freqüentemente precisa alterar a estratégia 
de produção para atender solicitações de 
mercado. Desta forma, foi efetuado um 
teste simulando a mudança de produção de 

Nafta para GLP, e além disso, foi imposto 
um degrau na variável perturbação, 
variável T AI, de intensidade +8%. Para 
representar a produção de mais GLP, foi 
elevado o set point de TR.X da seguinte 
forma: um degrau nas variáveis severidade 
da reação catalítica de +0, 77% e em TR.X 
de +0,51 %. Os gráficos das Figuras 13 a 
16 apresentam os resultados obtidos desta 
simulação nas variáveis controladas. Como 
as variáveis controladas TR.X e severidade 
da reação catalítica estão interrelacionadas, 
uma mudança no set point de uma delas 
necessariamente irá afetar a outra, para 
atender à nova condição de equilíbrio. 

Neste último teste, um ruído de 
intensidade 1,5% foi inserido nos sinais 
das variáveis controladas antes da entrada 
do programa de otimização, na tentativa de 
aproximar o simulador das condições reais 
de operação; ainda assim, a rede foi capaz 



de predizer o comportamento do modelo 
para todas as quatro variáveis envolvidas 
no processo. 

O controle DNC proposto 
apresentou bom desempenho em todas as 
situações testadas, apesar de considerar Nc 
igual a 1, quer seja no controle levando as 
variáveis para o set point ou na otimização 
onde se associa o controle com uma busca 
de determinada condição operacional. 
Acredita-se que elevando o horizonte de 
controle para Nc &gt;1, os resultados serão 
ainda melhores, reduzindo o tempo de 
resposta do controlador; isto ainda não foi 
conseguido devido à extrema dificuldade 
de ajuste do controlador multivariável 
DNC. 

5. BffiLIOGRAFIA 

AGUILARA,R., GONZÁLEZ,J, 
RAMIREZ, J A, BARRÓN,M. Control 
of fluid catalytic cracking unit based on 
proportional-integral reduced order 
observers. J. Chem. Engng. v. 75, p. 77-
85,1999. 

ANSARI, R. M. &amp;amp; TADÉ, M. O. 
Constrained nonlinear multivariable 
contro1 of a fluid catalytic cracking 
process. J of Proc Cont v.10, p. 539-
555,2000. 

DE SOUZA JR, M. B. Redes Neuronais 
Multicarnadas Aplicadas a Modelagem 
e Controle de Processos Químicos. Rio 
de Janeiro: COPPEIUFRJ,. 1993. 124 
p. Tese (doutorado) 

FILETI, A. M. F. Controle avançado de 
Processos: Adaptativo, Preditivo e 
Fuzzy. Modelagem Matemática vta 
Redes Neurais. Aplicações em 
Processos Químicos. (curso ministrado 
na Escola Politécnica da Universidade 
Federal da Bahia). 1998. 

KURlliARA H. Optimal Control of Fluid 
Catalytic Cracking Processes. MIT: 
Science Dr. Thesis, 1967. Tese 
(doutorado) 

181 

MORO, L. F. L. Desenvolvimento de um 
Controlador Preditivo Multivariável 
para um Conversor Industrial de 
Craqueamento Catalitico. São Paulo: 
USP, 1992, 77 p. Dissertação 
(Mestrado) 

NARENDRA, K. S. Neural Networks for 
Control: Theory and Practice. Proc. oj 
IEEE, v. 84, n. 10. Oct 1996. 

NARENDRA,K. S. and 
MUKHOPADHYAY, S. Adaptive 
Control Using Neural Networks and 
Approximate Models. IEEE Trans. on 
N Net., v. 8, n. 3, May 1997. 

ODLOAK D., MORO L. F. L., GOUVEA 
M. T. - Programa para simulação 
dinâmica e controle DMC em 
linguagem FORTRAN. Comunicação 
pessoal. 1997. 

ODLOAK, D. Comunicação pessoal2001 
SANTOS, V. M. L. Identificação e 

Controle Preditivo Baseado em Redes 
Neurais de Processos de Craqueamento 
Catalitico em Leito Fluidizado. Recife, 
PE: DEQIUFPE, 101p. 2000b. 
dissertação (mestrado) 

VIEIRA, W.G., FILETI,AM.F., 
CARVALHO, F.R., PEREIRA, 
J.AF.R. FCC: Process Identífication 
Through Artificial Neural Networks. 
Proceedings oj 6m World Congress oj 
Chem Engng. Australia. 2001. 

WANG,H., OH,Y. and YOON,E. S. 
Strategies for Modeling and Control of 
Nonlinear Chemical Processes using 
Neural Networks. Comp. Chem. Engng. 
v. 22, Suppl., p. S832-S862, 1998. 

ZANIN, A C., M. TVRZSKÁ de 
GOUVÊA, M. AND ODLOAK, D. 
Industrial implementation of a real-time 
optímizatíon strategy for maximizing 
production ofLPG in a FCC unit. Comp 
andChemEngng24pp. 525-531.2000 

ZHAN, J. &amp;amp; ISHIDA, M. The Multi-step 
Predictíve Control of Nonlinear SISO 
Processes with a Neural Model 
Predictive Control (NMPC) Method. 



182 

Computers chem. Engng., v. 21, n. 2, 
p. 201-210, .1997. 



FCC: Process Identification Through Artificial Neural Networks 

Vieira, W. G. 1; Fileti, AM.F 2 *; Carvalho, F.R3 ; Pereira, J.AF.R 2 

1CTEC/DEQ- Universidade Federal de Alagoas 
Maceió- AL -Brasil 57072-970 e-mail: wgy@npd.ufpe.br 

2DESQIFEQ -Universidade Estadual de Campinas 
Campinas- SP- Brasill3083-970 e-mail: frattini@desg.fea.unicamp,br 

3CTG/DEQ -Universidade Federal de Pernambuco 
Recife- PE- Brasil50740-521 e-mail: florival@npd.ufpe.br 

183 

This paper describes an identification procedure, based on ANN, of a F1nid Catalytic Cracking converter. A 
phenomenological model, validated with real operation data, was nsed to generate a large data set of 
operational variables. Using the first principies model, an initial steady-state was achieved and several steps 
were applied to the manipulated variables. Three groups of data were respectively generated for training, 
validation and testing. A multilayer feedforward network was chosen for the FCC representation. Two 
different strategies were adopted for the network architecture: first, the input layer is composed by one 
manipulated variable, and in the second structure, is composed by four manipulated variables. The output 
Iayer was formed by the four controlled variables. The number of nodes in the hidden layer was obtained from 
a trial-and-error procedure. It was observed that the network generalization capacity and the training time 
increased with the number of hidden neurons. From the results, the architectures chosen for the FCC neural 
modeling were 5xl5x4 and 8xl5x4 and convergence criteria of 10·3 was nsed. In ali tests, the relative error of 
the output variables was below 1%. As a resnlt, reliable neural models were developed for the process 
identification and they could be nsed in a model predictive control structure for the FCC converter controL 

INTRODUCTION 

The use of complex and more precise mathematical methods in systems engineering has been 
extensively encouraged by the introduction of low cost digital computers and high-speed 
processing. This new technology allows the artificial neural networks methodology to be 
extensively used for the identification and control of chemical systems. 

Any linear or non-Iinear chemical process can be sintulated through a neural network modeling, 
even when the first principies of the process are unknown. Just input/output operational data is 
needed [1]. 

Severa! researches were already made based on ANN: Narendra [2], summarizes the application 
of ANN in Process Control and describes the last advances in this area. The author compares 
ANN's mathematical bases and some successful industrial applications are mentioned. In the 
processes identification area, Nikravesh (3] applied the backpropagation training procedure to a 
CSTR reactor. 

De Souza Jr. [4] employed an ANN for process classification, where the network was used to 
predict the properties o f a catalyst in function o f the conditions of the manufucture process. The 
author also used the network for the identification of nonlinear reactors within a predictive control 
loop. Santos [ 5] reports the application of an ANN for FCC identification and control, using two 
different process models: a sintplified model side-by-side and a more complex one, already 
validated with the data of the industrial unit. The study was restricted to a SISO structure (Single 
lnput and Single Output). 

The FCC unit is one of the most intportant processes in oi! refineries for the largest yield of 
products reached and the intportance of them. A small benefit in this process is economically 
attractive. Moreover, the environmental regulations related to gas emissions like CO, C02 , NOx 

• Whom ali correspondence should be addressed. 



184 

and SOx , are to date, very important. Therefore, advanced process control may be needed. 
However, FCC units are process physically complex and prove severa! difficulties to operate and 
control. The regenerator and the reactor sections of FCC units are highly interactive with difficult 
dynamics. The process is poorly known ma.inly because of the complexity of the chemical kinetics. 
In practice, FCC units are frequently regulated by means of standard PID controllers and also 
through manual control actions based on the knowledge ofthe refinery operators. 

A noulinear constrained optimization strategy was proposed by Ansari and Tadé [6] and applied 
to the FCC unit. A noulinear dynamic model of the FCC process was used for the dynamic analysis 
of the plant and for tests of a noulinear multivariable control system. The model were tested in a 
real-time application and the results were used to provide the initial values for the nonlinear control 
system design. A dynamic parameter update algorithm was used to reduce the effect of Iarge 
modeling errors by regularly updating the model parameters. The constrained noulinear 
optimization algorithm was real-time tested on the FCC reactor-regenerator. The results compared 
favorably to those from a linear multivariable controller. 

Wang et al. [7 ,8] proposed a study using wavelet functions and neural networks for the FCC 
process identification. Aguilara et al. [9] deal with the regulatory control Iaw desigu for stabilization 
of the reactor and regenerator temperatures of a FCC unit, considering the kinetics terms poorly 
known. The proposed control law uses on-line estimates of the input/output modeling errors, 
obtained from a proportioual-integral reduced order observer. The structure of the proposed 
controller is similar to a proportioual-double integral compensator (PI2) since a new 
parameterization of the controller gains is given in terms of the closed-loop and estimatimated time 
constants. The performance of the control scheme proposed is analyzed via numerical simulations. 
Still concerning about FCC control, Antoniades and Christofides [10] proposed a methodology for 
the synthesis of noulinear output feedback controllers for SISO nonlinear Di:fferential Difference 
Equation (DDE) systems which include time delays in the control actuator and in the measurement 
sensor. The proposed control method was successfully applied to a FCC and it is shown to 
outperform nonlinear controller designs that do not account for the presence of dead time associated 
with the recycle loop and the pipes transferring material from the reactor to the regenerator and 
VIce-versa. 

Zanin et al. [11] described the implementation of a new non-conventioual real-time optimization 
strategy applied to the maximization of LPG production in a (FCC) converter in the refinery of São 
José dos Campos in Brazil. Focus was given on the difficulties of integrating optimization to 
existing controllers. The first conunissioning tests was described in detail. They showed that the 
benefits from opti:mization are not restricted to economic values. Implementation of the strategy 
gives directions on how to change the operating mentality of the plant operators. The implemented 
optimization strategy was shown to be able to maintain control of the plant even in the Ioss of 
severa! manipulated variables and in the presence of strong disturbances. Furthermore, it was shown 
that the optimization strategy is able to drive the process to new operatioual points. Sarma and 
Rengaswamy [12] used a systematically constrocted chain of gain-scheduled fuzzy Iogic controllers 
(GS-FLCs), using sigmoidal gain-schedule (SGS). The SGS simultaneously has a crisp and intuitive 
gain-like format, and together they get relatively simple heuristic tuning for the GS-FLC. This 
noulinear GS-FLC structure permits the use of a very simple static linear decoupler (SLD). This 
control technique was applied in a FCC unit, and the general multivariable GS-FLC/SLD system 
demonstrates very good controller performance, covering servo/regulatory and robustuess tests. 

From the above, the FCC control problem has been widely addressed through severa! 
methodologies. An identification procedure based on neural networks may provide the FCC control 
designer a better understanding on the process dynamics and could be useful as an interual model 
for a Predictive Control scheme. The Model Predictive Control is based on a general performance 
index and parameterization of the control variables in a non-linear model, with includes the relevant 
constraints [13,14,15]. The FCC process represents a challenge environment where substantial 
benefits for process industry and for control theory could be achieved. 

In this work, the development of a FCC modeling using ANN is described. This model is 
supposed to represent a strongly noulinear process, with operatioual restrictions that involves a 



185 

MIMO system (Multiple Input and Multiple Output). Besides the process nonlinearity and 
operational restrictions, high interaction degree between its variables is described. The case study 
chosen for the present development is the Fluid Cracking Catalytic Uuit (FCC) of the Henrique 
Lage refinery - REV AP (São José dos Campos, SP, Brazil), through its respective model: Kellogg 
Orthoflow F. Moro [16] presented the phenomenological modelling of the Henrique Lage Refinery 
FCC uuit. This model was validated with the operational data of the industrial uuit. In order to train 
the ANN, a numerical simulator based on this phenomenological model will be used in the present 
work to generate large data set of operational variables. Different networks architectures are 
proposed to represent the FCC process. 

PROCESS DESCRJPTJON 
The Fluid Catalytic Cracking (FCC) UIÚt represented by the Kellogg Orthoflow F. model of the 
Henrique Lage Refinery o f Petrobrás was the process chosen for this study. The converter is 
supposed to reduce the size of the hydrocarbon cbains of the heavy petroleum fractions through 
catalytic reactions. This process is extremely important because derived products of petroleum of 
high molecular weight (that possesses little application and therefore lower commercial value) are 
transformed in products of higher comrnercial values. The FCC uuit inlets are the outlets of the 
following units: Vacuum Distillation (Gas-oil and Vacuum Residue) and Uuit of Treatment with 
Propane (Heavy Oi!). As products, it is obtained: Fuel Gas, Liquefied Gas of Petroleum (GLP), 
Cracked Naphtha, Light Cycle Oi! (LCO), Decanted Oi! (also denominated Fuel Oi! of FCC or 
Cracked Fuel Oi!) and Coke. These high-value products are called Cracked Naphtha, mainly used as 
automotive gasoline. High temperature is needed (from 500°C to 550°C) in presence of a selective 
catalyst. The catalyst is used in the form of a white powder with high porosity and specific area. 
Because of the small dimensions, it flows as if it was a fluid. Due to the operational temperature 
range, undesirable secondary reactions occur, such as coke formation, polymerization and 
dehydrogenating. As a consequence coke deposition on the surface of the catalyst occurs and 
therefore the catalyst activity is reduced. 

The unit is composed of two sections: one of catalytic reaction, where the reactions of chain 
break and also coke deposition on the catalyst take place; and the other, where burn of the coke 
occurs, regenerating the catalyst (see Fig. 1). Then the catalyst is forced to pass from the reaction 
section to the regeneration section, and finally coming back for the reaction section (see Fig. 2). The 
regeneration reaction is carried out through air injection and buming in the regenerator. 

Due to the extremely severe conditions of operation, rigorous control of some operational 
variable ( controlled) is needed. Several variables can be taken as controlled in the industry. In this 
study the following variables will be used: temperature of cracking mixture in riser (TRX), 
temperature of dense phase at regenerator first and second stages (TRG 1 and TRG2) and conversion 
of the reactor (Severity of the cracking reaction). The following variables will be manipulated: total 
feed flowrate to riser (RTF), regenerated catalyst valve opeuing (CTCV), air flow rate to 
regenerator (RAI) and feed temperature at riser entrance (TFP). Besides these variables, the process 
requires the maintenance of other variables between their restriction limits, such as: differential 
pressure on the reactor leve! control valve, temperature of the regenerator first stage dilute phase 
and temperature o f the regenerator global dilute phase. 



186 

Fig. 2 Schematic draw of the catalyst 
circulation. 

METHODOLOGY 
Neural Networks 
The ANN are fonned by processors elements denominated of neurons or nodes, interconnected by 
channels called o f connections, forming a dense net [ 4, 17]. The nodes are arranged in layers linking 
the input with the output. The connections tie the nodes of one layer with the nodes of another one. 
The way as the nodes are connected and their disposition determine the arcbitecture of the network. 
In the present study the net was con:figured as multilayer feedforward fully connected, with one 
bidden layer and without feedback connections. Hidden layers are used to extract, from the network, 
statistical results o f high order [ 17]. 

Mathematically, the behavior of a neuron in a generic layer can be represented by: 

Â.pj.k+l =[f w jikspi •• ]+B1,.+1, 
z=l 

where: À. represents the output ofthe neuron 'j ', in the layer' k+ 1 '; 
S corresponds to the outputs or activation of ali neurons of the layer ' k '; 
w is the weight of the connections; 
Bis the internallimit o f activation of the corresponding neuron 'j' (bias ). 

(I) 

An activation function, called transfer function of neuron, is applied to 2. In the present stody 
was used the sigmoid function, defined by: 

(2) 

The learning procedure is the process where the weights and biases are modified [I 8]. The 
supervised training was used in this work. Known input and output data (patterns) are presented to 
the network. The network is then adjusted by changing the weights and bias with predefined rules. 
The patterns are initially normalized to avoid di:fferences in the magnitude order of the input and 



187 

output [19]. Dueto the use ofthe sigmoid as transfer function, the normalization was made to 
obtain the patterns in the positive interval between O. O and 1. O. Indeed it was chosen a lirnit interval 
among 0.1 to 0.9 to al1ow, if necessary, small extrapo1ations [5]. The following re1ationship is used 
for the normalization procedure: 

(
p ,-P J pnor =0.1+ roa mm x0.8, 
Pnmx-Pmm 

(3) 

where: P nor represents the normalized pattern; 
P roal is pattem in the units o f input/ output and is obtained from the phenomeno1ogical mode1; 
P min is the 1ower bound of the variable; 
P"""' is the upper bound ofthe variable. 

The initial weights and biases were selected through a random routine that generates numbers 
between -1.0 and +1.0. The Training Algorithm used was Backpropagation, based on the error 
correction technique. In the optimization process, the strategy of the steepest descent was used [4, 
17]. 

Obtaining the data set 
The phenomeno1ogical mode1 developed by Moro [16], which represents the FCC unit, was used to 
generate the process data for training and testing the neural model. 

Through the use of numerical simulations based on the phenomeno1ogical mode1, a initial steady 
state was fust achieved. Severa! steps were then applied in the manipulated variab1es and the 
response of the controlled variables monitored. It was observed that the time spent on training the 
networks is straightly dependent to the number of steps applied to the manipulated variable. On the 
other hand, a very low number of steps could be insufficient to represent the operational range of 
the process. Indeed there must be a compromise between the number of steps to be implemented 
and the total variation allowed to the manipulated variables. The range recommended by Moro was 
used: 1.5k:Nm3/h in RAI variab1e, 0.003units in CTCV variable, 50.0m3/d in RTF variable and 2.2°C 
in TFP variable. The time interval between two successive steps should be large enough for the 
process to reach a new steady state before the following step. Tab1e 1 presents the manipulated 
variables and the respective size ofthe imposed steps and the time interval between them. 

Table I Manipulated variables, and their respective imposed perturbation. 

Manipulated TRAINING AND VALIDA TE SET TESTSET 
variables Step (%) Step time (min.) Step (%) Step time (min.) 
CTCV -7,-12,-5,+2,+11,+4, o 270,300,300,300,600,600,300 +2.5,-2.5,0 320,350,350 
RAI -5, -9, -3, + 1, +4, o 570,600,900,600,600,300 +2.5,-2.5,0 320,350,350 
RTF -6, -10,-4, +2, +7, o 270,300,300,300,300,300 + 1.5,-1.5,0 320,350,350 
TFP -5, -8.5, -3, + 1, +4, o 270,300,300,300,300,300 +2.5,-2.5,0 320,350,350 
CTCV; -7,-12,-5,+2,+ 11,+4,0, 270,300,300,300,600,600,300, +2.5,-2.5,0, 320, 350, 350, 
RAI· , -5, -9, -3, + 1, +4, O, 600, 600, 900, 600, 600, 300, +2.5,-2.5,0, 350, 350, 350, 
RTF; -6, -10, -4, +2, +7, O, 300, 300, 300, 300, 300, 300, +1.5,-1.5,0, 350, 350, 350, 
TFP -5,-8.5, -3, +1, +4, o 300,300,300,300,300,300 +2.5 -2.5,0 350, 350, 350 

The data obtained from the phenomeno1ogical model was split in 3 sets: training set (if these 
values were used for the leaming procedure ), validation set (if used fur validation o f the trained 
networks) and test set (if used for final test of the neural model). These data sets were obtained 
under specific conditions, namely: 



188 

Training set: samples were taken every 6 nún., starting in the 4"' núnute; time interval 
between two successive steps (see Tab. 1). 
Validation set: samples were taken every 2 nún., starting in the 4"' núnute; time interval 

between two successive steps (see Tab. 1). 
Test set: samples were taken every I nún., starting in the first núnute; time interval between two 

successive steps (see Tab. 1). 

Ali these sets were obtaíned after ínítial steady state is reached (30min.). 
It should be noted that the sequence of steps in the test set is different from the sequence of the 

steps imposed for trainíng and validation sets. 

Training the ANN 
With data sets obtained from rigorous numerical simulations, the leanúng procedure started. A fully 
connected multilayer feedforward network was chosen for the FCC representation. Two different 
structures were adopted for the network architecture: first, the ínput layer is composed of one 
manipulated variable and four controlled variables, and in the second structure, is composed of four 
manipulated variables and four controlled variables. The output layer was formed by the four 
controlled variab1es. 

The number of nodes in the hidden layer was obtaíned from a trial-and-error procedure. 
Increasing the number of nodes in the hidden layer leads to better results and smaller training time 
than that required with the increase ofthe number ofhidden layers. Hiecht-Nielsen [20] had already 
proven that any continuous function can be mapped with the architecture of 3 layers. However, 
there must be enough neurons in the hidden layer. Therefore the use o f more than one hidden layer 
was abandoned. 

Once detenníned the network architecture, it was performed a study seekíng to define the 
minimum number of patterns to be presented to the network during the training procedure. Special 
care was taken in order to choose data that covers the whole operational range o f the variables. 

hritially an excessive number of training patterns (over 5000) were used. Convergence was just 
reached when this number was reduced for less than 1500 patterns, but it also depends on the 
precision and on the number of nodes in the hidden layer. Target convergence criteria ranging from 
10·9 to 10'3 in the gradient ofthe objective function was used. A number ofnodes of 1, 2, 3, 4, 5, 6, 
10, 15 and 20 was tested in the hidden layer. A relative error close to 1% between the results ofthe 
model and the results of the network was considered enough for acceptance of the training 
procedure. 

RESUL TS AND CONCLUSIONS 
ANN Modeling 
Table 2 shows the CPU time consumed on the training procedure with a PC Pentium ll 400 MHz. It 
also shows the convergence criteria used and the minimum value obtaíned for the objective 
function. Both structures described on item "Training the ANN" were tested. 

Table 2. Training time, precision and objective function obtaíned. 

Manipulate variab1e I CPU Time (nún) I Convergence Criteria I Objective function 
First structure 
CTCV 320 8,49E-4 1,61E-1 
RAI 685 6,86E-4 8,26E-2 
RTF 356 7,81E-4 3,56E-2 
TFP 1029 4,37E-4 2,07E-2 
Second structure 
CTCV, RAI, RTF, TFP !2589 I5,26E-4 I1,09E-1 



189 

After training, the network validation was performed with the validation data set. The step 
sequence was changed. In this test, in the atternpt of simulating the conditions closer to the reality 
of an industrial unit, random noises were added to all the controlled variab1e signals. 

With reduced number of nodes ( 1 to 5) and using a target convergence criteria from 10·9 to 10·3 

in the gradient of the objective function., convergence was not achieved or some process oscillations 
could not be captured in some tests, resulting a 1ost o f generality. Increasing the number of hidden 
neurons to 10, 15 and 20, the resu1ts were considered acceptab1e. In order to reduce the time 
consumed in the training procedure it was necessary a change in the convergence criteria (1 o·3 and 
10·2). The number ofpattems was also reduced (1000 patterns). 

The behavior of the controlled variables is presented on Figures 3 and 4 for three steps in the 
manipulated variab1e CTCV. The values are shown in a comparative way between network output 
(with noise) and rigorous model. The architecture 5x15x4 anda convergence criterion of 10·3 were 
used. As it can be observed, the relative error between rigorous mode1 and network vanishes for 
TRGI and TRG2. For Severity and TRX, the relative errors were approximate1y 0.15% and 0.1%. 

---TRG1 network: 
706 ---TRG2 network. 

7 o 4 - --T R G i m ode I 
T R G 2 m ode I 

702 

700 ~ • 6 9 8 ~ • m 
á 

~ 
674 ., 

$ 
o 6 6 7 2 
~ 
õ 1;1 

" 6 7 o ~ ~ 
~ 

" ~ !il' 6 6 8 
15. 1ã 
E o 2 o o 400 600 800 1000 • ... 

T im e (m in.} 

Fig. 3. Cornparative response between rigorous mode1 and the neural network mode1 for TRG1 and 
TRG2 with 3 steps on manipulated variab1e CTCV. 

---Se v e rity n e tw o rk 
54 5 - --TRX network 

54 4 - --Severity modet 

543 v --TRX m ode I 542 = 
54 1 

54 o " ? 
i 7 8 ,o ~ 

o • )l f=' [ i 7 7 '5 
-~ ~77,0-• 
~ 

... 
• "' ~ 7 6,5 o 2 o o 400 60 o 800 1 o o o 

T im e (m in.) 

Fig. 4. Cornparative response between rigorous mode1 and the neural network mode1 for Severity ofthe 
cracicing reaction and Riser Temoerature with 3 steps on maninulated variab1e CTCV. 

Steps were also imposed to RAI, RTF and TFP variab1es. The behavior was similar to the 
previous one and the re1ative error obtained from the test data set is shown in the dispersion format 
in the Figures 5 to 10. It shou1d be noted that the sequence of steps in the test set is different from 
the sequence of the steps imposed for training and validation sets. These Figures shows the 
agreement between rigorous numerical sirnulations and the neural model. 



190 

78,4 
I . Oispersion I 

78,2 

78,0 

~ 77,8 

~ 77,6 
o 
~ 77,4 
b 77,2 
~ 

~ 77,0 
(/) 76,8 

76,6 

76,4 +:::..:..,......-,.~-,-~..-.-,.-,-.,-..-,-.-,-~,.-,_.., 
76.4 76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 

Severity model {%) 

6 
.e. 

546 

544 

i: 542 

~ 
c 540 

1;2 
1-

538 

I ~ Oispersion I 

538 540 542 

TRX model (oC) 

Fig. 5 and 6. Response of relative dispersion between model and network for Severity of cracking 
reaction and TRX for 3 ste s in RAI variable. 

78,4 I " Oispersion I 
78,2 

78,0 

~ 77,8 
Jn.s 
~ 77,4 

~ 772 .. ' 
&gt; 
~ 77,0 

76,8 

76,6 -~L~~~-,-~..-~.,...,....,_,......,...,....~~~ 
76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 

Severily model (%) 

548 

545 

544 

~543 
:i 542 .. 
c 541 

~ 
t- 540 

539 

: " Dispersíon ! 

538-IL-..-~~_...,~---,~-r--.--.,--
ssa 539 540 541 542 543 544 545 546 

TRX model (oC) 

Fig. 7 and 8. Response of relative dispersion between model and network for Severity of cracking 
reaction and TRX for 3 ste s in RTF variable. 

78,2 

78,0 

l77,8 

-E 77,6 

~ 
~ 77,4 

~ 
ctl 77,2 
~ 
ti) 77,0 

I • Dispersion I 

76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 

Severity model (%) 

546 LI ..:·~D="s"'!pe=rSJO~· ~n_jl 

545 

544 

~543 
"" .! 542 .. 
c 
~ 541 

..... 540 

539 

538~~.,-~~---..-..-..-..-..-~r-r-r-
538 539 540 541 542 543 544 545 546 

TRX model (oC) 

Fig. 9 and 10. Response of relative dispersion between model and network for Severity of cracking 
reaction and TRX for 3 ste s in TFP variable. 



191 

The results of the second structure of network (architecture 8x15x4) with convergence 
criteria of 1 o-3, are presented in the Figure 11 (Severity of the cracking reaction). The agreement 
between phenomeno1ogical mode1 and network can be better observed in figures 12 and 13. 

79 ,O 

78,5 

~ 
" 

78 ,O 
o 

15 .. 
77,5 i!! 

"' " :;;; 
r 
i 

Response of steps in 4 
manipulated variables 
--Network 

M ode! 

o 77 ,O 
!!! 
o 

" = w 'õ 76,5 ,., 
i 76,0 
" "' 

o 1 050 2100 
Time (m in.) 

3150 4200 

Fig. 11. The response of trained network in severity of the cracking reaction with 12 steps on ali 
mani ulated variables. 

78,6 

78
,
4 

! ~ Dispersíon 1 

78,2 

-78,0 

1t 77 8 
i! ' 
j 77,6 
:g 77,4 
=E 77,2 
~ 
~ 77,0 

76,8 

76,6 

76,4 +=.-.--.-,-~..,.-~...-,-~..,.--~~,-.-, 
76,4 76,6 76,8 77,0 77,2 77,4 77,6 77,8 78,0 78,2 78,4 78,6 

Severity model (o/o) 

546 
I • o;spersion I 

544 

~ 
~ 542 

~ 
c 540 

~ 
536 

540 542 544 

TRX model (oC) 

Fig. 12 and 13. The relative dispersion between the network and model results in Severity of the 
crac · reaction and TRX with 12 s on ali mani ulated variables. 

From the results, the architectures chosen for the FCC neural modeling were 5x15x4 and 
8x15x4. In ail tests, the relative error of the output variables was below 1%. As a result, reliable 
neural models were developed for the process identification and they could be used in a model 
predictive control structure for the FCC control. 

FINAL REMARKS 
This paper describes an identification procedure, based on artificial neural networks, of a Fluid 
Catalytic Cracking converter. A phenomenological model, validated with real operation data 
collected from a Kellogg Orthoflow F. converter, was used to generate a large data set of 
operational variables. A fully connected multilayer feedforward network was chosen for the FCC 
representation. Two different strategies were adopted for the network architecture: first, the input 
layer is composed of one manipulated variable and four controlled variables, and in the second 



192 

structure, is composed of four rnanipulated variables and four controlled variables. The main 
advantage of neural networks in comparison to the phenomenological model is the CPU processing 
time. In addition., it was also shown that both proposed structures yield high quality predictions of 
the controlled variables. From the results, the architectures chosen for the FCC neural modeling 
were 5x15x4 and 8xl5x4. In ali tests, the relative error ofthe output variables was below 1%. As a· 
result, reliable neural models were developed for the process identification and they could be used 
in a model predictive control structure for the FCC converter control. 

REFERENCES 
I Narendra, K. S. &amp;amp; Mukhopadhyay, S., 1997, 'Adaptive Control Using Neural Networks and 

Approximate Models'. IEEE Transactions on Neural Networks, 8(3), pp. 475-485. 
2 Narendra, K. S., 1996, 'Neural Networks for Control: Theory and Practice'. Proceeding of 

the IEEE, vol. 84(10), pp. 1385-1406. 
3 Nikravesh, M. Fareli, A. E. And Stanford, T. G., 1996, 'Model Identification of Nonlinear 

Time Variant Process via Artificial Neural Network'. Computers and Chemical Engineering, 
20(11), pp. 1277-1290. 

4 De Souza Jr, M. B. (1993) 'Redes Neuronais Multicamadas Aplicadas a Modelagem e 
Controle de Processos Químicos'. Dr. Thesis, COPPE!UFRJ, Brazil. 

5 Santos, V. M. L., Carvalho, F. R. And De Souza Jr, M. B. (2000) 'Predictive Control Based 
on Neural Networks: An Application to a Fluid Catalytic Cracking Industrial Unit'. Brazilian 
Journal of Chemical Engineering. 17(04-07), pp. 897. 

6 Ansari, R. M. and Tadé, M. O. (2000) 'Constrained nonlinear multivariable control of a fluid 
catalytic cracking process'. Journal ofProcess Contro/10, pp. 539-555. 

7 Wang, X. Z., Chen, B. H., Yang, S. H., C. McGreavy. (1999) 'Application ofwavelets and 
neural networks to díagnostic system development, 1, feature extraction'. Computers and 
Chemical Engineering 23, pp. 899-906. 

8 Wang, X. Z., Chen, B. H., Yang, S. H., C. McGreavy. (1999) 'Application ofwavelets and 
neural networks to díagnostic system development, 2, an integrated framework and its 
application'. Computers and Chemical Engineering 23 pp. 945-954. 

9 Aguilara, R., González, J, Rarnirez, J. A, Barrón, M. (1999) 'Control of a fluid catalytic 
cracking unit based on proportional-integral reduced order observers'. Journal of Chemical 
Engineering 75 pp. 77-85. 

10 Antoniades, C., Christofides, P. D. (1999) 'Feedback control of nonlinear differential 
difference equation systems'. Chemical Engineering Science 54 pp. 5677-5709. 

11 Zanin, A. C., M. Tvrzská de Gouvêa, M. and Odloak, D. (2000) 'Industrial implementation of 
a real-time optimization strategy for maximizing production of LPG in a FCC unit'. 
Computers and Chemical Engineering 24 pp. 525-531. 

12 Sarma, P. and Rengaswamy, R. (2000) 'Multivariable gain-scheduled fuzzy logic control of a 
fluidized catalytic cracker unit'. Computers and Chemical Engineering 24 pp. 1083-1089. 

13 Balchen, J.G., Lungquist D. and Strand S., (1992) 'State-space predictive control', Chemical 
Engineering Sei. 47 pp. 787-798. 

14 Grosdidier P., Mason A., Aitolabti A., Vanhumaki V., (1993) 'FCC Unit Regenerator/reactor 
control', Computers and Chemical Engineering 17 pp. 165-179. 

15 Ali, E.E. and Einashaie, S., (1997) 'Non-linear model predictive control ofindustrial type IV 
fluid catalytic cracking (FCC) units for maximum gasoline yield', Ind. and Engng. Chem. 
Res. 36 pp. 389-398. 

16 Moro, L. F. L. (1992) 'Desenvolvimento de um controlador preditivo multivariavel para um 
conversor industrial de Craqueamento Catalitico'. MSc. Thesis, USP/SP, Brazil. 

17 Haykin, S. (1994) 'Neural Networks- A Comprehensive Foundation' Macmillan Publishing 
Co. NJ, 696p. 

18 Simpson, P. K. (1990) 'Artificial Neural Systems: Foundations, Paradígms, Applications and 
Implementations'. Pergamon Press, Inc., NY, 203p. 



19 Baughman, D. R. &amp;amp; Liu, Y. A. (1995) 'Neural Networks in Bioprocessing and Chemical 
Engineering'. Academic Press, Inc. London, 489p. 

193 

20 Hecht-Nie1sen, R. (1989) 'Theory ofthe Backpropagation Neural Network', IEEE lnt. Conf 
On Neural Networks, l, pp. 593-605. 




</field>
	</doc>
</add>