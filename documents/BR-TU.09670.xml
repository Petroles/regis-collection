<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09670</field>
		<field name="filename">14659_TESE%20Leonardo%20Correia%20de%20Oliveira.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">àu
w
UNIVERSIDADE FEDERAL DE PERNAMBUCO CENTRO DE TECNOLOGIA E GEOCIÊNCIAS DEPARTAMENTO DE ENGENHARIA CIVIL
ESTRATÉGIA HÍBRIDA APLICADA AO GERENCIAMENTO ÓTIMO DE RESERVATÓRIOS
TESE DE DOUTORADO APRESENTADA POR:
Leonardo Correia de Oliveira
Orientado por: Silvana Maria Bastos Afonso da Silva Co-orientado por: Bernardo Horowtiz
REDE SIGER
Rede Temática de Simulação e Gerenciamento de Reservatórios
Recife, PE - Brasil Junho de 2013.
ó¿¿
^¡sjns^
UNIVERSIDADE FEDERAL DE PERNAMBUCO CENTRO DE TECNOLOGIA E GEOCIÊNCIAS DEPARTAMENTO DE ENGENHARIA CIVIL
ESTRATÉGIA HÍBRIDA APLICADA AO GERENCIAMENTO ÓTIMO DE RESERVATÓRIOS
POR:
Leonardo Correia de Oliveira
Tese submetida ao Corpo Docente do Curso de Pós-Graduação da Universidade Federal de Pernambuco, como parte dos requisitos necessários à obtenção do Grau de Doutor em Ciências em Engenharia Civil.
Orientadora: Silvana Maria Bastos Afonso da Silva
Co-orientador: Bernardo Horowitz
Recife, PE - Brasil Junho de 2013.
Catalogação na fonte
Bibliotecária Margareth Malta, CRB-4 / 1198
O48e Oliveira, Leonardo Correia de.
Estratégia híbrida aplicada ao gerenciamento ótimo de reservatórios / Leonardo Correia de Oliveira. - Recife: O Autor, 2013.
xv, 101 folhas, il., gráfs., tabs.
Orientadora: Profa. Dra. Silvana Maria Bastos Afonso da Silva. Coorientador: Prof. Dr. Bernardo Horowtiz.
Tese (Doutorado) - Universidade Federal de Pernambuco. CTG. Programa de Pós-Graduação em Engenharia Civil, 2013.
Inclui Referências.
1. Engenharia Civil. 2. Estratégia híbrida. 3. Otimização da produção. 4. Gerenciamento de reservatórios. 5. Modelos substitutos. 6. Manipulação de restrições. I. Silva, Silvana Maria Bastos Afonso da. (Orientadora). II. Horowtiz, Bernardo. (Coorientador). III. Título.
UFPE
624 CDD (22. ed.)
BCTG/2014-170
UNIVERSIDADE FEDERAL DE PERNAMBUCO PROGRAMA DE PÓS-GRADUAÇÃO EM ENGENHARIA CIVIL
A comissão examinadora da Defesa de Tese de Doutorado
ESTRATÉGIA HÍBRIDA APLICADA AO GERENCIAMENTO ÓTIMO DE RESERVATÓRIOS
defendida por
Leonardo Correia de Oliveira
Considera o candidato APROVADO
Recife, 06 de junho de 2013
Orientadores:
Prof.a Dr.a Silvana Maria Bastos Afonso da Silva - UFPE (orientadora)
Banca Examinadora:
Prof. Dr. Bernardo Horowitz - UFPE (co-orientador)
Prof.a Dr.a Silvana Maria Bastos Afonso da Silva - UFPE (orientadora)
Dr. Régis Kruel Romeu - Petrobrás (examinador externo)
Prof. Dr. Afonso Celso de Castro Lemonge - UFJF (examinador externo)
Prof. Dr. Enrique Andrés López Droguett - UFPE (examinador externo)
Prof. Dr. Ramiro Brito Willmersdorf - UFPE
(examinador interno)
Prof. Dr. Paulo Roberto Maciel Lyra - UFPE (examinador interno)
Agradecimentos
Aos meus pais e irmão, que compreenderam os momentos de estresse.
Aos meus amigos de jornada, Jeff, Júlio, Lili, Marco, Mariella, Lord Rento, Sa-muca e Sérgio, que acompanharam a luta diária no laboratório .
Aos meus amigos Glaybson, Giorgio e Toinho, que me incentivaram a perseverar na caminhada quando as incertezas sugiram.
Aos meus amigos, Rafael, Diego, Danilo, Filipe, Jensen e Márcio, de noitadas geeks, regadas a álcool, jogos e pulhas lendárias.
Aos meus amigos Érickinha, Isis, Tay, Thyago e Thyale, que me mostraram que tempo e espaço rompem laços fortes de amizade.
Aos meus amigos Danniel, Lucas, Larissa, Seu Walmir e D. Valéria, e especialmente ao meu amigo/irmão Thomás, que partiu sem presenciar o momento de finalização desse trabalho, pela torcida para realização deste trabalho.
Aos professores Leonardo, Lemonge, Paulo Lyra, Ramiro, que contribuíram com a partilha do conhecimento.
Ao professor Ézio, que além de contribuir com conhecimento me ajudou com sua sabedoria.
Ao professor Bernardo, que aceitou a tarefa de colabora com a orientação desse trabalho.
À professora Silvana, que há nove anos me aceitou como aluno de iniciação científica, dando início à longa caminhada que resultou neste trabalho, me ensinado a lidar com os altos e baixos da pesquisa, me encorajando nos momentos de falha a não desistir e procurar às soluções para os problemas.
Resumo
Os algoritmos de busca global seriam os mais indicados para realizar o processo de otimização da produção de reservatórios de petróleo, devido às características do problema, sendo uma das principais, a multimodalidade. No entanto, a necessidade de um número elevado de avaliações de função torna essa alternativa impraticável, principalmente à medida que a complexidade do problema cresce, pois, a convergência se dá de forma lenta, apesar da solução ser “identificada” nas primeiras iterações. Essa característica representa um dos principais aspectos negativos destes algoritmos, e é alvo de inúmeras pesquisas na área.
Sabe-se que os algoritmos de busca local são bastante eficazes no processo de convergência para a obtenção da solução ótima, porém, o resultado está relacionado com o ponto inicial fornecido, ou seja, várias tentativas com pontos iniciais diferentes são necessárias para encontrar um resultado global, e ainda assim sem garantias.
Na tentativa de combinar as características positivas dos algoritmos de otimização para resolver problemas de gerenciamento de reservatórios de petróleo, uniobjetivo e multiobjetivo, algumas estratégias híbridas são consideradas.
Os processos adotados realizam a busca em duas etapas. Na primeira etapa é utilizado um algoritmo evolucionário, para identificar a provável região de localização das soluções globais, e, na segunda etapa, um algoritmo baseado em programação matemática, para refinar as soluções encontradas na etapa anterior.
Para melhorar o desempenho das estratégias, algumas metodologias para manipulação de restrições são empregadas com o intuito de auxiliar a busca realizada pelos algoritmos evolucionários, que possuem dificuldades em lidar com problemas restritos.
Na engenharia de um modo geral, os métodos aproximados são extensivamente utilizados de forma a obter soluções para os problemas complexos nos quais os engenheiros lidam no dia a dia. Nesse trabalho são adotadas funções substitutas com a finalidade de obter uma resposta computacional mais rápida, e também um comportamento mais suave e/ou simplificado das funções que são de custo computacional elevado.
O fator essencial na aproximação é substituir as funções de alta fidelidade por funções mais simples de serem calculadas e usá-las durante o processo de otimização. O emprego dos modelos substitutos com as estratégias híbridas são aplicadas de forma distinta em cada etapa da otimização.
De maneira geral, os problemas de otimização da explotação de um campo de petróleo estão relacionados à produção propriamente dita ou a economia do projeto. Nos estudos apresentados são tratados problemas dos dois tipos, onde o objetivo relacionado aos aspectos econômicos está presente nos problemas uniobjetivo e os relacionados a produção propriamente dita estão presentes no problema multiobjetivo. As combinações sugeridas apresentam resultados bastante satisfatórios, com a consistência verificada dos mesmos.
Palavras-chave: Estratégia híbrida; Otimização da produção; Gerenciamento de reservatórios; Modelos substitutos; Manipulação de restrições.
Abstract
The global search algorithms would be the most suitable options to perform the process of oil production optimization, due to the multimodality characteristics of the problem. However, a large amount of function evaluations needed in the process turns it into an impractical alternative, particularly when the complexity of the problem grows, because the convergence occurs slowly, even if the solution is “identified” in early iterations. This characteristic is one of the negative aspects of these algorithms, and is subject of numerous studies in this area.
It is known that the local search algorithms have fast convergence, however, the result depends on the given initial design, in other words, several tries with different initial design are needed to find a global optimal solution, and still with no guarantees.
Attempting to combine the positive features of different optimization algorithms to solve management reservoirs problems, under uniobjetive and multiobjective consideration, some hybrid strategies are considered.
The processes used perform the search in two steps. The first step considers an evolutionary algorithm to identify the region where the global solution probably is located, and the second step considers an algorithm based on mathematical programming to refine the solutions found in the previous step.
To improve the performance of the strategies, some constraints handling methods are employed in order to help the search performed by evolutionary algorithms which have difficulties to deal with constrained problems.
In engineering, surrogate methods are used in order to obtain solutions in complex problems. In this work surrogate functions are considered in order to get a faster computer response, and also a smoother and/or simplified behaviour from functions that have a high computational cost.
The main aspect in the approach is to replace the high fidelity functions with simpler functions and use them during the optimization process. The use of surrogate models with hybrid strategies are implemented in different ways on each step during the optimization process.
In general, optimization of exploitation problems is related to the production properly or to the economics. The studies present both types of problems, the objective related to economic aspects are presented in uniobjective problems and objectives related to the production properly are presented on multiobjective problem. The suggested combinations present satisfactory results with checked accuracy.
Keywords: Hybrid strategy; Production optimization; Reservoir management;
Surrogate models; Constraints handling.
Sumário
LISTA DE FIGURAS..............................................IX
LISTA DE TABELAS..............................................XI
LISTA DE SÍMBOLOS...........................................XIII
CAPÍTULO 1 - INTRODUÇÃO........................................1
1.1	Motivação................................................1
1.2	Metodologias.............................................3
1.3	Objetivos................................................4
1.4	Definição do problema: Gerenciamento de vazões em reservatórios
DE PETRÓLEO..............................................4
1.5	Revisão da literatura....................................5
1.6	Formulação do problema de injeção de água................8
1.6.1	Consideração de uma função objetivo.....................9
1.6.2	Otimização simultânea de objetivos..................11
1.7	Organização do trabalho.................................11
CAPÍTULO 2 - MODELOS SUBSTITUTOS..............................13
2.1	VISÃO GERAL............................................ 13
2.2	Plano de amostragem.....................................15
2.3	Krigagem................................................16
2.4	Desempenho do modelo substituto.........................18
CAPÍTULO 3 - ESTRATÉGIAS DE OTIMIZAÇÃO UNIOBJETIVO............20
3.1	VISÃO GERAL.............................................20
3.2	Estratégia local - Programação matemática...............21
3.2.1	Programação Sequencial Quadrática.......................22
3.2.2	Otimização Sequencial por Aproximação...................23
3.2.2.1	CORREÇÃO DO MODELO LOCAL............................25
3.2.2.2	Atualização da região de confiança..................26
3.2.3	Multimodalidade.....................................27
3.3 Estratégia global - Algoritmos evolucionários...............29
3.3.1	Algoritmo Genético..................................30
3.3.1.1	OPÇÕES DO ALGORITMO GENÉTICO E OPERADORES GENÉTICOS.31
3.3.1.2	Manipulação de restrições.......................35
3.3.2	Aproximação global - modelo substituto adaptativo.......39
3.3.3	Análise do custo computacional......................41
3.4	Estratégia híbrida......................................42
3.4.1	Análise de desempenho...............................43
CAPÍTULO 4 - ESTRATÉGIAS DE OTIMIZAÇÃO MULTIOBJETIVO..........46
4.1 VISÃO GERAL.............................................46
4.2	Dominância..................................................47
4.3	Convexidade.................................................48
4.4	Métodos de geração de pontos de Pareto......................48
4.4.1	Métodos de otimização multiobjectivo através da programação
matemática..............................................49
4.4.1.1	Método da intersecção contorno-normal (NormalBoundary Intersection -NBI)................................49
4.4.1.2	Otimização Sequencial de Múltiplos Objetivos por Aproximação com o Método da Intersecção Contorno-
Normal...............................................51
4.4.2	Métodos de otimização multiobjetivo com algoritmos
evolucionários..........................................53
4.4.2.1	Funções agregadas...................................54
4.4.2.2	Abordagens populacionais............................54
4.4.2.3	Abordagens de Pareto................................54
4.4.3	Estratégia híbrida para resolução de problemas multiobjetivo .... 59
CAPÍTULO 5 - casos estudados.....................................61
5.1 Otimização do primeiro reservatório.........................61
5.1.1	Resultados obtidos nos estudos de problemas uniobjetivo para o
primeiro reservatório...................................62
5.1.2	Resultados obtidos nos estudos de problemas multiobjetivo para
o primeiro reservatório.................................76
5.2	Otimização do segundo reservatório..........................81
5.2.1	Resultados obtidos nos estudos de problemas uniobjetivo para o
segundo reservatório....................................84
5.2.2	Resultados obtidos nos estudos de problemas multiobjetivo para
o segundo reservatório..................................90
CAPÍTULO 6 - OBSERVAÇÕES finais..................................94
6.1	Conclusões..................................................94
6.2	Sugestões para trabalhos futuros............................95
BIBLIOGRAFIA.....................................................96
Lista de Figuras
Figura 1.1 - Participação das diversas fontes de energia no consumo (1973 e
2006) (fonte: ANEEL, 2008).....................................2
Figura 1.2- Comportamento adimensional da injeção acumulada versus a
produção acumulada de óleo (adaptação de (Rosa et. al., 2006)).5
Figura 2.1- Exemplo dos diferentes tipos de aproximação: (a) espaço de
projeto; (b) aproximação local; (c) aproximação de médio-alcance;
(d) aproximação global.........................................14
Figura 2.2- Reservatório considerado para verificar desempenho do
MODELO SUBSTITUTO (MAPA DE PERMEABILIDADE)..................... 18
Figura 2.3 - Superfície de resposta e curvas de nível para o VPL: (a) e (c)
MODELO DE ALTA FIDELIDADE; (B) E (d) MODELO SUBSTITUTO......... 19
Figura 3.1 - Representação gráfica da função Shubert: (a) representação
em 3D e (b) vista superior.....................................28
Figura 3.2- Soluções encontradas com o algoritmo de busca local.......29
Figura 3.3- Descrição ilustrativa da função f (x).....................38
Figura 3.4- Convergência da população para melhor solução encontrada
com o algoritmo de busca global................................42
Figura 3.5- Solução encontrada com a estratégia híbrida nas etapas (a)
GLOBAL E (B) LOCAL.............................................44
Figura 4.1 - nível de preferência e relação de dominância.............47
Figura 4.2 - Exemplo de conjunto (a) convexo e (b) não-convexo........48
Figura 4.3 - Representação gráfica da solução de um subproblema NBI...51
Figura 5.1 - Definição dos ciclos de controle para o problema 1.......63
Figura 5.2- Curvas de produção acumulada com os resultados obtidos pelo
GA, pelo SAO e pelo GlfLlf para o problema OCT-TF 1............65
Figura 5.3- Curvas de produção acumulada com os resultados obtidos pelo
GA, pelo SAO e pelo GlfLlf para o problema OCT-TF 2............67
Figura 5.4 - Condições de operação para modificação dos tempos dos ciclos
de controle................................................67
Figura 5.5- Curvas de produção acumulada com os resultados obtidos pelo
GA, pelo SAO e pelo GlFLlF para o problema OCT-TV 1............69
Figura 5.6- Curvas de produção acumulada com os resultados obtidos pelo
GA, pelo SAO e pelo GlFLlF para o problema OCT-TV 2............71
Figura 5.7 - Definição dos ciclos de controle para o problema 3.......72
Figura 5.8 - Curvas de produção acumulada com os resultados obtidos
pelo GA, pelo SAO e pelo GlFLlF para o problema OCNT-TF........73
Figura 5.9- Curvas de produção acumulada com os resultados obtidos pelo
SAO e pelo GlFLlF para o problema OCNT-TV......................76
Figura 5.10 - Soluções obtidas pela estratégia híbrida, MO_GhFLhF, nas
fases (a) global e (b) local...................................78
Figura 5.11- Soluções obtidas pela estratégia híbrida, MO_GlfLHf, nas
fases (a) global e (b) local................................79
Figura 5.12- Soluções obtidas pela estratégia híbrida, MO_GlFLlF, nas
fases (a) global e (b) local................................80
Figura 5.13 - Representação da localização da melhor solução de Pareto ... 81
Figura 5.14 - Modelo para o segundo reservatório, com locação dos poços. . 82 Figura 5.15- Mapa de permeabilidade das camadas do segundo
reservatório: (a) camada 1; (b) camada 2; (c) camada 3; (d) camada
4; (e) camada 5; (f) camada 6...............................83
Figura 5.16 - Definição dos ciclos de controle para o problema 1...85
Figura 5.17- Curvas de produção acumulada com os resultados obtidos
pelo SAO e pelo GlFLlF para o problema OCT-TF 1.............87
Figura 5.18- Curvas de produção acumulada com os resultados obtidos
pelo SAO e pelo GlFLlF para o problema OCT-TF 2.............88
Figura 5.19- Curvas de produção acumulada com os resultados obtidos
pelo SAO e pelo GlFLlF para o problema OCNT-TV..............90
Figura 5.20 - Soluções obtidas pela estratégia híbrida, MO_GlFLlF, nas
fases (a) global e (b) local................................91
Lista de Tabelas
Tabela 2.1 - Resumo das características do modelo do reservatório.....18
Tabela 3.1 - Termo de aceitação no esquema da região de confiança.....27
Tabela 3.2- Resumo dos resultados obtidos com o GA para a função
Shubert.........................................................41
Tabela 3.3 - Resumo dos resultados obtidos com a estratégia híbrida para a função Shubert..............................................44
Tabela 5.1- Problemas uniobjetivo estudados para o primeiro reservatório. 62
Tabela 5.2 - Estratégias consideradas na otimização dos problemas de
otimização uniobjetivo para o primeiro reservatório........62
Tabela 5.3- Resultados obtidos no problema OCT-TF 1...................64
Tabela 5.4 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 1.64
Tabela 5.5 - Valores das vazões obtidas pelo GA para o caso OCT-TF 1..64
Tabela 5.6 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TF 1.... 64
Tabela 5.7- Resultados obtidos no problema OCT-TF 2...................65
Tabela 5.8 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 2.66
Tabela 5.9 - Valores das vazões obtidas pelo GA para o caso OCT-TF 2..66
Tabela 5.10 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TF 2 .. 66
Tabela 5.11- Resultados obtidos no problema OCT-TV 1..................68
Tabela 5.12 - Valores das vazões obtidas pelo SAO para o caso OCT-TV 1 68
Tabela 5.13 - Valores das vazões obtidas pelo GA para o caso OCT-TV 1.69
Tabela 5.14 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TV 1.69
Tabela 5.15- Resultados obtidos no problema OCT-TV 2..................69
Tabela 5.16 - Valores das vazões obtidas pelo SAO para o caso OCT-TV 2 70
Tabela 5.17 - Valores das vazões obtidas pelo GA para o caso OCT-TV 2.70
Tabela 5.18 - Valores das vazões obtidas pelo GLfLLf para o caso OCT-TV 2.70
Tabela 5.19 - Resultados obtidos no problema OCNT-TF..................72
Tabela 5.20 - Valores das vazões obtidas pelo SAO para o caso OCNT-TF 73
Tabela 5.21 - Valores das vazões obtidas pelo GA para o caso OCNT-TF..73
Tabela 5.22 - Valores das vazões obtidas pelo GLfLLf para o caso OCNT-TF.. 73
Tabela 5.23 - Resultados obtidos no problema OCNT-TV..................75
Tabela 5.24 - Valores das vazões obtidas pelo SAO para o caso OCNT-TV.75
Tabela 5.25 - Valores das vazões obtidas pelo GLfLLf para o caso OCNT-TV . 75
Tabela 5.26 - Estratégias consideradas na otimização dos problemas de otimização multiobjetivo para o primeiro reservatório.............77
Tabela 5.27 - Resultados obtidos pelo MO_GHFLHF para o problema multiobjetivo do primeiro reservatório......................78
Tabela 5.28 - Resultados obtidos pelo MO_GLfLhf para o problema multiobjetivo do primeiro reservatório......................79
Tabela 5.29 - Resultados obtidos pelo MO_GLfLLf para o problema multiobjetivo do primeiro reservatório......................80
Tabela 5.30 - número de avaliações necessárias para obtenção da frente
de Pareto.......................................................81
Tabela 5.31-Resumo das características do modelo do reservatório.....83
Tabela 5.32- Problemas uniobjetivo estudados para o segundo
reservatório...............................................84
Tabela 5.33 - Estratégias consideradas na otimização dos problemas de otimização uniobjetivo para o segundo reservatório................84
Tabela 5.34- Resultados obtidos no problema OCT-TF 1..............86
Tabela 5.35 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 1 86
Tabela 5.36 - Valores das vazões obtidas pelo GLFLLF para o caso OCT-TF 1 .. 86
Tabela 5.37- Resultados obtidos no problema OCT-TF 2..............87
Tabela 5.38 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 2 87
Tabela 5.39 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TF 2 .. 88
Tabela 5.40- Resulados obtidos no problema OCNT-TV................89
Tabela 5.41 - Valores das vazões obtidas pelo SAO para o caso OCT-TV.89
Tabela 5.42 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TV .... 90
Tabela 5.43 - Resultados obtidos pelo MO_GhfLhf para o problema multiobjetivo do primeiro reservatório............................92
Tabela 5.44 - Resultados obtidos no problema OCNT-TF..............93
Lista de Símbolos
Abreviações:
ACE	Automatic Computing Engine
ACO	Ant Colony Optimization
BFGE	Broydon-Fletcher-Goldfarbo-Shanno
BHP	Bottom Hole Pressure
CHIM	Convex Hull of Individual Minima
CVT	Centroidal Voronoi Tessellation
DFO	Derivative Free Optimization
DoE	Design of Experiment
EA	Evolutionary Algorithms
EDWA	Evolutionary Dynamic Weitghted Aggregation
EMO	Evolutionary Multobjective Optimization
EPT	Evolutionary Programming Techniques
ES	Evolution Strategies
GA	Genetic Algorithm
HF	High fidelity
IBP	Instituto Brasileiro de Petróleo
KKT	Karush Kuhn &amp;amp; Tucker
LCVT	Latinizaed Centroidal Voronoi Tessellation
LF	Low fidelity
LHS	Lattin Hypercube Sampling
MOGA	Multiobjective Genetic Algorithm
MOPSO	Multiobjective Particle Swarm Optimization
NBI	Normal-Bondary Intersection
NPL	National Physics Laboratory
NPGA	Niched-Pareto Genetic Algorithm
NPGA 2	Niched-Pareto Genetic Algorithm 2
NSGA	Non-dominated Sorting Genetic Algorithm
NSGA II	Non-dominated Sorting Genetic Algorithm II
OCT	Operação em capacidade topada
OCNT	Operação em capacidade não topada
PAES	Pareto Archived Evolution Strategy
PESA	Pareto Envelope-based Selection Algorithm
PRESS	Predicted Error Sum of Squares
PS	Pattern Search
PSO	Particle Swarm Optimization
RGO	Razão gás-óleo
RMSE	Root Mean Square Error
SA	Simulated Annealing
SAO	Sequential Approximate Optimization
SPEA	Strength Pareto Evolutionary Algorithm
SPEA 2	Strength Pareto Evolutionary Algorithm 2
SQP	Sequential Quadratic Programming
tep	Toneladas equivalentes de petróleo
TIR	Taxa Interna de Retorno
TS	Tabu Search
VEGA	Vector Evaluation Genetic Algorithm
VOIP VPL WS	Volume de óleo in place Valor Presente Líquido Weighted Sum
Romanos:
Escalares
cos d f f* f Ft	Função cosseno Taxa de desconto aplicada ao capital Função objetivo Valor ótimo da função Função substituta Fluxo de caixa
gj g j	Função de restrição de desigualdade Função substituta para restrição de desigualdade
hi	Função de restrição de igualdade
h, idist Irank I k kh kj kv L maxGen Nj Np nvar P Psat qp,t Qprod,max Qí'n/,max R shrink T t	Função substituta para restrição de igualdade Distância da aglomeração Posto de Pareto Poços injetores Iterando Permeabilidade horizontal Parâmetro de penalização Permeabilidade vertical Função Lagrangeana Número de gerações máximas Polinômios Volume produzido acumulado de óleo Número total de variáveis Poços produtores Pressão de saturação Vazão do poço Vazão máxima permitida de fluído no conjunto de poços produtores Vazão máxima permitida de água injetada no conjunto de poços injetores Função de correlação entre cada dois amostrais Fator de retração Tempo de concessão do projeto Tempo Iterando
Wi xt xt,min xt,max xp,t xAt,k vj	Volume de água injetada acumulado Variável de projeto Limite inferior das variáveis de projeto Limite superior das variáveis de projeto Razão de vazão alocada Variável relacionada à duração dos ciclos de controle (normalizada) Quantidade de violação das restirções
Z	Erro
Vetores	
b	Vetor com os termos independentes para as restrições lineares de desigualdade
f	Vetor com m elementos 1
F	Vetor de fUnções objetivo
F	Vetor de fUnções objetivo substitutas
F *	Ponto utópico
f.	Vetor com os valores reais da função dos pontos amostrais
n	Versor quase-normal
r	Vetor direção de busca
u	Parâmetros que não podem ser controlados como propriedades das rochas e dos fluidos no reservatório
x	Vetor com as variáveis de projeto
* x	Vetor solução
xc,k	Ponto central da região de confiança
Matrizes	
A	Matriz com os coeficientes lineares das restrições de desigualdade
R	Matriz de correlação
Gregos:	
Escalares	
a	Relação entre as vazões máximas permitidas para conjuntos de poços inje-tores e produtores Passo na direção de busca
Ni	Tamanho da região de confiança
Ntk	Variável relacionada à duração dos ciclos de controle
P	Média
n	Produtório
o	Desvio padrão
o'share	Parâmetro de partilha
o2	Variância
E	Somatório
P	Termo de aceitação para atualização da região de confiança
6k	Parâmetros de correlação
Vetores	
P	Vetor de parâmetros que indicam os pesos para os subproblemas NBI
	Vetor com multiplicadores de Lagrange Parâmetros de ativação das restrições
Capítulo 1 - Introdução
A ideia central deste trabalho é o desenvolvimento de estudos na área de engenharia de reservatórios, mais especificamente, na utilização de ferramentas computacionais para otimização da produção. Como resultado do crescimento da população mundial e o desenvolvimento econômico, acredita-se que o consumo de energia no mundo todo será maior do que o consumo dos dias atuais, apesar dos ganhos em eficiência energética. Em 2005, o petróleo e o gás natural representavam 60% da fonte de energia mundial (IEA, 2010), e as previsões indicam que continuarão sendo durante décadas.
No contexto de otimização da produção em reservatórios de petróleo, a pesquisa desenvolvida tem ênfase no estudo da alocação dinâmica das vazões nos poços de produção e injeção.
1.1	Motivação
O consumo de energia é um dos principais indicadores do desenvolvimento econômico e do nível de qualidade de vida de uma sociedade. Ele reflete tanto o ritmo de atividade dos setores industrial, comercial e de serviços, quanto à capacidade da população para adquirir bens e serviços tecnologicamente mais avançados, como automóveis (que demandam combustíveis), eletrodomésticos e eletroeletrônicos (que exigem acesso à rede elétrica e pressionam o consumo de energia elétrica). Essa inter-relação foi o principal motivo do acentuado crescimento no consumo mundial de energia verificado nos últimos anos (ANEEL, 2008).
O desenvolvimento industrial possibilitou a sociedade uma série de beneficios nos mais variados campos, tais como, automotivo, aeronáutico, naval, agroindustrial e petroquímico. Entretanto, o caminho de qualquer nação para alcançar o desejado sucesso econômico apresenta sérios obstáculos, e com certeza, um dos principais é como suprir o aumento da demanda energética.
O atlas de energia do Brasil (ANEEL, 2008) afirma a importância do acesso à energia da seguinte forma: “Uma das variáveis para definir um país como desenvolvido é a facilidade de acesso da população ao serviço de energia”, no mesmo documento tem-se a seguinte afirmação: “A energia é o fator determinante para o desenvolvimento econômico e social ao fornecer apoio mecânico, térmico e elétrico às ações humanas”.
Na edição de 2010 do Key World Energy Statistics (IEA, 2010), é apresentada uma estatística do consumo total de energia no período de 1973 a 2008, que passou de 4.676 milhões de toneladas equivalentes de petróleo (tep) para 8.428 milhões, o que representa um aumento de aproximadamente 80%. Neste quadro, petróleo e gás representam aproximadamente 60% do consumo total de energia (IEA, 2010). Na Figura 1.1 é ilustrada a participação de diversas fontes de energia no consumo referente ao período compreendido entre 1973 e 2006 (ANEEL, 2008).
Figura 1.1- Participação das diversas fontes de energia no consumo (1973 e 2006) (fonte: ANEEL, 2008)
Apesar da procura crescente, em muitos campos ao redor do mundo, a produção de petróleo atingiu um platô onde o número de descobertas significativas tem caído com o passar dos anos. Como resultado, a indústria de petróleo e gás tem investido esforços no desenvolvimento de tecnologias para gerenciamento eficaz de reservatórios, com o intuito de otimizar a produção dos mesmos.
Um aspecto importante relacionado aos reservatórios de petróleo é o fator de recuperação, que, em média, atinge 30% (Thomas, 2001; Rosa et. Al., 2006), ou seja, 70% do óleo continuam no reservatório. Este aspecto indica uma forte necessidade de investimentos em pesquisa para desenvolvimento de novas metodologias, com o intuito de reduzir custos, riscos, aumentar o fator de recuperação, e claro, elevar a retorno financeiro. Vale mencionar que os resultados numéricos exercem fundamental importância para definição da estratégia de produção a ser aplicada em determinado reservatório, como também durante todo o período de gerenciamento do reservatório.
Outro importante fator de motivação é a descoberta das reservas de óleo brasileiras na camada do pré-sal, localizadas em torno de oito mil metros de profundidade abaixo do nível do mar. A extração de petróleo no pré-sal exigirá um elevado investimento em pesquisa e no desenvolvimento de soluções inovadoras, que irão permitir a produção de óleo e gás com viabilidade econômica e ambiental. No cenário relacionado à produção de hidrocarbonetos do pré-sal, a utilização de ferramentas de simulação numérica ocupará importante lugar no conjunto de metodologias de auxílio para o processo de tomada de decisões e gerenciamento integrado dos reservatórios.
No contexto de gerenciamento eficiente de reservatórios, a otimização da produção implica em maximizar a produção de petróleo e/ou gás, ou em minimizar os custos com a mesma, para aumentar os lucros durante um período de tempo especificado para exploração, encontrando um conjunto de variáveis de controle, como a razão da vazão nos poços ou a pressão no fundo do poço (Bottom Hole Pressure - BHP). Como a relação com essas variáveis é bastante não linear, encontrar o conjunto ótimo com as mesmas é uma tarefa desafiadora.
Os problemas de otimização da produção em reservatórios de petróleo envolvem, em geral, modelos complexos e com elevada demanda computacional. Nessas circunstâncias, este trabalho tem ênfase no estudo de alocação dinâmica das vazões nos poços de produção e injeção (Oliveira, 2006).
Reconhecida a importância das simulações numéricas para otimização, um grande obstáculo é encontrado devido ao elevado custo computacional por simulação, logo, se faz necessário o desenvolvimentos de metodologias que possibilitem uma redução significativa do custo computacional.
1.2	Metodologias
Na formulação matemática considerada para os problemas que envolvem simulação de reservatórios, é comum encontrar funções que apresentam características multi-modais bem como singularidades ao longo do domínio de projeto. Devido a tais características, se torna bastante indicado o uso de algoritmos evolucionários (Evolutionary Algorithms - EA), que têm como principais qualidades, a identificação de ótimos globais, ou próximos ao global, e a determinação de soluções em problemas discretos (Oliveira, 2008). Apesar das qualidades citadas dos EAs, algumas desvantagens tornam restrito o uso dos mesmos, pois necessitam de muitas avaliações de funções até atingir a convergência.
Para resolver o problema, é adotada uma metodologia que combina estratégias de otimização global e local, denominada como estratégia híbrida de otimização. Neste trabalho foi considerado um algoritmo de programação matemática acoplado ao EA. Dentre os algoritmos existentes, o algoritmo genético (Genetic Algorithm - GA) (Goldberg, 1989) é utilizado na classe dos EAs, e o algoritmo de programação sequencial quadrática (Sequential Quadratic Programming - SQP) (Michalewicz &amp;amp; Dasgupta, 1997) foi considerado como algoritmo de programação matemática.
Devido ao alto custo computacional das simulações numéricas exigida, estratégias de aproximação são apontadas na literatura como um instrumento poderoso para superar esse tipo de problema. Vale ressaltar que a utilização de modelos substitutos não elimina a consideração do uso da estratégia híbrida, pois, mesmo operando sobre modelos substitutos, os EAs apresentam outras características que inviabilizam a utilização dos mesmos individualmente. Dentre as técnicas de aproximação existentes, é abordada a técnica de krigagem (Valente, 1982). O modelo substituto é aplicado de maneira diferente em cada etapa no processo de otimização realizado pela estratégia híbrida.
Ao se considerar a avaliação da função por modelos substitutos, uma nova abordagem pode ser feita na segunda etapa da otimização híbrida. O modelo substituto é incorporado em um processo iterativo, que decompõe o problema original em vários subproblemas de otimização sequenciados, e cada subproblema é confinado em uma região pequena do espaço de projeto. Este processo é chamado de otimização com aproximação sequencial (Sequential Approximate Optimization - SAO) (Alexandrov et. al., 1997; Eldred et. al., 2004).
Uma situação mais desafiadora, que aproxima a resolução de problemas considerando a simulação numérica dos interesses da indústria do petróleo, é a otimização de vários objetivos simultaneamente. A otimização multiobjetivo se faz necessária quando os objetivos envolvidos no problema são conflitantes, ou seja, a melhoria de um objetivo implica necessariamente na piora do outro. Na indústria do petróleo, podem ser relacionados, por exemplo, a maximização do óleo produzido acumulado enquanto sequer
minimizar a água injetada, ou de maneira mais generalizada, se deseja minimizar o investimento realizado no processo de explotação enquanto o retorno financeiro é maximizado.
1.3	Objetivos
Este trabalho tem como objetivo apresentar os estudos realizados sobre as metodologias empregadas na otimização de problemas de engenharia de petróleo relacionados ao gerenciamento ótimo da produção de um reservatório. O foco principal é demonstrar a utilização de métodos combinados para a otimização de problemas de reservatórios de petróleo como uma alternativa bastante adequada às necessidades apresentadas pela indústria do petróleo. Além disso, é discutida e introduzida uma proposta de metodologia que possibilita a resolução de vários objetivos simultaneamente.
São definidas: as teorias referentes às metodologias empregadas; os resultados que demonstram a empregabilidade das mesmas; e algumas propostas referentes à melhoria do desempenho da metodologia.
1.4	Definição do problema: Gerenciamento de vazões em reservatórios de petróleo
A investigação de problemas de gerenciamento das vazões de produção e injeção em reservatórios de petróleo vem aumentando nos últimos anos devido aos processos na área de campos inteligentes. As operações nesse âmbito buscam a integração de todas as áreas de desenvolvimento de um campo: poço, elevação, reservatório, automação, instalações submarinas e de superfície, etc. O IBP (Instituto Brasileiro de Petróleo) define campos inteligentes como o gerenciamento integrado de produção e reservatório que envolve monitoração, modelagem e controle em tempo real.
A melhoria do desenvolvimento de um campo de petróleo não depende apenas das condições dos reservatórios, mas também da configuração de operação dos poços e dos equipamentos de superfície. Em alguns campos, a otimização da operação de produção pode ser o fator mais importante para o aumento da produção e a redução dos custos.
Em sistemas grandes e mais complexos, abordagens sofisticadas são necessárias para determinar de maneira mais precisa o comportamento do sistema de produção e examinar alternativas operacionais mais eficientes (Oliveira, 2006).
Para melhorar a eficiência do projeto de explotação de um reservatório, é de fundamental importância a definição adequada do número de poços produtores e inj etores, bem como a distribuição dos mesmos.
Uma das grandes dificuldades com a locação de poços é o elevado número de variáveis envolvidas, pois, a interação entre as variáveis é bastante complexa e não linear. Para se ter uma ideia, em alguns casos são consideradas variáveis discretas (quantidades de poços) combinadas a variáveis contínuas (taxas de vazões em cada poço locado), o que exige um processo de otimização mais sofisticado. Em Fonseca (2010) é apresentado um problema com tais características, onde são consideradas como variáveis de projeto a posição dos poços e as vazões em cada poço locado em um reservatório bastante simples.
Os primeiros princípios para o problema de otimização do planejamento para gerenciamento da produção de reservatórios foram estabelecidos por Aronofsky e Lee (1958). Estudos sobre esse problema representam uma área bastante ativa que é explorada por vários autores, com diversas abordagens sugeridas.
1.5	Revisão da literatura
um dos principais métodos de recuperação secundária em reservatórios de petróleo é a injeção de água. isso se deve ao baixo custo associado ao uso da água, que é abundante, bem como à maior estabilidade do processo, se comparado com o uso de gás, por exemplo. A produção por injeção de água tem uma longa história de aplicação em vários campos do mundo. No Brasil, a injeção de água é o método mais utilizado como recuperação secundária, sendo aplicado nos maiores e principais campos das bacias brasileiras. Esse mecanismo de produção se aplica com dois propósitos: o deslocamento de óleo para os poços produtores; e a manutenção da pressão do reservatório, que energiza o sistema.
No que se refere ao deslocamento do óleo para os poços produtores, a razão de mobilidade dos fluidos, a heterogeneidade e a segregação são os três fatores que governam a eficiência da recuperação do óleo. Com relação à manutenção da pressão, essa é uma prática que apresenta algumas vantagens. A principal diz respeito à energia do sistema, que é representada pela pressão do reservatório, evitando a liberação de gás associado e o aumento rápido da razão gás-óleo (RGo) nos poços produtores (oliveira, 2006).
A premissa de balanço de materiais no reservatório garante que injetar mais implica em produzir mais, de acordo com o caráter crescente e monótono da curva volume produzido acumulado de óleo (Np) versus volume injetado acumulado (W) - adotando ambos normalizados pelo volume de óleo in place (VOIP). Uma adaptação do comportamento mencionado é esquematizada na figura a seguir.
Com a unidade de produção trabalhando na sua capacidade máxima (operação topada), a solução até o momento da erupção da água é trivial, onde a linearidade entre produção de óleo e injeção é mantida, a produção máxima de óleo possível trará o melhor resultado. Com a chegada da água aos poços, têm-se os seguintes aspectos:
1.	Injetar menos por um poço, devido à elevada produção de água em algum poço produtor, não se justifica, pois a redução da injeção ocasionará a queda da produção global (Oliveira, 2006);
2.	O fechamento de algum poço que esteja produzindo água em demasia, sem alterar a produção dos demais, também não se justifica, pois o fechamento exige a redução da cota de injeção para manutenção do balanço, e de forma semelhante ao aspecto anterior, isso acarretará na redução da produção global (oliveira, 2006).
Admitindo essa filosofia, a hipótese, de que a condição ótima de produção se dá em alguma situação onde as vazões totais são iguais aos limites da plataforma é reforçada. Não há indicação teórica ou comprovação prática de que ter a plataforma trabalhando nos seus limites de capacidade durante todo o período de desenvolvimento do campo resultará, incontestavelmente, na melhor opção de operação. Contudo, é difícil imaginar situações onde pode ser preferível manter alguns poços fechados em detrimento da manutenção da vazão total igual ao limite do grupo. De qualquer forma, trata-se ainda de um problema aberto (oliveira, 2006).
A aplicação de diferentes técnicas de otimização no ramo de upstream da indústria do petróleo teve início na década de 50 e vem se desenvolvendo desde então. Há três grandes linhas de estudo dentro do contexto da otimização na produção de petróleo (Horne, 2002). uma delas destaca a operação dos campos de petróleo, relacionada aos equipamentos e instalações de produção e de poços. outra linha é referente ao desenvolvimento de campos de petróleo, no que diz respeito à quantidade e distribuição dos poços de desenvolvimento (não exploratórios). A última linha relaciona-se ao gerenciamento de campos de petróleo através da alocação dinâmica das vazões de produção e injeção.
A otimização do desenvolvimento de um campo de petróleo não depende apenas das condições do reservatório, mas também da configuração de operação dos poços e dos equipamentos de superfície. Em alguns campos, a otimização da operação de produção pode ser o fator mais importante para o aumento da produção e a redução dos custos. Em sistemas grandes e complexos, com variáveis envolvendo o tempo, por exemplo, abordagens mais sofisticadas devem ser consideradas para melhor predizer o comportamento do sistema de produção e examinar alternativas operacionais de forma eficiente (Horne, 2002).
Com relação distribuição dos poços (locação), para uma boa drenagem dos fluidos e a maximização da explotação de um reservatório, é fundamental a definição adequada do número e distribuição de poços produtores e injetores. Existem modelos clássicos de distribuição de poços que podem ser utilizadas apenas em casos de reservatórios homogêneos e isotrópicos, porém, esses praticamente inexistem.
Em ambiente offshore, os custos de perfuração e completação dos poços são extremamente elevados e a preocupação com a otimização do plano de desenvolvimento é de suma importância para a viabilidade do projeto.
A otimização do planejamento e gerenciamento dos campos é uma área ativa e bastante explorada por vários pesquisadores. Aronofsky e Lee (1958) estabeleceram os primeiros princípios para esse tipo de problema quando apresentaram um modelo de programação linear para maximizar o lucro através do planejamento de produção de um sistema de múltiplos reservatórios homogêneos. No problema, o reservatório era submetido a restrições das pressões dos poços, assim como as vazões devido à capacidade da linha de escoamento. O reservatório é modelado por sistemas infinitos com fluxo radial sujeito ao mecanismo de produção por influxo de água (Rosa et. al., 2006). São aplicadas formulações com um poço ou múltiplos poços num processo de otimização discreti-zado no tempo.
Dentro da ideia de tratar o problema como se o mesmo fosse linear, See e Horne (1983) apresentaram uma abordagem usando simulação de reservatórios. O processo possui duas fases principais: modelagem e otimização. Na modelagem, um modelo linear foi construído e calibrado a partir de análise regressiva de um conjunto de experimentos. A programação linear foi utilizada na fase de otimização.
Pan e Horne (1998) usaram a metodologia de projeto uniforme (uniform design) e a técnica de krigagem (Forrester et. al., 2008) para diminuir o número de simulações no processo de busca. Eles apresentaram um estudo investigando dois algoritmos de interpolação multivariável para gerar novas realizações a partir de um número limitado de simulações, objetivando predizer estratégias ótimas para programação do desenvolvimento do campo. A partir do objetivo e parâmetros definidos, foi feito um planejamento de experimentos uniformemente distribuídos no domínio com simulações para construção de uma superfície que modelasse o objetivo. A otimização foi conduzida utilizando esta superfície e o resultado validado através da simulação. Caso fossem necessárias, novas simulações para refinamento eram realizadas e o processo repetido.
Zakirov et. al. (1996) considerou um problema para encontrar a alocação ótima de gás e água disponível lidando com limitação de capacidade para os poços individuais produzindo para uma plataforma de produção comum. O reservatório produzia segundo o mecanismo de capa de gás, com injeção na capa. Métodos baseados na teoria de controle foram utilizados para o cálculo dos gradientes da função objetivo e o método dos gradientes conjugados (Schewchuk, 1995) foi utilizado para maximizar o objetivo. Os resultados indicaram que a melhor estratégia era manter uma razão gás-óleo (RGO) igual para todos os poços, conservando um movimento “uniforme” da frente de gás.
No Eclipse Technical Description (Geoquest Ltd, 2005) foi apresentado um módulo de otimização de reservatórios (Reservoir Optimization - ResOpt) que utiliza algoritmos baseados no cálculo dos gradientes da função objetivo a partir do método adjunto. Com esse método, o custo para obtenção dos gradientes independe do número de variáveis envolvidas. Dessa forma, o método adjunto apresenta grande vantagem devido à eficiência, porém, é de difícil implementação. O uso do simulador como uma “caixa preta” é uma alternativa, seja para o cálculo das derivadas por alguma aproximação (como diferenças finitas), ou para a aplicação de alguma metodologia de busca direta.
Algumas técnicas de busca estocástica, em particular os Algoritmos Genéticos (1989), foram utilizadas por Harding et. al. (1998). O alvo do estudo foi um grupo de campos de óleo e gás ligados. A avaliação do objetivo tinha um custo computacional relativamente alto. Segundo observação dos autores, um bom programa de produção tende geralmente a apresentar um esquema de platô de produção com declínio subsequente. De acordo com os resultados obtidos, o Algoritmo Genético apresenta desempenho superior aos outros métodos contemplados no estudo, e a escolha inteligente dos operadores usados pode garantir melhorias significativas.
Oliveira (2006) realizou um estudo de otimização considerando algoritmos que não utilizam informações das derivadas no processo de busca para o problema de inj e-ção de água, cuja função objetivo era o valor presente líquido (VPL). Os algoritmos utilizados foram: o método de Nelder-Mead (simplex), a busca direta em padrões (Pattern Search - PS), o algoritmo de otimização livre de derivadas (Derivative Free Optimization - DFO) e o algoritmo genético. Nos estudos realizados não foram consideradas incertezas.
Alguns pesquisadores acreditam que a criação de métodos híbridos pode resultar em ferramentas que se sobressaiam no processo de otimização. A hibridização já é uma prática comum em diversos campos. Um algoritmo híbrido pode surgir da combinação de duas (ou mais) diferentes estratégias para solucionar uma única tarefa. Em princípio, cada estratégia pode ser utilizada de forma independente, mas isso seria concentrar esforços em apenas algumas características. Se a combinação é eficiente, ao contrário da utilização independente, uma compreensão mais profunda é possível, e por conseguinte, uma solução melhor é encontrada de forma mais rápida.
Güyagüler (2002) propôs uma técnica de otimização híbrida, que considerava o Algoritmo Genético auxiliado por um algoritmo de busca politopo (simplex) e a técnica de krigagem. A hibridização do algoritmo genético com o simplex introduziu um processo de escalada na busca estocástica e também permitiu uso de buscas criadas e calibradas iterativamente durante a execução fazendo a adoção de modelos substitutos simples no lugar de simulações numéricas caras. Os testes realizados foram aplicados em um problema de injeção de água no campo de Pompano no Golfo do México.
As opções de algoritmos disponíveis para auxiliar no processo de otimização são inúmeras, no entanto, o tipo de algoritmo a ser considerado muitas vezes depende das características do problema. Os problemas de otimização de reservatórios de petróleo apresentam características que dificultam a obtenção de resultados com alguns tipos de algoritmos. Os estudos realizados neste trabalho foram motivados pela ideia de definir uma alternativa para superar os inconvenientes encontrados em trabalhos anteriores (Horowitz &amp;amp; Afonso; Horowitz et. al., 2010; Horowitz et. al., 2009), através da combinação de metodologias, na tentativa de aproveitar as qualidades das mesmas, tanto em problemas uniobjetivo como em problemas multiobjetivo.
1.6	Formulação do problema de injeção de água
Experiências numéricas de otimização indicam que a tendência do processo de obtenção de soluções melhores aponta para topar a capacidade da plataforma (Wang et. al.,
2002). Com isso, muitas indicações de que formular o problema com variáveis de controle que resultem na operação da plataforma em seus limites conduz o problema a uma condição de maior proximidade da solução que otimiza o objetivo.
De maneira geral, a função objetivo utilizada em problemas de otimização da ex-plotação de um campo de petróleo está relacionada à produção propriamente dita ou a economia do projeto. Considerando a produção como foco principal, se busca a maximização da produção acumulada de óleo ou a manutenção da capacidade de uma linha de exportação pelo maior tempo possível, por exemplo. Tratando a economia do projeto como foco, a lucratividade é comumente escolhida como indicador, onde se busca maximizar o valor presente líquido (VPL), ou a taxa interna de retorno (TIR), ou algum outro índice econômico de interesse. Na grande maioria dos casos apresentados para estudo, as funções objetivo adotadas estão associadas a algum parâmetro econômico ou financeiro, em especial o VPL.
1.6.1	Consideração de uma função objetivo
Para o problema de otimização uniobjetivo, o VPL do fluxo de caixa da operação do campo é considerado como o objetivo da otimização. A formulação geral adotada é apresentada na equação a seguir:
T
Maximize: VPL = f (xpt, xAí Jc, u) = £
t=0
1
(1 + d )t
■ Ft(Xpt , XAt,k
U )
sujeito a: £xpt &amp;lt;1 , t = 1...nt
p£ P
E xp,t&amp;lt;1 , t=1-‘nt
pel
x
E Xpt&amp;lt;E —&amp;lt;1 ■E Xpt , t = 1..nt
pGp	pG1 a a pGp
nt -1
E XAt,k &amp;lt;1
k=1
(1.1)
Na Eq. (1.1), d é a taxa de desconto aplicada ao capital, T é o tempo final (tempo de concessão do projeto) e Ft é o fluxo de caixa no tempo t, os índices P e I se referem aos poços produtores e injetores, respectivamente, o vetor u representa parâmetros que não podem ser controlados como propriedades das rochas e dos fluidos no reservatório, preço do óleo e inflação, entre outras. A variável de projeto Xp,t é a razão alocada no poço p no tempo t, dada por:
Xp,
^p,t	,	,p,t	,
---------, p,p ; ,, =a----------------,
¿¿prod ,max	¿--prod ,max
p,t
(1.2)
onde qpt é a vazão do poço p no tempo t, Qprodmax é a vazão máxima permitida de fluído no poço produtor e a é a razão determinada entre o óleo produzido e a água injetada, como apresentado em:
Qprod ,max
a = —---------
Q'nj,max
(1.3)
Na Eq. (1.1), x&amp;amp;t,k representa as variáveis relacionadas co^m. o te^mpo, e estão normalizadas em função do tempo de concessão, como apresentado na Eq. (1.4):
x^k =~^, k =1...nt -1	(1-4)
Efetivamente, é utilizada uma versão simplificada do vpL, considerando apenas as receitas provenientes do óleo, bem como os custos de produção e injeção, para tornar os estudos realizados mais convenientes. Existem pacotes com modelos econômicos mais complexos que podem substituir a versão simplificada do VPL adotada nos estudos realizados neste trabalho. Dentro da abordagem de otimização com simulação, a utilização de um programa de análise econômica pode ser tratado como uma “caixa pr eta” onde são fornecidos apenas os dados de entradas necessários e é coletado o resultado do VPL final.
Para este problema, são consideradas duas formulações que possuem relação à maneira como os poços são controlados no reservatório estudado (tomando como referência o controle da capacidade de operação). Junto à formulação relacionada às operações, existe a variação que acrescenta uma flexibilidade no gerenciamento das operações e a principal implicação é uma produção equivalente com o uso de menos ciclos de controle (relacionada à fixação dos tempos onde devem ocorrer os ciclos de controle).
Tratando das formulações relacionadas à operação dos poços no reservatório, uma delas considera a operação em capacidade topada (OCT), enquanto a outra considera a operação em capacidade não topada (OCNT). Na OCT, a soma das razões em ambos os conjuntos de poços (produtores e injetores) é exatamente o total máximo da plataforma. Por outro lado, na OCNT, as razões totais de injeção e produção podem variar, não atingindo necessariamente o total máximo da plataforma.
Adotando os tempos, onde ocorre o controle nos rateios dos poços, como variáveis do problema (com o intuito de diminuir a necessidade de operações a serem realizadas no reservatório), pode ser mais inteligente. Embora o número de variáveis aumente, essa consideração combina eventos como o avanço de água ideal, a pressão necessária no reservatório, e o possível fechamento de algum poço ou de todo reservatório.
os testes realizados apresentam a combinação entre o tipo de operação no reservatório (operando em capacidade topada ou não topada) e a flexibilidade fornecida pela consideração das variáveis referentes ao tempo (onde ocorrem os ciclos de controle). Tais combinações fornecem uma formulação específica para Eq. (1.1). Os reservatórios
estudados, bem como, a formulação específica referente a cada combinação estão apresentados mais adiante.
1.6.2	Otimização simultânea de objetivos
Para a formulação do problema de otimização multiobjetivo, certa dificuldade foi encontrada na hora de definir objetivos conflitantes e que representassem uma real importância na prática. As funções selecionadas estão relacionadas à produção propriamente dita. Os objetivos envolvidos são a produção acumulada de óleo e injeção de água. A formulação geral adotada é apresentada como:
Maximize: Óleo e
Minimize: Agua,. .
sujeitos a: Ex t &amp;lt;1 , t = 1...nt
p&amp;amp;F
E xp,t&amp;lt;1 , t=1... nt
1	(1.5)
x
Expt&amp;lt;E—&lt;--Exp,t , t=nt
pEP	p^i a a pEp
n-1
E&amp;lt;1
k=1
Nesse problema, a consideração de diferentes formulações para esse problema em relação ao tipo de operação, não faz sentido, pois na OCT a água injetada apresenta um valor fixo. Nos testes realizados, o tempo onde ocorrem os ciclos de controle não foi considerado como variável.
1.7	Organização do trabalho
Este trabalho consiste em sies capítulos organizados de maneira a facilitar o entendimento dos estudos realizados. A descrição do conteúdo de cada capítulo é dada a seguir.
Após introdução sobre definição dos problemas abordados, tal como a formulação matemática considerada para os problemas de otimização relacionados à engenharia de reservatório, no capítulo dois é dada atenção à metodologia empregada para criação de modelos substitutos, com o intuito de reduzir os custos computacionais inerentes ao processo de otimização com simulação numérica.
As estratégias de otimização consideradas para resolução dos problemas analisados são apresentadas nos capítulos três e quatro, bem como a maneira com que as mesmas são utilizadas no processo de busca.
No capítulo cinco estão os resultados obtidos nos testes, assim como o detalhamento das configurações adotadas nos algoritmos.
No último capítulo, o capítulo seis, as conclusões obtidas com os testes realizados são apresentadas juntamente com as sugestões para trabalhos futuros.
Capítulo 2 - Modelos substitutos
A natureza é extremamente complexa e para tentar entendê-la o ser humano cria modelos simplificados obtendo assim um resultado aproximado, mas que consegue definir de maneira satisfatória o que se pretende analisar, geralmente são expressas matematicamente. As formulações definidas, embora simplificações do que se passa na realidade, ainda são bastante complexas para serem resolvidas analiticamente. Como consequência, os métodos numéricos buscam soluções aproximadas para essas formulações.
2.1	Visão geral
A origem de muitas técnicas de otimização baseadas em modelos substitutos, que estão em uso hoje em dia pode ser rastreada da geologia, mais especificamente da ciência da geoestatística, que desempenha um papel importante na engenharia de minas.
Na engenharia, os métodos aproximados são extensivamente utilizados de forma a obter soluções para os problemas complexos com os quais os engenheiros lidam no dia a dia. Um bom entendimento da física envolvida no problema auxilia na escolha da maneira mais simples e eficaz de se resolver o mesmo. Um exemplo que pode ser citado envolve análise de problemas da engenharia estrutural, como o uso de modelo de grelhas para o cálculo de lajes, ou o modelo de treliça para dimensionamento à torção de vigas, entre outros.
Em meados dos anos 70, Schmit &amp;amp; Farshi (1974) e Schmit &amp;amp; Miura (1976) demonstraram que a utilização de modelos substitutos (com fidelidades variáveis) pode ser custo-eficiente quando se busca a otimização de alguns problemas complexos da engenharia.
As funções substitutas têm sido utilizadas objetivando uma resposta computacional rápida, e também para obter um comportamento mais suave e/ou simplificado das funções de custo computacional elevado (modelos de alta fidelidade), isto é, livre de ruídos numéricos, permitindo ainda a obtenção dos gradientes. O fator essencial na aproximação é substituir as funções de alta fidelidade por funções mais simples de serem calculadas (funções substitutas) e usá-las durante o processo de otimização.
As aproximações podem ser classificadas segundo o intervalo de aplicabilidade no espaço de projeto, com isso, podem ser definidos três grupos distintos (Barthelemy &amp;amp; Haftka, 1993):
1.	Aproximações locais: são válidas apenas em uma vizinhança próxima ao local onde as funções foram criadas. Durante o processo de otimização, os resultados da função real são comparados a cada iteração com os da função aproximada, resultando em uma consistência entre os dois modelos.
2.	Aproximações globais: ocorre quando é necessário obtermos uma ideia geral da função investigada em todo o espaço de projeto. No presente trabalho são criadas construindo uma superfície de resposta global utilizando modelo por ajuste de pontos (data fitting);
3.	Aproximações de médio alcance: tenta dar um aspecto global para as aproximações do tipo local, ou seja, a combinação entre ambos os tipos (Silva, 2010).
A Figura 2.1 ilustra graficamente as definições assumidas por Barthelemy &amp;amp; Haftka (1993) dos tipos de aproximações citadas anteriormente.
Figura 2.1- Exemplo dos diferentes tipos de aproximação: (a) espaço de projeto; (b) aproximação local; (c) aproximação de médio-alcance; (d) aproximação global.
As aproximações podem assumir as seguintes formas (Pietrobom, 2002):
1.	Funcional: aproximação da função real é obtida pela interpolação de valores conhecidos da função objetivo;
2.	Física: os modelos são criados a partir de modelos físicos simplificados;
3.	Híbrido: modelos resultantes da combinação entre os modelos físico e funcional (fidelidade variável).
É quase desnecessário dizer que o pré-requisito para uma otimização baseada em modelos substitutos ser bem sucedida é a que apresenta uma função substituta que generalize de forma razoável, ou seja, que seja capaz de prever com bastante precisão outros locais que não os incluídos no plano de amostragem, onde a função objetivo tenha sido avaliada diretamente.
As técnicas de construção de metamodelos por ajuste de pontos tipicamente envolvem interpolação ou regressão numérica de um conjunto de resultados gerados a partir do modelo real (Keane &amp;amp; Nair, 2005; Forrester et. al., 2008; Silva, 2010). No entanto, para se construir tal modelo, o primeiro passo é gerar um conjunto de pontos (amostra) que sejam únicos e limitados pelas cotas do espaço de projeto. Esta técnica é
conhecida na literatura como plano de amostragem (Design of Experiments - DoE) (Keane &amp;amp; Nair, 2005; Forrester et. al., 2008; Silva, 2010).
2.2	Plano de amostragem
A localização dos pontos gerados no plano de amostragem pode influenciar o modelo criado, pois, em cada ponto da amostra, a função real é avaliada e o resultado da análise é salvo para posterior criação do modelo substituto. A escolha dos pontos é um assunto bastante importante, especialmente quando o tempo da análise para um único experimento é longo. Deve-se procurar uma amostra adequada, isto é, com um número mínimo de pontos, porém, que assegure a precisão do metamodelo com relação ao modelo real.
intuitivamente se pensa em espalhar as amostras de forma a cobrir uniformemente o domínio de projeto. No entanto, a definição exata de “uniformidade” não é imediat amente óbvia, nem tão simples de se traduzir para a obtenção de uma amostra inicial.
Aspectos quantitativos de uniformidade envolvem: (1) a igualdade com a qual os pontos são espaçados entre si no espaço de projeto; (2) uniformidade de densidade de pontos sobre todo o domínio do espaço de projeto (i.e., “cobertura” uniforme de todo o domínio pelo conjunto de pontos, e não apenas uma uniformidade em uma determinada região do espaço); e (3) isotropia (sem direções preferenciais) no padrão da colocação de pontos (Romero et. al., 2006). Cada um desses aspectos de uniformidade pode ser quantificado por diversas medidas matemáticas como descritas em Burkardt, et. al. (2007). Tais medidas não serão aprofundadas nesse trabalho, mas haverá alguns comentários sobre as mesmas para indicar uma noção intuitiva de uniformidade.
Diversas técnicas de amostragem são disponíveis, das quais são citadas neste texto a amostragem por hipercubo latino (Latin Hypercube Sampling - LHS), a diagramação de Voronoi no centroide (Centroidal Voronoi Tessellation - CVT) e a diagramação de Voronoi no centroide latinizada ( “Latinized” Centroidal Voronoi Tessellation - LCVT) (Romero et. al., 2006).
Nas técnicas de amostragem, uma medida de uniformidade do conjunto de pontos projetados em todos os eixos coordenados é chamada de discrepância. A discrepância diminui à medida que a uniformidade de projeção aumenta.
O método LHS geralmente executa uma melhor distribuição uniforme de pontos. isto é devido à maior regularidade na amostragem individual em cada dimensão dos parâmetros da função antes dos parâmetros serem combinados de forma aleatória para gerar o conjunto que definirá as coordenadas dos pontos da amostra (Romero et. al., 2006).
O método CVT subdivide o domínio com diagramas de formatos arbitrários (células de Voronoi) em espaços que apresentam aproximadamente o mesmo volume. O ponto amostral a ser selecionado na divisão, é o centroide de cada volume da subdivisão (Romero et. al., 2006).
O LHS é um método de amostragem com menor discrepância do que o CVT. Embora o CVT tenda a ter uma melhor uniformidade volumétrica, o que remedia seu desempenho relativo em algumas áreas, ele também tem uma discrepância bastante eleva-
da, o que prejudica o desempenho relativo em mapear alguns tipos de espaços (Romero et. al., 2006).
O método LCVT é uma versão alternativa, criada a partir da combinação das técnicas CVT e LHS, e aparenta ter uma discrepância menor do que o CVT puro, e uma maior uniformidade do que o LHS puro (Romero et. al., 2006).
Os estudos realizados neste trabalho consideram o uso do LCVT. A escolha foi feita baseada em estudos prévios, apresentados em Afonso et. al. (2008), que considera o desempenho de alguns modelos substitutos em combinação com algumas técnicas de plano de amostragem. Os resultados foram obtidos em testes realizados em problemas específicos de gestão de injeção de água, e os mesmos apontaram para o uso do LCVT. Ao final deste capítulo é mostrado um dos exemplos que demonstra o desempenho da combinação considerada.
De posse dos pontos amostrais, expressões de predição são desenvolvidas para avaliar a função em pontos não avaliados do domínio. A função é baseada num modelo comum de krigagem. A escolha do modelo de kriging também foi feita baseada nos estudos realizados por Afonso et. al. (2008).
2.3	Krigagem
Para o mapeamento do domínio de projeto com funções substitutas é interessante que as mesmas forneçam valores de fidelidade aceitável, isto é, os valores mapeados devem ser ideais em algum sentido objetivo. Uma medida que pode ser utilizada é a “imparcialidade”, isto é, tomados em conjunto, o mapeamento deve ter a média correta. Verifica-se que a “imparcialidade” global é simples de atingir; no entanto, com os métodos de estimação simplificados globais a imparcialidade é obtida ao custo de uma superestimação de pontos onde os valores deveriam ser baixos e subestimação de pontos onde os valores deveriam ser altos. Quando isso oco rre se diz que há uma “tendência condicionada” (Forrester et. al., 2008).
Daniel Krige, um engenheiro de minas sul-africano, estava interessado na correção das tendências condicionadas obtidas em métodos simplificados de estimação global, para uma graduação mais aceitável dos “stopes’” das minas. O método de interpolação de kriging, desenvolvido por Georges Matheron, foi nomeado com o nome de Daniel Kriges devido aos trabalhos pioneiros do mesmo, que foram publicados no início da década de 50 (Forrester et. al., 2008). No método de kriging a função é formulada da seguinte forma:
k
j=i
(2.1)
Na Eq. (2.1), a primeira parte representa uma regressão linear dos dados, e o erro, Z(x), é uma função aleatória (em geral segue uma distribuição Gaussiana) com média zero, variância o2, e covariância não nula. Geralmente são utilizados polinómios para definir N(x). Uma abordagem tradicional é chamada de kriging ordinário, na qual a ordem das funções empregadas é zero. No kriging ordinário, a função assume a forma:
/ ( x ) li - Z ( x )
(2.2)
onde p é uma constante desconhecida.
A matriz de covariância é dada por:
cov ' Z (xi),Z (xj)] = ct2r ' R(xi, xj)]
(2.3)
onde R é uma matriz de correlação e R(xi,yi) é a função de correlação entre cada dois dos m pontos da amostra. A função de correlação considerada é uma função Gaussiana na forma:
R(x, x)=exp I E 0 p'/) - xk1)
(2.4)
onde nvar é o número total de variáveis, e são os parâmetros de correlação desconhecidos utilizados para ajustar o modelo.
Minimizando o quadrado da média e usando uma estimativa de máxima probabilidade (Forrester et. al., 2008) que leva a um valor ótimo de Q e ao melhor preditor imparcial, dado por:
(2.5)
onde f é um vetor com os valores reais da função dos m pontos amostrais, f é um vetor com m elementos 1, e
(2.6)
Algumas estratégias são necessárias para verificar se o modelo criado é adequado. Essas medidas também fornecem algumas diretrizes para selecionar o melhor modelo quando diferentes modelos são construídos. Nesse trabalho, duas medidas são consideradas. Elas são a raiz quadrada do erro quadrático médio (Root Mean Square Error -RMSE) e a soma dos quadrados dos erros preditos (Predicted Error Sum of Squares -PRESS) (Afonso et. al., 2010). As expressões para essas medidas são dadas a seguir.
RMSE =
V ,	„ X2
Z(.fi - f)
i =1
(2.7)
np
np
(2.8)
2.4	Desempenho do modelo substituto
O caso apresentado aqui é considerado apenas para ilustração do desempenho do modelo substituto. O exemplo consiste de um pequeno reservatório de características simples, que foi apresentado em (Oliveira, 2006) e também é utilizado para os testes com as estratégias empregadas.
Nesse reservatório são locados três poços, sendo dois produtores (P-1 e P-2) e um injetor (I-1). O reservatório está dividido em três zonas de permeabilidades distintas, e em cada uma das regiões é locado um dos poços. A permeabilidade na região do poço P-1 é 500 mD, enquanto próximo ao poço P-2 é 1500 mD. A permeabilidade na zona do poço I-1 é 1000 mD. O modelo numérico é constituído de uma malha de 51x51x1 blocos. A Figura 2.2 mostra um esboço do reservatório.
Figura 2.2- Reservatório considerado para verificar desempenho do modelo substituto (mapa de permeabilidade).
A Tabela 2.1 apresenta as principais características do reservatório.
Tabela 2.1 - Resumo das características do modelo do reservatório
Malha da simulação
Porosidade
Permeabilidade vertical (kv)
Compressibilidade da rocha a 200 kgf/cm2
Contato entre fluidos
Pressão de saturação (Psat)
Viscosidade a Tres, Psat
Razão gás-óleo de formação (RGOF)
51 (510 m) x 51 (510 m) x 1 (4 m)
30%
10% de kh
5 x 10-5 (kgf/cm2)"1
Sem contatos WOC e GOC
273 kgf/cm2
0,97 cp
115,5 m3/m3 std
A vazão individual de cada poço produtor é limitada ao valor de 30 m3/dia, e o somatório das mesmas não pode ultrapassar os 40 m3/dia. Para o poço injetor, a máxima vazão é limitada ao valor de 44 m3/dia.
Nesta etapa, o interesse é demonstrar o comportamento do modelo substituto para o cálculo do VPL. Para esse estudo em particular, a condição de OCT com dois ciclos de controle fixados durante o tempo de concessão (mais detalhes serão apresentados no Capítulo 5 -).
Os estudos apresentados por Afonso et. al. (2008) consideram quatro situações diferentes para este reservatório, onde são impostas restrições internas à simulação, como corte de água e/ou pressão de fundo de poço. Nos estudos são feitos comparativos entre o desempenho dos modelos substitutos criados a partir da combinação de diferentes DoE e diferentes procedimentos para obtenção de superfícies de resposta, e como citado anteriormente, os melhores resultados foram obtidos com o modelo substituto considerando a técnica de krigagem construído com amostras criadas pelo LCVT.
Para exemplificar o desempenho da combinação proposta de forma gráfica, a Figura 2.3 apresenta um esboço do comportamento da função VPL obtido com avaliações no modelo de alta fidelidade e no modelo substituto. Também pode ser observado que a superfície obtida com o modelo substituto é suave e consegue capturar as tendências daquela obtida com o modelo de alta fidelidade.
(b)
(a)
(c)
(d)
Figura 2.3 - Superfície de resposta e curvas de nível para o VPL: (a) e (c) modelo de alta fidelidade; (b) e (d) modelo substituto.
Capítulo 3 - Estratégias de otimização uniobjetivo
Nas ciências em geral, o termo otimização se refere ao estudo de um conjunto de técnicas que têm como objetivo a obtenção de parâmetros (variáveis de projeto) pré-especificados dentro de um conjunto permitido (espaço de projeto) que fornece o melhor resultado para uma função. A motivação é tirar proveito de recursos disponíveis, porém limitados, de maneira a maximizar os ganhos (Haftka &amp;amp; Gürdal, 1993).
Normalmente, os problemas de engenharia envolvem um grande número de variáveis, e cabe ao responsável pelo projeto encontrar uma combinação para estas que resulte num projeto mais eficiente e idealmente o mais econômico possível. A determinação desta melhor configuração dos parâmetros do projeto, muitas vezes depende da experiência do projetista, porém, nem sempre é possível obtê-la intuitivamente, em função da ausência de uma base de conhecimentos físicos sobre um dado problema específico para justificar a sua intuição sobre o porquê de se utilizar aqueles dados.
Para se chegar ao projeto “ideal”, muitas vezes é necessário se avaliar as várias possibilidades de combinação dos parâmetros do projeto. Esse procedimento iterativo envolve várias etapas até se encontrar a combinação ótima. A otimização é utilizada para auxiliar o projetista na determinação de uma solução, de acordo com os critérios estabelecidos.
São diversos os algoritmos existentes para auxiliar no processo de otimização, no entanto, o tipo de algoritmo a ser utilizado depende das características do problema. Os problemas de otimização de reservatórios de petróleo apresentam características que dificultam a obtenção de resultados com alguns tipos de algoritmos. Para superar os inconvenientes encontrados nestes tipos de problemas, uma alternativa sugerida é a combinação das metodologias, com o intuito de aproveitar as qualidades das mesmas.
3.1	Visão geral
Matematicamente, é possível escrever um problema de otimização de forma genérica como:
Minimize f (x)
xO
sujeito a: h (x) = 0, (i = 1, 2, ..., m) g} (x) 0, (j = 1, 2 ..., n) Xt,min Xt Xtmx, (t = 1, 2 ..., n var)
onde f(x) é a função objetivo, hi(x) são as funções de restrição de igualdade, gj(x) são de restrição de desigualdade, e xt,min e xt,max são, respectivamente, os limites inferiores e superiores da variável t. Todas as funções envolvidas são funções do vetor:
x = (X1&gt; X2, ..., Xnvar)	(3.2)
onde a componente xt é chamada variável de decisão, e podem ser reais, discretas ou uma mistura das duas. O espaço gerado pelas variáveis de decisão é chamado de espaço de busca, ou espaço de projeto, enquanto o espaço formado pela função objetivo é chamado de espaço de soluções.
As funções envolvidas podem ser lineares ou não-lineares. É importante ressaltar que a formulação pode ser adaptada ao algoritmo utilizado. Em algumas situações, o algoritmo considera a maximização ao invés da minimização, ou aceita apenas otimização com restrições de desigualdade. Nesse caso, modificações podem ser feitas, de forma a tornar o problema equivalente ao apresentado na Eq. (3.1).
A maximização de f(x) é equivalente a minimização de -f(x), uma restrição de desigualdade do tipo g(x) &gt; 0 é equivalente a -g(x) &amp;lt;0, e uma restrição de igualdade do tipo h(x) = 0 pode ser considerada como duas de desigualdade do tipo g(x) &amp;lt;0 e g(x) &gt; 0 (consideradas simultaneamente). O caso mais simples de restrição para uma variável de decisão xt é xt,min &amp;lt;xt &amp;lt;xt,max, que é chamado de limite das variáveis.
Dos diversos métodos disponíveis para otimização de problemas, se tem o interesse em adotar um que atinja a convergência de forma rápida e precisa. Os algoritmos de programação não-linear baseados em gradientes apresentam tal característica.
3.2	Estratégia local - Programação matemática
A programação matemática pode ser considerada como a primeira linha de métodos para resolução de problemas de otimização através do uso de algoritmos computacionais. Ela trata o problema de forma iterativa e determinística, isto é, através de gradientes, funcionais e operações matriciais (Castro, 2001). Devido a isso, normalmente necessita de várias informações iniciais.
Os algoritmos são distinguidos entre algoritmos de ordem zero, primeira ordem e segunda ordem, dependendo se a solução do mesmo exige apenas o valor da função, da primeira ou da segunda derivada (Torres, 2001).
Um passo fundamental para os algoritmos de programação matemática é a aproximação da função objetivo não-linear através do truncamento da expansão em série de Taylor (Yang, 2010), muitas vezes na forma quadrática. Para uma função continuamente diferenciável, f(x), a expansão de Taylor, até 2a ordem, em termos de Ax = x - x,, em um ponto definido x,, pode ser apresentada como:
f(x) = f(x,) +(Vf(x,))T Ax +1 Ax Vf x, )Ax
(3.3)
onde Vf (x) e V2 f (x) são, respectivamente, o gradiente e a matriz Hessiana da função
f(x).
Para resolução de problemas de otimização, e lidar com problemas restritos de várias variáveis, é comum definir a função Lagrangeana do problema, como:
m	n
L(x) = f (x) + 2	(x) + Z Àm+ jgj (x)
(3.4)
onde X é o vetor com os multiplicadores de Lagrange associadas às restrições hk e gj, no ponto x. Pode ser mostrado que a condição de mínimo local desta função, na solução x*, satisfaz as condições de otimalidade de Karush, Kuhn e Tucker (KKT) (Vanderplaats, 1984; Haftka &amp;amp; Gürdal, 1993).
O processo de otimização parte de um projeto inicial, x0, fornecido como entrada. O projeto é então atualizado modificando o vetor das variáveis de projeto x através da equação:
xt = xt+i +art	(3.5)
onde t é o iterando, o vetor r é a direção de busca, que indica a direção viável para qual o valor de f(x) decresce, e o escalar a é o tamanho do passo na direção de r.
Os métodos de solução são aplicados de acordo com o tipo de problema de programação matemática identificado. Em geral, esse tipo é determinado pelas características das funções objetivo e de restrições envolvidas (Afonso, 1995). A classificação mais simples é:
•	Programação linear: quando ambos, objetivos e restrições, são funções lineares ou são assumidas como funções lineares;
•	Programação quadrática: quando o objetivo é quadrático, ou é assumido como função quadrática, e as restrições são lineares, ou assumidas assim;
•	Programação não-linear: quando ambos, objetivos e restrições, são funções não-lineares.
Os dois primeiros métodos foram desenvolvidos para lidar com classes especiais de problemas de otimização, já os métodos de programação não-linear consistem em uma categoria genérica de algoritmos. As formas mais complexas de programação matemática envolvem funções não-lineares. Dos algoritmos de programação matemática, um dos métodos mais eficientes é o de programação quadrática sequencial (Sequential Quadratic Programming - SQP) (Powell, 1978), devido a isso, o SQP é o método empregado na etapa de busca local.
3.2.1	Programação Sequencial Quadrática
O SQP representa um dos métodos no estado-da-arte e mais populares métodos para otimização de problemas restritos e não-lineares. Ele também é um dos métodos mais robustos. A ideia fundamental do SQP é aproximar a matriz Hessiana usando um método de atualização quasi-Newton. Subsequentemente, isso gera um subproblema de programação quadrática a cada iteração, e a solução para este subproblema pode ser usada para determinar a direção de busca e a próxima solução a ser testada.
Usando a expansão de Taylor, o problema pode ser aproximado, a cada iteração, como um problema do tipo:
Minimize 1 Ax TV2L( xt )Ax + V/ (xt )T Ax + f (xt)
sujeito a: Vht (X )T Ax + h (X) = 0, (i = 1, 2, ..., m)	(3.6)
Vg (x)T Ax+g} (x) 0 (j =1 2 ..., n)
Para aproximar a matriz Hessiana por uma matriz simétrica positiva definida, a aproximação padrão Broydon-Fletcher-Goldfarbo-Shanno (BFGS) (Powell, 1978; Vanderplaats, 1984) é comumente usada. Em suma, as principais etapas envolvidas no algoritmo SQP convencional são:
1.	Estabelecer uma solução inicial, x0;
2.	Configurar uma aproximação inicial para a matriz Hessiana dos termos quadráticos da função objetivo;
3.	Resolver o subproblema para encontrar a direção de busca, r;
4.	Realizar uma busca linear para determinar o tamanho do passo, a, na direção r;
5.	Atualizar a matriz Hessiana, utilizando o esquema BFGS, e atualizar a solução;
6.	Verificar a convergência; se o mínimo local for encontrado, o processo para, caso contrário, retorna ao passo 3.
Num algoritmo de programação matemática, geralmente, o cálculo dos gradientes é feito de forma numérica, a menos que as informações das derivadas das funções envolvidas sejam fornecidas a priori.
Na maioria dos problemas práticos da engenharia, é comum a utilização de um programa de análise tratado como uma “caixa preta”, onde são fornecidos apenas os dados de entrada necessários e coletados os valores para o cálculo da função objetivo. Como citado no Capítulo 2, é característico de um problema que envolve a simulação de reservatório de petróleo, o alto custo computacional devido à simulação numérica exigida. A combinação do SQP com o uso de modelos substitutos pode apresentar uma saída para tal inconveniente.
3.2.2	Otimização Sequencial por Aproximação
No processo de busca local, nem sempre é necessário o conhecimento do comportamento da função em todo o domínio de projeto, com isso, pode se ter um modelo substituto de uma pequena região de interesse, uma aproximação local.
As aproximações do tipo local são válidas apenas na vizinhança na qual a função é avaliada, isto é, as aproximações são ditas precisas apenas a uma pequena distância a partir do ponto em que foram construídas.
Na otimização sequencial por aproximação (Sequential Approximate Optimization - SAO), a ideia central é decompor o problema inicial de otimização em uma sucessão de subproblemas menores, e o algoritmo de otimização vai operar sobre um modelo substituto de uma pequena região do domínio de projeto, ao invés de usar as respostas obtidas da simulação real. As avaliações das funções reais ainda se fazem necessárias durante o processo para construção do modelo substituto, e para a análise de consistência entre os modelos (real e aproximado), porém em uma menor quantidade.
A formulação matemática da estratégia sAo pode ser descrita como:
Minimize f (x)
sujeito a: hi k(x) = 0, (i = 1, 2, ..., m)
,k(x) &amp;lt;0 (J =1 2 ..., n)
x &amp;lt;x, ■	&amp;lt;x
min	k ,min	max
onde
xk,min	xc,k
xk ,max = x c,k + ^k
(3.7)
(3.8)
Na Eq. (3.7), os termos fk(x), k(x) e gjk(x) são, respectivamente, as funções substitutas da função objetivo e das funções de restrição de igualdade e desigualdade, na k-ésima iteração do SAO. Na Eq. (3.8), o termo xc,k representa o ponto central da região a qual o modelo substituto foi aplicado, e Ak é o tamanho definido para a mesma região.
A sub-região à qual o modelo substituto garante certa precisão é chamada de região de confiança (Trust Region - TR). Uma boa referência sobre o histórico dos métodos de região de confiança pode ser encontrado em (Conn et. al., 2000). O procedimento adotado aqui é descrito em seguida.
As Eqs. (3.7) e (3.8) definem o subproblema a ser resolvido pelo SAO. Ao final de cada iteração é verificada a consistência do modelo. Após a verificação é definido se o processo de busca deve ser finalizado ou se a região de confiança deve ser atualizada.
os aspectos computacionais da estratégia sAo podem ser resumidos segundo o procedimento apresentado a seguir:
1.	Assumir o tamanho e o ponto inicial da região de confiança;
2.	computar as funções objetivo e de restrições reais no ponto central da sub-
região;
3.	Construir uma função substituta, aproximada localmente, para as funções objetivo e de restrições;
4.	Otimizar o problema usando as funções aproximadas, onde as variáveis de projeto são limitadas pelas fronteiras da sub-região;
5.	Recalcular as funções objetivo e de restrições reais no ponto ótimo encontrado;
6.	Manter/reduzir/aumentar a nova sub-região de acordo com o procedimento da região de confiança;
7.	impor a consistência (fator de correção) entre o modelo real e o aproximado;
8.	verificar critério de convergência global da estratégia:
8.1. Se alcançada: o projeto ótimo é obtido, o processo é finalizado com suces-
so;
8.2.	Caso contrário: retorna ao passo 3.
Como descrito, durante o processo SAO pode ser estabelecida uma correção entre o modelo real e aproximado, para assegurar uma fidelidade (igualdade) entre os mesmos, no ponto central de cada região de confiança, de modo a melhorar a precisão do modelo substituto.
3.2.2.1	Correção do modelo local
O procedimento pode assumir a correção do tipo aditiva, multiplicativa ou de função de correção combinada, sendo cada uma associada a diferentes níveis de correção, ou seja, de ordem zero, primeira ordem ou segunda ordem. Cada subproblema (nova iteração SAO) é corrigido a partir da escolha deum nível de correção. O termo de correção é expresso por procedimentos baseados na expansão em série de Taylor.
Cada nível de correção é obtido a partir das considerações, ou não, dos termos da série de Taylor, ou seja, no de ordem zero será apenas considerado o termo constante, o de primeira ordem é obtido a partir do termo de ordem zero adicionado ao termo da primeira derivada, e o de segunda ordem é obtido a partir do termo de primeira ordem adicionado ao termo da segunda derivada.
A correção de modelo substituto com o fator de correção aditiva e multiplicativa assume a seguinte forma:
f ( x) = f (x) + a(x) f(x) = f (x) -P(. x)
onde
a(x) = a(xc) + VA(xc)T •(x - xc)
ou
a(x) = a(xc) + VA(xc)T •(x - xc) +1(x - xc)T • VA(xc) •(x - Xc)
e
P(x) = b(xc ) + vb(xc )T •(x - xc )
ou
x) = b( x ) + VB( Xc )T • (x - Xc ) + 2 x - X )Tb( Xc ) • (X - Xc )
(3.9)
(3.10)
(3.11)
sendo a(x) = f (x) -f (x) e b(x) = f (x)/ f (x) .
De forma geral, a(x) e fí(x) podem ser calculados por aproximação através da série de Taylor de primeira ou segunda ordem.
Além das correções do modelo, o esquema de região de confiança passa por uma atualização durante o processo de otimização.
3.2.2.2	Atualização da região de confiança
O esquema da região de confiança adotado nesse trabalho é baseado no que foi descrito por Adams, et al. (2010), e depende do termo de aceitação “parcial” da função objetivo e da função de restrição de desigualdade. o termo é determinado para cada iteração do SAO em função do valor da avaliação no modelo real e do valor da avaliação no modelo substituto, no ponto central da região e no ponto dado como solução, de acordo com a equação:
Pk = nnní/r , pP )
(3.12)
onde k é o índice da iteração da estratégia SAO, pp é o termo de aceitação da função objetivo, que é definido através da equação:
Pk =
f ( xc,k) - f ( xk) f (xc,k) - fk (xk)
(3.13)
e pg é o termo de aceitação em função da restrição de desigualdade, que é definido pela equação:
P = g(	-	(3.14)
g(xck ) - gk (xk)
Nas Eqs. (3.13) e (3.14), fxc,k) e g(xc,k) são os valores das funções objetivo e res-
„ . k	, k
trição no modelo real, no ponto central da região de confiança, e j (xk), g(xk), fk (x*) e gk (x*) são, respectivamente, os valores das funções objetivo e restrição no modelo real e no modelo substituto, no ponto dado como solução na iteração k do SAO.
Além de ser usado para definir a aceitação da função objetivo, o termo pk auxilia na definição do tamanho, Ak+1, e o novo ponto central, xc,k+1.
O Ak+1, da sub-região da próxima iteração do SAO, é definido de acordo com os critérios na Tabela 3.1:
Tabela 3.1 - Termo de aceitação no esquema da região de confiança.			
Pk	Precisão de f (x)	Modificação na TR	Tipo de modificação
Pk &amp;lt;0	Fraca	Rejeitar	Reduzir
0&amp;lt;Pk &amp;lt;0.25	Razoável	Aceitar	Reduzir
0.25&amp;lt;Pk &amp;lt;0.75 e Pk &gt;1.25	Moderada	Aceitar	Manter
0.75&amp;lt;Pk &amp;lt;1.25	Precisa	Aceitar	Aumentar
O xck+1, é definido de acordo com os seguintes critérios:
xc,k+1 = x se P " 0
xc,k+1 = x	se P&amp;lt;0
3.2.3	Multimodalidade
A presença de multimodalidade nas funções envolvidas em alguns problemas são características que dificultam o trabalho de algoritmos de programação matemática, pois, para encontrar a solução ótima em problemas deste tipo, tais metodologias precisam ser aplicadas em múltiplos pontos iniciais. As várias tentativas representam múltiplas execuções, onde diferentes soluções podem ser encontradas sem garantia de que a solução é o ótimo global do problema.
Para ilustrar as dificuldades citadas será realizada a busca pelo ponto de valor máximo em uma função que apresenta tal característica. A função é conhecida como função Schubert e é comumente utilizada para demonstração da eficiência de alguns algoritmos para obtenção de ótimos globais. A função é formulada matematicamente através da equação:
n var 5
f(x)=np ■ cos((i+i)x&gt;+i)	(3.16)
j=1 i=1
Considerando o problema com duas variáveis, a função é graficamente representada na Figura 3.1.
(a)
■2.5
-2.5	-2	-1.5	-1	-0.5 O 0.5	1	1.5
(b)
Figura 3.1 - Representação gráfica da função Shubert: (a) representação em 3D e (b) vista superior
O domínio considerado neste problema limita as coordenadas em -2,5 &amp;lt;xn &amp;lt;1,5. O valor máximo da função é f(x*) = 210,482 onde x* = (-0,8; -0,8) .
Na tentativa de encontrar a solução do problema com o algoritmo de busca local foram realizadas 36 execuções, onde cada rodada tinha um ponto de partida dentro dos limites definidos anteriormente. Os pontos selecionados foram definidos a partir da uma divisão igualitária em todo o domínio. A figura a seguir ilustra os diversos pontos iniciais, bem como as soluções encontradas com os mesmos.
1.5
.2 5_________1________1_________1________1_________1________1_________1_________1
-2.5	-2	-1.5	-1	-0.5	0	0.5	1	1.5
Figura 3.2- Soluções encontradas com o algoritmo de busca local.
Pode ser observado na Figura 3.2, que algumas das soluções encontradas pelo algoritmo não representam o mínimo global da função, e nem sequer estão em regiões próximas à região do mesmo (apenas cinco soluções corretas). Vale ressaltar também que a função tomada como teste possui apenas duas variáveis, o que não é comum em problemas de engenharia.
Considerando os resultados obtidos, pode se dizer que um algoritmo de programação matemática não seria a melhor alternativa para solucionar problemas nos quais se busca uma solução ótima global e a função envolvida apresenta multimodalidade.
Devido às dificuldades encontradas, uma alternativa seria adotar métodos de busca mais robustos, nos quais a presença de multimodalidade não fosse empecilho para encontrar a solução. Em geral, algoritmos que podem desempenhar essa tarefa são os algoritmos evolucionários.
3.3	Estratégia global - Algoritmos evolucionários
Algoritmos evolucionários (Evotionary Algorithms - EAs) são heurísticas e usam a seleção natural como instrumento de busca para resolver problemas. Heurísticas são estratégias para solucionar problemas por tentativa-e-erro. Alan Turing foi provavelmente o primeiro a utilizar algoritmos heurísticos, durante a Segunda Guerra Mundial. Em 1945, Turing foi chamado para o National Physics Laboratory (NPL), no Reino Unido, onde ele expôs seu projeto para o ACE (Automatic Computing Engine). Em um relatório do NPL sobre “Máquinas Inteligentes”, de 1948, ele esboçou suas ideias inovadoras sobre inteligência e aprendizado de máquina, redes neurais e algoritmos evolucionários ou uma versão inicial de algoritmos genéticos (apud Yang, 2010).
O próximo passo significativo no desenvolvimento de algoritmos evolucionários foi dado nas décadas de 1960 e 1970. Neste período, John Holland e seus colaboradores
na Universidade de Michigan desenvolveram os algoritmos genéticos (Genetic Algorithms - GAs). No início da década de 1960, Holland estudou os sistemas de adaptati-vos e foi o primeiro a usar manipulações de cruzamento e recombinação para modelar tais sistemas. Seu livro seminal, que resume o desenvolvimento de GAs, foi publicado em 1975 (apud Yang, 2010).
No mesmo ano de publicação do livro de Holland, Kenneth De Jong finalizou um trabalho importante que mostrava o potencial de GAs para uma vasta gama de funções objetiva, sejam elas ruidosas, ou multimodais, ou até mesmo descontinuas (apud Yang, 2010).
Outros EAs surgiram nesse período, tais como a estratégia evolutiva (Evolution Strategy - ES), de Ingo Rechenberg e Hans-Paul Schwefel, e a técnica de programação evolucionária (Evolutionary Programming Technique - EPT), de Lawrence J. Fogel com Alvin J. Owens e Michael John Walsh.
As décadas de 1980 e 1990 foram os anos mais estimulantes para as pesquisas em algoritmos meta-heurísticos, com o surgimento de diversas metodologias inspiradas em fenômenos da natureza. Como alguns dos mais conhecidos métodos nessa categoria, podem ser citados: o resfriamento simulado (Simulated Annealing - SA), inicialmente utilizado por Scott Kirkpatrick, C. Daniel Gellat e Mario P. Vecchi; a busca tabu (Tabu Search) introduzida por Fred Glover; o algoritmo de otimização da colônia de formigas (Ant Colony Optimization - ACO) descrito na tese de Marco Dorigo; e, um dos mais significativos algoritmos da atualidade, nessa categoria, o algoritmo do enxame de partículas (Particle Swarm Optimization - PSO), que foi desenvolvido por James Kennedy e Russel C. Eberhart.
Hoje em dia, os GAs são os EAs mais populares devido à disponibilidade de várias versões dos mesmos em programas comercias e em programas de livre acesso, e devido às várias técnicas que já foram implementadas para tornar o algoritmo mais robusto. Devido a isso, o GA foi tomado como algoritmo para etapa de busca global.
3.3.1	Algoritmo Genético
O GA tem sua teoria baseada na teoria da evolução das espécies de Charles Darwin (Darwin, 1859). Pela teoria de Darwin, conhecida como a “sobrevivência do mais forte”, a seleção natural desempenha o papel principal. Ele também identificou que algumas raras modificações no fenótipo (mutações) afetam diretamente o desempenho de um indivíduo num determinado ambiente. A teoria de Darwin não deixava claro como a variação genética surgia nos organismos e era passada de geração em geração. Só com o surgimento da genética, fundada por Gregor Mendel, a herança entre as espécies foi explicada.
Com a unificação da genética e do Darwinismo e os estudos do ambiente surgiu o Neodarwinismo. O Neodarwinismo salienta que todas as diversidades da vida no nosso planeta podem ser explicadas através de quatro processos:
1.	Reprodução: mecanismo que garante a herança do material genético da geração atual para a próxima geração;
2.	Mutação: ocorrência de um erro na cópia do material genético (durante o processo de reprodução), que pode ser benéfica se produz um aumento da capacidade do organismo ao seu meio ambiente;
3.	Concorrência: processo natural onde os organismos têm um confronto contínuo para sobreviver e para garantir a continuidade do seu código genético na próxima geração;
4.	Seleção: em um ambiente onde o número de indivíduos é limitado, apenas os organismos, que competirem de maneira mais eficaz, sobrevivem e reproduzem.
A evolução natural pode ser vista como um problema de otimização, onde o objetivo é adaptar melhor as espécies para seu meio ambiente. Os GAs são computacionalmente simples, mas poderosos em sua busca para o melhoramento.
A essência da maioria dos GAs envolve a codificação das informações das variáveis envolvidas em “cromossomos”. Posteriormente, os cromossomos podem ser aval i-ados ou decodificados e as funções envolvidas no problema podem ser computadas. Com a codificação adequada, os procedimentos de busca são baseados na mecânica da genética primitiva e da seleção natural, que combina o conceito da sobrevivência artificial do mais forte com operadores genéticos abstraídos da natureza para formar um mecanismo robusto de busca. O algoritmo básico do GA segue o esquema:
1.	Criação de uma população inicial de indivíduos no espaço de projeto;
2.	Seleção dos genitores, baseada na aptidão dos indivíduos;
3.	Criação de uma nova população através do processo de reprodução por cruzamento e/ou por mutação genética;
4.	Verifica-se a convergência. Caso ocorra convergência, o processo é interrompido caso não ocorra, retorna a passo 2.
Os mecanismos de um GA são bastante simples que envolvem a cópia e a troca parcial de códigos, e/ou modificação dos mesmos. Os operadores, chamados de operadores genéticos, comumente adotados numa programação “padrão” de um GA são responsáveis pela seleção, pelo cruzamento, e pela mutação.
3.3.1.1	Opções do algoritmo genético e operadores genéticos
A forma de concepção da busca genética afeta a forma como os operadores genéticos são definidos. Em GAs convencionais, o operador de cruzamento é usado como principal operador, e o desempenho da busca depende fortemente do mesmo. Nestes mesmos algoritmos, o operador de mutação é usado como operador secundário.
Existem diversos estudos empíricos em torno da comparação entre a importância desses dois operadores no processo de busca. Gen e Cheng (2000) sugeriram uma abordagem onde os dois operadores desempenham papéis importantes durante o processo, e essa é a abordagem adotada neste trabalho.
Existem inúmeras versões de operadores genéticos presentes nas diversas versões GA. Foram realizados estudos com os operadores presentes no GA da caixa de ferramentas de otimização global do MATLAB®.
Vale ressaltar que não há interesse em definir a melhor configuração para que o GA disponível no MATLAB encontre a solução do problema, e sim criar uma ferra-
menta que não necessite de uma configuração para cada utilização, pois, um dos problemas encontrados nos EAs é a dependência da configuração dos mesmos com os problemas nos quais serão utilizados. Apesar de não haver interesse em definir a melhor configuração, não foram ignorados testes com opções que poderiam facilitar o processo de busca. Na definição dos operadores genéticos, serão detalhados apenas os que foram efetivamente empregados nos testes realizados.
3.3.1.1.1	Opções de população
Quando se fala em GA, é comum imaginar a codificação dos cromossomos na forma de bitstring. Porém, atualmente, não é estranho verificar codificações de cromossomos em outros formatos, até mesmo com genes pertencentes ao conjunto dos números reais.
Na versão do GA considerada nos estudos, é permitido que as variáveis assumam a forma de bitstring, ou de variáveis inteira e/ou real. A definição do tipo de população definirá a forma como os operadores genéticos são empregados. Em alguns casos, os operadores funcionam apenas para variáveis inteiras e em outras apenas variáveis reais. Nos problemas estudados, a população adotada possui a codificação dos cromossomos na forma real, pois as variáveis envolvidas nos problemas são continuas.
Além do tipo de população, são disponíveis opções para a criação da população inicial, tais como: tamanho da população; cota da população inicial; escore inicial da população; e opções de criação da população inicial. No entanto, das opções disponíveis, apenas o tamanho da população e o critério de criação da população inicial influenciaram na obtenção das soluções.
A criação da população inicial foi algo que dificultou a obtenção dos resultados, pois a presença de indivíduos viáveis era fundamental nos problemas onde o número de restrições era elevado. Uma opção presente no GA do MATLAB, que aparentava ser de grande ajuda, é a opção de criação da população inicial viável, porém, não foi obtido sucesso quando a mesma foi considerada. Para solucionar este inconveniente foi adotada uma técnica de reparação de cromossomos, que será descrita mais adiante.
3.3.1.1.2	Escalonamento dos indivíduos
O escalonamento é uma operação que facilita a seleção para que sejam empregados os operadores de criação da população da nova geração. O escalonamento pode ser realizado de acordo com o posto dos indivíduos, seguindo uma classificação realizada de acordo com o valor das aptidões da população, ou pode ser definido de forma proporcional às mesmas.
Nos estudos realizados, o valor da função objetivo apresenta um valor bastante elevado (variando entre ordens de 106 e 108), o que tornou necessário o uso de um escalonamento externo ao GA (realizado no cálculo da função) para redução da ordem de grandeza dos valores (passando a ser da ordem de 100). Devido a isso, o escalonamento considerado no GA foi feito baseado apenas no posto dos indivíduos, de acordo com a classificação das aptidões.
Na opção adotada, um indivíduo que ocupa o posto r tem seu escore escalonado proporcional al/Vr . Sendo assim, o indivíduo mais apto tem seu escore proporcional a
1,	o escore do próximo indivíduo mais apto é proporcional à1/&gt;/2 , e assim por diante. O escore definido com o escalonamento proporcional ao posto reduz o efeito de dispersão que pode ser encontrado nos escores definidos com as aptidões dos indivíduos.
3.3.1.1.3	Seleção dos indivíduos
O processo de seleção define quais os indivíduos serão responsáveis pela transmissão da informação genética para a próxima geração. Um dos processos de seleção mais conhecidos nos GAs é o esquema de roleta. O GA do presente no MATLAB apresenta outras opções além da seleção por roleta. A opção considerada foi a da configuração padrão, e é chamada de seleção estocástica uniforme.
Na seleção estocástica uniforme, é definida uma linha na qual cada indivíduo corresponde a uma seção da mesma, de tamanho proporcional ao valor do seu escore escalonado. O algoritmo dessa função define um tamanho de passo padrão a ser dado sobre a reta, e a cada passo dado, o algoritmo aloca um genitor. O primeiro passo tem o tamanho menor do que o passo padrão e é definido por um número aleatório com distribuição uniforme.
3.3.1.1.4	Criação da nova geração
A cada geração, o GA utiliza a população corrente para criar os indivíduos que definirão a nova geração. O algoritmo seleciona um grupo de indivíduos da população atual, chamados de genitores, os quais contribuirão geneticamente para criação dos descendentes. Como visto anteriormente, quanto mais apto é o indivíduo, maiores as chances do mesmo ser selecionado.
A prole gerada pelo GA do MATLAB é definida por três tipos de descendência:
1.	Descendência do elitismo: são criados a partir dos indivíduos da geração corrente que apresentam as melhores aptidões (os indivíduos mais aptos sobrevivem automaticamente para a próxima geração);
2.	Descendência do cruzamento: são indivíduos criados a partir da combinação vetorial dos pares de genitores;
3.	Descendência da mutação: são indivíduos criados pela introdução de mudanças aleatórias, ou mutações, em um único genitor;
A população permanece sempre com o mesmo número de indivíduos definido no início do processo de busca, e para criação da próxima geração é definido o percentual de descendentes do cruzamento, sem contar com os descendentes do elitismo, e o restante é gerado por mutação.
O operador de cruzamento faz a combinação entre os indivíduos da população. Esse operador possibilita ao GA uma investigação mais localizada no espaço de busca onde se encontram os genitores.
O cruzamento considerado cria um vetor binário aleatório do tamanho do cromossomo dos indivíduos da população, e no processo de cruzamento, a coordenada desse vetor que apresenta 1 indica que o gene do novo indivíduo deve ser retirado do primeiro genitor, e a posição que apresenta 0 indica que o gene deve ser retirado do segundo genitor.
Para melhor entender o processo, pode se ter um exemplo com os seguintes genitores:
genitor 1 = [a b c d e f g h];
genitor 2 = [1 2 3 4 5 6 7 8];
e o vetor binário:
vetor = [1 1 0 0 1 0 0 0]; o que retorna um descendente:
cria = [a b 3 4 e 6 7 8];
O operador de mutação especifica como o GA faz pequenas modificações aleatórias nos indivíduos da população para criar os descendentes de mutação. Esse operador estabelece a diversidade genética que possibilita o GA uma busca mais ampla no espaço de busca.
A mutação considerada neste trabalho adiciona um número aleatório para cada entrada do vetor do genitor. Esse número é tomado a partir de uma distribuição Gaussiana, com média 0 e desvio padrão determinado pelo usuário. O valor do desvio padrão é alterado durante o processo de busca através do parâmetro de retração, também definido pelo usuário.
Pode ser configurado um valor de desvio padrão para cada coordenada do vetor de variáveis, porém, foi considerado um valor único, pois as variáveis envolvidas nos problemas estudados apresentam a mesma ordem de grandeza.
A atualização do desvio padrão é dada pela equação:
=^k-1 • I 1 - shrink--I	(3.17)
max Gen J
onde shrink é o fator de retração, k é a geração corrente, e maxGen é o número máximo de gerações permitidas ao GA.
Para os casos onde o fator de retração seja definido com um valor negativo, o desvio padrão é aumentado com o passar das gerações.
Dentre as opções de mutação existentes no GA do MATLAB, existe uma que é apropriada para lidar com problemas restritos; a mutação adaptativa viável. Nessa mutação são geradas direções aleatórias que são adaptadas de acordo com o sucesso ou fracasso das gerações passadas. Esse operador só é aplicável a problemas com restrições lineares, que é o caso dos problemas considerados neste trabalho, porém, não foi obtido sucesso quando considerada em problemas onde o número de restrições era elevado. Devido a isso, a mutação considerada foi a mutação Gaussiana, e para manipular as restrições foi considerado o método de penalização adaptativa (Lemonge &amp;amp; Barbosa, 2002), que é descrito mais adiante.
3.3.1.1.5	Critério de parada
Os critérios de parada no GA considerado, basicamente envolvem o número de gerações e o monitoramento das mudanças relacionadas à melhor aptidão da população. É fixado o número máximo de gerações permitidas para realização da busca da solução
ótima, bem como o número máximo de gerações sem que ocorram mudanças no valor da melhor aptidão da população.
O número máximo de gerações consideradas para a busca varia de acordo com o problema estudado (será definido o valor adotado no capítulo que descreve os exemplos estudados).
Para o monitoramento das mudanças na melhor aptidão, é definido o número de gerações onde as mudanças acumuladas no valor da mesma não exceda o valor da tolerância definida. O valor considerado para a tolerância é 10-6, e o número de gerações consecutivas sem ocorrência significativa de mudanças é limitada a 50 gerações.
A definição de um critério de convergência eficiente para o GA, bem como para os EAs de uma forma geral, é um dos problemas que causa dificuldade de aceitação da comunidade científica para realização de estudos em problemas reais com tais algoritmos, devido ao fato de apresentarem uma convergência lenta, o que representa um número elevado de avaliações de função.
Nesse caso, a utilização de modelos substitutos poderia representar uma saída, porém, a abordagem considerada na combinação com algoritmo de busca global é um pouco diferente da adotada com o algoritmo de busca local.
Outro ponto negativo que pode ser citado para consideração dos EAs em problemas de otimização é a dificuldade que os mesmos apresentam em lidar com restrições, uma vez que foram desenvolvidos inicialmente para solucionar problemas irrestritos . No entanto, ao longo dos anos, esforços foram investidos no desenvolvimento de técnicas para manipulação de restrições.
Antes de tratar sobre a forma como os modelos substitutos foram considerados em conjunto com o GA, é importante tratar sobre a manipulação de restrições, pois, em alguns casos, não foi possível a obtenção de resultados sem as técnicas empregadas, mesmo considerando modelos substitutos.
3.3.1.2	Manipulação de restrições
Os métodos de manipulação de restrição usados em algoritmos de otimização clássica podem ser divididos em dois grupos: (i) métodos genéricos, que não exploram a estrutura matemática das restrições (se lineares ou não-lineares), e (ii) métodos específicos, que são aplicáveis a tipos específicos de restrições.
Métodos genéricos, tais como, método de funções de penalidade, método dos multiplicadores de Lagrange, e o método de busca complexa (Deb, 1995; Reklaitis et. al., 1983) são populares devido à facilidade de aplicação a qualquer problema sem a necessidade de muitas mudanças no algoritmo. Porém, como desvantagem, esses métodos não desempenham seu papel de forma satisfatória na maioria dos casos.
No entanto, métodos específicos, tais como o método de planos de corte, o método dos gradientes reduzidos, e o método da projeção de gradientes (Deb, 1995; Reklaitis et. al., 1983) são métodos que podem ser aplicados em problemas com região viável convexa ou em problemas de poucas variáveis.
Como o GA é um método de busca genérico, a maioria das aplicações do mesmo em problemas restritos é feita com o uso de funções de penalidade. O uso de funções de penalização é um dos métodos mais populares para lidar com a busca restrita, quando
realizada por EAs. No entanto, outros métodos têm sido propostos, tais como: codificações de operadores especiais, decodificadores, o uso do conceito de multiobjetivo, entre outros (Montes, 2009 (ed.)).
A consideração de funções de penalidade envolve um número de parâmetros de penalização que devem ser configurados de forma correta para cada problema com o intuito de obter uma solução viável. Essa dependência do desempenho do GA desses parâmetros de penalidade tem conduzido pesquisadores a desenvolver ferramentas mais sofisticadas.
O GA do MATLAB considera o método do Lagrangeano Aumentado (Augmented Lagrangian - AL) (Conn et. al., 1997). Porém, o mesmo não demonstrou eficiência nos testes realizados, pois, na maioria dos casos, não conseguiu fornecer sequer uma solução no domínio viável. Devido a isso foram investidos esforços para consideração de métodos que pudessem ser incorporados à ferramenta do MATLAB para superar essa barreira.
Duas técnicas para manipulação de restrição foram consideradas nos problemas estudados neste trabalho, uma delas é conhecida como reparação de cromossomos e a outra é o método da penalização adaptativa (Lemonge &amp;amp; Barbosa, 2002). As técnicas consideradas foram utilizadas em momentos distintos durante a otimização. A reparação de cromossomos foi utilizada apenas na fase inicial da busca, enquanto o método da penalização adaptativa foi utilizado no restante do processo.
3.3.1.2.1	Reparação de cromossomos
A consideração da reparação de cromossomos surgiu da necessidade de ter indivíduos viáveis na população inicial do GA, uma vez que a versão disponível para estudos não conseguia apresentar resultados sem a inclusão de pontos viáveis na mesma.
Para não perder a aleatoriedade do processo de busca, foi desenvolvido um procedimento de correção dos genes dos indivíduos criados considerando um escalonamento um pouco mais sofisticado.
Nesse procedimento, inicialmente é realizada a geração dos indivíduos, de forma aleatória e em seguida são verificadas as violações dos mesmos em relação às restrições de desigualdade impostas no problema (formulado na Eq. (1.1)). A partir dessa verificação são criados dois parâmetros de ativação. Esses parâmetros remetem o indivíduo localizado na região inviável à condição ativa das restrições, tanto pelos limites inferiores quanto pelos limites superiores.
Tomando como exemplo uma restrição de desigualdade na forma “canônica”, como apresentada na equação a seguir:
bz &amp;lt;A • x &amp;lt;b"
(3.18)
onde b e b“ são, respectivamente, os vetores com os limites inferiores e superiores das restrições, A é a matriz com os coeficientes lineares das restrições, e x é o vetor das variáveis. Os coeficientes mencionados são criados a partir da resolução da equação
A&lt;2zx) = b
(3.19)
e da equação
A-(2“ x) = bu	(3.20)
onde 2l e 2u são os parâmetros de ativação mencionados anteriormente, sendo o primeiro de ativação dos limites inferiores e o seguinte o de ativação dos limites superiores.
Os parâmetros definidos servem como cota para o parâmetro de “reparação” dos indivíduos (2), que é gerado de forma aleatória. Após a aplicação da correção, que torna as restrições impostas não violadas, ainda é necessário verificar se foram obedecidas as violações nas cotas das variáveis, uma vez que o parâmetro 2 pode reduzir as mesmas, de forma a remetê-las a valores abaixo dos limites inferiores, ou aumentá-las, de forma a remetê-las a valores acima dos limites superiores.
Nessa verificação, é feita uma classificação nas variáveis, em ordem decrescente, e caso haja “excesso” ou “déficit” em alguma das variáveis, uma redistribuição é realizada para que todas pertençam ao domínio de projeto.
Quando se tem um excesso, os mesmos são distribuídos de maneira ordenada, seguindo a ordem da classificação, ou seja, a distribuição começa a partir da primeira coordenada que não apresenta excedente, e caso o excesso não possa ser locado por completo na mesma a distribuição segue para a coordenada seguinte, e assim sucessivamente até que todo o excesso tenha sido distribuído. No caso do déficit, o processo é inverso, o que falta é retirada das demais coordenadas até que o déficit seja suprido. Após a redistribuição, as variáveis são relocadas às posições originais.
A consideração da classificação para redistribuição faz com que as variáveis que apresentavam valor elevado, em relação às outras, continuem assim, e as que foram geradas com valores mais baixos também continuem com valores inferiores às demais.
3.3.1.2.2	Método da penalização adaptativa
De forma geral, as técnicas de penalização podem ser classificadas como multiplicativa ou aditiva. A penalização multiplicativa é muito menos investigada nas pesquisas com EAs do que a penalização aditiva.
No caso da penalização multiplicativa, um fator de penalização é introduzido com o intuito de aumentar o valor da função aptidão de uma solução inviável. No caso da penalização aditiva, uma função de penalidade é adicionada a função objetivo com o intuito de definir a aptidão de uma solução inviável. As funções adicionadas podem ser divididas em: (a) técnica interior, onde uma função de barreira - que cresce rapidamente à medida que uma solução se aproxima dos limites da região viável - é adicionada a função objetivo; e (b) técnica exterior, onde uma função a ser adicionada assume o valor zero, quando a solução é viável, e um valor maior do que zero caso contrário.
A partir deste ponto é conveniente quantificar a violação de uma restrição para uma solução x . A quantidade de violação da j-ésima restrição será considerada como sendo vj(x), onde:
V (x) =
I hj(x)l
I
Imax {o, gj(x)}|
para restrições de igualdade
para demais restrições
(3.21)
A maioria dos métodos de penalização necessita de uma configuração para realização das operações durante o processo de otimização. Lemonge e Barbosa (2002) introduziram um método que não necessita de definições nos parâmetros de penalização feitas pelo usuário. Um esquema adaptativo foi desenvolvido, onde são utilizadas apenas informações da população, tais como a média dos valores da função objetivo e o nível de violação de cada restrição durante a evolução.
A função aptidão proposta assume a forma:
f (x)	se x é viável
J  	m+n
f (x)■ V k^j (x)	caso contrário
(3.22)
sendo kj o parâmetro de penalização referente a j-ésima restrição, e f (x) é definido a partir de:
f (x) = *
f (x)	se f (x) &gt; (f (x))
(f (x)) caso contrário
(3.23)
onde (f (x)} é a média dos valores da função objetivo da população corrente.
Para ilustrar o comportamento da função aptidão, na Figura 3.3 são apresentadas tanto soluções viáveis quanto inviáveis.
Figura 3.3- Descrição ilustrativa da função f (x).
Como visto, dentre as cinco soluções inviáveis, os indivíduos #2, #3, #4 e #5 tiveram o valor da função objetivo (representado pelo círculo aberto) menor do que o valor da média das funções objetivo da população e tiveram o valor de f (x) dado por
(f (x)}, de acordo com o método proposto por Lemonge &amp;amp; Barbosa (2002). A solução #1 teve o valor da fUnção objetivo maior do que a média da população e por isso teve ~f ( x ) = f ( x ).
Os parâmetros de penalização das restrições são definidos a cada geração através da equação:
k (x »i
x)) ÊK v(x $ ]
l=1
(3.24)
onde(v (x')} é a média das violações da l-ésima restrição na população corrente.
A ideia é fazer com que o valor dos coeficientes de penalização sejam distribuídos de forma que as restrições com mais dificuldade de serem satisfeitas tenham uma penalização relativamente maior (Lemonge &amp;amp; Barbosa, 2002). Com a definição proposta pode se ter a prova da seguinte propriedade:
- Propriedade: um indivíduo cuja violação naj-ésima restrição seja igual ao valor médio das violações da mesma restrição, para todo j, terá o valor da aptidão dado por:
F (X
r f (X
J (x)} +1( f (x)}| caso contrário
x	x x
- Prova: sendo x um elemento qualquer, por definição:
...1/ j(„)\l /v (x)\
F( x	x	x
j Ê	Vi( x )) J-
l=1
no entanto, pela hipótese, v. (x
x)} para todo j, fazendo com que:
(3.25)
(3.26)
1/ r/ \\l	__
F(x	x	x	x
ÊL( v(x » J j=1
i=i
(3.27)
3.3.2	Aproximação global - modelo substituto adaptativo
No processo de busca global, a investigação nas diversas regiões do domínio de projeto é fundamental para que se possa encontrar a solução ótima global, ou pelo menos a região onde a mesma se encontra. Devido a isso, o modelo substituto criado para que o GA possa atuar tenta abranger todo o domínio de projeto.
Um modelo substituto que consiga definir de forma adequada o comportamento global das funções envolvidas no problema não é algo trivial, já que se tem interesse em uma boa caracterização do comportamento das funções verdadeiras sem desperdiçar avaliações em pontos amostrais de regiões pouco promissoras. Além disso, quando a otimização é restrita as exigências aumentam, pois, é importante que o modelo substituto consiga representar o comportamento da função no domínio viável, porém, sem deixar de representar a região inviável de forma razoável, visto que, geralmente, a solução ótima se encontra nos limites da região viável.
Uma alternativa é a criação de um modelo substituto “fraco” que é enriquecido à medida que o processo de busca é realizado. Um esquema de modelo substituto com adição de pontos, na otimização do problema de injeção de água em reservatório de petróleo, foi considerado com o algoritmo PSO no trabalho apresentado por Souza (2012). Um esquema semelhante é considerado aqui.
Inicialmente, são criadas duas amostras: uma amostra inicial com um número representativo de indivíduos pertencentes à região viável - os indivíduos são viabilizados através da reparação de cromossomos (citada anteriormente); e uma amostra específica para atualização do modelo substituto, cujos pontos são pertencentes ao domínio viável.
O modelo substituto inicial é criado com a primeira amostra, e nele, é realizada a otimização com o GA. Após a finalização da busca, é realizada uma analise de consistência da solução encontrada. Se a precisão do modelo não for satisfatória, o modelo é atualizado com uma nova amostra, que é composta pela amostra inicial adicionada da solução encontrada pelo GA e de pontos da amostra de soluções viáveis (escolhidos de forma aleatória). O modelo é atualizado até que existam pontos disponíveis na amostra de soluções viáveis ou a tolerância da precisão seja atendida.
A consideração do ponto “solução” para atualização do modelo melhora a defin i-ção do comportamento na região onde o mesmo foi encontrado pelo GA, porém, não deve ser considerado sozinho, uma vez que pode representar um ótimo local. A adição dos pontos da amostra viável faz com que o modelo seja melhorado em regiões aleatórias do domínio viável.
Os aspectos computacionais dessa estratégia podem ser resumidos segundo o esquema apresentado a seguir:
1.	Criar um conjunto de amostras (número de pontos definidos nos exemplos), da qual 60% desses pontos são pertencentes à região viável;
2.	Criar um conjunto de amostras viáveis (número de pontos definidos nos exemplos);
3.	Computar os valores das funções objetivo e de restrições reais do primeiro conjunto de amostras;
4.	Construir uma função substituta de alcance global, para as funções objetivo e de restrições;
5.	Otimizar o problema usando as funções aproximadas;
6.	Recalcular as funções objetivo e de restrições reais no ponto ótimo encontrado;
7.	Verificar critério de convergência global da estratégia:
7.1.	Se alcançada: o projeto ótimo é obtido e o processo é finalizado:
7.2.	Caso contrário: o ponto encontrado pelo GA é adicionado à amostra inicial junto com pontos da amostra de soluções viáveis (número de pontos definidos nos exemplos), e retorna ao passo 4;
3.3.3	Análise do custo computacional
Tomando o exemplo considerado na seção 3.2.3, foram realizados testes com o intuito de verificar a eficiência dos algoritmos de busca global para obtenção da solução ótima global.
Na tentativa de encontrar a solução do problema com o GA, 30 execuções foram realizadas, onde para cada rodada era considerada uma população inicial específica. A configuração utilizada no GA foi a configuração padrão definida no MATLAB, que está listada a seguir:
1.	Tipo de população: variáveis reais;
2.	População inicial: criada através de um plano de amostragem considerando a técnica LCVT (Romero et. al., 2006), com 100 indivíduos;
3.	Escalonamento dos indivíduos: de acordo com o posto;
4.	Seleção: seleção estocástica uniforme;
5.	Elitismo: 2 sobreviventes;
6.	Fração de população criada por cruzamento: 80%;
7.	Tipo de cruzamento: cruzamento difuso;
8.	Tipo de mutação: mutação adaptativa viável - essa opção é selecionada automaticamente quando o algoritmo identifica restrições, inclusive restrições de limites das variáveis (nos testes realizados com os problemas de reservatório foi considerada a mutação Gaussiana e as restrições de limites foram tratadas com as penalizações adaptativas);
9.	Número de gerações: 100;
10.	Número de gerações para verificação das modificações no valor da melhor aptidão: 50;
A tabela a seguir apresenta um resumo das soluções obtidas.
Tabela 3.2- Resumo dos resultados obtidos com o GA para a função Shubert.
Melhor	Pior	Média das	Desvio padrão das soluções	Avaliações de
solução	solução	Soluções		função (média)
210,482	210,482	210,482	6,61 x10-6	5.200
A Figura 3.4 apresenta o resultado da execução com melhor solução, onde são ilustradas as posições da população inicial e as posições da população final.
Figura 3.4- Convergência da população para melhor solução encontrada com o algoritmo de busca global
Pode ser observado na Tabela 3.2 que as soluções obtidas estão de acordo com o valor máximo reportado anteriormente. Porém, o custo computacional para isso foi bastante elevado, uma vez que para obter os resultados foram considerados, em média, 5.200 avaliações de função. Tomando esse resultado como referência para fazer uma analogia com a obtenção de resultados em problemas de engenharia com as mesmas características, o emprego de algoritmos evolucionários não representa uma opção plausível a ser considerada.
Com os testes realizados pelos algoritmos de busca local e de busca global foi possível perceber que ambos apresentam características proveitosas para obtenção de soluções ótimas, porém, as características negativas, em algumas situações, pode inviabilizar a utilização dos mesmos.
Para superar as dificuldades, e explorar os aspectos positivos inerentes aos algoritmos, uma opção que surge é a combinação dos métodos para criar estratégias híbridas e realizar o processo de busca da solução dos problemas propostos.
3.4	Estratégia híbrida
Pelas características do problema de otimização da produção de reservatórios de petróleo (sendo uma das principais, a multimodalidade), os algoritmos de busca global seriam os mais indicados para realizar o processo de otimização. No entanto, a necessidade de um número elevado de avaliação de funções torna praticamente impossível a consideração de EAs, principalmente à medida que a complexidade do problema cresce, pois, apesar de encontrar a região onde a solução ótima está localizada logo nas primeiras iterações, a convergência se dá de forma tardia.
A consideração de modelos substitutos poderia representar uma opção para superar tal problema. No entanto, a criação de um modelo satisfatório para todo o domínio
de projeto, requer inúmeras amostras, e a geração de amostras implica em avaliações da função real (simulações numéricas).
Como citado anteriormente, sabe-se que os algoritmos de busca local são bastante eficazes no processo de convergência para a obtenção da solução ótima, porém, o resultado está relacionado com o ponto inicial fornecido, ou seja, várias tentativas com pontos iniciais diferentes são necessárias para encontrar um resultado global, e ainda assim sem garantias.
Na tentativa de combinar as características positivas dos algoritmos citados, é considerada neste trabalho uma estratégia híbrida que realiza o processo de busca em duas etapas. Na primeira etapa, o GA é utilizado para identificação da região onde está localizado o provável ótimo global, e na segunda etapa, o SQP realiza o refinamento da solução encontrada pelo GA.
Na etapa inicial, a identificação da região de localização do provável ótimo global não é definida com a convergência do GA, mas com limitações impostas nas configurações do algoritmo. As limitações são feitas, basicamente, no número de gerações, que indiretamente limita o número de avaliações de função.
Na etapa seguinte, o resultado encontrado no passo anterior é fornecido como ponto inicial para o algoritmo de busca local, que se encarrega de obter a solução ótima.
Como foram definidas algumas opções de técnicas a serem empregadas no processo de busca, foram criadas diferentes versões de algoritmos híbridos para investigar os problemas estudados. As versões são diferenciadas basicamente pela consideração de modelos substitutos na otimização.
Na primeira versão, tanto a busca global como a busca local são realizadas no modelo de alta fidelidade (high fidelity - HF), ou seja, os valores das funções envolvidas são computados através do uso do simulador numérico. A segunda versão implementada faz uso do modelo substituto, ou modelo de baixa fidelidade (low fidelity -LF), ou seja, o modelo substituto, no processo de busca global, e o modelo alta fidelidade na busca local. A terceira versão, todo o processo é feito considerando o modelo de baixa fidelidade. Nas versões onde é adotado o modelo substituto, os mesmos são considerados de acordo com a descrição dada anteriormente.
3.4.1	Análise de desempenho
Mais uma vez foi tomado o exemplo considerado na seção 3.2.3, para realização de testes visando verificar os benefícios da consideração da estratégia híbrida. A ideia da estratégia híbrida também visa diminuir os gastos com inúmeras tentativas, considerando que apenas uma rodada fornece a solução ótima global. Porém, por questões de verificação são executadas 30 rodadas, para averiguar se as soluções encontradas realmente atendem as expectativas.
Nos testes realizados, a configuração considerada no GA foi a mesma adotada no caso onde o mesmo foi utilizado sozinho na otimização da função, com uma pequena mudança no número de gerações permitidas, sendo o mesmo reduzido para cinco gerações. A Tabela 3.3 apresenta um resumo das soluções obtidas.
Tabela 3.3 - Resumo dos resultados obtidos com a estratégia híbrida para a função Shubert.
Melhor solução	Pior solução	Média das Soluções	Desvio padrão das soluções	Avaliações de função (média)
210,482	210,482	210,482	5,09x10-14	662
A Figura 3.5 apresenta o resultado obtido com a estratégia híbrida, da execução que obteve a melhor solução.
Figura 3.5- Solução encontrada com a estratégia híbrida nas etapas (a) global e (b) lo
cal.
Como visto, as soluções encontradas convergiram para o valor esperado, com precisão e número de avaliações de função reduzido em = 8 6 % das avaliações necessárias para os resultados obtidos quando foi considerado apenas o GA no processo de otimiza-
ção. No Capítulo 5 são apresentados os resultados obtidos para os problemas de otimização do gerenciamento da produção de reservatórios.
Capítulo 4 - Estratégias de otimização multiobjetivo
Na engenharia, diversas são as metas a serem atingidas, e facilmente são encontradas situações onde uma das metas exige mais atenção do que outras. Porém, quando se resolve uma das metas de forma isolada, a solução encontrada pode influenciar negativamente para a solução das demais.
Como citado no capítulo anterior, o alcance das metas nos problemas de engenharia podem ser formulados matematicamente como problemas de otimização com o intuito de definir a solução que representará o projeto “ideal”.
A otimização de múltiplos objetivos tem o intuito de definir soluções, de forma a fornecer boas condições para todas as funções objetivo envolvidos no problema, porém, normalmente, as funções a serem otimizadas são contraditórias e nesse contexto, o processo de busca não encontra uma solução única, mas um conjunto de soluções.
As soluções encontradas para problemas com múltiplos objetivos são chamada s de soluções de Pareto, e o conjunto formado por todas elas é a superfície de Pareto ou frente de Pareto (Macedo, 2002).
Da mesma forma que foi adotada uma estratégia que combina as qualidades dos algoritmos para lidar com problemas de otimização de reservatórios de petróleo envolvendo uma única função objetivo, também é sugerido aqui uma estratégia que combina as qualidades de algoritmos para solução de problemas multiobjetivos.
4.1	Visão geral
Matematicamente, é possível escrever um problema de otimização multiobjetivo como:
Minimize F (x)
xe&gt;
sujeito a: h (x) = 0, (i = 1, 2, ..., m)	(4.1)
gj(x) &amp;lt;0 (j = 1, 2 ..., n)
onde F(x) é um vetor que contém todas as funções objetivos a serem avaliadas no problema.
De posse das soluções do problema de otimização multiobjetivo, fica a critério do responsável pelo projeto definir qual solução melhor representa o seu interesse. Alguns autores indicam a existência de regras para definir a melhor solução dentre as soluções Pareto, como é apresentado em Cramer et. al. (2012), porém não deixam claro quais os fundamentos considerados. A definição de uma metodologia para a seleção da solução facilitaria a tomada de decisão, mas não é o foco desse trabalho.
Antes de definir as técnicas adotadas para busca das soluções de Pareto nos problemas de otimização multiobjetivo, alguns conceitos fundamentais precisam ser definidos, tais como dominância e convexidade.
4.2	Dominância
No conjunto de soluções encontradas deve existir uma relação de dominância entre a solução considerada e as outras soluções comparadas a ela. A relação de dominância é definida da seguinte forma:
• Um vetor x' domina um vetor x2, para um determinado F(x), se:
f(x’) &amp;lt;f (x2)	para todos os objetivos, e
f(x’) &amp;lt;f (x2)	para pelo menos um dos objetivos
As soluções que dominam outras soluções e não apresentam soluções que as dominem são denominadas soluções de Pareto (Collette &amp;amp; Siarry, 2003).
Tomando como exemplo um problema com duas funções objetivo, onde se deseja obter o valor mínimo para ambas, quando se aplica o critério de dominância, quatro áreas podem ser definidas e a cada área pode ser associado um nível de preferência (Collette &amp;amp; Siarry, 2003), como mostrado na Figura 4.1.
A
(2)	(í)
Área de	Área de
indiferença	preferência
	Á
Área de	Área de
eliminação	indiferença
(D	
Figura 4.1 - Nível de preferência e relação de dominância.
Considerando que a figura esteja centrada em uma solução A, ao compará-la com uma solução B, têm-se as seguintes possibilidades:
•	se	B	pertence à área 1, então A domina B;
•	se	B	pertence à área 3, então A é dominada por B;
•	se	B	pertence à área 2 ou à área 4, então não se pode	dizer qual das soluções é
preferível em relação à outra.
A relação de dominância é uma definição importante porque alguns métodos necessitam dessa relação para definir as soluções de Pareto do problema. Com essa relação é estabelecido um posto chamado posto de Pareto (irank), baseado no número de soluções pelas quais uma solução é dominada (Collette &amp;amp; Siarry, 2003).
4.3	Convexidade
Um conjunto S é definido como convexo se, dados dois pontos distintos no conjunto, o segmento que liga estes dois pontos se encontra por completo no conjunto (Collette &amp;amp; Siarry, 2003). Na Figura 4.2 pode ser verificado um exemplo de conjunto convexo e um exemplo de conjunto não-convexo.
Figura 4.2 - Exemplo de conjunto (a) convexo e (b) não-convexo.
A definição de convexidade é importante, pois, alguns métodos de otimização multiobjetivo necessitam que algumas hipóteses sejam atendidas, e só conseguem obter soluções em um conjunto convexo.
A seguir são apresentados alguns métodos para determinar a frente de Pareto, e dentre os métodos apresentados é dada uma descrição dos que foram adotados neste trabalho.
4.4	Métodos de geração de pontos de Pareto
Existem diversos métodos de otimização, e para cada um deles existe uma variação para aplicação em problemas com múltiplos objetivos. Collette e Siarry (2003) apresentam uma classificação desses métodos em três grupos:
•	Métodos de preferência apriori: neste grupo o tomador de decisões define a importância dos obj etivos antes de realizar a otimização. Neste grupo está a maioria dos métodos de agregação (onde as funções objetivo são reunidas em uma única função objetivo);
•	Métodos de preferência progressiva: neste grupo o tomador de decisões define a importância dos obj etivos durante o processo de obtenção das soluções em um processo interativo;
•	Métodos de preferência a posteriori: neste grupo o tomador de decisões escolhe as soluções de interesse examinando as soluções fornecidas pelo método.
Essa classificação serve para facilitar a classificação dos métodos de otimização multiobjetivo em grupos, porém, alguns destes não se encaixam exclusivamente em
apenas um grupo, por exemplo, um método de preferência a priori pode ser usado com os pesos definidos de forma aleatória, fazendo com que o resultado obtido seja um conjunto de pontos, tornando assim, o algoritmo um método de preferência a posteriori.
uma classificação mais intuitiva, talvez a que melhor se encaixe para os métodos estudados neste trabalho, divide os algoritmos em classes de acordo com a essência da metodologia empregada (a programação matemática ou algoritmos evolucionários).
De acordo com a classificação dada por Collette &amp;amp; Siarry (2003), neste trabalho são considerados apenas os métodos de preferência a posteriori, onde uma metodologia emprega a programação matemática e a outra é derivada de um algoritmo evolucionário.
4.4.1	Métodos de otimização multiobjectivo através da programação matemática
os primeiros métodos de otimização multiobjetivo foram derivados de algoritmos de programação matemática. um dos métodos mais conhecidos nessa linha é o método das funções agregadas ou método das somas ponderadas (WeightedSum - WS), pois é um dos métodos de uso mais simples (Koski, 1985; Afonso, 1997; Afonso &amp;amp; Sienz, 1999).
Ao longo dos anos, com o desenvolvimento de estudos nessa área, foram surgindo diferentes métodos, sendo um dos mais robustos para aplicação em problemas de engenharia, o método da intersecção contorno-normal (Normal-Boundary Intersection -NBI) (Das &amp;amp; Dennis, 1997; Motta, 2009; Cramer et. al., 2012). O NBI é um dos métodos utilizados na estratégia híbrida para otimização de múltiplos objetivos considerada neste trabalho.
4.4.1.1	Método da intersecção contorno-normal (Normal-Boundary Intersection -NBI)
O NBI (Das &amp;amp; Dennis, 1997) é uma técnica criada para encontrar “pontos eficientes” (ou pontos NBI), que estão no contorno do espaço viável gerado pelos vetores de objetivos alcançáveis, que possibilitam a construção de uma curva ou superfície suave para o problema multiobjetivo. Quando os pontos eficientes estiverem sobre uma parte do contorno não dominada do espaço viável, esses pontos são definidos como pontos de Pareto. Porém, se os pontos avaliados estiverem na parte dominada, esses pontos contribuirão para que a frente de Pareto seja definida.
O NBI procura os pontos sobre a frente de Pareto através da solução de alguns subproblemas restritos com uma única função objetivo, que são chamados subproblemas NBI. As restrições impostas nos subproblemas NBI são representadas pelas restrições existentes no problema original e pela restrição adicional do método.
O número de subproblemas resolvidos define o número de soluções a serem encontradas objetivando determinar a frente de Pareto. os subproblemas são resolvidos usando qualquer método de otimização baseado no cálculo de gradiente (Cramer et. al., 2012) (neste trabalho é considerado o SQP).
Inicialmente o método resolve problemas de otimização uniobjetivo considerando cada função objetivo separadamente. os resultados obtidos destas otimizações definem o chamado ponto utópico (utopia point ou shadow minima) (Das &amp;amp; Dennis, 1997). O ponto utópico é representado por:
F *=f f*, ..., fj
(4.3)
Com a definição do ponto utópico é feita uma transformação no vetor das funções objetivo, como:
F (x) = F (x) - F *	(4.4)
Tomando um ponto x*, que representa o ponto que minimiza a função fi, o novo espaço aonde os subproblemas são resolvidos é definido através de:
O(Ó j) = {ft(x}) - f),	i, J = 1 ..., nobj	(4.5)
Esse novo espaço é denominado por 3, e o seu contorno por 33. As combinações dos pontos em O definem a envoltória convexa de mínimos individuais (Convex Hull of IndividualMinima - CHIM).
Os subproblemas NBI possuem o objetivo de encontrar a parte do contorno, 33, que contém os pontos de Pareto. A ideia geométrica, ilustrada na Figura 4.3, associada ao método indica que tais pontos são encontrados a partir da intersecção entre a reta quasi-normal à CHIM (que é orientada pelo versor, n) e o contorno 33. A reta é definida por p =	+ tn, e o versor quasi-normal é obtido com o ponto médio da CHIM e o
*
ponto utópico, F*.
Cada subproblema do NBI é formulado através da definição de parâmetros (fl), que também podem ser chamadas de pesos. Esses parâmetros indicam a posição onde a reta p intercepta a CHIM. Na realidade, os pesos representam as componentes de fl, que são, respectivamente, as medidas das distâncias dos segmentos que conectam os pontos utópicos ao ponto inicial. Essas distâncias são normalizadas através das distâncias entre os pontos extremos (soluções ótimas individuais).
Matematicamente, o problema pode ser formulado como:
Maxmize t
x ,t
sujeito a: h (x) = 0, (i = 1, 2, ..., m) gj(x) 0, (J =1 2 ..., n) Qfl + tn &gt; F (x)
(4.6)
Originalmente, o método apresentado por Das &amp;amp; Dennis (1997) considera a restrição adicional como uma restrição de igualdade. Motta et. al. (2012) apresentou a consideração da restrição de desigualdade, que proporciona uma maior liberdade na otimização do subproblema. Exemplos que demonstram essa flexibilidade são encontrados em Motta et. al. (2012).
Para facilitar o entendimento, é apresentado na Figura 4.3, um exemplo considerando a minimização de dois objetivos onde é apresentada a solução de um subproblema NBI.
Na Figura 4.3, a área sombreada representa a região viável para os subproblemas NBI. O ponto A representa o mínimo da função fi, enquanto B representa o mínimo da funçãof2. O ponto Fe o ponto utópico. O segmento AB representa a CHIM, e o ponto H é o ponto inicial do subproblema representado. Os pesos que representam 3 são definidos, respectivamente pelo tamanho dos segmentos AH e HB normalizados pelo tamanho do segmento AB.
A linha n, que tem a direção quasi-normal e passa por H, representa a restrição introduzida na formulação do subproblema NBI. O ponto P é a solução desse subproblema. O tamanho do segmento HP representa a nova variável, t, que também é introduzida pela formulação do subproblema.
Como citado, para definir a frente de Pareto com o NBI, vários problemas são resolvidos. Levando em consideração que o intuito dos estudos é a aplicação do método em problemas que utilizam um programa de análise tratado como uma “caixa preta”, mais uma vez se faz necessário o emprego de modelos substitutos com o intuito de diminuir o custo computacional.
4.4.1.2	Otimização Sequencial de Múltiplos Objetivos por Aproximação com o Método da Intersecção Contorno-Normal
Na otimização sequencial de múltiplos objetivos por aproximação a ideia principal é basicamente a mesma empregada no SAO, onde é feita a decomposição do problema de otimização em uma sequência de subproblemas menores, ou seja, para uso em conjunto com o NBI. Cada subproblema NBI é decomposto em uma sucessão de subproblemas menores, e o algoritmo de otimização opera sobre o modelo substituto de uma pequena região do domínio de projeto, ao invés de usar as respostas obtidas da simulação.
Inicialmente, para obtenção do ponto utópico, a metodologia empregada é exatamente a metodologia SAO, que foi apresentada no capítulo anterior, para os demais subproblemas NBI, a formulação matemática pode ser descrita como:
Maxmize t
x ,t
sujeito a: hik (x) = 0, (i = 1, 2, ..., m)
g},k(x) 0 (j =1 2, ..., n)	(4.7)
Q^ + tn &gt; Fk (x)
xmin xk,min x &amp;lt;xkmx &amp;lt;A x
onde xk,min e xk,max são definidos da mesma forma que é apresentado na Eq. (3.8), e as funções, hi k (x) e (x) são as funções substitutas das restrições de igualdade e de desigualdade, na k-ésima iteração do SAO, já a função substituta criada para a restrição imposta pelo método NBI é criada de forma diferente das funções para as demais restrições.
A função substituta para restrição do NBI é composta com termos do modelo de alta fidelidade (a esquerda da desigualdade) e com o termo do modelo substituto (a direita da desigualdade). Para definir O e n, é necessária o conhecimento da CHIM e do ponto utópico, F*, que são obtidos na etapa inicial da otimização. Para definição da função substituta normalizada, que é apresentada no segundo termo, é considerada como:
Fk (x) = F (x) - F *	(4.8)
onde F (x) é a função criada substituta com o modelo de krigagem, na k-ésima iteração.
Os aspectos computacionais dessa estratégia podem ser resumidos segundo o esquema apresentado a seguir:
1.	Realizar a otimização uniobjetivo das funções envolvidas no problema (utilizando o SAO - esquema descrito no Capítulo 3 -), para definição da CHIM, do ponto F, e do vetor n;
2.	Definir os pesos, /3, ao longo da CHIM para otimização dos subproblemas NBI;
3.	Para cada peso, /}.
3.1.	Atribuir o tamanho para o ponto inicial relacionado ao peso 0i, da região de confiança;
3.2.	Computar o vetor de funções objetivo e as funções de restrições reais no ponto central da sub-região;
3.3.	Construir uma função substituta, aproximada localmente, para as funções;
3.4.	Otimizar o subproblema NBI usando as funções aproximadas, onde as variáveis de projeto são limitadas pelas fronteiras da sub-região;
3.5.	Recalcular as funções reais no ponto ótimo encontrado;
3.6.	Manter/reduzir/aumentar a nova sub-região de acordo com o esquema da região de confiança;
3.7.	Impor a consistência (fator de correção) entre o modelo real e o aproximado;
3.8.	Verificar critério de convergência global da estratégia:
3.8.1.	Se alcançada: o projeto ótimo é obtido, o processo é finalizado com sucesso;
3.8.2.	Caso contrário: retorna ao passo 3.3;
3.9.	Repetir o processo, a partir do passo 3.1, até que todos os pesos tenham sido considerados.
As correções e atualizações consideradas nesta metodologia são as mesmas empregadas na metodologia SAO, que está descrita no Capítulo 3 -.
Devido ao fato do NBI ser uma variação de um método de otimização que considera programação matemática para resolver problemas uni-objetivo, além das dificuldades encontradas inerentes ao método (sendo uma das principais, a presença de multimo-dalidade), outro problema é encontrado quando frente de Pareto apresenta descontinuidades. Estas descontinuidades podem direcionar o algoritmo a fornecer soluções dominadas como resultado da otimização. Uma alternativa que pode possibilitar a superação dessas dificuldades é o uso de métodos derivados de algoritmos evolucionários.
4.4.2	Métodos de otimização multiobjetivo com algoritmos evolucionários
Os métodos de otimização multiobjetivo com algoritmos evolucionários, da mesma forma que os métodos que utilizam a programação matemática, foram desenvolvidos a partir de adaptações de métodos para obtenção de soluções de problemas uniobjetivo.
O primeiro algoritmo implementado foi o algoritmo genético com avaliação vetorial (Vector Evaluation Genetic Algorithm - VEGA) de Schaffer, que foi introduzido em meados dos anos 80, visando resolver principalmente problemas no mecanismo de aprendizado artificial (Schaffer, 1984; Schaffer, 1985; Schaffer &amp;amp; Grefenstette, 1985). Desde então, um montante considerável de pesquisas foram realizadas nessa área, que é conhecida atualmente como otimização evolucionária multiobjetiva (Evolutionary Multiobjective Optimization - EMO).
A crescente importância deste campo esta refletida na publicação significativa (principalmente nos últimos anos da década de 90 e no início do século 21) de artigos em conferências internacionais, em revistas e em livros (Abraham et. al., 2005).
Como descrito no Capítulo 3, os EAs são caracterizados pela consideração de uma população de candidatos no processo de otimização, e essa característica possibilita aos algoritmos multiobjetivo evolucionários a obtenção de diversas soluções ótimas de Pareto em uma única execução do algoritmo ao invés de executar várias otimizações separadamente.
Um dos desafios em uma otimização multiobjetivo com abordagem evolucionária é minimizar a distância entre as soluções geradas para frente de Pareto e maximizar a diversidade de soluções de Pareto desenvolvidas (Abraham et. al., 2005). Para obter uma heterogeneidade, deve ser dada atenção especial ao processo de seleção e cuidados
especiais devem ser tomados para prevenir que soluções não-dominadas sejam perdidas (Abraham et. al., 2005).
Alguns autores consideram uma subdivisão desse grupo, tal como apresentada em (Abraham et. al., 2005), onde as estratégias evolucionárias podem ser agrupadas em:
•	Funções agregadas (Aggregating functions};
•	Abordagens populacionais (Population-based approaches);
•	Abordagem de Pareto (Pareto-based approaches).
Uma breve introdução sobre cada família é dada a seguir.
4.4.2.1	Funções agregadas
Talvez a mais simples abordagem para manusear múltiplos objetivos com qualquer técnica seja combinar todos os objetivos em um único objetivo, seja através de uma adição, uma multiplicação ou qualquer outra combinação de operações aritméticas.
De fato, a abordagem de agregar é o mais antigo método de programação para otimização multiobjectivo (Kuhn &amp;amp; Tucker, 1951), porém, quando é adotada em uma estratégia evolucionária, os coeficientes que definem a importância de cada objetivo na composição da função agregada podem ser definidos dinamicamente, ao longo das gerações, fazendo com que a frente de Pareto possa ser obtida em uma única execução.
Um dos métodos que podem ser citados neste grupo, devido à eficiência e eficácia, é o método da agregação evolucionária com ponderação dinâmica (Evolutionary Dynamic Weighted Aggregation - EDWA), que foi proposto por Jin (2001).
4.4.2.2	Abordagens populacionais
Nas técnicas apresentadas neste grupo, a população de um algoritmo evolucionário é usada para diversificar a busca, o conceito de dominância de Pareto não é diretamente incorporado no processo de seleção. Um exemplo clássico deste tipo de abordagem é o VEGA (Schaffer, 1984; Schaffer, 1985; Schaffer &amp;amp; Grefenstette, 1985), que consiste basicamente de um algoritmo genético com um mecanismo de seleção modificado.
Em cada geração, um número de sub-populações é gerada executando uma seleção proporcional de acordo com cada função objetivo por vez. Assim, para um problema com k-objetivos, k sub-populações são geradas, onde o tamanho de cada população é definido por M/k (assumindo um tamanho total M para população) (Abraham et. al., 2005). Estas sub-populações são então misturadas para obtenção de uma nova população de tamanho M, onde são aplicados os operadores.
Alguns problemas surgem na consideração desses métodos, pois, em alguns casos, o esquema de seleção se opõe ao conceito de dominância de Pareto. Se, por exemplo, existir um indivíduo que represente uma solução compromisso com relação a todos os objetivos, mas não é a melhor solução encontrada na população quando considerada a atuação isolada de cada objetivo, esta solução pode ser descartada (Abraham et. al., 2005).
4.4.2.3	Abordagens de Pareto
Tendo como base os principais inconvenientes encontrados no VEGA, Goldberg apresentou outra abordagem para tentar resolver problemas multiobj ectivos (Goldberg,
1989). O procedimento consiste num esquema de seleção baseado no conceito de otima-lidade de Pareto. Goldberg não só sugeriu o que passaria a ser o padrão de algoritmo evolucionário multiobjetivo por muitos anos, mas também indicou que ruídos estocásti-cos fariam tais algoritmos inúteis, a menos que algum mecanismo especial fosse adotado para bloquear a convergência. Um processo de separação (niching) ou uma função de partilha (Deb &amp;amp; Goldberg, 1989) foi sugerida por Goldberg como uma maneira de manter a diversidade e impedir a convergência no algoritmo genético para uma única solução (Abraham et. al., 2005).
As abordagens de Pareto podem ser historicamente estudadas como abrangendo duas gerações. A primeira geração é caracterizada pelo uso das funções de aptidão e o processo de separação combinadas ao ranque de Pareto (como definido por Goldberg ou adotando uma ligeira variação) (Abraham et. al., 2005). Os algoritmos mais representativos desta primeira geração são os listados a seguir:
1.	Algoritmo genético com triagem de não-dominados (Non-dominated Sorting Genetic Algorithm - NSGA) (Srinivas &amp;amp; Deb, 1994);
2.	Algoritmo genético com processo da separação de Pareto (Niched-Pareto Genetic Algorithm - NPGA) (Horn et. al., 1994);
3.	Algoritmo genético multiobjetivo (Multiobjective Genetic Algorithm - MOGA) (Fonseca &amp;amp; Fleming, 1993).
A segunda geração surgiu com a introdução da noção de elitismo no contexto da otimização multiobjetivo. O elitismo normalmente (embora não necessariamente) se refere ao uso de uma população externa (também chamada de população secundária) para reter os indivíduos não-dominados. Contudo, o uso dessa população externa levanta algumas questões:
•	Como a população secundária interage com a população principal?
•	O que deve ser feito quando a população secundária estiver cheia?
•	Deve ser imposto algum critério adicional para fazer parte da população secundária invés de usar apenas a dominância de Pareto?
É perceptível que o elitismo também pode ser introduzido através da utilização de uma seleção na qual os pais competem com os filhos, e aqueles que são não-dominados (e possivelmente cumprem alguns critérios adicionais, tais como fornecer uma melhor distribuição das soluções) são selecionados para as gerações seguintes(Abraham et. al., 2005).
Os algoritmos mais representativos desta segunda geração de algoritmos evolucionários multiobjetivo, são os listados a seguir:
1.	Algoritmo evolucionário da resistência de Pareto (Strength Pareto Evolutionary Algorithm- SPEA) (Zitzler &amp;amp; Thiele, 1999);
2.	Algoritmo evolucionário da resistência de Pareto 2 (Strength Pareto Evolutionary Algorithm 2 - SPEA2) (Zitzler et. al., 2001);
3.	Estratégia evolutiva de arquivo de Pareto (Pareto Archived Evolution Strategy - PAES) (Knowles &amp;amp; Corne, 2000);
4.	Algoritmo genético com triagem de não-dominados II (Non-dominated Sorting Genetic Algorithm II - NSGA-II) (Deb et. al., 20001; Deb et. al., 20002; Deb et. al., 2002);
5.	Algoritmo genético com processo da separação de Pareto 2 (Niched-Pareto Genetic Algorithm 2 - NPGA 2) (Erickson et. al., 2001);
6.	Algoritmo de seleção baseado no empacotamento de Pareto (Pareto Envelope-basedSelection Algorithm - PESA) (Corne et. al., 2000);
7.	Micro algoritmo genético (Micro-Genetic Algorithm) (Coello &amp;amp; Pulido, 20011; Coello &amp;amp; Pulido, 20012);
8.	Otimização multiobjetivo via enxame de partículas (Multiobjective Particle Swarm Optimization - MOPSO) (Coello et. al., 2004).
A otimização evolucionária multiobjetivo é uma área bastante promissora, porém, é esperado que os algoritmos da próxima geração tenham foco apenas na melhoria da eficiência dos algoritmos já existentes.
Para possibilitar o emprego das técnicas que auxiliaram na melhoria do desempenho do GA, na otimização multiobjetivo, adotou-se um GA com elitismo controlado (uma variante do NSGA-II (Deb K. , 2001)), que está disponível na caixa de ferramentas do MATLAB.
4.4.2.3.1	Algoritmo genético com triagem de não-dominados II
O algoritmo genético com triagem de não-dominados II (Non-dominated Sorting Genetic Algorithm II - NSGA-II) (Deb et. al., 20001; Deb et. al., 20001; Deb et. al., 2002) nada mais é do que uma versão melhorada do NSGA (Srinivas &amp;amp; Deb, 1994).
O NSGA original considera a abordagem de função de partilha, que é uma forma de manter a diversidade sustentável em uma população, considerando uma configuração adequada dos parâmetros associados. O método de função de partilha envolve a definição de um parâmetro de partilha (&lt;Jshare), que determina o grau de partilha desejado no problema. Este parâmetro representa a maior distância medida que define a proximidade entre dois indivíduos da população para que os mesmo compartilhem as aptidões. O &amp;amp;share geralmente é definido pelo usuário, no entanto, existem algumas diretrizes a serem seguidas (Deb &amp;amp; Goldberg, 1989). O desempenho do método de função depende fortemente do valor de &amp;amp;share para manter uma dispersão das soluções.
No NSGA-II, a abordagem de função de partilha é substituída por uma abordagem de comparação populacional, que elimina a dependência de &amp;amp;share, até certo ponto. Essa abordagem não requer qualquer definição feita pelo usuário para manter a diversidade. Para descrever melhor essa abordagem, primeiro é apresentada a definição de uma estimativa de densidade e posteriormente é apresentado o operador de comparação populacional.
- Estimativa de densidade
Tomando como exemplo um problema de otimização com dois objetivos, para determinar uma estimativa da densidade de soluções ao redor de uma solução em particular na população, é calculada a distância média entre dois pontos de cada lado deste ponto, ao longo de cada um dos objetivos. Esta quantia (que é chamada de distância da aglomeração) serve como estimativa do perímetro do cuboide formado usando os vizinhos mais próximos como vértices (Deb et. al., 2002).
O cálculo da distância da aglomeração requer uma classificação da população de acordo com cada função objetivo envolvida no problema em ordem crescente de magnitude. Posteriormente, para cada função objetivo, as soluções extremas (com menor e maior valor da função) são marcadas com um valor muito grande para as distâncias. As demais soluções são marcadas com um valor de distância igual à diferença absoluta normalizada do valor da função objetivo das duas soluções adjacentes. A expressão que define o valor da distância é dada por:
in
¿dist
rn	rn
Ji+1 — f i-1
rn	fn
f max f min
(4.9)
onde f"+1 e f"_x são os valores da fUnção objetivo n dos indivíduos adjacentes ao indivíduo i, ordenados após a classificação, e fmnax e f”^ são, respectivamente, os valores máximos e mínimos encontrados para a fUnção objetivo n.
A distância da aglomeração global é calculada como a soma dos valores das distâncias referentes a cada objetivo. Após a atribuição das distâncias, as soluções são comparadas pelo seu grau de proximidade com outras soluções. A solução com um valor menor desta medida é mais cercado por outras soluções, em certo sentido.
- Operador de comparação populacional
O operador de comparação populacional guia o processo de seleção em vários estágios do algoritmo, com o intuito de direcionar a população para uma frente de Pareto com uma dispersão mais uniforme. Assumindo que todo indivíduo na população tem duas atribuições:
1.	Um posto de Pareto (irank);
2.	Uma distância da aglomeração (idist).
Uma ordem parcial para -&amp;lt;é definida através do esquema:
i -&lt;
(irank &amp;lt;Jrank ) ou
(irank	Jrank	e ^dist &gt; Jdist)
(4.10)
Isso significa que, entre dois indivíduos com diferentes posto de Pareto, a preferência é dada a solução com menor (melhor) posto de Pareto. Caso contrário, se ambas as soluções pertencem à mesma frente de Pareto (apresentam o mesmo posto), a preferencia é dada a solução que está localizada em uma região menos aglomerada.
Com essas modificações - um procedimento de classificação dos não-dominados mais rápido, um procedimento para a estimativa da distância de aglomeração, e um operador simples para a comparação populacional, ficou estabelecido um esquema para o algoritmo NSGA-II. O algoritmo básico para esse método segue os passos:
1.	Criação de uma população inicial de indivíduos no espaço de projeto;
2.	A aptidão dos indivíduos é definida de acordo com o posto de Pareto, e em seguida é realizada a classificação da população de acordo com o mesmo;
3.	Seleção dos genitores, baseada na aptidão dos indivíduos;
4.	Emprego dos operadores genéticos (cruzamento e/ou por mutação) para criação da nova população;
5.	Aplicação do elitismo considerando a comparação dos indivíduos da população atual com os as melhores soluções de Pareto encontradas;
6.	Verificação da convergência. Caso ocorra, o processo é interrompido, caso contrário, retorna a passo 2.
- Critério de convergência
A convergência no NSGA-II é definida a partir do momento em que novas soluções não são mais acomodadas no conjunto com as soluções não-dominadas.
Um GA elitista sempre favorece os indivíduos com melhores aptidões, e no caso do NSGA-II, com melhores posto de Pareto. No entanto, um GA com elitismo controlado favorece os indivíduos que podem ajudar a melhorar a diversidade da população, mesmo sendo menos aptos e ainda mais no contexto otimização multiobjetivo.
No algoritmo NSGA-II do MATLAB, esse controle é realizado através de duas opções, onde uma limita o número de indivíduos na frente de Pareto (que é um percentual da população inicial) e a outra ajuda a manter a diversidade, através do favoreci-mento de indivíduos que estão relativamente distantes da mesma.
Mais uma vez é enfatizado aqui, que o interesse não é a definição da melhor configuração para que o algoritmo disponível no MATLAB encontre a melhor frente de Pareto, mas sim criar uma ferramenta que não necessite de uma configuração para cada utilização. Devido a isso, as únicas alterações realizadas nos parâmetros deste algoritmo foram no número de indivíduos na população inicial, no número de indivíduos mantidos na frente de Pareto, e na quantidade de gerações consideradas.
Apesar dos métodos de otimização multiobjetivo com algoritmos evolucionários permitirem definir a frente de Pareto em uma única rodada, devido ao fato dos mesmos serem derivados de métodos evolucionários para problemas uniobjetivo, algumas das dificuldades permanecem as mesmas, por exemplo, a dificuldade em lidar com problemas restritos, e o número excessivo de avaliações de função requerido até a convergência.
Para a manipulação das restrições, as estratégias empregadas foram as mesmas consideradas com o GA (reparação de cromossomos e uso do método de penalização adaptativa - conforme descrito no capítulo anterior). Porém, para criação do modelo substituto, algumas modificações foram consideradas.
4.4.2.3.2	Aproximação global
Na aproximação global para problemas multiobjetivo, assim como a maioria das técnicas de criação de modelos substitutos, o intuito é diminuir o número de avaliações de função reais, principalmente quando o custo computacional para cada avaliação é elevado.
Da mesma forma que a aproximação global considerada para o problema uniobje-tivo, o interesse é criar um modelo que consiga definir de forma adequada o comportamento global das funções envolvidas no problema, bem como, definir um modelo que consiga representar o comportamento no domínio viável sem deixar de representar a região inviável de forma razoável, em problemas restritos.
Para criação do modelo, a geração da amostra inicial segue a mesma regra considerada na geração do modelo substituto para problemas uniobjetivo. A diferença fundamental entre os modelos criados para os problemas multiobjetivo estudados está na adaptação, que não é considerada.
A adaptação considerada na aproximação global para problemas uniobjetivo utiliza as soluções encontradas para geração de novos modelos substitutos e alguns pontos extras, para melhor definir a região viável. As soluções obtidas em problemas multi-objetivo são fornecidas através de um conjunto de pontos, o que por si só, já acarretaria num elevado número de avaliações necessárias para atualização dos modelos. Mesmo selecionando algumas soluções como representativas, a precisão na convergência não seria tão satisfatória. Devido a isso, nos modelos substitutos globais criados para os problemas multiobjetivo, não foram consideradas adaptações para melhoria dos mesmos.
Da mesma forma que os métodos de otimização uniobjetivo são combinados, com o intuito de explorar os aspectos positivos inerentes a cada algoritmo, uma opção de combinação dos métodos para criar uma estratégia híbrida e realizar a busca de soluções de Pareto é aqui sugerida.
4.4.3	Estratégia híbrida para resolução de problemas multiobjetivo
Vários estudos já foram desenvolvidos comparando o desempenho de diversas metodologias, porém, poucos são os estudos desenvolvidos para consideração da combinação de metodologias, visando criar ferramentas mais robustas.
Na tentativa de aproveitar as características positivas dos algoritmos, uma estratégia híbrida foi idealizada, de forma semelhante à apresentada no capítulo anterior, realizando o processo de busca das soluções de Pareto em duas etapas. Na primeira etapa é considerada a variante do NSGA-II, e na segunda etapa é utilizado o NBI.
Como nos problemas de otimização uniobjetivo, as funções presentes nos problemas de otimização multiobjetivo, que envolvem a simulação de reservatórios de petróleo também necessitam de um elevado número de simulações. A consideração de modelos substitutos também é uma opção adotada para superar tal problema.
Dentre as técnicas de hibridização já apresentadas, uma das mais recentes foi apresentada por Rigoni e Poles (2005), e de forma semelhante à sugerida neste trabalho, considera o uso de um método evolucionário combinado ao NBI e a consideração de modelos substitutos.
Na metodologia sugerida por Rigoni &amp;amp; Poles (2005),inicialmente é feita uma identificação da frente de Pareto com o MOGA-II (Mosetti &amp;amp; Poloni, 1993; Poloni &amp;amp; Pediroda, 1997; Poloni et. al., 2000; Spicer et. al., 1998) e posteriormente é aplicado o NBI_NLPQLP (Das &amp;amp; Dennis, 1998; Schittkowski, 2001) para convergência (Rigoni &amp;amp; Poles, 2005). Nessa hibridização, a tarefa básica do MOGA-II é identificar regiões descontinuas da frente de Pareto. Caso haja descontinuidade, o problema é subdividido de forma que cada subproblema gerado esteja relacionado a uma porção da frente descontinua.
Na combinação aqui considerada, o NSGA-II é utilizado para identificar uma possível disposição da frente de Pareto e em seguida, alguns pontos do conjunto disponib i-lizado são selecionados para serem utilizados como pontos iniciais para o NBI.
Como o emprego do NSGA-II é apenas considerado para definir tendência de formação da frente de Pareto, não é permitido ao mesmo realizar o processo de busca até a convergência. São impostas limitações através das configurações do algoritmo para que o mesmo encerre o processo de busca com poucas gerações. Com o conjunto de soluções indicadas pelo NSGA-II é realizada uma divisão em partições, de acordo com a concentração de pontos. o número de partições é definido através do número de soluções que se deseja obter com o NBI menos o número de funções objetivo.
A definição das partições é feita através de uma que minimiza a soma das distâncias de cada ponto aos centroides. o processo é iterativo e a quantidade de pontos em cada partição, bem como a posição dos centroides são atualizados à medida que o processo é realizado. Os pontos iniciais para o NBI são determinados pelos pontos mais próximos aos centroides de cada partição e pelos pontos que apresentam o melhor resultado para cada objetivo individualmente.
os pontos tomados devido ao valor dos objetivos são usados para definir os pontos chamados aqui de “falsos” utópicos. Este nome é dado porque estes pontos representam um resultado preliminar dos pontos utópicos, uma vez que não foram obtidos por convergência, mas sim de uma parada forçada. Com os falsos utópicos são definidas a CHIM e a reta quasi-normal relacionadas ao mesmo.
De posse da CHIM e da reta quasi-normal, para os pontos definidos através da proximidade dos centroides das partições são realizada operações bastante simples para encontrar o /3 e o t referentes. Os pesos (P) são calculados através da projeção de cada ponto sobre a ECMI, e o valor inicial para a nova variável (t) relacionada aos subproblemas NBI é definido através da distância entre o ponto inicial e a CHIM.
Com a definição das opções relacionadas ao emprego de modelos substitutos no processo de otimização, também foram consideradas três versões de algoritmo híbrido (semelhante ao algoritmo híbrido para problemas uniobjetivo). Na primeira versão, todo o processo é realizado no modelo HF; na segunda, parte do processo é realizado no modelo HF e parte no modelo LF; e na terceira, todo o processo é realizado no modelo LF.
os testes realizados para problemas de otimização multiobjetivo foram realizados apenas com a estratégia híbrida, e os resultados obtidos são apresentados no Capítulo 5.
Capítulo 5 - Casos estudados
Objetivando validar as ferramentas desenvolvidas para os problemas de otimização de reservatórios de petróleo, alguns casos foram estudados baseados nas formulações apresentadas no Capítulo 1 (Eqs. (1.1) e (1.5)). Os testes foram realizados em dois reservatórios que apresentam características bem distintas. Inicialmente são apresentados os estudos realizados em um reservatório simples, e em seguida são apresentados os estudos realizados em um reservatório mais complexo, que apresenta características mais semelhantes às situações reais.
5.1	Otimização do primeiro reservatório
O primeiro reservatório foi apresentado na seção 2.4. Esse reservatório possui características bastante simples e foi preparado para estudar os aspectos mais básicos do problema de otimização de alocação dinâmica das vazões dos poços de produção e injeção introduzido por Oliveira (2006). A simplicidade desse caso permite a identificação de peculiaridades no comportamento do problema e de dificuldades que não seriam tão evidentes em modelos de características complexas e/ou próximas da realidade.
O modelo desse reservatório resulta num sistema com 7.083 graus de liberdade, que é resolvido com o método implícito adaptativo disponível no simulador de reservatórios (CMG, 2005).
Na região próxima ao poço produtor P-1, a permeabilidade é igual a 500 mD, enquanto na região próxima ao poço produtor P-2 é 1.500 mD. A região próxima ao poço I-1 é igual a 1.000 mD. Os poços mencionados são poços verticais completados na única camada do modelo.
É atribuída a definição de um grupo, que representa uma unidade de produção, onde os poços produtores estão ligados. Este grupo apresenta um limite à vazão de líquido fixada em 40m3/dia, definindo dessa forma a máxima vazão diária de produção capaz de ser tratada pela unidade.
Além da restrição da unidade de produção, cada um dos poços produtores é restringido por uma vazão máxima de líquido de 30 m3/dia, sem ter nenhum controle secundário complementar. A ausência de algum controle adicional na operação dos poços produtores se apresente como uma condição em desacordo com a prática comum nos estudos de reservatórios (Oliveira, 2006). Usualmente é especificado algum controle na pressão de fundo de poço ou na pressão da cabeça do poço, o que complementa restrição de vazão máxima, no entanto, essa condição não foi definida para esse modelo com o intuito de prover o máximo de simplicidade ao mesmo (Oliveira, 2006).
Devido à limitação da unidade de produção e dos controles adotados para os poços de forma individual, é perceptível que os dois poços não podem operar nas suas máximas capacidade de forma simultânea. Por outro lado, nenhum deles é capaz de atingir a capacidade do grupo de forma individual, quando a produção máxima é exigida.
Seguindo o mesmo princípio de controle do conjunto de poços produtores, o poço injetor é controlado apenas pela vazão máxima de água injetada, definida em 44 m3/dia. Esse valor é adotado com o intuito de manter a pressão média do reservatório.
Para facilitar a analise dos resultados obtidos, os mesmos são apresentados em dois grupos definidos de acordo com o tipo do problema de otimização relacionado (uniobjetivo ou multiobjetivo).
5.1.1	Resultados obtidos nos estudos de problemas uniobjetivo para o primeiro reservatório
Na apresentação do problema do gerenciamento da alocação dinâmica das vazões, no Capítulo 1, os estudos realizado para problemas de otimização uniobjetivo têm como formulação básica a Eq. (1.1). A formulação apresentada na mesma é modificada de acordo com o tipo de operação da unidade de produção presente no reservatório (OCT ou OCNT) e de acordo com o planejamento dos ciclos de controle (em períodos pré-determinados ou definidos como variáveis do problema). A Tabela 5.1 apresenta as combinações investigadas nos problemas para o primeiro reservatório.
Tabela 5.1- Problemas uniobjetivo estudados para o primeiro reservatório.	
Problema	Descrição
1	OCT-TF: Operação em capacidade topada, tempo fixo
2	OCT-TV: Operação em capacidade topada, tempo variável
3	OCNT-TF: Operação em capacidade não-topada, tempo fixo
4	OCNT-TV: Operação em capacidade não-topada, tempo variável
Diversas metodologias de otimização são empregadas com o intuito de avaliar o comportamento dos otimizadores nos problemas propostos. As estratégias utilizadas estão descritas na Tabela 5.2.
Tabela 5.2 - Estratégias consideradas na otimização dos problemas de otimização uni-
	objetivo para o primeiro reservatório.
Estratégia	Descrição
SQP	Algoritmo de programação sequencial quadrática atuando no modelo de alta fidelidade
SAO GA GAsbo GhfLhf	Algoritmo de otimização sequencial aproximada Algoritmo genético atuando em modelo de alta fidelidade Algoritmo genético atuando em modelo substituto Algoritmo híbrido atuando em modelo de alta fidelidade
GlfLhf	Algoritmo híbrido com a busca global atuando em modelo de substituto e busca local em modelo de alta fidelidade
GlfLlf	Algoritmo híbrido com ambas buscas, global e local, atuando em modelo substituto
As soluções apresentadas em Horowitz (2013) foram encontradas pelo SAO e são os valores tomados como referência para o estudo comparativo.
Problema 1 - Operação em capacidade topada com definição prévia dos ciclos de controle para o primeiro reservatório
Neste primeiro problema, a unidade de produção instalada no reservatório opera em capacidade máxima e a duração dos ciclos de controle é definida previamente.
Com a vazão de líquido produzido fixada em 40 m3/dia, e sendo a vazão máxima de líquido, para cada poço produtor, limitada a 30 m3/dia, é exigida uma vazão mínima de 10 m3/dia para cada poço, para atender a operação em capacidade topada da unidade.
Com base nessas definições, são consideradas como variáveis o rateio de um dos poços produtores (o poço P-1), ao longo do período de concessão, alterados a cada ciclo de controle. As vazões do poço P-2 são obtidas de modo a complementar a capacidade de produção.
Sendo a unidade de produção formada por apenas um poço injetor, a vazão do mesmo é determinada como sendo o valor máximo definido na descrição das características do modelo adotado para o primeiro reservatório, 44 m3/dia, para que a operação em capacidade topada.
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2), a formulação do problema é dada por:
Maximize: VPL
nP
sujeito a: E x t = 1 , t = 1... nt p^P
nI	(5.1)
E xPt =1 , t=1...nt
p^i
Para analisar a influência da quantidade de ciclos de controle sobre o valor do resultado final da função objetivo, a otimização desse problema foi conduzida em duas situações: uma que avalia a produção ao longo do período de concessão em quatro ciclos de controle (OCT-TF 1); e outra que avalia a produção em doze ciclos (OCT-TF 2). A Figura 5.1 indica o esquema dos ciclos de controle para cada situação estudada no problema 1.
4 ciclos
12 ciclos
2006	2008	2010	2012	2014	2016	2018	2020	2022
Tempo
Figura 5.1 - Definição dos ciclos de controle para o problema 1.
Os resultados obtidos para a situação onde são considerados quatro ciclos de controle (OCT-TF 1) são apresentados na Tabela 5.3.
Tabela 5.3- Resultados obtidos no problema OCT-TF 1
	f(x) (106 U$)	Avaliações de função
SQP	1,49379	267
SAO	1,49239	51
GA	1,49286	1.000
GAsbo	1,49193	51
GhfLhf	1,49246	332
GlfLhf	1,49245	57
GlfLlf	1,49251	41
De acordo com os resultados apresentados, observa-se que há consistência nas soluções obtidas pelas diversas estratégias empregadas. A diferença entre o número de avaliações de função consideradas poderia ser um critério para definir o algoritmo com melhor desempenho.
Os valores das variáveis de projeto que fornecem as soluções indicadas, que foram obtidas pelo SAO (solução de referência), pelo GA e pelo GlfLlf, são exibidas nas Tabelas 5.4, 5.5 e 5.6. Os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.2.
Tabela5.4 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 1
Ciclo de controle	P-1	P-2	I-1
1	0,571	0,429	1,000
2	0,623	0,377	1,000
3	0,581	0,419	1,000
4	0,592	0,408	1,000
T abela 5.5 - Valores das vazões obtidas pelo GA para o caso OCT -TF 1
Ciclo de
controle	P-1	P-2	I-1
1	0,263	0,737	1,000
2	0,627	0,373	1,000
3	0,631	0,369	1,000
4	0,630	0,370	1,000
Tabela 5.6 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TF 1
Ciclo de controle	P-1	P-2	I-1
1	0,288	0,712	1,000
2	0,565	0,435	1,000
3	0,655	0,345	1,000
4	0,606	0,394	1,000
Figura 5.2- Curvas de produção acumulada com os resultados obtidos pelo GA, pelo
SAO e pelo GlFLlf para o problema OCT-TF 1
Os resultados obtidos para a situação onde são considerados doze ciclos de controle (OCT-TF 2) são apresentados na Tabela 5.7.
Tabela 5.7- Resultados obtidos no problema OCT-TF 2
	f(x) (106 U$)	Avaliações de função
SQP	1,49287	450
SAO	1,49282	131
GA	1,49314	3.000
GAsbo	1,49266	91
GhfLhf	1,49222	566
GlfLhf	1,49142	395
GlfLlf	1,49318	165
Da mesma forma que ocorre no caso anterior, de acordo com os resultados apresentados, observa-se que há consistência nas soluções obtidas pelas diversas estratégias empregadas, e um critério para definir o algoritmo com melhor desempenho seria a comparação do número de avaliações de função consideradas.
As vazões que fornecem as soluções indicadas, que foram obtidas pelo SAO (solução de referência), pelo GA e pelo GlFLlf, são exibidas nas Tabelas 5.8, 5.9 e 5.10. Os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.3.
Tabela 5.8 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 2
Ciclo de controle	1	2	3	4	5	6	7	8	9	10	11	12
P-1	0,376	0,250	0,250	0,256	0,370	0,750	0,750	0,527	0,554	0,585	0,554	0,668
P-2	0,624	0,750	0,750	0,744	0,630	0,250	0,250	0,473	0,446	0,415	0,446	0,332
I-1	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000
Tabela 5.9 - Valores das vazões obtidas pelo GA para o caso OCT-TF 2												
Ciclo de controle	1	2	3	4	5	6	7	8	9	10	11	12
P-1	0,495	0,349	0,494	0,267	0,606	0,688	0,625	0,544	0,666	0,636	0,732	0,675
P-2	0,305	0,651	0,506	0,733	0,394	0,312	0,375	0,456	0,334	0,364	0,268	0,325
I-1	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000
Tabela 5.		10 - Valores das vazões obtidas pelo G					FLLF para o caso OCT-TF 2					
Ciclo de controle	1	2	3	4	5	6	7	8	9	10	11	12
P-1	0,750	0,525	0,339	0,344	0,286	0,693	0,733	0,564	0,602	0,463	0,614	0,589
P-2	0,250	0,475	0,661	0,656	0,714	0,307	0,267	0,436	0,398	0,537	0,386	0,411
I-1	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000	1,000
Figura 5.3- Curvas de produção acumulada com os resultados obtidos pelo GA, pelo SAO e pelo GlfLlf para o problema OCT-TF 2
Problema 2 - Operação em capacidade topada com duração dos ciclos de controle considerada como variáveis do problema para o primeiro reservatório
Neste segundo problema, a unidade de produção opera em capacidade máxima, porém, a duração dos ciclos de controle não é definida de forma prévia.
Essa consideração, embora aumente o número de variáveis de projeto envolvidas no processo de otimização, adiciona uma flexibilidade ao gerenciamento da explotação do reservatório. Isso possibilita um controle mais eficiente, com menos ciclos ao longo do período de concessão.
Sendo a unidade de produção operada em capacidade máxima, as características definidas sobre as vazões dos poços são equivalentes às definidas no problema 1 (vazão mínima para cada poço produtor de 10 m3/dia e vazão do único poço injetor definida pelo valor máximo da unidade de injeção). Desta forma, são consideradas como variáveis referentes ao controle das vazões, o rateio de apenas um dos poços produtores ao longo do período de concessão, alterados a cada ciclo de controle.
As variáveis relacionadas com a duração dos ciclos de controle podem ser mais bem interpretadas visualizando a Figura 5.4.
XAt,1	XAt,2	XAt,3
2022 Tempo
2006 2012 2016
Figura 5.4 - Condições de operação para modificação dos tempos dos ciclos de controle
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando as normalizações das variáveis conforme definido nas Eqs. (1.2) e (1.4), a formulação do problema é dada por:
Maximize: VPL
nP
sujeito a: X xpt = 1 , t = 1... nt
peP
nI
X xPt =1 , t=1... nt
pel
nj-1
X XAtk - 1
k=1
x1	— x — xu
xp,t - xp,t - xp,t
(5.2)
Para analisar a influência da quantidade de ciclos de controle sobre o valor do resultado final da função objetivo, a otimização desse problema foi conduzida em duas situações: uma que avalia a produção ao longo do período de concessão em três ciclos de controle (OCT-TV 1); e outra que avalia a produção em cinco ciclos (OCT-TV 2).
os resultados obtidos para a situação onde são considerados três ciclos de controle (OCT-TV 1) são apresentados na Tabela 5.11.
Tabela 5.11- Resultados obtidos no problema OCT-TV 1
	f(x) (106 U$)	Avaliações de função
SQP	1,49274	1.043
SAO	1,49285	109
GA	1,49331	2.430
GASBO	1,49298	55
GHFLHF	1,49274	1.143
GLFLHF	1,49277	297
GlfLlf	1,49277	104
Neste caso, também são apresentados resultados que demonstram consistência nas soluções obtidas pelas diversas estratégias empregadas, e mais uma vez o número de avaliações de função poderia ser o critério para definir o algoritmo com melhor desempenho.
As vazões que fornecem as soluções indicadas, que foram obtidas pelo SAO (solução de referência), pelo GA e pelo GlfLlf, são exibidas nas Tabelas 5.12, 5.13 e 5.14. os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.5.
Tabela 5.12 - Valores das vazões obtidas pelo SAO para o caso OCT-TV 1
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,446	0,554	1,000	0,301
2	0,684	0,316	1,000	0,176
3	0,563	0,437	1,000	0,523
Tabela 5.13 - Valores das vazões obtidas pelo GA para o caso OCT-TV 1
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,448	0,552	1,000	0,265
2	0,661	0,339	1,000	0,595
3	0,338	0,762	1,000	0,140
Tabela 5.14 - Valores das vazões obtidas pelo GLfLlf para o caso OCT-TV 1
Ciclo de controle
P-1
P-2
I-1	Duração
1	0,447	0,553	1,000	0,307
Figura 5.5- Curvas de produção acumulada com os resultados obtidos pelo GA, pelo SAO e pelo GlfLlf para o problema OCT-TV 1.
Os resultados obtidos para a situação onde são considerados cinco ciclos de controle (OCT-TV 2) são apresentados na Tabela 5.15.
Tabela 5.15- Resultados obtidos no problema OCT-TV 2
	f(x) (106 U$)	Avaliações de. função
SQP	1,49323	209
SAO	1,49329	61
GA	1,49356	2.430
GAsbo	1,49093	76
GhfLhf	1,49280	888
GlfLhf	1,49248	565
GlfLlf	1,49244	176
Da mesma forma que ocorre no caso anterior, os resultados apresentados também demonstram que há consistência nas soluções obtidas pelas diversas estratégias empre-
gadas, e um critério para definir o algoritmo com melhor desempenho seria o número de avaliações de função consideradas.
As vazões que fornecem as soluções indicadas, que foram obtidas pelo SAO (solução de referência), pelo GA e pelo GlfLlf, são exibidas nas Tabelas 5.16, 5.17 e 5.18. Os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.6.
Tabela 5.16 - Valores das vazões obtidas pelo SAO para o caso OCT-TV 2
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,318	0,682	1,000	0,271
2	0,355	0,645	1,000	0,031
3	0,708	0,292	1,000	0,164
4	0,490	0,510	1,000	0,078
5	0,637	0,363	1,000	0,456
Tabela 5.17 - Valores das vazões obtidas pelo GA para o caso OCT-TV 2
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,388	0,612	1,000	0,136
2	0,563	0,427	1,000	0,222
3	0,588	0,467	1,000	0,380
4	0,533	0,467	1,000	0,102
5	0,638	0,362	1,000	0,160
Tabela 5.18 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TV 2
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,264	0,736	1,000	0,205
2	0,463	0,537	1,000	0,072
3	0,651	0,349	1,000	0,417
4	0,720	0,280	1,000	0,152
5	0,424	0,576	1,000	0,154
Figura 5.6- Curvas de produção acumulada com os resultados obtidos pelo GA, pelo SAO e pelo GlFLlf para o problema OCT-TV 2.
Fazendo uma comparação com os resultados obtidos no problema 1, observa-se que a flexibilização do gerenciamento, devido a consideração da duração dos ciclos de controle como variáveis do problema, proporciona resultados equivalentes com menos ciclos de controle.
Com o número de variáveis elevado, não é possível apresentar um gráfico com o comportamento da função objetivo desse problema, porém, pode ser afirmado que a flexibilização do gerenciamento faz com que o comportamento da função passe a ser multimodal. Essa afirmação é baseada nos resultados obtidos pelo SAO na tentativa de solucionar o problema. Em algumas das tentativas realizadas pelo SAO as soluções apresentadas eram diferentes da apresentada na referência, o que indicava a existência de vários pontos de ótimo local na região viável do problema.
Problema 3 - Operação em capacidade não-topada com definição prévia dos ciclos de controle para o primeiro reservatório
No terceiro problema estudado para o primeiro reservatório, a unidade de produção não precisa operar necessariamente em capacidade máxima e a duração dos ciclos de controle é definida previamente.
A vazão de líquido da unidade de produção não é mais fixada nos 40 m3/dia como definida nos problemas anteriores. Sendo assim, não é mais necessária a exigência de uma vazão mínima para cada poço produtor, ou seja, pode ocorrer a situação onde um dos poços, ou ambos, não produza líquido.
Como a unidade de produção é formada por apenas um poço injetor, e a operação em capacidade máxima não é mais exigida, a manutenção da pressão média do reservatório, que era atendida automaticamente nas situações anteriores, passa a ser uma restrição imposta na formulação do problema de otimização.
Com base nessas definições, são consideradas como variáveis os rateios de todos os poços, produtores e injetores, ao longo do período de concessão, alterados a cada ciclo de controle.
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2), a formulação do problema é dada por:
Maximize: VPL
nP
sujeito a: E xp,t &amp;lt;i , t=i... nt
p^P
nI
E xp,t&amp;lt;1 , t=1...nt
PQP
(5.3)
nP
E xpt t
p&amp;amp;P
nI	nP
.	xp ,t	. 1
&lt;	xp,t
p&amp;amp;I &amp;amp;	&amp;amp; p&lt;=P
t =1...nt
l
p, t
u
p,t
x
&amp;lt;x
1
Nesse problema foi investigada apenas uma situação que avalia a produção ao longo do período de concessão em três ciclos de controle. A Figura 5.7 apresenta a distribuição considerada para esse problema.
3 ciclos
2006	2008	2010	2012	2014	2016	2018	2020	2022
Tempo
Figura 5.7 - Definição dos ciclos de controle para o problema 3.
Os resultados obtidos para as duas situações são apresentados na Tabela 5.19.
Tabela 5.19 - Resultados obtidos no problema OCNT-TF
	f(x) (106 U$)	Avaliações de função
SQP	1,47102	2.514
SAO	1,72299	421
GA	1,67458	1.620
GASBO	1,57392	75
GhfLhf	1,13560	2.056
GlfLhf	1,67376	386
GlfLlf	1,72267	441
Com os resultados obtidos, observa-se que as soluções encontradas pelos algoritmos não foram consistentes como nos problemas anteriores. Observa-se também que os algoritmos que atuaram no modelo de alta fidelidade não apresentaram um bom desempenho, com exceção do GA, que encontrou uma solução melhor do que o GASBo.
As vazões que fornecem as soluções indicadas, que foram obtidas pelo SAO (solução de referência), pelo GA e pelo GlFLlf, são exibidas nas Tabelas 5.20, 5.21 e 5.22.
Os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.8.
Tabela 5.20 - Valores das vazões obtidas pelo SAO para o caso OCNT-TF
Ciclo de controle	P-1	P-2	I-1
1	0,451	0,549	0,923
2	0,306	0,076	0,347
3	0,001	0,001	0,002
Tabela5.21 - Valores das vazões obtidas pelo GA para o caso OCNT-TF
Ciclo de controle	P-1	P-2	I-1
1	0,336	0,280	0,668
2	0,416	0,014	0,469
3	0,499	0,093	0,641
Tabela 5.22 - Valores das vazões obtidas pelo GLfLLf para o caso OCNT-TF
Ciclo de controle
P-1
P-2
I-1
1	0,567	0,433	0,921
Figura 5.8 - Curvas de produção acumulada com os resultados obtidos pelo GA, pelo SAO e pelo GlFLlf para o problema OCNT-TF.
Tomando o resultado do GA para uma primeira análise, de acordo com a Figura 5.8 e com os resultados apresentados na Tabela 5.19, percebe-se que manter o reservatório até o final do período de concessão da exploração não representa o maior retorno financeiro, porém, é importante ressaltar que este trabalho não considera uma avaliação rigorosa das variações do mercado, e na prática, o fechamento de um reservatório não
ocorre justamente devido a tais variações. Em um estudo apresentado por Horowitz et.al. (2010), os resultados indicaram que os fatores econômicos podem fazer com que o fechamento dos poços não seja necessário.
Problema 4 - Operação em capacidade não-topada com duração dos ciclos de controle considerada como variáveis do problemas para o primeiro reservatório
No quarto problema, a unidade de produção não precisa operar necessariamente em capacidade máxima e a duração dos ciclos de controle não é definida de forma prévia. A ideia dos estudos realizados neste problema é permitir uma maior flexibilidade para o gerenciamento da produção do reservatório.
Da mesma forma que no problema anterior, a vazão de líquido da unidade de produção não é mais fixada nos 40 m3/dia, o que torna a exigência de uma vazão mínima para cada poço produtor dispensável. Outra consideração tem relação com o poço inje-tor, onde a manutenção da pressão média do reservatório, que era atendida automaticamente, passa a ser uma restrição imposta ao problema.
As variáveis relacionadas com a duração dos ciclos de controle podem ser mais bem interpretadas visualizando a Figura 5.4, que foi apresentada no problema 2.
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido nas Eqs. (1.2) e (1.4), a formulação do problema é dada por:
Maximize: VPL
sujeito a: Zxpt S1 , t = 1...nt
p&amp;amp;P
Z xp,tS1 , t=1-‘nt
p^I
Zxpt SZ—S-Zx,,,
pGP	pQl a a pGp
t =1...nt
(5.4)
nt-1
Z xv,k S 1
k=1
x
l
p,t
S x
u
p,t
Nesse problema foi investigada apenas uma situação que avalia a produção ao longo do período de concessão em três ciclos de controle. Os resultados obtidos para as duas situações são apresentados na Tabela 5.23.
Tabela 5.23 - Resultados obtidos no problema OCNT-TV
	f(x) (106 U$)	Avaliações de função
SQP	1,50077	908
SAO	1,73314	673
GA	1,55018	4.749
GAsbo	1,66952	110
GhfLhf	1,61698	1.710
GlfLhf	1,61551	852
GlfLlf	1,72921	291
Com os resultados indicados, pode ser observado que as melhores soluções foram as soluções obtidas pelo SAO e pelo GlfLlf. Nota-se também que a solução obtida pelo GLfLLf representa a combinação que apresenta um menor número de avaliações de função.
Devido ao fato da solução indicada pelo GA ter sido bem aquém das melhores soluções encontradas são exibidas apenas as vazões que fornecem as soluções que foram obtidas pelo SAO (solução de referência) e pelo GLfLLf, nas Tabelas 5.24 e 5.25. Os históricos da produção do reservatório, com as mesmas soluções, são exibidos na Figura 5.9.
Tabela 5.24 - Valores das vazões obtidas pelo SAO para o caso OCNT-TV
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,394	0,606	0,927	0,280
2	0,621	0,379	0,909	0,170
3	0,043	0,001	0,040	0,550
Tabela 5.25 - Valores das vazões obtidas pelo GLfLLf para o caso OCNT-TV
Ciclo de controle	P-1	P-2	I-1	Duração
1	0,540	0,460	0,926	0,432
2	0,092	0,076	0,152	0,546
3	0,082	0,616	0,665	0,022
Figura 5.9- Curvas de produção acumulada com os resultados obtidos pelo SAO e pelo GlfLlf para o problema OCNT-TV.
Pelo histórico da produção apresentado na Figura 5.9, percebe-se mais uma vez que manter o reservatório até o final do período de concessão da exploração não representa a melhor opção para obter o maior retorno financeiro.
5.1.2	Resultados obtidos nos estudos de problemas multiobjetivo para o primeiro reservatório
Na apresentação do problema de gerenciamento da alocação dinâmica das vazões, no Capítulo 1, os estudos realizados para problemas de otimização de múltiplos objetivos simultaneamente têm como formulação básica a Eq. (1.5). Devido aos tipos de objetivos considerados, não há sentido em fazer a análise adotando a capacidade de operação topada da unidade de produção do reservatório, porém, como descrito no Problema 3, é necessário que seja garantida a manutenção da pressão média do reservatório, que passa a ser uma restrição imposta na formulação do problema de otimização.
Com relação ao planejamento dos ciclos de controle, para os testes apresentados nesse trabalho, é considerado apenas o estudo da explotação em um único ciclo ao longo do período de concessão.
Com base nessas definições, as variáveis consideradas são os rateios de todos os poços, produtores e injetores. Tendo definidos nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2), a formulação do problema é dada por:
Maximize: Óleo	e	
Minimize:	Água n nP
sujeitos a:	í xp,t&amp;lt;1 , t = 1„-nt peP nI í xpt&amp;lt;1 , t =1...nt
pel
nP
í x t
peP
nI
&lt;í
peI
(5.5)
x
l
p,t
u
p,t
nP
•í
peP
p, t
t = 1...nt
x	1
a	a
&amp;lt;x
x
Das metodologias de otimização são empregadas apenas as estratégias híbridas, para avaliar o desempenho das mesmas no problema proposto. As estratégias utilizadas estão descritas na Tabela 5.26.
Tabela 5.26 - Estratégias consideradas na otimização dos problemas de otimização mul-
tiobjetivo para o primeiro reservatório.	
Estratégia	Descrição
MO GhfLhf	Algoritmo híbrido (NSGA-II com NBI) atuando no modelo de alta
	fidelidade
	Algoritmo híbrido com o algoritmo de busca global atuando no mo-
MO_GlfLhf	delo substituto e o algoritmo de busca local atuando no modelo de
	alta fidelidade
MO Gt.Lt.	Algoritmo híbrido com ambas buscas, global e local, atuando no
-MO	gLFLLF	modelo substituto
Como descrito no Capítulo 4 -, soluções obtidas em problemas com múltiplos objetivos são representadas através de um conjunto de pontos. Em problemas com duas funções sendo otimizadas simultaneamente, é comum a representação desse conjunto de forma gráfica, através da frente de Pareto. A quantidade de pontos presentes na frente de Pareto fornecida pelas estratégias híbridas é definida de forma prévia. Nos testes realizados, as soluções apresentam 22 pontos selecionados.
Como a quantidade de pontos obtidos é idêntica para cada uma das estratégias indicadas na Tabela 5.26, o desempenho pode ser avaliado de acordo com a “forma” da frente de Pareto apresentada e/ou de acordo com a quantidade de avaliações de função necessárias para obtenção da mesma.
Os gráficos com as soluções obtidas são apresentados nas Figuras 5.10, 5.11 e 5.12, onde cada quadro indica o resultado obtido em cada fase do processo de busca, e os pontos que representam os resultados indicados finais estão exibidos nas Tabelas 5.27, 5.28 e 5.29.
1.4
1.4
1.2
•	Solução do NSGA-II
*	Pontos selecionados
1.2
•	Pontos iniciais
*	Soluções do NBI
Óleo Acumulado
0.8
0.6
0.5
1	1.5	2	2.5	3
Água acumulada
0.8
0.6
0.4
0^--------1----------1---------1---------1---------1
0	0.5	1	1.5	2	2.5
Água acumulada
1
1
*
0

0
*
* *
*
♦
0.2 - &gt;
3
(a)	(b)
Figura 5.10 - Soluções obtidas pela estratégia híbrida, MO_GhfLhf, nas fases (a) global e (b) local.
Tabela 5.27 - Resultados obtidos pelo MO_GhfLhf para o problema multiobjetivo do
primeiro reservatório.
Ponto de Pareto	P-1	P-2	I-1	Oleoprod (105 m3)	Águainj (105 m3)
1	0,442	0,558	1,000	1,108	2,558
2	0,347	0,307	0,641	1,076	1,640
3	0,425	0,413	0,835	1,096	2,134
4	0,332	0,458	0,784	1,091	2,004
5	0,302	0,414	0,692	1,081	1,769
6	0,451	0,202	0,633	1,074	1,618
7	0,282	0,257	0,490	1,052	1,254
8	0,297	0,195	0,450	1,039	1,151
9	0,270	0,168	0,398	1,004	1,018
10	0,239	0,160	0,362	0,927	0,927
11	0,220	0,166	0,351	0,897	0,897
12	0,212	0,135	0,315	0,806	0,806
13	0,223	0,109	0,302	0,771	0,771
14	0,221	0,098	0,291	0,744	0,744
15	0,207	0,100	0,279	0,715	0,715
16	0,098	0,172	0,245	0,626	0,626
17	0,162	0,081	0,221	0,564	0,564
18	0,091	0,097	0,171	0,437	0,437
19	0,083	0,049	0,120	0,306	0,306
20	0,070	0,017	0,079	0,201	0,201
21	0,048	0,005	0,048	0,123	0,123
22	0,001	0,001	0,002	0,005	0,005
1.3
Óleo acumulado
1.2
1.1
1
0.9
0.7
0.6
0.5
0.4
• Soluções do NSGA-II (LF)	
* Pontos selecionados (HF)		••
	• •• • • *. *■
	
	■
%	
¿■r’	
■ /	■
	■
-&amp;lt;	
	
.	i	
*	
- ♦	■
0
0.5
2
1	1.5
Água acumulada
0.8
0.6
0.4
0.2
1.4
1.2
• Pontos iniciais Soluções do NBI
2.5
l
0	0.5	1
1.5	2	2.5
Água acumulada
1
3
(a)	(b)
Figura 5.11- Soluções obtidas pela estratégia híbrida, MO_GlfLhf, nas fases (a) global e (b) local.
Tabela 5.28 - Resultados obtidos pelo MO_GlfLhf para o problema multiobjetivo do
primeiro reservatório.
Ponto de Pareto	P-1	P-2	I-1	Oleoprod (105 m3)	Águainj (105 m3)
1	0,328	0,672	1,000	1,105	2,558
2	0,585	0,285	0,869	1,097	2,224
3	0,468	0,359	0,820	1,095	2,098
4	0,321	0,352	0,660	1,078	1,688
5	0,417	0,210	0,615	1,071	1,572
6	0,478	0,137	0,591	1,064	1,510
7	0,260	0,280	0,519	1,055	1,329
8	0,264	0,247	0,473	1,046	1,209
9	0,393	0,151	0,500	1,050	1,280
10	0,282	0,203	0,441	1,036	1,129
11	0,231	0,174	0,367	0,940	0,940
12	0,257	0,130	0,351	0,899	0,899
13	0,312	0,066	0,344	0,878	0,878
14	0,112	0,230	0,312	0,797	0,797
15	0,108	0,224	0,303	0,773	0,773
16	0,065	0,222	0,261	0,668	0,668
17	0,083	0,181	0,240	0,614	0,614
18	0,117	0,130	0,225	0,573	0,573
19	0,076	0,145	0,201	0,514	0,514
20	0,056	0,154	0,191	0,488	0,488
21	0,050	0,130	0,164	0,419	0,419
22	0,001	0,001	0,002	0,005	0,005
1.4
Óleo acumulado
1.2
1
0.6
0.4
0.2
				• Pontos iniciais
	•••	1.2		* Soluções do NBI ■
z ••				■£. ■ *•
• * • ••		1	- *	-
.* *		Óleo acumulado o	o CO	CO		
. / * • / *■ f **			■fc _ *	-
. • * • 4?		0.4	* ~ *	-
			*■	
- •	• Soluções do NSGA-II (LF)	0.2		■
	*• Pontos selecionados (HF)		♦	
	r	r	r	0		r	r
0
0.5
2.5
0.5
2.5
3
1	1.5	2
Água acumulada
1	1.5	2
Água acumulada
0
0
3
(a)	(b)
Figura 5.12- Soluções obtidas pela estratégia híbrida, MO_GlfLlf, nas fases (a) global e (b) local.
Tabela 5.29 - Resultados obtidos pelo MO_GlfLlf para o problema multiobjetivo do
primeiro reservatório.
Ponto de Pareto	P-1	P-2	I-1	Oleoprod (105 m3)	Águainj (105 m3)
1	0,331	0,653	0,984	1,105	2,558
2	0,216	0,678	0,892	1,092	2,312
3	0,280	0,305	0,541	1,062	1,395
4	0,285	0,224	0,467	1,047	1,203
5	0,230	0,231	0,419	1,012	1,082
6	0,272	0,083	0,341	0,940	0,940
7	0,205	0,146	0,319	0,838	0,838
8	0,147	0,178	0,296	0,771	0,771
9	0,151	0,158	0,281	0,719	0,719
10	0,108	0,189	0,270	0,696	0,696
11	0,146	0,122	0,244	0,627	0,627
12	0,236	0,001	0,215	0,570	0,570
13	0,066	0,149	0,195	0,534	0,534
14	0,202	0,001	0,185	0,481	0,481
15	0,087	0,082	0,154	0,429	0,429
16	0,150	0,019	0,154	0,390	0,390
17	0,033	0,105	0,125	0,324	0,324
18	0,001	0,092	0,085	0,223	0,223
19	0,001	0,078	0,072	0,187	0,187
20	0,001	0,066	0,061	0,159	0,159
21	0,001	0,030	0,028	0,073	0,073
22	0,001	0,001	0,002	0,005	0,005
A Tabela 5.30 apresenta as quantidades de avaliações consideradas para cada estratégia.
Tabela 5.30 - Número de avaliações necessárias para obtenção da frente de Pareto
Avaliações de função	
MO GhfLhf	12.179
MO GlfLhf	2.959
MO GLFLLF	836
Com os resultados apresentados, percebe-se que os conjuntos de soluções encontradas pelas estratégias apresentam frentes de Pareto semelhantes, porém, o diferencial importante está no número de avaliações de função consideradas para encontrar as mesmas. A estratégia híbrida, MO_GlfLlf, necessitou de menos de 7% do total das avaliações utilizadas pela estratégia que atuou no modelo de alta fidelidade, o que indica um ganho de eficiência bastante considerável.
Com o conjunto de soluções de Pareto, não se tem definida qual a melhor solução a ser considerada, porém, Cramer et. al. (2012) apresentou uma consideração que pode ser adotada em problemas práticos para facilitar essa decisão. Nessa consideração, é definido que a região na frente de Pareto que apresenta uma inflexão, possivelmente está localizada a “melhor” solução de Pareto. Nota-se que a partir desta, acréscimos no volume de água acumulada injetada não acarretam variações no volume de óleo produzido.
Tomando a frente de Pareto obtida pelo MO_GlfLlf para representar a situação indicada, a Figura 5.13 apresenta a região onde a solução de Pareto está localizada, para o problema multiobjetivo considerado no primeiro reservatório.
1.4
1.2 -
O

0.8 -
0.6 -
0.4 -
*-
&gt; a-
04=-------
0
0.2 -
*-
*■
*■
*-
*•
*-
Região da melhor solução de Pareto
0.5
1	1.5	2
Água acumulada
2.5
1 -
3
Figura 5.13 - Representação da localização da melhor solução de Pareto
5.2	Otimização do segundo reservatório
O segundo reservatório estudado é composto por um modelo geológico bem mais complexo, construído a partir de técnicas de geoestatística e dados de afloramento, sen
do próximo de um modelo de reservatório real, apesar de se tratar de um caso sintético, onde os primeiros estudos considerando foram apresentados em Oliveira, (2006).
O modelo gerado reproduz um sistema deposicional turbidítico, típico de formações em águas profundas, representando o mais importante tipo de reservatório encontrado nas bacias sedimentares da costa brasileira. Os parâmetros petrofísicos foram obtidos por correlação, conforme pode ser visto em Silva et. al. (2005).
Para esse reservatório, um modelo refinado com 217 x 275 x 6 células foi gerado a partir dos dados originais onde foram locados 12 poços que compõem o plano de desenvolvimento proposto para esse caso. Trata-se de sete poços produtores e cinco poços injetores, posicionados segundo as características permo-porosas e de continuidade do reservatório.
Baseado nesse modelo, um segundo modelo foi criado, a partir dos dados de poços e da aplicação de uma sísmica sintética ao modelo fino, de modo a reproduzir as condições usuais de modelagem em casos reais, preservando a locação dos poços definidas no modelo inicial. Embora o novo modelo incorpore um alto grau de incerteza, o tratamento dado não faz consideração das mesmas nos estudos aqui realizados. O novo modelo possui uma malha de 43 x 55 x 6 células. Na Figura 5.14 é apresentado um esboço com o modelo citado.
Figura 5.14 - Modelo para o segundo reservatório, com locação dos poços.
Na Figura 5.15 podem ser vistas com mais detalhes as características de permeabilidade da rocha reservatório, onde cada quadro representa o mapa de permeabilidade de uma das camadas do mesmo.
(d)	(e)	(f)
Figura 5.15- Mapa de permeabilidade das camadas do segundo reservatório: (a) camada 1; (b) camada 2; (c) camada 3; (d) camada 4; (e) camada 5; (f) camada 6
A Tabela 5.31 apresenta as principais características resumidas do reservatório.
Tabela 5.31-Resumo das características do modelo do reservatório
Malha da simulação
Porosidade
Permeabilidade horizontal (kh)
Permeabilidade vertical (kv)
Compressibilidade da rocha a 1.019 kgf/cm2 Contato entre fluidos
Pressão de saturação (Psat)
Viscosidade a Tres, Psat
Razão gás-óleo de formação (RGOF)
43 (4.300 m) x 55 (5.500 m) x 6 (var)
Variando entre 16% e 28%
Figura 5.15
30% de kh
2 x 10-7 (kgf/cm2)-1
Sem contatos WOC e GOC
101,97 kgf/cm2
0,77 cp
78,1 m3/m3 std
Esse modelo resulta num sistema com 42.570 graus de liberdade, e, igualmente ao modelo do primeiro reservatório, foi resolvido com o método implícito adaptativo disponível no simulador de reservatórios (CMG, 2005).
Os sete poços produtores desse reservatório possuem a operação restringida pela vazão total de líquido, que é limitada a 900 m3/dia. Diante dos problemas observados nos estudos do primeiro reservatório, não foram usados controles de operação adicional. Analogamente, os cinco poços injetores são controlados pela máxima vazão de água injetada, que é definida em 1.500 m3/dia.
Os 12 poços estão ligados a um grupo, representante da unidade de produção, que possui dois limites diários. A máxima vazão de líquido produzido está definida em 5.000 m3/dia e a máxima vazão de injeção está especificada em 5.750 m3/dia. Esses limites fazem com que os poços não possam operar na sua máxima capacidade individual simultaneamente, possibilitando que a solução do problema de otimização defina qual a melhor forma de distribuir essas vazões atendendo à capacidade da unidade de produção.
Para facilitar a analise dos resultados obtidos, os mesmos são apresentados em dois grupos definidos de acordo com o tipo do problema de otimização relacionado (uniobjetivo ou multiobjetivo).
5.2.1	Resultados obtidos nos estudos de problemas uniobjetivo para o segundo reservatório
Da mesma forma que os problemas uniobjetivos considerados para o primeiro reservatório, os estudos realizados para o segundo reservatório têm como formulação básica a Eq. (1.1). A formulação apresentada na mesma é modificada de acordo com o tipo de operação da unidade de produção presente no reservatório (OCT ou OCNT) e de acordo com o planejamento dos ciclos de controle (em períodos pré-determinados ou definidos como variáveis do problema). A Tabela 5.32 apresenta as combinações investigadas nos problemas para o segundo reservatório.
Tabela 5.32- Problemas uniobjetivo estudados para o segundo reservatório.
Problema Descrição_________________________________________________________
1	OCT-TF: Operação em capacidade topada, tempo fixo
2	OCNT-TV: Operação em capacidade não-topada, tempo variável
São consideradas apenas duas combinações, pois o interesse é verificar a aplicabilidade das ferramentas propostas em problemas que se aproximação da situação real, porém, considerando apenas as situações mais básicas e o caso mais flexível de gerenciamento.
Dentre as metodologias de otimização apesentadas, nos problemas para este reservatório não são empregadas todas as estratégias consideradas nos problemas para o primeiro reservatório. As estratégias utilizadas estão descritas na Tabela 5.33.
Tabela 5.33 - Estratégias consideradas na otimização dos problemas de otimização uni-objetivo para o segundo reservatório.
Estratégia	Descrição
SAO	Algoritmo de otimização sequencial aproximada
GlfLlf	Algoritmo híbrido atuando em modelo substituto
As soluções apresentadas em Horowitz (2013) foram encontradas pelo SAO e são os valores tomados como referência para o estudo comparativo.
Problema 1 - Operação em capacidade topada com definição prévia dos ciclos de controle para o segundo reservatório
Neste primeiro problema, a unidade de produção instalada no reservatório opera em capacidade máxima e a duração dos ciclos de controle é definida previamente.
Apesar da vazão total de líquido produzido ser fixada em 5.000 m3/dia, e sendo a vazão máxima de líquido, para cada poço produtor, limitada a 900 m3/dia, não é exigida uma vazão mínima, pois a vazão produção total diária pode ser atendida sem a contribuição de todos os poços produtores.
Com base nas definições, são consideradas como variáveis o rateio de seis dos poços produtores (os poços P-3, P-4, P-5, P-6, P-8 e P-10), ao longo do período de concessão, alterados a cada ciclo de controle. As vazões do poço P-12 são obtidas de modo a complementar a capacidade de produção.
É claro que para se evitar a definição de valores negativos para as vazões do poço P-12 são impostas restrições na formulação matemática que garantem a positividade das mesmas.
Os cinco poços injetores que compõem a unidade de produção possuem as vazões definidas de forma semelhante à determinada para os poços produtores, são consideradas como variáveis o rateio de quatro dos poços injetores (os poços I-1, I-2, I-7 e I-9), ao longo do período de concessão, alterados a cada ciclo de controle, e as vazões do poço I-11 são obtidas de modo a complementar a capacidade de injeção. Também são impostas restrições na formulação matemática que garantem a positividade das vazões do poço I-11.
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2), a formulação do problema é dada pela Eq. (5.1).
Para analisar a influência da quantidade de ciclos de controle sobre o valor do resultado final da função objetivo, a otimização desse problema foi conduzida em duas situações: uma que avalia a produção ao longo do período de concessão em um único ciclo de controle (OCT-TF 1); e outra que avalia a produção em seis ciclos (OCT-TF 2). A Figura 5.16 indica o esquema dos ciclos de controle para cada situação estudada no problema 1.
Os resultados obtidos para a situação onde são considerados quatro ciclos de controle (OCT-TF 1) são apresentados na Tabela 5.34.
Tabela 5.34- Resultados obtidos no problema OCT-TF 1
	f(x) (106 U$)	Avaliações de função
SAO	313,34900	485
GlfLlf	313,30180	382
De acordo com os resultados apresentados, observa-se que há consistência nas soluções obtidas pelas estratégias empregadas. A diferença entre o número de avaliações de função consideradas poderia ser um critério para definir o algoritmo com melhor desempenho.
Os valores das variáveis de projeto que fornecem as soluções indicadas são exibidos nas Tabelas 5.35 e 5.36, e os históricos da produção do reservatório são exibidos na Figura 5.17.
Tabela 5.35 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 1
Ciclo de controle	1
P-3	0,001
P-4	0,099
P-5	0,180
P-6	0,180
P-8	0,180
P-10	0,180
P-11	0,180
I-1	0,255
I-2	0,107
I-7	0,129
I-9	0,255
I-11	0,255
pe
Tabela 5.36 - Valores das vazões obtidas
o GlFLlf para
o caso OCT-TF 1
Ciclo de controle
1
P-3
P-4
P-5
P-6
P-8 P-10 P-11
I-1
I-2
I-7
I-9
I-11
0,001
0,099
0,180
0,180
0,180
0,180
0,180
0,255
0,107
0,128
0,255
0,255
Figura 5.17- Curvas de produção acumulada com os resultados obtidos pelo SAO e pelo GlFLlf para o problema OCT-TF 1.
Os resultados obtidos para a situação onde são considerados seis ciclos de controle (OCT-TF 2) são apresentados na Tabela 5.37.
Tabela 5.37- Resultados obtidos no problema OCT-TF 2
	f(x) (106 U$)	Avaliações de. função
SAO	319,32300	2.892
Glfllf	317,70220	2.210
De acordo com os resultados, o GLFLLF apresentou um erro pequeno em relação ao valor da referência (erro &amp;lt;0,6%), porém, o número de avaliações de função foi menor. Os valores das variáveis de projeto que fornecem as soluções indicadas são exibidos nas Tabelas 5.38 e 5.39, e os históricos da produção do reservatório são exibidos na Figura 5.18.
Tabela 5.38 - Valores das vazões obtidas pelo SAO para o caso OCT-TF 2
Ciclo de controle 1	2	3	4	5	6
P-3	0,103	0,001	0,001	0,001	0,001	0,001
P-4	0,001	0,099	0,099	0,099	0,099	0,099
P-5	0,180	0,180	0,180	0,180	0,180	0,180
P-6	0,180	0,180	0,180	0,180	0,180	0,180
P-8	0,180	0,180	0,180	0,180	0,180	0,180
P-10	0,180	0,180	0,180	0,180	0,180	0,180
P-11	0,176	0,180	0,180	0,180	0,180	0,180
I-1	0,255	0,255	0,255	0,255	0,255	0,255
I-2	0,001	0,223	0,001	0,234	0,234	0,234
I-7	0,234	0,012	0,234	0,001	0,001	0,001
I-9	0,255	0,255	0,255	0,255	0,255	0,255
I-11	0,255	0,255	0,255	0,255	0,255	0,255
Tabela 5.39 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TF 2
Ciclo de controle	1	2	3	4	5	6
P-3	0,099	0,001	0,001	0,001	0,001	0,001
P-4	0,001	0,099	0,099	0,099	0,099	0,099
P-5	0,180	0,180	0,180	0,180	0,180	0,180
P-6	0,180	0,180	0,180	0,180	0,180	0,180
P-8	0,180	0,180	0,180	0,180	0,180	0,180
P-10	0,180	0,180	0,180	0,180	0,180	0,180
P-11	0,180	0,180	0,180	0,180	0,180	0,180
I-1	0,255	0,255	0,255	0,255	0,255	0,255
I-2	0,001	0,116	0,198	0,234	0,125	0,255
I-7	0,234	0,119	0,037	0,001	0,110	0,120
I-9	0,255	0,255	0,255	0,255	0,255	0,255
I-11	0,255	0,255	0,255	0,255	0,255	0,115
Figura 5.18- Curvas de produção acumulada com os resultados obtidos pelo SAO e pelo GLfLLf para o problema OCT-TF 2.
Problema 2 - Operação em capacidade não-topada com duração dos ciclos de controle considerada como variáveis do problemas para o segundo reservatório
No segundo problema, a unidade de produção não precisa operar necessariamente em capacidade máxima e a duração dos ciclos de controle não é definida de forma prévia. A ideia dos estudos realizados neste problema é permitir uma maior flexibilidade para o gerenciamento da produção em um modelo de reservatório com condições mais próximas da realidade.
Não sendo mais exigidas as vazões máximas diárias de líquidos na unidade de produção, a manutenção da pressão média do reservatório, que era atendida automaticamente na situação anterior, passa a ser uma restrição imposta na formulação do problema. Com base nas definições, são consideras como variáveis o rateio de todos os poços ao longo do período de concessão, alterados a cada ciclo de controle.
A consideração da duração dos ciclos de controle como variáveis de projeto adicionais permite uma maior flexibilidade ao gerenciamento, possibilitando um controle mais eficiente, com menos ciclos de controle ao longo do período de concessão. As variáveis relacionadas com a duração dos ciclos de controle podem ser mais bem interpretadas visualizando a Figura 5.4.
Definindo nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2) e (1.4), a formulação do problema é dada pela Eq. (5.4).
Nesse problema foi investigada apenas uma situação que avalia a produção ao longo do período de concessão em três ciclos de controle. Os resultados obtidos para as duas situações são apresentados na Tabela 5.40.
Tabela 5.40- Resulados obtidos no problema OCNT-TV
	f(x) (106 U$)	Avaliações de função
SAO	360,89300	1079
GlfLlf	364,04000	1155
De acordo com os resultados, o GLFLLF apresentou uma melhoria em relação à referência (ganho = 0,9 %). Mesmo tendo utilizado mais avaliações de função, vale ressaltar que os resultados obtidos pela referência foram obtidos após vários testes considerando diferentes pontos iniciais. Os valores das variáveis de projeto que fornecem as soluções indicadas são exibidos nas Tabelas 5.41 e 5.42, e os históricos da produção do reservatório são exibidos na Figura 5.19.
Tabela 5.41 - Valores das vazões obtidas pelo SAO para o caso OCT-TV
Ciclo de controle	12	3
P-3	0,178 0,162 0,161
P-4	0,145 0,110 0,076
P-5	0,111 0,128 0,135
P-6	0,169 0,180 0,179
P-8	0,162 0,162 0,178
P-10	0,102 0,164 0,172
P-11	0,130 0,094 0,098
I-1	0,203 0,225 0,189
I-2	0,045 0,131 0,086
I-7	0,107 0,140 0,182
I-9	0,259 0,258 0,197
I-11	0,254 0,122 0,216
Duração	0,140 0,065 0,796
Tabela 5.42 - Valores das vazões obtidas pelo GlfLlf para o caso OCT-TV
Ciclo de controle	12	3
P-3	0,099 0,006 0,006
P-4	0,132 0,005 0,005
P-5	0,086 0,014 0,014
P-6	0,080 0,000 0,000
P-8	0,141 0,043 0,043
P-10	0,021 0,090 0,090
P-11	0,093 0,002 0,002
I-1	0,148 0,009 0,009
I-2	0,183 0,023 0,023
I-7	0,007 0,007 0,007
I-9	0,229 0,020 0,020
I-11	0,033 0,101 0,101
Duração	0,002 0,002 0,996
Figura 5.19- Curvas de produção acumulada com os resultados obtidos pelo SAO e pelo GLFLLF para o problema OCNT-TV.
Com o histórico da produção apresentado na Figura 5.19, percebe-se que a solução obtida com a estratégia híbrida proporcionou uma varredura mais eficiente.
5.2.2	Resultados obtidos nos estudos de problemas multiobjetivo para o segundo reservatório
Da mesma forma que foi adotada para o primeiro reservatório, os estudos realizados para problemas de otimização de múltiplos objetivos simultaneamente têm como formulação básica a Eq. (1.5). Devido aos tipos de objetivos considerados, não há sentido em fazer a análise adotando a capacidade de operação topada da unidade de produção do reservatório, e a garantida da manutenção da pressão média do reservatório é dada por uma restrição imposta na formulação do problema de otimização.
Com relação ao planejamento dos ciclos de controle, também é considerado apenas o estudo da explotação em um único ciclo ao longo do período de concessão.
Com base nessas definições, as variáveis consideradas são os rateios de todos os poços. Tendo definidos nP como o número total de poços produtores, nI como o número total de poços injetores, e adotando a normalização das variáveis conforme definido na Eq. (1.2), a formulação do problema é dada pela Eq. (5.5).
Das metodologias de otimização é empregada apenas a estratégia híbrida atuando no modelo substituto é considerada (MO_GlfLlf), para avaliar o desempenho da mesma no problema proposto, devido ao desempenho obtido no problema multiobjetivo estudado para o primeiro reservatório.
A quantidade de pontos presentes na frente de Pareto fornecida pela estratégia híbrida é definida de forma prévia. No teste realizado, a solução apresenta 22 pontos selecionados.
Os gráficos com as soluções obtidas são apresentados na Figura 5.20, onde cada quadro indica o resultado obtido em cada fase do processo de busca, e os pontos que representam os resultados indicados finais estão exibidos na Tabela 5.43.
400
350
300
250
200
150
100
• Soluções do NSGA-II (LF)	«, ■	' Pontos selecionados (HF)	'	■
4- * *■ . ./ ** . ■	* 4-	- . /•’ .
50
50	100	150	200	250	300	350	400	450	500
Água acumulada
400
350
300
250
200
150
100
• Pontos iniciais
SOluções do NBI
0 k------1-------1------1-----1---------1-----1--------1-----1
50	100	150	200	250	300	350	400	450
Água acumulada
*


*
*
*
*
(a)	(b)
Figura 5.20 - Soluções obtidas pela estratégia híbrida, MO_GLfLLf, nas fases (a) global e (b) local.
Tabela 5.43 - Resultados obtidos pelo MO GhfLhf para o problema multiobjetivo do primeiro reservatório.
Ponto de Pareto	P-3	P-4	P-5	P-6	P-8	P-10	P-11	I-1	I-2	I-7	I-9	I-11	Óleoprod (105 m3)	Águainj (105 m3)
1	0,130	0,079	0,158	0,156	0,180	0,176	0,118	0,181	0,078	0,119	0,161	0,215	373,890	437,121
2	0,123	0,091	0,121	0,151	0,175	0,179	0,098	0,154	0,085	0,096	0,164	0,210	348,812	412,060
3	0,129	0,085	0,097	0,154	0,151	0,150	0,051	0,110	0,077	0,109	0,131	0,189	313,764	362,554
4	0,121	0,093	0,044	0,137	0,171	0,151	0,053	0,061	0,058	0,095	0,157	0,212	302,268	342,641
5	0,126	0,073	0,077	0,145	0,154	0,150	0,042	0,083	0,072	0,090	0,152	0,182	305,373	340,256
6	0,136	0,128	0,013	0,120	0,141	0,058	0,062	0,063	0,057	0,118	0,071	0,188	257,824	300,252
7	0,138	0,154	0,021	0,142	0,091	0,066	0,056	0,093	0,068	0,129	0,083	0,133	251,662	295,529
8	0,163	0,158	0,006	0,108	0,106	0,061	0,040	0,077	0,064	0,164	0,078	0,103	237,025	286,301
9	0,156	0,156	0,019	0,092	0,074	0,037	0,056	0,042	0,089	0,163	0,064	0,090	217,400	264,656
10	0,150	0,136	0,045	0,088	0,027	0,042	0,047	0,063	0,042	0,126	0,063	0,111	198,209	237,648
11	0,165	0,138	0,022	0,095	0,048	0,046	0,036	0,064	0,048	0,142	0,061	0,102	204,117	242,502
12	0,138	0,126	0,030	0,091	0,043	0,029	0,033	0,013	0,015	0,126	0,097	0,119	184,954	217,032
13	0,146	0,118	0,026	0,069	0,040	0,030	0,047	0,054	0,056	0,133	0,063	0,055	173,044	209,127
14	0,063	0,051	0,050	0,052	0,001	0,025	0,001	0,013	0,001	0,007	0,043	0,119	111,279	116,153
15	0,126	0,086	0,032	0,042	0,045	0,030	0,025	0,052	0,037	0,051	0,055	0,095	150,028	170,741
16	0,121	0,089	0,023	0,047	0,039	0,034	0,014	0,051	0,039	0,044	0,064	0,078	141,659	161,662
17	0,110	0,060	0,037	0,047	0,033	0,034	0,024	0,052	0,036	0,055	0,045	0,072	138,259	156,895
18	0,105	0,039	0,042	0,044	0,029	0,039	0,024	0,057	0,037	0,038	0,049	0,064	127,935	145,754
19	0,101	0,035	0,046	0,047	0,021	0,005	0,010	0,067	0,004	0,017	0,017	0,097	107,239	116,293
20	0,083	0,073	0,011	0,056	0,005	0,030	0,022	0,040	0,039	0,023	0,050	0,059	113,639	138,830
21	0,002	0,028	0,026	0,011	0,006	0,031	0,007	0,003	0,009	0,012	0,009	0,051	49,110	51,556
22	0,046	0,026	0,007	0,006	0,025	0,012	0,030	0,004	0,023	0,058	0,002	0,028	69,009	73,81167
A Tabela 5.44 apresenta as quantidades de avaliações consideradas para cada estratégia.
Tabela 5.44 - Resultados obtidos no problema OCNT-TF
____________________Avaliações de função
MO GlfLlf	3.626
Considerando o critério definido por Cramer et. a., (2012), a frente de Pareto encontrada pela estratégia híbrida não apresenta um região de inflexão, o que dificulta a seleção de um dos pontos dentre os demais.
Capítulo 6 - Observações finais
6.1	Conclusões
O presente trabalho teve como objetivo apresentar estratégias híbridas de otimização como ferramentas eficientes e confiáveis, em problemas uniobjetivo e multiobjetivo da engenharia de reservatório.
A otimização do gerenciamento da produção de reservatório foi realizada em dois modelos distintos. O primeiro reservatório, de configuração bastante simples, foi preparado para estudar os aspectos mais básicos do problema de otimização de alocação dinâmica das vazões dos poços de produção e injeção. O segundo reservatório, com características mais complexas e realistas, foi estudado com o intuito de testar a eficiência das estratégias em problemas reais.
Os estudos desenvolvidos levaram às seguintes conclusões:
•	As características principais dos problemas são alto grau de não-linearidade na formulação das funções envolvidas e elevado custo computacional. O uso de modelos substitutos possibilitou que a otimização do problema fosse realizada com um custo bastante reduzido, chegando a obter uma diminuição de 93% no número de simulações necessárias;
•	Na formulação do problema, a consideração de flexibilizações no gerenciamento, tanto através de modificações nas operações (OCT e OCNT) como no planejamento dos ciclos de controle (em períodos pré-determinados ou definidos como variáveis), demonstra ser uma opção eficiente, porém, essa consideração claramente acrescenta ao problema uma multimodalidade, que torna o processo de otimização árduo;
•	Apesar das soluções encontradas pelo SAO serem consideradas como as soluções de referências para os estudos realizados, não é recomendado o uso do mesmo de forma individual devido à presença de multimodalidade nas funções envolvidas. Também não é recomendado o uso de EA de modo individual, pois o mesmo necessita de inúmeras avaliações de função para convergir;
•	No processo de otimização com a estratégia híbrida, a fase de busca global realizada pelo GA foi bastante dificultada pelas restrições envolvidas, e em muitos dos testes realizados, o algoritmo foi finalizado sem identificar uma solução viável. As técnicas de manipulação de restrições, a reparação de cromossomo e o método das penalizações adaptativas, são de extrema importância, pois possibilitam ao GA capacidade de atuar em tais problemas;
•	É perceptível que as estratégias híbridas atuando sobre o modelo de baixa fidelidade atingiram os melhores resultados - os valores alcançados apresentam diferenças irrisórias em relação aos da referência - além de considerarem um menor número de avaliações de função;
•	A estratégia híbrida proposta para solucionar problemas de otimização multi-objetivo demonstrou um desempenho bastante satisfatório, uma vez que as frentes de Pareto foram encontradas.
6.2	Sugestões para trabalhos futuros
Os estudos realizados com as estratégias híbridas sugeridas apresentaram resultados satisfatórios, porém, estudos complementares podem ser realizados com o intuito de melhorar a eficiência da metodologia. Tomando como ponto de partida o presente trabalho, as seguintes sugestões são citadas para trabalhos futuros:
•	Investigação de critérios de parada mais eficientes, para a transição entre a fase de busca global para a fase de busca local;
•	Testar a funcionalidade das estratégias híbridas considerando a aplicação das mesmas com modelos de ordem reduzida (Reduced Order Models - ROM);
•	Utilização das estratégias em problemas que sejam consideradas análises de incerteza;
•	Testar o uso de outros algoritmos para composição da estratégia híbrida, como o algoritmo do enxame de partículas (Particle Swarm Optimization - PSO) na fase de busca inicial;
•	Estudos com mais técnicas de manipulação de restrições para o algoritmo utilizado na fase de busca global;
•	Estudos de estratégias híbridas em problemas otimização sob incertezas para gerenciamento da produção de reservatórios.
Bibliografía
Abraham, A., Jain, L., &amp;amp; Goldberg, R. (. (2005). Evolutionary Multiobjective Optimization - Theoretical Advances and Applications. Springer.
Adams, B. M., Bohnhoff, W. J., Dalbey, K. R., Eddy, J. P., Eldered, M. S., Hough, P. D., . . . Vigil, D. M. (2010). DAKOTA, a multilevel parallel object-oriented framework for design optimization, parameter estimation, uncertainty quantification, and sensitivity analysis: Version 5.1 references manual. Technical Report SAND2010-2184, Sandia National Laboratories.
Afonso, S. M. (1995). Shape Optimization of Shells Under Static and Free Vibration Conditions. PhD thesis - University of Wales. Swansea, Wales.
Afonso, S. M. (1997). Structural Shape Optimization Considering Multiobjective Functions. Proceedings of III SIMMEC - III Simpósio Mineiro de Mecânica Computacional, pp 251-260. Ouro Preto, MG, Brasil.
Afonso, S. M., &amp;amp; Sienz, J. (1999). Investigation of Different Strategies to Solve Multicriteria Structural Shape Optimization Problems. 1st ASMO UK/ISSMO Conference. Ikley, U.K.
Afonso, S. M., Horowitz, B., &amp;amp; Oliveira, L. C. (2010). Waterflooding Management Through the Combination of Global and Local Optimization Strategies. In: EngOpt - 2nd International Conference on Engineering Optimization. Instituto Técnico Superior de Lisboa, Lisbon - Portugal.
Afonso, S. M., Horowitz, B., &amp;amp; Wilmersdorf, R. B. (2008). Comparative Study of Surrogate Models for Engineering Problems. ASMO-UK (Association for Structural and Multidisciplinary Optimization in the UK), Bath, UK.
Alexandrov, N., Dennis, J. R., Lewisand, R. M., &amp;amp; Torezon, V. (1997). A Trust Region Framework for Managing the Use of Approximation Models in Optimization. NASA/CR-201745; ICASE Report No. 97-50.
ANEEL - AGÊNCIA NACIONAL DE ENEGIA ELÉTRICA - BRASIL. (2008). Atlas de energia elétrica do Brasil. Brasília.
Aronofsky, J. S., &amp;amp; Lee, A. S. (1958). Linear Programming Model for Scheduling Crude Oil Production. pp 51-54. SPE 862, Journal of Petroleum Tecnology, 10.
Barthelemy, J. F., &amp;amp; Haftka, R. T. (1993). Approximation concepts for optimum structural design - a review. Structural Optimization, v. 5, pp 129-144.
Barthelemy, J. F., &amp;amp; Lemonge, A. (2003). An adaptive penalty scheme for steady-state genetic algorithms. 2723:718-729.
Burkardt, J., Gunzburger, M., &amp;amp; Saka, Y. (2007). Latinized, improved LHS, and CVT point sets in hypercubes. IEEE Trans Inf Theory.
Castro, R. E. (2001). Otimização de estruturas com Multi-objetivo via Algoritmo Genético. Tese de Doutorado. COPPE/UFRJ, Rio de Janeiro.
Coello, C. A., &amp;amp; Pulido, G. T. (2001). A Micro-Genetic Algorithm for Multiobjective Optimization. In Zitzler, E., Deb, K., Thiele, L., Coello Coello, C. A. and Corne, D. (eds.), First International Conference on Evolutionary Multi-Criterion Optimization, pp. 126-140. Springer-Verlag, Lecture Notes in Computer Science n° 1993.
Coello, C. A., &amp;amp; Pulido, G. T. (2001). Multiobjective Optimization Using a Micro-Genetic Algorithm. In Spector, L., Goodman, E. D., Wu, A., Langdon, W. B., Voigt, H-M., Gen, M., Sen, S., Dorigo, M., Pezeshk, S., Garzon, M. H. and Burke, E. (eds.), Proceedings of the Genetic and Evolutionary Computation Conference (GECCO’2001), pp. 274-282. San Francisco - California: Morgan Kaufmann Publishers.
Coello, C. A., Pulido, G. T., &amp;amp; Lechuga, M. S. (2004). Handling Multiple Objective with Particle Swarm Optimization. IEEE Transactions on Evolutionary Computation, vol. 8, n° 3.
Collette, Y., &amp;amp; Siarry, P. (2003). Multiobjective Optimization - Principles and Case Studies. Springer-Verlag, 1st ed.
CMG (2005) COMPUTER MODELLING GROUP Ltd; Imex 2005.10 User‘s Guide; Manual de Referência.
Conn, A. R., Gould, N. I., &amp;amp; L, T. P. (2000). Trust-region methods. SIAM &amp;amp; MPS.
Conn, A. R., Gould, N. I., &amp;amp; Toint, P. H. (1997). A Globally Convergent Lagrangian Barrier Algorithm for Optimization with General Inequality Constraints and Simple Bounds. Mathematics of Computation, vol 66, number 217, p 261-288.
Corne, D. W., Knowles, J. D., &amp;amp; Oates, M. J. (2000). The Pareto Envelope-based Selection Algorithm for Multiobjective Optimization. In Schoenauer, M., Deb, K., Rudolph, G., Yao, X. Lutton, E., Merelo, J. J. and Schwefel, H-P. (eds.), Proceedings of the Parallel Problem Solving from Nature VI Conference, pp. 839-848. Paris, France: Springer, Lecture Notes in Computer Science n° 1917.
Cramer, E. J., Gablonsky, J. M., Lurati, L. B., Sellers, P. P., &amp;amp; Simonis, J. (2012). Practical Experience with a Multi-Objective Model-Management Framework Optimization Method. 12th AIAA Aviation Technology, Integration, and Operations (ATIO) Conference and 14th AIAA/ISSM. Indianapolis, Indiana.
Darwin, C. (1859). On the Origin of Species by Means of Nature Selection, or the Preservation of Favoured Races in the Struggle for Life.
Das, I., &amp;amp; Dennis, J. E. (1997). A Closer Look at Drawbacks of Minimizing Weighted Sums of Objectives for Pareto Set Generation in Multicriteria Optimization Problems. Structural Optimization, vol. 14, pp. 63-69.
Das, I., &amp;amp; Dennis, J. E. (1998). Normal-Boundary Intersection: A New Method for Generating the Pareto Surface in Nonlinear Multicriteria Optimization Problems. SIAM Journal on Optimization, 8(3), 631.
Deb, K. (1995). Optimization for Engineering Design: Algorithms and Examples. Prentice-Hall, New Delhi.
Deb, K. (2001). Multi-Objective Optimization Using Evolutionary Algorithms. John Wiley &amp;amp; Sons.
Deb, K., &amp;amp; Goldberg, D. E. (1989). An investigation of niche and species formation in genetic function optimization. In Schaffer, J D (ed), Proceedings of the Third International Conference on Genetic Algorithms, pp 42-50. San Mateo - CA: Morgan Kaufmann Publishers.
Deb, K., Agrawal, S., Pratab, A., &amp;amp; Meyarivan, T. (2000). A Fast Elitism Nondominated Sorting Algorithm for Multi-objective Optimization: NSGA-II. In Schoenauer, M., Deb, K., Rudolph, G., Yao, X., Lutton, E., Merelo, J.J. and Schwefel, H-P. (eds.), Proc.
Deb, K., Agrawal, S., Pratab, A., &amp;amp; Meyarivan, T. (2000). A Fast Elitism Nondominated Sorting Algorithm for Multi-objective Optimization: NSGA-II. KanGAL report 200001, Indian Institute of Technology. Kanpur, India.
Deb, K., Pratab, A., Agrwal, S., &amp;amp; Meyarivan, T. (2002). A Fast Elitism Multiobjective Genetic Algorithm: NSGA-II. IEEE Transactions on Evolutionary Computation, 6(2): 182-197.
Eldred, M. S., Giunta, A. A., &amp;amp; Collis, S. S. (2004). Second-Order Corrections for Surrogate-Based Optimization with Model Hierarchies, Paper AIAA-2004-4457 in Proceedings of the 10th AIAA/ISSMO Multidisciplinary Analysis and Optimization Conference. Albany, NY.
Erickson, M., Mayer, A., &amp;amp; Horn, J. (2001). The Niched Pareto Genetic Algorithm 2 Applied to the Design of Groundwater Remediation Systems. In Zitzler, E., Deb, K.,Thiele, L., Coello Coello, C. A. and Corne, D. (eds.), First International Conference on E.
Fonseca, C. M., &amp;amp; Fleming, P. J. (1993). Genetic Algorithm for Multiobjective Optimization: Formulation, Discussion and Generalization. in Forrest, Proceedings of the Fifth International Conference on Genetic Algorithms, pp 416-423. San Mateo, CA: Morgan Kaufmann Publishers.
Fonseca, C. M., &amp;amp; Fleming, P. J. (1993). Genetic Algorithm for Multiobjective Optimization: Formulation, Discussion and Generalization. In Forrest, S. (ed.), Proceedings of the Fifth International Conference on Genetic Algorithms, pp. 416-423. San Mateo.
Fonseca, L. d. (2010). Otimização para Simulação Estocástica de Reservatório de Petróleo - Algoritmo de Diferenças Randômicas Simultâneas. Dissertação de Mestrado. Universidade Federal de Pernambuco, Recife, PE.
Forrester, A., Sobester, A., &amp;amp; Keane, A. (2008). Engineering Design Via Surrogate Modelling: A Practical Guide. 228 p. Chichester: Wiley, ISBN 0470060689.
Gen, M., &amp;amp; Cheng, R. (2000). Genetic Algorithm &amp;amp; Engineering Optimization. Wiley Series in Engineering Design an Automation - Hamid R. Parsaei, Series Editor.
Geoquest Ltd. (2005). Eclipse Technical Description. Manual de Referência.
Goldberg, D. E. (1989). Genetic Algorithm in Search, Optimization and Machine Learning. MA: Addison-Wesley Publishing Company, Reading.
Güyagüler, B. (2002). Optimization of Well Placement and Assessment of Uncertainty. Doctor of Philosophy Thesis. Stanford University, Stanford, California, USA.
Haftka, R. T., &amp;amp; Gürdal, Z. (1993). Elements of Structural Optimization - Third revised and expanded edition. Solid Mechanics and its Applications, vol. 1. Klwer Academic Publishers, Netherlands.
Harting, T. J., Radcliff, N. J., &amp;amp; King, P. R. (1998). Hydrocarbon Production Schedulle with Genetic Algoritms. SPE 36379, SPE Journal, 6.
Horn, J., Nafpliotis, N., &amp;amp; Goldberg, D. E. (1994). A Niched Pareto Genetic Algorithm for Multiobjective Optimization. In Proceedings of the First IEEE Conference on Evolutionary Computation, IEEE World Congress on Computational Intelligence, vol. 1, pp.
Horne, R. N. (2002). Optimization Application in Oil and Gas Recovery. In: PARDALOS, P.M.; RESENDE, M.G.C., Handbook of Applied Optimization, Oxford University Press, New York.
Horowitz, B., &amp;amp; Afonso, S. M. (s.d.). Surrogate Based Optimal Waterflooding Management. (artigo aceito a ser publicado) .
Horowitz, B., Afonso, S. M., &amp;amp; Mendonça, C. V. (2013). Surrogate based optimal waterflooding managemente. In: Journal of Petroleum Science and Engineering, ed. 112, p 206-219
Horowitz, B., Afonso, S. M., &amp;amp; Mendonça, C. V. (2010). Using Cycle Switching Times as Design Variables in Optimum Waterflooding Management. In: EngOpt - 2nd International Conference on Engineering Optimization, Instituto Técnico Superior de Lisboa, Lisbon, Portugal.
Horowitz, B., Afonso, S. M., &amp;amp; P, M. C. (2009). Rate Control Optimization of Waterflooding Management. In XXX CILAMCE - Congresso Ibero Lantino Americano de Métodos Computacionais em Engenharia.
IEA - INTERNATIONAL ENERGY AGENCY. (2010). Key World Energy Statistics. World Energy Outlook. Paris.
Innocente, M. S. (2006). Population-Based Methods: Particle Swarm Optimization -Development of a General-Purpose Optimizer and Applications. master's thesis. Universitat Politécnica de Catalunya, Barcelona.
Jin, Y., Okabe, T., &amp;amp; Sendhoff, B. (2001). Adapting Weighted Aggregation for MultiObjective Evolution Strategies. In: DEB, K., THIELE, L., e ZITZLER E., eds., First International Conference on Evolutionary Multi-criterion Optimization, Lecture Notesin Com.
Keane, A. J., &amp;amp; Nair, P. B. (2005). Computational Approaches for Aerospace Design: The pursuit of Excellence. 602 p. Hoboken: John Willey &amp;amp; Sons Inc., ISBN 0470855401.
Knowles, J. D., &amp;amp; Corne, D. W. (2000). Approximating the Nondominated Front Using the Pareto Archived Evolution Strategy. Evolutionary Computation, 8(2):149-172.
Koski, J. (1985). Defectiveness of Weighting Method in Multicriterion Optimization of Structures. Communications in Applied Numerical Methods, vol. 1, pp. 333-337.
Kuhn, H. W., &amp;amp; Tucker, A. W. (1951). Nonlinear Programming, in Neyman, J. (ed). Proceedings of the Second Berkeley Symposium on Mathematical Statistics and Probability, pp. 481-492. Berkeley, CA, University of California Press.
Lemonge, A. C., &amp;amp; Barbosa, H. J. (2002). An adaptive penalty scheme for genetic algorithms in structural optimization. INTERNATIONAL JOURNAL FOR NUMERICAL METHODS IN ENGINEERING. Int. J. Numer. Meth. Engng 2004; 59:703-736.
Macedo, C. M. (2002). Otimização de Treliças Planas sob Várias Solicitações com Ênfase em Problemas Multiobjetivos. Dissertação de Mestrado, Dept. de Engenharia Civil, Universidade de Pernambuco. Recife-PE: Brasil.
Michalewicz, Z., &amp;amp; Dasgupta, D. (1997). Evolutionary Algorithms in Engineering Applications, . Springer Verlag.
Montes, E. M. (2009 (ed.)). Constraint-Handling in Evolutionary Optimization. Springer Verlag.
Mosetti, G., &amp;amp; Poloni, C. (1993). Aerodynamic shape optimization by means of a genetic algorithm. 5th International Symposium on Computational Fluid Dynamics. Sendai, Japan.
Motta, R. d. (2009). OTIMIZAÇÃO ROBUSTA DE ESTRUTURAS UTILIZANDO O MÉTODO DA BASE REDUZIDA. Dissertação Mestrado - UNIVERSIDADE FEDERAL DE PERNAMBUCO - CENTRO DE TECNOLOGIA E GEOCIÊNCIAS - DEPARTAMENTO DE ENGENHARIA CIVIL.
Motta, R. d., Afonso, S. M., &amp;amp; Lyra, P. R. (2012). A modified NBI and NC method for the solution of N-multiobjective optimization problems. Springer.
Oliveira, D. F. (2006). Técnicas de Otimização da Produção para Reservatórios de Petróleo: Abordagens Sem Uso de Derivadas para Alocação Dinâmica das Vazões de Produção e Injeção. Dissertação de mestrado. UFPE, Brasil.
Oliveira, L. C. (2008). Otimização Estrutural Utilizando o Algoritmo do Enxame de Partículas. Dissertação de Mestrado. Universidade Federal de Pernambuco, Recife, PE.
Pan, Y., &amp;amp; Horne, N. R. (1998). Improved Methods for Multivariate Optimization of Field Development Scheduling and Well Placement Design. SPE 49055, Annual Techinical Conference and Exhibition in New Orleans, Lousiana.
Pietrobom, H. C. (2002). Otimização Utilizando Funções Substitutas e Extração de Regras Difusas. Tese de Doutorado. ITA, São Paulo.
Poloni, C., &amp;amp; Pediroda, V. (1997). GA coupled with computationally expensive simulations: tools to improve effciency. In Genetic Algorithms and Evolution Strategies in Engineering and Computer Science, pages 267-288. England: John Wiley and Sons.
Poloni, C., Giurgevich, A., Onesti, L., &amp;amp; Pediroda, V. (2000). Hybridization of a multiobjective genetic algorithm, a neural network and a classical optimizer for a complex design problem in fluid dynamics. Computer Methods in Applied Mechanics and Engineering, volume 186, pages 403-420.
Powell, M. J. (1978). Algorithms for Nonlinear Constraints that Use Lagragian Functions. Math. Prog., 14, pp. 224-248.
Reklaitis, G. V., Ravindran, A., &amp;amp; Ragsdell, K. M. (1983). Engineering Optimization Methodsand Applications. Wiley, New York.
Rigoni, E., &amp;amp; Poles, S. (2005). Two Complementary Algorithms for Multi-Objective Optimizations. Dagstuhl Seminar Proceedings 04461, Pratical Approaches to Multiobjective Optimization.
Rigoni, E., &amp;amp; Turco, A. (2010). Metamodels for fast multi-objective optimization: trading off global exploration and local exploitation. In Proceedings of the 8th international conference on Simulated evolution and learning (SEAL'10), pp 523-532. Kalyanmoy Deb, Arnab Bhattacharya, Partha Chakroborty, Joydeep Dutta, and Santosh K. Gupta (Eds.), Springer-Verlag, Berlin: Heidelberg.
Romero, V. J., Burkardt, J. V., Gunzburger, M. D., &amp;amp; Petreson, J. S. (2006). Comparison of Pure and “Latinized” Centroidal Voronoi Tessellation Against Various Other Statistical Sampling Methods. pp 1266-1280. Reliability Engineering and System Safety 91.
Rosa, A. J., Carvalho, R. S., &amp;amp; Xavier, J. A. (2006). Engenharia de Reservatórios de Petróleo. Editora Interciência, Rio de Janeiro.
Schaffer, J. D. (1984). Multiple Objective Optimization with Vector Evaluated Genetic Algorithms. PhD thesis, Vanderbilt University. Nashville, TN.
Schaffer, J. D. (1985). Multiple Objective Optimization with Vector Evaluated Genetic Algorithm. In Genetic Algorithm and their Applications: Proceedings of the First International Conference on Genetic Algorithms, pp. 93-100. Hillsdale, NJ, Lawrence Erlb.
Schaffer, J. D., &amp;amp; Grefenstette, J. J. (1985). Multiobjective Learning Via Genetic Algorithms. In Proceedings of the 9th International Joint Conference on Artificial Intelligence (IJCAI - 85), pp. 593-595. Los Angeles, CA, AAAI.
Schewchuk, J. R. (1995). An Introduction to the Conjugate Gradiente without the Agonizing Pain. PA 15213 School of Computer Science, Carnagie Mellon University of Pittisburg.
Schittkowski, K. (2001). NLPQLP: A New Fortran Implementation of a Sequential Quadratic Programming Algorithm. User's Guide, Report, Department of Mathematics, University of Bayreuth.
Schmit, L. A., &amp;amp; Farshi, B. (1974). Some approximation concepts for structural synthesis. v. 12, n. 5, pp 692-699. AIAA Journal.
Schmit, L. A., &amp;amp; Miura, H. (1976). Approximation concepts for efficient structural synthesis. pp 289 . University of California. L.A., NASA contractor report -NASA CR-2552.
See, B. A., &amp;amp; Horne, R. N. (1983). Optimal Reservoir Production Scheduling by Using Reservoir Simulation. SPE 11133, Annual Techinical Conference and Exhibition in New Orleans, Lousiana.
Silva, M. F. (2010). Estratégias de Aproximação para a Otimização Estrutural. Dissertação de Mestrado. Universidade Federal de Pernambuco, Recife, PE.
Silva, F. T., Rodrigues, J. P., Paraizo, P. B., Romeu, R. K., Peres, A. M., Oliveira, R. M., Pinto, I. A., Maschio, C. (2005). Novel Ways of Parameterizing the History Matching Problem; SPE 94875, SPE Latin Americam and Caribbean Petroleum Engeneering Conference, Rio de Janeiro.
Souza, S. A. (2012). Gerenciamento Ótimo de Produção Utilizando o Algoritmo do Enxame de Partículas e Modelos Substitutos Adaptativos. Dissertaçãoo de Mestrado - Universidade Federal de Pernambuco - Centro de Tecnologia e Geociências - Departamento de Engenharia Civil. Refice - PE, Brasil.
Spicer, D., Cook, J., Poloni, C., &amp;amp; Sen, P. (1998). EP20082 Frontier: Industrial MultiObjective Design Optimisation. In Proceedings of the 4th European Computational Fluid Dynamics Conference (ECCOMAS 98). England: John Wiley and Sons.
Srinivas, N., &amp;amp; Deb, K. (1994). Multiobjective Optimization Using Nondominated Sorting in Genetic Algorithms. Evolutionary Computation, 2(3): 221-248.
Thomas, J. E. (2001). Fundamentos de Engenharia de Petróleo. Rio de Janeiro: Editora. Torres, J. S. (2001). Otimização de Pórticos de Concreto Armado Utilizando o Sistema Computacional ANSYS. Dissertação de Mestrado. Dept. de Engenharia Civil, Universidade de Pernambuco, Recife-PE, Brasil.
Turco, A. (2011). MetaHybrid: Combining Metamodels and Gradient-Based Techniques in a Hybrid Multi-Objective Genetic Algorithm. In Proccedings of 5th International Conference, vol. 6683, pp 293-307. LION 5, Rome, Italy: Learn and Intelligent Optimization - Lecture Notes in COmputer Science.
Valente, J. (1982). Geomatemática: lições de geoestatística. Ouro Preto, MG: Fundação Gorceix.
Vanderplaats, G. N. (1984). Numerical Optimization Techniques for Engineering Design: with Applications. McGraw-Hill, New York.
Wang, P., Litvak, M., &amp;amp; Aziz, K. (2002). Optimization of Operation in Petroleum Fields. SPE 77658, Annual Techinical Conference and Exhibition in San Antonio, Texas.
Yang, X.-S. (2010). Engineering Optimization - An Introduction with Metaheuristic Applications. Jhon Wiley &amp;amp; Sons.
Zakirov, I. S., Aanonsen, S. I., Zakirov, E. S., &amp;amp; Palatnik, B. M. (1996). Optimizing Reservoir Performance by Automatic Allocation of Well Rates. In 5th European Conference on the Mathematics of Oil Recovery.
Zitzler, E., &amp;amp; Thiele, L. (1999). Multiobjective Eviolutionary Algorithms: A Comparative Case Study and the Strength Pareto Approach. IEEE Transactions on Evolutionary Computation, 3(4): 257-271.
Zitzler, E., Laumanns, M., &amp;amp; THiele, L. (2001). SPEA2: Improving the Strength Pareto Evolutionary Algorithm. Technical Report 103, Computer Engineering and Network Laboratory (TIK), Swiss Federal Institute of Technology (ETH) Zurich, Gloriastrasse 35, CH.</field>
	</doc>
</add>