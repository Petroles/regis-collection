<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19899</field>
		<field name="filename">3329_Cisneiros_FernandoAntoniodeAlemao_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA MECÂNICA
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação apresentada à
Faculdade de Engenharia Mecânica
como requisito parcial à obtenção do
Título de Mestre em Engenharia de Petróleo
Este '	a redação ---------¡-?
da tese defendida por	fcNTQMÇ)
DL ,.4Á.f r-j/y.	_____e aprovada
pela comissão julgadora e	' 19&amp;lt;j.L,
ANÁLISE DE TESTES
EM AMBIENtÈÁyiNDOWS
’ í'
AUTOR: FERNANDO ANTONIO DE ALEMÀO:CISNEIROS
ORIENTADOR: OSVAIR VIDAL TREVISAN
DEZEMBRO, 1992^
HBLIOTECA DA AREA DE ENGENHARIA
UN1CAMF
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA MECÂNICA
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação "Análise de Testes em Ambiente Windows" elaborada por Fernando Antonio de Alemão Cisneiros e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial à obtenção do Título de Mestre em Engenharia de Petróleo.
Campinas, 16 de dezembro de 1992
Banca examinadora
Osvair Vidál Trevisàn, Ph. D.
Maria Cristina de Castro Cunha, Ph. D.
DEDICATÓRIA
Ao meu pai
(em memória)
AGRADECIMENTOS
A minha esposa pelo sacrifício, paciência e apoio durante todo o decorrer do curso.
Aos meus pais que propiciaram a minha formação e modelagem de caráter.
Aos meus filhos que sacrificaram suas amizades e seu modo de vida ao se mudarem para esta cidade.
Ao professor Antonio Cláudio pelas idéias e orientação inicial.
Ao professor Trevisan pela orientação, estímulo e apoio dedicado em todas as etapas da elaboração desta dissertação.
A todo o corpo docente do Departamento de Engenharia de Petróleo pelo grande conhecimento por mim adquirido e pelo interesse demonstrado em transmití-lo.
A Petróleo Brasileiro S.A. pela confiança depositada ao possibilitar minha participação nesse curso e pelo apoio propiciado.
Ao meu Pai Celestial por ter possibilitado a minha existência e aperfeiçoamento nesta terra e pela orientação do seu Evangelho em minha vida.
RESUMO
Na última década ocorreram grandes avanços na técnica de interpretação de testes de pressão em poços e ao mesmo tempo uma expansão vertiginosa das facilidades de acesso a recursos computacionais através do advento dos microcomputadores.
Nos últimos anos a popularização das interfaces gráficas para microcomputadores com o advento do Macintosh, do Windows e do OS/2, estão modificando fortemente a interação homem-máquina e abrindo novos horizontes para as tecnologias acentuadamente dependentes de recursos gráficos.
A interpretação de testes de pressão em poços é sem dúvida uma tecnologia que se enquadra nesse perfil e a partir desta constatação, este trabalho propõe-se a definir e desenvolver um sistema profissional básico para análise de testes em ambiente gráfico.
São definidos o modelo de dados e a especificação do sistema. As metodologias para análise em poços surgentes e não surgentes (DST) são implementadas incluindo métodos de análise especializada, análise por curva típica e análise automatizada.
O desenvolvimento do sistema é feito utilizando um compilador Ceo ambiente gráfico Windows.
ABSTRACT
A considerable progress has occurred in well test interpretations techniques in the last decade. At the same time, a large expansion in the access to computational resources has taken place through the advent of microcomputers.
In the last years, the popularization of graphical interfaces for microcomputers introduced by Macintosh, Windows and OS/2, has modified the man-machine interaction and opened new ways to technologies which depend heavily on graphical resources.
Well test interpretation is certainly a technology that carries the graphical dependence. The purpose of this work is to define and to develop a basic professional system applied to well test interpretation under a graphical environment.
The data model and the system specification have been defined. Procedures for well test analysis of slug test data and tests for flowing wells have been implemented. The system includes type curves analysis, semilog analysis and automated type curve analysis.
The system has been developed with a "C" compiler and under the Windows graphical environment.
ÍNDICE
1.	Objetivo	1
2.	Análise de Testes	5
2.1- Visão Geral	5
2.2	- O Processo de Interpretação	6
2.3	- Modelagem do conjunto Poço-Reservatório	9
3.	Preparação de Dados e Diagnóstico	12
3.1	- Introdução	12
3.2	- Preparação dos dados	12
3.3	- Diagnóstico ou Modelagem	14
3.3.1	- Resposta de curto tempo	15
3.3.2	- Resposta de tempos intermediários	16
3.3.3	- Resposta de tempos longos	16
3.3.4	- Resposta de transição	17
4.	Análise por Curva Típica	18
4.1	- Visão Geral	18
4.2	- Breve Histórico	19
4.3	- Vantagens e Limitações	21
4.4	- Método da Derivada	23
4.5	- Método de Onur	25
4.6	- Aplicação ao Modelo de Fluxo Não Surgente	26
4.7	- Utilização com Dados de um Período de Estática	27
4.8	- Utilização em Processamento Computacional	28
5.	Análise Especializada	30
5.1	- Visão Geral	30
5.2	- Período de Fluxo Surgente	31
5.3	- Período de Estática Após Fluxo Surgente	31
5.4	- Período de Fluxo Não Surgente	32
5.4.1	- Método da Vazão Normalizada	32
5.4.2	- Método da Convolução	33
5.5	- Período de Estática Após Fluxo Não Surgente	34
5.5.1	- Método de Honer	34
5.5.2	- Método de Corrêa	34
5.5.3	- Método 1 de Peres ou Peres 1	35
5.5.4	- Método 2 de Peres ou Peres 2	37
6.	Análise Automatizada	39
6.1	-	Visão Geral	39
6.2	-	Breve Histórico	40
6.3	-	Vantagens e Limitações	42
6.4	-	Formulação Matemática	45
6.5	-	Método de Newton	47
6.6	-	Método de Gauss ou Gauss-Newton	48
6.7	-	Método de Gauss-Marquardt ou Levemberg-Marquardt	49
6.8	-	Método de Gauss-Grenstadt-Barua ou SVD	50
6.9	-	Normalização do Sistema de Solução	51
6.10 - Busca Restrita dos Parâmetros	52
6.11 - Tratamento do Efeito de Película Negativo	53
6.12	- Intervalos de Confiança	53
7.	O Ambiente Windows	55
7.1- Visão Geral	55
7.2	- Breve Histórico	56
7.3	- Interface Gráfica com o Usuário	58
7.4	- Independência de Periférico	59
7.5	- Processamento Orientado por Evento	61
7.6	- Processamento Multitarefa	64
7.7	- Troca de Dados entre Aplicações	67
7.8	- Gerenciamento de Memória	69
7.9	- Arquivos de Dados	70
7.10	- Elaboração de Aplicações em Windows	71
7.11	- Desafios do Ambiente Windows	73
8.	Descrição do Software	75
8.1	-	Introdução	75
8.2	- Caract. Bás. de uma Aplicaçao Profissional de Engenharia	76
8.3	-	Estrutura de Dados	81
8.4	-	Estrutura Básica do "Software"	86
8.4.1	- Módulo de Gerência de Dados	87
8.4.2	- Módulo de Interpretação	89
8.4.3	- Módulo de Elaboração de Relatório	93
8.5	- Apresentação do "Software''	95
9.	Conclusões	169
Nomenclatura	171
Referências Bibliográficas	173
Apêndice A	178
LISTA DE FIGURAS
Fig. 2.1- Visão sistêmica da interpretação de testes	7
Fig. 2.2 - O processo de interpretação de testes	8
Fig. 7.1 - Fluxo de mensagens no ambiente Windos	63
Fig. 7.2 - Processamento multitarefa no ambiente Windows	66
Fig. 8.1 - Estrutura	de dados	82
Fig. 8.2 - Estrutura	do módulo	de gerência de dados	88
Fig. 8.3 - Estrutura	do módulo	de interpretação	90
Fig. 8.4 - Estrutura	do módulo	de elaboração de	relatórios	94
Fig. 8.5 - Tela de chamada do software	98
Fig. 8.6 - Janela principal da aplicação	99
Fig. 8.7 - Submenu da opção "Arquivo"	100
Fig. 8.8 - Janela de abertura de arquivos	101
Fig. 8.9 - Janela com arquivo selecionado para abertura	103
Fig. 8.10	- Submenu de "Arquivo" com lista de arquivos abertos	104
Fig. 8.11	- Submenu da opção "Período*'	105
Fig. 8.12	-	Submenu da opção "Período" com período ativo marcado	106
Fig. 8.13	-	Submenu da opção "Dados"	107
Fig. 8.14	- Janela de entrada dos parâmetros fluido/poço/rocha	109
Fig. 8.15	-	Janela de seleção do sistema de unidades	110
Fig. 8.16	- Janela de entrada dos parâmetros de compressão.	111
Fig. 8.17	-	Submenu "Métodos" para fluxo surgente	112
Fig. 8.18	-	Submenu "Métodos" para estática seguida à fluxo surgente	113
Fig. 8.19	-	Submenu "Métodos" para fluxo não surgente	114
Fig. 8.20	-	Submenu "Métodos" p/ estática seguida a fluxo não surgente	115
Fig. 8.21	-	Janela de entrada dos parâmetros de método	117
Fig. 8.22	-	Janela de método maximizada	118
Fig. 8.23	-	Submenu da opção "Janelas"	120
Fig. 8.24	-	Janelas	de	método organizadas em cascata	121
Fig. 8.25	-	Janelas	de	método organizadas lado a lado	122
Fig. 8.26	-	Janelas	de	método com outras em forma de ícones.	123
Fig. 8.27 - Submenu da opção "Gráfico"	125
Fig. 8.28	-	Janela	da tabela de pontos do método	126
Fig. 8.29	-	Janela	com seleção de intervalo para ampliação	127
Fig. 8.30 - Gráfico ampliado de intervalo de pontos	128
Fig. 8.31	-	Janela	de consistência do intervalo de ampliação	130
Fig. 8.32	-	Janela	de dimensionamento dos eixos gráficos	131
Fig. 8.33 - Submenu da opção "Modelagem"	133
Fig, 8.34 - Exemplos das 4 retas de modelagem	134
Fig. 8.35 - Seleção do intervalo de um regime de comportamento	135
Fig. 8.36 - Janela de identificação do regime de comportamento	136
Fig. 8.37 - Modelagem com regimes identificados	137
Fig. 8.38 - Janela de seleção do modelo poço-resrevatório	139
Fig. 8.39 - Submenu móvel durante modelagem	140
Fig. 8.40 - Submenu móvel durante análise especializada	141
Fig. 8.41 - Submenu da opção "Interpretação" com curva típica	143
Fig. 8.42 - Submenu de "Interpretação" com método especializado	144
Fig. 8.43 - Janela de escolha dos parâmetros de curva típica	145
Fig. 8.44 - Gráfico da família de curvas típicas e dos dados de teste	146
Fig. 8.45 - Dados ajustados a curva típica do método da derivada	147
Fig. 8.46 - Dados ajustados a curva de derivada no método de Onur	148
Fig. 8.47 - Dados ajustados a curva de pressão no método de Onur	149
Fig. 8.48 - Menu móvel com opção de "Ajuste Vertical" selecionada	150
Fig. 8.49 - Janela com parâmetros de curva típica não nulos.	152
Fig. 8.50 - Menu móvel com opção "Resultados" ativa	153
Fig. 8.51 - Janela com resultados do ajuste gráfico	154
Fig. 8.52 - Resultados do ajuste gráfico e parâmetros calculado	155
Fig. 8.53 - Dados com ajuste automatizado realizado	157
Fig. 8.54 - Parâmetros de controle do ajuste automatizado	158
Fig. 8.55 - Resultados do ajuste automatizado	159
Fig. 8.56 - Submenu de "Interpretação" com opção "Extrapolação” ativa	161
Fig. 8.57 - Seleção de intervalo de pontos para extrapolação	162
Fig. 8.58 - Dados com extrapolação efetuada	163
Fig. 8.59 - Janela de consistência do intervalo de extrapolação	164
Fig. 8.60 - Gráfico ilustrativo de 3 extrapolações	165
Fig. 8.61 - Resultados das extrapolações	166
Fig. 8.62 - Janela de cancelamento de extrapolações	167
1. OBJETIVO
O propósito deste trabalho buscou conceituar e desenvolver um "software" básico em ambiente gráfico dedicado ao uso profissional na análise de testes de pressão em poços de petróleo. Essa atividade é basicamente realizada com utilização de gráficos em praticamente todas as suas etapas. Desta forma, torna-se intuitivamente claro o benefício da utilização de urna interface gráfica no desenvolvimento de um "software" para tal finalidade.
A popularização das interfaces gráficas para microcomputadores com o advento do Macintosh, do Windows e do OS/2 e a continua queda de preços da configuração de "hardware" necessária para utilização profissional desse tipo de ambiente, vem viabilizando sua espantosa proliferação e apontando para os próximos anos, urna maciça substituição dos "softwares" convencionais (interface tipo texto) por versões preparadas para ambientes gráficos.
As diversas caraterísticas dos ambientes gráficos, particularmente o Windows, permitem uma maior facilidade e rapidez na interpretação dos dados de um teste de pressão pela possibilidade do interpretador interagir simultaneamente com vários conjuntos de dados e gráficos das diversas metodologias atualmente utilizadas nessa atividade.
Como já foi citado, o objetivo foi desenvolver um "software" básico para utilização profissional, contendo um mínimo de recursos que cobrissem as diversas metodologias de interpretação e que estivesse preparado para a ampliação dos modelos de reservatórios e dos métodos de determinação de seus parâmetros, sem grandes alterações em sua estrutura básica.
Além do objetivo descrito acima, a análise e especificação do software procurou ser a mais abrangente possível, com o intuito de vislumbrar toda a
potencialidade de aplicação e consequentemente projetar sua estrutura básica de modo a compatibilizar os futuros aprimoramentos e acréscimos de recursos.
No início dos trabalhos, foi observado o domínio praticamente total de microcomputadores compatíveis com o IBM PC no meio profissional brasileiro, em particular na Petrobrás, com utilização do MS-DOS como sistema operacional. Tal constatação levou à escolha do Windows como interface gráfica para o desenvolvimento da aplicação em questão, já que esse ambiente foi criado para trabalhar sob o DOS, além de ambos haverem sido desenvolvidos pela Microsoft. Como linguagem de programação foi adotado o "C", em função de sua potencialidade e portabilidade, e do fato de ser até o momento, a linguagem mais utilizada na elaboração de aplicações para o ambiente Windows.
O segundo capítulo procura conceituar a atividade de análise de testes de pressão em poços descrevendo sua aplicabilidade na exploração, desenvolvimento e acompanhamento de reservatórios de hidrocarbonetos, seu processo de utilização prática com suas etapas e metodologias correspondentes e em seguida, sua filosofia de modelagem e resolução matemática.
O terceiro capitulo apresenta as considerações sobre a preparação e tratamento dos dados a serem utilizados no processo de interpretação e o procedimento de identificação do modelo poço-reservatório. São discutidos os aspectos conceituais dessas duas etapas iniciais da interpretação e as implicações do ponto de vista computacional.
O quarto capítulo descreve a metodologia de interpretação com utilização de curvas típicas. É apresentada sua filosofia básica e um breve histórico dos desenvolvimentos nessa área. São discutidas as vantagens e limitações dessa metodologia do ponto de vista técnico. São descritos os dois padrões de curvas típicas mais utilizados na indústria, com seus respectivos procedimentos gráficos e as expressões matemáticas para obtenção dos parâmetros desejados. São também
explicadas as considerações adotadas para aplicabilidade das curvas típicas a poços não surgentes e períodos de estática. E finalmente, são tecidos comentários sobre sua utilização do ponto de vista computacional.
O quinto capítulo trata da metodologia de análise especializada. É apresentada sua filosofia básica e uma seleção de métodos aplicáveis aos modelos poço-reservatório incorporados no presente trabalho. Para cada um dos métodos é citado seu fundamento básico, descrito o procedimento gráfico de utilização e as expressões matemáticas que permitem determinar os parâmetros desejados.
O sexto capítulo abrange a metodologia de análise automatizada. É apresentada sua filosofia básica e um breve histórico dos desenvolvimentos nessa área. São discutidas as vantagens e limitações dessa metodologia tanto do ponto de vista técnico como computacional. É definida a formulação matemática fundamental dessa técnica. São descritos os métodos mais comuns de implementação com suas vantagens e desvantagens comparativas. E finalmente, apresentadas as técnicas auxiliares empregadas na utilização dessa metodologia.
O sétimo capítulo procura apresentar, de forma suscinta, o ambiente gráfico Windows. É apresentado um breve histórico do desenvolvimento das interfaces gráficas com atenção as versões do ambiente Windows. São descritas suas principais características com enfoque voltado a facilidade de interface com o usuário, a comparação com ambientes convencionais como o DOS e as vantagens para o desenvolvimento de aplicações.
O oitavo capítulo descreve o "software" desenvolvido como resultado final deste trabalho. São tecidas considerações sobre as características básicas de uma aplicação dedicada ao uso profissional em engenharia. E apresentada a estrutura de dados do "software" obtida a partir de análise com modelo hierárquico de dados. São descritas as estruturas dos módulos componentes da aplicação, resultado da análise
das metodologias e procedimentos técnicos da atividade. Finalmente, procura-se com utilização de figuras e textos explicativos, demonstrar a utilização do "software".
O nono capítulo apresenta as conclusões deste trabalho procurando ressaltar as vantagens da utilização de um ambiente gráfico como o Windows na atividade de interpretação de testes de pressão em poços.
2.	ANÁLISE DE TESTES
2.1	- Visão Geral:
No desenvolvimento e produção de um reservatório de hidrocarbonetos é fundamental determinar certas características pertinentes à rocha reservatório, aos fluidos nela contidos e aos poços existentes. Entre as principais temos:
-	Volume de hidrocarbonetos no reservatório e seu fator de recuperação.
-	Capacidade de produção dos poços.
-	Propriedades dos fluidos presentes.
-	Mecanismo de produção do reservatório.
-	Propriedades da rocha reservatório e seus parâmetros quando em fluxo.
-	Condições mecânicas do poço e da rocha em sua vizinhança.
-	Pressão dos fluidos no reservatório.
-	Geometria do reservatório.
Das diversas tecnologias empregadas para obter essas características, a análise de testes de pressão possui um lugar de destaque pela sua abrangência. A seguir, são relacionados os principais objetivos e resultados alcançados em operações de teste de pressão em poços ligados a exploração, desenvolvimento e acompanhamento de uma jazida de hidrocarbonetos.
Numa área em exploração, testes de pressão num poço poderão permitir a recuperação de amostras dos fluidos contidos no reservatório, determinar a pressão original do mesmo, avaliar possíveis alterações das condições de fluxo na vizinhança
do poço (dano de formação) durante as operações de perfuração, estimar a extensão do reservatório e consequentemente o volume de hidrocarbonetos presente, determinar a capacidade de produção do poço, avaliar a facilidade com que ocorre o fluxo de fluídos na rocha (permeabilidade) além de caracterizar o reservatório quanto a macroheterogeneidades e seus limites (aquíferos, capas de gás, falhas, barreiras de permeabilidade e condições de fronteira).
Tais conhecimentos auxiliarão grandemente na definição da continuidade exploratória na área, na determinação da viabilidade econômica de produção comercial do poço e seu reservatório e na decisão de investir em operações de estimulação (acidíficação, fraturamento).
Em uma área já em produção, a análise de testes de pressão permitirá determinar a pressão média do reservatório e consequentemente acompanhar seu declínio em função da produção. Possibilitará também avaliar o dano de formação causado por intervenções de sonda no poço ou mudanças das condições de fluxo motivadas por instabilidades do reservatório e seus fluidos (migração de finos, inchamento de argilas, precipitação de frações pesadas). Auxiliará ainda na verificação da continuidade do reservatório entre dois poços, no acompanhamento da eficiência em projetos de recuperação secundária (injeção de água ou gás) e terciária (injeção de vapor, combustão in situ), além de colaborar na verificação da eficiência das operações de estimulação.
2.2-0 Processo de Interpretação:
Em uma operação de teste de pressão, o conjunto poço-reservatório pode ser visto como um sistema em estado estável onde é introduzida uma perturbação no poço. Normalmente faz-se uma alteração de vazão e são medidas as variações de pressão ao longo do tempo. Pode-se representar esquematicamente como segue:
Alteração de	Poço -	Resposta de
S Vazão	Reservatório	Pressão
(Entrada)	(Sistema)	(Saída)
	FIG. 2.1	
A interpretação de testes é assim um problema indireto, pois de posse das medições das vazões obtidas (entrada) e da resposta de pressão registrada no poço (saída), procuramos identificar os parámetros que caracterizam o conjunto poço-reservatório (sistema).
A partir dos dados da operação de teste até a obtenção dos parámetros e informações desejadas sobre o conjunto poço-reservatório, o processo de interpretação percorre diversas etapas e faz uso de varias metodologias distintas na busca desses resultados. A fig. 2.2 sumariza o processo de interpretação.
Após a obtenção dos dados de campo, a primeira etapa do processo é a "Preparação dos Dados" que pode envolver a manipulação dos pontos da resposta de pressão e a obtenção de parámetros auxiliares de fluido e rocha necessários á interpretação do teste. A seguir tem-se a etapa de "Diagnóstico" ou "Modelagem" onde procura-se identificar o modelo poço-reservatório que melhor representa a resposta de pressão, através da identificação de intervalos de pontos com comportamentos característicos do modelo.
A fase seguinte envolve a análise quantitativa do teste através do emprego de metodologias específicas como a "Análise por Curva Típica" onde procura-se ajustar a resposta de pressão do teste a uma resposta de pressão do modelo poço-reservatório selecionado e consequentemente determinar os parâmetros desejados. Alternativamente, e com resultados mais eficazes, utiliza-se a metodología da "Análise Especializada" onde determina-se os parâmetros do reservatório a partir de
intervalos de pontos com comportamento específico. Pode-se ainda refinar os resultados obtidos na análise quantitativa com emprego da metodologia de "Análise Automatizada" onde a partir dos resultados combinados ou não das metodologias anteriores, emprega-se técnicas de regressão não-linear para ajustamento dos dados de teste a resposta do modelo poço-reservatório.
FIG. 2.2
2.3	- Modelagem do Conjunto Poço-Reservatório:
Com base na compreensão das características físicas do reservatório e dos fluidos nele contidos, bem como da mecânica do escoamento de fluidos em meios porosos, desenvolvem-se modelos matemáticos do conjunto poço-reservatório que representem a resposta de pressão obtida quando realizadas alterações em sua condição estável.
Tais modelos são elaborados como função dos parâmetros característicos do conjunto poço-reservatório e constituem a base para as metodologias de interpretação de testes de pressão em poços..
Um modelo de reservatório é composto de:
Condições de Poço e sua Vizinhança - ex.: Vazão constante ou variável na superfície Crescimento de coluna (poço não surgente) Câmara de estocagem Penetração parcial Dano de formação
+
Tipos de Fluido 2 ex.:
Óleo
Gás
Água
+
Características da Rocha Reservatório - ex,:
Homogéneo
Estratificação horizontal
Estratificação vertical com ou sem fluxo cruzado
Presença de fratura hidráulica
Dupla porosidade
Limites do Reservatório - ex.:
Infinito
Limites fechados com geometrias diversas
Falha selante
Aquífero
Capa de gás
A equação diferencial resultante com suas condições auxiliares podem então ser resolvidas numericamente (simulação) ou analiticamente. Em análise de testes é mais comum o uso de soluções analíticas, cujas aproximações de curto e longo tempo são utilizadas na elaboração dos métodos de "Análise Especializada", ou soluções no campo de Laplace com inversão numérica, que são utilizadas na construção das respostas de pressão na metodologia de "Análise por Curva Típica" e nas técnicas de regressão não linear da metodologia de "Análise Automatizada".
Para efeito deste trabalho foram implementados os modelos para fluido de compressibilidade pequena em reservatório homogêneo infinito com estocagem e skin, apresentando vazão constante na superfície ou fluxo não surgente. As premissas
3.	PREPARAÇÃO DE DADOS E DIAGNÓSTICO
3.1	- Introdução:
Antes de iniciar-se um processo de interpretação de dados oriundos de uma operação de teste em poço, devem ser tomados alguns cuidados no intuito de otimizar o esforço humano e computacional do processo. Deve-se também visualizar o contexto poço-reservatório e definir preliminarmente o modelo a ser adotado e a metodologia a empregar. Todos esses procedimentos levarão a um esforço de interpretação melhor direcionado com consequente economia de tempo e recursos.
Além destas medidas prévias, são necessários dados adicionais aos coletados e registrados durante a própria operação de teste, para que seja possível determinar quantitativamente os parâmetros desejados. Dentro desta categoria, encontram-se dados de propriedades físicas da rocha que são normalmente obtidos através de análise de perfis do poço, correlações ou análise de testemunhos. Outro conjunto de dados necessários são as propriedades dos fluidos produzidos, que têm como fonte as correlações ou análises laboratoriais efetuadas em amostras coletadas durante a operação de teste.
A seguir vamos examinar as principais características da preparação dos dados registrados no teste e da escolha do melhor modelo representativo do reservatório.
3.2	- Preparação dos dados:
Muitas vezes um determinado período do teste possui uma grande quantidade de pontos de pressão contra tempo. Este fato é bastante comum quando do emprego de registradores eletrônicos, os quais são dotados de uma elevada sensibilidade e da possibilidade de amostrar os dados de pressão e temperatura com altíssima
frequência. Os pontos amostrados podem ser guardados em bancos de memória acoplados ao registrador, normalmente com capacidade para milhares de pontos, e posteriormente lidos e convertidos para meio magnético com o auxilio de um microcomputador. Ou ainda, se o registrador estiver acoplado a um cabo elétrico, os dados são transmitidos para a superfície, convertidos e armazenados em meio magnético, sem limite para a quantidade de pontos armazenados.
Tal fartura de dados a principio parece ser um fator puramente positivo, contudo é necessário salientar alguns aspectos:
-	A resolução de um gráfico preparado por um ser humano é dependente da escala gráfica utilizada e do menor intervalo perceptível ao olho humano. Uma grande quantidade de pontos tornaria a tarefa extremamente enfadonha e demorada, além de prejudicar a qualidade visual do gráfico pela sobreposição das marcas dos pontos.
-	Mesmo com o auxílio de computadores, convem lembrar que a resolução do gráfico gerado é dependente da capacidade de resolução do dispositivo de saída (número de pontos ou "pixels" em cada dimensão), sendo que os monitores de vídeo mais comuns atualmente limitam-se as centenas de "pixels" (ex.: CGA - 640 x 200; VGA - 640 x 480; SVGA - 1024 x 768). Adicionalmente, tem-se a questão estética e de percepção visual humana, que mostra ser ineficiente trabalhar próximo à resolução total do monitor, já que as marcas de identificação dos pontos graficados sofrerão sobreposição.
-	Outro fator está ligado a análise automática que envolve cálculos numéricos iterativos com diversas expressões extensas para cada ponto utilizado. Tal tarefa, quando realizada sobre uma grande quantidade de pontos, pode vir a ser bastante demorada para fins práticos mesmo quando utilizando computadores com boa capacidade de processamento.
- Outra questão relevante decorre de que para tempos razoáveis de registro, o intervalo de tempo de amostragem poderá vir a ser menor que o necessário para perceber qualquer mudança na resposta de pressão dentro da sensibilidade do registrador. Assim, poderão ser registrados conjuntos de dados com mesmo valor na resposta de pressão (repetição de dados).
Em consequência dos fatores acima, convem realizar uma compressão do volume de dados pela amostragem de um conjunto representativo de pontos limitando-os a poucas centenas. Tal processo deve reduzir o número total de pontos mantendo a proporcionalidade entre os diversos regimes de comportamento apresentados e sem descaracterizar a resposta de pressão.
Como normalmente as maiores variações ocorrem no início de um período de teste e a maioria dos métodos de interpretação utilizam escalas logarítmicas no tempo (consequência do caráter logarítmico da resposta de pressão radial), torna-se óbvio que a compressão logarítmica dos dados seria a mais adequada. Adicionalmente deve ser utilizado um critério de variação de pressão com o intuito de garantir uma boa representatividade onde ocorrerem mudanças na tendência de comportamento da pressão (mudanças bruscas de vazão no poço, regiões de mudança de regime de comportamento, etc.).
3.3	- Diagnóstico ou Modelagem:
O primeiro passo, propriamente dito, na análise dos dados de um teste de pressão, é a identificação do modelo poço-reservatório a utilizar. Tal concepção é bastante recente e advem dos grandes esforços desenvolvidos durante os últimos anos na obtenção de modelos matemáticos que representassem as diversas condições de poço e reservatório encontradas na prática. Para que possamos aplicar um modelo aos dados de pressão contra tempo obtidos no poço e consequentemente obter os
parâmetros de reservatório desejados, precisamos identificar qual o modelo que melhor representa a formação testada.
Isto é feito convencionalmente através de um gráfico do logaritmo da variação de pressão e de sua derivada contra o logaritmo do tempo e baseia-se nas características peculiares (formato das curvas) apresentadas por cada modelo ao longo do tempo. Assim, identificando qualitativamente cada uma das características presentes e aliando-se a isso informações geológicas da área, é possível identificar os modelos possíveis e muitas vezes o mais provável.
Recentemente, tem sido desenvolvido o uso dos conceitos de inteligência artificial no reconhecimento dessas características peculiares como alternativa automatizada do processo de diagnóstico dos dados de teste.
A identificação dessas peculiaridades baseia-se, além das características do reservatório, no fato de que o peso do efeito das condições de poço, do próprio reservatório e dos seus limites variará em função do tempo. Assim, a resposta de pressão é convencionalmente dividida em períodos como segue:
3.3.1	- Resposta de curto tempo:
Para os tempos iniciais, a perturbação introduzida no sistema (alteração da vazão) ainda não se propagou pelo reservatório, sendo a resposta de pressão dominada principalmente pelos efeitos da descompressão ou compressão dos fluidos no poço ou dos regimes de escoamento numa fratura hidráulica existente. Tais efeitos podem também se sobrepor, mascarando a identificação de suas características peculiares.
Como exemplos mais comuns do aspecto gráfico da resposta obtida, podem-se citar:
Modelo	Regime	Aspecto gráfico
Homogêneo	Estocagem no poço	Reta de inclinação 1 nas curvas de pressão e derivada.
Fratura hidráulica de condutividade infinita	Escoamento linear	Reta de inclinação 1/2 nas curvas de pressão e derivada.
Fratura hidráulica de condutividade finita	Escoamento bilinear	Reta de inclinação 1/4 nas curvas de pressão e derivada.
3.3.2	- Resposta de tempos intermediários:
Decorrido um tempo suficientemente longo, de tal forma que os efeitos das condições de poço e vizinhança percam sua relevância na resposta e ainda não tenham sido alcançadas quaisquer das condições limites do reservatório, a resposta de pressão será basicamente dominada pelas características do escoamento de fluidos na rocha reservatório e ter-se-á o comportamento puro do transiente de pressão no reservatório. Este é o período que permite a determinação mais precisa dos parâmetros desejados.
Como exemplos mais comuns, podem-se citar:
Modelo	Regime	Aspecto gráfico
Homogêneo	Escoamento radial	Patamar nas curvas de pressão e derivada
Fraturas hidráulicas	Escoamento pseudoradial	Patamar nas curvas de pressão e derivada
Dupla porosidade	Escoamento radial nas fissuras	Patamar nas curvas de pressão e derivada
Dupla porosidade	Escoamento radial fissuras + matriz	Patamar nas curvas de pressão e derivada
3.3.3	- Resposta de tempos longos:
Se o tempo foi suficiente longo para serem atingidos os limites do reservatório, estes passarão a influenciar a resposta de pressão do reservatório.
A identificação destas características poderá fornecer informações relevantes sobre o volume e o mecanismo do reservatório.
Como exemplos mais comuns, podem-se citar para um período de
fluxo:
Limite	Regime	Aspecto gráfico
Fechado	Escoamento pseudo-permanente	Comportamento ascendente nas curvas de pressão e derivada.
Aquífero	Escoamento permanente	Patamar na curva de pressão e comportamento decrescente na curva da derivada
3.3.4	- Respostas de transição:
Entre os períodos de resposta já citados podem ocorrer períodos ou regiões de transição com duração bastante variada e algumas vezes até imperceptível. Nesses períodos, tem-se uma gradativa diminuição da influência do regime de comportamento antecessor e uma crescente influência do regime posterior. Tais regiões podem ser úteis na identificação de alguns modelos.
Como exemplo mais comum, pode-se citar:
Modelo	Regime	Aspecto gráfico
Dupla porosidade	Transição	Ponto ou região de mínimo na derivada
4 - ANALISE POR CURVA TIPICA
4.1	- Visão Geral:
Esta técnica parte do princípio de que as variáveis adimen si onais, utilizadas nos diversos modelos, são funções lineares da variável adimensionalizada, como os exemplos abaixo. Assim, aplicando o logaritmo sobre a expressão de adimensionalização, tem-se que os valores dos logaritmos das variáveis dimensionais e adimensionais diferirão entre si por uma constante. Como consequência, quando traça-se o gráfico das respostas de pressão contra tempo de um dado modelo, os formatos das curvas dimensional e adimensional serão idênticos e a diferença entre os valores das coordenadas gráficas de seus pontos corresponderão a uma translação de seus eixos.
fik t	kh (pi - pwf)
tD“&amp;lt;j&gt;pctrw2	P"ü " a q B p
Desta forma, podem-se construir famílias de curvas típicas a partir da solução adímensional de um dado modelo e da escolha adequada das expressões adimensionais para cada eixo do gráfico e para a caracterização de cada curva típica traçada. Como os dados de teste são compostos de pontos de pressão contra tempo, consequentemente serão utilizadas, nos eixos gráficos, expressões dimensionais derivadas desses dados e compatíveis com as expressões adimensionais das curvas típicas.
Para então efetuar a análise dos dados de um teste utilizando curvas típicas, traça-se um gráfico log-log desses dados utilizando como coordenadas, variáveis ou expressões dimensionais compatíveis com as expressões adimensionais utilizadas nos eixos gráficos da família de curvas típicas. A seguir, sobrepondo o gráfico dos dados
a família de curvas típicas, procura-se obter o melhor ajuste dos pontos de dados a urna das curvas típicas. Procura-se o ajuste pela movimentação do gráfico nos sentidos horizontal e vertical, ou seja, mantendo paralelos os eixos do gráfico de dados e do gráfico da familia de curvas típicas. Após obter-se a melhor ajustagem, escolhe-se um ponto qualquer (ponto de ajuste) comum aos dois gráficos, identificam-se suas coordenadas e tomam-se também os valores adimensionais característicos da curva típica identificada na ajustagem. Em seguida utilizando as expressões de adimensionalização dos eixos e da caracterização da curva típica, e substituindo os valores identificados no processo de ajuste, calculam-se os parâmetros desejados.
4.2	- Breve Histórico:
Em 1935, TheisO) elaborou uma curva típica com base na solução de fonte linear para o estudo de aquíferos.
Em 1949, Van Everdingem e Hurst(2) elaboraram um conjunto de curvas típicas.
Em 1970, Agarwal, Al-Hussany e RameyO) elaboraram um conjunto de curvas típicas para aplicação em poços de petróleo. O modelo considerava o reservatório homogêneo infinito com poço de raio finito e incluía os efeitos de estocagem e de película separadamente, no traçado das curvas típicas, tendo nos eixos gráficos os valores de (pwD) e (td). Isto exigiu um número grande de curvas para representar um razoável conjunto de combinações de estocagem e efeito de película.
Em 1974, Earlougher e Kersh(^) introduziram o grupo (Cü.e^S), permitindo a caracterização das curvas típicas com um único termo combinando estocagem e película, o que possibilitou uma melhor discretização da solução. Esta família de curvas típicas utiliza nos eixos gráficos os termos (p^oCn/to) e (íd/Cd).
Em 1975, Ramey, Agarwal e Martin(^) elaboraram 3 famílias de curvas típicas para o modelo de poço não surgente ("slug test") com efeitos de estocagem e película. Essas curvas típicas também utilizam o termo (CD.e^S) para caracterizar as curvas e os termos (pwü) e (íd/Cd) nos eixos gráficos.
Em 1978, Gringartem e outro s( 6) elaboraram curvas típicas utilizando os mesmos termos para representar modelos poço-reservatório homogêneo e com presença da fratura hidráulica vertical.
Em 1979, Tiab e Crichlowí?) introduziram o uso da derivada de pressão como curva típica auxiliar na caracterização de modelos de reservatório.
Em 1983 e 1984, Bourdet e outros(^) e (9) desenvolveram curvas típicas utilizando a combinação num mesmo gráfico das curvas de pressão e da derivada de pressão no tempo, permitindo uma melhoria na unicidade do ajuste. Para caracterização tanto da curva de pressão como da derivada, foi utilizado o termo (Cü.e^S), para o eixo dos tempos foi usado o termo (tD/Cn) e para o eixo de pressão e derivada, os termos (pwD) e (pwD1) respectivamente. Foram desenvolvidas curvas típicas para os modelos de reservatório homogêneo e de dupla porosidade. Esta última incluía curvas adicionais para avaliação dos termos auxiliares X e co.
Em 1988, Onur e ReynoldsOO) introduziram o emprego do grupo (pwD/2pwD'J como alternativa ao termo (p«d') (curva da derivada). Isto permitiu dividir o processo de ajuste em duas etapas distintas (horizontal e vertical), reduzindo a subjetividade e acelerando o processo.
Em 1989, Peres, Onur e ReynoldsOV) apresentaram o uso da integral de pressão e do termo tAp para análise do modelo de poço com fluxo não surgente ("slug test") utilizando as diversas modalidades de curvas típicas já desenvolvidas para pressão e derivada do modelo de poço surgente.
4.3	- Vantagens e Limitações:
O emprego desta técnica na avaliação de testes de pressão em poços possui algumas vantagens significativas como descrito a seguir:
-	Capacidade de ajustar simultaneamente todos os períodos de comportamento de pressão, já que as curvas típicas são construidas incluindo a resposta dos períodos de curto tempo (estocagem, escoamento linear, escoamento bilinear), as zonas de transição e a resposta de longo tempo (escoamento radial ou pseudo-radial). Algumas famílias de curvas típicas ainda incluem a discretização da resposta dos limites do reservatório. Desta forma é possível na maioria dos casos, determinar quantitativamente todos os parâmetros que influenciam a resposta do modelo.
-	Outro ponto positivo reside na sua característica de elevada interação com o técnico, permitindo flexibilidade na escolha e ponderação dos pontos e regiões mais significativas para o ajuste.
-	Como já foi visto no capítulo anterior, a preparação dos dados para utilização nessas curvas aliada ao conhecimento do formato das respostas de pressão, nas diversas regiões de comportamento para os vários modelos conhecidos, permite o diagnóstico do modelo mais apropriado para a análise quantitativa.
Contudo, como é um método bastante dependente de processos visuais, possui algumas limitações relevantes ao seu emprego como técnica final de análise:
-	Como decorrência da utilização de escala logarítmica, tem-se visualmente acentuadas quaisquer oscilações nos dados para tempos curtos ou variações de pressão pequenas e mascaradas as oscilações dos dados nos tempos longos ou variações de pressão grandes. Assim a ajustagem de uma curva típica na primeira área citada enfrentará uma possível dispersão dos pontos de dados e na segunda área uma perda de sensibilidade da resposta de pressão.
-	A maior ou menor facilidade em ajustar dados em uma família de curvas típicas será dependente do "caráter" da curva típica, ou seja, do contraste no formato da curva entre os períodos da resposta de pressão e entre uma curva típica e outra. Desta forma , em curvas típicas que não possuam um bom "caráter”, o ajustamento gráfico será fortemente dependente da opinião subjetiva do técnico que a está executando.
-	Na construção de uma família de curvas é necessário adotar um conjunto discreto de valores dos parâmetros do modelo que caracterizam a curva típica. Assim, a cada curva da família correspondem determinados valores desses parâmetros e por razões de visualização, só pode ser colocado um número limitado de curvas típicas por gráfico. Como consequência, teremos uma solução discreta quanto a esses parâmetros, tomando a ajustagem obtida numa dada curva típica, uma solução aproximada por essência da própria metodologia. Quanto maior o número de parâmetros do modelo, mais difícil será discretizar e compor um bom intervalo de representação da solução em forma de uma família de curvas. Em alguns modelos, chega-se a recorrer a utilização, num mesmo gráfico de famílias diferentes de curvas para grupos de parâmetros e períodos da solução, com consequente prejuízo visual e dificuldade no processo de ajuste.
-	As curvas típicas são normalmente geradas a partir da solução para um período de fluxo e a sua utilização na interpretação de períodos de estática envolve considerações de aplicabilidade e transformações na expressão dimensional derivada do tempo. Tal prática, acrescenta insegurança ao processo e na maioria dos casos, uma aproximação adicional da solução.
Os fatos indicados acima mostram uma incerteza na validade do emprego das curvas típicas como técnica final de análise quantitativa. Não obstante, podemos ver
que trata-se de uma ferramenta bastante útil no diagnóstico e validação de modelos e como uma forma de estimativa dos parâmetros de reservatório.
Desde o início da utilização desta técnica, têm sido feitos esforços para sobrepujar as limitações descritas e para modelar a maior variedade possível de condições poço-reservatório. Um grande passo, na acuidade das curvas típicas, foi dado com o advento da utilização da curva de derivada de pressão ou seus termos compostos em conjunto com a própria curva de pressão. Com isto melhorou-se o "caráter" das curvas, seja pelo ajuste de uma informação a mais (a derivada), bem como pelo "caráter" marcante desta em função de sua grande sensibilidade a variação de pressão.
Atualmente, os dois padrões de curvas típicas mais utilizados são os aqui intitulados como método da Derivada e método de Onur. Nas seções seguintes, veremos os respectivos processos de utilização para dados oriundos de um fluxo em poço surgente.
4,4	- Método da Derivada:
Este método utiliza curvas típicas construidas em um gráfico de escalas logarítmicas, a partir da resposta adimensional de pressão no poço e sua derivada para os possíveis modelos. No caso de reservatório homogêneo, cada curva típica é composta na realidade de duas curvas, a primeira traçada a partir dos valores de (pwi&gt;) contra (íd/Cd) e a segunda de (pwn') contra (Id/Cd), sendo ambas caracterizadas pelo respectivo valor do termo (Cd.c^S).
Os passos para utilização são os seguintes:
- A partir dos dados registrados no teste, traça-se um gráfico log-log da variação de pressão contra o tempo (Ap) e de sua derivada em relação ao logaritmo natural do tempo (Ap'). A obtenção da derivada dos dados de testes
é feita numericamente, o que implica em certos cuidados. A utilização dos pontos imediatamente vizinhos para esse cálculo tende a amplificar os possíveis ruídos existentes, fazendo com que algum trecho ou até toda a derivada se apresente como uma nuvem de pontos dispersos, impedindo assim sua utilização prática na análise. Com a finalidade de evitar esse problema, deve ser utilizado um processo de cálculo numérico que permita suavizar os efeitos desses ruídos. Entre as diversas possibilidades, o mais corriqueiramente empregado é o algoritmo utilizado por Bourdet(S) que calcula a derivada centrada no ponto pela ponderação das derivadas posterior (direita) e anterior (esquerda), em relação aos seus respectivos intervalos, e adotando-se um passo variável crescente até a obtenção da suavidade desejada.
-	Sobrepondo-se o gráfico construído no item anterior ao gráfico da família de curvas típicas busca-se o melhor ajuste simultâneo das curvas de (Ap) e (Ap') contra as curvas de (p*») e (p«D*) dentre as existentes. O processo de ajuste é feito pela movimentação horizontal e vertical relativa dos dois gráficos (mantendo-se sempre paralelos os eixos de ambos os gráficos).
-	Feito o ajuste, identifica-se o valor do grupo (CD.e^S) correspondente à curva típica onde os dados foram melhor ajustados. Em seguida, escolhe-se um ponto qualquer da área gráfica comum aos dois gráficos e obtêm-se os respectivos valores das abcissas e ordenadas.
-	De posse dos valores acima e de outros parâmetros de fluido, rocha e poço, calculam-se os parâmetros desejados como segue:
aqBp [Pwd]m
h [aP1m
K =
gkh [At]M
p. [ti)/Ci)]M
S = T‘"
2 n&amp;lt;|&gt; h ct rw2 0C
(Cd^)m
4.5	- Método de Onur:
Este método constitui-se numa variação do anterior. Nele, as curvas típicas são construidas de forma semelhante com substituição das curvas de derivada por curvas do grupo (pwo/2pwD'). Este novo grupo provoca o desacoplamento com a curva de pressão, além de fazer com que a sua escala esteja normalizada e portanto, possua o mesmo intervalo de valores da escala no gráfico dos dados. A partir deste fato, origina-se a grande vantagem do método que divide o processo de ajuste em duas fases distintas, primeiramente com o ajuste do novo grupo e em seguida com o ajuste da pressão.
Os passos para utilização são os seguintes:
-	Primeiramente determina-se, a partir dos dados de teste, os valores da variação de pressão (Ap) e do novo grupo (Ap/2Ap'), traçando-se as curvas correspondentes em um gráfico log-log. Para obtenção da derivada (Ap’) devem ser tomados os mesmos cuidados descritos no método anterior.
-	Em seguida, sobrepõe-se o gráfico dos dados ao gráfico da família de curvas típicas e faz-se coincidir a escala de (pwD/2pwo’) com a de (Ap/2Ap'). Então com movimentação exclusivamente horizontal do gráfico, procura-se o melhor ajustamento entre os grupos citados, identificando-se assim o valor do termo (Cp.e^S) de ajuste.
- Feito o ajuste horizontal, passa-se a movimentar o gráfico exclusivamente no sentido vertical até obter-se o melhor ajustamento entre a curva de (Ap) e a curva de (pwü) que possui o valor de (CD.e^S) identificado no passo anterior.
- Em seguida, escolhe-se um ponto qualquer da área gráfica comum aos dois
gráficos e obtem-se os respectivos valores das abcissas e ordenadas.
- De posse dos valores acima e de outros parâmetros de fluido, rocha e poço,
calculam-se os parâmetros desejados como segue:
K =
C =
aqBp [pwu]M h
[AP]M
qkh
[A1]M
[tD/Cp]M
S =
2 n
2 n ó h &amp;amp; rw2 „	_ ,
0 C ( Cd e )m
4.6	- Aplicação ao Modelo de Fluxo Não Surgente:
Com base nas relações obtidas na seção 2.6 entre os modelos surgente e não
surgente, obtemos:
_ kh I(Ap) pwCD a(24 C) p pí - po
, _ kh____________tAp
pw' r’ ~ a (24 C) p p&gt; - pa
t
onde: I(Ap) = f [pi - pwf(T)j dt
o
A partir das relações acima, conclui-se que é possível utilizar as curvas típicas para modelo de fluxo surgente na análise de dados de um fluxo não surgente.
Os processos de análise empregando os métodos da derivada e de Onur mantêm seus procedimentos, apenas com as seguintes alterações:
- Para o método da derivada, constrói-se o gráfico dos dados traçando as
curvas de [I(Ap)J e (tAp) contra o tempo em substituição às curvas de (Ap) e
- Para o método de Onur, elabora-se o gráfico dos dados traçando as curvas de
[I(Ap)J e [I(Ap)/2tAp] contra o tempo em lugar das curvas de (Ap) e (Ap/2A
- Os parâmetros desejados são agora obtidos a partir das seguintes expressões:
q (24 C) p (pi - po) [pwcp]M
h	[I(Ap)]M
OU
K =
q (24 C) p [to/Cp]M
h [Al]„
s =
1	2 n&amp;lt;|&gt; h ci rw2
yln -
4.7	- Utilização com Dados de um Período de Estática:
Normalmente, as curvas típicas são desenvolvidas para análise de períodos de fluxo e sua utilização em períodos de estática apresenta limitações. Diversos autores
avaliaram a aplicação e restrições do emprego dessas curvas típicas na análise de períodos de estática.
Uma observação geral é que para tempos de produção muito maiores que o tempo de estática, as curvas típicas podem ser aplicadas diretamente aos períodos de estática. RameyU^) sugeriu como regra prática considerar o limite de (At &amp;lt;O.ltp). Contudo, Gringarten e outrost1^), mostraram que para grandes valores do grupo (CD.e^S), as curvas típicas para fluxo poderiam ser utilizadas na análise de tempos de estática próximos ao tempo de produção.
Agarwal(14) apresentou uma nova relação para transformar os tempos do período de estática em tempos equivalentes de fluxo e assim permitir o uso das curvas típicas de fluxo na análise de estáticas:
tp . At
te =	\
tp + At
Esta relação é válida para fluxo radial e ausência dos efeitos de estocagem. Agarwal mostrou, através de exemplos numéricos que a relação acima também pode ser empregada em situações com estocagem quando seus efeitos são desprezíveis no momento do fechamento (tpü/CD &gt; 60).
4.8	- Utilização em Processamento Computacional:
A utilização dessa técnica com o auxílio de computadores permite, além da mecanização dos procedimentos, sobrepujar a característica de discretização da família de curvas.
Após o ajustamento feito pelos processos já descritos, pode-se realizar um aprimoramento iterativo dos parâmetros determinados através da atribuição de valores aos parâmetros adimensionais, geração da correspondente curva típica seguido de verificação e melhoria do ajuste.
A geração da curva típica para tal fim, é feita normalmente através da solução do modelo no campo de Laplace e então invertida numericamente para o campo real.
5 - ANALISE ESPECIALIZADA
5.1	- Visão geral:
Os métodos utilizados na análise especializada recebem esta denominação por estarem baseados em aproximações da resposta de pressão do modelo poço-reservatório em determinadas regiões de comportamento específico.
A partir da obtenção da solução aproximada nessas regiões, identificam-se funções de tempo e pressão que permitam quando traçadas em um gráfico, apresentar um comportamento linear. Assim, tomam-se os dados registrados no teste e aplicando as funções específicas de cada método, constrói-se a tabela de coordenadas gráficas do método. Traça-se então o gráfico e procura-se um conjunto de pontos que apresente comportamento linear, para o qual é traçada uma reta buscando o melhor ajuste possível.
Com o valor da inclinação da reta obtida e as coordenadas de pontos específicos da reta, obtem-se os valores dos parâmetros desejados com base em expressões derivadas da aproximação utilizada na concepção do método.
Há uma grande variedade de métodos na análise especializada, cobrindo condições específicas de diversos modelos poço-reservatório. Para efeito desta dissertação foram selecionados alguns métodos básicos derivados dos modelos apresentados no segundo capítulo.
Nas seções seguintes são descritas de maneira resumida, as técnicas de utilização de cada método selecionado na obtenção dos parâmetros de reservatório desejados.
5.2	- Período de Fluxo Surgente:
5.2.1	- Método de Drawdown:
Este método baseia-se na aproximação logarítmica da solução de longo tempo do modelo. De onde obtem-se;
qq B p	¿kA	ClÉ.'l	s 1
pwf-pi - 1.1513	+	J+1°8	k J	+ 1.1513
Assim traçando um gráfico de pwf contra log t, e a partir da inclinação (m) da reta obtida e do valor da pressão no tempo unitário (pi), extraido também sobre a reta, tem-se:
qqB p m h
S = 1.1513
5.3	- Período de Estática Após Fluxo Surgente:
5.3.1	- Método de Homer:
HomerO5) utilizou a aproximação logarítmica da solução de longo tempo aliada ao princípio de superposição da vazão (q) até o tempo de produção (tp) e a partir desse ponto com vazão nula, obtendo então:
pws — pi - 1.1513
q q B p kh
f
log
V
tp + At A At J
Assim traça-se o gráfico de pw» contra log [{tP + At)/At], e a partir da inclinação (m) da reta obtida, tem-se:
k= 1.1513
qqB p m h
Para um tempo de fechamento infinito, observa-se que:
lim
r tp + At
Então:
pws (At—&gt;») = pi
E obtem-se a pressão estática sobre a reta traçada no ponto com abcissa zero.
O fator de película é determinado a partir da pressão de fluxo no
instante do fechamento:
S = 1.1513
Pi -
m
-log
í k
(p p ct rv¿
	
	
5.4	- Período de fluxo não surgente:
5.4.1	- Método da Vazão normalizada:
Este método é uma forma aproximada de deconvolução. Peres e outros^1) aplicaram-na ao problema do "slug test”, obtendo:
I(Ap) pwf - po
1.1513
a (24C) p kh
k
&lt;$&gt; g Ct Tw*
s
1.1513
+
Assim traça-se um gráfico de [I(âp)/(pwf - po)] contra log t, e a partir da inclinação (m) da reta obtida e do valor sobre a reta correspondente ao tempo unitário (li ), tem-se;
k = 1.1513
q(24C)p
m h
S= 1.1513
5.4.2	- Método da Convolução:
Peres e outros(H) também aplicaram o princípio da convolução aos
dados do "slug test" , obtendo:
pwf - po	k n
/
10g (te) + lOg
k
♦ Pctrwj	e7
s
1.1513
O tempo equivalente (te), é dado por:
N
te = fj( tN+1 - tj ) bi+1
Pwf(t,-1) - Pwfftj)
onde:
bj+i =
pwf(tN+l) - po
Assim traça-se um gráfico de [I(Ap)/(pwf - po)] contra log t, e a partir da inclinação (m) da reta obtida e do valor sobre a reta correspondente ao tempo unitário (li ), tem-se:
a (24C) li
k= 1.1513	'	/
m h
	r li . ( k		
S= 1.1513	[«-’-‘‘«(onctiw J	- log	e7 &amp;lt;e 7J
5.5	- Período de Estática Após Fluxo Não Surgente:
5.5.1	- Método de Homer:
O método de Homer pode ser utilizado de forma aproximada no caso do "slug test" se a vazão durante o fluxo sofreu pouca variação. Calcula-se a vazão média através da expressão:
24C (p*iT - po)
&lt;*m=	tP
Procede-se então de forma idêntica a descrita no item 5.3.1, utilizando qm em substituição a q.
5.5.2	- Método de Corrêa:
CorreaO7) desenvolveu um método com base na solução de longo tempo para estática, o que implica que o tempo total da estática deverá ser bem maior que o tempo de fluxo. Como regra prática, adota-se 3 a 4 vezes o tempo de fluxo. Como citado em relação ao método de Horner, o método de Corrêa é
aplicável quando a vazão durante o fluxo manteve-se praticamente constante. Normalmente calcula-se a vazão pela expressão:
24C (pwff - po)
qm-
Traça-se o gráfico de pws contra [tp/(tp + At)], e a partir da inclinação
(m) da reta obtida, tem-se:
qqmBg
2 m h
Para um tempo de fechamento infinito, observa-se que:
Então:
pws (At—— pi
E obtem-se a pressão estática sobre a reta traçada no ponto com abcissa zero.
Este método não permite o cálculo do efeito de película.
5.5.3	- Método 1 de Peres ou Peres 1:
Peres e outrosí16) desenvolveram um método que considera a variação de vazão no período de fluxo. Com a aplicação do princípio de Duhamel e a discretização do fluxo em pequenos períodos de vazão constante (vazão média no intervalo) , obtem-se:
-^-=Pi. 1.1513 “WH-ag-p» t|
At h	k h tp '
onde:	{ ^'og
j=0
At
I(pws) = J pws^T) d T
0
Assim traça-se o gráfico de [I(pws)/At] contra tP e a partir da inclinação
(nij ) da reta obtida, tem-se:
k = 1.1513
q (24C) p í pwff -p0 m( h l tp
Para um tempo de fechamento infinito, observa-se que:
lim t| = 0
At—
Então:
I(pws)
At
(At-&gt;oo) - pi
E obtem-se a pressão estática sobre a reta traçada no ponto com abcissa zero.
O efeito de película é calculado a partir da expressão:
S = 1.1513 1


Pwf(tj+1,p) - pwíftj.p) pwff-po
N
-Z(tp -tj,P)
j=0
onde: pfm
5.5.4	- Método 2 de Peres ou Peres 2:
A partir das mesmas considerações do método anterior e assumindo que a vazão seja zero imediatamente após o fechamento para estática, obtem-se:
a (24C) p pwfr- po P*s-P’- kh 2tp b
N
, . xr' í f tP r p«f(tj+i,p) - pwf(tjiP) onde: t2 = j (V+At - tj,P Jx L p-tr-p.
j=0
Assim traça-se o gráfico de pwS contra t2, e a partir da inclinação (m2) da reta obtida, tem-se:
v _ a (24C) H ( pwfr - po
m2 h t 2 J
Para um tempo de fechamento infinito, observa-se que:
lim t2 = 0
At—
Então:
pWS (At—— pi
E obtem-se a pressão estática sobre a reta traçada no ponto com abcissa zero.
Este método não possui uma expressão própria para o cálculo do efeito de película, contudo, comparando-se a expressão de m2 com a expressão de mi do método anterior, obtem-se:
nu = nu . In 10
E consequentemente, pode-se utilizar a expressão do método 1 para o cálculo do efeito de película.
6 - ANÁLISE AUTOMATIZADA
6.1	- Visão Geral:
A utilização de computadores possibilitou grandes avanços na interpretação analítica de testes de pressão em poços, Um destes avanços vem da possibilidade de aplicação dos métodos de regressão não linear na determinação dos parâmetros de reservatório pelo ajuste dos dados registrados no teste a um determinado modelo previamente escolhido.
Esta técnica baseia-se na minimização dos resíduos entre os dados registrados no teste e a solução obtida a partir do modelo selecionado. Tais modelos analíticos aplicados ao processo de regressão têm dependência não linear dos parâmetros a serem determinados. Tem-se assim um processo iterativo de cálculo, partindo-se de uma estimativa inicial dos parâmetros e exercendo o controle através de uma tolerância de precisão previamente escolhida.
Com a evolução dos modelos poço-reservatório aplicados à análise de teste, obtiveram-se soluções consideravelmente complexas no campo de Laplace, com difícil transformação para o campo Real. Desta forma, passou-se a calcular a solução e as suas necessárias derivadas no campo de Laplace seguido de posterior inversão numérica para o campo real com a finalidade de aplicação aos métodos de regressão não linear.
Uma característica marcante desta metodologia em relação as demais, está no fato dela praticamente não depender de processos gráficos, Estes são utilizados apenas para visualizar o ajuste final obtido, ou também acompanhar os ajustamentos intermediários durante o processo iterativo. Esta apresentação em forma gráfica pode a princípio ser feita sob qualquer aspecto, contudo, a apresentação na forma de
curvas típicas tem sido a mais comumente utilizada. Tal escolha é interessante pelo caráter de diagnóstico dessas curvas e pela possibilidade de fazer uso conjunto das respostas das curvas de pressão e de derivada no processo de ajuste por regressão não linear.
Convém salientar que o termo análise automatizada refere-se à mecanização do processo de ajuste dos dados à solução analítica de um determinado modelo, cujo correspondente processo manual foi descrito no quarto capítulo e constitui a metodologia de análise por curvas típicas. É importante destacar o caráter restrito desta técnica, frente a potencialidade representada pelo que poderiamos intitular de análise automática de testes, necessariamente incluindo também a identificação, por processo mecanizado, do modelo poço-reservatório mais adequado aos dados. Na metodologia de análise automatizada, é indispensável a intervenção do técnico intérprete com a finalidade de indicar o modelo que será utilizado no processo. No terceiro capítulo, foi brevemente citada a aplicação recente das técnicas de inteligência artificial na identificação automática do modelo com base no "caráter" das curvas típicas.
6.2	- Breve Histórico:
Em 1966, Jahnsí19) utilizou conjuntamente a técnica de simulação numérica de reservatório e de regressão não linear para modelar dados de testes de interferência em um reservatório bidimensional, fazendo uso do critério de mínimos quadrados para ajustar os valores de transmissibilidade e estocagem dos blocos na malha de simulação.
Em 1970, Coats e outros^O) fizeram uso de uma técnica que compunha mínimos quadrados e programação linear para caracterizar um reservatório a partir do histórico de pressão.
Em 1972, Earlougher e Kerschf21) apresentaram um estudo em que empregavam a técnica de regressão não-linear na análise de testes de interferência e queda de pressão ("fall-off), a partir da solução da fonte linear para um reservatório infinito e da superposição de vazões para levar em conta a estocagem.
No mesmo ano, Hernandez e SwiftC22) apresentaram um algoritmo utilizando um método de pseudo-linearização e o critério dos mínimos quadrados para determinação dos parâmetros de reservatório.
Em 1974 Chen e outros&lt;23) realizaram um estudo comparativo de métodos de regressão não-linear ("Steepest Descent", Gauss-Newtom e Gradientes Conjugados) no ajuste de históricos de pressão em reservatório.
Em 1981, Rodgers e outros^24) fizeram uso da técnica de regressão não linear para estimar parâmetros de reservatório e sua extensão em modelos limitados com efeito de película conhecido e ausência do efeito de estocagem.
Em 1983, Rosa e Hornel25) apresentaram uma técnica para análise de dados de testes utilizando regressão não-linear aplicada a solução no campo de Laplace para modelos de reservatório com estocagem e efeito de película, invertida para o campo Real com uso do algoritmo de Stehfest. Foram feitas comparações entre os diversos métodos de regressão e ressaltada a abrangência da técnica pela maior facilidade de obtenção de soluções analíticas no campo de Laplace.
Em 1984, Guillot e Hornel26) apresentaram uma técnica envolvendo dados de pressão e vazão na face da formação, registrados simultaneamente, para determinação dos parâmetros de reservatório.
Em 1987, Barua e Horneí27) fizeram um estudo da aplicação do método de Gauss-Marquardt para determinação dos parâmetros de reservatórios submetidos a processos térmicos de recuperação como injeção de vapor e combustão "in situ".
Em 1988, Barua e outrosí28), sugeriram a utilização do método de decomposição espectral ou método de Greenstadt na análise de testes utilizando regressão não-linear, como forma de obter maior robustez quanto a estimativa inicial na solução de modelos com mal condicionamento acentuado dos parâmetros.
Nesse mesmo ano, Namba e Horneí29) sugeriram a utilização da fatorização de Cholesky e a modificação de Gill e Murray como forma de obter maior robustez nos métodos de Newton e Gauss aplicados a análise de testes.
Em 1989, Vidal e Corrêa^30), apresentaram a técnica de regressão não-linear aplicada à análise de testes de pressão em poços não surgentes com solução do modelo no campo de Laplace e inversão para o campo real utilizando os algoritmos de Stehfest e Crump.
Ainda em 1991, Rosa e Horneí31), sugeriram a utilização do valor absoluto como função alternativa aos mínimos quadrados no ajuste automatizado dos dados de testes de pressão, ressaltando o benefício obtido em relação a estimativa inicial e a presença de ruídos nos dados.
6.3	- Vantagens e Limitações:
Os pontos positivos desta metodologia podem ser resumidos como segue:
-	Ajuste simultâneo de todas as regiões da resposta de pressão, evitando problemas de inconsistência entre os parâmetros obtidos quando efetuando a interpretação a partir de cada região particular (procedimento da análise especializada).
-	Possibilidade de estimar parâmetros a partir de um conjunto restrito de dados, como os casos onde não foi alcançado o regime radial, ou ainda da
resposta de pressão em regiões de transição, o que não seria possível pelos procedimentos convencionais.
-	Capacidade de fixar o grau de precisão com que os parâmetros serão estimados e de avaliar estatisticamente a qualidade do ajuste, através da determinação dos intervalos de confiança dos resultados.
-	Flexibilidade na escolha dos parâmetros que serão ajustados a partir de um dado modelo de reservatório, permitindo que o processo de interpretação se ajuste aos dados disponíveis no momento.
-	Possibilidade de interpretar dados de testes utilizando modelos de reservatório e condições de poço complexos, para os quais seria difícil elaborar um conjunto de curvas típicas ou obter um processo prático de análise especializada.
Esta técnica apresenta algumas limitações ligadas ao modelo poço-reservatório selecionado, o conjunto de dados e o método numérico utilizado:
-	Alguns modelos poço-reservatório mais complexos podem apresentar mínimos locais ou pontos de sela na função de minimização (função objetivo). Desta maneira, dependendo da estimativa inicial utilizada para os parâmetros a determinar, poder-se-á ter um processo de convergência muito lento ou, o que seria ainda mais prejudicial, uma convergência para um mínimo incorreto com consequente imprecisão na determinação dos parâmetros.
-	Modelos mais complexos normalmente possuem uma quantidade maior de parâmetros a determinar e no caso dos modelos de análise de testes, esses parâmetros muitas vezes são mal definidos, o que leva a um mal condicionamento do sistema utilizado no processo de regressão não-linear com graves problemas de convergência ou até com a impossibilidade de
alcançá-la. Assim, torna-se importante a escolha adequada do método de regressão que possua a robustez necessária para superar o mal condicionamento porventura existente. Cabe ainda lembrar que quanto maior o número de parâmetros a determinar maior será o custo computacional do processo e que métodos mais robustos implicam normalmente em maior tempo de processamento.
- Outra limitação está ligada ao fato de que os modelos poço-reservatório em análise de teste possuem uma seletividade na influência dos parâmetros para cada região da resposta de pressão. Assim, quando estiver sendo utilizado um conjunto restrito de dados que não abrange todas as regiões de resposta do modelo escolhido e parte dos parâmetros a determinar apenas influenciam significativamente as regiões de resposta não abrangidas pelos dados, teremos dificuldades de convergência no processo e problemas de precisão em relação a esses parâmetros (insensibilidade de parâmetros do modelo em relação ao conjunto de dados). Tal situação deve ser considerada como uma má escolha do modelo poço-reservatório.
Como um dos principais problemas da análise automatizada está ligado a estimativa inicial dos parâmetros e como a proximidade dessa estimativa em relação ao resultado final contribui para um menor custo computacional do processo, conclui-se que deve-se, sempre que possível, utilizar os resultados de uma análise feita com curva típica ou de métodos de análise especializada como estimativa inicial. Neste trabalho foi implementada a combinação da análise por curvas típicas com a análise automatizada. Desta forma, o resultado de um ajuste preliminar numa família de curvas-típicas é utilizado como estimativa inicial para o processo de análise automática.
Nas próximas seções serão apresentados os métodos de regressão mais utilizados com suas características peculiares de aplicação.
6.4	- Formulação Matemática:
No processo de regressão não linear aplicado à análise de testes, busca-se os valores desconhecidos do conjunto de parâmetros característicos de um determinado modelo que minimizem uma "função objetivo" aplicada aos resíduos entre os dados de testes e a resposta de um modelo previamente selecionado. Convencionalmente, utiliza-se o somatório do quadrado dos resíduos como função objetivo, denominado como método dos mínimos quadrados. Contudo, atualmente têm sido pesquisadas funções alternativas como o valor absoluto do resíduo, que segundo Rosa e Horne apresentam melhores resultados quando a estimativa inicial encontra-se longe dos valores reais ou existem ruidos nos dados.
Para efeito desta dissertação foi adotado o critério dos mínimos quadrados como função objetivo. A seguir é descrita a formulação básica que constitui o método de Newton, de onde são derivados todos os demais métodos:
Seja a função resíduo:
f ( c?) = y¡ - F ( õ?,xí )
E a função objetivo (mínimos quadrados):
m
e(õ?)=£[f( o?) r
i—1
onde: m - número de medidas registradas no teste para ajuste.
xí - tempo em que foi registrado o dado i.
y¡ - pressão registrada correspondente ao tempo xi. õ? - vetor do parâmetros do modelo poço-reservatório. F( õ?,xí ) - resposta de pressão do modelo no tempo xi.
Fazendo-se a expansão em série de Taylor a partir de uma estimativa inicial do conjunto de parâmetros (õ?°) e truncando após os termos de segunda ordem, tem-se:
3E(õfo)
3 a?
ri
32 E ( õ?°)
J	*
j-1
onde: E (õ^1) - Aproximação de Newton para a função objetivo.
n - número de parâmetros do modelo na regressão.
A série obtida é função apenas dos termos (a1 - a°). Seu mínimo é obtido derivando-se a função em relação a cada um desses termos e igualando-se as derivadas a zero. Após os devidos rearranjos, têm-se, em notação matricial, o sistema de equações que fornecerá os valores dos termos (a1 - a°):
[ J (õfy T J ( «*) + f(ct) H (õfy ] ô ( a*) = - J ( tf) T f ( tf)
onde: f - função resíduo.
J - Matriz jacobiana contendo derivadas de primeira ordem de f.
H - Matriz hessiana contendo derivadas de segunda ordem de f.
5 - Variação dos parâmetros em relação a estimativa anterior.
ou representando de forma simplicada:
AÔ B
Após a solução do sistema, obtem-se os novos valores dos parâmetros desejados como segue:
&lt;Xj' =&amp;lt;Xj° + Ô (ctj) ; j = 1,n
O processo acima descrito é repetido iterativamente até que os valores estejam dentro de uma tolerância previamente escolhida.
Com a finalidade de evitar problemas de divergência durante o processo iterativo, pode-se utilizar um algoritmo de busca linear que garanta a minimização da função objetivo. Os novos valores dos parâmetros são obtidos da seguinte forma :
a/ = 0Cj°+p 8 (a,) ; j = l,...»n
onde: p - tamanho do passo de atualização dos parâmetros.
6.5	- Método de Newton:
A formulação apresentada na seção anterior constitui o próprio método de Newton.
A utilização prática desse método não é corriqueira em função de algumas dificuldades e desvantagens encontradas, descritas a seguir:
-	O valor para o qual a solução converge pode não ser um ponto de mínimo. Isso decorre da incerteza de que a matriz [A] seja positiva-definida e no caso da função objetivo possuir pontos de máximo ou de sela, a convergência poderá se dar em direção a esses pontos dependendo da estimativa inicial utilizada. Para garantir que a matriz [A] seja positiva-definida, a estimativa inicial deverá estar nas vizinhanças do ponto de mínimo.
-	O método de Newton exige o cálculo das derivadas de segunda ordem da função resíduo, o que para modelos mais complexos acarretará uma considerável dificuldade em obtê-las. Adicionalmente, teremos um custo computacional crescente com a complexidade do modelo.
6.6	- Método de Gauss ou Gauss-Newton:
No caso da estimativa inicial encontrar-se nas vizinhanças do ponto de mínimo da função objetivo, o que significa que o resíduo [f (oí) ] está próximo a zero, é possível desprezar o termo [f H] do sistema de solução quando comparado ao termo JT J. Desta maneira, o sistema fica reduzido a:
[j(cí)T J ( ÕÍ) ] S ( õí) = -J( cí)T f(õí)
O que é equivalente a resolver o problema:
Minimizar [ J ( õí) S(õí) - f ( oí) ]
O qual possui uma única solução desde que [ J (oí) ] seja inversível.
As vantagens desse método podem ser resumidas como segue:
-	Através da simplificação utilizada, garante-se a condição de positiva-definida da matriz [A], implicando na convergencia para um ponto de mínimo.
-	A implementação do método torna-se mais simples, principalmente em modelos complexos, pela ausência da necessidade de serem determinadas as derivadas de segunda ordem da função residuo.
-	Obtem-se urna queda significativa do custo computacional pela redução dos cálculos necessários em cada iteração.
Contudo, o método de Gauss-Newton apresenta algumas limitações ligadas a sua concepção e ao sistema de solução:
-	Em situações onde a estimativa inicial não esteja localizada nas vizinhanças do ponto de mínimo, não será válida a hipótese de resíduo próxima a zero e
consequentemente, o termo [f H] não será desprezível. Desta forma, poderão haver problemas de convergência lenta ou até de divergência.
- Nos problemas de análises de testes é comum ter-se interdependência entre os parâmetros a determinar, o que implica num mal condicionamento da matriz. Assim, poderão ocorrer problemas de singularidade da matriz [A] durante o processo iterativo.
6.7	- Método de Gauss-Marquardt ou Levemberg-Marquardt:
Este método é uma variação do método anterior, sugerida por Marquardtí32) onde procura-se superar os efeitos de mal-condicionamento do sistema de solução pela adição de um número real positivo (X) aos elementos da diagonal principal da matriz [A], Essa alteração incrementa os autovalores da matriz [A], fazendo com que seus valores não sejam nulos ou muito pequenos e evitando assim problemas de singularidade.
Assim a expressão matricial do sistema de solução passa a ser:
[ J ( õf)T J(õ?) + Xl] S( õ?) = -J(õ?)T f(õ?)
onde: X - constante de regularização do sistema,
I - Matriz identidade.
Marquardt sugere como valor inicial para o processo (X = 0.01), sendo que em cada iteração verifica-se o comportamento da função objetivo em relação a iteração anterior. Caso haja diminuição no valor da função, a constante (X) deverá ser reduzida por um fator de valor 10, ou seja, o valor de (X) para a próxima iteração será (X/10) . Em caso contrário, passará a ser (10X). Cabe salientar ainda, que no caso da constante (X) atingir valores muito pequenos, o processo tende a se tomar equivalente ao método de Gauss-Newton.
Este método melhora a robustez do processo quanto a estimativa inicial, contudo, apresenta uma convergência geralmente mais lenta do que o método anterior nos problemas de análise de testes. Sua grande vantagem reside em evitar os problemas de singularidade do método de Gauss-Newton através de uma modificação de fácil implementação e com baixíssimo custo computacional.
O mesmo enfoque pode ser aplicado ao método de Newton, sendo que neste caso o valor de (X) deverá ser escolhido de modo a garantir a condição positiva-definida da matriz [A], o que corresponde a ter todos os seus autovalores positivos. Contudo, continua-se com o problema da dificuldade e alto custo computacional no cálculo da matriz hessiana da função resíduo.
6.8	- Método de Gauss-Greenstadt-Barua ou SVD:
Greenstadt apresentou um método com a finalidade de garantir a condição de positiva-definida da matriz [A] no método de Newton. Tal enfoque baseia-se na decomposição espectral da referida matriz e na alteração dos autovalores negativos, nulos ou muito pequenos. A decomposição corresponde a:
[A] -
k=l
onde: X^ - autovalores da matriz.
- autovetores correspondentes.
Como a matriz [A] é simétrica, todos os seus autovalores serão números reais e portanto, tornar-se-á possível identificar a existência de qualquer autovalor negativo, nulo ou muito pequeno. Um autovalor negativo indica que há um dos vetores de busca maximizando a função objetivo na direção do seu correspondente autovalor. Um autovalor nulo ou muito pequeno indica insensibilidade do modelo a um dos parâmetros envolvidos na regressão, o que é bastante comum em análise de testes, onde existem parâmetros cujos efeitos são significativos apenas em algumas regiões
ÍÍBI.IOTECÁ DJ XRFÍ BP fflímnri
da resposta de pressão. Se o conjunto de dados não contém pontos nessas regiões, estará caracterizada uma situação de insensibilidade ao parâmetro.
Garantir que todos os autovalores sejam positivos implica em que a matriz [A] será positiva-definida. Assim, foram definidas duas formas de alteração dos autovalores indesejáveis. A primeira, que será intitulada de modalidade (a), consiste em substituir os autovalores negativos por seu valor absoluto e autovalores nulos ou muito pequenos por um valor tendendo para infinito (muito grande). Isto equivale a anular o efeito dos autovalores muito pequenos e corrigir a direção dos autovalores negativos.
A segunda maneira, chamada modalidade (b), consiste em substituir todos os autovalores menores que um determinado número por um valor que tende para infinito. Desta forma, anulam-se os efeitos tanto dos autovalores negativos como dos nulos ou muito pequenos. Esta modalidade, segundo os autores, apresentou maior robustez e rapidez de convergência em relação a modalidade (a).
Para aplicar-se esta técnica ao método de Gauss, procede-se semelhantemente, identificando os autovalores indesejáveis e substituindo-os por um valor positivo grande. Assim evitam-se as dificuldades de mal condicionamento da matriz com consequentes problemas de singularidade na resolução do sistema.
6.9	- Normalização do Sistema de Solução:
Uma técnica auxiliar para melhorar o condicionamento do sistema de solução e que pode ser utilizada em qualquer dos métodos de regressão é a normalização do sistema. O processo consiste inicialmente em modificar os valores dos elementos das matrizes [A] e [B] do sistema utilizando as seguintes relações:
A seguir resolve-se o sistema agora normalizado e o vetor de solução é convertido de acordo com a expressão a seguir:
A restrição óbvia à aplicação desta técnica é que todos os elementos da diagonal principal na matriz [A] devem ser números positivos.
6.10	- Busca Restrita dos Parâmetros:
Como já foi citado na seção 6.4, utiliza-se um passo de atualização dos parâmetros de regressão entre as iterações com a finalidade de evitar problemas de divergência, garantindo a minimização da função objetivo.
Outro tipo de restrição está ligado ao intervalo de valores fisicamente aceitáveis para atribuição aos parâmetros de regressão. Existem diversas técnicas de otimização restrita baseadas na modificação da função objetivo ou na aproximação linear das restrições seguida da aplicação de um método de projeção. Tais técnicas envolvem os métodos das funções penalidades, das barreiras, do lagrangeano aumentado, da projeção direta e do lagrangeano projetado.
Para efeito desta dissertação foi adotado um algoritmo de busca para atender tanto aos problemas de divergência da função objetivo como as restrições de valores dos parâmetros de regressão. O algoritmo consiste inicialmente em verificar, para cada iteração, a adequação dos valores atualizados dos parâmetros com passo de 1.0 ao intervalo de restrição. Caso hajam valores fora do intervalo, é calculado um novo passo pela bisseção do intervalo de atualização até que os valores atualizados dos
parâmetros adequem-se aos seus respectivos intervalos de restrição. Numa segunda etapa, verifica-se a minimização da função objetivo em relação a iteração anterior. Caso tenha havido um aumento da função objetivo, procede-se a alteração do passo de forma idêntica a já citada até obter-se um valor da função objetivo inferior ao da iteração anterior. Em qualquer das etapas descritas, se o número de alterações de passo atingir uma quantidade previamente determinada, o processo de regressão será suspenso em condição anormal.
6.11	- Tratamento do Efeito de Película Negativo:
A utilização de efeito de película negativo pode provocar instabilidade ou até impossibilidade na inversão da resposta de pressão dos modelos no campo Laplace para o campo Real. Com a finalidade de evitar possíveis problemas desta natureza, utilizou-se o conceito de raio efetivo do poço durante o processo iterativo de regressão com posterior atualização após o final do processo. A expressão utilizada para cálculo do raio equivalente foi a seguinte:
rwe = rw e“S
6.12	- Intervalos de Confiança:
Uma das vantagens citadas na utilização da metodologia de análise automatizada consiste na possibilidade de avaliar estatisticamente a qualidade dos resultados obtidos. Isto é implementado através da determinação do intervalo de confiança de cada um dos parâmetros de regressão. O resultado da regressão é então expresso na forma:
«i ± Aotj ; j= 1,..., n
onde: Aa¡ - Intervalo de confiança do parâmetro j
Para o cálculo dos intervalos de confiança, pode ser utilizada a expressão apresentada por Rosa e Home&lt;25) e (31):
*1
8jj
onde: T5^;m.n - Valor da distribuição t-student para (100-8) % de confiança e (m-n) graus de liberdade.
E (	- Valor da função objetivo na última iteração,
ajj - Elemento j da diagonal principal de [A]*1.
No desenvolvimento do software foi adotada um confiança de 95 % na determinação do valor da distribuição de t-student.
7. O AMBIENTE WINDOWS
7.1	- Visão Geral:
O ambiente Windows é na realidade um padrão de interface gráfica com o usuario e também um ambiente operacional intermediário entre o sistema operacional básico do computador e as aplicações a serem utilizadas.
Como interface gráfica, o Windows permite uma interação mais adequada com o ser humano através de um conjunto padrão de objetos como janelas, menus, ícones e botões, o que possibilita ao computador representar de forma mais aproximada o comportamento humano ao lidar com tarefas, listagens e objetos.
Outra característica importante reside no fato de vencer uma limitação significativa dos sistemas operacionais básicos como o DOS, que possui parco suporte para saídas gráficas. O Windows através de seus recursos, permite a elaboração de gráficos e figuras com altíssimo nível de apresentação e grau de sofisticação.
Adicionalmente, o fato de ser composto de objetos padrões permite que ao familiarizar-se com uma aplicação, torne-se bastante rápido e fácil ao usuário a utilização de qualquer outra, o que não acontece com aplicações desenvolvidas diretamente para o DOS. Este último exige que cada aplicação forneça a sua própria interface, tendo como consequência a necessidade do usuário aprender um conjunto diferente de comandos para cada aplicação que utilizar.
Como ambiente operacional intermediário, o Windows incorpora a capacidade de executar diversas aplicações simultaneamente, enquanto o DOS foi construído para suportar a execução de urna única aplicação por vez. Tal característica permite aproveitar plenamente a potencialidade dos modernos processadores, a partir da linha
80386 e seus similares, transformando os microcomputadores em equipamentos de multitarefa, a semelhança dos grandes sistemas.
Adicionalmente, e em consequência da possibilidade de operar em multitarefa, o Windows possibilita a troca de informações diretamente entre as aplicações evitando a tradicional utilização de arquivos temporários, desta maneira flexibilizando e acelerando grandemente o processo.
Outra característica fundamental reside no fato de que as aplicações nesse ambiente têm sua estrutura e fluxo orientadas por eventos gerados pelo usuário, permitindo escolher e controlar os passos necessários para completar uma determinada tarefa, no que se assemelha bastante aos sistemas operacionais. Nas aplicações convencionais a estrutura e o fluxo é sequencial, ou seja, a sequência de execução de uma tarefa é ditada pelo programa.
A partir desta visão geral, podemos vislumbrar a imensa potencialidade desse tipo de interface. Nas seções a seguir veremos com mais detalhes, algumas dessas características.
7.2	- Breve Histórico:
A origem dos sistemas de interface gráfica com o usuário remonta as pesquisas realizadas pela Xerox a partir de 1970 no Palo Alto Research Center (PARC), de onde surgiram desenvolvimentos como impressão laser, redes locais, programação orientada a objeto e as já mencionadas interfaces gráficas.
Em 1981 a xerox lançou a "Star", uma estação de trabalho como o primeiro sistema de interface gráfica comercial, tornando-se assim um marco histórico desta tecnologia. Infelizmente, o alto preço impediu a difusão ampla dessa formidável inovação. Curiosamente nesse mesmo ano a IBM lançava o seu PC, que viria a mudar significativamente o panorama da informática comercial.
Em 1983, a Apple lança seu primeiro sistema de interface gráfica com o usuário, então denominado Lisa, e em 1984 lança o Macintosh que se tornaria o primeiro sistema de interface gráfica bem sucedido comercialmente.
A Microsoft iniciou seus trabalhos no Windows em 1983 e a primeira versão do software (1.01) foi lançada em 1985 com características que lembravam as interfaces gráficas oriundas da Xerox e da Apple. Essa versão foi desenvolvida para ser utilizada em um IBM PC com dois acionadores de disquetes, 256 KB RAM e processador 8088 da Intel. Possuía como característica marcante o ajuste automático lado a lado das janelas de programas, aceitando janelas sobrepostas na criação de diálogos.
A versão 2 foi lançada em 1987 e em função da insatisfação dos usuários quanto ao ajuste automático lado a lado da versão 1, essa versão vinha com as janelas sobrepostas. Outra inovação importante foi a possibilidade de utilização de memória expandida permitindo que uma quantidade maior de programas residissem na memória simultaneamente. Desta forma, a carência de memória sentida na versão 1 foi resolvida parcialmente, já que a versão 2 rodava apenas em modo real. Nesse mesmo ano foi lançado o OS/2 Presentation Manager, interface gráfica utilizada nos microcomputadores da linha PS IBM. A similaridade intencional do Windows com o OS/2 torna fácil a migração entre os dois sistemas.
O lançamento da versão 3 ocorreu em 1990 com um sucesso esmagador de venda. Entre as características incorporadas, tem-se o aspecto visual melhorado com fontes de caracteres proporcionais, molduras e objetos com aspecto tridimensional, além de programas acessórios redesenhados. O gerenciador DOS da versão anterior foi substituído pelos Program Manager (Gerenciador de Programas), Task List (Lista de Tarefas) e o File Manager (Gerenciador de Arquivos). Houve também um incremento significativo nas facilidades de programação.
Do ponto de vista interno, a versão 3 possibilitou a utilização da memoria extendida e quando executado em equipamento com processador a partir do 80386, em modo 386-Enhanced, permite a utilização de memória virtual de até 4 vezes a memória física instalada. Adicional mente foi melhorado o suporte para redes, possibilitada a apresentação de imagens com qualidade equivalente a dos sistemas de multimídia e foram implementadas facilidades de "Help" com hipertexto.
No próximo ano a Microsoft estará lançando a versão NT do Windows que traz como avanço mais significativo a portabilidade, permitindo suporte a aplicações DOS, Windows e Unix.
7.3	- Interface Gráfica com o usuário:
Uma vantagem significativa do Windows e de outras interfaces gráficas, em relação aos sistemas convencionais, repousa no fato da imagem exibida no monitor corresponder ao que será obtido na impressora. Desta forma, o usuário poderá ter uma idéia perfeita da apresentação de seu trabalho mesmo antes de imprimi-lo. Este conceito é conhecido como WYSIWYG ("What you see is what you get"). Tal capacidade vem preencher uma lacuna existente nos sistemas convencionais como DOS, o qual possui um suporte pobre a facilidades gráficas. No Windows, em função de seu alto potencial gráfico, podem ser elaborados gráficos e figuras com elevado padrão de apresentação e alto grau de sofisticação.
Outro avanço representativo deste tipo de interface está na consistência entre quaisquer aplicações Windows. Isto é possível em razão das aplicações desenvolvidas nesse ambiente terem sempre aparência e manipulação semelhantes. As aplicações são elaboradas utilizando um conjunto padrão de objetos, entre os quais temos: diversos tipos de janelas, ícones, menus, botões e campos de entrada. Assim, após o usuário aprender a utilizar uma determinada aplicação, torna-se rápido e fácil familiarizar-se com qualquer outra. Nos sistemas convencionais como o DOS, é de
responsabilidade da aplicação implementar a interface com o usuário e, como consequência, este geralmente necessitará aprender um conjunto diferente de comandos para cada aplicação a utilizar.
A interação do usuário com os objetos do Windows é bastante flexível e muito semelhante ao que o ser humano faria no desempenho de tarefas de escritório, lidando com listagens, arquivos e objetos. Ao invés de limitar-se a apertar teclas que serão em seguida exibidas na tela ou simbolizam a execução de alguma rotina, o usuário irá interagir diretamente com os objetos presentes na tela. Tais objetos gráficos do Windows podem ser movidos para qualquer posição e em alguns casos terem seus tamanhos ajustados. Botões podem ser "apertados" e janelas podem ser sobrepostas a semelhança de uma pilha de folhas, como numa mesa de trabalho, ou serem selecionadas aleatoriamente e colocadas sobre as demais. Uma aplicação ou janela pode ser transformada num ícone quando não utilizada para organizar a "área de trabalho" (tela), além dos recursos automáticos de organização providos pelo Windows.
Para os elaboradores de aplicação, o fato de existir um conjunto padrão de objetos também representa uma grande facilidade, já que os mesmos não dispenderão esforço em programar os objetos bem como suas funções de manipulação, e se o fizessem, talvez não conseguissem a mesma flexibilidade e robustez apresentadas pelos objetos padrão do Windows.
Tudo isto, torna clara a grande versatilidade de aplicações desenvolvidas neste tipo de ambiente.
7.4	- Independência de Periférico:
Esta é uma característica bastante atrativa, tanto para os usuários como para quem está envolvido no desenvolvimento de aplicações. A diversidade de monitores, impressoras e traçadores gráficos exige dos elaboradores de aplicações em ambientes
convencionais como o DOS, um extenso esforço em tornar compatível a aplicação aos diversos tipos e modelos desses periféricos, seja através da utilização de "device drivers" ou até pela elaboração de rotinas diferenciadas. Tal fato faz com que cada aplicação DOS seja acompanhada de diversos arquivos contendo esses "device drivers", exigindo assim um processo específico de instalação para cada aplicação.
No ambiente Windows, isto não é necessário pois os "device drivers" já estão incluídos no pacote do Windows, bastando ao usuário durante a instalação deste último, selecionar os periféricos que compõem sua configuração. Desta forma, qualquer aplicação Windows fará uso dos "drivers" já ativados. Isto é possível porque o Windows inclui uma linguagem gráfica própria, a GDI (Graphics Device Interface), que permite a construção de gráficos e a exibição de textos com alto grau de qualidade, sem fazer acesso diretamente ao hardware dos periféricos. O Windows faz isso de forma virtual e então converte para o periférico através do respectivo "driver". Nos equipamentos que exigem assistência durante a sua utilização, o Windows executa simulações de software que fazem uso das capacidades em baixo nível do dispositivo para obter características de alto nível.
Desta forma, o conjunto de funções para programação gráfica torna-se independente do dispositivo utilizado como saída e o elaborador da aplicação fará uso das mesmas funções e praticamente das mesmas rotinas para execução de uma saída para monitor, impressora ou traçador gráfico.
A princípio poder-se-ia ter um temor quanto ao lançamento de novos equipamentos com padrão diferente dos existentes. Contudo, em função do grande sucesso de ambientes como o Windows e da tendência crescente desse tipo de ambiente em dominar o mercado de microcomputadores e estações, seria irracional por parte de um fabricante de periféricos, ao lançar um novo equipamento, não prover os "drivers" para o ambiente Windows e outras interfaces semelhantes.
7,5	- Processamento Orientado por Evento;
Como já foi citado, as aplicações convencionais desenvolvidas para serem executadas diretamente sob o DOS possuem estrutura e fluxo sequencial de execução. Desta forma, a aplicação possui já definida, a sequência das etapas a serem realizadas e o conjunto de informações a ser fornecido em cada etapa, com a finalidade de concluir determinada tarefa. Normalmente, a consistência dos dados é feita dentro de cada etapa vinculando a continuidade da execução ao fornecimento correto das informações necessárias.
A partir das características acima aliadas à metodologia de programação utilizada, uma aplicação convencional apresentará um código fonte com início, meio e fim bem definidos. Assim, o acompanhamento da sequência de comandos indicará a ordem exata de execução da aplicação.
No caso de uma aplicação Windows, a definição da ordem de execução é função das escolhas feitas pelo usuário através de entradas por teclado ou acionamento do "mouse" sobre menus, botões, ícones ou na própria área gráfica da janela. Tais ações do usuário correspondem a eventos e são representadas no windows por "mensagens” específicas, as quais são na realidade constantes inteiras representadas por símbolos literais para facilitar a compreensão e manipulação. Quando o usuário executa alguma ação, o Windows gera uma ou mais dessas mensagens a fim de informar para a aplicação o evento ocorrido. A aplicação então recebe as mensagens, ignora ou processa qualquer delas executando um bloco de código, que por si pode agir sobre a janela da aplicação, sobre qualquer periférico ou ainda, fazer com que o Windows gere novas mensagens.
Desta forma, podemos inferir que o código fonte de uma aplicação Windows não fornece em si a sequência de execução, tal sequência será função das ações da usuário. Então, os blocos de código referentes ao processamento de cada mensagem poderão aparecer em qualquer ordem dentro da aplicação.
Como consequência desta orientação, quem estiver desenvolvendo uma aplicação nesse ambiente, necessitará possuir um conhecimento sobre o fluxo de mensagens e sobre quais delas são geradas e em qual ordem, a partir de cada ação do usuário.
Na figura 7.1 temos uma representação esquemática do fluxo de mensagens no ambiente Windows em uma determinada aplicação. Como primeiro passo, o Windows recebe a ação do usuário através de uma entrada de "hardware" (teclado, "mouse", etc.), armazenando esse evento sob a forma de mensagens na fila do sistema e, em seguida, enviando-as para a fila da aplicação correspondente.
Dentro da aplicação, existe um bloco de código chamado de "Função da Janela Principal", o qual executa a inicialização da aplicação e possui uma estrutura de "loop" contínuo efetuando acesso à fila da aplicação para verificar a existência de mensagens. Em caso positivo, a mensagem é retirada da fila da aplicação, realizadas as conversões necessárias e então despachada para o Windows, que então a encaminha para a respectiva função de janela. Cada janela existente numa aplicação possui uma função própria, que processa todas as mensagens destinadas àquela janela.
Recebida a mensagem pela função de janela, a mesma poderá simplesmente ser ignorada pela função devido à inexistência de um bloco de código correspondente, ser processada por um comando "padrão" ou desencadear a execução de um conjunto de comandos. No último caso, estes comandos poderão realizar operações de manipulação de dados, acesso a periféricos ou operações sobre a respectiva janela como leitura e exibição de dados, traçados gráficos, movimentação e modificação no tamanho da janela ou outros procedimentos. Tais requisições de operações são recebidas pelo Windows, sendo então enviadas para o DOS ou efetuadas sobre a devida janela.
PROCESSAMENTO EM AMBIENTE UlINDOUS
NI NT&gt;O WS
FILA DO SISTEMA
ENTRADA DE HARDWARE

APUE CACAO

FILA DA APLICACAO
LOOP DE MENSAGENS
*
ENVIO DA MENSAGEM
PARA A RESPECTIVA
FUNCAO DE JANELA
FUNCAO DE JANELA
I
EXECUCAO DE ACAO
SOBRE A JANELA
JANELA DA APLICACAO
FIG. 7.1
A orientação por eventos de ambientes como o Windows parece à primeira vista muito complexa, principalmente aos profissionais acostumados com a orientação sequencial das aplicações convencionais. Na verdade, é realmente mais delicada, porém se assemelha bastante à forma como operam os sistemas operacionais e está mais próxima a forma humana de atuar na realização de tarefas.
Em função de todas essas características, toma-se claro que o Windows enquadra-se melhor às aplicações que exigem uma forte interação com o usuário ou quando necessita-se grande flexibilidade na sequência de execução das tarefas.
7.6	- Processamento Multitarefa:
Uma das grandes versatilidades do Windows é a capacidade de processar concomitantemente diversas aplicações, possibilidade esta não suportada pelo DOS. No ambiente DOS, as aplicações quando em execução, assumem o controle de todos os recursos do computador, incluindo a CPU, a memória, o monitor e os demais periféricos. No Windows, todas as aplicações compartilham esses recursos entre si, enquanto são executadas.
Em um ambiente multitarefa, costuma-se dizer que as aplicações estão sendo executadas simultaneamente. Na verdade, com um único processador, as aplicações não são executadas simultaneamente, o que acontece é um escalonamento da CPU. Nos sistemas operacionais convencionais de maior porte, dotados da característica de multitarefa, esse escalonamento é feito em função do tempo. Cada programa por sua vez, recebe uma determinada quantidade de tempo, que em alguns sistemas pode ser função de uma classificação de prioridades. Quando este tempo se esgota, o sistema operacional interrompe a execução e passa o controle para a próxima aplicação. O ciclo é repetido continuamente até que cada aplicação complete suas tarefas. Este processo é chamado de Alocação Preemptiva.
No ambiente Windows, o escalonamento não é comandado pelo sistema operacional e sim pelo fluxo de mensagens. Quando uma aplicação que possui o controle do processador termina de executar uma mensagem, seu "loop" de mensagens procura por uma nova mensagem na fila da aplicação, se a fila estiver vazia o controle do processador é passado para outra aplicação em execução. Excepcionalmente, o controle do processador poderá ser transferido de uma aplicação para outra, mesmo havendo mensagens na fila da primeira, se tais mensagens forem de baixa prioridade. A desvantagem nesse modelo "não-preemptivo" ocorre quando o bloco de código referente a uma dada mensagem possuir um longo tempo de processamento. Nesse caso, o controle só poderá ser passado a outra aplicação, quando houver encerrado o processamento daquele bloco, independente de existir ou não outras mensagens na fila da aplicação.
A figura 7.2 ilustra o processamento de distribuição de mensagens entre as filas das aplicações. Como vimos no tópico anterior, a partir de uma entrada de "hardware", o Windows a transforma em uma ou mais "mensagens", colocando-as em seguida na fila do sistema. A seguir, dependendo de qual aplicação gerou a entrada de "hardware" e da aplicação que estava ativa, envia a mensagem para a devida fila da aplicação.
O grande sucesso dos programas DOS residentes na memória, devido à rapidez com que o usuário dentro de uma aplicação passa a utilizá-los, nos dá uma boa indicação dos grandes benefícios oriundos da multitarefa no Windows.
Com a característica de multitarefa implementada pelo Windows, o microcomputador passa a possuir a potencialidade dos grandes sistemas e novamente há uma aproximação da máquina ao comportamento humano, que durante a execução de uma tarefa, pode interrompê-la e rapidamente consultar um manual ou executar uma outra tarefa e a seguir voltar a qualquer momento à tarefa original.
PROCESSAMENTO MULTITAREFA EM UINDONS
FIG. 7.2
7.7	- Troca de Dados entre Aplicações:
Esta característica confere uma grande potencialidade ao ambiente Windows. Nada mais prático e típico do comportamento humano do que utilizar instrumentos ou máquinas diferentes para realizar tarefas ou produzir partes componentes, que serão posteriormente combinados para atingir o objetivo ou produto final. Um exemplo óbvio disso, seria a utilização de um "software de design" para elaborar algumas figuras, uma planilha eletrônica para produzir alguns gráficos e então transferir tudo para um editor de textos, que os combinaria com um texto nele elaborado e por fim, produziria um relatório completo.
No ambiente Windows, o intercâmbio de dados pode ser feito através de três mecanismos distintos:
-	CLIPBOARD - Este mecanismo opera sob comando do usuário que seleciona um certo conjunto de dados ou especifica determinada área gráfica e então escolhe uma opção que fará o Windows transferir ou copiar esses dados para uma área de memória controlada pelo Windows. A seguir, dentro de outra aplicação, o usuário escolhe uma opção que copia o conteúdo do Clipboard para a área de trabalho da aplicação. Assim, o Clipboard é um repositório temporário para troca de dados com envolvimento direto do usuário na execução do processo.
-	Bibliotecas de Ligação Dinâmica ("Dynamic Link Libraries" - DLL) - A aplicação deste recurso está ligada ao compartilhamento de funções por diversas aplicações com o objetivo de reduzir o tamanho dos módulos executáveis e consequentemente, diminuir o consumo de memória quando executando diversas aplicações. Tal fato é possível porque aplicações utilizando este recurso, fazem a "linkedição" com as rotinas contidas nas DLL quando da execução da aplicação e não durante a ’'linkedição" do módulo executável, caso que ocorre por exemplo, com as bibliotecas estáticas
de rotinas do "C”. Assim, diversas aplicações podem fazer uso das mesmas bibliotecas de funções sem a necessidade de que cada uma faça uma cópia interna dessas funções. Outra vantagem advém do fato de que quando uma rotina contida numa DLL é otimizada, não será preciso recriar todos os módulos executáveis das aplicações que fazem uso daquela DLL, como acontece com as bibliotecas convencionais de rotinas, bastando portanto, compilar novamente a DLL. Podemos observar então que as DLL, na verdade não são mecanismos de troca de dados entre aplicações e sim de compartilhamento de código executável.
- Troca Dinâmica de Dados ("Dynamic Data Exchange" - DDE) - Este mecanismo implementa a mais poderosa forma de intercambiar informações entre aplicações. O DDE é mais exatamente um protocolo de mensagens entre aplicações que se baseia na implementação de uma comunicação entre duas aplicações pelo envio e recepção mútuos de mensagens através do Windows. Desta forma, dados de uma dada aplicação podem ser utilizados por diversas aplicações, bem como uma aplicação pode utilizar dados de diversas aplicações. Outro ponto interessante reside no fato de que uma vez implementada a comunicação, qualquer alteração efetuada nos dados da aplicação origem, poderá ser notificada a aplicação destino e automaticamente atualizados nesta. Assim, diferentemente do Clipboard, o DDE age independentemente da interferência do usuário e promove uma comunicação de informações em tempo real. Pode ser utilizado para as mais diversas finalidades, como a que foi descrita no parágrafo sobre o Clipboard ou por exemplo, obter dados de uma aplicação que controla um equipamento eletrônico para processá-los em outra aplicação.
7.8	- Gerenciamento de Memória:
Um ponto marcante no ambiente Windows são as suas características no gerenciamento de memória. Qualquer sistema que implemente a multitarefa necessita de uma robusta capacidade de manipulação da memória, sem o que rapidamente seria esgotado esse recurso.
Em sistemas convencionais, o espaço de memória alocado para programa ou dados costuma permanecer fixo numa posição da memória até que seja liberado. No DOS, a capacidade de executar uma aplicação depende diretamente de que o espaço disponível de memória comporte o módulo executável da aplicação e as áreas de dados alocadas durante a execução. Além disso, conforme forem feitas as alocações e liberações de dados, poderão existir espaços vazios não aproveitados entre grupos de dados.
No Windows, que é um ambiente gráfico e multitarefa, foram implementadas diversas formas de otimizar o consumo de memória, isto já a partir da primeira versão, que como vimos foi elaborada para trabalhar com 256 KB de RAM. Atualmente temos as seguintes possibilidades:
-	Quando um usuário põe em execução várias vezes a mesma aplicação, o Windows não carrega na memória várias cópias da aplicação. Ao contrário, ele utiliza o mesmo segmento de código e recursos carregados na primeira chamada da aplicação para todas as instâncias em execução.
-	Na maioria dos casos, que correspondem a aplicações bem elaboradas, tanto os segmentos de memória alocados para código como para dados sao móveis, permitindo que quando da carência de memória, o Windows mova tais segmentos eliminando espaços de memória não utilizados entre os segmentos e consequentemente transformando-os em espaço contínuo maior.
-	Segmentos de código executável e recursos podem ser carregados apenas quando necessários à execução da aplicação. Da mesma forma, quando ocorre necessidade de espaço na memória, eles podem ser descartados quando não estiverem em uso e posteriormente recarregados a partir do módulo executável se novamente necessários à execução.
-	Em função do modo de operação do Windows, ele poderá utilizar memória expandida ou estendida.
-	Quando utilizado um equipamento com processador 80386 ou superior com pelo menos 2 MB de memória e operando no modo "386-enhanced", o Windows implementará a capacidade de memória virtual utilizando-se dos registradores de paginação do processador. Desta forma, o Windows descarrega para o disco e recarrega para a memória páginas de código de 4 KB, permitindo ampliar a memória virtualmente para até 4 vezes o valor da memória física existente.
Tal conjunto de possibilidades confere extremo poder de gerenciamento de memória, contudo como consequência óbvia, exige cuidados adicionais por parte dos elaboradores durante o desenvolvimento de uma aplicação.
7.9	- Arquivos de Dados:
Um fator delicado no Windows é a manipulação de arquivos de dados. Como o Windows é um sistema multitarefa e portanto pode executar simultaneamente diversas aplicações ou ainda várias instâncias de uma mesma aplicação, ao operações de acesso a arquivos envolvendo leitura e gravação de dados deverão serem implementadas cuidadosamente a fim de evitar conflitos entre aplicações ou perda de dados, principalmente quando da utilização de disquetes ou outro meio de armazenamento removível.
Adicionalmente, as operações de leitura e gravação deverão ser realizadas fazendo uso das funções de baixo nivel, já que as funções de alto nivel presentes ñas diversas linguagens de programação poderão eventualmente apresentar problemas durante a execução da aplicação. Tal fato dá origem a uma limitação peculiar, já que com a utilização das funções de baixo nível deverão ser utilizados arquivos de dados no formato de "máquina", os quais são de limitada e delicada edição pelo usuário. No caso da utilização de arquivos em formato "ASCII", as rotinas de leitura e gravação necessitarão de uma elaboração bem mais detalhada se permitirem edição do arquivo pelo usuário, com grande potencialidade de ocorrerem problemas durante as operações de leitura.
7.10	- Elaboração de Aplicações em Windows:
O primeiro passo para desenvolver uma aplicação Windows é familiarizar-se com o próprio ambiente Windows e seus objetos, através do aprendizado e utilização dos diversos módulos e acessórios que o acompanham ou de outras aplicações. Tal cuidado, possibilitará ao elaborador da aplicação, adquirir a familiaridade com os objetos do Windows bem como com suas funções de manipulação, necessária para visualizar a perspectiva do usuário na utilização de aplicações nesse ambiente.
Anteriormente foi citado que o Windows funciona como um ambiente operacional intermediário e assim as aplicações são programadas especificamente para atuar nesse ambiente.
O Windows possui um conjunto de mais de 550 funções para utilização no desenvolvimento de aplicações. Essas funções podem ser classificadas em três conjuntos básicos:
- WINDOWS MANAGER INTERFACE - Abrange as funções que criam, movem, alteram e manipulam as janelas e seus objetos componentes.
Também inclui as funções que controlam a interação com o usuário através de janelas de diálogo, teclado, mouse, etc.
-	GRAPHICS DEVICE INTERFACE - Este conjunto inclui as funções que realizam as operações de traçado gráfico nas janelas das aplicações incluindo a criação e manipulação de linhas, padrões de preenchimento, figuras geométricas, desenhos em forma de BITMAP e textos com suas diversas fontes.
-	SYSTEM SERVICE INTERFACE - Contém um conjunto de funções para alocação e manipulação de memória, controle das portas de comunicação, criação e abertura de arquivos, acesso modular a dados e códigos executáveis, gerência de tarefas, sonorização, manipulação de "string" e carga de recursos entre outras.
Adicionalmente são utilizados diversos tipos de estruturas, ponteiros e "handle" a fim de referenciar janelas e seus componentes, objetos gráficos, arquivos, áreas de memória e recursos diversos. O Windows também define novos tipos de dados e obviamente por ser uma interface orientada por eventos, inclui uma volumosa lista de "mensagens" representando os possíveis eventos a ocorrer durante a execução de uma aplicação.
Apesar deste grande conjunto de recursos, o Windows por si só não permite o desenvolvimento de uma aplicação, necessitando de uma linguagem de programação para dar corpo a aplicação e suportar as operações de manipulação dos dados envolvidos. As linguagens mais comumente utilizadas são o C da Microsoft e o C da Borland.
Finalmente, o projeto das janelas, ícones, menus, figuras e outros objetos gráficos é feito através de um software próprio para esta tarefa ou penosamente editado, diretamente num arquivo de recursos.
7.11	- Desafios do Ambiente Windows:
A partir do descrito nas seções anteriores, podemos observar facilmente a potencialidade e versatilidade de uma aplicação desenvolvida para um ambiente de interface gráfica, particularmente o Windows. Porém tais características implicam em alguns desafíos para qualquer pessoa que decida desenvolver nesse ambiente. A seguir, são expostos os principais desafíos identificados durante a elaboração deste trabalho:
-	Lidar com a diversidade de recursos necessários ao desenvolvimento da aplicação incluindo o ambiente Windows, a linguagem de programação, o software de projeto dos recursos gráficos e as facilidades de programação em Windows.
-	Conhecimento da vasta biblioteca com mais de 550 funções de suporte ao desenvolvimento de aplicações em ambiente Windows.
-	Entendimento e manipulação das diversas estruturas de dados, tipos de ponteiros e novos tipos de dados.
-	Combinação adequada da linguagem de programação com a biblioteca de funções do Windows de forma a evitar incompatibilidades e quedas de desempenho.
-	Alocação dinâmica de matrizes e estruturas de dados com o objetivo de otimizar o consumo de memória e flexibilizar a aplicação.
-	Compreensão da geração, sequência e processamento interno das mensagens criadas pelo Windows durante a ocorrência dos diversos eventos gerados pelos usuários ou internamente pelo Windows.
-	Elaboração do processo de abertura e leitura de arquivo de dados. As operações de manipulação de arquivos estão entre as mais delicadas e trabalhosas do Windows.
-	Gráficos com formatação inteligente de cabeçário, eixos e rótulos. Como as janelas onde são exibidos gráficos podem ter suas dimensões aleatoriamente alteradas pelo usuário ou pelo próprio Windows, tem-se duas opções: adota-se a rolagem da tela nos sentidos horizontal e vertical, ou como no caso deste trabalho, desenvolve-se funções de traçado gráfico com capacidade de se auto-adaptarem às dimensões da janela.
-	Apresentação estética dos textos. Quando utilizando a facilidade de fontes proporcionais (dimensões dos caracteres variáveis entre si), obtem-se uma alta qualidade de apresentação e uma aparência tipográfica dos textos. Como consequência direta, a locação estética dos textos não mais pode ser feita em função do número de caracteres, como nas fontes convencionais (dimensões fixas entre caracteres), e passa a ser realizada pela dimensão em "pixels" (pontos) do texto.
8. DESCRIÇÃO DO SOFTWARE
8.1	- Introdução:
O resultado final deste trabalho constitui-se num "software" básico para utilização profissional na atividade de interpretação de testes de pressão em poços, o qual contem os recursos necessários para abranger as diversas metodologias de interpretação já descritas nos capítulos anteriores e está preparado para a ampliação dos modelos poço-reservatório e dos métodos de determinação de seus parâmetros, sem que seja necessário realizar grandes alterações em sua estrutura básica.
A escolha do ambiente gráfico Windows para o desenvolvimento do "software" deveu-se ao domínio praticamente total de microcomputadores compatíveis com o IBM PC no meio profissional brasileiro, em particular na Petrobrás, com utilização do MS-DOS como sistema operacional. Adicionalmente, tanto o Windows como o MS-DOS foram desenvolvidos pela Microsoft. Como linguagem de programação foi adotado o "C", em função de sua potencialidade e portabilidade, além do fato de ser até o momento, a linguagem mais utilizada na elaboração de aplicações para o ambiente Windows.
A análise e especificação do "software" procurou ser a mais abrangente possível, com o intuito de vislumbrar toda a potencialidade de aplicação e consequentemente projetar sua estrutura básica de modo a compatibilizar os futuros aprimoramentos e acréscimos de recursos. Dentro deste enfoque, foram analisados os dados envolvidos na atividade de interpretação de testes, seus procedimentos corriqueiros de execução e as necessidades subsequentes de informação dos resultados obtidos.
Adicionalmente, foram consideradas durante o desenvolvimento da aplicação as diversas características desejáveis numa aplicação profissional de engenharia. Desta forma, procurou-se moldar o "software” de modo a atender tanto aos requisitos técnicos da atividade como prover uma adequada interação com o usuário. Tais características encontram-se descriminadas na seção 8.2.
A partir dos dados oriundos de uma operação de teste, do conjunto de identificadores desse teste e de outros dados envolvidos na interpretação, foi definida uma estrutura de dados, descrita na seção 8.3, utilizando o modelo hierárquico de dados.
A análise da atividade de interpretação de testes, dos dados utilizados e suas fontes, bem como das formas de apresentação dos resultados e seu armazenamento, levou a definição da estrutura de "software" descrita na seção 8.4.
Finalmente, procura-se na seção 8.5 apresentar as características de utilização do "software" através de figuras contendo telas da aplicação e de textos explicativos das respectivas funções.
8.2	- Características Básicas de uma Aplicação Profissional de Engenharia.
Quando o intuito no desenvolvimento de uma aplicação é elaborar um software para uso profissional, não basta garantir uma entrada de dados completa com processamento preciso e formas de saída dos resultados. Um software para utilização corriqueira por diversos usuários em atividades profissionais de engenharia necessita atender algumas premissas básicas descritas a seguir:
- Precisão nos cálculos matemáticos: Este requisito implica na preocupação constante em escolher os tipos de variáveis, as funções, os algoritmos e a ordenação das operações de forma a minimizar erros de arredondamento ou truncamento durante as operações matemáticas.
-	Velocidade das operações matemáticas: Para atender essa premissa, torna-se parte do desenvolvimento a preocupação em dividir e ordenar as etapas de um processo de cálculo de modo a garantir o menor número possível de operações com utilização preferencial das funções com menor tempo de processamento.
-	Otimização do fluxo de processamento: Tal necessidade envolve a identificação da frequência de execução das etapas da aplicação com o objetivo de ordená-las e codificá-las, obtendo assim, um fluxo otimizado com respeito às estruturas de controle condicional e à própria sequência de execução. Em um ambiente como o Windows, orientado por eventos, estes cuidados adquirem importância superior à necessária nas aplicações em ambientes convencionais.
-	Utilização e manipulação adequada da memória: Com este requisito busca-se otimizar o consumo do recurso potencialmente mais precioso em ambientes gráficos. Como tais ambientes são consumidores vorazes de memória, torna-se indispensável a preocupação em alocar e utilizar adequadamente conjuntos de dados, recursos gráficos e áreas de memória com utilização temporária, visando o mínimo consumo de espaço sem prejudicar a rapidez de acesso. Em aplicações de engenharia, um fato marcante é a utilização de matrizes, e para atender este requisito, torna-se indispensável a adoção da alocação dinâmica de memória.
-	Otimização do armazenamento de dados: Uma análise bem conduzida dos dados envolvidos na atividade, suas fontes, formas de apresentação, frequência de utilização e longevidade da sua necessidade de disponibilidade, permitirá a definição precisa de um modelo de dados que indique o meio adequado de armazenamento, possibilite o mínimo consumo de espaço e organize os dados de forma objetiva.
-	Rapidez na leitura e gravação de dados: As operações de entrada e saída constituem um dos gargalos do processamento computacional. Dependendo do volume de dados lidos ou gravados em cada operação e da rapidez com que o usuário necessita dos resultados da execução de uma aplicação para consecução de suas atividades, este pode ser um problema desmotivador ou até impactante. A preocupação em escolher cuidadosamente as funções para execução das operações de leitura e gravação, o formato de armazenamento dos dados e o tipo de meio físico, terão forte influência sobre o processo.
-	Indução do usuário quanto ao fluxo de execução: Esta premissa envolve primordialmente a maneira de apresentação das opções disponíveis durante a execução de uma aplicação, o que é normalmente implementado através de "menus". Assim, a organização sequencial das opções de "menus" e "submenus", em conformidade com as possíveis ordens lógicas de execução, tem um forte peso na indução indireta do usuário quanto a utilização da aplicação. Adicionalmente, e muito desejável, encontra-se a possibilidade de ativar e desativar opções em "menus" e "submenus" conforme o nível de execução, de modo a diretamente evitar a escolha de processos inadequados para o momento, garantindo assim a consistência de fluxo. Este último aspecto, encontra boas facilidades de implementação no ambiente Windows.
-	Estética de telas, "menus" e campos de dados: A apresentação visual adequada e atraente de todos os meios de interação com o usuário, influencia subjetivamente a apreciação da aplicação e facilita sua utilização. Um ambiente gráfico, como o Windows, pela característica de utilizar recursos de visual aprimorado e objetos típicos de comportamento humano, possui uma capacidade sensivelmente superior às aplicações convencionais em satisfazer o presente requisito.
-	Facilidade e clareza na entrada de dados: Para satisfazer este aspecto óbvio, é necessário que as solicitações de entrada de dados possuam um caráter bastante explícito e utilizem a terminologia própria da atividade. Adicionalmente, a entrada dos dados deve possuir flexibilidade de movimentação entre os campos componentes e facilidades de edição no campo como inserção, correção e formatação.
-	Consistência dos dados de entrada: Este é um requisito obrigatório com o propósito de evitar que o usuário cometa erros no fornecimento de dados, os quais poderão comprometer os resultados da execução ou até interrompê-la anormalmente, o que implicaría na perda do trabalho desenvolvido até o momento com consequente sentimento de frustração para o usuario e de insegurança nas utilizações subsequentes. A fim de prover uma consistência adequada, devem ser analisados os intervalos de valores ou atribuições possíveis aos campos de dados, implementados trechos de código para verificação e rotinas de aviso e reposicionamento no campo inconsistente.
-	Rotinas de aviso e recuperação de erros: Além dos dados de entrada, existem outras possibilidades de erros ou limitações na utilização de um "software". Em processos numéricos de engenharia podem ocorrer problemas de convergência, de ultrapassagem dos limites superior e inferior de armazenamento numérico ou de domínio de funções. Em tais situações é necessário prever os possíveis pontos de ocorrência e implementar rotinas de aviso ao usuário com posterior recuperação do processo de execução e dos dados a uma etapa anterior adequada.
-	Telas de ajuda e instrução: Em qualquer "software" normalmente existem etapas de execução não tão óbvias ou de sequências complexas. É claro que esses casos estarão contidos e descritos nos manuais, no entanto, a consulta aos mesmos durante o processo de execução é geralmente encarada pelo usuário como uma tarefa pouco atrativa e muitas vezes enfadonha. Pra evitar o problema e prover uma forma rápida de instrução, são implementadas as telas de auxílio, normalmente conhecidas como "Help", as quais são acionadas através de uma opção de "menu" ou por uma tecla de função. As rotinas desenvolvidas para este fim podem agir controladas por "menus" internos, recursos de hipertexto ou ainda podem verificar de forma inteligente a etapa de execução corrente e apresentar a instrução correspondente. Outra forma de auxílio é encontrada pela utilização de barras de instrução e informação exibidas continuamente e automaticamente atualizadas em função da etapa de execução.
-	Utilização de rotinas inteligentes: Com o propósito de minimizar o trabalho do usuário, acelerar o processo de execução e garantir padrões de estética e apresentação adequados, deve-se buscar a construção de rotinas que automaticamente substituam eficientemente, onde for possível, ações típicas do usuário. Como exemplos dos benefícios dessas rotinas, temos o dimensionamento e rotulação de eixos gráficos ou a construção e posicionamento de rótulos de identificação.
-	Estética das saídas gráficas e listagens: Este requisito é óbvio, já que numa aplicação de utilização profissional, os possíveis gráficos e listagens produzidos serão normalmente utilizados na composição de relatórios ou trabalhos técnicos. Assim, será imprescindível um planejamento meticuloso da apresentação e clareza das informações nas listagens e do aspecto visual e informativo dos gráficos. Tais fatores terão papel preponderante na validação prática da aplicação.
-	Flexibilidade e riqueza de opções: Um dos grandes objetivos perseguidos na informatização de atividades é dotar o usuário de um "software" capaz de se adaptar facilmente aos diversos contextos e sequências possíveis de execução das tarefas componentes da atividade. Com este propósito, deve ser efetuada uma análise detalhada da atividade e suas metodologias, sem perder de vista as oportunidades de adaptar ou modificar a metodologia, aproveitando as características peculiares do processo computacional, e não apenas mecanizando os procedimentos originais. Um fator que tem grande impacto positivo sobre o usuário advém do fato de sentir que a mecanização da atividade melhorou a qualidade dos resultados ou da metodologia além de acelerar sua execução.
-	Portabilidade e facilidade de instalação: Uma característica bastante desejável em uma aplicação é a possibilidade da mesma ser utilizada na maior diversidade possível de equipamentos e configurações. No primeiro capítulo foram discutidas em detalhes as características de independência de periféricos e suas implicações sobre a facilidade de instalação para aplicações desenvolvidas em ambientes gráficos como o Windows.
8.3	- Estrutura de Dados:
A análise de dados durante testes de pressão em poços, do conjunto de identificadores da operação e de outros dados utilizados, levou a definição da estrutura de dados contida na figura 8.1. Procurou-se seguir o modelo hierárquico de dados sem uma maior preocupação na distinção entre entidades e propriedades. A seguir temos uma descrição simples de cada componente da estrutura.
ESTRUTURA DE DADOS
VN
FIG. 8.1
-	Poço: É a entidade primária em análise de testes. É representada por um dado alfanumérico de identificação. No caso específico da Petrobrás compõe-se de caracteres numerais e alfabéticos mnemónicas indicando a classificação do poço, o campo a que pertence, seu número de identificação dentro campo, existência de intervalo direcional, índice de repetição do poço, estado da federação onde se localiza e indicação de localização marítima.
-	Intervalo: Em cada poço podemos ter um ou mais intervalos caracterizando as formações atravessadas pelo poço. Esta entidade é representada por um dado alfanumérico contendo o valor da profundidade do topo e da base do intervalo testado numa operação de avaliação de formações.
-	Teste: é a entidade básica em análise de testes e caracteriza uma operação de avàliação de formações. Para um dado intervalo podem ocorrer diversos testes em ocasiões distintas. É representada por um dado alfanumérico identificando a operação. No caso da Petrobrás compõe-se de uma sigla alfabética denotando o tipo de operação e de um índice numérico da operação.
-	Data: Dado alfanumérico contendo as datas de início e encerramento de uma operação de teste.
-	Registrador: Esta entidade identifica o equipamento utilizado no registro da resposta apresentada pelo reservatório durante o teste. Para cada teste poderão ser utilizados um ou mais registradores. É representada por um dado alfanumérico composto do código de identificação do registrador e opcionalmente, de um mnemónico indicando a posição relativa do mesmo na coluna de teste.
-	Profundidade: Dado alfanumérico indicando a profundidade de poço onde se localizou o registrador durante o teste, no caso da localização ser fixa.
-	Coeficientes de calibraçâo: Em alguns tipos de registradores, os dados extraídos do registro encontram-se representados por entidades físicas diferentes das que constituíam o objeto do registro. Desta forma, é necessária uma relação entre elas e o conjunto de coeficientes dessa relação. Esses dados são representados numericamente.
-	Período de teste: Esta entidade caracteriza um intervalo de tempo do teste correspondente a um conjunto específico de condições de poço e de perturbação introduzida. É representada por um dado alfanumérico de identificação. Um teste poderá ser composto de um ou mais períodos.
-	Tipo: Este dado numérico classifica o período de teste em função das condições de poço, da resposta do reservatório e das entidades físicas registradas.
-	Unidades de registro: Este dado numérico caracteriza as unidades em que o registro está representado.
-	Tempo/Profundidade:: Um período de teste na estrutura de dados aqui definida, é formado por um conjunto de pontos de registro compostos de duas coordenadas. A primeira é representada por um dado numérico que caracteriza a profundidade de registro do ponto ou um intervalo de tempo decorrido.
-	Pressão/Vazão/Temperatura: Este dado numérico representa a segunda coordenada dos pontos de registros e caracteriza um valor de pressão, vazão ou temperatura.
- Regime de comportamento: Esta entidade denota um intervalo de pontos do registro que caracteriza um regime de comportamento específico da resposta do reservatório e é representada por um par de índices indicando os pontos inicial e final do regime. Em cada período de teste poderão ser identificados um ou mais regimes.
Em função da forma de utilização desses dados na aplicação, foi optado pela montagem física dessa estrutura de dados na forma de arquivos e não de banco de dados. Para tanto foi definido que cada arquivo seria composto de todos os dados oriundos de um registrador.
Desta forma, as entidades poço, intervalo, teste, registrador, data e profundidade passaram a constituir os identificadores do arquivo, sendo as quatro primeiras obrigatórias e as duas últimas opcionais. Como identificadores foi escolhido o tipo alfanumérico e adotada a extensão como única restrição de integridade.
Os demais dados componentes do arquivo tiveram seu tipo escolhido em função do respectivo emprego na aplicação e implementadas as restrições de integridade pertinentes como formato e valores de atribuição.
Com respeito aos dados resultantes da análise do teste, que conforme descrito na próxima seção poderão compor um banco de dados , não foram objeto de análise e definição da respectiva estrutura de dados já que a implementação desse banco de dados não foi considerada como componente necessário de um "software" básico de análise de testes, sendo citado por tratar-se de um recurso desejável.
8.4	- Estrutura Básica do "Software”:
A análise da atividade de interpretação de testes em poços, dos dados utilizados e suas fontes, bem como das formas de apresentação dos resultados e seu armazenamento, levou a definição da estrutura de "software" sob a forma de três módulos componentes:
-	Gerência de dados: Responsável pelas operações de digitação e digitalização do arquivo de dados, de conversão de arquivos oriundos de diversas fontes para o formato próprio do presente "software" e pela manutenção dos arquivos.
-	Interpretação: É o módulo principal do "software" que implementa todos os recursos, metodologias e funções auxiliares necessários a execução de uma interpretação a partir de arquivos de dados da operação e informações adicionais fornecidas pelo usuário.
-	Elaboração de relatório: Possibilita, com relação aos resultados da interpretação, o armazenamento em forma de banco de dados ou arquivos para transmissão posterior. Implementa também a geração de relatórios técnicos da operação montados a partir dos resultados da interpretação acrescidos de informações da operação e de pareceres técnicos do interpretador.
Para efeito do trabalho de dissertação de tese, os esforços foram dedicados ao módulo de interpretação, já que os dois outros representavam trabalhos de manipulação de dados e textos. Estes últimos são sugeridos como continuação do trabalho para viabilizar a utilização profissional do "software".
A seguir, procurou-se definir a estrutura dos módulos acima e seus componentes.
8.4.1	- Módulo de gerência de dados:
A figura 8.2 apresenta o diagrama da estrutura desse módulo. Os dados registrados numa operação de teste de pressão em poços podem ser provenientes de varias fontes e apresentarem-se em diversas formas que o "software" de verá ser capaz de processar:
-	Arquivos em meio magnético oriundos de equipamentos de registro utilizados por companhias de serviço contratadas para a operação.
-	Arquivos armazenados no mesmo meio provenientes de registradores pertencentes a própria companhia.
-	Arquivos recebidos por transmissão de dados em redes de teleprocessamento.
-	Arquivos de dados no formato de outros "softwares" utilizados pela companhia.
-	Um arquivo genérico de dados em qualquer formato.
-	Uma listagem com tabelas dos dados e informações complementares.
-	Cartas metálicas provenientes de registradores mecânicos que apresentam os dados sob a forma de uma curva traçada na carta.
Para as cinco primeiras categorias necessita-se de um processo de conversão do formato original para o formato da aplicação com complementação das informações necessárias.
GERENCIA DE DADOS
FIG. 8.2
Para os quatro primeiros casos onde ter-se-ão formatos originais bem definidos, o processo de conversão será praticamente automático, com possível necessidade de algumas poucas informações complementares. Na condição da quinta fonte, tem-se uma situação de formato previamente indefinido e o processo de conversão necessitará de uma forte interação com o usuário e grande flexibilidade na manipulação do arquivo original.
Para o sexto caso deverá ser implantado um processo convencional de entrada de dados por digitação e finalmente na última opção, o ideal será um processo de digitalização da carta acompanhado de digitação das informações complementares. Para tal, será necessário o interfaceamento e compatibilização da aplicação com os digitalizadores normalmente empregados.
Após a entrada de dados, deverá haver um processo de geração do arquivo de dados no formato da aplicação e opcionalmente a implantação de um cadastro desses arquivos.
Por último, é óbvia a necessidade de um processo de atualização dos arquivos e cadastro usando operações de correção, complementação e eliminação de dados. É desejável ainda que haja a possibilidade da listagem dos dados após qualquer processo de manipulação dos mesmos.
8.4.2	- Módulo de interpretação:
A figura 8.3 apresenta o diagrama da estrutura desse módulo que inicia-se a partir da leitura dos arquivos de dados no formato próprio da aplicação, seguido da conversão dos dados para o sistema de unidades escolhido para trabalho. A escolha do sistema de unidades é um componente natural das opções de condicionamento ("setup") da aplicação.
INTERPRETACftO
FIG. 8.3
A próxima etapa constituí-se na preparação dos dados atendendo ao disposto no terceiro capítulo. Também inclui-se nessa etapa, o fornecimento de informações adicionais não contidas no arquivo de dados e abrangendo condições físicas do poço e da coluna de teste, bem como parâmetros de fluído e rocha. Tais parâmetros são normalmente obtidos a partir de perfis do poço, correlações e análises laboratoriais dos fluidos produzidos, sendo em alguns casos necessário a realização de cálculos auxiliares para sua determinação ou conversão para o sistema de unidades em uso na aplicação.
As rotinas para executar os cálculos auxiliares citados acima não foram implementadas na aplicação para efeito deste trabalho em vista da grande diversidade de correlações e procedimentos laboratoriais existentes e por não ser este o objetivo básico do trabalho. No estágio atual da aplicação, pressupÕe-se que o usuário tenha previamente determinado os parâmetros necessários e os forneça nas unidades convencionais de uso na respectiva tela de entrada. Pretende-se posteriormente avaliar um conjunto adequado de correlações e procedimentos laboratoriais, implementando-os a seguir no software.
Após a preparação dos dados, segue-se o processo de modelagem, onde a partir de um gráfico de diagnóstico e com auxilio de objetos gráficos, que podem ser colocados, movimentados e removidos do gráfico, são identificados os regimes de comportamento e escolhido o modelo mais adequado aos dados. A metodologia de modelagem foi descrita no terceiro capítulo.
Em seguida, conforme as escolhas do usuário são traçados os gráficos dos métodos correspondentes. O processo de traçado inclui o fornecimento ou alteração a qualquer momento, de alguns parâmetros básicos, o cálculo de funções para os eixos gráficos com dimensionamento automático e rotulação dos mesmos, bem como a montagem estética e rotulação geral do gráfico em si.
Como apoio a manipulação visual dos dados são implementadas opções que incluem as possibilidades de ampliação e redução de trechos dos dados, exibição da tabela de funções dos eixos para os pontos apresentados no gráfico e dimensionamento manual dos mesmos.
A partir do gráfico dos dados sob um determinado método escolhido, pode ser realizada a interpretação gráfica propriamente dita. Conforme o gráfico em uso, poderão ser utilizadas uma ou mais das possibilidades de metodologias.
No quarto capítulo foi descrita a metodologia de análise por curva tipo. Para esta opção e a partir do tipo de gráfico e do modelo selecionado, a aplicação traça uma família de curvas-tipo para o ajuste ou pelo fornecimento de valores dos parámetros característicos, a aplicação gera uma única curva-tipo. São implementadas também a movimentação das curvas para o ajuste, sua remoção e a exibição do resultado do ajuste.
No quinto capítulo apresentou-se a metodologia de análise especializada. Nessa forma de análise, busca-se identificar no gráfico trechos lineares, para os quais a aplicação realiza o traçado de retas utilizando o conceito de regressão linear por mínimos quadrados após a seleção do intervalo de pontos pelo usuario. Adicionalmente, tem-se a possibilidade de remoção seletiva das retas e a apresentação dos parámetros característicos de cada reta.
No sexto capitulo foi definida a metodologia de análise automática de testes. Para esta metodologia, a aplicação implementa todo o processo matemático descrito no referido capítulo com possibilidade de escolher o método de ajuste, a precisão de determinação dos parámetros, o número máximo de iterações permitidas e o número máximo de aproximações da busca linear. São geradas as curvas correspondentes a todas as etapas do processo iterativo e exibidas graficamente com os dados para acompanhamento visual do processo de ajuste. São ainda implementadas a seleção do intervalo de dados para ajuste pela ampliação ou redução do gráfico dos dados, a exibição dos resultados e a remoção do ajuste automático.
Feita a análise gráfica por qualquer das metodologías citadas e desde que tenham sido fornecidos previamente os parámetros de fluido e rocha necessários, a aplicação efetua o cálculo quantitativo dos parámetros de reservatório pertinentes a cada método.
Finalmente, nesse módulo são desejáveis a impressão dos resultados da interpretação quantitativa, a impressão da tabela dos dados com as coordenadas do método e a impressão ou traçado em "plotter" dos gráficos. Como estas facilidades constituíam apenas um processo saída, não foi considerado como próprio para implementação durante a fase de elaboração desta dissertação e será incluído posteriormente visando o uso corriqueiro da aplicação.
8.4.3	- Módulo de elaboração de relatório:
A figura 8.4 mostra o diagrama da estrutura desse módulo que consiste na entrada de resultados selecionados da etapa de interpretação acrescidos de informações complementares da operação de teste e uma análise de todo o contexto pelo usuário incluindo comentários sobre os procedimentos, conclusões baseadas nos resultados e recomendações pertinentes.
ELABORACAO DE RELATORIO
FIG. 8.4
Todo esse conjunto de informações deverá sofrer uma montagem de acordo com os padrões de relatório técnico utilizados na Petrobrás e em seguida ser impresso. Adicionalmente, é desejável a alimentação de um banco de dados armazenando as principais características da operação, os procedimentos utilizados na interpretação e os resultados obtidos. Tal banco de dados poderá servir como fonte de consulta para técnicos, como meio de acompanhamento e gerenciamento de atividades e ainda como base de conhecimento para processos inteligentes de apoio à interpretação de futuros testes.
Por último, poderá ser necessária a implementação de um processo para criação de arquivo temporário com a finalidade de transmitir e alimentar bases de dados corporativas.
8.5	- Apresentação do "Software**:
Para facilitar a descrição das características do software serão adotados os termos abaixo, que não têm a pretensão de definir todas as facilidades dos objetos padrão do Windows, mas apenas os recursos mínimos necessários à utilização da aplicação.
-	Barra titulo: Área superior de uma janela onde normalmente identifica-se a aplicação ou a própria janela, tendo eventualmente botões em suas extremidades. A cor apresentada pela barra título identifica a janela ativa num dado momento.
-	Barra de menu: Área da janela onde localiza-se um menu de opções identificadas por palavras-chaves.
-	Botão de sistema: Botão existente no canto superior esquerdo da janela, identificado pelo sinal de
-	Botão de maximizar: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de um triângulo com sua base voltada para baixo.
-	Botão de minimizar: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de um triângulo com sua base voltada para cima.
-	Botão de restauração: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de dois triângulos com suas bases adjacentes.
-	Janela de diálogo: Janela exibida eventualmente com a finalidade de possibilitar ao usuário introduzir ou receber informações pertinentes ao processo.
-	Seleção: Ato de apertar o botão esquerdo do mouse quando o ícone de seta estiver sobre um item desejado, liberando-o em seguida.
-	Dupla seleção: Ato de apertar o botão esquerdo do mouse e liberá-lo duas vezes seguidas com o ícone de seta sobre um item desejado.
-	Arraste: Ato de pressionar o botão esquerdo do mouse e mantendo-o pressionado, deslocar o mouse até uma nova posição e então liberar o botão.
-	Arquivo ou período ativo: Conjunto de dados armazenados na memória, que num dado instante de execução da aplicação, está selecionado para uso na interpretação.
Para os quatro primeiros casos onde ter-se-ão formatos originais bem definidos, o processo de conversão será praticamente automático, com possível necessidade de algumas poucas informações complementares. Na condição da quinta fonte, tem-se uma situação de formato previamente indefinido e o processo de conversão necessitará de uma forte interação com o usuário e grande flexibilidade na manipulação do arquivo original.
Para o sexto caso deverá ser implantado um processo convencional de entrada de dados por digitação e finalmente na última opção, o ideal será um processo de digitalização da carta acompanhado de digitação das informações
Para os quatro primeiros casos onde ter-se-ão formatos originais bem definidos, o processo de conversão será praticamente automático, com possível necessidade de algumas poucas informações complementares. Na condição da quinta fonte, tem-se uma situação de formato previamente indefinido e o processo de conversão necessitará de uma forte interação com o usuário e grande flexibilidade na manipulação do arquivo original.
Para o sexto caso deverá ser implantado um processo convencional de entrada de dados por digitação e finalmente na última opção, o ideal será um processo de digitalização da carta acompanhado de digitação das informações complementares. Para tal, será necessário o interfaceamento e compatibilização da aplicação com os digitalizadores normalmente empregados.
Após a entrada de dados, deverá haver um processo de geração do arquivo de dados no formato da aplicação e opcionalmente a implantação de um cadastro desses arquivos.
Por último, é óbvia a necessidade de um processo de atualização dos arquivos e cadastro usando operações de correção, complementação e eliminação de dados. É desejável ainda que haja a possibilidade da listagem dos dados após qualquer processo de manipulação dos mesmos.
8.4.2	- Módulo de interpretação:	;
A figura 8.3 apresenta o diagrama da estrutura desse módulo que inicia-se a partir da leitura dos arquivos de dados no formato próprio da aplicação, seguido da conversão dos dados para o sistema de unidades escolhido para trabalho. A escolha do sistema de unidades é um componente natural das opções de condicionamento ("setup") da aplicação.
INTERPRETAÇÃO
FIG. «.3
A próxima etapa constituí-se na preparação dos dados atendendo ao disposto no terceiro capítulo. Também inclui-se nessa etapa, o fornecimento de informações adicionais não contidas no arquivo de dados e abrangendo condições físicas do poço e da coluna de teste, bem como parâmetros de fluído e rocha. Tais parâmetros são normalmente obtidos a partir de perfis do poço, correlações e análises laboratoriais dos fluidos produzidos, sendo em alguns casos necessário a realização de cálculos auxiliares para sua determinação ou conversão para o sistema de unidades em uso na aplicação.
As rotinas para executar os cálculos auxiliares citados acima não foram implementadas na aplicação para efeito deste trabalho em vista da grande diversidade de correlações e procedimentos laboratoriais existentes e por não ser este o objetivo básico do trabalho. No estágio atual da aplicação, pressupõe-se que o usuário tenha previamente determinado os parâmetros necessários e os forneça nas unidades convencionais de uso na respectiva tela de entrada. Pretende-se posteriormente avaliar um conjunto adequado de correlações e procedimentos laboratoriais, implementando-os a seguir no software.
Após a preparação dos dados, segue-se o processo de modelagem, onde a partir de um gráfico de diagnóstico e com auxílio de objetos gráficos, que podem ser colocados, movimentados e removidos do gráfico, são identificados os regimes de comportamento e escolhido o modelo mais adequado aos dados. A metodologia de modelagem foi descrita no terceiro capítulo.
Em seguida, conforme as escolhas do usuário são traçados os gráficos dos métodos correspondentes. O processo de traçado inclui o fornecimento ou alteração a qualquer momento, de alguns parâmetros básicos, o cálculo de funções para os eixos gráficos com dimensionamento automático e rotulaçao dos mesmos, bem como a montagem estética e rotulaçao geral do gráfico em si.
Como apoio a manipulação visual dos dados são implementadas opções que incluem as possibilidades de ampliação e redução de trechos dos dados, exibição da tabela de funções dos eixos para os pontos apresentados no gráfico e dimensionamento manual dos mesmos.
A partir do gráfico dos dados sob um determinado método escolhido, pode ser realizada a interpretação gráfica propriamente dita. Conforme o gráfico em uso, poderão ser utilizadas uma ou mais das possibilidades de metodologias.
No quarto capítulo foi descrita a metodologia de análise por curva tipo. Para esta opção e a partir do tipo de gráfico e do modelo selecionado, a aplicação traça uma família de curvas-tipo para o ajuste ou pelo fornecimento de valores dos parámetros característicos, a aplicação gefa urna única curva-tipo. São implementadas também a movimentação das curvas para o ajuste, sua remoção e a exibição do resultado do ajuste.
No quinto capítulo apresentou-se a metodologia de análise especializada. Nessa forma de análise, busca-se identificar no gráfico trechos lineares, para os quaís a aplicação realiza o traçado de retas utilizando o conceito de regressão linear por mínimos quadrados após a seleção do intervalo de pontos pelo usuário. Adicionalmente, tem-se a possibilidade de remoção seletiva das retas e a apresentação dos parámetros característicos de cada reta.
No sexto capítulo foi definida a metodologia de análise automática de testes. Para esta metodologia, a aplicação implementa todo o processo matemático descrito no referido capítulo com possibilidade de escolher o método de ajuste, a precisão de determinação dos parámetros, o número máximo de iterações permitidas e o número máximo de aproximações da busca linear. São geradas as curvas correspondentes a todas as etapas do processo iterativo e exibidas graficamente com os dados para acompanhamento visual do processo de ajuste. São ainda implementadas a seleção do intervalo de dados para ajuste pela ampliação ou redução do gráfico dos dados, a exibição dos resultados e a remoção do ajuste automático.
Feita a análise gráfica por qualquer das metodologías citadas e desde que tenham sido fornecidos previamente os parámetros de fluido e rocha necessários, a aplicação efetua o cálculo quantitativo dos parámetros de reservatório pertinentes a cada método.
Finalmente, nesse módulo são desejáveis a impressão dos resultados da interpretação quantitativa, a impressão da tabela dos dados com as coordenadas do método e a impressão ou traçado em "plotter" dos gráficos. Como estas facilidades constituíam apenas um processo saida, nao foi considerado como próprio para implementação durante a fase de elaboração desta dissertação e será incluido posteriormente visando o uso corriqueiro da aplicação.
8.4.3	- Módulo de elaboração de relatório:
A figura 8.4 mostra o diagrama da estrutura desse módulo que consiste na entrada de resultados selecionados da etapa de interpretação acrescidos de informações complementares da operação de teste e uma análise de todo o contexto pelo usuário incluindo comentários sobre os procedimentos, conclusões baseadas nos resultados e recomendações pertinentes.
ELABORACAO DE RELATORIO
FIG. 8.4
Todo esse conjunto de informações deverá sofrer uma montagem de acordo com os padrões de relatório técnico utilizados na Petrobrás e em seguida ser impresso. Adicionalmente, é desejável a alimentação de um banco de dados armazenando as principais características da operação, os procedimentos utilizados na interpretação e os resultados obtidos. Tal banco de dados poderá servir como fonte de consulta para técnicos, como meio de acompanhamento e gerenciamento de atividades e ainda como base de conhecimento para processos inteligentes de apoio à interpretação de futuros testes.
Por último, poderá ser necessária a implementação de um processo para criação de arquivo temporário com a finalidade de transmitir e alimentar bases de dados corporativas.
8.5	- Apresentação do "Software":
Para facilitar a descrição das características do software serão adotados os termos abaixo, que não têm a pretensão de definir todas as facilidades dos objetos padrão do Windows, mas apenas os recursos mínimos necessários à utilização da aplicação.
-	Barra titulo: Área superior de uma janela onde normalmente identifica-se a aplicação ou a própria janela, tendo eventualmente botões em suas extremidades. A cor apresentada pela barra título identifica a janela ativa num dado momento.
-	Barra de menu: Área da janela onde localiza-se um menu de opções identificadas por palavras-chaves.
-	Botão de sistema: Botão existente no canto superior esquerdo da janela, identificado pelo sinal de
-	Botão de maximizar: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de um triângulo com sua base voltada para baixo.
-	Botão de minimizar: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de um triângulo com sua base voltada para cima.
Botão de restauração: Botão eventualmente existente no canto superior direito de uma janela, identificado pelo desenho de dois triângulos com suas bases adjacentes.
-	Janela de diálogo: Janela exibida eventualmente com a finalidade de possibilitar ao usuário introduzir ou receber informações pertinentes ao processo.
-	Seleção: Ato de apertar o botão esquerdo do mouse quando o ícone de seta estiver sobre um item desejado, liberando-o em seguida.
-	Dupla seleção: Ato de apertar o botão esquerdo do mouse e liberá-lo duas vezes seguidas com o ícone de seta sobre um item desejado.
-	Arraste: Ato de pressionar o botão esquerdo do mouse e mantendo-o pressionado, deslocar o mouse até uma nova posição e então liberar o botão.
-	Arquivo ou período ativo: Conjunto de dados armazenados na memória, que num dado instante de execução da aplicação, está selecionado para uso na interpretação.
-	Opção ou campo ativo: Significa que o Windows permite a seleção da opção ou alteração dos dados no campo. A diferença entre o estado ativo e não ativo é percebido pela tonalidade de cor da opção ou campo. No caso de não ativo, o Windows exibe a opção ou campo numa tonalidade mais clara (cinza).
-	Janela ativa: Janela onde atuarão as opções de manipulação gráfica e interpretação selecionadas pelo usuário. É identificada pela barra título com coloração distinta das demais janelas.
A chamada da aplicação é feita a partir de seu ícone, constante do grupo onde o software for instalado. A fig. 8.5 apresenta a tela de chamada com o software instalado num grupo próprio. A fig. 8.6 mostra a janela (tela) principal da aplicação com sua barra de título e barra de menu.
A etapa inicial de utilização consiste em obter os arquivos de dados necessários a interpretação, o que é feito selecionando a opção "Arquivo" na barra de menu. A fig. 8.7 apresenta o sub-menu de "Arquivo", englobando as necessidades especificadas no item 8.4.1. Como já descrito nesse item, as opções de criação, conversão e atualização não foram implementadas. Desta forma, a única escolha implantada é "Abrir" atendendo a necessidade especificada no item 8.4.2,
Cabe salientar que a partir da fig. 8.6 e ao longo de todas as demais figuras apresentadas nesta seção, pode-se observar a ativação e desativação seletiva de opções na barra de menus, nos seus submenus ou no menu móvel, atendendo ao requisito de indução do usuário ao fluxo, descrito na seção 8.2.
A escolha do arquivo de dados para leitura é feita através da janela de diálogo apresentada na fig 8.8.
?? ......
sJ	...
W :.- .
Vquivo |
Abrir
[•d&amp;amp;a? Parlado Dadas .Mfet&amp;amp;dss .Qraílav	In^rpnrí^as
^^^uragSo Auxilio _______________________________________
Gísvíjf
G$w»f Cííís's*
finalizar
SSE
¡"TT
Pela seleção de letras de drive e nomes de diretório, a rotina construída para controle da janela, ativa a rota de diretório resultante e automaticamente atualiza a indicação do campo diretório e a lista dos arquivos de dados existentes nesse diretório. Com a seleção do nome de um arquivo, a rotina extrai o nome da lista e o coloca no campo arquivo. A fig. 8.9 apresenta o estado da janela após a seleção de diretório e arquivo.
A seleção do botão "OK" faz a rotina executar a abertura e leitura do arquivo, seguidas do armazenamento dos dados na memória, da indicação de arquivo aberto no submenu de "Arquivo" e da atualização na barra título como o arquivo ativo. A fíg.
8.10	mostra o submenu de "Arquivo" indicando os arquivos já abertos com o arquivo ativo marcado e a barra de título também indicando o arquivo ativo. Foi implementado um trecho de código na aplicação que permite a comutação do arquivo ativo pela sua seleção na lista presente no submenu de "Arquivo".
A opção "Editar" na barra de menu corresponde a necessidade de atualização de dados e como descrito no item 8.4.1 não foi implantada.
Com a existência de pelo menos um arquivo aberto, é ativada a opção "Período" na barra de menu. Com a seleção dessa opção, é aberto um submenu onde seleciona-se o período de teste desejado para interpretação (fíg. 8.11). Após a seleção do período, este é marcado no submenu de "Período" e indicado na barra título como o período ativo para interpretação (fíg. 8.12). Da mesma forma como foi descrito para os arquivos de dados, a aplicação implementa a comutação entre períodos com as devidas atualizações da marca no submenu de "Período" e na barra titulo.
A partir da existência de um período de teste ativo, são ativadas as opções "Dados" (preparação de dados) e "Métodos". A seleção da opção "Dados", abre um submenu com as opções "Par. Fluido/Poço/Rocha" (entrada de parâmetros do poço/coluna de teste, da rocha reservatório e do fluido produzido) e "Compressão". A fíg. 8.13 apresenta esse submenu aberto.
ANAWIN - (ATIVO: dados2.aw)
Arquivo ¿ditar Eeríodo Dadas	táayg&amp;amp;gftm (nteíp rotação
s anelas_^£onfÍ3uragSo_Ayxílio^^_____^_^	________________

ABRIR ARQUIVO
Nome do arquivo:
dados?.aw
Qirctãrio: andados
dadosl.aw	1
dados8.aw	1
dados5.aw	
dados2.aw	
dadosE.aw	
dados4.aw	
u	

Arquivo ¿ditar I Janelas ¿onfigi
&amp;lt;■ '4.::&gt;"' ANAWlN - (ATiyO Período
FLUXO-1 J3
M
I
T
T

•jãiüfr'; M8CS8ft8aSHiüBBg8MwJSMM8Mi8HlittBÍMMBMWJ ynnfTTBIBBf.'W-it iTJiíUPi^^reB^^DWW^WTw g1 kYzrKijTMMMM oraK'tffi8illBaSMagBMMBB3B8aB88MMI»^^y¿ j	r¿T J E	F&gt; j» 1 ■	|s&amp;amp;4K.,\IU74 BBHH|9S
¿rquivo Editar Período
Janelas £onfiguraç3o
/	I £ompressão	[
Métodos GrÃtke	loterpretaçao
|iw£
Com a seleção da opção "Par. Fluido/Poço/Rocha" é exibida uma janela de diálogo para entrada dos diversos parâmetros possíveis (fíg. 8.14). As unidades de entrada dos parâmetros foram adotadas procurando respeitar o sistema de unidades previamente indicado, mas também considerando a unidade de uso corriqueiro para cada um dos parâmetros.
A escolha do sistema de unidades é feita previamente a partir de uma janela de diálogo (fíg 8.15) que é exibida através de seleção da opção "Configuração'' na barra de menu seguida da seleção da opção "Sistema de Unidades" no submenu apresentado. No atual estágio do software, apenas o sistema de unidades Petrobrás encontra-se disponível e assim, é a única opção ativa para seleção.
A seleção da opção "Compressão" no submenu de "Dados", efetua uma redução no número de pontos do período ativo de acordo com os conceitos da seção 3.2 e com parâmetros previamente indicados. Os parâmetros citados são fornecidos na janela de diálogo (fíg. 8.16) que é aberta através de seleção da opção "Configuração" na barra de menu seguida de seleção da opção "Compressão de Dados" no submenu apresentado. O algoritmo de compressão não se encontra implementado.
A existência de um período de teste selecionado, torna ativa a opção "Métodos" na barra de menu. A seleção dessa opção, abre um submenu com a relação dos métodos implementados para utilização com o período ativo naquele momento. A aplicação implementa a verificação do tipo de período ativo e em seguida relaciona os métodos aplicáveis. As figs. 8.17, 8.18, 8.19 e 8.20 apresentam respectivamente, os métodos implementados até o presente estágio, para os casos de fluxo surgente, estática seguida a fluxo surgente, fluxo não surgente e estática seguida a fluxo não surgente.

¿rquivo ¿ditar PeríodoHados I Janelas Configuração Auxílio ]
MTiVP: dados4.aw/FLUXO-11
Métodos
________Gráfico ^í&gt;dsÍBí|SH! Interpretação
muiiuM.il,» ______________________________
Pxt	^..-■.v	V7,.-.V.&lt;-,	■:■	••
Drawdown
Derivada
Onur
dadosd.aw-FLUXO-1 -Pxt .
440.0
400.0
360.0
320.0
280.0
240.0
, ""íwSÈÈÈÈSÍ'’’’'
Wi

E
FLUXOS
L',L‘ .‘.‘w^.s»; • *	ííSÜ ■■■
■ ^S5-7:499-2&amp;lt;B *IS91/EXrERF
MÍÍÍ^ÍWJF-^-' •= J&lt;íft 8 ■ j^"1".1,1'i; iv 'j l l	'"'
ii&amp;amp;Z-X ~X ••... ■,/:::WX. :	- ,,- ^...
-.„.-i.	::™......-. ■■■^- &gt;
7-
&gt;z.™.
OO-,™ v„:
.•.‘.A. .•.W.W.Vjg}.^
WWW $£&gt;:£
'■ ■ '■ -
■ f .... ..
-■■ ■'
Itepi
Wfe-V-. “ „.,,.,M
Lys ¿ssí " &amp;amp;
wá


:«m3
200.0___
0.000
í:::::.s:Í^5?s s sT*
5.000
^■Ij
...'.:.TX
10.00	15.00	20.00
L\v7,ppP&lt;&lt;S&amp;amp;:;¿í^$z-;&lt;jS^
' Ssssasffii
■W'.
25’00
30.00
HHIIUIIIW
^tNAWIN - {ATlVO:dados4.aw/ESTAT-lf
..___________ ___________________
¿rquivo ¿.ditar Eeríodo ¡Jados Janelas ÇonfiguraçSo Auxílio
Métodos
Modelagem
Çràfico MíjdK-iñgívH’í Interpretação
s9mhhhhííhHHmBÍKS^^u3
Arquivo Editar período gados Janelas gonfiguração Auxilio
(ATIVO: dados?.aw/FWXO-2) ? Métodos
Modelagem

gráfico	Interpretação
WADO
í£
245.0
240.0
235.0
230.0
■■ dados2.aw - FLUXO-2 - P x t
7--^—
15.00
3ÕtôÕ
■[¡[¡■¡¡¡■¡■SXjWK'X'W MV.-ilÜNNN’*' ,j
P P^ :&gt;-■:■-
75JÕ
6ÕÍÕD
4EUI0


225.0
220.0
215.0
0.000


90.00 B

WWWWWTM ^^■E^SSHHHBH|Hfi|^^BHrK?WVrnrH !?7!£^bSSSSI^^KSSSSbSsS£b^^^H^^^F£1 i fiViLi I k H ¿rquivo Editor gcriodo Qados Janelas £onfigurag3o Augilio
(AT J VO;dajos^.w/ESTAT4i :	&amp;lt;&amp;lt;' .	-
Modelagem

ifinnl
Onur
■
230.0
'
..: :?O3 &amp;amp; ;
210.0
170.0
150.0
190.0
....
«.WvW.vWWO^?^
Sski. ' \
.&lt;&lt;&lt;?
irMW'Z'KWW'X
^8'" "V’”

130.0
%■
00
110.0.
0.0
1.500	~ 3.000

XV V«x&gt;
i L

":" '"'W
WWlw :SS$». ■: :
:-,	■■■■■■:';:.	■«/.&amp;lt;SiZ-&lt;.,
... .•v&gt;&lt;’j!;!irz&lt;;xx&lt;^:
4.500
	
7.500
9.000
A seleção de um método faz com que seja criada uma janela contendo o respectivo gráfico para o conjunto de pontos do período ativo. O processo inclui o cálculo das funções dos eixos e como em alguns métodos é necessário o fornecimento do valor de determinados parâmetros pelo técnico, é exibida nesses casos uma janela de diálogo para tal fim. A fig. 8.21 apresenta um exemplo dessa janela. A janela é padrão para todos os métodos, mas a sua rotina de controle ativa apenas os campos de dados pertinentes ao método. Após o fornecimento dos valores, é realizada a consistência de restrição dos valores fornecidos.
O processo de criação do gráfico verifica os intervalos de valoies das funções em cada eixo e realiza seu dimensionamento considerando o tipo de escala necessário. A rotina de traçado do gráfico implementa a capacidade de se autoadaptar ao tamanho atual da janela com seleção das informações do cabeçário e variando o número de rótulos em cada eixo. Como as dimensões de uma janela de método são inicialmente determinadas pelo próprio ambiente Windows e podem ser alteradas pelo usuário ou pelo Windows em qualquer das dimensões, a capacidade de autoadaptação toma-se imprescindível.
As dimensões, posição e arrumação das janelas de método podem ser modificadas pelo usuário de diversas formas. A largura ou altura de uma janela de método, pode ser alterada pelo arraste de suas bordas. A posição de uma janela pode ser mudada pelo arraste de sua barra titulo. Selecionando-se o botão de maximizar, a janela de método passa a ocupar toda a extensão possível (abaixo da barra de menu), consequentemente assumindo a máxima resolução (fig. 8.22) e pela seleção do botão de restauração, retoma ao seu tamanho anterior. A seleção do botão minimizar, transforma a janela em um ícone. A dupla seleção do ícone restaura a janela à sua condição anterior e a dupla seleção do botão de sistema fecha a janela, eliminando da memória os dados do método.
ANAWIN ~ {ATIVO: dadag4.aw/FLUXO- lj - {dadosd.aw - FLUXO-1 - Derivada)
Hl ¿rquivo Editar Eeríodo Hados Métodos Gráfico Msfst'írjgsm JnterpretaçSo ¿anclas £onfiguraç3o Auxílio
103
102
101
ID0
í?	i	J* ||Ofe«Vad*--M lnU495.7-499&lt;m iiiiiiili			
	jtíSMiK*SSi:	5sllã^fe~àá	|SÍ»iS
*	-,s x/?:&lt;-:-.-::&gt;y&lt;v.-:-.;.’&lt;,	’7:«w*hÍ ... ■:	W:l Oí Í:í:X: J...,,, inS** 3;¿;:::si«&lt;....^	.Jj". ‘j ‘j ‘jJj jjVj 'j1' ‘ i1' Lu." BI ■ ■ "	'. i .’.’.’ .■-■.■.".■-■-■-■-■j"-"j"jJj wí?í?íízXía UzXvzívzív	'. '. ‘ ' "v. ” .. . %&amp;lt;■■ ■ ‘	^-ík t. IB .A.A./V	• ..	/	.	A-4._.A^.‘ . '■'."■'."■W.'AVMViVM'MVi\mMmA&gt;W'.’&gt;WM	^P.?:níI?.:::^«-;:	Sf ■ i'.fcí™"'-- *’'	'v«»w;
í* \&amp;lt;.	--Ãsv f, 3y,	v \ '	:	z “	' ' ‘ à , ., ; . -‘_ '-/\.Z«ZA&amp;lt;Xy#&gt; fSX^t ► ■ '-. .' ■ '.^ RP-qf	■;&amp;lt;&amp;lt;■'	Xv	: •’’. ... ív”&amp;lt;K«i , • •"	-?•&amp;lt;*	t i . t i i i	,,,, '; v,' '^ ’wa A\N%’’ ’:, ;A'WV.« ;. "^ '	,, ; ., ^v&gt;x vv:v,’ ','; -\x\$^j.&gt;a1. s; ' '	q 	i	.4	.4....»...f...4..4.i,	&gt;W4»M .	,	. ” ’ ' " ' ' &amp;lt;v’ ¿«^ .; . &amp;lt;&gt;»&gt;-W4.k	D -. A»	.	’ 'sssj- " PP	:-: 	 i	&amp;lt;t t i f i r	rt	'' í 'J " w' ''” P '“™ ‘ p s ....ppp ■ *	” ‘‘ , ÍX^ " &amp;lt;:1 1&lt;	.../i-
lü’2
io'1
10°
1
ns
102
Quando existem várias janelas de método abertas, podem ser utilizados diversos recursos para organizá-las. Selecionando a opção "Janelas” na barra de menu é exibido o respectivo submenu tendo na sua base a relação das janelas existentes com a janela ativa marcada (fig. 8.23), A seleção da opção "Cascata" organiza as janelas sobrepostas umas às outras com dimensões idênticas e tendo a janela ativa sobre as demais (fig. 8.24), A seleção da opção "Lado a Lado" faz com que o Windows redimensione as janelas e coloque-as lado a lado ocupando a extensão da janela principal (fig. 8.25). Adicionalmente podemos ter a convivência das opções acima com janelas reduzidas a ícones (fig. 8.26). A seleção da opção "Arrumar ícones" distribui e organiza os ícones de janela de método, porventura existentes, na base da janela principal. Finalmente, a seleção da opção "Fechar todas", cerra todas as janelas e ícones existentes eliminando da memória os dados dos respectivos métodos. A comutação da janela ativa entre as existentes, pode ser feita pela seleção em qualquer área da janela desejada ou na lista do submenu de "Janelas".
O conjunto de opções de manipulação de janelas, descrito nos parágrafos acima, mostra a grande potencialidade de um "software" para análise de testes utilizando interface gráfica. Obtem-se a capacidade de manipular rapidamente e interagir simultaneamente com uma grande diversidade de métodos aplicados a vários períodos de teste e conjuntos de registradores.
A primeira opção do submenu de "Métodos" é a modelagem, que como foi descrito na seção 3.3 auxilia na identificação dos regimes de escoamento e do modelo poço-reservatório. Ao selecionar esta opção, além da criação da respectiva janela de método, são ativadas as opções "Gráfico" e "Modelagem" na barra de menu e ao selecionar qualquer outro método são ativadas as opções "Gráfico" e "Interpretação".
: Janelas
Cascata
440.0
400.0
360.0
320.0
280.0
-wÁÍ.Y . ?v:
Yz^x^cíwk^^í:
240.0
200.0 _ 10‘2
ID'1
Métodos Gráfico	Interpretado
-1 - Derivada
dados4.aw - FLUXO-1 - P x i
ANAWIN (ATIVO: dadosl.aw/fLUXO-l) "


102
101
10°
103
Lwn - JJwq K\-Áí::.'.	ÉW			■t.- iíí^í^^sswííZ..;"^
	^T’TTTT’	i	1 ”r” B?otíÍI«^í		
			SsãHte	
;SS:S^S: -s ■j&gt;'! '■: ;&amp;lt;:-j-■/ -i,		;|g|ggg;s«	■'^ “x¿.-- ■' '■ ’	/V	&lt;5¿:?:::"í:;:8 ■:^S':'"í^.:&gt;t7.^'.
! H»íirtíaB.ise»w '? ■■■■^ ..« i t..i.ui'ii		etía.»?’’®- s ‘ : - • , . '■■ \?.'.'...¿S J .t.i H.I.	&gt;WMwWi	.v^' .•#» X' '	v’, '5 .. ÍJM r-..i-’-’- J : «Vm-r
10’1
101
10 z
lo2
FIG. 8.23
Arquivo Editar Período Qados Métodos Gráfico MíYyxíí—K Interpretação Janelas Configuração Auxílio
dados4.aw-FLUXQ-1 - Derivada dados4.aw - FLUXO1 - Drawdown da dos4.aw - FLUXQ-1 - Pxt
4
4
3
3
2
2
2
4
4
3
3
2
2
2
IO-1
102
10°
103
IO1
s,ÍLt|&gt;	F5/$2^y	■■■■■«:«»“■■■■■ "w'^íY*feX		
L... . ;Mi;	«■«•5SS B^^aa	1»» Bsbsr	
			
È '■ k - ' 7?/	‘ ‘ ‘			■?', '-^ -¿,&lt;&lt;1
»&gt;&gt;xvaxvas»^y&lt;-bb:^we^^c-:ò&gt;j:-&gt;: &amp;amp;*•&gt;,	.	't’-,,,,, ■■^■■■■^ f-. :::±.:.t..í.i .t-it		X	J	^SWsSÍÍÍÍoííoíSíix-^x-Maíx',;.!. «íí; :'í-j
IO'1
10“2
MvW' - (ATlVO: dados4.aw/FLUX0 1J
Arquivo ¿ditar Período Pados Métodos firâfico	Interpretação
Janelas Configuração Auxilio
dadosd.àw - FLUXÒ-1 - Onur
dados4.aw - FLUXO-1 - Drawdown
:&gt;&lt;ÑÑSSSá'
440.0
320.0
k’.W.c'g'
rñíítiíirri'r??
12.00


200.0
0.000
A opção "Gráfico" na barra de menú reune um conjunto de facilidades para manipulação do gráfico do respectivo método. Quando selecionada, ela apresenta o submenu da fig. 8.27. Todas as opções desse submenu atuam sobre a janela de método ativa no momento.
Quando selecionada a opção "Par. do Método", será exibida a janela de diálogo descrita anteriormente (fig. 8.21), possibilitando a alteração dos parâmetros do método a qualquer instante. Cabe salientar que esta opção apenas estará ativa quando o método fizer uso de parâmetros.
Selecionando a opção "Tabela de Pontos" (fig. 8.27), é apresentada uma janela de diálogo onde são listadas as coordenadas dos pontos gráficos (fig. 8.28). É possível examinar as coordenadas de qualquer ponto dos dados pela rolagem da lista através da seleção dos botões existentes na borda direita. Para fechar a janela, seleciona-se o botão "Retomo".
A seleção da opção "Ampliação" (fig. 8.27) permite que o gráfico seja restringido a qualquer intervalo de pontos desejado, consequentemente aumentando a resolução de interpretação do intervalo. Ao selecionar esta opção, a aplicação muda o ícone de seta para retículo, restringindo a movimentação do mouse à área gráfica da janela de método em preparação para a seleção do intervalo de pontos. Deve-se então posicionar o ícone de mouse próximo a uma das extremidades do intervalo desejado e realizar um arraste até a outra extremidade. Durante o arraste, a aplicação desenhará um retângulo tracejado do ponto inicial do arraste até o ponto onde está localizado o ícone de mouse, gerando o efeito de enquadramento gradativo do intervalo a ser ampliado (fig. 8.29). Ao final do arraste, é ativado o algoritmo de reconhecimento dos pontos enquadrados e em seguida efetuada a ampliação com redimensionamento automático do gráfico (fig. 8.30).
■M—
AtyÁWIN - (ATIVO: dados?.aw/FLUX0-2)
¿rquivD £ditar Período Qados Métodos Janelas £onfiguraç8o Auxílio
Gráfico
dados?,aw - FLUXO-1 - P
112.9
97.20
81.46


Í&amp;amp;íSSSSmk.........
65.72
49.98
34.24
18.50
DUjl--
0.000

224.2
220.1
215.9Í1
D.CÜÕ
232.5
228.3
240.7
236.6
«na
12.42	24.83	37.25	49.67	62.08	74.50
ANAW1N - {ATIVO: dados2.aw/FLUXO-2]
dos Gráfico hfegÇiSííft?» Interpretação
TABELA DE PONTOS
Ponto	Abdssa	Ordenada	
0008	0.75000	228.015	
0009	0.83330	225.484	
0010	0.91670	227.453	
0011	1.00000	228.646	
0012	1.08330	227.242	
0013	1.16670	220.156	ã
0014	1.25000	228.578	j£*
0015	1.33330	228.086	o
0016	1.41670	228.853	
0017	1.5DDD0	228.578	
Iados2.aw - FLUXO-2 - P x t
::
:■: ¿íxí-x-xÍ:^]
'.*JV .X
224.2^ís::?&gt;:í
X-
236.6
232.5
228.3
:;X;
Kw?av$vKw»^-:
wwi¡\»v.v.w&gt;zW&gt;
220.1
215.91_ O.OOÕ

xgxg;
12.42
:''
&lt;g
24.83	37.25
:-:-:-xc.!.y«eC:í z/Zv--,..' ,,, , :


ijíiwí
• li
tvXv.	|
dite
XX ■ z -- -M
?X/7X-
sr^^" J

xg:
49.67
62ÍÕ8
74.50
É permitido um máximo de 3 ampliações. Caso a área enquadrada não possua pontos, será exibida uma janela de diálogo informando a inconsistência e dando oportunidade ao usuário de redefinir o intervalo ou desistir da ampliação (fig. 8.31).
Com a seleção da opção "Redução" (fig. 8.27) é desfeita a última ampliação realizada. Note-se que esta opção somente estará ativa caso haja sido efetuada pelo menos uma ampliação.
A seleção da opção "Dimensionar Eixos" (fig. 8.27) apresenta uma janela de diálogo onde o técnico pode redimensionar os limites de cada um dos eixos gráficos, possibilitando um aperfeiçoamento visual da distribuição dos pontos e das retas ou curvas porventura existentes. A janela de diálogo informa os limites das coordenadas dos pontos e implementa a consistência com os valores solicitados de modo a evitar erros de dimensionamento (fig. 8.32).
A opção "Imprimir Tabela" (fig. 8.27) tem por finalidade gerar uma listagem na impressora dos dados originais do período de teste acompanhados dos respectivos valores das coordenadas gráficas. No atual estágio da aplicação, esta opção não está implantada.
A opção "Imprimir Gráfico" (fig. 8.27) deverá realizar a impressão do gráfico constante na janela de método através do equipamento previamente configurado no Windows. Atualmente, esta opção não está implementada.
Quando selecionada a opção "Copiar Gráfico" (fig. 8.27), a aplicação faz uso das facilidades do Clipboard, descrito na seção 7.7, para efetuar uma cópia do gráfico constante na janela de método para a memória, permitindo que outra aplicação ou "software" tenha acesso a uma cópia do gráfico. As vantagens dessa característica são bastantes óbvias.
FIG. 831

ANAWIN - (ATIVO: dados2.aw/FLUXO-2]
Arquivo Editar Período Hados Métodos gráfico Janelas Configuração Auxílio

i Interpretação

“ Eixo X Menor Abcissa dos Pontos:
0.00000
Maior Abcissa dos Pontos:
74.5000
Diferença entre Abcissas: Valor Inicial para o eixo: Valor Final para o eixo:
74.5000
0-2-Pxt
» ! * í
"Eixo Y
Menor Ordenada dos Pontos:
ELUXO-2
0-82
Maior Ordenada dos Pontos:
Diferença entre Ordenadas: Valor Inicial para o eixo: Valor Final para o eixo:
Ti
215.322
240.741
24.8194
215.000
245.000
cancelé
th.
JOfli/EXTERNO
11.8
75.00
90.00
Quando a janela de método ativa contem um gráfico de modelagem, a opção "Modelagem" na barra de menu estará ativa e quando selecionada, exibirá seu submenu (fig. 8.33). A seleção das primeiras 4 opções desse submenu, gerará no gráfico o correspondente objeto, cuja utilidade pode ser compreendida pelo descrito na seção 3.3. Podem ser traçadas um máximo de 5 retas no gráfico. Apenas como ilustração, a fig. 8.34 apresenta um gráfico onde estão presentes os 4 tipos de retas de modelagem. Qualquer uma das retas, porventura existentes no gráfico, poderá ser movimentada por arraste quando o ícone do mouse estiver próximo a reta desejada. Tal característica é implementada através de um algoritmo desenvolvido para reconhecer a reta mais próxima, fazendo uso da equação analítica das retas existentes no gráfico.
Qualquer reta de modelagem poderá ser retirada do gráfico pela seleção da opção "Apagar" (fig. 8.33) seguida do ato de apertar e soltar o botão esquerdo do mouse próximo a reta desejada. Essa característica também faz uso do algoritmo citado no parágrafo anterior.
Após o uso adequado das retas sobre os pontos do gráfico, pode-se identificar e qualificar os regimes de comportamento pela seleção da opção "Regimes" (fig. 8.33). Selecionada a opção, a aplicação atua de forma semelhante ao processo de ampliação, sendo que agora o técnico procurará enquadrar o intervalo de pontos de um determinado regime de comportamento (fig. 8.35), Ao finalizar-se o enquadramento, é exibida uma janela de diálogo (fig. 8.36), onde o interpretador poderá qualificar adequadamente o regime pela seleção do botão correspondente. Ao pressionar o botão de "OK" a aplicação retira a janela de diálogo e muda a coloração das marcas nos pontos pertencentes ao intervalo identificado, adotando a cor correspondente ao regime selecionado (fig. 8.37).
MíHs^ntEtnSjí!
^sjü • BSEESssm
Arquivo ¿ditar Período Qados Métodos Gráfico Janelas Configuração Auxílio

ÀtMIÀWlN -&amp;lt;ATIVÕ: dádQs4;avM^-Âr?iH
Modelagem Reta 1/1
imwà

103
dàdos4.âw FLUXÜ-1 - Modelagem
Regimes Modelo
Modelagem	1 í	1-DADOS-4-AA	TFFV4 - &gt;&amp;lt;• 495.7-499.2 m	4 991/EXTERNO 94/05/92	498.Q . :			FLUXO-1 1-50	■
F7v " " .7 "	*1¿; ’	.	&lt;s.a.		■; y " i ' J ' ♦ » » J i +	1 AvZ ?■ 7 4 H “zJl	A”S&lt;]	.VA gasanoDOSBoaocD - ■” '	"4—T"n—1 1 lit :.	■■ &amp;lt;I ..	A	,* aaafflEW -a:	
		ggãSãwB8Bà8aa^	ífiFÍ	A" % ■		
’ . A- ' ' \ \ A-”&gt; . ± . j V.±.j.a o.			■■■■■t.A	.i ..4.:Á..¿'±.t.4J	ti^epEiflOn 4 .■■&lt;■ &gt; í„i n	3^«na . ! .	.	,’A	s ’ C í¿rlí LÍ í t	
Arquivo Editar Período Dados Métodos Gráfico Modelagem Janelas Configuração Auxílio
ANAWIN ? (ATIVO; dadostaw/FLUXO-1)
ív':c&lt;X-: í£:?4;


ANAWIN (ATIVO; dadoslaw/FLÜXO-H ;
Arquivo ¿ditar Período Dados Métodos Gráfico Modelagem Janelas Configuração Auxílio
dadusd.aw - FLUXO-1 - Modelagem
. : L	1-DADOS-4-AA ' TFR-4	Ft t tVA-1		
Modelagem	495.7-499.2 m 4991/EXTERNO .			
“—'t'"vn"r	94/05/92	.	498.0 t? ,,,7.,.,,,^, ~..r.,. (.. y y,(y (.. -yy,y	? y * -w-	«	&gt; r'r ri u		
10
J J liX.U
ísWÍÍÍÍSÍOií

Arquivo Editar Período fiados Métodos gráfico Modelagem Janelas Configuração Auxílio

: dados4.aw - FLUXO-1 - Modelagem;

103
1-DADOS-4-AA TFR4 4991/EXTERNO 1 : 498.0
["'i'"! t i rn.
Modelagem ,495.7-499.2 m.... ' 04/05/92
—r_rrTT^_j—jt—r.,,t.,.a,.;t..í.:|.f
FLUXO-1
.1-50
/ví ¡W$CjA&lt;
r.r/Ttrrm
• •
iíiw:
102
11111111 I JJ^I 11111 H
:$
:..x
:-.,	„ .&gt;y«A vtz&lt;
XvKWÍ
l jCjL£jlí l




Tal característica é propagada por qualquer janela de método utlizando o mesmo período de teste, permitindo a fácil visualização dos regimes de comportamento em todos os gráficos de métodos e consequentemente promovendo uma validação da modelagem. A propagação citada é possível em função dos intervalos de regimes fazerem parte da estrutura de dados, como descrito na seção 8.3.
Finalmente, após identificados os possíveis regimes, pode-se escolher o modelo poço-reservatório mais adequado para os dados pela seleção da opção "Modelo" (fig. 8.33). Esta opção apresenta uma janela de diálogo com um campo descrevendo o modelo "default". Selecionando-se o botão ao lado do campo, abre-se uma lista com as possibilidades de modelos para escolha (fig. 8.38). Pela seleção de uma das opções listadas, o campo de modelo é automaticamente atualizado e designado àquele período de teste pela rotina de controle da janela. Assim, durante as posteriores operações de interpretação, o modelo aqui selecionado será assumido como "default", não impedindo que outros sejam eventualemente utilizados, como será visto mais adiante. No atual estágio da aplicação, apenas o modelo de reservatório homogêneo infinito com efeitos de estocagem e película encontra-se implementado, contudo como foi mostrado nas últimas figuras, a aplicação já se encontra preparada para operar com diversos modelos.
Para facilitar e acelerar o processo de modelagem ou interpretação, a aplicação implementa um menu móvel, acionado pelo botão direito do mouse e que se posiciona automaticamente no ponto onde se encontra o ícone do mouse. Este menu contem as opções do submenu de "Gráfico" junto com as opções do submenu de "Modelagem" ou de "Interpretação" . O conjunto de opções apresentadas é automaticamente escolhido e tem seus estados ativados ou não, em conformidade com o método da janela ativa e com o estágio atual do processo. As fig. 8.39 e 8.40 apresentam como ilustração, duas possibilidades de apresentação desse menu.
Í|[	ANAWIN - {ATIVO: dados4.aw/FLUXO-1)
Arquivo Editar Período Dados Métodos Gráfico Modelagem Janelas Configuração Auxílio 
Arquivo Editar Período Dsdos Métodos gráfico Modelagem Janelas Configuração Auxílio
T
1-DADOS-4-AA
Modelagem ; 495.7-499.2 m 04/05/92

dados4.aw- FLUXO-1 - Modelagem
TFR-4 ; 4991/EXTERNO 498.0
o FLUXO-1
1-50
pç
Tabela de Pontos Ampliação
Dimensionar Eixos
Reta 1/1 Reta 1/2
Reta 1/4
Reta Hor¡2. Apagar Regime Modelo
Imprimir Tabela Imprimir Gráfico Copiar Gráfico

IO2

ANAWIN ~ (ATIVO: dados2.aw/ESTAT-1)
Arquivo ¿ditar Período fia dos Métodos Çrifico	Interpretação
Janelas Configuração Auxílio
Quando a janela ativa refere-se a qualquer outro método diferente de modelagem, a opção "Interpretação" na barra de menu estará ativa e quando selecionada, exibirá seu submenu com as opções ativadas de acordo com as metodologias de análise cabíveis ao método e o estágio atual de interpretação. As fig. 8.41 e 8.42 mostram a situação do submenu, respectivamente para os casos de um método que utiliza curva típica e um método especializado. Note-se em ambas as figuras que as opções "Cancelar" e "Resultados" estão desativadas por ainda não haverem sido realizados processos de interpretação nos gráficos.
A opção "Ajuste Manual" implementa o processo de utilização da metodologia de Análise por Curvas Típicas descrita no capítulo 4. Quando selecionada, esta opção inicialmente exibe uma janela de diálogo (fig. 8.43) onde o técnico pode alterar o modelo poço-reservatório "default" e introduzir os valores dos parâmetros característicos da curva típica. No caso dos parâmetros característicos terem valores nulos, ao selecionar-se o botão de "OK", a aplicação fechará a janela de diálogo e substituirá o gráfico dos pontos pelo gráfico de uma família de curvas típicas relativa ao modelo poço-reservatório vigente, colocando os pontos dos dados numa posição inicial pré-definida pela aplicação (fig. 8.44). A seguir, pelo processo de arraste com o ícone de mouse em qualquer posição dentro da janela de método, desloca-se o conjunto de pontos dos dados até obter-se o ajuste desejado.
Durante o processo de arraste, o ícone de mouse é escolhido pela aplicação de modo a indicar as possíveis direções de movimentação. Como descrito no capítulo 4, para o método da Derivada, pode-se movimentar o conjunto dos dados em ambas as direções simultaneamente (fig. 8.45). Já para o método de Onur , a movimentação e o ajuste é seletivo (fig. 8.46 e 8.47), com a comutação da direção feita pela seleção da opção "Ajuste Vertical" no menu móvel (fig. 8.48), a qual apresenta-se marcada quando o ajuste estiver sendo vertical.

ANAWIhl - (ATIVO: dmtos2.aw/ESTÁT-1)
¿rquivo Editar Período Dados yétodos £ráfico	.;v.:
Janelas Configuração Auxílio
'51'
Interpretação
Ajuste Manuel
Extrapolação
240.0
230.0
220.0
210.0
Bi-
dados2.ôw-ESTAI-Í-Hurner
Horner	1-DADOS-2-AA	TFR-1 ...... .	- 553.0-56B.O m 108O1/EXTERNO				ESTAT-1 1-39 ?
	05-07/04/09		511.0		
1 		 f '; v: Z"' ? “	—’—1	1 J l...					"i;	 			 íííjsSíMáííS^jjss^ííí		■"f i ■'■(■■ "(■■■(■ . **
H'	' ./■7W0e&gt;B				-i
-			&lt;&gt;55555555::::&lt;í-::&lt;&lt;&lt;&lt;^$5?		 bb« j		-
				 “z	“T a ¿/		
			...	~	:v...	*	1 a B	1 ‘ ‘ ■&lt;
-w 4	-1.	í J 1	i 11.		j-'-'» ;y,í i * 111	;x	—1 t-J-,l-,t 11,
200.0
190.0
180.0
nósnBáw&amp;amp;ssn
		ANAWIN - (ATIVO: dados4.aw/FLUXO-1)		
Arquivo Janelas		Editar Período Dados Métodos gráfico M ; j Configuração Auxílio	Interpretação	

PARÂMETROS
Reservatório Homogéneo Infinito

CdeZS -
i	_C ' ■'i OS008 :ftB® 	"y,,,,;,-	n.„. . .°® . i; llHilMBlO	Sc.&amp;lt;'	,J L’	X’ í; ■
2			'7. 	 5	»	if,tsa8a ,	.-&lt;?•. í
				
				
		Lj 1—2-À&amp;lt;T&amp;lt;m		.i ■ . . . ■ &gt; m:						 				 ."•■• f.- t■ .&lt;.m £
2
104
Interpretação
Arquivo £ditar Período Dados Métodos gráfico
J an e I a s Ço nf i guração Auxílio
iWÁWIN - (ATIVO; dados
Interpretação
da d os 4.aw - FLUXO-1X Derivada /;
Hl
Arquivo ¿ditar Período Dados Métodos firático M janelas gonfiguração Auxílio
10 *	itr	10'	10	10J	10	
						
-.¡¿¿¿¿fr;KUHBMiKMPirifiMMMSSMEffleSKaBwBMKaãaaBSBHfZl 7T FAT.TJ í j jUçMflMTF.%■ lTjÃ iStETra	K^tYrrJ 9 ■ &gt; t Sl ■ 1
11' '*■ WWafM8K!M**WHpKWCMfWI!iMSM5SgEgMaMM3BBtanKlMgi' V fb1*&gt;} L MbbSÍ íàlll XT.^MI r [« li IIBmIT W# l r J1 M	B B
Arquivo Editar Período Dados Métodos fíráfico
J a n elas fionfiguração Auxílio
Interpretação
dadoa4.aw • FLüXO-1 - Onur
■í J 1 UM
-i 1 .i.iUJl
Onur	14DADOS-4-ÀA		TFR-4 49 91/EXTERNO		FLUXO-1 ■ 1-50 :;•
	495.7-499,2 i 04/05/92 :	0			
			, 49B.0		
r~~«"’T"»"»	rrrn— 'j T j 'riHtt				 "i 'i'S'1 &gt;iJ' ........ .		1-1 /'‘Wlí	’ ' ”'y .	' f'*
&gt;‘"J	s.?					' A’ *■
fr "’	‘ V V, “ ‘	7.^1		-^ptfDCO!	rricmtxflccDmtf	í	■■-	, a’ H : •**’&amp;lt;: , ’ '
103 104

	Onur.	1-DAD0S-4-M 4 95.7-499.2 m		TFR-4 . . 4991/EXTERNO
&lt;1 1D3	s	.’1	■' &gt;		4/05/92 	rTTTTTtt	498.0	&lt;■ 	i"»1» i &gt;» —~~i—r &amp;lt;rm

Arquivo Editar Período gados Métodos gráfico	Interpretação
Janelas Configuração Auxílio
VDAD0S-4-AA 455.7-493.2 m 04/05/92 n--j—i "i j 11 ni"
1D“
101
10_1
dados4.aw - R.UXO-1 *'Onur
TFR-4 ;
4991/EXTERNO .498,0
i.i"»'i i rrr
X;.
FLUXO-1 l“50
■ T:. ri l 11 rs
Tabela de Pontos Ampliação
Dimensionar Eixos
Ajuste Manual 7 Ajuste Vertical
Ajuste Autom.
í..’ • í' tf&amp;lt;•: &gt;	;•
Cancelar Resultados
Imprimir Tabela Imprimir Gráfico Copiar Gráfico

FIG. 8.48
Durante o processo de arraste para ajustamento, em qualquer dos dois métodos, atua um algoritmo desenvolvido para identificar e atualizar um ponto de ajuste entre o gráfico de curvas típicas e o conjunto de pontos, Ao finalizar-se um arraste, a aplicação ativa um outro algoritmo desenvolvido para identificar automaticamente a curva típica onde foi realizado o ajuste. Este algoritmo realiza uma verificação dos resíduos de ajuste entre o conjunto de pontos dos dados e as curvas típicas com varredura proporcional ao número de pontos. Identificada a curva típica onde foi realizado o ajuste, a aplicação armazenará os valores de seus parâmetros característicos.
Quando a janela de diálogo da opção "Ajuste Manual" contem parâmetros característicos não nulos (fig. 8.49), a aplicação gera no campo de Laplace a curva típica correspondente e após invertê-la numericamente, traça-a sobre o gráfico dos dados numa posição pré-definida pela aplicação. Diferentemente da situação descrita nos parágrafos anteriores, o processo de arraste para ajustamento passa a movimentar a curva típica e não o conjunto de pontos. A identificação de um ponto de ajuste é feita pelo mesmo algoritmo já citado. Permanecem também idênticas as considerações sobre as direções de movimentação para os métodos da Derivada e de Onur.
Selecionando-se a opção "Resultados" (fig. 8.50), a aplicação exibe uma janela de diálogo com os parâmetros característicos da curva típica de ajustamento e as coordenadas de um ponto de ajuste comum ao gráfico da família de curvas típicas e o gráfico dos dados (fig. 8.51). Caso previamente tenham sido fornecidos os parâmetros de fluido/poço/rocha, serão também calculados e exibidos os parâmetros resultantes da interpretação (fig. 8.52).
A seleção da opção "Cancelar" (fig. 8.50) retorna o gráfico da janela de método a situação de ausência de processo interpretativo e elimina da memória quaisquer parâmetros ou informações oriundas desse processo .
¿rquivo Editar Período Dados Métodos gráfico Janelas gonfiguração Auxílio

Interpretação
Derivada
1 ' ■l—tTT
1---?")") jjf
Ajuste Manual Ajuste Autom.
dados4.aw~ FLUXO-1-Derivada
1-DADOS-4-AA	TFR-4 .
495.7-499.2 m 4991/EXTERNO 04/06/92	490.0 ;


FLUXO-1
1-50 ;
i—r—r-rrrrc
' ■■ :
Tabela de Pontos Ampliação
Dimensionar Eixos
Cancelar Resultados
Imprimir Tabela Imprimir Gráfico Copiar Gráfico

102
_______________________ANAWIN - (ATIVO: dados4.aw/FLUXQ-1] Arquivo Editar Período JJados Métodos £íráfico Janelas Ço nf i gu ra ção Auxílio
Interpretação
A opção "Ajuste Automatizado" implementa a utilização da metodologia de Análise Automatizada descrita no capitulo 6. Quando selecionada, a aplicação verifica inicialmente se existem valores adequadamente definidos para os parámetros fluido/poço/rocha. Em caso negativo, ativa a janela de diálogo (fig. 8.14) já descrita.
Como foi definido e justificado na seção 6.3, utiliza-se um ajuste manual em curva típica como estimativa inicial para o processo automatizado. Desta forma, a aplicação verifica a existencia de um ajuste manual previo e em caso negativo, suspende o processo de análise automatizada e solicita o ajuste manual.
Tendo as duas premissas acima satisfeitas, a aplicação realiza o processo de análise automatizada com exibição de todos os passos intermediarios de ajuste. A fig. 8.53 apresenta para ilustração, o resultado gráfico final de um ajuste automatizado.
Através da opção "Ajuste Automatizado" do submenu de "Configuração", é exibida uma janela de diálogo (fig. 8.54) onde podem ser alterados os parámetros governantes do processo. Como pode-se observar, é possível selecionar o método a empregar, ativar ou não a participação da curva de derivada no processo de ajuste, estipular a tolerância relativa de variação entre iterações dos parámetros a determinar para encerramento do processo de convergencia, além de fixar o número máximo de iterações e de aproximações por busca linear. Atualmente, o método de regressão SVD não encontra-se implantado.
São implementadas verificações de ocorrência de singularidade e ultrapassagem dos limites impostos na configuração acima descrita, com o intuito de proteger o processo e informar ao técnico usuário o encerramento do ajuste em condições anormais e portanto, sem possibilidade de apresentar resultados.
Quando o ajuste automatizado é bem sucedido, a seleção da opção "Resultados" exibe uma tela de diálogo com os valores dos parâmetros ajustados e seus respectivos intervalos de confiança (fig. 8.55).

Arquivo Editar Período Dados .Métodos gráfico	^íí«í?í« Interpretação
Janelas Configuração Auxílio

dadas4. aw-FLUXO-1 - De rivada

Derivada		1-DAD0S-4-AA.. 495.7-499.2 m 04/05/92		TFR-4 ,	&amp;lt;4991/EXTERNO . 490.0 ,	*		..FLUtXO-1 1-50 ■■	
	1	F44 j	1 1 F	j T j t mt	■ i	i j ’ j i j Fr		■n i "FTI	TTE
				"í			
-			,	’' w..	'	‘&amp;lt;A'	..			w
-			.	/i				
-			■ít'.k- r"1'” '	■Jp"» v	/ .		ww	™ .7
			'V-7						
* -		• ”•1		:	&gt; ■	-i	&gt; ■'			- + +
							
							+
											 F« ■ ' 'i:	■			jS +
	■	íb	sSí»iissjssssSS	/Sa a-		tiMÍH	
*;•					gUãS^		5
							
			i:-::-:-:-:-:-::;:;;-:				
							
							
							
		Ssíisi						
			,i ~i. t	—L.,.j',';,,..»....»;:’.i..Kji':&gt;...		1, "li Iii'j.d	■ »i
■ ■
_________________________ANAWIN - (ATIVO: da dos 4.aw/rLUX0 1)	 Arquivo Editar Período £)ados Métodos (¿ráfico	Interpretação
Janelas Configuração Auxílio

' AJUSTEAUTOMÁTICO
"Método
O Levemberg-Marquardt
O SVD
@ Uso da Curva de Derivada
Tolerância
Máximo de Iterações
Máx. de Buscas Lin.
* CANCEL
XO-1 - Derivada
TFR-4	í 4991/EXTERNO = 496.0			FLUXO-1 1-50	
F7T1	^7^ J	T tilín		—r—i-r	1 J I 4-
				*
				
				w
	_¿¿ ^,«n et		HW---	?	
	iriCr . 				
				
			¿•J	■ ■■■!'! ■■: -;	
	iâíOjSjSíMSíí			■ -2
	OíSWíííswíí			"í *
*5	fei; B\ .'			■K..
	V	t.			í? f
				
	■ "S^sv^			’ =
				
	:■'&lt;■.■:■ v	A"]v. .			
	. ........4... t .+ : i t,,&amp;lt;w	y» ¡ • ¡ • ¡ • ¡ • ■ • ■ • ■ .* —-—-t	^,.-L..a.		
0.0100
'l'L
	ANAWIN - (ATIVO: dadt						
¿rquivo			Editar	Período Dados			Métodos £
Janelas			£onfiguraç3o		Auxilio		
							
		•x-x----		■’c-*	Lm	■ rtt'l	&gt;*£	- -	a
				Ht	;SV.LjFÂD	os	. &amp;lt;j-; X-.,» *• ■&gt;*, 3	••-:¿	■?
							
			K =	78.700		±	2.2004		mD
			S =	6.7568		±	0.3607		
			C =	0.0320		♦ 0.0002		m’/Kg/cm’
							
							
							' .;:7 :
				wX ’ ,			4
				M- ... '	_			
				" hTf			
							
							
			1 u				
							
							' s ■"
				■	''..í			
							....
							
							
							' wS--
			.„íl				1	t 1 1	I
			1 u 7 10_£		id”1		1o1
		r' ■'					
					
ios4.aw/FLUXO-1)					
Gráfico	... Interpretação					
1 - Derivada	IèIÍBI					
					
4991/EXTERNO 438,0		FLUXO-1 1-50	.			
T7—I	1—1 1 * 111 w.r’ '''«X ííifr ^jy^HBnmnnnnpni		T	1	1 1 4	4- k				
					
					
L •	¿¿í	’..&lt;:aa"	&gt;				
					
					
					
					
*» -B •	&gt;1 + 1 l n	g°ca	£ —. 1 ,	t t m (				
					
					
					
					
0 1 2 r	10	10					
					
A opção "Cancelar" (fig. 8.50) age de forma idéntica ao descrito para o ajuste manual.
A opção "Extrapolação" (fig. 8.56) implementa o processo de utilização da metodologia de Análise Especializada descrita no capítulo 5. Selecionada a opção, a aplicação atua de forma semelhante ao processo de ampliação e de identificação de regimes, sendo que agora o técnico procurará enquadrar, no retângulo traçado durante o arraste, um intervalo de pontos de comportamento linear e dentro da região de resposta cabível ao método (fig. 8.57). Ao finalizar o enquadramento, a aplicação ativa o algoritmo de reconhecimento do intervalo de pontos enquadrados e então aplica um processo de regressão linear para determinar a reta melhor ajustada, traçando-a em seguida (fig. 8.58). No caso de a área enquadrada não possuir pontos de dados, será exibida uma janela de diálogo informando a inconsistencia e permitindo ao técnico redefinir o intervalo ou desistir da extrapolação (fig, 8.59). São permitidas até 3 retas de extrapolação presentes simultaneamente no gráfico (fig. 8.60).
A seleção da opção "Resultados" irá exibir uma janela de diálogo onde serão descritos os valores dos pontos característicos sobre as retas traçadas e pertinentes ao método utilizado (fig. 8.61).
A seleção da opção "Cancelar" permite eliminar uma ou mais retas traçadas pela seleção das respectivas cores na janela de diálogo aberta pela opção (fig. 8.62).
Finalmente, cabe salientar que o desenvolvimento deste "software", envolveu além da criação das facilidades acima descritas (rotinas de controle das diversas janelas, algoritmos citados, rotinas de traçado gráfico, consistências de processo, verificação de dados, etc.), os seguintes pontos relevantes:
- Criação de urna lógica de "flags" e contadores para identificação do processo vigente em qualquer janela e da rápida comutação entre opções.
3F*\Tt^13fflflrT? ÍÍIl^TÍÍjffi FTi!S?t tf&amp;lt;St
Arquivo Editar Período Dados Métodos £ráfíco Janelas Configuração Auxílio
es
1	A??/K&lt;?; AyfejSYselieeíí.
I Extrapolação

dados4.aw ♦ E5TAT-1 • Horncr,;
		1-DADOS-4AA	TFR-4
	Homer	495.7-499.2 m	4991/EXTERNO
430.0		04/05/92	498.0
			1	4.
420.0			
410.0		••M	
400.0		lilo	Bp ::::í:::::::::&lt;r:::::r::::::::;:;:;:;:;:;:;r;:;:ír:\í;';:::::::;:::;:::::::r:r::S;?:;
390.0	-C	”$ ’.’		
380.0			
370.0			
360.0		.	..	. V ”&gt;’&lt;	
350.0	-- 	-4—		1	-±-4 - *	*■■	LJ 4
ANAWIN - (ATIVO; dados4.aWESTÀt-Íl

Interpretação
Arquivo Editar período Qados Métodos fíráíico M

:o:
ANAWIN - (ATIVO: da dos4.aw/ESTAT1) ;
Arquivo Editar Período Dados Métodos £ráfíco Janelas Configuração Auxílio
Interpretação
Ff «
nrammBsa
jj	ANAWIN -[ATIVO: d ado s4.aw/ESTAT-1)	I* ¡1 *
Arquivo Editar Período fiados Métodos firáfico	Interpretação
Janelas Configuração Auxílio
ANAWIN - (ATIVO: dõdos4.aw/ESTAT-1)
Arquivo £ditar Período Qados Métodos gráfico Janelas Configuração Auxílio
Interpretação
-	Desenvolvimento de estruturas para armazenamento de informações pertinentes as janelas de métodos e ao processo interpretativo atuante nas mesmas.
-	Otimização do processo de cálculo das várias expressões matemáticas envolvidas nas metodologias empregadas, de modo a reduzir o tempo de processamento.
-	Depurações periódicas com a finalidade de otimizar o fluxo de processamento.
-	Balanceamento do consumo de recursos gráficos, memória, ponteiros e
"handles".
9. CONCLUSÕES
A utilização de um ambiente gráfico como o Windows permite a perfeita adaptação das metodologias de interpretação de testes de pressão em poços ao meio ambiente computacional. As características de interface gráfica com o usuário, processamento orientado por eventos e a capacidade de processamento multitarefa, tornam a utilização de computadores tanto naturalmente compatível com os procedimentos tradicionais de interpretação quanto psicologicamente agradável ao usuário.
A capacidade do ambiente Windows em manipular diversas janelas de métodos e o modelo de estrutura de dados em memória adotado no desenvolvimento da aplicação permitem a interpretação simultânea dos dados oriundos de diversos registradores com aplicação de qualquer quantidade de métodos. A limitação no número de arquivos de dados e métodos de interpretação empregados, estará apenas vinculada ao recurso de memória disponível no equipamento em utilização.
A capacidade do ambiente Windows em organizar rapidamente as várias janelas de métodos, exibí-las lado a lado, reduzi-las a ícones, mudar o estado de apresentação de uma janela e comutar rapidamente a janela ativa, implementa uma rápida e flexível interação entre métodos e conjuntos de dados disponíveis na análise de um determinado teste.
A capacidade de troca de dados entre aplicações Windows permite uma enorme flexibilidade de interação da aplicação aqui desenvolvida com outros softwares. Algumas possibilidades seriam: edição de relatórios e trabalhos técnicos com editores de texto e aquisição de dados em tempo real oriundos de equipamentos de controle ou registro.
A flexibilidade implementada de configuração das metodologias de interpretação permite uma facilidade de adaptação do "software" às condições peculiares de um determinado teste ou ao gosto pessoal do técnico interpretador.
A utilização de um ajuste preliminar em curva típica como estimativa inicial para a análise automatizada, permite diminuir os problemas de convergência e mínimos locais encontrados no emprego das técnicas de regressão não linear à interpretação de testes. Adicionalmente, viabiliza a utilização dos métodos de regressão convencionais e mais simples, otimizando o tempo do processo.
O acompanhamento gráfico das iterações na metodologia de análise automatizada confere ao técnico interpretador um sentimento adicional de segurança na utilização desta técnica.
A especificação e desenvolvimento abrangente da presente aplicação permite a expansão dos modelos poço-reservatório e dos métodos de interpretação com relativa facilidade.
NOMENCLATURA
Símbolos alfabéticos:
A - Área da seção transversal da tubulação
B	- Fator volume de formação
c	- Compressibilidade
C	- Coeficiente de estocagem
h	- Altura da formação
I( ) - Integral
k	- Permeabilidade
Ko	- Função de	Bessel modificada de segunda espécie e	ordem	0
Ki	- Função de	Bessel modificada de segunda espécie e	ordem	1
m	- Inclinação	da reta ajustada
mi	- Inclinação	da reta ajustada do método 1 de Peres
m:	- Inclinação	da reta ajustada do método 2 de Peres
p	- Pressão
q	- Vazão
r	- Raio
S	- Efeito de película
t	- Tempo
ti	- Tempo equivalente do método 1 de Peres
ü	- Tempo equivalente do método 2 de Peres
V - Volume da câmara de estocagem
z - Variável do campo de Laplace
Símbolos Gregos:
a - Constante do sistema de unidades
B - Constante do sistema de unidades
y	~	Constante de	Euler
A	-	Variação
c|&gt;	-	Porosidade
p	-	Viscosidade
0	-	Constante do	sistema	de unidades
T	-	Constante de	integração
G) - Peso específico do fluido
Subscritos e superescritos:
( )c - Solução para vazão constante na superfície
( )d - Adimensional
( )e - Equivalente
( )f - Fluxo
( )ff - Final de fluxo
( )i - Original
( )m - Média
( )m - Ponto de ajuste gráfico
( )o - Inicial
( )P - Produção
( )r - Referência
( )s - Estática
( )t - Total
( )w - Poço
( )i - índice de tempo unitário
( )’ - Derivada em relação ao tempo
( )	- Valor no campo de Laplace
REFERÊNCIAS BIBLIOGRÁFICAS
( 1) Theis, Charles V.: "The Relation Between the Lowering of the Piezometric Surface and the Rate and Duration of Discharge of a Well Using Ground-Water Storage", Trans., AGU (1935) 519-524.
( 2) van Everdingen, A. F. and Hurst, W.: The Application of the Laplace Transformation to Flow Problems in Reservois", Trans., AIME (1949) 186, 305-324.
( 3) Agarwal, Ram G., Al-Hussatny. Rafi, and Ramey, H. J., Jr.: "An Investigation of Wellbore Storage and Skin Effect in Unsteady Liquid Flow: II. Analytical Treatment", Soc. Pet. Eng. J. (Setembro 1970) 279-290; Trans., AIME, 249.
( 4) Earlougher, Robert C., Jr., and Kersch, Keith M.: "Analysis of Short-Time Transient Test Data by Type-Curve Math-ing", J. Pet. Tech. (Julho 1974) 793-800; Trans., AIME, 257.
( 5) Ramey, H. J. Jr., Agarwal, R. G. and Martin I.: "Analysis of’Slug Test' or DST Flow Period Data", J. Can. Pet. Tech., 14 (Jul-Set 1975) 37-47.
( 6) Gringarten, A. C.: "Reservoir Limit Testing for Fractured Wells", SPE 7452 apresentado no 1978 SPE Annual Technical Conference and Exhibition, Houston, 1-3 Out.
( 7) Tiab, D. and Crichlow, H. B.: "Pressure Analysis of Multiple Sealing Fault System and Bounded Reservoirs by Type-Curve Matching.", SPEJ (Dezembro 1979) 378-92.
( 8) Bourdet, D. et al.: "A New Set of Type Curves Simplifies Well Test Analysis", World Oil (Maio 1983) 95-106.
( 9) Bourdet, D. et al.: "New Type Curves Aid Analysis of Fissured Zone Well Tests", World Oid (Abril 1984) 111-24.
(10)	Onur, M. and Reynolds, A. C.: "A New Approach for Constructing Type Curves for Well Test Analysis", SPE Formation Evaluation (Março 1988) 197-206.
(11)	Peres, A. M. M., Onur, M. and Reynolds, A. C.: "A New General Pressure Analysis Procedure for Slug Tests", SPE 18801, 1989 California Regional Meeting, Bakersfield, 5-7 Abr.
(12)	Ramey, H. J. Jr.: "Practical Use of Modern Well Test Analysis", SPE 5878, 1976 California Regional Meeting, Long Beach, 8-9 Abr.
(13)	Gringarten, A. C., Bourdet, D. P., Landel, P. A. and Kniazeff, V. J.: "A Comparasion Between Different Skin and Wellbore Storage Type Curves for Early-Time Transient Analysis", SPE 8205, 1979 Annual Technical Conference and Exhibition, Las Vegas, 23-26 Set.
(14)	Agarwal, R. G.: "A New Method to Account for Producing Time Effects when Drawdown Type Curves Are Used to Analyze Pressure Buildup and Other Test Data", SPE 9289, 1980 Annual Technical Conference and Exhibition, Dallas, 21-24 Set.
(15)	Horner, D. R.: "Pressure Build-Up in Wells", Proc., Third World Pet. Cong., The Hague (1951) Sec. II, 503-523. Também Reprint Series, No. 9 - Pressure Analysis Methods, Society of Pretoleum Engineers of AIME, Dallas (1967) 25-43.
(16)	Peres, Alvaro M. M., Onur, Mustafa and Reynolds, Albert C.: "A New Analysis Procedure for Determining Aquifer Properties from Slug Test Data", Water Resources Research, vol.25, número 7, 1591-1602 (Julho 1989).
(17)	Correa, A. C. and Ramey, H. J. Jr.: "A Method for Pressure Buildup Analysis of Drillstem Tests", SPE 16802, 1987 Annual Technical Conference and Exhibition, Dallas, 27-30 Set.
(18)	Peres, Alvaro M. M., Onur, Mustafa and Reynolds, Albert C.: New Methods for The Analysis of Drillstem Test Data", SPE 19843, 1989 Annual Technical Conference and Exhibition, San Antonio, Texas, 8-11 Oct.
(19)	Janhs, H. O.: "A Rapid Method for Obtaining a Two-Dimensional Reservoir Description from Well Pressure Response Data", Soc. Pet. Eng. J. (Dezembro 1966) 315-327.
(20)	Coats, K. H., Dempsey, J. R. e Henderson, J. H.: "A New Technique for Determining Reservoir Description from Field Performance Data", Soc. Pet. Eng. J. (Março 1970), 66-74.
(21)	Earlougher, R. C. e Kersch, K. M.: "Field Examples of Automatic Transient Test Analysis", J. Pet. Tech. (Outubro 1972), 1271-1277.
(22)	Hernandez, V. M. e Swift, G. W.: "A Method for Determining Reservoir Parameters from Early Drawdown Data", SPE 3982, 1972 Annual Fall Meeting, San Antonio, Texas, 8-11 Out.
(23)	Chen, W.H., Gavalas, G. R., Seinfeld, J.H e Wasserman, M.L.: "A New Algorithm for Automatic History Matching", Soc. Pet. Eng. J. (Dezembro 1974), 593-608.
(24)	Rodgers, J. S., Coble, L. E., Boykin, R. S. e Mokha, J. S.: "Nonlinear Well Test Analysis Reveals Reservoir Boundary Shape", TECHNOLOGY, Oil and Gas Journal (Setembro 1981), 63-68.
(25)	Rosa, A. J. e Horne, R. N.r "Automated Type-Curve Matching in Well Test Analysis Using Laplace Space Determination of Parameter Gradients", SPE 12131, 1983 Annual Technical Conference and Exibition, San Francisco, Califórnia, 5-8 Out.
(26)	Guillot, A. Y. e Horne, R. N.: "Using Simultaneou Downhole Flow Rate and Pressure Measurements To Improve Analysis of Well Tests", SPE 12958, 1984 European Petroleum Conference, London, England, 25-28 Out.
(27)	Barua, J. e Horne, R. N.: "Computerized Analysis of Thermal Recovery Well Test Data", SPE Formation Evaluation, (Dezembro 1987), 560-566.
(28)	Barua, J., Horne, R. N., Greenstadt, J. L. e Lopez L.: "Improved Estimation Algorithms for Automated Type-Curve Analysis of Well Tests", SPE Formation Evaluation (Março 1988) 186-196.
(29)	Namba, T. e Horne, R. N.: "An Improved Regression Algorithm for Automated Well Test Analysis", SPE 18161, 1988 Annual Technical Conference and Exibition, Houston, Texas, 2-5 Out.
(30)	Vidal, J. O.: "Análise Automatizada de Testes de Pressão em Poços não Surgentes", Dissertação de Mestrado, Universidade Estadual de Campinas, UNICAMP, (Março 1989).
(31)	Rosa, A. J. e Horne, R. N.: "Automated Well Test Analysis Using Robust (LAV)
Nonlinear Parameter Estimation”, SPE 22679,	1991 Annual Technical
Conference and Exibition, Dallas, Texas, 6-9 Out.
(32)	Marquardt, D. W.: "An Algorithm for Least-Squares Estimation of Nonlinear Parameters", J. SIAM (Junho 1963) 1 1, n 2, 431-441.
(33)	Coelho, A. C. D.; Corrêa, A. C. F. - Métodos de Regressão Não Linear para Determinação de Parâmetros de Reservatórios em Análise de Testes de Pressão, VIII SAF, Seminário de Avaliação das Formações, Petrobras S.A. (Novembro 1991).
(34)	Mathews, C. S. e Russel, D. G.: "Pressure Buildup And Flow Tests in Wells", Monograph Series, SPE, Dallas (1967) 1.
(35)	Earlougher, R. C. Jr.: "Advances in Well Test Analysis", Monograph Series, SPE, Dallas (1977) 5.
(36)	Horne, Roland N.: "Modern Well Test Analysis, A Computer-Aided Approach", Stanford University, Petroway inc., USA (1990).
(37)	Sheldon, Tom: "Windows 3: Guia do Usuário", tradução Flávio Deny Steffen, São Paulo, Makron Books (1991)
(38)	Livingston, Brian: "Segredos do Windows 3.1", tradução Newton Dias Vasconcelos, Rio de Janeiro, Berkeley Brasil Editora (1992)
(39)	Tello, Ernest R.: "Windows: Programação orientada para objetos", tradução de Daniel Vieira, Rio de Janeiro, LTC - Livros Técnicos e Científicos Editora lida (1992).
(40)	"Microsoft Windows: A guide to Programming/Microsoft Corporation", Microsoft Press (1990)
(41)	Petzold, Charles: "Programming Windows: The Microsoft guide to Writing Applications for Windows 3”, 2nd ed., Microsoft Press (1990)
(42)	Press, Willian H., Flannery, Brian P., Teukolsky, Saula and Vetterling, William T.: "Numerical recipes in C, the art of Scientific Computing", Cambridge University Press (1988)
(43)	Abramovitz, M. and Stegun, I. A. Editores: "Handbook of Mathematical Functions", Dover Publications inc., New York (1970).
(44)	Serra, Kelsen V.: Notas de aula da disciplina Análise de Testes em Poços, Curso de Mestrado em Engenharia de Petróleo, UNICAMP (1991).
(45)	Corrêa, Antonio C. de F.: Notas de aula da disciplina Escoamento de Fluidos em Meios Porosos, Curso de Mestrado em Engenharia de Petróleo, UNICAMP (1991).
(46)	Cunha, Maria C. de C.: Notas de aula da disciplina Métodos Matemáticos em Engenharia B, Curso de Mestrado em Engenharia de Petróleo, UNICAMP (1991).
APENDICE A
A.l - Premissas Básicas:
Nos modelos implementados são assumidas as seguintes hipóteses:
-	Reservatório homogêneo, isotrópico, infinito e de espessura constante.
-	Fluido monofásico com viscosidade constante e compressibilidade pequena
constante.
-	Validade da lei de Darcy.
-	Vazão constante num poço de raio finito.
-	Estocagem constante em cada período de teste.
-	Formação totalmente aberta ao fluxo.
-	Efeitos gravitacionais, inercíais e de quantidade de movimento desprezíveis.
-	Gradientes de pressão pequenos no reservatório.
-	Efeito película infinitesimal
A.2 - Modelo para Fluxo Surgente com Vazão Constante na Superfície:
-	Definindo:
kh[pi -p(r,t)]
to —
pkt
4» p Ct Tw2
Cd =
ec
2 n h 0 ct Tw2
onde: C = Cw Vw
qcD —
q(t)B
qr B
- Do balanço de massa no poço;
dpwCD
Ocd — I - Cd ~
U tD
- Tem-se então a E. D. P. e suas condições auxiliares:
1	3 í d pCD 9 pCD
rc 3 td l rD 3 td 1	3 íd
C. I.: pD (td , 0) - 0
C. C. I.
(
TD
X
3 PCD
3 Td
1 - Cd
3 pwCD
3 tü
C. C. E. : lim pD (ro , íd) = 0
Td—»™
pwcn —
Pcd -
3 PCD d Td
ro=i
- A solução no campo de Laplace é dada por:
1_ ______________Ko ) + S ~\/z Ki )________________________
z \zKi (y/z) + Cdz [Ko (yfz) + S aJz Ki (■^z)]
A.3 - Modelo para Fluxo Não Surgente ("Slug Test”):
- Definindo:
n P¡ -P^)
pD —
F	P¡ - pO
pWD =
pi -Pwf pi - pO
—&gt;	pwo(0) — 1
p k t
p ci rw2
ec
2	7t h 0 Ct Tw2
onde:
aq(t)Bp
qD k h (p¡ - po)
- Do balanço de massa no poço:
d PWD qD=’CD’ãr
- Tem-se então a E. D. P. e suas condições auxiliares:
J__L f dp»
Td Ô Td 3 Td
d pp d tD
C. I.: pD (td , 0) = 0
C. C. I.
Jtd=i
Cd
d pwD d to
C. C. E.: lim pD (iu , to) = 0 Td—&gt;”
r j spd^i
LE	JJrD=i
pwD (0) = 1
- A solução no Campo de Laplace é dada por:
A.5 - Relação entre os Modelos Surgente e Não Surgente :
- Comparando-se as soluções dos modelos surgente e não surgente, tem-se:
pwcD Z Cd — pwD
- Aplicando-se a transformada inversa de Laplace para trazer ao campo Real:
£-1 [ pwD ]	=	I’1 [P WCD zCdj
pwD = Cd £” [ 2 PWCD - PWCD(°) j
- Integrando de 0 a to :
to
f Pwd(T) d T = Cd
0
J
dt
d T
— Cd [pwcD (Id) - 0 ]
- Obtem-se então a relação:
pwcD (tn)
1
Cd
to
f P«d(T) dT
0</field>
	</doc>
</add>