<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20250</field>
		<field name="filename">3722_341417.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA
DEPARTAMENTO DE AUTOMAÇÃO E SISTEMAS

Dayron Antonio Álvarez Rodríguez

CONTROLE PREDITIVO PARA CADEIAS DE SUPRIMENTO NA
INDÚSTRIA DE PETRÓLEO, GÁS E BIOCOMBUSTÍVEIS

Florianópolis

2016





Dayron Antonio Álvarez Rodríguez

CONTROLE PREDITIVO PARA CADEIAS DE SUPRIMENTO NA
INDÚSTRIA DE PETRÓLEO, GÁS E BIOCOMBUSTÍVEIS

Dissertaçao submetido ao Programa de Pós-
Graduação em Automação e Sistemas para
a obtenção do Grau de Mestre.
Orientador: Prof. Dr. Julio Elias Normey
Rico
Coorientador: Prof. Dr. Rodolfo César
Costa Flesch

Florianópolis

2016



Ficha de identificação da obra elaborada pelo autor,
 através do Programa de Geração Automática da Biblioteca Universitária da UFSC.

Álvarez, Dayron Antonio
   Controle Preditivo para cadeias de suprimento na
indústria de petróleo, gás e biocombustíveis / Dayron
Antonio Álvarez ; orientador, Julio Elias  Normey-Rico ;
coorientador, Rodolfo César  Flesch. - Florianópolis, SC,
2016.
   113 p.

   Dissertação (mestrado) - Universidade Federal de Santa
Catarina, Centro Tecnológico. Programa de Pós-Graduação em
Engenharia de Automação e Sistemas.

   Inclui referências 

   1. Engenharia de Automação e Sistemas. 2. Controle
Preditivo Baseado em Modelos. 3. Cadeias de Suprimento. 4.
Atraso de tempo. I. Normey-Rico, Julio Elias . II. Flesch,
Rodolfo César . III. Universidade Federal de Santa
Catarina. Programa de Pós-Graduação em Engenharia de
Automação e Sistemas. IV. Título.







Dedicado a mis padres, nunca pudieron enten-
der mis estudios pero siempre me enseñaron lo
suficiente para enfrentar la vida.





AGRADECIMENTOS

A minha família.

Ao meu orientador Julio Elias Normey Rico e meu coorientador Rodolfo
Flesch pela paciência, apoio, tempo e boa disposição que tiveram sempre
na execução do trabalho.

Aos meus Amigos-Colegas-Conhecidos, que estiveram presentes em todos
os momentos no LTIC.





RESUMO

Neste trabalho são abordados estudos de controle preditivo para o controle
de estoques em cadeias de suprimentos. Uma cadeia de suprimento é um
processo de fabricação integrado, em que as matérias-primas são convertidas
em produtos finais entregues aos clientes. Processos de cadeias de supri-
mento podem ser matematicamente modelados, apresentando características
de atraso de tempo, muitas vezes elevado, e dinâmicas integradoras. O pro-
blema de fato com o atraso são as limitações físicas, que não permitem que
produtos sejam produzidos ou entregues até o decorrer dos tempos de atraso
após a recepção dos pedidos. São tempos de espera presentes na dinâmica
do modelo. O controle preditivo oferece flexibilidade em termos de troca de
informação, topologias de rede e manipulação de restrições. Além disso, o
controle preditivo trabalha sob otimização de objetivos. Objetivos que po-
dem ser projetados para considerar informações econômicas, como também
levar em conta objetivos mais comuns da teoria de controle, como rastrea-
mento de referências, e especificações dinâmicas de suas variáveis. Dessa
maneira, o problema pode ser escalado para manter níveis de estoque den-
tro de certos valores pré-determinados e, ao mesmo tempo, proporcionar um
funcionamento economicamente ideal no processo de fabricação; em outras
palavras, evitar mudanças rápidas no ritmo de produção e, ao mesmo tempo,
evitar quantidades indesejáveis de produtos em estoque. Assim, foram de-
senvolvidas duas estratégias de controle, sendo a primeira baseada no con-
trolador preditivo generalizado conhecido como GPC. A segunda estratégia
de controle utilizada neste trabalho consistiu no aproveitamento da estrutura
de compensação de atraso no preditor do GPC, implementando o algoritmo
conhecido como DTC-GPC. Foram realizados ensaios de simulação usando
coordenações centralizada e descentralizada dos controladores, funcionando
em condições ideais e sob a presença de perturbações e incertezas. Os resulta-
dos obtidos mostram que os controladores DTC-GPC podem ter um impacto
significativo e positivo sobre o controle dos níveis de estoque e, ao mesmo
tempo, satisfazer as demandas do mercado.

Palavras-chave: Controle Preditivo Baseado em Modelo. Cadeias de Supri-
mento. Atraso de tempo.





ABSTRACT

This work addressed predictive control studies for inventory control in supply
chains. A supply chain is an integrated manufacturing process, in which raw
materials are converted into finished products delivered to customers. Sup-
ply chain processes can be mathematically modeled,using integrative models
with delay time. The real problem with the delay are the physical limita-
tions that do not allow products to be produced or delivered instanteneouly
by the course of the delay times of receipt of applications. Moreover, waiting
times are present in the dynamic model. The model predictive control pro-
vides flexibility in terms of information exchange, network topologies and
handling constraints. Moreover, the predictive control works under optimiza-
tion goals. Goals that can be designed to consider economic aspects, but also
take into account the most common goals of control theory, such as tracking
references, and dynamic specifications of its variables. Thus, the problem can
be scaled to keep inventory levels within certain predetermined values while
at the same time provide an economically optimal operation in the manufac-
turing process; in other words, to avoid rapid changes in the production rate
and, at the same time avoid undesirable amounts of products in stock. Thus,
we developed two control strategies, the first based on generalized predic-
tive controller known as GPC. The second control strategy used in this work
uses a different delay compensation structure in the GPC predictor, imple-
menting the algorithm known as DTC-GPC. Simulation tests were performed
using centralized and decentralized coordination of the controllers, operating
in ideal conditions and in the presence of disturbances and uncertainties. The
results show that DTC-GPC controllers can have a significant and positive
impact on the control of inventory levels and at the same time, satisfy the
demands of the market.

Keywords: Model Predictive Control. Supply Chains. Dead-time.





SUMÁRIO

Lista de Figuras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lista de Tabelas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lista de Abreviaturas e Siglas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1 INTRODUÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
1.1 GESTÃO DE CADEIAS DE SUPRIMENTO . . . . . . . . . . . . . . . 21
1.2 MOTIVAÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
1.2.1 Setor Petrolífero no Brasil . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
1.2.2 Etanol a partir de Biomassa . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
1.2.3 Gestão de cadeias de suprimento mediante MPC . . . . . . . . . . 27
1.3 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
1.4 ESTRUTURA DA DISSERTAÇÃO . . . . . . . . . . . . . . . . . . . . . . . 28
2 TEORIA DE CONTROLE EM CADEIAS DE SUPRIMENTO 31
2.1 PROBLEMÁTICA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
2.2 MODELOS DE CADEIA DE SUPRIMENTO . . . . . . . . . . . . . . 33
2.2.1 Modelagem Matemática . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
2.2.2 Especificações típicas para Controle . . . . . . . . . . . . . . . . . . . . . 37
2.3 CONTROLE DE CADEIAS DE SUPRIMENTO NA LITE-

RATURA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
2.4 COMENTÁRIOS FINAIS DO CAPÍTULO . . . . . . . . . . . . . . . . . 40
3 CONTROLE PREDITIVO (MPC) . . . . . . . . . . . . . . . . . . . . . . 41
3.1 CONCEITOS BÁSICOS DE CONTROLE PREDITIVO BASEADO

EM MODELO (MPC) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.2 ESTRUTURA BÁSICA DOS CONTROLADORES PREDI-

TIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.2.1 Modelo de predição . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
3.2.2 Função custo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
3.2.3 Cálculo da lei de controle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
3.2.4 Metodologia dos controladores preditivos . . . . . . . . . . . . . . . . 44
3.3 CONTROLE PREDITIVO GENERALIZADO (GPC), SISTEMAS

MONOVARIÁVEIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
3.4 USO DE RESTRIÇÕES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
3.5 GPC PARA SISTEMAS COM ATRASO DE TEMPO (DTC-

GPC) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
3.5.1 Compensação antecipativa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
3.6 EXTENSÃO PARA O CASO MULTIVÁRIAVEL . . . . . . . . . . . 59
3.7 COMENTÁRIOS FINAIS DO CAPÍTULO . . . . . . . . . . . . . . . . . 62
4 ESTRATÉGIAS DE CONTROLE . . . . . . . . . . . . . . . . . . . . . . . 63



4.1 SISTEMA CLÁSSICO DE ESTOQUE . . . . . . . . . . . . . . . . . . . . 63
4.1.1 Resultados do GPC no caso nominal . . . . . . . . . . . . . . . . . . . . . 64
4.1.2 Resultados do GPC sob incertezas . . . . . . . . . . . . . . . . . . . . . . . 66
4.1.3 Resultados do DTC-GPC sob incertezas . . . . . . . . . . . . . . . . . . 67
4.2 EXEMPLO DE CADEIA DE SUPRIMENTOS . . . . . . . . . . . . . 68
4.2.1 Estruturas de coordenação das cadeias de suprimento . . . . . 68
4.2.2 Formulação do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
4.2.3 Coordenação centralizada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
4.2.3.1 Resultados do controlador GPC no caso nominal . . . . . . . . . . . . 70
4.2.3.2 Resultados do controlador GPC sob incertezas . . . . . . . . . . . . . . 72
4.2.3.3 Resultados do controlador DTC-GPC sob incertezas . . . . . . . . . 73
4.2.4 Coordenação descentralizada . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
4.2.4.1 Resultados do controlador GPC no caso nominal . . . . . . . . . . . . 75
4.2.4.2 Resultados do controlador GPC sob incertezas . . . . . . . . . . . . . . 77
4.2.4.3 Resultados do controlador DTC-GPC sob incertezas . . . . . . . . . 77
4.3 COMENTÁRIOS FINAIS DO CAPÍTULO . . . . . . . . . . . . . . . . . 79
5 ESTUDOS DE CASO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
5.1 ESTUDO EM PETRÓLEO E GÁS . . . . . . . . . . . . . . . . . . . . . . . . 81
5.1.1 Sistema de Refino . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
5.1.2 Formulação do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
5.1.3 Resultados de simulação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
5.2 ESTUDO EM BIOCOMBUSTÍVEIS . . . . . . . . . . . . . . . . . . . . . . 93
5.2.1 Esquema de sustentabilidade . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
5.2.2 Formulação do problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
5.2.3 Resultados de simulação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
5.3 COMENTÁRIOS FINAIS DO CAPÍTULO . . . . . . . . . . . . . . . . . 100
6 CONCLUSÕES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
6.1 SUGESTÕES PARA TRABALHOS FUTUROS . . . . . . . . . . . . 104

REFERÊNCIAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107



LISTA DE FIGURAS

Figura 1.1 Diagrama simples da Cadeia de Suprimentos . . . . . . . . . . . . . . 22
Figura 1.2 Cadeia de Suprimentos de Petróelo e Gás Natural . . . . . . . . . . 23
Figura 2.1 Tempos de produção e transporte na CS . . . . . . . . . . . . . . . . . . . 32
Figura 2.2 CS simplificada de três estágios . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Figura 2.3 Diagrama de blocos do modelo simplificado da rede de CS . 36
Figura 3.1 Estrutura básica do MPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Figura 3.2 Metodologia do MPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
Figura 3.3 Resposta livre . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
Figura 3.4 Resposta Forçada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
Figura 3.5 Estrutura de controle do GPC . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
Figura 3.6 Estrutura do DTC-GPC com ação antecipativa . . . . . . . . . . . . . 59
Figura 4.1 Analogia de fluidos para um sistema clássico de estoque . . . . 64
Figura 4.2 Resultados do controlador GPC desconsiderando erros na

modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Figura 4.3 Resultados do controlador GPC considerando erros na mode-

lagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figura 4.4 Resultados do controlador DTC-GPC considerando erros na

modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
Figura 4.5 Analogia de fluidos na estratégia de controle centralizado. . . 70
Figura 4.6 Resultados de simulação GPC centralizado desconsiderando

erros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . 71
Figura 4.7 Resultados de simulação GPC centralizado considerando er-

ros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . . . 73
Figura 4.8 Resultados de simulação DTC-GPC centralizado considerando

erros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . 74
Figura 4.9 Analogia de fluidos na estratégia de controle descentralizado. 75
Figura 4.10 Resultados de simulação GPC descentralizado desconsiderando

erros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . 76
Figura 4.11 Resultados de simulação GPC descentralizado considerando

erros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . 77
Figura 4.12 Resultados de simulação DTC-GPC descentralizado considerando

erros na modelagem e na previsão de demanda . . . . . . . . . . . . . . . . . . . . . . 78
Figura 5.1 Esquema de controle descentralizado e mapeamento de vari-



áveis do sistema de CS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
Figura 5.2 Estoque de cru . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Figura 5.3 Estoque de diesel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Figura 5.4 Estoque de gasolina . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
Figura 5.5 Estoque de nafta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
Figura 5.6 Estoque de gás liquefeito de petróleo . . . . . . . . . . . . . . . . . . . . . 92
Figura 5.7 Estoque de querosene de aviação . . . . . . . . . . . . . . . . . . . . . . . . . 92
Figura 5.8 Fluxo de processos de açúcar, etanol e bio-electricidade . . . . 94
Figura 5.9 Esquema de controle centralizado e mapeamento de variáveis
do sistema de CS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95

Figura 5.10 Estoque cana de açúcar . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
Figura 5.11 Cana de açúcar demandada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
Figura 5.12 Nível de estoque de cana de açúcar . . . . . . . . . . . . . . . . . . . . . . . 100
Figura 5.13 Bagaço demandado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100



LISTA DE TABELAS

Tabela 4.1 Parâmetros de ajuste do controlador GPC . . . . . . . . . . . . . . . . . 65
Tabela 4.2 Restrições de operação SISO . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Tabela 4.3 Parâmetros de ajuste do controlador DTC-GPC . . . . . . . . . . . . 67
Tabela 4.4 Restrições de operação MIMO . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Tabela 4.5 Parâmetros de ajuste do controlador GPC centralizado . . . . . 72
Tabela 4.6 Incertezas inseridas na modelagem . . . . . . . . . . . . . . . . . . . . . . . 72
Tabela 4.7 Parâmetros de ajuste do controlador DTC-GPC centralizado 74
Tabela 4.8 Parâmetros de ajuste do controlador GPC descentralizado . . 76
Tabela 4.9 Parâmetros de ajuste do controlador DTC-GPC descentrali-

zado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
Tabela 5.1 Mapeamento de variáveis no controlador MISO . . . . . . . . . . . 84
Tabela 5.2 Mapeamento de variáveis no controlador MIMO . . . . . . . . . . . 84
Tabela 5.3 Dados de simulação do algoritmo LP . . . . . . . . . . . . . . . . . . . . . 87
Tabela 5.4 Dados de simulação e estados iniciais na CS . . . . . . . . . . . . . . 87
Tabela 5.5 Incertezas inseridas na modelagem controlador DTC-GPC

MIMO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
Tabela 5.6 Parâmetros de ajuste do controlador MISO . . . . . . . . . . . . . . . . 88
Tabela 5.7 Parâmetros de ajuste do controlador MIMO . . . . . . . . . . . . . . . 89
Tabela 5.8 Parâmetros de restrição controlador MISO . . . . . . . . . . . . . . . . 89
Tabela 5.9 Parâmetros de restrição controlador MIMO . . . . . . . . . . . . . . . 89
Tabela 5.10 Mapeamento de variáveis no controlador . . . . . . . . . . . . . . . . . . 96
Tabela 5.11 Parâmetros de ajuste do controlador . . . . . . . . . . . . . . . . . . . . . . 97
Tabela 5.12 Dados de simulação e estados iniciais na CS . . . . . . . . . . . . . . 98
Tabela 5.13 Parâmetros de restrição . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98





LISTA DE ABREVIATURAS E SIGLAS

CS Cadeia de Suprimento do inglês supply chain (SC)

DTC-GPC Generalized predictive control-Dead-time compensator

FSP Filtered smith preditor

GPC Generalized predictive control

LP Linear programming

MPC Model predictive Control

MIMO Multiple Input-Multiple Output

MISO Multiple Input-Single Output

SISO Single Input-Single Output

SP Smith preditor

QP Quadratic programming

2DOF Two Degrees of Freedom

——————————————————–





21

1 INTRODUÇÃO

Companhias de petróleo, gás natural e biocombustíveis trabalham sob
um sistema de integração tecnológica e administrativa que envolve todas as
atividades logísticas relacionadas a um bom planejamento da sua cadeia de
suprimentos. Essas indústrias ocupam um espaço de significativa importân-
cia na economia global, sobretudo na economia brasileira. Trata-se de um
setor de grande empregabilidade, responsável pelo surgimento de diversas
tecnologias que atendem as mais variadas áreas de pesquisa. Para cumprir
as expectativas de um mercado que está em ampla disputa, estratégias para
armazenar e transportar produtos assumem um papel importante no cenário
mundial e não podem ser ignoradas pelas empresas, qualquer que seja seu
porte. O Brasil, como um importante fornecedor dos produtos, visa expandir
essa liderança aproveitando sua evolução e grande processo de transformação,
fazendo necessários investimentos crescentes em pesquisas brasileiras, tendo
em vista a alta competitividade gerada pelo interesse de concorrentes es-
trangeiros no setor (CNI; DIRET; IBP, 2012).

Neste capítulo, são apresentados vários dos cenários que enfrentam a
indústria do petróleo, gás e biocombustíveis brasileiros, além de conceitos e
conhecimentos gerais à respeito das cadeias de suprimentos, possibilitando
sustentar a proposta geral deste trabalho.

1.1 GESTÃO DE CADEIAS DE SUPRIMENTO

Os primeiros sistemas de armazenagem sugiram com a necessidade da
humanidade garantir a sobrevivência em épocas de escassez. Em um primeiro
momento, o objetivo era simplesmente estocar e consumir. Depois, além da
questão da armazenagem propriamente dita, outros aspectos como perdas no
sistema (devido à deterioração ou roubo) e garantia de abastecimento foram
adicionados ao problema. Deste modo, os primeiros passos para o gerenci-
amento de estoques estavam sendo dados. Com o crescimento populacional
das cidades e o desenvolvimento da manufatura após o advento da revolução
industrial, sistemas de estoques cada vez maiores se tornaram necessários
para garantir o abastecimento e sua gestão tomou um impulso de grandes
proporções (PACHECO, 2004).

Quando uma companhia entrega um produto a um cliente, finaliza um
processo que começou quando se teve conhecimento que o cliente queria
adquiri-lo, ou no mínimo teve a expectativa de adquiri-lo. Este processo trans-



22

forma a informação que dá o cliente (demanda) em produtos para ele mesmo
(produtos entregues). Uma cadeia de suprimentos (CS) é caracterizada por
ter fluxos de materiais e fluxos de informação, como ilustrado na figura 1.1,
a direção do fluxo de materiais de um fornecedor até seu cliente é conside-
rado o fluxo que vai para frente da CS (forward ou downstream) por outro
lado os fluxos de informação dos pedidos entre clientes e fornecedores, via-
jam para trás na CS (backward ou upstream). CS podem apresentar diferentes
estruturas e sua complexidade pode variar conforme o tipo de produto final,
tempo de produção, tempos de transporte e dependem também das variáveis
envolvidas no processo de transformação das matérias primas. Da mesma
forma, outro fator característico é o nível de incertezas sob o qual opera a
CS. Para alguns mercados é mais fácil conhecer ou estimar a demanda e seu
comportamento no tempo, assim como manter preços e custos mais estáveis
(BENET; SUBIAS; GRIÑÓ, 2006).

Figura 1.1 – Diagrama simples da Cadeia de Suprimentos

Fonte: (PIN-HO; SHAN-HILL; JANG, 2004)

No caso de redes de CS que operam em países produtores de petróleo,
segundo Eichmann (2000) , a gestão das mesmas tem sido um dos mais difí-
ceis desafios encontrados por pesquisadores da área no mundo. Cadeias de
suprimento em petróleo e gás, envolvem uma série de subsistemas (ver figura
1.2), que interagem entre si nos processos de exploração, de transferência de
petróleo para os terminais, de armazenagem em tanques e de transferência às
refinarias para finalmente iniciar o processo de refino e produção dos deriva-
dos do petróleo (NEIRO; PINTO, 2004), enfrentando-se com condições de mer-
cado incertas, mudanças econômicas que afetam diretamente as capacidades
de processamento, de exportação, satisfação de demandas no mercado local e
equilíbrio dos preços (AL-OTHAM et al., 2007). O principal obstáculo na otimi-
zação das unidades de produção está na busca da econômia global do sistema.
Normalmente, os objetivos das unidades individuais são conflitantes e muitas
vezes inviáveis globalmente. O alvo principal no gerenciamento das cadeias
de suprimento de petróleo e gás consiste em buscar uma integração entre os
objetivos econômicos de produção e as condições de operação dos processos
(NEIRO; PINTO, 2004). Contudo, procura-se uma abordagem mais eficiente



23

para integrar as limitações atuais e futuras na síntese do planejamento de
produção, levando os objetivos de produção de curto prazo em condições
de funcionamento para as unidades de processamento, fornecendo uma fer-
ramenta de análise para o efeito de distúrbios econômicos no desempenho
do sistema de produção dentro de horizontes e fornecendo mecanismos para
levar em conta, tanto incertezas comerciais, como tecnológicas (limitações
físicas) (AL-OTHAM et al., 2007).

Figura 1.2 – Cadeia de Suprimentos de Petróelo e Gás Natural

Fonte: (NEIRO; PINTO, 2004)

1.2 MOTIVAÇÃO

O petróleo não é um recurso natural renovável, é um recurso cada vez
mais escasso e, assim, tende a ser cada vez mais valorizado. A exploração e
produção do petróleo tem sido um dos focos de maior relevância na área de
energia, visto que o Brasil almeja cada vez mais aumentar sua capacidade pro-
dutiva visando sustentabilidade. No quadro econômico, não são apenas pro-
dutos petrolíferos que competem contra outros produtos petrolíferos, senão
também cadeias de suprimento que concorrem com outras cadeias de supri-
mento. Isso porque, ao eliminarem-se ineficiências dessas cadeias, podem-se
economizar recursos, o que torna o produto final mais competitivo e rentável
(SIMCHI-LEVI; KAMINSKY; SIMCHI-LEVI, 2004). Uma CS eficiente traz grandes



24

benefícios para a sociedade, uma vez que evita desperdícios e reduz impactos
ambientais causados pela produção excessiva (SCHWARTZ; RIVERA, 2010).

Para as indústrias em geral, torna-se cada vez mais difícil concorrer
em escala global sem fortes estratégias de gerenciamento de estoque. Mu-
danças nos padrões de consumo levaram empresas a mostrar um interesse
crescente na gestão eficiente de seus sistemas logísticos. Novas normas para
gestão dos resíduos geram um foco renovado de qualidade, acrescentando
obstáculos para alcançar certificações internacionais e adoção de paradigmas
de alta qualidade (SUBRAMANIAM et al., 2012). Nesse contexto, políticas de
desenvolvimento que vêm sendo adotadas no setor petrolífero brasileiro, ini-
ciadas há décadas, buscam, através da abertura do mercado, o aumento dos
investimentos estrangeiros.

De acordo com a OPEC, o Brasil pode se tornar a nação com o maior
aumento de reservas de Petróleo até 2020, passando da 14a para a 8a colo-
cação no ranking mundial de reservas de petróleo (OPEC, 2013). Contudo,
a maximização da produção de petróleo e derivados fortalece ainda mais a
necessidade de se ter um gerenciamento dessa cadeia logística, de forma in-
tegrada e otimizada. Um melhor conhecimento dos pontos de ineficiência
dessa cadeia produtiva permitirá a execução de um melhor planejamento in-
tegrado, com a programação e o controle das atividades. Portanto, as de-
cisões de produção precisam ser rápidas e robustas frente às incertezas do
mercado, porém otimizadas para atingir objetivos chave na CS. Para tal, um
dos meios de se atingir o objetivo de aumento de produção consiste na uti-
lização adequada dos recursos e otimização logística, de forma a aumentar
a produtividade. Desse modo, sabe-se que a CS do petróleo que opera no
país apresenta uma série de oportunidades de melhoria que certamente trarão
benefícios muito relevantes. É nesse contexto que se inserem neste projeto,
estudos de otimização e aplicação de teorias de controle preditivo, como fer-
ramentas na gestão de cadeias de suprimento.

1.2.1 Setor Petrolífero no Brasil

A lei do petróleo (9.478 / 97) decretou a exploração de hidrocarbone-
tos feita sob o modelo de concessão, criou o conselho nacional de política
energética (CNPE) e a agência nacional do petróleo (ANP), cujas principais
funções são regulação, contratação e fiscalização das atividades inerentes à
indústria do petróleo, bem como das atividades de distribuição e venda dos
derivados de petróleo e álcool. O fim do monopólio estabelecido pela lei,
trouxe uma série de avanços no sentido de estimular a concorrência e bus-
car sempre uma melhor produtividade dos campos maduros, seja ou, na uti-



25

lização e aproveitamento da infra-estrutura existente. Desse modo, apesar
das dificuldades momentâneas presenciadas no fim do ano passado e no iní-
cio deste ano, o país vem criando condições para uma expansão do setor,
obrigando empresas envolvidas nestas atividades procurar condições ideais e
muitas vezes ótimas de todos os processos da cadeia produtiva (TERUMICHI,
2007).

A indústria brasileira de petróleo e gás está passando por um período
de grande transformação. O setor emprega em méia 500 mil profissionais,
número orientado ao crescimento para 2 milhões em 2020 (PWC, 2014). Es-
timulada pelos altos preços que tinham os petróleos no mercado internacional,
investimentos da PETROBRAS na prospecção de reservas não-convencionais
em águas profundas gerou uma nova era para a atividade petrolífera brasileira,
em termos de reservas e produção. Com uma infraestrutura robusta de ativi-
dades de exploração e produção, o país é lider na produção mundial de hidro-
carbonetos em águas profundas e ultraprofundas. Expandiu consideravel-
mente as oportunidades de crescimento na descoberta de extensas reservas
de óleo e gás presentes no pré-sal do litoral a partir de 2006 (PETROBRAS,
2014). É importante destacar que o Brasil tem o recorde mundial de ex-
ploração de águas profundas em petróleo, cujo know-how adquirido permite
à PETROBRAS continuar investindo nesse segmento de exploração (TERU-
MICHI, 2007). A exploração do pré-sal cria grandes oportunidades, mas,
acrescenta desafios importantes para fornecedores da indústria brasileira de
petróleo e gás (PETROBRAS, 2014); desafios de crescer com processos efi-
cientes, melhores práticas de gestão, controles apropriados e equilibrados,
custódios controlados. Além de melhores práticas de gestão, é necessário de-
senvolvimento tecnológico com o objetivo de melhorar a competitividade da
cadeia de suprimentos brasileira e apoiar exigências de conteúdo local.

O petróleo produzido no país é pesado e exige um poder de refino
maior. Refinarias brasileiras não têm capacidade de refinar todo o petróleo
consumido internamente. Porém, o Brasil exporta petróleo cru e importa
derivados, principalmente gasolina. No que se refere ao gás, o consumo
brasileiro supera a produção. Para solucionar esse déficit, o país importa gás
da Bolívia. Contudo, o Brasil implantou uma política local para fomentar o
desenvolvimento da cadeia de suprimentos nacional, com o objetivo de torná-
la forte e sustentável. Assim, a renovação da CS contribuirá para o aumento
do peso da indústria de petróleo e gás no PIB brasileiro dos atuais 12%, para
20% em 2020,segundo previsões da PWC (2014).

Em prol do apoio ao desenvolvimento da indústria local, o governo
brasileiro, por meio do BNDES (Banco Nacional de Desenvolvimento Eco-
nômico e Social), e a PETROBRAS oferecem várias fontes de financiamento
como são: Plano Brasil Maior, Progredir e o Plano de Negócios da PETRO-



26

BRAS. Assim, segundo o relatório da PWC (PWC, 2014), o programa brasileiro
de exploração de petróleo representa um dos projetos mais caros do mundo
em andamento, ao lado do trem de alta velocidade chinês e da construção
de uma infraestrutura física e esportiva para uma copa do mundo de futebol
(FIFA) no Catar (PWC, 2014).

1.2.2 Etanol a partir de Biomassa

A utilização da biomassa é uma ferramenta útil para adotar esque-
mas sustentáveis de plantas industriais e contribuir ainda mais para o uso de
energia limpa. A produção de álcool e hidrocarbonetos a partir de biomassa
tornou-se uma importante área de estudos de CS devido ao crescimento ex-
plosivo gerado pelos regulamentos ambientais e necessidades de energia re-
nováveis (AN; WILHELM; SEARCY, 2011). O processamento de cana no Brasil
é feito através de uma cadeia de produção muito integrada. Açúcar e etanol
são produzidos em um processo combinado com um sistema de co-geração
para suprir a demanda de energia necessária, trabalhando em um processo de
produção autônomo (PERAN et al., 2011).

A indústria sucroalcooleira figura entre as mais tradicionais e anti-
gas no Brasil. Entretanto foi em 1975 que a indústria ganhou um novo im-
pulso, após a primeira crise do petróleo, quando foi instituído o Proálcool.
Esse programa governamental tinha como meta principal, a produção de ál-
cool hidratado para ser utilizado como combustível substituto da gasolina.
Destarte, após décadas, o fato de ter uma matriz energética diversificada
diminuiu o risco do país depender de alimentação externa para cumprir com
a demanda do mercado (AMERICANO, 2013). Aliás tem gerado um commo-
dity nacional e internacional com o etanol, reconhecido como uma alternativa
concreta para a substituição de combustíveis fósseis destacando o Brasil como
um país importante e em desenvolvimento que apoia políticas internacionais
de meio ambiente como o protocolo de Kyoto, assinado em 1998. Dessa
maneira, as indústrias brasileiras do açúcar e álcool vêm desempenhando um
papel notável no que se refere à preservação do meio ambiente (AMERICANO,
2013).

No Brasil, a partir de 2009 a subsidiária da Petrobras (Petrobras Bio-
combustível) começou trabalhar fortemente no setor, apresentando novas tec-
nologias para produção de etanol de segunda geração. Assim, a adoção
do etanol como combustível nacional, defendido por políticas governamen-
tais, tem se mostrado como alternativa concreta na produção de energia sem
poluir, ajudando na economia do país, garantindo, além do abastecimento,
melhor qualidade de vida, não somente como forma de reduzir a emissão



27

de gases poluentes, mas também de transformação social (GAGLIARDO; COR-
SANO, 2011).

1.2.3 Gestão de cadeias de suprimento mediante MPC

O uso de técnicas de controle para o problema de eficiência das CS
tem crescido fortemente desde a segunda metade do século XX. Trabalhos
nessa área incluem a modelagem de processos de CS usando analogia de
fluidos através de comparações com sistemas de controle de nível em tanques
acoplados (SCHWARTZ; RIVERA, 2010), bem como o controle desse sistema
através de técnicas em malha fechada (NANDOLA; RIVERA, 2013).

De acordo com Al-Otham et, al. (2007), o gestão dos sistemas de CS
visa minimizar custos de produção, minimizar excessos de armazenamento
e minimizar as despesas de transporte, assim como satisfazer as demandas
dos clientes, mantendo uma participação ativa no mercado. É por isso, que
as técnicas de controle preditivo encaixam perfeitamente como uma possível
solução nos problemas de gestão de cadeias de suprimento. O MPC ofe-
rece flexibilidade em termos de troca de informação, topologias de rede e
manipulação de restrições. Além disso, o MPC trabalha sob otimização de
objetivos. Objetivos que podem ser projetados para considerar informações
econômicas, como também levar em conta objetivos mais comuns da teoria
de controle, como rastreamento de referências, e especificações dinâmicas
de suas variáveis (CAMACHO; BORDONS, 2004). Dessa maneira, o problema
pode ser escalado para manter o nível de estoque dentro de certos valores
pré-determinados e, ao mesmo tempo, proporcionar um funcionamento eco-
nomicamente ideal no processo de fabricação; em outras palavras, evitar mu-
danças rápidas no ritmo de produção e, ao mesmo tempo, evitar quantidades
indesejáveis de produtos em estoque.

Grande parte das pesquisas focadas no controle de CS buscam me-
lhorar o bullwhip - (efeito chicote), fenômeno que decorre, na maioria dos
casos, dos atrasos presentes na dinâmica de cadeias de suprimento (PIN-HO;
SHAN-HILL; JANG, 2004). Esse fenômeno normalmente observado em CS não
administradas, refere-se à ocorrência de picos de estoque de amplitude relati-
vamente grande quanto comparados à real variação da demanda.

Processos com essa característica de atraso, muitas vezes elevado, são
difíceis de controlar usando controladores preditivos padrão (NORMEY-RICO;
CAMACHO, 2007), uma vez que a robustez desses sistemas de controle tende a
ser baixa frente a incertezas na estimação do modelo e na estimação de pertur-
bações (demanda, para este caso). Ainda, devido à quantidade de processos
envolvidos, o processo como um todo tem um grande número de variáveis



28

e dinâmicas complexas, o que gera dificuldades para o desenvolvimento de
algoritmos de controle eficientes. Nessa situação de complexidade no mo-
delo e elevado atraso de tempo, propõe-se neste trabalho o uso de técnicas
de controle preditivo baseado em modelo, visando aproveitar sua estrutura de
compensação de atrasos de tempo explícita, buscando aliar as vantagens do
controle preditivo com a robustez necessária para aplicação prática. Como
será mostrado, esses controladores podem ser configurados e ajustados para
atingir bom desempenho e robustez em CS com atrasos de tempo incerto.

A problemática de gestão de cadeias de suprimento é uma área de
aplicação emergente que foge das aplicações tradicionais da engenharia de
controle de sistemas e, portanto, os estudos sobre técnicas de controle apli-
cadas a esse problema ainda não estão concluídos. Análises mais detalhadas
da influência do atraso na robustez dos controladores ainda precisam ser mais
bem elaboradas (NANDOLA; RIVERA, 2013). Assim, neste trabalho se estudará
a aplicação de algoritmos de compensação de atraso e técnicas de otimização
baseadas em funções objetivo sob MPC para o controle de CS.

1.3 OBJETIVOS

O objetivo geral deste trabalho é focado no estudo da cadeia de supri-
mentos de dowstream na indústria de petróleo, gás natural e biocombustíveis
implementando controle preditivo para manter os estoques. Compreendendo
assim, o sistema de processamento do petróleo nas refinarias e armazenagem
dos derivados para sua posterior comercialização atendendo ao mercado con-
sumidor. No caso dos biocombustíveis, o sistema é considerado a partir do
processo de transformação da cana-de-açúcar em álcool e produtos deriva-
dos importantes para sua cadeia produtiva. Em particular propõe-se o estudo
de controladores com compensação explícita do atraso em cadeias de supri-
mento que experimentem efeitos de bullwhip, visando corregir-o e atingir
bom desempenho e boa robustez. Mais especificamente busca-se examinar a
estrutura das cadeias de suprimento, evidenciando o problema do atraso de
transporte no fluxo de materiais e informação, estudando boas soluções que
amorteçam adequadamente oscilações provenientes da operação sujeita a in-
certezas típicas de demanda e que mantenham os níveis dos estoques para o
comportamento requerido pelo mercado.

1.4 ESTRUTURA DA DISSERTAÇÃO

Este documento contém 6 capítulos.



29

No Capítulo 2 discute-se a aplicação da teoria de controle em cadeias
de suprimentos, explica-se a problemática comum dos sistemas e as especifi-
cações típicas para o controle. São abordadas as metodologias mais comuns
para modelagem dos sistemas de CS. Apresenta-se também uma revisão da
literatura com vários dos estudos sobre o controle de CS e são abordadas
vantagens de usar técnicas de controle preditivo para obter boas soluções em
CS.

No Capítulo 3 descrevem-se os conceitos básicos de controle preditivo
baseado em modelo, apresentam-se a metodologia do GPC e suas caracterís-
ticas mais importantes; apresenta-se como a formulação é facilmente exten-
sível para o caso multivariável. Ainda no Capítulo 3 são incluídas questões
chave para o uso da estrutura de compensação de atraso de tempo na predi-
ção, ideias que serão utilizadas ao longo do trabalho como forma de melhorar
o desempenho dos algoritmos GPC para sistemas com atrasos e divergências
significativas na modelagem.

No Capítulo 4 são explicadas estratégias de coordenação na imple-
mentação do controle em sistemas de CS aplicado a um exemplo geral para
controle de estoques. É revisada a modelagem do sistema e a aplicação do
algoritmo de controle como solução do problema de estoques. Além disso, é
avaliado o comportamento do sistema operando sob incertezas na previsão da
demanda.

No Capítulo 5 mostram-se e discutem-se os resultados obtidos em sis-
temas de CS simulados em ambientes próprios para estudos na indústria de
petróleo, gás natural e na indústria de biocombustíveis, avaliando caracterís-
ticas de desempenho dinâmica e econômica dos sistemas.

No Capítulo 6 apresentam-se tanto as conclusões deste trabalho, como
sugestões para trabalhos futuros e comentários finais.



30



31

2 TEORIA DE CONTROLE EM CADEIAS DE SUPRIMENTO

Na sequência serão apresentados os princípios de funcionamento e os
modelos matemáticos adequados para descrever os sistemas de armazena-
mento em cadeias de suprimento. Outro assunto discutido neste capítulo é a
característica dos atrasos de tempo tipicamente presentes nos sistemas de CS.
Finalmente, serão apresentados os objetivos e as vantagens ao se aplicarem
teorias de controle preditivo junto com uma rápida revisão da literatura que
abrange estudos em aplicação da teoria de controle para gestão de estoques.

2.1 PROBLEMÁTICA

Uma cadeia de suprimento é um processo de fabricação integrado,
em que as matérias-primas são convertidas em produtos finais entregues aos
clientes. No seu mais alto nível, grosso modo, uma CS é composta por dois
processos integrados básicos: (1) o planejamento de produção e controle de
estoque, e (2) a distribuição e processo de logística. Esses processos propor-
cionam um quadro básico para a conversão e a transformação de matérias-
primas em produtos finais (BEAMON, 1998). O processo produtivo e plane-
jamento e controle de estoque abrange os sub-processos de fabricação, ar-
mazenamento, e sua interface. Descreve a concepção e gestão das políticas
e procedimentos de armazenamento de matérias-primas, estoques de produto
em processo (produto semi-acabado), e, geralmente, produtos finais. Dis-
tribuição e processo logístico, determinam como os produtos são recuperados
e transportados a partir do armazém para os varejistas ou clientes finais. Esses
produtos podem ser transportados para os varejistas diretamente, ou podem
ser primeiro levados para centros de distribuição, para finalmente serem en-
tregues aos varejistas. Esse processo inclui a gestão de recuperação de es-
toque, transporte e entrega do produto final (BEAMON, 1998). Dessa maneira,
dificulta-se a integração dos processos lógisticos. As complexidades envolvi-
das em cada uma das atividades do processo intervém em várias dependências
de uma ou várias empresas diferentes (cada uma com critérios próprios de
otimização de sua própria gestão), portanto a atividade de cada uma pode ser
afetada pelas decisões das outras (BENET; SUBIAS; GRIÑÓ, 2006).

Os níveis de estoque da CS dependem da quantidade produzida na
fábrica e da demanda dos clientes. O problema de controle é manter o nível
de estoque dentro valores pré-determinados, proporcionando um funciona-
mento economicamente ideal no processo de fabricação; em outras palavras,
evitar mudanças rápidas e quantidades indesejáveis de produto no estoque. Os



32

atrasos de tempo têm uma influência importante e são causados pelo tempo
necessário para que os pedidos de produtos sejam processados e emitidos,
como esquematizado na figura 2.1. Os atrasos podem descrever horas, dias
ou semanas, todo depende do sistema produtivo modelado.

Figura 2.1 – Tempos de produção e transporte na CS

Fonte:(BERNHARD; MARIOS, 2000)

O problema de fato com o atraso são as limitações físicas, que não
permitem que produtos sejam produzidos ou entregues até o decorrer dos
tempos de atraso após a recepção dos pedidos. São tempos de espera pre-
sentes na dinâmica do modelo. Como ilustrado na figura 2.1, o atraso pode
estar presente em todas as etapas da CS. As demoras se dão: (1) no fluxo de
materiais, devido aos tempos do processo produtivo, como fabricação, testes
de qualidade, e transportes dos lotes entre os elos envolvidos; (2) no fluxo de
informação, devido aos tempos de recepção e encaminhamento dos pedidos,
como envio de ordens de compra e confirmação de pagamentos (MIN; ZHOU,
2002). O atraso de tempo faz com que o efeito da demanda (perturbações na
CS) não seja considerado até que um tempo de atraso tenha decorrido. Em
termos de controle, o atraso de tempo faz que o efeito da ação de controle leve
algum tempo para ser observada na variável controlada e que a ação de con-



33

trole que é aplicada (calculada com base num erro atual) tente corrigir uma
situação originada em algum instante de tempo anterior, o que pode causar
instabilidade (NORMEY-RICO; CAMACHO, 2007).

De acordo com Sarimveis et, al. (2007), para projetar sistemas de
gestão em CS a engenharia de controle está excepcionalmente qualificada
para fazer contribuições de base ampla neste problema. O comportamento
dinâmico típico de cadeia de suprimentos justifica o interesse por técnicas de
MPC (NORMEY-RICO; CAMACHO, 2007). O MPC oferece alta flexibilidade em
termos de partilha de informações, topologia da rede, e manipulação de res-
trições (SUBRAMANIAM et al., 2012). O apelo do MPC para gestão de estoques
na dinâmica das cadeias de suprimento pode ser resumida como: (1) um oti-
mizador, no qual, pode-se minimizar ou maximizar uma função objetivo que
representa uma medida adequada para o desempenho da cadeia de suprimen-
tos; (2) um controlador, o qual, pode ser ajustado para alcançar estabilidade,
robustez e bom desempenho na presença de incompatibilidades ou erros na
modelagem, falhas e perturbações que afetam o sistema (NANDOLA; RIVERA,
2013). Também, a informação da previsão de demanda (perturbações) no
horizonte pode ser empregada no cálculo para antecipar o comportamento fu-
turo do sistema, o que desempenha um papel significativo no uso de MPC
para aplicações de cadeias de suprimento (SCHWARTZ; RIVERA, 2010). Com
respeito aos sistemas de gestão de CS com característica de atrasos de tempo
significativo, propõe-se neste trabalho usufruir da estrutura de compensação
de atraso de tempo explícita no preditor. O principal objetivo do preditor é
compensar o efeito do atraso de tempo no sistema. Ademais, com um ajuste
adequado é garantido o bom desempenho do sistema na presença de ruído
ou de perturbações e a robustez do sistema, quando incertezas de modelagem
são consideradas (NORMEY-RICO; CAMACHO, 2007).

2.2 MODELOS DE CADEIA DE SUPRIMENTO

Pesquisadores e profissionais têm investigado principalmente os vários
processos de fabricação dentro de cadeias de fornecimento individualmente.
Uma crescente atenção sobre o desempenho, projeto, e análise da CS como
um todo surge a partir da necessidade de obter um melhor desempenho na
administração da cadeia de suprimentos. Esta atenção é em grande parte re-
sultado do aumento dos custos de produção, ciclos de vida de produto mais
curtos, bem como a globalização das economias de mercado (BEAMON, 1998).

Considerando um espectro global do conceito de CS, existem esque-
mas de classificação para categorizar os modelos da cadeia de suprimentos. A
literatura apresenta várias categorias, que dependem da natureza das variáveis



34

e do objetivo de estudo. O trabalho de (MIN; ZHOU, 2002) resume as seguintes
categorias:

• modelos determinísticos, em que as variáveis são conhecidas e especi-
ficadas;

• modelos estocásticos, em que no mínimo uma das variáveis é desco-
nhecida, ou seja, há parâmetros incertos e aleatórios;

• modelos híbridos, os quais têm elementos de ambos os tipos de mode-
los: determinísticos e estocásticos. Estes incluem modelos de estoque
teóricos e de simulação que são capazes de lidar com as incertezas dos
parâmetros do modelo;

• modelos ET-driven, gerados a partir de desenvolvimentos em inovações
e subsequente reengenharia do processo de negócio. Modelos de tec-
nologias da informação - TI, visam integrar e coordenar as diversas
fases de planejamento da cadeia de suprimentos numa base em tempo
real, utilizando software de aplicação.

Este trabalho está focado para utilizar modelos híbridos. Baseados
em trabalhos apresentados em (FU; AGHEZZAF; KEYSER, 2014) e (NANDOLA;
RIVERA, 2013), empregam-se modelos determinísticos discretos que repre-
sentam as dinâmicas das cadeia de suprimentos em conjunto com modelos
estocásticos no caso de demandas que presumem-se seguir uma distribuição
de probabilidade.

A fim de aprofundar na área de modelagem para a análise de sistemas
de CS, o leitor é remetido para os trabalhos de (BEAMON, 1998) e (MIN; ZHOU,
2002), nos quais podem-se encontrar estudos mais detalhados.

2.2.1 Modelagem Matemática

O MPC utiliza um modelo matemático explícito para calcular correta-
mente as predições do comportamento do sistema no futuro. Desse modo, um
bom modelo representa uma grande vantagem no uso do MPC como metolo-
gia de controle do sistema de CS. A obtencão de um modelo matemático ade-
quado que descreva com detalhe suficiente a dinâmica e aspectos de interesse
no sistema de CS deve ser o mais simples possível, facilitando sua análise e
simulacão. Baseado no estudo feito por Valladares (2014), propõe-se um mo-
delo discreto que representa um dos estágios de uma cadeia de suprimentos,
figura 2.2. Nela, um fornecedor recebe matéria prima para produzir itens de
um certo tipo. Uma vez prontos, eles são estocados no armazém. Esse, por
sua vez, os transfere para a loja que os vende para os consumidores finais.



35

Figura 2.2 – CS simplificada de três estágios

Fonte:Elaborado pelo autor

Seguindo essas hipóteses, os comportamentos de cada um dos estágios
podem ser descritos como:

• fornecedor: recebe pedidos do armazém e, seguindo regras de decisão
internas, produz itens para supri-lo. O tempo entre disparar a ordem de
produção e as quantidades de itens e sua disponibilização para entrega é
chamado ? f ornecedor e, por simplicidade, não dependerá da quantidade
de itens;

• armazém: recebe pedidos da loja e, seguindo regras de decisão internas,
faz requerimento ao fornecedor. O tempo entre pedir as quantidades de
itens ao fornecedor e tê-los prontos para envio é ?armazm;

• loja: recebe pedidos dos consumidores e, seguindo regras de decisão
internas, faz solicitação ao armazém. O tempo entre pedir as quanti-
dades de itens ao armazém e tê-los prontos para venda é ?lo ja;

Se for considerado também que não há restrições de pedidos mínimos
ou máximos e que é possível fazê-los qualquer dia, os três estágios podem ser
descritos nas equações (2.1) e (2.2), sendo equações que satisfazem as leis de
conservação de acordo com pedidos (material) feitos e recebidos, da rede de
CS ilustrada na figura 2.2:

Ii(k) = Ii(k?1)+ Oi(k)?Di(k), (2.1)

Oi(k) = ui(k?? ). (2.2)

sendo k uma unidade de tempo discreto, como horas, dias, semanas,
Ii(k) a quantidade de itens disponíveis em estoque, Oi(k) a quantidade de
itens recebidos ou cuja produção está finalizada, di(k) a quantidade de itens



36

enviados ou vendidos e ui(k) a quantidade de itens pedidos, que age como as
entradas, ou sinal de controle desse sistema. di(k) é uma função de demanda
que retrata a saída de itens, porém, representa as perturbações no sistema.
Vale enfatizar que ? não depende de k, o atraso é constante. Sem essa con-
sideração a complexidade do estudo aumentaria consideravelmente.

Na figura 2.3 mostra-se o diagrama de blocos do sistema de controle
para o modelo em (2.1) e (2.2). Usando terminologia de controle, a planta
estudada é um acumulador, submetido a um controle com atraso somado a
distúrbios aleatórios na sua entrada (VALLADARES, 2014).

Figura 2.3 – Diagrama de blocos do modelo simplificado da rede de CS

Fonte: (VALLADARES, 2014)

De acordo com Simchi-Levi (2004), considera-se que o fornecedor
nunca carece de matéria-prima ou tem amplas mercadorias em estoque para
satisfazer os seus clientes (demandas). Portanto, com esta aproximação e
aplicando transformada z de ambos os lados do modelo em (2.1), obtém-se
(2.3).

yi(k) =
1

1?z?1
z?? (ui(k)?di(k)) (2.3)

Assim, o modelo de tempo discreto, para o nó i (i = fábrica, armazém,
loja etc.) capta as características dinâmicas do fluxo de material e do fluxo de
informação no sistema da cadeia de suprimento. Na equação (2.3) a variável
Ii(k) foi reemplazada por yi(k), comumente usada para definir a saída do sis-
tema ou variáveis controladas. A maneira de tratar esses modelos de forma
extendida, combinando a função de transferência de cada nó num sistema,
será exemplificada no capítulo 4.



37

2.2.2 Especificações típicas para Controle

Para o controle de cadeia de suprimentos podem ser projetadas tantas
malhas de controle quanto forem necessárias, dependendo da topologia de
rede e dos objetivos desejados. A otimização da estruturação de rede envolve
a centralização ou descentralização do sistema de gestão. Uma distribuição
adequada da rede consolida o desempenho na CS. As decisões de controle são
obtidas a partir da otimização de funções custo dadas, os problemas são es-
pecificados como funções de uma ou mais variáveis de decisão. Geralmente,
os principais ambientes são redes de produção, desse modo, especificam-se
todas as variáveis de decisão envolvidas e o problema é projetado (por exem-
plo, maximizando rendimentos / minimizando custos), (LI; MARLIN, 2009).

É comum caracterizar o problema de controle segundo os requerimen-
tos definidos na programação da produção, assim, são definidos e especi-
ficados os parâmetros do sistema. Exemplos típicos são: especificação de
capacidade (espaço disponível) para estocagem e manufatura, muitas vezes
definidos como restrições do sistema. Com tal característica, o uso do MPC,
apresenta vantagens devido à facilidade na manipulação das restrições, cons-
tituindo mais uma razão na escolha dessa metodologia para o controle do sis-
tema de CS. Outros exemplos tais como: janelas de tempo, datas de entrega,
tempo máximo de fabricação, número de horas de condução para motoristas
(transporte de matérias primas e produtos terminados), etc, podem ser leva-
dos em conta na modelagem dos sistemas ou definidos nas especificações de
controle.

As variáveis manipuladas são as quantidades necessárias (pedidos) de
material. Aqui é definido o volume de produção. Esta variável inclui o vo-
lume ideal para aquisição de materia-prima, produção de mercadorias e vo-
lumes de transporte de materiais em cada nó da cadeia de suprimentos. As
variáveis controladas são os níveis dos estoques (quantidades em estoque).
Estas variáveis representam a quantidade ideal de cada material para ser ar-
mazenado em cada etapa da cadeia de suprimentos.

As perturbações atuantes no sistema são oriundas da evolução da de-
manda do mercado, e do padrão de produção. O mais prejudicial para o fun-
cionamento do sistema de controle de CS, é o regime de variações severas na
demanda. Desse modo, o objetivo é manter o estoque próximo da referência e
rejeitar o distúrbio. Isto significa atender a demanda sem desviar dos valores
próximos à referência desejada para o estoque.



38

2.3 CONTROLE DE CADEIAS DE SUPRIMENTO NA LITERATURA

Inicialmente, começou-se a utilizar a teoria de controle no estudo de
CS a partir da aplicação de servomecanismos de tempo contínuo, manipu-
lando a taxa de produção em um sistema simples que envolvia um único pro-
duto (HERBET, 1952). Posteriormente, estenderam-se essas ideias a modelos
de tempo discreto para controle de estoques baseados nos conceitos da trans-
formada z (VASSIAN, 1955). Na sequência, introduziu-se o modelo Forrester,
que permitiu abordar problemas no âmbito de organização industrial. Seu
amplo uso para ilustrar os problemas presentes nas CS facilitou e forneceu
uma ferramenta poderosa para a utilização de técnicas de controle no geren-
ciamento de estoque (TOWILL D.AND NAIM; WIKNER, 1992). São muitas as
contribuições na aplicação da teoria de controle clássica que se tem na li-
teratura, as quais, basicamente visam atenuar as flutuações causadas pelas
variações de demanda e ao mesmo tempo manter os níveis de estoque dentro
de restrições. Métricas de controle padrão são usadas para quantificar o de-
sempenho, avaliando características de performance dinâmica (SARIMVEIS et
al., 2007). Também existem registros acadêmicos na aplicação de técnicas de
controle feedforward usado para alcançar erro zero em estado estacionário
dos estoques, assim como a implementação da metodologia PID no para
reduzir níveis de estoque e custos de produção (SCHWARTZ; RIVERA, 2010).
Conceitos de controle Fuzzy também provados para abordar problemas em
gestão de estoques (WANG, 2009).

Para processos industriais o MPC tornou-se um sistema de controle
padrão. Isto porque, o MPC lida eficientemente com restrições e não lineari-
dades dos sistemas dinâmicos multivariáveis (CAMACHO; BORDONS, 2004).
No ano de 1992, aplicou-se pela primeira vez a teoria de controle preditivo
em um problema de gerenciamento de estoques, com foco em um problema
local de fabricação. Nesse estudo, (KAPSIOTIS; TZAFESTAS, 1992), tentaram
compensar os prazos de produção, incluindo na função custo do controlador
um termo de penalidade nos desvios da trajetória de referência. Posterior-
mente, muitos trabalhos surgiram com aplicação da teoria de controle pre-
ditivo em gestão de CS. (PEREA; YDSTIE; GROSSMANN, 2003), empregam um
esquema MPC para otimizar toda uma rede multi-produto, multi-nodular com
uma demanda determinística. No trabalho são comparadas as abordagens de
gestão centralizada e descentralizada, com aumentos de lucro de até 15%
nas simulações em que empregaram a estrutura centralizada. Além disso,
ressaltam as vantagens dos horizontes moveis para atualizar a variáveis de
decisão sempre que aconteçam mudanças que afetam a CS. (BRAUM et al.,
2002), têm apresentado trabalhos com MPC para gestão de CS desde o inicio
do milênio, principalmente na área de manufatura de semicondutores. Suas



39

pesquisas abarcam várias metodologias para o controle de estoque. Em 2002
propuseram um esquema MPC linear para problemas nas CS de grande oferta
na indústria de semicondutores. Através de experimentos, mostraram que o
MPC pode lidar adequadamente com as incertezas resultantes por incompati-
bilidade de modelo e erros na previsão da demanda. Devido à complexidade
da cadeia de suprimentos, trabalharam com um esquema descentralizado. Os
objetivos para cada controlador MPC eram manter os níveis de estoque o mais
próximo possível dos valores de referência, desde que satisfaçam as capaci-
dades de produção e restrições de transporte. (WANG; RIVERA; KEMPF, 2003),
aplicam uma abordagem centralizada para um modelo de CS simples de dois
nós. Em seu trabalho usam a modelagem por analogia de fluidos e conseguem
mostrar um bom desempenho do controlador MPC, satisfazendo a demanda
frente a erros na modelagem e incrementos nos atrasos do sistema. Tam-
bém é apresentado um exemplo mais realístico, para um sistema de quatro
nós usando um só controlador MPC demostrando robustez e níveis dos esto-
ques razoáveis. (SCHWARTZ; RIVERA, 2010), resumem a descrição matemática
de um modelo nominal por meio de analogia de fluidos para sistemas de ar-
mazenamento. Suas contribuições sugerem políticas de controle PID, IMC e
MPC expondo a necessidade de aplicar ações feedback e feedforward, para
gerar mais graus de liberdade para o controlador, permitindo abordar de forma
independente vários conflitos presentes nas CS, como são os níveis críticos
de estoque em presença de demanda incerta.(NANDOLA; RIVERA, 2013), apre-
sentam uma formulação de controle híbrido encaixado perfeitamente nas es-
truturas CS que envolvem dinâmicas continuas e decisões lógicas (eventos
discretos). Obtém um modelo de controle MPC com três graus de liberdade
visando um ajuste independente para seguimento de referência, rejeição de
perturbações não mesuráveis e rejeição antecipada das perturbações conheci-
das ou mensuráveis. Encoraja-se o leitor a ler os trabalhos de (SARIMVEIS et
al., 2007) e (SUBRAMANIAM et al., 2012) para uma revisão mais detalhada da
aplicação de técnicas de engenharia de controle para os problemas de CS.

Agora bem, para casos mais específico nas indústrias de petróleo, gás
natural e biocombustíveis a literatura exibe vários estudos em otimização
para o modelagem e planejamento em gestão da CS usando programação
linear e controle ótimo. Alguns trabalhos como o de (NEIRO; PINTO, 2004),
apresentam um quadro geral para a modelagem das cadeias de suprimento
de petróleo. Propuseram também um modelo em grande escala do forneci-
mento de petróleo numa refinaria localizada estrategicamente num mercado
de consumo importante no Brasil. A topologia foi criada a partir de estruturas
gerais básicas: modelo de unidade de processamento, modelo de unidade de
armazenamento (tanque) e modelo das unidades de transporte (oleoduto). O
problema de otimização é então a maximização do lucro obtido pelas ven-



40

das menos os custos relacionados com a matéria prima, operações, estoque
e transporte de produtos. Por sua parte, (AL-OTHAM et al., 2007), indicam
um padrão realista para otimização duma cadeia de suprimento numa em-
presa petroquímica que envolve todas as atividades relacionadas à produ-
ção, processamento e distribuição num país produtor de petróleo que opera
sob condições econômicas incertas. São avaliados modelos determinísticos
e estocásticos. O modelo de programação estocástica proposto mostrou-se
bastante eficaz na determinação de planos de produção óptimos que mini-
mizem os riscos que normalmente são encontrados devido às flutuações nas
condições do mercado. Concluem assinalando que planejamento num ambi-
ente econômico incerto é arriscado. Porém, é importante que a organização
de petróleo desenvolva e implemente planos de produção flexíveis visando
ter uma carteira diversificada. No mesmo campo, biocombustíveis compõem
uma área importante de estudos em gestão da sua CS devido ao crescimento
e ampla aceptação do produto como uma ótima solução as necessidades de
abastecimento e sustentáveis. O importante estudo feito por (AN; WILHELM;
SEARCY, 2011), citam em seu trabalho numerosas contribuições que foram
publicadas na última década sobre gestão da CS em organizações produtoras
de biocombustíveis e indústrias de combustíveis à base de petróleo. Além
disso, apresentam literatura sobre modelos de cadeia de suprimento relevantes
e genéricos para o tratamento destes sistemas, analisando como realizar a in-
tegração dos níveis de decisão que geram impacto na indústria.

2.4 COMENTÁRIOS FINAIS DO CAPÍTULO

Neste capítulo foram apresentados os problemas fundamentais em sis-
temas de gestão de CS em conjunto com uma exposição de soluções uti-
lizando técnicas de controle preditivo. Foram explicados os princípios para
modelagem dinâmica das cadeias de suprimento, e objetivos alvo do controle.
Também se analisaram os modelos utilizados para a estabelecer os cenários
de simulação nos resultados mostrados nos capítulos 4 e 5. No próximo capí-
tulo será realizada uma revisão bibliográfica sobre MPC e técnicas utilizadas
para amortecimento de perturbações e compensação do atraso de tempo.



41

3 CONTROLE PREDITIVO (MPC)

No capítulo 2 foram discutidos os princípios de modelgem e obje-
tivos de controle dos sistemas de CS. A seguir serão apresentadas técnicas
de controle preditivo que serão aplicadas a estes processos. Primeiramente
nas seções 3.1, 3.2 e 3.3 será realizada uma descrição breve sobre MPC e
na sequência na seção 3.4 é apresentada a fundamentação teórica do contro-
lador GPC. Posteriormente na mesma seção serão apresentadas técnicas de
controle GPC com restrições e apresenta-se a metodologia DTC-GPC, útil
em processos sujeitos à ação de perturbações e erros de modelagem comuns
em sistemas de CS, para finalizar descreve-se também a extenção para o caso
multivariável na seção 3.5.

3.1 CONCEITOS BÁSICOS DE CONTROLE PREDITIVO BASEADO EM
MODELO (MPC)

O MPC é um conjunto de metodologias desenhadas para obter contro-
ladores eficientes e regidos segundo a estrutura de otimização padrão. A es-
tratégia de controle é baseada na predição do comportamento futuro da saída
de um processo. Para realizar a predição, o MPC usa um modelo explícito do
sistema para prognosticar o comportamento das variáveis controladas nos fu-
turos instantes de tempo e para um horizonte definido. As sequências de con-
trole são obtidas por meio da minimização ou maximização de uma função
custo dada, cujo objetivo é atingir o valor do controle ótimo segundo as res-
trições físicas ou econômicas do processo. O MPC trabalha sob o conceito de
janela móvel, ou seja, apesar da minimização da função objetivo resultar em
um vetor de controles que devem ser aplicados no tempo, na amostra seguinte
ao cálculo apenas a primeira ação de controle será aplicada e todas as ações
de controle serão recalculadas de acordo com as novas informações obtidas
do sistema real.

3.2 ESTRUTURA BÁSICA DOS CONTROLADORES PREDITIVOS

O MPC usa uma estrutura como a mostrada na figura 3.1. A predi-
ção ótima depende das ações de controle futuras, dos valores das saídas e
entradas passadas, do modelo do processo, da função custo e das restrições
quando estas são necessárias. Portanto, o modelo escolhido, deverá represen-



42

tar ao máximo a dinâmica do processo, atingindo predições mais próximas da
realidade.

Figura 3.1 – Estrutura básica do MPC

Fonte: Elaborado pelo autor

A seguir serão apresentados os elementos mais comuns nas estratégias
do controle MPC: o uso explícito do modelo para predição, a função custo ou
objetivo empregada para otimização, e o cálculo da lei de controle.

3.2.1 Modelo de predição

O modelo de predição é o modelo resultante da caracterização do sis-
tema. A estratégia MPC obriga buscar um modelo de predição suficiente-
mente rico que permita obter boas predições do comportamento do processo
o mais perto possível da realidade, o modelo deve ser fácil de usar, analisar
e compreender. O modelo de predição é composto pelo modelo do processo
e pelo modelo das pertubações e é o elemento mais importante em um algo-
ritmo de controle preditivo. Como o MPC baseia todo seu cálculo da lei de
controle no modelo de predição, todas as vantagens do uso de controle predi-
tivo podem ser perdidas caso o modelo que está sendo usado não represente
adequadamente a dinâmica do processo.

A grande maioria dos controladores preditivos baseados em modelo
usados na indústria, empregam modelos de predição lineares. Nestes casos
para representar o processo no MPC é frequente o uso da resposta ao im-
pulso ou a resposta ao degrau, além de representação por meio de funções de
transferência, e de modelos a partir de variáveis de estado.



43

• modelo de resposta ao impulso: representação válida só para sistemas
estáveis, pois submete-se o modelo do processo a uma excitação tipo
impulsiva. O algoritmo MAC utiliza este modelo para realizar as pre-
dições, (RICHALET et al., 1978).

• modelo de resposta ao degrau: como na representação anterior, a repre-
sentação do processo usando a resposta ao degrau é usada para dinâmi-
cas estáveis, (existindo uma extensão para o uso em sistemas de tipo
integrador) (NORMEY-RICO; CAMACHO, 2007). Uma vantagem deste
metodo é que permite uma fácil identificação e para tal não é necessário
muita informação prévia do processo. O algoritmo DMC emprega este
modelo para obter suas predições, (GARCIA; MORSHEDI, 1985).

• modelo de função de transferência: a relação entrada/saída está dada
por uma função de transferência discreta e é válida para sistemas que
apresentem dinâmicas estáveis e instáveis. Este modelo exige conhe-
cimentos e informação especifíca quando deseja-se identificar os parâ-
metros da função de transferência. Algoritmos como o GPC, EPSAC e
EHAC usam este modelo para realizar a predição, (CLARKE; MOHTADI;
TUFFS, 1987),(GARCIA; PRETT; MORARI, 1989).

• modelo no espaço de estados: tem como ventagem que é possível re-
presentar sistemas multivariáveis e sistemas não lineares de forma sim-
ples. A literatura dispõe deste tipo de modelos, muito usados na repre-
sentação de processos químicos, petroquímicos, aeronáuticos, electri-
cos (GARCIA; PRETT; MORARI, 1989).

3.2.2 Função custo

Em geral propõe-se a função custo visando obter uma lei de controle
que permita à saída futura seguir uma trajetória de referência para um hori-
zonte desejado e ao mesmo tempo penalize o esforço do controle. Para casos
mais específicos a função custo pode mudar, incluindo mais variáveis a serem
otimizadas. A função custo considerada aqui se mostra na equação (3.1).

J(k) = ?
N2

?
j=N1

[yp(k + j | k)?w(k + j | k)]2 +
Nu

?
j=1

? [?u(k + j?1 | k)]2 (3.1)

Em (3.1), ?u(k) = u(k)?u(k ?1), são os incrementos de controle,
yp(k + j|k) é o vetor com as predições ótimas j passos em frente da saída do
sistema com a informação fornecida até o instante k. w(k + j|k) é o vetor



44

de referência. ? e ? são as ponderações do erro de predição e dos esforços
de controle, respectivamente. A função é minimizada para os horizontes de
predição, N = N1?N2, e de controle, Nu, definidos. Os parâmetros anteriores
são usados para sintonia do controlador, assim, obtém-se uma ampla gama de
possibilidades para cobrir problemas de controle padrão, e para casos especí-
ficos pode-se achar uma estratégia mais particular.

3.2.3 Cálculo da lei de controle

A lei de controle é obtida ao resolver o problema de otimização na
função custo (3.1), incluindo as restrições, se existirem. O cálculo é feito para
cada período de amostragem, utilizando o conceito de janela móvel. Desse
modo, aplica-se só a primeira ação de controle e recalcula-se o vetor de incre-
mentos de controle novamente com a informação real do sistema atualizada.

3.2.4 Metodologia dos controladores preditivos

A metodologia dos MPC é caracterizada pela seguinte estratégia:

1. É usado um modelo do processo para predizer a saída no futuro a cada
amostra (k) e para o horizonte definido (N), chamado horizonte de pre-
dição. A saída predita yp(k+ j |k)1, depende dos valores conhecidos da
entrada e saída no passado até (k), além do valor do controle no futuro
u(k + j?1 | k) para j = 1,2,3...Nu, calculado a partir da otimização da
função custo dada.

2. Os sinais de controle futuros são calculados otimizando um critério
determinado para manter o processo mais próximo da trajetória de re-
ferência w(k + j | k). Normalmente o critério é uma função quadrática
do erro de predição e o esforço do controle. Se o critério é quadrático,
o modelo linear e não existem restrições é possível obter uma solução
explícita, outros casos precisam usar métodos iterativos de otimização.

3. Aplica-se o primeiro elemento do vetor de sinais de controle futuros,
ou seja, o sinal de controle correspondente a u(k | k), e fazendo uso
do horizonte de janela móvel, a cada amostra calcula-se novamente a
sequência de controle ótima incluindo os valores atuais das variáveis
no algoritmo.

1A notação yp(k + j | k) indica a predição no instante j à frente de k, calculado com a infor-
mação em k.



45

Figura 3.2 – Metodologia do MPC

Fonte: Elaborado pelo autor

A figura 3.2 exemplifica as características da metodologia do MPC em
um sistema de estoque no dominio do tempo. Na parte superior observa-se
a saída do sistema (variável controlada) que representa o nível de estoque.
No meio, aparece a perturbação do sistema que representa a demanda de
produto no estoque. Por último, na parte inferior, observa-se a entrada do
sistema (variável manipulada) que descreve as quantidades de produto que
deven ser repostas no estoque. Assim, o algoritmo MPC usa o modelo expli-
cito do sistema de armazenamento para fazer as previsões do comportamento
no futuro das quantidades de produto em estoque visando atingir um nível
desejado (setpoint do estoque). O modelo pode incluir o comportamento da
demanda no futuro e, dessa maneira, conhecer melhor as mudanças na es-
tocagem. Otimizando uma função custo são calculadas as ações de controle
ótimas, ou seja, são calculadas as quantidades requeridas para atingir a de-
manda e manter os níveis de estoque desejados. No caso, observam-se límites
máximos e mínimos nessas quantidades a serem calculadas, representando
restrições no sistema, quantidades que deven ser respeitadas no problema de
otimização. Finalmente, como indicado no ítem 3, as sequências de controle
são calculadas ao longo do horizonte, mas só são aplicadas no instante atual



46

e recalculadas novamente com informação atualizada no seguinte instante de
tempo.

3.3 CONTROLE PREDITIVO GENERALIZADO (GPC), SISTEMAS MONO-
VARIÁVEIS

Este método utiliza um modelo CARIMA (Controlled Auto-Regressive
Integrated Moving Average) para a predição da saída do sistema, equação
(3.2), a perturbação descrita no polimomio C(z?1) é tipicamente modelada
como ruído branco integrado.

A(z?1)y(k) = B(z?1)z?d u(k?1)+
C(z?1)

?
e(z?1) (3.2)

A(z?1) = 1 + a1z
?1 + a2z

?2 +...+ ana z
?na

B(z?1) = b0 + b1z
?1 + b2z

?2 +...+ bnb z
?nb

A(z?1) e B(z?1) de ordem na e nb respectivamente, são os polinômios
que contem a dinâmica do sistema. d representa o atraso. É comun C(z?1) =
1 para facilitar a análise do algoritmo. Assim, a equação (3.2), pode ser ex-
presada como:

y(k) =
B(z?1)
A(z?1)

z?d u(k?1)+
1

A(z?1)?
e(z?1). (3.3)

Para minimizar a função custo (3.1), é necessário obter primeiro a
predição ótima yp(k + j|k), na janela de predição N = N2 ?N1. Aplicando-se
o algoritmo da divisão, o último termo da equação (3.3), se escreve na forma:

1
A(z?1)?

= E j(z
?1)+

Fj(z?1)
A(z?1)?

z? j (3.4)

Assim, 1 = ?A(z?1)E j(z?1)+Fj(z?1)z? j , e fazendo A?(z?1) = ?A(z?1)
= (1?z?1)A(z?1), obtém-se A?(z?1)E j(z?1) = 1?Fj(z?1)z? j . Dessa maneira,
multiplicando a equação (3.2) por ?E j(z?1)z j , encontra-se yp(k + j|k) como
se mostra a seguir.

?E j(z
?1)z j A(z?1)y(k) = ?E j(z

?1)z j z?d B(z?1)u(k?1)+
?E j(z?1)z j

?
e(k)



47

A?(z?1)E j(z
?1)yp(k + j|k) =E j(z?1)B(z?1)?u(k + j?d ?1|k)+

E j(z
?1)e(k + j|k)

[1?Fj(z?1)z? j]yp(k + j|k) =E j(z?1)B(z?1)?u(k + j?d ?1|k)+
E j(z

?1)e(k + j|k)

yp(k + j|k) =E j(z?1)B(z?1)?u(k + j?d ?1|k)+ E j(z?1)e(k + j|k)
+ Fj(z

?1)z? j yp(k + j|k)

Fazendo G(z?1) = E j(z?1)B(z?1) resulta:

yp(k + j|k) =G(z?1)?u(k + j?d ?1|k)+ Fj(z?1)yp(k|k)
+ E j(z

?1)e(k + j|k) (3.5)

E j(z?1) e Fj(z?1) são polinômios auxiliares para o cálculo recursivo
das predições, na forma em que os novos valores no passo j + 1 (E j+1 e Fj+1)
são função do passo j. A melhor predição yp(k + j|k) obtém-se, supondo
que o ruido futuro é nulo e(k + j|k) = 0 e como E j(z?1) tem grau menor a j.
E j(z?1)e(k + j|k) está no futuro, assim:

yp(k + j|k) = G(z?1)?u(k + j?d ?1|k)+ Fj(z?1)yp(k|k) (3.6)

Emprega-se a combinação linear das saídas anteriores do processo e
das ações de controle passadas e futuras na janela N = N1 ?N2. O conjunto
de N predições ótimas é:

yp(k + 1|k) = G1(z?1)?u(k|k)+ F1(z?1)yp(k|k)

yp(k + 2|k) = G2(z?1)?u(k + 1|k)+ F2(z?1)yp(k|k)

...

yp(k + N|k) = GN(z?1)?u(k + N ?1|k)+ FN(z?1)yp(k|k) (3.7)

Cabe esclarecer aqui que, sem perda de generalidade, nos processos
que apresentam características de atraso de tempo, os horizontes N1 e N2
calculam-se como: N1 = d + 1 e N2 = d + N. A janela de predição é mod-
ificada N = N2 ?N1, desse modo só interessam as predições nesse intervalo



48

assim:

yp(k + d + 1|k) = Gd+1(z?1)?u(k|k)+ Fd+1(z?1)yp(k|k)

yp(k + d + 2|k) = Gd+2(z?1)?u(k + 1|k)+ Fd+2(z?1)yp(k|k)

...

yp(k + d + N|k) = Gd+N(z?1)?u(k + d + Nu ?1)+ Fd+N(z?1)yp(k|k)

A equação (3.7) pode ser reescrita na forma vetorial como:

Y = G(z?1)?u + F(z?1)yp(k|k)+ G?(z?1)?u (3.8)

onde:

Y =

?
????

yp(k + d + 1|k)
yp(k + d + 2|k)

...
yp(k + d + N|k)

?
????

?u =

?
????

?u(k)
?u(k + 1)

...
?u(k + Nu ?1)

?
????

G(z?1) =

?
????????

g0 0 0 0
g1 g0 0 0
g2 g1 g0 0
g3 g2 g1 g0
...

...
...

...
gN?1 gN?2 gN?3 g(N?Nu)

?
????????

g0, g1, g(N?1) correspondem aos coeficientes obtidos no calculo das ecuações
diofantinas ao longo do horizonte representando a dinâmica do sistema que
relaciona as entradas e saídas futuras.



49

G?(z?1) =

?
????

z[Gd+1(z?1)?g0]
z2[Gd+2(z?1)?g0 ?g1z?1]

...
zN[Gd+N(z?1)?g0 ?g1z?1 ...?gNu?1z

Nu?1]

?
????

F(z?1) =

?
????

Fd+1(z?1)
Fd+2(z?1)

...
Fd+N(z?1)

?
????

Os dois últimos termos da equação (3.8) dependem só do passado, por
o que podem se agrupar em um só termo f, conforme a equação (3.9).

Y = G?u + f (3.9)

A equação 3.9 representa uma característica típica dos controladores
preditivos, os quais usam os conceitos de resposta livre f e forçada G?u para
calcular a ação de controle em função da soma de dois sinais. Em (3.9),
G é a matriz com os coeficientes gi que definem a dinâmica do sistema. f
é a resposta livre do sistema, resposta que depende da evolução do processo
segundo os controles passados e que no futuro vão se manter constantes. G?u
representa a resposta forçada, que é a resposta que depende da evolução do
processo segundo os controles futuros.

Usando (3.1)2 e colocando ela na forma vetorial temos:

J = (Gu + f?W )T (Gu + f?W )+ ?uT ? ?u (3.10)

W =

?
????

w(k)
w(k + 1)

...
w(k + N ?1)

?
????

Fatorando (3.10) como

J = uT GT Gu + uT GT (f?W )+(f?W )T Gu +(f?W )T (f?W )uT + ?uT ? ?u

obtém-se:

2No caso monovariável é possível omitir o parâmetro ? na função custo.



50

Figura 3.3 – Resposta livre

Fonte: Elaborado pelo autor

J = ?uT (GT G + ? I)?u + 2(f?W )T G?u?(f?W )T (f?W ). (3.11)

É possível escrever J na forma de uma função quadrática como em
(3.12),

J =
1
2

?uT H?u + bT ?u + f0 (3.12)

Com: H = (GT G + ? I), bT = 2(f?W )T G e f0 = (f?W )T (f?W ).
Para um caso sem restrições, a equação (3.12) tem um valor mínimo que se
obtém derivando a função em relação à variável ?u e igualando-a a zero, ou
seja:

dJ
du

= H?u + b = 0



51

Figura 3.4 – Resposta Forçada

Fonte: Elaborado pelo autor

Portanto, no caso sem restrições

?u =?H?1b =?[2(GT G + ? I)]?1(2(f?W )T GT )T

?u = (GT G + ? I)?1GT (W ?f) (3.13)

Para um sistema sem restrições e devido a que no instante j só interessa
aplicar o primeiro elemento de controle u(k), na equação 3.13 só interessa a
primeira linha da matriz (GT G + ? I)?1GT . Assim, a lei de controle para o
GPC é expressa como:

?u = K(W ?F), (3.14)

K é a primeira linha de (GT G + ? I)?1GT .

3.4 USO DE RESTRIÇÕES

Uma das vantagens mais significativas e interessantes do MPC é a
possibilidade de manipular as restrições físicas ou econômicas dos proces-



52

sos, considerando limites de operação e condições de qualidade específicas.
O cálculo da ação de controle descrito na equação (3.13) foi formulado con-
siderando que todos os sinais do processo possuem uma faixa de valores ili-
mitados. Essa abordagem não é muito realista porque na prática todos os pro-
cessos estão sujeitos a restrições. Os sinais de controle possuem um intervalo
de ação e uma taxa de variação limitada. Razões construtivas e/ou de segu-
rança, causam limitações nas variáveis de processo, como no caso dos níveis
nos reservatórios. Os sistemas de controle normalmente operam próximo aos
limites, o que pode acarretar violação de restrição. Cabe ao controlador an-
tecipar e corrigir essas violações de forma que não aconteçam, evitando a
instabilização do sistema. Neste contexto, os controladores MPC se mostram
eficazes, uma vez que possuem a capacidade de prever possíveis violações
ao longo do horizonte de predição e incluem as restrições na solução do pro-
blema de otimização. Essas características possibilitam que os controladores
MPC evitem a ocorrência das mesmas.

No sistema podem ser inseridas restrições hard (duras) e soft (suaves).
As restrições duras são restrições que sempre devem ser cumpridas e estão em
maior número associadas às variáveis manipuladas, aplicam-se às variáveis
controladas por segurança. Restrições suaves podem ser violadas durante
um transitório do sistema causado por perturbações, sendo que em regime
permanente devem ser respeitadas.

Existem três tipos principais de restrições frequentemente encontradas
em aplicações práticas (CAMACHO; BORDONS, 2004). A otimização da função
custo (3.12) considerando restrições é expressada como:

J =
1
2

?uT H?u + bT ?u + f0

Sujeito : A?u ? B

• Restrições na variação das variáveis de controle: Para que existam res-
trições na taxa de variação da ação de controle no horizonte de controle
Nu deve cumprir-se:

?umin ? ?u(k)? ?umax, ?k



53

pode-se escrever na forma:

?u(k)? ?umax (3.15)
??u(k)???umin

Relembrando:

?u =

?
????

?u(k)
?u(k + 1)

...
?u(k + Nu ?1)

?
????

É possível expressar as desigualdades (3.15) na forma matricial:

[
I
?I

]?????
?u(k)

?u(k + 1)
...

?u(k + Nu ?1)

?
?????

?
?????????????

?umax1
?umax2

...
?umaxNu
??umin1
??umin2

...
??uminNu

?
?????????????

(3.16)

• Restrições na magnitude das variáveis de controle: quando existem
restrições nas magnitudes das variáveis de controle futuras, deve se
cumprir:

umin ? u(k)? umax, ?k

Ou escritas da forma:

u(k)? umax (3.17)
?u(k)? umin

As ações de controle futuras, no horizonte de controle Nu, dependem
das variações futuras ?u e das ações de controle aplicadas no instante



54

anterior u(k?1):?
????

u(k)
u(k + 1)

...
u(k + Nu ?1)

?
???? =

?
????

?u(k)
?u(k + 1)+ ?u(k)

...
?u(k + Nu ?1)+···+ ?u(k)

?
????+

?
????

u(k?1)
u(k?1)

...
u(k?1)

?
????

Reordenando a desigualdade (3.17) e escrevendo em forma matricial:

[
It
?It

]?????
?u(k)

?u(k + 1)
...

?u(k + Nu ?1)

?
?????

?
?????????????

umax1
umax2

...
umaxNu
?umin1
?umin2

...
?uminNu

?
?????????????
?

?
?????????????

1
1
...
1
?1
?1

...
?1

?
?????????????

u(k?1) (3.18)

It =

?
???????

1 0
... 0

1 1
... 0

...
...

...
...

1 1
... 1

?
???????

• Restrições na magnitude da variáveis de saída as predições ao longo
do horizonte de predição N não podem sobrepassar as restrições nas
quais deseja-se que a amplitude da saída se mantenha numa faixa onde
os limites correspondem limitações físicas do processo. Essa restrição
pode ser:

ymin ? yp ? ymax
ymin ? G?u + f ? ymax

Ou escritas da forma:

G?u ? ymax ?f (3.19)
?G?u ??ymin + f



55

É possível escrever na forma matricial:

[
G
?G

]?????
?u(k)

?u(k + 1)
...

?u(k + Nu ?1)

?
?????

?
?????????????

ymax1
ymax2

...
ymaxN
?ymin1
?ymin2

...
?yminN

?
?????????????
+

?
?????????????

?f(k + 1)
?f(k + 2)

...
?f(k + N)

f(k + 1)
f(k + 2)

...
f(k + N)

?
?????????????

(3.20)

Para trabalhar com restrições soft é necessário definir variáveis de
folga. O uso de este tipo de restrições pode evitar problemas de factibilidade
(quando não existe solução no problema de otimização que consiga satisfazer
as restrições duras). A inserção das variáveis de folga em um problema QP
pode ser realizada modificando a equação (3.13) de acordo com:

J =
1
2

?uT H?u + bT ?u + f0 + ?
T P? + ? T ? (3.21)

Sujeito : A?u ? B + ?
? ? 0

A constante de ponderação ? busca penalizar os valores grandes de ? .
Ou seja, é mantido em zero sempre que não exista violação de restrições e, é
fortemente penalizado quando existe uma violação, obrigando a ? a tomar un
valor pequeno o suficiente para evitar o problema de factibilidad. Essa técnica
permite inicialmente a violação das restrições e através da minimização da
variável de folga, ? . Informações adicionais sobre restrições soft podem ser
encontradas em (PRASATH; JORGENSEN, 2009).

Para efeitos de simulação, será empregado ao longo do trabalho a es-
trutura do algoritmo GPC, apresentada na figura 3.5. A estrutura se compõe
basicamente por dois blocos, o bloco do otimizador e o bloco do modelo. No
bloco do otimizador é calculada a ação de controle ótima, a partir da mini-
mização da função custo, considerando as restrições. No bloco do modelo é
calculada a evolução do sistema no futuro (resposta livre). Nos blocos P(z)
e Pq(z) descrevem-se a função de transferência do processo e a função de
transferência que relaciona o efeito da perturbação na saída respectivamente.



56

Assim, na equação de predição (3.2) se inclui o efeito da perturbação:

A(z?1)y(k) = B(z?1)z?d u(k?1)+ D(z?1)z?dqq(k?1)+
C(z?1)

?
e(z?1)

(3.22)

P =
B(z?1)
A(z?1)

Pq =
D(z?1)
A(z?1)

É importante ressaltar, o uso de compensação antecipativa na estru-
tura ao inserir Pq(z) no cálculo da resposta livre, melhorando o modelo de
predição.

Figura 3.5 – Estrutura de controle do GPC

Fonte: Elaborado pelo autor

GPC apresenta problemas em sistema com atrasos e com erros de mo-
delagem. Em trabalhos como (NORMEY-RICO; CAMACHO, 2008a) e (NORMEY-
RICO; CAMACHO, 2009), têm-se mostrado que quando se utilizam compen-
sadores de atraso de tempo (DTC) explicitamente na estrutura do GPC se
conseguem algumas vantagens sobre o GPC tradicional quando o propósito é
estabilidade e robustez em sistemas de controle de processos com atraso de



57

tempo. Por exemplo, quando se utiliza um preditor de Smith filtrado (FSP)
para calcular as predições até o tempo de atraso ao invés do preditor ótimo
inerente ao GPC, o controlador resultante é mais robusto e fácil de ajustar do
que a solução tradicional (ROCA et al., 2009). Na seguinte seção são abordados
os conceitos principales na utilização do algoritmo DTC-GPC e sua aplicação
em sistemas de controle de nível dos estoques.

3.5 GPC PARA SISTEMAS COM ATRASO DE TEMPO (DTC-GPC)

O algoritmo DTC-GPC busca as ações de controle ótimas minimizando
uma função custo do tipo (3.1). A predição da saída do sistema j passos à
frente até o instante k yp(k + j|k) é calculada usando o modelo incremental
do sistema, porém feita em duas partes. A primeira parte é o cálculo das pre-
dições até j + d usando a estrutura do FSP, a segunda parte é o cálculo das
predições para j + d + 1 até j + d + N2 utilizando o procedimento normal do
GPC.

Para o cálculo das predições até j + d tem-se:

yp(k + j|k) = S(z)u(k)+ Fr(z)y(k), j = 1···d (3.23)

onde Fr(z) é o parâmetro de ajuste e S(z) deve ser implementado com
uma função de transferência estável. No caso, os sistemas de estoque, são
modelados com um sistema integrador, dessa maneira, o filtro Fr(z) é definido
na equação(3.25).

S(z) = Gn(z)[1?Fr(z)z?d] (3.24)

Fr(z) =
( fb1z + fb0)
(z?? )2

(3.25)

Em (3.24) Gn(z) = z?1B(z?1)/A(z?1) é o modelo rápido do sistema,
ou seja, o modelo livre de atrasos de tempo.

Para dinâmicas do tipo integrador, como são as dinâmicas dos sistemas
de estoque: Gn(z) =

1
z?1 . A sintonia do filtro passa-baixas Fr(z) para satis-

fazer condições de operação frente a perturbações do tipo degrau é descrita na
equação (3.25), onde fb0 = (1?? )2d + 2(1?? ), fb1 = (1?? )2 ? fb0 e ? é
um parâmetro livre, ajustado utilizando especificações de robustez (SANTOS,
2011). O cálculo de S(z) visando garantir estabilidade interna do preditor, ou
seja, visando cancelar internamente ao modelo de predição o pólo em z?1 = 1
de Gn(z), se realiza usando as equações (3.26) e (3.27), de forma tal que que



58

S(z) não possua o polo em z?1 = 1.

S(z) =
z?d

(z?1)
[zd ?

( fb1z + fb0)
(z?? )2

] (3.26)

S(z) =
1

(z?? )2
z?d[zd+1 +(1?2? )zd +(1?? 2)zd?1 +···+(1?? 2)z + fbo]

(3.27)

3.5.1 Compensação antecipativa

A ação antecipada na compensação de perturbações mensuráveis apre-
senta resultados mais eficientes do que o controle realimentado. A principal
razão é que ela fornece uma ação de controle antes que a perturbação tenha
afetado a variável controlada. De fato, em algumas circunstâncias, é possível
rejeitar totalmente o efeito das perturbações de carga a partir da ação anteci-
pativa (GUZMAN; HAGGLUD; VISIOLI, 2012). Desse modo, o controlador inclui
os modelos das perturbações e usa também a previsão das perturbações fu-
turas, o que permite incluir o modelo da perturbação na equação de predição,
equação (3.2), fazendo o otimizador levar em conta o possível efeito no fu-
turo e calculando uma ação de controle para compensá-lo. Com relação ao
DTC-GPC operando com ação antecipativa, além da inclusão do modelo da
perturbação no cálculo das predições, deve-se projetar mais um filtro Sq(z)
no preditor que corresponde ao filtro de garantia de estabilidade na evolução
do comportamento do modelo da perturbação.Assim, o projeto do filtro Sq(z)
deve cancelar os modos instáveis da função de transferência que relaciona
a perturbação com a saída do processo Pq(z), a fim de garantir estabilidade
interna do preditor.

A equação (3.28) formula o cálculo de Sq(z), onde: Gnq(z) =
D(z)
A(z) é

o modelo rápido da função de transferência relativa à perturbação. Fqr(z) é
o filtro projetado para assegurar uma correta rejeição das perturbações. O
parâmetro dq é o atraso de tempo do modelo Pq(z).

Sq(z) = Gnq(z)[1?Fqr(z)z?dq] (3.28)

Deve ser comentado que no caso geral, esta solução apenas funciona
se os pólos instáveis de Pq(z) são também pólos instáveis de P(z) (RODRíGUEZ
et al., 2016) o que se verifica no modelo do sistema de controle de estoque.

Na figura 3.6 apresenta-se o digrama de blocos que representa a estru-
tura de controle preditivo DTC-GPC incluindo a ação antecipativa. A estru-



59

Figura 3.6 – Estrutura do DTC-GPC com ação antecipativa

Fonte: Elaborado pelo autor

tura do algoritmo DTC-GPC se compõe por os três blocos principales. Como
no GPC, observam-se o bloco do otimizador e o bloco do modelo e soma-se o
bloco do preditor filtrado. No bloco do preditor filtrado é feita a compensação
dos atrasos. Os blocos Fr(z), S(z) e Sq(z) descrevem-se os filtros de predição
e estabilidade para o modelo da planta e da perturbação respectivamente.

3.6 EXTENSÃO PARA O CASO MULTIVÁRIAVEL

Para trabalhar com sistemas MIMO, deve ser considerada a expresão
do processo em função da matriz de transferência P(z?1), onde cada elemento
pi j(z?1) é uma função de transferência SISO sendo y(k) o vetor de variáveis
controladas e u(k) o vetor de variáveis manipuladas.

y(k) = P(z?1)u(k) (3.29)

Ou escrito na forma:
P(z?1) = D(z?1)G(z?1) (3.30)

Onde, D(z?1) é uma matriz diagonal com os coeficientes de atraso de tempo
z?di , i é o menor atraso de tempo na linha i de P(z?1).

Pi j(z
?1) =

z?1Bi j(z?1)
Ai j(z?1)

z?di j



60

G(z?1) = A?1(z?1)B(z?1)z?1. A(z?1) é uma matriz diagonal que con-
tem os denominadores comuns de todos os denominadores das Pi j da linha i
e B(z?1) é a matriz de numeradores resultantes após a realização do cálculo
do denominador comum.

A função custo a otimizar visando o cálculo das ações de controle
ótimas é:

J(k) =
Nn

?
i=1

?i

Ni2

?
j=Ni1

[ypi(k + j |k)?wi(k + j |k)]2 +
Nm

?
i=1

?i

Nu j

?
j=1

[?ui(k + j?1 |k)]2

(3.31)
onde: Nn é o número de variáveis de saída, Ni1 e Ni2 são os horizontes de
predição definidos para cada variável controlada ypi , Nm é o número de vari-
áveis manipuladas e Nu j é o horizonte de controle definido para cada variável
manipulada ?ui. ?i é a matriz diagonal que pondera o erro para cada vari-
ável controlada. ?i contém os valores de ponderação do controle para cada
variável manipulada. As predições ypi (k + j|k) são obtidas a partir do modelo
definido na equação 3.32, calculadas iterativamente por meio de Nn equações
diofantinas, para o horizonte definido.

A?i(z
?1)ypi (k + j|k) = z

?di Bi(z
?1)u(k + j?1)+

1
?

ei(k + j) (3.32)

Do mesmo modo que no caso monovariável, assume-se ei(k + j|k)
como ruído branco. Bi = [Bi1,Bi2,··· ,Bim]. Assim, a identidade polinomial
que permite o cálculo das predições é:

1 = ?Ai(z
?1)Ei j(z

?1)+ Fi j(z
?1)z? j (3.33)

As predições ótimas são calculadas do mesmo modo que no caso
SISO. Desse modo, o processo aqui apresentado permite uma interpretação
mais simples dos resultados. Como foi salientado no caso SISO, na equação
(3.23), estas predições, a partir de k = Ni1 até k = Ni2 , são usadas na mini-
mização de J, o horizonte mínimo normalmente é escolhido igual ao atraso
mínimo, mais um, isto é, Ni1 = di + 1. Aqui o horizonte máximo de cada
saída será considerado como o Ni2 = di + Ni. Como no caso SISO, as pre-
dições podem ser calculados separadamente, usando a estrutura explícita de
compensação de atraso de tempo, a partir de j = 1 até j = di e de j = di + 1
a j = di + Ni para cada variável controlada.



61

?
????

yi(k + di + 1|k)
yi(k + di + 2|k)

...
yi(k + di + Ni|k)

?
???? = [Hi1 Hi2 ··· Him]

?
????

u f 1
u f 2

...
u f m

?
???? (3.34)

[
Hpi1 Hpi2 ··· Hpim

]
?
????

up1
up2

...
upm

?
????+

?
????

S1
S2
...

SNi

?
????
?
????

yi(k + di|k)
yi(k + di ?1|k)

...
yi(k + di ?nai|k)

?
????

Aqui as ações de controle futuras são:

u f j =
[
?u j(k) ?u j(k + 1) ··· ?u j(k?Nu j )

]T
As ações de controle passadas são:

up j =
[
?u j(k?1) ?u j(k?2) ··· ?u j(k?nbi j)

]T
A matriz Si tem dimensões 1×nai , Hi j tem dimensões Nvi xNu j e Hp j

tem dimensões Nvixnbi j . Este procedimento é aplicado a todas as variáveis
de saída. Assim, a expressão vetorial é:

Y = Hu f + Hpup + Syd (3.35)

Na equação 3.35:

Y =
[
y1 y2 ··· yn

]T
u f =

[
u f 1 u f 2 ··· u f m

]T
up =

[
up1 up2 ··· upm

]T
yd
[
yd1 yd2 ··· ydn

]T
Os elementos de H, Hp e S são números reais. Por causa da inde-

pendência entre as predições com respeito a cada variável, S é uma matriz
bloco diagonal, de dimensões Ni ×nai.



62

Usando as mesmas ideias do caso SISO, escreve-se o problema como
a soma de duas partes:

Y = Hu f + fr (3.36)

fr = Hpup + Syd contém os termos passados, sendo a matriz com a
resposta livre dos sistemas, e Hu f é a resposta forçada. Aplicando o mesmo
procedimento que no caso SISO a partir da equação (3.36), resolvendo um
problema QP com restrições as predições podem ser calculadas em duas
etapas, usando o PSF MIMO para as predições até o tempo morto. Desta
forma se obtém um controlador MIMO-DTC-GPC (NORMEY-RICO; CAMA-
CHO, 2007).

No controlador MIMO-DTC-GPC o filtro Fr(z) é um parâmetro de
ajuste livre. Note-se que Fr(z) é uma matriz diagonal em função das variáveis
controladas do sistema com seus filtros Fri sintonizados seguindo as idéias
de melhorar a robustez ou para lidar com os processos instáveis, assim, o
MIMO-DTC-GPC tem duas vantagens importantes: (1) o controlador prin-
cipal é projetado com considerações de custo ótimas com a possibilidade de
considerar as limitações operacionais que permitem um melhor desempenho.
(2) A estrutura e ajuste do preditor permite que um controlador mais robusto
possa ser obtido. Exemplos de implementação em sistemas MIMO podem
ser encontrados em (NORMEY-RICO; CAMACHO, 2007).

3.7 COMENTÁRIOS FINAIS DO CAPÍTULO

Neste capítulo foi realizada uma revisão bibliográfica sobre controle
preditivo. Foram apresentados o controlador GPC e a estratégia de controle
DTC-GPC que visam tratar os problema de atraso de tempo e incertezas na
modelagem. No próximo capítulo serão apresentados os resultados das si-
mulações feitas aplicando os conceitos aqui explicados para uma cadeia de
suprimento simples. Também serão introduzidos conceitos de coordenação
centralizada e descentralizada na gestão da CS.



63

4 ESTRATÉGIAS DE CONTROLE

Nos capítulos anteriores foram discutidos assuntos da modelagem dos
processos de cadeias de suprimento, técnicas de controle preditivo GPC e
modelos utilizados para predição, assim como o aproveitamento da estrutura
explícita de compensação de tempo morto no preditor. Este capítulo analisa
o uso de controle preditivo com compensação explícita do atraso no controle
de estoque em cadeias de suprimento. Serão apresentados os resultados de
simulação obtidos nos ensaios da aplicação do GPC para o controle de esto-
ques. A teoria para modelagem apresentada no capítulo 2 foi utilizada para
a simulação dos processos. Os mesmos modelos são usados para o cálculo
das predições. Foram realizados ensaios primeiramente só para o caso mo-
novariável e posteriormente com o sistema integrado incluindo um sistema
multivariável de três entradas e três saídas. Primeiramente são apresentados
os ensaios para o caso com comportamento nominal e posteriormente com
erros na modelagem, assim como os ensaios para coordenações de gestão
centralizada e descentralizada.

4.1 SISTEMA CLÁSSICO DE ESTOQUE

Nesta seção serão apresentados os resultados obtidos nos ensaios de
controle de nível do estoque em uma cadeia de suprimentos de um só nó,
que tem como objetivo manter o nível de estoque no valor desejado. São
apresentados resultados com o controlador GPC para o caso nominal, sistema
sem erros de modelagem e com conhecimento a priori da demanda futura.
Também são mostrados os resultados quando o sistema opera sob erros de
modelagem e erros no comportamento da demanda.

A figura 4.1 ilustra as variáveis de controle e representa o sistema de
estoque por meio de analogia de fluidos. O sistema de controle de estoque
pode se transformar em um sistema de controle de nível. Dessa maneira, é
possível resolver o problema com uma malha de controle realimentado. LT:
representa o transmissor de nível que indica as quantidades de produto em
estoque a cada período de amostragem. LIC: representa o controlador e in-
dicador do nível, aqui o algoritmo resolvera a cada instante de amostragem
e com a informação atualizada o problema de controle, que define as quanti-
dade de produto que devem se repor no estoque para manter o setpoint.



64

Figura 4.1 – Analogia de fluidos para um sistema clássico de estoque

Fonte: (SCHWARTZ; RIVERA, 2010)

4.1.1 Resultados do GPC no caso nominal

O primeiro ensaio de controle foi realizado utilizando a estratégia de
controle GPC. O sistema de CS possui a dinâmica a seguir: os pedidos feitos
à fábrica u(k), têm um tempo de produção e entrega de 5 dias, o que sig-
nifica um atraso du. Após serem entregues, são estocados no depósito, onde
são armazenados no estoque y(k). Finalmente os produtos saem do depósito
1 dia depois de serem solicitados, representando um atraso dq nas quanti-
dades demandadas q(k). O ajuste dos parâmetros do controlador é apresen-
tado na tabela 4.1 e na tabela 4.2 são apresentadas as restrições do sistema.
O problema foi simulado utilizando uma referência fixa, visando manter 100
unidades de produto no estoque, w(k) = 100.

É usado um horizonte de predição de 30 dias, com o qual consegue-
se capturar a dinâmica do sistema e sua evolução nos instantes futuros. O
horizonte de controle foi escolhido com 10 dias, dessa maneira o controlador
tem tempo suficiente para organizar suas decisões de entrega de uma maneira
mais distribuida. Para o fator de ponderação da ação de controle se escolheu
o valor de 1, o que permite estudar o comportamento da variável controlada
com uma ponderação baixa.



65

Tabela 4.1 – Parâmetros de ajuste do controlador GPC

Parâmetro Valor
N 30
Nu 10
? 1

Tabela 4.2 – Restrições de operação SISO

Parâmetro Valor
ymin|ymax [0|200]
umin|umax [0|100]

São apresentados na figura 4.2 a resposta da variável controlada (quan-
tidade de produto em estoque), as ações da variável manipulada (quantidades
de pedidos) e o comportamento da perturbação (demanda). Como é possível
apreciar, as quantidades de produto em estoque são mantidas nas proximi-
dades do valor de referência e são rejeitadas as perturbações, ou seja, são
atendidas as quantidades demandadas.

Figura 4.2 – Resultados do controlador GPC desconsiderando erros na mode-
lagem e na previsão de demanda

Fonte: Elaborado pelo autor



66

4.1.2 Resultados do GPC sob incertezas

O segundo ensaio de controle foi realizado para o mesmo sistema de
CS. Da mesma maneira, deseja-se manter 100 unidades de produto em es-
toque. Foi utilizado o controlador GPC sob o mesmo cenário de simulação
e as mesmas configurações de ajuste do controlador mencionadas anterior-
mente. Foi inserido um erro de modelagem de 2 dias no período de fabri-
cação e disponibilidade de produto no estoque. Porém diferenças entre o
modelo escolhido para fazer predições e o comportamento do processo real
foram inseridas.

Figura 4.3 – Resultados do controlador GPC considerando erros na modela-
gem e na previsão de demanda

Fonte: Elaborado pelo autor

Ao realizar as simulações neste caso, a otimização da função custo
no algoritmo, não consegue achar o mínimo ótimo que respeite as restrições,
gerando um problema de factibilidade. Para efeitos de ilustração, foi realizada
uma simulação incluindo uma variável de folga ? para relaxar a restrição nos
valores máximo e mínimo da saída. Pode-se observar na figura 4.3 como para
ao mesmo ajuste do controlador GPC os erros inseridos deterioram o desem-
penho do controlador, apesar de inicialmente o controlador tentar manter o
nível de estoque programado. Esses resultados evidenciam o que foi anteri-
ormente mencionado no capítulo 3: o algoritmo GPC, apresenta problemas
quando controla um processo com tempo morto e incertezas na modelagem,



67

no caso, características típicas do sistema de CS. Além disso, mesmo com o
ajuste da ponderação do controle, não é possível obter um ajuste satisfatório
para este caso. Isto confirma os resultados mostrados em (NORMEY-RICO; CA-
MACHO, 2007) sobre a sintonia do GPC para processos com atraso.

4.1.3 Resultados do DTC-GPC sob incertezas

Com base no exposto anteriormente, é utilizado o algortimo DTC-
GPC sob o mesmo cenário de simulação e os mesmos ajustes de parâmetros
do controlador GPC. É adicionada a sintonia do parâmetro ? . Este parâmetro
é escolhido para projetar os filtros dados pelas equações (3.23), (3.24) e (3.25)
para resolver os problemas de estabilidade interna do preditor e fazem mais
robusto o controlador frente a atrasos de tempo elevados e com incertezas na
modelagem.

Tabela 4.3 – Parâmetros de ajuste do controlador DTC-GPC

Parâmetro Valor
N 30
Nu 10
? 1
? 0,95

A simulação do algoritmo DTC-GPC é feita com filtro ajustado de
acordo com a tabela 4.3. Assim, a figura 4.4 exibe os resultados da simulação
para o controlador DTC-GPC. Com os resultados da simulação, evidencia-se
como é mantida estabilidade das vaiáveis em comparação com os resultados
obtidos com o GPC tradicional; ainda na simulação do algoritmo DTC-GPC
não foi inserida a variável de folga ? , devido a que não teve presencia de pro-
blemas de factibilidade. A resposta mostra como a metodologia de controle
preditivo com compensação de tempo morto permite uma melhor solução de
problemas em CS que operam sob incertezas na modelagem e na previsão
de demanda. Não obstante, o comportamento da variável controlada (quanti-
dades de produto em estoque) apresenta oscilações, assim é possível melhorar
o desempenho do controlador estudando uma melhor sintonia dos seus parâ-
metros.



68

Figura 4.4 – Resultados do controlador DTC-GPC considerando erros na mo-
delagem e na previsão de demanda

Fonte: Elaborado pelo autor

4.2 EXEMPLO DE CADEIA DE SUPRIMENTOS

Nesta seção serão apresentados os resultados obtidos nos ensaios de
controle de nível de estoque em uma cadeia de suprimentos de três camadas.
São definidos e testados os tipos de coordenação na cadeia de suprimentos
com o fim de comparar desempenhos.

4.2.1 Estruturas de coordenação das cadeias de suprimento

Para coordenação de uma CS deve-se determinar conjuntamente uma
estrutura que estabeleça os direitos de decisão, isto é quando produzir e quanto
produzir. Essas estruturas de coordenação podem ser de dois tipos: (1) estru-
tura centralizada ou (2) estrutura descentralizada.

• Estrutura de Controle Centralizada ou Global: nesta estrutura é pro-
jetado um só controlador para otimizar as quantidades a serem forneci-
das a cada dependência da CS, (BOSE; PEKNY, 2000). As decisões são
tomadas a partir de dados conhecidos do sistema como uma totalidade
(introduzindo a informação global do sistema) buscando atingir um ob-
jetivo comum (FU; AGHEZZAF; KEYSER, 2014).



69

• Estrutura de Controle Descentralizada ou Local: nesta estrutura é
estabelecido um controlador para cada dependência. Os mercados in-
dividuais realizam pedidos para cada unidade de fornecimento basea-
dos no conhecimento e necessidades locais. Cada dependência indi-
vidualmente não é consciente das limitações e capacidades das outras
unidades incluídas na rede, como também desconhece demandas que
afetam outros elos do sistema da CS (BOSE; PEKNY, 2000).

4.2.2 Formulação do problema

Nesta seção é considerada uma CS para um só tipo de produto com
somente um nó em cada camada, mas o método pode ser estendido para um
caso de múltiplos produtos e múltiplos nós. A cadeia de suprimentos tem
o seguinte comportamento: a planta tem um tempo de produção de 5 dias
e demora 2 dias para transportar o produto semi-acabado após revisões de
padrão de qualidade, até a área de embalagem. Na área de embalagem o
produto pode demorar até 2 dias dentro do processo de acabamento final e
leva-se 1 dia para entregá-lo no depósito. Finalmente, no depósito o produto
leva 1 dia no processo de padronização e inclusão no estoque. Os pedidos
demoram 1 dia para serem encaminhados após recebidos.

A matriz de transferência que representa as dinâmicas básicas caracte-
rísticas entre os fluxos de informação e material da CS está dada na equação
(4.1). As equações escrevem o modelo de funções de transferência discreta
que determinam as quantidades de produto semi-acabado, y1(k), de produto
embalado, y2(k), e de produto em depósito, y3(k), como função das variá-
veis manipuladas (pedidos), u1(k), u2(k) e u3(k), e a perturbações no sistema
(efeito da demanda), q(k). As decisões de pedidos e entregas são feitas em
iguais períodos de tempo. Escolheu-se um período Ts = 1 dia. Considera-se,
ainda, que a informação de pedidos entre os elos do processo de produção é
feita instantaneamente.

?
?y1(k)y2(k)

y3(k)

?
? =

?
??

z?1
1?z?1 z

?d11 ?z?1
1?z?1 z

?d12 0

0 z
?1

1?z?1 z
?d22 ?z?1

1?z1 z
?d23

0 0 z
?1

1?z?1 z
?d33

?
??
?
?u1(k)u2(k)

u3(k)

?
? (4.1)

+

?
? 00
?z?1
1?z?1 z

?dq

?
?[q(k)]



70

4.2.3 Coordenação centralizada

Os resultados aqui apresentados foram publicados nos anais do "V
Congresso Brasileiro de Engenharia de Produção (CONBREPRO 2015)"re-
alizado em Ponta Grossa- Parana . A seguir na figura 4.5, propõe-se uma
estratégia de controle centralizada a partir dos modelos dinâmicos apresen-
tados na matriz de transferência, equação (4.1). É projetado um controlador
GPC multivariável que usa uma coordenação global para tomar decisões em
cada nó da CS. O controlador inclui o modelo da perturbação e usa também
a previsão da demanda futura, estimada segundo conhecimentos na tendência
do mercado.

Figura 4.5 – Analogia de fluidos na estratégia de controle centralizado.

Fonte: Elaborado pelo autor

4.2.3.1 Resultados do controlador GPC no caso nominal

A seguir serão apresentados os resultados em simulação com o con-
trolador GPC utilizando uma abordagem centralizada a partir dos modelos
dinâmicos citados na equação (4.1). Na figura 4.6 mostram-se as variáveis de
processo (quantidades de pedidos gerados) e as variáveis de controle (quanti-
dade de produto em estoque) respectivamente. O controlador inclui os mode-



71

los da perturbação e usa também a previsão da demanda futura. Ainda a figura
4.6 mostra os perfis de demanda utilizados como perturbação nas simulações.
Para o caso foram desconsiderados erros na modelagem e no comportamento
da demanda.

Figura 4.6 – Resultados de simulação GPC centralizado desconsiderando er-
ros na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor

O ajuste de parâmetros dos controladores é apresentado na tabela 4.5
e na tabela 4.4 são definidas as restrições inseridas nas variáveis do sistema
no problema de otimização do controlador. Os horizontes de predição foram
pensados para olhar até três meses para frente. Escolheu-se 90 dias para o nó
de fábrica, 60 dias para o nó de embalagem e 30 dias para o nó correspon-
dente a produto terminado em depósito. Todos os horizontes excedem o total
dos tempos mortos ao longo da CS. Para o primeiro nó, abrange-se uma maior
quantidade de dias, exigido pela centralização das decisões, a fim de execu-
tar antecipações necessárias. A ponderação do esforço de controle, ? j , foi
definida para fixar um controle mais conservador e evitar mudanças violentas
nos estoques, reduzindo o efeito chicote (bullwhip effect) na CS. Considera-
se 600 dias de operação para a cadeia de suprimentos. Nos primeiros 150 dias
são inicializados os nós da CS para se manter em um nível fixo de estoque
(setpoint), wi(k) = 100 unidades de produto. Para o caso, foram desconside-
rados erros na modelagem e no comportamento da demanda.



72

Tabela 4.4 – Restrições de operação MIMO

Parâmetro Valor
yimin |yimax [0|200]
u jmin |u jmax [0|100]

Tabela 4.5 – Parâmetros de ajuste do controlador GPC centralizado

Parâmetro Valor
N [90 | 60 | 30]
Nu [10 | 10 | 10]
?i [1 | 1 | 1]
? j [300 | 300 | 100]

Tabela 4.6 – Incertezas inseridas na modelagem

Atraso Modelo Processo
d11 5 7
d12 2 2
d22 2 3
d23 1 1
d33 1 2
d3q 1 2

4.2.3.2 Resultados do controlador GPC sob incertezas

A seguir serão apresentados os resultados em simulação com o con-
trolador GPC. Na figura 4.7, são apresentados os resultados de simulação
da cadeia de suprimentos operando sob incertezas na modelagem e erros na
previsão da demanda. As incertezas de modelagem foram inseridas nos atra-
sos, levando 2 dias a mais no período de produção, 1 dia a mais dentro do
processo de acabado final na área de embalagem e mais 1 dia no processo
de padronização e inclusão no estoque do depósito, simulando demoras no
processo estabelecido nos tempos de entrega definidos no modelo padrão de
operação na CS. Finalmente, foi inserido um erro na previsão da demanda
futura, tornando mais realista o comportamento do mercado na CS.

Na tabela 4.6, são resumidos os atrasos do modelo e os atrasos do
processo empregados nas simulações, que representam os erros na modela-



73

gem. Da mesma maneira que no ensaio anterior são empregados os mesmos
parâmetros de sintonia no controlador apontados nas tabelas 4.5 e 4.4.

Figura 4.7 – Resultados de simulação GPC centralizado considerando erros
na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor

Do mesmo modo que no ensaio monovariável o controlador GPC perde
estabilidade ao serem inseridos erros, degenerando o desempenho da CS, ape-
sar de inicialmente o controlador tentar manter os níveis de estoque. Para
efeitos de apresentação trabalhou-se com restrições suaves, utilizando a vari-
ável de folga ? e modificando a função custo.

4.2.3.3 Resultados do controlador DTC-GPC sob incertezas

Visando corrigir e melhorar os problemas de estabilidade, se aplica
na CS o algoritmo DTC-GPC utilizando o mesmo cenário de simulação e
as mesmas configurações de ajuste do controlador de acordo com a tabela
4.7. Os ?i usados nos filtros de estabilidade buscam evitar as oscilações da
resposta do sistema. A figura 4.8 apresenta o comportamento das variáveis.



74

Tabela 4.7 – Parâmetros de ajuste do controlador DTC-GPC centralizado

Parâmetro Valor
N [90 | 60 | 30]
Nu [10 |10 | 10]
? [1 | 1 | 1]
? [300 | 300 | 100]
? [0,96 | 0,96 | 0,96]

Figura 4.8 – Resultados de simulação DTC-GPC centralizado considerando
erros na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor

Como se observa na figura, o sistema controlado com o DTC-GPC
permite manter os estoques próximo do nível desejado.

4.2.4 Coordenação descentralizada

Foi desenvolvido para o mesmo caso um projeto de controle na abor-
dagem descentralizada, projetando um controlador GPC monovariável para
coordenar localmente o estoque de produto semi-acabado y1(k) o qual devido
aos tempos de fabricação apresenta a dinâmica mais lenta. A pertubação é
devida aos pedidos que vêm de u2(k), quantidades requeridas para embala-



75

gem. Para manter o nível de y2(k) e o nível de produto em depósito y3(k) é
utilizado um controlador GPC multivariável, para duas entradas - duas saídas,
como é apresentado na figura 4.9. Do mesma forma que no projeto centrali-
zado, inclui-se o modelo da perturbação, e emprega-se também a previsão da
demanda futura, estimada segundo conhecimentos na tendência do mercado.

Figura 4.9 – Analogia de fluidos na estratégia de controle descentralizado.

Fonte: Elaborado pelo autor

4.2.4.1 Resultados do controlador GPC no caso nominal

A seguir serão apresentados os resultados na abordagem descentrali-
zada dos algoritmos GPC simulados em condições ideais. A figura 4.10 apre-
senta como os níveis de estoque são mantidos e mostram-se as quantidades
de pedidos feitos. Foi empregado o mesmo cenário de simulação das provas
feitas na abordagem centralizada, usando os mesmos perfis de demanda e
incluindo os mesmos valores nas restrições conforme a tabela 4.4.

O controlador foi ajustado segundo a tabela 4.8. Os horizontes de
predição foram escolhidos do modo que excedem o total de atrasos de tempo
ao longo da CS: 30 dias para o nó de fábrica, 60 dias para o nó de embalagem
e 30 dias para o nó correspondente a produto terminado em depósito. Neste
caso, como há dois controladores coordenando a gestão, as variáveis do nó de



76

fábrica não precisaram usar um horizonte de predição maior. A ponderação
do esforço de controle, ? j , foi diferente da usada no ensaio centralizado. O
ajuste foi definido para que os pedidos do nó de fábrica sejam entregues o
mais rápido possível. Para os nós de produto em embalagem e em depósito,
foram definidas ações de controle mais lentas evitando mudanças violentas
nas entregas de produto aguas abaixo, reduzindo o efeito chicote (bullwhip
effect) na CS e evitando zerar o estoque de produto em fábrica.

Tabela 4.8 – Parâmetros de ajuste do controlador GPC descentralizado

Parâmetro Valor
N [30 | 60 | 30]
Nu [10 | 10 | 10]
?i [1 | 1 | 1]
? j [1 | 300 | 100]

Figura 4.10 – Resultados de simulação GPC descentralizado desconsiderando
erros na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor



77

4.2.4.2 Resultados do controlador GPC sob incertezas

Foi realizado o teste do controlador GPC na presença de erros na mo-
delagem e incertezas na previsão de demanda. Para o ensaio, foram inseridos
os mesmos erros de modelagem do caso centralizado (ver tabela 4.6). Na
figura 4.11, são apresentados os resultados obtidos na simulação empregando
os mesmos parâmetros de sintonia no controlador apontados na tabela 4.8.

Figura 4.11 – Resultados de simulação GPC descentralizado considerando
erros na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor

Na figura 4.11 é possível acompanhar como o controlador consegue
manter a estabilidade sempre que o atraso não seja elevado, apesar dos er-
ros inseridos. Assim, o controlador GPC projetado para manter os níveis de
estoque na área de embalagem e no depósito apresenta um comportamnento
estável. Por sua vez, o controlador projetado para manter o nível de estoque
de produto semi-acabado não consegue manter estabilidade frente aos erros e
incertezas na presença de atraso elevado.

4.2.4.3 Resultados do controlador DTC-GPC sob incertezas

Com o objetivo de melhorar estabilidade e garantir a correta opera-
ção da CS frente a erros e incertezas, emprega-se o algoritmo DTC-GPC uti-
lizando o mesmo cenário de simulação e as mesmas configurações de ajuste



78

do controlador de acordo com a tabela 4.9. A figura 4.12 apresentam o resul-
tados da simulação.

Tabela 4.9 – Parâmetros de ajuste do controlador DTC-GPC descentralizado

Parâmetro Valor
N [30 | 60 | 30]
Nu [10 |10 | 10]
? [1 | 1 | 1]
? [300 | 100 | 1]
? [0.94 | 0.94 | 0.94]

Figura 4.12 – Resultados de simulação DTC-GPC descentralizado con-
siderando erros na modelagem e na previsão de demanda

Fonte: Elaborado pelo autor

Há relativamente poucos trabalhos comparando estratégias de coorde-
nação global e estratégias de coordenação local em planejamento de produ-
ção (SAHARIDIS; DALLERY; KARAESMEN, 2006). Em geral, uma boa estratégia
de coordenação deve trazer benefícios para toda a cadeia de suprimentos.
Na prática, no caso de coordenação descentralizada, tende-se a otimizar só
uma unidade de produção sujeita a certas limitações (por exemplo, objetivos
próprios), com pouca atenção para outros elos da cadeia de abastecimento.
Os resultados anteriormente apresentados mostram a diferença entre otimiza-



79

ção global e local em termos de comportamento dinâmico e desempenho de
las variáveis controladas e manipuladas.

É claro que a coordenação centralizada entrega volumes menores de
produto do que o caso de coordenação descentralizada. A coordenação des-
centralizada induz a fábrica a realizar entregas maiores com menor frequên-
cia, assim são geradas oscilações nos níveis de estoque. Os exemplos de
estudo mostraram, que é melhor implementar uma abordagem global para o
gerenciamento de uma cadeia de abastecimento, porque o sistema é capaz
de coordenar melhor seus recursos. Isso ocorre porque o coordenador cen-
tral consegue "ver"todos os possíveis conflitos e restrições no sistema e, em
seguida, gerar ações de controle ótimas.

4.3 COMENTÁRIOS FINAIS DO CAPÍTULO

Neste capítulo, foram apresentados os resultados dos ensaios de con-
trole realizados em um primeiro momento para o caso monovariável operando
em condições ideais e posteriormente com erros na modelagem e na pre-
visão da demanda. No caso de CS integrada (sistema multivariável), contro-
ladores preditivos com compensação explícita de tempo morto considerando
estratégias de coordenação centralizada e descentralizada foram propostos
para resolver problemas de controle de estoques em uma CS. Os contro-
ladores levam em conta restrições a fim de calcular as ações de controle
ótimas, considerando as limitações físicas da CS proposta. Quando os sis-
temas são simulados considerando erros na modelagem e na estimativa da
demanda, mostra-se que a estrutura de compensação de tempo morto explícita
permite manter estabilidade e um bom desempenho dos controladores, o que
não acontece com o GPC em sua estrutura convencional. Os resultados da
simulação em geral apresentam um bom seguimento da trajetória de refe-
rência (níveis de estoque programados) e uma boa rejeição de perturbações
(demanda do mercado). No próximo capítulo serão apresentados os resulta-
dos da aplicação dos algoritmos GPC na gestão de CS em estudos de caso na
área de petróleo, gás e biocombustíveis.



80



81

5 ESTUDOS DE CASO

No capítulo anterior foram apresentados os resultados obtidos com os
controladores GPC e DTC-GPC no controle de estoque num sistema simples
de CS. No presente capítulo serão apresentados os resultados de simulação
para os casos de estudo em petróleo, gás e biocombustíveis.

5.1 ESTUDO EM PETRÓLEO E GÁS

A transformação do petróleo bruto em produtos essenciais para o dia
a dia de toda a população é o resultado da soma de muitos esforços para aten-
der à crescente demanda por derivados no Brasil. Parques de refino produzem
mais de dois milhões, por dia, de barris de derivados, lubrificantes, entre ou-
tras substâncias que servem de matéria prima para diversos outros produtos
(PETROBRAS, 2014). O desafio é obter produtos de qualidade, os quais satisfa-
çam as necessidade dos clientes no que diz respeito ao cumprimento de políti-
cas ambientais e padrões de qualidade dos produtos, sem perder o foco da or-
ganização: obter lucros (maximizando a produção, minimizando custos). As
refinarias manipulam uma cadeia de suprimentos que implicam entre outros:
compra e transporte de matérias primas, operações de refino, armazenamento
e distribuição dos produtos finais. A natureza dessa cadeia é tal, que seu
estudo econômico é muito complexo e depende de muitas variáveis, como:
preços do cru, preço dos produtos e custos operacionais. Nesta seção, a apli-
cação de controladores GPC e DTC-GPC no controle dos estoques de cru e
produtos finais em uma refinaria é proposto, descreve-se o esquema de refino
e define-se o sistema de operação da cadeia de suprimento.

5.1.1 Sistema de Refino

O petróleo tal como é extraído, não tem aplicação prática, por isso é
necessário separá-lo em diferentes frações que representam utilidade. Este
processo é realizado nas refinarias de petróleo. O conjunto de operações rea-
lizadas nas refinarias visando obter produtos é chamado de processo de refino,
sendo seu principal objetivo obter do cru a maior quantidade possível de pro-
dutos. O processo de refino começa com a destilação, o fracionamento do cru
em grupos de hidrocarbonetos separados. Os produtos obtidos encontram-se
diretamente relacionados com as características do cru processado. A maior
parte dos produtos da destilação são convertidos posteriormente em produtos



82

mais utilizáveis, modificando o tamanho e estrutura das moléculas dos hidro-
carbonetos em processos de craqueamento e reforma. Estes produtos são
submetidos a vários tratamentos e processos de separação como: extração,
hidrotratamento e adoçamento para eliminar componentes indesejáveis e me-
lhorar a qualidade dos produtos (VERRUSCHI et al., 2009).

5.1.2 Formulação do problema

Este estudo centra-se em manter o nível de cru de forma que consiga-
se suprir a demanda da refinaria e garantir os níveis dos produtos finais:
diesel, gasolina, nafta, gás liquefeito de petróleo (GLP) e querosene de avi-
ação. Para isso é definida uma estrutura de controle descentralizada na qual:
são projetados dois controladores. O primeiro controlador é projetado para
manter o nível de cru e o segundo controlador é projetado para manter os
níveis de estoque nos produtos finais. No sistema estudado assume-se que a
informação requisitada (níveis de estoque, volumes demandados e entregues)
é comunicada instantaneamente. Além disso, as decisões no sistema de con-
trole são feitas nos mesmos períodos de tempo, dias neste caso de estudo.

Duas camadas são utilizadas no problema, como mostrado na figura
5.1. A camada superior é resolvida por um algoritmo LP o qual determina
os setpoints ideais dos produtos finais. Na simulação é executado a cada
30 dias. Incluiu-se a solução de um problema LP devido a que abordagens
tradicionalistas para o planejamento da operação fazem uso de modelos de
programação linear, gerando um plano viável em um horizonte diário, sema-
nal, mensal ou anual (SAUL, 2003). Esse processo, apesar de exigir tempo
e esforço do programador, gera uma solução viável, que é economicamente
atrativa, melhorando a operação da planta (NEIRO; PINTO, 2004). A indústria
de petróleo tem incorporado o uso de aplicações computacionais baseadas em
LP, visto que essas aplicações permitem obter informação que ajuda na toma
de decisões na CS.

Na camada inferior, um controlador GPC é utilizado para manter o
nível de estoque de cru. O controlador é chamado de controlador GPC MISO,
isto porque o sistema tem duas entradas ou variáveis manipuladas (supri-
mento do cru tipo A e suprimento do cru tipo B) e uma saída o variável contro-
lada (nível do cru em estoque). Escolheu-se ese controlador porque o modelo
de suprimento do cru no estoque das refinarias é bem conhecido e fácil de
estimar, e como mostrado no capítulo 4, o algoritmo GPC consegue bons re-
sultados no controle de estoques sob modelos sem incertezas. Para manter os



83

níveis dos estoques dos produtos finais é utilizado um controlador DTC-GPC
multivariável, chamado de controlador DTC-GPC MIMO com 5 variáveis
de entrada ou manipuladas (suprimento de diesel, suprimento de gasolina,
suprimento de nafta, suprimento de GLP e suprimento de querosene) e 5 va-
riáveis de saída ou controladas (níveis dos produtos em estoque). Embora
sejam produtos independentes simplificou-se em um controlador só o con-
trole dos estoques respectivamente e escolheu-se o algoritmo DTC-GPC para
contornar possíveis erros nas modelagens por consequência de problemas o
atrasos adicionais no processo de refino e produção dos derivados.

As variáveis que aparecem na figura 5.1 e seus significados no ambi-
ente da cadeia de suprimentos estão listadas nas tabelas 5.1 e 5.2.

Figura 5.1 – Esquema de controle descentralizado e mapeamento de variáveis
do sistema de CS

Fonte: Elaborado pelo autor

Na camada superior, o problema de programação linear resolve a função
custo da equação (5.1). Esta função é definida para maximizar os lucros no
problema de LP, sujeitos a restrições de produção e operação, dadas pelas
equações (5.2) e (5.3).



84

Tabela 5.1 – Mapeamento de variáveis no controlador MISO

Variável de processo Informação na CS
Saída y1 Quantidade de cru no estoque

Entrada u1 Quantidade de cru tipo A entregue
Entrada u2 Quantidade de cru tipo B entregue

Perturbação q1 Quantidade de cru demandado
Setpoints w1 Nível de cru programado

Tabela 5.2 – Mapeamento de variáveis no controlador MIMO

Variável de processo Informação na CS
Saída y2 Quantidade de diesel no estoque
Saída y3 Quantidade de gasolina no estoque
Saída y4 Quantidade de nafta no estoque
Saída y5 Quantidade de gás liquefeito de petróleo no estoque
Saída y6 Quantidade de querosene de aviação no estoque

Entrada u3 Quantidade de diesel entregue
Entrada u4 Quantidade de gasolina entregue
Entrada u5 Quantidade de nafta entregue
Entrada u6 Quantidade de gás liquefeito de petróleo entregue
Entrada u7 Quantidade de querosene de aviação entregue

Perturbação q2 Quantidade de diesel demandada
Perturbação q3 Quantidade de gasolina demandado
Perturbação q4 Quantidade de nafta demandado
Perturbação q5 Quantidade de gás liquefeito de petróleo demandada
Perturbação q6 Quantidade de querosene de aviação demandado

Setpoints wi Níveis no estoque programados

Z = max?((S j ?C j)Vj) (5.1)

?Vj ? RV T (5.2)

VjT ?Vj ?VjC (5.3)

A função objetivo proposta no algoritmo LP é baseada na otimização
do uso de recursos do sistema, maximizando os lucros totais. O primeiro
termo é responsável pelos preços de venda, onde S j é o preço unitário para



85

o produto j. O segundo termo, representa o custo total de produção, assim
C j é o custo geral por unidade de produto j de matéria-prima, transporte e
armazenamento. Finalmente, Vj é o volume do produto j que é exigido no
tempo de amostra. A restrição de desigualdade linear (5.2) é definida tendo
em conta a capacidade total de refino (RVT) e a restrição (5.3) é usada para
garantir as quantidades mínimas a produzir para que o processo seja rentável
VjT , e ao mesmo tempo, para delimitar Vj na capacidade máxima de refino
por dia VjC , em cada tipo de produto j.

Na camada inferior, o modelo do tanque de cru usado nas predições do
controlador MISO aparece na equação (5.4) e a matriz de transferência usada
no controlador MIMO que inclui os modelos dos tanques dos produtos finais
é apresentada na equação (5.5). Os ganhos Kd , Kg, Kn, Kp, Kq representam
os fatores de conversão para os tipos de produtos específicos. Os atrasos de
tempo dd , dg, dn, dp, dq representam o tempo que demora o produto específico
para estar disponível em estoque.

y1(k) =
z?1

1?z?1
(u1(k?1)+ u2(k?1)?q1(k)) (5.4)

?
?????

y2(k)
y3(k)
y4(k)
y5(k)
y6(k)

?
????? =

?
????????

Kd
z?1z?dd
1?z?1 0 0 0 0

0 Kg
z?1z?dg
1?z?1 0 0 0

0 0 Kn
z?1z?dn
1?z?1 0 0

0 0 0 Kp
z?1z?dp
1?z?1 0

0 0 0 0 Kq
z?1z?dq
1?z?1

?
????????

?
?????

u3(k)
u4(k)
u5(k)
u6(k)
u7(k)

?
?????

(5.5)

+

?
????????

?z?1
1?z?1 0 0 0 0

0 ?z
?1

1?z?1 0 0 0

0 0 ?z
?1

1?z?1 0 0

0 0 0 ?z
?1

1?z?1 0

0 0 0 0 ?z
?1

1?z?1

?
????????

?
?????

q2(k)
q3(k)
q4(k)
q5(k)
q6(k)

?
?????

No caso do controlador MISO, na função custo foi acrescentado um
termo de penalidade econômica, com o fim de regular os fluxos de cru. As-
sim, baseado no estudo de (SOUZA, 2007) e (PORFIRIO, 2011), é focado o
desenvolvimento de um algoritmo de integração de fatores econômicos e ca-



86

racterísticas do desempenho do controle. Para isso, é considerada uma função
objetivo econômica associada ao estado estacionário das predições ypi.

Para o estado estacionário, procura-se o ponto onde o valor ótimo de
u(k) seja o valor mínimo de u(k) = u(k?1) + ?u(k) ao longo do horizonte.
Na equação (5.7) é apresentada a função custo utilizada no caso MISO.

J(k) =
N2

?
j=N1

?[yp(k + j | k)?w(k + j | k)]2 +
Nm

?
m=1

?m(
Nu

?
j=1

[?um(k + j?1 | k)]2

(5.6)

+ ?m
Nu

?
j=1

[?um(k + j?1 | k)+ um(k + j?1 | k?1)]2)

Na forma matricial do algoritmo de otimização quadrática QP chega-
se a:

J = ?uT (GT ? G + ? I + ? I)?u + 2((f?W )T ? G + u(k?1)T ? )?u (5.7)

onde, ? define a importância da otimização econômica com relação
aos erros da variável controlada. O uso do termo econômico, neste caso,
permite restringir e limitar o uso do cru, segundo o preço. A vantagem dessa
integração dentro dum mesmo algoritmo consiste no maior sincronismo entre
as ações de controle em função de que o problema dinâmico e econômico
estão sendo considerando em um mesmo algoritmo.

No caso do controlador MIMO trabalhou-se com a função custo tradi-
cional do GPC, nela são corrigidos os erros de modelagem e são ponderados
os esforços de controle.

5.1.3 Resultados de simulação

O estudo de caso considera 180 dias de simulação da cadeia de supri-
mentos. O sistema é inicializado com os dados apresentados na tabela 5.4 e
opera segundo estes até a primeira ordem do algoritmo de LP, o qual indica
os novos setpoints como os níveis ótimos calculados. O sistema é simulado
sob incertezas na previsão da demanda e erros na modelagem.

No caso dos perfis de demanda, foram pressupostos dados de con-
sumo usualmente utilizados nos sistemas produtivos. Na prática esses dados
são estimados e calculados com ajuda de ferramentas informaticas empre-



87

Tabela 5.3 – Dados de simulação do algoritmo LP

Produto Lucro [$US/m3] Quantidades mínimas [m3]
Diesel [6,12| 53,78] 3000

Gasolina [116,19| 60,89] 12000
Nafta [83,96|140,23] 3000

Gás liquefeito [8,75|105,71] 2000
Querosene [34,97|16,85] 1000

Produção Total [m3/dia] 36000

Tabela 5.4 – Dados de simulação e estados iniciais na CS

Parâmetro Valor [ m3]
Setpoint e cru no estoque 40000

Setpoint e diesel no estoque 5000
Setpoint e gasolina no estoque 16000

Setpoint e nafta no estoque 7000
Setpoint e gás liquefeito no estoque 5000

Setpoint e querosene no estoque 3000

sariais baseadas em informações de produção, custos e vendas. Por exemplo,
com a informação para os mesmos períodos de tempo em anos anteriores são
realizadas projeções do consumo no período atual. Com tal característica,
simulou-se um perfil de demanda conhecido (valores de consumo para cada
dia) e foi inserido no modelo de predição. Da mesma maneira, foi inserido um
perfil de demanda próximo do programado somando uma incerteza aleatória
do tipo ruído branco simulando a demanda do mercado real.

Nos modelos foram inseridos erros nos tempos de entrega do produto
disponível em estoque, simulando falhas na operação da refinaria. Os dados
empregados nos cálculos do algoritmo LP encontram-se na tabela 5.3, assim
como na tabela 5.5 são apresentados os atrasos correspondentes ao modelo e
ao processo.

Na tabela 5.6 são apresentados os parâmetros da sintonia do contro-
lador GPC MISO. O horizonte de predição foi escolhido com o fim de acom-
panhar com informação suficiente as demandas da refinaria. As ações de con-



88

Tabela 5.5 – Incertezas inseridas na modelagem controlador DTC-GPC
MIMO

Atraso Modelo Processo
dd 2 4
dg 2 3
dn 1 2
dp 2 3
dq 1 2

trole foram suavizadas usando um fator de ponderação igual a 10. Isso para
evitar o possível efeito chicote na variável controlada, devido a mudanças re-
pentinas na entrada e saída de cru. A ponderação do termo econômico foi
condicionada ao preço de compra do cru, o petróleo tipo A é um cru leve,
porém mais caro; o petróleo tipo B, é um cru mais pesado, com um preço
muito mais baixo no mercado.

Tabela 5.6 – Parâmetros de ajuste do controlador MISO

Parâmetro Valor
N 30
Nu [10 | 10 ]
?i 1
?m [10 | 10]
?m [120 | 80]

No caso do controlador DTC-GPC MIMO a tabela 5.7 apresenta os
parâmetros empregados na configuração do controlador. Foram escolhidos
horizontes de controle e predição mais curtos, porém suficientes para atingir
os objetivos e foram suavizadas as ações de controle igual que no caso do
controlador GPC MISO visando diminuir problemas por efeito chicote. Para
contornar o problema com os erros na modelagem nos tempo de entrega e a
operação com erros na previsão de demanda, foram escolhidos os parâmetros
?i. Valores de restrição nos estoques e quantidades entregues estão listados
nas tabelas 5.8 e 5.9.

Na figura 5.2 se aprecia a resposta do controlador MISO. O nível de
estoque programado é mantido, e o controlador consegue rejeitar a perturba-
ção gerada pela demanda. E importante ressaltar como o objetivo da função



89

Tabela 5.7 – Parâmetros de ajuste do controlador MIMO

Parâmetro Valor
N [15 | 15 | 15 | 15 | 15 ]
Nu [5 | 5 | 5 | 5 | 5]
?i [1 | 1 | 1 | 1 | 1]
? j [10 | 10 | 10 | 10 | 10]
?i [0,88| 0,86 | 0,86 | 0,85 | 0,85]

Tabela 5.8 – Parâmetros de restrição controlador MISO

Parâmetro Valor [m3]
y1min|y1max [0 | 50000]
u1min|u1max [0 | 20000]
u2min|u2max [0 | 20000]

Tabela 5.9 – Parâmetros de restrição controlador MIMO

Parâmetro Valor [m3]
yimin|yimax [0 | 20000]
u jmin|u jmax [0 | 10000]

custo com a inclusão do termo econômico, faz com que seja utilizado em
menor quantidade o petróleo tipo A que representa um custo mais elevado.

Nas figuras 5.3 a 5.7 é possível observar as respostas do controlador
MIMO. Os níveis dos estoques buscam acompanhar o setpoint respectivo in-
dicado pela camada de otimização superior e o sistema em malha fechada
rejeita as perturbações geradas pelas demandas respectivas de produto. Ape-
sar de ter respostas lentas nos transitórios o sistema consegue contornar os
problemas de incertezas e erro na modelagem, mantendo estabilidade nas va-
riáveis controladas.



90

Figura 5.2 – Estoque de cru

Fonte: Elaborado pelo autor

Figura 5.3 – Estoque de diesel

Fonte: Elaborado pelo autor



91

Figura 5.4 – Estoque de gasolina

Fonte: Elaborado pelo autor

Figura 5.5 – Estoque de nafta

Fonte: Elaborado pelo autor



92

Figura 5.6 – Estoque de gás liquefeito de petróleo

Fonte: Elaborado pelo autor

Figura 5.7 – Estoque de querosene de aviação

Fonte: Elaborado por o autor



93

5.2 ESTUDO EM BIOCOMBUSTÍVEIS

A indústria de biomassa tornou-se uma importante área de estudos em
cadeias de suprimento devido ao crescimento explosivo gerado pelos regu-
lamentos ambientais e necessidades de energia renováveis. Além disso, o
comportamento dinâmico típico de cadeia de fornecimento justifica o inter-
esse em técnicas MPC. Há diversos estudos que propõem algoritmos MPC, a
fim de melhorar o desempenho dos sistemas de CS na indústria de biocom-
bustíveis (AN; WILHELM; SEARCY, 2011). Nestes estudos os autores analisam
como realizar a integração dos níveis de decisão a fim de gerar impacto no
desempenho geral do sistema. Nesta seção, a aplicação de um controlador
DTC-GPC no controle do estoque de biomassa em uma usina brasileira é
proposto, descreve-se o esquema de produção na indústria de cana de açúcar
e define-se o sistema de operação da cadeia de suprimento.

5.2.1 Esquema de sustentabilidade

O processamento de cana no Brasil é feito através de uma cadeia de
produção muito integrada. Açúcar e etanol são produzidos combinado com
um sistema de co-geração para suprir a demanda energética necessária, tra-
balhando como um processo de produção autônoma (PERAN et al., 2011). A
Figura 5.8 mostra o diagrama de fluxo, com os fluxos principais e saídas da
planta que são: o açúcar, o etanol, e potência.

Os passos típicos para produção em grande escala de açúcar são: mo-
agem, tratamento de caldo, cristalização e secagem. No processo de moa-
gem, caldo de cana e bagaço é produzido. O caldo é tratado quimicamente,
a fim de manter as propriedades e parâmetros de qualidade; cristalização e
secagem termina o processo de transformação do açúcar. O caldo também
alimenta os processos de fermentação e destilação para produção de etanol.
Resíduos (bagaço da moagem e, palhiço) são usados para produzir energia
(vapor e eletricidade) necessária para a planta operar; o excedente de ener-
gia elétrica é vendida à rede, aumentando os lucros do processo (PERAN et al.,
2011). Este estudo centra-se em manter os níveis de biomassa nos valores
ideais, necessários para garantir uma produção ótima de açúcar, etanol e ele-
tricidade. A ideia de controle é determinar as quantidades ideais de cana e
bagaço tendo em conta as exigências do mercado.

No sistema estudado assume-se que a informação requisitada é co-
municada instantaneamente. Além disso, as medidas e decisões no sistema



94

Figura 5.8 – Fluxo de processos de açúcar, etanol e bio-electricidade

Fonte: Elaborado pelo autor

de controle são feitas nos mesmos períodos de tempo, dias para este caso
de estudo. Todas as variáveis e seus significados no ambiente da cadeia de
suprimentos estão listadas na tabela 5.10 .

5.2.2 Formulação do problema

Para uma organização que trabalha com biomassa, o negócio é geral-
mente baseado em um plano mensal de pré-venda. O planejamento da pro-
dução pode ser escalado em dias para definir as taxas de processamento de
produtos (MENENGUETTI, 2014).

O planejamento de produção nas usinas brasileiras é basicamente de-
senvolvido para cumprir com contratos pré-assinados de açúcar e etanol. Ao
mesmo tempo, o processo de geração de eletricidade deve servir quantidades
contratuais, além de fornecer o próprio consumo de energia, evitando os cus-
tos adicionais de compra de energia de terceiros (AL-OTHAM et al., 2007).

Todo o processo é um sistema de duas entradas e duas saídas, com três
distúrbios, como descrito na matriz de transferência apresentada em (5.8). Os
ganhos Kb, Kp, KA e KE da função de transferência da perturbação represen-
tam os fatores de conversão de tipos de produtos específicos, a variável db,
representa o atraso de tempo que tem o bagaço comprado de terceiros para
estar disponível no estoque.



95

[
y1(k)
y2(k)

]
=

[
z?1

1?z?1 0

0 z
?1

1?z?1 z
?db

][
u1(k)
u2(k)

]
(5.8)

+

?
?(?kA+kE )z?11?z?1 0 0

0
?Kpz?1
1?z?1

kBz
?1

1?z?1

?
?[q(k)]

Duas camadas são utilizadas no problema, a parte superior é resolvida
por um algoritmo de LP e um controlador DTC-GPC multivariável é utilizado
no nível inferior, para contornar problemas de erro na modelagem, quando
existirem diferenças nos tempos de entrega do bagaço comprado de terceiros.
Para o controle propõe-se uma estratégia centralizada, como mostrado na
figura 5.9. Assume-se que todas as instalações são de propriedade da mesma
empresa, a informação é compartilhada pela rede. Portanto, um sistema de
controle centralizado é adequado e viável. Toda a informação disponível é
fornecida ao controlador e as decisões de fornecimento (quantidades) são de-
terminados pelo coordenador global (FU; AGHEZZAF; KEYSER, 2014).

Figura 5.9 – Esquema de controle centralizado e mapeamento de variáveis do
sistema de CS

Fonte: Elaborado pelo autor



96

Tabela 5.10 – Mapeamento de variáveis no controlador
Variável de processo Informação na CS

Saída y1 Quantidade de cana de açúcar no estoque
Saída y2 Quantidade de bagaço no estoque

Entrada u1 Quantidade de cana de açúcar entregue
Entrada u2 Quantidade de bagaço entregue

Perturbação q1 Quantidade de cana de açúcar demandada
Perturbação q2 Quantidade de bagaço demandado
Perturbação q3 Quantidade de bagaço subproduto da moagem

Setpoints wi Níveis de estoque programados

A solução do problema LP define, indiretamente, as demandas de
bagaço e cana de açúcar para o processo, que são os principais distúrbios
no sistema de controle do nível de estoque. A função objetivo, equação (5.9),
é definida para maximizar os lucros, sujeitos a restrições de produção e ope-
ração, equações (5.10) e (5.11).

Z = max?((S j ?C j)Vj) (5.9)

?Vj ? PV T (5.10)

VjT ?Vj ?VjC (5.11)

A função objetivo proposta é baseada na otimização do uso de recursos
do sistema, maximizando os lucros totais. O primeiro termo, é responsável
pelos preços de venda, onde S j é o preço unitário para o produto j. O se-
gundo termo, representa o custo total de produção, assim C j é o custo geral
por unidade de produto j de matéria-prima, transporte e armazenamento. Fi-
nalmente, Vj é o volume do produto j que é exigido no tempo de amostra.

A restrição de desigualdade linear (5.10) é definida levando em conta
a capacidade total de produção da planta (PVT) e a restrição (5.11) é usada
para garantir a entrega das quantidades mínimas contratadas VjT , e ao mesmo
tempo, para delimitar v j na capacidade máxima de processamento VjC , em
cada tipo de produto j.



97

5.2.3 Resultados de simulação

O estudo de caso considera 360 dias de simulação da cadeia de supri-
mentos e como a safra de cana de açúcar é limitada, a entrega de cana de
açúcar é suspensa por um período de 60 dias. As demandas do mercado
otimizadas resolvendo o problema LP em (5.9) são consideradas como as de-
mandas geradas para o controlador DTC-GPC MIMO. A flexibilidade para
ajustar os parâmetros do controlador para satisfazer o desempenho exigido é
considerada neste exemplo de simulação na definição dos horizonte de pre-
dição N1 = [1|1] até N2 = [60|60] (dias) e dos horizonte de controle Nu =
[10|10] (dias), ver tabela 5.11. Os horizontes longos são exigidos visando ter
informação suficiente e ajudar nas decisões centralizadas, a fim de executar
antecipações necessárias. O problema de gestão da CS pode ainda se benefi-
ciar da aplicação do DTC-GPC em outros aspectos, por exemplo, mantendo
o estoque desejado, acompanhando as demandas dos clientes e reduzindo o
efeito chicote. Este último aspecto é tratado com a penalização do controle
? j , usadas para moderar as quantidade de bagaço entregue, com o fim de
diminuir os custos de compra de terceiros e aproveitar ao máximo o bagaço
subproduto da moagem. Além disso, serão obtidas menores flutuações nos
níveis de estoque. São considerados erros na modelagem nos tempos de en-
trega de bagaço comprado de terceiros e para isso foi sintonizado o filtro com
o parâmetro ?i para manter a estabilidade no nível de bagaço.

Tabela 5.11 – Parâmetros de ajuste do controlador

Parâmetro Valor
N [60 | 60 ]

Nu [10 | 10]
?i [1 | 1]
? j [1 | 10]
?i [0,85 | 0,96]

O modelo do sistema é inicializado utilizando os parâmetros aponta-
dos na tabela 5.12 (unidades em toneladas [t]). O fornecimento do bagaço
inicialmente é zero, trabalhando unicamente com bagaço subproduto do pro-
cesso de transformação da cana.



98

Tabela 5.12 – Dados de simulação e estados iniciais na CS

Parâmetro Valor [t]
Quantidades nos estoques [5000 | 5000]

Setpoints [5000 | 5000]
Quantidades de cana de açúcar entregue 3000

Quantidade de bagaço entregue 0
Quantidade de cana de açúcar demandada 6200

Quantidade de bagaço demandado 2000

Tabela 5.13 – Parâmetros de restrição

Parâmetro Valor [t]
yimin|yimax [0 | 10000]
u1min|u1max [0 | 10000]
u2min|u2max [0 | 10000]

Valores de restrição nos estoques e quantidades entregues estão lis-
tados na tabela 5.13. As restrições são impostas na simulação numérica de
modo que a simulação da cadeia de suprimentos representa um sistema o
mais próximo possível em condições reais de operação.

O controlador minimiza o desvio nas posições dos estoques de seus
setpoints. Note-se que as posições de estoque só podem permanecer dentro
dos limites yimin|yimax devido a limitações de capacidade físicas. As restrições
sobre as quantidades de produto a serem entregues são definidas com base
nos limites de capacidade de transporte uimin|uimax .

Os níveis de estoque são mostrados nas figura 5.10 (superior), e 5.12
(superior). As quantidades de produto entregue são apresentadas nas figuras
5.10 (inferior) e 5.12 (inferior). É claro que é possível manter os níveis de
estoque, mostrando pequenas flutuações quando acontecem mudanças na de-
manda. Neste caso, as quantidades de bagaço que são entregues externamente
estão penalizadas, já que o objetivo é maximizar a utilização de resíduos de
processo, ver figura 5.12. No período no qual a safra acaba, é possível obser-
var como o bagaço comprado de terceiros, aumenta as entregas para suprir a
demanda.



99

Figura 5.10 – Estoque cana de açúcar

Fonte: Elaborado pelo autor

Figura 5.11 – Cana de açúcar demandada

Fonte: Elaborado pelo autor

Os resultados nas figura 5.11 e 5.13 mostram as quantidades deman-
dadas específicas por tipo de produto. É claro como o algoritmo de programa-
ção linear LP define as quantidades necessárias de cana-de-açúcar para serem
processadas e cumprir com a produção exigida de açúcar e de etanol. Em re-
lação à demanda de potência, o algoritmo garante as quantidades de energia
utilizadas para sustentar o processo. A abordagem de programação linear usa
a capacidade de geração máxima para atender a contratos de exportação de
energia e, quando possível, produz mais energia para vender na rede.



100

Figura 5.12 – Nível de estoque de cana de açúcar

Fonte: Elaborado pelo autor

Figura 5.13 – Bagaço demandado

Fonte: Elaborado pelo autor

5.3 COMENTÁRIOS FINAIS DO CAPÍTULO

Neste capítulo, foram apresentados os resultados de simulação em dois
estudos de caso na área de petróleo, gás e biocombustíveis. Controladores
preditivos multivariáveis nas abordagens centralizada e descentralizada são
aplicados para resolver o problema de controle de estoque nas cadeias de
suprimento especificadas, trabalhando em um esquema de duas camadas com



101

um algoritmo de LP que comanda as políticas de CS para melhorar os lucros.
Os resultados obtidos mostram que o controlador DTC-GPC MIMO pode ter
um impacto significativo e positivo sobre o controle dos níveis de estoque e,
ao mesmo tempo, satisfazer as demandas do mercado gerada pelo algoritmo
de LP. Parâmetros de ajuste desempenham um papel importante na obtenção
do desempenho desejado para as operações da cadeia de fornecimento. Tem
sido ilustrado nas simulações que esta estratégia de controle pode ser sin-
tonizada segundo requisitos de desempenho. Bons resultados são observados
porque a implementação do GPC centralizado tem pleno conhecimento de
modelos e fluxos de informação do sistema, o que lhe permite coordenar as
decisões tomadas por cada nó da CS. O controlador olha os níveis de inven-
tário estratégicos necessários para satisfazer as demandas de pico e mantém
estoques dentro dos níveis de segurança desejados em períodos de baixa de-
manda. É importante mencionar, contudo, que a qualidade da gestão depende
em grande parte a qualidade dos dados de predição. Os resultados globais
das simulações mostram bom acompanhamento de referência e boa rejeição
de distúrbios.



102



103

6 CONCLUSÕES

Este trabalho abordou o estudo do controle de processos que envolvem
cadeias de suprimentos tipicamente caracterizados como processos com atraso
de tempo elevado e dinâmicas integradoras. Foram desenvolvidas duas es-
tratégias de controle, sendo a primeira baseada no controlador preditivo gen-
eralizado, conhecido como GPC, e a segunda baseada em uma modificação
da forma de realizar predições no algoritmo GPC conhecida como DTC-GPC.
O GPC difere de outros controladores preditivos pelo fato de utilizar o mo-
delo em função de transferência para realizar as predições, o que foi interes-
sante nos casos tratados ao longo do trabalho por possuírem modelos sim-
ples claramente representados por funções de transferência. Além disso, a
capacidade de tratar restrições de forma explícita no cálculo do controle foi
aproveitada para tratar as limitações físicas e as restrições operacionais dos
processos considerados. Adicionalmente, algumas ferramentas como a es-
trutura de compensação antecipativa foram empregadas com a finalidade de
melhorar o tratamento das perturbações.

Foram realizados ensaios de simulação visando avaliar o desempenho
dos controladores com o sistema operando sob incertezas na previsão da de-
manda e erros na modelagem. Os resultados obtidos foram comparados nas
duas estratégias de controle implementadas, mostrando as vantagens em ter-
mos de estabilidade da estratégia DTC-GPC. Verificou-se nos ensaios que
o controlador GPC sempre que não operava sob grandes atrasos de tempo
obteve bons resultados. As principais contribuições deste trabalho são:

• aplicação de controles preditivos do tipo GPC ao controle de uma cadeia
de suprimento de três camadas, um só nó por camada e para um único
produto;

• aproveitamento da estrutura explícita de compensação de atraso do
tempo da abordagem DTC-GPC para aplicação em cadeias de supri-
mento;

• uso da técnica de compensação antecipativa da demanda em CS;

• ensaios nas abordagens centralizada e descentralizada.

Com relação à utilização dos controladores GPC nos estudos de caso
em petróleo, gás e biocombustíveis, apresentaram-se bons resultados nas di-
ferentes configurações propostas, tornando-os grandes candidatos na apli-
cação no meio industrial. Esses tipos de ferramentas tornam-se de crucial



104

importância para o pessoal especializado em logística e operações nas empre-
sas, uma vez que permitem operação ótima do sistema dadas as informações
disponíveis em dado instante de tempo. A implementação do controlador
GPC se mostra inovadora, uma vez que esses tipos de algoritmo é facilmente
embutido em pacotes de software, basta fazer a comunicação do algoritmo
GPC com o sistema gerencial, que tipicamente possuem dados já disponíveis
e em tempo real dos estoques, taxas de produção, previsões de vendas e outras
informações, que ajudam na tomada de decisões e implementação de estraté-
gias para a gestão de estoques.

Uma grande contribuição deste trabalho é a inclusão do termo adi-
cional de penalização econômica na função custo, o qual teve por objetivo
administrar o suprimento de dois tipos de cru baseado no preço de compra.
Indicando um uso moderado para um petróleo mais caro, priorizando o uso
do petróleo mais barato. Dessa forma, foi provado com êxito como é possível
por médio do MPC incluir decisões nos suprimentos de petróleo em função
de manter níveis de estoque, satisfazendo condições econômicas. Como con-
tribuição para o estudo de controle preditivo em cadeias de suprimento, este
trabalho gerou as seguintes publicações:

• Álvarez, D. and Normey-Rico, J. and Flesch, R. "Controle preditivo
para cadeias de suprimentos sujeitas a incertezas de modelagem e de
previsão de demanda". V congresso de Engenharia de produção, CON-
BREPRO, 2015, Ponta Grossa - Parana.

• Álvarez, D. and Normey-Rico, J. and Flesch, R. "Model Predictive
Control for Inventory Management in Biomass Manufacturing Supply
Chains", International Journal of Production Research, 2016. (Sub-
metido)

6.1 SUGESTÕES PARA TRABALHOS FUTUROS

Os sistemas de cadeias de suprimento estudados neste trabalho repre-
sentam somente uma parte das múltiplas topologias existentes. Existe muito
trabalho a ser realizado na área de gestão de CS usando controladores pre-
ditivos. Pensando nisso, são sugeridos possíveis temas de pesquisa a serem
realizados futuramente com o objetivo de estudar melhor o comportamento
dos sistemas de controle de estoque em cadeias de suprimento, simulá-los em
ambiente computacional e estudar técnicas de controle eficientes:

• testar o desempenho do controlador GPC perante a um sistema de cadeia
de suprimentos com produção e armazenagem de vários produtos, ou



105

seja, um sistema de maior complexidade que envolva vários nós por
camada;

• substituir o uso do algoritmo de programação linear e empregar técni-
cas de otimização multi-objetivo nas quais os algoritmos GPC otimizem
tanto as variáveis de processo na camada inferior, quanto as variáveis
de rendimento econômicas na camada superior.



106



107

REFERÊNCIAS

AL-OTHAM, W. et al. Supply chain optimization of petroleum organization
under uncertainty in market demands and prices. European Journal of
Operational Research, v. 189, p. 822–840, 2007.

ALVAREZ, D.; NORMEY-RICO, J.; FLESCH, R. Controle preditivo para
cadeias de suprimentos sujeitas a incertezas de modelagem e de previsão de
demanda. In: . Ponta Grossa: V Congresso Brasileiro de Engenharia de
Produção, 2015.

AMERICANO, M. Modeling, Control and Optimization of ethanol
industry process: an application in solar energy. Tese (Doutorado) —
Federal University of Santa Catarina, Florianópolis, 2013.

AN, H.; WILHELM, W.; SEARCY, S. Biofuel and petroleum-based fuel
supply chain research: A literature review. Biomass and Bioenergy, v. 35,
p. 3763–3774, 2011.

BEAMON, B. Supply chain design and analysis: Models and methods.
Internacional Journal of Production Economics, v. 55, p. 281–294, 1998.

BENET, E.; SUBIAS, A.; GRIÑÓ, R. Descripción y análisis de los
trabajos existentes sobre el efecto "bullwhip"y su tratamiento con
técnicas de teoría de control. Catalunya: Universitat Politècnica de
Catalunya. Institut d’Organització i Control de Sistemes Industrials, 2006.

BERNHARD, J.; MARIOS, C. System dynamics modelling in supply chain
management: research review. In: . Uxbridge Middlesex: Winter simulation
Conference, 2000.

BOSE, S.; PEKNY, J. A model predictive framework for planning and
scheduling problems: a case of consumer goods supply chain. Computers
and Chemical Engineering, v. 24, p. 329–335, 2000.

BRAUM, M. et al. Application of model predictive control to robust
management of multi-echelon demand networks in semiconductor
manufacturing. In: . Tempe Arizona: International Conference on Modeling
and Analysis of Semiconductor Manufacturing, 2002.

CAMACHO, E.; BORDONS, C. Model Predictive Control. London:
Springer, 2004.



108

CLARKE, D.; MOHTADI, C.; TUFFS, P. Generalized predictive control —
part i. the basic algorithm. Automatica, v. 23, p. 137–148, 1987.

CNI; DIRET; IBP. A contribuição do setor brasileiro de petróleo, gás e
biocombustíveis para o desenvolvimento sustentável no país. In: . Rio de
Janeiro: Conferência Rio+20, 2012. CNI: Confederação nacional da
indústria, DIRET: Diretoria de educação e tecnologia, IBP: Instituto
brasileiro de petróleo gás e bioconbustíveis.

EICHMANN, D. Creating a high-performance downstream petroleum
supply chain. Achieving Supply Chain Excellence through Tecnology, p.
229–232, 2000.

FU, D.; AGHEZZAF, E.; KEYSER, R. A model predictive control
framework for centralised management of a supply chain dynamical system.
Systems Science and Control Engineering: An Open Access Journal,
v. 2, p. 250–260, 2014.

GAGLIARDO, A.; CORSANO, G. A multiperiod milp model for the design
of a bioethanol supply chaing considering sustainability. Iberoamerican
Jorunal of Industrial Engiennering, v. 3, p. 209–225, 2011.

GARCIA, C.; MORSHEDI, A. Quadratic programming solution of dynamic
matrix control. Chemical Engiennering Communications, v. 46, p. 73–87,
1985.

GARCIA, C.; PRETT, D.; MORARI, M. Model predictive control: Theory
and practice—a survey. Automatica, v. 25, p. 335–348, 1989.

GUZMAN, J.; HAGGLUD, T.; VISIOLI, A. PID control in the thrid
millennium. London: Springer, 2012.

HERBET, S. On the application of servomechanism theory in the study of
production control. Econometrica, v. 20, p. 247–680, 1952.

KAPSIOTIS, D.; TZAFESTAS, S. Decision making for inventory
production planning using model-based predictive control. Parallel and
distributed computing in engineering systems, p. 551–600, 1992.

LI, X.; MARLIN, T. Robust supply chain performance via model predictive
control. Computers and Chemical Engineering, v. 33, p. 2134–2143,
2009.

MENENGUETTI, S. Sustainability report communication on procress,
Santa Terezinha Power Plant. Paraná, 2014. Disponível em:



109

https://www.usacucar.com.br/verPdf.php?arq=99. Acesso em 15 de
Novembro de 2015.

MIN, H.; ZHOU, G. Supply chain modeling: past, present and future.
Computer and Engineering, v. 43, p. 231–249, 2002.

NANDOLA, N.; RIVERA, D. An improved formulation of hybrid model
predictive control with application to production-inventory systems. IEEE
Transactions on Control Systems Technology, v. 21, p. 121–135, 2013.

NEIRO, S.; PINTO, J. A general modeling framework for the operational
planning of petroleum supply chain. Computer and Chemical Engieering,
v. 28, p. 871–896, 2004.

NORMEY-RICO, J.; CAMACHO, E. Control of Dead-time Processes.
London: Springer, 2007.

NORMEY-RICO, J.; CAMACHO, F. Dead-time compensators: A survey.
Control Engineering Practice, v. 16, p. 407–428, 2008a.

NORMEY-RICO, J.; CAMACHO, F. Unified approach for robust dead-time
compensator design. Journal of Process Control, v. 19, p. 38–47, 2009.

OPEC. Annual Statistical Bulletin, OPEC: Organization of the
Petroleum Exporting Countries. Vienna, 2013.

PACHECO, E. Usando dinâmica de sistemas para análise de algoritmos
de reposição de estoque em ambientes produtivos. Dissertação (Mestrado)
— Pontifícia Universidade Católica do Paraná, Curitiba, 2004.

PERAN, J. et al. White book of Automation and Control on Sugarcane
industry. España: Iberoamericam program of science and technology for
development: CYTED, 2011.

PEREA, E.; YDSTIE, B.; GROSSMANN, I. A model predictive control
strategy for supply chain optimization. Computers and Chemical
Engieering, v. 27, p. 1201–1218, 2003.

PETROBRAS. Expandendo os Limites. 2014. Disponível em:
http://www.petrobras.com/pt/energia-e-tecnologia/tecnologia-e-
pesquisa/expandindo-os-limites/. Acesso em 08 de Dezembro de
2014.

PIN-HO, L.; SHAN-HILL, D.; JANG, S. Controller design and reduction of
bullwhip for a model supply chain system using z-transform analysis.
Journal of Process Control, v. 14, p. 487–499, 2004.



110

PORFIRIO, C. Implantação de otimizador online acoplado ao controle
preditivo (MPC) de uma coluna de Tolueno. Tese (Doutorado) — Escola
Politécnica da Universidade de São Paulo, São Paulo, 2011.

PRASATH, G.; JORGENSEN, J. Soft constraints for robust mpc of
uncertain systems. International Symposium on Advanced Control of
Chemical Processes, v. 7, 2009.

PWC. A indústria brasileira de petróelo e gás, PWC:
PricewaterhouseCoopers. Ltda. Brasil, 2014. Disponível em:
http://www.pwc.com.br/pt/publicacoes/setores-atividade/assets/oil-gas/oeg-
tsp-14-port.pdf. Acesso em 09 de Dezembro de
2015.

RICHALET, J. et al. Model predictive heuristic control: Applications to
industrial processes. Automatica, v. 14, p. 413–428, 1978.

ROCA, L. et al. Robust constrained predictive feedback linearization
controller in a solar desalination plant collector field. Control Engiennering
Practice, v. 17, p. 1076–1088, 2009.

RODRíGUEZ, C. et al. On the filtered smith predictor with feedforward
compensation. Journal of Process Control, v. 41, p. 35–46, 2016.

SAHARIDIS, G.; DALLERY, Y.; KARAESMEN, F. Centralized versus
decentralized production planning. RAIRO Operations Reserach, v. 40,
2006.

SANTOS, T. M. Contribuições para o controle preditivo com
compensação de atraso robusta. Tese (Doutorado) — Universidade
Federal de Santa Catarina, Florianópolis, 2011.

SARIMVEIS, H. et al. Dynamic modeling and control of supply chain
systems: A review. Computers and Research, v. 35, p. 3530–3561, 2007.

SAUL, I. Linear programing methods and applications. Massachusetts:
Ser. Dover books on Computer Science Series, Courier Corporation, 2003.

SCHWARTZ, J.; RIVERA, D. A process control approach to tactical
inventory in production-inventory systems. Int.J. Production Economics,
v. 125, p. 111–124, 2010.

SIMCHI-LEVI, D.; KAMINSKY, P.; SIMCHI-LEVI, E. Managing the
Supply Chain. New York: McGraw-Hill, 2004.



111

SOUZA, G. Integração da Otimização em Tempo Real com Controle
Preditivo. Dissertação (Mestrado) — Escola Politécnica da Universidade de
São Paulo, São Paulo, Brasil, 2007.

SUBRAMANIAM, K. et al. Integration of control theory and scheduling
methods for supply chain management. Computer and Chemical
Engineering, v. 51, p. 4–20, 2012.

TERUMICHI, R. Modelagem Sistêmica e Planejamento Logistico da
Cadeia de Suprimentos de Petróleo. Tese (Doutorado) — Escola
Politécnica da Universidade de São Paulo, São Paulo, Brasil, 2007.

TOWILL D.AND NAIM, M.; WIKNER, J. Industrial dynamics simulation
models in the desing of supply chains. International Journal of Physical
Distribution and Logistics Management, v. 22, p. 3–13, 1992.

VALLADARES, F. Um estudo comparativo de políticas de gestão de
estoques utilizando técnicas de controle. Dissertação (Mestrado) — Escola
Politécnica, Universidade Federal de Rio de Janeiro, Rio de Janeiro, 2014.

VASSIAN, J. Application of discrete variable servo theory to inventory
control. Operations Research, v. 3, p. 272–821, 1955.

VERRUSCHI, E. et al. Como planificar óptimamente la cadena de
suministros de una refinería de petróelo. Universidad, Ciencia y
Tecnologia, v. 13, p. 339–344, 2009.

WANG, J. A supply chain application of fuzzy set theory to inventory
control models – drp system analysis. Expert Systems with Applications,
v. 36, p. 9229–9239, 2009.

WANG, W.; RIVERA, D.; KEMPF, K. Centralized model predictive control
strategies for inventory management in semiconductor manufacturing supply
chains. In: . Denver Colorado: American Control Conference, 2003.


</field>
	</doc>
</add>