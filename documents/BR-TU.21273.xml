<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.21273</field>
		<field name="filename">4990_337433.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
FEDERAL UNIVERSITY OF SANTA CATARINA
GRADUATE PROGRAM IN

AUTOMATION AND SYSTEMS ENGINEERING

Leonardo Salsano de Assis

Scheduling Dynamic Positioned Tankers with Variable
Travel Time for O?shore O?oading Operations

Florianópolis

2015



FichaSdeSidentificaçãoSdaSobraSelaboradaSpeloSautor,
atravésSdoSProgramaSdeSGeraçãoSAutomáticaSdaSBibliotecaSUniversitáriaSdaSUFSC.

depAssis5pLeonardopSalsano
SchedulingpDynamicpPositionedpTankerspwithpVariable

TravelpTimepforpOffshorepOffloadingpOperationspçpLeonardo
SalsanopdepAssispzporientador5pEduardopCamponogarapz
coorientador5pAgustinhopPlucenio4p7pFlorianópolis5pSC5p)ã(I4

3Gpp4

Dissertaçãopómestrado2p7pUniversidadepFederalpdepSanta
Catarina5pCentropTecnológico4pProgramapdepPós7Graduaçãopem
EngenhariapdepAutomaçãopepSistemas4

Incluipreferências

(4pEngenhariapdepAutomaçãopepSistemas4p)4pOil
TransportationpLogistics4pU4pMILP4pG4pShuttlepTankers4pI4
Rolling7Horizon4pI4pCamponogara5pEduardo4pII4pPlucenio5
Agustinho4pIII4pUniversidadepFederalpdepSantapCatarina4
ProgramapdepPós7GraduaçãopempEngenhariapdepAutomaçãope
Sistemas4pIV4pTítulo4



Leonardo Salsano de Assis

Scheduling Dynamic Positioned Tankers with Variable
Travel Time for O?shore O?oading Operations

Dissertation presented to the Graduate
Program in Automation and Systems
Engineering in partial ful?llment of the
requirements for the degree of Master in
Automation and Systems Engineering.
Advisor: Prof. Eduardo Camponogara,
Dr.
Co-Advisor: Prof. Agustinho Plucenio,
Dr.

Florianópolis

2015





Leonardo Salsano de Assis

Scheduling Dynamic Positioned Tankers with Variable
Travel Time for O?shore O?oading Operations

This dissertation is recommended in partial ful?llment of the re-
quirements for the degree of "Master in Automation and Systems Engi-
neering", which has been approved in its present form by the Graduate
Program in Automation and Systems Engineering.

Florianópolis, July 2nd 2015.

Prof. Rômulo Silva de Oliveira, Dr. - UFSC
Graduate Program Coordinator

Prof. Eduardo Camponogara, Dr. - UFSC
Advisor

Prof. Agustinho Plucenio, Dr. - UFSC
Co-Advisor





Dissertation Committee:

Prof. Eduardo Camponogara, Dr.
Advisor - DAS/UFSC

Prof. Erlon Cristian Finardi, Dr. - EEL/UFSC

Prof. Guilherme Ernani Vieira, Dr. - EPS/UFSC

Prof. Jomi Fred Hubner, Dr. - DAS/UFSC

Bruno Ferreira Vieira, Dr. - CENPES/TOOL PETROBRAS





To my family Bruno, Rossana and
Larissa, and to Jessica.





Acknowledgements

This work is the result of two and a half years of learning and e?ort.
During this period I had the opportunity to acquire skills, whether tak-
ing courses or working with research, that will be extremely important
to my training as a researcher.

First, I would like to thank my advisor Prof. Eduardo Camponog-
ara for his enthusiasm, time, patience and willingness to teach.

I would like to thank my family for all the support. I am very
grateful to my partner Jessica who was always on my side. I thank my
friends Alexandre, Fernando and Sydney for helping reduce the stress
of this period. I am also grateful to my research colleagues Luiz, Eric,
Thiago, Eduardo, Lauvir, Marco Aurélio, Caio, Ricardo and Angelo for
having received and helped me when needed.

Last but not least, I thank the Federal University of Santa Catarina
and the Department of Automation and Systems for having accepted
me and allowed the use of their facilities and resources. Also, I am very
grateful to CAPES and Petrobras for funding, without which this work
would not be possible.





The power of rational thinking is the pri-

mary source of freedom in the world.

Neil deGrasse Tyson





Resumo Extendido

A operação de campos de petróleo em alto mar implica na transferência
de óleo que acumula em Unidades Flutuantes de Produção, Armazena-
mento e Descarregamento (FPSOs em inglês) para terminais em terra.
Uma frota de Petroleiros Dinamicamente Posicionados (DPTs em in-
glês), ou navios aliviadores, é utilizada para a transferência de óleo
das plataformas ?utuantes até os terminais terrestres, onde depois o
petróleo é transportado em grandes petroleiros ou por dutos até as
re?narias. O escalonamento de uma frota de navios aliviadores, que
minimiza os custos operacionais e que atenda às restrições do sistema,
consiste em um problema complexo.

Este trabalho propõe uma formulação em Programação Linear Inteira
Mista (MILP em inglês) que avança em relação à trabalhos anteriores
pela contabilização de tempos de viagem variáveis entre plataformas e
terminais terrestres. As viagens dos navios aliviadores são modeladas
como caminhos em um grafo direcionado tendo o terminal terrestre,
plataformas ?utuantes e pontos de controle como nós, enquanto os ar-
cos representam os possíveis movimentos e operações de carregamen-
to/descarregamento dos navios aliviadores.

Do ponto de vista econômico, a frota de navios aliviadores deve ser
escalonada para maximizar a produção de petróleo nas plataformas
?utuantes enquanto minimiza os custos gerados pelas viagens. A com-
binação da formulação MILP com um solver constitui uma ferramenta
para auxiliar os engenheiros na tomada de decisões. Este problema
pode ser resolvido diariamente utilizando a estratégia de rolling-horizon
para responder a eventos inesperados.

Palavras-chave: Logística para Transporte de Petróleo, FPSO, Navios
Aliviadores, Rolling-Horizon, Relax-and-Fix.

No capítulo 1 apresentamos o problema do Planejamento do Supri-
mento de Petróleo que envolve desde a produção de óleo e gás nas
plataformas até o atendimento da demanda do mercado com os sub-
produtos bene?ciados nas re?narias. O escalonamento de navios alivi-
adores constitui um subproblema da cadeia produtiva de petróleo e



possui uma importância tática dentro do planejamento das operações.

No capítulo 2 discutimos alguns conceitos importantes no campo da
otimização. Primeiro de?nimos o que é otimização e o que é um mod-
elo de otimização utilizando como exemplo o Problema da Mochila. Em
seguida, apresentamos o conceito de Programação Inteira (IP) e Pro-
gramação Linear Inteira Mista (MILP) e fazemos uma breve discussão
sobre algoritmos para a solução de IPs e MILPs. Também introduzi-
mos o conceito de relaxação e sua relevância na solução de problemas de
otimização. Uma seção é dedicada para a introdução de conceitos rela-
cionados com problemas de escalonamento e roteamento e por último
apresentamos alguns métodos de otimização dinâmica como o rolling-
horizon e relax-and-?x.

No capítulo 3, apresentamos primeiro uma formulação prévia do prob-
lema que considera os tempos de viagem entre as plataformas e os
terminais terrestres como ?xos e em seguida, propomos uma nova for-
mulação que considera os tempos de viagem variáveis. Uma revisão da
literatura é feita com o intuito de relacionar o modelo proposto com
outros trabalhos. O capítulo termina com resultados teóricos obtidos
a partir do novo modelo.

No capítulo 4 desenvolvemos a relaxação Lagrangeana do problema que
origina o problema Dual Lagrangeano. Em seguida, apresentamos os
algoritmos utilizados para a solução do problema dual e ?nalizamos o
capítulo desenvolvendo a decomposição da função Dual Lagrangeana
que quebra a função dual em diversas funções, uma para cada navio
aliviador e plataforma, permitindo assim computação paralela.

No Capítulo 5 de?nimos uma instância exemplo com campos de petróleo,
terminais terrestres e navios aliviadores, no qual as análises computa-
cionais são feitas. A primeira análise consiste em comparar os limites
obtidos pela relaxação Lagrangeana e a relaxação linear do problema.
Os métodos do subgradiente e de geração de restrições sob demanda
foram utilizados para a solução do problema Dual Lagrangeano. Em
seguida, comparamos a solução estática, onde o problema é resolvido
para todo o horizonte de planejamento, com a solução dinâmica obtida
utilizado as heurísticas de rolling-horizon e relax-and-?x. Estas em
geral fornecem soluções sub-ótimas mas respondem de forma satis-
fatória às grandes instâncias e incertezas do problema. Fechando o
capítulo, a estratégia de rolling-horizon é avaliada em um simulador
que gera perturbações para variáveis do modelo.



No capítulo 6 concluímos a dissertação com uma análise geral e con-
tribuições do trabalho e propomos algumas direções para pesquisas
futuras.





Abstract

The logistics of operating oil ?elds o? the coast entails transferring
oil that accumulates in Floating Production Storage and O?oading
Units (FPSOs) to onshore terminals. A ?eet of Dynamically Positioned
Tankers (DPTs), or shuttle tankers, is deployed for transferring oil from
the ?oating platforms to onshore terminals, where the oil is transported
in large tanker ships or by pipelines to re?neries. The scheduling of a
?eet of shuttle tankers that minimizes the operating costs while satisfy-
ing the system constraints consists of a complex problem. To this end,
this work proposes a formulation in Mixed-Integer Linear Programming
(MILP) that advances previous works by accounting for variable time
travel between ?oating platforms and the onshore terminal. The trips
of the shuttle tankers are modeled as paths in a directed graph having
the onshore terminal, ?oating platforms, and control points as nodes
and arcs representing possible moves and o?oading operations for the
shuttle tankers. As a business case, the ?eet of shuttle tankers should
be scheduled to maximize oil production from the ?oating platforms
while factoring in the transportation costs. The combination of the
MILP formulation with an optimization solver constitutes a tool to aid
operations engineers in making advised decisions. This formulation can
be systematically solved daily in a rolling-horizon framework to respond
to unanticipated events.

Keywords: Oil Transportation Logistics, FPSO, MILP, Shuttle Tankers,
Rolling-Horizon, Relax-and-Fix.





Contents

List of Figures v

List of Tables vii

1 Introduction 1

1.1 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . 3

1.2 Dissertation Organization . . . . . . . . . . . . . . . . . 4

2 Fundamentals 6

2.1 Introduction to Mathematical Optimization . . . . . . . 6

2.1.1 Integer Programming . . . . . . . . . . . . . . . 8

2.1.2 MILPs . . . . . . . . . . . . . . . . . . . . . . . . 9

2.2 Solving Strategies . . . . . . . . . . . . . . . . . . . . . . 9

2.2.1 Branch and Bound . . . . . . . . . . . . . . . . . 10

2.2.2 Cutting Plane . . . . . . . . . . . . . . . . . . . . 10

2.2.3 Heuristics . . . . . . . . . . . . . . . . . . . . . . 12

2.3 Lagrangean Duality . . . . . . . . . . . . . . . . . . . . 12

2.3.1 Lagrangean Relaxation . . . . . . . . . . . . . . 13

2.3.2 Lagrangean Dual Problem . . . . . . . . . . . . . 14

i



2.3.3 Subgradient Method . . . . . . . . . . . . . . . . 15

2.3.4 Constraint Generation Method . . . . . . . . . . 17

2.3.5 Bound Analysis . . . . . . . . . . . . . . . . . . . 18

2.4 Dynamic Optimization . . . . . . . . . . . . . . . . . . . 20

2.4.1 Rolling-Horizon Strategy . . . . . . . . . . . . . 20

2.4.2 Relax-and-Fix Strategy . . . . . . . . . . . . . . 21

2.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 22

3 Problem Formulation 23

3.1 Fixed Travel Time Formulation (FTTF) . . . . . . . . . 23

3.1.1 Formulation . . . . . . . . . . . . . . . . . . . . . 25

3.2 Variable Travel Time Formulation (VTTF) . . . . . . . 28

3.2.1 Problem Representation . . . . . . . . . . . . . . 28

3.2.2 Problem Formulation . . . . . . . . . . . . . . . 29

3.3 Literature Review . . . . . . . . . . . . . . . . . . . . . 34

3.3.1 Similar Works . . . . . . . . . . . . . . . . . . . . 34

3.3.2 Related Works . . . . . . . . . . . . . . . . . . . 36

3.4 Theoretical Results . . . . . . . . . . . . . . . . . . . . . 38

3.4.1 NP-Hardness . . . . . . . . . . . . . . . . . . . . 38

3.4.2 Generalization . . . . . . . . . . . . . . . . . . . 39

3.4.3 A Family of Valid Inequalities . . . . . . . . . . . 41

3.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 43

4 Lagrangean Duality 44

4.1 Lagrangean Relaxation . . . . . . . . . . . . . . . . . . . 44

4.2 Lagrangean Dual Function Decomposition . . . . . . . . 46

4.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 48

ii



5 Computational Analysis 49

5.1 O?shore Oil?eld Scenario . . . . . . . . . . . . . . . . . 49

5.2 Lagrangean Dual Bound . . . . . . . . . . . . . . . . . . 51

5.2.1 Subgradient Solution . . . . . . . . . . . . . . . . 52

5.2.2 Constraint Generation Solution . . . . . . . . . . 53

5.3 Static and Dynamic Analysis . . . . . . . . . . . . . . . 53

5.3.1 Static Solution . . . . . . . . . . . . . . . . . . . 54

5.3.2 Dynamic Solution (Rolling-Horizon and Relax-
and-Fix) . . . . . . . . . . . . . . . . . . . . . . . 55

5.4 Uncertainty Solution . . . . . . . . . . . . . . . . . . . . 58

5.4.1 Prototype Simulator . . . . . . . . . . . . . . . . 58

5.4.2 Analysis . . . . . . . . . . . . . . . . . . . . . . . 60

5.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . 61

6 Conclusion 63

6.1 Contributions . . . . . . . . . . . . . . . . . . . . . . . . 63

6.2 Future Works . . . . . . . . . . . . . . . . . . . . . . . . 64

Bibliography 66

Appendix A Mathematical Proofs 71

A.1 Lagrangean Dual Problem Equivalence . . . . . . . . . . 71

iii



iv



List of Figures

1.1 Shuttle Tanker Scheduling Problem (STSP). . . . . . . . 2

2.1 Classical Optimization Fields. . . . . . . . . . . . . . . . 7

2.2 Lagrangean Dual Function l(?) (GUIGNARD, 2003). . 15

2.3 Bound Analysis (GUIGNARD, 2003). . . . . . . . . . . 20

2.4 Rolling-Horizon Strategy. . . . . . . . . . . . . . . . . . 21

2.5 Relax-and-Fix Strategy. . . . . . . . . . . . . . . . . . . 22

3.1 Fixed Travel Time Representation. . . . . . . . . . . . . 28

3.2 Variable Travel Time Representation. . . . . . . . . . . 30

5.1 Subgradient Convergence. . . . . . . . . . . . . . . . . . 53

5.2 Constraint Generation Convergence. . . . . . . . . . . . 54

v



vi



List of Tables

3.1 Instance Parameters. . . . . . . . . . . . . . . . . . . . . 42

5.1 Parameters for the Platforms. . . . . . . . . . . . . . . . 50

5.2 Parameters for the Shuttle Tankers. . . . . . . . . . . . 50

5.3 Operating Costs. . . . . . . . . . . . . . . . . . . . . . . 51

5.4 Primal Solution and LP Solution GAP. . . . . . . . . . . 51

5.5 Subgradient Parameters. . . . . . . . . . . . . . . . . . . 52

5.6 Solution for Planning Horizon T = 20. . . . . . . . . . . 54

5.7 Rolling-Horizon Solution. . . . . . . . . . . . . . . . . . 56

5.8 Relax-and-Fix Solution. . . . . . . . . . . . . . . . . . . 57

5.9 Solution Considering Uncertainties. . . . . . . . . . . . . 60

vii



viii



Chapter 1

Introduction

One of the many challenges in the Oil &amp;amp; Gas Industry is
the Petroleum Supply Planning Problem (PSPP). In this problem the
crude oil is produced in o?shore platforms which is then transferred
to onshore terminals by sub-sea pipelines or Dynamically Positioned
Tankers (DPTs), here simply called shuttle tankers. After arriving to
the onshore terminals, the crude oil is shipped to re?neries to supply
domestic demands with its sub-products which include: gaseous fuels,
liquid fuels (gasoline, kerosene and others), lubricants, para?n wax,
sulfur, petroleum coke, asphalt, petrochemicals, among others.

When deep water o?shore oil exploration is considered, in
most of the cases there are no pipelines available and the oil produced
by a group of wells must be stored in Floating Production Storage and
O?oading Units (FPSOs), or platforms for short. Although these plat-
forms have a large storage capacity, often they receive shuttle tankers
to perform o?oading operations. For the large number of platforms, a
?eet of shuttle tankers is needed due to high volume of oil that must be
transferred from the platforms to onshore terminals. This need gives
rise to the necessity of scheduling trips of shuttle tankers among plat-
forms and onshore terminals over a planning horizon. This problem
is known as the Shuttle Tanker Scheduling Problem (STSP) which is
illustrated in Figure 1.11. This scenario is composed by three platforms
(named FPSO 1, FPSO 2 and FPSO 3), two shuttle tankers (named

1Image Credit: Tracey Saxby, IAN Image Library
(ian.umces.edu/imagelibrary/).

1



2 Introduction

ST1 and ST2) and onshore terminals.

Onshore Terminals

FPSO 1

FPSO 2

FPSO 3

ST 1
ST 2

J-38

I-38

J-37

Figure 1.1 ? Shuttle Tanker Scheduling Problem (STSP).

The shuttle tanker scheduling problem can be viewed as a
business case. First, it is not acceptable to halt production at a platform
due to the lack of storage capacity. Besides being a complex operation,
the shutting o? wells is a risk procedure that can compromise future
production, since wells can take a considerable time to be brought back
to full operation and production downtime represents a major loss of
revenue. Second, the amount of oil left in the platforms incurs a loss
of revenue. In other words, the oil owner would have to pay interest
to access the money equivalent left in the platforms in the form of
oil. On the other hand, there is a cost to bring the oil to the onshore
terminals. This cost is related to the rental and operation of shuttle

2



Introduction 3

tankers. However, much more important than the costs involved in
the operation of shuttle tankers, is the need to keep the platforms
with su?cient storage capacity to receive the daily production of its
wells. Therefore, the optimization algorithm must guarantee a proper
o?oading of the platforms.

The scheduling of shuttle tankers is a logistics problem. Lo-
gistics decisions consist in deciding when and how materials should
be acquired, moved and stored and they can be divided in three hi-
erarchical levels: strategic, tactical and operational. Strategic is in
highest level and the decisions are planned considering the long-term
(usually over years). They deal with ?eet sizing, facility location and
layout and capacity sizing. Tactical decisions consider the medium-
term (months or quarterly) and deal with production and distribution
planning, transportation mode selection, storage allocations and order
picking strategies. Finally, in the lowest level, operational decisions deal
with warehouse order picking, shipment and vehicle dispatching and are
made on a daily basis using very detailed data (GHIANI; LAPORTE;
MUSMANNO, 2004). This dissertation deals with the tactical level,
since we assume that strategic decisions such as ?eet sizing, platforms
and onshore terminal location, layout and capacity sizing, are already
known.

For the platforms important constraints and parameters like
production rate, storage capacity, minimum volume of oil that the plat-
forms should have stored to guarantee stability, the number of shuttle
tankers that can o?oad platforms simultaneously and inventory bal-
ance equations should be considered. For the shuttle tankers, con-
straints and parameters like storage capacity, volume of oil to be of-
?oaded from platforms and the inventory balance play an important
role.

1.1 Objectives

The overall objective of this dissertation is the development,
validation and analysis of a Mixed-Integer Linear Programming Model
for scheduling shuttle tankers for o?shore oil o?oading operations. The
speci?c goals are the following:

? Extension of a previous formulation to account variable travel

3



4 Introduction

time for shuttle tankers and other operating constraints.

? Theoretical assessment of the computational hardness of the vari-
able travel-time formulation and its relation with preceding for-
mulation.

? Proposition and analysis of Lagrangean relaxation as strategy to
generate dual bounds.

? Computational analysis of the variable travel-time formulation
for scheduling shuttle tankers in representative o?shore oil ?elds.

? Computational analysis of dynamic optimization strategies to
handle large problem instances, namely the rolling-horizon and
relax-and-?x strategies.

1.2 Dissertation Organization

This dissertation is divided in six chapters. They are the
following:

? In chapter 2, some optimization background is presented. We de-
?ne what is optimization and what is an optimization model; the
concept of Integer Programming (IP) and Mixed-Integer Linear
Programming (MILP) and algorithms to solve it; the de?nition
of a relaxation and its relevance to solving optimization prob-
lems; scheduling and routing problems; and last but not least we
discuss about dynamic optimization methods used to solve the
Shuttle Tanker Scheduling problem.

? In chapter 3, we ?rst present a prior formulation for the STSP,
with ?xed travel times, and then propose a revised model with
variable travel times. A review of literature was carried out to
relate this dissertation to other technical works. The chapter ends
with theoretical results regarding some properties of the revised
model.

? In chapter 4, we present the Lagrangean relaxation of the STSP,
algorithms to solve the Lagrangean dual problem and the La-
grangean dual function decomposition.

4



Introduction 5

? In chapter 5, we propose an o?shore oil ?eld scenario for the
computational analysis and the computational set up. A bound
analysis regarding the Lagrangean relaxation and the linear re-
laxation of the problem is presented. The rolling-horizon and
relax-and-?x heuristics are compared with respect to their per-
formance in the scenario. Further, the rolling-horizon strategy
is evaluated in a prototype simulator which generates random
perturbations to the variables of the model.

? In chapter 6, we conclude the dissertation with a general view
and contributions of the work and propose some directions for
further research.

5



Chapter 2

Fundamentals

In this chapter, we present some optimization concepts con-
sidering Integer Programming (IP) and Mixed-Integer Linear Program-
ming (MILP) to provide the mathematical foundation for the work
developed in this dissertation.

2.1 Introduction to Mathematical Optimiza-
tion

A classical optimization problem is the Knapsack Problem
(NEMHAUSER; WOLSEY, 1988). In this problem we have a set of
items (each one with a mass and a price) and a knapsack. We would
like to know which is the most valuable collection of items that we can
carry, given a ?xed knapsack with a limited capacity. The selection
of the best items from a set, regarding some constraints (in this case,
the size of the knapsack), in order to maximize or minimize a quantity
can be a simple and direct way to illustrate optimization. This seems
trivial, however, optimization problems can become complex depending
on their nature and size.

An example of a Knapsack Problem taken from (FISHER,
1985) can be seen in Problem 2.1. KS is formed by Equations (2.1a)-
(2.1f) and represents the model of the Knapsack Problem. Equation
(2.1a) is called objective function or cost function and it is the quantity

6



Fundamentals 7

that we want to maximize. Equations (2.1b)-(2.1d) are the constraints
of the problem. The domain is established by Equation (2.1e) and
Equation (2.1f) de?nes the nature of the variables xj, j = 1, . . . , 4.

Problem 2.1 belongs to a set of problems classi?ed as Integer
Programming, since its variables xj, j = 1, . . . , 4 are integers. Besides
Integer Programming problems, the ?eld of optimization is composed
by other sets of problems. Figure 2.1 shows the main ?elds of optimiza-
tion.

KS : f = max
x

16x1 + 10x2 + 4x4 (2.1a)

s.t. :

8x1 + 2x2 + x3 + 4x4 ? 10 (2.1b)
x1 + x2 ? 1 (2.1c)
x3 + x4 ? 1 (2.1d)
0 ? xj ? 1, j = 1 . . . 4 (2.1e)
xj ?Z, j = 1 . . . 4 (2.1f)

CombinatorialROptimization

ConvexRandRNonsmoothROptimization

GlobalROptimization

IntegerRProgramming

Linear,RConeRandRSemidefiniteRProgramming

NetworkROptimization

NonlinearROptimization

RobustROptimization

StochasticRProgramming

DynamicRProgrammingHeuristics

Figure 2.1 ? Classical Optimization Fields.

7



8 Fundamentals

2.1.1 Integer Programming

A wide variety of practical problems can be formulated and
solved using integer programming: train scheduling, airline crew schedul-
ing, production planning, electricity generation planning and cutting
problems, among others (WOLSEY, 1998). An integer program has its
objective function and constraints linear and its variables are discrete
and continuous. A generic integer programming problem with only
integer variables is de?ned as follows:

IP : f = max
x

cTx (2.2a)

s.t. :

Ax ? b (2.2b)
x ? Zn+ (2.2c)

A is a m × n matrix, x and c are n-dimensional column
vectors and b is a m-dimensional column vector. Some variations of
Problem 2.2 are: mixed-integer linear programming (MILP), binary
integer programming (BIP) and combinatorial programming (CP).

Formulating an integer programming problem consists in de?n-
ing the parameters, variables, the set of constraints and the objective
function of the problem. According to Wolsey (1998) the concept of
polyhedron and formulation are de?ned as follows:

De?nition 1. A subset of Rn described by a ?nite set of linear con-
straints P = {x ?Rn : Ax ? b} is de?ned as a polyhedron.

De?nition 2. A polyhedron P ? Rn+p is a formulation for a set
X ? (Zn ×Rp) if and only if X = P ? (Zn ×Rp), X being the set of
all feasible solutions.

A problem can have an in?nite number of formulations. Con-
sidering that, it is possible to think that there should be a best one.
When the perfect formulation is obtained it does not matter if the inte-
ger programming or its linear relaxation is solved, since they will both
give the same result. Wolsey (1998) de?nes the ideal formulation as
follows:

De?nition 3. Given a set X ?Rn, the convex hull of X, denoted by
conv(X), is the convex combination of all points in X and it is de?ned

8



Fundamentals 9

as: conv(X) = {x : x =
?t
i=1 ?ix

i,
?t
i=1 ?i = 1,?i ? 0 for i = 1, . . . , t,

over all ?nite subsets {x1, . . . ,xt} of X}.

Considering De?nition 3 it is possible to conclude that conv(X)
is a polyhedron and its extreme points all lie in X.

2.1.2 MILPs

The Shuttle Tanker Scheduling problem, the focus of this dis-
sertation, belongs to a speci?c set of optimization problems classi?ed as
Mixed-Integer Linear Programming (MILP). MILPs are a subset of in-
teger programming problems whose objective function and constraints
are linear and variables are discrete and continuous. A generic MILP
problem is formulated as follows:

MILP : f = max
x,y

cTx + gTy (2.3a)

s.t. :

Ax ? b (2.3b)
Cy ? d (2.3c)
x ?Zn+ (2.3d)
y ?Rm+ (2.3e)

where c, g, x, y, b and d are vectors and A and C are matrices (all
vectors and matrices are with the right dimensions).

2.2 Solving Strategies

Considering the complexity of integer programming, some
strategies are necessary to solve this type of problems. In this sec-
tion we discuss in a basic way the Branch and Bound, Cutting Plane,
Branch and Cut and Heuristics. Other strategies like the Dantzig-Wolf
(based on column generation) and Benders' (based on row generation)
decompositions can also be employed, but will not be discussed.

9



10 Fundamentals

2.2.1 Branch and Bound

The branch and bound strategy can be seen as a decompo-
sition algorithm based on a divide and conquer approach, in which a
problem is broken into smaller and easier subproblems and its lower and
upper bounds are used to solve the original problem. This algorithm
has the structure of a tree, with nodes representing the subproblems
and the edges the constraints (or bounds) to be added to the new sub-
problems.

2.2.2 Cutting Plane

From De?nition 3 we can conclude that it is possible to re-
formulate an integer program as a linear program max{cTx : A?x ?
b?,x ? 0}. In other words, an optimal extreme point solution of a lin-
ear program is an optimal solution of an integer program provided that
P? = {x : A?x ? b?,x ? 0} = conv(X) (WOLSEY, 1998). The same
holds for MILPs.

For NP-Hard problems like the Shuttle Tanker Scheduling
problem it is very di?cult to describe conv(X). The aim of cutting
plane algorithms is to try to approximate conv(X) for a given instance.
Said that, an important concept is the de?nition of a valid inequality:

De?nition 4. An inequality ?Tx ? ?0 is a valid inequality for X ?
Rn if ?Tx ? ?0 for all x ? X.

Valid inequalities can be seen simply as constraints that are
satis?ed by all x ? X.

2.2.2.1 Chavátal-Gomory Procedure

Assuming that we do not have a family of valid inequalities,
we can use the Chavátal-Gomory procedure to obtain them (Theorem
1).

Theorem 1. Every valid inequality for the set X = P ?Zn, where
P = {x ? Rn+ : Ax ? b}, A is a m × n matrix with columns
{a1,a2, . . . ,an} and u ?Rm+ , can be obtained by applying the Chavátal-
Gomory procedure a ?nite number of times.

10



Fundamentals 11

The procedure is de?ned as follows:

1. The inequality
?n
j=1 uajxj ? ub is valid for P , since u ? 0 and?n

j=1 ajxj ? b is valid for P ,

2. The inequality
?n
j=1buajcxj ? ub is valid for P as x ? 0,

3. The right hand side must also be integer. Therefore, the inequal-
ity
?n
j=1buajcxj ?bubc is valid for X as x is integer.

Consequently, the procedure generated the valid inequality?n
j=1buajcxj ?bubc.

This procedure is su?cient to generate all valid inequalities
for an integer program. The challenge consists in de?ning the non-
negative weights vector u and verify how useful these valid inequalities
are for the problem at hand.

2.2.2.2 Cutting Plane Algorithm

Consider that X = P ?Zn and that we have a family F of
valid inequalities ?Tx ? ?0, (?,?0) ?F for X. The set F can contain
an enormous quantity of inequalities to be added a priori and some of
them may not be useful for the problem instance. An alternative is to
add valid inequalities from F interactively, so as to cut o? infeasible
solutions (solutions that violated some inequality of the family F)

First we solve the linear relaxation of the problem. The opti-
mal value is tested for being an integer solution. If not, we can search
for a linear inequality that separates this fractional solution from the
feasible set. The problem of ?nding such an inequality is called the sep-
aration problem and the inequality is a cut. When the cut is added to
the linear program, the current non-integer solution is no longer feasi-
ble to the relaxation. This process is repeated until an optimal integer
solution is reached or no cutting planes can be found.

Some other strategies to generate valid inequalities like the
Gomory's Fractional Cutting Plane Algorithm, the Gomory Mixed In-
teger Cut and Disjunctive Inequalities can also be used.

Ideally, we would ?nd Strong Valid Inequalities that are ex-
pected to be more e?ective and to lead to a stronger formulation. The

11



12 Fundamentals

interested reader may refer to Wolsey (1998) for a detailed discussion
on strong valid inequalities.

The possibility of introducing cutting planes on demand has
given rise to the Branch and Cut Method, a strategy based on branch
and bound which adds cutting planes at the nodes of the enumeration
tree. It is the branch and bound with cutting planes been generated
along its tree. Rather than reoptimizing fast at each node, like the
branch and bound strategy, the new philosophy attempts to tighten
the dual bound by introducing cutting planes and consequently reduce
the number of nodes. There is a trade-o? in the sense that if many
cuts are added at each node, reoptimizing can take much longer and
keeping all information in the tree can take much more memory.

2.2.3 Heuristics

Many practical problems that we wish to solve are NP-Hard
and approximation algorithms or heuristics play an important role in
that matter. Heuristics do not guarantee optimality, instead they at-
tempt to quickly achieve a good feasible solution (WOLSEY, 1998).
Greedy, local search, and genetic algorithms are examples of heuristics
for integer programming problems.

2.3 Lagrangean Duality

According to Geo?rion (1974), the relaxation of a optimiza-
tion problem (a maximization one) is de?ned as follows.

De?nition 5. The problem RPmax : max{g(x)|x ? W} is a relax-
ation of the problem Pmax : max{f(x)|x ? V}, with the same decision
variables x, if and only if:

1. The feasible set of RPmax contains the feasible set of Pmax, i.e.,
W ?V.

2. Over the feasible set of Pmax, the objective function of RPmax is
always equal or greater than the objective function of Pmax, i.e.,
?x ?V,g(x) ? f(x).

12



Fundamentals 13

Considering v(Pmax) the optimal value of problem Pmax, a
consequence of De?nition 5 is that v(RPmax) ? v(Pmax). In other
words, RPmax can be considered as an optimistic version of Pmax.

Two types of relaxations can be mentioned: the Linear Relax-
ation which ignores the integrality constraint on the decision variables
and the Lagrangean Relaxation which will be discussed below.

The objectives of relaxing a problem are two: obtain bounds
on the optimal value of complex problems; use their solutions, that most
of the cases are infeasible for the original problem, as initial points for
specialized heuristics to obtain a primal feasible solution.

2.3.1 Lagrangean Relaxation

The Lagrangean relaxation is a technique which can be used
to simplify an optimization problem and obtain dual bounds for the
objective function. This technique is presented and discussed in the
works of Guignard (2003), Geo?rion (1974), Fisher (1985) and Wolsey
(1998), among others.

A generic integer programming problem is given in Problem
2.4, where c, x, b and d are vectors and A and C are matrices (all
vectors and matrices are with the right dimensions). Suppose that the
set of constraints (2.4b) is complicating, in the sense that if we remove
it from the problem, it becomes easier to solve.

Z : f = max
x

cTx (2.4a)

s.t. : Ax ? b (2.4b)
Cx ? d (2.4c)
x ? X (2.4d)

where X de?nes the integrality constraints. The linear relaxation LP
of Z is obtained by dropping the integratility constraints from problem
(2.4), namely the problem given by Equations (2.4a) through (2.4c).

The Lagrangean relaxation of this problem is de?ned as fol-

13



14 Fundamentals

lows:

ZLGR : l(?) = max
x

cTx + ?T (b?Ax) (2.5a)

s.t. : Cx ? d (2.5b)
x ? X (2.5c)

where l(?) is the Lagrangean dual function. Note that Problem 2.5 is
a relaxation of Problem 2.4 for the following reasons:

1. The objective function cTx + ?T (b ? Ax) ? cTx, since ? ? 0
and b ? Ax ? 0 for any feasible solution of Problem 2.4. For
an infeasible solution of Problem 2.4, the added term will have
negative sign.

2. The feasible region of Problem 2.4 is contained in the feasible
region of Problem 2.5.

It is important to note that the bound provided by the La-
grangean dual function depends on which constraints were dualized.
The in?uence of the dualized constraints on the e?ectiveness of the
dual bound will be described latter in this chapter.

2.3.2 Lagrangean Dual Problem

Given the Lagrangean relaxation problem ZLGR, which ?
gives the tightest bound for the integer problem Z? The goal is to
minimize the increase that the dualized constraints provide in the ob-
jective function, meaning the minimization of l(?). From this arises
the Lagrangean dual problem:

ZLD : min
?

l(?) (2.6a)

s.t. : ? ? 0 (2.6b)

Let X = {x ? X : Cx ? d} be the set of feasible points of
the Lagrangean relaxation problem. Notice that X = {x1, . . . ,xm} is
a countable set assuming that the polyhedron {x ? Rn : Cx ? d} is
bounded.

Now, the Lagrangean dual function l(?) can be seen as the

14



Fundamentals 15

upper envelope of a set of a?ne functions of ? which lead to the fol-
lowing reformulation of ZLD:

ZLD : min
??0

l(?) = min
??0

max
x?X

f(x) + ?T (b?Ax)

= min ?

s.t. : ? ? f(x) + ?T (b?Ax), ?x ?X
? ? 0

The Lagrangean dual problem ZLD becomes a convex non-
di?erentiable piecewise-linear minimization problem of ? (Figure 2.2).
Considering the characteristics of problem ZLD, special algorithms like
the Subgradient method and the Constraint Generation Method can be
applied to ?nd the lowest upper bound for the optimal f.

? = 2 + ?(  2) 
?

cx b-Ax

? = 1 + cx ? (
1) 

1

2
cx

?

cx
k

b-Ax

b-Ax

? = k + cx ?( k ) 

cx

l(?)

Figure 2.2 ? Lagrangean Dual Function l(?) (GUIGNARD, 2003).

2.3.3 Subgradient Method

The Lagrangean dual function l(?) is known to be convex
and therefore can be minimized using descent methods (BAZARAA;
SHERALI; SHETTY, 2006; FISHER, 1985). Because l(?) is non-
di?erentiable, the gradient descent method is not applicable and there-

15



16 Fundamentals

fore the subgradient algorithm is an alternative.

Let x(?) denote a solution for the Lagrangean dual function
l(?) associated to ?. The ?rst step is computing the subgradient ?l(?)
for l at ?, which is easily obtained from x(?) as follows:

?l(?) = b?Ax(?) (2.7)

At each iteration k the subgradient method solves l(?k) to
obtain the dual solution xk(?k). Then, the subgradient ?l(?k) of l at
?k is computed according with Equation (2.7) and the updating rule
is used:

?k+1 = max{?k ?µk?l(?k),0}

to obtain the next Lagrange multiplier ?k+1, where µk &gt; 0 is a scalar.
The subgradient method is described by Algorithm 1. The input data
are the initial guess ?0 for the Lagrange multiplier vector, the ini-
tial step µ, the decrement of the step decµ and the maximum num-
ber of iterations itmax. While the maximum number of iterations is
not achieved, we solve the Lagrangean relaxation problem ZLGR for
the current ?k and update xk(?k) and the Lagrangean dual bound
actualLGRBOUND. Next, the subgradient and the Lagrange multiplier
?k+1 for the next iteration are computed. The policy for updating the
step of the method µ is done by checking if the Lagrangean dual bound
is decreasing in each iteration; if not, µ is multiplied by decµ.

Let {µk}?k=1 be a sequence of positive steps satisfying a con-
vergence condition such as the decreasing and non-summing condi-
tion, namely

??
k=1 µk = ? and limk??µk = 0. For such a step

sequence, the subgradient method yields a sequence of dual (upper)
bounds {l(?k)}?k=1 converging to l(?

?) (WOLSEY, 1998) which is the
lowest higher bound induced by the optimal dual solution ?? of the
Lagrangean dual problem ZLD. Although this method is not expensive
computationally, it does not have a stopping criteria and guarantees
convergence only in theory.

16



Fundamentals 17

Algorithm 1: Subgradient Method.

Data: ?0,µ,decµ, itmax.
Result: ?k that minimizes l(?).
prevLGRBOUND = 10e10;
actualLGRBOUND = 10e10;
while (it ? itmax) do

prevLGRBOUND ? actualLGRBOUND;
xk, actualLGRBOUND ? solve ZLGR for ?k;
subgradk ? (b?A?xk?k);
?k+1 ? max{0,?k ?µ?subgradk};
if (actualLGRBOUND &amp;lt;prevLGRBOUND) then

µ ? µ;
else

µ ? µ?decµ;
end
it = it + 1;

end

2.3.4 Constraint Generation Method

This method relies on the fact that the Lagrangean dual func-
tion l(?) is the upper envelope of a family of linear functions.

ZLD : = min ?

s.t. : ? ? f(x) + ?T (b?Ax), ?x ?X
? ? 0

where X is the set of all feasible solutions of the Lagrangean relaxation
ZLGR. At each iteration, the method generates constraints with the
following form:

? ? f(x) + ?T (b?Ax)

by solving the Lagrangean relaxation l(?k) for the current Lagrange
multiplier ?k to obtain the solution xk. These constraints are added
to those generated previously to form the linear programming master

17



18 Fundamentals

problem MP :

MP : ?k = min ? (2.8a)

s.t. : ? ? f(xl) + ?T (b?Axl), l = 1, . . . ,k (2.8b)
? ? 0 (2.8c)

whose solution yields the next iterate ?k+1 for the Lagrangean relax-
ation. The process terminates when ?k = l(?k+1), which is the optimal
value of the Lagrangean dual problem ZLD. The constraint generation
method is described in Algorithm 2. The entry data is the initial guess
?0 for the Lagrange multiplier. The algorithm runs until the optimal
value of the master problem MP (?k) is equal to the value of the La-
grangean dual function l(?k+1). In each iteration we solve the ZLGR
for the current ?k and and update the solution xk. Then, we calculate
the angular and coe?cients for the new cut to be added to the master
problem MP . The solution of the master problem generates the new
Lagrange multiplier ?MP to be used in the next iteration.

Algorithm 2: The Constraint Generation Method.

Data: ?0.
Result: ?k that minimizes l(?k).
while (?k 6= l(?k+1)) do

xk ? solveZLGR for ?k;
linearCOEF ? cTxk;
angularCOEF ? (b?A?xk);
AddCut(? ? linearCOEF + ?MP ?angularCOEF);
?MP ? solveMP;
?k+1 ? ?MP ;
k = k + 1;

end

2.3.5 Bound Analysis

According to Geo?rion (1974) it is possible to prove that the
Lagrangean dual problem ZLD is equivalent to the following Primal

18



Fundamentals 19

Relaxation:

PR : f = max
x

cTx (2.9)

s.t. :

Ax ? b (2.10)
conv{x ? X|Cx ? d} (2.11)

Proof.

v(ZLD) = min
??0

v(ZLGR) (2.12)

= min
??0

max
x
{cTx + ?T (b?Ax)|Cx ? d,x ? X} (2.13)

= min
??0

max
x
{cTx + ?T (b?Ax)|x ? conv{x ? X|Cx ? d}}

(2.14)

= max
x
{cTx|Ax ? b,x ? conv{x ? X|Cx ? d}} (2.15)

= v(PR) (2.16)

where v(ZLD), v(ZLGR) and v(PR) are respectively the optimal values
of the Lagrangean dual, Lagrangean relaxation and the Primal relax-
ation.

Equation (2.14) is true because the maximum of a linear func-
tion over a bounded, discrete set of points is equal to the maximum of
that linear function over the convex hull of this set of points. Equa-
tion (2.15) is true by linear programming duality because conv{x ?
Rn|Cx ? b,x ? X} is a bounded polyhedron and the problem in
Equation (2.15) is a feasible bounded linear program. This proof is
detailed in Appendix A.

Considering the demonstration above and Figure 2.3, it is
possible to make the following observations:

1. If conv{x ? X|Cx ? d} = {x|Cx ? d}, then v(Z) ? v(PR) =
v(ZLD) = v(LP), where v(Z), v(PR), v(ZLD) and v(LP) stand
for, respectively, to the optimal values of the original problem, the
primal relaxation, the Lagrangean dual problem and the linear
relaxation of the original problem. In this case, the Lagrangean
dual problem has the Integrality Property. In other words, if we

19



20 Fundamentals

solve the Lagrangean dual problem relaxing the integrality of its
integer variables, they would still get integer values. In this case,
the Lagrangean relaxation bound is equal to the linear relaxation
bound.

2. If conv{x ? X|Cx ? d} ? {x|Cx ? d}, then v(Z) ? v(PR) =
v(ZLD) ? v(LP) and the Lagrangean relaxation bound is better
than the linear relaxation bound.

{x?X Cx ? d} 

{x Cx ? d} 
{x Ax ? b} 

RELAX

KEEP

x 

x 

x 
x 

x 

x x x

{x|Ax ? b}?
{x?X |Cx? d}  

|

|
|

conv

conv

v(LP)

v(PR)

v(Z)

Figure 2.3 ? Bound Analysis (GUIGNARD, 2003).

2.4 Dynamic Optimization

Here we present the rolling-horizon and the relax-and-?x strate-
gies that were designed and implemented to solve the shuttle tanker
scheduling problem. A synthesis of these strategies is given below.

2.4.1 Rolling-Horizon Strategy

Consider that we would like to plan the trips of the shuttle
tankers for a planning horizon of length T periods. The rolling-horizon
strategy (RHS) (MOHAMMADI et al., 2010; LI; IERAPETRITOU,
2010; TANG; JIANG; LIU, 2010; BERALDI et al., 2008), as illus-
trated in Figure 2.4, consists in de?ning a time window, also called
prediction horizon (PH), which is smaller than the planning horizon

20



Fundamentals 21

T . The optimization algorithm runs over this time window and only
the actions of the ?rst period are implemented (highlighted in green).
Then, the time window slides one period towards the future, the state
of the system (state variables) is updated and the process is repeated
until reaching the end of the planning horizon T . In general this strat-
egy gives sub-optimal solutions for the problem but is useful to deal
with large problems instances.

i=1

i=2

i=T-PH+1

1 2 TPH

2 TPH

PHT-PH+1

Prediction Horizon (PH)

Prediction Horizon (PH)

Prediction Horizon (PH)

Figure 2.4 ? Rolling-Horizon Strategy.

2.4.2 Relax-and-Fix Strategy

The relax-and-?x strategy is a branch of the rolling-horizon
strategy (DILLENBERGER et al., 1994; MOHAMMADI et al., 2010;
BERALDI et al., 2008). Like the RHS, we de?ne a prediction hori-
zon smaller than the planning horizon T. The di?erence is that the
optimization algorithm also takes into account the periods beyond the
prediction horizon (highlighted in red). However, the variables beyond
are relaxed and the variables inside preserve their integral nature. Only
the actions of the ?rst period are implemented (highlighted in green).
Then, the time window slides one period towards the future, the state
of the system (state variables) is updated and the process is repeated
until reaching the end of the planning horizon T. Figure 2.5 illustrates
the process. Like the rolling-horizon, this strategy gives sub-optimal
solutions for the problem but is useful to deal with large problems in-

21



22 Fundamentals

stances.

i=1

i=2

i=T-PH+1

1 2 PH

2 PH

PHT-PH+1

Prediction Horizon (PH)

T

T

Prediction Horizon (PH)

Prediction Horizon (PH)

Figure 2.5 ? Relax-and-Fix Strategy.

2.5 Summary

In this chapter we introduced some optimization concepts
such as what is optimization and what is an optimization model using
as example the Knapsack problem. Following, we presented the concept
of Integer Programming (IP) and Mixed-Integer Linear Programming
(MILP) and made a brief discussion on strategies to solve IPs and
MILPs. We also introduced the concept of relaxation and its relevance
for solving optimization problems. Finally, a section was dedicated to
discuss rolling-horizon and relax-and-?x heuristics.

22



Chapter 3

Problem Formulation

In this chapter, we ?rst present a former formulation for the
shuttle tanker scheduling problem with ?xed travel times. Then, we
propose a revised new model which accounts with variable travel times.
Next, a review of literature is carried out to relate the new proposed
model to other technical works. The chapter ends with results regarding
some theoretical properties of the revised model.

3.1 Fixed Travel Time Formulation (FTTF)

In this section we present and discuss the formulation pro-
posed in (CAMPONOGARA; PLUCENIO, 2014) because this disser-
tation will extend this previous formulation to account for variable
travel times for shuttle tankers.

The following parameters appear in the formulation:

? F = {1, . . . ,F} is the set of platforms.

? S = {1, . . . ,S} is the set of shuttle tankers to be scheduled.

? T = {1, . . . ,T} is the set of periods, which de?nes a time horizon
of length T , over which the shuttle tanker moves and o?oad-
ing/uploading operations are to be carried out. The periods of
the horizon correspond to days.

23



24 Problem Formulation

? U = {0}?F is the set of platforms augmented with the onshore
terminal, represented by 0.

? G = (U,E) is a graph whose nodes U represent the positions where
shuttle tankers can be stationed, with E = U×U being the set of
arcs representing their possible moves.

? US0s ?U is the initial position and V D0s de?nes the initial volume
of oil stored in a shuttle tanker s, in m3, which establish the initial
conditions for the shuttle tankers.

? V Dmaxs is the storage capacity of tanker s in m
3.

? V F 0u is the initial oil stock, V F
max
u is the storage capacity and

V F minu is the minimum volume that should be stored, in m
3, in

a platform u.

? V F oflu,s is the pre-de?ned volume of oil, in m
3, that must be of-

?oaded from platform u by shuttle tanker s each time a shuttle
tanker visits the platform.

? QFtu is the daily production rate of oil to be produced by platform
u during period t, given in m3/day.

? Ch,tu is the inventory holding cost tied up to the oil left in plat-
forms, in $.

? Ct0,u is cost of a shuttle tanker trip between the onshore terminal
and a platform. This cost might be di?erent from the average
cost of tanker trips between platforms.

? Ctu,v is the cost of a trip between a given platform to another,
which is considered the same for all pairs of platforms since the
di?erences between these distances are negligible. In an o?shore
oil ?eld, the distances between platforms are relatively small with
respect to the distance to the onshore terminal.

The variables of the formulation are the following:

? xtu,s ? B = {0, 1} takes on value 1 if shuttle tanker s is at node u
at the end of period t, otherwise it assumes value 0. This variable
de?nes the scheduling of the shuttle tankers.

? vdts is the volume of oil stored in shuttle tanker s at the end of
period t, given in m3.

24



Problem Formulation 25

? vftu is the volume of oil stored by platform u at the end of period
t, in m3.

? vdaux,ts is an auxiliary variable used to implement the shuttle
tanker unloading at the onshore terminal, given in m3.

? yt0,s ? B takes on value 1 if tanker s arrives at or departs from
the onshore terminal during period t and 0 otherwise.

? ytu,s ? B takes on value 1 if tanker s arrives at platform u during
period t coming from another platform.

3.1.1 Formulation

After introducing all sets, parameters and variables, the STSP
can be cast as the following MILP:

P : min f =
?
u?F

?
t?T

Ch,tu
(
vftu ?V F

min
u

)
+
?
s?S

?
t?T

Ct0,uy
t
0,s

+
?
u?F

?
s?S

?
t?T

Ctu,vy
t
u,s (3.1a)

subject to: ?
u?U

xtu,s = 1, ?s ?S, ?t ?T ?{0} (3.2a)

??
?

x0u,s = 1, u = US
0
s

x0u,s = 0, ?u ?U \{US0s}
vd0s = V D

0
s

?s ?S (3.2b)

vf0u = V F
0
u, ?u ?F (3.2c)?

s?S
xtu,s ? 1, ?u ?F, ?t ?T (3.2d)

25



26 Problem Formulation

???
??

vftu = vf
t?1
u + QF

t
u ?

?
s?S

V F oflu x
t
u,s

vftu ? V F maxu
vftu ? V F minu

?u ?F,?t ?T (3.2e)

?????
????

vdaux,ts = vd
t?1
s +

?
u?F

V F oflu x
t
u,s

vdts ? V Dmaxs (1 ?xt0,s)
vdts ? vdaux,ts ?V Dmaxs xt0,s
vdts ? vdaux,ts

?s ?S,?t ?T (3.2f)

?yt0,s ? x
t
0,s ?x

t?1
0,s ? y

t
0,s, ?s ?S, ?t ?T (3.2g)

xtu,s ?x
t?1
u,s ?x

t?1
0,s ? y

t
u,s, ?u ?F, ?s ?S, ?t ?T (3.2h)

vdts ? 0, ?s ?S, ?t ?T ?{0} (3.2i)
vdaux,ts ? 0, ?s ?S, ?t ?T (3.2j)
vftu ? 0, ?u ?F, ?t ?T ?{0} (3.2k)
xtu,s ?{0, 1}, ?u ?U, ?s ?S, ?t ?T ?{0} (3.2l)
ytu,s ?{0, 1}, ?u ?U, ?s ?S, ?t ?T . (3.2m)

The objective function, de?ned by Eq. (3.1a), minimizes the
inventory holding in the platforms and the transportation costs of trips
among platforms and between the platforms and the onshore terminal.

To ensure that each shuttle tanker is exactly at only one node
(platform or onshore terminal) at the end of each period, constraint
(3.2a) is required. The initial conditions for the shuttle tankers are de-
termined by the set of constraints (3.2b). Constraint (3.2c) establishes
the initial volume of oil in the platforms and constraint (3.2d) ensures
that at most one shuttle tanker can perform o?oading operations in a
platform during a time period.

In the constraint set (3.2e), the ?rst one de?nes the inventory
balance at the platforms, along with their volume capacity bounds. The
inventory balance equation establishes that the current volume stored
in a platform consists of the volume in the previous period added to the
production and discounted the volume o?oaded by a shuttle tanker, if
stationed at the platform.

The constraint set (3.2f) establishes the inventory balance for

26



Problem Formulation 27

the shuttle tankers. The variable vdaux,ts de?nes the volume of oil in the
shuttle tanker at the end of a period, which corresponds to its previous
volume added by the amount taken from a platform (when xtu,s = 1).
Its stock will be driven to zero at the end of the period if the shuttle
tanker is positioned at the onshore facility (when xt0,s = 1). In other
words, every time a shuttle tanker visits the onshore terminal, it will
upload all of its volume of oil into the terminal.

The constraints (3.2g) and (3.2h) express the behavior of the
variables ytu,s. It is possible to see that according with Eq. (3.2g),

yt0,s ? |xt0,s ?x
t?1
0,s |. Since |x

t
0,s ?x

t?1
0,s | can be either 0 or 1: y

t
0,s = 1

when the value of the expression is 1 (meaning that a shuttle tanker
arrived or departed from the onshore terminal); otherwise, yt0,s = 0
(meaning that the shuttle tanker stayed at the onshore terminal). This
leads to the conclusion that yt0,s ?{0, 1}.

In Eq. (3.2h), the left-hand side can assume one of the values
in the set {?1, 0, 1}. If the value of the left-hand side is 1, ytu,s clearly
assumes value 1, meaning that a shuttle tanker arrived in a platform.
Otherwise, ytu,s ? 0 because it cannot be negative.

The remaining constraints (3.2i) through (3.2m) de?ne the
nature of the decision variables.

For this formulation it is possible to de?ne the vector of de-
cision variables ? = (vd,vdaux,vf,x,y) for any solution to P where
vd = (vdts : s ? S, t ? T ?{0}) and vdaux, vf, x, and y are de?ned
similarly.

The Fixed Travel Time Formulation (FTTF) for the STSP
can be represented by a directed graph G = (V,E) such as the simple
scenario illustrated in Figure 3.1. The brown nodes (labeled ?Fu?)
represent the platforms and the black node (labeled ?0?) represents the
onshore terminal. Based on this representation and the formulation, it
is possible to conclude the following:

? Every displacement between nodes is performed in exactly 1 pe-
riod of time no matter the distance among platforms or between
the onshore terminal and the platforms. Consider for instance
that 1 period of time is equivalent 1 day. This means that if in
a real operation the travel time for a shuttle tanker to go from
platform F2 to the onshore terminal is 1 day and to go from plat-
form F2 to platform F3 is half of a day (12 hours), so in terms of

27



28 Problem Formulation

the model they all will be performed in 1 period of time, which
takes 1 day for this instance.

? When an uploading or o?oading operation is scheduled, it takes
place in the same period of time used by the shuttle tanker to
travel to the node where the operation will happen.

0

F1

F2

F3

Figure 3.1 ? Fixed Travel Time Representation.

3.2 Variable Travel Time Formulation (VTTF)

This section extends the formulation of (CAMPONOGARA;
PLUCENIO, 2014) to consider variable travel time among the platforms
and between the onshore terminal and the platforms.

3.2.1 Problem Representation

For the extended formulation, the STSP can be represented
by a directed graph G = (V,E) such as in Figure 3.2. The brown nodes

28



Problem Formulation 29

(labeled ?Fu?) represent the platforms; the black node (labeled ?0?)
represents the onshore terminal; the blue nodes (labeled with positive
numbers) are control points, placed in the model to introduce variable
travel times. The control points can be used by the shuttle tankers
as waiting points, since they cannot perform o?oading operations at
a platform if there is already another shuttle tanker stationed at the
platform.

The possible moves for the shuttle tankers are represented
by the arcs in Figure 3.2. Each arc represents an one-period trip (one
period corresponds to one day). Note that the arcs do not represent
physical paths but regions where the shuttle tankers can travel. Each
shuttle tanker can perform two types of moves:

? go from node u to v, during a period t, along the arc (u,v) ?E;

? stay at node u, during a period t, represented by the self-loop
arcs (u,u) ? E. If the shuttle tanker performs this move when
visiting a platform, then an amount of oil can be o?oaded from
the platform; when visiting a control point (waiting point), it will
stay there without performing any action; and when visiting the
onshore terminal, the total volume of oil stored in its tanks will
be o?oaded.

The graph can be detailed as needed, enabling not only to
represent days with the arcs, but also hours or minutes.

3.2.2 Problem Formulation

The parameters required for problem statement are as follows:

? G = (V,E) is a graph representing the moves that shuttle tankers
can perform in one time period, where V = {0, . . . ,V} is the set
of nodes and E = V ×V is the set of arcs.

? The set of nodes is V = F ?I ? {0} with F being the set of
platforms, I the set of intermediate nodes, and 0 the onshore ter-
minal. It is assumed that E contains self-loops for the nodes, that
is {(u,u) : u ? V} ? E. A self-loop at a platform represents an
o?oading operation, whereas a self-loop at the onshore terminal

29



30 Problem Formulation

0

F1

F2

F3

1

2
3

4

5

6

Figure 3.2 ? Variable Travel Time Representation.

represents an uploading operation by a shuttle tanker. Self-loops
at the intermediate nodes model periods during which a shuttle
tanker is stationed.

? T = {1, . . . ,T} is the set of periods that de?nes a planning hori-
zon of length T, over which the shuttle tanker moves and o?oad-
ing/uploading operations are to be carried out. The periods of
the horizon correspond to days.

? S = {1, . . . ,S} is the set of shuttle tankers.

? V F 0u is the initial oil stock, V F
max
u is the storage capacity, and

V F minu is the minimum volume that should be stored in a platform
u ?F.

? QF min,tu and QF
max,t
u are the minimum and maximum volume of

oil, respectively, that can be produced by platform u ? F in the
period [Tt?1,Tt), t ?T .

? V D0s is the initial volume of oil stored in shuttle tanker s, V D
max
s

is its capacity, and US0s is the initial position of the shuttle tanker,
which can be a platform, the onshore terminal or a control point.

30



Problem Formulation 31

? V F ofl,min,tu,s and V F
ofl,max,t
u,s are the minimum and maximum vol-

ume of oil that can be o?oaded from platform u by shuttle tanker
s during period t.

? NSu is the maximum number of shuttle tankers that can o?oad
from a platform u or upload at the onshore facility (when u = 0).

The following variables are required:

? xs,tu,v ? B is 1 if shuttle tanker s moves from node u to v during
period t, which stretches from time Tt?1 to Tt, where B = {0, 1}.

? vftu is the volume of oil stored in platform u ?F at end of period
t, while ?vftu is the volume of oil produced during this period.

? vdts is the volume of oil stored in shuttle tanker s at the end of
period t.

? ?vdofl,tu,s is the volume of oil o?oaded from platform u or the
amount uploaded at the onshore facility by shuttle tanker s, dur-
ing period t.

A feasible route for shuttle tanker s ?S is established by the
following constraints:?

(v,u)?E

xs,tv,u =
?

(u,v)?E

xs,t+1u,v , u ?V, t ? (T\{T}?{0}), (3.3a)

?
(u,v)?E

xs,1u,v = 1, u = US
0
s, (3.3b)

xs,1u,v = 0, u ?V\{US
0
s )}, (u,v) ?E. (3.3c)

The initial stocks at the shuttle tankers and the platforms are
established by the following constraints:

vf0u = V F
0
u, u ?F (3.4a)

vd0s = V D
0
s, s ?S (3.4b)

The number of shuttle tankers that can perform o?oading
operations at the platforms and uploading operations at the onshore

31



32 Problem Formulation

terminal, simultaneously, is limited:?
s?S

xs,tu,u ? NSu, u ?F ?{0}, t ?T . (3.5)

The inventory balance at the platforms are regulated by the
following oil conservation equations for all u ?F, t ?T :

vftu = vf
t?1
u + ?vf

t
u ?

?
s?S

?vdofl,tu,s , (3.6a)

V F minu ? vf
t
u ? V F

max
u , (3.6b)

QF min,tu ? ?vf
t
u ? QF

max,t
u , (3.6c)

V F ofl,min,tu,s x
s,t
u,u ? ?vd

ofl,t
u,s ? V F

ofl,max,t
u,s x

s,t
u,u, s ?S. (3.6d)

The inventory balance at the shuttle tanker is governed the
following equations for all s ?S and t ?T :

vdts = vd
t?1
s ??vd

ofl,t
0,s +

?
u?F

?vdofl,tu,s , (3.7a)

vdts ? V D
max
s . (3.7b)

Oil transfer equations are necessary at the onshore facility for
all s ?S and t ?F:

?vd
ofl,t
0,s ? vd

t?1
s ?V D

max
s (1 ?x

s,t
0,0), (3.8a)

?vd
ofl,t
0,s ? vd

t?1
s , (3.8b)

?vd
ofl,t
0,s ? V D

max
s x

s,t
0,0, (3.8c)

Having introduced the notation and constraints, the prob-
lem of scheduling shuttle tankers to transport oil from platforms to an

32



Problem Formulation 33

onshore facility is cast as:

P : min f =
?
u?F

?
t?T

Ch,tu (vf
t
u ?V F

min
u )

+
?
u?F

?
t?T

Cup,tu (QF
max,t
u ??vf

t
u)

+
?

(u,v)?E

?
s?S

?
t?T

Cs,tu,vx
s,t
u,v (3.9a)

s.t. : (3.3)?(3.8) (3.9b)
vftu ? 0, u ?F, t ?T ?{0} (3.9c)
?vftu ? 0, u ?F, t ?T (3.9d)
xs,tu,v ?{0, 1}, (u,v) ?E, s ?S, t ?T (3.9e)
vdts ? 0, s ?S, t ?T ?{0} (3.9f)
?vdofl,tu,s ? 0, u ?F ?{0}, s ?S, t ?T (3.9g)

whose objective accounts for inventory holding cost, production below
capacity, and transportation costs where:

? Ch,tu is the inventory holding cost tied up to the oil left in plat-
forms, which represents the tax the oil company has to pay in
order to anticipate access to the money left in the platforms in
the form of oil.

? Cup,tu being the cost for under production at platform u ?F.

? Cs,tu,v being the cost for shuttle tanker s to travel along arc (u,v)
during period t.

An economic study should be carried out to de?ne values for
the following parameters: inventory holding cost (Ch,tu ), underproduc-
tion cost(Cup,tu ) and tanker-travel cost (C

s,t
u,v).

It is possible to de?ne ? = (vf,?vf,x,vd,?vdofl) as the
vector of decision variables for P where vf = (vftu : u ?F, t ?T ?{0})
and ?vf, x, vd, and ?vdofl are de?ned similarly. With these vector

33



34 Problem Formulation

de?nitions, the STSP can be recast in the following compact form:

P : min f(?) (3.10a)

s.t. : ? satisfies Eqs. (3.3)?(3.8) (3.10b)
? ? dom(f) (3.10c)

where dom(f) is the domain of f established by Eqs. (3.9c)-(3.9g).

3.3 Literature Review

Several models for optimizing oil transportation are found in
literature considering di?erent characteristics. In this section we relate
the new proposed model to other technical works. We divided this
literature in two subsections. In the ?rst one the works address the
same problem considered in this dissertation. The second one deals
with ship scheduling and oil transportation problems considering other
contexts.

3.3.1 Similar Works

In (ROCHA; GROSSMANN; ARAGãO, 2013), the authors
addressed the problem of transporting crude oil from o?shore platforms
to onshore terminals. This is a sub-problem of the Petroleum Supply
Chain Problem, and the objective is to obtain the optimal schedule for
the shuttle tankers, that satis?es economic and operational constraints
(re?nery demands, inventory capacity at the platforms and inventory
capacity at the terminals). In this problem, a company has several
platforms producing oil that is transported to terminals to supply re-
?neries. The platforms produce only crude oil and they can only receive
shuttle tankers of a speci?c class for o?oading operations. The trips
are only made between platforms and terminals, in others words, there
are no trips between platforms. It is assumed that the daily produc-
tion of each platform, the demands of the re?neries, the travel time
and routes between platforms and terminals are known in advance for
the entire planning horizon. Also, when a shuttle tanker o?oads a
platform, it must be loaded to full capacity. The number of shuttle
tankers is considered unlimited for each class of tanker. An initial for-
mulation is presented, which considers inventory balance equations and

34



Problem Formulation 35

storage capacity for the platforms and for the terminals. The cost func-
tion minimizes the transportation cost over the planning horizon. The
authors propose a reformulation of the inventory balance constraints,
named Cascading Knapsack inequalities, which has a special structure
that can be exploited by solvers. The new formulation accomplishes
to write those constraints as Knapsack Inequalities, in which inventory
variables are eliminated, bringing forth to a 0-1 integer programming
problem. The new formulation is as tight as the initial one, however,
its structure can be exploited by MILP solvers, as well as providing a
basis for the design of stronger formulations.

The work presented in (AIZEMBERG et al., 2014) and (ROCHA;
GROSSMANN; ARAGãO, 2013) deals with the same problem . This
work has two objectives. The ?rst one is to compare mathematical
formulations found in the literature for the oil transportation problem.
From that, the authors proposed a new formulation that outperformed
all previous ones when given to a solver. The second one is to propose
a column generation-based heuristics to solve di?cult instances of the
problem.

The formulation developed in this dissertation di?ers in some
aspects from the one presented in (ROCHA; GROSSMANN; ARAGãO,
2013). They are presented as follows:

1. Overall Objective. The work presented in (ROCHA; GROSS-
MANN; ARAGãO, 2013) aims to determine the optimal shipment
schedule in order to satisfy re?nery demands, avoid shutting down
the platforms and minimize the total cost of trips.

The formulation proposed in this dissertation has the goal to de-
termine the optimal schedule for the shuttle tankers, in order to
avoid shutting down platforms for lack of storage capacity, while
respecting operational constraints and minimizing a combination
of inventory holding, underproduction and total cost of trips (Net
Present Value - NPV).

2. Assumptions. In (ROCHA; GROSSMANN; ARAGãO, 2013),
the authors assume that o?oading operations must load the shut-
tle tankers to full capacity; the number of shipments per period
of time between each platform-terminal pair is limited to at most
one; the number of shutter tankers is unlimited; o?oading and
uploading operations and the displacement between a platform-
terminal pair are done in the same period of time.

35



36 Problem Formulation

For the formulation presented in this dissertation we considered
that the onshore terminal has unlimited capacity and the number
of shuttle tankers is limited.

3. Constraints. The work proposed in (ROCHA; GROSSMANN;
ARAGãO, 2013) considers inventory balance for platforms and
onshore terminals; re?nery demands; limited capacity for plat-
forms and onshore terminals; restrictions on the types of plat-
forms that can supply each onshore terminal and types of vessels
that can perform o?oading operations in each platform.

The work presented in this dissertation considered inventory bal-
ance for platforms and shuttle tankers; limited capacity for plat-
forms and shuttle tankers; network constraints; bounds for the oil
production rate and bounds for the volume of oil o?oaded from
a platform.

4. Output Decisions. As output, the model proposed in (ROCHA;
GROSSMANN; ARAGãO, 2013) provides for each period of time
if a shuttle tanker is assigned to o?oad a speci?c platform and
delivery oil at a speci?c onshore terminal.

The formulation proposed in this dissertation provides as output,
for each period of time, the schedule of the shuttle tankers, the
oil production rate and the amount of oil to be o?oaded at each
platform.

3.3.2 Related Works

The work of Rocha (2010) aims to solve the Petroleum Supply
Chain Problem (PSCP) at Petrobras. First, the author describes the
logistic process of petroleum supply to re?neries in a strategic, tactical
and operational hierarchical structure. In a general way, this problem
consists in planning the shipments of crude oil from platforms to re-
?neries on a daily basis. The crude oil can be nationally produced or
imported. The locally produced oil, mostly o?shore, can be transported
to onshore terminals by shuttle tankers or pipelines. The imported oil
is transported to the onshore terminals by shuttle tankers. At the on-
shore terminals, the stored oil can be exported or sent to re?neries to
supply its demands. The proposed mathematical model is based in
a network ?ow structure and a discrete time representation. At the
platforms, it is considered inventory balance constraints; limits in the

36



Problem Formulation 37

storage capacity; limits on the number of shuttle tankers that leave a
platform in each period; and limits on the number of shuttle tankers
that arrive at the onshore terminal in each period of time. Regarding
the onshore terminals, the source of crude oil can be from the platforms
or from an other terminal and a shuttle tanker can upload all its vol-
ume or only a partition of it at a speci?c terminal. Constraints such
as maximum capacity and inventory balance at the terminals are con-
sidered. For the re?neries, there is an optimal range of inventory that
should be respected. Volumes above (can generate logistical problems
for the re?nery) and below (re?nery may need to shut down production
units) that range are penalized. Also, an inventory balance constraint
and a strategic plan for the re?neries supply (always considering the
next two months) are considered. For the shuttle tankers, it is de?ned
a constraint on the maximum number of additional tankers needed dur-
ing the planning horizon. The objective function minimizes shipping
cost, penalty for out of range inventory at the re?neries, penalty for
deviation from the strategic planning and cost for additional tankers.

Al-Yakoob (1997) deals with the Oil Tanker Scheduling Prob-
lem for the Kuwait Petroleum Corporation (KPC). The problem con-
sists in ship crude oil and re?ned oil-related products from ports in
Kuwait to customers (ports) located in Europe, North America and
Japan. Deliveries are undertaken by KPC or by other shipping compa-
nies and two routes are available for the tankers. Each vessel is a full
shipload, and is characterizes by its type (oil, re?ned products, etc),
loading port, loading date, discharging port, and discharging date.

In (CHOI; TCHA, 2007), the authors propose a tight integer
programming model for the heterogeneous ?eet vehicle routing problem
and its linear programming relaxation is solved using Column Genera-
tion technique. The problems consists in de?ning a set of routs, each
starting and ending at a depot, for a heterogeneous ?eet of vehicles
which services customers with known demands. Each customer is visit
exactly one time and total demand of the route does not exceed the
capacity of the vehicle type assigned to it. The routing cost of a vehi-
cle is the sum of its ?xed cost and a variable cost related to the travel
distance. The objective is to minimize the total of routing costs and
the number of vehicles of each type is assumed to be unlimited. The
problem is represented in a direct graph and based in a discrete time
representation. The nodes represent the central depot and customers
and the arcs the available routes.

37



38 Problem Formulation

The works of (CHU et al., 2012) and (NISHI; YIN; IZUNO,
2011) address the problem of crude oil transportation among ports.
Chu et al. (2012) demonstrate how the crude oil transportation prob-
lem, by shuttle tankers or trucks, can be transformed in a single item lot
sizing problem with limited production and inventory capacity. In this
problem the crude oil is shipped from a supplier port to n client ports
to satisfy demands over a planning horizon of length T using a ?eet
of identical shuttle tankers with limited capacity. Constraints regard-
ing inventory capacity of customers are considered and vary in time.
The objective function consists in minimizing the total cost over the
planning horizon. The assumption that the number of tankers are un-
limited and demands are independent allows independent shipments to
customers, which can be seen as n independent problems. These prob-
lems can be transformed into n single item lot sizing problems with
limited production and inventory capacity, where the tanker capacity
corresponds to production capacity in classical lot sizing models.

In (JETLUND; KARIMI, 2004), the authors consider the
problem of scheduling of a ?eet of multi-parcel tankers engaged in ship-
ping bulk liquid chemicals. The work presents a MILP model and pro-
poses a decomposition strategy to transform the ?eet scheduling model
in several one-ship model, which solves in reasonable time.

3.4 Theoretical Results

3.4.1 NP-Hardness

Proposition 1. The problem of scheduling shuttle tankers is NP-Hard.

Proof. The computational hardness of P can be shown by a reduc-
tion from the Hamiltonian path. Let C denote the Hamiltonian path
problem for which one wants to ?nd a simple path visiting each node
of an undirected graph GC = (VC,EC), assuming w.l.o.g. that VC =
{1, . . . ,V}.

The reduction of C to P is as follows:

1. Generate graphG = (V,E) whereV = VC?{0}andE = {(u,v), (v,u) :
{u,v}? EC}?{(u,u), (0,u), (u, 0) : u ?V} with platforms corre-
sponding to the nodes of the original graph.

38



Problem Formulation 39

2. V F 0u = 1, V F
max
u = 1, and V F

min
u = 0 for each u ? F, where

F = VC and so that I = ?.

3. the planning horizon is T = {1, 2, . . . , 2V}, QF min,tu = QF max,tu =
0 for t = 1, 2, . . . , 2V ? 1 but QF min,2Vu = QF max,2Vu = 1 for all
u ?F.

4. S = {1} with US0s = 0, V Dmaxs = V , and V D0s = 0.

5. V F
ofl,min,t
u,1 = 0, V F

ofl,max,t
u,1 = 1 and NSu = 1 for all u ? F and

t ?T .

6. Ch,tu = 0 and C
up,t
u = 0 for all u ?F and t ?T .

7. C1,tu,v = 0 for all (u,v) ?E and t ?T .

Clearly C contains a Hamiltonian path if, and only if, P is
feasible.

If C has a Hamiltonian path H = ?u1, . . . ,uV ?, then the
shuttle tanker can visit the platforms in the order H, o?oading 1
unit from each platform following the route (0,u1), (u1,u1), (u1,u2),
(u2,u2), . . . , (uV?1,uV ), (uV ,uV ) which is clearly feasible in T = 2V
periods, since H is a Hamiltonian path and each platform will be empty
at time 2V , when one unit is required to be produced.

On the other hand, if C does not have a Hamiltonian path,
then the shuttle tanker cannot visit and o?oad the volume stored in
each platform during a planning horizon of 2V periods, which is re-
quired for all platforms to receive one unit of production at time 2V ,
thereby implying that P is infeasible.

3.4.2 Generalization

Proposition 2. The problem of scheduling shuttle tankers with variable
travel time generalizes the problem with unique travel time that was
presented in (CAMPONOGARA; PLUCENIO, 2014).

Proof. This generalization is demonstrated by means of a problem re-
duction. Let H be an instance of the scheduling problem with unique
travel time.

39



40 Problem Formulation

An instance Hvtt of the scheduling problem with variable
travel time corresponding to H is obtained as follows.

? Let the number of nodes be equal to the number of platforms
V = F, F = {1, . . . ,V}, V = F?{0} with I = ?, and G = (V,E)
with E = {(u,v) : u ?V,v ?V}. Notice that G will have two arcs
between each pair of nodes, as well as self-loops for all nodes.

? Let T = {1, . . . , 2T}, which will have twice the number of periods
in H because in this version a shuttle tanker travels and performs
an o?oading operation during a single period, whereas in the
variable travel-time version these operations are distinct.

? Let V F 0u = V F
zero
u , and V F

max
u and V F

min
u be as in H, and

NSu = 1 for all u ?F.

? Let QF max,tu be as given in H and QF min,tu = QF max,tu when t is
even, whereas and QF min,tu = QF

max,t
u = 0 when t is odd, for all

u ?F and t ?T .

? Let US0s = u
zero
s , V D

max
s be as in H, and V D0s = V Dzeros for all

s ?S.

? Let V F ofl,min,tu,s = V F
ofl,max,t
u,s = V F

ofl
u when t is even, whereas

V F ofl,min,tu,s = V F
ofl,max,t
u,s = 0 when t is odd for all u ? F, s ? S,

and t ?T .

? Let Ch,tu = c1 for t even and C
h,t
u = 0 for t odd, and C

up,t
u = 0 for

all u ?F, t ?T .

? Let C
s,t
0,u = C

s,t
u,0 = c2 when t is odd, whereas C

s,t
0,u = C

s,t
u,0 = ?

when t is even, for all u ?F, t ?T , and s ?S.

? Let Cs,tu,v = C
s,t
v,u = c3 when t is odd, whereas C

s,t
u,v = C

s,t
v,u = ?

when t is even, for all u ?F, v ?F\{u}, t ?T , and s ?S.

? Let Cs,tu,u = 0 for all u ?V, s ?S, and t ?T .

Let X(H) be a solution to the instance H. Then, a corre-
sponding solution X(Hvtt) to Hvtt is obtained as follows. For all t ?T ,
u,v ?V, and s ?S, de?ne xs,2t?1u,v = 1 and xs,2tv,v = 1 in X(Hvtt) if only
if xt?1u,s = 1 and x

t
v,s = 1 in X(H), whereas the remaining variables xs,tu,v

are set to zero.

40



Problem Formulation 41

From the structure of G, the de?nitions of the costs, produc-
tion planning, and o?oading operations, one can verify that at the end
of period 2t in X(Hvtt), the state of the platforms, shuttle tankers (po-
sition and volumes), and accumulated transportation and holding costs
will be the same at the end of period t in X(H).

Similar reasoning can show that a solution X(Hvtt) to Hvtt
corresponds to an equivalent solution X(H) to H. The shuttle tankers
in Hvtt can e?ectively move from one node to another only in odd-
number periods, or else stay stationed at any node in such periods
without incurring cost, while o?oading and uploading operations occur
only in even-numbered periods by moving along self-loops.

3.4.3 A Family of Valid Inequalities

Let x = (xs,tu,v : (u,v) ? E, s ? S, t ? T ) be a vector for
the xs,tu,v variables, and de?ne vectors vf, ?vf, vd, and ?vd in a
similar manner. Further de?ne ? = (x,vf,?vf,vd,?vd) as a vec-
tor encompassing all of the decision variables. Then, the polyhedron
P = {? : Ai? ? bi, Aii? = bii, ? ? 0, x ? 1} is a formulation for
the problem of concern in this work if the rows of the systems (Ai,bi)
and (Aii,bii) correspond to the constraints (3.3)-(3.8). This means
that X = P ? (Zsize(x) ×Rsize(?)?size(x)) with X being the feasible set.
According to convex analysis, the convex hull conv(X) of X is a poly-
hedron.

A valid inequality can be imposed on the number of o?oading
operations performed at a subset U ?F of the platforms until time t.

Let

AV FtU =
?
u?U

V F 0u +

t?
l=1

?
u?U

QF min,lu (3.11)

be the minimum accumulated volume by the platforms U at end of
period t. Then,

NOFtU =

?
AV FtU ?

?
u?U V F

max
u

max{V F ofl,max,lu,s : 1 ? l ? t, s ?S, u ?U}

?
(3.12)

is a valid lower bound on the number of o?oading operations that must

41



42 Problem Formulation

be performed at the platforms U from period 1 through t in order to
avoid capacity violation. This leads to the following valid inequality.

Proposition 3. Given a subset U ? F of the platforms and period t,
the inequality

t?
l=1

?
s?S

?
u?U

xs,lu,u ? NOF
t
U (3.13)

is valid for conv(X).

Table 3.1 ? Instance Parameters.

Platforms Storage Initial Minimum Maximum

Capacity Volume Production O?oading
V F maxu V F

0
u Rate Volume

[103bbl] [103bbl] QF min,lu V F
ofl,max,l
u,s

[103bbl/day] [103bbl]
1 1400 1100 180 500
3 1450 600 230 400

Consider the sample instance parameters shown in Table 3.1
and the platform set U = {1, 3}. Then,

AV F 10U = (600 + 1100) + 10(180 + 230) = 5800

max{V F ofl,max,lu,s : 1 ? l ? 10, s ?S, u ?U} = 500?
u?U

V F maxu = 1400 + 1450 = 2850.

Consequently, NOF 10U = d(5800 ? 2850)/500e = d5.9e = 6. Similar
calculations lead to conclude that NOF 19U = d13.28e = 14.

Let pt1,t2u,v = ?u1,u2, . . . ,ut2?t1+1? be a path in graph G from
u1 = u to ut2?t1+1 = v, such that uj 6= 0 for all j ? Jofl(pt1,t2u,v ) =
{1, 2, . . . , t2 ? t1 + 1}. Let Jofl(pt1,t2u,v ) ? J(pt1,t2u,v ) be the subset of max-
imum cardinality such that j ? Jofl(pt1,t2u,v ) if, and only, if j &amp;lt;|J|,
uj = uj+1 and uj ?F.

Proposition 4. For t1, t2 ?T with t2 &gt; t1 and u,v ?V\{0}, let pt1,t2u,v

42



Problem Formulation 43

be a given path in G. If, for a given shuttle tanker s ?S,?
j?Jofl(p

t1,t2
u,v )

V F ofl,minuj,s &gt; V D
max
s (3.14)

then the inequality

?
j?Jofl(p

t1,t2
u,v )

xs,t1+j?1uj,uj ? |Jofl(p
t1,t2
u,v )|? 1 +

t2?t1?
j=1

x
s,t1+j?1
0,0 (3.15)

is valid for conv(X).

3.5 Summary

In this chapter we presented a former formulation for the
shuttle tanker scheduling problem with ?xed travel times. Then, we
proposed a revised new model, which accounts with variable travel
times, and described its parameters, variables, constraints and objective
function. Next, a review of literature was carried out to relate the new
proposed model to other technical works.

The chapter ended with the presentation of theoretical re-
sults establishing the computational hardness of the problem and the
generalization of the previous model which assumes the travel times of
the shuttle tankers as ?xed. Also, a family of cutting planes derived
from the classic knapsack cover inequalities was presented.

43



Chapter 4

Lagrangean Duality

In this chapter we present the Lagrangean relaxation of the
shuttle tanker scheduling problem, algorithms to solve the Lagrangean
dual problem and the Lagrangean dual function decomposition.

4.1 Lagrangean Relaxation

The use of the Lagrangean relaxation technique for this prob-
lem is justi?ed by two factors:

1. The distance between the primal optimal solution and the lower
bound provided by the linear relaxation is signi?cantly high. The
technique can be used to try to obtain tighter bounds for the
primal problem.

2. The technique provided signi?cantly better bounds than the lin-
ear relaxation in the work presented in (CAMPONOGARA; PLUCE-
NIO, 2014).

We can use the Lagrangean relaxation to obtain lower bounds
for the Shuttle Tanker Scheduling Problem with Variable Travel Time
by dualizing the coupling constraints (3.5) and (3.6a). To this end, let

? = (?(3.5),?(3.6a)) where ?(3.5) = (?
(3.5),t
u ? 0 : u ? F ?{0}, t ? T )

44



Lagrangean Duality 45

and ?(3.6a) = (?
(3.6a),t
u ? R : u ? F, t ? T ) are vectors of Lagrange

multipliers associated with constraints (3.5) and (3.6a), respectively.

The Lagrangean dual function l(?), with respect to ?, con-
sists in solving the following Lagranagean subproblem:

LGR(?) : l(?) = min
?

f(?) +
?

u?F?{0}

?
t?T

?(3.5),tu

(?
s?S

xs,tu,u ?NSu

)

+
?
u?F

?
t?T

?(3.6a),tu

(
vftu ?vf

t?1
u ??vf

t
u +

?
s?S

?vdofl,tu,s

)
(4.1a)

s.t. : ? satisfies Eqs. (3.3)?(3.4), (3.6b)?(3.6d), (3.7)?(3.8) (4.1b)
? ? dom(f) (4.1c)

where dom(f) is the domain of f established by Equations (3.9c)-(3.9g).
It is important to note that the bound provided by the Lagrangean dual
function depends on which constraints were dualized.

A Lagrange vector ? = (?(3.5),?(3.6a)) is dual feasible if

?(3.5) ? 0, while ? is primal feasible if ? ? dom(f) and further satis?es
Equations (3.3)-(3.8). From duality theory, l(?) ? f(?) for any dual
feasible ? and primal feasible ? (BAZARAA; SHERALI; SHETTY,
2006).

Having introduced the Lagrangean dual function, we want to
?nd ? that gives the tightest lower bound for problem P . By maximiz-
ing the Lagranagean dual function l(?) we obtain the Lagrangean dual
problem:

LD : max
?

l(?) (4.2a)

s.t. : ?(3.5) ? 0 (4.2b)

?(3.6a) ? R (4.2c)

? = (?(3.5),?(3.6a)) (4.2d)

This is a concave, non di?erentiable and piecewise linear maximization
problem on ?. Two methods were implemented to solve the Lagrangean
dual problem: the subgradient method and the constraint generation
method. The numerical results will be described in Section 5.2.

45



46 Lagrangean Duality

4.2 Lagrangean Dual Function Decomposi-
tion

It is possible to decompose the computation of the Lagran-
agean dual function l(?) in S+F subproblems, S being the number of
shuttle tankers and F the number of platforms.

From the structure of the primal problem P , the dualiza-
tion of the coupling constraints in the objective function renders the
Lagrangean dual function separable, with independent terms for the
shuttle tankers and platforms as follows:

l(?) =
?
s?S

ls(?) +
?
u?F

lu(?) ?
?

u?F?{0}

?
t?T

?(3.5),tu NSu

+
?
u?F

?
t?T

(
Cup,tu QF

max,t
u ?C

h,t
u V F

min
u

)
(4.3)

where ls and lu are computed by solving subproblems concurrently or
in parallel as de?ned below.

Given the Lagrange vector ?, lu(?) is calculated for platform
u ?F by solving:

Lu(?) : lu(?) =

= min
?
t?T

(
Ch,tu vf

t
u ?C

up,t
u ?vf

t
u

)
+
?
t?T

?(3.6a),tu
(
vftu ?vf

t?1
u ??vf

t
u

)
= min

?
t?T

(
Ch,tu + ?

(3.6a),t
u

)
vftu ?

?
t?T

(
?(3.6a),tu

)
vft?1u

?
?
t?T

(
Cup,tu + ?

(3.6a),t
u

)
?vftu

= min ??(3.6a),1u vf
0
u +

T?1?
t=1

(
Ch,tu + ?

(3.6a),t
u ??

(3.6a),t+1
u

)
vftu

+
(
Ch,Tu + ?

(3.6a),T
u

)
vfTu ?

?
t?T

(
Cup,tu + ?

(3.6a),t
u

)
?vftu (4.4a)

s.t. : vf0u = V F
0
u (4.4b)

46



Lagrangean Duality 47

{
V F minu ? vftu ? V F maxu
QF min,tu ? ?vftu ? QF max,tu

t ?T (4.4c)

vftu ? 0, t ?T ?{0} (4.4d)
?vftu ? 0, t ?T (4.4e)

which is a linear programming problem. Actually, Lu(?) is solved an-
alytically as follows:

vf0u = V F
0
u (4.5a)

vftu =

{
V F minu if (C

h,t
u + ?

(3.6a),t
u ??

(3.6a),t+1
u ) ? 0

V F maxu otherwise
for t ? (T\{T})

(4.5b)

vfTu =

{
V F minu if (C

h,T
u + ?

(3.6a),T
u ) ? 0

V F maxu otherwise
(4.5c)

?vftu =

{
QF max,tu if (C

up,t
u + ?

(3.6a),t
u ) ? 0

QF min,tu otherwise
for t ?T (4.5d)

Similarly, ls(?) is calculated for a shuttle tanker s ? S by
solving the MILP program:

Ls(?) : ls(?) = min
?

(u,v)?E

?
t?T

Cs,tu,vx
s,t
u,v

+
?

u?F?{0}

?
t?T

?(3.5),tu x
s,t
u,u

+
?
u?F

?
t?T

?(3.6a),tu ?vd
ofl,t
u,s (4.6a)

s.t. :
?

(v,u)?E

xs,tv,u =
?

(u,v)?E

xs,t+1u,v , u ?V, t ? (T\{T}?{0}) (4.6b)

47



48 Lagrangean Duality

?
(u,v)?E

xs,1u,v = 1, u = US
0
s (4.6c)

xs,1u,v = 0, u ?V\{US
0
s )}, (u,v) ?E (4.6d)

vd0s = V D
0
s (4.6e)

V F ofl,min,tu,s x
s,t
u,u ? ?vd

ofl,t
u,s ? V F

ofl,max,t
u,s x

s,t
u,u, u ?F, t ?T (4.6f)

???????
??????

vdts = vd
t?1
s ??vd

ofl,t
0,s +

?
u?F ?vd

ofl,t
u,s

vdts ? V Dmaxs
?vd

ofl,t
0,s ? vd

t?1
s ?V Dmaxs (1 ?x

s,t
0,0)

?vd
ofl,t
0,s ? vd

t?1
s

?vd
ofl,t
0,s ? V D

max
s x

s,t
0,0

t ?T (4.6g)

xs,tu,v ?{0, 1}, (u,v) ?E, t ?T (4.6h)

vdts ? 0, t ?T ?{0} (4.6i)

?vdofl,tu,s ? 0, u ?F ?{0}, t ?T (4.6j)

4.3 Summary

In this chapter we presented the Lagrangean relaxation of the
shuttle tanker scheduling problem. From the Lagrangean relaxation we
derived the Lagrangean dual problem which can be solved using the
subgradient and the constraint generation methods. At the end of the
chapter we presented the Lagrangean dual function decomposition that
generated S+F subproblems, S being the number of shuttle tankers
and F the number of platforms, which can be solved concurrently or in
parallel to reduce computational time.

48



Chapter 5

Computational Analysis

In this chapter we present a basic o?shore oil ?eld scenario
and the computational set up in which the analysis are carried out.
The ?rst analysis compares the Lagrangean dual bound with the linear
relaxation bound. The second analysis compares the static solution,
when the problem is solved for the entire planning horizon, with the
dynamic solution obtained using the rolling-horizon and relax-and-?x
heuristics. Finally, we evaluate the rolling-horizon strategy in a proto-
type simulator which generates random perturbations to the variables
of the model.

5.1 O?shore Oil?eld Scenario

The o?shore oil ?eld scenario is formed by 3 platforms, 2
shuttle tankers and 1 onshore terminal. Table 5.1 presents the following
parameters for the platforms:

? Storage capacity V F maxu , in 10
3bbl;

? Minimum volume that must remain on the platforms V F minu , in
103bbl;

? Initial volume V Fu(0), in 10
3bbl;

? Production rate interval [QF min,tu ,QF
max,t
u ], in 10

3bbl/day;

49



50 Computational Analysis

? Maximum and minimum o?oading volume where V F ofl,min,tu,s =

V F ofl,max,tu,s , in 10
3bbl;

where bbl and bbl/day stands for barrels and barrels per day respec-
tively.

Table 5.1 ? Parameters for the Platforms.

FPSO Storage Min. Initial Prod. O?oad.

Capacity Vol. Volume Rate Vol.
[103bbl] [103bbl] [103bbl] [103bbl/day] [103bbl]

1 1400 500 650 [75, 80] 450
2 1350 500 750 [95, 100] 500
3 1450 500 600 [125, 130] 400

Table 5.2 gives the required parameters of the shuttle tankers,
namely storage capacity (V Dmaxs ) and initial volume (V D

0
s).

Table 5.2 ? Parameters for the Shuttle Tankers.

Shuttle Capacity Initial

Tanker [103bbl] Volume
[103bbl]

1 2000 0
2 1800 0

For this scenario three categories of costs are de?ned and they
can be seen in Table 5.3. Parameter Cs,tu,v is the cost to travel from u
to v in dollars [$]; Cup,tu is the cost for under production in dollars per
barrel per day [$ ? barrel?1 ?day?1]; and Ch,tu represents the cost for
inventory holding in dollars per barrel per day [$?barrel?1?day?1]. It is
assumed that only one shuttle tanker can perform o?oading operations
in a platform at a time, however up to two shuttle tankers can perform
uploading operations at the onshore terminal simultaneously. Also, all
shuttle tankers are initially stationed at the onshore terminal.

The computational set up consisted in expressing the MILP
formulation of the scenario in AMPL (FOURER; GAY; KERNIGHAN,
2003), which was optimized with IBM ILOG CPLEX 12.2.0. The com-
putational experiments were performed in a workstation with an Intel
CPU i7 @ 2.00 GHz, Windows operating system and 8 GB of RAM.

50



Computational Analysis 51

Table 5.3 ? Operating Costs.

Operating Costs Ch,tu C
up,t
u C

s,t
u,v

[ $
bbl?day ] [

$
bbl?day ] [$]

Low Cost 17 17 15 000
Baseline Cost 17 17 45 000
High Cost 17 17 80 000

5.2 Lagrangean Dual Bound

Table 5.4 presents the solution of the original problem (Primal
Solution) and its respective linear relaxation bound (LP Solution) for
four lengths of planning horizon (T = 10, T = 15, T = 20 and T = 25
days). The scenario is presented in Section 5.1 and the baseline cost
is shown in Table 5.3. The GAP1 and the CPU Time, in seconds, for
solving the original problem are also presented. From Table 5.4, one
can observe two points as the planning horizon varies:

? The GAP is signi?cantly high and increases with the length of
the planning horizon.

? The CPU Time grows exponentially with the length of the plan-
ning horizon.

These observations motivate the search for tighter lower bounds. To
this end, the Lagrangean relaxation technique was applied.

Table 5.4 ? Primal Solution and LP Solution GAP.

Planning Primal LP GAP CPU

Horizon Solution Solution Time

[days] [103$] [103$] [s]

10 132 650 63 507.2 52.12% 0.515
15 229 150 63 957.2 71.76% 73.25
20 336 700 64 407.2 80.87% 1 282.09
25 462 100 64 857.2 85.96% 75 445.03

1GAP = P rimalSolution?LP Solution
P rimalSolution

? 100.

51



52 Computational Analysis

To ?nd optimal Lagrange multipliers, two methods were im-
plemented to solve the Lagrangean dual problem: subgradient and con-
straint generation. In this analysis, we consider the scenario presented
in Section 5.1, a planning horizon of T = 10 days and the baseline cost
shown in Table 5.3.

5.2.1 Subgradient Solution

The subgradient ?l(?) = (?l(?(3.5)),?l(?(3.6a))) for the La-
grangean dual function l(?) at ? is de?ned as follows:

?l(?(3.5),tu ) =
?
s?S

xs,tu,u ?NSu, u ?F ?{0}, t ?T (5.1a)

?l(?(3.6a),tu ) = vf
t
u ?vf

t?1
u ??vf

t
u +

?
s?S

?vdofl,tu,s , u ?F, t ?T

(5.1b)

Figure 5.1 shows the convergence of the subgradient method.
One can observe in green the primal solution P = 132 650 103$, in red
the LP bound LP = 63 507.2 103$ and in blue the bounds provided
by Lagrangean dual function l(?k) for all ?k. Table 5.5 presents the
chosen parameters of the subgradient method.

Table 5.5 ? Subgradient Parameters.

Parameters Value

Initial step size ?k 2.0
Step decrement ?dec 0.7
Number of iterations 3 000

Geo?rion (1974) shows that the Lagrangean relaxation must
provide a bound at least as good as the LP bound, which is not ac-
complished for this instance using the subgradient method (Figure 5.1).
This method has proved to be not practical for this instance since it
does not have a stopping criteria and guarantees convergence only in
theory.

52



Computational Analysis 53

0 500 1000 1500 2000 2500 3000
0

20

40

60

80

100

120

140

Iteractions

l(
?
)

[1
0

6 ]

Linear Relaxation Bound

Linear Relaxation Bound

Lagrangean Relaxation Bound

PrimalPOptimalPValue

PrimalPOptimalPValue

LagrangeanPBound

Figure 5.1 ? Subgradient Convergence.

5.2.2 Constraint Generation Solution

Figure 5.2 shows the convergence of the constraint generation
method. It is possible to observe in green the primal solution P =
132 650 103$, in red the LP bound LP = 63 507.2 103$ and in blue the
bounds provided by Lagrangean dual function l(?k) for all ?k.

The method converged after 141 iterations, providing a bound
LGR = 63 498 103$ which is approximately the same as the LP bound.
If the Lagrangean relaxation had provide a better bound than the LP
solution, it would be interesting to use it as the relaxation strategy
in the branch-and-bound strategy. However, for this instance the La-
grangean dual bound do not o?er advantages since it is almost the same
as the LP bound, although with a higher computation time.

5.3 Static and Dynamic Analysis

In this section we compare the results obtained from the static
and dynamic solutions. The static solution consists in solving the prob-
lem for the entire planning horizon T and the dynamic solution in solv-
ing the problem using rolling-horizon and relax-and-?x strategies to
respond to unanticipated events and large instances of the problem.

53



54 Computational Analysis

0 50 100 150
?150

?100

?50

0

50

100

150

Iteractions

l(
?
)d

[1
0

6 ]

PrimaldOptimaldValue

PrimaldOptimaldValue

LagrangeandRelaxationdBound

LineardRelaxationdBound

LineardRelaxationdBound

LagrangeandBound

Figure 5.2 ? Constraint Generation Convergence.

5.3.1 Static Solution

Here, we assume that there are no uncertainties in the op-
erations. In other words, there will not be shutdowns or failures at
the platforms, shuttle tankers or terminals; the production volume, the
o?oading and uploading volumes, among other parameters and vari-
ables, are known in advance for the entire planning horizon and will be
as predicted.

The computational results, for the three types of transporta-
tion cost, are shown in Table 5.6, for a planning horizon of T = 20.
CPU time (in seconds) is the time taken by CPLEX to ?nd the opti-
mal schedule.

Table 5.6 ? Solution for Planning Horizon T = 20.

Transportation Optimal Value CPU Time

Cost [103$] [s]

Low Cost 335 500 855.51
Baseline Cost 336 700 1282.09
High Cost 338 100 4215.17

54



Computational Analysis 55

5.3.2 Dynamic Solution (Rolling-Horizon and Relax-
and-Fix)

If uncertainties in the operations are not considered and re-
liable predictions of the parameters are known for the entire planning
horizon T, then it is possible to solve the problem and obtain an op-
timal solution. However, two di?culties can arise when we run the
optimizer for the entire planning horizon:

? Problem size. Depending on the size of the problem, determined
by the number of platforms, shuttle tankers and the length of the
planning horizon T , it can become hard to ?nd a feasible solution,
let alone an optimal one.

? Uncertainties. It is not reliable to schedule the shuttle tankers
over the planning horizon based only on the available predictions
at the current time. At the end of each period, the state variables
(the position of each shuttle tanker; the volume of oil of each ?oat-
ing platform; and the volume of oil of the shuttle tankers) may
di?er from what was planned due to uncertainties and thereby
should be revised.

To e?ectively respond to unanticipated events and handle
large instances of the problem, two strategies are considered to solve
the scheduling problem: rolling-horizon and relax-and-?x.

5.3.2.1 Rolling-Horizon Strategy (RHS)

Table 5.7 presents the computational results obtained by ap-
plying the RHS to the experimental scenario for a varying length of
the prediction horizon and considering the size of the planning horizon
as T = 20 days. The table gives the best value obtained with RHS,
the CPU time, and the solution GAP2, which is the relative distance
between the objective value induced by the RHS and the optimal so-
lution, namely the one obtained by solving the problem for the entire
planning horizon (see Table 5.6).

2GAP =
Rolling?HorizonBestV alue?OptimalV alue

OptimalV alue
? 100. The same formula is

applied to the relax-and-?x GAP.

55



56 Computational Analysis

By comparing the results depicted in Tables 5.6 and 5.7, for
the three types of transportation cost, it can be noticed that the RHS
achieves the optimal solution with a relatively short prediction horizon
and a substantially smaller CPU time. The RHS reaches the optimum
with only 11 periods for the PH, taking less than 50 seconds, whereas
the standard solution can take more than 4 000 seconds.

Table 5.7 ? Rolling-Horizon Solution.

Transp. Prediction Best GAP CPU

Cost Horizon Value Time

[days] [103$] [s]

7 367 800 9.62% 5.15
8 367 800 9.62% 6.85
9 367 800 9.62% 11.76

Low 10 367 800 9.62% 24.65
Cost 11 335 500 0% 40.01

12 335 500 0% 78.03
13 335 500 0% 145.60
14 335 500 0% 952.31
7 369 000 9.59% 5.23
8 369 000 9.59% 10.07
9 369 000 9.59% 11.32

Baseline 10 369 000 9.59% 22.68
Cost 11 336 700 0% 39.62

12 336 700 0% 95.00
13 336 700 0% 237.54
14 336 700 0% 625.76
7 370 400 9.55% 5.21
8 370 400 9.55% 8.03
9 370 400 9.55% 11.18

High 10 370 400 9.55% 22.48
Cost 11 338 100 0% 47.28

12 338 100 0% 93.78
13 338 100 0% 171.53
14 338 100 0% 453.79

56



Computational Analysis 57

5.3.2.2 Relax-and-Fix Strategy (RFS)

Table 5.8 gives the computational results for the experimental
scenario for a varying length of the prediction horizon and transporta-
tion costs. The size of the planning horizon is T = 20 days.

Table 5.8 ? Relax-and-Fix Solution.

Transp. Prediction Best GAP CPU

Cost Horizon Value Time

[days] [103$] [s]

7 335 500 0% 39.93
8 378 000 12.66% 100.73
9 335 500 0% 131.48

Low 10 364 400 8.61% 258.73
Cost 11 343 150 2.28% 447.89

12 343 150 2.28% 803.89
13 335 500 0% 1181.78
14 335 500 0% 1306.73
7 336 700 0% 42.12
8 379 200 12.62% 110.92
9 336 700 0% 148.15

Baseline 10 365 600 8.58% 287.76
Cost 11 344 350 2.27% 484.62

12 344 350 2.27% 907.37
13 336 700 0% 1079.23
14 336 700 0% 1415.57
7 338 100 0% 45.79
8 380 600 12.57% 86.59
9 338 100 0% 95.90

High 10 367 000 8.54% 210.64
Cost 11 345 750 2.26% 357.79

12 345 750 2.26% 791.23
13 338 100 0% 1267.92
14 338 100 0% 949.81

When Table 5.6 and 5.8 are compared, for all types of trans-
portation cost, it is possible to observe that the RFS presents a smaller
CPU Time. However, for some choices of prediction horizon, the CPU
time is higher and the relax-and-?x does not reach the optimal value.
A comparison between relax-and-?x and rolling-horizon suggests that

57



58 Computational Analysis

relax-and-?x can reach the optimum with a shorter prediction horizon,
however the behavior is somewhat erratic since solution quality can
deteriorate with the increase of prediction horizon length.

5.4 Uncertainty Solution

The goal of this analysis is to model uncertainties for the shut-
tle tanker scheduling operation and use the rolling-horizon strategy to
respond to these unanticipated events. A simulator is used to generate
the uncertainties. An analysis regarding the best value of the objective
function and di?erent lengths of prediction horizon is presented.

5.4.1 Prototype Simulator

At the end of each period of the planning horizon T , the
system can be characterized by three state variables:

? The volume of oil vftu at each platform u ?F;

? The volume of oil vdts in each shuttle tanker s ?S;

? The position v of each shuttle tanker s, considering that xs,tu,v = 1.

When the operation obeys the predictions, in other words,
there are no uncertainties or measurement errors, the values of the
state variables will be as planned for the entire planning horizon T .
However, in a real operational environment, variations in the predic-
tions may occur and they should be taken into account. Some examples
are described as follows:

? A platform can fully or partially halt the production due to tech-
nical problems. This may cause the oil production rate (?vftu)
to be out of the acceptable range [QF min,tu ,QF

max,t
u ], violating

constraint (3.6c).

? The volume (vftu) in a platform can be lower or higher than the
prediction due to a variation in the oil production rate (?vftu)
or in the o?oaded volume (?vdofl,tu,s ). This may cause an infea-
sibility problem, violating constraint (3.6b), in the minimum or
maximum volume of oil that a platform should have in storage.

58



Computational Analysis 59

? The volume in a shuttle tanker (vdts ) can vary depending on the
o?oaded volume from a platform (?vdofl,tu,s ), violating constraint
(3.7b).

? A shuttle tanker can stop operating due to technical problems or
maintenance reasons. In this case, the ?eet may have its capacity
diminished or a new shuttle tanker, with or without the same
capacities, can replace it. Also, a shuttle tanker may have to fol-
low another path due to the operator's decision or meteorological
conditions. In all cases, this change should be taken into account
in the optimization process.

One way to account for uncertainties and unanticipated events
consists in relying on feedback and reoptimizing at the end of each pe-
riod. The goal of designing a prototype simulator is to generate un-
certainties to simulate real operations. These uncertainties consist of
deviations from the predicted problem data. For the moment, we will
only consider variations on the oil production rate at the platforms
(?vftu). However, to represent in a more faithful way the uncertain-
ties that arise in operations, a much more complete simulator would be
necessary, taking into account the following situations:

? Variations in the oil production rate.

? Partial production reduction or complete shutdown of a ?oating
platform.

? Failure in a shuttle tanker.

? Interruption of operations at the onshore terminal.

? Deviation from the planned route of shuttle tankers.

? Measurement errors.

5.4.1.1 Modeling Uncertainty for the Oil Production Rate

To avoid economic loss, a platform must produce at its max-
imum capacity but uncertainties or unanticipated events can lead to
under production. For all u ? F and t ? T the simulator will gener-
ate the uncertainty parameter ??vfu,t for the oil production rate ?vf

t
u.

59



60 Computational Analysis

The uncertainty is modeled as follows:

??vfu,t = max
{

min
{
N(0,?2), 0

}
,??

}
(5.2)

where ??vfu,t is in barrels of oil per day and according to the model
will be limited to the range [??, 0]. N(0,?2) is a normal distribution
with mean 0 and standard deviation ?. If the parameter ??vfu,t = 0,

there are no uncertainties and if ??vfu,t = ?? the platform will have
its oil production rate diminished by ?.

5.4.2 Analysis

Table 5.9 shows the best values obtained using the rolling-
horizon strategy for several types of prediction horizon and three types
of standard deviation: ? = 0 (no uncertainties), ? = 500 and ? = 1000
barrels per day. We considered the scenario presented in Section 5.1,
a planning horizon of T = 25 days and the baseline cost parameters
shown in Table 5.3.

Table 5.9 ? Solution Considering Uncertainties.

Prediction Best Value Best Value Best Value

Horizon [103$] [103$] [103$]

[days] (for ? = 0 (for ? = 500 (for ? = 1 000

barrels/day) barrels/day) barrels/day)

7 407 105 441 846 439 205
8 398 605 441 889 439 343
9 398 605 441 892 439 355
10 406 510 459 777 457 346
11 405 150 459 848 449 037
12 395 375 451 364 449 098
13 403 620 451 364 449 098
14 402 175 448 049 445 783
15 382 030 427 060 425 006

The objective function of the problem accounts for three types
of costs: inventory holding, underproduction and traveling cost. Before
solving the problem using the rolling-horizon heuristic, intuition led us
to think that with the increase of the standard deviation the value of

60



Computational Analysis 61

the objective function would also increase since the oil production rate
would get lower. However, from Table 5.9, we observe, for all prediction
horizons, that the values using the standard deviation ? = 500 barrels
per day are the largest, followed up by the values using ? = 1000 barrels
per day and then by the values considering no uncertainties.

1. Traveling Cost3. The costs related to the trips of the shuttle
tankers were all the same for the three types of standard devia-
tion. However, they presented a di?erent schedule and performed
di?erent o?oading and uploading operations.

2. Underproduction Cost4. A higher value of the uncertainty
generates a smaller value for the oil production rate, which pro-
duces a higher value of underproduction. In that sense, the solu-
tion using ? = 1000 barrels per day had the higher cost related to
the underproduction, followed up by the solution using ? = 500
barrels per day and then by the solution with no uncertainties. Is
worth mentioning that the di?erences between the underproduc-
tion costs, for the three types of standard deviation, were small.

3. Inventory Holding Cost5. The solution using ? = 500 barrels
per day removed the smallest amount of oil from the platforms,
generating the largest inventory holding cost, followed up by the
solution using ? = 1000 barrels per day and then by the solution
with no uncertainties.

For this instance, the solution using ? = 500 barrels per day
achieved the largest values for its objective function, which was caused
by the impact of the inventory holding cost. However, since we are
dealing with heuristics it is not possible to generalize this analysis.

5.5 Summary

In this chapter we presented a basic o?shore oil ?eld sce-
nario and the computational set up in which the analysis were carried
out. The ?rst analysis consisted in comparing the Lagrangean dual

3Traveling Cost =
?

(u,v)?E
?

s?S
?

t?T C
s,t
u,vx

s,t
u,v.

4Underproduction Cost =
?

u?F
?

t?T C
up,t
u (QF

max,t
u ? ?vftu).

5Inventory Holding Cost =
?

u?F
?

t?T C
h,t
u (vf

t
u ? V Fminu ).

61



62 Computational Analysis

bound, obtained via the Lagrangean relaxation, with the linear relax-
ation bound. The subgradient and the constraint generation methods
were used to solve the Lagrangean dual problem.

Next we compared the static solution, when the problem is
solved for the entire planning horizon, with the dynamic solution ob-
tained using the rolling-horizon and relax-and-?x heuristics which in
general give sub-optimal solutions but perform well in large problems
instances and with unanticipated events such as uncertainties.

Closing the chapter, the rolling-horizon strategy was evalu-
ated in a prototype simulator which generated random perturbations
to the variables of the model.

62



Chapter 6

Conclusion

In this dissertation we have modeled and solved the Shuttle
Tanker Scheduling problem, an important sub-problem of the Petroleum
Supply Planning. The proposed model advances the previous work of
Camponogara e Plucenio (2014) by proposing a mathematical formula-
tion for scheduling shuttle tankers to account for variable travel times.
From the formulation, we were able to establish theoretical properties
such as the computational hardness, the generalization of the previ-
ous model and a family of cutting planes derived from classic knapsack
cover inequalities. In addition, we have presented Lagrangean duality,
Lagrangean decomposition and dual bounds obtained via subgradient
and constraint generation methods. Also, we developed rolling-horizon
and relax-and-?x heuristics for solving large instances of the problem
and to respond to uncertainties in the operations. Finally, these strate-
gies were evaluated computationally in a prototype simulator in order
to assess their e?ectiveness in response to uncertainties in operations.

6.1 Contributions

This dissertation achieved the following contributions:

? An MILP formulation for scheduling shuttle tankers for o?oading
operations in large o?shore oil ?elds with variable travel times for
the vessels.

63



64 Conclusion

? Theoretical properties establishing the computational hardness of
the problem and the generalization of the previous model which
assumes the travel times of the shuttle tankers as ?xed.

? A family of cutting planes derived from the classic knapsack cover
inequalities.

? Rolling-horizon and relax-and-?x heuristics for solving large prob-
lem instances.

? A prototype simulator to assess the e?ectiveness of the model and
the heuristics in response to uncertainties in operations.

? Lagrangean duality, Lagrangean decomposition and dual bounds
obtained by subgradient and constraint generation methods.

6.2 Future Works

There are some topics that were not investigated during the
dissertation and that we believe could generate signi?cant contribu-
tions:

? Implementation of the family of cutting planes and analysis of
the improvement on computational results in a typical o?shore
oil?eld scenario.

? Extension of the prototype simulator to include other uncertain-
ties such as partial production reduction or complete shutdown
of a ?oating platform; failure in a shuttle tanker; interruption of
operations at the onshore terminal; deviation from the planned
route of shuttle tankers; and measurement errors.

? Identify and treat degeneracies and symmetries, that are usually
present in scheduling problems, in order to reduce computation
time.

? Extend the proposed formulation to consider other constraints
such as inventory holding, inventory balance and limits on the
storage capacity at the onshore terminals; demands at the re-
?neries; platforms producing di?erent types of oil; restrictions on
which platforms can supply each onshore terminal; restrictions

64



Conclusion 65

on which tankers can o?oad each platform and upload each on-
shore terminal; oil batches at the onshore terminals reserved for
the exporting or originated from the importing or from pipelines.

? The necessity to take into account uncertainties has been recog-
nized as an important issue in logistics problems. Two problems
can arise. The ?rst one is how to model the uncertainties involved
in the problem. The second problem is that, usually, mathemat-
ical models that incorporate uncertainties have a large number
of variables and constraints, and are computationally hard to
solve. From that, some research directions can be pursued such
as: uncertainty modeling, development of stochastic formulations
to deal with uncertainties and the design of optimization strate-
gies to solve large-sized instances.

65



Bibliography

AHUJA, R.; MAGNANTI, T.; ORLIN, J. Network ?ows: theory, algo-
rithms, and applications. [S.l.]: Prentice Hall, 1993.

AIZEMBERG, L. et al. Formulations for a problem of petroleum trans-
portation. European Journal of Operational Research, v. 237, n. 1, p.
82?90, 2014.

AIZEMBERG, L. et al. Optimization model for the problem of oil trans-
portation with local search by MIP and simulation. In: Proceedings of
the XLIII Brazilian Symposium on Operations Research (SBPO). [S.l.:
s.n.], 2011.

AL-YAKOOB, S. Mixed-Integer Mathematical Programming Optimiza-
tion Models and Algorithms for an Oil Tanker Routing and Scheduling
Problem. Tese (Doutorado) ? Virginia Polytechnic Institute and State
University, 1997.

ASSIS, L. S. de; CAMPONOGARA, E.; PLUCENIO, A. A MILP for-
mulation for scheduling oil tankers for o?oading operations with vari-
able travel time. In: Proceedings of the International Conference on
Engineering Optimization. [S.l.: s.n.], 2014. p. 873?878.

BALAS, E. Facets of the knapsack polytope. Mathematical Program-
ming, v. 8, p. 146?164, 1975.

BALAS, E.; ZEMEL, E. Facets of the knapsack polytope from minimal
covers. SIAM Journal on Applied Mathematics, v. 34, n. 1, p. 119?148,
January 1978.

BANASZEWSKI, R. et al. Planning transport of crude oil derivatives
with simultaneous auctions. In: Proceedings of the IEEE International

66



BIBLIOGRAPHY 67

Conference on Systems Man and Cybernetics (SMC). [S.l.: s.n.], 2010.
p. 2820?2827.

BAZARAA, M. S.; SHERALI, H. D.; SHETTY, C. M. Nonlinear Pro-
gramming: Theory and Algorithms. 3rd edition. ed. [S.l.]: John Wiley
&amp;amp; Sons, 2006.

BERALDI, P. et al. Rolling-horizon and ?x-and-relax heuristics for
the parallel machine lot-sizing and scheduling problem with sequence-
dependent set-up costs. Computers &amp;amp; Operations Research, v. 35, n. 11,
p. 3644 ? 3656, 2008.

BURDEN, R.; FAIRES, J. Numerical Analysis. [S.l.]: Cengage Learn-
ing, 2004.

CAMPONOGARA, E.; PLUCENIO, A. Scheduling dynamically posi-
tioned tankers for o?shore oil o?oading. International Journal of Pro-
duction Research, v. 52, n. 24, p. 7251?7261, 2014.

CAMPONOGARA, E.; PLUCENIO, A.; PEREIRA, F. A model for
optimizing trips of dynamically positioned shuttle tankers for o?shore
oil transfer. In: Proceedings of the International Conference on Engi-
neering Optimization. [S.l.: s.n.], 2012.

CHOI, E.; TCHA, D.-W. A column generation approach to the het-
erogeneous ?eet vehicle routing problem. Computers &amp;amp; Operations Re-
search, v. 34, n. 7, p. 2080?2095, 2007.

CHU, C. et al. A polynomial dynamic programming algorithm for crude
oil transportation planning. IEEE Transactions on Automation Science
and Engineering, v. 9, n. 1, p. 42?55, 2012.

CROWDER, H.; JOHNSON, E. L.; PADBERG, M. Solving large-scale
zero-one linear programming problems. Operations Research, v. 31, n. 5,
p. 803?834, 1983.

DILLENBERGER, C. et al. On practical resource allocation for pro-
duction planning and scheduling with period overlapping setups. Euro-
pean Journal of Operational Research, v. 75, n. 2, p. 275?286, 1994.

FISHER, M. L. An applications oriented guide to lagrangian relaxation.
Interfaces, v. 15, p. 10?21, 1985.

FOURER, R.; GAY, D.; KERNIGHAN, B. AMPL: a modeling lan-
guage for mathematical programming. [S.l.]: Thomson/Brooks/Cole,
2003.

67



68 BIBLIOGRAPHY

GEOFFRION, A. M. Lagrangian relaxation for integer programming.
Mathematical Programming Study 2, p. 82?114, 1974.

GHIANI, G.; LAPORTE, G.; MUSMANNO, R. Introduction to Logis-
tics Systems Planning and Control. [S.l.]: Wiley, 2004. (Wiley Inter-
science Series in Systems and Optimization).

GHIANI, G.; LAPORTE, G.; MUSMANNO, R. Introduction to Lo-
gistics Systems Management. [S.l.]: Wiley, 2013. (Wiley Essentials in
Operations Research and Management Science).

GUIGNARD, M. Lagrangean relaxation. TOP: An O?cial Journal of
the Spanish Society of Statistics and Operations Research, Springer-
Verlag, p. 151?200, 2003.

HAKSEVER, C.; RENDER, B. Service Management: An Integrated
Approach to Supply Chain Management and Operations. [S.l.]: Pearson
Education, 2013.

JETLUND, A. S.; KARIMI, I. Improving the logistics of multi-
compartment chemical tankers. Computers &amp;amp; Chemical Engineering,
v. 28, n. 8, p. 1267 ? 1283, 2004.

LI, Z.; IERAPETRITOU, M. G. Rolling horizon based planning and
scheduling integration with production capacity consideration. Chemi-
cal Engineering Science, v. 65, n. 22, p. 5887?5900, 2010.

MOHAMMADI, M. et al. Rolling-horizon and ?x-and-relax heuristics
for the multi-product multi-level capacitated lotsizing problem with
sequence-dependent setups. Journal of Intelligent Manufacturing, v. 21,
n. 4, p. 501?510, 2010.

NEMHAUSER, G. L.; WOLSEY, L. A. Integer and Combinatorial Op-
timization. [S.l.]: Wiley-Interscience, 1988.

NISHI, T.; YIN, S.; IZUNO, T. Column generation approach to ship
scheduling problems for international crude oil transportation. In: Pro-
ceedings of the IEEE Conference on Automation Science and Engineer-
ing (CASE). [S.l.: s.n.], 2011. p. 468?473.

ROCHA, R. Petroleum supply planning: models, reformulations and
algorithms. Tese (Doutorado) ? Departamento de Informática, PUC-
Rio, 2010.

68



BIBLIOGRAPHY 69

ROCHA, R.; GROSSMANN, I. E.; ARAGãO, M. V. Poggi de.
Petroleum allocation at petrobras: Mathematical model and a solu-
tion algorithm. Computers &amp;amp; Chemical Engineering, v. 33, n. 12, p.
2123?2133, 2009.

ROCHA, R.; GROSSMANN, I. E.; ARAGãO, M. V. Poggi de. Cas-
cading knapsack inequalities: reformulation of a crude oil distribution
problem. Annals of Operations Research, v. 203, n. 1, p. 217?234, 2013.

SAWIK, T. Scheduling in Supply Chains Using Mixed Integer Program-
ming. [S.l.]: Wiley, 2011.

SILVA, T. L.; CAMPONOGARA, E. A computational analysis of mul-
tidimensional piecewise-linear models with applications to oil produc-
tion optimization. European Journal of Operational Research, v. 232,
n. 3, p. 630?642, 2014.

TAHA, H. Operations Research: An Introduction, 9/E. [S.l.]: Pearson,
2011.

TANG, L.; JIANG, S.; LIU, J. Rolling horizon approach for dynamic
parallel machine scheduling problem with release times. Industrial &amp;amp;
Engineering Chemistry Research, v. 49, n. 1, p. 381?389, 2010.

WOLSEY, L. Integer Programming. [S.l.]: John Wiley &amp;amp; Sons, 1998.

69



70 BIBLIOGRAPHY

70



Appendix A

Mathematical Proofs

A.1 Lagrangean Dual Problem Equivalence

In this section we intend to show in details the mathematical
proof of the following proposition:

Proposition 5. According to Geo?rion (1974) it is possible to prove
that the Lagrangean dual problem ZLD is equivalent to the following
Primal Relaxation:

PR : f = max
x

cTx (A.1)

s.t. : Ax ? b (A.2)
conv{x ? X|Cx ? d} (A.3)

Proof:

Consider the following generic integer programming problem:

Z : f = max
x

cTx (A.4a)

s.t. : Ax ? b (A.4b)
Cx ? d (A.4c)
x ? X (A.4d)

where c, x, b and d are vectors, A and C are matrices (all vectors and

71



72 Mathematical Proofs

matrices are with the right dimensions); and X de?nes the integrality
constraints.

Suppose that the set of constraints (A.4b) is complicating, in
the sense that if we remove it from the problem, it becomes easier to
solve. The Lagrangean relaxation of this problem is de?ned as follows:

ZLGR : l(?) = max
x

cTx + ?T (b?Ax)

s.t. : Cx ? d
x ? X

where l(?) is the Lagrangean dual function.

Given the Lagrangean relaxation problem ZLGR, which ?
gives the tightest bound for the integer problem Z? The goal is to
minimize the increase that the dualized constraints provide in the ob-
jective function, meaning the minimization of l(?). From this arises
the Lagrangean dual problem:

ZLD : min
?

l(?) (A.6a)

s.t. : ? ? 0 (A.6b)

Having introduced PR, ZLGR and ZLD, it is possible to write
the following:

v(ZLD) = min
??0

v(ZLGR) (A.7)

= min
??0

max
x
{cTx + ?T (b?Ax)|Cx ? d,x ? X} (A.8)

= min
??0

max
x
{cTx + ?T (b?Ax)|x ? conv{x ? X|Cx ? d}}

(A.9)

where v(ZLD) and v(ZLGR) are respectively the optimal values of
the Lagrangean dual and the Lagrangean relaxation. Assuming that
{x ? Rn : Cx ? d} is a bounded polyhedron, the step of going from
Equation (A.8) to Equation (A.9) is true because the maximum of a
linear function over a bounded, discrete set of points is equal to the
maximum of that linear function over the convex hull of this set of
points.

Let X = {x ? X : Cx ? d} be the set of feasible points of

72



Mathematical Proofs 73

the Lagrangean relaxation problem. Notice that X = {x1, . . . ,xm} is
a countable set assuming that the polyhedron {x ? Rn : Cx ? d} is
bounded.

Now, the Lagrangean dual function l(?) can be seen as the
upper envelope of a set of a?ne functions of ? which lead to the fol-
lowing reformulation of ZLD:

v(ZLD) = min
??0

l(?) = min
??0

max
x?X

cTx + ?T (b?Ax)

= min ?

s.t. : ? ? cTx + ?T (b?Ax), ?x ?X
? ? 0

= min ?

s.t. : ? ??T (b?Ax) ? cTx, ?x ?X
? ? 0

which is a linear programming problem. This problem can be placed
in a matrix form as follows:

v(ZLD) = min
??0

? (A.10a)

s.t. :

?
????

1 ?(b?Ax1)T
1 ?(b?Ax2)T
...

...
1 ?(b?Axm)T

?
????×

[
?
?

]
?

?
????
cTx1

cTx2

...
cTxm

?
???? (A.10b)

? ? 0 (A.10c)

In a linear programming problem, the optimal values of the
objective function of the primal and dual problem are equal (strong du-
ality). The dual of the primal Problem (A.10), with variables µ1, . . . ,µm

being the dual variables associated with each constraint, can be de?ned

73



74 Mathematical Proofs

as:

v(ZLD) = max c
Tx1µ1 + cTx2µ2 + . . . + cTxmµm (A.11a)

s.t. :

µ1 + µ2 + . . . + µm = 1 (A.11b)

µj ? 0, j = 1, . . . ,m. (A.11c)

[
?(b?Ax1) . . . ?(b?Axm)

]
×

?
?? µ

1

...
µm

?
?? ?

?
?? 0...

0

?
?? (A.11d)

which can be rewritten as:

v(ZLD) = max
x

cTx (A.12a)

s.t. : Ax ? b (A.12b)
µ1 + µ2 + . . . + µm = 1 (A.12c)

x = x1µ1 + x2µ2 + . . . + xmµm (A.12d)

µj ? 0, j = 1, . . . ,m. (A.12e)

Notice that Equations (A.12c), (A.12d) and (A.12e) de?ne
the convex hull of the set X = {x1, . . . ,xm}. Hence,

v(ZLD) = max
x

cTx (A.13)

s.t. : Ax ? b (A.14)
x ? conv{x ? X : Cx ? d} (A.15)

which is the de?nition of the Primal Relaxation. Therefore, v(ZLD) =
v(PR), that is, the Lagragean dual problem is equivalent to the Primal
Relaxation.

74


</field>
	</doc>
</add>