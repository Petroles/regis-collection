<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20254</field>
		<field name="filename">3726_318742.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA
PROGRAMA DE PÓS GRADUAÇÃO EM ENGENHARIA DE

AUTOMAÇÃO E SISTEMAS

Vinícius Gravina da Rocha

ESTRATÉGIAS DE LINEARIZAÇÃO POR PARTES ADAPTATIVAS
COM APLICAÇÕES À OTIMIZAÇÃO DA PRODUÇÃO DE

PETRÓLEO E GÁS

Florianópolis

2013





Vinícius Gravina da Rocha

ESTRATÉGIAS DE LINEARIZAÇÃO POR PARTES ADAPTATIVAS
COM APLICAÇÕES À OTIMIZAÇÃO DA PRODUÇÃO DE

PETRÓLEO E GÁS

Dissertação submetida ao Programa de Pós-
Graduação em Engenharia de Automação
e Sistemas para a obtenção do Grau de
Mestre.
Orientador: Prof. Eduardo Camponogara,
Ph.D.

Florianópolis

2013



Ficha de identificação da obra elaborada pelo autor,
 através do Programa de Geração Automática da Biblioteca Universitária da UFSC.

Rocha, Vinicius Gravina da
   Estratégias de linearização por partes adaptativas com
aplicações à otimização da produção de petróleo e gás /
Vinicius Gravina da Rocha ; orientador, Eduardo
Camponogara - Florianópolis, SC, 2013.
   132 p.

   Dissertação (mestrado) - Universidade Federal de Santa
Catarina, Centro Tecnológico. Programa de Pós-Graduação em
Engenharia de Automação e Sistemas.

   Inclui referências 

   1. Engenharia de Automação e Sistemas. 2. linearização
por partes adaptativa. 3. linearização por partes. 4.
otimização. 5. otimização da produção de petróleo e gás. I.
Camponogara, Eduardo. II. Universidade Federal de Santa
Catarina. Programa de Pós-Graduação em Engenharia de
Automação e Sistemas. III. Título.



Vinícius Gravina da Rocha

ESTRATÉGIAS DE LINEARIZAÇÃO POR PARTES ADAPTATIVAS
COM APLICAÇÕES À OTIMIZAÇÃO DA PRODUÇÃO DE

PETRÓLEO E GÁS

Esta Dissertação foi julgada aprovada para a obtenção do Título de
“Mestre”, e aprovada em sua forma final pelo Programa de Pós-Graduação
em Engenharia de Automação e Sistemas.

Florianópolis, 07 de março 2013.

Jomi Fred Hübner, Dr.
Coordenador do Curso

Prof. Eduardo Camponogara, Ph.D.
Orientador

Banca Examinadora:

Prof. Eduardo Camponogara, Ph.D.
Presidente

Profa. Katia Campos de Almeida, Ph.D.





Prof. Ubirajara Franco Moreno, Dr.

Prof. Agustinho Plucenio, Dr.





Aos meus pais, Maria Alice e Luiz Fernando,
com carinho.





AGRADECIMENTOS

Ao professor Eduardo Camponogara, fonte de inspiração com seu di-
namismo e sua inteligência, pela oportunidade de realizar este trabalho, além
de todo aprendizado ao longo do processo.

À Petrobras pelo apoio financeiro durante a realização deste projeto.
Aos meus pais e minha irmã, que sempre estiveram ao meu lado.
Aos amigos, que tornam a caminhada por esta vida mais divertida.





Build your empire, reach the top,
But don’t forget to enjoy the ride,
For we all know the final stop.

Vinicius Gravina da Rocha





RESUMO

O problema de otimizar a distribuição de gás de injeção a poços de petró-
leo e direcionar a produção para separadores sujeitos a restrições de vazão
é um problema não-linear inteiro-misto de considerável dificuldade. Uma
abordagem para resolver tais problemas consiste em transformar as funções
não-lineares em lineares por partes. Ainda assim, para se obter bons modelos,
as curvas são finamente discretizadas, o que torna o modelo complexo.

Para abordar este problema, é proposta a estratégia de gerar curvas li-
neares por partes de forma adaptativa. A adaptação é construída com um
subconjunto de breakpoints da função original de tal forma que a região do
ótimo coincida com a curva original. Este procedimento é nomeado Line-
arização por Partes Adaptativa, que busca iterativamente encontrar o ponto
ótimo, adaptando as curvas no seu entorno até que o problema convirja.

Para gerar novas adaptações, com um dado ponto ótimo, três heurísticas
são propostas: linear, na qual a região no entorno do ponto ótimo na curva
é adaptada; linear com pontos fixos, que é a mesma da linear, mas fixando
pontos distantes do ótimo ao gerar uma nova adaptação; e logarítmica, inspi-
rada no algoritmo de busca binária, segundo o qual os intervalos da adaptação
próximos ao ponto ótimo são subdivididos.

A Linearização por Partes Adaptativa é então aplicada na otimização da
produção de diferentes campos de petróleo e gás com Curvas de Desempe-
nho dos Poços unidimensionais. No geral, o tempo computacional é superior
a uma resolução sem a Linearização por Partes Adaptativa, i.e. a técnica não
trouxe ganhos para funções unidimensionais. Dentre as heurísticas lineares,
não houve ganho ao fixar os pontos, pois o maior custo computacional é gasto
não no problema de adaptação, mas no de otimização, que é resolvido diver-
sas vezes, uma para cada iteração.

Para os cenários com baixa disponibilidade de gás, a heurística linear
convergiu com menos iterações, pois o ponto ótimo foi encontrado no início
das curvas, que é uma região bem adaptada já na aproximação inicial. Para
maiores disponibilidades, a heurística logarítmica convergiu com um menor
número de iterações.

Por último, são estabelecidas as fundações para a Linearização por Par-
tes Adaptativa bidimensional. As heurísticas lineares e logarítmicas são es-
tendidas para este contexto e validadas em problemas simples de otimização.

Palavras-chave: linearização por partes, linearização por partes adaptativa,
otimização, otimização da produção de petróleo e gás.





ABSTRACT

The problem of optimizing the allocating lift-gas to oil wells and routing
the production to separators subject to flow constraints is a mixed-integer
non-linear problem of considerable difficulty. One approach for solving this
problem is to transform the non-linear functions into piecewise linear ones.
Still, for accurate models, some curves are finely discretized, what adds up to
the model complexity.

In order to tackle this problem, a technique is proposed to generate an
adapted piecewise-linear curve. The adaptation is constructed with a subset of
breakpoints from the original curve, in a way that the region of the optimum
coincides with the original curve. This procedure is named Adaptive Pie-
cewise Linearization, which consists of iteratively finding the optimal point
and adapting the curves on its neighborhood until convergence is reached.

In order to generate new adaptations for a given optimal point, three
heuristics are proposed: linear, which adapts the region close the optimal
point on the curve; linear with fixed points, which is the same as the linear,
but it fixes the breakpoints that are far from the optimum upon generating a
new adaptation; and logarithmic, inspired on the binary search, which divides
the intervals of the piecewise-linear adaptation close to the optimum.

The Adaptive Piecewise Linearization is then applied to optimize the
production of different oil and gas fields with unidimensional Wells Perfor-
mance Curves. In general, the computational time is greater than solving
without the Adaptive Piecewise Linearization. Among the linear heuristics,
gains from fixing the points are rather fruitless, for most computational time
is spent, not on the adaptation, but on the optimization problem, which is
solved many times, once for each iteration.

For scenarios with low availability of gas, the linear heuristic converged
with fewer iterations, because the optimal point is located close the beginning
of the curve, a region that is well adapted in the initial approximation. For
higher gas availability, the logarithmic heuristic converged with fewer iterati-
ons.

Lastly, the foundations for the bi-dimensional Adaptive Piecewise Line-
arization are laid. The linear and logarithmic heuristic are extended to this
context and are validated in some simple optimization problems.

Keywords: piecewise linear functions, adaptive piecewise linearization, op-
timization, oil and gas production optimization





LISTA DE FIGURAS

Figura 1 Preço histórico do petróleo: em azul, preço nominal e em ver-
melho, preço ajustado pela inflação. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
Figura 2 Ilustração do processo de gas-lift aplicado a um poço de pe-
tróleo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
Figura 3 Esquema ilustrativo de um campo de petróleo com processo
de extração por gas-lift. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
Figura 4 Exemplo ilustrativo de uma CDP. . . . . . . . . . . . . . . . . . . . . . . . . . . 35
Figura 5 Exemplo ilustrativo de uma CDP linearizada por partes. . . . . . 35
Figura 6 Exemplo ilustrativo da linearização por partes adaptativa: o
valor máximo da função linear por partes é encontrado por uma adaptação
com menos pontos que a função original. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Figura 7 Processo iterativo da linearização por partes adaptativa: encontra-
se o ponto ótimo e refina-se a linearização por partes nas proximidades
do ponto ótimo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Figura 8 Formulação da linearização por partes dos modelos por Com-
binação Convexa e Incremental. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
Figura 9 Formulação da linearização por partes do modelo por Combi-
nação Convexa Desagregada. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Figura 10 Exemplo de uma função linear por partes e uma adaptação não
otimizada. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
Figura 11 Exemplo de uma função linear por partes e com a adaptação
otimizada pelo modelo implementado em AMPL. . . . . . . . . . . . . . . . . . . . . . 47
Figura 12 Diagrama da iteração do problema de otimização com a adap-
tação da linearização por partes. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
Figura 13 Fluxo de dados entre a função original, o refinamento adapta-
tivo e o problema de otimização. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
Figura 14 Gráfico da função objetivo f (x)?x. . . . . . . . . . . . . . . . . . . . . . . . 49
Figura 15 Aproximação inicial f? para a função f . . . . . . . . . . . . . . . . . . . . . 51
Figura 16 Aproximação f? para a função f na iteração 1 usando a heurís-
tica linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Figura 17 Aproximação f? para a função f na iteração 2 usando a heurís-
tica linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
Figura 18 Aproximação f? para a função f na iteração 3 usando a heurís-
tica linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54



Figura 19 Aproximação f? para a função f na iteração 4 (última) usando
a heurística linear. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Figura 20 Aproximação inicial f? para a função f . . . . . . . . . . . . . . . . . . . . . 57
Figura 21 Aproximação f? para função f na iteração 1 usando a heurística
linear com pontos fixos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
Figura 22 Aproximação f? para função f na iteração 2 usando a heurística
linear com pontos fixos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59
Figura 23 Aproximação f? para função f na iteração 3 usando a heurística
linear com pontos fixos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
Figura 24 Aproximação f? para função f na iteração 4 (última) usando a
heurística linear com pontos fixos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61
Figura 25 Aproximação inicial f? para a função f . . . . . . . . . . . . . . . . . . . . . 64
Figura 26 Aproximação f? para função a f na iteração 1 usando a heurís-
tica logarítmica. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65
Figura 27 Aproximação f? para função a f na iteração 2 usando a heurís-
tica logarítmica. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figura 28 Aproximação f? para a função f na iteração 3 (última) usando
a heurística logarítmica. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
Figura 29 Esquema ilustrativo de um campo de petróleo com processo
de extração por gas-lift para formulação do modelo em programação ma-
temática. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Figura 30 Exemplo de discretização do domínio de uma função bidimen-
sional para aplicação do modelo por Combinação Convexa Desagregada
- DCC. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
Figura 31 Exemplo de partição retangular A com os vértices da adaptação
em destaque. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
Figura 32 Heurística linear para gerar novos retângulos no modelo bidi-
mensional. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106
Figura 33 Resultado da aplicação da heurística linear para gerar novos
retângulos no modelo bidimensional. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
Figura 34 Heurística logarítmica para gerar novos retângulos no modelo
bidimensional. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
Figura 35 Resultado da aplicação da heurística logarítmica para gerar
novos retângulos no modelo bidimensional. . . . . . . . . . . . . . . . . . . . . . . . . . . 111
Figura 36 Superfície gerada por pontos aleatórios. . . . . . . . . . . . . . . . . . . . . 112
Figura 37 Superfície gerada pela sobreposição de 3 Gaussianas. . . . . . . . 113
Figura 38 Adaptação inicial da superfície com pontos aleatórios. . . . . . . . 115



Figura 39 Adaptação da superfície com pontos aleatórios usando a heu-
rística linear, iteração 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
Figura 40 Adaptação da superfície com pontos aleatórios usando a heu-
rística linear, iteração 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
Figura 41 Adaptação da superfície com pontos aleatórios usando a heu-
rística linear, iteração 18 (última). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
Figura 42 Adaptação inicial da superfície composta por 3 Gaussianas. . . 117
Figura 43 Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
Figura 44 Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
Figura 45 Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 45 (última). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
Figura 46 Adaptação inicial da superfície com pontos aleatórios. . . . . . . . 119
Figura 47 Adaptação da superfície com pontos aleatórios usando a heu-
rística logarítmica, iteração 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
Figura 48 Adaptação da superfície com pontos aleatórios usando a heu-
rística logarítmica, iteração 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
Figura 49 Adaptação da superfície com pontos aleatórios usando a heu-
rística logarítmica, iteração 15 (última). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
Figura 50 Adaptação inicial da superfície composta por 3 Gaussianas. . . 121
Figura 51 Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Figura 52 Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Figura 53 Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 17 (última). . . . . . . . . . . . . . . . . . . . . . . . . . . 123





LISTA DE TABELAS

Tabela 1 Tempos computacionais e valores ótimos obtidos nas diferen-
tes instâncias dos campos de petróleo. Valores para a resolução sem o uso
da LPA. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
Tabela 2 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística linear sem pontos fixos — iterações, curvas adaptadas
e pontos ótimos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83
Tabela 3 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística linear sem pontos fixos — tempos computacionais. . . 84
Tabela 4 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística linear com pontos fixos — iterações, curvas adaptadas
e pontos ótimos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
Tabela 5 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística linear com pontos fixos — tempos computacionais. . . 86
Tabela 6 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística logarítmica — iterações, curvas adaptadas e pontos
ótimos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
Tabela 7 Otimização da produção de petróleo com modelo por aproxi-
mação e heurística logarítmica — tempos computacionais. . . . . . . . . . . . . . 88
Tabela 8 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística linear sem pontos fixos — iterações, curvas adaptadas e
pontos ótimos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
Tabela 9 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística linear sem pontos fixos — tempos computacionais. . . . . . 91
Tabela 10 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística linear com pontos fixos — iterações, curvas adaptadas e
pontos ótimos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
Tabela 11 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística linear com pontos fixos — tempos computacionais. . . . . 93
Tabela 12 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística logarítmica — iterações, curvas adaptadas e pontos óti-
mos encontrados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
Tabela 13 Otimização da produção de petróleo com modelo por relaxa-
ção e heurística logarítmica — tempos computacionais. . . . . . . . . . . . . . . . 95
Tabela 14 Parâmetros das Gaussianas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
Tabela 15 Iterações necessárias para se encontrar o máximo nas superfí-



cie usando as diferentes heurísticas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
Tabela 16 Quantidade de partições do domínio na última iteração de
adaptação, por heurística e por superfície. Também a quantidade de poli-
topos na função original. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124



LISTA DE ABREVIATURAS E SIGLAS

LPA Linearização por Partes Adaptativa . . . . . . . . . . . . . . . . . . . . . . . . 31
CDP Curva de Desempenho do Poço . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
CC Combinação Convexa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
DCC Combinação Convexa Desagregada . . . . . . . . . . . . . . . . . . . . . . . 38
MI Modelo Incremental . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38





LISTA DE SÍMBOLOS

qi Vazão de gás injetado . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

qo Vazão de óleo extraído . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

f Função linear por partes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

f? Adaptação da função linear por partes . . . . . . . . . . . . . . . . . . . . . . . . 39

?k Variável de ponderação do k-ésimo breakpoint . . . . . . . . . . . . . . . . 41

?k Variável de ativação do k-ésimo intervalo . . . . . . . . . . . . . . . . . . . . . 41

?
e
k Variável de ponderação do k-ésimo intervalo à esquerda . . . . . . . . 43

?
d
k Variável de ponderação do k-ésimo intervalo à direita . . . . . . . . . . 43

xi i-ésimo breakpoints da função linear por partes . . . . . . . . . . . . . . . . 45

X Conjunto de breakpoints da função linear por partes . . . . . . . . . . . 45

yi Valor da função linear por partes no i-ésimo breakpoint . . . . . . . . 45

Y Conjunto dos valores da função linear por partes nos seus respec-
tivos breakpoints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

N Conjunto de índices de breakpoints da função linear por partes . . 45

x?i i-ésimo breakpoints da adaptação da função linear por partes . . . 45

X? Conjunto de breakpoints da adaptação da função linear por partes 45

y?i Valor da adaptação da função linear por partes no i-ésimo break-
point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

Y? Conjunto dos valores da adaptação da função linear por partes nos
seus respectivos breakpoints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

M Conjunto de índices de breakpoints da adaptação da função linear
por partes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

Y? livre Conjunto de valores da adaptação da função que permanece livres
na otimização da adaptação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

Y? fixo Conjunto de valores da adaptação da função que permanece fixos
na otimização da adaptação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

L? Conjunto de intervalos da adaptação da função linear por partes . 45

li i-ésimo intervalo da adaptação da função linear por partes . . . . . . 45

Ni Conjunto de breakpoints da função original que estão contidos no
domínio do i-ésimo intervalo de adaptação (li) . . . . . . . . . . . . . . . . . . . . 45



x?k Valor no domínio onde foi encontrado o ótimo da k-ésima iteração 50

X?k Conjunto de breakpoints que geram a adaptação da função linear
por partes na k-ésima iteração . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

Bk Conjunto de breakpoints adicionados na k-ésima iteração para ge-
rar a próxima adaptação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

lk,i? Intervalo i? da adaptação onde foi encontrado o ótimo na k-ésima
iteração . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

j_start Índice do breakpoint da função original que é o início do inter-
valo onde foi encontrado o ótimo, i.e. x j_start é o breakpoint do início
do intervalo de lk,i? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

j_close_to Índice do breakpoint da função original próximo ao ponto
ótimo x?k encontrado, i.e. x j_close_to é o breakpoint próximo à x

?
k . . . . 64

j_hal f Variável usada pela heurística logarítmica para dividir os interva-
los . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

P Problema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

N Número total de poços considerados no problema . . . . . . . . . . . . . 70

N Conjunto de poços considerados no problema . . . . . . . . . . . . . . . . . 70

Ns Conjunto de poços cuja produção pode ser enviada ao separador
s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

S Número total separadores considerados no problema . . . . . . . . . . . 70

S Conjunto de separadores considerados no problema . . . . . . . . . . . . 70

Sn Conjunto de separadores que podem receber a produção do poço
n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

H Conjunto de fases do fluido, água (w), óleo (o) e gás (g) . . . . . . . . 70

g Fase gás . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

o Fase óleo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

w Fase água . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

p Produção, união das fases óleo, água e gás . . . . . . . . . . . . . . . . . . . . 70

qmaxi Vazão de gás de injeção disponível . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

qs,maxp Limite de tratamento da fase produção do separador s . . . . . . . . . . 70

qs,maxg Limite de tratamento da fase gás do separador s . . . . . . . . . . . . . . . 70

qs,maxo Limite de tratamento da fase óleo do separador s . . . . . . . . . . . . . . 70



qs,maxw Limite de tratamento da fase água do separador s . . . . . . . . . . . . . . 70

ln Limite inferior de vazão de injeção de gás no poço n . . . . . . . . . . . 70

un Limite superior de vazão de injeção de gás no poço n . . . . . . . . . . 70

f Função objetivo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

qni Vazão de injeção alocada ao poço n . . . . . . . . . . . . . . . . . . . . . . . . . . 71

fn Função ganho associada ao poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

pg Ganho obtido pela venda de um barril padrão de gás . . . . . . . . . . . 71

po Ganho obtido pela venda de um barril padrão de óleo . . . . . . . . . . 71

pw Custo de tratamento de um barril padrão de água . . . . . . . . . . . . . . 71

yn Variável binária que indica a ativação do poço n . . . . . . . . . . . . . . 71

zn,s Variável binária que indica a ativação do alinhamento do poço n
ao separador s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

qn,sh Vazão de fase h proveniente do poço n direcionada ao separador
s . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

qng Vazão de gás fluindo do poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

qno Vazão de óleo fluindo do poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

qnw Vazão de água fluindo do poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

P? Problema linearizado por partes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

qni,k k-ésimo ponto de amostragem da Curva de Desempenho do Poço
n do gás de injeção . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

qnh,k k-ésimo ponto de amostragem da Curva de Desempenho do Poço
n da vazão da fase h ? H . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

K Conjunto de intervalos gerados pela amostragem da Curva de De-
sempenho do Poço . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

P?approx Modelo por aproximação com Linearização por Partes Adaptativa 77

q?nh Superestimação da produção da fase h ? H no poço n . . . . . . . . . 77
q?nh Subestimação da produção da fase h ? H no poço n . . . . . . . . . . . 77
L?n Conjunto de intervalos gerados pela linearização por partes adap-

tativa para o poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

qni,l l-ésimo breakpoint de injeção de gás usado pela linearização por
partes adaptativa para o poço n . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

q?n,sh Superestimação da vazão de fase h do poço n para o separador s 77



qnh,l l-ésimo breakpoint da curva adaptada, gerados pela LPA, que su-
perestima a produção da fase h no poço n . . . . . . . . . . . . . . . . . . . . . . . . 77

q?n,sh Subestimação da vazão de fase h do poço n para o separador s . . 77

qnh,l l-ésimo breakpoints da curva adaptada, gerados pela LPA, que
subestima a produção da fase h no poço n . . . . . . . . . . . . . . . . . . . . . . . . 77

P?relax Modelo por relaxação com Linearização por Partes Adaptativa . . 78

D Domínio da função . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

P Politopo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

P Conjunto de politopos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

V (A) Conjunto de vértices do politopo A . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

?P,v Variável de ponderação associada ao vértice v do politopo P . . . . 100

Ak k-ésimo politopo retangular . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

V (Ak) Conjunto de vértices do politopo Ak . . . . . . . . . . . . . . . . . . . . . . . . . . 100

yP Variável de ativação do politopo P . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

vk,i Vértice i do k-ésimo politopo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
?k,i Variável de ponderação do k-ésimo politopo para o i-ésimo vér-

tice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

yP Variável binária que indica se um politopo P está ativo . . . . . . . . . 101

Xi(A) Conjunto de breakpoints da função original na dimensão i que
definem A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

xi,low(A) Menor breakpoint da i-ésima dimensão da função original per-
tencente a A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

xi,high(A) Maior breakpoint da i-ésima dimensão da função original per-
tencente a A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103

(a?,b?) Parâmetros do plano ótimo da adaptação . . . . . . . . . . . . . . . . . . . . . 104
(a,b) Parâmetros do plano da adaptação . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
f? (A,v) Valor da adaptação f no vértice v do politopo A . . . . . . . . . . . . . . . 104
A? Partição retangular onde foi encontrado o ótimo . . . . . . . . . . . . . . . 105

ci Índice do breakpoint de corte da i-ésima dimensão . . . . . . . . . . . . 107



SUMÁRIO

1 INTRODUÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
1.1 ORIGEM E MOTIVAÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
1.2 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES ADAPTATIVA 36
1.3 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
1.4 ESTRUTURA DA DISSERTAÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . 38
2 LINEARIZAÇÃO UNIDIMENSIONAL . . . . . . . . . . . . . . . . . . . . . . 39
2.1 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES UNIDIMEN-

SIONAL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
2.1.1 Modelo de Combinação Convexa Agregada - CC . . . . . . . . . . . 39
2.1.2 Modelo Incremental - MI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
2.1.3 Modelo de Combinação Convexa Desagregada - DCC . . . . . . 41
2.2 REFINAMENTO ADAPTATIVO . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
2.2.1 Modelagem Matemática da Adaptação . . . . . . . . . . . . . . . . . . . . 43
2.3 INTEGRAÇÃO ADAPTAÇÃO-PROBLEMA DE OTIMIZAÇÃO 48
2.3.1 Heurística Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
2.3.2 Heurística Linear com Pontos Fixos . . . . . . . . . . . . . . . . . . . . . . 56
2.3.3 Heurística Logarítmica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
2.4 SUMÁRIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
3 ANÁLISE COMPUTACIONAL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
3.1 MODELOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
3.1.1 Modelo Não-Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69
3.1.2 Modelo Linearizado por Partes . . . . . . . . . . . . . . . . . . . . . . . . . . 73
3.1.3 Modelo com Linearização por Partes Adaptativa . . . . . . . . . . . 74
3.1.3.1 Modelo com Linearização por Partes Adaptativa por Aproxi-

mação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
3.1.3.2 Modelo com Linearização por Partes Adaptativa por Relaxação 77
3.2 RESULTADOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
3.2.1 Cenários . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
3.2.2 Premissas para Avaliar os Resultados . . . . . . . . . . . . . . . . . . . . . 80
3.2.3 Indicadores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
3.2.4 Resultados sem uso da LPA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
3.2.5 Resultados com o Modelo por Aproximação . . . . . . . . . . . . . . . 83
3.2.6 Resultados com o Modelo por Relaxação . . . . . . . . . . . . . . . . . . 90
3.3 DISCUSSÃO DOS RESULTADOS . . . . . . . . . . . . . . . . . . . . . . . . . . 96
3.4 SUMÁRIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
4 LINEARIZAÇÃO POR PARTES BIDIMENSIONAL . . . . . . . . . . 99



4.1 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES BIDIMEN-
SIONAL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

4.1.1 Modelo de Combinação Convexa Desagregada Bidimensio-
nal - DCC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100

4.2 REFINAMENTO ADAPTATIVO BIDIMENSIONAL . . . . . . . . . . 101
4.2.1 Modelagem Matemática da Adaptação Bidimensional . . . . . . 102
4.3 INTEGRAÇÃO ADAPTAÇÃO BIDIMENSIONAL-PROBLEMA

DE OTIMIZAÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
4.3.1 Heurística Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
4.3.2 Heurística Logarítmica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
4.4 APLICAÇÃO DA LINEARIZAÇÃO POR PARTES ADAPTA-

TIVA BIDIMENSIONAL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112
4.4.1 Heurística Linear para Superfície de Pontos Aleatórios . . . . . 115
4.4.2 Heurística Linear para Superfície com Três Gaussianas . . . . 117
4.4.3 Heurística Logarítmica para Superfície de Pontos Aleatórios 119
4.4.4 Heurística Logarítmica para Superfície com Três Gaussianas 121
4.5 RESULTADOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
4.6 SUMÁRIO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
5 CONCLUSÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
5.1 CONTRIBUIÇÕES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
5.2 TRABALHOS FUTUROS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128
Referências Bibliográficas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129



31

1 INTRODUÇÃO

Neste capítulo é feita uma introdução à estratégia de Linearização por
Partes Adaptativa, abreviado por LPA. A ideia desta técnica surgiu no con-
texto da otimização da produção em campos de petróleo e gás, devido à
complexidade das curvas que modelam os poços produtores e as linhas de
escoamento.

Na primeira parte da introdução é detalhada a origem e motivação do
trabalho. Na segunda, é feita uma introdução ao conceito de LPA, seguido dos
objetivos deste trabalho. Por último é apresentada a estrutura da dissertação.

1.1 ORIGEM E MOTIVAÇÃO

Nos dias atuais, as questões energéticas tem sido foco de grande aten-
ção. Nos últimos anos, as reservas de petróleo de fácil acesso tem se esgo-
tado e por consequência tem-se observado um aumento no preço do barril de
petróleo, Figura 1 (BP, 2012). Este aumento fez com que reservas em maio-
res profundidades no oceano, antes inviáveis, possam ser exploradas (TSOS-
KOUNOGLOU; AYERIDES; TRITOPOULOU, 2008).

Neste contexto, o controle de custos e o gerenciamento da produção
se tornam importantes para se obter uma maior rentabilidade na extração do
petróleo. Com este objetivo, surge a disciplina de otimização como uma ex-
celente ferramenta para se atingir estes objetivos na produção de petróleo e
gás. Uma abordagem consiste em modelar matematicamente o campo de pe-
tróleo e por um processo de otimização estabelecer as variáveis de decisão
que induzem a produção ótima do campo.

Existem diversos tipos de campos de petróleo, que podem ser tanto
em terra firme quanto no oceano. O campo estudado neste trabalho é do tipo
offshore — no oceano. Este faz uso da amplamente empregada técnica de
gas-lift (WINKLER; BLANN, 2007) para a recuperação de petróleo dos re-
servatórios. Esta técnica consiste na injeção de gás na base do poço, conforme
ilustrado na Figura 2.

A injeção reduz a densidade do fluido na tubulação, trazendo para a
superfície óleo, água e gás. Os poços fazem parte de uma estrutura maior,
que é o campo em si. Um desenho esquemático do mesmo é apresentado na
Figura 3.

O compressor produz o gás para a injeção, sendo este direcionado aos
poços de petróleo. Tanto o direcionamento quanto a vazão do gás injetado em
cada poço são variáveis controladas pelo Manifold. A produção de água, óleo



32

Figura 1 – Preço histórico do petróleo: em azul, preço nominal e em verme-
lho, preço ajustado pela inflação.

e gás dos poços é então direcionada aos separadores pelas válvulas de alinha-
mento. Nos separadores, as diferentes fases são separadas, sendo destinadas
aos subsequentes tratamentos.

O óleo e o gás resultantes da produção são enviados às refinarias e
mercados consumidores, o que resulta em uma receita financeira. Já a água
produzida deve ser tratada para ser descartada e o gás de injeção deve ser
comprimido, sendo estes custos de produção.

No modelo do campo, o poço é aproximado por uma Curva de De-
sempenho do Poço – CDP – que é uma função que relaciona o gás injetado,
qi, com a vazão da fase extraída do poço, neste caso a vazão de óleo, qo,
conforme ilustrado na Figura 4.

Esta curva é não-linear, o que traz considerável complexidade na re-
solução do problema de otimização. Uma conhecida abordagem para esta
problemática é a linearização por partes (MISENER; GOUNARIS; FLOU-
DAS, 2009; CAMPONOGARA; CONTO, 2009) que consiste em discretizar
a curva e aproximá-la por segmentos de retas. Uma versão linearizada por
partes da curva da Figura 4 é apresentada na Figura 5.

Contudo, mesmo com a modelagem linear por partes, os cenários reais
tendem a ter um elevado número de curvas, com diversas combinações de ati-



33

Gás de Injeção

Água - Óleo - Gás

Reservatório

Figura 2 – Ilustração do processo de gas-lift aplicado a um poço de petróleo.

vação de poços e direcionamento de separadores. Além disso, ao buscar uma
boa aproximação dos poços, as curvas são finamente discretizadas, tornando
o modelo bastante complexo.

Em modelos de maiores dimensão, i.e. nos quais a CDP relaciona a
vazão produzida a mais variáveis além do gás de injeção, esta complexidade
se acentua. A convergência para o ótimo, nestes casos, é bastante lenta ou em
alguns casos impossível, (SILVA, 2012).

Para abordar este problema, uma solução proposta por (VASUDEVA,
2012) é de discretizar as funções lineares por partes de maneira não uniforme
de forma a minimizar o erro da aproximação. Com isso, a linearização por
partes é mais refinadas nas regiões de maior complexidade da função original,
sendo possível reduzir a quantidade de pontos de discretização.

No trabalho de (GEIßLER, 2011) é definido um algoritmo para refinar
as aproximações lineares por partes até uma margem de erro arbitrária através
de super e subestimadores convexos. Para refinar a aproximação são inseridos
breakpoints na região de maior erro da linearização por partes, sendo o valor
destes calculado a partir da função original. Também é proposto um algoritmo
iterativo que refina as funções lineares por partes na região do ótimo.

Estas abordagens envolvem o conhecimento da função original para
gerar a linearização por partes, o que nem sempre é possível. Por exemplo,
em sistemas grandes e complexos pode não existir um modelo do sistema,
embora seja possível medir seus pontos de funcionamento. Por isso, no pre-



34

Água
Óleo

Gás

Válvulas de
Alinhamento

Compressor

Poços

Manifold

Gás de Injeção

Mistura
óleo-água-gás

Mistura
óleo-água-gás

Água
Óleo

Separadores

Figura 3 – Esquema ilustrativo de um campo de petróleo com processo de
extração por gas-lift.

sente trabalho considera-se que existem apenas os valores das funções linea-
res por partes e que elas modelam adequadamente as curvas. Ou seja, não se
tem acesso à função original que gerou tais aproximações.

Assim, a abordagem proposta é de simplificar as CDPs linearizadas
pelo uso de um subconjunto reduzido de breakpoints. Esta curva simplificada
é refinada no entorno do ponto ótimo, através de um processo iterativo com
o problema de otimização. Esta iteração entre refinamento e resolução do



35

Produção
de Óleo

Injeção de gás
qi

Produção Máxima

qo(qi)

Figura 4 – Exemplo ilustrativo de uma CDP.

Produção
de Óleo

Injeção de gás
qi

Produção Máxima

qo(qi)

Figura 5 – Exemplo ilustrativo de uma CDP linearizada por partes.

problema de otimização é denominado Linearização por Partes Adaptativa,
abreviado por LPA, sendo introduzido o conceito geral na próxima seção.



36

1.2 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES ADAPTATIVA

A Linearização por Partes Adaptativa busca adaptar uma curva linear
por partes somente no entorno do ponto ótimo. Com isso, espera-se reduzir a
quantidade de pontos na curva linear por partes, reduzindo a complexidade e
tornando o problema factível ou de mais rápida convergência.

A adaptação é realizada num processo iterativo entre o problema de
otimização e a adaptação da curva, sendo que a cada iteração as curvas li-
neares por partes são refinadas no entorno do ponto ótimo. Um exemplo
ilustrativo de encontrar o máximo de uma função, realizando a adaptação da
curva é apresentado na Figura 6.

Figura 6 – Exemplo ilustrativo da linearização por partes adaptativa: o valor
máximo da função linear por partes é encontrado por uma adaptação com
menos pontos que a função original.

Neste exemplo, para encontrar o máximo da função, inicia-se com
uma primeira aproximação, que é um segmento de reta. À medida que as
iterações de adaptação ocorrem, são inseridos pontos próximos ao ótimo en-
contrado, adaptando a região do seu entorno até que coincida com a curva
real. Assim é obtido o ponto máximo da função com um conjunto reduzido
de pontos da função original.

O problema de adaptação pode ser formulado e resolvido indepen-



37

dente do problema de otimização, utilizando apenas as informações da lo-
calização do ótimo encontrado na curva adaptada. Estabelece-se, então, um
processo iterativo entre os dois problemas, otimização e adaptação, conforme
ilustrado na Figura 7.

Refinamento
da adaptação

da curva

Resolução do
problema de
otimização

Figura 7 – Processo iterativo da linearização por partes adaptativa: encontra-
se o ponto ótimo e refina-se a linearização por partes nas proximidades do
ponto ótimo.

O problema de otimização é resolvido, para então realizar uma nova
adaptação das curvas. Com a nova adaptação, é resolvido novamente o pro-
blema de otimização. Este processo iterativo segue até que se obtenha a con-
vergência para o ótimo.

1.3 OBJETIVOS

O objetivo deste trabalho é de desenvolver uma técnica de linearização
por partes adaptativa que permita gerar adaptações das Curvas de Desempe-
nho dos Poços com um conjunto reduzido de breakpoints que são refinados
próximos ao ponto ótimo. Com a simplificação das curvas, espera-se que que
o problema de otimização convirja com um menor esforço computacional,
atingindo o ótimo com um modelo mais simples que o original.

Os seguintes objetivos intermediários nortearam o desenvolvimento
do trabalho :

1. Determinação de um modelo para gerar adaptações de curvas lineares
por partes.

2. Integração do modelo de adaptação com um problema de otimização,
resultando na LPA.

3. Aplicação da LPA no problema de otimização da extração de petróleo
e gás.



38

Para avaliar a eficácia da LPA são comparados os tempos computaci-
onais da resolução do problema de otimização com LPA em relação a uma
resolução do modelo de maneira convencional, sem LPA.

Além dos desenvolvimentos da LPA para funções unidimensionais,
um objetivo adicional deste trabalho é desenvolver a base da LPA para fun-
ções bidimensionais. Com isso, em trabalhos futuros, a LPA pode ser esten-
dida para funções de maiores dimensões.

1.4 ESTRUTURA DA DISSERTAÇÃO

No Capítulo 2 é feita uma introdução à linearização por partes uni-
dimensional. São apresentadas algumas técnicas utilizadas para gerar a li-
nearização por partes, como a Combinação Convexa Agregada, Combinação
Convexa Desagregada e o Modelo Incremental.

É apresentada a formulação matemática do problema de adaptação de
uma curva linear por partes. Esta é então acoplada a um problema de otimi-
zação, sendo descritas 3 heurísticas para gerar novas adaptações a partir dos
ótimos encontrados, à saber: linear, linear fixando pontos e logarítmica. A
escolha do nome se deve ao comportamento observado nos seus funciona-
mentos.

No Capítulo 3, a LPA unidimensional é aplicada a um problema de
otimização da produção de um campo de petróleo e gás. Primeiro é apresen-
tado o modelo não-linear do campo, seguido de sua versão linearizada por
partes. A partir deste, com base na LPA, o modelo linearizado é reformu-
lado em dois diferentes modelos: por aproximação e por relaxação. Estes
modelos são então otimizados em diversos cenários, onde são apresentados
os resultados obtidos e os tempos computacionais, sobre os quais é feita uma
discussão.

No Capítulo 4, a LPA é estendida para o contexto bidimensional. Pri-
meiro é apresentado o modelo DCC bidimensional. A partir deste, é for-
mulado o problema de adaptação de uma curva bidimensional, sendo este
acoplado a um problema de otimização.

São propostas duas heurísticas para gerar novas adaptações a partir do
ponto ótimo, heurística linear e heurística logarítmica, cujos funcionamentos
e objetivos são semelhante às suas equivalentes unidimensionais. A LPA bi-
dimensional é então aplicada em dois exemplos de superfícies: uma gerada
por pontos aleatórios e outra pela sobreposição de 3 funções Gaussianas.

Por último, no Capítulo 5, é feito a conclusão do trabalho. Os resulta-
dos do trabalho são avaliados e concluídos, assim como as lições aprendidas,
contribuições e possibilidades de trabalhos futuros.



39

2 LINEARIZAÇÃO UNIDIMENSIONAL

O objetivo deste capítulo é estabelecer a Linearização por Partes Adap-
tativa para funções unidimensionais. Para isto, são apresentados os conceitos
de funções lineares por partes. Em seguida, é enunciado e formulado o pro-
blema de adaptação destas curvas. O problema de adaptação é então acoplado
ao problema de otimização, resultando na Linearização por Partes Adaptativa
Unidimensional.

2.1 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES UNIDIMENSIO-
NAL

Na linearização por partes unidimensional, funções complexas são
discretizadas e aproximadas por segmentos de retas: uma função conhecida
f : R ? R é discretizada em um conjunto de K pares (x, f (x)), sendo estes
combinados para se obter uma aproximação da função original.

Para realizar a combinação dos K pares, existem diversos modelos, por
exemplo Combinação Convexa Agregada (CC), Combinação Convexa Desa-
gregada (DCC) e Modelo Incremental (MI), detalhados nas próxima seções.
Alguns outros modelos existentes são SOS2, Log e Dlog; (VIELMA; KEHA;
NEMHAUSER, 2008), (VIELMA; NEMHAUSER, 2009) e (VIELMA; AH-
MED; NEMHAUSER, 2010).

2.1.1 Modelo de Combinação Convexa Agregada - CC

No modelo de Combinação Convexa Agregada (WOLSEY, 1998), os
pares (xk, f (xk)) são combinados pelas variáveis de ponderação ?k, Figura 8.

Para cada um dos K?1 intervalos é definida uma variável que induz o
intervalo ativo, ?k ?{0,1}. O valor da aproximação linear por partes f? passa
a ser determinado por ?k e ?k na seguinte formulação:



40

x

f (x)

x0 xk xk+1 xK

?0 ?k ?K?1

f (x0)

f (xk) f (xk+1)

f (xK)?k ?k+1

?0

?K

Figura 8 – Formulação da linearização por partes dos modelos por Combina-
ção Convexa e Incremental.

(x, f? ) =
K

?
k=0

?k(xk, fk) (2.1a)

K

?
k=0

?k = 1 (2.1b)

K?1

?
k=0

?k = 1 (2.1c)

?0 ? ?0 (2.1d)
?k ? ?k + ?k?1, 1 ? k ? K ?1 (2.1e)
?K ? ?K?1 (2.1f)
0 ? ?k ? 1, ?k ? R, k = 0,1,...,K (2.1g)
?k ?{0,1}, k = 0,1,...,K ?1 (2.1h)

onde:

• a equação (2.1a) aproxima a função f (x) por f? ;

• a restrição (2.1b) estabelece a combinação convexa;

• a restrição (2.1c) garante que apenas um intervalo é ativo, i.e. apenas
um ?k = 1;



41

• as restrições (2.1d), (2.1e) e (2.1f) acoplam o intervalo ativo ?k ao ?k
associado, realizando a combinação convexa apenas no intervalo ativo;

2.1.2 Modelo Incremental - MI

O modelo incremental (PADBERG, 2000) faz uso das mesmas va-
riáveis, ?k e ?k, que o modelo CC. A diferença se dá na formulação ma-
temática, onde f? e x são determinados por incrementos de (xk ? xk?1) e
( f (xk)? f (xk?1)):

x = x0 +
K

?
k=1

(xk ?xk?1)?k (2.2a)

f? = f (x0)+
K

?
k=1

( f (xk)? f (xk?1))?k (2.2b)

?1 ? ?1 ? 1 (2.2c)
?k ? ?k ? ?k?1, 2 ? k ? K ?1 (2.2d)
?K ? ?K?1 (2.2e)
0 ? ?k, ?k ? R, k = 0,1,...,K (2.2f)
?k ?{0,1}, k = 0,1,...,K ?1 (2.2g)

onde:

• as equações (2.2a) e (2.2b) estabelecem os valores de x e f? ;

• as equações (2.2c), (2.2d) e (2.2e) estabelecem os incrementos adicio-
nados. Acoplado a eles está ?k que pondera o incremento marginal.

Neste modelo, os incrementos são adicionados sucessivamente a me-
dida que os ?k se tornam ativos, sendo o incremento marginal ponderado por
?k. Isto pode ser verificado por indução em (2.2c), (2.2d) e (2.2e), onde
verifica-se que 0 ? ?K?1 ? ?K?2 ? ...? ?2 ? ?1 ? 1, sendo ?k ?{0,1}.

2.1.3 Modelo de Combinação Convexa Desagregada - DCC

O modelo por Combinação Convexa Desagregada (SHERALI, 2001)
é similar ao CC, conforme ilustrado na Figura 9. Porém, cada intervalo pos-
sui duas variáveis que realizam a combinação convexa, ? ek à esquerda e ?

d
k



42

à direita. Isto justifica a denominação "desagregado", uma vez que cada in-
tervalo possui variáveis de ponderação independentes. Também são definidos
um ?k ?{0,1} para cada intervalo:

x

f (x)

x0 xk xk+1 xK

?0 ?k ?K?1

f (x0)

f (xk) f (xk+1)

f (xK)? ek ?
d
k

?
e
0

?
d
K?1

?
d
0

?
e
K?1

Figura 9 – Formulação da linearização por partes do modelo por Combinação
Convexa Desagregada.

x =
K?1

?
k=0

(
?

e
k xk + ?

d
k xk+1

)
(2.3a)

f? =
K?1

?
k=0

(
?

e
k f (xk)+ ?

d
k f (xk+1)

)
(2.3b)

K?1

?
k=0

?k = 1 (2.3c)

?
e
k + ?

d
k = ?k, k = 0,1,...,K ?1 (2.3d)

0 ? ? ek ,?
d
k ? 1, k = 0,1,...,K ?1 (2.3e)

?
e
k ,?

d
k ? R, k = 0,1,...,K ?1 (2.3f)

?k ?{0,1}, k = 0,1,...,K ?1 (2.3g)

onde;

• as equações (2.3a) e (2.3b) definem os valores de x e f? ;

• a restrição (2.3c) garante que apenas um intervalo é ativo;



43

• a restrição (2.3d) relaciona o intervalo ativo ?k às variáveis ? ek e ?
d
k .

Quando o intervalo ?k está ativo, a soma das variáveis deve ser 1, indu-
zindo a combinação convexa.

2.2 REFINAMENTO ADAPTATIVO

Para realizar o refinamento adaptativo de uma função linear por partes,
é necessário formular um modelo que aproxime a função original com um
conjunto reduzido de breakpoints.

Nesta seção é descrita uma adaptação que gera uma superestimação
da função original. A partir deste, o modelo para gerar uma subestimação
é facilmente deduzível. Com as curvas adaptadas desta maneira, é possível
redefinir o problema de otimização original com propriedades interessantes.

Por exemplo, é possível definir uma relaxação do problema original,
no qual lucros/ganhos são superestimadas e custos/restrições subestimados.
Nesta abordagem, quando é encontrado o ponto ótimo nas curvas adaptadas
— dado que estas coincidam localmente com a função original — garante-se
que é o ótimo global.

Outro exemplo está na definição de um problema conservador que su-
bestima o lucro e superestima custos e restrições. Nesta abordagem, quando
uma solução é implementada na prática, obtém-se uma receita maior e custos
menores do que o calculado. Além disso, no processo iterativo de adaptar
as curvas e resolver o problema de otimização, qualquer solução numa dada
iteração é factível — o que não acontece quando se utiliza a abordagem de
relaxação.

Assim, é definido o problema de refinamento adaptativo para uma su-
perestimação: dado uma função linear por partes verdadeira f com n break-
points, como induzir uma aproximação f? com o menor erro possível e que
superestime f (x).

2.2.1 Modelagem Matemática da Adaptação

Seja f (x) uma função linear por partes a ser aproximada, sendo seu
conjunto de breakpoints dado por X = {x0, x1,..., xn}, tal que x0 &amp;lt;x1&amp;lt;
···&amp;lt;xn, e Y ={y0 = f (x0), y1 = f (x1),..., yn = f (xn)}.

A curva de aproximação, dada por f? , possui o conjunto de breakpoints
X? = {x?0, ..., x?m}? X , tal que x?0 = x0, x?m = xn e x?0 &amp;lt;x?1 &amp;lt;···&amp;lt;x?m. A estes
pontos são mapeados os valores de f? , no qual é induzida a aproximação de f ,
sendo Y? ={y?0 = f? (x0),...,y?m = f? (xm)} os valores da aproximação em X? .



44

Além disso, define-se N = {0, 1,..., n} e M = {0, 1, ..., m} o con-
junto dos índices de breakpoints da função original f e da aproximação f? ,
respectivamente. Um exemplo de uma função linear por partes f e uma apro-
ximação f? são apresentados na Figura 10.

O conjunto Y? é dividido em dois conjuntos disjuntos, Y? = Y? fixo?Y? livre,
sendo que os pontos em Y? fixo permanecem fixos quando é induzida a aproxi-
mação. O objetivo de introduzir este conjunto é de futuramente possibilitar
a adaptação somente em pontos próximos ao ponto ótimo na iteração cor-
rente, reduzindo os graus de liberdade do problema e o tempo para resolver a
adaptação.

Assim, o problema em questão é de como mapear valores para y? ?
Y? livre, mantendo y? ? Y? fixo fixo, de maneira que f? minimize o erro de aproxi-
mação e seja um limite superior de f . Para isso são definidos alguns elemen-
tos matemáticos.

Seja l?i o segmento linear que conecta os pontos (x?i,y?i) à (x?i+1,y?i+1).
Se y?i é uma variável de decisão, i.e. y?i ? Y? livre, então os segmentos l?i?1 (para
i &gt; 0) e l?i podem ser ajustados para aproximar f? de f .

Seja L? = {0,1,...,m?1} o conjunto dos segmentos lineares que for-
mam a aproximação f? . Para cada segmento l?i é definido Ni = { j ? N : x?i ?
x j ? x?i+1}, que são os índices de breakpoints da função original que estão no
domínio do segmento l?i.

O problema de aproximar f por f? ajustando os valores de y? ? Y? livre
pode ser enunciado no seguinte programa linear:

min
{ai, bi: i?L?}

?
i?L?

?
j?Ni

(aix j + bi ?y j) (2.4a)

s.a. : aix j + bi ? y j, i ? L?, j ? Ni (2.4b)
aix?i + bi = y?i, i ? M (2.4c)
ai?1x?i + bi?1 = aix?i + bi, i ? L?\{0} (2.4d)
Y? = Y? fixo ?Y? livre, Y? fixo ?Y? livre = /0 (2.4e)
y?i ?R, y?i ? Y? livre (2.4f)
ai, bi ?R, i ? L? (2.4g)
L? ={0,1,...,m?1} (2.4h)
Ni ={ j ? N : x?i ? x j ? x?i+1} (2.4i)

onde:

• o objetivo, Equação (2.4a), é minimizar a distância entre cada segmento



45

l?i da aproximação f? e a curva real f pela diferença do valor da função
real e da aproximação nos pontos X ;

• a Equação (2.4b) garante que todo segmento l?i é superior à curva real,
fazendo com que a aproximação seja uma superestimação;

• a Equação (2.4c) define os valores de y?i;

• a Equação (2.4d) garante a continuidade da aproximação;

• a Equação (2.4g) define a natureza das variáveis ai e bi, sendo estas
os parâmetros dos segmentos de reta que aproximam a função f nos
respetivos intervalos de L?;

Caso y?i ?Y? fixo, o valor de y?i é fixado pela equação (2.4c) e a aproxima-
ção é forçada a passar por este ponto. Se y?i ?Y? livre, o valor de y?i que minimiza
a distância será obtido na resolução do problema de adaptação. Observa-se
que os pares obtidos (x?i,y?i) serão usados pelo problema de otimização origi-
nal. Além disso, conforme mencionado, para gerar um adaptação que subes-
time a função f , basta inverter os termos da subtração na equação (2.4a) e a
desigualdade (2.4b).

Este modelo para aproximar uma curva linear por partes f por f? foi
implementado em AMPL, sendo verificado seu funcionamento, conforme
ilustra na Figura 11.

O AMPL — Modeling Language for Mathematical Programming —
é uma linguagem para modelagem matemática de problemas de otimização
lineares ou não-lineares (FOURER; GAY; KERNINGHAN, 2003). Nele,
o problema é descrito matematicamente, semelhante aos modelos descritos
neste trabalho. Esta formulação é então convertida no formato de um solver
escolhido, neste trabalho o CPLEX, que resolve o problema de otimização
encontrando o ótimo, quando possível.



46

0

0,2

0,4

0,6

0,8

1

1,2

1,4

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

Figura 10 – Exemplo de uma função linear por partes e uma adaptação não
otimizada.



47

0

0,2

0,4

0,6

0,8

1

1,2

1,4

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

Figura 11 – Exemplo de uma função linear por partes e com a adaptação
otimizada pelo modelo implementado em AMPL.



48

Na Figura 10 é apresentada a curva real e uma aproximação não oti-
mizada, com o conjunto Y? fixo em destaque. Na Figura 11 foi resolvido o
problema de adaptação, sendo encontrada a melhor aproximação f? que supe-
restima f . Com o refinamento adaptativo validado, passou-se para sua inte-
gração com problema de otimização.

2.3 INTEGRAÇÃO ADAPTAÇÃO-PROBLEMA DE OTIMIZAÇÃO

O processo de adaptação das curvas é integrado ao problema de otimi-
zação, criando um ciclo iterativo, ilustrado na Figura 12.

Primeira
aproximação
para curva

Ponto ótimo
pertence à
curva real?

Refina adaptação
da curva

Resolução do
problema de
otimização

Ponto ótimo
encontrado!

Sim

Não

Figura 12 – Diagrama da iteração do problema de otimização com a adaptação
da linearização por partes.

Neste processo, a partir da função original definida pelo conjunto de
pontos {(xi,yi), i ? N}, é gerada uma adaptação com um conjunto reduzido
de breakpoints {(xi,y?i), ? M}. Estes são usados no problema de otimização,
conforme ilustrado na Figura 13.

Por sua vez, o problema de otimização retorna o ponto da curva onde
foi encontrado o ótimo, (x?,y?), para que o refinamento adaptativo seja re-
alizado. A verdadeira curva f é abstraída pela adaptação, sendo disponível
apenas a curva f? para o problema de otimização. Isto permite uma fácil in-
serção do processo adaptativo em problemas de otimização.

Na adaptação, foram usadas diferentes heurísticas para gerar novas



49

Problema de
otimização

Refinamento
Adaptativo

Função
Original

(xi,yi)
Breakpoints da
curva original(xi,y?i)

Breakpoints da
curva adaptada

Localização do ponto ótimo na curva
(x?,y?)

Figura 13 – Fluxo de dados entre a função original, o refinamento adaptativo
e o problema de otimização.

aproximações: linear, linear com pontos fixos e heurística logarítmica. Para
validá-las, foi buscado o ótimo na curva original da Figura 10 tendo como
função objetivo f (x)?x. O gráfico desta função objetivo é apresentado na
Figura 14. Pode-se verificar que o ponto ótimo encontra-se em (0,32; 0,51).

-0,1

0

0,1

0,2

0,3

0,4

0,5

0,6

0,7

0 0,2 0,4 0,6 0,8 1

f(
x)

-x

x

Figura 14 – Gráfico da função objetivo f (x)?x.



50

2.3.1 Heurística Linear

Na heurística linear são adicionados breakpoints da curva original à
adaptação no entorno do ponto ótimo. Seu objetivo é fazer a região onde foi
encontrado o ponto ótimo coincidir com a curva real. Para isso, são incluídos
dois breakpoints da função original mais próximos à esquerda do ponto ótimo
(os maiores breakpoints menores que o ótimo) e os dois breakpoints próximos
à direita do ponto ótimo (os menores breakpoints maiores que o ótimo) —
caso eles existam, pois pode ocorrer do ponto ótimo estar no início da curva.
Também, caso o ponto ótimo coincida com breakpoints da função original,
este também é incluído:

Algorithm 1: Heurística linear para determinar os novos break-
points da próxima adaptação f? , a partir do ponto ótimo encontrado,
x?k

input: x?k,X?k
X?k+1 := X?k ?arg max{xi, x j ? X : xi &amp;lt;x j &amp;lt;x?k}
X?k+1 := X?k+1 ?arg min{xi, x j ? X : x?k &amp;lt;xi &amp;lt;x j}
if x?k ? X then

X?k+1 := X?k+1 ?{x?k}
return X?k+1

onde:

• o parâmetro k indica a k-ésima iteração;

• a variável x?k é o valor no domínio da curva onde foi encontrado o ponto
ótimo;

• X?k são os breakpoints da curva de aproximação na iteração k.

Com estes 4 ou 5 novos breakpoints, são inseridos suficientes graus
de liberdade para que a aproximação linear por partes coincida com a curva
real no entorno do ponto ótimo na k-ésima iteração. Assim, se na iteração
seguinte for encontrado o ótimo numa região coincidente com a curva real,
este também será o ponto ótimo na curva real.

Esta heurística foi implementada em AMPL, tendo como função ob-
jetivo max : f (x)?x. O resultado é apresentado nas Figuras 15, 16, 17, 18 e
19.

Na Figura 15 é apresentada a adaptação inicial da curva de apenas um
reta. Ao resolver o problema de otimização para a adaptação, é encontrado o



51

ótimo em (x?0; f (x
?
0)) = (0,01; 0,74).

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x0

Figura 15 – Aproximação inicial f? para a função f .



52

A partir do ponto ótimo encontrado, são adicionados os breakpoints
{0,09; 0,172} de acordo com a heurística proposta. Com isso, o novo con-
junto de breakpoints para a próxima adaptação é X?1 :={0,01; 0,09; 0,17; 0,92},
sendo esta apresentada na Figura 16. Ao resolver o problema de otimização
com esta nova curva, é encontrado o ótimo em (x?1; f (x

?
1)) = (0,17; 0,79).

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x1

Figura 16 – Aproximação f? para a função f na iteração 1 usando a heurística
linear.



53

A partir do ponto ótimo, são inseridos os breakpoints
{0,01; 0,09; 0,17; 0,29; 0,31}, sendo que apenas os dois últimos não es-
tavam em X?1; assim X?2 := {0,01; 0,09; 0,17; 0,29; 0,31; 0,92}. A nova
adaptação e o ponto ótimo encontrado, (x?2; f (x

?
2)) = (0,31; 0,83) são apre-

sentados na Figura 17.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x2

Figura 17 – Aproximação f? para a função f na iteração 2 usando a heurística
linear.



54

Na iteração 3 a adaptação é dada pelos breakpoints
X3 := {0,01; 0,09; 0,17; 0,29; 0,31; 0,32; 0,50; 0,92} e o ponto ótimo
encontrado é (x?3; f (x

?
3)) = (0,32; 0,83), Figura 18.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x3

Figura 18 – Aproximação f? para a função f na iteração 3 usando a heurística
linear.



55

Na iteração 4, quando a LPA converge, a adaptação é dada pelos bre-
akpoints X4 :={0,01; 0,09; 0,17; 0,29; 0,31; 0,32; 0,50; 0,61; 0,92} e o
ponto ótimo encontrado é (x?4; f (x

?
4)) = (0,32; 0,83), Figura 24.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x4

Figura 19 – Aproximação f? para a função f na iteração 4 (última) usando a
heurística linear.

Com isto, verifica-se que a LPA com heurística linear encontrou o
ponto ótimo da função objetivo max : f (x)?x, com um conjunto reduzido de
breakpoints da função original.



56

2.3.2 Heurística Linear com Pontos Fixos

A heurística linear com pontos fixos insere os mesmos breakpoints que
a heurística linear. Além disso, são fixados os breakpoints distantes do ótimo
encontrado na curva, de forma que estes não sejam alterados na adaptação da
curva:

Algorithm 2: Heurística linear com pontos fixos para determinar
os breakpoints da próxima adaptação f? , a partir do ponto ótimo
encontrado, x?k .

input: x?k,X?k
Bk := arg max{xi, x j ? X : xi &amp;lt;x j &amp;lt;x?k}
Bk := Bk ?arg min{xi, x j ? X : x?i &amp;lt;xi &amp;lt;x j}
if x?k ? Xk then

Bk := Bk ?{x?k}
X?k+1 := X?k ?Bk
Y? f ixok+1 := X?k+1 \Bk
return X?k+1, Y?

f ixo
k+1

onde:

• o parâmetro k indica a k-ésima iteração.

• a variável x?k é o valor no domínio da curva onde foi encontrado o ponto
ótimo na iteração k.

• o conjunto Bk contém os breakpoints adicionados para a próxima adap-
tação, que podem ou não já estar entre os breakpoints da adaptação
corrente, X?k.

• X?k são os breakpoints da curva adaptada na iteração corrente e X?k+1, os
usados para gerar a próxima adaptação, sendo X?k+1 := X?k ?Bk.

• o conjunto Y? f ixok+1 estabelece os breakpoints fixados ao gerar a próxima
adaptação.

Assim, a heurística de fixação estabelece que o conjunto de pontos
adicionados, Bk, permanece livre e seu complementar, Xi+1 \B, é fixado para
gerar próxima adaptação. Com estes pontos fixos, espera-se simplificar o
problema de adaptação, reduzindo seu tempo de resolução. A heurística foi
implementada em AMPL, sendo o resultado apresentado nas Figuras 20, 21,
22, 23 e 24.



57

A adaptação inicial é a mesma de heurística linear sendo também en-
contrado o ponto ótimo em (x?0; f (x

?
0)) = (0,01; 0,74), Figura 20.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x0

Figura 20 – Aproximação inicial f? para a função f .



58

Á partir do ponto ótimo, são adicionados os breakpoints {0,09; 0,172}
para a gerar a nova adaptação. Este conjunto é os mesmos da heurística linear,
porém também é estabelecido o conjunto de pontos fixos para esta adaptação,
Y f ixo1 ={0,92}.

A nova adaptação, composta pelo conjunto de breakpoints
X?1 := {0,01; 0,09; 0,17; 0,92} é apresentada na Figura 21. Ao resolver
o problema de otimização com esta nova curva, é encontrado o ótimo em
(x?1; f (x

?
1)) = (0,17; 0,19)

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

x1

Figura 21 – Aproximação f? para função f na iteração 1 usando a heurística
linear com pontos fixos.



59

A partir do ponto ótimo encontra na primeira iteração, são inseridos os
breakpoints {0,01; 0,09; 0,17; 0,29; 0,31}, sendo que apenas {0,29; 0,31}
não estavam presente na adaptação anterior. Contudo, como os 5 breakpoints
devem permanecer livre para realizar a adaptação, o conjunto de pontos fixos
permanece Y f ixo2 ={0,92}.

A nova adaptação é dada pelo conjunto de breakpoints
X?2 := {0,01; 0,09; 0,17; 0,29; 0,31; 0,92}, sendo apresentada na Figura
22. O ponto ótimo encontrado foi (x?2; f (x

?
2)) = (0,31; 0,83)

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

x2

Figura 22 – Aproximação f? para função f na iteração 2 usando a heurística
linear com pontos fixos.



60

Na iteração 3, a adaptação é dada pelos breakpoints
X3 := {0,01; 0,09; 0,17; 0,29; 0,31; 0,32; 0,50; 0,92}. Dentre estes,
foram inseridos B3 := {0,17; 0,29; 0,31; 0,32; 0,50}, resultando no con-
junto de ponto fixos Y f ixo3 = {0,01; 0,09; 0,92}. O ponto ótimo encontrado
(x?3; f (x

?
3)) = (0,32; 0,83) e adaptação são apresentados na Figura 23.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

x3

Figura 23 – Aproximação f? para função f na iteração 3 usando a heurística
linear com pontos fixos.



61

Na iteração 4, quando a LPA converge, a adaptação é dada pelos break-
points X4 :={0,01; 0,09; 0,17; 0,29; 0,31; 0,32; 0,50; 0,61; 0,92}, sendo
B4 := {0,29; 0,31; 0,32; 0,50; 0,61} e Y

f ixo
4 = {0,01; 0,17; 0,09; 0,92}.

O ponto ótimo encontrado (x?4; f (x
?
4)) = (0,32; 0,83) e a adaptação são apre-

sentados na Figura 24.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

Pontos Fixos

x4

Figura 24 – Aproximação f? para função f na iteração 4 (última) usando a
heurística linear com pontos fixos.

Verifica-se que a heurística linear com pontos fixos encontrou o ótimo
da função objetivo max : f (x)?x. O comportamento da adaptação foi seme-
lhante ao da heurística linear, porém fixando um subconjunto de breakpoints.



62

2.3.3 Heurística Logarítmica

Na heurística logarítmica, os intervalos da adaptação L? é que são sub-
divididos de acordo com a localização do ponto ótimo da iteração corrente.
Com isso, visa-se adaptar os intervalos próximos ao ponto ótimo. Seu nome
foi inspirado no comportamento observado da heurística em funcionamento:
os intervalos próximos ao ótimo são subdivididos até que se atinga o ótimo,
semelhante à busca binária.

Seja lk,i? o intervalo onde foi encontrado o ponto ótimo, na iteração k,
ou seja, x?k ? lk,i? . Este intervalo é determinado pelos pares de breakpoints
(x j_start,y?i) e (x j_end,y?i+1). Observe que os índices j_start e j_end referem-
se aos breakpoints da função original, mapeados nos valores da adaptação.

Seja também Nk,i? o conjunto de breakpoints da função original conti-
dos no domínio de lk,i? e j_close_to o breakpoint da função original próximo
ao ponto ótimo.

No caso geral lk,i? pode ser subdividido em dois intervalos: à esquerda
do ponto ótimo, entre x j_start e x j_close_to e à direita, x j_close_to e x j_end . Cada
subintervalo é subdividido pela inserção de 3 breakpoints próximos à sua
metade, resultando num total de 6 breakpoints inseridos. Assim como na
seção anterior, adiciona-se suficientes graus de liberdade para que a adaptação
coincida com a curva real quando for realizada próxima ao ponto ótimo.

Caso j_close_to coincida com o início ou fim do intervalo lk,i? , i.e.
j_close_to == j_start ou j_close_to == j_end, são adicionados breakpoints
na metade do intervalo precedente, lk,i??1, ou sucessor lk,i?+1, caso existam
tais intervalos:



63

Algorithm 3: Heurística logarítmica para determinar os break-
points da próxima adaptação f? , a partir do ponto ótimo x?k .

input: x?k, X?k, lk,i?, Nk,i?

Bk :={}
j_start := min{ j ? Nk,i?}
j_end := max{ j ? Nk,i?}
j_close_to := min{ j ? Nk,i? : x?k ? x j}

if j_start == j_close_to then
j_hal f :=bavg(min{ j ? Nk, j??1}, max{ j ? Nk, j??1})c

else
j_hal f :=bavg( j_start, j_close_to)c

Bk :={x j_hal f?1, x j_hal f , x j_hal f +1}

if j_close_to == j_end then
j_hal f :=davg(min{ j ? Nk,i?+1}, max{ j ? Nk,i?+1})e

else
j_hal f :=davg( j_close_to, j_end)e

Bk := Bk ?{x j_hal f?1, x j_hal f , x j_hal f +1}

X?k+1 := X?k ?Bk
return X?k+1

onde :

• o índice k indica a k-ésima iteração;

• X?k e X?k+1 são os breakpoints da curva adaptada na última iteração e os
breakpoints para gerar a adaptação da próxima iteração;

• a variável x?k é o ponto onde foi encontrado o ótimo na curva adaptada,
contido no intervalo lk,i? da adaptação;

• a conjunto Nk,i? contém os índices dos breakpoints da função original
na k-ésima iteração, contidos no domínio de lk,i? ;

• a conjunto Bk é composto pelos breakpoints que serão adicionados para
gerar a próxima adaptação;

• os índices de breakpoints j_start e j_end curva original determinam o
intervalo lk,i? . I.e. o domínio de lk,i? é o intervalo entre x j_start e x j_end ;



64

• o índice j_close_to é o breakpoint da função original próximo ao ponto
ótimo encontrado na iteração corrente, i.e. x j_close_to é próximo à x?k

• d.e e b.c são as funções chão e teto, respectivamente e avg a média
aritmética (average);

• a variável temporária j_hal f ora estabelece aproximadamente a metade
do intervalo à esquerda do ponto ótimo x?k , ora à direita.

Esta heurística foi implementada em AMPL, sendo o resultado apre-
sentado nas figuras 25, 26, 27, 28.

A aproximação inicial é o segmento de reta, o mesmo das heurísticas
anteriores, assim como o ponto ótimo f (x?0)) = (0,01; 0,74). Ambos são
apresentados na Figura 25.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x0

Figura 25 – Aproximação inicial f? para a função f .



65

O ponto ótimo encontrado na aproximação inicial é o início do inter-
valo da adaptação. Como não há intervalos a esquerda do ponto ótimo, apenas
o intervalo à direta é subdividido.

Este intervalo é subdividido próximo ao meio por 3 breakpoints:
{0,32; 0,50; 0,61}, resultando no novo conjunto para a adaptação X?1 :=
{0,01; 0,32; 0,50; 0,61; 0,92}. Na nova adaptação, apresentado na Figura
26, o ponto ótimo encontrado é (x?1; f (x

?
1)) = (0,32; 0,83).

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x1

Figura 26 – Aproximação f? para função a f na iteração 1 usando a heurística
logarítmica.



66

Na iteração seguinte, os intervalos à esquerda e à direita do ponto
ótimo são subdivididos. O intervalo da esquerda é subdividido pelos bre-
akpoints {0,09; 0,17; 0,29} e à direita pelos mesmos {0,32; 0,50; 0,61}.
Com isso X?2 := {0,01; 0,09; 0,17; 0,29; 0,32; 0,50; 0,61; 0,92}, sendo a
adaptação apresentada na Figura 27, com o ótimo em (x?2; f (x

?
2)) = (0,32; 0,83)

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x2

Figura 27 – Aproximação f? para função a f na iteração 2 usando a heurística
logarítmica.



67

Na última iteração, o intervalo à esquerda é dividido por
{0,29; 0,31; 0,32} e à direita por {0,32; 0,50; 0,61}. O algoritmo converge
com a adaptação gerada pelos breakpoints
X?3 := {0,01; 0,09; 0,17; 0,29; 0,31; 0,32; 0,50; 0,61; 0,92}, sendo en-
contrado o ponto ótimo (x?3; f (x

?
3)) = (0,32; 0,83) — Figura 28.

0

0,2

0,4

0,6

0,8

1

1,2

0 0,2 0,4 0,6 0,8 1

f(
x)

x

Curva Original
Curva Adaptada

x3

Figura 28 – Aproximação f? para a função f na iteração 3 (última) usando a
heurística logarítmica.

2.4 SUMÁRIO

Neste capítulo foi apresentada a Linearização por Partes Unidimensi-
onal. Na primeira parte é apresentada Linearização por Partes para funções
unidimensionais. São revisados os modelos por Combinação Convexa (CC),
Modelo Incremental (MI) e modelo por Combinação Convexa Desagregada
(DCC).

Em seguida, é formulado o problema de adaptação de uma função
linear por partes. A adaptação deve minimizar o erro e superestimar a função



68

original. Esta formulação é então verificada na adaptação de um curva linear
por partes, sendo então integrada a um problema de otimização.

Para realizar a integração da adaptação com o problema de otimização
são propostas 3 heurísticas: heurística linear, heurística linear fixando pontos
e heurística logarítmica. A partir do ponto ótimo, as heurísticas estabelecem
os breakpoints para gerar a próxima adaptação.

A heurística linear visa adaptar a região no entorno do ponto ótimo
pela adição de breakpoints da função original no entorno do mesmo. A heu-
rística linear fixando os pontos é semelhante à linear, porém fixa os pontos
distantes do ótimo com o objetivo de reduzir e simplificar o problema de
adaptação. Por último é apresentada a heurística logarítmica, cuja abordagem
adapta a curva de uma maneira mais ampla e não só na região do ótimo. Isto
ocorre, pois com ela os intervalos no entorno do ponto ótimo são subdivididos
para gerar a nova adaptação.

As heurísticas foram então aplicadas em exemplos simples sendo ve-
rificado seu funcionamento. Assim é estabelecida a Linearização por Partes
Adaptativa Unidimensional.



69

3 ANÁLISE COMPUTACIONAL

Neste capítulo é apresentada a formulação matemática do problema
de otimização da produção de campos de petróleo, operados por injeção con-
tínua de gás e sujeitos a restrições operacionais. Estes modelos são então
otimizados usando a LPA, sendo o objetivo maximizar o lucro na operação
de extração de petróleo e gás. Isto é realizado usando as diferentes heurísticas
de adaptação apresentadas nas Seções 2.3.1, 2.3.2 e 2.3.3.

Os resultados destas otimizações são apresentados, seguidos da dis-
cussão dos mesmos.

3.1 MODELOS

Nesta seção são apresentados os modelos dos campos de petróleo utili-
zados na Análise Computacional. Primeiro é apresentado o modelo não-linear
e sua formulação linearizada por partes. A partir desta última, para integrar à
LPA, são formulados dois modelos: por aproximação e por relaxação.

3.1.1 Modelo Não-Linear

O problema de otimizar a produção de um grupo de poços de petró-
leo, operando com injeção contínua de gás e com redundância nas linhas de
produção e de separadores consiste em distribuir uma vazão limitada de gás
de injeção, sob múltiplas restrições e com seleção de unidades de separação.
Na modelagem, são feitas as seguintes considerações:

• as pressões nos separadores são iguais;

• as CDPs são diferentes para cada poço, mas permanecem a mesma
independente do alinhamento;

• não existe perda de carga nas linhas.

Na Figura 29 é apresentado um diagrama do campo que é formulado
em programação matemática da seguinte maneira (CODAS, 2011):



70

P : max f = ?
n?N

fn(q
n
i ) (3.1a)

s.a : ?
n?N

qni ? q
max
i (3.1b)

Para todo n ? N :
lnyn ? qni ? unyn (3.1c)

?
s?Sn

zn,s = yn (3.1d)

?
s?Sn

qn,sh = q
n
h(q

n
i ), h ? H (3.1e)

0 ? qn,sh ? q
s,max
h zn,s, s ? Sn, h ? H (3.1f)

?
n?Ns

qn,sh ? q
s,max
h , s ? S , h ? H (3.1g)

yn ?{0,1}, n ? N (3.1h)
zn,s ?{0,1}, n ? N , s ? Sn (3.1i)

onde os parâmetros são:

• N é o número total de poços considerados no problema, N ={1,...,N},
sendo Ns ?N o conjunto de poços cuja produção pode ser enviada ao
separador s;

• S é o número total de separadores aos quais a produção é enviada, S =
{1,...,S} e Sn ? S é o conjunto de separadores que podem receber a
produção do poço n;

• H = {o, g, w, p} contém a produção (p) e as vazões multifásicas de
óleo (o), gás (g) e água (w);

• qmaxi é a vazão de gás de injeção disponível para distribuição entre os
N poços;

• qs,maxp , q
s,max
o , q

s,max
g e q

s,max
w são as capacidades de separação e os li-

mites de tratamento de óleo, gás e água, para o separador s, respectiva-
mente;

• ln (un) é o limite inferior (superior) de vazão de injeção de gás do poço
n devido a questões técnicas ou estratégicas, como a estabilidade da
produção e limites de pressão de fundo.

e as variáveis:



71

• f é a função objetivo que representa o ganho econômico da produção.

• qni é a vazão de injeção alocada ao poço n.

• qn,sh é a vazão de fase h proveniente do poço n direcionada ao separador
s, a qual depende da curva de desempenho do poço dada por qnh(q

n
i ).

• fn(qni ) = poq
n
o(q

n
i )+ pgq

n
g(q

n
i )?pwq

n
w(q

n
i )?piq

n
i é a função ganho para

o poço n. Onde, po e pg representam o lucro obtido pela venda de um
barril padrão de óleo e gás, respectivamente, pw é o custo de tratamento
de um barril padrão de água antes do descarte e pi é o custo de injeção
de gás por cada unidade de volume de gás de injeção.

• yn é a variável binária que assume o valor 1 se o poço n é ativado e 0
caso contrário.

• zn,s assume o valor 1 se a produção do poço n será enviada ao separador
s e 0 caso contrário.

Os limites de compressão de gás de injeção, da vazão de injeção nos
poços e de capacidade de separação de óleo, gás e água são estabelecidos
pelas restrições (3.1b), (3.1c) e (3.1g), respectivamente.

O alinhamento dos poços para os separadores são determinados pelas
restrições (3.1d)-(3.1f) que garantem que a produção de um poço é enviada
para somente um separador. A produção do poço n enviada ao separador s é
nula quando zn,s = 0. Caso contrário, ela é limitada pela capacidade máxima
e mínima do poço ou do separador.

O problema de distribuição de gás de injeção com alinhamento poço-
separador é do tipo não linear inteiro-misto. Devido às características não
lineares das Curvas de Desempenho dos Poços (do inglês, Well Performance
Curve, WPC) qnh e às variáveis discretas, é um problema de considerável di-
ficuldade computacional. Em (CAMPONOGARA; NAKASHIMA, 2006) é
mostrado que o problema é NP-difícil, pois o problema clássico da mochila é
redutível ao problema P em tempo e espaço polinomial.



72

Água
Óleo

Gás

Válvulas de
Alinhamento

Compressor

Poços

Manifold

Gás de Injeção

Mistura
óleo-água-gás

Mistura
óleo-água-gás

Água
Óleo

Separadores

qmaxi

(yn,qni )

qnh

zn,s

qmaxh,s

Figura 29 – Esquema ilustrativo de um campo de petróleo com processo de
extração por gas-lift para formulação do modelo em programação matemá-
tica.



73

3.1.2 Modelo Linearizado por Partes

As Curvas de Desempenho dos Poços são então linearizadas por par-
tes, seguindo o modelo com variáveis integradas proposto por Codas (CO-
DAS, 2011).

Neste modelo, a Curva de Desempenho do Poço é linearizada utili-
zando a formulação convexa desagregada DCC. A variável de ativação do
intervalo da curva é integrado à variável zn,s, se tornando ?

n,s
k :

P? : max f? = ?
n?N

f?n(q
n
i ) (3.2a)

s.a : ?
n?N

qni ? q
max
i (3.2b)

Para todo n ? N :

q?n,sh = ?
k?K

(
?

n,s
E,kq

n
h,k + ?

n,s
D,kq

n
h,k+1

)
, s ? Sn, h ? H

(3.2c)

qni = ?
s?Sn

?
k?K

(
?

n,s
E,kq

n
i,k + ?

n,s
D,kq

n
i,k+1

)
(3.2d)

?
s?Sn

?
k?K

?
n,s
k = yn (3.2e)

?
n,s
E,k + ?

n,s
D,k = ?

n,s
k , s ? Sn, k ? K (3.2f)

0 ? ? n,sE,k,?
n,s
D,k ? 1, s ? Sn, k ? K (3.2g)

?
n?Ns

q?n,sh ? q
s,max
h , s ? S , h ? H (3.2h)

yn ?{0,1}, n ? N (3.2i)
?

n,s
k ?{0,1}, n ? N , s ? Sn, k ? K (3.2j)

As equações (3.2c) à (3.2h) são resultantes da aplicação da lineariza-
ção por parte na função objetivo (3.1a) e nas funções qnh dos poços, (3.1c) à
(3.1f), da formulação não-linear, onde:

• (qni,k,q
n
h,k) é o k

e?simo ponto de amostragem da Curva de Desempenho do
Poço n, onde qni,k é a vazão de gás injetada e q

n
h,k é a vazão de cada uma

das fases h ? H que saem do poço;
• K = {1,...,K ?1} é o conjunto de intervalos gerados pela amostra-

gem da Curva de Desempenho do Poço, sendo K o número de pontos
de amostragem da CDP, qnh(q

n
i );



74

• qs,maxp , q
s,max
o , q

s,max
g e q

s,max
w são as capacidades de separação e os li-

mites de tratamento de óleo, gás e água para o separador s, respectiva-
mente;

e as variáveis

• f?n(qni ) é a função ganho para o poço n;

• q?nh é a vazão de fluido de fase h do poço n aproximada pela função
linear por partes;

• q?n,sh é a vazão de fluido de fase h do poço n ao separador s aproximada
pela função linear por partes;

• ? nE,k, ?
n
D,k e ?

n
k são variáveis auxiliares utilizadas para realizar a linea-

rização por partes das curvas pelo modelo DCC;

• qni é a vazão de injeção alocada ao poço n;

• ? n,sk assume o valor 1 se a produção do poço n é direcionada ao separa-
dor s, sendo a produção aproximada pelo k-ésimo intervalo da aproxi-
mação linear por partes.

A equação (3.2b) garante que a quantidade de gás injetado é inferior a
vazão máxima produzida pelo compressor. O alinhamento poço-separador é
determinado pelas restrições (3.2e) e (3.2i), garantindo que a produção de um
poço ativo é enviada para somente um separador.

3.1.3 Modelo com Linearização por Partes Adaptativa

Com base no modelo linearizado, é aplicada a linearização por partes
adaptativa descrita no Capítulo 2, onde são geradas super e subestimações
para a Curva de Desempenho do Poço, (3.2c) e (3.2d). São estabelecidos dois
modelos para o problema de otimização da produção de petróleo e gás, um
denominado modelo por aproximação e o outro, por relaxação.

Em ambos modelos, a aproximação inicial de cada CDP foi feito sub-
dividindo o domínio da função em aproximadamente 3 partes iguais, sendo
incluído o segundo breakpoint da curva original:

X? n1 :={x1, x2, xm/3, x2m/3, xm}, n ? N (3.3a)

Ao subdividir o domínio em 3 partes, espera-se gerar uma boa aproxi-
mação inicial. A inserção do segundo breakpoint x2 da curva original se deve
ao seguinte fenômeno observado: algumas adaptações que superestimavam



75

os valores da produção tinham valores acima dos limites de tratamento dos
separadores. Assim, o respectivo poço não era ativado, e por não contribuir
para o objetivo ótimo, sua curva não era adaptada. De certa forma, parte do
domínio do problema se tornava infactível.

Com base nestes breakpoints iniciais foram geradas super e subes-
timações das curvas de produção, sendo construído dois novos modelos do
campo de petróleo.

3.1.3.1 Modelo com Linearização por Partes Adaptativa por Aproximação

O objetivo deste modelo é gerar soluções factíveis em todas etapas do
processo de adaptação das curvas. Para isso, é usada uma abordagem conser-
vadora, subestimando receitas, superestimando custos e variáveis sujeitas às
restrições. Em qualquer iteração, a solução obtida pode ser implementada na
prática, sendo obtido um lucro maior que o estimado e folga nas restrições:



76

P?approx : max f? = ?
n?N

(
poq?

n
o + pgq?

n
g ? pwq?nw ? piq

n
i

)
(3.4a)

s.a : ?
n?N

qni ? q
max
i (3.4b)

Para todo n ? N :

qni = ?
s?Sn

?
l?L?n

(
?

n,s
E,l .q

n
i,l + ?

n,s
D,l.q

n
i,l+1

)
(3.4c)

q?n,sh = ?
l?L?n

(
?

n,s
E,l .q

n
h,l + ?

n,s
D,l.q

n
h,l+1

)
, s ? Sn, h ? H

(3.4d)

q?n,sh = ?
l?L?n

(
?

n,s
E,l .q

n
h,l + ?

n,s
D,l.q

n
h,l+1

)
, s ? Sn, h ? H

(3.4e)

?
s?Sn

?
l?L?n

?
n,s
l = yn (3.4f)

?
n,s
E,l + ?

n,s
D,l = ?

n,s
l , s ? Sn, l ? L?

n (3.4g)

0 ? ? n,sE,l ,?
n,s
D,l ? 1, s ? Sn, l ? L?

n (3.4h)

?
n?Ns

q?n,sh ? q
s,max
h , s ? S , h ? H (3.4i)

yn ?{0,1}, n ? N (3.4j)
?

n,s
l ?{0,1}, n ? N , s ? Sn, l ? L?

n (3.4k)

onde

• q?nh = ?
s?Sn

q?n,sh , h ? H é a subestimação da produção da fase h no poço

n e q?n,sh é a subestimação da produção de fase h, no poço n, direcionada
ao separador s;

• q?nh = ?
s?Sn

q?n,sh , h ? H é a superestimação da produção de fase h no

poço n e q?n,sh é a superestimação da produção de fase h, no poço n,
direcionada ao separador s;

• L?n é o conjunto de intervalos gerados pela linearização por partes adap-
tativa para o poço n;

• qni,l são os breakpoints de injeção de gás selecionados pela linearização



77

por partes adaptativa para gerar a adaptação para o poço n;

• qnh,l são os breakpoints da curva adaptada, gerados pela LPA, que su-
bestimam a produção da fase h no poço n;

• qnh,l são os breakpoints da curva adaptada, gerados pela LPA, que su-
perestimam a produção da fase h no poço n.

3.1.3.2 Modelo com Linearização por Partes Adaptativa por Relaxação

O segundo modelo proposto é uma relaxação do problema original,
que em (WOLSEY, 1998) é definido da seguinte forma:

Definição 1. Seja um problema P definido por z = max{c(x) : x ? X ? Rn},
onde X é o domínio da função deste problema genérico. Uma relaxação de P
é dada por RP : zR = max{ f (x) : x ? T ? Rn}, se:

1. X ? T ;

2. f (x)? c(x) para todo x ? X .

Em outras palavras, a relaxação é uma reformulação do problema ori-
ginal, na qual o domínio do problema pode ser aumentado e para o qual é
definida uma função que, caso o problema seja de maximização, superestima
a função objetivo em todos os pontos do novo domínio. Caso o problema seja
de minimização, a função deve subestimar a função objetivo.

A partir da relaxação, às vezes é possível provar otimalidade:

Proposição 1. Seja x? é uma solução ótima de RP. Se x? ?X e f (x?) = c(x?),
então x? é uma solução ótima do problema original P.

Demonstração. Como x? ? X , z ? c(x?) = f (x?) = zR. Como z ? zR, obtém-
se c(x?) = z = zR.

Ou seja, se um ponto ótimo é encontrado na relaxação e este coincide
com um valor no problema original, então garante-se que foi encontrado um
ponto ótimo do problema original.

Conforme mencionado, a linearização por partes adaptativa gera su-
per e subestimações das fases extraídas e como a função objetivo é calculada
diretamente a partir destes valores, é possível reformular o problema como
uma relaxação. Para isto, os ganhos econômicos definido pela função ob-
jetivo, dado pela produção de óleo e água, são superestimadas e o custo de
tratamento de água, subestimado. O gás de injeção não possui nem super,



78

nem subestimação, pois é uma variável controlável. Para aumentar o domínio
do problema, a vazão direcionada aos separadores é subestimada.

Isto resulta na seguinte formulação, onde, em relação a formulação
anterior, apenas as equações (3.5a) e (3.5i) foram reformuladas:

P?relax : max f? = ?
n?N

(
poq?no + pgq?ng ? pwq?

n
w ? piq

n
i

)
(3.5a)

s.a : ?
n?N

qni ? q
max
i (3.5b)

Para todo n ? N :

qni = ?
s?Sn

?
l?L?n

(
?

n,s
E,l .q

n
i,l + ?

n,s
D,l.q

n
i,l+1

)
(3.5c)

q?n,sh = ?
l?L?n

(
?

n,s
E,l .q

n
h,l + ?

n,s
D,l.q

n
h,l+1

)
, s ? Sn, h ? H

(3.5d)

q?n,sh = ?
l?L?n

(
?

n,s
E,l .q

n
h,l + ?

n,s
D,l.q

n
h,l+1

)
, s ? Sn, h ? H

(3.5e)

?
s?Sn

?
l?L?n

?
n,s
l = yn (3.5f)

?
n,s
E,l + ?

n,s
D,l = ?

n,s
l , s ? Sn, l ? L?

n (3.5g)

0 ? ? n,sE,l ,?
n,s
D,l ? 1, s ? Sn, l ? L?

n (3.5h)

?
n?Ns

q?n,sh ? q
s,max
h , s ? S , h ? H (3.5i)

yn ?{0,1}, n ? N (3.5j)
?

n,s
l ?{0,1}, n ? N , s ? Sn, l ? L?

n (3.5k)

Com esta formulação, quando a LPA convergir para o ponto ótimo, as
CDPs estão adaptadas no entorno do ponto ótimo e coincidem com a curva
original. Com isso, tem-se a garantia de que foi encontrado o ótimo também
do problema original.

3.2 RESULTADOS

As duas formulações do problema de otimização do campo de petró-
leo com linearização por partes adaptativas foram então aplicadas a diversos
cenários de campos de petróleo. Foram empregadas as 3 heurísticas, apresen-



79

tadas nas Seções 2.3.1, 2.3.2 e 2.3.3, à saber: a heurística linear; a linear com
pontos fixos e a logarítmica.

Primeiro são apresentados os cenários instanciados. Em seguida são
apresentados os valores ótimos obtidos, assim como um comparativo dos tem-
pos computacionais. Por último é feita uma discussão sobre os resultados.

3.2.1 Cenários

Os cenários usados no problema de otimização possuem 3 caracterís-
ticas:

1. Tipo de curva do poço: côncava (c) ou não-côncava (s).

2. Quantidade de poços no campo: N = 32, 64 ou 128.

3. Disponibilidade de gás: baixa (l), média (m) ou alta (m).

Em todos os cenários existem 3 separadores para o qual é direcionada
a produção. Considera-se que a pressão nos separadores é igual. As Curvas
de Desempenho dos Poços quando côncavas são funções lineares por partes
compostas por 60 pontos e quando não côncavas, são lineares por partes com-
postas por 19 pontos. Os parâmetros das instâncias podem ser encontrados
em (CODAS; CAMPONOGARA, 2011).

Na apresentação dos resultados, o cenário é identificado pela sigla
composta pelo tipo de curva, quantidade de poços e disponibilidade de gás.
Por exemplo, o cenário com as curvas côncavas, 32 poços e com disponibili-
dade média é denominado c32m.

Os problemas foram resolvidos usando AMPL 20100928 e o solver
CPLEX 11.2.1. O equipamento usado foi um Pentium Dual-Core 2.6Ghz,
com memória de 3Gb RAM, sistema operacional Ubuntu 12.04 64-bits e Ker-
nel 3.2.0-31-generic.



80

3.2.2 Premissas para Avaliar os Resultados

Neste trabalho, o processo de adaptação das curvas foi realizado em
série, i.e. primeiro uma curva era adaptada, depois outra, depois outra, etc..
Contudo, este procedimento é paralelizável, uma vez que a adaptação de cada
curva é independente das outras. Assim, foi estimado o tempo de adaptação,
caso o processo fosse paralelizado.

Esta estimativa é feita pelo tempo médio de adaptação de cada curva.
Por exemplo, se num problema, para alcançar o ponto ótimo foram necessá-
rias 4 iterações, sendo adaptadas um total de 20 curvas, num tempo total de
40s, considera-se que o tempo de adaptação em cada iteração foi de 40s/20
curvas= 2s/curva. Como foram necessárias 4 iterações, o tempo total de
adaptação é estimado em 4 iterações × 2s= 8s. Além disto, foi desconsi-
derado o tempo da primeira iteração, pois considera-se que este é realizado
offline e faz parte do modelo do campo de petróleo.

Além disso foi estabelecido um limite de 10.000 segundos para a re-
solução do problema de otimização em uma dada iteração. Também foi esta-
belecido um máximo de 20 iterações de adaptação para cada cenário.

3.2.3 Indicadores

Para avaliar a linearização por partes adaptativa foi definido como re-
ferência o tempo computacional e o ótimo encontrado ao resolver o problema
de otimização sem LPA — o modelo da Seção 3.1.2. A partir destes valores
foram estabelecidos os seguintes indicadores, por exemplo a razão entre o
valor da função objetivo encontrado usando a LPA e sem usar a LPA:

Objetivo encontrado com LPA
Objetivo encontrado sem LPA

=
Objetivo
s/LPA

(3.6a)

Com este indicador, espera-se verificar quão próximo do ótimo global foi a
solução encontrada pela LPA.

Outro indicador é a razão entre o tempo computacional total usando a
LPA e sem a LPA

Tempo Total usando LPA
Tempo Total sem LPA

=
T.T

s/ LPA
(3.7a)

Os tempos computacionais ditos totais são a soma do tempo dispendido ao
longo de todas as iterações, seja para resolver o problema de otimização, seja
para realizar a adaptação das curvas. Este indicador avalia quantas vezes a



81

LPA foi mais (ou menos) rápida para resolver o problema de otimização do
que uma resolução convencional.

O último indicador é a razão entre os tempos computacionais para
resolver o último problema de otimização — quando converge — e o tempo
de resolução sem LPA:

Tempo Computacional para a U?ltima Otimizaça?o
Tempo Total sem LPA

=
U?.O.

s/LPA
(3.8a)

Com esta métrica espera-se verificar se o modelo adaptado final é mais
simples do que o modelo original. Ou seja, se o problema de otimização com
o último modelo adaptado é resolvido em menos tempo do que o modelo
original.

3.2.4 Resultados sem uso da LPA

Na Tabela 1 é apresentado o resultado da resolução do problema de
otimização sem usar a LPA.

Observa-se que mesmo com uma menor quantidade de pontos, os ce-
nários de curvas não-côncavas possuem tempo de resolução superior ou pró-
ximo ao de curvas côncavas. Isto se deve à complexidade matemática da
resolução de problemas não convexos. Além disso, observa-se que os mode-
los com 128 poços e baixa disponibilidade possuem tempos computacionais
bastante elevados em relação aos demais.

Os resultados para cada um dos modelos, por aproximação e por re-
laxação, são apresentados nas próximas seções. Cada um deles é otimizado
utilizando as heurísticas apresentadas no Capítulo 2.



82

Tabela 1 – Tempos computacionais e valores ótimos obtidos nas diferentes
instâncias dos campos de petróleo. Valores para a resolução sem o uso da
LPA.

Sem LPA
Modelo Tempo (s) Objetivo
c32l 5,1 74.087
c64l 2,1 151.261
c128l 10.183,8 314.458
c32m 1,6 262.753
c64m 4,4 643.853
c128m 19,2 1.273.973
c32h 0,4 730.929
c64h 0,5 2.040.814
c128h 0,7 4.065.687

s32l 8,0 75.180
s64l 3,8 156.452
s128l 10.166,1 322.005
s32m 3,0 267.160
s64m 4,3 671.040
s128m 40,8 1.328.832
s32h 0,3 748.616
s64h 0,3 2.090.132
s128h 0,4 4.163.832



83

3.2.5 Resultados com o Modelo por Aproximação

Nesta seção são apresentados os resultados da otimização do modelo
por aproximação. Nas Tabelas 2, 4 e 6 são apresentados os valores da função
objetivo nos pontos ótimos encontrados, o número de iterações da LPA e a
quantidade de curvas adaptada das heurísticas linear, linear fixando pontos e
logarítmica, respectivamente.

Tabela 2 – Otimização da produção de petróleo com modelo por aproximação
e heurística linear sem pontos fixos — iterações, curvas adaptadas e pontos
ótimos encontrados.

Heurística linear sem pontos fixos
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 2 4 74.087 100,0%
c64l 2 6 151.261 100,0%
c128l 2 13 314.458 100,0%
c32m 2 16 262.753 100,0%
c64m 3 32 643.853 100,0%
c128m 2 64 1.273.973 100,0%
c32h 9 161 730.929 100,0%
c64h 8 317 2.040.814 100,0%
c128h 8 628 4.065.687 100,0%

s32l 2 4 75.180 100,0%
s64l 3 6 156.452 100,0%
s128l *0 *0 — —
s32m 2 16 267.186 100,0%
s64m 3 33 671.023 100,0%
s128m 2 64 1.328.823 100,0%
s32h 4 60 746.514 99,7%
s64h 4 126 2.090.132 100,0%
s128h 4 253 4.163.832 100,0%

* Resolução do problema de otimização excedeu 10.000s



84

Tabela 3 – Otimização da produção de petróleo com modelo por aproximação
e heurística linear sem pontos fixos — tempos computacionais.

Heurística linear sem pontos fixos - tempos
Tempos Totais (s) T.T.

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 1,1 7,1 8,1 160% 3,0 59%
c64l 1,1 3,0 4,0 194% 1,4 65%
c128l 1,1 643,5 644,6 6% 23,6 0%
c32m 1,1 1,2 2,3 145% 0,5 30%
c64m 1,6 3,9 5,6 128% 1,4 32%
c128m 1,1 30,1 31,2 163% 15,3 80%
c32h 4,9 2,7 7,6 2.088% 0,3 81%
c64h 4,4 2,8 7,1 1.425% 0,3 68%
c128h 4,4 3,5 7,9 1.068% 0,5 65%

s32l 1,1 5,4 6,5 81% 2,8 35%
s64l 1,6 4,6 6,2 165% 1,3 35%
s128l — *10.116,2 *10.116,2 — — —
s32m 1,1 1,7 2,8 92% 0,5 16%
s64m 1,6 14,0 15,6 365% 1,5 34%
s128m 1,1 98,3 99,4 244% 16,0 39%
s32h 2,2 1,3 3,4 1.036% 0,3 86%
s64h 2,2 1,3 3,5 1.028% 0,3 92%
s128h 2,2 1,5 3,7 827% 0,4 81%

* Resolução do problema de otimização excedeu 10.000s

No geral, para o modelo por aproximação, a heurística linear sem pon-
tos fixos levou mais tempo para encontrar ponto ótimo do que a resolução
sem LPA, sendo até 21 vezes maior. Apenas nos cenários c128l, s32l e s32m
o tempo foi menor. Os tempos computacionais para resolver o último pro-
blema de otimização ficaram abaixo do tempo de resolução sem LPA.

No cenário s128l, a resolução do problema de otimização demorou
mais que 10.000 segundos, sendo interrompida conforme o limite estabele-
cido para timeout.

Observa-se que nos cenários de curvas côncavas os valores ótimos
coincidiram com a resolução sem LPA. Nas curvas não côncavas, alguns ce-
nários apresentaram uma leve diferença, por exemplo na instância s32h o
valor do ótimo encontrado foi de 99,7% do ótimo encontrado sem LPA.

Outro ponto constatado é que à medida que a disponibilidade de gás
aumenta é necessário um maior número de iterações para adaptar a curva. Por



85

exemplo, nos cenários côncavos, com baixa disponibilidade, foram necessá-
rias 2 iterações. Já nos cenários com alta disponibilidade foram necessárias 8
e 9 iterações.

Tabela 4 – Otimização da produção de petróleo com modelo por aproximação
e heurística linear com pontos fixos — iterações, curvas adaptadas e pontos
ótimos encontrados.

Heurística linear com pontos fixos
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 2 4 74.087 100,0%
c64l 2 6 151.261 100,0%
c128l 2 13 314.458 100,0%
c32m 2 16 262.753 100,0%
c64m 3 32 643.853 100,0%
c128m 2 64 1.273.973 100,0%
c32h 8 154 730.929 100,0%
c64h 8 310 2.040.814 100,0%
c128h 8 617 4.065.687 100,0%

s32l 2 4 75.180 100,0%
s64l 3 6 156.452 100,0%
s128l *0 *0 — —
s32m 2 16 267.186 100,0%
s64m 3 33 671.042 100,0%
s128m 2 64 1.328.823 100,0%
s32h 4 60 746.514 99,7%
s64h 4 126 2.090.132 100,0%
s128h 4 253 4.163.832 100,0%

* Resolução do problema de otimização excedeu 10.000s



86

Tabela 5 – Otimização da produção de petróleo com modelo por aproximação
e heurística linear com pontos fixos — tempos computacionais.

Heurística linear com pontos fixos - tempos
Tempos Totais (s) Total

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 1,1 7,2 8,3 163% 2,9 57%
c64l 1,1 2,8 3,9 188% 1,1 52%
c128l 1,1 672,2 673,3 7% 29,9 0%
c32m 1,1 1,1 2,2 139% 0,5 28%
c64m 1,7 3,4 5,1 116% 1,1 25%
c128m 1,1 19,2 20,3 106% 3,2 17%
c32h 4,4 2,5 6,9 1.896% 0,3 88%
c64h 4,4 2,8 7,2 1.438% 0,4 75%
c128h 4,4 3,4 7,9 1.072% 0,5 63%

s32l 1,1 5,5 6,7 83% 2,9 36%
s64l 1,6 4,5 6,2 164% 1,4 38%
s128l — *10.133,5 *10.133,5 — — —
s32m 1,1 1,7 2,7 90% 0,5 18%
s64m 1,6 19,2 20,9 488% 1,9 45%
s128m 1,1 135,4 136,5 335% 46,1 113%
s32h 2,2 1,2 3,4 1.016% 0,3 94%
s64h 2,2 1,3 3,5 1.039% 0,3 93%
s128h 2,2 1,6 3,8 871% 0,4 83%

* Resolução do problema de otimização excedeu 10.000s

A heurística linear com pontos fixos realizou quase o mesmo número
de iterações para atingir o ponto ótimo do que a sem pontos fixos. Não houve
redução significativa no tempo total das adaptações como esperado, uma vez
que os tempos mais significativos foram da resolução do problema de otimi-
zação. Os tempos de resolução do último problema de otimização ficaram
próximos ou abaixo dos tempos de resolução sem LPA.



87

Tabela 6 – Otimização da produção de petróleo com modelo por aproxima-
ção e heurística logarítmica — iterações, curvas adaptadas e pontos ótimos
encontrados.

Heurística logarítmica
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 4 9 74,087 100,0%
c64l 4 13 151,261 100,0%
c128l 4 19 314,458 100,0%
c32m 4 21 262,753 100,0%
c64m 4 34 643,853 100,0%
c128m 4 66 1,273,973 100,0%
c32h 4 91 730,929 100,0%
c64h 4 182 2,040,814 100,0%
c128h 4 366 4,065,687 100,0%

s32l 2 4 75,180 100,0%
s64l 2 6 156,452 100,0%
s128l *0 *0 — —
s32m 2 16 267,186 100,0%
s64m 4 35 671,048 100,0%
s128m 2 64 1,328,823 100,0%
s32h 4 69 747,176 99,8%
s64h 3 128 2,090,132 100,0%
s128h 3 256 4,163,832 100,0%

* Resolução do problema de otimização excedeu 10.000s



88

Tabela 7 – Otimização da produção de petróleo com modelo por aproximação
e heurística logarítmica — tempos computacionais.

Heurística logarítmica - tempos
Tempos Totais (s) Total

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 2,2 13,0 15,3 300% 4,0 79%
c64l 2,3 4,4 6,7 321% 1,0 46%
c128l 2,3 9.145,1 9.147,4 90% 729,9 7%
c32m 2,3 2,2 4,5 281% 0,5 30%
c64m 2,3 5,3 7,6 175% 1,6 37%
c128m 2,2 34,4 36,6 191% 1,8 9%
c32h 2,2 1,3 3,5 968% 0,3 84%
c64h 2,2 1,3 3,6 711% 0,4 71%
c128h 2,3 1,7 4,0 541% 0,5 63%

s32l 1,1 5,4 6,5 81% 2,5 31%
s64l 1,1 2,2 3,3 88% 0,7 17%
s128l — *10.135,9 *10.135,9 — — —
s32m 1,1 1,8 2,9 94% 0,6 18%
s64m 2,2 15,7 18,0 420% 1,7 40%
s128m 1,1 126,1 127,3 312% 30,0 74%
s32h 2,2 1,2 3,5 1.039% 0,3 102%
s64h 1,7 1,0 2,7 789% 0,4 109%
s128h 1,7 1,4 3,0 689% 0,5 114%

* Resolução do problema de otimização excedeu 10.000s

Com a heurística logarítmica, nos cenários de curvas côncavas, a LPA
convergiu em 4 iterações. Nos cenários com alta disponibilidade, isto repre-
sentou um ganho em relação às heurísticas lineares.

Esta diferença se deve a um fenômeno observado nestes problemas:
para baixas vazões, o ótimo se encontra nas regiões iniciais das CDPs, onde a
curva é bem adaptada na aproximação inicial. Com isso, em poucas iterações
a heurística linear converge para o ótimo. Para maiores disponibilidades, o
ponto ótimo se desloca nas CDPs, sendo necessário um maior número de
iterações para se adaptar a região do ótimo. Já a heurística logarítmica, por
adaptar as curvas num espectro mais global, converge mais ou menos com
um número constante de iterações.

Nos cenários de curvas não côncavas o número de iterações reduziu
um pouco em relação às outras heurísticas. Ainda assim, o tempo computa-
cional foi bastante superior à resolução sem LPA, chegando a levar 10 vezes



89

mais tempo. Para os cenários de curvas côncavas foi obtido o mesmo valor
de ótimo do que na resolução sem LPA, com pequena diferença nos cenários
não côncavos.

Em relação ao tempo de resolução do último problema de otimiza-
ção, os cenários de curvas côncavas e alta disponibilidade ficaram levemente
acima da resolução sem LPA. Nos outros cenários, este tempo foi bastante
inferior.

No geral, na resolução do modelo por aproximação, os tempos compu-
tacionais foram bastante superiores à resolução sem LPA. Nos cenários com
curvas côncavas foi encontrado o mesmo ponto ótimo, já nos com função
de produção não côncavas, nem todos convergiram para o mesmo valor. A
heurística logarítmica, para alta disponibilidades, convergiu com um menor
número de iterações do que as lineares. Já para baixas vazões o reciproco
ocorreu.



90

3.2.6 Resultados com o Modelo por Relaxação

Os cenários de poços de petróleo foram também otimizados usando
o modelo por relaxação e utilizando as 3 heurísticas: linear, linear fixando
pontos e logarítmica. A quantidade de iterações necessárias, os valores da
função objetivo no ótimo e a quantidade de curvas adaptadas são apresentados
nas Tabelas 8, 10 e 12. Já os tempos computacionais nas Tabelas 9, 11 e 13.

Tabela 8 – Otimização da produção de petróleo com modelo por relaxação
e heurística linear sem pontos fixos — iterações, curvas adaptadas e pontos
ótimos encontrados.

Heurística linear sem pontos fixos
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 7 12 74.087 100,0%
c64l 18 24 151.261 100,0%
c128l *13 *35 *319.933 *101,7%
c32m 8 20 262.753 100,0%
c64m 14 47 643.853 100,0%
c128m 18 90 1.273.973 100,0%
c32h 8 207 730.929 100,0%
c64h 8 417 2.040.814 100,0%
c128h 8 833 4.065.687 100,0%

s32l 7 9 75.180 100,0%
s64l 3 7 156.452 100,0%
s128l *0 *0 — —
s32m 2 16 267.186 100,0%
s64m 4 34 671.059 100,0%
s128m 4 66 1.328.913 100,0%
s32h 4 76 748.616 100,0%
s64h 4 131 2.090.132 100,0%
s128h 4 262 4.163.832 100,0%

* Resolução do problema de otimização excedeu 10.000s



91

Tabela 9 – Otimização da produção de petróleo com modelo por relaxação e
heurística linear sem pontos fixos — tempos computacionais.

Heurística linear sem pontos fixos - tempos
Tempos Totais (s) Total

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 3,8 19,1 23,0 452% 5,6 110%
c64l 9,7 33,7 43,4 2.085% 2,6 127%
c128l *7,1 *10.658,5 *10.665,6 *105% *10.332,7 *101%
c32m 4,4 4,5 8,8 552% 0,6 40%
c64m 7,7 14,3 22,0 504% 1,4 32%
c128m 10,0 192,7 202,6 1.056% 13,5 70%
c32h 4,4 2,6 7,0 1.906% 0,3 88%
c64h 4,4 2,9 7,3 1.466% 0,4 77%
c128h 4,4 3,6 8,1 1.098% 0,6 76%

s32l 3,8 27,4 31,3 389% 4,2 52%
s64l 1,6 6,4 8,0 213% 3,6 97%
s128l — *10.198,2 *10.198,2 — — —
s32m 1,1 3,5 4,6 151% 2,3 76%
s64m 2,2 19,2 21,4 501% 7,9 185%
s128m 2,2 139,2 141,4 347% 32,6 80%
s32h 2,2 1,2 3,4 1.030% 0,3 93%
s64h 2,2 1,3 3,5 1.015% 0,3 97%
s128h 2,2 1,6 3,8 867% 0,4 98%

* Resolução do problema de otimização excedeu 10.000s

Na heurística linear, os cenários c128l e s128l excederam o limite de
10.000s para resolução do problema de otimização numa dada iteração. Os
tempos computacionais foram bastante superiores à resolução sem LPA.

Em relação à mesma heurística no modelo por aproximação, para os
cenários com baixa disponibilidade, o número de iterações aumentou consi-
deravelmente. Para estes, o problema de otimização foi resolvido mais vezes,
aumentando o tempo computacional. Nos cenários de maior disponibilidade,
os tempos foram semelhantes.

Os tempos totais foram superiores à resolução sem LPA e nos cenários
que concluíram a execução, foi obtido o mesmo ótimo do que a resolução sem
LPA – o que era esperado da relaxação.

O tempo de resolução do último problema de otimização em relação
a resolução sem LPA, foi superior para os cenários de curvas côncavas com
baixa disponibilidade e para o cenário s64m.



92

Tabela 10 – Otimização da produção de petróleo com modelo por relaxação
e heurística linear com pontos fixos — iterações, curvas adaptadas e pontos
ótimos encontrados.

Heurística linear com pontos fixos
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 7 12 74.087 100,0%
c64l 18 24 151.261 100,0%
c128l *14 *37 *319.180 *101,5%
c32m 8 20 262.753 100,0%
c64m 14 47 643.853 100,0%
c128m 18 90 1.273.973 100,0%
c32h 10 164 730.929 100,0%
c64h 8 344 2.040.814 100,0%
c128h 10 691 4.065.687 100,0%

s32l 7 9 75.180 100,0%
s64l 3 7 156.452 100,0%
s128l *0 *0 — —
s32m 2 16 267.186 100,0%
s64m 4 34 671.026 100,0%
s128m 4 66 1.328.880 100,0%
s32h 4 69 748.616 100,0%
s64h 4 126 2.090.132 100,0%
s128h 4 253 4.163.832 100,0%

* Resolução do problema de otimização excedeu 10.000s
** Máximo de 20 adaptações atingido



93

Tabela 11 – Otimização da produção de petróleo com modelo por relaxação
e heurística linear com pontos fixos — tempos computacionais.

Heurística linear com pontos fixos - tempos
Tempos Totais (s) Total

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 3,9 21,5 25,4 500% 5,6 110%
c64l 9,9 34,2 44,2 2.123% 2,6 123%
c128l *7,7 *31.369,6 *31.377,3 *308% *10.471,9 *103%
c32m 4,4 4,0 8,4 527% 0,6 36%
c64m 7,8 13,7 21,5 494% 1,6 37%
c128m 10,1 140,0 150,1 782% 14,0 73%
c32h 5,6 3,2 8,9 2.425% 0,3 84%
c64h 4,5 3,0 7,4 1.485% 0,4 71%
c128h 5,6 4,7 10,2 1.394% 0,5 75%

s32l 3,9 23,9 27,8 346% 5,2 65%
s64l 1,7 5,9 7,6 201% 3,7 99%
s128l — *10.215,8 *10.215,8 — —
s32m 1,1 2,8 3,9 129% 1,6 53%
s64m 2,2 8,5 10,8 252% 1,8 42%
s128m 2,2 70,1 72,4 177% 46,5 114%
s32h 2,3 1,2 3,5 1.051% 0,3 97%
s64h 2,3 1,4 3,6 1.067% 0,4 107%
s128h 2,2 1,6 3,8 865% 0,4 86%

* Resolução do problema de otimização excedeu 10.000s

Na heurística linear fixando os pontos, os modelos c128l e s128l atin-
giram o limite de 10.000s na resolução do problema de otimização, sendo
interrompidos.

No geral, não houve melhoras nos tempos de adaptações e foi mantida
a quantidade de iterações. A exceção foi para os modelos c32h e c128h, que
passaram de 8 para 10 iterações. Isto aumentou seus tempos computacionais,
levando até 25 vezes mais tempo do que a resolução sem LPA.

Assim como na heurística anterior, quando o algoritmo convergiu, foi
encontrado o mesmo valor do ponto ótimo do que na resolução sem LPA. Os
tempos computacionais da última otimização também foram superiores para
os cenários de curvas côncavas com baixa disponibilidade, além dos cenários
s128m e s64h.



94

Tabela 12 – Otimização da produção de petróleo com modelo por relaxação e
heurística logarítmica — iterações, curvas adaptadas e pontos ótimos encon-
trados.

Heurística logarítmica
Curvas Ob jetivo

s/LPAIterações Adaptadas Objetivo
c32l 12 23 74.087 100,0%
c64l **20 **34 **152.201 **100,6%
c128l *13 *46 *319.692 *101,7%
c32m 10 33 262.753 100,0%
c64m **20 **92 **643.853 **100,0%
c128m **20 **160 **1.274.638 **100,1%
c32h 6 129 730.929 100,0%
c64h 6 265 2.040.814 100,0%
c128h 6 531 4.065.687 100,0%

s32l 8 10 75.180 100,0%
s64l 3 7 156.452 100,0%
s128l *0 *0 — —
s32m 3 18 267.186 100,0%
s64m 5 37 671.041 100,0%
s128m 5 70 1.328.887 100,0%
s32h 3 64 748.616 100,0%
s64h 4 131 2.090.132 100,0%
s128h 4 262 4.163.832 100,0%

* Resolução do problema de otimização excedeu 10.000s
** Máximo de 20 adaptações atingido



95

Tabela 13 – Otimização da produção de petróleo com modelo por relaxação
e heurística logarítmica — tempos computacionais.

Heurística logarítmica - tempos
Tempos Totais (s) Total

s/LPA
Última U?.O.

s/LPAAdap. Otim. Tot. Otim.(s)
c32l 6,7 25,5 32,2 633% 6,0 118%
c64l **11,1 **30,1 **41,2 **1.980% **2,3 **108%
c128l *7,4 *13.074,6 *13.082,0 *128% *10.347,7 *102%
c32m 5,7 5,2 10,8 678% 0,6 35%
c64m **11,3 **20,4 **31,6 **727% **1,8 **41%
c128m **11,4 **81,6 **93,0 **485% **4,6 **24%
c32h 3,3 1,9 5,3 1.451% 0,3 90%
c64h 3,4 2,3 5,7 1.129% 0,5 92%
c128h 3,4 2,8 6,2 840% 0,5 70%

s32l 4,6 24,3 28,9 360% 2,0 25%
s64l 1,7 7,1 8,8 234% 4,0 106%
s128l — *10.227,4 *10.227,4 — — —
s32m 1,7 3,2 4,9 161% 0,6 19%
s64m 2,8 8,5 11,3 264% 0,8 19%
s128m 2,9 157,9 160,7 394% 24,3 60%
s32h 1,7 1,1 2,7 825% 0,4 114%
s64h 2,3 1,4 3,6 1.066% 0,4 105%
s128h 2,3 1,8 4,0 910% 0,5 108%

* Resolução do problema de otimização excedeu 10.000s
** Máximo de 20 adaptações atingido

Com a heurística logarítmica, os cenários c64l, c64m e c128l excede-
ram o limite de 20 iterações. Os modelos c128l e s128l atingiram o limite de
10.000s na resolução do problema de otimização.

Nos cenários com curvas côncavas e com alta disponibilidade, a heu-
rística logarítmica apresentou um menor número de iterações. Os tempos
computacionais foram bastante superiores à referência sem LPA. Em vários
cenários foi atingido o limite estabelecido de 10.000s para a resolução do
problema de otimização ou de um máximo de 20 iterações.

Os tempos computacionais da resolução do último problema de oti-
mização foi superior, em relação à resolução sem LPA, para os cenários de
curvas côncavas com baixas disponibilidade, curvas côncavas com alta dis-
ponibilidade e o cenário s64l,



96

3.3 DISCUSSÃO DOS RESULTADOS

No geral a LPA apresentou um maior tempo computacional do que na
otimização sem LPA, embora fosse esperado tempos menores pela redução da
quantidade de pontos nas curvas. Dentre as heurísticas avaliadas, para baixas
disponibilidades de gás, a linear convergiu com menor tempo computacional
e com menos iterações. Já para altas disponibilidades, a heurística logarítmica
se mostrou superior.

Isto é explicado porque nas baixas disponibilidades, o ótimo se en-
contra no início das curvas, sendo adaptado nas primeiras iterações pela heu-
rística linear. Já com maiores disponibilidades, o ponto ótimo se desloca na
curva e a heurística logarítmica, por adaptar a curva globalmente, é mais efi-
ciente.

Observou-se que na heurística linear, fixar os pontos não apresentou
ganhos computacionais significativos. Também se observou que para estas
heurísticas, nos cenários de curvas côncavas, o aumento da disponibilidade
de gás aumentou o número de iterações necessárias para atingir o ótimo.

Como um todo, o tempo mais significativo na aplicação da LPA foi o
da resolução dos problemas de otimização ao longo das iterações. Com um
aumento no número de iterações, os problemas de otimização foram resolvi-
dos mais vezes, aumentando o tempo computacional

O tempo de resolução para o último problema de otimização nem sem-
pre foi inferior ao tempo de resolução sem LPA. Em alguns casos este tempo
foi quase o dobro, o que não era esperado, uma vez que o problema com LPA
é resolvido com uma menor quantidade de pontos.

No modelo por aproximação, quando concluída a execução, foi en-
contrado ou o mesmo ponto ótimo ou um próximo ao obtido na resolução
sem LPA – embora nenhuma garantida tenha sido dada. Já no modelo por
relaxação, em todos os cenários que concluíram a execução foi encontrado o
mesmo ponto ótimo do que a resolução sem LPA. Isto era esperado, pois con-
forme demonstrado, uma relaxação quando converge para um ponto ótimo
coincidente com a curva real, é um ponto ótimo do problema original.

Por outro lado, quando quando algum limite computacional estabele-
cido é atingido, por exemplo o limite de 20 iterações, a solução encontrada
é infactível e não pode ser implementada na prática. Já no modelo por apro-
ximação, em qualquer iteração, a solução encontrada é factível e embora não
seja um valor ótimo, é uma boa solução.

Foi constatado que para o modelo por aproximação, é necessário ter
cuidado para que as adaptações de super ou subestimação não violem certas
restrições. Isto pode tornar parte do domínio original infactível, podendo
perder-se o ótimo global, conforme observado no uso de superestimação da



97

produção em relação à capacidade dos separadores.

3.4 SUMÁRIO

Neste capítulo foi apresentada a aplicação da linearização por partes
adaptativa na otimização da produção de petróleo e gás. Primeiro foi apresen-
tado o modelo não linear do campo, seguido da sua linearização por partes.

No modelo linearizado, foi aplicada a linearização por partes adapta-
tiva, sendo formulados dois modelos com objetivos e restrições diferentes:
modelo por aproximação e modelo por relaxação.

No modelo por aproximação, a função objetivo é conservadora, onde
subestima-se os lucros e superestima-se os custos. Os valores sujeitos às
restrições são superestimados de maneira que exista uma folga quando im-
plementado na prática e seja induzido um ganho econômico superior ao esti-
mado.

Já o modelo por relaxação é obtido com uma relaxação do problema
original. As condições para isto são de superestimar o ganho econômico,
subestimar custos e subestimar recursos sujeitos às restrições. Com este mo-
delo, tem-se a garantia que se for encontrado ótimo, com a curva adaptada
coincidindo com a curva real, é também um ótimo do problema original.
Ressalta-se que o modelo por aproximação não apresenta esta garantia.

Estes modelos foram então instanciados em diversos cenários com di-
ferentes número de poços (32, 64 e 128), diferentes disponibilidades de gás
de injeção (baixa, média e alta) e dois diferentes tipos de CDP (côncavo e
não côncavo). Primeiro, os cenários foram resolvidos sem usar LPA. Nesta
resolução, os tempos computacionais e pontos ótimos encontrados foram usa-
dos como referência para avaliar a LPA. Então, os modelos foram resolvidos
usando as heurísticas proposta no Capítulo 2, sendo avaliada seus tempos
computacionais e pontos ótimos encontrados.

Concluiu-se que no geral a LPA aumentou consideravelmente o tempo
computacional para encontrar o mesmo ótimo do que a resolução sem LPA. A
heurística linear foi a que apresentou melhores resultados para baixas vazões
e a logarítmica para altas vazões.

Com a heurística linear fixando pontos esperava-se reduzir o tempo
computacional da adaptação, aportando ganhos no tempo computacional glo-
bal. Isto não ocorreu, pois o custo computacional mais importante foi o da
resolução do problema de otimização ao longo das iterações e os ganhos de
uma adaptação mais eficiente foram praticamente insignificantes.



98



99

4 LINEARIZAÇÃO POR PARTES BIDIMENSIONAL

Neste capítulo a Linearização por Partes Adaptativa (LPA) é estabe-
lecida para funções bidimensionais. É feita a mesma abordagem que na uni-
dimensional: primeiro é apresentada a linearização por partes para funções
bidimensionais, sendo descrito o modelo por Combinação Convexa Desa-
gregada (DCC). Em seguida, é enunciado o problema de adaptação de uma
função linear por partes bidimensional.

O problema de adaptação é então integrado a um problema de otimi-
zação sendo propostas duas heurísticas para esta integração: linear e logarít-
mica. As heurísticas seguem as linhas gerais de suas respectivas unidimensi-
onais.

Por último, as LPA bidimensional é aplicada na resolução de proble-
mas de otimização ilustrativos. Para as duas heurísticas, são encontrados os
máximos de duas superfícies diferentes.

É importante ressaltar que na LPA bidimensional é desconsiderada a
restrição de continuidade presente na LPA unidimensional. Esta restrição tem
o objetivo de garantir que os intervalos da adaptação sejam contínuos, porém
em funções bidimensionais esta propriedade não traz benefícios. Uma con-
sequência desta escolha é que os modelos de linearização por partes utiliza-
dos no problema de otimização devem permitir descontinuidades ao utilizar
os pontos da superfície adaptada.

4.1 INTRODUÇÃO À LINEARIZAÇÃO POR PARTES BIDIMENSIONAL

Para funções de maiores dimensões, por exemplo bidimensionais
f (x1,x2), também é possível aplicar as técnicas de linearização por partes.
Neste caso, o domínio da função é discretizado em politopos, existindo di-
versos modelos para gerar a aproximação, por exemplo Combinação Con-
vexa Agregada (CC), Combinação Convexa Desagregada (DCC), Logarít-
mico (Log), Logarítmico Desagregado (DLog), Múltipla Escolha (MC), In-
cremental (INC) e SOS2 (VIELMA; KEHA; NEMHAUSER, 2008), (VI-
ELMA; NEMHAUSER, 2009) e (VIELMA; AHMED; NEMHAUSER, 2010).

Neste trabalho é usado o modelo DCC para aplicar a linearização por
partes adaptativa, sendo este detalhado na próxima seção. A escolha deste
modelo se dá pela sua simplicidade e por permitir descontinuidades na função
aproximada.



100

4.1.1 Modelo de Combinação Convexa Desagregada Bidimensional - DCC

No modelo bidimensional DCC, o domínio de interesse da função, D ,
é subdividido em um conjunto de politopos, P. Cada politopo é definido
por seu conjunto de vértices V (P), ?P ? P, sendo que para cada vértice,
v ? V (P), é definida uma variável contínua ?P,v, sob a qual é realizada a
combinação convexa para obter a aproximação linear por partes da função.

Um exemplo de domínio particionado em politopos retangulares é
apresentado na Figura 30.

A2 A3A1

A4 A6

A7 A8 A9

A5

v1,1 v1,2

v1,4 v1,3

v2,1

v2,4 v2,3

v3,1 v3,2

v3,4 v3,3

v4,1 v4,2

v4,4 v4,3

v5,1 v5,2

v5,4 v5,3

v6,1 v6,2

v6,4 v6,3

v7,1 v7,2

v7,4 v7,3

v8,1 v8,2

v8,4 v8,3

v9,1 v9,2

v9,4 v9,3

v2,2

x1

x2

Figura 30 – Exemplo de discretização do domínio de uma função bidimensio-
nal para aplicação do modelo por Combinação Convexa Desagregada - DCC.

Na figura, o domínio é discretizado em 9 politopos retangulares, {Ak : k =
1,...,9}. Cada politopo é determinado por seus 4 de vértices, V (Ak) =
{vk,i : i = 1,...,4}. Para cada politopo é associada uma variável yP que
determina se o politopo está ativo e para cada vértice, uma variável de pon-
deração, ?k,i — ambas não representadas.

Observe que cada politopo possui seu próprio conjunto de vértices,



101

embora eles se sobreponham aos dos politopos vizinhos. Com isto, a formu-
lação DCC pode apresentar descontinuidades:

?
P?P

?
v?V (P)

?P,v.v = x (4.1a)

?
P?P

?
v?V (P)

?P,v. f (v) = f? (x) (4.1b)

?
P?P

yP = 1 (4.1c)

?
v?V (P)

?P,v = yP, P ? P (4.1d)

yP ?{0,1}, P ? P (4.1e)
?P,v ? 0, v ?V (P), P ? P (4.1f)

onde:

• as Equações (4.1a) e (4.1b) estabelecem, por combinação convexa, os
valores de x e da aproximação f? ;

• a Equação (4.1c) garante que apenas um politopo é ativado;

• a Equação (4.1d) estabelece a combinação convexa.

Com o modelo linear por partes bidimensional apresentado, é formu-
lado o problema de refinamento adaptativo bidimensional.

4.2 REFINAMENTO ADAPTATIVO BIDIMENSIONAL

No caso do refinamento adaptativo bidimensional, é buscada uma adap-
tação para a superfície utilizando um conjunto reduzido de breakpoints da
função original. No caso unidimensional, a adaptação era feita por segmentos
de retas, no bidimensional é feito por planos. Assim como no caso unidimen-
sional, é apresentado nesta seção uma adaptação que superestima a função
original, f .

Para gerar a adaptação, os breakpoints do domínio da função original
são particionados em conjuntos retangulares, Ai ? A , onde
A = {A1, A2,..., Am?1, Am}. Os valores da adaptação nos vértices de cada
retângulo, f? (v),v ? V (Ai), são calculados de acordo com o plano que mini-
miza o erro e superestima a função nos breakpoints pertencentes à Ai. Com
isso, a adaptação induzida, f? , é composta por m planos que superestimam a
função original em cada uma das Ai partições.



102

A escolha de particionar o domínio D em retângulos se justifica no
momento de refinar a adaptação. Os Ai ? A podem ser subdivididos em
novos retângulos, preservando a estrutura da adaptação.

4.2.1 Modelagem Matemática da Adaptação Bidimensional

Seja a função bidimensional original f (x), definida no conjunto de
breakpoints

X ={x : (x1,x2)? X1 ×X2} (4.2a)
(4.2b)

tal que

X1 ={x1,1, x1,2, ... x1,n1?1, x1,n1} (4.3a)
X2 ={x2,1, x2,2, ... x2,n2?1, x2,n2} (4.3b)

são o conjunto de breakpoints da função original na primeira dimensão, X1,
e na segunda, X2.

Sobre o domínio, é definido o conjunto de partições retangulares

A ={A1, A2 ...Am?1, Am} (4.4a)

tal que

Ak ? X ,k = 1,...,m (4.5a)

A união destas partições é dada por

?mi=1Ai = X (4.6a)

e a interseção

Ai ?A j
i 6= j =

??
?

/0
{x1,k}×{x2,l,x2,l+1,...,x2,l}, para algum k e l ? l
{x1,l,x1,l+1,...,x1,l}×{x2,k}, para algum k e l ? l

(4.7a)

Em outas palavras, a união das partições resulta no domínio original
da função. A interseção de duas partições ou é vazia, ou um conjunto de
breakpoints contido num segmento de reta horizontal ou um conjunto de bre-
akpoints contido num segmento de reta vertical.



103

Os retângulos gerados na adaptação, A ? A , são os politopos que são
usados no problema de otimização. Os vértices fornecidos são dados pelo
conjunto dos maiores e menores breakpoints em cada dimensão contidos em
A:

V (A) ={x1,low(A), x1,high(A)}×{x2,low(A), x2,high(A)} (4.8a)

onde:

xi,low(A) = min{xi,q ? Xi(A)} (4.9a)
xi,high(A) = max{xi,q ? Xi(A)} (4.9b)

sendo Xi(A) o conjunto de breakpoints de A na i-ésima dimensão.
Para ilustrar essa formulação, seja um retângulo A ? A da Figura 31.

A

x1,4 x1,5 x1,6 x1,7 x1,8

x2,2

x2,4

x2,5

x2,3

(x1,4,x2,2) (x1,8,x2,2)

(x1,4,x2,5) (x1,8,x2,5)

Figura 31 – Exemplo de partição retangular A com os vértices da adaptação
em destaque.

A é composto pelos breakpoints da função original

A = X1(A)×X2(A) (4.10a)



104

sendo

X1(A) = {x1,4, x1,5, x1,6, x1,7, x1,8} (4.11a)
X2(A) = {x2,2, x2,3, x2,4, x2,5} (4.11b)

ou seja

A ={(x1,4,x2,2), (x1,4,x2,3), (x1,4,x2,4), (x1,4,x2,5),
(x1,5,x2,2), (x1,5,x2,3), (x1,5,x2,4), (x1,5,x2,5),

(x1,6,x2,2), (x1,6,x2,3), (x1,6,x2,4), (x1,6,x2,5), (4.12a)
(x1,7,x2,2), (x1,7,x2,3), (x1,7,x2,4), (x1,7,x2,5),

(x1,8,x2,2), (x1,8,x2,3), (x1,8,x2,4), (x1,8,x2,5)}

Os vértices de A são dados por

V (A) ={(x1,4, x2,2), (x1,4, x2,5), (x1,8, x2,2), (x1,8, x2,5)} (4.13a)

Para estabelecer o politopo da adaptação, é necessário determinar
f? (v), v ? A. Isto é feito pelo plano ótimo, com parâmetros (a?,b?), que
superestimam a função original em todos breakpoints x ? A:

(a?,b?) = min
a, b

?
x?A

[aT x + b? f (x)] (4.14a)

s.a. : aT x + b ? f (x), x ? A (4.14b)
a ?R2, b ?R (4.14c)

onde:

• a Equação (4.14a) é o erro de aproximação que deve ser minimizado;

• a Equação (4.14b) garante que o plano seja uma superestimação.

Com isso, é obtido o plano ótimo passando por b?, de normal a? que
superestima a função f no retângulo A. Ressalta-se que este problema deve
ser resolvido para cada politopo A ? A afim de se gerar a adaptação para
todo o domínio da função original f . A partir de cada plano, é estabelecido
os valores da adaptação f? nos vértices v ?V (A):

f? (A,v) = (a?)T v + b?,v ?V (A) (4.15a)



105

4.3 INTEGRAÇÃO ADAPTAÇÃO BIDIMENSIONAL-PROBLEMA DE OTI-
MIZAÇÃO

O modelo de adaptação de superfícies bidimensionais é então inte-
grado ao problema de otimização. Assim como no caso unidimensional, fo-
ram desenvolvidas duas heurísticas para realizar a adaptação a partir do ponto
ótimo: linear e logarítmica.

Na linear, espera-se que o ponto ótimo encontrado esteja próximo ao
ótimo global e refina-se a região no entorno. Já na logarítmica, a partição
onde foi encontrado o ponto ótimo, A?, é subdividida.

4.3.1 Heurística Linear

Seja x? = (x?1,x
?
2), o ponto no domínio da função objetivo onde foi

encontrado o ótimo do problema de otimização e A? o retângulo que contém
x?, conforme ilustrado na Figura 32.



106

A?

x1,l x1,l+1

x?

x1,c1 x1,c1+1 x1,c1+2 x1,n?1

x2,m

x2,m+2

x2,c2

x2,m+1

x2,c2+1

x2,n?2

A# A#A#

A# A#

A# A# A#

Figura 32 – Heurística linear para gerar novos retângulos no modelo bidimen-
sional.



107

Seja X (A) o conjunto de breakpoints da função original que compõe
o domínio de A, sendo

X (A?) = X1(A
?)×X2(A?) (4.16a)

onde

X1(A
?) = {x1,l, x1,l+1 ... x1,n?1?1, x1,n?1} (4.17a)

X2(A
?) = {x2,m, x2,m+1 ... x2,n?2?1, x2,n?2} (4.17b)

Sejam também os pontos de corte em cada uma das dimensões, onde
X ?i (A

?) = Xi(A?)\{xi,n?i}:

x1,c1 = min{x1, j ? X
?

1 (A
?) : x1, j ? x?1 ? x2, j+1} (4.18a)

x2,c2 = min{x2, j ? X
?

2 (A
?) : x2, j ? x?2 ? x2, j+1} (4.18b)

No caso geral, a nova aproximação consiste em subdividir A? em 9
novos retângulos, ilustrados na Figura 33 — as partições A# de f? permanecem
iguais ao subdividir A?.

A subdivisão de A? é feita a partir dos pontos de corte, x1,c1 e x2,c2 :

X (A1) = {x1,l,x1,l+1,...,x1,c1} × {x2,m,x2,m+1,...,x2,c2}
X (A2) = {x1,c1 ,x1,c1+1} × {x2,m,x2,m+1,...,x2,c2}
X (A3) = {x1,c1+1,x1,c1+2,...,x1,n?1} × {x2,m,x2,m+1,...,x2,c2}
X (A4) = {x1,l,x1,l+1,...,x1,c1} × {x2,c2 ,x2,c2+1}
X (A5) = {x1,c1 ,x1,c1+1} × {x2,c2 ,x2,c2+1}
X (A6) = {x1,c1+1,x1,c1+2,...,x1,n?1} × {x2,c2 ,x2,c2+1}
X (A7) = {x1,l,x1,l+1,...,x1,c1} × {x2,c2+1,x2,c2+2,...,x2,n?2?1,x2,n?2}
X (A8) = {x1,c1 ,x1,c1+1} × {x2,c2+1,x2,c2+2,...,x2,n?2?1,x2,n?2}
X (A9) = {x1,c1+1,x1,c1+2,...,x1,n?1} × {x2,c2+1,x2,c2+2,...,x2,n?2?1,x2,n?2}

No caso geral a divisão resulta em 9 retângulos. Caso o ponto ótimo
esteja próximo à um dos lados de A?, este é subdividido em 6 retângulos e
caso esteja próximo a um vértice, em 4 retângulos.



108

x1,l x1,l+1 x1,c1 x1,c1+1 x1,c1+2 x1,n?1

x2,m

x2,m+2

x2,c2

x2,m+1

x2,c2+1

x2,n?2

A# A#A#

A# A#

A# A# A#

A7 A8 A9

A4 A5 A6

A1 A2 A3

Figura 33 – Resultado da aplicação da heurística linear para gerar novos re-
tângulos no modelo bidimensional.



109

4.3.2 Heurística Logarítmica

Na heurística logarítmica, o retângulo A?, no qual foi encontrado o
ponto ótimo x?, é subdividido ao meio em cada dimensão, resultando em 4
novos retângulos. Para isto, é usado o breakpoint em cada dimensão mais
próximo ao meio, sendo seus índices dados por

c1 = round(avg(l + n?1)) (4.19a)
c2 = round(avg(m + n?2)) (4.19b)

conforme apresentado na Figura 34.



110

A?

x1,l x1,l+1

x?

x1,c1 x1,c1+1 x1,c1+2 x1,n?1

x2,m

x2,c2

x2,m+1

x2,c2+1

x2,n?2

A# A#A#

A# A#

A# A# A#

x2,c2+2

Figura 34 – Heurística logarítmica para gerar novos retângulos no modelo
bidimensional.



111

A nova aproximação subdivide A? em 4 novos retângulos:

X (A1) = {x1,l,x1,l+1,...,x1,c1} × {x2,m,x2,m+1,...,x2,c2}
X (A2) = {x1,c1 ,x1,c1+1,...,x1,n?1} × {x2,m,x2,m+1,...,x2,c2}
X (A3) = {x1,l,x1,l+1,...,x1,c1} × {x2,c2 ,x2,c2+1,...,x2,n?2?1,x2,n?2}
X (A4) = {x1,c1 ,x1,c1+1,...,x1,n?1} × {x2,c2 ,x2,c2+1,...,x2,n?2?1,x2,n?2}

O resultado da nova partição de A? é apresentado na Figura 35.

x1,l x1,l+1 x1,c1 x1,c1+1 x1,c1+2 x1,n?1

x2,m

x2,c2

x2,m+1

x2,c2+1

x2,n?2

A# A#A#

A# A#

A# A# A#

A4

A1 A2

A3

x2,c2+2

Figura 35 – Resultado da aplicação da heurística logarítmica para gerar novos
retângulos no modelo bidimensional.



112

4.4 APLICAÇÃO DA LINEARIZAÇÃO POR PARTES ADAPTATIVA BI-
DIMENSIONAL

As heurísticas apresentadas, linear e logarítmica, foram aplicadas num
problema ilustrativo de otimização, sendo implementado o mesmo ciclo itera-
tivo de resolver o problema de otimização e adaptar a superfície do Capítulo
2.

O problema de otimização consiste em achar o valor máximo de uma
superfície, sendo ensaiadas duas superfícies diferentes: uma gerada por pon-
tos aleatórios, Figura 36, e outra composta pela sobreposição de 3 Gaussianas,
Figura 37. Nas figuras é indicado o local do ponto ótimo (valor máximo da
superfície), x?.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12

x

Figura 36 – Superfície gerada por pontos aleatórios.

A superfície aleatória foi gerada por uma distribuição uniforme, com
valores entre 0 e 12. Na primeira dimensão, existem 11 breakpoints, X1 =
{0,5,10,...,50} e na segunda dimensão, 15 X2 = {0,5,10,...,70}. Seu do-
mínio possui um total de 140 retângulos.



113

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x

Figura 37 – Superfície gerada pela sobreposição de 3 Gaussianas.

As Gaussianas da superfícies foram geradas cada uma pela equação

G(x,y) = C exp(?(a(x?x0)2 + 2b(x?x0).(y?y0)+ c(y?y0)2)) (4.20a)

sendo

a =
cos2(? )

2? 2x
+

sin2(? )
2? 2y

(4.21a)

b =
?sin(2? )

4? 2x
+

sin(2? )
4? 2y

(4.21b)

c =
sin2(? )

2? 2x
+

cos2(? )
2? 2y

(4.21c)

onde:

• C é a constante de proporcionalidade da Gaussiana, que determina seu
máximo;



114

• (x0,y0) é o centro da Gaussiana;

• ? é rotação da Gaussiana no sentido horário;

• ?x e ?y são os desvios padrões nos respectivos eixos.

As 3 Gaussianas foram sobrepostas por adição simples sendo seus pa-
râmetros descritos na Tabela 14:

Tabela 14 – Parâmetros das Gaussianas.

G1 G2 G3
(x0,y0) (40,20) (10,50) (14,22)
C 10 8 6
? ?/3 2?/3 0
?x 10 15 6
?y 15 20 6

A superfícies com as Gaussianas possui 26 breakpoints na primeira
dimensão, X1 = {0,2,4,...,50}, e 36 na segunda, X2 = {0,2,4,...,70}. O
domínio da função possui um total de 875 retângulos.

Para encontrar o ótimo nas superfícies, foi usada a linearização por
partes adaptativa que superestima a função original, sendo os resultados apre-
sentados na próximas seções.



115

4.4.1 Heurística Linear para Superfície de Pontos Aleatórios

A heurística linear foi aplicada para encontrar o máximo da superfície
da Figura 36, gerada por pontos aleatórios. São apresentadas adaptação inicial
e as adaptações das iterações 1, 2 e 18 (última) nas Figuras 38, 39, 40 e
41, respectivamente. Também são apresentadas as partições do domínio da
função original.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x0

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12
x0

(b) Adaptação da superfície.

Figura 38 – Adaptação inicial da superfície com pontos aleatórios.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x1

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12 x1

(b) Adaptação da superfície.

Figura 39 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica linear, iteração 1.



116

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x2

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12

x2

(b) Adaptação da superfície.

Figura 40 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica linear, iteração 2.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x18

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12

x18

(b) Adaptação da superfície.

Figura 41 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica linear, iteração 18 (última).

Para encontrar o máximo na superfície de pontos aleatórios, usando
a LPA bidimensional com heurística linear, foram necessárias 18 iterações.
Na adaptação final, quando o ótimo da adaptação x?18 pertence à curva real, o
domínio da função foi particionado em 36 retângulos.



117

4.4.2 Heurística Linear para Superfície com Três Gaussianas

A heurística linear foi aplicada para encontrar o máximo da superfí-
cie da Figura 37, gerada pela sobreposição de 3 Gaussianas. O algoritmo
convergiu para o ótimo na iteração 45.

São apresentadas a adaptação inicial e as adaptações das iterações 1, 2
e 45 nas Figuras 42, 43, 44 e 45, respectivamente. Também são apresentadas
as partições do domínio da função original.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x0

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16 x0

(b) Adaptação da superfície.

Figura 42 – Adaptação inicial da superfície composta por 3 Gaussianas.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x1

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x1

(b) Adaptação da superfície.

Figura 43 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 1.



118

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x2

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x2

(b) Adaptação da superfície.

Figura 44 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 2.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x45

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x45

(b) Adaptação da superfície.

Figura 45 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística linear, iteração 45 (última).

Para encontrar o máximo na superfície composta por 3 Gaussianas,
usando a heurística linear, foram necessárias 45 iterações. Na adaptação final,
quando x?45 pertence à curva real, o domínio da função foi particionado em 36
retângulos.



119

4.4.3 Heurística Logarítmica para Superfície de Pontos Aleatórios

A heurística logarítmica foi aplicada para encontrar o máximo da su-
perfície gerada por pontos aleatórios, Figura 36. O algoritmo convergiu para
o ótimo na iteração 15, um menor número de iterações que a heurística linear.

São apresentadas a adaptação inicial e as adaptações das iterações 1, 2
e 15 nas Figuras 46, 47, 48 e 49, respectivamente. Também são apresentadas
as partições do domínio da função original.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x0

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12
x0

(b) Adaptação da superfície.

Figura 46 – Adaptação inicial da superfície com pontos aleatórios.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x1

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12

x1

(b) Adaptação da superfície.

Figura 47 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica logarítmica, iteração 1.



120

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x2

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12 x2

(b) Adaptação da superfície.

Figura 48 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica logarítmica, iteração 2.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x15

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0

2

4

6

8

10

12

x15

(b) Adaptação da superfície.

Figura 49 – Adaptação da superfície com pontos aleatórios usando a heurís-
tica logarítmica, iteração 15 (última).

Para encontrar o máximo na superfície de pontos aleatórios, usando
a heurística logarítmica, foram necessárias 15 iterações. Na adaptação final,
quando x?15 pertence à curva real, o domínio da função foi particionado em 53
retângulos.



121

4.4.4 Heurística Logarítmica para Superfície com Três Gaussianas

A heurística logarítmica foi aplicada para encontrar o máximo da su-
perfície gerada pela sobreposição de 3 Gaussianas, Figura 37. O algoritmo
convergiu para o ótimo na iteração 17, um número menor de iterações do que
a heurística linear.

São apresentadas a primeira adaptação e as adaptações das iterações 1,
2 e 17 nas Figuras 50, 51, 52 e 53, respectivamente. Também são apresentadas
as partições do domínio da função original.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x0

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16 x0

(b) Adaptação da superfície.

Figura 50 – Adaptação inicial da superfície composta por 3 Gaussianas.



122

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x1

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x1

(b) Adaptação da superfície.

Figura 51 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 1.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x2

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x2

(b) Adaptação da superfície.

Figura 52 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 2.



123

0

10

20

30

40

50

0
10

20
30

40
50

60
70

x17

(a) Partição do domínio.

0

10

20

30

40

50

0
10

20
30

40
50

60
70

0
2
4
6
8

10
12
14
16

x17

(b) Adaptação da superfície.

Figura 53 – Adaptação da superfície composta por 3 Gaussianas usando a
heurística logarítmica, iteração 17 (última).

Para encontrar o máximo na superfície composta por 3 gaussianas,
usando a heurística logarítmica, foram necessárias 17 iterações. Na adaptação
final, quando x?17 pertence à curva real, o domínio da função é particionado
em 53 retângulos.

4.5 RESULTADOS

Em todos os cenários foi encontrado o máximo da superfície, sendo
que a heurística logarítmica convergiu com um menor número de iterações,
conforme sintetizado na Tabela 15.

Tabela 15 – Iterações necessárias para se encontrar o máximo nas superfície
usando as diferentes heurísticas.

Superfície
Pontos Sobreposição de

Aleatórios 3 Gaussianas

Heurística
Linear 18 45

Logarítmica 15 17

Na Tabela 16, é apresentado a quantidade de partições gerada por cada
heurística na ultima iteração — a que convergiu:

Pode-se observar que LPA bidimensional encontrou o máximo nas su-
perfícies com uma quantidade reduzida de politopos. Para a superfície de



124

Tabela 16 – Quantidade de partições do domínio na última iteração de adap-
tação, por heurística e por superfície. Também a quantidade de politopos na
função original.

Superfície
Pontos Sobreposição de

Aleatórios 3 Gaussianas

Heurística
Linear 36 73

Logarítmica 37 53
Função Original 140 875

pontos aleatórios, a heurística linear particionou o domínio em 36 retângulos,
já a logarítmica em 37. Na superfície composta por 3 Gaussianas, a linear
particionou em 73 e a logarítmica em 53. Conclui-se que o funcionamento da
linearização por partes adaptativa bidimensional foi validado.

4.6 SUMÁRIO

Nesta seção foi apresentada a linearização por partes bidimensional e
a formulação matemática do modelo DCC para funções bidimensionais. Com
base no modelo DCC, foi apresentada uma formulação matemática para gerar
uma adaptação da superfícies com menos breakpoints que a função original.
Esta adaptação subdivide o domínio da função original em retângulos e gera
planos que superestimam a função original em cada partição.

Para integrar o modelo de adaptação com o problema de otimização,
foram definidas duas heurísticas que geram novas adaptações a partir do ponto
ótimo encontrado: linear e logarítmica. Para ilustrar seus funcionamentos, fo-
ram resolvidos problemas de encontrar o ponto máximo em uma superfície,
sendo utilizadas 2 superfícies: uma gerada por pontos aleatórios e outra ge-
rada pela sobreposição de 3 gaussianas.

Por último foram apresentados os resultados da aplicação da LPA bi-
dimensional. A heurística logarítmica convergiu com menos iterações. A
quantidade de politopos geradas na última adaptação ou foi próxima, ou me-
nor para a heurística logarítmica.



125

5 CONCLUSÃO

Neste trabalho é apresentada a Linearização por Partes Adaptativa que
consiste num processo no qual são geradas adaptações de curvas lineares por
partes utilizando subconjunto reduzido dos seus breakpoints. Estas adapta-
ções são refinadas através de um processo iterativo com o problema de otimi-
zação, sendo almejado facilitar a convergência do problema.

No Capítulo 2 é apresentada a Linearização por Partes Unidimensio-
nal. A partir de uma função linear por partes é enunciada a formulação ma-
temática para o problema de adaptação de uma curva unidimensional, sendo
este validado com um exemplo simples de adaptação. A formulação da adap-
tação é então integrada a um problema de otimização, resultando na Lineari-
zação por Partes Adaptativa – LPA. Para realizar esta integração são propos-
tas 3 heurísticas, que geram novas adaptações a partir do último ponto ótimo
encontrado, são elas: linear, linear fixando pontos e logarítmica.

A heurística linear visa inserir pontos no entorno do ponto ótimo en-
contrado. A linear fixando os pontos tem como objetivo o mesmo da linear,
porém fixando os pontos distantes do ótimo a fim de se reduzir o tempo para
gerar a adaptação. Já a heurística logarítmica busca refinar os intervalos, e
não a região, próximos ao ponto ótimo. Esta abordagem refina a curva de
forma mais global. As três heurísticas foram aplicadas em exemplos simples
com sucesso.

No Capítulo 3, a LPA unidimensional é aplicada a um problema real
de otimizar a produção num campo de petróleo e gás. A partir de modelos
de adaptação que superestimam e subestimam as CDPs, foram definidos dois
modelos de campos de petróleo: por aproximação e por relaxação.

O modelo por aproximação é conservador, superestima os custos e
subestima as receitas. Desta forma, uma solução quando implementada na
prática induz um lucro maior e uma folga adicional nas restrições do que pre-
viamente estimado. Outra vantagem é que a qualquer momento da adaptação,
a solução encontrada é factível. Conforme observado, a solução encontrada
pode não ser um ótimo global, mas é uma boa solução. Porém, este modelo
requer certas precauções: a superestimação dos custos pode violar algumas
restrições, tornando parte do domínio original do problema infactível.

O outro modelo é uma relaxação do problema original, sendo a abor-
dagem inversa do modelo por aproximação: receitas são superestimadas e
custos subestimados. Com este modelo tem-se a garantia de que quando a
LPA convergir, com o ótimo coincidindo com a curva real, será encontrado o
ótimo global. Uma desvantagem deste modelo é que soluções intermediárias
são infactíveis.



126

Os modelos são então instanciados em diferentes cenários, com vari-
adas quantidades de poços, diferentes tipos de CDPs e diferentes disponibi-
lidades de gás de injeção. Nestes cenários, são avaliados os pontos ótimos
encontrados, assim como os tempos computacionais.

No geral, a LPA unidimensional não trouxe ganhos computacionais
em relação a uma resolução convencional sem LPA, levando em alguns ca-
sos até 25 vezes mais tempo. Os maiores custos computacionais foram na
resolução do problema de otimização por serem resolvidos diversas vezes ao
longo das iterações. Por este motivo, os ganhos de tempo na adaptação com
a heurística linear fixando pontos foram praticamente insignificantes.

Nos cenários com baixa disponibilidade de gás de injeção, no geral,
a heurística linear convergiu com menos iterações do que a logarítmica. Isto
se deve a um fato observado neste problema para estas disponibilidades: ge-
ralmente o ponto ótimo se encontra no início da curva, com baixas vazões de
gás de injeção. sendo a região do ótimo adaptada com poucas iterações. Para
maiores disponibilidades de gás de injeção, o ponto ótimo se deslocou para
a direita, com maiores valores de vazão de gás. Nestes casos, a heurística
logarítmica convergiu com menos iterações.

Dentre os modelos avaliados, no geral os por relaxação precisaram de
um maior número de iterações para convergir do que o modelo por aproxi-
mação. Como esperado, foi verificado que o modelo por aproximação nem
sempre convergiu para o ótimo, porém sempre encontrando boas e factíveis
soluções. Já o modelo por relaxação, quando convergiu sempre encontrou o
ótimo global.

Pode-se concluir que no geral a Linearização por Partes Adaptativa
funciona. Porém nos exemplos unidimensionais onde foi aplicada, sua perfor-
mance ficou abaixo do esperado, levando no geral mais tempo para convergir
do que se o problema fosse resolvido sem LPA.

Pode-se concluir que a LPA é uma técnica indicada para problemas
em que funções lineares por partes representam uma importante parcela da
complexidade. Ela também pode ser usada em problemas no qual se deseja
obter um modelo do problema no entorno do ponto ótimo de funcionamento.
Desta forma, o modelo é estabelecido offline e quando implementado na prá-
tica pouca, ou nenhuma, adaptação é necessária.

Outro exemplo candidato à aplicação são problemas muito grandes,
nos quais não há memória suficiente para instância-los. A LPA pode ser
usada para gerar modelos menores, que são refinados somente nas regiões
necessárias.

Para funções de maiores dimensão, especula-se que a importância da
LPA no tempo computacional seja significativa. Tendo isto em vista, foram
enunciadas no Capítulo 4 as bases para a LPA bidimensional. Para isto, pri-



127

meiro é formulado o problema de adaptação bidimensional. Este é então in-
tegrado a um problema de otimização, sendo propostas duas heurísticas para
gerar as novas adaptações: linear e logarítmica. Ambas heurísticas tem o
mesmo objetivo e conceito das suas respectivas unidimensionais.

O funcionamento da LPA bidimensional é então verificado na busca
pelo máximo em duas superfícies diferentes: uma gerada por pontos aleató-
rios e outra gerada pela sobreposição de três funções Gaussianas.

Uma escolha feita no modelo bidimensional é de desconsiderar a res-
trição de continuidade, pois ela mais acrescenta complexidade do que traz
benefícios. Com isso, os modelos lineares por partes utilizados no problema
de otimização — os que usam os pontos da superfície adaptada — devem
permitir descontinuidades, tais como o modelos DCC e DLog.

5.1 CONTRIBUIÇÕES

Algumas contribuições resultantes deste trabalho são:

• Formulação matemática para gerar adaptações de curvas lineares por
partes unidimensionais, que superestimam ou subestimam a curva, com
um subconjunto reduzido de breakpoints da função original.

• Integração e acoplamento do problema de adaptação com o problema
de otimização, resultando na Linearização por Partes Adaptativa Uni-
dimensional.

• Proposta de três heurísticas para a LPA unidimensional para gerar ada-
ptações a partir do ponto ótimo encontrado: linear, linear fixando pon-
tos e logarítmica.

• Proposta de dois modelos de campos de petróleo a partir das formula-
ções da LPA: modelo por aproximação e modelo por relaxação.

• Validação do funcionamento da LPA na aplicação de otimização da
produção de petróleo e gás, sendo avaliados os resultados e tempos
computacionais obtidos.

• Formulação matemática da LPA bidimensional, sendo propostas duas
heurísticas para gerar adaptações a partir do ponto ótimo: linear e lo-
garítmica.

• Validação do modelo de LPA bidimensional e suas heurísticas em exem-
plos ilustrativos.



128

5.2 TRABALHOS FUTUROS

Embora este trabalho tenha abordado diversos pontos e trazido diver-
sas contribuições, bastante resta a ser desenvolvido.

Um exemplo seria avaliar a performance da LPA Unidimensional com
“partida a quente”. No contexto da LPA, a partida a quente consistiria em,
ao gerar uma nova adaptação, definir como ponto de partida para o solver
o último ponto ótimo encontrado projetado na curva adaptada. Nas aplica-
ções deste trabalho, nenhum cuidado foi levado em relação a este aspecto.
Especula-se que a partida a quente poderia acelerar consideravelmente a re-
solução dos problemas de otimização subsequentes.

Outra sugestão de trabalho futuro seria de usar a LPA bidimensional
numa aplicação real, por exemplo em problema de otimização de petróleo e
gás cujas CDPs sejam mais realistas, sendo funções não apenas do gás de
injeção. Para estes exemplos, poderiam ser feitas as mesmas avaliações de
tempos computacionais e resultados obtidos neste trabalho.



129

REFERÊNCIAS BIBLIOGRÁFICAS

BP, B. P. BP Workbook of Historical Data. March 2012.
&lt;http://www.bp.com/extendedsectiongenericarticle.do?
categoryId=9041229&amp;amp;contentId=7075080&gt;.

CAMPONOGARA, E.; CONTO, A. de. Lift-gas allocation under
precedence constraints: MILP formulation and computational analysis. IEEE
Transactions on Automation Science and Engineering, v. 6, n. 3, p. 544–551,
july 2009.

CAMPONOGARA, E.; NAKASHIMA, P. H. Solving a gas-lift optimization
problem by dynamic programming. European Journal of Operational
Research, v. 174, n. 2, p. 1220–1246, 2006.

CODAS, A. Otimização da Produção de Poços de Petróleo com Injeção
Contínua de Gás e Alinhamento Poço-Separador: Modelos Lineares por
Partes e Algoritmos. Dissertação (Mestrado) — Programa de Pós-Graduação
em Engenharia de Automação e Sistemas, UFSC, 2011.

CODAS, A.; CAMPONOGARA, E. Test instances of the lift-gas
allocation problem with well-separator routing in AMPL format. 2011.
&lt;http://www.das.ufsc.br/?camponog/EJOR-glcsep-paper&gt;.

FOURER, R.; GAY, D. M.; KERNINGHAN, B. W. AMPL - A Modeling
Language for Mathematical Programming. New York, NY: Thomson
Brooks/Cole, 2003.

GEIßLER, B. Towards Globally Optimal Solutions for MINLPs
by Discretization Techniques with Applications in Gas Network
Optimization. Tese (Doutorado) — Naturwissenschaftlichen fakultät der
Friedrich-Alexander-Universität Erlangen-Nürnnberg, 2011.

MISENER, R.; GOUNARIS, C. E.; FLOUDAS, C. A. Global optimization
of gas lifting operations: A comparative study of piecewise linear
formulations. Industrial &amp;amp; Engineering Chemistry Research, v. 48, n. 13, p.
6098–6104, 2009.

PADBERG, M. Approximating separable nonlinear functions via mixed
zero-one programs. Operations Research Letters, v. 27, n. 1, p. 1–5, 2000.

SHERALI, H. D. On mixed-integer zero-one representations for separable
lower-semicontinuous piecewise-linear functions. Operations Research
Letters, v. 28, p. 155–160, 2001.



130

SILVA, T. L. Formulações Inteiras Mistas para Modelos Lineares por
Partes Mulidimensionais: Aplicações na Otimização da Produção de
Petróleo sob Restrições de Pressão. Dissertação (Mestrado) — Programa de
Pós-Graduação em Engenharia de Automação e Sistemas, UFSC, 2012.

TSOSKOUNOGLOU, M.; AYERIDES, G.; TRITOPOULOU,
E. The end of cheap oil: Current status and prospects. Energy
Policy, v. 36, n. 10, p. 3797 – 3806, 2008. ISSN 0301-4215.
&lt;http://www.sciencedirect.com/science/article/pii/S0301421508002322&gt;.

VASUDEVA, V. Optimization problems using piecewise linear
approximation. Phoenix 2012 Informs. 2012.

VIELMA, J.; KEHA, A.; NEMHAUSER, G. Nonconvex, lower
semicontinuous piecewise linear optimization. Discrete Optimization, v. 5,
n. 2, p. 467–488, 2008.

VIELMA, J.; NEMHAUSER, G. Modeling disjunctive constraints with
a logarithmic number of binary variables and constraints. Mathematical
Programming, v. 128, n. 1-2, p. 49–72, 2009.

VIELMA, J. P.; AHMED, S.; NEMHAUSER, G. Mixed-integer models
for nonseparable piecewise-linear optimization: Unifying framework and
extensions. Operations Research, v. 58, n. 2, p. 303–315, 2010.

WINKLER, H. W.; BLANN, J. R. In: ARNOLD, K. E.; LAKE, L. W. (Ed.).
Petroleum Engineering Handbook. Austin, Texas: Society of Petroleum
Engineers, 2007. v. 4, cap. Gas Lift.

WOLSEY, L. A. Integer Programming. New York, NY: John Wiley &amp;amp; Sons,
1998.


</field>
	</doc>
</add>