<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-BT.04727</field>
		<field name="filename">BTP_2002_45_2_07_Modelagem_dinamica.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">MODELAGEM DINÂMICA EM REDES DE ESCOAMENTO COMPRESSÍVEL PARA APLICAÇÕES À DETECÇÃO DE VAZAMENTOS EM TEMPO REAL
DYNAMIC MODELING IN COMPRESSIBLE FLOW
SYSTEMS FOR APPLICATION IN REAL TIME LEAK DETECTION
MODELADO DINÁMICO EN REDES DE TRANSPORTE DE FLUJO COMPRESIBLE PARA APLICAR ENLA DETECCIÓN DE PÉRDIDAS EN TIEMPO REAL
Joaquim Pamponet Pires Neto Laboratório SDV - Dutos Escola de Química Universidade Federal do Rio de Janeiro (UFRJ) e-mail: joaquim@copene.com.br
RESUMO
É notável a escassez de uma ferramenta computacional que elabore uma análise do comportamento transiente das variáveis de processo num escoamento compressível, principalmente em partidas e paradas de planta. A partir deste cenário, desenvolve-se, aqui, modelagem e simulação dinâmica de redes de escoamento compressível e apresenta-se uma proposta de metodologia computacional para detectar vazamentos em tempo real. O modelo fenomenológico está fundamentado nas equações da continuidade e de momento em regime transiente. Considerou-se escoamento unidimensional e isentrópico de gás natural. O conjunto de equações diferenciais é resolvido com integrações numéricas no tempo, via métodos Runge-Kutta, após aplicação do método de elementos finitos no contínuo espacial. A metodologia proposta para detecção de vazamentos tem como base modelo paramétrico estocástico auto-regressivo. O procedimento consiste em gerar séries de dados de entrada e saída transientes do processo, tais como pressões nodais e vazões de escoamento nos tubos, sob a ocorrência de eventos programados pelo simulador dinâmico e empregá-las para treinamento de preditores MIMO em estrutura de modelo ARX permanentemente atualizados. A manifestação de um vazamento é detectada pelo afastamento instantâneo, estatisticamente válido, fora dos limites de confiança, entre um conjunto de predições e as medições correspondentes do processo.
ABSTRACT
It is remarkable how there are hardly any computer tools that can build a transient behavioral analysis of process variables in a compressible flow, especially during starting and shutdown of plant. From this scenario, a modeling and dynamic simulation of compressible flow systems was built, and a computer method for detecting leaks in real time was presented. The phenomenon model is based on moment and continuity equations in transient basis. Unidimensional and isentropic natural gas flow was considered. The set of differential equations is solved through numerical integrations in time, using Runge-Kutta methods, after applying the finite elements method to spatial continuum. The suggested method for detection of leaks is based on the self-regressive stochastic parametric model. The procedure consist in generating process transient input and output data series, such as nodal pressures and flow rates in pipes, during the occurrence of the events programmed by the dynamic simulator and use them during training of IMO predictors in RX model structure, with constant
update. The manifestation of a leak is detected by the instant deviation, statistically significant and beyond safety limits, between a group of predictions and the corresponding process measures.
RESUMEN
Es notable la escasez de una herramienta computacional que elabore un análisis del comportamiento transiente de las variables de proceso de un transporte de flujo compresible, principalmente en los aspectos asociados con las partidas y paradas de planta. A partir de este escenario, se desarrolla aquí, el modelado y la simulación dinámica de redes de transporte de flujo compresible y se presenta una propuesta de metodología computacional para detectar fugas o pérdidas en tiempo real. El modelo fenomenológico está fundamentado en ecuaciones de continuidad y de momento en régimen transiente. Se consideró un transporte de flujo unidimensional e isentrópico de gas natural. El conjunto de ecuaciones diferenciales es resuelto con integraciones numéricas en el tiempo, por medio de los métodos de Runge-Kutta, después de la aplicación del método de elementos finitos en el continuo espacial. La metodología propuesta para la detección de fugas o pérdidas se basa en el modelo paramétrico estocástico autoregresivo. El procedimiento consiste en generar series de datos de entrada y salida transientes del proceso, tales como presiones nodales y caudales del flujo de descarga en los tubos, considerando la ocurrencia de eventos programados por el simulador dinámico y emplearlas en el entrenamiento de predictores MIMO en estructura de modelo ARX que son permanentemente actualizados. La manifestación de una fuga o pérdida es detectada por el distanciamiento instantáneo, estadísticamente significante, fuera de los limites de confianza, entre un conjunto de predicciones y las mediciones del proceso correspondientes.
NOTAÇÃO
S	Seção transversal do tubo
(m2)
x	Posição axial do tubo
(m)
t	Tempo	(s)
p	Densidade	(kg/m3)
q	Vazão mássica	(kg/s)
p	Pressão	(Pa)
V	Velocidade	(m/s)
D	Diâmetro do tubo	(m)
F	Tensão cizalhante da parede do tubo	(kg(m/s)/m2s)
g	Aceleração da gravidade	(m/s2)
a	Ângulo de inclinação do tubo	(graus)
f	Fator de atrito	
e	Rugosidade do tubo	(m)
m	Viscosidade do fluido	(kg m/s)
PM	Massa molar	(kg/gmol)
V	Volume do fluido	m3
g	Razão entre as Capacidades Caloríficas do fluido (Cp/Cv)	
P	Pressão de referência	(Pa)
P 0	Densidade de referência	(kg/m3)
Y	Vetor de estado contendo pressão “P” e vazão “q”	
1.	INTRODUÇÃO
O transporte de produtos químicos, tais como gás natural, eteno, nafta, óleos pesados, etc., são normalmente feitos através de dutos. Mesmo se apresentando como um dos meios mais eficientes e econômicos, há sempre o risco associado da ocorrência de acidentes. Estes sistemas normalmente transportam materiais inflamáveis, sob pressão e/ou com alto poder de toxicidade, que estão sujeitos a falhas operacionais e vazamentos. Agrega-se a este fato, além da perda de produto transportado, estas linhas ou sistemas não raramente cruzarem zonas de ocupação humana ou áreas de proteção ambiental, o que agrava o potencial de risco envolvido e a seriedade dos danos causados. Desta forma, a detecção instantânea de anormalidades operacionais, principalmente de vazamentos, nestes sistemas de distribuição e transporte podem minimizar ou até mesmo evitar, desde pequenas perdas de material transportado até acidentes de proporções catastróficas.
A partir deste cenário, desenvolve-se, aqui, modelagem e simulação dinâmica de redes de escoamento compressível e apresenta-se um algoritmo computacional capaz de detectar vazamentos em tempo real.
O modelo determinístico desenvolvido para a análise dinâmica de redes de escoamento compressível está fundamentado nas equações de continuidade e de momento. O comportamento transiente está caracterizado pelas variáveis, em função do tempo e do espaço, a serem expressas. Assim sendo, o comportamento dinâmico das variáveis de estado do sistema emerge da solução numérica de duas equações diferenciais parciais ordinárias não-lineares, não-homogêneas de primeira ordem, referente à pressão e vazão do sistema. O modelo dinâmico de escoamento compressível é resolvido com integrações numéricas em tempo, via métodos Runge-Kutta com ajuste de passo, após discretização do problema pelo método de elementos finitos aplicando o formalismo Galerkin no espaço, com funções-base do tipo pulso triangular.
O sistema de detecção de vazamento utiliza modelo paramétrico ARX-MIMO (“Auto-Regressive, Exogenous Signal”) (Box, G.; Jenkins, G.M.; Reisel, G.C.)(9). Basicamente, este sistema processará uma significativa massa de dados originada da simulação do modelo determinístico previamente desenvolvido. Estas séries temporais são empregadas para treinamento dos preditores ARX-MIMO, identificando um modelo empírico entre as variáveis de estado de entrada e de saída do sistema. Este modelo relacional terá condições de estimar o comportamento das variáveis de estado (pressão e vazão) nos pontos de monitoração Ljung, L.(10). O algoritmo será capaz de elaborar análise estatística entre os estados medidos e os estimados e, caso existam discrepâncias entre predições e variáveis de processo fora dos limites de confiança da variável predita, haverá detecção de anormalidades operacionais naqueles pontos de monitoração do sistema, constatando-se a existência de um vazamento na rede simulada.
2.	REVISÃO BIBLIOGRÁFICA
2.1.	Modelagem Dinâmica de Escoamento Compressível
O comportamento da pressão, vazão e temperatura em processos de escoamento tem sido amplamente estudado. A maioria dos trabalhos existentes na década de 80, até meados da década de 90, aborda o problema de forma simplificada, apresentando e implementando modelos baseados em condições estacionárias. Nota-se, contudo, que este tipo de abordagem não tem demonstrado aplicação satisfatória em grandes redes de escoamento, as quais estados transientes são mais freqüentemente encontrados (Ke e Ti)(1). Desta forma, a abordagem estacionária tem sido aos poucos abandonada, sendo substituída por uma análise dinâmica, que requer maior esforço computacional.
Oosthuinzen e Carscallen (2) apresentaram as mais diversas formas de análise de escoamento de gases. Entre elas, destaca-se a análise não estacionária do problema. Foi desenvolvido um modelo tendo como premissas básicas: escoamento unidimensional, com área da tubulação constante e assumindo ser um processo isentrópico. Desta forma, mantendo-se a entropia constante, a equação de conservação de energia não adiciona nenhuma informação ao modelo, que pode então ser reduzido às equações de conservação de massa e momento.
Matko(3) também parte destas mesmas equações para formular um modelo dinâmico de escoamento compressível, não linear, com parâmetros distribuídos. Evidencia-se em seu trabalho algumas premissas para simplificação do modelo. São elas: (i) Escoamento adiabático; (ii) Fluxo unidimensional; (iii) Fluido homogêneo; (iv) Temperatura, viscosidade e diâmetro do tubo constantes. O modelo foi composto de duas equações diferenciais parciais, hiperbólicas, não lineares, tendo como variáveis dependentes a vazão mássica e a pressão do sistema, e como variáveis independentes a posição ao longo do tubo e o tempo. O método característica foi usado como solução do sistema, transformando o problema em quatro expressões diferenciais ordinárias.
2.2.	Métodos de Detecção de Vazamento
Muitos métodos para detecção de vazamentos em linhas que transportam líquidos e gases têm sido propostos. Os principais deles são baseados em dados coletados das variáveis de processos usualmente medidos, tais como, pressão, vazão e temperatura.
Talvez o método mais comum seja o que faz balanço de volume em linha (Ellul)(4). O mesmo baseia-se na conservação de massa no duto, aplicada aos dados provenientes de medidores de vazão distribuídos na tubulação. Dois tipos de balanço são elaborados: um simplificado e, portanto, mais rápido, que identifica grandes vazamentos, e outro mais rebuscado e por conseqüência mais lento, que detecta vazamentos de até 0,5% da vazão nominal da linha num período de 3 a 6 horas.
Zhang(5) descreve um método estatístico para quantificar e localizar vazamentos. O sistema usa valores medidos de vazão e pressão do final da linha. O mesmo têm sido aplicado em simulações de dutos com até 100 km. O método foi aplicado em um caso real numa linha de propeno. Ambas aplicações demonstram poder detectar vazamentos de até 1% do valor nominal da dutovia, bem como a sua localização com uma boa precisão.
Jonsson e Larson (6) estudaram a característica da propagação em forma de onda através de um duto de água de 5 040 metros, depois da parada de uma bomba, com e sem ocorrência de vazamento. Foram analisados os efeitos de um vazamento nas variações dos sinais de pressão do sistema. O método conseguiu detectar fugas de até 7% do valor nominal do fluxo de teste.
Outra classe de sistema de detecção de vazamentos é apresentada por (Coelho e Medeiros)(7) como mais promissoras, confiáveis e associadas a menores investimento de implantação. Nestas, a qualidade da detecção obtida depende de modelos apropriados ao processo, sejam eles de natureza estocástica, gerados por estratégias de identificação sobre séries temporais de variáveis de entrada e saída (estados), ou construídos com base em princípios e leis fenomenológicas.
3.	MODELAGEM DINÂMICA DE ESCOAMENTO COMPRESSÍVEL
O modelo matemático utilizado para a análise transiente em redes de escoamento compressível está fundamentado nas equações de continuidade e momento. No desenvolvimento do modelo, foram assumidas algumas premissas básicas com o intuito de simplificação do mesmo, são elas : (i) Escoamento Isentrópico : não há transferência de energia entre o fluido e a tubulação; (ii) Fluxo unidimensional : pressão e vazão dependem apenas do eixo x; (iii) viscosidade e diâmetro do tubo constantes. A aplicação conjunta destas duas expressões, considerando as premissas acima citadas, faz surgir duas equações diferenciais parciais não lineares, não homogêneas de ordem 1, referente à pressão e à vazão do sistema, unidimensional no espaço e transiente.
3.1.	Equação da Continuidade e da Quantidade de Movimento
A equação da continuidade e da quantidade de movimento são obtidas aplicando o princípio da conservação da massa e momento, num volume de controle.
S
Fig. 1 - Volume de Controle.
Fig. 1 - Control volume.
Considerando a situação apresentada na figura 1, chega-se à apresentação do modelo contendo, respectivamente, as expressões finais da continuidade e da quantidade de movimento de um escoamento isentrópico:
3P'
/	V r-1 \	
7	p' r
SP 0 J	
( 2
(1)
( 1 1	( \ 2 q
èp 0S 0	r-1 p' r '
po S	-
dx
èP 0 S
~(P o Sg sen«)P 'g dx
(2)
1
P0SD
q\q\P'r
31
V
qP'r
(1
&lt;2
\ ( f
7 è
7
A formulação detalhada das equações 1 e 2 encontra-se no Apêndice 1.
3.2.	Resolução Numérica do Modelo
O modelo representado pelas equações 1 e 2 foi resolvido no espaço pelo método de elementos finitos usando-se o formalismo Galerkin (Cook)(8). Por meio deste procedimento, é possível reduzirem-se as equações diferenciais parciais do modelo a um sistema de equações diferenciais ordinárias no tempo.
Com esta finalidade, foi escolhida como base funcional de dimensão N o conjunto	(x)}N de
funções pulso triangular dado pela equação 3:
f j(x) = 0,	e&lt;-1
f j(x) = 1 + 3,	-1&amp;lt;e&lt;o (3)
f j(x) = 1 -e,	o&amp;lt;e&amp;lt;1
f j(x) = 0, e = x - j	e&gt; 1,
h
onde:
h é o comprimento característico da discretização na dimensão espacial que irá resultar das formas
(3), dado pela equação 4:
h = xMAX ~ xMIN
N
(4)
xMIN normalmente é igual a zero e xMAX é o comprimento total do tubo a ser resolvido pelo modelo. N é o número de elementos de comprimento h.
para
A aplicação do formalismo Galerkin demanda inicialmente a colocação de todas as funções do problema sob a forma de truncamentos em séries de Fourier a partir da base
funções dependentes do tempo e de x, os coeficientes de Fourier dependerão apenas do tempo. Têm-se (equação 5):
N
Y(x,t)&amp;lt;£ Yk(t)f k(x)
k=0
(5)
Onde o vetor de estado Y , contendo pressão “P” e vazão “q” contidas nas equações (1 e 2). No procedimento Galerkin, a equação 5 é substituída nas equações diferenciais (1 e 2), modelo final de escoamento compressível, gerando o resíduo (equação 6) dependente do tempo (t) e do espaço (x):
R = |=+A(Y)(^=)+ B(Y)	(6)
3 t =	3x
Em seguida, impõe-se que os produtos internos de tais resíduos com as funções-base (equação 3) sejam nulos, conforme equação 7:
oo
J Rf k(x) = 0
0
(7)
para k= 0,..,N.
A aplicação da equação 7 e suas propriedades resultam no sistema de equações diferenciais ordinárias no tempo(equações 8 e 9).
Hk =
(h)
' h\•
&amp;lt;6F
k)
[{K}
,, •	(h'\ •
TT Yk-i + -V 3 7
f kde-
Yk-1JAk)fY
iw-
+ &amp;lt;k-1
J Af a! Yk ■
iw-
(8)
para k = 1,..N
' h\ k3 J
Jk =
(h)
(h\ •
- Y k+1 + k 6 J-k+1
k+1)
.{K+1}
- Yk-í JAk+1)fkde\Y
.{K+1T
'k+i - Yk)+
(9)
f d*-
para jk- 0,..,N-1
As integrais existentes nas equações 8 e 9 foram resolvidas numericamente pelo método de Quadratura Gaussiana (equação 10). Tal método consiste em expandir a integral de “F(x)” em um somatório de termos formados pela própria função nos pontos de quadratura, multiplicada pelos pesos de quadrature Wj, determinados pelo número de termos escolhido “n”.
j'/VW =	WjF(Xj)
2 j
(10)
Sendo assim, as equações 8 e 9 foram resolvidas com integrações numéricas em tempo via métodos Runge-Kutta com ajuste de passo, para os coeficientes de Fourier das variáveis de estado pressão e vazão, com as seguintes condições de contorno (equações 11 e 12):
X = 0 ^P'= PEntrada (t) i X = L ^V=VSada. (0
E condições iniciais : t = 0 =&gt; P' = P'o (x) ; t = 0 q = q0(x)
(11)
(12)
4.	DETECÇÃO DE VAZAMENTOS VIA PREDITORES ARX-MIMO
O método proposto para detecção de vazamento está baseado em modelo estocástico auto-regressivo Empregou-se no sistema uma estrutura ARX (Auto Regressive EXogenous Input) com múltiplas entradas e múltiplas saídas (MIMO).
4.1	- Metodologia
O procedimento consiste em gerar séries temporais(1) dos dados de entrada e saída transientes do processo, tais como pressões nodais e vazões de escoamento nos tubos, sob a ocorrência de eventos programados pelo simulador dinâmico e empregá-las para treinamento de preditores ARX-MIMO e colocá-los para prever estados do processo com respeito a apenas uma pequena parte do grande elenco de variáveis do sistema. Em tese, na ausência de anormalidades operacionais, o preditor deverá rastrear com efetivo sucesso as variáveis sob acompanhamento. O valor predito irá diferir do medido numa faixa inferior à largura do intervalo de confiança da predição. A manifestação de um vazamento é detectada pelo afastamento instantâneo, e significativamente fora dos limites de confiança , entre um conjunto de predições e as medições do processo correspondentes.
As fases principais da metodologia são:
(i)	geração do preditor via treinamento com dados de processo em t+1, ..., t+N;
(ii)	acompanhamento do processo com preditor gerado em t+N+1, ..., t+N+NI;
(iii)	construção de limites estatísticos de confiança para preditores;
(iv)	detecção de eventos na faixa temporal t+N+1, ..., t+N+NI quando houver disparidade entre predição e medição além dos limites de confiança;
(v)	após t+N+NI regenerar o preditor com nova sessão de treinamento com N instantes (Normalmente NI&gt;&gt;N);
(vi)	repetir etapas (ii) a (v), após fazer t = t+N+NI.
A seguir, apresentam-se os principais fundamentos e procedimentos numéricos das fases acima, que constituem o Método de Detecção de Eventos em Processos Descritos em Séries Temporais. Tal método está sendo desenvolvido no Laboratório SDV Dutos da Escola de Química da UFRJ.
Todo o desenvolvimento matricial para a fase de treinamento do ARX-MIMO está apresentado no Apêndice 2.
4.2	— Estrutura do Modelo Preditor ARX-MIMO
• Variáveis básicas:
y(t)	: Vetor (ny x 1) de saídas do processo sob acompanhamento em t
y(t)	: Predição para y(t) (ny x 1)
l/(t)	: Vetor (nu x 1) de entradas do processo sob acompanhamento em t
q(.)	: Operador de deslocamento
A : Matriz ny x nu constante
B : Matriz ny x nu constante
n	: Ordem do filtro de auto-regressão (AR) do ARX-MIMO
m	: Ordem do filtro de entrada (X) do ARX-MIMO
Ak (q)	: Operador matricial do filtro AR (ny x ny)
Bk(q)	: Operador matricial do filtro X (ny x nu)
n
ASt) = 1+£Aq‘(.)	(13)
k=1
m
B(q) = 1 + XBkq-k(.)	(14)
k=1
• Equações do Preditor para Instante t+1 (equação 15):
yt +1) = B(q)u(t) + q[l - A(q)Jy(t)
(15)
• Abrindo operadores e estendendo predição para instantes t+1, ..., t+N (equação 16):
y(t +1) = Bu(t)+ ...+ Bmu(t - m +1)-Ay(t)-Bny(t - n +1)
y(t + N) = Bu(t + N -1) +... + B u(t + N - m) - Ay(t + N -1) -
... - A y(t + N - n)
A coleção matricial para treinamento do ARX-MIMO está apresentada no Apêndice 2 (equações 2.1 a 2.6).
• Estimação de Parâmetros para Saída i
Hipóteses
(i)	Modelo ARX é correto para representar o processo (equação 17):
h i=xq i
(17)
onde:
Qi é o valor correto de parâmetros; hi é o vetor correto de predições (t+1,...,t+N) para a saída i.
(ii) Amostragem experimental para a saída i, O i (coluna i de O), segue padrão normal não-
correlacionado em torno de h i (equações 18 e 19):
FD(® i) =
1
(2p )N/27det(R.)
exp[-|(Oi -hi)tRi_1(^i -h;)]
R = COV(®i) = lidiagr);	(r, : Nx1)
(18)
(19)
Definindo-se W = [diag(ri)] ~1 (conhecida), tem-se (equação 20):
Jdet(W-)	1 t
1 exp[--(Oi-hi)tWi(^. ~h.)]
FD-i)	(2iÂ,.)N/2
(20)
Para estimar (. constrói-se a função verossimilhança para saída i a partir de (20)
det(W)	1
L(-i’-i) = (2i prexp[--(O,■ - Yi)tWi(^&gt;i -Y/)l	(21)
Estima-se 0. maximizando a função densidade conjunta dos valores medidos através de L(Ç&gt; ,, Ô_i) (equação 22):
Max
L(O .I)
(22)
que corresponde a ( W. conhecida) (equação 23):
ii
1 . t „ Min{} —Yt-Oi) WYi)
(23)
onde:
Y_. é o vetor de preditores para a saída i dado em (equação 2.6 - Apêndice 2). Substituição de (2.6 -Apêndice 2) seguida de busca de ponto estacionário em (3.1 - Apêndice 3), resulta em (equação 24):
ô.=[x'WiXr 'XWi .
(24)
A caracterização da Estimação, Região de Confiança de Parâmetros, Região de Confiança para Predições Corretas na Janela de Treinamento do ARX-MIMO e Fora da Janela de Treinamento estão apresentadas no Apêndice
5.	SIMULAÇÕESE RESULTADOS
Foi modelada uma rede planar de 5 tubos de 0,45m de diâmetro para escoamento de gás conforme mostrado na figura 2. A viscosidade do gás foi assumida constante igual a 0,01cP, com expoente politrópico g=1,25. A rugosidade do tubo foi suposta de 10-7m. As propriedades termodinâmicas de escoamento foram modeladas com a equação 1.10 - Apêndice 1. As variáveis de entrada do processo são as pressões dos nós 1 e 6 (P1 e P6), vazões de fornecimento de 40 Kg/s nos nós 3 e 4 (W3 e W4), vazão de alimentação do sistema no nó 2 (P2) e um ponto de vazamento no nó 5 (W5). As pressões de carga P1 e P6 serão programadas para variar entre dois níveis especificados conforme visto na figura 8. Nesta figura, também pode ser visto o padrão de operação especificado para as vazões de fornecimento e de alimentação (W3, W4 e W2). O nó de vazamento foi programado para acionar em t=260s, gerando uma vazão proporcional à raiz quadrada da diferença de pressão entre o nó e o exterior. O comportamento deste nó (W5 e P5) também pode ser visto na figura 8. Os impactos de todos estes padrões de operação refletem-se nos tubos da rede conforme pode ser visto nas figuras de 3 a 14, que ilustram comportamentos P(x,t) e q(x,t), sendo P uma pressão de um ponto e q uma vazão. Telas de operação e de controle do simulador que foi desenvolvido no Laboratório SDV - Dutos da Escola de Química da UFRJ também são apresentadas nas figuras de 15 a 17.
Em futuro desenvolvimento desta pesquisa, pretende-se implementar a detecção de vazamentos com estruturas preditoras ARX-MIMO usando-se o simulador como fonte de treinamento dos preditores.
Fig. 2 - Rede exemplo para escoamento compressível em condição transiente.
Fig. 2 - Sample system for compressible flow in transient condition.
Fig. 3 - Distribuição espaço temporal de pressão e vazão no tubo 1.
Fig. 3 - Time space distribution of pressure and flow rate in pipe #1.
Fig. 4 - Distribuição espaço temporal de pressão e vazão para o tubo 2.
Fig. 4 - Time space distribution of pressure and flow rate in pipe #2.
Fig. 5 - Distribuição espaço temporal de pressão e vazão para o tubo 3.
Fig. 5 - Time space distribution of pressure and flow rate in pipe #3.
Rede 3 Tubo4
110
100
90
80
- 18000 m
20000 m
---	0 m
-	2000 m
-	4000 m 6000 m
--- 8000 m 10000m
---12000 m --- 14000 m
-	16000 m
400
300
200
CT
100
Fig. 6 - Distribuição espaço temporal de pressão e vazão para o tubo 4.
Fig. 6 - Time space distribution of pressure and flow rate in pipe #4.
400
Fig. 7 - Distribuição espaço temporal de pressão e vazão para o tubo 5.
Fig. 7 - Time space distribution of pressure and flow rate in pipe #5.
Fig. 8 - Comportamento dinâmico das variáveis de pressão e vazão para o exterior dos nós da rede.
Fig. 8 - Dynamic behavior of pressure and flow rate variables outside system nodes.
Fig. 9 - Superfície P(x,t) para o tubo 1.
Fig. 9 - P(x,t) surface for pipe #1.
Fig. 10 - Superfície P(x,t) para o tubo 2.
Fig. 10 - P(x,t) surface for pipe #2.
Rede 3 Tubo4
Fig. 11 - Superfície P(x,t) para o tubo 4.
Fig. 11 - P(x,t) surface for pipe #4.
Rede3Tubo4
Fig. 12 - Superfície q(x,t) para o tubo 4.
Fig. 12 - q(x,t) surface for pipe #4.
Fig. 13 - Superfície P(x,t) para o tubo 5.
Fig. 13 - P(x,t) surface for pipe #5.
Fig. 14 - Superfície q(x,t) para o tubo 5.
Fig. 14 - q(x,t) surface for pipe #5.
Fig. 15 - Tela principal do simulador.
Fig. 15 - Main screen of simulator.

Rohzero(kg/m3)
Fator de Volume
Ordem de Quadratura
-) Figure No, 1: Condições Simulação
Relógio(s)
Horizonte(s)
Expoente Politrópico
Tempo Amostragem (s)
Viscosidade (kg/m.s)
Elemento Base(m)
Rugosidade (m)
Fig. 16 - Tela de parâmetros de simulação.
Fig. 16 - Simulating parameter screen.
Fig. 17 - Tela de acesso a recursos da rede de escoamento.
Fig. 17 - Access screen to flow system resources.
6.	CONCLUSÕES EPRÓXIMAS ETAPAS
As principais conclusões deste trabalho foram:
•	foi desenvolvido, com êxito, modelagem e simulação dinâmica de redes de escoamento compressível;
O trabalho aqui desenvolvido pode ser aperfeiçoado de várias maneiras. As seguintes etapas deverão ser futuramente implementadas:
•	validação do modelo dinâmico de escoamento compressível, com dados reais de um sistema de transporte de gás;
•	instalação de sistema de detecção baseado em preditores ARX-MIMO rastreando respostas medidas do processo;
•	aperfeiçoamento do modelo de equação de estado do simulador dinâmico de redes de escoamento compressível;
•	desenvolvimento de algoritmos de localização e quantificação de vazamentos em escoamento compressível.
O aperfeiçoamento da tecnologia de prevenção e detecção de vazamentos e falhas em sistemas de transporte de gás, via redes de escoamento compressível, trará indiscutíveis benefícios, principalmente os de ordem econômica, com o aumento da segurança dos sistemas e sua conseqüente otimização operacional; e os de ordem ambiental, com a drástica redução de poluição atmosférica, e diminuição de risco relacionados a incêndios, explosões e devastação de ecossistemas cuja amplitude depende do tempo gasto pelo sistema de detecção em tomar ciência da ocorrência e acionar medidas de contenção.
REFERÊNCIAS BIBLIOGRÁFICAS
(01) KE, S. L.; TI, H. C. “ Transient analysis of isothermal gas flow in pipeline network”, Chemical Engineering Jounal, 76, p. 169-177, (2000).
(02) OOSTHUINZEN, P. H.; CARSCALLEN, W. E. “Compressible fluid flow”, McGrow-Hill International Editions, (1997).
(03) MATKO, D.; GEIGER, G.; GREGORITZA, W. “Pipeline simulation techniques”, Mathematics and Computers in Simulation, 52, p. 211-230, (2000).
(04) ELLUL, I. “Pipeline leak detection”, Chemical Engineering, N 461 (1989).
(05) ZHANG, X. J. “Statistical method for detection and localization of leaks in pipeline”, OMAE, Vol. V-B, , Pipeline Technology, ASME, New York (1992).
(06) JONSSON, L.; LARSON, M. “Leak detection through hydraulic transient analysis”, Pipeline Systems, Kluwer Academic Publishers, Dordrecht, Holland (1992).
(07) COELHO, R.M.L.; MEDEIROS, J.L. “ Detecção de Vazamento em Redes de Escoamento Incompressível via Reconciliação Não-Linear”. Anais do II ENPROMER - II Congresso de Engenharia de Processos do Mercosul, Outubro de 1999, Florianópolis, Brasil (1999).
(08) COOK, R. D. “Concepts and applications of finite elements analysis”, Second Edition by John Willey &amp;amp; Sons, Inc. (1981)
(09) BOX, G.; JENKINS, G.M.; REISEL, G.C. “Time series analysis”, Prentice Halll, (1994) Churchill, S. W., “Friction-factor equation spans all fluid-flow regimes”, Chemical Engineering, No 11, p. 91-92 (1977).
(10) LJUNG, L. “ System Identification : Theory for the user”, Prentice Hall PTR Information and System Sciences Series, (1987).
APÊNDICE 1
FORMULAÇÃO DO MODELO DINÂMICO DE ESCOAMENTO
1.1.	Equação da Continuidade
A equação da continuidade é obtida aplicando o princípio da conservação da massa através de um volume de controle. Tem-se (equação 1.1):
ÇA	(U)
SAx a7 = q ~ (/-
Dividindo-se a equação 1.1 por S e Ax, e aplicando-se o limite quando Ax tende a zero, obtém-se a equação 1.2:
3p = Ç 1 ^3q
31	S 0 dx
(1.2)
1.2	- Equação da Quantidade de Movimento
A equação de quantidade de movimento é obtida aplicando o princípio da conservação de momento em um volume de controle. As forças que agem no sistema podem ser expressadas da seguinte forma (equação 1.3):
3(pv)	2	2	(1.3)
SAx^-P- = SPX -SPx+íx + Sp\'2x -Spv2v- -pDAxF-pgsenaSAx
a t
Dividindo-se a equação 1.3 por Si e Ax, e aplicando-se o limite quando Ax tende a zero, chega-se à seguinte expressão (equação 1.4):
a(pv)= ap a(pv2) (kd dt	dx	dt	è S
pg sen a
(1.4)
Sabendo-se que (equação 1.5):
	o	q q = pvS qv=^~ Sp		(1.5)
E que (equação 1.6),	2	qv	_	2 q2	
	pv	=-— = S	^PV = V2 p S p	(1.6)
O balanço de quantidade de movimento fica (equação 1.7):
dq	dP 2q dq q2 dp
- = -S---------—- +  — - pDF - pSg sen a
dt	dx pS dx p S dx
(1.7)
Sendo que o item “pDF” da expressão, que contém o termo de fator de atrito pode ser substituído pela equação 1.8.
pDF =
' 1
&lt;2
q\q\
)
(1.8)
E o fator de atrito contido na equação 1.8 deve ser baseado na formulação de Churchill(1977) (equação 1.9).
f = 8í
(1.9)
' _8_
&amp;lt;Re
Sendo que:
A =
Re =
' 4 q pDm
v /
1.3.	Escoamento Isentrópico
O modelo proposto considera o escoamento adiabático, ou seja, não será admitido troca de calor do fluido com as vizinhanças. Tal premissa pode ser assumida desde que os efeitos de viscosidade e de troca de calor não sejam restrições do problema, nem tampouco sejam importantes para compor as condições de contorno. Assim, por definição, a entropia permanece constante e pode ser assumida a seguinte relação (equação 1.10):
PV g =
PM g
(1.10)
P
g
= C
Diferenciando ambos termos da expressão tem-se (equação 1.11):
3P
(Cp 'pp
(1.11)
Mg jdp
Substituindo a equação 1.10 na 1.11, obtém-se a equação 1.12 :
3P
dh
' gP ^3p è p Jâh
(1.12)
Assim, pode-se assumir a seguinte relação, tendo a entropia (S) constante (equação 1.13):
gP _(3P_
P [dp
(1.13)
&gt; s
Desta forma, podem-se usar as fórmulas abaixo para substituir a densidade (p) pela pressão (P) nas expressões da continuidade (1.2) e da quantidade de movimento (1.7).
3p
3x
'_p&gt; gP Jax
(1.14)
ap a t
ypP g pt
1.4 - Equações Finais de Continuidade e Momento
Substituindo as equações (1.14) e (1.8) nas (1.2) e (1.7) chega-se à apresentação do modelo contendo as expressões da continuidade e da quantidade de movimento, respectivamente. Sendo o fator de atrito “f” evidenciado pela equação 1.9.
3P
31
P/ _ q2 ()l gPpS
' 2q ^3q PS Px
(1
&lt;2
(1.15)
(1.16)
' gP Mq k Sp px
Adimensionalizando as variáveis pressão (P) e densidade (p) contida nas equações 1.15 e 1.16 com as seguintes expressões (equação 1.17).
P
P
p'
(1.17)
Desta forma a relação fenomenológica existente em (1.10) torna-se (equação 1.18):
P' _ d g
(1.18)
Aplicando a equação 1.17 nas equações 1.15 e 1.16 e eliminando a densidade “d” com a relação da expressão 1.18, encontra-se:
3P'
a t
0
sí
p'
ax
7
(1.19)
a q
~dt
( 1 1	(	X 2 q
[íP 0 S 0	y-1 p' y \ r	7
p0 s P -
ax
( 2
[P 0 S
y	Z1
qP'y
"(P 0 Sg sen«)P 'g ax
(1.20)
11 f	( 1
2 lf	[p 0 SD
APÊNDICE 2
COLEÇÃO MATRICIAL PARA TREINAMENTO
As séries temporais são organizadas matricialmente:
ut(t - (m-1))
U = U(t)
(N + m-1 x nu)
u(t + N -1)
y(t - (m-1))
Y = /(t)
(N + m-1 x ny)
yt(t + N -1)
	~y(t+1)’		~y’(t +1) ’	
y=	y(t)	; 9=	y'(t)	(N x ny)
	_ y(t+N)		y'(t + N)	
onde u(t), y(t) são os vetores de entrada (nu x 1) e de saídas (ny x 1) do processo. Considere a predição da resposta “i”, yi(t) (i =1... ny). Será, portanto, necessário operar com as linhas “i” de By..,B ,A1,...,A . Sejam Aki e Btki as linhas “i” de Ak e Bk . Assim pela (equação 16), tem-se:
y(t+1) = Bu+...+Bmiu(t - m+1) - Ay) -... - Ay - n+1)
yy(t + N) = By + N -1) +... + Btmiu(t + N - m) - Ay + N -1) -... - Ay + N - n)
(2.1)
Sejam:
bkij : elemento ij de Bk
akij : elemento ij de Ak
Uj(t), yj(t) : elemento j de	u(t) e y(t)
Assim:
nu	nu	ny	ny
yi(t+1)=Ê bijuj(t)+...+X bmuj(t - (m~1))-£ aijyj(t) - ■■■ -£ anjyj(t - (n~1))
j=i	j=i	j=i	j=i
nu	nu
yi(t + N) = £ bViuJ(t + N -1) +... + £	+ N - m)) -
j=1	j=1
ny	ny
£ aijyj(t+N -1) - ■■■ -£ anijyj(t+N - n))
j=i	j=1
Escrevendo a coluna i de Y(t) como :
Y(t) =
yt+1)
y^t+n)
(N x 1)
as equações anteriores tornam-se:
nu		uj(t)		- j _ (m - 1))T
Y = Y í	b1ij		+ ■■■ + bmj	
j=1		uj(t + N -1)		uj(t + N - m)
ny
Y í
j=1
yj(t)
yj(t + n -1)
+ ■■■ + amj
yj(t - (n -1))
yj(t + N - n)
(2.2)
Analogamente, escreve-se a coluna j de U e Y como a seguir:
	~u,(t - (m -1))-		~ y,(t - (n -1))-
Uj =		(N+m-1 x 1); Yj =	
	ui(t + N -1)		yi(t + N -1)
Definem-se os seletores esparsos:
(N+n-1 x 1)
&gt;
â-WNN + m -1)
Nx(N + n-1)
N + m - 1
N + n - 1
Estes seletores garantem:
Uj(t)
u (t + N -1)
= SiUj
J
y(t)
y (t + n -1)
= íiilYj
Uj(t - (m-1))
uj(t + N - m)
= ISmlUj ;
y j (t - (n -1)) yj (t + N - n)
= [$ ]Y j
=n J
Assim, a equação 2.2 torna-se (equação 2.3):
m	nu	n	ny
Y = X [skfL Ub -£ [$kiY Ya
k=1 j=1	k=1 j=1
(2.3)
ou ainda (equação 2.4):
m	n
Y = L [SklUBkl+Y l$k]YAki(2.4)
k=1	k=1
Define-se a matriz (Nx (nx * ny + m* nu)):
x = l-■■■ -H	SU- SmU
e o vetor de parâmetros do ARX-MIMO para geração da predição i:
0,■ ( (nx * ny + m* nu) x 1), dado por sua vez por:
X ■■■Bi]
1i	mi
0i= [Ai	■■■ A B
L=1i	=ni
&lt;------&gt; «
ai
b
Assim, tem-se a relação de predição da saída i (equação 2.5):
y=|x]qi, 0-i =
ai
b
(2.5)
No formato de estimação de parâmetros (equação 2.6):
Y = XL&amp;lt;1=1.........ny)
(2.6)
Observações:
a)	matriz X é única para todas as saídas do ARX-MIMO;
b)	cada saída (i=1,...,ny) diferencia-se apenas pelo vetor de parâmetros correspondentes;
c)	identificações / estimações podem ser feitas separadamente para cada saída do ARX, incluindo estimativas de incertezas e intervalos de confiança.
APÊNDICE 3
BASE ESTATÍSTICA DO PREDITOR ARX-MIMO
• Caracterização da Estimação
(i)	O, é normal, logo 0 i como função linear de O, também é normal;
(ii)	0, é	estimativa não-tendenciosa:	E((^i) = [X’W,	i) sendo
E(O,.) = h i = XÔ i , tem-se que (equação 3.1):
E(Ô_i) = 0 i	(3.1)
(iii)	0, é estimativa coerente:
cov_(ô,) = E[(êi -0 i)(êi -0 ,)’
com a equação 24 escreve-se:
0, -0i = [XtWiX]~^X’W^, -h i), resultando, com (equação 19), em (equação 3.2) COV(Ô,) = l, [wx] 1	(3.2)
transparecendo a coerência quando N .
(iv)	Comportamento de Ai (equação 3.3):
Ai = (0,-0,)’[COV(Ô,)]~\Ô, -0i)	(3.3)
Ora, COV(6,) é simétrica positiva-definida podendo ser fatorada segundo (3.4):
COV(Ô, ) = PeP	|cOV(0, )]1 = Pe~1P’	(3.4)
onde e é diagonal de autovalores positivos e Pé ortogonal de autovalores ortonormais. Assim (equações 3.5 e 3.6):
A i = (0,-0 i)tp£~V2e~V2pt((-i-0- i)	(3.5)
A, = ZiZ,;	z, =E~1l2p’(0i-0,)	(3.6)
Mas Z, é combinação de normais, logo é normal;
E(Zi) = 0
COV(Zi) = E(ZiZ’) = I
Portanto, cada componente de Z, segue distribuição normal padronizada sem correlação entre eles. Disto resulta que A, segue, por (4.24), distribuição X2 com nx*ny + m*nu graus de liberdade (equação 3.7):
A, ^X
2 v=n*ny+m*nu
(3.7)
• Estimação de_ 1 j: — (saída i)
4j-hj =Uj - Yj)+ Y-hj) (j=1,2,..,N)
_ 1
onde, com: R = 1j W;
Ora, usando-se
(Yj ~hj)= X—	j), verifica-se que o último termo à direita em (3.8) é nulo
devido à equação de ponto estacionário (equação 23). Com a mesma substituição verifica-se que o segundo termo à direita é A j (via 3.2 e 3.3). Finamente, o termo à esquerda segue distribuição X2 * com N graus de liberdade (via hipótese (ii) da estimação, equação 19, e álgebra similar à usada em (3.3) a (3.7). Portanto, (3.8) traduz-se em (equação 3.9):
Xv = SR,
,2 (N - n*ny - m*nu)
+ Xv=n*ny+m*nu
(3.9)

onde (equação 3.10):
S
2 R =
1
N - n*ny - m*nu
(* j
-	j - Yj)
(3.10)
2
Ora, pelo teorema da Partição X resulta que o primeiro termo à direita é (equação 3.11):
SR (N - n*ny - m*nu)	2
* Xv=N-n*ny-m*nu
lj
ou (equação 3.12)
Sr
lj
N - n*ny - m* nu y
Xv = N- n*ny- m*nu
Dando que (equações 3.13 e 3.14)
E(SR) = 1
Var(SR) =
21?
N - n*ny - m*nu
V	7
(3.11)
(3.12)
(3.13)
(3.14)
í

Além de ser independente de —.
2	2
Em outras palavras, SR é um estimador coerente e não-tendencioso para : lj = SR .
Disto resulta também que (equação 3.15)
coviê) = sR [wx]1	(3.15)
• Região de Confiança de Parâmetros Corretos para a Saída i 3_j (equação 3.16)
Aj = (Ôj -3jf [COV(Ôj)] 1(3-3) ~&gt; /r=n*ny+m*nu	(3.16)
SR (N - n*ny - m*nu)	2
* Xv=N-n*ny-m*nu
Dada a independência entre estas quantidades, dada (4.20), e com o teorema F sobre a razão de
2
variáveis X , chega-se à equação 3.17:
-ÓLj)t[XtWjX]~ ^(O-ÓLi
SR (n* ny+m*nu)
Isto é, a razão à esquerda segue distribuição F com graus de liberdade indicados.
Seja fi_a a abcissa Fisher obtida para a distribuição F tal que a probabilidade dela ser ultrapassada é
de Prob(— &amp;lt;—i_a ) = (1 -a)*100%,	. = 0.1,0.05,0.01,.. ou menos. Assim:
(»i -3i ),[X,WíXT'((Íí -3i) S sR (n*ny + m* nu)fi_a	(3.18)
região de confiança para 3_jcom probabilidade (1 -a)*100%.
-	F(n *ny + m* nu, N - n*ny - m*nu)
(3.17)
• Região de Confiança para Predições Corretas na Janela de Treinamento do ARX-MIMO
Com (2.6), (3.1) e (equação 17)
E(Yj) = X3 j =h j
Portanto (equação 3.20):
COVCÍj) = E[CÍj-h í)(Yí-h)]
Com (Yj ~hj) = X(Ój ~ 0j)chega-se a (equação 3.21):
COV(Y,) = i[XWVX]1Xt
(3.19)
(3.20)
(3.21)
Donde (equação 3.22)
COV(Y:) = 1X[X*WX] 'X	(3.22)
Ora, por (2.6), Y_i é função linear de 0° cujo comportamento é normal. Logo, Y_i também tem comportamento normal. Admitindo pequena ou nenhuma correlação de Yj, tem-se com (3.19) e (3.21):
Y	Nh ik,iiXk~ '[xWiXr 'Xk
Onde N(a,b) representa comportamento normal com média “a” e variância “b”; Xk é a k-ésima linha de X ; e Yik é o k-ésima componente de Yj, isto é:
Yik = Yi(t + k)(ver (4.5)). Tem-se assim:
tYik~h ik -	N(0i,')
■p-iXk [XWiX]~X
SR(N - n*ny - m*nu)	2
l	&gt; Xv=N-n*ny-m*nu
2
Pela independência entre e Oi, e por (2.6), tem-se independência entre os dois termos à esquerda acima. Com o Teorema t, acerca da razão da variável normal padronizada e raiz quadrada de variável 2
X , chega-se a (equação 3.23):
t=
Yi ~h ik
. XrX.XXw X] 'X
---~*r=N-n*ny-m*nu
Xk
(3.23)
Isto é, a razão acima segue distribuição t com grau de liberdade indicado.
Seja t1-a/2 a abcissa obtida na distribuição tal que a probabilidade de ela ser ultrapassada é de a/2*100%o (a=0,05; 0,01; etc). Assim, com (3.23) tem-se (3.24)
Yik - *'-a/2
-a/2
(3.24)
que é o intervalo de confiança para hikcom probabilidade (1-a)*100%&gt;, onde (equação 3.25):
Fk = Xk,[X,WiX]~ 'Xk
ou, equivalentemente (equação 3.26),
(3.25)
Yi(t + k)-tj_a/2^SRFik - pi(t + k) - Yi(t + k) + h-a/2^SRFik	(3.26)
que é o intervalo de confiança para predição correta da saída “i” no instante t+k, (l &amp;lt;k &amp;lt;N), na janela de treinamento, com probabilidade (1 - a)*100% .
• Região de confiança para predições corretas fora da janela de treinamento do ARX-MIMO:
Após estimação de 6_i (i=1...ny), o preditor operará fora da janela de treinamento para predizer saída “i” em instante k+1, tem-se (equações 3.27 e 3.28):
Y(k+1)=zq
(3.27)
Zk = [- Yt(k)- Yt(k -1)....- Yt(k - (n - 1)Ut(k)Ut(k - 1).^Ut(k - (m -1))] (3.28)
(k+1&gt;t+N)
Assim, dada a normalidade de dj, tem-se que Y(k +1)também segue comportamento normal, dando (equações 3.29 e 3.30):
E(Yi(k + 1)) = zke i =p (k + 1)	(3.29)
VAR(Y,(K+1) = Zk (-e i )•(-e i )k}
VAR(Yj(K +1) = Z‘:COV((_. )zk
VAR(YI(K +1) = l.Z't[x:WXj1Zt	(3.30)
A partir disto pode-se escrever analogamente ao caso anterior
t = Y(k + 1)-p (k +1)
^ZkixWxr Z
N(0,1)
SR (N - n*ny - m*nu)	2
Xv=N-n*ny-m*nu
li
Pela independência entre os termos à esquerda e seguindo processo idêntico ao anterior via teorema t, chega-se à expressão do intervalo de confiança para a predição correta da resposta”i” em instante k+1	(k+1&gt;t+N) com probabilidade
(1 - a)*100% (a = 0.05,0.01,etc) (equação 3.31):
Yi(k + 1)-t1_a/2^lSRFik	i(k + 1)Yi(k + 1)+ t1-a/2^SRFik
(3.31)
(k+1&gt;t+N)
onde (equações 3.32 e 3.33)
F* _ Zk['ivx]'zk
Yi(k +1) _ Zq
(3.32)
(3.33)
(t\-a/2 exatamente a mesma da fórmula (3.26)).
</field>
	</doc>
</add>